# StackOverflow 问答 000540000-000540999

# sql-server - 使用 Windows 身份验证编写 SQL Server 登录脚本，无需机器名称

> ID：540000
> 
> 赞同：5
> 
> 时间：2009-02-12T04:18:50.433
> 
> 标签：sql-server

我想编写一个 SQL 2005 脚本来创建一个使用 Windows 身份验证的新登录名。Windows 用户是本地帐户（不是域帐户）。许多 SQL Server 机器上存在同名的本地帐户，我想在所有机器上运行相同的脚本。

看起来很简单：

```
CREATE LOGIN [MyUser]
FROM WINDOWS 
```

然而，这行不通！SQL返回错误，说`Give the complete name: <domain\username>.`

当然，我可以在一台机器上做到这一点并且它可以工作，但是相同的脚本在其他机器上不起作用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T04:33:52.533

看起来 sp_executesql 是答案，正如海滩发布的那样。我也会发布我的，因为如果您像我们一样使用命名 SQL 实例，@@SERVERNAME 将无法正常工作。

```
DECLARE @loginName SYSNAME
SET @loginName = CAST(SERVERPROPERTY('MachineName') AS SYSNAME) + '\MyUser'

IF NOT EXISTS (SELECT * FROM sys.server_principals WHERE [name] = @loginName)
BEGIN
    DECLARE @sql NVARCHAR(1000)
    SET @sql = 'CREATE LOGIN [' + @loginName + '] FROM WINDOWS'
    EXEC sp_executesql @sql
END 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T04:21:21.130

这对我有用：

```
DECLARE @sql nvarchar(1000)
SET @SQL = 'CREATE LOGIN [' + @@SERVERNAME + '\MyUser] FROM WINDOWS'
EXEC sp_executeSQL @SQL 
```

# c# - 什么是对 FormattedText 执行命中测试的好方法？

> ID：540002
> 
> 赞同：1
> 
> 时间：2009-02-12T04:19:24.003
> 
> 标签：c#, wpf, text, hittest

我正在使用 渲染文本`FormattedText`，但似乎有任何方法可以对渲染的输出执行每个字符的命中测试。它是只读的，所以我基本上只需要选择，不需要编辑。

我会使用`RichTextBox`或类似的，但我需要根据嵌入在文本本身中的控制代码输出文本，因此它们并不总是嵌套，这使得构建正确的内联元素非常复杂。我也有点担心该解决方案的性能；我有很多行，并且经常附加新行。

我看过`GlyphRun`，看来我可以从它或相关类中进行命中测试，但我会重新实现很多功能，而且似乎应该有一种更简单的方法......

有谁知道实现这一点的好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-07-27T05:31:27.393

您可以从 FormattedText 对象中获取每个字符的几何形状，并使用每个字符的边界进行命中测试。

```
var geometry = (GeometryGroup)((GeometryGroup)text.BuildGeometry(new Point(0, 0))).Children[0];
foreach (var c in geometry.Children)
{
  if (c.Bounds.Contains(point))
    return index;
  index++;
} 
```

在 OnRender 中，您可以渲染这些几何对象而不是格式化文本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T04:44:50.573

最好的方法是设计一个好的数据结构来存储你的文本，并且还要考虑命中测试。一个示例可能是将文本拆分为块（单词、行或段落，具体取决于您的需要）。然后每个这样的块应该有一个边界框，应该在任何格式化操作中重新计算。还要考虑设计中的插入符号位置。

一旦你有了这样的设施，就很容易进行命中测试，只需使用边界框。它还将有助于后续操作，例如突出显示文本的特定部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T08:15:38.100

完全同意 Sesh - 不重新实现整个 FormattedText 功能负载的最简单方法是将要进行命中测试的单个项目拆分为它们自己的控件/内联。

考虑使用 TextBlock 并将每个单词添加为它自己的内联（或），然后绑定到内联的 IsMouseDirectlyOver 属性，我们将委托添加到 MouseEnter 和 MouseLeave 事件。

如果你想对实际字形进行像素级命中测试（即鼠标正好在这个 'i' 的点中），那么你需要使用 GlyphRuns 并对字形进行手动命中测试（阅读：hard工作）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-16T19:58:20.573

我参加聚会已经很晚了——如果聚会没有结束，并且你不需要实际的角色几何图形，我发现这样的东西很有用：

```
 for (int i = 0; i < FormattedText.Text.Length; i++)
 {
            characterHighlightGeometry = FormattedText.BuildHighlightGeometry(new Point(), i, 1);
            CharacterHighlightGeometries.Children.Add(characterHighlightGeometry);
 } 
```

BuildGeometry() 仅包含角色的实际路径几何。BuildHighlightGeometry() 生成所有字符的外部边界 - 包括空格，因此可以通过以下方式找到空格的索引：

```
 foreach (var c in CharacterHighlightGeometries.Children)
        {
            if (c.Bounds.Contains(centerpoint))
            {
                q = c;
                cpos = index;
                break;
            }
            index++;
        } 
```

希望这可以帮助。

# php - 想要显示当前日期/时间

> ID：540007
> 
> 赞同：1
> 
> 时间：2009-02-12T04:21:50.160
> 
> 标签：php, sql, datetime

嗨，我正在通过 odbc 使用 php 和 sql 编写程序，但我有点卡在我想以 date('Ymd H:i:s) 格式显示当前日期/时间的部分，但它只显示格林威治标准时间。我想增加 8 小时。你们中的任何人都可以帮助我吗。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T04:23:34.803

退房[`date_default_timezone_set`](http://us3.php.net/date_default_timezone_set)。您可以执行以下操作：

```
date_default_timezone_set('America/Los_Angeles');
print 'Current datetime is: ' . date('Y-m-d H:i:s'); 
```

您可以使用它将时区设置为您需要时间到达的任何时区，然后`date`正常使用。或者，您可以这样做，使用[`strtotime`](http://www.php.net/strtotime)：

```
print 'Current datetime is: ' date('Y-m-d H:i:s', strtotime('+8 hours')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:24:01.450

如果您想使用某个时区的时间，则首选使用 date_default_timezone_set()。无论如何，您可以为 date() 函数提供另一个参数：int 时间戳。一个整数，表示您希望 date() 返回有关信息的时间戳。所以如果你现在想显示 date('Ymd H:i:s') 你可以使用这个：

```
$now = date('Y-m-d H:i:s', time() ); // time() returns current timestamp.
// if you omit the second parameter of date(), it will use current timestamp
// by default.
$_8hoursLater = date('Y-m-d H:i:s', time()+60*60*8 );
$_8hoursBefore = date('Y-m-d H:i:s', time()-60*60*8 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T06:14:25.210

我会避开时区方法。

如果我理解正确，你想增加时间，从而改变它。例如，现在已经创建了一个任务，并且必须在 8 小时内完成。timezone 方法只会更改日期和时间的*显示*。仅当您知道访问者的时区时才更改时区设置，并且日期时间必须相对于他们显示。

现在：1234418228 是 2009/02/12 00:57:08 在蒙特利尔或 2009/02/11 09:57:08 在旧金山。这是完全相同的时刻。

附加到第一个答案， date() 和 strtotime() 是你的朋友。

strtotime( "+8 hours", $now ) $now 是它应该关联的时间戳。因此，如果您的开始时间不是 time()，您仍然可以使用它。例如

```
strtotime( "+8 hours", strtotime( "2009/03/01 00:00:00" ); (8AM on 2009/03/01) 
```

但是，在处理以周或更短时间计算的间隔时，我更喜欢“数学”

```
$StartTime = strtotime( "2009/03/01 13:00:00" );
$EndTime = $StartTime + ( 8 * 60 * 60 );
date( "Y/m/d H:i:s", $EndTime ) ==> "2009/03/01 21:00:00" 
```

一小时3600秒，一天86400秒。

您不能在几个月、几个季度或几年内使用此方法，因为它们持续的秒数因时间而异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T04:30:58.780

如果您正在寻找一种在用户本地时间显示时间戳的方法，您可以使用 JavaScript：

```
function showtime(t)
{
    if (t == 0)
    {
        document.write("never");
        return;
    }

    var currentTime = new Date(t);
    var month = currentTime.getMonth() + 1;
    var day = currentTime.getDate();
    var year = currentTime.getFullYear();
    var hours = currentTime.getHours();
    var minutes = currentTime.getMinutes();
    var seconds = currentTime.getSeconds();
    document.write();
    if (minutes < 10){
    minutes = "0" + minutes;
    }
    if (seconds < 10){
    seconds = "0" + seconds;
    }
    document.write(month + "/" + day + "/" + year + "&nbsp;&nbsp;&nbsp;" +
                hours + ":" + minutes + ":" + seconds + " ");
    if(hours > 11){
    document.write("PM");
    } else {
    document.write("AM");
    }
} 
```

然后，如果您需要显示时间，只需在 HTML 中调用它并拼接来自 PHP 的值：

```
<script type="text/javascript">showtime(<?=$time."000"?>)</script> 
```

# algorithm - 计算圆和三角形的交点面积？

> ID：540014
> 
> 赞同：21
> 
> 时间：2009-02-12T04:24:26.877
> 
> 标签：algorithm, geometry, computational-geometry, intersection, area

如何计算三角形（指定为三个 (X,Y) 对）和圆 (X,Y,R) 之间的相交面积？我做了一些搜索无济于事。这是为了工作，不是为了学校。:)

在 C# 中它看起来像这样：

```
struct { PointF vert[3]; } Triangle;
struct { PointF center; float radius; } Circle;

// returns the area of intersection, e.g.:
// if the circle contains the triangle, return area of triangle
// if the triangle contains the circle, return area of circle
// if partial intersection, figure that out
// if no intersection, return 0
double AreaOfIntersection(Triangle t, Circle c)
{
 ...
} 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2014-03-15T06:14:23.650

首先，我将提醒我们如何找到多边形的面积。完成此操作后，查找多边形和圆的交点的算法应该很容易理解。

# 如何求多边形的面积

让我们看一下三角形的情况，因为所有基本逻辑都出现在那里。假设我们有一个顶点为 (x1,y1)、(x2,y2) 和 (x3,y3) 的三角形，当您逆时针绕三角形时，如下图所示： ![三角形图](https://i.stack.imgur.com/s0gNn.png)

然后你可以通过公式计算面积

A=(x1 y2 + x2 y3 + x3 y1 - x2y1- x3 y2 - x1y3)/2。

要了解为什么这个公式有效，让我们重新排列它，使它的形式为

A=(x1 y2 - x2 y1)/2 + (x2 y3 - x3 y2)/2 + (x3 y1 - x1y3 )/2。

现在第一项是以下领域，这在我们的案例中是积极的： ![在此处输入图像描述](https://i.stack.imgur.com/7RhX2.png)

如果不清楚绿色区域的面积是否确实为 (x1 y2 - x2 y1)/2，请阅读[本文](https://math.stackexchange.com/a/299358)。

第二项是这个领域，这也是积极的：

![在此处输入图像描述](https://i.stack.imgur.com/gvrYx.png)

第三个区域如下图所示。这次面积为负

![在此处输入图像描述](https://i.stack.imgur.com/51mhe.png)

将这三个加起来我们得到下面的图片

![在此处输入图像描述](https://i.stack.imgur.com/8oJBP.png)

我们看到三角形之外的绿色区域被红色区域抵消了，因此净面积就是三角形的面积，这说明了为什么我们的公式在这种情况下是正确的。

我上面说的是对面积公式为什么正确的直观解释。更严格的解释是观察当我们从边缘计算面积时，我们得到的面积与我们从积分 r^2dθ/2 得到的面积相同，因此我们有效地在边界周围积分 r^2dθ/2根据斯托克斯定理，这给出了与在多边形边界区域上积分 rdrdθ 相同的结果。由于在由多边形包围的区域上积分 rdrdθ 给出了面积，我们得出结论，我们的程序必须正确给出面积。

# 圆与多边形相交的面积

现在让我们讨论如何找到半径为 R 的圆与多边形的交点面积，如下图所示：

![在此处输入图像描述](https://i.stack.imgur.com/hD5G9.png)

我们有兴趣找到绿色区域的面积。就像在单个多边形的情况下一样，我们可以将计算分解为为多边形的每一边找到一个区域，然后将这些区域相加。

我们的第一个区域将如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/JkRJc.png)

第二个区域看起来像 ![在此处输入图像描述](https://i.stack.imgur.com/UN28S.png)

第三个领域将是 ![在此处输入图像描述](https://i.stack.imgur.com/IX32R.png)

同样，在我们的案例中，前两个领域是积极的，而第三个领域是消极的。希望取消能够解决，以便净面积确实是我们感兴趣的区域。让我们看看。

![在此处输入图像描述](https://i.stack.imgur.com/oXC4E.png)

事实上，这些区域的总和将是我们感兴趣的区域。

同样，我们可以更严格地解释为什么会这样。令 I 为交点定义的区域，令 P 为多边形。然后从前面的讨论中，我们知道我们想要计算 r^2dθ/2 在 I 边界周围的积分。但是，这很难做到，因为它需要找到交点。

相反，我们对多边形进行了积分。我们在多边形的边界上集成了 max(r,R)^2 dθ/2。为了看看为什么这给出了正确的答案，让我们定义一个函数 π，它将极坐标 (r,θ) 中的一个点带到点 (max(r,R),θ)。引用 π(r)=max(r,R) 和 π(θ)=θ 的坐标函数应该不会造成混淆。然后我们所做的是在多边形的边界上积分 π(r)^2 dθ/2。

另一方面，由于 π(θ)=θ，这与在多边形边界上积分 π(r)^2 dπ(θ)/2 相同。

现在做一个变量的改变，我们发现如果我们在 π(P) 的边界上积分 r^2 dθ/2 会得到相同的答案，其中 π(P) 是 P 在 π 下的图像。

再次使用斯托克斯定理，我们知道在 π(P) 的边界上积分 r^2 dθ/2 得到了 π(P) 的面积。换句话说，它给出了与在 π(P) 上积分 dxdy 相同的答案。

再次使用变量的变化，我们知道 dxdy 在 π(P) 上的积分与 Jdxdy 在 P 上的积分相同，其中 J 是 π 的雅可比。

现在我们可以将 Jdxdy 的积分分成两个区域：圆内部分和圆外部分。现在 π 只在圆中留下点，所以在那里 J=1，所以 P 的这一部分的贡献是 P 位于圆中的部分的面积，即交点的面积。第二个区域是圆外的区域。J=0，因为 π 将这部分折叠到圆的边界。

因此，我们计算的确实是交叉点的面积。

现在我们相对确定我们在概念上知道如何找到该区域，让我们更具体地讨论如何计算单个段的贡献。让我们从我称之为“标准几何”的部分开始。如下所示。

![在此处输入图像描述](https://i.stack.imgur.com/axarl.png)

在标准几何中，边缘从左到右水平移动。它由三个数字描述：xi，边缘开始的 x 坐标，xf，边缘结束的 x 坐标，以及 y，边缘的 y 坐标。

现在我们看到如果 |y| < R，如图所示，那么边将在点 (-xint,y) 和 (xint,y) 处与圆相交，其中 xint = (R^2-y^2)^(1/2)。然后我们需要计算的区域被分成图中标记的三个部分。要获得区域 1 和 3 的面积，我们可以使用 arctan 来获得各个点的角度，然后将面积等同于 R^2 Δθ/2。例如，我们将设置 θi = atan2(y,xi) 和 θl = atan2(y,-xint)。那么区域一的面积是R^2 (θl-θi)/2。类似地，我们可以得到区域 3 的面积。

区域 2 的面积就是三角形的面积。但是，我们必须小心标志。我们希望显示的面积是正的，所以我们会说面积是 -(xint - (-xint))y/2。

要记住的另一件事是，通常，xi 不必小于 -xint，xf 不必大于 xint。

另一个要考虑的情况是 |y| > R. 这种情况比较简单，因为只有一块与图中区域1相似。

既然我们知道如何从标准几何中的边计算面积，剩下要做的就是描述如何将任何边转换为标准几何。

但这只是坐标的简单变化。给定一些初始顶点 vi 和最终顶点 vf，新的 x 单位向量将是从 vi 指向 vf 的单位向量。那么 xi 就是 vi 从点入 x 的圆心的位移，而 xf 就是 xi 加上 vi 和 vf 之间的距离。同时 y 由 x 与 vi 距圆心的位移的楔积给出。

# 代码

至此算法的描述就完成了，现在是时候编写一些代码了。我会用java。

首先，由于我们正在使用圆，我们应该有一个圆类

```
public class Circle {

    final Point2D center;
    final double radius;

    public Circle(double x, double y, double radius) {
        center = new Point2D.Double(x, y);
        this.radius = radius;
    }

    public Circle(Point2D.Double center, double radius) {
        this(center.getX(), center.getY(), radius);
    }

    public Point2D getCenter() {
        return new Point2D.Double(getCenterX(), getCenterY());
    }

    public double getCenterX() {
        return center.getX();
    }

    public double getCenterY() {
        return center.getY();
    }

    public double getRadius() {
        return radius;
    }

} 
```

对于多边形，我将使用 java 的`Shape`类。`Shape`s 有一个`PathIterator`我可以用来遍历多边形的边缘。

现在开始实际工作。一旦完成，我会将遍历边缘、将边缘置于标准几何图形等中的逻辑与计算区域的逻辑分开。这样做的原因是，您将来可能想要计算除该区域之外的其他东西，并且您希望能够重用必须处理迭代边缘的代码。

所以我有一个通用类，它计算`T`关于我们的多边形圆交点的类的一些属性。

`public abstract class CircleShapeIntersectionFinder<T> {`

它具有三个静态方法，仅帮助计算几何：

```
private static double[] displacment2D(final double[] initialPoint, final double[] finalPoint) {
    return new double[]{finalPoint[0] - initialPoint[0], finalPoint[1] - initialPoint[1]};
}

private static double wedgeProduct2D(final double[] firstFactor, final double[] secondFactor) {
    return firstFactor[0] * secondFactor[1] - firstFactor[1] * secondFactor[0];
}

static private double dotProduct2D(final double[] firstFactor, final double[] secondFactor) {
    return firstFactor[0] * secondFactor[0] + firstFactor[1] * secondFactor[1];
} 
```

有两个实例字段，a`Circle`只保留圆的副本`currentSquareRadius`，而 保留正方形半径的副本。这可能看起来很奇怪，但我使用的类实际上可以找到整个圆形多边形交叉点的区域。这就是为什么我将其中一个圈子称为“当前”。

```
private Circle currentCircle;
private double currentSquareRadius; 
```

接下来是计算我们想要计算的方法：

```
public final T computeValue(Circle circle, Shape shape) {
    initialize();
    processCircleShape(circle, shape);
    return getValue();
} 
```

`initialize()`并且`getValue()`是抽象的。`initialize()`将保持总面积为零的变量设置为，并且`getValue()`只返回该面积。的定义`processCircleShape`是

```
private void processCircleShape(Circle circle, final Shape cellBoundaryPolygon) {
    initializeForNewCirclePrivate(circle);
    if (cellBoundaryPolygon == null) {
        return;
    }
    PathIterator boundaryPathIterator = cellBoundaryPolygon.getPathIterator(null);
    double[] firstVertex = new double[2];
    double[] oldVertex = new double[2];
    double[] newVertex = new double[2];
    int segmentType = boundaryPathIterator.currentSegment(firstVertex);
    if (segmentType != PathIterator.SEG_MOVETO) {
        throw new AssertionError();
    }
    System.arraycopy(firstVertex, 0, newVertex, 0, 2);
    boundaryPathIterator.next();
    System.arraycopy(newVertex, 0, oldVertex, 0, 2);
    segmentType = boundaryPathIterator.currentSegment(newVertex);
    while (segmentType != PathIterator.SEG_CLOSE) {
        processSegment(oldVertex, newVertex);
        boundaryPathIterator.next();
        System.arraycopy(newVertex, 0, oldVertex, 0, 2);
        segmentType = boundaryPathIterator.currentSegment(newVertex);
    }
    processSegment(newVertex, firstVertex);
} 
```

让我们花点时间快速看一下`initializeForNewCirclePrivate`。此方法只是设置实例字段并允许派生类存储圆的任何属性。它的定义是

```
private void initializeForNewCirclePrivate(Circle circle) {
    currentCircle = circle;
    currentSquareRadius = currentCircle.getRadius() * currentCircle.getRadius();
    initializeForNewCircle(circle);
} 
```

`initializeForNewCircle`是抽象的，一种实现是存储圆的半径以避免必须做平方根。反正回`processCircleShape`。调用后`initializeForNewCirclePrivate`，我们检查多边形是否是`null`（我将其解释为空多边形），如果是则返回`null`。在这种情况下，我们计算的面积将为零。如果多边形不是`null`，那么我们得到`PathIterator`多边形的。我调用的方法的参数`getPathIterator`是可以应用于路径的仿射变换。不过我不想申请，所以我就通过了`null`。

接下来我声明`double[]`将跟踪顶点的 s。我必须记住第一个顶点，因为`PathIterator`它只给了我每个顶点一次，所以我必须在它给我最后一个顶点后返回，并用最后一个顶点和第一个顶点形成一条边。

下一行的`currentSegment`方法将下一个顶点放入其参数中。它返回一个代码，告诉您它何时超出顶点。这就是为什么我的 while 循环的控制表达式就是这样的原因。

此方法的大部分其余代码都是与遍历顶点相关的无趣逻辑。重要的是，每次 while 循环的迭代`processSegment`我调用一次，然后`processSegment`在方法结束时再次调用以处理将最后一个顶点连接到第一个顶点的边。

让我们看一下代码`processSegment`：

```
private void processSegment(double[] initialVertex, double[] finalVertex) {
    double[] segmentDisplacement = displacment2D(initialVertex, finalVertex);
    if (segmentDisplacement[0] == 0 && segmentDisplacement[1] == 0) {
        return;
    }
    double segmentLength = Math.sqrt(dotProduct2D(segmentDisplacement, segmentDisplacement));
    double[] centerToInitialDisplacement = new double[]{initialVertex[0] - getCurrentCircle().getCenterX(), initialVertex[1] - getCurrentCircle().getCenterY()};
    final double leftX = dotProduct2D(centerToInitialDisplacement, segmentDisplacement) / segmentLength;
    final double rightX = leftX + segmentLength;
    final double y = wedgeProduct2D(segmentDisplacement, centerToInitialDisplacement) / segmentLength;
    processSegmentStandardGeometry(leftX, rightX, y);
} 
```

在这种方法中，我实现了将边缘转换为上述标准几何图形的步骤。首先我计算`segmentDisplacement`从初始顶点到最终顶点的位移。这定义了标准几何图形的 x 轴。如果这个位移为零，我会提前返回。

接下来我计算位移的长度，因为这是获得 x 单位向量的必要条件。一旦我有了这些信息，我就会计算从圆心到初始顶点的位移。这个的点积`segmentDisplacement`给了我`leftX`我一直称之为 xi 的我。然后`rightX`，我一直称之为 xf，只是`leftX + segmentLength`. 最后我做楔形产品得到`y`如上所述。

现在我已经将问题转化为标准几何，它会很容易处理。这就是该`processSegmentStandardGeometry`方法的作用。让我们看一下代码

```
private void processSegmentStandardGeometry(double leftX, double rightX, double y) {
    if (y * y > getCurrentSquareRadius()) {
        processNonIntersectingRegion(leftX, rightX, y);
    } else {
        final double intersectionX = Math.sqrt(getCurrentSquareRadius() - y * y);
        if (leftX < -intersectionX) {
            final double leftRegionRightEndpoint = Math.min(-intersectionX, rightX);
            processNonIntersectingRegion(leftX, leftRegionRightEndpoint, y);
        }
        if (intersectionX < rightX) {
            final double rightRegionLeftEndpoint = Math.max(intersectionX, leftX);
            processNonIntersectingRegion(rightRegionLeftEndpoint, rightX, y);
        }
        final double middleRegionLeftEndpoint = Math.max(-intersectionX, leftX);
        final double middleRegionRightEndpoint = Math.min(intersectionX, rightX);
        final double middleRegionLength = Math.max(middleRegionRightEndpoint - middleRegionLeftEndpoint, 0);
        processIntersectingRegion(middleRegionLength, y);
    }
} 
```

第一个`if`区分`y`小到足以使边缘与圆相交的情况。如果`y`很大并且没有交叉的可能性，那么我调用该方法来处理这种情况。否则我会处理可能相交的情况。

如果可能相交，我计算相交的 x 坐标`intersectionX`，并将边分成三部分，分别对应于上面标准几何图形的区域 1、2 和 3。首先我处理区域 1。

为了处理区域 1，我检查是否`leftX`确实小于`-intersectionX`，否则将没有区域 1。如果有区域 1，那么我需要知道它何时结束。`rightX`它以和的最小值结束`-intersectionX`。找到这些 x 坐标后，我将处理这个非相交区域。

我做了类似的事情来处理区域 3。

对于区域 2，我必须做一些逻辑来检查它`leftX`，并`rightX`实际上将某个区域括在`-intersectionX`和之间`intersectionX`。找到区域后，我只需要区域的长度 和`y`，因此我将这两个数字传递给处理区域 2 的抽象方法。

现在让我们看一下代码`processNonIntersectingRegion`

```
private void processNonIntersectingRegion(double leftX, double rightX, double y) {
    final double initialTheta = Math.atan2(y, leftX);
    final double finalTheta = Math.atan2(y, rightX);
    double deltaTheta = finalTheta - initialTheta;
    if (deltaTheta < -Math.PI) {
        deltaTheta += 2 * Math.PI;
    } else if (deltaTheta > Math.PI) {
        deltaTheta -= 2 * Math.PI;
    }
    processNonIntersectingRegion(deltaTheta);
} 
```

我只是`atan2`用来计算 和 之间的角度`leftX`差`rightX`。然后我添加代码来处理 中的不连续性`atan2`，但这可能是不必要的，因为不连续性发生在 180 度或 0 度。然后我将角度差异传递给抽象方法。最后，我们只有抽象方法和 getter：

```
 protected abstract void initialize();

    protected abstract void initializeForNewCircle(Circle circle);

    protected abstract void processNonIntersectingRegion(double deltaTheta);

    protected abstract void processIntersectingRegion(double length, double y);

    protected abstract T getValue();

    protected final Circle getCurrentCircle() {
        return currentCircle;
    }

    protected final double getCurrentSquareRadius() {
        return currentSquareRadius;
    }

} 
```

现在让我们看看扩展类，`CircleAreaFinder`

```
public class CircleAreaFinder extends CircleShapeIntersectionFinder<Double> {

public static double findAreaOfCircle(Circle circle, Shape shape) {
    CircleAreaFinder circleAreaFinder = new CircleAreaFinder();
    return circleAreaFinder.computeValue(circle, shape);
}

double area;

@Override
protected void initialize() {
    area = 0;
}

@Override
protected void processNonIntersectingRegion(double deltaTheta) {
    area += getCurrentSquareRadius() * deltaTheta / 2;
}

@Override
protected void processIntersectingRegion(double length, double y) {
    area -= length * y / 2;
}

@Override
protected Double getValue() {
    return area;
}

@Override
protected void initializeForNewCircle(Circle circle) {

} 
```

}

它有一个字段`area`来跟踪该区域。`initialize`正如预期的那样，将区域设置为零。当我们处理非相交边时，我们将面积增加 R^2 Δθ/2，正如我们在上面得出的结论。对于相交边，我们将面积减小`y*length/2`. 这样一来，负值`y`对应于正区域，正如我们决定的那样。

现在很巧妙的是，如果我们想要跟踪周界，我们就不必做更多的工作。我定义了一个`AreaPerimeter`类：

```
public class AreaPerimeter {

    final double area;
    final double perimeter;

    public AreaPerimeter(double area, double perimeter) {
        this.area = area;
        this.perimeter = perimeter;
    }

    public double getArea() {
        return area;
    }

    public double getPerimeter() {
        return perimeter;
    }

} 
```

`AreaPerimeter`现在我们只需要使用作为类型再次扩展我们的抽象类。

```
public class CircleAreaPerimeterFinder extends CircleShapeIntersectionFinder<AreaPerimeter> {

    public static AreaPerimeter findAreaPerimeterOfCircle(Circle circle, Shape shape) {
        CircleAreaPerimeterFinder circleAreaPerimeterFinder = new CircleAreaPerimeterFinder();
        return circleAreaPerimeterFinder.computeValue(circle, shape);
    }

    double perimeter;
    double radius;
    CircleAreaFinder circleAreaFinder;

    @Override
    protected void initialize() {
        perimeter = 0;
        circleAreaFinder = new CircleAreaFinder();
    }

    @Override
    protected void initializeForNewCircle(Circle circle) {
        radius = Math.sqrt(getCurrentSquareRadius());
    }

    @Override
    protected void processNonIntersectingRegion(double deltaTheta) {
        perimeter += deltaTheta * radius;
        circleAreaFinder.processNonIntersectingRegion(deltaTheta);
    }

    @Override
    protected void processIntersectingRegion(double length, double y) {
        perimeter += Math.abs(length);
        circleAreaFinder.processIntersectingRegion(length, y);
    }

    @Override
    protected AreaPerimeter getValue() {
        return new AreaPerimeter(circleAreaFinder.getValue(), perimeter);
    }

} 
```

我们有一个变量`perimeter`来跟踪周长，我们记住 的值`radius`以避免调用`Math.sqrt`很多，我们将面积的计算委托给我们的`CircleAreaFinder`. 我们可以看到周长的公式很简单。

参考这里是完整的代码`CircleShapeIntersectionFinder`

```
private static double[] displacment2D(final double[] initialPoint, final double[] finalPoint) {
        return new double[]{finalPoint[0] - initialPoint[0], finalPoint[1] - initialPoint[1]};
    }

    private static double wedgeProduct2D(final double[] firstFactor, final double[] secondFactor) {
        return firstFactor[0] * secondFactor[1] - firstFactor[1] * secondFactor[0];
    }

    static private double dotProduct2D(final double[] firstFactor, final double[] secondFactor) {
        return firstFactor[0] * secondFactor[0] + firstFactor[1] * secondFactor[1];
    }

    private Circle currentCircle;
    private double currentSquareRadius;

    public final T computeValue(Circle circle, Shape shape) {
        initialize();
        processCircleShape(circle, shape);
        return getValue();
    }

    private void processCircleShape(Circle circle, final Shape cellBoundaryPolygon) {
        initializeForNewCirclePrivate(circle);
        if (cellBoundaryPolygon == null) {
            return;
        }
        PathIterator boundaryPathIterator = cellBoundaryPolygon.getPathIterator(null);
        double[] firstVertex = new double[2];
        double[] oldVertex = new double[2];
        double[] newVertex = new double[2];
        int segmentType = boundaryPathIterator.currentSegment(firstVertex);
        if (segmentType != PathIterator.SEG_MOVETO) {
            throw new AssertionError();
        }
        System.arraycopy(firstVertex, 0, newVertex, 0, 2);
        boundaryPathIterator.next();
        System.arraycopy(newVertex, 0, oldVertex, 0, 2);
        segmentType = boundaryPathIterator.currentSegment(newVertex);
        while (segmentType != PathIterator.SEG_CLOSE) {
            processSegment(oldVertex, newVertex);
            boundaryPathIterator.next();
            System.arraycopy(newVertex, 0, oldVertex, 0, 2);
            segmentType = boundaryPathIterator.currentSegment(newVertex);
        }
        processSegment(newVertex, firstVertex);
    }

    private void initializeForNewCirclePrivate(Circle circle) {
        currentCircle = circle;
        currentSquareRadius = currentCircle.getRadius() * currentCircle.getRadius();
        initializeForNewCircle(circle);
    }

    private void processSegment(double[] initialVertex, double[] finalVertex) {
        double[] segmentDisplacement = displacment2D(initialVertex, finalVertex);
        if (segmentDisplacement[0] == 0 && segmentDisplacement[1] == 0) {
            return;
        }
        double segmentLength = Math.sqrt(dotProduct2D(segmentDisplacement, segmentDisplacement));
        double[] centerToInitialDisplacement = new double[]{initialVertex[0] - getCurrentCircle().getCenterX(), initialVertex[1] - getCurrentCircle().getCenterY()};
        final double leftX = dotProduct2D(centerToInitialDisplacement, segmentDisplacement) / segmentLength;
        final double rightX = leftX + segmentLength;
        final double y = wedgeProduct2D(segmentDisplacement, centerToInitialDisplacement) / segmentLength;
        processSegmentStandardGeometry(leftX, rightX, y);
    }

    private void processSegmentStandardGeometry(double leftX, double rightX, double y) {
        if (y * y > getCurrentSquareRadius()) {
            processNonIntersectingRegion(leftX, rightX, y);
        } else {
            final double intersectionX = Math.sqrt(getCurrentSquareRadius() - y * y);
            if (leftX < -intersectionX) {
                final double leftRegionRightEndpoint = Math.min(-intersectionX, rightX);
                processNonIntersectingRegion(leftX, leftRegionRightEndpoint, y);
            }
            if (intersectionX < rightX) {
                final double rightRegionLeftEndpoint = Math.max(intersectionX, leftX);
                processNonIntersectingRegion(rightRegionLeftEndpoint, rightX, y);
            }
            final double middleRegionLeftEndpoint = Math.max(-intersectionX, leftX);
            final double middleRegionRightEndpoint = Math.min(intersectionX, rightX);
            final double middleRegionLength = Math.max(middleRegionRightEndpoint - middleRegionLeftEndpoint, 0);
            processIntersectingRegion(middleRegionLength, y);
        }
    }

    private void processNonIntersectingRegion(double leftX, double rightX, double y) {
        final double initialTheta = Math.atan2(y, leftX);
        final double finalTheta = Math.atan2(y, rightX);
        double deltaTheta = finalTheta - initialTheta;
        if (deltaTheta < -Math.PI) {
            deltaTheta += 2 * Math.PI;
        } else if (deltaTheta > Math.PI) {
            deltaTheta -= 2 * Math.PI;
        }
        processNonIntersectingRegion(deltaTheta);
    }

    protected abstract void initialize();

    protected abstract void initializeForNewCircle(Circle circle);

    protected abstract void processNonIntersectingRegion(double deltaTheta);

    protected abstract void processIntersectingRegion(double length, double y);

    protected abstract T getValue();

    protected final Circle getCurrentCircle() {
        return currentCircle;
    }

    protected final double getCurrentSquareRadius() {
        return currentSquareRadius;
    } 
```

无论如何，这就是我对算法的描述。我认为这很好，因为它是准确的，并且没有太多需要检查的案例。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-02-19T21:57:36.370

如果您想要一个精确的解决方案（或至少与使用浮点算术一样精确），那么这将涉及大量的跑腿工作，因为要考虑的案例太多了。

我统计了九种不同的情况（下图中按圆内三角形的顶点数，以及与圆相交或包含在圆内的三角形的边数分类）：

![相交九种情况：1、2.无顶点，无边； 3.没有顶点，只有一条边； 4.没有顶点，两条边； 5.无顶点，三边； 6.一个顶点，两条边； 7.一个顶点，三个边； 8.两个顶点，三个边； 9.三个顶点，三个边。](https://i.stack.imgur.com/4A8EJ.png)

（然而，众所周知，这种几何案例的枚举很棘手，如果我错过了一两个，我一点也不感到惊讶！）

所以方法是：

1.  确定三角形的每个顶点是否在圆内。我假设你知道怎么做。

2.  确定三角形的每条边是否与圆相交。[（我在这里](http://garethrees.org/2009/02/17/physics/#section-4)写了一种方法，或者查看任何计算几何书。）您需要计算一个或多个交点（如果有）以在步骤 4 中使用。

3.  确定你有九个案例中的哪一个。

4.  计算交叉点的面积。案例 1、2 和 9 很简单。在其余六个案例中，我绘制了虚线，以显示如何根据三角形的原始顶点以及您在步骤 2 中计算的交点将交点区域划分为三角形和[圆形线段。](http://en.wikipedia.org/wiki/Circular_segment)

该算法将相当精细并且容易出现仅影响其中一种情况的错误，因此请确保您有涵盖所有九种情况的测试用例（我建议也置换测试三角形的顶点）。特别注意三角形的一个顶点在圆的边缘上的情况。

如果您不需要精确的解决方案，那么将图形栅格化并计算交叉点中的像素（正如其他几位受访者所建议的那样）似乎是一种更容易编写代码的方法，并且相应地不易出错。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-19T04:49:21.010

我迟到了将近一年半，但我想也许人们会对我写的[代码](http://github.com/victorliu/Templated-Numerics/blob/master/AnalyticGeometry/TIntersection2.hpp)感兴趣，我认为这是正确的。查看底部附近的函数 IntersectionArea。一般的做法是把圆外接的凸多边形挑掉，然后处理小圆帽。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T04:31:32.413

假设您说的是整数像素，而不是真实的，那么简单的实现将是遍历三角形的每个像素并检查圆心与半径的距离。

这不是一个可爱的公式，或者特别快，但它确实完成了工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T04:35:48.973

尝试[计算几何](http://www.cgal.org/)

注意：这不是一个小问题，我希望它不是功课;-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T04:56:07.597

如果您有 GPU 可供使用，则可以使用[此](https://stackoverflow.com/questions/534989/what-algorithm-can-i-use-to-determine-points-within-a-semi-circle/535059#535059)技术来获取交叉点的像素数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T05:35:37.720

我认为你不应该将圆形近似为一组三角形，而不是你可以用多边形近似它的形状。朴素算法可能如下所示：

1.  将您的圆转换为具有所需顶点数量的多边形。
2.  计算两个多边形（转换后的圆和三角形）的交点。
3.  计算该交点的平方。

您可以通过将步骤 2 和步骤 3 组合成单个函数来优化此算法。

阅读此链接：凸多边形的
[面积 凸多边形](http://www.mathwords.com/a/area_convex_polygon.htm)
[的交集](http://www.iro.umontreal.ca/~plante/compGeom/algorithm.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T08:46:00.727

由于您的形状是凸形的，因此您可以使用蒙特卡洛面积估计。

在圆形和三角形周围画一个框。

选择框中的随机点并计算有多少落在圆圈中，以及有多少落在圆形和三角形中。

交点面积 ≅ 圆面积 * # 圆和三角形中的点 / # 圆中的点

当估计的面积在一定轮数内变化不超过一定量时停止选点，或者只是根据盒子的面积选择固定数量的点。面积估计应该很快收敛，除非你的一个形状的面积很小。

注意：确定一个点是否在三角形中的方法如下：[重心坐标](http://en.wikipedia.org/wiki/Barycentric_coordinates_(mathematics)#Determining_if_a_point_is_inside_a_triangle)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-12T04:52:51.380

你需要精确到什么程度？如果您可以用更简单的形状近似圆形，则可以简化问题。例如，将圆建模为一组在中心相交的非常窄的三角形并不难。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T05:09:35.757

如果只有一个三角形的线段与圆相交，那么纯数学解决方案并不太难。一旦知道了两个交点的时间，就可以使用距离公式来计算弦长。

根据[这些方程](http://mathforum.org/dr.math/faq/faq.circle.segment.html#7)：

```
ϑ = 2 sin⁻¹(0.5 c / r)
A = 0.5 r² (ϑ - sin(ϑ)) 
```

其中 c 是弦长，r 是半径，ϑ 是通过中心的角度，A 是面积。请注意，如果超过一半的圆被切断，则此解决方案会中断。

如果您只需要一个近似值，则可能不值得付出努力，因为它对实际交叉点的外观做出了几个假设。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T06:02:26.033

我的第一直觉是转换一切，使圆以原点为中心，将三角形转换为极坐标，并求解三角形与圆的交点（或包围）。我实际上还没有在纸上完成它，所以这只是一种预感。

# html - 所见即所得编辑器 vs 手动代码

> ID：540023
> 
> 赞同：16
> 
> 时间：2009-02-12T04:28:32.187
> 
> 标签：html, wysiwyg

使用所见即所得编辑器进行网页开发与手动编码的优缺点是什么？

除了不知道如何通过手工编码创建某些东西之外，还有什么理由使用 WYSIWYG？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T04:39:45.937

在创建 HTML 时使用 WYSIWYG 编辑器有多种原因。

*   允许快速原型设计
*   允许设计人员积极参与前端开发
*   一些 WYSIWYG 工具将为您设置一个干净的基础进行修改（Dreamweaver 的 CSS 布局实际上非常好）

我认为要记住的重要一点是，在您将其大致成形后，您应该深入研究代码并确保没有发生任何奇怪的事情。嵌套跨度、奇怪的绝对定位和（全能的上帝）基于表格的布局算作奇怪的事情。即使您使用 WYSIWYG 开始，您也应该始终检查代码是否有效并且看起来像您期望的那样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T09:01:22.787

我手工编码，但我更喜欢使用所见即所得的编辑器，因此我仍在使用 Dreamweaver 作为编辑器。我 95% 的时间都在做源代码编辑器中的手工编码并在预览中查看结果。偶尔我会进入所见即所得编辑器直接移动块，当我这样做时，我发现它非常宝贵。我*从不*使用任何 Dreamweavers 向导或生成的代码，我也手动清理了 html。

我认为这种方法没有任何问题，它让我觉得 HTML 设计相当于 IDE 提示完成功能等（intellisense 或任何你的 IDE 可能称之为的东西）

我也总是使用一种或另一种形式的模板系统，因此我的脚本代码与 html 完全分开。

与 Dreamweaver 的结合，偶尔的所见即所得编辑（我在布置或进行“宏”布局更改时发现非常宝贵）和一键预览让我一直使用它，尽管我使用了更好的工具 - Aptana、NetBeans 等。事实上，我会非常感激喜欢移动到另一个系统 -[看到这个问题](https://stackoverflow.com/questions/377741/need-a-wysiwyg-php-javascript-ide-replacement-for-dreamweaver)- 最好是在 Ubuntu 上运行并去除 Dreamweaver 中的杂物，只留下所见即所得的功能和可能的智能 Javascript 编辑器，但我还没有找到任何东西。[KompoZer](http://kompozer.net/)开始看起来很有希望。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T04:36:38.283

如果您不了解 HTML 或者只是想以极快的速度将某些东西组合在一起，WYSIWYG 会很方便。但是，您不会得到干净的代码。大多数 WSYIWIG 编辑器仍然会丢弃一堆不需要的脏 HTML，而不是干净的实体标记。

任何熟悉 HTML 的人通常都可以在 HTML 编辑器中以同样快的速度手动制作一些东西。它将是干净的、符合 xhtml 的语义标记，而不是把模板与无关的杂物拼凑在一起。

如果您正确设置了模板和 css，那么手动编码可能比 WSYIWYG 编辑器*更快*，因为当您尝试使用可降解的语义标记创建正确抽象的 css 时，这些对您不利。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T04:32:48.667

如果设计不是非常重要并且您只是将网站放在一起，那么使用所见即所得并没有错。或者，如果您正在尝试为客户创建一个功能有限的模型，这是快速构建某些东西的好方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T04:56:28.237

我大部分时间都在 ASP.net 中开发，所以我大部分时间都在 VS2008 中；但是只要有可能（大多数情况下）我仍然编写代码....但我是在 VS2008 的源代码模式下进行的。使用 ASP.net 时，总有一些臃肿的代码，您不得不接受（在某种程度上）。

然而，在我的空闲时间，我也做 php 开发，而且我永远***不会***用 php 手工编写代码。另外，它不像带有拖放功能的 VS。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T08:40:24.243

如果你想真正擅长你所做的事情，就像在 Guru 中一样优秀，放弃所见即所得的东西并开始手动编码。学习曲线更陡峭，但它会让你以一种有意义的方式更好地完成你所做的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-07T06:48:17.240

它归结为可维护性和可变性。在 GUI 编辑器中更改 GUI 布局通常比手动更改要容易得多。

“哦，您想将该 JTable 从这个位置移动到另一个完全不相关的位置”。如果你手工编码，它基本上是一个编程工作（对于非平凡的布局可能实际上是困难的），但如果它在一个好的 GUI 编辑器中，它可能只是一个点击移动的问题-释放。

手工编码的人可能从来不需要做那种改变:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-01T14:37:48.723

使用所见即所得编辑器进行 Web 开发的优势非常明显。即使您知道如何编写 Web 代码，开发也更加简单和快捷，因为 Web 开发需要了解许多不同的语言，并且在尝试让它们按计划协同工作时可能会变得混乱。真正的所见即所得设计师应该能够通过允许您在一层中以一种形式进行可视化开发来解决这些复杂性。这种开发范式的缺点可能是它有时会限制您，这意味着您通常被限制在预定义的框架内。

因此，重要的是找到一个在其所见即所得的开发经验之上对扩展和定制开放的框架。看看[http://www.visualwebgui.com/](http://www.visualwebgui.com/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-12T04:35:41.920

这与 Glade 与手动编码 Gtk 代码的类型相同。我认为您添加了一定程度的混淆以及在您手动编辑代码时可能会破坏的内容。但是，正如斯宾塞所说，如果您需要这样做并且它需要工作；通常所见即所得会工作得非常好和可靠。如果你正在做一些你将要保持最新状态并在未来几年内进行管理的事情；您应该知道该应用程序/网页中的每一段代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T05:32:10.227

实际上，这取决于您的工作职能。如果您主要是一名设计师，所见即所得的编辑器可以非常方便地为客户创建模型，或者可以将原型交给开发人员进行编码。

如果您是开发人员，您可能更喜欢手工编码。

大多数 WYSIWYG 编辑器都提供代码视图和设计视图，让您可以轻松地来回切换。

我的建议是尝试学习如何手动编码您的网站。经过多年的网络开发，我发现手工编码比尝试使用设计师更快。此外，当您更好地理解 HTML 和 CSS 如何协同工作时，您会发现几乎没有什么是不能优雅地完成的。

学习可能会令人沮丧，但你会发现从长远来看你会变得更好。

# embedded - 工作站和嵌入式程序员之间的心态差异

> ID：540025
> 
> 赞同：10
> 
> 时间：2009-02-12T04:30:32.573
> 
> 标签：embedded

您认为为桌面环境（windows、linux 等）工作的程序员和在嵌入式系统上工作的人在思维方式上有什么区别？

我能想到的一个简单例子是，在嵌入式环境中，我**总是**检查 malloc 是否不为 NULL。我见过的大多数代码，目标桌面肯定不会认真检查 malloc 返回值。

还有其他心态差异的例子吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-12T06:00:32.310

有趣的是，您在示例中特别提到了 malloc() 。

在我从事的每一个硬实时、深度嵌入式系统中，内存分配都是专门管理的（通常不是堆，而是固定内存池或类似的东西）......而且，只要有可能，所有内存分配都是在初始化期间预先完成。这比大多数人想象的要容易得多。

malloc() 容易受到碎片的影响，是不确定的，并且不区分内存类型。使用内存池，您可以拥有位于/从超快速 SRAM、快速 DRAM、电池支持的 RAM（我已经看到）等中提取/提取的池......

还有一百个其他问题（回答您的原始问题），但内存分配是一个大问题。

还：

*   尊重/了解硬件平台
*   不会自动假设硬件是完美的，甚至是功能正常的
*   了解可能导致事情快速发展的某些语言方面和特性（例如，C++ 中的异常）
*   了解 CPU 负载和内存利用率
*   了解中断、抢占以及对共享数据的影响（在绝对必要的情况下——共享数据越少越好）
*   大多数嵌入式系统是数据/事件驱动的，而不是轮询的；当然也有例外
*   大多数嵌入式开发人员对状态机和有状态行为/建模的概念非常满意

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-12T04:53:02.457

桌面程序员认为资源实际上是无限的。内存、计算能力、驱动空间。那些永远不会用完。嵌入式程序员专注于所有这些。

哦，嵌入式程序员也经常要担心内存对齐问题。桌面编码器没有。Arm芯片很关心。x86 芯片没有。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-12T04:37:42.213

我的桌面环境有这样的想法：“嘿，我总是可以在以后发布更新或补丁来修复这个问题。” 在嵌入式设计中，你会得到更多“这必须起作用，因为我们不想召回设备或发布更长的补丁程序。”

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-12T04:42:59.547

大小事项

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T04:52:16.263

两件事——正如 Suroot 已经提到的，一旦你发布了一个桌面应用程序，它不一定是“永远”的，尤其是现在。

但是在嵌入式中，一旦你“运送”它，它就会在前往火星的途中，所以你将无法将它拉回来。

另一个主要区别是嵌入式程序员通常更注重高效的代码和内存管理——台式机运行糟糕的代码非常快，而嵌入式则不然。

# webserver - 将多个硬盘驱动器显示为一个的集群/负载平衡软件？

> ID：540034
> 
> 赞同：0
> 
> 时间：2009-02-12T04:35:19.910
> 
> 标签：webserver, load-balancing, cluster-computing

有谁知道集群/负载平衡软件（免费或商业），一旦设置，只需要您在一个地方登录，所有硬盘驱动器都安装在一起？

例如，目前我有 1 台服务器，我通过访问 www.myurl.com/cpanel 访问它，并显示一个硬盘驱动器，我在那里上传了我所有的网站文件。

如果我有 100 台 linux 或 windows 服务器使用负载平衡器连接在一起并希望将它们作为一个集群运行，是否有软件可以让我直接访问 www.myurl.com/cpanel，一旦我登录，我将不会看到超过 1 个硬盘驱动器，但我会看到所有硬盘驱动器的总空间，所以我可以只上传 1 个文件，它会自动上传到所有硬盘驱动器？

如果目前没有这样的软件，你认为有可能编写这样的程序吗？或者有没有一个软件，你把文件放在你的网站上，网站访问者下载它，一旦他们运行文件并连接到互联网，他们的互联网连接就成为你的网络服务器的一部分，所以当人们访问你的网站时，一些数据和 cpu 使用情况来自您的 Web 服务器，而一些数据和 cpu 使用情况来自下载文件的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T04:42:07.147

您在您的问题中谈论 2 个不同的东西 -**镜像驱动器**和**分布式存储**。

例如，EMC 的 SAN（存储区域网络）产品可以让您对存储的处理方式大吃一惊。SAN 技术还有其他本地磁盘，例如 iSCSI。

对于您想要做的事情，您希望在 100 台服务器上镜像一个文件夹。我认为 *nix 服务器具有 RSYNC 技术，而 Windows Server 2003 R2 具有文件复制服务。我确实知道 FRS（分布式文件系统技术的一部分）将完全按照您的意愿行事，并且在 Windows Server 2003（仅限 R2）和 2008 中开箱即用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T23:46:04.667

查看[直接连接存储](http://en.wikipedia.org/wiki/Direct-attached_storage)和[存储区域网络](http://en.wikipedia.org/wiki/Storage_area_network)。

据我所知，DAS 更便宜，因为它运行在现有的网络基础设施上，而 SAN 基本上有自己的专用光纤网络，与常规网络平行。

实际上，该维基百科链接是旧的.. 有关更好的示例，请参阅戴尔的[DAS 选项](http://www.dell.com/content/products/compare.aspx/das?c=us&cs=555&l=en&s=biz)。

# python - 如何在 Windows 中安装 Satchmo？

> ID：540046
> 
> 赞同：0
> 
> 时间：2009-02-12T04:40:04.563
> 
> 标签：python, windows, django, windows-vista, satchmo

我正在开发一个 Django 项目，该项目计划将 Satchmo 用于其电子商务方面。我想将它安装在我的 Windows Vista 机器上，但它需要的一些 cPython 模块无法编译或 easy_installed。

有没有人能够让 Satchmo 在 Windows 上运行，如果是这样，它会接管安装说明的哪些额外步骤？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T01:12:15.520

您在使用哪些模块时遇到问题？Pycrypto 二进制文件在这里 - [http://www.voidspace.org.uk/python/modules.shtml#pycrypto](http://www.voidspace.org.uk/python/modules.shtml#pycrypto) Python 成像二进制文件在这里 - [http://www.pythonware.com/products/pil/](http://www.pythonware.com/products/pil/)

我相信其他一切都是纯python，所以安装其余的应该很简单。

# cocoa - 如何在 Cocoa 中实现渐变按钮栏

> ID：540048
> 
> 赞同：1
> 
> 时间：2009-02-12T04:41:06.340
> 
> 标签：cocoa, menu, interface-builder, sidebar

一些 Cocoa 应用程序（例如 Mail 和 Automator）通常在它们的窗口底部有一个特殊的控件：

[替代文字 http://img150.imageshack.us/img150/9084/picture2vm3.png](http://img150.imageshack.us/img150/9084/picture2vm3.png)

您能否分享使用标准图像和弹出按钮制作相同操作栏的最佳实践？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T05:07:21.610

你可能想要[BWToolkit](http://www.brandonwalkin.com/blog/2008/11/13/introducing-bwtoolkit/)

# c# - 从 C# 中的字符串调用函数

> ID：540066
> 
> 赞同：155
> 
> 时间：2009-02-12T04:49:29.797
> 
> 标签：c#, .net, php, string, function-calls

我知道在 php 中你可以拨打如下电话：

```
$function_name = 'hello';
$function_name();

function hello() { echo 'hello'; } 
```

这在.Net中可能吗？

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2009-02-12T04:53:33.297

是的。您可以使用反射。像这样的东西：

```
Type thisType = this.GetType();
MethodInfo theMethod = thisType.GetMethod(TheCommandString);
theMethod.Invoke(this, userParameters); 
```

使用上面的代码，被调用的方法必须有访问修饰符`public`。如果调用非公共方法，则需要使用`BindingFlags`参数，例如`BindingFlags.NonPublic | BindingFlags.Instance`：

```
Type thisType = this.GetType();
MethodInfo theMethod = thisType
    .GetMethod(TheCommandString, BindingFlags.NonPublic | BindingFlags.Instance);
theMethod.Invoke(this, userParameters); 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2009-02-12T04:57:56.063

您可以使用反射调用类实例的方法，执行动态方法调用：

假设您在实际实例 (this) 中有一个名为 hello 的方法：

```
string methodName = "hello";

//Get the method information using the method info class
 MethodInfo mi = this.GetType().GetMethod(methodName);

//Invoke the method
// (null- no parameter for the method call
// or you can pass the array of parameters...)
mi.Invoke(this, null); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-02-12T04:57:39.980

```
class Program
    {
        static void Main(string[] args)
        {
            Type type = typeof(MyReflectionClass);
            MethodInfo method = type.GetMethod("MyMethod");
            MyReflectionClass c = new MyReflectionClass();
            string result = (string)method.Invoke(c, null);
            Console.WriteLine(result);

        }
    }

    public class MyReflectionClass
    {
        public string MyMethod()
        {
            return DateTime.Now.ToString();
        }
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-14T22:10:42.077

此代码适用于我的控制台 .Net 应用程序

```
class Program
{
    static void Main(string[] args)
    {
        string method = args[0]; // get name method
        CallMethod(method);
    }

    public static void CallMethod(string method)
    {
        try
        {
            Type type = typeof(Program);
            MethodInfo methodInfo = type.GetMethod(method);
            methodInfo.Invoke(method, null);
        }
        catch(Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
            Console.ReadKey();
        }
    }

    public static void Hello()
    {
        string a = "hello world!";
        Console.WriteLine(a);
        Console.ReadKey();
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-05T15:58:12.903

有点切线 - 如果您想解析和评估包含（嵌套！）函数的整个表达式字符串，请考虑 NCalc（[http://ncalc.codeplex.com/](http://ncalc.codeplex.com/)和 nuget）

前任。对项目文档稍作修改：

```
// the expression to evaluate, e.g. from user input (like a calculator program, hint hint college students)
var exprStr = "10 + MyFunction(3, 6)";
Expression e = new Expression(exprString);

// tell it how to handle your custom function
e.EvaluateFunction += delegate(string name, FunctionArgs args) {
        if (name == "MyFunction")
            args.Result = (int)args.Parameters[0].Evaluate() + (int)args.Parameters[1].Evaluate();
    };

// confirm it worked
Debug.Assert(19 == e.Evaluate()); 
```

在`EvaluateFunction`委托中，您将调用您现有的函数。

# java - FAST 应用程序间通信的良好协议？

> ID：540071
> 
> 赞同：5
> 
> 时间：2009-02-12T04:52:40.210
> 
> 标签：java, web-services, daemon, protocols

我即将实现一个可以快速回答查询的服务器应用程序。服务器是用java实现的。我不想在复杂的通信协议上浪费很多时间，所以我寻找一种好的最佳实践方法 1）对我的服务器执行查询 2）让服务器回答该查询 查询和答案都将是从整数映射到整数列表。

相关：是否有任何组合框架既可以处理查询/响应协议又可以管理传入查询（将它们放入队列中）？

我不知道我是否应该将它实现为普通的守护程序或 Web 服务。Web 服务似乎更灵活，因为它可以相对容易地移动到另一台机器上，但普通的守护进程听起来更快。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T08:46:53.487

以灵活性为代价，守护进程在短期内会更快。守护程序的优点是您可以以紧凑的形式将回复发送回，在您的情况下作为二进制整数值流。这将尽可能快。

如果请求数量增加超过一定限制，您可以使用[带有轮询的 DNS](http://en.wikipedia.org/wiki/Round_robin_DNS)将负载分散到多台机器上，因此使用 HTTP 服务器没有任何优势。

主要缺点是您无法轻松调试此接口（对于大多数 Internet 协议，您只需 telnet 到服务器侦听的端口并运行几个命令即可查看结果）。此外，如果您出于任何原因必须更改界面，您也必须更改每个客户端。当您需要在其他地方使用此服务时，情况会变得更糟，例如在[mashup](http://en.wikipedia.org/wiki/Mashup_(web_application_hybrid))中。

所以如果你想要更灵活，可以使用 HTTP 和 JSON 之类的协议作为数据格式。这不像二进制那么紧凑，所以回答时间会更糟。差多少取决于数据的大小。如果您可以将 JSON 编码的响应放入标准 IP 包（大约 1500 字节）中，您可能不会注意到差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T04:58:41.193

我知道这是一个一般性的答案，但是您说的是守护程序和 Web 服务之间的毫秒差异。

话虽如此，请使用更灵活的架构。**好的设计将远远超过你用来执行它的技术。**

如果几毫秒真的很重要，那么问题不在于使用哪种技术，而是如何使用缓存和负载平衡来扩展它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T05:42:37.890

如果你开发一个守护服务器，你提供给客户端连接的接口是什么？您将实现套接字或 RMI 或其他东西。在可扩展性方面不是一个非常灵活且易于维护的解决方案。

使用网络服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T09:48:59.843

除非您尝试过多种方法，否则您不会知道哪种方法“更好”。最好的方法是制作每个原型，然后尝试一下！它甚至不需要做所有你想做的事情，只需要做一些基本的事情（比如返回预定义的数据），你可以对它进行负载测试，看看哪个更好。

我怀疑这些天，现代机器的运行速度足以让 http 运行得相当好，而且由于更加标准化，其他服务可以利用您的服务器而无需专门的客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T05:22:08.347

您可以为此[关注领导者](http://google.com)和用户 HTTP :)

例如在他们的 AJAX API 中，他们将它与 JSON 结合使用（或者是纯 javascript？）

[这](http://code.google.com/intl/es-MX/apis/ajaxlanguage/documentation/)是一个例子。

对于以下查询：

```
http://ajax.googleapis.com/ajax/services/language/translate?v=1.0&q=hello%20world&langpair=en%7Cit&callback=foo&context=bar

```

完整的输出是这样的：

```
HTTP/1.0 200 OK
Date: Thu, 12 Feb 2009 05:13:31 GMT
Content-Length: 97
Content-Type: text/javascript; charset=utf-8
Expires: Thu, 12 Feb 2009 05:13:31 GMT
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
X-Backend-Content-Length: 16
X-Embedded-Status: 200
X-Content-Type-Options: nosniff
Server: GFE/2.0

{"responseData": {"translatedText":"ciao mondo"}, "responseDetails": null, "responseStatus": 200} 
```

当然测试很简单，但是使用java实现再简单不过了。

当然，这取决于您的项目需求、安全性、访问控制等，但是通过使用 HTTP，您可以在经过超级测试的协议上进行中继。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T05:41:27.567

如果性能是一个很大的问题，我怀疑您很需要使用某种集群解决方案网格。不久前我写了一篇[关于 Java 网格/集群库的概述，](https://stackoverflow.com/questions/383920/what-is-the-best-library-for-java-to-grid-cluster-enable-your-application/383929#383929)这是有用的背景。

如果商业软件是一个选项，我建议查看 GigaSpaces（或者一些免费软件 JavaSpaces 实现，如果不是）。它可以让你做：

*   消息的 FIFO 排序，如果这对您很重要（尽管这会带来性能成本）；
*   亚毫秒事务网格更新；
*   如果您想使用该排队 API，它会附带一个构建在顶部的 JMS 实现；和
*   消息由类定义，因此您只需读取/写入适当的操作。

GigaSpaces（以及任何真正的网格/集群技术）可以很好地扩展。比纯队列解决方案要好得多，后者要么不能随发布-订阅（因为所有侦听器都会收到消息；通常不是您想要的）或请求-响应（您必须确保队列没有被阻止一个坏消息）。

您没有提到服务器使用的是什么技术。如果它是Java，那么你就可以了。如果没有，它会变得更有趣。如果是这种情况，您可能需要考虑使用[Google Protocol Buffers](http://code.google.com/apis/protocolbuffers/)构建一些东西，这是一种高性能二进制交换格式，受 Java、C++ 和可能的其他平台支持。

就我个人而言，我不是 Web 服务的忠实拥护者，因为它们不是事务性的（从某种意义上说，它们不能参与分布式事务）。这对你来说可能是也可能不是问题。此外，不同技术栈（例如 Java 和 .Net）之间的互操作性充其量仍然是个问题。

# c - 切出一段字符串

> ID：540073
> 
> 赞同：4
> 
> 时间：2009-02-12T04:53:00.710
> 
> 标签：c, string, pointers

我不介意编写自己的函数来执行此操作，但我想知道 string.h 中是否存在一个函数，或者是否有标准方法来执行此操作。

```
char *string = "This is a string";

strcut(string, 4, 7);

printf("%s", string); // 'This a string' 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T05:06:25.980

使用 memmove 移动尾部，然后将 '\0' 放在新的结束位置。注意不要使用 memcpy - 在这种情况下它的行为是不确定的，因为源和目标通常重叠。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T15:00:55.210

你可以告诉[printf](http://linux.die.net/man/3/printf)为你剪掉有趣的部分：

```
char *string = "This is a string";
printf("%.*s%s", 4, string, &string[7]); // 'This a string' 
```

:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T05:00:34.390

如果您正在谈论摆脱字符串的中间并将其余部分更早地移动到位，那么我认为没有标准的库函数。

最好的方法是找到字符串的结尾，然后执行一个 O(cut_size) 循环将所有字符移动到新位置。事实上，有一个类似的常见面试问题。

您必须小心使用诸如内存复制之类的东西，因为目标缓冲区与源缓冲区重叠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T16:07:07.563

您可能能够完成您想要的并且避免使用 strncpy 和 strcat 的组合编写新函数：

```
#include <stdio.h>
#include <string.h>
int main(void)
{
  char   newStr[10];
  char   origStr[] = "This is a string";
  strncpy(newStr, origStr, 4);
  strcat(newStr, &origStr[7]);
  printf("newStr = %s\n", newStr);
  return(0);
} 
```

对我来说，这会在 Windows XP 上使用 Borland 的免费命令行编译器输出“This a string”（引用我的）。您可以在以下网址查看 string.h：http: [//opengroup.org/onlinepubs/007908799/xsh/string.h.html](http://opengroup.org/onlinepubs/007908799/xsh/string.h.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-22T12:03:30.900

[我已经在https://stackoverflow.com/a/42283266/6003870](https://stackoverflow.com/a/42283266/6003870)写了类似问题的答案。它适用于常见动作，主要基于 C 标准库中的函数**strncpy()**。但是这个问题可以通过死用户@sharptooth 提到的函数**memmove()来解决。**

函数**str_slice_in_place()**使用**memmove()**作为基础并支持正索引。

```
int
str_slice_in_place(char str[], const int index_from, const int index_to)
{
    // a support for only positive indexes
    if (index_from < 0 || index_to < 0)
        return -1;

    int len = index_to - index_from;

    // "index_from" is more than "index_to"
    if (len < 0)
        return -1;

    memmove(str, str + index_from, len);
    str[len] = '\0';
    return 0;
} 
```

我还向您展示了函数**main()**的代码以及如何使用该函数的示例。

```
#include <stdio.h>
#include <string.h>

int
main()
{
    char line[] = "--------------------------------------";

    char str1[] = "Remember a good";
    char str2[] = "Remember a good";
    char str3[] = "Remember a good";
    char str4[] = "Remember a good";

    printf("|     Original     | Slice  | Result \n%s\n", line);

    printf("| %s | ", str1);
    str_slice_in_place(str1, 0, 8);
    printf("(%d, %d) | %s\n", 0, 8, str1);

    printf("| %s | ", str2);
    str_slice_in_place(str2, 3, 9);
    printf("(%d, %d) | %s\n", 3, 9, str2);

    printf("| %s | ", str3);
    str_slice_in_place(str3, 0, 1);
    printf("(%d, %d) | %s\n", 0, 1, str3);

    printf("| %s | ", str4);
    str_slice_in_place(str4, 1, 1);
    printf("(%d, %d) | %s\n", 1, 1, str4);

    puts(line);

    return 0;
} 
```

* * *

## 输出

```
|     Original     | Slice  | Result 
--------------------------------------
| Remember a good | (0, 8) | Remember
| Remember a good | (3, 9) | ember 
| Remember a good | (0, 1) | R
| Remember a good | (1, 1) | 
-------------------------------------- 
```

* * *

## 一个测试环境

```
$ gcc --version
gcc (Debian 4.9.2-10) 4.9.2
Copyright (C) 2014 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
$ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 8.6 (jessie)
Release:    8.6
Codename:   jessie
$ uname -a
Linux localhost 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u2 (2016-10-19) x86_64 GNU/Linux 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-12T04:57:55.550

如果您在 C 中执行此操作并且知道偏移量，那么它非常简单。

```
char string[] = "my string";
char *substring;
substring = &string[2];

printf("%s", substring); 
```

**编辑：**如果你想改变字符串。

```
char string[] = "my string";

int i = 0;
int offset = 2;

for( i = 0; string[i+offset] != '\0'; i++ ) {
 string[i] = string[i + offset];
}
string[i] = '\0'; 
```

# c# - 等待池线程完成

> ID：540078
> 
> 赞同：40
> 
> 时间：2009-02-12T04:54:30.627
> 
> 标签：c#, .net, multithreading

我很抱歉提出一个多余的问题。但是，我找到了许多解决问题的方法，但没有一个得到很好的解释。我希望它会在这里说清楚。

我的 C# 应用程序的主线程使用 ThreadPool 生成 1..n 个后台工作人员。我希望原始线程锁定，直到所有工作人员都完成。我特别研究了 ManualResetEvent，但我不清楚它的用途。

在伪：

```
foreach( var o in collection )
{
  queue new worker(o);
}

while( workers not completed ) { continue; } 
```

如有必要，我会提前知道即将排队的工人数量。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-12T05:19:42.423

试试这个。该函数接受一个动作委托列表。它将为列表中的每个项目添加一个 ThreadPool 工作人员条目。它将等待每个动作完成后再返回。

```
public static void SpawnAndWait(IEnumerable<Action> actions)
{
    var list = actions.ToList();
    var handles = new ManualResetEvent[actions.Count()];
    for (var i = 0; i < list.Count; i++)
    {
        handles[i] = new ManualResetEvent(false);
        var currentAction = list[i];
        var currentHandle = handles[i];
        Action wrappedAction = () => { try { currentAction(); } finally { currentHandle.Set(); } };
        ThreadPool.QueueUserWorkItem(x => wrappedAction());
    }

    WaitHandle.WaitAll(handles);
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-12T07:45:14.617

这是一种不同的方法-封装；所以你的代码可以很简单：

```
 Forker p = new Forker();
    foreach (var obj in collection)
    {
        var tmp = obj;
        p.Fork(delegate { DoSomeWork(tmp); });
    }
    p.Join(); 
```

下面给出了`Forker`课程（我在火车上感到无聊；-p）......再次，这避免了操作系统对象，但将事情包装得非常整齐（IMO）：

```
using System;
using System.Threading;

/// <summary>Event arguments representing the completion of a parallel action.</summary>
public class ParallelEventArgs : EventArgs
{
    private readonly object state;
    private readonly Exception exception;
    internal ParallelEventArgs(object state, Exception exception)
    {
        this.state = state;
        this.exception = exception;
    }

    /// <summary>The opaque state object that identifies the action (null otherwise).</summary>
    public object State { get { return state; } }

    /// <summary>The exception thrown by the parallel action, or null if it completed without exception.</summary>
    public Exception Exception { get { return exception; } }
}

/// <summary>Provides a caller-friendly wrapper around parallel actions.</summary>
public sealed class Forker
{
    int running;
    private readonly object joinLock = new object(), eventLock = new object();

    /// <summary>Raised when all operations have completed.</summary>
    public event EventHandler AllComplete
    {
        add { lock (eventLock) { allComplete += value; } }
        remove { lock (eventLock) { allComplete -= value; } }
    }
    private EventHandler allComplete;
    /// <summary>Raised when each operation completes.</summary>
    public event EventHandler<ParallelEventArgs> ItemComplete
    {
        add { lock (eventLock) { itemComplete += value; } }
        remove { lock (eventLock) { itemComplete -= value; } }
    }
    private EventHandler<ParallelEventArgs> itemComplete;

    private void OnItemComplete(object state, Exception exception)
    {
        EventHandler<ParallelEventArgs> itemHandler = itemComplete; // don't need to lock
        if (itemHandler != null) itemHandler(this, new ParallelEventArgs(state, exception));
        if (Interlocked.Decrement(ref running) == 0)
        {
            EventHandler allHandler = allComplete; // don't need to lock
            if (allHandler != null) allHandler(this, EventArgs.Empty);
            lock (joinLock)
            {
                Monitor.PulseAll(joinLock);
            }
        }
    }

    /// <summary>Adds a callback to invoke when each operation completes.</summary>
    /// <returns>Current instance (for fluent API).</returns>
    public Forker OnItemComplete(EventHandler<ParallelEventArgs> handler)
    {
        if (handler == null) throw new ArgumentNullException("handler");
        ItemComplete += handler;
        return this;
    }

    /// <summary>Adds a callback to invoke when all operations are complete.</summary>
    /// <returns>Current instance (for fluent API).</returns>
    public Forker OnAllComplete(EventHandler handler)
    {
        if (handler == null) throw new ArgumentNullException("handler");
        AllComplete += handler;
        return this;
    }

    /// <summary>Waits for all operations to complete.</summary>
    public void Join()
    {
        Join(-1);
    }

    /// <summary>Waits (with timeout) for all operations to complete.</summary>
    /// <returns>Whether all operations had completed before the timeout.</returns>
    public bool Join(int millisecondsTimeout)
    {
        lock (joinLock)
        {
            if (CountRunning() == 0) return true;
            Thread.SpinWait(1); // try our luck...
            return (CountRunning() == 0) ||
                Monitor.Wait(joinLock, millisecondsTimeout);
        }
    }

    /// <summary>Indicates the number of incomplete operations.</summary>
    /// <returns>The number of incomplete operations.</returns>
    public int CountRunning()
    {
        return Interlocked.CompareExchange(ref running, 0, 0);
    }

    /// <summary>Enqueues an operation.</summary>
    /// <param name="action">The operation to perform.</param>
    /// <returns>The current instance (for fluent API).</returns>
    public Forker Fork(ThreadStart action) { return Fork(action, null); }

    /// <summary>Enqueues an operation.</summary>
    /// <param name="action">The operation to perform.</param>
    /// <param name="state">An opaque object, allowing the caller to identify operations.</param>
    /// <returns>The current instance (for fluent API).</returns>
    public Forker Fork(ThreadStart action, object state)
    {
        if (action == null) throw new ArgumentNullException("action");
        Interlocked.Increment(ref running);
        ThreadPool.QueueUserWorkItem(delegate
        {
            Exception exception = null;
            try { action(); }
            catch (Exception ex) { exception = ex;}
            OnItemComplete(state, exception);
        });
        return this;
    }
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-12T05:10:01.697

首先，工人执行多长时间？池线程通常应用于短期任务 - 如果它们要运行一段时间，请考虑手动线程。

重新解决问题；你真的需要阻塞主线程吗？你可以用回调代替吗？如果是这样，类似：

```
int running = 1; // start at 1 to prevent multiple callbacks if
          // tasks finish faster than they are started
Action endOfThread = delegate {
    if(Interlocked.Decrement(ref running) == 0) {
        // ****run callback method****
    }
};
foreach(var o in collection)
{
    var tmp = o; // avoid "capture" issue
    Interlocked.Increment(ref running);
    ThreadPool.QueueUserWorkItem(delegate {
        DoSomeWork(tmp); // [A] should handle exceptions internally
        endOfThread();
    });
}
endOfThread(); // opposite of "start at 1" 
```

这是一种相当轻量级（无操作系统原语）的跟踪工作人员的方法。

如果您**需要**阻止，您可以使用 a 执行相同操作`Monitor`（同样，避免使用 OS 对象）：

```
 object syncLock = new object();
    int running = 1;
    Action endOfThread = delegate {
        if (Interlocked.Decrement(ref running) == 0) {
            lock (syncLock) {
                Monitor.Pulse(syncLock);
            }
        }
    };
    lock (syncLock) {
        foreach (var o in collection) {
            var tmp = o; // avoid "capture" issue
            ThreadPool.QueueUserWorkItem(delegate
            {
                DoSomeWork(tmp); // [A] should handle exceptions internally
                endOfThread();
            });
        }
        endOfThread();
        Monitor.Wait(syncLock);
    }
    Console.WriteLine("all done"); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-09-30T21:29:42.377

我一直在 CTP 中使用新的并行任务[库](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)：

```
 Parallel.ForEach(collection, o =>
            {
                DoSomeWork(o);
            }); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-17T14:19:25.143

这是使用`CountdownEvent`该类的解决方案。

```
var complete = new CountdownEvent(1);
foreach (var o in collection)
{
  var capture = o;
  ThreadPool.QueueUserWorkItem((state) =>
    {
      try
      {
        DoSomething(capture);
      }
      finally
      {
        complete.Signal();
      }
    }, null);
}
complete.Signal();
complete.Wait(); 
```

当然，如果您可以访问该课程，那么您就可以`CountdownEvent`使用整个 TPL。`Parallel`班级会照顾你的等待。

```
Parallel.ForEach(collection, o =>
  {
    DoSomething(o);
  }); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T05:21:59.453

我认为您使用 ManualResetEvent 走在正确的轨道上。此[链接](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)的代码示例与您尝试执行的操作非常匹配。关键是使用 WaitHandle.WaitAll 并传递一个等待事件数组。每个线程都需要设置这些等待事件之一。

```
 // Simultaneously calculate the terms.
    ThreadPool.QueueUserWorkItem(
        new WaitCallback(CalculateBase));
    ThreadPool.QueueUserWorkItem(
        new WaitCallback(CalculateFirstTerm));
    ThreadPool.QueueUserWorkItem(
        new WaitCallback(CalculateSecondTerm));
    ThreadPool.QueueUserWorkItem(
        new WaitCallback(CalculateThirdTerm));

    // Wait for all of the terms to be calculated.
    WaitHandle.WaitAll(autoEvents);

    // Reset the wait handle for the next calculation.
    manualEvent.Reset(); 
```

编辑：

确保在您的工作线程代码路径中设置了事件（即 autoEvents [1](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx) .Set();）。一旦他们都收到信号，waitAll 就会返回。

```
void CalculateSecondTerm(object stateInfo)
{
    double preCalc = randomGenerator.NextDouble();
    manualEvent.WaitOne();
    secondTerm = preCalc * baseNumber * 
        randomGenerator.NextDouble();
    autoEvents[1].Set();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T12:08:27.543

我在这里找到了一个很好的解决方案：

[http://msdn.microsoft.com/en-us/magazine/cc163914.aspx](http://msdn.microsoft.com/en-us/magazine/cc163914.aspx)

对于有同样问题的其他人可能会派上用场

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-15T14:22:16.407

使用 .NET 4.0 [Barrie](http://msdn.microsoft.com/en-us/library/system.threading.barrier(VS.100).aspx) r 类：

```
 Barrier sync = new Barrier(1);

        foreach(var o in collection)
        {
            WaitCallback worker = (state) => 
            {
                // do work
                sync.SignalAndWait();
            };

            sync.AddParticipant();
            ThreadPool.QueueUserWorkItem(worker, o);
        }

        sync.SignalAndWait(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-04T21:38:20.107

尝试使用`CountdownEvent`

```
// code before the threads start

CountdownEvent countdown = new CountdownEvent(collection.Length);

foreach (var o in collection)
{
    ThreadPool.QueueUserWorkItem(delegate
    {
        // do something with the worker
        Console.WriteLine("Thread Done!");
        countdown.Signal();
    });
}
countdown.Wait();

Console.WriteLine("Job Done!");

// resume the code here 
```

倒计时将等到所有线程完成执行。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2021-04-29T14:15:46.560

等待线程池中的所有线程完成，没有可用的内置方法。使用计数号。的线程处于活动状态，我们可以实现它...

```
{
        bool working = true;
        ThreadPool.GetMaxThreads(out int maxWorkerThreads, out int maxCompletionPortThreads);
        while (working)
        {
            ThreadPool.GetAvailableThreads(out int workerThreads, out int completionPortThreads);
            //Console.WriteLine($"{workerThreads} , {maxWorkerThreads}");
            if (workerThreads == maxWorkerThreads)
            { working = false; }
        }
        //when all threads are completed then 'working' will be false 
    }
    void xyz(object o)
    {
        console.writeline("");
    } 
```

# opengl - glTail 启动错误

> ID：540083
> 
> 赞同：0
> 
> 时间：2009-02-12T04:55:52.933
> 
> 标签：opengl, tail, gltail

对于所有不知道我在说什么的人，它是来自[Fudgie的](http://github.com/Fudge/gltail/tree/master)[glTail](http://www.fudgie.org/)。

在家里的 Mac 上，我一直无法让 glTail 工作。我已经让它在我的工作 Mac 上工作。这只是最后的手段，因为过去 2 天什么都没有，但似乎是在浪费时间。

我安装了相同的库：Ruby 1.8.6、Gem 1.3.1、net-ssh 1.1.4、Chipmunk 2D、ruby-opengl 0.60.0 和 file-tail 1.0.3。

这是我运行以尝试启动它的命令：

```
./gl_tail 配置文件 config.yaml
```

它马上说（几乎是瞬间）：

```
-macbook:bin Garrett$ ./gl_tail 配置文件 config.yaml
./../lib/gl_tail/engine.rb:300: [BUG] 总线错误
红宝石 1.8.6 (2008-03-03) [universal-darwin9.0]

中止陷阱

```

如果你看`engine.rb`，它是第一行：

```
    定义开始
      glutInit() # 第 300 行
      glutInitDisplayMode(GLUT_RGB | GLUT_DOUBLE)

      glutInitWindowPosition(0, 0)
      glutInitWindowSize(@config.screen.window_width, @config.screen.window_height)
      glutCreateWindow('glTail')

```

我有一种感觉，就是没有正确安装 GLUT。我不期待太多帮助，因为它本身的代码几乎没有文档。但是看到它立即被杀死，我有一种感觉，也许它没有一直更新，很可能是 OpenGL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T08:49:59.733

我不确定这是否对来自 linux 用户的您有帮助，但是这里有……我认为您确实缺少 libglut-headers。如果您通过 gems 安装，那是您唯一需要的外部东西。在 linux 上，我只需要安装`libglut3-dev`包，然后`gem install gltail`它就可以用它来构建`ruby-opengl`。

所以，试着在你的平台上找到 libglut 开发头文件。希望有帮助！

# svn - 将非标准 Subversion 存储库转换为 git

> ID：540087
> 
> 赞同：3
> 
> 时间：2009-02-12T04:57:25.130
> 
> 标签：svn, git, migrate

我有一个布局是这样的存储库：

```
    树干/
        项目A
        项目B
    分支机构/
        项目A-1.0
        项目B-1.0
    标签/
        项目A-1.0.1
        项目B-1.0.1

```

我想将它们转换为单独的 git 存储库，其中 trunk/projectA 作为顶级目录，它的所有分支都作为 git 分支。

每当我尝试指定一个`git svn init`like`git svn init -T trunk/projectA -b branches -t tags http://svn.example.com`时，后续操作`git svn fetch`都会在不同的修订版上神秘地失败。有时它一直到 200，有时它停止。

我目前的想法是我应该创建一个 git 存储库，将整个 subversion 存储库镜像为单个实体，每个项目都有子目录。然后我会使用`git-filter-branch`将子目录重写到项目的根目录。

但是，我不确定如何让分支表现得像我想要的那样使用`git-filter-branch`and。

此外，为每个项目的“主干”创建一个具有不同分支的单个 git 存储库也是理想的，在这种情况下，如果没有真正的主控，我不会有任何问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T05:09:04.180

您是否考虑**[过使用 svn2git](https://stackoverflow.com/questions/572893/cloning-a-non-standard-svn-repository-with-git-svn/572898#572898)**将您的 svn 导入 git 存储库？

这比 `git svn clone`因为如果你在 svn 中有这段代码更好：

```
 trunk
    ...
  branches
    1.x
    2.x
  tags
    1.0.0
    1.0.1
    1.0.2
    1.1.0
    2.0.0 
```

**`git-svn`**将通过提交历史来构建一个新的 git repo。
它将**所有分支和标签导入为远程 svn 分支，而您真正想要的是 git-native 本地分支和 git tag objects**。
所以在导入这个项目后，你会得到：

```
 $ git branch
  * master
  $ git branch -a
  * master
    1.x
    2.x
    tags/1.0.0
    tags/1.0.1
    tags/1.0.2
    tags/1.1.0
    tags/2.0.0
    trunk
  $ git tag -l
  [ empty ] 
```

在 svn2git 完成你的项目后，你会得到这个：

```
 $ git branch
  * master
    1.x
    2.x
  $ git tag -l
    1.0.0
    1.0.1
    1.0.2
    1.1.0
    2.0.0 
```

最后，它确保 master 的 HEAD 与 svn repo 的当前主干相同。

所以在你的情况下，它会给你实际的 git 分支来应用`git-filter-branch`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-28T17:49:50.293

我最终做的是克隆存储库的根目录并为每个项目复制新的 git 存储库并重新安排内容。它既不干净也不漂亮，但它是我不再需要经常查看的遗留代码。

# asp.net - ASP.NET 文件上传-动态文件名

> ID：540088
> 
> 赞同：1
> 
> 时间：2009-02-12T04:57:31.057
> 
> 标签：asp.net, file, uploading

我有一个网页，我有一个 ASP.NET 文件上传控件，可以将文件从客户端机器上传到服务器。现在我想上传 n 次。例如：我想从本地 pc 上传 100 个文件到服务器.我可以从程序中的 excel 文件中读取 100 个文件名。但是有没有办法将此文件分配给文件上传控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T05:02:56.037

不，作为一项安全功能，FilUpload 控件不允许您设置要下载的内容（想象一下，如果您登录一个网站，并且它被设置为上传密码文件或其他内容）。

现在可能有另一个控件，或者有一种方法可以解决这个问题，但是 FileUpload 控件不允许它。

我建议使用[jQuery Multifile Uploader](http://www.fyneworks.com/jquery/multiple-file-upload/#)来处理 UI（如果你需要的话）。并且使用[Free ASP Uploads](http://www.freeaspupload.net/)进行实际上传，它负责实际的文件传输。虽然听起来您正在以编程方式处理程序，但您可以跳过多重处理，只使用免费的 asp 上传。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T05:06:39.023

您必须制作自己的 Flash 对象或其他东西来完成此操作，基本的 HTML/ASP.Net 控件不会让您做您想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T05:11:37.107

这将需要创建某种活动的或**可安装**的控件。为了绕过这样做的安全漏洞，您最终必须能够在机器上执行代码来选择和上传文件。

那时，您是特定于平台的，所以...

我强烈建议您不要尝试让网站自动为您上传文件，而是制作一个 WinForms 实用程序来完成此任务并在您需要的任何地方上传文件，通过 Web 服务与网站通信等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-26T14:16:37.810

这是一个安全限制，您不能为上传框的文件选择编写脚本，因为这将允许黑客编写脚本以从您的计算机上窃取文件。

您可以使用此 silverlight 上传实用程序，这是我的“有机会时使用的东西”列表。

它有一个漂亮的用户界面，并支持一次上传许多文件。我最初跟踪它为我们引用的一个摄影网站做一些研究，但那个项目失败了。

无论如何，该项目可以在这里找到：

*   [http://www.michielpost.nl/Silverlight/MultiFileUploader/](http://www.michielpost.nl/Silverlight/MultiFileUploader/)

它还包含完整的源代码，因此即使控件的开发人员放弃了它，您仍然可以选择自己编辑它。

# sharepoint - 将 Sharepoint 用作 Scrum 通信工具时的最佳实践

> ID：540092
> 
> 赞同：6
> 
> 时间：2009-02-12T04:58:01.790
> 
> 标签：sharepoint, scrum

目前，我们的团队正在结合使用公告板和 Excel 电子表格来跟踪任务并绘制燃尽图。积压的文件保存在信封中的索引卡上。

当利益相关者位于同一位置时，这很有效。然而，我们很快将在两个地理位置相距遥远的地方拥有 Scrum 团队，我正在寻找关于如何利用 Sharepoint 帮助我们围绕 Scrum 工件（积压、燃尽图、速度等）进行交流的最佳实践。

您是如何利用 Sharepoint 实现这一目的的，最佳实践和潜在陷阱是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T15:25:47.617

我们实际上将 Sharepoint 用于我们的敏捷开发，并且发现它非常适合项目管理/协作。
我们做了两件事我觉得特别有用，指标跟踪和自动化测试。我们使用文档库和信息路径将项目的所有故事添加到站点。信息路径表单应包含故事所需的所有信息：分数、预计时间、开发人员、测试人员、故事任务、测试用例。

对于指标，我们为以下各项创建 Web 部件：燃尽图、速度、每次迭代的点数等。这对于经理或客户来说特别好，可以看到项目正在取得的进展，并将帮助他们做出有关功能与发布时间的决策.

对于测试，我们有一个简单的 SEND-RECV-ASSERT 语言，它通过抓取 XML 进行自动化测试，每晚运行测试。我们在主页上有一个小的绿色/红色 webpart，它告诉您测试的统计数据。
这可以通过一些 XML 解析非常简单地完成，因为文档库的后端是 XML。（我们目前使用一些简单的 ActiveX 和 javascript）

指标很容易设置（只是一些 xml 解析和 html 图表）。自动化测试需要一些时间来设置测试运行器，但是一旦它到位并且足够简单，您甚至可以让客户/经理编写验收测试！敏捷！:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T05:19:09.447

你真的应该为此考虑像[Trello](https://trello.com)、[VersionOne](http://versionone.com/)、[Rally](http://www.rallydev.com/)甚至是[Basecamp 之](http://www.basecamphq.com/)类的东西。他们都有托管解决方案并提供免费的社区版本，您可以尝试开始使用。我对 SharePoint 的体验是需要大量资源来维护。如果您使用的是 Team System 并且为您预先构建了很多东西，那可能会有所不同——尽管我有 Team System 并且仍然选择使用 Wiki 来完成我的项目管理任务。如果您已经对 SharePoint 作为 Intranet 和所有支持人员进行了投资，那么在这种情况下它也可能是一个可行的解决方案。

SharePoint 不是我首先想到的敏捷开发工具。YMMV。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T16:35:39.787

如果您已经在内部拥有 SharePoint，以及一个习惯使用它的用户群，我认为开始将它用于 SCRUM 会相当容易。我将从以下内容开始：

每个项目包含 1 个 Scrum 站点的站点集合

Scrum 站点应包含：

*   电子文件的文档库（酌情添加分类栏）

*   团队成员名单

*   讨论平台

如果需要，该站点可以从 Wiki 站点模板构建。

一旦你让 Scrum 站点“感觉正确”，将其保存为模板，以便轻松创建新站点。

这个解决方案可能不是为 SCRUM 设计的，但它应该足以让你开始。当听起来你正在经历一些其他相当激进的变化时，这似乎比让整个团队学习一个新工具要容易得多。

我的 0.02 美元

jt

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-06T18:47:02.210

您需要尝试防止该工具妨碍工作。在理想的世界中，团队都将坐在一个带有大白板的单间里，但通常情况并非如此，团队是分散的，或者需要某种形式的便利贴备用。

我是 SharePoint 的忠实粉丝，您已经在内部拥有这个，您已经在平台上进行协作和团队合作。添加另一个具有唯一登录名的工具可以工作，但团队需要真正想要使用它们。

我已经尝试让 SharePoint 开箱即用来做我想做的事情，但它失败了。我已经尝试过使用版本一（多年来在很多场合，有很多团队），但我发现这个工具太多了，有太多的选项和需要做的事情阻碍了它 - 它离白板还有很长的路要走。

所以我决定开发我的项目所需的东西。我需要一个简单的工具，并且使用 37signals（basecamp 的创建者）方法，我需要一些功能比竞争对手少的东西。

[21Scrum](http://www.21apps.com/21scrum/announcing-21scrum/)是一个基于 SharePoint 的简单 Scrum 工具，它使用该平台，添加您需要的东西（白板、燃尽图），然后让您继续进行项目。

对于已经拥有和使用 SharePoint 的人来说，这可能是最佳选择 - 至少这是目标。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T10:51:39.620

我们已经设置了一个 SharePoint 工作区，其中包含发布/Sprint 计划、产品待办事项和 Sprint 待办事项列表。

中心元素是这个 SharePoint 任务板——我们可以拖放故事和任务——即使我们不在同一个位置。 [http://www.youtube.com/watch?v=XW89M0C3N7Q](http://www.youtube.com/watch?v=XW89M0C3N7Q)

燃尽报告会自动显示进度。

效果很好！

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-02-12T05:50:37.700

AFAIK，Sharepoint 是带有免费好东西的 ASP.net。它不是为敏捷项目管理而设计的。所以你必须推出自己的网站。
恕我直言，不要试图将工作弯曲到您拥有的工具上。切换到更好的工具来完成工作将是一个更好的选择。检查[这个线程](https://stackoverflow.com/questions/426458/recommendations-for-project-management-software-for-scrum)，看看是否有更轻量级的东西适合你的账单。

我个人也非常喜欢不将开发活动数字化。所以我会使用电子表格来处理积压工作，并发布其和 Big Visible 图表。使用相机保存图表/设计讨论快照（用于工具的谷歌白板照片）或报告。我发现大多数“项目管理”工具只是生成即时状态更新的借口。它妨碍了软件开发（这是主要目标）并且经常抑制社交互动。

（*免责声明：绝对 0 的 sharepoint 经验.. 除了我在过去 2 天读到的内容，所以可能完全偏离轨道*）

# entity-framework - XmlSerializer 找不到 EntityObject，即使它被引用

> ID：540100
> 
> 赞同：2
> 
> 时间：2009-02-12T05:02:10.423
> 
> 标签：entity-framework, xml-serialization

我希望有人可以帮助我解决我在使用 XmlSerializer 时遇到的这个问题。

我已经看过这个帖子：[http ://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/551cee76-fd80-48f8-ac6b-5c22c234fecf/](http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/551cee76-fd80-48f8-ac6b-5c22c234fecf/)

我得到的错误是：

System.InvalidOperationException：无法生成临时类（结果 = 1）。错误 CS0012：“System.Data.Objects.DataClasses.EntityObject”类型在未引用的程序集中定义。您必须添加对程序集“System.Data.Entity，Version=3.5.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。

我确保我的单元测试引用了 System.Data.Entity，因此它至少能够编译。我还在 app.config 中将程序集绑定到 System.Data.Entity。

这是我粗略的班级结构

```
[Serializable] 
[XmlRoot(Namespace = XmlSupport.MyNamespace, ElementName = XmlSupport.WantToSerialize)] 
[XmlInclude(typeof(WantToSerializeBaseClass)]
[XmlInclude(typeof(EntityObject)]
[XmlInclude(typeof(MyEntityObjectSubClass)]
public class WantToSerialize : WantToSerializeBaseClass, IXmlSerializable  (I've tried putting this on the baseclass and the current class)
{
  // methods and classes 
  // I've included XmlIncludes for all the classes that this class has a reference too
  //  even though in the WriteXml it just uses .NET base classes
} 
```

WantToSerializeBaseClass 使用了一些泛型，但我用 XmlIncludes 修饰了它（EntityObject，以及它引用的任何其他类）。

调用代码：

```
var serializerWrite = new XmlSerializer(typeof (WantToSerialize), XmlSupport.ITNNamespace); 
```

失败

但是，如果我这样做：

```
var serializerWrite = new XmlSerializer(typeof (WantToSerialize), new Type[] {typeof(EntityObject)}); 
```

它是成功的。

任何想法都是最有帮助的。

**更新** 我已经将问题追踪到 WantToSerializeBaseClass 中的一个方法

```
public abstract void ConvertFromEntity<TtoCopy>(TtoCopy toCopy) where TtoCopy : MyEntityObjectSubClass; 
```

其中 MyEntityObjectSubClass 是 EntityObject 的子类，它在我的实体对象上添加了一些我想要的方法。MyEntityObjectSubClass 如下所示：

```
[Serializable]
[XmlInclude(typeof(EntityObject))]
public abstract class MyEntityObjectSubClass : EntityObject, IMyEntityObjectSubClass 
```

再一次，任何想法都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T06:52:35.600

如果您在编译时没有任何需要引用的代码，那么该引用将不会包含在构建的程序集中。您可以使用[Reflector](http://www.red-gate.com/products/reflector/)之类的工具来检查引用是否将其放入您的程序集中。

您可以尝试的一件事是将创建 XmlSerializer 的静态方法添加到 WantToSerialize。包含 WantToSerialize 的程序集必须已经很好地引用了 EntityObject，所以这应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T18:08:45.930

我最终删除了通用代码，它运行良好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-17T19:03:02.760

我也有同样的问题（在VB中）。我发现您可以使用泛型参数，但由于 MyEntityObjectSubClass 类型在另一个程序集中，它会出错。如果您删除泛型参数的类型限制，它将正常工作。

我认为这是框架本身的错误。我已向[microsoft](https://connect.microsoft.com/VisualStudio/feedback/details/668950/error-creating-xml-serializer-in-specific-situation-in-vb)提交了反馈票。我附上了一个 VB.net

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-11T16:03:10.543

我意识到这是一个较老的问题，但为了后代的缘故，将 .dll 引用上的 CopyLocal 参数设置为 True。

# iphone - 如何检测 iPhone 应用程序中的内存泄漏/电池耗尽

> ID：540101
> 
> 赞同：0
> 
> 时间：2009-02-12T05:02:54.507
> 
> 标签：iphone, cocoa-touch

恐怕我在 iPhone 应用程序的 1.2 版中引入了内存泄漏或其他问题。当我使用 1.2 版本时，我注意到我的电池消耗比使用 1.1 版本快很多。相比之下，使用 1.1 版本的电池可以使用一整天，晚上仍然有充足的电量，但使用 1.2 我发现我必须在午后将其插入电源。

内存泄漏（或很多）会导致电池消耗增加，还是我有其他事情发生？

我的应用程序使用的唯一有趣的东西是 AVAudioPlayer 类来播放一些 caf 音频文件。除此之外，它只是带有表格视图的几个视图。

我确实在 applicationWillTerminate 方法中调用了 AudioSessionSetAcvie(false)，所以我认为不是音频会话导致了这种情况。我不必让我的应用程序处于活动状态以耗尽电池电量。使用一段时间然后退出就足够了。所以我很确定我会留下一些东西，我只是不确定是什么。

我尝试使用 Instruments 工具，但您似乎无法与设备上运行的应用程序一起使用（由于某种原因，我的应用程序停止在模拟器中工作）

关于如何找到导致电池耗尽的原因的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T05:09:08.690

内存泄漏不会导致电池使用量增加。但是，如果内存泄漏持续存在，最终您将收到内存警告，如果您无法清理足够的内存，您的应用程序将被终止。

电池利用率的提高通常意味着某些原因导致您的代码继续运行。解决此问题的最佳方法是在 Instruments 下运行您的应用程序（可能使用 Sampler），并让它处于您确信它通常会耗尽电池电量的状态。检查 Sampler 的结果，如果您有代码正在运行，您将能够看到它的堆栈跟踪。

希望一旦您找到了正在运行的代码，如何停止它就会变得很明显。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T08:34:29.117

正如 Nilobject 所说，内存泄漏不会导致电池使用量增加。

我会尝试一次注释掉各个功能区域，以尝试缩小导致问题的区域。在您的情况下，首先要尝试的显然是删除音频。如果完成此操作后，电池使用量恢复正常，那么您就知道该在哪里进行更深入的研究了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T08:44:48.297

> （由于某种原因，我的应用程序停止在模拟器中工作）

我会解决这个问题并使用工具来修复性能错误。修复困难的缺陷并留下简单的缺陷绝不是一个好主意。

# c++ - 通过查找位返回数组？

> ID：540125
> 
> 赞同：2
> 
> 时间：2009-02-12T05:11:00.633
> 
> 标签：c++, c, stl, boost

我有以下用例，整数数组

```
vector<int>  containing elements 123 345 678  890 555 ...
                           pos    0   1   2    3   4 
```

基于我收到的位表示，例如

```
101  then return 123 678 (Elements of the array with its position bits set)
0011  then return 678 890
00001  then return 555 
```

你能推荐任何我可以用来解决这个问题的库吗？

编辑：向量本身是动态的，并且位大小可以根据想要返回相应数组元素的 1 位而变化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T05:34:00.533

您最终希望将位集映射到它们的位索引。使用众所周知的小技巧很容易做到这一点：

```
bit_mask_iterator= bits;

while (bit_mask_iterator)
{
    long single_bit_set= bit_mask_iterator & -bit_mask_iterator;
    long bit_index= count_bits_set(single_bit_set - 1); // this is the index you want
    bit_mask_iterator&= bit_mask_iterator - 1;
} 
```

在哪里`count_bits_set`可以使用编译器内在或手动实现（请参阅[http://www-graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel](http://www-graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel)）。如果您愿意，您也可以使用查找 log2 `single_bit_set`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T12:12:59.543

我假设一个位掩码存储在一个容器中（以支持系统上具有多个`sizeof(uintmax_t)`位的位掩码）。在这种情况下，解决方案的本质是：

```
std::remove_copy_if(v.begin(), v.end(), std::back_inserter(out),
                    !*boost::lambda::var(pred)++); 
```

其中`v`- 输入向量；`out`- 存储结果的向量；`pred`- 位掩码上的迭代器。

如果您想避免`boost::lambda`，那么很容易模拟：

```
template <class InputIterator, class OutputIterator, class PredicateIterator>
void copy_if(InputIterator first, InputIterator last, OutputIterator result,
             PredicateIterator pred) {
  for ( ; first != last; ++first)
    if (*pred++)
      *result++ = *first;
} 
```

它可以按如下方式使用（使用与上例相同的符号）：

```
copy_if(v.begin(), v.end(), std::back_inserter(out), pred); 
```

或使用谓词相同：

```
template <class Iterator>
class Pred {
  Iterator it;
public:
  Pred(Iterator it_) : it(it_) {}
  template <class T>
  bool operator ()(T /* ignore argument */) { return !*it++; }
};
template <class Iterator>
Pred<Iterator> iterator2predicate(Iterator it) {
  return Pred<Iterator>(it);
} 
```

可以按如下方式使用：

```
std::remove_copy_if(v.begin(), v.end(), std::back_inserter(out),
                    iterator2predicate(pred)); 
```

示例（使用`boost::lambda`，但很容易将其替换为上述两个其他选项）：

```
/** g++ -Wall -Ipath/to/boost -o filter_array filter_array.cpp */
#include <algorithm>
#include <iostream>
#include <iterator>     // back_inserter()
#include <vector>    
#include <boost/lambda/lambda.hpp>

#define LEN(array) (sizeof(array) / sizeof(*(array)))    
#define P(v) { std::for_each(v.begin(), v.end(),            \
                   std::cout << boost::lambda::_1 << " ");  \
               std::cout << std::endl; }

int main() {
  int a[] = {123, 345, 678, 890, 555,};
  const size_t n = LEN(a);
  bool bits[][n] = { 
    1, 0, 1, 0, 0,
    0, 0, 1, 1, 0,
    0, 0, 0, 0, 1,
  };
  typedef std::vector<int> Array;
  Array v(a, a + n);
  P(v);      
  for (size_t i = 0; i < LEN(bits); ++i) {
    Array out;
    std::vector<bool> b(bits[i], bits[i] + LEN(bits[i]));
    std::vector<bool>::const_iterator pred = b.begin();
    P(b);
    std::remove_copy_if(v.begin(), v.end(), std::back_inserter(out),
                        !*boost::lambda::var(pred)++);
    P(out);
  }
} 
```

输出：

```
123 345 678 890 555 
1 0 1 0 0 
123 678 
0 0 1 1 0 
678 890 
0 0 0 0 1 
555 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T09:31:22.583

```
int bitMask = 11;  // 1011 (reverse the bitmask when it comes in)
int count = 0;
vector<int> myVector (4);
vector<int> returnVector;

myVector[0] = 123;
myVector[1] = 356;
myVector[2] = 678;
myVector[3] = 890;

while (bitMask)
{
    if (bitMask & 0x01)
    {
        returnVector.push_back (myVector[count]);
    }
    count++;
    bitMask >>= 1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T06:32:09.253

这是一个快速而肮脏的解决方案

```
 vector<int> filtered;

    char *bits = "0011";

    for(int i = 0;i < sizeof(bits) ; i++)
      if(bit[i] == '1')
        filtered.push_back(myvector[i]);

    return  filtered 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T08:54:47.803

好的，您可以使用过滤迭代器稍微优雅一点。正如我在您的问题中看到的那样，数组上的索引以与数字相反的顺序开始（数字的位置“0”的索引对应于数组中的位置“3”）。因此，您必须反向查看数组以选择正确的元素。另外，由于返回值可能包含 0、1、2、3 或 4 个元素，我建议您返回一个列表。这里有一个提示：

```
struct filter
{
    filter (int n) :number (n)
    {
    }

    bool operator()(int other_number)
    {
            bool result = number & 1;
            number>>=1;
            return result;
    }

    int number;

}; 

int main(void)
{
using namespace std;

    vector<int> my_v (4);
    my_v[0] = 123;
    my_v[1] = 356;
    my_v[2] = 678;
    my_v[3] = 890;

    int bin_num = 10; // 1010

    list<int> out_list;

    std::copy(boost::make_filter_iterator (filter (bin_num),
                                           my_v.rbegin(),
                                           my_v.rend()),
              boost::make_filter_iterator(filter (bin_num),
                                          my_v.rend(), my_v.rend()),
              std::front_inserter (out_list));
    // out_list will have 123 678

} 
```

希望这可以帮助，

# php - PHP 中的模板，以及通知应用程序存在模板的最佳方式？

> ID：540128
> 
> 赞同：2
> 
> 时间：2009-02-12T05:12:22.393
> 
> 标签：php, templates, codeigniter

我正在使用 CodeIgniter，并且可能会使用他们的模板库，因为我想让事情变得非常简单易用。模板变量的内容将来自数据库，但我希望业务管理员知道哪些内容区域可用。基本上是选择特定模板时的参数名称。例如，Joomla 使用一个额外的 XML 文件来定义每个区域，而 Wordpress 使用页面模板中的注释来通知系统 PHP 文件是一个模板。我喜欢 Joomla 方法，因为您不必解析 PHP 文件来查找区域，但我喜欢 Wordpress 方法，因为您没有与每个模板关联的额外 XML 文件。我还缺少其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T19:12:06.387

您可以直接在控制器中执行此操作：

```
// in the controller
print_r($data);
$this->load->view("main", $data); 
```

或者更简单一点，但您可以将 PHP`array`变量（或`object`）传递给模板：

```
// in the controller
$data = array();
$data["namespace"] = array(
    "title" => "My website",
    "posts" => array("hi", "something else")
);
$this->load->view("main", $data); 
```

然后在视图中，有一个标志来显示所有可用`print_r`的`namespace`变量，以便业务管理员确切知道要使用什么。

```
// in the view
if(isset($namespace["showAllVars"])) print_r($namespace); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T09:30:55.847

我认为最好的方法是在模板解析器类中添加一个小技巧。代码在 system/libraries/Parser.php 中看起来非常可读和干净。您可以在该类中插入一个可用于跟踪变量的钩子。我不知道它是否有效，但这里有一个片段：

```
class CI_Parser {
    var $varCallback;
    function setVarCallback($callbackFunction) {
        $this->varCallback = $callbackFunction;
    }
    ...
    function _parse_single(...) {
        $callback = $this->varCallback;
        $callback($key);
    }
...

//Somewhere in your code
function storeVarName($variableName) {
    // Persist the variable name wherever you want here
}
$this->parser->setVarCallback('storeVarName'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T20:11:53.380

一种选择是在 PHP 文件上调用[token_get_all](http://us2.php.net/manual/en/function.token-get-all.php)（仅当您的业务管理员正在加载它时），并解析该文件的输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T08:01:17.513

在我看来，最好的方法是将变量定义保存在另一个地方（例如数据库表或单独的文件）。这将有助于测试（即，程序员不能只是删除标签然后它就消失了）并确保在您及时进行应用程序开发时事情仍然有效。

另一个优点是您的应用程序逻辑将独立于模板引擎。

附带说明一下，如果您预计会有很多流量，您可以考虑使用 smarty。我们已经对周围的大多数模板引擎进行了广泛的测试，smarty 是最快的。

# domain-driven-design - 我在哪里可以找到一些 DDD 的好例子？

> ID：540130
> 
> 赞同：414
> 
> 时间：2009-02-12T05:12:50.427
> 
> 标签：domain-driven-design

我正在学习领域驱动设计，但是有一些实际问题让我感到困惑，我认为看到一些好的样本可能会清楚。

有谁知道一些可以很好地建模基本 DDD 概念的工作代码示例？

特别感兴趣

*   说明性领域模型
*   存储库
*   使用域/应用程序服务
*   值对象
*   聚合根

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2009-02-13T03:02:02.433

DDD 示例的困难在于它们通常是非常特定于领域的，并且生成的系统的技术实现并不总是显示在建模领域时所做的设计决策和转换，这实际上是 DDD 的核心。DDD 更多的是关于过程而不是代码。（有人说，最好的 DDD 样本就是书本身！）

也就是说，一个注释良好的示例应用程序至少应该揭示其中一些决策，并在将域模型与用于实现它的技术模式匹配方面为您提供一些指导。

您尚未指定您使用的是哪种语言，但我会用几种不同的语言为您提供一些：

[DDDSample - 一个反映 Eric Evans 在](https://github.com/citerus/dddsample-core)[他的书中](http://www.domaindrivendesign.org/books/index.html#DDD)谈到的示例的 Java 示例。这得到了很好的评论，并展示了许多不同的方法来解决使用单独的有界上下文（即表示层）的各种问题。它正在积极工作中，因此请定期检查以获取更新。

[dddps](http://www.codeplex.com/dddpds) - Tim McCarthy 的示例 C# 应用程序，用于他的书，.NET 域驱动设计与 C#

[S#arp 架构](https://github.com/sharparchitecture/Sharp-Architecture)- 一个实用的 C# 示例，不像“纯粹的” DDD 方法可能是因为它缺乏真正的领域问题，但仍然是一种很好的干净方法。

使用所有这些示例应用程序，最好查看 SVN 的最新主干版本/任何东西，以真正了解思维和技术模式，因为它们应该定期更新。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-13T20:56:15.317

不是每个说的源项目，但我偶然发现了 Parleys.com，它有一些很好的视频，很好地涵盖了 DDD（需要 Flash）：

*   [使用富域模型改进应用程序设计](https://plainoldobjects.com/2013/01/28/a-blast-from-the-past-improving-application-design-with-a-rich-domain-model-springone-2007/)
*   为领域驱动设计获取正确的值对象（不可用）

我发现这些比目前可用的几乎不存在的 DDD 示例更有帮助。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-03-02T16:27:25.157

Eric Evans 的领域驱动设计书中的 .NET DDD 示例可以在这里找到：http: [//dddsamplenet.codeplex.com](http://dddsamplenet.codeplex.com)

干杯，

雅库布·G

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-10-15T15:29:17.183

查看[项目 Silk](http://silk.codeplex.com/)。它不仅展示了 DDD，还展示了其他前沿模式。对于任何 Web 开发人员来说，这都是一个极好的资源。可以在[MSDN](http://msdn.microsoft.com/en-us/library/hh396380.aspx)上找到该项目的完整概述。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-12-22T03:27:10.763

这是一个基于领域驱动设计的好例子，并解释了为什么拥有单独的领域层很重要。
[Microsoft 西班牙 - DDD N 层架构](http://www.google.com.sg/url?sa=t&rct=j&q=dddnlayerspain&source=web&cd=1&ved=0CCsQFjAA&url=http://microsoftnlayerapp.codeplex.com/&ei=caPyTu_fNsLXrQeno7QD&usg=AFQjCNFAReI4k6mOYTgbPAH3SGCAD4Xi9g&sig2=J-8ABz4_SKD03yaWUB1mJg)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-12-03T22:57:03.773

[ddd-cqrs-sample](http://code.google.com/p/ddd-cqrs-sample/) is also a good resource. Written with Java, Spring and JPA.

Updated link: [https://github.com/BottegaIT/ddd-leaven-v2](https://github.com/BottegaIT/ddd-leaven-v2)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-11-05T19:00:40.020

[Code Camp 服务器](http://code.google.com/p/codecampserver/)，[Jeffrey Palermo 的](http://jeffreypalermo.com/)[ASP.NET MVC in Action](https://rads.stackoverflow.com/amzn/click/com/1933988622)一书的示例代码。虽然本书侧重于表示层，但应用程序是使用 DDD 建模的。

# sql-server - 使用规范化表真的更好吗？

> ID：540136
> 
> 赞同：10
> 
> 时间：2009-02-12T05:15:12.573
> 
> 标签：sql-server, database, oracle, normalization

我听我的团队负责人说，在过去的一些项目中，他们不得不取消规范化以使查询更快。

我认为这可能与表联合有关。

拥有更多的瘦桌子真的比拥有很少的胖桌子效率低吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-12T05:23:58.730

这取决于......加入表本质上比拥有一个“预加入”的大表慢，即去规范化。但是，通过非规范化，您将创建数据重复，并且您的表将变得更大。规范化被视为一件好事，因为它创建了可以回答“任何”问题的数据库，如果做得正确，您可以构建一个选择来获取您的数据。在其他一些形式的 DB 中情况并非如此，这些现在（大部分）是历史上的不相关，规范化/关系 DB 赢得了这场战斗。

回到您的问题，使用反规范化使事情变得更快是一种被广泛接受的技术。通常最好运行您的数据库一段时间，这样您就知道要反规范化什么以及不理会什么，并且将数据保留为“正确”的规范化形式并将数据拉入一组反规范化报告中也很常见定期表。如果该过程作为报告运行的一部分完成，那么数据也始终是最新的。

作为过度规范化的一个例子，我在过去看到过数据库，其中一周中的几天和一年中的几个月被拉到单独的表中 - 日期本身被规范化 - 你可能走得太远了。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-12T05:48:41.933

[您应该对OLTP](http://en.wikipedia.org/wiki/OLTP)（在线事务处理）和[OLAP](http://en.wikipedia.org/wiki/OLAP)（在线分析处理）数据库之间的差异进行一些研究。

简而言之，主要关注记录事务 (OLTP) 的数据库系统通常以更规范的方式构建，减少数据重复并简化记录的创建和更新，但以优化数据检索为代价。

更关注数据检索和分析（OLAP）的数据库系统通常以不太规范的方式构建，牺牲数据存储优化以最大化查询和分析速度。

[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)和[非规范化](http://en.wikipedia.org/wiki/Denormalization)是这种权衡的核心。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T06:34:16.690

杰夫[写了这篇文章](http://www.codinghorror.com/blog/archives/001152.html)，随后进行了激烈的讨论。它也是关于 SO 的大量讨论的主题，例如，[什么更好的数据库设计更多的表或更多的列](https://stackoverflow.com/questions/59482/whats-the-better-database-design-more-tables-or-more-columns)。正如其他人所指出的，使用常识并且不要过度规范化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T10:32:19.037

在我长期使用 Oracle **OLTP**数据库的经验中，其中一些数据库非常庞大且繁忙，老实说，我不记得曾经遇到过真正需要“非规范化以提高性能”的案例。然而，我看到很多情况下，有人提前决定应该应用非规范化，因为他们担心、不确定和怀疑潜在的性能问题。这通常是在没有任何基准测试的情况下完成的，而且我总是发现实际上并没有实现任何性能改进——但是数据维护代码变得比原来要复杂得多。

OLAP 是一种非常不同的动物，我无法对此发表评论。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T06:04:22.207

这个问题经常重复出现。主要原因是 SQL，最流行的数据库语言，以及所有最流行的实现，都将逻辑表设计与物理表设计混为一谈。

永恒的答案是你应该总是规范化你的逻辑表，但务实的答案是复杂的，因为在现有 SQL 实现下实现某些优化的唯一方法是非规范化你的物理表设计（本身不是一件坏事），在这些实现中，需要非规范化您的逻辑表设计。

简而言之，这取决于。有时非规范化对性能很重要，但就像其他所有与性能相关的事情一样，你应该在考虑沿着这条路线走之前测量、测量、测量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T05:20:22.203

性能与在 RDBMS 上完成的标准化量成反比。话虽如此，表格越正常，出错的可能性就越小。非规范化可能会损害 RDBMS 的性能，即所有数据都保存在一个表中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T05:19:50.987

众所周知，规范化会损害性能的原因是连接相当昂贵。如果表 X 中有 N 条记录，表 Y 中有 M 条记录，则 X 和 Y 的连接会创建一个包含多达 N*M 条记录的临时表。尽管数据库在不需要时使用一些优化技巧来不生成整个表，但它仍然必须处理所有记录。

非规范化是将经常使用的数据放在一个表中以提高性能的过程，以提高数据库的纯度。大多数人认为这是一种可接受的交易，甚至甚至故意设计非规范化的模式以跳过中间步骤。

# c++ - C++ 中头文件和 cpp 文件的约定是什么？

> ID：540140
> 
> 赞同：3
> 
> 时间：2009-02-12T05:19:05.123
> 
> 标签：c++, header, include

在 C++ 中，在“主”文件中包含类文件头的约定是什么。例如

```
myclass.h 

class MyClass {
  doSomething();
}

myclass.cpp

  doSomething() {
      cout << "doing something";
  }

run.cpp

#include "myclass.h"
#include "myclass.cpp"

etc.. 
```

这是比较标准的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T05:24:20.510

您不包含 .cpp 文件，仅包含 .h 文件。.cpp 中的函数定义将被编译为 .obj 文件，然后将链接到最终的二进制文件中。如果将 .cpp 文件包含在其他 .cpp 文件中，则会编译出两个具有相同功能定义的不同 .obj 文件，这将导致链接器错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T05:22:49.500

请参阅[Understanding C Compilers](https://stackoverflow.com/questions/533076/understanding-c-compilers-from-a-java-c-perspective/533138#533138)以获得这个问题的很多好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T05:30:57.200

您可以说一个 .cpp 文件及其所有包含的标头构成一个翻译单元。顾名思义，一个翻译单元是独立编译的。然后，每个翻译单元的结果通常称为 file.o 或 file.obj，然后由链接器链接在一起，修复尚未解析的引用。所以在你的情况下你有

```
Translation Unit 1 = run.cpp: myclass.h ...
Translation Unit 2 = myclass.cpp: myclass.h ... 
```

您的类定义将出现在两个翻译单元中。但这没关系。这是允许的，只要两个类的定义相同。但如果函数不是内联的，则不允许在两个翻译单元中出现相同的函数。非内联函数只允许在一个翻译单元中定义一次。然后，您让链接器获取每个翻译单元的结果，并将它们绑定到一个可执行文件：

```
Executable = mystuff: run.o myclass.o ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T05:22:59.093

通常您单独编译 .cpp 文件并将生成的 .o 与其他 .o 链接

所以 myclass.cpp 将包含 myclass.h 并将被编译为一个单元。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T05:26:03.190

您单独编译 cpp 文件。如果您将任何给定的 cpp 文件包含在两个或多个 cpp 文件中，那么您可能会在链接阶段遇到冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T05:27:30.173

您不能在另一个 *.cpp 中包含一个 *.cpp。反而：

* * *

**我的班级.h**

```
class MyClass {
  doSomething();
} 
```

* * *

**我的类.cpp**

```
#include "myclass.h"

MyClass::doSomething() {
      cout << "doing something";
} 
```

* * *

**运行.cpp**

```
#include "myclass.h"

etc.. 
```

* * *

不是将 myclass.cpp 包含在 main.cpp 中（这样编译器会一次看到它们），而是分别编译 myclass.cpp 和 main.cpp，然后让“链接器”将它们组合成一个可执行文件。

# php - jquery 表单插件和程序化提交

> ID：540142
> 
> 赞同：2
> 
> 时间：2009-02-12T05:19:19.727
> 
> 标签：php, jquery, ajax, forms

SO也有类似的问题，但似乎没有一个可以解决这个问题。

下面是我的情况的一个非常简化的变体。Drupal/PHP 站点——我有一个带有提交按钮的表单，我正在使用 jquery.form 插件来进行 ajax-ly 提交。如果我使用提交 (#submit) 按钮，它工作正常。

现在，我想使用表单外的另一个按钮 (#submit2) 以编程方式触发该按钮。我可以使用 jquery click() 函数来做到这一点，但是返回的内容不会像我期望的那样进入 ajax 目标。

我没有太多的自由来重新组织这段代码，否则我会的。

（请注意，我试图通过 src-ing jquery 和我网站上的表单插件让您轻松运行此代码。）

想法？谢谢！

```
<?php
if ($_REQUEST['submit'] == 'Submit') {
    print 'ajax returns ... ' . $_REQUEST['text']; 
    exit; 
}
?>
<html>
<head>
    <script type="text/javascript" src="http://enjoy3d.com/scripts/jquery-1.2.6.js"></script>
    <script type="text/javascript" src="http://enjoy3d.com/scripts/jquery.form.js"></script>
    <script type="text/javascript">
        $(function() {
            $('#form').ajaxForm( { target: $('#span') } );
            $('#submit2').click( function() { $('#submit').click(); } );
        });
    </script>
</head>
<body>
    <span id='span'>target span</span>
    <form method='post' id='form'>
        <input type='text' name='text' size='50' />
        <input type='submit' id='submit' name='submit' value='Submit'/>
    </form>
    <input type='submit' id='submit2' name='submit2' value='Submit Too?' />
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:23:04.230

我设法解决了与您类似的情况。如果模拟点击 submit1 的唯一目的是提交表单，您可以尝试：

```
$('#submit2').click(function() {
    $('#form').trigger('submit');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T06:59:35.757

您是否尝试过为表格命名，而不是

```
$('#submit2').click( function() { $('#submit').click(); } ); 
```

正在做

```
$('#submit2').click( function() { document.myForm.submit(); } ); 
```

如果表单已被 ajaxified，这应该与单击提交按钮相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T06:09:37.203

您可能还需要`return false`在触发表单提交按钮后立即从非表单提交按钮单击事件代码。例如：

```
<script type="text/javascript">
  $(function() {
    $('#form').ajaxForm({ target: $('#span') });
    $('#submit2').click(function() { $('#submit').click(); return false; });
  });
</script> 
```

这个对我有用。那是你要找的吗？

# sql-server-2005 - SQL Server 2005 数据库中的复杂查询

> ID：540146
> 
> 赞同：1
> 
> 时间：2009-02-12T05:21:01.110
> 
> 标签：sql-server-2005, constraints

我的数据库中有一个表，其中的记录在概念上可以是其他 rcords 的子项。该表有一个非空名称字段。我需要确保一组孩子中的每个名字都是唯一的，但不是在整个数据库中都是唯一的。我想使用数据库内的约束来强制执行此操作。实现这一目标的最佳方法是什么？我知道我将不得不在这个过程中的某个时刻进行如下查询：

```
@NameParameter NVARCHAR(512)
Select Name from MyTable
WHERE Name=@NameParameter 
```

问题是我把这个查询放在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T05:33:53.903

我可能没有正确理解您的问题，但我的建议是创建另一个引用孩子父记录的列。然后，您可以基于这两列创建一个多列索引，以加快在 where 子句中同时引用这些列的任何查询......因此，您的唯一性将来自 {parent_name，child_name}。对这两列的约束将充当该表的键，并且不允许重复。

```
@childname NVARCHAR(255), @parentname NVARCHAR(255)
SELECT * FROM [child_records] 
WHERE [parent_name] = @parentname 
AND [child_name] = @childname 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T05:28:06.320

乍一看，我认为这应该进入“而不是触发器”。这个[链接](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6113179.html)提供了一个很好的例子。

# java - Java 类加载器

> ID：540150
> 
> 赞同：25
> 
> 时间：2009-02-12T05:22:28.190
> 
> 标签：java, classloader, dynamic-class-loaders

谁能给我一个好的资源或解释一下类加载器背后的概念？[我在类加载器http://www.onjava.com/lpt/a/5586](http://www.onjava.com/lpt/a/5586)上找到了以下资源，但仍然没有帮助。以下问题可能看起来很愚蠢，但试图回答它们总是让我感到困惑。

*   为什么开发人员要编写自定义类加载器，为什么不调用 Bootstrap 类加载器来调用您的自定义类？定义自定义类加载器需要什么？

*   为什么有这么多种类加载器？例如：Bootsrap、Comman、Catalina 类加载器等，

    提前致谢。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-12T08:42:24.933

我发现以下创建自定义类加载器的正当理由：

1.  您希望从非常规来源加载一个类（例如，一个类的字节码存储在数据库中，通过网络存储或[由 pidgeons](http://www.ietf.org/rfc/rfc1149.txt?number=1149) - MessengerPidgeonClassLoader 作为 0 和 1 携带）。对于这种情况，API 中已经有一些 ClassLoader 实现，例如[URLClassLoader](http://java.sun.com/j2se/1.4.2/docs/api/java/net/URLClassLoader.html)。

2.  您需要定义不同的层次结构来加载类。ClassLoader 的默认实现首先将搜索委托给父级，然后他们尝试自己加载类。也许您想要不同的层次结构。这就是为什么 OSGI 和 Eclipse 有自己的 ClassLoaders 的原因，因为 Manifest .MF 文件定义了所有类型的奇怪的层次结构路径（例如伙伴类加载）。所有 Eclipse 类加载器都实现了 BundleClassLoader 接口，并且有一些额外的代码可以在 Eclipse 插件中查找资源。

3.  您需要对字节码进行一些修改。也许字节码是加密的，你会即时解密它（[不是说它有帮助，真的，但已经尝试过了](http://www.javaworld.com/javaworld/javaqa/2003-05/01-qa-0509-jcrypt.html)）。也许您想“修补”动态加载的类（A la JDO 字节码增强）。

如果您需要从内存中卸载类或加载类而不是在运行时更改其定义，则需要使用与系统类加载器不同的类加载器。例如，一个典型的案例是应用程序从 XML 文件动态生成一个类，然后尝试重新加载该类。一旦一个类在系统类加载器中，就没有办法卸载它并有一个新的定义。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-12T08:30:56.567

类加载器的一个常见用途是隔离 JAR。如果您有一个使用插件的应用程序（[Eclipse](http://www.eclipse.org/)，[Maven 2](http://maven.apache.org/)），那么您可能会遇到这种情况：插件 X 需要 jar A 版本为 1.0，而插件 Y 需要相同的 jar 但版本为 2.0。不过，X 不能在 2.0 版中运行。

如果您有类加载器，则可以创建类的分区（想想由薄桥连接的孤立岛屿；这些桥就是类加载器）。这样，类加载器可以控制每个插件可以看到的内容。

当插件 X 实例化具有静态字段的类 Foo 时，这没有问题，并且不会与插件 Y 中的“相同”类混淆，因为每个类加载器实际上都会创建自己的类 Foo 实例。然后，您在内存中有两个类，其中`cl1.getName().equals(cl2.getName())`是`true`但`cl1.equals(cl2)`不是。这意味着 cl1 的实例与 cl2 的实例不兼容。这可能会导致无法分配给的奇怪`ClassCastExceptions`说法。`org.project.Foo``org.project.Foo`

就像偏远岛屿一样，这两个班级不知道另一个班级的存在。想想在不同岛屿上出生然后长大的克隆人。从 VM 的角度来看，没有问题，因为 Class 类型的实例的处理方式与任何其他对象一样：可以有多个。您认为其中一些是“相同的”对 VM 来说并不重要。

此模式的另一个用途是您可以摆脱以这种方式加载的类：只要确保没有人拥有指向从类加载器加载的类创建的任何对象的指针，然后也忘记类加载器。在[GC](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))的下一次运行中，此类加载器加载的所有类都将从内存中删除。这允许您“重新加载”您的应用程序，而无需重新启动整个 VM。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T06:58:22.547

java类加载器的另一个好链接[——Java类加载器](http://technologiquepanorama.wordpress.com/2009/01/13/java-classloaders/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T18:08:11.733

我在过去写过一些关于使用授权后类加载器的博客：

*   [编写委托后类加载器](http://tech.puredanger.com/2006/11/09/classloader/)
*   [两个类加载器的故事](http://tech.puredanger.com/2007/06/15/classloaders/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-15T10:53:44.737

在这种情况下，您不能超越原始来源。如果您*真的*想要内部涂料，*硬核*，请阅读[Java 虚拟机规范的相关部分](http://java.sun.com/docs/books/jvms/second_edition/html/Concepts.doc.html#19175)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T05:50:10.743

您需要创建自己的 ClassLoader 是非常罕见的。通常，如果您需要，您应该已经非常了解 ClassLoader 的作用。

换句话说，如果您问为什么需要创建自己的 ClassLoader，那么您不需要创建一个；)

话虽如此，我还看到为处理密码学的应用程序创建了一个 ClassLoader。这样，每次您创建 java.netSocket 或某种文件/流对象时，它不会使用 JVM 版本，而是使用它们自己特殊的自定义构建类。通过这种方式，他们可以保证所有信息都已加密并且没有开发人员错误。

但这不是很常见。您无需创建自己的自定义 ClassLoader 即可完成整个 Java 职业生涯。实际上，如果您需要创建一个，您应该真正询问是否有必要。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-20T02:27:41.753

一个例子：

Tomcat 使用定制的 WebAppClassloader 从不同的 Web 应用程序中加载和隔离类/jar。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T05:29:35.130

> *为什么开发人员要编写自定义类加载器，为什么不调用 Bootstrap 类加载器来调用您的自定义类？定义自定义类加载器需要什么？*

根据应用程序，开发人员可能会覆盖或完全替换类加载机制以满足他们的需求。

例如，我使用了一个应用程序，其类是从 LDAP 加载的：S

其他应用需要独立的类管理（比如大多数支持热部署的应用服务器）

关于资源，网络上有大量的资源，根本无法列出。

# api - 流行语言或库中最大的设计错误是什么？

> ID：540155
> 
> 赞同：0
> 
> 时间：2009-02-12T05:23:11.260
> 
> 标签：api, programming-languages

对于我们每天使用的流行语言和库：一些糟糕的设计、令人尴尬的 API 或普遍糟糕的可用性的例子是什么？我们必须为设计错误付出代价，因为它们会引入微妙的错误，我们必须使用笨拙的解决方法或记住不直观的方式来完成工作。

我特别想到了这样的问题：OO 语言中有一个类实际上不应该从其他类继承。有一个特殊的运算符使某种语言难以解析，结果证明它无论如何都没有使用。一个名称错误或经常用于其他用途的函数（我正在考虑对`std::getline`字符串进行标记）。

我*不是*在寻找那些抨击语言并声称 Perl 或其他一些语言设计糟糕的贡献。我更多的是寻找关于显然应该以不同方式完成的事情的具体例子或轶事。（也许设计者发现它为时已晚，并试图在后续版本中修复它，但必须保持向后兼容性。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T05:46:07.523

Java 的 URL 类在确定 URL 对象的 hashCode 时会（或在几年前）进行 DNS 查找。因此，不仅以 URL 作为键的哈希表非常慢，而且如果两个连续的 DNS 请求返回不同的值或拔下网络电缆，它可能会在运行时发生变化！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T05:45:27.400

名为“NullPointerException”的 Java 类

从 C++ 迁移到 Java 后，我总是觉得在“无指针”的语言中找到 NullPointerException 很有趣

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T08:02:22.190

大多数 C++ 都是设计缺陷，但大多数人学会了忍受它。[鸭子群众反对投票]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T08:27:11.647

PHP 有很多， ($needle,$haystack) ($haystack,$needle) 不一致。带有 mb_ 前缀的字符串函数以启用多字节支持。我最喜欢的 mysql_escape_string 和 mysql_real_escape_string ......让我们不要开始 OO 部分...... :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T11:44:15.993

Java“日历”API。它容易出错且难以使用。

列举几个问题：

*   误导性名称：Calendar 对象应该模拟一个“日历系统”，但实际上封装了一个时间对象，即它是一种 Date（这本身就是一个问题，因为 Date 最好命名为 DateTime 或 TimeStamp）
*   Calendar 只有一个具体的子类（GregorianCalendar），但抽象的 Calendar 类包含仅在这种特定情况下有用的常量（JANUARY、MONDAY、AM_PM、ERA）
*   您使用常量（“MONDAY”、“WEEK_OF_MONTH”等）修改字段；这些是整数，很容易混淆。
*   事实上，几乎每个参数和返回值都是一个整数；基于 0 和 1 的数字的常见问题适用（是 1 月 0 日还是 1 日？=
*   像“HOUR”和“HOUR_OF_DAY”这样的常量，只有在使用 AM/PM 系统时才有意义（无论如何，美国以外的人都无法理解 ;-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T08:39:49.383

我个人最喜欢的是`atoi`C 标准库。

```
int atoi ( const char * str ); 
```

*   成功时，函数将转换后的整数作为 int 值返回。
*   如果无法执行有效转换，则返回零值。

好吧，不幸的是，用这个函数转换“0”是很痛苦的，因为你无法确定它是错误还是“0”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T07:52:54.130

API 的 where 函数在应该返回空项时返回 null ......然后不记录它们何时、如何或为什么返回 null。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T08:17:09.627

Java 中的已检查与未检查异常。大多数 Java 开发人员要么不知道什么时候使用哪个，要么如果他们知道，他们不同意。

然后我们有一些事情`IOExeption`，当它们发生时你永远无法处理它们，但必须把它们扔掉（在所有意义上）。当你最终到达一个可以处理它们的地方时，你不知道如何找出可能导致它们的原因，所以你只能向用户提供消息和堆栈跟踪，并希望她能弄清楚（这里“她”是知道Java是一种咖啡的普通用户）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T05:55:15.287

我最喜欢的来自 Smalltalk 的世界。 [吱吱作响](http://www.squeak.org/)。在 Squeak 中，Semaphore 类继承自 LinkedList。信号量可以使用链表，但它们本身并不是链表。这导致了一个非常奇怪的界面。这是糟糕的 OO 设计。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T08:16:19.957

我在 Ruby 的 Dir.glob() 中找到了一个。

我还无法证明它与我的特定环境无关，因为我的环境很旧并且是手工拼凑而成的，不幸的是我需要继续支持它。似乎至少有5种情况：

*   目录有文件和一些匹配 -> 这些文件的列表
*   目录有文件但没有匹配 -> 空列表
*   目录为空 -> 无
*   目录存在但当前用户无法读取（不知道这里发生了什么）
*   目录丢失（也没有测试过）

它让我把头发拉了出来，因为文档没有这样描述它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-26T17:06:24.430

在 Java 中，我会选择 InterruptedException 作为检查异常。如果您需要知道您的 sleep 方法提前唤醒，那应该是该方法返回的布尔值。没有什么会像 InterruptedException 那样给受检异常起一个坏名声。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-12T05:48:45.660

[http://www.infoq.com/presentations/effective-api-design](http://www.infoq.com/presentations/effective-api-design)

跳到大约 40 分钟，他谈到了 Java 中的一些 XML API。

总的来说，这是一个非常有趣的演示文稿。

# eclipse - Eclipse RCP 插件开发 - 无法获得新的 menuContribution 选项

> ID：540160
> 
> 赞同：1
> 
> 时间：2009-02-12T05:25:02.677
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp, eclipse-pde

我正在使用 Eclipse 3.2。对于 RCP 应用程序，我正在尝试从 org.eclipse.ui.menus 扩展。当我右键单击并选择新选项时，“菜单贡献”没有出现。我只在“新建”下看到选项“项目”、“菜单”、“组”、“小部件”。没有名为“菜单贡献”的选项。我在目标平台上遗漏了什么吗？如果是这样，哪个罐子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T07:45:15.820

我确认它不能工作。

考虑以下的**扩展点参考**帮助：

*   [3.2.1 中的 org.eclipse.ui.menus](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_menus.html)

    <!ELEMENT 扩展 (item* , menu* , group* , widget*)>

*   [3.4 Ganymede 中的 org.eclipse.ui.menus](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_menus.html)

    <!ELEMENT 扩展 (group* , widget* , menuContribution*)>

这就是为什么你看不到`menuContribution`

[替代文字 http://www.vogella.de/articles/RichClientPlatform/images/command70.gif](http://www.vogella.de/articles/RichClientPlatform/images/command70.gif)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T06:13:20.750

对我有用：
Eclipse SDK
版本：3.4.1
构建 id：M20080911-1700
我建议升级...3.2 有点旧恕我直言

[![pde工作](https://i.stack.imgur.com/all5Q.jpg)](https://i.stack.imgur.com/all5Q.jpg)

# c# - 如何以编程方式更改文件的安全属性，以便任何用户都可以删除该文件

> ID：540161
> 
> 赞同：4
> 
> 时间：2009-02-12T05:25:39.943
> 
> 标签：c#, security, file

我有一个使用模拟的 C# 编写的服务器。

我想知道如何更改文件的安全属性，以便任何用户都可以删除它。

我的服务器模拟一个用户，然后创建一个临时文件。稍后我需要删除该文件，但此时，我不再模拟创建该文件的用户，并且当尝试删除该文件时会生成异常。我的假设是，在我创建文件时，我应该能够更改安全属性以允许任何用户删除该文件。

我如何才能做到这一点（首选 C#，但 p/invoke 也可以）。

我目前正在使用 .NET 1.1，因此可以在 1.1 中实现的方法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T05:29:49.200

听起来您想使用[System.IO.File.SetAccessControl](http://msdn.microsoft.com/en-us/library/system.io.file.setaccesscontrol.aspx)方法添加一个 ACL，使内置的“Everyone”组能够删除文件。MSDN 文档有一个在文件上添加和删除 ACL 记录的[不错示例](http://msdn.microsoft.com/en-us/library/system.security.accesscontrol.filesecurity.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T05:32:30.210

与其让每个人都删除文件，不如只为需要删除文件的人添加条目。根据您的帖子，这可能是您的用户帐户和原始流程。从字面上允许每个人都删除文件会使您自己面临未来的安全问题。

```
public static void AllowIdentityToDelete(FileInfo file, string identity)
{
    var rule = new FileSystemAccessRule(
        identity,
        FileSystemRights.Delete | FileSystemRights.DeleteSubdirectoriesAndFiles,
        AccessControlType.Allow);

    var acls = file.GetAccessControl();
    acls.AddAccessRule(rule);
    file.SetAccessControl(acls);
} 
```

您需要为相关用户传递正确的身份。

# algorithm - 二进制搜索在实践中在哪里使用？

> ID：540165
> 
> 赞同：38
> 
> 时间：2009-02-12T05:28:27.160
> 
> 标签：algorithm, binary-search

每个程序员都被教导二进制搜索是搜索有序数据列表的一种很好、快速的方法。有很多使用二分搜索的玩具教科书示例，但在实际编程中呢：在实际程序中实际使用二分搜索在哪里？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-12T07:35:04.953

二进制搜索*无处不在*。从任何语言库（Java、.NET、C++ STL 等）中获取任何排序的集合，它们都将使用（或可以选择使用）二进制搜索来查找值。虽然您必须很少实施它，但您仍然必须了解它背后的原理才能利用它。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-12T17:47:27.027

*当内存空间紧张时*，可以使用二分查找快速访问有序数据。假设您想将一组 100.000 个 32 位整数存储在一个可搜索的有序数据结构中，但您不会经常更改该集合。您可以轻松地将整数存储在 400.000 字节的排序数组中，并且可以使用二进制搜索快速访问它。但是，如果您将它们放入例如 B-tree、RB-tree 或任何“更动态”的数据结构中，您就会开始产生内存开销。为了说明，将整数存储在具有左子和右子指针的任何类型的树中都会使您消耗至少 1.200.000 字节的内存（假设 32 位内存架构）。当然，您可以进行一些优化，但一般情况下就是这样。

因为更新有序数组（进行插入或删除）非常慢，所以当数组经常变化时，二分查找就没有用了。

这里有一些我使用二进制搜索的实际示例：

*   在案例标签是单个整数的虚拟机中实现“switch() ... case:”构造。如果您有 100 个案例，您可以使用二分搜索在 6 到 7 个步骤中找到正确的条目，其中条件分支序列平均需要进行 50 次比较。
*   使用后缀数组进行快速子字符串查找，其中包含按字典顺序排列的可搜索字符串集的所有后缀（我想节省内存并保持实现简单）
*   寻找方程的数值解（当你懒惰并且不介意实现牛顿法时）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-12T07:31:34.480

每个程序员在调试时都需要知道如何使用二进制搜索。

如果您有一个程序，并且您知道在程序执行期间的某个特定点处可见错误，则可以使用二进制搜索来确定错误实际发生的位置。这比单步执行大部分代码要快得多。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-12T05:38:23.703

二分查找**是**一种又好又快的方法！

在 STL 和 .NET 框架等到来之前，您经常会遇到需要滚动自己的自定义集合类的情况。每当排序数组成为存储数据的可行位置时，二进制搜索就是在该数组中定位条目的方式。

我很确定二进制搜索在今天也被广泛使用，尽管为了您的方便，它由库“在后台”处理。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-12T05:48:24.350

我已经在 BTree 实现中实现了二进制搜索。

BTree 搜索算法用于查找要读取的下一个节点块，但在 4K 块本身（包含基于密钥大小的多个密钥）中，二进制搜索用于查找记录号（对于叶节点) 或下一个块（对于非叶节点）。

与顺序搜索相比，速度快得惊人，因为就像平衡二叉树一样，每次检查都会删除一半的剩余搜索空间。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-12T07:42:30.473

我曾经为一个在图形中显示二维数据的 GUI 控件实现了它（甚至不知道这确实是二进制搜索）。用鼠标单击应将数据光标设置到具有最接近 x 值的点。当处理大量点时（几个 1000，这是 x86 刚刚开始超过 100 MHz CPU 频率的时候），这并不是真正可用的交互式 - 我从一开始就进行线性搜索。经过一番思考，我突然想到我可以分而治之的方式来解决这个问题。我花了一些时间让它在所有边缘情况下工作。

过了一段时间我才知道这确实是一个基本的 CS 算法……

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-12T05:37:33.490

一个例子是 stl 集。底层数据结构是一个平衡的二叉搜索树，由于二叉搜索，它支持 O(log n) 中的查找、插入和删除。

另一个例子是在对数时间内运行的整数除法算法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-12T06:02:16.953

我们仍然在代码中大量使用它来每秒搜索数千次数千次 ACLS。这很有用，因为 ACL 一旦从文件中进入，它们就是静态的，而且我们可能会因为在启动时添加阵列而承受增长阵列的代价。一旦它运行也非常快。

当您最多可以在 7 次比较/跳转中搜索 255 个元素的数组时（8 次中的 511 次，9 次中的 1023 次等），您可以看到二进制搜索的速度几乎与您所能获得的一样快。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-10-31T21:39:20.930

通过动手示例回答您的问题。

在 R 编程语言中有一个包[data.table](https://github.com/Rdatatable/data.table)。它从 C 实现的、短语法、高性能的数据转换扩展中得知。它使用二进制搜索。即使没有二分搜索，它的扩展性也比竞争对手好。您可以在项目 wiki[分组 2E9](https://github.com/Rdatatable/data.table/wiki/Benchmarks-%3A-Grouping) - 随机顺序数据
中找到基准 vs *python pandas*和 vs *R dplyr 。* 还有很好的 benchmark vs databases vs bigdata [benchm-databases](https://github.com/szilard/benchm-databases)。

在最近的 data.table 版本 (1.9.6) 中，二进制搜索得到了扩展，现在可以用作任何原子列的索引。

我刚刚找到了一个很好的总结，我完全同意 -[见](https://news.ycombinator.com/item?id=8795778)。

> 任何进行 R 比较的人都应该使用 data.table 而不是 data.frame。基准测试更是如此。data.table 是我职业生涯中发现的最好的数据结构/查询语言。它在 R 世界中处于领先地位，以我的方式，在所有以数据为中心的语言中都处于领先地位。

所以是的，*二进制搜索*正在被使用，并且由于它，世界变得更好了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-03-04T14:42:13.587

好吧，现在 99% 的 3D 游戏和应用程序都使用了[二分搜索。](http://en.wikipedia.org/wiki/Binary_space_partitioning)空间被划分为树结构，并使用二分搜索根据 3D 位置和相机检索要显示的细分。

它的第一个最伟大的展示之一是 Doom。二叉树和相关的搜索增强了渲染。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-03-02T09:35:25.157

二进制搜索可用于使用 Git 进行调试。它被称为[git bisect](http://git-scm.com/book/en/Git-Tools-Debugging-with-Git#Binary-Search)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-04-08T09:05:14.930

Binary sort is useful in adjusting fonts to size of text with constant dimension of textbox

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-12T06:03:12.303

在其他地方，我有一个解释器，其中有一个命令名称表和一个指向解释该命令的函数的指针。大约有 60 个命令。使用线性搜索不会非常繁重 - 但我使用二进制搜索。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-12T07:51:08.737

用于测量数字时序或模拟电平的半导体测试程序广泛使用二进制搜索。来自 Advantest、Teradyne、Verigy 等的自动测试设备 (ATE) 可以被认为是真值表爆破器，应用输入逻辑并验证数字部件的输出状态。

考虑一个简单的门，输入逻辑在每个周期的时间 ​​= 0 处发生变化，并在输入逻辑发生变化后转换 X ns。如果在 T=X 之前选通输出，则逻辑与预期值不匹配。选通晚于时间 T=X，并且逻辑与预期值匹配。二进制搜索用于查找逻辑不匹配的最新值与它匹配的最早部分之间的阈值。（Teradyne FLEX 系统将时序解析为 39pS 分辨率，其他测试仪具有可比性）。这是一种测量过渡时间的简单方法。相同的技术可用于求解建立时间、保持时间、可操作电源电平、电源与延迟等。

任何类型的微处理器、存储器、FPGA、逻辑和许多模拟混合信号电路都在测试和表征中使用二进制搜索。

——迈克

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-03-04T15:59:29.573

这是[hg bisect的基础](http://mercurial.selenic.com/wiki/BisectExtension)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-08-07T15:10:16.683

我有一个程序迭代一个集合来执行一些计算。我认为这是低效的，所以我对集合进行了排序，然后使用单个二进制搜索来查找感兴趣的项目。我退回了这个项目及其匹配的邻居。我实际上过滤了集合。

这样做实际上比迭代整个集合和找出匹配项要慢。

我继续向集合中添加项目，因为我知道排序和搜索性能最终会赶上迭代。它收集了大约 600 个对象，直到速度相同。1000 个对象具有明显的性能优势。

我还会考虑您正在使用的数据类型、重复和传播。这将对排序和搜索产生影响。

我的答案是尝试这两种方法并为它们计时。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-02-14T21:00:39.933

Python的`list.sort()`方法使用[Timsort](http://en.wikipedia.org/wiki/Timsort)（AFAIK）使用二分搜索来定位元素的位置。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-16T06:20:44.120

寻找方程的根可能是您想要使用二进制搜索等非常简单的算法做的那些非常简单的事情之一。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-06T07:34:14.800

Delphi 使用在排序的 TStringList 中搜索字符串时可以享受二分查找。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-08-07T15:15:58.437

我相信 .NET`SortedDictionary`在幕后使用二叉树（很像 STL 映射）......所以使用二叉搜索来访问`SortedDictionary`

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-03-04T14:54:10.743

二分搜索提供了许多现成的地图/字典实现所没有的功能：查找非精确匹配。

例如，我使用二分搜索来实现基于 GPS 日志的照片地理标记：将所有 GPS 航点放在一个按时间戳排序的数组中，并使用二分搜索来识别在时间上最接近每张照片时间戳的航点。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2009-02-12T05:39:08.180

如果要在数组中查找一组元素，则可以线性搜索每个元素，也可以对数组进行排序，然后使用具有相同比较谓词的二进制搜索。后者要快得多。

# perl - 如何将表格变成矩阵？

> ID：540168
> 
> 赞同：1
> 
> 时间：2009-02-12T05:29:36.503
> 
> 标签：perl, hash, matrix, perl-data-structures

如果我在文本文件中有一个表格，例如

*   AB 1
*   交流电 2
*   公元1
*   巴 3
*   光盘 2
*   AE 1
*   编 2
*   CB 2
*   . . .
*   . . .
*   . . .

我在另一个文本文件中得到了另一个符号列表。我想将此表转换为 Perl 数据结构，例如：

*   _阿德。. .
*   一个 0 1 1 。. .
*   D 1 0 2 。. .
*   E 1 2 0 。. .
*   . . . . . . .

但我只需要一些选定的符号，例如在符号文本中选择了 A、D 和 E，但没有选择 B 和 C。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T05:57:48.823

第一个使用数组，第二个使用二维散列。第一个应该大致如下：

```
$list[0] # row 1 - the value is "A B 1" 
```

哈希值如下：

```
$hash{A}{A} # the intersection of A and A - the value is 0 
```

弄清楚如何解决问题对我来说大约是心理战的 75%。我不打算详细说明如何打印散列或数组，因为这很容易，而且我也不完全清楚您希望如何打印或打印多少。但是将数组转换为哈希应该看起来像这样：

```
foreach (@list) {
  my ($letter1, $letter2, $value) = split(/ /);
  $hash{$letter1}{$letter2} = $value;
} 
```

至少，我认为这就是你要找的。如果您*真的*想要，您可以使用正则表达式，但这对于仅从字符串中提取 3 个值可能是过大的。

编辑：当然，您可以放弃`@list`并直接从文件中组装散列。但这是你的工作，不是我的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-05T12:21:09.973

你可以用 awk 试试这个：

awk -f matrix.awk yourfile.txt > newfile.matrix.txt

其中 matrix.awk 是：

```
BEGIN {
   OFS="\t"
}
{
  row[$1,$2]=$3
  if (!($2 in f2)) { header=(header)?header OFS $2:$2;f2[$2]}
  if (col1[c]!=$1)
     col1[++c]=$1
}
END {
  printf("%*s%s\n", length(col1[1])+2, " ",header)
  ncol=split(header,colA,OFS)
  for(i=1;i<=c;i++) {
    printf("%s", col1[i])
    for(j=1;j<=ncol;j++)
      printf("%s%s%c", OFS, row[col1[i],colA[j]], (j==ncol)?ORS:"")
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T08:08:57.027

另一种方法是制作一个二维数组 -

```
my @fArray = ();
## Set the 0,0th element to "_"
push @{$fArray[0]}, '_';

## Assuming that the first line is the range of characters to skip, e.g. BC
chomp(my $skipExpr = <>);

while(<>) {
    my ($xVar, $yVar, $val) = split;

    ## Skip this line if expression matches
    next if (/$skipExpr/);

    ## Check if these elements have already been added in your array
    checkExists($xVar);
    checkExists($yVar);

    ## Find their position 
    for my $i (1..$#fArray) {
        $xPos = $i if ($fArray[0][$i] eq $xVar);
        $yPos = $i if ($fArray[0][$i] eq $yVar);
    }

    ## Set the value 
    $fArray[$xPos][$yPos] = $fArray[$yPos][$xPos] = $val;
}

## Print array
for my $i (0..$#fArray) {
    for my $j (0..$#{$fArray[$i]}) {
        print "$fArray[$i][$j]", " ";
    }
    print "\n";
}

sub checkExists {
    ## Checks if the corresponding array element exists,
    ## else creates and initialises it.
    my $nElem = shift;
    my $found;

    $found = ($_ eq $nElem ? 1 : 0) for ( @{fArray[0]} );

    if( $found == 0 ) {
        ## Create its corresponding column
        push @{fArray[0]}, $nElem;

        ## and row entry.
        push @fArray, [$nElem];

        ## Get its array index
        my $newIndex = $#fArray;

        ## Initialise its corresponding column and rows with '_'
        ## this is done to enable easy output when printing the array
        for my $i (1..$#fArray) {
            $fArray[$newIndex][$i] = $fArray[$i][$newIndex] = '_';
        }

        ## Set the intersection cell value to 0
        $fArray[$newIndex][$newIndex] = 0;
    }
} 
```

我对我处理参考资料的方式并不感到太自豪，但在这里容忍初学者（请在评论中留下您的建议/更改）。上面提到的 Chris 的哈希方法听起来要容易得多（更不用说打字少了很多）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T08:23:59.797

[CPAN](http://search.cpan.org)有许多[潜在有用的功能](http://cpan.uwinnipeg.ca/search?query=table&mode=dist)。我将[Data::Table](http://cpan.uwinnipeg.ca/dist/Data-Table)用于多种用途。[Data::Pivot](http://cpan.uwinnipeg.ca/dist/Data-Pivot)看起来也很有前途，但我从未使用过它。

# php - 如何在php中只打印网页的一部分

> ID：540174
> 
> 赞同：0
> 
> 时间：2009-02-12T05:32:09.897
> 
> 标签：php, ajax

我正在尝试通过单击按钮打印页面的一部分而不打开其他页面。我需要打印的页面部分是使用 ajax 调用的，所以如果有人可以帮助我，我将非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T05:42:49.047

使用 CSS 媒体打印来控制页面的打印方式，然后只需使用 window.print()。无需调用另一个页面。您可以通过这种方式隐藏部分页面（侧边菜单等）。

# clearcase - 如何缩短 clearcase 视图的加载目录？

> ID：540179
> 
> 赞同：3
> 
> 时间：2009-02-12T05:33:36.603
> 
> 标签：clearcase

在 Clearcase 中，我有一个 VOB，其路径如下：

```
\Department\ProductGroup\Product1\Development 
```

我有这样的配置规范视图：

```
element * CHECKEDOUT
element * .../mybranch/LATEST
element * /main/LATEST -mkbranch mybranch
load \Department\ProductGroup\Product1 
```

Product1 的所有源代码都在 Development 目录中。在这个目录之外没有我关心的东西。代码中的所有引用都与此目录相关。

我在目录 c:\dev 中创建了上面的 Clearcase 视图

目前，上述设置创建了一个目录：

```
c:\dev\Department\ProductGroup\Product1\Development 
```

所有的父目录`Development`都是空的。我宁愿只有以下目录。

```
c:\dev\Product1 
```

映射`c:\dev\Product1`到 VOB 路径的位置`\Department\ProductGroup\Product1\Development`。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T06:39:49.003

1/ 为什么不只加载 \Department\ProductGroup\Product1\Development ？

```
load /Department/ProductGroup/Product1/Development 
```

注意：您可以使用 ' `/`'，比 ' `\`' 更容易，并且 Windows 配置规范确实可以正确解释它。

1之二/如果你想保持一般规则，你可以使用一些“**清洁规则**”

考虑这个配置规范
（**首先在动态视图中对其进行测试**，以便快速检查——即没有无休止的更新重新加载步骤——如果结果确实符合您的需要：文件在下面`Development`，其他任何地方都没有文件）

```
element * CHECKEDOUT

# read/write selection rule for the directory and sub-directory
# where you need to work
element /Department/ProductGroup/Development/... .../mybranch/LATEST
element /Department/ProductGroup/Development/... /main/LATEST -mkbranch mybranch

# specific selection rule for the parent directories of Development
# those rules do not contain a mkbranch directive
element /Department/ProductGroup  .../mybranch/LATEST
element /Department/ProductGroup /main/LATEST
element /Department  .../mybranch/LATEST
element /Department /main/LATEST

# cleaning rule right there: anything outside /Department/ProductGroup/Development
# will not be selected, hence not loaded
element /Department/* -none

load \Department 
```

这样，您始终保持相同的加载规则`load \Department`，并且您的选择规则为您进行清理。

2/关于您的路径问题，您可以使用 Symlink，但最简单的方法是使用**subst**

```
subst X: c:\dev\Department\ProductGroup\Product1\Development 
```

您可以继续在 X:\ 中使用您的快照视图

但这不起作用，因为 ClearCase 需要：

*   view.dat（表示目录树的隐藏文件实际上是快照视图）
*   一个 vob （`Department`在你的情况下。`ProductGroup\Product1\Development`是 Vob 中的一条路径`Department`）

    X:>ct lsview -l -full -pro -cview cleartool：错误：无法获取当前视图的视图信息：不是 ClearCase 对象。X:>ct ls cleartool：错误：路径名不在 VOB 中：“。”

出于同样的原因，在 windows 上**使用[Junction](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)的硬链接将不起作用**：

```
c:\dev>junction Product1 Department\ProductGroup\Product1
Junction v1.05 - Windows junction creator and reparse point viewer
Copyright (C) 2000-2007 Mark Russinovich
Systems Internals - http://www.sysinternals.com

Created: C:\dev\Product1
Targetted at: C:\dev\Department\ProductGroup\Product1

C:\cc\xxx>ct ls
cleartool: Error: Pathname is not within a VOB: "." 
```

所以你可以做的是：

```
subst X: c:\dev 
```

结合 1/ 中的特定加载规则或 1bis/ 中的清洁规则将为您提供：

*   稍短的路径
*   没有额外的空子目录

* * *

2bis/“迂回”解决方案：

从 ClearCase 资源管理器中，`Development`从移动`Department\ProductGroup\Product1`到`Department`! 该动作将记录在 ' `mybranch`' 版本树中，并且对于在`/main/LATEST`.

然后`subst`从上面，你将在 'mybranch' 中工作`Department\Development`。

```
X:\Department\Development 
```

当你想上市时，采取相反的行动。

# streaming - RDP/终端服务和 VNC 流技术之间的区别

> ID：540188
> 
> 赞同：7
> 
> 时间：2009-02-12T05:35:58.483
> 
> 标签：streaming, remote-desktop, remote-access, vnc

作为客户端支持工具的一部分，我想提供一些功能来请求查看/远程控制桌面会话。有很多方法可以获取屏幕截图然后流式传输，但我特别想了解为什么 RDP（远程桌面/终端服务与 VNC 体验如此不同。我使用的是 RDP vs . VNC 只是因为它们似乎使用截然不同的方法将屏幕流式传输到客户端。

如果我不得不猜测，RDP 似乎传输位图图形块（例如 100x100 像素）以构建完整图片（这可能很慢），但似乎将正常的绘制形状/填充或字体绘制传输到客户端非常快. VNC 似乎会拍摄屏幕的巨大快照，比较之前的图像并将更改流式传输到客户端。

我觉得 RDP 是一种比其他任何协议都更高质量和更流畅的协议，那么它使用什么技术来实现这一点？

编辑——澄清一下，我是在询问这些图形技术，特别是作为一种流协议编程方法——而不是使用哪种现有产品/技术来解决这个业务需求。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-12T06:01:54.273

正如您所发现的，它们在流变化的方式上都有很大的不同。MS 的 RDP 协议是可在线购买的[ITU 标准 (T.128)的扩展。](http://www.itu.int/rec/T-REC-T.128-200806-P/en)

RDP 实现了许多相辅相成的带宽节省技术，使其在低带宽上非常高效。

另一方面，VNC 具有非常基本的压缩技术：它将发送已更改的位图块，并将使用基本类型的压缩，从 RLE 到 jpeg 以有效地传输这些块。
不幸的是，在低带宽上它仍然相当浪费。

VNC 基本上不知道用于构建屏幕的底层图形基元。这使得它在任何机器上都易于使用，因为它只监视屏幕位图的变化。
另一方面，RDP 更深入地连接到 Windows API，并且能够根据在客户端上生成相同更新所需的最少信息量来优化其流。

如果你想集成远程桌面功能，你有几个选择：

*   对于 RDP，您可以使用用于 Web 远程功能的 ActiveX。您可能想查看一个[包装器](http://www.codeplex.com/RDPWrapper)以将其集成到您自己的软件中。
    如果您想更深入地了解这一点，可以使用 linux [rdesktop](http://www.rdesktop.org/)客户端的源代码，该客户端确实通过 RDP 连接到 Windows 机器。

*   对于 VNC，有许多开源实现。
    FogCreek 的 Copilot 实际上使用了一个，您可以获取它的[源代码](https://www.copilot.com/tech/)，因为它是基于[TightVNC构建的](http://www.tightvnc.com/)

在 RDP和[VNC上的](http://www.codeproject.com/info/search.aspx?artkw=vnc)[CodeProject 上](http://www.codeproject.com/info/search.aspx?artkw=rdp)也有许多项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-22T20:42:17.053

正如 Renaud 所说，VNC 只是逐块发送位图更改，而不知道内容是什么。RDP 更智能。

您可以从这两个规范中准确了解 RDP 的作用：

协议级别： http: [//msdn.microsoft.com/en-us/library/cc240445 (PROT.10).aspx](http://msdn.microsoft.com/en-us/library/cc240445(PROT.10).aspx)

图形级别： http: [//msdn.microsoft.com/en-us/library/cc241537 (PROT.10).aspx](http://msdn.microsoft.com/en-us/library/cc241537(PROT.10).aspx)

我认为RDP最大的收获来自：

*   缓存：客户端可以存储大量以前看到的块，服务器可以告诉客户端如何使用它们。这些也是持久的，因此当客户端连接到它已经访问过的服务器时，它可以通告它在磁盘上的块。移动窗户时非常有用。窗口的许多部分，如标题栏也是相同的。

*   线/块图。正如你所猜测的那样，RDP 具有线条、多边形和矩形绘图的操作。有了绘图窗口，这些就被大量使用了。

*   字体绘图。RDP 有一种方法可以通过字形发送字体并告诉客户端渲染它们。

*   光标渲染。光标图标作为字形发送。VNC 只是使用一个点

这些是浮现在脑海中的大问题。查看协议规范的第 2.2.7 节功能集以获取绘图功能的完整列表。

# javascript - 使用 JavaScript 从 iframe 获取内部 HTML

> ID：540189
> 
> 赞同：0
> 
> 时间：2009-02-12T05:36:37.377
> 
> 标签：javascript

嗨朋友们，我开发了一个项目，我想以表格的形式显示来自网站的数据。所以我可以在子窗口 iframe 中执行该过程并将表格内容从子窗口获取到父窗口。一切正常，但这将适用于除 ie 之外的所有浏览器。它不会显示任何错误，一位朋友给出了答案（[http://roneiv.wordpress.com/2008/01/18/get-the-content-of-an-iframe-in-javascript-crossbrowser-solution-for -both-ie-and-firefox/](http://roneiv.wordpress.com/2008/01/18/get-the-content-of-an-iframe-in-javascript-crossbrowser-solution-for-both-ie-and-firefox/) ）但它显示错误“访问被拒绝”，请帮助我..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T05:43:34.223

这是因为您在 iframe 中引用的站点位于另一个域中。在您回复的[原始帖子](https://stackoverflow.com/questions/540077/javascript/540115#540115)中，我误解并认为您说他们在同一个域上。引用另一个论坛：“由于 i-frame 来自不同的网站，您无法读取 i-frame 的任何内部属性。” [[http://www.experts-exchange.com/Software/Server_Software/Application_Servers/Java/Apache_Tomcat/Q_22843851.html](http://www.experts-exchange.com/Software/Server_Software/Application_Servers/Java/Apache_Tomcat/Q_22843851.html) ]

我不知道你在做什么甚至是可能的，但如果是的话，我相信这里有人可以提供帮助。

# http - 如何在jsp中获取上下文目录的路径以及如何为每个新请求覆盖它

> ID：540195
> 
> 赞同：0
> 
> 时间：2009-02-12T05:40:23.480
> 
> 标签：http, jsp

嗨，我正在使用..获取本地系统中上下文目录的路径

```
String myfile = application.getRealPath("/"); 
```

但是当应用程序部署在 www.eatj.com 的 war 文件中时，getRealPath("/") 方法返回 null .. 谁能给我提供可能的解决方案和示例代码...目的是我必须创建一个 xml文件在我的上下文目录中......每个请求我都必须覆盖这个xml文件......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T05:47:20.097

这就是 Javadoc 所说的

返回包含给定虚拟路径的真实路径的字符串。例如，路径“/index.html”返回服务器文件系统上的绝对文件路径，将由对“ [http://host/contextPath/index.html](http://host/contextPath/index.html) ”的请求提供服务，其中 contextPath 是此 ServletContext 的上下文路径..

返回的真实路径将采用适合运行 servlet 容器的计算机和操作系统的格式，包括正确的路径分隔符。如果 servlet 容器由于任何原因（例如当内容从 .war 存档中可用时）无法将虚拟路径转换为真实路径，则此方法返回 null。

# rebol - 如何访问 REBOL 标头？

> ID：540197
> 
> 赞同：2
> 
> 时间：2009-02-12T05:41:25.320
> 
> 标签：rebol

假设我在另一个文件 ( `imported.r`) 中有一个 REBOL 脚本，如下所示：

```
雷博尔 [
    作者：{格雷格}
    标题：{很棒的 REBOL 代码}
]
×：3

```

如何将此文件导入另一个脚本并访问 REBOL 标头的内容？我知道，`load/header`但我似乎无能为力。

`imported: context load/header %imported.r`

我现在该怎么做才能访问`imported.r`as的标头`object!`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T07:19:31.597

LOAD/HEADER 为您提供了一段代码，正如您可以通过 PROBEing 它返回的内容看到的那样。它包含用于构建标头对象的未评估源，然后是脚本的其余部分。

做一个对象！从该标头代码中，一种方法是

```
>> set [header script] do/next load/header %imported.r
>> header/title 
== "Some script title" 
```

或者，如果您只需要标头对象，只需

```
>> header: first do/next load/header %imported.r
>> header/title 
== "Some script title" 
```

这使您可以通过 HEADER 和 SCRIPT 块中的脚本代码访问对象，因为 DO/NEXT 仅评估第一个表达式并返回表达式的结果以及该评估后代码块中的位置。

# asp.net - 最好的 DotNetNuke url 重写方法？

> ID：540201
> 
> 赞同：5
> 
> 时间：2009-02-12T05:43:23.193
> 
> 标签：asp.net, dotnetnuke

我想为 DotNetNuke 实现一个 URL 重写器。对这是否是一种好的或可能的方法以及其他开发人员可能有的任何建议有疑问。

我可以从“页面”->“添加页面”部分为 URL 重写器添加动态或静态路由吗？

假设我正在“活动”菜单项下创建一个名为“事件”的页面。

我可以在 DotNetNuke 中编写一些自定义代码吗会建议“site.com/Activities/Event-Calendar”吗？

我想要任何关于我将如何完成此任务的反馈或建议！谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T16:58:25.800

如果您使用的是 DotNetNuke 4.8 或更高版本，您只需通过 Web.Config 启用 Human Friendly Urls。

要启用人类友好的 url，请替换：

```
<add name="DNNFriendlyUrl" type="DotNetNuke.Services.Url.FriendlyUrl.DNNFriendlyUrlProvider, DotNetNuke.HttpModules" includePageName="true" regexMatch="[^a-zA-Z0-9 _-]" /> 
```

和：

```
<add name="DNNFriendlyUrl" type="DotNetNuke.Services.Url.FriendlyUrl.DNNFriendlyUrlProvider, DotNetNuke.HttpModules" includePageName="true" regexMatch="[^a-zA-Z0-9 _-]" urlFormat="HumanFriendly" /> 
```

更新：对于 DNN 7.x 及更高版本，现在应该是：

```
<add name="DNNFriendlyUrl" type="DotNetNuke.Services.Url.FriendlyUrl.DNNFriendlyUrlProvider, DotNetNuke.HttpModules" includePageName="true" regexMatch="[^a-zA-Z0-9 _-]" urlFormat="advanced" /> 
```

附加细节：[在 DotNetNuke 中启用人性化 URL](http://www.efficionconsulting.com/Blog/tabid/594/ctl/Details/mid/1500/ItemID/563/Default.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T05:53:45.260

看看这个 - 细节在这里：

[http://www.ifinity.com.au/Blog/Technical_Blog/EntryId/19/Rewriting-the-DotNetNuke-Url-Rewriter-Module/](http://www.ifinity.com.au/Blog/Technical_Blog/EntryId/19/Rewriting-the-DotNetNuke-Url-Rewriter-Module/)

此外，请查看 DNN 中已包含的现有 FriendlyUrl 模块。

如果您想在股票页面上执行此操作，您需要打开它的源代码，或者编写一个独立执行此操作的模块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-14T06:45:56.290

要直接回答您的问题：是的，您可以在 DNN 页面设置页面中添加一些代码。但是，您将修改核心代码，因此在下一个 DNN 版本发布时将无法轻松升级您的安装。

很多人来到 DNN 并想写一个新的 Url Rewriter。问题不在于重写：它让 DNN 框架在您想要的位置生成正确的 url - 在菜单中，在模块内生成的链接中。要真正改变重写方案，您需要替换/增加 Url Rewriting 功能，友好的 url 生成功能，并提供某种重定向功能，以便将新旧 Url 联系在一起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T12:47:52.790

如果您不想编写自己的代码，另一个建议是[Page Blaster 。](http://www.snapsis.com/DotNetNuke-Performance-Caching-Compression-Optimization.aspx)适用于我使用它的网站。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-15T04:51:40.017

其中有几个是很好的回复......如果您现在（2016 年及以上）刚刚学习 DNN，最重要的事情之一是 URL 重写领域随着时间的推移在 DNN 中发生了变化。

之前，在 DNN 4.8 及更低版本中，您必须使用外部模块/提供程序，例如：PageBlaster 或 DNN Masters SEO URL REWriter 或 iFinity URL REWriter 所有这些都在上面的一些答案中提到。

但是，在 DNN 4.9 之后，iFinity URL ReWriter 被合并到 DNN 核心中，您会发现它在 DNN 5、6、7 和 8 中以不同的界面暴露程度提供。您仍然需要在 web.config 中进行一些更新，但其中大部分现在是直接在页面设置中完成的。

任何不在主管理器中的设置，您可以在 web.config 或数据库中进行，或者您可以寻找一个 DNN 模块，例如 X3 DNN URL Management，它利用集成 DNN url 的数据库记录重写器并帮助管理设置（它与旧的 iFinity 界面屏幕/选项非常相似）但您不需要它，您可以直接工作，它只是有帮助。

# svn - 图形代码分析

> ID：540211
> 
> 赞同：2
> 
> 时间：2009-02-12T05:49:57.983
> 
> 标签：svn, hudson, visualization, code-analysis

我将 SubVersion 与 Hudson 结合使用，我喜欢显示单元测试、构建时间、磁盘使用量如何随时间增长的功能。我相信代码指标可以对代码库进行初步评估 - 在从新客户开始时特别有用。是否有任何工具可以执行以下操作

1）从日期/标签开始获取源代码的每个修订版

2）构建它

3) 运行代码分析

4) 运行测试

5）存储详细结果（在某种Sql数据库中）

6) 重复直到不再修改

7) 整理并呈现结果

您可以看到 hudson 本身的[摘要输出](http://fisheye4.atlassian.com/browse/hudson)，但这并不能说明单个文件，以及它们如何随时间变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T05:57:31.180

看看声纳[https://www.sonarqube.org/](https://www.sonarqube.org/)。我已经在我的 Java 项目中使用了 maven。它报告了您正在寻找的大部分功能。

# c# - 如何在防火墙后面设置安全的 WCF 服务？

> ID：540215
> 
> 赞同：3
> 
> 时间：2009-02-12T05:52:59.270
> 
> 标签：c#, web-services, iis, wcf

我有一个位于企业级防火墙后面的 WCF 服务，它同时进行主机名和端口转换，例如：

[https://ws.address.com/Service.svc](https://ws.address.com/Service.svc) --> [https://serv.internal.com:44000/Service.svc](https://serv.internal.com:44000/Service.svc)

该服务受 SSL-128 保护，需要客户端证书。

因为无法从防火墙外部访问内部服务器名称，所以我们必须实现一个 ServiceHostFactory 来转换 WCF 生成的 WSDL 和 XSD 导入引用：

```
public class MyCustomFactory : ServiceHostFactory
    {
        protected override ServiceHost CreateServiceHost(
            Type serviceType, Uri[] baseAddresses)
        {
            MyCustomHost customServiceHost = 
                new MyCustomHost(serviceType, baseAddresses);

            return customServiceHost;
        }

        class MyCustomHost : ServiceHost
        {
            public MyCustomHost(Type serviceType, 
                params Uri[] baseAddresses)
                : base(serviceType, 
                    GetBaseAddresses(serviceType, baseAddresses))
            {                
            }

            protected override void ApplyConfiguration()
            {
                base.ApplyConfiguration();
            }

            private static Uri[] GetBaseAddresses(
                Type serviceType, params Uri[] baseAddresses)
            {
                UriBuilder newBaseAddress = new UriBuilder();
                newBaseAddress.Path = "/" + serviceType.ToString() + 
                    ".svc";

                // from config
                newBaseAddress.Host = 
                    MyCustomSettings.ServiceBaseAddress; 

                if (baseAddresses.Length > 0)
                {
                    newBaseAddress.Scheme = baseAddresses[0].Scheme;
                }

                return new Uri[] { newBaseAddress.Uri };
            }
        }
    } 
```

这就是问题所在：除非服务托管在默认 SSL 端口 443 上的内部机器上，否则我们会收到错误：

***没有协议绑定与给定地址“ [https://ws.address.com/Service.svc](https://ws.address.com/Service.svc) ”匹配。协议绑定在 IIS 或 WAS 配置中的站点级别进行配置。***

从修补来看，如果我们将内部服务器更改为在 443 上托管服务，或者将防火墙配置为从 44000 转发到 44000，一切正常。但是，这些不是我们生产环境中的选项。

***编辑：***忘了提，我们尝试使用 IWsdlExportExtension 来展平 WSDL，但这会导致 svcutil 或 VS2008 中的代理代码生成出现严重问题，因此我们放弃了这个想法。

有谁知道解决这个问题的任何方法？我要拔头发了！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T06:08:56.190

您可能需要显式创建自己的绑定（即ServiceModel.WSHttpBinding）并使用该绑定添加服务端点（.AddServiceEndpoint(..) ）。

[http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.addserviceendpoint(VS.85).aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.addserviceendpoint(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T01:17:07.673

您不应该更改工厂的基址。而是编写一个扩展来修改 WSDL。这将是“IWsdlExportExtension”，您想覆盖 ExportEndpoint 以修改端点地址。这将使您的服务侦听正确的基地址。

或者

如果您不想开始使用 WSDL 扩展...将您现有的代码移动到“CreateServiceHost”方法中并刮擦您的自定义主机！这不是很好，但应该可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T22:29:54.270

我的猜测是，在 IIS 中托管服务的站点的站点绑定配置为仅侦听主机名**serv.internal.com**而不是外部名称**ws.address.com**。

如果 IIS 站点绑定配置了主机名，则会根据所有传入 URL 检查该主机名。该绑定只能处理具有匹配主机名的 URL。

防火墙会将请求重定向到内部服务器，但不会更改传入的 URL 字符串...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-04T20:04:00.217

您是否尝试过将 ip 端口放在地址中（从问题来看，它看起来不像每次都使用）：

```
https://ws.address.com:44000/Service.svc 
```

另一件事可能是 WCF 在该端口上侦听 https 流量，请参阅：

[http://msdn.microsoft.com/en-us/library/ms733768.aspx](http://msdn.microsoft.com/en-us/library/ms733768.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-02T16:33:24.863

你没有提到你的主人。IIS/WAS？如果是这样，您可能需要将外部主机名添加到 IIS 配置到安全绑定列表中。

[这是有关更改 IIS 托管服务中的主机名的一些信息](http://blogs.msdn.com/wenlong/archive/2007/08/02/how-to-change-hostname-in-wsdl-of-an-iis-hosted-service.aspx)

这是命令行：

```
cscript //nologo %systemdrive%\inetpub\adminscripts\adsutil.vbs 
set W3SVC/1/SecureBindings  "10.(internal addr).1:443:ws.address.com"
"127.0.0.1:443:Internal Host name" 
```

如果这不能解决问题，我会选择“routeNpingme”并建议您只需要使用指定您的 https 端口和名称的绑定来正确指定端点。我认为您可以使用现有的绑定选项来做到这一点......但您可能需要创建一个自定义。

# assembly - SPARC - 无移位的位掩码

> ID：540226
> 
> 赞同：2
> 
> 时间：2009-02-12T06:00:13.200
> 
> 标签：assembly, bit-manipulation, sparc

我正在学习 SPARC 汇编，我必须创建一个从寄存器中提取字段的脚本。该脚本接受 3 个值，初始编号、字段起始位置、字段长度。
它不能使用任何移位函数，但可以使用乘法和除法。
我目前患有呼吸道病毒，随后服用了大量药物。我很难弄清楚从哪里开始。一些方向将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T06:01:53.897

乘以 2 是左移，除以 2 是右移（至少对于无符号数）。

如果你想左移 2 位，那就是乘以 4。

因此，例如，如果您有二进制值：

```
b15              b0
v                 V
0000 1111 0101 1000 
```

如果你想提取 b3 和 b2，你会用 0xc0 和整个地段除以 4。

```
0000 1111 0101 1000
0000 0000 0000 1100  <- AND with 0xc0
-------------------
0000 0000 0000 1000
-------------------
0000 0000 0000 0010  <- divide by 4 
```

**由于这听起来有点像家庭作业（而且我已经很长时间**没有为 SPARC 编写代码了），所以我不会尝试给你一个完整的解决方案——这应该足以让你继续前进。

# .net - WPF、Silverlight 或 XNA：选择游戏开发平台

> ID：540227
> 
> 赞同：6
> 
> 时间：2009-02-12T06:00:21.780
> 
> 标签：.net, wpf, silverlight, xna

哪种 .Net 技术最适合哪种游戏？在 WPF、Silverlight 或 XNA 之间进行选择的标准是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-12T07:39:04.570

真的，您是在将苹果与茶几与特百惠进行比较……

WPF 并不是严格意义上的游戏相关技术。由于它处理数据绑定的方式以及 UI 层与逻辑层的分离，它可能适用于您正在寻找富客户端的任何地方，但您希望能够轻松地更改演示文稿，也许因为你希望游戏可以换肤。除此之外，您并没有真正从 WPF 作为一项技术中获得太多收益。如果您在 Windows 平台上假设某些东西，这是一种基准。

使用 Silverlight，您可以在多个平台上获得基于浏览器的交付。这就是大抽奖。比您通常在浏览器中拥有的更多功能，但肯定不是您作为常规客户端应用程序所拥有的。比您通常在浏览器中拥有的更多艺术自由，但又不像您在客户端应用程序中拥有的那样多。如果您以前尝试过基于网络的游戏，那么这是一个很大的进步。如果您习惯于基于桌面的东西，访问多个客户端可能会让您感兴趣，但除此之外，它在性能和原始功能方面是一个很大的下降。

XNA 是一种游戏技术。不仅仅是您可以访问 Xbox（和 Zune！）作为一个平台；整个基础设施都是围绕制作游戏而构建的。它为您提供了对着色器、计时器、碰撞检测、位置音频等内容的内置支持，以及您通常必须自己编写的大量内容，无论您的游戏是 2d 还是 3d。基础项目甚至为您创建了一个基本的游戏循环。它在它支持的平台中非常具体，并且支持它们**进行游戏**. 确实，如果构建游戏是您想做的事情的核心，并且您仍在学习这个过程，那么这是一个很好的起点。假设您不需要您提到的其他技术所具有的特定优势，我会说 XNA 可能是您的最佳选择，无论您计划构建哪种游戏。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-12T06:10:20.633

如果您需要速度，即第一人称射击游戏，请选择 XNA，如果您想为 XBox 和 Windows 编写代码，请选择 XNA。

如果您想为网络写作，请使用 silverlight。

如果您想要桌面策略（国际象棋、纸牌等），请使用 WPF。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T21:23:15.217

嗯，我在一个在 XNA 中开始游戏的团队中。菜单、选项屏幕（我们有很多）、输入框、按钮、高分、流式的基本布局、图表之类的东西在 XNA 中是相当痛苦的——这需要你几个月的时间花费在基本的游戏功能上。

所以我们打算做一个融合：Easy WPF 的东西用 WPF 编码，XNA 方便的东西用 XNA 编码。

或者让我们讲述魔兽世界的 HUD - 在 XNA 中需要几个月的时间，但在 WPF 中只需要几天......

出于这个原因，有很多声音想要融合这两种技术。两者都依赖于directX - 但据我所知，不可能以简单而高效的方式融合它们。

看看这个： [http ://forums.xna.com/forums/p/1122/6527.aspx](http://forums.xna.com/forums/p/1122/6527.aspx) [http://social.msdn.microsoft.com/Forums/en-US/xnaframework/thread/0562aab0-029a-4aed -a59a-8b94b1f1ca2f](http://social.msdn.microsoft.com/Forums/en-US/xnaframework/thread/0562aab0-029a-4aed-a59a-8b94b1f1ca2f) [http://jmorrill.hjtcentral.com/Home/tabid/428/EntryId/259/XNA-Meet-WPF.aspx](http://jmorrill.hjtcentral.com/Home/tabid/428/EntryId/259/XNA-Meet-WPF.aspx) [http://forums.xna.com/forums/p/29421/165307.aspx](http://forums.xna.com/forums/p/29421/165307.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T06:58:51.003

我想这可能会引发更大的问题；
*您是要编写适合语言的游戏，还是想要适合游戏的语言？*

话虽如此，我还是会推荐 XNA 来继续第二个 Raumornie。

我刚刚开始走这条路，并在网上找到了大量可用于 XNA 的信息。点击 XNA Creators Club ( [http://creators.xna.com](http://creators.xna.com) ) 并下载所有看起来有点有趣的东西。有大量很棒的代码示例和迷你游戏可供使用。

其他方便的链接；
[http://innovativegames.net/blog/xna-game-engine-tutorial-series/](http://innovativegames.net/blog/xna-game-engine-tutorial-series/)
[http://www.thehazymind.com/category/xna/](http://www.thehazymind.com/category/xna/)
[http://www.ziggyware.com/](http://www.ziggyware.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T21:56:44.390

假设您要坚持使用 2D 游戏，您总是可以针对所有平台 :-D

对于 Windows、XBox 和 Zune（您没有在列表中提及），请使用[XNA](http://creators.xna.com)。

对于 Windows、Mac 和 Linux，通过浏览器获取您的 XNA 游戏并使用[SilverSprite](http://silversprite.codeplex.com)在 Silverlight 中运行它。然后，您可以在 xbox live 上发布您的游戏，然后将相同的游戏发布到[SilverArcade](http://silverarcade.com)上。

# perl - 如何进行简单的 Perl 哈希等价比较？

> ID：540229
> 
> 赞同：8
> 
> 时间：2009-02-12T06:01:07.113
> 
> 标签：perl, hash, comparison

我想知道是否有一个惯用的单行或标准分发包/函数可以用来比较两个 Perl 哈希与仅内置的非祝福类型。哈希值不相同（它们没有等效的内存地址）。

我想知道浅散列和嵌套集合散列的答案，但我知道浅散列可能有一个更简单的解决方案。

蒂亚！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-12T06:09:26.657

类似 cmp_deeply 的东西在[Test::Deep](https://metacpan.org/module/Test::Deep)中可用吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T06:40:31.123

[这是对删除答案的人的回答的回应。]

哦哦！

```
%a ~~ %b && [sort values %a] ~~ [sort values %b] 
```

不检查值是否属于相同的键。

```
#! perl
use warnings;
use strict;

my %a = (eat => "banana", say => "whu whu"); # monkey
my %b = (eat => "whu whu", say => "banana"); # gorilla
print "Magilla Gorilla is always right\n" 
    if %a ~~ %b && [sort values %a] ~~ [sort values %b]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T06:13:58.517

我不知道是否有一个简单的方法或一个内置的包，我不知道当你这样做时会发生什么`%hash1 == %hash2`（但可能不是这样），但推出你自己的并不难：

```
sub hash_comp (\%\%) {
  my %hash1 = %{ shift };
  my %hash2 = %{ shift };
  foreach (keys %hash1) {
    return 1 unless defined $hash2{$_} and $hash1{$_} == $hash2{$_};
    delete $hash1{$_};
    delete $hash2{$_};
  }
  return 1 if keys $hash2;
  return 0;
} 
```

未经测试，但如果哈希具有所有相同的元素和所有相同的值，则应返回 0。必须修改此函数以考虑多维散列。

如果你想从标准分布中得到一些东西，你可以`use Data::Dumper;`并且只是将两个散列转储到两个标量变量中，然后比较字符串是否相等。那可能行得通。

CPAN 上还有一个名为的软件包`FreezeThaw`，看起来它可以满足您的需求。

请注意，要使用智能匹配（这里不再重复，因为它已经发布了），您必须这样做`use feature;`并且它仅适用于 Perl 5.10。但是谁还在使用 Perl 5.8.8，对吧？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-10T14:51:00.110

谢谢你的问题。

我使用了 Test::More::eq_hash 作为结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T21:23:27.193

对于浅散列：

```
(grep {exists %hash2{$_}} keys %hash1) > 0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-14T20:28:36.563

可以将散列转换为数组，其中每个值都遵循其键（但您不会知道键的顺序）。所以：

```
( join("",sort(%hash1)) eq join("",sort(%hash2)) ) 
```

哦，等等，这行不通，因为有一些边缘情况，比如：

```
%hash1 = { 'aaa' => 'aa'  };
%hash2 = { 'aa'  => 'aaa' }; 
```

所以最好在 join() 中使用一个你知道永远不会出现在任何键或值中的字符。如果值是 BLOB，那将是一个大问题，但对于其他任何内容，您都可以使用 NULL 字符“\0”。

```
( join("\0",sort(%hash1)) eq join("\0",sort(%hash2)) ) 
```

看起来有点丑，我知道，但它可以用于检查两个哈希是否相等，这是大多数人正在寻找的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-18T10:42:43.333

您可以在[Test::Deep::NoTest中使用](https://metacpan.org/pod/Test::Deep::NoTest)[eq_deeply](https://metacpan.org/pod/Test::Deep#ok-eq_deeply-got-expected)。它只返回一个您可以检查的布尔值，而没有[主模块](https://metacpan.org/pod/Test::Deep)测试功能的额外开销。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-05-27T00:10:45.193

将哈希转换为 xml 文件并进行比较，是的，您可以使用多级。

```
sub isEqualHash 
{
    my ($self,$hash1, $hash2) = @_;
    my  $file1 = "c:/neo-file1.txt";
    my  $file2 = "c:/neo-file2.txt";
    my $xmlObj = XML::Simple->new();
    my $dummy_file = $xmlObj->XMLout($hash1,OutputFile => $file1);
    my $dummy_file = $xmlObj->XMLout($hash2,OutputFile => $file2);

    open FILE, "<".$file1;
    my $file_contents1 = do { local $/; <FILE> };
    close(FILE);

    open FILE, "<".$file2;
    my $file_contents2 = do { local $/; <FILE> };
    close(FILE);

    if($file_contents1 eq $file_contents2)
    {
        return "Passed";
    }
    else
    {
        return "Failed";
    }
} 
```

# authentication - 如何设置一次性密码验证？

> ID：540232
> 
> 赞同：0
> 
> 时间：2009-02-12T06:01:56.440
> 
> 标签：authentication, one-time-password

我有一个家庭网络，我可以远程访问很多。但我担心安全问题。虽然我确实有强密码，但我担心有人会获取我的密码并使用它来获得访问权限。

我听说过“一次性密码”，甚至在我的大学里使用过它们。我们只需按下设备上的一个按钮（或在手机上运行应用程序）并获得一个生成的密码，该密码可以在接下来的一分钟左右使用。

*   我怎样才能设置这样的东西？
*   是否有易于使用和设置的系统？
*   有没有人玩过这些系统之一的 SDK？
*   我可以从哪里获得入门套件？

**编辑**：我正在运行一个混合的 Linux 和 Windows 网络，我隐约希望使用它在两个操作系统上进行身份验证。（不，没有域控制器，但我想我可以使用 Samba 设置一个。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T18:34:13.997

S/Key 适用于低成本的 OTP 实施。但是，如果您真的对此感到担心，那么还要担心您的会话在启动后被劫持。在这种情况下，您可能会考虑使用 SSH 隧道来加密您的流量。设置访问权限后，SSH 还可以更好地通过它为其他应用程序建立隧道。最后，如果您没有携带 SSH 客户端的简单方法（或者不信任其他人的 SSH 客户端），您可以从自己的服务器上提供一些基于 Web 的 SSH 客户端——所以它在您的控制之下，但可以从任何浏览器中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T06:25:03.297

在 Linux 上，它被称为 S/Key：[这里](http://www.fatsquirrel.org/veghead/wot/skey.php)

不是按钮小玩意，而是您将其播种并打印出一次性密码列表以随身携带。要使其与混合环境一起工作，您需要让它在您的 Windows 机器上运行，然后让 Linux 机器从中进行身份验证，或者（更容易）让它在 Linux 上运行，然后将其链接到 Samba，以便 Windows 可以对其进行身份验证。

谷歌是你的朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T06:11:41.863

一种方法可能如下：-

您需要制作一个程序，该程序将生成一个密码，该密码仅在特定时间范围内被您的家庭系统接受。

例如。当您运行程序时，输出将在特定时间段内有效，并且将被您的家庭安全系统接受，因为系统也会在匹配哈希时生成相同的输出，诀窍是在两个地方获得相同的哈希.

我想这需要更多的头脑风暴！！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T06:32:52.293

作为 renegadeMind 帖子的附录，一种方法是在两端都有一个程序来生成随机数序列。伪随机数生成器 (PRNG) 的一个特性是，如果您使用相同的种子启动它们，它们将继续生成相同的随机数序列。因此，根据您的经验（或技术的可用性），您可以将网络设置为每 x 分钟生成一个新密码。然后，您可以随身携带一个可以在手机或其他嵌入式硬件上运行的软件，该软件可以计算 PRNG 执行顺序中的哪一步，然后为您列出当前密码。

话虽如此，您系统的安全性将仅限于您选择的种子以及您选择每个密钥有效的时间。

除此之外，可能还有一个软件解决方案可以为您做到这一点。恕我直言，最好采用现有的实现，然后重新发明轮子。

编辑：维基百科在[这里](http://en.wikipedia.org/wiki/One_time_password)有一篇好文章。关于特定 OTP 技术的部分可能是最相关的。

不过祝你好运！

[关于 PRNG 的维基文章](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-22T15:08:51.970

您需要决定的第一件事是将哪种身份验证协议作为您的标准。我推荐 Radius，尤其是对于企业中的两因素身份验证。Radius 得到所有主要 VPN 和网络提供商以及所有主要 2FA 提供商的支持。

然后，考虑您要保护的服务。对于 linux，这通常意味着 PAM。幸运的是，通过 pam 向 linux 添加 2FA 非常轻松： http: [//www.wikidsystems.com/support/wikid-support-center/how-to/pam-radius-how-to/](http://www.wikidsystems.com/support/wikid-support-center/how-to/pam-radius-how-to/)。对于 Windows 服务，您需要通过 ISA 或 VPN 路由它们。

您可以使用 MS radius 插件 IAS/NPS 配置所有半径请求以通过 AD。 [http://www.networkworld.com/news/2010/050710-two-factor-authentication-through-windows-server.html?source=nww_rss](http://www.networkworld.com/news/2010/050710-two-factor-authentication-through-windows-server.html?source=nww_rss)

最后，在选择 2FA 解决方案时，只需确保它们支持 radius。

至于 SDK，这是每个供应商的情况。这是我们的链接：http: [//www.wikidsystems.com/downloads/network-clients](http://www.wikidsystems.com/downloads/network-clients)

hth，尼克

# c# - 使用 Rhino.Mocks 模拟静态方法

> ID：540239
> 
> 赞同：46
> 
> 时间：2009-02-12T06:07:47.613
> 
> 标签：c#, tdd, mocking, rhino-mocks

是否可以使用 Rhino.Mocks 模拟静态方法？如果 Rhino 不支持这一点，是否有模式或其他东西可以让我完成同样的事情？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-04T14:30:07.920

> 是否可以使用 Rhino.Mocks 模拟静态方法

不，这是不可能的。

TypeMock 可以做到这一点，因为它利用 CLR 分析器来拦截和重定向调用。

RhinoMocks、NMock 和 Moq 无法做到这一点，因为这些库更简单；他们不使用 CLR 分析器 API。它们更简单，因为它们使用代理来拦截虚拟成员和接口调用。这种简单性的缺点是它们不能模拟某些东西，例如静态方法、静态属性、密封类或非虚拟实例方法。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-12T06:10:06.047

将静态方法调用包装在另一个类的虚拟实例方法中，然后将其模拟出来。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-12-24T21:14:28.793

如果不能使用 TypeMock 拦截方法调用，推荐使用的模式是创建一个代理，转发到您有兴趣测试的非虚拟或静态方法，然后在代理上设置期望。为了说明，考虑以下类。

```
class TypeToTest
{
    public void Method() { }
}

interface ITypeToTest
{
    void Method();
}

class TypeToTestProxy : ITypeToTest
{
    TypeToTest m_type = new TypeToTest();

    public void Method() { m_type.Method(); }
} 
```

通过创建此代理，您现在可以使用 an`ITypeToTest`代替您传递或设置`TypeToTest`实例的位置，确保默认实现在`TypeToTestProxy`转发到实际实现时使用 。然后，您可以在测试代码中创建一个模拟`ITypeToTest`并相应地设置期望。

请注意，创建这些代理可能非常乏味、容易出错且耗时。为了解决这个问题，我维护了一个库和一组工具，为您生成包含这些类型的程序集。请参阅[此页面](http://jolt.codeplex.com/wikipage?title=Jolt.Testing.CodeGeneration.Proxy&referringTitle=Jolt.Testing)了解更多信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T22:42:02.073

我所知道的唯一支持模拟静态的模拟框架是 TypeMock。

正如 Rytmis 建议的那样，您需要将静态数据包装在可以模拟的东西（即具有虚拟方法或接口的实例类）中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-11-05T03:59:09.120

这是 Rhino Mocks 最大的缺点。我不知道 Rhino Mocks 甚至有可能在没有重新概念它如何进行模拟的情况下实现这个。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-21T10:37:38.337

我一直在使用 moq 进行模拟，我认为我们不能使用它来模拟静态成员，因为 moQ 为目标（类或接口）创建了一个新代理。因此，只有可继承的成员（在类的情况下是虚拟的，在接口方面是公共的）可以被模拟。显然，静态成员不是继承的，因此存在问题。

# .net - 从 WCF 服务公开枚举的 DescriptionAttribute

> ID：540241
> 
> 赞同：2
> 
> 时间：2009-02-12T06:08:25.443
> 
> 标签：.net, wcf

如何使用 WCF 将枚举值中的描述属性从服务公开到客户端或 Web 引用或

如何使用 WCF 向客户端公开具有描述属性的枚举？虽然未公开描述属性，但仅在客户端中公开了枚举值。我想要枚举中描述属性的价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T08:16:36.647

您不能强制执行此操作 - mex/WDSL 描述符仅包含与类型关联的信息的一小部分。

如果您控制客户端，一种选择是在本地声明枚举（甚至所有类型），然后从那里消费。您应该能够使用 svcutil /reference: 开关来使用现有程序集中的类型（IDE 提供相同的功能）。但请注意，这部分违反了 SOA 的规则（即，您使用的信息比服务合同承诺的要多）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T06:43:41.397

你可以使用反射来做到这一点。获得 Enum 值后返回客户端。尝试使用 GetField() 和 GetCustomAttributes() 获取属性

```
using System;
using System.Reflection;
using System.ComponentModel;

namespace CustomAttributes
{
    class Program
    {
        static void Main(string[] args)
        {
            Colors n1 = Colors.blue;

            object [] attribues = n1.GetType().GetField(n1.ToString()).GetCustomAttributes(true);
            Console.WriteLine((attribues[0] as DescriptionAttribute).Description);
            // WOULD PRINT  "DARK BLUE"
        }
    }

    enum Colors
    {
        [Description("DARK BLUE")]
        blue,
        [Description("PLAIN WHITE")]
        white
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T06:43:49.960

查看[XmlEnum 属性](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlenumattribute.aspx)。这将允许您指定 xml 属性的“名称”。例如：

```
public enum MyEnum
{
    [XmlEnum("Coolbox")]
    Esky,
    [XmlEnum("Sandles")]
    Thong,
    [XmlEnum("MoreLikeGridironThanRealFootball")]
    Footy,
} 
```

# linq - LINQ 中的 GroupBy 字符串和计数

> ID：540248
> 
> 赞同：5
> 
> 时间：2009-02-12T06:09:46.063
> 
> 标签：linq

我有一个收藏。coll 有字符串：

```
Location="Theater=1, Name=regal, Area=Area1"

Location="Theater=34, Name=Karm, Area=Area4445" 
```

等等。我必须从字符串中提取名称位。例如，在这里我必须提取文本“regal”并将查询分组。然后将结果显示为

```
Name=regal Count 33
Name=Karm  Count 22 
```

我正在努力解决这个问题：

Collection.Location.GroupBy(????);(这里要添加什么)

哪种方法最简短、最精确？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T06:49:27.700

另一种 Linq + Regex 方法：

```
string[] Location = {
                        "Theater=2, Name=regal, Area=Area1",
                        "Theater=2, Name=regal, Area=Area1",
                        "Theater=34, Name=Karm, Area=Area4445"
                    };

var test = Location.Select(
                            x => Regex.Match(x, "^.*Name=(.*),.*$")
                                      .Groups[1].Value)
                   .GroupBy(x => x)
                   .Select(x=> new {Name = x.Key, Count = x.Count()}); 
```

* * *

测试字符串的查询结果

![](https://dl.getdropbox.com/u/35146/stackoverflow/linq-regex.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T06:32:53.823

提取字符串后，只需按它分组并计算结果：

```
var query = from location in locations
            let name = ExtractNameFromLocation(location)
            group 1 by name in grouped
            select new { Name=grouped.Key, Count=grouped.Count() }; 
```

然而，这并不是特别有效。它必须在进行任何计数之前完成所有分组。查看[这篇 VJ 文章](http://www.vsj.co.uk/articles/display.asp?id=697)，了解 LINQ to Objects 的扩展方法，以及[关于 Push LINQ](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)的这篇文章，这是一种不同的 LINQ 方式。

编辑： ExtractNameFromLocation 将是从您的[其他问题](https://stackoverflow.com/questions/539983/extract-portion-of-string)的答案中获取的代码，例如

```
public static string ExtractNameFromLocation(string location)
{
    var name = (from part in location.Split(',')
                let pair = part.Split('=')
                where pair[0].Trim() == "Name"
                select pair[1].Trim()).FirstOrDefault();
    return name;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T06:46:10.873

这是另一个带有工作示例的 LINQ 替代解决方案。

```
static void Main(string[] args)
{
    System.Collections.Generic.List<string> l = new List<string>();
    l.Add("Theater=1, Name=regal, Area=Area"); l.Add("Theater=34, Name=Karm, Area=Area4445");

    foreach (IGrouping<string, string> g in l.GroupBy(r => extractName(r)))
    {
        Console.WriteLine( string.Format("Name= {0} Count {1}", g.Key, g.Count())  );
    }
}
private static string extractName(string dirty)
{
    System.Text.RegularExpressions.Match m =
        System.Text.RegularExpressions.Regex.Match(
        dirty, @"(?<=Name=)[a-zA-Z0-9_ ]+(?=,)");

    return m.Success ? m.Value : "";
} 
```

# c++ - 任何 IDE 或框架都可以帮助快速测试新代码而无需运行整个应用程序吗

> ID：540252
> 
> 赞同：4
> 
> 时间：2009-02-12T06:11:33.547
> 
> 标签：c++, testing

我主要使用 Visual Studio 在 Windows 上使用原生 C++ 进行开发。

很多时候，我发现自己创建了一个新函数/类或其他什么，我只想快速测试我刚刚编写的那段逻辑。

很多时候，我必须运行整个应用程序，这有时可能需要一段时间，因为有很多连接的部分。

是否有某种工具可以让我快速测试新代码，*而无需*运行整个应用程序？

IE

假设我有一个包含大约 1000 个文件的项目，并且我正在添加一个名为 Adder 的新类。Adder 有一个方法 Add( int, int );

我只希望 IDE/工具允许我通过允许我指定进入 Adder 对象的输入值来测试 Adder 类（而不必创建一个新项目并编写一个虚拟 main.cpp）。同样，如果它允许我指定测试对象的预期输出，那就太好了。

更酷的是，如果 IDE/工具将“记录”这些输入/预期输出集，并根据它们自动创建单元测试器类。如果我添加更多的输入/输出集，它将继续建立输入/输出的历史。

或者这个怎​​么样：如果我启动实际应用程序，向它提供一些真实数据，并让 IDE/工具捕获进入被测试单元的完整输入。这样，如果我在我的程序中发现了一些错误或者我想稍微改变它的界面，我可以快速重新开始我的测试。我觉得这个功能会很简洁，可以帮助开发者快速测试/修改他们的代码。

我是在谈论已经存在的模拟对象/单元测试吗？

旁注：如果 Visual Studio 调试器具有“重放”技术，用户可以退后一步找出问题所在，那就太棒了。这样的调试器已经存在：[http ://www.totalviewtech.com/](http://www.totalviewtech.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T08:34:57.603

在 C++ 中使用静态单元测试很容易上手——[三行代码](http://www.jera.com/techinfo/jtns/jtn002.html)。

VS 有点差，因为你必须通过向导来创建一个项目来构建和运行测试，所以如果你有一千个类，你就需要一千个项目。因此，对于 VS 上的大型项目，我倾向于将项目组织成几个 DLL，用于独立构建和测试，而不是单一的。

[可以在 python 中使用swig](http://www.swig.org/)将代码绑定到解释器和 python 的[doc tests](http://docs.python.org/library/doctest.html)来替代更类似于“poke and dribble”脚本的静态测试。我自己没有一起用过。同样，您需要一个单独的目标来构建 python 绑定，并需要另一个目标来运行测试，而不仅仅是一个简单的“运行此类”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:02:58.333

我会选择 Boost.Test（请参阅[此处的教程](http://www.beroux.com/english/articles/boost_unit_testing/)））。这个想法是为您的项目添加一个新配置，这将从构建中排除所有不必要的 cpp 文件。您只需添加 .cpp 文件来描述您想要通过的测试。

我不是这方面的专家，但我过去曾使用过这种技术并且它有效！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T17:30:42.370

我认为您在谈论单元测试和模拟对象。以下是几个可能有用的 C++ 模拟对象库：-

*   [googlemock](http://code.google.com/p/googlemock/)仅适用于[googletest](http://code.google.com/p/googletest/)
*   [模拟pp](http://mockpp.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-25T11:43:16.973

您本质上是在问*我如何测试一个功能而不是整个应用程序*。这就是**[单元测试](https://stackoverflow.com/questions/1383/what-is-unit-testing)**，你会发现很多[关于](https://stackoverflow.com/search?tab=votes&q=%5Bc%2B%2B%5D%20%5Bunit-testing%5D%20is%3Aquestion)在 SO 上对 C++ 进行单元测试的问题。

# asp.net - 使用 httprequest 调用 Web 服务

> ID：540261
> 
> 赞同：1
> 
> 时间：2009-02-12T06:21:57.750
> 
> 标签：asp.net, web-services, soap, streaming

我有一个 Web 服务，其中包含如下方法

```
 [WebMethod]
 public string UploadFile(byte[] bytes, string file_name)
  {

  } 
```

我想使用 HttpWebRequest 调用此 Web 服务方法，以便我可以流式传输文件而无需在内存中缓冲。怎么做...我尝试按如下方式调用它

```
HttpWebRequest hw = HttpWebRequest.Create("http://localhost/xxx/xxx.asmx/Upload") as HttpWebRequest;
hw.ContentType = "application/x-www-form-urlencoded";
hw.AllowWriteStreamBuffering = false;
hw.Method = "POST";
hw.UnsafeAuthenticatedConnectionSharing = true;
hw.UserAgent = "test type";
hw.Credentials = CredentialCache.DefaultCredentials;
FileInfo fi = new FileInfo("C:/Documents and Settings/Administrator/Desktop/a.txt");
string bytes = "bytes=";
byte[] by = UTF8Encoding.UTF8.GetBytes(bytes);
byte[] fn = UTF8Encoding.UTF8.GetBytes("&file_name=a.txt");
hw.ContentLength = by.Length+fi.Length+fn.Length;

using (Stream postStream = hw.GetRequestStream())
 {
        FileStream br = new FileStream("C:/Documents and Settings/Administrator/Desktop/a.txt", FileMode.Open, FileAccess.Read);

        postStream.Write(by, 0, by.Length);

        byte[] buffer = new byte[1024];
        int bytesRead = 0;
        while (true)
        {
            bytesRead = br.Read(buffer, 0, buffer.Length);
            if (bytesRead == 0)
                break;
            postStream.Write(buffer, 0, bytesRead);
        }
        br.Close();

        postStream.Write(fn, 0, fn.Length);
        postStream.Write(ct, 0, ct.Length);
    }
    // HERE : 
    using (HttpWebResponse response = hw.GetResponse() as HttpWebResponse)
    {

        StreamReader reader = new StreamReader(response.GetResponseStream());

         string sssdd = reader.ReadToEnd();

    } 
```

但它显示一条消息“远程服务器返回错误：（500）内部服务器错误。” 在执行 **// HERE : ** 标记行时。

顺便说一句：我使用的是 asp.net 2.0，我不允许使用代理类，因为我的要求是流式传输大文件的数据。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-11T16:46:45.893

自从我弄乱这些东西以来已经有一段时间了，但我认为你可以在代理类中获得底层的 HttpRequest 。可能比编写自己的 SOAP 到 POST 容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T06:33:22.730

在您的浏览器中打开`http://localhost/xxx/xxx.asmx/Upload`，ASP.NET 将为您提供一个示例 POST 请求，您需要发送以调用该方法。从那里开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T19:03:27.247

If it says that the remote server returned an error, then you should look on the remote server to see what the error was. Look in the Event Log on the server for events at around the time you received the error.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T08:19:49.383

删除这些行：

```
postStream.Write(by, 0, by.Length);
.
.
.
postStream.Write(fn, 0, fn.Length);
postStream.Write(ct, 0, ct.Length); 
```

# iphone - iPhone游戏的在线玩可能性？

> ID：540265
> 
> 赞同：3
> 
> 时间：2009-02-12T06:26:20.063
> 
> 标签：iphone

你们将如何为 iPhone 游戏创建在线游戏功能？显然，可以经常轮询服务器，但考虑到设备的功能，这是否现实？假设您每隔一两秒就轮询一次服务器并检索 100 字节的数据......是否可以在游戏继续进行时在后台检索数据，还是会被服务器轮询阻止？

提前致谢， BCH

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T08:54:34.170

您需要制作一个多线程应用程序。然后你可以有一个后台线程轮询服务器（或者更好的是，在它上面发出异步请求。

看看 NSOperation 和 NSOperationQueue 类。您将使每个后台任务由 NSOperation 类的实例表示。此类负责启动操作，确保它们以适当的顺序运行，并考虑您设置的任何优先级。

使用 NSOperation 最常见的方法是编写自定义子类并覆盖方法 main。当 NSOperationQueue 调度它运行时，调用 main 方法来执行操作。

如果您不想要子类化的开销，请查看 NSInvocationOperation 类。这是 NSOperation 的一个具体子类，可以很容易地将操作附加到现有方法。NSInvocationOperation 对象可以添加到 NSOperationQueue（就像 NSOperations 一样），这样您就可以在无需子类的情况下获得多线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T13:27:48.397

看一下 WiTap 示例（在 xcode 中对 witap 进行全文搜索）。它使用 NSStreams 来获得异步行为，而您不必求助于管理自己的线程或轮询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T06:32:41.280

您可以执行异步请求。但是你在这里问了一个非常非常困难的问题。只是想确保你知道这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-08T14:39:37.183

使用 OpenFeint.. 它让您可以轻松地通过互联网开发全球非实时回合制多人游戏..

我不确定 GameCenter 现在是否支持类似的功能。

# windows - 如何在 Windows 资源管理器中添加虚拟驱动程序，如 CD Emulation

> ID：540267
> 
> 赞同：1
> 
> 时间：2009-02-12T06:26:36.350
> 
> 标签：windows, wdk, virtual-drive

我不熟悉内核驱动程序开发，所以我想知道是否有其他简单的方法可以在 Windows 资源管理器中添加虚拟驱动程序，如 CD Emulation。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T06:35:52.200

一种可能值得考虑的方法是[Dokan](http://dokan-dev.net/en/)项目。从网站：

> 通过使用 Dokan 库，您可以非常轻松地创建自己的文件系统，而无需编写设备驱动程序。Dokan 库类似于 FUSE（Linux 用户模式文件系统），但适用于 Windows。

DLL 可直接从 C/C++ 中使用。有一个 .NET 绑定和一个 Ruby 绑定，都来自“官方”项目。示例包括通过 SSH 挂载远程文件系统的 SSHFS、ramdisk 和镜像等。

我看过一份白皮书，该白皮书演示了一个文件系统，该文件系统由基于 Dokan 库的 MP3 文件集合中的标签组织。我还看到了在文件系统中镜像用户的 Flickr 照片流的描述和演示。

我自己还没有尝试过，但计划“很快”使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:35:51.907

更多细节会对此有很大帮助，但这里有一些很好的一般性建议：

如果您尝试挂载某种虚拟文件系统以在 Explorer 中进行操作，那么 Just Might Work 的一种简单方法是您可以通过 WebDAV 公开您的文件系统。几乎所有开发平台都有 WebDAV 库，所有主要操作系统都具有映射 WebDAV 文件夹以在其资源管理器 UI 中使用的能力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T21:03:02.517

关于您的问题的问题，您是否正在寻找类似于资源管理器处理 CD 仿真或 Windows 资源管理器的虚拟 CD 仿真驱动程序的虚拟驱动程序？

# perl - 我可以让单个 Perl 模块充当多种 mod_perl 处理程序吗？

> ID：540275
> 
> 赞同：2
> 
> 时间：2009-02-12T06:33:00.063
> 
> 标签：perl, apache, mod-perl

我正在为 Apache 中的各种登录相关功能编写一系列相关的 mod_perl 处理程序，所以我的 Apache 配置文件看起来像这样（例如）

```
PerlAccessHandler MyApache::MyAccess    
PerlAuthenHandler MyApache::MyAuthen
PerlAuthzHandler MyApache::MyAuthz 
```

每个模块 ( `MyAccess`, `MyAuthen`, `MyAuthz`) 定义了一个

```
sub handler() {} 
```

它`mod_perl`在请求处理的相关点调用。

我想知道的是，是否有一种方法可以用一个 Perl 模块而不是三个来做到这一点（安装一个模块而不是 3 个模块更整洁，用户工作量也更少）？

有没有办法定义处理程序方法的名称，也许。或者有没有办法从`handler()`代码中检测我应该做哪种处理？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T13:40:26.167

从[mod_perl 2.0 文档](http://perl.apache.org/docs/2.0/user/coding/coding.html#Method_Handlers)中可以看出，您可以使用“方法”语法来执行您想要的操作（我尚未对此进行测试）：

```
PerlAccessHandler MyApache::MyLoginModule->access_handler
PerlAuthenHandler  MyApache::MyLoginModule->authen_handler
PerlAuthzHandler MyApache::MyLoginModule->authz_handler 
```

`MyApache::MyLoginModule`我相信这会导致 mod_perl 在你的类上以静态方式调用每个命名方法。

`handler`如果您愿意，还可以创建一个在调用方法时使用的对象：

```
<Perl>
  use MyApache::MyLoginModule;
  $MyApache::MyLoginModule::access = MyApache::MyLoginModule->new(phase => 'access');
  $MyApache::MyLoginModule::authen = MyApache::MyLoginModule->new(phase => 'authen');
  $MyApache::MyLoginModule::authz = MyApache::MyLoginModule->new(phase => 'authz');
</Perl>

PerlAccessHandler $MyApache::MyLoginModule::access->handler
PerlAuthenHandler $MyApache::MyLoginModule::authen->handler
PerlAuthzHandler $MyApache::MyLoginModule::authz->handler 
```

这种方法将允许您拥有一个`handler`方法，该方法可以根据创建对象时设置的对象属性具有不同的行为。

*免责声明：自从我使用 mod_perl 配置的这一部分以来已经有一段时间了，所以您的结果可能会有所不同！*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T06:49:06.810

看起来一种可能性可能是使用`push_handlers()`调用并在代码中而不是在 apache conf 文件中设置处理程序

见这里：[http ://tinyurl.com/bwdeew](http://tinyurl.com/bwdeew)

# java - 面临 log4j 错误日志和异常处理中的问题

> ID：540282
> 
> 赞同：0
> 
> 时间：2009-02-12T06:36:23.957
> 
> 标签：java, logging, exception-handling, log4j

我已经使用 log4j 使用 FileAppender 记录错误日志。问题是在以下情况下，它在日志文件中记录了两次相同的错误

**情况1：**

```
Class1 :

public void func(){
    try{
        new Class2.prop()
    }catch(IOException ioe){
        logger.log(2,ioe);
    }
}

Class2 :

public void prop(){
    try{
        //error oocurs here
    }catch(FileNotFoundException fe){
        logger.log(2,fe);
    }
}

Error :
    Class2 .FileNotFoundException 
    at Class2.prop(Class2.java:3)
    at Class1.func(Class1.java:4)

Log File :

    FileNotFound exception
    FileNotFound exception 
```

但是对于以下情况，它会记录一次错误。

**案例2：**

```
Class1 :

public void func(){
    try{
        new Class2.prop()
        //error oocurs here
    }catch(IOException ioe){
        logger.log(2,ioe);
    }
}

Class2 :
    public void prop(){
        try{
        }catch(FileNotFoundException fe){
            logger.log(2,fe);
        }
    }

Error :
    Class2 .IOException 
    at Class1.func(Class1.java:4)

Log File :
    IOException exception 
```

帮助我应该怎么做才能在日志文件中只记录一次错误，无论它在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T06:44:13.267

> *但是对于以下情况，它会记录一次错误。*

那是因为您正在**处理**异常：

第一类：

```
public void func() {
    try{
        new Class2.prop()
    }catch(IOException ioe){
        logger.log(2,ioe);            
    }
} 
```

2 类：

```
public void prop() throws IOException {
    try{
        //error oocurs here
    }catch(FileNotFoundException fe){
        logger.log(2,fe);
        throw fe;
    }
    // Here!!!!!
} 
```

在 class2 的 catch 块中（在您的 //error oocurs here 之后）您记录异常，这就是您在日志中得到的内容。

但是由于您只是记录异常，因此您是在告诉程序该异常已被某种方式控制或处理（更合适）并且程序继续流向我添加注释的行**// Here!! ！！！**

稍后在 class1 中，由于处理了异常，因此在 try/catch 块中没有发生任何事情，并且您的第二个异常永远不会被记录（如您所料），因为它从未发生过。

如果您想查看两个日志（我认为这是不必要的），您应该像我在您的 class2 中所做的那样重新抛出异常，并且修改方法签名以标记它抛出 IOException。

这样你就会有两个日志。

最好是这样的：

第一类：

```
public void func() {
    try{
        new Class2.prop()
    }catch(IOException ioe){
        logger.log(2,ioe);            
    }
} 
```

2 类：

```
public void prop() throws IOException {
        //error oocurs here
} 
```

在第 2 类中，您不处理异常，只是让它通过调用者。无论如何，在堆栈跟踪中，您都会获得信息。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T09:46:33.560

在您的 log4j 配置中，您是否将 Class 2 中使用的记录器发送到您的 appender 两次？

# javascript - 获取 iframe 的内容

> ID：540283
> 
> 赞同：0
> 
> 时间：2009-02-12T06:36:45.187
> 
> 标签：javascript, html, iframe

我正在尝试`<iframe>`从另一个页面获取内容。

另一个页面是不同的网站；我已登录该网站并获取其内容并将其存储在`<iframe>`.

如何将其内容`<iframe>`放入当前窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T07:29:31.287

简短的回答：你做不到。[浏览器使用相同的来源策略](http://en.wikipedia.org/wiki/Same_origin_policy)限制来自不同网站的内容之间的交互。

# iphone - NSData - 在内存使用方面哪个更好：initWithContentsOfURL 或 NSURLConnection

> ID：540285
> 
> 赞同：1
> 
> 时间：2009-02-12T06:37:53.593
> 
> 标签：iphone, memory-management

我想从 URL 获取 NSData 对象的内容。就内存使用 dataWithContentsOfURL（或 initWithContentsOfURL）或使用 NSURLConnection 而言，更有效的方法是什么？

我应该使用

```
NSData *data = [[NSData alloc] initWithContentsOfURL:myURL] 
```

或者

```
NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T08:32:59.573

我不知道 Apple 代码的内部结构，但我猜想 NSData 的 initWithContents 的 URL 在内部使用 NSURLConnection。内存使用差异可以忽略不计。

使用 NSURLConnection 的异步 api 可以让您通过处理传入的数据来提高内存效率，但是（不知道您实际上在做什么）我认为这是一个相当激进的优化，您应该离开，直到您有工作代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T06:39:53.713

很确定它们是相当的。

# php - 如何在 PHP 中设计错误报告

> ID：540287
> 
> 赞同：3
> 
> 时间：2009-02-12T06:39:00.597
> 
> 标签：php, error-handling

我应该如何在 PHP 中编写错误报告模块？比如说，我想用 PHP 编写一个函数：'bool isDuplicateEmail($email)'。在该函数中，我想检查 $email 是否已存在于数据库中。如果存在，它将返回“true”。否则“假”。

现在，查询执行也可能失败，那时我想向用户报告“内部错误”。

该函数不应因典型的mysql错误而死：die(mysql_error()。我的Web应用程序有两个界面：浏览器和电子邮件（您可以通过发送电子邮件来执行某些操作）。在这两种情况下，它都应该以美观的方式报告错误。做我真的必须为此使用异常处理吗？

谁能指点我一些好的 PHP 项目，在那里我可以学习如何设计健壮的 PHP 网络应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T13:30:30.527

在我的 PHP 项目中，我尝试了几种不同的方法。我找到了以下似乎对我很有效的解决方案：

First, any major PHP application I write has some sort of central singleton that manages application-level data and behaviors. The "Application" object. I mention that here because I use this object to collect generated feedback from every other module. The rendering module can query the application object for the feedback it deems should be displayed to the user.

On a lower-level, every class is derived from some base class that contains error management methods. For example an "AddError(code,string,global)" and "GetErrors()" and "ClearErrors". The "AddError" method does two things: stores a local copy of that error in an instance-specific array for that object and (optionally) notifies the application object of this error ("global" is a boolean) which then stores that error for future use in rendering.

So now here's how it works in practice:

Note that 'Object' defines the following methods: *AddError* *ClearErrors* *GetErrorCodes* *GetErrorsAsStrings* *GetErrorCount* and maybe *HasError* for convenience

```
// $GLOBALS['app'] = new Application();

class MyObject extends Object
{
     /**
      * @return bool Returns false if failed
      */
     public function DoThing()
     {
          $this->ClearErrors();
          if ([something succeeded])
          {
              return true;
          }
          else 
          {
              $this->AddError(ERR_OP_FAILED,"Thing could not be done");
              return false;
          }              
     }
}

$ob = new MyObject();
if ($ob->DoThing()) 
{
   echo 'Success.';
}
else 
{
   // Right now, i may not really care *why* it didn't work (the user
   // may want to know about the problem, though (see below).
   $ob->TrySomethingElse();
}

// ...LATER ON IN THE RENDERING MODULE
echo implode('<br/>',$GLOBALS['app']->GetErrorsAsStrings()); 
```

The reason I like this is because:

1.  I hate exceptions because I personally believe they make code more convoluted that it needs to be
2.  Sometimes you just need to know that a function succeeded or failed and not exactly what went wrong
3.  A lot of times you don't need a specific error code but you need a specific error string and you don't want to create an error code for every single possible error condition. Sometimes you really just want to use an "opfailed" code but go into some detail for the user's sake in the string itself. This allows for that flexibility
4.  Having two error collection locations (the local level for use by the calling algorithm and global level for use by rendering modules for telling the user about them) has really worked for me to give each functional area exactly what it needs to get things done.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T07:23:33.017

使用 MVC，我总是使用某种默认的错误/异常处理程序，其中将捕获带有异常（并且没有自己的错误/异常处理）的操作。
在那里，您可以决定通过电子邮件或浏览器响应来回答，它总是具有相同的外观:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:57:56.007

我会使用一个像 Zend Framework 这样的框架，它有一个完整的异常处理机制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T13:03:11.997

查看php 手册中的[异常处理](http://ca2.php.net/set-exception-handler)和[错误处理](http://ca2.php.net/set-error-handler)。还阅读了底部的评论，非常有用。

这些页面中还解释了如何将 PHP 错误转换为异常的方法，因此您只处理异常（大部分情况下）。

# iphone - 哪个 UIButton 事件可以像 flash 中一样充当鼠标悬停事件

> ID：540288
> 
> 赞同：0
> 
> 时间：2009-02-12T06:39:01.827
> 
> 标签：iphone

我想创建一个 UIButton，当鼠标悬停在它上面时它会放大，谁能告诉我哪个事件可以做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T06:45:37.117

没有鼠标，只有触摸。如何将鼠标悬停在按钮上而不在基于触摸的界面上点击它？我不认为它像你认为的那样工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T06:46:25.990

进入界面生成器。放入一个按钮并查看属性窗口。

您将看到具有标题的部分：图像：背景。如果您单击显示“全部”的下拉菜单，您可以选择几个按钮状态并相应地设置它们。当用户按下按钮时使用**突出显示状态。**

这应该让您了解它是如何工作的。您可以深入研究文档以了解如何从那里以编程方式进行操作。

将鼠标悬停在 iPhone 上是一种触摸。除非您正在跟踪手指的位置，并且您希望对象在您进入其边界时做出反应。但是突出显示的状态应该可以让您到达那里。

# java - 枚举对象应该是无状态的吗？

> ID：540293
> 
> 赞同：7
> 
> 时间：2009-02-12T06:42:10.290
> 
> 标签：java, oop, enums

按照设计，Java 中的枚举常量是单例的，为了并发使用，我通常创建无状态枚举实例并使用方法参数根据需要注入数据。

例子：

目前我正在创建一个具有操作的 REST 服务（使用策略模式的变体实现为枚举）。

```
public enum Operation {

  DO_THIS() {
    public Result doSomething(Object theData) {
    }
  } ,
  // Other Operations go here
  ;

  public abstract Result doSomething(Object theData);

} 
```

现在我想收集有关操作被调用的频率以及成功的频率等数据。

使用枚举实例时，我可以在外部保存状态，但似乎状态应该保存在操作中，因为操作应该包含它自己的状态。

现在我的一般问题是：

**有状态的枚举实例（除了并发问题）是一个糟糕的设计吗？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-12T06:47:35.397

我认为这违反了最小惊讶原则。

人们期望枚举按照最初的设计通用——作为常量或标记，而不是作为具有状态的通用类。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-12T18:12:02.113

每次创建可变枚举时，小猫就会死去。拯救小猫们！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-12T06:56:12.440

是的。“是”我的意思是“总是”。

如果您想整理调用操作数量的统计信息，请实现一些可观察性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T13:55:00.267

任何形式的可变静态都是一种罪过。（好吧，您可能会摆脱非泄漏缓存、一些延迟初始化和日志记录形式。）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-03-29T22:56:59.333

有状态的枚举是矛盾的，甚至是反模式！

[http://en.wikipedia.org/wiki/Enumeration](http://en.wikipedia.org/wiki/Enumeration)

> 枚举是项目的集合，它是该集合中所有项目的完整、有序列表。该术语通常用于数学和理论计算机科学中，指的是集合中所有元素的列表。在统计学中，使用术语分类变量而不是枚举。枚举的精确要求（例如，集合是否必须是有限的，或者列表是否允许包含重复项）取决于数学的分支和工作环境。

枚举具有有限数量的值，这些值应该是恒定的，它们就是。

然而，它们是“一流的”Java 对象这一事实完全违背了枚举的意图或精神。

如果需要任何类型的状态，枚举（如前所述）应该在一个方面或有问题的枚举中保持状态，至少应该保持对持有状态的委托类的引用。理解“关注点分离”会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T06:54:25.317

这对于枚举来说似乎是一个不好的用途——为什么不使用一个为每个操作创建一个新子类的基本抽象类呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T15:19:09.393

我完全同意 mparaz 的观点，即它违反了最小惊讶原则。人们期望枚举是常数。

您几乎可以肯定地通过以下方式解决日志记录问题：

```
DO_THIS() {
  public Result doSomething(Object theData) {
    MyUtilClass.doSomething(Object theData);
  }
} 
```

并将您的日志记录放在另一个类中。

但是，如果您无法解决此问题，最小惊讶原则是一个指导方针；你可以违反它，前提是你给班级的用户足够多的关于正在发生的事情的警告。确保 Enum 声明包含一个 BIG 通知，说明它是可变的，并准确描述可变性是什么。枚举应该仍然有效；它正在对单个实例进行参考比较以测试枚举值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-02T01:44:37.883

有一个案例可能会证明它是合理的。枚举可以实现一个接口，通常考虑到特定的用例，它允许您在运行时/以动态方式公开地创建“枚举类的某些其他类型”，以某种方式命名它。

这意味着可以强制枚举“单例”实例实现一些可变的方法签名（作为设置器），当然，您仍然可以使用空代码或 NotSupportedException 来隐藏它们。

幸运的是，接口中的 final 方法不允许任何改变状态的可能性。那将是我能想到的唯一“可以理解”的案例。

# xml - 在 cdata 中编码 ]]>

> ID：540294
> 
> 赞同：2
> 
> 时间：2009-02-12T06:42:59.540
> 
> 标签：xml, cdata

如果我正在构建一些 XML 并使用`<![CDATA[...]]>`，如何对可能包含`]]>`子字符串的数据进行编码？会`]]&gt;`吗？我问是因为我一直认为 CDATA 内容是文字内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T06:46:23.870

它的效率不是很高，也不是很容易阅读，或者其他任何东西，但[解决这个问题的方法](http://en.wikipedia.org/wiki/CDATA#Uses_of_CDATA_sections)似乎是写作......

```
]]]]><![CDATA[> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T06:58:10.173

您可以只使用两个 cdata 标签，第一个包含 ]]，第二个包含 >

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-12T06:48:44.940

从某种意义上说，CDATA 是文字内容，但当然必须有某种方法来标记 CDATA 块的结尾，并且无论您选择什么，都必须以某种方式在您的字符串中表示。

当我不得不在另一个 CDATA 块中处理包含 CDATA 的 XML 文档时，就像您似乎必须做的那样，我放弃了并将整个事情编码为 Base64。然后另一方提取文本并对其进行解码。

Base64 很方便，因为它具有通用的支持和/或简单的算法，可以用多种语言将 ASCII 字符串编码和解码成它，在我的例子中是 ASP.NET 应用程序中的 C# 和 Javascript。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-12T06:48:38.560

实体不应该工作吗？

像这样：&93;&93;`&gt;`

或者，只是其中之一：]]`&gt;`

93 用于 latin1，如果以 utf-8 发送数据，则需要 unicode 实体。

作为旁注，还有其他字符在 CDATA 块中也是不允许的，一些奇怪的引号和控制流字符。

# bash - 通过引用传递参数

> ID：540298
> 
> 赞同：52
> 
> 时间：2009-02-12T06:45:31.423
> 
> 标签：bash, shell, scripting, pass-by-reference

我想问是否可以通过引用将参数传递给脚本函数：

即在 C++ 中做一些看起来像这样的事情：

```
void boo(int &myint) { myint = 5; }

int main() {
    int t = 4;
    printf("%d\n", t); // t->4
    boo(t);
    printf("%d\n", t); // t->5
} 
```

所以然后在 BASH 中我想做类似的事情：

```
function boo () 
{

    var1=$1       # now var1 is global to the script but using it outside
                  # this function makes me lose encapsulation

    local var2=$1 # so i should use a local variable ... but how to pass it back?

    var2='new'    # only changes the local copy 
    #$1='new'     this is wrong of course ...
    # ${!1}='new' # can i somehow use indirect reference?
}           

# call boo
SOME_VAR='old'
echo $SOME_VAR # -> old
boo "$SOME_VAR"
echo $SOME_VAR # -> new 
```

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2018-05-10T21:21:27.367

现在是 2018 年，这个问题值得更新。至少在 Bash 中，从 Bash 4.3-alpha 开始，您可以使用*namerefs*通过引用传递函数参数：

```
function boo() 
{
    local -n ref=$1
    ref='new' 
}

SOME_VAR='old'
echo $SOME_VAR # -> old
boo SOME_VAR
echo $SOME_VAR # -> new 
```

这里的关键部分是：

*   将变量的名称传递给 boo，而不是它的值：**`boo SOME_VAR`**，而不是**`boo $SOME_VAR`**.

*   在函数内部，使用**`local -n ref=$1`**来声明对名为 by 的变量的*nameref*`$1`，这意味着它不是对`$1`自身的引用，而是对*名称* `$1`持有的变量的引用，即`SOME_VAR`在我们的例子中。右侧的值应该只是一个命名现有变量的字符串：您如何获取字符串并不重要，所以类似`local -n ref="my_var"`or的东西也`local -n ref=$(get_var_name)`可以工作。`declare`也可以`local`在允许/要求的上下文中替换。有关详细信息，请参阅[Bash 参考手册](https://www.gnu.org/software/bash/manual/html_node/Shell-Parameters.html)中有关外壳参数的章节。

这种方法的优点是（可以说）更好的可读性，最重要的是，避免`eval`, 其安全缺陷很多且有据可查。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-13T11:25:44.847

从 Bash 手册页（参数扩展）：

```
    如果参数的第一个字符是感叹号 (!)，则
    引入了变量间接级别。Bash 使用的值
    由参数的其余部分形成的变量作为
    多变的; 然后扩展此变量并将该值用于
    其余的替换，而不是参数的值
    本身。这称为间接扩展。

```

因此，引用是变量的名称。这是一个`swap`使用变量间接的函数，不需要临时变量：

```
function swap()
{   # 
    # @param VARNAME1 VARNAME2
    #
    eval "$1=${!2} $2=${!1}"
}

$ a=1 b=2
$ swap a b
$ echo $a $b
2 1 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-05-17T20:19:37.280

使用辅助函数`upvar`：

```
# Assign variable one scope above the caller.
# Usage: local "$1" && upvar $1 value [value ...]
# Param: $1  Variable name to assign value to
# Param: $*  Value(s) to assign.  If multiple values, an array is
#            assigned, otherwise a single value is assigned.
# NOTE: For assigning multiple variables, use 'upvars'.  Do NOT
#       use multiple 'upvar' calls, since one 'upvar' call might
#       reassign a variable to be used by another 'upvar' call.
# See: http://fvue.nl/wiki/Bash:_Passing_variables_by_reference
upvar() {
    if unset -v "$1"; then           # Unset & validate varname
        if (( $# == 2 )); then
            eval $1=\"\$2\"          # Return single value
        else
            eval $1=\(\"\${@:2}\"\)  # Return array
         fi
    fi
} 
```

并从内部像这样使用它`Newfun()`：

```
local "$1" && upvar $1 new 
```

要返回多个变量，请使用另一个辅助函数`upvars`。这允许在一次调用中传递多个变量，从而避免在一次`upvar`调用更改另一个后续`upvar`调用中使用的变量时可能发生的冲突。

有关帮助函数和更多信息，请参见：[http ://www.fvue.nl/wiki/Bash:_Passing_variables_by_reference。](http://www.fvue.nl/wiki/Bash:_Passing_variables_by_reference)`upvars`

问题在于：

```
eval $1=new 
```

`$1`如果碰巧包含一个命令是不安全的：

```
set -- 'ls /;true'
eval $1=new  # Oops 
```

最好使用`printf -v`：

```
printf -v "$1" %s new 
```

但`printf -v`不能分配数组。

此外，如果变量恰好被声明，两者都`eval`将`printf`不起作用`local`：

```
g() { local b; eval $1=bar; }  # WRONG
g b                            # Conflicts with `local b'
echo $b                        # b is empty unexpected 
```

即使`local b`是，冲突仍然存在`unset`：

```
g() { local b; unset b; eval $1=bar; }  # WRONG
g b                                     # Still conflicts with `local b'
echo $b                                 # b is empty unexpected 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-12T07:24:29.830

我找到了一种方法来做到这一点，但我不确定这是多么正确：

```
Newfun()
{
    local var1="$1"
    eval $var1=2
    # or can do eval $1=2 if no local var
}

var=1
echo  var is $var    # $var = 1
newfun 'var'         # pass the name of the variable…
echo now var is $var # $var = 2 
```

所以我们传递变量名而不是值，然后使用 eval ...

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-12T07:57:03.903

Bash 没有内置任何类似引用的东西，所以基本上你能够做你想做的事情的唯一方法就是将你想要修改的全局变量的名称传递给函数。即便如此，您也需要一份`eval`声明：

```
boo() {
    eval ${1}="new"
}

SOME_VAR="old"
echo $SOME_VAR # old
boo "SOME_VAR"
echo $SOME_VAR # new 
```

我认为您不能在这里使用间接引用，因为 Bash 会自动访问名称存储在间接引用中的变量的值。它没有给你设置它的机会。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-09-22T16:33:47.250

好的，所以这个问题一直在等待一个“真正的”解决方案，我很高兴地说，我们现在可以完全不使用 eval 来完成这个问题。

要记住的**关键**是在调用者中声明一个引用作为被调用者，至少在我的示例中：

```
#!/bin/bash

# NOTE this does require a bash version >= 4.3

set -o errexit -o nounset -o posix -o pipefail

passedByRef() {

    local -n theRef

    if [ 0 -lt $# ]; then

        theRef=$1

        echo -e "${FUNCNAME}:\n\tthe value of my reference is:\n\t\t${theRef}"

        # now that we have a reference, we can assign things to it

        theRef="some other value"

        echo -e "${FUNCNAME}:\n\tvalue of my reference set to:\n\t\t${theRef}"

    else

        echo "Error: missing argument"

        exit 1
    fi
}

referenceTester() {

    local theVariable="I am a variable"

    # note the absence of quoting and escaping etc.

    local -n theReference=theVariable

    echo -e "${FUNCNAME}:\n\tthe value of my reference is:\n\t\t${theReference}"

    passedByRef theReference

    echo -e "${FUNCNAME}:\n\tthe value of my reference is now:\n\t\t${theReference},\n\tand the pointed to variable:\n\t\t${theVariable}"

} 
```

运行时输出：

```
referenceTester:
        the value of my reference is:
                I am a variable
passedByRef:
        the value of my reference is:
                I am a variable
passedByRef:
        value of my reference set to:
                some other value
referenceTester:
        the value of my reference is now:
                some other value,
        and the pointed to variable:
                some other value 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T21:32:24.583

不应在用户可以设置的字符串上使用 Eval，因为它很危险。像 "string; rm -rf ~" 这样的东西会很糟糕。因此，通常最好找到您不必担心的解决方案。

但是，正如注释所述，需要 eval 来设置传递的变量。

```
$ y=four
$ four=4
$ echo ${!y}
4
$ foo() { x=$1; echo ${!x}; }
$ foo four
4 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-10T19:25:48.433

```
#!/bin/bash

append_string()
{
if [ -z "${!1}" ]; then
eval "${1}='$2'"
else
eval "${1}='${!1}''${!3}''$2'"
fi
}

PETS=''
SEP='|'
append_string "PETS" "cat" "SEP"
echo "$PETS"
append_string "PETS" "dog" "SEP"
echo "$PETS"
append_string "PETS" "hamster" "SEP"
echo "$PETS" 
```

输出：

```
cat
cat|dog
cat|dog|hamster 
```

调用该函数的结构是：

```
append_string  name_of_var_to_update  string_to_add  name_of_var_containing_sep_char 
```

变量的名称被传递给关于 PETS 和 SEP 的函数，而要附加的字符串以通常的方式作为值传递。"${!1}" 指的是全局 PETS 变量的内容。一开始，变量是空的，每次调用函数时都会添加内容。分隔符可以根据需要选择。“eval”起始行更新宠物变量。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-05T15:55:33.513

这就是在 Ubuntu bash shell 上对我有用的东西

```
#!/bin/sh

iteration=10

increment_count()
{
  local i
  i=$(($1+1))
  eval ${1}=\$i
}

increment_count iteration
echo $iteration #prints 11
increment_count iteration
echo $iteration #prints 12 
```

# php - 修复 cakePHP 中的“返回”以从视图控制器函数返回值

> ID：540300
> 
> 赞同：1
> 
> 时间：2009-02-12T06:45:40.440
> 
> 标签：php, sql, unix, cakephp, timestamp

我在 model.php 文件的模型类中的视图函数内部有一个函数，看起来像这样

```
function sqlToUnix($date){
    $YMDThenHMS = explode(" ", $date);
    $YMD = explode("-", $YMDThenHMS[0]);
    $HMS = explode(":", $YMDThenHMS[1]);
    $UnixTime = mktime($HMS[0], $HMS[1], $HMS[2], $YMD[1], $YMD[2], $YMD[0]);

    return $UnixTime;
} 
```

问题是，当它返回 $UnixTime 时，返回值在模型控制器特定视图函数中可用，但它不会呈现我的视图（停止脚本传播）

有没有一个地方我可以构建这样的功能，以便在任何控制器中的任何地方使用？

比如PHP本身内置的函数time()，我希望能在任何地方使用sqlToUnix

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T21:39:55.773

如果你想从任何地方调用这个函数，比如在模型、控制器、视图、行为、组件和助手中，你可以把它放在你的 app/config/bootstrap.php 文件中。这就是它的用途。一旦它可以简单地作为 sqlToUnix() 全局使用；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T06:47:56.113

我能够通过将函数存储在 appController.php 中来解决问题，并在需要使用时调用该函数

```
$this->sqlToUnix($SQLDate); 
```

很抱歉问这个问题，但我在发布此问题时只记得 appController ><

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:39:51.137

对于您的特定功能，您确定没有返回您的 UnixTime 格式的内置函数吗？

> 有没有一个地方我可以构建这样的功能，以便在任何控制器中的任何地方使用？

```
class MyHelpers
{
    public static function sqlToUnix($SQLDate)
    {
        // code
        return $result;
    }
}

// call me this way, anywhere:
$result = MyHelpers::sqlToUnix($SQLDate); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-09T15:26:15.380

您可以编写一个函数 bootstrap.php（尽管您最好从 bootstrap.php 中包含另一个 PHP 文件）。

我通常在 /app/config 目录中的文件中包含任何额外的功能或配置，并将其包含在我的 bootstrap.php 文件中：

```
require_once(APP.'config'.DS.'my_file_of_whizzy_functions.php'); 
```

然后，该函数将在整个 CakePHP 应用程序中可用。

除此之外，是否 strtotime($sqlDate); 不将 SQL 时间转换为 unix 时间戳？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-21T19:29:54.320

您可以通过控制器访问此功能并将其传递给视图：

```
//Controller

//inside a controller action
{
$TIMESTAMP = $this->Model->sql2unix($this->Model->getTimestamp());
$this->set('timestampe',$TIMESTAMP);
// or does this even do not work?
} 
```

否则你可以创建一个组件

```
//inside the component // inside of a component method
{
$MODEL = loadModel('ModelName');
$return = $MODEL->sql2unix($MODEL->getTimestamp());

return $return;
} 
```

放置代码的位置几乎“不重要”，您只需要遵循 cakephp 的文件夹/类/助手/方法/组件结构即可。阅读有关组件或助手的手册部分，您将立即了解所有内容。

# c# - 如何获取使用asp .net检查的gridview中的CheckBoxes值

> ID：540304
> 
> 赞同：6
> 
> 时间：2009-02-12T06:46:53.853
> 
> 标签：c#

我在gridview中使用复选框....我在第一个单元格中使用它....当我在运行时选择复选框时，我需要获取这些值...但是在选择或单击复选框时，它不是发现或价值被视为 FALSE...如何在 asp.net 后端和 c# 代码中编写？

```
 <asp:TemplateField>
   <ItemTemplate >
       <asp:checkbox id="ShowAddress" runat="server" />
  </ItemTemplate>
 </asp:TemplateField> 
```

代码隐藏：

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        // Looping through all the rows in the GridView

        foreach (GridViewRow di in GridView1.Rows)
        {
         CheckBox chkBx = (CheckBox)di.FindControl("ShowAddress");

            if (chkBx != null && chkBx.Checked)
            {
                /// put your code here
            }
        }
    } 
```

页面加载时脚本中是否有任何实现？

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T10:58:25.573

你如何填充你的 GridView？如果您在 Page_Load 中执行此操作，请确保您不是在回发时执行此操作（检查 IsPostBack）。

您的 chkBx 变量是否为空？

以下代码有效：

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        foreach (GridViewRow row in GridView1.Rows)
        {
            CheckBox chk = row.Cells[0].Controls[0] as CheckBox;
            if (chk != null && chk.Checked)
            {
                // ...
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-27T05:48:06.017

```
StringCollection idCollection = new StringCollection();
string strID = string.Empty;

for (int i = 0; i < GridView1.Rows.Count; i++)
{
   CheckBox chkDelete = (CheckBox) GridView1.Rows.Cells[0].FindControl("chkSelect");
   if (chkDelete != null)
   {
     if (chkDelete.Checked)
      {
          strID = GridView1.Rows.Cells[1].Text;
         idCollection.Add(strID);
    }
  }
} 
```

有关更多详细信息，请查看此链接：[http ://www.itworld2.com/ghowto.aspx?id=69](http://www.itworld2.com/ghowto.aspx?id=69)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:32:11.827

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
     Loadgridview();// its a correct
    }//            not Loadgridview() here if you load above error is occur
 } 
```

核实

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-28T12:41:59.160

```
int i = 0;
foreach (GridViewRow row in GridView1.Rows)
{
    CheckBox chk = (CheckBox)GridView_AdminTags.Rows[i].Cells[0].FindControl("chkTag");
    if (chk != null)
        if (chk.Checked)
        {
            ////.......;
        }
    i++;
}
i = 0; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-05-10T10:27:02.700

如果使用下面的行，Jakob Answer 将起作用。即使只有一个控件在单元格中，索引也需要为 1 而不是 0

```
CheckBox chk = row.Cells[0].Controls[1] as CheckBox; 
```

谢谢山姆

# c# - 什么是代码优化？

> ID：540305
> 
> 赞同：7
> 
> 时间：2009-02-12T06:47:13.837
> 
> 标签：c#, optimization

当说这段代码需要一些优化，或者可以进行一些优化时，这是什么意思？什么样的代码需要优化？如何对 c# 中的代码进行优化？这样做有什么好处？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-12T07:00:56.703

*优化*是一个非常广泛的术语。一般来说，它意味着修改系统以使其某些方面更有效地工作或使用更少的资源或更健壮。例如，可以优化计算机程序，使其执行速度更快或使用更少的内存或磁盘存储，或者在 UI 方面更具响应性。

尽管“优化”与“最优”具有相同的根源，但优化过程不会产生一个完全最优的系统：总是有一个权衡，所以只有最感兴趣的属性才会被优化。

请记住：

> 程序优化的第一条规则：不要这样做。程序优化的第二条规则（仅限专家！）：不要这样做。（[迈克尔·杰克逊](http://en.wikipedia.org/wiki/Michael_A._Jackson)）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T07:27:54.940

[优化](http://en.wikipedia.org/wiki/Software_optimization)是修改系统以使其某些方面更有效地工作或使用更少资源的过程。

在您的情况下，主要是指2个级别：

> **设计水平**
> 
> 在最高级别，可以优化设计以充分利用可用资源。这种设计的实现将受益于高效算法的良好选择，而这些算法的实现将受益于编写高质量的代码。系统的架构设计会极大地影响其性能。算法的选择比设计中的任何其他项目对效率的影响更大。然而，在某些情况下，优化依赖于使用更高级的算法、利用特殊情况和特殊技巧以及执行复杂的权衡；因此，如果没有充分的注释，完全优化的程序有时会使经验不足的程序员更难理解，因此可能比未优化的版本包含更多的错误。
> 
> **源代码级别**
> 
> 避免质量差的编码也可以通过避免明显的减速来提高性能。然而，在那之后，一些优化是可能的，这实际上会降低可维护性；现在可以通过优化编译器来执行其中的一些，但并非全部。例如，通常需要使用更多的间接来简化或改进软件，但这种间接是有代价的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T07:03:16.230

代码优化使代码运行得更快。有两种主要方法可以做到这一点：

1) 将更多工作压缩到更少的周期中。找出代码在哪里进行了额外的复制，或者在紧密循环中是否有分支。这是在小的优化。

2）让你的算法更好地扩展。您可能听说过“大 O”符号。这使得算法在处理大量数据时降级的速度要慢得多。

例如，如果您天真地在电话簿中搜索姓名，您将从第 1 页开始阅读所有姓名，直到找到您要查找的姓​​名。这将需要根据电话簿中的姓名数量缩放的一些指令。我们称之为 O(n)。现在想想你是如何真正搜索电话簿的。你打开到中间的某个地方，看看你要找的名字在哪一边。这称为二分搜索，并以名称数量的对数进行缩放。我们称之为 O(logn)。它要快得多。

记住优化的第一条规则：先测量。很多年都花在优化那些运行不多的代码上。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T09:16:47.330

在进行代码优化时，您会对代码进行度量并尝试使其更高效。该指标通常是指稀缺资源。

以下是常用指标

*   执行速度（通常是说优化时首先想到的）
*   内存消耗
*   可执行文件大小（在嵌入式系统上可能很重要）
*   数据库访问
*   远程服务访问（减少聊天，缓存..）
*   代码的简单性、可读性、可维护性

优化后的代码应该给出相同的结果。

问题是你必须做出选择。执行速度往往伴随着更多的内存消耗......

您还应该始终考虑全局优化。当您花费 1000 毫秒等待 Web 服务时，在循环中获得 10 毫秒的增益是完全没有用的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T08:02:07.993

添加到 Anton Gogolev 的答案中，当一段代码需要优化时，是因为未满足特定的性能要求。我们开发程序来满足用户的要求，对吧？大多数程序员倾向于在功能需求方面考虑，即程序做什么，但用户也会有性能要求，提供的资源成本（网络带宽、CPU周期、内存、磁盘空间等）是多少？功能。优化是更改一段代码以满足特定性能要求的过程。恕我直言，这应该在设计时发生，但是您有时会编写一段代码，却发现它表现不佳。要优化代码，您首先必须找出您过度使用的资源。如果是 CPU 周期或内存，分析器可能会有所帮助。

我的建议是在编写代码之前始终了解您当前和未来可能的性能要求，并在设计阶段进行优化。后期优化代价高昂、困难重重，而且通常要么失败，要么导致代码丑陋。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T09:03:36.957

优化有两个主要目的：

*   让您的软件使用更少的资源，例如，运行速度更快、体积更小、使用更少的 RAM、运行和存储文档时的硬盘空间更少、网络访问更少……

*   通过重构让你的软件更易于维护。

只要没有出现相关问题，就不需要优化：调试优化的代码比优化正确的代码要困难得多。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-02-12T06:55:44.253

例如，代码可能有一个重复的代码块，并且可以/应该放入一个方法中，您可能正在使用不推荐使用的方法/类，可能有更简单的方法来执行代码正在执行的操作，那里可能需要进行一些清理工作（例如删除硬编码）等...

# mysql - 哈希表是如何工作的？它比“SELECT * from ..”快吗？

> ID：540311
> 
> 赞同：8
> 
> 时间：2009-02-12T06:48:57.873
> 
> 标签：mysql, hash, hashtable

假设，我有：

```
钥匙 | 索引 | 键值
----+----------+------------
001 | 100001 | 亚历克斯
002 | 100002 | 迈克尔
003 | 100003 | 丹尼尔

```

比方说，我们要搜索 001，如何使用哈希表进行快速搜索过程？

不是和我们在mysql中使用“SELECT * from ..”一样吗？我读了很多，他们说，“SELECT *”从头到尾搜索，但哈希表不是吗？为什么以及如何？

通过使用哈希表，我们是否减少了我们正在搜索的记录？如何？

谁能演示如何在 mysql 查询代码中插入和检索哈希表过程？例如，

```
SELECT * from table1 where hash_value="bla" ... 
```

另一种情况：如果索引像 S0001、S0002、T0001、T0002 等。在 mysql 中，我可以使用：

```
SELECT * from table WHERE value = S* 
```

不是一样而且更快吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T08:59:49.603

一个简单的哈希表通过将项目保存在多个列表中来工作，而不仅仅是一个列表。它使用一种非常快速且可重复（即非随机）的方法来选择将每个项目保留在哪个列表上。因此，当需要再次查找该项目时，它会重复该方法以发现要查找的列表，然后在该列表中进行正常（慢）线性搜索。

通过将项目分成 17 个列表，搜索速度提高了 17 倍，这是一个很好的改进。

当然，这仅在列表长度大致相同时才适用，因此选择一种在列表之间分配项目的好方法很重要。

在您的示例表中，第一列是键，我们需要找到该项目。假设我们将维护 17 个列表。要插入一些东西，我们对键执行一个称为散列的操作。这只是将密钥转换为数字。它不返回随机数，因为它必须始终为同一个键返回相同的数字。但与此同时，数字必须广泛“分散”。

然后我们获取结果数字并使用模数将其缩小到我们列表的大小：

```
Hash(key) % 17 
```

这一切都发生得非常快。我们的列表在一个数组中，所以：

```
_lists[Hash(key % 17)].Add(record); 
```

然后，使用该键查找项目：

```
Record found = _lists[Hash(key % 17)].Find(key); 
```

请注意，每个列表可以是任何容器类型，也可以是您手动编写的链表类。当我们在该列表中执行 a`Find`时，它的工作方式很慢（检查每条记录的键）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T07:42:25.357

不要担心 MySQL 在内部做什么来快速定位记录。数据库的工作就是为你做那种事情。只需运行一个`SELECT [columns] FROM table WHERE [condition];`查询，让数据库为您生成一个查询计划。请注意，您不想使用`SELECT *`，因为如果您向表中添加一列，这将破坏所有依赖于以特定顺序存在一定数量列的旧查询。

如果您真的想知道幕后发生了什么（很高兴知道，但*不要自己实现它：这就是数据库的目的！*），您需要知道索引是什么以及它们是如何工作的。如果表在 WHERE 子句中涉及的列上没有索引，那么，正如您所说，数据库将不得不搜索表中的每一行以找到符合您条件的行。但是如果有*索引*，数据库会搜索索引以找到你想要的行的确切位置，并直接跳转到它们。索引通常实现为[B+-trees](http://en.wikipedia.org/wiki/B%2B_tree)，一种使用很少比较来定位特定元素的搜索树。在 B 树中搜索特定键非常快。MySQL 也能够使用散列索引，但这些索引对于数据库的使用往往较慢。散列索引通常只在长键（尤其是字符串）上表现良好，因为它们将键的大小减小到固定的散列大小。对于整数和实数等数据类型，它们具有明确定义的排序和固定长度，B-tree 的易搜索性通常提供更好的性能。

您可能想查看[MySQL 手册](http://dev.mysql.com/doc/refman/5.1/en/mysql-indexes.html)和[PostgreSQL 手册](http://www.postgresql.org/docs/current/interactive/indexes-types.html)中关于索引的章节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T07:45:54.617

[http://en.wikipedia.org/wiki/Hash_table](http://en.wikipedia.org/wiki/Hash_table)

> 哈希表可以用作内存数据结构。哈希表也可以用于持久数据结构；**[数据库索引](http://en.wikipedia.org/wiki/Index_(database))有时使用基于哈希表的基于磁盘的数据结构**，尽管[平衡树](http://en.wikipedia.org/wiki/Balanced_tree)更受欢迎。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T07:01:25.330

哈希表非常适合以 O(1) 的成本定位条目，其中密钥（用于哈希）是已知的。它们在馆藏库和数据库引擎中都广泛使用。您应该能够在互联网上找到大量有关它们的信息。你为什么不从[维基百科](http://en.wikipedia.org/wiki/Hash_table)开始，或者只是做一个谷歌搜索？

我不知道mysql的详细信息。如果那里有一个称为“哈希表”的结构，那可能是一种使用哈希来定位键的表。我相信其他人会告诉你这件事。=)

编辑：（回应评论）

行。我将尝试做一个非常简单的解释：哈希表是一个表，其中条目基于键的函数定位。例如，假设您要存储有关一组人的信息。如果将其存储在一个普通的未排序数组中，则需要按顺序遍历元素才能找到您要查找的条目。平均而言，这将需要 N/2 次比较。

相反，如果您将所有条目放在基于人员名字的第一个字符的索引中。（A=0、B=1、C=2 等），只要您知道名字，您就可以立即找到正确的条目。这是基本思想。您可能意识到，为了支持具有相同首字母的多个条目，需要进行一些特殊处理（重新散列或允许条目列表）。如果您有一个尺寸良好的哈希表，您应该能够直接找到您正在搜索的项目。这意味着与我刚刚提到的特殊处理的免责声明进行了大约一次比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T07:37:23.590

我想您可以使用哈希函数来获取要从中选择的 ID。像

SELECT * FROM table WHERE value = hash_fn(whatever_input_you_build_your_hash_value_from)

然后您不需要知道要选择的行的 id 并且可以进行精确查询。由于您知道该行将始终具有相同的 id，因为您构建了散列值形式的输入，并且您始终可以通过散列函数重新创建此 id。

然而，这并不总是正确的，具体取决于表的大小和散列值的最大数量（您通常在散列中的某处有“X mod hash-table-size”）。为了解决这个问题，您应该有一个确定性策略，每次您获得两个具有相同 id 的值时都使用该策略。您应该查看[Wikipedia](http://wikipedia.org)以获取有关此策略的更多信息，它称为冲突处理，并且应该在与哈希表相同的文章中提及。

由于提到的 O(1) 特性 norheim.se (up)，MySQL 可能在某处使用哈希表。

# sql - SQL：选择仅属于排除类别的排除类别的记录

> ID：540314
> 
> 赞同：1
> 
> 时间：2009-02-12T06:49:36.233
> 
> 标签：sql, mysql, optimization

我有一个有效的 SELECT 语句，并且在我的表上运行得足够快（在 50k+ 产品、3k+ 类别上 <0.01 秒）。但在我看来，它不是很优雅，想听听任何关于让它变得更好的建议。

有 3 个感兴趣的表：

*   产品 - 关键产品 ID
*   类别 - 关键类别 ID
*   products_tree - 链接表（类别包含许多产品，产品可以属于许多类别）

我有一个排除的类别 ID 列表 [例如 1040,1050,1168] 我想选择属于这些排除类别之一的所有产品 ID，**仅当产品不属于另一个非排除类别时**

我的查询如下所示：

```
SELECT DISTINCT productID 
FROM products_tree 
WHERE 
  categoryID IN (1040,1050,1168) 
  AND productID NOT IN
    ( SELECT DISTINCT productID 
      FROM products_tree 
      WHERE 
      categoryID NOT IN (1040,1050,1168)
    ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T07:52:06.630

我可以想到几种方法，每种方法的执行方式都不同，具体取决于索引和您的特定数据库实现。一些可能看起来很慢的东西可以以您可能无法想象的方式进行优化，因此值得尝试所有这些并比较执行计划以查看正在发生的事情......

注意 1：我使用 GROUP BY 而不是 DISTINCT，这是因为它允许优化器使用索引。我已经看到实现可以将 DISTINCT 转换为 GROUP BY，但首先肯定的是使用 GROUP BY 是非常值得的。它还让您考虑索引，这绝不是一件坏事。

注意2：像这样的一些查询需要一段时间来优化，因为优化器有很多选项需要评估。因此，通常值得将所有不同的选项编译到存储过程中并比较这些存储过程的执行。这确保您比较实际查询时间而不是不同的编译时间。

```
SELECT
   [tree].productID
FROM
   products_tree AS [tree]
WHERE
   [tree].productID IN (1040,1050,1168)
   AND NOT EXISTS (SELECT * FROM products_tree WHERE productID = [tree].productID AND categoryID NOT IN (1040,1050,1168)) 
GROUP BY
   [tree].productID 
```

```
SELECT
   [tree].productID
FROM
   products_tree AS [tree]
LEFT OUTER JOIN
   (
      SELECT
         productID
      FROM
         product_tree
      WHERE
         productID NOT IN (1040,1050,1168)
      GROUP BY
         productID
    )
    AS [ok_products]
       ON [ok_products].productID = [tree].productID
WHERE
   [tree].productID IN (1040,1050,1168)
   AND [ok_products].productID IS NULL 
GROUP BY
   [tree].productID 
```

```
SELECT
   [tree].productID
FROM
   products_tree AS [tree]
GROUP BY
   [tree].productID
HAVING
       MAX(CASE WHEN [tree].productID     IN (1040,1050,1168) THEN 1 ELSE 0 END) = 1
   AND MAX(CASE WHEN [tree].productID NOT IN (1040,1050,1168) THEN 1 ELSE 0 END) = 0 
```

还有其他的，以及每种的变体，但这应该会给你一个很好的开始。但我真的会强调 GROUP BY 的使用和对 INDEXES 的考虑 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T07:00:51.527

我相信您的查询非常好，但您可以将其与联接进行比较：

```
选择不同的 pt1.productID
FROM products_tree pt1
左连接 products_tree pt2 ON pt2.productID = pt1.productID
    AND pt2.categoryID pt1.categoryID

WHERE pt1.categoryID IN (1040,1050,1168)
  并且 pt2.productID 为空

```

不确定我的想法是否正确，但我认为您理解我的方法。但是，如果您愿意，我会直接选择 productinfo，然后联接会更有意义（内部加入您想要的类别，左加入您不想要的类别并检查 null）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:53:31.213

您可以尝试“不存在”变体：

```
SELECT 
  pt.productID 
FROM 
  products_tree pt
WHERE 
  pt.categoryID IN (1040,1050,1168)
  AND NOT EXISTS (
    SELECT 1 
    FROM products_tree 
    WHERE productID = pt.productID AND categoryID NOT IN (1040,1050,1168)
  )
GROUP BY
  pt.productID; 
```

# jquery-ui - jquery sortable - 如何防止项目从一个列表拖动到另一个

> ID：540320
> 
> 赞同：1
> 
> 时间：2009-02-12T06:55:26.983
> 
> 标签：jquery-ui

有两个可排序的 UL 元素通过“connectWith”选项相互链接，以便一个列表中的项目可以移动到另一个列表，反之亦然。我需要禁止将某些项目移动/拖动到另一个列表，同时仍然让它们可以在自己的列表中拖动。有没有办法实现这种行为？

现在我只能使用这些可排序列表的“项目”选项来限制项目的拖动，但是虽然这可以防止所需的项目拖动到另一个列表，但这也可以防止这些项目在自己的列表中拖动（这很糟糕）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-19T17:21:59.800

我能够解决这个问题的方法是使用`li`元素`onMouseDown`和`onMouseUp`事件。单击鼠标时，我更改了我的 CSS 类（或其他任何内容），使其脱离项目列表。

# cocoa-touch - UIToolbar 更多和配置视图？

> ID：540334
> 
> 赞同：2
> 
> 时间：2009-02-12T07:01:30.807
> 
> 标签：cocoa-touch

有没有办法改变 UINavigationBar 和更多的颜色并配置 UIToolbar 的视图？我有一个带有黑色工具栏和黑色导航栏的应用程序，但更多视图现在不合适了。有什么方法可以进行这种匹配吗？

有没有办法获得配置视图来改变它？

注意：这个问题是指配置视图而不是更多视图本身。目前还没有答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T07:45:25.397

获取您的 UITabBarController 实例。然后您可以访问“更多...”控制器。 `self.myTabBarController.moreNavigationController`

从 tabbar 的 UIViewController 子项中，您还有一个隐式引用： `self.tabBarController.moreNavigationController.navigationBar.barStyle`

# c++ - 如何克服 mmsystem.h 引发的错误

> ID：540337
> 
> 赞同：0
> 
> 时间：2009-02-12T07:03:48.587
> 
> 标签：c++, windows, visual-studio-2005

我无法摆脱这些简单的错误，但如果有人能回答从这些错误中清除，我会非常满意。我包括 windows.h 和其他一些必要的标题，但无法摆脱它。

错误片段：

```
error C2146: syntax error : missing ';' before identifier 'MMVERSION' 
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int error C4430: missing type specifier - int assumed. Note: C++ does not support default-int error C2143: syntax error : missing ';' before '*' 
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int error C2146: syntax error : missing ';' before identifier 'ms' 
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T07:41:31.473

扩展安东的答案： windows.h `#define`s `UINT`to be `unsigned int`。那是 C 宏定义，而不是`typedef`. 如果您`#include windows.h`在您之前`#include mmsystem.h`，他指向的行将被读作：

```
typedef unsigned int MMVERSION; 
```

但是，如果您以错误的方式执行此操作，则 UINT 将扩展为空，该行将变为：

```
typedef MMVERSION; 
```

这不是有效的 C++，你会得到一个解析错误。这正是你得到的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T07:33:57.890

查看`mmsystem.h`第 112 和 113 行：

```
#ifdef _WIN32
typedef UINT        MMVERSION;  /* major (high byte), minor (low byte) */ 
```

所以一定要在 include`windows.h`之前include `mmsystem.h`，如果没有帮助，请`#define`手动`_WIN32`尝试。

# continuous-integration - 如何配置极端反馈设备来通知 CI 构建状态？

> ID：540338
> 
> 赞同：5
> 
> 时间：2009-02-12T07:04:02.970
> 
> 标签：continuous-integration, build-automation, extreme-feedback-devices

试图在找出设置熔岩灯或交通信号灯所需的东西或者你有什么（我相信这个术语是[极端反馈设备](http://www.developertesting.com/archives/month200404/20040401-eXtremeFeedbackForSoftwareDevelopment.html)）作为你持续集成构建状态的一个大可见指标时，会为下一个家伙/gal 省去一些麻烦。

[确保您的帖子包括......（请不​​要用富有想象力的](https://stackoverflow.com/questions/303614/whats-your-favorite-extreme-feedback-device/303901#303901) [回答](https://stackoverflow.com/questions/303614/whats-your-favorite-extreme-feedback-device/303728#303728)来搞砸这个问题......尽管在构思时它可能非常有趣）

*   XFD
*   需要什么“辅助”硬件
*   您设法连接的软件
*   有关如何设置的详细说明

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T22:22:02.863

Dirk Ziegelmeier 解释了他如何将 LED 条（XFD）连接到 CruiseControl.NET。他给出了他的连接软件的源代码，解释了要购买的硬件，甚至他对设备协议的重新设计结果：http: [//ziegelmeier.net/ ?q=XFD](http://ziegelmeier.net/?q=XFD)

在更高级的解释中，我们也在谈论我们的 XFD：http://schneide.wordpress.com/category/extreme-feedback/ [但是](http://schneide.wordpress.com/category/extreme-feedback/) 如果有人问，我们当然会提供更多细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T18:08:30.673

[在X10 Publisher](http://cruisecontrol.sourceforge.net/main/configxml.html#x10)的 CruiseControl 文档中实际上有非常详细的说明。

（Gishu 提到的 Mike Clark 的指示早于 X10 发布者成为基本 CruiseControl 发行版的一部分。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-21T06:36:01.810

嗨，我实现了一个非常简单且便宜（7 美元）的构建灯。在这里阅读它[。](http://funagile.wordpress.com/)无需定制硬件，并且可以在全球免费送货订购灯。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T07:30:08.337

## [使用 CruiseControl (java) 配置双熔岩灯](http://www.pragmaticautomation.com/cgi-bin/pragauto.cgi/Monitor/Devices/BubbleBubbleBuildsInTrouble.rdoc)(mike clark)

## [使用 Microsoft TFS 配置熔岩灯（或交通灯）](http://www.tfsbuild.com/ControlLavaLampsAndStreetLights.ashx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-21T19:20:51.990

以下是我们解决它的方法：LEDBLOA - [http://www.therealjoshanderson.com/2010/04/ledbloa-ftw-my-teams-new-build-status.html](http://www.therealjoshanderson.com/2010/04/ledbloa-ftw-my-teams-new-build-status.html)

这是一个非常简单的设置。LED 标志通过 USB 连接到笔记本电脑。笔记本电脑有一个小应用程序，可以简单地解析我们的 CI 服务器生成的 RSS 提要。我们轮询提要，看看是否有任何变化。如果是这样，我们更新标志。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-23T06:55:08.387

看一下这个：

[http://www.iprogrammable.com/2011/01/02/hudson-continuous-integration-led-message-board-monitor/](http://www.iprogrammable.com/2011/01/02/hudson-continuous-integration-led-message-board-monitor/)

![Jenkins/Hundson USB Led 留言板 CI 状态监视器](https://i.stack.imgur.com/vDkPp.png)

我用 20 美元的 USB LED 留言板设备做到了。它与 Jenkins/Hudson 相关联。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T03:18:09.837

[http://www.agiletoys.com](http://www.agiletoys.com)出售一个套件，其中包括一个红色信标和 x10 鞭炮套件。目前，Cruise Control 支持 x10，这是让团队知道构建以大可见方式损坏的好方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T23:11:15.897

*使用*并行端口来控制堆叠状态指示器非常容易。它们看起来像一堆会发光的冰球大小的镜片。通常用于工厂。附在机器上。可能有点贵。他们有一个红灯，一个绿灯等等......在堆栈中。有些与 CAN 总线通信，但便宜的只是灯。你给自己一个并行端口中继卡，和一个合适的插件包（壁疣）。最简单的事情是您所要做的就是向并行端口写一封信。设置位打开灯。

虽然不是很“极端”，（尽管可选的闪光灯和喇叭非常引人注目）

因为你不需要对并口做任何聪明的事，它可以是一个USB并口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-21T18:19:42.410

Continuous Lava 将监视 Continuum 或 Cruise Control 构建服务器并适当地发送 X10 信号以打开和关闭设备。它有相当好的设置说明。

这里还有一个安装程序，它将处理在 linux 上设置 RXTX：http: [//downloads.sourceforge.net/jmri/RXTX-install-5.tar.gz](http://downloads.sourceforge.net/jmri/RXTX-install-5.tar.gz)

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2014-03-02T08:35:06.750

这是另一个解决方案。我们想要远距离能见度并使用 LED 灯。

[www.mukthar.com/make-interesting-traffic-lights-continuous-integration-hudson-jenkins/](http://www.mukthar.com/make-interesting-traffic-lights-continuous-integration-hudson-jenkins/)

# php - 如何检查目录内容是否已随 PHP 更改？

> ID：540339
> 
> 赞同：26
> 
> 时间：2009-02-12T07:04:27.210
> 
> 标签：php, directory, last-modified, filemtime

我正在用 PHP 编写一个照片库脚本，并且有一个目录，用户将在其中存储他们的图片。我正在尝试设置页面缓存并仅在目录内容发生更改时才刷新缓存。我想我可以通过使用 filemtime() 函数缓存目录的最后修改时间并将其与目录的当前修改时间进行比较来做到这一点。但是，正如我已经意识到的那样，目录修改时间不会随着从该目录中添加或删除文件而改变（至少在 Windows 上，尚不确定 Linux 机器）。

所以我的问题是，检查目录内容是否已被修改的最简单方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-12T12:06:00.933

正如其他人已经提到的，解决此问题的更好方法是在发生特定事件时触发一个函数，该函数会更改文件夹。但是，如果您的服务器是 unix，您可以使用`inotifywait`监视目录，然后调用 PHP 脚本。

这是一个简单的例子：

```
#!/bin/sh
inotifywait --recursive --monitor --quiet --event modify,create,delete,move --format '%f' /path/to/directory/to/watch |
  while read FILE ; do
    php /path/to/trigger.php $FILE
  done 
```

另见： http: [//linux.die.net/man/1/inotifywait](http://linux.die.net/man/1/inotifywait)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-12T10:25:00.410

在用户提交了他的图像后[触摸](http://php.net/manual/en/function.touch.php)目录怎么样？Changelog 说：Windows 需要 php 5.3 才能工作，但我认为它应该适用于所有其他环境

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-07-20T20:12:56.503

在 php 中使用 inotifywait

```
$watchedDir = 'watch';

$in = popen("inotifywait --monitor --quiet --format '%e %f' --event create,moved_to '$watchedDir'", 'r');
if ($in === false)
    throw new Exception ('fail start notify');

while (($line = fgets($in)) !== false) 
{
    list($event, $file) = explode(' ', rtrim($line, PHP_EOL), 2);
    echo "$event $file\n";
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-25T21:26:25.577

呃。我只是存储目录列表的 md5。如果内容改变，md5(directory-listing) 会改变。您*可能会*遇到非常偶然的 md5 冲突，但我认为这种可能性很小。
或者，您可以在该目录中存储一个包含“最后修改”日期的小文件。但我会选择 md5。

* * *

PS。再三考虑，看看您如何看待请求和散列目录列表的性能（缓存）可能不是完全最佳的..

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-12T07:28:03.550

这是你可以尝试的。将所有图片存储在单个目录中（或在其中的`/username`子目录中以加快速度并减轻对 FS 的压力）并设置 Apache（或您正在使用的任何东西）以将它们作为静态内容提供“过期”设定为未来 100 年。文件名应包含一些唯一的前缀或后缀（时间戳、文件内容的 SHA1 哈希等），因此每当使用更改时，文件名都会更改，Apache 将提供一个新版本，该版本将在此过程中被缓存。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-12T08:10:35.600

你想错了。

有人上传新文件并将其移动到目标位置后，您应该立即执行目录索引器脚本。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-12-13T10:13:48.127

IMO [edubem 的答案](https://stackoverflow.com/questions/540339/how-to-check-if-directory-contents-has-changed-with-php/540728#540728)是要走的路，但是您可以执行以下操作：

```
if (sha1(serialize(Map('/path/to/directory/', true))) != /* previous stored hash */)
{
    // directory contents has changed
} 
```

或者更弱/更快的版本：

```
if (Size('/path/to/directory/', true) != /* previous stored size */)
{
    // directory contents has changed
} 
```

以下是使用的功能：

```
function Map($path, $recursive = false)
{
    $result = array();

    if (is_dir($path) === true)
    {
        $path = Path($path);
        $files = array_diff(scandir($path), array('.', '..'));

        foreach ($files as $file)
        {
            if (is_dir($path . $file) === true)
            {
                $result[$file] = ($recursive === true) ? Map($path . $file, $recursive) : $this->Size($path . $file, true);
            }

            else if (is_file($path . $file) === true)
            {
                $result[$file] = Size($path . $file);
            }
        }
    }

    else if (is_file($path) === true)
    {
        $result[basename($path)] = Size($path);
    }

    return $result;
}

function Size($path, $recursive = true)
{
    $result = 0;

    if (is_dir($path) === true)
    {
        $path = Path($path);
        $files = array_diff(scandir($path), array('.', '..'));

        foreach ($files as $file)
        {
            if (is_dir($path . $file) === true)
            {
                $result += ($recursive === true) ? Size($path . $file, $recursive) : 0;
            }

            else if (is_file() === true)
            {
                $result += sprintf('%u', filesize($path . $file));
            }
        }
    }

    else if (is_file($path) === true)
    {
        $result += sprintf('%u', filesize($path));
    }

    return $result;
}

function Path($path)
{
    if (file_exists($path) === true)
    {
        $path = rtrim(str_replace('\\', '/', realpath($path)), '/');

        if (is_dir($path) === true)
        {
            $path .= '/';
        }

        return $path;
    }

    return false;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T11:50:45.680

当用户将文件上传到他的目录时，请尝试删除缓存版本。

当有人尝试查看图库时，请先查看是否有缓存版本。如果有缓存版本，则加载它，否则，生成页面，缓存它，完成。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-13T09:01:46.267

我一直在寻找类似的东西，但我发现了这个：

[http://www.franzone.com/2008/06/05/php-script-to-monitor-ftp-directory-changes/](http://www.franzone.com/2008/06/05/php-script-to-monitor-ftp-directory-changes/)

对我来说，这似乎是一个很好的解决方案，因为我将拥有很多控制权（我将进行 AJAX 调用以查看是否有任何变化）。

希望这会有所帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-11-09T08:20:32.083

这是一个代码示例，如果目录被更改，它将返回 0。我在备份中使用它。

更改的状态取决于文件的存在及其文件大小。您可以轻松更改它，通过替换来比较文件内容

```
$longString .= filesize($file); 
```

和

```
$longString .= crc32(file_get_contents($file)); 
```

但会影响执行速度。

```
#!/usr/bin/php
<?php

$dirName = $argv[1];
$basePath = '/var/www/vhosts/majestichorseporn.com/web/';
$dataFile = './backup_dir_if_changed.dat';

# startup checks
if (!is_writable($dataFile))
    die($dataFile . ' is not writable!');

if (!is_dir($basePath . $dirName))
    die($basePath . $dirName . ' is not a directory');

$dataFileContent = file_get_contents($dataFile);
$data = @unserialize($dataFileContent);
if ($data === false)
    $data = array();

# find all files ang concatenate their sizes to calculate crc32
$files = glob($basePath . $dirName . '/*', GLOB_BRACE);

$longString = '';
foreach ($files as $file) {
    $longString .= filesize($file);
}
$longStringHash = crc32($longString);

# do changed check
if (isset ($data[$dirName]) && $data[$dirName] == $longStringHash)
    die('Directory did not change.');

# save hash do DB
$data[$dirName] = $longStringHash;

file_put_contents($dataFile, serialize($data));
die('0'); 
```

# c# - WCF 推荐序列化多个对象的方法

> ID：540340
> 
> 赞同：2
> 
> 时间：2009-02-12T07:22:04.593
> 
> 标签：c#, .net, wcf, serialization

我正在尝试围绕可能的瓶颈进行优化。

我有一个服务器应用程序，它从数据库远程向应用程序提供对象，他们可以使用 1 - n 个不同类型的对象（其中 n 可以是一个相对较高的数字），它们都实现了一个通用接口，但可能包含许多不同类型的独特属性。

客户端应用程序将服务器对象存储在本地缓存中，直到它们准备好通过服务器将它们持久化回数据库。

这是目前在 WCF 中完成的，每个类都定义了一个 DataContract。

由于可能需要将大量对象传递回服务器（它会根据实现而变化），我宁愿不再将这些都作为单独的调用来执行，而是将所有对象包装在一个序列化的 (或更好的压缩）流并将它们作为一个连接发送到服务器。

我可以很简单地推出自己的方法，但更愿意使用推荐的方法，并希望有人可以提出建议。如果你能说服我，我也愿意接受我的方法可能不是最好的主意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T08:07:44.267

“相对高”有多高？

例如，发生的一种选择是使用包装对象：

```
[DataContract]
public class Wrapper {
    [DataMember(Order = 1)]
    public List<Foo> Foos {get {...}}

    [DataMember(Order = 2)]
    public List<Bar> Bars {get {...}}

    [DataMember(Order = 3)]
    public List<Blop> Blops {get {...}}
} 
```

然后，您应该能够发送一条包含任意数量的`Foo`和`Bar`/或`Blop`记录的消息。我包含该`Order`属性是经过深思熟虑的——如果你想减小流的大小，你可以考虑使用[protobuf-net——](http://code.google.com/p/protobuf-net/)通过上述布局，protobuf-net 可以简单地通过包含`[ProtoBehavior]`方法（在操作合同中）挂钩到 WCF接口）要攻击的（在客户端和服务器上）。这会将传输切换为使用 google 的“协议缓冲区”二进制格式，使用 base-64 进行编码。如果您使用的是 basic-http 绑定，如果启用，这也可以使用 MTOM，因此即使 base-64 也不是问题。使用它，您可以获得[显着的数据传输节省](http://code.google.com/p/protobuf-net/wiki/Performance)（根据显示的数字，大约是空间的 1/5）。

（编辑 1 - protobuf-net 假定`Foo`,`Bar`并且`Blop` *还*使用该`Order`属性）

（编辑 2 - 请注意，您始终可以将请求分解为许多中等大小的`Wrapper`消息，然后在服务器上拥有它们后调用一个方法来应用所有更改（大概在数据库中的临时表中））

# python - Python 3.0 urllib.parse 错误“类型 str 不支持缓冲区 API”

> ID：540342
> 
> 赞同：23
> 
> 时间：2009-02-12T07:24:05.930
> 
> 标签：python, cgi, python-3.x, urllib

```
 File "/usr/local/lib/python3.0/cgi.py", line 477, in __init__
    self.read_urlencoded()
  File "/usr/local/lib/python3.0/cgi.py", line 577, in read_urlencoded
    self.strict_parsing):
  File "/usr/local/lib/python3.0/urllib/parse.py", line 377, in parse_qsl
    pairs = [s2 for s1 in qs.split('&') for s2 in s1.split(';')]
TypeError: Type str doesn't support the buffer API 
```

谁能指导我如何避免这种情况？我通过将数据输入到中来获得它`cgi.Fieldstorage`，我似乎无法以任何其他方式做到这一点。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-12T16:14:50.133

urllib 正在尝试做：

```
b'a,b'.split(',') 
```

这是行不通的。字节字符串和 unicode 字符串在 Py3k 中的混合比以前更不流畅——故意让编码问题早点而不是晚点出错。

所以错误是相当不透明地告诉你'你不能将字节字符串传递给 urllib.parse'。大概你正在做一个 POST 请求，其中表单编码的字符串作为内容体进入 cgi；内容主体仍然是字节字符串/流，因此它现在与新的 urllib 冲突。

所以，是的，这是 cgi.py 中的一个错误，也是 2to3 转换的另一个受害者，尚未针对新的字符串模型正确修复。它应该将传入的字节流转换为字符，然后再将它们传递给 urllib。

我有没有提到 Python 3.0 的库（尤其是与 Web 相关的库）仍然相当陈旧？:-)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-01-29T01:13:39.583

从 python 教程（[http://www.python.org/doc/3.0/tutorial/stdlib.html](http://www.python.org/doc/3.0/tutorial/stdlib.html)）有一个使用 urlopen 方法的例子。它引发了同样的错误。

```
for line in urlopen('http://tycho.usno.navy.mil/cgi-bin/timer.pl'):
    if 'EST' in line or 'EDT' in line:  # look for Eastern Time
        print(line) 
```

您需要使用 str 函数将字节 thingo 转换为具有正确编码的字符串。如下：

```
for line in urlopen('http://tycho.usno.navy.mil/cgi-bin/timer.pl'):
    lineStr = str( line, encoding='utf8' )
    if 'EST' in lineStr or 'EDT' in lineStr:  # look for Eastern Time
        print(lineStr) 
```

# visual-studio-2008 - 有没有办法让 Visual Studio 2008 停止格式化我的 AutoProperties？

> ID：540344
> 
> 赞同：2
> 
> 时间：2009-02-12T07:26:40.217
> 
> 标签：visual-studio-2008, code-formatting, automatic-properties

在 Visual Studio 2008 的 Options > Text Editor > C# > Formatting 中，我勾选了以下设置。

*   自动格式化完成的语句；

*   在 } 上自动格式化完成的块

这在我编写方法或 for/foreach/while/if 语句时非常有用。

即如果我写

```
void MyMethod(){} 
```

我希望它在我输入最后一个 } 时将其重新格式化为以下格式

```
void MyMethod()
{
} 
```

但是，当我写：

```
bool MyProperty { get; set; } 
```

我希望它保持这种状态，而不是改为：

```
bool MyProperty 
{ 
    get; 
    set; 
} 
```

无论如何，我能做到这一点还是我在做梦？我能想到的唯一方法是关闭这两个设置……但这只会导致烦恼转移到我编写方法和 if 语句等时。

更新：只是想我会提到我使用 Resharper ......所以如果有办法通过那里完成它，我也会有兴趣知道这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T07:39:55.723

你确定这是VS2008的问题吗？因为我的汽车属性保持不变...

给...

```
bool MyProperty { get; set; } 
```

它保持为...

```
bool MyProperty { get; set; } 
```

即使在我应用格式选择命令之后。

注意：我选择了与您相同的 VS 格式选项。虽然我使用的是 VS2008 SP1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T07:44:39.143

惊人的！我设法弄清楚了。多亏了[Anton](https://stackoverflow.com/questions/540344/is-there-a-way-to-get-visual-studio-2008-to-stop-formatting-my-autoproperties/540353#540353)，我仔细查看了 Resharper 中可用的设置，我能够弄清楚一些事情。

我的解决方案涉及 Resharper 和 VS2008 中的设置组合。

在 VS2008 中，我关闭 Automatically format completed statement on ;

然后我在 Resharper 中打开 IntelliSense Completion Behavior 的设置以在完成后自动插入括号。

这允许我输入：

```
bool MyProperty { 
```

要得到：

```
bool MyProperty {} 
```

然后允许我添加获取；并设置；没有它们格式化的行...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T07:30:45.557

ReSharper 可能有这样的功能，但我不确定。

# ios - 如何从 Xib 文件中加载自定义 UITableViewCells？

> ID：540345
> 
> 赞同：300
> 
> 时间：2009-02-12T07:27:47.390
> 
> 标签：ios, uitableview, object, cocoa-touch, xib

问题很简单：如何`UITableViewCell`从 Xib 文件加载自定义？这样做允许您使用 Interface Builder 来设计您的单元格。由于内存管理问题，答案显然并不简单。[该线程](https://stackoverflow.com/questions/134575/using-interface-builder-for-uitableviews)提到了该问题并提出了解决方案，但它是 NDA 发布之前的版本并且缺少代码。这是一个[很长的帖子](http://discussions.apple.com/thread.jspa?messageID=8040526&tstart=0)，讨论了这个问题，但没有提供明确的答案。

这是我使用过的一些代码：

```
static NSString *CellIdentifier = @"MyCellIdentifier";

MyCell *cell = (MyCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:CellIdentifier owner:self options:nil];
    cell = (MyCell *)[nib objectAtIndex:0];
} 
```

要使用此代码，请创建 MyCell.m/.h，它是您想要的组件的新子类`UITableViewCell`并添加`IBOutlets`。然后创建一个新的“空 XIB”文件。在 IB 中打开 Xib 文件，添加一个`UITableViewCell`对象，将其标识符设置为“MyCellIdentifier”，并将其类设置为 MyCell 并添加您的组件。最后，连接`IBOutlets`到组件。请注意，我们没有在 IB 中设置文件的所有者。

其他方法提倡设置文件的所有者，如果 Xib 没有通过额外的工厂类加载，则会警告内存泄漏。我在 Instruments/Leaks 下测试了上述内容，没有发现内存泄漏。

那么从 Xibs 加载单元的规范方法是什么？我们设置文件的所有者吗？我们需要工厂吗？如果是这样，工厂的代码是什么样的？如果有多种解决方案，让我们澄清每个解决方案的优缺点......

* * *

## 回答 #1

> 赞同：307
> 
> 时间：2012-11-29T15:57:55.947

正确的解决方案是这样的：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UINib *nib = [UINib nibWithNibName:@"ItemCell" bundle:nil];
    [[self tableView] registerNib:nib forCellReuseIdentifier:@"ItemCell"];
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Create an instance of ItemCell
    PointsItemCell *cell = [tableView dequeueReusableCellWithIdentifier:@"ItemCell"];

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：293
> 
> 时间：2009-12-21T10:19:35.617

[以下是原作者陈述的 IB 工程师推荐的](http://www.bdunagan.com/2009/06/28/custom-uitableviewcell-from-a-xib-in-interface-builder/)两种方法。

有关更多详细信息，请参阅实际帖子。我更喜欢方法#2，因为它看起来更简单。

**方法#1：**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"BDCustomCell"];
    if (cell == nil) {
        // Create a temporary UIViewController to instantiate the custom cell.
        UIViewController *temporaryController = [[UIViewController alloc] initWithNibName:@"BDCustomCell" bundle:nil];
        // Grab a pointer to the custom cell.
        cell = (BDCustomCell *)temporaryController.view;
        [[cell retain] autorelease];
        // Release the temporary UIViewController.
        [temporaryController release];
    }

    return cell;
} 
```

**方法#2：**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"BDCustomCell"];
    if (cell == nil) {
        // Load the top-level objects from the custom cell XIB.
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"BDCustomCell" owner:self options:nil];
        // Grab a pointer to the first object (presumably the custom cell, as that's all the XIB should contain).
        cell = [topLevelObjects objectAtIndex:0];
    }

    return cell;
} 
```

**更新（2014 年）：** 方法 #2 仍然有效，但不再有相关文档。它曾经在[官方文档](https://developer.apple.com/documentation/uikit/views_and_controls/table_views?language=objc)中，但现在被删除以支持故事板。

我在 Github 上发布了一个工作示例：
[https ://github.com/bentford/NibTableCellExample](https://github.com/bentford/NibTableCellExample)

**为 Swift 4.2 编辑**

```
override func viewDidLoad() {
    super.viewDidLoad()

    // Do any additional setup after loading the view.
    self.tblContacts.register(UINib(nibName: CellNames.ContactsCell, bundle: nil), forCellReuseIdentifier: MyIdentifier)
}

func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {

    let cell = tableView.dequeueReusableCell(withIdentifier: MyIdentifier, for: indexPath) as! ContactsCell

    return cell
} 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-05-21T01:47:02.100

### 登记

在 iOS 7 之后，这个过程被简化为（**swift 3.0**）：

```
// For registering nib files
tableView.register(UINib(nibName: "MyCell", bundle: Bundle.main), forCellReuseIdentifier: "cell")

// For registering classes
tableView.register(MyCellClass.self, forCellReuseIdentifier: "cell") 
```

> （**注意**）这也可以通过在`.xib`or`.stroyboard`文件中创建单元格作为原型单元格来实现。如果你需要给它们附加一个类，你可以选择单元格原型并添加相应的类（`UITableViewCell`当然必须是 的后代）。

### 出队

稍后，使用（**swift 3.0**）出列：

```
override func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell
{
    let cell : UITableViewCell = tableView.dequeueReusableCell(withIdentifier: "cell", for: indexPath)

    cell.textLabel?.text = "Hello"

    return cell
} 
```

不同之处在于，这种新方法不仅使单元格出列，它还会创建不存在的单元格（这意味着您不必做`if (cell == nil)`恶作剧），并且单元格已准备好使用，就像上面的示例一样。

> （**警告**）`tableView.dequeueReusableCell(withIdentifier:for:)`有新的行为，如果你调用另一个（没有`indexPath:`）你会得到旧的行为，你需要自己检查`nil`并实例化它，注意`UITableViewCell?`返回值。

```
if let cell = tableView.dequeueReusableCell(withIdentifier: "cell", for: indexPath) as? MyCellClass
{
    // Cell be casted properly
    cell.myCustomProperty = true
}
else
{
    // Wrong type? Wrong identifier?
} 
```

当然，单元的关联类的类型是您在 .xib 文件中为`UITableViewCell`子类定义的类型，或者使用其他注册方法。

### 配置

理想情况下，您的单元格在您注册它们时已经在外观和内容定位（如标签和图像视图）方面进行了配置，并且`cellForRowAtIndexPath`您只需填写它们。

# 全部一起

```
class MyCell : UITableViewCell
{
    // Can be either created manually, or loaded from a nib with prototypes
    @IBOutlet weak var labelSomething : UILabel? = nil
}

class MasterViewController: UITableViewController 
{
    var data = ["Hello", "World", "Kinda", "Cliche", "Though"]

    // Register
    override func viewDidLoad()
    {
        super.viewDidLoad()

        tableView.register(MyCell.self, forCellReuseIdentifier: "mycell")
        // or the nib alternative
    }

    override func tableView(tableView: UITableView, numberOfRowsInSection section: Int) -> Int
    {
        return data.count
    }

    // Dequeue
    override func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell
    {
        let cell = tableView.dequeueReusableCell(withIdentifier: "mycell", for: indexPath) as! MyCell

        cell.labelSomething?.text = data[indexPath.row]

        return cell
    }
} 
```

当然，这在 ObjC 中都可以使用相同的名称。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2010-06-22T02:15:10.500

接受了 Shawn Craver 的答案并对其进行了一些清理。

BBCell.h：

```
#import <UIKit/UIKit.h>

@interface BBCell : UITableViewCell {
}

+ (BBCell *)cellFromNibNamed:(NSString *)nibName;

@end 
```

BBCell.m:

```
#import "BBCell.h"

@implementation BBCell

+ (BBCell *)cellFromNibNamed:(NSString *)nibName {
    NSArray *nibContents = [[NSBundle mainBundle] loadNibNamed:nibName owner:self options:NULL];
    NSEnumerator *nibEnumerator = [nibContents objectEnumerator];
    BBCell *customCell = nil;
    NSObject* nibItem = nil;
    while ((nibItem = [nibEnumerator nextObject]) != nil) {
        if ([nibItem isKindOfClass:[BBCell class]]) {
            customCell = (BBCell *)nibItem;
            break; // we have a winner
        }
    }
    return customCell;
}

@end 
```

我把我所有的 UITableViewCell 的 BBCell 子类，然后替换标准

```
cell = [[[BBDetailCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"BBDetailCell"] autorelease]; 
```

和：

```
cell = (BBDetailCell *)[BBDetailCell cellFromNibNamed:@"BBDetailCell"]; 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-03-19T21:41:43.147

我使用了本特福德的**方法 #2**：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"BDCustomCell"];
    if (cell == nil) {
        // Load the top-level objects from the custom cell XIB.
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"BDCustomCell" owner:self options:nil];
        // Grab a pointer to the first object (presumably the custom cell, as that's all the XIB should contain).
        cell = [topLevelObjects objectAtIndex:0];
    }

    return cell;
} 
```

**它可以工作，但请注意在您的自定义 UITableViewCell .xib 文件中与*文件所有者的连接。***

通过传入`owner:self`您的`loadNibNamed`声明，您`UITableViewController`将`UITableViewCell`.

如果你拖放到IB中的头文件来设置动作和出口，它会默认将它们设置为文件的所有者。

在`loadNibNamed:owner:options`中，Apple 的代码将尝试在您的 上设置属性`UITableViewController`，因为那是所有者。但是你没有在那里定义这些属性，所以你会得到一个关于*键值编码兼容*的错误：

```
*** Terminating app due to uncaught exception 'NSUnknownKeyException', reason:     '[<MyUITableViewController 0x6a383b0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key myLabel.' 
```

如果一个事件被触发，你会得到一个 NSInvalidArgumentException：

```
-[MyUITableViewController switchValueDidChange:]: unrecognized selector sent to instance 0x8e9acd0
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[MyUITableViewController switchValueDidChange:]: unrecognized selector sent to instance 0x8e9acd0'
*** First throw call stack:
(0x1903052 0x15eed0a 0x1904ced 0x1869f00 0x1869ce2 0x1904ec9 0x5885c2 0x58855a 0x62db76 0x62e03f 0x77fa6c 0x24e86d 0x18d7966 0x18d7407 0x183a7c0 0x1839db4 0x1839ccb 0x1f8b879 0x1f8b93e 0x585a9b 0xb904d 0x2c75)
terminate called throwing an exceptionCurrent language:  auto; currently objective-c 
```

**一个简单的解决方法是将您的 Interface Builder 连接指向`UITableViewCell`而不是 File's Owner：**

1.  右键单击文件所有者以拉出连接列表
2.  使用 Command-Shift-4 进行屏幕截图（拖动以选择要捕获的区域）
3.  x 从文件所有者的连接中删除
4.  右键单击对象层次结构中的 UITableCell 并重新添加连接。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-08-26T08:18:23.720

我决定发布，因为我不喜欢这些答案中的任何一个——事情总是更简单，这是迄今为止我发现的最简洁的方式。

**1\. 根据需要在 Interface Builder 中构建 Xib**

*   将文件的所有者设置为类 NSObject
*   添加一个 UITableViewCell 并将其类设置为 MyTableViewCellSubclass - 如果您的 IB 崩溃（在撰写本文时发生在 Xcode > 4 中），如果您仍然放置在 Xcode 4 中的界面，只需使用 UIView
*   将您的子视图布局在此单元格内，并将您的 IBOutlet 连接附加到 .h 或 .m 中的 @interface（.m 是我的偏好）

**2\. 在你的 UIViewController 或 UITableViewController 子类中**

```
@implementation ViewController

static NSString *cellIdentifier = @"MyCellIdentier";

- (void) viewDidLoad {

    ...
    [self.tableView registerNib:[UINib nibWithNibName:@"MyTableViewCellSubclass" bundle:nil] forCellReuseIdentifier:cellIdentifier];
}

- (UITableViewCell*) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    MyTableViewCellSubclass *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    ...

    return cell;
} 
```

**3\. 在你的 MyTableViewCellSubclass**

```
- (id) initWithCoder:(NSCoder *)aDecoder {
    if (self = [super initWithCoder:aDecoder]) {
        ...
    }

    return self;
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-04-28T10:55:12.313

如果您使用 Interface Builder 制作单元格，请检查您是否已在 Inspector 中设置了 Identifier。然后在调用dequeueReusableCellWithIdentifier时检查是否相同。

我不小心忘记在一个繁重的项目中设置一些标识符，性能变化就像白天和黑夜一样。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-02-12T14:19:18.803

从 XIB 加载 UITableViewCells 可以节省大量代码，但通常会导致滚动速度非常糟糕（实际上，不是 XIB 而是过度使用 UIViews 导致了这种情况）。

我建议你看看这个：[链接参考](http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview/)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-12T13:47:41.843

这是我一直用来从 XIB 中创建自定义单元格的类方法：

```
+ (CustomCell*) createNewCustomCellFromNib {

    NSArray* nibContents = [[NSBundle mainBundle]
                            loadNibNamed:@"CustomCell" owner:self options:NULL];

    NSEnumerator *nibEnumerator = [nibContents objectEnumerator];
    CustomCell *customCell= nil;
    NSObject* nibItem = nil;

    while ( (nibItem = [nibEnumerator nextObject]) != nil) {

        if ( [nibItem isKindOfClass: [CustomCell class]]) {
            customCell = (CustomCell*) nibItem;

            if ([customCell.reuseIdentifier isEqualToString: @"CustomCell"]) {
                break; // we have a winner
            }
            else
                fuelEntryCell = nil;
        }
    }
    return customCell;
} 
```

然后，在 XIB 中，我设置了类名，并重用了标识符。之后，我可以在我的视图控制器中调用该方法，而不是

```
[[UITableViewCell] alloc] initWithFrame:] 
```

它足够快，并且在我的两个运输应用程序中使用。它比 call 更可靠`[nib objectAtIndex:0]`，至少在我看来，比 Stephan Burlot 的示例更可靠，因为你保证只能从正确类型的 XIB 中获取视图。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-09-07T08:33:20.750

正确的解决方案是这个

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [self.tableView registerNib:[UINib nibWithNibName:@"CustomCell" bundle:[NSBundle mainBundle]] forCellReuseIdentifier:@"CustomCell"];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    UITableViewCell  *cell = [tableView dequeueReusableCellWithIdentifier:@"CustomCell"];
    return cell; 
    } 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-12-14T19:01:17.143

重新加载 NIB 是昂贵的。最好加载一次，然后在需要单元格时实例化对象。请注意，您可以使用此方法将 UIImageViews 等添加到 nib，甚至多个单元格（Apple 的“registerNIB”iOS5 只允许一个顶级对象 - 错误 10580062“iOS5 tableView registerNib：过度限制”

所以我的代码在下面——你在NIB中读过一次（像我一样初始化或在viewDidload中——不管怎样。从那时起，你将笔尖实例化为对象，然后选择你需要的对象。这比加载笔尖效率高得多一遍又一遍。

```
static UINib *cellNib;

+ (void)initialize
{
    if(self == [ImageManager class]) {
        cellNib = [UINib nibWithNibName:@"ImageManagerCell" bundle:nil];
        assert(cellNib);
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellID = @"TheCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellID];
    if(cell == nil) {
        NSArray *topLevelItems = [cellNib instantiateWithOwner:nil options:nil];
        NSUInteger idx = [topLevelItems indexOfObjectPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop)
                            {
                                UITableViewCell *cell = (UITableViewCell *)obj;
                                return [cell isKindOfClass:[UITableViewCell class]] && [cell.reuseIdentifier isEqualToString:cellID];
                            } ];
        assert(idx != NSNotFound);
        cell = [topLevelItems objectAtIndex:idx];
    }
    cell.textLabel.text = [NSString stringWithFormat:@"Howdie %d", indexPath.row];

    return cell;
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-07-09T09:18:23.800

检查这个 - [http://eppz.eu/blog/custom-uitableview-cell/](http://eppz.eu/blog/custom-uitableview-cell/) - 使用一个小类的非常方便的方法，它在控制器实现中结束了一行：

```
-(UITableViewCell*)tableView:(UITableView*) tableView cellForRowAtIndexPath:(NSIndexPath*) indexPath
{
    return [TCItemCell cellForTableView:tableView
                          atIndexPath:indexPath
                      withModelSource:self];
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/TZEB3.png)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-12T18:01:41.827

我为此做的是`IBOutlet UITableViewCell *cell`在你的控制器类中声明一个。然后调用`NSBundle loadNibNamed`类方法，它将提供给`UITableViewCell`上面声明的单元格。

对于 xib，我将创建一个空的 xib 并将`UITableViewCell`对象添加到 IB 中，可以根据需要进行设置。这个视图然后连接到`IBOutlet`控制器类中的单元。

```
- (UITableViewCell *)tableView:(UITableView *)table
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"%@ loading RTEditableCell.xib", [self description] );

    static NSString *MyIdentifier = @"editableCellIdentifier";
    cell = [table dequeueReusableCellWithIdentifier:MyIdentifier];

    if(cell == nil) {
        [[NSBundle mainBundle] loadNibNamed:@"RTEditableCell"
                                      owner:self
                                    options:nil];
    }

    return cell;
} 
```

[NSBundle 添加 loadNibNamed（ADC 登录）](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSBundle_AppKitAdditions/Reference/Reference.html#//apple_ref/doc/uid/20000401-CJBHHDFC)

[cocoawithlove.com 文章我从（获取电话号码示例应用程序）中获取了这个概念](http://cocoawithlove.com/2008/12/heterogeneous-cells-in.html)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-06-28T21:57:26.280

正确的做法是创建一个 UITableViewCell 子类实现、标头和 XIB。在 XIB 中删除所有视图并添加一个表格单元格。将类设置为 UITableViewCell 子类的名称。对于文件所有者，将其设为 UITableViewController 子类类名。使用 tableViewCell 插座将文件所有者连接到单元格。

在头文件中：

```
UITableViewCell *_tableViewCell;
@property (assign) IBOutlet UITableViewCell *tableViewCell; 
```

在实现文件中：

```
@synthesize tableViewCell = _tableViewCell;

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *kCellIdentifier = @"reusableCell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:kCellIdentifier];
    if (cell == nil) {
        [[NSBundle mainBundle] loadNibNamed:kCellIdentifier owner:self options:nil];
        cell = _tableViewCell;
        self.tableViewCell = nil;
    }

    return cell;
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-09-07T04:07:19.123

1.  创建您自己的自定义类`AbcViewCell`子类`UITableViewCell`（确保您的类文件名和 nib 文件名相同）

2.  创建此扩展类方法。

    ```
    extension UITableViewCell {
        class func fromNib<T : UITableViewCell>() -> T {
            return Bundle.main.loadNibNamed(String(describing: T.self), owner: nil, options: nil)?[0] as! T
        }
    } 
    ```

3.  用它。

    `let cell: AbcViewCell = UITableViewCell.fromNib()`

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-02-26T06:48:40.073

首先导入您的自定义单元格文件`#import "CustomCell.h"`，然后更改委托方法，如下所述：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *simpleTableIdentifier = @"CustomCell";

CustomCell *cell = (CustomCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];
if (cell == nil)
{
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CustomCell" owner:self options:nil];
    cell = [nib objectAtIndex:0];

    [cell setSelectionStyle:UITableViewCellSelectionStyleNone];
}         

     return cell;
} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-10-12T07:02:15.270

在**Swift 4.2**和 Xcode 10中

我有三个 XIB 单元文件

在 ViewDidLoad 中像这样注册您的 XIB 文件...

这是第一种方法

```
tableView.register(UINib.init(nibName: "XIBCell", bundle: nil), forCellReuseIdentifier: "cell1")
tableView.register(UINib.init(nibName: "XIBCell2", bundle: nil), forCellReuseIdentifier: "cell2")
//tableView.register(UINib.init(nibName: "XIBCell3", bundle: nil), forCellReuseIdentifier: "cell3") 
```

**第二种方法直接在cellForRowAt indexPath**中注册 XIB 文件：

 **这是我的 tableview 委托函数

```
//MARK: - Tableview delegates
override func numberOfSections(in tableView: UITableView) -> Int {

    return 1
}

override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {

    return 6
}

override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    //This is first approach
    if indexPath.row == 0 {//Load first XIB cell
        let placeCell = tableView.dequeueReusableCell(withIdentifier: "cell1") as! XIBCell
        return placeCell
    //Second approach
    } else if indexPath.row == 5 {//Load XIB cell3
        var cell = tableView.dequeueReusableCell(withIdentifier:"cell3") as? XIBCell3
        if cell == nil{
            let arrNib:Array = Bundle.main.loadNibNamed("XIBCell3",owner: self, options: nil)!
            cell = arrNib.first as? XIBCell3
        }

        //ADD action to XIB cell button
        cell?.btn.tag = indexPath.row//Add tag to button
        cell?.btn.addTarget(self, action: #selector(self.bookbtn1(_:)), for: .touchUpInside);//selector

        return cell!
    //This is first approach
    } else {//Load XIB cell2
        let placeCell = tableView.dequeueReusableCell(withIdentifier: "cell2") as! XIBCell2

        return placeCell
    }

} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-03-24T11:51:19.390

这是我的方法：[从 XIB 文件中加载自定义 UITableViewCells……还有另一种方法](http://www.atelierdumobile.com/blog/2011/03/24/loading-custom-uitableviewcells-from-xib-files-yet-another-method/)

这个想法是为您需要从代码配置的每个自定义子视图创建一个`UITableViewCell`具有属性和属性的 SampleCell 子类。`IBOutlet UIView *content`然后创建一个 SampleCell.xib 文件。在此 nib 文件中，将文件所有者更改为 SampleCell。添加`UIView`大小以满足您的需求的内容。添加和配置您想要的所有子视图（标签、图像视图、按钮等）。最后，将内容视图和子视图链接到文件所有者。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-08-18T08:08:37.317

这是在 中注册单元格的通用方法`UITableView`：

```
protocol Reusable {
    static var reuseID: String { get }
}

extension Reusable {
    static var reuseID: String {
        return String(describing: self)
    }
}

extension UITableViewCell: Reusable { }

extension UITableView {

func register<T: UITableViewCell>(cellClass: T.Type = T.self) {
    let bundle = Bundle(for: cellClass.self)
    if bundle.path(forResource: cellClass.reuseID, ofType: "nib") != nil {
        let nib = UINib(nibName: cellClass.reuseID, bundle: bundle)
        register(nib, forCellReuseIdentifier: cellClass.reuseID)
    } else {
        register(cellClass.self, forCellReuseIdentifier: cellClass.reuseID)
    }
} 
```

解释：

1.  `Reusable`协议根据其类名生成单元 ID。确保您遵守约定：`cell ID == class name == nib name`.
2.  `UITableViewCell`符合`Reusable`协议。
3.  `UITableView`扩展通过 nib 或 class 抽象出注册单元格的差异。

使用示例：

```
override func viewDidLoad() {
    super.viewDidLoad()
    let tableView = UITableView()
    let cellClasses: [UITableViewCell.Type] = [PostCell.self, ProfileCell.self, CommentCell.self]
    cellClasses.forEach(tableView.register)
}

override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    let cell = tableView.dequeueReusableCell(withIdentifier: PostCell.self.reuseID) as? PostCell
    ...
    return cell
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-12T09:03:16.520

我不知道是否有规范的方法，但这是我的方法：

*   为 ViewController 创建一个 xib
*   将文件所有者类设置为 UIViewController
*   删除视图并添加一个 UITableViewCell
*   将您的 UITableViewCell 的 Class 设置为您的自定义类
*   设置你的 UITableViewCell 的标识符
*   将视图控制器视图的出口设置为 UITableViewCell

并使用此代码：

```
MyCustomViewCell *cell = (MyCustomViewCell *)[_tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
  UIViewController* c = [[UIViewController alloc] initWithNibName:CellIdentifier bundle:nil];
  cell = (MyCustomViewCell *)c.view;
  [c release];
} 
```

在您的示例中，使用

```
[nib objectAtIndex:0] 
```

如果 Apple 更改 xib 中项目的顺序，可能会中断。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-06-11T06:38:13.617

```
 NSString *CellIdentifier = [NSString stringWithFormat:@"cell %ld %ld",(long)indexPath.row,(long)indexPath.section];

    NewsFeedCell *cell = (NewsFeedCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    cell=nil;

    if (cell == nil)
    {
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"NewsFeedCell" owner:nil options:nil];

        for(id currentObject in topLevelObjects)
        {
            if([currentObject isKindOfClass:[NewsFeedCell class]])
            {
                cell = (NewsFeedCell *)currentObject;
                break;
            }
        }
}
return cell; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-08-28T19:44:58.393

此扩展需要 Xcode7 beta6

```
extension NSBundle {
    enum LoadViewError: ErrorType {
        case ExpectedXibToExistButGotNil
        case ExpectedXibToContainJustOneButGotDifferentNumberOfObjects
        case XibReturnedWrongType
    }

    func loadView<T>(name: String) throws -> T {
        let topLevelObjects: [AnyObject]! = loadNibNamed(name, owner: self, options: nil)
        if topLevelObjects == nil {
            throw LoadViewError.ExpectedXibToExistButGotNil
        }
        if topLevelObjects.count != 1 {
            throw LoadViewError.ExpectedXibToContainJustOneButGotDifferentNumberOfObjects
        }
        let firstObject: AnyObject! = topLevelObjects.first
        guard let result = firstObject as? T else {
            throw LoadViewError.XibReturnedWrongType
        }
        return result
    }
} 
```

创建一个仅包含 1 个自定义 UITableViewCell 的 Xib 文件。

加载它。

```
let cell: BacteriaCell = try NSBundle.mainBundle().loadView("BacteriaCell") 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-05-18T11:17:25.980

```
 func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {

            let cellReuseIdentifier = "collabCell"
            var cell:collabCell! = tableView.dequeueReusableCell(withIdentifier: cellReuseIdentifier) as? collabCell
            if cell == nil {
                tableView.register(UINib(nibName: "collabCell", bundle: nil), forCellReuseIdentifier: cellReuseIdentifier)
                cell = tableView.dequeueReusableCell(withIdentifier: cellReuseIdentifier) as! collabCell!
            }

            return cell

} 
```

# language-agnostic - 是否可以在托管操作系统之上运行“本机”代码？

> ID：540347
> 
> 赞同：2
> 
> 时间：2009-02-12T07:28:00.150
> 
> 标签：language-agnostic, operating-system, virtualization

我正在阅读 Midori 并且有点开始想知道这是否可能。

在托管操作系统上，“托管代码”将是本机的，而“本机代码”将是……外星人？至少在理论上，是否有可能在托管操作系统上运行今天的本机代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T07:59:09.123

首先，您应该从定义“托管”和“本地”开始。在像 Midori 这样的“托管”操作系统上，内核仍然是 ngen-ed（预编译为机器代码），而不是从 IL 即时编译。因此，我会将其排除为“托管”和“本地”之间的区别。

我想到的“托管”代码和“本机”代码之间还有另外两个区别——代码可变性和资源管理。

大多数“本机”代码是无法验证的，因此“托管”操作系统加载程序甚至可能拒绝加载“本机”图像。当然，可以生成可验证的“本机”代码，但这会带来很多限制，本质上与“托管”代码没有什么不同。

“托管”操作系统中的资源将由操作系统而非应用程序管理。“本机”代码通常分配和清理其资源。由 OS API 分配并提供给“本机”代码的资源会发生什么情况？或相反亦然？关于谁以及何时进行资源管理和清理应该有非常明确的规则。出于安全原因，我无法想象操作系统将“本机”代码直接控制到进程虚拟内存之外的任何资源。因此，“原生”的唯一原因是实现自己的内存管理。

今天的“natve”代码不符合上述任何规则。因此，“托管”操作系统应该拒绝直接执行它。不过，“托管”操作系统可能会提供像 Hyper-V 这样的虚拟化层，并在虚拟机中托管“本机”代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T08:46:01.430

通过托管，我假设您的意思是代码在一个环境中运行，该环境对代码的类型安全、安全内存访问等进行一些检查。而本机，嗯，正好相反。现在它的这个执行环境决定了它是否可以允许本机代码在未经验证的情况下运行。这样看：操作系统和顶层应用程序都需要一个执行环境来运行。它们唯一的关系是顶层应用程序正在调用底层操作系统以执行较低级别的任务，但在调用操作系统时，它实际上是由执行环境（可能/可能不支持代码验证，具体取决于编译代码时传递的选项），当控制权转移到操作系统时，执行环境再次负责执行操作系统代码（这个环境可能是另一个环境一起），在这种情况下，

因此，理论上，本机代码可能/可能不会在托管操作系统上运行。这一切都取决于其运行所在的执行环境的行为。操作系统是否托管不会影响它是否在其上运行。如果顶级应用程序和操作系统都具有相同的执行环境（托管），则本机代码将不会在操作系统上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:35:19.757

从技术上讲，本机代码模拟器可以用托管代码编写，但它不能在裸硬件上运行。

我怀疑任何依赖软件验证来隔离对共享资源的访问（例如 Singularity）的托管操作系统都允许直接运行非托管代码，因为它可能能够绕过软件提供的所有保护（与普通操作系统不同，某些托管操作系统不这样做） t 依赖于硬件提供的保护技术）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T18:54:25.663

来自 MS Research 论文[Singularity: Rethinking the Software Stack](http://research.microsoft.com/pubs/69431/osr2007_rethinkingsoftwarestack.pdf) (p9)：

> 原则上，保护域可以托管一个进程，该进程包含使用不安全语言（如 C++）编写的无法验证的代码。虽然对于运行遗留代码非常有用，但我们尚未探索这种可能性。目前，保护域内的所有代码也包含在 SIP 中，它继续提供隔离和故障遏制边界。

所以看起来，虽然目前尚未探索，但这是一种明显的可能性。非托管代码可以在硬件保护域中运行，它会因必须处理虚拟内存、TLB 等而受到性能影响，但系统作为一个整体可以在运行非托管代码时安全地维护其不变量。

# jquery - 使用 jQuery 更改翻转时的图像源

> ID：540349
> 
> 赞同：444
> 
> 时间：2009-02-12T07:28:30.413
> 
> 标签：jquery, html

我有一些图像和它们的翻转图像。使用 jQuery，我想在 onmousemove/onmouseout 事件发生时显示/隐藏翻转图像。我所有的图像名称都遵循相同的模式，如下所示：

> 原图：`Image.gif`
> 
> 翻转图像：`Imageover.gif`

我想分别在 onmouseover 和 onmouseout 事件中插入和删除图像源的*“over”*部分。

我如何使用 jQuery 来做到这一点？

* * *

## 回答 #1

> 赞同：620
> 
> 时间：2009-02-12T07:31:48.393

准备就绪：

```
$(function() {
    $("img")
        .mouseover(function() { 
            var src = $(this).attr("src").match(/[^\.]+/) + "over.gif";
            $(this).attr("src", src);
        })
        .mouseout(function() {
            var src = $(this).attr("src").replace("over.gif", ".gif");
            $(this).attr("src", src);
        });
}); 
```

对于那些使用 url 图片来源的人：

```
$(function() {
        $("img")
            .mouseover(function() {
               var src = $(this).attr("src");
               var regex = /_normal.svg/gi;
               src = this.src.replace(regex,'_rollover.svg');
               $(this).attr("src", src);

            })
            .mouseout(function() {
               var src = $(this).attr("src");
               var regex = /_rollover.svg/gi;
               src = this.src.replace(regex,'_normal.svg');
               $(this).attr("src", src);

            });
    }); 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2009-02-12T07:54:36.497

我知道你问的是使用 jQuery，但你可以在使用 CSS 关闭 JavaScript 的浏览器中实现相同的效果：

```
#element {
    width: 100px; /* width of image */
    height: 200px; /* height of image */
    background-image: url(/path/to/image.jpg);
}

#element:hover {
    background-image: url(/path/to/other_image.jpg);
} 
```

[这里](http://tutorials.alsacreations.com/imgreactive/)有更长的描述

然而，更好的是使用精灵：[simple-css-image-rollover](http://www.findmotive.com/2006/10/31/simple-css-image-rollover/)

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2012-02-19T14:23:14.203

如果您有多个图像，并且需要不依赖于命名约定的通用图像。

HTML

```
<img data-other-src="big-zebra.jpg" src="small-cat.jpg">
<img data-other-src="huge-elephant.jpg" src="white-mouse.jpg">
<img data-other-src="friendly-bear.jpg" src="penguin.jpg"> 
```

JavaScript

```
$('img').bind('mouseenter mouseleave', function() {
    $(this).attr({
        src: $(this).attr('data-other-src') 
        , 'data-other-src': $(this).attr('src') 
    })
}); 
```

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2009-08-02T19:53:55.213

```
 /* Teaser image swap function */
    $('img.swap').hover(function () {
        this.src = '/images/signup_big_hover.png';
    }, function () {
        this.src = '/images/signup_big.png';
    }); 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2012-04-12T04:53:59.833

一个不将您限制为“this image”和“that image”的通用解决方案可能是将“onmouseover”和“onmouseout”标签添加到 HTML 代码本身。

HTML

```
<img src="img1.jpg" onmouseover="swap('img2.jpg')" onmouseout="swap('img1.jpg')" /> 
```

JavaScript

```
function swap(newImg){
  this.src = newImg;
} 
```

* * *

根据您的设置，也许这​​样的事情会更好（并且需要更少的 HTML 修改）。

HTML

```
<img src="img1.jpg" id="ref1" />
<img src="img3.jpg" id="ref2" />
<img src="img5.jpg" id="ref3" /> 
```

JavaScript / jQuery

```
// Declare Arrays
  imgList = new Array();
  imgList["ref1"] = new Array();
  imgList["ref2"] = new Array();
  imgList["ref3"] = new Array();

//Set values for each mouse state
  imgList["ref1"]["out"] = "img1.jpg";
  imgList["ref1"]["over"] = "img2.jpg";
  imgList["ref2"]["out"] = "img3.jpg";
  imgList["ref2"]["over"] = "img4.jpg";
  imgList["ref3"]["out"] = "img5.jpg";
  imgList["ref3"]["over"] = "img6.jpg";

//Add the swapping functions
  $("img").mouseover(function(){
    $(this).attr("src", imgList[ $(this).attr("id") ]["over"]);
  }

  $("img").mouseout(function(){
    $(this).attr("src", imgList[ $(this).attr("id") ]["out"]);
  } 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2009-02-12T07:51:06.117

```
$('img.over').each(function(){
    var t=$(this);
    var src1= t.attr('src'); // initial src
    var newSrc = src1.substring(0, src1.lastIndexOf('.'));; // let's get file name without extension
    t.hover(function(){
        $(this).attr('src', newSrc+ '-over.' + /[^.]+$/.exec(src1)); //last part is for extension   
    }, function(){
        $(this).attr('src', newSrc + '.' + /[^.]+$/.exec(src1)); //removing '-over' from the name
    });
}); 
```

您可能希望从第一行更改图像类别。如果您需要更多图像类（或不同的路径），您可以使用

```
$('img.over, #container img, img.anotherOver').each(function(){ 
```

等等。

它应该工作，我没有测试它:)

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-02-24T18:44:42.357

我希望有一个像这样的 über one 班轮：

```
$("img.screenshot").attr("src", $(this).replace("foo", "bar")); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-02-11T02:50:16.913

如果您正在寻找的解决方案是一个动画按钮，那么您可以做的最好的提高性能的就是精灵和 CSS 的组合。sprite 是一个巨大的图像，包含来自您网站的所有图像（标题、徽标、按钮和您拥有的所有装饰）。您拥有的每个图像都使用一个 HTTP 请求，并且 HTTP 请求越多，加载所需的时间就越多。

```
.buttonClass {
    width: 25px;
    height: 25px;
    background: url(Sprite.gif) -40px -500px;
}
.buttonClass:hover {
    width: 25px;
    height: 25px;
    background: url(Sprite.gif) -40px -525px;
} 
```

坐标将`0px 0px`是您的精灵的左上角。

但是，如果您正在使用 Ajax 或类似的东西开发相册，那么 JavaScript（或任何框架）是最好的。

玩得开心！

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-03-24T07:10:40.703

```
$('img').mouseover(function(){
  var newSrc = $(this).attr("src").replace("image.gif", "imageover.gif");
  $(this).attr("src", newSrc); 
});
$('img').mouseout(function(){
  var newSrc = $(this).attr("src").replace("imageover.gif", "image.gif");
  $(this).attr("src", newSrc); 
}); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-09-05T22:34:02.750

在一段时间前寻找解决方案时，我发现了一个与下面类似的脚本，经过一些调整后，我开始为我工作。

它处理两个图像，几乎总是默认为“关闭”，鼠标关闭图像（image-example_off.jpg），偶尔“打开”，鼠标悬停时，所需的替代图像（ image-example_on.jpg) 被显示。

```
<script type="text/javascript">        
    $(document).ready(function() {        
        $("img", this).hover(swapImageIn, swapImageOut);

        function swapImageIn(e) {
            this.src = this.src.replace("_off", "_on");
        }
        function swapImageOut (e) {
            this.src = this.src.replace("_on", "_off");
        }
    });
</script> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-23T07:10:33.283

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>JQuery</title>
<script src="jquery.js" type="text/javascript"> </script>
<style type="text/css">
    #box{
        width: 68px;
        height: 27px;
        background: url(images/home1.gif);
        cursor: pointer;
    }
</style>

<script type="text/javascript">

$(function(){

    $('#box').hover( function(){
        $('#box').css('background', 'url(images/home2.gif)');

    });
    $('#box').mouseout( function(){
        $('#box').css('background', 'url(images/home1.gif)');

    });

});
</script>
</head>

<body>
<div id="box" onclick="location.href='index.php';"></div>
</body>
</html> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-02-14T14:06:38.947

我做了类似下面的代码:)

它仅在您有第二个以 _hover 命名的文件时才有效，例如，`facebook.png`并且`facebook_hover.png`

```
$('#social').find('a').hover(function() {
    var target = $(this).find('img').attr('src');
    //console.log(target);
    var newTarg = target.replace('.png', '_hover.png');
    $(this).find('img').attr("src", newTarg);
}, function() {
    var target = $(this).find('img').attr('src');
    var newTarg = target.replace('_hover.png', '.png');
    $(this).find('img').attr("src", newTarg);
}); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-04-15T17:39:50.517

```
<img src="img1.jpg" data-swap="img2.jpg"/>

img = {

 init: function() {
  $('img').on('mouseover', img.swap);
  $('img').on('mouseover', img.swap);
 }, 

 swap: function() {
  var tmp = $(this).data('swap');
  $(this).attr('data-swap', $(this).attr('src'));
  $(this).attr('str', tmp);
 }
}

img.init(); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-07-15T14:29:05.977

改编自 Richard Ayotte 的代码 - 以 ul/li 列表中的 img 为目标（通过此处的包装 div 类找到），如下所示：

```
$('div.navlist li').bind('mouseenter mouseleave', function() {    
    $(this).find('img').attr({ src: $(this).find('img').attr('data-alt-src'), 
    'data-alt-src':$(this).find('img').attr('src') }
); 
```

# javascript - 使用 JavaScript 动态生成文本框

> ID：540350
> 
> 赞同：0
> 
> 时间：2009-02-12T07:29:13.843
> 
> 标签：javascript, html

我想根据用户输入动态生成文本框。如果用户在文本框中输入整数值，如果他/她输入 5 我想生成 5 个文本框。此代码在 Firefox 中有效，但在 IE 和 Netscape 中无效；请帮助我如何执行此操作或向我指出此代码中的任何其他错误。另外，我们使用的技术是 Struts 2。
请帮助我。

JavaScript 代码：

```
function generate()
{
  var tot = document.getElementById("totmob").value;
  var tbl = document.getElementById("sim");

for(var i =1;i<=tot;i++)
{
  tbl.innerHTML  = 'Mobile No'+i+' <input type="text"  size = "20" maxlength= "20" name= hoardingregister.mobileno> <br> \n';
} 
```

HTML 代码：

```
<td>
<s:textfield id="totmob" label="Total Mobile Number"  />
<td>
<td>
<input type="button"  value="ADD" onclick="generate()"/>
</td>
</tr>
</table>
<div id="sim">
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T07:55:23.220

```
for(var i =1;i<=tot;i++)
{
  tbl.innerHTML  = 'Mobile No'+i+' <input type="text"  size = "20" maxlength= "20" name= hoardingregister.mobileno> <br> \n';
} 
```

应该

```
for(var i =1;i<=tot;i++)
{
  tbl.innerHTML  += 'Mobile No'+i+' <input type="text"  size = "20" maxlength= "20" name= hoardingregister.mobileno> <br> \n';
} 
```

因为您需要附加到内部 HTML，而不是替换它。

您还使用了 <td> 而不是 </td>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T08:46:24.223

但是，如果您在不刷新页面的情况下更改文本框中的值，则会在先前添加的文本框之后添加更多文本框。但是，当我们更改文本框中的值时，只应添加新文本框的数量而不是保留以前的文本框，这是错误的。能否请您根据我说的条件更改编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:39:15.630

您可以尝试除 InnerHtml 之外的其他内容吗 - 您可以尝试以下操作：

*   使用 GetElementByID 获取要添加文本框的元素
*   如果需要，删除任何现有的子项
*   将文本框作为子项添加到选定节点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T07:44:12.997

从您的 javascript 代码来看，您应该使用以下代码：

```
tbl.innerHTML  += 
```

代替

```
tbl.innerHTML  = 
```

在 for 循环内。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T07:51:14.760

为输入的名称添加唯一标识符或为其添加唯一 ID。

喜欢：

```
for(var i =1;i<=tot;i++)
{
  tbl.innerHTML  += 'Mobile No'+i+' <input type="text"  size = "20" maxlength= "20" name= hoardingregister.mobileno'+i+'> <br> \n';
} 
```

或者您将 id 放入其中，例如：

id="输入"+i

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T07:50:25.260

下面的代码在 IE 和 Firefox 中非常适合我。当你说它不起作用时，你是什么意思？

```
function generate()
{
  var tot = document.getElementById("totmob").value;
var tbl = document.getElementById("sim");

for(var i =1;i<=tot;i++)
{
  tbl.innerHTML  = tbl.innerHTML  +'Mobile No'+i+' <input type="text"  size = "20" maxlength= "20" name= hoardingregister.mobileno> <br> \n';
}

}
</script>
<body>
<table>
<tr>
    <td>
        <span>Total Mobile Number  </span>
        <input type="text" id="totmob" />
    <td>
    <td>
    <input type="button"  value="ADD" onclick="generate()"/>
    </td>
</tr>
</table>
<div id="sim">
</div>
</body>
</html> 
```

# unicode - 在 VB6 中显示 Unicode 文本（希伯来语等）的最佳选择是什么

> ID：540361
> 
> 赞同：6
> 
> 时间：2009-02-12T07:37:06.430
> 
> 标签：unicode, vb6, internationalization

我有一些客户想要使用我们的希伯来语语言治疗软件。

这些程序是在 VB6 中的。我知道的最佳选择是：

1.  使用 MS Office 中的 Forms 2.0 控件，但不能分发它们。
2.  [http://www.hexagora.com/en_dw_unictrl.asp](http://www.hexagora.com/en_dw_unictrl.asp) 899 美元
3.  [http://www.iconico.com/UniToolbox/](http://www.iconico.com/UniToolbox/) 499 美元

还有其他选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T15:28:57.310

我发现本[教程](http://www.cyberactivex.com/UnicodeTutorialVb.htm)非常有用。是的，它部分是另一个[Unicode Control Suite](http://www.unisuite.com/)的广告，但它有很多关于如何自己做以及涉及哪些问题的信息。

**编辑**

我知道我的书签中存储了更多关于此的内容。

首先，[Chilkat](http://www.example-code.com/vb/vbUnicode1.asp)（另一个组件供应商）有一篇关于如何使用字体的字符集（假设它是 unicode 字体）来设置不同字体类型的文章（你必须手动更改 .frm，因为字符集没有暴露在图形用户界面）。然后你所要做的就是从 AnsiToUTF8 转换回来以支持不同的语言（这就是 Chilkat 的控件所做的）。

其次，这里有 Vesa Piittinen 的免费（Creative Commons，包括源代码）VB6 控件可供[下载](http://www.vbforums.com/showthread.php?p=3261531#post3261531)。它们包括文本框、标签、菜单、列表、对话框、命令按钮、标题（表单的标题））。我和他们玩的不多，但基本上他正在做所有的 onPaint，而且好处是这一切都是在 VB 中完成的，你可以查看源代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T11:52:07.800

大概您的用户没有选择希伯来语作为系统默认代码页，否则您可以只使用本机 VB6 控件（请记住，希伯来语显然是从右到左的！）。

不要使用 Forms 2 - 它会使您的 VB6 程序崩溃。[Microsoft 知识库文章](http://support.microsoft.com/kb/241245/EN-US/)：“众所周知，FM20.DLL 在与 Visual Basic 和其他开发人员产品一起使用时会出现很多问题。任何 Visual Studio 产品都不推荐也不支持使用它。”

我没有其他人的亲身经历，但你的#3 选项[UniToolbox](http://www.iconico.com/UniToolbox/)已经存在多年了，谷歌在新闻组上引发了一些积极的讨论（编辑——例如 VB6 国际化大师迈克尔卡普兰[在 2004 年的一篇文章中](http://groups.google.co.uk/group/microsoft.public.win32.programmer.international/browse_thread/thread/49042e0b17ff0daf/bb012c066a49d5a3?hl=en&lnk=gst&q=vb6#bb012c066a49d5a3)推荐它）以及[2005 年的一篇博文](http://www.siao2.com/2005/08/21/454340.aspx)）。

一个奇怪的选择是使用带有原生 VB6 控件的 API 调用——Michael Kaplan 的关于 VB6 国际化的优秀[书籍中的一些指针以及](http://www.amazon.co.uk/Internationalization-Visual-Basic-Michael-Kaplan/dp/0672319772)[他的网站](http://www.trigeminal.com/lang/1033/codes.asp?ItemID=11#11)上的一些示例代码。但这将是很多工作。无论如何都要买这本书，因为它是 VB6 中有关国际问题的信息的金矿。例如[示例章节](http://www.i18nwithvb.com/chapters/Chapter06_en.htm)解释了你的希伯来语问题。寻找[二手](http://www.abebooks.com/servlet/SearchResults?an=kaplan&sts=t&tn=Internationalization+With+Visual+Basic&x=56&y=15)的，因为它已经绝版了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-23T16:02:24.673

这是您应该需要的一切：

```
Option Explicit
'
Private Type GETTEXTEX
    cb As Long
    flags As Long
    codepage As Long
    lpDefaultChar As Long
    lpUsedDefChar As Long
End Type
'
Private Type GETTEXTLENGTHEX
    flags As Long
    codepage As Long
End Type
'
Private Type SETTEXTEX
    flags As Long
    codepage As Long
End Type
'
Private Declare Function DefWindowProcW Lib "user32" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long
Private Declare Sub PutMem4 Lib "msvbvm60" (Destination As Any, Value As Any)
Private Declare Function SysAllocStringLen Lib "oleaut32" (ByVal OleStr As Long, ByVal bLen As Long) As Long
Private Declare Function OpenClipboard Lib "user32.dll" (ByVal hWnd As Long) As Long
Private Declare Function EmptyClipboard Lib "user32.dll" () As Long
Private Declare Function CloseClipboard Lib "user32.dll" () As Long
Private Declare Function IsClipboardFormatAvailable Lib "user32.dll" (ByVal wFormat As Long) As Long
Private Declare Function GetClipboardData Lib "user32.dll" (ByVal wFormat As Long) As Long
Private Declare Function SetClipboardData Lib "user32.dll" (ByVal wFormat As Long, ByVal hMem As Long) As Long
Private Declare Function GlobalAlloc Lib "kernel32.dll" (ByVal wFlags As Long, ByVal dwBytes As Long) As Long
Private Declare Function GlobalLock Lib "kernel32.dll" (ByVal hMem As Long) As Long
Private Declare Function GlobalUnlock Lib "kernel32.dll" (ByVal hMem As Long) As Long
Private Declare Function GlobalSize Lib "kernel32" (ByVal hMem As Long) As Long
Private Declare Function lstrcpy Lib "kernel32.dll" Alias "lstrcpyW" (ByVal lpString1 As Long, ByVal lpString2 As Long) As Long
Private Declare Function SendMessage Lib "user32.dll" Alias "SendMessageA" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByRef lParam As Any) As Long
Private Declare Function SendMessageWLng Lib "user32" Alias "SendMessageW" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long
'
' The following is from MSDN help:
'
' UNICODE: International Standards Organization (ISO) character standard.
' Unicode uses a 16-bit (2-byte) coding scheme that allows for 65,536 distinct character spaces.
' Unicode includes representations for punctuation marks, mathematical symbols, and dingbats,
' with substantial room for future expansion.
'
' vbUnicode constant:     Converts the string toUnicode using the default code page of the system.
' vbFromUnicode constant: Converts the string from Unicode to the default code page of the system.
'
' LCID: The LocaleID, if different than the system LocaleID. (The system LocaleID is the default.)
'

Public Property Let UniCaption(ctrl As Object, sUniCaption As String)
    Const WM_SETTEXT As Long = &HC
    ' USAGE: UniCaption(SomeControl) = s
    '
    ' This is known to work on Form, MDIForm, Checkbox, CommandButton, Frame, & OptionButton.
    ' Other controls are not known.
    '
    ' As a tip, build your Unicode caption using ChrW.
    ' Also note the careful way we pass the string to the unicode API call to circumvent VB6's auto-ASCII-conversion.
    DefWindowProcW ctrl.hWnd, WM_SETTEXT, 0&, ByVal StrPtr(sUniCaption)
End Property

Public Property Get UniCaption(ctrl As Object) As String
    Const WM_GETTEXT As Long = &HD
    Const WM_GETTEXTLENGTH As Long = &HE
    ' USAGE: s = UniCaption(SomeControl)
    '
    ' This is known to work on Form, MDIForm, Checkbox, CommandButton, Frame, & OptionButton.
    ' Other controls are not known.
    Dim lLen As Long
    Dim lPtr As Long
    '
    lLen = DefWindowProcW(ctrl.hWnd, WM_GETTEXTLENGTH, 0&, ByVal 0&) ' Get length of caption.
    If lLen Then ' Must have length.
        lPtr = SysAllocStringLen(0&, lLen) ' Create a BSTR of that length.
        PutMem4 ByVal VarPtr(UniCaption), ByVal lPtr ' Make the property return the BSTR.
        DefWindowProcW ctrl.hWnd, WM_GETTEXT, lLen + 1&, ByVal lPtr ' Call the default Unicode window procedure to fill the BSTR.
    End If
End Property

Public Property Let UniClipboard(sUniText As String)
    ' Puts a VB string in the clipboard without converting it to ASCII.
    Dim iStrPtr As Long
    Dim iLen As Long
    Dim iLock As Long
    Const GMEM_MOVEABLE As Long = &H2
    Const GMEM_ZEROINIT As Long = &H40
    Const CF_UNICODETEXT As Long = &HD
    '
    OpenClipboard 0&
    EmptyClipboard
    iLen = LenB(sUniText) + 2&
    iStrPtr = GlobalAlloc(GMEM_MOVEABLE Or GMEM_ZEROINIT, iLen)
    iLock = GlobalLock(iStrPtr)
    lstrcpy iLock, StrPtr(sUniText)
    GlobalUnlock iStrPtr
    SetClipboardData CF_UNICODETEXT, iStrPtr
    CloseClipboard
End Property

Public Property Get UniClipboard() As String
    ' Gets a UNICODE string from the clipboard and puts it in a standard VB string (which is UNICODE).
    Dim iStrPtr As Long
    Dim iLen As Long
    Dim iLock As Long
    Dim sUniText As String
    Const CF_UNICODETEXT As Long = 13&
    '
    OpenClipboard 0&
    If IsClipboardFormatAvailable(CF_UNICODETEXT) Then
        iStrPtr = GetClipboardData(CF_UNICODETEXT)
        If iStrPtr Then
            iLock = GlobalLock(iStrPtr)
            iLen = GlobalSize(iStrPtr)
            sUniText = String$(iLen \ 2& - 1&, vbNullChar)
            lstrcpy StrPtr(sUniText), iLock
            GlobalUnlock iStrPtr
        End If
        UniClipboard = sUniText
    End If
    CloseClipboard
End Property

Public Sub SetupRichTextboxForUnicode(rtb As RichTextBox)
    ' Call this so that the rtb doesn't try to do any RTF interpretation.  We will just be using it for Unicode display.
    ' Once this is called, the following two procedures will work with the rtb.
    Const TM_PLAINTEXT As Long = 1&
    Const EM_SETTEXTMODE As Long = &H459
    SendMessage rtb.hWnd, EM_SETTEXTMODE, TM_PLAINTEXT, 0& ' Set the control to use "plain text" mode so RTF isn't interpreted.
End Sub

Public Property Let RichTextboxUniText(rtb As RichTextBox, sUniText As String)
    ' Usage: Just assign any VB6 string to the rtb.
    '        If the string contains Unicode (which VB6 strings are capable of), it will be correctly handled.
    Dim stUnicode As SETTEXTEX
    Const EM_SETTEXTEX As Long = &H461
    Const RTBC_DEFAULT As Long = 0&
    Const CP_UNICODE As Long = 1200&
    '
    stUnicode.flags = RTBC_DEFAULT ' This could be otherwise.
    stUnicode.codepage = CP_UNICODE
    SendMessageWLng rtb.hWnd, EM_SETTEXTEX, VarPtr(stUnicode), StrPtr(sUniText)
End Property

Public Property Get RichTextboxUniText(rtb As RichTextBox) As String
    Dim uGTL As GETTEXTLENGTHEX
    Dim uGT As GETTEXTEX
    Dim iChars As Long
    Const EM_GETTEXTEX As Long = &H45E
    Const EM_GETTEXTLENGTHEX As Long = &H45F
    Const CP_UNICODE As Long = 1200&
    Const GTL_USECRLF As Long = 1&
    Const GTL_PRECISE As Long = 2&
    Const GTL_NUMCHARS As Long = 8&
    Const GT_USECRLF As Long = 1&
    '
    uGTL.flags = GTL_USECRLF Or GTL_PRECISE Or GTL_NUMCHARS
    uGTL.codepage = CP_UNICODE
    iChars = SendMessageWLng(rtb.hWnd, EM_GETTEXTLENGTHEX, VarPtr(uGTL), 0&)
    '
    uGT.cb = (iChars + 1) * 2
    uGT.flags = GT_USECRLF
    uGT.codepage = CP_UNICODE
    RichTextboxUniText = String$(iChars, 0&)
    SendMessageWLng rtb.hWnd, EM_GETTEXTEX, VarPtr(uGT), StrPtr(RichTextboxUniText)
End Property

Public Sub SaveStringToUnicodeFile(sData As String, sFileSpec As String)
    ' These are typically .TXT files.  They can be read with notepad.
    Dim iFle As Long
    '
    iFle = FreeFile
    Open sFileSpec For Binary As iFle
    Put iFle, , &HFEFF ' This is the Unicode header to a text file.  First byte = FF, second byte = FE.
    Put iFle, , UnicodeByteArrayFromString(sData)
    Close iFle
End Sub

Public Function LoadStringFromUnicodeFile(sFileSpec As String) As String
    ' These are typically .TXT files.  They can be read with notepad.
    Dim iFle As Long
    Dim bb() As Byte
    Dim i As Integer
    '
    iFle = FreeFile
    Open sFileSpec For Binary As iFle
    Get iFle, , i
    If i <> &HFEFF Then ' Unicode file header.  First byte = FF, second byte = FE.
        Close iFle
        Exit Function ' It's not a valid Unicode file.
    End If
    ReDim bb(1 To LOF(iFle) - 2&)
    Get iFle, , bb
    Close iFle
    LoadStringFromUnicodeFile = bb ' This directly copies the byte array to the Unicode string (no conversion).
    ' Note: If you try to directly read the file as a string, VB6 will attempt to convert the string from ASCII to Unicode.
End Function

Public Function AsciiByteArrayFromString(s As String) As Byte()
   ' This converts the "s" string to an ASCII string before placing in the byte array.
   AsciiByteArrayFromString = StrConv(s, vbFromUnicode)
End Function

Public Function StringFromAsciiByteArray(bb() As Byte) As String
    ' This assumes that the "bb" array uses only one byte per character and expands it to UNICODE before placing in string.
    StringFromAsciiByteArray = StrConv(bb, vbUnicode)
End Function

Public Function UnicodeByteArrayFromString(s As String) As Byte()
    ' This directly copies the Unicode string into the byte array, using two bytes per character (i.e., Unicode).
    UnicodeByteArrayFromString = s
End Function

Public Function StringFromUnicodeByteArray(bb() As Byte) As String
    ' This directly copies the byte array into the Unicode string, using two bytes per character.
    '
    ' Interestingly, you can assign an odd number of bytes to a string.
    ' The Len(s) function will not count the last (odd) byte, but the LenB(s) function will correctly report it.
    ' However, it is advisable to keep the byte array an even number of bytes.
    StringFromUnicodeByteArray = bb
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T07:43:47.523

根据[KB224305](http://support.microsoft.com/kb/q224305/) ("INFO: Usage and Redistribution of FM20.DLL")，您可以安装免费的“ [Microsoft ActiveX Control Pad](http://msdn.microsoft.com/en-us/library/ms968493.aspx) ”，然后安装 Forms 2.0 Library。

也许这是您的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-05T12:42:23.007

[此链接](http://www.cyberactivex.com/unicodetutorialvb.htm)中的字符集表

![在此处输入图像描述](https://i.stack.imgur.com/anSia.png)

*   DBCS - 双字节字符集

DBCS 实际上不是 Windows 使用的正确术语。它实际上是 MBCS，其中一个字符可以是 1 个或 2 个字节。为了说明这一点，请考虑以下代码，它将获取英文和中文字符的 Unicode 字符串，转换为 MBCS 中文的字节数组，将字节数组转储到立即窗口，最后将其转换回 Unicode 字符串以显示在Unicode 感知文本框。使用 Chinese(PRC) LCID = 2052 转换的字节数组包含英文字符的单字节和 Unicode 字符的双字节。这证明它是 MBCS 而不是 DBCS：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-15T16:12:38.250

以下是关于使用资源 (.RES) 文件在 Microsoft Visual Basic 表单中显示 Unicode 字符的一些注释：

当我在创建资源 (.RES) 文件时将俄语或日语字符粘贴到 Microsoft Visual Basic 6 资源编辑器时，这些字符会在 MSVB6 资源编辑器和计算机上显示的 MSVB6 表单中显示为问号 (?)日语语言环境分别使用我通过 MSVB6 从 RES 文件构建的资源 DLL。

但是，如果我通过将字符粘贴到 Resource Hacker [http://www.angusj.com/resourcehacker](http://www.angusj.com/resourcehacker)将字符添加到资源文件中，这些字符仍会在 MSVB6 资源编辑器中显示为问号，但会在计算机上正确显示在我通过 MSVB6 构建资源 DLL 之后的适当语言环境。

可以为多种语言中的每一种制作资源 DLL，并使用 Microsoft 的 GetUserDefaultLCID 或 GetUserDefaultLocaleName 来决定加载哪个。

# c# - 将流解析为结构或类的“最佳”方法是什么？

> ID：540364
> 
> 赞同：1
> 
> 时间：2009-02-12T07:39:01.293
> 
> 标签：c#

实际上我正在使用 .Net Framework 3.5，所以我拥有所有这些不错的小功能，例如 lambdas、linq 等。

给定的是一个串行连接（或者更抽象：一个流），您可以在其中接收一些数据，其格式如下：

```
struct Packet
{
    byte STX
    UInt16 DataLength
    string Data
    byte CRC
    byte ETX
} 
```

使用传入数据的简单映射无济于事，因为您并不真正知道一个数据包将有多长，因为它被写入结构（DataLength）中。

所以我的第一个想法是按字节读取流并将其放入???。是的，这是下一个问题。第一个原始数据存储在哪里？放入一个简单的字节数组，具有最大可能长度（这将是 65540 字节，因为 DataLength 是 UInt16 加上来自其他字段的附加字节）。或者我应该打开一个队列并填满所有传入的字节，或者是否存在另一个很好的可能性？

让我们假设这些问题已经解决，并且我有某种本地缓冲区，它保存了流中的所有原始字节。通过给定的结构来解释它的最好方法是什么？只是做某种 for- 或 foreach-loop 还是存在一种更智能（性能更好）的方式（例如，使用正则表达式或 linq）？

最好的问候，奥利弗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T07:56:11.627

怎么样...

```
struct Packet
{
    public byte STX;
    public UInt16 DataLength;
    public string Data;
    public byte CRC;
    public byte ETX;
}

//Warning: Need to add error handling
class PacketReader
{
    private BinaryReader _reader;

    public PacketReader(Stream stream)
    {
        _reader = new BinaryReader(stream);
    }

    Packet ReadPacket()
    {
        var packet = new Packet() 
            {
                STX = _reader.ReadByte(),
                DataLength = _reader.ReadUInt16(),
                Data = Encoding.ASCII.GetString(
                    _reader.ReadBytes(packet.DataLength)),
                CRC = _reader.ReadByte(),
                ETX = _reader.ReadByte()
            };

        return packet;
    }
} 
```

请注意：我没有故意使用 BinaryReader.ReadString()，因为它旨在对 BinaryWriter.WriteString() 生成的字符串进行操作。即使它是一个长度前缀字符串，编码也有点不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T07:43:59.393

我会将它们存储在一个字节数组中并从那里重新创建它们，这是一种快速而简单的方法！

我会读取字节并使用 BitConverter、Encoding.UTF8 进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:48:19.367

看看这个，无论如何它归结为使用 [Serializable] 属性，你完成了 [http://www.ondotnet.com/pub/a/dotnet/2002/08/26/serialization.html](http://www.ondotnet.com/pub/a/dotnet/2002/08/26/serialization.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-17T01:47:07.643

另一种可能的选择，利用 C# 的 yield 关键字：

```
public struct Packet    
{    
    public byte STX;    
    public UInt16 DataLength;    
    public string Data;    
    public byte CRC;    
    public byte ETX;    
}    

public static class StreamExtensions
{
    public IEnumerable<Packet> ToPacketStream(this Stream stream)
    {
        BinaryReader reader = new BinaryReader(stream);
        while(reader.PeekChar() != -1) //Optionally change this to reflect your exit conditions
        {
            var packet = new Packet();

            packet.STX =        _reader.ReadByte();       
            packet.DataLength = _reader.ReadUInt16();       
            packet.Data =       Encoding.ASCII.GetString(_reader.ReadBytes(packet.DataLength));       
            packet.CRC =        _reader.ReadByte();       
            packet.ETX =        _reader.ReadByte();

            yield return packet;
        }
    }   
}

//Usage
foreach(var packet in stream.ToPacketStream())
{
    //Handle packet
} 
```

# netbeans - 如何关闭 Netbeans 中的当前行突出显示？

> ID：540370
> 
> 赞同：17
> 
> 时间：2009-02-12T07:41:06.187
> 
> 标签：netbeans

我已经在所有选项中寻找了半个小时，但我找不到；谷歌搜索目前也让我失望。这是在 Netbeans 6.0.1 上

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-12T07:46:51.243

工具>选项>突出显示>突出显示插入符号行：[将背景更改为继承]

![在此处输入图像描述](https://i.stack.imgur.com/tjZcP.png) 截图：[http ://d.pr/wZpr](http://d.pr/wZpr)

# oracle - 在 Oracle 中使用小 blob 是否合理？

> ID：540371
> 
> 赞同：1
> 
> 时间：2009-02-12T07:41:23.410
> 
> 标签：oracle, blob

在 Oracle 中，LongRaw 和 Varchar2 在 Oracle 中的最大长度为 4kb，但我需要存储 8kb 和 16kb 的对象，所以我想知道什么是好的解决方案。我知道我可以使用 Blob，但 Blob 具有可变长度，如果我是正确的，它基本上是幕后的一个额外文件，一个我不想为我的对象支付的功能和价格。还有其他更适合这种需求的解决方案或数据类型吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T08:50:20.967

Blob 不是幕后的文件。它存储在数据库中。为什么它具有可变长度很重要？您可以只使用 blob 列（如果您的数据是文本数据，则可以使用 clob）并将其存储在自己的段中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T07:48:16.730

为什么不分割二进制数据并将其存储在 4K 块中？您可以为这些块有四个不同的列（以及一个用于将它们重建到大结构中的长度列），或者另一个表的更规范化的方式，其中的块与原始表记录相关联。

如果您将来需要它，这将提供扩展。

例如：

```
`Primary table:
    -- normal columns --
    chunk_id integer
    chunk_last_len integer
Chunk table:
    chunk_id integer
    chunk_sequence integer
    chunk varchar2(whatever)
    primary key (chunk_id,chunk_sequence)` 
```

`当然，您可能会发现您的 DBMS 确实在 BLOB 的幕后做了这种行为，让 Oracle 处理它可能更有效，从而使您无需手动从单个块重建数据。我会衡量每个人的表现以找出最佳方法。`

 `* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T09:22:01.950

不要将二进制数据存储在 varchar2 列中，除非您愿意对它们进行编码（base64 或类似的）。否则字符集问题可能会损坏您的数据！

试试下面的语句看看效果：

select * from (select rownum-1 original, ascii(chr(rownum-1)) data from user_tab_columns where rownum<=256) where original<>data;

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T11:17:40.190

您应该使用 BLOB。

BLOB 不存储为额外文件，它作为块存储在您的一个数据文件中（就像其他数据一样）。如果 BLOB 对于单个块来说太大（在您的情况下可能不会发生），那么它将在另一个块中继续。

如果您的 BLOB 数据非常小，您可以让 Oracle 将其与您的行中的其他数据内联存储（如 varchar2）。

在内部，Oracle 正在做类似于 PAX 建议的事情。这些块与减去一些开销的 DB 块一样大。如果您尝试在 Oracle 之上重新发明 Oracle 功能，它只会比本机功能慢。

您还必须重新实现已经在 DBMS_LOB 中提供的一大堆功能（长度、比较等）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T07:47:24.503

Varchar2 也是可变长度的。如果您需要在数据库中存储任何大于小尺寸的二进制数据，则必须查看 blob 的方向。另一个解决方案当然是将二进制文件存储在文件系统的某个位置，并将文件的路径作为 varchar 存储在 db 中。

# c# - C# 和 VB.nET 类型

> ID：540385
> 
> 赞同：0
> 
> 时间：2009-02-12T07:46:52.757
> 
> 标签：c#, vb.net

VB.NET 的类型比 C# 多吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-12T07:48:58.820

不，它们在同一个 .NET 框架下，VB.NET 默认唯一的东西是对 Microsoft.VisualBasic.... 命名空间的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T07:55:44.997

两种语言中的类型指的是相同的内在 CTS 数据类型。（CTS =[通用类型系统](http://msdn.microsoft.com/en-us/library/2hf02550.aspx)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T07:53:48.637

VB.NET 过去缺乏对无符号类型的支持，但现在已修复。由于所有这些语言都是 CLR 语言，因此类型集是等价的。VB.NET 仍然有一些奇怪的老式兼容性别名（比如`Date`我不记得的其他一些别名），但这些只是标准 CLR 类型的别名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T07:49:34.170

VB.NET 有一些与 vb6 向后兼容的东西，但是如果你添加对正确程序集的引用，你可以从 c# 访问它的大部分内容。

# javascript - 表格行 SHOW / HIDE *Without* Column Width Resizing, w/ TableLayout: auto

> ID：540391
> 
> 赞同：9
> 
> 时间：2009-02-12T07:48:31.147
> 
> 标签：javascript, css, width, html-table

我有多行表格，显示待售物品。当用户单击一行时，Javascript 会在其下方插入/显示一个新行，其中包含有关该项目的详细信息。问题是当描述很长时，它会强制列宽重新调整/调整大小。这会改变列的位置，真的很烦人，尤其是对用户而言。现在，我有我的 table.style.tableLayout: auto。*我实际上更喜欢这种方式，因为列会根据内容进行调整。*

**我的问题是：如何动态“锁定”表格中列的宽度，以便在插入/显示新行时，列不会重新调整/调整大小？**

我试过了：

1.  将表格动态设置为临时“tableLayout：fixed”
2.  插入/显示我的新行
3.  将表格改回“tableLayout：auto”

Actions 1 & 2 适用于 FireFox，但不适用于 Safari 和 IE (6 & 7)。然而，做这三个似乎可以防止列移动太多。

沮丧是无法忍受的......失去很多睡眠......请帮助！

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-04-13T21:44:16.427

对于那些寻找代码的人（这是在 jQuery 中完成的）。这也假设第一行具有每个单元格的适当宽度。如果需要，很容易更改。

```
$('table.class_of_table_to_fix tr:first td').each(function() {
   $(this).css({'width': $(this).width()+"px"});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T23:06:36.290

我会在每列上设置一个百分比宽度作为指导。在每列的 TH 上只设置一次。如有必要，浏览器仍会根据内容调整列，但列将更一致地保持在原位。

接下来，我永远不会将 css "white-space:nowrap" 放在该表的任何位置。长描述不应该破坏表格布局，它应该在多行上正确环绕，并且如果您设置每列的宽度以适合数据类型，则它是可读的。同样，我会继续使用（不可破坏的空格）来表示日期、时间和数字，并允许文本换行。

除此之外，我在日常工作中这样做，有时你需要停止要求浏览器做一些它不打算做的事情。内容应该流动和适应。将列宽锁定为像素在 99.99999% 的情况下是个坏主意。

PS：如果你真的，真的，真的需要锁定列，我知道的唯一解决方案是使用 CSS2 并且跨所有浏览器是使用图像。您可以在每列中插入一个 1px 高的透明 gif 图像，并计算单元格的填充 (TD)，在每个图像 (IMG) 上设置像素宽度，而不是在列 (TH/TD) 上。例如，您可以将它们隐藏在 TH 中。您可以将图像保留为 1 像素宽并在 TD 上设置百分比宽度，当您打开新行时，您会得到每列宽度减去 TD 填充，并将其设置为相应的 IMG。我没试过！我只知道在我从事的许多项目中，例如，我使用小型 gif 图像来锁定列之间的最小垂直间距。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-09T14:00:13.840

当我实现一个包含可以切换的组的表时，我遇到了类似的问题。我希望列之间的初始比率保持不变而不固定列的宽度。默认情况下，浏览器会根据表格行的可见性更改宽度，这是不可取的。

我继续遵循@faB 的应用百分比的建议，但这样做是使用一个小脚本来计算 th 元素的百分比并在初始渲染后应用它们。这使我的列保持相同的宽度，即使所有行都隐藏了。

这是使用 jQuery 的脚本：

```
(function($){

    var lock_widths = function() {
        var total_width = $('table').innerWidth();
        var headers = $('table th');
        var leftover = 100;

        $.each(headers, function(ix, el) {
            var header = $(el), width;

            // on the last call use the leftover percentage
            if (ix == headers.length - 1) {
                width = leftover;
            } else {
                leftover -= width = header.outerWidth() / total_width * 100; 
            }

            header.css({'width': width + '%'});
        });
    };

    $(document).ready(lock_widths);

})(jQuery); 
```

在 IE7+、Firefox 和 Chrome 中测试。这适用于我的特殊情况，因为我有标题列作为参考，但可以重写它以测量其他一些列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T14:27:00.360

I don´t know if you´re familiar with jquery, but that´s what I would use - in combination with a separate class for the column that´s causing resizing in the new row - to:

1.  Calculate / get the with of the column
2.  Set the with of the afore mentioned class
3.  Add the row

I haven´t tried it, but that should do it.

By the way, there are probably other ways to do it, I´m just more familiar with jquery (for point 1\. and 2.).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T07:51:19.173

您可以在 DIV 中显示单击的行下方的行的详细信息并设置其

```
style="overflow:auto"; 
```

这样细节将被包裹并且滚动条将可用于显示整个文本。

# java - 为什么java中的main（）是无效的？

> ID：540396
> 
> 赞同：67
> 
> 时间：2009-02-12T07:50:55.757
> 
> 标签：java

对于具有类 C 语法的语言，我们声明 main() 方法返回一个 int 或 float 值（或 void）。是否可以在 Java 中从 main() 声明非 void 返回类型？如果不是，那为什么不呢？这是否意味着 Java 程序不会向操作系统返回任何值？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-12T08:28:10.647

该`main()`方法必须确实有一个`void`返回类型。来自“执行 - 虚拟机启动”（[第 12.1.4 节）的](http://docs.oracle.com/javase/specs/jls/se8/html/jls-12.html)[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/j3TOC.html)：

> 该方法`main`必须声明为 `public`、`static`和**`void`**。它必须接受一个作为字符串数组的参数。

它继续描述程序何时在“执行 - 程序退出”（[第 12.8 节](http://java.sun.com/docs/books/jls/third_edition/html/execution.html#44857)）中退出：

> 当发生以下两种情况之一时，程序会终止其所有活动并*退出：*
> 
> *   所有不是守护线程的线程都会终止。
> *   某些线程调用`exit`类 `Runtime`或类的方法，`System`退出操作未被安全管理器禁止。

换句话说，程序可能在`main`方法结束之前或之后退出；因此，返回值 from`main`将毫无意义。如果您希望程序返回状态码，请调用以下方法之一（请注意，所有三个方法都不会正常返回）：

*   [`System.exit(int status)`](http://java.sun.com/javase/6/docs/api/java/lang/System.html#exit(int))- 相当于`Runtime.getRuntime().exit(status)`
*   [`Runtime.exit(int status)`](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#exit(int))- 通过启动其关闭序列来终止当前正在运行的 JVM（如果需要，运行所有已注册的[关闭挂钩](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))和[未调用的终结器](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#runFinalizersOnExit(boolean))）。一旦完成，JVM 就会停止。
*   [`Runtime.halt(int status)`](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#halt(int))- 强制终止当前运行的 JVM。

在这三种`System.exit()`方法中，是终止 JVM 的常规和最方便的方法。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-12T08:01:34.687

[这](http://www.velocityreviews.com/forums/t135045-why-does-main-in-java-returns-void-.html)`velocityreviews`是关于同一主题的有趣讨论：

强调：

> 顺便说一句，这在 C 和 C++ 中被认为是不好的风格，只是因为它是 main 的*错误*签名，而不是出于任何独立于编程语言的普遍原因。这是不应该真正起作用的事情之一，但可能会影响您的实施。
> 
> 在 Java 中，main 返回 void 的原因是线程。在多线程成为一种广为人知的技术之前，C 和 C++ 都被设计为语言，并且后来都将线程移植到它们上面。Java 从一开始就被设计为多线程环境，坦率地说，编写任何不使用多个线程的非平凡 Java 应用程序是不寻常的。因此，程序从 main 的开头到结尾线性移动的想法有点过时了。

写的

> www.designacourse.com 训练任何人的最简单方法......任何地方。Chris Smith - MindIQ Corporation 首席软件开发人员/技术培训师

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-12T08:56:08.223

该`main`方法具有`void`作为返回类型的原因是一旦`main`完成，并不一定意味着整个程序完成。如果`main`产生新线程，那么这些线程可以保持程序运行。在这一点上，返回类型的`main`意义不大。

例如，这在 Swing 应用程序中很常见，该`main`方法通常在 Swing 线程上启动一个 GUI，然后`main`结束……但程序仍在运行。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-12T07:54:06.140

您可以使用 System.exit() 返回一个 int。

返回整数以外的任何东西都没有多大意义，因为操作系统需要一个整数。如果没有返回任何内容，则默认值为 0，表示 OK。其他值通常用于表示错误或特殊情况。

# c# - 使用 Rhino Mocks 默认返回空列表

> ID：540401
> 
> 赞同：7
> 
> 时间：2009-02-12T07:52:02.230
> 
> 标签：c#, unit-testing, tdd, rhino-mocks, moq

我认为当方法没有结果时总是返回空列表或数组而不是 null 是一种很好的做法，以避免代码中的 null 检查。

因为 Rhino Mocks 返回一个对象的默认值，对于列表和数组为 null，很多时候我必须重新添加 null 检查或设置模拟以返回列表。

有没有办法用这种行为配置或扩展 Rhino Mocks？

```
var repositoryMock = MockRepository.GenerateMock<ICustomerRepository>();
IList<Customer> customers = repositoryMock.getCustomers();

Assert.IsNotNull(customers);
Assert.AreEqual(0, customers.Count ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T09:34:43.163

事实证明，只要返回的对象是 IEnumerable ， [Moq就可以实现这种行为。](http://code.google.com/p/moq/)以下测试通过：

```
[Test]
public void EmptylListTest()
{
    var repositoryMock = new Mock<ICustomerRepository>();

    IEnumerable<Customer> customers = repositoryMock.Object.GetCustomers();

    Assert.IsNotNull(customers);
    Assert.AreEqual(0, customers.Count());
}

[Test]
public void EmptyArrayTest()
{
    var repositoryMock = new Mock<ICustomerRepository>();

    Customer[] customerArray = repositoryMock.Object.GetCustomerArray();

    Assert.IsNotNull(customerArray);
    Assert.AreEqual(0, customerArray.Length);
}

public interface ICustomerRepository
{
    IEnumerable<Customer> GetCustomers();
    Customer[] GetCustomerArray();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:02:57.087

Rhino Mocks 中没有任何东西可以自动解决您的问题。最简单的解决方案是为使用 SetupResult（或 repeat.any）配置默认值的每种类型简单地设置一个扩展/实用方法。

您可能总是很棘手并通过成员进行枚举，检查 ILists / Arrays 并动态设置模拟 - 这取决于您拥有多少类型以及您可以专用于该实用程序方法的类型。

祝你好运！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-12T22:39:07.573

我认为更改模拟的默认行为以返回非默认值将是一个冒险的举动。

如果您的 ICustomerRepository 的实际实现中有一个错误，以至于它没有返回一个空列表而是返回一个 null，会发生什么？

如果您编写其他单元测试并针对自动返回空列表的 ICustomerRepository 的模拟版本进行测试，那么您会认为一切正常。您甚至可能构建该代码并认为它​​会正常工作，因此您运行编译的应用程序并开始崩溃。

为什么？因为您命中 ICustomerRepository 的类没有正确处理空值。

我宁愿明确并在测试中设置期望从 getCustomers() 方法返回一个空的 IList，而不是在模拟中发生一些“魔术”。为什么？因为它提高了可读性，并且代码的工作方式符合其他可能不熟悉 rhino 的开发人员所期望的工作方式。即没有期望的方法返回默认值。

# java - 数值求解非线性方程

> ID：540414
> 
> 赞同：11
> 
> 时间：2009-02-12T07:57:30.627
> 
> 标签：java, math, mathematical-optimization, numerical, scientific-computing

我需要在我的 Java 程序中解决非线性最小化（N 个未知数的最小残差平方）问题。解决这些问题的常用方法是[Levenberg-Marquardt](http://en.wikipedia.org/wiki/Levenberg-Marquardt_algorithm)算法。我有一些问题

*   有人对可用的不同 LM 实现有经验吗？LM 的风格略有不同，我听说该算法的确切实现对其数值稳定性有重大影响。我的功能表现得非常好，所以这可能不是问题，但我当然想选择一个更好的选择。以下是我发现的一些替代方案：

    *   [FPL 统计组的非线性优化 Java 包](http://www1.fpl.fs.fed.us/optimization.html)。这包括经典 Fortran MINPACK 例程的 Java 翻译。

    *   [JLAPACK](http://icl.cs.utk.edu/f2j/)，另一个 Fortran 翻译。

    *   [优化算法工具包](http://optalgtoolkit.sourceforge.net/)。

    *   [Java 数字](http://scribblethink.org/Computer/Javanumeric/index.html)。

    *   一些 Python 实现。纯 Python 就可以了，因为它可以用 jythonc 编译成 Java。

*   是否有任何常用的启发式方法来进行 LM 所需的初始猜测？

*   在我的应用程序中，我需要对解决方案设置一些约束，但幸运的是它们很简单：我只要求解决方案（为了成为物理解决方案）是非负的。稍微负的解决方案是数据测量不准确的结果，显然应该为零。我正在考虑使用“常规”LM，但会进行迭代，以便如果某些未知数变为负数，我将其设置为零并从中解决其余的问题。真正的数学家可能会嘲笑我，但你认为这可行吗？

感谢您的任何意见！

**更新**：这不是火箭科学，要解决的参数数量（N）最多为 5 个，数据集几乎不足以解决问题，所以我相信 Java 足够有效地解决这个问题。而且我相信这个问题已经被聪明的应用数学家解决了无数次，所以我只是在寻找一些现成的解决方案，而不是自己做饭。例如，如果它是纯 Python，Scipy.optimize.minpack.leastsq 可能会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T14:07:24.310

您最初的猜测越接近解决方案，您收敛的速度就越快。

你说这是一个非线性问题。您可以做一个线性化的最小二乘解决方案。也许您可以使用该解决方案作为第一个猜测。一些非线性迭代将告诉您假设的好坏。

另一个想法是尝试另一种优化算法。如果您可以在许多 CPU 上运行遗传算法和蚁群算法，它们可能是一个不错的选择。它们也不需要连续的导数，所以如果你有离散的、不连续的数据，它们就很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-26T23:45:13.973

如果您的问题有约束，则不应使用无约束求解器。例如，如果知道你的一些变量必须是非负的，你应该告诉你的求解器。

如果您乐于使用 Scipy，我会推荐 scipy.optimize.fmin_l_bfgs_b 您可以使用 L-BFGS-B 对变量设置简单的界限。

请注意，L-BFGS-B 采用一般非线性目标函数，而不仅仅是非线性最小二乘问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-27T15:10:01.977

我同意codehippo；我认为解决约束问题的最佳方法是使用专门设计用于处理它们的算法。在这种情况下，L-BFGS-B 算法应该是一个很好的解决方案。

但是，如果在您的情况下使用 python 的 scipy.optimize.fmin_l_bfgs_b 模块不是一个可行的选择（因为您使用的是 Java），您可以尝试使用我编写的库：a Java wrapper for the original Fortran code of the L-BFGS -B 算法。您可以从[http://www.mini.pw.edu.pl/~mkobos/programs/lbfgsb_wrapper](http://www.mini.pw.edu.pl/~mkobos/programs/lbfgsb_wrapper)下载它，看看它是否符合您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-25T08:21:18.540

FPL 包非常可靠，但由于它对旧 fortran 代码的字面解释，有一些怪癖（数组访问从 1 开始）。如果你的函数表现良好，LM 方法本身就非常可靠。强制非负约束的一种简单方法是使用参数的平方而不是直接使用参数。这可能会引入虚假的解决方案，但对于简单的模型，这些解决方案很容易被筛选掉。

有可用于“受约束”LM 方法的代码。在这里查看[http://www.physics.wisc.edu/~craigm/idl/fitting.html](http://www.physics.wisc.edu/~craigm/idl/fitting.html)以获取 mpfit。有一个 python（不幸的是依赖于 Numeric）和一个 C 版本。LM 方法大约有 1500 行代码，因此您可能倾向于将 C 移植到 Java。事实上，“受约束的”LM 方法与您设想的方法并没有太大区别。在 mpfit 中，代码根据变量的界限调整步长。我在 mpfit 上也取得了不错的成绩。

我在 BFGS 方面没有太多经验，但代码要复杂得多，而且我一直不清楚代码的许可。

祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T08:28:17.587

我实际上并没有使用过任何这些 Java 库，所以对此持保留态度：基于后端，我可能会首先查看 JLAPACK。我相信 LAPACK 是[Numpy](http://www.scipy.org)的后端，它本质上是在 Python 中进行线性代数/数学运算的标准。至少，您绝对应该使用优化良好的 C 或 Fortran 库而不是纯 Java，因为对于大型数据集，这些类型的任务可能会变得非常耗时。

对于创建初始猜测，这实际上取决于您尝试拟合的函数类型（以及您拥有的数据类型）。基本上，只需寻找一些相对快速（可能是 O(N) 或更好）的计算，这些计算将为您想要的参数提供一个近似值。（我最近在 Numpy 中使用高斯分布进行了此操作，并且我估计了平均值`average(values, weights = counts)`- 即直方图中计数的加权平均值，这是数据集的真实平均值。它不是精确的中心我正在寻找的峰值，但它已经足够接近了，算法完成了剩下的工作。）

至于保持约束积极，你的方法似乎是合理的。由于您正在编写一个程序来完成这项工作，也许只需制作一个布尔标志，让您轻松启用或禁用“强制非负”行为，并以两种方式运行以进行比较。只有当你得到一个很大的差异（或者如果一个版本的算法花费了不合理的时间），它可能是值得担心的。（真正的数学家会从头开始分析地进行最小二乘法最小化；-P 所以我认为你是可以嘲笑他们的人......开玩笑。也许吧。）

# .net - 如何从 web 服务中使用属性“描述”

> ID：540418
> 
> 赞同：1
> 
> 时间：2009-02-12T08:00:04.240
> 
> 标签：.net, wcf

在客户端使用代理生成器生成代码时，客户端不会生成枚举值的属性。我怎样才能在客户端也制作它们？

例如，在服务或网络服务中：

```
[DataContract]
punlic enum Periods
{
    [Description("2 months")]
    [EnumMember]
    TwoMonths,
}

(or)

[DataContract]
punlic enum Periods
{
    [XMLEnum(Value = "2 months")]
    [EnumMember]
    TwoMonths,
} 
```

但在客户端（消费者 - 消费网络服务），它只生成：

```
 [System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "2.0.50727.1433")]
    [System.SerializableAttribute()]
    [System.Xml.Serialization.XmlTypeAttribute(Namespace="http://namespace" +
        "")]
    public enum Periods{

        /// <remarks/>
        TwoMonths,
} 
```

如何从 Web 服务访问描述属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T08:14:33.783

您不能强制执行此操作 - mex/WDSL 描述符仅包含与类型关联的信息的一小部分。

如果您控制客户端，一种选择是在本地声明枚举（甚至所有类型），然后从那里消费。您应该能够使用该`svcutil /reference:<path>`开关来使用现有程序集中的类型（IDE 提供相同的功能）。但请注意，这部分违反了 SOA 的规则（即，您使用的信息比服务合同承诺的要多）。

# fonts - 如何：字体平滑测试

> ID：540426
> 
> 赞同：1
> 
> 时间：2009-02-12T08:03:28.287
> 
> 标签：fonts, smoothing, antialiasing

真正的问题是：

我试图弄清楚我的网页中字体平滑的效果。在我的 LCD 面板上，文本看起来与字体平滑开/关相同。

是否有任何需要平滑的特定字体。你能推荐任何最适合字体平滑的示例字体吗（即它在应用平滑时效果很好）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T08:22:41.033

从理论上讲，所有字体都应该受益，但在实践中它们受益多少取决于使用的字体和使用的字体光栅化技术。

几篇关于字体光栅化的好文章是[子像素字体渲染的工作](http://www.grc.com/ctwhat.htm)原理和[文本光栅化曝光](http://www.antigrain.com/research/font_rasterization/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:13:53.673

默认情况下，大多数现代 Web 浏览器都将使用字体平滑。您可以将其关闭，以查看它在不使用它的人身上的效果。例如，这是[一篇关于在 IE7 中这样做](http://blogs.msdn.com/ie/archive/2006/02/03/524367.aspx)的文章。

# python - C 通过 SWIG 到 Python：无法获取 void** 参数来保持其值

> ID：540427
> 
> 赞同：8
> 
> 时间：2009-02-12T08:04:16.413
> 
> 标签：python, c, swig, word-wrap

我有一个看起来像这样（简化）的 C 接口：

```
extern bool Operation(void ** ppData);
extern float GetFieldValue(void* pData);
extern void Cleanup(p); 
```

使用如下：

```
void * p = NULL;
float theAnswer = 0.0f;
if (Operation(&p))
{
   theAnswer = GetFieldValue(p);
   Cleanup(p);
} 
```

您会注意到 Operation() 分配缓冲区 p，GetFieldValue 查询 p，而 Cleanup 释放 p。我对 C 接口没有任何控制权——该代码在其他地方被广泛使用。

我想通过[SWIG](http://www.swig.org/)从 Python 调用此代码，但我找不到任何关于如何将指针传递给指针并检索其值的好的示例。

我认为正确的方法是使用类型映射，所以我定义了一个接口，它会在 C 端为我自动取消引用 p：

```
%typemap(in) void** {
   $1 = (void**)&($input);
} 
```

但是，我无法让以下 python 代码工作：

```
import test
p = None
theAnswer = 0.0f
if test.Operation(p):
   theAnswer = test.GetFieldValue(p)
   test.Cleanup(p) 
```

调用 test.Operation() 后，p 始终保持其初始值 None。

任何帮助找出在 SWIG 中执行此操作的正确方法将不胜感激。否则，我可能只是围绕 C 代码编写一个 C++ 包装器，以阻止 Python 处理指针。然后用 SWIG包装*该包装器。*有人阻止我！

编辑：

感谢[Jorenko](https://stackoverflow.com/users/7161/jorenko)，我现在有了以下 SWIG 界面：

```
% module Test 
%typemap (in,numinputs=0) void** (void *temp)
{
    $1 = &temp;
}

%typemap (argout) void**
{
    PyObject *obj = PyCObject_FromVoidPtr(*$1, Cleanup);
    $result = PyTuple_Pack(2, $result, obj);
}
%{
extern bool Operation(void ** ppData); 
extern float GetFieldValue(void *p); 
extern void Cleanup(void *p);
%} 
%inline 
%{ 
    float gfv(void *p){ return GetFieldValue(p);} 
%} 

%typemap (in) void*
{
    if (PyCObject_Check($input))
    {
        $1 = PyCObject_AsVoidPtr($input);
    }
} 
```

使用这个 SWIG 接口的 python 代码如下：

```
import test 
success, p = test.Operation()
if success:
   f = test.GetFieldValue(p) # This doesn't work 
   f = test.gvp(p) # This works! 
   test.Cleanup(p) 
```

奇怪的是，在 python 代码中， test.GetFieldValue(p) 返回乱码，但 test.gfv(p) 返回正确的值。我已经将调试代码插入到 void* 的类型映射中，并且两者都具有相同的 p 值！电话 对此有何想法？

**更新：**我决定使用 ctypes。容易得多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T14:46:30.440

我同意你的观点，你应该使用 ctypes 代替。它总是比考虑类型映射更容易。

但是，如果你死心塌地使用 swig，你需要做的就是为返回`void**`新分配的 RETURNS创建一个类型映射`void*`：

```
%typemap (in,numinputs=0) void** (void *temp)
{
    $1 = &temp;
}

%typemap (argout) void**
{
    PyObject *obj = PyCObject_FromVoidPtr(*$1);
    $result = PyTuple_Pack(2, $result, obj);
} 
```

然后你的 python 看起来像：

```
import test
success, p = test.Operation()
theAnswer = 0.0f
if success:
   theAnswer = test.GetFieldValue(p)
   test.Cleanup(p) 
```

编辑：

我希望 swig 能够`void*`自己优雅地处理一个简单的按值 arg，但以防万一，这里是包装`void*`GetFieldValue() 和 Cleanup() 的 swig 代码：

```
%typemap (in) void*
{
    $1 = PyCObject_AsVoidPtr($input);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T08:39:09.293

你愿意使用 ctypes 吗？这是应该可以工作的示例代码（尽管它未经测试）：

```
from ctypes import *

test = cdll("mydll")

test.Operation.restype = c_bool
test.Operation.argtypes = [POINTER(c_void_p)]

test.GetFieldValue.restype = c_float
test.GetFieldValue.argtypes = [c_void_p]

test.Cleanup.restype = None
test.Cleanup.argtypes = [c_void_p]

if __name__ == "__main__":
    p = c_void_p()
    if test.Operation(byref(p)):
        theAnswer = test.GetFieldValue(p)
        test.Cleanup(p) 
```

# c# - assembly.GetExportedTypes() 显示不同的结果

> ID：540430
> 
> 赞同：0
> 
> 时间：2009-02-12T08:06:12.383
> 
> 标签：c#, vb.net

为什么 assembly.GetExportedTypes() 在 C# 和 VB.NET 中显示不同的结果？

这两个给出不同的结果

```
var v = from a in AppDomain.CurrentDomain.GetAssemblies() from b in a.GetExportedTypes() select b; 
v.Count(); 

Dim v = From a In AppDomain.CurrentDomain.GetAssemblies(), b In a.GetExportedTypes()     Select b v.Count() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T08:48:21.407

当你编译一个 VB.NET 程序集时，它包括一些额外的“帮助”类型。使用[Reflector](http://www.red-gate.com/products/reflector/)查看您编译的程序集以了解我的意思。

我很确定您会发现唯一有任何差异的程序集是您用于进行反射的程序集 - 即使用 C# 或 VB.NET 构建的程序集，具体取决于您的方案。

编辑：这完全取决于你如何定义你的类。

但是，这*仅与**C# 或 VB 编译器*正在编译的代码有关。当你打电话时，你用`GetExportedTypes`什么语言打电话都没有关系。您只是在写出总数这一事实让您感到困惑。这里有两个简短但完整的程序来显示差异：

**C＃**

```
using System;
using System.Reflection;

public class ShowTypeCounts
{
    static void Main()
    {
        AppDomain domain = AppDomain.CurrentDomain;
        foreach (Assembly assembly in domain.GetAssemblies())
        {
            Console.WriteLine("{0}: {1}",
                              assembly.GetName().Name,
                              assembly.GetExportedTypes().Length);
        }
    }
} 
```

结果：

```
mscorlib: 1282
ShowTypeCounts: 1 
```

**VB**

```
Imports System
Imports System.Reflection

Public Module ShowCounts

    Sub Main()
        Dim domain As AppDomain = AppDomain.CurrentDomain

        For Each assembly As Assembly in domain.GetAssemblies

            Console.WriteLine("{0}: {1}", _
                              assembly.GetName.Name, _
                              assembly.GetExportedTypes.Length)

        Next
    End Sub

End Module 
```

结果：

```
mscorlib: 1282
ShowTypeCounts: 1 
```

如您所见，结果是相同的 - 但如果您从任一代码段中删除“public”，ShowTypeCounts 结果将降至 0。这与 GetExportedTypes 在语言之间的工作方式没有区别 - 它仅取决于您实际导出的类型。

我的猜测是，在您的控制台应用程序中，一个有公共类型，另一个没有。

# cross-platform - 平台独立性有多重要？

> ID：540432
> 
> 赞同：4
> 
> 时间：2009-02-12T08:06:31.493
> 
> 标签：cross-platform

许多软件框架、语言、平台都声称平台独立性并将其吹嘘为卖点。但是，我一直无法理解这怎么会有这么重要的功能。例如，据说 Java 是独立于平台的——但是当我知道我的 web 应用程序将只在一个平台上运行时，我为什么还要关心呢？使应用程序平台独立的开销真的值得吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T08:11:55.443

对于 webapps 来说，这几乎不是问题，因为根据定义，它们几乎是“平台独立的”。我的意思是，应用程序的用户大多不依赖于任何特定平台。

对于桌面应用程序，这是您潜在客户群的问题。如果你认为你会从多平台定位中受益，那么让你的应用程序平台独立是值得的，否则最好远离它:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T08:14:46.840

如果您知道您的应用程序将只在一个平台上运行，您不应该关心 - 您应该使用与目标平台上的所有其他框架相同的标准来评估框架。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T08:15:40.083

这当然取决于所讨论的应用程序。如果您*知道*应用程序将只在一个平台上运行，那么显然没有理由要求它独立于平台。另一方面，如果您正在构建一个应用程序，该应用程序应该可以使用，例如，未来 15 年，您怎么知道您选择的平台会在那时存在？很难预测未来，因此让您的应用程序平台独立可以让您少一个头痛。

平台独立性并不一定意味着开销。相反，它意味着良好的编程实践；如果您使您的应用程序与平台正交，那么更改平台是轻而易举的事。

有时不可能避免依赖于平台的函数调用，例如因为必须在低级别直接与某些硬件设备通信。即使这样，也有可能使应用程序“几乎独立于平台”。不要将依赖于平台的东西分散到任何地方，而是将它们严格地包装到一个类/包/任何东西中。然后，您只需要更改一个单元即可将您的应用程序翻译到另一个平台。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T08:19:57.763

我们开发了一个仅适用于 Unix 的 Java B2B 应用程序，但适用于所有 Unix 风格（Java 可用的地方）。

拥有多平台应用程序的优势在于，我们的客户有时了解 Linux，有时了解 Solaris，有时了解 FreeBSD，...

这样我们可以适应客户，而不是强迫他们使用一个特定的平台

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T08:22:59.753

> *例如，据说 Java 是独立于平台的——但是当我知道我的 web 应用程序将只在一个平台上运行时，我为什么还要关心呢？*

它对你没有好处的事实并不意味着它没有好处。我敢肯定，许多 Java 开发人员都喜欢他们不必为每个平台重新编译他们的应用程序这一事实（因此这是一个卖点）。**如果**将来其他平台也受到关注，那么专门为某些组件使用 Active X 的 Web 应用程序将面临更多障碍。

> 使应用程序平台独立的开销真的值得吗？

取决于开销的含义。如果它是一个好的框架，那么开销可能很小。当然，如果您对其他平台不感兴趣，那么是的，这是开销。然而，事实是，与大约十年前不同，如今越来越多的平台开始变得重要（至少对于 Web 和桌面应用程序而言）。因此，从长远来看，开销可能是值得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T08:12:54.910

如果您只开发服务器端，那么您目前可能不需要照顾它。但是，如果需要（例如，如果客户要求，或者如果您有特定的性能/功能需求），您可能会非常高兴地发现您可以在另一个操作系统上无缝运行您的应用程序。

对于客户端应用程序，平台独立性意味着能够为 Mac 和 Linux 提供更少的工作，是的，这可能是值得的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T08:16:19.830

你几乎回答了你自己的问题。仅当您希望应用程序在多个平台上工作时，平台独立性才重要。如果你不这样做，那就少了一件需要担心的事情。

以 OpenOffice 或 Firefox 为例。您可以在每个主要平台上使用它们。这对他们来说很重要，因为他们希望每个人都能够使用它们并拥有相同的体验，无论他们的操作系统是什么。

如果您的项目较小并且不需要在每个平台上都存在，那么请不要担心。这确实是对您开发的每个程序的判断。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T08:18:21.027

> 但是当我知道我的 webapp 将只在一个平台上运行时，我为什么要关心呢？

你不应该。如果您*知道*您将只在一个平台上运行，那么平台独立性与您的关系不大。

但你并不等于所有潜在用户。其他人会希望在多个平台上瞄准个人电脑。

这就像有一个中文版本。如果您只在英语国家销售，那是无关紧要的。如果你想在中国销售，它可能会有所帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T08:21:27.213

从理论上讲，平台独立性可以帮助您避免所谓的“供应商锁定”，同时为您提供更广泛的覆盖范围和潜在的更多客户。

实际上，您应该评估您的目标受众，并对能够交付到多个平台的利润潜力是否超过采用平台独立框架的成本进行良好的业务计算。毕竟，该框架可能声称在所有平台上都可以正常工作，但您必须验证该声明。更不用说没有任何框架可以解决交付应用程序的所有问题，例如部署、配置、集中管理、更新/升级等。

当然，如果您的产品是基于服务器的，并且最终用户将通过 HTTP 代理使用它，您不必担心。在大多数情况下，只要您停留在 HTML、JavaScript 和 Flash 的 [相对] 安全领域。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-12T08:36:30.920

平台独立性对于软件供应商来说是一个理想的特性，因为他们投入大量资金开发现代、复杂的应用程序，因此他们不想人为地切断任何市场细分。他们想把孩子卖给尽可能多的组织。

软件供应商试图让 IT 部门相信平台独立性是一件好事，因为它避免了供应商锁定。从理论上讲，我确信这很重要；然而，在实践中，大多数 IT 部门会自行将他们的态度强加给供应商锁定，通常是针对某个知名的特定技术供应商。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-12T11:35:21.210

“平台独立性”对不同的人可能意味着不同的事情。例如，“Windows XP”与“XP 64”、Vista 或 Windows 7 是不同的平台吗？这取决于您是否编写应用程序软件或驱动程序，以及您依赖的预安装库和服务。

在最一般的意义上，没有应用程序可以*真正*独立于平台——您不会期望在烤面包机的嵌入式 Linux 或 16-MB Windows 3.11 机器上运行 Web 应用程序。

但是将平台独立性作为架构目标的软件框架通常会在您的平台发生变化时做好更好的准备，并且在任何长期存在的项目中，它*都会*发生变化，如果只是因为每 3-5 年会更换一次硬件，并且经常会出现新硬件使用新的操作系统版本。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-13T12:01:30.000

你总是为灵活性买单。

总是。

决定成本是否值得（回报可能非常高）完全取决于手头的个人/公司的需求，但总会有成本。其中许多是隐含假设的，例如：

大多数人对文件系统不可知 [1] api 进行编码，而不是假设特定实现，并且这种选择通常是正确的，以至于在该领域没有任何特定要求的情况下，这是一个合理的默认选择。

尽管如此，有时值得每隔一段时间重新审视一下你的核心假设，**以了解它们是什么**

[1] 至少可以说它是一个带有路径分隔符“/”的树，而不是说 ext3、NTFS、ReiserFS 等......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-12T08:14:41.520

对于只有您将使用的 Web 应用程序，独立于平台的唯一一点是，如果您更改服务器，它会让您更轻松。

当然，像 Java 这样的语言不仅仅用于 Web 应用程序——人们也用它们编写独立的（-ish）桌面程序，对于那些独立于平台的人来说更有用。Sun 可以确保 Java 在一大堆不同的计算机上运行，​​并且基本上每个 Java 应用程序开发人员都可以免费分享这项工作的好处。这对手机应用程序（不是 iPhone 或 Android，而是老式基本手机）的开发人员特别有益：为每部不同的手机编写不同的代码将是一场噩梦。许多手机都包含用于运行应用程序的 JRE，这一事实使开发人员的工作更加轻松。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-12T08:36:56.927

即使对于桌面应用程序，跨平台也是一个问题的一个领域是科学界的软件。根据我的经验，学院中的桌面比你在家里、办公室等看到的要多样化得多。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-12T08:54:12.610

当您针对某个平台时，平台独立性不是什么大问题，但在您*编写*应用程序时却是。有一些库和框架可以解决您可能遇到的任何问题。只有您不能使用它们，除非它们是为您的目标平台编写的。

这就是为什么库或框架尽可能独立于平台通常是一件好事，因为地球上的每个开发人员都是可能的客户。在下一步中，应用程序开发人员可以更轻松地编写可在任何平台上运行的代码。在过去的几年里，我们看到 Mac 和 Linux 的用户数量稳步增长。所以，如果你能以很少的额外成本卖给他们，为什么不呢？

# asp.net - 控制Repeater中的范围，有和没有UpdatePanel

> ID：540435
> 
> 赞同：2
> 
> 时间：2009-02-12T08:08:05.203
> 
> 标签：asp.net, updatepanel, scope, repeater

为什么以下给我行 B（Label2，UpdatePanel 外部）的编译错误，而不是 A 行（Label1，UpdatePanel 内部）的编译错误？我本来希望这两行都会出错，因为两个控件都在同一个中继器内，因此不应在中继器外部直接访问，因为没有一个唯一的实例。

```
<script runat="server">
    protected void Page_Load(object sender, EventArgs e)
    {
        Label1.Text = Label1.ClientID;  // Line A - compiles fine
        Label2.Text = Label2.ClientID;  // Line B - "The name 'Label2' does not exist in the current context"
    }
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <asp:ScriptManager ID="ScriptManager1" runat="server" />
            <asp:Repeater runat="server" ID="Repeater1">
                <ItemTemplate>
                    <asp:UpdatePanel runat="server" ID="UpdatePanel1">
                        <ContentTemplate>
                            <asp:Label ID="Label1" runat="server" Text="Label1" />
                        </ContentTemplate>
                    </asp:UpdatePanel>
                    <asp:Label ID="Label2" runat="server" Text="Label2" />
                </ItemTemplate>
            </asp:Repeater>
        </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T09:25:11.460

我敢打赌，如果您注释掉 B 行，您将在执行时收到运行时错误。Label1 将是一个空引用。

当您在 ASPX 页面中创建控件时，Visual Studio 会尝试通过将控件添加到扩展页面类的设计器文件中的代码来帮助您。在这种情况下，它会在不应该添加的时候添加一个。

简短的回答是这是一个错误。您应该提交它，但它不应该是一个阻塞问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T13:33:53.827

真正的问题是为什么要在中继器中创建多个更新面板？把一个放在中继器外面并称之为好。或者，如果您只想刷新一些文本而不使用更新面板，请使用带有一些客户端脚本的回调来设置 dom 元素。看看这个[http://encosia.com/2007/07/11/why-aspnet-ajax-updatepanels-are-dangerous/](http://encosia.com/2007/07/11/why-aspnet-ajax-updatepanels-are-dangerous/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:34:56.257

无论如何，这些都不合适。您不应该尝试直接引用 ItemTemplate 中包含的控件。

如果你想在运行时修改这些标签，你应该使用 OnItemDataBound 和 FindControl。要在 UpdatePanel 中“找到”标签，您需要使用 UpdatePanel.ContentTemplateContainer.FindControl()。

# iphone - 获取 iPhone 的平台信息

> ID：540438
> 
> 赞同：0
> 
> 时间：2009-02-12T08:10:02.903
> 
> 标签：iphone, cocoa-touch

如何获取 sdk 版本等 iPhone 系统信息？我需要的信息和你的 iphone/itouch 连接 iTunes 时看到的设备信息类似。我可以使用 UniqueDevice 来获取序列号，但似乎无法在其中找到任何系统属性或请求方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T08:16:06.603

查看 UIDevice 类 - 这几乎就是您将从 SDK 获得的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:15:01.503

我认为 SDK 是指系统版本...所以检查 [UIDevice systemVersion](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIDevice_Class/Reference/UIDevice.html#//apple_ref/occ/instp/UIDevice/systemVersion)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T08:44:03.463

感谢您的回答。我一定是瞎了，他们一直就在我眼前。这是我用来获取所需数据的代码。

serial_no = [[UIDevice currentDevice] uniqueIdentifier]; 版本 = [[UIDevice currentDevice] systemVersion]; system = [[UIDevice currentDevice] systemName];

# android - Android：BaseAdapter 怎么用？

> ID：540461
> 
> 赞同：3
> 
> 时间：2009-02-12T08:17:26.583
> 
> 标签：android, listview, adapter, android-cursor

好的，我一直在搜索，并且在实现 BaseAdapter 时遇到了一些问题。

根据上面的示例，我已经能够实现一个简单的光标适配器 [http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/List7.html 。](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/List7.html)

这里有一个很好的 BaseAdapter 示例：[List14 google example](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/List14.html)

我想使用 BaseAdapter 创建我自己的列表适配器来显示一个列表视图，其中包含来自数据库的多个项目。我知道这可以使用简单光标适配器来完成，但我希望以不同的方式处理行，所以我希望能够通过覆盖 getView 来绘制每一行。数据将从游标中提取。

我知道这段代码很难获取游标数据，但假设我已经填充了一个游标。如果第 8 列包含图像资源 ID，您对此有何建议。：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
    cursor.moveToPosition(position);
    ImageView i = new ImageView(mContext);
    i.setImageResource(cursor.getShort(8));
    i.setAdjustViewBounds(true);
    i.setLayoutParams(new AbsListView.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

    return i;
} 
```

你有使用光标绘制 BaseAdapter 的好例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-31T10:43:54.650

尝试`notifyDataSetChanged()`从自身内部的方法调用`BaseAdapter`。

[以 API Demo 的 List8 中的](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/view/List8.html)方法为例。

# c# - 如何从类文件（服务器端）向 .aspx 文件（客户端）发出请求？

> ID：540464
> 
> 赞同：0
> 
> 时间：2009-02-12T08:18:06.707
> 
> 标签：c#, asp.net, javascript, .net-2.0

这对我来说是不同的问题。我将 ASP.NET2.0 与 AJAX、C# 一起使用。

客户端定期从 HTML（客户端）向任何类（.cs）文件（服务器端）发出请求。然后通过对象或数据库中的类文件进行更新。

但我想基于该对象从类文件（服务器端）向 HTML 文件（客户端）发出请求。

我还使用 HashTable 来包含 Key 并与该 Object 相关。

如果您无法理解，那么我尝试以不同的方式向您解释我的问题，我会给您一个简单的示例：我正在从 javascript 调用任何函数到我的类函数，现在我想从类函数调用到 javascript 函数。

请简要解释一下，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T08:21:59.083

您实际上可以在部分页面回发期间更改 UpdatePanel 的内容。因此，如果客户端单击 ASPX 页面上的某些内容会改变服务器端的对象，则可以在往返过程中更新 ASPX 页面上的控件。

如果您需要在没有用户交互的情况下偶尔更新您的视图，那么[ASP.NET AJAX Timer 控件](http://msdn.microsoft.com/en-us/library/system.web.ui.timer.aspx)将有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T08:06:32.023

从客户端与服务器端代码交互的三种方法：

1.  更新面板：这使用部分回发，其中页面本质上是对服务器进行完整回发，然后忽略更新面板中的所有内容，然后将结果发回。

2.  页面方法 - 这可能不是您正在寻找的，因为页面方法要求该方法在页面本身上是静态的。

3.  Web 服务方法 - 这些与您可以从后面的 aspx 代码中使用的 Web 服务相同，但您需要页面上的脚本管理器才能从 javascript 中使用它们。

# java - 如何将 MS JDBC 驱动程序与 MS SQL Server 2008 Express 一起使用？

> ID：540489
> 
> 赞同：13
> 
> 时间：2009-02-12T08:28:32.313
> 
> 标签：java, sql-server, jdbc

我的配置：

*   视窗 XP SP3
*   JDBC 2005
*   MS SQL Server 2008 Express，通过端口 1433 上的 tcp/ip 公开
*   类路径中的 sqljdbc.jar

我试过：

```
try {
    Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();
    con = DriverManager.getConnection("jdbc:microsoft:sqlserver://localhost:1433/SQLEXPRESS2008;databaseName=Test;selectMethod=cursor", "sa", "");
}
catch (Exception e) {
    e.printStackTrace();
} 
```

但它总是抛出一个异常：

```
java.sql.SQLException: No suitable driver 
```

我还尝试了以下网址：

```
localhost:1433/SQLEXPRESS2008

localhost/SQLEXPRESS2008

localhost 
```

结果相同。有什么帮助吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-29T01:48:33.923

你有错误的网址。

我不知道您所说的“JDBC 2005”是什么意思。当我查看 microsoft 站点时，我发现了一个名为[Microsoft SQL Server JDBC Driver 2.0](http://www.microsoft.com/downloads/details.aspx?FamilyID=99b21b65-e98f-4a61-b811-19912601fdc9&displaylang=en)的东西。 ~~你会想要那个 - 它包括许多修复和一些性能改进。~~[编辑：您可能需要最新的驱动程序。截至 2012 年 3 月，Microsoft 最新的 JDBC 驱动程序是[JDBC 4.0]](http://www.microsoft.com/en-us/download/details.aspx?id=11774)

检查发行说明。对于此驱动程序，您需要：

```
URL:  jdbc:sqlserver://server:port;DatabaseName=dbname
Class name: com.microsoft.sqlserver.jdbc.SQLServerDriver 
```

看来您的类名正确，但 URL 错误。

Microsoft 在最初发布 JDBC 驱动程序后更改了类名和 URL。您使用的 URL 与 Microsoft 的原始 JDBC 驱动程序一起使用，MS 将其称为“SQL Server 2000 版本”。但是该驱动程序使用不同的类名。

对于所有后续驱动程序，URL 更改为我在这里的形式。

这在 JDBC 驱动程序的发行说明中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-08T13:01:21.803

如果你的`databaseName`值是正确的，那么使用这个：`DriverManger.getconnection("jdbc:sqlserver://ServerIp:1433;user=myuser;password=mypassword;databaseName=databaseName;")`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-02T07:13:16.810

1.  `sqljdbc4.0`从 Microsoft 的网站下载最新的 JDBC 驱动程序（即）
2.  编写程序如下：

    ```
    import java.sql.*;
    class testmssql
    {
        public static void main(String args[]) throws Exception
        {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            Connection      con=DriverManager.getConnection("jdbc:sqlserver://localhost:1433;
                    databaseName=chapter16","sa","123");//repalce your databse name and user name
                Statement st=con.createStatement();
            ResultSet rs=st.executeQuery("Select * from login");//replace your table name
            while(rs.next())
            {
                String s1=rs.getString(1);
                String s2=rs.getString(2);
                System.out.println("UserID:"+s1+"Password:"+s2);
            }
            con.close();
        } 
    } 
    ```

3.  编译程序并设置 jar 类路径即：`set classpath=C:\jdbc\sqljdbc4.jar;.;`如果您在下载和解压缩后保存了`jar`文件。`C:\jdbc`

4.  运行程序并确保您的 TCP/IP 服务已启用。如果未启用，请按照以下步骤操作：
    1.  转到开始 -> 所有程序 -> Microsoft SQL Server 2008 -> 配置工具 -> SQL Server 配置管理器
    2.  展开 Sql Server 网络配置：选择您的 MS SQL Server 实例，即。MSQSLSERVER 并启用 TCP/IP。
    3.  重新启动您的 MS SQL Server 实例。这也可以从 MS SQL Server 实例根级别的 Microsoft SQL Server Management Studio 的右键菜单中完成

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T05:44:55.547

最新的 JDBC MSSQL 连接驱动可以在 [JDBC 4.0上找到](http://www.microsoft.com/en-us/download/details.aspx?id=11774)

类文件应该在类路径中。如果您使用的是 eclipse，您可以通过执行以下操作轻松地做同样的事情 -->

> 右键单击项目名称 --> 属性 --> Java 构建路径 --> 库 --> 添加外部 Jar

同样正如@Cheeso 已经指出的那样，正确的访问方式是 jdbc:sqlserver://server:port;DatabaseName=dbname

同时，请找到一个用于访问 MSSQL DB 的示例类（在我的例子中是 2008 年）。

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class ConnectMSSQLServer
{
   public void dbConnect(String db_connect_string,
            String db_userid,
            String db_password)
   {
      try {
         Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
         Connection conn = DriverManager.getConnection(db_connect_string,
                  db_userid, db_password);
         System.out.println("connected");
         Statement statement = conn.createStatement();
         String queryString = "select * from SampleTable";
         ResultSet rs = statement.executeQuery(queryString);
         while (rs.next()) {
            System.out.println(rs.getString(1));
         }
         conn.close();
      } catch (Exception e) {
         e.printStackTrace();
      }
   }

   public static void main(String[] args)
   {
      ConnectMSSQLServer connServer = new ConnectMSSQLServer();
      connServer.dbConnect("jdbc:sqlserver://xx.xx.xx.xxxx:1433;databaseName=MyDBName", "DB_USER","DB_PASSWORD");
   }
} 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-07T17:09:16.453

命名实例？

URL：jdbc:sqlserver://[serverName][\instanceName][:portNumber][;property=value]

注意：反斜杠

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-05T10:56:36.923

您可以尝试以下方法。在我的情况下工作正常：

1.  下载当前的[jTDS JDBC 驱动程序](http://jtds.sourceforge.net/)
2.  将 jtds-xxxjar 放在你的类路径中。
3.  将 ntlmauth.dll 复制到 windows/system32。根据您的硬件 x86,x64 选择 dll...
4.  连接 url 为： 'jdbc:jtds:sqlserver://localhost:1433/YourDB' ，您不必提供用户名和密码。

希望有帮助。

# .htaccess - .htaccess 带或不带斜线

> ID：540493
> 
> 赞同：20
> 
> 时间：2009-02-12T08:31:06.753
> 
> 标签：.htaccess, mod-rewrite, rewrite

我需要对以下重写规则做些什么才能使其生效，无论它们是否是 URL 末尾的斜杠？

IE。 [http://mydomain.com/content/featured](http://mydomain.com/content/featured) 或 [http://mydomain.com/content/featured/](http://mydomain.com/content/featured/)

```
RewriteRule ^content/featured/ /content/today.html 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-12T08:45:57.513

使用`$`标记字符串的结尾，使用`?`标记前面的表达式重复零次或一次：

```
RewriteRule ^content/featured/?$ content/today.html 
```

但我建议您坚持使用一种符号并纠正拼写错误：

```
# remove trailing slashes
RewriteRule (.*)/$ $1 [L,R=301]

# add trailing slashes
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .*[^/]$ $0/ [L,R=301] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-06T04:50:16.630

简单的方法：

```
RewriteEngine On
RewriteBase / 
RewriteRule ^content/featured(\/||)$ /content/today.html [L,R=301,NC] 
```

# php - 如何解决 Google 日历的链接重定向通知？

> ID：540496
> 
> 赞同：0
> 
> 时间：2009-02-12T08:33:24.720
> 
> 标签：php, javascript, ajax, xss, google-calendar-api

我在网页上嵌入了一个 Google 日历，其中包含与该网站正在组织的活动相关的事件。某些日历活动具有将用户重定向到同一网站内的页面的链接，该页面包含更多信息和参加活动的选项。

然而问题在于，自上月底以来，谷歌发布了一个甚至不会自动重定向的重定向通知。我在事件中创建的链接由 Google 更改，一旦用户单击链接，就会打开一个新选项卡，指向一个页面，其中包含用户必须单击的重定向警告。由于我为用户提供了指向同一网站内的链接，这非常不方便，而且毫无意义。

我希望用户能够单击日历上的链接并访问包含相关数据的网页。

你们知道我该如何绕过这个警告吗？

我的思考过程：

1.  最初，我想使用 JS 来重写链接，但由于日历的 iframe 位于不同的域中，由于 XSS 漏洞（AFAIK），浏览器不会允许它。

2.  我可以构建自己的 AJAX 日历并使用 Google 的 API 将其与 Google 同步，但由于愚蠢的“功能”毫无意义，这将是大量工作。我喜欢 Google 的日历，我想使用它。

3.  我想到的第三件事是，我可以使用 AJAX 来获取框架 url 上的整个代码，而不是使用带有日历的 iframe。然后我只需用 JS 重写该代码上的链接。这能行吗？

我会非常感谢任何帮助。这快把我逼疯了！

* * *

使用 Jon Cram 的输入，我创建了一个解析代码并进行调整的 php 脚本。但是我只能让它适用于 html 版本。对我来说没有 AJAX。=(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T15:02:01.120

同源策略将阻止从您的域提供的 JavaScript 与从不同域提供的数据进行交互。

因此，您说选项 1 行不通是对的。

正如您所说，相同的原产地政策也适用于选项 3。从您的域提供的 JavaScript 将无法向提供日历代码的任何域发出直接 HTTP 请求。

您将需要获取和修改日历代码，而这两者都无法使用当今最常用的浏览器使用 JavaScript 来实现。当 FireFox 3.1 和 IE8 被普遍使用*并且*Google 提供正确的 HTTP 访问控制标头时，这可以单独使用 JavaScript 来实现。

要修改从另一个域提供的代码，您将需要利用某种形式的服务器端进程。

服务器端脚本将能够请求日历代码。然后，相同的脚本可以根据需要修改代码并以您需要的任何形式输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T17:29:05.430

如果它是一个私人内部站点，您可以在所有客户端（如果他们使用 firefox）上安装[greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/748)，并制作一个修复网址的简短脚本。但这仅在原始 url 包含在 google 的 redirecturl 中时才有效。

如果我遇到这个问题，我会更改日历提供程序，这可能是最简单的解决方案。我进行了谷歌搜索并找到了[Kiko](http://kiko.com/)，看起来他们可能有你需要的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T03:16:25.107

只需删除 URL 的“http://”部分。我不确定为什么会这样，但确实如此！

# embedded - MPSOC：您使用哪种操作系统，为什么？

> ID：540503
> 
> 赞同：2
> 
> 时间：2009-02-12T08:36:38.440
> 
> 标签：embedded, rtos

我正在研究 MPSOC，特别是 STM ST40（SH4 基础）和 ST231，我想知道我可以在这些操作系统上使用哪个操作系统来移植并行应用程序，我已经看过[STLinux](http://www.stlinux.com/drupal/)，它是 Linux 平台的 STM 发行版对于他们的 MPSOC（不幸的是，它不适用于 ST231 协处理器），我还查看了 OS21，它是一个基于任务的操作系统。

热烈欢迎任何有关其他 RTOS 的信息！（特别是那些有 libc 和 pthreads 的 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T15:01:42.667

我想到了这4个：

**MicroC/OS-II** : 它免费且简单，但我认为可用的好资源太少了

**LibeRTOS**：我可以推荐。我在不同的项目中多次使用它。很好，速度很快，双内核概念做得很好。

**RTLinux**：不能告诉你太多关于那个。仅在一个非常小的项目中使用过一次，并没有深入“幕后”，但它快速可靠。（而且非常昂贵）

**VxWorks**：很棒的操作系统...来自维基百科：

*   具有抢占式和循环调度和快速中断响应的多任务内核
*   内存保护将用户应用程序与内核隔离开来
*   SMP 支持
*   快速、灵活的进程间通信，包括 TIPC
*   错误处理框架
*   具有优先级继承的二进制、计数和互斥信号量
*   本地和分布式消息队列
*   完整的 ANSI C 合规性和增强的 C++ 功能，用于异常处理和模板支持
*   POSIX PSE52 认证一致性
*   文件系统。
*   IPv6 网络堆栈
*   VxSim 模拟器
*   支持：C/C++/JAVA

如果钱没问题：使用 VxWorks！你可以做任何事情：升级你的冰箱、建造战争机器或飞往火星；-)

否则，请查看 LibeRTOS ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T19:44:12.407

如果您真的想使用 RTOS，请准备好使用比 pthreads 更高效、更精简的原生 API……

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T09:13:20.690

我在几个项目中使用了 Micrium 的 µC/OS-II，在 SH4 和几个不同的 ColdFires 上。我今天继续为新项目推荐它。

[Micrium](http://www.micrium.com/)刚刚宣布了一项名为 µC/OS-III 的重大升级，它将添加无限的抢占式调度线程，以及用于同等优先级线程的循环调度程序。但是，它似乎还没有出售。

如果您需要这些功能，它们还具有 FAT 文件系统、PEG 图形 UI 库、USB 设备和主机以及 TCP/IP，可用于额外的许可费用。

所有东西的源代码都包含在价格中，我一直发现他们的支持是友好和知识渊博的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T12:14:10.327

使用您提到的处理器，您似乎喜欢机顶盒。

你可以选择 ST Linux 发行版，它不是很稳定，而 OSXX 发行版是 ST 专有的，但更稳定，并且有很好的调试工具等（我不太确定 OSCC 和 libc /p线程）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-20T20:39:33.817

准系统/AMP - 因为它允许 100% 控制并且允许最低延迟。

使用 Linux 或 FreeRTOS 非常舒适，但它带有价格标签。

# silverlight - 为什么可以在没有默认命名空间的情况下解析 WPF/Silerlight XAML 文件？

> ID：540505
> 
> 赞同：0
> 
> 时间：2009-02-12T08:38:42.553
> 
> 标签：silverlight, namespaces

我读到“默认命名空间很重要，否则 XAML 解析器将无法识别元素”。

然而，作为一个测试，我把它拿出来，虽然视觉设计师不能再识别元素名称，但这个 Silverlight XAML 运行得很好：

```
<UserControl x:Class="Second12.Page"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <TextBlock Text="This is a test."/>
    </Grid>
</UserControl> 
```

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T09:39:48.087

也许这句话应该读作“不应该承认”。在没有默认命名空间定义的情况下，XAML 解析器假设无名称命名空间包含 XAML 元素，这似乎是一个合理的后备位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T10:37:21.613

我认为 Silverlight 解析器默认回退到 WPF silverlight 解析是合理的。

如果您使用了 Silverlight 解析器不支持的 wf xaml 甚至 WPF xaml，您会收到错误消息。

不过，我会看看让命名空间向前发展的重要性。

XAML 是 WPF 目前支持的一种语言，Silverlight 使用 WPF 的子集，WF 和 WCF 中的一点点。现在每个人都有自己的解析器。

使用 .net 4.0 会有 system.xaml.dll 或类似的东西。命名空间将意味着更多，因为它将进一步指导解析器。WPF、WF 和 WCF 都将使用该解析器，并且猜测未来的 silverlight 将使用它。

编辑，主要是顶级名称空间用于以解析器为每个组编写的方式提供智能感知模式。

# .net - 如果我想 rebase 我的 DLL，我该怎么做呢？

> ID：540509
> 
> 赞同：1
> 
> 时间：2009-02-12T08:39:42.520
> 
> 标签：.net, dll, rebasing

这是[这个问题](https://stackoverflow.com/questions/352519/-net-assemblies-and-dll-rebasing)的延续。

我正在测试是否对 .NET DLL 进行变基，NGENning 它们是否会在终端服务器的内存中为我提供更多共享代码。

但是，我的计划似乎有一个缺陷，我似乎无法找到一种工作方法来找出一组工作地址。

我认为我可以做的如下：

1.  只需构建和 NGEN 一切
2.  启动程序，确保所有 DLL 都已加载
3.  使用[LISTDLLS](http://technet.microsoft.com/en-us/sysinternals/bb896656.aspx) /R PROGRAMNAME 获取正在运行的实例的当前使用地址列表
4.  使用重新映射的那些 DLL 的地址作为这些 dll 的新基地址
5.  UN-NGEN 一切，从 1 开始

然而，这已经变成了[薛定谔](http://en.wikipedia.org/wiki/Copenhagen_interpretation)的练习，因为重新定位某些 DLL 的行为显然会改变加载顺序或操作系统重新定位其他 DLL 的方式。

例如，假设在初始运行后，我有一个列表，说明 DLL A、B 和 C 需要位于地址 1000、2000 和 3000。没有提及 DLL D、E 和 F，它们也是同一个系统。大概这些是在它们当前的基地址加载的，否则我会假设 LISTDLLS 会告诉我这一点。

所以我改变了A、B、C的地址，重复一切，现在DLL C、D和E已经被重新定位。A和B现在都好了，E和F现在搬家了，C还在被洗牌。

我意识到这个练习有点徒劳，因为不管我在我的机器上发现了什么，在目标终端服务器上使用和注入的 DLL 可能会干扰这张图片，但我认为如果我至少可以确保一些DLL 可以位于其规定的基地址，然后同一程序的多个实例之间的共享代码量会增加。只是说，只是为了没有必要“提醒”我:)

由于我们所有 DLL 的原始基地址是默认值，这意味着每个 DLL（可能除了第一个加载的）都被重新定位，因此映射到页面文件，我认为可能会有高于 0 的增益。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T00:50:16.970

您可以使用 DUMPBIN（包含在 Visual Studio 中）找出 DLL 的首选加载地址和内存范围，并根据这些数字进行规划。

dumpbin /headers 会给你：

```
 7DC90000 image base (7DC90000 to 7DD5FFFF) 
```

如果您根据首选装载地址进行计划，则应该没有问题。

# c++ - 命名构造函数和继承

> ID：540515
> 
> 赞同：1
> 
> 时间：2009-02-12T08:42:49.300
> 
> 标签：c++, inheritance, constructor, factory, named

我正在研究 C++ 框架，并希望将自动内存管理应用于许多核心类。到目前为止，我有标准的方法是

```
class Foo 
{

public:

  static
  shared_ptr<Foo> init() 
  {
    return shared_ptr<Foo>(new Foo);
  }

  ~Foo() 
  {
  }

protected:

  Foo()
  {
  }

};

// Example of use
shared_ptr<Foo> f = Foo::init(); 
```

但是，当我将 Foo 子类化时，上面的内容就中断了，因为即使 tho`init()`是继承的，它仍然返回`shared_ptr<Foo>`包含指向实例的指针`Foo`。

谁能想到一个优雅的解决方案？我是否应该坚持使用（半）手动包装类的实例`shared_ptr`？这也可以在不声明新的命名构造函数的情况下公开参数化构造函数......

IE。

```
template <typename T>
shared_ptr<T> make_shared(T* ptr)
{
  return shared_ptr<T>(ptr)
}

// Example
shared_ptr<T> 
  f1 = make_shared(new Foo()),
  f2 = make_shared(new Foo(1,2)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T09:11:10.917

我会尝试这样的事情：

```
template<class T>
class creator
{
  public:
    static shared_ptr<T> init()
    {
      return(shared_ptr<T>(new T));
    }
};

class A : public creator<A>
{
};

class B : public A, public creator<B>
{
  public:
    using make_shared<B>::init;
};

// example use
shared_ptr<A> a = A::init();
shared_ptr<B> b = B::init(); 
```

但是，与您提出的独立模板相比，这不一定能为您节省一件事。

编辑：我错过了以前的答案，这似乎是同一个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T09:36:11.823

我不明白这实现了什么，你似乎没有使用这个 init 函数获得任何额外的内存管理，而不是简单地声明一个 shared_ptr。

```
int main( void )
{
    shared_ptr<foo> a = foo::init();
    shared_ptr<foo> b( new foo );
} 
```

有什么不同。shared_ptr 提供内存管理，而不是 init 中的任何内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T18:07:22.220

似乎目标是使类的用户无法直接调用构造函数，并且只公开一个返回 shared_ptr 的例程。

但是如果你想应用这个模式，你需要在所有的子类中复制它。子类不能自动“继承” init()，因此 init() 仍会调用子类构造函数，因为 init() 不是虚拟方法，并且在没有对象的情况下调用。

我会让构造函数像往常一样暴露，只使用标准

```
shared_ptr<X> x = new X(); 
```

这使认知负担低、易读且保持灵活。无论如何，这就是我们在公司中使用引用计数对象编程的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T08:54:09.070

怎么样...

```
template<typename Derived>
class Foo 
{
public:

    static shared_ptr<Derived> init() 
    {
        return shared_ptr<Derived>(new Derived);
    }

    ~Foo() 
    {
    }

protected:

    Foo()
    {
    }

};

class Bar : public Foo<Bar>
{
};

int _tmain(int argc, _TCHAR* argv[])
{
    shared_ptr<Bar> b = Foo<Bar>::init(); 
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T09:35:24.710

为什么不引入一个带有虚拟析构函数的公共基础，从中继承所有必要的类并简单地使用 new 呢？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T20:27:18.153

`shared_ptr`通过隐藏构造函数来强制创建对象通常不是一个好主意。我是根据个人经验与一个内部公司库一起工作的，这正是这样做的。如果你想确保人们总是包装他们分配的对象，只要确保所有存储这些类型实例的参数和成员都期望一个`shared_ptr`或`weak_ptr`而不是一个裸指针或引用。您可能还想从 派生这些类`enable_shared_from_this`，因为在所有对象都共享的系统中，在某些时候您必须将`this`指针传递给这些其他对象的方法之一，并且由于它们被设计为仅接受`shared_ptr`，如果您的对象无法`internal_weak_this`确保它不会被破坏，那么您的状态就很糟糕。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T17:56:18.423

您需要在整个层次结构的每种类型中使用静态工厂函数。

```
class Foo
{
public:
    static shared_ptr< Foo > instantiate( /* potential arguments */ )
    {
           return shared_ptr< Foo >( new Foo( /* potential arguments */ );
    }

// blah blah blah
};

class Bar : public Foo
{
public:
    static shared_ptr< Bar > instantiate( /* potential arguments */ )
    {
           return shared_ptr< Bar >( new Bar( /* potential arguments */ );
    }

// blah blah blah
}; 
```

如果您仍然有任何困惑，请在 sourceforge 上搜索 CppCodeProvider 并查看它是如何完成的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-29T11:15:45.210

顺便说一句，在大型 C++ 框架中，对编码器隐藏“自动内存管理”是很常见的。这让他可以编写更短更简单的代码。例如，在 Qt 中，您可以这样做：

```
QPixmap foo() {
    QPixmap pixmap(10, 10);
    return pixmap;
}

void bar() {
    QPixmap a = foo(); // no copying occurs, internal refcount incremented.
    QPixmap b = a;     // ditto.
    QPainter p(&b);
    p.drawPoint(5, 5); // data can no longer be shared, so a copy is made.
    // at this point 'a' is still unchanged!
    p.end();
} 
```

[像 Qt 中的许多东西一样，这模仿了 Java 对象模型，但它通过实现写​​时复制](http://en.wikipedia.org/wiki/Copy-on-write)（它称为[隐式共享](http://doc.trolltech.com/4.6/implicit-sharing.html)）更进一步。这是为了让不习惯调用`clone()`.

这是通过[d-pointer idiom](http://techbase.kde.org/Policies/Library_Code_Policy#D-Pointers)实现的，它用一块石头杀死两只鸟 - 您提供自动内存管理，*并将*您的实现与用户 ( [pimpl](http://en.wikipedia.org/wiki/Opaque_pointer) ) 隔离。

您可以在此处查看 QPixmap 的实际实现：[qpixmap.cpp](http://qt.gitorious.org/qt/qt/blobs/master/src/gui/image/qpixmap.cpp)、[qpixmap.h](http://qt.gitorious.org/qt/qt/blobs/master/src/gui/image/qpixmap.cpp)。

# .net - 什么时候可以违反 CLS 合规性？

> ID：540520
> 
> 赞同：2
> 
> 时间：2009-02-12T08:45:54.830
> 
> 标签：.net, cls-compliant

我想知道存在哪些可以使[公共语言规范合规性](http://www.devarticles.com/c/a/C-Sharp/Making-Your-Code-CLS-Compliant/)可接受的边缘情况。即使不打算从其他语言访问，我认为由断言的原则[`CLSCompliantAttribute`](http://msdn.microsoft.com/en-us/library/system.clscompliantattribute.aspx)是良好的最佳实践。

您是否遇到过/知道[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)胜过最佳实践的案例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-24T21:29:29.490

“[原文如此] 符合 CLS 有什么用？”

[中等信任](http://msdn.microsoft.com/en-us/library/ms998341.aspx#paght000020_mediumtrustsummary)、[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)、从共享网络驱动器、域设置中的访客配置文件等运行。如果您违反 CLS 合规性，有很多安全情况下您的代码将无法运行。

我个人见过很多情况，用户试图从共享的网络驱动器运行他们的应用程序并且因为本地管理员在安全配置文件中杀死了不符合 CLS 的应用程序而无法运行。

通常，无论如何，通常都有解决此问题的方法。我会对上面的评论采取相反的方法，为什么要打破它？您正在编写托管代码，为什么要故意限制您的应用程序？

我想说的是，如果您正在构建 API 程序集或组件，您应该始终遵守它们。太多的第三方组件采取了简单的方法，并在尝试从中等信任度运行时将它们标记为已损坏。在某些情况下，这是它们无法运行的唯一原因。如果他们花更多的时间来遵守这些指南，那么用户将不会受到他们如何使用他们的组件的限制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T08:53:41.723

好吧，属性上的“params”数组有时非常诱人（但不合规）。但我建议尽可能使用符合 CLS 的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T08:52:59.913

我认为在使用需要此类功能或出于性能原因的遗留层时，产品内部的库是可以接受的。

但是这些不符合标准的接口应该在更高的层次上重新封装。

# security - Java 安全框架

> ID：540524
> 
> 赞同：12
> 
> 时间：2009-02-12T08:46:03.393
> 
> 标签：security, frameworks, jakarta-ee, glassfish, jaas

安全性总是倾向于在新项目中占据最后的位置。或者您使用像 Spring 这样的框架，其中安全性已经内置并且可以轻松打开。我试图找到一个开放的安全框架，它可以插入到 Swing 和 Web 应用程序（以及 JavaFX？），也许很容易理解。我查看了普通的 JAAS、JGuard 和 JSecurity，但它太复杂了，无法入门。有什么建议或经验可以分享吗？我正在使用 NB、Glassfish 和 MySQL。谢谢斯文

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-17T11:30:09.097

我刚刚查看了这个[http://shiro.apache.org/](http://shiro.apache.org/)

> Apache Shiro 是一个功能强大且易于使用的 Java 安全框架，它执行身份验证、授权、加密和会话管理。借助 Shiro 易于理解的 API，您可以快速轻松地保护任何应用程序——从最小的移动应用程序到最大的 Web 和企业应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T08:59:36.967

我强烈推荐学习`JAAS`。学习起来并不难，Sun 网站上有一些有用的[教程](http://java.sun.com/javase/6/docs/technotes/guides/security/jaas/tutorials/index.html)和[参考指南。](http://java.sun.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html)

以我的经验，`JAAS`它被广泛使用，所以一旦你学会了它，它绝对是你可以重用的东西。它也恰好是[Glassfish](https://glassfish.dev.java.net/javaee5/security/faq.html#pluglogin)身份验证机制的组成部分之一！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T04:56:05.223

我在 JAAS 中针对 Web 应用程序进行了类似的研究，并且遇到了一个“思维障碍”，直到我最终意识到 JAAS 是一个在与 Java 世界中的传统 Web 应用程序不同的“层”解决安全性的框架。它是为解决 J2SE 而不是 J2EE 中的安全问题而构建的。

JAAS 是一个安全框架，用于在比 Web 应用程序低得多的级别上保护事物。其中一些示例是 JVM 级别可用的代码和资源，因此所有这些都可以在 JVM 级别设置策略文件。

但是，由于 J2EE 是在 J2SE 之上构建的，因此来自 JAAS 的一些模块在 J2EE 安全性中被重用，例如 LoginModules 和 Callbacks。

另一方面，Acegi，又名 Spring Security，解决了 Web 应用程序安全问题中更高的“层”。它建立在 J2EE 安全性之上，因此建立在 J2SE 之上，因此建立在 JAAS 之上。除非您希望保护 J2SE 级别的资源（类、系统资源），否则除了使用公共类和接口之外，我看不到 JAAS 的任何实际用途。只需专注于使用 Acegi 或普通的旧 J2EE 安全性即可解决许多常见的 Web 应用程序安全性问题。

归根结底，重要的是要了解您正在处理 J2EE-J2SE 安全问题的哪个“层”，并为该问题选择编写工具。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-11-06T06:02:41.710

我建议你看看 OACC ( [http://oaccframework.org](http://oaccframework.org) )。OACC 是为解决应用程序安全问题而设计的。与大多数框架不同，OACC 能够在您的应用程序中存储/管理授权关系。OACC 的授权模型比 Shiro 或 Spring Security 更强大。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-31T23:10:40.150

JBoss 有替代方案。PicketBox 的新版本。更多信息在这里： [https ://docs.jboss.org/author/display/SECURITY/Java+Application+Security](https://docs.jboss.org/author/display/SECURITY/Java+Application+Security)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-09T01:32:52.517

您可以阅读[http://code4reference.com/2013/08/guest-posttop-java-security-frameworks-for-developing-defensive-java-applications/](http://code4reference.com/2013/08/guest-posttop-java-security-frameworks-for-developing-defensive-java-applications/)

它从各种 Java 安全框架（如 JAAS、Shiro 或 Spring Security）提供 1000 英里视图。一切都取决于您的要求和您选择的技术堆栈

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-02T20:39:32.503

当您在 JBoss 下对 Web 应用程序施加压力时（比如 200 万个简单 GET 请求，并发 50 个线程），apache shiro 惨遭失败。发现这一点非常令人失望。当您使用过滤器时会发生这种情况。

# git - 使用 Git 管理大型二进制文件

> ID：540535
> 
> 赞同：533
> 
> 时间：2009-02-12T08:52:52.677
> 
> 标签：git, version-control, large-files, binaryfiles

我正在寻找有关如何处理我的源代码（Web 应用程序）所依赖的大型二进制文件的意见。我们目前正在讨论几种替代方案：

1.  手动复制二进制文件。
    *   临：不确定。
    *   反对：我强烈反对这一点，因为它增加了设置新站点/迁移旧站点时出错的可能性。建立另一个障碍。
2.  *使用Git*管理它们。
    *   优点：消除了“忘记”复制重要文件的可能性
    *   Contra：使存储库膨胀并降低管理代码库和签出、克隆等的灵活性，这将需要相当长的时间。
3.  单独的存储库。
    *   优点：签出/克隆源代码的速度与以往一样快，并且图像已正确存档在自己的存储库中。
    *   Contra：消除了在项目中拥有*唯一*的 Git 存储库的简单性。它肯定会介绍一些我没有想到的其他事情。

您对此有何经验/想法？

另外：有没有人有使用多个 Git 存储库并在一个项目中管理它们的经验？

这些文件是生成包含这些文件的 PDF 的程序的图像。这些文件不会经常更改（如几年），但它们与程序非常相关。没有这些文件，该程序将无法运行。

* * *

## 回答 #1

> 赞同：313
> 
> 时间：2011-07-09T13:54:28.817

我最近发现了[git-annex](http://git-annex.branchable.com/)，我觉得它很棒。它旨在有效地管理大文件。我将它用于我的照片/音乐（等）收藏。git-annex 的开发非常活跃。文件的内容可以从 Git 存储库中删除，Git 仅跟踪树层次结构（通过符号链接）。但是，要获取文件的内容，需要在拉/推之后进行第二步，例如：

```
$ git annex add mybigfile
$ git commit -m'add mybigfile'
$ git push myremote
$ git annex copy --to myremote mybigfile ## This command copies the actual content to myremote
$ git annex drop mybigfile ## Remove content from local repo
...
$ git annex get mybigfile ## Retrieve the content
## or to specify the remote from which to get:
$ git annex copy --from myremote mybigfile 
```

有很多可用的命令，网站上有很棒的文档。[Debian](http://en.wikipedia.org/wiki/Debian)上提供了一个软件包。

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2009-02-12T14:29:01.293

如果程序在没有文件的情况下无法运行，那么将它们拆分为单独的存储库似乎是个坏主意。我们有大型测试套件，我们将其分解为单独的存储库，但这些是真正的“辅助”文件。

但是，您可能能够在单独的 repo 中管理文件，然后使用[`git-submodule`](http://git-scm.com/docs/git-submodule)以理智的方式将它们拉入您的项目。因此，您仍然拥有所有源代码的完整历史记录，但据我了解，您只有图像子模块的一个相关修订版。该`git-submodule`工具应帮助您保持正确版本的代码与正确版本的图像保持一致。

这是Git Book中对子模块的一个很好的[介绍。](http://alx.github.io/gitbook/5_submodules.html)

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2015-04-09T05:53:54.583

自 2015 年 4 月以来，另一个解决方案是[**Git 大文件存储 (LFS)**](https://github.com/blog/1986-announcing-git-large-file-storage-lfs)（由 GitHub 提供）。

它使用[**git-lfs**](https://github.com/github/git-lfs)（参见**[git-lfs.github.com](https://git-lfs.github.com/)**）并使用支持它的服务器进行测试：[**lfs-test-server**](https://github.com/github/lfs-test-server)：
您只能将元数据存储在 git repo 中，而将大文件存储在其他地方。

![https://cloud.githubusercontent.com/assets/1319791/7051226/c4570828-ddf4-11e4-87eb-8fc165e5ece4.gif](https://i.stack.imgur.com/BqONr.gif)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2011-03-21T21:59:54.367

看看[git bup](https://github.com/bup/bup)，它是一个 Git 扩展，可以智能地将大型二进制文件存储在 Git 存储库中。

您希望将其作为子模块，但您不必担心存储库变得难以处理。他们的示例用例之一是将 VM 映像存储在 Git 中。

我实际上并没有看到更好的压缩率，但是我的存储库中没有真正大的二进制文件。

你的旅费可能会改变。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2013-09-26T04:51:26.027

你也可以使用[git-fat](https://github.com/jedbrown/git-fat)。我喜欢它只依赖于 Python 和[`rsync`](http://en.wikipedia.org/wiki/Rsync). 它还支持通常的 Git 工作流程，具有以下自解释命令：

```
git fat init
git fat push
git fat pull 
```

此外，您需要将 .gitfat 文件签入到您的存储库中并修改您的 .gitattributes 以指定您要`git fat`管理的文件扩展名。

您使用 normal 添加二进制文件，然后根据您的 gitattributes 规则`git add`调用。`git fat`

最后，它的优点是您的二进制文件实际存储的位置可以在存储库和用户之间共享，并且支持任何事情`rsync`。

更新：如果您使用的是 Git-SVN 网桥，请不要使用 git-fat。它将最终从您的 Subversion 存储库中删除二进制文件。但是，如果您使用的是纯 Git 存储库，它的运行效果非常好。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2009-02-12T14:52:57.070

我会使用子模块（如 Pat Notz）或两个不同的存储库。如果你经常修改你的二进制文件，那么我会尽量减少清理历史的巨大存储库的影响：

几个月前我遇到了一个非常相似的问题：大约 21 GB 的 MP3 文件，未分类（坏名，坏 id3，不知道我是否喜欢那个 MP3 文件......），并在三台计算机上复制。

我使用带有主 Git 存储库的外部硬盘驱动器，并将其克隆到每台计算机中。然后，我开始以习惯的方式对它们进行分类（推、拉、合并……多次删除和重命名）。

最后，我在 .git 目录中只有约 6 GB 的 MP3 文件和约 83 GB 的文件。我使用`git-write-tree`and`git-commit-tree`创建了一个没有提交祖先的新提交，并开始了一个指向该提交的新分支。该分支的“git log”只显示了一次提交。

然后，我删除了旧分支，只保留了新分支，删除了 ref-logs，然后运行“git prune”：在那之后，我的 .git 文件夹仅重约 6 GB...

您可以不时以相同的方式“清除”巨大的存储库：您的“git clone”会更快。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-02-12T09:12:02.223

在我看来，如果您可能经常修改那些大文件，或者如果您打算制作大量`git clone`or `git checkout`，那么您应该认真考虑使用另一个 Git 存储库（或者可能是访问这些文件的另一种方式）。

但是如果你像我们一样工作，并且如果你的二进制文件不经常修改，那么第一次克隆/签出会很长，但之后它应该尽可能快（考虑到你的用户继续使用第一个克隆的存储库，他们有）。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2015-07-13T18:32:39.187

我想提出的解决方案是基于孤立分支和对标签机制的轻微滥用，以下称为 *Orphan Tags Binary Storage **(OTABS)**

**TL；DR 12-01-2017**如果您可以使用 github 的 LFS 或其他第三方，那么您一定应该这样做。如果不能，请继续阅读。请注意，此解决方案是一种 hack，应该这样对待。

**OTABS 的理想特性**

*   它是一个**纯 git**和**仅 git**的解决方案——它可以在没有任何 3rd 方软件（如 git-annex）或 3rd 方基础设施（如 github 的 LFS）的情况下完成工作。
*   **它有效地**存储二进制文件，即它不会使存储库的历史膨胀。
*   `git pull`和`git fetch`，包括`git fetch --all`仍然是**带宽有效**的，即默认情况下并非所有大型二进制文件都是从远程提取的。
*   它适用于**Windows**。
*   它将所有内容存储在一个**git 存储库**中。
*   它允许**删除**过时的二进制文件（与 bup 不同）。

**OTABS 的不良特性**

*   它`git clone`可能会导致效率低下（但不一定，取决于您的使用情况）。如果您部署此解决方案，您可能必须建议您的同事使用`git clone -b master --single-branch <url>`而不是`git clone`. 这是因为 git clone 默认情况下会克隆**整个**存储库，包括您通常不想浪费带宽的东西，例如未引用的提交。取自[SO 4811434](https://stackoverflow.com/questions/4811434/clone-only-one-branch)。
*   它使`git fetch <remote> --tags`带宽效率低下，但不一定是存储效率低下。您可以随时建议您的同事不要使用它。
*   您必须定期使用一种`git gc`技巧来清除您的存储库中不再需要的任何文件。
*   它不如[bup](https://github.com/bup/bup)或[git-bigfiles 高效](http://caca.zoy.org/wiki/git-bigfiles)。但它分别更适合您正在尝试做的事情和更多现成的。您可能会遇到数十万个小文件或千兆字节范围内的文件的麻烦，但请继续阅读以了解解决方法。

**添加二进制文件**

在开始之前，请确保您已提交所有更改，您的工作树是最新的，并且您的索引不包含任何未提交的更改。将所有本地分支推送到远程（github 等）可能是一个好主意，以防发生任何灾难。

1.  创建一个新的孤立分支。`git checkout --orphan binaryStuff`会成功的。这将产生一个与任何其他分支完全断开的分支，并且您将在此分支中进行的第一个提交将没有父提交，这将使其成为根提交。
2.  使用`git rm --cached * .gitignore`.
3.  深呼吸并使用`rm -fr * .gitignore`. 内部`.git`目录将保持不变，因为`*`通配符不匹配它。
4.  复制到您的 VeryBigBinary.exe 或您的 VeryHeavyDirectory/。
5.  添加它并提交它。
6.  现在它变得很棘手——如果你将它作为一个分支推送到远程，你的所有开发人员都会在他们下次调用`git fetch`阻塞连接时下载它。您可以通过推送标签而不是分支来避免这种情况。如果他们有打字的习惯，这仍然会影响您同事的带宽和文件系统存储`git fetch <remote> --tags`，但请继续阅读以了解解决方法。来吧`git tag 1.0.0bin`
7.  推送你的孤儿标签`git push <remote> 1.0.0bin`。
8.  为了避免意外推送二进制分支，您可以删除它`git branch -D binaryStuff`。您的提交不会被标记为垃圾收集，因为指向它的孤儿标记`1.0.0bin`足以使其保持活动状态。

**检出二进制文件**

1.  我（或我的同事）如何将 VeryBigBinary.exe 签出到当前工作树中？如果您当前的工作分支是例如 master 您可以简单地`git checkout 1.0.0bin -- VeryBigBinary.exe`.
2.  如果您没有`1.0.0bin`下载孤立标签，这将失败，在这种情况下，您必须`git fetch <remote> 1.0.0bin`事先下载。
3.  您可以将其添加`VeryBigBinary.exe`到您的 master's`.gitignore`中，这样您团队中的任何人都不会意外地用二进制文件污染项目的主要历史。

**完全删除二进制文件**

如果您决定从本地存储库、远程存储库和同事的存储库中彻底清除 VeryBigBinary.exe，您可以：

1.  删除遥控器上的孤儿标签`git push <remote> :refs/tags/1.0.0bin`
2.  在本地删除孤立标签（删除所有其他未引用的标签）`git tag -l | xargs git tag -d && git fetch --tags`。取自[SO 1841341](https://stackoverflow.com/questions/1841341/remove-local-tags-that-are-no-longer-on-the-remote-repository)，稍作修改。
3.  使用 git gc 技巧在本地删除您现在未引用的提交。`git -c gc.reflogExpire=0 -c gc.reflogExpireUnreachable=0 -c gc.rerereresolved=0 -c gc.rerereunresolved=0 -c gc.pruneExpire=now gc "$@"`. 它还将删除所有其他未引用的提交。取自[SO 1904860](https://stackoverflow.com/questions/1904860/how-to-remove-unreferenced-blobs-from-my-git-repo)
4.  如果可能，在遥控器上重复 git gc 技巧。如果您是自托管您的存储库并且可能无法使用某些 git 提供程序，例如 github 或在某些公司环境中，这是可能的。如果您托管的提供商不允许您通过 ssh 访问远程，那就顺其自然吧。您的提供商的基础设施可能会在他们自己的甜蜜时间清理您未引用的提交。如果您在公司环境中，您可以建议您的 IT 每周运行一次 cron 作业垃圾收集您的遥控器。无论他们是否这样做，在带宽和存储方面都不会对您的团队产生任何影响，只要您建议您的同事始终`git clone -b master --single-branch <url>`而不是`git clone`.
5.  您所有想要摆脱过时孤儿标签的同事只需要应用步骤 2-3。
6.  然后，您可以重复*添加二进制文件*的步骤 1-8以创建新的孤立标签`2.0.0bin`。如果您担心您的同事打字`git fetch <remote> --tags`，您实际上可以重新命名`1.0.0bin`。这将确保下次他们获取所有标签时，旧标签`1.0.0bin`将被取消引用并标记为后续垃圾收集（使用步骤 3）。当您尝试覆盖遥控器上的标签时，您必须`-f`像这样使用：`git push -f <remote> <tagname>`

**后记**

*   OTABS 不会触及您的 master 或任何其他源代码/开发分支。这些分支的提交哈希、所有历史记录和小尺寸不受影响。如果您已经使用二进制文件使源代码历史膨胀，则必须将其作为单独的工作进行清理。[这个脚本](https://gist.github.com/afternoon/1433794)可能有用。

*   确认可以使用 git-bash 在 Windows 上工作。

*   应用一[组标准 trics](http://blogs.atlassian.com/2014/05/handle-big-repositories-git/)来提高二进制文件的存储效率是一个好主意。频繁运行`git gc`（没有任何额外参数）使 git 通过使用二进制增量优化文件的底层存储。但是，如果您的文件从提交到提交不太可能保持相似，您可以完全关闭二进制增量。此外，因为压缩已经压缩或加密的文件（如 .zip、.jpg 或 .crypt）没有意义，所以 git 允许您关闭底层存储的压缩。不幸的是，这也是影响您的源代码的全有或全无设置。

*   您可能需要编写 OTABS 的部分脚本以加快使用速度。特别是，从*完全删除二进制文件*到`update`git 钩子中编写脚本步骤 2-3 可能会给 git fetch 提供一个引人注目但可能是危险的语义（“获取并删除所有过时的内容”）。

*   您可能希望跳过*完全删除二进制文件*的第 4 步，以保留远程上所有二进制更改的完整历史记录，但代价是中央存储库膨胀。随着时间的推移，本地存储库将保持精简。

*   在 Java 世界中，可以将此解决方案与`maven --offline`创建完全存储在您的版本控制中的可重现的离线构建相结合（使用 maven 比使用 gradle 更容易）。在 Golang 世界中，基于此解决方案来管理您的 GOPATH 而不是`go get`. 在 python 世界中，可以将它与 virtualenv 结合起来以生成一个独立的开发环境，而无需依赖 PyPi 服务器来从头开始构建。

*   如果您的二进制文件经常更改，例如构建工件，那么编写一个解决方案脚本可能是一个好主意，该解决方案将工件的 5 个最新版本存储在孤立标记`monday_bin`、`tuesday_bin`、 ...、`friday_bin`以及每个版本的孤立标记中`1.7.8bin` `2.0.0bin`等。您可以`weekday_bin`每天轮换和删除旧的二进制文件。通过这种方式，您可以获得两全其美：您保留源代码的**整个**历史记录，但只保留二进制依赖项的**相关历史记录。**获取给定标签的二进制文件也很容易，**而无需**获取包含其所有历史记录的完整源代码：`git init && git remote add <name> <url> && git fetch <name> <tag>`应该为您完成。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-10-03T03:11:41.550

SVN 似乎比 Git 更有效地处理二进制增量。

我必须决定文档的版本控制系统（JPEG 文件、PDF 文件和 .odt 文件）。我刚刚测试了添加一个 JPEG 文件并将其旋转 90 度四次（以检查二进制增量的有效性）。Git 的存储库增长了 400%。SVN 的存储库仅增长了 11%。

所以看起来 SVN 处理二进制文件的效率要高得多。

所以我的选择是用于源代码的 Git 和用于文档等二进制文件的 SVN。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-12-06T13:55:14.460

**`git clone --filter`来自 Git 2.19 + 浅克隆**

如果 Git 和 GitHub 开发并使其对用户足够友好（例如，他们可能[还没有为子模块实现](https://stackoverflow.com/questions/4611512/is-there-a-way-to-make-git-pull-automatically-update-submodules#comment93978080_49427199)这一点），这个新选项最终可能会成为二进制文件问题的最终解决方案。

它实际上只允许获取服务器所需的文件和目录，并与远程协议扩展一起引入。

有了这个，我们可以先做一个浅层克隆，然后自动为每种构建类型使用构建系统获取哪些 blob。

甚至已经有一个`--filter=blob:limit<size>`允许限制要获取的最大 blob 大小。

我提供了一个关于该功能的最小详细示例：[如何仅克隆 Git 存储库的子目录？](https://stackoverflow.com/questions/600079/how-do-i-clone-a-subdirectory-only-of-a-git-repository/52269934#52269934)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-09-10T11:33:46.453

> 我正在寻找有关如何处理我的源代码（Web 应用程序）所依赖的大型二进制文件的意见。您对此有何经验/想法？

一旦我的 Web 应用程序二进制数据**超过 3 GB 标记，**我个人就遇到了**与 Git 与我的一些云主机的同步失败**。当时我考虑过[BFT Repo Cleaner](https://rtyley.github.io/bfg-repo-cleaner/)，但感觉就像是 hack。从那时起，我开始只将文件保存在 Git 权限之外，而是利用Amazon S3 等**专门构建的工具**来管理文件、版本控制和备份。

 ****> 有没有人有使用多个 Git 存储库并在一个项目中管理它们的经验？

是的。[Hugo 主题](https://themes.gohugo.io/)主要是通过这种方式管理的。这有点笨拙，但它完成了工作。

* * *

我的建议是为**工作选择合适的工具**。如果是为一家公司而你在 GitHub 上管理你的代码线，那就付钱并使用 Git-LFS。否则，您可以探索更多创造性的选择，例如[使用区块链的去中心化、加密文件存储](https://storj.io/)。

要考虑的其他选项包括[Minio](https://minio.io/)和[s3cmd](http://s3tools.org/s3cmd)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-10-03T10:36:05.507

看看[camlistore](https://camlistore.org/)。它不是真正基于 Git 的，但我发现它更适合您必须做的事情。

# visual-studio - 为什么我不能调试？

> ID：540536
> 
> 赞同：18
> 
> 时间：2009-02-12T08:52:55.547
> 
> 标签：visual-studio, debugging, visual-studio-2005

当我准备在VS2005中调试C++程序时，程序并没有停在断点处。

VS说“没有为任何调用堆栈帧加载符号。无法显示源代码”。

我能做些什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-14T03:29:58.677

谢谢大家。

最后，我在[这里](http://social.msdn.microsoft.com/forums/en-US/Vsexpressvc/thread/503d3ded-976e-460e-b5f9-7e03454ed387/)找到了解决方案。

> 要启用调试：
> 
> 1) 转到项目->HelloWorld 属性
> 
> 2）在左侧展开“配置属性”
> 
> 3) 展开“C/C++”
> 
> 4）在左侧，选择“常规”
> 
> 5) 在右侧，将“Debug Information Format”更改为“Program Database For Edit And Continue (/ZI)”
> 
> 5）在左侧，选择“优化”
> 
> 6）在右侧，将“优化”更改为“禁用（/Od）”
> 
> 7）在左侧，展开“链接器”
> 
> 8）在左侧，选择“调试”
> 
> 9）在右侧，将“Generate Debug Info”更改为“Yes”
> 
> 10) 点击确定
> 
> 11) 设置断点
> 
> 12) 重建你的应用程序
> 
> 此外，在运行您的应用程序时，请使用 Ctrl+F5 来构建和运行它，这会使控制台窗口保持打开的时间足够长，以便您查看输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T09:24:31.557

尝试几个步骤：

1.  Debug->Step Into（这将确保您在开始后立即停止）
2.  调试->Windows->模块
3.  在列表中查找您的 foo.exe。
4.  检查符号状态。它说它已加载？
5.  如果不是，请转到路径并确保：a) 那里有一个名为 foo.pdb 的文件 b) foo.pdb 上的时间戳与 foo.exe 匹配（或非常接近）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T08:59:46.060

无论出于何种原因，您在符号路径中都没有正确的符号（.pdb 文件）。这可能有几个原因：

1) 您的二进制文件比 .pdb 文件的编译时间更晚。尝试重新编译所有内容。

2) 您正在尝试调试 .dll 并忘记复制 .pdb 文件。也复制这些文件。

您的代码也可能没有像您想象的那样执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T08:58:16.907

听起来您正在附加到一个进程而不是运行传统的调试会话？如果您确实附加到某个进程，请务必确保您尝试调试的二进制文件是使用当前在您的 IDE 中打开的相同源代码构建的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T09:00:45.403

完成清理和重建，确保创建 .pdb？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T17:15:24.770

在尝试调试我的单元测试时，我遇到了这个问题（在 VS 中使用 c#）。

您可以添加以下代码，该代码将启动调试器的新实例，允许您像往常一样单步执行代码：

```
System.Diagnostics.Debugger.Launch();
System.Diagnostics.Debugger.Break(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-01T16:25:53.633

只是添加 MainID 尚未涵盖的另一种可能性：

在调试时，我实际上启动了一些程序，它会调用我想要调试的类（它是某种附加组件）。被调用的程序部分是用非托管 C++ 编写的。当我选中“启用非托管代码调试”时，会出现错误（随后程序崩溃），因为程序没有任何调试信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-04T05:45:15.693

我通过这样做在 WP7 中解决了这个问题：

1.  右键单击解决方案资源管理器中的项目 ( `Ctrl+W+S`)
2.  选择重建。
3.  再次选择项目，右键单击它并选择部署。
4.  开始调试 (F5)

我希望它会帮助你！

# python - 虚拟环境中的 Pydev 和 Pylons，自动完成不起作用

> ID：540538
> 
> 赞同：3
> 
> 时间：2009-02-12T08:53:12.537
> 
> 标签：python, pylons, pydev, virtualenv

我已经安装 Pydev 并运行 Python 2.6 没有问题。我将 Pylons 0.9.7 RC 4 安装到虚拟环境中，然后将新的解释器配置为 pint 到虚拟环境中，这个用于 pylons 项目。我的问题是代码自动完成不适用于基础库中的类（随基础 python 安装一起安装的类），并且它与来自虚拟环境的类没有任何问题。

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T13:32:44.023

也许[这个](http://www.nabble.com/-pydev---Users--Multiple-Interpreters-td17679628.html)或[这个](http://groups.google.com/group/pylons-discuss/browse_thread/thread/916ab8ac6c2ae746?fwc=1&pli=1)会有所帮助

*顺便说一句：我想这是正确的行为，这个解释器只使用与 virtualenv 一起安装的包（这是 virtualenv 的全部意图和目的，不是吗？）*

# iphone - 切换 iPhone 的 Return 键不起作用？

> ID：540554
> 
> 赞同：0
> 
> 时间：2009-02-12T08:58:55.173
> 
> 标签：iphone, cocoa-touch

以编程方式设置 Return 键很简单：
textField.returnKeyType = UIReturnKeyDone; // 这是在 loadView/init 方法中

但是，切换该键似乎并不容易，即将其从“完成”更改为其他内容，例如，取决于文本字段中当前显示的内容！即回调方法中的后续语句：
textField.returnKeyType = UIReturnKeyRoute;
不会将键标题从 Done 更改为 Route!?!?

有没有其他人观察到这一点？任何解决方法？

问候，
/约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T19:17:43.453

如果“不起作用”是指它没有做任何事情，也许您需要这样的东西？

```
- (BOOL)textFieldShouldReturnUITextField *)theTextField
{   
[theTextField resignFirstResponder];
return YES;
} 
```

如果“不起作用”是指文本错误，据我所知，您只能从 API 提供的一组预定义按钮类型中进行选择。我不知道有什么方法可以直接设置该文本。可能有一种使用私有 api 的方法（请参阅 [EricaSadun.com](http://ericasadun.com/iPhoneDocs220/)）

# git - 如何部分导出 git 存储库？

> ID：540565
> 
> 赞同：3
> 
> 时间：2009-02-12T09:05:15.347
> 
> 标签：git, svn, git-svn, google-code

我的公司在内部使用 git，我们将我们的一些工作作为开源发布在使用 svn 的 Google Code 上。（如果它支持git，问题可能是一样的。）

问题是我们只发布了我们存储库的*一部分，因此使用*[http://code.google.com/p/support/wiki/ImportingFromGit](http://code.google.com/p/support/wiki/ImportingFromGit)上描述的 git-svn将不起作用。

*   如何发布部分存储库？（我第一次只是复制了我们想要发布的文件。）
*   如何同步已发布文件和 Code 的存储库之间的更改？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T09:11:04.520

您可以使用[git-filter-branch](http://git-scm.com/docs/git-filter-branch)提取要导入 Google 代码的部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T19:48:01.733

在 git 1.7.11 中，我们使用这样的命令仅导出存储库中一个目录的原始文件，而不导出 git 控制和历史记录。确保在您希望文件出现的*现有目录*中运行它（即首先制作和 cd 到目标目录）：

```
git archive --remote /local/master/project.git HEAD:open/src | tar x 
```

*   将*/local/master/project.git*替换为您用于指定存储库的任何内容（我的示例使用本地 NFS 主机）
*   用分支名称替换 HEAD
*   将*open/src*替换为要导出的存储库中的目录

使用 --remote 选项，您甚至不需要在克隆副本中运行它，因此它可以嵌入到您围绕发布机制包装的任何其他进程中。

您可以进一步使用 tar 选项从选定的目录树中排除某些文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T09:08:54.853

一种方法可能是为公共内容创建一个单独的 Git 存储库，并将其作为子模块包含在内部存储库中。然后将公共 Git 存储库与 Google Code SVN 存储库同步会容易得多。

# shell - 组装文件的最佳方式

> ID：540568
> 
> 赞同：0
> 
> 时间：2009-02-12T09:07:10.537
> 
> 标签：shell, file

我有大量具有顺序文件名的小文件，我想从中创建一个文件。最快的方法是什么？

例如

```
1.tgz.1  1.tgz.2  1.tgz.3   =========> 1.tgz 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T09:09:40.233

您可以[连接](http://en.wikipedia.org/wiki/Concatenation)外壳中的文件。

在 Windows 中（`/b`对于二进制模式）：

```
copy /b   1.tgz.1 + 1.tgz.2 + 1.tgz.3   1.tgz 
```

在 Unix/Linux 中：

```
cat   1.tgz.1 1.tgz.2 1.tgz.3   > 1.tgz 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T10:40:28.190

如果它是**大量**的小文件，你不想被大量的参数弄乱。

由于大多数 UNIX shell 按字母顺序扩展通配符，您应该使用：

```
cat 1.tgz.? 1.tgz.?? 1.tgz.??? >1.tgz 
```

假设有 100 到 999 个文件（包括 100 到 999 个文件），调整参数以处理更多或更少（例如，添加 1.t​​gz.???? 如果存在 1,000 到 9,9999 之间）。你不会获得更好的性能，因为你的瓶颈是磁盘速度，它总是比 CPU 上运行的代码慢。

我能想到的唯一其他可能性是：

*   在单独的物理磁盘上创建 1.tgz。这可能会给您带来交错磁盘访问的优势。
*   以 root 身份运行并使用`nice`来提高您的优先级（详情请参阅`man nice`）。这将提高您获得更多 CPU 的能力，但同样，如果您受磁盘 I/O 的限制，那将无济于事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T09:36:12.603

使用具有高块大小的[dd](http://opengroup.org/onlinepubs/007908799/xcu/dd.html)可能会获得更好的性能：

```
for n in *.tgz.* ; \
  dd if="$n" conv=notrunc oflag=append bs=4M of="somefile.tgz" ; \
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T09:23:59.123

这是 bash（您的 shell 可能会有所不同）：

```
for n in *.tgz.* ; do cat $n >> ${n/tgz.*/tgz} ; done 
```

# perl - 您如何以编程方式比较两个存档文件的内容？

> ID：540576
> 
> 赞同：4
> 
> 时间：2009-02-12T09:12:00.540
> 
> 标签：perl, zip, lamp

我正在做一些测试，以确保我使用脚本文件创建的多合一 zip 文件将产生与我必须手动单击并通过 Web 界面创建的几个 zip 文件的内容相同的输出。因此，zip 将具有不同的文件夹结构。

当然，我可以手动提取它们并使用我强大的眼球技术来扫描它们，甚至更懒惰我可以编写一个脚本来做到这一点，但在我投入更多时间并被我的老板指责为公司时间抢劫之前，我在问如果有更好的方法来做到这一点？

顺便说一下，我正在使用 perl LAMP 堆栈。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T10:38:06.713

您可以使用 perl 的[Archive::ZIP](http://search.cpan.org/~adamk/Archive-Zip-1.26/lib/Archive/Zip.pm)或 Python 的[zipfile](http://docs.python.org/library/zipfile.html)来提取档案中文件的文件名、大小和 CRC 校验和。创建一个包含按文件名排序的结果的文件（忽略路径）。

对于较小的 ZIP，请合并脚本 ( `cat list1 list2 list3 | sort`) 的结果。

现在，您可以使用`diff`来比较结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T09:23:19.030

我可以全心全意地推荐[Beyond Compare](http://www.scootersoftware.com/)。除非你真的得到了过低的报酬，否则这对你（老板）来说是最大的收获。

[编辑] 我似乎已经扫描了*不同*的文件夹结构，对此感到抱歉。Beyond Compare 可以比较具有相同文件夹结构的文件夹中的所有文件。它没有（我相信）在不同文件夹中的文件中搜索匹配项的*智能。*

问候，
利文

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T09:26:13.330

从 Carra 的回答中得到启发...如果 A.zip 是您的单个大存档，而 B.zip 是通过网络生成的存档，则使用以下算法

1.  从 A.zip 中提取所有文件并递归（wrt 文件夹）计算提取内容的文件夹中存在的文件的校验和（使用`cksum`等`md5sum`），并在将其排序（通过管道`sort`）到文件后保存此信息（例如A.txt)

2.  对 B.zip 执行相同操作并生成 B.txt

3.  比较 A.txt 和 B.txt 他们应该是完全一样的。

或者

用于`unzip -l`获取 (zip) 存档的文件/目录列表，然后展平用户生成的 zip 文件的层次结构，并使用诸如`diff`. 通过扁平化层次结构，我的意思是您可能需要对一个或两个列表进行某种预处理，然后才能与`diff`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T09:29:27.550

为您的文件创建一个 crc 校验和。

如果原始文件和解压缩文件的校验和相同，则可以确定文件相同。甚至适用于非文本数据。

校验和可以很容易地使用外部程序（例如“SFV Checker”）或以编程方式创建（例如，.net/java 包含执行此操作的库）。

# asp.net - 如何通过 ODBC 从 ASP.NET 将 UTF8 文本写入 MySQL？

> ID：540581
> 
> 赞同：2
> 
> 时间：2009-02-12T09:16:45.660
> 
> 标签：asp.net, mysql, utf-8, odbc

我在共享主机上使用 MySQL 5，使用 MySQL 5.1 ODBC 驱动程序从 ASP.NET 3.5 连接。我想存储 UTF8 字符串。我的表过去都在“latin1_swedish_ci”中，但我使用以下方法将数据库、表和列转换为 UTF8：

```
ALTER DATABASE `my_db` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
ALTER TABLE `my_table`  DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
ALTER TABLE `my_table` CHANGE `subject` `subjext` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL 
```

但是当使用 ODBCConnection 和 ODBCCommand 将非 ascii 字符（如“游ぶ”）插入我的数据库时，我仍然会收到此错误：

`ERROR [HY000] [MySQL][ODBC 5.1 Driver][mysqld-5.0.51b-community-nt]Incorrect string value: '\xE3\x80\x80\xE6\x89\x8B...' for column 'subject' at row 1`

请注意，由于我使用的是 5.1 驱动程序，因此不能使用“SET NAMES utf8;” - 它产生一个错误。

有什么我想念的想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T10:02:36.970

有几件事要检查：

1.  确保您的表格和文本字段真正接受 utf8：
    使用[MySQL 查询浏览器](http://dev.mysql.com/downloads/gui-tools/5.0.html)并尝试手动编辑一些数据。
    如果保存编辑后它保持正常，则字段和表格设置正确。

2.  确保您实际上插入的是 utf8 兼容字符，而不是基于另一种编码形式的字符，例如中文的 GB2332。
    如果是这种情况，您可能需要先将字符串转换为 utf8，然后才能将它们发送到数据库。
    您可以看看在 .Net中使用[Encoding类。](http://msdn.microsoft.com/en-us/library/system.text.encoding.aspx)
    不久前我已经[回答了一篇](https://stackoverflow.com/questions/379191/convert-gb2312-to-utf-8)关于相关内容的帖子，并且有一篇关于这个问题的[CodeProject 文章。](http://www.codeproject.com/KB/aspnet/Encoding_in_ASPNET.aspx)

3.  您可能还需要确保[ODBC 连接字符串](http://dev.mysql.com/doc/refman/5.0/en/connector-odbc-configuration-connection-without-dsn.html)包括以下内容：

    字符集=utf8；

有一个可用于 ODBC 连接[的所有参数的列表。](http://dev.mysql.com/doc/refman/5.0/en/connector-odbc-configuration-connection-parameters.html)

# mysql - 使用 Cocos2d 与我的 iPhone 应用程序进行远程数据库连接

> ID：540590
> 
> 赞同：0
> 
> 时间：2009-02-12T09:21:36.633
> 
> 标签：mysql, iphone, cocos2d-iphone

MCPResult *theResult; MCPConnection *mySQLConnection;

```
//initialize connection string vars

NSString *dbURL = @"192.168.0.16";

NSString *userName = @"";

NSString *pass = @"";
int port = 3306;

//open connection to database
mySQLConnection = [[MCPConnection alloc]    initToHost: dbURL
                                             withLogin:userName
                                              password:pass
                                             usingPort:port];

if ([mySQLConnection isConnected])
{
    NSLog(@"The connection to database was successfull");
}
else
{
    NSLog(@"The connection to database was failed");
}

//selection to database

if([mySQLConnection selectDB:@"blackjack_DB"])  
{

    NSLog(@"Database found");

}

else

{

    NSLog(@"Database not found");

}

//selection to Table

theResult = [mySQLConnection queryString:@"select * from test"];    
//theResult = [mySQLConnection queryString:@"select * from test where id='1'"];
//theResult = [mySQLConnection queryString:@"select id from test"];

//theResult = [mySQLConnection queryString:@"select name from test where pass='main_pass'"];

NSArray *m= [theResult fetchRowAsArray];
NSLog(@"%@", m);
NSLog(@"%@", [m objectAtIndex:2]); 
```

使用此代码连接和接收来自远程数据库的信息。并且还使用一些框架。AppKit.framework、Cocoa.framework、Carbon.framework、MCPKit_bundled.framework。但是我没有将我的应用程序与 remort 数据库连接起来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T18:55:18.140

需要更多信息，具体来说，你的 iPhone 的 IP 是什么？我问的原因是因为除非它的 IP 地址在专用 C 网络（192.168.xx）中，否则它将无法找到数据库。

我建议将 dbUrl 设置为可公开访问的 IP 地址。这可能需要一些工作（防火墙、了解您的 IP 地址等），但它应该可以工作。

此外，打印失败连接的结果会很有用（我假设 MCPConnection 具有此功能，而不仅仅是成功/失败）

# c# - 用于 C# 的 Lex/Yacc？

> ID：540593
> 
> 赞同：22
> 
> 时间：2009-02-12T09:22:36.117
> 
> 标签：c#, parsing, yacc

实际上，也许不是成熟的 Lex/Yacc。我正在实现一个命令解释器前端来管理一个 webapp。我正在寻找可以接受语法定义并将其转换为直接调用我的对象上的方法的解析器的东西。类似于 ASP.NET MVC 如何确定调用哪个控制器方法，以及如何计算参数。

因此，如果用户在我的命令提示符下键入“create foo”，它应该透明地调用一个方法：

```
private void Create(string id) { /* ... */ } 
```

哦，如果它可以从那些控制器方法的（例如）属性中生成帮助文本，那也太棒了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-03-31T10:53:40.503

我已经使用 GPLEX/GPPG 完成了几个小项目，它们是 C# 中 LEX/YACC 的非常简单的重新实现。我没有使用上述任何其他工具，所以我无法真正比​​较它们，但这些都很好用。

GPPG 可以在[这里](http://gppg.codeplex.com/)找到， GPLEX 可以在[这里](http://gplex.codeplex.com/)找到。

话虽如此，我同意，一个完整的 LEX/YACC 解决方案可能对你的问题来说太过分了。我建议使用 IronPython 生成一组绑定：它可以轻松地与 .NET 代码交互，非程序员似乎发现基本语法相当可用，如果您选择使用它，它会给您很大的灵活性/功能。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-12T09:29:32.743

我不确定 Lex/Yacc 是否会有所帮助。您只需要一个基本的分词器和一个解释器，它们的手写速度更快。如果您仍在解析路线，请参阅[Irony](https://github.com/IronyProject/Irony)。

作为旁注：您是否考虑过 PowerShell 及其命令行开关？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-19T14:34:41.453

另请查看具有 C# 支持的[Antlr 。](http://antlr.org/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-12T09:36:01.840

仍然是早期的 CTP，因此不能用于生产应用程序，但您可能对 Oslo/MGrammar 感兴趣：http: [//msdn.microsoft.com/en-us/oslo/](http://msdn.microsoft.com/en-us/oslo/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-21T15:43:11.890

Jison 最近受到了很多关注。它是 javascript 的 Bison 端口。由于它非常简单，我将 jison 解析/词法分析模板移植到 php，现在移植到 C#。它仍然很新，但如果你有机会，可以在这里看看：[https ://github.com/robertleeplummerjr/jison/tree/master/ports/csharp/Jison](https://github.com/robertleeplummerjr/jison/tree/master/ports/csharp/Jison)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-12T09:39:59.303

如果您不惧怕 alpha 软件并且想要替代 Lex / Yacc 来创建您自己的语言，您可能会考虑[Oslo](http://www.microsoft.com/soa/products/oslo.aspx)。[我建议您仔细阅读去年 PDC](https://sessions.microsoftpdc.com/public/timeline.aspx)的 TL27 和 TL31 会议的会议录音。TL31 直接解决了使用 Oslo 创建领域特定语言的问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-12T09:41:37.007

Coco/R 是一个带有 .NET 实现的编译器生成器。您可以尝试一下，但我不确定让这样的库工作是否比编写自己的标记器更快。

[http://www.ssw.uni-linz.ac.at/Research/Projects/Coco/](http://www.ssw.uni-linz.ac.at/Research/Projects/Coco/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-12T10:44:42.487

我建议[csflex](http://sourceforge.net/projects/csflex/) - flex 的 C# 端口 - 最著名的 unix 扫描仪生成器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-02T03:22:51.623

我相信 lex/yacc 已经在其中一个 SDK 中（即 RTM）。Windows 或 .NET Framework SDK。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-05-11T16:51:02.663

Gardens Point Parser Generator[此处](http://plas.fit.qut.edu.au/gppg/)为 C# 提供 Yacc/Bison 功能。可以在 [这里](http://gppg.codeplex.com/)下载。[此处](http://simplescript.codeplex.com/)提供了一个使用 GPPG 的有用示例

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-12T09:31:49.557

正如 Anton 所说，PowerShell 可能是要走的路。如果你确实想要一个 lex/yacc 实现，那么[Malcolm Crowe](http://cis.paisley.ac.uk/crow-ci0/)有一个很好的设置。

**编辑：** [直接链接到编译器工具](http://cis.paisley.ac.uk/crow-ci0/CSTools47.zip)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-12-12T20:41:50.217

仅作记录，在 C# 中为 C# 实现词法分析器和 LALR 解析器：

[http://code.google.com/p/naive-language-tools/](http://code.google.com/p/naive-language-tools/)

它的使用应该与 Lex/Yacc 类似，但是这些工具 (NLT) 不是生成器！因此，忘记速度。

# asp.net - 使用无扩展 URL 的 IIS6 重写 HttpModule URL

> ID：540596
> 
> 赞同：3
> 
> 时间：2009-02-12T09:23:48.547
> 
> 标签：asp.net, iis, iis-6, url-rewriting

我们将 Intelligencia URLRewriting 模块用于带有 2.0 版框架和 IIS6 的 asp.net。我们的 URL 通常没有扩展名。

我知道如果没有通用通配符（这会导致其他问题），IIS6 无法真正处理这种情况。

但是，它有效！有时。在其他时候（例如，在一个开发人员的机器上，以及当我在应用程序上指向不同的虚拟目录时在我的机器上）它不会。“它不起作用”我的意思是配置的 HttpModules 甚至永远不会被命中。

谁能解释一下？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T15:54:46.967

所以事实证明发生了以下事情：

*   请求进入（比如说）[http://website/products/productid](http://website/products/productid)
*   IIS 找不到这个，因此我们得到 404
*   偶然我们在**IIS**中为 404设置了一个自定义错误页面
*   此错误页面将引用 URL 粘贴在 404 error.aspx 页面的末尾
*   所以我们得到一个重定向进入 asp.net 的行：

    [http://website/error.aspx?404;http://website/products/productid](http://website/error.aspx?404;http://website/products/productid)

*   我们的 URLRewriting 正则表达式现在设置为丢弃 error.aspx 位并处理[http://website/products/productid](http://website/products/productid)就好像它是实际的 URL

*   所以 asp.net 按要求呈现[http://website/product.aspx?id=productid](http://website/product.aspx?id=productid)！

我想这可能证明对某人有用，但我们正在转向 isapi 过滤器。一个提醒是，默认情况下这将导致重定向的紧密循环！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T09:33:33.827

如果您使用 Visual Studio 开发 Web 服务器运行站点，所有请求都将由 asp.net 处理，因此您的 HttpModule 将运行。

在 IIS6 上，除非设置为将请求转发到 asp.net，否则不会发生这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T10:00:29.720

您确定当“它有效”时您没有在 VS.NET 中包含的 Cassini 开发 Web 服务器下运行？因为无扩展通配符在 Cassini 下确实有效，这至少可以说是非常令人困惑的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2011-12-11T07:06:03.157

如果您在 ASP.net 4.0 中使用 IIS6，则必须像这样指定和注册模块：

```
<system.web>
<httpModules>
      <add name="UrlRewriter" type="Intelligencia.UrlRewriter.RewriterHttpModule, Intelligencia.UrlRewriter"/> 
```

不是

```
<system.webServer>
<modules runAllManagedModulesForAllRequests="true">
      <add name="UrlRewriter" type="Intelligencia.UrlRewriter.RewriterHttpModule, Intelligencia.UrlRewriter"/>
</modules> 
```

# linux - 如何找到我使用的 Fedora 版本？

> ID：540603
> 
> 赞同：128
> 
> 时间：2009-02-12T09:29:10.810
> 
> 标签：linux, fedora

```
sudo find /etc | xargs grep -i fedora > searchFedora 
```

给出：

```
/etc/netplug.d/netplug: # At least on Fedora Core 1
... 
```

但请参阅`/etc/netplug.d/netplug`文件中的 Fedora 版本。严重吗？

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2009-02-12T09:31:24.300

```
cat /etc/issue 
```

或者 `cat /etc/fedora-release`按照@Bruce ONeel 的建议

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2009-02-12T10:38:19.427

您也可以尝试`/etc/redhat-release`或`/etc/fedora-release`：

```
cat /etc/fedora-release 
Fedora release 7 (Moonshine) 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2013-06-01T10:03:17.293

建议的标准文件是`/etc/os-release`. 请参阅[http://www.freedesktop.org/software/systemd/man/os-release.html](http://www.freedesktop.org/software/systemd/man/os-release.html)

您可以执行以下操作：

```
$ source /etc/os-release
$ echo $ID
fedora
$ echo $VERSION_ID
17
$ echo $VERSION
17 (Beefy Miracle) 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2016-09-23T08:23:31.373

最简单的命令可以为您提供所需的信息，但也提供了一些其他有用的信息：

```
hostnamectl 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-02-12T11:03:03.363

你可以试试

```
lsb_release -a 
```

它至少可以在 Debian 和 Ubuntu 上运行（因为它是 LSB，它肯定至少应该在大多数其他主流发行版上运行）。[http://rpmfind.net/linux/RPM/sourceforge/l/ls/lsb/lsb_release-1.0-1.i386.html](http://rpmfind.net/linux/RPM/sourceforge/l/ls/lsb/lsb_release-1.0-1.i386.html)表明它已经存在了一段时间。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-09-21T09:33:41.840

```
cat /etc/*release 
```

它几乎适用于任何主要发行版。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-06-18T15:35:12.303

```
[Belmiro@HP-550 ~]$ uname -a

Linux HP-550 2.6.30.10-105.2.23.fc11.x86_64 #1 SMP Thu Feb 11 07:06:34 UTC 2010
x86_64 x86_64 x86_64 GNU/Linux

[Belmiro@HP-550 ~]$ lsb_release -a

LSB Version: :core-3.1-amd64:core-3.1-noarch:core-3.2-amd64:core-3.2-noarch:deskt
op-3.1-amd64:desktop-3.1-noarch:desktop-3.2-amd64:desktop-3.2-noarch
Distributor ID: Fedora
Description: Fedora release 11 (Leonidas)
Release: 11
Codename: Leonidas
[Belmiro@HP-550 ~]$ 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-08-16T17:45:54.183

这些命令适用于 Artik 10：

*   猫 /etc/fedora-release
*   猫 /etc/问题
*   主机名

而这些其他人没有：

*   lsb_release -a
*   unname -a

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-12T10:11:53.470

怎么样`uname -a`？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-08-13T14:08:04.367

在我安装 Fedora 25（工作站）时，所有发行版 ID 信息都在此文件中找到：

```
/usr/lib/os.release.d/os-release-workstation 
```

这包括，

*   名称=Fedora
*   VERSION="25 (工作站版)"
*   ID=fedora
*   VERSION_ID=25
*   PRETTY_NAME="Fedora 25（工作站版）"
*   <...>
*   VARIANT="工作站版"
*   VARIANT_ID=工作站

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-06T22:46:17.913

uname -a 适用于我的 fc11

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-18T08:53:36.807

使用命令，screenfetch 输出格式信息。

# linux - 百胜安装subversion1.4.3

> ID：540606
> 
> 赞同：1
> 
> 时间：2009-02-12T09:29:58.267
> 
> 标签：linux, svn, fedora

如何在不构建任何源的情况下访问/安装旧的颠覆包（v1.4.3）？

事实上，我使用的发行版不是 FC1，而是“Red Hat Enterprise Linux AS release 4 (Nahant Update 5)”。

你知道一些“颠覆二进制存储库”，这样的配置可以下载吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T09:38:38.900

您可以从[DAG](http://dag.wieers.com/rpm/) RPM 存储库[获取 Subversion 1.4.3 的 RHEL 4 RPM 。](http://dag.wieers.com/rpm/packages/subversion/subversion-1.4.3-0.1.el4.rf.i386.rpm)存储库网站上有一个关于配置 Yum 以进行访问的[常见问题解答。](http://dag.wieers.com/rpm/FAQ.php#B4)

# c# - SpVoice 和 SpeechSynthesizer 有什么区别

> ID：540607
> 
> 赞同：10
> 
> 时间：2009-02-12T09:30:37.140
> 
> 标签：c#, sapi

[在 C# 中使用语音 API 或SAPI](http://msdn.microsoft.com/en-us/library/ms723627(VS.85).aspx)的这两种方法有什么区别？

```
using SpeechLib;
SpVoice speech = new SpVoice();
speech.Speak(text, SpeechVoiceSpeakFlags.SVSFlagsAsync); 
```

返回[Apacela 的声音](http://www.acapela-group.com/acapela-voice-content-products.html)，和

```
SpeechSynthesizer ss = new SpeechSynthesizer();
ss.SpeakAsync ("Hello, world"); 
```

不适用于[Apacela 声音](http://www.acapela-group.com/acapela-voice-content-products.html)。

第一个返回所有声音，但第二个只返回几个声音。这与 SAPI 5.1 和 SAPI 5.3 有关吗？

Vista 和 XP 上的行为相同，SpVoice 都能够检测到 Apacela 语音，但使用 SpeechSynthesizer，在 XP 和 Vista 上均未检测到语音。

我猜 XP 使用 SAPI 5.1，而 Vista 使用 SAPI 5.3 那么为什么所有操作系统上的行为相同，但 API 的行为不同？

还有哪个API更强大，两种方式/API有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T03:27:38.370

SpeechLib is an Interop DLL that makes use of classic COM-based SAPI under the covers. System.Speech was developed by Microsoft to interact with Text-to-speech (and voice recognition) directly from within managed code.

In general, it's cleaner to stick with the managed library (System.Speech) when you're writing a managed application.

It's definitely not related to SAPI version--the most likely problem here is that a voice vendor (in this case Acapela) has to explicitly implement support for certain System.Speech features. It's possible that the Acapela voices that you have support everything that is required, but it's also possible that they don't. Your best bet would be to [ask the Acapela Group directly](http://support.acapela-group.com/).

Voices are registered in HKLM\SOFTWARE\Microsoft\Speech\Tokens, and you should see the Windows built-in voices, as well as the Acapela voices that you have added listed there. If you spot any obvious differences in how they're registered, you *might* be able to make the Acapela voices work by making their registration match that of, for example, MS-Anna.

But I'd say the most likely possibility is that the Acapela voices have not been updated to support all of the interfaces required by System.Speech.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T09:39:02.143

SpeechLib 是一个互操作 DLL，因此映射到它创建的任何版本的 SpeechLib（您可以检查它的属性）。

System.Speech.* 是 .NET 框架中对语音的“官方”支持。SpeechSynthesizer 选择在运行时使用哪个语音库（很像 System.Web.Mail 类所做的）。

我不确定他们为什么返回不同数量的声音，但这可能与所使用的 SAPI 版本有关。

# oracle - 测试 Delphi 应用程序的最佳方法

> ID：540617
> 
> 赞同：12
> 
> 时间：2009-02-12T09:33:33.890
> 
> 标签：oracle, delphi, testing, testcomplete

我有一个 Delphi 应用程序，它有很多依赖项，并且很难重构它以使用 DUnit（它很大），所以我正在考虑使用 AutomatedQA 的 TestComplete 之类的东西来从前端 UI 进行测试。

我的主要问题是错误修复或新功能有时会破坏以前（手动）测试过的旧代码，并且曾经可以工作。

我已将应用程序设置为使用命令行开关打开可以测试的特定表单，并且我可以创建一组值和需要完成的单击。

但是在我做任何激烈的事情之前我有几个问题......（在购买任何东西之前）

1.  这值得么？
2.  这是一个很好的测试方法吗？
3.  测试的结果应该在我的数据库（Oracle）中，testcomplete 中是否有一种简单的方法来检查这些值（多个表中的多个字段）？
4.  我需要设置一个测试数据库来进行所有自动化测试，是否有一种简单的方法可以自动重新设置测试数据库？除了删除用户级联，创建用户，...，impdp。
5.  testcomplete 有没有办法为 exe 指定命令行参数？
6.  有没有人有类似的经历。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T10:04:16.857

我建议您计划同时使用 DUnit 和 TestComplete 之类的东西，因为它们各自用于不同的目的。

DUnit 非常适合单元测试，但很难用于整体应用程序测试和 UI 测试。

TestComplete 是少数几个真正支持 Delphi 的自动化测试产品之一，我们的 QA 工程师告诉我他们的支持非常好。

请注意，尽管设置自动化测试是一项庞大且耗时的工作。如果你严格应用单元测试和自动化 UI 测试，你很容易得到比生产代码更多的测试代码。

对于大型（现有）应用程序，您在实施自动化测试方面处于困难境地。

我的建议是首先设置单元测试，并结合自动构建服务器。每次有人将任何东西签入源代码控制时，单元测试都会自动运行。不要尝试直接为所有内容设置单元测试——这对于现有应用程序来说太费力了。只要记住在添加新功能以及即将进行更改时创建单元测试。我还强烈建议，每当报告错误时，您在修复它之前创建一个重现错误的单元测试。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-12T09:58:15.017

我也有类似的情况。（具有大量依赖项的大型应用程序）。几乎没有自动化测试。但是有一个很大的希望来解决这个问题。这就是为什么我们要解决每个新版本的一些问题。

我们即将发布新产品的第一个版本。最初的迹象是好的。但工作量很大。所以下一个版本我们肯定需要一些方法来自动化测试过程。这就是为什么我已经介绍了单元测试。虽然由于依赖关系，这些都不是真正的单元测试，但你必须从某个地方开始。

我们做过的事情：

*   引入了一种更面向对象的方法，因为大部分代码仍然是程序性的。
*   在文件之间移动内容。
*   尽可能消除依赖。

但是要求清单上还有更多要求，以确保整个团队在退休前有足够的工作量。

也许我有点奇怪，但清理代码会很有趣。在没有单元测试的情况下进行重构是一项危险的工作，尤其是在有很多副作用的情况下。我们使用结对编程来避免愚蠢的错误。以及大量的测试环节。但最终我们的代码更干净，引入的新错误数量极少。

哦，请确保您知道这是一个昂贵的过程。这需要很多时间。你必须与连续解决多个问题的趋势作斗争。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T09:44:23.537

我无法回答所有问题，因为我从未使用过 testcomplete，但我可以回答其中的一些问题。

1 - 是的。回归测试是值得的。当您破坏了曾经可以工作的东西时，当客户回来找您时，作为开发人员，您会感到非常尴尬。确保所有曾经工作的东西仍然有效，这始终是一个好主意。

4 - Oracle 有一个叫做[闪回](http://www.oracle.com/technology/deploy/availability/htdocs/Flashback_Overview.htm)的东西，它可以让你在数据库中创建一个还原点。完成测试后，您可以直接跳回到这个还原点。您也可以编写脚本来使用它`FLASHBACK DATABASE TO TIMESTAMP (FEB-12-2009, 00:00:00);`，等等

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T13:27:13.547

我们正在考虑使用 VMWare 来隔离我们的一些测试。

您可以从保存的快照开始，因此您始终拥有一致的环境和本地数据库状态。

VMWare 操作可以编写脚本，因此您可以从网络位置自动安装最新版本，启动测试并在之后关闭。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-13T08:01:03.010

> 1.  这值得么？

大概。设置和维护测试可能是一项艰巨的工作，但是当您拥有它们时，可以非常轻松且一致地执行测试。如果您的项目正在发展，那么某种测试套件会非常有帮助。

> 2.  这是一个很好的测试方法吗？

我会说正确的 DUnit 测试套件是更好的第一步。然而，如果你有一个不是为测试而设计的大型代码库，那么设置功能测试比设置 GUI 测试更痛苦。

> 3.  测试的结果应该在我的数据库（Oracle）中，testcomplete 中是否有一种简单的方法来检查这些值（多个表中的多个字段）？

TestComplete 具有 ADO 和 BDE 接口。或者，您可以使用 VBScript 中的 OLE 界面来访问所有可用的内容。

> 5.  testcomplete 有没有办法为 exe 指定命令行参数？

是的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T10:24:52.160

在（旧）应用程序中引入单元测试的一种方法可能是拥有一个“启动数据库”（如 Rich Adams 描述的“闪回”功能）。程序 som unittest 使用 DUnit 来控制 GUI。[请参阅http://delphixtreme.com/wordpress/?p=181](http://delphixtreme.com/wordpress/?p=181)上的“使用 DUnit 进行 GUI 测试”

每次测试都是通过恢复到“启动数据库”来启动的，因为这样的话，一组已知的数据，就可以使用了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-21T18:15:12.957

> 我需要设置一个测试数据库来进行所有自动化测试，是否有一种简单的方法可以自动重新设置测试数据库？

使用事务：测试完成时执行回滚。这应该将所有内容恢复到初始状态。

推荐阅读：

[http://xunitpatterns.com/](http://xunitpatterns.com/)

# tdd - 寻找关于 TDD 有效性的论文/研究

> ID：540622
> 
> 赞同：25
> 
> 时间：2009-02-12T09:35:38.533
> 
> 标签：tdd

我正在寻找关于单元测试和 TDD 有效性的研究论文或研究。

兴趣点：

*   TDD 会减少开发时间吗？
*   总体开发成本是否也降低了？
*   结果产品是否更稳定？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T09:43:18.407

[StudiesOfTestDrivenDevelopment](http://biblio.gdinwiddie.com/biblio/StudiesOfTestDrivenDevelopment)有总结和更多链接。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-12T09:41:35.010

[微软研究院：**通过测试驱动开发实现质量提升：四个行业团队的成果和经验**](http://research.microsoft.com/en-us/groups/ese/nagappan_tdd.pdf)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T08:59:15.317

infoQ 上的一篇文章：[实证研究表明测试驱动开发提高了质量](http://www.infoq.com/news/2009/03/TDD-Improves-Quality)。

[以及通过 TDD 研究实现质量改进](http://research.microsoft.com/en-us/projects/esm/nagappan_tdd.pdf)的链接。

“TDD 似乎适用于各个领域，可以显着降低已开发软件的缺陷密度，而不会显着降低开发团队的生产力。” 该研究将 Microsoft 和 IBM 使用 TDD 的 4 个项目与不使用 TDD 的类似项目进行了比较。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T09:41:51.980

[http://www.eclipsecon.org/summiteurope2007/presentations/ESE2007_TDD-case_study.pdf](http://www.eclipsecon.org/summiteurope2007/presentations/ESE2007_TDD-case_study.pdf)

[http://www.thycotic.com/casestudy4.html](http://www.thycotic.com/casestudy4.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T10:57:24.017

[查看www.agilerules.com](http://www.agilerules.com/)上的 Nancy Van Schooenderwoert（等人）的论文。特别是“数字与新手的嵌入式敏捷项目”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T12:44:54.273

[http://www.slideshare.net/ZendCon/test-driven-development-presentation](http://www.slideshare.net/ZendCon/test-driven-development-presentation)有一个很好的演示文稿来解释 TDD，尽管它是面向 Zend 和 PHP 的。

[http://biblio.gdinwiddie.com/biblio/StudiesOfTestDrivenDevelopment](http://biblio.gdinwiddie.com/biblio/StudiesOfTestDrivenDevelopment)有很多相关链接

# database - Propel 中的数据库分片支持

> ID：540629
> 
> 赞同：2
> 
> 时间：2009-02-12T09:38:23.380
> 
> 标签：database, propel, sharding

只是想知道 Propel 对数据库分片的支持有多好？我正在考虑用 PHP 创建我的应用程序，使用 MySQL 作为数据库服务器，Propel 作为 ORM。

我发现最好从一开始就保持架构的可扩展性，以防我的应用程序起飞。

你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T13:36:06.157

我认为这是一个非常糟糕的主意。假设您需要对数据进行分片并不是一个好的假设。您事先不知道您将如何扩展。分片是一项非常复杂的业务，需要尽可能避免。这是一个过早优化的淫秽案例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T19:35:12.587

我同意 MarkR 的观点，现在担心分片还为时过早，但我不同意应该尽可能避免分片。我会说使用似乎适合您的风格和语言选择的 ORM —— Propel 可能是您的正确选择。即使您的应用程序大获成功，分片也可能不是必需的——您可以使用基于 MySQL 的 DBMS 和一些不错的缓存技术轻松提取 2500 万条记录，因此只需专注于快速查询和设计为了方便 memcache 集成，即使您的应用程序起飞，您也将成为一个快乐的露营者。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-01T09:37:09.363

Propel 通过连接支持开箱即用的分片。在此处查看示例：

[http://groups.google.com/group/propel-users/browse_thread/thread/4d19c0668aa17452](http://groups.google.com/group/propel-users/browse_thread/thread/4d19c0668aa17452)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-13T01:19:23.640

一些数据库分片中间件可以帮助您。例如：Apache ShardingSphere ( [https://shardingsphere.apache.org/document/current/en/features/sharding/](https://shardingsphere.apache.org/document/current/en/features/sharding/) )

ShardingSphere 有 2 个适配器，JDBC 和 Proxy。JDBC 是连接数据库的 java 驱动程序，不适合 PHP，但 Proxy 就像数据库（MySQL 或 Postgres）。ShardingSphere-Proxy 可以隔离数据分片和业务逻辑。最好使用第三方中间件来处理常见问题。

# linq - 用 sum 对数据进行分组

> ID：540634
> 
> 赞同：0
> 
> 时间：2009-02-12T09:40:05.463
> 
> 标签：linq

我有以下列表：

```
 mat.Add(new Material() { ID = 1, ProdName = "Cylinder", Weight=23, Discontinued='N'  });
 mat.Add(new Material() { ID = 2, ProdName = "Gas", Weight = 25, Discontinued='N' });
mat.Add(new Material() { ID = 3, ProdName = "Match", Weight = 23, Discontinued='N' }); 
```

我想要一个结果：

```
2 Products have Weight 23 and Discontinued N
1 Product have Weigth 25 Discontinued N 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T09:47:01.907

目前尚不清楚您实际分组的确切内容 - 是重量*还是*停产状态？如果是这样，你可以这样做：

```
var query = mat.GroupBy(material => 
                        new { material.Weight, material.Discontinued });

foreach (var result in query)
{
    Console.WriteLine("{0} products have {1}", result.Count(), result.Key);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T09:48:53.713

知道了！

```
.GroupBy(re => new { re.Weight, re.Discontinued })
           .Select(grp => new { CXXX = group.Key, Count = grp.Count() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T09:49:24.133

“只是”按重量分组并停产。

类似于： var result = mat.GroupBy(a=>new{a.Weight,a.Discontinued}).Select(b=>new b.Key.Weight,b.Key.Discontinued,Count = b.Count() });

# c# - 我可以让 Moq 为模拟类添加属性吗？

> ID：540636
> 
> 赞同：23
> 
> 时间：2009-02-12T09:41:34.370
> 
> 标签：c#, unit-testing, attributes, mocking, moq

我正在为我的项目编写一个命令行界面。用户输入“create project foo”，找到负责“project”的控制器，然后调用该`Create`方法，将“foo”作为第一个参数传递。

它严重依赖于属性和反射：控制器看起来像这样：

```
[ControllerFor("project")]
class ProjectController
{
    [ControllerAction("create")]
    public object Create(string projectName) { /* ... */ }
} 
```

我想在解析器的单元测试中使用 Moq，如下所示：

```
Mock<IProjectsController> controller = new Mock<IProjectsController>();
controller.Expect(f => f.Create("foo"));

parser.Register(controller.Object);
parser.Execute("create project foo");

controller.VerifyAll(); 
```

将属性添加到接口似乎不起作用——它们不是由派生类继承的。

我可以让 Moq 为被模拟的类添加属性吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-12T09:53:02.267

**更新：**我刚刚意识到您实际上可以使用[TypeDescriptor.AddAttributes](http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptor.addattributes.aspx)将属性添加到现有类型，这可以针对实例或 aa 类型执行：

```
Mock<IRepository> repositoryMock = new Mock<IRepository>();

CustomAttribute attribute = new CustomAttribute();

// option #1: to the instance
TypeDescriptor.AddAttributes(repositoryMock.Object, attribute );

// option #2: to the generated type
TypeDescriptor.AddAttributes(repositoryMock.Object.GetType(), attributes); 
```

如果需要，AddAttribute 会返回一个 TypeDescriptorProvider，可以将其传递给[TypeDescriptor.RemoveProvider](http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptor.removeprovider.aspx)以在之后删除属性。

请注意，[Attribute.GetCustomAttributes](http://msdn.microsoft.com/en-us/library/system.attribute.getcustomattributes%28v=vs.110%29.aspx)不会找到在运行时以这种方式添加的属性。相反，请使用[TypeDescriptor.GetAttributes](http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptor.getattributes.aspx)。

**原始答案**

我不相信 Moq（或任何其他模拟框架）支持自定义属性。我知道 Castle Proxy（通常用于实际创建类的框架）**确实**支持它，但无法通过 Moq 访问它。

最好的办法是将加载属性的方法抽象到接口（接受类型和属性类型）中，然后模拟它。

**编辑：**例如：

```
public interface IAttributeStrategy
{
    Attribute[] GetAttributes(Type owner, Type attributeType, bool inherit);
    Attribute[] GetAttributes(Type owner, bool inherit);
}

public class DefaultAttributeStrategy : IAttributeStrategy
{
    public Attribute[] GetAttributes(Type owner, Type attributeType, bool inherit)
    {
        return owner.GetCustomAttributes(attributeType, inherit);
    }

    public Attribute[] GetAttributes(Type owner, bool inherit)
    {
        return owner.GetCustomAttributes(inherit);
    }
} 
```

需要属性的类使用 IAttributeStrategy 的实例（通过 IoC 容器，或者将其可选地传递给构造函数）。通常它将是一个 DefaultAttributeStrategy，但您现在可以模拟 IAttributeStrategy 以覆盖输出。

这听起来可能令人费解，但添加抽象层比尝试实际模拟属性要容易得多。

# perl - 如何将 CPAN 模块安装到本地目录中？

> ID：540640
> 
> 赞同：65
> 
> 时间：2009-02-12T09:41:54.680
> 
> 标签：perl, module, installation, cpan

我正在使用托管的 Linux 机器，所以我没有写入`/usr/lib`目录的权限。

当我尝试按照通常的方式安装 CPAN 模块时：

```
perl Makefile.PL
make test
make install 
```

该模块被提取到一个`blib/lib/`文件夹中。我保留`use blib/lib/ModuleName`了，但编译器仍然说找不到模块。我尝试将 .pm 文件复制到本地目录并保留 `require ModuleName`，但它仍然给我一些错误。

如何将模块安装到其他目​​录并使用它？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-12T23:02:12.103

Stackoverflow 上已有的其他答案：

*   [如何在没有 root 访问权限的情况下在本地安装模块...](https://stackoverflow.com/questions/102850/how-can-i-install-cpan-modules-locally-without-root-access-dynaloader-pm-line-22)
*   [如何在没有安装权限的情况下使用新的 Perl 模块？](https://stackoverflow.com/questions/251705/how-can-i-use-a-new-perl-module-without-install-permissions)

来自 perlfaq8：

* * *

[如何保留自己的模块/库目录？](http://learn.perl.org/faq/perlfaq8.html#How-do-I-keep-my-own-module-library-directory)

当你构建模块时，告诉 Perl 在哪里安装模块。

对于基于 Makefile.PL 的发行版，在生成 Makefile 时使用 INSTALL_BASE 选项：

```
perl Makefile.PL INSTALL_BASE=/mydir/perl 
```

您可以在您的 CPAN.pm 配置中进行设置，以便在您使用 CPAN.pm shell 时模块自动安装在您的私有库目录中：

```
% cpan
cpan> o conf makepl_arg INSTALL_BASE=/mydir/perl
cpan> o conf commit 
```

对于基于 Build.PL 的发行版，使用 --install_base 选项：

```
perl Build.PL --install_base /mydir/perl 
```

您也可以将 CPAN.pm 配置为自动使用此选项：

```
% cpan
cpan> o conf mbuildpl_arg '--install_base /mydir/perl'
cpan> o conf commit 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-02-12T10:57:48.977

我有一个类似的问题，我什至无法安装 local::lib

我创建了一个安装程序，将模块安装在相对于 .pl 文件的某个位置

安装过程如下：

```
perl Makefile.PL PREFIX=./modulos
make
make install 
```

然后，在需要该模块的 .pl 文件中，该文件位于 ./

```
use lib qw(./modulos/share/perl/5.8.8/); # You may need to change this path
use module::name; 
```

其余文件（makefile.pl、module.pm 等）无需更改。

您可以只调用 .pl 文件

```
perl file.pl 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-12T10:21:03.760

[local::lib](http://search.cpan.org/perldoc?local::lib)会帮助你。它将说服“make install”（和“Build install”）安装到您可以写入的目录，并告诉`perl`如何获取这些模块。

通常，如果您想使用 blib/ 目录中的模块，您想说明通常`perl -Mblib ...`在哪里调用脚本。`...`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-31T12:10:43.733

我强烈推荐[Perlbrew](https://perlbrew.pl)。它允许您运行多个版本的 Perl、安装软件包、如果您愿意，可以破解 Perl 内部结构，以及所有常规用户权限。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-19T08:34:19.867

对于基于 Makefile.PL 的发行版，在生成 Makefile 时使用 INSTALL_BASE 选项：

```
perl Makefile.PL INSTALL_BASE=/mydir/perl 
```

# cocoa-touch - 如何使用 Interface Builder 在我的应用程序中连接 UIPickerView？

> ID：540642
> 
> 赞同：1
> 
> 时间：2009-02-12T09:42:35.833
> 
> 标签：cocoa-touch, interface-builder

我正在使用 Xcode 和 Interface Builder (IB) 开发 iPhone（实用程序）应用程序。我在使用 IB 的应用程序中使用 UIPickerView。但我不知道如何在我的应用程序中连接 UIPickerView。它显示一个空的选择器。如何在 UIPickerView 中连接数据？请告诉我细节...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T13:30:20.013

您必须实现 UIPickerViewDataSource 和 UIPickerViewDelegate 协议才能将数据输入您的选择器并知道用户何时进行选择。然后在 IB 中建立从选择器到实现这些协议的对象的连接。

# c# - 使用 VSTO 而非 VBA 创建 UDF

> ID：540643
> 
> 赞同：4
> 
> 时间：2009-02-12T09:42:44.973
> 
> 标签：c#, vsto, excel-interop

类似于这个[问题](https://stackoverflow.com/questions/124121/how-to-create-excel-2003-udf-with-a-c-excel-add-in-using-vsto-2005-se)（但在我的情况下不是 VSTO SE），但是，我只想确认在 Visual Studio 2005 和 Excel 2003 中使用纯 VSTO 创建 UDF 是不可能的 - 所以，绝对清楚，我的问题是：

是否可以在不使用任何 VBA 或其他技巧的情况下使用 Visual Studio 2005 和 VSTO 解决方案创建 Excel 2003 UDF？

我知道 ManagedXLL、ExcelDNA、Excel4Net 等，但暂时不想考虑这些。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T20:03:35.433

关于是否有办法绕过 COM 或 VBA，我认为这是不可能的（至少在没有任何非常肮脏的技巧的情况下是不可能的）。原因是Office 可以执行外部代码（即您的加载项）的唯一方式是通过COM。甚至 VSTO 在下面仍然使用旧的 IDTExtensibility2 COM 接口。IDTExtensibility2 是 Microsoft Office 应用程序的所有加载项都必须实现的 COM 接口。

在 VSTO 之前，Office 加载项必须自己实现这个 IDTExtensibility2 接口。在这种基于 COM 的加载项（或 COM 可见的托管加载项）中，您可以简单地添加您的 UDF，如此[处](http://blogs.msdn.com/eric_carter/archive/2004/12/01/273127.aspx)所述。

然而，现在有了 VSTO，多了一层抽象：VSTO 使用所谓的实现 IDTExtensibility2 的[解决方案加载器](http://msdn.microsoft.com/en-us/library/bb608603.aspx#UnmanagedLoader)，它是 VSTO 运行时提供的一个 dll。这意味着您的加载项不再是 COM 可见的。因此，如果您将 UDF 添加到 VSTO 加载项，Office 将看不到它。

Paul Stubbs 在他的博客中解释了如何使用 VSTO 和 VBA： [**如何在 VSTO 托管代码中创建 Excel UDF**](http://blogs.msdn.com/pstubbs/archive/2004/12/31/344964.aspx)

> 1.  在 VSTO 中使用您的函数创建一个类
>     
>     
>     
>     ```
>     <System.Runtime.InteropServices.ComVisible(True)>
>     Public Class MyManagedFunctions
>         Public Function GetNumber() As Integer
>             Return 42
>         End Function 
>     End Class 
>     ```
>     
>     
> 2.  在 VSTO 中将您的课程连接到 VBA
>     
>     
>     
>     ```
>     Private Sub ThisWorkbook_Open() Handles Me.Open
>         Me.Application.Run("RegisterCallback", New MyManagedFunctions)
>     End Sub 
>     ```
>     
>     
> 3.  为托管代码创建 Hook 并为 VBA 中的函数创建一个包装器
>     
>     
>     
>     在电子表格或文档的 VBA 模块中
>     
>     
>     
>     ```
>     Dim managedObject As Object
>     
>     Public Sub RegisterCallback(callback As Object)
>         Set managedObject = callback
>     End Sub
>     
>     Public Function GetNumberFromVSTO() As Integer
>         GetNumberFromVSTO = managedObject.GetNumber()
>     End Function 
>     ```
>     
>     
> 
> 现在您可以输入`=GetNumberFromVSTO()` 一个单元格，当 excel 启动时，单元格的值应该是 42。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-31T03:52:42.183

我不明白你为什么要这样做？

VSTO 和通过 COM 互操作（来自 .NET）公开 UDF 是两个不同的任务。为什么要在 VSTO 项目中托管 UDF 方法？

注册 .net UDF 程序集的方式意味着它必须位于 VSTO 项目的单独项目中。但是，如果您想在两个应用程序之间共享数据，那么您可以使用各种本机 .net 方法，或者只是从您的 VSTO 项目中的适当范围对象“调用”UDF 函数。

您是否有理由认为 VSTO 中有必要使用 UDF？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T13:57:49.900

在[本文](http://blogs.msdn.com/eric_carter/archive/2004/12/01/273127.aspx)中，Eric Carter 继续解释如何按照您的要求进行操作。在顶部，他甚至链接到上述博客文章的更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-23T22:40:08.033

按照 Eric Carter 的解释创建 UDF，并将 Excel 范围作为参数传递给您的 UDF。您可以使用给定的范围通过 VSTO 访问 Excel 的对象模型： Excel.Range rg = param1 as Excel.Range; Excel.Workbook wb = rg1.Worksheet.Application.ActiveWorkbook;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T18:41:40.977

我不熟悉使用 VS2005 和 VSTO 在 Excel 2003 中创建 UDF 而没有至少一点 VBA 的方法。这里有 2 个链接可以进一步讨论这个问题：

[http://geekswithblogs.net/Denis/archive/2007/01/03/102623.aspx](http://geekswithblogs.net/Denis/archive/2007/01/03/102623.aspx)

[http://blogs.msdn.com/pstubbs/archive/2004/12/31/344964.aspx](http://blogs.msdn.com/pstubbs/archive/2004/12/31/344964.aspx)

# .net - 实体框架 - 继承

> ID：540654
> 
> 赞同：1
> 
> 时间：2009-02-12T09:49:18.813
> 
> 标签：.net, database, entity-framework

我刚开始使用实体框架并遇到以下问题：

我有一个*Site*实体，其中包含一个导航属性*Paragraphs*。

我有多个实体（即*ImageParagraph*，*LinkListParagraph*）应该从*Paragraph*继承。

我想查询一个*站点*对象并访问它的*段落*并根据它们的具体类型（即*ImageParagraph*、*LinkListParagraph*）使用它们。

它可以使用 Table Per Hierarchy 方法（有条件），但是我最终会得到一个非常肮脏的解决方案。根据段落 ID 查询具体类型是可行的，但我希望有更好的解决方案。

我想查询一个*站点*并显示一些站点特定的数据和段落中的数据（*ImageParagraph*，*LinkListParagraph*）。我不知道如何以一种可以直接在*Paragraphs*导航属性上检索*ImageParagraph*、*LinkListParagraph对象的方式设置映射。*

 *你将如何解决这个问题？

ER图：http: [//img443.imageshack.us/img443/46/69863714ks0.jpg](http://img443.imageshack.us/img443/46/69863714ks0.jpg)

[替代文字 http://img443.imageshack.us/img443/46/69863714ks0.jpg](http://img443.imageshack.us/img443/46/69863714ks0.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T09:59:38.787

如果你想*根据*它们的具体类型来使用它们——这听起来像是多态的一个例子……你可以（在部分类中）添加一些方法吗？

```
partial class Paragraph {
    public abstract void Foo();
}
partial class ImageParagraph {
    public override void Foo() {/*code*/}
}
partial class LinkListParagraph {
    public override void Foo() {/*code*/}
} 
```

否则，如果要过滤集合，可以使用`OfType`扩展方法 - 即

```
foreach(var imgPara in obj.Paragraphs.OfType<ImageParagraph>())
{ ... } 
```

也许您也可以为上述添加属性（在父对象中） - 即

```
partial class Site {
    public IQueryable<ImageParagraph> ImageParagraphs
    { get {return Paragraphs.OfType<ImageParagraph>(); }}

    public IQueryable<LinkListParagraph> LinkListParagraphs
    { get {return Paragraphs.OfType<LinkListParagraph>(); }}
} 
```

# vba - 是否有一种战术（阅读“hack”）解决方案来避免将 VBA 代码和 Excel 工作表作为一个二进制文件？

> ID：540658
> 
> 赞同：6
> 
> 时间：2009-02-12T09:50:47.593
> 
> 标签：vba, excel

据我了解，当我使用 VBA 代码创建 Excel 工作表时，VBA 代码与工作表一起保存为二进制文件。因此，我不能以一种有用的方式将代码放入源代码控制中，让多个开发人员解决问题，比较困难等等。

有没有办法在不切换到 VSTO、COM 插件等的情况下解决这个问题？例如，要在运行时从 Web 服务、共享驱动器等加载 VBA？任何想法表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T10:05:28.133

我为 Excel 编写了一种构建系统，它从源文件中导入 VBA 代码（然后可以将其导入源代码控制、diffed 等）。它通过创建一个包含导入代码的新 Excel 文件来工作，因此它可能不适用于您的情况。

构建宏看起来像这样，我将它保存在一个名为 Build.xls 的文件中：

```
Sub Build()
    Dim path As String
    path = "excelfiles"

    Dim vbaProject As VBIDE.VBProject
    Set vbaProject = ThisWorkbook.VBProject

    ChDir "C:\Excel"
    ' Below are the files that are imported
    vbaProject.VBComponents.Import (path & "\something.frm")
    vbaProject.VBComponents.Import (path & "\somethingelse.frm")

    Application.DisplayAlerts = False
    ActiveWorkbook.SaveAs "Output.xls"
    Application.DisplayAlerts = True

    Application.Quit
End Sub 
```

现在，VBIDE 的东西意味着你必须导入一个名为“Microsoft Visual Basic for Applications Extensibility 5.3”的引用，我认为。

当然，您仍然有必须启动 Excel 来构建的问题。这可以通过一个小的 VB 脚本来解决：

```
currentPath = CreateObject("Scripting.FileSystemObject") _
    .GetAbsolutePathName(".")
filePath = currentPath & "\" & "Build.xls"

Dim objXL
Set objXL = CreateObject("Excel.Application")
With objXL
    .Workbooks.Open(filePath)
    .Application.Run "Build.Build"
End With
Set objXL = Nothing 
```

运行上述脚本应启动生成结果表的生成 Excel 文件。您可能必须更改一些内容以使其在文件系统中可移动。希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T10:01:15.740

我强烈建议不要尝试在运行时加载 VBA。VBIDE 自动化充其量是不稳定的，我认为您会遇到很多维护和支持问题。

我对此的解决方案是将源代码控制的代码定期导出为文本文件。我还将从 xls 中删除所有代码（完全删除表单、模块和类模块，并删除工作表和工作簿模块中的代码）并仅将这个“存根”xls 放入源代码管理中。

因此，从源代码控制重建将包括获取“存根”xls，导入所有表单、类模块和模块，并将所有代码复制并粘贴到工作表和工作簿模块中。

虽然这是一个痛苦的过程，但它确实允许对代码进行适当的源代码控制，并具有所有常见的差异、分支等功能。不幸的是，大部分都是手动的。我确实编写了一个插件，它自动化了其中的一些，但它很快就被破解了解决方案，即相当多的错误并且需要手动干预。如果我有时间重新审视它并让它从头开始，那么我会告诉你;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T10:00:14.997

有趣的问题......我们也有 VBA 源代码控制的问题，但从未真正解决它。

这篇[Microsoft 知识库文章](http://support.microsoft.com/kb/219905)是否符合您的标准？代码放在一个 .BAS 文件中，该文件可以位于任意位置（并且与 .xls 分开）。

正如我所说，我实际上从未尝试过这样做，但看起来这可能是一种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-16T03:18:12.940

[最短的前进路径是使用来自http://www.codeproject.com/KB/office/SourceTools.aspx](http://www.codeproject.com/KB/office/SourceTools.aspx)的 SourceTools.xla 插件

另一种方法是编写一个类似的工具，使用 COM 绑定到您最喜欢的编程语言。我的一位能干的同事用 Python 创建了一个，它可以将包括 VBA 代码、工作表内容和公式甚至 VBA 引用在内的所有内容导出到文本文件中，并可以将这些内容组合成一个工作簿。那也是在 XLSX 格式之前。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T10:46:08.443

我还建议不要在运行时加载并寻找[make](http://www.gnu.org/software/make/)样式的实用程序。毕竟，如果您的代码受源代码控制，那么您应该只需要在提交后更新您的工作簿。

不幸的是，没有这样的实用程序，或者至少没有我能找到的实用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T14:03:48.513

我认为与其他替代方案（即不断重建 Excel 工作簿文件）相比，使用 VBA 进行轻型原型设计工作转移到 VSTO 或 COM 插件的麻烦要少得多。您还可以获得没有容易“破解”源代码的额外好处（即，您需要的不仅仅是猜测 VBA 项目密码）

# xcode - 在 Xcode 中复制捆绑资源时解析符号链接

> ID：540661
> 
> 赞同：18
> 
> 时间：2009-02-12T09:51:48.120
> 
> 标签：xcode, symlink

我在 Xcode 中有一个项目和该项目的一些资源。这些资源包含几个符号链接。当 Xcode 构建项目时，它会复制资源，但不会解析符号链接。有没有办法告诉 Xcode 解析链接？（即复制链接目标而不是链接本身。）

*更新：*谢谢，mouviciel，差不多了。起初我尝试使用 Copy Files 阶段来完成，但`pbxcp`该阶段调用的程序也没有解析链接，即使有一些名为`-resolve-src-symlinks`. 我最终添加了一个运行脚本阶段，调用如下：

```
rsync -pvtrlL --cvs-exclude \
    $PROJECT_DIR/../Resources* \
    $BUILT_PRODUCTS_DIR/$CONTENTS_FOLDER_PATH 
```

幸运的副作用是我不再需要更新 Xcode 中的 Resources 组，在 Resources 目录中所做的任何更改都是立即可见的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T10:00:59.673

一个解决方案可能是插入一个运行脚本构建阶段，它完全按照您想要的方式执行复制，即通过取消引用符号链接（这是 cp 的默认行为）。

# download - 要求在游戏中下载网页重定向

> ID：540664
> 
> 赞同：1
> 
> 时间：2009-02-12T09:54:14.713
> 
> 标签：download

我注意到当您不使用网络重定向（apache、iis、...服务器）时，有几款游戏的下载速度很差（<10Kb/s），这是否有我不使用的编程原因？看不到还是因为其他原因我失踪了。

假设这是为了不让服务器陷入困境，但我正在寻找是否存在基于（代码）的不太明显的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T11:12:37.707

有三个原因，都是相互关联的。

1.  真正的 Web 服务器可以更好地提供静态内容。事实。它们针对标准下载式流量进行了优化，并将爵士乐与核心游戏服务器代码分开对许多开发人员来说很有意义。此外，与定制的 HTTP 服务器相比，它们倾向于使用相对较少的资源并具有更高的灵活性。

2.  将 HTTP 下载从游戏服务器上移开可以让那些重要的 CPU 周期按照你的意愿去做：让人们互相残杀......如果你可以将非关键流量转移到另一个更便宜和/或集群的服务器上，您可以保持游戏流畅。

3.  正如我上面所暗示的，您可以对 HTTP 流量进行集群或 CDN，这是游戏服务器无法做到的（出于相当明显的原因）。这仅适用于非常繁忙的网络，但如果您要处理大量潜在下载并且它们都是关键任务，这是管理流量的好方法。

一些游戏服务器确实自己处理它，但是，正如您所注意到的，大多数以令人作呕的缓慢速度处理它，同样是因为上面的第二个原因：资源。带宽几乎与 CPU 一样重要，因此上传速度受到严格限制，以使玩家在游戏中保持最高速度。

# c++ - make 文件中的“.target-name”目标会一直运行吗？

> ID：540666
> 
> 赞同：2
> 
> 时间：2009-02-12T09:54:57.300
> 
> 标签：c++, c, build-process, makefile

我是制作和制作文件的新手，所以如果这是非常基本的，请原谅我。

我正在查看我的项目中的一些 makefile，我看到了两种类型的目标——不以 . 性格和目标。

从我的猜测来看，似乎“.target-name”目标总是被执行，我的假设是真的吗？我确实通过谷歌搜索阅读了有关 makefile 的信息，但没有找到任何具体的内容。

和往常一样，感谢您的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T10:01:54.943

不。

带点的目标通常是特殊含义的目标（即它们的功能内置于 make 中）。其中之一是 .PHONY，它定义了始终执行的目标（这意味着其规则中的命令是无条件运行的）。

但还有其他一些，例如默认规则的 .DEFAULT 或 .PRECIOUS ，在中断时不会删除隐式构建目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T10:21:40.467

为了了解 make，尤其是 gmake，我建议看一下优秀的书“使用 GNU Make 管理项目”（经过[消毒的亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0596006101)）。

HTH。

干杯，

# maven-2 - Maven 2 插件，构建 + surefire

> ID：540697
> 
> 赞同：3
> 
> 时间：2009-02-12T10:09:52.710
> 
> 标签：maven-2, maven-plugin, surefire

如果我在 <build> 标记中定义了一个插件并想在我的站点命令中使用它，我该怎么做？我是否必须再次在 <reporting> 标记中定义插件？

以及我可能在构建标签中完成的配置以及想要在报告标签中进行的配置怎么样？（我不想指定例如配置文件的位置两次，只是为了在 2 个生命周期中使用插件）

例如：我在构建标签中定义了我的 checkstyle 插件，并为要使用的规则配置了一个自定义位置。我这样做是因为规则被打包在一个 jar 中，所以我可以将它定义为依赖项。如果我在报告标签中这样做，这是不可能的。但我还需要在报告标签中使用这个插件，以便 surfire 可以为 checkstyle 生成报告。所以我还必须在报告标签中定义插件。

也许我在这里做错了，但除此之外我不知道该怎么做。我不喜欢的是我的 pom 中有两次 1 个插件（在构建标签和报告标签中）。

我希望有人可以验证我的解决方案是否正常，或者给我建议如何做得更好。

谢谢

库库

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T10:30:33.067

当您定义它时，maven 插件通常会在给定的生命周期阶段执行。插件本身指定这是哪个生命周期阶段，但如果您有特殊需要，您可以更改它。

如果您有一个多模块构建，您可以定义一组插件，其中包含公共父 pom 中所需的所有参数。这通常会为构建中的每个子模块执行。如果您不希望这种情况发生，您可以像这样定义它（在父 pom 中）：

```
<plugin>
   <artifactId>maven-surefire-plugin</artifactId>
       <configuration>
            <skip>true</skip>
       </configuration>
   ... More plugin cofniguration stuff ...
 </plugin> 
```

如果您在一个或多个嵌套模块中想要启用此插件，您可以说：

```
<plugin>
   <artifactId>maven-surefire-plugin</artifactId>
       <configuration>
            <skip>false</skip>
       </configuration>
   ... Maybe Configuration ....
 </plugin> 
```

在那个特定的模块中。您可以选择是否要重新配置从父定义继承的默认参数。

我想这就是你要找的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T17:55:24.387

除了 KRosenvold 的回答之外，您还可以通过在`<pluginManagment>`部分中声明一个插件来最小化配置，也许在[继承链中的最顶层 pom 中](http://maven.apache.org/pom.html#Inheritance)，然后您可以[省略在您声明它使用的所有其他地方指定插件的版本](http://maven.apache.org/pom.html#Plugin_Management).

家长会：

```
<pluginManagement>
    <plugins>
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.2-beta-1</version>
        </plugin>
    </plugins>
<pluginManagement> 
```

儿童绒球：

```
<plugins>
    <plugin>
        <artifactId>maven-assembly-plugin</artifactId>
    </plugin>
</plugins> 
```

# c# - 使用 C# 访问 GIF 帧

> ID：540701
> 
> 赞同：17
> 
> 时间：2009-02-12T10:12:43.483
> 
> 标签：c#, gif, animated-gif

我是 C# 的初学者。我想知道是否有办法使用 C# 访问 GIF 动画中的不同帧。我正在使用 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-12T10:26:09.597

尝试这个：

```
using System.Drawing;    
using System.Drawing.Imaging;

Image gifImg = Image.FromFile(pathToGifFile);
FrameDimension dimension = new FrameDimension(gifImg.FrameDimensionsList[0]);
// Number of frames
int frameCount = gifImg.GetFrameCount(dimension);
// Return an Image at a certain index
gifImg.SelectActiveFrame(dimension, index); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-12T10:19:15.137

有点谷歌搜索：[在 C# 中编辑动画 gif](http://social.microsoft.com/Forums/en-US/netfxbcl/thread/fcb7d14d-d15b-4336-971c-94a80e34b85e)

> 您可以使用 Image.GetFrameCount() 和 SelectActiveFrame() 读取动画 Gif。

# java - 在 OSX 10.5 上运行/编译 jdbc-sqlite

> ID：540702
> 
> 赞同：1
> 
> 时间：2009-02-12T10:12:58.880
> 
> 标签：java, sqlite, jdbc

我一辈子都无法获得位于此处的库：[http](http://www.xerial.org/trac/Xerial/wiki/SQLiteJDBC) ://www.xerial.org/trac/Xerial/wiki/SQLiteJDBC和[zentus.com](http://zentus.com/sqlitejdbc/)在 OSX 10.5 上以本机 (JNI) 模式运行。如果我查询驱动程序的模式，它总是显示“纯”，这意味着它在嵌套 VM 模式下运行，并且纯 Java 代码正在运行以查询 sqlite 数据库，这比较慢。但是，我确实（以及多么明显）希望它以本机模式运行，这样更快:)

我尝试自己编译它，但是在运行单元测试（zentus）时找不到sqlite库或编译找不到dylib10.5.1.so（xerial）时遇到麻烦。

有没有在 10.5 上以 JNI 模式运行这个 jdbc 驱动程序？两个消息来源都声称有可能......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-11T00:05:13.687

有一个新项目[SQLJet](http://sqljet.com/)，它是 SQLite 的纯 Java 实现。它还不支持所有的 SQLite 特性，但对于一些使用 SQLite 数据库的 Java 项目来说可能是一个很好的选择。

# jquery - 使用 jQuery 验证 RECAPTCHA

> ID：540706
> 
> 赞同：8
> 
> 时间：2009-02-12T10:16:08.297
> 
> 标签：jquery, recaptcha

我正在尝试使用 jQuery 验证 Recaptcha，但我不断收到错误消息告诉我：访问受限 URI 被拒绝”代码：“1012

这是我迄今为止尝试过的：

```
 var challengeVal = $("#recaptcha_challenge_field").attr("value");
 var reponseVal = $("#recaptcha_response_field").attr("value");
 var remoteIp = <%= "'" + Request.ServerVariables["REMOTE_HOST"] + "'" %>
 var privateKey = 'MY_PRIVATE_KEY';

 var requestUrl = "http://api-verify.recaptcha.net/verify?privatekey=" + privateKey + "&remoteip=" + remoteIp + "&challenge=" + challengeVal + "&response=" + reponseVal;

 $.ajax({
    type: "POST",
    url: requestUrl,
    dataType: "json",
    success: function(data) {
       alert('response from recaptcha');
    },
    error: function() {
       alert("An error occured.");
    }
  }); 
```

有人试过这个，谁能指出我正确的方向？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-12T10:46:00.347

出于安全原因，禁止 JavaScript 进行跨域 XMLHttpRequests。有一些[变通方法](http://ajaxian.com/archives/csshttprequest-cross-domain-ajax-using-css-for-transport)，但它们仅在您控制两个域时才有效。

解决方案：对自己的服务器进行AJAX调用，并通过服务器端代码联系recaptcha。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T00:18:15.933

我会看-> [racaptcha docs AJAX](https://developers.google.com/recaptcha/docs/display#AJAX) 在javascript中有一个完整的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-12T12:22:41.987

可以从此[页面](http://www.darksideofthecarton.com/2008/12/15/validating-recaptcha-jquery-ajax/)找到并下载完整的演示。但是您仍然需要在此处为​​您的域生成公钥和私钥[https://www.google.com/recaptcha/admin/create](https://www.google.com/recaptcha/admin/create)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-03T21:05:57.447

@Magnar 已经回答了关于安全原因的问题。@Guido Lemmens 2 给出了一个 PHP 示例。我想从另一个 Stack [question](https://stackoverflow.com/questions/6082650/javascript-jquery-or-ajax-version-of-recaptcha-validate/10001258#10001258)添加一些 ASP.NET WebForms (vs. MVC) 代码。

# c# - 将 .Net 1.1 项目迁移到 3.5 后的代表

> ID：540708
> 
> 赞同：0
> 
> 时间：2009-02-12T10:17:07.763
> 
> 标签：c#, .net, delegates

我已将 .Net 旧 .Net 项目从 .Net 1.1 迁移到 .Net 3.5，当我尝试运行它时，出现以下错误：

> 跨线程操作无效：控件“grpLogin”从创建它的线程以外的线程访问。

当一个线程（我假设它不是 UI 线程）将按钮的启用属性更改为 true 时。

我认为在框架中进行了一些更改以添加此限制，有没有办法在不彻底检查整个应用程序的情况下完成这项工作？

我可以让 VS（我正在使用 VS 2008）将应用程序作为 .Net 1.1 运行（我什至不确定这是问题所在）

该应用程序只是一个 API 的测试应用程序，我被告知要对其进行逆向工程，所以我真的没有足够的带宽来解决它的所有问题。我知道它以前可以工作，但我没有安装旧版本的 VS，所以我不得不将它转换为 VS 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T10:45:35.883

解决方法不是使用匿名方法：它只是使用`Control.Invoke`或`Control.BeginInvoke`以*某种*方式。无论是匿名方法、从方法组创建的委托还是 lambda 表达式都无关紧要 - 关键是您需要编组到 UI 线程。有关更多详细信息，请参阅[我的线程文章](http://pobox.com/~skeet/csharp/threads/winforms.shtml)。您可能还想考虑使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)来简化它。（我的文章是在 .NET 2.0 之前编写的，因此缺少 BackgroundWorker 引用。）

顺便说一下，这已经是您的 1.1 代码中的一个错误 - 这不是 .NET 2.0 中的新限制，只是 .NET 2.0 在调试模式下运行时添加了一个检查（抛出您看到的异常）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T10:24:37.900

Found Fix [here](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/447970ba-1384-4b07-9566-395dad9db90d/)解决方案是使用匿名代表：

```
 // running on worker thread...
  string newText = LongRunningOperation();

  //switch to UI thread
  this.Invoke((MethodInvoker)delegate {
    // this bit runs on the UI thread
    this.Text = newText;
  }); 
```

显然，用你想在 UI 线程中运行的任何代码替换“this.Text”，很有魅力。

仍然对在 VS 2008 下作为 .Net 1.1 运行的方式感兴趣我听说您可以在其中运行多个 F/Work 版本，只是不知道如何。

我已经开始将匿名代表添加到任何有 UI 代码来解决此问题的地方。

# javascript - 处理 Javascript 中的重复对象

> ID：540709
> 
> 赞同：0
> 
> 时间：2009-02-12T10:18:19.727
> 
> 标签：javascript

我有一个 javascript 方法，可以处理从一个选择框移到另一个选择框。代码运行如下：

```
 function moveAllOptions(formName, selectId1, selectId2) {

     var sourceSelect = eval("document." + formName + "." + selectId1);
     var destSelect = eval("document." + formName + "." + selectId2);

     for (var i = 0; i < sourceSelect.length; i++) {  

         var optionText = sourceSelect.options[i].text;
         var optionValue = sourceSelect.options[i].value;

         for (var j = 0; j < destSelect.length; j++) {
             if (destSelect.options[j].value == optionValue) {
                 destSelect.options[j].value = null;
             }
         }

     }

 } 
```

但是我发现了一个问题，例如当它遇到重复值时它并没有删除所有值。例如：在我的视图源中

```
value="139">Customer Service<
value="231">Customer Service<
value="231">Customer Service<
value="231">Customer Service<
value="231">Customer Service< 
```

在这种情况下，它只从我的左侧框中删除了两个对象。有没有办法删除重复的对象。我能想到的一种方法是创建一个两个数组对象（二维），将左侧的所有值传递给一个数组，然后迭代到另一个数组，最后再次传递给普通选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T10:37:26.077

好吧，首先，寻找元素的评估是可怕的。[从getElementById](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-getElBId)开始有更好的方法。

至于您的实际问题，还有更简单的本地方法可以做到这一点：select 对象（[reference](http://www.javascriptkit.com/jsref/select.shtml)）的`add`and方法。试试这个方法开始。`remove`

```
function transferOptions(A, B)
{
    var a = document.getElementById(A);
    var b = document.getElementById(B);

    while(a.options.length)
    {
        var x = a.options[0]; //store the value
        a.remove(0); //remove it from the DOM
        b.add(x); //reinsert it (adds to end of list)
    }
}

transferOptions('select1','select2') //usage 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T02:29:31.847

```
 for (var j = 0; j < destSelect.length; j++) {
         if (destSelect.options[j].value == optionValue) {
             destSelect.options[j].value = null;
         }
     } 
```

假设第一个匹配的项目。您设置`destSelect.options[0].value`为 null，这实际上从列表中删除了第一个选项。接下来检查`destSelect.options[1]`，这实际上是原始列表中的第三个选项。第二个选项刚刚变成了第一个，并且占据了`destSelect.options[0]`.

避免这个问题的方法是倒退，从列表中的最后一项开始，一直到第一项。

```
 for (var j = destSelect.length-1; j >=0; j--) {
         if (destSelect.options[j].value == optionValue) {
             destSelect.options[j].value = null;
         }
     } 
```

# c - 同时连接 32 位 DB2 和 64 位 DB2 的 C/C++ 程序

> ID：540715
> 
> 赞同：2
> 
> 时间：2009-02-12T10:19:59.363
> 
> 标签：c, unix, 64-bit, db2, 32-bit

是否有可能在 *IX 操作系统中成功编写一个同时在 32 位和 64 位 DB2 实现上运行的 C/C++ 程序？

确切的要求是从 32 位 DB2 数据库读取并写入 64 位 DB2 数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T05:37:36.757

由于 C 通用客户端使用网络连接，因此 32 位客户端不应该连接到 32 位或 64 位服务器（或两者都在单独的连接上）没有明显的理由。相同的注释适用于 64 位客户端。用于客户端和服务器之间通信的 DRDA 协议应该没问题。

我可以明确回答 Informix（您没有问过）——我使用 32 位或 64 位 ESQL/C 连接到 32 位或 64 位 IDS 服务器没有问题。唯一的限制是共享内存连接；那么客户端和服务器必须具有相同的“bittiness”。但是网络连接和本地（流、套接字）连接是中性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T15:13:32.043

我猜你的问题是，你必须同时加载两个库。您不能只使用两个 -l 选项在可执行文件中链接两者，因为符号名称会发生​​冲突。如果这是问题所在，请 dlopen 如果您的朋友。

```
#include <dlfcn.h>

void * handle=dlopen(filename,RTLD_NOW|RTLD_GLOBAL);

bool (*some_function)(char * name);
some_function=(bool (*)(char *))dlsym(handle,"name_of_some_function");
if (some_function("test")) {
    ....
} else {
    ....
} 
```

因为我不了解 DB2，所以我无法进一步帮助您，但如果这是问题所在，那么您现在应该拥有解决问题的一切。

# asp.net - 通过 Javascript 访问日历控件

> ID：540717
> 
> 赞同：0
> 
> 时间：2009-02-12T10:21:17.987
> 
> 标签：asp.net, javascript, visual-studio-2005, calendar

我有一个 asp.net 日历控件，比如 Calendar1，处于不可见状态（可见 = false）。当我按下客户端按钮时，如何使用 javascript 将可见设置为 true 以便不进行回发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T10:24:13.377

你真的想要这个 ASP.NET AJAX 控制工具包 - [http://www.asp.net/AJAX/AjaxControlToolkit/Samples/Calendar/Calendar.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/Calendar/Calendar.aspx)

标准的 ASP.NET 日历控件不是为良好的客户端实现而设计的，它发布了很多 waaaaaaaaaay！

# c++ - 直接从vim编译

> ID：540721
> 
> 赞同：16
> 
> 时间：2009-02-12T10:22:51.663
> 
> 标签：c++, vim, compilation

我想在不关闭 vi 的情况下编译 cpp 文件。
我知道**:!g++ file.cpp**但我更喜欢**:make**所以我在 .vimrc 文件中添加了这一行

> au 文件类型 C 设置 makeprg=gcc\ %
> au 文件类型 Cpp 设置 makeprg=g++\ %

但我不断收到
“make: ***** No targets specified and no makefile found. Stop.**”消息。
谁能告诉我我的设置有什么问题？
我用上面的选项编译成功。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-12T10:28:48.220

您需要在那里进行替换，请尝试以下操作：

```
set makeprg=gmake\ %:r.o 
```

哦，这假设你有：

1.  目录中的 (M|m)akefile，或
2.  默认 SUFFIX 规则可用于您的环境（看起来没有）

输入以下命令检查默认值：

```
make -n <my_file>.o 
```

看看这是否给你一些明智的东西。

如果在其他位置有 makefile，您可以添加 -f 选项以指向 makefile，例如：

```
set makeprg=gmake\ -f\ ../some_other_dir/makefile\ %:r.o 
```

顺便说一句，要了解 make，尤其是 gmake，我建议您看一下优秀的书“使用 GNU Make 管理项目”（经过[消毒的亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0596006101)）。

HTH。

干杯

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-13T01:00:06.237

我应该将**C,Cpp**更改为**c,cpp**，然后它可以正常工作。

谢谢大家，尤其是**Rob Wells**，您的回答对我帮助很大。谢谢你。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-12T10:26:12.763

我认为如果您编写一个 Makefile 并将其放在 vi 可以找到的地方会容易得多。我不确定你是否真的使用 vi（我只使用过 Vim），但是当有 Makefile 时，编译应该像编写**:make**一样简单（不需要 set makeprg）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-02-27T14:49:28.197

它可以通过使用键映射轻松实现。

首先打开你的 vimrc 文件和文件中的这些行，

```
autocmd filetype cpp nnoremap <F4> :!g++ % -ggdb -o %:r <CR>
autocmd filetype cpp nnoremap<F5> :!g++ % -ggdb -o %:r && ./%:r <CR> 
```

第一行将键 F4 映射到**编译文件**。第二行映射键 F5 以**编译和运行**。

如果您经常使用 gdb，那么这也可能会派上用场。

```
autocmd filetype cpp nnoremap<F10> :!g++ % -ggdb -o %:r && gdb -tui %:r <CR> 
```

此行映射键 F10 以**编译和启动 gdb**

希望这可以帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-19T17:19:39.037

我推荐一个名为 SingleCompile 的 vim 插件，而不是你所做的： http: [//www.vim.org/scripts/script.php ?script_id=3115](http://www.vim.org/scripts/script.php?script_id=3115)

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-02-12T22:17:35.567

首先，只需制作该死的make文件。那里的每个工具都希望与 make 一起使用，如果您的编译如此简单，则编写一个将所有 c 和 cpp 文件编译为可执行文件的 make 文件大约需要 30 秒。

其次，如果您拒绝使用 make 文件，请尝试

```
:help system 
```

这应该为您提供足够的信息来提出您自己的类似于此的命令

```
:com Mymake call system("g++ ".expand("%")) 
```

# sql - SQL Server 2005 日期比较 - 排序问题

> ID：540722
> 
> 赞同：2
> 
> 时间：2009-02-12T10:23:43.567
> 
> 标签：sql, sql-server-2005

在我的数据库中，我有一个通过链接服务器选项从 Excel 工作表创建的表。

我现在正试图将其内容与我的一个主表进行比较。

我正在比较的表在同一个数据库中。

两个表中都有一个日期列，两种类型都是日期时间，并有 SQL_Latin1_General_CP1_CI_AS 的排序规则，与 DB 相同。

服务器排序规则是 Latin1_General_CI_AS

但是，当我尝试运行比较表之间日期的查询时，出现错误：

```
 Cannot resolve the collation conflict between
      "Latin1_General_CI_AS" and
      "SQL_Latin1_General_CP1_CI_AS" in the
      equal to operation. 
```

我已经尝试使用和不使用 COLLATE 选项，同时使用两种排序规则设置。

我的查询是：

```
select * , hxl.holiday_dt, 
datediff(d, h.holiday_dt collate SQL_Latin1_General_CP1_CI_AS, 
            hxl.holiday_dt collate SQL_Latin1_General_CP1_CI_AS)
from holiday h, Holiday_XL hxl
where h.currency_cd=hxl.currency_cd 
```

事实上，任何涉及两个表的查询都会给出完全相同的排序规则错误，例如这个：

```
select count(*)
from Holiday_XL c
where c.currency_cd in (select distinct h.currency_cd from holiday h) 
```

提前感谢您的任何想法。

问候，克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T10:32:04.653

该错误是在货币比较**h.currency_cd=hxl.currency_cd**上报告的，而不是在 datediff 上，因此请尝试对货币进行强制排序。

排序规则仅与字符（char、varchar、nvarchar）和文本类型相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T10:56:40.843

在排序规则下并给出排序规则表级别，有很多提示和代码可用于网络搜索与排序规则的主题。

如果你有问题。将 excel 的内容插入到@table 或永久表中，并在选择比较时为该表提供排序规则

# algorithm - Firefox 的“真棒”栏如何匹配字符串？

> ID：540725
> 
> 赞同：28
> 
> 时间：2009-02-12T10:24:28.667
> 
> 标签：algorithm, firefox, string

问题是如何完成字符串匹配以通过 firefox 3 [url bar](http://mozillalinks.org/wp/2007/11/firefox-3-location-bar-just-became-almighty/)找到匹配的条目。每个条目上的子字符串匹配可能很慢。什么算法可以用来快速匹配任意位置？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-07-30T18:30:48.613

Firefox 3.0 中位置栏的算法有点复杂。它将从两个（Firefox 3.5 及更高版本为三个）不同的查询中获取数据：

*   对于第一个查询，它检查 moz_inputhistory 表以查看当前搜索字符串是否存储在该表中。这些结果按“等级”排序，“等级”是一个确定它最近使用时间的数字。这个数字每天下降一次。这种搜索使位置栏随着时间的推移适应您选择的内容（在[错误 95739](https://bugzilla.mozilla.org/show_bug.cgi?id=395739)中实现）。

*   在 Firefox 3.5 和更高版本中，它会检查 moz_keyword 表中的书签，其关键字与搜索文本完全匹配。

*   最后一个查询，它遍历 moz_places 中的每个条目，其中将包括所有历史访问和书签。这些结果按[频率排序](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/Places/Frecency_algorithm)。

对于所有这三种情况，以下算法用于匹配标签、标题和 url（下面称为“可搜索文本”）。这有点难以用语言解释，所以[看源代码](http://mxr.mozilla.org/seamonkey/source/toolkit/components/places/src/nsNavHistoryAutoComplete.cpp#157)可能更容易。

1.  搜索字符串被分成由空格确定的标记（每个非空格“单词”都是一个标记）。
2.  对于每个标记，开始以 Unicode、不区分大小写的方式比较可搜索文本的每个字符和标记，直到完全匹配。如果一组字符不匹配，请前进到可搜索文本中的下一个“[单词边界](http://mxr.mozilla.org/seamonkey/source/toolkit/components/places/src/nsNavHistoryAutoComplete.cpp#141)”并重试。
3.  如果我们匹配任何一个可搜索的文本，它将显示在位置栏中。
4.  如果我们没有足够的结果（默认为 12），我们将通过每个书签和历史访问重做查询的搜索，并以 Unicode、不区分大小写的方式在任何地方测试每个标记的可搜索文本（不仅仅是在单词边界）。

希望以一种可以理解的方式解释它！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-12T17:39:48.790

进行快速子字符串匹配的常规方法是创建一个数据结构，其中包含您要搜索的所有字符串的所有后缀。根据组织的不同，这可以称为“后缀树”或“后缀数组”。例如，如果您有 1000 个字符串并且每个字符串的长度为 50 个字符，那么您就有 1.000 x 50 个重要的后缀，即您的后缀数组将有 50.000 个条目。

然后要进行匹配，您可以进行二分查找（如果是数组）或树搜索（如果是树）以查找数据结构中的所有后缀，其*开头*与搜索框中写入的字符串匹配。因为它是您要匹配的后缀的开头，所以您可以使用标准搜索程序（二分搜索、树下降）来快速获得结果。每个后缀都链接到它出现的那些字符串。

示例：您有两个字符串“CAT”和“DOT”。您的后缀数组如下所示（注意词典 = 字母顺序）：

```
#1 AT  --> CAT
#2 CAT --> CAT
#3 DOT --> DOT
#4 OT  --> DOT
#5 T   --> DOT, CAT 
```

请注意，有六个后缀，但其中两个是相同的（“CAT”和“DOT”中的最后一个“T”）并且它们都由相同的条目（#5）表示。

现在，当用户输入搜索时，例如“OT”（应该匹配“DOT”），您可以在日志时间进行简单的字典排序查找，因为您现在正在后缀数组中搜索*开始*匹配。

这是搜索模式不包含通配符时快速文本搜索的基本原理。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-02-12T10:38:56.650

awesomebar 通过一种称为[The Places frecency algorithm](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/Places/Frecency_algorithm)的算法建议 URLS 。

根据 Mozilla 开发者网站：

> “频率”这个词本身就是“频率”和“新近度”这两个词的组合。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T10:31:05.310

我认为这是留给底层存储的：Firefox 存储您访问的页面的 SQLite 数据库提供了一个快速的子字符串比较功能。

我认为 Firefox 向数据库发出 SQL 查询。这非常快，因为数据库缓存在您的内存中。

# java - 使用 Spring IoC 的 Null 内部 Bean

> ID：540729
> 
> 赞同：0
> 
> 时间：2009-02-12T10:25:20.690
> 
> 标签：java, spring, dependency-injection, inversion-of-control

我有一个像这样的单例 bean 定义：

```
<bean id="exampleBean" class="com.examples.ExampleBean">
  <property name="exampleBean2">
    <bean class="com.examples.ExampleBean2" />
  </property>
</bean> 
```

`ExampleBean`可能在哪里：

```
public class ExampleBean {
  private ExampleBean2 exampleBean2;

  public ExampleBean() { }

  public ExampleBean2 getExampleBean2() { return exampleBean2; }
  public void setExampleBean2(ExampleBean2 exampleBean2) { this.exampleBean2 = exampleBean2; }
} 
```

问题是，在某些情况下，`com.examples.ExampleBean2` `class`运行时可能不存在，当 IoC 尝试实例化`exampleBean`.

我需要的是忽略来自 IoC 的此错误并允许`exampleBean`创建但保留`exampleBean2`属性`null`。

所以问题是：这有可能吗？

感谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T15:08:42.400

如果您使用自动装配，您希望达到的效果是可能的。

```
<bean class="com.examples.ExampleBean" autowire="byType" />
<bean class="com.examples.ExampleBean2" /> 
```

或通过注释

```
@Autowired(required=false)
ExampleBean2 exampleBean2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T10:54:31.620

是否可以在您的 ExampleBean 上声明一个初始化方法，并在此初始化方法中检查 ExampleBean2 类是否存在，如果存在则设置它？

```
<bean id="exampleBean" class="com.examples.ExampleBean" init-method="init"/> 
```

也许在这里做事的更好方法是使用某种形式的 NullPattern，您*始终*提供 ExampleBean2 的实现，即使它只是它的“null”值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T10:57:07.933

如果我做对了，当 Spring 尝试实例化 bean 时，不会加载 ExampleBean2。这个对吗？在那种情况下，我不认为你可以用 Spring 的内置功能做很多事情。

也许您可以创建一个始终存在的容器类。此类将检查是否加载了 ExampleBean2，如果是，它将实例化它的一个实例。容器类将有一个 Object 属性，该属性可以是 null 也可以是 ExampleBean2 的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T10:56:05.797

也许[lazy-init](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-lazy-init)会这样做，但我认为spring至少会在创建应用程序上下文时检查bean实现类是否可用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T11:11:54.713

也许这会起作用：

```
public class NullFactoryBean implements FactoryBean {

    @Override
    public Object getObject() throws Exception {
        return null;
    }

    @Override
    public Class<?> getObjectType() {
        return Object.class;
    }

    @Override
    public boolean isSingleton() {
        return false;
    }

} 
```

接着...

```
public class ClassNotFoundPostProcessor implements BeanFactoryPostProcessor {

    @Override
    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
        String[] beanDefinitionNames = beanFactory.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            BeanDefinition beanDefinition = beanFactory.getBeanDefinition(beanDefinitionName);
            String beanClassName = beanDefinition.getBeanClassName();
            try {
                Class.forName(beanClassName);
            } catch (ClassNotFoundException e) {
                beanDefinition.setBeanClassName(NullFactoryBean.class.getName());
            }
        }
    }

} 
```

接着...

```
<beans>
    <bean id="exampleBean" class="com.examples.ExampleBean">
        <property name="exampleBean2">
            <bean class="com.examples.ExampleBean2" />
        </property>
    </bean>

    <bean class="ClassNotFoundPostProcessor" />
</beans> 
```

**编辑：**很抱歉，这似乎没有抓住内豆。我在测试时错过了这个细节。它只捕获顶级bean。顺便说一句，com.examples.ExampleBean 可能无论如何都不会加载，因为它本身直接依赖于 ExampleBean2 类，虚拟机找不到该类，从而导致错误

# cmake - 构建系统和可移植性

> ID：540737
> 
> 赞同：6
> 
> 时间：2009-02-12T10:27:20.843
> 
> 标签：cmake, build-system

我想知道如何制作一个可移植的构建系统（一步一步），我目前使用 cmake，因为它一开始很容易设置，只有一个拱目标，但现在我必须打包我正在开发的库我想知道如何使其可移植到我正在测试的拱门的最佳方式。

我知道我需要一个 config.h 来根据拱门定义事物，但我不知道这有多自动化。

任何其他拥有构建系统的方式都受到热烈欢迎！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-12T10:44:59.147

您可以只使用 CMake，它非常简单。

你需要这些东西：

首先，意味着找出配置细节。例如，如果您知道某个函数在某个平台上的名称不同，您可以使用它[`TRY_COMPILE`](http://www.cmake.org/cmake/help/cmake2.6docs.html#command:try_compile)来发现：

```
TRY_COMPILE(HAVE_ALTERNATIVE_FUNC 
    ${CMAKE_BINARY_DIR}
    ${CMAKE_SOURCE_DIR}/alternative_function_test.cpp
    CMAKE_FLAGS -DINCLUDE_DIRECTORIES=xxx
) 
```

where`alternative_function_test.cpp`是您的源目录中的一个文件，该文件仅使用替代定义进行编译。

`HAVE_ALTERNATIVE_FUNC`如果编译成功，这将定义变量。

其次，您需要使此定义影响您的来源。您可以将其添加到编译标志

```
IF(HAVE_TR1_RANDOM)
    ADD_DEFINITIONS(-DHAVE_TR1_RANDOM)
ENDIF(HAVE_TR1_RANDOM) 
```

或者你可以制作一个`config.h`文件。`config.h.in`使用以下行创建

```
#cmakedefine HAVE_ALTERNATIVE_FUNCS 
```

并在(参见)`config.h`中通过这一行创建一个文件`CMakeLists.txt`[`CONFIGURE_FILE`](http://www.cmake.org/cmake/help/cmake2.6docs.html#command:configure_file)

```
CONFIGURE_FILE(config.h.in config.h @ONLY) 
```

将`#cmakedefine`被转换为`#define`或`#undef`取决于 CMake 变量。

顺便说一句，要测试 edianness，请参阅[此邮件](http://www.cmake.org/pipermail/cmake/2005-March/006276.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T10:37:08.853

我一直在使用 GNU autoconf/automake 工具链，到目前为止它对我来说效果很好。我只真正关注 Linux/x86（和 64 位）和 Mac，如果你在 PowerPC 上构建，这很重要，因为字节序问题。

使用 autoconf，您可以使用宏检查主机平台：

```
AC_CANONICAL_HOST 
```

并使用以下命令检查字节顺序：

```
AC_C_BIGENDIAN 
```

Autoconf 然后会将定义添加到您可以在代码中使用的 config.h。

我不确定（从未尝试过）GNU 自动工具在 Windows 上的效果如何，因此如果 Windows 是您的目标之一，那么您最好使用现有的 cmake 构建系统找到类似的功能。

有关自动工具的良好入门，请看这里：

[http://www.freesoftwaremagazine.com/books/autotools_a_guide_to_autoconf_automake_libtool](http://www.freesoftwaremagazine.com/books/autotools_a_guide_to_autoconf_automake_libtool "自动工具指南")

# java - Java Sandbox 安全性中的内存分配过多

> ID：540738
> 
> 赞同：2
> 
> 时间：2009-02-12T10:27:37.003
> 
> 标签：java, security, resources

在 Java 安全模型下，可以阻止来自不受信任的类的最危险的操作，但是我上次检查时（几年前），不受信任的代码仍然有可能通过不断分配内存来执行拒绝服务攻击，直到JVM 崩溃并出现 OutOfMemoryException。现在看，我看不出情况有任何改善。

我需要在 Java 应用程序中运行来自 3rd 方的不受信任的代码，我想知道是否有可能以某种方式限制类或线程可以在 Java 安全模型中分配的堆/堆栈空间。从而防止基于内存分配的 DoS 攻击。我知道-Xss，但据我所知，它限制了所有线程，其中大部分不需要限制。

我还考虑为不受信任的代码创建一个容器，该容器将在自己的 JVM 中运行并通过套接字与主应用程序通信，或者对不受信任的代码进行一些静态分析。然而，这两个听起来都比我希望的要付出更多的努力，尽管如果有人知道这个技巧或开源库，我很感兴趣。

那么，有没有办法限制线程可以分配给自己的内存量，或者有其他方法可以防止 Java 中的内存分配拒绝服务攻击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T10:35:38.140

目前无法使用 Java 中的标准 API 来执行此操作。

越来越多的人对此感兴趣，并且正在进行一个名为[Resource Consumption Management API](http://jcp.org/en/jsr/detail?id=284)的 JSR，这可能值得研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T13:48:23.683

您将需要在单独的进程中运行不受信任的代码。可能仍然有 DoS 的方法，例如在旧版本的 Windows 上，您可以轻松耗尽所有 GDI 资源（最近没有尝试过，现在我们没有 Swing）。

# iis - IIS 服务器版本兼容性

> ID：540739
> 
> 赞同：2
> 
> 时间：2009-02-12T10:28:31.073
> 
> 标签：iis, master-pages, version

我们能否将针对 IIS 5.0 开发的应用程序运行到更高版本，即 IIS（5.1、6.0、7.0）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T10:30:48.743

简短的回答：是的，你可以。

稍微长一点的答案：我猜你是在谈论 ASP.NET 应用程序？您只需确保在该服务器上安装了正确的 .NET 框架版本（1.1、2.0 或 3.5）。框架版本可以并行安装在同一台服务器上。

这是 IIS 大师 Bill Staples 撰写的一篇关于 IIS 迁移的好文章：[如何从 IIS 6 迁移到 IIS 7](http://blogs.iis.net/bills/archive/2008/06/18/how-to-migrate-from-iis-6-to-iis-7.aspx)

# sql - 优化 SQL 查询

> ID：540743
> 
> 赞同：3
> 
> 时间：2009-02-12T10:30:18.183
> 
> 标签：sql, mysql, optimization, left-join, inner-join

我还能做些什么来优化这个查询？

```
SELECT * FROM
    (SELECT `item`.itemID, COUNT(`votes`.itemID)  AS `votes`,
           `item`.title, `item`.itemTypeID, `item`.
           submitDate, `item`.deleted, `item`.ItemCat,
           `item`.counter, `item`.userID, `users`.name,
           TIMESTAMPDIFF(minute,`submitDate`,NOW()) AS 'timeMin' ,
           `myItems`.userID as userIDFav, `myItems`.deleted as myDeleted
      FROM    (votes `votes` RIGHT OUTER JOIN item `item`
                  ON (`votes`.itemID = `item`.itemID))
           INNER JOIN
              users `users`
           ON (`users`.userID = `item`.userID)
    LEFT OUTER JOIN
              myItems `myItems`
           ON (`myItems`.itemID = `item`.itemID)
     WHERE (`item`.deleted = 0)
     GROUP BY `item`.itemID,
              `votes`.itemID,
              `item`.title,
              `item`.itemTypeID,
              `item`.submitDate,
              `item`.deleted,
              `item`.ItemCat,
              `item`.counter,
              `item`.userID,
              `users`.name,
              `myItems`.deleted,
              `myItems`.userID
    ORDER BY `item`.itemID DESC) as myTable
where myTable.userIDFav = 3 or myTable.userIDFav is null
            limit 0, 20 
```

我正在使用 MySQL

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-12T10:34:29.827

**分析器对此查询说了什么？**如果不知道表中有多少行，您就无法判断任何优化。所以运行分析仪，你会看到哪些零件的成本是多少。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T11:35:16.157

当然，正如@theomega 所说，看执行计划。

但我也建议尝试“清理”你的陈述。（我不知道哪个更快 - 这取决于您的表格大小。）通常，我会尝试从一个干净的语句开始并从那里开始优化。但通常情况下，一个干净的语句会使优化器更容易提出一个好的执行计划。

因此，以下是对您的陈述的一些观察，可能会使事情变慢：

*   几个外连接（使优化器很难找出要使用的索引）
*   一组由
*   很多列分组

据我了解您的 SQL，此语句应该完成您正在执行的大部分操作：

```
SELECT `item`.itemID, `item`.title, `item`.itemTypeID, `item`.
       submitDate, `item`.deleted, `item`.ItemCat,
       `item`.counter, `item`.userID, `users`.name,
       TIMESTAMPDIFF(minute,`submitDate`,NOW()) AS 'timeMin' 
  FROM    (item `item` INNER JOIN users `users`
       ON (`users`.userID = `item`.userID) 
```

在哪里

当然，这会丢失您外部加入的表中的信息，我建议尝试通过子选择添加所需的列：

```
SELECT `item`.itemID, 
       (SELECT count (itemID)
        FROM votes v
       WHERE v.itemID = 'item'.itemID) as 'votes', <etc.> 
```

这样，您可以摆脱一个外部联接和分组依据。外连接被子选择替换，因此需要权衡取舍，这可能对“更干净”的语句不利。

根据 item 和 myItems 之间的基数，您可以执行相同的操作，或者您必须坚持使用外部连接（但无需重新引入 group by）。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T10:36:30.993

一些快速的半随机想法：

您的 itemID 和 userID 列是否已编入索引？

如果在查询的开头添加“EXPLAIN”并运行它会发生什么？它使用索引吗？他们明智吗？

您是否需要运行整个内部查询并对其进行过滤，或者您可以将`where myTable.userIDFav = 3 or myTable.userIDFav is null`部分移动到内部查询中吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T10:40:21.793

您在 Group By 列表中似乎确实有太多字段，因为其中一个是 itemID，我怀疑您可以使用内部 SELECT 来执行分组，并使用外部 SELECT 来返回所需的字段集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T10:50:10.350

您不能将 where 子句**myTable.userIDFav = 3 或 myTable.userIDFav is null**添加到**WHERE ( `item`.deleted = 0)**吗？

问候
利文

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T21:31:01.293

Look at the way your query is built. You join a lot of stuff, then limit the output to 20 rows. You should have the outer join on items and myitems, since your conditions only apply to these two tables, limit the output to the first 20 rows, then join and aggregate. Here you are performing a lot of work that is going to be discarded.

# c# - 如何通过键名获取枚举值

> ID：540746
> 
> 赞同：9
> 
> 时间：2009-02-12T10:31:01.240
> 
> 标签：c#

```
public enum aa{ a1=1,a2=2,a3=6,...,a100=203} 
```

如何获得这样的价值

```
string att=GetFromDatabase("attribute");    //this return a1 or a2 ...
Enum.GetValue(att); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-12T10:36:38.310

解决方案

```
string name = GetFromDatabase("attribute");
Enum.Parse(typeof(aa),name); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-12T10:40:33.197

这样的事情应该可以解决问题：

```
aa attEnum = (aa)Enum.Parse(typeof(aa), att); 
```

有关更多详细信息，请访问[http://msdn.microsoft.com/en-us/library/system.enum.parse.aspx](http://msdn.microsoft.com/en-us/library/system.enum.parse.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T10:37:44.937

使用[Enum.Parse](http://msdn.microsoft.com/en-us/library/essfb559.aspx)

```
string att=GetFromDatabase("attribute");    //this return a1 or a2 ...
Enum.Parse(typeof(aa), att); 
```

# c++ - 无效、无效、C 和 C++

> ID：540748
> 
> 赞同：12
> 
> 时间：2009-02-12T10:31:24.797
> 
> 标签：c++, c, standards

我有以下代码：

```
typedef void VOID;
int f(void);
int g(VOID); 
```

它在 C 中编译得很好（在 Fedora 10 上使用 gcc 4.3.2）。与 C++ 编译的相同代码给了我以下错误：

```
void.c:3: error: ‘&lt;anonymous>’ has incomplete type
void.c:3: error: invalid use of ‘VOID’ 
```

现在，这是外部库中的内容，我希望所有者解决该问题。所以我有一个问题——C++ 标准是否禁止这种结构？你能给我一个指针/引用吗？我唯一能记得的是在 C++ 中不推荐使用 (void) 来表示空参数列表的函数声明，但我不明白为什么 typedefed VOID 不起作用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-12T10:45:03.623

~~gcc 错误~~。编辑：由于不够清楚，我的意思是 gcc 4.3.2 由于错误而正在编译它。请参阅[#32364](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=32364)和[#9278](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=9278)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-12T11:06:55.490

是的，据我所知，第二个声明在 C++ 和 C89 中无效，但在 C99 中有效。

来自 C99 草案，TC2 ( `6.7.5.3/10`)：

> void 类型的未命名参数作为列表中唯一项的特殊情况指定该函数没有参数。

它明确地谈论“void”类型，而不是关键字。

来自 C++ 标准，`8.3.5/2`：

> 如果 parameter-declaration-clause 为空，则该函数不接受任何参数。参数列表`(void)`相当于空参数列表。

从模板参数推导失败的一种情况`14.8.2/2`（

> *   试图创建一个参数类型为 void 的函数类型。

[其他人已经清楚地说明了这一点，在此处](http://anubis.dkuug.dk/jtc1/sc22/wg21/docs/cwg_closed.html#18)的一个核心语言问题报告和其他答案链接的一些 GCC 错误报告中值得注意。

* * *

回顾一下，您的 GCC 是正确的，但早期的 GCC 版本是错误的。因此，该代码可能已在较早时成功编译。您应该修复您的代码，以便它对两个函数都使用“void”，然后它也将与其他编译器一起编译（comeau 也拒绝使用该“VOID”的第二个声明）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T10:41:24.007

我只是把你的代码放在一个 .cpp 文件中，它在 VS2005、SUSE、Redhat 和 Solaris 中编译没有问题，所以我猜你的特定 gcc 版本不赞成这个。加尔

# c# - C# 类可以从其接口继承属性吗？

> ID：540749
> 
> 赞同：119
> 
> 时间：2009-02-12T10:31:31.987
> 
> 标签：c#, attributes

这似乎意味着“不”。这是不幸的。

```
[AttributeUsage(AttributeTargets.Interface | AttributeTargets.Class,
 AllowMultiple = true, Inherited = true)]
public class CustomDescriptionAttribute : Attribute
{
    public string Description { get; private set; }

    public CustomDescriptionAttribute(string description)
    {
        Description = description;
    }
}

[CustomDescription("IProjectController")]
public interface IProjectController
{
    void Create(string projectName);
}

internal class ProjectController : IProjectController
{
    public void Create(string projectName)
    {
    }
}

[TestFixture]
public class CustomDescriptionAttributeTests
{
    [Test]
    public void ProjectController_ShouldHaveCustomDescriptionAttribute()
    {
        Type type = typeof(ProjectController);
        object[] attributes = type.GetCustomAttributes(
            typeof(CustomDescriptionAttribute),
            true);

        // NUnit.Framework.AssertionException:   Expected: 1   But was:  0
        Assert.AreEqual(1, attributes.Length);
    }
} 
```

类可以从接口继承属性吗？还是我在这里吠错了树？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-12T10:40:04.930

不可以。无论何时在派生类中实现接口或覆盖成员，您都需要重新声明属性。

如果您只关心 ComponentModel（不是直接反射），则有一种方法 ( [`[AttributeProvider]`](http://msdn.microsoft.com/en-us/library/system.componentmodel.attributeproviderattribute.aspx)) 可以从现有类型中建议属性（以避免重复），但它仅对属性和索引器的使用有效。

举个例子：

```
using System;
using System.ComponentModel;
class Foo {
    [AttributeProvider(typeof(IListSource))]
    public object Bar { get; set; }

    static void Main() {
        var bar = TypeDescriptor.GetProperties(typeof(Foo))["Bar"];
        foreach (Attribute attrib in bar.Attributes) {
            Console.WriteLine(attrib);
        }
    }
} 
```

输出：

```
System.SerializableAttribute
System.ComponentModel.AttributeProviderAttribute
System.ComponentModel.EditorAttribute
System.Runtime.InteropServices.ComVisibleAttribute
System.Runtime.InteropServices.ClassInterfaceAttribute
System.ComponentModel.TypeConverterAttribute
System.ComponentModel.MergablePropertyAttribute 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-06-17T16:30:21.947

您可以定义一个有用的扩展方法...

```
Type type = typeof(ProjectController);
var attributes = type.GetCustomAttributes<CustomDescriptionAttribute>( true ); 
```

这是扩展方法：

```
/// <summary>Searches and returns attributes. The inheritance chain is not used to find the attributes.</summary>
/// <typeparam name="T">The type of attribute to search for.</typeparam>
/// <param name="type">The type which is searched for the attributes.</param>
/// <returns>Returns all attributes.</returns>
public static T[] GetCustomAttributes<T>( this Type type ) where T : Attribute
{
  return GetCustomAttributes( type, typeof( T ), false ).Select( arg => (T)arg ).ToArray();
}

/// <summary>Searches and returns attributes.</summary>
/// <typeparam name="T">The type of attribute to search for.</typeparam>
/// <param name="type">The type which is searched for the attributes.</param>
/// <param name="inherit">Specifies whether to search this member's inheritance chain to find the attributes. Interfaces will be searched, too.</param>
/// <returns>Returns all attributes.</returns>
public static T[] GetCustomAttributes<T>( this Type type, bool inherit ) where T : Attribute
{
  return GetCustomAttributes( type, typeof( T ), inherit ).Select( arg => (T)arg ).ToArray();
}

/// <summary>Private helper for searching attributes.</summary>
/// <param name="type">The type which is searched for the attribute.</param>
/// <param name="attributeType">The type of attribute to search for.</param>
/// <param name="inherit">Specifies whether to search this member's inheritance chain to find the attribute. Interfaces will be searched, too.</param>
/// <returns>An array that contains all the custom attributes, or an array with zero elements if no attributes are defined.</returns>
private static object[] GetCustomAttributes( Type type, Type attributeType, bool inherit )
{
  if( !inherit )
  {
    return type.GetCustomAttributes( attributeType, false );
  }

  var attributeCollection = new Collection<object>();
  var baseType = type;

  do
  {
    baseType.GetCustomAttributes( attributeType, true ).Apply( attributeCollection.Add );
    baseType = baseType.BaseType;
  }
  while( baseType != null );

  foreach( var interfaceType in type.GetInterfaces() )
  {
    GetCustomAttributes( interfaceType, attributeType, true ).Apply( attributeCollection.Add );
  }

  var attributeArray = new object[attributeCollection.Count];
  attributeCollection.CopyTo( attributeArray, 0 );
  return attributeArray;
}

/// <summary>Applies a function to every element of the list.</summary>
private static void Apply<T>( this IEnumerable<T> enumerable, Action<T> function )
{
  foreach( var item in enumerable )
  {
    function.Invoke( item );
  }
} 
```

**更新：**

这是 SimonD 在评论中提出的较短版本：

```
private static IEnumerable<T> GetCustomAttributesIncludingBaseInterfaces<T>(this Type type)
{
  var attributeType = typeof(T);
  return type.GetCustomAttributes(attributeType, true)
    .Union(type.GetInterfaces().SelectMany(interfaceType =>
        interfaceType.GetCustomAttributes(attributeType, true)))
    .Cast<T>();
} 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-05-26T10:13:02.820

Brad Wilson 的一篇关于此的文章：[接口属性！= 类属性](http://bradwilson.typepad.com/blog/2011/08/interface-attributes-class-attributes.html)

总结一下：类不从接口继承，而是实现它们。这意味着属性不会自动成为实现的一部分。

如果需要继承属性，请使用抽象基类，而不是接口。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-12-03T00:13:46.437

虽然 C# 类不从其接口继承属性，但在 ASP.NET MVC3 中绑定模型时有一个有用的替代方法。

如果您将视图的模型声明为接口而不是具体类型，则视图和模型绑定器将应用属性（例如，`[Required]`或`[DisplayName("Foo")]`在渲染和验证模型时从接口：

```
public interface IModel {
    [Required]
    [DisplayName("Foo Bar")]
    string FooBar { get; set; }
} 

public class Model : IModel {
    public string FooBar { get; set; }
} 
```

然后在视图中：

```
@* Note use of interface type for the view model *@
@model IModel 

@* This control will receive the attributes from the interface *@
@Html.EditorFor(m => m.FooBar) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-09-05T19:52:25.610

这更适合那些希望从已实现接口上可能存在的属性中提取属性的人。因为这些属性不是类的一部分，所以这将使您可以访问它们。请注意，我有一个简单的容器类，可让您访问 PropertyInfo - 因为这正是我需要的。根据需要进行破解。这对我来说效果很好。

```
public static class CustomAttributeExtractorExtensions
{
    /// <summary>
    /// Extraction of property attributes as well as attributes on implemented interfaces.
    /// This will walk up recursive to collect any interface attribute as well as their parent interfaces.
    /// </summary>
    /// <typeparam name="TAttributeType"></typeparam>
    /// <param name="typeToReflect"></param>
    /// <returns></returns>
    public static List<PropertyAttributeContainer<TAttributeType>> GetPropertyAttributesFromType<TAttributeType>(this Type typeToReflect)
        where TAttributeType : Attribute
    {
        var list = new List<PropertyAttributeContainer<TAttributeType>>();

        // Loop over the direct property members
        var properties = typeToReflect.GetProperties();

        foreach (var propertyInfo in properties)
        {
            // Get the attributes as well as from the inherited classes (true)
            var attributes = propertyInfo.GetCustomAttributes<TAttributeType>(true).ToList();
            if (!attributes.Any()) continue;

            list.AddRange(attributes.Select(attr => new PropertyAttributeContainer<TAttributeType>(attr, propertyInfo)));
        }

        // Look at the type interface declarations and extract from that type.
        var interfaces = typeToReflect.GetInterfaces();

        foreach (var @interface in interfaces)
        {
            list.AddRange(@interface.GetPropertyAttributesFromType<TAttributeType>());
        }

        return list;

    }

    /// <summary>
    /// Simple container for the Property and Attribute used. Handy if you want refrence to the original property.
    /// </summary>
    /// <typeparam name="TAttributeType"></typeparam>
    public class PropertyAttributeContainer<TAttributeType>
    {
        internal PropertyAttributeContainer(TAttributeType attribute, PropertyInfo property)
        {
            Property = property;
            Attribute = attribute;
        }

        public PropertyInfo Property { get; private set; }

        public TAttributeType Attribute { get; private set; }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-19T05:00:35.160

编辑：这包括从成员的接口继承属性（包括属性）。上面有类型定义的简单答案。我刚刚发布了这个，因为我发现它是一个令人讨厌的限制并想分享一个解决方案:)

接口是多重继承，在类型系统中表现为继承。这种事情没有充分的理由。反射有点胡作非为。我添加了评论来解释这些废话。

（这是 .NET 3.5，因为它恰好是我目前正在使用的项目。）

```
// in later .NETs, you can cache reflection extensions using a static generic class and
// a ConcurrentDictionary. E.g.
//public static class Attributes<T> where T : Attribute
//{
//    private static readonly ConcurrentDictionary<MemberInfo, IReadOnlyCollection<T>> _cache =
//        new ConcurrentDictionary<MemberInfo, IReadOnlyCollection<T>>();
//
//    public static IReadOnlyCollection<T> Get(MemberInfo member)
//    {
//        return _cache.GetOrAdd(member, GetImpl, Enumerable.Empty<T>().ToArray());
//    }
//    //GetImpl as per code below except that recursive steps re-enter via the cache
//}

public static List<T> GetAttributes<T>(this MemberInfo member) where T : Attribute
{
    // determine whether to inherit based on the AttributeUsage
    // you could add a bool parameter if you like but I think it defeats the purpose of the usage
    var usage = typeof(T).GetCustomAttributes(typeof(AttributeUsageAttribute), true)
        .Cast<AttributeUsageAttribute>()
        .FirstOrDefault();
    var inherit = usage != null && usage.Inherited;

    return (
        inherit
            ? GetAttributesRecurse<T>(member)
            : member.GetCustomAttributes(typeof (T), false).Cast<T>()
        )
        .Distinct()  // interfaces mean duplicates are a thing
        // note: attribute equivalence needs to be overridden. The default is not great.
        .ToList();
}

private static IEnumerable<T> GetAttributesRecurse<T>(MemberInfo member) where T : Attribute
{
    // must use Attribute.GetCustomAttribute rather than MemberInfo.GetCustomAttribute as the latter
    // won't retrieve inherited attributes from base *classes*
    foreach (T attribute in Attribute.GetCustomAttributes(member, typeof (T), true))
        yield return attribute;

    // The most reliable target in the interface map is the property get method.
    // If you have set-only properties, you'll need to handle that case. I generally just ignore that
    // case because it doesn't make sense to me.
    PropertyInfo property;
    var target = (property = member as PropertyInfo) != null ? property.GetGetMethod() : member;

    foreach (var @interface in member.DeclaringType.GetInterfaces())
    {
        // The interface map is two aligned arrays; TargetMethods and InterfaceMethods.
        var map = member.DeclaringType.GetInterfaceMap(@interface);
        var memberIndex = Array.IndexOf(map.TargetMethods, target); // see target above
        if (memberIndex < 0) continue;

        // To recurse, we still need to hit the property on the parent interface.
        // Why don't we just use the get method from the start? Because GetCustomAttributes won't work.
        var interfaceMethod = property != null
            // name of property get method is get_<property name>
            // so name of parent property is substring(4) of that - this is reliable IME
            ? @interface.GetProperty(map.InterfaceMethods[memberIndex].Name.Substring(4))
            : (MemberInfo) map.InterfaceMethods[memberIndex];

        // Continuation is the word to google if you don't understand this
        foreach (var attribute in interfaceMethod.GetAttributes<T>())
            yield return attribute;
    }
} 
```

准系统 NUnit 测试

```
[TestFixture]
public class GetAttributesTest
{
    [AttributeUsage(AttributeTargets.All, AllowMultiple = true, Inherited = true)]
    private sealed class A : Attribute
    {
        // default equality for Attributes is apparently semantic
        public override bool Equals(object obj)
        {
            return ReferenceEquals(this, obj);
        }

        public override int GetHashCode()
        {
            return base.GetHashCode();
        }
    }

    [AttributeUsage(AttributeTargets.All, AllowMultiple = true, Inherited = false)]
    private sealed class ANotInherited : Attribute { }

    public interface Top
    {
        [A, ANotInherited]
        void M();

        [A, ANotInherited]
        int P { get; }
    }

    public interface Middle : Top { }

    private abstract class Base
    {
        [A, ANotInherited]
        public abstract void M();

        [A, ANotInherited]
        public abstract int P { get; }
    }

    private class Bottom : Base, Middle
    {
        [A, ANotInherited]
        public override void M()
        {
            throw new NotImplementedException();
        }

        [A, ANotInherited]
        public override int P { get { return 42; } }
    }

    [Test]
    public void GetsAllInheritedAttributesOnMethods()
    {
        var attributes = typeof (Bottom).GetMethod("M").GetAttributes<A>();
        attributes.Should()
            .HaveCount(3, "there are 3 inherited copies in the class heirarchy and A is inherited");
    }

    [Test]
    public void DoesntGetNonInheritedAttributesOnMethods()
    {
        var attributes = typeof (Bottom).GetMethod("M").GetAttributes<ANotInherited>();
        attributes.Should()
            .HaveCount(1, "it shouldn't get copies of the attribute from base classes for a non-inherited attribute");
    }

    [Test]
    public void GetsAllInheritedAttributesOnProperties()
    {
        var attributes = typeof(Bottom).GetProperty("P").GetAttributes<A>();
        attributes.Should()
            .HaveCount(3, "there are 3 inherited copies in the class heirarchy and A is inherited");
    }

    [Test]
    public void DoesntGetNonInheritedAttributesOnProperties()
    {
        var attributes = typeof(Bottom).GetProperty("P").GetAttributes<ANotInherited>();
        attributes.Should()
            .HaveCount(1, "it shouldn't get copies of the attribute from base classes for a non-inherited attribute");
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-30T13:49:11.407

添加具有附加到类具有的相同属性的属性/自定义属性的属性的接口。我们可以使用 Visual Studio 重构功能提取类的接口。有一个部分类实现该接口。

现在获取类对象的“类型”对象，并使用类型对象上的 getProperties 从属性信息中获取自定义属性。这不会在类对象上提供自定义属性，因为类属性没有附加/继承接口属性的自定义属性。

现在对上面检索到的类的 Type 对象调用 GetInterface(NameOfImplementedInterfaceByclass)。这将提供接口的“类型”对象。我们应该知道实现的接口的名称。从 Type 对象获取属性信息，如果接口的属性附加了任何自定义属性，则属性信息将提供自定义属性列表。实现类必须提供接口属性的实现。在接口的属性信息列表中匹配类对象的具体属性名称，得到自定义属性列表。

这将起作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-18T15:50:14.293

尽管我的回答较晚且针对特定案例，但我想补充一些想法。正如其他答案中所建议的那样，反射或其他方法会做到这一点。

在我的情况下，所有模型都需要一个属性（时间戳）来满足实体框架核心项目中的某些要求（并发检查属性）。我们可以在所有类属性之上添加 [] （在模型实现的 IModel 接口中添加，不起作用）。但是我通过 Fluent API 节省了时间，这在这些情况下很有帮助。在 fluent API 中，我可以检查所有模型中的特定属性名称并在 1 行中设置为 IsConcurrencyToken() ！

```
var props = from e in modelBuilder.Model.GetEntityTypes()
            from p in e.GetProperties()
            select p;
props.Where(p => p.PropertyInfo.Name == "ModifiedTime").ToList().ForEach(p => { p.IsConcurrencyToken = true; }); 
```

同样，如果您需要将任何属性添加到 100 个类/模型中的相同属性名称，我们可以使用流利的 api 方法进行内置或自定义属性解析器。虽然 EF（核心和 EF6）fluent api 可能在幕后使用反射，但我们可以省力:)

# version-control - 一个内置在 DVCS 中的 wiki？

> ID：540751
> 
> 赞同：10
> 
> 时间：2009-02-12T10:32:01.300
> 
> 标签：version-control

在这里，我们沿着主观胡同走..

最近，我在一些存储库中添加了一个名为“whiteboard.txt”的文件。我使用 Mercurial，但这适用于任何 DVCS。

文本文件的目的是散列格式、流程、想法等。鉴于大多数分布式版本控制系统都有某种 Web 界面，为什么不将一个目录表示为“wiki”并允许查看和使用它因此使用类似 Wiki Creole 标记的东西？

显然，只有具有提交访问权限的人才能进行更改。

我的观点是，当代码准备好发布时，设计维基和相当多的文档就会完成。为什么不将两个最重要的协作工具整合为一个呢？

例如，如果我可以：

hg --wiki 并找到一组 30 个补丁背后的原因以及它们的预期方向，而不是提交日志中的缩写评论 .. 哇 :) 任何提交都可以引用 wiki 条目，而且讨论成为存储库的一部分，而不是二级站点。

如果您喜欢使用 DVCS，因为您可以离线工作，为什么这没有意义？

编辑：

重点是，如果 'joe' 提交了一个文件，他应该能够设置一个 'nag' 属性，该属性会提示任何其他人更改文件以更新某个 wiki 页面，所有这些都在离线时完成，并解决了未来的合并问题在幕后。毕竟，它是文本，而不是代码，可以被视为 FIFO。

如果您可以离线提交，您还可以离线更新 wiki 并稍后推送您的更改，即使是补丁格式。

这个想法看似简单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T13:52:26.233

有一个名为[Fossil](http://www.fossil-scm.org/index.html/doc/tip/www/index.wiki)的项目正是这样做的。我没有亲自使用它，但它是由编写 SQLite 的同一个人制作的，所以我猜它又小又快。事实上，据该网站称，所有内容都存储在一个小型 SQLite 数据库中，因此应该易于存档和传输。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T13:44:41.837

也许[http://ikiwiki.info/](http://ikiwiki.info/)

一个维基编译器。您可以指示它将 wiki 源代码（markdown 文本文件）存储在存储库中（例如 git、mercurial、subversion）。可以通过网络或工作副本进行编辑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T14:28:17.660

另见[哈达](http://hatta.sheep.art.pl/)。我一直试图让它工作但没有成功，但这只是因为我在设置 Python 时很糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T10:35:23.553

好主意，但我会将 wiki 保存在单独的存储库中。

有点像[Bitbucket.org](http://bitbucket.org)（当你注册一个分支时，你会得到两个 hg 存储库，一个用于源代码，一个用于 wiki）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T13:31:44.877

我有几个建议：

*   [GitHub](http://github.com/)有一个集成的 wiki（[例如](http://wiki.github.com/rails/rails)）。许多其他托管 VCS 解决方案也是如此，例如 Google Code。
*   [Trac](http://trac.edgewall.org/)是一个 wiki，具有非常紧密的 VCS 绑定和面向开发的重点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T14:53:42.403

使用有关已完成内容和原因的信息来注释您的提交，这部分是我使用问题跟踪系统（例如[Trac](http://trac.edgewall.org/) ）的部分原因。Trac 站点（或他们称之为环境）可以附加版本控制。您可以使用 'r' 来引用版本控制中的修订，使用 '#' 符号来引用票证，甚至是 Trac 中的 wiki 页面。

现在，如果您要将源代码和问题跟踪结合在一起，就像[Mylyn](http://www.eclipse.org/mylyn/) （如果您是 Eclipse 开发人员）到您的 IDE 中，那么[“魔法”](http://tasktop.com/videos/mylyn/webcast-mylyn-3.0.html)开始发生。我已经看到 Visual Studio Team System 处理问题跟踪和版本控制的方式，但我不得不说我对 Mylyn 的处理方式印象深刻（因为它也可以离线处理问题）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-16T11:59:11.807

试试 jscreolewiki，它可以在浏览器中离线工作，将 wiki 内容存储在 DVCS 中是个好主意。

[http://jscreolewiki.googlecode.com/svn/trunk/jscreolewiki/index.html](http://jscreolewiki.googlecode.com/svn/trunk/jscreolewiki/index.html)

# wpf - 如何将元素的 alpha 值附加到滑块？

> ID：540755
> 
> 赞同：1
> 
> 时间：2009-02-12T10:33:00.737
> 
> 标签：wpf, binding

是否可以将元素的 alpha 值绑定到滑块？

例如，这是允许滑块改变元素的高度和顶部位置的代码，但是在边框的 Background 属性中控制 alpha 值的语法是什么？

```
<Window x:Class="WpfApplication25.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid Background="Tan">
        <StackPanel>
            <Canvas>
                <Border Background="#{Binding ElementName=theSlider, Path=Value}ffff00" 
            Canvas.Left="40" 
            Canvas.Top="{Binding ElementName=theSlider, Path=Value}" 
            CornerRadius="5" 
            BorderBrush="Brown"
            BorderThickness="1"
            >
                    <Rectangle 
            Height="{Binding ElementName=theSlider, Path=Value}"
            Width="50"
            />
                </Border>
            </Canvas>
        </StackPanel>

        <Slider Name="theSlider" HorizontalAlignment="Left" Width="200" Minimum="10" Maximum="200" Cursor="Hand"/>

    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T12:31:48.890

绑定到“不透明度”属性，不要忘记将滑块最小值设置为 0，最大值设置为 1

# .net - 安全地将 .NET 1.1 Web 服务切换到 WCF？

> ID：540763
> 
> 赞同：2
> 
> 时间：2009-02-12T10:36:07.000
> 
> 标签：.net, wcf, web-services

知道并非所有客户端都使用 .NET 访问服务，将 .NET 1.1 Web 服务切换到 WCF 服务是否安全？所以他们使用 SOAP/XML 方法。我们可以在客户端无需更改代码的情况下切换到 WCF 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:11:39.223

是的你可以。

您可以让 WCF 服务的 SOAP/XML 甚至 JSON 共存，这样您仍然支持现有协议。

**通过搜索“WCF SOAP JSON POX”**检查谷歌的第一个结果 我很确定这就是你所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T17:21:26.713

是的。虽然我还没有使用 1.1 Web 服务，但我能够将 .NET 2.0 Web 服务重构为 WCF 服务，然后使用 basicHttpBinding 公开它。客户甚至不知道其中的区别。

我在处理它时挖掘了一些保存的链接，[这个博客](http://geekswithblogs.net/marcel/archive/2007/09/27/115662.aspx)和一篇[好的 msdn 文章](http://msdn.microsoft.com/en-us/library/ms731134.aspx)是我开始的动力。真的很简单，也很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T17:31:31.837

是 .NET 1.1 提供数据还是消耗数据？

.NET 1.1 Web 服务不处理可为空的类型，因此如果它们尝试使用 .NET 2.0 提供的包含可为空整数的 Web 服务，那么它们就会死得很惨。

[我不确定这是否适用于 WCF，但值得检查。]

# java - 如何通过 JMS API 设置 MQMD ApplicationID 字段？

> ID：540764
> 
> 赞同：2
> 
> 时间：2009-02-12T10:36:24.470
> 
> 标签：java, jakarta-ee, jms, ibm-mq

我正在使用 JMS API 将消息发送到 Websphere MQ 服务器。提取我创建的消息的应用程序希望我将 MQMD 结构中的 ApplicationID 字段设置为常量值。我在 JMS API 中找不到访问 MQMD 结构的方法

问题：有没有办法做到这一点？如果是，那怎么办？如果不是，那么我唯一的选择是使用 MQ java API，而不是 JMS API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-31T01:34:12.907

从 v7.0 开始，您可以将所有 MQMD 字段作为 JMS 消息属性读取，并且可以以相同的方式设置其中的许多字段。

请参阅：http: [//publib.boulder.ibm.com/infocenter/wmqv7/v7r0/topic/com.ibm.mq.csqzaw.doc/jm41030_.htm](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/topic/com.ibm.mq.csqzaw.doc/jm41030_.htm)

不过，客户端和 WMQ 服务器都必须是 v7.0 或更高版本才能使用此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-23T17:11:26.463

可以从收到的消息中读取 MQMD 字段。通过调用 setMQMDReadEnabled(true) 方法在目标上设置 MQMDReadEnabled 属性。

然后您可以使用 getStringProperty 方法读取 applicationIdentityData。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T13:10:27.813

从 MQ 文档：

[在 MQMD 包含与 JMS 字段等效的字段的情况下，JMS 字段映射到 MQMD 字段。其他 MQMD 字段作为 JMS 属性公开，因为 JMS 应用程序在与非 JMS 应用程序通信时可能需要获取或设置这些字段。](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/topic/com.ibm.mq.csqzaw.doc/jm25430_.htm)

您正在寻找的属性可能是“ [JMSXAppID](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp?topic=/com.ibm.mq.csqzaw.doc/jm25450_.htm) ”。

如果这不起作用，请检查文档。有很多奇怪的东西，例如“如果应用程序使用与代理的实时连接，则本节不适用。” （所以你不想要“与经纪人的实时连接”......不管这意味着什么）。

此外，“[管理员通过将目标的 TARGCLIENT 属性设置为 MQ 来指示 JMS 应用程序正在与此类应用程序进行通信。](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/topic/com.ibm.mq.csqzaw.doc/jm25510_.htm) ”

如果这没有意义，您必须创建测试用例来帮助您弄清楚 MQ 在幕后做什么。创建一条 JMS 消息，将所有属性设置为一些奇怪的值，然后将其发送到一个非活动的 MQ 队列，您可以在其中检查它。通过这种方式，您可以确定哪些字段映射在哪里。

完成后，您可以尝试其他方式。如果您的 JMS 实现不允许您以映射或其他形式获取消息的所有属性，请使用 Java 调试器查看内存中的数据。`Field.setAccessible(true)`是你的朋友。

# wpf - 将 Microsoft 应用程序块的日志记录与 WPF 结合使用

> ID：540767
> 
> 赞同：0
> 
> 时间：2009-02-12T10:37:02.973
> 
> 标签：wpf, logging

我有一个 WPF 应用程序，我想使用 Microsoft 应用程序块进行日志记录 (MIcrosoft.Practices.EnterpriseLibrary.Logging)

我该如何配置它才能工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T10:53:34.227

这取决于您希望在何处以及如何保存日志数据。

[从http://msdn.microsoft.com/en-us/library/dd203099.aspx](http://msdn.microsoft.com/en-us/library/dd203099.aspx)下载企业库 4.1

记录的快速入门。示例中的 app.config 就是您所追求的。为了使您的 WPF 日志记录正常工作，您不必对其进行太多更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T10:56:37.370

仅供参考，将 EntLib 与 WPF 应用程序与 WinForms 或服务器应用程序一起使用并没有什么特别之处（假设您没有启动用于视觉跟踪的表单）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-08T17:58:49.780

MSDN 对此有一个文档可以回答您的问题：

**将日志记录应用程序块与 WCF 应用程序集成**

[http://msdn.microsoft.com/en-us/library/ff648685.aspx](http://msdn.microsoft.com/en-us/library/ff648685.aspx)

# silverlight - 如何将 Slider 值绑定到 Silverlight 中的 Rectable 高度（在 WPF 中工作）？

> ID：540773
> 
> 赞同：1
> 
> 时间：2009-02-12T10:37:38.853
> 
> 标签：silverlight, data-binding

此代码在 WPF 中有效，但在 Silverlight 中无效。

Silverlight 中是否有任何解决方法可以让我将滑块值绑定到元素高度？Silverlight 在这里有什么限制？

## 回答：

感谢彼得为其他人解决了这个问题：这是[带有在线演示和可下载代码的解决方案](http://tanguay.info/web/index.php?pg=codeExamples&id=67)。

```
<UserControl x:Class="Second12.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:basics="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
    Width="300" Height="200">
    <Grid Background="Tan">
        <StackPanel>
            <Canvas>
                <Border Background="#2200ffff" 
            Canvas.Left="40" 
            Canvas.Top="30" 
            CornerRadius="5" 
            BorderBrush="Brown"
            BorderThickness="1">
                    <Rectangle 
            Height="{Binding ElementName=theSlider, Path=Value}"
            Width="50"/>
                </Border>
            </Canvas>
        </StackPanel>
        <Slider Name="theSlider" HorizontalAlignment="Left" Width="200" Cursor="Hand"/>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T13:55:50.623

Silverlight 2 *目前*不支持 ElementName 绑定。[这篇 MSDN 文档文章](http://msdn.microsoft.com/en-us/library/cc903925(VS.95).aspx)非常简洁地介绍了 Silverlight 提供和当前不提供的 WPF 功能的细节。

在此期间，您必须使用某种中间属性，这是一个完整的示例：

页面.xaml：

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">

    <StackPanel x:Name="LayoutRoot" Background="AliceBlue">

        <Slider x:Name="Slider1" Minimum="10" SmallChange="10"
                LargeChange="20" Maximum="100"
                Value="{Binding HelperValue, Mode=TwoWay}" Cursor="Hand"/>

        <Rectangle x:Name="Rectangle1" Fill="Red"
                Height="{Binding HelperValue, Mode=OneWay}" Width="100" />

    </StackPanel>

</UserControl> 
```

页面.xaml.cs：

```
using System;
using System.ComponentModel;
using System.Windows.Controls;

namespace SilverlightApplication1
{
    public partial class Page : UserControl
    {
        BindingConduit<double> sliderToRect = new BindingConduit<double>(50.0);

        public Page()
        {
            InitializeComponent();

            LayoutRoot.DataContext = sliderToRect;
        }
    }

    public class BindingConduit<T> : INotifyPropertyChanged where T : struct
    {
        private T helperValue;

        public T HelperValue
        {
            get { return this.helperValue; }
            set
            {
                if ((this.helperValue.Equals(value) != true))
                {
                    this.helperValue = value;
                    this.RaisePropertyChanged("HelperValue");
                }
            }
        }

        public BindingConduit(T defaultValue)
        {
            HelperValue = defaultValue;
        }

        public event PropertyChangedEventHandler PropertyChanged;

        protected void RaisePropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler propertyChanged = this.PropertyChanged;

            if (propertyChanged != null)
            {
                propertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }
} 
```

Slider 的 Value 属性绑定到 HelperValue 并设置为 TwoWay，Rectangle 的 Height 绑定到相同的属性但只需要 OneWay。

HelperValue 属性是从 Page 中创建的名为 sliderToRect 的 BindingConduit<T> 类的实例中读取的。此实例设置为父 StackPanel 控件的 DataContext。Slider1 的 Value 属性中的任何更改都会反映在 Rectangle1 的高度中，因为 HelperValue 属性会引发 PropertyChanged 事件。

BindingConduit<T> 是我创建的一个自定义类，它实现了 INotifyPropertyChanged，还允许您为 HelperValue 指定一个默认值（在这种情况下，即 Slider1 的初始值和 Rectangle1 的高度 (50.0)）。

# django - 在 Django 中嵌入 TinyMCE 的问题：TinyMCE 应用程序不会显示在浏览器中

> ID：540779
> 
> 赞同：4
> 
> 时间：2009-02-12T10:38:43.857
> 
> 标签：django, tinymce, wysiwyg, django-flatpages

我正在使用 Django 开发 Web 应用程序，并且正在使用 Flatpages 应用程序。

现在，我正在尝试在 Flatpages 中嵌入 TinyMCE WYSIWYG 编辑器。我正在遵循 Apress 书中提到的步骤：Practical Django Projects。而且我做的一切都是正确的，但 TinyMCE 应用程序不会出现在浏览器中。当我询问 Django IRC 频道时，我们发现这不是 Django 问题，问题似乎出在 TinyMCE 本身。当我试图在 TinyMCE 网站上查找文档时，我发现要么非常过时，要么与我的问题完全无关。我该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T10:42:29.433

你试过[django-tinymce](http://code.google.com/p/django-tinymce/)吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-07T01:51:27.487

I had the django app but have ditched it in favour of: [http://code.djangoproject.com/wiki/AddWYSIWYGEditor](http://code.djangoproject.com/wiki/AddWYSIWYGEditor)

The instructions were simple and easy to follow - especially the flatpage bit.

The only real issue I had was having to set MEDIA_URL as a relative value. Until I did that - all my pop-up windows for links and html etc were blank!

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-17T12:40:20.303

作者[James Bennett](http://www.b-list.org/)提供[了本书第二版的源代码，](http://bitbucket.org/ubernostrum/practical-django-projects/src/)因此您可以：对照该代码检查您的代码，或者直接下载并使用他的代码。

但是，在获得进一步帮助之前，您需要回答两个具体问题：

1.  什么版本的书？（第二版涵盖 Django 1.1，即来自主干）

2.  您使用的是哪个版本的 Django？

3.  你有哪个版本的python（`python -V`）？

如果您使用的是第二版并从主干上安装了 Django，我可以提供帮助 - 我可以正常工作。这是我的（OS X）设置（仅用于使用主干中的 Django 完成本书的第二版）：

在`settings.py`：

```
TEMPLATE_DIRS = (
    '/Users/[myhome]/Sites/django-templates/cms/',
) 
```

在 urls.py 中：

```
(r'^tiny_mce/(?P<path>.*)$', 'django.views.static.serve',
            { 'document_root': '/Users/[myhome]/djangocode/cms/jscripts/tiny_mce/' }), 
```

然后是`change_form.html`从 django 目录复制的副本并复制到：

```
/django-templates/cms/admin/flatpages/flatpage/ 
```

包括：

```
{{ media }}
<script type="text/javascript" src="/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
tinyMCE.init({
  mode: "textareas",
  theme: "simple" //or use advanced
});
</script>
{% endblock %} 
```

看看它，让我们知道你的进展情况！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T12:16:50.250

对 JavaScript 问题的一个有用的第一个检查是确保所有脚本都已加载。在浏览器中查看生成页面的 HTML 源代码，找到所有`<script src="...">`标签并检查其路径是否可访问。

您还可以查看运行 Django 开发服务器的终端或`"Net"`Firebug 的选项卡。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T19:44:33.157

我自己一直在关注 Practical Django Projects 这本书。几天前我也嵌入了 TinyMCE。我可以帮忙，但我需要更多信息。显示模板上包含 TinyMCE javascript 文件的行。此外，请描述您放置 TinyMCE 文件夹的位置。我很确定您的问题是脚本包含引用与实际目录位置不匹配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-01T22:10:20.993

您可以查看 change_form.html 代码，该代码位于我的 /[模板路径]/[项目名称]/admin/flatpages/flatpage/ 中，它的工作原理就像一个魅力： http: [//pastebin.com/f21a1cd97](http://pastebin.com/f21a1cd97)

# session - 会话在应用程序池刷新时使用状态服务器过期

> ID：540783
> 
> 赞同：0
> 
> 时间：2009-02-12T10:39:36.633
> 
> 标签：session, pool, stateserver, recycle

我在两台不同的服务器上托管了一个 .NET 1.1 应用程序，但只要应用程序池被回收，所有会话都会在其中一台服务器上被丢弃。

两个应用程序都使用“StateServer”会话模式，据我所知，两个服务器具有完全相同的配置并且运行“ASP .NET State Server”服务。

这是一个特别麻烦的问题，因为这个应用程序池每 2-3 小时回收一次（这是我必须解决的另一个问题）。

有没有人知道可能导致这种情况？

提前致谢，

吉翁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-20T22:01:32.913

使用性能计数器“State Server Sessions Active”监控每个 State Server 实例中的活动用户会话数，以 (a) 确保两台服务器都在使用 STate Server，并且 (b) 看到这确实是由应用程序池回收引起的。

如果这两个应用程序共享会话状态，或者它们是两个不同的应用程序，那么您的问题有点不清楚，这对于解决方案可能很重要。

# svn - 使用 git-svn 和共享的颠覆主线会损失多少 git 的功能？

> ID：540784
> 
> 赞同：14
> 
> 时间：2009-02-12T10:40:02.387
> 
> 标签：svn, git, version-control, git-svn

我正在评估使我们的团队远离 CVS 的各种选择。我们在另一个站点上有另一个使用 Subversion 的大型团队，我们的一些开发人员使用 Subversion 服务器。因此，Subversion 对我们的团队来说是一个显而易见的选择。然而：

1.  涉及 Subversion 服务器的操作可能会很慢（尽管我们在站点之间有良好的连接）。
2.  我们中的许多人都接受了分布式版本控制的想法，并广泛使用 Mercurial 或 git（然后合并并提交到 CVS 并从

[git-svn](http://git-scm.com/docs/git-svn)看起来很[有趣](http://utsl.gen.nz/talks/git-svn/intro.html)，但我想知道的是，由于在 Subversion 中拥有少数集中式分支，DVCS （如 git）的功能有多少会丢失。特别是，我仍然希望能够保留 Mercurial 的工作流程，例如：

1.  我们可以拉取其他团队成员的存储库并合并，从而在特性分支进入我们在 Subversion 上的主要稳定主干之前就特性分支进行协作吗？
2.  我们是否可以期望 git 可能产生的大量诡计通常会起作用，或者我们是否需要小心避免混淆 git-svn？
3.  我们是否可以使用 git 来加快从 Subversion 的签出速度，方法是将其从另一个站点拉过连接一次，然后将其拉入单独的存储库一次。
4.  如果有人提交了 Subversion，我们可以安排其他 git 用户通过 git-svn 仍然看到完整的开发历史吗？
5.  尽管 Subversion 服务器有半个世界的延迟，我们是否可以基本上避免在 Subversion 服务器上等待交互操作？

我们中的许多人已经习惯了一个主要的相当稳定的共享分支的想法，它具有一个简单的线性历史，每个人都可以推送到它，因此它们会定期合并到尖端。我不清楚如何使用 git（或 Mercurial 或 Bazaar）很好地支持此工作流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T19:51:44.793

你确实失去了很多，感觉像是二等的，但你确实获得了所有精彩的分支东西。

我通过使用它来处理一个托管在颠覆中的项目来学习 git。git 允许我进行所有本地开发并在项目上取得相当大的进展，同时仍然跟踪主流分支，甚至与他人分享我的工作。

最后，我们最终将整个项目推到了 git 上，因为在进行 subversion 时丢失了所有信息。

你会失去什么：

1.  合并跟踪 - 有点。
2.  正确记录更改的作者身份。

我说“有点”WRT #1，因为如果你把一棵树放在一起，它会跟踪你用 git 做的合并和东西并应用于颠覆，但是一旦你尝试克隆那个 repo，或者其他人做了一个 git -svn clone，你失去了它并且合并再次变得非常痛苦。

作者身份对我来说很重要，因为我发现确保人们因其所做的工作而获得赞誉非常重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T20:38:55.583

正如已经提到的，与*纯*Git 体验`git-svn`相比有一定的局限性：

 *1.  团队协作很艰难：

    如果一位开发人员使用 将更改推送到 SVN 存储库`git-svn`，另一位开发人员获取的更改略有不同；获取的提交被转换了两次——从 Git 到 SVN，从 SVN 回到 Git。因此，很难以分布式方式进行协作。

2.  丢失的元数据：

    .gitignore 和 .gitattributes 文件在`git-svn`向 SVN 发送更改时会丢失，也就是说，`git-svn`不会将该元数据转换为相应的 Subversion 属性。其他开发人员在获取时不会收到元数据更改。

3.  丢失的合并跟踪数据：

    如果一个合并两个分支，`git`然后用 推送合并提交`git-svn`，Subversion 存储库不会自动获取任何关于合并历史的数据。

4.  弱分支支持：

    必须在 Subversion 存储库中创建一个分支，使用它获取它，`git-svn`然后才将更改提交到该分支。如果创建一个常规 Git 分支并尝试将其推送回 SVN 存储库，`git-svn`则不会创建新分支，而是将提交发送到现有分支。

[SubGit](http://subgit.com)是具有`git-svn`以下功能的替代品：

*   SubGit 作为一组钩子在服务器端工作，它同步 SVN 和 Git 存储库，保持双方可写；

*   可以使用任何 Git 客户端来使用支持 SubGit 的 Git 存储库；支持任何 Git 工作流程；

*   SubGit 修复了`git-svn`上面列出的所有问题。

SubGit 是一款具有许多免费选项的商业软件。有关更多信息，请参阅[文档](http://subgit.com/documentation/)并[与 git-svn 进行比较](http://subgit.com/documentation/gitsvn.html)。

免责声明：我是 SubGit 开发人员之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T11:04:36.823

对于我所看到的，您可以在存储库检索与 git-svn 之间使用 git（这样您就可以拥有一个 git 公共存储库，这将是您正在谈论的 svn 存储库的“镜像”，但 git 存储库可能是托管在您的站点中）。

因此 git 用户的 checkout/clone/push/pull 会很快。然后我想你可以在你的 git repo 中添加钩子以通过 git-svn 与 svn repo 同步，但是你必须处理冲突，直到你使用不同的分支。

我们在这里所做的是，每个开发人员都有一个带有他的名字的分支，并且他必须在管理员将他的分支与主分支合并之前与主分支合并（所以他正在处理冲突），没有任何冲突，因为开发人员已经处理了它.

希望这有帮助。

# c++ - std::string 连接的运行时依赖项

> ID：540800
> 
> 赞同：1
> 
> 时间：2009-02-12T10:45:11.953
> 
> 标签：c++, windows, linux, string, concatenation

```
std::string sAttr("");
sAttr = sAttr+VAL_TAG_OPEN+sVal->c_str()+VAL_TAG_CLOSE; 
```

在我定义的代码中的其他地方

```
const char VAL_TAG_OPEN[]   = "<value>"; 
```

`sVal`是一个从字符串指针数组中检索出来的变量。这在大多数系统、windows 和 linux 中都可以正常工作。然而，在一个客户站点上，我相信有一个版本的 linux，我们在该版本上进行了一些广泛的测试，产生的结果好像我从未使用过`VAL_TAG_OPEN`and `VAL_TAG_CLOSE`. 我收到的结果是

```
sAttr = sAttr+sVal->c_str(); 
```

这是怎么回事 ？。std::string 连接是否随运行时变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T10:59:33.887

为什么`->c_str()`？如果`sVal`是`std::string`，请尝试删除此调用。请记住，评估的顺序是未定义的，因此您最终可能会添加指针而不是连接字符串，因为`VAL_TAG_OPEN`和`sVal->c_str()`都是`VAL_TAG_CLOSE`纯 C 字符串。我建议您使用加法赋值运算符`+=`，例如：

```
sAttr += VAL_TAG_OPEN;
sAttr += *sVal; /* sVal->c_str() ? */
sAttr += VAL_TAG_CLOSE; 
```

（无论如何应该更快）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T11:27:40.980

不，std::string 连接绝对不应该依赖于运行时，但不知何故`VAL_TAG_OPEN`，`VAL_TAG_CLOSE`似乎是空字符串。

我猜你在某处有某种缓冲区溢出或无效指针算术，所以你的程序会覆盖包含那些“常量”值的内存。无论您的内存最终在哪里，都确实是运行时（以及操作系统版本）特定的。过去，我通过切换编译器或优化器选项被类似的事情困住了。

正如您提到在原始数组中保留指向 std::string 实例的原始指针，这些错误确实并非不可能，但可能难以检测，因为使用 DEBUG 构建不会给您任何迭代器检查所有这些到原始的东西......祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T20:29:31.397

我不认为是导致问题的评估顺序。这是因为开头和结尾的常量字符数组

```
const char VAL_TAG_OPEN[]   = "<value>";
const char VAL_TAG_CLOSE[]  = "</value>" 
```

连接运算符认为 VAL_TAG_OPN 和 VAL_TAG_CLOSE 不是空终止符字符串。因此优化器只是忽略了他们认为它是垃圾。

```
sAttr += std::string(VAL_TAG_OPEN);
sAttr += *sVal;
sAttr += std::string(VAL_TAG_CLOSE); 
```

这确实解决了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T14:51:58.007

```
sAttr = sAttr+VAL_TAG_OPEN+sVal->c_str()+VAL_TAG_CLOSE; 
```

就像 fbonnet 所说，这是一个评估问题的顺序。

如果该行被严格地从左到右评估，那么每次加法的结果是一个 std::string 对象，它有一个用于加法的运算符重载，并且事情会按您期望的那样工作。

如果它没有从左到右进行评估，那么您最终会将指针添加在一起，谁知道这会给您带来什么。

避免这种结构，只需在 std::string 上使用 += 运算符。

# cocoa-touch - 删除文档目录 iphone

> ID：540811
> 
> 赞同：0
> 
> 时间：2009-02-12T10:50:20.227
> 
> 标签：cocoa-touch

删除文档目录中内容的最快方法是什么。我有一个加载到 NSArray 中的内容列表，但我不确定如何安全删除的目标 c。我已经用谷歌搜索了一个解决方案，但似乎找不到任何东西。谢谢你的帮助。PS，你能推荐一本关于iphone编程初学者的好书吗托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T12:03:15.760

具体来说，您希望 NSFileManager 的`-(BOOL)removeItemAtPath:(NSString *)path error:(NSError **)error`这已记录在 SDK 中。

iPhone 编程书籍并不多，但我认为 Dave Mark 和 Jeff LaMarche 的《[开始 iPhone 开发：探索 iPhone SDK](https://rads.stackoverflow.com/amzn/click/com/1430216263)》是最好的介绍之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T11:23:37.540

NSFileManager 处理所有文件系统操作，包括文件删除。

# c# - 当只有一个成员的类型不同时，将子类视为其超类

> ID：540813
> 
> 赞同：2
> 
> 时间：2009-02-12T10:50:26.433
> 
> 标签：c#, .net, wcf

我有一个变量类和 3 个子类：VariableBool、VariableLong 和 VariableDouble。每个子类只定义一个后缀类型的值成员。

现在，我需要通过 WCF 传输基于这些类的对象。我有多个客户将他们的变量注册到服务器。每当一个客户端上的值发生变化时，它都会在所有其他客户端中更新。

我的问题是：有没有办法：

```
someVar.Value = anotherVar.Value; 
```

无论类型如何，都无需检查类型，例如：

```
VariableBool anotherVarBool = anotherVar as VariableBool;
if (anotherVarBool != null) {
  (someVar as VariableBool).Value = anotherVar.Value;
}
// check other types... 
```

我错过了什么？有没有某种模式？我可以使用反射吗？另外，我认为由于 WCF 的原因我不能使用泛型（我已经尝试过，但我可以让它工作）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:03:25.327

如果您使用的是 mex 生成的 WCF 代理，那么我怀疑反射（或 ComponentModel）确实是最简单的选项 - 例如：

```
public static void Copy<T>(T source, T destination,
    string propertyName) {
    PropertyInfo prop = typeof(T).GetProperty(propertyName);
    prop.SetValue(destination, prop.GetValue(source, null), null);
} 
```

或者，如果您想使用它，即使变量类型作为基类：

```
public static void Copy(object source, object destination,
    string propertyName) {
    PropertyInfo sourceProp = source.GetType().GetProperty(propertyName);
    PropertyInfo destProp = destination.GetType().GetProperty(propertyName);
    destProp.SetValue(destination, sourceProp.GetValue(source, null), null);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T11:05:38.927

为什么不将 Value 成员放在基类变量中。在这种情况下，

```
public void UpdateValue( Variable variable )
{
   if( variable != null )
      // do something with variable.Value
} 
```

但是，如果你真的想使用继承，你需要通过 KnownType 属性及其方法告诉基类什么是子类型

```
[DataContract()]
[KnownType( "GetKnownType" )]
public class Variable
{

 public object Value;

 private static Type[] GetKnownType()
 {
   // properties
   return new []{ typeof(VariableBool),
                  typeof(VariableLong), 
                  typeof(VariableDouble),};
 }
}

[DataContract()]
public class VariableBool : Variable
{
}

[DataContract()]
public class VariableLong : Variable
{
}

[DataContract()]
public class VariableDouble : Variable
{
} 
```

# c++ - 为三重指针分配内存

> ID：540822
> 
> 赞同：0
> 
> 时间：2009-02-12T10:54:38.297
> 
> 标签：c++, c, pointers

该函数`somefunction()`将三重指针作为参数。

```
int somefunction(tchar ***returnErrors); 
```

如何为`returnErrors`参数分配内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T11:12:10.843

*猜测一下。. .*

您可以将 returnErrors 视为指向字符串数组的指针。

1.  第一个 * 实现指向 tchar 数组（或单个 tchar 字符串）的指针
2.  第二个 * 实现了一个指向字符串数组的指针。
3.  最后一个 * 是这样您可以更改 returnErrors 并传回新内存。

为此取消内存（愚蠢的例子，在 SomeFunction 中分配内存）

```
tchar ** errors;
// Oops it appears I need to pass back two error strings (+ 1 for null on end, so we know there are no more - thanks tlholaday)
errors = malloc(sizeof(tchar*) * 3);

// the first string has length 20 (+ 1 for null terminator)
errors[0] = malloc(sizeof(tchar) * 21);

// the second string has length 30 (+ 1 for null terminator)
errors[1] = malloc(sizeof(tchar) * 31);

// ensure the last is null
errors[2] = 0;

*returnErrors = errors; 
```

**注意：调用函数需要知道 SomeFunction 已分配内存并需要释放它。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T11:23:08.557

您是在*实现*某个功能还是*调用*某个功能？

如果您正在调用 somefunction，则 somefunction 很可能会分配内存，因此您需要做的就是将其传递给一个安全的地方以便在之后进行涂鸦和清理。

```
tchar **theErrors = 0; // a vector of tchar vectors.
somefunction(&theErrors); 
if (theErrors) {
  // use the error values
  // free the memory somehow - this is for a null-terminated convention
      tchar **victim = theErrors;
      while (*victim) delete[](*victim++);
      delete[] theErrors;
} 
```

注意：我使用 0 和 delete[] 而不是 NULL 和 free 因为标签上写着 c++。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T11:03:19.913

这取决于“somefunction”的期望。你必须对此进行调查！

它可能需要一个指向固定大小的 2 维数组或 3 维常规数组的指针，或者 ???

在我提到的情况下，代码可能看起来像

```
tchar errors[SIZE1][SIZE2];
somefunction( &errors ); 
```

或者

```
tchar errors[SIZE1][SIZE2][SIZE3];
somefunction( errors ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T16:42:56.167

> 有谁知道如何为 returnErrors 参数分配内存？

这个问题太笼统了，不能在一般情况下回答。以下只是调用它的可能代码片段的示例。

```
tchar foo;
tchar * p_foo = &foo;
tchar ** pp_foo = &p_foo;
tchar *** ppp_foo = &pp_foo;
somefunction(ppp_foo); 
```

只是一个评论：我会认为你的函数签名不安全，因此即使它少了一颗星也是代码味道。

另外，请注意：

*   指针永远不是数组。它是一个包含内存地址值或 NULL 的变量。
*   指针包含的地址并不总是对应于数组的起始地址。int ** p 并不总是引用 int[][] 的起始地址。
*   值包含数组起始地址的指针不是将此数组作为函数参数传递的最佳方式。相反，可以使用对数组类型的引用。
*   数组通常不是在 C++ 中包含一组相关值的最佳方式。应考虑 std::vector 和其他 STL 容器。（但是你的问题有两种语言，C 和 C++，作为标签；当然这只适用于后一种可能性。为什么有两个标签？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T11:01:20.560

如果您还没有该类型的构造，则三重指针没有**任何意义。**我宁愿推荐使用一个类——或者至少是一个标准容器。但如果你必须知道，它很简单

```
tchar ***pointer = (tchar***) malloc(sizeof(tchar**) * amount); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T15:40:11.747

我会使用像你的 someFunction() 这样的函数有两个用例。

**对于初始化：**

```
{
    tchar **returnErrors;

    initErrors(tchar &returnErrors);
    /* now returnErrors has a place in memory*/
}

int initErrors(tchar ***returnErrors)
{
    *returnErrors = malloc(sizeof(tchar *) * SIZE1)

     for (i = 0; i < NUM_ELEMENTS; i++)
         (*returnErrors)[i] = malloc(sizeof(tchar) * SIZE2);

    /*add checks for malloc failures*/
} 
```

**数组传递给函数：**

```
{
    returnErrors[SIZE1][SIZE2][SIZE3];

    someFunciton(returnErrors);
}

int someFunciton(tchar ***returnErrors)
{
    /*assuming that this is a valid index*/
    tchar x = returnErrors[1][1][1]; 
    /*return errors is used as a triple array*/
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T17:04:35.817

我倾向于同意[tlholaday](https://stackoverflow.com/questions/540822/allocating-memory-for-triple-pointer/540892#540892)的猜测，修改函数可能返回它分配的错误数。

```
tchar **theErrors = 0; // a vector of tchar vectors.
int nErrors = somefunction(&theErrors); 
if (nErrors > 0) {
     for (int i = 0; i < nErrors; ++i)
     {
         printf(theErrors[i]);
         free(theErrors[i]);
     }
     free(theErrors);
} 
```

请注意，您是使用 free 还是 delete[] 将取决于首先如何分配内存。

# excel - SSIS Excel 数据源 - 是否可以覆盖列数据类型？

> ID：540823
> 
> 赞同：21
> 
> 时间：2009-02-12T10:55:10.900
> 
> 标签：excel, ssis

在 SSIS 中使用 excel 数据源时，每个单独列的数据类型都是从列中的数据派生的。是否可以覆盖此行为？

理想情况下，我们希望从 excel 源传递的每一列都是字符串数据类型，以便可以在数据流的后续步骤中对从源接收的数据执行数据验证。

目前，错误输出选项卡可用于忽略转换失败 - 相关数据为空，并且包将继续执行。但是，我们想知道原始数据是什么，以便可以为该行生成适当的错误消息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-08-13T17:19:11.997

根据[this blog post](http://blog.concentra.co.uk/2013/05/15/why-ssis-always-gets-excel-data-types-wrong-and-how-to-fix-it/)，问题在于SSIS Excel驱动程序根据前8行的读取值确定每列的数据类型：

> *   如果前 8 条记录包含相同数量的数字和字符类型 - 那么优先级是数字
> *   如果前 8 条记录中的大多数是数字，那么它将数据类型分配为数字，并且所有字符值都被读取为 NULL
> *   如果前 8 条记录中的大多数是字符类型，那么它将数据类型分配为字符串，并且所有数值都被读取为 NULL

该帖子概述了您可以采取的两件事来解决此问题：

1.  首先，添加`IMEX=1`到 Excel 驱动程序连接字符串的末尾。这将允许 Excel 以 Unicode 格式读取值。但是，如果前 8 行中的数据是数字，这还不够。
2.  在注册表中，将 的值更改为`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Nod\Microsoft\Jet\4.0\Engines\Excel\TypeGuessRows`0。这将确保驱动程序查看所有行以确定列的数据类型。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-12T11:08:03.397

是的你可以。只需进入 Excel 源上的输出列列表并设置每个列的类型。

要进入输入列列表，请右键单击 Excel 源，选择“显示高级编辑器”，单击标有“输入和输出属性”的选项卡。

一个可能更好的解决方案是使用派生列组件，您可以在其中为 Excel 中的每一列实际构建“新”列。这有以下好处

1.  您可以更好地控制要转换的内容。
2.  您可以输入控制更改的规则（即，如果 null 给我一个空字符串，但如果有数据则给我作为字符串的数据）
3.  您的数据源不直接绑定到流程的其余部分（即您可以更改源，您需要做的唯一工作是在派生列中）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-09-23T17:04:20.900

如果您的 Excel 文件在第一行数据的相关列中包含数字，则 SSIS 引擎似乎会将类型重置为数字类型。它一直在重置我的。我进入我的 Excel 文件并通过在它们前面放置一个单引号将数字更改为“存储为文本的数字”。它们现在被读取为文本。

我还注意到 SSIS 使用第一行来忽略程序员指出的数据的实际类型（我什至告诉 Excel 将整列格式化为 TEXT，但 SSIS 仍然使用数据，这是一堆数字） ，并重置它。一旦我通过在我的 Excel 文件中将单引号放在第一行数据中的数字前面来解决这个问题，我认为它会正确，但不，还有额外的工作。

事实上，即使 SSIS 外部数据源列现在具有 DT_WSTR 类型，它仍会将 43567192 读取为 4.35671E+007。因此，您必须返回 Excel 文件并在所有数字前面加上单引号。

相当蹩脚，微软！但是有你的解决方案。如果 Excel 文件不受您的控制，我不知道该怎么办。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-28T22:21:24.823

Excel 源代码是 SSIS 表现得很疯狂。SSIS通过读取前10行来确定特定列中的数据类型..因此问题。如果您的文本列在前 10 个 roes 中有空值，则 SSIS 将数据类型设为 Int。有点挣扎，这是一个解决方法

1.  在工作表中插入一个虚拟行（最好是第一行）。我更喜欢通过脚本任务执行此操作，您可以考虑在 SSIS 连接到文件之前使用一些服务来预处理文件

2.  使用虚拟行，您可以确定将根据需要设置数据类型

3.  使用 Excel 源读取数据并过滤掉虚拟行，然后再进行进一步处理。

我知道这有点破旧，但它有效:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-18T17:34:36.260

我正在寻找类似问题的解决方案，但在互联网上没有找到任何东西。尽管大多数找到的解决方案在设计时都可以工作，但当您想要自动化 SSIS 包时它们就不起作用了。

我解决了这个问题，并通过更改“Excel Source”的属性使其工作。默认情况下，该`AccessMode`属性设置为`OpenRowSet`。如果将其更改为`SQL Command`，则可以编写自己的 SQL 以根据需要转换任何列。

对我来说，SSIS 将该`NDCCode`列视为浮点数，但我需要它作为字符串，因此我使用了以下 SQL：

```
Select [Site], Cstr([NDCCode]) as NDCCode From [Sheet1$] 
```

[![在此处输入图像描述](https://i.stack.imgur.com/yBcTa.png)](https://i.stack.imgur.com/yBcTa.png)

[![在此处输入图像描述](https://i.stack.imgur.com/5RPMA.png)](https://i.stack.imgur.com/5RPMA.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-26T02:24:03.460

我可以解决这个问题。在创建 SSIS 包时，我手动将特定列更改为文本（打开 excel 文件选择列，右键单击列，选择格式单元格，在数字选项卡中选择文本并保存 excel）。现在创建 SSIS 包并对其进行测试。有用。现在尝试使用此列未设置为文本的 excel 文件。

它对我有用，我可以成功执行包。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-11T12:09:47.577

这应该很容易解决，只需取消选中“第一行作为列名”框，所有数据都将被收集为文本数据类型。这种选择的唯一缺点是您必须管理自动名称（列 1、2 等）中的列名称并处理包含列名称的第一行。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-01-14T02:50:02.223

我在这里实施解决方案时遇到了麻烦 - 我可以按照说明进行操作，但它只会给出新的错误。

我通过使用数据转换实体解决了我的转换问题。这可以在数据流转换下的 SSIS 工具箱中找到。我在我的 Excel 源和 OLE DB 目标之间放置了数据转换，将 Excel 链接到数据 C，将数据 C 链接到 OLE DB，双击数据 C 以显示数据列的列表。给问题列一个新的别名，并更改数据类型列。

最后，在 OLE DB 目标的映射中，使用别名列名，而不是原始 Excel 列名。任务完成。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-03-30T21:18:00.223

您可以使用数据转换组件转换为所需的数据类型。

# c# - MonoRail 重定向到 # 锚点

> ID：540830
> 
> 赞同：1
> 
> 时间：2009-02-12T10:57:31.863
> 
> 标签：c#, .net, jquery, castle-monorail

我正在使用带有[jQ​​uery 选项卡式导航的](http://docs.jquery.com/UI/Tabs)[Castle Monorail](http://www.castleproject.org/monorail/)。

在处理控制器操作时，我想重定向到一个视图，并控制哪个选项卡是可见的。因此，我想让我的控制器重定向到视图中的特定锚点，类似于：

```
RedirectToAction("Edit", "id=1", "#roles")); 
```

导致网址：

```
http://localhost/MyApp/User/edit.rails?id=1#roles 
```

但是，实际结果将**#**符号编码为**%23**

```
http://localhost/MyApp/User/edit.rails?id=1&%23roles=& 
```

我肯定在这里错过了一个基本概念。我需要做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T12:13:56.203

它不仅对“#”符号进行编码，它只是将其称为另一个查询字符串参数（添加“&”和“=”）

我建议您将此问题发布到[Castle Project 的用户组](http://groups.google.com/group/castle-project-users)，甚至在[Castle 的 issue tracker](http://support.castleproject.org/)上发布更好的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T12:44:29.943

不是最好的解决方案，但我使用了 RedirectToUrl() 并使用了静态 url。

另一种解决方案是使用路由引擎并自己创建 url，然后添加实际的哈希。

查看

RoutingModuleEx.Engine.CreateUrl()

或类似的东西。

# c# - 当 DataSource 是 ComboBox 上的数据绑定时，未引发 SelectedItem/Index/ValueChanged 事件

> ID：540832
> 
> 赞同：1
> 
> 时间：2009-02-12T10:57:55.637
> 
> 标签：c#, winforms, data-binding, combobox

我正在尝试实现以下内容：Winforms 表单上的两个组合框，第一个具有父类别列表，第二个是父类别的子项，子列表根据父项中的选择更改内容。

我正在尝试使用数据绑定正确执行此操作，但我发现 ComboBox 控件有一个奇怪的怪癖。

我手动设置了父级的数据源：

`cboParent.DataSource = ParentDataSource`ParentDataSource 在哪里`IList<ParentDTO>`。然后，我可以将 seletedItem 绑定到 DTO：

`cboParent.DataBindings.Add(new Binding("SelectedItem", bindingSource, "Parent", true, DataSourceUpdateMode.OnPropertyChanged));`绑定到我的总体 DTO 上`Parent`的对象。`ParentDTO`

到目前为止，一切都很标准。只要我在列表中选择任何新内容，这就会起作用并将更改写回我的 DTO 对象，太棒了！

然后，我将子组合框数据源绑定到总体 DTO 中的列表： `cboChild.DataBindings.Add(new Binding("DataSource", bindingSource, "Children", true, DataSourceUpdateMode.OnPropertyChanged));`其中 Children 是`IList<ChildDTO>`总体 DTO 上的一个。

这也可以正常工作，一旦我更改父选择，演示者就会更改`Children`DTO 上的列表，并且 cboChildren 中显示的值会发生变化，太棒了，我听到你哭了（我自己也哭了）！

不幸的是，如果您使用数据绑定在 ComboBox 上设置数据源，SelectedItemChanged、SelectedIndexChanged 和 SelectedValueChanged 事件似乎永远不会触发！这意味着 OnProperyChanged 数据绑定不适用于第二个组合框。OnValidation 确实有效，但对我来说似乎有点奇怪，我想知道是否有人以前遇到过这种情况，以及他们是否已经弄清楚如何让它发挥作用？

提前致谢

斯图

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T15:11:57.937

我派生了 ComboBox 有几个原因，例如支持绑定到空 DTO。这帮助我插入了这个功能来解决 Binding 没有更新的问题：

```
public new object SelectedItem
{
    get
    {
        return base.SelectedItem;
    }
    set
    {
        base.SelectedItem = value;
        if (value == null || value == System.DBNull.Value)
        {
            this.SelectedIndex = -1;
        }
        **foreach (Binding binding in DataBindings)
        {
            if (binding.PropertyName == "SelectedItem")
            {
                binding.WriteValue();
            }
        }**
    }
} 
```

如果属性名称是 SelectedValue 或 selectedIndex，您可能也希望这样做。

如果这对某人有帮助，请回帖！

最好的问候， Efy

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T20:46:24.537

还需要帮助吗？您需要为过滤器创建 bindingSources 和 aux 文本框，并使用方便的属性 bindingSource.filter

方法如下：

```
Dim ds As New DataSet
Dim bind1 As New BindingSource
Dim bind2 As New BindingSource

'' here I add data to the dataset.. you MUST do your own populate way
ds.Merge(GetProducts) ' returns a dataset filled with products
ds.Merge(GetCategories) ' returns a dataset filled with categories

'' after the ds has data

' create binds 
bind1.DataSource = ds
bind1.DataMember = "products"

' crete binds
bind2.DataSource = ds
bind2.DataMember = "categories"

txtMaster.DataSource = bind1
txtMaster.DisplayMember = "product_name"
txtMaster.ValueMember = "product_id"

txtDetails.DataSource = bind2
txtDetails.DisplayMember = "category_name"
txtDetails.ValueMember = "category_id"

txtAux.DataBindings.Add("Text", bind1, "product_id") ' bind1 contais products data
' this perform a filter on bind2... that contains categories data
Private Sub txtMaster_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtMaster.SelectedIndexChanged
    bind2.Filter = "product_id = '" & txtAux.Text & "'"
End Sub 
```

希望有帮助

# json - TXT->JSON 与 Yahoo! 管道

> ID：540841
> 
> 赞同：1
> 
> 时间：2009-02-12T11:02:57.403
> 
> 标签：json, yahoo-pipes

我在网上有一个 txt 文件，其结构如下：

```
"key1 value1
 key2 value2
 key3 value3
..." 
```

我可以使用雅虎！管道将其解析为 JSON？结束格式应该是这样的：

```
{key1 : value1, 
 key2 : value2, 
 key3 : value3, 
 ...} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T16:23:54.630

是的你可以。使用**Fetch CSV**和空格作为分隔符，通过一个带有**字符串生成器的****循环**来插入冒号和逗号，然后另一个**字符串生成器**插入大括号。但要注意最后一个逗号！

 ****无论如何，这是让你开始的一般想法......

# eclipse - SSL 重定向后使用 Eclipse 更新站点

> ID：540846
> 
> 赞同：1
> 
> 时间：2009-02-12T11:04:01.957
> 
> 标签：eclipse, ssl, clearcase, clearcase-remote-client

最近我设置了 ClearCase Remote Client（一个 Eclipse 插件）以通过 SSL 工作，所以它不是一个 http URL，而是一个 https URL。

但是，这会中断对更新站点的访问，返回一个错误，表明该站点存在“文件过早结束”错误。

我的问题是这个...

Eclipse 访问通过重定向规则到达的更新站点是否存在问题？

或者

通过 SSL 连接访问 Eclipse 更新站点是否有问题？

任何提示或轶事都会很棒！

**编辑**：链接通过浏览器工作，就重定向而言，但在我尝试通过更新站点工具访问同一目录时不在 Eclipse 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:18:54.010

对于其他插件来说，这似乎也是一个[已知问题](http://dev.eclipse.org/newslists/news.eclipse.newcomer/msg17592.html)

eclipse p2 配置中的“描述站点”是什么样的？它是否包括 https，如：

```
<description url="https://<host_name>/<update_site>/">
  Project Update Site
</description> 
```

* * *

请确定，您是否[启用了 HTTP 代理连接](http://dev.eclipse.org/newslists/news.eclipse.newcomer/msg20874.html)？

( `General->Network Connections`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T15:54:42.653

尽管 VonC 做出了非常英勇的努力，但我的答案或解决方法是配置 RWP 以将 SSL 用于 CCRC 服务器，并将简单的端口 80 用于更新站点，并为仍然指向旧 URL 的任何用户重定向。

我仍然不确定为什么它在带有 SSL 的 Eclipse 中不起作用。

# php - 优化 MySQL 搜索过程

> ID：540848
> 
> 赞同：0
> 
> 时间：2009-02-12T11:05:16.167
> 
> 标签：php, mysql, search, methods

这是**场景1。**

我有一个名为“items”的表，表内有 2 列，例如`item_id`和`item_name`。我以这种方式存储我的数据： item_id | 项目名称

```
Ss001   | Shirt1
Sb002   | Shirt2
Tb001   | TShirt1
Tm002   | TShirt2 
```

...等等，我以这种方式存储：第一个字母是衣服的代码，即 S 代表衬衫，T 代表 T 恤第二个字母是尺寸，即 s 代表小号，m 代表中号，b 代表大号让我们在我的项目表中说我有 10,000 件物品。我想做快速检索，假设我想找到一件特定的衬衫，我可以使用：

方法1：

```
SELECT * from items WHERE item_id LIKE Sb99; 
```

还是我应该这样做：

方法2：

```
SELECT * from items WHERE item_id LIKE S*; 
```

*存储结果，然后执行第二次搜索大小，然后第三次搜索id。就像哈希表的概念一样。我想要实现的是，而不是搜索所有数据，我想通过首先搜索衣服代码，然后是尺寸代码，然后是 id 代码来最小化搜索。就mysql中的速度而言，哪一个更好。从长远来看，哪一个更好。我想减少流量，不要经常打扰数据库。

感谢大家解决我的第一个场景。但是出现了另一种情况：

**场景二：**

我正在使用 PHP 和 MySQL。继续之前的故事。如果我的用户表结构是这样的：

```
user_id | username | items_collected

U0001   | Alex     | Ss001;Tm002
U0002   | Daniel   | Tb001;Sb002
U0003   | Michael  | ...
U0004   | Thomas   | ... 
```

我将 items_collected 存储为 id 形式，因为一天每个用户最多可以收集数百个项目，如果我存储为字符串，即 Shirt1，pants2，...，它将需要非常大量的数据库空间（想象一下，如果我们有 1000用户和一些项目名称很长）。

如果我以 id 形式存储会更容易维护吗？

如果可以说，我想显示图像，图像的名称是项目的名称 + jpg。怎么做？是这样的吗：

$result = 从 userid= $userid 的用户中选择 items_collected

使用 php 爆炸：

$itemsCollected = explode($result, ";");

之后，匹配 items 表中的每个项目，所以它会：

衬衫1，裤子2等

Den使用循环功能，循环每个值并添加“.jpg”以显示图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T11:28:05.067

第一种方法会更快 - 但 IMO 这不是正确的方法。我同意 tehvan 的观点。

我建议保持 item_id 不变，但添加两个额外字段，一个用于代码，一个用于大小，然后您可以执行以下操作：

```
select * from items where item_code = 'S' and item_size = 'm' 
```

使用索引，性能将大大提高，您将能够轻松匹配各种尺寸或代码。

```
select * from items where item_code = 'S' and item_size IN ('m','s') 
```

迁移数据库如下：

```
alter table items add column item_code varchar(1) default '';
alter table items add column item_size varchar(1) default '';

update items set item_code = SUBSTRING(item_id, 1, 1);
update items set item_size = SUBSTRING(item_id, 2, 1); 
```

对代码的更改应该同样易于添加。长期利益将是值得的努力。

* * *

对于场景 2 - 这不是从数据库存储和检索数据的有效方式。当以这种方式使用时，数据库仅充当存储引擎，通过将多个数据编码到字段中，您排除了数据库的关系部分有用。

在这种情况下你应该做的是有另一个表，称之为'items_collected'。架构将沿着

```
CREATE TABLE items_collected (
   id int(11) NOT NULL auto_increment KEY,
   userid int(11) NOT NULL,
   item_code varchar(10) NOT NULL,  
   FOREIGN KEY (`userid`) REFERENCES `user`(`id`),
   FOREIGN KEY (`itemcode`) REFERENCES `items`(`item_code`)
 ); 
```

外键确保存在[参照完整性，](http://en.wikipedia.org/wiki/Referential_integrity)[具有参照完整性](http://rapidapplicationdevelopment.blogspot.com/2007/07/referential-integrity-data-modeling.html)是必不可少的。

然后对于您提供的示例，您将有多个记录。

```
 user_id | username | items_collected
 U0001   | Alex     | Ss001
 U0001   | Alex     | Tm002
 U0002   | Daniel   | Sb002
 U0002   | Daniel   | Tb001
 U0003   | Michael  | ...
 U0004   | Thomas   | ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T11:13:01.437

第一个优化是将 id 分成三个不同的字段：一个用于类型，一个用于大小，一个用于当前 id 结尾（无论结尾是什么意思）如果您真的想保留当前结构，请立即获取结果（选项1）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T11:22:45.187

如果您想加快结果的速度，您应该将列拆分为多个列，每个属性一个列。

第 2 步是为每列创建一个索引。请记住，mysql 每次查询只使用每个表的一个索引。因此，如果您真的想要快速查询并且您的查询因这些属性而变化很大，那么您可能希望在 (type,size,ending)、(type,ending,size) 等上创建一个索引。

例如一个查询

```
select * from items where type = s and size = s and ending = 001 
```

可以从索引（类型、大小、结尾）中受益，但是：

```
select * from items where  size = s and ending = 001 
```

不能，因为索引只会按顺序使用，所以需要type，然后size，然后ending。这就是为什么如果您真的想要快速搜索，您可能需要多个索引。

另一个注意事项，通常在查询中使用 * 不是一个好主意，而是只选择您需要的列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T12:11:00.750

您需要为`model`、`size`和提供三列`id`，并以这种方式对它们进行索引：

```
CREATE INDEX ix_1 ON (model, size, id)
CREATE INDEX ix_2 ON (size, id)
CREATE INDEX ix_3 ON (id, model) 
```

然后，您将能够有效地搜索参数的任何子集：

*   `model-size-id`,查询将使用`model-size`;`model``ix_1`
*   `size-id`和`size`查询将使用`ix_2`；
*   `model-id`和`id`查询将使用`ix_3`

列上的索引现在相当于`ix_1`，您可以使用此索引有效地搜索适当的条件（`model-size-id`和`model-size`）`model`。

实际上，有一个特定的访问路径称为`INDEX SKIN SCAN`可用于搜索复合索引的非第一列，但`MySQL`不支持它AFAIK。

* * *

如果您需要坚持当前的设计，则需要对该字段进行索引并使用以下查询：

```
WHERE item_id LIKE @model || '%'
WHERE item_id LIKE @model || @size || '%'
WHERE item_id = @model || @size || @id 
```

如果有的话，所有这些查询都将使用索引。

不需要放入多个查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T09:55:52.870

我很高兴您将 item_id 设计为可通过“开始于”测试进行搜索。索引将为您快速解决这个问题。

我不知道 MySQL，但是在 MSSQL 中，在只有 S、M、L 选项的“大小”列上有一个索引很可能不会实现任何目标，不会使用索引，因为它包含的值是没有足够的选择性 - 即它更快地浏览所有数据，而不是“在索引中查找第一个 S 条目，现在检索该行的数据页......”

例外是查询被索引覆盖的地方 - 即 WHERE 子句的几个部分（实际上，所有这些部分以及 SELECT 列）都包含在索引中。然而，在这种情况下，索引中的第一个字段（在 MSSQL 中）需要具有选择性。因此，将具有最不同值的列放在索引中的第一位。

话虽如此，如果您的应用程序有尺寸、颜色等选项列表，您应该将这些数据属性放在记录中的单独列中 - 并在单独的表中列出所有可用的颜色和尺寸，然后您可以验证颜色/ 赋予产品的尺码实际上在颜色/尺码表中定义。减少垃圾进/垃圾出问题！

您的 item_selected 需要位于单独的表中，以便“标准化”。不要将分隔列表存储在单个列中，使用单独的行将其存储在单独的表中

因此，您的 USERS 表将包含 user_id 和用户名

您的新 items_collected 表将包含 user_id 和 item_id（可能还包含购买日期或发票编号）

然后你可以说“Alex 买了什么”（你的设计有那个）和“谁买了 Ss001”（在你的设计中，这需要遍历你的 USERS 表中的所有行并拆分 items_collected 以找到哪些行包含 Ss001 [1])

[1] 请注意，使用 LIKE 并不安全，因为您的 item_id 可能为“Ss001XXX”，它与 WHERE items_collected LIKE '%Ss001%' 匹配

# javascript - jQuery：将元素类型从隐藏更改为输入

> ID：540851
> 
> 赞同：32
> 
> 时间：2009-02-12T11:07:39.450
> 
> 标签：javascript, jquery, html, css

我有一个输入，它的类型设置为隐藏，我需要将它的类型更改为文本。似乎无法弄清楚这一点，或者是否可以使用 jQuery

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2010-06-16T22:57:09.957

使用 jQuery 1.4，您可以在输入分离时更改输入的类型。

```
marker = $('<span />').insertBefore('#myInput');
$('#myInput').detach().attr('type', 'text').insertAfter(marker);
marker.remove(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-12T11:11:55.493

我不确定这是可能的，所以我建议使用隐藏的 div 来包含输入元素，可以根据需要显示。即使隐藏，文本输入字段仍然可以保存数据。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-12T11:38:10.937

出于安全原因，IE 不允许您更改表单元素的类型，所以我会选择 Aram 的隐藏 div 建议。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-18T06:37:15.140

这是我将如何做到这一点：

```
$("input[type='hidden']").each(function(){
  var name = $(this).attr('name'); // grab name of original
  var value = $(this).attr('value'); // grab value of original
  /* create new visible input */
  var html = '<input type="text" name="'+name+'" value="'+value+'" />';
  $(this).after(html).remove(); // add new, then remove original input
}); 
```

如果要过滤某些元素，请在 each() 之前调用 filter()，如下所示：

```
$("input[type='hidden']").filter("[name='whatever']").each(function... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-23T10:01:07.210

容易相处的人...

```
$('input[type="hidden"]').each (function() { this.type = 'text'; }); 
```

在事件上触发它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-03T02:51:22.030

```
Overlay.toAnyType = function (c, type) {

    var shadow = jQuery(document.createElement(c.context.nodeName));

    // Clone attributes to new object.
    for (var i = 0; i < c[0].attributes.length; i++) {
        var attr = c[0].attributes[i].name;
        var val = c[0].attributes[i].value;

        if (attr == "type") val = type;
        shadow.attr(attr, val);
    }

    shadow.insertAfter(c);
    c.remove();
}; 
```

当 c 是 jQuery 对象时；上面的函数改变了类型属性。用法：

```
var inputElemt = jQuery("#input");
Overlay.toAnyType(inputElemt, "text"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-04T00:09:30.563

旧线程，但我最近需要做一些类似的事情，但使用文件字段并清除它们......我认为可以应用相同的解决方案，但至少你可以在这种情况下获取内容。

```
var temp = $('#hidden-field').val();
$("#container-for-field").html("<input id='not-hidden' type='text' value='"+temp+"'/>"); 
```

那也应该解决问题:)。

# oracle - 检测由 OCI OCIStmtExecute 调用更新的 ORACLE 行数

> ID：540856
> 
> 赞同：2
> 
> 时间：2009-02-12T11:09:07.857
> 
> 标签：oracle, oracle-call-interface

我有一个使用 OCIStmtExecute 函数调用的 ORACLE 更新语句。

使用 OCI 函数调用我想知道该操作已更新了多少行，例如零、一或更多。

我该怎么做呢 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T12:01:10.087

在属性类型设置为 OCI_ATTR_ROW_COUNT 的 OCIStmt 语句句柄上使用 OCIAttrGet 函数调用

因此，将以下代码添加到您的程序中：

```
 ub4 row_count;

   rc = OCIAttrGet ( stmthp, OCI_HTYPE_STMT, &row_count, 0, OCI_ATTR_ROW_COUNT,
           errhp ); 
```

在哪里：

`stmthp`是 OCIStmt 语句句柄

`errhp`是 OCIError 错误句柄

`rc`是定义的返回码（剑）

更新的行数（或删除和插入，如果这是您的操作）被写入传递的 row_count 变量

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T12:01:06.373

`OCIAttrGet(OCI_ATTR_ROW_COUNT)`在语句句柄上调用。

# asp.net - ASP.Net 状态服务的问题

> ID：540857
> 
> 赞同：3
> 
> 时间：2009-02-12T11:09:21.663
> 
> 标签：asp.net, session-state

我们有一个在网络场中运行的 ASP.Net 2.0 Web 应用程序，它使用 ASP.Net State 服务来存储会话。

我们一直在间歇性地遇到服务问题，并更改了一些内容，例如 machine.config 中的 machineKey。

我的实际问题是围绕状态服务服​​务的监控。我们在托管服务的服务器上运行了所有 4 个可用的性能计数器，但到目前为止我们还没有看到单个会话超时。我们还看到活跃会话的数量在一段时间内缓慢上升，但从未减少。

状态服务是否能识别会话何时超时？有什么我们应该手动做的吗？

**编辑：**我们已经放弃了状态服务并使用了 SQL 服务器会话。

为了回答下面的问题，似乎会​​话永远上升，直到服务崩溃，并且任何 oen 线程都链接到状态服务器是非常值得怀疑的。归根结底，这是一个相当基本的网络应用程序。

从我正在阅读的内容看来，其他许多人都经历过类似的事情，但是在任何飞来飞去的反应中似乎普遍缺乏常识和知识。

MS 似乎几乎没有关于这个主题的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:30:27.337

在 ASP.Net 会话超时可以在 web.config 和 machine.config 中配置。假设没有任何变化，默认超时为 20 分钟。machine.config 文件可以设置为不允许覆盖，这意味着 web.config 文件中指定的任何更改都不会覆盖这些设置。

您是否确保机器和 Web 配置文件中都有适当的设置？

假设默认设置，状态服务应在 20 分钟不活动后丢弃每个会话。

您的非活动会话在什么时候被丢弃？我认为它们不会呈指数增长，除非您重新启动服务以清除它们，否则它们必须在某个时候被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T05:12:04.927

根据我的经验，我们发现本机状态服务器甚至使用 SQL Server 进行会话是一个非常可怕的场景，因为两者都有问题。

我认为您可以为此探索其他产品以达到绝对最佳效果。一个免费的选项是[Velocity](http://msdn.microsoft.com/en-us/library/cc645013.aspx)，但它仍然没有发布。
另一个全面但经过验证的产品将是（实际上非​​常昂贵）[NCache](http://www.alachisoft.com/ncache/)

看看哪个最适合您。

关于 SQL Server，如果你有足够数量的点击进入，你的服务器很快就会死掉（我相信你已经有一些点击让你做 Web Farm 或者你只是为了冗余而这样做）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T06:29:01.750

您是否有某些东西可能会在您不知情的情况下触发会话并使其保持活力？是否有线程正在生成一些在后台工作并坚持您的会话的线程？就我的经验而言，超时设置在他的 web 配置文件中，从那里开始并不是魔法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T17:26:44.750

我相信这会被修改，但我不得不说。

如果您在使用状态服务器时遇到问题，那么您的 Web 应用程序中的某处可能存在错误。查尔斯上面的评论似乎是开始检查的好地方，但在某个地方存在生命周期问题。

返回代码并检查您的假设。拿一台新电脑，访问你的网站（创建一个会话），让它静置一个小时。如果您的会话仍然存在，则说明有问题。创建一个新的 Web 应用程序，它只有一个页面来报告当前会话的年龄，然后尝试同样的事情。您应该会发现一个小时后（默认为 20 分钟）会话不再有效。现在您有一个按预期工作的系统和一个没有按预期工作的系统，两者都使用相同的会话服务器，因此您可以排除问题，现在开始检查代码/配置，看看您可以在哪里保持活动（或防止超时）。

顺便说一下，这里是一个“有效的”会话配置。如果您没有这样的外观，您可能已经发现了您的问题：

```
<sessionState 
   mode="StateServer" 
   stateConnectionString="tcpip=10.1.1.1:55455" 
   cookieless="false" 
   timeout="20" /> 
```

还要确保你没有用你的 machine.config 覆盖你的 web.config 以获得更长的超时时间。

# c# - ListView 鼠标点击事件

> ID：540860
> 
> 赞同：3
> 
> 时间：2009-02-12T11:11:35.323
> 
> 标签：c#, listview

我有一个 ListView，如果右键单击某个项目，我想显示一个上下文菜单，如果单击发生在 ListView 控件中，则显示另一个。我遇到的问题是 MouseClick 事件仅在右键单击项目时触发，而不是控件。是什么原因造成的，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T11:47:13.647

使用 MouseUp 而不是 MouseClick！对于那个很抱歉。应该更努力地用谷歌搜索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T11:48:35.623

您可以将 ListView 子类化以添加右键单击事件：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Windows.Forms;

namespace MyCustomControls
{

public delegate void MyDelegate(Object sender, EventArgs e);

class MyListView : ListView
{

    private static readonly object EventRightClickRaised = new object();

    public MyListView() 
    {
        //RightClick += new MyDelegate(OnRightClick);
    }

    public event EventHandler RightClick
    {
        add
        {
            Events.AddHandler(EventRightClickRaised, value);
        }
        remove
        {
            Events.RemoveHandler(EventRightClickRaised, value);
        }
    }

    protected override void OnMouseUp(MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Right)
        {
            OnRightClick(EventArgs.Empty);
        }
        base.OnMouseUp(e);
    }

    protected void OnRightClick(EventArgs e)
    {
        EventHandler RightClickRaised = (EventHandler)Events[EventRightClickRaised];
        if (RightClickRaised != null)
        {
            RightClickRaised(this, e);
        }
    }

}
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-11-26T13:45:47.317

我有类似的问题（想捕捉右键单击控件），解决方案是使用 MouseEnter()。应该对您想做的事情有所帮助。

# php - 如何在 PHP 中禁用已编译的扩展

> ID：540871
> 
> 赞同：4
> 
> 时间：2009-02-12T11:14:44.800
> 
> 标签：php, soap, nusoap

我的家庭系统有一个用 SOAP 扩展编译的 PHP 版本。实时系统有一个没有 SOAP 扩展的 PHP 版本，并且大多数脚本都非常依赖 NuSOAP 库。NuSOAP 和 SOAP 扩展对它们的类​​使用相同的名称这一事实令人头疼。

如何在不重新安装/重新编译的情况下禁用家庭系统上的 SOAP 扩展？它是在 ini 文件中编译的，而不是由`extension`ini 文件中的指令启用的。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2009-02-12T11:43:08.553

它是一个扩展，所以你可以在`php.ini`. 只是评论这条线。记得之后重新启动 Apache。

我发现 nusoap 相当有问题，所以升级到本地肥皂应该是一个优先事项。如果这不能立即实现，那么切换到 是一个好主意[`nusoap-for-php5`](http://code.google.com/p/nusoap-for-php5/)，因为它允许您同时运行本机 soap 扩展和 nusoap。然后，您可以针对本机 soap 实现新代码，同时仍将 nusoap 用于遗留代码。

# c# - C# 和 Javascript 中的动态对象属性

> ID：540872
> 
> 赞同：1
> 
> 时间：2009-02-12T11:15:45.517
> 
> 标签：c#, json, dynamic-languages

我在数据库中有一个表，用于我的应用程序中的各种设置。可以随时添加或更改这些设置。我想将它们从数据库中提取到一个对象中，并在我的服务器代码（C#）和客户端代码（JS）中引用它们。

```
SettingGroup SettingName        type      value
Core         defaultPagingSize  numeric   5
Core         pagingType         text      dynamic
Ecommerce    showGallery        boolean   true 
```

在 javascript 中，我可以将它们放入 JSON 对象并像这样引用它们：

```
var size = settings.core.defaultPagingSize; 
```

有没有类似的方法可以在 C# 中做到这一点？

```
int size = settings.core.defaultPagingSize; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T11:23:21.240

不。

将为 .NET 和 C# 4.0 添加的新`dynamic`关键字将处理您正在寻找的内容，但在当前的 .NET 和 C# 版本中，不支持此功能。

你应该能够让它工作：

```
int size = settings["core"]["defaultPagingSize"].ToInt32(); 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T11:26:56.427

在 .NET 中，最直接的答案是使用某种字典（可能是嵌套的）。C# 4.0 引入了一些动态概念，但您需要编写相当多的代码才能使其表现得像 javascript。

或者，将它们作为类型化记录存储在平面列表中并使用 LINQ：

```
var setting = settings.Single(x=>x.Group == "Core"
         && x.Name == "defaultPagingSize");
int value = int.Parse(setting.Value); 
```

# ruby-on-rails - 是否有必要对 ActiveRecord 验证进行单元测试？

> ID：540873
> 
> 赞同：8
> 
> 时间：2009-02-12T11:16:09.417
> 
> 标签：ruby-on-rails, ruby, unit-testing, activerecord

是否有必要对 ActiveRecord 验证进行单元测试，或者它们已经经过充分测试并因此足够可靠？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-12T11:27:17.440

验证本身应该是可信赖的，但您可能需要检查验证是否存在。

换句话说，一个测试某事物的好方法是把它当作一个黑盒子，从实现中抽象出测试，例如，你可能有一个测试来检查一个人模型没有名字就不能保存，但不要关心 Person 类如何执行该验证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T12:52:17.593

接受开发人员对 ActiveRecord 之类的库的测试比您对它们进行更好的测试就足够了：对他们来说，这是一个主要关注点，对您来说，它充其量只是切题。

这并不是说不会有错误——很久以前我发现了一个小的 MS SQL Server 适配器——但是你可能要实施的那种测试不太可能暴露它们，因为它们是最常见的可能是边缘情况。如果你*确实*发现了一个错误，当然，如果你用一个暴露它的测试用例报告它可能会非常有帮助！

如果我想更好地理解库实现的特定方面，我只会测试 ActiveRecord 内部。我不会在任何应用程序项目中包含这些探索性测试，因为它们与项目并不真正相关。

通常，您应该为自己编写的代码编写测试：如果您生活或尝试生活在 TDD 世界中，则应该先编写测试。如果您的模型具有验证规则，那么您几乎肯定应该编写测试以确保存在规则。在大多数情况下，测试将是微不足道的，但如果将来某个时间无意中删除了一行，它们将非常有用......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T14:37:31.600

正如 Mike 所写，至少您应该测试验证是否存在。这只是一个很容易做到的复式记账（健全性检查）。

根据情况，您还应该测试您的模型在特定情况下是有效还是无效。例如，如果您的字段需要某种格式，则测试有效的示例格式和无效的示例格式。通过阅读测试中的一些示例，可以更容易地了解这意味着什么：

```
class Person < ActiveRecord::Base
  validates_format_of :email,
      :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i
end 
```

是的，验证已经过充分测试并且足够可靠。但是您对验证的正确使用是您想要验证的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-29T23:26:31.010

附带说明一下，Ryan Bigg 的博[文 has_and_belongs_to_many double insert](http://ryanbigg.com/2010/04/has_and_belongs_to_many-double-insert/)提到有人在 ActiveRecord 中遇到错误（但与验证无关）。正如他所指出的，不要假设 Rails 不可能有错误，因为我们知道 Rails 有 900 张未结票。

但是，是的，您编写测试的主要原因是检查您对 ActiveRecord 的使用是否正确。

# php - 对 PHP 中的递归 stripslashes 方法进行故障排除

> ID：540874
> 
> 赞同：1
> 
> 时间：2009-02-12T11:16:59.163
> 
> 标签：php

我正在尝试使用 PHP 文档中的 stripslashes_deep 函数作为一种方法，但是当我将它传递给一个数组时，它就不起作用了。但是，它确实适用于字符串。谁能指出为什么它可能不起作用？魔术引号是打开的，因为我正在测试这种可能性，但就像我说的，它适用于字符串，我也没有测试 $_POST 或 $_GET 数据。这是代码：

```
protected function stripslashes_deep($input){
    return is_array($input) ? array_map($this->stripslashes_deep, $input) : stripslashes($input);
} 
```

字符串 'O\'Reilly' 被转换为 'O'Reilly'，但下面的数组保持不变：

Array ( [0] => Array ( [userId] => 23 [0] => 23 [username] => O\'Reilly [1] => O\'Reilly [userFirstName] => Bill [2] =>比尔 [userLastName] => O\'Reilly [3] => O\'Reilly ) )

任何帮助将不胜感激。

编辑：

该数组来自数据库并带有斜杠，因为它是由 PDO 对象使用绑定参数插入的。我扩展了 PDO，并尝试在获取数组时自动去除斜杠，这样我就不必每次输出数据时都调用 stripslashes。如果有人知道更好的方法来做到这一点，我绝对愿意接受建议。我没有看到任何类型的 PDO 取消引用方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T11:37:32.593

```
array_map($this->stripslashes_deep, $input) : stripslashes($input); 
```

应该：

```
array_map(array($this, 'stripslashes_deep'), $input) : stripslashes($input); 
```

如果您打算撤消魔术引号，则不应该递归地实现它，因为它存在一些性能和安全问题。见：[http ://talks.php.net/show/php-best-practices/26](http://talks.php.net/show/php-best-practices/26)

# ubuntu - libstdc++.a 丢失

> ID：540875
> 
> 赞同：1
> 
> 时间：2009-02-12T11:17:06.793
> 
> 标签：ubuntu, makefile

我正在使用 Ubuntu 8.04 / 32 位（作为虚拟机）。在一个不是 min 的项目上执行一些 make 时，我得到了错误：

g++: /usr/lib/libstdc++.a: 没有这样的文件或目录

我该怎么办？gcc 包是通过突触安装的，我想念什么？

谢谢，卢锡安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T11:19:34.493

对于 Ubuntu 8.04（又名 hardy），您需要安装 libstdc++6-4.2-dbg 软件包。

```
$ sudo aptitude install libstdc++6-4.2-dbg 
```

如果您将来需要查找此类文件，请安装 apt-file（如果尚未安装）并使用 apt-file 搜索。

```
$ sudo aptitude install apt-file
...
$ sudo apt-file search /usr/lib/libstdc++.a 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T10:23:37.007

正如库名称中的“++”所暗示的那样，您似乎正在使用 C++ 进行开发。在这种情况下，您还需要安装 g++，猜测这将安装所需的库等。

要一步安装 gcc、g++ 和其他实用程序（如 make），您可以安装 build-essential 元包。

您可能还会发现这些软件包很有用，因为它们安装了相关文档：glibc-doc manpages-dev gcc-4.2-doc libstdc++6-4.2-doc

# c# - 从此 MatchEvaluator 中删除静态 int

> ID：540876
> 
> 赞同：0
> 
> 时间：2009-02-12T11:17:16.400
> 
> 标签：c#

我正在尝试将专有字符串掩码转换为 .net 等效项。为此，我需要用 {aDigit} 交换每次出现的 [someText]。

```
private static int hits = 0;
private static object hitsLock = new object();

public static string ConvertSdsFileMaskToStringMask(string sdsFileMaskString) {
    Regex bracketsExpression = new Regex(@"\[[^[]*]");
    lock (hitsLock)
    {
        hits = 0;
        return bracketsExpression.Replace(sdsFileMaskString, ReplaceSquareWithAngularBrackets);
    }
}
private static string ReplaceSquareWithAngularBrackets(Match m) {
    string result = String.Format("{{{0}}}", hits.ToString());
    hits++;
    return result;
} 
```

有用。但是这两个表达式都需要知道彼此的工作原理，并且取决于命中计数器。我觉得这可以改进。理想情况下，两者互不依赖。有什么建议么？这可能会做得更好。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:20:57.237

是 - 使用匿名方法或 lambda 表达式：

```
public static string ConvertSdsFileMaskToStringMask(string sdsFileMaskString) 
{
    Regex bracketsExpression = new Regex(@"\[[^[]*]");
    int hits = 0;
    return bracketsExpression.Replace(sdsFileMaskString, match => 
    {
        string result = String.Format("{{{0}}}", hits.ToString());
        hits++;
        return result;    
    });
} 
```

这将以新的（编译器生成的）类型捕获*局部*变量，摆脱“全局性”。

*如果*您对副作用感到满意，也可以使 lambda 表达式更简单。在这种情况下，我也会摆脱对 String.Format 的调用，因为所有这些大括号都令人困惑：

```
public static string ConvertSdsFileMaskToStringMask(string sdsFileMaskString) 
{
    Regex bracketsExpression = new Regex(@"\[[^[]*]");
    int hits = 0;
    return bracketsExpression.Replace(sdsFileMaskString, 
        match => "{" + (hits++) + "}");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T11:24:03.983

通过使用 lambda 和局部变量 hits，C# 将创建一个闭包：

```
public static string ConvertSdsFileMaskToStringMask(string sdsFileMaskString)
{
   Regex bracketsExpression = new Regex(@"\[[^[]*]");
   int hits = 0;
   return bracketsExpression.Replace(sdsFileMaskString, 
       m => string.Format("{{{0}}}", hits++));
} 
```

就足够了

hits 变量封装在 lambda 闭包中，将在所有 lambda 调用中重用，但对于多个 ConvertSdsFileMaskToStringMask 调用来说是不同的。

# sql - 哪些 mysql 数据库表和关系将支持带有条件问题的问答调查？

> ID：540885
> 
> 赞同：45
> 
> 时间：2009-02-12T11:19:15.400
> 
> 标签：sql, database-design, database-schema, erd, data-modeling

我现在正在开发一个相当简单的调查系统。数据库模式将很简单：一个`Survey`表，与`Question`表处于一对多关系，与`Answer`表和与`PossibleAnswers`表处于一对多关系。

最近，客户意识到她希望能够仅向对之前的问题给出特定答案的人显示某些问题（例如，*你买香烟吗？*后面会跟着*你最喜欢的香烟品牌是什么？*，没有必要再问第二个）向非吸烟者提问）。

现在我开始想知道根据我的数据库模式实现这个*条件问题的最佳方法是什么？*如果`question A`有 2 个可能的答案：A 和 B，并且**只有**在答案是?`question B`时才应该向用户显示？**`A`**

 **编辑：我正在寻找一种将有关需求的信息存储在数据库中的方法。数据的处理可能会在应用程序端完成，因为我的 SQL 技能很烂；）

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2011-05-02T14:53:42.553

> # 调查数据库设计

最后更新：2015 年 5 月 3 日
图表和 SQL 文件现已在[https://github.com/durrantm/survey提供](https://github.com/durrantm/survey)

![在此处输入图像描述](https://i.stack.imgur.com/BO7b9.png)

**如果您使用此（顶部）答案或任何元素，请添加有关改进的反馈！！！**

这是一部真正的经典，由成千上万人完成。他们总是看起来“相当简单”，但实际上它非常复杂。要在 Rails 中执行此操作，我将使用附图中显示的模型。我敢肯定，这对某些人来说似乎过于复杂，但是一旦你构建了其中的一些，多年来，你就会意识到大多数设计决策都是非常经典的模式，最好通过动态灵活的数据结构来解决一开始。
更多详情如下：

> # 关键表的表详细信息

## 答案

**答案**表至关重要，因为它捕获了用户的实际响应。您会注意到 answer 链接到**question_options**，而不是**questions**。这是故意的。

## 输入类型

**input_types**是问题的类型。每个问题只能是 1 种类型，例如所有无线电拨号、所有文本字段等。当有（例如）5 个无线电拨号和 1 个“包括？”复选框时使用附加问题。选项或一些这样的组合。将用户视图中的两个问题标记为一个，但内部有两个问题，一个用于无线电拨号，一个用于复选框。在这种情况下，复选框将包含一组 1。

## 选项组

**option_groups**和**option_choices**可让您构建“通用”组。例如，在房地产应用程序中，可能会出现“房产有多旧？”的问题。答案可能在以下范围内：1-5 6-10 10-25 25-100 100+

然后，例如，如果有关于相邻财产年龄的问题，那么调查将希望“重用”上述范围，以便使用相同的 option_group 和 options。

## units_of_measure

**units_of_measure**就像听起来一样。无论是英寸、杯子、像素、砖块还是其他任何东西，您都可以在这里定义一次。

仅供参考：虽然本质上是通用的，但可以在此基础上创建应用程序，并且此模式非常适合**Ruby On Rails**框架，其中每个表的主键都具有诸如“id”之类的约定。此外，这些关系都是简单的 one_to_many，不需要 many_to_many 或 has_many throughs。我可能会添加 has_many :throughs 和/或 :delegates ，以便在没有.multiple.chaining 的情况下轻松地从单个答案中获取survey_name 之类的内容。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-14T00:35:36.210

您还可以考虑复杂的规则，并在您的问题表中有一个基于字符串的条件字段，接受/解析其中任何一个：

*   A(1)=3
*   ( (A(1)=3) 和 (A(2)=4) )
*   A(3)>2
*   (A(3)=1) 和 (A(17)!=2) 和 C(1)

其中 A(x)=y 表示“问题 x 的答案是 y”，C(x) 表示问题 x 的条件（默认为真）...

这些问题有一个顺序字段，您将一个一个地检查它们，跳过条件为 FALSE 的问题。

这应该允许您进行任何复杂性的调查，您的 GUI 可以在“简单模式”下自动创建这些调查，并允许用户可以直接输入方程式的“高级模式”。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-12T11:29:13.597

一种方法是添加带有字段的表“问题要求”：

*   question_id（链接到“哪个品牌？”问题）
*   required_question_id（链接到“你吸烟吗？”问题）
*   required_answer_id（指向“是”答案的链接）

在应用程序中，您在提出某个问题之前检查此表。使用单独的表格，很容易添加所需的答案（为“有时”答案添加另一行等......）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-12T11:36:12.910

就个人而言，在这种情况下，我会使用您描述的结构并将数据库用作哑存储机制。我喜欢将这些复杂且依赖的约束放入应用程序层。

我认为在不为每个问题与他人的外键构建新表的情况下强制执行这些约束的唯一方法是使用 T-SQL 的东西或其他供应商特定的机制来构建数据库触发器来强制执行这些约束。

在应用程序级别，您有更多的可能性，并且更容易移植，所以我更喜欢这个选项。

我希望这将帮助您为您的应用找到策略。

# sql-server - 如何使用差异备份移动数据库？

> ID：540889
> 
> 赞同：1
> 
> 时间：2009-02-12T11:22:00.960
> 
> 标签：sql-server, sql-server-2005, backup

我正在使用 SQL Server 2005。

我需要以最少的停机时间将数据库移动到新服务器。

目前我的选择是将所有内容脱机，执行备份，将备份复制到新服务器，恢复备份并将所有内容重新联机。

这里的问题是备份文件大约 10Gb，因此，执行整个操作大约需要 5-10 分钟。

我听说有人对在线上的所有内容执行完整备份，然后进行差异备份，这样可以复制的内容更少。

我已经进行了完整备份，将其复制到新服务器并恢复了它。然后我进行了差异备份并将其复制到新服务器。

问题是，当我尝试恢复此备份时，我收到消息“无法恢复日志或差异备份，因为没有文件准备好前滚。”

我也尝试过同时选择完整备份和差异备份，但随后出现错误“设备 'D:\FullBackup.bak' 上的卷不是多系列媒体集的一部分。带格式的备份可用于形成新的媒体集。”

有谁知道我做错了什么以及最简单的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T11:48:10.603

看来您没有将`NORECOVERY`选项设置为 full `RESTORE`。

您需要此选项以保持所有事务不变，以便稍后应用差异备份。

如果您不设置它，未提交的事务将在恢复完整备份时回滚，并且`LSN`数据库的最后一个变得大于`LSN`差异备份的第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T12:12:29.500

另一种快速的方法是分离数据库，然后将数据库的底层 .mdf 和 .ldf 文件直接复制到数据库，然后重新连接。复制一个 10GB 文件所花费的时间将比备份少得多，而且它达到了同样的效果。

# c# - 如何在 c# 中以编程方式确定一个类型是否接受空值？

> ID：540895
> 
> 赞同：2
> 
> 时间：2009-02-12T11:23:23.220
> 
> 标签：c#, .net, nullable

我知道仅仅检查类型是否不是值类型是不够的。我如何解释那些可以为空的？

**复制**

[如何检查一个对象是否可以为空？](https://stackoverflow.com/questions/374651/how-to-check-if-an-object-is-nullable)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T11:27:32.773

您可以使用 Nullable.GetUnderlyingType，如果类型不可为空，它将返回 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T11:38:28.113

您是否尝试过关键字[default(YourType)](http://msdn.microsoft.com/en-us/library/xwth0h0d(VS.80).aspx)？

> T 是引用类型还是值类型。
> 
> 如果 T 是值类型，无论是数值还是结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T11:42:01.037

这也有效：

```
 bool nullable = yourType.IsGenericType && yourType.GetGenericTypeDefinition().Equals(typeof(Nullable<>)) 
```

# xml - 是否有 *simple* 方法来使用 XML::Simple 提取深度嵌套的值？

> ID：540897
> 
> 赞同：4
> 
> 时间：2009-02-12T11:23:46.200
> 
> 标签：xml, perl

我正在使用 Perl 的[XML::Simple](http://search.cpan.org/perldoc?XML::Simple)来解析深度嵌套的 XML，并希望提取大约 4 级以下的一小部分元素：

```
A
  B
    C 
      D1
      D2
      D3 
```

理想情况下，如果可能的话，我想在输入步骤中执行此操作。像这样：

```
my @list = XMLin($xml, { SomeAttribute => 'ButWhat?' }); 
```

最终得到和我一样的结果：

```
@list = ('D1', 'D2', 'D3') 
```

有可能吗？或者只是不那么“简单”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T12:31:06.100

假设您在内存中的数据如下所示：

```
my $parsed = {
    A => {
        B => {
            C => [ qw/here is your list/ ],
        },
    },
}; 
```

然后你可以得到你的清单`my @list = @{ $parsed->{A}{B}{C} }`。

这是你想要做的吗？

编辑：考虑到一些评论，也许你想要 [Data::Visitor::Callback](http://search.cpan.org/perldoc?Data::Visitor::Callback)。然后，您可以提取所有数组，例如：

```
my @arrays;
my $v = Data::Visitor::Callback->new(
    array => sub { push @arrays, $_ },
);
$v->visit( $parsed_xml ); 
```

运行后，\@arrays 将是对任意深度嵌套数组的引用列表。

最后，如果您只有一个属性名称并且想要搜索匹配的 XML 节点，那么您真的需要 XPath：

```
use XML::LibXML;
my $parser = XML::LibXML->new;
my $doc = $parser->parse_string( $xml_string );

# yeah, I am naming the variable data.  so there.
my @data = map { $_->textContent } $doc->findnodes('//p[@id="foo"]'); 
```

无论如何，TMTOWTDI。如果您正在使用 XML，并且想做一些复杂的事情，那么 XML::Simple 很少是正确的答案。我对一切都使用 XML::LibXML，因为它几乎总是更容易。

还有一件事，您可能需要 [Data::DPath](http://search.cpan.org/perldoc?Data::DPath)。它允许您“XPath”内存中的 perl 数据结构：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:09:55.637

基于[Jon 的回答](https://stackoverflow.com/a/541046/8817)，这是我需要做这类事情时使用的基本代码。如果我需要更高级的东西，我通常会在允许的情况下使用模块。

诀窍`get_values`从顶级引用开始，获取下一个较低级别，并将其放入同一个变量中。它一直持续到我到达我想去的地方。大多数代码只是断言，以确保事情正常进行。在大多数情况下，我发现是数据搞砸了，而不是遍历（但我做了很多数据清理工作）。根据您的情况调整错误检查。

```
使用鲤鱼 qw(croak);

我的 $parsed = {
  一个 => {
    B => {
      C => [qw/这里是你的清单/],
      D => {
        E => [ qw/这是一个更深的列表/ ]，
        },
    },
  },
};

我的@keys = qw(ABCD);

我的 @values = eval { get_values( $parsed, @keys ) } 要么死；

$" = " ][ ";
print "值是 [ @values ]\n";

子 get_values
    {
    我的（$哈希，@keys）=@_；

    我的 $v = $hash; # 开始参考

    foreach 我的 $key ( @keys )
        {
        croak "值不是哈希引用 [at $key!]\n" 除非 ref $v eq ref {};
        croak "密钥 $key 不存在！\n" 除非存在 $v->{$key};
        $v = $v->{$key}; # 用 ref 替换下一级
        }

    呱呱“值不是数组引用！” 除非参考 $v eq 参考 [];
    @$v;
    }

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T16:07:19.857

您使用 XML::Simple 的事实无关紧要。您正在尝试搜索 has refs 和 array refs 的结构。你知道你在寻找什么吗？它会一直在同一个地方吗？如果是这样，那么像 jrockway 写的东西会很容易做到这一点。如果没有，那么你需要走遍结构的每一块，直到找到你要找的东西。

我经常做的一件事是转储 XML::Simple 使用[Data::Dumper](http://search.cpan.org/dist/Data-Dumper)返回的结构，看看它是什么样子（如果它总是“看起来”一样；如果不是，你可以动态确定如何走它通过测试是某事是一个参考，它是什么类型的参考）。真正的问题是：你在寻找什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T17:22:43.310

[Data::Diver](http://search.cpan.org/dist/Data-Diver/)为挖掘深层结构提供了一个很好的接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T09:32:42.107

感谢所有的建议。

最后，我通过使用 eval 块回避了遍历数据结构的问题。

```
my $xml_tree;
my @list;

eval {

   # just go for it
   my @list = @{ $xml_tree->{A}->{B}->{C} };

};

if ($@) {
   say "oops - xml is not in expected format - and that happens sometimes";
} 
```

# wpf - 使用 CollectionViewSources 进行多级分组

> ID：540900
> 
> 赞同：0
> 
> 时间：2009-02-12T11:24:01.347
> 
> 标签：wpf, data-binding, treeview

对 a 进行数据绑定时`TreeView`，您将如何为显示的项目创建多个级别的分组？

想象一下，您正在绑定到一个 Shop 类，其中包括属性`Region`和`RetailChain`. 期望的效果是有一个`TreeView`以以下拓扑显示商店的：

```
+ Region: California
|  + Walmart
|    + Walmart Pacific Beach
|    + Walmart Orange County
|    + Walmart San Diego
+ Region: New Jersey
   + Frys
   | + Frys Electronics NJ
   + Walmart
     + Walmart New Jersey 
```

关键是：`Region`s 与 s 无关`Retailer`，反之亦然，因此`Shop`（叶节点）是唯一的共同点。

Using`CollectionViewSource`仅允许单级分组（尽管`CollectionView`该类具有建议多级分组的属性）。

使用`HierarchicalDataTemplate`唯一适用于自上而下的拓扑，这种情况不适合。

关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T07:23:26.330

我的问题的答案原来是这样的：

将多个分组（通过 PropertyGroupDescriptor）添加到 CollectionViewSource，然后使用具有多个 GroupStyles 的 ListBox / DataGrid。这样做的净效果是叶子项目（在我的示例中，商店）被分组在两个不同的级别。

切换哪个 PropertyGroupDescriptor 首先出现在 CollectionViewSource 中将更改哪个属性是结果树中的“根”级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T12:34:24.093

您始终可以编写代码来预处理数据并创建一组类以便于绑定。

# actionscript-3 - TextField() - 使用事件监听器过滤退格键

> ID：540904
> 
> 赞同：2
> 
> 时间：2009-02-12T11:24:39.880
> 
> 标签：actionscript-3, apache-flex, flex3

如何防止特定键（例如退格键）在 TextField 可编辑字段中起作用，preventDefault 似乎不起作用：

```
public function handleEvents(evt:KeyboardEvent):void {
 if (evt.type == KeyboardEvent.KEY_UP) {
 if (evt.keyCode==8){
   evt.preventDefault () ;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T14:04:43.190

如果有的话，我建议监听 KEY_DOWN 事件，但很可能这也不起作用。IIRC 这些类型的事件有点特别，你无法真正阻止它们。我怀疑您需要做的是存储文本的副本，并且每当您检测到不喜欢的更改时，只需将其设置回存储的版本即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-12T07:22:45.497

我所做的是将焦点设置到另一个临时（和舞台外）文本字段，并在我的 keydown 处理程序中将焦点返回到我想要通过的键的文本字段。仅为要过滤掉的键设置焦点也可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T12:07:25.877

尝试添加 evt.stopImmediatePropagation()

# scala - Scala远程演员

> ID：540906
> 
> 赞同：17
> 
> 时间：2009-02-12T11:25:34.667
> 
> 标签：scala, actor

是否有任何指南或教程可以解释远程使用 scala 演员的可能性？到目前为止，我发现的只是一个例子（没有评论），但这还不够。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-19T18:27:21.867

不久前，我写[了一篇带有示例应用程序的文章来解释 Remote Actors 的使用。](http://dirkmeister.blogspot.com/2008/12/remote-actors-in-scala.html)

好吧，它在代码中没有注释（也许您甚至指的是那篇文章），但是代码下方有解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T12:38:18.897

请注意发送可序列化的消息（案例类和案例对象都是！）并确保对方可以创建类。注意类路径中的自定义类加载器或缺少的 JAR。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T16:45:20.030

我都不知道。这几乎是一种“穿越丛林”的方法。不过，从 API 来看，事情应该与常规演员的工作方式几乎相同，其中存在一两个教程（以及现在的几本书）。

如果您确实使用了远程演员，我们（社区）当然会欢迎有经验的用户提供这样的教程！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-21T19:04:14.603

Akka 框架具有[远程参与者](http://doc.akkasource.org/remote-actors)。API 与常规的 scala 演员非常相似。

它们也提供了某种程度的自动聚类，但它并不完整。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-02T09:58:00.070

最近在 www.scala-lang.org 的首页添加了一个指南，这里是链接 [http://www.scala-lang.org/docu/files/actors-api/actors_api_guide.html#](http://www.scala-lang.org/docu/files/actors-api/actors_api_guide.html#)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-20T22:03:47.280

也许这是一个 necropost，但我一直在寻找，但找不到太多。希望这会对某人有所帮助。

我正在运行**Mac OS 10.6.8**和**Scala 2.9.0.1**。我在运行规范的远程参与者示例时遇到了问题。我最终得到了以下代码。

**注意：**清除*方法*只是为了防止消息堆积。这对示例并不重要。*同样，对Thread.sleep*的调用只是为了更容易查看运行时发生的情况。

编译它，然后在单独的 shell 实例中执行：

```
$> scala Ping 
```

和

```
$> scala Pong 
```

以任何顺序。您可以通过一次杀死其中一个并跟踪代码来进行实验。

```
import scala.actors._
import scala.actors.Actor._
import scala.actors.remote._
import scala.actors.remote.RemoteActor._

/** @author Connor Doyle */

// Remote messages must be serializable.
// The easist way to do this is to wrap
// them with a case class
case class Message(text: String)

abstract class PingPongActor extends Actor with App {
    val pingPort = 9000
    val pongPort = 9001
    val delay = 1000
    classLoader = getClass().getClassLoader() // hack!
    start

    // this method consumes all pending messages
    // the library should have implemented an atomic 
    // receiveAndClear operation
    def clear: Unit = receiveWithin(0) {
        case TIMEOUT => ()
        case _ => clear
    }
}

object Ping extends PingPongActor {

    // result of select already lazy, but explicit lazy conveys
    // semantics clearly
    lazy val pong = select(Node("localhost", pongPort), 'pong)

    def act = {
        alive(pingPort)
        register('ping, self)
        loop {
            pong ! Message("ping")
            receiveWithin(delay * 2) {
                case Message(text: String) => {
                    clear
                    println("received: "+text)
                    Thread.sleep(delay) // wait a while
                }
                case TIMEOUT => println("ping: timed out!")
            }
        }
    }
}

object Pong extends PingPongActor {

    lazy val ping = select(Node("localhost", pingPort), 'ping)

    def act = {
        alive(pongPort)
        register('pong, self)
        loop {
            receiveWithin(delay * 2) {
                case Message(text: String) => {
                    println("received: "+text)
                    Thread.sleep(delay) // wait a while
                    clear
                    ping ! Message("pong")
                }
                case TIMEOUT => println("pong: timed out")
            }
        }
    }
} 
```

干杯!

# perl - 如何判断我是否在 VMWARE 虚拟机（来自 linux）中运行？

> ID：540907
> 
> 赞同：10
> 
> 时间：2009-02-12T11:25:49.547
> 
> 标签：perl, vmware, redhat, esx

我有一个 VMWARE ESX 服务器。我在那台服务器上运行着 Redhat 虚拟机。如果我在虚拟机中运行，我需要一种以编程方式进行测试的方法。理想情况下，我想知道如何从 Perl 中做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T11:53:58.793

[请参阅“从应用程序检测虚拟化操作系统？](https://stackoverflow.com/questions/154163/detect-virtualized-os-from-an-application) ”的答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T13:06:38.447

您不应该 100% 依赖任何方法，因为它们是未记录的功能/错误 - 它们适用于某些主机操作系统和某些虚拟化解决方案，但不能保证它们会继续工作；事实上，虚拟化的全部意义在于尽可能地与真实金属没有区别。考虑到这一点，[蓝色药丸红色药丸（在](http://www.invisiblethings.org/papers/redpill.html)[这个类似问题](https://stackoverflow.com/questions/154163/detect-virtualized-os-from-an-application)的公认答案中提到）似乎工作......现在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T11:55:07.323

VMWare 有几个 SDK，包括一个[用于 Perl 的 SDK](http://vmware.com/download/sdk/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T12:48:47.413

我认为（取决于 esx 的版本）您可以检查 NIC 的 MAC 地址。在 VMWare NIC 中运行的 VM 将具有分配给 VMWare 的制造商字符串，而不是物理 NIC MAC。（我们试图将 MAC 欺骗到许可服务器的 VM 上，而较新的版本不会让您这样做。）此外，这并不能保证您不会在具有欺骗性的 NIC 看起来像 VMWare 的物理机器上运行，但无论如何，这在大多数情况下都是一件奇怪的事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-26T17:28:24.263

运行以下命令：

```
lspci | grep VMware 
```

它应该显示如下内容：

> 00:0f.0 VGA 兼容控制器：VMware SVGA II 适配器
> 
> 00:11.0 PCI 桥：VMware PCI 桥（rev 02）
> 
> 00:15.0 PCI 桥：VMware PCI Express 根端口（rev 01）

# css - CSS 下溢修复

> ID：540915
> 
> 赞同：1
> 
> 时间：2009-02-12T11:28:11.383
> 
> 标签：css, overflow, underflow

我想知道是否有针对css的下溢修复？最初的问题是溢出，很容易修复，但现在已成为下溢问题。我设置了一个特定的高度值，但它似乎忽略了这一点，而是调整大小以适应内容。

我感谢任何帮助和想法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T12:12:55.770

min-height 适用于某些浏览器，但不适用于（令人惊讶的）IE。

这是 IE6 的 hack [http://www.dustindiaz.com/min-height-fast-hack/](http://www.dustindiaz.com/min-height-fast-hack/)

有很多方法可以解决这个问题，这取决于你喜欢哪一种。

# c++ - 哪个版本的 safe_delete 更好？

> ID：540920
> 
> 赞同：5
> 
> 时间：2009-02-12T11:29:53.580
> 
> 标签：c++, pointers, c-preprocessor

```
#define SAFE_DELETE(a) if( (a) != NULL ) delete (a); (a) = NULL; 
```

或者

```
template<typename T> void safe_delete(T*& a) {
  delete a;
  a = NULL;
} 
```

或任何其他更好的方式

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-12T11:39:02.497

我不会说，因为两者都会给你一种虚假的安全感。例如，假设您有一个函数：

```
void Func( SomePtr * p ) {
  // stuff
  SafeDelete( p );
} 
```

您将 p 设置为 NULL，但函数外部的 p 副本不受影响。

但是，如果您必须这样做，请使用模板 - 宏总是有可能超越其他名称。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-12T11:35:40.727

删除一个；

ISO C++ 规定，对 NULL 指针的删除不做任何事情。

引自 ISO 14882：

```
    5.3.5 删除[expr.delete]

    2 [...] 在任一备选方案中，如果 delete 的操作数的值是
        空指针操作无效。[...]

```

问候， 博多

/edit：我没有注意到 a=NULL; 在原来的帖子中，所以新版本：删除一个；一个=空；但是，已经指出了设置 a=NULL 的问题（错误的安全感）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-12T11:41:00.510

很明显的功能，原因很简单。宏多次评估其参数。这可能会产生不良的副作用。该功能也可以限定范围。没有比这更好的了：）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-12T11:35:29.150

一般来说，比起宏，更喜欢内联函数，因为宏不考虑作用域，并且在预处理过程中可能会与某些符号冲突，从而导致非常奇怪的编译错误。

当然，有时模板和函数是不行的，但这里不是这样。

此外，不需要更好的安全删除，因为您可以使用智能指针，因此不需要记住在客户端代码中使用此方法，而是将其封装。

（**编辑**）正如其他人指出的那样，安全删除并不安全，即使有人*没有*忘记使用它，它仍然可能达不到预期的效果。所以它实际上完全没有价值，因为正确使用 safe_delete 需要更多的思考，而不仅仅是自己设置为 0。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T11:36:42.720

您不需要使用 来测试无效性`delete`，它相当于无操作。`(a) = NULL`让我挑眉。第二种选择更好。

但是，如果您有选择，您应该使用智能指针，例如`std::auto_ptr`or `tr1::shared_ptr`，它已经为您执行此操作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T12:24:01.110

我认为

`#define SAFE_DELETE(pPtr) { delete pPtr; pPtr = NULL }`更好

1.  如果 pPtr 为 NULL，则可以调用 delete。因此*，如果*不需要检查。
2.  如果您调用 SAFE_DELETE(ptr+i)，则会导致编译错误。
3.  模板定义将为每种数据类型创建函数的多个实例。在我看来，在这种情况下，这些多重定义不会增加任何价值。
4.  此外，使用模板函数定义，您会产生函数调用的开销。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T16:30:34.777

SAFE_DELETE 的使用似乎是 C 程序员在 C++ 中控制内置内存管理的一种方法。我的问题是：C++ 是否允许在已正确封装为 Private 的指针上使用 SAFE_DELETE 的这种方法？此宏是否仅适用于声明为 Public 的指针？糟糕！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T12:56:22.873

如上所述，第二个更好，不是具有潜在意外副作用的宏，没有对 NULL 的不必要检查（尽管我怀疑您是在进行类型检查）等等。但是两者都没有承诺任何安全性。如果您确实使用了 tr1::smart_ptr 之类的东西，请确保您阅读了它们的文档并确保它具有适合您任务的语义。由于同事将 smart_ptrs 放入具有循环链接的数据结构中，我最近不得不寻找并清理巨大的内存泄漏:)（他应该使用weak_ptrs 进行反向引用）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-12T03:28:53.327

我更喜欢这个版本：

```
~scoped_ptr() {
    delete this->ptr_; //this-> for emphasis, ptr_ is owned by this
} 
```

在删除指针后将指针设置为 null 毫无意义，因为您使用指针的唯一原因是允许一次在多个位置引用一个对象。即使程序某一部分的指针为 0，也可能有其他部分未设置为 0。

此外，safe_delete 宏/函数模板很难正确使用，因为如果在给定指针的 new 和 delete 之间存在可能抛出的代码，则只有两个地方可以使用它。

1) 在重新抛出异常的 catch (...) 块内，并在不抛出的路径的 catch (...) 块旁边复制。（在每个可能允许指针超出范围的中断、返回、继续等旁边也重复）

2) 在拥有指针的对象的析构函数中（除非在 new 和 delete 之间没有可以抛出的代码）。

即使在您编写代码时没有可能抛出的代码，这也可能在未来发生变化（只需有人出现并在第一个代码之后添加另一个新代码）。最好以即使面对异常也保持正确的方式编写代码。

选项 1 产生了如此多的代码重复并且很容易出错，以至于我什至怀疑将其称为选项。

选项 2 使 safe_delete 变得多余，因为您设置为 0 的 ptr_ 将超出下一行的范围。

总之——不要使用 safe_delete，因为它根本不安全（正确使用非常困难，即使使用正确也会导致冗余代码）。使用 SBRM 和智能指针。

# geometry - 旋转和 OpenGL 矩阵

> ID：540921
> 
> 赞同：1
> 
> 时间：2009-02-12T11:29:57.540
> 
> 标签：geometry, rotation, matrix, graphics

我有一个类，它包含一个用于缩放和平移的 4x4 矩阵。我将如何为这个类实现旋转方法？我应该将旋转实现为单独的矩阵吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T11:47:20.400

您可以将当前矩阵与旋转矩阵相乘。看看[http://en.wikipedia.org/wiki/Rotation_matrix](http://en.wikipedia.org/wiki/Rotation_matrix)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T12:38:49.840

每当我需要查找 3D 转换的详细信息时，我都会使用一个名为[http://www.euclideanspace.com](http://www.euclideanspace.com)的网站。可以在[此处](http://www.euclideanspace.com/maths/algebra/matrix/orthogonal/rotation/index.htm)找到有关矩阵旋转的特定页面。

**编辑：**围绕给定轴旋转，查看[轴和角度](http://www.euclideanspace.com/maths/geometry/rotations/axisAngle/index.htm)表示。此页面还链接到有关如何将一种表示形式转换为另一种表示形式的描述。

如果您需要围绕多个轴旋转，只需将相应的矩阵相乘即可​​。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T13:38:57.340

回答问题的后半部分，单个 4x4 矩阵完全能够保持缩放、平移和旋转。因此，除非您对可以处理的 4x4 矩阵类型设置了特殊限制，否则单个 4x4 就可以满足您的需求。

至于关于任意向量的旋转（正如您在评论中询问的那样），请查看维基百科文章 yabcok 链接中的“关于任意向量的旋转”部分。您将希望通过用零填充它来将其扩展到 4x4 矩阵，除了 4,4（缩放）位置，它应该是 1。然后使用矩阵乘法与您的缩放/平移 4x4 生成一个新的 4x4 矩阵。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T14:16:22.307

您要确保找到一个参考，其中讨论了用于计算机图形学的正确类型的矩阵（即使用 4x4 变换矩阵进行旋转/平移/倾斜的 3D 齐次坐标）。

请参阅计算机图形“圣经”，例如[Foley 和 Van Dam](https://rads.stackoverflow.com/amzn/click/com/0201848406)（[第 213 页](http://books.google.com/books?id=jyZ_Q_7CubgC&pg=PA213)），或其中之一：

*   [3D 旋转矩阵的数学](http://www.fastgraph.com/makegames/3drotation/)
*   [3D 图形数学](http://www.gamedev.net/reference/articles/article415.asp)
*   [MSDN 3D图形教程](http://msdn.microsoft.com/en-us/library/bb172489(VS.85).aspx)
*   [关于 3D 旋转的 SIGGRAPH 文章](http://www.siggraph.org/education/materials/HyperGraph/modeling/mod_tran/3drota.htm#Rotation%20about%20an%20Arbitrary%20Axis)
*   [CProgramming.com](http://www.cprogramming.com/tutorial/3d/rotation.html)的其他页面

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-31T20:51:18.597

这个页面有很多有用的信息： http:
[//knol.google.com/k/matrices-for-3d-applications-translation-rotation](http://knol.google.com/k/matrices-for-3d-applications-translation-rotation)

# windows - x86 汇编 - Windows 下的非法操作码 0xff /7

> ID：540922
> 
> 赞同：4
> 
> 时间：2009-02-12T11:30:26.103
> 
> 标签：windows, assembly, x86

我目前正在开发一个 x86 反汇编程序，并开始反汇编一个 win32 PE 文件。大部分反汇编代码看起来不错，但是有一些非法的 0xff /7 操作码的出现（/7 表示 reg=111，0xff 是操作码组 inc/dec/call/callf/jmp/jmpf/push/*非法*操作数r/m 16/32)。第一个猜测是，/7 是 pop 指令，但它是用 0x8f /0 编码的。我已经对照官方的英特尔架构软件开发人员手册第 2 卷：指令集参考检查了这一点——所以我不只是被误导了。

反汇编示例：（S0000O0040683a 是被另一条指令跳转到的标签）

```
S0000O0040683a: inc    edi                      ; 0000:0040683a  ff c7
                test   dword ptr [eax+0xff],edi ; 0000:0040683c  85 78 ff
                0xff/7 edi                      ; 0000:0040683f  ff ff 
```

顺便说一句：gdb 对此进行了同样的反汇编（除了错误 0xff 在我的反汇编中没有产生 -1 ）：

```
(gdb) disassemble 0x0040683a 0x00406840
Dump of assembler code from 0x40683a to 0x406840:
0x0040683a:     inc    %edi
0x0040683c:     test   %edi,0xffffffff(%eax)
0x0040683f:     (bad)  
End of assembler dump. 
```

所以问题是：Windows的非法操作码异常处理程序中是否有任何默认处理程序，它实现了这个非法操作码中的任何功能，如果是：那里发生了什么？

问候， 博多

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T13:53:46.640

在让我的反汇编程序以与 gdb 完全相同的语法生成输出之后，我可以区分这两个版本。这在我的反汇编中揭示了一个相当尴尬的错误：我忘记考虑到 0x0f 0x8x 跳转指令有一个两字节操作码（加上 rel16/32 操作数）。因此，每个 0x0f 0x8x 跳转目标都偏离了一个，导致代码在现实中无法访问。修复此错误后，不再反汇编 0xff/7 操作码。

感谢所有回答我的问题的人（并评论这些答案），因此至少试图帮助我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T12:12:53.787

Visual Studio 将其反汇编为以下内容：

```
00417000 FF C7            inc         edi  
00417002 85 78 FF         test        dword ptr [eax-1],edi 
00417005 ??               db          ffh  
00417006 FF 00            inc         dword ptr [eax] 
```

显然，一般保护错误发生在 00417002，因为 eax 没有指向任何有意义的东西，但即使我将其 nop 出来（90 90 90），它也会在 00417005 处引发非法操作码异常（它不会被内核处理）。我很确定这是某种数据而不是可执行代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T12:47:56.153

为了回答您的问题，Windows 将使用异常代码 0xC000001D 关闭应用程序`STATUS_ILLEGAL_INSTRUCTION`。该对话框将匹配用于任何其他应用程序崩溃的对话框，无论它提供调试器还是发送错误报告。

关于提供的代码，它似乎要么组装不正确（编码大于 8 位位移），要么实际上是数据（正如其他人已经建议的那样）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T13:20:52.593

看起来测试指令插入了 0xFFFFFFFF 而不是 0xFF，可能是错误的？

85 = 测试 r/m32，78 是参数 [eax+d​​isp8]、edi 的字节，后面的 disp8 应该是 0xFF (-1)，但作为 32 位有符号整数，它是 0xFFFFFFFF。

所以我假设你有 85 78 FF FF FF FF 应该是 85 B8 FF FF FF 用于 32 位位移或 85 78 FF 用于 8 位位移？如果是这种情况，代码中的下一个字节应该是 0xFF...

当然，正如已经建议的那样，这可能只是数据，不要忘记数据可以存储在 PE 文件中，并且没有任何特定结构的有力保证。如果您正在积极优化以减小 .exe 大小，您实际上可以将代码或用户定义的数据插入到某些 MZ 或 PE 标头字段中。

编辑：根据下面的评论，我还建议使用您已经确切知道预期的反汇编代码应该是什么的可执行文件。

# sql - 服务器主体“XYuser”无法在当前安全上下文下访问数据库“Ydb”

> ID：540924
> 
> 赞同：2
> 
> 时间：2009-02-12T11:31:52.280
> 
> 标签：sql, sql-server, sql-server-2005, ssms

# 系统规格

```
Microsoft SQL Server Management Studio          9.00.4035.00  
Microsoft Analysis Services Client Tools        2005.090.4035.00  
Microsoft Data Access Components (MDAC)         2000.085.1132.00  
                                                 (xpsp.080413-0852)  
Microsoft MSXML                                 2.6 3.0 4.0 5.0 6.0 
Microsoft Internet Explorer                     7.0.5730.13  
Microsoft .NET Framework                        2.0.50727.1433  
Operating System                                5.1.2600 
```

在名为**BHAVMSQL02**的 SQL Server 2005 上，我有两个数据库*Mattercentre_dev*和*CMSNET_DEV*。*Mattercentre_dev*有一个存储过程，它从*CMSNET_DEV*中的表构建一个列表。存储过程看起来像这样......

```
USE [Mattercentre_dev]
GO
/****** Object:  StoredProcedure [dbo].[UDSPRBHPRIMBUSTYPE]   
  Script Date:02/12/2009 10:18:10 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO

ALTER PROCEDURE [dbo].[UDSPRBHPRIMBUSTYPE] WITH EXECUTE AS 'Readuser' AS

DECLARE @SERVERNAME nvarchar(30)
DECLARE @DBASE nvarchar(30)
DECLARE @SQL nvarchar(2000)
SET @SERVERNAME = Convert(nvarchar,
  (SELECT spData FROM dbSpecificData WHERE spLookup = 'CMSSERVER'))
SET @DBASE = Convert(nvarchar,
  (SELECT spData FROM dbSpecificData WHERE spLookup = 'CMSDBNAME'))

SET @SQL = 
'SELECT 
    null as Code
    , ''(not specified)'' as Description  
UNION SELECT 
    clnt_cat_code as Code
    , clnt_cat_desc as Description   
FROM '
    + @SERVERNAME + '.' + @DBASE + '.dbo.hbl_clnt_cat  
WHERE 
    inactive = ''N''  
ORDER BY Description'
PRINT @SQL

EXECUTE sp_executeSQL @SQL

@SERVERNAME == 'BHAVMSQL02'

@DBASE      == 'CMSNET_DEV' 
```

执行存储过程时出现以下错误消息...

```
The server principal "ReadUser" is not able to access the database "CMSNET_DEV" under the current security context. 
```

谷歌搜索错误消息后，我进行了以下修复...

*   从 BHAVMSQL02 -> Databases -> Mattercentre_dev -> Security -> Users 中删除了用户 ReadUser
*   从 BHAVMSQL02 设置 ReadUser -> 安全 -> 使用以下设置登录...

    通用
    登录名 - readUser
    密码 - xxxxxxxxxxxx
    Confirm - xxxxxxxxxxxx
    Default db - master
    default lg - British English
    Everything Else - Unset

    仅限服务器角色的公共集

    用户映射 CMSNET_DEV - ReadUser - dbo
    数据库角色成员资格 - db_owner、public

    Mattercentre_dev - ReadUser - dbo
    数据库角色成员资格 - db_owner, public

然后我运行以下脚本...

```
ALTER DATABASE CMSNET_DEV SET TRUSTWORTHY ON
GO
ALTER DATABASE mattercentre_dev SET TRUSTWORTHY ON
GO 
```

我重新运行存储过程并再次执行它，我仍然有相同的错误消息。

我在 Stack Overflow 中查找了这个问题，建议的解决方案与我自己的类似。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T13:22:06.897

当您的存储过程包含动态 SQL 时，您不能使用所有权链接，即这样做会破坏所有权链。

为了使其工作，您将需要使用证书来签署您的存储过程。

下面是一篇精彩的文章，其中包含对存储过程进行签名的说明。

[http://www.sommarskog.se/grantperm.html](http://www.sommarskog.se/grantperm.html)

更详细地查看这一点，您使用“execute as 子句”这一事实应该否定所有权链因合并动态 SQL 而被破坏的事实。

考虑到这一点，可能的原因是登录名“ReadUser”没有对相关数据库的适当读取权限，但鉴于登录名是 db_owner 角色的成员，情况不应该如此在两个数据库中。也就是说，如果数据库角色已从其原始状态更改，那么这可能不成立。

To test that the issue is not isolated to the “ReadUser” login I would suggest creating a new SQL Server Login, and mapping the login to both databases (there by creating database logins of the same name) with appropriate read access. Then modify the stored procedure to execute as the new login.

# asp.net-mvc - Asp.net MVC 路由类型

> ID：540925
> 
> 赞同：1
> 
> 时间：2009-02-12T11:32:51.467
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我的应用中有 2 个视图

1：Views->Season->ViewSeason

[替代文字 http://img102.imageshack.us/img102/9207/viewsseasonsx4.jpg](http://img102.imageshack.us/img102/9207/viewsseasonsx4.jpg)

2：Views->Admin->Season->ViewSeason

[替代文字 http://img242.imageshack.us/img242/1911/viewsadminsr4.jpg](http://img242.imageshack.us/img242/1911/viewsadminsr4.jpg)

我如何为此编写控制器？请帮助我.....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T11:39:36.287

最简单的做法是将 Admin/Season 合并为 AdminSeason 并拥有一个 AdminSeasonController.cs。

然后更新您的路由表，以便 /Admin/Season 路由到 AdminSeasonController。

这是未经测试的，但它可能在您的 Global.ascx 中看起来像这样（在开箱即用的 MVC 路由之上）：

```
routes.MapRoute(
            "AdminSeason",
            "Admin/Season",
            new { controller = "AdminSeason", action = "Index" }
           ); 
```

以下是其他一些问题：MVC 路由：

*   [ASP.Net MVC 路由映射](https://stackoverflow.com/questions/11926/asp-net-mvc-route-mapping)
*   [ASP.NET MVC 路由](https://stackoverflow.com/questions/118851/asp-net-mvc-routing)
*   [ASP.NET MVC 路由问题](https://stackoverflow.com/questions/377117/asp-net-mvc-routing-question)
*   [ASP.NET MVC 路由问题](https://stackoverflow.com/questions/492625/problem-with-asp-net-mvc-routing)

# iframe - IE7 iframe 空白页

> ID：540926
> 
> 赞同：6
> 
> 时间：2009-02-12T11:34:52.117
> 
> 标签：iframe, internet-explorer-7

我正在处理具有 iframe 的网页，并且正在 iframe 中加载外部站点。该页面在 IE6、FF 等中运行良好，但在 IE7 中我看到的只是一个空白页面。

我发现这是由于 IE7 中的网络钓鱼过滤器造成的。网络钓鱼过滤器将无法检查 iframe 内的网页，因此无法正确呈现。你以前遇到过这个问题吗？我该如何解决？

编辑：好的。在看到前两个答案后，我想我应该对此给出更多解释。该页面用于付款处理，我正在加载一个（第三方公司的）页面，该页面要求提供信用卡信息。输入详细信息并按继续后，iframe 立即变为空白。经过大量调查，我们发现 IE7 不接受 3rd 方 cookie（在 iframe 中加载页面时）。这与安全设置有关。互联网上的一些文章说我可以绕过网络钓鱼过滤器。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T16:48:21.260

如果您使用的是**ASP** ，请添加此代码

```
Response.AddHeader "p3p", "CP=" & chr(34) & "CURa ADMa DEVa PSAo PSDo OUR BUS UNI PUR INT DEM STA PRE COM NAV OTC NOI DSP COR" & chr(34) 
```

在**iframe中加载的所有页面中**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T15:45:12.497

> IE7 不接受 3rd 方 cookie（在 iframe 中加载页面时）。

它可以做到，这取决于设置的选项。特别是如果隐私级别已经调高，第三方必须提供 P3P 策略文件以确保 IE 不会调皮。（作为一项隐私措施，IMO 有点损失惨重，但我们坚持下去。）

> 我正在加载一个（第三方公司的）页面，该页面要求提供信用卡信息。

哇！不要那样做。用户将无法从地址栏中看到它是正确的站点 URL 并且已使用 SSL 正确加密。您实际上是在要求您的客户信任一个未知的站点和连接。

丢失 iframe。大多数支付处理商都可以选择为您的支付页面设置样式以匹配您的网站，并在用户完成后将其返回到您的网站。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T11:40:55.660

您是否设置了 IFRAME 属性 WIDTH？我以前读过这个，在那些场合与“宽度”属性有关。

因此，您可以使用 STYLE 属性，而不是使用 IFRAME 的 WIDTH 属性：

```
<IFRAME SRC='yourpage.html' STYLE='width:100%;'></IFRAME> 
```

[更新]
在上面的示例中，我使用 %-age 来声明 IFRAME 的宽度。您可以尝试以像素而不是百分比来声明它，例如：

```
<IFRAME SRC='yourpage.html' STYLE='width:600px;'></IFRAME> 
```

再说一次，这可能不是您的问题，但请提供更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T11:03:45.567

最后我找到了解决方案！

可以通过在网页中添加 p3p 标头来解决。这告诉浏览器 iframe 中的页面创建的 cookie 可以保护用户的隐私。必须将标头添加到 iframe 中加载的所有页面。

下面是一些链接，展示了如何在不同的脚本语言（PHP、ASP.net、JSP 等）中实现这一点。

[http://adamyoung.net/IE-Blocking-iFrame-Cookies](http://adamyoung.net/IE-Blocking-iFrame-Cookies)

[http://adamyoung.net/IE-Blocking-iFrame-Cookies](http://adamyoung.net/IE-Blocking-iFrame-Cookies)

[http://admon.org/node/99](http://admon.org/node/99)

注意：出于安全性和合规性原因，我使用此解决方案。谢谢博宾斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T11:42:35.467

也许您正在使用像 <TITLE/> 这样的标题标签

# sql-server - 基于应用于列的标量函数的索引

> ID：540931
> 
> 赞同：1
> 
> 时间：2009-02-12T11:35:42.160
> 
> 标签：sql-server, indexing, user-defined-functions

我有一个用户标量值函数，它接受 NVARCHAR(MAX) 并返回 NVARCHAR(MAX)。为了提高使用此功能的 GROUP BY 命令的性能，我想也基于它创建一个索引。但是[文档](http://msdn.microsoft.com/en-us/library/ms188783.aspx)说 CREATE INDEX 命令只接受列而不是表达式，所以这是非法的：

```
CREATE INDEX an_index ON a_table (foo(a_column)) 
```

有任何解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T11:38:41.763

您需要创建一个计算列：

```
CREATE TABLE a_table (a_column NVARCHAR(MAX), a_foo AS foo(a_column))
CREATE INDEX an_index ON a_table (a_foo) 
```

为了可索引，该函数`foo`当然必须满足某些要求：

> 索引调用用户定义函数的计算列
> 
> 当用户定义函数具有以下属性值时，可以在索引中使用调用用户定义函数的计算列：
> 
> *   `IsDeterministic = true`
> *   `IsSystemVerified = true`（除非计算列被持久化）
> *   `UserDataAccess = false`
> *   `SystemDataAccess = false`

您不能在非确定性函数上构建索引，这样`GETDATE`每次调用时都会更改其返回值。

如果您发布要索引的功能，解决您的问题会更容易。

# sql-server-2008 - SQL Server 2008 复制到 SQL Server 2000

> ID：540937
> 
> 赞同：0
> 
> 时间：2009-02-12T11:37:45.167
> 
> 标签：sql-server-2008, msde2000

有没有人在 SQL Server 2008 和 MSDE2000 之间实现了复制？这两个数据库之间是否可以进行合并复制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T03:43:08.167

SQL Server 2000 和 SQL Server 2005 都可以通过 SQL Server 2008 参与复制拓扑。对于 SQL Server 2000，最低版本是 Service Pack 3 (SP3)。

参考：[在复制拓扑中使用多个版本的 SQL Server](http://technet.microsoft.com/en-us/library/ms143241.aspx)

> 当您在不同版本的 SQL Server 之间进行复制时，通常仅限于使用的最早版本的功能。例如，如果您将分发服务器升级到 SQL Server 2008 实例，但您有一个正在运行 SQL Server 2005 实例的发布服务器和一个正在运行 SQL Server 2000 实例的订阅服务器，则您只能使用常规功能SQL Server 2000 的复制功能。

此处详细介绍了安全模型中的一些重大更改：[SQL Server 复制中的重大更改](http://msdn.microsoft.com/en-us/library/ms143470.aspx)

# c# - 在 C# 中的数组中搜索字符串的开头

> ID：540947
> 
> 赞同：2
> 
> 时间：2009-02-12T11:41:17.717
> 
> 标签：c#, .net, arrays, string

我有一个包含很多路径的列表。我有一个特定的路径，我想检查这个列表，看看那里是否有使用这个路径的路径，即：

```
f.StartsWith(r.FILENAME) && f != r.FILENAME 
```

最快的方法是什么？

编辑：来自以下答案的完整功能：

```
static bool ContainsFragment(string[] paths, string fragment)
{
    // paths **must** be pre-sorted via Array.Sort(paths);
    if (paths.Length == 0) return false;
    int index = Array.BinarySearch(paths, fragment);
    if (index >= 0 && index+1 < paths.Length)
    { //we found it 
        if (paths[index + 1].StartsWith(fragment) &&
            paths[index + 1].EndsWith(".manifest"))
        {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T11:45:55.397

*最快*的方法可能是二进制搜索：

```
static bool ContainsFragment(string[] paths, string fragment)
{
    // paths **must** be pre-sorted via Array.Sort(paths);
    if (paths.Length == 0) return false;
    int index = Array.BinarySearch(paths, fragment);
    // we want the index of the *next highest* path
    if (index < 0) { // no match
        index = ~index; 
    } else { // exact match
        index++; // for strict substring (non-equal)
    }
    return index < paths.Length && paths[index].StartsWith(fragment);
} 
```

但是如果你只做几次，排序数组的成本将超过任何好处；在这种情况下，只需扫描数组 - 使用 LINQ 等，或者只是：

```
bool found = false;
for(int i = 0 ; i < paths.Length ; i++) {
    if(paths[i].StartsWith(fragment) &&
          paths[i].Length != fragment.Length)
    {
        found = true;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T11:45:56.287

```
var matches = list.Where(f => f.StartsWith(r.FILENAME) && f != r.FILENAME); 
```

或者，如果您只关心存在：

```
bool any = list.Any(f => f.StartsWith(r.FILENAME) && f != r.FILENAME); 
```

诚然，这是假设您使用的是 .NET 3.5 - 否则有类似的方法`List<T>`，您可以使用匿名方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T13:23:57.017

对于这个相对简单的问题，我觉得有趣的是“有效”答案的数量，这取决于您如何定义“最快”。

*   如果最快意味着“成本最低”，那么 Marc 的二进制搜索方法听起来像是您的答案。
*   如果最快意味着“实现最快”，那么 Jon 的`list.Any`方法调用是合适的。
*   如果最快意味着“蛮力”，那么您可能需要考虑并行化搜索。就所需的处理而言，它的成本会更高，但可能会根据您的服务器资源而更快地执行。 [PLINQ](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)为您提供了一个很好的起点。

# common-lisp - Common-lisp 中最好的 Web 框架？

> ID：540953
> 
> 赞同：29
> 
> 时间：2009-02-12T11:44:27.553
> 
> 标签：common-lisp, web-frameworks

最好的 common-lisp web 框架是什么？

我正在寻找适合开发商业 Web 应用程序并能够处理类似于 Stack Overflow 的高流量站点的东西。它还应该具有内置的会话处理和其他类似功能。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-16T20:46:50.683

我的经验：

*   KPAX 是无人维护的、相当低级的并且没有完全记录在案
*   由于复杂性和缺少高级文档，UCW 对初学者来说很难入门。
*   SymbolicWeb 已死
*   如果您的需求是基本的或高度具体的，请直接使用 Hunchentoot
*   [Weblocks](http://weblocks.viridian-project.de/)相对年轻，但已经适合专业项目，同时提供基本的用户友好性（文档稀疏但非常有用的社区）。它还支持多个存储（例如 CLSQL、Elephant、Prevalence）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-01-11T13:42:59.950

您可以尝试使用 Caveman [http://clacklisp.org/caveman/](http://clacklisp.org/caveman/)

它基于 Clack 并且很容易上手

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-24T06:31:10.103

我最成功地使用[了 webactions](http://opensource.franz.com/aserve/webactions.html)

来自弗朗茨。我在 UCW 度过了一段非常艰难的时光，但我试图写一些关于如何使用它的“教程”。自从我写了那个[教程后，我不知道 UCW 是否有任何改进](http://www.cliki.net/ucw%20Tutorial)

正如你所看到的，他们说它已经过时了，这是真的。为什么它已经过时了？因为没有人关心改进或实现它，所以我的结论是，似乎没有人非常喜欢它。但是YMMV当然...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T12:01:05.687

另一个类似的 SO-thread 可以在[这里](https://stackoverflow.com/questions/167397/lisp-web-frameworks)找到。

AllegroServe 和 Hunchentoot 似乎是最常用的网络服务器。不过，并不是真正的框架。我有一些使用 Hunchentoot w/sbcl 的经验，我的测试“证明”它既快速又可靠。他们都有会话处理。

Hunchentoot 的作者对性能也有一些[看法](http://weitz.de/hunchentoot/#performance)。网络服务器很可能不会成为您的瓶颈。如果结果是这样，请记住 Hunchentoot 是开源的 :-)

您还可以查看[SymbolicWeb](http://code.google.com/p/symbolicweb/)，它更像是一个框架，但仍处于早期阶段。其他线程中的其他建议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T12:15:18.167

自从我尝试进入 CL Web 编程以来已经有一段时间了，但当时很多人都对使用[KPAX](http://homepage.mac.com/svc/kpax/)感到非常满意。

还有基于 hunchentoot的[Weblocks 。](http://weblocks.viridian-project.de/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T13:17:38.150

还有[BKNR](http://www.bknr.net/)。

# wpf - WPF Snoop 在 Windows XP 上不起作用？

> ID：540954
> 
> 赞同：2
> 
> 时间：2009-02-12T11:45:21.653
> 
> 标签：wpf, utilities

有没有其他人注意到 WPF 开发人员最好的朋友 Snoop 没有在 XP 上工作？我也尝试过 Snooping Expression Blend（一个 WPF 应用程序）和其他 WPF 应用程序。Snoop 会找到它们，但在按下双筒望远镜按钮时不会启动窗口。

编辑：我显然正在运行 XP SP2（支持 WPF）。

-pom-

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-04-01T18:51:44.323

我已经为 64 位平台和 WPF 4.0 工作并让 Snoop 工作。我还获得了[Pete Blois 的](http://blois.us/)许可，可以公开这些更改并将 Snoop 移至[CodePlex](http://www.codeplex.com/)。

有关更多信息，请参阅以下博客文章（尤其是最后一篇详细介绍了我对代码库所做的所有其他更改的文章）：

*   [http://www.cplotts.com/2010/02/14/snoop-now-supports-wpf-4-0/](http://www.cplotts.com/2010/02/14/snoop-now-supports-wpf-4-0/)
*   [http://www.cplotts.com/2010/02/11/snoop-now-on-codeplex/](http://www.cplotts.com/2010/02/11/snoop-now-on-codeplex/)
*   [http://www.cplotts.com/2009/12/08/snoop-now-with-64-bit-support-and-more/](http://www.cplotts.com/2009/12/08/snoop-now-with-64-bit-support-and-more/)

你可以从这里下载它：http: [//snoopwpf.codeplex.com/](http://snoopwpf.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T18:33:41.907

您必须以管理员身份登录才能使 snoop 工作。以管理员身份运行 snoop.exe 是不够的，您必须以管理员身份实际登录。

如果您有源代码，请尝试更改 injector.cpp 中的以下行

处理 hProcess = ::OpenProcess(PROCESS_ALL_ACCESS, FALSE, processID);

至

处理 hProcess = ::OpenProcess(PROCESS_VM_WRITE|PROCESS_VM_READ|PROCESS_VM_OPERATION, FALSE, processID);

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T18:38:46.167

Snoop 不适用于 64 位平台。你的 XP 是 64 位的吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-30T00:36:29.823

还有另一个工具可以检查正在运行的 WPF 应用程序，称为**WPF Inspector**。它还包括其他一些不错的功能，例如触发调试或数据上下文视图。

你可以从这里下载它：http: [//www.wpftutorial.net/inspector.html](http://www.wpftutorial.net/inspector.html)

问候
基督徒

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-08T14:53:47.997

Snoop 将在 64 位系统上工作。您只需编译可执行文件以在 32 位模式下运行。

如果使用 .NET，您可以使用 .NET 工具 corflags /32bit+ [executable] 将您的可执行文件标记为 32 位，无需重新编译。

# 64-bit - 结构对齐到端口代码到 64 位

> ID：540967
> 
> 赞同：0
> 
> 时间：2009-02-12T11:49:30.600
> 
> 标签：64-bit, structure, memory-alignment

我有一个 32 位 .NET 程序集，它 PInvoke 到 C 层。我想将此程序集移植到 64 位。我已经阅读了许多与移植到 64 位相关的文档，所有这些似乎都表明如果我们要使用结构，我们需要注意对齐。

我有一个与结构对齐有关的一般性问题，想先澄清一下，这样我就不会错过任何东西。

假设我有一个 C 入口点，它接受一个结构指针并基本上填满了里面的值。此 C 代码没有任何打包指令，并且所有 .NET 结构都与 pack=8 对齐。因此，如果我传递具有相邻整数的结构，我认为解释 .NET 层中填充的数据可能会出现问题，因为 C 默认情况下会使用 pack=4，而我们在 .NET 中将结构解释为 pack=8层，所以认为它可能会导致问题。但似乎并非如此。数据似乎解释得很好。

谁能解释这种行为？

谢谢，尼兰詹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T07:05:19.393

我遇到了这篇 msdn 文章 [http://msdn.microsoft.com/en-us/library/aa366769(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366769(VS.85).aspx)

它表明指定大于类型自然对齐的打包级别不会更改类型对齐。因此，由于我提到的上述情况下的自然对齐方式是 4，因此将包装设置为 8 并不会真正改变结构的对齐方式。这解释了这种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-23T23:35:38.230

默认情况下，结构或联合的成员在其自然边界上对齐；char 一个字节，short 两个字节，整数四个字节等。如果 n 存在，它必须是 2 的幂，指定任何结构或联合成员的最严格的自然对齐。

例如，#pragma pack(2) 在两个字节边界上对齐 int、long、long long、float、double、long double 和指针，而不是它们的自然对齐边界。如果 n 等于或大于平台上最严格的对齐方式（x86 上为 4，SPARC v8 上为 8，SPARC v9 上为 16），则该指令具有自然对齐的效果。

我不确定 x86 架构是否支持 8 字节对齐，即使它们支持 64 位环境。毕竟，64 位平台上的 4 字节对齐不会造成任何损害。

您还可以使用：#pragma align 8 (variable) 告诉编译器您希望全局或静态变量如何对齐。

# asp.net - 如何控制从 ASP.NET 应用程序发送电子邮件的顺序

> ID：540968
> 
> 赞同：1
> 
> 时间：2009-02-12T11:49:59.177
> 
> 标签：asp.net, smtp

我正在尝试控制从网站发送电子邮件的顺序。

我有使用相同机制发送 email1 和 email2 的代码：System.Net.Mail.SmtpClient。

电子邮件总是按 email2、email1 的顺序到达（即使我向它们发送 email2 和 email1）。

我已尝试按照此处 [http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=166439&](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=166439&)的建议设置超时属性。

像这样

公共类 SmtpClientAdapter 继承 SmtpClient

```
Public Sub SendEmail(ByVal message As System.Net.Mail.MailMessage)

    Host = Parameter.Data.GetString("SMTPServer")
    message.IsBodyHtml = True

    MyBase.ServicePoint.MaxIdleTime = 1
    MyBase.ServicePoint.ConnectionLimit = 1
    MyBase.Send(message)

End Sub 
```

结束类

我一直试图发现我可以利用 SMTP 标头延迟交付

[https://www.rfc-editor.org/rfc/rfc4021#section-2.1.65](https://www.rfc-editor.org/rfc/rfc4021#section-2.1.65)

有谁知道我是否可以从 ASP.NET 使用这个标头？

德里克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T12:02:16.713

处理延迟交付标头不是 ASP.NET 的责任。它取决于您将电子邮件发送到的 SMTP 服务器来选择支持该标头。

一般来说，您不能实际期望控制电子邮件传递的顺序。

# wpf - 如何创建在某些地方延伸的 WPF 路径

> ID：540969
> 
> 赞同：3
> 
> 时间：2009-02-12T11:50:03.623
> 
> 标签：wpf, canvas, pathgeometry

我想为窗口选项卡创建一个 WPF 控件，并且我希望它具有特定的形状。像这样的东西；

```
 +------------------------------+
      |                              |
*     |                              |
      |                              |
   +--+                              +--+
6  |                                    |  6
   +------------------------------------+   
     6       stretching section       6 
```

所以左下角和右下角的小标签是固定大小的；大约 6x6。但现在我希望中心部分伸展到我拍它的任何容器的宽度。

我目前正在使用 Path 对象，但我不知道如何获得拉伸部分，或者即使 Path 是正确的方法。

谁能建议创建这种半可拉伸形状的最佳方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T12:26:16.313

为什么不创建两个不同的小部件？一个用于中心部分，另一个用于可拉伸部分。然后将它们粘在另一个容器中，形成一个统一的控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T12:37:21.467

我通过创建一个继承自 StackPanel 的“StretchStackPanel”在我的应用程序中完成了拉伸部分。该类如下所示：

```
public class StretchStackPanel : StackPanel
{
    public static DependencyProperty StretchDependencyProperty = DependencyProperty.Register("Stretch", typeof(StretchMode), typeof(StretchStackPanel));

    protected override Size MeasureOverride(Size availableSize)
    {
        var baseSize = base.MeasureOverride(availableSize);

        if (availableSize.Width != double.PositiveInfinity && (Stretch & StretchMode.Horizontal) == StretchMode.Horizontal )
        {
            baseSize.Width = availableSize.Width;    
        }
        if (availableSize.Height != double.PositiveInfinity && (Stretch & StretchMode.Vertical) == StretchMode.Vertical)
        {
            baseSize.Height = availableSize.Height;
        }

        return baseSize;
    }

    protected override Size ArrangeOverride(Size finalSize)
    {
        var baseSize = base.ArrangeOverride(finalSize);

        if ((Stretch & StretchMode.Horizontal) == StretchMode.Horizontal )
        {
            baseSize.Width = finalSize.Width;    
        }

        if ((Stretch & StretchMode.Vertical) == StretchMode.Vertical)
        {
            baseSize.Height = finalSize.Height;
        }
        return baseSize;
    }

    [Category("Layout")]
    public StretchMode Stretch
    {
        get
        {
            return (StretchMode)GetValue(StretchDependencyProperty);
        }
        set
        {
            SetValue(StretchDependencyProperty, value);
        }
    }
} 
```

你想要的是一个有 2 行的网格。顶行的内容应将其水平对齐设置为居中。底行的内容应该是一个 StretchStackPanel。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T15:46:00.687

我认为您应该覆盖控件中的 MeasureOverride 方法并获取内容的 DesiredSize（通过在 Content/Children 上调用 Measure 方法）。然后你可以根据这个大小创建你的路径。

# delphi - delphi中的变量初始值

> ID：540970
> 
> 赞同：6
> 
> 时间：2009-02-12T11:50:08.913
> 
> 标签：delphi

我相信局部整数变量在delphi中没有初始化为零。初始值是发生在该内存位置的任何值。因此，在第一次单击按钮时下面的代码中，第一条消息显示一个整数值。为什么第二次点击它不显示 3 而是显示相同的整数值？每次单击按钮时，它都会继续显示相同的整数值。仅当我停止并重新启动程序时，该值才不同。3 存储在哪里，因为每次在程序的同一运行中单击按钮时似乎使用相同的内存位置？

```
procedure TForm1.Button1Click(Sender: TObject);

var
int1 : integer;

begin
   showmessage(inttostr(int1)) ;
   int1 := 3;
end;

end. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T12:24:29.830

千斤顶，

它包含当时堆栈帧中的任何值。在您的情况下，这将是发件人。如果您将整数转换为对象，您会注意到“模式”。

```
procedure TForm1.Button1Click(Sender: TObject);

var
int1 : integer;

begin
   ShowMessage(TObject(int1).ClassName);
   showmessage(inttostr(int1)) ;
   int1 := 3;
end;

end. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T12:00:55.860

首先，你是正确的局部变量[没有初始化](https://stackoverflow.com/questions/132725/are-delphi-variables-initialized-with-a-value-by-default)。

此外，您不能保证`int1`每次调用时都将其存储在相同的内存位置。在这种情况下，您每次看到相同值的原因可能是因为它*使用*相同的位置（偶然），但 Delphi 编译器已经优化了您的 final

```
int1 := 3; 
```

声明，因为它没有效果。（您可以在该行之后添加另一个`showmessage(inttostr(int1))`调用，看看是否会有所不同。）另一种可能性是，用于`int1`在调用按钮处理程序之间重用的内存位置（例如在 Windows 消息循环中）并且碰巧总是重置它到你看到的价值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T12:01:37.997

只有在两次单击 Button1 之间没有执行其他代码时才会出现这种情况，最重要的是使用与到达过程 TForm1.Button1Click() 的代码相同数量（或更多）的堆栈空间的代码。除非您覆盖堆栈上的值，否则它们仍将包含相同的值。

您可以做的测试是添加另一个带有 OnClick 处理程序的按钮，该处理程序调用具有比 ShowMessage() 更多参数的方法。如果您在两次单击 Button1 之间单击该按钮，则 int1 的值确实应该改变。这是因为 Button1Click() 中 int1 的堆栈位置随后将用于其他处理程序中的参数之一，并被覆盖。

分配应该被优化掉，你可以看到这一点，因为线在排水沟区域不应该有蓝点。也应该有一个编译器提示。

**编辑：**正如您评论的那样，单击另一个按钮时行为似乎没有变化。由此我只能假设 VCL 代码（在调用 OnClick 处理程序之前执行）使用了太多的堆栈空间，以至于 int1 的内存位置总是用一些（稳定的）值初始化。这段代码总是一样的，所以如果相关对象（应用程序、父窗体和按钮）的地址没有改变，值也将保持不变。OTOH 重新启动应用程序将在未初始化的局部变量中产生一个新的、同样稳定的值。

请注意，这完全依赖于在处理程序之前执行的 VCL 代码，因此对 VCL 的更改也可能会改变它。甚至可能各种 Delphi 版本的行为已经不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T12:12:59.950

局部变量在堆栈帧中。并且它们没有被初始化。

如果你两次访问一个方法，你有可能堆栈指针是 euqal ，它给出了相同的值。

例子：

调用前堆栈：

```
> More stack  (memory location X) 
```

如果 Button1Click 被调用，堆栈就像：

```
> Int1
> Return address
> Sender
> Self pointer
> More stack  (memory location X) 
```

如果下次调用 Button1Click，堆栈指针仍在位置 X 上，并且没有其他函数更改值，您会发现 Int1 的值相同。

如果您有安全信息，清除局部变量总是明智的（但您有可能优化器删除这些状态。所以您需要禁用优化）。

只是为了好玩，添加另一个按钮：

```
procedure TForm1.Button2Click(Sender: TObject);
var
  int1 : integer;
begin
  showmessage(inttostr(int1)) ;
  int1 := 777;
end; 
```

并检查：

*   点击1：垃圾
*   再次单击 1：3
*   点击2：3
*   点击1：777

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T13:09:34.837

你希望它是一样的吗？如果是这样，您可以使用本地常量：

```
procedure TForm1.Button1Click(Sender: TObject);
const
  i: integer = 0;
begin
  i := i + 1;
  edit1.text := intToStr(i);
end; 
```

不过，您必须确保“可分配的类型常量”已打开。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T22:09:25.943

初始化变量可能由内存管理器完成，也可能不由内存管理器完成。

我认为任何内存管理器都将所有变量初始化为零（0x0000）是一种很好的做法。这也是在.Net 中完成的。

# python - 使用 Python (smtplib) 发送邮件时指定发件人

> ID：540976
> 
> 赞同：13
> 
> 时间：2009-02-12T11:52:40.637
> 
> 标签：python, email

我有一段非常简单的代码（仅用于测试）：

```
import smtplib
import time

server = 'smtp.myprovider.com'
recipients = ['johndoe@somedomain.com']
sender = 'me@mydomain.com'
message = 'Subject: [PGS]: Results\n\nBlaBlaBla'

session = smtplib.SMTP(server)

session.sendmail(sender,recipients,message); 
```

这可行，但问题是电子邮件客户端不显示发件人。我希望能够在电子邮件中添加发件人姓名。建议？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-12T12:08:12.880

`smtplib`不会自动包含`From:`标题，因此您必须自己添加一个：

```
message = 'From: me@example.com\nSubject: [PGS]: Results\n\nBlaBlaBla' 
```

（事实上​​，`smtplib`不会自动包含*任何*标题，而只是将您提供的文本作为原始消息发送）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-12T12:16:10.003

您可以利用[email.message.Message](http://docs.python.org/library/email.message.html#email.message.Message)类，并使用它来生成 mime 标头，包括`from:`,`to:`和`subject`. `as_string()`通过 SMTP发送结果。

```
>>> from email import message
>>> m1=message.Message()
>>> m1.add_header('from','me@no.where')
>>> m1.add_header('to','myself@some.where')
>>> m1.add_header('subject','test')
>>> m1.set_payload('test\n')
>>> m1.as_string()
'from: me@no.where\nto: myself@some.where\nsubject: test\n\ntest\n'
>>> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-11-03T15:58:16.947

[看到](https://stackoverflow.com/a/10553563/486556)这个答案，它对我有用。

示例代码：

```
#send html email
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.header import Header
from email.utils import formataddr

msg = MIMEMultipart('alternative')
msg['From'] = formataddr((str(Header('MyWebsite', 'utf-8')), 'from@mywebsite.com'))
msg['To'] = 'to@email.com'

html = "email contents"

# Record the MIME types of text/html.
msg.attach(MIMEText(html, 'html'))

# Send the message via local SMTP server.
s = smtplib.SMTP('localhost')

# sendmail function takes 3 arguments: sender's address, recipient's address
# and message to send - here it is sent as one string.
s.sendmail('from@mywebsite.com', 'to@email.com', msg.as_string())
s.quit() 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-12T12:22:54.420

在这种情况下，您指定的“发件人”是传递到 SMTP 服务器的信封发件人。

您的 MUA（邮件用户代理 - 即 Outlook/Thunderbird 等）向您显示的是“发件人：”标题。

通常，如果我使用 smtplib，我会单独编译头文件：

```
headers = "From: %s\nTo: %s\n\n" % (email_from, email_to) 
```

From 标头的格式通常是约定俗成的`"Name" <user@domain>`

您应该在所有通信中包含“Message-Id”标头和“Reply-To”标头。特别是因为垃圾邮件过滤器可能会发现缺少这些邮件，因为邮件很可能是垃圾邮件。

如果您的邮件正文在变量正文中，只需编译整个消息：

```
message = headers + body 
```

注意标题末尾的双换行符。还值得注意的是，SMTP 服务器应该仅用换行符分隔标头（即 LF - 换行符）。但是，我见过一个或两个使用 \r\n（即 CRLF）的 Windows SMTP 服务器。如果你在 Windows 上，YMMV。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-09-25T10:28:59.703

我认为您正在尝试显示一些特定名称而不是您的 emailID。您只需更改[此代码中的 msg['From'] 部分](https://www.tutorialspoint.com/send-mail-with-attachment-from-your-gmail-account-using-python)

```
fromName = "Name Which you want to show in reciever Inbox"
fromEmail = "abc@xyz.com"  # Sender's email Id
message['From'] = "{} <{}>".format(fromName,fromEmail) 
```

这通常在上述[链接](https://www.tutorialspoint.com/send-mail-with-attachment-from-your-gmail-account-using-python)之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-29T23:20:49.183

当仅使用 smtplib 添加来自名称而不是显示您的电子邮件地址时，只需使用：

```
message = """From: whatever-name\nSubject: subject\n\n
body of the message!
""".encode() 
```

通过 .sendmail(TO, FROM, message) 传递此消息将起作用。

# .net - 如何更改动态数据中显示列的顺序？

> ID：540977
> 
> 赞同：0
> 
> 时间：2009-02-12T11:53:17.563
> 
> 标签：.net, metadata, dynamic-data

对于我的一些动态数据元数据表，我想控制显示列的顺序。我有一个自定义页面，我创建了一个与我的表同名的子目录。我将 ListDetails.aspx 和代码文件复制到新目录。并将 AutoGenerateColumns 更改为 false（在 Gridview 中）并将 AutoGenerateRows 更改为 false（DetailsView。它们都不起作用！请帮助我。J

此致，

萨哈尔

```
 <Columns>
              <asp:DynamicField  DataField="DestFieldTypeDescription" />
              <asp:DynamicField  DataField="DestFieldTypeName" /> 
              <asp:DynamicField  DataField="DestFieldTypeID" />

            </Columns>
            <PagerStyle CssClass="footer" />        
            <SelectedRowStyle CssClass="selected" />
            <PagerTemplate>
                <asp:GridViewPager runat="server" />
            </PagerTemplate>
            <EmptyDataTemplate>
                There are currently no items in this table.
            </EmptyDataTemplate>
        </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T06:36:12.780

当我遇到这样的问题时，我的更改没有反映在输出中，我怀疑的第一件事是我正在编辑错误的文件。

在 GridView 上方或下方放置一些内容，例如“Hello World”，并确认该文件正在执行。

如果文件没有被执行，那么它的路线没有被移交给正确的文件。如果您使用默认模板，您的路线可能在 Global.asax 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T17:37:10.047

确保您路由到“ListDetails”视图以获取正确的操作。

或者换句话说，启用组合页面模式：在 Global.asax.cs RegisterRoutes() 方法中取消注释这些行：

```
routes.Add(new DynamicDataRoute("{table}/ListDetails.aspx")
{
    Action = PageAction.List,
    ViewName = "ListDetails",
    Model = model
});

routes.Add(new DynamicDataRoute("{table}/ListDetails.aspx")
{
    Action = PageAction.Details,
    ViewName = "ListDetails",
    Model = model
}); 
```

# mercurial - 克隆是获取 Mercurial 存储库内容的唯一方法吗？

> ID：540986
> 
> 赞同：10
> 
> 时间：2009-02-12T12:01:19.480
> 
> 标签：mercurial

我试图通过运行来获取 Netbeans IDE 的源代码：

hg 克隆[http://hg.netbeans.org/main/](http://hg.netbeans.org/main/)

但是，这似乎需要很长时间，并且它没有给我任何状态来告诉我已完成下载的百分比。如果我失去了互联网连接，我必须重新开始。

我意识到 Mercurial 是一个分布式源代码控制系统，也许“克隆”命令需要这么长时间，因为它正在获取所有文件的整个历史记录（这是正确的吗？）

当我们从 CVS 获取源代码时，我们通常会在没有完整历史记录的情况下获取源代码。可以用 Mercurial 做这样的事情吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T13:41:22.873

Mercurial 的[hgweb](http://www.selenic.com/mercurial/wiki/index.cgi/PublishingRepositories)可以[配置为允许下载快照](http://www.selenic.com/mercurial/wiki/index.cgi/PublishingRepositories#head-8a47f2fb27fd2b2552d960884ebb9f57c332eb96)，例如，

> 确保您的存储库的 .hg/hgrc 文件（或 /home/user/.hgrc 文件）包含 allow_archive 设置：
> 
> [网络]
> allow_archive = gz, zip, bz2
> 
> 此示例说明如何支持 gzip、zip 和 bzip2 归档格式。因此，链接应该出现在与这些归档类型对应的 Web 界面中。

但是，您尝试下载的存储库似乎不允许这种操作模式。您可能会要求他们添加它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T12:11:24.493

可能[`clone -verbose`](http://www.selenic.com/mercurial/bts/msg5141)会为您提供有关问题所在的更多详细信息？

```
C:\netbeans-src>hg clone --verbose http://hg.netbeans.org/main
destination directory: main
requesting all changes
adding changesets
adding manifests
adding file changes 
```

如果没有错误，您可能会考虑使用[**Shallow 克隆**](http://www.selenic.com/mercurial/wiki/index.cgi/ShallowClone)，而不是从服务器中提取整个历史记录，而只是从给定修订版开始的子集。
正如[Ry4an](https://stackoverflow.com/users/8992/ry4an)所提到的，这是一个“alpha 扩展”，还不是一个长期的解决方案。

# python - MacOsX 上的 Python 图像库和 JPEG

> ID：540991
> 
> 赞同：2
> 
> 时间：2009-02-12T12:04:12.030
> 
> 标签：python, macos, jpeg, python-imaging-library

我已经掌握了[Python Imaging Library (PIL)](http://www.pythonware.com/products/pil/)并很好地安装了 PNG 支持的东西。但是，我遇到了[JPEG Library](http://www.ijg.org/)的问题。

它的默认设置只是他们建议“/home/libraries/jpeg-6b”。在 Mac 上，该目录不存在，但是该库安装得很好，这是安装的输出。

```
/usr/bin/install -c cjpeg /usr/local/bin/cjpeg
/usr/bin/install -c djpeg /usr/local/bin/djpeg
/usr/bin/install -c jpegtran /usr/local/bin/jpegtran
/usr/bin/install -c rdjpgcom /usr/local/bin/rdjpgcom
/usr/bin/install -c wrjpgcom /usr/local/bin/wrjpgcom
/usr/bin/install -c -m 644 ./cjpeg.1 /usr/local/man/man1/cjpeg.1
/usr/bin/install -c -m 644 ./djpeg.1 /usr/local/man/man1/djpeg.1
/usr/bin/install -c -m 644 ./jpegtran.1 /usr/local/man/man1/jpegtran.1
/usr/bin/install -c -m 644 ./rdjpgcom.1 /usr/local/man/man1/rdjpgcom.1
/usr/bin/install -c -m 644 ./wrjpgcom.1 /usr/local/man/man1/wrjpgcom.1 
```

我尝试将 PIL 指向 /usr/local/bin/cjpeg、cjpeg 等，但它从未识别过它。有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T12:38:46.673

对我来说，在 OS X 上运行 Python + PIL 的唯一方法是从[ports](http://www.macports.org/)安装两者。我从未设法在系统 Python 下或从 python.org 手动安装获得功能齐全的 PIL。也许你可以试试这种方法？

# javascript - 在用户下载文件时重命名另一台服务器上的文件

> ID：540993
> 
> 赞同：0
> 
> 时间：2009-02-12T12:04:23.793
> 
> 标签：javascript, url, file, save

我允许用户通过提供链接从另一台服务器下载文件。

但是，当用户尝试下载文件时，文件始终命名为“file.zip”。我希望我可以使用 JavaScript 将文件重命名为更合适的名称。

我怎样才能做到这一点？这可能吗？

将不胜感激任何帮助。

谢谢大家

## 更新

将该文件保存到我的服务器如何，当我这样做时，让用户下载它？用户可以开始下载未完全下载的文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T12:07:07.233

不，不可能，file.zip 将在服务器发送的 Content-Disposition 标头中，您无法在 Javascript 中进行任何拦截和修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T12:09:29.240

我很确定 Javascript 不会让你这样做。

更好的选择可能是发送 HTTP Content-Disposition 标头，如下所示：

```
Content-Disposition,attachment; filename=foobar.zip 
```

其中 foobar.zip 是您希望调用该文件的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T12:07:11.057

这是不可能的。下载文件时显示特定文件名的唯一方法是控制远程服务器并将其设置为设置特定的 http 标头。

# apache - apache ant 构建文件

> ID：540996
> 
> 赞同：1
> 
> 时间：2009-02-12T12:05:20.060
> 
> 标签：apache, ant, build

我试图在每一步（目标）之后输出时间戳。当通过 ant testtime 执行以下构建文件时，我得到输出：

```
Buildfile: build.xml

testdepend1:
     [echo] ****** Start: test depend 1 ******
     [echo] ****** Finish: test depend 1******
     [echo] 02/12/2009 11:58:07 AM

testdepend2:
     [echo] ****** Start: test depend 2 ******
     [echo] ****** Finish: test depend 2******
     [echo] 02/12/2009 11:58:07 AM

testdepend3:
     [echo] ****** Start: test depend 3 ******
     [echo] ****** Finish: test depend 3******
     [echo] 02/12/2009 11:58:07 AM 
```

执行下面的构建文件：

```
<?xml version="1.0" ?>
<!-- ==================================================================== -->
<!-- Sample Propagation Ant Script -->
<!-- ==================================================================== -->
<project name="Portal Propagation Ant Tasks" basedir="." default="usage">
    <tstamp>  
     <format property="TODAY_UK" pattern="MM/dd/yyyy hh:mm:ss aa" locale="en,UK" unit="second"/>  
    </tstamp>  

    <target name="testdepend1" description="test depend1">
     <echo message="****** Start: test depend 1 ******" />
       <sleep seconds="10"/>
     <echo message="****** Finish: test depend 1******" />
      <echo>${TODAY_UK}</echo>   
    </target>

    <target name="testdepend2" description="test depend2">
     <echo message="****** Start: test depend 2 ******" />
      <sleep seconds="10"/>
     <echo message="****** Finish: test depend 2******" />
      <echo>${TODAY_UK}</echo>   
    </target>

    <target name="testdepend3" description="test depend3">
     <echo message="****** Start: test depend 3 ******" />
     <sleep seconds="10"/>
     <echo message="****** Finish: test depend 3******" />
      <echo>${TODAY_UK}</echo>   
    </target>

    <target name="testtime" depends="testdepend1, testdepend2, testdepend3" description="output a timestamp" />

</project> 
```

为什么我总是得到相同的时间戳？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T12:19:59.480

一旦评估，TODAY_UK 将不再计算。

可能您应该在任务开始时添加以下内容：

```
<tstamp>
  <format property="TODAY_UK" pattern="dd MMM yyyy HH.mm" locale="en_GB" />
</tstamp> 
<echo message="${TODAY} at ${TSTAMP}" /> 
```

使用核心任务[tstamp](http://ant.apache.org/manual/Tasks/tstamp.html)

* * *

您需要测试[此脚本](http://www.xinotes.org/notes/note/275/)以进行配置，然后显示时间戳：

```
<project name="tstamp_demo" basedir="." default="display">
    <target name="display" depends="tstamp" description="TSTAMP demo">
        <echo>DSTAMP: ${DSTAMP}</echo>
        <echo>TSTAMP: ${TSTAMP}</echo>
        <echo>TODAY: ${TODAY}</echo>
        <echo>TODAY_UK: ${TODAY_UK}</echo>
    </target>

    <target name="tstamp" description="Set DSTAMP/TSTAMP/TODAY, plus whatever in the body">
        <tstamp>
            <format property="TODAY_UK" pattern="d-MMMM-yyyy" locale="en,UK"/>
        </tstamp>
    </target>

    <target name="display.start" depends="tstamp.start" description="TSTAMP demo with prefix">
        <echo>start.DSTAMP: ${start.DSTAMP}</echo>
        <echo>start.TSTAMP: ${start.TSTAMP}</echo>
        <echo>start.TODAY: ${start.TODAY}</echo>
    </target>

    <target name="tstamp.start">
        <tstamp prefix="start"/>
    </target>
</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T14:56:40.320

您总是得到相同的时间戳，因为包含此值的属性*只计算一次*。在任务开头添加一个 '' 的提议也无济于事，因为 Ant 不会更新属性的值。

我想出的解决方案是定义你自己的 Ant 任务：

```
public class StampedEcho extends Echo {

    private String message;
    private String pattern = "d-MMMM-yyyy";
    private Locale locale = Locale.US;

    public void setPattern(String pattern) { this.pattern = pattern; }

    public void setLocale(String locale) { this.locale = new Locale(locale); }

    @Override
    public void setMessage(String message) { this.message = message; }

    @Override
    public void execute() throws BuildException {
        String date = new SimpleDateFormat(this.pattern, this.locale).format(new Date());
        super.setMessage(date + (this.message == null ? "" : " " + this.message));

        super.execute();
    }
} 
```

然后定义一个 Antlib 文件（例如`message-antlib.xml`）来实例化和调用该类：

```
<antlib>
    <macrodef name="tstamp">
        <attribute name="message" default=""/>
        <attribute name="pattern" default="HH:mm:ss"/>
        <attribute name="locale" default="en"/>
        <sequential>
            <!-- I suppose that the class is in Ant's classpath -->
            <taskdef name="tsecho" classname="StampedEcho"/>

            <tsecho message="@{message}" pattern="@{pattern}" locale="@{locale}"/>
        </sequential>
    </macrodef>
</antlib> 
```

相应地修改您的`build.xml`文件

```
<project xmlns:msg="antlib:message">
    <typedef file="message-antlib.xml" uri="antlib:message"/>

    <target name="testing">
        <msg:tstamp/>
        <msg:tstamp message="start"/>
        <msg:tstamp message="end" pattern="HH.mm" locale="en_GB"/>
    </target>
</project> 
```

获得以下输出：

```
[tsecho] 21:46:20 
[tsecho] 21:46:20 start
[tsecho] 21.46 end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-20T01:21:15.320

你为什么不使用 antContrib 蚂蚁监听器检查一下

[http://neopatel.blogspot.com/2009/09/timestamp-your-ant-build.html](http://neopatel.blogspot.com/2009/09/timestamp-your-ant-build.html)

# cocoa - 将对象添加到 nsmutable 数组，但数组仍然为空

> ID：540998
> 
> 赞同：0
> 
> 时间：2009-02-12T12:06:05.287
> 
> 标签：cocoa

我正在学习 Objective-C 并且遇到了障碍。

我创建了一个名为“Baddie”的自定义对象。我正在尝试将对象添加到几个可变数组中。

```
Baddie *b1 = [[Baddie alloc]initWithTag:4444 pos:cpv(450,270) dir:cpv(0,1)]; 
[baddieArray addObject: b1];    
[baddieWaitingArray addObject: [[Baddie alloc]initWithTag:4447 pos:cpv(450,270) dir:cpv(0,1)]];
[baddieWaitingArray addObject: [[Baddie alloc]initWithTag:4448 pos:cpv(450,270) dir:cpv(0,1)]];
    //end 
```

在“结束”时，两个数组似乎都是空的。数组之前初始化如下：

```
baddieArray = [[NSMutableArray alloc] init];
baddieWaitingArray = [[NSMutableArray alloc] init]; 
```

我不确定为什么数组是空的。指向 b1 的指针仍然指向对象。我仍然可以从中检索属性。我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T12:15:34.763

这似乎太简单了，但如果 baddieArray 为 nil，则添加将被忽略，查询其大小将返回零。

我意识到您对数组进行了合理的分配，但是在那之后它们会发生什么事情吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T12:16:16.977

您是否在 //end 附近放置了一个断点并检查了该数组是否为 nil？************`**