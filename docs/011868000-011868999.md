# StackOverflow 问答 11868000-11868999

# python - numpy.searchsorted 有多个来源

> ID：11868001
> 
> 赞同：4
> 
> 时间：2012-08-08T15:29:36.383
> 
> 标签：python, numpy

假设我有两个数组形式

```
a = [0, 0, 1, 1, 2, 3, 3, 3, 4, 4, 5, 6]
b = [1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 1] 
```

如您所见，上述数组在考虑时`a`作为`b`超级数组的列进行了排序。

现在，我想对这个数组进行搜索排序。例如，如果我搜索 (3, 7)（a = 3 和 b = 7），我应该得到 6。

每当 中存在重复值时`a`，搜索应继续使用 中的值`b`。

是否有内置的 numpy 方法可以做到这一点？或者假设我的数组中有数百万个条目，那么有效的方法是什么。

我尝试使用 numpy.recarray，使用 and 创建一个 recarray`a`并`b`尝试在其中搜索，但出现以下错误。

```
TypeError: expected a readable buffer object 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:06:25.837

您可以使用`searchsorted`从左到右重复的：

```
left, right = np.searchsorted(a, 3, side='left'), np.searchsorted(a, 3, side='right')
index = left + np.searchsorted(b[left:right], 7) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T16:28:42.530

您快到了。只是`numpy.record`（鉴于您收到的错误消息，这是我假设您使用的）并不是您真正想要的；只需创建一个单项记录数组：

```
>>> a_b = numpy.rec.fromarrays((a, b))
>>> a_b
rec.array([(0, 1), (0, 2), (1, 1), (1, 2), (2, 1), (3, 4), (3, 7), (3, 9),
       (4, 4), (4, 8), (5, 1), (6, 1)], 
      dtype=[('f0', '<i8'), ('f1', '<i8')])
>>> numpy.searchsorted(a_b, numpy.array((3, 7), dtype=a_b.dtype))
6 
```

`sort`了解这一点并按词法对记录数组进行排序也可能很有用`argsort`，还有[lexsort](http://docs.scipy.org/doc/numpy/reference/generated/numpy.lexsort.html)。使用示例`lexsort`：

```
>>> random_idx = numpy.random.permutation(range(12))
>>> a = numpy.array(a)[random_idx]
>>> b = numpy.array(b)[random_idx]
>>> sorted_idx = numpy.lexsort((b, a))
>>> a[sorted_idx]
array([0, 0, 1, 1, 2, 3, 3, 3, 4, 4, 5, 6])
>>> b[sorted_idx]
array([1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 1]) 
```

排序记录数组：

```
>>> a_b = numpy.rec.fromarrays((a, b))
>>> a_b[a_b.argsort()]
rec.array([(0, 1), (0, 2), (1, 1), (1, 2), (2, 1), (3, 4), (3, 7), (3, 9),
       (4, 4), (4, 8), (5, 1), (6, 1)], 
      dtype=[('f0', '<i8'), ('f1', '<i8')])
>>> a_b.sort()
>>> a_b
rec.array([(0, 1), (0, 2), (1, 1), (1, 2), (2, 1), (3, 4), (3, 7), (3, 9),
       (4, 4), (4, 8), (5, 1), (6, 1)], 
      dtype=[('f0', '<i8'), ('f1', '<i8')]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T17:29:52.303

这对我有用：

```
>>> a = [0, 0, 1, 1, 2, 3, 3, 3, 4, 4, 5, 6]
>>> b = [1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 1]
>>> Z = numpy.array(zip(a, b), dtype=[('a','int'), ('b','int')])
>>> Z.searchsorted(numpy.asarray((3,7), dtype=Z.dtype))
6 
```

我认为诀窍可能是确保 searchsorted 的参数与数组具有相同的 dtype。当我尝试时，`Z.searchsorted((3, 7))`我得到一个段错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T16:10:31.003

n 数组扩展：

```
import numpy as np

def searchsorted_multi(*args):
    v = args[-1]
    if len(v) != len(args[:-1]):
        raise ValueError
    l, r = 0, len(args[0])
    ind = 0
    for vi, ai in zip(v, args[:-1]):
        l, r = [np.searchsorted(ai[l:r], vi, side) for side in ('left', 'right')]
        ind += l
    return ind

if __name__ == "__main__":
    a = [0, 0, 1, 1, 2, 3, 3, 3, 4, 4, 5, 6]
    b = [1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 1]
    c = [1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 2]

    assert(searchsorted_multi(a, b, (3, 7)) == 6)
    assert(searchsorted_multi(a, b, (3, 0)) == 5)
    assert(searchsorted_multi(a, b, c, (6, 1, 2)) == 12) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T16:27:56.197

这是一种有趣的方法（尽管它不是最有效的方法，因为我相信它是 O(n) 而不是 O(log(n))，因为 ecatmur 的答案是；但是，它更紧凑）：

```
np.searchsorted(a + 1j*b, a_val + 1j*b_val) 
```

例子：

```
>>> a = np.array([0, 0, 1, 1, 2, 3, 3, 3, 4, 4, 5, 6])
>>> b = np.array([1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 1])
>>> np.searchsorted(a + 1j*b, 4 + 1j*8)
9 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-08T16:42:52.760

或者没有 numpy：

```
>>> import bisect
>>> a = [0, 0, 1, 1, 2, 3, 3, 3, 4, 4, 5, 6]
>>> b = [1, 2, 1, 2, 1, 4, 7, 9, 4, 8, 1, 1]
>>> bisect.bisect_left(zip(a,b), (3,7))
6 
```

# process - 操作系统进程和正常进程之间的区别？

> ID：11868004
> 
> 赞同：0
> 
> 时间：2012-08-08T15:29:49.723
> 
> 标签：process, operating-system

在我的理解中，一个过程是，

“一个操作系统级别的概念，用于描述一组资源（例如外部代码库和主线程）以及正在运行的应用程序使用的必要内存分配。对于加载到内存中的每个 *.exe，操作系统会创建一个单独的和在其生命周期内使用的隔离过程。” -Andrew troelsen (pro c# 2010)

所以每次我们启动一个应用程序时，都会创建一个进程，它有自己的地址空间，不能被其他进程共享。

最近我通过 c# 在 clr 中读到了，

“事实上，CLR 确实提供了在单个操作系统进程中执行多个托管应用程序的能力。每个托管应用程序都在一个 AppDomain 中执行。”

这表示多个应用程序可以在单个操作系统进程中运行，操作系统进程与我们运行应用程序时启动的进程之间有区别吗？？？

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:42:55.560

不同的是，主运行进程由操作系统管理。CLR/Framework 提供了一个完全不同的堆栈，称为“应用程序域”，它允许程序的单独运行实例在同一系统级进程下执行，但充当完全独立的进程。作为 C#/.NET 设计模型方面的专家，除了大型系统的可扩展性之外，我无法举一个例子来说明这可能有用的地方。

# jquery - jQuery 和父 div 的 IE7 z-index 问题（可能的堆叠上下文问题）

> ID：11868011
> 
> 赞同：0
> 
> 时间：2012-08-08T15:30:02.247
> 
> 标签：jquery, html, css, internet-explorer-7, z-index

我今天一直在努力解决 IE7 z-index 问题，但我无法深入了解它。我下面的代码显示了一个自定义样式的下拉菜单，它位于一个名为 div 的上方`wrapper_bottom_outer`，在 IE7 以外的所有其他浏览器上，该代码都可以在`wrapper_bottom_outer`. 但是，只有在 IE7 上才会`select`/`dropdown`显示在div*后面。*`wrapper_bottom_outer`

我今天已经[阅读了](http://brenelz.com/blog/squish-the-internet-explorer-z-index-bug/)开发人员在使用 IE7 和 z-indexing 时遇到的问题，我今天肯定也遇到了这些问题。

我有什么明显的遗漏吗？问题归结为堆叠上下文吗？如果是这样，我该如何解决？

```
<div class="select" style="width: 127px;">
    <dl class="dropdown" style="z-index: 2060; width: 127px;">
        ...content in here...
    </dl>
</div>

<div id="wrapper_bottom_outer" style="z-index: 10;">    
    ...content in here...
    <div id="wrapper_bottom"></div>
</div>

#wrapper_bottom_outer {
    height: 195px;
    overflow: visible;
    position: relative;
}

.dropdown {
    position: relative;
    height: 18px;
    float: left;
    font-size: 11px;
    line-height: 12px;
 }

.select {
    position: relative;
}

$("#wrapper_bottom").mouseenter(function(){ 
    $(".select").css('zIndex', '1000');     
    $(".dropdown").css('zIndex', '1001');
    $("#wrapper_bottom_outer").css('zIndex', '1002');
});

$("#wrapper_bottom").mouseleave(function(){
        $(".select").css('zIndex', '2059');
    $(".dropdown").css('zIndex', '2060');
    $("#wrapper_bottom_outer").css('zIndex', '10');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:33:50.127

当您使用 Z-index 时，您必须记住 z-index 仅适用于某些位置：相对、绝对和固定。

此外，除了在要定位的实际元素上设置 z-index 之外，您还必须将 z-index 添加到其父元素。

试一试，现在让我们看看它是如何工作的。如果它不创建 jsfiddle 会有很大帮助：http: [//jsfiddle.net/](http://jsfiddle.net/)

# android - 4x4 应用小部件在平板电脑上被检测为 3x3

> ID：11868015
> 
> 赞同：4
> 
> 时间：2012-08-08T15:30:08.367
> 
> 标签：android, tablet, android-appwidget

我创建了一个 4x4 appwidget，其 minWidth 和 minHeight 设置为“250dp”，正如 App Widget Design Guidelines 中所建议的那样：

[http://developer.android.com/guide/practices/ui_guidelines/widget_design.html](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html)

在我尝试过的每部手机和手机大小的模拟器上都可以，但是如果我在平板电脑（Xoom 或 Nexus 7）或模拟器（分辨率：1280x752，dpi 160）上测试它，那么启动器会将其检测为 3x3 小部件。

我究竟做错了什么？

谢谢， 塔马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T01:53:58.480

尝试`grid size = (74*n) - 2`较旧的 api 级别。该值来自旧文档。

# html - 需要 CSS 帮助

> ID：11868016
> 
> 赞同：0
> 
> 时间：2012-08-08T15:30:08.330
> 
> 标签：html, css, visual-studio-2010, dynamic, user-interface

我需要样式表的帮助。我有一个 div 有：

```
Header text with underline, 
icon
link but 
```

吨与描述文本。

所有都是单独的控件。

附加图像中的“1”是我目前得到的用户界面，“2”是我想要的。

第二个模块动态生成并覆盖第一个 div 的文本。哪个属性可用于修复此行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:31:01.640

您需要将`clear:both`标题添加到 CSS 中`<div>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:44:02.507

我建议使用 Nicolas Gallagher 的 clearfix hack 来获得对 IE6 的跨浏览器支持：

[http://nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)

这是代码：

```
.cf:before,
.cf:after {
  content: " "; /* 1 */
  display: table; /* 2 */
}

.cf:after {
  clear: both;
}

/**
  * For IE 6/7 only
  * Include this rule to trigger hasLayout and contain floats.
*/
.cf {
  *zoom: 1;
} 
```

将`cf`课程应用于您的第一个`div`.

# windows-7 - 运行 Cygwin 命令时“无法使 stderr 与 stdout 不同”

> ID：11868017
> 
> 赞同：14
> 
> 时间：2012-08-08T15:30:08.683
> 
> 标签：windows-7, cygwin, stdout, stderr

我正在尝试在我的 Windows 7 x64 操作系统上设置一些旧版本的 Cygwin。到现在为止还挺好。现在我陷入了 srdout/stderr 区分问题：

```
$ vmake
  1 [main] make 7060 dtable::stdio_init: couldn't make stderr distinct from stdout

$ ls /
  1 [main] ls 8180 dtable::stdio_init: couldn't make stderr distinct from stdout
Cygwin.bat  Cygwin.ico  bin  cygdrive  etc  lib  proc  setup.log  setup.log.full  tmp  usr  var 
```

我在跑步：

```
$ uname -srv
  1 [main] uname 5876 dtable::stdio_init: couldn't make stderr distinct from stdout
CYGWIN_NT-6.1-WOW64 1.5.25(0.156/4/2) 2008-06-12 19:34 
```

Cygwin 安装选择了 DOS 行尾选项（为了某些遗留代码兼容性）。

要解决行尾的另一个问题（bash 在处理 /cygdrive/c/cygwin-legacy/bin/vmake 脚本时遇到问题，就像这里描述的问题：http: [//chess.eecs.berkeley.edu/softdevel/faq/5.html](http://chess.eecs.berkeley.edu/softdevel/faq/5.html) ) 我已将这些添加到 ~/.bash_profile：

```
export SHELLOPTS
set -o igncr 
```

阅读[http://lists-archives.com/cygwin/50369-run-requires-cygwin-tty.html](http://lists-archives.com/cygwin/50369-run-requires-cygwin-tty.html)后，我还设置了：

```
$ CYGWIN=tty 
```

这没有任何改变。我还在

```
1 [main] make 7060 dtable::stdio_init: couldn't make stderr distinct from stdout 
```

每次使用不同的 4 位数字。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-18T13:07:07.993

我在这里遇到了同样的问题。然后我记得，我们用 MSYS 版本替换了“make”命令（因为新 cygwin 包的“make”没有处理任何带有冒号（“：”）的路径 -> 这导致“多目标”错误.

'make' 命令的替换解决了这个问题，但在我尝试编译其他项目时导致“stdio_init：无法使 stderr 与 stdout 不同”。

所以：

你的机器上也安装了 MSYS/MinGW 吗？

试试这个：

`make --version`

它应该看起来像：

```
GNU Make 3.82.90
Built for i686-pc-cygwin 
```

如果你得到类似的东西：

```
GNU Make 3.81
Copyright (C) 2006  Free Software Foundation, Inc.
This is free software; see the source for copying conditions.
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.

This program built for i686-pc-msys 
```

您需要改用 cygwin 'make'。

如果您混合了不同 cygwin 版本的组件，可能会出现此错误...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-07T09:44:28.303

对于使用其他二进制文件（如 ssh）时遇到此问题的人的一点说明。我有这个错误，因为 cygwin 试图运行 windows ssh 客户端而不是 cygwin 中的版本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-10T00:31:54.360

### 检查可执行文件是否为 cygwin 版本

尝试从 cygwin中启动[Msys可执行文件时出现此错误。](http://www.mingw.org/wiki/MSYS)Msys 是另一个 'linux on windows' 环境，与 cygwin 不兼容。

具体来说，我试图通过 /bin 路径中的符号链接[为 Windows 启动 Git 。](http://git-scm.com/download/win)我显然在很久以前就安装了它并创建了符号链接，直到我尝试使用`git gui`它然后抛出`couldn't make stderr distinct from stdout`错误才发现任何问题。有趣的是，许多 git 命令正常工作，或者静默失败，因此不会立即引起注意。

当 cygwin 尝试启动用于 Msys 环境的程序时，它会抛出错误。

**要修复它**，请下载问题应用程序的 cygwin 版本，并删除您现有的任何指向 Windows 版本的符号链接。

对于 Git 案例：

*   我删除了 /bin/git 符号链接
*   重新运行 cygwin setup 并安装了 git（cygwin 版本）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T10:32:28.787

[这](http://cygwin.com/ml/cygwin/2009-10/msg00372.html)帮助了我：

> 请尝试使用 Cygwin 1.7 beta 测试版：
> 
> [http://cygwin.com/#beta-test](http://cygwin.com/#beta-test)
> 
> Windows 7 并不真正支持 Cygwin 1.5.25。只有 Cygwin 1.7 对其进行了测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-13T03:23:22.043

从我的路径中删除 C:\DevKit\bin 使我的问题消失了。

# javascript - 如何以用户友好的方式将画布转换的图像保存在计算机上？

> ID：11868018
> 
> 赞同：0
> 
> 时间：2012-08-08T15:30:11.367
> 
> 标签：javascript, canvas, mime-types

我正在使用 Nihilogic 的库*Canvas2Image*将画布绘图转换为 PNG，并让我的应用程序的用户能够下载该图像。

我需要的是能够给可下载文件一个名称和*png*扩展名（例如“goalboard.png”），而不是像八位字节流一样下载，没有可识别的扩展名和名称“下载”，因为平均乔不知道如何处理这样的文件。我需要在客户端执行此操作，因为根据其中的数据量，将该字节流发送到服务器可能需要长达 20 秒（这是一个大画布！）。更不用说事后检索图像了......

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:51:18.510

其中之一应该可以解决您的问题（使用画布，您可以提取 base64 格式的图像）：

*   [使用 HTML5/Javascript 生成和保存文件](https://stackoverflow.com/questions/2897619/using-html5-javascript-to-generate-and-save-a-file)
*   [读取本地文件，编码为base64，我想给用户一个选项来将结果保存到文件](https://stackoverflow.com/questions/11824378/reading-a-local-file-encoding-to-base64-i-would-like-to-give-the-user-an-optio)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-18T11:04:15.520

我也有一个很大的 RaphaelJs 画布，需要允许用户运行一个脚本，将大量画布保存为 png 图像。我试图将我的 raphael 转换为 svn，然后将我的 svg 转换为 png，然后使用 wget 但这当然不起作用，因为我的画布由 javascript 和 wget 生成无法处理。最后我意识到我可以让我的 webapp 只用 svg 画布构建一个页面，并使用 phantomjs（一个无头浏览器）将它保存为 png。它工作得很好。

它是如此简单。1.让你的webapp只用svg画布构建一个页面。2\. 使用以下代码创建一个 svgToPgn.js 文件：

> var page = require('webpage').create(); page.open('URL_TO_YOUR_HTML_PAGE', function() { page.render('PATH_TO_PNG/example.png'); phantom.exit(); }); 3\. 下载 Phantom ( [http://phantomjs.org](http://phantomjs.org) )，解压缩，在 bin 目录下你会找到 phantomjs 可执行文件。运行：./phantomjs svgToPgn.js 您的 png 文件将保存在：PATH_TO_PNG/example.png

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:33:29.710

> 我需要在客户端执行此操作

好吧，这种要求会扼杀你的机会。对不起。

你不能做你想做的事，你所拥有的最好的就是显示图像并告诉用户右键单击另存为。

# iphone - 更新位于网络上的 xml 上的值

> ID：11868020
> 
> 赞同：0
> 
> 时间：2012-08-08T15:30:21.123
> 
> 标签：iphone, objective-c, xcode

我在网上有一个文件，看起来像这样。我想将值更新为 1 标签让我们说“tempset”并将 150 更改为另一个数字。我怎样才能做到这一点？NSURL连接？NSMutableURL 请求？NSURL请求？如果可能的话，保持在 iOs 4 上！谢谢！

```
<Courbe>
<age>45</age>
<tempdesi>150</tempdesi>
<vmininit>35</vmininit>
<tempinit>220</tempinit>
<unittemp>0</unittemp><te_fin_c>220,700,700,700,700,700,700,700,700,700</te_fin_c>          <vm_fin_c>50,50,50,50,50,50,50,50,50,50</vm_fin_c>
<grfan_a>1,1,1,1,1,1,1,1,1,1</grfan_a>
<ecarnuit>0</ecarnuit>
<tempset>150</tempset>
<tempsetp>700</tempsetp>
<jo_cou_t>1</jo_cou_t>
<ty_stcha>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</ty_stcha>
</Courbe> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:43:31.530

你有几个选择：

*   为此创建一个“服务”，这是一种 API，因此您可以从您的客户端以不同的语言调用此服务，包括诸如[http://myserver.com/myobject/set?tempset=1](http://myserver.com/myobject/set?tempset=1)之类的 ObjectiveC （在现实世界中，使用 post 和没有得到这个）

    当然，要做到这一点，您需要用您喜欢的语言编写一些服务器部分

*   提供一种上传文件并完全替换它的方法，一种“upload.php”

哪种解决方案最好取决于您的问题：如何生成和维护此文件

# java - Unicode 字符在 Java JSON 解析中显示为问号

> ID：11868022
> 
> 赞同：6
> 
> 时间：2012-08-08T15:30:27.197
> 
> 标签：java, json, unicode

过去几天我一直在搜索这个，但我认为我找不到正确的指针。如果发现重复，请将其与适当的问题合并。

我对使用 JSON 非常陌生，作为我的一个项目的一部分，我需要解码 JSON 文件并对其进行进一步处理。但是，当我尝试使用 Json-simple 库进行解码时，我在解析的对象中得到了一些奇怪的问号，而不是实际的字符。示例代码如下所示：

```
String str = "{\"alias\": [\"Evr\u00f3pa\", \"\u05d0\u05d9\u05e8\u05d5\u05e4\"]}";
JSONParser parser = new JSONParser(); 
JSONObject jsonObject = (JSONObject)parser.parse(str);

System.out.println(jsonObject) gives {"alias":["Evrópa","?????"]} 
```

我也尝试使用 Json-lib，结果相同。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T16:24:28.850

问题不在于您的 JSON，而在于您的 System.out.println()。这些字符不能在终端（或 IDE，如果您在其中运行它）或 System.out 在您的环境中使用的编码的字符编码中表示。

文件不能包含 Unicode 字符。文件是*字节*流，但 Unicode*字符*的大小是多个字节（通常是两个）。这是字符编码变得相关的地方。Unicode 字符必须转换为字节序列才能将它们写入文件（包括 System.out）。Unicode 字符最常用的编码之一是 UTF-8。软件程序员的诀窍是在字节和字符之间转换时始终使用正确的字符编码。在一个地方缺少正确的编码，例如在调试 println() 调用中，将给出错误和误导性的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:16:26.940

您可能正在使用不支持特殊字符组的默认字符集。尝试使用 UTF-8 作为您的字符集，如下所示：

```
String str = "{\"alias\": [\"Evr\u00f3pa\", \"\u05d0\u05d9\u05e8\u05d5\u05e4\"]}";
InputStreamReader isr = new InputStreamReader(new ByteArrayInputStream(str.getBytes(Charset.forName("UTF-8"))), Charset.forName("UTF-8"));
JSONParser parser = new JSONParser(); 
JSONObject jsonObject = (JSONObject)parser.parse(isr); 
```

# google-apps-script - 如何访问 Google Apps 脚本中的 HTTP GET 变量？

> ID：11868023
> 
> 赞同：0
> 
> 时间：2012-08-08T15:30:28.630
> 
> 标签：google-apps-script

我正在尝试访问 Google Apps 脚本中的 HTTP GET 变量（如 PHPs $_GET）。我尝试了几种技术：

*   纯 java 脚本（window.location），显然不支持

*   Google 通过 SitesApp.getActivePage().getUrl() 拥有自己的服务。给我 URL，但没有变量字符串。转念一想，这可能是有道理的。

*   e.parameter.[key] 这给了我以下错误：TypeError：无法从未定义中读取属性“参数”。

我真的很感激一些指针或一个工作示例，谢谢。

根据斯里克的评论，我尝试了以下方法：

```
function doGet(e) { 
    UserProperties.setProperty("bottleid", e.parameter.id);
    return HtmlService.createTemplateFromFile('showbottledata').evaluate();
} 
```

这给了我提到的TypeError：无法从未定义中读取属性“参数”。（第 2 行）错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:52:49.973

首先，您需要以接受 URL 参数的方式定义 doGet

```
function doGet(e) {
   ....
} 
```

当您使用 URL 参数调用 URL 时，例如 parm1=val1，请使用

```
var parm1 = e.parameter.parm1 ; 
```

# iphone - 如何在ios中加粗按钮文本？

> ID：11868024
> 
> 赞同：4
> 
> 时间：2012-08-08T15:30:31.163
> 
> 标签：iphone, ios, ios5, fonts

在我的应用程序中，我使用的是自定义字体，效果很好。但我需要按钮文本为粗体。我用谷歌搜索它只有系统字体。

**代码**

```
button.titleLabel.font = [UIFont fontWithName:@"YanaR" size:20.0]; 
```

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T09:44:46.940

在 fontWithName 之后，你必须使用 boldSystemFontOfSize：

```
[button.titleLabel setFont:[UIFont fontWithName:@"Arial" size:13.f]];
[button.titleLabel setFont:[UIFont boldSystemFontOfSize:13.f]]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T15:34:54.820

那是因为字体不会神奇地使自己变粗。粗体字体是单独设计的。恐怕这个问题没有答案，除了加粗线条的笔触，这可能违反了你的字体协议。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T15:40:22.040

如果可用，您还需要包含您正在使用的字体的粗体版本。这是一个完全独立的字体。如果它可用，则在包含它之后，以您尝试的相同方式设置它，但使用粗体字体名称。

例如：

```
button.titleLabel.font = [UIFont fontWithName:@"YanaR-Bold" size:20.0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-04T17:00:42.500

您始终可以为您的按钮创建正常和选定状态图像，并使用它们来创建您想要实现的外观。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T15:41:13.593

不确定 YanaR 字体，但如果您考虑 Helvetica 字体并且只想将字体设置为纯 Helvetica，您可以：

```
buttonTitleLabel.font = [UIFont fontWithName:@"Helvetica" size:20.0]; 
```

为了使字体加粗，您只需将 -Bold 附加到字体名称的末尾，如下所示：

```
buttonTitleLabel.font = [UIFont fontWithName:@"Helvetica-Bold" size:20.0]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-12T06:52:32.550

**在斯威夫特 5**

```
button.titleLabel?.font = UIFont.boldSystemFont(ofSize: 18) 
```

# asp.net - 如何禁用 RadNumeric 文本框，但使用旋转按钮？

> ID：11868025
> 
> 赞同：1
> 
> 时间：2012-08-08T15:30:33.400
> 
> 标签：asp.net, textbox, telerik

我有一个 Telerik RadNumericTextBox，它有旋转按钮来增加/减少值。我想阻止用户输入他们自己的输入并且只使用旋转按钮。当我尝试禁用文本框或将其设为只读时，按钮也会被禁用。是否可以保持按钮功能并使文本框仅用于显示？

我需要此控件的某些属性，因此继续使用 Telerk RadNumericTextBox 比使用其他控件更方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:16:16.533

```
$telerik.$($find("Numeric1").get_element())
.focusin(function(){ this.readOnly = true; })
.focusout(function(){ this.readOnly = false; }); 
```

在此页面上工作[http://demos.telerik.com/aspnet-ajax/input/examples/radnumerictextbox/firstlook/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/input/examples/radnumerictextbox/firstlook/defaultcs.aspx)

# php - 未在 wordpress 启动页面实现上设置 PHP setcookie 函数

> ID：11868032
> 
> 赞同：1
> 
> 时间：2012-08-08T15:30:59.020
> 
> 标签：php, wordpress, cookies

所以我正在尝试在 wordpress 网站上实现一个启动页面。我环顾四周并阅读了有关如何使用 PHP 进行操作的信息。启动页面的想法是将尚未查看该网站的人重定向到鼓励他们捐赠的启动页面。该页面已经设置为我正在制作启动页面的静态主页。这里提供的是我为 cookie 提供的代码，由于某种原因，当我进入我的 chrome 设置并检查是否正在写入 cookie 时，它​​没有显示出来。

```
<?php
  if((strpos($_SERVER['HTTP_REFERER'], get_bloginfo('home')) === false)  && !$_SERVER['QUERY_STRING'] && $_COOKIE["CookieName"] != 'true') :
  setcookie("CookieName", 'true', time() + 3600*24*15, "/~user/");
?>
//splash page code
<?php else : ?> //theme code <?php endif; ?> 
```

else 条件是主题创建的主页的信息。该站点的 URL 格式为`siteIP/~user/`. 如果你们有一些反馈，将不胜感激。另外，如果您可以提供一个来源，以便我可以阅读它，那也将不胜感激。谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:58:30.843

很抱歉发布答案，但我无法发表评论，因为我没有代表。

除了查看上面的注释之外，尝试简化 - 检查 if 语句是否正在执行，然后你就会知道你的 cookie 设置是否有错误。

此外，您引用的代码没有结束语句，我假设您在实际页面中有它，但我想我会提到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:53:10.050

它不起作用的原因是因为有一个文件覆盖了启动页面本身，因此启动页面上的代码一开始就没有被调用。这只是命名文件的问题，这样它就不会有任何其他文件覆盖您放置在那里的内容。

# java - 从只读文件夹启动时，Eclipse RCP 应用程序失败

> ID：11868041
> 
> 赞同：1
> 
> 时间：2012-08-08T15:31:50.673
> 
> 标签：java, eclipse-rcp

当我导出我的 Eclipse 应用程序并将其放在只读文件夹中时，它会失败并导致以下异常：

```
Caused by: java.lang.ClassNotFoundException: org.caleydo.core.data.perspective.table.TablePerspective
    at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:513)
    at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:429)
    at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417)
    at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    ... 91 more 
```

根据此帮助页面 [1]，无需阅读权限即可开始工作。

我刚刚重构了似乎是造成这种情况的 Class TablePerspective，但是，我不明白为什么它应该与 rw 而不是 r 权限一起使用。包含该类的包已正确导出。

这很烦人，因为我无法使用将应用程序放置在只读目录中的 linux 包或 Windows 安装程序来部署应用程序。

[1] [http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fmisc%2Fmulti_user_installs.html](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fmisc%2Fmulti_user_installs.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T08:44:38.840

解决方案是删除我用户本地 .eclipse 文件夹中的缓存。它似乎包含重构之前的内容并且没有更新。只需删除 .eclipse 文件夹就可以了。

# javascript - 当我通过ajax发送对象的方法时，我从来没有调用过它？

> ID：11868043
> 
> 赞同：1
> 
> 时间：2012-08-08T15:31:56.193
> 
> 标签：javascript, jquery

我有一个名为 的简单对象`Entry`，直到最近它才具有一些基本属性。在某些事件期间，我将对这些对象执行 REST 操作，以使用 C# 代码中的 API。直到最近，这还不错。我会使用我的小请求服务将这些对象 POST 或 PUT 到 AJAX 请求的主体中，结果如下：

```
$.ajax(url, 
{
    type:method,
    headers:headers,
    data:options.data, //there is an instance of Entry in options.data
    timeout: this.timeoutLength
}); 
```

最近我在Entry中添加了一个功能。

```
function Entry(foo, bar){
    this.foo = foo;
    this.bar = bar;
    this.doStuff = function(){ ... } //added this code
} 
```

我添加了该功能，但再次质疑其使用背后的用户故事，因此我切换回浏览器，刷新并运行了更多测试。无需在任何地方*调用*该函数`doStuff`，就可以看到它的效果。

我`doStuff`用一个简单的警报替换了 's body，果然，每次我在幕后使用 Entry 对象调用 AJAX 请求时，我都会收到警报消息。为什么会发生这种情况？为什么`doStuff`在没有我告诉的情况下被调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:31:56.193

编辑：tldr；Ajax 在序列化对象时调用对象中的任何函数。如果你关心为什么，请继续阅读：

这让我有点发疯，直到我设法向后跟踪堆栈跟踪。似乎该函数`doStuff` *被*jquery-1.7.1.js 调用`$.ajax`。但为什么？

有问题的对象，这里的“条目”，必须序列化为查询字符串，以便通过网络发送。这样做时，它会遍历对象的每个属性。

首先，（对我来说在第 7610 行）它检查对象是否`isPlainObject`. 以前可能是这样，但是拥有一个功能不再是这样。相反，它执行以下操作：

```
jQuery.each( a, function() {
    add( this.name, this.value );
}); 
```

它在稍早之前定义了 add ，如下所示：

```
add = function( key, value ) {
    // If value is a function, invoke it and return its value
    value = jQuery.isFunction( value ) ? value() : value;
    s[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );
}; 
```

请注意 jQuery 亲切地为我们提供的评论。它遍历对象的*每个*属性，如果一个是函数，它使用函数的返回值作为“键/值”对的“值”。它在`doStuff`这里调用以获取一个值（当然返回`undefined`，因为该函数只是调用了一个警报）

为了我自己，我将补充一点，文档并没有真正明确这一点。我一直认为它忽略了功能，但最好不要说它**肯定不会**。

> **数据** （*对象，字符串*）
> 
> 要发送到服务器的数据。如果还不是字符串，则将其转换为查询字符串。它附加到 GET 请求的 url。请参阅 processData 选项以防止此自动处理。对象必须是键/值对。如果 value 是一个数组，jQuery 会根据传统设置的值（如下所述）序列化具有相同键的多个值。

最后，通过一个简单的测试（不是完整阅读代码），似乎`JSON.stringify` *确实*完全忽略了函数。

# algorithm - 给定一个递增的多项式，如何有效地找到 y 的固定区间的 x 值？

> ID：11868049
> 
> 赞同：2
> 
> 时间：2012-08-08T15:32:16.187
> 
> 标签：algorithm, math

**问题：给定一个***n*次多项式（系数*从 a* [0]到*a* [n-1]），保证从*x* = 0 增加到*x* [max]，找到前*m*个等距*y*点的最有效算法是什么值（即*y* [i] - *y* [i-1] == *c*，对于所有*i*）？

**示例：**如果我希望间距为*c* = 1，并且我的多项式为`f(x) = x^2`，那么前三个点将位于*y* =1 ( *x* =1)、*y* =2 ( *x* ~=1.4142) 和*y* =3 ( *x* ~=1.7321)。

* * *

我不确定它是否重要，但我的具体问题涉及具有给定系数的多项式的*立方*。我的直觉告诉我，最有效的解决方案应该是一样的，但我不确定。

我正在解决 ACM为 2012 年世界总决赛[设置的问题](http://home.a-eskwadraat.nl/~kink/icpc2012.pdf)（问题 B）中的问题，所以这主要是因为我很好奇。

* * *

**编辑：**我不确定这是否应该出现在[Math SE](https://math.stackexchange.com/)上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:56:08.493

您可以使用二进制搜索找到给定 Y 的 X。它是对数时间复杂度，与 x 值范围的大小成正比，除以您的误差容限。

```
def solveForX(polyFunc, minX, maxX, y, epsilon):
    midX = (minX + maxX) / 2.0
    if abs(polyFunc(midX) - y) < epsilon:
        return midX
    if polyFunc(midX) > y:
        return solveForX(polyFunc, minX, midX, y, epsilon)
    else:
        return solveForX(polyFunc, midX, maxX, y, epsilon)

print solveForX(lambda x: x*x, 0, 100, 2, 0.01) 
```

输出：

```
1.416015625 
```

编辑：在评论中扩展一个想法，如果你知道你将搜索多个 X 值，可以缩小 [minX, maxX] 搜索范围。

```
def solveForManyXs(polyFunc, minX, maxX, ys, epsilon):
    if len(ys) == 0:
        return []
    midIdx = len(ys) / 2
    midY = ys[midIdx]
    midX = solveForX(polyFunc, minX, maxX, midY, epsilon)
    lowYs = ys[:midIdx]
    highYs = ys[midIdx+1:]
    return solveForManyXs(polyFunc, minX, midX, lowYs, epsilon) + \
    [midX] + \
    solveForManyXs(polyFunc, midX, maxX, highYs, epsilon)

ys = [1, 2, 3]
print solveForManyXs(lambda x: x*x, 0, 100, ys, 0.01) 
```

输出：

```
[1.0000884532928467, 1.41448974609375, 1.7318960977718234] 
```

# jquery - 带有序列化和数据数组的 jQuery post()

> ID：11868051
> 
> 赞同：5
> 
> 时间：2012-08-08T15:32:20.800
> 
> 标签：jquery, jquery-post

**我无法在 mvc 3 中发布期间获得收藏价值。它返回 null。**

```
$.post("/Work/Post", { vm: $('#myForm').serializeArray(), 'collection': ['a', 'b', 'c'] });

//Or

var data = $('#myForm').serializeArray();
data.push({ name: 'collection', value: ['a', 'b', 'c'] });
$.post("/Work/Post", data);

//Or

var data = $('#myForm').serializeArray();
data.push({ name: 'collection[]', value: ['a', 'b', 'c'] });
$.post("/Work/Post", data); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T15:48:08.720

传递数组时我遇到了类似的问题。

而不是使用`$.post`use`$.ajax`并设置`traditional`选项 = `true`...

```
$.ajax({
    type: "POST",
    url: "Work/",
    traditional: true,
    data: { collection: ['a','b','c'] }
}); 
```

选项`traditional: true`很重要

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T15:48:33.360

几个月来，我用常规的 .ajax() 调用将我的头撞在墙上。

我最终发现你需要`traditional: true`在 $.ajax() 的参数列表中进行设置。（请参阅此处的“传统”标题：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)）

由于没有 $.post() 的参数列表，我不确定您是否可以使用 $.post() 执行此操作。但是使用 $.ajax() 的代码并不多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-09T07:36:48.780

```
 var model = $('#myForm').serializeArray();

                $.map(['a', 'b', 'c'], function (val, i) {
                    return model.push({ "name": "collection[" + i + "]", "value": val });
                });

                $.post("/Work/Post", model);
                //OR
                $.post("/Work/Post", model, function (data) {
                    //After Success
                }); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-04-17T18:54:29.607

以下对我有用。您可以如下使用~~serializeArray()~~ serializeJSON() 并将其设置为数据元素。观察**formData**变量。

```
var formData = $('#inputForm').serializeJSON();
$.ajax({
    type : "POST",
    url: server_side_url,
    cache:false,
    traditional: true,
    data: formData,
    dataType: "json",
    success: function(data, textStatus, jqXHR){
        console.log("successfully processed.");
    },
    error: function(xhr,status,error){
        console.log("error occurred.");
    }
}); 
```

# jquery - 如何在使用 TBODY 对单元进行分组时使用 ROWSPAN？

> ID：11868053
> 
> 赞同：0
> 
> 时间：2012-08-08T15:32:26.927
> 
> 标签：jquery, html-table

我正在使用 JQuery 为表中的一部分行切换 slideDown 和 slideUp。为了对这些行进行分组，我使用了 tbody。Tbody 是迄今为止对我有用的唯一分组方式。不幸的是，将这些行包装在一个 tbody 中使得行跨度不再影响这些行并且对我的表格的布局产生了不利影响。有什么方法可以同时使用 rowspan 和 tbody 或者使用不同的跨越/分组行的方法？

jQuery

```
$(document).ready(function() {   
$('.parent').click(function() {
    if($(this).next().is(':hidden') == true) {
        $(this).addClass('on');
        $(this).next().slideDown('normal');
     }else{
        $(this).removeClass('on');
        $(this).next().slideUp('normal');
     }    
    });   
   $('.child').hide();
}); 
```

表（在 php 内）

```
echo '<table border="1" style="width: 330px;">';

echo '<tr style="width: 330px;">';
echo '<td colspan="3"><h1>'.highlight($search,$name).'</h1></td>';
echo '</tr>';

echo '<tr style="width: 100px; vertical-align: top;">';     
if($pic=='true'){
    if(empty($filename)){
        echo '<td rowspan="7" style="width: 100px; height: 130px;">
        <div style="width: 100px; height: 130px; overflow: hidden;">
        <img src="documents/hr_contacts/nophoto.jpg" alt="'.$name.'" height="100%" style="margin-left: -18px; margin-top: -1px;">
        </div>
        </td>';
    }else{
        if($width/$height<.769){
               echo '<td rowspan="7" style="width: 100px; height: 130px;">
               <div style="width: 100px; height: 130px; overflow: hidden;">
               <img src="documents/'.$tablename.'/'.$filename.'" alt="'.$name.'" width="100%"/>
                           </div>
               </td>';
            }else{
            echo '<td rowspan="7" style="width: 100px; height: 130px;">
            <div style="width: 100px; height: 130px; overflow: hidden;">
            <img src="documents/'.$tablename.'/'.$filename.'" alt="'.$name.'" height="100%" style="margin-left: -'.((((130/$height)*$width)-100)/2).'px;"/>
            </div>
            </td>';
        }
    }
}

echo '<td style="width: 90px;">Phone: </td>';
echo '<td style="width: 140px;">'.highlight($search,$phone).'</td>';
echo '</tr>';

echo '<tr style="width: 230px;">';
echo '<td style="width: 90px;">Email: </td>';
echo '<td style="width: 140px;"><a href="mailto:'.$email.'">'.highlight($search,$email).'</a></td>';
echo '</tr>';

   echo '<tbody class="parent">';       
echo '<tr style="width: 230px;">';
echo '<td colspan="2"><a href="#" onclick="return false;">Personal Contact Info</a></td>';
    echo '</tr>';
echo '</tbody>';

echo '<tbody id="test" class="child">';
if(!empty($cell)){
    echo '<tr style="width: 230px;">';
    echo '<td style="width: 90px;">Cell Phone: </td>';
    echo '<td style="width: 140px;">'.highlight($search,$cell).'</td>';
        echo '</tr>';
}

if(!empty($homePhone)){
    echo '<tr style="width: 230px;">';
    echo '<td style="width: 90px;">Home Phone: </td>';
    echo '<td style="width: 140px;">'.highlight($search,$homePhone).'</td>';
    echo '</tr>';
}

if(!empty($perEmail)){
    echo '<tr style="width: 230px;">';
    echo '<td style="width: 90px;">Personal Email: </td>';
    echo '<td style="width: 140px;"><a href="mailto:'.$email.'">'.highlight($search,$perEmail).'</a></td>';
    echo '</tr>';
}

if(!empty($address)){
     echo '<tr style="width: 230px;">';
    echo '<td style="width: 90px;">Address: </td>';
    echo '<td style="width: 140px;">'.highlight($search,$address).'</td>';
    echo '</tr>';
    echo '</table>';
}
echo '</tbody>';

echo '</table>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:38:03.320

如果您遇到问题并且正在使用 jQuery，那么使用 CSS 类来“分组”您的行而不是多个 tbody 标记可能会更简单 - 然后您可以通过 jQuery 选择器访问这些组。

```
$('.myRowClass').slideUp(); 
```

# matlab - 在交互图中重新定位 yTickLabels

> ID：11868058
> 
> 赞同：0
> 
> 时间：2012-08-08T15:32:53.813
> 
> 标签：matlab, plot, labels

我在 Matlab 中制作了一个交互图，但其中一部分在`yTickLabels`图的后面。例如，您只看到`10`而不是`10 x 10^-5`.

知道我该如何解决这个问题吗？

![http://i46.tinypic.com/t858ya.png](../Images/dd97f5eb27df1e96ff4795075ef60308.png)

原图：http: [//i46.tinypic.com/t858ya.png](http://i46.tinypic.com/t858ya.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T08:15:11.363

我找到并回答了。只有科学记数法块在其他图表后面，但这个块不能移动： [http ://www.mathworks.nl/support/solutions/en/data/1-4PKVQ9/index.html?product=ML&solution=1- 4PKVQ9](http://www.mathworks.nl/support/solutions/en/data/1-4PKVQ9/index.html?product=ML&solution=1-4PKVQ9)

所以最好的选择是编辑图表的标签。

# mysql - 一次增加整个 mysql 数据库中的 varchar 大小

> ID：11868059
> 
> 赞同：0
> 
> 时间：2012-08-08T15:32:56.273
> 
> 标签：mysql, django

我知道我们可以使用以下命令增加 varchar 的大小：

```
alter table TABLE_NAME modify COLUMN_NAME VARCHAR(1024) NOT NULL; 
```

假设我有 10 个表，每个表都有一个公共列，即 varchar，其名称为“title”。无论表名如何，我都可以执行任何查询，并且它会更新每个表中该字段的大小？

设想：

实际上我使用了一个`BaseModel`which is`Abstract`并且我的许多模型都继承了它自己。现在我在我的基础模型中将标题长度更新为 500。执行 Manage.py syncdb 不会反映这些更改。所以这就是为什么我需要上面的查询。

```
class TitleAndSlugModel(models.Model):
    title = models.CharField(max_length=500)
    slug = models.SlugField(null=True, blank=True, help_text="The part of the title that is used in the url") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:36:46.440

不，但如果只有 10 张左右的桌子，实际上并不难做到。

```
#!/bin/bash
{
  echo "USE some_database;"
  for table in TABLE1 TABLE2 ...
  do
    echo "alter table `$table` modify COLUMN_NAME VARCHAR(1024) NOT NULL;"
  done
} | mysql -h ... -u ... -p ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:43:34.467

您可以使用 information_schema 将 DDL 语句转储到 SQL 脚本中，然后获取脚本以执行它。假设您的列上没有任何字符集、排序规则或其他覆盖，您可以执行以下操作：

```
-- alter all varchar columns named title to be varchar(1024)
select concat('ALTER TABLE ',table_schema,'.',table_name,
' MODIFY COLUMN ',column_name,' VARCHAR(1024)',
if(IS_NULLABLE='YES',' NULL',' NOT NULL'),';"') as the_ddl 
into outfile '/tmp/modify_title_columns.sql'
from information_schema.columns 
where table_schema = '<your_schema>' 
and column_name = 'title'
and data_type = 'varchar';

\. /tmp/modify_title_columns.sql 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:58:31.213

我不会直接通过 SQL 执行此操作...而是在所有模型中更改它（例如 max_length=1024）并使用 South 进行迁移 --> [http://south.readthedocs.org/en/0.7.6 /tutorial/part1.html](http://south.readthedocs.org/en/0.7.6/tutorial/part1.html)

南方==可怕

此外，您可能需要将您的应用程序转换为使用 South --> [http://south.readthedocs.org/en/0.7.6/convertinganapp.html#converting-an-app](http://south.readthedocs.org/en/0.7.6/convertinganapp.html#converting-an-app)

等等等等

# java - Java：哈希函数

> ID：11868066
> 
> 赞同：3
> 
> 时间：2012-08-08T15:33:15.353
> 
> 标签：java, hash, hashcode

我想知道我们是否实现了我们自己的不使用二次幂长度哈希表的哈希图（初始容量和每当我们重新调整大小时），那么在这种情况下我们可以只使用对象的哈希码并直接修改总大小而不是使用散列函数来散列对象的哈希码？

例如

```
 public V put(K key, V value) {
         if (key == null)
             return putForNullKey(value);
         // int hash = hash(key.hashCode());     original way
         //can we just use the key's hashcode if our table length is not power-of-two ?
         int hash = key.hashCode();              
         int i = indexFor(hash, table.length);
         ...
         ...
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:37:43.053

假设我们谈论的是 OpenJDK 7，附加值[`hash`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/HashMap.java#HashMap.hash%28int%29)用于刺激雪崩；这是一个[*混合功能*](http://bretm.home.comcast.net/~bretm/hash/3.html)。使用它是因为从哈希到存储桶的映射函数，因为使用 2 的幂作为容量，只是按位`&`（因为`a % b`相当于`a & (b - 1)`iff`b`是 2 的幂）；这意味着低位是唯一重要的位，因此通过应用此混合步骤，它可以帮助防止更差的哈希值。

```
 static int hash(int h) {
     // This function ensures that hashCodes that differ only by
     // constant multiples at each bit position have a bounded
     // number of collisions (approximately 8 at default load factor).
     h ^= (h >>> 20) ^ (h >>> 12);
     return h ^ (h >>> 7) ^ (h >>> 4);
 } 
```

如果您想使用不是 2 的幂的大小，则*可能*不需要上述内容。

实际上，将映射从哈希更改为存储桶（通常依赖于容量为 2 的幂）将需要您查看[`indexFor`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/HashMap.java#275)：

```
 static int indexFor(int h, int length) {
     return h & (length-1);
 } 
```

你可以`(h & 0x7fffffff) % length`在这里使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:36:48.450

您可以将 mod 函数视为哈希函数的一种简单形式。它将大范围的数据映射到更小的空间。假设原始哈希码设计得很好，我认为没有理由不能使用 mod 将哈希码转换为您正在使用的表的大小。

如果您的原始哈希函数没有很好地实现，例如总是返回一个偶数，那么您将只使用一个 mod 函数作为您的哈希函数来创建相当多的冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:37:18.123

这是真的，你可以选择伪素数。

注意： indexFor 需要使用`%`补偿符号而不是简单的`&`，这实际上会使查找速度变慢。

```
indexFor = (h & Integer.MAX_VALUE) % length
// or
indexFor = Math.abs(h % length) 
```

# c# - 加载特定的 XML 节点值 C#

> ID：11868068
> 
> 赞同：2
> 
> 时间：2012-08-08T15:33:29.640
> 
> 标签：c#, xml

我正在尝试将标签名称为“事件”的所有节点的属性值获取到 WindowsForm 上的组合框中。我在下面尝试了这段代码，但是，组合框中没有填充任何内容。

```
 if (selectEventComboBox.SelectedIndex != -1)
    {
        string filePath = 
              Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) 
              + "\\" + selectFileComboBox.SelectedItem.ToString() 
              + "dogs.xml";
        XmlDocument doc = new XmlDocument();
        doc.Load(filePath);

        XmlNodeList eventList = doc.GetElementsByTagName("Event");
        for (int count = 0; count < eventList.Count; count++)
        {
            selectEventComboBox.Items.Add(eventList[count].Attributes.ToString());
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:50:07.090

这工作正常

```
XmlDocument doc = new XmlDocument();
doc.Load("myxml.xml");
XmlNode root = doc.DocumentElement;
XmlNodeList nodeList = root.SelectNodes("//Event");

for (int i = 0; i < nodeList.Count; i++)
{
    Console.WriteLine("row: {0}, InnerText: {1}, ID: {2}",i, nodeList[i].InnerText, nodeList[i].Attributes["id"].Value);
} 
```

myxml.xml 的内容

```
<?xml version="1.0" encoding="utf-8" ?>
<root>
    <Event id="1">Event one</Event>
    <Event id="2">Event two</Event>
    <Event id="3">Event three</Event>
    <Event id="4">Event four</Event>
</root> 
```

![在此处输入图像描述](../Images/e0ea0a2e23cf1a166cb0e480967ce82b.png)

# macos - OS X - 启动守护进程和启动代理之间的通信

> ID：11868069
> 
> 赞同：4
> 
> 时间：2012-08-08T15:33:34.210
> 
> 标签：macos, cocoa, cfsocket, launch-daemon, launchdagent

我是 OS X 新手，必须创建一个包含 2 个部分的应用程序 - 启动守护进程和启动代理。守护进程将执行命令执行、日志记录等工作，并且必须以某种方式将这些结果传达给启动代理（这会将它们传输到显示 GUI 的登录项，尽管这是未来的步骤）。

我的问题：我如何实现这种沟通？在阅读 Apple 文档后，到目前为止我所能收集到的信息是，我最好的选择是使用 CFSockets。有没有替代（更简单）的方式？有没有人有任何示例教程/示例/代码来展示如何使用 CFSockets（我找不到任何）？

PS：我的问题可能与[此](https://stackoverflow.com/questions/7375785/data-exchange-between-daemon-and-launch-agent)问题重复，但该问题尚未得到解答，因此我想发布此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T15:22:53.427

我能够使用 CFSockets 在我的守护进程和代理之间建立通信，它并没有我之前想象的那么糟糕。我按照以下处的分步说明进行操作： [https](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/UsingSocketsandSocketStreams.html) ://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/UsingSocketsandSocketStreams.html （编写基于 TCP 的服务器）。

您也可以尝试使用普通的 BSD 套接字。有一个简单的例子： http: [//www.minek.com/files/unix_examples/poll.html](http://www.minek.com/files/unix_examples/poll.html)（虽然我没有试过）。

祝你好运。

# java - 如何使用受信任的域用户对活动目录进行身份验证？

> ID：11868072
> 
> 赞同：0
> 
> 时间：2012-08-08T15:33:41.647
> 
> 标签：java, active-directory

使用 Active Directory 域和信任，我为 domainA.com 添加了名为 domainB.com 的受信任域 使用此代码对 Active Directory 进行身份验证，我收到错误“LDAP：错误代码 49 - 80090308：LdapErr：DSID-0C090334，注释: AcceptSecurityContext 错误，数据 525，vece"

```
Hashtable<String, String> env = new Hashtable<String, String>();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://domainA.com:389/");
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "domainB\\userB");
env.put(Context.SECURITY_CREDENTIALS, "*******");
env.put(Context.REFERRAL, "follow");
InitialLdapContext ctx = new InitialLdapContext(env, null); //this line will cause error 
```

如何使用受信任的域用户向 AD 进行身份验证？谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:47:34.130

错误 49 通常表示凭据错误。

同样在最后一行你可以使用

```
DirContext context = new InitialDirContext(env); 
```

JNDI 将完成剩下的工作。

# git - 如果我签出标签并提交，我的提交会去哪里？

> ID：11868077
> 
> 赞同：3
> 
> 时间：2012-08-08T15:33:58.393
> 
> 标签：git

在 GIT 中，如果我签出一个标签，我将获得该标签引用的工作副本，即代码将代表我当时拥有的内容。我说的对吗？

现在，如果我这样做，并修改我的代码并提交。该提交将在哪里进行？它会有点“自动合并”吗？这意味着如果我推送我的提交，克隆存储库的人也会从标签中获得我所做的修复？或者，如果我切换回master，我在那里可以修改代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:46:34.403

提交仍然只存储在本地。只有您对修改后的版本有参考。如果您想让其他人可以使用它，您还必须对`git push`给定的分支执行一段代码。

您的提交是特定于分支的，这意味着如果您在提交后更改分支，您的更改将不会延续。但是，当您更改回分支时，提交仍然存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:59:55.073

它不会“自动合并”。它存储在存储库中，由 HEAD 直接引用。通常引用 HEAD（.git 中的小文件，名为 HEAD）包含分支的名称，每次提交都会更新顶级提交引用。在您的情况下，它是所谓的“分离的 HEAD”。

您始终可以将分离的 HEAD 保存在真正的分支引用中：`git branch something`. 或者只是检查另一个分支并忘记提交，它们最终会被清理掉。

# php - CakePHP 2.2.1 什么是高亮当前菜单项的 DRY 方法？

> ID：11868082
> 
> 赞同：0
> 
> 时间：2012-08-08T15:34:17.320
> 
> 标签：php, cakephp

我正在尝试在我的网站上实现当前菜单项的突出显示。现在我只在当前视图中找到了一个`View::set`方法。`$this->set('activeMenuButton', 'posts');`

但我的网站布局中有 9 个菜单项。例如：

```
<li><?php echo $this->Html->link('Main page', array('controller' => 'pages','action' => 'index'), array('class' => 'button'));?></li> etc. 
```

如何自动检查当前活动页面 == $this->set('activeMenuButton', 'posts')？或者我应该为布局中的每个 < li > 添加检查？像一个

```
if $activeMenuButton == posts { echo = 'class="activebutton"' } else { echo class="button" }? 
```

对我来说这看起来很糟糕，但我想不出其他选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:49:12.723

你可以使用 Jquery。将`$activeMenuButton`with json_encode() 传递给 javascript 函数，然后检查所有按钮。

# c - 避免 2 的幂以实现缓存友好性

> ID：11868087
> 
> 赞同：9
> 
> 时间：2012-08-08T15:34:30.063
> 
> 标签：c, performance, caching, optimization, memory

假设在速度关键代码中，我们有一对经常一起使用的数组，其中确切的大小无关紧要，只需将其设置为合理的值，例如

```
int a[256], b[256]; 
```

这是否可能是一种悲观，因为低地址位相同会使缓存更难同时处理两个数组？指定例如 300 而不是 256 会更好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T17:43:06.317

将我的评论移至答案：

您怀疑二次幂可能有问题是正确的。但它通常只适用于你有超过 2 步的情况。[在您超过 L1缓存关联性](http://en.wikipedia.org/wiki/CPU_cache#Associativity)之前，它不会变得非常糟糕。但即使在此之前，您也可能会遇到错误的别名问题。

以下是两个二次幂实际上成为问题的示例：

*   [为什么在单独的循环中元素加法比在组合循环中快得多？](https://stackoverflow.com/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops)
*   [矩阵乘法：矩阵大小差异小，时序差异大](https://stackoverflow.com/questions/7905760/matrix-multiplication-small-difference-in-matrix-size-large-difference-in-timi)

在第一个示例中，有 4 个数组 - 所有这些数组都与 4k 页面开头的相同偏移量对齐。

在第二个示例中，当矩阵大小为 2 的幂时，矩阵的逐列跳跃会完全破坏性能。

* * *

在任何情况下，请注意关键概念实际上是数组的对齐方式，而不是它们的大小。如果你发现你遇到了减速，只需在你的数组之间添加一些填充来破坏对齐。

# zlib - 未知的 zlib 标头 (.vrscene)

> ID：11868094
> 
> 赞同：0
> 
> 时间：2012-08-08T15:34:48.563
> 
> 标签：zlib, compression

这是 Vray 的 .vrscene 文件的格式说明：http: [//spot3d.com/vray/help/maya/sdk22/vrscene_format.html](http://spot3d.com/vray/help/maya/sdk22/vrscene_format.html)

我对有关“压缩十六进制列表”的段落感兴趣。据说压缩列表等于标题（“ZIPB”）+未压缩大小+压缩大小+ zlib压缩字符串。

例如，在我的 .vrscene 中，我有这样的压缩列表：“ZIPB2C01000015000000e7X81OT0TG4S5ENN3D8Z8IVAPODONF7EA”

这意味着“e7X81OT0TG4S5ENN3D8Z8IVAPODONF7EA”——zlib 压缩字符串。但我不知道如何解压它。当我进行 Base64 解码时，我收到标头 0x7bb5。我不知道这样的标题。也许我不应该使用 Base64 而应该做其他事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-08-22T03:31:10.997

所以我知道这是旧的，但这里的信息足以让我找到一个解决方案，唯一的区别是我有一个来自不同 vrscene 文件的不同压缩列表。

正如您所建立的，您需要从字符串中删除前 20 个字符，因为它们只是 vray 使用的描述符，而不是压缩数据的一部分。

```
import base64, zlib

data = "ZIPCB81900003C000000eAHt0iERAAAMxLDC9694MkYCaqCXVZMHDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwMC7gQMbojNx"
encoded_data = data[20:] #"eAHt0iERAAAMxLDC9694MkYCaqCXVZMHDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwMC7gQMbojNx"
compressed_data = base64.b64decode(encoded_data)
hex_data = zlib.decompress(compressed_data)
# b'\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00...' 
```

一旦你在这一点上，你就有了未经任何压缩的原始十六进制列表。如果您想将其转换为可读的 Python 数据类型，您可以使用 struct 来解包它们，具体取决于列表中存储的数据类型。

进一步阅读链接的文档解释说，所有这些列表都存储为每个条目 4 个字节（在文档中写为 8 个半字节，但就 python 而言，它只有 4 个字节）。有了这些信息，我们可以确定列表中的条目数应该是 hex_data / 4 的长度，并构建一个结构格式字符串，该字符串将立即解包整个列表。

```
import struct

#I have a list of ints as my example, but for floats you could use "f" instead
format = "i" * int(len(hex_data)/4)
values = struct.unpack(format, hex_data)
# [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, ...] 
```

还有颜色列表和向量列表，但它们只是需要展开的浮动列表。

```
vectors = []
for i in range(0, int(len(values)), 3):
    vectors.append(tuple(values[i:i+3])) 
```

由于此方法似乎适用于到目前为止我遇到的所有压缩十六进制列表，因此您最初尝试从中解析数据的文件似乎存在问题，或者开发人员正在使用编码使用 base64 以外的方法，但从那时起就采用了 base64 编码（也许这就是我的文件中出现“ZIPC”而不是您的示例中的“ZIPB”的原因）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T20:40:15.433

文档说十六进制，但您提供的字符串有其他字符。它可能不是 base64，因为您在开始时没有得到有效的[zlib](http://zlib.net/)标头。（顺便说一句， `0x7b` `0xb5`当我用 base64 解码它时，我得到的不是你得到的。但无论哪种方式，它都不是 zlib 标头。）你有更好的格式描述来源吗？

数据必须是高度可压缩的，例如全为零，因为它显然从 4140 字节变为 21 字节。

# c# - ArgumentOutOfRangeException 未处理

> ID：11868099
> 
> 赞同：0
> 
> 时间：2012-08-08T15:35:15.740
> 
> 标签：c#

在第 69 行，我收到错误“ArgumentOutOfRangeException 未处理”。

```
/*
Please critique as I'm always looking for ways to improve my coding.

Usage Example:
MapleWebStart mws = new MapleWebStart("myusername", "mypassword");
mws.Start();
*/

using System;
using System.Diagnostics;
using System.IO;
using System.Net;
using System.Text;
using Microsoft.Win32;

public class MapleWebStart
{
    private CookieContainer LoginCookie;

    public MapleWebStart(string username, string password)
    {
        LoginCookie = new CookieContainer();
        if (!Login(username, password))
            throw new ArgumentException("Invalid Nexon username or password.");
    }

    public MapleWebStart(CookieContainer loginCookie)
    {
        LoginCookie = loginCookie;
    }

    private bool Login(string username, string password)
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://maplestory.nexon.net/Controls/Passport.aspx");
        request.Method = "POST";
        string postData = "__VIEWSTATE=%2FwEPDwULLTE5NjM3MjM3MDcPZBYCAgMPZBYEAgUPFgIeB1Zpc2libGVoZAIHDxYCHwBoZGSVGoua1TAiCeQWNk%2BdqOF%2FXtq%2BmA%3D%3D&tbID=" + username + "&" + "tbPass=" + password;
        byte[] byteArray = Encoding.UTF8.GetBytes(postData);
        request.CookieContainer = LoginCookie;
        request.ContentType = "application/x-www-form-urlencoded";
        request.ContentLength = byteArray.Length;
        Stream dataStream = request.GetRequestStream();
        dataStream.Write(byteArray, 0, byteArray.Length);
        dataStream.Close();
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        dataStream = response.GetResponseStream();
        StreamReader reader = new StreamReader(dataStream);
        string responseFromServer = reader.ReadToEnd();
        reader.Close();
        dataStream.Close();
        response.Close();
        if (!responseFromServer.Contains("Wrong password"))
        {
            LoginCookie.Add(response.Cookies);
            return true;
        }
        return false;
    }

    private string GetMaplePath()
    {
        string maplePath = (string)Registry.GetValue(@"HKEY_LOCAL_MACHINE\SOFTWARE\Wizet\MapleStory", "ExecPath", "");
        return File.Exists(maplePath) ? maplePath : (string)Registry.GetValue(@"HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Wizet\MapleStory", "ExecPath", "");
    }

    public void Start()
    {
        ProcessStartInfo maplestory = new ProcessStartInfo();
        maplestory.FileName = GetMaplePath() + @"\MapleStory.exe";
        maplestory.Arguments = "WebStart " + LoginCookie.GetCookies(new Uri("http://nexon.net"))[0].ToString().Substring(4);
        Process.Start(maplestory);
    } 
```

原代码： http: [//pastie.org/private/vgpxht8tehtdjml2jdq](http://pastie.org/private/vgpxht8tehtdjml2jdq)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:38:09.997

你的问题是

```
LoginCookie.GetCookies(new Uri("http://nexon.net"))[0].ToString() 
```

返回少于 5 个字符的字符串。所以，做

```
LoginCookie.GetCookies(new Uri("http://nexon.net"))[0].ToString().Substring(4) 
```

将失败，因为位置 4 将没有字符。您必须在处理之前检查字符串长度。

# c# - 不理解代表/事件和发布者/订阅者的观点

> ID：11868101
> 
> 赞同：2
> 
> 时间：2012-08-08T15:35:29.170
> 
> 标签：c#

我正在阅读和阅读，但我仍然无法理解以及如何使用委托/事件和发布者/订阅者？我知道委托是一个包含对一个或多个方法的引用的类，它用于将方法发送到另一个方法。

我不明白的是我应该如何确定发布者/订阅者的角色。让我们举个例子。出租车中心和出租车。出租车中心是出版商，出租车是订阅者，从出租车中心获得驾驶命令是什么？但是出租车也可以是发布者，然后向出租车中心报告他们要去的位置和地址，那么是出租车的订阅者！？

我需要灵感，我正在寻找一些初学者代码来了解它是如何工作的。有没有人有几分钟的时间用一些简单的代码来回复这个答案？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:21:18.893

考虑事件、发布者/订阅者等的另一种方式是考虑云及其运行方式。在基于云的系统中，任何实体都可以注册以侦听任何类型的事件，或者可以发布它想要的任何事件。任何倾听的人都会得到该数据。

在您的示例中：出租车中心可以发布/推送事件，例如换班、交通事故作为（位置）、出租车请求在（位置）或整个出租车组将监听的其他类似事件。各个出租车将发布诸如 Pickup At (Location)、Drop off at (Location)、Accident at (Location) 等信息；该中央将出于自己的目的进行记录。如果其他出租车也想监听这些相同的事件，那么他们可以知道其他出租车与他们自己的位置之间的距离和距离，或者是否有其他出租车报告的事故或类似情况。

然而，云事件是事件系统的特定实现。专门订阅事件更为常见。cab 对象在创建时会立即订阅 Central 事件，而中央系统在调度 cab 时会确保它自己订阅了该 cab 的事件。

这样，两个对象都充当发布者和订阅者的角色。它仅针对单个事件。在我的示例`PickupAt(Location)`中，将由出租车发布，并由 Central 订阅。因此，对于该事件，Cab 是发布者，Central 是订阅者。一般来说，谁担任什么角色完全取决于系统设计和正在创建的事件。它不是真正可以概括的东西，因为如果您以不同的方式设置事件，整个设置可能会被更改，甚至颠倒。我认为这是最重要的部分。

**全体代表**

用最简单的术语来说，委托就是参考。它可以引用一个类，更常见的是它可以引用一个类中的一个方法，或者调用一个类中的一个方法。它甚至可以在其内部包含整个方法调用。它确实是一个非常通用的对象，因为它可以做很多事情。在事件的上下文中，委托实际上引用了对实现事件的函数的调用。

**简单事件代码**

```
public class c1
{
    public event Eventhandler DoStuff;

    public c1()
    {

    }

    public void OnDoStuff()
    {//this actually makes the event happen
        if (DoStuff != null)
            DoStuff(this, null);
    }
}

public static void Main()
{
    c1 x = new c1();
    x.DoStuff += new EventHandler(ThingFunction);

    x.OnDoStuff();//this is how you would fire the event deliberately
}

public void ThingFunction(object sender, EventArgs x)
{
    Console.WriteLine("Something Happened");
} 
```

c1 包含事件`DoStuff`，Main 订阅此事件。当代码`x.OnDoStuff()`从 ANYWHERE 调用时，如果您将 x 或对它的引用传递到其他处理实际代码的类中，这将非常方便，然后处理程序返回 main，无论`x.OnDoStuff()`调用源自多少层, 将执行。

更具体地说，一旦创建了 X，它就可以传递到其他地方。只要将某个函数分配给`x.DoStuff`，无论何时何地调用该方法`x.OnDoStuff()`，分配给的函数`x.DoStuff`都会执行。这就是事件订阅的工作方式。 `x.OnDoStuff()`是发布事件的代码调用`x.DoStuff`，而任何类......实际上任何数量的类，你可以有多个订阅者毕竟，将能够捕捉到发布的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:38:49.943

你必须用“事件驱动”的术语来思考。在您的示例中，出租车中心和出租车可能有发布者角色，出租车中心和出租车可能有订阅者角色。

例如，如果出租车中心有一个更新要推送到所有出租车，它可以有一个它引发的事件并让出租车监听。然后，出租车可以在接送某人时提出一个事件，出租车中心会监听所有这些事件。

这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:49:05.033

委托不用于将方法发送到其他方法。它们用于调用方法，这些方法在编译时可能是未知的。

让我们看一个简单的例子。考虑一下，您编写了一个计算器，用户可以在其中选择参数和操作。该操作可以是执行计算的方法的委托。因此，您不必担心如何存储操作。此外，计算器不需要知道每一个操作，因为用户会提供它。

委托的一个常见示例是回调函数。如果您在第二个线程中启动长期程序，您可能希望收到通知，如果线程已完成。当过程完成时，您可以通过向被调用的线程提供一个委托来实现这一点。

事件是一种特殊类型的代表。当对象想要通知其他人状态更改或类似操作时，使用它们。特殊之处在于对象本身不需要知道哪些对象对更改感兴趣。相反，这些对象订阅事件。提供事件的对象只需调用事件的委托，所有订阅者委托都会被调用。

正如 Justin C 已经解释的那样，出租车中心和出租车都可以充当订阅者和发布者。这取决于谁对什么感兴趣。如果每个人都可以订阅这些事件。如果只允许出租车中心获取信息，回调方法会更合适。

# python - 南方（对于 Django）可以将数据行插入数据库吗？

> ID：11868102
> 
> 赞同：1
> 
> 时间：2012-08-08T15:35:29.167
> 
> 标签：python, mysql, django, django-south, insertion

我想创建一个表，然后创建一个应该插入到该表中的数据列表。南方有能力做这种事吗？如果是这样，你有什么参考可以告诉我如何做到这一点？

我希望能够做到这一点，因为在这一点上，拥有“完全相同”数据的唯一方法似乎是自己手动将它们插入数据库。

我想要一些在表中插入行的“好”自动化方式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T21:44:16.057

你可以！这称为[“数据迁移”](http://south.readthedocs.org/en/latest/tutorial/part3.html)。

很多时候你可能想要使用一个：上面的链接给出了一个很好的例子，另一个是[“每个 Django 项目的数据迁移”](http://south.readthedocs.org/en/latest/tutorial/part3.html)：

```
from south.v2 import DataMigration
from django.conf import settings

class Migration(DataMigration):

    def forwards(self, orm):
        Site = orm['sites.Site']
        site = Site.objects.get(id=settings.SITE_ID)
        site.domain = settings.DOMAIN_NAME
        site.name = settings.SITE_NAME
        site.save() 
```

（这会从 中获取域名和站点名称`settings.py`，以与[站点框架](https://docs.djangoproject.com/en/1.4/ref/contrib/sites/)一起使用）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T15:55:21.777

你想使用[fixtures](http://south.readthedocs.org/en/latest/fixtures.html#initial-data)。

1.  在您的应用程序文件夹中创建一个固定装置目录。
2.  在该文件夹中创建一个字典文件 intial_data.json（或 XML/YAML）
3.  使用您要插入的数据填充文件。[例子](https://docs.djangoproject.com/en/dev/howto/initial-data/)
4.  Run `manage.py loaddata <fixturename>`，`<fixturename>`您创建的夹具文件的名称在哪里。

South 以几乎相同的方式处理这个问题，但似乎 Django 的核心方法更有文档记录。

# php - 直播时间功能

> ID：11868104
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:35:35.130
> 
> 标签：php, javascript, jquery, ajax

我已经设置了我的 Agotime 功能。我只是想知道应该使用什么方法来实时更新时间。许多人会说 Ajax，但这会是服务器重吗？我需要每 5 秒进行一次平滑的更改。

另外我怎么能这样做？

```
 function Agotime($date)

    {
        if(empty($date)) {
            return "No date provided";
        }

        $periods         = array("second", "minute", "hour", "day", "week", "month", "year", "decade");
        $lengths         = array("60","60","24","7","4.35","12","10");

        $now             = time();
        $unix_date       = strtotime($date);

           // check validity of date
        if(empty($unix_date)) {    
            return "Bad date";
        }

        // is it future date or past date
        if($now > $unix_date) {    
            $difference     = $now - $unix_date;
            $tense         = "ago";

        } else {
            $difference     = $unix_date - $now;
            $tense         = "from now";
        }

        for($j = 0; $difference >= $lengths[$j] && $j < count($lengths)-1; $j++) {
            $difference /= $lengths[$j];
        }

        $difference = round($difference);

        if($difference != 1) {
            $periods[$j].= "s";
        }

        return "$difference $periods[$j] {$tense}";

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:40:10.937

您可以通过以下两种方式之一来实现它。

您可以按照您的建议使用 AJAX，并查询您的 PHP 脚本它是多久以前的。但是，这可能对请求数量造成很大影响。

您还可以在 Javascript 中实现该功能，并在加载时简单地将包含传递时间戳传递给脚本。这样您就不必向服务器发出任何请求，并且可以实时更新时间。当然，这假设时间戳没有改变。

我个人会选择选项#2，因为它很容易用 Javascript 计算，并且避免了大量的网络流量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:40:30.493

最好的选择是传入一个递增的日期，使用 setTimeout 并每 5 秒触发一次

然后，如果您愿意，可以进行“检查”以确保服务器上的时间与浏览器中的时间相匹配，每次 X 更新时使用 ajax 调用来“重新同步”日期/时间

# sql - 从字符串转换日期和/或时间

> ID：11868110
> 
> 赞同：0
> 
> 时间：2012-08-08T15:36:17.307
> 
> 标签：sql, sql-server-2008, tsql, dynamic-sql

我有一个主要由动态 SQL 组成的大程序。我在设置日期字段之一时遇到问题。

```
DECLARE @WorkDate DATETIME 

SET @WorkDate = 'SELECT MIN(__Insert_Date) FROM  ' + @DatabaseName + '.'
                            + @SchemaName + '.' + @TableName + '_Hist'

SET @WorkDate = DATEADD(DAY, DATEDIFF(DAY, '19000101', @WorkDate), '19000101') 
```

这是一个大程序的一部分。因此，当我执行上述查询时，我收到此错误：

> *消息 241，级别 16，状态 1，第 68 行
> 从字符串转换日期和/或时间时转换失败。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:39:38.267

看起来此数据库中的日期字段未存储为`DateTime`值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:39:40.090

而不是`19000101`，使用`1900-01-01`. 它无法识别您的字符串的日期格式，或者您的`@WorkDate`值无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:44:45.373

@WorkDate 是 DATETIME 并且您将其设置为一个刺痛，这就是转换失败的原因编辑：

试试这个：

```
DECLARE @WorkDate DATETIME, @WorkDateString varchar(100)

SET @WorkDateString = 'SELECT MIN(__Insert_Date) FROM  ' + @DatabaseName + '.'
                        + @SchemaName + '.' + @TableName + '_Hist'

SET @WorkDate = DATEADD(DAY, DATEDIFF(DAY, '19000101', @WorkDate), '19000101') 
```

如果您需要将 插入`@WorkDate`选择字符串 where `__Insert_Date`is 那么您需要颠倒顺序看起来像这样

```
DECLARE @WorkDate DATETIME, @WorkDateString varchar(100)

SET @WorkDate = DATEADD(DAY, DATEDIFF(DAY, '19000101', @WorkDate), '19000101')

SET @WorkDateString = 'SELECT MIN(' + CAST(@WorkDate as varchar(19)) + ') FROM  ' + @DatabaseName + '.'
                        + @SchemaName + '.' + @TableName + '_Hist' 
```

不知道您是否希望将 插入`@WorkDate`到选择字符串中，但这就是您可以完成的方法

# regex - 正则表达式：如何将截断字符替换为给定字符？

> ID：11868115
> 
> 赞同：0
> 
> 时间：2012-08-08T15:36:27.347
> 
> 标签：regex, sed

我需要截断`sed`所有内容，包括一行中的某个字符（在本例中为`]`）。

典型线路：

```
*15:36:40,038 [Some text] More text ...*
*15:57:40,038 [123] More text ....* 
```

把另一个收起来，把所有东西都换掉，直到`]`一无所有。实现这一目标的最巧妙方法是什么？

在提供建议时，我将非常感谢对正则表达式（或 bash`cut`命令的用法）的解释，以进一步了解我的知识。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:42:48.710

**解决方案**

你必须这样做：

```
sed 's/[^]]*\]//' 
```

**例子**

```
$ echo 15:36:40,038 [Some text] More text ... | sed 's/[^]]*\]//'
More text ... 
```

**解释**

*   `[^]]*`表示除`]`
*   `\]`方法`]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:05:03.637

如果你想把所有东西都剪到最后一个“]”（例如有更多的 [..] 对），你可以尝试：

```
awk -F']' '{print $NF}' file 
```

例子：

```
kent$  echo "15:36:40,038 [Some text] More text ... "|awk -F']' '{print $NF}'
 More text ... 

kent$  echo "15:36:40,038 [Some text] xxx yyy [some other foo] More text ... "|awk -F']' '{print $NF}'
 More text ... 
```

你的例子 cut ：

```
kent$  echo "15:36:40,038 [Some text] More text ... "|cut -d] -f2                            
 More text ... 
```

# extjs - 在 ExtJs 中，如何在将记录同步到商店后获取 id？

> ID：11868117
> 
> 赞同：2
> 
> 时间：2012-08-08T15:36:35.910
> 
> 标签：extjs, extjs4, store

**如果我在 ExtJs 4 下有一个商店，我如何在同步发生后从新添加的记录中获取一个 id？**

例如，如果我有一个`PersonStore`设置为自动同步，并且我根据用户填写的表格添加了一个新人，我可以通过执行以下操作将新记录添加到商店；

```
var values = button.up('form').getForm().getValues(),
    store = Ext.StoreMgr.lookup('PersonStore'),
    result;

result = store.add(values); 
```

由于 autosync 设置为 true，这会将新值发送到为其分配 id 的后端。然后后端用新创建的记录的 id 响应客户端。

**如何在客户端代码中获取此新创建记录的 ID？**我曾假设结果将包含它，但结果仍然将 id 设置为 null。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T17:44:49.513

当服务器端设置 id 时，工作流程是这样的：

*   在未分配 ID 的情况下添加到商店的记录。
*   存储同步，因此创建请求被发送到服务器。
*   服务器返回已发送的记录，并设置了 id 属性。
*   ExtJS 查看返回的记录，如果设置了 id，则将其分配给记录。

顺便注意一下，对于所有 CRUD 操作，只要 id 匹配，存储记录就会使用从服务器返回的数据进行更新。对于新创建的记录，ExtJS 有一种 internalId 机制来确定返回的记录是发送的记录，但设置了它的 id。

服务器端代码可能如下所示：

```
function Create( $aRecord )
{
    global $pdo;

    $iInsertClause = InsertClause::FromFields( self::$persistents );

    $iStatement = $pdo->prepare( "INSERT INTO Tags $iInsertClause" );
    $iStatement->execute( InsertClause::ObjectToParams( $aRecord, self::$persistents ) );

    // Inject the id into the record and return it in the reader's root,
    // so client side record updates with the new id.
    $aRecord->id = $pdo->lastInsertId();
    return array(
        'success' => true,
        'data'    => $aRecord,
    );
} 
```

然后在您的应用程序中，您的控制器应该挂钩存储写入事件。像这样的东西：

```
init: function() {

    this.getTasksStore().on({
        write:  this.onStoreWrite,
        scope:  this            
    });
}, 
```

在该函数中，您可以检查返回的记录（我假设`data`是读者的根）：

```
onStoreWrite: function ( aStore, aOperation )
{
        var iRecord = aOperation.response.result.data;
        console.log(iRecord.id);

}, 
```

# windows - 任务计划程序通过批处理发送电子邮件

> ID：11868120
> 
> 赞同：0
> 
> 时间：2012-08-08T15:36:40.847
> 
> 标签：windows, batch-file, automation, windows-xp

所以基本上我已经有一个批处理脚本，可以在文本文件中记录一些信息。问题是我想让它发送一封包含结果的电子邮件。我想知道是否有办法使用任务调度程序或类似的东西来做到这一点。我只是希望这件事在不使用任何其他软件的情况下实现自动化。我只想使用操作系统内置的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:04:07.443

我建议使用 VBScript……一切都内置了，而且非常简单。

这是一篇文章：http: [//www.paulsadowski.com/wsh/cdo.htm](http://www.paulsadowski.com/wsh/cdo.htm) 另一个： [http ://www.activexperts.com/activmonitor/windowsmanagement/adminscripts/enterprise/mail/](http://www.activexperts.com/activmonitor/windowsmanagement/adminscripts/enterprise/mail/)

最简单的方法是将您的文件附加为名称不变的附件。所以你的批次会喜欢（未测试）

```
.... your existing stuff .... > emailAttach.txt
cscript.exe theEmailSendingScript.vbs
del /f emailAttach.txt 
```

这样，计时器可以启动并重用相同的文件名。vbscript 可以附加 emailAttach.txt 并且它始终是新文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-16T13:12:42.460

给未来读者的几个解决方案：

*   任务计划程序现在可以将电子邮件作为任务中的操作发送。我相信该功能已添加到 Windows Server 2008 中。
*   多年来，我一直在批处理文件中使用 blat.exe。[在这里找到](http://www.blat.net/)非常灵活的工具
*   Powershell 的[Send-MailMessage](http://technet.microsoft.com/en-us/library/hh849925.aspx) cmdlet

# knockout.js - 用于链接列表的 Knockout.js 'foreach' 绑定

> ID：11868121
> 
> 赞同：2
> 
> 时间：2012-08-08T15:36:41.670
> 
> 标签：knockout.js, knockout-2.0

只是好奇，如何创建一个迭代链表的“foreach”绑定，就像当前的“foreach”绑定迭代数组一样？

我创建[了一个 jsFiddle 用于修补](http://jsfiddle.net/bmh_ca/uCyDG/1/)。

我认为链表可能是与 Knockout.js 一起使用的有用习惯用法。特别是，如果操作正确，DOM 只会更新正在添加/删除的元素（即，添加/删除元素时不会更新整个列表），并且添加/删除到列表中间的复杂性为O(1)，而数组的 O(n)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T11:26:17.057

基于数组的 foreach 已经非常高效了；DOM 元素仅在必要时添加/删除；当然，会扫描整个阵列的变化，但速度非常快（ko 只有阵列的粗略变化信号）。由于使用了距离算法，随机插入或删除速度很快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T13:08:26.323

这是一个好主意，但不幸的是我认为这是不可能的。

您必须订阅列表头部的可观察对象和每个元素的“下一个”可观察对象。

问题是除非您能分辨出哪个可观察对象触发了更改，否则您不会获得任何优势。如果您在列表中间编辑某些内容，那么重点是 foreach 绑定需要能够更新 DOM 的该部分，而无需迭代整个结构。绑定目前不允许这样做——如果一个绑定订阅了多个可观察`update`对象，则如果其中任何一个发生变化，它的方法将被调用，而不知道其中哪个发生了变化。

此外，即使这可行，所有这些额外的 ko.observable() 结构和订阅也将是相当严重的开销。三个 observables 而不仅仅是另一个数组元素。

为了避免对 DOM 进行不必要的更改，您可以将新结构与旧结构进行比较，然后进行相关更改，但是无论如何在使用数组时都可以这样做（我认为内置的 foreach 绑定不会进行这种优化）。

# javascript - 在 Metro 风格应用程序中启动时加载数据

> ID：11868122
> 
> 赞同：0
> 
> 时间：2012-08-08T15:36:42.903
> 
> 标签：javascript, html, microsoft-metro

我正在尝试开发一个使用相机并将照片存储在用javascript和html5编写的应用程序本地文件夹中的应用程序。我有 3 个页面使用相同的文件（图像），并且在每个页面的准备部分加载图像太昂贵了，所以我正在考虑在应用程序启动时使用 getFilesAsync() 方法将图像加载到数组或列表中然后使用 WinJS.Namespace.define 将其公开。该解决方案适用于少量数据，但是当图像文件夹中存储大量图片时，异步操作需要更多时间，因此当我尝试访问另一个页面上的文件时，它仍然未定义。

您是否知道如何在应用程序启动时加载数据并使其可从其他页面访问并强制程序等到它完成？我知道这与异步编程完全相反，但我没有看到任何其他解决方案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:02:56.747

你需要使用一个promise和promise链来让你等待完成：

```
var getFiles = Windows.Storage.StorageFolder.getStorageFilderSync("Your folder").then(function(folder) {
    return folder.getFilesAsync();
});

/* somewhere else in your app */
getFile.done(doWorkWithResult); 
```

您可以从其他页面调用完成；如果 getFilesAsync 已完成，那么它将立即返回并且不会重新运行查询。如果它还没有准备好，那么它将一直等到它完成。

[这里](http://code.msdn.microsoft.com/windowsapps/Folder-enumeration-sample-33ebd000)有一个很好的示例，其中包含更多工作示例。

# android - 将服务器数据转换为 Sqlite 数据库

> ID：11868124
> 
> 赞同：0
> 
> 时间：2012-08-08T15:36:45.173
> 
> 标签：android

我正在开发 android 应用程序，这里我有大量的数据，大约 10000 条记录，服务器中有 10 个字段，我需要获取这些数据并将其存储在我的本地数据库中，所以为此我尝试通过获取json形式的数据解析它并一一插入到数据库中，下载数据花费的时间更少，但插入数据库的时间更多，一段时间后我知道我正在插入数据库一，因此插入操作循环基于已获得的记录总数。我试图寻找替代方案，我无法做到这一点，所以我请求你给我建议和片段，让我实现这一目标。

感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:45:31.603

使用事务将多个插入包装到一个操作中，这要快得多：[提高 SQLite 的每秒插入性能？](https://stackoverflow.com/questions/1711631/how-do-i-improve-the-performance-of-sqlite)

```
List<Item> list = getDataFromJson();
SQLiteDatabase db = getDatabase();

db.beginTransaction();
try {
    // doing all the inserts (into memory) here
    for(Item item : list) {
        db.insert(table, null, item.getContentValues());
    }
    // nothing was actually inserted yet
    db.setTransactionSuccessful();
} finally {
    // all inserts happen now (if transaction was set to successful)
    db.endTransaction();
} 
```

# c++ - 如何在 CORBA 中获取和设置类字段？（处理 CORBA 对象序列）

> ID：11868128
> 
> 赞同：5
> 
> 时间：2012-08-08T15:36:52.960
> 
> 标签：c++, sequence, corba, omniorb

我有这样的：

用户.idl：

```
#ifndef __USER_IDL__
#define __USER_IDL__

interface Group;

interface User
{
    typedef sequence<Group> Groups;
    Groups getGroups();
    void setGroups(in Groups g);
};

#endif 
```

UserImpl.h 和 UserImpl.cpp：

```
class UserImpl : public POA_User
{
    private :
        User::Groups groups;
    public :

        User::Groups* getGroups();
        void setGroups(const ::User::Groups& g);
};

#endif

#include "UserImpl.h"

User::Groups* UserImpl::getGroups()
{
    return &(this->groups);
}

void UserImpl::setGroups(const ::User::Groups& g)
{
    this->groups.length(g.length());
    for(int i=0; i<g.length(); i++)
    {
        this->groups[i] = this->groups[i];
    }
} 
```

和 Group.idl：

```
#ifndef __GROUP_IDL__
#define __GROUP_IDL__

#include "User.idl"

interface Group
{
    typedef sequence<User> Users;
    User getFounder();
    void setFounder(in User u);
    Users getUsers();
    void setUsers(in Users u);
};

#endif 
```

GroupImpl.h、GroupImpl.cpp：

```
class UserImpl;

class GroupImpl : public POA_Group
{
    private :

        UserImpl *founder;
        Group::Users members;            

    public :

        User_ptr getFounder();
        void setFounder(::User_ptr u);
        Group::Users* getUsers();
        void setUsers(const ::Group::Users& u);
};

User_ptr GroupImpl::getFounder()
{
    return this->founder->_this();
}

void GroupImpl::setFounder(::User_ptr u)
{

}

Group::Users* GroupImpl::getUsers()
{

}

void GroupImpl::setUsers(const ::Group::Users& u)
{

} 
```

**我在这里遇到的问题是：**我做对了吗？我的意思是，这段代码一切正常吗？我仍然在学习如何用 CORBA 编写代码，有时会有疑问，尤其是涉及到序列时...

**第二个问题：**如何正确设置群创始人和获取和设置群成员？

我的意思是，我想在我的主文件中这样做：

```
 #include "UserImpl.h"
#include "GroupImpl.h"
#include <omniORB4/CORBA.h>
#include <omniORB4/Naming.hh>
#include <iostream>
using std::cout;
using std::cerr;

int main(int argc, char **argv)
{
    UserImpl u;
    u.setLogin("yak");
    u.setID(123);
    cout << u.getLogin() << "\n";
    cout << u.getID() << "\n";
    cout << u.toString() << "\n";

    GroupImpl **g = new GroupImpl*[1];
    for(int i=0; i<1; i++)
    {
        g[i] = new GroupImpl();
    }

    u.setGroups(g);

    return 0;
} 
```

请帮忙：）我使用omniORB和C++语言

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T11:29:35.343

好的，我想我想出了如何编写`getGroups`and的实现`getUsers`：

```
User::Groups* UserImpl::getGroups()
{
    const size_t size = this->groups.size();
    User::Groups_var seqOfObjects = new User::Groups(size);
    seqOfObjects->length(size);

    size_t i = 0;
    vector<GroupImpl*>::const_iterator it = groups.begin();
    while (it != groups.end())
    {
        seqOfObjects[i] = Group::_duplicate((*it)->_this());
        ++it;
        ++i;
    }

   return seqOfObjects._retn();
} 
```

那正确吗？但我仍然有问题`setUsers`和`setGroups`实现。

# wix - WiX - 如果注册表搜索失败，我如何安装到备用路径

> ID：11868131
> 
> 赞同：2
> 
> 时间：2012-08-08T15:37:01.883
> 
> 标签：wix

我的程序应该安装到注册表中记录的路径。如果找不到注册表项，则安装到另一个（默认）路径。

例如，我想要类似的东西：

```
<Property Id="MYINSTALLDIR">
    <RegistrySearch Id='MyRegistry' Type='raw' Root='HKCU' Key='Software\MyApp\Foo' Name='InstallDir' />
    if not found, then set "MYINSTALLDIR" to "D:\working\defaultApps"
</Property> 
```

我应该如何编写我的 wxs 文件来实现这一点？

**编辑：**

现在的问题是：

```
if not found in registry, then set "MYINSTALLDIR" to LocalAppDataFolder 
```

我试过了

```
<Property Id="MYINSTALLDIR" Value="LocalAppDataFolder">
    <RegistrySearch Id='MyRegistry' Type='raw' Root='HKCU' Key='Software\MyApp\Foo' Name='InstallDir' />
</Property> 
```

但错误返回：

```
Error 1606\. Could not access network location LocalAppDataFolder. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T06:23:34.873

好的，我终于知道该怎么做了。

使用`Custom Action`，现在可以将默认值设置为另一个属性：

```
<Property Id="MYINSTALLDIR">
    <RegistrySearch Id='MyRegistry' Type='raw' Root='HKCU' Key='Software\MyApp\Foo' Name='InstallDir' />
</Property>

<CustomAction Id="UserInstallDir" Property="InstallDir" Value="[INSTALLDIRCU]" Execute="immediate" />
<CustomAction Id="UserInstallDirDefault" Property="InstallDir" Value="[LocalAppDataFolder]" Execute="immediate" />

<InstallExecuteSequence>
    <Custom Action="UserInstallDir" After="AppSearch">MYINSTALLDIR</Custom>      
    <Custom Action="UserInstallDirDefault" After="AppSearch">NOT MYINSTALLDIR</Custom>      
</InstallExecuteSequence> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-09T00:06:00.217

根据记忆，下面的示例应该可以工作。如果没有为搜索找到值，则该属性将获取默认值。只有在搜索成功时才会被覆盖。

```
<Property Id="MYINSTALLDIR" Value="Default Property Value">
    <RegistrySearch Id='MyRegistry' Type='raw' Root='HKCU' Key='Software\MyApp\Foo' Name='InstallDir' />
</Property> 
```

# java - Java接口命名协议

> ID：11868132
> 
> 赞同：0
> 
> 时间：2012-08-08T15:37:05.723
> 
> 标签：java, interface

我需要帮助。我有一个接口，其中只有一种方法：

```
getLanguages(); 
```

实现此接口的类应实现该`getLanguages()`方法以返回支持的语言列表。但我不知道如何将这个界面命名为清晰和简单。“朗格特”？“LangListGetter”？有接口命名协议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:41:38.323

根据这篇关于[使用 Java 命名约定](http://java.about.com/od/javasyntax/a/nameconventions.htm)的文章：

> 接口：名称应采用 CamelCase。它们往往有一个描述类可以执行的操作的名称：
> 
> ```
> interface Comparable
> interface Enumerable 
> ```
> 
> 请注意，一些程序员喜欢通过以“I”开头的名称来区分接口：
> 
> ```
> interface IComparable
> interface IEnumerable 
> ```

因此，根据这些约定，您可以给它起一个漂亮、简单的名称，例如`ISupportedLanguages`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:40:53.867

ILanguageAware 或只是 LanguageAware 怎么样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:44:09.620

接口名称应该表达能力，例如`Comparable`. 您应该确定您希望界面的用户拥有什么功能。即：`LanguageSupporter`或`HasLanguages`。

# c# - C# - 使用 LINQ 更新一行

> ID：11868133
> 
> 赞同：1
> 
> 时间：2012-08-08T15:37:11.577
> 
> 标签：c#, sql, linq, row

我正在改进控制台应用程序，目前我无法让它更新行，而不仅仅是创建一个包含更新信息的新行。

```
class Program
{
    List<DriveInfo> driveList = DriveInfo.GetDrives().Where(x => x.IsReady).ToList<DriveInfo>(); //Get all the drive info
    Server server = new Server();  //Create  the server object
    ServerDrive serverDrives = new ServerDrive();

    public static void Main()
    {
        Program c = new Program();
        c.RealDriveInfo();
        c.WriteInToDB();
    }

    public void RealDriveInfo()
    {

        //Insert information of one server
        server.ServerID = 0; //(PK) ID Auto-assigned by SQL
        server.ServerName = string.Concat(System.Environment.MachineName);

        //Inserts ServerDrives information.
        for (int i = 0; i < driveList.Count; i++)
        {

            //All Information used in dbo.ServerDrives                
            serverDrives.DriveLetter = driveList[i].Name;
            serverDrives.TotalSpace = driveList[i].TotalSize;
            serverDrives.DriveLabel = driveList[i].VolumeLabel;
            serverDrives.FreeSpace = driveList[i].TotalFreeSpace;
            serverDrives.DriveType = driveList[i].DriveFormat;
            server.ServerDrives.Add(serverDrives);

        }
    }

    public void WriteInToDB()
    {
        //Add the information to an SQL Database using Linq.
        DataClasses1DataContext db = new DataClasses1DataContext(@"sqlserver");
        db.Servers.InsertOnSubmit(server);
        db.SubmitChanges(); 
```

我希望它用来更新信息的是`RealDriveInfo()`方法，因此它不是创建新条目，而是通过运行该方法更新当前存储的信息，然后插入该方法中的信息，如果需要，将输入一个新条目而不是简单地输入每次有新信息时都有新条目。

目前它正在运行该方法，收集相关数据，然后将其作为两个表中的新行输入。

任何帮助，将不胜感激 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:50:38.350

它每次都创建一个新的数据库条目，因为您每次都在创建一个新的服务器对象，然后调用 InsertOnSubmit() - 它插入（创建）一条新记录。

我不完全确定您要做什么，但是数据库更新将涉及**选择**现有记录，修改它，然后将其附加回数据上下文并调用 SubmitChanges()。

这篇关于[更新实体](http://davedewinter.com/2009/04/07/linq-to-sql-updating-entities/)(Linq toSQL) 的文章可能会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T15:52:21.847

问题是您正在尝试`Update`使用旨在提供面向对象查询的工具来实现功能。LINQ 允许更新现有记录，但您必须以正确的方式使用它来实现这一点。

正确的方法是从数据库中获取要更新的数据，执行修改，然后将其刷新回数据库。因此，假设`Servers`在您的数据上下文中命名了表，这是一个抽象示例：

```
DataClasses1DataContext db = new DataClasses1DataContext(@"sqlserver");
var servers = db.Servers.Where(srv=>srv.ID>1000); //extracting all servers with ID > 100 using lambda expression
foreach (server in servers){
    server.Memory *=2; //let's feed them up with memory
}
db.Servers.SubmitChanges(); 
```

实现此目的的另一种方法是创建一个实体，而不是将其附加到`DataContext`using [Table.Attach](http://msdn.microsoft.com/en-us/library/bb548978.aspx)方法，但这是一个很滑的斜坡，所以我不建议您使用它，除非您的 LINQ 技能有所提高。

有关详细说明，请参阅

1.  [提交更改](http://msdn.microsoft.com/en-en/library/system.data.linq.datacontext.submitchanges.aspx)
2.  [Lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-04T12:40:28.143

我明白被问到什么，但我没有一个简单的答案。

例如，您有一个值的形式，其中几个值发生了变化，也许有一些是计算出来的。或者表单可以包含新记录。

您创建值的记录

```
myrecord = new MyRecord() 
```

然后填写我的记录。在你接触数据库之前做你想做的任何验证/计算。

//GetID 要么返回现有 ID，要么返回零，如果这是一条新记录。

```
myrecord.id = GetIDForRecordOrZeroIfANewRecord(uniqueName);
myrecord.value1 = txtValue1.text;
myrecord.value2 = (DateTime)dtDate.value; 
```

等等通过田野。

您现在有一条记录，如果 id 为零，您可以将其添加为新记录。但是，如果 id 是现有记录，您似乎对 Linq 没有选择，除非有一个从 myrecord 写入每个值的函数，因此您必须有一个包含类似内容的函数 -

```
var thisRecord = from n in mydatacontext.MyTable
  where n.id == myrecord.id
  select n;

thisrecord.value1 = myrecord.value1;
thisrecord.value2 = myrecord.value2; 
```

等等通过所有领域。

我这样做了，但是当我已经在我的记录中准备好所有信息时，这似乎很啰嗦。一个简单的函数

```
mydatacontext.MyTable.Update(myrecord); 
```

将是理想的。事实上，与我在其他数据库中存储 SQL 函数所做的类似，它简化了更新而不是新记录的传输。

# php - 解析xml并读取php中的每个元素

> ID：11868134
> 
> 赞同：1
> 
> 时间：2012-08-08T15:37:14.630
> 
> 标签：php, xml

我有来自 API 的以下 XML 输出

```
<?xml version='1.0' encoding='UTF-8'?>
<Response>
    <ReturnRow Output1="11" Output2="12" Output3="13" Output4="14" Output5="15" />
    <ReturnRow Output1="21" Output2="22" Output3="23" Output4="24" Output5="25" />
    <Messages>
        <Message Code="INFO" Msg="Your request is successful." Type="APP"/>
    </Messages>       
</Response> 
```

我正在尝试使用 PHP 解析上述 xml，循环子元素`ReturnRown`并将 , 回显`Output1`到`Output2`HTML 表中。

这是我目前的代码：

```
$doc = new DOMDocument();
$doc->loadXML($test); //$test is holding the above XML
$node = $doc->getElementsByTagName( "ReturnRow" );
foreach ($node as $book) {
     var_dump($book);
} 
```

但上面实际上并没有给我等值`Ouput1`。`Output2`

我错过了什么或做错了什么？

我上面的 PHP 代码的结果：

```
object(DOMElement)#3 (18) { ["tagName"]=> string(9) "ReturnRow" ["schemaTypeInfo"]=> NULL        ["nodeName"]=> string(9) "ReturnRow" ["nodeValue"]=> string(0) "" ["nodeType"]=> int(1)     ["parentNode"]=> string(22) "(object value omitted)" ["childNodes"]=> string(22) "(object value omitted)" ["firstChild"]=> NULL ["lastChild"]=> NULL ["previousSibling"]=> string(22) "(object value omitted)" ["nextSibling"]=> string(22) "(object value omitted)" ["attributes"]=> string(22) "(object value omitted)" ["ownerDocument"]=> string(22) "(object value omitted)" ["namespaceURI"]=> NULL ["prefix"]=> string(0) "" ["localName"]=> string(9) "ReturnRow" ["baseURI"]=> string(20) "file:///W:/ischools/" ["textContent"]=> string(0) "" } object(DOMElement)#5 (18) { ["tagName"]=> string(9) "ReturnRow" ["schemaTypeInfo"]=> NULL ["nodeName"]=> string(9) "ReturnRow" ["nodeValue"]=> string(0) "" ["nodeType"]=> int(1) ["parentNode"]=> string(22) "(object value omitted)" ["childNodes"]=> string(22) "(object value omitted)" ["firstChild"]=> NULL ["lastChild"]=> NULL ["previousSibling"]=> string(22) "(object value omitted)" ["nextSibling"]=> string(22) "(object value omitted)" ["attributes"]=> string(22) "(object value omitted)" ["ownerDocument"]=> string(22) "(object value omitted)" ["namespaceURI"]=> NULL ["prefix"]=> string(0) "" ["localName"]=> string(9) "ReturnRow" ["baseURI"]=> string(20) "file:///W:/ischools/" ["textContent"]=> string(0) "" } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:44:14.757

在您的情况下，我更喜欢使用[simplexml](http://php.net/manual/en/book.simplexml.php)，因为它可以以易于迭代的格式返回节点的所有属性，并使用 xpath 查找您感兴趣的节点：

```
$xml = '<'.'?xml version="1.0" encoding="UTF-8"?>
<Response>
    <ReturnRow Output1="11" Output2="12" Output3="13" Output4="14" Output5="15" />
    <ReturnRow Output1="21" Output2="22" Output3="23" Output4="24" Output5="25" />
    <Messages>
        <Message Code="INFO" Msg="Your request is successful." Type="APP"/>
    </Messages>
</Response>
';

$doc = simplexml_load_string($xml);
$node = $doc->xpath('//ReturnRow');
foreach ($node as $book) {
    foreach ($book->attributes() as $name => $value) {
        var_dump((string)$name, (string)$value);
    }
} 
```

如果您的输入始终具有这些属性，您可以在原始代码的循环中使用 DOMNode 的[getAttribute()](http://php.net/manual/en/domelement.getattribute.php)方法来获取这些值：

```
foreach ($node as $book) {
    var_dump($book->getAttribute('Output1'), $book->getAttribute('Output2'));
} 
```

# python - POST-then-redirect 和 MethodViews

> ID：11868143
> 
> 赞同：6
> 
> 时间：2012-08-08T15:37:45.217
> 
> 标签：python, redirect, flask

假设我`MethodView`看起来像这样：

```
from flask import jsonify, request, redirect, flash, views, url_for
from models import Provider

class ProviderAPI(views.MethodView):

    def get(self, provider_id):
        if provider_id is not None:
            provs = [Provider.objects.get_by_id(provider_id)]
        else:
            provs = Provider.objects.all()
        return jsonify(dict(objects=[x.attributes_dict for x in provs]))

    def post(self):
        data = request.form.to_dict()
        data['index'] = request.form.getlist('index')
        if data:
            obj = Provider(**data)
            if obj.is_valid():
                obj.save()

                flash('%s created' % obj, )

                return redirect(url_for(
                    'provider',
                    provider_id=obj.id,
                    )
                )
            else:
                return jsonify(obj.errors)

    def put(self, provider_id):
        pass

    def delete(self, provider_id):
        pass 
```

这将使用这个已知的片段注册：

```
def register_api(view, endpoint, url, pk='id', pk_type='int'):
    """
    Helper for the API boilerplate, `view` must inherit from MethodView 

    register_api(UserAPI, 'user', '/user/', pk='provider_id')
    """
    view_func = view.as_view(endpoint)

    app.add_url_rule(url, defaults={pk: None},
                     view_func=view_func, methods=['GET',])
    app.add_url_rule(url, view_func=view_func, methods=['POST',])
    app.add_url_rule('%s<%s:%s>' % (url, pk_type, pk), view_func=view_func,
                     methods=['GET', 'PUT', 'DELETE']) 
```

问题是，在`post`成功之后，它被重定向了`get`函数，但是通过`POST`调用并引发了`Method Not Allowed`.

```
127.0.0.1 - - [08/Aug/2012 12:35:21] "POST /provider/ HTTP/1.1" 302 -
127.0.0.1 - - [08/Aug/2012 12:35:21] "POST /provider/44 HTTP/1.0" 405 - 
```

有没有办法告诉`redirect`使用`GET`呼叫代替？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T04:59:36.217

看起来可以使用与前一个请求相同的请求方法进行 302 重定向。但是，303 重定向应始终使用 GET ( [source](http://en.wikipedia.org/wiki/HTTP_303) )。

重定向功能可以采用状态码。尝试这个：

```
 return redirect(url_for(
                'provider',
                provider_id=obj.id,
                ),
                code=303
            ) 
```

编辑：类似的讨论：[重定向到 Flask 中的 URL](https://stackoverflow.com/questions/14343812/redirecting-to-url-in-flask)

# mathematical-optimization - 可用来源的运输 p‌r‌o‌b‌l‌l‌m 多于目的地

> ID：11868145
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:37:50.980
> 
> 标签：mathematical-optimization

我需要解决一个不同于经典交通问题的交通问题。

在这种情况下，源处的项目总和大于目的地所需的项目总和。

请为我指出如何解决此类问题的一些方向。我所到之处都发现了经典的交通问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:58:44.640

只需转换您的问题并应用“原始”算法：添加一个“人工”目标节点，使其需求等于总盈余，并且该节点的所有运输成本为零。

# python - 使用python获取Linux中日期范围内修改的目录中的文件

> ID：11868148
> 
> 赞同：0
> 
> 时间：2012-08-08T15:37:54.303
> 
> 标签：python, linux, datetime

我正在尝试编写代码来获取在特定日期范围内创建/修改的目录中的文件。

我对 linux 了解不多，我想知道我可以使用什么命令来获取在我指定的日期范围内匹配的目录中的文件列表。

此外，这种查询的正确格式是什么，因为这个过程将是自动化的，用户只需输入他的开始和结束日期。

到目前为止的相关代码：

```
#! /usr/bin/env python

import os
import copy
import subprocess
import optparse

def command(command):
    env = copy.deepcopy(os.environ)
    proc = subprocess.Popen([command],
                shell=True, env=env, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    result = proc.stdout.read()

if __name__ == '__main__':
    parser = optparse.OptionParser()
    parser.add_option("-s", "--startdate", dest = "startdate",\
                      help = "the starting date of the files to search")
    parser.add_option("-e", "--enddate", dest = "enddate",\
                      help = "the ending date of the files to search")
    (options, args) = parser.parse_args()

    # commands
    file_names = command("get files that match dates command") 
```

我必须在该命令中输入什么来获取这些文件名？

**编辑：**

相反 - 它不一定是命令，如果它可以使用纯代码完成，`os.walk`例如，那也很棒。我知道某些功能在 Linux 和 Windows 中不能完全正常工作，因此需要在这件事上提供帮助。

**编辑2：**

无论采用哪种方法，用户都应输入两个日期：开始和结束。然后获取在这些日期之间修改/创建的所有文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:45:12.223

一种选择是在行中使用某些内容`os.walk`并根据 ctime/mtime 过滤掉文件，您可以像这样得到：

```
import os.path, time
print "last modified: %s" % time.ctime(os.path.getmtime(file))
print "created: %s" % time.ctime(os.path.getctime(file)) 
```

如果您更喜欢使用 shell，那么`find`您的朋友就是这样，带有以下标志：

> -ctime n 文件状态最后一次更改是 n*24 小时前。
> 
> -mtime n 文件的数据最后一次修改是在 n*24 小时前。

[编辑]

一个小代码示例，用于获取给定目录（“。”）中文件的修改时间：

```
import os
from os.path import join
import datetime

def modification_date(filename):
        t = os.path.getmtime(filename)
        return t

def creation_date(filename):
        t = os.path.getctime(filename)
        return t

for root, dirs, files in os.walk("."):
        for name in files:
        print join(root, name), modification_date(join(root, name)), creation_date(join(root, name)) 
```

根据您特定的命令行参数实现，您希望将命令行上传递的内容转换为 unix 时间戳并与任一日期进行比较。

# python - 实例属性意外加载

> ID：11868149
> 
> 赞同：0
> 
> 时间：2012-08-08T15:37:59.327
> 
> 标签：python

我去年学习了 Python，并且刚刚通过一个新项目重新开始学习。我一开始就遇到了障碍，经过大量研究文档后，我仍然感到困惑。我不得不相信这很简单，但我找不到。这是问题：

我在文件中设置了以下内容：

```
class Wrapper(object):
    def __init__(self, title=None):
        self.header = Thing("HEADER")
        if title is not None:
            self.header.content.append( Thing("TITLE", content=[str(title)]) )
        self.body = Thing("BODY")
        self.content = Thing("COMPLETE", content=[self.header, self.body])

class Thing(object):
    def __init__(self, name, content=[]):
        self.name = name
        self.content = content 
```

然后从交互式提示我做：

```
>>> import things
>>> a = things.Wrapper("This is a title") 
```

现在，我希望在这一点上的`body`属性`a`将是一个`Thing`实例，其名称`"BODY"`和`content`由一个空列表组成。我惊讶地发现它`content`实际上是一个包含相同`"TITLE"`实例的列表`a.header.content`。

```
>>> a.header.name
'HEADER'
>>> a.header.content
[<test.Thing object at 0xb752290c>]
>>> a.body.name
'BODY'
>>> a.body.content
[<test.Thing object at 0xb752290c>]
>>> a.body.content[0].name
'TITLE'
>>> a.body.content[0].content
['This is a title'] 
```

我一生都无法弄清楚如何`a.body.content`以这种方式分配。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:44:59.993

尝试这个

```
class Thing(object):
    def __init__(self, name, content=None):
        if content is None:
            content = []
        self.name = name
        self.content = content 
```

[] 作为默认值的问题是默认参数仅在解释器首次创建函数时评估一次。对于一个`int`或其他*不可变*类型，这很好，但对于*可变*类型（列表、字典、任何可以就地更改的东西），这会导致问题。最终发生的是所有实例`Thing`共享相同的`content`.

这样，**每次**调用构造函数时都会创建一个空列表，每次都会创建一个新列表。

# tridion - 如何在组件/页面右键单击上下文菜单中创建按钮

> ID：11868160
> 
> 赞同：1
> 
> 时间：2012-08-08T15:38:23.807
> 
> 标签：tridion, tridion-2011

如何在组件/页面右键单击的上下文菜单中创建按钮。

我尝试通过引用“http://www.julianwraith.com/2010/10/helloworld-extension-for-tridion-2011/”中提到的方法来配置我的 extension.config 文件，但我看不到任何可用的按钮。

任何人都可以建议我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-09T09:44:52.697

检查您的配置文件 (F:\Program Files (x86)\Tridion\customizations\HelloWorld\config\HelloWorld.config) 是否有未关闭的标签或一些拼写错误。

在上下文菜单中创建按钮：

1.  检查您的 HelloWorld.config 是否扩展了 contextmenu 节点

    ```
    <ext:contextmenus>
        <ext:add>
            <ext:extension name="Hello World" assignid="" insertbefore="cm_preview">
                <ext:menudeclaration>
                    <cmenu:ContextMenuItem id="HelloWorld" name="Hello World" command="HelloWorld"/>
                </ext:menudeclaration>
                <ext:dependencies>
                    <cfg:dependency>RandomStringThatNeedsToBeCompiled2</cfg:dependency>
                </ext:dependencies>
                <ext:apply>
                    <ext:view name="DashboardView"/>
                </ext:apply>
            </ext:extension>
        </ext:add>
    </ext:contextmenus> 
    ```

2.  修改您的 helloworld.js 以仅为组件启用按钮

    ```
    Common.Tridion.MVP.HelloWorld.prototype.isAvailable = function HelloWorld$isAvailable(selection)
    {
        var itemID = selection.getItem(0);
        if ($models.getItemType(itemID) != $const.ItemType.COMPONENT) {
            return false;
        }
    }; 
    ```

不要忘记清除缓存

# c# - 绑定到数据库的自定义通用 IEnumerator

> ID：11868162
> 
> 赞同：2
> 
> 时间：2012-08-08T15:38:35.800
> 
> 标签：c#, sql, generics, ienumerable

我所做的工作涉及将大量数据从 SQL 服务器数据库下载到内存中。为此，我们使用 SqlDataReader 加载自定义数据集定义，然后遍历 Datatable 并将每一行构建为一个对象，然后通常将这些对象打包到一个庞大的字典中。

我们使用的数据量足够大，有时它无法放入具有内存上限的单个数据表中。在最极端的情况下，字典甚至已经增长到足以超过 8 GB 的系统内存。我的任务是修复数据表溢出时引发的内存不足异常。我通过实现一个批处理方法来做到这一点，该方法似乎与数据表的使用方式相冲突，但它暂时有效。

我现在的任务是进一步减少这个过程的内存需求。我的想法是创建一个**从 IEnumerator 继承的通用类型类**，该类采用 SqlDataReader 并基本上将阅读器用作它正在枚举的集合。MoveNext() 函数将使阅读器前进，而 Current 属性将返回从阅读器当前行的构建器方法构建的指定类型对象。

我的问题：这是一个可行的想法吗？我从来没有听说过/在网上找不到类似的东西。

另外，从逻辑上讲：当调用 Current 属性时，我将如何调用类型声明所需的特定构建器函数？

我愿意接受批评和指责，因为我提出了一个愚蠢的想法。我最感兴趣的是找到实现总体目标的最佳实践。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:49:30.333

使用迭代器块似乎相当明智，实际上非常简单：

```
private static IEnumerable<Foo> WrapReader(SqlDataReader reader)
{
    while (reader.Read())
    {
        Foo foo = ...; // TODO: Build a Foo from the reader
        yield return foo;
    }
} 
```

然后你可以使用它：

```
using (SqlDataReader reader = ...)
{
    foreach (Foo foo in WrapReader(reader))
    {
        ...
    }
} 
```

如果你小心的话，你甚至可以使用 LINQ to Objects：

```
using (SqlDataReader reader = ...)
{
    var query = from foo in WrapReader(reader)
                where foo.Price > 100
                select foo.Name;
    // Use the query...
} 
```

# sql - 查询以获取每个项目的最高排名

> ID：11868164
> 
> 赞同：3
> 
> 时间：2012-08-08T15:38:44.310
> 
> 标签：sql, postgresql, postgresql-9.1

我有（简化的）以下模型：

```
Book
  id
  name

BookCategory
  book_id
  category_id
  rank

Category
  id
  name 
```

使用给定的类别 ID，我希望将具有该类别的书籍作为排名最高的书籍。

我将举一个例子来更清楚地说明它：

```
Book   

id    name   
---  -------
1     On Writing
2     Zen teachings
3     Siddharta

BookCategory   

book_id category_id      rank   
---       -------        -----
1        2               34.32
1        5               24.23
1        9               54.65
2        5               27.33
2        9               28.32
3        2               30.43
3        5               27.87

Category   

id    name   
---  -------
2     Writing
5     Spiritual
9     Buddism 
```

category_id = 2 的结果将是 id = 3 的书。

这是我正在运行的查询：

```
SELECT book."name" AS bookname
FROM bookcategory AS bookcat
LEFT JOIN book ON bookcat."book_id" = book."id" 
LEFT JOIN category cat ON bookcat."category_id" = cat."id" 
WHERE cat."id" = 2
ORDER BY bookcat."rank" 
```

这不是正确的方法，因为它没有选择每本书的最高排名。我还没有找到合适的解决方案。

注意：我使用的是 postgresql 9.1 版本。

编辑：

DB Schema（取自马丁的 SQL Fiddle 答案）：

```
create table Book (
  id int,
  name varchar(16)
  );

insert into Book values(1, 'On Writing');
insert into Book values(2, 'Zen teachings');
insert into Book values(3, 'Siddharta');

create table BookCategory (
  book_id int,
  category_id int,
  rank real
  );

insert into BookCategory values(1,2,34.32);
insert into BookCategory values(1,5,24.23);
insert into BookCategory values(1,9,54.65);
insert into BookCategory values(2,5,27.33);
insert into BookCategory values(2,9,28.32);
insert into BookCategory values(3,2,30.43);
insert into BookCategory values(3,5,27.87);

create table Category (
  id int,
  name varchar(16)
  );

insert into Category values(2, 'Writing');
insert into Category values(5,'Spiritual');
insert into Category values(9,    'Buddism'); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:41:07.290

添加另一列来计算排名：

```
dense_rank() OVER (PARTITION BY book."name" ORDER BY bookcat."rank"
s ASC) AS rank 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T17:36:33.527

建立：

```
CREATE TABLE Book
(
  id int PRIMARY KEY,
  name text not null
);

CREATE TABLE Category
(
  id int PRIMARY KEY,
  name text not null
);

CREATE TABLE BookCategory
(
  book_id int,
  category_id int,
  rank numeric not null,
  primary key (book_id, category_id)
);

INSERT INTO Book VALUES
  (1, 'On Writing'),
  (2, 'Zen teachings'),
  (3, 'Siddharta');

INSERT INTO Category VALUES
  (2, 'Writing'),
  (5, 'Spiritual'),
  (9, 'Buddism');

INSERT INTO BookCategory VALUES
  (1, 2, 34.32),
  (1, 5, 24.23),
  (1, 9, 54.65),
  (2, 5, 27.33),
  (2, 9, 28.32),
  (3, 2, 30.43),
  (3, 5, 27.87); 
```

解决方案：

```
SELECT Book.name
  FROM (
         SELECT DISTINCT ON (book_id)
             *
           FROM BookCategory
           ORDER BY book_id, rank DESC
       ) t
  JOIN Book ON Book.id = t.book_id
  WHERE t.category_id = 2
  ORDER BY t.rank; 
```

从逻辑上讲，`FROM`子句中的子查询为每本书生成一个与排名最高的类别的关系，然后您从中选择该类别中的书籍并按该类别中的排名对它们进行排序。

结果：

```
   姓名    
------------
 悉达多
(1 行)

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:59:43.963

这是你想要的吗？

```
SELECT 
  book.name, mx.max_rank
FROM
  (SELECT 
     max(rank) AS max_rank , book_id 
   FROM BookCategory WHERE category_id = 2 
   GROUP BY 
     book_id
  ) mx
JOIN Book ON 
  mx.book_id = Book.id 
```

如果我正确理解您的问题，您需要为 BookCategory 中的每本书获取给定类别的最大值（这是内部选择所做的），然后只需将其加入 book_id 上的 Book 表。

整个例子在[SQL Fiddle](http://sqlfiddle.com/#!3/cb1e2/1)

编辑：

我看到已经有一个公认的答案，但为了完整起见，这是我在澄清问题后的答案：

```
SELECT 
  Book.name 
FROM
  (SELECT max(rank) AS max_rank, book_id AS bid
   FROM BookCategory GROUP BY book_id
  ) mx
JOIN BookCategory ON
  rank = max_rank
  AND book_id = bid
JOIN Book
  ON book_id = Book.id
WHERE category_id = 2 
```

在[SQL 小提琴](http://sqlfiddle.com/#!3/cb1e2/13)上。

# asp.net-mvc - MVC 成员数据库上下文？

> ID：11868171
> 
> 赞同：0
> 
> 时间：2012-08-08T15:39:16.190
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, asp.net-membership

如何连接到会员数据库以检索用户帐户列表？例如，我有这个连接到我的个人资料：

```
 Private db As UserProfileDbContext = New UserProfileDbContext

    '
    ' GET: /UserProfile/

    Function Index() As ViewResult
        Return View(db.UserProfiles.ToList())
    End Function 
```

帐户模型中似乎没有指定任何用户帐户数据库上下文。我应该创建一个，还是有更好的方法将所有用户帐户检索到上面的列表中？

编辑：

我在控制器中有这段代码：

```
'
' GET: /Account/ViewRegistries

Function ViewRegistries() As ViewResult
    Return View(Membership.GetAllUsers().Cast(Of MembershipUser).ToList)
End Function 
```

我的观点：

```
@ModelType IEnumerable(Of MyBlog.RegisterModel)

@Code
    ViewData("Title") = "Index"
End Code

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>
        <th>
            UserId
        </th>
        <th>
            CompanyId
        </th>
        <th></th>
    </tr>

@For Each item In Model
    Dim currentItem = item
    @<tr>
        <td>
            @Html.DisplayFor(Function(modelItem) currentItem.UserName)
        </td>
        <td>
            @Html.DisplayFor(Function(modelItem) currentItem.Company)
        </td>
    </tr>
Next

</table> 
```

但它会产生一个错误：

> 传入字典的模型项的类型为“System.Collections.Generic.List `1[System.Web.Security.MembershipUser]', but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable`1[MyBlog.RegisterModel]”。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:44:06.033

您可以使用会员提供者：

```
Membership.GetAllUsers() 
```

注册用户后，这将返回数据库中所有用户的列表。

# c# - 如何将不同类型的泛型类（都具有泛型基类）存储在同一个集合中？

> ID：11868178
> 
> 赞同：2
> 
> 时间：2012-08-08T15:39:37.030
> 
> 标签：c#, generics, collections, base-class

我有一个与[这篇文章](https://stackoverflow.com/questions/7066506/how-do-i-create-a-list-of-objects-that-inherit-from-the-same-generic-class-with)中的问题类似的问题。

我还看到网上成千上万的帖子说您可以将任何扩展特定基类的泛型类放入基类类型的集合中。我完全理解这一点。

我的问题与上面的链接帖子和其他问题在一个基本方面有所不同——我的泛型类有一个也是泛型的基类。更糟糕的是，这是一个非常大的 MVVM 应用程序框架（内部构建）的一部分，通用基类也有一个基类等等......每个基类都添加了某些属性和功能，看起来有点像这样：

> DataListEntry<T> <-- BaseSynchronisableDataType<T> <-- BaseAuditDataType <-- BaseDataType <-- BaseAnimatableDataType

应用程序集合类使用类似的继承：

> DataList<T> <-- BaseSynchronisableCollection<T> <-- BaseAnimatableCollection<T> <-- BaseCollection<T> <-- SortableObservableCollection<T>

更糟糕的是，每个泛型声明都有约束，例如，BaseSynchronisableDataType<T> 的定义如下所示：

```
public abstract class BaseSynchronisableDataType<T> : BaseAuditDataType, 
    ISynchronisable<T>, ICloneable<T>, IEquatable<T> where T : class, ICloneable<T>,
    IEquatable<T>, new() 
```

因此，每个泛型集合类型都通过这些约束绑定到泛型基类。希望到现在为止，您可以看到我的问题的规模。

我尝试使用接口（上面未显示）从集合中删除链接到它们各自的基类，但这也失败了，因为相关类的一些通用约束。例如，我无法创建接口类型的集合，因为某些基类上有必要的通用“类”约束，所以我收到错误说集合的类型“必须是非抽象类型”一个公共无参数构造函数，以便将其用作泛型类型或方法中的参数“T”。

最后一点要注意准确描述了我正在尝试做的事情：

我需要使用所有扩展 DataList<T> 基类的不同类填充集合。这些类仅在名称上有所不同，并且具有完全相同的属性。它们声明如下：

```
public class Writer : DataListEntry<Writer>    
public class Artist : DataListEntry<Artist>etc. 
```

如果您有任何想法，请告诉我……我已经为这个问题苦恼了 2 天，我的老板很不高兴！非常感谢，谢里登。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T16:52:05.110

这里有一个关键原则，你需要理解`Foo<Child>`——`Foo<Parent>` *即使`Child`是`Parent`*. 这意味着 a`List<Foo<Parent>>`不能包含`List<Foo<Child>>`比它可以包含字符串或 Int32 更多的实例。

为了理解为什么会这样，想象下面的代码（它不能编译，但说明了为什么上面的语句必须是真的）：

```
var myIntList = new List<Int>();
var myObjectList = (List<Object>)myIntList;

// Uh oh, now I can add a string to a list of integers...
myObjectList.Add("Foo"); 
```

您对[奇怪重复出现的模板模式](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)的使用消除了所有类之间的继承层次结构。因为它们不再共享一个基类，所以它们不能被放入一个更具体的列表中`List<Object>`

在您的情况下，最好的方法可能是创建一个 DataListEntry 实现的非通用接口，并列出该接口。如果接口在该类型的实例中提供了您需要的所有成员，那么您就完成了。

例如：

```
public interface IDataListEntry { 
    bool QuacksLikeADuck { get; } 
    bool WalksLikeADuck { get; }
}

public abstract class DataListEntry<T> : IDataListEntry where ... {
    // Implement these in subclasses
    abstract bool QuacksLikeADuck { get; } 
    abstract bool WalksLikeADuck { get; } 
} 
```

那么你就可以：

```
List<IDataListEntry> myDataListEntries = new List<IDataListEntry>();
myDataListEntries.Add(new Writer(...));
myDataListEntries.Add(new Artist(...));
IEnumerable ducks = myDataListEntries.Where(dle => dle.WalksLikeADuck && dle.QuacksLikeADuck); 
```

或者（可能更适合您的情况），如果您需要知道`T`特定实例中的类型`IDataListEntry`：

```
public interface IDataListEntry { 
    Type TheTypeOfT { get; }
}

public class DataListEntry<T> : IDataListEntry where ... {
    Type TheTypeOfT { get { return typeof(T); } }
} 
```

然后做：

```
List<IDataListEntry> myDataListEntries = new List<IDataListEntry>();
myDataListEntries.Add(new Writer(...));
myDataListEntries.Add(new Artist(...));
IEnumerable artists = myDataListEntries.Where(dle => typeof(Artist).IsAssignableFrom(dle.TheTypeOfT)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:55:26.097

我会一直回到基础，并使用一些简单的 linq 来获取类过滤列表。

声明您的类型对象列表，`DataList<object> L`然后当您被要求输入类型时，调用`L.OfType<Type>()`过滤列表的方法。毕竟 object 将是你可以使用的最通用的东西。您也许可以使用 all 扩展的基本类型，但是因为它是抽象的，我不知道您是否可以在该类型上声明一个列表。

在我自己的代码中，我使用通用约束来实现类似的东西。

```
public abstract class BusinessObjectBase : //some interfaces
{
    //class stuff and events
} 
```

我有一堆扩展我的基类的对象，现在我可以做到这一点

```
Collection<BusinessObjectBase> temp = new Collection<BusinessObjectBase>();
temp.Add(new RXEvents());
temp.Add(new RXBattery());
temp.Add(new RXBHA()); 
```

我添加到列表中的每个类都是通过扩展 BusinessObjectBase 创建的。您正在尝试一些非常相似的东西，但您的基本实现不同。通过将基类型本身声明为模板化，您正在破坏基类型。Base 与 Base 相同，两者除了对象之外没有任何共同点。

`Base<>`与`Base<X>`or无关`Base<Y>`。现在如果你像这样描述它

```
public abstract class BaseSynchronisableDataType<T> : BaseAuditDataType, ISynchronisable<T>, ICloneable<T>, IEquatable<T> where T : MyCustomBaseClass, ICloneable<T>, IEquatable<T>, new() 
```

然后您可以将其`MyCustomBaseClass`用作列表类型，因为您可以保证所有`<T>`表示的对象都是它的子对象。这似乎违背了创建 BaseSynchronisableDataType 的目的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:56:03.117

好的，所以问题是我无法声明以下内容

```
DataList<Artist> artists = new DataList<Artist>(); 
```

由于对扩展`BaseDataListEntry`的泛型`BaseSynchronisableCollection<T>`类的泛型约束，该类不是泛型的。`DataList<T>`它必须是类无法扩展`T`的类型`BaseSynchronisableDataType<T>`，因为它不是通用的。`BaseDataListEntry`我需要`BaseDataListEntry`该类不是通用的，以便我可以将所有不同`DataList<T>`的集合放入`DataList<BaseDataListEntry>`视图模型中的集合中（一次一个取决于用户的选择）。

解决方案是创建一个`IBaseSynchronisableDataType<T>`接口并在通用约束而不是具体`BaseSynchronisableDataType<T>`类中使用它。然后，我在`BaseDataListEntry`课堂上实现了它，所以现在所有的约束都得到了满足。不知道为什么我没有早点看到它。

谢谢你所有的时间。

# asp.net-mvc-3 - 通过 Internet 使用的非 IIS 托管 WCF 服务通过 Internet 连接到后端数据库

> ID：11868180
> 
> 赞同：0
> 
> 时间：2012-08-08T15:39:39.127
> 
> 标签：asp.net-mvc-3, wcf, sql-server-2008, architecture

我对系统架构有点陌生。也就是说，我所有的 Web 应用程序都相对扁平......运行最多的 Web 客户端和数据库的两台机器。

我收到了以下架构：

1 台 VMware 机器将运行 Web 应用程序，一个 MVC 3 应用程序。

1 台 VMWare 机器将托管 SQL Server 数据库

1 台 VMWare 机器将托管服务。

我感到困惑的机器是最后一台。据我了解，服务项目包含对其他三个项目的引用：模型，实体框架 edmx 所在的项目，实体项目，其中包含使用实体 edmx 文件作为输入的 T4 模板，以及业务项目，它是实际的业务规则得到实施，CRUD 行动的实质发生。

据我了解，其目的不是运行 IIS WCF Web 服务接口，而是通过 Internet 调用机器上的 WCF 服务（如托管在 MMC 服务管理单元中的服务）。服务项目的解决方案中有一个部署项目，但我不知道它是否配置正确。我认为这个想法是在服务机器上运行安装程序，它会工作。

**我的具体问题是在实施、配置和部署这些服务时是否需要牢记任何重要的事情？**

我对这一切有点陌生。我的印象是您必须通过 IIS 托管端点调用 WCF 服务，并且您不能（或者至少不建议）通过 Internet 对计算机进行类似于 RPC 的调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:47:57.817

由于您是 WCF 服务的新手，因此我建议您阅读这篇关于[托管和使用 WCF 服务](http://msdn.microsoft.com/en-us/library/bb332338.aspx)的 MSDN 文章。

根据您的描述，您似乎正在`Windows Service`用作 WCF 服务的主机。

主机最常见的选择是`IIS`因为它具有广泛的功能，包括自启动服务、易于部署、负载平衡等。

`Windows Service`是有效的主持人，前提是您可以证明问题的合理性`'Why not IIS?'`。也许，您需要完全控制 WCF 服务的激活和生命周期。没有把握。

ps 确保运行 Windows 服务的帐户具有最低权限。

# android - 如何更改 DialogFragments 的 Show/Remove Dialog 和 onPrepareDialog

> ID：11868187
> 
> 赞同：1
> 
> 时间：2012-08-08T15:40:11.557
> 
> 标签：android, dialog, android-fragments

我正在开发一个 Android 项目。我需要使用 Android 1.6 或更高版本。

我的项目正在运行，但现在它向我显示了一些关于对话框的警告，例如

```
"The method dismissDialog(int) from the type Activity is deprecated"
"The method showDialog(int) from the type Activity is deprecated", etc. 
```

所以我想“更新”我的项目来解决这些警告。

我已经阅读并制作了一些测试项目来了解 Fragments 和 DialogFragment。我已经创建了自己的 ProgressDialog，我想在我的真实项目中使用它，但是我遇到了一些问题。

```
public class MyProgressDialog extends DialogFragment {

public MyProgressDialog(){

}

@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {

    Context context = getActivity();

    ProgressDialog dialog = new ProgressDialog(context);

    Resources resources = context.getResources();

        String message = resources.getText(R.string.wait).toString();

    dialog.setMessage(message);
    dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);

    return dialog;
    }
} 
```

在我的项目早期，我创建了`ProgressDialog`，然后在`onPrepareDialog()`方法中，我调用了`AsyncTask`连接服务器、下载数据等。然后在`onPostExecute`AsyncTask 中，我关闭了`ProgressDialog`并启动了新的 Activity。但现在我不能这样做，因为`onPrepareDialog`已弃用。

**在 Activity 的 onPrepareDialog 上调用 ActionAsyncTask**

```
@Override
protected void onPrepareDialog(int id, Dialog dialog) {     
    switch(id){

        case Constants.PROGRESS_DIALOG:
                                    new ActionAsyncTask().execute();
                                    break;
    }
} 
```

**ActionAsyncTask 的 onPostExecute**

```
@Override
protected void onPostExecute(Integer result) {
    dismissDialog(Constants.PROGRESS_DIALOG);
} 
```

如何解决这个问题？这样做的正确方法是什么？我想为此编写最好的代码，最有效的代码。

谢谢。

# r - 按从低到高的顺序排列 y 轴刻度

> ID：11868188
> 
> 赞同：0
> 
> 时间：2012-08-08T15:40:16.917
> 
> 标签：r, ggplot2

我有以下数据，并且 y 轴排序有一些问题 =

```
> str(dat)
'data.frame':   3678 obs. of  41 variables:
 $ highest_bid                 : Factor w/ 140 levels "\\N","0","10",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ age_of_oldest_driver        : Factor w/ 75 levels "18","19","20",..: 66 11 33 24 57 3 17 5 32 22 ... 
```

当我绘制年龄的最高出价时，我得到了想要的情节，但年龄是按因素排序的，这不是我想要的。y 轴从 180、19、200、2300、25、230、250 等开始。由于像 19、25 和 2300 这样的值，它会破坏 y 轴的顺序。见下图。

```
ggplot(dat, aes(x=factor(age_of_oldest_driver), y=highest_bid)) + 
      stat_summary(fun.y="mean", geom="bar") 
```

现在，我生成了一些示例数据来解决这个问题，但我似乎无法重现它。这就是我所做的。再一次，这完美无缺。

```
df=data.frame(score=c(400,200,3000,500,751,630,554,630,100,250,330,5100,4100,800),
              age=c(18,18,23,50,19,39,19,23,22,22,40,35,22,16))
str(df)
ggplot(df, aes(x=factor(age), y=factor(score))) + geom_bar()

library(plyr)
library(ggplot2)
ggplot(ddply(df, .(age), mean), aes(x=factor(age), y=factor(score))) + geom_bar() 
```

关于我在发布的初始代码中做错了什么的任何想法。

谢谢！！

这是错误的图像。注意 y 轴。

![在此处输入图像描述](../Images/c3dfb1ba812d941ea873d1d8ec5c7b94.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:47:21.997

您可以在绘制之前重新排序原始因子（年龄）

```
df$ageord <- factor(df$age, levels = levels(factor(df$age)), ordered = TRUE )

require(ggplot2)
ggplot(df, aes(x=ageord, y = score)) + geom_bar(stat = "identity") 
```

**编辑**：如果它不起作用

```
df$ageord <- factor(df$age, levels = sort(unique(df$age)), ordered = TRUE )

ggplot(df, aes(x=ageord, y = score)) + geom_bar(stat = "identity") 
```

# saas - 要阻止哪些 SaaS 子域

> ID：11868191
> 
> 赞同：4
> 
> 时间：2012-08-08T15:40:40.443
> 
> 标签：saas, subdomain

我正在开发一个 SaaS（软件即服务）Web 应用程序，并且我正在为单独的帐户使用子域。

我应该阻止用户使用哪些子域。

我目前拥有的是……管理员、管理员、博客、支持和帮助。我记得在 Quora 上看到过一个关于它的问题，但我再也找不到了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T18:55:28.767

感谢您的建议。我制作了一个 Rubygem 来阻止可以在此处找到的大量子域 - [https://github.com/deanperry/saas_deny_subdomains](https://github.com/deanperry/saas_deny_subdomains)

只需添加`deny_subdomains :subdomain`(:subdomain) 作为字段，它将阻止/拒绝大量子域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T05:23:47.543

这是我的 PHP 版本。我添加了一些我的 + 线程中建议的 + 院长佩里的。通过使用一些正则表达式，我能够涵盖很多场景。

```
/**
 * Checks if the subdomain is good. e.g. forbidden names are: ssl, secure, test, tester etc.
 * @see http://stackoverflow.com/questions/11868191/which-saas-subdomains-to-block
 * @see https://github.com/deanperry/saas_deny_subdomains/blob/master/lib/saas_deny_subdomains/subdomains.rb
 * @return boolean
 */
public function isSubdomainAvailable($subdomain) {
    $banned_subdomains_csv = 'admin, login, administrator, blog, dashboard, admindashboard, images?, img, files?, videos?, help, support, cname, test, cache, mystore, biz, investors?
    api\d*, js, static, s\d*,ftp, e?mail,webmail, webdisk, ns\d*, register, join, registration, pop\d?, beta\d*, stage, deploy, deployment,staging, testers?, https?, donate, payments, smtp,
    ad, admanager, ads, adsense, adwords?, about, abuse, affiliate, affiliates, store, shop, clients?, code, community, forum?, discussions?, order, buy, cpanel, store, payment,
    whm, dev, devel, developers?, development, docs?, whois, signup, gettingstarted, home, invoice, invoices, ios, ipad, iphone, logs?, my, status, networks?, 
    new, newsite, news, partner, partners, partnerpage, popular, wiki, redirect, random, public, resolver, sandbox, search, servers?, service,uploads?, validation,
    signin, signup, sitemap, sitenews, sites, sms, sorry, ssl, staging,features, stats?, statistics?, graphs?, surveys?, talk, trac, git, svn, translate, validations, webmaster,
    www\d*, feeds?, rss, asset[s\d]*, cp\d*, control panel, online, media, jobs?, secure, demo, i\d*, img\d*, css\d*, js\d*';

    $regex = $banned_subdomains_csv;
    $regex = preg_replace('#\s#si', '', $regex); // rm new lines, spaces etc
    $regex = preg_replace("#,+#si", '|', $regex); // more than one comma
    $regex = trim($regex, ','); // remove any leading/trailing commas
    $regex = '#^(?:' . $regex . ')$#si'; // let's create a nice regex.

    $status = !preg_match($regex, $subdomain); // without main domain added

    return $status;
} 
```

斯拉维

[http://orbisius.com](http://orbisius.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:47:35.777

命名视图：

*   万维网
*   帮助
*   支持
*   行政
*   api
*   资产0-x

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T21:56:34.167

除了提到的那些：

*   测试
*   舞台/舞台
*   开发/开发
*   地位
*   邮件
*   网络邮件
*   ftp
*   饲料
*   SSL/安全
*   演示
*   混帐/svn
*   文件/文档

可能还想保留您自己的名字和任何变体。

**编辑：**只是一个想法，也许是最重要的，但你也可以考虑保留 i.example.com 之类的东西（“i”代表内部）然后你就有了一个完整的 *.i.example.com 命名空间内部使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-23T01:12:25.233

解决此问题的另一种方法是您的客户的用户名或公司在`app-tenant.domain.com`哪里。`tenant`这意味着您可以在您的 DNS 设置中使用 app-*.domain.com 之类的内容来为您的用户打卡。但是，如果您使用应用程序级别的负载均衡器，那应该会更容易。恕我直言，这看起来更漂亮。 **注意**：app.**.domain.com 是无效的 AFAIK

# c# - 存储树结构的集合是什么？

> ID：11868192
> 
> 赞同：13
> 
> 时间：2012-08-08T15:40:44.227
> 
> 标签：c#, collections, tree

我想将组织结构图存储在集合中。我认为树数据结构最适合我的需要，因为我需要将多个节点添加到一个节点。

`LinkedList`如果我理解正确，仅提供将一个节点添加到另一个节点。

我查看了 C5`treeset`集合，但似乎没有`Add()`将超过 2 个节点添加到一个节点的方法。

我还查看了`Treeview`Windows 窗体库中的类，但我不想将 Windows 窗体*dll*添加到我的项目中，因为我正在构建一个服务层应用程序。（或者还好吗？）

我不想编写自己的树集合类，如果第 3 方已经提供了一个？

请问有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-09T08:09:28.577

这样的事情可以作为一个起点。通过使用泛型，这个可以容纳任何东西的树

```
class TreeNode<T>
{
    List<TreeNode<T>> Children = new List<TreeNode<T>>();

    T Item {get;set;}

    public TreeNode (T item)
    {
        Item = item;
    }

    public TreeNode<T> AddChild(T item)
    {
        TreeNode<T> nodeItem = new TreeNode<T>(item);
        Children.Add(nodeItem);
        return nodeItem;
    }
} 
```

一个包含字符串树的样本

```
string root = "root";
TreeNode<string> myTreeRoot = new TreeNode<string>(root);
var first = myTreeRoot.AddChild("first child");
var second = myTreeRoot.AddChild("second child");
var grandChild = first.AddChild("first child's child"); 
```

# orchardcms - Orchard CMS 预热状态为零

> ID：11868195
> 
> 赞同：1
> 
> 时间：2012-08-08T15:40:50.683
> 
> 标签：orchardcms

我在 Windows 2008 Server 上使用 Web 平台安装程序设置了一个全新的 Orchard CMS 1.5.1 站点。我想测试性能设置，所以我每行配置了以下预热条目：

/

/博客

...并检查了以下选项：

x 定期生成预热页面 90 每分钟

x 每次发布某些内容时都会生成预热页面

当我访问该站点时，性能仍然有点慢。性能预热设置显示每个页面的状态为零，旁边有一个红色的“向下箭头”图标。

还有什么我需要启用的吗？我在配置中是否缺少任何东西，例如权限等。

**更新：**

我注意到我的网站没有用于存储热身页面的文件夹。我手动添加了该文件夹，但它仍然没有解决我的问题。我需要在该文件夹上设置权限吗？

**更新 2：**

在与 Sebastien Ros 交谈后，我想我明白了什么是错误的，但仍然不知道如何解决它。Orchard 中的基本 URL 设置应设置为“www.mydomain.com”，但在网络方面，我的服务器不允许我的站点连接到 Internet 并通过该地址查询自身以生成温暖-上页。更糟糕的是，我有几个站点托管在同一个 IP 地址上，并使用主机标头来区分站点。这甚至使我无法将基本 URL 配置为本地 IP 地址（这会导致其他模块出现问题）。

不知道我现在有什么选择。

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T11:43:03.063

Make sure that the general settings page is pointing to your base URL, i.e. [http://mywebsite.com](http://mywebsite.com). It may be pointing to the local host by default.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T18:12:54.243

我与我的服务器主机上的网络工程师确认，对于返回网站的传出请求存在网络限制。因此，性能模块无法查询 www.mydomain.com 并获得答案。移除网络限制后，我可以看到预热创建状态为 200 的缓存页面。

或者，建议我在我的主机文件中为我的每个 Orchard 站点创建条目。我没有尝试过，但我看不出为什么即使在我拥有的以主机为标题的情况下它也不起作用。

布赖恩

# javascript - jquery弹出菜单背景li

> ID：11868208
> 
> 赞同：0
> 
> 时间：2012-08-07T20:07:22.620
> 
> 标签：javascript, jquery

玩弄[http://tympanus.net/Tutorials/CufonizedFlyOutMenu/](http://tympanus.net/Tutorials/CufonizedFlyOutMenu/) 我放弃了飞入描述，现在试图让它加载额外的 li，其样式会“突出显示”li.current-menu-item。

它设置了一个对象：

```
var $moving = $('<li />',{
    class : 'move',
    top   : $selected[0].offsetTop + 'px',
        width : $selected[0].offsetWidth + 'px'
    }); 
```

稍后在代码中，它被操纵：

```
function moveTo($elem,speed){
    $moving.stop(true).animate({
        top     : $elem[0].offsetTop + 'px',
        width   : $elem[0].offsetWidth + 'px'
    }, speed, 'easeOutExpo');
} 
```

它创建了我想要的 li 项目......但它显示如下：

```
<li class="move" top="41px" style="width: 73px; "></li> 
```

如何让顶部显示为一种风格？一切大部分都在工作......但是在页面加载时，直到一切开始，它才获得“顶级”风格？

我加载了一个[http://jsfiddle.net/jq7YQ/26/](http://jsfiddle.net/jq7YQ/26/)但我根本无法让它在那里工作......叹息......但它确实在本地工作？

我是个菜鸟……所以我可能错过了一些愚蠢的东西……或者有更好的方法来做到这一点？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:30:41.383

该示例使用部分 jQuery UI（缓动），因此您需要包含它。该站点链接到“http://tympanus.net/Tutorials/CufonizedFlyOutMenu/jquery.easing.1.3.js”，如果您将其添加为 Fiddle 中的资源，则一切正常。

[http://jsfiddle.net/rlemon/jq7YQ/28/](http://jsfiddle.net/rlemon/jq7YQ/28/)看看。我所做的只是添加 jQuery 缓动文件（包含在 jQuery UI 中）

[这](http://jsfiddle.net/rlemon/jq7YQ/30/)是您问题的“选定”部分的示例。

# c - sizeof 是否返回 C 中某个类型的字节数或八位字节数？

> ID：11868211
> 
> 赞同：23
> 
> 时间：2012-08-08T15:41:45.030
> 
> 标签：c, byte, sizeof, word-size

简单地说，在 C 和变体中（不像 wuss java 和它的虚拟机）不同目标上的原始类型的大小可能会有很大差异，除非你使用定义的固定宽度类型，否则真的不能保证`stdint.h`，即使那样你的实现也有支持他们。

无论如何假设（因为在大多数现代机器上，一个字节是一个八位字节，出于网络目的，我​​假设（ASCII）） sizeof 是否以字节或八位字节返回数据类型的大小？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-08T15:43:52.400

答案：`sizeof`返回类型的大小（以**字节**为单位）。

* * *

示例：`sizeof(char)`100% 保证是`1`，但这并不意味着它是一个八位字节（8 位）。

* * *

标准证明：

在 6.5.3.4 中，第 2 点：

> **sizeof 运算符产生其操作数的大小（以字节为单位）**，它可以是表达式或类型的括号名称。大小由操作数的类型决定。结果是一个整数。如果操作数的类型是变长数组类型，则计算操作数；否则，不计算操作数，结果是一个整数常量。
> 
> ...
> 
> **当应用于具有 char、unsigned char 或 signed char 类型（或其限定版本）的操作数时，结果为 1**。当应用于具有数组类型的操作数时，结果是数组中的总字节数）当应用于具有结构或联合类型的操作数时，结果是此类对象中的总字节数，包括内部和尾随填充。

此外，在第 3.6 节第 3 点中：

> 一个字节由连续的位序列组成，位的数量由实现定义

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T15:43:40.413

`sizeof`总是以字节数返回大小。但根据[维基百科](http://en.wikipedia.org/wiki/Sizeof)：

> 在编程语言 C 和 C++ 中，一元运算符 sizeof 用于计算任何数据类型的大小，以表示该类型所需的字节数来衡量。在这种情况下，字节与无符号字符相同，**并且可能大于 8 位，尽管这并不常见**。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-08T15:45:09.993

`sizeof`以字节为单位给出大小。但是，请注意“字节”是 C 标准中的一个技术术语，其定义为`sizeof(char) == 1`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-28T14:12:28.367

根据我自己的经验，在使用具有异国情调的“C”编译器的嵌入式微控制器上工作时，我看到了：

```
sizeof( uint8 ) 
```

返回 1

```
sizeof( uint16 ) 
```

返回 1

```
sizeof( uint32 ) 
```

返回 2

显然，我在处理一台机器时最小的可寻址实体是 16 位的，所以 sizeof 不符合 C89 或 C99。

我想说，在主流 C89 和 C99 兼容系统上，公认的答案是正确的。不幸的是，“C”编译器仍然可以称为“C”编译器，即使它不符合 25 年前的标准。考虑到更多奇特的系统，我希望这个答案有助于正确看待事情。

# opengl - 我的 gluSphere 缺少补丁

> ID：11868215
> 
> 赞同：3
> 
> 时间：2012-08-08T15:42:03.610
> 
> 标签：opengl, geometry, glu

我正在尝试使用 gluSphere 绘制一个球体。球体出现，但无论我将其绘制为填充多边形还是线框，都缺少某些补丁。

```
int width=800, height=600;

    void myinit(void)
{
//      set up overall light data, including specular=ambient=light colors
    GLfloat light_position[]={ 10.0, 10.0, -10.0, 1.0 };
    GLfloat light_color[]={ 1.0, 1.0, 1.0, 1.0 };
    GLfloat ambient_color[]={ 0.0, 0.2, 0.2, 1.0 };
    GLfloat mat_specular[]={ 1.0, 1.0, 1.0, 1.0 };

    glClearColor( 0.0, 1.0, 1.0, 0.0 );
    glShadeModel(GL_SMOOTH);
    glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR, mat_specular );
    glLightfv(GL_LIGHT0, GL_POSITION, light_position );
    glLightfv(GL_LIGHT0, GL_AMBIENT, ambient_color );
    glLightfv(GL_LIGHT0, GL_SPECULAR, light_color );
    glLightfv(GL_LIGHT0, GL_DIFFUSE, light_color );

/* attributes */
    glEnable(GL_LIGHTING);   // so lighting models are used
    glEnable(GL_LIGHT0);     // we'll use LIGHT0
    glEnable(GL_DEPTH_TEST); // allow z-buffer display
    //glClearDepth(1);
}

void drawHead(){
GLUquadric *sphere=gluNewQuadric();
gluQuadricDrawStyle( sphere, GLU_FILL);
    gluQuadricNormals( sphere, GLU_SMOOTH);
gluQuadricOrientation( sphere, GLU_OUTSIDE);
gluQuadricTexture( sphere, GL_TRUE);

//glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);
glPushMatrix();
glTranslated(0,0,-5);
glRotated(30,1,1,1);
gluSphere(sphere,2.0,15,15);
glPopMatrix();
}

void display(){
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glColor3f(1,1,0);
drawHead();
glutSwapBuffers();
}

void main(int argc, char** argv){
glutInit(&argc,argv);
glutInitDisplayMode(GLUT_RGB | GLUT_DEPTH | GLUT_DOUBLE);
glutInitWindowSize(width,height);
glutInitWindowPosition(100,200);
glutCreateWindow("Automaton");

glMatrixMode(GL_PROJECTION);
glLoadIdentity();
gluPerspective(90.0,1.0,0.0,20);

glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
myinit();
glutDisplayFunc(display);

glutMainLoop();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:51:38.160

根据文档，[“...zNear 绝不能设置为 0。”](http://www.opengl.org/sdk/docs/man/xhtml/gluPerspective.xml#notes)

让你的 zNear 稍微突出一点，你的 zFar 稍微突出一点：

```
gluPerspective( 90.0, 1.0, 1.0, 200.0 ); 
```

完全的：

```
#include <GL/glut.h>

int width=800, height=600;

void myinit(void)
{
    // set up overall light data, including specular=ambient=light colors
    GLfloat light_position[]={ 10.0, 10.0, -10.0, 1.0 };
    GLfloat light_color[]={ 1.0, 1.0, 1.0, 1.0 };
    GLfloat ambient_color[]={ 0.0, 0.2, 0.2, 1.0 };
    GLfloat mat_specular[]={ 1.0, 1.0, 1.0, 1.0 };

    glClearColor( 0.0, 1.0, 1.0, 0.0 );
    glShadeModel(GL_SMOOTH);
    glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR, mat_specular );
    glLightfv(GL_LIGHT0, GL_POSITION, light_position );
    glLightfv(GL_LIGHT0, GL_AMBIENT, ambient_color );
    glLightfv(GL_LIGHT0, GL_SPECULAR, light_color );
    glLightfv(GL_LIGHT0, GL_DIFFUSE, light_color );

    /* attributes */
    glEnable(GL_LIGHTING);   // so lighting models are used
    glEnable(GL_LIGHT0);     // we'll use LIGHT0
    glEnable(GL_DEPTH_TEST); // allow z-buffer display
}

void drawHead()
{
    GLUquadric *sphere=gluNewQuadric();
    gluQuadricDrawStyle( sphere, GLU_FILL);
    gluQuadricNormals( sphere, GLU_SMOOTH);
    gluQuadricOrientation( sphere, GLU_OUTSIDE);
    gluQuadricTexture( sphere, GL_TRUE);

    glPushMatrix();
    glTranslated(0,0,-5);
    glRotated(30,1,1,1);
    gluSphere(sphere,2.0,15,15);
    glPopMatrix();
}

void display()
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glColor3f(1,1,0);
    drawHead();
    glutSwapBuffers();
}

void main(int argc, char** argv)
{
    glutInit(&argc,argv);
    glutInitDisplayMode(GLUT_RGB | GLUT_DEPTH | GLUT_DOUBLE);
    glutInitWindowSize(width,height);
    glutInitWindowPosition(100,200);
    glutCreateWindow("Automaton");

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective( 90.0, 1.0, 1.0, 200.0 );

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    myinit();
    glutDisplayFunc(display);

    glutMainLoop();
} 
```

# c# - WPF 窗口显示空白

> ID：11868216
> 
> 赞同：3
> 
> 时间：2012-08-08T15:42:06.047
> 
> 标签：c#, wpf, excel, add-in

Excel 插件、c#、.net 4.0、windows 7、功能区 我的插件有一个功能区选项卡，几个功能区按钮，当单击一个功能区时，插件将发送多个 Web 服务调用，并弹出一个窗口，在选项卡、树视图中提供数据，gridview 等treeview 中的数据，gridview 是从Web 服务调用中填充的。直到昨天，所有这些都为特定的最终用户工作。当他单击按钮时，窗口似乎出现了，但它有点落后于 Excel，无法集中注意力。它也是空白的，没有选项卡、树视图、网格视图等。我验证了所有 Web 服务调用都正确返回。用户拥有 Windows 7、Excel 2010（32 位）。我不知道是什么原因造成的。请帮忙。这是我的 WPF 窗口。谢谢

```
<Window x:Class="MIMICWPFLib.MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
xmlns:sharedC="clr-namespace:MIMICShared.Converter;assembly=MstarCommodityShared" 
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" 
    xmlns:dxt="clr-namespace:DevExpress.Xpf.Utils.Themes;assembly=DevExpress.Xpf.Core.v11.2"
    xmlns:Controls="clr-namespace:MIMICWPFLib.Controls"
    Title="{Binding Title}"        
Height="600" Width="850" Top="223" Left="164" ResizeMode="CanResize" Closing="WindowClosing"
WindowStyle="ToolWindow">
<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="MainWindowResources.xaml" />
            <ResourceDictionary Source="Controls/BizzySpinner.xaml" />
        </ResourceDictionary.MergedDictionaries>
        <sharedC:BooleanToHiddenVisibility x:Key="boolToVis"/>
        <sharedC:NegativeBooleanToHiddenVisibiltyConverter x:Key="negativeBoolToVis" />
        <DataTemplate x:Key="{dxt:DXTabControlThemeKey ResourceKey=BackgroundTemplate, ThemeName=Office2007Silver}">
            <Border BorderBrush="#FF828790" BorderThickness="1" Background="#E5E3E3"/>
        </DataTemplate>
        <DataTemplate x:Key="{dxt:DXTabControlThemeKey ResourceKey=BackgroundTemplate}">
            <Border BorderBrush="#FF828790" BorderThickness="1" Background="White"/>
        </DataTemplate>
        <ControlTemplate x:Key="{dxt:DXTabControlThemeKey ResourceKey=TopLayoutTemplate}" TargetType="{x:Type dx:DXTabControl}">
            <Grid>
                <KeyboardNavigation.TabNavigation>Local</KeyboardNavigation.TabNavigation>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Margin="0,2,0,0" x:Name="tabHeadersPanel">
                    <KeyboardNavigation.TabIndex>1</KeyboardNavigation.TabIndex>
                    <KeyboardNavigation.DirectionalNavigation>Cycle</KeyboardNavigation.DirectionalNavigation>
                    <KeyboardNavigation.TabNavigation>Once</KeyboardNavigation.TabNavigation>
                    <Panel.ZIndex>1</Panel.ZIndex>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <dx:ClippedContainer Grid.Column="0" UseLayoutRounding="{TemplateBinding UseLayoutRounding}"
                                 Style="{DynamicResource {dxt:DXTabControlInternalThemeKey ResourceKey=ClippedContainerTopLayoutStyle}}">
                        <dx:TabPanelContainer x:Name="panelContainer" Style="{DynamicResource {dxt:DXTabControlInternalThemeKey ResourceKey=PanelContainerTopLayoutStyle}}">
                            <dx:TabPanelContainer.Resources>
                                <Storyboard x:Key="ScrollStoryboard">
                                    <DoubleAnimation Storyboard.TargetName="ItemsPanelTranslate" 
                                         Storyboard.TargetProperty="X" Duration="0:0:0.4" To="0">
                                        <DoubleAnimation.EasingFunction>
                                            <ExponentialEase EasingMode="EaseOut" Exponent="0" />
                                        </DoubleAnimation.EasingFunction>
                                    </DoubleAnimation>
                                </Storyboard>
                            </dx:TabPanelContainer.Resources>
                            <ItemsPresenter>
                                <ItemsPresenter.RenderTransform>
                                    <TranslateTransform x:Name="ItemsPanelTranslate" />
                                </ItemsPresenter.RenderTransform>
                            </ItemsPresenter>
                        </dx:TabPanelContainer>
                    </dx:ClippedContainer>
                    <dx:TabControlScrollButton x:Name="PrevButton" Grid.Column="1" Style="{DynamicResource {dxt:DXTabControlThemeKey ResourceKey=PrevButtonStyle}}" 
                                       Margin="{DynamicResource {dxt:DXTabControlInternalThemeKey ResourceKey=ComponentsSpaceForHorizontalLayouts}}" />
                    <dx:TabControlScrollButton x:Name="NextButton" Grid.Column="2" Style="{DynamicResource {dxt:DXTabControlThemeKey ResourceKey=NextButtonStyle}}" 
                                       Margin="{DynamicResource {dxt:DXTabControlInternalThemeKey ResourceKey=ComponentsSpaceForHorizontalLayouts}}" />
                    <!--<dx:HeaderMenu Grid.Column="3" x:Name="HeaderMenu" IsTabStop="False" Style="{DynamicResource {dxt:DXTabControlThemeKey ResourceKey=HeaderMenuStyle}}" 
                           Margin="{DynamicResource {dxt:DXTabControlInternalThemeKey ResourceKey=ComponentsSpaceForHorizontalLayouts}}" />-->
                    <Controls:HeaderMenuForDXTabControl Grid.Column="3" 
                                    x:Name="HeaderMenu"
                                    IsTabStop="False" 
                                    Style="{DynamicResource {dxt:DXTabControlThemeKey ResourceKey=HeaderMenuStyle}}" 
                                    Margin="{DynamicResource {dxt:DXTabControlInternalThemeKey ResourceKey=ComponentsSpaceForHorizontalLayouts}}" />
                </Grid>
                <Grid Grid.Row="1">
                    <dx:DXContentPresenter  ContentTemplate="{DynamicResource {dxt:DXTabControlThemeKey ResourceKey=BackgroundTemplate}}" IsTabStop="False">

                    </dx:DXContentPresenter>
                    <Grid Margin="1">
                        <dx:DXContentPresenter x:Name="contentPresenter" Margin="{TemplateBinding Padding}" UseLayoutRounding="{TemplateBinding UseLayoutRounding}"
                                   Content="{TemplateBinding SelectedItemContent}" ContentTemplate="{TemplateBinding SelectedItemContentTemplate}">

                            <KeyboardNavigation.TabNavigation>Local</KeyboardNavigation.TabNavigation>
                            <KeyboardNavigation.DirectionalNavigation>Contained</KeyboardNavigation.DirectionalNavigation>
                            <KeyboardNavigation.TabIndex>2</KeyboardNavigation.TabIndex>

                        </dx:DXContentPresenter>
                        <dx:TabControlFastRenderPanel x:Name="fastRenderPanel" Margin="{TemplateBinding Padding}" UseLayoutRounding="{TemplateBinding UseLayoutRounding}" Visibility="Collapsed">

                            <KeyboardNavigation.TabNavigation>Local</KeyboardNavigation.TabNavigation>
                            <KeyboardNavigation.DirectionalNavigation>Contained</KeyboardNavigation.DirectionalNavigation>
                            <KeyboardNavigation.TabIndex>2</KeyboardNavigation.TabIndex>

                        </dx:TabControlFastRenderPanel>
                    </Grid>
                </Grid>
            </Grid>
        </ControlTemplate>
    </ResourceDictionary>        
</Window.Resources>
<Grid>
    <Grid Visibility="{Binding ShowProgress, Converter={StaticResource negativeBoolToVis}}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" ></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>                
        </Grid.RowDefinitions>            
        <Grid Grid.Row="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="65"></RowDefinition>                
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"></ColumnDefinition>
            <ColumnDefinition Width="Auto" MinWidth="2"></ColumnDefinition>               
        </Grid.ColumnDefinitions>

            <Image Grid.Row ="0" Height="37" Width="174" Margin="11,6,0,0" 
                   Name="image1" Stretch="Fill" VerticalAlignment="Top" 
                   HorizontalAlignment="Left" 
                   Source="/MstarCommodityWPFLib;component/Resources/MorningstarLogo_Red.gif" />

            <Border  Grid.ColumnSpan="1" Grid.Row="0" HorizontalAlignment="Right" Margin="0,10,0,0" 
                     Height="50" Width="400" Background="white" BorderThickness="1" BorderBrush="White"  >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="23"/>
                        <RowDefinition Height="4"/>
                        <RowDefinition Height="23"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                    <ContentControl Content="{Binding Path=SearchBox}" Margin="0 0 5 0" />
                    <TextBlock Grid.Row="0" Grid.Column="1"> 
                    <Hyperlink Click="ShowSettings" TextDecorations="None">
                        <Image Source="{Binding ConfigImageFilePath}"  ></Image>
                    </Hyperlink>
                    </TextBlock>
                    <TextBlock Grid.Row="2" Grid.Column="1"> 
                    <Hyperlink Click="HelpHyperlinkClick"> 
                        <Image Source="{Binding HelpIconFilePath}"></Image>
                    </Hyperlink>
                    </TextBlock>
                </Grid>
            </Border>                
        </Grid>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"></ColumnDefinition>
                <ColumnDefinition Width="Auto"></ColumnDefinition>
                <ColumnDefinition Name="columnWidth" MaxWidth="350"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid x:Name="horizontalGrid">                
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="125"></RowDefinition>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Name="rowHeight" MinHeight="150"></RowDefinition>
                </Grid.RowDefinitions>

                <dx:DXTabControl Grid.Row="0"  
                    Margin="10 0 5 5"
                    Name="MainTabRegion"  
                    SelectedIndex="{Binding Tabs.SelectedIndex}" 
                    ItemsSource="{Binding Tabs.TabItems}"  
                    DestroyContentOnTabSwitching="False" BorderThickness="5"                          
                    OverridesDefaultStyle="True">
                    <dx:DXTabControl.View>
                        <dx:TabControlScrollView 
                                     ShowHeaderMenu="True"  
                                     AllowHideTabItems="True" 
                                     CloseHeaderMenuOnItemSelecting="True" ShowHiddenTabItemsInHeaderMenu="True" />
                    </dx:DXTabControl.View>

                    <dx:DXTabControl.ItemContainerStyle>
                        <Style TargetType="{x:Type dx:DXTabItem}">
                            <Setter Property="Visibility" Value="{Binding IsVisible, Mode=OneWay, Converter={StaticResource boolToVis}}"/>
                        </Style>
                    </dx:DXTabControl.ItemContainerStyle>
                    <dx:DXTabControl.ItemHeaderTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Path=Header}" 
                                        Visibility="{Binding IsVisible, Mode=OneWay, Converter={StaticResource boolToVis}}"
                                        OverridesDefaultStyle="True" />
                        </DataTemplate>
                    </dx:DXTabControl.ItemHeaderTemplate>
                </dx:DXTabControl>

                <GridSplitter  Grid.Row="1" 
                  Margin="10 0 5 5"
                  HorizontalAlignment="Stretch" 
                  VerticalAlignment="Stretch"              
                  ShowsPreview="true"
                  ResizeDirection="Rows"                      
                  Height="5" />
                <Border Grid.Row="2" Margin="10 0 5 5">
                    <ContentControl Content="{Binding Path=Basket}" />
                </Border>
            </Grid>

            <GridSplitter Margin="0 20 0 0" Grid.Column="1"
              HorizontalAlignment="Stretch" 
              VerticalAlignment="Stretch"              
              ShowsPreview="true"
              ResizeDirection="Columns"
              x:Name="verticalSplitter"                    
              DragCompleted="OnDragCompleted"
              Width="5" />                

             <Border Grid.RowSpan="3" Grid.Column="2"  Margin="3 20 0 0">
                    <ContentControl Content="{Binding Path=ColumnDataPreview}" />
             </Border>

        </Grid>

    </Grid>
    <Grid Height="25" Width="300" Visibility="{Binding ShowProgress, Converter={StaticResource boolToVis}}">
        <ProgressBar IsIndeterminate="True" Orientation="Horizontal" />
        <Viewbox>
            <TextBlock Text="Loading ..." Padding="50 0"/>
        </Viewbox>
    </Grid>
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-10-06T21:17:38.297

我知道这已经过时了——但我们偶然发现了一个我们支持的旧版 Office 加载项——其中一个用户显然遇到了同样的问题。

我们做了一些挖掘，偶然发现了这个类似的 SO 帖子：[Blank WPF child windows on Windows 10](https://stackoverflow.com/questions/32003868/blank-wpf-child-windows-on-windows-10)

看起来有两种选择：

1.  指导用户更新/修复他们坏的显卡驱动程序。

2.  对代码进行修改，**强制**内容在正确的时刻重绘（即`InvalidateVisual`是不够的，请参阅链接问题的答案以获取更多信息）。

# api - JIRA，通过 SOAP api 获取父问题

> ID：11868220
> 
> 赞同：1
> 
> 时间：2012-08-08T15:42:23.723
> 
> 标签：api, soap, jira

我需要通过 SOAP API 甚至使用数据库来获取给定问题的父问题。这似乎是非常基本的目标，但是我在互联网上没有找到任何有用的信息。此外，我没有在 jira 的数据库表（jiraissue）中找到任何字段来设置问题的父问题。

附加信息：Jira 5.1、c# .Net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T08:16:19.970

据我所知，没有办法直接使用 SOAP 来做到这一点。

一种可能的解决方案是使用[Jira Scripting Suite](https://marketplace.atlassian.com/16346)。您可以创建一个后功能，该功能将在使用[getParentObject](http://docs.atlassian.com/jira/4.0/com/atlassian/jira/issue/Issue.html#getParentObject%28%29)`Open`将父级复制到自定义字段的状态之后运行。然后您可以使用 SOAP 函数[getCustomFields](http://docs.atlassian.com/rpc-jira-plugin/latest/com/atlassian/jira/rpc/soap/JiraSoapService.html#getCustomFields%28java.lang.String%29)来获取父级。

通过 REST API 的另一种解决方案：

```
Issue issue = getRestClient().getIssueClient().getIssue(task.getKey(), new NullProgressMonitor());
Field issueParent = issue.getField("parent");
if (issueParent  !=null){
    JSONObject jsonParent = (JSONObject)issueParent.getValue();
    BasicIssue partsedIssue = null;
    try {
        partsedIssue = new BasicIssueJsonParser().parse(jsonParent);
    } catch (JSONException e1) {
        e1.printStackTrace();
    }
    System.out.println("parent key: "+partsedIssue.getKey());
} 
```

# flash - 有没有像这样的 flash builder 的微调器

> ID：11868221
> 
> 赞同：0
> 
> 时间：2012-08-08T15:42:25.490
> 
> 标签：flash, apache-flex, list, spinner, builder

有没有这样的火花组件？

我尝试了一个微调器列表和一个组合框，它们在应用程序中看起来都不好看。

请发布示例代码。

                                        ![](../Images/6512ef5abc9bee7301f18c66f064f297.png)

       ![](../Images/0b154d72d487bde92c073b25be1e7219.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:23:30.540

您可以将[Flextras Mobile DropDownList](https://www.flextras.com/index.cfm?event=ProductHome&productID=21)与我们的 RadioButtonRenderer 和 PopUpSkin 2 一起使用。

[你可以在这里](https://www.flextras.com/MobileComponents/Samples/MobileDropDownList/)玩。这是一些您可以用来测试您自己的示例的代码；一旦您的库路径中有我们的移动组件 SWC：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:flextras="http://www.flextras.com/mxml" >
<mx:Script>
 <![CDATA[
  import mx.collections.ArrayCollection;
  [Bindable] public var dataProvider : ArrayCollection = new ArrayCollection([
   {label:"United States of America")},
   {label:"Alabama")},
   {label:"Alaska")},
   {label:"Arizona")},
  ]);
 ]]>
</mx:Script>

<flextras:DropDownList id="mobileComp" 
 dataProvider="{this.dataProvider}" 
 width="100%" 
 skinClass="com.flextras.mobile.dropDownList.skins.DropDownListMobileSkin_PopUp_2"
 itemRenderer="com.flextras.mobile.shared.renderers.RadioButtonRenderer"
>
</flextras:DropDownList>
</s:Application> 
```

它将为您提供屏幕截图中的近似值。

# jquery - 使用 jQuery .load 向 html 表添加行

> ID：11868223
> 
> 赞同：1
> 
> 时间：2012-08-08T15:42:27.560
> 
> 标签：jquery, html, ajax, html-table

下面的代码将服务器中的函数`html`返回的添加`returndatafromdb2()`到具有 id 的表中`resultstable2`。函数返回的 html`returndatafromdb2()`格式如下：

```
"<tr><td>some text</td><td>more text</td></tr><tr><td>some text</td><td>more text</td></tr><tr><td>some text</td><td>more text</td></tr>" 
```

正如您在我`.load()`从 jquery使用的代码中看到的那样，`html`从服务器获取并将其添加到表中。但是，我使用的代码替换了表中的现有行，而不是添加到表中。如何使用 jQuery`.load()`函数将行添加到现有行而不替换它们？

如果我能以某种方式将从函数接收到的 html 分配`.load()`给一个变量，比如说`newhtml`，我可以做类似的事情`$(newhtmltext).appendTo('#resultstable2')`。但我不知道如何将获得的html分配给`.load()`变量，或者将其用作字符串。

**编码：**

# 使用 jquery 创建表

```
<p>Method 2</p>

    <table id="resultstable2">
        <tr>
            <th>Grade</th>
            <th>Price</th>
        </tr>
    </table>

<button id="b2">Execute returndatafromdb2()</button>

<script type="text/javascript">

    $.ajaxSetup({
        cache: false
    });

    var getdata2 = function(){
        var loadurl2 = "{{=URL('default', 'returndatafromdb2')}}";
        $('#resultstable2').load(loadurl2));
    };

    $('#b2').click(getdata2);

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:46:17.477

没有办法使用该`load()`功能来做到这一点。您将需要使用普通的 ajax 调用并编写自己的回调函数。像这样的东西：

```
var getdata2 = function() {

    var loadurl2 = "{{=URL('default', 'returndatafromdb2')}}";
    $.get(loadurl2,function(data){
        $('#resultstable2').append(data);   
    },'html');

};

$('#b2').click(getdata2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:49:10.737

只需使用`append`而不是`load()`

```
var getdata2 = function() { 
    var loadurl2 = "{{=URL('default', 'returndatafromdb2')}}";
    $.get(loadurl2,function(data){
        //Here goes the append :-)
        $('#resultstable2').append(data);   
    },'html');
};

$('#b2').click(getdata2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:46:09.650

```
jQuery.get( loadurl2 ,'', function(d){

$('#resultstable2').append(d);

} ) 
```

# facebook - 多个 fb:admins 上的 Facebook Open Graph 警告

> ID：11868232
> 
> 赞同：18
> 
> 时间：2012-08-08T15:42:54.373
> 
> 标签：facebook, facebook-opengraph

当我将两个管理员放入`fb:admins`元值时，我收到了 Facebook Open Graph 调试器警告。使用一个管理员，它可以通过，但是有两个我会收到警告。一切正常，但我的强迫症想把它做好。有什么帮助吗？

这是我的代码：

```
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">

    <meta property="fb:app_id" content="122146944552301"/>
    <meta property="fb:admins" content="15901643,15932442"/>
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://uamedia.missouri.edu/mizmag/facebook-test.html" />
    <meta property="og:site_name" content="UA Media" />
    <meta property="og:title" content="Facebook Test" />

    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Facebook Test</title>
</head> 
```

我得到这个错误：

> **Parser Mismatched Metadata**此元数据的解析器结果与输入元数据不匹配。这很可能是由于数据以一种意外的方式排序、为一个属性提供了多个值而只期望一个值、或者给定属性的属性值不匹配造成的。以下是解析结果中未显示的输入属性：'fb:admins'

有任何想法吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-17T14:33:54.557

你必须使用数组格式[[http://ogp.me/#array]](http://ogp.me/#array)

在您的示例中：

代替

```
<meta property="fb:admins" content="15901643,15932442"/> 
```

你必须使用

```
<meta property="fb:admins" content="15901643"/>
<meta property="fb:admins" content="15932442"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-31T23:00:18.160

我更新了 Facebook 的文档，为多个管理员提供了正确的指导。对困惑感到抱歉。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-05-11T10:33:44.033

在我看来，只有最后一个元标记将计入使用属性值的代码。

尽管 meta 应该放在首位，但您可以在页面上随时随地使用它们。请记住，解析器会遍历代码并按顺序编译所有行。

您甚至可以使用 [IF] 根据某些全局条件选择要解析的代码。

# java - 将不同的对象存储在从同一个抽象类扩展而来的容器中

> ID：11868234
> 
> 赞同：1
> 
> 时间：2012-08-08T15:42:55.720
> 
> 标签：java, inheritance, casting, polymorphism, abstract-class

是否可以将已从同一抽象对象扩展而来的不同对象存储在单个容器中，并能够访问这些对象的所有自定义字段。让我举个例子：假设我有两辆车：福特和本田。由于所有汽车都有重量和颜色，我可以制作以下抽象类：

```
public abstract class Car{

  private double weight; 
  private String color;

  public Car(){
    this.weight=0;
    this.color="";
  }
  ...getters and 
  ...setters
} 
```

现在假设我的 Ford 类有一个附加字段“ **radio** ”，如下所示：

```
public Ford extends Car(){
private String radio;

public Ford(){
super();
this.radio = "generic";
}
} 
```

同样，本田类有一个自定义字段“**相机**”

```
public Honda extends Car(){
  private String camera;

  public Honda(){
    super();
    this.camera= "analog";
  }
} 
```

是否可以将这些类的实例保存在单个容器中，如下所示。请注意下面的代码有效，但这不是我想要的。请参阅下面的评论：

```
Ford ford = new Ford();
Honda honda = new Honda();
ArrayList<Car> myCars = new ArrayList<Car>();
myCars.add(ford);
myCars.add(honda); 
```

**这是我的问题：** 当我这样做时，`myCars.get(0)`我得到了一个类对象`Car`（显然）并且永远无法获得自定义字段**radio**。当然，我可以做类似的事情`((Ford) myCars.get(0))`并且能够看到**无线电**场，但是是否有可能创建一个更好的容器来显示所有字段而无需向下转换等，例如： `myContainer.get(0)`- 将返回**福特**类，我会获得重量、颜色和**收音机** `myContainer.get(1)`——将返回**本田**课程，我将获得重量、颜色和**相机**。

我的直觉告诉我，解决方案就在附近，而且是可能的，但是我在 Java 方面的专业知识还没有达到。也许我必须对某种泛型或哈希图做些什么？

谢谢你们！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:54:56.747

有几种选择，没有一种完全符合您的理想。

*   您可以为`Car`类中的特定属性添加所有 getter，并在它们不适用的地方返回`Null`或抛出异常。
*   您可以应用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)。
*   您可以创建一个`CarContainer`类来包装您的列表并具有返回特定类型的所有元素的方法，例如`List<Ford> getAllTheFords()`. 通过这种方式，您可以在容器类中隐藏丑陋的演员表。

我根据个人喜好列出了替代方案:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:55:17.677

你可以做的是使用泛型。

您的存储库可以实现这些方法：

```
public static <T extends Car> T getFromRepository(Class<T> type, Object key) 
public static <T extends Car> boolean addToRepository(Class<T> type, Object key, T value) 
```

然后你可以用类似的东西来调用它（假设你已经有了福特的钥匙）：

```
Ford ford = Repository.getFromRepository(Ford.class, fordKey) 
```

当然，您可以实现方法来获取给定类型的所有对象等等......

PS：一个简单的替代方案，如果您可以在子类上使用相同的方法是模板方法模式： [http ://en.wikipedia.org/wiki/Template_method_pattern](http://en.wikipedia.org/wiki/Template_method_pattern)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T15:55:15.837

`myCars.get(0)`确实返回一个福特对象。除了这仅在运行时已知。问题是要调用`car.radio`，您需要知道它是福特汽车，如果不是，则不能调用该方法。所以无论如何你都需要检查类型和演员表。

`List<Accessory>`一种解决方案是向您的抽象类添加一个字段。

您现在可以编写如下内容：

```
Car car = cars.get(0);
if (car.hasAccessories()) {
    car.getAccessory(0).operate();
} 
```

不确定这是否是您的用例所需要的。

# javascript - javascript字符串形成错误

> ID：11868235
> 
> 赞同：0
> 
> 时间：2012-08-08T15:43:08.217
> 
> 标签：javascript, json

我正在创建一个 javascript 字符串并遇到语法错误。最好的方式是什么？

```
'statement:'+var1+'<br /><table><thead><tr><th>head1</th><th>head2</th><th>head3</th></tr></thead><tbody>'+$.each(element,function(j){+'<tr><td>'+element[j][0]+'</td><td>'+element[j][1]+'</td><td>'+element[j][2]+'</td></tr>'+});+'</tbody></table>' 
```

其中 element 是一个 json 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:46:28.250

您需要声明字符串，然后使用`each()`函数对其进行操作：

```
var string = 'statement:' + var1 + '<br /><table><thead><tr><th>head1</th><th>head2</th><th>head3</th></tr></thead><tbody>';
$.each(element,function(j){
    string += '<tr><td>'+element[j][0]+'</td><td>'+element[j][1]+'</td><td>'+element[j][2]+'</td></tr>'
});
string += '</tbody></table>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:47:33.983

你为什么要在一行代码中做太多的事情？

```
var txt = 'statement:'+var1+'<br /><table><thead><tr><th>head1</th><th>head2</th>    <th>head3</th></tr></thead><tbody>';

$.each(element,function(j){+
    txt += '<tr><td>'+element[j][0]+'</td><td>'+element[j][1]+
    '</td><td>'+element[j][2]+'</td></tr>';
});

txt +='</tbody></table>'; 
```

# facebook - 根据是否有人“喜欢”了您的 Facebook 粉丝页面来显示和隐藏内容

> ID：11868241
> 
> 赞同：0
> 
> 时间：2012-08-08T15:43:46.077
> 
> 标签：facebook, facebook-graph-api

我有一个`FAN PAGE`可以大量上传到我的`ALBUM`.
我不想`LIKED`用每个上传

问题向我页面的人发送垃圾邮件：我如何控制我的**粉丝** `WALL`查看哪些图像？
换句话说，如果 JOE 是我的粉丝，我`FAN PAGE`不希望 JOE 的墙被粉丝页面图像轰炸。
这甚至可以使用`GRAPH API`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:13:44.910

作为您页面的粉丝，Joe 的墙不会被图像轰炸。如果您的意思是他的提要会充满图像，那么 Facebook 浏览提要内容的算法可确保您的图像不会立即淹没他的墙。相反，它对来自各种来源的现有内容进行排名，并对每个来源显示的内容数量进行限制。

# asp.net-mvc-3 - 使用 AspectMap 向 ASP.NET MVC 控制器添加方面

> ID：11868242
> 
> 赞同：1
> 
> 时间：2012-08-08T15:43:46.753
> 
> 标签：asp.net-mvc-3, structuremap

我们正在研究使用 AOP 框架来处理诸如日志记录、跟踪和异常处理之类的事情。我已经使用 PostSharp 构建了一个原型，现在我正在尝试使用 AspectMap 构建相同的功能。

简而言之，我有一个 ASP.NET MVC 3 应用程序，我想要一个可以轻松附加到我的控制器方法的方面，它显示入口、出口、执行时间和参数值。我的 PoC 是基本的 MVC 3 Internet 应用程序模板（文件 > 新建 > 项目 > Web > ASP.NET MVC 3 Web 应用程序 > Internet）。到目前为止我所做的...

创建了一个 AspectsRegistry

```
public class PoCRegistry : AspectsRegistry
{
    public PoCRegistry()
    {
        ForAspect<ProfileAttribute>().HandleWith<ProfileHandler>();
    }
} 
```

创建了一个 StructureMapControllerFactory

```
public class StuctureMapControllerFactory : DefaultControllerFactory
{
    protected override IController GetControllerInstance( RequestContext requestContext, Type controllerType )
    {
        if( controllerType == null ) return null;

        try
        {
            return ObjectFactory.GetInstance( controllerType ) as Controller;
        }
        catch( StructureMapException )
        {
            Debug.WriteLine( ObjectFactory.WhatDoIHave() );
            throw;
        }
    }
} 
```

在 Application_Start 中注册所有内容

```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    RegisterGlobalFilters( GlobalFilters.Filters );
    RegisterRoutes( RouteTable.Routes );

    ObjectFactory.Initialize( ie => ie.AddRegistry( new PoCRegistry() ) );
    ControllerBuilder.Current.SetControllerFactory( new StuctureMapControllerFactory() );
} 
```

此时应用程序工作正常，我可以看到它正在使用我的 StructureMapControllerFactory 来构建控制器（调试器进入该代码）。问题是我无法弄清楚在哪里或如何“丰富”生成的控制器。在[教程](http://www.chrissurfleet.co.uk/post/2012/05/29/AspectMap-%E2%80%93-Aspect-Oriented-Programming-for-Complete-Beginners.aspx)中它说我需要使用类似以下的东西：

```
For<ICaseController>()
    .Use<CaseController>()
    .EnrichWith( AddAspectsTo<CaseController> ); 
```

但是在 AspectRegistry 中的教程中，在这种情况下这似乎不是正确的位置，因为注册表不负责解析控制器请求，控制器工厂负责。不幸的是，控制器工厂中的 GetInstance() 方法返回一个`object`，而 EnrichWith() 方法需要一个`SmartInstance`.

在这一点上，我被困住了。任何提示、指示或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T08:03:09.817

老实说，这是一个我没想到的用例。我今天将设置一个测试项目，看看我能想出什么。忍受我！

**更新**

我一直在玩后端代码（您可以从[http://aspectmap.codeplex.com](http://aspectmap.codeplex.com)获得完整的代码副本），相关部分如下：

```
public T AddAspectsTo<T>(T concreteObject)
    {
        ProxyGenerator dynamicProxy = new ProxyGenerator();

        return (T)dynamicProxy.CreateInterfaceProxyWithTargetInterface(typeof(T), concreteObject,
            new[] { (IInterceptor)new AspectInterceptor(attributeMap) });
    } 
```

这是使用城堡动态代理的东西。不幸的是 CreateInterfaceProxy... 方法需要传入一个接口（而不是像我希望的那样的基类）。现在我发现了这个问题： [C# Dynamic Proxy 2 generate proxy from class with code in constructor ? 如何？](https://stackoverflow.com/questions/3729166/c-sharp-dynamic-proxy-2-generate-proxy-from-class-with-code-in-constructor-how)

这似乎表明可以使用 CreateClassProxy。我还没有机会尝试这个，我要离开电脑一周。如果您想尝试将其连接起来，尽管欢迎您从 codeplex 获取源代码并尝试一下。如果没有，我会在我回来的时候把一些东西放在一起。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-08T20:28:37.900

动作过滤器可用于提供此类 AOP 功能。

[http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs)

[http://msdn.microsoft.com/en-us/library/dd410056%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/dd410056%28v=vs.90%29.aspx)

# php - 插入语句在 PHP 中不起作用

> ID：11868243
> 
> 赞同：0
> 
> 时间：2012-08-08T15:43:48.137
> 
> 标签：php, sql, oracle, codeigniter, pdo

好吧抱歉，如果有任何术语被关闭......所以我试图在我的 PHP 代码中使用这个插入语句。当我使用 isql 或 sqlplus 将其放入时，该语句工作正常。但是当我在 PHP 中运行查询时，它不会向表中插入任何内容。不返回任何错误。我正在使用 PHP 的 PDO 扩展。[http://us2.php.net/manual/en/pdo.prepare.php](http://us2.php.net/manual/en/pdo.prepare.php)

> INSERT INTO USER_KEY (CREATED_DATE, COMMENT, EXPIRATION_DATE, USER_KEY_ID)
> VALUES (SYSTIMESTAMP, NULL,
> TO_TIMESTAMP('2012-02-02', 'YYYY-MM-DD'), key_sequence.NEXTVAL);

我的 php 代码看起来像这样，我正在使用 CodeIgniter

> $dbh = self::$CI->db->conn_id;
> 
> $sql = "INSERT INTO USER_KEY (CREATED_DATE, COMMENT, EXPIRATION_DATE, USER_KEY_ID) VALUES (SYSTIMESTAMP, ?, TO_TIMESTAMP(?, 'YYYY-MM-DD'), key_sequence.NEXTVAL)";
> 
> $stmt = $dbh->prepare($sql);
> 
> $stmt->execute(array(NULL,'2012-02-02'));

对于数据库中的不同表，我的代码中有类似的 PHP 插入语句，并且这些语句有效。但是，这些表不使用任何时间戳，所以我想知道我对时间戳的使用是否会弄乱我在 PHP 中使用的插入语句？还有关于为什么在我的语句没有执行时我没有看到任何错误的任何解释？

***更新/解决方案***

所以我改变了我做绑定的方式

```
 $sql = INSERT INTO USER_KEY <br>
                    (CREATED_DATE, <br>
                     COMMENT, <br>
                     EXPIRATION_DATE, <br>
                     USER_KEY_ID)  <br>
         VALUES      (SYSTIMESTAMP, <br>
                     :comment,  <br>
                     TO_TIMESTAMP(:date, 'YYYY-MM-DD'), <br>
                     key_sequence.NEXTVAL); <br>

 $stmt = $dbh->prepare($sql); <br>
 $stmt->bindValue(':comment', $this->comment); <br>
 $stmt->bindValue(':date', $this->creation_date); <br>
 $execute(); <br>

 $var_dump($stmt->errorInfo()); 
```

以这种方式进行绑定会返回错误

```
ORA-01830: date format picture ends before converting entire input string 
```

`TO_TIMESTAMP`从这个错误中，我收集到我输入的日期与我在 SQL 语句中的函数中的格式不匹配。
[http://www.techonthenet.com/oracle/errors/ora01830.php](http://www.techonthenet.com/oracle/errors/ora01830.php)

我不知道这一点，但在 oracle 中，DD 代表 [1-31] 而不是 [01-31]。*Oracle 文档中的信息*

因此，我将尝试将我用于绑定到 SQL 语句的日期的格式从`Y-m-d`to 更改为`Y-m-j`. 因为 j 代表 PHP DateTime 对象中的 [1-31] 天。

如果我对此有任何错误，请纠正我。我很想知道为什么改变我为 SQL 语句进行绑定的方式会引发错误？因为我不太明白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:57:56.040

您需要在 PHP 中使用某种错误报告。您的错误在第一行：

```
$dbh = $self::$CI->db->conn_id; 
```

那应该是

```
$dbh = self::$CI->db->conn_id; 
```

# php - 如何在php中操作数组

> ID：11868245
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:43:59.717
> 
> 标签：php, arrays, string

我陷入了数组操作任务。

**场景：**
我有一个对象数组。样本：

```
Array(
    [0] => stdClass Object(
        ['foo'] => 'foo1',
        ['bar'] => 'bar1',
        ['baz'] => 'baz1'
        ),
    [1] => stdClass Object(
        ['foo'] => 'foo2',
        ['bar'] => 'bar2',
        ['baz'] => 'baz2'
        ),
    [2] => stdClass Object(
        ['foo'] => 'foo3',
        ['bar'] => 'bar3',
        ['baz'] => 'baz3'
        )
) 
```

我必须将其转换为这种形式：

```
Array(
    ['foo1'] => Array('bar1', 'baz1'),
    ['foo2'] => Array('bar2', 'baz2'),
    ['foo3'] => Array('bar3', 'baz3'),
) 
```

这是我为实现此目的而创建的功能：

```
function createAttributeString($attributes)
{
    $finalString = '';
    $string = array();
    $column = array();

    foreach( $attributes as $attrib )
    {
        if( $attrib->primary_key == '1' )
            $column[$attrib->name] = array("'$attrib->type'", "'$attrib->max_length'", '\'pk\'');
        else
            $column[$attrib->name] = array("'$attrib->type'", "'$attrib->max_length'");

        $string[$attrib->name] = 'array('.implode(',', $column[$attrib->name]).')';
    }

    $finalString = 'array('.implode(',', $string).')';
    return $finalString;
} 
```

但是这个函数的输出是：

```
Array(
    [0] => Array('bar1', 'baz1'),
    [1] => Array('bar2', 'baz2')
    [2] => Array('bar3', 'baz3')
) 
```

我知道这是因为我在 $finalString 中使用的最后一个内爆函数，但我不明白应该使用什么来获得我想要的输出。

任何帮助或建议将不胜感激。

**更新：**
最终数组应以字符串格式返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:11:59.327

**更新 2**

除了我之前发布的以下代码之外，您还可以使用以下代码以所需的形式“漂亮地打印”您的数组：

```
$s = "Array(" . "<br />";
foreach ($output as $key => $array) {
    $s .= "['" . $key . "'] => Array('";
    $s .= implode("', '", $array);
    $s .= "')," . "<br />";
}
$s .= ")";
print $s; 
```

将输出：

```
Array(
['foo1'] => Array('bar1', 'baz1'),
['foo2'] => Array('bar2', 'baz2'),
['foo3'] => Array('bar3', 'baz3'),
) 
```

希望能帮助到你！

* * *

**更新**

在您更新问题并提到该数组由 stdClass 对象组成后，我更新了与 stdClass 一起使用的代码，然后将输出存储在一个字符串变量中，稍后可以打印：

```
<?php

// Basic setup of test variables
$arr = array(
    array("foo" => "foo1", "bar" => "bar1", "baz" => "baz1", "car" => "car1"), 
    array("foo" => "foo2", "bar" => "bar2", "baz" => "baz2", "car" => "car2"), 
    array("foo" => "foo3", "bar" => "bar3", "baz" => "baz3", "car" => "car3")
       );

// array of objects
$arrObject = array();

// convert above array to an array of stdClass objects
foreach ($arr as $array) {
    $object = new stdClass();
    foreach ($array as $key => $value) {
        $object->$key = $value;
    }
    $arrObject[] = $object;
}   

// print to see if the array structure is the right one
print "<pre>";
print_r($arrObject);
print "</pre>";

// now the real code starts, assuming $arrObject is the input array you specified in your question
$output = array();
foreach ($arrObject as $a) {
  $a = (array) $a;
  $key = key($a);
  next($a);
  $output[$a[$key]] = array();
  while (($key2 = key($a)) !== null) {
    next($a);
    $output[$a[$key]][] = $a[$key2];
  }
}

$str = print_r($output, true);
print "<pre>";
print $str;
print "</pre>"; 
```

上面的代码将在屏幕上打印以下输出：

```
[input]
Array
(
    [0] => stdClass Object
        (
            [foo] => foo1
            [bar] => bar1
            [baz] => baz1
            [car] => car1
        )

    [1] => stdClass Object
        (
            [foo] => foo2
            [bar] => bar2
            [baz] => baz2
            [car] => car2
        )

    [2] => stdClass Object
        (
            [foo] => foo3
            [bar] => bar3
            [baz] => baz3
            [car] => car3
        )

)

[output]
Array
(
    [foo1] => Array
        (
            [0] => bar1
            [1] => baz1
            [2] => car1
        )

    [foo2] => Array
        (
            [0] => bar2
            [1] => baz2
            [2] => car2
        )

    [foo3] => Array
        (
            [0] => bar3
            [1] => baz3
            [2] => car3
        )

) 
```

# css - CSS 粘滞页脚边距

> ID：11868249
> 
> 赞同：6
> 
> 时间：2012-08-08T15:44:06.280
> 
> 标签：css, footer, sticky

**我不想要 FIXED 页脚，我需要 STICKY 页脚。**

我的粘性页脚起初工作得很好，但是当内容处于一定高度时，页脚和页面底部之间有一个边距。

尝试弄乱浏览器高度和内容 div 高度，您应该会看到问题出在哪里。

它在页脚和页面底部之间留下了尴尬的边距。

先感谢您。

**CSS 代码：**

```
html, body {
    height:100%;
    margin:0;
}
body {
    color:#FFF;
    font:16px Tahoma, sans-serif;
    text-align:center;
}
a {
    text-decoration:none;
}
#wrapper {
    height:100%;
    margin:0 auto;
    min-height:100%;
    padding-bottom:-30px;
    width:985px;
}
#content {
    background:#F00;
    height:950px;
}
#footer {
    background:#000;
    border-top:1px solid #00F0FF;
    clear:both;
    height:30px;
    margin-top:-30px;
    padding:5px 0;
    width:100%;
}
#footer span {
    color:#FFF;
    font-size:16px;
    padding-right:10px;
}
#push {
    clear:both;
    height:30px;
} 
```

**HTML 代码：**

```
<!DOCTYPE HTML>
<html>
    <head>
        <title>Bad Footer</title>
        <link rel="stylesheet" href="badfooter.css" type="text/css">
</head>
<body>
    <div id="wrapper">
        <div id="content">
            <span>The footer leaves extra space at the bottom when you scroll all the way down. It starts out at the bottom for only the "Above the Fold" section (before scrolling it's at the bottom).</span>
        </div>
        <div id="push"></div>
    </div>
    <div id="footer">
        <a href=""><span>About Us</span></a>
        <span> | </span>
        <a href=""><span>Contact Us</span></a>
        <span> | </span>
        <a href=""><span>Home</span></a>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:47:46.387

只需在您的 css 中添加`position: fixed;`到您的课程：`footer`

```
#footer {
    background:#000;
    border-top:1px solid #00F0FF;
    clear:both;
    height:30px;
    margin-top:-30px;
    padding:5px 0;
    width:100%;
    position: fixed; /*add this new property*/
} 
```

-----**更新**-----

如果你需要一个留在底部的页脚，你需要两件事：

```
#wrapper {
    /*height:100%;*/   /*you need to comment this height*/
    margin:0 auto;
    min-height:100%;
    padding-bottom:-30px;
    width:985px;
    position: relative;  /*and you need to add this */
}

#footer {
    background:#000;
    border-top:1px solid #00F0FF;
    height:30px;
    margin-top:-30px;
    padding:5px 0;
    width:100%;
    position: relative;  /*use relative position*/
} 
```

```
#wrapper {
  /*height:100%;*/   /*you need to comment this height*/
  margin: 0 auto;
  min-height: 100%;
  min-height: 700px;  /* only for Demo purposes */
  padding-bottom: -30px;
  width: 985px;
  position: relative;  /*and you need to add this */
}
#footer {
  background: #000;
  border-top: 1px solid #00F0FF;
  height: 30px;
  margin-top: -30px;
  padding: 5px 0;
  width: 100%;
  position: relative;  /*use relative position*/
}
```

```
<div id="wrapper">
  <div id="content">
    <span>The footer leaves extra space at the bottom when you scroll all the way down. It starts out at the bottom for only the "Above the Fold" section (before scrolling it's at the bottom).</span>
  </div>
  <div id="push"></div>
</div>
<div id="footer">
  <a href=""><span>About Us</span></a>
  <span> | </span>
  <a href=""><span>Contact Us</span></a>
  <span> | </span>
  <a href=""><span>Home</span></a>
</div>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:48:32.610

添加`position: fixed`到页脚类。请注意，它在某些旧版本的 Internet Explorer 中不起作用。[http://jsfiddle.net/kAQyK/](http://jsfiddle.net/kAQyK/)

```
#footer {
    background:#000;
    border-top:1px solid #00F0FF;
    clear:both;
    height:30px;
    margin-top:-30px;
    padding:5px 0;
    width:100%;
    position: fixed;
    bottom: 0px;
    left: 0px;
} 
```

请参阅[http://tagsoup.com/cookbook/css/fixed/](http://tagsoup.com/cookbook/css/fixed/)了解如何使其在 IE 中也能工作的示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-07T01:34:19.237

我多年来一直遇到同样的问题，但似乎没有任何效果，然后我意识到我在页脚下看到的空白实际上根本不是空白，而是从我的页脚溢出，带有白色背景上的白色文本。我所要做的就是添加：

```
overflow:hidden 
```

到我的 CSS 中的页脚。

如果有人想要对我有用的解决方案，那么它与[http://getbootstrap.com/2.3.2/examples/sticky-footer.html](http://getbootstrap.com/2.3.2/examples/sticky-footer.html)相同，但添加了溢出：隐藏

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-08T16:55:38.660

**显示表 = 没有 JS 和没有固定高度！**

适用于现代浏览器（IE 8 +） - 我在几个浏览器中对其进行了测试，一切似乎都运行良好。

我发现了这个解决方案，因为我需要一个没有固定高度且没有 JS 的粘性页脚。代码如下。

**说明：**基本上你有一个包含 2 个子元素的容器 div：一个包装器和一个页脚。将页面上所需的所有内容（除了页脚）放在包装器中。容器设置为`display: table;`包装器设置为`display: table-row;`如果将 html、正文和包装器设置为`height: 100%`，则页脚将粘在底部。

页脚也设置`display: table;`为。这是必要的，以获得子元素的边距。您也可以将页脚设置为`display: table-row;`这将不允许您设置`margin-top`页脚。在这种情况下，您需要使用更多嵌套元素来发挥创意。

**解决方案：** [https ://jsfiddle.net/0pzy0Ld1/15/](https://jsfiddle.net/0pzy0Ld1/15/)

**还有更多内容：http:** [//jantimon.nl/playground/footer_table.html](http://jantimon.nl/playground/footer_table.html)

```
/* THIS IS THE MAGIC */

html {
  box-sizing: border-box;
}
*,
*:before,
*:after {
  box-sizing: inherit;
}
html,
body {
  margin: 0;
  padding: 0;
}
html,
body,
#container,
#wrapper {
  height: 100%;
}
#container,
#wrapper,
#footer {
  width: 100%;
}
#container,
#footer {
  display: table;
}
#wrapper {
  display: table-row;
}
/* THIS IS JUST DECORATIVE STYLING */

html {
  font-family: sans-serif;
}
#header,
#footer {
  text-align: center;
  background: black;
  color: white;
}
#header {
  padding: 1em;
}
#content {
  background: orange;
  padding: 1em;
}
#footer {
  margin-top: 1em; /* only possible if footer has display: table !*/
}
```

```
<div id="container">
  <div id="wrapper">
    <div id="header">
      HEADER
    </div>
    <div id="content">
      CONTENT
      <br>
      <br>some more content
      <br>
      <br>even more content
    </div>
  </div>
  <div id="footer">
    <p>
      FOOTER
    </p>
    <br>
    <br>
    <p>
      MORE FOOTER
    </p>
  </div>
</div>
```

# javascript - 如何在 jQuery 的 ajax 函数中从一个类访问元素 ID？

> ID：11868253
> 
> 赞同：2
> 
> 时间：2012-08-08T15:44:13.770
> 
> 标签：javascript, jquery, ajax, autocomplete, twitter-bootstrap

我正在尝试将 typeahead 脚本用于 Bootstrap。它工作得很好，但我希望它更有活力。我想在同一页面上运行多个自动完成输入而不重复代码。

HTML：

```
<input type="text" class="typeahead" name="person_name" id="person-search">
<input type="text" class="typeahead" name="city_name" id="city-search"> 
```

基本的 jQuery：

```
$('.typeahead').typeahead({
    source: function(typeahead, query) {
        return $.ajax({
            url: '/ajax_lookup_script.php'
                + '?source=' + ###[HOW CAN I PUT ELEMENT ID HERE?]###
                + '&q=' + query,
            success: function(data) {
                return typeahead.process(data);
            }
        });
    },
    property: 'name'
}); 
```

以上不起作用（显然）。但是，如果我将类名设置为`.typeahead-person-search`，然后创建一个新的 typeahead 函数来手动添加 source `person-search`，以及另一个完全 for 的函数`.typeahead-city-search`，那么一切正常。当它实际上只是一个将两者分开的变量时，我想避免使用两个函数。

如何将活动`.typeahead`类的元素 ID 放入`$.ajax`函数中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T17:15:45.553

好的，我已经做了其他事情，我无法直接使用 .typeahead 库对其进行测试，但我对另一个有趣的库做了同样的事情。

怎么办

```
$('.typeahead').each(function(){
    var self = $(this);

    self.typeahead({
        source: function(typeahead, query) {
            return $.ajax({
                url: '/ajax_lookup_script.php'
                    + '?source=' + self.attr('id')
                    + '&q=' + query,
                 success: function(data) {
                    return typeahead.process(data);
                }
            });
        },
        property: 'name'
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:48:57.607

编辑 :: 尝试我的第二个答案它应该可以工作，我一直在使用另一个有同样问题的图书馆

尝试类似的东西

```
var id = $(this).attr('id'); 
```

然后

```
var url = 'blahblah' + id + 'blablahblah); 
```

并将var url放在你的ajax查询中的url：spot

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:49:34.893

您可以为每个包含 URL 的动态部分的输入添加一个数据属性。

```
<input type="text" class="typeahead" name="person_name" id="person-search" data-source="person-search">
<input type="text" class="typeahead" name="city_name" id="city-search" data-source="city-search"> 
```

然后，您可以使用 jQuery 抓取它并将其传递到 URL。

```
$('.typeahead').typeahead({
    source: function(typeahead, query) {
        var source = $(this).data('source');
        return $.ajax({
            url: '/ajax_lookup_directory/'+source+'.php?q=' + query,
            success: function(data) {
                return typeahead.process(data);
            }
        });
    },
    property: 'name'
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:49:56.927

您可以尝试以下方法

```
$('.typeahead').typeahead({
    source: function(typeahead, query) {
        return $.ajax({
            url: '/ajax_lookup_directory/' + $(this).attr('id') + '.php?q=' + query,
            success: function(data) {
                return typeahead.process(data);
            }
        });
    },
    property: 'name'
}); 
```

# google-drive-api - 搜索特定文件夹不限于该文件夹

> ID：11868258
> 
> 赞同：2
> 
> 时间：2012-08-08T15:44:50.353
> 
> 标签：google-drive-api

我正在尝试将 children->listChildren 与文件夹 id 和搜索参数一起使用，代码如下所示

```
$parameters['q'] = "title = 'Folder Title'";
$children = $dlist->children->listChildren($export_dir, $parameters); 
```

其中 $export_dir 是文件夹的 ID。在这种情况下，如果我删除了名为“文件夹标题”的文件夹，我的搜索将在垃圾文件夹中找到它，而不是在指定的文件夹 ID 中。我原以为已删除的文件夹不会出现在搜索结果中，因为我指定了要搜索的不同文件夹。我是在假设错误还是应该提交错误报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:57:46.513

When listing files, folder and/or parents, trashed files/folders will be part of the returned collection by default.

To prevent this behavior, use the `q="trashed = false"` query parameter to let the API knows that you are requesting untrashed files/folders. From your code snippet:

```
$parameters['q'] = "title = 'Folder Title' AND trashed = false";
$children = $dlist->children->listChildren($export_dir, $parameters); 
```

# python - 在 python 中使用 SMTPServer 接收电子邮件：

> ID：11868262
> 
> 赞同：3
> 
> 时间：2012-08-08T15:45:06.883
> 
> 标签：python, smtp

我在 Linux 下有一个使用 smtpd.SMTPServer 接收电子邮件的小应用程序。这是小测试代码：

```
class CustomSMTPServer(smtpd.SMTPServer):

    def process_message(self, peer, mailfrom, rcpttos, data):
        print 'Receiving message from:', peer
        print 'Message addressed from:', mailfrom
        print 'Message addressed to  :', rcpttos
        print 'Message length        :', len(data)
        return

server = CustomSMTPServer(('0.0.0.0', 25), None)
asyncore.loop() 
```

我有以下问题：（1）使用这段代码时，发送电子邮件的计算机收到以下消息：502错误：命令“EHLO”未实现，因此服务器无法正确回复以接收更多数据/与电子邮件通信- 发送计算机（我假设是客户端）。

不应该首先在 Ubuntu 安装中实现像 EHLO 这样的基本功能吗？为什么没有实施？

(2) 我认为可以通过在 Ubuntu 中安装 postfix 来安装 EHLO。我这样做了，然后进行了相同的测试调用，但后来因出现不同的错误而停止：

```
Client: RCPT TO: XXX@YYY.com
Server: 554 5.7.1 <XXX@YYY>: Relay access denied 
```

（3）后来，在做了一些其他测试之后，我从测试代码本身得到了错误：

```
error: [Errno 98] Address already in use 
```

事实证明，使用的 IP 地址已经在使用中，可以看到

```
netstat -lnpt 
```

其中的情况是正在运行的后缀。停止 postfix 服务后，地址不再使用，但当然又回到问题 #1：

```
502 Error: command "EHLO" not implemented 
```

我希望能够使用 SMTPServer 接收电子邮件 1\. 无需安装 postfix 2\. 使用 asyncore

如果有任何想法如何使用 python 库以简单的方式实现这一点，那就太好了！

干杯亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T18:29:53.813

1) Postfix is an SMTP server, it has nothing to do with python's `smtpd` EHLO implementation. If you want your custom SMTP server, you don't need postfix, so feel free to remove it.

2) `EHLO` is a `ESMTP` command, not `SMTP`, standard `smtpd` python module implements `SMTP`, therefore it doesn't have an `EHLO` implementation.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-06T10:02:52.780

尝试这个。当然，它并没有实现 EHLO 命令，而是让它和 HELO 命令一样对待。当然，它可能只会让您越过第一个绊脚石，但是如果其余的 smtp 命令兼容，它可能会帮助您：

您可能会在 /usr/lib/python2.7 中找到 smtpd.py 文件

```
def smtp_HELO(self, arg):
    if not arg:
        self.push('501 Syntax: HELO hostname')
        return
    if self.__greeting:
        self.push('503 Duplicate HELO/EHLO')
    else:
        self.__greeting = arg
        self.push('250 %s' % self.__fqdn)

#copy the above function and rename it smtp_EHLO

def smtp_EHLO(self, arg):
    if not arg:
        self.push('501 Syntax: HELO hostname')
        return
    if self.__greeting:
        self.push('503 Duplicate HELO/EHLO')
    else:
        self.__greeting = arg
        self.push('250 %s' % self.__fqdn) 
```

另外，我注意到同一个库的 python3.5 版本看起来支持 EHLO，所以也许你可以尝试使用 python3。但显然 python3 似乎并不向后兼容 - 祝你好运。

# ios - Cocos2D 2.0 提高调度精度

> ID：11868265
> 
> 赞同：1
> 
> 时间：2012-08-08T15:45:16.670
> 
> 标签：ios, timer, cocos2d-iphone

我的一个场景中有这句话：

```
[self schedule:@selector(storeValue:) interval:1.0/30.0]; 
```

storeValue 非常基本且快速。它只是将层的位置存储在 NSMutableArray 上。我需要尽可能精确地调用这个 storeValue，但是在进行一些测量之后，这些是每个 storeValue 调用之间测量的间隔：

```
interval 0 = 0
interval 1 = 0.049962
interval 2 = 0.033345
interval 3 = 0.033332
interval 4 = 0.049994
interval 5 = 0.050050
interval 6 = 0.049968
interval 7 = 0.033998
interval 8 = 0.049331
interval 9 = 0.050015
interval 10 = 0.049979
interval 11 = 0.049999
interval 12 = 0.033357
interval 13 = 0.033307
interval 14 = 0.049997
interval 15 = 0.033322
interval 16 = 0.050317
interval 17 = 0.049743
interval 18 = 0.049973
interval 19 = 0.033322
interval 20 = 0.050024
interval 21 = 0.049975
interval 22 = 0.049987
interval 23 = 0.033316
interval 24 = 0.050038
interval 25 = 0.050149
interval 26 = 0.049852
interval 27 = 0.049989
interval 28 = 0.050011 
```

因此，如您所见，该方法以各种间隔调用，而不是始终为 0.03333 (1 / 30)。

我试图从 storeValue 中删除所有代码，以查看 storeValue 被调用的频率并获得相同的不规则时间。

最大的问题是：我应该怎么做才能提高进度精度？我应该使用 NSTimer 吗？GCD 还有其他执行计划任务的方法吗？有什么建议么？

谢谢。

注意：我现在发现如果我设置间隔 = 0，storeValue 将在每一帧被调用，这意味着 1/60 秒并且精度非常好。好的，我可以制定一个逻辑来调用 storeValue 一半的时间，但很高兴知道为什么调度如此不精确以及是否有办法改进它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:33:08.080

当您安排某些事情时，选择器和计时器频率将传递给 Cocos2d `sharedScheduler`。然后`sharedDirector`调用`[[Scheduler sharedScheduler] tick: dt];`每一帧。如果您的计时器超过其阈值，调度程序将调用您的选择器。

所以频率不能比主循环频率更精确（最大 1/60，最小 - 取决于实际场景复杂度）。可能 1/30 不完全在每个第二帧上通过阈值，这就是为什么您在日志中没有精确值的原因。

我可以建议通过`NSTimer`不使用 Cocos2d 调度程序在其他线程上调用您的选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T05:03:21.370

iOS 不是[实时操作系统](http://en.wikipedia.org/wiki/Real-time_operating_system)，因此您永远无法保证您的预定回调/NSTimer/等。将永远发生在精确的 1/30 秒内。此精度将始终根据操作系统正在处理的其他内容而有所不同。

但是，您可以做的是使用每个回调之间传递的实际时间来解决这种缺乏一致性的问题。

# php - 自定义 PDO 类错误

> ID：11868268
> 
> 赞同：3
> 
> 时间：2012-08-08T15:45:38.713
> 
> 标签：php, pdo

> **编辑**：事实证明我一直在吠叫错误的树可以这么说。我已经编辑了这个问题，使其至少对其他收到错误的人有用。

对于所有在尝试执行准备好的 PDO 查询时遇到以下错误的人：

> 警告：PDOStatement::execute() [pdostatement.execute]: SQLSTATE[HY093]: Invalid parameter number: parameter was not defined on line 26

请看下面我的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T13:10:52.667

这意味着您传递的数组值`$query->execture($array)`比`:values`查询中的多。如果您遇到类似但措辞不同的错误，则表示`:values`查询中的内容多于数组中的内容。例如：

```
$array = array(
  'username' => 'Bob',
  'id' => 42,
);

//...

$query = "SELECT * FROM `users` WHERE `id`=:id";

//...

$data->execute($array); 
```

这会产生错误，因为尽管您传递的是“用户名”，但它从未在查询中使用。希望这对某人有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:48:30.853

如果我错了，请纠正我，但您不应该对参数数组使用以下语法：

```
array(':id' => 1) 
```

请注意原始帖子中省略的冒号。

有关示例，请参阅[PDO 文档](http://php.net/manual/en/pdostatement.execute.php#example-998)。

# flash - Adobe Air 是否允许我“包装”现有的 HTML 页面以允许拖放文件上传？

> ID：11868273
> 
> 赞同：0
> 
> 时间：2012-08-08T15:46:05.507
> 
> 标签：flash, air

我有一个 HTML 页面（用 .NET MVC 编写），允许用户上传文件并使用 JQuery AJAX 从我们的应用程序加载数据，用户可以从中选择如何对文件进行分类。这一切都很好，但我想找到一种方法让用户将文件拖放到上面，但由于大多数用户只有 Internet Explorer，我不能像 IE 那样做严格基于浏览器的解决方案不允许拖放。

因此，经过一些研究，我认为 Adob​​e 的 Air 产品可能是一个不错的选择，它可以让他们在桌面上有一个“小部件”，他们可以将文件拖到那里。但是在对 Adob​​e Air 进行了大量研究之后，我变得更加困惑。如果有人可以帮助我回答这些问题，它将帮助我确保我走在正确的道路上。

1) Adob​​e Air 可以“包装”现有网页并与该页面上的元素交互吗？我希望使用我现有的经过测试和工作的 MVC 代码，并且只需拥有一个桌面容器，该容器允许拖放并填充`<input type="file">`元素，而无需转换为（和学习）ActionScript。

2) Adob​​e Air 是我提出的最佳解决方案吗？

3) 我刚刚安装了 Flash CS6，但我完全是新手。这是我想做的最好的开发平台吗？

4) Adob​​e 提供了一个名为**[Snappy](http://www.adobe.com/devnet/air/flash/quickstart/articles/scrappy_copy_paste.edu.html)**的示例应用程序，这似乎是我想要的，但是当我下载它并尝试打开“Scrappy.fla”文件时，它会抛出一个警告，指出“AIR SDK “AdobeAIR1_0”的目标版本是不可用。目标将设置为最接近的可用版本”，当我尝试运行它时，它会抛出一个硬错误，指出“测试电影已终止。无效的应用程序描述符：versionNumber 必须具有非空值。”。有没有其他人遇到过这个错误，如果是这样，我该如何让它运行？

任何输入表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T17:43:51.587

我遇到了同样的问题，我通过复制所有项目图层及其所有帧来解决这个问题，并使用 Adob​​e Air 设置创建新的 Flash 项目。然后我将所有框架粘贴到新项目中。

这工作了一段时间，但问题再次发生，所以我尝试了另一种解决方案：

`publish settings`我从-> `air settings`->创建了新证书`signature`，现在它似乎对我有用。

# python - 用于 python 或其他编程语言的 Mac 字典到文档工具提示

> ID：11868274
> 
> 赞同：4
> 
> 时间：2012-08-08T15:46:07.870
> 
> 标签：python, macos

我想知道python帮助文件是否存在Mac词典（我不确定格式）？我的想法是，只需在我的文本编辑器中使用触控板上的三指轻按，就会弹出字典弹出窗口并向我显示 python 函数的帮助。那岂不是很棒！知道是否存在类似的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:03:20.617

如果您正在寻找 Python 的上下文相关帮助，当您将鼠标悬停时，Eclipse 的[PyDev](http://pydev.org/)插件会执行此操作：

![在此处输入图像描述](../Images/d8630fb17fc114282a702abed1c37374.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-29T18:23:28.770

（这个答案是一个存根，主要是为了强迫自己创造一个更好的答案。）

Ruby 社区同时提供 macOS 字典的[ruby​​ 文档](https://www.zenspider.com/ruby/2010/01/rdoc-via-osx-s-dictionary-app.html)和[rails 文档](https://github.com/priithaamer/railsdictionary)，所以这种事情绝对是可能的。（**注意**：这些都是 2010 年的，它们可能已经过时了。）

“这有多难，”他想，“为 Python 做同样的事情有多难？” 待续……</p>

# java - 使用 indexOf 搜索包含某些字母的字符串

> ID：11868278
> 
> 赞同：0
> 
> 时间：2012-08-08T15:46:19.553
> 
> 标签：java, indexof

我编写了以下代码，我的目标是在提示符处输入一个字符串并返回列表中包含该字符串的任何单词。我想我只是缺少一些小东西，因为当我运行程序时它会打印整个单词列表。任何帮助，将不胜感激。

```
package assignment1;

import java.net.*;
import java.util.ArrayList;
import java.util.List;
import java.io.*;

public class URLReader {
static List<String> words = new ArrayList<String>();

public static void main(String[] args) throws Exception {
    System.out.println("Please Input A String");
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    String letters = br.readLine();
    URL oracle = new URL("http://dl.dropbox.com/u/18678304/2011/BSc2/words.txt");
    BufferedReader in = new BufferedReader(new InputStreamReader(oracle.openStream()));
    String inputLine;

    while ((inputLine = in.readLine()) != null)
        words.add(inputLine);
        in.close();

for(int i = 0; i<words.size(); i++)
{
    if(words.get(i).indexOf(letters) >= 0);
        System.out.println(words.get(i));
}

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:48:14.763

你`;`在 if 语句的末尾有一个：

```
if(words.get(i).indexOf(letters) >= 0);
    System.out.println(words.get(i)); 
```

它应该是：

```
if(words.get(i).indexOf(letters) >= 0)
    System.out.println(words.get(i)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:56:46.430

一个语句不需要大括号 { }，但始终使用它更安全：

```
if(words.get(i).indexOf(letters) >= 0){
System.out.println(words.get(i));
} 
```

# pthreads - 为什么子线程阻塞在我的代码中？

> ID：11868281
> 
> 赞同：1
> 
> 时间：2012-08-08T15:46:34.590
> 
> 标签：pthreads, mutex

我试图通过使用互斥锁来测试 pthread：

```
#include <stdio.h>
#include <pthread.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>

pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;
int global = 0;
void thread_set();
void thread_read();

int main(void){
  pthread_t thread1, thread2;
  int re_value1, re_value2;
  int i;
  for(i = 0; i < 5; i++){
    re_value1 = pthread_create(&thread1,NULL, (void*)&thread_set,NULL);
    re_value2 = pthread_create(&thread2,NULL,(void*)&thread_read,NULL);
  }

  pthread_join(thread1,NULL);
  pthread_join(thread2,NULL);
  /* sleep(2); */ // without it the 5 iteration couldn't finish
  printf("exsiting\n");
  exit(0);
}

void thread_set(){
  pthread_mutex_lock(&mutex1);
  printf("Setting data\t");
  global = rand();
  pthread_mutex_unlock(&mutex1);
}
void thread_read(){
  int data;
  pthread_mutex_lock(&mutex1);
  data = global;
  printf("the value is: %d\n",data);
  pthread_mutex_unlock(&mutex1);
} 
```

没有`sleep()`，代码将无法完成 5 次迭代：

设置数据值为：1804289383 值为：1804289383 设置数据值为：846930886 现有

设定数据值为：1804289383 设定数据值为：846930886 值为：846930886 现有

它只能将 sleep() 添加到主线程，我认为它应该在没有 的情况下工作`sleep()`，因为 join() 函数等待每个子线程终止

任何人都可以告诉我为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:06:49.147

您正在创建 10 个线程（每个线程的 5 次迭代），但只加入您创建的最后两个线程（如 mathematician1975 所述，您正在重新使用线程句柄变量，因此最后一次迭代的值是您唯一的值可以加入）。如果没有`sleep()`，调度程序很可能在您点击 之前还没有开始执行前 8 个线程`exit()`，这会自动终止所有线程，无论它们是否有机会运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:54:20.487

您对互斥对象的使用看起来不错，但是这个循环

```
for(i = 0; i < 5; i++) {
     re_value1 = pthread_create(&thread1,NULL, (void*)&thread_set,NULL);
     re_value2 = pthread_create(&thread2,NULL,(void*)&thread_read,NULL);
} 
```

`thread1`当您重用相同的线程实例以及`thread2`循环的每次迭代时，这是在自找麻烦。在内部，这一定会引起问题，尽管我不知道它会如何表现出来。您确实应该为每个要确保可靠运行的线程使用单独的线程对象实例。我不知道如果您`pthread_create`使用已经在运行的线程对象的实例调用会发生什么，但我怀疑这不是明智的做法。我怀疑它最多会阻塞，直到线程函数退出。

此外，您不会检查`pthread_create()`其中任何一个的返回值，这可能是一个好主意。总之，我会使用线程对象的单独实例，或者将`pthread_join`调用添加到循环内部，以便您确定线程在下一次调用`pthread_create()`.

最后，传递给函数的函数签名`pthread_create()`是类型

```
 void* thread_function(void*); 
```

并不是

```
 void thead_function() 
```

就像你在你的代码中一样。

# javascript - 如何将具有多个标签的多个 s 中的所有数据放入一个数组中？

> ID：11868283
> 
> 赞同：0
> 
> 时间：2012-08-08T15:46:44.920
> 
> 标签：javascript, arrays, json

我正在寻找从多个跨度中获取多个跨度标签并将它们粘贴到数组（或 json 对象）中以供以后使用的最佳实践。（甚至不确定是数组还是 json 是要走的路。）

html:

```
<span class="car" id=c1 data-make="volvo" data-year="2010">Car1<span>
<span class="car" id=c2 data-make="saab" data-year="1998">Car2<span> 
```

js：

```
var cars = document.getElementsByClassName('car');
for(var i=0; i<cars.length; i++) { 
  <what goes best here?>
} 
```

目前，我为每个 ID、数据和年份创建了 3 个平面数组，但这看起来很混乱。我无法弄清楚如何创建：

```
 Array(
[0] => Array(
        [id] => c1 
        [make] => volvo
        [year] => 2010
    )
[1] => Array(
        [id] => c2
        [make] => SAAB  
        [year] => 1998    
    )
); 
```

或者一个 json 对象：

```
jsonString = [
    {
        "id": "c1",
        "make": "volvo",
        "year": "2010",
    },
    {
        "id": "c2",
        "make": "saab",
        "year": "1998", 
    }
]; 
```

我对此的需求很简单。我将使用这些信息对 innerHTML 进行一些简单的替换，例如：

```
document.getElementById(car[id]).innerHTML = car[make] 
```

所以，有两个部分：1）对于这种类型的任务，多维数组或 json 对象会更好吗？2）在我的循环部分中将数据粘贴到该数组或json中的内容是什么？

谢谢 - 我还在学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:00:05.900

您可以遍历每个元素的所有属性并将每个`data-`属性添加到相应的对象：

```
var result = [],
    pattern = /^data-/;

// don't access the 'length' property of a live list in each iteration,
// cache it instead
for(var i = 0, l = cars.length; i < l; i++) { 
    var element = cars[i],
        attrs = element.attributes,
        car = {};

    // setting the ID
    car.id = element.id;

    // iterating over all attributes
    for(var j = 0, jl = attrs.length; j < jl; j++) {
        var name = attrs[j].name;
        if(pattern.test(name)) { // if the attribute name starts with 'data-'
            // remove the 'data-' part and add the value to the current object
            car[name.replace(pattern, '')] = attrs[j].value;
        }
    }

    // add the object to the final list
    result.push(car);
} 
```

[**演示**](http://jsfiddle.net/J2TK8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:54:47.637

如果你愿意使用 jQuery，你可以使用下面的。否则，请使用 Felix 的答案。

您应该使用对象数组，如下所示：

```
var arr = [];
$("span").each(function(i) {
    arr[i] = {};
    arr[i]["id"] = $(this).attr("id");
    arr[i]["make"] = $(this).data("make");
    arr[i]["year"] = $(this).data("year");
}); 
```

# c# - 在图片框中显示图像数组

> ID：11868284
> 
> 赞同：1
> 
> 时间：2012-08-08T15:46:46.603
> 
> 标签：c#, arrays, image, picturebox

我对视觉 C# 非常陌生，我想在图片框中显示一组图像

这是我的代码：

```
string[] list = Directory.GetFiles(@"C:\\pictures", "*.jpg");

Image[] images = new Image[5];

for (int index = 0; index < 5; index++)
{
    images[index] = Image.FromFile(list[index]);
} 
```

当我运行它时，图片框是空白的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:29:38.620

添加表单级变量：

```
private int selectedImageIndex = -1;   // to store the active index in the images array 
```

添加一个带有点击事件处理程序的按钮：

```
selectedImageIndex++;  // increment the active index
// if the active index is equal to the image count we've gone past the end of the array, so loop back to the beginning.
if (images.Count == selectedImageIndex) { selectedImageIndex = 0; }
pictureBox.Image = images[selectedImageIndex];  // assign the selected image to the picturebox 
```

# vb.net - MVC3 使用实体框架获取模型中的最后 3 条记录

> ID：11868286
> 
> 赞同：0
> 
> 时间：2012-08-08T15:46:58.397
> 
> 标签：vb.net, asp.net-mvc-3, razor, for-loop

我是 MVC Noob，我需要一些帮助来清理我的代码。

我有一个索引视图（Razor 和 VB.NET），它应该返回模型中的最后 3 个项目。这就是我所做的。它有效，但它看起来很难看，我相信有更好的方法来做到这一点。请帮忙。

我的观点

```
 For i As Integer = (Model.Count.ToString() - 3) To (Model.Count.ToString() - 1)
       Dim currentItem = Model(i)

        @<tr>
         <td>...do some stuff with my currentItem</td>
        </tr>
   Next 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:50:12.607

如果 Model 是 Enumerable 的东西，那么你可以使用 Linq 扩展方法来做这样的事情（在 C# 中，我不做 VB）

```
foreach(var m in Model.Reverse().Take(3))
{
    // your code
} 
```

如果您按原始顺序需要它们，您可以随时再次 Reverse() 。

虽然，如果您不打算使用其余元素，那么您实际上应该在控制器或业务层中执行此操作，并且只返回三个元素。

# .net - 将一块 WordprocessingML 添加到 word 文档

> ID：11868287
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:04.843
> 
> 标签：.net, ms-office, openxml, office-2010

是否可以将 WordprocessingML 的“块”添加到 word 文档（而不是整个文档）？我目前有一个用作模板的 docx，它包含一个 ContentControl。我想通过 AltChunk 插入 WordprocessingML 的一部分，但我插入的内容呈现为文本，而不是像我希望的那样被实现到文档中。

我目前使用的方法是：

```
var main = doc.MainDocumentPart;

// Create new AltChunk
string altChunkId = "altChunkId";
AlternativeFormatImportPart chunk = main.AddAlternativeFormatImportPart(AlternativeFormatImportPartType.WordprocessingML, altChunkId);

// Populate altChunk. stream = MemoryStream containing WordprocessingML
chunk.Feed(stream);

// Replace content control with altChunk info
AltChunk altChunk = new AltChunk();
altChunk.Id = altChunkId;

// Get SdtBlock to replace
SdtBlock block = ContentControlHelpers.GetSdtBlock(doc, "ContentControlId");
OpenXmlElement parent = block.Parent;
parent.InsertAfter(altChunk, block);
block.Remove(); 
```

我尝试插入的 WordproccessingML 示例如下（通过 XML + XSLT 生成。）：

```
<w:p>
  <w:pPr>
    <w:pStyle w:val="heading2" />
  </w:pPr>
  <w:r>
    <w:t>Product 1</w:t>
  </w:r>
</w:p>
<w:p>
  <w:pPr>
    <w:pStyle w:val="heading3" />
  </w:pPr>
  <w:r>
    <w:t>Europe</w:t>
  </w:r>
</w:p>
<w:p>
  <w:pPr>
    <w:pStyle w:val="heading4" />
  </w:pPr>
  <w:r>
    <w:t>France</w:t>
  </w:r>
</w:p> 
```

我已经尝试在它周围添加`<w:document>`and`<w:body>`元素来包装它，但无论我在尝试什么，文档都只是将 WordprocessingML 呈现为文本，如上所示，而不是将其嵌入到文档中。

关于我可能出错的地方有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T04:53:29.123

看看 DocumentBuilder - 开源示例和指南，它展示了如何做你想做的事。

[http://openxmldeveloper.org/wiki/w/wiki/documentbuilder.aspx](http://openxmldeveloper.org/wiki/w/wiki/documentbuilder.aspx)

首先观看以下视频：

[http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2011/08/17/new-screen-cast-short-and-sweet-intro-to-documentbuilder-2-0.aspx](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2011/08/17/new-screen-cast-short-and-sweet-intro-to-documentbuilder-2-0.aspx)

-埃里克

# firefox-addon - 未调用 onsyncfrompreference

> ID：11868288
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:08.383
> 
> 标签：firefox-addon, xul

我正在编写一个 Firefox 插件，对于`<scale>`XUL 元素，`onsyncfrompreference`似乎没有被调用（Firefox 14）。这是我的偏好：

```
<preferences>
      <preference id="pref-sensitivity" name="bbaddon.sensitivity" type="string"/>
      ...
</preferences> 
```

这是规模：

```
<scale min="1" max="100" increment="1" preference="pref-sensitivity"
id="bb-sensitivity"
onsynctopreference="Application.console.log('onsynctopreference called')" 
onsyncfrompreference="Application.console.log('onsyncfrompreference called')" /> 
```

日志目前仅用于调试，`onsynctopreference`称为没有问题，因为它显示在控制台上，但没有来自`onsyncfrompreference`. 我在中定义了一个默认值`defaults.js`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:30:39.307

如果您在 中查看[此功能的实现`preferences.xml`](http://hg.mozilla.org/mozilla-central/file/257777cf58fe/toolkit/content/widgets/preferences.xml#l400)，`onsyncfrompreference`只会为“可编辑”元素调用。[至于什么被认为是“可编辑的”，你可以在下面](http://hg.mozilla.org/mozilla-central/file/257777cf58fe/toolkit/content/widgets/preferences.xml#l510)看到。有些元素总是被认为是可编辑的，有些元素必须`preference-editable="true"`明确指定属性。在您的情况下，后者意味着您的修复将如下所示：

```
<scale min="1" max="100" increment="1" preference="pref-sensitivity"
  preference-editable="true" id="bb-sensitivity"
  onsynctopreference="Application.console.log('onsynctopreference called')" 
  onsyncfrompreference="Application.console.log('onsyncfrompreference called')" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:56:09.937

我已经使用 Javascript 解决了这个问题：

```
<script type="text/javascript">

var loaded = false;
//load preferences
var prefs = Components.classes["@mozilla.org/preferences-service;1"]
         .getService(Components.interfaces.nsIPrefService)
         .getBranch("extensions.bb");
prefs.QueryInterface(Components.interfaces.nsIPrefBranch2);

function loadpref() //call this in the prefwindow onload
{
    document.getElementById('bb-sensitivity').value = prefs.getCharPref('sensitivity');  
    loaded = true;
}

function setpref(sensitivity)
{
     if(loaded) //onchange for scale fires before onload for the window
     {
         prefs.setCharPref('sensitivity',sensitivity);
     }
}

</script> 
```

和比例元素：

```
<scale min="1" max="100" increment="1" 
    preference="pref-sensitivity" 
    id="bb-sensitivity" 
    onchange="setpref(this.value);"
    /> 
```

我将暂时保留这个问题，看看是否有其他人可以提供帮助。我仍然想以“正确”的方式做到这一点。

# c# - 如何获取当前活动解决方案平台名称以在 Visual Studio 加载项中使用？（C＃）

> ID：11868290
> 
> 赞同：3
> 
> 时间：2012-08-08T15:47:09.943
> 
> 标签：c#, visual-studio-2010, visual-studio, add-in

我正在创建一个用 C# 编写的 Visual Studio 插件，允许用户将他们的代码发送到远程 PC 进行解析。该过程将根据所使用的活动解决方案平台而有所不同。

我希望加载项能够获取当前的活动解决方案平台，以便正确处理用户代码。

我尝试了以下方法：

```
try    
{
SolutionBuild builder = applicationObject.Solution.SolutionBuild;
SolutionConfiguration2 config;
config = (SolutionConfiguration2)builder.SolutionConfigurations.Item(1);
MessageBox.Show("The platform name of 
the solution configuration is: " + config.PlatformName);
}
catch(SystemException ex)
{
   MessageBox.Show(ex.ToString());
} 
```

然而，这总是返回列表中的第一个平台，而不是当前平台。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T22:32:10.173

要获得活动的解决方案配置和平台，请使用此

```
string active_config = (string)addin_inst.DTE.Solution.Properties.Item("ActiveConfig").Value; 
```

这将得到一个“Debug|Win32”形式的字符串。平台将在“|”之后

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T15:27:00.523

这将获得活动项目的配置名称和平台名称。

```
object[] openProjects = (object[])applicationObject.ActiveSolutionProjects;
Project activeProject = (Project)openProjects[0];
string configurationName = activeProject.ConfigurationManager.ActiveConfiguration.ConfigurationName;
string platformName = activeProject.ConfigurationManager.ActiveConfiguration.PlatformName; 
```

# html - 谷歌加分享和网址中的参数

> ID：11868291
> 
> 赞同：10
> 
> 时间：2012-08-08T15:47:12.707
> 
> 标签：html, url, google-plus, share

我使用 Google+ 在我的页面上共享一些链接，当我尝试共享包含参数的 URL 时出现问题。例子：

```
http://google.com?n=somethink&link=p/1393007&i=images/icons/gplus-16.png 
```

当您将此 URL 放入此页面的字段时：

```
https://developers.google.com/+/plugins/share/ 
```

...然后单击`share`按钮，您将看不到有关页面的名称、图片和描述等信息。但是，当您删除“png”之前的点时，Google 会显示有关该页面的数据。

当您`'`在 URL 中的任何位置写入符号时，也会发生同样的事情。我在 Google 帮助页面中找不到有关此错误的任何信息。当我使用这样的 URL 时，它可以工作：

```
http://google.com?n='&link=p/1393007&i=images/icons/gplus-16.png 
```

...但这不是非常优雅的解决方案。

如何编写干净的 URL？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-09T13:41:46.527

目前 G+ 分享只支持两个参数：url，用于目标 url，hl，用于语言代码。

> [https://plus.google.com/share?url=http://www.stackoverflow.com](https://plus.google.com/share?url=http://www.stackoverflow.com)

或者，您可以将 OpenGraph 标记添加到页面顶部以指定相同的字段，如下所示：（尚未测试）

```
<meta property="og:title" content="..."/>
<meta property="og:image" content="..."/>
<meta property="og:description" content="..."/> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-09T16:36:21.907

确保您对要通过 Google+ 共享链接在 Google+ 上共享的链接进行 URL 编码。

例如：如果你想分享链接`http://example.com?a=b&c=d`，首先 URL 对链接进行编码，如下所示：

```
http%3A%2F%2Fexample.com%3Fa%3Db%26c%3Dd 
```

现在您可以通过分享链接在 Google+ 上分享链接：

```
https://plus.google.com/share?url=http%3A%2F%2Fexample.com%3Fa%3Db%26c%3Dd 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-28T11:50:59.103

```
function googleplusbtn(url) {
      sharelink = "https://plus.google.com/share?url="+url;
      newwindow=window.open(sharelink,'name','height=400,width=600');
      if (window.focus) {newwindow.focus()}                                                                                                                                
      return false;
    }   
   var url="www.google.com";
        googleplusbtn(url); 
```

[参考这个链接](http://bobbelderbos.com/2011/11/customized-google-share-button/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-02T13:19:28.150

共享链接适用于本机客户端应用程序、Flash 应用程序、高度隐私敏感的网站以及其他可能无法使用 +1 或共享按钮的用户。将以下标记添加到您的网站将包括一个简单的图标，该图标将为您的访问者弹出一个共享对话框。

```
 <a href="https://plus.google.com/share?url=https://stackoverflow.com/questions/11868291/google-plus-share-and-parameters-in-url" onclick="javascript:window.open(this.href,
          '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><img
          src="https://www.gstatic.com/images/icons/gplus-64.png" alt="Share on Google+"/></a>
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-09-16T10:22:29.890

答案很差。您应该使用 api 登录然后共享内容。

```
 require_once 'google-api-php-client-master/src/Google/Client.php';
$client = new Google_Client();
$client->setClientId('YOUR_CLIENT_ID');
$client->setClientSecret('YOUR_CLIENT_SECRET');
$client->setRedirectUri('YOUR_REDIRECT_URI');
$plus = new Google_PlusService($client);

$authUrl = $client->createAuthUrl();
$visibleActions = array(
  'http://schema.org/AddAction',
  'http://schema.org/ReviewAction');

$authUrl .= '&request_visible_actions=' .
    urlencode(implode(' ', $visibleActions));
print '<a href="' . $authUrl . '">Sign in with Google</a>'; 
```

# asp.net-mvc - MVC DisplayNameAttribute 和 Ninject：可能吗？

> ID：11868292
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:16.027
> 
> 标签：asp.net-mvc, asp.net-mvc-4, ninject, ninject-2, ninject.web.mvc

让我们假设以下基本项目设置：

```
- Core
-- Attributes
--- CustomDisplayNameAttribute : DisplayNameAttribute
- UI 
```

UI 代表 MVC Web 界面，核心实现了所有领域的业务对象，包括像`CustomDisplayNameAttribute`. 该属性包含额外的依赖项，如语言解析器，例如处理后备订单。休眠会话将是另一个可能的依赖项。

在早期的项目中，这些属性会进行全局请求以获取解析器。这是 IMO 丑陋的，应该以不同的方式处理。此外，Core 应该没有`HttpContext`: 因为每个请求都需要语言解析器，它可能最终出现在`HttpContext`Items Collection 中。

现在我是**Ninject**的初学者，我不确定它是否是正确的工具，以便将此类依赖项转化为类似`CustomDisplayNameAttribute`?

换句话说，它会是这样的：

*   `HttpContext`如果创建了属性，则使用Items Collection中的语言解析器填充其他语言解析器属性
*   如果没有`HttpContext`（例如测试、石英作业等），请从其他地方获取。

感谢任何输入

**编辑：**示例代码

```
namespace Core.Attributes
{
    public class CustomDisplayNameAttribute : DisplayNameAttribute
    {

        private string textCode;

        /// <param name="textCode">According to this Text-Code, we will load
        /// and resolve the text.</param>
        public DeimosDisplayNameAttribute(string textCode)
        {
            this.textCode = textCode;
        }

        /// <summary>
        /// Load and resolve Text according to Text-Code
        /// </summary>
        public override string DisplayName
        {
            get 
            {
                // Load - Ooops: First global access 
                // --> How can it be injected with IoC?
                TextbausteinRepository repo = Root.GetTextBausteinRepository();
                var textItem = repo.GetText(textCode);
                // Resolve - Ooops: Second global access
                // --> How can it be injected with IoC?
                TextResolver resolver = Root.GetTextResolver();
                return resolver.resolve(textItem);
            }
        }
    }

} 
```

**编辑2：**在这种情况下，似乎没有办法绕过全局访问，比如注册表模式或类似的。UI 将在那里注册所需的数据，并且属性将从那里访问它。我们开始考虑将它存储在 中`ThreadLocal<T>`，但这似乎并没有真正保存，因为在生命周期中存在线程交换的可能性。所以似乎没有办法`HttpContext`在注册表层中存储。有关此主题的更多信息，请参阅 [Cup(Of T)][1]。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:25:09.527

我认为这是不可能的，因为数据属性不像过滤器那样在运行时调度。因此，没有地方可以拦截创建并注入您正在寻找的内容。

# entity-framework-4 - 实体框架4代码先行，对多个表使用同一个模型？

> ID：11868295
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:23.133
> 
> 标签：entity-framework-4

我首先使用带有代码的实体框架 4。我有一个模型，我希望能够根据配置文件将此模型映射到数据库中的不同表。

示例模型：

```
 public class Statistic
{
    [Key]
    public int id { get; set; }
    public string jobName { get; set; }
    public DateTime date { get; set; }
    public int pages { get; set; }
} 
```

每个客户都有一个配置文件，其中指定了应该使用的表名。因此，每个客户都应该有自己的表（在同一个数据库中），上面的模型。

我如何使用 Entity Framework 4 做到这一点？

我在我的 DbContext 中尝试了这个：

```
modelBuilder.Entity<Statistic>().ToTable(tabelName); 
```

但是当我使用它时，EF 所做的是将现有的表名更改为新的表名，而不是创建和使用新的表名。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:48:16.787

这不可能。每个映射集的每个类只能映射一次（在常见情况下每个上下文）。为什么？因为数据库的访问点是一个 DbSet（或 ObjectContext API 中的 ObjectSet），它的创建方式很简单：

```
var set = dbContext.Set<Statistics>(); 
```

EF 应该如何知道`Statistics`应该使用哪个类的映射？它必须知道使用哪个映射来查询正确的表并将更改保存到正确的表。您可能会争辩说它可以定义为参数，但这会将映射细节暴露给上层 - 这是不可取的。

编辑：

如果您的应用程序逻辑从不需要访问多个客户的统计信息，您可以为每个客户动态创建映射。你需要：

*   创建实例`DbModelBuilder`并定义映射（或填充`Configurations`） - 在此步骤中，您将为当前客户提供表的名称
*   调用`Build`方法获取`DbModel`实例
*   调用实例获取 DbCompiledModel`Compile`实例`DbModel`
*   **在某处缓存编译模型**。模型编译是一项昂贵的操作，您只需为每个客户（以及每次应用程序重新启动）执行一次。
*   将编译后的模型传递给`DbContext`构造函数并使用该上下文实例仅访问该客户的数据

如果您需要同时访问多个客户的数据，则必须通过 SQL 来完成。

# mysql - phpmyAdmin 在数据库和表在 mySQL CLI 中看起来不错时给出错误

> ID：11868296
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:23.743
> 
> 标签：mysql, phpmyadmin

我从 phpMyAdmin 中更改了表的名称，但它立即变成了废话。之后，当我尝试使用 phpMyAdmin (/phpMyAdmin/index.php) 连接时，日志中出现错误：

```
[Wed Aug 08 14:18:58 2012] [error] Query call failed: Table 'mydb.mychangedtbl' doesn't exist (1146) 
```

mychangedtbl 是名称已更改的表。此问题仅在 phpMyAdmin 中，我能够访问从 CLI 找到的数据库和表。我重新启动了 mySQL，但这并没有解决。似乎有些东西被 phpMyAdmin 卡住了。我也重新启动了浏览器，但这也没有帮助。

当我将此特定表重命名为使用命令行时，myphphAmin 再次正常工作。这是这个表的结构：

```
 mysql> DESCRIBE mychangedtbl;
    +-----------+-------------+------+-----+---------+-------+
    | Field     | Type        | Null | Key | Default | Extra |
    +-----------+-------------+------+-----+---------+-------+
    | userid    | char(6)     | NO   | PRI | NULL    |       |
    | userpass  | varchar(40) | NO   |     | NULL    |       |
    | userlevel | char(3)     | NO   |     | o       |       |
    | userpcip  | varchar(45) | NO   |     | NULL    |       |
    +-----------+-------------+------+-----+---------+-------+
    4 rows in set (0.00 sec)

mysql> 
```

列 userpass 有 Collat​​ion = asci_bin 它没有显示在上面的输出中，其他列是 ascii_general_ci

请建议。

泰。拉杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:55:11.973

这是因为 apache 使用同一张表进行 mysql 身份验证。我更改了 apache 配置并重新启动。那让我更改表名。一切都好。

# java - Android - 定义微调器中显示的值（与选定值不同）

> ID：11868297
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:24.383
> 
> 标签：java, android, spinner

我有一个微调器，其中包含显示在 2 行上的动态数据。我需要帮助的是在微调器文本框中仅显示微调器值 (ItemArrayName[i]) 的一部分。

To calrify in the popup when the spinner is clicked, I require the full text, however when the item has been select I only require the item name.

例如在应用程序内：项目名称

在微调器选择中弹出：项目名称 Atk = 10，Def = 10

```
Java Code:

ArrayList<String> ItemArrayList = new ArrayList<String>();  
for(int i = 0; i < ItemArrayName.length; i++)
{
    ItemArrayList.add(ItemArrayName[i] + "\nAtk = " + String.valueOf(ItemArrayAtk[i]) + ", Def = " + String.valueOf(ItemArrayDef[i]));
}

Spinner spnItem = (Spinner) view.findViewById(R.id.UseItem);
ArrayAdapter<String> adpItem = new ArrayAdapter<String> (context, R.layout.spinnerrow, ItemArrayList);
spnItem.setAdapter(adpItem);
spnItem.setOnItemSelectedListener(new OnItemSelectedListener() 
{   
    public void onItemSelected(AdapterView<?> parent, View view, int position, long arg3) 
    {
        //String city = "The item is " + parent.getItemAtPosition(position).toString();
        //Toast.makeText(parent.getContext(), city, Toast.LENGTH_LONG).show();
    }

    public void onNothingSelected(AdapterView<?> arg0)
    {
        // TODO Auto-generated method stub
    }
}); 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:53:33.947

如何使用 Hashtable 将您在微调器中显示的内容映射到更详细的弹出字符串？

编辑：这是使用哈希表对您的代码进行的原始且可能非编译的修改，如下所述：

```
// EDIT #1: Create a hashtable to lookup stuff:
final Hashtable<String, String> vals = new Hashtable<String, String>();

      for(int i = 0; i < ItemArrayName.length; i++)
      {
         vals.put(ItemArrayName[i], ItemArrayName[i] + "\nAtk = " + String.valueOf(ItemArrayAtk[i]) + ", Def = " + String.valueOf(ItemArrayDef[i]));
      }

      Spinner spnItem = (Spinner) view.findViewById(R.id.UseItem);
      // EDIT #2: Extract the array of hash keys to show in your list:
      ArrayAdapter<String> adpItem = new ArrayAdapter<String> context, R.layout.spinnerrow, vals.keySet().toArray(new String[vals.size()]));
      spnItem.setAdapter(adpItem);
      spnItem.setOnItemSelectedListener(new OnItemSelectedListener()
      {
         public void onItemSelected(AdapterView<?> parent, View view, int position, long arg3)
         {
            // EDIT #3: retrieve the full string from the hashtable using "get":
            String city = "The item is " + vals.get(parent.getItemAtPosition(position).toString());
            //Toast.makeText(parent.getContext(), city, Toast.LENGTH_LONG).show();
         }

         public void onNothingSelected(AdapterView<?> arg0)
         {
            // TODO Auto-generated method stub
         }
      }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:59:02.257

尝试将短文本映射到长文本。

```
HashMap<String,String> itemValues = new HashMap<String,String>();
itemValues.add("short text","the full long text that pops up when item is selected");

String longTextToDisplay = itemValues.get(currentSelectedShortText); 
```

当然这是一个简化的例子，可以做得更灵活，但这是基本思想。你只是说“这个短文本与这个长文本相配”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:02:27.820

每个人都使这比必须的要困难得多。如果数据已经显示在微调器中，您可以从那里抓取它，而无需参考支持数据。

假设您有一个包含两个文本视图（称为 tv1 和 tv2）的 LinearLayout 作为微调器的行布局，并且您想要 tv2 的值，您可以这样做：

```
public void onItemSelected(AdapterView<?> parent, View view, int position, long arg3)  
{ 
    TextView tvResult = (TextView) view.findViewById(r.id.tv2);
    String city = tvResult.getText().toString();
} 
```

**编辑**

我误解了你的问题......我知道没有办法让关闭的微调框显示的文本与使用 ArrayAdapter 的微调框内的实际选择不同。如果有，我有兴趣看到/阅读它。

我可以想办法用 CursorAdapter 来做这件事，但正如我上面所说，我想不出任何方法来为 ArrayAdapter 管理它。

我能想到的一个选择是在 android 源代码中找到 spinner 类，将其复制出来并修改它以制作您自己的具有此类功能的 spinner 类。

# perl - 如何一起重命名具有随机名称的多个文件

> ID：11868298
> 
> 赞同：0
> 
> 时间：2012-08-08T15:47:32.253
> 
> 标签：perl, file-rename

我有随机名称的文件，我想将它们全部重命名，如 Trace1、Trace2 等等....有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:19:18.197

或者在 Perl 中：

```
#!/usr/bin/perl
use strict;
use warnings;

# use dirname() to keep the renamed files in the same directory
use File::Basename qw( dirname );

my $i = 1;
for my $file (@ARGV) {
    rename $file, dirname($file) . "/Trace$i"; 
    print "$file -> Trace$i\n";
} continue { $i++ } 
```

如果您是 Linux 新手，您还需要记住使脚本可执行（假设脚本保存在名为 的文件中`random-renamer`）：

```
chmod 755 random-renamer 
```

然后运行它（重命名`random-files`目录中的所有文件）：

```
./random-renamer random-files/* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:14:48.097

这会检查是否存在任何已命名的文件`Trace#`并避免破坏它们。

```
use Path::Class qw( dir );
use List::Util  qw( max );

my $dir = dir(...);

my @files =
   map $_->basename(),
    grep !$_->is_dir(),
     $dir->children();

my $last =
   max 0,
    map /^Trace([0-9]+)\z/,
     @files;

my $errors;
for (@files) {
   my $old = $dir->file($_);
   my $new = $dir->file("Trace" . ++$last);
   if (!rename($new, $old)) {
      warn("Can't rename \"$old\" to \"$new\": $!\n");
      ++$errors;
   }
}

exit($errors ? 1 : 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:50:56.887

您可以只使用 shell 命令：

```
i=1;
for f in *
do
    mv $f "Trace$i"
    i=$(($i+1))
done 
```

# c# - C# 将类强制转换为接口列表

> ID：11868311
> 
> 赞同：6
> 
> 时间：2012-08-08T15:48:00.970
> 
> 标签：c#, interface, casting, invoke

我正在尝试动态加载一些 .dll 文件。文件是插件（目前是自己编写的），它们至少有一个实现`MyInterface`. 对于每个文件，我正在执行以下操作：

```
 Dictionary<MyInterface, bool> _myList;

    // ...code

    Assembly assembly = Assembly.LoadFrom(currentFile.FullName);
    foreach (Type type in assembly.GetTypes())
    {
        var myI = type.GetInterface("MyInterface");
        if(myI != null)
        {
            if ((myI.Name == "MyInterface") && !type.IsAbstract)
            {
                var p = Activator.CreateInstance(type);
                _myList.Add((MyInterface)p, true);
            }
        }
    } 
```

运行此程序会导致强制转换异常，但我找不到解决方法。无论如何，我想知道为什么这根本不起作用。我正在寻找 .NET Framework 3.5 中的解决方案。

发生在我身上的另一件事是`null`在上面的代码中`p`添加新条目之前运行以下命令后进入：`_myList`

```
var p = type.InvokeMember(null, BindingFlags.CreateInstance, null,
                          null, null) as MyInterface; 
```

`p`这段代码是第一次尝试加载插件，我还没有找到原因`null`。我希望有人能引导我走向正确的道路:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T16:11:30.450

有更简单的方法可以检查您的类型是否可以转换为您的界面。

```
Assembly assembly = Assembly.LoadFrom(currentFile.FullName);
foreach (Type type in assembly.GetTypes())
{
    if(!typeof(MyInterface).IsAssignableFrom(type))
        continue;

    var p = Activator.CreateInstance(type);
    _myList.Add((MyInterface)p, true);
} 
```

如果`IsAssignableFrom`为假，则您的继承有问题，这很可能是您的错误的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T16:18:06.077

您应该真正阅读Jon Skeet 的[Plug-ins and cast exceptions](http://www.yoda.arachsys.com/csharp/plugin.html)，它解释了您看到的行为以及如何正确地执行插件框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T16:12:23.243

请查看以下代码。我认为[Type.IsAssignableFrom(Type type)](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom%28v=vs.90%29.aspx)在这种情况下可以帮助你。

```
Assembly assembly = Assembly.LoadFrom(currentFile.FullName);
///Get all the types defined in selected  file
Type[] types = assembly.GetTypes();

///check if we have a compatible type defined in chosen  file?
Type compatibleType = types.SingleOrDefault(x => typeof(MyInterface).IsAssignableFrom(x));

if (compatibleType != null)
{
    ///if the compatible type exists then we can proceed and create an instance of a platform
    found = true;
    //create an instance here
    MyInterface obj = (ALPlatform)AreateInstance(compatibleType);

} 
```

# php - 无法将我的数据插入数据库 phpmyadmin

> ID：11868316
> 
> 赞同：1
> 
> 时间：2012-08-08T15:48:13.560
> 
> 标签：php, html, database, phpmyadmin, registration

我的代码有问题 我尝试使用 php 制作注册表单，但无法将数据插入数据库 这是我的代码

registration_form.php 注册表单

```
 <body>
 <form method="post" action="register.php">
 <table border="0">

 <tr><td>username: </td><td><input type="text" name="username" /></td></tr>

 <tr><td>Password: </td><td><input type="password" name="password" /></td></tr>

 <tr><td>Confirm Password: </td><td><input type="password" name="confirm_password" /></td></tr>

 <tr><td></td><td><input type="submit" value="submit" /></td></tr>

 </table>
 </form>
 </body>
 </html> 
```

注册.php

```
 $con=mysql_connect("localhost","root","");
 /* Now, we select the database */
 mysql_select_db("login&register");

 /* Now we will store the values submitted by form in variable */
 $username=$_POST['username'];
 $pass=$_POST['password'];
 /* we are now encrypting password while using md5() function */
 $password=md5($pass);
 $confirm_password=$_POST['confirm_password'];

 /* Now we will check if username is already in use or not */
 $queryuser=mysql_query("SELECT * FROM register WHERE username='$username' ");
 $checkuser=mysql_num_rows($queryuser);
 if($checkuser != 0)
 { echo "Sorry, ".$username." is already been taken."; }
 else {

 /* now we will check if password and confirm password matched */
 if($pass != $confirm_password)
 { echo "Password and confirm password fields were not matched"; }
 else {

 /* Now we will write a query to insert user details into database */
 $insert_user=mysql_query("INSERT INTO register (username, password) VALUES ('$username',     '$password')");

 if($insert_user)
 { echo "Registration Succesfull"; }
 else
 { echo "error in registration".mysql_error(); }

 /* closing the if else statements */
 }}

 mysql_close($con);
 ?> 
```

当我单击提交按钮时出现错误消息

```
 Object not found!

 The requested URL was not found on this server. The link on the referring page seems to be wrong or outdated. Please inform the author of that page about the error.

 If you think this is a server error, please contact the webmaster.

 Error 404

 localhost
 08/08/12 23:46:37
 Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1 
```

请帮我解决这个问题谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:49:58.257

```
<form method="post" action="register.php"> 
```

您的 PHP 文件似乎被调用`registration.php`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:50:16.043

您的表单操作是`register.php`，但您的 php 文件被调用`registration.php`，将您的表单操作更改为`registration.php`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T15:50:29.260

您正在尝试以`register.php`您的形式访问，而不是`registration.php`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T15:51:29.093

这看起来不像是数据库问题。而是找不到 register.php。您已将该文件保存为registration.php。

# java - 具有多个父节点的 DocumentBuilderFactory

> ID：11868324
> 
> 赞同：1
> 
> 时间：2012-08-08T15:48:41.860
> 
> 标签：java, xml, xml-parsing

我正在使用 Java 开发一个简单的 XML 解析器。我一直在成功使用 DocumentBuilderFactory 与许多来源，但我的一个新来源是单个节点的集合。

file.xml 如下所示：

```
<XML Version....>
<!DOCTYPE...>
<main_document_node>
.....others....
</main_document_node>
<XML Version....>
<!DOCTYPE...>
<main_document_node>
.....others....
 </main_document_node> 
```

我一直在使用这样的命令：

```
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
Document d = dbf.newDocumentBuilder().parse(/path/file.xml); 
```

但这似乎不适用于多个父节点。有没有比制作一个我写 main_document_node 的临时工作文件更简单的方法？该伪代码将是

```
new Writer temp.xml
new Reader file.xml
while not at the end of file.xml
    read/write first main_document_node to temp
    parse temp.xml 
```

我认为应该有一种方法可以使用 DocumentBuilderFactory 的 inputsource/stream 选项，但我不确定如何去做。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:02:41.207

您可以通过从计算字符串片段（对于一个节点）创建 InputStream 来跳过写入文件步骤：

```
new Reader file.xml
while not at the end of file.xml {
    String node = read_first_main_document_node();
    InputStream is = new ByteArrayInputStream( node.getBytes( charset ) );
    parse(is); 
} 
```

# oracle - 数据库中数据类型使用分析

> ID：11868326
> 
> 赞同：1
> 
> 时间：2012-08-08T15:48:51.720
> 
> 标签：oracle, database-design

我想知道是否对数据库中使用的不同数据类型的使用进行了分析？我的意思是，对不同数据类型的使用进行排名的分析，例如：

最常被使用

1.  十进制
2.  数据库中的 DATE ....etc（主要是 Oracle）？

如果它还包括通常在此数据上运行的操作类型，那就太棒了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T21:32:29.947

可能不完全是您正在寻找的东西，但它是一个入门者-

```
SQL> select data_type, round(avg(data_length),4) avg_length,round(avg(density),4) 
avg_density
from user_tab_cols
group by data_type;

DATA_TYPE               AVG_LENGTH         AVG_DENSITY
------------           -------------       -------------
DATE                   7                    0.3369 
TIMESTAMP(6)           11                   1 
RAW                    32                   1 
NUMBER                 22                   0.2429 
CHAR                   1.0776               0.254 
VARCHAR2               34.9129              0.3941 
TIMESTAMP(3)           11                   0.2408 
```

# jquery - 每个 div 只选择一个选项

> ID：11868327
> 
> 赞同：0
> 
> 时间：2012-08-08T15:48:53.797
> 
> 标签：jquery, html

我有一组带有选项的 div，我已经编写了一些只选择一个选项的 jQuery。

现在我只想为每个 div（class=blahblah）选择一个选项（class=choice）。

这是HTML：

```
<div class="blahblah"id="finish_colour">
<div class="choice"></div>
<div class="choice"></div>
<div class="choice"></div>
</div>

<div class="blahblah"id="main_colour">
<div class="choice"></div>
<div class="choice"></div>
<div class="choice"></div>
</div> 
```

这是jQuery：

```
$('.choice').click(function(){

    $('.choice').not(this).removeClass('selected_choice');
    $(this).toggleClass('selected_choice');
}); 
```

div 都具有相同的类，但如果有任何帮助，则 id 不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:03:43.127

你可以试试这样的...

```
$('.choice').click(function(){
    var myDiv = $(this);
    $('.choice').removeClass('selected_choice');
    myDiv.toggleClass('selected_choice');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:04:48.973

假设你的 html 是这样的，

```
<div>
  <div class="choice"></div>
  <div class="choice"></div>
  <div class="choice"></div>
</div> 
```

您可以将其修改为像这样的每个 div，

```
$('.blahblah .choice').click(function(){
    $(this).siblings('.choice').removeClass('selected_choice');
    $(this).toggleClass('selected_choice');
}); 
```

# c# - 注销和登录后的会话变量

> ID：11868329
> 
> 赞同：0
> 
> 时间：2012-08-08T15:49:00.280
> 
> 标签：c#, asp.net, session

有些答案很接近，但不是我遇到的问题。这是我正在采取的导致问题的步骤：

1.  登录我们的网站。-- 会话变量已设置。
2.  重定向到默认页面很好。-- 会话变量正确，因为数据显示正确。
3.  登出网站。-- 正确重定向到登录页面。
4.  再次登录。-- 再次设置会话变量。
5.  重定向到默认页面发生。-- 会话变量为空。数据显示不正确。

这是我在登录期间将变量放入 Session 的方式。

```
Session.Add("company", companyPrikey); 
```

这是我在默认页面中引用 Session 的方式

```
if (Session["company"] != null) 
```

即使我`Session.Add`在第二次登录期间看到正在运行，但如果发现默认页面`Session["company"]`是`null`在运行时`Page_Load()`。

我看过了`Session.SessionID`，每次登录时它们都是一样的。

任何让用户离开网站的事情（导航到不同的 URL、关闭选项卡、关闭 IE）都可以解决问题，他们可以再次正确登录。

**- 编辑 -**

重定向只是在 URL

```
Login.aspx?ReturnUrl=~/History.aspx 
```

登录完成，然后返回历史页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T14:23:56.260

似乎会话在注销时可能没有被正确删除。因此，空值检查失败，并且在后续登录时没有为变量赋予新值。

`Session.Abandon()`如果您还没有，请尝试注销。*这将在页面完成处理时*关闭会话，即不要在放弃代码之后直接重定向到登录页面。

更多信息：http: [//msdn.microsoft.com/en-us/library/ms524310%28VS.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms524310%28VS.90%29.aspx)

# xml - 使用 XSLT 从 XML 中剥离标签 All except Some（否定条件）

> ID：11868331
> 
> 赞同：1
> 
> 时间：2012-08-08T15:49:01.387
> 
> 标签：xml, xslt, xml-parsing

我想从我的 XML 文件中删除所有标签，除了有限数量的标签，我知道。我怎么能用 XSLT 做到这一点。

我知道我可以使用以下内容从我的 xml 中删除 div 标签，但我想否定，例如 Strip all BUT Div。

```
 <xsl:template match = "div">
        <xsl:apply-templates select="@*|node()"/>
  </xsl:template> 
```

XSLT 文件的更多片段：

```
 <xsl:template match="div"> <!-- switch the element name -->
    <xsl:element name="newdiv">
      <xsl:copy-of select="@*" />
      <xsl:apply-templates />
    </xsl:element>
  </xsl:template>

  <xsl:template match="div"/>
  <xsl:template match="*"> 
     <xsl:copy> 
    <xsl:apply-templates select="@*|node()"/> 
     </xsl:copy> 
  </xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:05:59.600

我相信这个问题已经[回答](https://stackoverflow.com/a/1137101/1500313)了。使用两个模板。

```
<xsl:template match="*">
   <!-- Everything -->
</xsl:template>

<xsl:template match="something | somethingelse">
   <!-- what you want ignored -->
</xsl:template> 
```

* * *

第四次编辑。

输入样本：

```
<body>
    <table>
        <tr>
            <td>
            </td>
        </tr>
    <div>content</div>
    </table>
    <div>content again</div>
</body> 
```

XSLT 转换来做你需要的：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="div">
       <xsl:element name="div">
         <xsl:copy-of select="@*" />
         <xsl:apply-templates />
       </xsl:element>
    </xsl:template>

    <xsl:template match="*">
      <xsl:apply-templates select="@*|node()"/>
    </xsl:template>
</xsl:stylesheet> 
```

这将删除除 DIV 之外的所有标签。并保留所有标签内容。我刚试过。

# c# - 如何下载Autofac、Caliburn.Micro for Framework3.5的代码源

> ID：11868336
> 
> 赞同：0
> 
> 时间：2012-08-08T15:49:17.367
> 
> 标签：c#, autofac, caliburn.micro

我想下载 Autofac 和 Caliburn.Micro 源代码，但我只有 framework4.0 的源代码。

**我不知道在哪里可以下载framework3.5的（源代码）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:53:14.027

你看过[http://code.google.com/p/autofac/wiki/BuildingFromSource](http://code.google.com/p/autofac/wiki/BuildingFromSource)吗？您还需要用于 .Net 3.5 的 SandCastle（该页面上的链接）

Caliburn 在这里：[http ://caliburnmicro.codeplex.com/SourceControl/list/changesets](http://caliburnmicro.codeplex.com/SourceControl/list/changesets)

# initialization - 神经网络初始化 - Nguyen Widrow 实现？

> ID：11868337
> 
> 赞同：3
> 
> 时间：2012-08-08T15:49:23.077
> 
> 标签：initialization, neural-network

我已经尝试实现 Nguyen Widrow 算法（如下），它似乎运行正常，但我有一些后续问题：

*   这看起来像一个正确的实现吗？

*   Nguyen Widrow 初始化是否适用于任何网络拓扑/大小？（即5层AutoEncoder）

*   Nguyen Widrow 初始化对任何输入范围都有效吗？（0/1、-1/+1 等）

*   Nguyen Widrow 初始化对任何激活函数都有效吗？（即 Logistic、Tanh、Linear）

下面的代码假设网络已经被随机化为 -1/+1 ：

```
 ' Calculate the number of hidden neurons
        Dim HiddenNeuronsCount As Integer = Me.TotalNeuronsCount - (Me.InputsCount - Me.OutputsCount)

        ' Calculate the Beta value for all hidden layers
        Dim Beta As Double = (0.7 * Math.Pow(HiddenNeuronsCount, (1.0 / Me.InputsCount)))

        ' Loop through each layer in neural network, skipping input layer
        For i As Integer = 1 To Layers.GetUpperBound(0)

            ' Loop through each neuron in layer
            For j As Integer = 0 To Layers(i).Neurons.GetUpperBound(0)

                Dim InputsNorm As Double = 0

                ' Loop through each weight in neuron inputs, add weight value to InputsNorm
                For k As Integer = 0 To Layers(i).Neurons(j).ConnectionWeights.GetUpperBound(0)
                    InputsNorm += Layers(i).Neurons(j).ConnectionWeights(k) * Layers(i).Neurons(j).ConnectionWeights(k)
                Next

                ' Add bias value to InputsNorm
                InputsNorm += Layers(i).Neurons(j).Bias * Layers(i).Neurons(j).Bias

                ' Finalize euclidean norm calculation
                InputsNorm = Math.Sqrt(InputsNorm)

                ' Loop through each weight in neuron inputs, scale the weight based on euclidean norm and beta
                For k As Integer = 0 To Layers(i).Neurons(j).ConnectionWeights.GetUpperBound(0)
                    Layers(i).Neurons(j).ConnectionWeights(k) = (Beta * Layers(i).Neurons(j).ConnectionWeights(k)) / InputsNorm
                Next

                ' Scale the bias based on euclidean norm and beta
                Layers(i).Neurons(j).Bias = (Beta * Layers(i).Neurons(j).Bias) / InputsNorm

            Next

        Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T11:25:41.087

Nguyen & Widrow 在他们的论文中假设输入介于 -1 和 +1 之间。Nguyen Widrow 初始化对任何长度有限的激活函数都有效。同样在他们的论文中，他们只讨论了 2 层神经网络，不确定 5 层神经网络。

小号

# sql - 无法对包含聚合或子查询的表达式执行聚合函数

> ID：11868339
> 
> 赞同：0
> 
> 时间：2012-08-08T15:49:24.793
> 
> 标签：sql

在我尝试计算每个帐户 (ACCT) 有多少付款 (trans_key) 之前，此查询工作正常。

无法对包含聚合或子查询的表达式执行聚合函数。

```
SELECT CONVERT(VARCHAR,D.ACCT) ClientReference,
    ISNULL((SELECT S.SD_DATA 
            FROM SDDATA AS S 
            WHERE S.DEBT_KEY=D.DEBT_KEY AND S.SD_KEY=36),' ') Division,
    REPLACE(RTRIM(DB.FNAME)+' '+RTRIM(DB.LNAME),',',' ') AccountHolder,
    CONVERT(VARCHAR,D.DOR,101) ListedDate,
    ISNULL((SELECT SA.SD_DATA 
            FROM SDDATA AS SA 
            WHERE SA.DEBT_KEY=D.DEBT_KEY 
                AND SA.SD_KEY=2),' ') AssignmentType,
    CONVERT(VARCHAR,D.BAL) CurrentBalance,
    CONVERT(VARCHAR,D.ASSIGNED) PlacementBalance,
    CONVERT(VARCHAR,isnull((SELECT -1*SUM(TD.DIST_AMT) 
                            FROM TRANSDIST AS TD,TRANS AS T,TRANS_CODE AS TC 
                            WHERE T.DEBT_KEY=D.DEBT_KEY 
                                AND TD.TRANS_KEY=T.TRANS_KEY  
                                AND TC.TRANS_CODE=T.TRANS_CODE 
                                AND TC.TRANS_BILL=1),0)) AmountRecovered,
    CONVERT(VARCHAR,isnull((SELECT (-1*SUM(TD.DIST_AMT)+SUM(DIST_NET)) 
                            FROM TRANSDIST AS TD,TRANS AS T,TRANS_CODE AS TC 
                            WHERE T.DEBT_KEY=D.DEBT_KEY 
                                AND TD.TRANS_KEY=T.TRANS_KEY  
                                AND TC.TRANS_CODE=T.TRANS_CODE 
                                AND TC.TRANS_BILL=1),0)) AmountApplied,
    CONVERT(VARCHAR,isnull((SELECT (-1*SUM(DIST_NET)) 
                            FROM TRANSDIST AS TD,TRANS AS T,TRANS_CODE AS TC 
                            WHERE T.DEBT_KEY=D.DEBT_KEY 
                                AND TD.TRANS_KEY=T.TRANS_KEY  
                                AND TC.TRANS_CODE=T.TRANS_CODE 
                                AND TC.TRANS_BILL=1),0)) SMAFees,
    COUNT((select trans_key from trans)) as Payments 
FROM DEBT AS D,DEBTOR AS DB,STATUS AS ST
WHERE ST.STAT_KEY=D.STAT_KEY
    AND DB.DEBTOR_KEY=D.DEBTOR_KEY
    AND D.CLIENT_KEY =43 
    AND ST.CATEGORY='A' 
```

当弄乱计数聚合函数时，我能够获取一些数据，但不是正确的计数。它只是给了我表格内所有“付款”的计数，而不是每个 ACCT 的金额。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:20:02.163

我觉得您的查询是以一种非常奇怪的方式编写的，这将使其难以调试。一些想法：

*   停止转换您选择的所有内容（至少在获得所需结果之前）。这将使您的代码更简洁，更易于调试
*   如果可能，请停止选择语句中的子查询。例如：

    ISNULL((从 SDDATA 中选择 SA.SD_DATA 作为 SA WHERE SA.DEBT_KEY=D.DEBT_KEY AND SA.SD_KEY=2),' ') AssignmentType,

可以转换为

```
ISNULL(SA.SD_DATA,' ')
...
...
FROM DEBT AS D
LEFT JOIN SDDATA AS SA 
ON sa.DEBT_KEY = d.DEBT_KEY 
```

*   停止使用隐式连接

*   阅读 GROUP BY 如何与聚合函数一起工作。

这不是针对您的确切问题的解决方案，但是如果您想解决此问题，则需要将此查询置于可行状态并进行一些基础研究。

# php - 用 php/html 显示 mysql blob 图像

> ID：11868343
> 
> 赞同：1
> 
> 时间：2012-08-08T15:49:35.873
> 
> 标签：php, mysql, image, blob

经过两天的搜索，我来到这里希望找到解决方案。

我实际上是在尝试将文件存储在数据库（mysql）中，我知道它有多糟糕，但我们实际上需要对应用程序进行足迹，所以我们不能将它们与源一起存储。

我使用 3 个文件：

*   我的表单（经典的 html/php 文件）
*   一个 php 文件，它处理表单中的数据以便将它们放入数据库
*   另一个 php 文件，以便从数据库中获取图像，发送一个 ID`GET`

问题是我无法显示我的图像。

**表格->**

```
<?php
    echo ('<img src="profil_pic_display.php?uid_owner=' . $dCookie['uid']. '">'); //The display line
    ?>
    <form method="POST" action="upload_profil_pic.php" enctype="multipart/form-data">
        <input type="hidden" name="MAX_FILE_SIZE" value="250000"/>
        Selectionnez une photo: <input type="file" name="avatar"/>
        <br/>
        <br/>
        <input class="ui-button" type="submit" value="Envoyer"/>
        <span><small>Formats acc&eacute;pt&eacute;s: .png/.jpeg/.jpg/.gif | Taille max: 250ko</small></span>
    </form> 
```

**处理表单数据的位置->**

```
<?php
require_once ('bdd.php');
require_once ('cookie.php');

$dCookie = check_cookie(1);
$maxSize = 250000;
$extensions = array('.png', '.gif', '.jpg', '.jpeg');

// On verifit que le transfert s'est bien deroule et donc que l'image est bien stocke     en tmp
if (!isset($_FILES['avatar']) || !is_uploaded_file($_FILES['avatar']['tmp_name'])) {
    echo('Probleme de transfert');
    die();
}    

$pData = $_FILES['avatar'];
$pName = basename($pData['name']);
$pType = $pData['type'];
$pSize = filesize($pData['tmp_name']);

// Verification de l'extension et de la taille
if (!in_array(strrchr($pName, '.'), $extensions) || ($pSize > $maxSize)) {
    echo('Fichier non valide.');
    die();
}
// anihilation des ' ' et des accents.
$pName = strtr($pName, 'ÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðòóôõöùúûüýÿ',      'AAAAAACEEEEIIIIOOOOOUUUUYaaaaaaceeeeiiiioooooouuuuyy');
$pName = preg_replace('/([^.a-z0-9]+)/i', '_', $pName);

//avant d'uplaoder une nouvelle image on supprime l'ancienne si il y a (en fonction de l'uid_owner
$reqCheckOldPic = $GLOBALS['bdd']->prepare('DELETE FROM num_profil_picture WHERE uid_owner   = :uid_owner;');
$reqCheckOldPic->bindParam(':uid_owner', $dCookie['uid']);
__log($dCookie['uid'], 'DELETE', array('QUERY' => $reqCheckOldPic->queryString, 'VALUE' =>    array(':uid_owner' => $dCookie['uid'])));
$reqCheckOldPic->execute();
$reqCheckOldPic->closeCursor();

// On prepare l'upload / recuperation du contenu binaire ET echappement du contenu binaire
$pBlob = file_get_contents($pData['tmp_name']);
$reqUpload = $GLOBALS['bdd']->prepare('INSERT INTO num_profil_picture (uid_owner,
                                                                    img_nom,
                                                                    img_taille,
                                                                    img_type,
                                                                    img_blob)
                                                            VALUE (:uid_owner,
                                                                    :img_nom,
                                                                    :img_taille,
                                                                    :img_type,
                                                                       :img_blob);');
$reqUpload->bindParam(':uid_owner', $dCookie['uid']);
$reqUpload->bindParam(':img_nom', $pName);
$reqUpload->bindParam(':img_taille', $pSize);
$reqUpload->bindParam(':img_type', $pType);
$reqUpload->bindParam(':img_blob', addslashes($pBlob));
__log($dCookie['uid'], 'INSERT', array('QUERY' => $reqUpload->queryString,
'VALUE' => array(
    ':uid_owner' => $dCookie['uid'],
    ':img_nom' => $pName,
    ':img_taille' => $pSize,
    ':img_type' => $pType,
        ':img_blob' => $pBlob)));
$reqUpload->execute();
$reqUpload->closeCursor();
header("Content-type: " . $pType);
echo ($pBlob);
?> 
```

**这里是显示->**

```
<?php

require_once('bdd.php');
require_once('cookie.php');

$reqGetPic = $GLOBALS['bdd']->prepare('SELECT img_type, img_blob FROM num_profil_picture WHERE uid_owner = :uid_owner;');
$reqGetPic->bindParam(':uid_owner', $_GET['uid_owner']);
$reqGetPic->execute();
$pic = $reqGetPic->fetch();

header("Content-type: " . $pic[0]);
header('Content-transfer-encoding: binary');
echo ($pic[1]);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T12:07:46.400

好的，我找到了解决方案，使用数据 URI。如果您遇到麻烦，请访问此处了解更多信息：[php: recreate and display an image from binary data](https://stackoverflow.com/questions/2070603/php-recreate-and-display-an-image-from-binary-data/2070625#2070625)。

# ios - iOS Quartz 2D中的线性化PDF？

> ID：11868344
> 
> 赞同：0
> 
> 时间：2012-08-08T15:49:42.507
> 
> 标签：ios, pdf

我通过 CGPDF*** 方法开发了一个 PDF 查看器。它对等待大量 PDF 下载感到恼火，因此使用流式 PDF 应该是一个好主意。

是否可以在 iOS 中通过 Quartz 2D 实现“线性化 PDF”（快速 Web 视图）？我找不到任何示例代码或文档。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T10:05:23.860

我是 PSPDFKit（一个商业 iOS PDF SDK）的作者，相信我，我也花了很多时间研究这个话题。[除非您使用诸如MuPDF](http://www.mupdf.com/)之类的第 3 方渲染框架，否则我认为没有办法。（但它们*真的*很贵）

现在的 CGPDFDocument (iOS6) 期望预告片位于底部，并且会在不完整的文档上失败。

# c++ - 时间：2019-01-10 标签：c++winsock server-client远程连接

> ID：11868345
> 
> 赞同：0
> 
> 时间：2012-08-08T15:49:47.880
> 
> 标签：c++, winsock

我正在尝试创建一个在两台远程计算机之间交换消息的简单应用程序。使用“127.0.0.1” ip 它可以正常工作，等待客户端的确认并连接到客户端，但是如果我尝试使用相同端口的本地“192.168.0.15”或我的全局 ip，服务器会立即连接到某事而没有等待客户。

这是我的服务器代码的一部分：

```
char ip[20] = "127.0.0.1"; int port = 19385;

SOCKET sockListen, sockConnect;

SOCKADDR_IN address;

sockConnect = socket (AF_INET, SOCK_STREAM, NULL);
address.sin_addr.s_addr = inet_addr (ip);
address.sin_family = AF_INET;
address.sin_port = htons (port); 
sockListen = socket (AF_INET, SOCK_STREAM, NULL);

bind (sockListen, (SOCKADDR*)&address, AddressSize);
listen (sockListen, SOMAXCONN);

sockConnect = accept (sockListen, (SOCKADDR*)&address, &AddressSize); 
```

...

请建议如何解决问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:51:05.567

您不应该在调用之前初始化`sockConnect`变量。 返回已连接到客户端的**新分配的套接字句柄。**您正在泄漏分配的套接字句柄。`socket()``accept()``accept()`**`socket()`**

 **您只能`bind()`访问属于运行应用程序的本地计算机的 NIC 的 IP。您不能`bind()`访问外部 IP。

您显示的代码根本没有进行任何错误处理。您需要添加它，例如：

```
int errCode;

SOCKET sockListen = socket (AF_INET, SOCK_STREAM, NULL); 
if (sockListen == INVALID_SOCKET)
{
    errCode = WSAGetLastError();
    // ...
}
else
{ 
    SOCKADDR_IN address = {0}; 
    address.sin_addr.s_addr = inet_addr (ip); 
    address.sin_family = AF_INET; 
    address.sin_port = htons (port);  

    if (bind (sockListen, (SOCKADDR*)&address, sizeof(address)) == SOCKET_ERROR)
    {
        errCode = WSAGetLastError();
        // ...
    }
    else
    {
        if (listen (sockListen, SOMAXCONN) == SOCKET_ERROR)
        {
            errCode = WSAGetLastError();
            // ...
        }
        else
        {
            int addressSize; 

            SOCKET sockClient = accept (sockListen, (SOCKADDR*)&address, &addressSize); 
            if (sockClient == INVALID_SOCKET)
            {
                errCode = WSAGetLastError();
                // ...
            }
            else
            {
                // ...
                closesocket(sockClient);
            }
        }
    }

    closesocket(sockListen);
} 
```**

# html - Chrome 打印带有垂直拉伸的 CSS Sprite

> ID：11868346
> 
> 赞同：1
> 
> 时间：2012-08-08T15:49:56.537
> 
> 标签：html, css, google-chrome, sprite

我正在尝试使用包含“奖项”（金，银，铜）的图像精灵来布置页面。它实际上是工作，保存在 Chrome 中的打印预览。在 Firefox/IE 中它看起来很好，但 Chrome 正在做的是背景图像正确启动（即背景位置有效），但图像的其余部分延伸到下一个元素的开头。请参阅[此网址](http://imgur.com/a/LdktD)以获取屏幕截图。

这是 HTML 和相关 CSS 的片段：

```
<span class="price">$22.15
    <br />
    <span class="awards-section">
    <span class="award gold">S.O.E.I.W.F</span>
    <span class="award silver">F.L.I.W.C</span>
    <span class="award silver">A.C.W.C</span>
    <span class="award bronze">F.L.I.W.C</span>
    <br />
    </span>
</span>

.awards-section {
    margin-top: -0.3em;
    display: block;
    font-size: 4mm;
    font-weight: normal;
}
.award {
    background-image: url('/images/general/awards.png');
    width: 60px;
    height: 25px;
    display: inline-block;
    padding-left: 62px;
    margin: 1px;
    background-repeat: no-repeat;
    line-height: 25px;
    float: left;
    clear: both;
}
.gold { background-position: 0 0; }
.silver { background-position: 0 -25px; }
.bronze { background-position: 0 -50px; }
.double-gold { background-position: 0 -75px; }
.double-silver { background-position: 0 -100px; }
.double-bronze { background-position: 0 -125px; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T15:21:12.443

上游错误已在 chrome 26 中解决。

[https://code.google.com/p/chromium/issues/detail?id=131054](https://code.google.com/p/chromium/issues/detail?id=131054)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T22:33:23.013

我也遇到过这个问题。我发现的唯一解决方法是切换到使用 img 标签裁剪器方法，而不是 background-image 方法。

方法显示在这里[http://www.artzstudio.com/2010/04/img-sprites-high-contrast/](http://www.artzstudio.com/2010/04/img-sprites-high-contrast/)

我不知道 chrome 在做什么，但我认为它正在抓取背景图像尺寸并以该尺寸显示它们，但使用 div 尺寸裁剪图像。如果我是对的，这真的很奇怪。

# javascript - .next() 未按预期工作

> ID：11868349
> 
> 赞同：-1
> 
> 时间：2012-08-08T15:50:01.857
> 
> 标签：javascript, jquery, html

所以，

```
if($(this).hasClass('active')){             
    $(this).removeClass('active');
    $(this).prev().addClass('active');                  
} 
```

工作正常，它将“活动”类添加到以前的同类 div 中。

```
if($(this).hasClass('active')){
    $(this).removeClass('active');
    $(this).next().addClass('active');
} 
```

但是，将类添加到下一个 div（正如我打算这样做的那样）大约 0.5 秒，然后将其删除。

这是所有 jQuery（根据您在下面的评论） - 请不要评论我可怕的代码组织

```
$(window).load(function () {

    // Initial variables
    var numberSlides = 0;
    var currentSlide = 1;
    var ready = true;
    var pageWidthR = $(document).width() - 352;
    var pageWidthL = $(document).width() - 352;

    // Update number of slides by number of .slide elements
    $('#features-slider .slide').each(function () {
        numberSlides++;
    });

    // Go through each slide and move it to the left of the screen
    var i = 0;

    $($('#features-slider .slide').get().reverse()).each(function () {

        if (i == 0) {

        } else {
            var newWidth = i * 115;
            $(this).css('left', '-' + newWidth + '%');
        }

        i++;

    });

    // Animate the first slide in
    $('#features-slider .slide:last-child').addClass('active').animate({
        left: 0
    }, 1500);

    // Remove the loading message
    $('#loading').fadeOut(1000, function () {
        $('#loading').remove();

        // Now that we're done - we can show it
        $('#features-slider').show();
    });

    /***** Left and Right buttons *****/

    /* Right */
    $('#rightbutton').click(function () {

        var numberSlides = 0;
        $('#features-slider .slide').each(function () {
            numberSlides++;
        });

        var index = $('.slide.active').index() + 1;

        if (!$('.slide').is(':animated') && index != 1) {

            $('#features-slider .slide').each(function () {

                if ($(this).hasClass('active')) {

                    var currentLeft = $(this).css('left');
                    var newLeft = parseInt(currentLeft) + 115;

                } else {

                    var currentLeft = $(this).css('left');
                    var newLeft = parseInt(currentLeft) + 115;

                }

                $(this).animate({
                    left: newLeft + '%'
                }, 1500);

                if ($(this).hasClass('active')) {

                    $(this).removeClass('active');
                    $(this).prev().addClass('active');

                }

            });

        }

    });

    /* Left */
    $('#leftbutton').click(function () {

        var numberSlides = 0;
        $('#features-slider .slide').each(function () {
            numberSlides++;
        });

        var index = $('.slide.active').index() + 1;
        if (!$('.slide').is(':animated') && index != numberSlides) {

            $('#features-slider .slide').each(function () {

                if ($(this).hasClass('active')) {

                    var currentLeft = $(this).css('left');
                    var newLeft = parseInt(currentLeft) - 115;

                } else {

                    var currentLeft = $(this).css('left');
                    var newLeft = parseInt(currentLeft) - 115;

                }

                $(this).animate({
                    left: newLeft + '%'
                }, 1500);

                if ($(this).hasClass('active')) {

                    $(this).next().addClass('active');
                    $(this).removeClass('active').not($(this).next());

                }

            });

        }

    });

});

$(document).ready(function () {

    // Hide the slider and show a loading message while we do stuff and the images / DOM loads - Also disable overflow on the body so no horizontal scrollbar is shown
    $('body').css('overflow-x', 'hidden');
    $('#features-slider').hide();
    $('#loading').html('<center> <img id="loader" src="/wp-content/themes/responsive/library/images/ajax-loader.gif" /> Loading</center>');

}); 
```

**解决**

新的左键功能：

```
 $('#leftbutton').click(function(){

                var numberSlides = 0;
                $('#features-slider .slide').each(function(){
                    numberSlides++;
                });

                var index = $('.slide.active').index()+1;

                if( !$('.slide').is(':animated') && index != numberSlides  ){

                    var done = false;               

                    $('#features-slider .slide').each(function(){

                        if($(this).hasClass('active')){

                            var currentLeft = $(this).css('left');
                            var newLeft = parseInt(currentLeft)-115;

                        } else {

                            var currentLeft = $(this).css('left');
                            var newLeft = parseInt(currentLeft)-115;

                        }

                    $(this).animate({left: newLeft+'%'}, 1500);

                    if($(this).hasClass('active') && done == false){

                            $(this).next().addClass('active');
                            $(this).removeClass('active');
                            done = true;

                    }

            });

            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:53:02.267

如果您正在遍历元素，那么应该清楚发生了什么 - 您将“活动”类添加到下一个元素，然后下一次迭代将其移除。

这只是一个猜测，因为您没有为我（或其他任何人）发布足够的代码来确定。

*编辑*-好的，既然您已经更新了问题，很明显猜测是正确的。该`.each()`函数将向前遍历元素。当一个元素具有“活动”类时，代码将其删除并将其添加到下一个元素，然后在下一次迭代中撤消工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T15:55:13.867

由于您正在引用`this`并且通过您所描述的行为，您可能会为元素列表迭代循环。结果，您正在完成您想要的操作，但下一次迭代正在删除以前的更改，因为您使用了删除一个类，然后再添加回该类。

就目前而言，您的代码并未说明这种情况是如何发生的。

**更新：** 正如怀疑的那样，您似乎正在循环，如下所示：`each(function(){`。在遍历您的对象时，该类被向前推进并且没有按预期运行。您正在声明将类添加到下一个元素，但将其从当前元素中删除，并且此行为将在您的迭代中继续。

在旁注中，更新您的代码以首先调用`removeClass()`当前对象，然后再将其添加到下一个对象：

```
if ($(this).hasClass('active')) {
    $(this).removeClass('active').next().addClass('active');
} 
```

# c# - C# WebView 不理解 alert() 的 JavaScript 调用（Windows 8 XAML 应用程序）

> ID：11868351
> 
> 赞同：4
> 
> 时间：2012-08-08T15:50:04.290
> 
> 标签：c#, javascript, xaml, webview, windows-8

我正在用 C# 和 XAML 编写一个 Windows 8 应用程序，它在 WebView 中托管一个网页。网页调用alert() 和confirm()，但WebView 抛出异常，说“'alert' 未定义”或“'confirm' 未定义”。可以启用警报（）和确认（），还是我需要编写代码来模拟它们的正常功能？如果我需要自己写，我应该如何开始这样的工作？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T16:16:41.573

警报和确认在 WebView 中不起作用。您可以使用[WebView.ScriptNotify从页面上的脚本接收事件，并使用该事件显示使用](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.scriptnotify.aspx)[MessageDialog 类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.popups.messagedialog.aspx)的对话框。

在您想要警报的脚本中...

```
window.external.notify('foo'); 
```

并在您的 C# 中使用 WebView.ScriptNotify 方法中的示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T09:14:25.077

你需要做一些解决方法。我这样做了，它对我有用。

```
 window.alert = function(__msg){window.external.notify(' + __msg + ');}; 
```

在这里参考我的一个类似的 windows phone[问题](https://stackoverflow.com/questions/11843617/unable-to-show-alert-via-javascript-in-wp7-web-browser-control)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T16:15:55.430

您将需要编写代码来启用它们。请注意，在 HTML5 Win8 应用程序和 XAML 中都是如此。

对于可以访问 WinRT 的脚本，可以使用 Windows.UI.Popup.MessageDialog：

```
(new Windows.UI.Popup.MessageDialog("Hello!", "Welcome")).showAsync().done(dismissedHandler) 
```

请注意，这些是异步的，**不会**阻止执行。

为了从用户那里获取信息——例如用户输入的文本，没有任何标准，您需要为此创建一组新的标记。

# postgresql - 如何在 POSTGIS 中找到最近的点？

> ID：11868353
> 
> 赞同：1
> 
> 时间：2012-08-08T15:50:13.653
> 
> 标签：postgresql, geometry, postgis

表一：

```
 lat | long | the_geom | code | sign 
    13.8433095 | 100.6360357 | 0101000020E61.... | ABC | start_point
    13.7544738 | 100.5459646 | 0101000020E6..... | ABC | end_point
    13.4124215 | 100.6232332 | 0101000020E61.... | DEF | start_point
    13.2423438 | 100.2324426 | 0101000020E6..... | DEF | end_point 
```

表 B：

```
lat | long | the_geom | code    
13.7546285 | 100.5458729 | 0101000020E.... | ABC    
13.7546698 | 100.5458513 | 0101000020E.... | ABC
13.7547107 | 100.5458233 | 0101000020E.... | DEF    
... 
```

我想找到每个点的最近点（开始和结束 pojnt）与表 B 中具有相同代码的每个点进行比较？

解决这个问题的最佳 PostGIS 函数/PostgreSQL 查询是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T17:47:25.800

如果您使用的是最新版本的软件，您可以使用 KNN-GiST 技术快速找到 PostGIS 中某个点的 K 个最近邻。K 的小值是最快的，而 1 与它们一样小，所以这对你来说应该很好。我只将 KNN-GiST 与文本三元组一起使用，但我知道它们也可以与 PostGIS 一起使用——我只是不知道开始使用它的最佳页面。对“postgis knn gist”的网络搜索显示了许多可能的候选人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:31:17.227

经过很长时间的问题，我刚刚找到了“最近邻居”的解决方案 [http://www.bostongis.com/PrinterFriendly.aspx?content_name=postgis_nearest_neighbor_generic](http://www.bostongis.com/PrinterFriendly.aspx?content_name=postgis_nearest_neighbor_generic)

# html - CSS3 IE9点击通过伪元素？

> ID：11868360
> 
> 赞同：4
> 
> 时间：2012-08-08T15:50:30.893
> 
> 标签：html, css, internet-explorer-9, pseudo-element

我设置了以下小提琴，其中包含有关如何使用 CSS3 设置选择框样式的示例。我在 IE9 中遇到问题。和伪元素阻止了它们所在`label:before`的`label:after`下拉箭头的“单击”动作。这在除 IE9 之外的每个浏览器中都可以正常工作。有谁知道如何调整它来工作？我全是耳朵！

[http://jsfiddle.net/CXJTv/](http://jsfiddle.net/CXJTv/)

PS我只对css想法感兴趣。我不希望 JavaScript 成为使其正常工作的必要条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T18:39:49.027

使用不透明度为零的第二个选择：

```
 <!DOCTYPE html>
    <html>
      <head>
        <style>
          #real { position: absolute; clip:rect(2px 51px 19px 2px); z-index:2; }
          #fake { position: absolute; opacity: 0; }

          body > span { display:block; position: relative; width: 64px; height: 21px; background: url(http://www.stackoverflow.com/favicon.ico) right 1px no-repeat; }
        </style>
      </head>
      <span>
        <select id="real">
          <option value="">Alpha</option>
          <option value="">Beta</option>
          <option value="">Charlie</option>
        </select>
        <select id="fake">
          <option value="">Alpha</option>
          <option value="">Beta</option>
          <option value="">Charlie</option>
        </select>
      </span>
    </html>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T10:56:44.330

如果 IE 对您当前的实现有问题，您始终可以使用 Modernizer 或`conditional statements`使 IE 恢复为下拉箭头的内置标准。

这是[一个小提琴](http://jsfiddle.net/danield770/sNwrs/6/)，我使用条件语句只解析一个不是 IE 的浏览器的类。

[在这里，](https://stackoverflow.com/a/13968900/703717)我回答了一个问题，它可能会帮助您使用纯 CSS 为您的选择下拉菜单使用自定义样式。

# mysql - 任何人都可以简化这个mysql select的where条件吗

> ID：11868367
> 
> 赞同：0
> 
> 时间：2012-08-08T15:50:52.700
> 
> 标签：mysql, where, clause, simplification

你好。任何人都可以简化这个mysql select语句的where条件吗？带来结果需要很长时间，或者它要求**SET SQL_BIG_SELECTS=1**。

在下面的查询中：

*邮政编码*包含BH12或**SW10****等值**，

 ***req_area* 包含**Kensington and Chelsea, SW10**等数据，

该*地区具有***肯辛顿和切尔西**等价值观，

*town_area* 具有**West Brompton, Chelsea**等值。

```
select `a`.`user_id` AS `user_id`,`a`.`req_area` AS `req_area`,`a`.`req_area2` AS `req_area2`,`a`.`req_area3` AS `req_area3`,
`a`.`req_property_type` AS `req_property_type`,`a`.`req_bedrooms` AS `req_bedrooms`,`b`.`latitude` AS `latitude`,
`b`.`longitude` AS `longitude`,`b`.`postcode` AS `postcode`
from (`cff_user_property_req_view` `a` join `cff_uk_short_postcodes` `b`) 
where 
(`b`.`postcode` regexp concat("'",TRIM(`a`.`req_area`),'|',TRIM(`a`.`req_area2`),'|',TRIM(`a`.`req_area3`),"'")>=1 or 
`b`.`region` regexp concat("'",TRIM(`a`.`req_area`),'|',TRIM(`a`.`req_area2`),'|',TRIM(`a`.`req_area3`),"'")>=1 or 
`b`.`town_area` regexp concat("'",concat('[[:<:]]',`a`.`req_area`,'[[:>:]]'),'|',concat('[[:<:]]',`a`.`req_area2`,'[[:>:]]'),'|',concat('[[:<:]]',`a`.`req_area3`,'[[:>:]]'),"'")>=1) 
order by `a`.`user_id`; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T14:31:22.227

之所以这么慢，是因为您的代码需要对两个表的整个外积计算三个正则表达式。正则表达式很慢，任何必须遍历整个表才能找到匹配行的东西也很慢。在保留您给出的查询的确切语义的同时，您几乎无能为力。

因此，与其寻求改进该查询的方法，不如描述您想要实现的目标，然后找到一种以更好的方式对其进行建模的方法。全文搜索索引可能会有所帮助。将列拆分为单词并将这些单词存储在额外的表中可能会有所帮助。我不确定是编辑您的问题，还是将这个问题保持原样，并为此提出一个全新的问题是否会更好。

您可能还应该举例说明`req_area`在您期望匹配的情况下应该是什么样子。由于`req_area`字段始终包含在正则表达式中，因此您的示例不会产生匹配项，因为`req_area`“Kensington and Chelsea, SW10”这一长句不包含在您示例中的任何其他值中。[使用sqlfiddle](http://sqlfiddle.com/)提供一些实际示例将使其他人更容易尝试可能的查询，从而提高您收到的答案的质量（因为实际上已经检查了查询）和收到任何答案的机会（因为人们可以继续通过实验得出他们的答案）。**

# javascript - google map api错误：属性错误 ：

> ID：11868368
> 
> 赞同：4
> 
> 时间：2012-08-08T15:50:55.583
> 
> 标签：javascript, google-maps-api-3

我正在尝试在 google maps api 上设置一些航点，但得到以下错误。我知道这与设置对象有关，但我似乎无法正确处理。我也找不到任何关于它的确切文章。

```
Error: Error in property <waypoints>: (Invalid value: Ballybricken, Waterford, Ireland,The Glen, Waterford (Error in element at position 0: (Unknown property <0>))) 
```

我的代码

```
var waypts = ["Ballybricken, Waterford, Ireland", "The Glen, Waterford"];
drawPolyline('Waterford Regional Hospital', 'Hillview, Waterford, Ireland', waypts);

function drawPolyline(source,destination,waypoints){
        // show route between the points
        directionsService = new google.maps.DirectionsService();
        directionsDisplay = new google.maps.DirectionsRenderer(
        {
            suppressMarkers: true,
            suppressInfoWindows: true,
            polylineOptions: { strokeColor: '#000000', strokeOpacity: 0.5 } 
        });
        directionsDisplay.setMap(map);
        var request = {
            origin:source, 
            destination:destination,
            waypoints:waypoints,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };
        directionsService.route(request, function(response, status) 
        {
            if (status == google.maps.DirectionsStatus.OK) 
            {
                directionsDisplay.setDirections(response);

            }
        });

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T21:29:41.147

航路点不是地址或纬度，它是一个由（必需）`location`成员和（可选）`stopover`成员组成的对象，因此您的数组应如下所示：

```
var waypts = [{location:"Ballybricken"},
              {location:"Waterford"},
              {location:"Ireland"},
              {location:"The Glen"},
              {location:"Waterford"}]; 
```

# vb.net - 摆脱 App.exe.config

> ID：11868373
> 
> 赞同：2
> 
> 时间：2012-08-08T15:51:09.137
> 
> 标签：vb.net, sqlite, app-config

我正在开发一个使用 SQLite 的 vb.net 应用程序，因为它是针对 .net 框架的第 2 版编译的，所以我将此行添加到我的配置文件中

```
<startup useLegacyV2RuntimeActivationPolicy="true">
      <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
</startup> 
```

我对该应用程序的最终目标是使其成为独立的，因此除了 exe 之外不是单个文件（该应用程序将为数据库生成一个文件，但我的意思是我希望用户只下载 1 个单个文件）。

而且我注意到，当我构建它时，总是复制配置文件，如果我在没有配置文件的情况下运行应用程序，我会得到未捕获的异常“遗留”错误。

有没有办法在运行时包含该配置？或者可能捕获某种类型的异常以防止该对话框出现并吓到用户（我知道这可能不是最好的方法）

我在 SO 上搜索并发现了其他类似的问题，但我发现的问题都没有找到对我有用的解决方案，所以我很感激你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:53:27.883

虽然[可以在运行时设置旧版运行时策略](http://reedcopsey.com/2011/09/15/setting-uselegacyv2runtimeactivationpolicy-at-runtime/)，但我建议将其部署为安装程序。

> 好吧，应用程序将为数据库生成一个文件，但我的意思是我希望用户只下载 1 个单个文件

他们可以下载您的安装程序，它可以负责正确设置所有内容。在任何情况下都可能需要这样做，因为 SQLite 需要它自己的 DLL 以及您的 .exe 才能在部署中出现。

# google-maps-api-3 - 分页和file_get_contents的cakephp问题

> ID：11868380
> 
> 赞同：0
> 
> 时间：2012-08-08T15:51:37.287
> 
> 标签：google-maps-api-3, google-api, cakephp-2.0

我用 cakephp 为移动应用程序开发后端

我有一个列出城市的函数，我想计算与这个城市的用户的距离，代码是：

```
$origins='origins=casablanca,maroc';
    $destinations='&destinations=';
    $url='http://maps.googleapis.com/maps/api/distancematrix/json?';

    $this->paginate = array(
            'limit' => 10,
            'fields'=>array('cityId','cityFileName','cityName','stateId','stateFileName','stateName',
                'countryCode','countryFileName','countryName','count(id) as num_hotels'),
            'order' => 'num_hotels desc',
            'group' =>array('cityId')

    );
    $hotels = $this->paginate();

    for ($i = 0; $i < count($hotels); ++$i) {

        $destination=($i==0?'':'|');

        $destination.=$hotels[$i]['Hotel']['cityName'].','.$hotels[$i]['Hotel']['countryName'];

        $destinations.=$destination;
    }

    $url.=$origins.$destinations.'&mode=driving&language=fr-FR&sensor=false';

    $json = file_get_contents($url,0,null,null);
    $details = json_decode($json, TRUE);

    for ($i = 0; $i < count($hotels); ++$i) {
        $hotels = Set::insert($hotels, $i.'.Hotel.distance',$details['rows']['0']['elements']['0']['distance']['value']);
    }

    $this->set(compact('hotels'));
    $this -> viewPath = "hotels";
    $this -> render("json/index","json/default"); 
```

问题是当我用第一页（分页）进行测试时，结果很好，但是当我访问其他页面> = 2时，我收到了这个警告，我无法获得距离

错误是：

```
Warning (2): file_get_contents(http://maps.googleapis.com/maps/api/distancematrix/json?origins=casablanca,maroc&destinations=Zagora,Morocco|Meknes,Morocco|Chefchaouen,Morocco|Tinghir,Morocco|M'hamid,Morocco|El Jadida,Morocco|Erfoud,Morocco|Skoura,Morocco|Tetouan,Morocco|Imlil,Morocco&mode=driving&language=fr-FR&sensor=false) [function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request 
```

[APP\Controller\ApiController.php，第 81 行]

> 代码上下文
> 
> $origins = "origins=casablanca,maroc" $destinations = "&destinations=Zagora,Morocco|Meknes,Morocco|Chefchaouen,Morocco|Tinghir,Morocco|M'hamid,Morocco|El Jadida,Morocco|Erfoud,Morocco|Skoura,Morocco |得土安，摩洛哥|伊姆利尔，摩洛哥" $url = " [http://maps.googleapis.com/maps/api/distancematrix/json?origins=casablanca,maroc&destinations=Zagora,Morocco|Meknes,Morocco|Chefchaouen,Morocco|Tinghir ,摩洛哥|M](http://maps.googleapis.com/maps/api/distancematrix/json?origins=casablanca,maroc&destinations=Zagora,Morocco|Meknes,Morocco|Chefchaouen,Morocco|Tinghir,Morocco|M)'hamid,Morocco|El Jadida,Morocco|Erfoud,Morocco|Skoura,Morocco|Tetouan,Morocco|Imlil,Morocco&mode=driving&language=fr-FR&sensor=false" $hotels = array(array("Hotel" => array(),数组（）），数组（“酒店”=>数组（），数组（）），数组（“酒店”=>数组（），数组（）），数组（“酒店”=>数组（），数组（ ) )，数组（“酒店”=> 数组（），数组（）），数组（“酒店”=> 数组（），数组（）），数组（“酒店”=> 数组（），数组（）） ，数组（“酒店”=>数组（），数组（）），数组（“酒店”=>数组（），数组（）），数组（“酒店”=>数组（），数组（）））$ i = 10 $destination = "|伊姆利尔，摩洛哥"$http_response_header = array("HTTP/1.0 400 Bad Request", "Content-Type: text/html; charset=UTF-8", "Content-Length: 925", "Date: Wed, 08 Aug 2012 15:42:格林威治标准时间 43"，"服务器：GFE/2.0")
> 
> file_get_contents - [内部]，行 ?? ApiController::yassine() - APP\Controller\ApiController.php，第 81 行 ReflectionMethod::invokeArgs() - [内部]，行 ?? Controller::invokeAction() - CORE\Cake\Controller\Controller.php，第 473 行 Dispatcher::_invoke() - CORE\Cake\Routing\Dispatcher.php，第 104 行 Dispatcher::dispatch() - CORE\Cake\Routing \Dispatcher.php，第 86 行 [主] - APP\webroot\index.php，第 96 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:03:35.453

您必须更正这条线。

```
$url.="origins=" .  urlencode($origins). "&destinations=" .
      urlencode($destinations)."&mode=driving&language=fr-FR&sensor=false"; 
```

# scala - 用于过滤输入列表的 Scala 多态函数

> ID：11868384
> 
> 赞同：7
> 
> 时间：2012-08-08T15:51:56.243
> 
> 标签：scala, types, monads, either, parametric-polymorphism

## 寻求更优雅的解决方案

我有这段代码，我只是在不需要进行任何错误处理的测试用例中使用它。它的作用是：

*   获取字符串的输入列表
*   使用 DSJSonmapper.parseDSResult 方法解析它们
*   过滤它们并从每个 Either 中提取 Right 值（Left 是一个例外）

代码如下：

```
 def parseDs(ins: List[String]) = {
    def filterResults[U, T](in: List[Either[U, T]]): List[T] = {
      in.filter(y => y.isRight).map(z => z.right.get)
    }
    filterResults(ins.map(x => DSJsonMapper.parseDSResult(x)))
  } 
```

现在，我还没有做很多多态函数，但这很有效。不过我觉得有点丑。有没有人有更好的建议，如何完成同样的事情。

我知道这将归结为个人喜好。但欢迎提出建议。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T16:00:28.753

`collect`正是针对这种情况而设计的：

```
def filterMe[U,T](in: List[Either[U,T]]): List[T] = in.collect{
  case Right(r) => r
} 
```

事实上，它非常擅长这一点，您可能想跳过`def`并且只是

```
ins.map(DSJsonMapper.parseDsResult).collect{ case Right(r) => r } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-08T16:20:40.850

Rex 的答案可能更清楚一些，但这里有一个更短的替代方案，它可以在一个步骤中解析和“过滤”：

```
ins.flatMap(DSJsonMapper.parseDSResult(_).right.toOption) 
```

在这里，我们对每个解析结果进行[正确的投影](http://www.scala-lang.org/api/current/#scala.util.Either%24%24RightProjection)`Option`并将其转换为一个（`None`如果解析失败，`Some(whatever)`否则将是）。由于我们使用`flatMap`的是 ，因此`None`s 不会出现在结果中，并且值会从`Some`s 中提取出来。

# windows - 在没有管理员权限的情况下运行 jar 文件

> ID：11868392
> 
> 赞同：3
> 
> 时间：2012-08-08T15:52:09.757
> 
> 标签：windows, jar, console, admin

我有一个可运行的 jar 文件，我从它开始

```
java -jar myFile.jar 
```

在 Windows 上。一位客户说他在启动应用程序时遇到了问题（这是包装到可执行文件中的这个 jar 文件）。我怀疑它与管理员权限有关。所以我想在没有管理员权限的情况下运行我的 jar 文件以进行测试（因为这样我得到了`System.out/err`对调试有很大帮助的方法）。

我意识到我可以创建一个非管理员帐户并在那里启动应用程序，但**我想知道是否有办法专门从管理员帐户启动一个 jar，这样它就没有管理员权限安慰。**或者：有没有办法从管理员帐户打开一个没有管理员权限的控制台？

客户使用的是Windows XP，所以这是我可以使用的操作系统。（尽管如果您知道 Win7 等较新的 Windows 中的某些内容，如果您也能告诉我，我将不胜感激）。

编辑：澄清：我正在寻找这样的东西

```
java -jar -runWithoutAdminRights myFile.jar 
```

或者

```
start /runWithoutAdminRights java -jar myFile.jar 
```

或从管理员帐户打开非管理员控制台的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-25T15:34:14.323

[Runas 命令](http://technet.microsoft.com/en-us/library/bb490994.aspx)绝对看起来像要走的路。

我相信解决此问题的方法是首先检查您可用的信任级别选项：

`runas /showtrustlevels`

你应该得到如下内容：

```
C:\Windows\system32>runas /showtrustlevels
The following trust levels are available on your system:
0x20000 (Basic User) 
```

然后，您将获取“基本用户”的值并运行类似以下内容来启动 java：

`runas /trustlevel:0x20000 "java -jar myFile.jar"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T16:45:57.453

您可以按照以下步骤操作：

> 1.  以管理员身份登录
> 2.  打开命令行
> 3.  转到 System32 文件夹（cd C:/Windows/System32）
> 4.  执行：runas /user:computer_domain_name\user1 cmd

系统将要求您提供 user1 的密码。之后以 user1 的权限打开一个新的命令行。

我已经尝试过了，它奏效了。

总之，您可以编写一个非常简单的批处理来自动执行步骤 2、3、4，这样当您单击它时，将以另一个用户的权限打开命令行。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T06:37:52.753

编辑注册表是使用管理员自动运行 jar 文件的最佳方式。
如果您已经设置了 java 应用程序，这很容易。

转到注册表中的以下路径：
`HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers`
创建具有以下规范的键（字符串值）：
`ValueName: java path+javaw.exe(example c:\program files\java\jre7\bin\javaw.exe)`
`ValueData: "WINXPSP3 RUNASADMIN"`

现在所有 Jar 文件都运行到 Administrator

# angularjs - Angularjs：输入[文本] ngChange 在值更改时触发

> ID：11868393
> 
> 赞同：92
> 
> 时间：2012-08-08T15:52:11.343
> 
> 标签：angularjs

ngChange 在值更改时触发（ngChange 与经典的 onChange 事件不同）。我如何将经典的 onChange 事件与 angularjs 绑定，只有在提交内容时才会触发？

当前绑定：

```
<input type="text" ng-model="name" ng-change="update()" /> 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-08-08T17:55:14.300

[这篇文章](https://groups.google.com/d/msg/angular/LH0Q1A-qTVo/eyVIjJsFZGcJ)展示了一个指令示例，该指令延迟模型对输入的更改，直到触发[模糊](http://www.w3schools.com/jsref/event_onblur.asp)事件。

[这](http://jsfiddle.net/cn8VF/308/)是一个小提琴，它显示了 ng-change 与新的 ng-model-on-blur 指令一起使用。[请注意，这是对原始 fiddle](http://jsfiddle.net/carpasse/JYTUB/3/)的轻微调整。

如果将指令添加到代码中，您会将绑定更改为：

```
<input type="text" ng-model="name" ng-model-onblur ng-change="update()" /> 
```

这是指令：

```
// override the default input to update on blur
angular.module('app', []).directive('ngModelOnblur', function() {
    return {
        restrict: 'A',
        require: 'ngModel',
        priority: 1, // needed for angular 1.2.x
        link: function(scope, elm, attr, ngModelCtrl) {
            if (attr.type === 'radio' || attr.type === 'checkbox') return;

            elm.unbind('input').unbind('keydown').unbind('change');
            elm.bind('blur', function() {
                scope.$apply(function() {
                    ngModelCtrl.$setViewValue(elm.val());
                });         
            });
        }
    };
}); 
```

* * *

**注意：正如@wjin 在下面的评论中提到的那样，Angular 1.3（目前处于测试阶段）通过`ngModelOptions`. 有关更多信息，请参阅[文档](https://docs.angularjs.org/api/ng/directive/ngModelOptions)。**

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-04-13T16:59:54.460

*这是关于 AngularJS 的最新添加，作为未来的答案（也适用于[另一个问题](https://stackoverflow.com/a/23045547/340290)）。*

Angular 较新的版本（现在是 1.3 beta），AngularJS 原生支持这个选项，使用`ngModelOptions`, 像

```
ng-model-options="{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }" 
```

[NgModelOptions 文档](http://docs.angularjs.org/api/ng/directive/ngModelOptions)

例子：

```
<input type="text" name="username"
       ng-model="user.name"
       ng-model-options="{updateOn: 'default blur', debounce: {default: 500, blur: 0} }" /> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-20T03:47:06.107

如果其他人在寻找额外的“输入”按键支持，这里是[Gloppy](https://stackoverflow.com/users/1207991/gloopy)提供的[小提琴的更新](http://jsfiddle.net/stiucsib86/8eGm7/1/)

按键绑定代码：

```
elm.bind("keydown keypress", function(event) {
    if (event.which === 13) {
        scope.$apply(function() {
            ngModelCtrl.$setViewValue(elm.val());
        });
    }
}); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-02T04:29:05.020

对于任何在 IE8 上苦苦挣扎的人（它不喜欢 unbind('input')，我找到了解决方法。

将 $sniffer 注入您的指令并使用：

```
if($sniffer.hasEvent('input')){
    elm.unbind('input');
} 
```

如果你这样做，IE8 会平静下来 :)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-03-13T12:15:30.633

据我所知，我们应该使用带有选择选项的 ng-change，在文本框的情况下我们应该使用 ng-blur。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-01-14T09:58:49.763

使用 $scope.$watch 不是更好地反映作用域变量的变化吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-25T11:49:15.340

> 覆盖默认输入 onChange 行为（仅在控制丢失焦点和值发生更改时调用该函数）
> 
> 注意：ngChange 与经典的 onChange 事件不同，它在值发生变化时触发事件 该指令在获得焦点时存储元素的值
> On blurs 它检查新值是否已更改，如果是，则触发事件
> 
> @param {String} - 触发“onChange”时要调用的函数名
> 
> @example < 输入 my-on-change="myFunc" ng-model="model">

```
angular.module('app', []).directive('myOnChange', function () { 
    return {
        restrict: 'A',
        require: 'ngModel',
        scope: {
            myOnChange: '='
        },
        link: function (scope, elm, attr) {
            if (attr.type === 'radio' || attr.type === 'checkbox') {
                return;
            }
            // store value when get focus
            elm.bind('focus', function () {
                scope.value = elm.val();

            });

            // execute the event when loose focus and value was change
            elm.bind('blur', function () {
                var currentValue = elm.val();
                if (scope.value !== currentValue) {
                    if (scope.myOnChange) {
                        scope.myOnChange();
                    }
                }
            });
        }
    };
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-22T16:16:04.027

我遇到了完全相同的问题，这对我有用。添加`ng-model-update`和`ng-keyup`，您就可以开始了！这是[文档](https://docs.angularjs.org/api/ng/directive/ngModelOptions)

```
 <input type="text" name="userName"
         ng-model="user.name"
         ng-change="update()"
         ng-model-options="{ updateOn: 'blur' }"
         ng-keyup="cancel($event)" /> 
```

# game-center - Apple Game Center 究竟可以重新换肤什么？

> ID：11868394
> 
> 赞同：0
> 
> 时间：2012-08-08T15:52:16.477
> 
> 标签：game-center

我在这里的其他地方读到，可以重新设计 Apple Game Center 的皮肤吗？关于那个的几个问题..

1) 你究竟能重新换肤什么？所有的？还是只是一些部分？

2) 为游戏中心的 GUI 重新皮肤是明智的，还是比它的价值更麻烦？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:00:15.110

你可以皮肤排行榜 - 成就 - 回合制游戏

你不能皮肤：登录屏幕 -`GKMatchMakerView`或者`GKTurnBasedMatchMakerView`（如果你接受不使用邀请功能，实际上你可以）

# javascript - jQuery：click() 执行而不是绑定

> ID：11868397
> 
> 赞同：0
> 
> 时间：2012-08-08T15:52:33.217
> 
> 标签：javascript, jquery, click

我正在尝试将单击事件绑定到函数；这发生在 REST 获取请求中：

```
$.get(Constants.webServices.rest.get.pointings(),params,function(data){
    var json = eval(data);
    for(var i=0; i<json.length;i++){
        [...]
        $('a').click(__applyPointing(json[i],originalParams))
        [...]
    }
} 
```

但这段代码不是简单地绑定，而是执行函数，目前是：

```
__applyPointing: function(item,originalParams){
    console.log('applyPointing');
    console.log(item);
} 
```

我还尝试了 bind('click') 和 on('click')，结果相同。我的 js 调试器似乎对异步请求毫无用处。请指教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T15:54:11.210

尝试改变

```
$(a).click(__applyPointing(json[i],originalParams)) 
```

在

```
(function(i) {
    $(a).click(function() { __applyPointing(json[i],originalParams) })
}(i)) 
```

将绑定包装到闭包中很有用，因此`json[i]`可以正确传递

编辑：请注意你写`$(a)`的，也许你可能想写`$('a')`

# flexigrid - flexigrid 获取选定的行列值

> ID：11868404
> 
> 赞同：4
> 
> 时间：2012-08-08T15:52:51.793
> 
> 标签：flexigrid

我是 flexigrid 的新手。任何人都可以让我知道如何获取所选行的每列值。？

如何获取每个列名（reportName 和 reportDescription）？因为我将//所有数据推入数组，如下所述。

我正在使用下面的代码来获取选定的行。但它返回null。你能帮助我吗？

```
//Column. <br/>

colModel: [
  { display: 'WidgetID', name: 'WidgetID', width: 50, sortable: true, align: 'left', hide: true },
  { display: 'Widget Name', name: 'WidgetName', width: 170, sortable: true, align: 'left' },
  { display: 'IsClientReport', name: 'IsClientReport', width: 50, sortable: false, align: 'left', hide: true },
  { display: 'ClientReportID', name: 'ClientReportID', width: 50, sortable: false, align: 'left', hide: true },
  { display: 'ReportType', name: 'ReportType', width: 280, sortable: true, align: 'left' }
],

$('#grid01').click(function(event){ 
  $('.trSelected', this).each( function(){ 
      console.log( ' rowId: ' + $(this).attr('id').substr(3) + ' IsClientReport: ' + $('td[abbr="IsClientReport"] >div', this).html() + ' sign: ' + $('td[abbr="WidgetID"] >div', this).html() + ' ReportType: ' + $('td[abbr="ReportType"] >div', this).html() ); 
  }); 
}); 
```

谢谢，庞库马尔潘迪安

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T03:09:28.137

不确定您是否已经弄清楚了，但是我将把这个答案留在这里，以防其他处于相同情况的人像我一样偶然发现您的问题。

在列上设置 'sortable: false' 会从 Flexigrid 生成的 'td' 中删除 'abbr' 属性。这意味着您不能使用推荐的解决方案来获取选定的行。

我自己修改了 flexigrid.js 文件来解决这个问题。

Flexigrid 以前仅在列具有“名称”并且具有“可排序：真”时才添加“缩写”属性。我删除了“可排序：真”的条件。

反过来，这也意味着列将*始终*是可排序的。为了防止这种情况，我添加了一个“可排序”属性，该属性仅在列是“可排序：真”时设置

之后，我必须检查所有使用“abbr”作为排序条件的情况，并将其替换为“可排序”检查。

而已。

如果您只想下载和使用这个文件，我[会将文件上传到 mediafire 。](http://www.mediafire.com/?rdpigz92rouhe6v)非特定位置的更改太多，我无法在此处显示我对代码的更改。如果需要，我可以提供差异或更多解释。请注意，'sortable: true' 仍然适用于我的修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-20T13:50:35.710

我有同样的问题，并通过使用以下代码解决了它

```
 jQuery('#schoolist .trSelected').each( function(){
                alert(jQuery('[abbr="name"]',this).text());

            }); 
```

只需将其添加到函数中，并将 id #schoolist 和 abbr 名称替换为您需要的列的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T23:29:24.493

请参阅此处的 FlexiGrid 常见问题解答： [http ://code.google.com/p/flexigrid/wiki/FAQ#Get_selected_row](http://code.google.com/p/flexigrid/wiki/FAQ#Get_selected_row)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T00:42:53.413

你可以试试：

```
$('#grid01').click(function(event){
    $('.trSelected', this).each( function(){
        console.log(
            '  rowId: '  + $(this).attr('id').substr(3) +
            '  name: '   + $('td[abbr="name"] >div', this).html() +
            '  sign: '   + $('td[abbr="sign"] >div', this).html() +
            '  status: ' + $('td[abbr="status"] >div', this).html() 
        );
    });
}); 
```

或者

将 flexgrid 与 CI 一起使用，然后在您的自定义按钮事件中添加以下代码

```
function test(com, grid) {  
    if (com == 'Export') {
        var data = ($('.bDiv', grid).html());
        $('.bDiv tbody tr', grid).each(function () {
            console.log('  rowId: ' + $(this).attr('id').substr(3) + '  name: ' + $('td[abbr="name"] >div', this).html() + '  coupon_no: ' + $('td[abbr="coupon_no"] >div', this).html() + '  status: ' + $('td[abbr="status"] >div', this).html());
        });
    }   
} 
```

PHP CI 代码：

```
$buttons[] = array('Export','excel','test'); 
```

检查屏幕：

![在此处输入图像描述](../Images/8ba78e82c2fdbc00664297e4d0ed4b83.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-29T15:50:57.647

将以下函数添加到 flexigrid.js 源将返回一个选定行的数组。

```
$.fn.selectedRows = function (p) {
    var arReturn = [];
    var arRow = [];
    var selector = $(this.selector + ' .trSelected');
    $(selector).each(function (i, row) {
        arRow = [];
        $.each(row.cells, function (c, cell) {
            var col = cell.abbr;
            var val = cell.innerText;
            var idx = cell.cellIndex;

            arRow.push(
                {
                    Column: col,
                    Value: val,
                    CellIndex: idx
                }
                );
        });
        arReturn.push(arRow);

    });
    return arReturn;
}; 
```

**用法：**

```
var rows = $('#datagrid').selectedRows(); 
```

**按列名查找值**

```
function getColValueByName(cols, colName) {
   var retVal = '';
   var param = $.grep(cols, function (e) {
    var found = e.Column == colName;
    if (found != null && found != undefined & found) {
        retVal = e.Value;
    }
});
   return retVal;
} 
```

# html - 使用画布缩小大图像。平滑

> ID：11868405
> 
> 赞同：3
> 
> 时间：2012-08-08T15:52:54.243
> 
> 标签：html, canvas, scaling, drawimage, smoothing

当我使用`canvas`and`drawImage`方法缩小大图像时，结果远非完美。

比较这些图像。左边的实际上是带有缩放图像的画布，右边是理想的结果。此图片的原件是 1600x900 照片。比例从原始大小变为 200x113。

当原始图像的宽度和高度较小或缩放比例较大（即 0.5 - 0.9）时，一切正常。但我需要让我的用户能够调整大图像的大小并制作漂亮的缩略图。

我尝试使用多个小步骤（例如 1600px -> 1000px -> 500px -> 200px）缩放图像，结果更好，但对性能非常不利，所以我拒绝了。

如果现在使用 HTML5 和画布实现我的目标是不可能的，那么将来有可能吗？我只是在想我是否应该拒绝 HTML5 技术并在 ActionScript 上进行上传，还是继续尝试（或等待）使用 HTML5 来做到这一点？我喜欢 HTML5，实际上我不想离开这种友好的技术。

![具有缩放图像（左）和理想结果的画布](../Images/1392def14853acd95d73d7f85eb2ee68.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:43:10.030

使用更原始的重新采样或插值形式缩小了左侧图像。这可能完全是由于浏览器的渲染引擎如何缩放图像，结果因浏览器而异。

如果可以选择，您可以完全控制生成的图像质量的一种方法是上传图像，在服务器上对其进行缩放，然后将其下载回客户端。

另一种方法是使用 JS 库在客户端重新采样图像。不确定这有多实用。

# html - 为什么这些 div 之间有垂直空间？

> ID：11868408
> 
> 赞同：4
> 
> 时间：2012-08-08T15:53:00.633
> 
> 标签：html, css

这似乎是一个普遍的问题。我已经查看了 5 或 6 个其他 SO 问题，但似乎没有一个完全适合这种情况，也没有适合我的解决方案。我什至不确定我现在是否关心“如何解决它”作为“为什么会发生”。客气点，HTML 不是我的专长。

我有这个 HTML/CSS：

```
<!DOCTYPE html>
<html>
    <head>
        <style type="text/css">
            body {
                background: #336699;
            }

            .postContainer {
                margin-left: 40px;
                background: white;
                width: 555px; /* 480px + 75 for bg */
            }

            .postTop {
                background: red;
                height: 75px;
                padding-left: 80px;
            }

            .postMiddle {
                background: yellow;
                padding-left: 80px;
            }

            .postBottom {
                background: red;
                height: 75px;
                padding-left: 80px;
            }
        </style>
    </head>
    <body>
    <div class="postColumn">
        <div class="postContainer">
            <div class="postTop">
                <p>asdf</p>
            </div>
            <div class="postMiddle">
                <p>asdf</p>
            </div>
            <div class="postBottom">                
                <p>asdf</p>
            </div>
        </div>
    </div>
    </body>
</html> 
```

我已经把它剥离了很多；目标是让博客文章的图像具有顶部、中间部分和左下方的拉伸部分。所以顶部区域将有一小段文本，中间区域是任意数量，底部区域是一行文本。但是由于 div 之间有一些空间，所以图像没有对齐。

我检查了 Firebug 和 Chrome 的开发工具的边距；两者都声称没有边距，也没有填充。我已经明确设置了边距，没有任何改变。有些问题建议更改行高；我试过了，它只是让文本变得不稳定而没有修复差距。我试过改变高度。一些帖子说 div 的内容会影响父级边距，但改变那些也没有做任何事情。很多帖子都说，“使用重置文件！” 我有点理解那是什么，但我想在随机应用它之前知道它为什么会起作用。那么插入这个空间的巫毒诅咒是什么，我该如何打破它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T15:57:06.453

添加`p { margin: 0; padding: 0; }`到您的样式或使用[重置的 CSS 文件](http://meyerweb.com/eric/tools/css/reset/)，这将阻止此类事情在未来发生，并让您更好地控制您的样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:57:14.180

标签有`p`顶部和底部边距，删除边距，空间就会消失。

# ios - 如何在iOS的循环中为多个图表赋值

> ID：11868410
> 
> 赞同：0
> 
> 时间：2012-08-08T15:53:07.163
> 
> 标签：ios, loops

我有一个创建不同图形（视图）的循环

```
 for (int i = 0; i < numberOfGraphs; i++) {

    GraphView *graph = [[GraphView alloc] initWithFrame:CGRectMake(xOrigin, 30, 180, 160)];

// graph.value = value;

    [self.view addSubview:graph];

    } 
```

每个图表应该有不同的值..这些值可以每秒更新..我该怎么做？

如果我使用计时器并调用上面的函数，那么它会继续绘制图形..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:06:51.073

您可以尝试在循环过程中将图形添加到 NSMutableArray 中，以便在初始化后掌握每个图形。

如果您需要帮助实时更新它们，请查看 Apple 的[AccelerometerGraph 示例代码中的 GraphView.m 文件](http://developer.apple.com/library/ios/#samplecode/AccelerometerGraph/Introduction/Intro.html)

# sql-server-2008 - 为什么 T-SQL 允许 NULL 和 'NULL'

> ID：11868413
> 
> 赞同：0
> 
> 时间：2012-08-08T15:53:16.997
> 
> 标签：sql-server-2008, tsql

当我运行以下查询时：

```
select top 5 * from  BI_Completes (nolock)where IPAddress <> NULL 
```

我得到 0 个结果。

但是如果我运行它

```
select top 5 * from  BI_Completes (nolock)where IPAddress <> 'NULL' 
```

然后它按预期工作..

这些有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T15:56:16.197

您不能将比较运算符与 NULL 一起使用，因为 NULL 不能与自身进行比较。
您必须改用 IS 运算符：

```
select top 5 * 
from  BI_Completes (nolock)
where IPAddress IS NOT NULL 
```

第二条语句检查 IPAddress 不等于字符序列“NULL”的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T15:56:47.570

第一个片段是不正确的。NULL <> NULL 总是假的，因为根据定义，NULL 永远不会等于它自己：你不知道它是否等于它自己，所以比较*实际上*是假的。第二个片段使用了一个恰好与您的任何数据都不匹配的字符串文字。

您应该使用的正确代码如下所示：

```
select top 5 * from  BI_Completes (nolock)where IPAddress IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T15:57:29.067

查看[这篇](http://msdn.microsoft.com/en-US/library/ms191270%28v=sql.105%29.aspx)MSDN 文章，讨论与`NULL`.

在您的情况下，您似乎得到了 的结果`UNKNOWN`，这就是为什么没有返回任何内容的原因。可能您已`ANSI_NULLS`设置为`ON`，这将导致`UNKNOWN`返回值。此外，您在第二个示例中比较的“NULL”是字符串比较。

Andrea 或 Joel 关于处理 NULL 的正确方法的答案是正确的（使用`IS NOT NULL`而不是检查是否相等）。

# scala - 无法将元素添加到 Play 会话

> ID：11868414
> 
> 赞同：2
> 
> 时间：2012-08-08T15:53:22.313
> 
> 标签：scala, playframework, playframework-2.0

我正在尝试向播放会话添加一个简单的字符串，但它不起作用。为了测试，我编写了一个小控制器函数，首先将一个字符串添加到会话中，然后打印会话包含的所有元素，但它始终为空。

```
def foo = Action { request =>
  request.session + ("token", "foobar")
  request.session.data.foreach{ keyVal => println("\tkey value pair: " + keyVal._1 + ", " + keyVal._2)}
  Ok("just a test")
} 
```

我做错了什么？我是否需要通过 application.conf 或其他方式激活某些内容？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T19:15:23.320

实际上，会话也是一个不可变的结构。

确实，`session`存储在`request`其中的对象有一个`+`方法，后者通过返回一个新的实例来尊重不变性范式`Session`。保持`request.session`不变。

进一步思考，我们可以断言更新的会话只有在另一个请求-响应事务中重用时才有意义......

因此，更新会话的方法是在构建响应（`Result`在 Play 中）时更新它，如下所示：

```
Ok("just a test").withSession(request.session + ("token", "foobar")) 
```

这将在您的 cookie 中添加新的会话字段，该字段将在下一个事务中可用（即请求-响应）。

# iphone - Xcode - 团队开发

> ID：11868420
> 
> 赞同：3
> 
> 时间：2012-08-08T15:53:48.960
> 
> 标签：iphone, ios, xcode

亲爱的程序员，

最近我和我的伙伴为 AppStore开发了一个[应用程序。](http://itunes.apple.com/ca/app/crunch-all-in-one-calculator/id532793873?mt=8&ign-mpt=uo%3D2)这是我们的第一个 iPhone 应用程序，它做得很好。

**但**它做得不是很专业（我们中的一个人拥有项目的主版本，然后另一个人只发送一个计算器的代码，另一个人必须手动添加它）。我们必须这样做，因为我们有不同版本的 XCode。

但是现在我们都拥有最新版本的 XCode，并且想知道是否有一种简单的方法可以作为一个团队进行开发。

基本上，我们正在寻找一种既可以访问主项目，又可以将其更新到最新版本的方法。

*   我们将如何做到这一点？
*   如果我们同时工作呢？
*   任何其他提示将不胜感激！

感谢您的宝贵时间，如果您需要任何其他信息，我很乐意提供！

凯迪安爵士

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:58:25.820

您正在寻找版本控制系统。从本质上讲，这是一个软件，你们两个都可以从中签出一个工作副本，你可以用它做任何你想做的事情......一旦你完成了，你检查你的更改，然后系统合并一起改变。

这样，您可以同时处理不同方面的工作，双方都可以自由地独立开发，而不必担心手动实现。

相当知名的版本控制软件包括“Subversion”、“Mercurial”或“Git”。大多数 VCS 都有图形前端，这将使您无需学习困难的命令行命令就可以应付自如。

但请记住，系统不会“为您考虑”，因此当您在同一文件、同一地点工作时，会引发冲突，您必须手动解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:10:02.253

您可以将[git](http://git-scm.com)或[svn](http://subversion.apache.org)与 Xcode 源代码控制功能一起使用。

**您可以在File > Source Control**菜单下找到所有基本命令，例如提交、更新、合并、推送、拉取等。

您可以从同一个菜单管理您的存储库。

您可以使用版本编辑器查看所有修订： **查看 > 版本编辑器 > 显示版本编辑器**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T16:00:34.940

首先是使用您最喜欢的源代码管理系统 (scm) 设置存储库。最常见的是 subversion 和 git，而 git 似乎更受欢迎，但学习起来有点复杂。

Xcode 为这两种 scm 提供了内置支持，但我建议使用控制台（您会学到很多东西）或专用应用程序（您拥有比 Xcode 更多的功能，并且具有良好的 GUI）。

[git scm](http://git-scm.com)
[颠覆](http://subversion.apache.org)

下一步是建立一个问题跟踪系统来跟踪您、您的用户或其他测试人员发现的错误。您还可以描述您计划的新功能或架构更改。常见的系统是 trac、Jira 或关键跟踪器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T15:57:20.273

你必须设置一个颠覆。这样，您就可以将代码提交到始终具有最新版本的存储库。

[http://osxdaily.com/2010/06/03/configuring-xcode-to-use-subversion/](http://osxdaily.com/2010/06/03/configuring-xcode-to-use-subversion/)

[在 Xcode 中使用 Subversion](https://stackoverflow.com/questions/1551886/using-subversion-in-xcode)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T16:00:05.993

你是否碰巧有任何类型的源代码控制，因为它听起来不像你做的？

我会考虑开始[熟悉](http://git-scm.com/book)诸如 Git 之类的修订控制系统并将您的项目托管在[GitHub](http://www.github.com)之类的网站上，这样你们两个就可以在您的项目上进行协作。有一点学习曲线，但是一旦你克服了障碍，你永远不会明白没有它你是如何生活的。

# django - 如何在 Django 模板中将所有变量标记为安全？

> ID：11868421
> 
> 赞同：2
> 
> 时间：2012-08-08T15:53:53.217
> 
> 标签：django, django-templates

我有很多由网站管理员生成的内容；我最终将“|safe}}”添加到几乎每个模板变量中。这很烦人。

我可以自动将每个变量标记为安全，而是在必要时选择使用转义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:56:03.480

可以通过使用 Django 模板的自动[转义](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#autoescape)来确定块内的自动转义。

如如何在[Django 书第 9 章中将](http://www.djangobook.com/en/2.0/chapter09/)*其关闭部分中所述（在**Automatic HTML Escaping*部分中查找文本）：

 *> 如果您不希望在每个站点、每个模板级别或每个变量级别上自动转义数据，您可以通过多种方式将其关闭。

这种针对每个站点的方法是拥有一个*基本*模板（所有模板继承自的模板），它简单地指定`{% autoescape off %}`为所有上下文块的顶部和`{% endautoescape %}`末尾：

> 自动转义标签将其效果传递给扩展当前标签的模板以及通过`include`标签包含的模板，就像所有块标签一样。

正如@ChrisPratt 评论的那样：

> 绝不允许从自动转义中排除用户提交的内容。*

# android - AlertDialog 并带有列表项和自定义主题

> ID：11868424
> 
> 赞同：1
> 
> 时间：2012-08-08T15:54:00.123
> 
> 标签：android, android-layout, android-dialog

我找不到解决方案！我正在尝试兼容 Android 2.1 及更高版本。

我尝试使用自定义主题创建与 AlertDialog 等效的内容。

我发现在 API v. 11 之前无法在 AlertDialog 上应用主题。我尝试使用 ContextThemeWrapper，但找不到自定义按钮的解决方案。

对于一个简单的视图，我使用自己的内容视图创建自己的 Dialog。我对主题做我想做的事。

但是，当我想要一个带有自定义主题和列表项的 AlertDialog 时，它就更复杂了。我找不到在列表末尾添加按钮的解决方案。因为当列表太大时，按钮在窗口之外。

我试过： - 一个相对布局：* 标题 * 标题下方的列表视图 * 列表视图下方的按钮 - 垂直线性布局

有人有想法吗？

我添加了[需要的结果](http://i.stack.imgur.com/UOH9R.png)。

也许，我的最后一个也是非常丑陋的想法是使用构建器创建一个普通的 AlertDialog，使用 findViewById 找到每个视图并应用所需的主题属性......但我必须查看自 Android 2.1 以来 id 是否为常量......

我的布局 xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:bw="http://schemas.android.com/apk/res-auto/com.levelup.beautifulwidgets"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_marginBottom="8dp"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:background="@drawable/ab_background"
        android:paddingBottom="8dp"
        android:paddingTop="8dp"
        android:textColor="@color/grey_1"
        android:textSize="24dp" />

    <FrameLayout
        android:id="@+id/title_container"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginTop="5dp"
        android:paddingRight="10dp" />

    <ListView
        android:id="@+id/container"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/title" />

    <LinearLayout
        android:id="@+id/buttons"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@id/container"
        android:layout_marginTop="5dp"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/cancel_button"
            style="@style/DialogButton"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="-1dp"
            android:layout_weight="1"
            android:text="@string/cancel" />

        <Button
            android:id="@+id/ok_button"
            style="@style/DialogButton"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/ok" />
    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T10:10:47.380

我找到了解决方案。我是一个垂直的线性布局。所有视图的 layout_weight 为 0。只是 ListView 为 1。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <RelativeLayout
        android:id="@+id/titleLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0"
        android:padding="5dp" >

        <FrameLayout
            android:id="@+id/title_container"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"
            android:paddingRight="10dp" />

        <TextView
            android:id="@+id/title"
            style="@style/Dialog.Title"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_toLeftOf="@id/title_container" />
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/containerLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" >

        <FrameLayout
            android:id="@+id/container"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

        <ImageView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="5dp"
            android:background="@drawable/dialog_header_divider" />
    </RelativeLayout>

    <View
        android:layout_width="fill_parent"
        android:layout_height="1dp"
        android:layout_weight="0"
        android:background="@color/grey_2" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/cancel_button"
            style="@style/Dialog.Button.Cancel"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="-1dp"
            android:layout_weight="1"
            android:text="@string/cancel" />

        <View
            android:id="@+id/buttonSeparator"
            android:layout_width="1dp"
            android:layout_height="fill_parent"
            android:layout_weight="0"
            android:background="@color/grey_2" />

        <Button
            android:id="@+id/ok_button"
            style="@style/Dialog.Button.Ok"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/ok" />
    </LinearLayout>

</LinearLayout> 
```

# mongodb - 更新 Mongo DB 文档的单个列表项

> ID：11868426
> 
> 赞同：2
> 
> 时间：2012-08-08T15:54:14.277
> 
> 标签：mongodb

我在 mongodb 集合中有以下文档结构：

```
{ _id: XXX, Name: "Example", References: [ { RefId: YYY, RefCount: 2 }, ...] } 
```

令我困惑的是，如何编写一个 update() 操作，该操作将引用 Id (RefId) 中的一个恰好递增一。需要更新其引用的文档将由其 _id 字段标识。

我知道替换整个文档的可能性，但如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:00:49.057

使用您的位置`$` [运算符](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator)`update`来标识您的查询参数匹配的数组中的元素。

所以像：

```
t.update({_id: XXX, 'References.RefId': YYY}, {$inc: {'References.$.RefCount': 1}}); 
```

# shell - 使用 linux 命令行工具进行缩进

> ID：11868430
> 
> 赞同：2
> 
> 时间：2012-08-08T15:54:37.897
> 
> 标签：shell, echo

我目前正在编写一个具有以下代码的 linux 脚本：

```
echo "\nCompiled on:\n `gcc --version`\n" 
```

输出格式如下：

```
编译于：
gcc (GCC) 3.4.4 等...
这是免费软件...

```

但是我希望命令的格式如下：

```
编译于：
    gcc(GCC) 3.4.4 等...
    这是免费软件...

```

如何格式化文本，以便从`gcc --version`命令输出的每条 LINE 都有自己的选项卡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T15:57:12.680

怎么样：

```
echo "\nCompiled on:\n $(gcc --version | sed 's/^/\t/g' )\n" 
```

的输出通过`gcc --version`管道传输到`sed`，它在行首添加了一个制表符。

或者，您可以使用 awk （如果您不需要额外的换行符，可能会更短）：

```
gcc --version | awk 'BEGIN { print "\nCompiled on:" } { print "\t" $0 } END { printf RS }' 
```

# android-emulator - 用于插入事件的日历应用程序中的错误

> ID：11868433
> 
> 赞同：1
> 
> 时间：2012-08-08T15:55:01.557
> 
> 标签：android-emulator

```
String[] projection = new String[] { "_id", "name" };
Log.d("projection",""+projection);
Uri calendars = Uri.parse("content://com.android.calendar/calendars");
Cursor managedCursor =
    managedQuery(calendars, projection, null, null, null);

if (managedCursor.moveToFirst()) {
    /* String calName; 
    String calId;*/ 
    int nameColumn = managedCursor.getColumnIndex("name");
    Log.d("nameColumn",""+projection);
    int idColumn = managedCursor.getColumnIndex("_id");
    do {
        calName = managedCursor.getString(nameColumn);
        Log.d("name",""+calName);
        calId = managedCursor.getString(idColumn);
        Log.d("calId",""+calId);
    } while (managedCursor.moveToNext());
}
try{
    ContentValues event = new ContentValues();
    event.put("calendar_id", calId);
    Log.d("calId",""+calId);
    event.put("title", "Event Title");
    event.put("description", "Event Desc");
    event.put("eventLocation", "Event Location");
    Calendar c = Calendar.getInstance();
    long date = c.getTimeInMillis();
    Log.d("date",""+date);
    event.put("dtstart", date);
    Log.d("date",""+date);
    event.put("dtend", date);
    Log.d("date",""+date);
    event.put("allDay", 1); 
    event.put("eventStatus", 1);
    event.put("visibility", 0);
    event.put("transparency", 0);
    event.put("hasAlarm", 1);
    Uri eventsUri = Uri.parse("content://com.android.calendar/events");
    Log.d("eventsUri",""+eventsUri);
    Uri url = getContentResolver().insert(eventsUri, event);
} catch ( IllegalArgumentException e){
    System.out.println(e.getMessage());
} 
```

导致错误：

```
java.lang.IllegalArgumentException: Event values must include an event Timezone 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T12:32:53.020

我有同样的问题

尝试使用此名称作为列名，而不是**`timezone`**

```
values.put("eventTimezone", TimeZone.getDefault().getID()); 
```

许多列名随着不同的操作系统版本而变化，请查看这篇文章

[https://groups.google.com/forum/?fromgroups=#!topic/rhomobile/7VyEMeZNSWI](https://groups.google.com/forum/?fromgroups=#!topic/rhomobile/7VyEMeZNSWI)

# sql - sql是否有命令检查行是否为零？

> ID：11868435
> 
> 赞同：0
> 
> 时间：2012-08-08T15:55:06.857
> 
> 标签：sql, database, tsql

我需要检查一行是否为零。对于空值，我通常使用 isnull() 但我的行永远不会为空。如果有这样的命令，我会这样使用它：

```
select * from maintable where column1 = iszero(@param,column1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:08:12.353

假设您正在寻找与`IsNull()`定义自己的功能相同的工作方式

```
create function IsZero(@value int, @default int)
    returns int
as
begin

    if (@value <> 0)
        return @value

    return @default
end 
```

使用示例

```
select 
    Returns5 = dbo.Iszero(5, 10),
    Returns10 = dbo.Iszero(0, 10) 
```

或者在你的情况下

```
select * from maintable where column1 = IsZero(@param,column1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:00:13.183

```
SELECT * 
FROM   maintable 
WHERE  column1 = CASE @param 
                     WHEN 0 THEN column1 
                     ELSE @param 
                 END 
```

这将为您`maintable`提供其中`column1`等于`@param`变量的记录。如果`@param`变量为 0，那么它将返回`maintable`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:07:07.650

试试这个：

```
select *
from maintable
where column1 = @param or @param = 0 
```

# asp.net-mvc-3 - 保存来自复杂视图的数据

> ID：11868445
> 
> 赞同：0
> 
> 时间：2012-08-08T15:55:31.070
> 
> 标签：asp.net-mvc-3

我是 MVC 的新手，想确保我了解如何实现我需要构建的复杂视图。

我需要允许用户在一个页面上添加多个机构，每个机构都可以

进行了多次培训。

因此视图模型将是包含培训列表的机构列表。

我将有一个按钮，允许他们添加多个机构和机构内

部分另一个按钮，允许他们添加多个培训。

关于回发方法我是否只是循环遍历模型中的机构，并为每个机构循环遍历其培训列表以将它们保存到数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T23:25:45.653

您可能想改用这样的控制器：

```
public class InstitutionController : Controller
{
    public ViewResult Index()
    {
        return View(); // Keep it simple, load data via JSON instead
    }

    [HttpPost]
    public JsonResult Load()
    {
        // Go get Institutions etc
        return Json(institutions);
    }

    [HttpPost]
    public JsonResult Save(Institutions[] institutions)
    {
        try
        {
            // Save the institutions to the DB
        }
        catch (Exception ex)
        {
            return Json(new { Message = "Error." });
        }
        return Json(null); // Or some other way of saying it worked
    }
} 
```

也就是说，您传递给视图的模型不会被浏览器持久化——而是在服务器生成响应时短暂地存在于服务器内存中。

但是，在上面的示例中，您可以创建一个视图，该视图使用例如 jquery 通过 JSON 从服务器加载模型，然后您可以在页面的整个生命周期内将其保留在浏览器中。当用户对机构或机构进行修改时，您可以使用上述 Save() 之类的方法将新数据或数据更改发送到服务器以保存到数据库中。

# git - 如何使用 git config 删除全局配置中的条目？

> ID：11868447
> 
> 赞同：470
> 
> 时间：2012-08-08T15:55:38.207
> 
> 标签：git

**我在git**中运行了一个全局配置命令，以使用文件排除某些`.gitignore_global`文件：

```
git config --global core.excludesfile ~/.gitignore_global 
```

有没有办法全局撤消此设置的创建？

* * *

## 回答 #1

> 赞同：843
> 
> 时间：2012-08-08T16:08:34.650

我不确定您所说的“撤消”更改是什么意思。您可以像这样删除`core.excludesfile`设置：

```
git config --global --unset core.excludesfile 
```

当然，您可以简单地编辑配置文件：

```
git config --global --edit 
```

...然后手动删除设置。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2018-05-06T16:30:01.520

您可以使用`--unset`标志`git config`来执行此操作，如下所示：

```
git config --global --unset user.name
git config --global --unset user.email 
```

如果一个配置有更多变量，您可以使用：

```
git config --global --unset-all user.name 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2017-04-21T20:45:59.760

打开配置文件进行编辑：

```
git config --global --edit 
```

按下`Insert`并删除设置

最后输入`:wq`并`Enter`保存。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2015-06-15T07:59:27.590

从命令行尝试此操作以更改 git 配置详细信息。

```
git config --global --replace-all user.name "Your New Name"

git config --global --replace-all user.email "Your new email" 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2019-03-13T05:08:10.323

您可以使用检查所有配置设置

```
git config --global --list 
```

您可以删除设置，例如用户名

```
git config --global --unset user.name 
```

您可以使用以下方法手动编辑配置或删除配置设置：

```
git config --global --edit 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2020-12-20T06:20:14.270

尝试使用这些命令删除所有用户的用户名和电子邮件。

```
git config --global --unset-all user.name
git config --global --unset-all user.email 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2021-11-12T13:35:37.527

为了补充 larsk anwser，可以在使用 vim 编辑时使用 dd 命令删除输入行：

```
git config --global --edit 
```

然后：

*   按`Esc`键进入正常模式。
*   将光标放在要删除的行上。
*   键入`dd`并按 Enter 以删除该行。

完成后，键入`ESQ`并`:wq`

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-02-12T04:54:24.270

git 配置信息将存储`~/.gitconfig`在 unix 平台中。

在 Windows 中，它将存储在`C:/users/<NAME>/.gitconfig.`

您可以通过打开此文件并删除您感兴趣的字段来手动编辑它。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2021-08-31T08:04:19.033

如果有人只想`user`完全删除对象，那么他应该使用：

```
git config --global --remove-section user 
```

当用户不小心添加了更多不需要的属性时，这很有用，例如`user.password`等。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-01-30T11:31:34.207

您可以编辑`~/.gitconfig`主文件夹中的文件。这是`--global`保存所有设置的地方。

# c# - 通过将更新的参数传递给同一控制器 MVC 3 再次加载视图

> ID：11868450
> 
> 赞同：1
> 
> 时间：2012-08-08T15:55:43.497
> 
> 标签：c#, asp.net-mvc-3, razor, view, controller

我想通过在链接单击时从文本输入中传递更新的参数来再次加载相同的视图。我尝试使用类似的东西`<a href="@Url.Action("Index", "Home", new {id = "txtCount".value }).` 不确定是否有办法做到这一点。我知道我可以使用部分，但我想用更新的参数重新加载整个页面。提前感谢您的帮助。

控制器

```
[HttpGet]
public ActionResult Index(int id)
{
    return View(id);
} 
```

看法

```
@model int
@using (@Html.BeginForm())
{
    <input id="txtCount" value="1" />
    <a href="@Url.Action("Index", "Home", new { id = 5 @*// get value from txtCount*@ })">Update</a>
        for (int i = 0; i < Model; i++)
        {
            <div>@i </div> 
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:01:46.947

也许是这样的

```
<a href="#" id="mylink">Go!</a> 
```

并与 jquery 绑定

```
$("#mylink").click(function(){
document.location.href = '@Url.Content("~/Controller/Action")' + $("#mytxt").val();
return false;
}); 
```

显然，如果文本框为空以及所有这些内容，则需要进行适当的验证。

您不能将 id 值添加到 ，`@Url.Action`因为它是在服务器端之前处理的，在页面呈现之前

# android - LayoutParams Gravity Right 未强制执行

> ID：11868454
> 
> 赞同：1
> 
> 时间：2012-08-08T15:56:03.490
> 
> 标签：android, android-layout, android-linearlayout, android-view

我正在扩展一个 LinearLayout 来制作一个复合小部件。小部件设置为 layout_width="MATCH_PARENT"。

```
mLabelTextView = new TextView(context);
mLabelTextView.setText("Testing");
LayoutParams labelParams = new
LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT,
        LayoutParams.WRAP_CONTENT, 0.0f);
labelParams.gravity = Gravity.CENTER_VERTICAL;
addView(mLabelTextView, labelParams);

mContentView = new Checkbox(content);
contentParams = new LinearLayout.LayoutParams(0, LayoutParams.WRAP_CONTENT, 1.0f);
contentParams.gravity = Gravity.CENTER_VERTICAL | Gravity.Right;

addView(mContentView, contentParams); 
```

我的问题是 Gravity.Right 属性对 mContentView 生效，但 Gravity.CENTER_VERTICAL 是。我知道 mContentView 被拉伸以填充剩余空间。我已经尝试过让重力=正确，但没有奏效。

我有一个类似的代码路径，在其中我膨胀了一个已经在 XML 中设置了正确重力并且正在工作的视图。所以我一定在某个地方遗漏了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:00:04.777

如果您的父母`LinearLayout`具有水平方向（您没有指定，但我猜），那么它将忽略所有水平布局重力位。同样，如果它具有垂直方向，那么它将忽略该`CENTER_VERTICAL`设置。

一个技巧是包装`mContentView`在一个垂直方向`LinearLayout`，给该包装器的布局权重为 1（这样它会填充剩余的空间），然后包装器将尊重`RIGHT`重力。

更好的选择可能是扩展`RelativeLayout`而不是`LinearLayout`. 这使您可以对重力进行二维控制（与 不同`LinearLayout`）。

# android - 即使应用程序支持 API 3 - 16，用户也无法安装到具有 android 4.0.4 的设备

> ID：11868458
> 
> 赞同：1
> 
> 时间：2012-08-08T15:56:15.160
> 
> 标签：android

我有一个使用 android 4.0.4 的 Motorola XT910 用户报告他无法从 Google Play 商店下载我的应用程序。错误表明设备与当前版本不兼容；但是，我的应用程序支持 API 3 - 16，其中应包括 android 4.0.4。

我目前有 API 16 和 SDK Tools r20，并且从 android 修订历史记录 (http://developer.android.com/tools/revisions/platforms.html) 我可以看到 Android 4.0.4 需要 API 15 修订 3。我无法下载修订版 3，因为它没有显示在 SDK 管理器中，但 API 16 不应该涵盖这一点吗？还是我做出了错误的假设？

我需要下载 API 15 的修订版 3 还是 API 16 涵盖了它？如果需要，我该怎么做才能在 SDK 管理器中显示此特定版本？或者是否可以在不使用 SDK 管理器的情况下在其他地方下载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:16:21.283

问题已根据尼克的上述意见得到解决。该问题是由应用程序的 Play 管理中心中的复制保护设置引起的。要解决此问题，只需将其设置为 OFF 即可解决问题。注意：您可能需要等待几个小时才能使设置更改生效并反映在 Google Play 商店中。

# gwt2 - GWT：从 RequestContext 中删除代理？

> ID：11868459
> 
> 赞同：0
> 
> 时间：2012-08-08T15:56:15.460
> 
> 标签：gwt2, requestfactory

让我们假设以下情况。中有一个集合`Animals`。`Zoo`用户可以添加和/或删除动物`Zoo`，当他准备好时，他可以点击保存发送请求。

我们正在使用以下方法添加新动物：

```
AnimalProxy animal = saveRequest.create(AnimalProxy.class);
animal.setZoo(zoo);
zoo.getAnimals(animal);
... 
```

但是如果用户改变主意并决定在保存之前从动物园中删除他刚刚创建/添加的动物怎么办？

因为这个动物已经被管理了，`saveRequest`我们需要以某种方式解除它的绑定`saveRequest`（这样这个动物就不会被发送到服务器）。但是`RequestContext`接口只提供了向它*添加*代理的方法（`edit()`和`create()`），但没有删除代理的单一方法。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T07:08:09.800

我的问题的解决方案只是接受取消已发送到服务器的事实，`AnimalProxy`但确保它**不会**在服务器端持续存在。目前可能无法删除代理`RequestContext`。

# php - 尽管设置，Eclipse PHP 有时会在数组上输入选项卡

> ID：11868462
> 
> 赞同：1
> 
> 时间：2012-08-08T15:56:29.860
> 
> 标签：php, eclipse, ide, eclipse-pdt

因此，对于 eclipse PHP，我将制表符策略设置为从 window->preferences->PHP-> Code Style -> Formatter 缩进大小为 3 的空格

通常它输入 3 个空格而不是通常的制表符

但有时当我在一个数组中时

```
$php = array(

); 
```

然后我按制表符，它会改为输入制表符...

有没有办法解决这个问题，让它总是显示 3 个空格？

# c# - WindowsForm 上的图像！= TextRenderer.DrawText() 图像

> ID：11868465
> 
> 赞同：10
> 
> 时间：2012-08-08T15:56:38.750
> 
> 标签：c#, .net, winforms, image

正如我在[此处](https://stackoverflow.com/questions/11557513/why-is-it-not-possible-to-save-any-font-as-image-but-to-display-it-on-my-windo)发布的那样，我能够在我的 WindowsForm 上显示一些特殊字体，**但**我无法将此字体另存为图片。问题`Graphic.DrawString()`是无法显示所有或特殊字体。WindowsForm 正在使用`TextRenderer`它的更新版本（添加了 2.0），这就是 WindowsForm 能够显示这些字体的原因。

美好的。现在我坐在这里，尝试做同样的事情`TextRenderer.DrawText()`- 我不得不说我的输出图像现在​​好多了**，但**仍然与 WindowsForm 上的不同。让我们看看我的代码：

```
 Bitmap Bit = new Bitmap(500, 200);
    Graphics g = Graphics.FromImage(Bit);

    string s = "TEST";

    g.Clear(Color.White);
    TextRenderer.DrawText(g, s, new Font("Code 128", 72), new Point(20, 20), Color.Black, Color.White);
    Bit.Save(@"C:\myFolder\test.bmp", System.Drawing.Imaging.ImageFormat.Bmp);
    Bit.Dispose(); 
```

（Code 128 是一种特殊字体，如果您真的想了解更多信息，请点击下面的链接了解更多信息）

所以这是有效的，我得到了我的形象，很好。现在我在同一个 VS 项目中添加具有相同字体的相同字符串作为我的 WindowsForm 上的标签。并且有一些区别。不同之处在于创建的图像`TextRenderer`在第一个位置总是有不同的字符。其他一切都很好！我不明白。让我们看看 WinForm VS Image：

![带有标签的 WindowsForm VS TextRenderer 图像（相同的字符串和字体）](../Images/3ec8aba403b31cdf21c4c08563ad6ddf.png)

正如我们所看到的，第一个“字符”（如果我们可以在这个例子中说“字符”）在某种程度上是不一样的。现在让我将 TextRenderer Image 函数中的字符串更改为“TTEST”。比较 WinForm 上的“TEST”和 TextRenderer Image 上的“TTEST”：

![在此处输入图像描述](../Images/12ece6afb5a8ab8f1cf17be7826f63b2.png)

看起来很有趣吧？所以，`TextRenderer.DrawText()`+ special font = first char 很奇怪。但为什么？以及如何解决这个问题？有什么建议么？谢谢！

编辑：如果有帮助，我可以发布 WindowsForm 的代码

```
partial class Form1
{
    /// <summary>
    /// Required designer variable.
    /// </summary>
    private System.ComponentModel.IContainer components = null;

    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    #region Windows Form Designer generated code

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {
        this.label1 = new System.Windows.Forms.Label();
        this.SuspendLayout();
        // 
        // label1
        // 
        this.label1.AutoSize = true;
        this.label1.Font = new System.Drawing.Font("Code 128", 72F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(2)));
        this.label1.Location = new System.Drawing.Point(30, 41);
        this.label1.Name = "label1";
        this.label1.Size = new System.Drawing.Size(144, 94);
        this.label1.TabIndex = 0;
        this.label1.Text = "TEST";
        this.label1.Click += new System.EventHandler(this.label1_Click);
        // 
        // Form1
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.ClientSize = new System.Drawing.Size(284, 262);
        this.Controls.Add(this.label1);
        this.Name = "Form1";
        this.Text = "Form1";
        this.Load += new System.EventHandler(this.Form1_Load);
        this.ResumeLayout(false);
        this.PerformLayout();

    }

    #endregion

    private System.Windows.Forms.Label label1;
} 
```

正如我们所看到的，它具有相同的字体，具有相同的字符串。我不明白...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:11:40.060

您发布了错误的代码，这是关闭的位图版本。在我看来像 UEST，一个明显的错误。

这不是唯一的问题，即使您解决了这个问题，它仍然不是有效的 Code128 条形码。您还需要开始、检查和停止字符，如此[Wikipedia 文章中所述](http://en.wikipedia.org/wiki/Code_128#Specification)。您可能已经接近不可避免的“购买，不要建造”的结论。找到生成条形码的控件并不困难或昂贵。

# magento - 在magento中生成愿望清单项目的pdf

> ID：11868466
> 
> 赞同：0
> 
> 时间：2012-08-08T15:56:40.687
> 
> 标签：magento, magento-1.7

谁能指导我如何在magento中生成愿望清单项目（产品）的pdf？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T21:12:15.917

将此代码包装在您的自定义控制器中。

```
public function whishlistAction()
{    
    $session = Mage::getSingleton('customer/session', array('name'=>'frontend'));

    if(!$session->isLoggedIn()) 
    {
        $this->_redirect(Mage::getUrl('customer/account'));
    }  

    $customer = Mage::getModel('customer/customer')->load($session->getId());
    $wishList = Mage::getModel('wishlist/wishlist')->loadByCustomer($customer);
    $wishListItemCollection = $wishList->getItemCollection();

    $pdf = new Zend_Pdf(); 

    $pageCount = 0;
    $collectionPreperedForPagesKey=0;
    $collectionPreperedForPages = array(); 

    foreach ($wishListItemCollection as $w)
    {
        $pageCount = $pageCount+1;
        if($pageCount==4)
        { 
            $collectionPreperedForPagesKey=$collectionPreperedForPagesKey+1;
            $pageCount=0;
        } 
        $collectionPreperedForPages[$collectionPreperedForPagesKey][]=$w;
    } 
    foreach ($collectionPreperedForPages as $c)
    {
        $pdf->pages[] = $this->createWhishlistPage($c); 
    }

    $pdfString = $pdf->render();
    header("Content-Disposition: attachment; filename=whishlist.pdf");
    header("Content-type: application/x-pdf");
    echo $pdfString;
    exit;
}

public function getImagePath($product)
{
    $imageUrl = Mage::getModel('catalog/product_media_config')
        ->getMediaUrl( $product->getImage() ); 

    $baseDir =  Mage::getBaseDir() ; 
      $withoutIndex = str_replace('index.php/','', Mage::getBaseUrl());

      $imageWithoutBase = str_replace($withoutIndex,'' , $imageUrl);
       $imagePath = $baseDir.DIRECTORY_SEPARATOR.$imageWithoutBase ;

       return $imagePath;
}

public function getImageSizesWithAspectRatio($widthImage,$heightImage,$widthBox,$heightBox)
{ 
    if (($widthBox >= $widthImage) && ($heightBox >= $heightImage)) 
    {
          return array('width'=>$widthImage,'height'=>$heightImage);
    }  

    $resizeRatio = 1;
    if($widthBox < $widthImage) 
    {
       $resizeRatio = $widthImage/$widthBox; 
       $widthImage = $widthBox;   
    }

     if($heightBox < $heightImage) 
     {
        if($resizeRatio!=1)
        {
            $heightImage = $heightImage/$resizeRatio;
        }

        if($heightImage>$heightBox)
        {
             $resizeRatio = $heightImage/$heightBox;
               $heightImage = $heightBox; 
               $widthImage = $widthImage/$resizeRatio; 
        }
     }   
     return array('width'=>$widthImage,'height'=>$heightImage);
}

public function createWhishlistPage($wishListItemCollection)
{ 
    $lightFont = Zend_Pdf_Font::fontWithPath($this->getFont('light'));
    $regularFont = Zend_Pdf_Font::fontWithPath($this->getFont('regular'));
    $boldFont = Zend_Pdf_Font::fontWithPath($this->getFont('bold')); 

    $page1 = new Oxidian_Pdf_Helper_Page(Zend_Pdf_Page::SIZE_A4);
    $page1->setFillColor(Zend_Pdf_Color_Html::color('#75645E'));

    $page1->setLineColor(Zend_Pdf_Color_Html::color('#75645E'));
    $page1->setLineWidth(1); 

    $headerFontSize = 40;
    $headerLeft = 20; 
    $headerTop = $page1->getHeight()-$headerFont-50;

    $page1->setFont($lightFont, $headerFontSize);

    $contentTopFreeSpace = $headerTop-70; 
    $contentLeft = 20;
    $contentRight = $page1->getWidth()-20;

    $page1->drawText('JORDAN', $headerLeft,$headerTop);
    $page1->setFont($regularFont, $headerFontSize/2);
    $page1->drawText('My dreamboard', $page1->getWidth()/2+40,$headerTop);

    $tableHeaderFont = 15;
    $page1->setFont($boldFont, $tableHeaderFont);

    $columnHeaderPadding = 5;
    $productColumnSize = 100;
    $previewColumnSize = 100;
    $imagePreviewSize = 100;

    $previewTableHeaderPosition = $columnHeaderPadding+$productColumnSize+$contentLeft;
    $commentTableHeaderPosition = $previewTableHeaderPosition+$previewColumnSize+$columnHeaderPadding;
    $productTableHeaderPosition = columnHeaderPadding+$contentLeft;

    $commentColumnSize = $page1->getWidth()-$commentTableHeaderPosition ;

    $page1->drawText('Product', $productTableHeaderPosition ,$contentTopFreeSpace);
    $page1->drawText('Preview', $previewTableHeaderPosition,$contentTopFreeSpace);
    $page1->drawText('Comments', $commentTableHeaderPosition,$contentTopFreeSpace);

    $paddingRowHeaderFromLine = 5;
    $contentTopFreeSpace = $contentTopFreeSpace-$paddingRowHeaderFromLine;
       $tableStart = $contentTopFreeSpace;

    $contentFont = 15;
    $rowHeight= 125;

    $page1->setFont($regularFont, $contentFont);
    foreach($wishListItemCollection as $w)
    { 
        $page1->drawLine($contentLeft,$contentTopFreeSpace ,$contentRight,$contentTopFreeSpace);
        $contentTopFreeSpace =$contentTopFreeSpace- $contentFont-$paddingRowHeaderFromLine;

        $product = $w->getProduct(); 
        $product = Mage::getModel('catalog/product')->load($product->getId());
        $page1->drawTextBlock($product->getName(), $productTableHeaderPosition,$contentTopFreeSpace,$productColumnSize);
        $page1->drawTextBlock($w->getDescription(), $commentTableHeaderPosition,$contentTopFreeSpace,$commentColumnSize);

        $imagePath = $this->getImagePath($product);

        // Load image
        $image = Zend_Pdf_Image::imageWithPath($imagePath); 

        $imageObj = new Varien_Image($imagePath); 

        $imageSizes = $this->getImageSizesWithAspectRatio($imageObj->getOriginalWidth(),$imageObj->getOriginalHeight(),$imagePreviewSize,$rowHeight);

        $imageBottom = ($rowHeight-$imageSizes['height'])+$contentTopFreeSpace;
        $imageLeft = $previewTableHeaderPosition;
        $page1->drawImage($image,$imageLeft,$imageBottom-$imageSizes['height'],$previewTableHeaderPosition+$imageSizes['width'],$contentTopFreeSpace);
        $contentTopFreeSpace = $contentTopFreeSpace-$rowHeight-$paddingRowHeaderFromLine;
        $page1->drawLine($contentLeft,$contentTopFreeSpace ,$contentRight,$contentTopFreeSpace);
    };

    $tableLineProductsStartX =  $previewTableHeaderPosition-$columnHeaderPadding;
    $tableLineProductsStartY = $tableStart+$paddingRowHeaderFromLine+$tableHeaderFont;
    $tableLineProductsStartX1 =  $previewTableHeaderPosition-$columnHeaderPadding;
    $tableLineProductsStartY1 = $contentTopFreeSpace;

    $tableLinePreviewStartX =  $commentTableHeaderPosition-$columnHeaderPadding;
    $tableLinePreviewStartY = $tableStart+$paddingRowHeaderFromLine+$tableHeaderFont;
    $tableLinePreviewStartX1 =  $commentTableHeaderPosition-$columnHeaderPadding;
    $tableLinePreviewStartY1 = $contentTopFreeSpace;

    $page1->drawLine($tableLineProductsStartX ,$tableLineProductsStartY  ,$tableLineProductsStartX1,$tableLineProductsStartY1);
    $page1->drawLine($tableLinePreviewStartX ,$tableLinePreviewStartY  ,$tableLinePreviewStartX1,$tableLinePreviewStartY1);
    return $page1;
} 
```

资料来源： http: [//gorrc.blogspot.in/2012/05/magento-print-whishlist-to-pdf.html](http://gorrc.blogspot.in/2012/05/magento-print-whishlist-to-pdf.html)

# php - 下拉菜单不起作用

> ID：11868471
> 
> 赞同：0
> 
> 时间：2012-08-08T15:56:51.457
> 
> 标签：php, zend-framework, drop-down-menu

我试图通过调用`Zend_Auth`以获取登录用户的用户名来限制下拉菜单中的 1 个选项。代码看起来不错，但它只在下拉菜单中显示 1 个空格。

```
 $auth= Zend_Auth::getInstance();
    $user= $auth->getIdentity();
    $username   = $user->username;

    $memberid = $this->createElement('select', 'memberid'); //dropdown menu of member name
    $memberid->setLabel('Member Id')
    ->setRequired(true);
    $db_member = new Application_Model_DbTable_Register();

    $select = $db_member->select('userid')
    ->from(array('usertable'))
    ->where('usertable.username = ?', $username);     

    $row = $db_member->fetchRow($select);
    $memberid->addMultiOption($row['userid']); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:10:01.547

方法`addMultiOption`有两个参数：$option 和 $value，所以不是

```
$memberid->addMultiOption($row['userid']); 
```

尝试做类似的东西

```
$memberid->addMultiOption('user_id', $row['userid']); 
```

`user_id`选项元素的名称在哪里。

另外我建议您制作单独的表单和模型，而不是在控制器中编写数据库和表单代码

而且，你为什么要查询数据库来检索 user_id？您可以获取 user_id 只是表单`auth`对象。

```
$user_id = $user->id; 
```

# cakephp - CakePHP：使用路由隐藏 /index 操作

> ID：11868473
> 
> 赞同：1
> 
> 时间：2012-08-08T15:56:56.460
> 
> 标签：cakephp, routes, cakephp-2.2

`/index`在使用 CakePHP 应用程序和 Html-Helper 中的路由具有 url 参数时隐藏操作的正确方法是什么？

我希望能够`/books/2`在使用 HTML 帮助程序时显示 url

```
echo $this->Html->link('Books', array(
    'controller'=>'books', 'action'=>'index', 2
)); 
```

在我的尝试以下`routes.php`

```
Router::connect('/books/:id', array('controller' => 'books'), array(
    'id' => '[0-9]+',
    'pass' => array('id')
)); 
```

输出是：`http://www.example.com/books/index/2`

想要的是：`http://www.example.com/books/2`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T18:54:12.483

`id`创建链接时，您需要使用路由数组中的键：

```
echo $this->Html->link('Books', array(
    'controller'=>'books', 'action'=>'index', 'id' => 2
)); 
```

# html - 如何使网页高度适合屏幕高度

> ID：11868474
> 
> 赞同：31
> 
> 时间：2012-08-08T15:57:04.073
> 
> 标签：html, css

我需要使我的网页高度适合屏幕大小的高度而不滚动。

HTML

```
<body>
    <form id="form1" runat="server">
    <div id="main">
        <div id="content">

        </div>
        <div id="footer">

        </div>
    </div>
    </form>
</body> 
```

CSS

```
#content{ background-color:#F3F3F3; margin:auto;width:70%;height:700px;}
#footer{width:100%;background-color:#666666;height:200px;} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-08T16:10:47.473

一个快速、不优雅但独立工作的解决方案，带有内联 CSS，没有 jQuery 要求。AFAIK 它也适用于 IE9。

```
<body style="overflow:hidden; margin:0">
    <form id="form1" runat="server">
        <div id="main" style="background-color:red">
            <div id="content">

            </div>
            <div id="footer">

            </div>
        </div>
    </form>
    <script language="javascript">
        function autoResizeDiv()
        {
            document.getElementById('main').style.height = window.innerHeight +'px';
        }
        window.onresize = autoResizeDiv;
        autoResizeDiv();
    </script>
</body> 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-08-08T16:00:22.287

固定定位将满足您的需求：

```
#main
{         
    position:fixed;
    top:0px;
    bottom:0px;
    left:0px;
    right:0px;
} 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-08-30T02:23:50.967

正如另一个人在[这里](https://stackoverflow.com/questions/1575141/make-div-100-height-of-browser-window)描述的那样，您需要做的就是添加

```
height: 100vh; 
```

填充屏幕所需的任何样式

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-08T16:02:26.587

不要给出确切的高度，而是相对的高度，加起来是 100%。例如：

```
 #content {height: 80%;}
  #footer {height: 20%;} 
```

加入

```
 html, body {height: 100%;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T16:05:56.790

您可以使用 css 将 body 标签设置为以下设置：

```
body
{
padding:0px;
margin:0px;
width:100%;
height:100%;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-08T16:01:01.423

尝试：

```
#content{ background-color:#F3F3F3; margin:auto;width:70%;height:77%;}
#footer{width:100%;background-color:#666666;height:22%;} 
```

（77% 和 22% 大致保留了比例`content`并且`footer`不应该引起滚动）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-25T09:38:01.930

使用这个，用你自己的替换你的班级“家”

```
(function ($) {
    $(function(){"use strict";
        $('.home').css({'height':($(window).height())+'px'});
        $(window).resize(function(){
        $('.home').css({'height':($(window).height())+'px'});
        });
    });

  })(jQuery); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-20T15:03:14.497

确保通过添加重要来覆盖原始样式。

```
height: 100vh !important; 
```

# iphone - MKAnnotation 引脚是否连接到持有它的对象？我该如何追溯？

> ID：11868485
> 
> 赞同：1
> 
> 时间：2012-08-08T15:57:52.830
> 
> 标签：iphone, mkmapview, mkannotation, mkannotationview

我有一个 NSObject 类“MyItem”，它包含几个实例变量，其中一个在 (MyMapPoint *)mapPoint 中声明的 mapPoint。我使用这个 MKMapPoint 向 MKMapView 添加注释。NSMutablearray "allItems" 包含所有项目。

```
int all =[allItems count];
int i =0;    
for (i=0; i<all; i++) {

MyItem *p = [allItems objectAtIndex:i];
[mYView addAnnotation:[p mapPoint]]; 
```

这很完美。我得到了一张地图，上面写满了物品注册的地方。此外，当我按下图钉时，我会得到一个气泡，它给出了标题和副标题。我还设法向控制台添加了标注。

```
NSLog (@"bubble is pushed"); 
```

这也可以正常工作。

问题：当我推动气泡时，我希望（首先）控制台记录引脚所代表的实际项目的完整描述。是否有任何示例代码可以追溯到完整的 MyItem？似乎别针不记得它的起源。所有帮助、示例代码和指向示例代码的链接都将得到高度重视。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:07:12.843

听起来您的注释有一个单独的类型（即`-mapPoint`方法返回的任何内容）。处理这个问题的一个更简单的方法是`MKAnnotation`直接在你的`MyItem`类中实现协议。这样，而不是：

```
[mYView addAnnotation:[p mapPoint]]; 
```

你可以说：

```
[mYView addAnnotation:p]; 
```

通过`MKAnnotation`在您的数据对象中采用，您可以在用户点击注释视图时直接访问所需的数据。

当然，另一种方法是在注释中存储一个指向数据对象的指针。如果您的数据对象很大，或者您有很多数据对象，这可能更有意义。它甚至不必是一个实际的对象指针——您只需要在注释中存储一些信息，以便以后恢复数据对象。因此，例如，您可以在注释中包含一个标识符。当用户点击注释视图时，您可以使用标识符从数据存储中检索相关数据。

**简短的回答：**您负责将您的注释连接到您的数据；框架不适合你。

# mysql - 在 WHERE 子句中使用时，子查询是否被 MySQL 缓存？

> ID：11868488
> 
> 赞同：12
> 
> 时间：2012-08-08T15:58:09.300
> 
> 标签：mysql, sql, sql-server, database, optimization

在以下查询中：

```
SELECT column_a, column_b FROM table_a WHERE
    column_b IN (SELECT b_id FROM table_b) 
```

子查询是否`SELECT b_id FROM table_b`由 SQL 解析器缓存，或者提前执行查询是否会更快，将其保存为变量（例如在 PHP 中），然后将这些值作为 CSV 字符串传递？

例如

```
SELECT column_a, column_b FROM table_a WHERE
    column_b IN (1,3,4,6,8,10,16,18) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T16:00:58.817

查看 using`EXPLAIN EXTENDED`以充分说明对子查询的影响。

例如：

```
EXPLAIN EXTENDED
SELECT column_a, column_b FROM table_a WHERE
    column_b IN (SELECT b_id FROM table_b) 
```

如果它们没有产生您希望的缓存结果，您可能有兴趣将它们存储在内存中（[memcache](http://php.net/manual/en/book.memcache.php)、[redis](http://redis.io/)）、文件中（使用[PHP 文件库](http://php.net/manual/en/function.file.php)）或单独的 SQL 缓存本身。

# ruby-on-rails - rails 如何决定使用 PUT 或 POST 方法呈现表单？

> ID：11868489
> 
> 赞同：8
> 
> 时间：2012-08-08T15:58:10.417
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, rest, form-helpers

Rails 会生成一个表单部分，它既可以用于由 get 操作呈现的页面，也可以用于由新操作呈现的页面。如果是前者，则表单的方法设置为 PUT，如果是后者，则表单的操作设置为 POST。

rails 如何决定使用哪种方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-08T16:10:07.960

如果传递给表单的对象是[`persisted?`](https://github.com/rails/rails/blob/b081f6b59fb3f15d12043072ad9b331ffd2bc56e/activerecord/lib/active_record/persistence.rb#L64)，则表单构建器知道您正在更新一个对象，因此将呈现一个`PUT`动作。如果它没有被持久化，那么它知道你正在创建一个新对象并且它将使用`POST`.

```
<%= form_for @user do |f| %>
  <%= f.button %>
<% end %> 
```

如果`@user`是新记录，`POST`则使用且按钮标签变为`Create User`，否则`PUT`使用且标签变为`Update User`。没有更多的了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T16:07:46.540

表单编辑使用现有资源`PUT`，表单创建新资源使用`POST`。根据[此处](http://guides.rubyonrails.org/routing.html)描述的 REST 标准。

从 rails`form_for`帮助代码：

```
action, method = object.respond_to?(:persisted?) && object.persisted? ? [:edit, :put] : [:new, :post] 
```

并且`persisted?`对于 ActiveRecord 被声明为：

```
!(new_record? || destroyed?) 
```

# java - 扩展广播接收器的类不起作用

> ID：11868490
> 
> 赞同：1
> 
> 时间：2012-08-08T15:58:16.783
> 
> 标签：java, android, eclipse, broadcastreceiver

我创建了一个辅助类，它扩展了 BroadcastReceiver 以侦听找到的 BluetoothDevice 和发现完成意图。我有两个活动通过传递一个处理程序来使用这个类。处理程序根据意图接收消息。我像这样实例化类和 registerReceiver ：

**从 mainActivity**：

```
deviceHelper=new DevicesHelper(myHandler,DevicesHelper.REQUEST_DETECT_DEVICES_IN_RANGE);

IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
this.registerReceiver(deviceHelper, filter);

filter = new IntentFilter(BluetoothAdapter.ACTION_DISCOVERY_FINISHED);
this.registerReceiver(deviceHelper, filter);

if(myBluetoothAdapter.isDiscovering())myBluetoothAdapter.cancelDiscovery();
myBluetoothAdapter.startDiscovery(); 
```

**从 ListActivity**：

```
deviceHelper=new DevicesHelper(deviceListHandler,DevicesHelper.REQUEST_DEVICE_LIST_ACTIVITY);

IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
this.registerReceiver(deviceHelper, filter);

filter = new IntentFilter(BluetoothAdapter.ACTION_DISCOVERY_FINISHED);
this.registerReceiver(deviceHelper, filter); 
```

**DeviceHelper 类**：

```
public class DevicesHelper extends BroadcastReceiver {

    public final static int REQUEST_DEVICE_LIST_ACTIVITY=1;
    public final static int REQUEST_DETECT_DEVICES_IN_RANGE=2;

    Handler myHandler;      
    int requestCode;

    public DevicesHelper(){

    }
    public DevicesHelper(Handler handler,int requestCode){
            this.requestCode=requestCode;
            myHandler=handler;

    }

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub
        String action = intent.getAction();

        // When discovery finds a device
        BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);

        if (BluetoothDevice.ACTION_FOUND.equals(action)) {
            // Get the BluetoothDevice object from the Intent
            switch(requestCode){
            case REQUEST_DEVICE_LIST_ACTIVITY: 
                if (device.getBondState() != BluetoothDevice.BOND_BONDED) {
                    //newDevicesCount++;
                    String[] deviceInfo={device.getName(),device.getAddress()};

                    myHandler.obtainMessage(DeviceListActivity.MESSAGE_NEW_DEVICE,deviceInfo);
                };

                break;

            case REQUEST_DETECT_DEVICES_IN_RANGE:

                String[] deviceInfo={device.getName(),device.getAddress()};

                myHandler.obtainMessage(StripChartRecorder.MESSAGE_NEW_DEVICE,deviceInfo);
                break;

            }

            // When discovery is finished, change the Activity title
        } else if (BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(action)) {

            myHandler.obtainMessage(StripChartRecorder.MESSAGE_DISCOVERY_FINISHED);

        }
    } 
```

**处理程序**：

```
private final Handler myHandler=new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch(msg.what) {
                case MESSAGE_NEW_DEVICE:
                    doOtherStuff();

                case MESSAGE_DISCOVERY_FINISHED:
                    dostuff();
            }
            break;
}} 
```

我在这里错过了什么吗？我很感激任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:53:45.870

你需要知道你得到的`sendMessage(Message msg)`msg 所在的位置。`Message``obtainMessage`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T01:05:50.367

问题是我如何处理从处理程序收到的消息。结果 Set<> 根据 Eclipse 的指令最初设置为 null，因此它从未添加从 BroadcastReceiver 帮助程序类接收到的设备。我感谢任何试图提供帮助的人。

# c# - 解析webapi发送的数据。IEnumerable 是一个不错的选择吗？

> ID：11868494
> 
> 赞同：1
> 
> 时间：2012-08-08T15:58:28.010
> 
> 标签：c#, asp.net, windows-8, microsoft-metro, asp.net-web-api

您好，我正在创建 WebAPI 和一个与此 API 通信的 windows8 Metro 应用程序。

我将使用简单的示例

API

```
public IEnumerable<string> Get() {
        return new string[] { "value1", "value2" };
} 
```

应用

```
using (HttpClient client = new HttpClient())
        {
            using (var response = await client.GetAsync(this.apiUri.GetUri("content", "Get")))
            {
                var result = await response.Content.ReadAsStringAsync();

            }
        } 
```

现在变量结果是来自 API 的响应。但这是形式上的字符串

```
"[\"value1\",\"value2\"]" 
```

我该如何解析/转换它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:03:58.663

WebAPI 默认返回 JSON。您可以请求它发送 XML，或使用 JSON 解析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T17:41:23.700

在您的情况下，您可以轻松地使用[Json.Net](http://json.codeplex.com/)反序列化：

```
var json = "[\"value1\",\"value2\"]";
var values = JsonConvert.DeserializeObject<string[]>(json); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:19:39.710

我在 silverlight 中使用我的类 (MVCClient.cs) 与 MVC WebAPI 进行通信。在你的情况下，你只想打电话：

```
DoGetMessage<string>(yourUrl, new DataDelegateArray<string>(yourCallbackFunction)); 
```

您在代码中缺少的行将是：

```
DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(T));
T data = (T)serializer.ReadObject(stream); 
```

其中 T 是字符串 []。

MVCClient.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Runtime.Serialization.Json;
using System.Text;
public class MVCClient
    {
        public delegate void DataDelegateArray<T>(T[] objects);
        public delegate void DataDelegate<U>(U obj);

    #region Communication Functions
        public void DoPostMessage<T>(string queryURL, T item, ProcessPOSTResult<T> callback)
        {
            DoPostMessage<T, T>(queryURL, item, callback);
        }

        public void DoPostMessage<TPost, TReply>(string queryURL, TPost item, ProcessPOSTResult<TReply> callback)
        {
#if SILVERLIGHT
            Uri uri = new Uri(queryURL, UriKind.Absolute);

            var request = (HttpWebRequest)WebRequest.Create(uri);
            request.Method = "POST";
            request.ContentType = "application/json";
            request.BeginGetRequestStream(result =>
                {
                    var req = (HttpWebRequest)result.AsyncState;
                    var stream = req.EndGetRequestStream(result);

                    if (stream != null)
                    {
                        var data = new
                        {
                            name = item
                        };

                        System.IO.MemoryStream ms = new System.IO.MemoryStream();
                        DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(TPost));
                        serializer.WriteObject(stream, item);
                        stream.Close();
                    }

                    req.BeginGetResponse((requestResult) =>
                    {
                        var req2 = (HttpWebRequest)requestResult.AsyncState;
                        var response = req2.EndGetResponse(requestResult);
                        var responseStream = response.GetResponseStream();
                        DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(TReply));
                        TReply responseItem = (TReply)serializer.ReadObject(responseStream);

                        System.Windows.Deployment.Current.Dispatcher.BeginInvoke(() =>
                        {
                            callback(responseItem);
                        });

                    }, req);
                }, request);

#endif
        }

        public void DoGetMessage<T>(string queryURL, DataDelegateArray<T> callback)
        {
            DoGetMessage<T[]>(queryURL, result => callback(result));
        }

        public void DoGetMessage<T>(string queryURL, DataDelegate<T> callback)
        {
#if SILVERLIGHT
            Uri uri = new Uri(queryURL, UriKind.Absolute);

            var request = (HttpWebRequest)WebRequest.Create(uri);
            request.Method = "GET";
            request.Accept = "text/json";
            request.BeginGetResponse((result) =>
            {
                var response = request.EndGetResponse(result);
                var stream = response.GetResponseStream();

                if (stream != null)
                {
                    DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(T));
                    T data = (T)serializer.ReadObject(stream);
                    System.Windows.Deployment.Current.Dispatcher.BeginInvoke(() =>
                    {
                        callback(data);
                    });
                }
                else
                    System.Windows.Deployment.Current.Dispatcher.BeginInvoke(() =>
                    {
                        callback(default(T));
                    });
            }, null);
#endif
        }
        #endregion
    } 
```

# php - Force a field to not be required

> ID：11868497
> 
> 赞同：24
> 
> 时间：2012-08-08T15:58:35.853
> 
> 标签：php, symfony, fosuserbundle

I am using Symfony2 and FOSUserBundle.

Just as detailed in the documentation, I have overridden and created a "name" property in the User entity.

I do all necessary and finally get that field to be shown in the form view.

The thing is: when I go `form_widget(form.name)` and the input html tag is generated, a required="required" property is generated within it. And that causes the engine to red the input when the field is not filled in.

How do I do to tell the Symfony2 not to make that field mandatory? I guess that it has to be here:

```
 parent::buildForm($builder, $options);

    // add your custom field
    $builder->add('name', 'text', array('label' => 'form.name'));
    $builder->remove('username'); 
```

or here:

```
 /**
 * @ORM\Column(type="string", length="255")
 *
 * @Assert\MinLength(limit="0", message="The name is too short.", groups={"Registration", "Profile"})
 * @Assert\MaxLength(limit="255", message="The name is too long.", groups={"Registration", "Profile"})
 */
private $name; 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-08T16:14:12.180

```
$builder->add('name', 'text', array('label' => 'form.name','required' => false)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-27T09:26:49.440

Try to use:

```
use Symfony\Component\Validator\Constraints\NotNull;

$builder->add('name', 'text', array('label' => 'form.name',
'constraints' => new NotNull())); 
```

# wix - 使用 WiX 创建桌面快捷方式

> ID：11868499
> 
> 赞同：66
> 
> 时间：2012-08-08T15:58:37.400
> 
> 标签：wix, installation, windows-installer, shortcut

如何从 wix 安装项目在桌面上创建快捷方式？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-08-08T15:58:37.400

该快捷方式是非广告的，希望这对某人有所帮助。请记住将组件放在您的功能标签中。

```
<Directory Id="TARGETDIR" Name="SourceDir">
    <Directory Id="DesktopFolder" Name="Desktop">
        <Component Id="ApplicationShortcutDesktop" Guid="*">
            <Shortcut Id="ApplicationDesktopShortcut"
                Name="Text under your icon"
                Description="Comment field in your shortcut"
                Target="[MYAPPDIRPROPERTY]MyApp.exe"
                WorkingDirectory="MYAPPDIRPROPERTY"/>
            <RemoveFolder Id="DesktopFolder" On="uninstall"/>
            <RegistryValue
                Root="HKCU"
                Key="Software\MyCompany\MyApplicationName"
                Name="installed"
                Type="integer"
                Value="1"
                KeyPath="yes"/>
        </Component>
    </Directory>

    <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="MyCompany" Name="MyCompany">
            <Directory Id="MYAPPDIRPROPERTY" Name="MyAppName">
                <!-- main installation files -->
            </Directory>
        </Directory>
    </Directory>
</Directory> 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-08-07T20:26:48.200

我认为我的方式更简单，无需您创建注册表项：

```
<Directory Id="TARGETDIR" Name="SourceDir">
  <Directory Id="DesktopFolder" SourceName="Desktop" />
  <Directory Id="MergeRedirectFolder">
    <Component Id="MyExeComponent" Guid="{PUT-GUID-HERE}">
      <File Id="MyExeFile" Source="$(var.ExeSourcePath)" KeyPath="yes">
        <Shortcut
          Id="DesktopShortcut"
          Directory="DesktopFolder"
          Name="$(var.ShortcutName)"
          WorkingDirectory="MergeRedirectFolder" />
      </File>
    </Component>
  </Directory>
</Directory> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-03-13T03:52:24.190

例如，谢谢。在 WIX 3.8 中，它仍然会引发：“错误 3 ICE43：组件...具有未公布的快捷方式。它应该使用 HKCU 下的注册表项作为其 KeyPath，而不是文件。”

所以我在一个具有特征的文件中这样做了：

```
 <Component Id="cmp79F6D61F01DD1060F418A05609A6DA70" 
              Directory="dirBin" Guid="*">
      <File Id="fil34B100315EFE9D878B5C2227CD1454E1" KeyPath="yes"
            Source="$(var.SourceDir)\FARMS.exe" >
        <Shortcut Id="DesktopShortcut"
                  Directory="DesktopFolder"
                  Name="FARMS $(var.FarmsVersion)"
                  Description="Local Land Services desktop application"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="FARMS.exe"
                  IconIndex="0"
                  Advertise="yes" >
           <Icon Id="FARMS.exe" SourceFile="$(var.SourceDir)\FARMS.exe" />
        </Shortcut>
        </File>
    </Component> 
```

并在带有产品定义的文件中提到了桌面文件夹：

```
 <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="DesktopFolder" Name="Desktop" />

      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="FARMS" >
        </Directory>
      </Directory>
    </Directory>
  </Fragment> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-12-21T06:44:55.147

在本[文档](https://www.firegiant.com/wix/tutorial/getting-started/the-files-inside/)中似乎要容易得多。

首先，你必须指向你的 DesktopFolder，

```
 <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="DesktopFolder" Name="Desktop"/> 
```

然后，您应该为要为其创建快捷方式的文件创建快捷方式组件。

```
 <Component Id="PutYourComponentIdHere" Directory="FileDirectory" Guid="*">
    <File Id="NotYourComponentId" KeyPath="yes" Source="..\YourFileSource\YourExecutable.exe">
      <Shortcut Id="desktopServer" Directory="DesktopFolder" Name="YourShourtcutName" WorkingDirectory='WhereShouldYourShortcutPoint' Advertise="yes"/>
    </File>
  </Component> 
```

它对我有用。我需要放图标，但这很容易。希望它有效。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-05-23T07:06:58.297

经过太多努力，我使用了这种方式：

```
<Product ...>
    <Feature Id="ProductFeature" Title="SetupProject" Level="1">
      ...
      ...
      <ComponentRef Id="cmpDesktopShortcut" />
    </Feature>

    <Component Id="cmpDesktopShortcut" Guid="PUT-GUID-HERE" Directory="DesktopFolder" >
        <Shortcut Id="MyDesktopShortcut" 
                  Name="Setup Project" 
                  Description="Opens the program." 
                  Directory="DesktopFolder" 
                  Target="[INSTALLFOLDER]App.exe"
                  WorkingDirectory="INSTALLFOLDER"/>
        <RegistryValue Root="HKCU" Key="Software\My Company\Sample Application" Name="installed" Type="integer" Value="1" KeyPath="yes" />
    </Component>
</Product> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-29T14:02:44.190

我相信使用“当前用户”（HKCU）注册表项作为密钥路径会导致多用户机床出现问题。因为注册表项仅为当前用户创建，并且当其他用户登录时，安装的自动修复就会启动。

# android - “不推荐使用 Gallery 类型”，最好的选择是什么？

> ID：11868503
> 
> 赞同：18
> 
> 时间：2012-08-08T15:58:44.037
> 
> 标签：android, imageview, gallery

我真的很惊讶这样的小部件被弃用了。
我想要一个简单的画廊，左右滚动，在整个活动屏幕上显示一张图片，最重要的是你不能在任何方向滑动超过 1 个图像，即使滚动速度很快它也会改变到下一个图像。

那么我应该使用哪个小部件？或者我应该使用简单的 ImageView 并处理所有滑动并添加动画？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-08T16:04:33.060

它在文档中指出：

> 不再支持此小部件。其他水平滚动小部件包括支持库中的 Horizo​​ntalScrollView 和 ViewPager。

Horizo​​ntalScrollView 将更接近我认为您正在寻找的内容。

我怀疑 Gallery 已被弃用，因为它没有正确使用 convertView 及其适配器。这意味着它必须为每个项目创建一个新视图，这会消耗性能。

您拥有的另一个选择是使用由Joseph Earl 创建的[第 3 方创建的 EcoGallery](https://github.com/falnatsheh/EcoGallery)来解决该问题，此版本确实可以正确地回收其视图。~~不幸的是，[pastebin 链接](http://pastebin.com/FWyYTt4D)是我现在可以在网上找到的唯一参考。~~

# ios5 - iOS Safari 中的嵌入式 YouTube 只是旋转

> ID：11868505
> 
> 赞同：0
> 
> 时间：2012-08-08T15:58:58.253
> 
> 标签：ios5, youtube-api

我有许多非常小的页面，它们基本上加载了用于移动浏览器的视频。在最新的 iOS (5.1.1) 中，视频播放器会加载，但随后只是旋转。可以通过点击视频来播放视频，但由于它看起来仍在加载中，人们可能不会这样做。在其他地方工作。

我正在使用 youtube api 代码

这是页面的测试版本。 [http://bit.ly/S2KuN1](http://bit.ly/S2KuN1)

这是代码：

```
<!DOCTYPE HTML>
<html>
<head>
<title>Celebrity's Caribbean Shore Excursions</title>
<link href="http://www.celebritycruises.com/css/min/global.min.css" rel="stylesheet">
<link href="http://media.celebritycruises.com/celebrity/content/en_US/css/m_video.css" rel="stylesheet">
<script language="JavaScript" type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>

<script type="text/javascript" src="http://www.youtube.com/player_api"></script>
<script type="text/javascript">

// create youtube player
var player;

function onYouTubePlayerAPIReady() {
    player = new YT.Player('player', {
      videoId: 'PH-m591p4xg',
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
}
</script>
<script type="text/javascript" src="m_video.js"></script>
</head>
<body id="video_page">
<div class="logo"><a href="http://m.celebritycruises.com/m/home.do"><img src="http://media.celebritycruises.com/celebrity/content/en_US/images/cel_misc/logo.jpg" alt="Celebrity Mobile" width="259" height="55" border="0"></a></div>
<div id="player"></div>
<div class="visit">
<p>Now visit Celebrity Cruises' official mobile website.</p>
<p><a class="ccButton large" target="_self" href="http://m.celebritycruises.com/m/home.do"> <span class="text">Explore</span> <span class="pointer"> </span> </a></p>
</div>
</body>
</html> 
```

这是页面的js

// JavaScript 文档

```
// autoplay video
function onPlayerReady(event) {
    event.target.pauseVideo();
}

// when video ends
function onPlayerStateChange(event) {        
    if(event.data === 0) {
        window.location = "http://m.celebritycruises.com/m/home.do";
    }
}

//style Blackberry
window.onload = function() {
    var ua = navigator.userAgent;
    if (ua.indexOf("BlackBerry") != -1 ) {
        document.getElementById("video_page").className = "bb";
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:07:57.527

好的，我想出了如何解决它。

我变了

```
event.target.pauseVideo(); 
```

至

```
event.target.stopVideo(); 
```

我不知道问题是什么，但 iOS 5.1.1 似乎永远不会完成自动加载。使用 YouTube api 中的 stopVideo() 命令会停止该过程并出现播放按钮。单击后，它会正常加载。

# c# - 不能让表单“自行关闭”？

> ID：11868508
> 
> 赞同：2
> 
> 时间：2012-08-08T15:59:14.843
> 
> 标签：c#, winforms, visual-studio-2010

我有一个表单可以在单击按钮时打开另一个表单。当新表单打开时，我有一个通过循环完成的进度条，然后我希望表单关闭。这是启动新表单的按钮单击事件。

```
 private void calculateButton_Click(object sender, EventArgs e)
    {

        if (checkFormComplete())
        {
            ProgressForm proForm = new ProgressForm();
            proForm.Show();
        }

    } 
```

这是完成进度条的新表单的代码，该进度条随后应自行关闭。

```
 public ProgressForm()
    {
        InitializeComponent();
        for (int i = 0; i < 101; i++)
            calculationProgress.Value = i;

        this.Close();
    } 
```

然而，在运行这个我得到：

> 无法访问已处置的对象。对象名称：'ProgressForm'。

调试器指向我主要表单的这一行：

```
proForm.Show(); 
```

**我不确定我理解为什么，或者这样做的正确方法是什么。在我的新表单中的 close 语句之后如何调用该行？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T16:01:45.527

表单甚至在显示之前尝试自行关闭（因为您的代码在构造函数中）。输入您的进度条码并`Close()`调用`FormLoad`or`FormShown`事件。例子：

```
private void ProgressForm_Shown(object sender, EventArgs e)
{
    for (int i = 0; i < 101; i++)
    {
        calculationProgress.Value = i;
        Application.DoEvents(); // force the form to update itself
    }

    this.Close();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:03:01.317

在您尝试关闭表单之前允许加载完成:-)

您应该在 Form_Load 事件中启动进度条循环。

但是请注意，这样的循环会导致您的表单*锁定，*直到进度条完成渲染。

在后台线程中执行进度循环。BackgroundWorker[非常](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)适合运行进度循环。

```
public proForm()
{
    InitializeComponent();
    backgroundWorker1.WorkerReportsProgress = true;
    backgroundWorker1.WorkerSupportsCancellation = true;
}

proForm_Load()
{
    backgroundWorker1.RunWorkerAsync();
}

private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
{

    (int i = 0; i < 101; i++) worker.ReportProgress(i);
}

private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
        resultLabel.Text = (e.ProgressPercentage.ToString() + "%");
}

private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    this.Close();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:11:07.380

构造函数用于**初始化**对象而不破坏构造函数本身的对象。

所以构造函数应该包含初始化代码。

您的代码正在尝试使用构造函数中的 破坏对象，`this.Close();`因此出现错误。

将您的代码放在`Load`表单事件中。

`calculationProgress.Value`通过**BackgroundWorker 的** `ProgressChanged`事件更改

# c# - 使用 LINQ 和 C# 将行从一个表复制到另一个表

> ID：11868509
> 
> 赞同：0
> 
> 时间：2012-08-08T15:59:18.630
> 
> 标签：c#, linq, linq-to-sql

我有两个表，它们几乎是彼此的完全克隆（相同的列，只是设置为主键的不同列）。基本上第二张表只是为了保存第一张表的历史。我需要做的是，当用户更新表 1 中的记录时，我需要将该记录的原始副本插入表 2。

我正在使用 LinqDataSource 对象并利用该`LinqDataSource_Updating(object sender, LinqDataSourceUpdateEventArgs e)`事件，因此我可以访问`e.OriginalObject`这将非常适合在表 2 中插入原始行。我的问题是我不想手动设置每个属性，因为大约有 50其中，所以我想使用反射，但不知道如何正确地去做。

考虑以下代码：

```
INSTRUMENT_DATA_SHEET _original = (INSTRUMENT_DATA_SHEET)e.OriginalObject;
INSTRUMENT_DATA_SHEET_HISTORY _history = new INSTRUMENT_DATA_SHEET_HISTORY(); 
```

如何将所有`_original`' 的属性值复制到`_history`' ？我已经尝试使用[这个问题](https://stackoverflow.com/questions/930433/apply-properties-values-from-one-object-to-another-of-the-same-type-automaticall)的解决方案，但是它对我不起作用。它抛出错误：

`Property DATE has an incompatible type in E_and_I.INSTRUMENT_DATA_SHEET_HISTORY`

我的猜测是，这是因为该`DATE`列是表 2 中主键的一部分，而不是表 1。正如我所说，两个表之间的唯一区别是主键。它们供您参考：

![主键](../Images/aa91cf6f6c05d5742fdec2becbde0464.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:48:28.153

我看到的问题是您的历史类型日期字段是`DateTime`，而您的原始字段是`DateTime?`（历史中的 REV 问题相同，它不能为空）。如果您的原始版本中有一个空的 DateTime 日期，您必须决定会发生什么。然后，您应该能够修改 Skeets 代码（哦，天哪！）以不同于其他字段的方式专门处理这些字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:11:01.490

好的，我已经设法弄清楚了:) 这就是我所做的：

```
INSTRUMENT_DATA_SHEET _original = (INSTRUMENT_DATA_SHEET)e.OriginalObject;
INSTRUMENT_DATA_SHEET_HISTORY _history = new INSTRUMENT_DATA_SHEET_HISTORY();

foreach (PropertyInfo pi in _original.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance))
{
    _history.GetType().GetProperty(pi.Name).SetValue(_history, pi.GetValue(_original, null), null);
} 
```

不是很优雅，但它完成了工作！

# javascript - Javascript 表单未发布到 IE 9

> ID：11868511
> 
> 赞同：0
> 
> 时间：2012-08-08T15:59:24.743
> 
> 标签：javascript, post, internet-explorer-9

我有一个非常简单的 Javascript 表单，可以发布到 PHP 页面。这个页面是从 CRM 系统启动的，页面本身只能是 HTML 页面，所以我不能使用 PHP 作为表单。该表单将用户 ID（由 CRM 系统生成）发布到 PHP 页面，然后根据用户 ID 执行大量内容。

然而，问题是一些用户现在拥有 IE9，但它似乎无法使用它！IE 8 绝对没问题，但 IE9 似乎并没有发布用户 ID。

CRM系统内的表格如下：

```
<form action="http://intranet-srv02/reports/contact.php" method="post" onsubmit="target_popup(this)">
<input name="userid" type="hidden" value="[userid]" />
<input type="submit" value="Reports" />
</form>
<script language="JavaScript1.2">
function target_popup(form) {
window.open('', 'formpopup', 'width=1100,height=750,resizeable,scrollbars');
form.target = 'formpopup';
}
</script> 
```

什么时候，在contact.php页面上放

```
<?php
$userid = $_POST['userid'];
echo $userid;
?> 
```

在 IE9 上没有任何回声（但在 IE8 和其他上却有）

非常感谢任何帮助！

编辑：我已经更新了已弃用的语言属性，但仍然有同样的问题。表格现在显示：

```
<form action="http://intranet-srv02/reports/contact.php" method="post" onsubmit="target_popup(this)">
<input name="userid" type="hidden" value="[userid]" />
<input type="submit" value="Reports" />
</form>
<script type="text/javascript">
function target_popup(form) {
window.open('', 'formpopup', 'width=1100,height=750,resizeable,scrollbars');
form.target = 'formpopup';
}
</script> 
```

还有其他想法吗？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:53:15.400

所以事实证明，IE9 和用户配置文件存在（目前未知究竟是什么）问题。

问题可能是当用户使用 XP，然后他们开始使用 Windows 7 机器时。最终，我们还没有完全缩小范围，但重新创建用户的个人资料似乎可以解决问题！

Windows的乐趣...

# github - 使用 Github README.md 上的相对路径链接

> ID：11868512
> 
> 赞同：20
> 
> 时间：2012-08-08T15:59:35.307
> 
> 标签：github, markdown, relative-path, absolute-path

我正在尝试在我的 README.md 中创建链接，该链接使用相对路径链接到示例代码，而不是我现在使用的绝对路径。例如，在降价文件中，如果我使用这个：

```
[someLabel](https://github.com/username/repoName/somePathTo/myExampleCode) 
```

它没有问题。但我想用这样的东西把它链接起来：

```
[someLabel](username/repoName/somePathTo/myExampleCode) 
```

这没有链接，因为它给了我 ol' 404 not found 错误。有没有办法使用相对路径将我在 Github 上的示例链接到我的 README？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-25T14:06:36.453

他们似乎已经改变了这一点`Aug 8 '12`，所以现在我所要做的`Documentation`就是在文件夹中引用我的 pdf 文件（在我的项目的根目录中）是这样的：

```
[file.pdf](Documentation/file.pdf) 
```

因此，无需再添加`blog/master`部分。希望它可以帮助新人浏览这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T22:07:08.807

尝试离开该`username/`部分。`repoName/blob/master/whatever`我认为，页面上的相对链接`/username/repoName`应该带您到`/username/repoName/blob/master/whatever`，这就是您想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-11-13T17:58:23.693

这是一个细微差别。前导斜杠更改链接的含义。

```
[someLabel](/repository/relative/link.txt)

[someLabel](directory/relative/link.txt) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-19T05:40:36.240

我最近发现在 README.md 中使用相对路径的方法是：

`[file.pdf](/Documentation/file.pdf)`

其中 Documentation 是我的存储库根目录下的一个文件夹

# php - 如何获取 vBulletin 最后插入 id

> ID：11868514
> 
> 赞同：0
> 
> 时间：2012-08-08T15:59:41.127
> 
> 标签：php, vbulletin

我正在尝试从我正在为 PHP 中的 vBulletin 创建的插件中获取最后一个插入 ID。出于某种原因，它似乎没有工作......有什么想法我该怎么做吗？

*   查询插入正常使用`$db->query_write($sql_i);`
*   我发现的文档说明我需要使用`$db->insert_id`

完整代码：

```
$sql_i = "INSERT INTO classifieds_item (".$i_fieldnames.",`date_posted`) values (".$i_values.",NOW())";

$db->query_write($sql_i);

header("location: classifieds.php?class_act=add_img&id=".$db->insert_id); 
```

这是使用标准的 vBulletin 数据库类。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T23:02:29.493

insert_id() 是一个函数，所以

```
header("location: classifieds.php?class_act=add_img&id=".$db->insert_id()); 
```

应该管用。关键是$db->insert_id 和$db->insert_id() 之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:16:15.393

你试过吗：http `mysql_insert_id()`: [//php.net/manual/en/function.mysql-insert-id.php](http://php.net/manual/en/function.mysql-insert-id.php)

它将返回上一个`AUTO_INCREMENT`列的最后一个 id `INSERT`。

值得注意的是，PHP 文档还建议使用替代方法，因为现在不鼓励使用这种方法。

# ruby-on-rails - 在引擎中使用 twitter bootstrap rails

> ID：11868516
> 
> 赞同：2
> 
> 时间：2012-08-08T15:59:43.470
> 
> 标签：ruby-on-rails, rails-engines, twitter-bootstrap-rails

我目前正在尝试开发一个 Rails 引擎，我想在这个引擎中使用 twitter boostrap rails。我已经将 gem 添加到 gemspec 文件中的依赖项中，但是需要执行 rails 生成器才能正常运行。安装引擎后如何自动运行 twitter boostrap 生成器？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:08:22.080

在您自己的生成器中，您可以执行如下命令行：

```
...
`rails g bootstrap:install`
... 
```

不要忘记`。

不确定，但你也可以试试这个：

```
generator = Bootstrap::Generators::InstallGenerator.new
generator.add_assets
generator.add_bootstrap
generator.cleanup_legacy 
```

我认为更好的方法是：

```
Rails::Generators.invoke "bootstrap:install", [], :behavior => :invoke, :destination_root => Rails.root 
```

# plot - 仅绘制具有指定 z 值的 (x,y) 点

> ID：11868517
> 
> 赞同：1
> 
> 时间：2012-08-08T15:59:47.483
> 
> 标签：plot, gnuplot

我在 3 列中有 x、y、z 数据，如下所示：

```
1  2  1
2  4  1
3  3  1
4  4  2
5  8  2
6  6  2 
```

假设我只想绘制 z=2 的 (x,y) 值（即，仅最后 3 行）。我如何在 gnuplot 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:23:23.650

```
plot 'datafile.dat' using 1:((column(3) == 2) ? column(2):NaN) 
```

请注意，您也可以使用简写形式： `$3`代替`column(3)`. 我只是使用后一种形式，因为它更容易阅读。

# xslt - 如何从另一个 xsl 文件中的 xsl:template 访问 xsl 文件中的变量

> ID：11868518
> 
> 赞同：0
> 
> 时间：2012-08-08T15:59:47.577
> 
> 标签：xslt

在 home.xsl

```
<xsl:template match="/Screen">
        <xsl:variable name="field" select="ListOfNames[@group='1']/*[name() != 'StaticLabel']"/>

.....

    <xsl:call-template name="SecondaryTemplate">
                    <xsl:with-param name="radiofield" select="$field"/>
    </xsl:call-template> 
```

在另一个文件中：base.xsl

```
<xsl:template name="SecondaryTemplate">
    <xsl:param name="radiofield"/>
    <xsl:for-each select="$radiofield">
      <xsl:variable name="i" select="position()"/>
       <xsl:text><xsl:copy-of select="@*"/>    </xsl:text>
    </xsl:for-each>
</xsl:template> 
```

这是访问from`field`中定义的值的正确方法吗？出于某种原因，每当输出一直为空时。`home.xsl``SecondaryTemplate``xsl:text`

但是，当我在 中执行 'xsl:text' 时`home.xsl`，我能够获取`field`. 我没有直接访问原始 xml 的权限，因为那是机密的……只能解析内容并将其打印出来。

# c++ - Visual Studio 2010 未显示我的智能感知文档

> ID：11868520
> 
> 赞同：2
> 
> 时间：2012-08-08T15:59:50.050
> 
> 标签：c++, visual-studio-2010, intellisense

今天我决定用智能感知开始记录我的函数是个好主意。

问题是，当我键入 /// 并按 Enter 时，它不会创建要填写的标签（不是吗？）。

更糟糕的是，即使我手动记录我的功能：

```
/// <summary>
/// Gets something.
/// </summary>
/// <param name="somethingElse"> Something else.</param>
/// <returns> Something. </returns>
int getSomething(int somethingElse); 
```

当我去写“object.getSomething（”时，它只向我显示参数，就像文档从未存在一样。

是的，我将其设置为在项目选项-> 配置属性-> c/c++ -> 输出中生成XML 文档文件并尝试重建项目。

没有效果。

有任何想法吗？

# ios - PackageApplication 失败，因为应用程序不满足其指定要求

> ID：11868522
> 
> 赞同：2
> 
> 时间：2012-08-08T15:59:53.700
> 
> 标签：ios, command-line, build, ipa

我在将应用程序打包为 IPA 时遇到问题`PackageApplication`。协同设计验证因**“不满足其指定要求”而**失败：

```
+ /usr/bin/codesign --verify -vvvv -R=anchor apple generic and (certificate 1[field.1.2.840.113635.100.6.2.1] exists and (certificate leaf[field.1.2.840.113635.100.6.1.2] exists or certificate leaf[field.1.2.840.113635.100.6.1.4] exists)) /var/folders/8j/n5d5y1bj6wz3l8gs_djqn3400000gn/T/8xonyTiAuP/Payload/Planner.app
Program /usr/bin/codesign returned 3 : [/var/folders/8j/n5d5y1bj6wz3l8gs_djqn3400000gn/T/8xonyTiAuP/Payload/Planner.app: valid on disk
/var/folders/8j/n5d5y1bj6wz3l8gs_djqn3400000gn/T/8xonyTiAuP/Payload/Planner.app: does not satisfy its designated Requirement
/var/folders/8j/n5d5y1bj6wz3l8gs_djqn3400000gn/T/8xonyTiAuP/Payload/Planner.app: explicit requirement satisfied 
```

这里指定了什么要求？！？

我正在使用 xcodebuild 构建：

```
xcodebuild -workspace MyWorkspace.xcworkspace -scheme Planner -ask iphoneos clean build archive 
```

它为我创建了一个 Xcode 存档，`~/Library/Developer/Xcode/Archives`到目前为止一切都很好。

然后我读到人们使用 PackageApplication 但对我来说失败了：

```
 xcrun -sdk iphoneos PackageApplication -v path/to/Planner.app -o Planner.ipa --sign 9990807058544973D70EA9A9F3BB3949D51C0983 --embed my_profile.mobileprovision 
```

出现上述错误。

我在这里缺少什么部分？还有另一种方法可以做到这一点吗？

这是 Xcode 4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-20T21:48:16.633

`.app`您可以通过运行以下命令来检查文件的指定要求：

```
codesign -d -r- path/to/file.app 
```

您的输出应包含以 . 开头的行`designated =>`。接下来是您*指定的要求*。此输出的一个示例是：

`designated => identifier "com.organization.project" and certificate root = H"abcdef0123456789abcdef0123456789abcdef12"`

`-d`标志显示信息，标志`-r-`将需求写入`stdout`.

您可以使用 Apple 的[代码签名要求语言](https://developer.apple.com/library/mac/documentation/Security/Conceptual/CodeSigningGuide/RequirementLang/RequirementLang.html)页面来解释这些要求的含义。

如果您想缩小哪个特定需求失败的范围，您可以通过输入以下命令单独运行测试：

`codesign -v -R="certificate root = H\"abcdef0123456789abcdef0123456789abcdef12\"" /path/to/file.app`

该`-v`标志对您的应用程序执行验证，并且该`-R`标志通过明确要求进行测试。

# php - 在 SQL 或单独的查询中进行联合然后使用 php array_merge 是否更好？

> ID：11868530
> 
> 赞同：9
> 
> 时间：2012-08-08T16:00:15.200
> 
> 标签：php, mysql

我有一个包含 4 个 UNIONS 和 4 个 LEFT JOINS 的 SQL 查询。它是这样布置的：

```
SELECT ... FROM table1
    LEFT JOIN other_table1
UNION SELECT ... FROM table2
    LEFT JOIN other_table2
UNION SELECT ... other_table3
    LEFT JOIN other_table3
UNION SELECT ... FROM table4
    LEFT JOIN other_table4 
```

运行 4 个单独的查询然后在事后将结果与 php 合并会更好吗？还是我应该把它们放在一起？哪个会提供最快的执行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T16:02:08.053

最明确的答案是测试每种方法，但`UNION`最有可能更快，因为 MySQL 只运行一个查询，而不是联合的每个部分运行 4 个查询。

您还消除了在 PHP 中将数据读入内存并将其连接起来的开销。相反，您可以对一个结果执行`while()`or`foreach()`或任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:04:28.333

在这种情况下，这取决于您要从结果中获得的记录数。由于您在所有联合中使用左连接，我建议进行不同的提取以避免瓶颈`SQL`并将结果合并到`PHP`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:11:10.760

UNION 子句可以更快，因为它会立即返回**不同的**记录（不会返回重复的记录），否则您需要在应用程序中执行此操作。此外，在这种情况下，它可能有助于减少流量。

从文档中：

> UNION 的默认行为是从结果中删除重复的行。可选的 DISTINCT 关键字除了默认值之外没有任何作用，因为它还指定重复行删除。使用可选的 ALL 关键字，不会删除重复行，结果包括所有 SELECT 语句中的所有匹配行。
> 
> 您可以在同一个查询中混合使用 UNION ALL 和 UNION DISTINCT。混合 UNION 类型的处理方式是 DISTINCT 联合覆盖其左侧的任何 ALL 联合。可以使用 UNION DISTINCT 显式生成 DISTINCT 联合，也可以使用不带 DISTINCT 或 ALL 关键字的 UNION 隐式生成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T16:20:18.763

从编程语言执行查询时，会发生以下步骤

1.  在应用程序和数据库之间创建连接（或从池中使用现有连接）
2.  查询被发送到数据库
3.  数据库发回结果
4.  连接被释放到池

如果您正在运行 N 次查询，上述步骤会发生 N 次，您可以猜到这肯定会减慢进程。所以理想情况下，我们应该尽可能减少查询的数量。

如果单个查询变得复杂并且难以维护并且需要大量时间来执行，那么将查询分成多个部分将是有意义的。在这种情况下，好的方法也是优化查询本身。

与您的情况一样，查询非常简单，并且正如有人指出联合还有助于删除重复行，最好的方法是使用 sql 查询而不是 php 代码。尝试优化技术，例如在表上创建适当的索引。

# opencv - opencv如何在高斯混合中存储矩阵值？按什么顺序？

> ID：11868531
> 
> 赞同：0
> 
> 时间：2012-08-08T16:00:19.713
> 
> 标签：opencv, background-image, gaussian, subtraction, background-subtraction

我搜索了“bgfg_gaussmix2.cpp”代码，它在高斯混合模型中说，它存储每个像素背景模型的每个高斯混合的混合权重（w）、平均值（nchannels 值）和协方差。我想知道它的存储顺序，比如是“权重、均值、协方差”，还是“均值、协方差、权重”，还是别的什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:46:42.257

如果您正在讨论高斯混合结构 CvPBGMMGaussian，则存储顺序为

1.  重量
2.  平均尺寸 1
3.  平均维度 2
4.  平均尺寸 3
5.  方差

这三个维度被打包在一个浮点数组中。这是这个结构的定义：

```
#define CV_BGFG_MOG2_NDMAX 3
typedef struct CvPBGMMGaussian
{
    float weight;
    float mean[CV_BGFG_MOG2_NDMAX];
    float variance;
}CvPBGMMGaussian 
```

如果您不是在谈论这种结构，请在您的问题中更加准确。

# matlab - 获取求解器类型和步长（对于固定步长求解器）

> ID：11868535
> 
> 赞同：4
> 
> 时间：2012-08-08T16:00:45.500
> 
> 标签：matlab, simulink

我们正在尝试将仿真模型作为一个模块集成到 Simulink 中。我们有一个自定义的连续块，它加载一个包含函数 Derivatives、Outputs 等的 m 文件。

我的问题是：有没有办法找出当前使用哪个求解器以及使用哪些参数？我们的模型将无法支持可变时间求解器，我想发出警告。同样，模型需要固定的步长进行初始化。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:14:30.010

您可以使用获取当前求解器名称

```
get_param('modelName', 'SolverName'); 
```

其他一些常见的求解器参数是

```
AbsTol
FixedStep
InitialStep
ZcThreshold
ExtrapolationOrder
MaxStep
MinStep
RelTol
SolverMode 
```

*您可以通过在您喜欢的文本编辑器中打开.mdl*文件并深入研究它来找到您可能希望查询的其他参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T00:45:24.913

如果我正确理解了您的用例，您正在尝试确定包含您的模块的顶级 simulink 系统的求解器类型（和其他求解器参数）。

我认为以下内容应该给你你想要的：

```
get_param(bdroot, 'SolverType');  % //Returns 'Variable-step' or 'Fixed-step'
get_param(bdroot, 'FixedStep');   % //Returns the fixed step size 
```

请注意，出于通用性/可重用性的目的，这使用[bdroot](http://www.mathworks.com/help/toolbox/simulink/slref/bdroot.html)来标识顶级系统（而不是明确指定此系统的名称）。

如果您想了解有关可以获取/设置的其他模型参数的更多信息，我会查看此[文档](http://www.mathworks.com/help/toolbox/simulink/slref/f23-7515.html)。

此外，我很想知道为什么您的模型不支持可变步长求解器？

# vim - Vim 内联重映射以检查第一个字符

> ID：11868538
> 
> 赞同：2
> 
> 时间：2012-08-08T16:00:54.260
> 
> 标签：vim, if-statement, inline, remap

我正在尝试使用内联在 Vim 中进行评论重新映射，`if`以检查它是否已被评论。这是我已经拥有的，当然它不起作用哈哈：

```
imap <c-c> <Esc>^:if getline(".")[col(".")-1] == '/' i<Delete><Delete> else i// endif 
```

我想要做的是检查第一个字符是否为 a `/`。如果是 a`/`则删除该行的前两个字符，如果不是 a则在该行前面`/`添加两个字符。`//`

我原来是这样的：

```
imap <c-c> <Esc>^i// 
```

这很有效，但我想要的是能够随心所欲地评论/取消评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:36:10.910

我完全同意@Peter Rincker 的回答警告不要在插入模式下执行此操作，并为您指出功能齐全的插件。

然而，我忍不住写了这个函数来精确地做你要求的事情。我发现用函数处理这种映射更容易。作为一个额外的好处，它可以让您在开始时所在行的同一位置返回插入模式（已通过插入或删除字符进行了移动）。

```
function! ToggleComment()
    let pos=getpos(".")
    let win=winsaveview()
    if getline(".") =~ '\s*\/\/'
        normal! ^2x
        let pos[2]-=1
    else 
        normal! ^i//
        let pos[2]+=3
    endif
    call winrestview(win)
    call setpos(".",pos)
    startinsert
endfunction   

inoremap <c-c> <Esc>:call ToggleComment()<CR> 
```

请注意`pos`确保光标返回到正确列的修改。该命令`startinsert`在此类函数中很有用，可返回插入模式。使用映射总是更安全`noremap`，除非有充分的理由不这样做。

这似乎工作得很好，但它不是很像 Vim，从长远来看，您可能会发现其他插件更灵活。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T16:28:26.677

vim 有很多评论插件：

*   [评论.vim](https://github.com/tpope/vim-commentary)
*   [t评论](http://www.vim.org/scripts/script.php?script_id=1173)
*   [增强评论](http://www.vim.org/scripts/script.php?script_id=23)
*   [书呆子评论者](http://www.vim.org/scripts/script.php?script_id=1218)
*   更多信息请访问[www.vim.org](http://www.vim.org)

我强烈建议您在决定推出自己的插件之前先看看这些插件。它将为您节省大量精力。

作为旁注，您通常希望在正常模式而不是插入模式下评论/取消评论。这不仅是 vim 的方式，而且还会提供更好的撤消历史记录。

如果您对创建自己的映射一无所知，我建议您创建一个函数来完成所有艰苦的工作，并让您的映射通过`:call`. 如果您认为可以使用不需要函数的简单逻辑，那么您可以使用表达式映射（请参阅 参考资料`:h map-<expr>`）。您可能希望组织成一个插件，因为它可能很大。如果是这种情况，请查看以`:h write-plugin`正确的方式编写插件的感觉。

用于切换评论的简单表达式映射示例：

```
nnoremap <expr> <leader>c getline(".") =~ '\m^\s*\/\/' ? '^"_2x' : 'I//<esc>`[' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T18:16:07.573

还有这个vimtip！ [http://vim.wikia.com/wiki/Comment/UnComment_visually_selected_text](http://vim.wikia.com/wiki/Comment/UnComment_visually_selected_text)

我用底部的

```
...
noremap <silent> ,c :<C-B>sil <C-E>s/^/<C-R>=escape(b:comment_leader,'\/')<CR>/<CR>:noh<CR>
noremap <silent> ,u :<C-B>sil <C-E>s/^\V<C-R>=escape(b:comment_leader,'\/')<CR>//e<CR>:noh<CR>

,c comments out a region
,u uncomments a region 
```

# orm - Symfony2-Doctrine：ManyToMany 双向关系

> ID：11868539
> 
> 赞同：1
> 
> 时间：2012-08-08T16:00:56.273
> 
> 标签：orm, symfony, doctrine-orm, many-to-many

在询问之前，我已经搜索了很多，甚至相关主题[Symfony2-Doctrine: ManyToMany relationship is not saved to database](https://stackoverflow.com/questions/7044864/symfony2-doctrine-manytomany-relation-is-not-saved-to-database) 但仍然没有答案。

我有这两个类：

```
class Intervenant extends User
{

/**
 * @ManyToMany(targetEntity="iMDEO\DISAASBundle\Entity\Domaine", inversedBy="intervenants", cascade={"persist","merge"})
 */
private $domaines;

/**
 * Add domaines
 *
 * @param Domaine $domaines
 */
public function addDomaine(Domaine $domaines)
{

    $this->domaines[] = $domaines;
}

/**
 * Get domaines
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getDomaines()
{
    return $this->domaines;
}
} 
```

```
class Domaine
{
// ...
/**
 * @ORM\ManyToMany(targetEntity="Intervenant", mappedBy="domaines", cascade={"persist","merge"})
 * 
 */
private $intervenants;

/**
 * Add intervenants
 *
 * @param Intervenant $intervenants
 */
public function addIntervenant(Intervenant $intervenants)
{

    $intervenants->addDomaine($this);
    $this->intervenants[] = $intervenants;
}

/**
 * Get intervenants
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getIntervenants()
{
    return $this->intervenants;
}
} 
```

当我保存一个`Intervenant`时，一切都很好。但是当我保存反面`Domaine`时，更改不会保留。

到处阅读 Symfony 的文档和主题，我找不到任何解决方案来获得我的两个实体之间的双向关系。

这是我的一部分`DomaineController`：

```
$em = $this->getDoctrine()->getEntityManager();
$entity = $em->getRepository('myBundle:Domaine')->find($id);
if (!$entity) {
    throw $this->createNotFoundException('Unable to find Domaine entity.');
}
$editForm   = $this->createForm(new DomaineType(), $entity);
$deleteForm = $this->createDeleteForm($id);
$request = $this->getRequest();
$editForm->bindRequest($request);

if ($editForm->isValid()) {
   $em->persist($entity);
   $em->flush();
   return $this->indexAction();
}

// ... 
```

我的目的是当我创建/编辑一个时`Intervenant`，我可以选择相关的`Domaine`。当我创建/编辑 a 时`Domaine`，我会链接`Intervenant`其中的每个 s。

请你帮助我好吗？

# android - 迷你应用安卓三星

> ID：11868540
> 
> 赞同：2
> 
> 时间：2012-08-08T16:00:56.490
> 
> 标签：android, android-intent

在玩新的三星平板电脑时，我注意到他们在菜单栏上有迷你应用程序，您可以像 Windows 机器一样覆盖您当前使用的任何应用程序。这是严格意义上的三星触控向导还是可以本地创建/开发的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T17:37:24.960

迷你应用栏/托盘图标是三星设计的功能。他们开发了它们。该功能与 Touch Wiz Laucher 本身无关（例如，您可以开发自己的 Launcher，小应用程序托盘会继续出现。

关于编写或修改这些功能：这是一个更复杂的问题，因为三星没有发布他们的 Android 版本，所以我们看不到实现了什么。

我认为您唯一能做的就是阻止或卸载出现在底部列表中的迷你应用程序。

希望这对您有所帮助。

# c# - 从 Oracle 函数返回数据？

> ID：11868551
> 
> 赞同：0
> 
> 时间：2012-08-08T16:01:29.910
> 
> 标签：c#, function, oracle11g

嗨，我在 Oracle 中创建了以下函数。我必须将 date-1 和 date-2 参数传递给函数，并且函数应该将另一个日期返回给我。

请看下面的代码。

```
create or replace function GETD(p_d1   in date, 
                                p_d2   in date ) return DATE 
   as 
       l_result    DATE; 
   begin 
    SELECT EDIT_Date into l_result FROM qa.employees  WHERE qa.employee_join_date BETWEEN TO_DATE(p_d1, 'MM/DD/YYYY') AND TO_DATE(p_d2, 'MM/DD/YYYY') AND ROWNUM <= 1
    ;
       return l_result; 
  end; 
```

我执行如下功能

```
SELECT GETD('27-JUN-12','28-JUN-12') FROM DUAL 
```

该函数被编译，当我传递参数以执行该函数时，我收到以下错误“不是有效月份”。有人可以告诉我我哪里出错了吗

谢谢贾斯汀

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:12:48.127

首先，您不应该调用`TO_DATE`日期变量。如果这样做，则强制 Oracle 首先使用会话将日期`NLS_DATE_FORMAT`转换为字符串，然后使用指定的格式掩码将字符串转换回日期。如果您`NLS_DATE_FORMAT`碰巧与指定的格式掩码不匹配（并且由于`NLS_DATE_FORMAT`由客户端控制，某些用户和会话将不可避免地具有不同的日期格式），您将收到错误消息。

假设您的意图只是忽略任何时间组件，那么您应该使用该`trunc`函数。

```
create or replace function GETD(p_d1   in date, 
                                p_d2   in date ) 
  return DATE 
as 
  l_result    DATE; 
begin 
  SELECT EDIT_Date 
    into l_result 
    FROM qa.employees  
   WHERE qa.employee_join_date BETWEEN trunc(p_d1) AND trunc(p_d2) 
     AND ROWNUM <= 1;

  return l_result; 
end; 
```

条件的存在`rownum <= 1`似乎有点奇怪——您似乎不太可能真的想从表中获取与`employee_join_date`条件匹配的任意行。在不知道要求的情况下，您似乎很可能想做一些确定性的事情来获取具有最小值（或最大值）的行`edit_date`。

其次，调用函数时，应该传入`DATE`参数而不是传入字符串，然后让 Oracle 使用会话的`NLS_DATE_FORMAT`. 如果您使用日期文字

```
SELECT GETD(date '2012-06-27', date '2012-06-28') 
  FROM DUAL 
```

或使用 a 将字符串显式转换为日期`TO_DATE`

```
SELECT GETD(to_date('27-JUN-12', 'DD-MON-RR'), to_date('28-JUN-12', 'DD-MON-RR')) 
  FROM DUAL 
```

那么无论客户的`NLS_DATE_FORMAT`.

# c# - FtpWebRequest 在大量上传时挂起

> ID：11868552
> 
> 赞同：1
> 
> 时间：2012-08-08T16:01:37.280
> 
> 标签：c#, ftpwebrequest

以下代码在 99% 的情况下都能正常工作。

但是，当我使用它复制包含大量文件的目录（一些单个文件也很大）时，它会挂起（没有抛出异常）并且任何进一步的 FTP 请求都会挂起，直到我回收代码的 IIS 7.5 应用程序池正在运行。（这用于基于 Web 的文件浏览器。）

它不会每次都挂在同一个文件上，实际上让我可以完全复制目录一次，但是如果我再试一次，它只会在复制一些文件和子目录后挂起。

我的问题是，任何人都可以看到代码的明显问题吗？是否存在未正确关闭的连接对象或其他什么？

顺便说一句，我尝试过（在 FtpCopyFile 方法中）刷新和关闭“uploadStream”对象以及实例化 FtpWebResponse 对象并随后关闭它。这些变化都没有任何区别。

如果代码没有明显的地方，有人可以推荐一种方法来追踪问题吗？由于没有抛出异常并且我在服务器日志中找不到任何内容（至少是我知道要查看的日志），所以我很茫然。

任何帮助将不胜感激！

饲料

```
public string FtpCopy(string fromUrl, string toUrl, bool isDirectory)
{
    string copyResult = "";

    // COPY ENTIRE DIRECTORY
    if (isDirectory) {
        // MAKE SURE TOP DIRECTORY IS CREATED
        if (!FtpDirectoryExists(toUrl)) { copyResult += FtpMakeDirectory(toUrl); }

        // ITERATE TROUGH ALL FILES AND FOLDERS AND COPY TO LIVE LOCATION
        Dictionary<string,Dictionary<string,string>> newItems = FtpRecursiveFileList(fromUrl);
        foreach (KeyValuePair<string,Dictionary<string,string>> item in newItems) {
            string currentFromUrl = item.Key;
            string currentToUrl = currentFromUrl.Replace(fromUrl, toUrl);
            if(item.Value["isdirectory"] == "true") { copyResult += FtpMakeDirectory(currentToUrl); }
            else { copyResult += FtpCopyFile(currentFromUrl, currentToUrl); }
        }

    // COPY SINGLE FILE
    } else { copyResult = FtpCopyFile(fromUrl, toUrl); }

    string returnString = "";
    if (copyResult == "") { returnString = "Success"; }
    else { returnString = "Error: " + copyResult; }

    return returnString;
}

private string FtpMakeDirectory(string url) {
    string returnString = "";

    // PARSE URL
    url = url.TrimEnd('/') + "/";
    string[] urlPath = Jbu.Util.UrlToStringArray(url, FTP_PATH_PREFIX);
    string currentPath = FTP_PATH_PREFIX + urlPath[0];

    // LOOP THROUGH EACH DIRECTORY LEVEL OF PATH
    for (int i = 1; i < (urlPath.Length - 1); i++) {
        currentPath = currentPath + "/" + urlPath[i];
        string[] currentFiles = FtpListDirectoryArray(currentPath);
        bool found = false;
        if (currentFiles != null) {
            // LOOK IN CURRENT DIRECTORY FOR DIRECTORY THAT HAS SAME NAME AS NEXT LOOP'S DIRECTORY
            for (int j = 0; j < currentFiles.Length; j++) {
               if (currentFiles[j] == urlPath[i + 1]) { found = true; }
            }
        }
        // IF NAME NOT FOUND, CREATE DIRECTORY
        if(!found) { returnString += FtpResponseAsString(CreateFtpRequest(currentPath + "/" + urlPath[i + 1], "makedirectory")); }
    }

    return returnString;
}

private string FtpCopyFile(string fromUrl, string toUrl)
{
    string returnString = "";
    try {
        // GET FILE TO BE COPIED
        FtpWebRequest ftpDownloadRequest = CreateFtpRequest(fromUrl, "downloadfile");
        System.Net.FtpWebResponse downloadResponse = (System.Net.FtpWebResponse)ftpDownloadRequest.GetResponse();
        Stream ftpDownloadStream = downloadResponse.GetResponseStream();
        byte[] fileByteArray = Jbu.Util.StreamToByteArray(ftpDownloadStream);
        ftpDownloadStream.Close();

        // CREATE DIRECTORY, IF NEEDED
        string containingDirectory = toUrl.Substring(0,toUrl.LastIndexOf('/'));
        if (!FtpDirectoryExists(containingDirectory)) { returnString += FtpMakeDirectory(containingDirectory); }

        // UPLOAD FILE TO NEW LOCATION
        FtpWebRequest ftpUploadRequest = CreateFtpRequest(toUrl, "uploadfile");
        ftpUploadRequest.ContentLength = fileByteArray.Length;
        using (Stream uploadStream = ftpUploadRequest.GetRequestStream()) { uploadStream.Write(fileByteArray, 0, fileByteArray.Length); }

    } catch (Exception ex) { returnString += "Error: " + ex.ToString(); }

    return returnString;
}

private FtpWebRequest CreateFtpRequest(string url, string method)
{
    // CREATE REQUEST OBJECT
    ServicePointManager.ServerCertificateValidationCallback = (Object obj, X509Certificate certificate, X509Chain chain, SslPolicyErrors errors) => (certificate.Subject.Contains("CN=" + Jbu.Constant.FTP_CERT_DOMAIN));
    FtpWebRequest ftpRequest = (FtpWebRequest)FtpWebRequest.Create(new Uri(url));
    ftpRequest.EnableSsl = true;
    ftpRequest.Credentials = new NetworkCredential(Jbu.Constant.FTP_USER, Jbu.Constant.FTP_PASSWORD);
    ftpRequest.UseBinary = true;
    ftpRequest.KeepAlive = false;

    // SET METHOD
    switch(method) {
        case "listdirectory": ftpRequest.Method = WebRequestMethods.Ftp.ListDirectory; break;
        case "listdirectorydetails": ftpRequest.Method = WebRequestMethods.Ftp.ListDirectoryDetails; break;
        case "makedirectory": ftpRequest.Method = WebRequestMethods.Ftp.MakeDirectory; break;
        case "removedirectory": ftpRequest.Method = WebRequestMethods.Ftp.RemoveDirectory; break;
        case "downloadfile": ftpRequest.Method = WebRequestMethods.Ftp.DownloadFile; break;
        case "uploadfile": ftpRequest.Method = WebRequestMethods.Ftp.UploadFile; break;
        case "deletefile": ftpRequest.Method = WebRequestMethods.Ftp.DeleteFile; break;
        case "getdatetimestamp": ftpRequest.Method = WebRequestMethods.Ftp.GetDateTimestamp; break;
        default: break;
    }

    return ftpRequest;
}

private bool FtpDirectoryExists(string url)
{
    bool dirExists = true;
    try {
        FtpWebRequest ftpRequest = CreateFtpRequest(url + "/", "listdirectory");
        FtpWebResponse ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();
    } catch { dirExists = false; }
    return dirExists;
}

private Dictionary<string,Dictionary<string,string>> FtpRecursiveFileList(string url)
{
    Dictionary<string,Dictionary<string,string>> returnList = new Dictionary<string,Dictionary<string,string>>();

    List<string> files = new List<string>();
    Queue<string> folders = new Queue<string>();
    folders.Enqueue(url);

    while (folders.Count > 0) {
        string fld = folders.Dequeue();
        Dictionary<string,Dictionary<string,string>> newItems = FtpListDirectoryDetailsArray(fld);
        foreach(KeyValuePair<string,Dictionary<string,string>> item in newItems) {
            returnList.Add(fld + "/" + item.Key, item.Value);
            if(item.Value["isdirectory"] == "true") {
                folders.Enqueue(fld + "/" + item.Key);
            }
        }
    }
    return returnList;
}

private string[] FtpListDirectoryArray(string ftpPath)
{
    FtpWebRequest ftpRequest = CreateFtpRequest(ftpPath, "listdirectory");
    List<string> items = new List<string>();

    try {
        FtpWebResponse ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();

        Stream responseStream = ftpResponse.GetResponseStream();
        using (StreamReader responseReader = new StreamReader(responseStream)) {
            string line;
            while ((line = responseReader.ReadLine()) != null) { items.Add(line); }
        }

    } catch { return null; }

    string[] itemData = new string[items.Count];
    for (int i = 0; i < items.Count; i++) { itemData[i] = items[i]; }
    return itemData;
}

private Dictionary<string,Dictionary<string,string>> FtpListDirectoryDetailsArray(string ftpPath)
{
    Dictionary<string,Dictionary<string,string>> items = new Dictionary<string,Dictionary<string,string>>();

    FtpWebRequest ftpRequest = CreateFtpRequest(ftpPath, "listdirectorydetails");

    try {
        FtpWebResponse ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();
        Stream responseStream = ftpResponse.GetResponseStream();
        using (StreamReader responseReader = new StreamReader(responseStream)) {
            string line;
            while ((line = responseReader.ReadLine()) != null) {
                Dictionary<string,string> item = new Dictionary<string,string>();
                line = System.Text.RegularExpressions.Regex.Replace(line, @"\s+", " "); // REMOVE EXTRA SPACES
                string[] itemDetails = line.Split(' ');
                item.Add("datetime", itemDetails[0] + " " + itemDetails[1]);

                // FOLDERS
                if (itemDetails[2] == "<DIR>") {
                    item.Add("isdirectory", "true");
                    item.Add("size", "-1");
                    item.Add("name", itemDetails[3]);

                } else {
                    item.Add("isdirectory", "false");
                    item.Add("size", itemDetails[2]);
                    item.Add("name", itemDetails[3]);
                }

                items.Add(itemDetails[3], item);
            }
        }

    // IF DIRECTORY DOES NOT EXIST, RETURN EMPTY DICT
    } catch {};

    return items;
}

private string FtpResponseAsString(FtpWebRequest ftpRequest)
{
    try {
        FtpWebResponse ftpResponse = (FtpWebResponse)ftpRequest.GetResponse();
        Stream responseStream = ftpResponse.GetResponseStream();
        StreamReader responseReader = new StreamReader(responseStream);
        return responseReader.ReadToEnd();

    } catch (Exception ex) { return "Error: " + ftpRequest.RequestUri + "\n\n" + ex.ToString(); }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T20:58:48.530

终于找到问题了！

“FtpWebRequest.KeepAlive = 假；” 确实有效，但清除关闭的连接需要一点时间。

所以发生的事情是我的最大连接数被击中。（显然也有一个 .NET 最大值，因为我在 IIS 中的 maxconnections 已经设置得非常高。）

将此行添加到 CreateFtpConnection 方法通过给 IIS 足够的时间来关闭旧连接并为更多连接腾出空间来解决问题： ftpRequest.ServicePoint.ConnectionLimit = 1000;

您的具体里程很可能会根据您的文件大小而有所不同，但希望这会对某人有所帮助。

作为记录，这里是 CreateFtpConnection 现在的样子：

```
private FtpWebRequest CreateFtpRequest(string url, string method)
{
    // CREATE REQUEST OBJECT
    ServicePointManager.ServerCertificateValidationCallback = (Object obj, X509Certificate certificate, X509Chain chain, SslPolicyErrors errors) => (certificate.Subject.Contains("CN=" + Jbu.Constant.FTP_CERT_DOMAIN));
    FtpWebRequest ftpRequest = (FtpWebRequest)FtpWebRequest.Create(new Uri(url));
    ftpRequest.EnableSsl = true;
    ftpRequest.Credentials = new NetworkCredential(Jbu.Constant.FTP_USER, Jbu.Constant.FTP_PASSWORD);
    ftpRequest.UseBinary = true;
    ftpRequest.KeepAlive = false;
    ftpRequest.ServicePoint.ConnectionLimit = 1000;

    // SET METHOD
    switch(method) {
        case "listdirectory": ftpRequest.Method = WebRequestMethods.Ftp.ListDirectory; break;
        case "listdirectorydetails": ftpRequest.Method = WebRequestMethods.Ftp.ListDirectoryDetails; break;
        case "makedirectory": ftpRequest.Method = WebRequestMethods.Ftp.MakeDirectory; break;
        case "removedirectory": ftpRequest.Method = WebRequestMethods.Ftp.RemoveDirectory; break;
        case "downloadfile": ftpRequest.Method = WebRequestMethods.Ftp.DownloadFile; break;
        case "uploadfile": ftpRequest.Method = WebRequestMethods.Ftp.UploadFile; break;
        case "deletefile": ftpRequest.Method = WebRequestMethods.Ftp.DeleteFile; break;
        case "getdatetimestamp": ftpRequest.Method = WebRequestMethods.Ftp.GetDateTimestamp; break;
        default: break;
    }

    return ftpRequest;
} 
```

# jquery - 更改表单提交的行为

> ID：11868553
> 
> 赞同：1
> 
> 时间：2012-08-08T16:01:41.660
> 
> 标签：jquery, forms, anchor, modal-dialog

我在我的主页上使用了一个基本表单，它收集了用户的电子邮件地址。没有提交按钮，而是一个启动模式框的锚链接。（用户输入的电子邮件地址用于模态内容）

当用户填写表单电子邮件输入时，他们的自然本能是按回车或单击“提交”链接。通过启动模式，提交链接非常有用，但按 Enter 将尝试提交表单。我不希望用户提交表单，而是通过按下锚链接启动模式。

**有没有办法：**

A) 更改 enter 的默认行为以启动模式与提交表单？

或者

B) 禁用 Enter 按钮提交表单并强制用户单击锚链接？

* * *

我使用的是[leanmodal](http://leanmodal.finelysliced.com.au/?#)，它非常简单，语法如下：

```
<a href="#newsForm" rel="leanModal" class="submitModal">Submit</a>

<div id="#newsForm">Modal content here</div> 
```

***注意：**我不能将提交输入用作“模态启动器”，因为模态与输入不兼容。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:08:54.620

我宁愿推荐这样的东西。

```
$(function() {
    $('#newsForm').submit(function( jqEvt ) {
        jqEvt.preventDefault();
        $('.submitModal').click();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:05:22.737

**A）**更改 enter 的默认行为以启动模式与提交表单：

```
$(function(){
    $(document).on('keyup', function(e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if(code == 13) { //Enter keycode
            //If user press enter will open the modal
            $('.submitModal').click();
        }
    });
});​ 
```

**B)**禁用 Enter 按钮提交表单并强制用户单击锚链接。

```
$(function(){
    $(document).on('keyup', function(e) {
        var code = (e.keyCode ? e.keyCode : e.which);
        if(code == 13) { //Enter keycode
            //Stop the "submit", nothing will happen when user press enter
            e.preventDefault();
        }
    });
});​ 
```

**C）另一种选择：**您可以通过执行以下操作“覆盖”该`submit();`功能：

```
$(function() {
    $('#newsForm').submit(function(e) {
        $('.submitModal').click();
        e.preventDefault();
    });
}); 
```

# asp.net - 如何跟踪传出的 httpwebrequest

> ID：11868559
> 
> 赞同：1
> 
> 时间：2012-08-08T16:02:02.843
> 
> 标签：asp.net, c#-4.0

我正在向远程服务器发送 HttpWebRequest。远程服务器拒绝我的请求。

如何在不使用wireshark或类似的东西的情况下捕获我的传出请求的原始格式？

我尝试将 Trace="true" TraceMode="SortByTime" 添加到 aspx 页面，但这似乎只捕获传入的请求。

我尝试[按照这篇文章](https://stackoverflow.com/questions/3900381/get-request-text)启用跟踪，但它似乎没有在任何地方生成日志文件。network.log 会在站点的根目录中吗？它不在那里，我已经在我的电脑/网站上搜索了它。

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:03:58.210

你为什么不使用像[Fiddler](http://www.google.co.in/url?sa=t&rct=j&q=download%20fiddler&source=web&cd=1&ved=0CFAQFjAA&url=http://www.fiddler2.com/fiddler2/version.asp&ei=t40iUKO1JYPirAeitIG4AQ&usg=AFQjCNE9h32pBsq5Nv000r2subMLAXwJ4A)这样的工具。您将能够看到整个包装

# php - 在 wordpress 中更改 slug 时出现致命错误

> ID：11868560
> 
> 赞同：0
> 
> 时间：2012-08-08T16:02:07.120
> 
> 标签：php, wordpress, wordpress-theming, permalinks, slug

我想用自定义字段更改帖子的 slug。

例如，如果自定义字段是“关键字”，我的帖子链接将变为：mysite.com/keyword。

我在 fonction.php 中编写了这个脚本：

```
function change_default_slug($id) {

    // get part number
    $partno = get_post_meta( $id, 'partno', true );
    $post_to_update = get_post( $id );

    // prevent empty slug, running at every post_type and infinite loop
    if ( $partno == '' )
        return;

    $updated_post = array();
    $updated_post['ID'] = $id;
    $updated_post['post_name'] = $partno;
    wp_update_post( $updated_post ); // update newly created post

}
add_action('save_post', 'change_default_slug');
add_action( 'add_meta_boxes', 'cd_meta_box_add' );
function cd_meta_box_add()
{
    add_meta_box( 'my-meta-box-id', 'My First Meta Box', 'cd_meta_box_cb', 'post', 'normal', 'high' );
}

function cd_meta_box_cb( $post )
{
    $values = get_post_custom( $post->ID );
    $text = isset( $values['my_meta_box_text'] ) ? esc_attr( $values['my_meta_box_text'][0] ) : '';
    wp_nonce_field( 'my_meta_box_nonce', 'meta_box_nonce' );
    ?>
    <p>
        <label for="my_meta_box_text">Text Label</label>
        <input type="text" name="my_meta_box_text" id="my_meta_box_text" value="<?php echo $text; ?>" />
    </p>
    <?php   
}
add_action( 'save_post', 'cd_meta_box_save' );
function cd_meta_box_save( $post_id )
{
    // Bail if we're doing an auto save
    if( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return;

    // if our nonce isn't there, or we can't verify it, bail
    if( !isset( $_POST['meta_box_nonce'] ) || !wp_verify_nonce( $_POST['meta_box_nonce'], 'my_meta_box_nonce' ) ) return;

    // if our current user can't edit this post, bail
    if( !current_user_can( 'edit_post' ) ) return;

    // now we can actually save the data
    $allowed = array( 
        'a' => array( // on allow a tags
            'href' => array() // and those anchords can only have href attribute
        )
    );

    // Probably a good idea to make sure your data is set
    if( isset( $_POST['my_meta_box_text'] ) )
        update_post_meta( $post_id, 'my_meta_box_text', wp_kses( $_POST['my_meta_box_text'], $allowed ) );
}
 $partno = get_post_meta($post->ID,'my_meta_box_text',true);
 echo $partno; 
```

该脚本返回“致命错误：超过 30 秒的最大执行时间”。但它似乎有效，因为我的 slug 改变了。对这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:30:40.063

'save_post' 操作由 调用`wp_update_post()`，因此您的`change_default_slug()`函数会导致无限循环。`change_default_slug()`如果该函数已被调用，您需要在内部执行检查并退出：

```
function change_default_slug($id) {
    static $beentheredonethat = false;
    if ($beentheredonethat) return;
    $beentheredonethat = true;
    //do your stuff and save the post...
} 
```

# c++ - 从基础转换的派生对象是否需要使用 vtable

> ID：11868563
> 
> 赞同：-1
> 
> 时间：2012-08-08T16:02:22.503
> 
> 标签：c++, visual-c++, inheritance, compilation

如果我在派生类实例上调用继承方法，代码是否需要使用 vtable？或者方法调用可以是“静态的”（不确定这是否是该词的正确用法）

例如：

```
Derived derived_instance;
derived_instance.virtual_method_from_base_class(); 
```

我正在使用 msvc，但我猜大多数主要编译器都以大致相同的方式实现这一点。

我（现在）知道该行为是特定于实现的，我对实现感到好奇。

编辑：

我应该补充一点，我们感兴趣的原因是该函数被调用了很多次，而且非常简单，而且我不允许以任何方式编辑函数本身，我只是想知道是否可以，以及无论如何消除动态调度是否有任何好处。

在你们都支持我的优化之前，我已经对功能等进行了分析和计算。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:08:12.323

*您的两个示例*都需要`Derived`具有接受 a 的构造函数`Base`并创建. 假设您有这样一个构造函数并且这是您想要的，那么编译器将“可能”能够静态确定动态对象类型并避免虚拟调用（如果它决定进行此类优化）。*`Derived`*

 *请注意，行为不是未定义的，它只是特定于实现的。两者之间有很大的不同。

如果您想避免创建新实例（或者，更有可能，这不是您想要的），那么您可以使用引用强制`static_cast<Derived&>(base_instance).virtual_method_from_base_class();`转换，但是虽然这可以避免创建新对象，但它不允许您避免虚拟调用。

如果您真的想在编译时进行转换，那么您正在寻找的很可能是 CRTP [http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)，它允许您在编译时键入所有内容，避免虚拟调用。

编辑更新的问题：在您现在展示的情况下，我怀疑许多编译器能够静态确定动态类型并避免虚拟调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:07:08.037

Vtable 仅在您使用指针或引用时发挥作用。对于对象，它总是被调用的特定类方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:31:40.983

您可以简单地限定调用，然后没有虚函数调度：

```
Derived derived_instance;
derived_instance.Derived::virtual_method_from_base_class(); 
```

但是，我怀疑那将是*过早的优化*。

做**测量**。*

# iphone - Facebook requestWithGraphPath:andParams:andHttpMethod:andDelegate

> ID：11868568
> 
> 赞同：0
> 
> 时间：2012-08-08T16:02:36.263
> 
> 标签：iphone, ios, facebook

我设法使用 facebook 登录并设法获得一个活跃的会话.... 但是我正在尝试将照片发布到 facebook 或向 facebook 发布消息。你能告诉我我做得对吗？它似乎不起作用，因为我看不到任何东西贴在我的墙上。

```
 UIImage *image = combinedImage;
    NSString *strMessage = @"Check out my photo";
    NSMutableDictionary* params = [NSMutableDictionary dictionary];
    [params setObject:strMessage forKey:@"message"];
    if (image) {
        [params setObject:image forKey:@"picture"];
        [facebook requestWithGraphPath:@"me/photos" andParams:params
                   andHttpMethod:@"POST"
                     andDelegate:self];
    } else {
        [facebook requestWithGraphPath:@"me/feed" andParams:params
                   andHttpMethod:@"POST"
                     andDelegate:self];
    } 
```

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:03:54.987

我认为图像参数的关键应该是@"source" 而不是@"picture"。请求调用和路径似乎没问题。

`[params setObject:image forKey:@"source"];`

# jquery - 使用 CAML 从图片库中获取图像的 URL

> ID：11868571
> 
> 赞同：0
> 
> 时间：2012-08-08T16:02:39.660
> 
> 标签：jquery, sharepoint, caml, sharepoint-list

如何使用 CAML 获取存储在图片库中的图像的 URL？

目前，我已经创建了一个 CAML 查询并在[U2U CAML 查询生成器](http://www.u2u.be/res/tools/camlquerybuilder.aspx)中运行它，并且看到了存储图像 URL 的 、 和 -- 字段`ows_LinkFilename`等值`ows_LinkFilenameNoMenu`。`ows_LinkFilename2`（它们包含我需要的 - image.jpg 或 image2.gif 等）当我实现它并在该字段中输出值时，我得到一个“未定义”。

是否甚至可以仅从文件本身访问 URL？我是否需要将图片库中的必填字段之一设为图片名称？（图片.jpg）

下面是 jQuery 的一个片段。

```
var fieldsToRead =     "<ViewFields>" +
                                "<FieldRef Name='ows_LinkFilename' />" +
                                "<FieldRef Name='ID' />" +
                            "</ViewFields>";

        var query = "<Query>" +
                        "<Where>" +
                            "<IsNotNull>" +
                                "<FieldRef Name='ID' />" +
                            "</IsNotNull>" +
                        "</Where>" +
                        "<OrderBy>" +
                        "<FieldRef Name='Display_x0020_Order' Ascending='True' />" +
                        "</OrderBy>" +
                    "</Query>";

         $().SPServices({
                operation: method,
                async: false,
                webURL: rootURL,
                listName: list,
                CAMLViewFields: fieldsToRead,
                  CAMLQuery: query,
                    completefunc: function (xData, Status) {
                        $(xData.responseXML).SPFilterNode("z:row").each(function() {
                            var name = ($(this).attr("ows_LinkFilename"));

                console.log(name); 
```

非常感谢你的帮助。

AA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T14:06:57.790

通过使用`"<FieldRef Name='EncodedAbsUrl' />"`，然后用`var url = ($(this).attr("ows_EncodedAbsUrl"));`代替`var name = ($(this).attr("ows_LinkFilename"));`，它会拉取图像的整个 URL。

# msbuild - TopShelf MSDeploy 安装退出代码出错

> ID：11868573
> 
> 赞同：3
> 
> 时间：2012-08-08T16:02:41.470
> 
> 标签：msbuild, topshelf

我正在尝试使用 CI 的 TopShelf 安装服务。但是，无论何时在安装过程中发生异常，TopShelf 都会回滚事务并继续构建过程，并返回 0x0 状态。

这意味着就 CI 服务器而言，部署是成功的。

我在 MSBuild 中使用的命令示例是：

```
<Message Text ="Installing Service" />
<Exec Command=""$(MSDeployPath)" -verb:sync -source:runCommand="$(RemoteServicePath) install /instance:$(DeployEnvironment)",dontUseCommandExe=false,waitAttempts=10,waitInterval=10000 -dest:auto,computername=%(ComputerName) -verbose -retryInterval:10000 -retryAttempts:10"></Exec> 
```

我收到的输出是：

```
[Exec] Running a transacted installation. <br>
[Exec] <br>
[Exec] Verbose: Received response from agent (HTTP status 'OK'). <br>
[Exec] Info: <br>
[Exec] Beginning the Install phase of the installation. <br>
[Exec] <br>
[Exec] Info: Installing service Foo...<br>
[Exec] <br>
[Exec] Info: Creating EventLog source Foo in log Application...<br>
[Exec] <br>
[Exec] Info: <br>
[Exec] An exception occurred during the Install phase.<br>
[Exec] <br>
[Exec] Info: System.ComponentModel.Win32Exception: The specified service already exists<br>
[Exec] <br>
[Exec] The Rollback phase of the installation is beginning.<br>
[Exec] Restoring event log to previous state for source Foo.<br>
[Exec] <br>
[Exec] The Rollback phase completed successfully.<br>
[Exec] <br>
[Exec] The transacted install has completed.<br> 
```

有什么想法可以使构建在异常上失败吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T14:17:12.533

最新版本的 Topshelf (3.0.2) 添加了 TopshelfExitCode，它是一个枚举，可以转换为 (int) 并从控制台应用程序中的 Main 返回。

如果安装/卸载失败，则错误代码非零（枚举具有所有可能的值）。所以现在它应该与批处理文件/构建很好地配合，当事情没有正确安装时，期望非零退出代码。

# javascript - 我们如何在 phonegap 项目中的 android 的默认媒体播放器上播放 youtube 视频

> ID：11868574
> 
> 赞同：0
> 
> 时间：2012-08-08T16:02:43.987
> 
> 标签：javascript, android, cordova

使用插件我可以在默认媒体播放器上播放所有视频（来自 youtube 的视频除外）。但 youtube 视频仅在 android youtube 应用程序中播放。

```
 private void playVideo(String url) throws IOException {
    // Create URI
    Uri uri = Uri.parse(url);

    Intent intent = null;
    // Check to see if someone is trying to play a YouTube page.
    if (url.contains(YOU_TUBE)) {
        // If we don't do it this way you don't have the option for youtube
        uri = Uri.parse("vnd.youtube:" + uri.getQueryParameter("v"));
        intent = new Intent(Intent.ACTION_VIEW, uri);
    } else if(url.contains(ASSETS)) {
        // get file path in assets folder
        String filepath = url.replace(ASSETS, "");
        // get actual filename from path as command to write to internal storage doesn't like folders
        String filename = filepath.substring(filepath.lastIndexOf("/")+1, filepath.length());

        // Don't copy the file if it already exists
        File fp = new File(this.cordova.getActivity().getFilesDir() + "/" + filename);
        if (!fp.exists()) {
            this.copy(filepath, filename);
        }

        // change uri to be to the new file in internal storage
        uri = Uri.parse("file://" + this.cordova.getActivity().getFilesDir() + "/" + filename);

        // Display video player
        intent = new Intent(Intent.ACTION_VIEW);
        intent.setDataAndType(uri, "video/*");
    } else {
        // Display video player
        intent = new Intent(Intent.ACTION_VIEW);
        intent.setDataAndType(uri, "video/*");
    }

    this.cordova.getActivity().startActivity(intent);
} 
```

# python - 损坏的 numpy/scipy 安装（python，ubuntu 10.04）

> ID：11868579
> 
> 赞同：2
> 
> 时间：2012-08-08T16:03:00.550
> 
> 标签：python, numpy, scipy, ubuntu-10.04

我得到的错误如下：

```
$ python -c 'from sklearn import preprocessing'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/usr/local/lib/python2.6/dist-packages/scikit_learn-0.10-py2.6-linux-x86_64.egg/sklearn/preprocessing/__init__.py", line 17, in <module>
  from ..utils.sparsefuncs import inplace_csr_row_normalize_l1
  File "numpy.pxd", line 174, in init sklearn.utils.sparsefuncs (sklearn/utils/sparsefuncs.c:4605)
ValueError: numpy.ndarray has the wrong size, try recompiling 
```

我认为这是一个错误`numpy`而不是`scikitlearn`（见[这里](https://github.com/scikit-learn/scikit-learn/issues/433)）

我正在使用 git clone 的开发版本`scipy`并`numpy`安装（它工作正常）。但是我需要“降级”到稳定版本才能发布。所以我删除了 git 文件夹，并从`/usr/local/lib/python-2.6/`. （为了安全起见）然后我做了：

```
$ sudo apt-get install libblas-dev liblapack-dev
$ sudo apt-get install python-dev python-numpy python-scipy
$ sudo easy_install -U distribute
$ sudo easy_install -U numpy
$ sudo easy_install -U scipy 
```

最后两个都给了我警告...

```
RuntimeWarning: Parent module 'numpy.distutils' not found while handling absolute import 
```

...我不确定这是否是这里出了问题？

```
$ python -c 'import numpy; print numpy.__version__'
1.6.2

$ python -c 'import scipy; print scipy.__version__'
0.10.1 
```

我试过删除 apt 安装的版本，但这似乎没有帮助。`2.6.32-21-server`这是带有内核的 Ubuntu 10.04 (lucid)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:48:58.497

我建议安装 Enthought Python Distribution。它是免费的，安装在 Ubuntu 10.04 上，并附带 Numpy、Scipy、matplotlib 等。

[http://www.enthought.com/products/epd_free.php](http://www.enthought.com/products/epd_free.php)

# python - 适用于 PostgreSQL 和 MySQL 的纯 Python SQL 解决方案？

> ID：11868582
> 
> 赞同：3
> 
> 时间：2012-08-08T16:03:02.950
> 
> 标签：python, mysql, postgresql

我正在寻找一个可以访问 MySQL 和 PostgreSQL 的纯 Python SQL 库。

唯一的要求是在 Python 2.5+ 上运行并且是纯 Python，因此它可以包含在脚本中并且仍然可以在大多数平台上运行（无需安装）。

事实上，我正在寻找一个简单的解决方案，它允许我编写 SQL 并将结果导出为 CSV 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T17:39:40.567

两部分答案：

A）这是绝对可能的。

B）根据您的具体问题，纯python 可能是解决问题的好方法，也可能不是。

解释：

该`SqlAlchemy`库带有两个组件：更流行的“ORM”和它位于其之上的“Core”。任何一种都可以让您以 SqlAlchemy 格式（即 Python）编写 SQL 命令；然后 SqlAlchemy 会将语句编译到 Mysql 或 PostgreSQL 并连接到适当的数据库。

SqlAlchemy 是一个很棒的库，我推荐它用于几乎所有的东西。虽然您确实必须以它们的格式编写语句，但它很容易上手——并且您可以随时切换到您想要的几乎任何底层数据库库。无论您是否需要支持多个后端，它都是在任何数据库项目中使用的完美平台。

SqlAlchemy 通过标准 DBAPI 驱动程序与数据库对话，并且确实支持纯 python 的多个选项，特别是`pymysql`和`pypostgresql`驱动程序（[http://docs.sqlalchemy.org/en/latest/core/engines.html#supported-dbapis](http://docs.sqlalchemy.org/en/latest/core/engines.html#supported-dbapis)）

至于编写 csv，标准库已经涵盖了。

```
import csv 
```

所以警告？

以下可能适用于您的情况，也可能不适用于您的情况：

python 世界中大多数更高级别的数据库模块仍然推荐 mysql-python 和 psycopg——它们都不是纯 python 并且针对已安装的数据库进行编译/链接/配置。与在 CPython 下运行时的 c-extensions 相比，这在很大程度上似乎来自 API / 集成问题的混合以及各种纯 Python 包的速度。

有像我推荐的纯 python 驱动程序，但大多数评论者表示它们主要是实验性的。pymysql 作者声称稳定性和生产就绪性，一些博客开发人员对此提出了挑战。至于“稳定”或“实验”的含义，因项目而异。有些有不断变化的 API，有些不完整，有些是错误的。

您需要确保可以为每个支持您需要的确切操作的系统找到纯 python 驱动程序。这可能很简单，也可能很混乱。无论您使用 SqlAlchemy 还是其他工具，在选择 DBAPI 驱动程序时，您仍然会面临这个问题。

PyPy 项目（pure-python python 解释器）有一个 wiki，列出了各种包的兼容性：[https](https://bitbucket.org/pypy/compatibility/wiki/Home) ://bitbucket.org/pypy/compatibility/wiki/Home 我会听从他们的具体驱动建议。如果 PyPy 是您想要的平台，那么 SqlAlchemy 也可以在其上完美运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T17:05:53.090

您是在寻找一个 ORM，还是一个允许您直接编写 SQL 语句并在存在差异的地方进行转换的库？

我不确定 psycopg2 是否是纯 python，但它肯定有绑定并且适用于所有平台。您仍然必须至少安装 psycopg2 才能与 PostgreSQL 数据库通信，因为 Python（据我所知）本身并不附带它。

从那里开始，还需要安装您想要的任何其他 ORM 库，但大多数都是在他们使用的任何后端之上的纯 python。

Storm、Django、SQLAlchemy 在它们的数据库层之上都有抽象层——根据你的描述，Django 可能是一个太大的框架，无法满足你的需求（对我来说），但它是一个流行的框架，SQLAlchemy 是一个久经考验的真正系统—— tho 有点笨拙，特别是如果你必须处理继承（在我看来）。我听说 Storm 很好，但我没有用它做太多测试，所以我不能完全说。

如果您希望混合和匹配（MySQL 中的一些表和 PostgreSQL 中的一些表）与可能是 MySQL 或 PostgreSQL 的单个数据库，我一直在研究一个名为 ORB 的 ORM，它更侧重于面向对象的设计并允许多个数据库和数据库之间的关系。现在它只支持 PostgreSQL 和 Mongo，只是因为我不需要 MySQL，但我愿意编写那个后端。代码可以在[http://docs.projexsoftware.com/api/orb找到](http://docs.projexsoftware.com/api/orb)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T17:45:18.483

使用 SQL 炼金术。它适用于大多数数据库类型，当然也适用于 postgres 和 MySQL。

# knockout.js - Knockout.js - 不能包装 'with'、'foreach' 和其他模板绑定

> ID：11868585
> 
> 赞同：4
> 
> 时间：2012-08-08T16:03:12.500
> 
> 标签：knockout.js, knockout-2.0

我正在尝试创建一个包含现有绑定的自定义绑定，即内置于 Knockout 中的“with”或“foreach”绑定。

不幸的是，这样做我收到以下错误：`Uncaught TypeError: Cannot call method 'createChildContext' of undefined`from [knockout-latest.debug.js:3060](https://github.com/SteveSanderson/knockout/blob/master/build/output/knockout-latest.debug.js#L3060)（该问题也出现在版本 2.1.0 上）。

我已经使用 Google Chrome 21.0.1180.57[在 jsFiddle 上重现了异常。](http://jsfiddle.net/bmh_ca/48uJg/1/)

自定义绑定简单定义如下：

```
ko.bindingHandlers.myWith = {
    init: function(element, valueAccessor, allBindings, viewModel) {
        // do things
        return ko.bindingHandlers.with.init(element, valueAccessor,
                                            allBindings, viewModel);
    },

    update: function(element, valueAccessor, allBindings, viewModel) {
        return ko.bindingHandlers.with.update(element, valueAccessor, 
                                              allBindings, viewModel); 
    }
}; 
```

人们希望能够使用上述表单中的简单处理程序“包装”现有绑定，[就像本文中讨论的那样](http://www.knockmeout.net/2011/07/another-look-at-custom-bindings-for.html)。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T16:28:24.337

在 KO 2.0 中，绑定处理程序实际上接受了第 5 个参数，即绑定上下文。绑定上下文包含诸如`$data`, `$parent`, `$parents`,之类的东西`$root`。

因此，您只需要转发该参数即可：

```
ko.bindingHandlers.myWith = {
    init: function(element, valueAccessor, allBindings, viewModel, context) {
        // do things
        return ko.bindingHandlers.with.init(element, valueAccessor,
                                            allBindings, viewModel, context);
    },

    update: function(element, valueAccessor, allBindings, viewModel, context) {
        return ko.bindingHandlers.with.update(element, valueAccessor, 
                                              allBindings, viewModel, context); 
    }
}; 
```

[http://jsfiddle.net/rniemeyer/48uJg/2/](http://jsfiddle.net/rniemeyer/48uJg/2/)

或者

```
ko.bindingHandlers.myWith = {
    init: function() {
        return ko.bindingHandlers.with.init.apply(this, arguments);
    },

    update: function() {
        return ko.bindingHandlers.with.update.apply(this, arguments);
    }
}; 
```

# asp.net-mvc-4 - 如何在 .Net 4 和 C# 中定义 AWS DynamoDB 的配置

> ID：11868587
> 
> 赞同：2
> 
> 时间：2012-08-08T16:03:22.623
> 
> 标签：asp.net-mvc-4, asp.net-web-api, amazon-dynamodb

我正在使用 DynamoDB，其中“用户”是表和模型对象名称。我收到此错误：

```
Requested resource not found: Table: User not found 
```

web.config 设置如下。

```
<appSettings>
    <add key="AWSAccessKey" value="asdf" />
    <add key="AWSSecretKey" value="Vi+asdfsecretImnottelling" />
</appSettings> 
```

我目前正在使用我的本地主机来调试我的应用程序。这是允许的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T03:49:09.183

我没有设置`ServiceURL`这是一个问题，因为我没有使用默认区域。

默认情况下，适用于 .NET 的 AWS 开发工具包将终端节点设置为

```
https://dynamodb.us-east-1.amazonaws.com 
```

您还可以显式设置端点，如以下 C# 代码片段所示：

```
private static void CreateClient()
{
    AmazonDynamoDBConfig config = new AmazonDynamoDBConfig();
    config.ServiceURL = "http://dynamodb.us-east-1.amazonaws.com";
    client = new AmazonDynamoDBClient(config);
} 
```

Amazon 的“[什么是 Amazon DynamoDB？](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/TestingDotNetApiSamples.html) ”也会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-20T10:18:03.007

使用 IAM 创建用户，它是 AWS 服务。然后根据您添加的用户在您的应用设置中进行以下配置：

```
"AWS": {
"Profile": "",
"AccessKey": "",
"SecretKey": "",
"Region": ""} 
```

以下方法很容易创建具有基本凭据的 DynamoDb 客户端：

```
AmazonDynamoDBClient awsDbClient = new AmazonDynamoDBClient(strAccessKey, strSecretKey, Amazon.RegionEndpoint.GetBySystemName(strRegion)); 
```

对于 aws DB 访问库，您可以访问此链接：[https ://github.com/MeghnathDas/DynamoDbPlugin](https://github.com/MeghnathDas/DynamoDbPlugin)

# maven-release-plugin - Maven 发布插件和 windows 换行

> ID：11868590
> 
> 赞同：22
> 
> 时间：2012-08-08T16:03:36.073
> 
> 标签：maven-release-plugin, line-endings

当我尝试运行 maven-release-plugin 时，它会更改 pom.xml 文件中的版本。在 maven 发布之前，每行结尾都有 unix 样式`<lf>`，但是在我的 windows 机器上运行它之后，插件将文件中的每一行更改为`<cr><lf>`.

我的问题是：

a) 有没有办法告诉 maven 保持原样或使用特定的行尾

或者

b）有没有一种通用的方法来告诉窗口行尾应该是什么？即使是在操作系统深处破解某些东西的工具也会被认为是有帮助的。

我查看了这个[https://issues.jfrog.org/jira/browse/BI-111](https://issues.jfrog.org/jira/browse/BI-111)，上面写着“已解决”，但我使用的是最新版本，它对我不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-16T19:34:56.293

有四种可能的解决方案。

1.  使用 Maven Assemly 插件

我认为最好的办法是调查[Maven 程序集插件](http://maven.apache.org/plugins/maven-assembly-plugin/)。它应该允许您更新行分隔符。有关详细信息，请参阅“fileSet”部分[。](http://maven.apache.org/plugins/maven-assembly-plugin/assembly.html)

2.  使用 PowerShell 调用`mvn`

作为临时解决方法，您可以使用 PowerShell（开始->所有程序->附件->Windows PowerShell）。像你一样调用 maven，在双引号 -D 语句周围有一些额外的东西。`mvn assembly:assembly -P prod "-Dmaven.test.skip=true"`. 现在添加到这个 -Dline.separator=`n。这应该会导致 PowerShell 添加转义值。

3.  `"line.separator"`在 pom 更新之前编写你自己的插件来覆盖。

按照[Maven 指南](http://maven.apache.org/guides/plugin/guide-java-plugin-development.html)创建一个简单的插件。它需要做的就是覆盖价值。将插件配置为在 pom 修改之前的阶段执行。

```
System.getProperties().setProperty("line.separator", "\n"); 
```

4.  在 Linux 虚拟机中构建。

有一个选项不能纠正 Windows 兼容性问题，但应该可以解决您的核心问题。看看创建小型 VirtualBox Linux 服务器。一个简单的 NAT 连接应该足以访问 Internet。在这台机器上安装 Maven、Java 等。建立在它之上。因为它是 Linux，所以行分隔符应该只有 '\n'。VM 需要 256 - 512 MB 的 RAM 和 20 GB 的存储空间（Linux + 许多可能的 Maven 依赖项）。如果你最终喜欢它，你甚至可以扩展它以容纳像 Jenkins 这样的持续集成产品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-09-26T19:14:40.527

我在 Windows (CRLF) 上工作并在我的文件中使用 LF 结尾。我使用 Git。

我选择设置`core.autocrlf`为`input`. 根据[https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration) `input`设置是针对这种情况的：

> 如果您在使用 LF 行结尾的 Linux 或 Mac 系统上，那么您不希望 Git 在您检出文件时自动转换它们；但是，如果意外引入了带有 CRLF 结尾的文件，那么您可能希望 Git 修复它。您可以通过将 core.autocrlf 设置为 input 来告诉 Git 在提交时将 CRLF 转换为 LF，但不能反过来

但是，当我在 Windows 上时，它对我很有效。如果您的情况类似，可以尝试一下：

*   If CRLF file gets committed to the repository, CRLF line endings will be visible on checkout. Therefore one can react (e.g. remind colleagues to pay attention to the line endings).
*   Using Maven Release Plugin will not cause pom.xml to be committed with CRLF (it will be LF).

Downside:

*   Solution is machine-dependent. One can forget verifying Git settings before releasing from a different machine, causing CRLF pom.xml to be committed.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-21T23:42:35.630

在 Linux 中工作，但希望在例如输出中使用 Windows 行尾`set-versions`，这个快速修复适用于我：

```
mvn -Dline.separator=$'\r\n' \
    -DautoVersionSubmodules=true \
    -DdevelopmentVersion=1.2.3-SNAPSHOT \
    release:update-versions 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-03T17:06:21.153

我的解决方法是使用 SVN 属性：`svn:eol-style=native`. 因此 SVN`pom.xml`在更新或提交时“转换”。

# javascript - 谷歌分析被禁用？

> ID：11868593
> 
> 赞同：1
> 
> 时间：2012-08-08T16:03:44.243
> 
> 标签：javascript, google-analytics

我正在尝试使用 Google Analytics 跟踪事件，这是我使用的代码

```
_gaq.push(['_trackEvent', 'ClickThrough', 'Website', 'lid' + listingid]); 
```

Listingid 是一个整数，

我可以看到一些值被发送到谷歌分析，所以我假设代码工作正常，但在谷歌分析中，在内容 > 事件下，我没有看到我的任何事件，我搜索了 ClickThrough，什么也没有被退回。

我在这里注意到： [Google 分析事件跟踪不起作用](https://stackoverflow.com/questions/2329566/google-analytics-event-tracking-not-working)

有人说您需要启用事件跟踪，我找不到在 Google Analytics 上启用事件跟踪的地方。它是否默认禁用，我在哪里可以启用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:11:12.860

终于修好了，你必须使用最新的跟踪代码，我用的是旧的。

[https://developers.google.com/analytics/devguides/collection/gajs/asyncTracking](https://developers.google.com/analytics/devguides/collection/gajs/asyncTracking)

# android - 在 Eclipse 中用另一个词替换一个词

> ID：11868595
> 
> 赞同：0
> 
> 时间：2012-08-08T16:03:52.780
> 
> 标签：android, eclipse, sharedpreferences

在 Eclipse Classic 中，我正在开发一个 android 应用程序，该应用程序具有许多保存 SharedPreferences 并且都具有相同的 SharedPreference 名称，如下所示：

```
SavePreferences("NAME_OF_THE_SHAREDPREFERENCE", ("Some random text")); 
```

但我想在另一个类中更改 SharedPreference 的名称。这将（如果可能的话）为我节省大量时间，而不是一一更改。

我知道 Ctrl+H 命令，但我找不到“NAME_OF_THE_SHAREDPREFERENCE”，和/或将其替换为其他名称。

如果我的解释难以理解，请随时提问：-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:08:18.643

是因为这些字符串不同吗？

```
NAME_OF_SHAREDPREFERENCE 
```

不同于（缺少“THE_”）：

```
NAME_OF_THE_SHAREDPREFERENCE 
```

好的，这只是一个错字...但是您可以在每个文件中使用 Find/Replace `Ctrl`+ `F`。

* * *

我还建议使用静态变量而不是硬编码的字符串：

```
class ClassA {
    public static final String SHAREDPREFERENCE_FILENAME = "something";

    ...
    mSharedPreferences = getSharedPreferences(SHAREDPREFERENCE_FILENAME, MODE_PRIVATE);
}

class ClassB {
    ...
    mSharedPreferences = getSharedPreferences(ClassA.SHAREDPREFERENCE_FILENAME, MODE_PRIVATE);
} 
```

这样，您只需更新一个位置。

# jquery - 如何让 Twitter Bootstrap 模式在表单提交时保持打开状态？

> ID：11868599
> 
> 赞同：6
> 
> 时间：2012-08-08T16:04:00.800
> 
> 标签：jquery, twitter-bootstrap, modal-dialog, form-submit

我试图弄清楚是否有一种相对简单的方法（我对 JQuery 不是很熟练）在表单提交后保持模式打开。（表单包含在模态中）。

如果表单成功或有错误，我的 PHP 会显示它们，但一旦按下提交按钮，模式就会关闭。

如果我重新加载表单，我可以看到相应的成功或错误消息，因此一切正常，但我希望最终用户看到消息，然后单击以关闭模式。

如果有帮助，我可以发布我的代码。

谢谢你。

```
<?php 
$success_message = "<h3 class='success'>Thank you, your message has been sent.</h3>"; 
$success = false; // we assume it and set to true if mail sent
$error = false;

// set and sanitize our form field values

$form = array(
  'Name' => $sanitizer->text($input->post->name),
  'Email' => $sanitizer->email($input->post->email),
  'Phone number' => $sanitizer->text($input->post->phone),
  'Type of client' => $sanitizer->text($input->post->client_type),
  'Service client is after' => $sanitizer->text($input->post->service),
  'Further information' => $sanitizer->textarea($input->post->information)
);

$required_fields = array(
  'name' => $input->post->name,
  'email' => $input->post->email
);

// check if the form was submitted
if($input->post->submit) {

  // determine if any fields were ommitted or didn't validate
  foreach($required_fields as $key => $value) {
    if( trim($value) == '' ) {
      $error_message = "<h3 class='error'>Please check that you have completed all the required fields.</h3>";
      $error = true;
    }
  }
  // if no errors, email the form results
  if(!$error) {
    $message = "";
    $to_name = "My name";
    $to = "me@me.com";
    $subject = "Contact Form request";
    $from_name = "My Website";
    $from = "do-not-reply@my-site.com";
    $headers = "From: $from_name <$from>";
    foreach($form as $key => $value) $message .= "$key: $value\n";

    require_once("./scripts/PHPMailer/class.phpmailer.php");

    $mail = new PHPMailer();
    $mail->CharSet = "UTF8";

    $mail->FromName = $from_name;
    $mail->From = $from;
    $mail->AddAddress($to, $to_name);
    $mail->Subject = $subject;
    $mail->Body = $message;

    if ($mail->Send()) {
      $success = true;
    }
}
}
?>

<!-- Contact form made available from every page -->

    <div class="modal hide fade" id="form">

        <div class="modal-header">
            <a class="close" data-dismiss="modal">&times;</a>
           <h3>Get in touch</h3>
         </div>

        <div class="modal-body">

        <?php if(!$success) { 
            if($error) {
            echo $error_message; // or pull from a PW field
            } 
        ?>

        <form action="./" method="post" class="modal-form">

            <div class="row-fluid">
                <fieldset class="span6">

                    <label for="name">Name:</label>
                    <input type="text" name="name" required>

                    <label for="email">Email:</label>
                    <input type="email" name="email" required>

                    <label for="phone">Phone:</label>
                    <input type="tel" name="phone">

                </fieldset> 

                <fieldset class="span6">

                    <label for="client_type">I am a...</label>
                    <select name="client_type">
                        <option>Private student</option>
                        <option>Business</option>
                        <option>Unsure</option>
                    </select>

                    <label for="service">I am interested in...</label>
                    <select name="service">
                        <option>Private tuition</option>
                        <option>Group tuition</option>
                        <option>Translation</option>
                        <option>Unsure</option>
                    </select>

                </fieldset>
            </div> <!-- /.row-fluid -->

            <div class="row-fluid">
                <fieldset>
                    <label for="information">Further information:</label>
                    <textarea name="information" name="information" id="information" class="span12"></textarea>
                </fieldset>

            <button type="submit" name="submit" value="Submit" class="btn">Submit</button>

            </div> <!-- /.row-fluid -->

            </form>

            <?php }  else {

            echo $success_message;
            } ?>

        </div> <!-- /.modal-body -->

        <div class="modal-footer">

        </div> <!-- /.modal-footer -->

    </div> <!-- /#contact_form.modal hide fade --> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T16:46:12.700

为了不关闭模态窗口，即不刷新整个页面，您需要通过ajax调用将表单值提交给您的php脚本。

为简单起见，我将在这里使用 jQuery

```
$(function() {

    $('#your_form_id').on('submit', function(event) {

        event.preventDefault();

        $.ajax({
            url: "your_php_script.php",
            type: "POST",
            data: {"formFieldName" : formFieldValue}, // here build JSON object with your form data
            dataType: "json",
            contentType: "application/json"
        }).done(function(msg) {
            // this is returned value from your PHP script
            //your PHP script needs to send back JSON headers + JSON object, not new HTML document!
            // update your "message" element in the modal
            $("#message_element_id").text(msg);
        });
    });
}; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-08T16:45:28.170

当您提交表单时，页面会重新加载，即使`action`表单的页面是同一页面（空操作也意味着同一页面）。

我认为您想在页面再次加载后重新打开模式。猜测您正在使用`method="post"`表单，您的代码应该是这样的：

```
<html>
    <head>
      <!-- stuff -->
        <script type="text/javascript">

<?php if(isset($_POST['submit_button'])) { ?> /* Your (php) way of checking that the form has been submitted */

            $(function() {                       // On DOM ready
                $('#myModal').modal('show');     // Show the modal
            });

<?php } ?>                                    /* /form has been submitted */

        </script>
    </head>
    <body>
      <!-- etc -->
    </body>
 </html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-23T12:36:29.053

您还可以使用**window.stop()**这将阻止模型关闭和整个刷新一起，就像单击浏览器中的停止按钮一样。

# javascript - jQuery $.get() JSON 函数正在执行但不会产生任何结果

> ID：11868604
> 
> 赞同：0
> 
> 时间：2012-08-08T16:04:14.217
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins, dialog

每次我调用脚本（当用户单击链接/按钮时）时，执行时调用的页面`$.getJSON()`都在做它的工作，尽管与之关联的函数不会做任何事情！这是在`Script.php`文件里面：

```
$('a.addCategorie').click(function (e)
    {

        e.preventDefault();
        var dialog='<div id="Dialog_AddCategory">\
        <div id="tableContainer">\
        <table class="categoryTable">\
        <thead>\
        <tr>\
        <th>Ordre</th>\
        <th>Catégorie</th>\
        <th>    </th>\
        </tr>\
        </thead>\
        <tbody>\
        <?php 
            $sql="SELECT nom, ordre FROM category ORDER BY ordre";
            $result=mysql_query($sql);
            while($row=mysql_fetch_array($result))
            {
                echo "<tr>";
                echo "<td>". $row['ordre'] ."</td>";
                echo "<td>". utf8_decode($row['nom']) ."</td>";
                echo "<td id=\"" . $row['ordre'] . "\" class=\"deleteCat\"></td>";
                echo "</tr>\\\n";
            }
        ?>
        </tbody>\
        </table></div>\
        <div id="addCategorie_Form">\
        <form>\
        <label for="nomCategorie">Nom de la catégorie</label>\
        <input type="text" name="nomCategorie" id="nomCategorie"/>\
        <label for="ordreCategorie">Ordre</label>\
        <input type="text" name="ordreCategorie" id="ordreCategorie"/>\
        </form>\
        </div></div>';
        $('body').append(dialog);
$( '#Dialog_AddCategory' ).dialog({
                autoOpen: false,
                modal: true,
                width: 800,
                height: 400,
                open: function(even, ui) { $(".ui-dialog-titlebar-close", ui.dialog).css("visibility","hidden");},
                title: "Nouvelle catégorie",
                resizable: false,
                hide:'slide',
                show:'slide',
                buttons:
                {
                    "Créer la catégorie":function()
                    {
                        var ok = true;
                        if(isNaN($('#ordreCategorie').val()) || $('#ordreCategorie').val().length < 1)
                        {
                            ok = false;
                            $('#ordreCategorie').css("background-color","#F00");
                        }
                        else
                        {
                            $('#ordreCategorie').css("background-color","#CF0");
                        }
                        if($('#nomCategorie').val().length< 3)
                        {
                            ok = false;
                            $('#nomCategorie').css("background-color","#F00");
                        }
                        else
                        {
                            $('#nomCategorie').css("background-color","#CF0");
                        }

                        if(ok)
                        {
                            var ordre = $('#ordreCategorie').val();
                            var nom = $('#nomCategorie').val();
                            $.getJSON('addCategory.php', {'ordre':ordre,'nom':nom}, function(data) 
                            {
                                console.log("THIS LOG WON'T APPEAR AND THE CODE WON'T EXECUTE.");
                                if( data.result === "false" )
                                {
                                    $('div id="Dialog_Feedback">Une catégorie porte déjà ce nom ou cet ordre!</div>').dialog(
                                    {
                                        autoOpen:false,
                                        title:'Une erreur est survenue!',
                                        width:200,
                                        height:'auto',
                                        resizable: false,
                                        modal:true,
                                        buttons:
                                        {
                                            "OK" : function()
                                            {
                                                $( this ).remove();
                                            }
                                        }
                                    });
                                }
                                else
                                {
                                    $('<div id="Dialog_Feedback">L\'ajout a été effectué avec succès!</div>').dialog({
                                        autoOpen:false,
                                        title:'Catégorie ajoutée!',
                                        width:400,
                                        height:'auto',
                                        resizable:false,
                                        modal:true,
                                        buttons:{
                                            "Ok": function()
                                            {
                                                $(this).remove();
                                                window.location.reload();
                                            }
                                        }
                                    });                                 
                                }
                                $('#Dialog_Feedback').dialog("open");   
                            });
                        }
                    },
                    "Annuler":function()
                    {
                        $( this ).remove();
                    }
                }   
        }); 
```

这是`addCategory.php`页面：

```
<?php
include('../../anything.php');
$nom = $_GET['nom'];
$ordre = $_GET['ordre'];
$sql = "SELECT ordre, nom FROM category";
$checking = mysql_query($sql);
$ok = true;
while ($row=mysql_fetch_array($checking))
{
    echo "test";
    if((strtolower($nom) === strtolower($row['nom'])) || ($ordre === $row['ordre']))
    {
        $ok = false;
    }
}
if ($ok)
{
    $sql = "INSERT INTO category (nom,ordre) VALUES('$nom',$ordre)";
    $result = mysql_query($sql);
    mysql_close($connexion);
    echo json_encode(array("result"=>"true"));
}
else
{
    echo json_encode(array("result"=>"false"));
}
?> 
```

任何人都知道可能导致这种情况的原因吗？我检查了 GET 中发送的两个变量，它们包含一些东西。

我的 PHP 页面返回 JSON 编码结果，如下所示：

`echo json_encode(array("result"=>"true"));`

谢谢大家的时间。

**编辑**：我忘了提到Chrome Inspector 和 Firebug 在整个脚本执行过程中**都**不会报告任何错误。该`console.log()`部分也没有出现，表示PHP页面中的命令被执行，但里面包含的javascript函数`$.get()`没有被触发。

**Edit2**：我也尝试将`echo`调用更改为`echo true;`and `return true;`。

**Edit3**：我能够在 Chrome Inspector 和 Firebug 的 Network 选项卡中看到 PHP 页面的结果：`{"result":"false"}array(1) { ["result"]=> string(5) "false" }` 它表明问题将存在于`$.getJSON()`调用中！但在我看来一切都很好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:53:03.657

如果您将无效的 JSON 传递给`$.getJSON`，则不会触发成功回调。正如您在编辑中提到的，您会收到类似 的响应`{"result":"false"}array(1) { ["result"]=> string(5) "false" }`，这肯定不是有效的 JSON。

更正您的脚本以生成有效的 JSON，您应该一切顺利！

# asp.net-mvc - 带有 RouteConstraint 的 ASP.Net MVC 路由不起作用

> ID：11868608
> 
> 赞同：0
> 
> 时间：2012-08-08T16:04:32.253
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

就在我认为我已经弄清楚了路由时，它并没有按照我认为的方式工作。我正在使用 ASP.Net MVC 4 RC。这是我的路由配置：

```
 routes.MapRoute
        (
            "TwoIntegers",
            "{controller}/{action}/{id1}/{id2}",
            new { controller = "Gallery", action = "Index", id1 = new Int32Constraint(), id2 = new Int32Constraint() }
        );

        routes.MapRoute
        (
            "Default",
            "{controller}/{action}/{id}",
            new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        ); 
```

这是我的路线限制：

```
public class Int32Constraint : IRouteConstraint
{
    public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
    {
        if (values.ContainsKey(parameterName))
        {
            int intValue;
            return int.TryParse(values[parameterName].ToString(), out intValue) && (intValue != int.MinValue) && (intValue != int.MaxValue);
        }

        return false;
    }
} 
```

/{domain.com}/PageSection/Edit/21

它在“TwoIntegers”路线上停止。很明显，没有传递第二个整数。

**这是我的错误：**

> 参数字典包含“SolutiaConsulting.Web.ContentManager.Controllers.PageSectionController”中方法“System.Web.Mvc.ActionResult Edit(Int32)”的不可空类型“System.Int32”的参数“id”的空条目。可选参数必须是引用类型、可空类型或声明为可选参数。参数名称：参数

我究竟做错了什么？我首先列出了更具体的路线。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:23:37.303

您的约束未正确指定。确保您使用了正确的`MapRoute`扩展方法重载：

```
routes.MapRoute(
    "TwoIntegers",
    "{controller}/{action}/{id1}/{id2}",
    new { controller = "Gallery", action = "Index" },
    new { id1 = new Int32Constraint(), id2 = new Int32Constraint() }
); 
```

注意用于指定约束的第四个参数，而不是第三个。

顺便说一句，您可以使用命名参数使您的代码更具可读性：

```
routes.MapRoute(
    name: "TwoIntegers",
    url: "{controller}/{action}/{id1}/{id2}",
    defaults: new { controller = "Gallery", action = "Index" },
    constraints: new { id1 = new Int32Constraint(), id2 = new Int32Constraint() }
); 
```

还有一个正则表达式怎么样？

```
routes.MapRoute(
    name: "TwoIntegers",
    url: "{controller}/{action}/{id1}/{id2}",
    defaults: new { controller = "Gallery", action = "Index" },
    constraints: new { id1 = @"\d+", id2 = @"\d+" }
); 
```

# orchardcms - 自定义类型的 Orchard Cms 多媒体选择器文件

> ID：11868610
> 
> 赞同：0
> 
> 时间：2012-08-08T16:04:40.007
> 
> 标签：orchardcms

我创建了一个自定义类型的项目，它有 4 个图像，我希望使用 4 个类型的媒体选择器，我已经添加了链接，所以......

```
public int Create()
            {
                // Define the project type 
                ContentDefinitionManager.AlterTypeDefinition("Project", cfg => cfg
                    .WithSetting("Stereotype", "Content")
                    .CommomPart()
                    .AutoroutePart("our-work")
                    .BodyPart()
                    .WithPart("TitlePart")
                    .WithPart("PublishLaterPart")
                    .WithPart("MenuPart", builder => builder
                        .WithSetting("MenuPart.OnMenu", "true")
                        .WithSetting("MenuPart.CurrentMenu", "Project Menu"))
                    .WithPart("Project")
                    .Creatable()
                    .Draftable());

                return 1;

            }

            public int UpdateFrom1()
            {
                // Define project part - having a part with the same name will create fields in the project type
                ContentDefinitionManager.AlterPartDefinition("Project", builder => builder
                   .MediaPickerField("MainImage")
                   .MediaPickerField("MediumImage")
                   .MediaPickerField("SmallImage")
                   .MediaPickerField("Logo")
                   .TextField("ShortDescription", Flavour.TextArea)
                   .TextField("Features", Flavour.Markdown)
                   .TextField("ClientTitle", Flavour.DefaultFlavour)
                   .TextField("ClientName", Flavour.DefaultFlavour)
                   .TextField("ClientQuote", Flavour.Textarea)
                   .BooleanField("MainProjectOnHomePage", false)
                   .Attachable());

                return 2;
            } 
```

用于使其不那么冗长的扩展方法

```
public static ContentPartDefinitionBuilder MediaPickerField(this ContentPartDefinitionBuilder builder, 
                                                                string name, bool required = true, string hint = "")
    {
        var displayName = SplitCamel(name);

        // default implementation of Media picker field - create overloads for more options
        return  builder.WithField(name, fieldBuilder => fieldBuilder
                    .OfType("MediaPickerField")
                    .WithDisplayName(displayName)
                    .WithSetting("MediaPickerFieldSettings.Required", required.ToString(CultureInfo.InvariantCulture))
                    .WithSetting("MediaPickerFieldSettings.AllowedExtensions", "jpg png gif")
                    .WithSetting("MediaPickerFieldSettings.Hint", hint));

    }

    public static ContentPartDefinitionBuilder TextField(this ContentPartDefinitionBuilder builder, 
                                                         string name, Flavour flavor, bool required = true, string hint = "")
    {
        var strFlavor = SplitCamel(flavor.ToString());

        // default implementation of Media picker field - create overloads for more options
        return builder.WithField(name, fieldBuilder => fieldBuilder
                    .OfType("TextField")
                    .WithSetting("TextFieldSettings.Required", required.ToString(CultureInfo.InvariantCulture))
                    .WithSetting("TextFieldSettings.Flavor", strFlavor)
                    .WithSetting("TextFieldSettings.Hint", hint));

    } 
```

我可以将媒体添加到仪表板中的 4 个字段，但在保存时只保存第一个媒体项，我可以保存项目，即使所有媒体字段都是必需的，但缺少 3 个字段的媒体项,

我还尝试通过仪表板添加一个额外的媒体选择器，结果相似。

难道我做错了什么？

# css - 谷歌浏览器不显示 CSS 样式

> ID：11868611
> 
> 赞同：-6
> 
> 时间：2012-08-08T16:04:40.050
> 
> 标签：css, google-chrome

当我使用 google chrome 21 检查网站中的**某些**元素时 - 我只能看到元素，但看不到某些样式。喜欢

```
.content
{
} 
```

如果我用萤火虫检查这个，我可以看到像

```
.content
{
 color:white;
 font-size:12px;
} 
```

奇怪的是谷歌浏览器显示页面像FF和IE一样正确。当我在 google chrome 中单击 css 链接时，我可以看到损坏的图像而不是 css。我已经用 css 验证器检查了 css，我的 css 没有问题。什么是问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:06:13.073

`font-size`不是 `fint-size`。_ 修正错字，它可能会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T20:53:10.947

我希望这个答案可以帮助某人：

我在 google chrome 控制台中发现了这个错误：

> 资源解释为**图像**，但使用 MIME 类型 **text/css传输**

和我的css文件的链接。这就是我在问题中提到的单击 css 文件时图像损坏的原因。

多亏了这个[链接](http://intertwinesys.com/2011/01/04/remove-custom-image-header-wordpress-child-theme/) ，我发现我有一种风格

```
background:url('') // probably problem with background without image url,although css validator, validate it 
```

并将其替换为

```
background:none. 
```

现在我可以在 google chrome 检查器中看到所有样式，当我单击 css 链接时，我会看到一个 css 文件。

# c# - 使用LINQ从根节点选择所有家庭？

> ID：11868612
> 
> 赞同：1
> 
> 时间：2012-08-08T16:04:43.423
> 
> 标签：c#, linq

假设我有一个可以有无限孩子的类别，每个孩子也可以有无限的孩子​​。

只是好奇，有没有办法使用 LINQ 检索所有根节点系列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:10:15.397

在 C# 中处理递归结构有两种常用方法 - 使用`yield return`和编写递归函数。我更喜欢第二种方式，这里有一个例子：

```
public static class TreeUtils {
    public static IEnumerable<T> GetAllNodes<T>(
        this T node
    ,   Func<T,IEnumerable<T>> f) 
    {
        return GetAllNodes(new[] {node}, f);
    }
    public static IEnumerable<T> GetAllNodes<T>(
        this IEnumerable<T> e
    ,   Func<T,IEnumerable<T>> f) 
    {
        return e.SelectMany(c => f(c).GetAllNodes(f)).Concat(e);
    }
} 
```

您可以按如下方式使用此实用程序类：

```
class TreeNode<T> {
    public T Content {get; set;}
    public IEnumerable<TreeNode<T>> Dependents {get;set;}
}

foreach (TreeNode node in TreeUtils.GetAllNodes(root, n => n.Dependents)) {
    Console.WriteLine(node.Content);
} 
```

一种有点作弊的方法是使用“递归” lambda：

```
using System;
using System.Collections.Generic;

public class Program {
    class Node {
        public int Data;
        public IEnumerable<Node> Dependents { get; set; }
    }
    public static void Main() {
        var root = Create(
            10
        ,   Create(5, Create(3), Create(7, Create(6), Create(8)))
        ,   Create(20, Create(15), Create(30, Create(28), Create(40)))
        );
        // We cannot combine the declaration and definition here
        Func<Node,IEnumerable<Node>> all = null;
        // The recursive magic is in the following line
        all = n => n.Dependents.SelectMany(d => all(d)).Concat(new[] {n});
        // Here is how you can use it
        foreach (var node in all(root)) {
            Console.WriteLine(node.Data);
        }
    }
    // Helper function for creating tree nodes
    private static Node Create(int data, params Node[] nodes) {
        return new Node { Data = data, Dependents = nodes };
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:09:26.460

linq 非常依赖的 Lambdas 不支持以直观方式执行此类操作所需的递归；但是，使用 let 和 y-combinator 您可以以非直观的方式进行操作。这是一个复杂的例子：

[http://blogs.msdn.com/b/lukeh/archive/2007/10/01/taking-linq-to-objects-to-extremes-a-fully-linqified-raytracer.aspx](http://blogs.msdn.com/b/lukeh/archive/2007/10/01/taking-linq-to-objects-to-extremes-a-fully-linqified-raytracer.aspx)

希望有人会想出一个更简洁的。如果是这样，请选择它们。

# iphone - 从 facebook 崩溃打开到 facebook 页面的链接

> ID：11868615
> 
> 赞同：0
> 
> 时间：2012-08-08T16:04:57.400
> 
> 标签：iphone, objective-c, xcode, facebook

我正在墙上分享一个提要。该链接是指向某些 facebook 页面的链接。

当从 chrome 按下链接时，页面会正确打开，![从 chrome 打开](../Images/a8ed20584a747fdf0917895a88b79216.png)

但是当我尝试在 iPhone 中打开它时，页面崩溃了。

![在此处输入图像描述](../Images/49949398c985dd9f75aebe62debc1321.png)

这是代码：

```
...
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
    @"name",@"name",
    @"description", @"description",
    [NSString stringWithFormat: @"https://www.facebook.com/Kyoto.sushi"], @"link", 
    @"caption", @"caption",
    [NSString stringWithFormat:pictureUrl], @"picture",
    @"message",@"message",
    nil];
[facebook requestWithGraphPath:@"me/feed"
                         andParams:params
                     andHttpMethod:@"POST"
                       andDelegate:self];
... 
```

我按下复制 URL，得到了这个： `fb://faceweb/f?href=%2FKyoto.sushi%3Fid%3D100616296685390%26_rdr`猜测 Facebook 识别出它是一个 Facebook 链接并将其转换为某种东西。这东西并没有真正起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:17:15.773

您的网址有 http:// 和 https://

```
http://https://www.facebook.com/Kyoto.sushi 
```

那应该是

```
https://www.facebook.com/Kyoto.sushi 
```

# integration-testing - 创建用于测试的只读 DAO 时的最佳实践是什么？

> ID：11868619
> 
> 赞同：1
> 
> 时间：2012-08-08T16:05:12.660
> 
> 标签：integration-testing, agile, dao, methodology, readonly

作为我正在工作的项目的一部分，我们有一个只读的 DAO（比尔类）。项目本身不应创建尚未在数据库中表示的 Bill 的新实例，也不应更改或更新此 Bill 类的值。因此，为了防止意外修改 Bill 实例，所有构造函数和私有构造函数都没有设置器（Hibernate 用于将数据库中的账单数据编组到 Bill 实例中，并且不会因缺少公共构造函数和设置器而烦恼）。

现在的问题：

> 作为集成测试的一部分，我需要违反我们的项目永远不会创建未在数据库中表示的新账单对象的原则。为了测试目的而违反这一原则的最佳方式是什么？

**基于反射的构建器：**我提出的一个想法是使用基于反射的构建器，这样 Bill 类的代码就不需要更改，并且在构建器对字段的任何假设的情况下对构建器进行全面测试比尔类错误很快被识别出来。

**包私有构造函数：**我老板提出的另一种选择是包含一个构建器可以使用的包私有构造函数。这具有更简单的优点，并且需要更少的测试来确保构建器工作。但是，它需要主代码库中的显式代码来适应它。

我们俩都不太热衷于这两个想法。所以我想知道是否有其他人以前必须处理过类似的问题，以及他们是如何处理的。我一直在翻阅“敏捷测试：测试人员和敏捷团队的实用指南”，但到目前为止还没有发现任何相关内容。

注意。它不像直接与数据库交互那么简单，因为账单是复杂的 DAO 层次结构的一部分（包括数据库中的外键约束）。因此，能够快速简单地创建此类层次结构并将所有这些数据持久保存到数据库中的构建器是可取的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:12:07.377

Can you create a `MutableBill` class that is kept in your test source tree and is mapped to the same table as your `Bill` class?

Then your test code could populate the DB (for example [HSQLDB](http://hsqldb.org/)) at the beginning of the test run using `MutableBill` and the rest of your code could continue using the immutable `Bill`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:40:04.577

如果我必须在这两者之间进行选择，我会使用默认的可见性构造函数。基于反射的编程创建了难以理解且根本不简单的代码。您的 IDE 的查找引用将无法正常工作，因此有人可能会认为他们面临死代码。然后在运行时发现整个事情都坏了。

这样的添加（作为包私有的东西）是可以接受的，因为更需要彻底的测试。

# javascript - 车把模板内的模板

> ID：11868623
> 
> 赞同：3
> 
> 时间：2012-08-08T16:05:31.480
> 
> 标签：javascript, mustache, handlebars.js

如何在车把的模板内创建模板？
这些是我的模板：

```
<script type="text/x-handlebars-template" id="animal-template">
    <div class="locationSelect">
    {{content}}
    </div>
</script>
<script type="text/x-handlebars-template" id="cat-template">
    <div>
    I am cat
    </div>
</script>
<script type="text/x-handlebars-template" id="dog-template">
    <div>
    I am dog
    </div>
</script> 
```

我想在运行时在动物模板中加载适当的模板（猫模板或狗模板）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-19T00:21:24.880

**当您需要在几个不同的上下文中使用大量 Handlebars.js 模板时，**部分会派上用场****

 **```
<script id="people-template" type="text/x-handlebars-template">
  {{#each people}}
    {{> person}}
  {{/each}}
</script>

<script id="person-partial" type="text/x-handlebars-template">
  <div class="person">
    <h2>{{first_name}} {{last_name}}</h2>
    <div class="phone">{{phone}}</div>
    <div class="email"><a href="mailto:{{email}}">{{email}}</a></div>
    <div class="since">User since {{member_since}}</div>
  </div>
</script>

<script type="text/javascript">
  $(document).ready(function() {
    var template = Handlebars.compile($("#people-template").html());
    Handlebars.registerPartial("person", $("#person-partial").html());

    template(yourData);
  }
</script> 
```

[http://blog.teamtreehouse.com/handlebars-js-part-2-partials-and-helpers](http://blog.teamtreehouse.com/handlebars-js-part-2-partials-and-helpers)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:13:17.877

您可以`templateName`根据呈现的项目计算 的项目视图属性：

```
App.AnimalView = Ember.View.extend({
  templateNameBinding: function () {
    var kind = this.get('animal.kind');
    return '%@-template'.fmt(kind);
  }.property('animal.kind')
}); 
```

然后在容器模板中，通过它们的视图渲染项目：

```
<script type="text/x-handlebars-template" id="animal-template">
  <div class="locationSelect">
  {{#for animal in content}}
    {{view App.AnimalView animalBinding="animal"}}
  {{/for}}
  </div>
</script> 
```**

# asp.net-mvc - MSChart - 将总计添加到图例

> ID：11868624
> 
> 赞同：0
> 
> 时间：2012-08-08T16:05:31.957
> 
> 标签：asp.net-mvc, mschart

我在 ASP.Net MVc 3 应用程序中使用 MSChart 控件来呈现一系列饼图。有没有办法将所有项目的总数添加到图例中？我找到了#TOTAL 关键字，但我不知道如何在图例中添加另一个项目以显示信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T16:13:53.197

您需要使用 cellColumns。请记住，如果将一个或多个单元格列添加到图例中，则默认图例将替换为 CellColumn 集合中的项目数

```
chart1.Legends[0].CellColumns
    .Add(new LegendCellColumn("Total", LegendCellColumnType.Text, "#TOTAL{N2}")); 
```

参考 [自定义图例项](http://support2.dundas.com/OnlineDocumentation/WebChart2005/Default%20Legend%20Items.html)

# playframework-1.x - playframework 1.2.5，如何正确连接 JPA 插件之类的东西（类加载器问题）

> ID：11868627
> 
> 赞同：0
> 
> 时间：2012-08-08T16:05:40.970
> 
> 标签：playframework-1.x

我正在尝试将 nosqlORM 连接到 play 1.2.5。目前，出现此问题是因为每次更改后 Class 文件实例都不同，因此 ORM 层会扫描所有 Class 文件并在启动时创建 Class to MetaClass Map 但后来，当使用某个类时，它是不同的 Class每次归档。

我在 playframework 中查看 JPAPlugin.java，但我看不到他们会在哪里重新扫描所有休眠实体的注释（hibernate 仅在启动时扫描注释并且不再查看它们，所以播放必须在做某事）。

有谁知道这是如何工作的？

更糟糕的是，当我处于“播放运行”模式时，它根本不会在播放文件中获取资源......（在调试模式下，它确实会获取类）......errr，更具体地说是 ClassLoader .getResources("nosql/Persistence.class"); 仅在调试模式下找到，但在“播放运行”模式下找不到。不过有趣的是，它会找到项目中其他 jar 中存在的实例。我可以将我的模型移动到一个罐子中，我猜它可以工作，但这有点痛苦，因为编辑和点击网络浏览器是一个非常好的功能。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:11:14.773

每次重新加载时，Play 都会调用 JPAPlugin.onApplicationStart。您可以在“onApplicationStart”上设置断点或将日志级别更改为：application.log=TRACE

你会看到那里重新加载了休眠。

您的模块应该在“onApplicationStart”中完成重新加载“nosqlORM”。

# objective-c - UIImageView userInteractionEnabled 没有改变

> ID：11868629
> 
> 赞同：0
> 
> 时间：2012-08-08T16:05:46.213
> 
> 标签：objective-c, ios, admob

我`Ad` `view`在我的`App`. 我的`Ad view`（我正在使用 Google 的 adMob）中有一个“x”（退出）图像。

正常加载后`Ad`一切正常。但是当出现错误并且`Ad`无法加载我想显示自己的`Ad`时，我实现了以下方法：

```
- (void)adView:(GADBannerView *)bannerView
    didFailToReceiveAdWithError:(GADRequestError *)error{
    cloaseView.userInteractionEnabled = YES;
    shibbyAdImage.hidden = NO;
    NSLog(@"Failed to load Ad with error : %@", error);
} 
```

出于某种原因，`userInteractionEnabled`未设置为是...

只是一些可能有帮助的代码：

这被称为加载`Ad`-

```
-(void)googleAd{

    // Create a view of the standard size at the bottom of the screen.
    // Available AdSize constants are explained in GADAdSize.h.
    bannerView_ = [[GADBannerView alloc] initWithAdSize:kGADAdSizeMediumRectangle];
    // Specify the ad's "unit identifier." This is your AdMob Publisher ID.
    bannerView_.adUnitID = MY_BANNER_UNIT_ID;

    //[bannerView_ setDelegate:self];    
    bannerView_.delegate = self;
    // Let the runtime know which UIViewController to restore after taking
    // the user wherever the ad goes and add it to the view hierarchy.
    bannerView_.rootViewController = self;
    [self.view addSubview:bannerView_];

    // Initiate a generic request to load it with an ad.
    [bannerView_ loadRequest:[GADRequest request]];
    NSLog(@"in googleAd");
} 
```

并放置`Ad`-

```
- (void)adViewDidReceiveAd:(GADBannerView *)bannerView {
    [UIView beginAnimations:@"BannerSlide" context:nil];
    bannerView.frame = CGRectMake(
                                      self.view.frame.size.width/2 -
                                      bannerView.frame.size.width/2,
                                      self.view.frame.size.height/2 -
                                      bannerView.frame.size.height/2,
                                      bannerView.frame.size.width,
                                      bannerView.frame.size.height);

    [UIView commitAnimations];
//    NSLog(@"in adViewDidReceiveAd");
//    NSLog(@"adpoint x: %g y: %g",adPoint.x, adPoint.y);
    cloaseView.userInteractionEnabled = YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:18:57.810

当你第一次设置 usrInteraction 时，记录它：

```
cloaseView.userInteractionEnabled = YES;
NSLog(@"UserInteraction should now be on, its %d", cloaseView.userInteractionEnabled); 
```

与：

```
cloaseView.userInteractionEnabled = YES; 
```

您可能需要沿着视图链（上级视图）查看是否某些视图阻塞了 userInteraction：

您可以使用它来做到这一点（通过添加一个按钮或在一切正常时从计时器调用它：

```
@implementation UIView (Utilities)

+ (void)dumpSuperviews:(UIView *)v msg:(NSString *)msg
{
    NSMutableString *str = [NSMutableString stringWithCapacity:256];

    while(v) {
        [self appendView:v toStr:str];
        v = v.superview;
    }
    [str appendString:@"\n"];

    LTLog(@"%@:\n%@", msg, str);
}
+ (void)appendView:(UIView *)a toStr:(NSMutableString *)str
{
    [str appendFormat:@"  %@: frame=%@ bounds=%@ layerFrame=%@ tag=%d userInteraction=%d alpha=%f hidden=%d\n", 
        NSStringFromClass([a class]),
        NSStringFromCGRect(a.frame),
        NSStringFromCGRect(a.bounds),
        NSStringFromCGRect(a.layer.frame),
        a.tag, 
        a.userInteractionEnabled,
        a.alpha,
        a.isHidden
        ];
}

@end 
```

# iphone - 如何使用 Cocoa-Touch 在时间前面加上零？

> ID：11868631
> 
> 赞同：0
> 
> 时间：2012-08-08T16:05:48.087
> 
> 标签：iphone, ios, cocoa-touch, cocoa

你好，我从 NSDate 得到时间是这样的：

```
 NSDateComponents *hoursAndMinutes = [[NSCalendar currentCalendar] components:NSHourCalendarUnit|NSMinuteCalendarUnit fromDate:feedItem.date];
        return [NSString stringWithFormat:@"%d:%d", hoursAndMinutes.hour,hoursAndMinutes.minute]; 
```

但是，如果从日期开始的时间是 13:05，它会显示为 13:5，而 09:17 则显示为 9:17。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:13:06.160

[NSDateFormatter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDateFormatter)会做你正在寻找的东西。

```
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateFormat:@"hh:mm"];
NSString *formattedDate = [dateFormat stringFromDate:feedItem.date];

return formattedDate; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:13:07.883

只需使用格式：

```
[NSString stringWithFormat:@"%02d:%02d", hoursAndMinutes.hour,hoursAndMinutes.minute]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:13:22.023

您可以尝试 %02d 而不是 %d 来强制它始终显示两个数字。可能有更简洁的方法，但这似乎确实有效。

参考： http: [//www.ios-developer.net/iphone-ipad-programmer/development/strings/displaying-values-in-strings](http://www.ios-developer.net/iphone-ipad-programmer/development/strings/displaying-values-in-strings)

- 编辑 -

在 20 秒的时间内，哇 3 个答案，我认为 @BJH 有更整洁的解决方案。

# html - Internet Explorer 8 和 Firefox 14 的布局差异

> ID：11868636
> 
> 赞同：1
> 
> 时间：2012-08-08T16:06:09.443
> 
> 标签：html, css, firefox, internet-explorer-8

对不起所有的代码。这真的是一个非常基本的页面。我难住了。IE 8 似乎显示此页面与 ff 14 不同。例如在 ie8 中，标题中的文本似乎相对于它包含的 div 放置。在 ff 14 中，文本似乎相对于“换行”div 的角放置。这里有一些imagur图片

ie8 [http://i.imgur.com/TkgCc.jpg](http://i.imgur.com/TkgCc.jpg)

ff14 [http://i.imgur.com/ykdi9.jpg](http://i.imgur.com/ykdi9.jpg)

更糟糕的是，我的办公室同事说他使用的是 ie8，而页面在他看来就像我的 ff14 示例。我刚刚安装了ie8，所以它应该是一个全新的安装。

ie8 版本在直觉上似乎是正确的。我的意思是你会认为文本会相对于它包含的 div 定位自己。

有任何想法吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>title</title>
<STYLE TYPE="text/css" MEDIA=screen>
body
{
    font-family: Georgia, serif;
}
#wrap
{
    width: 900px;
    margin: 30px auto;
}
#left-block
{
    float: left;
    height: 700px;
    width: 140px;
    background-color: #FFF;
    border: 2px solid #000;
    padding: 20px 0px 0px 20px;
    font-size:14px;
}
#left-block h1
{
    margin: 0 0 30px 0;
    padding: 0 0 0 0;
}
#left-block p
{
    font-weight:900;
}
#left-block li
{
    padding: 10px 0 0 0;
}
#header
{
    height: 120px;
    padding: 10px 0px 0px 0px;
}
#header h2
{
    font-size: 25px;
    margin: 0px 0px 0px 90px;
}
#header h1
{
    font-size: 65px;
    margin: 0px 0px 0px 220px;
}
#nav
{
    height: 30px;
    background-color: #000;
    margin-bottom: 10px;
}
#nav ul
{
    margin: 0;
    padding: 0px 0px 0px 190px;
}
#nav ul li
{
    list-style-type: none;
    display: inline;
}
#nav li a
{
    display: block;
    float: left;
    padding: 5px 10px;
    color: #fff;
    text-decoration: none;
    border-right: 1px solid #fff;
    border-left: 1px solid #fff;
}
#nav li a:hover { background: #666; }
#main
{
    height: 500px;
    background-color: #FFF;
    border-bottom: 3px solid #000 ;
}
#table
{
    margin: 20px 0px 0px 190px;
}
#footer
{
    text-align: center;
}
#footer h1
{
    font-size: 14px;
    margin: 20px 0 0 0;
}
</STYLE>
</head>
<body>
<div id="wrap">
    <div id="left-block">
        lb
    </div>
    <div id="right-block">
        <div id="header">
            <h2>hd</h2>
        </div>
        <div id="nav">
            nav
        </div>
        <div id="main">
            mn
            <div id="table">
                tb
            </div>
        </div>
        <div id="footer">
            ft
        </div>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:10:58.847

猜测一下，您的浏览器正在进入兼容模式。在 IE 中按 F12，它会在右侧 Web 开发区顶部的灰色条上告诉您您的模式。

要阻止这种情况发生，请将其添加到您的`<head>`区域：

`<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />`

如果安装在客户端计算机上，这将强制 IE 使用可用的最新模式并打开 Chrome 框架。

# javascript - "$" 的 keyCode 是什么？

> ID：11868643
> 
> 赞同：7
> 
> 时间：2012-08-08T16:06:25.730
> 
> 标签：javascript, keycode

我正在尝试禁止在文本输入中输入所有其他字符。

因为要得到`$`你必须按`shift`-key 和`4`-key。我不确定您将如何获得这样的 keyCode？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T16:12:49.283

没有`onkeydown`键码，如**ngmiceli之前所说**

虽然，`onkeypress`keycode 存在并且等于`36`.

[JavaScript 事件 KeyCode 测试页](http://www.asquare.net/javascript/tests/KeyCode.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T16:08:22.040

键码仅与键有关。`$`是一个字符，通过 Shift 和 4 两个键实现。`$` *使用时没有明确的键码`onkeydown`*

编辑：爱德华指出，它`onkeypress`使用组合键，并且确实有组合键码。每天学些新东西 ：）

[这是一些代码](http://jsfiddle.net/eprES/)，从 MDN 提供的示例中编辑`onkeydown`，用于检测按键键码。

[这是使用此 SO post 的](https://stackoverflow.com/a/4496986/1222420)帮助更新为对 Firefox 友好[的小提琴](http://jsfiddle.net/tHW9x/)。如果您采用这种方式，JQuery 解决方案也可以工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T16:12:43.400

然后不要使用这种方式来解决您的问题：因为您无法预测每个键盘布局都会始终将 $-sign 输入为 shift+4。
您仍然可以获得键码 4，并检查是否按下了 shift，但您不能确定这一点！！

因此**，最好简单地替换字段中的所有非法字符**（在您提交数据之前）。想一想：str.replace()
您还可以在输入框的 onkeyup 事件中检查您的非法字符集，在您键入时有效地替换所有非法字符！
喜欢：`onkeyup="this.value.replace(/[your illegal characters]/gi, '')"`
那应该做你想做的事。

请注意：您永远不应信任浏览器输入，并且仍应在接收脚本中过滤此输入！！！

祝你好运！！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T16:14:18.270

没有密钥代码`$`，因为它不是有效的密钥 - 它必须通过某种移位器访问。

通常，您将执行检查以查看移位器是否处于活动状态，并在`keypress`相关键上监听事件。您的实例中的 QWERTY 布局是这样的：

```
var shiftPressed = false;

$(window).keydown(function(e) {  
    if(e.which == 16) { shiftPressed = true; }
    if(e.which == 52 && shiftPressed) 
    {  
        // Do whatever here...
    }
});

$(window).keyup(function(e) {  
    if(e.which == 16) { shiftPressed = false; }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-14T03:49:15.997

onkeypress - Unicode CHARACTER 代码是：36

onkeydown - Unicode KEY 代码是：52

# ruby-on-rails - 根据用户类型，Cucumber 功能不能很好地配合使用

> ID：11868645
> 
> 赞同：0
> 
> 时间：2012-08-08T16:06:36.323
> 
> 标签：ruby-on-rails, session, cucumber, integration-testing, activeadmin

已解决：原作者曾用 af@#$ing 类变量记忆。

```
@@roles ||= Role.all 
```

父母们，和你的孩子谈谈 ruby​​ 中的类变量。在别人做之前。

编辑：为用户创建步骤添加了场景和代码。

我正在努力测试一个旧的遗留代码库，在使用 cucumber 时遇到问题。

系统中有“患者”、“站点”和“管理员”用户。有些测试要求您使用患者登录，其他测试要求您使用站点、管理员等登录。当我仅使用已登录的患者运行功能时，它们都可以工作。当我只使用登录的站点用户运行这些功能时，它们都可以工作。当我只使用登录管理员运行功能时，它们都可以工作。当我尝试对多种类型的用户运行混合功能时，第二种和第三种用户的功能不起作用。

我发现的一个线索是，它似乎将所有用户都视为在测试运行中首先登录的用户类型。

这是站点用户的示例测试

```
 Background:
    Given that I am an "site" user

  Scenario: Patients compliance report page
    When I have patient "Joel" with "4" missed days in diary
    And I go to compliance report page
    Then I should see "Patient Compliance Report"
    And I should see columns
      | Site #/Investigator |
      | Patient             |
      | Registration Date   |
      | Compliance %        | 
```

后台步骤调用以下方法：

```
def create_and_login_as_role(role)
  role_sym = :"#{role}_user"
  diary = FactoryGirl.create :diary
  study = FactoryGirl.create :study
  site = FactoryGirl.create :site, study: study
  user = FactoryGirl.create role_sym, diary: diary, organization: site
  login user.username, DEFAULT_PASSWORD
end

def login(username, password)
  visit destroy_user_session_path # kills any session, then defaults to login
  fill_in 'user[username]', with: username
  fill_in 'user[password]', with: password

  click_on "Sign in"
end 
```

这是第二种情况

```
Background:
  Given there are two countries
  And there is a region
  Given that I am an "admin" user
  #I have to create 'ted' second because of the stupid hold-on-to-first-user-type bug
  And there is a site user "ted"

Scenario: Creating a site user
  And I visit the "sites" page
  And I click "New Site"
  And I select the first study from the list
  And I select "USA" from "Country"
  And I select "North America" from "Region"
  And I fill in "Site Number" with "234"
  And I fill in "Site Name" with "SiteySiteful"
  And I select "Active" from "Status"
  And I select "ted" from "Investigator"
  And I select "ted" from "Primary Contact"
  And I fill in "password" with "password"
  And I click "Create Site"
  Then I should see "Site was successfully created" 
```

在这种情况下，该错误还有第二种表现形式。如果我首先创建了站点用户（这只是对工厂的调用），它会以站点用户身份登录管理员用户。

这是用户的工厂：

```
FactoryGirl.define do
factory :user do |u|
  sequence(:email) {|n| "example#{n}@verdacom.com" }
  sequence(:username) {|n| "user#{n}"}
  password "password"
  tmp_password "password"
  country_id 1
  user_state { FactoryGirl.create(:user_state) }
  password_confirmation {|u| u.password}
  first_name { Faker::Name.first_name }
  last_name { Faker::Name.last_name }
  work_phone "0123456789"
  mobile_phone "0123456789"
  timezone "Etc/UTC"
  diary_creation true
  diary { FactoryGirl.create(:diary) }
end

factory :admin_user, :parent => :user, :class => User do |s|
  sequence(:email) {|n| "admin#{n}@verdacom.com" }
  sequence(:username) {|n| "admin#{n}"}
  force_update_password false
  roles { [FactoryGirl.create(:admin_role)] }
end

factory :diary_author, :parent => :user, :class => User do |s|
  diary nil
end

factory :subject_user, :parent => :user, :class => User do |s|
  roles {[FactoryGirl.create(:subject_role)]}
  diary {FactoryGirl.create(:diary_with_registration_entry)}
  # s.organization { |user| user.association :site }
end

factory :site_user, :parent => :user, :class => User do
  sequence(:email) {|n| "site#{n}@verdacom.com" }
  sequence(:username) {|n| "site#{n}"}
  force_update_password false
  roles { [FactoryGirl.create(:site_role)] }
  # organization { |user| user.association :site }
end
end 
```

这是我的gemfile；值得注意的是 rails 3.1.5、devise、mysql2、activeadmin custom fork（不是我的选择）、cancan、guard、cucumber_rails 和 database_cleaner

```
source 'http://rubygems.org'

gem 'rails', '3.1.5'

gem 'mysql2'
gem 'activeadmin', :path => "vendor/gems/activeadmin-0.3.4", :git => "https://github.com/alexey/active_admin.git", :branch => "0.3.4-stable" #
gem "haml"
gem "rake", ">= 0.9.2"
gem "meta_search", '>= 1.1.0.pre'
gem 'cancan'
gem 'twiliolib'
gem 'paper_trail'
gem 'jquery-rails'
gem 'capistrano'
gem "capistrano-ext"
gem 'seed-fu', '~> 2.1.0'
gem "timezone"
gem "twilio-ruby"
gem "yettings"
gem "zipruby"
gem "whenever", :require => false
gem "newrelic_rpm"
gem "rabl"
gem 'andand'

gem "execjs"
gem "therubyracer"

gem "hoptoad_notifier", '2.3.11'

gem "faker" # need in development and production/staging also

gem 'sass-rails',   '~> 3.1.4'

group :assets do
  gem 'coffee-rails', '~> 3.1.1'
  gem 'uglifier', '>= 1.0.3'
end

group :test do
  gem 'turn', '< 0.8.3'
  gem 'cucumber-rails', require: false
  gem 'factory_girl_rails'
  gem 'launchy'
  gem "timecop" # for time travelling to test "entries" timeframe
  gem "rack-test"
  gem "prawn"   # for pdf test report generation
  gem "webrat" # simulte http interaction with remote service
end

group :test, :development do
  gem "rspec-rails", "~> 2.6"
  gem "shoulda"
  gem "simplecov" # rcov not supported in ruby 1.9

  gem 'capybara-webkit' # for headless testing
  gem 'database_cleaner'

  gem 'debugger'

  gem 'rb-fsevent'
  gem 'spork', '~> 1.0rc'
  gem 'guard'
  gem 'guard-spork'
  gem 'guard-rspec'
  gem 'guard-cucumber'
  gem 'single_test'
end

group :development do
  gem 'rails-footnotes', '>= 3.7.5.rc4'
  gem "rails-erd"
  gem 'pry'
  gem 'pry-rails'
  gem 'redcarpet'
  gem 'quiet_assets'
end

platforms :ruby do
  gem 'rb-readline'
end 
```

这是我对黄瓜的 database_cleaner 设置，这正是他们的 github 自述文件中的内容：

```
begin
  require 'database_cleaner'
  require 'database_cleaner/cucumber'
  DatabaseCleaner.strategy = :truncation
rescue NameError
  raise "You need to add database_cleaner to your Gemfile (in the :test group) if you wish to use it."
end

Before do
  DatabaseCleaner.start
end

 After do |scenario|
   DatabaseCleaner.clean
end 
```

任何帮助，将不胜感激。请询问任何可能相关的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T06:41:18.543

已解决：原作者曾用 af@#$ing 类变量记忆。

```
@@roles ||= Role.all 
```

当然，数据库清理器不会重置类变量，因为 f@#$ 谁在 ruby​​ 中使用类变量？

父母们，和你的孩子谈谈 ruby​​ 中的类变量。在别人做之前。

# objective-c - 在子视图中使用数据源中的数据到 initWithFrame

> ID：11868646
> 
> 赞同：0
> 
> 时间：2012-08-08T16:06:41.097
> 
> 标签：objective-c, initialization, datasource

我正在创建从其数据源获取有关其框架的信息的子视图类。我想创建一个自定义初始化方法，该方法将实现数据源协议的对象作为参数。数据源协议方法之一，frameSize，让数据源返回一个 CGrect。我的问题是是否可以在调用 [super initWithFrame] 之前在自定义初始化中设置数据源？这就是我所拥有的：

```
-(id) initWithDataSource:(id)dataSource
{
self._dataSource=dataSource;
[super initWithFrame:[self._dataSource frameSize];
return self;
} 
```

在调用初始化方法之前设置属性对我来说似乎违反直觉。有没有好的方法可以做到这一点，或者是否可以用空框架初始化它，然后再设置框架？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:08:08.720

我建议采用不同的方式，而不是使用临时矩形，然后四处移动。请记住，在将数据源实际分配为属性之前，没有什么可以阻止您使用数据源（尽管添加协议声明以使编译器满意）。

以下是我的做法：

```
-(id) initWithDataSource: (id<MyDataSourceProtocol>) ds {
    self = [super initWithFrame: [ds frameSize]];
    self.dataSource = ds;
    return self;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:45:45.663

一个 init 方法必须总是赋值`self = [super initXXX]`，因为 super init 方法可能返回一个与原来不同的值`self`。

但是您可以先调用`initWithFrame:`一个虚拟矩形并在`self`初始化后分配实际帧：

```
-(id) initWithDataSource:(id)dataSource
{
    self = [super initWithFrame:CGRectMake(0, 0, 1, 1)];
    if (self) {
        self._dataSource = dataSource;
        self.frame = [self._dataSource frameSize];
    }
    return self;
} 
```

# php - 类实例抛出内部服务器错误 500 (PHP, MYSQLi)

> ID：11868652
> 
> 赞同：0
> 
> 时间：2012-08-08T16:07:02.733
> 
> 标签：php, apache, mysqli, internal-server-error

我有一个奇怪的情况。

当一个类实例被传递给一个方法并且该类实例尚未设置时，服务器会抛出一个 500 错误，而不是捕获该错误。

*这发生在 99% 的测试期间，但我想确保用户在这 1% 的时间内永远不会看到它*

顺便说一句：我已经检查了我的`.htaccess`和`apache2`文件 <= 它们是正确的

**我需要在我的`php.ini`文件中更改什么或类似的内容以避免`500`每次发生这种错误时出现错误？**

这是一些示例代码：

```
<?php

function querysomething ($connection_to_mysql, $query) {
  try {
    $query = $connection_to_mysql->prepare("SELECT * FROM table WHERE name=?");
    $query->bind_param("s", $name);
    $execute = $query->execute();
    //etc...
    if (!$execute) {
      throw new Exception ("some error");
    }
  } catch (Exception $e) {
    //some error handling
  }
}

?> 
```

**如果`$connection_to_mysql`对象没有实例化，服务器会抛出`500`错误**

**我是否需要在`$connection_to_mysql`每次查询之前检查是否确实存在？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:52:18.173

使用`set_error_handler`/`set_exception_handler`显示特定于 php 致命错误的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:59:54.330

在对捕获进行了一些额外的阅读之后`Fatal Errors`，我可以理解这一点：[如何捕获 PHP 致命错误](https://stackoverflow.com/questions/277224/how-do-i-catch-a-php-fatal-error)

而不是使用`set_error_handler`&`set_exception_handler`来捕获所有错误并处理后记使用`register_shutdown_functions`.

这将允许您重定向到一个页面（例如：500.php 或其他），记录错误，并在需要时发送电子邮件。

# mysql - 如何获取 MySQL 表的创建日期？

> ID：11868656
> 
> 赞同：71
> 
> 时间：2012-08-08T16:07:15.027
> 
> 标签：mysql, sql, sql-server, database

我想知道是否可以获取数据库中特定表的创建日期。我的雇主想添加此功能，但我无法通过 Google 找到解决方案。

我认为 SO 是下一个最好看的地方。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2012-08-08T16:09:12.913

您将查询`information_schema`表`create_time`的。

例如：

```
SELECT create_time FROM INFORMATION_SCHEMA.TABLES
  WHERE table_schema = 'your_schema'
  AND table_name = 'your_table' 
```

**参考**：[http ://dev.mysql.com/doc/refman/5.0/en/tables-table.html](http://dev.mysql.com/doc/refman/5.0/en/tables-table.html)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-05-21T07:11:36.570

我知道这是一个老问题，但我想提出一种替代方法，该方法不需要直接查询 information_schema 表，供以后查找此问题以供参考的任何人使用。

您可以使用“显示表​​状态”获取有关表的信息。它为您提供了大量信息，包括正在使用的存储引擎、创建时间、更新时间和行数。

您可以根据表的名称过滤结果，如下所示：

```
show table status where name = 'your-table-name' 
```

# ios - 有人让 [[NSBundle mainBundle] pathForResource:ofType:inDirectory] 递归工作吗？

> ID：11868657
> 
> 赞同：1
> 
> 时间：2012-08-08T16:07:27.507
> 
> 标签：ios, cocoa, foundation

我一直在寻找一种在我的主包中递归搜索子目录的方法。乍一看，NSBundle 上定义的实例方法“--pathForResource:ofType:inDirectory:”似乎可以完成这项工作。它指定如果您传入“nil”作为资源类型，该方法将搜索所有子目录以查找与资源名称匹配的给定资源。

[https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSBundle_Class/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSBundle_Class/Reference/Reference.html)

我试过这样：

`NSString *pathForResource = [[NSBundle mainBundle] pathForResource:spriteFrameName ofType:nil inDirectory:@"images"];`

不幸的是，这不起作用。查看文档似乎还说它返回了一个 pathNames 数组，即使返回值被声明为“NSString *”。

在谈到递归子目录时，它指向国际化资源，这让我相信递归可能与相关资源语言目录有关，但这种意图不知何故让我迷失了。

我是因为没有让这个工作而出去吃午饭，还是这只是一个令人困惑的文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:20:59.213

我认为您发现了文档错误。

要递归搜索您的包，请发送`resourcePath`到包，然后将其传递到`NSFileManager`消息`enumeratorAtPath:`中。

# jquery - jquery下拉输入框不能正常工作

> ID：11868658
> 
> 赞同：0
> 
> 时间：2012-08-08T16:07:35.603
> 
> 标签：jquery

我在包含登录文本字段的页面顶部创建了一个小 div。一切正常，当页面加载时文本框会显示，但是我希望它是当页面加载时它不应该显示，直到我单击下面的按钮将其下拉。现在它在加载时以相反的方式工作，然后我必须单击它来关闭它。有人可以帮我解决这个问题以下是我的代码

```
//JQuery

      $(".logbtn").click(function(){ 
      $("#loginbox").slideToggle("slow");
      $(this).toggleClass("active");

    }); 
```

// HTML

```
 <div id="log">

 <div id="loginbox">
 <form method="post" action="login.php">
   <p><input type="text" name="username"  value="username" id="usernamelog"/></p>
   <p>Password: <input type="password" name="password" /></p>
   <p><input type="submit" name="login" value="Login"/></p>  
 </form>

 </div>
 <a class="logbtn">Login</a>

 </div> 
```

//CSS

```
div#log{
width:301px;
position:absolute;
margin-top:0px;
margin-left:650px;
}

div#loginbox{
width:300px;
background-color:#efebee;
padding-left:10px;
top:2px;
padding-bottom:10px;
border-radius:5px;
       -moz-border-radius:5px;
       -webkit-border-radius:5px;
}

.logbtn{
 width:200px;
 background-color:black;
 padding:7px 30px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:08:52.950

添加`display:none`到您的`div#loginbox`CSS 规则中。这将最初隐藏它，然后您的 jQuery`slideToggle`调用将显示它。

**[jsFiddle 示例](http://jsfiddle.net/j08691/mBLcv/)**

# android - Android：IAM 用户和 S3

> ID：11868663
> 
> 赞同：0
> 
> 时间：2012-08-08T16:07:54.357
> 
> 标签：android, amazon-s3, amazon-web-services, amazon-iam

我正在使用安卓设备和亚马逊的 S3 存储系统。

我有一个主用户帐户，并且我创建了代表我的用户访问存储的子用户。

通常，我会使用以下操作与我的主要用户访问 S3：

```
AmazonS3Client s3Client = new AmazonS3Client(
                             new BasicAWSCredentials(ACCESS_KEY_ID, SECRET_KEY));
Bucket deviceBucket = s3Client.createBucket(bucketName); 
```

其中 ACCESS_KEY_ID 和 SECRET_KEY 是为我的主要用户帐户提供的。

我正在尝试对我的 IAM 用户“Alice”执行此操作。这个用户被赋予了它自己的 ACCESS_KEY_ID。使用上面的代码，我使用 Alice 的 ACCESS_KEY_ID 和上面的相同 SECRET_KEY。用户 Alice 没有特殊的权限或限制，因此我假设用户可以创建存储桶。

调用createBucket的时候报错：

```
08-08 12:05:55.246: E/AndroidRuntime(2544): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=1, result=-1, data=Intent { dat=content://media/external/images/media/1 }} to activity {com.amazonaws.demo.s3uploader/com.amazonaws.demo.s3uploader.S3UploaderActivity}: Status Code: 403, AWS Service: Amazon S3, AWS Request ID: (somevalue), AWS Error Code: SignatureDoesNotMatch, AWS Error Message: The request signature we calculated does not match the signature you provided. Check your key and signing method., S3 Extended Request ID: (some value) 
```

我似乎找不到另一种使用 IAM 用户通过 Android API 对 S3 进行身份验证的方法。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T04:28:48.410

您的`IAM`用户将拥有与`SECRET_KEY`您的 root 帐户不同的帐户。

当您创建 IAM 账户时，您应该已经收到`ACCESS_KEY_ID`和`SECRET_KEY`必须结合使用的账户。您收到的错误表示密钥不匹配或其中一个密钥有错字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-12T21:35:11.063

在 AWS 生态系统中，权限是明确授予的。没有权限意味着用户将没有权限。访问密钥 ID 和密钥是一个组合，没有 2 个访问密钥可以具有相同的密钥。

为访问密钥使用正确的密钥。

# netbeans - 使用 netbeans 7.1.2 创建 UML 图

> ID：11868666
> 
> 赞同：0
> 
> 时间：2012-08-08T16:08:06.253
> 
> 标签：netbeans

我正在使用 netbeans 7.1.2 创建我的 GUI 应用程序。我想知道如何从我的源代码（逆向工程）创建类图，因为我在网上看不到任何插件信息。如果有人对这个软件有任何经验，请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:20:13.457

最新版本的 NetBeans 没有此功能。6.7 及更早版本包括此功能。如果我没记错的话，您可以双向同步更改。

更多信息：http: [//netbeans.org/features/uml/](http://netbeans.org/features/uml/)

# android - onWindowFocusChanged 对话框除外

> ID：11868673
> 
> 赞同：1
> 
> 时间：2012-08-08T16:08:25.240
> 
> 标签：android, dialog, focus

我目前检查我的活动的焦点是否已经改变`onWindowFocusChanged()`（例如，按下主页按钮或它已切换到不同的活动），如果有，我会调用`finish()`它。我的问题是，我*只*希望它在按下主页按钮或其他活动已开始使用的情况下工作`startActivity()`，但是像警报对话框之类的东西可能会导致焦点改变并因此完成活动。如何仅在按下主页按钮或使用启动另一个活动时才完成活动`startActivity()`，而不是在出现对话框之类的东西时才完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:16:39.540

如果你打电话`finish()`，那将在它不再可见时`onStop()`摧毁你。`Activity`标准对话框只会`onPause()`被调用。在活动生命周期事件发生时记录它们，您可以检查哪些操作触发了它们。

# objective-c - 核心情节 - 反转情节和标签

> ID：11868674
> 
> 赞同：0
> 
> 时间：2012-08-08T16:08:28.380
> 
> 标签：objective-c, plot, core-plot

我在显示正确的绘图时遇到问题。我使用了 RealTimePlot 中的一些代码（[http://code.google.com/p/core-plot/source/browse/examples/CorePlotGallery/src/plots/RealTimePlot.m](http://code.google.com/p/core-plot/source/browse/examples/CorePlotGallery/src/plots/RealTimePlot.m)）。不知道为什么剧情反转了。有一张照片显示了这个问题。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [self generateDataSamples];

    CPTGraphHostingView *hostingView = [[[CPTGraphHostingView alloc] initWithFrame:self.view.bounds] autorelease];
    [self.view addSubview:hostingView];

    graph = [[CPTXYGraph alloc] initWithFrame:self.view.bounds];
    hostingView.hostedGraph = graph;

    CPTTheme *theme = [CPTTheme themeNamed:kCPTSlateTheme];
    [graph applyTheme:theme];

    graph.plotAreaFrame.paddingTop = 15;
    graph.plotAreaFrame.paddingRight = 40;
    graph.plotAreaFrame.paddingBottom = 15;
    graph.plotAreaFrame.paddingLeft = 55;

    // Grid line styles
    CPTMutableLineStyle *majorGridLineStyle = [CPTMutableLineStyle lineStyle];
    majorGridLineStyle.lineWidth = 0.75;
    majorGridLineStyle.lineColor = [[CPTColor colorWithGenericGray:0.2] colorWithAlphaComponent:0.75];

    CPTMutableLineStyle *minorGridLineStyle = [CPTMutableLineStyle lineStyle];
    minorGridLineStyle.lineWidth = 0.25;
    minorGridLineStyle.lineColor = [[CPTColor whiteColor] colorWithAlphaComponent:0.1]; 

    // Axes
    // X axis
    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)graph.axisSet;
    CPTXYAxis *x = axisSet.xAxis;
    x.labelingPolicy = CPTAxisLabelingPolicyAutomatic;
    x.orthogonalCoordinateDecimal = CPTDecimalFromUnsignedInteger(0);
    x.majorGridLineStyle = majorGridLineStyle;
    x.minorGridLineStyle = minorGridLineStyle;
    x.minorTicksPerInterval = 9;
    x.title = @"X Axis";
    x.titleOffset = 35.0;
    NSNumberFormatter *labelFormatter = [[NSNumberFormatter alloc] init];
    labelFormatter.numberStyle = NSNumberFormatterNoStyle;
    x.labelFormatter = labelFormatter;
    [labelFormatter release];

    // Y axis
    CPTXYAxis *y = axisSet.yAxis;
    y.labelingPolicy = CPTAxisLabelingPolicyAutomatic;
    y.orthogonalCoordinateDecimal = CPTDecimalFromUnsignedInteger(0);
    y.majorGridLineStyle = majorGridLineStyle;
    y.minorGridLineStyle = minorGridLineStyle;
    y.minorTicksPerInterval = 3;
    y.labelOffset = 5.0;
    y.title = @"Y Axis";
    y.titleOffset = 30.0;
    y.axisConstraints = [CPTConstraints constraintWithLowerOffset:0.0];

    // Rotate the labels by 45 degrees, just to show it can be done.
    //x.labelRotation = M_PI * 0.25;

    // Create the plot
    CPTScatterPlot *dataSourceLinePlot = [[[CPTScatterPlot alloc] init] autorelease];
    dataSourceLinePlot.identifier = kPlotIdentifier;
    dataSourceLinePlot.cachePrecision = CPTPlotCachePrecisionDouble;

    CPTMutableLineStyle *lineStyle = [[dataSourceLinePlot.dataLineStyle mutableCopy] autorelease];
    lineStyle.lineWidth = 3.0;
    lineStyle.lineColor = [CPTColor greenColor];
    dataSourceLinePlot.dataLineStyle = lineStyle;

    dataSourceLinePlot.dataSource = self;
    [graph addPlot:dataSourceLinePlot];

    // Plot space
    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;
    plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromUnsignedInteger(0) length:CPTDecimalFromUnsignedInteger(kMaxDataPoints - 1)];
    plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromUnsignedInteger(0) length:CPTDecimalFromUnsignedInteger(250)];
} 
```

![反转情节](../Images/dd40c58e9c45fd621434edc6e948400a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:50:11.407

iOS`CPTGraphHostingView`将翻转变换应用于托管图形，因此 Core Plot 可以在 iOS 和 Mac 之间共享绘图代码。确保托管视图及其所有超级视图都使用它们的默认转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T16:31:54.543

尝试添加

```
[hostingView setTransform:CGAffineTransformMakeScale(1,-1)]; 
```

就在将hostingView 添加到self.view 之前。

我为 iOS7 使用 Xcode 5.0，这解决了这个问题。

# sql-server - 多 SELECT SQL 语句

> ID：11868675
> 
> 赞同：4
> 
> 时间：2012-08-08T16:08:30.410
> 
> 标签：sql-server, nested-queries

写我的第一个嵌套`SELECT`语句，我希望有人能帮助我。

我需要从桌子上抓起`CompanyCode`and 。但是，我只需要在另一个表的查询中显示的那些。行之间的公共链接将是列（基本上我需要从包含与嵌套查询中出现的相同的行中获取和）。`AgentId``UniqueAgentIdtoUniqueAgentId``UniqueAgentId``CompanyCode``AgentId``UniqueAgentId`

当我写出这个查询时，我得到了非常有用的信息

> ')' 附近的语法不正确

询问：

```
SELECT 
    CompanyCode, AgentId
FROM 
    UniqueAgentIdToUniqueAgentId un
WHERE 
    un.UniqueAgentId = 
       (SELECT UniqueAgentId 
        FROM 
            (SELECT q.LastChangeDate, a.UniqueAgentId 
             FROM QueueUpdates q, AgentProductTraining a 
             WHERE a.LastChangeDate >= q.LastChangeDate)
       ) 
```

编辑非常感谢您的回复。使用下面的每个查询，但我不断收到相同的错误消息：无效的对象名称“UniqueAgentIdToUniqueAgentId”。这对我来说很奇怪，因为这是 SQL Management Studio 可以看到的数据库上的实际表。

第二次编辑结果证明这只是一个拼写错误。新错误是“varchar 值 '3030111101' 的转换溢出了一个 int 列。” 不太清楚这意味着什么......

最终编辑我试图将一个字符与一个它进行比较，这导致了这个错误。再次感谢所有的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:15:10.997

当你在许多数据库中有一个子查询时，你需要给它一个别名：

```
SELECT CompanyCode, AgentId
FROM UniqueAgentIdToUniqueAgentId un
WHERE un.UniqueAgentId = 
      (SELECT UniqueAgentId 
       FROM (SELECT q.LastChangeDate, a.UniqueAgentId 
             FROM QueueUpdates q, AgentProductTraining a 
             WHERE a.LastChangeDate >= q.LastChangeDate
            ) t
      ) 
```

但是，您的内部查询可能会返回多个值，并且您不需要两个嵌套查询：

```
SELECT CompanyCode, AgentId
FROM UniqueAgentIdToUniqueAgentId un
WHERE un.UniqueAgentId in
      (SELECT UniqueAgentId 
       FROM QueueUpdates q, AgentProductTraining a 
       WHERE a.LastChangeDate >= q.LastChangeDate
      ) 
```

而且，在这种情况下使用 JOIN 语法更合适：

```
SELECT CompanyCode, AgentId
FROM UniqueAgentIdToUniqueAgentId un
WHERE un.UniqueAgentId in
      (SELECT UniqueAgentId 
       FROM QueueUpdates q join
            AgentProductTraining a 
            on a.LastChangeDate >= q.LastChangeDate
      ) 
```

那应该有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:15:04.817

您的子查询可能返回超过 1 个值。您必须使用 IN。
您也可以避免使用两个子查询而只使用一个。

```
SELECT CompanyCode, AgentId
FROM UniqueAgentIdToUniqueAgentId un
WHERE un.UniqueAgentId IN 
(
    SELECT a.UniqueAgentId 
    FROM QueueUpdates q, AgentProductTraining a 
    WHERE a.LastChangeDate >= q.LastChangeDate
) 
```

**请注意**，通过这种方式，您可以获得表别名**q**和**a的****笛卡尔积**。我不知道这是否是您想要的；也许加入应该更好。

 ***** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:11:44.603

```
SELECT CompanyCode, AgentId
    FROM UniqueAgentIdToUniqueAgentId un
    WHERE un.UniqueAgentId = 
    (
        SELECT UniqueAgentId 
         FROM AgentProductTraining  where UniqueAgentId IN
           (
            SELECT q.LastChangeDate, a.UniqueAgentId 
            FROM QueueUpdates q, AgentProductTraining a 
            WHERE a.LastChangeDate >= q.LastChangeDate
            )
    ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T16:12:05.210

您需要声明一个别名，这是您实际报告的问题，并且可能使用该`IN`子句而不是`=`运算符来进行多次返回：

```
SELECT CompanyCode
    ,AgentId
FROM UniqueAgentIdToUniqueAgentId un
WHERE un.UniqueAgentId in (
        SELECT UniqueAgentId
        FROM (
            SELECT q.LastChangeDate
                ,a.UniqueAgentId
            FROM QueueUpdates q
                ,AgentProductTraining a
            WHERE a.LastChangeDate >= q.LastChangeDate
            ) a 
        ) 
```****

# java - 自定义 HTTP 请求标头

> ID：11868678
> 
> 赞同：2
> 
> 时间：2012-08-08T16:08:43.023
> 
> 标签：java, http, servlets

我正在尝试使用[Google Http Client 库](https://github.com/google/google-http-java-client)将自定义标头发送到我的 Web 应用程序，如下所示：

```
 HttpRequest request = requestFactory.buildGetRequest(url);
    HttpHeaders headers = new HttpHeaders();
    headers.set("custom", "somevalue");
    request.setHeaders(headers);
    HttpResponse response = request.execute(); 
```

但是，当我尝试枚举 Web 应用程序接收到的标头时，我在 Java 客户端中添加的标头不存在，可能缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:23:19.773

尝试使用 wireshark 来检查流量，看看它是否真的被发送了。这将告诉您问题出在客户端还是服务器端。

Tichodrama 是对的，双方可能都要求您为自定义标题使用前缀 X-。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-30T11:22:42.580

您需要在密钥前加上 X- 例如 httpChannel.setRequestHeader("X-Key", "value")

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-08T16:29:32.213

怎么样： `request.addHeader("custom", "somevalue")`？

# java - 拆分方法java

> ID：11868679
> 
> 赞同：2
> 
> 时间：2012-08-08T16:08:44.027
> 
> 标签：java, split

我想知道从字符串中删除句点而不影响十进制数的正则表达式，然后将它们存储为单独的标记

```
str = "..A 546.88 end." 
```

在上面的字符串值中，我只需要值“546.88”、“A”、“end”并将它们存储到一个数组中

感谢帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:11:05.553

最通用的是：

```
[0-9]+(\.[0-9][0-9]?)? 
```

我创建了一个小样本来执行您在评论中提出的要求：

> 我想要的是一个包含“A”、“546.88”、“end”的数组，如果可能的话

```
public class JavaApplication39 {

    static String str = "..A 546.88 end.";

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        // Create a pattern to match breaks
        Pattern p = Pattern.compile("[0-9]+(\\.[0-9][0-9]?)?");
        // Split input with the pattern
        String[] result = p.split(str);
        Matcher m = p.matcher(str);
        ArrayList<String> strings = new ArrayList<>();

        while (m.find()) {//all those that match
            strings.add(m.group());
            //System.out.println(m.group());
        }

        for (int i = 0; i < result.length; i++) {//all those that dont match
            strings.add(result[i].replaceAll("\\.", "").trim());//strip '.' and ' '
            // System.out.println(result[i]);
        }
        //all contents in array
        for (Iterator<String> it = strings.iterator(); it.hasNext();) {
            String string = it.next();
            System.out.println(string);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:23:32.490

你似乎有两个问题。首先是删除不属于十进制数的所有句点，您可以通过保留以下正则表达式中的两个组来做到这一点：

```
"(.*(\\D|^))\\.+((\\D|$).*)" 
```

这个正则表达式是：任何东西 - 不是数字或行首 - 句点 - 不是数字或行尾 - 任何东西

```
String s = "..A 546.88 .end.";
Pattern p = Pattern.compile("(.*(\\D|^))\\.+((\\D|$).*)");
Matcher m = p.matcher(s);
while(m.matches())
{
    s = m.group(1) + "" + m.group(3);
    System.out.println(s);
    m = p.matcher(s);
} 
```

给

```
A 546.88 end 
```

第二个问题是从剩余的字符串中获取三个值，您可以使用`myString.split("\\s+")`它们 - 它为您提供数组中的三个值。

```
String[] myArray = s.split("\\s+"); 
```

# php - 如何以编程方式检索 Excel 中的单元格注释？

> ID：11868689
> 
> 赞同：0
> 
> 时间：2012-08-08T16:09:21.797
> 
> 标签：php, excel, export

我最近将一些大型 excel 2010 电子表格（已导出为 CSV 用于导入）导入数据库。我现在被告知缺少单元格注释（我什至不知道原始 Excel 文件中有单元格注释，我只有 CSV）。

我需要搜索 Excel 文件的每一行，找到带有单元格注释的单元格，获取注释并将其添加到该行的数据库中（数据库引用电子表格中的行号，所以如果我可以提取行号和所有该行中的单元格注释，这是完美的）

我的技能是 PHP 和 Perl。理想情况下，我会使用 PHP 来读取和处理数据，但使用其他东西来输出 text/csv，然后我可以用 PHP 解析它也可以正常工作。

有谁知道提取这些单元格注释的方法，或者有任何指针？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:25:25.110

使用[PHPExcel](http://www.phpexcel.net)库。对工作表持有评论。并且工作表的 getComments() 方法将返回一个由它们的单元格地址索引的注释对象数组。

**编辑**

```
include '/PHPExcel_Library/Classes/PHPExcel.php';

$inputFileType = 'Excel5';
$inputFileName = 'CS2template_all_products_v12.xls';

$objPHPExcelReader = PHPExcel_IOFactory::createReader($inputFileType);
$objPHPExcel = $objPHPExcelReader->load($inputFileName);

$sheet = $objPHPExcel->getActiveSheet();

$comments = $sheet->getComments();
foreach($comments  as $cellID => $comment) {
    echo $cellID,PHP_EOL;
    var_dump($comment->getText()->getPlainText());
} 
```

请注意，我的示例使用 Excel .xls 文件，但该方法同样可以轻松地将 $inputFileType 替换为 .xlsx 文件的“Excel2007”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T20:49:22.553

我不能相信这个。我从这个网站得到了如果：http: [//chandoo.org/wp/2009/09/03/get-cell-comments/](http://chandoo.org/wp/2009/09/03/get-cell-comments/)

只需在 VBA 中插入一个模块，然后将其复制并粘贴到：

```
Function getComment(incell) As String
 ' accepts a cell as input and returns its comments (if any) back as a string
 On Error Resume Next
 getComment = incell.Comment.Text
End Function 
```

只需将其放在一个单元格中，使用评论引用该单元格并自动填充您的心脏内容。例如：

```
=getComment(C42) 
```

如果你需要一行的行号，你可以这样做：

```
=row() 
```

不知道你是否需要知道这一点，但我只是想我会把它加进去。

# asp.net-mvc-3 - 不在表单上时，帖子上的 MVC3 数据丢失？

> ID：11868691
> 
> 赞同：3
> 
> 时间：2012-08-08T16:09:26.283
> 
> 标签：asp.net-mvc-3, entity-framework-4, persistence, automapper, dto

我正在开发一个 MVC3 项目，我注意到当从 UI 更新该记录时，数据库中的某些字段被设置为空。发生这种情况是因为这些字段在发布时的表单上不存在。我知道这可以通过为这些添加 HiddenFor 条目来解决，但这不是一个好方法，因为还需要在那里添加任何新字段。我希望能找到更好的解决方案。

关于项目结构的一些详细说明：

我们有与 EF 实体完全匹配的 DTO，以简化映射。因此，DTO 的每个字段都存在于实体和数据库中。我们使用 DTO 作为我们的模型。

控制器将 DTO 传递给服务层。服务层将 DTO 映射到其各自的实体（使用 AutoMapper），并将其传递给持久层。持久层实际上是使用 DbContext 来保存更改。

假设我们有一个带有 Name 成员和 FolderPath 成员的 Client DTO，以及一个在其表单上只有 Name 成员的视图。表单发布，并且该 FolderPath 为空。该空值一直持续到持久层中的更新。在某个地方，我必须指定我不希望该特定值覆盖数据库中的内容。

从我收集的关于 SO 的研究中收集了大约一个小时，一种方法可能是......

1.  对于我们知道我们将在视图中的表单上拥有的一组特定字段，保持 DTO 的范围最小。
2.  [根据此答案](https://stackoverflow.com/a/6474397/474965)，告诉 AutoMapper 忽略目标中存在的任何内容，但不忽略源中存在的任何内容。
3.  在服务层，在将 DTO 映射到实体时，首先从数据库中检索现有的实体。映射只会覆盖属于 DTO 的成员，并且任何其他值都将保留，因为它们是从数据库中检索的。

这会是一种有效的方法吗？有没有更好或更常见的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:15:03.307

我会选择选项 1 并查看/html 表单特定模型。这是最干净的解决方案，恕我直言。

还有一个主要问题是其他方式让您对黑客攻击持开放态度......即，如果我知道您模型上的其他字段/属性，我可以使用该信息制作一个表单帖子并将其保存。

# struts2 - WebSphere Application Server 8 (WAS 8) 上的 Struts 2 和自定义错误页面

> ID：11868692
> 
> 赞同：2
> 
> 时间：2012-08-08T16:09:36.987
> 
> 标签：struts2, web.xml, custom-error-pages, websphere-8

我们正在将我们的服务器从 WAS 7 迁移到 WAS 8，并面临 WAS 7 中不会发生的问题：如果请求的 URL 无效，WAS 7 会响应我们设置的自定义错误页面`web.xml`，这是一个 JSP 并使用 Struts标签。然而，在 WAS 8 中，它没有，并在下面显示错误页面/堆栈跟踪。只有在无效的 URL 没有默认的 struts 扩展时才会发生这种情况，所以我认为问题出在`web.xml`配置上，其片段显示在错误页面之后。

**错误页面/堆栈跟踪**

```
Error Page Exception
SRVE0260E: The server cannot use the error page specified for your application to handle the Original Exception printed below.

Original Exception:
Error Message: javax.servlet.ServletException: java.io.FileNotFoundException: SRVE0190E: File not found: /whatever
Error Code: 404
Target Servlet: com.ibm.ws.webcontainer.extension.DefaultExtensionProcessor
Error Stack:
java.io.FileNotFoundException: SRVE0190E: File not found: /whatever
     at com.ibm.ws.webcontainer.extension.DefaultExtensionProcessor._processEDR(DefaultExtensionProcessor.java:874)
     at com.ibm.ws.webcontainer.extension.DefaultExtensionProcessor.processEDR(DefaultExtensionProcessor.java:855)
     at com.ibm.ws.webcontainer.extension.DefaultExtensionProcessor.handleRequest(DefaultExtensionProcessor.java:433)
     at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:125)
     at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:92)
     at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:389)
     at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:192)
     at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:89)
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:919)
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1016)
     at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3703)
     at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:304)
     at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:953)
     at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1655)
     at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:276)
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214)
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113)
     at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
     at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
     at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
     at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
     at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
     at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
     at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
     at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1650)

Error Page Exception:
Error Message: The Struts dispatcher cannot be found. This is usually caused by using Struts tags without the associated filter. Struts tags are only usable when the request has passed through its servlet filter, which initializes the Struts dispatcher needed for this tag. - [unknown location]
Error Code: 0
Target Servlet:
Error Stack:
The Struts dispatcher cannot be found. This is usually caused by using Struts tags without the associated filter. Struts tags are only usable when the request has passed through its servlet filter, which initializes the Struts dispatcher needed for this tag. - [unknown location]
     at org.apache.struts2.views.jsp.TagUtils.getStack(TagUtils.java:60)
     at org.apache.struts2.views.jsp.StrutsBodyTagSupport.getStack(StrutsBodyTagSupport.java:44)
     at org.apache.struts2.views.jsp.ComponentTagSupport.doStartTag(ComponentTagSupport.java:48)
     at com.ibm._jsp._error404._jspx_meth_s_i18n_0(_error404.java:374)
     at com.ibm._jsp._error404._jspService(_error404.java:108)
     at com.ibm.ws.jsp.runtime.HttpJspBase.service(HttpJspBase.java:99)
     at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
     at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1152)
     at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:722)
     at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:449)
     at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:178)
     at com.ibm.wsspi.webcontainer.servlet.GenericServletWrapper.handleRequest(GenericServletWrapper.java:122)
     at com.ibm.ws.jsp.webcontainerext.AbstractJSPExtensionServletWrapper.handleRequest(AbstractJSPExtensionServletWrapper.java:205)
     at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:125)
     at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:77)
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:919)
     at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1016)
     at com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.dispatch(WebAppRequestDispatcher.java:1384)
     at com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.forward(WebAppRequestDispatcher.java:193)
     at com.ibm.ws.webcontainer.webapp.WebApp.sendError(WebApp.java:3206)
     at com.ibm.ws.webcontainer.webapp.WebApp.handleException(WebApp.java:3733)
     at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3714)
     at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:304)
     at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:953)
     at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1655)
     at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:276)
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214)
     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113)
     at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
     at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
     at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
     at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
     at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
     at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
     at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
     at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1650) 
```

**WEB.XML 片段**

```
<filter>
    <filter-name>struts-cleanup</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ActionContextCleanUp</filter-class>
</filter>

<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
</filter>

<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<error-page>
    <error-code>404</error-code>
    <location>/error/error404.jsp</location>
</error-page>
<error-page>
    <error-code>500</error-code>
    <location>/error/error500.jsp</location>
</error-page> 
```

由于它在 WAS 7 上运行良好，我想知道我错过了什么？是否需要进行任何配置更改才能让 struts 在 WAS 8 上处理自定义错误页面？请注意，我们仍然使用相同的配置文件，并且仍然指向 2.4 servlet，如以下代码片段所示：

```
<web-app id="WebApp_ID" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee
         http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T13:58:03.553

联系产品支持后，解决方案是向 web.xml 添加一个附加映射，以使 ERROR 调度程序也映射到 Struts 过滤器，如下所示：

```
<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/error/*</url-pattern>
    <dispatcher>ERROR</dispatcher>
</filter-mapping> 
```

看起来，在没有针对特定调度程序的映射的情况下，WAS 7 使用默认值，而 WAS 8 不会将请求传递给任何过滤器（因为没有映射）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T07:20:27.023

在使用包含 Struts2 标记的自定义错误页面从 WAS 6.1 迁移到 WAS 8.5 期间，我遇到了同样的问题。

因为您使用 Struts2 标记，所以您必须在 struts.xml 中定义您的 JSP。请参阅下面的示例。

**网页.xml：**

```
<error-page>
    <error-code>403/error-code>
    <location>/error403.html</location>  
</error-page> 
```

**struts.xml：**

```
<constant name="struts.action.extension" value="html, jsp" />
...
<package name="globals" extends="struts-default" namespace="/">
    ...
    <action name="error403">
        <result>/WEB-INF/pages/error/403.jsp</result>
    </action>
    ...
</package> 
```

您是否尝试将 com.ibm.ws.webcontainer.invokeFiltersCompatibility 设置为 true？

# symfony - 会话 Symfony2 不保留值

> ID：11868701
> 
> 赞同：3
> 
> 时间：2012-08-08T16:10:15.273
> 
> 标签：symfony

```
class myController extends Controller
{
    public function newAction($id)
    {
        $session = $this->get('session');

        if(is_null(($session->get('foo')))){
            echo "the variable foo is no set in session";
            $session->set('foo', 'bar');
        }
    }
} 
```

为什么每次加载动作时都会出现回声的味精？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T12:19:49.713

这对我有用：

```
class SessionTestController extends Controller
{
    public function testAction()
    {
        $session = $this->get('session');

        if (is_null($session->get('foo'))) {
            $session->set('foo', 'bar');
            $responseText = 'foo is null';
        } else {
            $responseText = 'foo is set';
        }

        // Use a response object
        return new Response($responseText);
    }
} 
```

# css - Sharepoint 2010 品牌推广：应用自定义样式的问题

> ID：11868706
> 
> 赞同：1
> 
> 时间：2012-08-08T16:10:37.913
> 
> 标签：css, sharepoint, branding

大家好——我是 Sharepoint 的新手，我正在尝试为我的工作人员建立一个面向 Internet 的网站/为其打造品牌。

为了将站点限制为居中、固定宽度的布局，我在 coreV4.css 文件中添加了以下代码：

```
#s4-bodyContainer { 
width: 960px !important; 
margin: 0px auto; 
} 
```

……效果很好。但是 - 后来有人告诉我 coreV4 样式表不应该被修改，所以我将文件恢复到原来的状态，并将上面的代码添加到我已经附加到站点的第二个样式表中。它从母版页的头部链接，如下所示：

```
<link rel="stylesheet" type="text/css" href="/Style%20Library/CSS/combined.css" runat="server" After="corev4.css"/> 
```

问题：Sharepoint 拒绝“看到”第二个样式表中的#s4-bodycontainer 片段。它确实可以识别该样式表的其他部分——例如，我为内容编辑器 web 部件创建的样式可以正常工作——但不能识别与 s4-bodycontainer 相关的代码。

我只想将该代码返回给 coreV4.css 并称之为一天，但这是我的另一个问题：没有一个子站点指向该文件的迭代（位于 _styles 文件夹中），而我没有不知道如何改变。相反，它们指向位于 Sharepoint 文件结构腹地深处的文件的其他副本（显然在 _layouts 下-我认为我无权访问它）。

任何指导将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:32:58.267

这是一篇了解品牌发布网站的好文章（用于 SharePoint 上面向 Internet 的网站的模板）：[SharePoint 2010 的真实世界品牌](http://msdn.microsoft.com/en-us/library/gg430141.aspx)。

根据您想要自定义 OOTB 模板的程度，品牌塑造任务可能会变得更复杂或更容易。打开 SharePoint 设计器并更改站点实例是最容易开始的，但从长远来看，您可能希望[创建解决方案包](http://msdn.microsoft.com/en-us/library/ee231544.aspx)来部署所有自定义项，以便您可以维护它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:52:06.330

是的，您确实不想更新 covev4.css 或实际上在 14 配置单元中找到的任何 SharePoint 文件。您的其他站点正在使用相同的 corev4.css 文件，即使该路径似乎来自 _layouts 目录。这只是链接到配置单元文件的 SharePoint 方式。

首先，您的自定义 css 可能需要一个 !important 标签，即

```
#s4-bodyContainer {  
width: 960px !important;  
margin: 0px auto;  
} 
```

但是，在 SP 中，居中、固定宽度的站点远不止这些。您需要考虑对话框、站点设置页面、列表页面等。我推荐以下 CodePlex 项目，其中包括其他示例、居中、固定宽度的母版页，其中包含必要的样式表和其他资产，以解决发现的许多问题在 SharePoint 中居中的固定宽度网站中。

[http://jumpstartbranding.codeplex.com](http://jumpstartbranding.codeplex.com)

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T18:35:45.943

以下是我处理我的 SharePoint 2010 品牌的方式，就像我不接触开箱即用的“coreV4.css”的其他品牌一样：

1.  打开 SharePoint Designer，在“/Style Library”文件夹中创建一个名为“overwrites.css”的文件。

2.  接下来将此 CSS 粘贴到新创建的文件中并保存：

    /* 居中，固定布局 */ div.s4-title.s4-lp, #s4-titlerow, #s4-mainarea, #s4-topheader2, #s4-statusbarcontainer { width: 960px; 边距：自动；填充：0px；浮动：无；}

3.  然后在 SharePoint Designer 中编辑 MasterPage 并在“coreV4.css”之后引用 CSS 文件，如下所示：

    SharePoint:CssRegistration name="/Style Library/overwrites.css" After="corev4.css" runat="server"/>

我认为就是这样！

# objective-c - 使用保留和自动释放分配给另一个对象

> ID：11868709
> 
> 赞同：0
> 
> 时间：2012-08-08T16:10:54.187
> 
> 标签：objective-c, memory-management, retain, autorelease

我有以下代码，期望一旦 obj2 被释放 obj1 仍然保留，它会工作吗？

```
obj1 = [[Class1 alloc] init];
obj2 = [[obj1 retain] autorelease]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:19:06.623

> 我有以下代码，期望一旦 obj2 被释放 obj1 仍然保留，它会工作吗？

`obj1`并且`obj2`都是指向*同一个对象的*指针。创建该对象时，该对象的保留计数为 1。当您在第二行再次保留该对象时，该对象的保留计数将增加到 2。因此，该对象（以及指向它的任何指针）将保持有效，直到它被释放两次。其中一个版本最终将来自`autorelease`第二行；另一个应该由您的代码在某处提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:53:04.193

它会起作用，但我不确定你的结论是否正确（对此有解析错误）。

```
obj1 = [[Class1 alloc] init];
obj2 = [[obj1 retain] autorelease]; 
```

它有助于根据 delta 和 per-reference 来考虑保留和释放。因此，在下面的代码中，您会说“obj1 引用的保留计数为 +1”和“obj2 引用的保留计数为 +0”。

即是`obj1`强引用，又`obj2`是弱引用。

如果你想让物体消失，你会`[obj1 release]`。你*可以* `[obj2 release]`，但这意味着所有权转移，只有在充分的理由和非常明确的情况下才能进行。

或者你可以打开 ARC 并完成它。

# java - 如何在 Java 验证中支持同一模式的多个版本？

> ID：11868710
> 
> 赞同：1
> 
> 时间：2012-08-08T16:10:55.510
> 
> 标签：java, validation, xsd, versioning

我想提前考虑并在 XMLSchema 文档中包含版本控制。似乎 w3c 中建议的方法是保持命名空间相同并使用版本属性。

到目前为止如此明智。

但是，我是否不需要能够根据指定的版本切换模式以用于验证？Java 6 XML 模式验证工具是否包含此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:26:51.950

你是对的，很多人建议保持命名空间不变。我不怀疑这种方法适用于许多人（包括大多数建议它的人），但我从未见过一个真正令人信服的论点，它是唯一合理或可取的做法。（并且在假设特定命名空间只能有一个模式的系统中，更改命名空间可能是您能够对词汇表进行版本化的唯一方法。）

你也是对的，跨版本保持命名空间不变可能意味着你想要维护多个模式。上次我查看它的文档时，Xerces J 似乎让你做你需要的事情变得相当简单：一个验证调用基本上涉及说“这里，拿*这个*文档和*这个*模式，然后验证”。

有些人通过说每个新版本都将扩展有效文档集来避免对多个模式的需求，因此每个版本的模式都可以用于创建符合早期版本模式的文档。（进一步的改进：小数点版本必须以这种方式向后兼容，只有主要版本才能向后兼容——如果是，它们必须使用新的命名空间。）

# liferay-6 - Liferay 从 3.2.3 升级到 6.0

> ID：11868711
> 
> 赞同：0
> 
> 时间：2012-08-08T16:10:57.143
> 
> 标签：liferay-6

我尝试从 5.2.3 升级到 6.0.6 Liferay 捆绑包（mysql、tomcat）。不幸的是，在某些数据库表中，如 user_ 被覆盖，原始数据丢失。有人可以帮助我，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T10:36:17.017

如果您遵循了标准的[Liferay 升级程序](http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/Upgrade+Instructions+%28disambiguation%29)，那么您的数据应该仍然存在，尽管是“升级”形式。如果您没有遵循正确的程序并且在升级之前没有进行数据库和文件系统备份（总是一件好事），那么我担心您的数据将无法恢复。

# ruby-on-rails - Rails 应用程序中的 CSRF，它提供 HTML 并为其他客户端（例如 iOS）公开 API

> ID：11868713
> 
> 赞同：3
> 
> 时间：2012-08-08T16:11:00.020
> 
> 标签：ruby-on-rails, ios, ajax, api, csrf

Ruby On Rails 框架包含一些特性，可以轻松构建公开 Web 服务 API 的服务器应用程序。例如，执行以下操作的控制器：

```
respond_to :html, :json, :xml

def show
  @thing = Thing.find(params[:id])
  respond_with @thing
end 
```

...将处理两个 Web 浏览器的“显示”操作，返回 HTML，并将项目“@thing”呈现为 JSON 或 XML，用于指定此数据格式的请求。

在此特定示例中，基于 GET 的“显示”操作不涉及任何特殊的安全措施。现在考虑与上述类似的情况，但对于诸如“创建”或“更新”之类的操作 - 由（模拟）PUT 或（实际）POST 请求激活的事物。现在 CSRF 保护开始发挥作用。

*   [http://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf](http://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf)

在这里，遗憾的是，Rails 似乎只设计用于处理来自在同域网页中执行的 JavaScript 代码的“API 调用”（用于非 HTML 格式响应），对于任何可能向 Web 浏览器客户端提供 HTML 内容的控制器，其中CSRF 保护是强制性的。JavaScript 代码可以查找 Rails 包含的神奇“元”标记，读取 CSRF 令牌并将其提交回 XHR 调用，这些调用在服务器上调用基于 POST 的操作或类似操作。

*   [http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails/](http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails/)

但是外部调用者呢？如果我们有 Rails 支持一个网站，但我们想制作一个与同一个前端通信的原生 iOS 或 Android 应用程序怎么办？该应用程序将进行服务调用——很好，Rails 使这很容易——但是任何修改服务器上数据的尝试都会失败，因为我们没有 CSRF 令牌。**我们不能仅仅绕过 CSRF 保护**，因为相同的控制器代码处理 Web 浏览器以及“纯 API”客户端。

所有与 Rails 和 API 调用相关的 CSRF 问题的答案似乎都假设您将有不同的控制器来应对这种情况。但这很愚蠢-如果仅对网页中的JavaScript代码有用，那么所有“使您的应用程序易于公开为服务”的意义何在，除非您在绕过CSRF的特殊控制器中复制一堆代码允许非网络客户端？这种额外的控制器只会增加攻击面。

有谁知道推荐的“正确”模式来处理 Rails 应用程序中的 CSRF 保护，这些应用程序具有可能被 Web 浏览器或非 Web 浏览器客户端（如本机 iOS 或 Android 应用程序）“调用”的操作？像“respond_with(...)”这样的内置东西并没有做任何有用的事情，比如总是生成一个 JSON/XML 对象，其中包含 CSRF 令牌作为无所不在的字段。我能想到的最好的就是自己做，例如将“@thing”渲染为：

```
{
  csrf: "abcdef...7890",
  object: { ...JSON representation of @thing... }
} 
```

......但这似乎有点像一个黑客，相当多的工作，它似乎绕过了世界+狗的CSRF，无论如何都会在每个请求上宣布最新的令牌。*必须*有更好的方法:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T03:53:13.370

嗯，[医生](http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection/ClassMethods.html#method-i-protect_from_forgery) *说*

> 打开请求伪造保护。请记住，仅检查非 GET、HTML/JavaScript 请求。

建议 JSON 和 XML 响应的请求已经不会被 csrf 检查，我认为你的目标是什么？它实际上不是那样工作的吗？

您还可以在您的控制器中[覆盖 verify_authenticity_token](http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection.html#method-i-verify_authenticity_token)以具有自定义逻辑，用于何时实际执行验证；这是一个非常简单的方法，它调用其他实际的工作方法来进行验证并在未验证的情况下做出响应，因此您可以重写以仅在某些情况下进行验证检查（如果这是您需要的）。或者不要覆盖，只需根据相同的想法编写自己的 before_filter，然后调用自己的 before_filter ——查看源代码，这几乎就是所有内容`protect_from_forgery`，添加 `verify_authenticity_token`为 before_filter。不过，将来做这些事情中的任何一个都可能向前兼容，也可能不向前兼容。

啊，我看到[你链接到](http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails/)的注释宣布 CSRF 保护发生在“*所有*非 GET 请求”，所以我猜说它仅适用于 HTML 请求的文档已经过时了——但这让我想，原因是什么为了那个改变？（该公告没有准确记录漏洞的性质，我也没有去寻找差异）。您当然可以以一种或另一种方式成功地取消它，并使 XML/JSON 请求不再检查 CSRF ——但是您是否会重新引入 3.0.4 旨在修补的任何漏洞，这对您的应用程序是否重要？我不知道。

# c - 打印字符数组的前几个字符？

> ID：11868714
> 
> 赞同：2
> 
> 时间：2012-08-08T16:11:01.483
> 
> 标签：c, arrays, printf

嗨，我有一个简单的代码，它打印一个字符数组的三个字符，如下所示

```
void main()
{
    char str[]={65,66,67};
    printf("%.3s",str);
} 
```

这给出了输出`ABC`，但我想知道因为这不是字符串意味着它不是空终止的，那么如何`%s`处理它并给出正确的结果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T16:12:09.593

由于您传递了字符串的长度，因此 printf 不需要 0 终止符。

> 7.21.6.1 - 8
> 
> **如果指定了精度**，则写入的字节数不会超过。如果未指定精度或大于数组的大小，则数组应包含空字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:21:48.557

它之所以有效，是因为您提供了一个精度修饰符。%.3s 字面意思是从输入打印前 3 个字节。如果您要删除修饰符（“%.3s”->“%s”），此代码仍将无错误地构建，但运行时结果是不可预测的（并且欢迎利用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:25:11.690

为了澄清上面的答案（@cnicutar 和 dans3itz）：以下代码打印“ABCDE”，即`printf`扫描数组到第一个空字符（0 字节）：

```
#include <stdio.h>

int main() {
    char str[]={65,66,67};
    char c = 68; 
    int x = 69; 
    int y = 70; 
    int z = 0;
    int w = 71;
    printf("%s", str);
    return 0;
} 
```

`F`( `int w = 71;`) 不打印。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T16:46:10.750

@khachik 我不认为该片段按您预期的那样运行。我无法使用 GCC 4.2 在 OS X 上重现结果；4.7 或 Clang 3.1

# php - require_once 函数导致服务器错误

> ID：11868718
> 
> 赞同：3
> 
> 时间：2012-08-08T16:11:24.353
> 
> 标签：php, include, webserver

我正在尝试`require_once("");`在 php 中使用该函数，并且无论何时使用它都会导致服务器错误。我知道我使用了正确的路径，因为我已经多次检查了我的文件目录，并且在编写这个 php 代码时也一直在关注视频教程。关于为什么我收到此服务器错误的任何想法？

```
 <?php
            require_once("../../includes/session.php");
       ?> 
```

`session.php`调用此函数的页面位于共享文件夹的文件夹中 -如果有意义，则相隔两个子文件夹。

这个文件是`index.php`，它在`public/admin`. 这个页面调用`require_once`在`public/admin/index.php`，他们共享的文件夹是`photo_gallery`。

错误是：HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到了意外情况。

我所做的所有调试都是在调用 require_once 之前和 require_once 之后以及当我在没有输出任何内容后发布 hello 时回显一个 hello 语句

这是我在检查错误日志时收到的错误：

[2012 年 8 月 8 日 11:01:04] PHP 解析错误：语法错误，第 47 行 /home3/visittom/public_html/photo_gallery/includes/session.php 中的意外“{”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:17:55.327

require 和 include 路径是相对于声明它们的文件的，不一定是用户加载的页面。因此，如果您的 index.php 包含另一个包含 require_once 的页面，您可能会遇到问题。

此外，请检查 Web 服务器错误日志，该日志应提供有关该 500 错误的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:15:14.417

尝试使用绝对路径而不是相对路径

所以你需要的是——`require_once(dirname(dirname(__FILE__)) . '/includes/session.php');`

告诉我好不好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-07T10:50:59.940

*如果 PHP无法访问*文件，无论是给出了错误的路径，还是由于权限而明显无法访问文件， PHP 也会抛出这些错误。

```
chmod 755 /path/to/file.php 
```

# c# - 使用 web.config 配置主体上下文

> ID：11868727
> 
> 赞同：0
> 
> 时间：2012-08-08T16:12:14.930
> 
> 标签：c#, asp.net, active-directory, active-directory-group, principalcontext

我可以使用以下代码获得组成员资格：

```
PrincipalContext(ContextType.Domain, "mydomain", "administrator", "Password")) 
```

我想在**web.config**中移动这个管理员用户名密码，这样我就不必在密码更改时更改代码。

# spring - 即使使用 Hibernate Validator 验证失败，Hibernate 也会更新持久对象

> ID：11868728
> 
> 赞同：2
> 
> 时间：2012-08-08T16:12:16.693
> 
> 标签：spring, hibernate, validation

我在 Spring MVC 应用程序中使用 Hibernate Validator。我在 context.xml 中配置了它

`<bean id="validator" class="com.mycompany.appname.validation.Validator" />`

现在我在我的控制器中使用它来验证不同的对象。瞬态对象没问题，但是持久对象呢？例如：

我加载一个：

```
MyObject o = myDao.getById(someId);
o.setName(name);
o.setPhone(phone);
Set<ConstraintViolation<o>> violations= validator.validate(o); 
```

即使此对象的验证失败，Hibernate 也会更新它！

我试图用 with 注释`validate()`方法`Validator`

```
@PrePersist
@PreUpdate
@PreRemove
public <RT> Set<ConstraintViolation<RT>> validate(RT target){...} 
```

但无论验证是否失败，它仍然会更新。如果验证失败，我不想抛出异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:25:43.743

您可以将 Hibernate 配置为在更新前自动执行验证，请参见[7.3。ORM 集成](http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html/validator-integration.html#validator-checkconstraints-orm)。如果您不想在验证失败的情况下执行特定操作，这可能是最佳选择。

或者，如果您想像当前一样手动启动验证，则由您决定如何处理导致验证失败的对象。

例如，您可以抛出异常来触发当前事务的回滚（如果您使用 Spring 事务管理），那么您所做的更改将不会保存到数据库中。

如果您不想回滚事务，可以通过调用从会话中删除实体，`Session.evict()`以防止保存无效状态：

```
Set<ConstraintViolation<Merchant>> violations= validator.validate(o); 
if (!violations.isEmpty()) myDao.doNotUpdate(o); 
```

.

```
public void doNotUpdate(MyObject o) {
    sf.getCurrentSession().evict(o);
} 
```

# spring - 严重：上下文初始化失败

> ID：11868732
> 
> 赞同：1
> 
> 时间：2012-08-08T16:12:26.647
> 
> 标签：spring, jakarta-ee, spring-mvc

我正在从头开始创建一个 HelloWorld web/spring 应用程序。我已按照[本教程](http://www.roseindia.net/spring/spring-mvc-hello-world.shtml)学习如何使用 mvc 模式。因此，在完成所有步骤并开始运行应用程序后，我在控制台中收到此错误：

> 严重：上下文初始化失败 org.springframework.beans.factory.xml.XmlBeanDefinitionStoreException：来自 ServletContext 资源 [/WEB-INF/dispatcher-servlet.xml] 的 XML 文档中的第 11 行无效；嵌套异常是 org.xml.sax.SAXParseException；行号：11；列号：100；cvc-complex-type.2.4.c

搜索 SO question 我发现了一些类似下面的威胁，但没有解决我的错误。

*   [在 Internet 离线模式下找不到元素“bean”的声明](https://stackoverflow.com/questions/8100965/cannot-find-the-declaration-of-element-beans-in-internet-offline-mode)
*   [Spring Security 初学者的问题。构建失败](https://stackoverflow.com/questions/2491966/spring-security-beginners-question-build-failed)

所以，我推断这可能是 WEB-INF 文件夹中的 dispatcher-servlet.xml。这个 xml 看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/jsp/</value>
        </property>

        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>

    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="interceptors">
            <list>
                <ref local="localeChangeInterceptor" />
            </list>
        </property>

        <property name="urlMap">
            <map>
                <entry key="/hello.html">
                    <ref bean="helloController" />
                </entry>
            </map>
        </property>

    </bean>

    <bean id="helloController" class="controllers.HelloController">
    </bean>

    <bean id="localeChangeInterceptor"
        class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">

        <property name="paramName" value="hl" />

    </bean>

    <bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver">
    </bean>

</beans> 
```

最后这些是我包含的罐子：

```
commons-logging-1.1.1.jar

org.springframework.aop-3.1.2.RELEASE.jar
org.springframework.asm-3.1.2.RELEASE.jar
org.springframework.aspects-3.1.2.RELEASE.jar
org.springframework.beans-3.1.2.RELEASE.jar
org.springframework.context-3.1.2.RELEASE.jar
org.springframework.context.support-3.1.2.RELEASE.jar
org.springframework.core-3.1.2.RELEASE.jar
org.springframework.expression-3.1.2.RELEASE.jar
org.springframework.instrument-3.1.2.RELEASE.jar
org.springframework.instrument.tomcat-3.1.2.RELEASE.jar
org.springframework.jdbc-3.1.2.RELEASE.jar
org.springframework.jms-3.1.2.RELEASE.jar
org.springframework.orm-3.1.2.RELEASE.jar
org.springframework.oxm-3.1.2.RELEASE.jar
org.springframework.spring-library-3.1.2.RELEASE.libd
org.springframework.test-3.1.2.RELEASE.jar
org.springframework.transaction-3.1.2.RELEASE.jar
org.springframework.web-3.1.2.RELEASE.jar
org.springframework.web.portlet-3.1.2.RELEASE.jar
org.springframework.web.servlet-3.1.2.RELEASE.jar
org.springframework.web.struts-3.1.2.RELEASE.jar

spring-webmvc-3.0.5.RELEASE.jar 
```

提前致谢

**编辑1：**

在对@Biju Kunjummen 进行更改后，现在看来问题是bean 声明中有一个comflic：

```
Grave: Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'urlMapping' defined in ServletContext resource [/WEB-INF/dispatcher-servlet.xml]: Cannot resolve reference to bean 'helloController' while setting bean property 'urlMap' with key [TypedStringValue: value [/hello.html], target type [null]]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'helloController' defined in ServletContext resource [/WEB-INF/dispatcher-servlet.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [controllers.HelloController]: Constructor threw exception; nested exception is java.lang.Error: Unresolved compilation problems: 
    The type java.lang.Object cannot be resolved. It is indirectly referenced from required .class files
    Implicit super constructor Object() is undefined for default constructor. Must define an explicit constructor
    String cannot be resolved to a type 
```

我已经检查了控制器，并且在`src/controllers`目录中看起来很好：

```
package controllers;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.Controller;

public class HelloController implements Controller {

    public ModelAndView handleRequest(HttpServletRequest request,
              HttpServletResponse response) throws ServletException, IOException {

              String Mess = "Hello World!";

              ModelAndView modelAndView = new ModelAndView("hello");
              modelAndView.addObject("message", Mess);

              return modelAndView;
              }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:26:48.790

您具有`http://www.springframework.org/schema/mvc`默认值，但您的 bean 定义属于`http://www.springframework.org/schema/beans`命名空间，这应该是问题所在。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
...">

<beans:bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix">
        <beans:value>/WEB-INF/jsp/</beans:value>
    </beans:property> 
```

......

或者以这种方式将 beans 命名空间设为默认值：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/jsp/</value>
        </property>

        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean> 
```

# android - 在 ActionBarSherlock 搜索栏中制作自定义搜索建议

> ID：11868735
> 
> 赞同：0
> 
> 时间：2012-08-08T16:12:36.877
> 
> 标签：android

这就是我使用 ActionBar Search 小部件进行基本搜索的方式。这显然是在布局中的 listView 中提供建议的简单方法。但我想要搜索框本身内的建议。虽然可以在普通搜索框中执行此操作，但我如何使用操作栏搜索框执行相同操作。

```
 public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
        menu.add(0, 1, 1,"Search").setIcon(R.drawable.ic_search_inverse).setActionView(R.layout.collapsible_edittext).setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_COLLAPSE_ACTION_VIEW);
        return super.onCreateOptionsMenu(menu);
     }

    @Override
        public boolean onOptionsItemSelected(com.actionbarsherlock.view.MenuItem item) {
            switch (item.getItemId()) {
                case 1:
                    search = (AutoCompleteTextView) item.getActionView();
                    search.addTextChangedListener(filterTextWatcher);
                    search.requestFocus();
                    InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
                    imm.toggleSoftInput(InputMethodManager.SHOW_FORCED, 0);
                    return true;
            }   
            return false;
        }       

    private TextWatcher filterTextWatcher = new TextWatcher() {
        public void afterTextChanged(Editable s) {
        }

        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }

        public void onTextChanged(CharSequence s, int start, int before, int count) {
            // your search logic here
            doGeoSearch(String.valueOf(s));

        }

    };

    public void doGeoSearch(String query){
        Geocoder geocoder;
        ArrayList<Address> addresses;
        ArrayList<String> address = new ArrayList<String>() ;
        geocoder = new Geocoder(this, Locale.getDefault());
        try {
            addresses = (ArrayList<Address>) geocoder.getFromLocationName(query, 6);
            Log.d("Address",String.valueOf(addresses));
            for(int i = 0;i<addresses.size();i++)
            {
            String addr = new String();
            addr.concat(addresses.get(i).getAddressLine(0));
            addr.concat(addresses.get(i).getAddressLine(1));
            addr = addresses.get(i).getAddressLine(0) + addresses.get(i).getLocality() + addresses.get(i).getAdminArea();
            //addr.concat(addresses.get(i).getAddressLine(2));
            Log.d("addr",addr);
            address.add(addr);

            }

            SearchAddressAdapater addressList = new SearchAddressAdapater(getApplicationContext(),R.layout.search_list,addresses, LocationActivity.this);
            //addressView.setAdapter(addressList);
            //ListView addressListView = new ListView();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:25:02.253

您可以在 ActionBar Sherlock 中添加搜索小部件，搜索对话框具有此功能，并且实现起来非常简单，因为它是一个简单的可扩展操作项。

[本](http://developer.android.com/guide/topics/search/search-dialog.html)教程将向您展示如何使用搜索小部件完成所需的一切，包括搜索建议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:18:36.817

即使 `SearchView`已实施并有效，搜索建议也适用于较新的设备，但不适用于 Gingerbread 等较旧的设备。这里有一个问题：

[https://github.com/JakeWharton/ActionBarSherlock/issues/659](https://github.com/JakeWharton/ActionBarSherlock/issues/659)

# vba - 在 VBA 中引用动态命名范围

> ID：11868739
> 
> 赞同：5
> 
> 时间：2012-08-08T16:12:43.780
> 
> 标签：vba, excel, excel-2010

我在引用 VBA 中的动态名称范围时遇到了麻烦。
我的范围定义为

```
    =OFFSET(Sheet!$B$2,0,0,COUNTA(Sheet!$B:$B)-1,1)
```

我的代码应该在一个范围内搜索另一个范围内的所有条目，目的是添加任何缺失的条目。到目前为止我有

```
    子 UpdateSummary()
    将单元格调暗为范围
    将 rngF 调暗为范围
    设置 rngF = 无

    ' 遍历数据范围内的每个单元格
    对于 Worksheets("Aspect").Range("A_Date") 中的每个单元格
        ' 搜索当前单元格值的摘要范围
        Set rngF = Worksheets("Summary").Range("Sum_Date").Find(Cell.Value) // 不起作用
        如果 rngF 什么都不是，那么
            ' 将日期添加到摘要
        万一
        设置 rngF = 无
    下一个单元格
    结束子
```

For 循环似乎工作正常。但是，使用 .Find 方法会给我一条错误消息。

```
    应用程序定义或对象定义的错误
```

如果我用特定范围（$B$2:$B$5000）替换命名范围，它确实有效，所以它似乎取决于命名范围的传递方式。
任何想法，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T17:53:41.660

该错误几乎可以肯定是因为 Excel 找不到一个命名范围 Sum_Date，它引用了名为 Summary 的工作表上的一个范围。最常见的原因是

1.  Sum_Date 指的是除摘要之外的工作表。检查 Sum_Date 的 RefersTo 属性并确保没有拼写错误。
2.  没有命名范围 Sum_Date，也就是说，它在 VBA 代码中拼写错误。在名称管理器中检查命名范围的拼写。
3.  Sum_Date 的 RefersTo 公式有错误。听起来您已经验证不是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T15:56:13.530

如果不是相同的问题，我也遇到过类似的问题，这就是我解决它的方法：

我首先意识到我用来创建命名范围的方法，使用名称管理器，我的命名范围有一个工作簿的范围。这很重要，因为它不属于工作表，因此不会在那里找到。

因此， Worksheets("Summary").Range("Sum_Date") 对我不起作用。

由于我的范围属于工作簿，因此我能够找到的方法是使用 ActiveWorkbook.Names("Sum_Date")

对我来说，我用它从我在很多地方使用的命名范围中删除了公式。巨大的优势是命名范围仅更新一次，而不是为调用范围的每个单元格位置调用公式。巨大的时延差异！

```
Public last_Selection As String

Private Sub Worksheet_Change(ByVal Target As Range)
'excel data change detection

If Range(last_Selection).Column = 2 Then
    'Disable events, so this only executes once
    Application.EnableEvents = False

    'This can be done with a complex formula in a cell, 
    'but this is easily understood
    Range("B1").End(xlDown).Select
    ActiveWorkbook.Names("last_Entry").Value = ActiveCell.Row

    'Re-enable so this routine will execute on the next change
    Application.EnableEvents = True
End If
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    'constantly store the last cell to know which one was previously edited
    last_Selection = Target.Address
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-18T19:59:28.577

我知道这是一个非常古老的线程，但我今天遇到了同样的问题，我一直在寻找解决方案。所以也许这会对某人有所帮助。

=OFFSET(...) 公式定义的命名“范围”实际上是一个命名公式，因此在 VBA 中您必须先评估它才能获得范围。例如：

```
Set rgNamedRange = Worksheets("Summary").Evaluate("Sum_Date") 
```

感谢来自 mrexcel.com 的一个名叫“shg”的人，他让我走上了正轨。:)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-01-25T16:39:51.887

我已经对此进行了几天的试验，最终我想出了以下内容。它可能不是最有效的，但它确实对我有用！

```
The named range of "OhDear" was set up in the normal way

Dim vItem As Variant
Set vItem = Names("OhDear")
Debug.Print vItem.Name 
```

你不觉得值得一试！如果不使用变体，而是使用类似以下内容的变体，这将不起作用：将 Nm 作为名称：设置 Nm = Names("OhDear")。任何使用“Nm”的变体都失败了！！！

# javascript - 如何在javascript中创建一个全局cookie？

> ID：11868745
> 
> 赞同：5
> 
> 时间：2012-08-08T16:12:50.890
> 
> 标签：javascript, cookies, web, global

我创建了一个 Django 网站，需要一个 cookie 来存储和从网站的任何部分读取。它的 javascript 在我需要它的每个部分中，但由于某种原因，cookie 本身是为每个页面单独存储的。例如，如果 cookie 在一个页面上等于“设置”，则它可以在另一个页面上未定义。这是我用来创建、获取和读取 cookie 的代码（当按下每个页面上的特定按钮时，会调用“createBannerCookie()”方法）-

```
<script type="text/javascript">
$(document).ready(function() {
  $('#banner').hide();
  checkBannerCookie();
});

function createBannerCookie() 
{
  $('#banner').hide();
  var exdate=new Date();
  exdate.setDate(exdate.getDate() + 3);
  var c_value=escape("set") + ((exdate==null) ? "" : "; expires="+exdate.toUTCString());
  document.cookie='banner=' + c_value;
}

function getCookie(c_name)
{
  var i,x,y,ARRcookies=document.cookie.split(";");
  for (i=0;i<ARRcookies.length;i++)
  {
    x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
    y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
    x=x.replace(/^\s+|\s+$/g,"");
    if (x==c_name)
    {
      return unescape(y);
    }
  }
}

function checkBannerCookie()
{
  var banner=getCookie("banner");
  if (banner!=null && banner!="")
  {
    $('#banner').hide();
  }
  else 
  {
    $('#banner').show();
  }
}
</script> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-08T16:39:26.447

默认情况下，只有与最初创建 cookie 的网页位于同一目录中的网页才能访问 cookie。请尝试添加“path=/”选项。例如

```
document.cookie =
  'propertyName=test; path=/' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:33:38.360

西蒙，

我认为您的问题是您的 cookie 的到期日期。在我看来，您将它们设置为在创建后 3 毫秒过期。

在你的“createBannerCookie”函数中尝试这样的事情（而不是 w3schools 版本）：

```
function createBannerCookie() 
{
  $('#banner').hide();
  var exdate=new Date();
  exdate.setTime(exdate.getTime()+(3*24*60*60*1000)); // the 3 in that math is your days
  var c_value=escape("set") + ((exdate==null) ? "" : "; expires="+exdate.toUTCString());
  document.cookie='banner=' + c_value;
} 
```

参考： [http ://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

# ruby - 如何使用 Anemone 仅抓取子文件夹

> ID：11868748
> 
> 赞同：2
> 
> 时间：2012-08-08T16:12:53.180
> 
> 标签：ruby, web-crawler, anemone

我们可以用海葵（例如：）抓取一个漏洞网站`https://stackoverflow.com/`，但是如果我只想关注某个文件夹（例如：[https](https://stackoverflow.com/)`questions` ://stackoverflow.com/ ）怎么办。我怎样才能做到这一点 ？也许使用“focus_crawl”方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:28:04.067

检查keep_if方法可能有帮助

[http://danneu.com/posts/8-scraping-a-blog-with-anemone-ruby-web-crawler-and-mongodb#toc_1](http://danneu.com/posts/8-scraping-a-blog-with-anemone-ruby-web-crawler-and-mongodb#toc_1)

尝试按照您要爬行的方式传递模式

还有一个要点[https://gist.github.com/1149906](https://gist.github.com/1149906)。

注意：我还没有测试过，但你肯定可以尝试。

# python - GAE（AppEngine）似乎在发布后调整了我的图像大小

> ID：11868749
> 
> 赞同：1
> 
> 时间：2012-08-08T16:12:57.797
> 
> 标签：python, google-app-engine

我使用以下代码成功地将图像发布到我的 Google AppEngine 应用程序：

```
 def post(self):

    image_data = self.request.get('file')
    file_name = files.blobstore.create(mime_type='image/png')

    # Open the file and write to it
    with files.open(file_name, 'a', exclusive_lock=True) as f:
      f.write(image_data)

    # Finalize the file. Do this before attempting to read it.
    files.finalize(file_name)

    # Get the file's blob key
    blob_key = files.blobstore.get_blob_key(file_name)
    self.response.out.write(images.get_serving_url( blob_key )) 
```

但是，当我浏览由 输出的 URL 时`get_serving_url()`，图像**始终**处于降低的分辨率。**为什么？**我已经检查并仔细检查了发布的图像尺寸是否正确（来自 iPhone 相机，分辨率约为 3200x2400）。然而，提供的图像始终是 512x384。

我对 GAE 还很陌生，但我认为上面的代码应该将图像存储在 BlobStore 而不是数据存储中，从而绕过 1 MB 的限制。

**有谁知道会发生什么？**

干杯，布雷特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:40:27.330

找到了解决方案。或者至少对我有用的东西。我将附加`=sXX`到提供的 URL 的末尾，AppEngine 将以`XX`分辨率提供图像。例如，如果该行：

`self.response.out.write(images.get_serving_url( blob_key ))`

返回： `http://appengine.sample.com/appengineurlkey`

那么在调用上面的url结果的时候，图片会是分辨率较低的图片，

然后通过调用 URL： `http://appengine.sample.com/appengineurlkey**=s1600**`

生成的服务图像将具有`1600x1200`分辨率（或受保持纵横比限制的类似分辨率）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:18:05.970

[https://developers.google.com/appengine/docs/python/images/functions](https://developers.google.com/appengine/docs/python/images/functions)中解释了您所看到的内容

在文档中`get_serving_url`：

> 调整大小或裁剪图像时，您必须使用 0 到 1600 的整数指定新大小。最大大小在 IMG_SERVING_SIZES_LIMIT 中定义。API 将图像大小调整为提供的值，将指定大小应用于图像的最长尺寸并保留原始纵横比。

如果您想提供全尺寸图像，另一种方法是将您的图像直接上传到 blobstore，然后从那里提供它们。（即，完全绕过图像 API。）请参阅[https://developers.google.com/appengine/docs/python/blobstore/overview](https://developers.google.com/appengine/docs/python/blobstore/overview)

# c# - 在图片框中显示一组图像？

> ID：11868757
> 
> 赞同：3
> 
> 时间：2012-08-08T16:13:23.030
> 
> 标签：c#, arrays, image, picturebox

我对视觉 C# 非常陌生，我想在图片框中显示一组图像

这是我的代码：

```
string[] list = Directory.GetFiles(@"C:\\pictures", "*.jpg");
Image[] images = new Image[5];
for (int index = 0; index < 5; index++)

{
    //HERE IS WHERE IM STUCKED WITH
    picturebox[index] = Image.FromFile(list[index]);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T10:35:15.540

Edit-1 ：此答案的范围仅限于 Win-Forms C#。在使用此代码之前，您需要在应用程序中添加某些程序集。

```
using System.IO;
using System.Windows.Forms; 
```

编辑结束；

**原始答案**

您必须将所有图像绘制到一个图像中才能在单个图片框中显示它们

这有点复杂，您可以使用多个图片框

在以下代码中，它们是根据需要动态创建的：

```
 // For confirm visibility of all images set 
    this.AutoScroll = true;

    string[] list = Directory.GetFiles(@"C:\pictures", "*.jpg");
    PictureBox[] picturebox= new PictureBox[list.Length];
    int y = 0;
    for (int index = 0; index < picturebox.Length; index++)
    {
        this.Controls.Add(picturebox[index]);
        // Following three lines set the images(picture boxes) locations
        if(index % 3 == 0)
            y = y + 150; // 3 images per rows, first image will be at (20,150)
        picturebox[index].Location=new Point(index * 120 + 20, y);

        picturebox[index ].Size = new Size(100,120);
        picturebox[index].Image = Image.FromFile(list[index]);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-20T20:13:16.280

提供的答案会引发对象引用异常。否则感谢您的示例！

```
for (int index = 0; index < picturebox.Length; index++)
{
     this.Controls.Add(picturebox[index]);
     // Following three lines set the images(picture boxes) locations 
```

应该

```
for (int index = 0; index < picturebox.Length; index++)
{
    picturebox[index] = new PictureBox();
    this.Controls.Add(picturebox[index]);
    // Following three lines set the images(picture boxes) locations 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T16:24:28.943

采用`picturebox[index].Image = Image.FromFile(list[index]);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-29T19:47:37.373

//这段代码帮助你在arraye中使用picturebox

```
public partial class Form_Begin : Form
    {
        PictureBox[] pictureBoxs = new PictureBox[50];
        public Form_Begin()
        {
            InitializeComponent();
            pictureBoxs[0] = pictureBox1;
            pictureBoxs[1] = pictureBox2;
            pictureBoxs[2] = pictureBox3;
            pictureBoxs[3] = pictureBox4;}

            List<PictureBox> pictureBoxes = new List<PictureBox>();
 private void buttonX1_Click(object sender, EventArgs e)
            {
                for (int i = 0; i <2; i++)
                {
                    pictureBoxs[i].Image =your_name_project.Properties.Resources.Image_1;                     // Load Image_1 from Resources on property of picturebox  
                }
                for (int i = 2; i < 4; i++)
                {
                    pictureBoxs[i].Image =your_name_project.Properties.Resources.Image_2;                    // Load Image_12 from Resources on property of picturebox 

                } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-08T06:46:56.527

```
 private void picbutton_Click(object sender, EventArgs e)
    {
        OpenFileDialog open = new OpenFileDialog();
        PictureBox[] picture = new PictureBox[5];
        int x = 0;
        int y = 15;
        for (int index = length; index < picture.Length; index++)
        {
                picture[index] = new PictureBox();
                picture[index].Size = new Size(100, 50);
                open.Title = "OPen Image";
                open.Filter = "JPG Files (*.jpg)|*.jpg|JPEG Files (*.jpeg)|*.jpeg|PNG Files (*.png)|*.png|GIF Files (*.gif)|*.gif";
                DialogResult result = open.ShowDialog();
                if (result == DialogResult.OK)
                {
                    picture[index].BackgroundImage = new Bitmap(open.FileName);
                    picture[index].SizeMode = PictureBoxSizeMode.AutoSize;
                    listBox1.Controls.Add(picture[index]);
                    if ((x % 3 == 0) && (index != 0))
                    {
                        y = y + 150; // 3 images per rows, first image will be at (20,150)
                        x = 0;
                    }
                    picture[index].Location = new Point(x * 210 + 20, y);
                    picture[index].Size = new Size(200, 150);
                    x++;
            }
        }
    } 
```

# sql - 在约束中查找父键

> ID：11868758
> 
> 赞同：1
> 
> 时间：2012-08-08T16:13:27.123
> 
> 标签：sql, oracle, constraints

我遇到了一个例外

**ORA-02291: 违反完整性约束 (ADS.ADS_JOB_FAMILIES_F03) - 未找到父键**

我发现表中的约束正在插入。

如何找到父键和子键...（列）。

注意：我正在使用 Oracle

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T18:53:45.120

对于父表：

```
select * from all_constraints 
         where constraint_name in (
               select R_CONSTRAINT_NAME 
                 from all_constraints 
                where constraint_name = 'ADS_JOB_FAMILIES_F03'); 
```

对于父列：

```
select * 
  from all_cons_columns 
 where constraint_name in (
       select constraint_name 
         from all_constraints 
        where constraint_name in (
              select R_CONSTRAINT_NAME 
                from all_constraints 
               where constraint_name = 'ADS_JOB_FAMILIES_F03')); 
```

这并不完全完美，因为它忽略了约束的所有者。但我认为它会为你工作。

编辑：我现在什至发现[了这个](https://stackoverflow.com/questions/1729996/list-of-foreign-keys-and-the-tables-they-reference)。这会给出这样的查询：

```
SELECT a.table_name, a.column_name, a.constraint_name, c.owner, 
       -- referenced pk
       c.r_owner, c_pk.table_name r_table_name, c_pk.constraint_name r_pk
  FROM all_cons_columns a
  JOIN all_constraints c ON a.owner = c.owner
                        AND a.constraint_name = c.constraint_name
  JOIN all_constraints c_pk ON c.r_owner = c_pk.owner
                           AND c.r_constraint_name = c_pk.constraint_name
 WHERE a.constraint_name = 'ADS_JOB_FAMILIES_F03'; 
```

# vba - VBA 导入 MS Access 到 MS Word

> ID：11868759
> 
> 赞同：1
> 
> 时间：2012-08-08T16:13:28.127
> 
> 标签：vba, ms-access, ms-word

我在 MS-Access 中有一个 VBA 模块，它应该将数据库中的数据加载到 MS-Word 文档中的表单字段中。我认为它工作正常，但它似乎不一致。有时它有效，有时则无效。我不知道是什么让它无法工作。当我单步调试调试器时，它不会抛出任何错误，但有时它不会打开 MS-Word。

以下是相关代码：

```
Dim appWord As Word.Application
Dim doc As Word.Document
'Avoid error 429, when Word isn't open.
On Error Resume Next
Err.Clear

'Set appWord object variable to running instance of Word.
Set appWord = GetObject(, "Word.Application")

If Err.Number <> 0 Then
'If Word isn't open, create a new instance of Word.
Set appWord = New Word.Application
End If

Set doc = appWord.Documents.Open("\\srifs01\hresourc\EHS Department\EHS Database\IpadUpload\Lab Inspection Deficiency Resolution Report.docx", , True)

'Sometimes word doesn't open and I think the issue is around here.
With doc
.FormFields("frmID").Result = Me!id
.FormFields("frmSupervisor").Result = Me!LabPOC
.FormFields("frmInspector").Result = Me!InspectorName
.FormFields("frmBuilding").Result = Me!BuildingName
.FormFields("frmRoom").Result = Me!Rooms
.FormFields("frmComments").Result = Me!Comments
.Visible = True
.Activate
.SaveAs "'" & Me!id & "'"
.Close
End With

Set doc = Nothing
Set appWord = Nothing 
```

任何帮助表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:48:20.727

*“当我单步调试调试器时，它不会抛出任何错误，但有时它不会打开 MS-Word。”*

那是因为你有`On Error Resume Next`. 这指示 VBA 忽略错误。

假设您已在代码中进行了此更改...

```
Dim strDocPath As String
strDocPath = "\\srifs01\hresourc\EHS Department\EHS Database" & _
    "\IpadUpload\Lab Inspection Deficiency Resolution Report.docx" 
```

然后，当您尝试打开时，如果不是对 Word 应用程序实例的引用`strDocPath`，VBA 会抛出错误......**并且**您没有使用过：`appWord`**`On Error Resume Next`**

 **```
Set doc = appWord.Documents.Open(strDocPath, , True) 
```

`On Error Resume Next`如果您将作业更改为此，您可以摆脱`appWord`：

```
Set appWord = GiveMeAnApp("Word.Application") 
```

如果 Word 已经在运行，`GiveMeAnApp()`则会锁定该应用程序实例。如果 Word 没有运行，`GiveMeAnApp()`将返回一个新实例。

无论哪种方式，`GiveMeAnApp()`都不需要您`On Error Resume Next`在调用它的过程中使用。而是在那里包含一个适当的错误处理程序。您可以将该功能重用于其他类型的应用程序：`GiveMeAnApp("Excel.Application")`

```
Public Function GiveMeAnApp(ByVal pApp As String) As Object
    Dim objApp As Object
    Dim strMsg As String

On Error GoTo ErrorHandler

    Set objApp = GetObject(, pApp)

ExitHere:
    On Error GoTo 0
    Set GiveMeAnApp = objApp
    Exit Function

ErrorHandler:
    Select Case Err.Number
    Case 429 ' ActiveX component can't create object
        Set objApp = CreateObject(pApp)
        Resume Next
    Case Else
        strMsg = "Error " & Err.Number & " (" & Err.Description _
            & ") in procedure GiveMeAnApp"
        MsgBox strMsg
        GoTo ExitHere
    End Select
End Function 
```

您还可以包括检查以确保`appWord`在尝试使用应用程序之前引用它。虽然我不明白为什么在你的情况下应该进行这样的检查，但你可以尝试这样的事情......

```
If TypeName(appWord) <> "Application" Then
    ' notify user here, and bail out '
Else
    ' appWord.Visible = True '
    ' do stuff with Word '
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:20:16.343

`New`打开或查找应用程序时，我不使用关键字。

这是我用于 excel 的代码：

```
On Error Resume Next
Set xlApp = GetObject(, "Excel.Application")
If Err.Number = 429 Then 'Excel not running
    Set xlApp = CreateObject("Excel.Application")
End If
On Error GoTo 0 
```

（另请注意`On Error GoTo 0`- 我不希望下一个简历在整个代码中都处于活动状态）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-06T12:42:52.810

GiveMeAnApp 功能对我来说非常有用，我遇到了类似的问题。除了，如果我在数据合并后关闭 Word 文档并尝试将数据再次合并到 Word 中，以避免出现错误 462（无法连接到服务器等）。（导致错误 462）我这样做了：一旦我调用 GiveMeAnApp，我在调用我希望将数据传输到 Word 的 Word 模板之前调用了一个新的 Word 文档。

在我的情况下，通过始终显示 New Word 文档，可以避免出现错误 462。这意味着我留下了一个空的 Word 文档，但这对我来说没问题，并且比我能想出的唯一其他解决方案更可取，即退出数据库并重新打开并运行合并到 Word aga。

我很感谢这个线程中提供的帮助。谢谢大家。**

# javascript - 将 DOM 节点移动到弹出窗口

> ID：11868765
> 
> 赞同：4
> 
> 时间：2012-08-08T16:14:08.003
> 
> 标签：javascript, jquery, dom, popup

我正在尝试将 DOM 节点从“根”页面移动到通过`window.open()`. 这是我正在使用的代码。

```
var win = window.open('/Search/Print', 'printSearchResults'),
    table = $('#printTable');
win.document.close();
setTimeout(function () {
    var el = win.document.createElement("table");
    el.innerHTML = table.html();
    win.document.body.appendChild(el);
}, 40); 
```

它在 Chrome 中工作，但在 IE8 中，我收到以下错误：“未知的运行时错误。”

我也试过这样：

```
var p = window.open('/Search/Print', 'printSearchResults'),
    table = $('#printTable');
setTimeout(function () {
    p.document.body.appendChild(table.clone(false)[0]);
}, 100); 
```

这样做，我在 IE8 中收到“不支持此类接口”。同样，Chrome 工作正常。

有没有人有办法做我想要实现的目标？

为了完整起见，这里是弹出窗口的 HTML：

```
<!DOCTYPE html>
  <html>
  <head>
      <title>Print Results</title>
  </head>
  <body>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:25:06.903

为了能够使用 iframe 和新窗口，您应该在 write() 之前使用 addres: about:blank 对其进行初始化。另请注意，加载/打开窗口/框架需要时间，因此您不能立即给它们写信。设置超时，或检查 onload。请参阅[此答案](https://stackoverflow.com/a/11731778/588079)以获取更多信息。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T13:03:53.277

我在 IE9（和 IE8/7 浏览器模式）上测试了您的代码。

代替`el.innerHTML = table.html();`

使用 jquery`$(el).html(table.html());`解决了这个问题。

# mysql - OR 的 SELECT 语句问题

> ID：11868775
> 
> 赞同：0
> 
> 时间：2012-08-08T16:14:35.010
> 
> 标签：mysql, sql, select, filter

我正在尝试使用下一条语句进行过滤查询：

```
SELECT * FROM user_jobs,users WHERE user_jobs.job_title LIKE "%some_keyword%" **OR** user_jobs.job_title LIKE "%another_keyword%" AND user.id=user_jobs.userid 
```

规格：users.id 是 PK 和 user_jobs.userid 是 FK 到 users.id

我正在尝试过滤用户以获取与指定值相似的用户。当我运行它时，我得到一个很长的循环，最后是一个包含重复项的大量用户列表。（例如，我只有 300 个用户，查询显示超过 3000 个结果）

请问我做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:16:06.050

[`AND`优先于`OR`](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html); 使用括号来实现所需的结果。

```
SELECT * FROM user_jobs, users
WHERE
    (user_jobs.job_title LIKE "%some_keyword%"
  OR user_jobs.job_title LIKE "%another_keyword%")
AND users.id = user_jobs.userid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:16:17.190

您需要在该查询中使用括号。

```
SELECT * FROM user_jobs,users WHERE user.id=user_jobs.userid
AND (user_jobs.job_title LIKE "%some_keyword%"
OR user_jobs.job_title LIKE "%another_keyword%") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:18:05.453

首先，`AND`在这种情况下，运算符具有优先权。像这样隔离你的逻辑：

```
SELECT * FROM user_jobs,users WHERE (user_jobs.job_title LIKE "%some_keyword%" OR user_jobs.job_title LIKE "%another_keyword%") AND user.id=user_jobs.userid 
```

其次，不要使用`SELECT * FROM ...`. 这会选择您的所有数据，增加网络开销并占用更多时间在服务器上传输所有数据。

**参考**：[https ://dev.mysql.com/doc/refman/5.0/en/func-op-summary-ref.html](https://dev.mysql.com/doc/refman/5.0/en/func-op-summary-ref.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T22:03:20.067

即使您的表包含 300 条记录，它也会产生大约 3000 条记录，因为您正在从两个表中选择列，但在查询中没有给出任何连接条件，所以它会`CROSS JOIN`在两个表中。

并且为了找到`JOB_TITLE 模式，您也可以使用正则表达式作为

```
SELECT * FROM USER_JOBS T1,USERS T2 WHERE REGEXP_LIKE(USER_JOBS.JOB_TITLE ,'SOME_KEYWORD|OTHER_KEYWORD') AND T2.ID=T1.USERID; 
```

# sql - 我可以使用 SSIS 直接从 Google Analytics API 中提取数据吗？

> ID：11868776
> 
> 赞同：2
> 
> 时间：2012-08-08T16:14:40.307
> 
> 标签：sql, ssis, google-analytics, sql-server-2008-r2, google-analytics-api

不擅长编程，因此对能够从 Google API 提取数据没有信心。

基本上我要做的是从谷歌分析中提取所有数据，所有数据并将其转储到 SQL Server (2008 R2) 上的表中。实现这一目标的最佳方法是什么？

想自动化该过程，以便可以安排每月一次。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:42:17.770

有一个专门用于访问 Google Analytics 的现有插件。没有使用过，但从我读到的内容看来，这正是您正在寻找的 [http://www.google.com/analytics/apps/about?app_id=1325007](http://www.google.com/analytics/apps/about?app_id=1325007)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-28T13:38:45.437

有一个特定的 SSIS 数据源组件 - [https://analyticssource.codeplex.com](https://analyticssource.codeplex.com)
它是开源和免费的。

# php - 如何重新启动或重新加载“回显”下拉列表？

> ID：11868778
> 
> 赞同：1
> 
> 时间：2012-08-08T16:14:54.447
> 
> 标签：php, html, drop-down-menu, echo, options

在更改某些数据库详细信息后，我需要重新加载此 HTML 下拉列表。有任何想法吗？

注意：`ddl_my_items.reload();`不工作。

提前致谢。

```
<?php
//populates the ddl of items
$items = $dal->get_items() or die(mysql_error());

echo "<select id='ddl_my_items'>";
echo "<option value=''></option>";
foreach ($items as $item){
echo "<option value='$item->item_name'>$item->item_name</option>";
}
echo "</select>";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:21:28.663

如果包含[jQuery](http://jquery.com/) ，这是最简单的。

创建一个仅回显下拉列表内容的 php 文件 ajax.php：

```
<?php
//populates the ddl of items
$items = $dal->get_items() or die(mysql_error());

echo "<option value=''></option>";
foreach ($items as $item){
    echo "<option value='$item->item_name'>$item->item_name</option>";
} 
```

然后，使用以下 javascript 代码：

```
$.get('ajax.php', function(result) {
    $('#ddl_my_items').html(result);
} 
```

该函数`$.get`发送一个 AJAX 请求（它只是一个 HTTP 请求，其响应可以在 javascript 中接收）。一旦收到内容，就会调用匿名函数。

`$('#ddl_my_items')`返回元素的 jQuery 对象`select`，它`html`允许您通过传递刚刚通过 ajax 调用收到的 html 代码来更改元素的内容。

# c# - 为表格的第一行着色

> ID：11868787
> 
> 赞同：0
> 
> 时间：2012-08-08T16:15:14.203
> 
> 标签：c#, .net, datagridview

我想对使用 DataGridView 显示的表格的第一行进行着色，并将其绑定到一个复选框（即用户选择“标题行存在”并且网格第一行的背景颜色发生变化）。

我应该在复选框事件中输入什么来启用它？

```
 private void checkBox1_CheckedChanged(object sender, EventArgs e)
    {

    } 
```

同样，我希望能够通过让用户指定一个数字来为列着色。这会类似于行的阴影吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:20:52.473

您需要执行以下操作：

```
private void checkBox1_CheckedChanged(object sender, EventArgs e)
{
    // For shading rows
    if (dataGridView1.Rows.Count > 0)
    {
        dataGridView1.Rows[0].DefaultCellStyle.BackColor = Color.LightGray;
    }

    // For shading columns
    int colNum = 2; // Add your own code to get the column number you want
    dataGridView1.Columns[colNum].DefaultCellStyle.BackColor = Color.LightGray;
} 
```

# windows - 以管理员身份运行程序

> ID：11868789
> 
> 赞同：0
> 
> 时间：2012-08-08T16:15:22.653
> 
> 标签：windows, eclipse

使用 Eclipse 和 Java 我正在开发一个需要管理权限的软件。如何以管理权限从 Eclipse 内部运行 java 程序？有没有比以管理员身份启动完整的 Eclipse IDE 更好的方法？请注意我在 Windows 上。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:19:26.383

将 runas 添加到您的 java 运行时设置中，我不是 Windows 专家，我只是了解了您将如何在 *IX 上执行此操作，并询问如何在 Windows 上执行此操作，如果没有帮助，请见谅。

[https://superuser.com/questions/42537/is-there-any-sudo-command-for-windows](https://superuser.com/questions/42537/is-there-any-sudo-command-for-windows)

# c# - 引用冲突

> ID：11868790
> 
> 赞同：5
> 
> 时间：2012-08-08T16:15:30.153
> 
> 标签：c#, asp.net, youtube

我在我的网站上添加了对以下 dll 的引用

**Google.GData.Client.dll
Google.GData.YouTube.dll
Google.GData.Extensions.dll**

它们用于将视频上传到 youtube。现在，当我尝试编译我的网站时，它添加了另一个名为 Newtonsoft.Json.dll 的 dll，编译失败并出现

> 错误 4 'c:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll' 和 'g:\Projects\X\bin\Newtonsoft.Json.dll' 中都存在类型 'System.Func'

我不敢相信谷歌发布了一个有这样一个错误的产品，我一定是在这里遗漏了什么？

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T06:19:41.900

[通过从http://json.codeplex.com/](http://json.codeplex.com/)下载 4.0 版本的 Newtonsoft.Json.dll 解决。

Google 似乎只分发 2.0 版本。

# git - git merge 并得到这个错误“不指向提交”

> ID：11868796
> 
> 赞同：12
> 
> 时间：2012-08-08T16:16:10.423
> 
> 标签：git, merge, fork, fetch

我从 github.com 分叉了一个 repo，并且还设置了上游遥控器。下面是我的回购

```
[ Leezhm LIZHM ~/Developments/OF_GIT ] git remote -v
origin  git@github.com:leezhm/openFrameworks.git (fetch)
origin  git@github.com:leezhm/openFrameworks.git (push)
upstream    https://github.com/openframeworks/openFrameworks.git (fetch)
upstream    https://github.com/openframeworks/openFrameworks.git (push) 
```

当我使用这个命令时

```
git fetch upstream develop
git merge upstream/mac8 
```

它总是出现以下错误

```
fatal: 'upstream/mac8' does not point to a commit 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T04:43:32.047

您只是在 fetching ，而[`upstream/develop`](https://github.com/openframeworks/openFrameworks/tree/develop)您希望 fetch可用。[`origin`](https://github.com/openframeworks/openFrameworks/branches)[`origin/mac8`](https://github.com/leezhm/openFrameworks/tree/mac8)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-23T12:44:09.247

git fetch
git checkout "new brach"
git pull "new branch"
git merge "new branch"

这对我有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T02:48:04.060

中可能没有对应的分支`origin/xxx`。

# javascript - 将javascript函数附加到rich：dataScroller

> ID：11868799
> 
> 赞同：0
> 
> 时间：2012-08-08T16:16:34.880
> 
> 标签：javascript, jsf, jsf-2, richfaces

我有一个**rich:datatable**，其中每一行都包含一个**selectOneCheckbox**。javascript 函数绑定到复选框并在选中另一个复选框时取消选择当前选中的复选框（因此，每次只能在页面内选中一个复选框）。数据表使用rich:datascroller 滚动结果页面。

如何在滚动到另一页之前取消选择一行？示例：我在第 1 页并选中第 1 行的复选框，然后按滚动条上的“3”：第 1 行的选择仍然存在，但我想在显示第 3 页**强文本**之前将其删除。

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:22:25.187

[rich:datascroller 标签](http://livedemo.exadel.com/richfaces-demo/richfaces/dataTableScroller.jsf?tab=info&cid=852706)有一个“onclick”属性，您可以在其中调用您的 js 函数：

```
<rich:datascroller id="myscroller"  onclick="unselectCombos()" /> 
```

我认为这会奏效。

# java - 自定义共享对话框

> ID：11868800
> 
> 赞同：3
> 
> 时间：2012-08-08T16:16:35.890
> 
> 标签：java, android, dialog

我正在尝试获取类似于下面的共享对话框，以便与预选的应用程序列表（电子邮件、Facebook、Twitter、Google+）共享一些纯文本。问题是，如果我启动共享文本的意图，则对话框中的应用程序太多。

1）我可以明确选择对话框中显示的应用程序吗？

2）如果没有，我可以制作一个自定义对话框。如果是这样，我可以专门选择一个应用程序来启动并提供我的意图吗？对于每个对话框选项，我会启动一个特定的应用程序。第一项 - 电子邮件，第二项 - facebook 等。

![在此处输入图像描述](../Images/bc499c1073ce8a8a92178455e83a6573.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:07:29.407

> 1）我可以明确选择对话框中显示的应用程序吗？

您无法修改操作系统使用应用选择器创建的此列表。（我猜所有这些应用程序都接受**非常常见**的数据类型“文本/纯文本”。）

> 2）如果没有，我可以制作一个自定义对话框。如果是这样，我可以专门选择一个应用程序来启动并提供我的意图吗？对于每个对话框选项，我会启动一个特定的应用程序。第一项 - 电子邮件，第二项 - facebook 等。

至于构建自己的自定义列表，您需要考虑以下几点：

*   您可以创建显式打开 GMail 和 Facebook 应用程序的 Intent，但有些用户不使用这些特定应用程序。相反，您应该显示接受特定数据类型（或 MIME 类型）的应用程序。

*   电子邮件应用程序具有特定的 MIME 类型：“message/rfc822”，但有些应用程序不使用它。使用“text/plain”可能会更安全。

*   我不知道任何特定的 Facebook MIME 类型，无论如何您都必须使用“文本/纯文本”。或者，您可以使用 PackageManager 在每个已安装的应用程序中搜索字符串“facebook”，但是第三方 Facebook 应用程序的包名称中可能没有此字符串......

如果您要使用“text/plain”数据类型，那么您最终会得到操作系统已经自动为您创建的列表......

你想做的事情并非不可能，但它比听起来更难。最后，您可能会不小心将用户最喜欢的应用程序从您的自定义列表中排除...

（Android 有一个关于这个主题的有见地的博客：[与 Intents 共享](http://android-developers.blogspot.com/2012/02/share-with-intents.html)。）

# php - 如何对对象数组进行排序（降序）但显式声明该数组的第一个元素？

> ID：11868803
> 
> 赞同：0
> 
> 时间：2012-08-08T16:17:01.273
> 
> 标签：php, sorting

说我有一个对象数组：

```
Array (
  [0] => stdClass Object (
    [id] => 1
    [name] => product_1
    [cost] =>9.99
  )
  [1] => stdClass Object (
    [id] => 2
    [name] => product_2
    [cost] =>2.99
  )
  [2] => stdClass Object (
    [id] => 3
    [name] => product_3
    [cost] =>4.99
  )
  [3] => stdClass Object (
    [id] => 4
    [name] => product_4
    [cost] =>1.99
  )
  [4] => stdClass Object (
    [id] => 5
    [name] => product_5
    [cost] =>0.99
  )
) 
```

我想从最低成本到最高成本对它们进行排序，但是数组中的第一个元素必须具有“product_3”的 [name]。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:20:16.433

为此，您不能仅依靠排序。你需要更多的逻辑：

1.  在自己的变量中捕获即将成为第一个元素。
2.  从数组中删除该元素。
3.  使用 对数组进行排序[`usort()`](http://php.net/usort)。
4.  使用 将元素从 #1 移动到数组的前面[`array_unshift()`](http://php.net/array_unshift)。

所以，对于#1，你可以做很多事情。最简单的方法是循环数组以找到索引第一个对象所在的键，[`unset()`](http://php.net/unset)它：

```
$first = null;
foreach( $array as $key => $obj) {
    if( $obj->name == 'product_3') {
        $first = $obj;
        unset( $array[ $key ]); 
        break;
    }
} 
```

现在您有了 in 中的第一个元素`$first`，因此您必须使用以下命令对数组进行排序`usort()`：

```
usort( $array, function( $a, $b) {  
    if( $a->cost == $b->cost) 
        return 0; 
    return $a->cost < $b->cost ? 1 : -1; // Might need to switch 1 and -1
}); 
```

最后，将第一个元素添加回已排序数组的开头：

```
array_unshift( $array, $first); 
```

[免责声明：上述实现均未经过测试。]

# html - HTML 验证错误

> ID：11868805
> 
> 赞同：0
> 
> 时间：2012-08-08T16:17:11.103
> 
> 标签：html, xhtml

我正在尝试使用[w3c-validator](http://validator.w3.org/check)
Encoding: utf-8
Doctype:XHTML 1.0 Frameset验证我的代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml">  
  <head>  
    <title>Openfire Archived IM content Search</title>  
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />  
  </head>  
  <body>  
    <p>  
        <!--The following javascript function re-directis the user to the same page-->
        <script type="text/javascript">  
        function startover(){  
            window.location="http://localhost/openfireIMsearch/index.php"  
        }  
        </script>

<!--html form for start-over button. The javascript function startover() is called when the user clicks this button-->
        <form method="get" action= "index.php" name = "re-login">
            <input type = "button" value ="Start Over" onclick = "startover()" />
            <input type = "hidden" name = "re-login-hidden" value ="re-login-on" />
        </form>  
    </p>
  </body>
</html> 
```

我收到以下我不知道的错误：

> 第 7 行，第 6 列：文档类型在此处不允许元素“body” ✉ 上面提到的元素是在不允许的上下文中找到的。这可能意味着您有错误的嵌套元素——例如“body”部分中的“style”元素而不是“head”内部——或者两个重叠的元素（这是不允许的）。此错误的一个常见原因是在 HTML 文档中使用了 XHTML 语法。由于 HTML 的隐式关闭元素规则，此错误可能会产生级联效果。例如，在 HTML 文档的“head”部分中为“meta”和“link”使用 XHTML 的“self-closure”标签可能会导致解析器推断“head”部分的结尾和“body”部分的开头“部分（其中”

错误消息似乎表明一个原因可能是我使用了元标记。但是 doctype 清楚地表明该文档是 XHTML 而不是 HTML。我在这里不知所措。有人能解释一下吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:19:13.220

您的 doctype 似乎告诉我它是一个框架集。这会使正文标签非法，而您会期望有一个框架集。自从我做了任何框架以来已经有一段时间了，所以我可能记错了。

如果它不明显，解决方案是找到正确的文档类型。就像是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

[http://www.w3.org/QA/2002/04/valid-dtd-list.html](http://www.w3.org/QA/2002/04/valid-dtd-list.html)似乎有一个可供选择的列表（并且是我从中复制上述内容的地方）。

# java - 使用空闲实例和待处理延迟设置调整 AppEngine 性能

> ID：11868809
> 
> 赞同：5
> 
> 时间：2012-08-08T16:17:21.260
> 
> 标签：java, performance, google-app-engine

我有一个应用程序引擎（付费）应用程序，平均每天访问量约为 200 次（1000 次页面浏览量，偶尔会飙升至 1000 次访问量和 10000 次页面浏览量或更多），我目前每 5 分钟通过 cron 作业唤醒它确保合理的性能。这在应用程序引擎延迟峰值期间并不总是有效（幸运的是，最近这种情况并不经常发生），当这种情况发生时，我的 ajax 调用会严重超时。此外，cron-job 策略并不理想，因为它会消耗配额。

目前我在“自动”上有空闲实例和待处理延迟设置。

**有没有人有手动调整这些设置的经验，在给定流量的情况下，有哪些典型值可以保证我的应用程序性能更好？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:28:56.597

而不是 cron 作业，只需将 Idle Instances 设置为 1。Idle Instances 是处于“保留”状态的实例，可让您即时响应增加的负载。因此，如果您的负载需要三个实例，并且您将 Idle Instance 设置为一个，那么您将有 4 个实例在运行。

不利的一面是，您将始终为比当前使用的实例多支付一个实例。但是，请记住，您每天可以获得 28 个免费实例小时，免费覆盖一个空闲实例（除非您有一个实例实际服务请求，然后再增加一个空闲实例将是额外费用）。

此外，如果您设置了 Idle Instances，则 Pending Latency 将几乎没有影响，因为当需要启动新实例时会咨询 Pending Latency，但您始终保留一个实例。警告：如果应用程序代码出问题或写得不好（例如在请求处理程序中调用外部服务），这可能不是真的，导致响应时间异常长。

底线：将 Idle Instances 设置为 1，然后将 Pending Latency 设置为您的应用仍然可以接受的某个最大值。

# bash - 在脚本变量中捕获 bash 时间的输出

> ID：11868811
> 
> 赞同：7
> 
> 时间：2012-08-08T16:17:34.567
> 
> 标签：bash, shell, time, wget

我正在尝试这个：

```
TIMEFORMAT=%R;
foo=$(time wget http://www.mysite.com)
echo $foo 
```

当我执行时，我在输出中看到了我想要的数字，但在变量 foo 中没有（echo $foo 什么都不打印）。

这是为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T16:29:09.597

您没有捕获任何内容，`foo`因为`time`将其输出发送到`stderr`. 问题是该`wget`命令还将其大部分输出发送到`stderr`. 要拆分两个流（并丢弃来自 的输出`wget`），您需要使用[subshel​​l](http://tldp.org/LDP/abs/html/subshells.html)：

```
TIMEFORMAT=%R;
foo=$( time ( wget http://www.example.com 2>/dev/null 1>&2 ) 2>&1 )
echo $foo 
```

这是对正在发生的事情的解释......

该命令的内部部分：

```
( wget http://www.example.com 2>/dev/null 1>&2 ) 
```

同时发送`stderr`和`stdout`到`/dev/null`，本质上是把它们扔掉。

外部：

```
foo=$( time ( ... ) 2>&1 ) 
```

`stderr`从命令发送`time`到发送的相同位置，`stdout`以便它可以被[命令替换](http://tldp.org/LDP/abs/html/commandsub.html)( `$()`) 捕获。

**更新：**

如果您想变得非常聪明，可以通过像这样处理文件描述符`wget`来传递传递到的输出：`stderr`

```
foo=$( time ( wget http://www.example.com 2>&1 ) 3>&1 1>&2 2>&3 ) 
```

# wordpress - Wordpress：网址重写

> ID：11868817
> 
> 赞同：0
> 
> 时间：2012-08-08T16:18:01.617
> 
> 标签：wordpress, url-rewriting, rewrite

我正在尝试在 wordpress 中重写一个 url，以便我可以根据传递的变量提供动态内容。我有一个插件，需要将可变数据传递给它。目前我有：

```
http://xyzsite.com/page/?var1=something 
```

这工作正常并传入 $_GET var。所以我的下一步是清理变量，使其看起来像

```
http://xyzsite.com/page/something 
```

我已经进行了一些谷歌搜索，并访问了一些看起来很有希望的网站，但我无法让它们中的任何一个工作。根据我的阅读，我需要使用

```
add_rewrite_tag and add_rewrite_rule 
```

阅读完文章后，我已将其添加到我的 functions.php 页面：

```
add_rewrite_tag('%var1%','([^&]+)');
add_rewrite_rule('^page/([^&]+)/?','index.php?p=1141&var1=$matches[1]','top'); 
```

当我导航到页面[http://xyzsite.com/page/something](http://xyzsite.com/page/something)我收到 404 错误。当我导航到[http://xyzsite.com/page/?var1=something](http://xyzsite.com/page/?var1=something)它仍然工作正常。所以看起来我的重写没有注册或正常工作。

有人可以帮我实现上述重写。仅供参考，我的永久链接设置设置为帖子名称，如果这很重要的话。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T10:34:51.643

I̶'̶m̶̶n̶o̶t̶̶a̶̶r̶e̶g̶e̶x̶̶p̶r̶o̶,̶̶b̶u̶t̶̶I̶̶s̶u̶s̶p̶e̶c̶t̶̶a̶n̶̶i̶s̶s̶u̶e̶̶i̶n̶̶y̶o̶u̶r̶r̶r̶e̶w̶r̶i̶t̶e̶̶r̶u̶l

```
a̶d̶d̶_̶r̶e̶w̶r̶i̶t̶e̶_̶r̶u̶l̶e̶(̶'̶^̶p̶a̶g̶e̶/̶(̶[̶^̶&amp;̶]̶+̶)̶/̶?̶'̶,̶'̶i̶n̶d̶e̶x̶.̶p̶h̶p̶?̶p̶=̶1̶1̶4̶1̶&amp;̶v̶a̶r̶1̶=̶$̶m̶a̶t̶c̶h̶e̶s̶[̶1̶]̶'̶,̶'̶t̶o̶p̶'̶)̶;̶ 
```

̶请注意̶/̶̶......你加在̶e̶n̶d̶.̶因此，你应该访问您的网页以http：？？̶/̶/̶x̶y̶z̶s̶i̶t̶e̶.̶c̶o̶m̶/页/某事/̶̶而不是̶x̶y̶z̶s̶i̶t̶e̶.̶c̶o̶m̶/页/某事.̶̶H̶a̶v̶e̶̶y̶o̶u̶̶t̶r̶i̶e̶d̶̶i̶f̶̶t̶h̶a̶t̶̶w̶o̶r̶k̶s̶?̶

**正如 Gustavo Straube 在评论中指出的那样，上面划掉的文字是错误的。请忽略该建议的解决方案。**

我最后的建议是尝试`flush_rules();`在你的最后一个之后添加一个`add_rewrite_rule`，如[http://codex.wordpress.org/Rewrite_API/flush_rules](http://codex.wordpress.org/Rewrite_API/flush_rules)中所述。

请注意，您应该使用`get_query_var('var_name')`而不是尝试`$_GET`直接访问您的查询变量。

# c# - 旋转 3d 模型 XAML c#

> ID：11868823
> 
> 赞同：4
> 
> 时间：2012-08-08T16:18:37.513
> 
> 标签：c#, xaml, model, 3d, edit

我编写了一个程序，它以 XAML 格式导入 3d 模型：

```
<Viewport3D x:Name="ZAM3DViewport3D" ClipToBounds="true" Width="400" Height="300" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/interactivedesigner/2006" xmlns:c="http://schemas.openxmlformats.org/markup-compatibility/2006" c:Ignorable="d">
<Viewport3D.Resources>
    <ResourceDictionary>/**other Elements at the same Level**/
        <Transform3DGroup x:Key="root_boneOR13TR12" >
            <TranslateTransform3D OffsetX="-0" OffsetY="-0" OffsetZ="-0"/>
            <ScaleTransform3D ScaleX="1" ScaleY="1" ScaleZ="1"/>
            <RotateTransform3D>
                <RotateTransform3D.Rotation>
                    <AxisAngleRotation3D Angle="90.00000933" Axis="-1 0 0"/>
                </RotateTransform3D.Rotation>
            </RotateTransform3D>
            <TranslateTransform3D OffsetX="-0.00299196" OffsetY="0.00964678" OffsetZ="0.000916864"/>
        </Transform3DGroup>
    </ResourceDictionary>
</Viewport3D.Resources>

<Viewport3D.Camera>
    <PerspectiveCamera x:Name="FrontOR6" FarPlaneDistance="10" LookDirection="0,0,-1" UpDirection="0,1,0" NearPlaneDistance="0.1" Position="0,-0.0439422,0.729628" FieldOfView="39.5978" />
</Viewport3D.Camera>

<ModelVisual3D>
    <ModelVisual3D.Content>
        <Model3DGroup x:Name="Scene" Transform="{DynamicResource SceneTR7}"> <!-- Scene (XAML Path = ) -->
            <AmbientLight Color="#646464" />
            <DirectionalLight Color="#FFFFFF" Direction="-0.612372,-0.5,-0.612372" />
            <DirectionalLight Color="#FFFFFF" Direction="0.612372,-0.5,-0.612372" />
            <Model3DGroup x:Name="rootOR9" Transform="{DynamicResource rootOR9TR8}"> <!-- root (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3]) -->
                <Model3DGroup x:Name="glasses_meOR11" Transform="{DynamicResource glasses_meOR11TR10}"> <!-- glasses_me (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0]) -->
                    <Model3DGroup x:Name="root_boneOR13" Transform="{DynamicResource root_boneOR13TR12}"> <!-- root_bone (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0]) -->
                        <Model3DGroup x:Name="main_boneOR15" Transform="{DynamicResource main_boneOR15TR14}"> <!-- main_bone (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0]) -->
                        </Model3DGroup>
                        <Model3DGroup x:Name="right_boneOR19" Transform="{DynamicResource right_boneOR19TR18}"> <!-- right_bone (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[1]) -->
                            <Model3DGroup x:Name="right_bon0OR21" Transform="{DynamicResource right_bon0OR21TR20}"> <!-- right_bon0 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0]) -->
                            </Model3DGroup>
                        </Model3DGroup>
                        <Model3DGroup x:Name="left_bone_OR25" Transform="{DynamicResource left_bone_OR25TR24}"> <!-- left_bone_ (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[2]) -->
                            <Model3DGroup x:Name="left_boneOR27" Transform="{DynamicResource left_boneOR27TR26}"> <!-- left_bone (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[2].(Model3DGroup.Children)[0]) -->
                            </Model3DGroup>
                        </Model3DGroup>
                    </Model3DGroup>
                    <GeometryModel3D x:Name="glasses_meOR11GR12" Geometry="{DynamicResource glasses_meOR11GR12}" Material="{DynamicResource ER___Default_MaterialMR1}" BackMaterial="{DynamicResource ER___Default_MaterialMR1}"/>
                </Model3DGroup>
                <Model3DGroup x:Name="glasses_m0OR32" Transform="{DynamicResource glasses_m0OR32TR31}"> <!-- glasses_m0 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1]) -->
                    <Model3DGroup x:Name="root_bone1OR34" Transform="{DynamicResource root_bone1OR34TR33}"> <!-- root_bone1 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0]) -->
                        <Model3DGroup x:Name="main_bone1OR36" Transform="{DynamicResource main_bone1OR36TR35}"> <!-- main_bone1 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0]) -->
                            <Model3DGroup x:Name="main_eff1OR38" Transform="{DynamicResource main_eff1OR38TR37}"> <!-- main_eff1 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0]) -->
                                <Model3DGroup x:Name="right_bon1OR40" Transform="{DynamicResource right_bon1OR40TR39}"> <!-- right_bon1 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0]) -->
                                    <Model3DGroup x:Name="right_bon2OR42" Transform="{DynamicResource right_bon2OR42TR41}"> <!-- right_bon2 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0]) -->
                                    </Model3DGroup>
                                </Model3DGroup>
                                <Model3DGroup x:Name="left_bone0OR46" Transform="{DynamicResource left_bone0OR46TR45}"> <!-- left_bone0 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[1]) -->
                                    <Model3DGroup x:Name="left_bone1OR48" Transform="{DynamicResource left_bone1OR48TR47}"> <!-- left_bone1 (XAML Path = (Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0].(Model3DGroup.Children)[1].(Model3DGroup.Children)[0]) -->
                                    </Model3DGroup>
                                </Model3DGroup>
                            </Model3DGroup>
                        </Model3DGroup>
                    </Model3DGroup>
                </Model3DGroup>
            </Model3DGroup>
        </Model3DGroup>
    </ModelVisual3D.Content>
</ModelVisual3D> 
```

我想通过 C# 访问 Transform3DGroup x:Key="root_boneOR13TR12" 元素，并希望在需要时修改 AxisAngelRotation 属性。

真诚的，bbklol

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-25T18:17:33.537

让我们从定义故事板开始：当您运行它时，它实际上会旋转您的对象！

然后，通过一些动画（也`DoubleAnimation`很好用），您可以设置 RotateTransform3D 的 Rotation 属性（见下文）。

在您的情况下，要回答您的问题，我认为您应该使用非常接近此的语法（我保留了您的 XAML 路径，用`[ ]`....remove 它们签名！！）：

```
Storyboard.TargetProperty="[(Viewport3D.Children)[0].(ModelVisual3D.Content).(Model3DGroup.Children)[3].(Model3DGroup.Children)[0].(Model3DGroup.Children)[0])].(ModelVisual3D.Transform).(Transform3DGroup.Children)[2].(RotateTransform3D.Rotation).(AxisAngleRotation3D.Angle)" 
```

我只是给你举个例子，也许你可以用更简单的方式理解......

这个是故事板，它将旋转`ViewPort3D`下面的项目：

```
<Storyboard x:Key="RotationStoryboard">
    <!--This is an horizontal rotation-->
    <DoubleAnimation Storyboard.TargetProperty="(Viewport3D.Children)[0].(ModelVisual3D.Transform).(Transform3DGroup.Children)[0].(RotateTransform3D.Rotation).(AxisAngleRotation3D.Angle)"
        BeginTime="0:0:0.25"
        From="360"
        To="0"
        Duration="0:0:4.5"
        RepeatBehavior="Forever" />
    <!--This is an orbital horizontal rotation (I removed the other rotation on first transformation)-->
    <DoubleAnimation Storyboard.TargetProperty="(Viewport3D.Children)[1].(ModelVisual3D.Transform).(Transform3DGroup.Children)[3].(RotateTransform3D.Rotation).(AxisAngleRotation3D.Angle)"
        From="360"
        To="0"
        RepeatBehavior="Forever"
        Duration="0:0:3.5" />
</Storyboard> 
```

这个 ix 对象的 XAML 代码...

```
<Viewport3D>
    <Viewport3D.Children>
        <!--First object-->
        <ModelVisual3D>
            <ModelVisual3D.Transform>
                <Transform3DGroup>
                    <RotateTransform3D>
                        <RotateTransform3D.Rotation>
                            <AxisAngleRotation3D Angle="360"
                                                 Axis="0,1,0" />
                            </RotateTransform3D.Rotation>
                    </RotateTransform3D>
                </Transform3DGroup>
            </ModelVisual3D.Transform>
            <model3d:Sphere3D />
        </ModelVisual3D>
        <!--Second object-->
        <ModelVisual3D>
            <ModelVisual3D.Transform>
                <Transform3DGroup>
                    <RotateTransform3D>
                        <RotateTransform3D.Rotation>
                            <AxisAngleRotation3D Angle="360" 
                                                 Axis="0,1,0" />
                        </RotateTransform3D.Rotation>
                    </RotateTransform3D>
                    <ScaleTransform3D ScaleZ="0"
                                      ScaleY="0"
                                      ScaleX="0"/>
                    <TranslateTransform3D OffsetX="3.5" />
                    <RotateTransform3D CenterX="0"
                                       CenterY="0"
                                       CenterZ="0">
                        <RotateTransform3D.Rotation>
                            <AxisAngleRotation3D Angle="360" 
                                                 Axis="0,1,0" />
                        </RotateTransform3D.Rotation>
                    </RotateTransform3D>
                </Transform3DGroup>
            </ModelVisual3D.Transform>
            <model3d:Sphere3D x:Name="SatelliteSphere">
                    <model3d:Sphere3D.Transform>
                        <RotateTransform3D CenterX="-1"
                                           CenterY="-1"
                                           CenterZ="-1" />
                    </model3d:Sphere3D.Transform>
            </model3d:Sphere3D>
        </ModelVisual3D>
    </Viewport3D.Children>
</Viewport3D> 
```

# sql-server-2008 - 在 Excel 中通过 ADODB.connection 连接到 SQL Server 2008 时出现错误 3709

> ID：11868824
> 
> 赞同：3
> 
> 时间：2012-08-08T16:18:42.647
> 
> 标签：sql-server-2008, excel, adodb, vba

我正在尝试使用以下代码在 Excel 中的 SQL Server 上打开记录集，但出现`3709 - The connection cannot be used to perform this operation. It is either closed or invalid in this context.`错误。我哪里错了？：

编辑：

它现在正在工作，我将更新以下代码：

```
'Declare variables'
    Set objMyConn = New ADODB.Connection
    Set objMyRecordset = New ADODB.Recordset
    Dim strSQL As String

'Open Connection'
    objMyConn.ConnectionString = "Driver={SQL Server};Server=SERVER\SERVER; Database=we_ci_db; Trusted_Connection=Yes"
    objMyConn.Open

'Set and Excecute SQL Command'
    strSQL = "select * from tblUsers"

'Open Recordset'
    Set objMyRecordset.ActiveConnection = objMyConn
    objMyRecordset.Open strSQL

'Copy Data to Excel'
    ActiveSheet.Range("A1").CopyFromRecordset (objMyRecordset) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T14:44:04.387

Remou 向我指出了另一个连接字符串的方向，但我仍然得到了相同的结果。我用谷歌搜索了一下，并想出了另一个具有不同实现的 SO Question [LINK](https://stackoverflow.com/questions/1120674/accessing-sql-database-in-excel-vba)，结果是：

```
'Declare variables'
    Set objMyConn = New ADODB.Connection
    Set objMyRecordset = New ADODB.Recordset
    Dim strSQL As String

'Open Connection'
    objMyConn.ConnectionString = "Driver={SQL Server};Server=SERVER\SERVER; Database=we_ci_db; Trusted_Connection=Yes"
    objMyConn.Open

'Set and Excecute SQL Command'
    strSQL = "select * from tblUsers"

'Open Recordset'
    Set objMyRecordset.ActiveConnection = objMyConn
    objMyRecordset.Open strSQL

'Copy Data to Excel'
    ActiveSheet.Range("A1").CopyFromRecordset (objMyRecordset) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:23:16.323

那不是您需要的连接字符串。它应该是这样的：

```
Provider=sqloledb;Data Source=SERVER\SERVER;Initial Catalog=cs_db;Integrated Security=SSPI; 
```

请参阅[http://connectionstrings.com](http://connectionstrings.com)

# file - 根据文件是否包含字符串进行搜索然后删除

> ID：11868825
> 
> 赞同：5
> 
> 时间：2012-08-08T16:18:44.223
> 
> 标签：file, batch-file, text, delete-file, findstr

我想在单个目录中的多个文本文件中搜索字符串（'monkey'），如果该字符串存在，那么取决于最简单的方法：

1.  重命名匹配的字符串 - 例如更改猴子 monkey1 并保存然后文件并进行搜索/处理

或者

2.  删除任何具有匹配字符串的文件。

已经搜索但似乎找不到任何简单的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T16:48:16.737

使用本机 Windows 批处理命令修改文本文件的内容相当复杂，因此选项 1) 并不容易。虽然如果您下载用于 Windows 的 gnu sed 之类的第 3 方工具，这很容易。

选项 2) 非常简单。您可以在没有批处理文件的情况下在命令行上执行此操作。假设您的当前目录是您要查找文件的位置：

```
for /f "eol=: delims=" %F in ('findstr /m monkey *.txt') do del "%F" 
```

如果从批处理文件中执行，则需要将百分比加倍 - 使用`%%F`而不是`%F`.

FINDSTR 命令有许多选项，例如 /I 用于不区分大小写的搜索，/S 用于搜索子目录，/R 用于原始正则表达式搜索。

# c - 从用户中找到 n 个整数的中位数

> ID：11868826
> 
> 赞同：-4
> 
> 时间：2012-08-08T16:18:49.913
> 
> 标签：c

有谁知道如何将下面的代码从热心极客更改为允许用户输入（例如输入 n，然后输入 n 个整数）？输出这 n 个整数和中位数。n 为正数且小于 100 万。

从热心的 com 粘贴的代码：

```
#include <stdio.h>
#include <stdlib.h>

#define ELEMENTS 6

int values[] = { 40, 10, 100, 90, 20, 25 };

int compare (const void * a, const void * b)
{
  return ( *(int*)a - *(int*)b );
}

int main ()
{
  int n;
  qsort (values, ELEMENTS, sizeof(int), compare);
  for (n=0; n<ELEMENTS; n++)
  {   printf ("%d ",values[n]); }
  printf ("median=%d ",values[ELEMENTS/2]);
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:23:56.173

利用：

```
int values[static or dynamic allocation dependent]
for (i=0;i<n;i++){
  printf("Enter number:");
  scanf(%d, value[i]);
} 
```

而不仅仅是硬编码 values 数组的值。

确保您要么动态地声明数组，要么静态地使其足够大以接受您想要的整数数量，1,000,000 但那是大量的内存。没有人会花那么多时间手动输入那么多数字。将其声明为 30 顶可能是安全的。

或者，如果您打算使用“定义元素”部分，则只需将值数组声明为 6。

# com - COleDispatchDriver 具有特定的 exe 作为 COM 服务器

> ID：11868830
> 
> 赞同：0
> 
> 时间：2012-08-08T16:19:08.903
> 
> 标签：com, mfc

我继承了一个应用程序，它由一堆使用 COM 和 COleDispatchDriver 进行通信的 exe 文件组成。有一个主要的“客户端”exe 和几个提供服务的“服务器”可执行文件。

目前，客户端进程使用 COleDispatchDriver::CreateDispatch() 启动服务器，传递一个应用程序 ID，该应用程序 ID 被解析为一个类 ID。这样做的问题是它依赖于正在注册的 COM 服务器（一个潜在的故障点）。如果机器上有多个不同版本的 COM 服务器 exe，也可能会出现问题。

我想让它变得不那么脆弱，而不必在此时完全重新架构应用程序。有没有办法保持相同的通信机制，但显式启动特定的服务器应用程序？客户端知道服务器应用程序在哪里以及它们被称为什么（它们与客户端在同一目录中）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:46:54.720

这有点棘手，但您可以自己手动编组您需要的接口。让客户端启动服务器，该服务器创建客户端对象并使用`CoMarshallInterface()`.

一旦客户端编组了接口，您应该能够通过简单地调用 QueryInterface 来获取 IDispatch 接口。

# algorithm - 在 3d 高度图中找到鞍点

> ID：11868831
> 
> 赞同：5
> 
> 时间：2012-08-08T16:19:11.090
> 
> 标签：algorithm, language-agnostic, 3d, geometry, point-clouds

给定 3d 高度图（来自激光扫描仪），我如何找到[鞍点](http://en.wikipedia.org/wiki/Saddle_point)？

即给出这样的东西：

![高度轮廓](../Images/60ec59c76ed4acfaf524411d93e04b29.png)

我正在寻找曲率在一个方向上为正而在另一个方向上为负的所有点。

（这些方向不应该与X和Y轴对齐。我知道如何检查X方向的曲率是否与Y方向的曲率具有相反的符号，但这并不涵盖所有情况。更糟糕的是, X 中的分辨率与 Y 中的分辨率不同)

![在此处输入图像描述](../Images/e7c91dd6f29221f2309e3586c9372b8f.png)

理想情况下，我正在寻找一种可以容忍一定量噪声并且只标记“重要”鞍点的算法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-02T19:32:57.880

我一直在探索计算拓扑类的类似问题，并通过下面概述的方法取得了一些成功。

首先，您需要一个比较函数，该函数将评估两个输入点的高度，并为任何输入返回 < 或 >（不等于）。一种方法是，如果这些点的高度相等，则使用一些基于位置或随机索引来找到更大的点。您可以将其视为在高度上添加了一个无穷小的扰动。

现在，对于每个点，您将比较所有周围邻居的高度（在 2D 矩形网格上将有 8 个邻居）。一个点的较低链接将是高度小于该点的所有邻居的集合。

如果所有相邻值都在较低的链接中，则您处于局部最大值。如果没有一个点位于较低的链接中，则您处于局部最小值。否则，如果下连杆是单个连通集，则您位于斜坡上的常规点。但是，如果下面的链接是两个不相连的集合，那么您就处于劣势。

在 2D 中，您可以在要检查的点周围按循环顺序构建 8 个相邻点的列表。根据您的比较函数，您为每个邻居分配一个 +/-1 的值。然后，您可以逐步浏览该列表（记住比较两个端点）并计算符号更改的次数以确定下部链接中连接组件的数量。

确定哪些鞍座是“重要的”是一个更困难的分析。您可能希望查看以下内容：[http](http://www.cs.jhu.edu/~misha/ReadingSeminar/Papers/Gyulassy08.pdf) ://www.cs.jhu.edu/~misha/ReadingSeminar/Papers/Gyulassy08.pdf以获得一些指导。

-迈克尔

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T17:58:26.950

（来自对数学的猜测而不是实践经验）

在每个候选点周围的小块中将二次拟合到曲面，例如使用最小二乘法。补丁的大小是控制噪声的一种方法，您可以通过加权点来获得，具体取决于它们与候选点的距离。在矩阵表示法中，您可以将二次方程表示为 x'Ax + b'x + c，其中 A 是对称的。

二次方程在 x = (A^-1)b/2 处的梯度为零。如果这不在补丁中，请将其丢弃。

如果 A 同时具有 +ve 和 -ve 特征值，则您在 x 处有一个鞍点。由于 A 只有 2x2 并且最多有两个特征值，因此您可以忽略它为零特征值的情况，因此您无法在前一阶段将其反转。

# c++ - 数以百万计的随机数产生“溢出”rand_r？

> ID：11868834
> 
> 赞同：3
> 
> 时间：2012-08-08T16:19:14.613
> 
> 标签：c++, boost

我在使用 rand_r 时遇到问题。我有一个生成数百万随机数的模拟。我注意到在某个时间点，这些数字不再统一。可能是什么问题呢？

我做什么：我创建一个生成器的实例并给它自己的种子。

```
mainRGen= new nativeRandRUni(idumSeed_g); 
```

这是类/对象定义：

```
class nativeRandRUni {

    public:
        unsigned seed;

        nativeRandRUni(unsigned sd){ seed= sd; }
        float genP() { return (rand_r(&seed))/float(RAND_MAX); } // [0,1]
        int genI(int R) { return (rand_r(&seed) % R); } // [0,R-1]
}; 
```

数字简单地通过以下方式生成：

```
newIntNumber= mainRGen->genI(desired_max);
newFloatNumber= mainRGen->genP(); 
```

模拟存在上述问题。我知道这种情况正在发生，因为我在结果中显示签名的时间点之后检查了生成数字的分布（参见此图，上图，[http://ubuntuone.com/0tbfidZaXfGNTfiVr3x7DR](http://ubuntuone.com/0tbfidZaXfGNTfiVr3x7DR)）

另外，如果我在 t-1 和 t 打印种子，作为签名的时间点，我可以看到种子从值 263069042 到 1069048066 的数量级变化

如果我用不同的种子运行代码，问题总是存在但在不同的时间点

此外，如果我使用 rand() 而不是我的对象，一切顺利......我确实需要对象，因为有时我使用了线程。上面的示例没有线程。

我真的迷路了，有什么线索吗？

**编辑**-**编辑**
它可以通过循环足够的次数来重现，问题是，就像我说的，它需要数百万次迭代才能出现问题。对于种子 -158342163，我在 t=134065568 代得到它。可以检查之前（统一）和之后（不统一）生成的数字。如果我在给定的 t 处手动更改种子，我会遇到同样的问题，请参阅代码中的 (*)。我也不希望发生的事情？

```
#include <tr1/random>
#include <fstream> 
#include <sstream>
#include <iostream>

using std::ofstream;
using std::cout;
using std::endl;

class nativeRandRUni {

    public:
        unsigned seed;
        long count;

        nativeRandRUni(unsigned sd){ seed= sd; count=0; }
        float genP() { count++; return (rand_r(&seed))/float(RAND_MAX); } // [0,1]
        int genI(int R) { count++; return (rand_r(&seed) % R); } // [0,R-1]

};

int main(int argc, char *argv[]){

    long timePointOfProblem= 134065568;

    nativeRandRUni* mainRGen= new nativeRandRUni(-158342163);
    int rr;

    //ofstream* fout_metaAux= new ofstream();
    //fout_metaAux->open("random.numbers");
    for(int i=0; i< timePointOfProblem; i++){
            rr= mainRGen->genI(1009200);
            //(*fout_metaAux) << rr << endl;
            //if(i%1000==0) mainRGen->seed= 111111; //(*) FORCE    
    }
    //fout_metaAux->close();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:37:16.310

鉴于随机数是模拟的关键，您应该实现自己的生成器。我不知道 rand_r 使用的是什么算法，但它可能是非常糟糕的东西，比如线性全等生成器。

我会考虑在您了解底层算法的情况下快速实现具有良好品质的东西。我会从实现 Mersenne Twister 开始：

[http://en.wikipedia.org/wiki/Mersenne_twister](http://en.wikipedia.org/wiki/Mersenne_twister)

它易于实现且速度非常快 - 无需分隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:45:51.323

最终尝试了一个简单的 boost 解决方案，将生成器更改为：

```
class nativeRandRUni {
    public:
        typedef mt19937 EngineType;
        typedef uniform_real<> DistributionType;
        typedef variate_generator<EngineType, DistributionType> VariateGeneratorType;

        nativeRandRUni(long s, float min, float max) : gen(EngineType(s), DistributionType(min, max)) {}
        VariateGeneratorType gen;
}; 
```

我不再遇到问题了......虽然它解决了它，但我对不理解它是什么感到很不舒服。我认为 Rafael 是对的，我不应该相信 rand_r 这么密集的几代人

现在，这比以前慢，所以我可能会寻找优化它的方法。 **问题**：Mersenne Twister 的实现原则上会更快吗？

谢谢大家！

# c# - 在范围列表中搜索数字的最快方法

> ID：11868837
> 
> 赞同：9
> 
> 时间：2012-08-08T16:19:24.893
> 
> 标签：c#, performance, algorithm, c#-4.0, optimization

我有以下代码来查找范围列表中数字的匹配项。

```
public class RangeGroup
{
    public uint RangeGroupId { get; set; }
    public uint Low { get; set; }
    public uint High { get; set; }
    // More properties related with the range here
}

public class RangeGroupFinder
{
    private static readonly List<RangeGroup> RangeGroups=new List<RangeGroup>();

    static RangeGroupFinder()
    {
        // Populating the list items here
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023238144, High = 1023246335 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023246336, High = 1023279103 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023279104, High = 1023311871 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023311872, High = 1023328255 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023328256, High = 1023344639 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023344640, High = 1023410175 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023410176, High = 1023672319 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023672320, High = 1023688703 });
        RangeGroups.Add(new RangeGroup { RangeGroupId = 0, Low = 1023692800, High = 1023696895 });
       // There are many more and the groups are not sequential as it can seen on last 2 groups
    }

    public static RangeGroup Find(uint number)
    {
        return RangeGroups.FirstOrDefault(rg => number >= rg.Low && number <= rg.High);
    }
} 
```

RangeGroup 的列表包含大约 5000000 个项目，并且 Find() 方法将被大量使用，因此我正在寻找一种更快的方法来进行搜索。改变数据结构或以任何方式拆分数据都没有问题。

编辑：

所有范围都是唯一的，并且按低的顺序添加，并且它们不重叠。

结果：

使用[ikh 的代码](https://stackoverflow.com/questions/11868837/fastest-way-to-search-a-number-in-a-list-of-ranges/11869161#11869161)进行了测试，结果比我的代码快了大约 7000 倍。测试代码和结果可以在[这里](https://gist.github.com/3297288)看到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T16:39:32.167

由于您表示`RangeGroup`s 按顺序添加`RangeGroup.Low`并且它们不重叠，因此您无需进行任何进一步的预处理。您可以对`RangeGroups`列表进行二进制搜索以查找范围（警告：未完全测试，您需要检查一些边缘条件）：

```
public static RangeGroup Find(uint number) {
    int position = RangeGroups.Count / 2;
    int stepSize = position / 2;

    while (true) {
        if (stepSize == 0) {
            // Couldn't find it.
            return null;
        }

        if (RangeGroups[position].High < number) {
            // Search down.
            position -= stepSize;

        } else if (RangeGroups[position].Low > number) {
            // Search up.
            position += stepSize;

        } else {
            // Found it!
            return RangeGroups[position];
        }

        stepSize /= 2;
    }
} 
```

最坏情况下的运行时间应该在 O(log(N)) 左右，其中 N 是 RangeGroup 的数量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T17:01:21.643

[区间树。](http://en.wikipedia.org/wiki/Interval_tree)完全按照您的要求创建。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T16:34:10.650

如果你只填充一次列表，你可以做一个魔术：

*   [排序列表](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)
*   使用[二分搜索](http://msdn.microsoft.com/en-us/library/w4e7fxsh.aspx)

排序需要 O(Nlog(N)) 时间并且只进行一次。二进制搜索需要 O(log(N))，最多需要对 100.000 个项目进行 17 次比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T17:00:50.050

可以使用排序列表并进行二进制搜索。这样您就可以将比较次数减少到 O(logN)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T16:58:36.380

在两个不同的数组中对范围进行两次排序。一次按范围内的最小值，一次按范围内的最大值。然后进行两次二分搜索，保存与任一约束匹配的范围。最后，对两组可能性做一组交集。

# android - 删除帐户时删除数据库

> ID：11868839
> 
> 赞同：5
> 
> 时间：2012-08-08T16:19:29.497
> 
> 标签：android, android-syncadapter, android-account

我的应用程序使用该模式，使用和 a`SyncAdapter`保存用户凭据以将数据存储在数据库中。`AccountManager``ContentProvider`

`account`删除后，我可以使用此问题中解释的方法删除[数据库](https://stackoverflow.com/a/5973098/119895)。通过执行以下操作删除数据库：

```
boolean deleted = mContext.deleteDatabase(DatabaseHelper.DATABASE_NAME); 
```

这工作正常，但是当我再次登录时，一切仍然存在。感觉就像`ContentProvider`不知道数据库已被删除。

在[这个答案](https://stackoverflow.com/a/8208863/119895)中，inazaruk 说：

> 您需要确保您已经终止了承载使用该特定数据库文件的 ContentProvider 的进程。只有删除它。

杀死清除数据库的过程感觉不对。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T17:16:29.673

如果我不得不这样做，我会尝试以下方式：

添加一些`Uri`在插入或删除时使用`Uri`触发数据库删除的`ContentProvider`. 删除时还要清除所有`SQLiteDatabase`对小路）。

通过将删除内容放入其中，`ContentProvider`您应该能够关闭数据库连接并以您知道需要重新创建数据库文件的方式跟踪删除状态。

`ContentProviders`除非您杀死您的应用程序，否则不要退出，因此您可能正在运行相同的实例，并且可能引用了上面提到的旧文件

# asp.net - 通过平面文件架构创建 SQL Server 表的最佳方法？

> ID：11868841
> 
> 赞同：1
> 
> 时间：2012-08-08T16:19:31.163
> 
> 标签：asp.net, sql, sql-server, sql-server-2008

我有一个来自另一种类型的数据库（我不知道是什么类型）的平面文件表架构（制表符分隔），但它为我提供了我需要的基础知识，例如列名、数据类型、描述。这个表有很多列。

从这个平面文件在 SQL Server 2008 中创建表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:28:43.870

前任：

您可以将文件导入具有以下列的表中

```
TableA:
    TABLE_NAME, COLUMN_NAME, DATA_TYPE, DESCRIPTION 
```

然后使用下面的脚本生成创建语句并复制输出并保存为 sql 脚本

```
SELECT 'CREATE TABLE TABLE1 (' + cols + ')' FROM  (
SELECT SUBSTRING(
(SELECT ',' + s.COLUMN_NAME + ' ' DATA_TYPE
FROM tableA s WHERE TABLE_NAME = 'TABLE1'
FOR XML PATH('')),2,200000) AS Cols) A 
```

# html - 什么会导致此按钮和文本不内联？

> ID：11868842
> 
> 赞同：0
> 
> 时间：2012-08-08T16:19:33.377
> 
> 标签：html, css

情况：我们应用程序的标题行中有 3 个按钮。格式如下：

```
<ul> class="menu dropdown clearfix">
    <li class="{buttonlabel}">
        <a href="#">
            <span> </span>
            <strong>{ButtonLabel}</strong>
        </a>
</li> 
```

CSS有一个背景图像来显示`<span>`一个图标（appx 20px square）。

所以，基本上，你有作为按钮的内联无序列表项。每个列表项都有一个 span（图标）和一个 strong（按钮标签）。

现在--2 台计算机/用户。相同的操作系统（Mac）。相同的浏览器（Chrome）。相同的网站/网址。一位用户按预期看到它们——也就是说，所有列表项都彼此内联，然后列表项中的内容（按钮和标签）也是内联的——按钮然后是标签。

另一个用户（有效地）将每个列表项中的内容视为块。在顶行显示图标。然后一个中断（不是文字 html 中断，只是下一行）和按钮标签显示在图标下方。他们的左边距对齐。

我试图通过缩小浏览器宽度来重现“工作”列表项，以查看按钮是否在某个时候“中断”到更小的状态——它们没有。

显示`<li>`值为 display: list item（宽度自动继承）。标签是 display : `<a>`block （宽度自动继承）。`<span>`是 display:inline-block，具有编码宽度（24px）（不是宽度自动或继承宽度）。`<strong>`也是 display: inline-block, width: auto (inherited) 。

更糟糕的是，看到错误内容的用户说周一是正常的，周二是错误的。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:26:40.577

听起来您应该在星期一加载备份，并在星期二进行“差异”以查看发生了什么变化，因为它以前工作过，这可能不是运行它的平台的错，而是有人改变了代码使得一个浏览器能够解析它而另一个浏览器不能。人为错误是发明版本控制的原因。

如果这不起作用，请记住验证您的 XHTML 和 CSS，以确保错误语法不是问题。这些验证器的目的是确保如果有效，则代码将按预期显示，如果不正确，则为浏览器制造商的错误，应将其报告为错误。

[http://validator.w3.org/](http://validator.w3.org/)

[http://jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:29:09.553

```
hai i think you initalize the class out of ul tag. so you put the class in inside ul tag.

<ul class="menu dropdown clearfix">
    <li class="{buttonlabel}">
        <a href="#">
            <span> </span>
            <strong>{ButtonLabel}</strong>
        </a>
   </li>
</ul> 
```

# path - Lua Require 函数对完整路径名

> ID：11868847
> 
> 赞同：13
> 
> 时间：2012-08-08T16:20:05.157
> 
> 标签：path, lua, require

我需要在一个并不总是在同一个地方的 lua 文件上调用 require。我试图在完整的路径名上调用 require ，但这似乎也不起作用。我什至尝试用相同文件的正确完整路径名替换我的正常工作要求之一

将要求“foo”更改为要求“C:\Users\Me\MyLuaProject\foo”的示例

但是当我将它切换到完整路径名时，它再也找不到它了。所以我想知道您是否甚至可以在完整路径上调用 require ，如果不能，我将如何以不同的方式获得相同的结果？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-08T17:05:50.107

如果您只需要加载文件，请使用`dofile`，它需要一个路径：

```
dofile("C:\\Users\\Me\\MyLuaProject\\foo") 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-08T16:34:25.300

将包含文件的目录添加到[package.path](http://www.lua.org/manual/5.1/manual.html#pdf-package.path)：

```
package.path = package.path .. ";C:\\Users\\Me\\MyLuaProject"
require "foo" 
```

您也可以将它添加到 LUA_PATH 环境变量中，但这可能不太容易即时修改。

模块的常见模式是拥有 abc.lua 和 abc/xyz.lua；要在这样的子目录中要求文件，请使用以下命令：

```
require "abc"
require "abc.xyz" 
```

# c++ - 如何检测无模式 CDialog 是否已关闭？

> ID：11868858
> 
> 赞同：4
> 
> 时间：2012-08-08T16:20:29.653
> 
> 标签：c++, visual-studio-2008, mfc, dialog

我已经按照这个问题制作了一个非模态/无模态对话框： [如何显示非模态 CDialog？](https://stackoverflow.com/questions/2271821/how-to-display-a-non-modal-cdialog)

我在 VS2008 中使用 MFC/C++。我对 C# 和 .net 比对 MFC 和 C++ 更流利。

我的表单中有一个启动对话框的菜单项。只能打开一个对话框实例。对话框显示正常。我可以通过单击角落的 X 来关闭它，当我关闭主窗体时它会关闭。我遇到的问题是单击 X 关闭对话框后无法再次打开对话框。我知道这是因为指针永远不会设置回 NULL。

我在表单的头文件中有这个：

```
CChildDialog *m_pDialog; 
```

我在表单的构造函数中有这一部分：

```
m_pDialog = NULL; 
```

单击菜单项时，我在菜单项的方法中有此代码（我从另一个 SO 答案修改了它，因为我只希望打开一个对话框实例）：

```
if(m_pDialog == NULL)
{
    // Invoking the Dialog
    m_pDialog = new CChildDialog();
    BOOL ret = m_pDialog->Create(IDD_CHILDDIALOG, this);

    if (!ret)   //Create failed.
    {
        AfxMessageBox(_T("Error creating Dialog"));
    }    

    m_pDialog->ShowWindow(SW_SHOW);
} 
```

现在我知道我需要执行这部分并将指针设置为 NULL，但我不知道把它放在哪里：

```
// Delete the dialog once done
delete m_pDialog;
m_pDialog = NULL; 
```

如果对话框已被处理，我是否需要继续监控？关闭对话框时是否有事件触发到父窗体？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T17:00:15.090

如果你想在用 X 关闭窗口后回收窗口的内容，你必须在你的对话框中处理 WM_CLOSE 消息：

```
void CChildDialog::OnClose()
{
    ShowWindow(SW_HIDE);
} 
```

然后在打开窗口的代码中：

```
if(m_pDialog == NULL)
{
    // Invoking the Dialog
    m_pDialog = new CChildDialog();
    BOOL ret = m_pDialog->Create(IDD_CHILDDIALOG, this);

    if (!ret)   //Create failed.
    {
        AfxMessageBox(_T("Error creating Dialog"));
    }    
}

m_pDialog->ShowWindow(SW_SHOW); //moved outside the if(m_pDialog == NULL) 
```

希望它可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-09T09:56:02.807

如果你想删除无模式对话框，那么就这样做。

如果您想在用户关闭无模式对话框时删除对话框的对象，您可以查看`WM_PARENTNOTIFY`. 如果子窗口被销毁并且子窗口没有设置扩展窗口样式`WS_EX_NOPARENTNOTIFY`，则 windows 向父窗口发送一个`WM_PARENTNOTIFY`with `wParam`= 。`WM_DESTROY`您应该在父窗口中为该消息实现一个处理程序，并检查它是否是被销毁的无模式对话框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T16:20:29.653

我起草了问题并准备发布，但后来我有了一个想法并最终解决了我自己的问题。因此，对于在检测到无模式对话框的关闭时遇到问题的其他任何人，这就是我所做的：

```
void Form1::MenuItemMethod()
{
    if(m_pDialog == NULL)
    {
        // Invoking the Dialog
        m_pDialog = new CChildDialog();
        BOOL ret = m_pDialog->Create(IDD_CHILDDIALOG, this);

        if (!ret)   //Create failed.
        {
            AfxMessageBox(_T("Error creating Dialog"));
        }    

        m_pDialog->ShowWindow(SW_SHOW);
    }
    else
    {
        // cannot check if visible at the beginning of method because
        // pointer could be NULL and will throw an exception

        if(m_pDialog->IsWindowVisible())
        {
            return;
        }

        m_pDialog->DestroyWindow();
        m_pDialog = NULL;
        MenuItemMethod();
    }
} 
```

再次单击表单的菜单项后，我刚刚检查了无模式对话框是否可见。如果它是可见的，不要做任何事情。如果不是，则销毁现有的不可见对话框，将指针设置为 NULL，然后再次递归调用该方法。由于指针现在为 NULL，它应该正常重新创建对话框，然后返回正常操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T07:35:25.283

你必须`PostNcDestroy`像这样删除内存

```
void CChildDialog ::PostNcDestroy() 
{   
    CDialog::PostNcDestroy();
    GetParent()->PostMessage(WM_WIN_CLOSED,0,0);
    delete this;
} 
```

并将用户定义的消息发送到您的窗口已关闭的父窗口。在父窗口中添加类似的消息处理`WM_WIN_CLOSED`程序

```
LRESULT CMainDialog::OnMyMethod(WPARAM wParam, LPARAM lParam)
{
    m_pDialog = NULL; 
    return 0;
} 
```

# android - “找不到要连接的 Android 设备”来自 Flash Pro CS6 的错误

> ID：11868860
> 
> 赞同：1
> 
> 时间：2012-08-08T16:20:32.987
> 
> 标签：android, flash, air, kindle-fire

我正在使用 Flash Pro CS6 为 Kindle Fire 开发应用程序。我选择了“发布后：在连接的 Android 设备上安装应用程序”。这会产生以下错误：

> 找不到要连接的 Android 设备。请确保您已连接手机，安装了正确的驱动程序，并且手机已启用 USB 设备调试。

关于配置我的环境以使其工作的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T03:39:49.210

这是解决方案 Adob​​e Official Help CS5, CS5.5。你会很有帮助的。

[错误可能找到安卓设备](http://helpx.adobe.com/flash/kb/error-could-find-android-device.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T15:37:15.373

Kindle 的设置可能有点不直观，但整个过程在[此 PDF](http://g-ecx.images-amazon.com/images/G/01/sdk/Connecting_your_Kindle_Fire_to_ADB.pdf)中进行了描述。

# linux - 在 Linux 下从 Mono-GTK# 应用程序访问“应用程序菜单”

> ID：11868861
> 
> 赞同：-2
> 
> 时间：2012-08-08T16:20:34.063
> 
> 标签：linux, mono, gtk#

如何在 Linux 下获取 Mono-GTK# 应用程序中的主“应用程序菜单”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T12:43:18.080

读取和解析`*.desktop`文件，通常在`/usr/share/applications`. （有关这些的信息可从[freedesktop.org Menu Specification](http://standards.freedesktop.org/menu-spec/latest/)获得。）

# c# - 如何从我的 SQL CLR 项目中引用非 SQL CLR 项目？

> ID：11868865
> 
> 赞同：2
> 
> 时间：2012-08-08T16:20:53.667
> 
> 标签：c#, sql, teamcity, sqlclr

我有两个项目的解决方案。第一个是基本类库项目，其中包含在多个服务端点 (DataContract.dll) 之间共享的类的定义。第二个是一个 SQL CLR 项目，它将使用共享程序集中定义的类。在我的本地机器上，我可以用本地 SQL Server 实例注册这个程序集，添加对程序集的引用，然后编译。但是，当我将此代码提交到我们的构建机器时，程序集未在服务器上注册。我可以在构建服务器上手动注册程序集，但这对加入项目并在第一次签出时构建损坏的新开发人员没有帮助。此外，我们的构建服务器为其构建的临时目录选择了一个随机名称，因此构建服务器的数据库实例上的引用可能已过时或丢失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-13T13:51:34.273

我以前也遇到过同样的问题，但不一定只是 SQLCLR。我发现最好的方法是[创建我自己的 NuGet 服务器](https://docs.nuget.org/create/hosting-your-own-nuget-feeds)。如果这看起来很复杂，或者您没有资源，那么我建议只为共享的库提供一个 unc 共享。您可以创建一个构建后脚本，在本地成功编译后将二进制文件复制到 unc 路径。

# h.264 - 取自 .mp4 的 H.264 解码器配置记录的格式

> ID：11868869
> 
> 赞同：2
> 
> 时间：2012-08-08T16:20:59.647
> 
> 标签：h.264, mp4, codec

我正在检查从 Android 设备录制的 .mp4 视频文件中包含的解码器配置记录。某些设备在解码器配置记录中写入了奇怪或不正确的参数。

这是来自 Galaxy Player 4.0 的示例，不正确：

```
DecoderConfigurationRecord: 010283f2ffe100086742000de90283f201000568ce010f20
       pictureParameterSetNALUnits : 68ce010f20
       AVCLevelIndication : 242
       AVCProfileIndication : 2
       sequenceParameterSetNALUnits : 6742000de90283f2
       lengthSizeMinusOne : 3
       configurationVersion : 1
       profile_compatibility : 131
       profile_idc : 103
       constraint_set : 16
       level_idc : 0 
```

`AVCLevelIndication == 242`是错误的，因为标准状态 51 是最高值。

`AVCProfileIndication`应该在 (66, 77, 88, 100, 120, ..)

`profile_compatibility`被称为`constraint_set`？`_flag`s 和 2 个最低有效位被保留并设置为等于 0

它应该是这样的：

```
DecoderConfigurationRecord: 0142000dffe100086742000de90283f201000568ce010f20
       pictureParameterSetNALUnits : 68ce010f20
       AVCLevelIndication : 13
       AVCProfileIndication : 66
       sequenceParameterSetNALUnits : 6742000de90283f2
       lengthSizeMinusOne : 3
       configurationVersion : 1
       profile_compatibility : 0
       profile_idc : 103
       constraint_set : 16
       level_idc : 0 
```

和怎么能从`AVCLevelIndication`和`AVCProfileIndication`推导`profile_idc`出来`level_idc`？

有没有办法通过将它们与参数进行比较来检查或可能修复错误的`SPS`参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T16:43:51.373

`level_idc`是`10 * level`。即，如果您使用的是 level `3.1`，它将是`31`.

`profile_idc`在附录 A 中规定`ISO/IEC 14496-10`。例如，基线配置文件是`66`，主配置文件是`77`，扩展配置文件是`88`。

此外，您可以分别在第 7.3.2.1 节和第 7.3.2.2 节中查看 SPS RBSP 和 PPS RBSP 的语法。注意`ue(x)`并`se(x)`指出无符号指数哥伦布编码和有符号指数哥伦布编码。

编辑：我很抱歉。`AVCProfileIndication`和`AVCLevelIndication`应该与和`profile_idc`相同`level_idc`

# c# - 实现 get-set-property 时的 C# SIGSEGV

> ID：11868872
> 
> 赞同：0
> 
> 时间：2012-08-08T16:21:22.130
> 
> 标签：c#, mono, segmentation-fault

当我尝试使用主体实现 get-set-property 并使用该集合时，它总是以 SIGSEGV 退出 - 分段错误。我在 Mac OS X Mountain Lion (10.8) 下运行 Mono 2.10.9 + MonoDevelop 3.0.3.5。这是我可以使用的最少代码量：

```
public class MainClass {
    public static int Main(string[] args) {
        Foo foo = new Foo();
        foo.Bar = 42;        // Never makes it past this line
        return 0;
    }
}

public class Foo {
    public int Bar {
        get { return Bar; }
        set { Bar = value; }
    }
} 
```

我做错了什么，还是这是一个 Mono 错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:24:53.767

尝试将您的代码更改为：

```
public class Foo {
    public int Bar { get; set; }
} 
```

或这个：

```
public class Foo {
    private int _bar;
    public int Bar {
       get { return _bar; }
       set { _bar = value; }
    }
} 
```

你没有后备商店。您要么需要添加一个，要么使用自动属性。编写代码的方式是在访问这些属性时递归调用 get/set。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-29T10:43:54.743

您可以使用自动实现的属性：

```
public int Bar { get; set; } 
```

或者您可以使用以下字段：

```
private int _bar;
public int Bar 
{ 
    get { return value; } 
    set { _bar = value; } 
} 
```

# html - 位置：固定；在其下方添加少量空白

> ID：11868874
> 
> 赞同：0
> 
> 时间：2012-08-08T16:21:31.070
> 
> 标签：html, css, styles, position, fixed

[http://tylerh.info](http://tylerh.info)，我有一个固定的导航栏。但是每当我使用属性“位置：固定；” 它在它下面留下了少量空间，导致我的标题不与它接壤。但是，这不会发生在取出属性的情况下。

谢谢！

CSS：

```
.qmmc .qmdivider{
display:block;
font-size:1px;
border-width:0px;
border-style:solid;
position:relative;
z-index:1;
}

.qmmc .qmdividery{
float:left;
width:0px;
}

.qmmc .qmtitle{
display:block;
cursor:default;
white-space:nowrap;
position:relative;
z-index:1;
}

.qmclear {
font-size:1px;
height:0px;
width:0px;
clear:left;
line-height:0px;
display:block;
float:none !important;
}

.qmmc {
position:relative;
z-index:10;}

.qmmc a, .qmmc li {
float:left;
display:block;
white-space:nowrap;
position:relative;
z-index:1;
}

.qmmc div a, .qmmc ul a, .qmmc ul li {
float:none;
}

.qmsh div a {
float:left;}.qmmc div{visibility:hidden;position:absolute;}.qmmc li {z-index:auto;}.qmmc ul {left:-10000px;position:absolute;z-index:10;}.qmmc, .qmmc ul {list-style:none;padding:0px;margin:0px;}.qmmc li a {float:none}.qmmc li:hover>ul{left:auto;}#qm0 ul {top:100%;}#qm0 ul li:hover>ul{top:0px;left:100%;}

    #qm0    
    {   
                background-image: linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
        background-image: -o-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
        background-image: -moz-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
        background-image: -webkit-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
        background-image: -ms-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
        padding-bottom: 4.5px;
        position:fixed;
        border-color:#A2BFE9;
        margin-top: -4.7em;
        position:fixed;
        width: 100%;
        height: 50px;
        border-bottom: 1px solid #00A3EF;
    }

    #qm0 a  
    {   
        text-align: center;
        padding-top: 18px;
        padding-bottom: 18px;
        padding-left: 18px;
        padding-right: 18px;
        color:#FFFFFF;
        font-family:Karla;
        font-size:100%;
        text-decoration:none;

    }

    #qm0 a:hover    
    {   
           background-image: -moz-linear-gradient(bottom, #5465FF 0%, #00A3EF 100%);
   background-image: -ms-linear-gradient(bottom, #5465FF 0%, #00A3EF 100%);
   background-image: -o-linear-gradient(bottom, #5465FF 0%, #00A3EF 100%);
   background-image: -webkit-linear-gradient(bottom, #5465FF 0%, #00A3EF 100%);
   background-image: linear-gradient(bottom, #5465FF 0%, #00A3EF 100%);
   border-bottom-color:#000000;
   border-bottom-style:solid;
    }

    body #qm0 .qmactive, body #qm0 .qmactive:hover  
    {   
        background-color:#808080;
        text-decoration:underline;
        font-size: 80%;
    }

    #qm0 div, #qm0 ul   
    {   padding-top:4px;
        padding-bottom:4px;
        margin:0px 0px 0px -1px;
        background-color:#808080;
        border-width:4px 1px 1px;
        border-style:solid;
        border-color:#285DA8;
    }

    #qm0 div a, #qm0 ul a   
    {   
        padding:2px 40px 2px 5px;
        border-width:0px;
        border-style:none;
    }

        #qm0 div a:hover, #qm0 ul a:hover   
        <ul id="qm0" class="qmmc">

div#header {
    width: 100%;
    margin-bottom: 20px;
    padding-top: 1px;
    /*gradients */
    background-image: -ms-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: -moz-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: -o-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: -webkit-gradient(radial, center center, 0, center center, 506, color-stop(0, #006AD4), color-stop(1, #2500A1));
    background-image: -webkit-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: radial-gradient(circle farthest-corner at center, #006AD4 0%, #2500A1 100%);
    /*end gradients*/
    border-bottom: solid 2px #808080;
    padding-top:60px;
} 
```

html:

```
<li><a class="qmparent" href="/">Home</a></li>
<li><a class="qmparent" href="/?page_id=7">Ask a Question</a></li>

<li><a class="qmparent" href="javascript:void(0)">Menu3</a>

    <ul>
    <li><a href="javascript:void(0)">Placeholder1</a> </li>

    <li><a href="javascript:void(0)">Placeholder1</a></li>

    <li><a href="javascript:void(0)">Placeholder2</a></li>
    <li><a href="javascript:void(0)">Placeholder3</a></li>
    <li><a href="javascript:void(0)">Placeholder4</a></li>
    <li><a href="javascript:void(0)">Placeholder5</a></li>
    <li><a href="javascript:void(0)">Placeholder6</a></li>
    </ul></li>

<li><a class="qmparent" href="javascript:void(0)">Categories</a>

    <ul>
    <?php wp_list_categories('title_li=&orderby=name&use_desc_for_title=1&hierarchical=1') ?>

    </ul></li>{ 
        text-decoration:underline;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:35:41.390

您网站上的 css 和 html 有一些问题。

1.  `<h6>`在您的 html 顶部有一个空白。我看不出这有什么用。这也是你的标题被推下的原因。尝试删除它。
2.  您的固定菜单顶部有边距。这在固定定位的元素上是不可能的。删除这个。还要在此处设置 top: 0 以强制菜单到位。（也不允许使用 4.5px 的填充。屏幕上不存在将像素减半的事情）
3.  给标题一个 50px 的 padding-top，与菜单的高度相同。这使它直接安装在manu下方。

那应该可以解决您的问题。无论如何，在 Chrome 代码检查器中为我工作。

也许您可以尝试在 W3C 网站上验证您的 css 和 html，因为它可能存在更多问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:30:52.217

用（添加）替换您的`div#header`条目`padding-top:60px`：

```
div#header {
    width: 100%;
    margin-bottom: 20px;
    padding-top: 1px;
    /*gradients */
    background-image: -ms-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: -moz-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: -o-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: -webkit-gradient(radial, center center, 0, center center, 506, color-stop(0, #006AD4), color-stop(1, #2500A1));
    background-image: -webkit-radial-gradient(center, circle farthest-corner, #006AD4 0%, #2500A1 100%);
    background-image: radial-gradient(circle farthest-corner at center, #006AD4 0%, #2500A1 100%);
    /*end gradients*/
    border-bottom: solid 2px #808080;
    padding-top:60px;
} 
```

以及您的`#qm0`条目（已删除`margin-top:-4.7em`）：

```
#qm0 {    
    background-image: linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
    background-image: -o-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
    background-image: -moz-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
    background-image: -webkit-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
    background-image: -ms-linear-gradient(bottom, #363636 19%, #1A1A1A 53%, #000000 80%);
    padding-bottom: 4.5px;
    position:fixed;
    border-color:#A2BFE9;
    position:fixed;
    width: 100%;
    height: 50px;
    border-bottom: 1px solid #00A3EF;
} 
```

并`<h6></h6>`从上面的 HTML中删除`<ul id="qm0" class="qmmc">`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-05T06:51:51.773

我有同样的问题。应用于`position:fixed`元素后，以某种方式将边距`8px`应用于父元素，因此我将父元素的样式设置为`margin:0`，并且已解决。（Chrome）

这是示例

```
<body style="margin:0"><!-- the parent element -->
    <div style="position:fixed:background-color:grey;width:100%">
        Hello World
    </div>
</body> 
```

`margin:8px`浏览器使用时的解释`position:fixed`

![](../Images/9711f76a5c0f0b32e093ffdc1dceaa17.png)

# ruby-on-rails - 表单验证 - 如果某些内容为假，则需要此验证

> ID：11868877
> 
> 赞同：0
> 
> 时间：2012-08-08T16:21:42.973
> 
> 标签：ruby-on-rails, validation, models

在我对模型的表单验证中，我想说如果名为的列的参数`:virtual`为 false，则该`:location`字段应验证`:presence => true`.

我目前的代码是：

`validates :location, if :virtual => false, :presence => true`

但这给了我一个语法错误。格式化这个的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:34:32.637

就像是：

```
attr_accessor :virtual  # sets up a "virtual attribute" called "virtual" to which you can read/write a value
                        # this step isn't necessary if you already have an attribute on the model called "virtual"

validates :location, :presence => true, :unless => :virtual? 
```

的使用`virtual?`应该检查属性`virtual`是真还是假。使用意味着仅在is （或被考虑的值）`unless`时才执行此验证。`virtual``false``false`

有关虚拟属性和验证的更多详细信息：[Rails：在验证中使用与模型无关的表单字段](https://stackoverflow.com/questions/3327265/rails-using-form-fields-that-are-unassociated-with-a-model-in-validations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:49:39.577

```
validates :location, presence: true, if: Proc.new { |p| p.virtual == false } 
```

# python - 在多维数组上使用 numpy.take？

> ID：11868878
> 
> 赞同：1
> 
> 时间：2012-08-08T16:21:43.737
> 
> 标签：python, numpy, scipy

是否可以像花哨的索引一样使用接管多个轴？

多维数组相当大，所以我希望有可能获得加速。

例如：

```
import numpy as np
x = np.random.rand(20,20,20,20)
m = np.where(x>0.5)
m = (m[0],m[1],m[2])
print x[m].shape 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T20:20:44.970

你的代码：

```
m = np.where(x>0.5)
m = (m[0],m[1],m[2])
result = x[m] 
```

可以编写以避免 np.where 通过使用重复：

```
m = np.sum(x>0.5,-1)
result = x.reshape(-1,x.shape[-1]).repeat(w.ravel(), 0) 
```

这似乎快了大约 4 倍。但是我想知道你是否不是故意要

```
m = np.any(x>0.5,-1)
result = x[m,:] 
```

哪个不会创建重复项（尽管此处仍需要重塑）？

# linux - 清理 Maven 存储库 - 删除除每个文件夹 x 最新的所有文件

> ID：11868879
> 
> 赞同：1
> 
> 时间：2012-08-08T16:21:45.033
> 
> 标签：linux, maven

我想清理我的本地 maven 存储库，但保留每个工件的最后 y 个快照版本。

我找到[了这个脚本](https://github.com/jettro/small-scripts/blob/master/groovy/CleanDir.groovy)，但它按日期工作。我想我可以对其进行调整以使其对文件进行计数，但我想知道是否可以使用 linux find 命令直接完成此类操作。任何想法？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-08T16:31:01.753

如果您有内部存储库管理器，则清除本地存储库并让它随着时间的推移再次填充可能会更简单。

如果您没有存储库管理器，请获得一个，即使它只是为您自己而设。我使用[Nexus](http://www.sonatype.org/nexus/)，但还有其他选择。Nexus 让您决定保留多少快照和/或保留多长时间。最后，使用 Nexus 管理工件的生命周期将比尝试设计复杂的脚本更容易。

# c# - 使用属性生成自定义设置器

> ID：11868881
> 
> 赞同：7
> 
> 时间：2012-08-08T16:21:58.107
> 
> 标签：c#, .net, attributes, boo, automatic-properties

在我使用对象数据库保留其实例的类中，我一直不得不这样做：

```
private string _name;
public string Name
    {
    get { return this._name; }
    set { _name = value; this.Save(); }
    } 
```

而我宁愿输入这个：

```
[PersistedProperty(Name)]
private string _name; 
```

其中 PersistedProperty 属性生成 Getter 和 Setter 就像默认的 [Property()] 属性一样，除了我想在生成的 Setter 中添加一行代码。

有没有办法可以创建一个这样做的属性？希望，它适用于 Intellisense。

默认的 [Property()] 属性是如何发挥作用的？如果我看到代码，我可以移植它......

注意：我实际上是在 Boo 中执行此操作的，但我想我会提供 c# 代码，因为更多人可能愿意回答这个问题，但是，如果有 Boo 特定的解决方案，我会全神贯注！

**更新：**

我的目标只是减少打字和混乱。事实证明，最简单的方法是使用基于我的类中的标记生成部分类的脚本。

从标记自动生成源代码（与部分类一起）很容易，实际上看起来是一种非常有前途的方法来解决我们通常尝试用继承和泛型类型解决的一些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:27:28.523

这需要[面向方面的编程](http://en.wikipedia.org/wiki/Aspect-oriented_programming)。虽然 .NET 不直接支持，但可以通过第三方工具完成，例如[PostSharp](http://www.sharpcrafters.com/)。

然而，为了使智能感知工作，这必须在库中完成，因为（最终）编译的代码将展开到完整的属性 getter/setter 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:48:33.167

使用 IMO 属性不容易实现。也许您可以使用另一种方法，例如扩展方法：

```
// Extension method that allows updating a property
// and calling .Save() in a single line of code.
public static class ISaveableExtensions
{
    public static void UpdateAndSave<T>(
        this ISaveable instance,
        Expression<Func<T>> propertyExpression, T newValue)
    {
        // Gets the property name
        string propertyName = ((MemberExpression)propertyExpression.Body).Member.Name;

        // Updates its value
        PropertyInfo prop = instance.GetType().GetProperty(propertyName);
        prop.SetValue(instance, newValue, null);

        // Now call Save
        instance.Save();
    }
}
...
// Some interface that implements the Save method
public interface ISaveable
{
    void Save();
}
...
// Test class
public class Foo : ISaveable
{
    public string Property { get; set; }

    public void Save()
    {
        // Some stuff here
        Console.WriteLine("Saving");
    }

    public override string ToString()
    {
        return this.Property;
    }
}
...
public class Program
{
    private static void Main(string[] args)
    {
        Foo d = new Foo();

        // Updates the property with a new value, and automatically call Save
        d.UpdateAndSave(() => d.Property, "newValue");

        Console.WriteLine(d);
        Console.ReadKey();
    }
} 
```

它是类型安全的、自动完成友好的，但它需要的代码不仅仅是 . `Save()`在所有的二传手中，所以不确定我是否会实际使用它......

# c++ - 检查 LLVM 通道中的后端

> ID：11868883
> 
> 赞同：0
> 
> 时间：2012-08-08T16:22:16.640
> 
> 标签：c++, c, compiler-construction, llvm, clang

我正在编写一个修改中间代码的 LLVM 通行证。我想检查一个基本块的每个终止指令，看看它是否有后沿。为了更清楚，在下面的例子中，我想看看是否到达标签`land.lhs.true`或`if.end`，需要向后跳转。

```
entry:
  %pa = alloca %struct.Vertex, align 4
  .........
  br i1 %cmp, label %land.lhs.true, label %if.end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T13:45:34.277

不确定您所说的后沿或后跳是什么意思，因为 LLVM 中间代码在内存中没有明确的布局。您应该认为每个函数中的基本块没有明确的顺序，也没有明确分配给内存地址。这在发出汇编代码时由后端处理。

# shell - 基于参数的 Unix Shell for 循环

> ID：11868885
> 
> 赞同：1
> 
> 时间：2012-08-08T16:22:27.333
> 
> 标签：shell, unix, iterator

*   操作系统 = Ubuntu
*   文件名 = generate_zips.sh

我正在尝试创建一堆文件（基于参数的数字）。但是它不起作用。

```
#!/bin/sh
LIMIT=$1
for ((a=1; a <= LIMIT; a++)) 
do
    mkdir zips
    cd zips
    touch $a
done 
```

但它返回这个

```
esauer@ubuntu:~/repo/filecheck/src/plugins/archive$ ./generate_zips.sh 10
./generate_zips.sh: 4: ./generate_zips.sh: Syntax error: Bad for loop variable 
```

我无法弄清楚什么是错的......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:26:32.570

你的 shebang 是错误的——你正在使用一个`bash`特性（双括号中的“C 风格”for 循环），但你指定了`/bin/sh`. 将其更改为`/bin/bash`.

当然，您也可以更改 for 循环，使其不使用`bash`'s 的特殊功能（请参阅其他答案）。这有点更便携，因为并非所有类 Unix 系统都有`/bin/bash`（但几乎所有系统都有`/bin/sh`）。然而，`bash`它也相当广泛（例如，它是大多数 Linux 发行版中的标准 shell）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:24:59.847

尝试：

```
LIMIT=$1

for a in $(seq 1 $LIMIT)
do
  mkdir -p zips
  touch zips/$a
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:28:26.353

我可能会这样做......

```
#!/bin/sh
mkdir zips
cd zips
a=1; while [ $a -le $1 ]; do
  touch $a
  a=$(($a + 1))
done 
```

有一些特定于 bash 的方法更短一些，但这适用于任何 Posix shell。

# javascript - Instagram API 未加载所有图像

> ID：11868891
> 
> 赞同：1
> 
> 时间：2012-08-08T16:22:58.717
> 
> 标签：javascript, api, for-loop, instagram

我正在尝试使用 Instagram API 来提取所有带有特定标签“watchsuburbia”的图片

它的工作，放不完全，它只拉 18 张照片，昨晚它只拉 17 ......不管我如何设置我的循环。目前应该拉出近 40 张照片（当前循环设置为仅 25 张）。

[您可以在http://himynameismarvin.com/instahelp](http://himynameismarvin.com/instahelp)看到我正在尝试的内容

这是函数（我删除了这篇文章的 API 信息，但已将其包含在我的版本中并在我的版本中工作）：

```
$(function() {
        $.ajax({
            type:"GET",
            dataType:"jsonp",
            cache:false,
            url:"https://api.instagram.com/v1/tags/watchsuburbia/media/recent?client_id=[CLIENTID]&access_token=[ACCESSTOKEN]",
            success:function(data){
                for(var i=0; i<25; i++){
                    $("#pics").append("<div class='instaframe'><a target='_blank' href='"+data.data[i].link+"'><img src='"+data.data[i].images.standard_resolution.url+"' /></a></div>");
                }
            }

        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:18:18.350

该[文档](http://instagram.com/developer/endpoints/)说您可以传递一个`count`参数：

> 在存在分页的视图上，我们还支持“count”参数。只需将其设置为您想要接收的项目数。请注意，对于大多数应用程序来说，默认值应该没问题 - 但如果您决定增加此数字，则在每个端点上定义一个最大值。

我在您的测试页面中没有看到它，所以我尝试了它。我可以始终如一地获得 32 个元素，但仅此而已。我想这是 Instagram 方面的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T08:26:08.727

使用[**Instafetch**](https://github.com/d4nyll/instafetch/)！

Instagram API 对其返回的结果数量施加了一个无声的、未记录的限制。即使你传入一个`count`高于`33`，它也最多只会返回 33 个结果。

Instafetch 以进行更多 API 调用为代价消除了此限制。目前，如果您按用户查询，它可以工作，您也可以按标签过滤。

[免责声明：由我撰写]

# perl - $# 在 perl 中接受什么作为输入？

> ID：11868892
> 
> 赞同：3
> 
> 时间：2012-08-08T16:22:59.917
> 
> 标签：perl

我有这个问题有一段时间了。

假设我有一个简单的数组，

```
 my @arr;
    foreach my $i (0..$#arr){
        print "\$arr[$i] = '$arr[$i]'\n";
    } 
```

$#arr 只返回数组的最后一个索引

但是，如果我想将它用于更复杂的事情会发生什么？：

```
 foreach my $i (0..$#@{$someHash{$}[$b]{$c}}); 
```

当然，我可以把它写成

```
 foreach my $i (0..(scalar(@{$someHash{$}[$b]{$c}})-1)); 
```

但这只会使代码更加复杂。

所以我的问题是，除了简单的数组（引用、从函数调用返回的列表等）之外，$# 是否可以用于其他任何东西，如果可以，如何使用？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T16:26:10.290

是的，你想要：

```
for my $i (0..$#{$some_hash{$a}[$b]{$c}}) { ... } 
```

不过，如果可能的话，我通常更喜欢

```
for my $value (@{ $some_hash{$a}[$b]{$c} }) { ... } 
```

索引值很少像存储在数组中的值那样有用。通常，如果我需要两者，我会添加一个计数器：

```
my $i = 0;
for my $value (@{ $some_hash{$a}[$b]{$c} }) { ... } continue { $i++ } 
```

为了清楚起见，我还将在循环中预先分配复数变量：

```
my $i = 0;
my $widget_list = $some_hash{$a}[$b]{$c};
for my $value (@{ $widget_list }) { ... } continue { $i++ } 
```

仅仅因为你可以在 Perl 的一行中做一些事情并不一定意味着你应该这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:30:14.060

是的，可以这样做：

```
sub foo {
    return { 'bar' => { 'array' => [ 'qux', [qw/ has three elements /] ] } };
}

print $#{ foo->{'bar'}->{'array'}->[1] };    # 2 
```

在写这样的代码时，我的思考过程是：用语法获取数组，`@{}`然后`@`用`$#`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T18:54:20.407

如果它是

```
$#array 
```

对于一个数组，它是

```
$#{ $array_ref } 
```

供参考。当然，它可以是任何返回数组引用的表达式，因此您需要以下内容：

```
$#{ $someHash{$}[$b]{$c} } 
```

请参阅[迷你教程：取消引用语法](http://www.perlmonks.org/?node_id=977408)

# properties - 具有只读逻辑属性的 Groovy 类？

> ID：11868893
> 
> 赞同：0
> 
> 时间：2012-08-08T16:23:12.753
> 
> 标签：properties, groovy, javabeans, readonly

我有以下课程，我想在其中使用该`isDefault()`方法。但是，当我尝试编译它时，我收到一个错误，即没有`setDefault()`方法。我意识到我可以添加一个`setDefault()`方法并将其设为私有，但似乎应该有一个比这更优雅的解决方案。

有任何想法吗？

```
class LdapConfig {

    public static final String DEFAULT_URL = 'ldap://localhost:389'

    String url = DEFAULT_URL

    public boolean isDefault() {
        if (url == DEFAULT_URL) {
            return true
        } else {
            return false
        }
    }
} 
```

# mysql - 带有内连接、子选择和限制的 SQL 选择

> ID：11868897
> 
> 赞同：2
> 
> 时间：2012-08-08T16:23:29.323
> 
> 标签：mysql, sql, left-join, limit, subquery

我已经处理这个 SQL 问题大约 2 天了，我怀疑我非常接近解决这个问题，但似乎无法找到一个完全有效的解决方案。

我正在尝试做的是在两个名为的表上进行选择性连接，`application_info`这些表`application_status`用于存储有关开放获取期刊文章资助请求的信息。

`application_info``Application_ID`包含有关申请人的一般信息，并使用称为关键字段的自动索引字段。`application_status`用于跟踪有关申请状态（已收到、正在审核、已资助、已拒绝、已撤回等）以及期刊文章状态（已提交、已接受、重新提交、已发表或已拒绝）的持续信息，并包含两者与状态文本和状态日期字段一起调用的`Application_ID`字段和自动索引字段。`Status_ID`

因为我们想要保留应用程序、文章和资金状态更改的运行日志，我们不想`application_status`用更新的值覆盖现有行，而是只想显示最近的状态值。因为一个应用程序最终会有不止一次的状态变化，这就需要对应用程序数据的状态数据的内部连接应用某种限制，以便每个应用程序 ID 只返回一行。

这是我在当前引发错误的查询中尝试执行的操作的示例：

```
-- simplified example
SELECT 
application_info.*,
artstatus.Status_ID AS Article_Status_ID,
artstatus.Application_ID AS Article_Application_ID,
artstatus.Status_State_Date AS Article_Status_State_Date,
artstatus.Status_State_Text AS Article_Status_State_Text
FROM application_info
LEFT JOIN (
    SELECT 
    Status_ID,
    Application_ID,
    Status_State_Text,
    Status_State_Date,
    Status_State_InitiatedBy,
    Status_State_ChangebBy,
    Status_State_Notes
    FROM application_status 
    WHERE Status_State_Text LIKE 'Article Status%'
    AND Application_ID = application_info.Application_ID -- how to pass the current application_info.Application_ID from the ON clause to here?
    -- and Application_ID = 29 -- this would be an option for specific IDs, but not an option for getting a complete list of application IDs with status
    -- GROUP BY Application_ID -- reduces the sub query to 1 row (Yeah!) but returns the first row encountered before the ORDER BY comes into play
    ORDER BY Status_ID DESC
    -- a GROUP BY after the ORDER BY might resolve the issue if we could do a sort first
    LIMIT 1 -- only want to get the first (most recent) row, only works correctly if passing an Application_ID
) AS artstatus
ON application_info.Application_ID = artstatus.Application_ID
-- WHERE application_info.Application_ID = 29 -- need to get all IDs with statu values as well as for specific ID requests
; 
```

消除`AND Application_ID = application_info.Application_ID`子查询的 and 部分以及`LIMIT`导致 select 工作的原因，但为给定应用程序 ID 的每个状态返回一行。我尝试过使用`MIN`/`MAX`运算符，但注意到它们`application_status`在工作时会从表中返回不可预测的行。

我也尝试在`ON`连接部分进行子选择，但不知道如何实现，因为最终结果总是需要返回一个`Application_ID`（两者都`Application_ID`可以`Status_ID`返回和使用吗？）。

关于如何让它按我的意图工作的任何提示？这甚至可以做到吗？

进一步编辑：下面的工作查询。关键是将连接中的子查询更深一层，然后只返回一个状态 ID。

```
-- simplified example (now working)
SELECT 
application_info.*,
artstatus.Status_ID AS Article_Status_ID,
artstatus.Application_ID AS Article_Application_ID,
artstatus.Status_State_Date AS Article_Status_State_Date,
artstatus.Status_State_Text AS Article_Status_State_Text
FROM application_info
LEFT JOIN (
    SELECT 
    Status_ID,
    Application_ID,
    Status_State_Text,
    Status_State_Date,
    Status_State_InitiatedBy,
    Status_State_ChangebBy,
    Status_State_Notes
    FROM application_status AS artstatus_int
    WHERE 
    -- sub query moved one level deeper so current join Application_ID can be passed
    -- order by and limit can now be used
    Status_ID = (
        SELECT status_ID FROM application_status WHERE Application_ID = artstatus_int.Application_ID
        AND status_State_Text LIKE 'Article Status%'
        ORDER BY Status_ID DESC
        LIMIT 1
    )
    ORDER BY Application_ID, Status_ID DESC
    -- no need for GROUP BY or LIMIT here because only one row is returned per Application_ID
) AS artstatus
ON application_info.Application_ID = artstatus.Application_ID
-- WHERE application_info.Application_ID = 29 -- works for specific application ID as well

-- more LEFT JOINS follow
; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:31:08.907

在 from 子句中不能有相关的子查询。

试试这个想法：

```
select <whatever>
from (select a.*,
             (select max(status_id) as maxstatusid
              from application_status aps
              where aps.application_id = a.application_id
             ) as maxstatusid
      from application
     ) left outer join
     application_status aps
     on aps.status_id = a.maxstatusid
. . . 
```

即把关联的子查询放在select子句中，获取最新的状态。然后将其加入状态表以获取其他信息。并且，使用其他详细信息完成查询。

您似乎很擅长您的 SQL 技能，因此似乎没有必要为您重写整个查询。

# javascript - 如何刷新存储和快照的 jquery 选择器变量

> ID：11868899
> 
> 赞同：33
> 
> 时间：2012-08-08T16:23:30.023
> 
> 标签：javascript, jquery, variables, dom, jquery-selectors

我昨天遇到了一个分配给变量的 jquery-selector 问题，这让我发疯。

这是一个带有测试用例的jsfiddle：

*   将 .elem 分配给我的 obj var
*   将两个长度都记录到控制台。结果 => 4
*   从 DOM 中移除 #3
*   将obj记录到控制台=>删除的#3仍然存在，长度仍然是4。我发现jquery查询是快照的？到变量，不能？不会？被更新
*   将 .elem 记录到控制台.. 是的 Result => 3 并且 #3 消失了
*   现在我用 300 的新宽度更新 .elem
*   记录 obj & obj.width 给了我 300 .. 所以快照已经更新了？有趣的是 4 个 div 中的 3 个具有新的宽度，但删除的 #3 没有...

另一个测试：将 li 元素添加到 domtree 并记录 obj 和 .elem。.elem 确实有新的 li 而 obj 没有，因为它仍然是旧快照

[http://jsfiddle.net/CBDUK/1/](http://jsfiddle.net/CBDUK/1/)

没有办法用新内容更新这个 obj 吗？我不想创建一个新的 obj，因为在我的应用程序中有很多信息保存在该对象中，我不想破坏......

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-08T16:26:41.180

是的，这是一个快照。此外，从页面 DOM 树中删除一个元素并不会神奇地消除对该元素的所有引用。

您可以像这样刷新它：

```
var a = $(".elem");

a = $(a.selector); 
```

迷你插件：

```
$.fn.refresh = function() {
    return $(this.selector);
};

var a = $(".elem");

a = a.refresh(); 
```

不过，这个简单的解决方案不适用于复杂的遍历。您将不得不为该`.selector`属性创建一个解析器以刷新这些属性的快照。

格式如下：

```
$("body").find("div").next(".sibling").prevAll().siblings().selector
//"body div.next(.sibling).prevAll().siblings()" 
```

就地迷你插件：

```
$.fn.refresh = function() {
    var elems = $(this.selector);
    this.splice(0, this.length);
    this.push.apply( this, elems );
    return this;
};

var a = $(".elem");
a.refresh() //No assignment necessary 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T10:16:06.337

我也喜欢@Esailija 解决方案，但似乎 this.selector 有一些过滤器错误。所以我修改了我的需要，也许它会对某人有用

> 这是针对 jQuery 1.7.2 没有在更高版本的过滤快照上测试刷新

```
$.fn.refresh = function() { // refresh seletor
    var m = this.selector.match(/\.filter\([.\S+\d?(\,\s2)]*\)/); // catch filter string
    var elems = null;
    if (m != null) { // if no filter, then do the evarage workflow
        var filter = m[0].match(/\([.\S+\d?(\,\s2)]*\)/)[0].replace(/[\(\)']+/g,'');
        this.selector = this.selector.replace(m[0],''); // remove filter from selector
        elems = $(this.selector).filter(filter); // enable filter for it
    } else {
        elems = $(this.selector);
    }
    this.splice(0, this.length);
    this.push.apply( this, elems );
    return this;
}; 
```

代码不是那么漂亮，但它适用于我的过滤选择器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-20T14:30:31.517

**干净和通用的解决方案与 jQuery 3.4.1 一起正常工作：**

我的解决方案是执行以下操作：

1.  在 jQuery 对象初始化时拦截选择器，同时使用继承透明地维护所有其他 jQuery 功能
2.  构建使用我们在初始化期间添加的新“*选择器”属性的刷新插件*

**定义：**

```
$ = (function (originalJQuery) 
{
    return (function () 
    {
        var newJQuery = originalJQuery.apply(this, arguments);
        newJQuery.selector = arguments.length > 0 ? arguments[0] : null;
        return newJQuery;
    });
})($);

$.fn = $.prototype = jQuery.fn;

$.fn.refresh = function () 
{
    if (this.selector != null && (typeof this.selector === 'string' || this.selector instanceof String))
    {
        var elems = $(this.selector);
        this.splice(0, this.length);
        this.push.apply(this, elems);
    }
    return this;
}; 
```

**用法：**

```
var myAnchors = $('p > a');
//Manipulate your DOM and make changes to be captured by the refresh plugin....
myAnchors.refresh();
//Now, myAnchors variable will hold a fresh snapshot 
```

**注意：** 作为优化，对象选择器不需要刷新，因为它们本质上是通过引用传递的，因此，在刷新插件中，我们仅在选择器是字符串选择器而不是对象选择器时才刷新，以便澄清，考虑以下代码：

```
// Define a plain object
var foo = { foo: "bar", hello: "world" };

// Pass it to the jQuery function
var $foo = $( foo );

// Test accessing property values
var test1 = $foo.prop( "foo" ); // bar

// Change the original object
foo.foo = "koko";

// Test updated property value
var test2 = $foo.prop( "foo" ); // koko 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-14T11:50:50.390

Jquery .selector 已弃用，最好在分配时将带有选择器值的字符串记住到某个变量

```
function someModule($selector, selectorText) {
   var $moduleSelector = $selector;
   var moduleSelectorText = selectorText;

   var onSelectorRefresh = function() {
      $moduleSelector = $(moduleSelectorText);
   }
} 
```

[https://api.jquery.com/selector/](https://api.jquery.com/selector/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-15T13:49:18.140

如果你使用`remove()`它只会删除 DOM 的一部分，而不是所有的子元素或相关的，相反，如果你`empty()`在元素上使用，问题就消失了。

例如：

```
 $('#parent .child).find('#foo').empty(); 
```

也许它对某人有用！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-01T14:48:32.913

您还可以在函数中返回 JQuery 选择器，并将此函数保存到变量中。您的代码看起来会有些不同，但它可以工作。每次执行该函数时，您的 jquery 选择器都会再次搜索 DOM。

在这个例子中，我使用了一个不带括号的箭头函数，它将**返回**箭头旁边的任何内容。在这种情况下，它将返回 JQuery 集合。

```
const $mySelector = () => $('.selector');
console.log($mySelector().last().text());
$('.parent').append('<li class="selector">4</li>')

console.log($mySelector().last().text()); //RETURNS 4 not 3
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<ul class="parent">
    <li class="selector">1</li>
    <li class="selector">2</li>
    <li class="selector">3</li>
</ul>
```

# css - 包含图像的 div 底部的空间

> ID：11868905
> 
> 赞同：2
> 
> 时间：2012-08-08T16:23:44.390
> 
> 标签：css

对于这个小提琴，为什么底部有一个空格`div#imageDiv`？

[JSFiddle](http://jsfiddle.net/7Knyx/1/)

```
<div>
<div>
<div>
    <img src="http://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/SIPI_Jelly_Beans_4.1.07.tiff/lossy-page1-256px-SIPI_Jelly_Beans_4.1.07.tiff.jpg" />      
</div>
</div>
</div>
<div id="text"><div id="inner">text goes here</div></div>        

html {
  line-height: 1.5em;
}
#text {
  background-color: grey;
  margin-top:-7px;
} 
```

​</p>

​</p>

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-08T16:28:45.813

将您的图像设置为`img { display: block; }`. 请下次在此处添加您的代码以防止链接失效，并让我们在这里轻松查看您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:25:44.587

给你的图像一个底部垂直对齐，空间就消失了。

**[jsFiddle 示例](http://jsfiddle.net/j08691/7Knyx/10/)**

```
img {
    vertical-align:bottom;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-08T16:37:16.187

您还可以使用 margin-top 属性来实现这一点

[http://jsfiddle.net/meetravi/7Knyx/14/](http://jsfiddle.net/meetravi/7Knyx/14/)

PS如果您打算支持相对较旧的浏览器，避免css中的负值总是很好

# c# - Binding.TargetUpdated 在初始表单加载后未触发

> ID：11868906
> 
> 赞同：0
> 
> 时间：2012-08-08T16:23:50.947
> 
> 标签：c#, wpf, xaml

下面我有一个包含两个文本框的控件模板。控件模板用作网格的单元格显示模板，datacontext 是我的模型对象（实现 INotifyPropertyChanged）的绑定列表。第二个文本框最初是折叠的。但是，当“要价”和“出价”价格更新发生时，我想通过切换可见性约 1 秒钟来“闪烁”此文本框。

我看到的问题是，在表单的初始加载时，我确实看到了第二个文本框闪烁，但在那之后......什么都没有。有趣的是，如果我单击单元格网格（激活编辑模板）然后单击单元格外（恢复到显示模板，即下面显示的模板），第二个文本框然后闪烁。

任何人都可以看到为什么在 AskPrice 或 BidPrice 更改时第二个文本框不会“闪烁”的问题吗？我确实看到转换器正在按预期调用，但更新没有触发情节提要动画。

```
<Style x:Key="PriceSpreadAlertStyle" TargetType="TextBlock">
    <Setter Property="Visibility" Value="Collapsed" />
    <Setter Property="Background" Value="Red" />
    <Style.Triggers>
        <EventTrigger RoutedEvent="Binding.TargetUpdated" >
            <EventTrigger.Actions>
                <BeginStoryboard>
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetProperty="(UIElement.Visibility)">
                            <DiscreteObjectKeyFrame KeyTime="00:00:00.2" Value="{x:Static Visibility.Visible}"/>
                            <DiscreteObjectKeyFrame KeyTime="00:00:00.4" Value="{x:Static Visibility.Collapsed}"/>
                            <DiscreteObjectKeyFrame KeyTime="00:00:00.6" Value="{x:Static Visibility.Visible}"/>
                            <DiscreteObjectKeyFrame KeyTime="00:00:00.8" Value="{x:Static Visibility.Collapsed}"/>
                            <DiscreteObjectKeyFrame KeyTime="00:00:01.0" Value="{x:Static Visibility.Visible}"/>
                            <DiscreteObjectKeyFrame KeyTime="00:00:01.2" Value="{x:Static Visibility.Collapsed}"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger.Actions>
        </EventTrigger>
    </Style.Triggers>
</Style>

<ControlTemplate x:Key="QuoteDisplayTemplate" >
    <StackPanel Orientation="Horizontal">
        <TextBlock Text="{Binding QuotePrice}" />
        <TextBlock Style="{StaticResource PriceSpreadAlertStyle}">
          <TextBlock.Text>
            <MultiBinding Converter="{StaticResource AskBidToSpreadConverter}">
              <Binding Path="AskPrice" UpdateSourceTrigger="PropertyChanged" NotifyOnTargetUpdated="True" />
              <Binding Path="BidPrice" UpdateSourceTrigger="PropertyChanged" NotifyOnTargetUpdated="True" />
            </MultiBinding>
          </TextBlock.Text>
        </TextBlock>
    </StackPanel>
</ControlTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:03:50.113

当您执行 NotifyPropertyChanged 时，检查它是否在后面的代码中“获取”您的值。

出于同样的原因，请在最初启动时检查任何绑定表达式错误。

此外，您可以尝试将绑定模式更改为单向，我不这么认为，但它们可能会被设置为一次性绑定，从而阻止它处理更改的事件。

编辑：您是否尝试过使用 SourceUpdated RoutedEvent 而不是 TargetUpdated？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:41:55.507

我找到的解决方案是将 'NotifyOnTargetUpdated="True"' 从 Binding 元素移动到 MultiBinding 元素。

# jquery - django-tastypie PATCH 给了我一个“400（错误请求）”

> ID：11868908
> 
> 赞同：3
> 
> 时间：2012-08-08T16:24:07.617
> 
> 标签：jquery, django, api, nginx, tastypie

我在 Apache 上运行一个 Django 站点，该站点由 Nginx 实例前端来服务我的静态媒体。

我通过 django-tastypie 将 API 暴露给我需要在其上修补字段的模型。当我进行本地测试（通过 django runserver）时，一切都按预期工作。但是在实时服务器上，我得到“400（错误请求）”返回。

看了几个地方说Nginx不支持PATCH？那正确吗？有没有好的解决方法？难道我做错了什么？

我只通过我想通过***postData***更新的字段发送。

**jQuery代码：**

```
$.ajax({url: '...',
    type: 'PATCH',
    accepts: 'application/json',
    contentType: 'application/json',
    dataType: 'json',
    data: postData,
    processData: false,
    success: function() {
        // Success Code!
    },
    error: function() {
        // Error Code!
    }
}); 
```

**美味资源：**

```
class ReceivedMessageResource(ModelResource):
    """
    """
    campaign = fields.ForeignKey(CampaignResource, 'campaign')
    campaign_name = fields.CharField(readonly=True)
    campaign_id = fields.IntegerField(readonly=True)
    message_type = fields.CharField(readonly=True)
    display_date = fields.CharField(readonly=True)
    attachments = fields.ToManyField('apps.campaign.api.AttachmentResource',
                                     'attachment_set',
                                     related_name='message',
                                     full=True)

    class Meta:
        queryset = ReceivedMessage.objects.all()
        resource_name = 'message'
        filtering = {'id': ALL,
                     'campaign': ALL_WITH_RELATIONS}
        excludes = ['reason', 'provider', 'loyalty_profile', 'original_message', 'date_received']
        allowed_methods = ['get', 'post', 'put', 'delete', 'patch']
        paginator_class = ReceivedMessagesPaginator
        authentication = ApiKeyAuthentication()
        authorization = DjangoAuthorization() 
```

任何关于如何排序的方向都将不胜感激:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T10:45:49.250

如果您使用的是最新版本的 TastyPie（来自 GitHub 存储库的版本，自 8 月 5 日起），您可以按照[文档](http://django-tastypie.readthedocs.org/en/latest/resources.html#using-put-delete-patch-in-unsupported-places)中的说明进行操作：

> **`PUT/DELETE/PATCH`在不受支持的地方使用**
> 
> 某些地方，例如某些浏览器或主机中，不允许使用`PUT`//方法。在这些环境中，您可以通过提供标头来模拟这些类型的请求。例如，要通过 发送请求，您将发送如下请求：`DELETE``PATCH``X-HTTP-Method-Override``PATCH``POST`

```
curl --dump-header - -H "Content-Type: application/json" -H "X-HTTP-Method-Override: PATCH" -X POST --data '{"title": "I Visited Grandma Today"}' http://localhost:8000/api/v1/entry/1/ 
```

因此，如果您的主机不支持此方法，请在`X-HTTP-Method-Override`标题中添加您尝试执行的方法的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:14:33.453

如果 PATCH 没有通过你的 HTTP 服务器，你可以伪造它。使用 POST 请求，并添加标头“X-HTTP-Method-Override”：“PATCH”。在本文发布时，Tastypie 的主分支支持这一点。

如果您使用的是旧版本，例如当前稳定版本 0.9.11，您可能需要一个小补丁。像[这个要点](https://gist.github.com/2161338)这样的东西会教 Tastypie 使用那个标题。

相关文章在这里：

```
 if request_method == 'post' and 'HTTP_X_HTTP_METHOD_OVERRIDE' in request.META:
        request_method = request.META['HTTP_X_HTTP_METHOD_OVERRIDE'].lower() 
```

# android - android：不工作重复位图可绘制

> ID：11868909
> 
> 赞同：1
> 
> 时间：2012-08-08T16:24:18.163
> 
> 标签：android, image, background, repeat

我需要设置重复图像的背景。所以`repeat_dark_bg.xml`我的drawable文件夹中有一个文件

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:src="@drawable/repeat_dark_marked"
    android:tileMode="repeat"
    >
</bitmap> 
```

`repeat_dark_marked`- 图像，我想重复一遍。所以然后我`repeat_dark_bg.xml`用作我的背景值`linearlayout`。但有什么问题..当我在设备上测试我的应用程序时，有时图像 `repeat_dark_marked`重复，有时它会缩放并调整到全屏..我不明白为什么有时它会显示这个或那个..有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:32:12.050

repeat_dark_marked.png 是 9 补丁？确保您的可绘制文件夹中没有多个 repeat_dark_marked.png 或 repeat_dark_marked.9.png 等。检查所有 drawable-mdpi、drawable-hdpi、drawable-ldpi 文件夹。

# mongodb - mongoengine-referencefield 存储什么

> ID：11868910
> 
> 赞同：7
> 
> 时间：2012-08-08T16:24:27.163
> 
> 标签：mongodb, orm, mongoengine

在 mongoengine 中，必须在 ReferenceField 中设置什么值。我的意思是我们是否应该在要参考的文档的“ObjectId”中提供。例如，

```
class Bar(Document):
    content = StringField()
    foo = ReferenceField('Foo') 
```

Bar 类的对象应该在“foo”属性中设置什么值。它应该是“Foo”集合中某个文档的 ObjectId 吗？我还可以将任何其他唯一字段设置为参考字段中的值，提及它是哪个字段？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T08:47:11.093

在 MongoEngine 0.8 版本之前，它默认存储一个 DBRef。对于 0.8 及更高版本，它默认存储一个 ObjectId。

`dbref`创建 ReferenceField 时应该使用一个参数（[显式优于隐式](http://www.python.org/dev/peps/pep-0020/)）：

```
class Bar(Document):
    content = StringField()
    foo = ReferenceField('Foo', dbref = True)   # will use a DBRef
    bar = ReferenceField('Bar', dbref = False)  # will use an ObjectId 
```

这是[ReferenceField 的文档](https://mongoengine-odm.readthedocs.io/apireference.html#mongoengine.fields.ReferenceField)。

我安装了 0.7.9 版，当我创建*没有*参数的 ReferenceField时`dbref`，我收到以下警告：

```
[...]/lib/python2.7/site-packages/mongoengine/fields.py:744: FutureWarning:
ReferenceFields will default to using ObjectId  strings in 0.8, set DBRef=True
if this isn't desired
warnings.warn(msg, FutureWarning) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T19:28:25.803

它存储了一个 DBRef，你只需要传递一个 Foo 实例，它就会自动转换。请参阅文档中的部分：[https ://mongoengine-odm.readthedocs.io/guide/defining-documents.html?highlight=referencefield](https://mongoengine-odm.readthedocs.io/guide/defining-documents.html?highlight=referencefield)

# facebook-like - Facebook Like 按钮不适用于所有 URL

> ID：11868913
> 
> 赞同：1
> 
> 时间：2012-08-08T16:24:45.980
> 
> 标签：facebook-like

我正在尝试解决 Facebook 喜欢按钮未显示在我们网站上的某些网址上的问题。直到大约一周前，它在所有 URL 上都运行良好。

似乎很不协调。

目前我可以看到`like`这个 URL 上的按钮

[http://www.chargrilled.co.uk/t-shirts/I-See-Dumb-People-t-shirt.m](http://www.chargrilled.co.uk/t-shirts/I-See-Dumb-People-t-shirt.m)

但不是这个网址

[http://www.chargrilled.co.uk/t-shirts/Tea-Is-For-Mugs-t-shirt.m](http://www.chargrilled.co.uk/t-shirts/Tea-Is-For-Mugs-t-shirt.m)

通过测试，我发现从 URL 中删除 www 往往可以解决问题，但显然类似计数不同（通常为 0）。

奇怪的是，当您转到 facebook 的点赞按钮页面（https://developers.facebook.com/docs/reference/plugins/like/）并输入第二个 URL（上图）时，点赞按钮也会消失。

尝试了很多不同的东西，包括从页面中剥离除 FB 代码之外的所有其他 HTML、CSS 和 JS，但仍然没有乐趣！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:31:17.180

您的 url 显示在调试器中，没有错误。

[http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.chargrilled.co.uk%2Ft-shirts%2FTea-Is-For-Mugs-t-shirt。米](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.chargrilled.co.uk%2Ft-shirts%2FTea-Is-For-Mugs-t-shirt.m)

**建议：** 似乎不是最新的 url，在以管理员帐户登录的 url 调试器中运行它们，Facebook 将抓取页面以获取元标记。

[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)

**注意：** 如果用户向按钮添加了第一个赞，Facebook 最多可能需要 24 小时来抓取页面或 og 标签，如果管理员创建了第一个赞，它会立即完成。在第一次喜欢任何一种方式之后，Facebook 大约每 24-72 小时重新抓取一次页面。

# mysql - 将十六进制转换为 int 以进行 MySQL 导入

> ID：11868914
> 
> 赞同：0
> 
> 时间：2012-08-08T16:24:46.647
> 
> 标签：mysql

首先，我无法重新导出它，所以我被这个文件卡住了。

在下面发布的示例中，INT 列的值是十六进制的。我认为。诸如 0X31 之类的值需要导入为 1。相反，它们导入为 49。我猜这可能是 ascii 等价物。我需要将 0x31 导入为 1，将 0x32 导入为 2，等等。我该怎么做？

我也可以使用足够智能的文本编辑器来搜索和替换这些值。我有成千上万的 questionid，所以我不想手动执行此操作，例如搜索“0x31”替换为“1”。

这是导入示例。

`REPLACE INTO 'qa_sharedevents' ('entitytype', 'entityid', 'questionid', 'lastpostid', 'updatetype', 'lastuserid', 'updated') VALUES ('Q', '1', 0x31, '1', '', '1', '2012-03-08 23:45:56'), ('U', '1', 0x31, '1', '', '1', '2012-03-08 23:45:56'), ('Q', '1', 0x31, '3', '', '', '2012-03-09 02:23:54'), ('T', '17', 0x31, '1', '', '1', '2012-03-08 23:45:56'), ('Q', '2', 0x32, '2', '', '1', '2012-03-09 01:28:36'), ('U', '1', 0x32, '2', '', '1', '2012-03-09 01:28:36'), ('Q', '2', 0x32, '2', 'E', '1', '2012-03-09 01:30:27'), ('U', '1', 0x32, '2', 'E', '1', '2012-03-09 01:30:27'),`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:29:25.117

试试这个[`CHAR()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_char)功能：

```
mysql> select char(0x31), char(0x35);
+------------+------------+
| char(0x31) | char(0x35) |
+------------+------------+
| 1          | 5          |
+------------+------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:30:22.870

您可以使用 MySQL 子串函数。在你的 mysql 客户端上试试这个，看看它是如何工作的：

选择子字符串（'0x31'，-1,1）；

# java - 从语句创建 PreparedStatement？

> ID：11868922
> 
> 赞同：-1
> 
> 时间：2012-08-08T16:25:06.650
> 
> 标签：java, mysql, prepared-statement

这听起来有点奇怪，但我想`PreparedStatement`
在拥有`Statement`. 这是因为我的项目几乎是 50% ，直到现在我已经使用了`Statement`.

在我的 Database 类中，我有一个构造函数，每次我需要使用 Mysql 服务器时连接到 mysql ：

```
public class Database 
{
    private Statement m_statement = null;
    private Connection m_connection = null;
    private PreparedStatement m_prepared = null;  // that one was added just now 

    private static final String ACCOUNTS_TABLE = "CheckingAccountsTable";
    private static final String PERSONNEL_TABLE = "PersonnelTable";
    // private static final String 

    public Database() throws ClassNotFoundException
    {
        try
        {
            Class.forName("com.mysql.jdbc.Driver");
            this.m_connection = DriverManager.getConnection("jdbc:mysql://localhost","root","root");
            this.m_statement = this.m_connection.createStatement();

        }

        catch (SQLException s)
        {
            System.out.println("SQL statement is not executed! 2!");
        }

    }

}

// from here I have something like 20 methods that are based on the Statement 
```

改变一切将需要很多我没有的时间。所以，我的问题是：

我可以使用我创建的语句`PreparedStatement`吗？或创建 `PreparedStatement`基于`Statement`？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:41:10.403

这是不可能的。`Statement`并`PreparedStatement`代表不同的事物。

*   `Statement`用于调用不同的 SQL 查询，您在`Statement`不知道要使用什么 SQL 查询的情况下创建实例。
*   `PreparedStatement`在创建时给定一个 SQL 查询，如果可能，驱动程序会尝试预编译该查询。您可以填写不同的参数并重复使用，但不能更改查询，它始终使用创建时给定的参数。

所以恐怕你必须重构你的代码，没有简单的方法可以在这两者之间切换。

在大多数情况下，使用`PreparedStatement`是首选，因为它允许您以安全的方式将参数传递给 SQL 查询，而不会冒[SQL 注入](https://en.wikipedia.org/wiki/SQL_injection)的风险。

# c# - 为 ConfigurationProperty 键生成 ID？

> ID：11868926
> 
> 赞同：0
> 
> 时间：2012-08-08T16:25:17.383
> 
> 标签：c#, asp.net, .net, c#-4.0, configuration

我有一个带有修饰属性的 ConfigElement，指示它是必需的还是键。我想让它成为一个密钥，但是我如何生成一个密钥，这样我就不必依赖用户来提供一个唯一的密钥？我尝试放置 Guid.NewGuid()，但它给出了一个错误，说默认值必须是一个常量：

```
An attribute argument must be a constant expression, 
typeof expression or array creation expression of an attribute parameter type 
```

这是我的班级的样子：

```
public class MyEntryElement : ConfigElement
{
    #region Constructor

    public MyEntryElement(ConfigElement parent)
        : base(parent)
    {
    }

    #endregion

    #region Properties

    [ConfigurationProperty("id", DefaultValue = Guid.NewGuid(), IsRequired = true, IsKey = true)]
    [ObjectInfo(Title = "ID", Description = "Defines the id of the entry.")]
    public string ID
    {
        get
        {
            return (string)this["id"];
        }
        set
        {
            this["id"] = value;
        }
    }

    [ConfigurationProperty("note", DefaultValue = "", IsRequired = true)]
    [ObjectInfo(Title = "Note", Description = "Defines the note of the entry.")]
    public string Note
    {
        get
        {
            return (string)this["note"];
        }
        set
        {
            this["note"] = value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:28:44.153

尝试在类的 ctor 中分​​配 id。

我会让 ID 只读（不设置）。通常不希望允许修改密钥（仅创建）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:30:08.280

如何在构造函数中设置它：

```
 public MyEntryElement(ConfigElement parent)
        : base(parent)
    {
        if ( String.IsNullOrEmpty(ID) )
        {
            ID = Guid.NewGuid().ToString();
        }
    } 
```

# iphone - Xcode 4.4：此进程的另一个实例已在运行或挂在调试器中

> ID：11868927
> 
> 赞同：1
> 
> 时间：2012-08-08T16:25:21.250
> 
> 标签：iphone, debugging, ios5.1, xcode4.4

我在几个地方看到过关于 SO 的类似问题，但它们都与模拟器和旧 Xcode 版本有关。例如，[错误：未知错误代码。此进程已在运行或挂在调试器中](https://stackoverflow.com/questions/8432707/error-unknown-error-code-this-process-was-already-running-or-is-hung-in-the-de)，并且[在 iOS 模拟器上测试时出错：无法向引导服务器注册](https://stackoverflow.com/questions/788277/iphone-strange-error-when-testing-on-simulator)

在我将 Xcode 升级到 4.4 之前，我从未见过这个错误。***它在模拟器上运行良好，但在 iPhone 上却不行。***我今天也将 Xcode 升级到了 4.4.1，但没有运气。如何摆脱 iPhone 上的这个错误？

> 无法向引导服务器注册 com.mycompany.myapp。错误：未知错误代码。
> 这通常意味着该进程的另一个实例已经在运行或挂在调试器中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T16:29:28.450

重新启动 Xcode 和 iDevice。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:48:38.580

请参阅[这篇](http://www.mikeash.com/pyblog/solving-simulator-bootstrap-errors.html)关于修复引导错误的帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:16:06.783

是的，如果重新启动 xcode 不起作用，请重新启动您的 MAC 并重新启动您的 iPhone - 它甚至在 xCode 4.3 中也有效。在 xCode 4.4 中，这种情况似乎不太常见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:43:53.890

我的经验是 Xcode 4.4 不再需要重新启动

只需关闭并重新启动。如果正常关闭不起作用，请按 ctrl+alt+esc 并立即退出 xcode。

不幸的是，没有其他方法可以防止这种情况（如果您正在努力运行；））

# qt - QCompleter 和 QListWidget 作为自定义弹出问题

> ID：11868928
> 
> 赞同：2
> 
> 时间：2012-08-08T16:25:22.673
> 
> 标签：qt, model, autocomplete, qcompleter

我有一个 QCompleter 为我的 QPlainTextEdit 使用 QStringListModel （[检查这个例子](http://qt-project.org/doc/qt-5.0/tools-customcompleter.html)）：

```
 QStringListModel* model = new QStringListModel(names);
  QCompleter* completer = new QCompleter(model);
  completer->setCompletionMode(QCompleter::PopupCompletion);
  completer->setModelSorting(QCompleter::UnsortedModel); 
```

它工作正常。现在我需要一些图标，工具提示，用于我尝试使用 QListWidget 作为自定义弹出窗口的每个建议：

```
 QListWidget* w = new QListWidget();
  foreach(name, names) {
    QListWidgetItem* i = new QListWidgetItem(name);
    i->setIcon(/*my Icon*/);
    i->setToolTip("");
    w->addItem(i);
  }
  completer->setPopup(w); 
```

弹出窗口好的，就像我需要的那样，但完成没有更多的工作。我无法输入文本以使其过滤建议，只需向上/向下键。
我尝试过：

```
 completer->setModel(w->model()); 
```

但没有帮助！
我的错误是什么，或者只是 QStringListModel 让我能够过滤建议？你有什么建议？
谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T20:29:35.590

我主要处理 PyQt，但同样处理。我的语法可能不正确，但您应该使用 QStandardItemModel 与 QStringListModel。从那里，您可以将其保留为标准弹出窗口（QListView）

就像是：

```
QStandardItemModel* model = new QStandardItemModel();

// initialize the model
int rows = names.count();  // assuming this is a QStringList
model->setRowCount(rows);
model->setColumnCount(1);

// load the items
int row = 0;
foreach(name, names) {
    QStandardItem* item = new QStandardItem(name);
    item->setIcon(QIcon(":some/icon.png");
    item->setToolTip("some tool tip");
    model->setItem(row, 0, item);
    row++;
}

completer->setModel(model);
completer->popup()->setModel(model); // may or may not be needed 
```

# android - 具有类似于 Google Offers 应用程序的可滚动内容的 Android App Widget

> ID：11868932
> 
> 赞同：0
> 
> 时间：2012-08-08T16:25:56.280
> 
> 标签：android, android-widget, scroll

我正在为我的应用程序创建一个包含多个内容部分的小部件，并且我希望用户能够在主屏幕小部件中滚动它们 - 不是在可滚动的`TextView`中，而是每个段落作为其自己的部分，例如[Google Offers 应用](https://play.google.com/store/apps/details?id=com.google.android.apps.offers)的小部件： ![在此处输入图像描述](../Images/d30ddeb2cc480592c482ff4df2a76c36.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:23:10.137

这看起来像[一个`StackView`小部件](http://developer.android.com/reference/android/widget/StackView.html)，可用于 API 级别 11 的应用小部件。

# c++ - 使用带有指针/类的 set 方法

> ID：11868933
> 
> 赞同：1
> 
> 时间：2012-08-08T16:26:00.930
> 
> 标签：c++

我正在尝试构造一个对象，然后将其中一个变量设置为一个值。

**类头：**

```
class Book {
public:
Book();
Book(string newSelection);
string getSelection();
string setSelection(string newSelection);

private:
string selection;
} 
```

**类 cpp**

```
Book::Book() {}

Book::Book(string newSelection) {
selection = newSelection;
}

string Book::getSelection(){
return selection;
}

string Book::setSelection(string newSelection){
selection = newSelection;
} 
```

**司机**

```
Book* book1 = new Book();
book1->setSelection("The Book Title");
cout << "Book selected:    " << book1->getSelection() << endl; 
```

我遇到了分段错误，不知道为什么。有人可以指出我的问题可能出在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:34:39.970

您的`setSelection()`函数被声明为返回一个字符串，但实际上没有返回任何字符串。你至少应该得到一个编译警告。

通过在调试器中运行它，我*相信*正在发生的事情是在调用`setSelection()`析构函数之后在返回的字符串上调用。由于这个字符串并不真正存在，这会导致`abort()`运行时出现。

作为一般规则，'setters' 倾向于不返回任何东西，所以会写成如下：

```
void setSelection(const string& newSelection); 
```

...

```
void Book::setSelection(const string& newSelection)
{
    selection = newSelection;
} 
```

另请注意，字符串是通过 const 引用而不是更有效的值传递的。不过，这不会是您的问题的原因。

另一个建议是确保将您的“getter”声明为 const，因为它不会更改对象中的任何内容：

```
string getSelection() const; 
```

...

```
string Book::getSelection() const
{
    return selection;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:34:07.513

该`setSelection`方法被定义为返回一个字符串，但它没有返回任何内容。也许添加一个 return 语句（或将其更改为 void）将修复它：

```
string Book::setSelection(string newSelection){
  selection = newSelection;
  return selection;
} 
```

# count - 使用另一个表中的用户定义变量计算表中的行数？

> ID：11868936
> 
> 赞同：0
> 
> 时间：2012-08-08T16:26:18.913
> 
> 标签：count, user-defined

我对此很陌生-有人可以告诉我这个查询是否正确吗？我正在尝试从表 1 中获取一个变量并使用它来计算表 2 中的行数......非常感谢。

INSTRUCTION 假设有以下2表数据库：表1，称为内容，具有字段：content_id、content_name、content_url。表 2，称为视图，具有以下字段：view_id、content_id、view_timestamp

编写一个 MySQL 查询以查找内容名称为“maria_video”的一段内容的总观看次数。

我的查询 mysql> SELECT @ID:=content_id FROM content WHERE content_name=”maria_video”;

mysql> COUNT(*) FROM views WHERE content_id=@ID;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:35:56.077

基于此

> 编写一个 MySQL 查询以查找内容名称为“maria_video”的一段内容的总观看次数。

你不能只写一个得到相同值的查询吗？

像这样的东西

SELECT COUNT(*) FROM Views AS v INNER JOIN Content AS c ON (v.content_id=c.content_id) WHERE c.content_name="maria_video"

我现在没有可用的 mysql 实例来测试它，但它应该可以工作。

# vbscript - vbs 中的 Inputbox() 函数

> ID：11868938
> 
> 赞同：1
> 
> 时间：2012-08-08T16:26:20.990
> 
> 标签：vbscript

我`InputBox()`在我的 vbscript 代码中使用函数，它工作正常，我正在使用各种`InputBox()`函数。

现在我的问题是每次`InputBox()`调用时，它都会在单独的窗口中打开。有什么方法或功能可以让我只在一个窗口页面中输入我的数据并且所有输入都可以通过一个提交按钮处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:32:55.457

您不能重复使用“相同”的 InputBox，但对于一些简单的输入，您可以要求一次输入多个项目并解析用户的输入（如命令行参数）。从长远来看 - 对于许多输入 - 最好使用 HTA 应用程序。

PS（根据彼得的提议）

> HTA 是成熟的应用程序。这些应用程序是受信任的，并且仅显示 Web 开发人员创建的菜单、图标、工具栏和标题信息。简而言之，HTA 包含了 Internet Explorer 的所有功能——它的对象模型、性能、渲染能力和协议支持——而没有强制执行严格的安全模型和浏览器的用户界面。

（[HTA 上的 MS](http://msdn.microsoft.com/en-us/library/ms536496%28v=vs.85%29.aspx)）

[入门教程](http://technet.microsoft.com/en-us/library/ee692768.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T00:15:51.537

作为使用 HTA 的一部分，您可以像 GUI 一样使用 Internet Explorer，并使用 HTML 的所有优点在您的脚本和用户之间进行交互。使用 vbscript 示例查看我的这个问题。

[使用浏览器作为 gui-in-ruby](https://stackoverflow.com/questions/11724201/use-browser-as-gui-in-ruby)

另请参阅我的答案[/adding-a-gui-to-vbscript](https://stackoverflow.com/questions/16052534/adding-a-gui-to-vbscript/16054011#16054011)

# c# - 需要返回 XElement 而不是 byte[] 的方法

> ID：11868939
> 
> 赞同：0
> 
> 时间：2012-08-08T16:26:24.160
> 
> 标签：c#, xml, bytearray, xelement

我有以下方法需要返回一个`XElement`. 问题是无法弄清楚如何将 a`byte[]`转换为`XElement`.

```
public XElement ServiceCallForNewMadidPlantReport()
{
    var kpiReportClient = new ReportExecutionService();
    kpiReportClient.Credentials = System.Net.CredentialCache.DefaultCredentials;
    var endPoint = new EndpointAddress("*****");
    kpiReportClient.Url = endPoint.ToString();

    //render arguments 
    byte[]result = null;
    string reportSickTimePlants = "/Human Resources/KPI POW/Kpi_Fmla_Summarized_Plants_Prg"; //report path
    string format = "XML";
    string historyID = null;
    string devInfo = "";

    //prepare report parameter
    ParameterValue[] parameters = new ParameterValue[4];
    parameters[0] = new ParameterValue();
    parameters[0].Name = "Location";
    parameters[0].Value = "4"; //New Madrid
    parameters[1] = new ParameterValue();
    parameters[1].Name = "UnCode";
    parameters[1].Value = "Non-Union";
    parameters[2] = new ParameterValue();
    parameters[2].Name = "StartDate";
    parameters[2].Value = "01/01/2006";
    parameters[3] = new ParameterValue();
    parameters[3].Name = "EndDate";
    parameters[3].Value = "08/08/2012";

    string encoding;
    string mimeType;
    string extension;
    Warning[] warnings = null;            
    string[] streamIDs;

    ExecutionInfo execInfo = new ExecutionInfo();
    ExecutionHeader execHeader = new ExecutionHeader();
    kpiReportClient.ExecutionHeaderValue = execHeader;

    var trustedUserHeader = new TrustedUserHeader();            

    execInfo = kpiReportClient.LoadReport(reportSickTimePlants, historyID);

    kpiReportClient.SetExecutionParameters(parameters, "en-us");

    String SessionId = kpiReportClient.ExecutionHeaderValue.ExecutionID;

    Console.WriteLine("SessionID: {0}", kpiReportClient.ExecutionHeaderValue.ExecutionID);

    try
    {
        result = kpiReportClient.Render(format, devInfo, out extension, out encoding, out mimeType, out warnings, out streamIDs);
        Console.WriteLine(result);
        execInfo = kpiReportClient.GetExecutionInfo();
    }
    catch (SoapException e)
    {
        Console.WriteLine(e.Detail.OuterXml);
    }
    try
    {
        FileStream sickTimReportForPlants = File.Create("SickTimeNonRepEmpReport.xml", result.Length);
        Console.WriteLine("File created.");
        Console.WriteLine(sickTimReportForPlants);
        sickTimReportForPlants.Write(result, 0, result.Length);
        Console.WriteLine("Result written to the file.");                
        sickTimReportForPlants.Close();
    }
    catch (Exception e)
    {
        Console.WriteLine(e.Message);
    }
    return ? (must be XElement)
} 
```

这是我尝试过的，但它不起作用：

```
result = kpiReportClient.Render(format, devInfo, out extension, out encoding, out mimeType, out warnings, out streamIDs);
Console.WriteLine(result);
string resultString  = Convert.ToBase64String(result);
var nonRepSickReportForNM = XElement.Parse(resultString); 
```

这给了我以下错误：

> System.Xml.XmlException：根级别的数据无效。第 1 行，位置 1。

我也尝试了其他几种方法，但无论我做什么，我都会遇到同样的错误。这是 xml 文件的样子：

```
<?xml version="1.0" encoding="utf-8"?><Report xsi:schemaLocation="Kpi_Fmla_Summarized_Plants_Prg http://gonzo/ReportServer?%2fHuman+Resources%2fKPI+POW%2fKpi_Fmla_Summarized_Plants_Prg&amp;rs%3aFormat=XML&amp;rc%3aSchema=True" Name="Kpi_Fmla_Summarized_Plants_Prg" Location="New Madrid" Textbox84="KPI SICK / FMLA 1/1/2006 12:00:00 AM - 8/8/2012 12:00:00 AM" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="Kpi_Fmla_Summarized_Plants_Prg"><Tablix1><Textbox13><Textbox3><Textbox15 /></Textbox3></Textbox13><Category_Collection><Category Category1="FMLA"><represented1_Collection><represented1 represented11="Non-Union"><QTR_Collection><QTR QTR1="1" Textbox27="1787" /><QTR QTR1="2" Textbox27="988.75" /><QTR QTR1="3" Textbox27="1577.75" /><QTR QTR1="4" Textbox27="2133.25" /></QTR_Collection></represented1></represented1_Collection></Category><Category Category1="Sick"><represented1_Collection><represented1 represented11="Non-Union"><QTR_Collection><QTR QTR1="1" Textbox27="5407.5" /><QTR QTR1="2" Textbox27="4051.75" /><QTR QTR1="3" Textbox27="3928" /><QTR QTR1="4" Textbox27="4204.75" /></QTR_Collection></represented1></represented1_Collection></Category></Category_Collection></Tablix1></Report> 
```

我不确定我做错了什么。

编辑：

执行以下操作后：

```
string resultFromBytes = UTF8Encoding.UTF8.GetString(result);
return XDocument.Parse(resultFromBytes).Root; 
```

我仍然收到相同的错误消息，但这是我来自 resultFromBytes 的 xml

```
<?xml version="1.0" encoding="utf-8"?><Report xsi:schemaLocation="Kpi_Fmla_Summarized_Plants_Prg http://gonzo/ReportServer?%2fHuman+Resources%2fKPI+POW%2fKpi_Fmla_Summarized_Plants_Prg&amp;rs%3aFormat=XML&amp;rc%3aSchema=True" Name="Kpi_Fmla_Summarized_Plants_Prg" Location="New Madrid" Textbox84="KPI SICK / FMLA 1/1/2006 12:00:00 AM - 8/8/2012 12:00:00 AM" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="Kpi_Fmla_Summarized_Plants_Prg"><Tablix1><Textbox13><Textbox3><Textbox15 /></Textbox3></Textbox13><Category_Collection><Category Category1="FMLA"><represented1_Collection><represented1 represented11="Non-Union"><QTR_Collection><QTR QTR1="1" Textbox27="1787" /><QTR QTR1="2" Textbox27="988.75" /><QTR QTR1="3" Textbox27="1577.75" /><QTR QTR1="4" Textbox27="2133.25" /></QTR_Collection></represented1></represented1_Collection></Category><Category Category1="Sick"><represented1_Collection><represented1 represented11="Non-Union"><QTR_Collection><QTR QTR1="1" Textbox27="5407.5" /><QTR QTR1="2" Textbox27="4051.75" /><QTR QTR1="3" Textbox27="3928" /><QTR QTR1="4" Textbox27="4204.75" /></QTR_Collection></represented1></represented1_Collection></Category></Category_Collection></Tablix1></Report> 
```

编辑：

这样做之后：

```
string resultFromBytes = UTF8Encoding.UTF8.GetString(result);
var regex = new System.Text.RegularExpressions.Regex(@"xsi:schemaLocation="".+""");
string strippedxml = regex.Replace(resultFromBytes, "");
return XDocument.Parse(strippedxml).Root; 
```

我得到同样的失败。这是 strippedxml 的样子：

```
<?xml version="1.0" encoding="utf-8"?><Report  /></QTR_Collection></represented1></represented1_Collection></Category></Category_Collection></Tablix1></Report> 
```

编辑：

试过这个，xml看起来好多了，但仍然失败并出现同样的错误：

```
string resultFromBytes = UTF8Encoding.UTF8.GetString(result);
var regex = new System.Text.RegularExpressions.Regex(@"xsi:schemaLocation="".+""");
string strippedxml = regex.Replace(resultFromBytes, "");
return XDocument.Parse(strippedxml).Root; 
```

这是来自 strippedxml 的 xml 的样子：

```
<?xml version="1.0" encoding="utf-8"?><Report  Name="Kpi_Fmla_Summarized_Plants_Prg" Location="New Madrid" Textbox84="KPI SICK / FMLA 1/1/2006 12:00:00 AM - 8/8/2012 12:00:00 AM" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="Kpi_Fmla_Summarized_Plants_Prg"><Tablix1><Textbox13><Textbox3><Textbox15 /></Textbox3></Textbox13><Category_Collection><Category Category1="FMLA"><represented1_Collection><represented1 represented11="Non-Union"><QTR_Collection><QTR QTR1="1" Textbox27="1787" /><QTR QTR1="2" Textbox27="988.75" /><QTR QTR1="3" Textbox27="1577.75" /><QTR QTR1="4" Textbox27="2133.25" /></QTR_Collection></represented1></represented1_Collection></Category><Category Category1="Sick"><represented1_Collection><represented1 represented11="Non-Union"><QTR_Collection><QTR QTR1="1" Textbox27="5407.5" /><QTR QTR1="2" Textbox27="4051.75" /><QTR QTR1="3" Textbox27="3928" /><QTR QTR1="4" Textbox27="4204.75" /></QTR_Collection></represented1></represented1_Collection></Category></Category_Collection></Tablix1></Report> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:42:43.637

我有答案。我试图将它从 byte[] 转换为 XElement。相反，我将其转换为流，然后转换为 Xelement。像这样：

```
result = kpiReportClient.Render(format, devInfo, out extension, out encoding, out mimeType, out warnings, out streamIDs);
Console.WriteLine(result);
result = kpiReportClient.Render(format, devInfo, out extension, out encoding, out mimeType, out warnings, out streamIDs);
Stream resStream = new MemoryStream(result);
var nonRepSickReportForNM = XElement.Load(resStream);
return nonRepSickReportForNM 
```

不过，我不能把它归功于它。我的老板想通了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:35:30.077

也许是这样的：（修复了命名空间问题）

```
string resultFromBytes = UTF8Encoding.UTF8.GetString(result);

var nt = new NameTable();
var nsmgr = new XmlNamespaceManager(nt);
nsmgr.AddNamespace(String.Empty, "urn:samples"); //default namespace
nsmgr.AddNamespace("xsi", "urn:samples2"); // xsi fix

var context = new XmlParserContext(nt, nsmgr,null,  XmlSpace.None);

var settings = new XmlReaderSettings();
settings.ConformanceLevel = ConformanceLevel.Document;

var xrdr= XmlReader.Create(new StringReader(xml), settings, context);
return XDocument.Load(xrdr).Root; 
```

# ruby-on-rails - Michael Hartl 教程 3.2 - 第 9 章 - 错误消息和编辑/更新页面问题

> ID：11868940
> 
> 赞同：0
> 
> 时间：2012-08-08T16:26:25.813
> 
> 标签：ruby-on-rails, ruby

我正在研究 Michael Hartl Rails 3.2，我已经被这些问题困扰了几个小时。我无法弄清楚我错过了什么，因为我已经检查了 7、8、9 中的所有代码以确保它是准确的。更新/编辑页面一直在工作，直到我在我的用户控件的私有部分中添加。

由于我添加了这些，当我手动测试页面并点击设置时，它直接进入登录页面。似乎它没有接受除非已签名？并将其从用户控制器页面重定向到签名页面。我的测试失败是有道理的，因为编辑页面没有出现以登录。任何想法或建议将不胜感激。如果您需要查看其他页面，请告诉我。

错误消息 - 我收到 9 个错误，如下所示

```
Failures:

1) UserPages edit page 
 Failure/Error: it { should have_selector('h1', text: "Update your profile") }
   expected css "h1" with text "Update your profile" to return something
 # ./spec/requests/user_pages_spec.rb:73:in `block (4 levels) in <top (required)>'

2) UserPages edit page 
 Failure/Error: it { should have_link('change', href: 'http://gravatar.com/emails')}
   expected link "change" to return something
 # ./spec/requests/user_pages_spec.rb:75:in `block (4 levels) in <top (required)>'

3) UserPages edit page 
 Failure/Error: it { should have_selector('title', text: "Edit user") }
   expected css "title" with text "Edit user" to return something
 # ./spec/requests/user_pages_spec.rb:74:in `block (4 levels) in <top (required)>'

4) UserPages edit with valid information 
 Failure/Error: fill_in "Name", with: new_name
 Capybara::ElementNotFound:
   cannot fill in, no text field, text area or password field with id, name, or label 'Name' found
 # (eval):2:in `fill_in'
 # ./spec/requests/user_pages_spec.rb:88:in `block (4 levels) in <top (required)>'

5) UserPages edit with valid information 
 Failure/Error: fill_in "Name", with: new_name
 Capybara::ElementNotFound:
   cannot fill in, no text field, text area or password field with id, name, or label 'Name' found
 # (eval):2:in `fill_in'
 # ./spec/requests/user_pages_spec.rb:88:in `block (4 levels) in <top (required)>'

6) UserPages edit with valid information 
 Failure/Error: fill_in "Name", with: new_name
 Capybara::ElementNotFound:
   cannot fill in, no text field, text area or password field with id, name, or label 'Name' found
 # (eval):2:in `fill_in'
 # ./spec/requests/user_pages_spec.rb:88:in `block (4 levels) in <top (required)>'

7) UserPages edit with valid information 
 Failure/Error: fill_in "Name", with: new_name
 Capybara::ElementNotFound:
   cannot fill in, no text field, text area or password field with id, name, or label 'Name' found
 # (eval):2:in `fill_in'
 # ./spec/requests/user_pages_spec.rb:88:in `block (4 levels) in <top (required)>'

8) UserPages edit with valid information 
 Failure/Error: fill_in "Name", with: new_name
 Capybara::ElementNotFound:
   cannot fill in, no text field, text area or password field with id, name, or label 'Name' found
 # (eval):2:in `fill_in'
 # ./spec/requests/user_pages_spec.rb:88:in `block (4 levels) in <top (required)>'

9) UserPages edit with invalid information 
 Failure/Error: before { click_button "Save changes" }
 Capybara::ElementNotFound:
   no button with value or id or text 'Save changes' found
 # (eval):2:in `click_button'
 # ./spec/requests/user_pages_spec.rb:79:in `block (4 levels) in <top (required)>' 
```

这是身份验证规范页面

```
require 'spec_helper'

describe "AuthenticationPages" do

subject { page }

describe "signin page" do
    before { visit signin_path }

    it { should have_selector('h1', text: 'Sign in') }
    it { should have_selector('title', text: 'Sign in') } 
end

describe "signin" do
before { visit signin_path}

    describe "with invalid information" do
        before { click_button "Sign in" }

        it { should have_selector('title', text: 'Sign in') }
        it { should have_selector('div.alert.alert-error', text: 'Invalid') }

        describe "after visiting another page" do
            before { click_link "Home" }
            it { should_not have_selector('div.alert.alert-error') }
        end
    end

    describe "with valid information" do
        let(:user) { FactoryGirl.create(:user) }
        before { sign_in user }

        describe "followed by signout" do
            before { click_link "Sign out" }
            it { should have_link('Sign in')}
        end

        it { should have_selector('title', text: user.name) }
        it { should have_link('Profile', href: user_path(user)) }
        it { should have_link('Settings', href: edit_user_path(user)) }
        it { should have_link('Sign out', href: signout_path) }
        it { should_not have_link('Sign in', href: signin_path) }

    end
end

describe "authorization" do

    describe "for non-signed-in users" do
        let(:user) { FactoryGirl.create(:user) }

        describe "in the Users controller" do

            describe "visiting the edit page" do
                before { visit edit_user_path(user) }
                it { should have_selector('title', text: 'Sign in' ) }
            end

            describe "submitting to the update action" do
                before { put user_path(user) }
                specify { response.should redirect_to(signin_path) }
            end
        end
    end
end
end 
```

和用户页面规范

```
require 'spec_helper'

describe "UserPages" do

subject { page }

describe "profile page" do
    before { visit user_path(user) }
    let(:user) {FactoryGirl.create(:user) }

    it { should have_selector('h1', text: user.name)}
    it { should have_selector('title', text: user.name) }
end

describe "signup page" do
    before {visit signup_path}
    it { should have_selector('h1', text: 'Sign up') }
    it { should have_selector('title', text: full_title('Sign up'))}
end

describe "signup" do
    before { visit signup_path}
    let(:submit) { "Create my account"}

    describe "with invalid information" do
        it "should not create a user" do
            expect { click_button submit }.not_to change(User, :count)
        end

    describe "after submission" do
      before { click_button submit }

      it { should have_selector('title', text: 'Sign up') }
      it { should have_content('error') }
    end
end

describe "with valid information" do
        before do
            fill_in "Name", with: "Exmaple User"
            fill_in "Email", with: "user@example.com"
            fill_in "Password", with: "foobar"
            fill_in "Password confirmation", with: "foobar"
    end

    it "should create a user" do
        expect { click_button submit }.to change(User, :count).by(1)
    end

    describe "after saving the user" do
      before { click_button submit }
      let(:user) { User.find_by_email('user@example.com') }

      it { should have_selector('title', text: user.name) }
      it { should have_selector('div.alert.alert-success', text: 'Welcome') }
      it { should have_link('Sign out') }
    end
    end
end

describe "edit" do
let(:user) { FactoryGirl.create(:user) }
before do
  visit signin_path
  sign_in user
  visit edit_user_path(user)
end

describe "page" do
  it { should have_selector('h1', text: "Update your profile") }
  it { should have_selector('title', text: "Edit user") }
  it { should have_link('change', href: 'http://gravatar.com/emails')}
end

describe "with invalid information" do
  before { click_button "Save changes" }

  it { should have_content('error') }
end

describe "with valid information" do
    let(:new_name) { "New Name"}
    let(:new_email) {"new@example.com"}
    before do
      fill_in "Name", with: new_name
      fill_in "Email", with: new_email
      fill_in "Password", with: user.password
      fill_in "Confirm Password", with: user.password
      click_button "Save changes"
    end

it { should have_selector('title', text: new_name) }
it { should have_selector('div.alert.alert-success') }
it { should have_link('Sign out', href: signout_path) }
specify { user.reload.name.should == new_name }
specify { user.reload.email.should == new_email }
end
end
end 
```

Utilities 中的 sign_in(user)

```
def sign_in(user)
fill_in "Email", with: user.email
fill_in "Password", with: user.password
click_button "Sign in"
# Sign in when not using Capybara as well.
cookies[:remember_token] = user.remember_token 
```

结尾

会话助手

```
module SessionsHelper

def sign_in(user)
    cookies.permanent[:remember_token] = user.remember_token
    self.current_user = user
end

def signed_in?
    !current_user.nil?
end

def current_user=(user)
    @current_user = user
end

def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
end

def current_user?(user)
    user == current_user
end

def sign_out
    self.current_user = nil
    cookies.delete(:remember_token)
end

def redirect_back_or(default)
    redirect_to(session[:return_to] || default)
    session.delete(:return_to)
end

def store_location
    session[:return_to] = request.fullpath
end
end 
```

用户控制器

```
 class UsersController < ApplicationController
    before_filter :signed_in_user, only: [:edit, :update]
    before_filter :correct_user, only: [:edit, :update]

    def show
@user = User.find(params[:id])
    end

    def new
@user = User.new
    end

    def create
@user = User.new(params[:user])
if @user.save
    sign_in @user
    flash[:success] = "Welcome to the Sample App!"
    redirect_to @user
else
    render 'new'
end
   end

def edit
   @user = User.find(params[:id])
   end

def update
     @user = User.find(params[:id])
   if @user.update_attributes(params[:user])
     sign_in @user
     flash[:success] = "Profile updated"
     redirect_to @user
   else
     render 'edit'
   end
  end

private
 def signed_in_user
    unless signed_in?
    store_location
    redirect_to signin_path, notice: "Please sign in." 
  end
end

def correct_user
  @user=User.find(params[:id])
  redirect_to(root_path) unless current_user?(@user)
end

end 
```

视图/布局/_header.html.erb

```
<header class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <%= link_to "sample app", root_path, id: "logo" %>
            <nav>
                <ul class="nav pull-right">
                    <li><%= link_to "Home",  root_path %></li>
                    <li><%= link_to "Help",  help_path %></li>
                    <% if signed_in? %>
                        <li><%= link_to "Users", "#" %></li>
                        <li id="fat-menu" class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                Account <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><%= link_to "Profile", current_user %></li>
                                <li><%= link_to "Settings", edit_user_path(current_user) %></li>    
                                <li class="divider"></li>
                                <li>
                                    <%= link_to "Sign out", signout_path, method: "delete" %>
                                </li>
                            </ul>
                        </li>
                    <% else %>
                        <li><%= link_to "Sign in", signin_path %></li>
                    <% end %>
                </ul>
            </nav>
        </div>
    </div> 
```

如果您遇到此问题 - 请确保您的 application_controller 中没有此问题。这是一个很小的错误，却给我带来了各种各样的悲痛。再次 - 不要使用此代码......

```
class ApplicationController < ActionController::Base
 protect_from_forgery
 include SessionsHelper

 private
def current_user
    @current_user ||= User.find(session[:user_id]) if session[:user_id]
end 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:31:54.893

Capybara 找不到电子邮件字段。

在填写登录表格之前，您应该继续填写。像这样改变你的功能：

```
def sign_in(user)
  visit signin_path
  fill_in "Email", with: user.email
  fill_in "Password", with: user.password
  click_button "Sign in"
  # Sign in when not using Capybara as well.
  cookies[:remember_token] = user.remember_token
end 
```

我假设您的表格格式正确。您可以在 之后添加`visit signin_path`以`puts page.html`查看 html 以及`save_and_open_page`是否安装了 launchy。

# database - simpledb 中的项目名称

> ID：11868943
> 
> 赞同：1
> 
> 时间：2012-08-08T16:26:39.907
> 
> 标签：database, amazon-simpledb

是否需要 Amazon SimpleDB 中的 ItemName，因为我似乎无法删除它。我不能创建另一个可以用作“主键”的属性吗？

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T17:59:50.660

是的，项目名称是必需的，它是项目的唯一唯一标识符，它用于所有项目检索和更新操作（操作除外`select`）。

不知道您为什么不想使用项目名称，但在您需要提供项目名称时，您可以自由地用您想要的任何值填充它，这对我来说有点困难。因此，例如，您可以在那里转储一个 GUID。

由于所有属性都会自动编入索引，因此您可以自由使用`select`操作来根据您想要的任何属性检索项目。它是

```
select * from ExampleDomain where ExampleAttribute = 'foo' limit 1 
```

如果您只是在寻找 itemName （可能在随后的删除操作中使用）。

```
select itemName() from ExampleDomain where ExampleAttribute = 'foo' limit 1 
```

有关该操作的更多详细信息，请参阅[使用 Select 创建 Amazon SimpleDB 查询。](http://docs.amazonwebservices.com/AmazonSimpleDB/latest/DeveloperGuide/UsingSelect.html)`select`

我应该注意，使用`select`over`GetAttributes`有点贵，因为它通常会比 simple产生更高的[BoxUsage](http://aws.amazon.com/simpledb/faqs/#What_are_some_pricing_examples)`GetAttributes` ，但对于小型工作负载，这无关紧要。使用您自己的使用模式进行衡量。

# jquery - jQuery 表单 - 多条路线

> ID：11868947
> 
> 赞同：3
> 
> 时间：2012-08-08T16:26:46.933
> 
> 标签：jquery, forms

我有一个分为两个步骤的表格。第 2 步有 2 个不同的字段集，具体取决于第一步中选择的选项。所以你有步骤 1，然后是步骤 2a 和 2b。我不知道如何从下拉列表中提取值并使用它进入步骤 2a 或 2b。这是我的 HTML：

```
<fieldset class="step1">
    <label>Options</label>
    <select class="mySelect">
        <option value="steb2a">Step 2a</option>
        <option value="steb2b">Step 2b</option>
    </select>
    <a class="nextStep">Next</a>
</fieldset>
<fieldset class="step2a">
    <label>Question 2a</label>
    <input type="text" />
</fieldset>
<fieldset class="step2b">
    <label>Question 2b</label>
    <input type="text" />
</fieldset> 
```

这是我的javascript：

```
$(document).ready(function () {
    $(".step2a").addClass("hidePanel");
    $(".step2b").addClass("hidePanel");
    $(".nextStep").click(function () {
        $(".step1").addClass("hidePanel");
        $('.mySelect').change(function () {
            if ($(this).val() == 'step2a') {
                $(".step2a").removeClass("hidePanel").addClass("showPanel");
            } else if ($(this).val() == 'step2b') {
                $(".step2b").removeClass("hidePanel").addClass("showPanel");
            }
        });         
    });
}); 
```

这对我来说看起来很合乎逻辑，但它不起作用，它隐藏了第一个字段集 OK 但没有将“showPanel”类添加到下一个字段集中。我犯了一个简单的错误，还是我完全错误地接近这个？任何帮助表示赞赏。我在这里创建了一个 jsfiddle：

[http://jsfiddle.net/LTMzF/](http://jsfiddle.net/LTMzF/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:36:19.170

这是我的示例[http://jsfiddle.net/fyU6N/](http://jsfiddle.net/fyU6N/)

# ios - AVAudioPlayer 间歇性不播放声音

> ID：11868949
> 
> 赞同：0
> 
> 时间：2012-08-08T16:26:52.803
> 
> 标签：ios, ipad, avaudioplayer

我在 ipad 上有一个音乐播放器应用程序。我从服务器下载 m4a 文件并将它们保存到 doc 目录。我还使用 Core Data 来保存播放列表信息。我有超过 1000 首歌曲，而且我的桌子可以完美加载并完美播放。我可以毫无问题地播放播放列表。但是......每隔一段时间，一首歌曲不会播放。没有声音！我可以按单元格播放歌曲或转到下一首歌曲，一切都会重新开始。所以这个问题是随机的和间歇性的。卡住的从来不是同一首歌。我不能给你任何调试语句，就像我说的那样，它是如此随机和断断续续，很难复制。我想知道这是否是ARC问题。请帮忙，因为这个应用程序很快就会投入生产。

相关代码：

```
// setup music session
NSError *error = nil;
[[AVAudioSession sharedInstance] setDelegate: self];
[[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error: &error];
[[AVAudioSession sharedInstance] setActive: YES error: &error];

NSLog(@"error AVAudioSession:%@", [error description]);

AVAudioPlayer *player = [[AVAudioPlayer alloc] init];
NSString *fullPath = fullPath = [self.docDirPath stringByAppendingPathComponent:filename];
NSURL *musicFileURL = [[NSURL alloc] initFileURLWithPath:fullPath];

// getting song from docDir
    NSData *songData = [[NSData alloc] initWithContentsOfURL:musicFileURL];
    player = [player initWithData:songData error:&error];
    NSLog(@"error player reg:%@", [error description]);

//NSLog(@"playing %@ at index:%d", musicFileURL, index);

    self.appPlayer = player;

    [self.appPlayer prepareToPlay];
    [self.appPlayer setEnableRate: YES];
    [self.appPlayer setDelegate: self];
    [self.appPlayer play]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:39:47.253

如果您使用 ARC 开始解决问题的一个好点是观察 Instruments 中的引用计数。我也有这个问题。我的文件都没有播放。我在 Instruments 中看到 AVAudioPlayer 实例是在声音开始播放之前释放的。至少它看起来像是被释放了。在我将 AVAudioPlayer 的引用存储在核心数据模型中后，该错误已修复！在另一个没有 ARC 的项目中，相同的代码确实可以在不存储引用的情况下工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T19:47:23.377

或者您可以尝试在属性声明中使用强而不是保留

@property(nonatomic, strong) AVAudioPlayer *player;

# php - 使用 PHP 将 jquery 添加的选择列表的选项存储到数据库中

> ID：11868954
> 
> 赞同：0
> 
> 时间：2012-08-08T16:27:15.493
> 
> 标签：php, jquery, mysql

我找到了一个 jquery 片段，可以从框 1 到框 2 的选择框中添加和删除选项。这很好用。但是，当我尝试在添加新选项的框的 PHP 中 print_r 时，它不会显示。提交后我什至无法在资源上看到它。有什么解决办法吗？

```
$('#btn-add').click(function(){
    $('#select-from option:selected').each( function() {
            $('#select-to').append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>");
        $(this).remove();
    });
});
$('#btn-remove').click(function(){
    $('#select-to option:selected').each( function() {
        $('#select-from').append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>");
        $(this).remove();
    });
}); 
```

});

和两个选择列表的 html

```
 <select class="gen" name="selectfrom" id="select-from" multiple size="6" style="width: 150px;">

        </select>
        <input name="" id="btn-add" type="button" class="add_list" style="vertical-align: top;">
        &nbsp;&nbsp;
        <input name="" id="btn-remove" type="button" class="remove_list" style="vertical-align: top;">
        <select class="gen" name="selectto" id="select-to" multiple size="6" style="width: 150px;">
        </select> 
```

提交后，我从 selectto 框中检查 $_POST['selectto'] 。有任何想法吗？

编辑：php中的foreach；

```
 $articles_ary = array();
                            foreach ($_POST['selectto[]'] as $options)
                            {
                                if (!empty($options))
                                {
                                    $articles_ary[] = $options;
                                }
                            }

                            print_r($articles_ary); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:00:01.613

当您从一个选择框输入数据到第二个选择框时，您需要在第二个选择框中选择项目，以便在您在 php.ini 中执行 print_r 时显示。

为此，在将项目添加到第二个选择框后说 id selectbox2，然后您可以选择第二个选择框的所有项目，然后提交表单

```
for (var i = 0; i < selectbox2.options.length; i++) {
        selectbox2.options[i].selected = true;
}
//then Submit form like this, assuming your form name is form1
document.form1.submit(); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T17:08:10.083

当您`POST`选择表单时，仅提交选定的选项并记住必须选择它。使用您的代码，您只是将选项添加到`selectto`，但您不是：

*   a）选择其中一个（如果您想发布单个值）
*   b) 选择将它们全部发布在 PHP 页面上。（如果您想发布多个值）

在第二种情况下（我认为这是您需要的），您可以使用这个简单的 jQuery 函数：

```
$("#buttonusedtosendform").click(function(e){
    e.preventDefault();
    $('#select-to option').each( function() {
      $(this).attr('selected', true);  //with this you select all the option
    });
    $('formname').submit();
}); 
```

请记住，如果你想检索一个选择的所有选项，`PHP`你将不得不使用一个小技巧，通过在最后用方括号命名选择（这是 PHP 提供的一个功能，它将覆盖前一个变量最新分别解析每个）：例如。`selectto => selectto[]` 这样 php 会将它作为一个数组处理，并让您检索所有值，就好像它是一个一样：

```
foreach($_POST['selectto[]'] as $options){} 
```

# .net - 如何在 WPF 中检测鼠标左键双击？

> ID：11868956
> 
> 赞同：6
> 
> 时间：2012-08-08T16:27:27.333
> 
> 标签：.net, wpf

在 .NET 4.0 WPF 中，如何检测鼠标**左键**双击？

一个看似微不足道的任务。

我看不到`MouseDoubleClick`使用`System.Windows.Input.MouseButtonEventArgs`.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-08T16:30:23.433

`MouseDoubleClick``MouseButtonEventArgs`作为事件参数传递。这会公开[ChangedButton](http://msdn.microsoft.com/en-us/library/system.windows.input.mousebuttoneventargs.changedbutton.aspx)属性，该属性告诉您双击了哪个按钮。

```
void OnMouseDoubleClick(Object sender, MouseButtonEventArgs e)
{
    if (e.ChangedButton == MouseButton.Left)
    {
        // Left button was double clicked
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T16:30:40.690

你在找`MouseButtonEventArgs.ChangedButton`吗？API[在这里](http://msdn.microsoft.com/en-us/library/system.windows.input.mousebuttoneventargs.changedbutton.aspx)。

```
private void MouseButtonDownHandler(object sender, MouseButtonEventArgs e)
{
    Control src = e.Source as Control;

    if (src != null)
    {
        switch (e.ChangedButton)
        {
            case MouseButton.Left:
                src.Background = Brushes.Green;
                break;
            case MouseButton.Middle:
                src.Background = Brushes.Red;
                break;
            case MouseButton.Right:
                src.Background = Brushes.Yellow;
                break;
            case MouseButton.XButton1:
                src.Background = Brushes.Brown;
                break;
            case MouseButton.XButton2:
                src.Background = Brushes.Purple;
                break;
            default:
                break;
        }
    }
} 
```

# javascript - Jquery事件被多次调用

> ID：11868960
> 
> 赞同：0
> 
> 时间：2012-08-08T16:27:37.583
> 
> 标签：javascript, jquery, html

所以我有一个提交照片的表格（总共 8 张），我正在尝试应用一个小效果：一旦你选择了一张照片，按钮就会隐藏，文件名会显示出来，并带有一个要删除的“X”它的选择。

但是，当我添加多张照片并尝试删除一张照片时，该事件会被多次调用，并且我点击的次数越多，就会触发更多的多个事件，所有这些事件都来自同一个元素。

任何人都可以弄清楚吗？

```
var Upload =  {
    init: function ( config ) {
        this.config = config;
        this.bindEvents();
        this.counter = 1;
    },

    /**
     * Binds all events triggered by the user.
     */
    bindEvents: function () {
        this.config.photoContainer.children('li').children('input[name=images]').off();
        this.config.photoContainer.children('li').children('input[name=images]').on("change", this.photoAdded);
        this.config.photoContainer.children('li').children('p').children('a.removePhoto').on('click', this.removePhoto);
    },

    /**
     * Called when a new photo is selected in the input.
     */
    photoAdded: function ( evt ) {
        var self = Upload,
            file = this.files[0];
        $(this).hide();
        $(this).parent().append('<p class="photo" style="background-color: gray; color: white;">' + file.name + ' <a class="removePhoto" style="color: red;" href="#">X</a></p>');

        if(self.counter < 8) {  // Adds another button if needed.
            Upload.config.photoContainer.append( '<li><input type="file" name="images"></li>');
            self.counter++;
        } 
        Upload.bindEvents();
    },

    /**
     * Removes the <li> from the list.
     */
    removePhoto: function ( evt ) {
        var self = Upload;
        evt.preventDefault();

        $(this).off();
        $(this).parent().parent().remove();

        if(self.counter == 8) { // Adds a new input, if necessary.
            Upload.config.photoContainer.append( '<li><input type="file" name="images"></li>');
        }
        self.counter--;
        Upload.bindEvents();
    }
}

Upload.init({
    photoContainer: $('ul#photo-upload')
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:49:30.730

据我所知，您正在尝试根据用户选择附加/删除事件处理程序。这是低效的并且容易出错。

`Upload.bindEvents()`在您的情况下，每次添加照片时您都在调用，而无需清除所有先前的处理程序。您可能可以调试，直到您不再泄漏事件侦听器，但这不值得。

[jQuery.on](http://api.jquery.com/on/)非常强大，它允许您将处理程序附加到尚未在 DOM 中的元素。你应该能够做这样的事情：

```
init: function ( config ) {
  this.config = config;
  this.counter = 1;
  this.config.photoContainer.on('change', 'li > input[name=images]', this.photoAdded);
  this.config.photoContainer.on('click', 'li > p > a.removePhoto', this.removePhoto);
}, 
```

您只需将一个处理程序附加到`photoContainer`，它将捕获从子级冒泡的所有事件，无论何时添加。如果要禁用其中一个元素的处理程序，只需删除`removePhoto`该类（使其与过滤器不匹配）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T16:46:42.107

你做了很多： Upload.bindEvents();

在再次绑定它们之前，您需要取消绑定这些 'li's 的事件。否则，您将添加更多点击事件。这就是为什么您会看到越来越多的点击被触发。

# objective-c - 变量参数列表 - 内存管理错误

> ID：11868961
> 
> 赞同：0
> 
> 时间：2012-08-08T16:27:49.510
> 
> 标签：objective-c, ios, nsarray, variadic-functions

我正在尝试创建一种从 va_list 快速轻松地创建 NSArray 的方法，但是，当我运行该方法时，由于某处的内存管理不善，我收到了 exc_bad_access，尽管我无法确定这个地方在哪里。

请您看一下代码并告诉我发生这种情况的位置和原因。

先谢谢了，

最大限度。

```
NSArray *arrayCreate(id firstObject, ...) {
    NSMutableArray *objects = [NSMutableArray array];
    [objects addObject:firstObject];
    va_list args;
    va_start(args, firstObject);
    id arg;
    while ((arg = va_arg(args, id))) {
        [objects addObject:arg];
    }
    va_end(args);
    return [objects copy];
} 
```

用法（只是为了测试它是否有效）：

```
NSLog(@"%@", arrayCreate(@"1", @"2", @"3", @"4")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:38:12.513

你忘了`nil`-terminate 你的 arglist。在 C 中，函数无法知道您传递了多少可变参数，因此通常以空指针结束一系列指针（表示不再有有效输入。）您的代码似乎正在检查这个（`arg = va_arg(args, id)`将是 false当它到达`nil`) 但您的输入缺少它。

# python - 在 PIL 中使用 TIFF G4 图像

> ID：11868963
> 
> 赞同：1
> 
> 时间：2012-08-08T16:27:51.913
> 
> 标签：python, python-imaging-library, tiff

我写了一个纯 python TIFF G4 解压缩用于`tifffile.py`. 我知道有一些方法可以添加`libtiff`到自定义 PIL，但我永远无法在混合的 virtualenv 中很好地工作。我想在 PIL 中操作图像。我正在寻找将我的解压器挂接到 PIL 的指针`TiffImagePlugin.py`。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T04:54:58.903

看来这`TiffImagePlugin`不容易让我挂上额外的减压器。用解码器字典替换`TiffImageFile._decoder`可能有效，但您必须检查和测试 PIL 的每个版本以确保它没有损坏。这种级别的维护与自定义 PIL 一样糟糕。我很欣赏`tifffile.py`使用解码器字典的设计。这很容易。

最终解决方案？我无法将我的代码挂接到 PIL 中。我不得不`PIL.Image.fromarray()`习惯使用我的解压缩图像。

# python - 列表理解：为每个项目返回两个（或更多）项目

> ID：11868964
> 
> 赞同：112
> 
> 时间：2012-08-08T16:27:53.190
> 
> 标签：python, list-comprehension

**是否可以为列表理解中的每个项目返回 2 个（或更多）项目？**

我想要的（示例）：

```
[f(x), g(x) for x in range(n)] 
```

应该返回`[f(0), g(0), f(1), g(1), ..., f(n-1), g(n-1)]`

所以，要替换这段代码：

```
result = list()
for x in range(n):
    result.add(f(x))
    result.add(g(x)) 
```

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-08-08T16:50:19.243

双重列表理解：

```
[f(x) for x in range(5) for f in (f1,f2)] 
```

演示：

```
>>> f1 = lambda x: x
>>> f2 = lambda x: 10*x

>>> [f(x) for x in range(5) for f in (f1,f2)]
[0, 0, 1, 10, 2, 20, 3, 30, 4, 40] 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-08-08T16:29:44.073

```
>>> from itertools import chain
>>> f = lambda x: x + 2
>>> g = lambda x: x ** 2
>>> list(chain.from_iterable((f(x), g(x)) for x in range(3)))
[2, 0, 3, 1, 4, 4] 
```

时间：

```
from timeit import timeit

f = lambda x: x + 2
g = lambda x: x ** 2

def fg(x):
    yield f(x)
    yield g(x)

print timeit(stmt='list(chain.from_iterable((f(x), g(x)) for x in range(3)))',
             setup='gc.enable(); from itertools import chain; f = lambda x: x + 2; g = lambda x: x ** 2')

print timeit(stmt='list(chain.from_iterable(fg(x) for x in range(3)))',
             setup='gc.enable(); from itertools import chain; from __main__ import fg; f = lambda x: x + 2; g = lambda x: x ** 2')

print timeit(stmt='[func(x) for x in range(3) for func in (f, g)]',
             setup='gc.enable(); f = lambda x: x + 2; g = lambda x: x ** 2')

print timeit(stmt='list(chain.from_iterable((f(x), g(x)) for x in xrange(10**6)))',
             setup='gc.enable(); from itertools import chain; f = lambda x: x + 2; g = lambda x: x ** 2',
             number=20)

print timeit(stmt='list(chain.from_iterable(fg(x) for x in xrange(10**6)))',
             setup='gc.enable(); from itertools import chain; from __main__ import fg; f = lambda x: x + 2; g = lambda x: x ** 2',
             number=20)

print timeit(stmt='[func(x) for x in xrange(10**6) for func in (f, g)]',
             setup='gc.enable(); f = lambda x: x + 2; g = lambda x: x ** 2',
             number=20) 
```

> 2.69210777094
> 
> 3.13900787874
> 
> 1.62461071932
> 
> 25.5944058287
> 
> 29.2623711793
> 
> 25.7211849286

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-08T16:34:14.073

```
sum( ([f(x),g(x)] for x in range(n)), [] ) 
```

这相当于`[f(1),g(1)] + [f(2),g(2)] + [f(3),g(3)] + ...`

您也可以将其视为：

```
def flatten(list):
    ...

flatten( [f(x),g(x)] for x in ... ) 
```

注意：正确的方法是使用`itertools.chain.from_iterable`或双重列表推导。（它不需要在每个 + 上重新创建列表，因此具有 O(N) 性能而不是 O(N^2) 性能。）`sum(..., [])`当我想要一个快速的单线或我赶时间时，我仍然会使用，或者当组合项的数量是有限的（例如<= 10）。这就是为什么我仍然在这里提到它，并提出警告。您还可以使用元组：（`((f(x),g(x)) for ...), ()`或根据 khachik 的评论，有一个生成器 fg(x) 产生一个二元组）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-07-04T04:38:31.520

我知道 OP 正在寻找一个列表理解解决方案，但我想提供一个使用`list.extend()`.

```
f = lambda x: x
g = lambda x: 10*x

result = []
extend = result.extend
for x in range(5):
    extend((f(x),g(x))) 
```

这比使用双重列表理解要快一些。

```
nums = range(100000)

def double_comprehension():
    return [func(x) for x in nums for func in (f,g)]

def list_extend():
    result = []
    extend = result.extend
    for x in nums:
        extend((f(x),g(x)))
    return result

%timeit -n100 double_comprehension()
23.4 ms ± 67 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)

%timeit -n100 list_extend()
20.5 ms ± 213 µs per loop (mean ± std. dev. of 7 runs, 100 loops each) 
```

Python版本：3.8.0

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-26T16:15:10.620

这个 lambda 函数将两个列表压缩成一个：

```
zipped = lambda L1, L2: [L[i] 
                         for i in range(min(len(L1), len(L2))) 
                         for L in (L1, L2)] 
```

例子：

```
>>> f = [x for x in range(5)]
>>> g = [x*10 for x in range(5)]
>>> zipped(f, g)
[0, 0, 1, 10, 2, 20, 3, 30, 4, 40] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-24T21:10:03.277

使用[reduce](https://docs.python.org/3/library/functools.html#functools.reduce)的解决方案：

```
from functools import reduce

f    = lambda x: f"f({x})" ## Just for example
g    = lambda x: f"g({x})"
data = [1, 2, 3]

reduce(lambda acc, x: acc + [f(x), g(x)], data, [])
# => ['f(1)', 'g(1)', 'f(2)', 'g(2)', 'f(3)', 'g(3)'] 
```

这是解决问题的一种实用方法。列表推导本质上是另一种`map`处理数据的方式，但在这种情况下，输入和输出之间的映射不是一对一的，这为`reduce`如何生成输出提供了一些回旋余地。

一般来说，任何`for`形式的实现：

```
result = []
for n in some_data:
  result += some_operation()
  ## etc. 
```

[（即用于对列表或类似数据结构产生副作用的循环，[累加器模式](https://gist.github.com/the-vampiire/923bd634fbabd5b4a0fc25aeb48bd37d#the-accumulator-pattern)）]

可以重构为声明式`map/reduce/filter`实现。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2021-03-26T18:01:50.873

善良，悲伤！为什么所有这些 lambdas、flattens、zips 和 sum？这不是最简单和最易读的：

```
>>> [v
...  for x in range(5)
...      for v in (2 * x,
...                2 * x + 1)]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> 
```

`f(x)`（用and`g(x)`或其他替换最后两个表达式。）

# objective-c - 无法加载“TweetSheetLocationArrow.png”图像... Twitter/Social Framework for iOS

> ID：11868966
> 
> 赞同：0
> 
> 时间：2012-08-08T16:27:59.840
> 
> 标签：objective-c, ios, xcode, twitter

我在我的 iOS 应用程序中使用 Twitter 和社交框架。几天来我一直在使用相同的框架，没有任何问题。但是，今天当我在模拟器中运行应用程序（没有更改任何 Twitter 或社交特定代码）时，当我尝试从我的应用程序发送推文时收到以下错误：

```
Could not load the "TweetSheetLocationArrow.png" image referenced from a nib in the bundle with identifier "com.apple.sociald.Social" 
```

知道这个问题与什么有关，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:32:11.673

忽略它。它是设备模拟器中缺少的图像资产，并且是无害的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:34:46.473

推文表希望在运行时从具有指定包标识符的 nib 包中获取资源“TweetSheetLocationArrw.png”（如果这对您没有任何意义，请谷歌“苹果包编程指南”）并且它要么无法读取资源，或资源不再存在。

# asp.net-mvc - 当用户没有选择任何值时，DropDownListFor 抛出异常

> ID：11868967
> 
> 赞同：0
> 
> 时间：2012-08-08T16:28:10.803
> 
> 标签：asp.net-mvc, razor

当用户提交表单而未选择以下任何值时，我遇到了异常`dropdownlistfor`：

```
 <div class="editor-field">
        @Html.DropDownListFor(
            x => x.TypeID,
            new SelectList(ViewBag.EventType, "ID", "Name"),
            "-- Select Event Type --"
            )
        @Html.ValidationMessageFor(model => model.TypeID)
    </div> 
```

我有一个例外：

> *值不能为空。参数名称：items*

我想我必须检查用户是否选择了一个值或发出警报，但我不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T16:29:49.360

`TypeID`如果您想处理下拉列表 ( ) 中未选择的情况，您应该为视图模型上的属性使用可为空的类型`"-- Select Event Type --"`：

```
public int? TypeID { get; set; } 
```

您收到异常是因为如果用户未在下拉列表中选择任何选项，则使用默认选项：

```
<option value="">"-- Select Event Type --"</option> 
```

请注意该值如何为空字符串。这显然不能绑定到模型上的不可为空的整数类型。

# list - 在 Sharepoint 中创建列表需要很长时间

> ID：11868968
> 
> 赞同：0
> 
> 时间：2012-08-08T16:28:19.350
> 
> 标签：list, sharepoint, templates, exception, sharepoint-2010

我尝试在 Sharepoint 中清除一个非常大的列表。由于 Sharepoints 删除机制缓慢，我决定从该列表中保存一个模板（没有数据），删除该列表，然后从该模板创建一个新列表。代码如下：

```
public static void TruncateList(SPList list)
{
   SPSecurity.RunWithElevatedPrivileges(delegate()
   {
      using (SPSite site = new SPSite(list.ParentWeb.Site.ID))
      {
         using (SPWeb web = site.OpenWeb())
         {            
               web.AllowUnsafeUpdates = true;
               SPList listCopy = web.Lists[list.ID];
               string title = listCopy.Title;
               string description = listCopy.Description;
               string backupName = string.Format("BACKUP_{0}", title);

               // Delete old Template if exists:
               SPList gallery = web.Lists["List Template Gallery"];
               foreach (SPListItem item in gallery.Items)
               {
                  if (item.Title == backupName)
                  {
                     item.Delete();
                     break;
                  }
               }

               // Save Template:
               listCopy.SaveAsTemplate(backupName, backupName, string.Empty, false);

               // Load Template:
               SPListTemplate template = web.Site.GetCustomListTemplates(web)[backupName];
               template = web.ListTemplates[backupName];

               // Delete List:
               listCopy.Delete();   

               // Add empty List from Template:   [HANGS HERE!]                                                        
               web.Lists.Add(title, description, template);

               web.Update();
               web.AllowUnsafeUpdates = false;
         }
         );
        }
    }
} 
```

保存模板工作正常以及删除需要一段时间的原始列表 (listCopy.Delete())

但是当尝试再次创建该列表（web.Lists.Add）时，服务器卡住了，直到几分钟后它得到一个超时异常。

值得一提的是：这是我的开发者机器。除了我之外，没有人正在访问该网络/列表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:45:22.430

自己解决：

问题是我使用该列表（“列表”）作为参数。我将其更改为仅将该列表的 ID 发送到该方法并使用

```
using (SPWeb web = SPContext.Current.Web) 
```

里面。现在它起作用了。

# javascript - 如何在我编写的 JavaScript 中重构 Ruby 的 #{} 方法

> ID：11868969
> 
> 赞同：0
> 
> 时间：2012-08-08T16:28:21.950
> 
> 标签：javascript

在写Javascript代码的时候，感觉很怀念Ruby的#{}方法，所以我用JS来实现。但是这段代码并不干净漂亮。我想让这种方法安全，但我做不到。
你知道这段代码是安全的还是美观的？提前致谢。

```
String.prototype.to_s = function(){
    var str = this.toString();

    // convert function is bad  because it use eval...
    var convert = function(s){
        return eval(s);
    };

    // It's slower because call ReGexp method too many times.
    while(/#{(\w+)}/.test(str)){

        var matchStr =RegExp.$1;

        var str = str.replace(/#{(\w+)}/,convert(matchStr));

    }
    return str;
};

var name = "nobi";

var age = 23;

var body = "I'm #{name} and I am #{age} years old".to_s();
// I'm nobi and I am 23 years old.

console.log(body); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T16:30:33.813

这种 hack 不能变得“漂亮”——它甚至不适用于非全局变量。但是，鉴于 ES6 支持，您不需要 hack。字符串插值现在是语言的一部分。

```
var body = `I'm ${name} and I am ${age} years old`; 
```

如果做不到这一点，字符串连接通常在 ES5 及更早版本中是可读的：

```
var body = "I'm " + name + " and I am " + age + " years old"; 
```

[CoffeeScript](http://coffeescript.org/)是一种编译为 JavaScript 的语言，也支持此功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T16:34:17.693

与您想要的最接近的是模板系统，例如[**mustache**](https://github.com/janl/mustache.js)。它使您可以执行以下操作：

```
var person = {
  name: "nobi",
  age: 23
};

var output = Mustache.render("I'm {{name}} and I am {{age}} years old.", person); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T16:32:31.700

或者使用咖啡脚本。

[http://coffeescript.org/#strings](http://coffeescript.org/#strings)

也不`#{}`是Ruby中的方法，它被称为“字符串插值”。

[http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation)

# flash - 访问 flowplayer.unlimited-3.2.7.swf 文件时出现 404-page not found 错误

> ID：11868971
> 
> 赞同：0
> 
> 时间：2012-08-08T16:28:23.850
> 
> 标签：flash

我有一个在网络上播放视频的应用程序。它使用 flowplayer.unlimited-3.2.7.swf 来播放它，并具有其他相关的字幕和音频 swf 文件。我们可以在我们的域中的应用程序中播放它，比如 www.aaa.com/.../flowplayer-unlimited.swf。但是，我们有一个功能，用户可以创建一个 iframe，其中 url 指向不同的站点，比如 w.playvid.com，将其保存到文件中，然后打开文件，单击它指向的 URL它到 w.playvid.com..../flowplayer-unlimited.swf，此时它应该开始播放视频。但是，我遇到了 404 - page not found 错误。我认为这可能与闪存设置或权限有关，但我不确定究竟是什么或如何解决这个问题。

此外，我可以从外部 URL iewplayvid.com 访问与 flowplayer 相同的文件夹中的图像文件。

任何指针将不胜感激。

提前致谢，

阿莎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:15:57.200

`404`我的文件出现错误时遇到问题`flowplayer.swf`，这与我的`.htaccess`文件有关。

您是否正在使用 CodeIgniter 并重写 URL 以将`index.php`引用放入您的 URL 中？

如果是这样，问题可能是由于您的`.htaccess`文件将 Flash 文件映射到包含`index.php`.

祝你好运。

# magento - Magento 和 Paypal 税收四舍五入问题

> ID：11868985
> 
> 赞同：5
> 
> 时间：2012-08-08T16:29:06.547
> 
> 标签：magento, paypal, rounding

我对 Paypal 和 Magento 1.7.0.2 有一些四舍五入的问题 - 网站上的所有价格均含税，税费为 20%（增值税）。

我会去结帐，一切都是正确的：

![在此处输入图像描述](../Images/181b965eef38d1e818c06f19f9ea3dbe.png)

然后我会点击下订单，Paypal 会是这样，这是不正确的，因为现在总计少了 1 便士。这似乎是由于税收是如何四舍五入的。

![在此处输入图像描述](../Images/16cb201224f2e957fbce51f154b68b93.png)

在某些情况下，它可以正常工作，但在其他情况下，税收四舍五入不正确。我已尝试更改app/code/core/Mage/Tax/Model/Calculation.php中的税收计算方法**calcTaxAmount()**

我将此添加到似乎可以修复它的 calcTaxAmount 方法中，但它会导致产品页面上的价格不正确（少 1 便士）。

`$amount = $this->roundUp($amount);`

我很确定这是一个错误，但我没有想法。如果有人以前遇到过这种情况并有解决方案，我会很高兴听到它。非常感谢任何帮助。

**编辑：这是我在 Magento 中的税收设置**

![在此处输入图像描述](../Images/fbf51fd61ec02b788d7a74af4d4204f3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:25:57.380

我今天为我的客户“修复”了这个问题，但对解决方案并不满意。但它有效。

最好将此文件复制到本地文件夹：app/code/core/Mage/Paypal/Model/Api/Nvp.php

我在第 606 行添加了这段代码（仅用于快速结帐），所以它看起来像这样。

```
$request['SHIPPINGAMT'] = ($request['AMT'] - ($request['TAXAMT'] + $request['ITEMAMT']));

$response = $this->call(self::SET_EXPRESS_CHECKOUT, $request);
$this->_importFromResponse($this->_setExpressCheckoutResponse, $response); 
```

并且您需要在后端的 paypal moule 中打开 Transfer Cart Line Items

如果有人知道更好的解决方案，那么只需覆盖运费让我知道

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T12:43:35.757

这个问题一直困扰着我（从外观上看，magento 社区已经很久了），这要归功于 ShopWorks 朝着正确的方向推进（包括他的代码片段，谢谢队友！但是，如果从 express 回到购物车，它会出错结帐，添加了一个签入以防止这种情况发生。）$request 参数我想出了以下修复（/hack）：

在 Nvp.php 的第 606 行放置以下内容：

```
$totalValue = $request['TAXAMT'] + $request['ITEMAMT'];
$finalValue = $totalValue - $request['AMT'];

if($request['SHIPPINGAMT'] > 0) {
    $request['SHIPPINGAMT'] = ($request['AMT'] - ($request['TAXAMT'] + $request['ITEMAMT']));
    $totalValue = $request['TAXAMT'] + $request['ITEMAMT'] + $request['SHIPPINGAMT'];
    $finalValue = $totalValue - $request['AMT'];
}

if($request['AMT'] != $totalValue) {
    if($totalValue > $request['AMT']) {
        $request['TAXAMT'] = $request['TAXAMT'] - $finalValue;
    } elseif($totalValue < $request['AMT']) {
        $request['TAXAMT'] = $request['TAXAMT'] + $finalValue;
    } else {
        $request['AMT'] = $request['TAXAMT'] + $request['ITEMAMT'];
    }
} 
```

此外，还需要在 call() 函数中放置以下内容（Nvp.php 的第 938 行）：

```
$totalValue = $request['TAXAMT'] + $request['ITEMAMT'] + $request['SHIPPINGAMT'];
$finalValue = $totalValue - $request['AMT'];

if($request['AMT'] != $totalValue) {
    if($totalValue > $request['AMT']) {
        if($finalValue > 0) {
            // its preferable that we change the tax amount over the grand total amount
            $request['TAXAMT'] = $request['TAXAMT'] - $finalValue;
        } else {
            $request['AMT'] = $totalValue;
        }
    } elseif($totalValue < $request['AMT']) {
        if($finalValue > 0) {
            // its preferable that we change the tax amount over the grand total amount
            $request['TAXAMT'] = $request['TAXAMT'] + $finalValue;
        } else {
            $request['AMT'] = $totalValue;
        }
    } else {
        $request['AMT'] = $totalValue;
    }
} 
```

这是一个 hack，并这样对待它。我的同事目前正在测试，但目前似乎还可以，按单价设置计税方法也很有帮助（我们的会计师对这种安排很满意，但这是针对英国的，我不确定是否其他国家会不赞成这种特定的税收计算方法）。

我操作 $request['AMT'] 的原因是因为有时 $finalValue 变量的计算会产生一个 -0.9999 重复整数，这对任何人都没有用，我的数学很烂，所以如果有人想改进这个，请这样做！

一如既往不要覆盖核心目录中的 nvp.php，创建一个单独的重写模块或在 app/local/mage 中执行此操作。首选首选！:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T07:38:50.973

我想我已经找到了解决这个困扰社区的问题的方法。

如果您的价格包含税，则税款计算是错误的。

这是修复 - 在 Mage_Tax_Model_Calculation::calcTaxAmount() 中：

改变条件：

```
if ($priceIncludeTax)... 
```

至：

```
if ( ! $priceIncludeTax ) ... 
```

所以条件看起来像：

```
if ( ! $priceIncludeTax ) { 
    $amount = $price*(1-1/(1+$taxRate)); 
} else { 
    $amount = $price*$taxRate; 
} 
```

有关详细信息，请查看我的评论： http: [//www.magentocommerce.com/boards/viewthread/247201/P45/](http://www.magentocommerce.com/boards/viewthread/247201/P45/)

记住不要修改核心文件 - 在本地创建一个副本

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-13T17:22:39.983

在 magento 模块中的 Paypal 上有一个“错误”（至少在我的 Magento 1.8.0 上）；它驻留在`Mage_Paypal_Model_Cart`类中。

为了验证金额是否正确，第`_validate()`381 行的方法汇总了订单中的所有商品价格，加上运费和税金，并将结果与​​订单的总价值（从 order 方法获得`getBaseGrandTotal()`）进行比较

但有时，金额之间存在 0.009999999999999999 的差异（它必须来自不同的舍入方法，我不知道）；所以这些项目无效，第`getItems()`146 行的方法返回 false。

就我而言，这导致客户支付不同的金额，并在他们的订单上打上“欺诈嫌疑”标志。

我通过更改比较方法（第 404 行）来修复它：

```
if (sprintf('%.4F', $sum) == sprintf('%.4F', $referenceAmount)) {
    $this->_areItemsValid = true;
} 
```

至

```
$diff = abs(sprintf('%.4F', $sum) - sprintf('%.4F', $referenceAmount));

if ($diff < 0.01) {
     $this->_areItemsValid = true;
} 
```

还是希望以后的diffs不要超过0.009999999...

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-29T20:07:18.520

我正在使用 CE1.7.0.2 并且已经被这个问题困扰了好几天，尝试了几种解决方案，最后找到了 Adam Hall 的修复/破解。理想对我来说看起来很合理，所以我将它应用到我的网站上，一切都很顺利，直到今天早上，我意识到税额调整不适合我们的情况。

我们在加利福尼亚州，在全州销售东西，加利福尼亚州的客户将被收取销售税，而其他人则不会。因此，当税额为零并且必须减去差额时，它将产生一个负税额，这显然会被贝宝拒绝。所以当从税额中减去差额时，我添加了一个条件语句

```
if ($request['TAXAMT'] > 0) {
    $request['TAXAMT'] = $request['TAXAMT'] - $finalValue;
} else {
    $request['SHIPPINGAMT'] = $request['SHIPPINGAMT'] - $finalValue;
} 
```

如果税额为零，我将调整运费而不是税额。（当然如果税和运费都是免费的，这是行不通的，但我认为这不会在实际业务中发生。）希望这可以帮助那些和我们有同样问题的人。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-01-21T04:28:43.590

我只是将转移购物车行项目更改为“否”，而没有更改上述代码..它起作用了。

Magento 1.9.0.1

仅供参考 - 测试它是否适合您。

德米特罗

# apache - Apache 代理负载均衡后端服务器故障检测

> ID：11868988
> 
> 赞同：16
> 
> 时间：2012-08-08T16:29:09.760
> 
> 标签：apache, load-balancing, detection, reverse-proxy, failover

这是我的场景（由我的前任设计）：

两台 Apache 服务器为多个混合后端 Web 服务器（Apache、IIS、Tomcat 等）提供反向代理服务。有些网站我们有多个后端 Web 服务器，在这些情况下，我们会执行以下操作：

```
<Proxy balancer://www.example.com>
    BalancerMember http://192.168.1.40:80
    BalancerMember http://192.168.1.41:80
</Proxy>
<VirtualHost *:80>
    ServerName www.example.com:80
    CustomLog /var/log/apache2/www.example.com.log combined
    <Location />
        Order allow,deny
        Allow from all
        ProxyPass balancer://www.example.com/
        ProxyPassReverse balancer://www.example.com/
    </Location>
</VirtualHost> 
```

所以在这个例子中，我在代理服务器的配置中有一个站点 (www.example.com)，该站点被代理到两个后端服务器中的一个或另一个，192.168.1.40 和 .41。

我正在对此进行评估，以确保我们对所有 Web 服务都具有容错性（为此，我已经将两个反向代理服务器放入共享 IP 集群），并且我想确保负载-平衡的后端服务器也是容错的。但是我无法确定后端故障检测（以及避免后端服务器故障的逻辑）是否内置在 mod_proxy_balancer 模块中......

因此，如果 192.168.202.40 出现故障，Apache 是否会检测到这一点（我会理解它是否首先接受失败的请求）并自动将所有请求路由到另一个后端 192.168.202.41？或者它会继续平衡失败的后端和操作后端之间的请求吗？

我在 Apache 文档中找到了一些关于[mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass)和[mod_proxy_balancer](http://httpd.apache.org/docs/2.2/mod/mod_proxy_balancer.html#stickyness_implementation)的线索，这些线索似乎表明可以检测到故障（“maxattempts = 放弃前的最大故障转移尝试次数。”、“failonstatus = 单个或逗号分隔的 HTTP 列表状态码。如果设置这将在后端返回列表中的任何状态码时强制工作人员进入错误状态。”），但经过几天的搜索，我没有发现任何结论性的说法可以肯定它*会*（或在至少“应该”）检测后端故障和恢复。

我会说大多数搜索结果引用使用 AJP 协议将流量传递到后端服务器，这显然确实支持故障检测 - 但我的后端是 Apache、IIS、Tomcat 和其他的混合体，我是相当肯定他们中的许多人不支持AJP。它们也是 Windows 2k3/2k8 和 Linux（主要是 Ubuntu Lucid）机器的混合体，运行具有各种不同要求的各种不同应用程序，因此像 Backhand 和 LVS 这样的附加模块不适合我。

我还尝试通过创建这样的新测试站点来经验性地测试此功能：

```
<Proxy balancer://test.example.com>
    BalancerMember http://192.168.1.40:80
    BalancerMember http://192.168.1.200:80
</Proxy>
<VirtualHost *:80>
    ServerName test.example.com:80
    CustomLog /var/log/apache2/test.example.com.log combined
    LogLevel debug
    <Location />
        Order allow,deny
        Allow from all
        ProxyPass balancer://test.example.com/
        ProxyPassReverse balancer://test.example.com/
    </Location>
</VirtualHost> 
```

其中 192.168.1.200 是一个没有运行任何 Web 服务器的虚假地址，用于模拟后端故障。为一堆不同的客户端机器提供了测试站点没有问题，但即使将 LogLevel 设置为调试，我也没有看到任何记录表明它检测到一个后端服务器已关闭......并且我想 100% 确保我可以在不影响生产站点的情况下关闭负载平衡的后端进行维护（当然，一次一个）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-30T15:49:46.970

[http://httpd.apache.org/docs/2.4/mod/mod_proxy.html](http://httpd.apache.org/docs/2.4/mod/mod_proxy.html) “BalancerMember 参数”部分，property=retry：

> 如果后端服务器的连接池工作程序处于错误状态，则 Apache httpd 不会将任何请求转发到该服务器，直到超时到期。这使 [one] 可以关闭后端服务器进行维护，并在稍后将其重新联机。值 0 意味着总是在没有超时的情况下重试处于错误状态的工作人员。

但是，使用 mod_whatever 不会捕获其他故障情况，例如，运行已关闭应用程序的 IIS 后端。IIS 已启动，因此可以建立连接并读取页面，只是该页面将始终是 500 内部服务器错误。在这里，您将不得不使用 failonerror 来捕获它并强制工作人员进入错误状态。

在所有情况下，一旦工作人员处于错误状态，流量将不会被定向到它。我一直在尝试不同的方式来处理第一次失败并重试它，但似乎总是存在错误页面将其返回给客户端的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-25T20:18:04.930

“BalancerMember 参数”中有一个属性“ping”

阅读文档，听起来“ping”设置为 500ms 会在 mod_proxy 将您定向到 BalancerMember 之前发送请求。mod_proxy 将等待来自 BalancerMember 的响应 500 毫秒，如果 mod_proxy 没有得到响应，它会但 BalancerMember 进入错误状态。

我厌倦了实现这一点，但它似乎对引导到现场 BalancerMember 没有帮助。

```
<Proxy balancer://APICluster>
    BalancerMember https://api01 route=qa-api1 ttl=5 ping=500ms
    BalancerMember https://api02 route=qa-api2 ttl=5 ping=500ms
    ProxySet lbmethod=bybusyness stickysession=ROUTEID
</Proxy> 
```

[http://httpd.apache.org/docs/2.4/mod/mod_proxy.html](http://httpd.apache.org/docs/2.4/mod/mod_proxy.html)

> Ping 属性告诉网络服务器在转发请求之前“测试”与后端的连接。对于 AJP，它会导致 mod_proxy_ajp 在 ajp13 连接上发送一个 CPING 请求（在 Tomcat 3.3.2+、4.1.28+ 和 5.0.13+ 上实现）。对于 HTTP，它会导致 mod_proxy_http 向后端发送 100-Continue（仅对 HTTP/1.1 有效 - 对于非 HTTP/1.1 后端，此属性无效）。在这两种情况下，参数都是等待回复的延迟时间（以秒为单位）。添加此功能是为了避免后端挂起和繁忙的问题。这将增加正常操作期间的网络流量，这可能是一个问题，但如果某些集群节点关闭或忙碌，它会降低流量。通过添加 ms 的后缀，延迟也可以设置为毫秒。

# c# - C# MVC2：如何获取下拉列表的选定值

> ID：11868990
> 
> 赞同：2
> 
> 时间：2012-08-08T16:29:16.670
> 
> 标签：c#, asp.net-mvc-2, cascadingdropdown

我正在尝试将开发不佳的 C# Web 应用程序转换为 MVC2，并且在尝试构建级联下拉列表时遇到了困难。这是代码：

```
public IEnumerable<SelectListItem> SchoolList
    {
        get
        {
            DataTable dt = ClassModels.GetSchools();
            List<SelectListItem> list = new List<SelectListItem>();
            foreach (DataRow row in dt.Rows)
            {
                list.Add(new SelectListItem
                {
                    Text = Convert.ToString(row["School"]),
                    Value = Convert.ToString(row["SID"]),
                });
            }
            return list;
        }
    }

    public IEnumerable<SelectListItem> DepartmentList
    {
        get
        {
            DataTable dt = DomData.GetDepartments(this is where the selected SID goes)
            List<SelectListItem> list = new List<SelectListItem>();
            foreach (DataRow row in dt.Rows)
            {
                list.Add(new SelectListItem
                {
                    Text = Convert.ToString(row["Department"]),
                    Value = Convert.ToString(row["DID"]),
                });
            }
            return list;
        }
    } 
```

这是部门的模型

```
public static DataTable GetDepartments(int id)
    {
        string sql = string.Format(@"SELECT d.department, d.did
            FROM dept d
            WHERE d.did IN (SELECT DISTINCT(DID) FROM CDS WHERE SID = '{0}')
            ORDER BY department", id);

        DataTable db_table = new DataTable("departments");
        SqlDataAdapter db_adapter = new SqlDataAdapter(sql, iau_conxn_string);

        db_adapter.Fill(db_table);
        //ddl_dep.DataSource = db_table;
        //ddl_dep.DataValueField = "did";
        //ddl_dep.DataTextField = "department";
        //ddl_dep.DataBind();
        return db_table;
    } 
```

可悲的是，我必须在没有 AJAX 或 jQuery 的情况下这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:55:23.367

由于您不能使用 AJAX 而只能使用纯 javascript，因此您可以订阅第一个下拉列表的 onchange 事件，然后提交表单以填充第二个下拉列表。

但在将其付诸实践之前，让我们先定义一个视图模型。在我的示例中，我显然会消除您问题中存在的所有噪音（诸如 DataTables 和数据访问特定代码之类的东西，并简单地对值进行硬编码，以便答案更通用，因此只需将这些硬编码值替换为对您的数据的调用访问方法）：

```
public class MyViewModel
{
    public MyViewModel()
    {
        Departments = Enumerable.Empty<SelectListItem>();
    }

    public int? SchoolId { get; set; }
    public IEnumerable<SelectListItem> SchoolList
    {
        get
        {
            // TODO: fetch the schools from a DB or something
            return new[]
            {
                new SelectListItem { Value = "1", Text = "school 1" },
                new SelectListItem { Value = "2", Text = "school 2" },
            };
        }
    }

    public int? DepartmentId { get; set; }
    public IEnumerable<SelectListItem> Departments { get; set; }
} 
```

然后是控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View(new MyViewModel());
    }

    [HttpPost]
    public ActionResult Departments(MyViewModel model)
    {
        // TODO: use model.SchoolId to fetch the corresponding departments
        // from your database or something
        model.Departments = new[]
        {
            new SelectListItem { Value = "1", Text = "department 1 for school id " + model.SchoolId },
            new SelectListItem { Value = "2", Text = "department 2 for school id " + model.SchoolId },
            new SelectListItem { Value = "3", Text = "department 3 for school id " + model.SchoolId },
        };
        return View("Index", model);
    }
} 
```

最后是一个观点：

```
<%@ Page 
    Language="C#" 
    Inherits="System.Web.Mvc.ViewPage<MyViewModel>" 
%>
<% using (Html.BeginForm(null, null, FormMethod.Post, new { id = "myform", data_departments_url = Url.Action("Departments") })) { %>
    <div>
        <%= Html.LabelFor(x => x.SchoolId) %>
        <%= Html.DropDownListFor(
            x => x.SchoolId, 
            Model.SchoolList, 
            "-- School --",
            new { id = "school" }
        ) %>
    </div>

    <div>
        <%= Html.LabelFor(x => x.DepartmentId) %>
        <%= Html.DropDownListFor(
            x => x.DepartmentId, 
            Model.Departments,
            "-- Department --"
        ) %>
    </div>
<% } %> 
```

最后一点当然是javascript订阅第一个下拉列表的onchange事件并将表单提交到服务器以填充第二个下拉列表：

```
window.onload = function () {
    document.getElementById('school').onchange = function () {
        if (this.value) {
            var form = document.getElementById('myform');
            form.action = form.getAttribute('data-departments-url');
            form.submit();
        }
    };
}; 
```

对于那些没有与您相同的约束并且可以使用 AJAX 和 jQuery 的人，请查看以下答案：[https ://stackoverflow.com/a/4459084/29407](https://stackoverflow.com/a/4459084/29407)

# biztalk - 将未解析的 HL7 2.x 消息存储到 sql 数据库中

> ID：11868995
> 
> 赞同：0
> 
> 时间：2012-08-08T16:29:34.047
> 
> 标签：biztalk, biztalk-2010, btahl7

我们正在使用 BTAHL7 加速器接收 HL7 2.x。我想将原始 HL7 消息转储到 sql 表中，其中包含一些离散数据，包括控件 ID 等。我的接收位置使用的是 BTAHL72XRecievePipeline 组件。是否可以订阅原始消息，而不是解析的 xml 格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T20:38:45.947

您必须向我们提供一个自定义管道组件，如下所示：[http ://codebetter.com/jefflynch/2006/04/08/biztalk-server-2006-archive-pipeline-component/](http://codebetter.com/jefflynch/2006/04/08/biztalk-server-2006-archive-pipeline-component/)

您可以检索原始消息作为管道中的第一步。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-29T17:32:06.590

UltraPort MS SQL Schema Engine 完全符合您的要求。这就是它所做的一切，它非常快速且非常擅长，并且具有免费的全功能试用版。它在几分钟内就设置好了，他们得到了非常好的客户服务。如果您打电话，他们将引导您完成一个 10-15 分钟的导入 HL7 消息的示例（如果有的话，实际上鼓励您使用自己的 HL7 数据）。10-15 分钟将回答您可能遇到的任何问题的 90%，其中包括下载和安装软件。

主页：[http](http://www.hermetechnz.com/EasyHL7/prod_sql.asp) ://www.hermetechnz.com/EasyHL7/prod_sql.asp 在线帮助：[http ://www.hermetechnz.com/Documentation/UltraPort/MSSQL/index.html](http://www.hermetechnz.com/Documentation/UltraPort/MSSQL/index.html)

它存储未解析的 HL7 消息以及将其分解为已解析的数据表以及（可选）将未解析的 SEGMENTS 存储为单独的行。

希望这可以帮助。

# solr - SolrJ deleteByQuery 不适用于核心

> ID：11868999
> 
> 赞同：0
> 
> 时间：2012-08-08T16:29:59.270
> 
> 标签：solr, solrj

我正在尝试使用 SolrJ 使用 deleteByQuery 方法，但它不起作用。你能告诉我有什么问题吗？

这是有效的（deleteByIds）：

```
ArrayList<String> ids = new ArrayList<String>();
ids.add("id_1");
ids.add("id_2");
SolrServer solrServer = getSolrServerForCore(0);
solrServer.deleteById(ids);
UpdateResponse ur2 = solrServer.commit(); 
```

但这不起作用：

```
SolrServer solrServer = getSolrServerForCore(0);
solrServer.deleteByQuery("*:*");
solrServer.commit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T11:35:17.263

我设法通过将`_version_`字段添加到 schema.xml来解决问题