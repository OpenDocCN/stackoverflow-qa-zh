# StackOverflow 问答 000861000-000861999

# svn - 如何在不替换本地文件的情况下将现有目录转换为 SVN 工作副本 (WC)？

> ID：861005
> 
> 赞同：29
> 
> 时间：2009-05-13T23:58:24.290
> 
> 标签：svn, working-copy

我有一个大型 Subversion 存储库，其中有近 15 GB 的数据分布在大约 500,000 个文件中。现在我需要将此存储库签出到远程主机，这需要几天时间才能完成。

我要签出的主机已经拥有存储库中数据的完整副本。但是由于文件没有直接从存储库中签出，它们不构成工作副本（没有“.svn”文件夹）。

我想避免通过网络复制所有这些数据，尤其是当它已经存在于目标主机上时。有没有我可以使用的技巧将预先存在的目录转换为工作副本，而无需使用存储库中的相同副本替换本地文件？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-10-07T13:51:18.360

从 SVN 1.7（但不是之前）开始，您可以通过以下方式轻松完成此操作：

`svn co --force http://path/to/repo`

这会将本地副本视为现有副本，并且您会在输出中的每个文件名之前看到“E”表示存在： `E some/existing/file`

如果文件与存储库不同（新的或修改的），它也会根据[本书](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.checkout.html "书")优雅地处理：

> 在 1.7 版之前，如果您尝试检出现有目录顶部的目录，其中包含检出本身会创建的文件或子目录，Subversion 默认会报错。Subversion 1.7 以不同的方式处理这种情况，允许检出继续，但将任何阻碍对象标记为树冲突。使用 --force 选项覆盖此保护措施。当您使用 --force 选项检出时，检出目标树中通常会阻碍检出的任何未版本化文件仍将变为版本化，但 Subversion 将按原样保留其内容。如果这些内容与该路径上的存储库文件不同（作为结帐的一部分下载），

另请注意，SVN 1.7 可能会导致这是一个更常见的问题（可能会激发解决方案）。*将子目录*移动到磁盘上的新位置时遇到了这个问题。在 1.7 之前的版本中`.svn`，它会随它一起移动目录，并且它本来可以独立存在的。在 1.7 中，该目录实际上是未版本化的。但`svn co --force`挽救了这一天。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T00:06:48.270

有重定位命令：[http ://svnbook.red-bean.com/en/1.1/re27.html](http://svnbook.red-bean.com/en/1.1/re27.html)

**编辑：如果本地文件没有链接到存储库，那么您可以创建一个本地存储库，将文件导入其中，然后使用 relocate 命令。**

或者，如果您对两台机器都有物理访问权限，则可以在本地签出存储库，然后通过外部 HD 将文件复制到远程机器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-16T03:57:45.620

`svn co --force https://PATH/TO/REPO/ .`

Where the `.` at the end assumes you are already inside the directory which you want to turn into a working SVN copy.

For instances, if you wanted to make your `public_html` directory a working svn copy of a repository:

`cd /home/username/public_html; svn co --force https://PATH/TO/REPO/ .`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T07:15:44.977

以下命令是删除所有 .svn 目录。

```
chmod -R 0755 project_dir
find /project_dir -type d -name .svn -exec rm -rf '{}' + 
```

如果您已经有结帐版本，则可以尝试`.svn`通过替换`rm`为来复制这些文件夹`cp`。不过我没试过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T01:48:53.567

如果您在网络上的其他地方已经有一个受 svn 控制的工作副本，您可以尝试使用 rsync。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T00:45:00.847

您可以只在本地签出存储库，然后仅传输 .svn 目录（小心，它们包含工作区文件的副本，显然您不想复制这些）。这应该可行，因为您将拥有正确工作副本的确切文件。

当然，您必须编写某种脚本来传输 .svn 文件。在 Unix 系统上，您可以使用 find 和 Friends 来完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-27T23:56:03.640

我的本地计算机上有一个工作存储库，当 Eclipse 崩溃时，它的所有 .svn 文件夹都被删除了。

我能够将它连接到远程 SVN 存储库的唯一方法是按照我找到的博客中的这些步骤（*[恢复损坏的 Subversion 工作副本](http://andytson.com/blog/2009/12/recovering-a-broken-subversion-working-copy/#comment-70719)*）：

```
# Backup your project in case you run into trouble
cp -Rp /path/to/project /temporary/location

# Strip out the old .svn folders (if any)
find /path/to/project -name .svn -print0 | xargs -0 rm -rf

# Check out a clean copy
svn co http://repo/location /temporary/location2

# Move the .svn folders from the clean copy into the correct relative
# place in the broken copy
cd /temporary/location2
find . -name .svn -print0 | xargs -0 -I {} mv '{}' '/path/to/project/{}'

# Remove the clean copy
rm -rf /temporary/location2 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-15T18:27:15.790

本机 svn 命令都不会校验现有文件的匹配项，也不会下载它们。

您使用什么协议来访问存储库？如果是https，那可能是您的问题。试试原生 svn 协议（使用 svnserve），或者 svn+ssh。或者甚至可以通过托管 svn 存储库的服务器上的 file:// URL 进行结帐，然后使用 rsync 通过网络传输。

只要您不为每字节的带宽*付费*，让“svn co --force”在 nice 或（Windows 上的 START /LOW）下运行而不浪费您自己的时间可能是有意义的。它不会在结帐过程中使本地文件系统上的任何内容不可用。

最后，我无法弄清楚为什么您的结帐速度如此之慢......我们有 500K 文件存储库，通过千兆位 LAN 上的 https 在大约 6 分钟内结帐。当然，所有文件都小得多（总共 1 GB）。就延迟而言，您离服务器有多远？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-27T16:17:56.967

在服务器上进行检查，在本地（服务器本地）创建工作副本，然后通过现有目录结构将该工作副本同步到远程系统。

使用 Subversion 1.7，这样就没有带有原始文件副本的 .svn。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-14T01:18:24.280

如果不将这 15 GB 传输到目的地，我认为没有解决方案。在那里复制存储库并进行本地签出可能会更快、更容易。

# c++ - 如何从一条线上反弹一个点？

> ID：861007
> 
> 赞同：3
> 
> 时间：2009-05-13T23:59:43.133
> 
> 标签：c++, graphics, physics

我正在编写一个 Pong 游戏，但遇到了一个问题。

我试图弄清楚如何从一条线上反弹一个点。

我能想到的最好的方法是

*   计算球的当前和未来位置。
    *   线段：{Ball.location, Ball.location + Ball.direction}（Ball.location 和 Ball.direction 使用自定义矢量/坐标类）
*   计算生成的线段是否与任何墙壁或桨相交。
    *   ？？？还不知道该怎么做（将在单独的问题中提问）
*   在找到的第一个路口
    *   将球弹离底线
        *   创建一个三角形
            *   a = 球的当前位置
            *   b = 线的交点。
            *   c = 最接近球在线上当前位置的点。
        *   找出球击中线的角度
            *   角度 = cos（距离（b，c）/距离（a，b））
        *   找到旋转球方向的角度
            *   (90-角度)*2
        *   旋转球的方向并将其移动到新位置
            *   暂时忽略到达线的距离，不需要完全在线
*   否则，如果没有交叉点
    *   将球移动到它的新位置。

这是一种可以接受的方法还是我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T00:13:48.323

你只需要检查球的中心是否在球拍的半径范围内，就可以判断它是否有时间反弹。有一个较老的问题，在[计算反弹角度](https://stackoverflow.com/questions/573084/how-to-calculate-bounce-angle)时有几个答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T00:15:21.080

如果您想要真实的 Pong 感觉，那么计算新矢量比进行真实反射要容易得多。Pong 只是反转 dx 或 dy 的符号。如果球击中水平障碍，则否定 dy。垂直，然后否定 dx。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T00:10:55.067

在您的游戏循环中，计算新球的位置，就好像没有统计信息一样。
然后检查新位置是否与骨缘相交或过去。如果满足任一条件，则通过将其从固定器上弹回来计算新的球位置。

在给定起点、角度和距离的情况下计算点的方法会派上用场：

```
Public Function TranslatePoint(ByVal tStartPoint As Point, _
ByVal tAngle as Decimal, ByVal tDistance As Decimal) As Point 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T03:00:43.270

您可能对[N 教程](http://www.metanetsoftware.com/technique.html)感兴趣，其中讨论了游戏“N”中使用的碰撞检测和响应（包括反弹和摩擦）。

这些教程可能比你特别需要的更深入，但它们写得很好并且有交互式示例——简单的反弹是第一个主题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T00:14:43.157

这是我要做的：

> 1）假设你的乒乓边在线 x=a 和 x=b
> 
> 2) 让你的球位置为 (x0, y0) 并在 Ax+By=C 线上行进
> 
> 3）据此，您可以轻松计算（x1，y1）该线与墙相交的点
> 
> 4) 知道(x0, y1+y0) 是反弹后的反射，就可以得到反弹后的直线方程。（球在交点下方 y1-y0 处，因此将在交点上方 y1+y0 处。）
> 
> 5）给定两个方程，您可以绘制点（假设您知道速度）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T08:20:02.597

弹跳是物理领域的问题，而不是图形领域的问题。因此 OpenGL 并没有为它提供真正的支持。如果您查看硬件，您会注意到已经有类似于视频卡的单独物理卡，尽管最近的趋势是集成它们。

# xpath - 已知属性的 XPath 部分

> ID：861008
> 
> 赞同：22
> 
> 时间：2009-05-14T00:00:10.623
> 
> 标签：xpath, string-matching

我知道文档中属性的部分值，但不是全部。有没有我可以用来表示任何值的字符？例如，输入的标签值是“A. Choice 1”。我知道它说的是“Choice 1”，但不知道它会在“Choice 1”之前说“A.”还是“B.”。以下是相关的 HTML。输入和标签还有其他属性，但是每次渲染页面的时候都不一样，所以我不能用它们作为引用：

```
<tr>
<td><input type="checkbox" /><label>A. Choice 1</label></td>
</tr><tr>
    <td><input type="checkbox" /><label>B. Choice 2</label></td>
</tr><tr>
<td><input type="checkbox" /><label>C. Choice 3</label></td>
</tr><tr>
     <td><input type="checkbox" /><label>D. Choice 4</label></td>
</tr> 
```

这是我用来选择值为“Choice 1”的标签旁边的输入的[XPath表达式，但 HTML 中 A 位于其前面：](http://en.wikipedia.org/wiki/XPath)

```
//td[label="Choice 1"]/input 
```

我不知道 HTML 中的 A 是 A、B 还是 C 等。但我知道正确的输入总是旁边有选择 1 文本。*如果标签包含*选项1，而不是*等于*选项 1，我怎么说选择它？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-14T06:27:58.327

您的 XPath 表达式应如下所示：

```
//td[contains(@label, 'Choice 1')]/input 
```

您选择`td`具有包含标签的所有元素，`Choice 1`然后选择`input`这些元素中的`td`元素。

**编辑**：Tomalak 的评论正确地提出了一项改进，以防止与“Choice 11”（或“Choice 12345”，...）匹配。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-17T19:11:50.070

在尝试找到一种方法来测试节点是否具有不为空的属性“对齐”或包含文本值“文本对齐”的属性“样式”时，找到了罗纳德的解决方案。这些是有问题的“节点”：

```
<node> 
  <p>This is left-aligned.</p> 
  <div align="left" >This is aligned LEFT using HTML attribute.</div> 
  <p style="text-align: center;" >This is centered using CSS style attribute.</p> 
  <div align="center" >This is CENTERED.</div> 
  <p style="text-align: right;" >This is right-aligned.</p> 
</this> 
```

这个 xpath 表达式有效——感谢 Ronald 的回答为我指明了正确的方向：

```
//*[contains(@style, 'align') or @align!=''] 
```

# .net - 一个类中是否可以有与版本无关的 DLL 引用？

> ID：861010
> 
> 赞同：20
> 
> 时间：2009-05-14T00:01:53.957
> 
> 标签：.net, visual-studio, dll, build-process, dependencies

我想创建一个编译成单个 DLL 的类。此 DLL 将向现有产品添加功能。

为了完成这项工作，自定义类引用了基础产品中包含的 DLL。编译需要这些引用。

这里一切正常，自定义类编译。我可以将生成的 DLL 放入产品中，一切正常。

但是，此产品有多个版本（次要版本、服务包）。我想将此 DLL 分发给其他人，但我发现 DLL 必须与产品的版本*完全*匹配。如果没有完美匹配，则会出现以下错误：

> 无法加载文件或程序集 'Product.Web.UI, Version=3.6.1920.2, Culture=neutral, PublicKeyToken=dfeaee0e3978ac79' 或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

如何生成对版本参考不挑剔的 DLL？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-09-01T17:37:09.990

这是一个很好的解决方案。它为我解决了类似的问题。

[在 .NET 中编译与版本无关的 DLL](https://stackoverflow.com/questions/277817/compile-a-version-agnostic-dll-in-net-using-manifests/284462#284462)

如果该链接失效，关键是处理 AppDomain.CurrentDomain.AssemblyResolve 事件，如下所示。每当程序集绑定失败时都会触发该事件，因此您可以自己解决它，修复版本冲突。

```
using System.Reflection;

static Program()
{
    AppDomain.CurrentDomain.AssemblyResolve += delegate(object sender, ResolveEventArgs e)
    {
        AssemblyName requestedName = new AssemblyName(e.Name);

        if (requestedName.Name == "Office11Wrapper")
        {
            // Put code here to load whatever version of the assembly you actually have

            return Assembly.LoadFile("Office11Wrapper.DLL");
        }
        else
        {
            return null;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T00:20:47.907

我的问题还没有答案，但我会使用这个答案来记录我在寻找解决方案时发现的面包屑。

我在 StackOverflow 上发现了一个相关的问题：

[在 .NET 中编译与版本无关的 .DLL（使用清单？）](https://stackoverflow.com/questions/277817/compile-a-version-agnostic-dll-in-net-using-manifests)

但是，我无法修改基础产品，因此答案对我不起作用。

* * *

**更新：**

我给比我聪明得多的人发了电子邮件，回复如下：

引用强命名程序集时，默认情况下 Visual Studio 会添加对被引用程序集的完整引用。这意味着它包括程序集的名称、确切的版本、文化和公钥令牌。如果这些信息中的任何一个与所描述的异常不匹配，则会引发异常。

删除我们程序集的强名称根本不是一种选择。我不会详细说明原因，但是您可以在 MSDN 中进行一些研究。

因此，您有两个选项可以解决针对您引用的每个版本的程序集构建的问题。

1.  你可以做部分引用。请参阅这篇文章： http: [//msdn.microsoft.com/en-us/library/0a7zy9z5](http://msdn.microsoft.com/en-us/library/0a7zy9z5(VS.71).aspx) (VS.71).aspx 。
2.  您可以在 web.config 中声明具有绑定重定向的兼容版本。请参阅这篇文章：http: [//msdn.microsoft.com/en-us/library/433ysdt1.aspx](http://msdn.microsoft.com/en-us/library/433ysdt1.aspx)。

通常建议使用第二种方法，因为： 1\. 您不能在全局程序集缓存中使用对程序集的部分引用，这意味着如果程序集在 GAC 中，您的控件将引发相同的异常。2\. 您明确声明兼容版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T07:57:48.377

在 VisualStudio 中 - 您是否尝试过右键单击引用的程序集（dll），然后选择属性并设置“需要特定版本”（或左右）？这可能会解决您的问题。

安德烈亚斯

# .net - 通过 .net web 服务调用 java web 服务

> ID：861012
> 
> 赞同：1
> 
> 时间：2009-05-14T00:02:29.807
> 
> 标签：.net, web-services

你好

您能否告诉我如何编写 .net Web 服务以通过 SOAP 调用 Java Web 服务（由不同的人编写）。

谢谢你问候阿帕纳

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T10:46:27.660

与上面的答案一样，它*应该*是直截了当的。

您需要注意的一件事是您公开的 Java Web 服务符合 WS-I Basic Profile 标准——换句话说，它需要使用 rpc/literal 或 document/literal WSDL SOAP 绑定。

如果您要公开一个 rpc/编码的 Web 服务（如果您使用 Apache Axis 作为您的 Web 服务堆栈，这通常是这种情况），您*可能会*在尝试从 .NET 客户端使用它时遇到问题。

这里有一篇关于 WSDL 绑定样式的好文章：http: [//www.ibm.com/developerworks/webservices/library/ws-whichwsdl/](http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T00:12:10.383

对于标准的 SOAP Web 服务调用，底层实现对于消费应用程序应该不重要。拉下 WSDL 并希望调用的记录足够好，以便您执行所需的操作。小心来自另一种编程语言的类型转换，它们可能不会完全像您在使用服务的语言中所期望的那样通过 web 服务调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T10:25:31.017

基本上在 .net web 服务、.net web 应用程序或 .net windows 应用程序中调用 java web 服务没有任何区别。看看这个帖子。希望它能消除您的所有疑虑 [http://blogs.msdn.com/bursteg/archive/2008/07/19/how-to-call-a-java-ee-web-service-from-a-net-client .aspx](http://blogs.msdn.com/bursteg/archive/2008/07/19/how-to-call-a-java-ee-web-service-from-a-net-client.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T01:59:24.433

您只需让 .NET 服务成为 Java 服务的客户端：

1.  右键单击您的 Web 服务项目并使用“添加服务引用”
2.  在“地址”框中指定 Java Web 服务的 WSDL 的 URL，然后单击“执行”
3.  指定将通过其访问 Java 服务的“名称空间”，例如“JavaService”。单击“确定”。
4.  如果一切顺利，您现在应该在“ *YourProjectNamespace* .JavaService”命名空间下为您创建了许多类。

特别是，您应该有一个代表服务本身的。现在，一个给定的服务可以实现多个服务契约（在 WSDL 术语中称为“端口类型”）。如果服务实现了*JavaServiceContract*端口类型，那么您应该找到一个名为*YourProjectNamespace* .JavaService 的类。*JavaServiceContract*客户端。假设这个合约包含一个名为“JavaOperation”的操作，你应该这样称呼它：

```
int returnValue = 0;
YourProjectNamespace.JavaService.JavaServiceContractClientjavaService = null;
try {
        javaService = 
            new YourProjectNamespace.JavaService.JavaServiceContractClient();
        returnValue = javaService.JavaOperation();
}
finally {
    if (javaService != null) {
        ((IDisposable)javaService.)Dispose();
    }
} 
```

# c# - ASP.NET 3.5 Web 应用程序项目初始加载时间过长

> ID：861016
> 
> 赞同：5
> 
> 时间：2009-05-14T00:03:53.877
> 
> 标签：c#, asp.net, .net-3.5, webforms, web-application-project

我在一家新公司开始工作，我从事的主要项目（一个 ASP.NET 3.5 Web 应用程序项目）初始加载需要很长时间（大约 1.5 分钟）

我知道这通常是网络应用程序项目的本质，但我的问题是这似乎太长了。

我已经尝试了几件事来尝试找出可能导致这种滞后的原因，包括用从新项目创建的新的 web.config 替换 web.config 从我的 web.config 中的 app_start 中清除所有内容从我的 bin 文件夹中删除了所有 weppart dll（留下我的 bin 目录中有 19 个 dll，其中 6 个来自 MS 企业库）

并且仍然需要很长时间才能加载。

我想知道是否有人对我如何找出导致如此巨大的加载时间的原因或任何可以帮助我了解我的应用程序在启动时正在做什么的工具有任何指示

谢谢-克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-30T07:25:49.943

.NET 2.0 以后还有另一个问题。如果您的 bin 文件夹中有任何已签名的程序集，则 CLR 会尝试连接到 VeriSign URL 并获取证书的吊销列表以查看它们是否有效。

这也可能会占用您的一些启动时间。如果您认为这可能会导致您的问题，那么您可以查看以下 MS 文章：

```
http://digital.ni.com/public.nsf/allkb/18E25101F0839C6286256F960061B282
http://support.microsoft.com/kb/936707 
```

要在每个应用程序的基础上处理此问题，您可以在 app.config/web.config 的配置部分下添加以下设置。

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <runtime>
       <generatePublisherEvidence enabled="false" />
    </runtime>
</configuration> 
```

当然，如果您添加此设置，已签名的 DLL 将不再验证其有效性！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T00:08:20.670

尝试一个[热身脚本](http://programmerramblings.blogspot.com/2008/09/aspnet-site-warmup.html)。

[JetBrains DotTrace](http://www.jetbrains.com/profiler/)是一款出色的 ASP.NET 分析器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-15T02:01:18.067

RedGate 的 ANTS 分析器可以为您提供一些提示，说明什么可能会减慢您的速度。

在 Default.aspx.cs 中的 Page_Load 上设置断点并开始。

检查 Global.asax 文件以查看是否正在加载您不知道的任何内容。

其他项目加载速度快吗？您是否有其他正在运行的程序可能会降低您的机器速度？正如你所提到的，.NET 应用程序在初始加载时花费的时间最长......你有很多引用吗（外部库、dll ......等等......）

如果您发布到登台或开发服务器，它会快速加载吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T00:08:51.870

有多少项目？如果您在 bin 目录中有大量程序集和 dll，则可能会大大减慢加载时间（即使它们非常小）。这是我能建议的最好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T06:18:41.750

尝试使用 SQL Profiler 并在启动期间观察相关的*数据库活动。*

很有可能，在第一个页面视图上会有大量查询访问数据库以初始化各种缓存。

如果是这种情况，您可以将精力集中在优化导致最多阻塞的查询上。

# c# - 64位模式不支持OleDB？

> ID：861022
> 
> 赞同：14
> 
> 时间：2009-05-14T00:07:18.253
> 
> 标签：c#, .net, csv, 64-bit, oledb

我一直在使用 Microsoft.Jet.OLEDB.4.0 和 Microsoft.ACE.OLEDB.12.0 来读取 .csv、.xls 和 .xlsx 文件。

我刚刚发现本机 64 位模式不支持这些技术！

我有两个问题：

1.  在 64 位模式下以编程方式读取 .csv、.xls 和 .xlsx 文件的支持方式是什么。我只是无法在任何地方找到答案。

2.  如果我无法读取所有三种文件类型，在 64 位环境中读取 .csv 文件的最佳方式是什么？

笔记：

*   我正在使用 .NET (3.5p1)
*   这是一个收缩包装应用程序；再分配是一个关键因素。

**更新：**

我可以使用 CorFlags 强制应用程序以 32 位模式运行，这可行，但不可取。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T00:30:51.943

这是关于如何处理[已弃用的 MDAC](http://msdn.microsoft.com/en-us/library/ms810810.aspx)的讨论。恐怕答案不是很满意……

> 这些新的或转换后的 Jet 应用程序可以继续使用 Jet，目的是使用 Microsoft Office 2003 和更早的文件（.mdb 和 .xls）进行非主要数据存储。但是，对于这些应用程序，您应该计划从 Jet 迁移到 2007 Office System Driver。您可以下载 2007 Office System 驱动程序，它允许您读取和写入 Office 2003（.mdb 和 .xls）或 Office 2007（*.accdb、*.xlsm、*.xlsx 和*.xlsb) 文件格式。重要请阅读 2007 Office System 最终用户许可协议以了解具体的使用限制。
> 
> 注意：SQL Server 应用程序还可以通过 2007 Office System 驱动程序从 SQL Server 异构数据连接和集成服务功能访问 2007 Office System 和更早版本的文件。此外，64 位 SQL Server 应用程序可以通过在 64 位 Windows 上使用 32 位 SQL Server 集成服务 (SSIS) 访问 32 位 Jet 和 2007 Office System 文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T08:00:43.807

主要问题是 Jet DBMS 是一个 32 位库，它会被加载到调用进程中，因此您永远无法在 64 位模式下直接从应用程序中使用 Jet。正如 Tim 提到的，您可以编写自己的 csv 解析器，但由于这是一个收缩包装应用程序，您需要能够处理更广泛格式的东西。幸运的是，有多种方法可以使用 32 位应用程序，因此您仍然可以通过技巧使用 Jet。

我会编写一个标记为仅在 32 位模式下运行的小 exe。此 exe 将采用要读取的文件名和要写入的临时文件名的命令行参数。我会使用 Jet 加载 csv/xls，然后将数据放入数组数组中，然后使用 xml 序列化程序将数据写入临时文件。

然后，当我需要加载/转换 csv/xls 文件时，我会执行以下操作：

```
object[][] ConvertFile(string csvOrXlsFile)
{
    var output = System.IO.Path.GetTempFileName();
    try
    {
        var startinfo = new System.Diagnostics.ProcessStartInfo("convert.exe",
            string.Format("\"{0}\" \"{1}\"", csvOrXlsFile, output));

        System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.StartInfo = startinfo;

        proc.Start();
        proc.WaitForExit();

        var serializer = new System.Xml.Serialization.XmlSerializer(typeof(object[][]));
        using (var reader = System.IO.File.OpenText(output))
            return (object[][])serializer.Deserialize(reader);
    }
    finally
    {
        if (System.IO.File.Exists(output))
            System.IO.File.Delete(output);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T17:45:00.953

您可以尝试使用[FileHelpers](http://filehelpers.sourceforge.net/)库进行平面文件解析。效果非常好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-10T15:15:45.123

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)可以读取和写入 .csv / .xls / .xlsx 工作簿（以及[更多](http://www.spreadsheetgear.com/products/spreadsheetgear.net.aspx)）并支持 64 位 .NET 2.0+。SpreadsheetGear 可以通过您的收缩包装应用程序免费分发。

您没有指定您的应用程序是 WinForms 还是 ASP.NET，但 SpreadsheetGear 可以使用其中任何一个。您可以在此处查看实时 ASP.NET (C# & VB) 示例，[在此处](http://www.spreadsheetgear.com/support/samples/)了解 WinForms 示例并[在此处](http://www.spreadsheetgear.com/support/samples/windowsforms.aspx)下载免费试用版[，](https://www.spreadsheetgear.com/downloads/register.aspx)如果您想自己尝试的话。

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-15T18:57:34.523

您可以使用 [Microsoft Access Database Engine 2010 Redistributable](http://www.microsoft.com/download/en/details.aspx?id=13255)来读写 csv、xls 访问等。每个驱动程序都有 32 位和 64 位版本。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-05-06T11:39:56.320

对于可能遇到此问题的任何人来说，这更像是一篇信息性帖子（对我自己来说，以防我将来遇到同样的问题并且不记得解决方案:-)）这有点晦涩，但给我带来了几个小时的压力，所以也许它会帮助其他人......对不起，如果这是重复的（找不到它）或不推荐使用（有些人没有最新和最伟大的奢侈品）。

如果您尝试使用 Jet 4.0 在基于 x64 的服务器上访问 MS Excel 文档（或其他数据文件），您会发现不支持这种组合。

唯一的解决方案是允许 IIS 在 Windows 64 上运行 32 位应用程序并安装受支持的数据库提供程序。

您需要安装驱动程序，用于 ODBC (MSDASQL) 的 64 位 OLEDB Provider 作为桥梁：“Microsoft OLE DB Provider for ODBC (MSDASQL) 是一种技术，它允许基于 OLEDB 和 ADO 构建的应用程序 (内部使用 OLEDB）通过 ODBC 驱动程序访问数据源。MSDASQL 是连接到 ODBC 而不是数据库的 OLEDB 提供程序。MSDASQL 随 Windows 操作系统一起提供，Windows Server 2008 和 Windows Vista SP1 是第一个 Windows 版本包括该技术的 64 位版本。” 在此处下载：http: [//www.microsoft.com/downloads/details.aspx?FamilyID=000364db-5e8b-44a8-b9be- ca44d18b059b&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=000364db-5e8b-44a8-b9be-ca44d18b059b&displaylang=en)

这一切都很好，但我遇到了两件事让我摸不着头脑（并强调）：1）您需要在 IIS Web 服务扩展中允许 32 位 ASP.Net - 阅读**“” [http://www.textcontrol .com/blog/permalink/2006082101](http://www.textcontrol.com/blog/permalink/2006082101) ""**有关启用 32 位应用程序和 IIS Web 服务扩展设置的说明。2) 如果您在 IIS x64 下使用任何注册表项，将在注册表中添加一个新节点 - Wow6432Node - 您需要将在 x64 下使用的任何相关键移动/复制到其中。即我们有一个存储在 HCLM\Software\CustomKey 中的数据密钥，当启用 32 位时该密钥不再可用。我们在 Wow6432Node 下重新创建了密钥，一切都很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T00:44:21.377

实际上，我认为 Linq 是您最好的解决方案。

就像是....

```
IEnumerable<MyObj> ObjList = GetObjList(yourCSVFileNAme);

var qry = from o in ObjList
          where o.MyField == Something
          select o; 
```

你的 GetObjList 方法看起来像

```
Public IEnumerable<MyObj> GetObjList(string filename)
{
  // Obvioulsly you would have some actual validation and error handling
  foreach(string line in File.ReadAllLines(filename))
  {
    string[] fields = line.Split(new char[]{','});
    MyObj obj = new MyObj();
    obj.Field = fields[0];
    obj.AnotherField = int32.Parse(fields[1]);
    yield return obj;
  }
} 
```

# c++ - 构建网络爬虫

> ID：861035
> 
> 赞同：1
> 
> 时间：2009-05-14T00:15:38.833
> 
> 标签：c++, c, search-engine

我目前正在开发一个带有内置网络爬虫的自定义搜索引擎。出于某种原因，我不喜欢多线程，到目前为止，我的索引器是以单线程方式编码的。现在我对正在构建的爬虫有一个小困境。任何人都可以建议哪个更好，抓取 1 页然后索引它，或者抓取 1000 多个页面并缓存，然后索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T01:10:38.607

网络很慢（相对于 CPU）。通过并行化爬虫，您将看到速度显着提高。否则，您的应用程序将花费大部分时间等待网络 IO 完成。您可以使用多线程和阻塞 IO，也可以使用带有异步 IO 的单线程。

此外，与一次索引一个文档相比，大多数索引算法在批量文档上的性能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T02:45:07.957

不使用线程是可以的。但是，如果您仍然想要性能，则需要处理异步 IO。我建议查看 Boost.ASIO[链接文本](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)。使用异步 IO 将使您的困境“无关紧要”，因为这无关紧要。另外作为奖励，将来如果您决定使用线程，那么告诉 Boost.Asio 将多个线程应用于问题是微不足道的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T00:26:12.793

更好的？在什么方面？就速度而言，我无法预见明显的差异。就健壮性（从灾难性故障中恢复）而言，最好在抓取每个页面时对其进行索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T00:28:34.023

如果您对爬虫很认真，我强烈建议您“加入”多线程。基本上，您会希望始终运行至少一个索引器和至少一个爬虫（两者都可能有多个）。除其他外，这最大限度地减少了启动和关闭开销（例如初始化和释放数据结构）。

# c# - 如何通过 WCF 传递通用对象

> ID：861041
> 
> 赞同：0
> 
> 时间：2009-05-14T00:20:07.767
> 
> 标签：c#, wcf, silverlight, web-services, serialization

是否可以在不从一个根继承的情况下传递泛型对象（泛型我的意思是任何 with `DataContract`，而不是 C# 泛型集合）？目前我有这样的事情：

```
[OperationContract]
void Save(GenericObject o);

[DataContract]
[KnownType(typeof(ClassA))]
[KnownType(typeof(ClassB))]
class GenericObject {....

[DataContract]
class ClassA: GenericObject {....

[DataContract]
class ClassB: GenericObject {.... 
```

一切都很好，但是项目变得更大了，我真的负担不起从一个班级派生所有这些合同。

我不想为服务添加专门的方法。作为一种解决方法，我可以通过 DataContractSerializer 手动将类序列化为字符串或 byte[] 并在服务器端对它们进行反序列化： void Save(byte[] serializedObject) 但这有点麻烦。

我注意到我可以轻松地返回通用对象，例如 object Load(string id) 工作得很好，但 void Save(object o) 不能。

我使用 Silverlight 作为客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T05:22:48.420

是的，您可以为 WCF 项目使用泛型`Message`类型，它可以是任何东西，真的。但是，这给您带来了很多工作，无论是在客户端创建消息对象（您基本上必须手动创建构成通用消息的 XML）以及服务器端，因为您不能依赖关于漂亮的 XML 序列化/反序列化了。您正在处理基本的原始尖括号汤（直接 XML）。

它有效，它可能是一个解决方案 - 但也许还有其他更优雅和有用的解决方案？真的需要这种继承吗？想想你的系统设计。

马克

# c# - 如何使用 Silverlight 2 计算加载图像的大小？

> ID：861042
> 
> 赞同：0
> 
> 时间：2009-05-14T00:20:21.760
> 
> 标签：c#, silverlight

我正在将图像加载到背景中，并且我希望包含所有图像的 silverlight 画布调整为图像大小（或我确定的最大值或最小值），无论图像大小是多少。所以我做了以下事情：

```
private int ImageMargin = 4;

    public Page()
    {
        InitializeComponent();

        BitmapImage bi = new BitmapImage(new Uri("1.jpg", UriKind.Relative));
        backgroundImage.Source = bi;
        bi.DownloadProgress += new EventHandler<DownloadProgressEventArgs>(bi_DownloadProgress);

        backgroundImage.SizeChanged += new SizeChangedEventHandler(backgroundImage_SizeChanged);

    }

    void bi_DownloadProgress(object sender, DownloadProgressEventArgs e)
    {
        if (e.Progress == 100)
        {
          LayoutRoot.Height = backgroundImage.Height + ImageMargin * 2;
          LayoutRoot.Width = backgroundImage.Width + ImageMargin * 2;
        }
    } 
```

图像加载正确，但无论我似乎将 backgroundImage.Height/Width（关闭 .Loaded 事件、.SizeChanged 事件 [1]、使用边框 [2] 等）放在哪里，它总是返回 0.0 或 NaN。我究竟做错了什么？

[1] [http://silverlight.net/forums/t/14855.aspx](http://silverlight.net/forums/t/14855.aspx) [2] [http://silverlight.net/forums/t/90235.aspx](http://silverlight.net/forums/t/90235.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T17:58:47.170

啊，解决方案！[Silverlight 每日提示 #13 - 如何在 Silverlight 中获取图像尺寸。](http://silverlight.net/blogs/msnow/archive/2008/06.aspx)

```
private Image image;

    public Page()
    {
        InitializeComponent();
        LoadImage("image.png");
    }

    private void LoadImage(string path)
    {

        Uri uri = new Uri(path, UriKind.Relative);
        BitmapImage bitmapImage = new BitmapImage();
        bitmapImage.UriSource = uri;
        bitmapImage.DownloadProgress += 
            new EventHandler<DownloadProgressEventArgs>(bitmapImage_DownloadProgress);
    }

    void bitmapImage_DownloadProgress(object sender, DownloadProgressEventArgs e)
    {
        if (e.Progress == 100)
        {
            Dispatcher.BeginInvoke(delegate()
            {
               double height = image.ActualHeight;
               double width = image.ActualWidth;
            });
        }
    } 
```

关键是这一行：

> 调用 Dispatcher.BeginInvoke(delegate() { ... } ); 在获得宽度/高度之前是必需的，否则它们可能会间歇性为零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T00:28:43.557

您可能必须等待一个 UI 循环周期才能确保 Silverlight 有机会更新布局。此外，您必须确保图像实际上是可见的。我实际上写了一个小程序，它从图像二进制中获取图像大小。缺点是您必须通过 WebClient 显式下载图像，但好处是您无需实际显示任何内容即可知道尺寸：

```
namespace StatMap.Silverlight.Services.UIHelpers
{
    public static class ImageSizeExtractor
    {
        public static bool TryGetImageSize(byte[] buf, out int width, out int height)
        {
            return TryGetPngSize(buf, out width, out height) || TryGetJpegSize(buf, out width, out height);
        }

        private static bool IsPng(byte[] buf)
        {
            return (buf.Length > 8)&&(buf[0] == 137) && (buf[1] == 80) && (buf[2] == 78) && (buf[3] == 71)
                   && (buf[4]==13)&&(buf[5]== 10)&&(buf[6]== 26)&&(buf[7]== 10);
        }

        private static bool TryGetPngSize(byte[] buf, out int width, out int height)
        {
            width = 0;
            height = 0;
            if (IsPng(buf))
            {
                int index = -1;
                for (int i = 8; i < buf.Length - 12;i++)
                {
                    if ((buf[i]==0x49)&&(buf[i+1]==0x48)&&(buf[i+2]==0x44)&&(buf[i+3]==0x52))
                    {
                        index = i + 4;
                        break;
                    }
                }

                if (index<0)
                {
                    return false;
                }
                width = buf[index + 3] + buf[index + 2]*256;
                height = buf[index + 7] + buf[index + 6]*256;
                return true;
            }
            return false;
        }

        private static bool TryGetJpegSize(byte[] buf, out int width, out int height)
        {
            //static char get_jpeg_size(unsigned char* data, unsigned int data_size, unsigned short *width, unsigned short *height) {
            //Check for valid JPEG image
            int i = 0; // Keeps track of the position within the file
            width = 0;
            height = 0;
            if (buf[i] == 0xFF && buf[i + 1] == 0xD8 && buf[i + 2] == 0xFF && buf[i + 3] == 0xE0)
            {
                i += 4;
                // Check for valid JPEG header (null terminated JFIF)
                if (buf[i + 2] == 'J' && buf[i + 3] == 'F' && buf[i + 4] == 'I' && buf[i + 5] == 'F' &&
                    buf[i + 6] == 0x00)
                {
                    //Retrieve the block length of the first block since the first block will not contain the size of file
                    int blockLength = buf[i]*256 + buf[i + 1];
                    while (i < buf.Length)
                    {
                        i += blockLength; //Increase the file index to get to the next block
                        if (i >= buf.Length) return false; //Check to protect against segmentation faults
                        if (buf[i] != 0xFF) return false; //Check that we are truly at the start of another block
                        if (buf[i + 1] == 0xC0)
                        {
                            //0xFFC0 is the "Start of frame" marker which contains the file size
                            //The structure of the 0xFFC0 block is quite simple [0xFFC0][ushort length][uchar precision][ushort x][ushort y]
                            width = buf[i + 5]*256 + buf[i + 6];
                            height = buf[i + 7]*256 + buf[i + 8];
                            return true;
                        }
                        i += 2; //Skip the block marker
                        blockLength = buf[i]*256 + buf[i + 1]; //Go to the next block
                    }
                    return false; //If this point is reached then no size was found
                }
                return false;
            }
            return false;
        }
    }
} 
```

希望这可以帮助。

# grep - 使用 grep 和 xargs，避免“未终止的引用”错误

> ID：861043
> 
> 赞同：1
> 
> 时间：2009-05-14T00:20:32.710
> 
> 标签：grep, xargs

我感到很沮丧，以至于我认为是时候问一个问题了。

我正在尝试在一个硬编码到 1000 个页面中的网站上替换一个电子邮件地址。它在 FreeBSD 6.3 服务器上。

这是我正在使用的命令：

grep -R --files-with-matches 'Email\@domain.com' 。| 排序 | 独特 | xargs perl -pi -e 's/Email\@domain.com/Email\@newdomain.com/' *.html

这是我不断收到的错误：

xargs：未终止的报价

奇怪的是，当我在 3 个文件（嵌套结构）的测试用例上运行该命令时，它工作得很好。我一直在谷歌搜索，大多数解决方案似乎都处理在 . 和 xargs 之后的 -0。然而，这会产生一组不同的错误，让我相信我把东西放在了错误的地方。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T00:40:12.553

帕克斯是正确的。我会进一步将其更正为：

```
grep -R --files-with-matches 'Email\@domain.com' . -print0 | xargs -0 perl -pi -e 's/Email\@domain.com/Email\@newdomain.com/' 
```

编辑：

感谢 kcwu，这是完整的 FreeBSD：

```
grep -R --files-with-matches 'Email\@domain.com' . --null | xargs -0 perl -pi -e 's/Email\@domain.com/Email\@newdomain.com/' 
```

请注意，我已经删除了 sort 和 uniq。--files-without-match 被记录为“在第一次匹配时停止”，因此您不会得到重复的文件。-print0 和 -0 确保（并处理）一个以 null 结尾的文件列表，这很重要，因为 POSIX 允许文件名包含换行符。

请注意，我不知道 perl，但我假设这部分大致相当于：

```
sed -i s/Email\@domain.com/Email\@newdomain.com/g 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T00:28:58.577

你为什么要给 xargs 一个 HTML 文件列表？该程序从管道（grep 的输出）中获取其文件列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-21T08:49:41.073

使用 GNU 并行：

```
grep -R --files-with-matches 'Email\@domain.com' . | sort | uniq | parallel -q perl -pi -e 's/Email\@domain.com/Email\@newdomain.com/g' 
```

观看介绍视频以了解更多信息：[http ://www.youtube.com/watch?v=OpaiGYxkSuQ](http://www.youtube.com/watch?v=OpaiGYxkSuQ)

# delphi - 在 Delphi 中初始化了哪些变量？

> ID：861045
> 
> 赞同：34
> 
> 时间：2009-05-14T00:21:07.467
> 
> 标签：delphi, variables, initialization, delphi-2009

所以我总是听说类字段（基于堆）已初始化，但基于堆栈的变量没有。我还听说记录成员（也是基于堆栈的）也没有初始化。编译器警告局部变量未初始化（[DCC 警告] W1036 变量“x”可能尚未初始化），但不警告记录成员。所以我决定做一个测试。

对于所有记录成员， 我总是从*整数*中得到**0** ，从*布尔值中得到***false 。**

 ****我尝试打开和关闭各种编译器选项（调试、优化等），但没有区别。我所有的记录成员正在初始化。

我错过了什么？我正在使用 Delphi 2009 Update 2。

```
program TestInitialization;

{$APPTYPE CONSOLE}

uses
  SysUtils;

type
  TR = Record
  Public
    i1, i2, i3, i4, i5: Integer;
    a: array[0..10] of Integer;
    b1, b2, b3, b4, b5: Boolean;
    s: String;
  End;

var
  r: TR;
  x: Integer;

begin
  try
    WriteLn('Testing record. . . .');
    WriteLn('i1 ',R.i1);
    WriteLn('i2 ',R.i2);
    WriteLn('i3 ',R.i3);
    WriteLn('i4 ',R.i4);
    WriteLn('i5 ',R.i5);

    Writeln('S ',R.s);

    Writeln('Booleans: ', R.b1, ' ', R.b2, ' ', R.b3, ' ', R.b4, ' ', R.b5);

    Writeln('Array ');
    for x := 0 to 10 do
      Write(R.a[x], ' ');
    WriteLn;

    WriteLn('Done . . . .');
  except
    on E:Exception do
      Writeln(E.Classname, ': ', E.Message);
  end;
  ReadLn;
end. 
```

**输出：**

```
测试记录。. . .
我1 0
i2 0
i3 0
i4 0
i5 0
小号
布尔值： FALSE FALSE FALSE FALSE FALSE
大批
0 0 0 0 0 0 0 0 0 0 0
完毕 。. . .

```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-14T01:32:44.573

全局变量是零初始化的。`begin`在程序的 main ..块上下文中使用的变量`end`可能是一种特殊情况；有时它们被视为局部变量，尤其是`for`-loop 索引器。但是，在您的示例中，`r`它是一个全局变量，并且是从可执行文件的 .bss 部分分配的，Windows 加载程序确保它是零填充的。

局部变量被初始化，就好像它们被传递给`Initialize`例程一样。该`Initialize`例程使用运行时类型信息 (RTTI) 将托管类型的字段（递归地 - 如果字段是数组或记录类型）和数组（递归地 - 如果元素类型是数组或记录）清零，其中托管类型是以下之一：

*   AnsiString
*   Unicode字符串
*   宽弦
*   接口类型（包括方法引用）
*   动态数组类型
*   变体

堆中的分配不一定要初始化；这取决于用于分配内存的机制。作为实例对象数据的一部分的分配由 零填充`TObject.InitInstance`。来自的分配`AllocMem`是零填充的，而`GetMem`分配不是零填充的。from 的分配`New`被初始化，就好像它们被传递给`Initialize`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-24T19:01:51.130

> 对于所有记录成员，我总是从整数中得到 0，从布尔值中得到 false。
> 
> 我尝试打开和关闭各种编译器选项（调试、优化等），但没有区别。我所有的记录成员正在初始化。
> 
> 我错过了什么？

好吧，除了使用全局变量而不是局部变量进行测试之外：您缺少的重要一点是***巧合似乎***已初始化的变量与***实际已***初始化的变量之间的区别。
**顺便说一句**：这就是不检查警告的程序员犯下常见错误的原因，即假设他们写得不好的代码在进行少数测试时表现正确；碰巧有 0 和 False 默认值....`Want To Buy: random initialisation of local variables for debug builds.`

考虑您的测试代码的以下变体：

```
program LocalVarInit;

{$APPTYPE CONSOLE}

procedure DoTest;
var
  I, J, K, L, M, N: Integer;
  S: string;
begin
  Writeln('Test default values');
  Writeln('Numbers: ', I:10, J:10, K:10, L:10, M:10, N:10);
  Writeln('S: ', S);
  I := I + 1;
  J := J + 2;
  K := K + 3;
  L := L + 5;
  M := M + 8;
  N := N + 13;
  S := 'Hello';
  Writeln('Test modified values');
  Writeln('Numbers: ', I:10, J:10, K:10, L:10, M:10, N:10);
  Writeln('S: ', S);
  Writeln('');
  Writeln('');
end;

begin
  DoTest;
  DoTest;
  Readln;
end. 
```

使用以下示例输出：

```
Test default values
Numbers:    4212344   1638280   4239640   4239632         0         0
S:
Test modified values
Numbers:    4212345   1638282   4239643   4239637         8        13 //Local vars on stack at end of first call to DoTest
S: Hello

Test default values
Numbers:    4212345   1638282   4239643   4239637         8        13 //And the values are still there on the next call
S:
Test modified values
Numbers:    4212346   1638284   4239646   4239642        16        26
S: Hello 
```

**笔记**

*   如果您在关闭优化的情况下进行编译，则该示例效果最佳。否则，如果您对以下内容进行了优化：
    *   一些本地变量将在 CPU 寄存器中进行操作。
    *   而且，如果您在单步执行代码时查看 CPU 堆栈，您会注意到例如它`I := I + 1`甚至不会修改堆栈。因此，显然无法进行更改。
*   您可以尝试不同的调用约定，看看它是如何影响事物的。
*   您还可以测试将本地变量设置为零而不是递增它们的效果。
*   这说明了您是如何完全依赖于在调用您的方法*之前*进入堆栈的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T09:56:26.953

请注意，在您提供的示例代码中，记录实际上是一个全局变量，因此它将被完全初始化。如果将所有代码移到一个函数中，它将是一个局部变量，因此，根据 Barry Kelly 给出的规则，只有它的字符串字段将被初始化（为 ''）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T01:31:29.197

我有类似的情况，也有同样的想法，但是当我在记录之前添加其他使用的变量时，这些值变成了垃圾，所以在我使用我的记录之前，我必须使用初始化

```
FillChar(MyRecord, SizeOf(MyRecord), #0) 
```

# visual-studio-2008 - 为窗口服务创建安装项目

> ID：861052
> 
> 赞同：2
> 
> 时间：2009-05-14T00:25:43.280
> 
> 标签：visual-studio-2008, windows-services, installation, deployment-project

为 Windows 服务创建部署项目需要哪些必要项目？在安装新版本之前，我需要卸载以前版本的服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T01:25:06.200

MSDN 有一个关于创建 Windows 服务和安装程序的[教程。](http://msdn.microsoft.com/en-us/library/zt39148a(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T01:29:16.970

我将 NSIS 用于我的应用程序，而要安装服务，您只需使用 sc 命令：

```
ExecWait 'sc create MyService binpath= "$INSTDIR\MyService.exe"'
ExecWait 'sc start MyService' 
```

对于卸载：

```
ExecWait 'sc stop MyService'
ExecWait 'sc delete MyService' 
```

效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T00:30:54.783

这几乎只是调用：

```
net stop "MyService"
intallutil.exe /u MyService.exe

// Copy your exe into place
installutil.exe MyNewService.exe

// optional
net start "MyService" 
```

这将停止旧服务，将其卸载，然后将新服务复制到位，安装它，然后（可选）启动它。

大多数安装程序使这很容易。唯一的另一个“问题”是确保您的安装程序被限制安装到本地驱动器，而不是网络路径，如果要安装该服务以在启动时自动运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T00:52:07.260

1.  在 Visual Studio 中，转到服务项目中的服务文件（myservice.vb 或 myservice.cs）。

2.  右键单击设计视图，然后选择属性。

3.  在 Porperties 窗口的底部有一个 Add Installer 链接。点击它。

4.  检查 ServiceInstaller 和 ServiceProcessInstaller 属性。

5.  编译你的项目

6.  要卸载以前的版本，请在命令提示符下运行：Installutil.exe /uc:\myfolder\myservicefile.exe

7.  要安装，请在命令提示符下运行：Installutil.exe c:\myfolder\myservicefile.exe

而已。

Installutil.exe 位于框架文件夹中，位于 Windows 目录的某个位置。它不必包含在您的项目中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T01:49:35.283

如果您已经创建了安装程序，则无需为安装项目做太多额外的工作。它可以让你直接从 Visual Studio 中安装和卸载。网上有很好的教程。

您将遇到的 2 个与服务相关的问题，以及如何解决这些问题：

*   您卸载了一项服务，但无法重新安装它，因为您收到错误消息表明该服务正在等待删除并且需要重新启动。=> 关闭 Windows 服务管理器。它将释放所有引用，您可以重新安装您的服务。

*   您在卸载之前删除了服务可执行文件，现在您无法“卸载”它来清理注册表。=> 除了完全避免这种情况外，我对此没有解决方案。

# python - 作为实例方法调用时行为不同的类方法？

> ID：861055
> 
> 赞同：26
> 
> 时间：2009-05-14T00:26:24.353
> 
> 标签：python, class, methods

我想知道是否有可能制作一个在作为类方法调用时与作为实例方法调用时行为不同的方法。

例如，作为一个技能提高项目，我正在编写一个`Matrix`类（是的，我知道已经有非常好的矩阵类）。我为它创建了一个类方法，调用`identity`它返回一个指定大小的单位矩阵。

现在，当在 的*实例*上调用时`Matrix`，不需要指定大小似乎是合乎逻辑的；`Matrix`它应该返回一个与它被调用的大小相同的单位矩阵。

换句话说，我想定义一个方法，它可以确定它是否是通过实例调用的，如果是，则访问该实例的属性。不幸的是，即使在浏览了文档和一些谷歌搜索之后，我也没有发现任何表明这是可能的。有人知道不同吗？

**编辑：**

哇！显然，我还不太习惯一流的功能。这就是我最终得到的结果——感谢 Unknown 提供了密钥！

```
class Foo(object):
    def __init__(self, bar):
        self.baz = bar
        self.bar = MethodType(lambda self: self.__class__.bar(self.baz), self, self.__class__)

    @classmethod
    def bar(cls, baz):
        return 5 * baz

Foo.bar(3) # returns 15

foo = Foo(7)
foo.bar() # returns 35 
```

**编辑2：**

只是一个简短的说明 - 这种技术（以及下面介绍的大多数技术）不适用于定义 的类`__slots__`，因为您无法重新分配该方法。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-14T00:56:35.097

可疑有用的 Python hack 是我的强项。

```
from types import *

class Foo(object):
    def __init__(self):
        self.bar = methodize(bar, self)
        self.baz = 999

    @classmethod
    def bar(cls, baz):
        return 2 * baz

def methodize(func, instance):
    return MethodType(func, instance, instance.__class__)

def bar(self):
    return 4*self.baz

>>> Foo.bar(5)
10
>>> a=Foo()
>>> a.bar()
3996 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T01:00:08.427

**[已编辑：使用属性作为更直接的答案；请参阅 John Fouhy 的有用评论]**

您可以使用描述符来做您想做的事：

```
class cls_or_inst_method(object):
    def __init__(self, class_method, instance_method):
        self.class_method = class_method
        self.instance_method = instance_method

    def __get__(self, obj, objtype):
        if obj is None:
            return self.class_method
        else:
            return lambda: self.instance_method(obj)

def my_class_method(baz):
    return baz + 1

def my_instance_method(self):
    return self.baz * 2

class Foo(object):
    baz = 10
    bar = cls_or_inst_method(my_class_method, my_instance_method) 
```

使用上述：

```
>>> print Foo.bar(5)
6
>>> my_foo = Foo()
>>> print my_foo.bar()
20 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T01:14:02.700

@Unknown 你的和这个有什么区别：

```
class Foo(object):

    def _bar(self, baz):
        print "_bar, baz:", baz

    def __init__(self, bar):
        self.bar = self._bar
        self.baz = bar

    @classmethod
    def bar(cls, baz):
        print "bar, baz:", baz

In [1]: import foo

In [2]: f = foo.Foo(42)

In [3]: f.bar(1)
_bar, baz: 1

In [4]: foo.Foo.bar(1)
bar, baz: 1

In [5]: f.__class__.bar(1)
bar, baz: 1 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T00:44:27.540

我认为更大的问题是您在类 'Foo' 上重载了名称 'bar'，这是 python 不允许的。“bar”的第二个定义破坏了“bar”的第一个定义。

尝试为您的类方法和实例方法考虑唯一名称。IE

```
@classmethod
def create(cls, baz):
   ...

def rubber_stamp(self):
   ... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T01:32:30.800

您可以使用短 lambda 函数在**init**中重新分配您的标识方法：

```
class Matrix(object):
    def __init__(self):
        self.identity = lambda s=self:s.__class__.identity(s)

        #...whatever initialization code you have...
        self.size = 10        

    @classmethod
    def identity(self, other):
        #...always do you matrix calculations on 'other', not 'self'...
        return other.size

m = Matrix()
print m.identity()
print Matrix.identity(m) 
```

如果您不熟悉 lambda，它会创建一个匿名函数。它很少需要，但它可以使您的代码更简洁。上面的 lambda 行可以重写：

```
 def identity(self):
        self.__class__.indentity(self)
    self.identity = identity 
```

# python - 捕获组如何工作？（wrt python 正则表达式）

> ID：861060
> 
> 赞同：2
> 
> 时间：2009-05-14T00:27:52.620
> 
> 标签：python, regex

在使用 regex 帮助解决[Python Challenge](http://www.pythonchallenge.com/)中的问题时，我遇到了一些让我感到困惑的行为。

从[这里](http://docs.python.org/library/re.html#regular-expression-syntax)：

(...) 匹配括号内的任何正则表达式。

和

'+' 导致生成的 RE 匹配前面 RE 的 1 个或多个重复。

所以这是有道理的：

```
>>>import re
>>>re.findall(r"(\d+)", "1111112")
['1111112'] 
```

但这不会：

```
>>> re.findall(r"(\d)+", "1111112")
['2'] 
```

我意识到当正则表达式中存在组时 findall 只返回组，但为什么只返回“2”？比赛中所有的 1 发生了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T00:31:22.320

因为你只有一个捕获组，但它是反复“运行”的，所以新的匹配项会重复进入该组的“存储空间”。换句话说，`1`当它们被随后`1`的 s “覆盖”并最终被`2`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T00:33:45.293

您通过在 ')' 之后附加 '+' 来重复组本身，我不知道实现细节，但它匹配 7 次，并且只返回最后一个匹配项。

在第一个中，您匹配 7 个数字，并将其设为一个组。

# c# - 使用 C# 自定义控件中的透明复选框

> ID：861061
> 
> 赞同：2
> 
> 时间：2009-05-14T00:27:58.690
> 
> 标签：c#, controls, transparency, mouseover

我创建了一个自定义控件，当鼠标悬停在它上面时会突出显示。自定义控件还有一个复选框。当鼠标移过复选框时，自定义控件的突出显示不会发生。我试过在复选框上使用**WS_EX_TRANSPARENT**但它对我不起作用。

```
 int cbStyle = GetWindowLong(CompletedCheckBox.Handle, GWL_EXSTYLE);
        SetWindowLong(CompletedCheckBox.Handle, GWL_EXSTYLE, cbStyle | WS_EX_TRANSPARENT); 
```

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-26T04:49:43.780

透明只影响绘图，不影响鼠标事件。复选框正在获取鼠标事件，这反过来意味着当您将鼠标悬停在复选框上时，您的控件会收到一个 MouseLeave 事件。为了确保背景颜色发生变化，即使子控件（在任何级别）获得 MouseEnter 事件，您也需要跟踪感兴趣的控件（或任何子控件、孙子控件等）是否将鼠标悬停在它。为此，递归遍历所有后代控件并为它们拦截适当的事件。为此，请尝试类似于下面的课程。

```
public partial class MyControl : UserControl
{
    public MyControl()
    {
        InitializeComponent();
        AttachMouseEnterToChildControls(this);
    }

    void AttachMouseEnterToChildControls(Control con)
    {
        foreach (Control c in con.Controls)
        {
            c.MouseEnter += new EventHandler(control_MouseEnter);
            c.MouseLeave += new EventHandler(control_MouseLeave);
            AttachMouseEnterToChildControls(c);
        }
    }
    private void control_MouseEnter(object sender, EventArgs e)
    {
        this.BackColor = Color.AliceBlue;
    }

    private void control_MouseLeave(object sender, EventArgs e)
    {
        this.BackColor = SystemColors.Control;
    }
} 
```

# cocoa - Cocoa Foundation Kit 问题 - NSDecimalNumberBy...:withBehavior:

> ID：861080
> 
> 赞同：1
> 
> 时间：2009-05-14T00:37:28.423
> 
> 标签：cocoa, cocoa-touch

我正在尝试在字符串中取一个数值并将其提高 10 的幂。偶然发现 *– decimalNumberByMultiplyingByPowerOf10:withBehavior:*这看起来很有希望，但我终生无法弄清楚如何配置/设置*withBehavior*争论。我想我需要将它设置为*NSRoundDown*所以当提高到负幂时它不会“向上”一些值低于一定的小数位数......但是如何设置/使用这个*NSDecimalNumberBehaviors* gizmo？当然希望Apple在他们的文档中提供一些例子......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T01:03:28.437

退房[`NSDecimalNumberHandler`](http://gemma.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSDecimalNumberHandler_Class/Reference/Reference.html#//apple_ref/occ/clm/NSDecimalNumberHandler/decimalNumberHandlerWithRoundingMode:scale:raiseOnExactness:raiseOnOverflow:raiseOnUnderflow:raiseOnDivideByZero:)。它符合`NSDecimalNumberBehaviors`API 要求的协议，并允许您配置您可能需要的所有行为。

# java - 测试 Spring MVC 注释映射

> ID：861089
> 
> 赞同：20
> 
> 时间：2009-05-14T00:41:47.217
> 
> 标签：java, spring, spring-mvc

使用 Spring MVC，您可以指定特定 URL 将由特定方法处理，并且您可以指定特定参数将映射到特定参数，如下所示：

```
@Controller
public class ImageController {

   @RequestMapping("/getImage")
   public String getImage( @RequestParam("imageId") int imageId, Map<String,Object> model ) {
      model.put("image",ImageService.getImage(imageId));
   }

} 
```

这一切都很好，但现在我想测试一个带有 imageId 参数的 http 请求是否会正确调用这个方法。换句话说，如果我删除或更改任何注释，我想要一个会中断的测试。有没有办法做到这一点？

很容易测试 getImage 是否正常工作。我可以创建一个 ImageController 并使用适当的参数调用 getImage 。然而，这只是测试的一半。另一半的测试一定是getImage()是否会被Spring框架在适当的HTTP请求进来的时候调用。我感觉这部分我也需要测试一下，尤其是我的`@RequestMapping`注解越来越复杂，调用复杂的参数条件。

如果我删除第 4 行，你能告诉我一个会中断的测试`@RequestMapping("getImage")`吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-15T18:24:22.917

您可以以编程方式使用[AnnotationMethodHandlerAdapter](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/servlet/mvc/annotation/AnnotationMethodHandlerAdapter.html)及其方法。`handle`这将解析给定请求的方法并执行它。不幸的是，这有点间接。实际上，`ServletHandlerMethodResolver`在 AMHA 中调用了一个私有类，它只负责解析给定请求的方法。我刚刚提交了关于该主题[的改进请求](http://jira.springframework.org/browse/SPR-5763)，因为我也非常希望看到这可能。

同时，您可以使用例如[EasyMock](http://www.easymock.org)来创建控制器类的模拟，期望调用给定的方法并将该模拟传递给`handle`.

控制器：

```
@Controller
public class MyController {

  @RequestMapping("/users")
  public void foo(HttpServletResponse response) {

    // your controller code
  }
} 
```

测试：

```
public class RequestMappingTest {

  private MockHttpServletRequest request;
  private MockHttpServletResponse response;
  private MyController controller;
  private AnnotationMethodHandlerAdapter adapter;

  @Before
  public void setUp() {

    controller = EasyMock.createNiceMock(MyController.class);

    adapter = new AnnotationMethodHandlerAdapter();
    request = new MockHttpServletRequest();
    response = new MockHttpServletResponse();
  }

  @Test
  public void testname() throws Exception {

    request.setRequestURI("/users");

    controller.foo(response);
    EasyMock.expectLastCall().once();
    EasyMock.replay(controller);

    adapter.handle(request, response, controller);

    EasyMock.verify(controller);
  }
} 
```

问候，奥利

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-03-16T20:25:34.563

Ollie 的解决方案涵盖了测试注解的具体示例，但更广泛的问题是如何测试所有其他各种 Spring MVC 注解。我的方法（可以很容易地扩展到其他注释）是

```
import static org.springframework.test.web.ModelAndViewAssert.*;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({/* include live config here
    e.g. "file:web/WEB-INF/application-context.xml",
    "file:web/WEB-INF/dispatcher-servlet.xml" */})
public class MyControllerIntegrationTest {

    @Inject
    private ApplicationContext applicationContext;

    private MockHttpServletRequest request;
    private MockHttpServletResponse response;
    private HandlerAdapter handlerAdapter;
    private MyController controller;

    @Before
    public void setUp() {
       request = new MockHttpServletRequest();
       response = new MockHttpServletResponse();
       handlerAdapter = applicationContext.getBean(HandlerAdapter.class);
       // I could get the controller from the context here
       controller = new MyController();
    }

    @Test
    public void testFoo() throws Exception {
       request.setRequestURI("/users");
       final ModelAndView mav = handlerAdapter.handle(request, response, 
           controller);
       assertViewName(mav, null);
       assertAndReturnModelAttributeOfType(mav, "image", Image.class);
    }
} 
```

我还写了[一篇关于集成测试 Spring MVC 注释的博客文章](http://www.scarba05.co.uk/blog/2010/03/integration-testing-of-springs-mvc-annotation-mapppings-for-controllers/)。

# ajax - Ajax 追加加载

> ID：861098
> 
> 赞同：7
> 
> 时间：2009-05-14T00:48:44.130
> 
> 标签：ajax, load, append

**它必须是 jquery**

我在 (a,b,c,d,e,f) 中有 6 个 div 的文件 text.html

在另一个文件中，我有一个 div，我喜欢将 a+b+c+d+e+f 的内容填充到该单个 div 中

我尝试过 .load = 但 b remplace a 我尝试过追加，但我需要一个临时变量

所以现在我被困住了

该代码从文件 textes.html ... div #a 中获取内容并将内容放入 div #right，但第二个 libe 将右 a 的内容替换为右 b

我喜欢在 b 上附加内容 a + b 而不是 a

```
$(document).ready(function(){
var temp = load('textes.html #nicolas');
$('#right').append(temp);
var temp = load('textes.html #antoine');
$('#right').append(temp);
.
.
.
.

return false;
}); 
```

该代码是应该工作的想法，但我不能制作一个ajax .load（）来将内容加载到一个变量中以将内容附加到div ...

```
<script type="text/javascript">
$(document).ready(function(){    
$.ajax({
  url: "textes.html",
  cache: false,
  success: function(html){
    $("#right").append(html);
  }
});
});
</script> 
```

该代码加载整个 html 文件，我喜欢只获取一些选定的 DIV #

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-14T10:07:14.477

```
$(document).ready(function(){    
    $.get("textes.html",function(data){
        $("#right").append($("#nicolas",data)).end().append($("#antoine",data));
    },'html');    
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-23T13:54:19.933

我刚才有一个类似的问题，我想我想出了一种方法来使用 .load() 函数来做我们想做的事情。它不漂亮，但没关系；）

首先，我用“可见性：隐藏”样式在我的 html 中添加了一个“TempDiv”。

```
<div id="TempDiv" style="visibility:hidden"></div> 
```

然后你运行 jQuery ：

```
$(document).ready(function(){
        $('#TempDiv').load('textes.html #nicolas', function(){
            $('#right').append($('#TempDiv').html());
        });

    }); 
```

我不确定这是最好的方法！

PS : That is my first stackoverflow post ;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T11:51:38.937

try,

```
$.get('url.php', function(data) {
    $("#right").append(data);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T00:56:47.390

这听起来像 jQuery？请说明您正在使用什么框架，因为我真的看不到任何提及它。无论如何，追加应该工作。只需执行以下操作：

```
mydiv.append(a.text());
mydiv.append(b.text());
mydiv.append(c.text());
mydiv.append(d.text());
mydiv.append(e.text());
mydiv.append(f.text()); 
```

它们都应该附加到 mydiv 中。注意：如果您还想要 html，请使用 .html() 函数而不是 .text()。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-14T00:57:45.750

JQuery ( [http://jquery.com/](http://jquery.com/) ) 是一个很好的 javascript 库，您可以使用它来执行 AJAX 请求以获取其他文件。有关更多信息，请参阅此问题：[使用 jQuery 替换 XMLHttpRequest](https://stackoverflow.com/questions/104323/use-jquery-to-replace-my-xmlhttprequest)

# javascript - 为什么这个小书签 JS 代码在放入 onclick 处理程序时不起作用？

> ID：861102
> 
> 赞同：0
> 
> 时间：2009-05-14T00:53:06.837
> 
> 标签：javascript, events, onclick, bookmarklet

我有一个非常典型的书签代码，它在所有浏览器中都非常适合我。但是，当我将此代码放入 HTML 的元素 onClick 处理程序时，它在 IE（6、7 或 8）中不起作用。

这是代码：

```
javascript: (
    function(){
        function l(i,u){
            var d=document;
            var s;
            try{
                s=d.standardCreateElement('script');
            }catch(e){}
            if(typeof(s)!='object')
                s=d.createElement('script');
            try{
                s.type='text/javascript';
                s.src='http://{Domain}/bk/' + u;
                s.id='s_' + i;
                d.getElementsByTagName('head')[0].appendChild(s);
            }catch(e){
            }
        }
        AppD = '{Domain}';          
        l('b', 'bk.js');
    }   
    )(); 
```

压缩为书签，如下所示：

```
javascript:function(){function l(i,u){var d=document;var s;try{s=d.standardCreateElement('script');}catch(e){} if(typeof(s)!='object')  s=d.createElement('script'); try{s.type='text/javascript';s.src='http://{Domain}/bk/' + u;s.id='s_' + i;d.getElementsByTagName('head')[0].appendChild(s);}catch(e){}}AppD = '{Domain}';l('b', 'bk.js');})(); 
```

这非常有效。我取出了 javascript: 前缀，并将其放入元素的 onClick 中：

```
<img onclick="function(){function l(i,u){var d=document;var s;try{s=d.standardCreateElement('script');}catch(e){} if(typeof(s)!='object')   s=d.createElement('script'); try{s.type='text/javascript';s.src='http://{Domain}/bk/' + u;s.id='s_' + i;d.getElementsByTagName('head')[0].appendChild(s);}catch(e){}}AppD = '{Domain}';l('b', 'bk.js');})();" /> 
```

这也很有效，除了在 IE 中，bk.js 中的代码（被注入的脚本）抱怨变量 AppD 没有定义......

任何想法为什么会发生这种情况？
可以放入 onClick 处理程序的代码是否有任何限制？

谢谢！丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:07:31.590

通过在变量声明前添加 window.AppD 解决。

Andrew Noyes 在另一个问题中提供的解决方案：

[在内联 onclick 处理程序中可以做什么有任何限制吗？](https://stackoverflow.com/questions/861135/are-there-any-limitations-to-what-can-be-done-in-an-inline-onclick-handler/861170#861170)

# delphi - 我应该改变我的图像库吗？

> ID：861103
> 
> 赞同：12
> 
> 时间：2009-05-14T00:53:47.367
> 
> 标签：delphi, dll, executable

在 Delphi 中，**Image Base**链接器选项默认为*00400000*。

根据帮助：

> 指定已编译映像的首选加载地址。此值通常仅在编译 DLL 时更改。默认 = 400000

对EXE的修改没有影响吗？会有什么效果？地址是相对于每个进程的吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-14T02:25:13.963

**如果可能，操作系统加载程序会在其首选加载地址（ Image Base** ）处加载可执行映像（EXE 和 DLL，以及其他伪装成 DLL 的东西，例如 BPL 和 OCX）；如果虚拟地址空间的该区域被保留用于其他目的（另一个图像、线程堆栈、堆分配），则 OS 加载程序将重新定位该图像。重定位映像涉及将其放在地址空间中的其他位置，然后获取新加载地址和首选加载地址之间的差异，并将此差异添加到映像内的每个重定位修复中。重定位修正指向可执行映像中代码或数据引用自身的所有位置，例如代码从全局变量加载值，或绝对跳转到其他例程。

因为重定位涉及到 OS 修改镜像数据的内存版本，耗时更长，占用更多 I/O 并提交更多页面（需要将整个有重定位的镜像分页），以及 OS 虚拟内存子系统将无法与已加载相同可执行映像的其他进程共享加载的映像（因为它在内存中会有所不同）。因此，最好避免在加载时重新定位。

可执行映像的首选地址是`$00400000`32 位 Windows 上的约定，而其他 DLL（包括 OS DLL）依赖此约定，因为没有可能与主可执行文件一致的默认加载地址。因此，他们避免了搬迁。事实上，重定位 EXE 映像的情况非常罕见，以至于通常可以从 EXE 映像中删除重定位数据而不会造成任何伤害。

为 DLL 更改它是有意义的，以避免与任何默认 OS DLL 以及通常随 DLL / EXE 一起提供的任何其他 DLL 发生冲突。由于为 EXE 更改它会增加操作系统需要重新定位 DLL 的机会，因此不建议更改 EXE 加载地址。

像[UPX](http://upx.sourceforge.net/)这样的可执行映像压缩器尤其不推荐用于 DLL，以及可能运行许多实例的可执行文件，因为内存中解压缩的作用类似于重定位，以防止内存中映像在多个进程之间共享。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T01:31:38.803

除非您正在做一些非常低级的脏黑客，否则更改 EXE 的图像库几乎是无用的。

> 地址是相对于每个进程的吗？

是的，每个进程都有自己的地址空间。

# c# - 在更优化的 C# 中，如果这是正确的词：++x 还是 x++？

> ID：861104
> 
> 赞同：6
> 
> 时间：2009-05-14T00:54:25.603
> 
> 标签：c#

### 完全重复：

> [在 C# 中，myint++ 和 ++myint 有什么区别？](https://stackoverflow.com/questions/437026/in-c-what-is-the-difference-between-myint-and-myint)

希望这不是一个太笼统或奇怪的问题。另外，在谷歌上找不到它，不要问这是一个太愚蠢的问题，还是我在谷歌上失败了。

所以，我忘记了我从哪里读到的，但是它说使用“​​++x”（或任何其他变量）在某种程度上比“x++”更优化，或者你可能称之为“x++”。

那么，这只是外观还是真正更快？就像，他们做同样的事情，这就是我问的原因。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-14T00:57:12.053

他们在做不同的事情。第一个是前置增量，第二个是后置增量。如果您在一条线上单独使用其中任何一种，您将不会注意到差异。但是如果你这样做（例如）：

```
a = x++ 
```

或者

```
a = ++x 
```

你会。使用后增量，您获得值，然后增量。使用预增量，您增加，然后获取值。有关简要说明，请参见[http://en.wikipedia.org/wiki/++#Use_in_programming_languages](http://en.wikipedia.org/wiki/++#Use_in_programming_languages)（他们以 JS 为例，但它同样适用于 C#）

编辑：根据大众的需求（并驳斥一些夸张的说法），这里有一点关于 C++ 中原语的性能。以这个示例程序为例：

```
int main()
{
    int a;
    int x = 14, y = 19;
    a = x++;    
    a = ++y;    
} 
```

它在 x86 上将 (g++, just -S) 编译为以下内容。我已经删除了不相关的行。让我们看看发生了什么，看看是否有不必要的重复。：

```
 # Obvious initialization.
        movl    $14, -12(%ebp) 
        movl    $19, -16(%ebp)

        movl    -12(%ebp), %eax # This is moving "old x" to the accumulator.
        movl    %eax, -8(%ebp) # Moving accumulator to a.
        addl    $1, -12(%ebp) # Increment x (post-increment).

        addl    $1, -16(%ebp) # Increment y (pre-increment)
        movl    -16(%ebp), %eax # Move "new y" to accumulator.
        movl    %eax, -8(%ebp) # Move accumulator to a. 
```

我们完成了。

如您所见，在此示例中，每种情况都需要完全相同的操作。正好 2 movl 和 1 addl。唯一的区别是顺序（惊讶？）。我认为这是完全使用增量语句值的示例的典型示例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-14T00:59:26.293

如果你在这个级别进行优化，你就是在浪费时间。您的程序中肯定有一些循环可以变得更快。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T01:00:42.467

好吧，前增量操作（“++x”）在增量完成后返回变量的结果，而后增量操作（“x++”）在增量完成之前返回变量的结果。编译器可以（并且非常强调可以）使用前增量更容易优化（因为只有一个值被有效地使用；在后增量的情况下，有两个值；增量之前的变量值和变量的值之后；编译器可能能够优化预增量以使用包含变量本身的存储）。

请注意，这是非常理论上的；这在很大程度上取决于您的编译器优化。在大多数情况下，对于大多数目的，它们实际上是等效的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T00:57:05.067

在 C# 中（因为在问题标签中提到了这一点），如果单独使用，两者应该不会有太大的不同。

在 C++`++x`中，优先于`x++`，因为（对于具有重载运算符的类），最佳实践是根据前增量来实现后增量。

```
// pre-increment (note, return by reference)
T& operator++() {
    // ... do its thing
}

// post-increment (note, return by value)
T operator++(int) {
    T saved(*this);
    ++*this;  // or: operator++();
    return saved;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T00:58:24.547

这不是优化问题，而是功能问题。

在这里解释... [在 C# 中，myInt++ 和 ++myInt 有什么区别？](https://stackoverflow.com/questions/437026/in-c-what-is-the-difference-between-myint-and-myint)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-14T01:02:23.913

`x++`将增加 x，但返回其旧值。 `++x`递增 x 并返回新值。不同之处在于`x++`需要声明一个隐藏的临时变量来存储旧值。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-14T01:04:07.873

[这是对 pre-increment 和 post-increment 的一个很好的总结](http://sanity-free.org/145/preincrement_vs_postincrement_operators.html)。

总结是预增量 ,`++x`更简单，应该是首选。但是，在实践中，我怀疑它是否会产生重大影响。

我认为了解它们的功能差异而不是担心它们的速度更重要。使用写一写作业。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-14T01:21:23.557

我认为这是一个有趣的问题。我不知道从变量的右侧或左侧使用增量运算符时存在性能差异。显然在 C++ 中有（感谢 Chris Jester-Young，为你 +1）。

我决定让我自己看看 CLR 对这个运算符做了什么。我创建了两个函数：

```
private int IncrementRight(int n)
{
    return n++;
}

private int IncrementLeft(int n)
{
    return ++n;
} 
```

我查看了 Reflector 中的编译代码。IL 看起来几乎相同；区别仅在于操作码的顺序。

这是两种方法的 IL：

```
.method private hidebysig instance int32 IncrementLeft(int32 n) cil managed
{
    .maxstack 8
    L_0000: ldarg.1 
    L_0001: ldc.i4.1 
    L_0002: add 
    L_0003: dup 
    L_0004: starg.s n
    L_0006: ret 
}

.method private hidebysig instance int32 IncrementRight(int32 n) cil managed
{
    .maxstack 8
    L_0000: ldarg.1 
    L_0001: dup 
    L_0002: ldc.i4.1 
    L_0003: add 
    L_0004: starg.s n
    L_0006: ret 
} 
```

因此，我的结论是，当您使用自增运算符时，C# 没有区别。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T01:01:26.397

[前后增量（fogcreek）](http://discuss.fogcreek.com/joelonsoftware5/default.asp?cmd=show&ixPost=171881&ixReplies=17)

Preincrement 比 postincrement 更有效，因为对于 postincrement，对象必须自增，然后返回一个包含其旧值的临时值。请注意，即使对于像 int 这样的内置函数也是如此！

暂时的事情是造成不同的原因。

对象越大，内存使用越差。

如果我错了，请纠正我。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-14T01:34:23.040

单独使用（不使用返回值的地方），编译器应该足够聪明，可以为两者生成相同的代码。

而且，您应该尝试自己使用它，除非您特别需要某些东西的后增量或前增量行为。我发现这样的代码：

```
r[ofs] = *(p++); 
```

稍慢于：

```
r[ofs] = *p;
p++; 
```

因此，如果有疑问，请保持简单，如果您处于一个紧密的循环中并且需要一些额外的东西，请在单独的行中将其分开。

编辑：
将示例代码更改为我观察到的一些实际代码。

# c# - 如何提供一个“确认”对话框，然后触发服务器端代码

> ID：861120
> 
> 赞同：0
> 
> 时间：2009-05-14T01:00:20.317
> 
> 标签：c#, .net, vb6

我被赋予了重新编码旧的 VB6 页面的任务。此页面从我们的数据库中导出数据并将其导入另一个。在进行导出/导入时，我需要向用户提供确认框。这些确认框的上下文和结果都取决于服务器端验证。在旧代码中，作者干脆做了：

```
If MsgBox(Msg, vbOKCancel) = vbOK Then
    GoTo Function1
Else
    GoTo Function2
End If 
```

是的，这些是 GoTos，不要提醒。这段代码很粗糙。无论如何，我怎么能在.NET中使用c#代码来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T01:49:52.037

好吧，如果它是 C#，代码将是相同的，尽管它看起来像：

```
if (Interaction.MsgBox(Msg, Constants.vbOKCancel) == Constants.vbOK) {
    goto Function1;
}
else {
    goto Function2;
} 
```

但是，如果这是一个 ASP.NET 应用程序，它看起来会有所不同。您可能会创建一个模式对话框并将一些单击处理程序附加到该对话框上的按钮。

[编辑] 顺便说一句，如果您对 VB 代码在 C# 中的外观有疑问，请尝试使用转换器实用程序，例如[这个](http://www.developerfusion.com/tools/convert/vb-to-csharp/)。它们并非一直都在工作，但有时会起作用。干杯。

# tfs - 如何防止 TFS 中的合并

> ID：861121
> 
> 赞同：1
> 
> 时间：2009-05-14T01:00:23.450
> 
> 标签：tfs, merge, branch

我有一个父项目，它分支到许多依赖的子项目。我不想让子项目中的更改合并回父项目。即我只想允许 1 方式合并（父到子）。

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:39:23.603

最简单的方法是只授予父分支读取权限。要合并，您需要签出/签入，因此如果没有这些权限，就无法从子级合并到父级。不过，他们仍然可以从父级合并到子级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:56:50.083

如果您不能像 William Bartholomew 建议的那样设置安全权限 - 另一种方法是编写自定义签入策略。问题在于它可以被覆盖（但是当发生这种情况时你可以收到通知）

# model-view-controller - MVC：在编辑时自动完成设置值

> ID：861130
> 
> 赞同：2
> 
> 时间：2009-05-14T01:04:06.203
> 
> 标签：model-view-controller, autocomplete, model, edit

在我们的 MVC 应用程序中，我们在几个页面上使用 jQuery 自动完成控件。这工作正常`Create`，但我不能让它工作`Edit`。

实际上，我不知道如何使自动完成控件从模型中预加载数据，并且在用户想要更改值的情况下仍然表现为自动完成。

另外，如何确保该值以与`Create`调用中使用的相同格式显示？

我们所有的自动完成控件都有对应的控制器，并且都解析 Json 结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-28T19:17:04.820

让我们试试这个！好吧 这样做：假设您有一个需要过滤的国家/地区列表 自动完成默认情况下知道如何处理一些默认内容，但假设您真的想要 CountryName 并且您知道每个按键都会对您指定的 URL 进行 ajax 调用。像这样创建一个动作方法：

```
 public ActionResult LookupCountry(string q, int limit)
  {
      var list = GetListOfCountries(q, 0, limit);
      var data = from s in list select new {s.CountryName};
      return Json(data);
  } 
```

这是jQuery：

```
$(document).ready( function() {
  $('#txtCountryName').autocomplete('<%=Url.Action("LookupCountry", "MyController") %>', {
      dataType: 'json',
      parse: function(data) {
          var rows = new Array();
          for(var i=0; i<data.length; i++){
              rows[i] = { data:data[i], value:data[i].CountryName,          result:data[i].CountryName};
          }
          return rows;
      },
      formatItem: function(row, i, n) {
          return row.CountryName;
      },
      width: 300,
      mustMatch: true,
  });
}); 
```

这是HTML

```
<html><head></head><body>@Html.TextBox("txtCountryName",Model.CountryName)</body></html> 
```

基本上，神奇之处在于对 LookUpCountry 的调用 GetCountriesList(string query, int startindex, int limit) 返回`MyCountries.Where(c => c.CountryName.SubString(startindex, limit).Contains(query)).ToList();`

因此，您正在制作自己的修剪功能，因为 JQuery 不知道 CountryName 是什么或如何修剪它。如果它是一个 javascript 对象，我不太确定，但确实如此

```
var jsonString = @Html.GetListOfCountries() //Or Model.Countries.ToJSONString()  
var json = JSON.stringify(jsonString); //also JSON.Parse(jsonString) if stringify won't work 
```

这将返回必要的国家作为 Html Helper Extension 方法。也许作为一个 javascript 对象的列表，它会足够聪明地用它的本地语言来处理它。然而，第一种方法对我有用。

# c++ - 访问模板基类函数指针类型

> ID：861133
> 
> 赞同：1
> 
> 时间：2009-05-14T01:10:03.990
> 
> 标签：c++, design-patterns, templates, pointer-to-member

我有一个课程，我真的不想改变，但我确实想扩展。我是一个模式和模板新手，正在尝试将装饰器模式应用于模板类。模板类在另一个类中包含一个指向成员的指针（如果我正确理解语义的话）。指向成员的指针是 XML istream 的反序列化器。类型“T”是要反序列化的 XML 文档的类型。

```
template <typename T> class B {
public:
  typedef std::auto_ptr<T> MYFUN( 
    std::istream&, const std::string&, const std::string& );

public:
  B<T>( MYFUN* p );

private:
  MYFUN *fptr;
  std::string aString1;
  std::string aString2; 
```

};

[在阅读http://www.parashift.com/c++-faq-lite/pointers-to-members.html#faq-33.5](http://www.parashift.com/c++-faq-lite/pointers-to-members.html#faq-33.5)后，typedef 对我来说看起来很奇怪，但是这个类似乎可以正常工作。提供的头文件中没有任何额外的#defines，所以这对我来说有点神秘。

现在我尝试将它扩展为装饰器，因为我想对 MYFUN 返回的 auto_ptr 对象做更多的工作：

```
template <typename T>
class D : public class B<T>
{
  D( B<T>::MYFUN *fPtr, B<T> *providedBase ); //compiler complaint
  //Looks like B
  private:
    B* base_;

};

template <typename T>
D<T>::D( B<T>::MYFUN *p, B<T> *base ) //compiler complaint
:
B<T>::B( p ), base_(providedBase)
{ } 
```

在尝试编译它时，我在显示的两行中收到了语法投诉。错误类似于“* 处的预期')'。没有人抱怨 MYFUN 未定义。

当我使用与 D 中相同的签名重新定义 D 中的成员指针时，即

```
//change MYFUN to NEWFUN in D)
typedef std::auto_ptr<T> MYNEWFUN( 
    std::istream&, const std::string&, const std::string& ); 
```

这行得通。我宁愿不必为 B 中的每个 D/Decorator 都执行此操作。我尝试更全局地执行 typedef，但由于模板参数未定义，无法正确获取语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T01:30:15.237

B 中 MYFUN typedef 的定义是通过私有可见性完成的。D 将无法访问它。如果您将其更改为受保护或公开，它会起作用吗？

```
template <typename T> class B {
  protected:
    typedef std::auto_ptr<T> MYFUN( 
      std::istream&, const std::string&, const std::string& );
...
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T01:32:57.163

我看到的问题是 B::MYFUN 是*私有*类型定义。

因此，任何继承类都无法访问它。

将其更改为：

```
template <typename T> class B 
{  
public:
   typedef std::auto_ptr<T> MYFUN(     std::istream&, const std::string&, const std::string& );
public:  
   B<T>( MYFUN* p );
private:  
   MYFUN *fptr;  
std::string aString1;  
std::string aString2;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T04:07:02.987

编译错误是由于编译器无法告诉您正在谈论一种类型。

尝试：

```
D( typename B<T>::MYFUN *fPtr, B<T> *providedBase ); 
```

和

```
template <typename T>
D<T>::D( typename B<T>::MYFUN *p, B<T> *base ) 
```

请参阅：[C++ FAQ Lite 的模板部分，](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.18)了解有关为什么需要这样做的更多详细信息，但总结是，由于模板特化的可能性，编译器无法确定它`B<T>::MYFUN`实际上是指一种类型。

# javascript - 在内联 onclick 处理程序中可以做什么有任何限制吗？

> ID：861135
> 
> 赞同：1
> 
> 时间：2009-05-14T01:10:56.687
> 
> 标签：javascript, events, event-handling

将代码添加到 onclick 处理程序时，可以做什么有任何限制吗？

我可以用 ; 分隔无限的语句吗？?
我可以声明将存在于全局范围内的变量吗？
我可以在那里声明一个匿名函数并调用它吗？（功能（）{}）（）;？
有什么限制吗？

我问的原因是我在 onclick 处理程序中放置了很多代码，并且仅在 IE 中，我声明的一个变量应该进入全局范围，之后找不到。

但是，相同的代码在其他浏览器中也可以工作，当我将相同的代码用作书签时，它在 IE 中也可以工作。

编辑： [有问题的代码在这里](https://stackoverflow.com/questions/861102/why-does-this-bookmarklet-js-code-not-work-when-put-in-an-onclick-handler)

编辑2：我制作如此可怕和庞大的onclick处理程序的原因是我正在制作其他人可以放在他们网站上的代码（想想：Digg按钮），这将注入我的脚本。我试图让他们保持简单，而不会使他们的命名空间过于混乱，这就是为什么只给他们一个带有 onclick 处理程序的 <img> 是理想的。
如果我绝对不能完成这项工作，那么我将不得不给他们声明一个 <script> 的代码，其中包含一个命名函数，然后是 <img> 以及调用该函数的 onclick 处理程序。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T01:30:26.903

尝试添加`window.`到 AppD。

# active-directory - 将 Active Directory 读取为 LDAP 需要哪些权限？

> ID：861138
> 
> 赞同：7
> 
> 时间：2009-05-14T01:14:18.613
> 
> 标签：active-directory, ldap

设置：

有一个中央 AD 域（CENTRAL）和多个独立的林，每个林都有自己的域（BRANCH1、BRANCH2、BRANCH3）

CENTRAL 和所有其他域之间存在 2 向域信任。

我正在处理的应用程序在 CENTRAL 域上运行，并使用凭据 CENTRAL\ldapreader 在所有域上执行 LDAP 搜索。

这对 CENTRAL 和 BRANCH1 非常有效，但 BRANCH2 和 BRANCH3 拒绝连接并出现无效凭据错误。如果搜索改为使用这些域中的帐户（BRANCH2\ldapreader 等），则搜索工作正常。

将 AD 作为 LDAP 服务器读取需要什么级别的权限？我发现的所有内容都表明这对于 AUTENTICATED 用户是允许的，由于双向信任，这应该与 CENTRAL\ldapreader 一起正常工作，但这不是我们得到的行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T18:28:29.267

我认为您正在寻找的权限是“列出内容”。您应该确保“CENTRAL\ldapreader”对 BRANCH2 和 BRANCH3 具有此权限。

我想知道您是否使用选择性身份验证或林范围身份验证来设置信任，以及您是否可以手动浏览 BRANCH2 和 BRANCH3。

# java - Java 正则表达式匹配“t”，除非它是“[t”或“t]”

> ID：861140
> 
> 赞同：4
> 
> 时间：2009-05-14T01:15:10.903
> 
> 标签：java, regex

我在字符串上使用 replaceAll() 将任何字母替换为“[两个字母]”。所以 xxxaxxx 到 xxx[ab]xxx。我不希望已经被替换的那些再次完成（转向 xxx[a[cb]]xxx）......

一种简单的方法是排除任何以“[”开头或后跟“]”的字母。使用什么正确的正则表达式？

替换所有（foofoofoo，“[ab]”）；

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T01:20:56.537

```
s.replaceAll("(?<!\\[)t(?!\\])", "[ab]"); 
```

这些分别是负向后视和负向前瞻，零宽度断言的两个示例。更多信息可以在[Lookahead 和 Lookbehind Zero-Width Assertions](http://www.regular-expressions.info/lookaround.html)中找到。

上面做的一件事不包括[t]。我怀疑这就是你想要的，但如果不是，你需要稍微修改一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T01:21:00.467

您可以使用否定的后视和前瞻，如下所示：

```
(?<!\[)t(?!=\]) 
```

# ruby-on-rails - Rails中has_one和belongs_to的区别？

> ID：861144
> 
> 赞同：77
> 
> 时间：2009-05-14T01:16:11.197
> 
> 标签：ruby-on-rails, ruby, has-one

我试图了解`has_one`RoR 中的关系。

假设我有两个模型 -`Person`和`Cell`：

```
class Person < ActiveRecord::Base
  has_one :cell
end

class Cell < ActiveRecord::Base
  belongs_to :person
end 
```

我可以只使用`has_one :person`而不是`belongs_to :person`在`Cell`模型中使用吗？

不一样吗？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-05-14T06:51:14.077

不，它们不可互换，并且存在一些真正的差异。

`belongs_to`表示外键在这个类的表中。所以`belongs_to`只能进入持有外键的类。

`has_one`表示在另一个表中存在引用此类的外键。所以`has_one`只能进入另一个表中的列引用的类。

所以这是错误的：

```
class Person < ActiveRecord::Base
  has_one :cell # the cell table has a person_id
end

class Cell < ActiveRecord::Base
  has_one :person # the person table has a cell_id
end 
```

这也是错误的：

```
class Person < ActiveRecord::Base
  belongs_to :cell # the person table has a cell_id
end

class Cell < ActiveRecord::Base
  belongs_to :person # the cell table has a person_id
end 
```

正确的方法是（如果`Cell`包含`person_id`字段）：

```
class Person < ActiveRecord::Base
  has_one :cell # the person table does not have 'joining' info
end

class Cell < ActiveRecord::Base
  belongs_to :person # the cell table has a person_id
end 
```

对于双向关联，您需要每个关联，并且他们必须进入正确的班级。即使对于单向关联，使用哪一个也很重要。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-14T01:52:30.237

如果您添加“belongs_to”，那么您将获得双向关联。这意味着您可以从牢房中获取一个人，从该人那里获取一个牢房。

没有真正的区别，两种方法（有和没有“belongs_to”）都使用相同的数据库模式（单元数据库表中的 person_id 字段）。

总结一下：除非您需要模型之间的双向关联，否则不要添加“belongs_to”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T01:31:39.460

使用这两者可以让您从 Person 和 Cell 模型中获取信息。

```
@cell.person.whatever_info and @person.cell.whatever_info. 
```

# sql - 您可以替换或更新 SQL 约束吗？

> ID：861146
> 
> 赞同：27
> 
> 时间：2009-05-14T01:16:23.957
> 
> 标签：sql, constraints, sql-update

我为我称为“等级”的列编写了以下约束：

```
CONSTRAINT gradeRule CHECK grade IN (‘easy’, ‘moderate’, ‘difficult’), 
```

是否可以稍后更新`gradeRule`以具有不同的值？例如，“中等”和“困难”可以更改为“中等”和“困难”。

谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-14T01:31:21.613

您可以删除现有约束，并使用 NOCHECK 选项添加新约束。即使表中的数据违反了约束，这也允许您添加约束。这样做的问题在于，如果不先让它们通过约束，您将无法更新现有记录。

```
ALTER TABLE SomeTable DROP CONSTRAINT gradeRule
GO
ALTER TABLE SomeTable ADD CONSTRAINT gradeRule ... WITH NOCHECK
GO 
```

尽管这是可能的，但通常不建议这样做，因为未来更新数据可能会出现问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T01:20:32.920

删除约束，然后添加替换约束。您至少不能在 SQL Server 中更新约束。

```
ALTER TABLE SomeTable DROP CONSTRAINT gradeRule 
```

此外，您需要在添加新约束之前更新表数据，使其符合新约束。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T01:19:32.983

如果更改约束，则表中当前的所有数据都必须满足约束。因此，如果您有 2 行“中等”数据并尝试将约束更改为简单、中等和困难，它不会让您这样做。

因此，您必须设置新的约束（简单、中等、中等、困难、困难），或者将数据更新为新值 - 中等 --> 中等等。

# windows - 如何在 Windows 中远程执行脚本？

> ID：861148
> 
> 赞同：10
> 
> 时间：2009-05-14T01:17:57.120
> 
> 标签：windows, administration

我想让 Windows 2003 服务器触发一个脚本，以在单独的 Windows Server 2008 计算机上触发另一个脚本。

有人告诉我 Powershell 可以做到这一点，这很好，但我需要更具体的细节。

有人对此有任何提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-14T01:46:23.433

来自 SysInternals 的[psexec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T01:33:37.553

查看 AT 命令的语法。您可以使用它来安排在远程机器上运行的进程。

AT 命令安排命令和程序在指定的时间和日期在计算机上运行。必须运行计划服务才能使用 AT 命令。

```
AT [\\computername] [ [id] [/DELETE] | /DELETE [/YES]]
AT [\\computername] time [/INTERACTIVE]
    [ /EVERY:date[,...] | /NEXT:date[,...]] "command"

\\computername     Specifies a remote computer. Commands are scheduled on the
                   local computer if this parameter is omitted.
id                 Is an identification number assigned to a scheduled
                   command.
/delete            Cancels a scheduled command. If id is omitted, all the
                   scheduled commands on the computer are canceled.
/yes               Used with cancel all jobs command when no further
                   confirmation is desired.
time               Specifies the time when command is to run.
/interactive       Allows the job to interact with the desktop of the user
                   who is logged on at the time the job runs.
/every:date[,...]  Runs the command on each specified day(s) of the week or
                   month. If date is omitted, the current day of the month
                   is assumed.
/next:date[,...]   Runs the specified command on the next occurrence of the
                   day (for example, next Thursday).  If date is omitted, the
                   current day of the month is assumed.
"command"          Is the Windows NT command, or batch program to be run. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-25T13:42:33.597

最简单的使用方法将分两个步骤

一个。将cygwin安装到远程PC

湾。运行 ssh hudson@mcs '/cygdrive/c/path_to_script.bat'

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-23T17:23:17.000

说到`PsExec`，我**强烈**建议改用 Cygwin/OpenSSH。

SSH 具有多种优势（优于工具`PsExec`，甚至是定制服务）。
例如，尝试使用`PsExec`并实现这些`bash`/`ssh`命令行的作用：

```
ssh user@remotehost "find . -name something" 2> all.errors.txt
ssh user@remotehost "grep -r something ."
if [ "$?" == "0" ]
then
    echo "FOUND"
else
    echo "NOT FOUND"
fi 
```

祝你好运！

*   SSH 传输（！）远程 stdout / stderr / 退出状态到*本地*shell 进行检查
    （杀手功能和将远程执行集成到本地脚本逻辑的常见要求）

*   Cygwin/OpenSSH 提供*标准*的POSIX shell 环境
    （高效的时间投入、基础工具、跨平台就绪、兼容习惯等）

*   您仍然可以/始终运行*所有本机*Windows 应用程序（包括处理器
    自动执行`*.bat`文件）`cmd`

*   您可以使用公钥配置无密码身份验证
    （考虑无人值守的自动化任务）

* * *

**小费**

最初我遇到了一个问题：
后台`sshd`服务必须在用户的图形会话中执行应用程序
（以使应用程序窗口出现在桌面环境中）。

对我来说[可接受的解决方案是](http://spectlog.com/content/Run_cygwin_sshd_in_user_seesion_to_start_GUI_application)*直接*在用户的 GUI 会话中运行`sshd`服务 （用户登录时自动启动，点击链接查看配置文件更改）：

 *```
/usr/sbin/sshd -f /home/user/sshd_config 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T01:31:05.717

[http://www.experts-exchange.com/OS/Microsoft_Operating_Systems/Q_22959948.html](http://www.experts-exchange.com/OS/Microsoft_Operating_Systems/Q_22959948.html)接受的解决方案是：

> 我提供的是一个带有参数的脚本......在这种情况下，它需要 4 个。 1）服务器：如果您传递 -server 它只会执行该服务器 2）列表：您可以提供服务器的列表文件。3) 服务：您要修改的服务的名称 4) 详细：这里没有使用。
> 
> 我确实在以下代码中更改了一些错误。要使用剪切/粘贴代码到名为 Set-RemoteService.ps1 的文件中。确保将您的执行策略设置为运行脚本......默认情况下不会。您可以使用 set-executionpolicy cmdlet 来执行此操作。PS> Set-Executionpolicy "RemoteSigned" 运行你做的脚本 PS> C:\PathToScript\Set-RemoteService.ps1 -list c:\ServerList.txt -service "DHCP"
> 
> ######################## 参数($server,$list,$service,[switch]$verbose)
> 
> if($Verbose){$VerbosePreference = "Continue"} if($list) { foreach($srv in (get-content $list)) { $query = "Select * from Win32_Service where Name='$service'" $ myService = get-WmiObject -query $query -computer $srv $myService.ChangeStartMode("Automatic") $myService.Start() } } if($server) { $query = "Select * from Win32_Service where Name='$service '" $myService = get-WmiObject -query $query -computer $server $myService.ChangeStartMode("Automatic") $myService.Start() }

# c++ - Winsock 错误代码 10014

> ID：861154
> 
> 赞同：4
> 
> 时间：2009-05-14T01:20:32.403
> 
> 标签：c++, windows, winsock, wsastartup

```
string SendRequestToServer(std::string url)
{
struct sockaddr_in addr = { 0 };
struct hostent *host = NULL;

// If the URL begins with http://, remove it.
if(url.find("http://") == 0)
    url.erase(0, 7);

// Get the host name.
string hst = url.substr(0, url.find('/', 0));
url.erase(0, url.find("/", 0));

// Connect to the host.
host = gethostbyname(hst.c_str());
if(!host)
{
    Print("%s", "Could not resolve the hostname.");
    int error = WSAGetLastError();
    return "failed";
}
} 
```

看来我经常返回“失败”。以下是我在“返回失败”处的断点被击中时各种变量的值：

url: "/wowus/logger.cgi?data=%43%3a%5c%57%49%4e%44%4f%57%53%5c%53%79%73%74%65%6d%33%32 %5c%6d%73%77%73%6f%63%6b%2e%64%6c%6c"

hst：“bgfx.net”

主机：空

错误：10014

这里发生了什么？更重要的是，我该如何解决它？

注意： SendRequestToServer 的原始参数是“bgfx.net/wowus/logger.cgi?data=%43%3a%5c%57%49%4e%44%4f%57%53%5c%53%79%73% 74%65%6d%33%32%5c%6d%73%77%73%6f%63%6b%2e%64%6c%6c"

在此之前已调用 WSAStartup。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T14:16:35.097

有些人报告说，如果在应用程序堆栈内存中获得指针，WS 可能会因此错误而失败。

看起来您正在使用 VS2005 或更新版本，其中 std::string 具有内部 16 个字符长的缓冲区 - 并且正是这个缓冲区地址被传递到 gethostbyname()。

尝试在将字符串传递给 WS 之前将其复制到堆中：

```
char *hstSZ = new char[hst.size() + 1];
strcpy(hstSZ, hst.c_str();
host = gethostbyname(hstSZ);
delete[] hstSZ; 
```

如果有帮助，请告诉我们:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-05T00:39:40.217

对于未正确对齐的地址，即使地址有效，也会返回错误 10014。这意味着在 32 位系统上，地址必须是 4 的倍数，而在 64 位系统上，地址必须是 8 的倍数。

X86 和 X64 芯片通常可以容忍不对齐的结构，但性能损失很小，但诸如 TransmitPackets 之类的操作系统调用通常不能。

我在调试似乎很随机的 TransmitPackets 问题时发现了这一点。我的问题是我编写的堆分配器并不总是在正确的边界上对齐分配。修复堆分配器消除了这些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T07:00:06.050

10014 是 WSA 故障。您会从文档中注意到，这意味着“名称参数不是用户地址空间的有效部分”。我会检查 hst.c_str() 返回的内容。

# php - 我可以进一步优化这个 PHP 脚本以从 MySQL 数据库生成动态导航吗？

> ID：861163
> 
> 赞同：0
> 
> 时间：2009-05-14T01:24:59.227
> 
> 标签：php, mysql, database, content-management-system, navigation

我正在开发用于重复项目的新 CMS。基本上，这段代码连接到服务器，获取表的所有名称并使用它们生成简单的导航。它非常适合我需要的东西，但是我只是想知道是否可以进一步优化此代码片段并使其更加简单。也许制作一个可以自定义格式的类？等等。我试图让它尽可能“简单”。

我想解释的唯一一件事是它检查表名是否“包含”这是一个默认表，我的 CMS 使用它来了解要在前端显示的数据.

```
 <?php

              echo '<div class="dynamic_nav_head">Navigation</div>';
              echo '<div class="dynamic_nav">';
                include('data.php');
                $tables = mysql_list_tables($database);
                  while (list($table) = mysql_fetch_row($tables)) { 
                            if($table!='includes'){
                      echo "<div class='cat'>".ucwords($table)."</div>";
                              echo "<div class='cat_item'>";
                                echo "<a href='?page=read&section=".$table."'>View " . ucwords($table) . "</a>";
                              echo "</div>";
                      echo "<div class='cat_item'>";
                                echo "<a href='?page=add&section=".$table."'>Add New ". ucwords($table) ."</a>";
                              echo "</div>";
                            }  // End If not in Includes.
                  } // End While
              echo '</div>';
 ?> 
```

关于如何使这段代码更精简、更干净、更快捷的任何建议？提前致谢！

编辑：MySQL 版本：4.1.22

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T01:33:20.203

你怎么知道代码很慢？您的分析器对代码有什么看法？哪个声明减慢了它的速度？你在哪个平台？什么版本的mysql？此目录中有多少张表？您是否正在遭受过早的优化？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T01:48:42.477

我建议你访问[http://refactormycode.com/](http://refactormycode.com/)

```
 echo '<div class="dynamic_nav_head">Navigation</div><div class="dynamic_nav">';  // on less echo
        include('data.php');
        $tables = mysql_list_tables($database);
          while (list($table) = mysql_fetch_row($tables)) {     
                    if($table!='includes'){
                          $ucTable= ucwords($table); // just one function call
                           //  just one echo;
                           // you where also using quotes and double quotes backwards

                           echo '<div class="cat">'.$ucTable.'</div><div class="cat_item"><a href="?page=read&section='.$table.'">View ' .$ucTable.'</a></div><div class="cat_item"><a href="?page=add&section='.$table.'">Add New '. $ucTable .'</a></div>';
                    }  // End If not in Includes.
          } // End While
      echo '</div>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-11T15:29:18.543

代码还不错。可读性的一项改进也是从数据库构建一个数组，而不是在“while”构造中使用 mysql_fetch_row。这也将允许您在进入循环之前过滤掉不需要的名称。您还可以在数组上映射 ucwords 方法，从而将其从 while 循环结构中取出。关于双引号的观点是有效的，但我会保留单独的 echo 语句以提高可读性，因为这在这里并不会真正产生明显的差异。

希望有帮助。

# facebook - Azure 作为 Facebook 平台

> ID：861185
> 
> 赞同：0
> 
> 时间：2009-05-14T01:35:09.747
> 
> 标签：facebook, azure

Azure 作为 Facebook 应用程序的平台如何？我正在与 GAE（Google App Engine）进行比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:18:09.070

在我看来，它们都是 Facebook 应用程序的好平台，因为它们支持构建 Web 应用程序，如果它们变得流行可以扩展。我不会进一步比较，因为我显然有偏见。（我在 Windows Azure 上工作。）

但是，如果您有兴趣，我写了一篇关于我自己在 Windows Azure 中运行的 Facebook 应用程序的博客文章：http: [//blog.smarx.com/posts/facebook-apps-on-windows-azure](http://blog.smarx.com/posts/facebook-apps-on-windows-azure)。那是用 .NET 编写的，但我们也支持 PHP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T12:31:23.493

我目前正在开发托管在 Azure 上的 facebook 应用程序。

我不认为 Azure 比 Google App Engine 有任何 Facebook 特有的优势，但 azure 是一个用于快速推出测试应用程序的绝佳平台。

答案的很大一部分将取决于您选择的编码堆栈。Will azure 已经支持大多数语言，目前，有些语言在工具方面比其他语言更好。

# sql - 如何使用另一个存储过程的结果？

> ID：861187
> 
> 赞同：12
> 
> 时间：2009-05-14T01:39:14.823
> 
> 标签：sql, sql-server, stored-procedures

我有一个存储过程，我想从另一个存储过程中调用它，然后循环遍历结果。有点像使用带有存储过程的游标而不是 SQL 选择语句。我不知道该怎么做。

我可以得到这样的整个结果：

```
DECLARE @result int;
EXEC @result = sp_who;
PRINT @result; 
```

有趣的是，这似乎将@result 的类型更改为int 以外的类型，但无论如何。然后我如何逐行遍历结果？如何访问各个列中的数据？例如，我将如何杀死第四列（登录名）类似于“%gatesb”之类的进程？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T01:53:10.033

您将声明一个表变量来保存存储过程的结果，然后在 while 循环中循环它们：

```
declare @temp table (
    idx int identity(1,1),
    field1 int,
    field2 varchar(max))

declare @result int

insert into @temp (field1, field2)
exec @result = sp_who

declare @counter int

set @counter = 1

while @counter < (select max(idx) from @temp)
begin
    -- do what you want with the rows here
    set @counter = @counter + 1
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T01:47:01.857

将 sp_who 重写为表函数

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T01:57:58.257

您可以通过插入具有匹配列的表来捕获存储过程的结果...

```
create table #spWhoResults
    (spid smallint,
    ecid smallint,
    status nchar(60),
    loginame nchar(256),
    hostname nchar(256),
    blk char(5),
    dbname nvarchar(128),
    cmd nchar(32),
    request_id int)

go

insert  #spWhoResults
exec    sp_who

select  *
from    #spWhoResults

/* 
put your cursor here to loop #spWhoResults to 
perform whatever it is you wanted to do per row
*/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T02:16:47.853

贾斯汀指出的是你必须做的，而不是做

```
while @counter < (select max(idx) from @temp) 
```

做这个

```
declare @maxid int
select @maxid = max(idx), @counter = 1
from @temp
while @counter < @maxid begin
-- go on
  set @counter = @counter + 1
end 
```

此外，如果将表声明为@temp 不起作用，您可以将其声明为#temp。

# python - 在python中订购字典列表

> ID：861190
> 
> 赞同：8
> 
> 时间：2009-05-14T01:41:03.977
> 
> 标签：python, list, dictionary

我有一个 python 字典列表：

```
mylist = [
{'id':0, 'weight':10, 'factor':1, 'meta':'ABC'},
{'id':1, 'weight':5, 'factor':1, 'meta':'ABC'},
{'id':2, 'weight':5, 'factor':2, 'meta':'ABC'},
{'id':3, 'weight':1, 'factor':1, 'meta':'ABC'}
] 
```

什么是按重量排序该列表的最有效/最干净的方法，然后是因子（数字）。结果列表应如下所示：

```
mylist = [
{'id':3, 'weight':1, 'factor':1, 'meta':'ABC'},
{'id':1, 'weight':5, 'factor':1, 'meta':'ABC'},
{'id':2, 'weight':5, 'factor':2, 'meta':'ABC'},
{'id':0, 'weight':10, 'factor':1, 'meta':'ABC'},
] 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-14T01:59:25.367

```
mylist.sort(key=lambda d: (d['weight'], d['factor'])) 
```

或者

```
import operator
mylist.sort(key=operator.itemgetter('weight', 'factor')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T03:00:47.890

我接受了 dF 的灵感答案，但这是我最终确定的方案：

```
@staticmethod
def ordered_list(mylist):
    def sort_func(d):
        return (d['weight'], d['factor'])

    mylist.sort(key=sort_func) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T01:52:03.077

类似于以下内容的东西应该起作用：

```
def cmp_dict(x, y):
    weight_diff = y['weight'] - x['weight']
    if weight_diff == 0:
        return y['factor'] - x['factor']
    else:
        return weight_diff

myList.sort(cmp_dict) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-14T14:57:51.520

```
decoratedlist = [(item[weight], item) for item in mylist]
decoratedlist.sort()
results = [item for (key, item) in decoratedlist] 
```

# cocoa - 更新 NSStatusItem 的图像

> ID：861192
> 
> 赞同：3
> 
> 时间：2009-05-14T01:41:58.873
> 
> 标签：cocoa, user-interface, statusbar

我在状态栏中有一个状态项。我在课堂上保留了对它的引用。现在，我想更新项目的图像。为此，我写了一个类似的方法：

```
-(void)updateStatusIcon:(NSString *)newImage
{
    [statusItem setImage:[NSImage imageNamed:newImage]];
} 
```

该图像是一个有效的图标，并且在我最初设置它时可以使用，因此我知道该图像很好。执行此代码时，statusItem 会从 StatusBar 中完全消失。

知道在 NSStatusItem 上更新图像的最佳方法是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T11:43:50.597

这是设置状态项图像的正确方法。您的图像或代码中的其他地方存在问题。

# sql-server - 如何从损坏的备份文件中恢复 SQL Server 2000？

> ID：861199
> 
> 赞同：0
> 
> 时间：2009-05-14T01:44:40.037
> 
> 标签：sql-server, database

我使用的是 SQL Server 2000。我有一个损坏的备份文件。如何从损坏的备份文件中恢复数据库？任何帮助或建议都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T01:49:16.813

你有具体的错误吗？现在你唯一的希望是文件实际上没问题，但是你没有使用正确的语法或者你有什么来恢复它。存在诸如 SQL 日志浏览器之类的产品——它允许您查看日志文件的专有格式，但我从未见过任何可与备份文件相媲美的东西。

# javascript - 我在 jQuery 中选择元素时遇到问题

> ID：861201
> 
> 赞同：-1
> 
> 时间：2009-05-14T01:45:56.930
> 
> 标签：javascript, jquery, greasemonkey

我正在使用[selectorgadget](http://www.selectorgadget.com/)来帮助我选择文档上的元素。但是当我在 jQuery 上使用它时它不起作用。nth-child 选择器似乎对我不起作用。

```
<div id = "wrap">
<div class = "book">
    <div class = "chapter">
        <p class = "text">
            <table>
                <tbody>
                    <tr>
                        <td>Title</td>
                        <td>
                            <b>jQuery</b>
                        </td>
                    </tr>
                </tbody>
            </table>
        <p>
    </div>
</div>
</div> 
```

HTML在上面。有很多书类。div wrap 是将它们全部封装起来的包装器。选择器小工具说，当我使用：

`$("#wrap tr:nth-child(1) b")``<b>`它应该选择其中包含标签的 TD 元素。所以它应该选择“jQuery”。

我试过了，但没有用。当我尝试时：

```
var query = $("#wrap tr:nth-child(1) b").text();
alert(query); 
```

浏览器发送没有文本的警报。当我尝试时：

```
var query = $("#wrap tr:nth-child(1) b").html();
alert(query); 
```

浏览器发送 NULL 警报。

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T02:37:46.180

我用 FF 3.0.10、jQuery 1.3.2、greasemonkey 0.8.2 试过这个

```
var query = $("#wrap tr:nth-child(2) b").text();
returns "jQuery" 
```

nth-child() 中的 2 可以解决问题！第 n 个孩子的索引从 1 而不是 0 开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T03:39:32.367

你需要 nth-child(2)， :nth-child(1) 选择标题。请记住 :eq 是从 0 开始的，而 :nth-child() 是从 1 开始的。令人困惑！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T01:54:37.190

你有没有尝试过

修改后，我首先没有注意到 tr:nth-child，该表中没有 1 个子 tr，但索引 1 处有一个 td

```
var query = $(".text td:nth-child(1) b").html();
alert(query); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T02:08:25.097

在 Firefox 3 和 IE8 中测试您的示例时，经过一次调整，我能够使用您的选择器取回您期望的文本 - 我在您的表格元素中添加了一个“换行”的 ID：

```
<table id="wrap"> 
```

添加后，您的选择器似乎工作得很好。是否有您遇到问题的特定平台？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T02:16:09.510

我刚刚尝试了您的示例代码，它立即起作用。您使用的是什么版本的 jQuery？它适用于 1.3.2

这是工作示例：http: [//jsbin.com/uzuzu/edit](http://jsbin.com/uzuzu/edit)

# c# - 任何用户友好的 C# .NET 参考指南？

> ID：861207
> 
> 赞同：2
> 
> 时间：2009-05-14T01:47:55.067
> 
> 标签：c#, .net

我主要是一名 Python 程序员。现在我正在尝试学习 C# .NET。

我看到这里有一个 .NET Framework 参考：http: [//msdn.microsoft.com/en-us/library/d11h6832.aspx](http://msdn.microsoft.com/en-us/library/d11h6832.aspx)

但它对用户很不友好。即使它们有 System.CodeDom 或 System.Collections，我什至找不到 System.Console。

我个人认为[python库参考](http://docs.python.org/library/)还是不错的。所以我想知道是否有任何更清晰的.NET 替代参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T02:01:23.257

使用 MSDN 的好处之一是，如果您要查找特定类型的文档，则只需输入[http://msdn.microsoft.com/en-us/library/](http://msdn.microsoft.com/en-us/library/) < TYPE NAME WITH NAMESPACE >.aspx 并且您应该获得该类的文档。

除此之外，只需在 SO 上闲逛并阅读几本书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T02:59:07.330

我使用书签到 MSDN，只需将其保存为书签：

```
javascript:var a = prompt('MSDN Reference Lookup', 'Enter class name');if(a!=null){window.location='http://msdn.microsoft.com/en-us/library/' + a + '.aspx';} 
```

并输入完全限定的类名（如 System.IO.StreamReader），然后您就设置好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T18:14:34.760

由于您刚刚开始，请查看适用于 Core .NET 的[DZone RefCard](http://refcardz.dzone.com/announcements/coredotnet)。确实没有任何直接的 C# 数据，但它会为您提供对该语言的一个很好的概述，并且可能有助于您尝试解决一些更简单的问题。

# c# - ASP.NET 对象能否获取其属性

> ID：861212
> 
> 赞同：0
> 
> 时间：2009-05-14T01:49:01.073
> 
> 标签：c#, .net, attributes

考虑以下自定义属性：

```
[Abc.Text(MaxLength=33)]
public Abc.Text heading = new Abc.Text(); 
```

MaxLength 在 TextAtrribute 类中定义：

```
public class TextAttribute : Attribute
{
  public int MaxLength {get; set;}

} 
```

在我拥有的其他代码中，Text 类需要知道它的 MaxLength。

有没有办法我可以做这样的事情：

```
int max = (int)heading.GetAttribute("MaxLength"); 
```

**对答案的评论**

对 RexM 答案的修改有效：

```
System.Reflection.FieldInfo headingField = this.GetType().GetField("heading");
object[] attribs = headingField.GetCustomAttributes(typeof(Abc.TextAttribute), true);

if (attribs.Length == 1)
{
  int max = ((Abc.TextAttribute)attribs[0]).AbcMaxLength;
} 
```

但我希望我可以在不提及“this”（该字段的父级）的情况下做到这一点。你能以某种方式获得一个领域的父母吗？那会解决它，例如

```
System.Reflection.FieldInfo headingField = heading.GetParent().GetType().GetField("heading"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T01:53:46.380

对当前对象的类型使用[GetCustomAttributes()方法。](http://msdn.microsoft.com/en-us/library/system.attribute.getcustomattributes.aspx)这将返回一个对象数组，这些对象表示该类型的属性实例，这些属性属于您指定的属性类型：

```
object[] attribs = this.GetType().GetCustomAttributes(typeof(Abc.Text));
if (attribs.Length == 1)
{
    int max = ((Abc.Text)attribs[0]).MaxLength;
} 
```

编辑：好的，通过你的澄清，我对你想要做的事情有了更好的理解。我想我第一次误读了您的代码示例。它本质上是相同的概念，但属性是在一个字段上，而不是类上：

```
System.Reflection.FieldInfo headingField = this.GetType().GetField("heading");
object[] attribs = headingField.GetCustomAttributes(typeof(Abc.Text));
if (attribs.Length == 1)
{
    int max = ((Abc.Text)attribs[0]).MaxLength;
} 
```

再次编辑：为了获得该字段的句柄，您必须知道该字段所在的类型。一种简单的方法是使用`this.GetType()`，但您也可以执行以下操作：

```
FieldInfo headingField = typeof(MyClass).GetField("heading"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-14T01:56:50.350

你可以[在这里](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6099345.html)阅读如何做你想做的事。

```
Type type = TextAttribute.GetType();
PropertieInfo pi = type.GetProperty("MaxLength");
if (pi.CanRead())
  //the value
  pi.GetValue(); 
```

# java - 支持 JAR 的 Java 插件框架

> ID：861221
> 
> 赞同：0
> 
> 时间：2009-05-14T01:52:49.987
> 
> 标签：java, security, multithreading, plugins, plugin-architecture

更具体地说，是否有任何 Java 插件框架具有以下所有功能：

*   支持多个 JAR 文件
*   JAR 可以签名和/或密封
*   可以在实例化之前对每个 JAR 执行许可证检查
*   可以使用多个线程加载多个 JAR

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:14:47.890

我不知道有一个内置支持许可证检查 JAR 文件的框架（尽管 Lotus Notes 可能），我相信 OSGi 支持其他 3 个，并且可以通过一些自定义权限支持第 4 个处理。OSGi 包与任意 JAR 略有不同，但想法几乎相同。

其他人可能有更具体的 JAR 建议。

[http://www.javaworld.com/javaworld/jw-03-2008/jw-03-osgi1.html?page=2](http://www.javaworld.com/javaworld/jw-03-2008/jw-03-osgi1.html?page=2)

# .net - 为 Windows 多点触控进行开发——例如 Dell Studio One 19

> ID：861223
> 
> 赞同：1
> 
> 时间：2009-05-14T01:53:26.303
> 
> 标签：.net, windows-7, pixelsense, multi-touch

前几天我在网上看到了[Dell Studio One 19](http://www.engadget.com/tag/studioone19)，想知道 Multi-Touch 的开发环境是什么？

**有没有人为此开发，或者知道环境是什么？**

我知道要为[HP TouchSmart](http://www.engadget.com/tag/touchsmart)进行开发，您需要 HP 自己的 SDK....这对我来说听起来不太好（[查看这个 .NET Rocks 插曲](http://www.dotnetrocks.com/default.aspx?showNum=399)）

我希望新的戴尔只是使用 Windows 7 原生触控支持....

理想情况下，我希望看到 Microsoft Surface SDK 的一个子集被带到运行 Win 7 的支持触摸的屏幕上......

**有人从开发的角度了解 Win 7 上的 Multi-Touch 发生了什么吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T02:05:58.957

有趣的是，你应该问这个问题，我这周才开始研究这些东西。

我有带有 Windows 7 64 位的戴尔 XT2（运行起来像梦一样）。

你需要有什么...

[Windows 7 RC SDK](http://www.microsoft.com/downloads/details.aspx?FamilyID=6db1f17f-5f1e-4e54-a331-c32285cdde0c&displaylang=en)
，您还必须拥有
[NTrig 设备驱动程序](http://www.n-trig.com/Content.aspx?Page=Multi_Touch)

[NTrig SDK](http://www.n-trig.com/Content.aspx?Page=SupportSDK)很不错

Windows 7 Beta 和 RC 之间发生了一些变化，并且示例尚未更新，但其计算起来相当简单。玩得开心，我是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-07T02:01:26.487

虽然这可能不适用于 Dell Studio One 19 最后回答您的问题，“有人从开发的角度了解 Win 7 上的 Multi-Touch 发生了什么吗？”

我可以说，开箱即用的多点触控 API 似乎是您应该在 Tim J 的答案中链接的 Win 7 RC SDK 中找到的。此外，WPF 4.0 将包括多点触控 API 和控件，Surface SDK 2.0 似乎将在这些 API 和控件上进行扩展/构建。

如果您转到[以下演示文稿](http://www.slideshare.net/lynnlangit/windows-7-touch-dev-new?type=powerpoint)的幻灯片 7，您将看到事物是如何堆叠在一起的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-07T20:23:24.803

Dell Studio One 实际上使用了[NextWindow](http://www.nextwindow.com)的触控技术。他们现在拥有用于触摸屏的原生[Windows 7 驱动程序。](http://www.nextwindow.com/nextwindow_support/windriver.html)

这与 HP TouchSmart 台式机使用的触摸传感器相同（笔记本电脑使用 NTrig 双模式触摸传感器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-04T23:26:38.807

最简单的选择是在 Win7 上使用 Silverlight 为 Multi-Touch 进​​行开发。我在装有 Win7 的 HP TouchSmart 上使用 Silverlight 开发了一个小型应用程序。 [http://jobijoy.blogspot.com/2009/08/silverlight-3-multi-touch-with-windows.html](http://jobijoy.blogspot.com/2009/08/silverlight-3-multi-touch-with-windows.html) 当应用程序运行时，您可以使浏览器处于 Kiosk 模式（全屏）但如果您正在寻找非常Silverlight 之外的高级功能，然后继续使用 Win7 SDK。

# iphone - UITableView 方法“deleteRowsAtIndexPaths: withRowAnimation:”有什么作用？

> ID：861228
> 
> 赞同：1
> 
> 时间：2009-05-14T01:54:49.187
> 
> 标签：iphone, cocoa-touch, uikit

********更新问题**********

如果 tableview 不影响模型：屏幕单元格的索引路径是否已更改以反映其实际位置，或者在调用 reloadData 之前已删除单元格的索引是否不可见？

*******原始问题**********

我知道它会标记要删除的单元格并为删除设置动画，但它对模型有什么作用？

它是否会影响模型（我无法想象它会这样做）？

细胞是否“仍然存在”但不可见？

当用户开始滚动时，它是否会跳过对已删除索引的委托调用？

它是否希望您更新模型？

从我目前所读到的内容似乎含糊不清......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T02:08:02.743

*   (void)deleteRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;

从 tableView 中删除一行。它根本不会修改您的模型。你必须自己做。单元格被删除，但如果您在从模型中删除行之前调用 reloadData。单元格将重新出现。

所以，是的，它希望你更新你的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T07:13:46.860

UITableView 是一个 VIEW 记住 UIKit 是基于 MVC 的。保持模型更新是您的责任。事实上，您的控制器可能会调用`(void)deleteRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation;`以响应观察（或被通知）模型的变化。

例如，假设您的 UI 有“删除 10 个随机项”。正确的流程是：

1.  查看 - 用户按下按钮
2.  控制器 - 接收按钮按下更新模型
3.  控制器 - 观察模型的变化
4.  查看更新列表

虽然感觉有点做作——为什么不让视图只更新列表并告诉模型呢？它将使更好的 rcode 更易于理解并且与 UIKit 一起工作得更好。例如，此设计不假设 2 和 3 中的控制器是同一个控制器，因此您具有更大的灵活性。

我通常会将 YAGNI 应用于 ll 设计，但我相信强大的 MVC 焦点 os UIKit 意味着 YAGNT（你会......）

# jquery - ASP.NET MVC 模式对话框/弹出窗口最佳实践

> ID：861235
> 
> 赞同：62
> 
> 时间：2009-05-14T01:58:10.003
> 
> 标签：jquery, asp.net-mvc, asp.net-ajax, modal-dialog

我正在寻找在 ASP.NET MVC 中实现模式对话框的最标准方法。

我正在尝试做的一个例子是，当我从“列表”页面中选择一个项目时，我希望“详细信息”页面成为列表上的弹出窗口，而不是新页面。我不是在寻找黑客。我希望它是一个遵循 ASP.NET MVC 模式的解决方案。我也宁愿不要跳出 jQuery 和 ASP.NET Ajax（没有插件，除非它正在成为一种最佳实践）。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-14T02:28:16.407

jQuery UI 库有一个对话框小部件，我用它来做这样的事情。虽然它是一个插件，IMO，但最好的做法就是不滚动你自己的对话框小部件。

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-14T02:38:48.957

午餐的对话建议很好。只需向您的控制器操作发出 ajax 请求并让该操作返回您想要显示的内容，例如带有一些格式化 html 的局部视图。然后，将该 html 放入您的对话框中，或者您打算显示的任何内容中，然后显示它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-14T02:59:36.753

与 MVC 齐头并进的一件事是 RESTful url。在这种情况下，处理此问题的“标准”方法是让详细信息使用它自己的 RESTful（和可收藏的）URL 拉出一个新页面，而不是在页面上显示一个对话框。您当然可以在列表的上下文中执行“详细信息预览”对话框，但如果您要与详细信息交互，我会考虑执行完整请求并在其自己的页面上获取详细信息。

# php - 在同一张表中插入两种数组

> ID：861239
> 
> 赞同：0
> 
> 时间：2009-05-14T01:59:27.803
> 
> 标签：php

我在这里有一个来自表单的两个数组的示例，

```
<input type="text" name="children[]" />
<input type="text" name="age[]" /> 
```

我的问题是将上面的值插入到同一个表中，例如

```
insert into childTable(children,age) values('children[]','age[]') 
```

它是数组的形式，因为我不知道要输入多少个孩子..你能帮我解决这个问题吗？？？？任何答案将不胜感激......谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T02:08:31.477

表单中的数据可以在 PHP 中的 $_POST 变量（或 $_GET，但您可能应该使用 $_POST，例如：）中访问`<form method="post">`。

我通常在设计表单后做的第一件事是将其发布回脚本并添加以下行：

```
print_r($_POST); 
```

这将向您展示您正在使用的数据的结构。在您的情况下，它看起来像这样：

```
array(
    "children" => array(
        0 => "Bobby",
        1 => "Mary",
        2 => "Janey"
    ),
    "age" => array(
        0 => 8,
        1 => 12,
        2 => 7
    )
); 
```

（我假设`age`每个字段都有一个相应的`children`字段，是吗？）

因此，这只是一个遍历数组的问题：

```
$numKids = count($_POST['children']);
$values = array();

for ($i = 0; i < $numKids; ++$i) {
    $values[] = "('" . mysql_real_escape_string($_POST['children'][$i]) . "'"
              . ", " . intval($_POST['age'][$i]) . ")";
}
$sql = "INSERT INTO `childTable` (`children`, `age`) "
     . "VALUES " . implode(",", $values); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T02:49:44.937

多值表单字段并不是真正打算用于匹配这样的字段。不能保证多个`$_POST['children']`和`$_POST['age']`值最终将以相同的顺序提交，甚至具有相同数量的元素。

最好使用一系列编号的字段，例如：

```
Child 1:    
<input name="children_1" />
<input name="age_1">
<br />
Child 2:
<input name="children_2" />
<input name="age_2" />
... 
```

然后使用这样的代码来遍历提交的值：

```
$i = 1;
while (isset($_POST['children_' . $i]) && isset($_POST['age_' . $i])) {
    if ($_POST['children_' . $i] != '') {
        mysql_query('insert into childTable (children, age) values (\''
           . mysql_real_escape_string($_POST['children_' . $i]) . '\', \''
           . mysql_real_escape_string($_POST['age_' . $i]) . '\')');
    }
    $i++;
} 
```

当然，在现实世界中，您还需要添加一些验证，以在将这些值插入数据库之前检查它们是否有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T02:06:12.763

我认为你需要一个 for 循环。

伪代码：

```
for(int i = 0; i < children.Length; i++)
{
    insert into childTable(child, age) values(children[i], ages[i])
} 
```

# ruby - 一个新手关于红宝石风格的问题

> ID：861243
> 
> 赞同：1
> 
> 时间：2009-05-14T02:02:59.917
> 
> 标签：ruby, string, coding-style

```
USER = "user"
PASS = "pass"

QUERY = "SELECT c1, c2, c3, c4, c5, c6, c7 FROM table"

SQLITE_SCHEMA = 'c1, c2, c3, c4, c5, c6, c7'

sqlite_db = SQLite3::Database.new('sqlite.db')
odbc_db = DBI.connect('DBI:ODBC:database', USER, PASS)
odbc_db.select_all(QUERY) do |entry|
  sqlite_db.execute "insert into smnt (" + SQLITE_SCHEMA + ") values ('" + entry[0].to_s + "','" + 
                                                                           entry[1].to_s + "','" + 
                                                                           entry[2].to_s + "','" +
                                                                           entry[3].to_s + "','" +
                                                                           entry[4].to_s + "','" + 
                                                                           entry[5].to_s + "','" +
                                                                           entry[6].to_s + "')" 
  end 
```

必须有一种更简洁的方式来编写 db.execute 字符串，还是我很挑剔？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T02:13:38.143

除了低氧化物答案中的循环外，还可以考虑使用变量插值：

```
sqlite_db.execute "insert into smnt (#{SQLITE_SCHEMA}) 
  values (#{entry.map {|e| "'#{e.to_s}'"}.join(',')})" 
```

请注意，您的`entry`元素最好全部进行消毒，或者为[Bobby Tables](http://www.xkcd.com/327/)风格的痛苦世界做好准备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T02:05:27.227

您可以为字符串编写一个 for 循环……您可以节省几行代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T02:15:18.543

怎么样：

```
" VALUES (#{entry.collect{|e|"'"+e.to_s+"'"}.join(",")})" 
```

# flash - ActionScript 3、Flash Player 10 - 3d 轮播更改视角、对齐问题

> ID：861249
> 
> 赞同：0
> 
> 时间：2009-05-14T02:07:33.663
> 
> 标签：flash, actionscript-3, 3d, alignment

我们使用来自 Flash 的新原生 3D 支持制作了一个 3D 轮播。现在当我调整大小时，我的旋转木马应该沿着中间拖动。它做得很好。但由于某种原因，视角没有出现，因此看起来我调整大小越多，旋转木马越偏向左侧。

旋转木马的设置非常简单。一切都围绕 x 轴旋转一定距离，对象旋转的 x 轴为 0。我只是将整个容器移动到屏幕中间。

为了显示：

[http://www.stijlfigurant.nl/stuff/xaxis1.png](http://www.stijlfigurant.nl/stuff/xaxis1.png) [http://www.stijlfigurant.nl/stuff/xaxis2.png](http://www.stijlfigurant.nl/stuff/xaxis2.png)

有没有办法解决这个问题，还是我应该回到旧的papervision？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T13:32:00.420

除非您发布一些代码，否则很难知道该建议什么。

Papervision 没有任何问题，但对于简单的轮播来说，它可能有点过分了。Lee Brimelow 在这里有一个很好的 3D 轮播教程：[http](http://www.gotoandlearn.com/play?id=92) ://www.gotoandlearn.com/play?id= 92，它可以很好地拖动而不失真。（可能值得注意的是，3D 轮播被夸大**了**，但这可能是。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:49:10.827

我通过将 root.transform.perspectiveProjection.projectionCenter 设置为舞台中心来修复它！

# c# - 中等信任度的 ASP.NET MVC

> ID：861251
> 
> 赞同：2
> 
> 时间：2009-05-14T02:08:15.783
> 
> 标签：c#, asp.net-mvc, medium-trust

只是想为 ASP.NET MVC 设置我的开发环境，已经启动了一个空白的 ASP.NET MVC 项目，并在我的 web.config 中放置了以下内容：`<trust level="Medium" originUrl=""/>`

然后运行项目会导致以下异常：

> 说明：应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。
> 
> 异常详细信息：System.Security.SecurityException：请求“System.Security.Permissions.ReflectionPermission，mscorlib，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。

如果可能的话，我想开发我的应用程序以获得中等信任，因为我没有选择托管它的位置，并且存在信任级别可能存在某种限制的可能性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-10-25T08:54:57.253

当前版本的 ASP.NET MVC 仅支持`<trust level="Full" />` - 请参阅[此答案](https://stackoverflow.com/a/25354496/6300200)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T04:17:21.653

我无法在我的机器上重现此异常。您应该能够以[中等信任度 bin 部署 ASP.Net MVC](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)。我已经在我的主机和 Godaddy 上成功完成了它。您使用的是 MVC 1.0 吗？您是否更改或添加了对中等信任设置的限制，可能在继承的 web.config 或 machine.config 文件中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T09:06:28.260

我的网站也有类似的错误。它在我的本地机器上运行良好，但会在我的虚拟主机上引发权限错误。我实际上只是尝试将我的 web.config 设置为...

```
<trust level="Full" /> 
```

它对我来说很好。我不认为它会起作用，但它确实起作用了。

# php - 遍历 php 类的属性

> ID：861254
> 
> 赞同：21
> 
> 时间：2009-05-14T02:11:33.763
> 
> 标签：php, dynamic, variables

我如何迭代 php 类的（公共或私有）属性？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-14T02:17:50.753

**tl;博士**

```
// iterate public vars of class instance $class
foreach (get_object_vars($class) as $prop_name => $prop_value) {
   echo "$prop_name: $prop_value\n";
} 
```

**进一步的例子：**

[http://php.net/get_object_vars](http://php.net/get_object_vars)

> 根据范围获取给定对象的可访问非静态属性。

```
class foo {
    private $a;
    public $b = 1;
    public $c;
    private $d;
    static $e; // statics never returned

    public function test() {
        var_dump(get_object_vars($this)); // private's will show
    }
}

$test = new foo;

var_dump(get_object_vars($test)); // private's won't show

$test->test(); 
```

输出：

```
array(2) {
  ["b"]=> int(1)
  ["c"]=> NULL
}

array(4) {
  ["a"]=> NULL
  ["b"]=> int(1)
  ["c"]=> NULL
  ["d"]=> NULL
} 
```

# security - WSS 3.0：检索用户权限

> ID：861255
> 
> 赞同：0
> 
> 时间：2009-05-14T02:12:08.753
> 
> 标签：security, sharepoint, permissions

我可以知道如何从用户 ID 和组名中检索用户的权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-10T01:45:59.003

我是负责权限管理的 SharePoint PM

什么权限？

任何实现 ISecurableObject（SPWeb、SPList、SPItem..）的东西都会公开“RoleAssignments”。如果您只是在寻找特定用户的权限，您可以使用 DoesUserHavePermissions 检查特定掩码

# operating-system - 对于内核/操作系统，C 仍然是它吗？

> ID：861257
> 
> 赞同：19
> 
> 时间：2009-05-14T02:12:50.797
> 
> 标签：operating-system, kernel, osdev

我喜欢操作系统，并最终想成为一名主要从事内核工作的操作系统开发人员。将来 C 语言仍将是首选语言，我还应该尝试学习什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-14T03:25:47.860

在研究人群中，有很多人对使用基于语言的技术来*保证*内核*不会出现*异常感兴趣。很多人都提到了[Singularity](http://research.microsoft.com/en-us/projects/singularity/)项目，该项目目前（当之无愧地）备受瞩目。为什么奇点有趣？

*   该语言包括一个用于正确使用锁的有限状态模型。编译器可以根据模型对代码进行模型检查，以确保**不会发生死锁**。

*   第三方驱动程序被赋予系统的有限接口。编译器所做的检查保证了**一个坏的驱动程序不能把系统**弄坏——它可以做的最坏的事情就是把它自己的设备弄坏。

*   Singularity 使用编译器技术，而不是 OS/MMU 技术，将一个“进程”与另一个“进程”隔离开来。突然分叉一个新的“过程”（实际上是一种新的[保护域](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.kernelext/doc/kernextc/syscall_execu.htm)）非常便宜，而这种便宜使新设计成为可能。

Singularity 只是众多使用语言和编译器技术解决操作系统问题的项目中的最新一个。我最喜欢的一个是华盛顿大学[SPIN 内核](http://www-spin.cs.washington.edu/)，它允许应用程序安全地扩展内核，并且是用 Modula-3 编写的。

这个研究领域仍然很开放，**目前还不**知道哪组语言或编译器功能是解决操作系统问题的“最佳位置”。所以回答你的问题：

*   在*今天的生产系统中*，C 仍然是“它”。

*   对于*未来的操作系统*，C 几乎可以肯定不是“它”——我们知道它可以做得更好——但新的“它”的确切性质仍然是一个悬而未决的问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T03:10:44.260

我认为可以肯定地说操作系统的低级部分（例如内核）将继续用 C 语言编写，因为它的速度很快。就像其他地方提到的那样，您需要了解内核某些部分的汇编程序（需要将内核加载到内存中）。但是您可以在很少或根本没有汇编知识的情况下使用内核。一个很好的例子是如果你正在实现一个文件系统。

不要担心操作系统是用什么语言实现的。重要的是如何使用操作系统，以及可以做些什么来改进它们。一个很好的例子是 Unix 刚出现的时候。文件系统的 inode 位于磁盘的前端，数据位于剩余空间中。当您为所有文件寻找磁盘的不同部分时，这并没有很好地执行。然后创建了[Berkeley 快速文件系统](http://en.wikipedia.org/wiki/Unix_File_System)来创建磁盘感知文件系统。这意味着在其相应数据附近有 inode。我省略了很多细节，但我希望这能说明更重要的是思考如何改进操作系统，而不是用什么语言来编程。

操作系统的一些最新趋势是虚拟化和分布式计算（参见 Google 关于[MapReduce](http://labs.google.com/papers/mapreduce.html)的论文）。文件系统、安全性、调度（尤其是多核处理器）等一直是人们感兴趣的领域，尽管这些问题并不新鲜。

如果您想了解有关内核开发的更多信息，这里有一些资源：

*   [Linux Kernel Newbies](http://kernelnewbies.org/) - 为想要开始修改 Linux 内核的人提供的资源。
*   [xv6 源](http://pdos.csail.mit.edu/6.828/2008/src/xv6-rev2.tar.gz)- Unix 版本 6 的 x86 端口。由 MIT 用于教授操作系统课程。简单，易于扩展（[更多信息](http://pdos.csail.mit.edu/6.828/2008/overview.html)）。
*   [Linux Kernel Map](http://www.makelinux.net/kernel_map) - Linux 中系统调用的调用链。在可视化系统调用的作用时很有用。

底线：开始熟悉内核并阅读有关研究人员正在撰写的论文（[USENIX](http://www.usenix.org/)对此很有用）。这种知识比学习一门新语言更有价值，因为如果操作系统的编写方式发生了变化，大多数概念可以很容易地从一种语言转移到另一种语言。希望这可以帮助！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T02:30:42.000

科迪不想被打扰回答这个问题，所以我代表他传递这个。:-P 对于一些用托管语言编写的操作系统示例，而不是 C 或汇编，请查看：

*   [奇点](http://research.microsoft.com/en-us/groups/os/singularity/)
*   [夏普操作系统](http://www.sharpos.org/doku.php)
*   [宇宙](http://www.gocosmos.org/)
*   [摩萨](http://www.codeplex.com/mosa/)
*   [幻影](http://www.dz.ru/en/solutions/phantom/)

当然，Cody 也不想提这个：

*   [连乐](http://daeken.com/renraku-it-lives)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T02:21:26.983

C 几乎就是它，具有相当数量的汇编程序。操作系统内核工作的重要主题包括：

*   缓存原理和缓存管理
*   虚拟内存、TLB管理
*   CPU和系统架构
*   存储层次结构
*   并发编程技术（互斥、锁定等）
*   算法和数据结构

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T02:36:03.533

实际上，现代操作系统的核心有相当多的空间用于 C++ 代码。我只是看了看，Win7 核心内核树有相当多的 C++ 代码。请注意，许多子系统仍然使用简单的 C。这有几个原因

1.  C 是基于 NT 的操作系统的原始语言
2.  关键人物非常非常了解 C
3.  编写良好的 C 语言可能是最直接的调试代码——尤其是在内核模式下。

话虽如此，许多团队和人员发现编写良好的 C++ 是核心操作系统工作的有效工具。

C++ 没有什么可以阻止它被用来编写核心资源管理代码，如调度程序、内存管理器、I/O 子系统、图形子系统等。

正如其他人指出的那样 - 任何内核工作总是需要一些汇编语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-27T16:28:28.650

我认为在可预见的未来，严肃的（非实验性的）操作系统开发仍将保留在 C（和汇编）中，这是一个非常安全的赌注。

我提交的证明是艾达。它可以像 C 一样裸机，提供对数据放置的更好控制，并且对几乎所有内容都有更安全的默认行为（例如：数组边界检查）。从 OS 开发人员的角度来看，它在您能想到的任何*技术参数上都等于或优于 C。*它已经上市 20 多年了（好吧……价格合理，也许只有 15 年）。

因此，如果人们正在寻找一种在技术上优于 C 的语言，您应该看到到处都是用 Ada 编写的操作系统，对吗？我实际看到的是在 Ada 中实现的*一个*严肃的操作系统。不再支持在 C 中重新实现它。

操作系统开发中其他语言的障碍不是技术性的，也从来不是技术性的。我不认为 C 的非技术优势会很快消失，而且没有人*会*通过简单地设计一种更好的语言来克服它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T02:25:21.297

微软正在用 .NET 重写一些 Windows，但我怀疑大部分内核会被触及。

然而，像 Cosmos ( [http://www.gocosmos.org/index.en.aspx](http://www.gocosmos.org/index.en.aspx) ) 这样的项目给了我们希望。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T02:33:03.010

不，它不是“它”。内核通常是用 C 语言编写的，并带有一些汇编程序。但是操作系统是用各种语言编写的。但即便如此，C++ 也可以毫无困难地使用。许多其他语言也可以。Linux 是由 C 狂热者编写的，他们害怕和厌恶其他一切，这是他们的问题。Windows 是用 C 和 C++ 的大量组合编写的，并且可能还包含一些旧的 Pascal 代码。而现在，大量的 .NET 也出现了。OS X 对大部分 OS 代码使用 Objective-C。

相同的建议适用于所有其他编程领域：

*   了解你的东西
*   不要将自己局限于一种真正的语言。

内核是唯一适用一些“特殊”规则的区域。但是内核*很小*。绝大多数操作系统都可以用任何语言编写。

你当然需要知道 C，是的，但*仅仅*知道 C 还远远不够。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T02:34:24.690

您可能想看看 Microsoft 的[Singularity](http://research.microsoft.com/en-us/projects/singularity/)项目（也在[Wikipedia](http://en.wikipedia.org/wiki/Singularity_(operating_system))上）：

> Singularity 是 Microsoft Research 自 2003 年以来构建的实验性操作系统。它旨在作为一个高度可靠的操作系统，其中内核、设备驱动程序和应用程序都以托管代码编写。

这个操作系统只有极小部分实际上是用 C 编写的，其余部分是用更高级的语言（Sing#，C# 的扩展）编写的。在未来，我相信你可以期待看到更多这种东西变得可用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-13T17:50:29.660

很多时候，您会听到一些说法：C 语言是速度和 Ada 的同义词，而不是。这不是真的。Ada 添加了一些减慢执行速度的检查。这是真的，但出于调试目的或安全性。因此，它们可以在编译时通过配置删除。因此，您可以在没有开销的情况下生成 ADa 程序。另一方面，请注意 gnu 编译器将 Ada 和 C 翻译成相同的中间代码。结果，您最终获得了相同的可执行代码。我在这里读到 Ada 不能用于开发驱动程序。那是假的。Ada 具有与 C 语言相同的能力。此外，它避免了许多错误。您可以看到它存在一个完全用 Ada 编写的实时操作系统 MarteOS。

Ada 不用于编程 OS 内核的主要原因是 C 语言是用于 Unix 的语言。使用 C 原型表示系统调用 API 是 POSIX 规范。所有的操作系​​统片段都已经用 C 编写了。而且，C 语言代表了世界上开发的软件的 17%。

最后，艾达很严格，很多人不喜欢这样。他们更喜欢开发有漏洞的软件，并花更多的时间进行调试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-17T19:45:55.087

好吧，在 osdev 社区中，C 通常被称为高级语言。而更“低级”的语言将是汇编语言（您被迫在内核启动时使用 ASM，因此您必须使用 ASM 但不必使用 C）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-26T07:08:51.853

Windows 上的内核模式开发支持 C++，但您不能轻易使用异常和 RTTI。我相信今天没有理由用 C 编写代码，因为 C++ 的开销可以忽略不计（任何跟踪/调试基础设施都将比虚拟函数调用的额外取消引用更昂贵）。事实上，大多数 Windows DDK 都使用 C 实现面向对象的模式，这与 C++ 相比只是不方便。

如果您决定使用 C++ 进行内核模式开发，则需要覆盖 new 运算符来选择是在可分页内存还是不可分页内存上分配一个类。一些不错的宏在那里可能会派上用场。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-14T02:44:51.343

如果您正在谈论的是内核，那么您需要学习一种能够更快地轻松访问底层硬件的语言。我只能想到

*   C语言和
*   集会

AFAIK，引导加载程序的某些部分将用汇编语言编写，从那时起，将使用 C 语言编写。有许多易于理解的开源操作系统可用，例如最新的 TOPPERS。试着调查一下。

我想，作为一名**操作系统内核开发人员**，您将更多地担心**有效访问底层硬件（如处理器和内存）**的方法，而不是语言的选择。我敢打赌，大多数时候，我们会**很想使用汇编**

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-11-03T22:38:12.753

我从 Pascal 语言的作者[Niklaus Wirth](https://en.wikipedia.org/wiki/Niklaus_Wirth)那里指出了[Oberon 编程语言](http://oberon07.com/)和[Oberon 操作系统](https://www.youtube.com/watch?v=BJIqHIYSDrk)。Niklaus Wirth 项目也有一个[粉丝网站](http://projectoberon.com/)。

如果我正确理解了[Андрей Николаевич Терехов](https://www.youtube.com/watch?v=2qERUc4UoGw)，Ada 的一个好处是内存访问检查可以从 CPU 硬件转移到编译器级别，这减少了 CPU 中的逻辑门数量，这反过来又从能源消耗的角度来看是有益的看法。CPU 需要的逻辑门越少，可以从相同数量的逻辑门中创建更多的内核。从这个角度来看，专门为一种语言量身定制的 CPU，其中编译器替换了部分硬件，在每瓦操作数方面具有根本优势。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-26T06:26:56.470

我已经在 Windows NT 和 Linux 内核中进行了大量的编程。我可以向你保证，只要这两个操作系统围绕 C 语言，就会在内核中使用。我认为原因有很多，但最简单的答案是时间。就像之前的海报提到的那样，用不同的语言重写内核所花费的时间是不值得的。它不仅仅是移植代码。内核需要一些认真的设计修改。我个人认为 C 是最适合内核的语言。当您在内核中工作时，能够管理您的开放内存并动态分配和释放您自己的内存是至关重要的。特别是如果您正在使用分页内存。在内核模式下分配的堆栈大小通常也小于用户模式，因此内存效率再次至关重要。C 还允许程序员构建漂亮的数据结构，这些数据结构不包含托管语言所具有的所有臃肿开销。在我看来，结构也可以像对象一样有效地使用，但又没有所有臃肿的开销。托管语言也需要“托管”。在内核中，您没有任何东西可以清理您的混乱。不要误会我的意思，我喜欢 C#，我认为 .NET 框架很漂亮，但如果你在内核中，C 是并且将继续是它。在内核中，您没有任何东西可以清理您的混乱。不要误会我的意思，我喜欢 C#，我认为 .NET 框架很漂亮，但如果你在内核中，C 是并且将继续是它。在内核中，您没有任何东西可以清理您的混乱。不要误会我的意思，我喜欢 C#，我认为 .NET 框架很漂亮，但如果你在内核中，C 是并且将继续是它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-14T02:23:05.717

明确地！您还应该学习至少一种汇编语言/硬件架构。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-24T14:43:34.450

你绝对应该精通 C 语言。

正如其他人所指出的，没有理由必须用 C 编写操作系统，并且通过使用更复杂的语言可以获得很多好处。但是，如果您要在现实世界中（即，不在学术界或研究实验室）研究操作系统，那么您必须面对几个现实：

1.  现有的操作系​​统非常庞大，通常有数百万行代码，并且是用 C 或 C 衍生物（例如 Objective-C 或 C++）编写的。
2.  新操作系统需要数百个工程师年（和许多日历年）才能达到并匹配现有操作系统的功能和稳健性。

因此，我很难看出世界将如何以及何时远离基于 C 的操作系统内核。是的，这在技术上是可行的。但是成本可能太高了。如果有的话，趋势似乎是在少数操作系统系列（Windows、Linux 和 BSD）上进行整合，这些都是基于 C 的。

知道已经完成了哪些研究，或者可以使用哪些工具和技术将现有的代码库（例如 Linux）发展为更好的语言，将会很有趣。我认为这将是一种比让世界采用全新的操作系统更可行的方法。

# iphone - 将使用 UISegmentedControl 过滤的数据 UITableView 的模型设置

> ID：861259
> 
> 赞同：0
> 
> 时间：2009-05-14T02:13:07.537
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

我正在制作一个带有 UISegmented 控件的 UITableView ala 电话应用程序中的“最近通话”选项卡。

第一段将是所有项目，接下来的 2 段将是完整项目列表的子集。

我创建了 3 个数组，其中包含 3 个不同的数据列表。

我的第一个解决方案是批量交换数据并重新加载：

```
[self setData:newData];
[self.tableView reloadData]; 
```

除了动画之外，这很有效，没有迹象表明数据确实发生了变化。我可以添加某种指示消息，但我更愿意使用手机应用程序使用的方法，即折叠已删除单元格并扩展添加单元格的“手风琴”效果。

要做到这一点，你不能只换掉数据（或者你可以吗？）。它不会触发动画。我看到的唯一方法是手动从支持模型中删除和添加单元格。那么实现这一点的有效算法是什么？我的第一个猜测：

我有一个多维数组来表示单元格的部分。

1.  创建一个数组来保存要添加的单元格的索引路径
2.  遍历新数据的每个部分
3.  检查新数据的部分是否与旧数据的计数相同
4.  如果不是，则遍历新数据中的每个项目
5.  如果该项目也在 OLD 数据中，则什么也不做
6.  如果项目不在 OLD 数据中，则将项目的索引路径添加到要添加的单元格数组
7.  对部分中的每个项目重复
8.  对新数据中的每个部分重复
9.  创建一个数组来保存要删除的单元格的索引路径
10.  遍历旧数据的每个部分
11.  检查新数据的部分是否与旧数据的计数相同
12.  如果不是，则遍历 OLD 数据中的每个项目
13.  如果该项目也在 NEW 数据中，则不执行任何操作
14.  如果项目不在新数据中，则将项目的索引路径添加到要删除的单元格数组中
15.  对部分中的每个项目重复
16.  重复旧数据中的每个部分

然后调用适当的 UITableView 方法：

```
- (void)deleteRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation
- (void)insertRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation 
```

这个算法似乎有很大的改进空间。有没有人解决过这个问题？你是如何实施的？

感谢您的任何意见

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T05:23:43.177

它看起来比它需要的复杂得多。UITableViews 在“拉”的基础上工作——也就是说，它不是将数据推送到表上，而是调用您的数据源委托并将数据拉入其中。

鉴于此，每次您打电话时，`reloadData`您都可以换出并返回您想要的任何东西。您所要做的就是使用分段控制操作来更改索引值，该索引值选择当表格要求单元格值时使用哪个数据数组是“当前”数组。

现在就动画变化而言，有很多方法可以产生相同的效果。如果你真的想做手风琴效果，你必须管理很多状态来跟踪你是处于显示模式还是表格切换模式等。一个更简单的方法是拥有一个可以动画的覆盖视图并出来以直观地指示更改。然后在动画视图的完成处理程序中，您将调用`reloadData`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T02:56:53.250

我在以下 SO 页面中回答了类似的问题：

[使用 NSPredicate 过滤后更新 UItableView 及其数据源的模式](https://stackoverflow.com/questions/999214/pattern-to-update-a-uitableview-and-its-datasource-after-filtering-with-nspredica)

# asp.net - 如何捕获异常表单 ObjectDataSource.Updata()

> ID：861269
> 
> 赞同：4
> 
> 时间：2009-05-14T02:20:11.090
> 
> 标签：asp.net, data-binding, objectdatasource

数据库抛出异常导致 FOREIGN KEY 冲突。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T02:23:03.207

查看 ObjectDataSource 上的 eventargs。应该有一个 e.Exception 和 e.Results，您可以查询更新的成功/错误。

```
protected void MyOds_Updated(object sender, ObjectDataSourceStatusEventArgs e)
{
    if (e.Exception != null)
    {
        // handle exception here.
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-27T11:06:45.100

要告诉 ObjectDataSource 不要重新抛出您的异常，您必须将**ExceptionHandled**标志设置为 True。

```
protected void MyOds_Updated(object sender, ObjectDataSourceStatusEventArgs e)
{
    if (e.Exception != null)
    {

        //this tells the ObjectDatasource : It's ok, i'm taking care of this
        //and don't rethrow it.
        e.ExceptionHandled = true

        // handle exception here (log/display to user etc ...)
    }
} 
```

我希望这能帮到您。

咒语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-01T02:09:25.940

如果这对使用网格视图更新方法没有帮助

```
If Not e.Exception Is Nothing Then
    e.KeepInEditMode = True
    e.ExceptionHandled = True
    msg("error .", "a", Me.GetType(), ClientScript)
End If 
```

# iphone - 重新加载包含 UITableView 的 UIViewController 时的 EXEC_BAD_ACCESS

> ID：861271
> 
> 赞同：1
> 
> 时间：2009-05-14T02:21:49.450
> 
> 标签：iphone, uitableview, uiview

执行以下步骤时，我得到一个 EXEC_BAD_ACCESS：

**第 1 步：单击主菜单中的“分数”按钮：** 这将删除菜单 (UIView)，并加载分数 (UIView)，随后启动使用值填充 UITableView 的过程。这里没有问题。

```
 self.viewController4 = [[ScoresViewController alloc]  initWithNibName:@"ScoresViewController" bundle:nil];
        [window addSubview:viewController4.view];
        [viewController.view removeFromSuperview];
        NSLog(@"LOADING SCORES SCREEN"); 
```

**第 2 步：从分数屏幕单击“菜单”按钮：** 这将删除分数 (UIView)，并再次加载菜单 (UIView)。这里没有问题。

```
self.viewController = [[MainMenuViewController alloc] initWithNibName:@"MainMenuViewController" bundle:nil];
        [window addSubview:viewController.view];
        [viewController4.view removeFromSuperview];
        NSLog(@"Loading MAIN MENU"); 
```

**第 3 步：再次从主菜单单击“分数”按钮：** 再次，这将删除菜单 (UIView)，并加载分数 (UIView)，随后启动使用值填充 UITableView 的过程。***有问题！***

应用程序在显示乐谱屏幕 (UIView) 之前崩溃。使用调试器，我将问题追溯到单行代码：***cell.text = [self->theScoresArray objectAtIndex:indexPath.row];*** 出现在以下例程中：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{   
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [theTable dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil)
{
cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
}
cell.text = [self->theScoresArray objectAtIndex:indexPath.row];
return cell;
} 
```

这可能是第一次没有正确释放 indexPath 对象的问题吗？任何见解都会有所帮助。感谢您宝贵的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:44:58.487

在您再次单击“Scores”按钮之前，“theScoresArray”是否已发布？将鼠标悬停在“theScoresArray”上，看看它是否有值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T04:54:18.223

我认为您的问题在于您对 UIWindow 的使用...

您不应该将视图直接删除/添加到应用程序中的 UIWindow 实例。

如果您计划显示多个视图，您应该：

1.  使用 UINavigationController 或 UITabViewController。
2.  在单视图应用程序中向 UIView 添加和删除子视图。

UIApplication 需要知道屏幕上的视图是谁，如果您不使用这些模式（即 viewDidLoad、viewDidDisappear 等），某些委托消息可能会丢失。

我在尝试管理自己的观点时遇到了类似的问题。

听起来在您的实例中您应该使用 UINavigationController 并推送和弹出视图控制器。它为您管理所有初始化、缓存和解除分配。这应该会导致更少的问题。

看起来您可以“自己动手”，但与 SDK 抗争可能比学习使用它的约定更难。

# .net - Visual Studio 正则表达式帮助

> ID：861285
> 
> 赞同：1
> 
> 时间：2009-05-14T02:30:38.257
> 
> 标签：.net, visual-studio, visual-studio-2008, visual-studio-2005

我在 VS IDE 的查找/替换中使用正则表达式。我需要`message="My message"`用空字符串替换所有 aspx 文件中的字符串。html看起来像这样

```
<input id="test" message="My message"/> 
```

我正在尝试使用正则表达式查找，`message="{.*}"`但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:40:10.950

试试 message="{[^"]*}"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T03:54:59.490

因为 * 是贪婪的，所以它会捕获直到找到**最后一个**引号，而不是**下一个**引号，这就是你想要的。通过告诉表达式捕获所有非引号字符，您可以确保它只捕获下一个字符。

消息="{[^"]*}"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T02:41:45.877

使用消息="[^\"]*"

您可以在 nregex 网站上实时测试您的正则表达式查询 - [http://www.nregex.com/nregex/default.aspx](http://www.nregex.com/nregex/default.aspx)

# css - 垂直滚动条不应该在 IE 中显示

> ID：861287
> 
> 赞同：-1
> 
> 时间：2009-05-14T02:30:48.367
> 
> 标签：css, internet-explorer, scrollbar

我有一个长页面，它应该在 IE 中显示垂直滚动条，但它没有。我可以单击一个按钮，然后出现滚动条，然后在重新加载页面时它们消失。

这是CSS

```
*{margin:0;padding:0}
html, body, form{height:100%}

body{position:relative;width:100%;}/*opera 9.5 fix*/

body 
{
    font-family:Trebuchet MS, Lucida Grande, Arial, sans-serif;
    text-align:center;
}
/* ---Layout--- */
#wrapper{ 
    width:100%;
    text-align:left;
    margin:auto;
    min-height:100%;
    margin-top:-100px;/*footer height*/

} 
* html #wrapper{height:100%}
#header{
    background: url(images/header.png);
    height:89px;
    border-top:100px solid #fff;/* soak up negative margin*/
}

#header_inner{
    width:960px; 
    margin-left:auto; 
    margin-right:auto;  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T04:05:33.397

也许试试这个：

```
html { height: 100.1%; margin-bottom: 1px; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T04:07:53.687

你为什么用

```
html, body, form{height:100%} 
```

如果删除该行，会有滚动条吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-14T04:08:04.153

可能无济于事，但真的，试着摆脱身高：100% 的一切。很多时候它会导致 IE 出现问题。如果不能，请尝试添加

```
hasLayout: true; 
```

到表格。

# dll - 使用 .lib 和 dll 时如何在调试中显示源代码

> ID：861291
> 
> 赞同：0
> 
> 时间：2009-05-14T02:35:04.283
> 
> 标签：dll, visual-studio-2005

我在 VS2005 中工作，我有一部分 freeimage 源代码。我将它编译成 .lib 和 dll。调试程序的时候想单步进入freeimage源码，但是vs2005不知道freeimage.lib是freeimage.dll编译出来的代码，怎么让vs2005知道。在使用它的 .lib 和 dll 时，我想进入 freeimage 源代码。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:45:46.740

您需要在调试配置中构建代码并生成包含调试符号的程序数据库文件 (.pdb)：http: [//msdn.microsoft.com/en-us/library/cyz1h6zd (VS.80).aspx](http://msdn.microsoft.com/en-us/library/cyz1h6zd(VS.80).aspx)

然后，当您运行应用程序时，使用 dll 的调试版本并确保 Visual Studio 可以看到 .pdb 文件。通常如果一切都在一个解决方案中，它可以找到它，否则您可以将 .pdb 文件放入与 dll 相同的目录中。

# linux - 带有公鸡的站点将电子邮件主机标记为垃圾邮件

> ID：861293
> 
> 赞同：0
> 
> 时间：2009-05-14T02:37:13.560
> 
> 标签：linux, sendmail, spam, configure

最近我在一个新的 linux 服务器安装上配置 sendmail 并且有一个配置问题。我得到了一个网站的链接，该网站上有一只公鸡的形象，并被告知要咨询他们的配置问题。

我不记得该网站的网址，但它显然是一个众所周知的。

有人可以在这里提醒我该站点是什么以及我应该如何使用它来找出正确的配置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T02:41:34.690

你说[的是 CBL](http://cbl.abuseat.org/)。

# java - 为什么 java.util.Set 接口不提供get(Object o) 方法？

> ID：861296
> 
> 赞同：43
> 
> 时间：2009-05-14T02:38:03.107
> 
> 标签：java, generics, collections

我知道在 Set 中只允许根据 .equals() 的任何对象的一个​​实例，如果您已经有一个等效对象，您不应该“需要”从 Set 中获取一个对象，但我仍然想有一个 .get() 方法，在给定等效对象作为参数的情况下，返回 Set（或 null）中对象的实际实例。

关于为什么这样设计的任何想法/理论？

我通常必须通过使用 Map 并使键和值相同或类似的东西来解决这个问题。

编辑：我认为到目前为止人们还没有理解我的问题。我想要集合中已经存在的确切对象实例，而不是 .equals() 返回 true 的可能不同的对象实例。

至于为什么我想要这种行为，通常 .equals() 不考虑对象的所有属性。我想提供一些虚拟查找对象并取回 Set 中的实际对象实例。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-14T04:57:12.523

虽然纯度论点确实使该方法受到`get(Object)`质疑，但其潜在意图并没有实际意义。

有各种类和接口系列稍微重新定义了`equals(Object)`. 只需查看集合接口即可。例如，一个 ArrayList 和一个 LinkedList 可以相等；它们各自的内容只需要相同且顺序相同。

因此，有很好的理由在集合中找到*匹配*元素。也许更清楚地表明意图的方法是使用类似的方法

```
public interface Collection<E> extends ... {
  ...
  public E findMatch(Object o) throws UnsupportedOperationException;
  ...
} 
```

请注意，此 API 具有比 Set 更广泛的价值。

至于问题本身，我没有任何理论来解释为什么省略了这样的操作。我会说*最小跨越集参数*不成立，因为集合 API 中定义的许多操作都是出于方便和效率的考虑。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-14T03:16:14.590

问题是：Set 不是用于“获取”对象，而是用于添加和测试是否存在。我了解您在寻找什么，我遇到了类似的情况，并最终在键和值中使用了相同对象的映射。

编辑：只是为了澄清：[http://en.wikipedia.org/wiki/Set_(abstract_data_type)](http://en.wikipedia.org/wiki/Set_(abstract_data_type))

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-02-15T19:00:25.650

几年前我在java论坛上有同样的问题。他们告诉我 Set 接口已定义。它无法更改，因为它会破坏 Set 接口的当前实现。然后，他们开始声称胡说八道，就像您在此处看到的那样：“Set 不需要 get 方法”并开始训练我 Map 必须始终用于从 set 中获取元素。

如果您仅将集合用于数学运算，例如交集或联合，则可能 contains() 就足够了。但是，Set 在集合中定义以存储数据。我使用关系数据模型解释了 Set 中需要 get()。

在下文中，SQL 表就像一个类。列定义属性（在 Java 中称为字段），记录表示类的实例。所以一个对象是一个场向量。一些字段是主键。它们定义了对象的唯一性。这就是你在 Java 中为 contains() 所做的：

```
class Element {

        public int hashCode() {return sumOfKeyFields()}
        public boolean equals(Object e) {keyField1.equals(e) && keyField2.equals(e) && ..} 
```

我不知道数据库内部。但是，在定义表时，您只指定一次关键字段。您只需使用 @primary 注释关键字段。在向表中添加记录时，您没有第二次指定键。您不会像在映射中那样将键与数据分开。**SQL 表是集合。它们不是地图。然而，**除了保持唯一性和 contains() 检查之外，它们还提供 get()。

在“计算机编程艺术”中，介绍了搜索，D. Knuth 也这么说：

> 本章的大部分内容致力于研究一个非常简单的搜索问题：如何找到以给定标识存储的数据。

你看，数据是与标识一起存储的。不是标识指向数据，而是**带有标识**的数据。他继续：

> 例如，在数值应用中，我们可能希望找到 f(x)，给定 x 和 f 值的表；在非数字应用程序中，我们可能希望找到给定俄语单词的英文翻译。

看起来他开始谈论映射。然而，

> 一般来说，我们假设已经存储了一组 N 条记录，问题是找到合适的记录。我们一般要求 N 个 key 是不同的，这样每个 key 才能唯一标识它的记录。所有记录的集合称为*表*或*文件*，其中“表”一词通常用于表示小文件，“文件”通常用于表示大表。一个大文件或一组文件通常称为*数据库*。
> 
> 搜索算法提供了一个所谓的参数 K，问题是找到哪个记录以 K 作为其键。尽管搜索的目标是找到存储在与 K 相关的记录中的信息，但本章中的算法通常会忽略除键本身之外的所有内容。在实践中，一旦我们找到了 K，我们就可以找到相关的数据；例如，如果 K 出现在位置 TABLE + i 中，则相关数据（或指向它的指针）可能位于位置 TABLE + i + 1

也就是说，搜索定位记录的关键字段，它不应该将关键“映射”到数据。两者都位于同一记录中，作为 java 对象的字段。也就是说，搜索算法检查记录的关键字段，就像它在集合中所做的那样，而不是像在映射中那样检查某个远程键。

> 我们有 N 个要排序的项目；我们称它们为*记录*，N 条记录的整个集合称为一个*文件*。每个记录 Rj 都有一个键 Kj，它控制排序过程。除了密钥之外，通常还存在其他数据；这个额外的“卫星信息”对排序没有影响，只是它必须作为每条记录的一部分携带。

两者都没有，在他关于排序的讨论中，我认为没有必要在额外的“键集”中复制键。

... [《计算机编程的艺术》，第 6 章，简介]

> *实体集*是集合或集合特定实体类型的所有实体 [http://wiki.answers.com/Q/What_is_entity_and_entity_set_in_dbms] 单个类的对象共享它们的类属性。同样，在数据库中做记录。它们共享列属性。
> 
> 集合的一个特例是类范围，它是属于该类的所有对象的集合。类范围允许将类视为关系

... [《数据库系统概念》，第 6 版]

基本上，类描述了所有实例共有的属性。关系数据库中的表也是如此。[“您将拥有的最简单的映射是单个属性到单个列的属性映射。”](http://www.agiledata.org/essays/mappingObjects.html) 这就是我所说的情况。

我在证明对象和数据库记录之间的类比（同构）方面非常冗长，因为有些愚蠢的人不接受它（证明他们的 Set 一定没有*get*方法）

您在回放中看到不理解这一点的人如何说 Set 和 get 是多余的？这是因为他们的滥用地图，他们强加用于代替集合，引入了冗余。他们对 put(obj.getKey(), obj) 的调用存储了两个键：作为对象一部分的原始键和映射键集中的副本。重复就是冗余。它还涉及更多的代码膨胀并浪费运行时消耗的内存。我不了解数据库内部原理，但良好设计和数据库规范化的原则表明这种重复是个坏主意 -[必须只有一个事实来源](http://en.wikipedia.org/wiki/Single_Source_of_Truth)。冗余意味着可能会发生不一致：键映射到具有不同键的对象。不一致是冗余的表现。[Edgar F. Codd 提出 DB 规范化](http://en.wikipedia.org/wiki/Database_normalization)只是为了消除冗余及其推断的不一致。老师们对规范化很明确：[规范化永远不会生成两个具有一对一关系的表。没有理论上的理由将这样的单个实体与一个表的单个记录中的某些字段和另一个表的单个记录中的其他字段分开](http://www.alvechurchdata.co.uk/hints-and-tips/softnorm.html)

所以，我们有 4 个参数，为什么使用 map 来实现 get in set 是不好的：

1.  当我们有一组独特的对象时，地图是不必要的
2.  map 在运行时存储中引入冗余
3.  map 在数据库中引入了代码膨胀（在集合中）
4.  使用 map 与数据存储规范化相矛盾

即使您不了解记录集的概念和数据规范化，在玩集合时，您也可能自己发现这种数据结构和算法，就像我们 org.eclipse.KeyedHashSet 和 C++ STL 设计者所做的那样。

我因指出这些想法而被 Sun 论坛禁止。偏执是反对原因的唯一论据，这个世界由偏执者主宰。他们不想看到概念以及事情如何有所不同/改进。他们只看到现实世界，无法想象 Java Collections 的设计可能存在不足和可以改进的地方。向这些人提醒合理的事情是危险的。他们教你盲目，如果你不服从就会惩罚。

2013 年 12 月添加：[SICP 还说**DB 是带有键控记录的集合，而不是映射**：](http://mitpress.mit.edu/sicp/full-text/sicp/book/node40.html)

> 典型的数据管理系统花费大量时间访问或修改记录中的数据，因此需要一种有效的方法来访问记录。这是通过识别每条记录的一部分作为识别键来完成的。现在我们将数据库表示为一组记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T02:40:52.740

好吧，如果你已经从集合中“得到”了这个东西，你就不需要 get() 了，是吗？;-)

我认为你使用地图的方法是正确的。听起来您正在尝试通过它们的 equals() 方法“规范化”对象，我一直按照您的建议使用 Map 来完成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T05:32:44.280

我不确定您是否正在寻找 Sets 为何以这种方式运行的解释，或者寻找解决它所带来问题的简单方法。其他答案涉及前者，所以这里是对后者的建议。

您可以迭代 Set 的元素并使用 equals() 方法测试每个元素的相等性。它易于实施且不易出错。显然，如果您不确定元素是否在集合中，请事先检查 contains() 方法。

这与例如 HashSet 的 contains() 方法相比效率不高，后者确实“找到”存储的元素，但不会返回它。如果您的集合可能包含许多元素，甚至可能是使用“更重”解决方法的原因，例如您提到的地图实现。但是，如果它对你来说很重要（而且我确实看到了拥有这种能力的好处），那么它可能是值得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T08:39:12.660

所以我知道你可能有两个相等的对象，但它们不是同一个实例。

如

```
Integer a = new Integer(3);
Integer b = new Integer(3); 
```

在这种情况下， a.equals(b) 因为它们引用相同的内在价值，但 a != b 因为它们是两个不同的对象。

Set 还有其他实现，例如[IdentitySet](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/util/IdentitySet.html)，它们在项目之间进行不同的比较。

但是，我认为您正在尝试将不同的哲学应用于 Java。如果你的对象是相等的 (a.equals(b)) 虽然 a 和 b 有不同的状态或意义，那么这里就有问题了。您可能希望将该类拆分为两个或多个实现公共接口的语义类 - 或者重新考虑 .equals 和 .hashCode。

如果您有 Joshua Bloch 的[Effective Java](http://java.sun.com/docs/books/effective/)，请查看名为“在覆盖 equals 时遵守一般合同”和“最小化可变性”的章节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T09:22:06.850

只需使用 Map 解决方案... TreeSet 和 HashSet 也可以这样做，因为它们由 TreeMap 和 HashMap 备份，因此这样做不会受到任何惩罚（实际上应该是最小的收益）。

您还可以扩展您最喜欢的 Set 以添加 get() 方法。

[]]

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T11:00:27.987

我认为，给定一些 Set 实现，您唯一的解决方案是遍历其元素以找到一个等于（）的元素 - 然后您在 Set 中拥有匹配的实际对象。

```
K target = ...;
Set<K> set = ...;
for (K element : set) {
  if (target.equals(element)) {
    return element;
  }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-21T20:44:10.957

如果您将其视为一个数学集合，您可以推导出一种查找对象的方法。
将集合与仅包含您要查找的对象的对象集合相交。如果交叉点不为空，则集合中唯一剩下的项目就是您要查找的项目。

```
public <T> T findInSet(T findMe, Set<T> inHere){
   inHere.retainAll(Arrays.asList(findMe));
   if(!inHere.isEmpty){
       return inHere.iterator().next();
   }
   return null;
} 
```

它不是最有效地使用内存，但它在功能和数学上是正确的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-14T03:23:53.760

“我想要集合中已经存在的确切对象实例，而不是 .equals() 返回 true 的可能不同的对象实例。”

这没有意义。说你这样做：

```
Set<Foo> s = new Set<Foo>();
s.Add(new Foo(...));
...
Foo newFoo = ...; 
```

你现在做：

```
s.contains(newFoo) 
```

如果您希望仅当集合中的对象为 == newFoo 时才为真，请使用对象标识实现 Foo 的 equals 和 hashCode。或者，如果您尝试将多个相等的对象映射到规范的原始对象，那么 Map 可能是正确的选择。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-14T03:24:30.937

我认为期望是 equals 真正代表某种平等，而不是简单地认为两个对象具有相同的主键，例如。如果 equals 表示两个真正相等的对象，那么 get 将是多余的。您想要的用例建议一个 Map，也许是一个不同的键值，代表主键的东西，而不是整个对象，然后相应地正确实现 equals 和 hashcode。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-14T06:03:37.810

[函数式 Java](http://code.google.com/p/functionaljava)有一个持久化 Set（由红/黑树支持）的实现，它顺便包含一个[split](http://functionaljava.googlecode.com/svn/artifacts/2.19/javadoc/fj/data/Set.html#split(A))方法，它似乎可以满足您的需求。它返回一个三元组：

1.  出现在找到的对象之前的所有元素的集合。
2.  一个类型的对象，`Option`它要么是空的，要么包含找到的对象（如果它存在于集合中）。
3.  出现在找到的对象之后的所有元素的集合。

你会做这样的事情：

```
MyElementType found = hayStack.split(needle)._2().orSome(hay); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-30T14:47:55.343

```
Object fromSet = set.tailSet(obj).first();

if (! obj.equals(fromSet)) fromSet = null; 
```

做你正在寻找的东西。我不知道为什么java隐藏它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-01-06T12:33:57.473

说，我有一个带有 ID 和名称的用户 POJO。ID 保持 equals 和 hashcode 之间的契约。name 不是对象相等性的一部分。我想根据某个地方的输入来更新用户的名称，比如 UI。

由于 java set 不提供 get 方法，我需要在我的代码中迭代 set 并在找到相等的对象时更新名称（即当 ID 匹配时）。

如果你有 get 方法，这段代码可能会被缩短。

Java 现在带有各种愚蠢的东西，比如 javadb 和增强的 for 循环，我不明白为什么在这种特殊情况下它们是纯粹的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-05-23T10:25:46.933

我有同样的问题。我通过将我的集合转换为地图，然后从地图中获取它们来修复它。我使用了这种方法：

```
public Map<MyObject, MyObject> convertSetToMap(Set<MyObject> set)
{
    Map<MyObject, MyObject> myObjectMap = new HashMap<MyObject, MyObject>();

    for(MyObject myObject: set){
        myObjectMap.put(myObject, myObject);
    }
    return myObjectMap
} 
```

现在您可以通过调用此方法从集合中获取项目，如下所示：

```
convertSetToMap(myset).get(myobject); 
```

您可以覆盖类中的等号，使其仅检查某些属性，例如 Id 或 name。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-11-08T22:36:53.777

如果您在 Java 错误游行中对此提出了请求，请在此处列出，我们可以投票。我认为至少方便类 java.util.Collections 只接受一个集合和一个对象并实现类似

```
searchSet(Set ss, Object searchFor){

        Iterator it = ss.iterator();
        while(it.hasNext()){
            Object s = it.next();
            if(s != null && s.equals(searchFor)){
                return s;
            }
        } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-01T07:01:37.780

这显然是 Set API 的一个缺点。

简单地说，我想在我的 Set 中查找一个对象并更新它的属性。

而且我必须遍历我的（哈希）集才能找到我的对象......叹息......

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-06-11T20:30:17.413

我同意我希望看到 Set 实现提供 get() 方法。

作为一种选择，在您的对象实现（或可以实现）java.lang.Comparable 的情况下，您可以使用 TreeSet。那么get()类型的函数可以通过调用ceiling()或者floor()得到，然后检查结果是否为非空且等于比较对象，如：

```
TreeSet myTreeSet<MyObject> = new TreeSet();
:
:

// Equivalent of a get() and a null-check, except for the incorrect value sitting in
// returnedMyObject in the not-equal case.
MyObject returnedMyObject = myTreeSet.ceiling(comparisonMyObject);

if ((null != returnedMyObject) && returnedMyObject.equals(comparisonMyObject)) {
:
:
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-03-05T20:13:57.210

没有get的原因很简单：

如果您需要从集合中获取对象 X 是因为您需要 X 中的某些东西而您没有该对象。

如果您没有该对象，那么您需要一些方法（键）来定位它。..它的名字，一个数字什么的。那就是地图是正确的。

map.get("key") -> X！

集合没有键，你需要遍历它们来获取对象。

那么，为什么不添加一个方便的 get( X ) -> X

这没有任何意义，因为你已经有了 X，纯粹主义者会说。

但是现在将其视为非纯粹主义者，看看您是否真的想要这个：

假设我制作了对象 Y，它与 X 的等号匹配，因此 set.get(Y)->X。Volia，然后我可以访问我没有的X的数据。例如，X 有一个名为 get flag() 的方法，我想要它的结果。

现在看看这段代码。

是

X = map.get(Y);

所以 Y.equals(x) 为真！

但..

Y.flag() == X.flag() = 假。（他们不是平等的吗？）

所以，你看，如果 set 允许你得到这样的对象，那肯定是打破了 equals 的基本语义。稍后你将与 X 的小克隆一起生活，他们都声称它们是相同的，而实际上它们不是。

您需要一张地图来存储东西并使用密钥来检索它。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-07-24T09:55:03.637

我知道在 Set 中只允许根据 .equals() 的任何对象的一个​​实例，如果您已经有一个等效对象，您不应该“需要”从 Set 中获取一个对象，但我仍然想有一个 .get() 方法，在给定等效对象作为参数的情况下，返回 Set（或 null）中对象的实际实例。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-07-24T10:16:34.423

简单的接口/API 在实现过程中提供了更多的自由。例如，如果`Set`将接口简化为单个`contains()`方法，我们会得到一个典型的函数式编程的集合定义——它只是一个谓词，实际上没有存储任何对象。java.util.EnumSet 也是如此——它只包含每个可能值的位图。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-11-24T15:49:29.930

这只是一个意见。我相信我们需要了解我们有几个没有字段/属性的java类，即只有方法。在那种情况下，equals 不能通过比较函数来衡量，一个这样的例子就是 requestHandlers。请参阅下面的 JAX-RS 应用程序示例。在这种情况下，SET 比任何数据结构都更有意义。

```
@ApplicationPath("/")
public class GlobalEventCollectorApplication extends Application {
    @Override
    public Set<Class<?>> getClasses() {
        Set<Class<?>> classes = new HashSet<Class<?>>();
        classes.add(EventReceiverService.class);
        classes.add(VirtualNetworkEventSerializer.class);
        return classes;
    }
} 
```

要回答您的问题，如果您有一个浅员工对象（即只有 EMPID，它在 equals 方法中用于确定唯一性），并且如果您想通过在集合中进行查找来获得深层对象，则 SET 不是data-structure ，因为它的目的不同。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-08-24T09:36:23.067

**列表是有序的数据结构**。所以它遵循插入顺序。因此，您放置的数据将在您插入时的确切位置可用。

```
List<Integer> list = new ArrayList<>();
list.add(1);
list.add(2);
list.add(3);

list.get(0); // will return value 1 
```

记住这是一个简单的数组。

**Set 是无序的数据结构**。所以它没有顺序。您在特定位置插入的数据将在任何位置可用。

```
Set<Integer> set = new HashSet<>();
set.add(1);
set.add(2);
set.add(3);
//assume it has get method
set.get(0); // what are you expecting this to return. 1?.. 
```

但它会返回别的东西。因此，在 Set 中创建 get 方法没有任何意义。

**注意****为了解释我使用了 int 类型，这同样适用于 Object 类型。

* * *

## 回答 #24

> 赞同：-6
> 
> 时间：2009-05-14T02:47:26.050

我想你已经回答了你自己的问题：它是多余的。

Set 提供 Set#contains (Object o) ，它提供所需的 Set#get(Object o) 的等效身份测试并返回一个布尔值，正如预期的那样。

# installation - 保存 NSI S 安装日志

> ID：861297
> 
> 赞同：26
> 
> 时间：2009-05-14T02:38:33.370
> 
> 标签：installation, nsis

保存 NSI​​S 中显示的安装日志的最简单方法是什么？我似乎记得在某处读过，您可以使用特殊标志重新编译 NSIS 代码以使其能够保存日志。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-09-25T08:27:54.393

为了保持文件较小，NSIS 编译器的默认安装不会生成日志文件。下载发行版的[特殊](http://nsis.sourceforge.net/Special_Builds)版本并将其复制到`makensis.exe`应用程序（和`Stub`文件夹）上以修补它以获得日志记录支持。

完成后，只需将以下内容添加到脚本中：

```
 LogSet on 
```

无需进行其他更改。我不知道为什么这不是我的默认情况，它只为文件大小增加了 48 个字节！

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-14T02:57:59.020

试试[NSISLog](http://nsis.sourceforge.net/NSISLog_plug-in)插件。

还有[LogEx](http://nsis.sourceforge.net/LogEx_plug-in)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T02:55:05.687

这是直接来自[NSIS 网站的解决方案](http://nsis.sourceforge.net/Dump_log_to_file)

```
StrCpy $0 "$EXEDIR\install.log"
Push $0
Call DumpLog

!define LVM_GETITEMCOUNT 0x1004
!define LVM_GETITEMTEXT 0x102D

Function DumpLog
  Exch $5
  Push $0
  Push $1
  Push $2
  Push $3
  Push $4
  Push $6

  FindWindow $0 "#32770" "" $HWNDPARENT
  GetDlgItem $0 $0 1016
  StrCmp $0 0 exit
  FileOpen $5 $5 "w"
  StrCmp $5 "" exit
    SendMessage $0 ${LVM_GETITEMCOUNT} 0 0 $6
    System::Alloc ${NSIS_MAX_STRLEN}
    Pop $3
    StrCpy $2 0
    System::Call "*(i, i, i, i, i, i, i, i, i) i \
      (0, 0, 0, 0, 0, r3, ${NSIS_MAX_STRLEN}) .r1"
    loop: StrCmp $2 $6 done
      System::Call "User32::SendMessageA(i, i, i, i) i \
        ($0, ${LVM_GETITEMTEXT}, $2, r1)"
      System::Call "*$3(&t${NSIS_MAX_STRLEN} .r4)"
      FileWrite $5 "$4$\r$\n"
      IntOp $2 $2 + 1
      Goto loop
    done:
      FileClose $5
      System::Free $1
      System::Free $3
  exit:
    Pop $6
    Pop $4
    Pop $3
    Pop $2
    Pop $1
    Pop $0
    Exch $5
FunctionEnd 
```

# .net - 什么是 Microsoft 开发环境设置最佳实践

> ID：861299
> 
> 赞同：1
> 
> 时间：2009-05-14T02:38:44.370
> 
> 标签：.net, development-environment

我刚刚加入了一个开发人员小团队，每个开发人员设置他们的开发环境的方式或他们如何使用版本控制（目前是 Source Safe）似乎没有任何押韵或理由。

我犯了一个“错误”，就他们的标准做法提出问题。长话短说，这为我赢得了一项任务，即制定一个计划来标准化我们合理可行的一切，因为目前没有标准，这会造成不必要的延误和头痛。所以我希望你们中的一些人能给我一些建议，或者在这方面给我一些好的资源。

一点背景。我们的团队大约有 10 名开发人员，他们都从事 .NET 项目，从 DotNetNuke 门户和模块到 Web 服务，再到 WPF 项目。大多数开发人员自主工作（因此每个人的设置有所不同），但我们都必须有权（目前通过 Source Safe）访问所有项目以获得支持、寻找错误和增强功能。

我正在寻找简单的建议，例如我们应该在每个盒子上标准化第三方 dll 的位置，或者为这些位置使用网络位置，以便所有引用都是一致的 - 什么是组织我们的项目文件夹结构的最佳方式 - 即将到来计划逐步重组所有内容（即，将其留在原处，直到您需要对其进行处理，然后将其迁移到新系统中）。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T03:09:44.840

尽可能使用基于项目的引用。对于第三方 dll，请确保您有一个名为 Lib 或类似名称的单独文件夹，并将每个第三方 dll 放在各自的供应商文件夹中。

例如

```
Lib\
Lib\Infragistics
Lib\Telerik 
```

如果多个项目引用它们，则此结构有时可能位于所有项目之外。

然后，您可以轻松地从您的项目中设置这些 dll 的路径。此外，很大程度上取决于您是否要更改这些第三方供应商的源代码，那么您可能必须认真考虑，因为您团队中的每个团队都可能希望进行一些更改并让他们的实例独立于依赖项或错误由于其他团队的变化。

您可以在 Web 上查找有关以下主题的更多信息，以帮助您设置标准流程。

*   持续集成
*   巡航控制网络
*   南特

另外，请注意，您不应过分强调解决方案的结构组织。真正的重点应该是持续集成、良好的构建过程和尽可能多地自动化构建内容。如果您为所有补丁、应用程序推出等创建一个简化的发布流程，它会给您留下好印象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T03:17:17.630

我工作的工作站：

1.  英特尔 Q6600
2.  4GB 内存
3.  3 22" 液晶显示器
4.  Vista Business 64 位 w/SP1 (ibstupidhate)
5.  带有 SP1 的 Visual Studio 2008
6.  高达 .Net 3.5
7.  Visual Source Safe 客户端（呃）
8.  SQL Server 管理工作室
9.  Chrome/FF 3/IE7/Opera/Safari

我的系统也有 CodeSmith Studio Professional，因为我在办公室处理所有 netTiers 生成。

Vista 没有给我任何问题，当我测试 WCF 主机时，只需在管理模式下启动 VS2008。恨多少都行，但自 2007 年 2 月以来，Vista 对我来说一直很稳定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T03:03:37.757

1) 操作系统：使用 Windows XP 直到 Windows 7 出来安装服务包和所有更新。2) 安装 .Net Framework 2.0 和它的服务包

3) 安装.Net Framework 3.0

4) 安装.Net Framework 3.5

5) 为其安装 Visual Studio 2008 和 SP1

6) 安装 SVN Server (来自 Collabnet) 和 TortoiseSVN (来自 tigris) 用于版本控制

7) 如果您构建了非常自定义的 WPF 界面，请安装 MS Expression Studio

8) 安装 Chrome, Firefox 3 (with FireBug), IE 8 (它可以模拟 7) 和 Opera 进行测试

9) 安装 SQL Server Management Studio

这将为您开始开发 WPF、Asp.net 和 WinForms 应用程序做好准备。

# text-files - 寻找一个.txt词频列表来测试一个程序

> ID：861308
> 
> 赞同：1
> 
> 时间：2009-05-14T02:41:43.677
> 
> 标签：text-files, frequency, word-frequency

我想要一份包含 200 到 1000 个左右最常用英语单词的文件。我已经能够找到包含 200,000 个单词或其他内容的荒谬列表，但没有找到更少量的更常用单词。

最好是每行一个单词，但如果不是，那么我可以格式化它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T02:50:09.427

我在 Google 上搜索了“按频率排列的英语单词”，并找到了一些很好的来源。这是[wiktionary.org 上](http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists)的一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T02:51:58.613

[这](http://www.world-english.org/english500.htm)是前 500 名。您可能可以从 HTML 中刮出列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T02:55:31.817

可以编写一个简单的解决方案，这是未经测试的，但应该是 99% 的好。

```
<?php
$fh = fopen('http://domain.tld/path/tofile.txt', 'r');
$wordList = array();
for($i=0;$i<100;$i++)
    $wordList[] = fread($fh, 1024);
print_r($wordList);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T02:59:05.037

这是 McWafflestix 的链接中的前 250 名（您强调的是少即是多），直线向上，没有多余的空格等，这要归功于 emacs 中的 kill-rectangle 。我不得不说，这是一个非常琐碎且与编程无关的事情。

```
the
of
to
and
a
in
is
it
you
that
he
was
for
on
are
with
as
I
his
they
be
at
one
have
this
from
or
had
by
hot
but
some
what
there
we
can
out
other
were
all
your
when
up
use
word
how
said
an
each
she
which
do
their
time
if
will
way
about
many
then
them
would
write
like
so
these
her
long
make
thing
see
him
two
has
look
more
day
could
go
come
did
my
sound
no
most
number
who
over
know
water
than
call
first
people
may
down
side
been
now
find
any
new
work
part
take
get
place
made
live
where
after
back
little
only
round
man
year
came
show
every
good
me
give
our
under
name
very
through
just
form
much
great
think
say
help
low
line
before
turn
cause
same
mean
differ
move
right
boy
old
too
does
tell
sentence
set
three
want
air
well
also
play
small
end
put
home
read
hand
port
large
spell
add
even
land
here
must
big
high
such
follow
act
why
ask
men
change
went
light
kind
off
need
house
picture
try
us
again
animal
point
mother
world
near
build
self
earth
father
head
stand
own
page
should
country
found
answer
school
grow
study
still
learn
plant
cover
food
sun
four
thought
let
keep
eye
never
last
door
between
city
tree
cross
since
hard
start
might
story
saw
far
sea
draw
left
late
run
don't
while
press
close
night
real
life
few
stop 
```

# sql - 根据第一个表的 ID 对第二个表的值求和

> ID：861310
> 
> 赞同：2
> 
> 时间：2009-05-14T02:42:46.420
> 
> 标签：sql, sql-server

我以前做过这个查询，但由于某种原因，我总是不得不挖掘答案。有人可以为我解释解决方案，这样我终于可以“明白”了！（谢谢！）

```
Table#1 Employees (employeeID, username)
Table#2 Sales (saleID, employeeID, amount) 
```

问题：列出所有员工，以及他们拥有的总销售额 #（计数）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T02:54:07.047

```
select
   e.employeeID
   , e.username
   , count(s.saleID) as'sales count'
   , sum(s.amount) as 'sales $ total'
from
   employees e
left outer join
   sales s
on
   s.employeeID = e.employeeID
group by 
   e.employeeID
   , e.username 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T02:44:25.917

您希望选择所有员工，并计算他们的销售额。因为您希望所有员工都在列表中，所以您将从员工表中进行选择，然后左连接到销售表，或者对销售表执行子查询。这样做也会为您提供结果中销售额为零的员工。在联接的情况下，您必须按员工分组并计算销售表中的记录。对于子查询，没有分组依据，因为您的基本查询将只返回每位员工 1 行。

```
select   Employees.EmployeeID, 
         Employees.UserName, 
         CountOfSales = COUNT(SaleID)
from     Employees LEFT JOIN 
         Sales ON Employees.EmployeeID = Sales.EmployeeID
group by Employees.EmployeeID, 
         Employees.UserName
/*
EmployeeID  UserName   CountOfSales
----------- ---------- ------------
2           bill       1
3           larry      0
1           scott      2
Warning: Null value is eliminated by an aggregate or other SET operation.
*/ 
```

- 或者 -

```
select   E.*, 
         CountOfSales = (select count(*) 
                         from   sales 
                         where  EmployeeID = E.EmployeeID)
from     Employees E
/*
employeeID  username   CountOfSales
----------- ---------- ------------
1           scott      2
2           bill       1
3           larry      0
*/ 
```

每个查询的结果均基于以下示例数据...

```
create table Employees (employeeID int , username varchar(10)) 
create table Sales (saleID int , employeeID int , amount smallmoney)
go
insert Employees values (1, 'steve'), (2, 'bill'), (3, 'larry')
insert Sales values (1, 1, 23), (2,1,33), (3,2,0)
go 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T02:48:16.407

您说您想要问题标题中的总和，但然后说您想要正文中的#（计数）。

如果您想要总和，请使用 SQL 中的 SUM 函数。

```
select Employees.EmployeeID, TotalSales = SUM(amount)
from Employees LEFT JOIN Sales ON Employees.EmployeeID = Sales.EmployeeID 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T03:34:59.867

假设一次销售只能由一名员工进行，这不是很简单吗？

Select Employees.username, count(Sales.saleID)
From Employees Left Join Sales on Employees.employeeID = Sales.employeeID
Group by Employees.username

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T02:47:17.063

```
select emp.username
      ,isnull((select count(*)
                 from sales
                where sales.employeeid = emp.employeeid),0) as [number of sales]
  from employees emp 
```

# asp.net - 停止 ASP.NET 处理带有扩展名的文件（不是 IIS）的 404 错误

> ID：861312
> 
> 赞同：3
> 
> 时间：2009-05-14T02:44:22.483
> 
> 标签：asp.net, iis-7

我正在使用 IIS7 和 ASP.NET。基本上构建一个简单的 CMS 并需要处理 .htm 和 .html 文件扩展名（由动态 asp.net 页面提供）。

我已经设置好了，所以 IIS7 将页面传递给 asp.net（不是静态处理程序）；但是，ASP.NET 知道该文件不存在并重定向到它的 404 (404.aspx?aspxerrorpath=xx)，然后我才能使用它做我需要做的事情（解析 url 并显示正确的页面）。

我正在使用 IIS7 url rewrite 模块进行 rewtitting。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T02:49:36.277

这可能是您正在寻找的，虽然我不确定：

[http://www.west-wind.com/Weblog/posts/745738.aspx](http://www.west-wind.com/Weblog/posts/745738.aspx)

# subsonic - 如何在 SubSonic 查询中使用多表选择？

> ID：861319
> 
> 赞同：0
> 
> 时间：2009-05-14T02:45:26.957
> 
> 标签：subsonic

我是 SubSonic 的新手，查询有问题。这是我的查询字符串

```
string sql = "SELECT *" +
             " FROM tbl_exrates, tbl_currency" +
             " WHERE date = " + d;
             " AND tbl_exrates.currency = tbl_currency.cid" +
             " AND (cash > 0 OR transfer > 0 OR sell > 0)"; 
```

如何将其转换为 SubSonic 查询字符串？SS 有功能支持吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T08:04:30.250

```
q = new Select().From(TblExrate.Schema)
        .InnerJoin(TblCurrency.Schema)
        .Where(tbl_exrates.date).IsEqualTo(d)
        .AndExpression(tbl_exrates.cash).IsGreaterThan(0)
        .Or(tbl_exrates.transfer).IsGreaterThan(0)
        .Or(tbl_exrates.cash).IsGreaterThan(0); 
```

# sql-server - 如何在 SQL SERVER 中使用 sqb 文件恢复数据库

> ID：861334
> 
> 赞同：27
> 
> 时间：2009-05-14T02:51:58.737
> 
> 标签：sql-server

我有一个带有 sqb 扩展名的文件（例如：clark.sqb），我应该如何使用 sqb 文件恢复数据库。谢谢！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2010-10-15T01:09:51.210

SQB 文件是使用 RedGate 的 SQL 备份工具创建的。他们提供了一个名为*sqb2mtf*的命令行工具，可用于转换为本机 SQL 备份，然后可以轻松恢复。

*   CMD线工具：http: [//downloads.red-gate.com/labs/sqb2mtf.zip](http://downloads.red-gate.com/labs/sqb2mtf.zip)
*   用法：*sqb2mtf inputfile outputfile [密码]*
*   例如*sqb2mtf "d:\backups\pubs.sqb" "e:\data\pubs.bak"*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T15:38:11.377

SQB 文件是由[Red Gate 的 SQL Backup Pro](http://www.red-gate.com/products/dba/sql-backup/)软件创建的 SQL Server 备份格式。

正如[Nick Sturgess 的回答](https://stackoverflow.com/a/3938761/4480)中提到的，有命令行和 GUI 工具可用于将 SQB 文件转换为常规 SQL Server 备份文件，然后可以正常恢复。

此外，如果您在 SQL Server 上安装了[SQL Backup Pro 的服务器组件](http://www.red-gate.com/help/sqlbackup/topics/SBU_InstallnNotes.html)，则可以使用如下存储过程调用**直接从 SQB 文件恢复数据库：**

```
EXEC master..sqlbackup '-sql "RESTORE DATABASE [MyDatabase] FROM DISK = [C:\backups\*.sqb] LATEST_ALL WITH RECOVERY"' 
```

`MyDatabase`该命令将从中的所有 SQB 文件中恢复数据库的最新可能备份`C:\backups\`。因此，如果您有少量完整备份、差异备份和事务备份都保存在 C:\backups 中，此命令将自动计算可以恢复的最新备份，而无需您手动选择正确的文件，也无需将 SQB 文件转换为另一种格式。

有许多不同的选项可用于直接从 SQB 文件恢复数据库，包括：

*   恢复到与备份中的数据库名称不同的数据库
*   重新定位应该存储 MDF 和 LDF 文件的位置（如果您要恢复到的服务器与进行备份的服务器不同，这很有用）

所有这些选项（以及更多）都在[Red Gate 的语法示例页面](http://www.red-gate.com/supportcenter/Content/SQL_Backup/help/7.2/SBU_Toolkit_syntax_egs#o15223)上进行了概述。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T03:37:29.580

我认为这是一个 Red Gate SQLBackup 文件 - 在[这里](http://www.red-gate.com/products/sql_backup/index_2.htm)查看更多信息。您应该能够下载试用版以尝试恢复。

祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-12T14:48:14.760

另一个快速的答案 - 如果您安装了 Redgate SQL Backup 应用程序，您可以通过他们的应用程序完成所有这些操作，而不必乱用命令。

工具 --> 实用工具 --> SQL 备份文件转换器

[![使用备份 SQL 备份 RedGate 应用程序](https://i.stack.imgur.com/6HP44.png)](https://i.stack.imgur.com/6HP44.png)

# c# - 在C#中查找与引用参数对应的对象字段

> ID：861336
> 
> 赞同：1
> 
> 时间：2009-05-14T02:53:12.930
> 
> 标签：c#, .net, reflection, concurrency, clr

当您在 C# 中使用 yield 语法编写迭代器函数时，编译器会在内部将您的函数转换为类。所以，如果我写这样的东西：

```
IEnumerator<int> MyIterator () {
  for (int i = 0; i < 10; i++)
    yield return i;
} 
```

调用 MyIterator() 会为 i 构造一个带有私有字段的类，而不是使用堆栈变量。

现在的问题是：我想找到一种方法来定位用于存储 i 值的字段。原因有点牵扯：

我正在使用迭代器函数进行协作线程。我在迭代器中编写了这样的简单代码，以便暂停函数的执行，直到异步操作完成。

```
Future<string> f;
yield return file.readLine(out f);
string line = f.Result; 
```

当这三个语句被执行时，readLine 函数被调用并将一个future 存储到'f' 字段中。然后迭代器函数被挂起，并在“f”Future 已将结果存储到其中时重新唤醒，此时我可以检索结果。

我想要做的是：

```
string line;
yield return file.readLine(out line); 
```

在正常情况下，这在 .NET 中是不可能的，因为无法保证堆栈变量的存活时间足以让我能够对其进行写入。

但是，知道迭代器函数将其所有本地变量存储在字段中，理论上我可以通过持有对迭代器（保持活动状态）和字段本身的引用来做到这一点，这样当 readLine 操作完成时，我可以存储结果直接进入田野。

问题是 CLR 似乎没有给我一种方法来做到这一点。

如果我有一个“out”或“ref”参数，我可以使用不安全的 C# 或原始 MSIL 将该参数转换为原始指针、引用或 TypedReference。不幸的是，将这三种类型中的任何一种存储在一个字段中都是不合法的——即使你欺骗编译器让你这样做，字节码验证器也不会让你执行代码。这很可能是因为存储对堆栈变量的引用本质上是不安全的。

所以我要做的是编写一个函数，它接受一个 out/ref 参数，并搜索调用迭代器的字段以找到相应的字段。一旦拥有该字段，它将对迭代器和字段的引用存储到包装器类型中，并将包装器与异步操作相关联。

鉴于 .NET 中运行时反射所涉及的开销，我怀疑如果不预处理我的源代码或在编译后对我的程序集进行后处理，这是不可能的。

但是，我很想听听一些关于替代解决方案的建议。：） 有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T04:15:06.027

对迭代器的字段进行胡闹是自找麻烦。使用您在迭代器签名中指定的类的成员不是更简单吗？是通过传入还是传出？基本上涉及某种简单的包装类？

```
class MyWrapper {
    public string Line {get;set;}
} 
```

让你可以很安全地交谈`Line`，仅仅通过一个`MyWrapper`对象引用？

我没有理解所有问题，所以这是我能说的最好的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-23T01:52:19.950

我终于在这里找到了满足我需求的解决方案，你知道什么 - 它涉及 LINQ。

.NET 上的一篇博文提到了如果您知道表达式的结果类型，如何将任何表达式 lambda 转换为 Expression<> 对象。鉴于此，事实证明您可以采用如下表达式：

() => this.Foo.Bar

并遍历节点以最终得到一个 MemberInfo（用于“Bar”）和一个“this”对象（用于“this.Foo”）。给定这两个值，您可以直接绑定到编译时指定的字段或属性。对于属性，您可以通过从 MemberInfo 中检索属性的 Get 和 Set 方法并将它们转换为强类型委托来非常有效地执行此操作，从而使读取/写入该属性的成本非常低。

最重要的是，这与自动重构和源代码搜索完美配合，因为它让编译器为您发挥作用，并且不需要对现有代码进行任何修改即可进行绑定。

唯一的缺点是很难绑定到结构的字段/属性，但我不认为这是一个特别相关的用例。

希望解决此问题或类似问题的任何人都可以在此处查看源代码：

[http://code.google.com/p/fracture/source/browse/trunk/Squared/Util/Bind.cs](http://code.google.com/p/fracture/source/browse/trunk/Squared/Util/Bind.cs)

# javascript - 从表单结果调用 javascript 函数

> ID：861339
> 
> 赞同：1
> 
> 时间：2009-05-14T02:54:50.367
> 
> 标签：javascript, html

所以我有一个 html 页面（实际上是用 php 生成的），它将创建一个包含表单的弹出窗口。我所有的 javascript 内容都在一个单独的 javascript 文件中。我想知道是否可以从表单结果文本中调用我的 javascript 文件中的函数。

这是第一个html页面

```
<script type="text/javascript" src="x.js"></script><h1>hello</h1>
<div id='form'>
<a href='#' onclick="makewindows('<form action="process.php" method="post" enctype="multipart/form-data "><label for="file">Filename:</label><input type="file" name="file" id="file"/> <br /><input type="submit" name="submit" value="Submit" onclick="" /></form>'); return false;">
click here</a>
</div> 
```

上传文件后，会生成显示文件名称的结果文本。在 x.js 中，我有一个更新原始窗口中 div 的功能。那么我可以从普通的 html 页面调用它吗？

这是maewindows的代码

```
function makewindows(html){
child1 = window.open ("about:blank");
child1.document.write(html);
child1.document.close(); 
} 
```

我不想用 onclick 调用函数，我想从表单的结果文本中调用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T03:44:23.040

您想从在打开的窗口中运行的脚本访问使用 window.open 打开窗口的同一页面中声明的 Javascript 函数？

[window.opener](https://developer.mozilla.org/en/DOM/window.opener)是您正在寻找的。

例如，如果您有一个在`x.js`as中定义的函数`function foobar(s)`（并且`x.js`包含在主窗口中），您可以返回如下内容作为来自 的响应`process.php`：

```
<script type="text/javascript">
    window.opener.foobar('returned text');
    window.close();
</script> 
```

并将字符串“返回的文本”传递回`foobar`函数。

这样做的原因是使用`function`全局范围内的关键字定义的任何内容都会自动添加为当前`window`对象的属性。如果您的函数未在全局范围内定义，则可以强制它成为如下属性`window`：

```
window.foobar = function(s) { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T16:58:14.723

托比亚斯是对的。

但是没有 opener 属性，主窗口和目标窗口不能通信——没有平局。

这篇过时的文章说明了一种 onclicks 解决方案，尽管它带有目标。和你一起玩可能会很有趣。 [http://homepage.mac.com/bigeuniverse/tests/targetwindows/](http://homepage.mac.com/bigeuniverse/tests/targetwindows/)

然而，今天最好使用与它们相关联的侦听器和函数来执行此操作。我会在你的“ ***makewindows*** ”函数中明确定义开启者，以及定义窗口。

家长：像这样：

```
var child1 = null;
function makewindows(html) 
{
    if (!child1 || child1.closed) {
       child1 = window.open(...);
       ...//rest of original code
    } else {
       child1.focus();
       /* in case it's okay to simply open the same window 
          for another upload; otherwise, nix this section*/
    }
    if (child1.opener == null) {
          child1.opener = self;
    }        
 } 
```

孩子：假设 x.js 有一个名为“childListener”的函数：您的 process.php 可以向“孩子”页面提供一个自执行的 JavaScript 函数，例如：

```
var talkToParent = function(saywhat) 
{
    opener = opener || self.opener || window.opener;
    if (opener != null  && saywhat) {
        opener.childListener(saywhat);
    }
}($uploaded_filename); 
```

只要上传的文件名被传递，这将立即执行（当然是在脚本标签内）。如果您将 php 设置为传递文件名而不是文件名，那么您实际上可以提醒父级上传错误。同样，这假定“ *childListener* ”函数位于 x.js 或从打开页面调用的其他脚本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T03:00:08.140

makewindows 是做什么的？您可能希望将该 html 放入模板或某种类型的单独文件中。是的，您可以从表单事件 onsubmit 事件中调用 javascript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T03:07:21.087

是的你可以。您只需像使用 html 文件本身中定义的任何函数一样按名称调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T03:09:45.980

如果我正确理解了您的问题，您是在尝试更新弹出窗口中的一些信息，并且这些更新的信息会反映在打开弹出窗口的页面中吗？

我想[这](http://www.captain.at/howto-ajax-parent-opener-window-close-error.php)可能会对你有所帮助。

# java - 在 Java 中，如何确定线程是否正在运行？

> ID：861346
> 
> 赞同：91
> 
> 时间：2009-05-14T02:57:43.730
> 
> 标签：java, multithreading

如何判断一个线程是否正在运行？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-05-14T03:00:01.307

`Thread.isAlive()`

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-05-14T03:21:22.893

您可以使用此方法：

```
boolean isAlive() 
```

如果线程还活着，则返回 true；如果线程已死，则返回 false。这不是静态的。您需要对 Thread 类的对象的引用。

另一个提示：如果您正在检查它的状态以使主线程在新线程仍在运行时等待，您可以使用 join() 方法。它更方便。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-14T03:12:58.203

我认为您可以使用[GetState()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#getState())；它可以返回线程的确切状态。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-14T03:06:24.083

通过调用检查线程状态`Thread.isAlive`。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-09-22T14:26:08.380

准确地说，

`Thread.isAlive()`如果线程已启动（可能尚未运行）但尚未完成其运行方法，则返回 true。

`Thread.getState()`返回线程的确切状态。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-01-09T11:09:34.393

***Thread.State**枚举类和新的**getState()** API 用于查询线程的执行状态。*

*一个线程在给定的时间点只能处于一种状态。这些状态是不反映任何操作系统线程状态的虚拟机状态*[ `NEW, RUNNABLE, BLOCKED, WAITING, TIMED_WAITING, TERMINATED`]。

> enum [Thread.State](https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.State.html)扩展 Enum 实现[Serializable](https://stackoverflow.com/a/31651945/5081877) , [Comparable](https://stackoverflow.com/a/31244596/5081877)

*   **getState()**^([*`jdk5`*](https://docs.oracle.com/javase/8/docs/technotes/guides/lang/enhancements.html#jdk5.0lang)) - `public State getState() {...}` **«** *返回`this`线程的状态。此方法设计用于监控系统状态，而不是用于同步控制。*

*   **isAlive()** - `public final native boolean isAlive();` **«如果调用它的线程仍然活着，则** *返回**true**，否则返回**false**。如果线程已启动且尚未死亡，则该线程处于活动状态。*

*类的示例源代码[`java.lang.Thread`](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/db8272cb8c99/src/share/classes/java/lang/Thread.java#l140)和[`sun.misc.VM`](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/tip/src/share/classes/sun/misc/VM.java#l369).*

```
package java.lang;
public class Thread implements Runnable {
    public final native boolean isAlive();

    // Java thread status value zero corresponds to state "NEW" - 'not yet started'.
    private volatile int threadStatus = 0;

    public enum State {
        NEW, RUNNABLE, BLOCKED, WAITING, TIMED_WAITING, TERMINATED;
    }

    public State getState() {
        return sun.misc.VM.toThreadState(threadStatus);
    }
}

package sun.misc;
public class VM {
    // ...
    public static Thread.State toThreadState(int threadStatus) {
        if ((threadStatus & JVMTI_THREAD_STATE_RUNNABLE) != 0) {
            return Thread.State.RUNNABLE;
        } else if ((threadStatus & JVMTI_THREAD_STATE_BLOCKED_ON_MONITOR_ENTER) != 0) {
            return Thread.State.BLOCKED;
        } else if ((threadStatus & JVMTI_THREAD_STATE_WAITING_INDEFINITELY) != 0) {
            return Thread.State.WAITING;
        } else if ((threadStatus & JVMTI_THREAD_STATE_WAITING_WITH_TIMEOUT) != 0) {
            return Thread.State.TIMED_WAITING;
        } else if ((threadStatus & JVMTI_THREAD_STATE_TERMINATED) != 0) {
            return Thread.State.TERMINATED;
        } else if ((threadStatus & JVMTI_THREAD_STATE_ALIVE) == 0) {
            return Thread.State.NEW;
        } else {
            return Thread.State.RUNNABLE;
        }
    }
} 
```

* * *

以并行执行多个线程[为例](https://stackoverflow.com/a/37116094/5081877)`java.util.concurrent.CountDownLatch`，完成所有线程后主线程执行。（直到并行线程完成他们的任务主线程将被阻塞。）

```
public class MainThread_Wait_TillWorkerThreadsComplete {
    public static void main(String[] args) throws InterruptedException {
        System.out.println("Main Thread Started...");
        // countDown() should be called 4 time to make count 0\. So, that await() will release the blocking threads.
        int latchGroupCount = 4;
        CountDownLatch latch = new CountDownLatch(latchGroupCount);
        new Thread(new Task(2, latch), "T1").start();
        new Thread(new Task(7, latch), "T2").start();
        new Thread(new Task(5, latch), "T3").start();
        new Thread(new Task(4, latch), "T4").start();

        //latch.countDown(); // Decrements the count of the latch group.

        // await() method block until the current count reaches to zero
        latch.await(); // block until latchGroupCount is 0
        System.out.println("Main Thread completed.");
    }
}
class Task extends Thread {
    CountDownLatch latch;
    int iterations = 10;
    public Task(int iterations, CountDownLatch latch) {
        this.iterations = iterations;
        this.latch = latch;
    }
    @Override
    public void run() {
        String threadName = Thread.currentThread().getName();
        System.out.println(threadName + " : Started Task...");
        for (int i = 0; i < iterations; i++) {
            System.out.println(threadName + " : "+ i);
            sleep(1);
        }
        System.out.println(threadName + " : Completed Task");
        latch.countDown(); // Decrements the count of the latch,
    }
    public void sleep(int sec) {
        try {
            Thread.sleep(1000 * sec);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
} 
```

@也可以看看

*   [“实现可运行”与“扩展线程”</a>](https://stackoverflow.com/q/541487/5081877)
[](https://stackoverflow.com/q/541487/5081877)
*   [线程状态](https://stackoverflow.com/a/27406503/5081877)
*   [线程状态图](http://bighai.com/ppjava/?p=144)
*   [如何“完全”同时启动两个线程](https://stackoverflow.com/a/3379003/5081877)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T07:03:34.107

让您的线程在完成时通知其他线程。这样，您将始终确切地知道发生了什么。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-06-08T18:52:13.017

使用**Thread.currentThread().isAlive()**来**查看线程是否处于活动状态**[输出应该为真]，这意味着线程仍在运行 run() 方法中的代码或使用**Thread.currentThread.getState()**方法来**获取线程的确切状态**。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-08T18:42:40.583

您可以使用：`Thread.currentThread().isAlive();`. 如果此线程处于活动状态，则返回**true ；**否则**为假。**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-09-22T17:51:53.333

想写一个代码来演示***isAlive() ， getState()***方法，这个例子监视一个线程，它仍然终止（死）。

```
package Threads;

import java.util.concurrent.TimeUnit;

public class ThreadRunning {

    static class MyRunnable implements Runnable {

        private void method1() {

            for(int i=0;i<3;i++){
                try{
                    TimeUnit.SECONDS.sleep(1);
                }catch(InterruptedException ex){}
                method2();
            }
            System.out.println("Existing Method1");
        }

        private void method2() {

            for(int i=0;i<2;i++){
                try{
                    TimeUnit.SECONDS.sleep(1);
                }catch(InterruptedException ex){}
                method3();
            }
            System.out.println("Existing Method2");
        }

        private void method3() {

            for(int i=0;i<1;i++){
                try{
                    TimeUnit.SECONDS.sleep(1);
                }catch(InterruptedException ex){}

            }
            System.out.println("Existing Method3");
        }

        public void run(){
            method1();
        }
    }

    public static void main(String[] args) {

        MyRunnable runMe=new MyRunnable();

        Thread aThread=new Thread(runMe,"Thread A");

        aThread.start();

        monitorThread(aThread);

    }

    public static void monitorThread(Thread monitorMe) {

        while(monitorMe.isAlive())
         {
         try{   
           StackTraceElement[] threadStacktrace=monitorMe.getStackTrace();

           System.out.println(monitorMe.getName() +" is Alive and it's state ="+monitorMe.getState()+" ||  Execution is in method : ("+threadStacktrace[0].getClassName()+"::"+threadStacktrace[0].getMethodName()+") @line"+threadStacktrace[0].getLineNumber());  

               TimeUnit.MILLISECONDS.sleep(700);
           }catch(Exception ex){}
    /* since threadStacktrace may be empty upon reference since Thread A may be terminated after the monitorMe.getStackTrace(); call*/
         }
        System.out.println(monitorMe.getName()+" is dead and its state ="+monitorMe.getState());
    }

} 
```

# c# - 属性命名约定

> ID：861353
> 
> 赞同：3
> 
> 时间：2009-05-14T03:00:14.693
> 
> 标签：c#, naming-conventions, coding-style

哪一个更可取或更清楚？

```
public int FrozenRegionWidth { get; set; } 
```

或者...

```
public int WidthOfFrozenRegion { get; set; } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T03:04:21.763

我会说 FrozenRegionWidth，否则你最终会得到一大堆以 'WidthOf..' 开头的属性。

话虽如此，你不应该有类似 FrozenRegion.Width 的东西（我会在 WidthOfFrozenRegion 上寻找 FrozenRegionWidth 的另一个原因）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T08:46:28.527

我更喜欢 FrozenRegionWidth。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms229012.aspx上的 .NET 框架命名指南](http://msdn.microsoft.com/en-us/library/ms229012.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T03:05:20.467

我不确定这是否是这个社区的问题。我相信这一定是您团队的问题。

如果我只是团队中的开发人员并且我必须选择一个名称，我会创建一个具有 Width 属性的 FrozenRegion 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T03:06:39.420

FrozenRegionWidth 是随处使用的。你只是不能使用

```
NameOfCustomer 
```

代替

```
CustomerName 
```

这使我们的变量 short n 变得甜美。你不能继续写长句子作为变量名。在这里，您正在创建一个自动属性。记住这一点。它更像是一个变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T03:31:37.003

但是，请考虑以下情况：

您正在尝试查找冻结区域的宽度，但假设您不确定它是否称为冻结区域。也许有些人称之为冻结区域，另一个人称之为 RegionThatIsFrozen（我知道，蹩脚的例子）或者其他什么：在这种情况下，程序员输入 WidthOf 并等待自动完成并选择正确的不是更容易吗?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T07:07:30.807

就个人而言，我更喜欢

```
public int FrozenRegionWidth { get; set; } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T08:57:39.637

我倾向于在名称中首先提供更通用信息的任何形式。

也就是说，我希望这样当我在智能感知中查看成员列表时，它们会根据我想要找到它们的方式进行分组。如果“FrozenRegion”对我来说比我想命名相关属性 FrozenRegionWidth、FrozenRegionFoo、FrozenRegionBar 更重要。如果我正在查看“宽度”，我想要 WidthFrozenRegion、WidthFoo、WidthBar。

因此，这取决于您的用法，但名称从最通用到最具体。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T09:03:50.310

我以类似的方式提出的[这个问题可能有帮助，也可能没有帮助，它有关于名词选择的指标。](https://stackoverflow.com/questions/412839/naming-conventions-guidelines-for-verbs-nouns-and-english-grammar-usage)

为了与 .NET BCL 命名约定保持一致，我将使用 FrozenRegionWidth。包含介词是不寻常的。

如上所述，FrozenWidth 看起来像是结构/值类型的主要候选者。

# php - 多维数组键返回单个字符，而不是值

> ID：861356
> 
> 赞同：0
> 
> 时间：2009-05-14T03:01:37.857
> 
> 标签：php

我在我的 PHP 编码中反复看到这个问题，但我从来不明白发生了什么。

```
$val = $matches[1][$i] 
```

在此示例中，$i = 0（在 for 循环中设置）并且该数组维度中保存的值是一个字符串。不是将该字符串分配给 $val，而是将 $val 分配给字符串中的第 0 个（第一个）字符。如果 $i = 1，则 $val 被分配到字符串中的第一个（第二个）字符，等等。

为什么 PHP 不返回字符串，而是将其视为子字符串操作？如何获取我的字符串值而不是该字符串中的单个字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T03:05:10.157

你确定它是一个多维数组吗？我认为，如果您访问像数组这样的字符串，它会返回字符串中键位置的字符，这可能是您的问题。检查您的作业和诸如此类的东西，并确保您不会意外地将字符串分配给 $matches[1] 而不是字符串数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T03:10:25.387

这很奇怪！我以前从未发生过这种情况。我想知道多维是否真的只是一个普通数组。如果它只是一个维度，它可能会使用您的 [$i] 返回子字符串。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-05-06T10:38:56.087

伙计，我知道它很晚，但请检查

```
$matches[] = "value"; 
```

如果您缺少 []，那么它将被视为字符串，因此应该是您的问题。

# vba - MS Excel VBA 中的错误处理

> ID：861357
> 
> 赞同：0
> 
> 时间：2009-05-14T03:01:45.547
> 
> 标签：vba, excel

我在 VBA 的循环中发生错误时遇到了一些麻烦。首先，这是我正在使用的代码

```
dl = 20
For dnme = 1 To 3
Select Case dnme
Case 1
drnme = kt + " 90"
nme = "door90"
drnme1 = nme
Case 2
drnme = kt + " dec"
nme = "door70" 'decorative glazed'
Case 3
drnme = kt + " gl"
nme = "door80" 'plain glazed'
End Select

On Error GoTo ErrorHandler
Set sh = Worksheets("kitchen doors").Shapes(drnme) 'This line here is where the problem is'
sh.Copy
ActiveSheet.Paste
    Selection.ShapeRange.Name = nme
    Selection.ShapeRange.Top = 50
    Selection.ShapeRange.Left = dl
    Selection.ShapeRange.Width = 150
    Selection.ShapeRange.Height = 220
25
dl = dl + 160
Next dnme

 Exit Sub
ErrorHandler:

GoTo 25 
```

问题是当它尝试访问形状时，形状并不总是存在。第一次通过循环，这很好。它转到 ErrorHandler 并且一切正常。第二次通过并且找不到形状，它出现了“结束/调试”错误框。我不知道为什么它不直接进入ErrorHandler。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T15:35:29.547

首先，您有一个只有 3 次迭代的 for 循环，并且您有一个用于 3 次的 switch case！！。为什么你不能将你的公共代码移动到一个新函数并调用它三次？

而且每个错误都有一个唯一的编号（以防 VBA 错误，例如下标超出范围等，或者如果它是通用编号，例如 1004，以及其他办公室错误的描述）。您需要检查错误号，然后决定如何继续，是否跳过该部分或解决。

请查看此代码。我已将您的通用代码移至一个新函数，在该函数中，我们将调整形状的大小。如果形状丢失，那么我们将返回 false，然后移动到下一个形状。

```
'i am assuming you have defined drnme, nme as strings and d1 as integer
'if not please do so
Dim drnme As String, nme As String, d1 As Integer

dl = 20

drnme = kt + " 90"
nme = "door90"
If ResizeShape(drnme, nme, d1) Then
    d1 = d1 + 160
End If
'Just call 
'ResizeShape(drnme, nme, d1)
'd1 = d1 + 160
'If you don't care if the shape exists or not to increase d1
'in that case whether the function returns true or false d1 will be increased

drnme = kt + " dec"
nme = "door70" 'decorative glazed'
If ResizeShape(drnme, nme, d1) Then
    d1 = d1 + 160
End If

drnme = kt + " gl"
nme = "door80" 'plain glazed'
If ResizeShape(drnme, nme, d1) Then
    d1 = d1 + 160
End If

ActiveSheet.Shapes("Txtdoors").Select
Selection.Characters.Text = kt & ":   " & kttxt
Worksheets("kts close").Protect Password:="UPS"

End Sub

'resizes the shape passed in.
'if the shape does not exists then returns false.
'in that case you can skip incrementing d1 by 160

Public Function ResizeShape(drnme As String, nme As String, d1 As Integer) As Integer
On Error GoTo ErrorHandler
Dim sh As Shape
Set sh = Worksheets("kitchen doors").Shapes(drnme)
sh.Copy
ActiveSheet.Paste
Selection.ShapeRange.Name = nme
Selection.ShapeRange.Top = 50
Selection.ShapeRange.Left = dl
Selection.ShapeRange.Width = 150
Selection.ShapeRange.Height = 220
Exit Function
ErrorHandler:
'Err -2147024809 will be raised if the shape does not exists
'then just return false
'for the other errors you can examine the number and go back to next line or the same line
'by using Resume Next or Resume
'not GOTO!!
If Err.Number = -2147024809 Or Err.Description = "The item with the specified name wasn't found." Then
    ResizeShape = False
    Exit Function
End If
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-06T15:05:32.827

我知道这是一个旧帖子，但也许这会对其他人有所帮助。使用原始代码但替换 ErrorHandler: GoTo 25

和

错误处理程序：简历 25

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T05:56:11.493

对不起大家，我已经找到*了*解决办法。清除错误代码不起作用，所以我不得不使用一些 GOTO，现在代码可以工作（即使它不是最优雅的解决方案）。以下是我的新代码：

```
dl = 20
For dnme = 1 To 3
BeginLoop:
Select Case dnme
Case 1
drnme = kt + " 90"
nme = "door90"
drnme1 = nme
Case 2
drnme = kt + " dec"
nme = "door70" 'decorative glazed'
Case 3
drnme = kt + " gl"
nme = "door80" 'plain glazed'
Case Else
GoTo EndLoop
End Select

On Error GoTo ErrorHandler
Set sh = Worksheets("kitchen doors").Shapes(drnme)
sh.Copy
ActiveSheet.Paste
    Selection.ShapeRange.Name = nme
    Selection.ShapeRange.Top = 50
    Selection.ShapeRange.Left = dl
    Selection.ShapeRange.Width = 150
    Selection.ShapeRange.Height = 220
25
dl = dl + 160
Next dnme

EndLoop:
     ActiveSheet.Shapes("Txtdoors").Select
    Selection.Characters.Text = kt & ":   " & kttxt
 Worksheets("kts close").Protect Password:="UPS"

 Exit Sub
ErrorHandler:
Err.Clear
dl = dl + 160
dnme = dnme + 1
Resume BeginLoop
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T20:59:22.150

您不能`ShapeRange`在同一个`Worksheet`. 是否有可能`Shape`被复制的现有对象之一是与您正在创建的新对象`ShapeRange`之一同名的成员？`ShapeRange`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T21:20:25.110

OMG - 你不应该使用 gotos 进出循环！！！

如果您想自己处理错误，请使用以下内容：

```
''turn off error handling temporarily
On Error Resume Next

''code that may cause error

If Err.Number <> 0 then
  ''clear error
  Err.clear
  ''do stuff to handle error
End if

''resume error handling
On Error GoTo ErrorHandler 
```

编辑 - 试试这个 -**没有凌乱的 GOTOS**

```
 dl = 20
  For dnme = 1 To 3

    Select Case dnme
      Case 1
        drnme = kt + " 90"
        nme = "door90"
        drnme1 = nme

      Case 2
        drnme = kt + " dec"
        nme = "door70" 'decorative glazed'

      Case 3
        drnme = kt + " gl"
        nme = "door80" 'plain glazed'

    End Select

    'temporarily disable error handling'
    On Error Resume Next
    Set sh = Worksheets("kitchen doors").Shapes(drnme)

    'save error'
    ErrNum = Err.Number

    'reset error handling'
    On Error GoTo ErrorHandler

    If ErrNum = 0 Then

      sh.Copy

      ActiveSheet.Paste

      Selection.ShapeRange.Name = nme
      Selection.ShapeRange.Top = 50
      Selection.ShapeRange.Left = dl
      Selection.ShapeRange.Width = 150
      Selection.ShapeRange.Height = 220

    End If

    dl = dl + 160

  Next dnme

  ActiveSheet.Shapes("Txtdoors").Select
  Selection.Characters.Text = kt & ":   " & kttxt
  Worksheets("kts close").Protect Password:="UPS"

NormalExit:
  Exit Sub

ErrorHandler:
  MsgBox "Error Occurred: " & Err.Number & " - " & Err.Description
  Exit Sub

End Sub 
```

# ajax - 发布表单而不更改jsp中的页面

> ID：861361
> 
> 赞同：1
> 
> 时间：2009-05-14T03:05:15.960
> 
> 标签：ajax, jsp, servlets, post, prototypejs

在jsp中，如何在不更改页面的情况下发布表单？

本质上，我正在尝试：

1) 首先，在后端启动一个 servlet，并使用一个 post 来处理 HttpServletRequest。2) 其次，一旦 servlet 完成，将使用原型的 Ajax.Updater 函数将响应消息发布到页面上的 DIV 中。

当然，所有这些都无需离开页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-12T15:22:13.920

您可以通过 jQuery.AJAX 执行此操作，如下所示：http: [//docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

```
example : $.post(servleturl, paramters, callbackfunction, "html"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T22:17:16.163

我知道有两种方法。首先，您可以从表单中提取值并将它们作为单独的 Ajax.Request 提交。Alamar 对此发布了一些[很好的说明](https://stackoverflow.com/questions/875138/how-do-i-alter-request-parameters-before-posting-xhr-action-in-ruby-on-rails/875155#875155)：

> 使用 Form.serialize(true) 获取以参数名称作为键的哈希。
> 
> 您可以对该散列执行任何操作，包括删除输入、更改其值、过滤它们等等。
> 
> Ajax.Updated 然后将接受修改后的哈希作为参数。

另一种方法是使用表单元素的“目标”属性创建一个 iFrame，它将从您的表单请求中获取响应。如果您在同一个域中工作，您将可以访问该 iFrame 的内容，并可以使用其中返回的信息来使用您想要返回的任何消息更新父页面。这种方法更复杂，但在某些情况下是必要的。例如，如果您正在处理文件上传输入，则第一种方法中的序列化哈希将不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T04:14:51.847

我使用了一些原型，你可能想要工作，只需提交你的表单，在我的工作中做了类似的事情，但你为什么不使用[DWR](http://directwebremoting.org/)？我认为异步回调和那些东西更好。

我将检查异步提交的代码。

# c++ - 这可以在不读取文件两次的情况下完成吗？C++

> ID：861366
> 
> 赞同：0
> 
> 时间：2009-05-14T03:06:45.473
> 
> 标签：c++

我在 main.cpp 中所做的是两次读取文本文件：一次从每个路径名中删除“\”，然后再次将文件的原始名称提供给我的实现文件中的 SetPath()。

```
// This a read file sub-routine called in the main function.
// Its purpose was intentionally set out to read the file, and pass information
// to functions to MyClassFile Implementational file.

// global varaible to have the file spec.
char MyClass::List_[ ARRY_SZ ] = {};

int main()
{

..
inFile.open( MyClass::List_, ios::in  );

    while ( inFile.peek() != '\n' )
    {
        inFile.get( ch );
        if ( ch == 92 )
            count++;
    }

    inFile.clear();
    inFile.close();

    inFile2.open( MyClass::List_, ios::in  );
    while ( inFile2.peek() != EOF )
    {
            for( unsigned short i = 0 ; i < count; i++ )
            {
                inFile2.getline( tmpArray, ENTRY_SZ, 92 );  
            }

            inFile2.getline( tmpArray, ENTRY_SZ, '\n' );
            MyObject = new MyClass( tmpArray );  // Name W/O Path   
            LinkedObject->AddLink( MyObject );
            lineCount++;
    }
    while ( inFile2.peek() != EOF )
    {
            inFile2.getline( tmpArray, ENTRY_SZ, '\n' );
            MyObject->GetPath( tmpArray ); 
    }
    inFile2.clear();
    inFile2.close();
} 
```

文本文件的格式如下：

```
C:/temp/fileID
C:/temp/FileID2 
```

我只需要将名称传递给复制构造函数。我需要将仍在文本文件中的完整路径名传递给我的实现文件中的 MyClass::GetPath() 函数。

有没有办法在不读取文件两次的情况下做到这一点？我希望你能看到我想在这里做什么。我可能可以倒回到开头或类似的东西

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T03:48:20.397

重述问题：

*   我有一个文本文件，其中每一行都包含一个 Windows 样式的绝对路径名。
*   我需要将文件的基本名称传递给构造函数，并将全名传递给另一个函数。

*我可以在不重新读取文件的情况下执行此操作吗？*

答案是肯定的。

*   将每一行读入一个字符串（因此它包含完整路径）。
*   如有必要，去掉尾随的换行符。
*   从完整路径中，创建一个仅包含文件基本名称的新字符串。
*   使用基本名称调用构造函数。
*   使用路径名调用另一个函数。

这是稍微多一点的字符串操作——文件操作要少得多，这就是牺牲性能的原因。

始终使用`'\\'`而不是 92。

# multithreading - 餐饮哲学家问题 - 需要澄清

> ID：861367
> 
> 赞同：2
> 
> 时间：2009-05-14T03:06:52.633
> 
> 标签：multithreading, concurrency, dining-philosopher

最近我阅读[了这篇](http://en.wikipedia.org/wiki/Dining_philosophers_problem)关于餐饮哲学家问题的维基百科文章，但我不清楚 Chandy / Misra 的解决方案。

根据文章，“当一个拿着叉子的哲学家收到请求消息时，如果叉子是干净的，他会保留叉子，如果叉子脏了就放弃。” 在这个问题的上下文中，如果他正在吃东西，他会通过它，如果他还没有开始吃东西，他会保留它。

根据场景，Dirty 是什么意思？线程正在运行还是已经退出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T03:51:59.623

脏意味着处理已经开始，因此可以中断。

只有当你有两个分叉时，你才能处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T03:22:53.903

Dirty 似乎意味着“空闲”或“可用”，而 clean 意味着“必须请求它”或“抢占它”。

它说如果他捡起一个叉子是“脏的”（当他想要叉子时没有争用它），如果他必须请求它，它是“干净的”，并且它的初始状态是脏的。

*   拿起一个可用的叉子 => 叉子脏了 => 清理它并在被问到时放弃它。

*   没有可用的叉子 => 必须要求它 => 将收到它清理。

它让我想起了名为[Don't Interrupt an Interrupt](http://users.rcn.com/jcoplien/Patterns/Process/section42.html)的组织模式。

# c# - 想要枚举 Outlook 文件夹

> ID：861370
> 
> 赞同：4
> 
> 时间：2009-05-14T03:07:53.270
> 
> 标签：c#, .net, vb.net, outlook

我正在寻找一些代码（首选 C# 或 VB.NET）来遍历 Outlook 邮箱中的所有文件夹并返回这些文件夹的名称。我不是要弹出 Outlook 文件夹对话框，而是要从 Outlook 外部返回给定邮箱中的文件夹名称。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T03:39:01.090

这实际上很容易使用[VSTO](http://blogs.msdn.com/vsto/)（Visual Studio Tools for Office）。首先使用 VSTO 创建一个 Outlook 2007 插件。这是我的一些实验代码。

```
 private void RecurseThroughFolders(Outlook.Folder theRootFolder, int depth)
    {
        if ( theRootFolder.DefaultItemType != Outlook.OlItemType.olMailItem ) {
            return;
        }

        Console.WriteLine("{0}", theRootFolder.FolderPath);

        foreach( Object item in theRootFolder.Items ) {
            if (item.GetType() == typeof( Outlook.MailItem )) {
                Outlook.MailItem mi = (Outlook.MailItem)item;
                if (mi.Categories.Length > 0) {
                    WriteLinePrefix(depth);
                    Console.WriteLine("  $ {0}", mi.Categories);
                }
            }
        }

        foreach (Outlook.Folder folder in theRootFolder.Folders) {
            RecurseThroughFolders(folder, depth + 1);
        }
    }

private void ThisAddIn_Startup(object sender, System.EventArgs e)
{
    Outlook.Application olApp = new Outlook.Application();

    Console.WriteLine("Default Profile = {0}", olApp.DefaultProfileName);

    Console.WriteLine("Default Store = {0}", olApp.Session.DefaultStore.DisplayName);

    selectExplorers = this.Application.Explorers;
    selectExplorers.NewExplorer += new Outlook.ExplorersEvents_NewExplorerEventHandler( newExplorer_Event );

    Outlook.Folder theRootFolder  = (Outlook.Folder) olApp.Session.DefaultStore.GetRootFolder();
    RecurseThroughFolders( theRootFolder, 0 );
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-05T01:34:12.840

我更喜欢 LINQ 友好的方法：

```
private IEnumerable<MAPIFolder> GetAllFolders(Folders folders)
{
    foreach (MAPIFolder f in folders) {
        yield return f;
        foreach (var subfolder in GetAllFolders(f.Folders)) {
            yield return subfolder;
        }
    }
} 
```

然后，您可以以任何方式仔细阅读文件夹。例如：

```
private IEnumerable<MailItem> GetAllEmail(NameSpace ns)
{
    foreach (var f in GetAllFolders(ns.Folders)) {
        if (f == DELETE_FOLDER) continue;
        if (f.DefaultItemType == OlItemType.olMailItem) {
            // Party!
        }
    }
} 
```

# java - 为什么 Maven 的名声这么差？

> ID：861382
> 
> 赞同：99
> 
> 时间：2009-05-14T03:12:29.623
> 
> 标签：java, maven-2, build-process, build-automation

互联网上有很多关于 Maven 有多糟糕的讨论。几年来我一直在使用 Maven 的一些特性，在我看来，最重要的好处是依赖管理。

Maven 文档不够充分，但通常当我需要完成某件事时，我会弄清楚一次然后它就可以工作（例如，当我实现对 jar 进行签名时）。我不认为 Maven 很棒，但它确实解决了一些问题，如果没有它，那将是一个真正的痛苦。

那么，为什么 Maven 的口碑这么差，我可以期待 Maven 未来会出现哪些问题？也许有更好的选择，我不知道？（例如，我从未详细看过 Ivy。）

注意：这不是试图引起争论。这是一次清除 FUD 的尝试。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-05-14T07:58:44.520

大约六个月前，我研究了 Maven。我们开始了一个新项目，没有任何遗产可以支持。那说：

*   Maven 是全有或全无。或者至少据我从文档中可以看出。不能轻易使用 maven 作为 ant 的替代品，逐渐采用更高级的功能。
*   根据文档，Maven 是一种超然的幸福，可以让你所有最疯狂的梦想成真。在你开悟之前，你只需要在手册上冥想 10 年。
*   Maven 使您的构建过程依赖于您的网络连接。
*   Maven 有无用的错误消息。比较 ant 的“项目 y 中不存在目标 x”与 mvn 的“无效任务'运行'：必须指定有效的生命周期阶段，或格式为 plugin:goal 或 pluginGroupId:pluginArtifactId:pluginVersion:goal”的目标，很有帮助，它建议我使用 -e 运行 mvn 以获取更多信息，这意味着它将打印相同的消息，然后是 BuildFailureException 的堆栈跟踪。

我不喜欢 maven 的很大一部分原因可以通过以下来自 Better Builds with Maven 的摘录来解释：

> 当有人想知道 Maven 是什么时，他们通常会问“Maven 到底是什么？”，他们希望得到一个简短而有力的答案。“嗯，它是一个构建工具或脚本框架” Maven 不仅仅是三个无聊、乏味的词。它是思想、标准和软件的结合，不可能将 Maven 的定义提炼成简单消化的声音片段。革命性的思想往往难以用语言来传达。

我的建议：如果你不能用文字传达这些想法，你不应该尝试写一本关于这个主题的书，因为我不会通过心灵感应吸收这些想法。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2009-05-14T08:49:23.057

*   它从一开始就将刚性结构强加给您。
*   它是基于 XML 的，所以它和 ANT 一样难以阅读。
*   它的错误报告是模糊的，当出现问题时会让你陷入困境。
*   文档很差。
*   它让困难的事情变得容易，让简单的事情变得困难。
*   维护一个 Maven 构建环境需要太多时间，这违背了拥有一个全能的构建系统的意义。
*   需要很长时间才能弄清楚您在 maven 中发现了一个错误并且没有配置错误。这些错误确实存在，而且在令人惊讶的地方。
*   它承诺了很多，但像一个美丽而诱人但情感冷漠和操纵性的情人一样背叛了你。

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2009-05-14T11:47:54.767

过去，我当然[对 maven 抱怨过并抱怨](http://happygiraffe.net/blog/tag/maven/)过。但现在，我不会没有它。我觉得好处远远超过任何问题。主要：

*   标准化的项目结构。
    *   给定一个新的开发者加入一个项目：
        *   当你说它是一个 Maven 项目时，开发人员就知道项目布局以及如何构建和打包项目
        *   当你说它是一个 Ant 项目时，开发人员将不得不等待你解释更多，或者必须通过 build.xml 来解决问题。
    *   当然，总是有可能在 Ant 上强加公司范围的标准，但我认为更多时候，你会重新发明众所周知的轮子。
*   依赖管理。
    *   不仅可以使用外部库，还可以使用内部库/模块。请务必使用 Maven 存储库代理服务器，例如[Nexus](http://nexus.sonatype.org/)或[Artifactory](http://www.jfrog.org/products.php)。
    *   [使用Ivy](http://ant.apache.org/ivy)可以做到这一点。事实上，如果您只需要依赖管理，那么使用 Ivy 可能会更好。
*   特别是在一个项目中。我发现拆分小的子项目非常有用，而 maven 处理得很好。蚂蚁要困难得多。
*   标准化的工件管理（尤其是与[nexus](http://nexus.sonatype.org/)或[artifactory](http://www.jfrog.org/products.php)结合使用）
*   发布插件很棒。
*   Eclipse 和 NetBeans 的集成非常好。
*   [与哈德森](http://hudson-ci.org/)的整合非常棒。特别是 findbugs 之类的趋势图。
*   这是一个小问题，但默认情况下，maven 在 jar 或 war 中嵌入了版本号等细节*（*不仅仅是在文件名中）这一事实非常有帮助。

对我来说缺点主要是：

*   命令行非常无用。这让我一开始就很反感。
*   XML 格式非常冗长。我明白为什么会这样，但读起来仍然很痛苦。
    *   也就是说，它有一个 XSD，可以在 IDE 中轻松编辑。
*   一开始很难理解它。例如，生命周期之类的东西。
    *   [然而，maven 的权威指南](http://oreilly.com/catalog/9780596517335)是一个很好的介绍。

我真的相信花一点时间了解 maven 是值得的。

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2009-05-14T08:36:05.867

我从两个大型项目的实践经验是，我们在每个项目上花费了 1000 - 1500 个小时来解决 maven 相关问题，不包括从 maven 1 迁移到 maven 2 的 500 个小时。

从那以后，我必须说我绝对讨厌maven。我一想到它就感到沮丧。

Eclipse 集成很糟糕。（例如，我们在代码生成方面遇到了无穷无尽的麻烦，其中 eclipse 与生成的代码不同步，并且经常需要完全重建。责任是 maven 和 eclipse，但 eclipse 比 maven 和 emacs 更有用，所以日食留下来，maven 必须离开。）

我们有很多依赖项，正如我们发现的那样，语法错误实际上经常提交给公共 maven 存储库，这可能会浪费您数小时的宝贵时间。每周。解决方法是拥有一个代理或本地管理的存储库，这也需要相当长的时间才能做到正确。

Mavens 项目结构并不真正适合用 Eclipse 开发，而且在 Eclipse 中构建时间会增加。

代码生成和同步问题的影响，我们不得不经常从头开始重建，将您的代码/编译/测试周期缩短为无休止的编译/网上冲浪/睡眠/死亡/代码周期，让您回到 90 年代和40 分钟编译时间。

maven 的唯一借口是依赖解决方案，但我想偶尔这样做，而不是在每个构建中。

综上所述，maven 离 KISS 尽可能的远。而且，拥护者往往是那种在生日时特别庆祝的人，因为他们的年龄是质数。随意投票给我:-)

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2009-05-14T03:16:57.430

马文很棒。在我看来，它享有盛誉的原因与陡峭的学习曲线有关。（我终于接近克服了）

文档有点粗略，只是因为感觉在它开始有意义之前有很多文本和新事物需要理解。我说时间是 Maven 获得更广泛赞誉所需要的一切。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-05-14T04:51:57.997

因为 Maven 是一种设备，可以将成年男子变成极度恐怖的啜泣群众。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2009-08-07T16:25:07.240

优点：

*   依赖管理。几年来，我和我的同事都没有手动下载和管理依赖项。这是一个巨大的节省时间。
*   IDE 独立性。事实证明，所有主要的 IDE、Eclipse、IDEA 和 NetBeans 都对 Maven 项目提供了不错的支持，因此我们的开发人员不会被锁定在一个特定的 IDE 中。
*   命令行。使用 Maven，支持同步 IDE 和命令行配置很简单，这有利于持续集成。

缺点：

*   不得不投资学习Maven。好吧，必须这样做。好消息，不是团队中的每个人都必须学习。
*   文档。曾经是个问题，现在感谢 Sonatype 和他们的书 ( [http://www.sonatype.com/products/maven/documentation/book-defguide](http://www.sonatype.com/products/maven/documentation/book-defguide) )，情况好多了。
*   刚性。有时以自己想要的方式做事是具有挑战性和令人沮丧的。我的建议是不要争吵，让 Maven 做它最擅长的事情，直接构建，或者当有稳定的 mojo 可用时。在其他情况下，我们退出并使用 Ant 任务 ( [http://maven.apache.org/plugins/maven-antrun-plugin/](http://maven.apache.org/plugins/maven-antrun-plugin/) ) 或外部程序来做一些事情。我个人最喜欢的是 Groovy 插件（[http://groovy.codehaus.org/GMaven](http://groovy.codehaus.org/GMaven)）。

竞赛：

*   Ant：没有依赖管理。时期。
*   Ivy：仍然不如 Maven 成熟（并不是说后者也没有它的怪癖）。几乎相同的功能集，所以没有令人信服的理由移动。我做了几次尝试；都失败了。

底线：我们所有的项目已经用 Maven 完成了好几年了。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2009-05-14T17:40:02.363

我认为它在拥有最简单和最复杂项目的人中名声不好。

如果您从单个代码库构建单个 WAR，它会强制您移动项目结构并将三个 jar 中的两个手动列出到 POM 文件中。

如果您从一组九个 EAR 文件原型构建一个 EAR，其中包含五个 WAR 文件、三个 EJB 和 17 个其他工具、依赖项 jar 和配置，需要在最终构建期间调整现有资源中的 MANIFEST.MF 和 XML 文件；那么 Maven 可能过于限制。这样的项目会变成一堆复杂的嵌套配置文件、属性文件以及滥用 Maven 构建目标和分类器名称。

因此，如果您处于复杂度曲线的底部 10%，那就太矫枉过正了。在该曲线的前 10% 处，您处于紧身衣中。

Maven 的增长是因为它对中间 80% 的人很有效

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2009-05-14T19:05:10.037

我的经历与这里许多帖子的挫败感相呼应。Maven 的问题在于它包装和隐藏了构建管理的细节，以寻求最终的自动魔力。如果它坏了，这会让你几乎无能为力。

我的经验是，maven 的任何问题都会迅速退化为通过嵌套 xml 文件的网络进行数小时的狙击猎杀，这种体验类似于根管治疗。

我还曾在严重依赖 Maven 的商店工作过，喜欢它的人（喜欢它的“按下按钮，完成所有工作”方面）并不理解它。maven 构建有一百万个自动目标，如果我想花几个小时阅读它们所做的事情，我相信这会很有用。更好的 2 个您完全理解的有效目标。

警告：上次与 Maven 合作是在 2 年前，现在可能会更好。

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2009-05-14T09:08:48.223

和 Glenn 一样，我不认为 Maven 的代表不好，而是混合代表。我已经工作了 6 个月，专门尝试将一个相当大的项目项目迁移到 Maven，它清楚地显示了该工具的局限性。

根据我的经验，Maven 适合：

*   外部依赖管理
*   构建的集中管理（pom继承）
*   很多插件用于很多事情
*   与持续集成工具的良好集成
*   非常好的报告功能（FindBugs、PMD、Checkstyle、Javadoc，...）

它有一些问题：

*   全有或全无的方法（很难缓慢迁移到 Maven）
*   复杂依赖，模块间依赖
*   循环依赖（我知道，糟糕的设计，但我们无法修复 5 年的开发......）
*   连贯性（版本范围在所有地方都不一样）
*   错误（再次与版本范围）
*   可重现的构建（除非你修复了所有插件的版本号，否则你不能确定你会在 6 个月内获得相同的构建）
*   缺乏文档（文档非常适合基础知识，但没有很多关于如何处理大型项目的示例）

提供一些背景信息，大约有 30 名开发人员在从事这个项目，并且该项目已经存在超过 5 年，所以：很多遗产，很多流程已经到位，很多自定义专有工具已经到位。我们决定尝试迁移到 Maven，因为维护我们专有工具的成本太高了。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2009-11-13T22:33:38.833

我想反驳一些在这个论坛上提出的投诉：

> Maven 是全有或全无。或者至少据我从文档中可以看出。不能轻易使用 maven 作为 ant 的替代品，逐渐采用更高级的功能。

这不是真的。Maven 的最大优势是使用它以合理的方式管理您的依赖关系，如果您想在 Maven 中执行此操作并在 ant 中执行其他所有操作，您可以。就是这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="foo" basedir="." xmlns:maven="antlib:org.apache.maven.artifact.ant" >
  <maven:dependencies verbose="true" pathId="maven.classpath">
    <maven:pom id="maven.pom" file="pom.xml" />
  </maven:dependencies>
</project> 
```

您现在有一个名为“maven.classpath”的类路径对象，其中包含 pom 文件中定义的所有 maven 依赖项。您只需将 maven ant 任务 jar 放在 ant 的 lib 目录中。

> Maven 使您的构建过程依赖于您的网络连接。

默认依赖项和插件获取过程取决于网络连接，是的，但仅适用于初始构建（或者如果您更改了使用中的依赖项或插件）。之后，所有 jar 都在本地缓存。如果你想强制无网络连接，你可以告诉 maven 使用离线模式。

> 它从一开始就将刚性结构强加给您。

目前尚不清楚这是指文件格式还是“约定与配置”问题。对于后者，有很多*不可见的默认值*，例如 java 源文件和资源的预期位置，或者源的兼容性。但这不是死板，它为您设置了合理的默认值，因此您不必明确定义它们。所有设置都可以很容易地覆盖（尽管对于初学者来说，很难在文档中找到如何更改某些内容）。

如果您在谈论文件格式，那么在下一部分的响应中将涵盖...

> 它是基于 XML 的，所以它和 ANT 一样难以阅读。

首先，我不明白你怎么能抱怨某件事的某些方面“不比蚂蚁好”，以此作为它有坏名声的理由。其次，虽然它仍然是 XML，但 XML 的格式*更加*明确。此外，由于它是这样定义的，因此为 POM 制作一个明智的胖客户端编辑器要容易得多。我已经看到页面很长的 ant 构建脚本会到处乱跳。任何 ant 构建脚本编辑器都不会让它变得更可口，只是以稍微不同的方式呈现的又一长串相互关联的任务。

话虽如此，我在这里看到的一些投诉有或有一些有效性，最大的是

*   文档很差/缺失
*   可重现的构建
*   Eclipse 集成不好
*   错误

我的回应是双重的。首先，Maven 是一个比 Ant 或 Make 更年轻的工具，因此您必须预期它需要时间才能达到这些应用程序的成熟度。其次，如果你不喜欢它，那就*修好它*。它是一个开源项目，使用它然后抱怨任何人都可以解决的问题对我来说似乎相当愚蠢。不喜欢文档？为它做出贡献，使其更清晰、更完整或更易于初学者使用。

可重现构建问题分为两个问题，版本范围和自动 maven 插件更新。对于插件更新，除非您确定一年后重建项目时使用完全相同的 JDK 和完全相同的 Ant 版本，否则这只是名称不同的相同问题。对于版本范围，我建议开发一个插件，该插件将为所有直接和传递依赖项生成一个带有锁定版本的临时 pom，并使其成为 maven 发布生命周期的一部分。这样，您的发布构建 pom 始终是所有依赖项的准确描述。

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-08-12T08:22:49.807

它应得的声誉。并非每个人都需要 Maven 开发人员认为适合每个项目的刚性结构。它是如此的不灵活。对许多人来说，依赖管理是“专业”，恕我直言，它最大的“骗局”。我对 maven 从网络下载 jars 并因不兼容而失眠（是的，离线模式存在，但是我为什么要拥有所有这些数百个 xml 文件和校验和）绝对不舒服。我决定使用哪些库，许多项目对依赖于网络连接的构建有严重的担忧。

更糟糕的是，当事情不起作用时，你完全迷失了。文档很烂，社区一无所知。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2009-06-03T07:27:19.820

*一年后我想更新这个：我不再对 Maven 社区有这种看法。如果今天问这个问题，我不会写这个答案。我将添加我当前的意见作为单独的答案。*

* * *

这是一个非常主观的答案，但问题是关于意见，所以......

我喜欢 Maven，我越了解它就越喜欢它。然而，影响我感受的一件事是：maven 社区主要以 Sonatype（“maven 公司”，许多 Maven 大佬工作的地方）为中心，Sonatype 正在社区中非常积极地推动其企业产品。

一个例子：“Maven Book”推特流链接到一个假定[的存储库管理介绍](http://twitter.com/mavenbook/status/1446309767)。

抱歉，“介绍”是 Nexus 的一半信息、一半推销。小测验：除了 Nexus 和 Nexus Pro 之外，还有*其他的 repo 管理器吗？*另外，这与所谓的开源 Maven Book 有什么关系？哦，对了，关于存储库管理的章节已经分拆成一本单独的书……关于 Nexus。嗯。如果我为 Maven 书做出贡献，如果我导致 Nexus 销售额增加，我会获得推荐费吗？

想象一下，如果您正在参加一个 Java 开发论坛，并且很明显，讨论 Java 的 Sun 员工将抓住一切可能的机会谈论 NetBeans 和“NetBeans Pro”。一段时间后，它失去了一些社区感觉。我在 Ant 上从未有过这样的经历。

说了这么多，我确实认为 Maven 是一个非常有趣和有用的系统（我不是像 Ant 那样称它为工具，Maven 比这更广泛）用于软件开发配置和构建管理。依赖管理有时是福也是祸，但它令人耳目一新——当然这不是 Maven 提供的唯一优势。我可能对 Sonatype 先令的反应有点太强烈了，但在我看来，它通过关联伤害了 Maven。我不知道这个观点是否被其他人分享。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2009-05-14T03:24:40.063

我认为 Maven 名声不好，因为它在你的项目中强加了结构，而其他工具，如 Ant，允许你以任何你希望的方式完全定义结构。也同意文档不好，但我认为 Maven 得到的坏名声主要是因为人们已经习惯了 Ant。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2009-05-14T20:16:47.663

太魔幻了。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2010-01-09T22:06:22.443

因为不满意的人会抱怨，而满意的人不会说他们满意。我的观点是，满意的 maven 用户比不满意的用户要多得多，但后者制造的噪音更大。实际上，这也是现实生活中的常见模式（ISP、电话运营商、传输等）。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2010-04-29T02:35:51.183

我喜欢马文。我从 pre 1.0 开始使用它。这是一个强大的工具，总的来说为我节省了大量时间，并改进了我的开发基础设施。但我能理解一些人的沮丧。我看到了 3 种挫败感：

1.  原因是真正的问题（例如冗长的 POM、缺乏文档），
2.  有些是错误信息（例如“你必须有一个互联网连接才能建立” - 不是真的 - 不要，这可以避免），
3.  其中一些是在 maven 发泄的，但实际上其他人是有罪的（“不要射击信使”）。

对于第一种情况，真正的问题——嗯，当然，有问题，POM 很冗长，文档可能会更好。然而尽管如此，使用 maven 可以在短时间内获得良好的结果。每次我得到一个用 ant 构建的项目时，我都会畏缩，并尝试将其导入我的 IDE。设置目录结构可能需要很长时间。使用maven，这只是在IDE中打开POM文件的情况。

对于第二种情况，Maven 比较复杂，误会是家常便饭。如果 maven 3 可以找到一种方法来解决这种复杂性（甚至是感知的复杂性），那就太好了。maven 确实需要大量投资，但根据我的经验，投资很快就会收回成本。

最后一点，我认为对 maven 的传递依赖的抱怨可能是最著名的例子。

传递依赖是使用重用的真实软件的本质。Windows DLLs、Debian 包、java 包、OSGi 包，甚至 C++ 头文件都包含依赖关系并遭受依赖关系问题。如果您有两个依赖项，并且每个依赖项都使用同一事物的不同版本，那么您必须尝试以某种方式解决该问题。Maven 并没有试图解决依赖问题，而是把它带到了最前沿，并提供了工具来帮助管理问题，例如通过报告冲突和为项目层次结构提供一致的依赖关系，实际上提供了对项目的绝对控制一个项目的依赖。

在每个项目中手动包含依赖项的方法（一位发帖人说他将所有依赖项检查到源代码控制中）存在使用错误依赖项的风险，例如在更新库时忽略更新而不检查其依赖项的更新。对于任何规模的项目，手动管理依赖项肯定会导致错误。使用 maven，您可以更新您使用的库版本并包含正确的依赖项。对于变更管理，您可以将旧的依赖集（对于整个项目）与新的依赖集进行比较，并且可以仔细检查、测试任何更改等。

Maven 不是导致依赖问题的原因，而是让它更加明显。在解决依赖问题时，maven 使任何依赖“调整”显式（对 POM 的更改覆盖依赖），而不是隐式的，就像版本控制中手动管理的 jar 的情况一样，其中 jar 只是存在，没有什么可做的支持天气它们是否是正确的依赖关系。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-06-03T07:37:15.383

对我来说最重要的一个问题是 Maven，如果配置不正确，可能不会产生可重复的构建，原因是：

*   不可靠的远程存储库；
*   依赖于具有 SNAPSHOT 版本或无版本的插件和库。

将此与 ant 构建进行对比，尽管 IMO 冗长且令人厌烦，但由于所有 jar 都在本地签入，因此可以正常工作。

好的部分是问题是可以解决的：

*   使用您自己的 maven 存储库，这变得非常简单，我正在使用[Archiva](http://archiva.apache.org/)，效果很好；
*   始终正确地对您的依赖项进行版本控制。Maven 已经开始在 super-POM 中锁定插件版本，从 2.0.8 或 2.0.9 开始，您的所有依赖项都应该在已发布的版本上。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-06-24T15:19:45.607

好主意 - 执行不力。

我最近将一个项目从 Ant 转移到 Maven。最后它运行良好，但我不得不在同一个 pom 中使用两个不同版本的 maven-assembly-plugin 和 maven-jar-plugin（有两个配置文件），因为在一个版本中工作的内容在另一个版本中被破坏了。

所以很头疼。文档并不总是很好，但我必须承认用谷歌搜索答案相对容易。

确保您始终指定您使用的插件版本。不要指望新版本会向后兼容。

我认为争议来自于 maven 仍在不断发展的事实，而且这个过程有时是痛苦的。

问候

五。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2010-01-22T19:38:17.867

我对 Maven 的一些不满：

*   XML 定义非常笨拙和冗长。他们没听说过属性吗？

*   在其默认配置中，它总是在每次操作中搜索“网络”。不管这是否对任何事情有用，为了“清洁”而需要互联网访问看起来非常愚蠢。

*   同样在默认情况下，如果我不小心指定确切的版本号，它将从网络中提取最新的更新，而不管这些最新版本是否引入了依赖错误。换句话说，你被其他人的依赖管理摆布了。

*   `-o`所有这些网络访问的解决方案是通过添加选项将其关闭。但是如果你真的想要进行依赖更新，你必须记得关闭它！

*   另一种解决方案是为依赖项安装您自己的“源代码控制”服务器。惊喜：大多数项目已经有了源代码控制，只有在没有额外设置的情况下才能工作！

*   Maven 构建速度非常慢。摆弄网络更新可以缓解这种情况，但 Maven 构建仍然很慢。而且非常冗长。

*   Maven 插件 (M2Eclipse) 与 Eclipse 的集成最差。Eclipse 与版本控制软件和 Ant 的集成相当顺利。相比之下，Maven 集成非常笨拙和丑陋。我提到慢了吗？

*   Maven 仍然有问题。错误消息没有帮助。太多的开发人员正在遭受这种痛苦。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2010-08-25T16:59:55.307

我相信 Maven 的名声不好，因为大多数批评者没有观察到 Maven + [Hudson](http://hudson-ci.org/) + [Sonar](http://www.sonarsource.org/)的组合。如果他们有，他们会问“我该如何开始”？

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2009-05-14T06:50:31.177

好问题。我刚刚开始了一个大型项目，之前的部分项目是将模块化引入我们的代码库。

我听说过有关 maven 的坏事。事实上，这就是我所听说过的一切。我考虑引入它来解决我们目前正在经历的依赖噩梦。我在 Maven 中看到的问题是它的结构非常僵化，即你需要符合它的项目布局才能让它为你工作。

我知道大多数人会说什么——你不必遵守结构。确实是这样，但直到你超过最初的学习曲线时你才会知道这一点，此时你已经投入了太多时间去把它全部扔掉。

Ant 这些天被大量使用，我喜欢它。考虑到这一点，我偶然发现了一个鲜为人知的依赖管理器，叫做[Apache Ivy](http://ant.apache.org/ivy)。**Ivy很好地**集成到 Ant中，并且可以快速轻松地获得基本的 JAR 检索设置和工作。Ivy 的另一个好处是它非常强大而且非常透明。您可以很容易地使用 scp 或 ssh 等机制传输构建；对文件系统或远程存储库的“链”依赖项检索（Maven 存储库兼容性是其流行的功能之一）。

总而言之，我发现最终使用它非常令人沮丧 - 文档很多，但它是用糟糕的英语编写的，这可能会在调试或试图找出问题所在时增加挫败感。

我将在这个项目的某个时候重新访问 Apache Ivy，我希望它能够正常工作。它所做的一件事是让我们作为一个团队来计算出我们所依赖的库并获得一个文档化的列表。

归根结底，我认为这一切都取决于*您*作为个人/团队的工作方式以及*解决*依赖性问题所需的内容。

您可能会发现以下与 Ivy 相关的资源很有用：

*   [Apache Ivy 与 Maven 2 比较](http://ant.apache.org/ivy/m2comparison.html)
*   [阿帕奇常春藤常见问题解答](http://ant.apache.org/ivy/faq.html)
*   [Apache Ivy 功能​​列表](http://ant.apache.org/ivy/features.html)

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2010-01-09T21:28:31.027

人们不喜欢 Maven 的原因有很多，但面对现实，他们是**非常主观**的。今天的 Maven 有一些好的（和免费的）书籍、更好的文档、更大的插件集和许多参考成功的项目构建，这与一两年前的 Maven 不同。

在简单的项目中使用 Maven 非常容易，对于更大/复杂的项目，需要更多的知识和对 Maven 哲学的更深入的理解——也许在公司级别，一个像网络管理员这样的 Maven 大师的职位。Maven 讨厌陈述的主要来源往往是**无知**。

Maven 的另一个小问题是缺乏灵活性，例如在 Ant 中。但是请记住，Maven 有一套约定——一开始坚持它们似乎很困难，但最终往往会避免出现问题。

Maven 目前的成功证明了它的价值。当然，没有人是完美的，Maven 也有一些缺点和怪癖，但在我看来，Maven 慢慢地动摇了他的对手。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2009-05-14T08:08:56.087

我喜欢 Maven——它提高了生产力，我很高兴我不再使用 Ant（呸！）

但如果我可以改变一些事情，那就是：

1.  使`pom.xml`文件不那么冗长
2.  更容易包含不在存储库中的 .jars。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2009-05-14T03:22:26.417

我不会说它有一个糟糕的代表，因为它有一个混合的代表。如果您的项目遵循 Maven 倡导的“约定优于配置”范式，那么您可以从中获得很多优势。如果您的项目不能很好地融入 Maven 的世界观，那么它可能会成为一种负担。

为此，如果您对项目有控制权，那么 Maven 可能是要走的路。但如果你不这样做，并且布局是由不是 Maven 粉丝的人决定的，那么它可能会比它的价值更麻烦。最快乐的 Maven 项目可能是那些以 Maven 项目开始的项目。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2010-02-19T19:24:14.433

如果您打算将您的业务或工作押在开发项目上，您希望控制基础——即构建系统。使用 Maven，您无法控制。它是声明性的和不透明的。maven-framework 开发人员不知道如何构建透明或直观的系统，这从日志输出和文档中可以清楚地看出。

依赖管理非常诱人，因为它可能会在项目开始时让你有一段时间，但要注意，它从根本上被破坏了，最终会给你带来很多麻烦。当两个依赖项具有不兼容的临时依赖项时，您将被复杂的老鼠巢所阻止，这将破坏整个团队的构建并阻止开发数天。由于本地存储库的状态不一致，使用 Maven 的构建过程对于团队中的不同开发人员来说也是出了名的不一致。根据开发人员创建环境的时间或他们正在从事的其他项目，他们将产生不同的结果。您会发现您正在删除整个本地存储库并且让 Maven 重新下载 jar 的频率远远高于第一次为 dev 分支设置的频率。我相信 OSGI 是一个试图解决这个基本问题的倡议。我想说，如果某件事需要如此复杂，那么基本前提是错误的。

我已经成为 maven 用户/受害者超过 5 年了，我不得不说它会节省你更多的时间来检查你的依赖项到你的源存储库并编写漂亮而简单的 ant 任务。使用 ant，您可以确切地知道您的构建系统在做什么。

由于 Maven 问题，我在几家不同的公司经历了很多很多人的工作时间。

我最近试图让一个旧的 GWT/Maven/Eclipse 项目恢复生机，在我所有的业余时间之后的 2 周后，我仍然无法让它始终如一地构建。是时候减少我的损失并使用我认为的 ant / eclipse 进行开发了......

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2009-09-08T04:24:14.603

对我来说，在内部项目中使用 maven vs ant 有很多优点和缺点。然而，对于开源项目，我认为 Maven 在使许多项目更容易构建方面产生了巨大的影响。不久前，编译一个平均的 OSS Java（基于 ant）项目需要几个小时，必须设置大量变量，下载依赖项目等。

你可以用 Maven 做任何你可以用 Ant 做的事情，但是在 Ant 不鼓励任何标准的地方，Maven 强烈建议你遵循它的结构，否则它会做更多的工作。诚然，有些事情用 Maven 设置起来很痛苦，而用 Ant 很容易做到，但最终结果几乎总是从那些只想检查项目并开始的人的角度来看更容易构建的东西。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2011-08-23T05:04:46.200

它比您用于编写项目的语言更复杂。正确配置它比实际编程更难。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2010-05-11T17:35:52.987

简短的回答：我发现维护一个 Maven 构建系统非常困难，我想尽快切换到 Gradle。

我已经与 Maven 合作了四年多。我会称自己为构建系统专家，因为在最近（至少）五家公司中，我对构建/部署基础设施进行了重大改造。

我学到的一些教训：

*   大多数开发人员往往不会花很多时间考虑构建系统。结果，构建变成了一堆乱七八糟的黑客，但当这些混乱被清理和合理化时，他们确实很感激。
*   在处理复杂性时，我宁愿有一个透明的系统来暴露复杂性（如 Ant），而不是像 Maven 那样试图通过施加严格的限制来使复杂的事情变得简单。想想 Linux 与 Windows。
*   Maven 在功能上有很多漏洞，需要拜占庭式的变通方法。这会导致 POM 文件难以理解且无法维护。
*   Ant 非常灵活且易于理解，但 Ant 文件也可以变得非常大，因为它太低级了。
*   对于任何重要的项目，开发人员必须创建自己的构建/部署结构，超出工具提供的范围；结构对项目的适用性与维护的难易程度有很大关系。最好的工具将支持您创建结构，而不是与您对抗。

我对 Gradle 进行了一些研究，看起来它有可能成为两全其美的，允许混合使用声明性和程序性构建描述。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2012-02-26T14:50:15.950

我一直在努力克服这里提到的大部分/所有负面因素，以及队友的类似反对意见，并同意他们的看法。但我已经坚持了下来，并将继续坚持只有 maven（或 gradle）才能真正实现的一个目标。

如果您正在为同行（开源*开发人员*）进行优化，ant/make/whatever 会做。如果您向非同行（*用户*）提供功能，则只有 maven/gradle/etc 可以。

只有 maven 允许您发布一小部分源代码 + poms（没有嵌入的 lib/binary 依赖 jar 具有神秘的名称和没有依赖信息），具有良好记录的标准项目布局，可以由任何 IDE 加载由尚未吸收的人开发人员的特殊布局约定。还有一个一键式安装程序 (mvn install) 可以在获取任何缺少的依赖项的同时构建所有内容。

结果是用户可以通过一个简单的入口找到进入代码的途径，在那里 pom 可以将他们指向相关文档。

除了那个（必不可少的）要求之外，我和其他人一样不喜欢 maven。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2009-05-14T06:58:42.700

我认为声誉不佳的一个主要原因是 maven2 作为一次性解决方案解决了几个复杂的问题（构建自动化、依赖项、管理存储库）。因此，在开始使用 maven 时，您必须面对这些棘手的问题。所以这是一种“杀信使”的效果。

其他方法（例如 ant+ivy）通常不会让您有机会将遇到的所有问题归咎于一个工具。更像是“好吧蚂蚁不太容易上手，ivy 有一些问题。但至少我们不必与 maven 搏斗！” 说一个人没有认识到所有这些问题加在一起与您在使用 maven 时遇到的问题没有太大区别。一次处理一个可能会更容易一些。顺便说一句，在过去的几个月里，我建立了一个基于 ant+ivy 的构建系统。我真的很高兴我不必使用 maven2 ;-)

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2009-05-14T23:40:36.443

我会区分 Maven 1 和 2：前者有（当之无愧的）坏名声；后者是一种改进和不断提高的“标准”。

我个人认为 Maven 2 比我喜欢的更复杂和死板。一个男人的标准是另一个男人的直筒夹克。我同意上面“太多魔法”的评论。当我将 Ant 的简单性与 Maven 2 的复杂性进行比较时，我知道我更喜欢哪一个。

我承认我对 Ant 的了解要好得多。我正在摸索 Maven 2，但我还没有走到那一步。与 Maven 2 的真正价值相比，我的糟糕意见可能更多地说明了我和我的知识状况。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2012-05-04T17:37:48.250

任何 Java 开发人员都可以轻松成为专家级 ANT 用户，但即使是专家级 Java 开发人员也无法成为初学者级别的 MAVEN 用户。

Maven 将使您的开发人员不再害怕做任何与构建和部署相关的事情。

他们将开始尊重 Maven 而不是 War 文件或 Ear 文件！这是坏坏坏！

然后你将被在线论坛摆布，粉丝们会责备你没有按照“Maven 方式”做事。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2009-05-14T06:55:10.743

Maven 是一个软件管理工具，可以提高您的工作效率。我相信这样的工具对于新时代的软件开发是必不可少的。

但是，Maven 并不适用于所有代码库。如果您需要支持大型遗留代码页，或者您从第三方导入代码，那么最好避免使用。Maven 期望事情以某种方式（约定优于配置）。如果您正在开始一个新项目，那么这非常好。但是，如果您有一个需要支持的完整系统，那么缺乏灵活性就是一场噩梦。

人们通常抱怨 maven 的另一个原因是陡峭的学习曲线。另外IDE集成还不是很成熟。[Apache](http://maven.apache.org/eclipse-plugin.html)为 Eclipse 提供了两个插件。一个是“成熟的”，另一个提供了一种新的方法。我想如果第一个足够的话，就不需要新的了。

另一个对 Maven 更严重的抱怨是使用 XML 来完成编程工作。也许像[Buildr](http://buildr.apache.org/)这样的工具是要走的路。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2010-01-22T19:47:09.973

Maven 名声不佳的最大原因是 IDE 集成。是的，我知道 m2eclipse。我喜欢 m2eclipse。我更喜欢 Netbeans 的集成。

这就是问题所在。一些较大的商店构建了一些工具来强制 Maven 使用 RAD 7.0 之类的东西。效果不好。这些 hackarounds 的存在是为了让 Maven 在不允许更改的工具中运行 (RAD 7.0)。在我的情况下，hackarounded maven 构建只在 Netbeans 中工作。带有 m2eclipse 的 Eclipse 3.5 扼杀了一些可怕的东西。

这里的大多数开发人员都讨厌 Maven。他们不讨厌 Maven。他们从未*真正*使用过 Maven。

这令人失望，但这并不是 Maven 的错。Maven 在另一种生活中对我来说工作得很好。在这里，由于 IDE 和旨在使其可用的工具未能做到这一点，它使人衰弱。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2010-01-22T20:00:50.753

好吧，我对 Maven 了解不多，无法详细介绍，但我试图让它工作的次数比我承认的要多。
对我来说，使用 Maven 非常简单：
你需要“雇佣”一个特殊的 Maven 大师，而你不是为 ant 工作的；否则请您的开发人员花时间学习如何“构建”他们的工作，而不是学习如何“完成”他们的工作
。如果您想真正理解它，您需要“购买”“他们”出售的书。

然后：.
它基本上只解决了一个真正的问题“依赖关系”我想知道有多少项目依赖于如此多的其他项目，他们需要一个特殊的工具来解决它们的依赖关系？而ANT做不到？
. 我个人不会盲目地升级到较新版本的开源框架，而不需要这样做。如果它正在工作，那么不要修复它，对吗？

但那这是主观的对吗？

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2011-12-05T15:16:13.477

我的看法是，基于约定优于配置的缺陷：

[http://chriswongdevblog.blogspot.com/2011/01/trouble-with-being-conventional.html](http://chriswongdevblog.blogspot.com/2011/01/trouble-with-being-conventional.html)

我对 Maven 的问题是发现的困难和无限的复杂性。那，看着同事浪费半个工作日来解决 Maven 构建问题。此外，恕我直言，Maven 与 Eclipse 的集成使事情变得更糟，因为您已经成倍地增加了出错的地方的数量。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2012-04-24T17:16:06.797

我的回答：大多数用户抱怨 maven 是因为他们正在寻找它的优点，但是没有时间（或者他们不想忍受）来建立他们的“公司环境”。这是个人选择，取决于个人的耐心、工作环境（老板永远不明白一件做得好的事情比永恒的错误修复周期浪费的时间更少）等等。

但是，在以下情况下，您只能在工作站上安装 maven 而不会生气：

1.  一个带有一些 bean 的简单库。
2.  一场简单的“一体式”战争。
3.  甚至是一个多模块项目，它具有“标准”依赖项（spring、hibernate、apache 以及您可以在中央存储库中找到的任何内容）**，但对您的库没有任何依赖项**。

当您想要更多时，问题开始出现，例如为标准框架类创建包装器，或可重用组件库，您总是想使用一组您喜欢的插件等。

在这种情况下**，您必须花时间学习**：我在以前的帖子中读到有人谈论浪费半天或 2 天......这根本不够：我们正在谈论至少持续修改您的 pom 1月。

如果你想在复杂的项目中使用 maven，你应该按顺序：

1.  拥有您的内部存储库：这不是一个选项，它是强制性的。我尝试过 Artifactory 和 Nexus，它们一开始可能会造成麻烦，但是一旦设置它们，就会忘记它们。
2.  创建一个“主 pom”，其中包含您需要的所有插件（指定了相对版本），但**如果您不想遇到麻烦，则必须避免将标准依赖项放在那里**（为此，请参阅 dependenciesManagement 中的 scope=import ） . 这是最难的部分，但你可以开始复制一个著名项目（spring、tapestry、ecc...）的主 pom 并去掉你不需要的东西。
3.  如果您有一个复杂的项目，**您必须在开始创建工件之前考虑您想要什么**。例如，在一个具有 (war + WebServices Client) + (Webservice Server + spring + hibernate + Jbpm + whateverelse....) 的项目中，创建一个客户端都引用的“api”模块是个好主意和服务器，但它只包含模型+接口，并且不会在客户端带来“服务器端”依赖关系，反之亦然。**失败了，maven 将成为人间地狱**。
4.  如果您使用 Eclipse，m2e 插件是必不可少的：好的，它可能很慢，有时您应该刷新项目并更新项目配置等......但是找到已经设置的“项目构建路径”是值得的。在最坏的情况下，命令行将始终有效。
5.  虽然持续集成服务器是可选的，但强烈建议至少将它用于您的公共库。将 Web 应用程序放在 CI 上可能太多（您不会在多个项目中重用 Web 应用程序），但是将您的标准基类、“始终使用”的实体 bean 等放在 CI 上是无价的。请记住，这些组件不仅由您使用，而且当您忙于代码的其他部分时，甚至您的团队成员也可以使用它们，并且您可能忘记（我经常这样做）在公司存储库中手动部署以制作它们可供团队成员使用。

完成所有这些设置......好吧，您甚至可以在开始时花费几个月的时间，但是一旦您习惯了，您将大大加快您的开发速度。

就我个人而言，我还没有使用 Gradle，我不知道它是否比 Maven 更好或最差。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2010-01-22T19:09:41.483

Maven 捍卫者常说“好吧，你就是不明白”。他们认为，这是一个真正敏捷的反驳。

它是这样的：

超级程序员：“嘿，我需要把这扇门打开，有人有门挡吗？” Maven 程序员：“为什么是的，这里有一个”（给他看一组复杂的冰棒棍） 超级程序员：“这些棍子没有握住门开了！” Maven Programmer（得意，轻笑）：“你就是没看懂。我建议你看说明书，真的学一年左右！！！”

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2010-08-10T02:55:00.540

Maven 不尊重[KISS](http://en.wikipedia.org/wiki/KISS_principle)原则。尝试做除了 mvn clean install 之外的任何事情，你就有麻烦了。有了 ant，你可以做任何你想做的事，没有任何痛苦。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2010-12-08T15:08:26.963

Maven确实解决了工作问题，它构建了java软件，并且易于依赖管理。但它与 Ant、GNU Make 或其他类 Unix 包管理系统有很大不同。这使得新人必须付出很多才能学习它。

有很多 Maven 文档，但其中一些***将***您推开，例如“使用 m2eclipse”：

> *只需在查询字段中输入 groupId，m2eclipse 即可查询存储库索引，甚至显示当前在我的本地 Maven 存储库中的工件版本。首选此选项，因为它可以节省大量时间。*

我真的很讨厌找出一个很长的句子，却发现它什么也没说。我记得在阅读 python 官方教程和 erlang 的时候感觉有多好。好的文档将表明作者有良好的感觉。

Maven 对新手来说似乎很陌生，它的命令行风格不同于 Unix 命令行传统。如果您花时间阅读“maven by examples”或“The Definitive Guide”，它会得到回报，您可以在[http://www.sonatype.com/](http://www.sonatype.com/)上找到它。但是，即使您阅读了所有这些文档，并且可以放心使用该工具，您也可能会时不时地遇到麻烦，其中一些是由软件错误引起的。专家会找到与之共存并保持生产力的方法。

毕竟，Maven 是开源软件，它为自由工程师贡献知识。这使它受到尊重。当人们更多地谈论它的**坏名声**时，它为开源世界做得**很好。**

所以，作为熟练的人如何使用任何工具，只要使用它，不要依赖它，**取决于你自己**。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-05-14T05:27:10.657

我们在所有项目中都使用 maven2，它加快了十倍的开发速度（结合了一个不错的持续集成平台）。

过去，maven2唯一让我们头疼的特性就是传递依赖机制。在乌托邦世界中，这将是所有依赖问题的最终解决方案，但在实践中，它往往会将你直接送入依赖地狱。

我们的主要问题来自这样一个事实，即默认 maven2 存储库中的各种组件依赖于同一库的不同版本（即 component1 和 component2 都需要日志框架，但 component1 需要 v1，而 component2 需要 v2）。

为了解决这个问题，我们只需拥有自己的本地存储库，其中包含我们需要的所有库。这使我们能够确保我们使用的所有具有自己依赖关系的库都依赖于其他库的相同版本。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-06-03T09:52:08.840

已经提到的“全有或全无”方法是我通常改用 Ant 的原因......更多情况下，您会从事“遗留”项目，该项目已经具有您无法更改的已定义结构只是因为Maven想要别的东西。

另一方面，无论项目杂乱无章，Ant 都可以随时使用。

关于替代方案，我读过关于 rake 的好东西。

（顺便说一句，我说的是 Maven 1，还没有研究 Maven 2）

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2012-07-01T11:36:24.807

# 马文很酷。

* * *

不要再听其他选择了，因为现在没有任何选择——不仅仅是玩具。

除了微软的开发工具链——它是金钱买不到的最好的技术。

所有这些试图推动“*工具链du jour* ”的团体——这只是播下混乱和抢占市场份额的廉价尝试。

* * *

## 讨厌的人会讨厌。

*   SBT

地球历史上最大的误称。您的 Build 能否通过图灵测试？他妈的荒谬，10 年前的时间倒退了一步，这是荒谬的 DSL。使用 IVY 依赖管理，Maven 的中间兄弟。

*   蚂蚁

非常适合您从 Shockwave 开发毕业后的第一个项目。

您了解 XML，并且很热情，但并不真正了解构建阶段，6 个月后重新启动项目，为什么版本控制二进制工件是一种虚假的灵丹妙药，或者有一天别人会尝试使用您的项目。

*   制作

如果全世界都在同一个 UNIX 终端上运行，并且说一口流利的 Bash，那么是的。但是为什么不直接成为 C/C++ 程序员呢，反正它比 Java 有趣多了。

*   红宝石（各种）

任何。利基，慢。那就开发 Ruby，远离 Java 开发。

*   Python

人们在不信任 Python 的地方使用 Java（任何涉及金钱的地方）。如果您的系统无论如何都在运行 Python，那么您甚至不会阅读这篇文章，除非您当然想要 Java 的钱——但是却被困在某个网上商店开发 Python。

*   Clojure（各种）

为了纪念 Stallman，我将学习 Lisp——但对于 Emacs，我不会在我的 VM 上运行它。我觉得它降低了体验。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2010-06-10T10:29:24.537

Maven 不容易支持非标准操作。有用插件的数量虽然在不断增长。Maven 和 Ant 都不容易/本质上支持 Make 的文件依赖概念。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2012-06-27T10:30:20.573

很简单，Maven 想要拥有世界。它想要定义项目，它们在文件系统上的布局方式，jar 在其可爱的本地缓存中的位置，如何获取内容，依赖关系图，构建插件，ide 插件等等等等。

有些人喜欢这种东西，佩服它。对我来说，一切都与质量有关，我不太关心你的嘘声理论。只需执行，完美地完成它，然后最好淡入背景，直到我决定再次惹你生气。

我给 Sonatype 和 Maven 追随者/辩护者的信息是，你还没有表现出质量。pom.xml 格式过于冗长、学术和乏味 - 修复它。使用 Maven 设置复杂的多项目构建令人抓狂——为什么这么难？微调何时获取以及何时不获取未指定的 jar 将是一件有趣的事情 - 直到我们明白这一点，只要我们可以/认为我们想要获取的 maven 策略是令人抓狂的。SNAPSHOT 总是大写，因为它在对我尖叫/大笑，让我发疯？粗鲁的开源 maven 插件插入 poms 的细节和愚蠢/独特的方式令人抓狂。没有好办法解决的类路径问题？哦，是的，遗留的 apache commons-* groupId 污染了我的存储库根，这令人抓狂，“奶酪三角形不会那样走！！”——有点愤怒。

Maven 曾经让我对一个客户感到尴尬 - 一个工具如此妨碍我的工作效率是不可原谅的！我希望我的工具（及其制造者）表现得像他们卑微的仆人。当我问 Maven 谁是国王时，我希望答案是“DAVE”，然后是寒暄和鞠躬和低头！:)

惯性是 Maven 的真实故事。如果您想使用开源 java，您几乎可以从 Maven 存储库中提取。所以，如果你想在那里玩得很好，你最好能够以 Maven 方式获取依赖项并学习阅读 pom...感谢 Ivy 和 IvyDE，我可以在 Ant 和 Eclipse 中设置我的 maven 依赖项不要拘泥于 Maven 工具链。

我使用过的 Maven 存储库服务器软件，例如 Nexus 和 Artifactory，都是简洁的、未来主义的工具。与 Maven 生态系统的其他部分相比，它们是闪闪发光的宝石。

我的 Maven 体验就像 Eclipse 当年的感觉。Eclipse 也想用他们愚蠢的想法来拥有这个世界，而且在我真正让 Eclipse 拥有我的世界之前，这个平台需要很长时间才能成熟，年复一年。也许在年复一年 Maven 可以达到这样的质量水平？在这一点上，我说“我的眼睛再也不会目睹恐怖了”，但当 Eclipse 1.0 发布时，我也是这么说的。:)

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2012-10-05T23:04:44.013

优点：

当您需要快速启动和运行并且依赖项管理良好时，Maven 非常棒。避免 jar-hell 的设施也不错。Maven 背后的一些基本理论是合理的。默认的生命周期阶段经过深思熟虑，对于任何想要学习构建工程最佳实践的人都非常有指导意义。尽管文档很差，但可发现性非常好，请尝试 mvn help:help -Ddetail=true 以了解我的意思。如果您知道如何阅读 xsd 文档，那么构建 pom 并不难。

缺点（魔鬼在细节中）：

无法指定绑定到同一阶段的不同插件执行的顺序，并且计算机编程中任何形式的非确定性都是非常糟糕的。

与 Ant 属性值不同，即 ${my.property}，Maven 属性是在构建开始时解析的，如果您知道开始时的值是什么就可以了，但是如果属性的值是在中间的某个位置确定的在您的构建中访问它为时已晚，它在分配之前已经被解释，因此该值将为 null 或空字符串。甚至当需要该属性的执行在分配该属性的执行之后的一个阶段中执行时，情况也是如此-> 在这个上扯掉我的头发。

如果你坚持“Maven 方式”，一切都会顺利进行。一旦你的构建偏离了“Maven 方式”，所有的地狱都会崩溃 -> 期望非常擅长为你的项目编写定制的 Maven 插件和原型，因为从头开始这样做比绕过 Maven 的约束更有效。

当使用聚合（Maven-speak 中的模块）和继承（Maven-speak 中的父级）处理具有许多 pom 文件的大型项目时，在执行相同或类似操作的构建之间存在太多重复。Maven xml 语法没有提供明确的方法来区分将从父级继承的成员和不会继承的成员。预计`mvn help:effective-pom`每两分钟运行一次以解决这个问题。

具有许多插件配置的复杂构建变得臃肿且难以理解。这是 xml 的问题，而不是 Maven 本身的问题。有更清晰和更具表现力的方式来编写构建 -> 例如使用支持元编程的动态语言（即 Gradle、Buildr）的内部 DSL

简介：能力越大，责任越大。将属于各自部署环境的配置粘贴到构建本身中太容易了，这违反了“一个二进制”原则。配置文件应该设计为强调“角色”而不是环境，即）从 CI 部署到登台的行为，而不是保持登台本身的配置。

* * *

## 回答 #48

> 赞同：-1
> 
> 时间：2010-05-06T16:14:20.187

好吧，我现在已经在 Maven 上浪费了 2 天时间。使用 m2eclipse，我发现存储库中缺少 eclipse 中报告的依赖项，就像那样。当我尝试 IAM 并想为 struts 2 生成一个简单的空白项目时，我发现 v2.0.9 也已从存储库中删除。当我最终手动添加工件和东西时，项目创建了自己，只是发现无论我要求 IAM 做什么，它都会响应：没有找到 maven 2 项目.....嘿，我不是只使用了 Maven 2项目向导？？？从第一天开始，Maven 就让我很头疼。它背后的想法非常好。然而，实际上，它缺乏所有相关方的纪律。这使得它几乎一文不值。因为今天您的项目可能会构建。明天，当一些笨蛋从一些回购中删除一些 pom 时，你就完蛋了。就如此容易。它不适用于专业的企业发展！一点也不。也许在一年或五年内？

# c# - 是否可以在没有 Visual Studio 的情况下安装 C# 编译器？

> ID：861384
> 
> 赞同：73
> 
> 时间：2009-05-14T03:14:04.033
> 
> 标签：c#, compiler-construction, msbuild, csc

我想从命令行构建项目。[是否可以在不安装Visual Studio](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio)的情况下部署 C# 编译器？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-14T03:19:16.987

当然，该框架包括一个编译器 csc.exe。查看[这篇文章](https://web.archive.org/web/20090426124057/http://www.tipsntracks.com/52/get-a-free-csharp-command-line-compiler.html)以获得快速的操作方法。重要部分：

> [您可以从 Microsoft 站点http://msdn2.microsoft.com/en-us/netframework/aa731542.aspx](http://msdn2.microsoft.com/en-us/netframework/aa731542.aspx)获取命令行编译器 (csc.exe) 。
> 
> 下载 .NET Framework 的可再发行包，其中包括编译器和支持 C# 2005 语法的 .NET Framework。
> 
> 编译器位于以下目录中：%windir%\Microsoft.NET\Framework\

另请查看[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms379563(VS.80).aspx)以获得完整的指南和解释。

请注意，对于更新的版本，您将寻找 MSBuild 独立包而不是框架 - 请参阅[@Vadzim 的答案](https://stackoverflow.com/a/47624225/44853)。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-05-14T03:29:52.827

当然。做：

```
sudo apt-get install mono-gmcs 
```

其他人都假设 Windows 和 MS .NET，但是...

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-05-14T03:16:57.350

是的，如果你有[.NET SDK](http://msdn.microsoft.com/en-us/vstudio/aa496123)，它就在那里。例如，

```
C:\WINDOWS\Microsoft.NET\Framework\v[your version number]\csc.exe 
```

`msbuild.exe`也应该在那里，您可以使用它来构建项目 ( `.csproj`) 文件。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-05-14T03:36:34.167

与其他一些回答者所说的相反，您不需要 SDK，只需要 .NET Framework 即可获得 C# 编译器，`csc.exe`.

此外，请考虑其他（免费）IDE，例如[MonoDevelop](http://en.wikipedia.org/wiki/MonoDevelop)、 # [develop](http://www.icsharpcode.net/opensource/sd/)和[Visual C# Express](https://en.wikipedia.org/wiki/Microsoft_Visual_Studio_Express#Visual_C.23_Express)。（您说您不需要 Visual Studio，并不是说您根本不需要 IDE；））

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-12-03T22:53:39.937

最新的[Microsoft .NET Framework 4.7](https://www.microsoft.com/en-us/download/details.aspx?id=55170)不再包含 C# 编译器。

但它可以作为独立[MSBuild](https://stackoverflow.com/questions/25506178/getting-msbuild-exe-without-installing-visual-studio)工具的一部分安装。

转到[https://www.visualstudio.com/downloads/](https://www.visualstudio.com/downloads/)，向下滚动到“其他工具和框架”，然后选择“为 Visual Studio 2017 构建工具”。

“Visual Studio Build Tools 2017”在线安装程序运行后，切换到“Individual components”选项卡并选中“C# and Visual Basic Roslyn compilers”。这也将检查 MSBuild 依赖关系。总共不到一百兆字节。

编译器安装在`C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\MSBuild\15.0\Bin\Roslyn\csc.exe`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T03:35:09.087

是的，甚至还有一个开源的[IDE SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)。您可以将编译器设置为[UltraEdit](http://en.wikipedia.org/wiki/UltraEdit)（或其他首选编辑器）等中的命令。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T03:18:18.550

可以，但您需要下载并安装[.NET Framework SDK](http://msdn.microsoft.com/en-us/netframework/aa569263.aspx)。

这是一个可以帮助您的[链接。](http://www.ondotnet.com/pub/a/dotnet/2002/02/11/hackdotnet.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T03:18:30.733

您只需要 .NET 框架。您可以使用[记事本](http://en.wikipedia.org/wiki/Notepad_%28software%29)进行编辑，使用 CSC.exe 进行编译。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-02T15:40:20.677

我只是在寻找这样的解决方案，以便我可以使用 C# 制作小型控制台应用程序。

Brian 提到了对我有用的方法，我所做的只是在创建文件后简单地执行以下操作：

```
C:\WINDOWS\Microsoft.NET\Framework\v[your version number]\csc.exe myfile.cs 
```

它会生成你的 .exe 文件，然后你可以使用它:)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-06-26T05:20:10.147

假设您安装了包含 C# 的 Visual Studio。另外，假设您想要最新版本。

1.  找到你的 VS 安装路径。称之为 VSPath。
2.  CSC 编译器将位于 VSPath\MSBuild(MSBuild-Version)\Bin\Roslyn

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-14T18:11:19.837

就像其他一些人提到的那样， [MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)是使用 .NET Framework（2.0 和 3.5 版）部署的，所以如果您安装了其中任何一个，您就可以构建您的应用程序，而无需在机器上安装 Visual Studio。

# http - 是否可以在 NSIS 中使用 http get 和 http post？

> ID：861388
> 
> 赞同：3
> 
> 时间：2009-05-14T03:16:06.370
> 
> 标签：http, post, get, nsis, auto-update

我有一个本地更新程序，可以使用 NSISdl 插件从 Web 服务器下载迷你安装程序。

假设我有一堆迷你安装程序版本。本地安装程序是否还有一种方法可以检查 Web 服务器上可用的“最新”迷你安装程序。我听说您可以通过 Web 服务（通过使用 http post 或 get）来做到这一点。但是 NSIS 也可以吗？如果有可能怎么办？

谢谢...非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T16:01:13.963

有很多方法可以做到这一点，一种方法是将最新版本存储在服务器上的文件中。

使用如下格式制作 .ini：

```
[latestver]
major=2
minor=3
build=3452 
```

然后只需使用 InetC 或 NSISdl 将其下载到 $pluginsdir（只需一个简单的 HTTP GET 到[http://yourserver.com/product/update.ini](http://yourserver.com/product/update.ini)或类似的东西）并使用内置的 INI 函数并比较版本

或者您可以通过 GET'ing 像[http://yourserver.com/versioncheck.php?product=foo&ver=1.2.333](http://yourserver.com/versioncheck.php?product=foo&ver=1.2.333)这样的 url 来编写整个服务器端的脚本并返回更新 url 或失败代码

# binary-tree - 二叉搜索树的平均高度

> ID：861393
> 
> 赞同：5
> 
> 时间：2009-05-14T03:17:33.450
> 
> 标签：binary-tree

添加 1000 个随机整数时，如何计算二叉搜索树的平均高度？平均身高是多少？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T10:30:03.063

这个问题让我问你是否可以在不实际生成树的情况下明确解决这个问题。

我设法编写了一个应用程序，如果您将 N 个唯一数字的所有可能排列添加到一个简单实现的二叉树中，它可以计算出平均高度的答案。

我得到的答案在这张图中。（X 轴是树中的项目数，蓝线是平均高度，红线是可能的最佳高度）

![平均高度到最小高度的图表](https://i.stack.imgur.com/oYtDJ.jpg)

```
N 平均高度
2 2
16 7.039
32 9.280
64 11.679
256 16.783
343 17.896

```

Granitebolshevik 是对的：如果没有额外的平衡功能，一个简单实现的树可能会成为最佳高度，但在统计上不太可能。

该算法的复杂度为 O(N^2)，计算速度不够快，无法计算出非常大的数字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T03:19:44.147

您可以使用以下递归定义计算二叉树的高度：

```
height(empty) = 0
height(tree) = 1 + max(height(tree.left), height(tree.right)) 
```

凭经验测量这种树的平均高度的一种方法是重复创建一棵空树并向其添加 1000 个随机项。使用上述功能测量每个试验的高度，并将它们平均。

我怀疑你的任务可能是找到一个二叉树平均高度的公式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T03:22:46.277

这取决于您是否使用任何类型的平衡树结构（例如红黑树）。由于您将随机数插入二叉树，因此可以合理地预期平均深度约为 log2(1000) - 因此值 10 和 11 将是“正常的”。我不确定它会偏离多远。不低于 10 层，可能更深一些。没有平衡的极端情况是 1000 深；随机数不太可能发生这种情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-25T06:31:18.610

这个问题似乎没有一个简单的答案，尽管有许多数字近似值，例如：

> Devroye，卢克。“关于二叉搜索树高度的注释。” ACM 杂志 (JACM) 33.3 (1986): 489-498。
> 
> 里德，布鲁斯。“随机二叉搜索树的高度。” ACM 杂志 (JACM) 50.3 (2003): 306-332。

[http://staff.ustc.edu.cn/~csli/graduate/algorithms/book6/chap13.htm](http://staff.ustc.edu.cn/%7Ecsli/graduate/algorithms/book6/chap13.htm)

这些近似值通常采用以下形式：`A ln n - B ln ln n + C`

地点`A~4.311`和地点`B~1.953`

所以最有用的可能是随机插入的平均高度是`O(log n)`，但如果你真的需要一个数值近似值，我认为`(4.311 ln n - 1.953 ln ln n)`对于大的 n 来说已经足够接近了。

对于`n=1000`，这给出了大约`26`- 非常适合其他地方报告的实验结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T04:53:12.003

这个问题其实很棘手。答案不会是 1000，因为这是不可能的，但 log2(1000) 也是不可能的，但更不可能取决于树的生长方式。

如果您通过单步执行树来添加一个 int，然后天真地附加它，那么树实际上总是比 log2(1000) 高。

与统计学家交谈，因为这似乎与正态概率分布有关。这些是由许多迭代的随机事件生成的（头部向右一个单位，向左一个单位的尾部），并且随机整数的值在树中迭代，因为它稳定到叶子中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T03:18:37.517

这取决于添加的顺序。如果从最小值开始，那么树会更深，因为所有新值都将添加到右子 BST。如果你先添加最大值，那么左边的孩子会很深，而右边的孩子会是空的。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-14T04:38:08.093

正如之前有人提到的，无论您使用什么树，平均高度都是 log2(1000)。确实，根据插入的数字的顺序，实际高度可能会有所不同，但是假设您提到的随机分布的数字，那么实际值通常会接近预期值（这又是 log2 (1000))

# javascript - 用javascript折叠表单

> ID：861401
> 
> 赞同：0
> 
> 时间：2009-05-14T03:21:02.583
> 
> 标签：javascript, html

是否有可能使用 javascript，并且不使用诸如 jquery 之类的框架，有一个带有复选框或单选按钮列表的简单表单，如果选择了一个特定的，展开以显示更多的复选框/单选按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T07:47:46.873

```
<input ... onclick="toggleDetails(this);" />
<div id='detailsView' style='display:none'gt;
    content to display when checked
</div>

... script ...

function toggleDetails(chk) {
  document.getelemantById('detailsView').style.display = 
    chk.checked ? "block" : "none";
}
```

不过老实说，从长远来看，使用像 jQuery 这样的框架会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T03:32:52.227

你可以在任何框架中做的任何事情，你可以在没有框架的情况下做。

在许多情况下，框架只是让它变得更容易，因此您不必处理繁重的工作。

您可能想要做的只是在每个复选框或单选按钮上都有一个 onclick 事件处理程序，当单击它时，然后创建一个新 div 并用额外信息填充它，或者，如果该信息已经填充并且是只是使用 css 隐藏然后让事件处理程序使其可见。

有很多方法可以执行您的建议，具体取决于您对可用性的看法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T03:32:38.857

是的，这是可能的，但比使用框架做的工作要多得多。您需要编写 DOM 遍历代码以在表单中查找元素，事件绑定代码将函数绑定到表单元素的事件（这在 IE 和非 IE 之间有所不同），然后使用 style.display 属性进行 sub -隐藏或显示它们的元素。

如果你想了解更多，[Quirksmode.org](http://www.quirksmode.org/js/contents.html)有一些我发现的基本 Javascript 的最佳解释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T03:44:26.833

当然使用 onChange 事件和 dom 操作...您也可以考虑编写自己的动画，但如果有这么多社区为您完成工作，那真的是为什么。

# c# - c# 在整个数组中为 .ToString() 提供一个衬垫

> ID：861404
> 
> 赞同：4
> 
> 时间：2009-05-14T03:21:25.657
> 
> 标签：c#, shortcut

我觉得问起来很愚蠢，但是必须有一个内衬可以与以下 c# 中的代码等效或接近等效...所以你能告诉我它是什么吗？

```
 public static string[] ToStringArray(int[] i)
    {
        if (i==null) return null;
        string[] result = new string[i.Length];
        for (int n= 0; n< result.Length; n++)
            result[n] = i[n].ToString();
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T03:25:24.773

扩展方法怎么样？

```
public static string[] ToStringArray<T>(this IEnumerable<T> items)
{
    return items.Select(i => i.ToString()).ToArray();
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-14T03:27:49.167

使用 LINQ：

```
int[] ints = { 1, 2, 3 };

string[] strings = ints.Select(i => i.ToString()).ToArray(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T03:28:59.380

使用 LINQ：

```
(from x in i select x.ToString()).ToArray() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T03:40:41.850

```
 int[] x = new int[] {1,2,3};
string[] y = Array.ConvertAll(x, intArg => intArg.ToString()); 

```

# javascript - 如何删除标签，并使用 RegExp 保留元素中的文本？

> ID：861408
> 
> 赞同：1
> 
> 时间：2009-05-14T03:22:59.303
> 
> 标签：javascript, jquery, regex

我想删除元素标签并希望保留标签内的文本。我使用 RegExp 的替换功能，但它删除了所有内容：标签和标签内的文本。

我不想那样，我只想删除标签。清理文本，删除标签，我只想呈现文本。

```
var str = str.replace(/<.>[^.]*\/.>/, ""); 
```

我用了这个，但是有一个问题，它也删除了里面的文字！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T03:30:21.453

关于什么

`var obj = $('#element');`

`var str = obj.text();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T03:34:27.217

如果您确实在使用 jQuery，并且想要删除所有标签，那么只需将 .html() 设置为 .text()

```
var e = $("#yourelement");
e.html(
    e.text()
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T03:34:27.543

又快又脏：

```
var str = "<foo>bar</foo>"; alert(str.replace(/<[^>]+>/g, "")) 
```

考虑改用真实解析和 DOM 操作。使用 RegExp 正确处理 HTML 非常困难。

# wpf - WPF - 使超链接可点击

> ID：861409
> 
> 赞同：29
> 
> 时间：2009-05-14T03:23:29.893
> 
> 标签：wpf, url, hyperlink

我有一些文本要显示在列表中。其中一些文本包含超链接。我想让链接在文本中可点击。我可以想象这个问题的解决方案，但它们肯定看起来并不漂亮。

例如，我可以撕开字符串，将其分成超链接和非超链接。然后我可以动态构建一个文本块，根据需要添加纯文本元素和超链接对象。

我希望有更好的，最好是声明性的。

示例：“嘿，看看这个链接：[http](http://mylink.com) ://mylink.com 真的很酷。”

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-15T07:51:01.833

您需要能够解析 TextBlock 的文本并在运行时创建所有内联对象的东西。为此，您可以创建自己的从 TextBlock 或附加属性派生的自定义控件。

对于解析，您可以使用正则表达式在文本中搜索 URL。[我从A good url regular expression](http://geekswithblogs.net/casualjim/archive/2005/12/01/61722.aspx)中借用了一个正则表达式？但是网络上还有其他可用的，因此您可以选择最适合您的一种。

在下面的示例中，我使用了附加属性。要使用它，请将您的 TextBlock 修改为使用 NavigateService.Text 而不是 Text 属性：

```
<Window x:Class="DynamicNavigation.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:DynamicNavigation"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <!-- Type something here to see it displayed in the TextBlock below -->
        <TextBox x:Name="url"/>

        <!-- Dynamically updates to display the text typed in the TextBox -->
        <TextBlock local:NavigationService.Text="{Binding Text, ElementName=url}" />
    </StackPanel>
</Window> 
```

附加属性的代码如下：

```
using System;
using System.Text.RegularExpressions;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;

namespace DynamicNavigation
{
    public static class NavigationService
    {
        // Copied from http://geekswithblogs.net/casualjim/archive/2005/12/01/61722.aspx
        private static readonly Regex RE_URL = new Regex(@"(?#Protocol)(?:(?:ht|f)tp(?:s?)\:\/\/|~/|/)?(?#Username:Password)(?:\w+:\w+@)?(?#Subdomains)(?:(?:[-\w]+\.)+(?#TopLevel Domains)(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum|travel|[a-z]{2}))(?#Port)(?::[\d]{1,5})?(?#Directories)(?:(?:(?:/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|/)+|\?|#)?(?#Query)(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?#Anchor)(?:#(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)?");

        public static readonly DependencyProperty TextProperty = DependencyProperty.RegisterAttached(
            "Text",
            typeof(string),
            typeof(NavigationService),
            new PropertyMetadata(null, OnTextChanged)
        );

        public static string GetText(DependencyObject d)
        { return d.GetValue(TextProperty) as string; }

        public static void SetText(DependencyObject d, string value)
        { d.SetValue(TextProperty, value); }

        private static void OnTextChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var text_block = d as TextBlock;
            if (text_block == null)
                return;

            text_block.Inlines.Clear();

            var new_text = (string)e.NewValue;
            if ( string.IsNullOrEmpty(new_text) )
                return;

            // Find all URLs using a regular expression
            int last_pos = 0;
            foreach (Match match in RE_URL.Matches(new_text))
            {
                // Copy raw string from the last position up to the match
                if (match.Index != last_pos)
                {
                    var raw_text = new_text.Substring(last_pos, match.Index - last_pos);
                    text_block.Inlines.Add(new Run(raw_text));
                }

                // Create a hyperlink for the match
                var link = new Hyperlink(new Run(match.Value))
                {
                    NavigateUri = new Uri(match.Value)
                };
                link.Click += OnUrlClick;

                text_block.Inlines.Add(link);

                // Update the last matched position
                last_pos = match.Index + match.Length;
            }

            // Finally, copy the remainder of the string
            if (last_pos < new_text.Length)
                text_block.Inlines.Add(new Run(new_text.Substring(last_pos)));
        }

        private static void OnUrlClick(object sender, RoutedEventArgs e)
        {
            var link = (Hyperlink)sender;
            // Do something with link.NavigateUri like:
            Process.Start(link.NavigateUri.ToString());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T05:20:37.133

这是简化版：

```
<TextBlock>
    Hey, check out this link:        
    <Hyperlink NavigateUri="CNN.COM" Click="cnn_Click">Test</Hyperlink>
</TextBlock> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T04:51:12.600

像这样的东西？

```
<TextBlock>
    <TextBlock Text="Hey, check out this link:"/>
    <Hyperlink NavigateUri={Binding ElementName=lvTopics, Path=SelectedValue.Title}
                           Click="Url_Click">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Feed: " FontWeight="Bold"/>
            <TextBlock Text={Binding ElementName=lvTopics, Path=SelectedValue.Url}/>
        </StackPanel>
    </Hyperlink>
</TextBlock> 
```

编辑：如果你需要动态，绑定它。在上面的示例中，lvTopics（未显示）绑定到具有 Title 和 Url 属性的对象列表。此外，它不会自动转到 url，您需要使用类似的代码来处理它：

```
private void Url_Click(object sender, RoutedEventArgs e)
{    browser.Navigate(((Hyperlink)sender).NavigateUri); } 
```

我只是想表明你可以将任何东西嵌入到 TextBlock 中，包括超链接，以及任何东西到超链接中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-08T09:03:04.510

Bojan 答案的 VB.Net 版本。我对其进行了一些改进：此代码会将 http://support.mycompany.com?username=x&password=y 之类的 url 解析为[http://support.mycompany.com](http://support.mycompany.com)[的](http://support.mycompany.com?username=x&password=y)内联，同时仍导航到完整的 url带有用户名和密码

```
Imports System.Text.RegularExpressions
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Documents

Public Class NavigationService
    ' Copied from http://geekswithblogs.net/casualjim/archive/2005/12/01/61722.aspx '
    Private Shared ReadOnly RE_URL = New Regex("(?#Protocol)(?<domainURL>(?:(?:ht|f)tp(?:s?)\:\/\/|~/|/)?(?#Username:Password)(?:\w+:\w+@)?(?#Subdomains)(?:(?:[-\w]+\.)+(?#TopLevel Domains)(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum|travel|[a-z]{2})))(?#Port)(?::[\d]{1,5})?(?#Directories)(?:(?:(?:/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|/)+|\?|#)?(?#Query)(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?#Anchor)(?:#(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)?")

    Public Shared ReadOnly TextProperty = DependencyProperty.RegisterAttached( _
        "Text",
        GetType(String),
        GetType(NavigationService),
        New PropertyMetadata(Nothing, AddressOf OnTextChanged)
    )

    Public Shared Function GetText(d As DependencyObject) As String
        Return TryCast(d.GetValue(TextProperty), String)
    End Function

    Public Shared Sub SetText(d As DependencyObject, value As String)
        d.SetValue(TextProperty, value)
    End Sub

    Private Shared Sub OnTextChanged(d As DependencyObject, e As DependencyPropertyChangedEventArgs)
        Dim text_block = TryCast(d, TextBlock)
        If text_block Is Nothing Then Return

        text_block.Inlines.Clear()

        Dim new_text = CStr(e.NewValue)
        If String.IsNullOrEmpty(new_text) Then Return

        ' Find all URLs using a regular expression '
        Dim last_pos As Integer = 0
        For Each match As Match In RE_URL.Matches(new_text)
            'Copy raw string from the last position up to the match '
            If match.Index <> last_pos Then
                Dim raw_text = new_text.Substring(last_pos, match.Index - last_pos)
                text_block.Inlines.Add(New Run(raw_text))
            End If

            ' Create a hyperlink for the match '
            Dim link = New Hyperlink(New Run(match.Groups("domainURL").Value)) With
                {
                    .NavigateUri = New Uri(match.Value)
                }
            AddHandler link.Click, AddressOf OnUrlClick

            text_block.Inlines.Add(link)

            'Update the last matched position '
            last_pos = match.Index + match.Length
        Next

        ' Finally, copy the remainder of the string '
        If last_pos < new_text.Length Then
            text_block.Inlines.Add(New Run(new_text.Substring(last_pos)))
        End If
    End Sub

    Private Shared Sub OnUrlClick(sender As Object, e As RoutedEventArgs)
        Try
            Dim link = CType(sender, Hyperlink)
            Process.Start(link.NavigateUri.ToString)
        Catch
        End Try
    End Sub
End Class 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-11T15:34:04.437

如果您使用类似 MVVM light 或类似架构的东西，您可以在 textblock mousedown 属性上有一个交互触发器，并在 viewmodel 的代码中执行任何操作。

# java - Java 虚拟机真的是和我的 VMWare 或 Parallels 文件一样的虚拟机吗？

> ID：861422
> 
> 赞同：33
> 
> 时间：2009-05-14T03:30:53.200
> 
> 标签：java, jvm

Java 虚拟机真的是和我的 VMWare 或 Parallels 文件一样的虚拟机吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-14T03:38:21.433

不。

VMWare 和其他人实际上虚拟化了机器的*硬件*。在 VMWare 容器（或 Parallels 或 Windows 的虚拟化容器或 Bochs 或 ...）内运行的操作系统对在虚拟化容器内运行具有不同程度的感知。在 VMWare 中，操作系统不知道它是在虚拟容器中运行的。操作系统根本没有修改，尽管通常会安装专门的驱动程序（最重要的是视频）以防止性能问题。其他一些虚拟机不进行完整的硬件虚拟化，而是要求容器内的操作系统对容器进行特殊调用来代替常规的硬件调用。

从这个意义上说，JVM 根本不是虚拟机。除处理器外，没有任何硬件被虚拟化。JVM 本质上是一个虚拟化 CPU，加上 C++ 或任何其他面向对象语言所包含的相同类型的运行时，以及垃圾收集和其他必需品。此外，当然，Java 类文件（和 JAR 文件等）不是机器码，而是中间字节码。因此 JVM 必须在运行时编译或解释类文件（无论是否包含在 JAR 文件中），并具有在运行时动态加载和查找新代码的能力。

JVM之所以称为虚拟机，是因为JVM定义定义了一个抽象机。这包括寄存器、堆栈等，Java 源代码编译成的字节码实际上是该虚拟机的机器码。然后，JVM 将此字节码解释或编译为本机机器指令。

本质上的区别在于JVM是一个虚拟化的**处理器**，而其他虚拟机是虚拟化的**机器**（包括显卡、网络以及其他外部设备和硬件寄存器）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T03:33:47.310

不，系统虚拟机和进程虚拟机是有区别的。JVM 是进程虚拟机，而 VMWare 和 kind 是系统虚拟机。有关更多信息，请参阅[维基百科条目](http://en.wikipedia.org/wiki/Virtual_machine)。

就并行虚拟机而言，上述条目状态，

> PVM（Parallel Virtual Machine）并不是严格意义上的虚拟机，因为运行在上面的应用程序仍然可以访问所有的操作系​​统服务，因此并不局限于“VM”提供的系统模型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T04:28:46.023

Jeanna Matthews 等人在“Running Xen: A Hands-On Guide to the Art of Virtualization”中对这些区别进行了很好的总结。（[亚马逊](https://rads.stackoverflow.com/amzn/click/com/B001652I26)）。VMWare 是*完全虚拟化*的一个例子，它试图虚拟化一个物理硬件架构，以便不同的未修改的客户操作系统可以放在它上面。Java 虚拟机是他们所谓的*应用程序虚拟化*的一个示例，其中“应用程序在虚拟执行环境中运行，该环境为跨平台执行提供标准 API 并管理应用程序对本地资源的消耗。” （第 13 页）

在这两种情况下，您都有一个软件在其上运行的虚拟化层。JVM 运行 Java 应用程序，而 VMWare 运行完整的操作系统。VMWare 虚拟化了一台过去总是被表示为物理硬件的机器。JVM 虚拟化可以用物理硬件表示的机器*，*但几乎总是不能（但请参阅[硬件 JVM](http://www.ebb.org/bkuhn/writings/technical/thesis/node10.html)）。

# sharepoint - 使用 ISA 设置 SharePoint 最佳实践

> ID：861437
> 
> 赞同：1
> 
> 时间：2009-05-14T03:35:59.303
> 
> 标签：sharepoint, architecture, implementation

谁能指导我使用 ISA 实施 SharePoint 的最佳方式？我有兴趣建立一个基本的 SharePoint 场。我已经尝试了很多次，结果好坏参半，但我仍然不确定最好的方法。

最初设置时，系统会提示您创建一个 Web 应用程序，但是当您创建 ssp 管理站点时，它会警告您正在与我的站点相同的 Web 应用程序中创建它。这是一个问题吗？我应该为内容、ssp 管理站点和我的站点使用不同的 Web 应用程序吗？

我想我真正想知道的是设置它的最佳方法是什么，这样一旦用户开始用所有东西填满它，它就不会崩溃。有什么需要考虑的？

我还有一个关于 ISA 的问题。我已经让 SharePoint 在 ISA 后面工作，但我认为我做得不对。有人可以就完成此任务的一些注意事项或最佳实践给我指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T03:43:13.393

是的，您应该为 SSP、MySites 和您的内容拥有单独的站点。分享这些不是一个好主意。

不幸的是，您的问题没有简单的答案。从治理计划文件开始。它会让你朝着正确的方向前进，并帮助你提出正确的问题。感觉就像您正在走一条通往“不要这样做”的课程的道路（我一直在走这条路）。

[http://blogs.msdn.com/joelo/attachment/715068.ashx](http://blogs.msdn.com/joelo/attachment/715068.ashx)

# ruby-on-rails - 有没有办法避免自动更新 Rails 时间戳字段？

> ID：861448
> 
> 赞同：71
> 
> 时间：2009-05-14T03:40:29.477
> 
> 标签：ruby-on-rails, ruby, activerecord, timestamp

如果您有 DB 列`created_at`，`updated_at`Rails 将在您创建和更新模型对象时自动设置这些值。有没有办法在不触及这些列的情况下保存模型？

我引入了一些遗留数据，我想从（不同命名的）遗留数据字段中的相应值设置这些值。我发现当我在模型上设置它们然后保存模型时，Rails 似乎覆盖了传入的值。

当然，我可以将 Rails 模型列命名为不同的名称以防止这种情况发生，但是在导入数据后，我希望 Rails 自动执行时间戳。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-05-14T13:31:49.027

在迁移或 rake 任务中执行此操作（如果您在边缘轨道上，则[在新的数据库种子中）：](http://github.com/rails/rails/commit/4932f7b38f72104819022abca0c952ba6f9888cb)

```
ActiveRecord::Base.record_timestamps = false
begin
  run_the_code_that_imports_the_data
ensure
  ActiveRecord::Base.record_timestamps = true  # don't forget to enable it again!
end 
```

您可以安全地手动设置`created_at`，`updated_at`Rails 不会抱怨。

注意：这也适用于单个模型，例如 `User.record_timestamps = false`

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-06-24T21:30:49.403

改用 update_column 方法：

[http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-update_column](http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-update_column)

```
update_column(name, value)
# Updates a single attribute of an object, without calling save. 
```

验证被跳过。

回调被跳过。

如果该列可用，updated_at/updated_on 列不会更新。

在新对象上调用或将 name 属性标记为只读时引发 ActiveRecordError。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2016-05-12T17:06:56.863

Rails 5 提供了一种方便的方法来更新记录而不更新它的时间戳`updated_at`：[https ://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-save](https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-save)

你，只需要`touch:false`在更新你的记录时通过。

```
>> user = User.first
>> user.updated_at
=> Thu, 28 Apr 2016 20:01:57 IST +05:30
>> user.name = "Jose"
>> user.save(touch: false)
=> true

>> user.updated_at
=> Thu, 28 Apr 2016 20:01:57 IST +05:30 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-05-14T04:00:04.750

您可以在迁移中设置以下内容：

```
ActiveRecord::Base.record_timestamps = false 
```

或者 altenatively 使用 update_all：

> **update_all（更新，条件 = nil，选项 = {}）**
> 
> 如果它们与提供的一组条件匹配，则使用给定的详细信息更新所有记录，也可以提供限制和顺序。此方法构造单个 SQL UPDATE 语句并将其直接发送到数据库。它不会实例化涉及的模型，也不会触发 Active Record 回调。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-07-20T22:19:17.893

在 Rails 3+ 中，对于单个对象，`record_timestamps`为对象而不是类设置。IE，

```
>> user = User.first
>> user.updated_at
=> Tue, 12 Apr 2016 22:47:51 GMT +00:00
>> user.name = "Jose"
=> "Jose"
>> user.record_timestamps = false
>> user.save
=> true
>> user.updated_at
=> Tue, 12 Apr 2016 22:47:51 GMT +00:00
>> User.record_timestamps
=> true 
```

这样，您就不会触及模型的全局状态，也不必记住在`ensure`块中恢复先前的设置。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-03-19T07:58:53.900

参考其他答案，我惊讶地发现禁用单个模型的时间戳，例如：

```
User.record_timestamps = false 
```

为我的开发数据库工作，但不适用于在不同服务器上运行的预生产数据库。但是，如果我禁用所有模型的时间戳，它会起作用

```
ActiveRecord::Base.record_timestamps = false 
```

（情况：在迁移中修改 created_at 属性）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-14T04:11:06.737

由于这是一次性导入，您可以执行以下操作：

1.  `legacy_created_at`使用和`legacy_updated_at`字段创建模型。
2.  加载旧数据。根据需要映射到模型字段。您可以使用`#save`并且通常不用担心使用`update_all`等，如果需要，您可以使用回调。
3.  创建迁移以将列重命名为`created_at`和`updated_at`。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-10-21T21:12:32.387

我喜欢使用 mixin 模块来临时关闭块中的时间戳：

```
module WithoutTimestamps
  def without_timestamps
    old = ActiveRecord::Base.record_timestamps
    ActiveRecord::Base.record_timestamps = false
    begin
      yield
    ensure
      ActiveRecord::Base.record_timestamps = old
    end
  end
end 
```

然后你可以在任何你需要的地方使用它

```
class MyModel < ActiveRecord::Base
  include WithoutTimestamps

  def save_without_timestamps
    without_timestamps do
      save!
    end
  end
end 
```

或者只是这样的一次性：

```
m = MyModel.find(1)
WithoutTimestamps.without_timestamps do
  m.save!
end 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-08T22:39:13.393

当不在批量导入中时，您可以覆盖 should_record_timestamps? 模型上的方法来添加关于何时更新 updated_at 列的新检查。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-16T00:22:57.247

或者，对于线程安全，请参阅：[http ://www.hungryfools.com/2007/07/turning-off-activerecord-timestamp.html](http://www.hungryfools.com/2007/07/turning-off-activerecord-timestamp.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-30T14:37:42.837

我无法让`ActiveRecord::Base.record_timestamps`标志改变任何东西，唯一的工作方法是使用`ActiveRecord::Base.no_touching {}`：

```
ActiveRecord::Base.no_touching do
  Project.first.touch  # does nothing
  Message.first.touch  # does nothing
end

Project.no_touching do
  Project.first.touch  # does nothing
  Message.first.touch  # works, but does not touch the associated project
end 
```

取自[这里](https://api.rubyonrails.org/classes/ActiveRecord/NoTouching/ClassMethods.html)。

这对于 rake 任务非常有用，您必须覆盖深度相关模型的某些属性并且不想打扰内部回调，而您的用户依赖`created_at`或`updated_at`属性或那些用作排序列。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-26T19:31:26.343

我参加聚会迟到了，但这就是我们`updated_at`在商店中跳过更新的方式：

```
# config/initializers/no_timestamping.rb
module ActiveRecord
  class Base

    def update_record_without_timestamping
      class << self
        def record_timestamps; false; end
      end

      save!

      class << self
        remove_method :record_timestamps
      end
    end

  end
end 
```

用法：

```
post.something = 'whatever'
post.update_record_without_timestamping 
```

# silverlight - Prism Silverlight LoadModule 并传递数据

> ID：861451
> 
> 赞同：1
> 
> 时间：2009-05-14T03:41:24.437
> 
> 标签：silverlight, unity-container

我正在按需动态加载模块以编辑业务对象（假设是客户模块）。

然后我想加载模块并将customerDTO（或主键）传递给视图模型。我的按钮上有 OnClick 命令来触发我的 ICommand，然后我加载 CustomerModule：

```
 private void EditCustomer(Guid customerID)
    {
        moduleManager.LoadModule("CustommerModule");
    } 
```

如果我使用构造函数注入，Unity 将为我实例化一个新的客户 DTO。

如何将 customerID 传递给 CustomerModule？

干杯，

阿里

# com - COM 可见函数 (VB6) 中复杂对象的参数类型

> ID：861455
> 
> 赞同：0
> 
> 时间：2009-05-14T03:44:42.823
> 
> 标签：com, vb6, object, variant

我们应该使用`object`or`variant`吗？它有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T03:52:50.057

如果您使用 Object，则客户端必须传入支持的内容，`IUnknown`或者`IDispatch`- 简而言之，参数必须是一个对象。如果您使用 Variant，那么客户端可以传入任何内容。

# c# - linq 按日期时间列上的开始时间到结束时间分组

> ID：861456
> 
> 赞同：4
> 
> 时间：2009-05-14T03:45:12.370
> 
> 标签：c#, linq, datetime, group-by, linq-to-objects

好的，这是一个混乱的查询，我只取得了有限的成功。我有一个包含 datetime 属性和其他数据的 Foo 类的列表。我几乎每分钟都有一堂课/一排，有些缺课，有些缺课，比如假期或周末。我的目标是每天对从开始时间到结束时间的所有行进行分组。

所以在某些日子里，我的开始时间可能是上午 9:30，结束时间可能是下午 3:00。这种情况我通过以下方式处理：

```
DateTime sd = new DateTime(2000, 1, 1, 9, 30, 0);
DateTime ed = new DateTime(2000, 1, 1, 15, 0, 0);
var z = Foos.Where(a=> a.FooDate.TimeOfDay >= sd.TimeOfDay &&
    a.FooDate.TimeOfDay < ed.TimeOfDay)
    .GroupBy(a=>a.FooDate.Date); 
```

这工作正常。我的问题是有时我的开始时间是晚上 9 点，结束时间是早上 6 点。在那种情况下，我希望这组 foos 过夜，如果晚上 9 点是星期五，并且直到下一个星期一之前没有行，我希望该组跨越周末。我什至会很高兴提出一个查询的建议，该查询总是会转到第二天。

我希望那很清楚并欣赏任何想法。我尝试了很多其他方法来使用循环并创建另一个不同日期的列表等，但对此并不满意。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T17:30:13.617

在物理学中，当遇到一个相对问题时，他们可以选择零在哪里。我们也是。

```
// time range expressed as an example in "absolute" terms
DateTime sd = new DateTime(2000, 1, 1, 9, 30, 0);
DateTime ed = new DateTime(2000, 1, 2, 6, 0, 0);

// time range expressed as a zero and range - "relative" terms
TimeSpan zero = sd.TimeOfDay;
TimeSpan range = ed.Subtract(sd);

 //the inputs
List<DateTime> myList = new List<DateTime>()
{
  new DateTime(2009, 1, 1, 10, 0, 0),  //group1
  new DateTime(2009, 1, 1, 17, 0, 0),  //group1
  new DateTime(2009, 1, 2, 9, 0, 0),  //this is filtered
  new DateTime(2009, 1, 2, 10, 0, 0),  //group2
  new DateTime(2009, 1, 2, 15, 0, 0),  //group2
  new DateTime(2009, 1, 3, 3, 0, 0),   //group2
  new DateTime(2009, 1, 3, 7, 0, 0),  //this is filtered
  new DateTime(2009, 1, 3, 10, 0, 0)   //group3
};

  //at last, the query.
var query = myList
  .Where(d => d.Subtract(zero).TimeOfDay < range)
  .GroupBy(d => d.Subtract(zero).Date);

 //  output the results
foreach (var g in query)
{
  Console.WriteLine("{0}", g.Count());
  foreach (var d in g)
  {
    Console.WriteLine("  {0}", d);
  }
} 
```

结果：

```
2
  1/1/2009 10:00:00 AM
  1/1/2009 5:00:00 PM
3
  1/2/2009 10:00:00 AM
  1/2/2009 3:00:00 PM
  1/3/2009 3:00:00 AM
1
  1/3/2009 10:00:00 AM 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T16:57:31.857

这会起作用，但它可能不会比你已经在做的更漂亮

```
 private List<groupFoo> groupFoos(List<foo> foos)
    {

        //Group by Day into groupFoo
        var z = foos.GroupBy(a => a.FooDate.ToShortDateString()).Select(x => new groupFoo() { Key = x.Key, Start = x.First().FooDate, End = x.Last().FooDate }).ToList();

        //Create new list to hold groups
        var groupedFoos = new List<groupFoo>();

        //add all the good groups to the list
        groupedFoos.AddRange(z.FindAll(zz => zz.Start.CompareTo(zz.End) != 0));

        //Remove all of the good groups from the orignal list
        groupedFoos.ForEach(gf => z.RemoveAt(z.IndexOf(gf)));

        //Sort whats left
        z.Sort((a, b) => { return a.Start.CompareTo(b.Start); });

        while (z.Count > 1)
        {
            //grab the first 2 
            var y = z.Take(2);

            //create a new group foo and add it to the good list
            groupedFoos.Add(y.Aggregate((a, b) => new groupFoo() { Key = a.Key, Start = a.Start, End = b.End }));

            //remove the bad ones
            y.ToList().ForEach(yy => z.RemoveAt(z.IndexOf(yy)));

        }

        return groupedFoos;
    } 
```

groupFoo 看起来像这样

```
public class groupFoo
{

    public string Key { get; set; }
    public DateTime Start { get; set; }
    public DateTime End { get; set; }

} 
```

我使用的样本

```
 List<foo> foos = new List<foo>();

        foos.Add(new foo() { FooDate = new DateTime(2009, 1, 1, 9, 0, 0) });
        foos.Add(new foo() { FooDate = new DateTime(2009, 1, 1, 17, 0, 0) });
        foos.Add(new foo() { FooDate = new DateTime(2009, 1, 2, 9, 30, 0) });
        foos.Add(new foo() { FooDate = new DateTime(2009, 1, 3, 6, 0, 0) });
        foos.Add(new foo() { FooDate = new DateTime(2009, 1, 4, 9, 0, 0) });
        foos.Add(new foo() { FooDate = new DateTime(2009, 1, 4, 21, 0, 0) }); 
```

# c++ - 用于 C/C++ 的轻量级 OBJ 网格文件加载器？

> ID：861458
> 
> 赞同：6
> 
> 时间：2009-05-14T03:46:18.823
> 
> 标签：c++, input, geometry, mesh

我正在寻找用于 C 或 C++ 的简单轻量级 Wavefront OBJ 网格文件阅读器。（即，给定一个 OBJ 格式的网格，从文件中读取它，并使其可访问，最好是作为顶点和三角形的列表。）推荐？

它不需要支持材料属性或任何其他可能存在的奇特数据——只要几何形状就可以了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-09T17:07:21.100

[Open Asset Import Library](http://www.assimp.org)看起来很有前途。[支持多种格式](https://github.com/assimp/assimp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T13:56:24.070

有很多：[http](http://www.google.com/codesearch?q=wavefront+obj+loader)
://www.google.com/codesearch?q=wavefront+obj+loader 这个例如：[http ://www.google.com/codesearch?hl=ru&q=wavefront+obj+ loader&exact_package=http://ftp5.ru.freebsd.org/pub/FreeBSD/distfiles/gl-117-1.3.2-src.tar.bz2](http://www.google.com/codesearch?hl=ru&q=wavefront+obj+loader&exact_package=http://ftp5.ru.freebsd.org/pub/FreeBSD/distfiles/gl-117-1.3.2-src.tar.bz2) ;)

Google 链接已损坏。CodeSearch 被取消了。试试这些。托管/搜索 [http://www.google.com/hosting/search?q=wavefront+obj+loader](http://www.google.com/hosting/search?q=wavefront+obj+loader)

第二个链接在链接中嵌入了这个（该链接仍然有效）： http: [//ftp5.ru.freebsd.org/pub/FreeBSD/distfiles/gl-117-1.3.2-src.tar.bz2](http://ftp5.ru.freebsd.org/pub/FreeBSD/distfiles/gl-117-1.3.2-src.tar.bz2)

# c# - C# 多线程

> ID：861459
> 
> 赞同：4
> 
> 时间：2009-05-14T03:47:07.903
> 
> 标签：c#, multithreading

看看下面的代码。假设这是整个类。我没有省略任何代码。这就是它所做的一切。

如果我在我的主程序循环中实例化这个类并不时调用 myExample.Add(whatever)，我是否需要担心由于未锁定 Dequeue() 和 Enqueue() 而导致的任何问题？

```
public class Example<T>
{
    private Queue<T> q = new Queue<T>();

    public Example()
    {
        new Thread(() => 
        {
            while (true) 
            {
                if (this.q.Count > 0)
                {
                    var item = this.q.Dequeue();
                }
                Thread.Sleep(1);
            }
        }).Start();
    }

    public void Add(T val)
    {
        this.q.Enqueue(val);
    }
} 
```

如果 this.q.Enqueue(val) 与 this.q.Dequeue() 同时被调用会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T04:07:51.580

简短的版本是，如果您希望队列起作用，则*必须同步对队列的访问。*Count/Dequeue 中存在明显的线程竞争，但更重要的是不保证*任何*操作 - 内部状态可以合法地做*任何事情*，并且很可能被破坏。

您还需要一种最终退出线程的方法...

要编写阻塞队列，请参见此处：[在 .NET 中](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)[创建阻塞`Queue<T>`](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T03:53:56.560

这取决于。:) 如果您使用多个线程调用示例，您将在检查队列计数和出队之间出现竞争条件。例如 ...

```
T1 Call Example
T2 Call Example
T2 check Q.Count > 0 (yes)
T1 check Q.count > 0 (yes)
T2 dequeue
T1 dequeue OOPS! 
```

如果您不使用多个线程调用示例，那么您将没有问题，因为您不在乎脱掉什么，只在乎脱掉一些东西。如果你关心你起飞的东西，那么 Add 和 Example 之间的竞争条件将再次成为一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T03:55:17.197

克里斯

添加私有静态字段

```
readonly static object lockObject = new object(); 
```

将 dequeue 和 enqueue 括起来

```
lock(lockObject)
{
  //do stuff
} 
```

对于你的 lambda 把它放在循环之外

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T03:56:08.100

由于您正在通过 Dequeue 方法写入队列，因此您确实需要锁定它。队列对于多个读者来说是线程安全的，但对多个作者来说不是[线程安全](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T04:07:27.790

MSDN 说队列不是线程安全的：http: [//msdn.microsoft.com/en-us/library/7977ey2c.aspx](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T03:54:33.203

我假设

```
this.queue.Enqueue(val); 
```

你的意思是

```
this.q.Enqueue(val); 
```

?

如果是这样，那么是的，您需要执行某种锁定。集合本质上不是线程安全的。考虑到您总是从一个线程中删除，并且总是从另一个线程中添加它可能工作正常，但为什么不安全地玩呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T03:56:30.313

我不明白你为什么认为它可能是安全的。

我的担心/假设是同时（从两个不同的线程）进入 Enqueue 和 Dequeue 可能会破坏 Queue 实例的内部状态。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T04:08:33.780

由于您正在显式创建一个单独的线程来修改队列，因此无论您从哪个线程调用 Add()，调用 Add() 都是不安全的。

您需要 lock() "if" 语句块，因为调用 q.Count 甚至不安全，然后在 Add() 方法中再次锁定。

# javascript - jQuery Star Rating Plugin 无法识别 {split:4}

> ID：861476
> 
> 赞同：5
> 
> 时间：2009-05-14T03:55:15.387
> 
> 标签：javascript, jquery, html, jquery-plugins

我在 ASP.NET MVC 站点上使用[jQuery Star Rating 插件](http://www.fyneworks.com/jquery/star-rating/)，但我无法让它与分裂星一起使用。据我所知，我正在创建正确的单选按钮。我已经尝试过使用 RadioButton 辅助方法和纯 HTML，并且我也尝试过使用和不使用禁用输入（在这个特定页面上，我打算使用禁用）。这是我现在在页面上的内容：

```
<input class="star {split:4}" type="radio" disabled="disabled" value="1" name="Rating"/>
...
<input class="star {split:4}" type="radio" disabled="disabled" value="19" name="Rating" checked="checked"/>
<input class="star {split:4}" type="radio" disabled="disabled" value="20" name="Rating"/> 
```

当页面加载时，它会将所有单选按钮转换为星星，但不是将 5 颗星分成四等份，而是显示 20 颗没有拆分的星星。有什么我想念的想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T04:03:26.053

没关系，我发现了问题。我没有包括 jquery.MetaData.js，只是 jquery.rating.js 文件。它在下载页面上没有列为必需文件，只是作为相关文件列出，但演示需要它而没有提及。

# javascript - 如何在Javascript中更改类变量？

> ID：861481
> 
> 赞同：2
> 
> 时间：2009-05-14T03:58:01.213
> 
> 标签：javascript, class, variables

问题解决了。

特别感谢 Andrew Noyes 解释它不是一个类而是一个 Object Literal Notation。我是什么菜鸟。。

编辑：

SORRY，我的js文件出错了，我的js结构是这样的：

（我对 javascript 完全陌生，我需要你们的帮助......）

```
var className = {

settings : {
    setA  : true,
    setB: true,
    setC: true,
    },

    Default : {
        move: true,
        remove: true,
        edit: true,\
    },
    ...
} 
```

在我的 html index.html 中，我包含了 class.js 文件，但我想将设置更改为：

```
 Default : {
    move  : false,
    remove: false,
    edit: false,
    } 
```

因为只有edit.html，用户可以移动、删除和编辑。

我怎么做？我应该有 2 个 js，class_disable.js（包含在 index.html 中）和 class_enable.js（用于 edit.html）吗？

需要你的建议。。

我试过了：

```
 className.settings.Default = {move = false, remove = false, edit = false}; 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T04:17:52.790

这不是有效的语法：

```
className.settings.Default = {move = false, remove = false, edit = false}; 
```

对象值使用冒号分配，如下所示：

```
className.settings.Default = {
    move: false,
    remove: false,
    edit: false
}; 
```

或者，您可以使用以下语法：

```
className.settings.Default.move = false;
className.settings.Default.remove = false;
className.settings.Default.edit: false; 
```

你在这里使用的不是一个类，它被称为 Object Literal Notation，在 JavaScript 中很常见。没有类或构造函数，您只是使用文字将属性分配给对象，因此名称对象文字表示法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T04:02:08.897

```
className.settings = {move: false, remove: false, edit: false}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T04:04:36.440

或很长的路：

```
className.settings.move = false;
className.settings.remove = false;
className.settings.edit = false; 
```

如果您使用 jQuery，另一种方法是：

```
$.extend(className.settings, {move: false, remove: false, edit: false}); 
```

# excel - 如何编辑 DsoFramer 1.3？

> ID：861489
> 
> 赞同：0
> 
> 时间：2009-05-14T04:01:30.927
> 
> 标签：excel, visual-c++, dsoframer

我在我的项目中使用[DsoFramer](http://codebetter.com/blogs/paul.laudeman/archive/2006/05/25/Registration_2D00_Free-COM-with-the-DsoFramer-Control.aspx) 1.3 来保存 Excel (2007) 文档。但是它有一个很大的问题，那就是：

DsoFramer 打开的所有 Excel 文档只共享一个 Excel 进程。结果是当DsoFramer打开第二个Excel文档时，第一个文档是不可编辑的。

更有什者，当我直接在Windows资源管理器中双击一个Excel文档时，DsoFramer中的文档会失去焦点，因为`excel.exe`任务管理器中只有一个，最后一个会得到它。

幸运的是，微软提供了 DsoFramer 1.3 的源代码，但不支持它。（[http://www.microsoft.com/downloads/details.aspx?FamilyId=CE2CA4FD-2169-4FAC-82AF-770AA9B60D77&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=CE2CA4FD-2169-4FAC-82AF-770AA9B60D77&displaylang=en)。）

每次使用 dsoframer 打开 Excel 文档时，如何编辑源代码并使其生成新的 Excel 进程？

我尝试了[史蒂夫](https://stackoverflow.com/users/22472/steve)的方法，但它不起作用。 [DSOFramer 在另一个窗口中关闭 Excel 文档。如果文件中未保存数据，则 dsoframer 无法打开并显示“尝试访问无效地址”](https://stackoverflow.com/questions/251909/dsoframer-closing-excel-doc-in-another-window-if-unsaved-data-in-file-dsoframer)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-12T06:15:02.257

office ocx 7 没有这个问题。它看起来像是一个增强版 dsoframer，并解决了 dsoframer 中存在的一些致命错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T16:10:48.153

您可以尝试使用带有[Windows 窗体控件的](http://www.spreadsheetgear.com/support/samples/windowsforms.aspx)[SpreadsheetGear](http://www.spreadsheetgear.com/) ，该控件提供了查看、编辑、格式化、打印等... xls 和 xlsx 工作簿的能力。我们有许多客户出于各种原因从 DsoFramer 切换到 SpreadsheetGear。

SpreadsheetGear 具有工作簿集的概念，它是工作簿的集合，大致类似于 Excel 应用程序的一个实例。工作簿集的数量仅受可用内存的限制。它还有一个 WorkbookView Windows Forms 控件。您可以拥有多个 WorkbookView，并且每个 WorkbookView 默认都有自己的工作簿集（如果您希望多个 WorkbookViews 查看同一工作簿集，您可以覆盖它）。

[您可以在此处](http://www.spreadsheetgear.com/)了解有关 SpreadsheetGear 的更多信息并下载免费试用版。

免责声明：我拥有 SpreadsheetGear LLC

# content-management - 在组织内协作和分发项目和发布文档的最佳方式是什么？

> ID：861494
> 
> 赞同：0
> 
> 时间：2009-05-14T04:05:17.343
> 
> 标签：content-management

这是一个持续存在的问题：允许正在创建项目计划、需求、功能规范、设计文档和测试计划的开发人员之间进行协作（和版本控制）。然后，为组织中的其他人（IT、客户服务、技术支持）发布以使用此信息。

人们使用什么系统来跟踪项目文档？您如何汇总每个版本的变更信息并将其呈现给最终用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T04:10:13.777

我不知道我是否会认为这是最好的，但是... Sharepoint 是我们（主要）使用的，它很好地集成到 Office 中用于共享文档（签入和签出），此外，您还可以创建 Wiki、文档列表与 RSS 提要等它是....可用的。

# java - 从 Java 中的类路径加载资源的 URL

> ID：861500
> 
> 赞同：209
> 
> 时间：2009-05-14T04:07:39.273
> 
> 标签：java, url, classloader

在 Java 中，您可以使用相同的 API 但使用不同的 URL 协议来加载各种资源：

```
file:///tmp.txt
http://127.0.0.1:8080/a.properties
jar:http://www.foo.com/bar/baz.jar!/COM/foo/Quux.class 
```

这很好地将资源的实际加载与需要资源的应用程序分离，并且由于 URL 只是一个字符串，因此资源加载也很容易配置。

是否有使用当前类加载器加载资源的协议？这类似于 Jar 协议，只是我不需要知道资源来自哪个 jar 文件或类文件夹。

当然，我可以使用 来做到这一点[`Class.getResourceAsStream("a.xml")`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))，但这需要我使用不同的 API，因此需要更改现有代码。我希望能够在我已经可以为资源指定 URL 的所有地方使用它，只需更新属性文件即可。

* * *

## 回答 #1

> 赞同：357
> 
> 时间：2009-11-20T09:52:09.220

## 介绍和基本实现

首先，您至少需要一个 URLStreamHandler。这实际上将打开到给定 URL 的连接。请注意，这只是简单地调用`Handler`；这允许您指定`java -Djava.protocol.handler.pkgs=org.my.protocols`并且它会自动被拾取，使用“简单”包名称作为支持的协议（在本例中为“类路径”）。

### 用法

```
new URL("classpath:org/my/package/resource.extension").openConnection(); 
```

### 代码

```
package org.my.protocols.classpath;

import java.io.IOException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLStreamHandler;

/** A {@link URLStreamHandler} that handles resources on the classpath. */
public class Handler extends URLStreamHandler {
    /** The classloader to find resources from. */
    private final ClassLoader classLoader;

    public Handler() {
        this.classLoader = getClass().getClassLoader();
    }

    public Handler(ClassLoader classLoader) {
        this.classLoader = classLoader;
    }

    @Override
    protected URLConnection openConnection(URL u) throws IOException {
        final URL resourceUrl = classLoader.getResource(u.getPath());
        return resourceUrl.openConnection();
    }
} 
```

### 启动问题

如果你和我一样，你不想依赖在启动时设置的属性来让你到达某个地方（在我的例子中，我喜欢像 Java WebStart 一样保持我的选项开放——这就是*我*需要这一切的原因）。

## 变通方法/增强功能

### 手动代码处理程序规范

如果你控制代码，你可以做

```
new URL(null, "classpath:some/package/resource.extension", new org.my.protocols.classpath.Handler(ClassLoader.getSystemClassLoader())) 
```

这将使用您的处理程序打开连接。

但同样，这不太令人满意，因为您不需要 URL 来执行此操作 - 您想要这样做是因为您无法（或不想）控制的某些库想要 url...

### JVM 处理程序注册

最终的选择是注册一个`URLStreamHandlerFactory`将处理整个 jvm 的所有 url：

```
package my.org.url;

import java.net.URLStreamHandler;
import java.net.URLStreamHandlerFactory;
import java.util.HashMap;
import java.util.Map;

class ConfigurableStreamHandlerFactory implements URLStreamHandlerFactory {
    private final Map<String, URLStreamHandler> protocolHandlers;

    public ConfigurableStreamHandlerFactory(String protocol, URLStreamHandler urlHandler) {
        protocolHandlers = new HashMap<String, URLStreamHandler>();
        addHandler(protocol, urlHandler);
    }

    public void addHandler(String protocol, URLStreamHandler urlHandler) {
        protocolHandlers.put(protocol, urlHandler);
    }

    public URLStreamHandler createURLStreamHandler(String protocol) {
        return protocolHandlers.get(protocol);
    }
} 
```

要注册处理程序，请`URL.setURLStreamHandlerFactory()`使用您配置的工厂调用。然后`new URL("classpath:org/my/package/resource.extension")`像第一个例子一样，然后离开。

### JVM 处理程序注册问题

请注意，每个 JVM 只能调用此方法一次，请注意 Tomcat 将使用此方法注册 JNDI 处理程序 (AFAIK)。试试码头（我会的）；在最坏的情况下，您可以先使用该方法，然后它必须在您周围工作！

## 执照

*我将其发布到公共领域，并询问您是否希望修改您在某处启动 OSS 项目并在此处评论详细信息。更好的实现是`URLStreamHandlerFactory`使用s为每个`ThreadLocal`s 存储s 。我什至会给你我的修改和测试课程。`URLStreamHandler``Thread.currentThread().getContextClassLoader()`*

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2011-01-04T16:50:17.743

```
URL url = getClass().getClassLoader().getResource("someresource.xxx"); 
```

那应该这样做。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-14T14:40:51.690

我认为这是值得自己回答的——如果你使用的是 Spring，那么你已经有了这个

```
Resource firstResource =
    context.getResource("http://www.google.fi/");
Resource anotherResource =
    context.getResource("classpath:some/resource/path/myTemplate.txt"); 
```

就像在[春季文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/resources.html)中解释的那样，并在 skaffman 的评论中指出。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-07-24T16:44:41.073

您还可以在启动期间以编程方式设置属性：

```
final String key = "java.protocol.handler.pkgs";
String newValue = "org.my.protocols";
if (System.getProperty(key) != null) {
    final String previousValue = System.getProperty(key);
    newValue += "|" + previousValue;
}
System.setProperty(key, newValue); 
```

使用这个类：

```
package org.my.protocols.classpath;

import java.io.IOException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLStreamHandler;

public class Handler extends URLStreamHandler {

    @Override
    protected URLConnection openConnection(final URL u) throws IOException {
        final URL resourceUrl = ClassLoader.getSystemClassLoader().getResource(u.getPath());
        return resourceUrl.openConnection();
    }
} 
```

因此，您可以获得最少干扰的方式来执行此操作。:) java.net.URL 将始终使用系统属性中的当前值。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-05-11T08:34:21.350

从 Java 9+ 起，您可以定义一个新的`URLStreamHandlerProvider`. 该类`URL`使用服务加载器框架在运行时加载它。

创建提供者：

```
package org.example;

import java.io.IOException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.net.spi.URLStreamHandlerProvider;

public class ClasspathURLStreamHandlerProvider extends URLStreamHandlerProvider {

    @Override
    public URLStreamHandler createURLStreamHandler(String protocol) {
        if ("classpath".equals(protocol)) {
            return new URLStreamHandler() {
                @Override
                protected URLConnection openConnection(URL u) throws IOException {
                    return ClassLoader.getSystemClassLoader().getResource(u.getPath()).openConnection();
                }
            };
        }
        return null;
    }

} 
```

`java.net.spi.URLStreamHandlerProvider`在目录中创建一个名为的文件`META-INF/services`，其内容为：

```
org.example.ClasspathURLStreamHandlerProvider 
```

现在，当 URL 类看到类似以下内容时，它将使用提供程序：

```
URL url = new URL("classpath:myfile.txt"); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-14T05:15:46.910

（类似于[阿兹德的回答](https://stackoverflow.com/questions/861500/url-to-load-resources-from-the-classpath-in-java/861522#861522)，但略有不同。）

我不相信类路径中的内容有预定义的协议处理程序。（所谓的`classpath:`协议）。

但是，Java 确实允许您添加自己的协议。这是通过提供具体的实现[`java.net.URLStreamHandler`](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLStreamHandler.html)和[`java.net.URLConnection`](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLConnection.html).

本文描述了如何实现自定义流处理程序： [http://java.sun.com/developer/onlineTraining/protocolhandlers/](http://java.sun.com/developer/onlineTraining/protocolhandlers/)。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-08-11T23:36:23.257

我创建了一个类，它有助于减少设置自定义处理程序时的错误，并利用系统属性，因此首先调用方法或不在正确的容器中没有问题。如果你弄错了，还有一个异常类：

```
CustomURLScheme.java:
/*
 * The CustomURLScheme class has a static method for adding cutom protocol
 * handlers without getting bogged down with other class loaders and having to
 * call setURLStreamHandlerFactory before the next guy...
 */
package com.cybernostics.lib.net.customurl;

import java.net.URLStreamHandler;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * Allows you to add your own URL handler without running into problems
 * of race conditions with setURLStream handler.
 * 
 * To add your custom protocol eg myprot://blahblah:
 * 
 * 1) Create a new protocol package which ends in myprot eg com.myfirm.protocols.myprot
 * 2) Create a subclass of URLStreamHandler called Handler in this package
 * 3) Before you use the protocol, call CustomURLScheme.add(com.myfirm.protocols.myprot.Handler.class);
 * @author jasonw
 */
public class CustomURLScheme
{

    // this is the package name required to implelent a Handler class
    private static Pattern packagePattern = Pattern.compile( "(.+\\.protocols)\\.[^\\.]+" );

    /**
     * Call this method with your handlerclass
     * @param handlerClass
     * @throws Exception 
     */
    public static void add( Class<? extends URLStreamHandler> handlerClass ) throws Exception
    {
        if ( handlerClass.getSimpleName().equals( "Handler" ) )
        {
            String pkgName = handlerClass.getPackage().getName();
            Matcher m = packagePattern.matcher( pkgName );

            if ( m.matches() )
            {
                String protocolPackage = m.group( 1 );
                add( protocolPackage );
            }
            else
            {
                throw new CustomURLHandlerException( "Your Handler class package must end in 'protocols.yourprotocolname' eg com.somefirm.blah.protocols.yourprotocol" );
            }

        }
        else
        {
            throw new CustomURLHandlerException( "Your handler class must be called 'Handler'" );
        }
    }

    private static void add( String handlerPackage )
    {
        // this property controls where java looks for
        // stream handlers - always uses current value.
        final String key = "java.protocol.handler.pkgs";

        String newValue = handlerPackage;
        if ( System.getProperty( key ) != null )
        {
            final String previousValue = System.getProperty( key );
            newValue += "|" + previousValue;
        }
        System.setProperty( key, newValue );
    }
}

CustomURLHandlerException.java:
/*
 * Exception if you get things mixed up creating a custom url protocol
 */
package com.cybernostics.lib.net.customurl;

/**
 *
 * @author jasonw
 */
public class CustomURLHandlerException extends Exception
{

    public CustomURLHandlerException(String msg )
    {
        super( msg );
    }

} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-04-21T18:52:20.150

灵感来自@Stephen [https://stackoverflow.com/a/1769454/980442](https://stackoverflow.com/a/1769454/980442) 和[http://docstore.mik.ua/orelly/java/exp/ch09_06.htm](http://docstore.mik.ua/orelly/java/exp/ch09_06.htm)

使用

```
new URL("classpath:org/my/package/resource.extension").openConnection() 
```

只需将此类创建到`sun.net.www.protocol.classpath`包中并将其运行到 Oracle JVM 实现中即可像魅力一样工作。

```
package sun.net.www.protocol.classpath;

import java.io.IOException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLStreamHandler;

public class Handler extends URLStreamHandler {

    @Override
    protected URLConnection openConnection(URL u) throws IOException {
        return Thread.currentThread().getContextClassLoader().getResource(u.getPath()).openConnection();
    }
} 
```

如果您使用另一个 JVM 实现，请设置`java.protocol.handler.pkgs=sun.net.www.protocol`系统属性。

仅供参考： [http ://docs.oracle.com/javase/7/docs/api/java/net/URL.html#URL(java.lang.String,%20java.lang.String,%20int,%20java.lang 。细绳）](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#URL(java.lang.String,%20java.lang.String,%20int,%20java.lang.String))

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-04-13T19:15:08.850

注册 URLStreamHandlers 的解决方案当然是最正确的，但有时需要最简单的解决方案。因此，我为此使用以下方法：

```
/**
 * Opens a local file or remote resource represented by given path.
 * Supports protocols:
 * <ul>
 * <li>"file": file:///path/to/file/in/filesystem</li>
 * <li>"http" or "https": http://host/path/to/resource - gzipped resources are supported also</li>
 * <li>"classpath": classpath:path/to/resource</li>
 * </ul>
 *
 * @param path An URI-formatted path that points to resource to be loaded
 * @return Appropriate implementation of {@link InputStream}
 * @throws IOException in any case is stream cannot be opened
 */
public static InputStream getInputStreamFromPath(String path) throws IOException {
    InputStream is;
    String protocol = path.replaceFirst("^(\\w+):.+$", "$1").toLowerCase();
    switch (protocol) {
        case "http":
        case "https":
            HttpURLConnection connection = (HttpURLConnection) new URL(path).openConnection();
            int code = connection.getResponseCode();
            if (code >= 400) throw new IOException("Server returned error code #" + code);
            is = connection.getInputStream();
            String contentEncoding = connection.getContentEncoding();
            if (contentEncoding != null && contentEncoding.equalsIgnoreCase("gzip"))
                is = new GZIPInputStream(is);
            break;
        case "file":
            is = new URL(path).openStream();
            break;
        case "classpath":
            is = Thread.currentThread().getContextClassLoader().getResourceAsStream(path.replaceFirst("^\\w+:", ""));
            break;
        default:
            throw new IOException("Missed or unsupported protocol in path '" + path + "'");
    }
    return is;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-14T04:16:13.760

我不知道是否已经有一个，但是您可以轻松地自己制作。

那个不同的协议示例在我看来就像一个门面模式。当每种情况有不同的实现时，您就有一个通用接口。

您可以使用相同的原理，创建一个 ResourceLoader 类，该类从您的属性文件中获取字符串，并检查我们的自定义协议

```
myprotocol:a.xml
myprotocol:file:///tmp.txt
myprotocol:http://127.0.0.1:8080/a.properties
myprotocol:jar:http://www.foo.com/bar/baz.jar!/COM/foo/Quux.class 
```

从字符串的开头剥离 myprotocol: ，然后决定以哪种方式加载资源，并为您提供资源。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-14T13:47:00.987

[Dilums 回答](https://stackoverflow.com/questions/861500/url-to-load-resources-from-the-classpath-in-java/861674#861674)的扩展：

在不更改代码的情况下，您可能需要按照 Dilum 的建议实现 URL 相关接口的自定义实现。为了简化您的工作，我建议您查看[Spring Framework 的 Resources](http://static.springframework.org/spring/docs/2.5.x/reference/resources.html)的源代码。虽然代码不是流处理程序的形式，但它的设计完全符合您的要求，并且在 ASL 2.0 许可下，使其足够友好，可以在您的代码中重用并获得应有的信任。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-02-01T05:31:50.377

在 Spring Boot 应用程序中，我使用以下内容获取文件 URL，

```
Thread.currentThread().getContextClassLoader().getResource("PromotionalOfferIdServiceV2.wsdl") 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-11-23T09:23:36.600

如果你在类路径上有tomcat，它很简单：

```
TomcatURLStreamHandlerFactory.register(); 
```

这将为“war”和“classpath”协议注册处理程序。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-09-29T19:13:50.137

我尽量避免`URL`上课，而是依靠`URI`. 因此，对于需要`URL`在没有 Spring 的情况下进行 Spring Resource 的事情，我会执行以下操作：

```
public static URL toURL(URI u, ClassLoader loader) throws MalformedURLException {
    if ("classpath".equals(u.getScheme())) {
        String path = u.getPath();
        if (path.startsWith("/")){
            path = path.substring("/".length());
        }
        return loader.getResource(path);
    }
    else if (u.getScheme() == null && u.getPath() != null) {
        //Assume that its a file.
        return new File(u.getPath()).toURI().toURL();
    }
    else {
        return u.toURL();
    }
} 
```

要创建 URI，您可以使用`URI.create(..)`. 这种方式也更好，因为您可以控制`ClassLoader`将进行资源查找的方式。

我注意到其他一些答案试图将 URL 解析为字符串以检测方案。我认为最好传递 URI 并使用它来解析。

[*实际上，我不久前已经向 Spring Source 提出了一个问题，请求他们将他们的资源代码从中分离出来，`core`这样你就不需要所有其他 Spring 的东西了。*](https://jira.spring.io/browse/SPR-12508)

# sql - 什么时候索引（在 DBMS 中）是坏索引？

> ID：861508
> 
> 赞同：10
> 
> 时间：2009-05-14T04:09:32.920
> 
> 标签：sql, indexing

谁能告诉我什么时候索引是坏索引？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T06:14:08.923

索引几乎无条件坏的一种情况是，如果有另一个索引使用相同的列（以*相同*的顺序）作为前缀：

```
CREATE INDEX ix_good ON SomeTable(Col1, Col2, Col3);
CREATE INDEX ix_bad  ON SomeTable(Col1, Col2); 
```

坏索引是对磁盘空间的浪费，并且减慢了修改操作，没有任何好处。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T04:17:07.487

如果从不搜索索引列并且表被大量更新，那么您将无法获得索引所带来的性能优势。相反，您可能会遭受性能打击。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-14T06:20:00.500

我之前链接过，我会再链接一次，因为它很棒：

[9 分半钟内的 SQL 索引，作者 Stephane Faroult。](http://www.youtube.com/watch?v=7ZgG7ttJTSc)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-14T08:56:52.977

使用索引要记住的一件重要事情（除了前面提到的“实际使用”部分）是选择性的概念。

在构建索引时，您希望在很有可能“高选择性”的列上创建索引。这需要对列中的数据有一定的了解（您可能有也可能没有，这取决于您对域的了解/样本数据的可用性）。

选择性 = 不同值的数量 / 总行数

让我们使用一个包含 Given_name、Surname、Gender、Age 列的“People”表

例如，在诸如 Gender（其中性别被限制为 NULL、M 或 F）之类的列上创建索引不会在查询期间提供太多好处（特别是如果查询已经因其他原因导致表扫描）。在任何情况下，该指数的选择性都会非常低。根据 DBMS，使用此索引实际上可能比全表扫描更糟糕。

但是，在（ Given_name ， Surname ）上创建复合索引将在对这些列执行查询时提供好处。该指数的选择性（对于大多数人群）会非常好。

具有选择性 1 的索引是理想的，但是，实现选择性 1 的唯一方法是在不可为空的列上具有唯一索引。

此外，请记住，您可以轻松编写查询来“跟踪”您的索引及其选择性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T06:33:49.997

拥有索引（结构的创建和维护）会对性能产生固有的影响。您通常希望该命中能够从更快的扫描中受益。当你没有得到好处时，它只是一个净损失，这是一个糟糕的指数。

可能的原因：

*   从未使用过索引
*   冗余索引
*   不经常扫描但不断更新的表（拥有索引的好处超过了好处，因为表很少被扫描）。
*   经常扫描并不断更新的表。在这种情况下，您可以获得索引和快速更新/插入的好处，方法是拥有一个用于插入/更新的无索引表和一个带有用于每天或每小时批量更新的扫描的索引的表（在某些情况下，这不会当然不行。如果在这种情况下遇到严重的性能问题，您需要获得更好的硬件或重新设计应用程序）。

如何找到你的坏索引？大多数 RDBMS 都有显示查询计划的选项，您可以在那里查看您设置的索引是否以您期望的方式使用。这使我得出最后的建议，考虑一下您的索引，永远不要创建一个“以防万一”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T06:36:13.190

如果您从不搜索索引，则索引很糟糕。例如，如果您从未在同一个查询中使用 Col1、Col2 和 Col3 进行搜索，则索引（Col1、Col2、Col3）是一种资源浪费。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T04:12:49.760

如果该字段从未使用过，则它是一个糟糕的索引（如果您觉得不必要的事情很糟糕。）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T04:39:25.453

索引是为了帮助我们更快地搜索行。

如果索引列*不用于搜索*，则定义它没有意义。

如果该列中的值***不断变化***，那么数据库服务器将需要额外的工作（用于重新索引）

如果表中的***插入和删除太多***，服务器将需要额外的工作

# java - Google 的 AppEngine - java.nio.BufferOverflowException

> ID：861510
> 
> 赞同：1
> 
> 时间：2009-05-14T04:10:00.437
> 
> 标签：java, google-app-engine, jsp

我正在使用 Google 的 AppEngine Java 支持。我有一组相当简单的 JSP 页面，今天查看日志，发现我从以下 JSP 文件中得到了 BufferOverflowException：

```
<%
response.sendRedirect("index.jsp");
%> 
```

我将文件简化为这个，但我仍然得到错误。有任何想法吗？

这是整个堆栈跟踪：

```
/logout.jsp
java.nio.BufferOverflowException
at java.nio.HeapByteBuffer.put(Unknown Source)
at java.nio.ByteBuffer.put(Unknown Source)
at com.google.apphosting.runtime.jetty.RpcResponseGenerator.addContent(RpcResponseGenerator.java:65)
at org.mortbay.jetty.AbstractGenerator$Output.write(AbstractGenerator.java:624)
at org.mortbay.jetty.AbstractGenerator$Output.write(AbstractGenerator.java:575)
at java.io.ByteArrayOutputStream.writeTo(Unknown Source)
at org.mortbay.jetty.AbstractGenerator$OutputWriter.write(AbstractGenerator.java:883)
at java.io.PrintWriter.write(Unknown Source)
at org.apache.jasper.runtime.JspWriterImpl.flushBuffer(JspWriterImpl.java:116)
at org.apache.jasper.runtime.PageContextImpl.release(PageContextImpl.java:190)
at org.apache.jasper.runtime.JspFactoryImpl.internalReleasePageContext(JspFactoryImpl.java:115)
at org.apache.jasper.runtime.JspFactoryImpl.access$100(JspFactoryImpl.java:37)
at org.apache.jasper.runtime.JspFactoryImpl$PrivilegedReleasePageContext.run(JspFactoryImpl.java:173)
at com.google.apphosting.runtime.security.shared.intercept.java.security.AccessController_.doPrivileged(AccessController_.java:31)
at org.apache.jasper.runtime.JspFactoryImpl.releasePageContext(JspFactoryImpl.java:73)
at org.apache.jsp.logout_jsp._jspService(logout_jsp.java:62)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:806)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)
at com.google.apphosting.runtime.jetty.SaveSessionFilter.doFilter(SaveSessionFilter.java:35)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:712)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)
at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.handle(AppVersionHandlerMap.java:237)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:139)
at org.mortbay.jetty.Server.handle(Server.java:313)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:506)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:830)
at com.google.apphosting.runtime.jetty.RpcRequestParser.parseAvailable(RpcRequestParser.java:76)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:381)
at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:125)
at com.google.apphosting.runtime.JavaRuntime.handleRequest(JavaRuntime.java:235)
at com.google.apphosting.base.RuntimePb$EvaluationRuntime$6.handleBlockingRequest(RuntimePb.java:4755)
at com.google.apphosting.base.RuntimePb$EvaluationRuntime$6.handleBlockingRequest(RuntimePb.java:4753)
at com.google.net.rpc.impl.BlockingApplicationHandler.handleRequest(BlockingApplicationHandler.java:24)
at com.google.net.rpc.impl.RpcUtil.runRpcInApplication(RpcUtil.java:359)
at com.google.net.rpc.impl.Server$2.run(Server.java:800)
at com.google.tracing.LocalTraceSpanRunnable.run(LocalTraceSpanRunnable.java:56)
at com.google.tracing.LocalTraceSpanBuilder.internalContinueSpan(LocalTraceSpanBuilder.java:510)
at com.google.net.rpc.impl.Server.startRpc(Server.java:756)
at com.google.net.rpc.impl.Server.processRequest(Server.java:348)
at com.google.net.rpc.impl.ServerConnection.messageReceived(ServerConnection.java:459)
at com.google.net.rpc.impl.RpcConnection.parseMessages(RpcConnection.java:319)
at com.google.net.rpc.impl.RpcConnection.dataReceived(RpcConnection.java:290)
at com.google.net.async.Connection.handleReadEvent(Connection.java:419)
at com.google.net.async.EventDispatcher.processNetworkEvents(EventDispatcher.java:762)
at com.google.net.async.EventDispatcher.internalLoop(EventDispatcher.java:207)
at com.google.net.async.EventDispatcher.loop(EventDispatcher.java:101)
at com.google.net.rpc.RpcService.runUntilServerShutdown(RpcService.java:251)
at com.google.apphosting.runtime.JavaRuntime$RpcRunnable.run(JavaRuntime.java:373)
at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T04:19:11.507

那是内部错误。除了提交错误报告并等待 Google 修复它之外，您对此无能为力。

一个[可能相关的错误](http://code.google.com/p/googleappengine/issues/detail?id=1429)已得到修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T05:25:06.480

如果这就是你的全部代码，那么这不是像 Thilo 所说的那样，提交错误报告并耐心等待......

# git - git - 删除了大文件，但结帐和 .pack 文件仍然很大

> ID：861514
> 
> 赞同：6
> 
> 时间：2009-05-14T04:12:11.133
> 
> 标签：git

我不小心将一堆大图像提交给了一个 git repo，这让事情变得缓慢。我删除了图像，但结帐仍然需要很长时间，并且 .git 文件是 300+MB。看起来 .pack 文件很大。

有什么办法可以清理这个吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T04:37:46.330

如果您进行了这样的提交，但没有将您的更改推送到任何其他存储库，那么使用`git-rebase`或更强大的[`git-filter-branch`](http://git-scm.com/docs/git-filter-branch). 但是，听起来您已经将这些大文件推送到上游。

如果这些更改已经在许多不同的存储库之间共享，尤其是那些已经应用了进一步工作的存储库，那么这可能很难在不造成中断的情况下进行清理。如果更改尚未被广泛共享，那么您可以使用类似`git-filter-branch`处理“主”存储库（无论是哪个）来删除大文件。然后，用您新创建的主存储库替换旧的主存储库，然后继续。您可能需要小心地将更改从这个新的主存储库拉入现有存储库，或者只是丢弃它们并进行新的克隆。

# c++ - 使用 C++ 编译器编译 C 代码会出现什么问题？

> ID：861517
> 
> 赞同：43
> 
> 时间：2009-05-14T04:14:03.533
> 
> 标签：c++, c, compiler-construction, migration, language-interoperability

如果您使用现有的 C 代码库并使用 C++ 编译器对其进行编译，您预计会出现什么样的问题？例如，我认为将整数分配给具有枚举类型的值在 C++ 中将失败，而在 C 中它是合法的（如果有点讨厌）。

如果我不将所有 C 文件都包装在 中`extern C { ... }`，我会在我最不期望的地方进行名称修改吗？我真的不应该这样做吗？

作为背景，我们有一个用 C 编写的非常大的代码库。几年来，我们一直在跳槽做一些通过 C++ 很自然的事情（例如，自制继承）。我们想开始转向 C++，但要循序渐进；让我们的类似 CORBA 的框架支持它，并在我们进行过程中重构模块以利用 C++ 提供的更自然的方法。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-14T04:29:56.410

我曾经做过一次这样的事情。正如您所怀疑的那样，问题的主要来源是 C++ 对类型更加严格。您必须在 void* 与其他类型的指针混合的地方添加强制转换。比如分配内存：

```
Foo *foo;
foo = malloc(sizeof(*foo)); 
```

以上是典型的 C 代码，但需要在 C++ 中进行转换：

```
Foo *foo;
foo = (Foo*)malloc(sizeof(*foo)); 
```

C++中有新的保留字，如“class”、“and”、“bool”、“catch”、“delete”、“explicit”、“mutable”、“namespace”、“new”、“operator”、 “or”、“private”、“protected”、“friend”等。例如，这些不能用作变量名。

当您使用 C++ 编译器编译旧的 C 代码时，上述问题可能是最常见的问题。有关不兼容性的完整列表，请参阅[ISO C 和 ISO C++ 之间](http://david.tribble.com/text/cdiffs.htm)的不兼容性。

您还询问名称修改。在没有 extern "C" 包装器的情况下，C++ 编译器*将*破坏符号。只要您*只*使用 C++ 编译器，并且不依赖 dlsym() 或类似的东西从库中提取符号，这不是问题。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-14T04:19:52.410

有关所有不兼容性的*非常*详细的列表，请参阅[ISO C 和 ISO C++ 之间的不兼容性。](http://david.tribble.com/text/cdiffs.htm)有很多微妙的问题，包括一些不会立即出现在编译器错误中的问题。例如，一个可能成为问题的问题是字符常量的大小：

 *```
// In C, prints 4\.  In C++, prints 1
printf("%d\n", sizeof('A')); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-14T10:57:05.683

*如果我不将所有 C 文件包装在“extern C { ... }”中，我会在我最不期望的地方进行名称修改吗？*

当您尝试将 C 和 C++ 链接在一起时，它会咬您一口。

我写了很多头文件，其中包含：

```
#ifdef __cplusplus
    extern "C" {
#endif

// rest of file

#ifdef __cplusplus
    }
#endif 
```

一段时间后，它会合并到现有的多包含样板中，而您将不再看到它。但是你必须小心你把它放在哪里——通常它属于你的任何包含你的标题*之后。*

*我真的不应该这样做吗？*

如果您确定您不会将 C 和 C++ 结合起来，那么据我所知，没有理由这样做。但是随着您描述的逐步迁移，对于任何具有 C 组件和 C++ 组件都需要使用的已发布接口的东西来说，这都是必不可少的。

*不*这样做的主要原因是它可以防止您重载函数（至少在那些标题中）。一旦您将所有代码迁移到 C++ 并开始维护/重构/扩展它，您可能会发现您想要这样做。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-16T16:10:31.797

一般来说，你根本不会遇到任何问题。是的，C 和 C++ 之间存在一些不兼容性，但它们似乎并不经常出现，除了上面提到的 malloc 强制转换，修复起来非常简单。

我已成功编译并使用以下开源 C 库作为 C++：

*   Expat XML 解析器
*   FreeType2 字体光栅化器
*   libjpeg：处理JPEG图像
*   libpng：处理PNG图像
*   Zlib 压缩库

最困难的部分是添加命名空间包装器，这需要几个小时，主要是因为#include 语句深埋在代码中，必须在 C++ 命名空间之外。

我为什么这样做？因为我卖的是人们直接链接到他们的应用程序的商业图书馆；有时他们的应用程序会链接到其他版本的 Expat、FreeType 等。这会导致多重定义符号错误。最干净的做法是将所有内容移到我的库中并将其隐藏在我的命名空间中。

但是，我并没有对我使用的所有开源库都这样做。有些还没有引起冲突，我还没来得及修复它们，虽然没有问题，但很乏味。有趣的例外是 SQLite，我无法用 C++ 编译它。因此，我进行了大量搜索和替换，为每个外部可见符号添加了前缀（我的产品名称）。这解决了我客户的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T05:23:20.433

另一个例子：在 C++ 中没有从整数到枚举的隐式转换，而在 C 中有一个。如果你真的想在 C++ 中进行转换，则需要强制转换。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-21T18:55:25.203

我在使用 MSVC 之前已经这样做了，如果使用 MSVC 一个好的策略是：

1.  将单个文件设置为 CPP 构建，这样您就可以逐步迁移到 CPP 编译器。
2.  使用 ctrl+f7 逐个文件处理以构建该文件。
3.  您可以创建模板版本，而不是强制转换所有 malloc

> foo = (Foo*)malloc(sizeof(*foo));

变成

```
foo = malloc<Foo>(); 
```

当然，对于需要 Foo+n 个字节的情况，您可以重载

我还建议在可能的情况下切换内存分配以使用 RAII，我发现某些功能非常复杂，因此切换到 RAII 风险太高，在大多数情况下它很简单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T06:47:27.767

C++ 具有更严格的类型检查，因此您可能需要在每次调用 malloc/realloc/calloc 时添加强制转换。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-04-19T06:12:49.453

尝试使用 C++ 编译器进行编译：

```
typedef enum{ false = 0, true = 1} bool; 
```

# iis - 如何通过 WMI 使用网络共享创建 IIS 虚拟目录

> ID：861527
> 
> 赞同：3
> 
> 时间：2009-05-14T04:18:32.523
> 
> 标签：iis, powershell, iis-6, wmi

我需要在指向网络共享**\\servername\sharename\directory**的 IIS 站点内创建一个虚拟目录，并且我需要为直通身份验证指定一个特定用户。

我正在使用 WMI 脚本来执行此操作，我打算从 Powershell 脚本中调用它。

虽然目标 IIS 环境是 IIS7（WMI 命名空间根/WebAdministration），但我更喜欢使用与 IIS6 兼容的 WMI 类（root\MicrosoftIISv2），因为脚本的其余部分已经适用于 IIS6。

我知道我可能可以使用 IIS7 powershell cmdlet 或 appcmd 来做到这一点，但我正在努力保持 IIS6 的兼容性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-17T13:29:37.480

```
## Settings
$siteName = 'Default Web Site'
$virtualDirectoryName = 'Test'
$physicalPath = '\\UNC-path'

## Init
$virtualDirectoryPath = "IIS:\Sites\$siteName\$virtualDirectoryName"

## Create Virtual Directory where physicalpath is an UNC-path (New-WebVirtualDirectory wont do)
New-Item $virtualDirectoryPath -type VirtualDirectory -physicalPath $physicalPath

## Change 'Connect As' settings (New-WebVirtualDirectory don't include Username and Password)
##userName must have the N capitalized
Set-ItemProperty $virtualDirectoryPath -Name userName -Value 'UserName'
Set-ItemProperty $virtualDirectoryPath -Name password -Value 'Password'

## Status
Get-Item -Path $virtualDirectoryPath | fl * 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T04:39:35.093

这两个链接应该让您朝着正确的方向前进：

[http://forum.installsite.net/index.php?showtopic=11333](http://forum.installsite.net/index.php?showtopic=11333)

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/cd02642c-8389-4563-9cd2-bae8a516c722.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/cd02642c-8389-4563-9cd2-bae8a516c722.mspx?mfr=true)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T07:46:51.617

这是我想出的两个替代的 powershell 函数。我更喜欢仅使用 WMI 的第二个函数，但 Powershell WMI 错误缺陷让我非常恼火，以至于我求助于使用 ADSI 接口。两者都包括在内以供参考。

```
function CreateUNCVirtualDirectory(
    [string]$siteName = $(throw "Must provide a Site Name"),
    [string]$vDirName = $(throw "Must provide a Virtual Directory Name"),
    [string]$uncPath = $(throw "Must provide a UNC path"),
    [string]$uncUserName = $(throw "Must provide a UserName"),
    [string]$uncPassword = $(throw "Must provide a password")
    ) {

    $iisWebSite = Get-WmiObject -Namespace 'root\MicrosoftIISv2' -Class IISWebServerSetting -Filter "ServerComment = '$siteName'"

    $objIIS = new-object System.DirectoryServices.DirectoryEntry("IIS://localhost/" + $iisWebSite.Name + "/Root")
    $children = $objIIS.psbase.children
    $vDir = $children.add($vDirName,$objIIS.psbase.SchemaClassName)
    $vDir.psbase.CommitChanges()
    $vDir.Path = $uncPath
    $vDir.UNCUserName = $uncUserName
    $vDir.UNCPassword = $uncPassword
    $vDir.psbase.CommitChanges()
}

function CreateUNCVirtualDirectory2(
    [string]$siteName = $(throw "Must provide a Site Name"),
    [string]$vDirName = $(throw "Must provide a Virtual Directory Name"),
    [string]$uncPath = $(throw "Must provide a UNC path"),
    [string]$uncUserName = $(throw "Must provide a UserName"),
    [string]$uncPassword = $(throw "Must provide a password")
    ) {

    $iisWebSite = Get-WmiObject -Namespace 'root\MicrosoftIISv2' -Class IISWebServerSetting -Filter "ServerComment = '$siteName'"

    $virtualDirSettings = [wmiclass] "root\MicrosoftIISv2:IIsWebVirtualDirSetting"
    $newVDir = $virtualDirSettings.CreateInstance()
    $newVDir.Name = ($iisWebSite.Name + '/ROOT/' + $vDirName)
    $newVDir.Path = $uncPath
    $newVDir.UNCUserName = $uncUserName
    $newVDir.UNCPassword = $uncPassword

    # Call GetType() first so that Put does not fail.
    # http://blogs.msdn.com/powershell/archive/2008/08/12/some-wmi-instances-can-have-their-first-method-call-fail-and-get-member-not-work-in-powershell-v1.aspx
    Write-Warning 'Ignore one error message:Exception calling "GetType" with "0" argument(s): "You cannot call a method on a null-valued expression."'
    $newPool.GetType()

    $newVDir.Put();
    if (!$?) { $newVDir.Put() }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-14T04:14:50.397

请参阅以下链接以使用 Windows 2008 中 IIS7 使用的“root\WebAdministration”命名空间获取对象：http: [//discovery.bmc.com/confluence/display/Configipedia/Microsoft+Internet+Information+Services](http://discovery.bmc.com/confluence/display/Configipedia/Microsoft+Internet+Information+Services)

## 使用 WMI 在 Windows 2008 服务器上检查网站和应用程序池状态的代码：

```
Public Sub WebsiteAppPoolStatusCheckIISv7(ByVal computer As String, ByVal userName As String, ByVal password As String)
    Dim thisServer = System.Configuration.ConfigurationManager.AppSettings("ThisServer")
    Dim excludedWebSiteOrAppPool = System.Configuration.ConfigurationManager.AppSettings("ExcludedWebSiteOrAppPool")
    Dim WbemAuthenticationLevelPktPrivacy = 6
    Dim objSWbemLocator = CreateObject("WbemScripting.SWbemLocator")
    Dim objWMIService As Object
    If (computer = thisServer) Then
        objWMIService = objSWbemLocator.ConnectServer(computer, "root/WebAdministration")
    Else 'for remote servers
        objSWbemLocator.Security_.AuthenticationLevel = WbemAuthenticationLevelPktPrivacy
        objWMIService = objSWbemLocator.ConnectServer(computer, "root/WebAdministration", userName, password)
    End If
    'Code Start for Website status check
    Dim websites = objWMIService.ExecQuery("SELECT * FROM Site")
    For Each website As WbemScripting.SWbemObject In websites
        Dim WebSiteName = website.Name
        Dim webSiteStatus As String
    If (Convert.IsDBNull(website.GetState)) Then
            webSiteStatus = "Unknown"
        Else
            Select Case website.GetState
                Case 0
                    webSiteStatus = "Starting"
                Case 1
                    webSiteStatus = "Running"
                Case 2
                    webSiteStatus = "Stopping"
                Case 3
                    webSiteStatus = "Stopped"
                Case Else
                    webSiteStatus = "Unknown"
            End Select
        End If
    logFile.writeline("Server:= " & computer & ", WebSiteName:= " & WebSiteName & ", Status:= " & webSiteStatus)
    Next
    'Code Start for App pool status check
    Dim appPools As WbemScripting.SWbemObjectSet
    appPools = objWMIService.ExecQuery("Select * from ApplicationPool")
    'Iterate all the appPools of the server
    For Each appPool As WbemScripting.SWbemObject In appPools
        Dim appPoolName = appPool.Name
        Dim appPoolStatus As String
        If (Convert.IsDBNull(appPool.GetState)) Then
            appPoolStatus = "Unknown"
        Else
            Select Case appPool.GetState
                Case 0
                    appPoolStatus = "Starting"
                Case 1
                    appPoolStatus = "Running"
                Case 2
                    appPoolStatus = "Stopping"
                Case 3
                    appPoolStatus = "Stopped"
                Case Else
                    appPoolStatus = "Unknown"
            End Select
        End If
    logFile.writeline("Server:= " & computer & ", AppPoolName:= " & appPoolName & ", Status:= " & appPoolStatus)
    Next
End Sub 
```

* * *

# c++ - 让程序员在运行时修改程序中的所有变量，聪明的想法？

> ID：861532
> 
> 赞同：1
> 
> 时间：2009-05-14T04:19:39.057
> 
> 标签：c++, debugging, console

我正在考虑用 C++ 来做这件事，基本上来自外部编辑器或程序员可以说的东西： MyClass::dude = "hello" 其中 'dude' 是 'MyClass' 中的静态整数。

程序在运行时所做的是将输入划分为 MyClass :: dude = "hello" 并找到名为“MyClass”的类并将其中的 dude 变量分配为“hello”。

它背后的想法是让它充当一种运行时调试器。

这是安全/理智的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T05:03:59.263

是的，这是在开发过程中用于帮助微调游戏的典型工具。它不像你在屏幕上输入的那样频繁，你可以在其中使用控制器动态调整变量（这会在后台更改一些类变量），但对于电脑游戏，没有理由你不能'不要输入一些东西，特别是如果它是文本。当然，您需要编写自己的系统，其中一个类通知引擎的某些部分它的名称以及如何获取它的一些变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T05:03:56.970

您的典型调试器已经可以对所有基本类型执行此操作。

分配一个 char 字符串值有点复杂，因为它需要为实际字符串分配内存并将指向它的指针分配给变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T08:11:25.740

最好的办法是使用 Boost::python 之类的东西，并集成真正的脚本语言。这比构建自己的迷你语言要少得多。例如，它已经知道如何处理诸如“MyClass::dude = "hello" 之类的问题语句，其中 'dude' 是 'MyClass' 中的**静态整数**。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T08:38:35.533

虽然不是一个非常优雅的解决方案，但我有时会包装静态版本的变量，我需要通过调试器即时更改这些变量以调整内容，然后在完成时注释掉相应的#define，如果加载时间特别有用很长，它只是你需要调整的几个变量来测试一些东西。但是对于这样的事情，您可能应该考虑可以在运行时重新加载的数据文件

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-14T04:40:51.127

描述不是很清楚，能说清楚吗？这是程序运行时应该发生的事情吗？或者它会使用变量运行它吗？

C++ 和 Java 之间的区别之一是类名并没有真正用于可执行程序中（除非它是专门为调试而编译的）。因此，程序无法让正在运行的 C++ 程序在该程序中专门找到一个变量。

无论哪种方式，如果不使用足够的信息和功能来编译“调试”程序来执行此操作，这并不实用，但不清楚您要做什么。

我也不清楚这与继承有什么关系（你的问题的标题）。

# eclipse - Eclipse 作为应用程序框架 (RCP) 的成功案例

> ID：861536
> 
> 赞同：4
> 
> 时间：2009-05-14T04:21:02.500
> 
> 标签：eclipse, eclipse-rcp, rcp

我一直在阅读有关[Eclipse 作为应用程序框架的](http://electronicdesign.com/Articles/ArticleID/11885/11885.html)内容（即有关[Eclipse Rich Client Platform](http://www.eclipse.org/home/categories/rcp.php)的内容）。除了作为非常流行的 IDE 的 Eclipse 之外，我找不到作为应用程序框架 (RCP) 的 Eclipse 成功案例的完整列表。我见过[Netbeans 平台的客户推荐](http://platform.netbeans.org/articles/diff-nb-eclipse.html)，但不是 Eclipse 富客户端平台。

Eclipse 作为商业和开源世界中的应用程序框架（富客户端平台）有哪些案例研究或成功案例？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T04:49:15.397

我可以使用 RCP 作为客户端平台添加我自己的[成功故事。](http://www.moonlit-software.com)In 的学习曲线很慢，但一旦掌握，就会有巨大的好处。尤其 ：

*   平台中立。它在 windows 和 linux 上运行良好，到处都没有什么惊喜，但总的来说到目前为止它还是很棒的。
*   内置更新管理，非常适合版本发布和修复。
*   它可以很好地扩展，添加新功能几乎是无痛的。
*   作为一个平台而不仅仅是一个 GUI 库，它提供了很多好处。

缺点：

*   并非每个应用程序都适合 eclipse 哲学和视图/编辑器范例。
*   初学者比较难
*   完成简单的任务可能太麻烦了
*   与其他替代方案相比，文档不是最好的，社区相当小。

总的来说，我不后悔选择它。我个人讨厌基于网络的笨拙和执行缓慢的界面。在这里，您拥有与桌面自然集成的原生、快速且响应迅速的 GUI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T05:57:02.723

以下是基于 Eclipse 富客户端平台构建的开源产品列表：http: [//www.eclipse.org/community/rcpos.php](http://www.eclipse.org/community/rcpos.php)

商业产品： http: [//www.eclipse.org/community/rcpcp.php](http://www.eclipse.org/community/rcpcp.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T04:41:01.237

我的公司使用 Eclipse RCP 框架非常成功地创建了一个飞机任务规划系统。这并非没有麻烦（主要是您应该使用的新接口在很多时候都没有很好的文档记录），但它确实给了我们很大的帮助并提供了很多有用的架构。

在许多方面，我们只是一个编辑器，但不是文本文件，您正在修改描述飞机任务的数据库，并且许多交互是通过视图中显示的 3D 地球。数据绑定有助于使各种视图和编辑器始终保持同步（尽管 SWT 应用程序和第三方 AWT 小部件之间通过数据绑定调用的线程问题是一场噩梦，我不想再谈了）

这是一个复杂的程序，基本上需要三个不了解 Eclipse 的开发人员花了大约一年的时间来编写。今天，我们通过添加更多插件为其他客户扩展它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T04:57:21.540

看看[XMind](http://www.xmind.net/)。它是基于 RCP 的思维导图应用程序。我知道一些经验丰富的用户根本没有意识到这是一个 Java 应用程序。它看起来不错。

# asp.net - 什么时候禁用视图状态是安全的？

> ID：861537
> 
> 赞同：5
> 
> 时间：2009-05-14T04:21:05.857
> 
> 标签：asp.net, viewstate

什么时候禁用视图状态是安全的？针对哪些控件？在什么情况下？

在用户控件中，我禁用了视图状态，但是如果我尝试单击此控件

```
<asp:LinkButton ID="LinkButton1" runat="server" 
  CommandName="Delete" 
  OnClientClick="return confirm('¿Está seguro que desea eliminar el mensaje?');"
  EnableViewState="true">
    <asp:Image ID="ImageButton1" runat="server" ImageUrl="~/Content/Images/delete.png" 
        ToolTip="Eliminar mensaje" /> Eliminar 
</asp:LinkButton> 
```

我得到一个 System.InvalidOperationException 异常。它位于 ListView 内。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T04:26:38.073

它归结为您是否希望页面在回发中记住事情。如果您不需要在每个回发视图状态上重新创建或分配值

[这里](http://learnitfromvince.blogspot.com/2008/04/when-to-disable-and-enable-viewstate-on.html)有一些很好的指示

> 在控件上动态插入值（通过绑定或以编程方式分配）– 此控件的值在重新呈现时将不会保留，例如从 view1 切换到 view2。但是您必须考虑两件事，如果您认为重新填充每个渲染的值很难实现，那么不要禁用视图状态，如果不是，那么您可以禁用它并重新初始化渲染事件的控件。我为什么建议这个？这是因为处理服务器端代码比在往返中将大量垃圾数据传输回服务器和客户端要快得多。
> 
> On Datalist 和 DropDownList – 如果您没有使用 OnSelectedIndex Change 事件，那么您可以禁用视图状态。
> 
> 在 Gridviews 上——这是决定是禁用视图状态还是保留它的最困难的部分。如果您只是在其上显示数据或什至仅将其用于选择，则禁用视图状态。如果您正在使用分页、编辑或删除功能，请不要这样做。Gridview 具有最大的视图状态容量，因此您应该明智地使用它。如果您必须更新多达 5 列，那么为什么不直接打开另一个视图然后设置要更新的值，而不是直接在 gridview 上更新它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T04:25:20.213

大多数控件的行为与您在禁用视图状态时所期望的一样。具有像 Gridviews 这样的内置功能的更“动态”的控件在没有视图状态的情况下往往不能很好地发挥作用。

鉴于您在控件上将 enableviewstate 属性设置为 true，您确定异常与视图状态有关吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T04:25:35.953

您可以随时禁用视图状态。如果需要，您必须找到其他方法来维护页面的状态。方法是使用隐藏表单字段的老式方法。

只要您不将大型复杂对象放入视图状态，通常就没有理由禁用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T06:05:53.840

如果您使用的是 .net framework 2.0 或更高版本的框架，那么您可以使用称为控制状态的新功能而不是视图状态。与视图状态相比，它在性能方面要快得多。

更多详情请查看以下网站...

[http://www.pluralsight.com/community/blogs/fritz/archive/2004/07/01/472.aspx](http://www.pluralsight.com/community/blogs/fritz/archive/2004/07/01/472.aspx)

[http://msdn.microsoft.com/en-us/magazine/cc163901.aspx](http://msdn.microsoft.com/en-us/magazine/cc163901.aspx)

[http://www.codeproject.com/KB/user-controls/TestControlStateEx.aspx](http://www.codeproject.com/KB/user-controls/TestControlStateEx.aspx)

# file-io - 读取与写入时间

> ID：861540
> 
> 赞同：9
> 
> 时间：2009-05-14T04:23:47.847
> 
> 标签：file-io, io

哪个操作更耗时 - 从磁盘读取或写入磁盘以获得相同数量的数据和相同的内存位置？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-14T04:55:48.190

这实际上是一个相当复杂的问题，它需要了解您的 I/O 系统是如何设置的。您引用的简单示例（将固定数量的数据读取/写入磁盘上的特定位置）并不像您想象的那么现实。以下是可能影响 I/O 性能的因素的简短摘要。

1.  **磁盘速度**
    硬盘速度通常以转速（*rpm*或每分钟转数）表示，它告诉您盘片在驱动器内旋转的速度。典型值为 5400 至 10,000rpm。 [典型的传输速率](http://en.wikipedia.org/wiki/Hard_disk_drive#Capacity_and_access_speed)为 1-1.6 GBit/秒，并且可以维持高达 125 MB/秒的传输速率。

    [请记住，延迟](http://en.wikipedia.org/wiki/Latency_(engineering))和[吞吐量](http://en.wikipedia.org/wiki/Throughput)之间存在差异。如果您将非常小的数据块写入驱动器上的不同位置，则取决于驱动器的延迟（[寻道时间](http://en.wikipedia.org/wiki/Seek_time)、[旋转延迟](http://en.wikipedia.org/wiki/Rotational_delay)和访问时间）。但是，如果您一次传输大量数据，您可能更依赖于吞吐量。您的文件系统决定了文件在磁盘上的布局方式，它可能会尝试针对此类事情进行优化（见下文）。

    要考虑的另一件事是，您可以（大多数企业都这样做）在[RAID](http://www.faqs.org/docs/linux_admin/buffer-cache.html)配置中使用多个驱动器获得更快的传输速率。RAID 驱动器的吞吐量取决于您选择的条带化、镜像和奇偶校验的组合。查看[Wikipedia 文章](http://en.wikipedia.org/wiki/Redundant_array_of_independent_disks#Standard_levels)以了解所有细节。参数太多，这里无法完整解释。

2.  **缓存**
    Modern OS 与磁盘驱动器交互时的精心安排。在您的程序和物理磁盘之间可能有几层缓存，因此您作为应用程序程序员所看到的性能可能更多地取决于您的操作系统如何处理数据，而不是驱动器的实际性能。

    今天的大多数操作系统都使用[缓冲区缓存](http://www.faqs.org/docs/linux_admin/buffer-cache.html)，以便将磁盘中的数据保存在内存中，并且操作系统可以在与磁盘通信时进行调度。应用程序的写入看起来很快，因为它们可以直接进入内存，并且操作系统可以等待刷新缓冲区，直到它无事可做。在实践中，操作系统会以相当及时的方式尝试刷新写入，因此电源故障不会杀死您的所有数据。因此，虽然有可用的缓冲区空间，但写入速度似乎很快。如果您填满了缓冲区高速缓存，或者如果操作系统没有多少可用内存可供使用，您可能会看到 I/O 性能下降，因为操作系统必须更频繁地刷新缓冲区。

    读取速度与写入速度一样，取决于数据的缓存方式。当今大多数硬盘驱动器都具有可以提高持续传输速率的硬件缓存。同样，操作系统使用缓冲区缓存来存储您访问过的文件。如果看起来可能需要，它们中的任何一个都可以使用一些预取策略来提前从驱动器中获取数据。使用缓存，初始读取可能会很慢，但如果要读取的数据已经在某处的缓存中，则后续读取（尤其是对同一事物的读取）将花费更少的时间。

3.  **文件系统**
    最后，还有要考虑的[文件系统。](http://en.wikipedia.org/wiki/File_system)一个大写可能不会都去同一个地方，所以在估计需要多长时间时不能简单地考虑你的传输速率。文件在磁盘上并不总是连续的，您的文件系统必须计算它们应该如何布局，这可能会根据可用空间的大小和磁盘的[碎片程度极大地影响性能。](http://en.wikipedia.org/wiki/Fragmentation_(computer))

读/写性能将归结为上述所有影响以及您在驱动器上放置的工作负载特征（数据大小、读写频率*等*）的组合。与大多数事情一样，您需要对您的应用程序、您打算在其中运行的操作系统以及您的特定磁盘配置进行试验，以便对它的执行方式有一个实际的了解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T04:31:58.387

简短的回答：这取决于很多。

从应用程序级别来看，写入通常看起来更快。因为您实际上只是要求操作系统写入数据，并且操作系统可能会快速返回并在空闲时写入数据。通过读取，您必须等待操作系统将您想要的数据返回给您。

文件系统会极大地影响读取和写入的速度......通常在写入时需要做更多的内务处理，但如果您要附加到可能会更快的文件。

大多数固态磁盘的写入速度要比读取速度慢得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T04:42:30.843

缓冲区会极大地影响读写时间。缓冲区可以由操作系统在 RAM 中维护，许多驱动器还包含作为磁盘控制器一部分的内部缓冲区。

考虑到操作系统可能会在 RAM 中缓存文件的某些部分，以便可以非常快速地完成对这些部分的读取。此外，操作系统可能会在 RAM 中缓存写入，直到有足够的量写入磁盘。仅将数据复制到另一个内存区域后，可能会返回对“写入”函数的调用。

简而言之，如果您需要将位写入磁盘（使用刷新操作或类似操作），那么此操作将至少与从磁盘读取未缓存的时间一样长，可能更长。

# c# - 如何使用 Microsoft.WindowsMo bile.PocketOutlook 阅读邮件标题？

> ID：861541
> 
> 赞同：1
> 
> 时间：2009-05-14T04:24:41.277
> 
> 标签：c#, email, windows-mobile

我想在 Windows Mobile 的 PocketOutlook 中获取电子邮件的标题。

我在[MSDN](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.pocketoutlook.emailmessage.subject.aspx)中进行搜索，发现我可以使用**Microsoft.WindowsMo** ​​bile.PocketOutlook命名空间**——EmailMessage类——****主题**属性应该可以帮助我获取电子邮件标题。

但是当我写

```
 using Microsoft.WindowsMobile.PocketPC; 
```

错误表明**命名空间“Microsoft”中不存在类型或命名空间名称“WindowsMo​​bile”（您是否缺少程序集引用？）**

可能是什么问题？是否可以通过这种方式获取电子邮件的标题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T04:34:46.633

您必须添加对`Microsoft.WindowsMobile.PocketOutlook`程序集的引用。

# vb.net - 将文本框聚焦在最右边的数字

> ID：861544
> 
> 赞同：0
> 
> 时间：2009-05-14T04:25:29.307
> 
> 标签：vb.net

我如何在 vb.net 中编码：

**聚焦文本框并将光标移到最右边的数字？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T04:54:44.713

在 WindowsForm 中，您可以使用：

```
Me.TextBox1.Focus()
Me.TextBox1.SelectionStart = TextBox1.Text.Length 
```

在 WebForm 中，您可以使用这样的 javascript 函数设置焦点：

```
function setCursorPosition(elemId, cursorPosition) {
    var element = document.getElementById(elemId);
    if(element != null) {
        if(element.selectionStart) {
            element.focus();
            element.setSelectionRange(cursorPosition, cursorPosition);
        }
        else
            element.focus();
    }
} 
```

# scroll - 如何平滑滚动 SWT 复合？

> ID：861546
> 
> 赞同：3
> 
> 时间：2009-05-14T04:25:47.420
> 
> 标签：scroll, swt, scrolledcomposite

我正在使用 SWT ScrolledComposite，但是当我在 Windows 中滚动时，如果我滚动到快，我会出现一些撕裂/闪烁。我可以做些什么来加倍缓冲或减少这种效果，或者我可以做些什么来覆盖默认滚动功能并使其滚动更顺畅？滚动区域中有文本框，所以我认为画布不会起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-01-31T18:08:04.890

诀窍是延迟播放并使用单像素滚动。

以下是我实际执行此操作的部分代码：

```
public void scrollOnePixelUp() {
    scrolledComposite.getContent().setLocation(0, scrolledComposite.getContent().getLocation().y - 1);
}

public void scrollOnePixelDown() {
    scrolledComposite.getContent().setLocation(0, scrolledComposite.getContent().getLocation().y + 1);
}

private int pixelScrollDelay = 50;//ms

scrollingThread = new Thread() {
    public void run() {
        doScrolling = true;
        int i = 0;
        while((i < scrollLength) && running && doScrolling) {
            i++;

            if (d.isDisposed())
                return;
            d.asyncExec(new Runnable() {
                public void run() {
                    if (scrollUp)
                        scrollOnePixelUp();
                    else
                        scrollOnePixelDown();
                }                       
            });

            try {
                sleep(pixelScrollDelay);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        doScrolling = false;
    }
}; 
```

希望有帮助！

# iphone - 为 UITextField 的 didEndOnExit 事件分配方法

> ID：861550
> 
> 赞同：7
> 
> 时间：2009-05-14T04:26:42.143
> 
> 标签：iphone, cocoa-touch, uitextfield

如何以编程方式将方法（观察者？）分配给对象的`didEndOnExit`事件`UITextField`？

这在 IB 中很容易做到，但我不知道如何在代码中做到这一点。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-14T04:47:07.213

我刚刚想通了...

```
[mytextField addTarget:self 
        action:@selector(methodToFire:)
        forControlEvents:UIControlEventEditingDidEndOnExit]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T04:35:44.477

在您的视图控制器中实现以下方法：

```
- (void)textFieldDidEndEditing:(UITextField *)textField{

//do stuff

} 
```

不要忘记在 viewDidLoad 或初始化器中设置委托：

```
myTextField.delegate = self; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-14T17:41:35.883

对于任何考虑使用此目标来使另一个文本字段成为FirstResponder 以创建一个“下一步”按钮选项的人来说，感觉就像您正在通过文本字段“跳动”一样，我建议使用 textFieldShouldReturn 代替这样的代码。让我告诉你它的效果很好，你会觉得你在骑独角兽：

```
 -(BOOL)textFieldShouldReturn:(UITextField *)textField{
    [textField resignFirstResponder];

    if([textField isEqual:_textField1]){
        [_textField2 becomeFirstResponder];
        return NO;
    }else if([textField isEqual:_textField2]){
        [_textField3 becomeFirstResponder];
        return NO;
    }

    return YES;
} 
```

# c# - 我应该何时打开和关闭与 SQL Server 的连接

> ID：861552
> 
> 赞同：38
> 
> 时间：2009-05-14T04:27:03.360
> 
> 标签：c#, .net, sql, data-binding, sqlconnection

我有一个简单的静态类，其中包含一些方法。这些方法中的每一个都打开一个 SqlConnection，查询数据库并关闭连接。这样，我确信我总是关闭与数据库的连接，但另一方面，我不喜欢总是打开和关闭连接。下面是我的方法的示例。

```
public static void AddSomething(string something)
{
    using (SqlConnection connection = new SqlConnection("..."))
    {
        connection.Open();
        // ...
        connection.Close();
    }
} 
```

考虑到方法在静态类中，我应该有一个包含单个 SqlConnection 的静态成员吗​​？我应该如何以及何时放弃它？最佳实践是什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-14T04:31:00.277

`SqlConnection`不，除非必须，否则不要保持静态。线程将是一个问题，但更重要的是 - 通常您根本不需要。使用您提供的代码，内部连接池意味着大多数时候您将在连续调用中获得相同的底层连接（只要您使用相同的连接字符串）。让 pooler 完成它的工作；不理会代码。

这也避免了当您开始拥有两个线程时发生的问题......现在每个线程都可以在自己的连接上工作；使用静态（假设你不使用`[ThreadStatic]`）你必须同步，引入延迟。更不用说重入（即一个线程试图同时使用同一个连接两次）。是的; 不理会代码。现在很好，几乎你所做的任何改变都会让它变得不好。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-14T04:31:06.797

因为当您调用 Open() 和 Close() 时 SqlConnection 有一个连接池，所以您实际上并没有打开和关闭与服务器的物理连接。您只是从可用连接池中添加/删除连接。出于这个原因，在执行命令后尽可能晚地打开连接并尽早关闭连接是一个很好的最佳实践。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T04:36:07.783

在您的代码示例中，无需在连接对象上调用 close() 方法，因为由于代码位于 using 块内，它将自动处理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T04:30:07.720

大多数程序员都相信迟开早关。如果每次打开和关闭连接的延迟都会导致整个应用程序变慢，这只是一个问题。

在您使用静态类的情况下，最好每次都打开和关闭连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T04:30:32.587

你正在做最佳实践。仅在您要查询它之前打开它，并尽快关闭它。这种事情一开始可能看起来很浪费，但从长远来看，它实际上会让你的应用程序更具可扩展性。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-04-30T02:21:05.747

永远不要依赖连接自行关闭。如果没有明确关闭，则会导致性能问题。它发生在我们的项目中。是的，我知道连接是由连接池管理的，但它们仍然必须关闭并返回到池中。

# c# - 可以安全地假设所有由 new 初始化的 C# 变量都是引用吗？

> ID：861555
> 
> 赞同：2
> 
> 时间：2009-05-14T04:29:19.987
> 
> 标签：c#, reference, ref

我现在正在学习 C# refs。

假设所有分配有 new 的变量都是引用而不是值是否安全？

例子：

```
SomeType variable = new SomeType() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T04:35:14.683

不：

*   类的实例是引用，但结构的实例是值。
*   类和结构都可以使用 new 构造

例如，`System.Drawing.Point`is a `struct`not a `class`：

```
Point point = new Point(1, 1); //point is a value, not a reference 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T04:37:02.463

C# 有两种类型的对象 - 引用类型（使用 class 关键字定义）和值类型（使用 struct 关键字定义）。

*   RT 在托管堆上创建。当您在 RT 上执行 new() 时，您会返回对堆上对象的引用。两个 RT 变量可以指向同一个对象。
*   VT 在堆栈上创建（除非它们是引用类型中的字段）。当您在 VT 上执行 new() 时，您会得到一个指向堆栈上对象开头的变量。两个值类型变量不能指向同一个对象——它们总是堆栈上的两个不同对象。[然而，这是一个实现细节，重要的是要记住 VT 具有值类型语义。](http://blogs.msdn.com/ericlippert/archive/2009/04/27/the-stack-is-an-implementation-detail.aspx)

拿起一本关于 C# 的好书了解更多细节。它是一个重要的概念。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T04:32:24.783

不，值类型不是引用。

但是对于任何其他非值类型和“ref/out”参数，它们都是引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T04:32:50.477

不。在 C# 中，结构也使用 new() 进行实例化，但被视为值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T04:33:27.977

看起来您将引用与对象混淆了。如果是这种情况，那么使用 new 关键字创建的类型是对象。被视为值的结构除外。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T04:33:56.557

不必要。随着您对 C# 的深入了解，您会发现有类（引用类型）和结构（值类型）。它们都通过使用'new'关键字来实例化，但结构的实例不是引用。

# tcp - MSMQ 适用于 TCP 还是 UDP？

> ID：861559
> 
> 赞同：6
> 
> 时间：2009-05-14T04:30:35.630
> 
> 标签：tcp, udp, msmq

我想知道 MSMQ（Microsoft 消息队列）在 TCP 或 UDP 上工作吗？在哪些端口上？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T04:34:36.133

此 KB 详细说明使用了哪些端口和协议：http: [//support.microsoft.com/default.aspx ?scid=kb;EN-US;178517](http://support.microsoft.com/default.aspx?scid=kb;EN-US;178517)

> 以下端口用于 Microsoft 消息队列操作： TCP：1801 RPC：135、2101*、2103*、2105* UDP：3527、1801 以下是消息队列 3.0 的新增功能：
> 
> 虽然消息队列使用产品早期版本中使用的相同端口，但消息队列还引入了 TCP 端口 389。对于直接针对 Active Directory 进行的 MQIS 查询，必须打开 TCP 端口 389。此外，Message Queuing 3.0 引入了 HTTP Messaging，它要求为 Message Queuing 虚拟目录指定的端口也必须打开。
> 
> 此信息对于解释以下内容很有用： Netstat -a 输出 网络跟踪 配置防火墙

# html - Adobe AIR HTML 开发套接字参考怎么了？

> ID：861563
> 
> 赞同：0
> 
> 时间：2009-05-14T04:31:56.517
> 
> 标签：html, sockets, reference, air

我正在尝试协调各种 Adob​​e AIR HTML 指南，但完全迷失了方向。我想用套接字做点什么。

[此处](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7caf.html)和[此处](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=4&postId=10567)有关该主题的一些一般指南请参阅`Air.Socket();`但所谓的[Adob​​e AIR HTML 参考](http://help.adobe.com/en_US/AIR/1.5/jslr/flash/net/Socket.html)看起来甚至不是 JavaScript，它引用的命名空间 ( `window.runtime.flash.net.Socket`) 在 Adob​​e AIR HTML 文档的其他任何地方都从未出现过。我已经使用 Flex 完成了一些工作，这里的这些文档看起来像是针对 Flex 的，而不是针对 JavaScript 的。如果所有引用都是针对 Flex 的，我应该如何知道我要使用的功能在哪里以及它的名称是什么？

是否有任何有用的**参考**文档可以告诉我`Air.*`命名空间中的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T04:49:27.987

啊想通了。因此，我打开了为 HTML 开发人员提供的随附的 AIRAliases.js 文件，它将引用中的命名空间映射到 AIR 的命名空间。

# .net - 是否可以将 .NET Reactor 与 ClickOnce 部署一起使用？

> ID：861577
> 
> 赞同：2
> 
> 时间：2009-05-14T04:36:43.743
> 
> 标签：.net, encryption, clickonce, protection, net-reactor

阅读[这篇文章](https://stackoverflow.com/questions/583427/net-reactor-clickonce-deployment)并遇到同样的问题后（​​尝试构建清单时）：

```
MSB3171: Problem generating manifest. Could not load file or assembly or one of its dependencies. An attempt was made to load a program with an incorrect format. 
```

我想知道是否*有人*成功使用 .NET Reactor（加密/混淆工具）和 ClickOnce 部署。我整个早上都在网上搜寻不同的技术，有些技术适用于 Dotfuscator 和 Xenocode，所以我阅读了，但我无法从 .NET Reactor 获得任何爱。

我真的认为收到此消息是因为 ClickOnce 正在尝试针对加密文件生成清单（其中甚至无法在 .NET Reflector 中打开）...

我在这里有什么选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-30T12:13:47.940

我们在使用 ClickOnce 和 .NET Reactor 时遇到了同样的问题。我们拒绝混淆。

是的，你是对的。ClickOnce 需要从文件中提取程序集版本、它的依赖项、制造商等。ClickOnce 正在尝试加载一个在混淆完成后不再是该程序集的程序集。它现在是一个常规的二进制 .exe 文件。

有一个糟糕的解决方法对我来说效果很好，但项目管理拒绝了这个想法。

构建并混淆所有二进制文件。在 AfterBuild 事件的基础上将它们打包到一个 zip（或其他）文件中。将您的 zip 标记为“数据文件”（项目设置 -> 发布 -> 应用程序文件... -> 发布状态 -> 数据文件）。之后创建单个未混淆的可执行 (.exe) 程序集。它只是解压缩并运行您的混淆可执行文件之一。为该新可执行文件设置 ClickOnce 发布部署。

编辑：请问我是否不够清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-12T14:28:20.877

如果出现清单部署问题，您需要禁用默认启用的“注入无效元数据”选项。命令行参数如下：

-invalid_metadata 0

或者，您可以通过以下方式禁用“Anti ILDASM”（因为“Inject Invalid Metadata”是一个子选项）：

-抑制 0

当然，如果您定义了 .NET Reactor 项目文件，则无需使用命令行参数。

为了保护 ClickOnce 项目，建议通过以下方式使用 .NET Reactor Visual Studio 插件：

*   打开 .NET Reactor 并安装 Visual Studio 插件（.NET Reactor 主菜单项帮助 -> 安装 Visual Studio 20xx 插件）。
*   打开您的 Visual Studio 项目并打开加载项（Visual Studio 主菜单项工具 -> .NET Reactor）。
*   勾选“启用”
*   选中“项目输出是部署项目的一部分（设置、ClickOnce）”
*   您可以通过定义 .NET Reactor 项目文件或通过命令行开关来定义保护设置
*   添加“-invalid_metadata 0”作为命令行参数
*   单击确定并允许 .NET Reactor 修改您的 Visual Studio 项目文件

[![在此处输入图像描述](https://i.stack.imgur.com/Icvnz.png)](https://i.stack.imgur.com/Icvnz.png)

通过这种方式，Visual Studio 项目文件被修改为在正确的时间访问 .NET Reactor（在您的程序集被编译之后但仍然在它被添加到 ClickOnce 包之前）。

# sql-server - 两个查询效率更高？

> ID：861579
> 
> 赞同：3
> 
> 时间：2009-05-14T04:37:19.733
> 
> 标签：sql-server, database, oracle, db2

我有一个包含 user_id、email、default 列的表。默认存储“Y”或“N”，具体取决于电子邮件是否为用户默认电子邮件。每个用户只能有一个默认电子邮件。

当用户在表上进行更新或插入时，在我的 SP 中，我检查用户是否已将 isDefault 传递为“Y”。如果是这样，我需要更新该用户的所有条目以设为默认“N”。我的问题是：考虑到没有锁定问题（不超过一个线程会为特定用户从表中请求数据），以下查询中的哪一个最耗时：

```
update table
set default = 'N'
where user_id = 'abc'
and default = 'Y' 
```

（默认 = 'Y' 检查的开销）

或者

```
update table
set default = 'N'
where user_id = 'abc' 
```

（为用户更新所有记录的开销）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T04:48:37.020

有 99% 的把握，我可以说第一个查询会更高效。

您的集群键可能是 user_id，因此您的 UPDATE 语句将很快找到要更新的行。更新在 SQL Server 中逻辑上实现为先删除然后再插入，因此它可能是一个相当昂贵的操作（相对于简单的查找）。

再加上 UPDATE 需要对记录进行排他锁，并且所有迹象都指向语句 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T04:43:52.930

为什么不自己尝试一下。在 SQL Management Studio 中一个接一个地运行这两个查询并启用“包括实际执行计划”。百分比越高，查询越慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T04:43:54.193

这里没有一个明确的答案。如果大多数记录的默认值 = 'N'，则在第一种情况下您的效率将是最好的。其次，在大多数情况下，最好默认 = 'Y'。

因此，如果您的大多数用户只有 1 个电子邮件地址，请使用第二个查询。如果大多数用户至少有 2 个，请使用第一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T05:49:35.893

在甲骨文方面，我会选择选项 1。有点。

我有一个唯一的索引，强制每个用户只有一个默认条目，然后我会使用该索引中的函数作为更新的一部分。您只更新需要更新的行。此外，唯一索引最大限度地减少了为给定用户获取默认电子邮件所需的工作，不仅用于更新，而且在您使用该功能获取行的任何地方。

```
drop table user_email;

create table user_email 
(userid varchar2(4) not null, default_ind varchar2(1) not null, 
email varchar2(30));

create unique index ue_x on user_email 
  (userid, decode(default_ind,'Y','Y',email));

insert into user_email (userid, default_ind, email) values ('fred','N','a');
insert into user_email (userid, default_ind, email) values ('fred','N','b');
insert into user_email (userid, default_ind, email) values ('fred','Y','c');

update user_email
set default_ind = 'N'
where userid = 'fred'
and decode(default_ind,'Y','Y',email) = 'Y';

update user_email
set default_ind = 'Y'
where userid = 'fred'
and email = 'a'; 
```

PS。“默认值 = 'Y' 检查的开销”非常微不足道，因为无论如何您都需要访问该列来更新它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T04:42:42.947

查询的速度取决于几个因素，例如表中的行数、索引、检查约束以及外键和主键。

确定至少在 SQL Server 中哪个更快的最佳方法是在运行查询时使用包含客户端统计信息和执行计划。比较每个的时间并选择最好的。

# wpf - WPF 设计器“无法创建类型的实例”

> ID：861580
> 
> 赞同：18
> 
> 时间：2009-05-14T04:37:32.883
> 
> 标签：wpf, xaml, inheritance, designer

在我的 UI XAML 中，我本质上是从包含多个表单共有的功能的类“BaseView”继承的，但这会阻止设计器显示表单：“无法创建 BaseView 类型的实例”。代码将编译并运行，但无法在 Designer 中看到表单令人沮丧。有没有更好的办法？谢谢。

XAML：

```
<vw:BaseView 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vw="clr-namespace:ReviewClient"   
    x:Class="ReviewClient.MainPage" 
```

...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-18T00:00:46.207

问题是基类被定义为抽象的。这导致设计者失败。这个问题在 Laurent Bugnion 博客的评论部分有更详细的描述：http: [//geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx](http://geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-29T12:08:54.417

我在以下网址找到了一个非常有用的解决方案：http: [//www.progware.org/Blog/post/WPF-Designer-Error-Could-not-create-an-instance-of-type.aspx](http://www.progware.org/Blog/post/WPF-Designer-Error-Could-not-create-an-instance-of-type.aspx)。

此链接说明 WPF 设计器窗口如何运行构造函数以在 XAML 中显示 UI 和补救措施：将以下代码段添加到可能会出错的构造函数代码的任何部分：

```
if(!System.ComponentModel.DesignerProperties.GetIsInDesignMode(this))
{
   //code producing exception         
} 
```

函数名称是不言自明的。:) 此链接还提供有关 XAML 调试问题的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-01-04T05:45:24.247

另一个可能的原因，正如我们刚刚在此处发现的，所以我为未来的用户添加了这个答案，是项目是否托管在不受信任的源上，例如文件服务器。

在这种情况下，设计人员不会加载程序集，因此给出了相同的“无法创建实例...”错误。该解决方案仍然可以构建和调试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-02T19:56:40.613

另一个原因。我的控件类有一个从资源初始化的静态字段，如下所示：

```
 static Color s_ImgColor = (Color)TheApp.Resources["PhoneForegroundColor"]; 
```

这将在 XAML 编辑器中引发空引用异常，因为资源在设计模式下不可用。如果它不是颜色资源（比如画笔），这不会是问题，但是类型转换为值类型会在空引用上抛出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-25T09:02:40.350

还有一个可能的原因。

我有一个用户控件，它具有生成事件的子控件，例如列表控件上的 selection_changed。select_changed 事件处理程序对其他子控件进行更改。

在初始化期间，列表框的选定项属性被更改并触发 selection_changed 事件。处理程序尝试更新其他子控件但不能因为它们尚未被实例化。这会导致空指针异常并导致问题。

一旦处理了空指针问题，控件就能够被实例化并出现在父控件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-27T06:18:09.250

我的问题是我的 MVVM 类可以访问构造函数中的数据库，这就是问题所在，它引发了异常。我只需要检查应用程序是否在设计模式下运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-14T10:10:58.850

在 WinForms 中，如果您使用自定义`TypeDescriptionProvider`通知设计器具体实现，则可以将设计器与抽象控件一起使用：

我在另一个问题的[答案](https://stackoverflow.com/a/6817281/39396)中使用了解决方案，该问题链接[了这篇文章](http://wonkitect.wordpress.com/2008/06/20/using-visual-studio-whidbey-to-design-abstract-forms/)。本文建议使用`TypeDescriptionProvider`抽象类的自定义和具体实现。设计者将询问自定义提供者要使用哪些类型，并且您的代码可以返回具体类，以便设计者在您完全控制抽象类如何显示为具体类时感到高兴。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-28T18:43:18.513

还有另一种可能的情况（这对于 WP 至少 SL 来说是实际的）：

如果您创建类的实例（例如`<local:MyDataSource />`），那么**它应该是 public**。如果您的类是内部的，它将在设计时工作，但在运行时会因此异常而失败。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-02T20:38:02.270

我收到此错误的原因很简单，但对我来说很难找到。我的转换器类不公开。只需更改类的可访问性即可修复它。

```
 public class StringToLowerConverter : IValueConverter 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-13T18:17:49.603

我不知道问题是什么，但我是这样解决的：

您不应该在 BaseClass 的构造函数中执行代码，而是从父类的构造函数执行代码。

您在从父类的构造函数执行的 BaseClass 中创建一个方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-29T18:13:14.423

[![在此处输入图像描述](https://i.stack.imgur.com/B90O8.png)](https://i.stack.imgur.com/B90O8.png)

耶！我解决了。在我将“控制显示选项”设置为“仅显示平台控制”后，表单最终显示在“显示和错误消失”上。查看图像以找到它。

# jquery - jQuery 可选择：如何在第一次加载时选择项目

> ID：861589
> 
> 赞同：2
> 
> 时间：2009-05-14T04:40:00.740
> 
> 标签：jquery

我正在使用 jQuery selectable 来选择 .net 列表视图中的项目。用户可以选择他想要的项目，并可以通过单击保存按钮来保存它。下次当用户来到页面时，他将能够看到他之前选择的项目。

使用 jQuery 可选插件，用户可以通过单击来选择一个项目。

现在我的问题是：

1.  如何在第一次加载时显示现有的选定项目？
2.  选择项目后，如何从页面后面的代码中获取所选项目的值，以便将其保存到数据库中？

有什么建议么？

提前致谢。

我的 html 标记是：

```
<ul id="ulSelectable" class="ui-selectable">
  <li id="196500" class="ui-selectee ui-selected">
    <div id="dvItem">
      <img id="Interest_lvResult_ctrl0_ctl00_imgInterest" src="Images/Pic1.jpg"/>
    </div>
    <div class="Profile_Interests_Card_ItemName"> Driver </div>
  </li>
  <li id="196600" class="ui-selectee">
    <div id="dvItem">
      <img id="Interest_lvResult_ctrl0_ctl01_imgInterest"  src="Images/Pic2.jpg" />
    </div>
    <div class="Profile_Interests_Card_ItemName"> Builder </div>
  </li>
</ul> 
```

还有我的 javascript：

```
<script type="text/javascript">
    var setSelector = "#ulSelectable";
    $(function() {
        $(setSelector).selectable({ filter: 'li' });

    });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T15:50:53.403

$('#ulSelectable') .find('li') .removeClass('ui-selected') .end() .find('#196600') .addClass('ui-selected');

ui-selected

好的，看来您只是想将 CSS 类“ui-selected”添加到要选择的 li 中（您已存储在数据库中或其他任何地方）？它是否正确？如果是这样，基本方法是首先从所有元素中删除该类（例如，在上面的 HTML 中，该类位于第一个 li 但假设我们要选择的那个是第二个）。因此，我们首先将其从所有 li 元素中删除，然后将其添加到所需的元素中。jQuery 会是这样的：

```
$('#ulSelectable')
.find('li')
  .removeClass('ui-selected')
  .end()
.find('#196600')
  .addClass('ui-selected'); 
```

这假设您正在选择 DOM ID 为“196600”的第二个 li。您当然会在页面呈现时替换它。

要获得稍后存储的值，您必须首先需要知道您实际需要什么值。它是图像 src 还是具有类“Profile_Interests_Card_ItemName”的 div 的值，例如您想要“Builder”或“Driver”。让我们假设你想要后者。所以想法是，在您的表单提交中添加一个 jQuery 事件来解析您的 DOM，然后抓取所选项目并将其放入隐藏的表单字段中，然后将其提交到后端。

假设您的表单的 DOM ID 为“the_form”，并且您有一个名为“type”的隐藏表单字段（最初为空），其 ID 为“job_type”：

```
$('#the_form').submit(function(n) {
  //grab the LI that is selected
  var li = $('#ulSelectable').find('li.ui-selected');
  //now find the div with our class within this li and grab its inner text
  var job_type = li.find('div.Profile_Interests_Card_ItemName').text();
  //set the hidden field
  $('#job_type').val(job_type);
}); 
```

现在您有一个隐藏的表单字段，其中包含“Profile_Interests_Card_ItemName”类的内容，它将在名为“type”的字段中传递到您的服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T04:46:59.130

要利用第一次加载，您需要使用在页面和 DOM 加载之后调用的 document.ready 函数，例如

```
$(document).ready(function(n) {
// your code will be executed here after the DOM loads
}); 
```

# nhibernate - nHibernate 可以根据列值映射到相关表吗？

> ID：861590
> 
> 赞同：0
> 
> 时间：2009-05-14T04:40:17.820
> 
> 标签：nhibernate, reference

创建表Table1（属性名称varchar（100），属性值varchar（100），attributeLookupMethod varchar（50））

创建表 Table2(attributeName varchar(100), CSVAllowableValues varchar(1000)

基于上面2个表，使用nHibernate，当Table1.attributeLookupMethod = 'Lookup'时，是否可以只从Table2中检索细节？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T04:54:41.407

在两个表中实现子类化。

您将有一个 Table1 类和一个 Table2 类，它将扩展第一个类。在 Table1 映射中，将字段“attributeLookupMethod”声明为鉴别器。在子类 Table2 的映射中，将鉴别器值声明为“查找”。

[NHibernate 关于子类化的文档](https://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/mapping.html#mapping-declaration-subclass)

通过这样做，声明一个公共主键（可能是属性名）和一个从 Table2 到 Table1 的外键可能会很好

# audio - 检测耳机何时插入

> ID：861601
> 
> 赞同：13
> 
> 时间：2009-05-14T04:43:16.240
> 
> 标签：audio, hardware

有没有办法以编程方式确定耳机何时插入计算机？

本质上，我只想写一个简单的工具，除非插入耳机，否则我的声音会静音。这甚至可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-16T18:44:24.483

在 Windows Vista 及更高版本中，您可以使用设备到达和移除通知并检索端点外形来确定您的音频解决方案的制造商是否将特定端点视为“耳机”。

在 Vista 之前，无法确定此信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-14T17:20:38.320

许多音频编解码器提供“插孔检测”，这可能是您需要谷歌的术语。

看来在 Vista 下，您可以使用 IMMDeviceEnumerator::GetDefaultAudioEndpoint() 和 IMMDevice::GetState() 来检查“端点”的状态。还有[“IKsJackDescription 接口”](http://msdn.microsoft.com/en-us/library/ms679023(VS.85).aspx)。

在 XP 下，您可以尝试[“waveInGetNumDevs”](http://msdn.microsoft.com/en-us/library/ms713732(VS.85).aspx) - 驱动程序可能会报告 0，直到插入耳机。有关更多信息，请参阅[此讨论中的评论。](http://blogs.msdn.com/larryosterman/archive/2007/10/31/what-happens-when-audio-rendering-fails.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T05:03:22.773

我认为您无法提供通用的解决方案。

我还指出了 nray 的解决方案。大多数 Realtek 声卡，特别是 Intel 主板上的 realtek 都有此功能。但在那种情况下，硬件不是“标准”的。换句话说，在那些声卡中应该有特殊的机制来检测输出插座节点上的电阻变化和“触发事件”

如果您有那种声卡+您只需要一个有效但不完美的解决方案，只需修改调用配置程序的例程即可。（静音/取消静音的程序）。然后用您的新实用程序替换配置程序（您可以使用进程资源管理器找到它）。

注意我不是 100% 确定我们是否可以识别插件 - 清楚地关闭。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T04:49:56.940

这可能是可能的 - RealTek 有一个系统托盘实用程序，当您将某些东西连接到麦克风插孔时，它会弹出~~一个令人讨厌~~的有用实用程序来调整您的音频，也许耳机插孔是相似的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T05:02:13.463

除非你的声卡支持它，否则这是值得怀疑的。

可以想象，一些声卡中带有一个微型开关，用于检测耳机何时插入，或者它们可能会测量信号的阻抗以了解电路何时闭合。我还没有在任何便宜的声卡中看到这一点。

现在，如果您有一个与麦克风共享的插孔（例如，耳机），您可能能够检测到麦克风通道上的“pop”，但我会冒险这仍然非常不可靠。你不会知道它是被插入还是被移除，只是发生了变化。

就个人而言，我只是一直静音，只有在我真正想要声音时才打开它。

# .net - .NET 中的抽象工厂示例

> ID：861602
> 
> 赞同：2
> 
> 时间：2009-05-14T04:43:18.487
> 
> 标签：.net, design-patterns

.NET BCL 中有没有“抽象工厂”的好例子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T04:59:59.473

ADO.Net 使用几个抽象工厂类。请参阅[ADO.NET 2.0 中的抽象工厂设计模式](http://www.vbdotnetheaven.com/UploadFile/mosessaur/abstractfactoryadonet208102006012837AM/abstractfactoryadonet2.aspx)

# sql-server - 如何在不丢失任何数据的情况下更改 SQL Server 2005 数据库中的主键？

> ID：861605
> 
> 赞同：2
> 
> 时间：2009-05-14T04:44:52.100
> 
> 标签：sql-server, database, sql-server-2005

我的数据库中有一个表，它有一个主键，它的数据类型是 varchar(10)，但它只存储 5 个字符，所以我想将它的数据类型从 varchar(10) 更改为 varchar(5) 而不会丢失任何数据.

目前我正在创建一个临时表，将数据从原始表移动到临时表，然后对其进行更改，最后再次将数据从临时表恢复到主表。

我想知道这个问题是否有其他解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T05:14:35.837

对于 db2 数据库，我不得不这样做。这些是 DBA 建议的步骤：

1.  删除依赖对象，例如视图或过程......请。在做drop之前保留一份ddl的副本
2.  将现有表重命名为 _old
3.  创建具有正确结构的表。
4.  在 _old 表上执行 runstats
5.  将 _old 表中的数据加载到这个新表中。如果要保留标识列，请使用标识覆盖标志加载
6.  重新创建视图和过程
7.  重新绑定所有依赖的过程。

如果是 db2 特定的，您可以省略第 4 步和第 7 步。此外，如果 SQLServer 中没有问题，您可以省略删除和重新创建依赖对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T05:53:25.103

在大多数 DBMS 中，运行一个简单的 ALTER TABLE 语句将一次性完成整个工作，而不会丢失任何数据。你确定 MS SQL Server 不支持吗？（如果没有，也许您需要更好的 DBMS - 但我认为这不是问题。）

看到概述的多步骤操作后，我很困惑。在我主要使用的 DBMS 中，所需要的只是：

```
ALTER TABLE WhatEver MODIFY pkcolumn VARCHAR(5) NOT NULL; 
```

它甚至可以是“原地改变”；它似乎几乎立即完成，即使实际更改将在很长一段时间内发生，因为实际行已更改。（好的；实际上对于可能不会出现的 VARCHAR 字段；对于 CHAR 字段 - 当长度仅为 5 或 10 个字节时，这将是一个不错的选择 - 这将是一个“就地更改”。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T07:10:46.367

由于您指定您使用的是 SQL Server，因此可以并且应该使用设计工具来完成更改。

启动 Management Studio 程序并连接到服务器。然后打开有问题的数据库并找到表。

右键单击表并选择设计，然后在该视图中进行更改。

你现在有两个选择：

1.  您可以单击“保存”按钮，MS SQL Server 将为您编写脚本并执行必要的更改
2.  或者，您可以使用生成更改脚本按钮。在我的 IDE 中，此按钮是与键/约束按钮相同的工具栏上最左侧的按钮（与具有保存按钮的工具栏不同）

如果您使用后一个功能，您将在对话框中看到脚本代码，并且可以选择将其保存到磁盘。这使您可以大致了解要执行它时会发生什么。

更改主键的问题是，需要先删除从其他表到该主键的所有引用，然后再重新创建，并且 SQL Server Management Studio 程序足够智能，可以生成（至少在 99% 的例）您需要的所有 SQL，以正确的顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T04:49:12.090

我认为您应该创建一个具有标识 int 主键的表，并使用您的 varchar 字段作为数据库的唯一替代自然键。

我知道这意味着你必须改变指向那里的任何其他外键，但如果你已经在做你描述的工作，我会全力以赴。

恕我直言

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-02T20:49:14.620

好吧，对我来说，我发现的必须有价值的方法是使用以下表达式创建一个备份表：

```
SELECT *
INTO your_table_name_backup 
FROM your_table_name_original 
```

这将自动生成带有名称的表的副本`your_table_name_backup`

您现在可以通过 `(your_table_name_original`删除和创建来更改原始表）。

在这之后做

```
INSERT INTO your_table_name_original SELECT * FROM your_table_name_backup 
```

这样就不会丢失数据，也不会插入新的表字段类型或约束:)

### 笔记：

我之所以写这个是因为没有人将 MSQLMS 称为在不删除和创建的情况下更改表的压力，例如，当您使用设计器更改字段类型时，您可以看到这是一条漂亮的消息。我不明白为什么他们让你打开设计器并实际编辑字段类型，如果最后你收到这样的消息，这样的操作是不允许的 yadayadayada ...

如果有人知道更简单的方法，请提及它，希望它可以帮助某人......

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-14T05:52:26.527

总体思路如下。不要忘记先备份您的数据库。

```
ALTER TABLE tableName ADD tempColumn VARCHAR(5)

UPDATE tableName SET tempColumn = pkColumn

-- Do this for all constraints

ALTER TABLE tableName DROP CONSTRAINT pkConstraint

ALTER TABLE tableName DROP COLUMN pkColumn

ALTER TABLE tableName ADD pkColumn VARCHAR(5)

UPDATE tableName SET pkColumn = tempColumn

ALTER TABLE tableName DROP COLUMN tempColumn 
```

# silverlight - 如何获得对 Silverlight 列表框的 ItemsPanel 的引用

> ID：861615
> 
> 赞同：2
> 
> 时间：2009-05-14T04:49:45.210
> 
> 标签：silverlight, listbox

我在 Silverlight2 中有一个 ListBox，它使用 Grid 作为其 ItemsPanelTemplate。在代码中，我如何获得对该网格的引用？

```
<ItemsPanelTemplate x:Key="GridItemsPanel">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>
    </Grid>
</ItemsPanelTemplate>

<ListBox ItemsPanel="{StaticResource GridItemsPanel}" /> 
```

背景：

我想要做的是向网格中添加不是 ListBoxItems 的子项。我正在尝试获得类似于 Outlook 日历日视图的内容，其中项目可以在网格上以 30 分钟的分辨率对齐。我的网格和 ListBoxItem 定位工作正常，但是我希望能够渲染背景颜色、网格线、小时标签等，以允许用户清楚地看到 ListBoxItem 的时间和持续时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-30T18:10:37.100

如果您真的只是想获得参考，无论名称范围如何，您都可以使用 VisualTreeHelper 遍历它。我不久前使用自定义包装器做到了这一点

[http://blogs.vertigo.com/personal/jimbg/Blog/archive/2008/10/24/walk-the-visual-tree.aspx](http://blogs.vertigo.com/personal/jimbg/Blog/archive/2008/10/24/walk-the-visual-tree.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T21:25:56.857

如果您的目标是创建具有自定义渲染的列表框，这里是一个示例：

```
<ListBox x:Name="lstMails">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid Background="Gray">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding Path=Subject}" />
                <TextBlock Grid.Column="1" Text="{Binding Path=Sender}" />
                <TextBlock Grid.Column="2" Text="{Binding Path=SentTime}" />
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

`ItemsSource`并从代码后面或通过指定绑定设置属性：

```
lstMails.ItemsSource = /*collection of Mail objects*/; 
```

希望，这很有帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-14T04:57:57.107

您需要使用 x:Name 属性为 Grid 命名：

[http://msdn.microsoft.com/en-us/library/cc189028(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc189028(VS.95).aspx)

# sharepoint - 如何在删除列表项时删除内容数据库中的条目

> ID：861621
> 
> 赞同：2
> 
> 时间：2009-05-14T04:53:34.670
> 
> 标签：sharepoint

当我从基于 MOSS 2007 的网站中删除列表项时，内容数据库将设置其 DeleteTransactionId 而不是删除它。这对我来说是浪费空间，因为我不会再使用这些项目了。

有什么方法可以同时从列表和内容数据库中删除列表项？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T06:15:13.227

1）你真的那么担心“空间”吗？

2) 清空回收站是否会删除这些条目？

3) 请记住，MS 建议您不要对数据库执行任何操作。

4) 请参阅[http://rdacollab.blogspot.com/2008/08/mosssharepoint-2007-deleting-deleted.html](http://rdacollab.blogspot.com/2008/08/mosssharepoint-2007-deleting-deleted.html)了解一些 SQL 来完成这项工作（但请先阅读免责声明）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T03:57:10.163

该项目已移至回收站。一旦从回收站中删除项目，它将从数据库中删除。如果您真的想立即将其删除

A) 您可以禁用回收站（请记住有 2 个回收站）。

B) 如果您使用的是 API，那么您只需执行 SPListItem.Delete。

# objective-c - 如何解决“发送到实例的无法识别的选择器”？

> ID：861626
> 
> 赞同：38
> 
> 时间：2009-05-14T04:54:47.693
> 
> 标签：objective-c, iphone, cocoa-touch, memory-management, static-libraries

在 AppDelegate 中，我正在分配一个在静态库中定义的实例。这个实例有一个 NSString 属性设置了一个“副本”。当我访问此实例上的字符串属性时，应用程序因“发送到实例的无法识别的选择器”而崩溃。Xcode 为该属性提供了代码提示，这意味着它在调用应用程序中是已知的。特定类被编译到静态库目标中。我错过了什么？

添加一些代码。

```
//static library 
//ClassA.h
@interface ClassA : NSObject {
...
NSString *downloadUrl;
}
@property(nonatomic, copy) NSString *downloadUrl;

//ClassA.m
@synthesize downloadUrl; 
```

在调用应用程序的 appDelegate 中。

```
//app delegate header file
@interface myApp : NSObject <UIApplicationDelegate> {
ClassA *classA;
}
@property (nonatomic, retain) ClassA *classA;

//app delegate .m file
@synthesize classA;

- (void)applicationDidFinishLaunching:(UIApplication *)application {
classA = [[ClassA alloc] init];
//exception occurs here.  downloadUrl is of type NSCFNumber
classA.downloadUrl = @"http://www.abc.com/";
...} 
```

应用程序中的其他类将获得对委托的引用并调用 classA.downloadUrl。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-14T06:14:37.283

1) 合成是否在`@implementation`块内？

2）您应该参考`self.classA = [[ClassA alloc] init];`and`self.classA.downloadUrl = @"..."`而不是 plain `classA`？

3）在您`myApp.m`需要导入的文件中`ClassA.h`，当它丢失时，它会默认为数字还是指针？（如果编译器未找到，则在 C 变量中默认为 int）：

`#import "ClassA.h"`.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-07-23T08:45:46.547

在项目设置中的其他链接器标志中设置标志**-ObjC** ...（不在静态库项目中，而是在使用静态库的项目中...）并确保在项目设置中将配置设置为**所有配置**

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-05-07T17:49:52.860

对于这个和类似的问题，很多人给出了一些非常技术性的答案，但我认为它比这更简单。有时，如果您不注意，您不打算使用的选择器可能会附加到界面中的某些内容上。您可能会收到此错误，因为选择器在那里，但您还没有为它编写任何代码。

仔细检查是否不是这种情况的最简单方法是按住控件单击该项目，以便您可以看到与其关联的所有选择器。如果那里有任何你不想成为的东西，那就摆脱它！希望这可以帮助...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T05:03:25.690

在您发布的代码中，您将`setDownloadURL:`setter 发送到`ClassA`- 即*类本身*。您想设置实例的属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T05:53:55.553

您如何将 ClassA 导入您的 AppDelegate 类？您是否在主项目中包含了 .h 文件？我有一段时间遇到这个问题，因为我没有将头文件复制到主项目以及正常的#include“ClassA.h”中。

复制或创建 .h 为我解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-19T02:02:07.563

对我来说，导致这个错误的原因是我不小心将相同的消息发送给同一个班级成员两次。当我右键单击 gui 中的按钮时，我可以看到两次方法名称，我只是删除了一个。在我的情况下肯定是新手错误，但想把它拿出来供其他新手考虑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-19T04:59:33.017

我的东西很简单/愚蠢。新手错误，对于将 NSManagedObject 转换为普通 NSObject 的任何人。

我有：

```
@dynamic order_id; 
```

当我应该有的时候：

```
@synthesize order_id; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-08T03:35:30.790

您应该注意，这不一定是最好的设计模式。从外观上看，您实际上是在使用您的 App Delegate 来存储相当于全局变量的内容。

Matt Gallagher 在[http://cocoawithlove.com/2008/11/singletons-appdelegates-and-top-level.html](http://cocoawithlove.com/2008/11/singletons-appdelegates-and-top-level.html)上的 Cocoa with Love 文章中很好地介绍了全局变量的问题。在所有可能的情况下，您的 ClassA 应该是单例而不是 AppDelegate 中的全局，尽管您可能希望 ClassA 更通用，而不仅仅是单例。在这种情况下，您可能最好使用类方法来返回 A 类的预配置实例，例如：

```
+ (ClassA*) applicationClassA
{
    static ClassA* appClassA = nil;
    if ( !appClassA ) {
        appClassA = [[ClassA alloc] init];
        appClassA.downloadURL = @"http://www.abc.com/";
    }
    return appClassA;
} 
```

或者（因为这会将应用程序特定的东西添加到可能是通用类的内容中），创建一个新类，其唯一目的是包含该类方法。

关键是应用程序全局变量不需要是 AppDelegate 的一部分。仅仅因为 AppDelegate 是一个已知的单例，并不意味着所有其他应用程序全局都应该与它混合，即使它们在概念上与处理 NSApplication 委托方法无关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-05T22:13:53.357

很奇怪，但是。您必须将应用程序实例的类声明为 myApplication: UIApplication 而不是 myApplication: NSObject 。似乎 UIApplicationDelegate 协议没有实现 +registerForSystemEvents 消息。又是疯狂的 Apple API。

# .net - 动态语言运行时和 CLR - DLR 的意义何在？

> ID：861629
> 
> 赞同：3
> 
> 时间：2009-05-14T04:55:53.527
> 
> 标签：.net

[从维基百科关于DLR](http://en.wikipedia.org/wiki/Dynamic_Language_Runtime)的条目，

看起来 DLR 的目的是使用 Python、Ruby 等语言。这就是DLR的全部吗？还有其他好处吗？为什么要为 ASP.net 项目或 Winform 应用程序选择 IronPython 而不是 C#？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T05:15:04.900

CLR 及其底层执行模型针对静态类型语言进行了优化。.NET 类库中的几乎所有方法都采用比类型系统的根 System.Object 更精确的参数。

动态类型语言在运行时需要一组不同的功能。他们需要高效执行动态类型代码的能力。例如，当动态类型语言调用常规 CLR 类时，它需要将每个参数转换和/或类型转换为 CLR 类上的静态定义类型。如果不仔细执行此操作，则可能效率低下。

类似地，动态类型语言通常有一个对象模型，该对象模型不容易映射到具有显式类型属性、方法、字段等的 CLR 类模型。相反，对象通常更像哈希表，键所在的键值对桶字符串（或符号）和值是方法、闭包或对象值本身。对象（和/或它们的类型）通常在运行时也是可扩展的。

由于动态类型语言之间存在相似之处，因此将通用性提取到一组基本功能中，以简化互操作和动态语言实现，以及使 CLR 优化更容易被特别关注，这将是有用的关于动态语言。C# 中的 new`dynamic`关键字就是其中的一部分：它使用 DLR 的机制来帮助与动态类型语言和对象系统（例如 COM 自动化对象、IronPython、IronRuby 等）进行互操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T05:01:29.283

DLR 非常强大和有用。例如，使用 DLR，您可以在用 C# 编写的应用程序中执行任意 Ruby 或 Python 脚本。还有很多其他的使用场景，但到目前为止，动态脚本托管对我来说是最有用的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T05:03:59.310

它为开发人员使用 .NET CLR 及其所有功能提供了更多选择和灵活性。您可以使用您最了解的语言，或者最适合手头任务的语言，无论是 C#、F#、Ruby 还是其他语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T05:02:15.430

你是否厌倦了写作

```
string firstName = (string)Session["FirstName"]; 
```

使用 DLR，您可以简单地编写

```
dynamic firstName = Session.FirstName; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T05:02:22.293

新的 C# 将使用 DLR 中的一些功能。新的结构和语言元素正在...

# c++ - 我的 COM 服务器中是否需要一个作业队列？

> ID：861637
> 
> 赞同：1
> 
> 时间：2009-05-14T04:59:40.553
> 
> 标签：c++, windows, com, interop

我有一个 COM EXE 进程外服务器，从它的一个接口公开一个 API。此 API 的功能是发布 URL。

我的客户端将创建 COM 服务器实例并使用新 URL 调用此 API。

每次客户端需要发布一个 URL 时，它都会创建这个 COM 服务器的一个实例。

我是否需要在 COM 服务器中实现一个队列来跟踪客户端发布的所有 URL 并确保没有丢失任何内容？

我想知道的是，如果每次创建 COM 对象时，都会启动一个新进程？如果是这样的话，我想我不需要在服务器中实现作业队列。

但是如果只有一个实例保留在内存中，客户端发布的作业/URL 是否可能会丢失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T05:11:24.440

COM 通常为所有请求启动一个服务器进程并实例化该进程中的所有对象。如果您在所有对象（全局变量或静态成员变量）之间共享任何数据，您应该注意同步或使 COM 组件成为单元线程 (STA)。

如果您没有同步且组件是多线程 (MTA)，则实例之间共享的所有数据在一次由多个线程写入时都会受到损坏。

# c# - 我正在使用谷歌图表 api 我想为 x 轴设置标签

> ID：861644
> 
> 赞同：0
> 
> 时间：2009-05-14T05:03:00.280
> 
> 标签：c#

我正在使用 google chart api 我想为 x 轴设置标签，但问题是这些标签与我的源代码重叠......

```
 BarChart barchart1 = new BarChart(350, 200, BarChartOrientation.Vertical, BarChartStyle.Stacked);
        barchart1.SetTitle("Bedrooms distribution of " + City);
        barchart1.SetData(data);
        barchart1.AddAxis(new ChartAxis(ChartAxisType.Bottom));
        barchart1.AddAxis(new ChartAxis(ChartAxisType.Left));

        ChartAxis chx1 = new ChartAxis(ChartAxisType.Bottom);
        for (int s = 0; s < ds.Tables[0].Rows.Count; s++)
        {
            ChartAxisLabel chl1 = new ChartAxisLabel(labels[s]);

            chx1.AddLabel(chl1);

        }
        barchart1.AddAxis(chx1);
        barchart1.SetBarWidth(20);

     //   barchart1.SetLegend(labels);

        barchart1.SetDatasetColors(new string[] { "FF0000", "FFFF00", "CCCCCC", "EFEFEF", "FFFF00", "9900FF", "66FF99", "00AA00", "224499", "00CC33" });

        Image1.ImageUrl = barchart1.GetUrl();

            Image1.Visible = true; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T05:07:19.753

您可以将 C# 包装器用于 Google Chart API - [http://code.google.com/p/googlechartsharp/](http://code.google.com/p/googlechartsharp/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T05:29:46.423

如果您只需要一个简单的图表（带有变量值），您可以为该图表生成 URL（您必须了解基本图表 API）。然后使用 System.Net.webclient 下载图表

```
 using System;
    using System.Net;
    using System.IO;

public class Test
{
    public static void Main (string[] args)
    {

        WebClient client = new WebClient ();

        Stream data = client.OpenRead (args[0]);
        StreamReader reader = new StreamReader (data);
        string s = reader.ReadToEnd ();
        Console.WriteLine (s);
        data.Close ();
        reader.Close ();
    }
} 
```

# java - Web 服务 - 实施端的超时

> ID：861652
> 
> 赞同：2
> 
> 时间：2009-05-14T05:04:10.307
> 
> 标签：java, web-services

我正在调用 Web 服务，我希望它在 5 秒内响应。如果它无法在 5 秒内处理它（忽略网络延迟），我希望它回滚事务并向我发送超时异常。

我可以看到仅在调用客户端的代码上设置了超时。我希望这由 Web 服务实施者（服务器端）强制执行。我似乎找不到任何方法来做到这一点。

如果我通过在客户端指定超时超时，服务器可能会继续并完成事务。我什至不知道原始请求是否成功，或者它是否遇到任何错误，因为它在服务器完成请求处理之前超时。

我正在使用 Java 客户端与 EJB 实现的 WS 通信。感谢任何输入。

谢谢，芒卢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T19:56:41.410

我认为大多数 J2EE 应用程序服务器都允许您设置最大事务时间，并且一旦超过该时间就会回滚。因为您想以一种很好的方式响应调用者，您可能会考虑将事务的“肉”放在 Bean A 中，将 SOAP 处理内容放在 Bean B 中。因此，在 Bean B 中，您会捕获 RollbackException（我认为有一个超时的子类？）并以良好的方式响应您的呼叫者。

如果您使用 JBoss（可能还有其他应用程序服务器？），您显然可以使用 BMT 并动态设置事务超时。 [http://www.jboss.org/community/wiki/TransactionTimeout](http://www.jboss.org/community/wiki/TransactionTimeout)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T08:20:14.347

如果我猜对了，EJB 会实现服务，它会在 5 秒内做出响应，或者回滚事务并发送超时响应。看起来您无论如何都需要有状态的 bean，因为您想单独跟踪每个服务调用的时间。

我会为每个服务调用从 EJB 启动一个“kill”线程。线程将等待 5 秒并在该时间段后通知 EJB，它必须回滚并以错误消息响应。EJB 可以终止（通常）情况下的终止线程，它可以在预期的时间范围内响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-03T19:07:58.520

我会建议一种可能有效的模式。但首先......我想建议，也许这个要求可能会从一点解释中受益。实际发生了什么需要 5 秒超时，并且需要非常确定（确定中止事务）如果达到超时，该工作不会发生？在这种情况下，如果他的浏览器崩溃或在他们看到结果之前发生网络故障，用户会有多沮丧——因为在这种情况下，我们无法从客户端知道发生了什么，并且客户端处于问题（几乎不可避免）不参与交易。

因此，不同的交互模型可能更容易实现并提供相当好的可靠性。我将描述该模型，然后解释如何改进它以提供 5 秒超时，如果您确实需要它。

我建议的交互模型是“下订单，稍后检查填充”模型。这是经常用于在线交易系统的内容。客户端发送请求，系统将请求安全地隐藏在某个地方并立即响应客户端。不需要超时，藏起来非常快。然后在一个工作线程中（使用 Java EE 领域中的 MDB，或 WebSphere 的异步 bean），可以完成真正的工作。

客户稍后可以问“那个订单号 73，怎么样？” 或“请取消订单 73”。使用 Ajax 或回调技术，我们可以在该模型上提供一个非常漂亮的 UI。

请注意，客户端说“取消”和系统“完成那个”的实现需要通过适当的锁定来调解，通常是通过某个数据库。

使用乐观锁定，SQL 语句的含义类似于

```
Update order 73 to cancelled WHERE its state is working
if the number of rows updated == 0 then "TOO LATE we already filled it" 
```

因此，填充者可以在其主要事务中关注更新到“已填充”并在记录已被取消的情况下中止事务。

我们在两个异步“线程”之间进行了调解。

对于许多系统来说，这就足够了。

记住：

*   如果您的工作人员花费了很长时间，那么在工作结束时取消它可能对整体吞吐量非常不利，用户是否会再次提交请求。
*   虽然工作在 JDBC 的深处进行，但您可能无法中断它，因此“失控”查询不会被我们在此讨论的任何内容所阻止。

如果您确实需要 5 秒超时，那么您所做的就是上述操作，只是服务被编码为在睡眠后执行取消检查，而不是立即返回客户端并在稍后的单独请求中进行检查。所以客户端代码看起来像：

```
Begin tran
     stash request
Commit

// now the worker may get round to starting the work sometime

Sleep 5 seconds

Begin Tran
     attempt to cancel!
     // that will fail if the work is completed
     // the WHERE will not find the record in the right state
if update worked COMMIT
     // now worker cannot complete
else ABORT

// by here the work is either complete or cancelled
// even if worker is still running it cannot complete

return state of record 
```

# msbuild - 如何以编程方式在 win2008 x64 上构建 InstallShield msbuild 任务？

> ID：861655
> 
> 赞同：2
> 
> 时间：2009-05-14T05:06:55.557
> 
> 标签：msbuild, 64-bit, installshield

我在 Win 2008 Server x64 上使用 MSBuild 和 InstallShield 时遇到问题。我尝试使用 InstallShield 团队提供的 MSBuild 任务构建 InstallShield 项目，如果我从 C:\Windows\Microsoft.NET\Framework\3.5\ 运行 msbuild，它们运行良好，但是当我尝试从 C:\Windows\Microsoft 运行它时。 NET\Framework **64** \3.5\ 我有一个错误：

> *无法从程序集 c:\Program Files (x86)\MSBUILD\InstallShield\2009\InstallShield.Tasks.dll 加载“InstallShield.Tasks.InstallShield”任务。无法加载文件或程序集 'file:///c:\Program Files (x86)\MSBUILD\InstallShield\2009\InstallShield.Tasks.dll' 或其依赖项之一。试图加载格式不正确的程序。确认声明正确，并且程序集及其所有依赖项都可用。*

并且可以使用“常规”框架路径而不是 x64 路径，但不幸的是我需要使用 MSBUILD 以编程方式使用它的引擎，它只返回 2 个工具集，一个用于 2.0 版本的框架，一个用于 3.5 版本。但两者都位于 Framework64 路径下...我尝试使用“通常”框架目录的路径添加我自己的工具集。我尝试通过注册表和编程方式执行此操作，但它不起作用 - DefaultToolsVersion 设置为我自己的值，路径查看框架，带有我的版本的工具集已添加到工具集集合中。但由于某种原因，我仍然收到相同的消息. 构建项目的代码：

```
 Project project = new Project(engine);
        //Toolset customToolset = new Toolset("4.0", @"c:\windows\Microsoft.Net\Framework\v3.5\");
        //engine.Toolsets.Add(customToolset);
        //engine.DefaultToolsVersion = "4.0";

        project.Load(args[0]);

        MSBuildLogger logger = new MSBuildLogger();
        engine.RegisterLogger(logger);

        bool res = engine.BuildProjectFile(args[0]); 
```

任何人都有想法我应该怎么做才能让它工作？

* * *

看来我解决了为 x86 平台而不是 AnyCPU 编译我的应用程序的问题......但可能还有另一种解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-01T12:29:01.580

您的问题的根源是程序集 Macrovision.InstallShield.Tasks.dll 是类型不安全的（托管和本机代码混合/IJW）并且仅适用于 x86 架构。Macrovision 在这里未能为特定架构进行良好的互操作程序集模块化。Macrovision.InstallShield.Tasks.dll 中的任务依赖于本地工具来构建 MSI 包。这些本机工具仅适用于 x86 架构，因此存在依赖性。

Macrovision 应该为 MSBuild 制作了一个类型安全的（AnyCPU / PURE）任务程序集，并部署特定于架构的代码并调用特定架构的互操作程序集，最突出的是 x86 和 AMD64。这样，任何类型的 MSBuild 或任务程序集的任何其他使用者都可以工作（当然，只要存在给定体系结构的特定互操作程序集）。

解决问题的最佳方法可能是将项目编译为 AnyCPU 并执行 32 位 MSBuild。或者启动一个 32 位 CLR 或进程，然后使用 Macrovision 的程序集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:46:16.057

是的，InstallShield 版本是 32 位的，因此仅将其 MSBuild 支持安装到 32 位位置。您的 MSIL 项目在 x64 机器上以 64 位运行，因此目前您的构建器 x86 的解决方案可能是最好的，尽管将来 MSBuild 本身可能会解决这个问题。

如果在某些时候您需要的 64 位多于 InstallShield MSBuild 任务，您的其他办法是使用带有命令行构建的 Exec 任务。

# asp.net - 如何从asp.net调用windows服务

> ID：861658
> 
> 赞同：7
> 
> 时间：2009-05-14T05:08:07.787
> 
> 标签：asp.net, windows-services

如果我创建一个 Windows 服务，有没有办法从 asp.net 调用该服务？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T05:12:43.703

经过

> “呼叫该服务”

你的意思是，管理服务？如启动、停止、重启等？如果是这样，那么答案是肯定的。[www.csharp-examples.net](http://www.csharp-examples.net/restart-windows-service/)上有一篇很好的文章，它将向您展示如何使用 ServiceController 类。

但是，如果您的意思是向它发送消息，就好像它是一个 Web 服务一样，那么答案是，这取决于您如何公开您的服务。Windows 服务可以托管 WCF 服务，因此如果您想将 Windows 服务公开给 Internet 客户端，这将是一个不错的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T05:24:26.607

一些清晰会有所帮助 - 您也可以将“调用该服务”解释为从 ASP.NET 到您的服务的某种远程方法调用 - 例如，将某些状态存储在您的 Windows 服务中。

在 Windows 服务中托管服务端点，例如使用远程处理、WCF 或普通的 TCP 套接字服务器。所有这些都可以由托管在 ASP.NET 中的客户端调用。

有很多远程处理和 WCF 示例可以做到这一点 - 搜索托管和其中一种技术。

一些MSDN链接阅读：

[远程处理](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.85).aspx)

[WCF](http://msdn.microsoft.com/en-us/library/bb332338.aspx)

您还应该阅读有关[Windows Process Activation](http://msdn.microsoft.com/en-us/library/ms734677.aspx)的信息- 您可能无需编写单独的服务即可摆脱困境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:44:45.703

另外，为了发送（真正）简单的消息，还 可以使用[ServiceController.ExecuteCommand(int command) 。](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.executecommand.aspx)使用`executecommand`它非常容易发送`integer`/`enum`作为消息。

```
var myService = new ServiceController("SimpleService");
myService.ExecuteCommand(128);
myService.ExecuteCommand((int)SimpleServiceCustomCommands.ScanFiles); 
```

看起来`myService`像：

```
public class myService : ServiceBase
{ 
  ...
  protected override void OnCustomCommand(int command)
  {
    //executes logic 
```

# java - 在 BorderLayout.CENTER 中保留 JButton 的大小

> ID：861659
> 
> 赞同：3
> 
> 时间：2009-05-14T05:08:22.480
> 
> 标签：java, swing

有没有办法在 BorderLayout 的中心保留 JButton 的自然大小？现在，它向各个方向扩展以填充它，但我想要它正常大小。

如果不可能，我怎样才能让一个按钮以正常大小位于面板的中心？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-14T05:49:40.573

BorderLayout 中心的组件始终被拉伸，您可以通过将按钮添加到具有 FlowLayout 的 JPanel 然后将其添加到 CENTER 来解决此问题。

```
JPanel borderPanel = new JPanel(new BorderLayout());
JButton theButton = new JButton("Click Me");
JPanel flowPanel = new JPanel(new FlowLayout());
flowPanel.add(theButton);
borderPanel.add(BorderLayout.CENTER, flowPanel); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T09:49:48.157

我建议直接去`GridBagLayout`。尽管它有一些奇怪的行为和糟糕的界面，但它是一个标准布局，几乎可以做所有事情。您将需要它，因此即使并非绝对必要，您也可以始终使用相同的布局管理器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T05:51:21.643

无论您在 BorderLayout 面板的中心放置什么组件，它都会垂直和水平调整大小以填充所有可用区域。这就是中心位置的特点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-21T02:03:33.927

为这样一个简单的布局使用 GridBagLayout 是多余的。我会尽可能避免使用 GridBagLayout - 如果可以的话，使用嵌套的 JPanel 或 MigLayout（外部 jar）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T05:57:27.463

我认为你不能用 BorderLayout 做到这一点。容器的约束将优先于首选大小。

对于手动编码，我建议查看[MiG Layout](http://www.migcalendar.com/miglayout/)。

# jquery - 如何在 jQuery UI Selectable 插件中防止多选

> ID：861668
> 
> 赞同：22
> 
> 时间：2009-05-14T05:13:37.397
> 
> 标签：jquery, jquery-ui

我正在使用 jQuery UI 可选插件。我想一次选择一项。但是 jQuery UI Selectable 插件允许通过单击/拖动/按住 CTRL 键进行多项选择。有什么办法可以防止多选？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-12-23T23:37:13.343

What i did, is that i allow multiple selection but when the selection is done, i only keep the first element selected

```
<ul id="select">
    <li>Row 1</li>
    <li>Row 2</li>
    <li>Row 3</li>
</ul> 
```

这将选择除第一个元素之外的所有选定元素并删除选定状态。所以最后只会选择一个元素。event.target 对应于我的 ul 元素。

```
$('#select').selectable({
    stop:function(event, ui){
        $(event.target).children('.ui-selected').not(':first').removeClass('ui-selected');
    }
}); 
```

我知道这个话题有点老了，但我还是偶然发现了它，所以它对其他人有用

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-12T21:59:05.660

这对我有用。它可以防止“套索”多行和 ctrl + 单击。

```
$(function() {
$("#selectable").selectable({
      selecting: function(event, ui){
            if( $(".ui-selected, .ui-selecting").length > 1){
                  $(ui.selecting).removeClass("ui-selecting");
            }
      }
});
}); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-14T18:35:39.170

没有明确的方法。但是，您可以为“Start”或“Selected”事件传入一个回调函数，如果选择了多个元素，则取消选择。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-07-12T15:47:56.667

这可能是一个更好的解决方案：

```
$('#selectable').selectable({
    selecting: function (event, ui) {
        $(event.target).children('.ui-selecting').not(':first').removeClass('ui-selecting');
    }
}); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-17T20:18:05.037

这是比以前发布的更通用的解决方案：

```
 $element.selectable({
        selecting: function (e, ui) {
            // force single selection
            $(e.target).find('.ui-selectee.ui-selecting').not(ui.selecting).removeClass('ui-selecting');
            $(e.target).find('.ui-selectee.ui-selected').not(ui.selecting).removeClass('ui-selected');
        }
    }); 
```

（被选中的对象可能并不总是可选对象的子对象，当您按住 ctrl+单击时，按住“第一个”被选中对象会导致一些奇怪的行为。）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-12-16T23:53:22.253

是的，您可以防止这种行为，只需将公差选项设置为“适合”

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-11T08:34:23.707

[您可以在此 jQuery 论坛主题](http://forum.jquery.com/topic/selectable-single-select)中找到有关此的有趣讨论。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-08-02T21:35:21.260

您可以像这样创建自定义插件：

```
$.widget("xim.singleSelectable", {
    options: {
        select: null
    },
    _create: function () {
        var self = this;
        this.element.addClass('ui-selectable');
        this.element.delegate('li', 'click', function (e) {
            self.element.find('>li').removeClass('ui-selected');
            $(this).addClass('ui-selected');

            if ($.isFunction(self.options.select)) {
                self.options.select.apply(self.element, [e, this]);
            }

        });
    },
    selected: function () {
        return this.element.find('li.ui-selected');
    },
    destroy: function () {
        $.Widget.prototype.destroy.apply(this, arguments); // default destroy
    }
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-16T18:54:59.703

这里有一些很好的解决方案，但大多数都假设您总是希望选择第一个元素，因为它在多选情况下出现在 DOM 中。

`lastSelection`为了解决这个问题，我保留了一个变量（

```
var lastSelection;// this will record our last successful selection

$('#selectable').selectable({
    filter: '.element',
    selecting: function () {
        if ($('.ui-selecting').length > 1) {
            // if selecting multiple (lasso) we will ignore the selection and fallback
            $('.ui-selecting').removeClass('ui-selecting');
            $(lastSelection).addClass('ui-selecting');// if no value, nothing will be selected
        }     
    },
    stop: function () {
        if ($('.ui-selected').length > 1) {
            // looks like we have an invalid selection, fallback to lastSelection
            // this handles the ctrl (windows), cmd (OSX) multi-select cases
            $('.ui-selected').removeClass('ui-selected');
            $(lastSelection).addClass('ui-selected');// if no value, nothing will be selected
        } else {
            if ($('.ui-selected').first().is('.element')) {
                // if we successfully found a selection, set it as our new lastSelection value
                lastSelection = $('.ui-selected')[0];
            }     
        }     
    }
}); 
```

注意：如果您想在不使用 ctrl / cmd + click 的情况下取消选择，则必须使用此方法实施解决方法。

我还想指出，`tolerance: 'fit'`只需要套索完全包围目标元素才能选择它，除非您的元素不能被包围在可用的套索区域中，否则它不会禁用套索选择。[http://api.jqueryui.com/selectable/#option-tolerance](http://api.jqueryui.com/selectable/#option-tolerance)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-09T11:31:34.703

如果您想禁用非连续多选但仍希望保留拖动选择，您可以这样做。

```
 stop: function( event, ui ) {
                if( $(".ui-selected, .ui-selecting").length > 1){
                    var elems = $('.ui-selected, .ui-selecting');

                    for(var i = 0; i < elems.length - 1; i++){
                        if($(elems[i]).closest('td').next('td').text() != $(elems[i+1]).text()){
                           //Non consecutive selection detected
                        }
                    }
                }
            } 
```

它本质上检查所有元素是否彼此相邻。

# blackberry - 生成带有种子值的 AES 密钥

> ID：861679
> 
> 赞同：4
> 
> 时间：2009-05-14T05:20:30.767
> 
> 标签：blackberry, encryption, java-me, aes

如何生成具有种子值的 AES 密钥，以便每当我生成具有相同种子值的密钥时，我都能够获得相同的 AES 密钥？

我想为我的 Blackberry Pearl 8100 设备生成此密钥。

我无法使用 AESKey(keyData) 生成 AES 密钥。

此外，每当我以 String 或 byte[] 的形式打印它时，我都无法生成它。（打印它）永远不会打印实际密钥。

可以做些什么来获得密钥？

**更新**

我尝试通过传递我的数据的 byte[] 来生成 AESKey，如下所示：

```
 AESKey key = new AESKey(keyData); 
```

每次我得到相同的密钥，这是正确的。

现在使用这个密钥我正在加密数据。每次我加密我都会得到不同的加密值。这是我的问题。加密后如何每次都获得相同的数据，以便将其发送到服务器？

**更新**

我无法使用 AESKey(keyData) 生成 AES 密钥。

此外，每当我以 String 或 byte[] 的形式打印它时，我都无法生成它。（打印它）永远不会打印实际密钥。

可以做些什么来获得密钥？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T06:46:41.370

[RFC 2898](http://www.ietf.org/rfc/rfc2898.txt)中的第 5.2 节描述了一种执行此操作的方法。

具体来说，“种子”值由“密码”和“盐”组成；但是给定相同的密码和盐，总是会产生相同的密钥。

[http://anandam.name/pbkdf2/](http://anandam.name/pbkdf2/)是一个 javascript 实现。

[http://en.wikipedia.org/wiki/PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)有更多信息，以及其他实现的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T06:07:56.550

这*不能*以安全的方式完成。您*不应该*像这样生成加密密钥，特别是如果您打算使用生成的密钥保护任何重要的东西。尽管如此，一个基本的算法看起来像这样（许多增强是可能的，但没有一个可以使它真正安全）：

1.  选择一个随机数生成器；可能Java内置了人们通常使用的一个。
2.  使用特定的输入值（密码？密码的哈希？类似的东西）初始化（种子）随机数生成器。
3.  取`N`RNG输出的第一个字节；这些是您的加密密钥。只要您在步骤 2 中使用相同的值作为种子，`N`生成的第一个字节将始终相同。
4.  使用不同的值重新设置 RNG 的种子，最好是随机值（`None`例如，在 Python 中，您将使用 种子；它告诉机器选择任何随机种子）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:03:35.120

我需要更多信息，所以这是一个猜测。

您如何使用您的 AESKey？如果您使用 CBC 加密（即使用 net.rim.device.api.crypto.CBCEncryptorEngine）进行操作，那么每次调用的初始化向量也必须相同。使用带有 InitializationVector 和 BlockEncryptorEngine 的 CBCEncryptorEngine 的构造函数。

[维基百科文章](http://en.wikipedia.org/wiki/Cipher_block_chaining)提供了更多关于为什么会这样的信息。

# visual-studio-2008 - Visual Studio 构建时间

> ID：861683
> 
> 赞同：2
> 
> 时间：2009-05-14T05:23:17.733
> 
> 标签：visual-studio-2008, msbuild, assemblies, compilation

我正在构建一个包含大约 100 个程序集的解决方案，这需要花费大量时间来编译。我想说的是每次集会的分钟数。这与另一种产品形成鲜明对比，该产品也具有 100 多个组件，每个组件都需要几秒钟的时间才能完成。

在这两种情况下，都存在复杂的依赖关系和多个引用，而在第二种情况下，项目实际上更大，这似乎没有意义。

我查看了 CSPROJ 文件和 SLN 文件，看不到任何会导致编译停止的明显内容。

我正在构建 VS2008 专业版。

注意：使用使用 MSBUILD.exe 的 NANT 脚本的工作速度呈指数级增长 -> 所以 VS 中的某些东西会导致速度大幅下降。

有没有人有任何建议，而不是从头开始重新创建整个解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T05:33:52.920

您在依赖项中是否有任何东西迫使每次重建大量项目？例如，如果您有一个运行一些代码生成的预构建步骤，并且一切都依赖于该项目，那么这可能是一个杀手。不久前我遇到过这种情况——让代码生成器在其输入没有改变时通知它，并且在这种情况下不重写输出，节省了*大量*时间。

顺便说一句，您真的需要在同一个解决方案中包含 100 个项目吗？我想，无论你做什么，这都会很慢。我正在考虑尝试合并项目（我见过人们有很多很多小项目的各种情况 - 合并它们真的很有帮助）或者将单个解决方案分成几个。

编辑：您可能想尝试将 Visual Studio 的 GUI 部分排除在等式之外的一件事是`msbuild`从命令行构建它，而根本不运行 VS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T12:46:05.250

发现项目文件引用的是网络路径而不是本地路径。更改这些值会使构建时间恢复正常。感谢所有回复的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T05:36:38.793

也许使用像[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)这样的工具来监视 VS 在延迟时正在写入/读取的内容。也许这会给你一个线索。我发现它对于了解应用程序在做什么非常有用（假设有要监视的 I/O 活动）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T05:34:50.140

您是否有任何 Visual Studio 插件可能会在构建文件时执行诸如索引文件之类的操作？

您是否设置了使用机器上所有可用处理器的选项？

您的机器上是否有任何其他进程正在运行，它们可能会窃取 CPU 周期或占用硬盘驱动器？您可以使用任务管理器或进程资源管理器来查找这些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T06:07:19.407

慢速解决方案是否有很多 ASP.NET 文件/项目？编译标签似乎总是比纯 C#/VB 花费更长的时间

# continuous-integration - DevExpress eXpressApp 框架 (XAF) 和持续集成

> ID：861695
> 
> 赞同：1
> 
> 时间：2009-05-14T05:27:14.027
> 
> 标签：continuous-integration, cruisecontrol.net, nant, devexpress, xaf

我有一个 XAF 应用程序和一个在开发机器上运行良好的 nant 脚本。该脚本使用 MsBuild 和 .csproj 文件来编译项目。

当 CruiseControl.net 服务器尝试编译项目时，它指出它找不到需要编译的 XAF 程序集。

我尝试将所有 DLL 引用为 BIN 文件夹中的本地副本，并尝试在开发服务器上安装 XAF，但它没有奏效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-03T19:48:49.517

您是否尝试过直接在服务器上通过 msbuild 构建以确保它正常工作？

当我们部署到 CI 时，我们将使用的 dll 移动到第三方 dll 文件夹并从此处引用它们。您是否 100% 所有引用都已正确更新，就好像您添加了一个新模块一样，默认情况下是引用 GAC 中的 dll，这通常没有意义。

我建议不要将 XAF 安装到服务器，因为如果您更新引用的文件夹方法更易于管理，并且如果需要，您可以轻松处理多个分支/版本。

干杯，克制

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T00:38:43.417

当我们在开发服务器上运行自动构建时，我们需要很长时间才能为所有内容获得正确的路径设置。我们有需要 VS6、VS.Net 2003、VS.Net 2005 和 VS.Net 2008 的构建。将所有这些环境安装在单个构建机器上会造成一些真正的破坏，试图让所有东西都留在自己的沙子里——盒子。

最终，使用[Zed Builds 和 Bugs](http://www.hericus.com/)，我们能够将每个构建步骤保持在自己的沙箱中，并使用自己的环境变量和自己的注册表设置。

当 nant 编译运行以查看是否缺少环境变量或错误指向的环境变量时，您能否获得构建时环境的转储？

# class - subsonic Substage 我如何覆盖类名

> ID：861700
> 
> 赞同：0
> 
> 时间：2009-05-14T05:30:44.707
> 
> 标签：class, substage

无论如何要覆盖生成的类名，因为它在生成表时会导致我出现问题。我遇到了冲突，因为我的属性名称与我的某些表的名称相同。

这会导致我的类出现重复名称编译时错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T07:12:50.773

请参阅[SubSonic 约定](http://subsonicproject.com/setup/subsonic-conventions/)

> 列名不应与表名相同。

简而言之，除非您愿意从源代码更改和重建 SubSonic，否则只需重命名冲突的列名。

# visual-studio-2008 - 如何从 Visual Studio 2008 标准版升级到专业版？

> ID：861704
> 
> 赞同：3
> 
> 时间：2009-05-14T05:32:56.417
> 
> 标签：visual-studio-2008, installation

我需要从 Visual Studio 2008 标准升级到专业版。然后我需要在安装专业版之前卸载标准版本吗？是否有任何已知问题？

谢谢，

作为一个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T05:36:40.353

您可以安装专业版超过标准。VS 不支持即时升级 - 填写新的许可证密钥 => 新版本。但是你不能对一个版本的 Visual Studio 有两个不同的版本。

这在同一个系统上是不可能的

1.  VS 2008 标准版
2.  VS 2008 专业版

这在同一系统上是可能的

1.  VS 2005 标准版
2.  VS 2008 专业版

如果您有 MSDN 版本，请重新安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-04T01:34:12.210

我刚刚通过在 Standard 之上安装 Professional overtop 将 Standard 升级到 Professional，没有任何问题。它保留了我的设置、历史记录和插件。去吧！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T05:42:02.370

转到 addremove 并从那里单击修改，一旦它处于修改阶段，在此处插入您的专业密钥...

# c++ - 减少 cpp 翻译单元的数量是个好主意吗？

> ID：861707
> 
> 赞同：13
> 
> 时间：2009-05-14T05:35:38.407
> 
> 标签：c++, performance, build-process, module, header-files

我发现如果有很多类，当我为每个类使用一个 *.h 和一个 *.cpp 文件时，编译时间会大大增加。我已经使用了预编译的头文件和增量链接，但是编译时间仍然很长（是的，我使用了 boost ；）

所以我想出了以下技巧：

*   将 *.cpp 文件定义为不可编译
*   将 *.cxx 文件定义为可编译
*   每个应用程序模块添加一个*.cxx 文件，并#included 该模块的所有*.cpp 文件。

因此，我最终只得到了 8 个翻译单元，而不是 100 多个翻译单元。编译时间缩短了 4-5 倍。

缺点是您必须手动包含所有 *.cpp 文件（但这并不是真正的维护噩梦，因为如果您忘记包含链接器会提醒您的内容），并且某些 VS IDE 便利性不适用于此方案，例如转到/移至实施等。

所以问题是，拥有大量 cpp 翻译单元真的是唯一正确的方法吗？我的把戏是已知的模式，还是我遗漏了什么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T05:53:30.937

这种方法的一个重要缺点是每个翻译单元都有一个 .obj 文件。

如果您创建一个静态库以在其他项目中重用，如果您有几个巨大的翻译单元而不是许多小的翻译单元，那么您通常会在这些项目中面临更大的二进制文件，因为链接器只会包含包含真正引用的函数/变量的 .obj 文件在使用该库的项目中。

如果翻译单元较大，则更有可能引用每个单元并包含相应的 .obj 文件。在某些情况下，更大的二进制文件可能会成为问题。也有可能一些链接器足够聪明，只包含必要的函数/变量，而不是整个 .obj 文件。

此外，如果包含 .obj 文件并且也包含所有全局变量，那么它们的构造函数/析构函数将在程序启动/停止时被调用，这肯定需要时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T05:44:30.693

我已经看到您在视频游戏中所做的事情，因为它可以帮助编译器进行优化，否则它无法做到以及节省大量内存。我见过“超级构建”和“批量构建”指的是这个想法。如果它有助于加快您的构建，为什么不...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T06:28:42.833

将大量 C++ 源代码文件捆绑到一个文件中是最近多次提到的一种方法，尤其是当人们构建大型系统并引入复杂的头文件时（那将是提升）。

正如您提到的 VS，我发现项目中包含文件的数量，尤其是包含路径的大小，似乎对 Visual C++ 的编译时间的影响远远超过对 g++ 的编译时间的影响。尤其是有大量嵌套包含的情况（同样，boost 会这样做），因为需要大量文件搜索才能找到源代码所需的所有包含文件。将代码组合到单个源文件中意味着编译器可以更智能地查找所述包含，而且显然可以找到更少的包含，因为您期望同一子项目中的文件可能包含非常相似的一组头文件。

C++ 开发的“大量编译单元​​”方法通常来自于解耦类和最小化类之间的依赖关系的愿望，因此编译器只需重建最小的文件集以防您进行任何更改。这通常是一种好方法，但在子项目中通常并不可行，因为其中的文件相互依赖，因此无论如何您最终都会进行相当大的重建。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T07:04:34.450

我不认为减少编译单元的数量是一个好主意。您正在尝试解决编译时间较长的问题，这种方法似乎对此有所帮助，但是您还得到了什么：

1.  在开发过程中增加了编译时间。通常开发人员一次修改几个文件，对于 3-4 个小文件的编译可能会比一个非常大的文件更快。
2.  正如您所提到的，更难导航代码，恕我直言，这非常重要。
3.  您可能会在包含在一个 .cxx 文件中的 .cpp 文件之间产生一些干扰：

    一种。通常的做法是在 cpp 文件（用于调试构建）中本地定义宏 new 以进行内存泄漏检查。不幸的是，在使用placement new 包含标头之前无法做到这一点（正如某些STL 和BOOST 标头所做的那样）

    湾。在 cpp 文件中添加 using 声明是常见的做法。使用您的方法，这可能会导致标题出现问题，稍后会包含

    C。名称冲突的可能性更大

恕我直言，加快编译时间的更简洁（但可能更昂贵的方法）是使用一些分布式构建系统。它们对于干净的构建特别有效。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T06:55:54.407

我不确定这是否与您的情况相关，但也许您可以使用声明而不是定义来减少`#include`您必须做的数量。此外，也许您可​​以将 pimpl 成语用于相同目的。这有望减少每次需要重新编译的源文件的数量以及必须拉入的头文件的数量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T06:27:10.920

更大和更少的翻译单元不会利用并行编译。我不知道您正在使用什么编译器和什么平台，但是并行编译多个翻译单元可能会显着减少构建时间......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T07:11:44.277

这个概念被称为[统一构建](https://stackoverflow.com/questions/847974/c-the-benefits-disadvantages-of-unity-builds)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T06:31:45.620

继尖牙帖子之后，我倾向于更详细地检查生成的可执行文件。如果它们不同，我倾向于将您的技术限制为调试构建，并使用原始项目配置来进行主发布构建。在检查可执行文件时，我还会在启动和运行时查看它的内存占用和资源使用情况。

# php - 如何将 sql 查询中的值存储到变量中？

> ID：861712
> 
> 赞同：2
> 
> 时间：2009-05-14T05:37:18.217
> 
> 标签：php, mysql

```
$resourcesbuilt = mysql_query("SELECT resourcesbuilt FROM user WHERE username = '$username' LIMIT 1");

if ($resourcesbuilt<=0 )
{
    mysql_query("INSERT INTO resources (username, dollars) VALUES ( '$username', '1000')") or die (mysql_error());
    mysql_query("UPDATE user SET resourcesbuilt = '1' WHERE username = '$username'");
} 
```

基本上，我在用户表中有一个列，它充当一个标志，告诉我是否为该特定用户制作了不同的表。如果没有，则为 0，如果有，则为 1。但是，似乎我不能只将查询存储到变量中并检查其是否为 0，因为查询的实际值未存储在 var 中。当我回显 var 时，它只是说 Resource id #3。我对 php 和 SQL 的研究失败了。有谁知道将结果从 sql 查询存储到 php 中的变量中的方法？或者至少可以为我指明正确的方向？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T05:46:37.927

问题是mysql_query返回的结果不能以这种方式使用。相反，您必须致电

```
$value = mysql_fetch_array($resourcesbuilt, MYSQL_ASSOC)
$value ["resourcesbuilt"] 
```

这将为您提供表中该字段的值。看[这里](http://au.php.net/manual/en/mysql.examples-basic.php)的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T05:46:52.093

```
$ rs = mysql_query("UPDATE user SET resourcesbuilt = '1' WHERE username = '$username'"); 
```

将结果存储到一个名为 rs 的记录集中，您可以检索这些值，然后通过调用

```
$myrow = mysql_fetch_array($rs) 
```

将整行放入名为 myrow 的数组中，并通过以下方式检索它们的值`$myrow[column_name]`

哦，据我记得你不能存储它们，因为它们不是选择语句，你将拥有的唯一资源是 mysql_num_rows

# excel - Excel小数四舍五入

> ID：861713
> 
> 赞同：1
> 
> 时间：2009-05-14T05:37:30.023
> 
> 标签：excel

将最后一个小数点四舍五入的excel功能是什么？

```
9.23 => 9.25
10.26 => 10.30
9.25 => 9.25 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T05:58:42.487

使用 CEILING 函数进行四舍五入。要向下舍入，请使用 FLOOR 函数。

```
=CEILING(9.23,0.05) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-14T05:39:32.530

查看`ROUND`功能。

# c# - .NET 工具提示控件，可以显示在屏幕上的任何位置

> ID：861716
> 
> 赞同：3
> 
> 时间：2009-05-14T05:40:22.373
> 
> 标签：c#, winforms, controls

有人可以向我推荐一个免费的 .NET Windows 窗体工具提示控件，它可以显示在屏幕上的任何位置（不绑定到特定控件）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T17:32:51.693

您可以使用 Windows.Forms 命名空间中的标准 ToolTip 控件。ToolTip 有一个 Show 方法，它接受一个 Point 参数，您可以使用该参数在您想要的时间和地点显示提示。ToolTip 不必**与**控件相关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T06:02:01.680

向窗体添加标准工具提示控件？它必须托管在某个地方。您的应用程序不“拥有”桌面，因此它仅在您的应用程序具有焦点时适用。否则，请检查系统托盘。

# javascript - RegExp：我想删除句子中不必要的单词。我该怎么做？

> ID：861721
> 
> 赞同：7
> 
> 时间：2009-05-14T05:45:59.303
> 
> 标签：javascript, regex

我有一个句子，我想从中删除一些单词。

所以如果我有：

```
"jQuery is a Unique language" 
```

和一个名为garbageStrings 的数组：

```
var garbageStrings = ['of', 'the', "in", "on", "at", "to", "a", "is"]; 
```

我想删除句子中的“is”和“a”。

但是如果我使用这个：/这个语句在一个 for 循环中。我正在循环整个句子并在garbageStrings/中找到匹配项

```
var regexp = new RegExp(garbageStrings[i]); 
```

该字符串将变为“jQuery Unique lnuge”

请注意，语言中的“a”已从句子中删除。

我不打算发生这种情况。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T06:03:56.793

像这样的东西：

```
function keyword(s) {
    var words = ['of', 'the', 'in', 'on', 'at', 'to', 'a', 'is'];
    var re = new RegExp('\\b(' + words.join('|') + ')\\b', 'g');
    return (s || '').replace(re, '').replace(/[ ]{2,}/, ' ');
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T05:54:21.233

我本可以发誓 JavaScript 有`\b`（字边界），但看起来没有，试试这个：

```
var regex  = new RegExp("( |^)" + "a" + "( |$)", "g");
var string = "I saw a big cat, it had a tail.";

string = string.replace(regex, "$1$2"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T05:55:16.347

首先，如果您必须遍历每种可能的“garbageString”类型，则完全没有必要使用正则表达式。

其次，您可能应该尝试搜索“仅全词”。这意味着只有在它之前和之后都有一个单词分隔符（例如您的示例中的空格）时，您才匹配垃圾字符串。如果您实现这一点，基于正则表达式的匹配将变得有用。

此代码不起作用，如果有任何标点符号，但根据您的需要更改代码应该不会太难。

```
var text = "jQuery is a Unique language";
var garbageStrings = {"of": true,
                      "the": true,
                      "in": true,
                      "on": true,
                      "at": true,
                      "to": true,
                      "a": true,
                      "is": true};

var words = text.split(" ");
var newWords = Array()
for (var i = 0; i < words.length; i++) {
    if (typeof(garbageStrings[words[i]]) == "undefined") {
        newWords.push(words[i]);
    }
}
text = newWords.join(" "); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T15:54:28.327

Firstly, you need to use arrays for this, not regex, because they will be faster. Regex is orders of magnitude more complex, and thus too heavy. As Atwood says, a programmer thinks he can solve a problem with a regex. Then he has two problems.

So, a quick implementation that uses your list of garbage strings, and does the job, exploiting javascript's built-in dictionary speed to check whether a word is garbage or not, and with handling for punctuation is given below. There's [a little test page](http://www.things.org.uk/examples/jswords.html) you can try it out on.

```
function splitwords(str) {
  var unpunctuated = unpunctuate(str);
  var splitted = unpunctuated.split(" ");
  return splitted;
}

function unpunctuate(str) {
  var punctuation = ['.', ',', ';', ':', '-'];
  var unpunctuated = str;
  for(punctidx in punctuation) {
    punct = punctuation[punctidx];
    // this line removes punctuation. to keep it, swap in the line below.
    //unpunctuated = unpunctuated.replace(punct," "+punct+" ");
    unpunctuated = unpunctuated.replace(punct,"");
  }
  return unpunctuated;
}

var garbageStrings = ['of', 'the', "in", "on", "at", "to", "a", "is"];

var garbagedict= {};

for(garbstr in garbageStrings) {
  garbagedict[garbageStrings[garbstr]] = 1;
}

function remove(str) {
  words = splitwords(str);
  keeps = [];
  for(wordidx in words) {
    word = words[wordidx];
    if(word in garbagedict) {
      // ignore
    } else {
      keeps.push(word);
    }
  }
  return keeps.join(" ");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T05:48:58.133

就像温布尔顿说的。;)

除了我会删除空格作为正则表达式本身的一部分，而不是为此使用第二个正则表达式（以获得更好的性能）：

```
var re = new RegExp("\\b(?:"+ words.join("|") + ")\\b\\s*", "gi");
s.replace(re, ""); 
```

正则表达式将在对象创建时编译。在重复操作中，它不应该比使用字符串/数组操作循环遍历每个停用词慢得多，而且更容易掌握。

如果您只有一个简短的静态停用词列表，则可以编写自己的优化正则表达式：

```
var re = new RegExp("\\b(?:at?|i[ns]|o[fn]|t(?:he|o))\\b\\s*", "gi");
"jQuery is a Unique language".replace(re, ""); 
```

这里的想法是共享相同前缀的单词（例如“of”和“on”）共享相同的执行路径，直到它们不同为止。在您的情况下几乎没有必要，但很高兴知道。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T19:23:45.263

请不要为此使用 RegExp，它既脏又不必要，并且占用太多周期。更轻松：

```
var garbageStrings = ['of', 'the', "in", "on", "at", "to", "a", "is"];
for(var i=0; i < garbageString.length; i++){
    string.replace(" "+garbageStrings[i]+" ", "");
} 
```

或使用数组：

```
var garbageStrings = ['of', 'the', "in", "on", "at", "to", "a", "is"];
var str = str.split(" ");
for(var i=0; i < garbageStrings.length; i++){
    for(var j=0; j < str.length; j++){
        if(str[j].toLowerCase() === garbageStrings[i]){
            str.splice(j, 1);
        }
    }
}
str = str.join(" "); 
```

# sql - MySQL INSERT INTO table VALUES.. vs INSERT INTO table SET

> ID：861722
> 
> 赞同：278
> 
> 时间：2009-05-14T05:46:09.940
> 
> 标签：sql, mysql, performance

`INSERT INTO table VALUES ..`和 之间的主要区别是什么`INSERT INTO table SET`？

例子：

```
INSERT INTO table (a, b, c) VALUES (1,2,3)

INSERT INTO table SET a=1, b=2, c=3 
```

而这两者的表现呢？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2009-05-14T05:51:07.993

据我所知，两种语法都是等价的。第一个是 SQL 标准，第二个是 MySQL 的扩展。

因此，它们在性能方面应该完全相同。

[http://dev.mysql.com/doc/refman/5.6/en/insert.html](http://dev.mysql.com/doc/refman/5.6/en/insert.html)说：

> INSERT 将新行插入到现有表中。语句的 INSERT ... VALUES 和 INSERT ... SET 形式根据显式指定的值插入行。INSERT ... SELECT 表单插入从另一个表或多个表中选择的行。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-12-31T22:21:14.710

我认为该扩展旨在允许插入和更新的类似语法。在 Oracle 中，类似的语法技巧是：

```
UPDATE table SET (col1, col2) = (SELECT val1, val2 FROM dual) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-10-24T15:42:56.640

由于语法是等效的（无论如何在 MySQL 中），我更喜欢这种`INSERT INTO table SET x=1, y=2`语法，因为它更容易修改并且更容易在语句中捕获错误，尤其是在插入大量列时。在我看来，如果您必须插入 10 或 15 或更多列，那么使用`(x, y) VALUES (1,2)`语法很容易混淆。

如果不同 SQL 标准之间的可移植性是一个问题，那么可能`INSERT INTO table (x, y) VALUES (1,2)`会是首选。

而且，如果您想在单个查询中插入多条记录，则该语法似乎`INSERT INTO ... SET`不起作用，而另一种则可以。但是在大多数实际情况下，无论如何，您都会遍历一组记录以进行插入，尽管在某些情况下，可能会构造一个大型查询以在一个查询中将一堆行插入到一个表中，而不是一个查询每一行，可能会有性能提升。真的不知道。

# version-control - 在 MS Source Safe 上使用 Subversion 的原因

> ID：861725
> 
> 赞同：5
> 
> 时间：2009-05-14T05:46:57.037
> 
> 标签：version-control

我处于以下困境，我目前使用 Subversion 进行源代码控制并喜欢它。问题是我必须（在不久的将来）将我的项目交给另一组开发人员来维护，同时我自己仍然在努力。问题是他们从未听说过或使用过 Subversion，只使用 MS Source Safe。尽管我已要求他们进行调查，但他们似乎只应该使用 MS Source Safe。

我需要让团队领导相信颠覆对 Source Safe 的好处，但由于我已经很多年没有使用它了，所以我不确定使用 Source Safe 的确切陷阱等是什么。

我所知道的最重要和唯一的功能是。

1.  Subversion中没有文件锁定
2.  我可以离线工作（从公司网络），因为我经常这样做，这对我来说是一个重要的功能。

您能否列出您可能遇到的任何问题或您认为我可能会因为迁移到源安全而丢失的任何功能。

请注意 Team Foundation 服务器不是一个选项，并且该项目是一个 .Net 项目。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T05:58:52.407

反对 VSS 的经典论据可在[Visual SourceSafe: Microsoft's Source Destruction System中找到](http://www.highprogrammer.com/alan/windev/sourcesafe.html)

我喜欢颠覆，原因如下

*   自由
*   开源
*   [红皮书在线文档](http://svnbook.red-bean.com/)
*   易于分支/合并
*   免费客户端工具 / Gui[的 / IDE 插件](http://subversion.tigris.org/links.html#all-clients)
*   多种访问方法（svnserve、http 等）

除其他外...

我用过 VSS、ClearCase、CVS 和 Subversion，我喜欢 Subversion

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T05:58:06.573

我在工作中使用 VSS，在家里使用 Subversion，并且都喜欢它们。VSS 中的文件锁定有时可能很棒，但有时真的很糟糕。我喜欢 Subversion 的一件事是易于分支等等。VSS 似乎也有更多的问题集成到 Visual Studio 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T06:00:05.663

看到[这个](http://www.highprogrammer.com/alan/windev/sourcesafe.html)，[这个](http://www.codinghorror.com/blog/archives/000660.html)和[这个](http://www.developsense.com/testing/VSSDefects.html)。长话短说：使用 VSS，您花在与 VSS 本身斗争上的时间比实际做有用的工作要多。

# sql - 为客户生成 SQL 升级脚本

> ID：861728
> 
> 赞同：3
> 
> 时间：2009-05-14T05:50:54.937
> 
> 标签：sql, database

在产品版本之间维护升级脚本的最佳方式是什么？如果客户从您产品的第 3 版开始并升级到第 5 版，那么为客户生成升级脚本以便解决第 3 版和第 5 版之间数据库架构中的任何差异的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T05:55:38.203

1) 使用像[RedGate 的 Schema and Data Compare这样的工具](http://www.redgate.com)

2) 使用[Visual Studio 2008 的 GDR 项目](http://blogs.msdn.com/gertd/archive/2009/04/22/rtm-of-vsdb-2008-gdr-r2.aspx)

3）写你自己的！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T06:02:45.610

这个之前已经讨论过很多次了：

[如何为最终用户自动升级部署的数据库](https://stackoverflow.com/questions/812210/how-to-automatically-upgrade-deployed-database-for-end-users)

[数据库部署策略 (SQL Server)](https://stackoverflow.com/questions/504909/sql-deployment-strategies)

[有任何可用的 SQL Server 2008 数据库更改管理 (MIgrations) 工具吗？](https://stackoverflow.com/questions/466689/any-sql-server-2008-database-change-management-migrations-tools-available/466756)

[Migrator.net](http://code.google.com/p/migratordotnet/)似乎是这些问题的首选方法。我确实喜欢这种方法，但如果您的情况很简单，您可能更愿意存储 SQL 以在具有版本号的表中执行更改，如下所示：

```
create table upgradetable (major int, minor int, revision int, change text) 
```

然后你可以通过一个简单的脚本来执行升级：

```
 select change from upgradetable where major > (select major from versiontable) 
```

（当然要根据口味调整）。

如果您不能通过 SQL 进行所有升级，这将不起作用，在这种情况下，我推荐 migrator.net

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T06:12:47.520

试试[Wizardby](http://code.google.com/p/octalforty-wizardby/)看看它是否合适。它有一个用于编写迁移的特殊 DSL，它可以自动生成降级脚本并跟踪版本，因此您不必编写任何代码来执行此操作。

如果您想以编程方式进行升级，请参阅[此](https://stackoverflow.com/questions/812210/how-to-automatically-upgrade-deployed-database-for-end-users/861790#861790)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T05:56:12.227

我认为这完全取决于您的数据库结构和新版本的新功能。如果新版本与旧版本有很大不同，您可能希望有一个[ETL](http://en.wikipedia.org/wiki/Extract,_transform,_load)过程来进行升级，而不仅仅是 SQL 脚本

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T06:00:57.283

可以通过遵循类似于 dbdeploy 或 ruby​​ rake 迁移的方法来处理版本控制。您对每个更新脚本进行顺序编号，并在数据库中有一个表来存储所有已实施的脚本编号。

升级工具仅应用编号高于已在数据库上实现的脚本的脚本。

[在这里](http://dbdeploy.com/documentation/)阅读更多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-14T03:58:39.777

实际上，这很容易。
与标准代码存储库上的分支类似，您正在寻找的是允许您执行以下操作的源代码控制策略
：在特定点创建数据库结构的分支。(v3 / v4)。
湾。使用该分支将数据库恢复到特定版本。（即 v3 或 v4）。
C。创建一组补丁脚本以从 v3 迁移到 v4，或从 v3 迁移到 v5。
d。在运送给您的客户之前测试这些补丁。

通过这种方式，您可以支持数据库的多个版本，并提供经过测试的升级路径。

看看 DBSourceTools ( [http://dbsourcetools.codeplex.com](http://dbsourcetools.codeplex.com) )，尤其是补丁策略。
该工具将允许您在特定点为数据库设置基线，并创建一个命名版本 (v1)。
然后，创建一个部署目标 - 并将命名版本增加到 v2。
最后，将补丁脚本添加到 Patches 目录，以对模式或数据进行任何更改。

这为您提供了一个可重复的过程来测试从 v1 到 v2 应用的所有补丁。
DBSourceTools 还具有帮助您创建这些脚本的功能，即模式比较或脚本数据工具。

完成后，只需将补丁目录中的所有文件发送到您的客户端。

玩得开心。

# windows - 如何在 COM 组件中创建线程？

> ID：861730
> 
> 赞同：3
> 
> 时间：2009-05-14T05:51:17.870
> 
> 标签：windows, com, interop

我有一个在 COM 服务中实例化的 COM 组件（此 .exe 正在运行）。

我有十个客户。每个客户端都从 ROT 获取接口 (IXyz) 指针并同时调用方法 IXyz::abc()。

从我的跟踪中，我看到 IXyz::abc() 被同时调用了 10 次，但在 10 个不同的线程中。

谁在创建这 10 个线程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T06:25:28.223

如果您考虑一下，COM 行为是有意义的。代码在服务进程内部执行。如果您将该类标记为在单线程单元中运行，则一次只能执行一个线程。并发调用堆积在消息队列中，一次执行一个。如果指定了多线程单元，则代码可以并发执行。为了在正在运行的进程中实现这一点，多个线程被旋转以实现此行为。

如果你想避免并发问题，你需要把你的类放在一个 dll 中。然后你仍然有多个线程，但每个线程都在调用进程中执行，所以你不需要担心状态。

没有线程就无法同时执行任何代码块。即使您在单独的进程中执行，仍然涉及多个线程，它们只是由进程边界分隔。

我只是在谈论显而易见的事情，因为我曾经为一家无法通过他们头脑的公司工作。:-) 他们认为可以通过在单独的进程中执行和使用共享内存（内存映射文件）来避免线程问题！当他们的代码在单个 CPU 上运行并且他们添加了一个“修复”应用程序来修复不一致时，这会起作用（有点）。在最后一次安装中，他们转移到多个 CPU 上，一切都崩溃了。然后我离开了，结束了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T06:07:22.260

COM 子系统就是这样做的。它创建一个单独的线程来处理同时调用的不同调用。如果组件是 MTA，则请求并行执行，如果是 STA，则一次执行一个以防止共享变量损坏。

# c# - 列表问题中的 DataGridView 绑定

> ID：861734
> 
> 赞同：1
> 
> 时间：2009-05-14T05:53:02.343
> 
> 标签：c#, .net, datagridview

我有一个我试图绑定到 DataGridView 的客户列表。我有两个看起来像这样的数据类：

```
public class Customer
{
     public string Name { get; set; }
     public AddressDetail Address { get; set; }
}

public class AddressDetail
{
     public string StreetAddress { get; set; }
     public string City { get; set; }
} 
```

然后，当我尝试填充 DataGridView 时，我使用：

```
CustomerInfo custInfo = new CustomerInfo();
CustomerGrid.DataSource = custInfo.GetCustomers(); 
```

GetCustomers 将返回一个客户列表。我的问题是地址列只有一列，并在列中显示“地址”。在 DataGridView 中为 Address 类的所有成员显示列的最佳方式是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T05:59:43.387

> 我的问题是地址列只有一列，并在列中显示“地址”。

我想你想说“在标题栏中”。

您可以用 StreetAddress 和 City*组合一个句子，并在网格中 Address 列的每个字段中显示它。*

# windows - 我可以下载\使用 MSDN 许可证做什么？

> ID：861736
> 
> 赞同：0
> 
> 时间：2009-05-14T05:53:17.770
> 
> 标签：windows, msdn

我的雇主给了我一个 MSDN 许可证，而不是我要求的。这些年来，我一直在 Java 世界和 Linux 中使用 C++ 编程。

考虑到我不在 Dot Net 上工作，我想知道我能用这个许可证做什么？:-(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T05:56:29.993

这实际上取决于您拥有的订阅级别。[在此处](http://msdn.microsoft.com/en-us/subscriptions/subscriptionschart.aspx)查看各种订阅级别的比较。

对于给定级别，提供给您的任何软件仅供开发和测试使用。

根据订阅级别，它还可能包括技术支持事件，这在紧要关头可能会很方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T06:09:31.413

很多时候您可以下载操作系统和服务器软件，因此它不仅适用于 .Net 开发人员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T06:04:21.300

你可以[在 eBay 上卖它](http://shop.ebay.com/items/_W0QQ_nkwZmsdnQQ_armrsZ1QQ_fromZR40QQ_mdoZ)……你的意思是把它给你还是你只是为了工作而买一个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T05:57:37.637

嗯，你到底是什么意思？您是在问在技术方面或法律方面您能用它做什么。典型的 MSDN 许可证授予您开发、测试和发布软件免版税的能力。MSDN 有多种工具，不仅用于 .NET 编程，还包括 C++ 和 VB6 工具。根据您的订阅，您可能有权访问旧版本的 IDE。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T05:58:44.437

你可以把它送给我......作为礼物......因为我是一个非常漂亮的人......或者因为我是一个踢屁股的 .NET 程序员，并且能够很好地使用这样的许可证。

# css - :hover CSS 不工作？

> ID：861745
> 
> 赞同：2
> 
> 时间：2009-05-14T05:55:42.617
> 
> 标签：css, browser, hover

我创建了一个 CSS 类，如下所示：

```
div.ycontent div.ppclisting { background-color:#cccccc; }
div.ycontent div.ppclisting:hover { background-color:#FFE5DF; } 
```

我在我的一个页面中应用了上述样式，它在 Firefox、IE 7.0+ 和其他最新浏览器中运行良好。但是当我在另一个页面中应用相同的样式时，它就不起作用了。

谁能告诉我可能是什么原因？为什么它不能在另一个页面中工作。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-19T04:53:40.477

我得到了答案，为什么 :hover 不能在另一个页面上工作。实际上在第二页的 HTML 页面中没有添加 DOCTYPE 标签，如下所示，

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

早些时候它是简单的`<html>`标签，因此 :hover 在 div 上不起作用。添加 doctype 标签后，如上所示，它对我有用。

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-16T22:32:16.077

刚遇到类似的问题。确保您正确堆叠！也就是z-index。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T06:02:58.763

如果它在一个地方工作，但不在另一个地方工作，那么要么它没有被正确调用，要么它没有被正确应用。

使用 Firebug，并查看*应该*具有样式的元素真正具有的属性。然后检查类名是否有错别字。通常，这将解决所描述的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T06:07:12.900

此外，在 IE6 中，`:hover`仅适用于`a`元素。记住这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T06:14:39.560

我同意布兰登的观点。

我还要补充。。

如果您删除：

```
div.ycontent 
```

从您的行中提取部分，使其看起来像这样：

```
.ppclisting { 
background-color:#cccccc; 
}

.ppclisting:hover { 
background-color:#FFE5DF; 
} 
```

您可能会发现它可以在您的其他页面上使用。

为什么？因为您已将这些样式定义为“类”。课程打算多次应用相同的样式。

通过将“div.ycontent”放在它之前，您实际上是在“限制”/没有利用 CSS 类的拉动潜力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T06:00:16.850

也许其他页面中的嵌套 div 没有类 ycontent 和/或元素本身不是类 ppclising？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-06T18:18:16.030

我只是有位置：绝对的父母打破了我的：悬停，尽管这似乎不是祖父母的问题。我对这一切都很陌生，所以我不知道这是否正常。

修正：这对我来说是一个 z-index 问题。我需要将 -1 放在父级上，将 0 放在任何指定位置的兄弟姐妹上，并将 1 放在我想要悬停活动的 div 上。

# database - 删除具有外键关系表的表中的记录

> ID：861752
> 
> 赞同：2
> 
> 时间：2009-05-14T05:57:38.867
> 
> 标签：database

如何删除具有外键关系的表中的记录？

假设我有 2 个表：员工和部门，第一个`deptID`作为外键引用部门 id。

现在我想删除表中的特定行，例如`delete from department where depID=10`. 把部门里的员工删掉就好了，我也想维护外键关系。这样做的查询是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T05:59:17.490

您应该指定删除级联到`employee`表。取决于您的数据库如何执行此操作，但几乎每个数据库都支持级联删除。

例如在 SQL Server 中：

```
CREATE TABLE Employee
(
    DepId INT NOT NULL REFERENCES Department(DepId) ON DELETE CASCADE
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T06:01:15.723

这取决于数据库以及您如何定义关系。您可能会导致删除级联，这意味着删除父项会删除子记录，或者“删除无效”，这会导致子关系在其 FK 字段中具有 NULL，或者您有什么。这取决于您的需求。通常，我不会定义 NULLIFY 或 CASCADE 并根据需要删除每条记录，而不会自动处理这些记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T06:02:40.137

当您建立外键关系时，您可以定义（无论如何在 MS SQL Server 中）在更新和删除时采取哪些操作。例如，您可以说“当部门中的记录被删除时，将删除级联到引用它的任何子表”。[你可以在这里](http://msdn.microsoft.com/en-us/library/ms174979.aspx)找到更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T06:05:21.953

DB2 语法（因为您没有指定正在使用哪个 DB）：

```
Create table Employee
...
... 
FOREIGN KEY (deptID) REFERENCES department (deptID)
    ON DELETE CASCADE 
```

如果您指定 CASCADE 选项，如果部门被删除，员工将被删除。

如果您指定 RESTRICT 而不是 CASCADE，则除非首先删除属于该部门的所有员工，否则它将不允许您删除部门。

或者，如果您不希望每次都发生这种情况，那么最好指定 RESTRICT 并首先在 emp 上删除 reqd

```
Delete * from Employee where deptID = 10;
Delete * from Dept where deptID = 10; 
```

这是[示例的链接](http://www.netcraft.com.au/geoffrey/postgresql/fkey.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T06:00:58.953

在 SQL Server 中，您会将关系标记为 CASCASE DELETE

或者，首先对Employees 表执行DELETE，然后对Departments 表执行第二次DELETE。

# perl - 替换perl中的两个字段

> ID：861758
> 
> 赞同：1
> 
> 时间：2009-05-14T05:59:35.557
> 
> 标签：perl, file

我有这种文本文件

```
File 1
-------
ABC 123
DEF 456
GHI 111 
```

我还有另一个文件

```
File 2
------
stringaa ttt stringbb yyy 
```

```
Ouput
-----
stringaa ABC stringbb 123
stringaa DEF stringbb 456
stringaa GHI stringbb 111 
```

读取文件 File 1 更新 File2 以便产生输出，任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:17:56.340

```
use strict;
use warnings;

my ($file1, $file2) = @ARGV;
open F, $file2 or die "Can't open $file2: $!\n";
$_ = <F>; # File2 should have one line only
close F;

die "$file2 in unexpected format for second file '$_'\n" unless /(\w+)\s\w+\s(\w+)/;
my ($stra, $strb) = ($1, $2);

open F, $file1 or die "Can't open $file1: $!\n";
while(<F>)
{
    s/(\w+)\s(\d+)/$stra $1 $strb $2/;
        print;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T06:18:33.700

即使我不确定这是你想要的（见评论）。这是获得该输出的一种方法：

```
vinko@parrot:~$ more file1.txt
ABC 123
DEF 456
GHI 111
vinko@parrot:~$ more file2.txt
stringaa ttt stringbb yyy
vinko@parrot:~$ more concat.pl
use strict;
use warnings;

open (F1,"<",file1.txt) or die $!;
open (F2,"<",file2.txt) or die $!;

while (<F2>) {
        my ($field1, $field2, $field3, $field4) = split /\s/;
        while (<F1>) {
                my ($innerfield1, $innerfield2) = split /\s/;
                print "$field1 $innerfield1 $field3 $innerfield2\n";
        }
}
close F1;
close F2;
vinko@parrot:~$ perl concat.pl
stringaa ABC stringbb 123
stringaa DEF stringbb 456
stringaa GHI stringbb 111 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:24:17.367

此代码比此处发布的其他建议更详细。

但它有几个优点：

*   它被评论。
*   它使用词法文件句柄和 3 个参数 open()。
*   变量名称是描述性的，而不是 file1 和 file2。
*   它更灵活
    *   易于添加/修改替换字段。
    *   在一个脚本中轻松处理多个数据文件
    *   易于将相同的数据应用于多个规格
*   除非进行替换，否则不拆分或修改规范。

虽然这与这是否是一个在实际中使用的好设计无关，但这段代码展示了几种有用的技术。

*   它生成闭包来处理格式化。
*   它使用原子异常处理而不是有缺陷的`eval {}; if ($@) { ...handle exception... }` 习语。

* * *

```
#!/usr/bin/perl

use strict;
use warnings;

# Supply test data - remove from real code.
my $test_data = <<'END';
ABC 123
DEF 456
GHI 111
JKL
MNO 999 888
END

my $test_spec = <<'END';
stringaa ttt stringbb yyy
END

# Use test data if no files specified.
# works because you can open() a scalar ref as a file.
# remove from real code -> should display usage information and die.
my $file_data = shift @ARGV || \$test_data;
my $file_spec = shift @ARGV || \$test_spec;

# List of tokens to replace in spec file.
# Real code should probably take list of tokens as argument.
my @replace = qw( ttt yyy );

my $spec   = Read_Spec_From_File( $file_spec );
my $format = Make_Formatter( $spec, @replace );
Print_Formatted_Data( $format, $file_data );

exit;

# -----------------------------------------------------------

# Read a specification from a file.
sub Read_Spec_From_File {
    my $file = shift;   # path to file

    open( my $fh, '<', $file )
        or die "Unable to open format specification file '$file' - $!\n";

    my $spec;

    local $_;
    while( <$fh> ) {

        die "Specification file format error - too many lines.\n"
            if defined $spec;

        $spec = $_;
    }

    die "Specification file format error - no specification.\n"
        unless defined $spec;

    return $spec;
}

# Create a formatting function that can be used to apply data to a
# specification.
#
# Formatting function takes a list of data values to apply to replacement
# tokens.
#
# Given spec 'word aaa blah bbb cheese ccc bar aaa'
# With token list is 'aaa', 'bbb', 'ccc',
# and data 111, 222, 333
# The result is 'word 111 blah 222 cheese 333 bar 111'
# 
sub Make_Formatter {
    my $spec = shift;
    my @replacement_tokens = @_;

    # formatter expects a list of data values.
    return sub {
        my $new_line = $spec;

        die "More data than tokens\n" 
            if @_ > @replacement_tokens;

        for ( 0..$#replacement_tokens ) {

            my $token = $replacement_tokens[$_];
            my $value = $_[$_];

            if ( not defined $value ) {
                die "No data for '$token'\n"; 
                $value = '<UNDEF>';
            }

            $new_line =~ s/$token/$value/g;

        }

        return $new_line;
    };
}

# Process a data file and print a set of formatted data.
sub Print_Formatted_Data {
    my $format    = shift; # Formatter function
    my $data_file = shift; # Path to data file.

    open( my $data_fh, '<', $data_file )
        or die "Unable to open data file '$data_file' - $!\n";

    while ( my $raw_data = <$data_fh> ) { 
        my @data_set  = split /\s+/, $raw_data;

        eval { 
            my $formatted = $format->(@data_set);

            print $formatted;
            1;
        }
        or do {
            warn "Error processing line $. of '$data_file' - $@";
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T07:11:13.200

尝试这个：

```
my $file1 = shift @ARGV;
my $file2 = shift @ARGV;

open F2, $file2 or die $!;
chomp(my $template = <F2>);
my @fields = split/\s+/,$template;
close F2;

open F1, $file1 or die $!;
while (<F1>) {
    chomp;
    ($val1,$val2) = split/\s+/;
    print join("\t",$fields[0],$val1,$fields[2],$val2),"\n";

}
close F1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-22T22:18:49.490

希望这对你有用。

```
#! /usr/bin/env perl
use strict;
use warnings;
use 5.010;
use autodie;

my($in_file,$filter,$out_file);

if( @ARGV == 0 ){
  die "Must have filter at least\n";
}elsif( @ARGV == 1 ){
  ($filter) = @ARGV;
}elsif( @ARGV >= 2 ){
  ($in_file,$filter) = @ARGV;
}else{
  ($in_file,$filter,$out_file) = @ARGV;
}

{
  # autodie checks open() for errors
  # so we don't have to
  my($IN,$OUT);
  if( defined $in_file ){
    open $IN,  '<', $in_file;
  }else{
    $IN = *STDIN{IO};
  }
  if( defined $out_file ){
    open $OUT, '>', $out_file;
  }else{
    $OUT = *STDOUT{IO};
  }

  ProcessFiles($IN,$OUT,$filter);

  close $OUT;
  close $IN;
}

sub ProcessFilter{
  my($filter,$str) = @_;

  my @elem = grep {$_} split ' ', $str;

  $filter =~ s/\$(?|(?:{(\d+)})|(\d+))/ $elem[$1-1] /eg;

  return $filter;
}
sub ProcessFiles{
  my($IN,$OUT,$filter) = @_;

  while( my $line = <$IN> ){
    chomp $line;
    next unless $line;
    $line = ProcessFilter($filter,$line);
    say {$OUT} $line;
  }
} 
```

它以下列方式之一调用

```
perl program.pl <input-file> 'filter string' <output-file>
perl program.pl <input-file> 'filter string' # sends to STDOUT
perl program.pl 'filter string' # recieves from STDIN, sends to STDOUT 
```

如果这样调用

```
program.pl FILE1 'stringaa ${1} stringbb $2' 
```

它读取`FILE1`并输出：

```
stringaa ABC stringbb 123
stringaa DEF stringbb 456
stringaa GHI stringbb 111

```

# .net - 如何在visualstudio中混合不同的编译器版本程序：？

> ID：861766
> 
> 赞同：-1
> 
> 时间：2009-05-14T06:02:02.383
> 
> 标签：.net, visual-studio, c++-cli, visual-studio-2003

你好

我们的整个项目建立在 vs2003 上。之前他们在项目中使用了 SQLDMO。现在

我们已经计划使用 SQLSMO 代替它，它必须具有 .NETFRAMEWORK 2.0。但截至我的

Knowledge vs2003 在.netframework1.1 下运行。

现在我的问题是如何混合这两者。我的想法在我的机器里我已经有了

.NETFRAMEWORK 2.0 安装后使用 2.0 框架编译 SMO 项目（我编写了托管代码），然后

我可以把这个混到 VS2003 上吗？（当我尝试使用 msbuild.exe 时如何使用 .NET 框架进行编译，它显示项目需要打开并转换为最新版本错误，显示如何纠正这个错误）

（或者）

我需要迁移到 VS2005（仅最后一个选项）

帮帮我plzzzzzzzzzzzz

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T17:16:39.443

要做的第一件事——在 VS2008（或 2005，如果你不能得到 '8）中启动项目，看看它是如何转换的——很多东西实际上会很好地转换，没有那么多的重大变化。这将确定前进的痛苦程度。将其与较新版本的框架中的功能进行比较，您应该有一个相当容易做出的决定。

还要记住，如果某些组件几乎是死信，.NET 2.0 在大多数情况下肯定可以与 1.1 程序集对话和引用，因此如果某些部分无法转换但没有更改，您可以静态引用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T17:11:06.763

如果您需要使用 .NET 框架 2.0，您可以选择 Visual Studio 2005 或 VS2008。我的首选是 VS2008，因为您可以从中定位不同的 .NET 环境，而不是绑定到单个框架版本的早期 Visual Studio。

如果您有很多其他项目依赖于您，您要么也必须转换它们，要么留在 .NET 1.1 上而忘记 SQLSMO。我不认为你可以两者兼得。另一方面，如果有几个其他项目依赖于您生成符合 1.1 的程序集，那么您几乎会被 VS2003 卡住，并且可以（再次）忘记 SQLSMO。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T06:14:46.283

我的建议是不要尝试，在更高版本的 Visual Studio 上标准化，您可以轻松迁移解决方案/项目文件。

# sql - 如何避免 SQL 中的“除以零”错误？

> ID：861778
> 
> 赞同：421
> 
> 时间：2009-05-14T06:06:05.087
> 
> 标签：sql, sql-server, sql-server-2005, sql-server-2008

我有这个错误信息：

> 消息 8134，级别 16，状态 1，行 1 遇到除以零错误。

编写 SQL 代码以使我再也不会看到此错误消息的最佳方法是什么？

我可以执行以下任一操作：

*   添加 where 子句，使我的除数永远不会为零

或者

*   我可以添加一个 case 语句，以便对零进行特殊处理。

`NULLIF`是使用子句 的最佳方式吗？

有没有更好的方法，或者如何执行？

* * *

## 回答 #1

> 赞同：730
> 
> 时间：2009-05-14T06:10:49.243

为了避免“除以零”错误，我们将其编程如下：

```
Select Case when divisor=0 then null
Else dividend / divisor
End ,,, 
```

但这里有一个更好的方法：

```
Select dividend / NULLIF(divisor, 0) ... 
```

现在唯一的问题是记住 NullIf 位，如果我使用“/”键。

* * *

## 回答 #2

> 赞同：201
> 
> 时间：2012-01-04T12:06:40.987

如果您想返回零，以防发生零偏差，您可以使用：

```
SELECT COALESCE(dividend / NULLIF(divisor,0), 0) FROM sometable 
```

对于每个为零的除数，您将在结果集中得到一个零。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2013-12-17T16:22:04.257

## 当我试图解决除以零时，这似乎是我的情况的最佳解决方案，这确实发生在我的数据中。

假设您要计算各个学校俱乐部的男女比例，但您发现以下查询失败并在尝试计算没有女性的魔戒俱乐部的比例时出现除零错误：

```
SELECT club_id, males, females, males/females AS ratio
  FROM school_clubs; 
```

您可以使用该函数`NULLIF`来避免被零除。`NULLIF`比较两个表达式，如果相等则返回 null，否则返回第一个表达式。

将查询重写为：

```
SELECT club_id, males, females, males/NULLIF(females, 0) AS ratio
  FROM school_clubs; 
```

任何数字除以give ，都不会产生错误`NULL`。`NULL`

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2011-06-30T11:29:52.410

您也可以在查询开头执行此操作：

```
SET ARITHABORT OFF 
SET ANSI_WARNINGS OFF 
```

因此，如果您有类似的东西`100/0`，它将返回 NULL。我只为简单的查询做了这个，所以我不知道它会如何影响更长/复杂的查询。

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2015-11-26T17:45:47.537

您至少可以阻止查询因错误而中断并`NULL`在除以零时返回：

```
SELECT a / NULLIF(b, 0) FROM t 
```

但是，我**永远不会**将其转换为零，`coalesce`就像其他答案中显示的那样，它得到了很多赞成。这在数学意义上是完全错误的，甚至是危险的，因为您的应用程序可能会返回错误和误导性的结果。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2009-05-14T15:54:38.607

编辑：我最近对此有很多反对意见......所以我想我只是添加一个注释，这个答案是在问题经历它最近的编辑之前写的，其中返回 null 被突出显示为一个选项.. .这似乎很可接受。在评论中，我的一些回答是针对像 Edwardo 这样的担忧，他似乎主张返回 0。这就是我所反对的情况。

回答：我认为这里有一个潜在的问题，即除以 0 是不合法的。这表明某些事情在根本上是错误的。如果你除以零，你正在尝试做一些在数学上没有意义的事情，所以你得到的任何数字答案都不会是有效的。（在这种情况下使用 null 是合理的，因为它不是将在以后的数学计算中使用的值）。

因此，Edwardo 在评论中询问“如果用户输入 0 会怎样？”，他主张应该可以得到 0 作为回报。如果用户在金额中输入零，并且您希望在他们这样做时返回 0，那么您应该在业务规则级别输入代码以捕获该值并返回 0...没有一些除以 0 = 的特殊情况0。

这是一个微妙的区别，但它很重要......因为下次有人调用你的函数并期望它做正确的事情时，它会做一些在数学上不正确的时髦的事情，但只是处理它有一个特定的边缘情况以后咬人的好机会。你并没有真正除以 0……你只是对一个糟糕的问题返回了一个糟糕的答案。

想象一下，我正在编写一些东西，但我把它搞砸了。我应该读取辐射测量缩放值，但在一个我没有预料到的奇怪边缘情况下，我读取了 0。然后我将我的值放入你的函数中......你给我一个 0！万岁，无辐射！除了它真的在那里，只是我传递了一个错误的价值......但我不知道。我希望除法抛出错误，因为它是出现问题的标志。

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2009-08-25T22:02:02.603

```
SELECT Dividend / ISNULL(NULLIF(Divisor,0), 1) AS Result from table 
```

通过用 nullif() 捕捉零，然后用 isnull() 捕捉到的 null，您可以避免除以零错误。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2018-04-24T07:09:53.250

用零代替“除以零”是有争议的——但这也不是唯一的选择。在某些情况下，用 1 代替是（合理地）合适的。我经常发现自己在使用

```
 ISNULL(Numerator/NULLIF(Divisor,0),1) 
```

当我查看分数/计数的变化时，如果我没有数据，则希望默认为 1。例如

```
NewScore = OldScore *  ISNULL(NewSampleScore/NULLIF(OldSampleScore,0),1) 
```

通常情况下，我实际上已经在其他地方计算了这个比率（尤其是因为它可以为低分母抛出一些非常大的调整因子。在这种情况下，我通常会控制 OldSampleScore 大于阈值；然后排除零.但有时'hack'是合适的。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-14T06:15:36.063

我写了一个函数来处理我的[存储过程](http://en.wikipedia.org/wiki/Stored_procedure)：

```
print 'Creating safeDivide Stored Proc ...'
go

if exists (select * from dbo.sysobjects where  name = 'safeDivide') drop function safeDivide;
go

create function dbo.safeDivide( @Numerator decimal(38,19), @divisor decimal(39,19))
   returns decimal(38,19)
begin
 -- **************************************************************************
 --  Procedure: safeDivide()
 --     Author: Ron Savage, Central, ex: 1282
 --       Date: 06/22/2004
 --
 --  Description:
 --  This function divides the first argument by the second argument after
 --  checking for NULL or 0 divisors to avoid "divide by zero" errors.
 -- Change History:
 --
 -- Date        Init. Description
 -- 05/14/2009  RS    Updated to handle really freaking big numbers, just in
 --                   case. :-)
 -- 05/14/2009  RS    Updated to handle negative divisors.
 -- **************************************************************************
   declare @p_product    decimal(38,19);

   select @p_product = null;

   if ( @divisor is not null and @divisor <> 0 and @Numerator is not null )
      select @p_product = @Numerator / @divisor;

   return(@p_product)
end
go 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-08-25T22:10:48.247

1.  `Divisor`添加强制为非零的 CHECK 约束
2.  向表单添加验证器，以便用户无法在此字段中输入零值。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-09-16T13:28:54.787

对于更新 SQL：

```
update Table1 set Col1 = Col2 / ISNULL(NULLIF(Col3,0),1) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-14T15:49:45.263

没有神奇的全局设置“关闭除以 0 异常”。操作必须抛出，因为 x/0 的数学含义与 NULL 的含义不同，所以不能返回 NULL。我假设您正在处理显而易见的问题，并且您的查询具有应该消除除数为 0 的记录并且从不评估除法的条件。通常的“陷阱”比大多数开发人员期望的 SQL 表现得像过程语言并提供逻辑运算符短路，但它**不是**。我建议你阅读这篇文章：[http ://www.sqlmag.com/Articles/ArticleID/9148/pg/2/2.html](http://www.sqlmag.com/Articles/ArticleID/9148/pg/2/2.html)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-04-19T14:58:05.493

这是您可以除以零的情况。业务规则是，要计算库存周转率，您需要计算一段时间内的销售成本，然后将其年化。获得年化数字后，除以该期间的平均库存。

我正在研究计算三个月内发生的库存周转次数。我已经计算出我在三个月内销售的商品成本为 1,000 美元。年销售额为 4,000 美元（1,000 美元/3）*12。期初库存为 0。期末库存为 0。我现在的平均库存为 0。我的年销售额为 4000 美元，没有库存。这会产生无限数量的转弯。这意味着我所有的库存都被客户转换和购买。

这是如何计算库存周转的业务规则。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-09-08T15:00:10.147

```
CREATE FUNCTION dbo.Divide(@Numerator Real, @Denominator Real)
RETURNS Real AS
/*
Purpose:      Handle Division by Zero errors
Description:  User Defined Scalar Function
Parameter(s): @Numerator and @Denominator

Test it:

SELECT 'Numerator = 0' Division, dbo.fn_CORP_Divide(0,16) Results
UNION ALL
SELECT 'Denominator = 0', dbo.fn_CORP_Divide(16,0)
UNION ALL
SELECT 'Numerator is NULL', dbo.fn_CORP_Divide(NULL,16)
UNION ALL
SELECT 'Denominator is NULL', dbo.fn_CORP_Divide(16,NULL)
UNION ALL
SELECT 'Numerator & Denominator is NULL', dbo.fn_CORP_Divide(NULL,NULL)
UNION ALL
SELECT 'Numerator & Denominator = 0', dbo.fn_CORP_Divide(0,0)
UNION ALL
SELECT '16 / 4', dbo.fn_CORP_Divide(16,4)
UNION ALL
SELECT '16 / 3', dbo.fn_CORP_Divide(16,3)

*/
BEGIN
    RETURN
        CASE WHEN @Denominator = 0 THEN
            NULL
        ELSE
            @Numerator / @Denominator
        END
END
GO 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-14T06:12:55.680

使用 where 子句过滤掉数据，这样您就不会得到 0 值。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-11-27T17:11:06.327

有时，0 可能不合适，但有时 1 也不合适。有时，从 0 到 100,000,000 的跳跃被描述为 1% 或 100% 的变化也可能具有误导性。在这种情况下，100,000,000% 可能是合适的。这取决于您打算根据百分比或比率得出什么样的结论。

例如，一个非常小的销售项目从 2 到 4 销售和一个非常大的销售项目从 1,000,000 变为 2,000,000 销售可能对分析师或管理层来说意味着非常不同的事情，但都会以 100% 或 1改变。

隔离 NULL 值可能比搜索一堆 0% 或 100% 与合法数据混合的行更容易。通常，分母中的 0 可能表示错误或缺失值，您可能不想仅仅为了使数据集看起来整洁而填写任意值。

```
CASE
     WHEN [Denominator] = 0
     THEN NULL --or any value or sub case
     ELSE [Numerator]/[Denominator]
END as DivisionProblem 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-07-16T16:51:43.390

这就是我修复它的方法：

```
IIF(ValueA != 0, Total / ValueA, 0) 
```

它可以包含在更新中：

```
SET Pct = IIF(ValueA != 0, Total / ValueA, 0) 
```

或在选择中：

```
SELECT IIF(ValueA != 0, Total / ValueA, 0) AS Pct FROM Tablename; 
```

想法？

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-06-29T03:13:26.880

当错误传播回调用程序时，您可以适当地处理错误（或者如果这是您想要的，则忽略它）。在 C# 中，SQL 中发生的任何错误都会引发我可以捕获然后在我的代码中处理的异常，就像任何其他错误一样。

我同意 Beska 的观点，因为您不想隐藏错误。您可能不是在处理核反应堆，但隐藏错误通常是不好的编程习惯。这是大多数现代编程语言实现结构化异常处理以将实际返回值与错误/状态代码解耦的原因之一。当你做数学时尤其如此。最大的问题是您无法区分返回的正确计算的 0 或错误导致的 0。相反，返回的任何值都是计算值，如果出现任何问题，则会引发异常。这当然会根据您访问数据库的方式和使用的语言而有所不同，但您应该始终能够获得可以处理的错误消息。

```
try
{
    Database.ComputePercentage();
}
catch (SqlException e)
{
    // now you can handle the exception or at least log that the exception was thrown if you choose not to handle it
    // Exception Details: System.Data.SqlClient.SqlException: Divide by zero error encountered.
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-01-26T16:48:31.033

`NULLIF(exp,0)`但以这种方式使用-`NULLIF(ISNULL(exp,0),0)`

`NULLIF(exp,0)`如果 exp 是则中断`null`但`NULLIF(ISNULL(exp,0),0)`不会中断

# security - PHP 中的 htmlspecialchars() 或 Ruby on Rails 中的 h() 是否足以防御所有 XSS（跨站点脚本）攻击？

> ID：861781
> 
> 赞同：2
> 
> 时间：2009-05-14T06:07:21.187
> 
> 标签：security, xss

`htmlspcialchars($user_data)`PHP 或Ruby on Rails是否`h(user_data)`足以防御所有 XSS（跨站点脚本）攻击？使用的编码或任何其他可能的考虑因素如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T07:55:43.063

`htmlspecialchars`和转义`h`所有可能在 HTML 中具有特殊含义的字符，没有办法将文字 HTML 注入目标页面。

但是，有一些方法可以执行（危险的）Javascript，而不需要 HTML 注入。例如，如果您有一个转换`[img http://example.com/img.jpg]`为的应用程序`<img src="http://example.com/img.jpg/>`，想象一下如果用户输入 会发生什么`[img javascript:alert(document.cookies);]`。转义 HTML 字符不会将您保存在这里，您必须清理给定的 URL。[这是一个相当全面的可能的 XSS 漏洞示例列表](http://ha.ckers.org/xss.html)。

如果您始终使用`htmlspecialchars`/`h` *并且*始终完全清理用作任何 HTML 元素中的属性值的用户输入，那么您就有了适当的 XSS 防御。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T07:49:35.417

一般来说，存在[三种不同类型的 XSS](http://en.wikipedia.org/wiki/Cross-site_scripting#Types)：*基于 DOM 的*、*非持久*的和*持久*的。

现在服务器端语言只能防止后两种（*非持久性*和*持久性*），因为第一种只发生在客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T07:55:01.690

如果您不允许在帖子中使用 HTML 标签，您也可以尝试使用 strip_tags。还可以查看[html 净化器](http://htmlpurifier.org/)

# jquery - 如何从 jQuery 调用 Web 服务

> ID：861784
> 
> 赞同：28
> 
> 时间：2009-05-14T06:09:12.287
> 
> 标签：jquery, web-services

我想从 jQuery 调用 web 服务。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-14T06:15:36.657

您可以像任何其他请求一样发出 AJAX 请求：

```
$.ajax( {
type:'Get',
url:'http://mysite.com/mywebservice',
success:function(data) {
 alert(data);
}

}) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T06:24:19.973

编辑：

OP 不打算使用跨域请求，但 jQuery 从 v1.5 开始支持 JSONP。请参阅[jQuery.ajax()](http://api.jquery.com/jQuery.ajax/)，特别是`crossDomain`参数。

~~常规的 jQuery Ajax 请求无法跨站点工作，因此如果您想查询远程 RESTful Web 服务，您可能必须在您的服务器上创建一个代理并使用 jQuery get 请求进行查询。有关示例，请参[见此站点。](http://jquery-howto.blogspot.com/2009/04/cross-domain-ajax-querying-with-jquery.html)~~

~~如果它是 SOAP Web 服务，您可能想尝试[jqSOAPClient 插件](http://plugins.jquery.com/project/jqSOAPClient)。~~

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-03T13:45:14.673

我写了一篇关于如何使用 jQuery 使用 WCF 服务的博客：

[http://yoavniran.wordpress.com/2009/08/02/creating-a-webservice-proxy-with-jquery/](http://yoavniran.wordpress.com/2009/08/02/creating-a-webservice-proxy-with-jquery/)

这篇文章展示了如何直接在 javascript 中创建服务代理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-29T15:29:15.573

以防人们在遵循 Marwan Aouida 的回答后遇到像我这样的问题......代码有一个小错字。而不是“成功”它说“成功”改变拼写和代码工作正常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-19T06:29:05.167

在 Java 中，此返回值因 jQuery Ajax GET 失败：

```
return Response.status(200).entity(pojoObj).build(); 
```

但这有效：

```
ResponseBuilder rb = Response.status(200).entity(pojoObj);
return rb.header("Access-Control-Allow-Origin", "*").build();

---- 
```

全班：

```
@Path("/password")
public class PasswordStorage {
    @GET
    @Produces({ MediaType.APPLICATION_JSON })
    public Response getRole() {
        Contact pojoObj= new Contact();
        pojoObj.setRole("manager");

        ResponseBuilder rb = Response.status(200).entity(pojoObj);
        return rb.header("Access-Control-Allow-Origin", "*").build();

        //Fails jQuery: return Response.status(200).entity(pojoObj).build();
    }
} 
```

# nginx - nginx无法启动

> ID：861792
> 
> 赞同：3
> 
> 时间：2009-05-14T06:11:46.870
> 
> 标签：nginx

当我们尝试启动 Nginx（在 Ubuntu 上）“”正在启动 nginx“/usr/local/nginx/on”“没有这样的文件或目录”“”时，我们遇到了以下错误

它开始突然出现。

有没有人遇到过这种情况？任何指针？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T14:47:58.180

您似乎没有运行 apt-get 提供的 Nginx，因为该 Nginx 将以“sudo /usr/sbin/nginx”启动。你的 nginx 二进制文件真的放在“/usr/local/nginx/on”吗？你是从哪里得到这个表格的？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-05T21:18:35.003

我的 ubuntu 安装使用服务来启动 nginx：

```
sudo service nginx start 
```

如果错误消息出现在日志文件而不是 shell 中，那么我认为丢失的文件可能是 nginx.conf 或另一个 conf 文件包含的内容。您最近是否添加了任何配置或删除了任何配置？

如果它出现在 shell 中，那么很可能是您的 nginx 安装中出现了问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-22T16:55:31.300

这里的问题可能是您的某个`access_log on;`配置文件中有类似的东西。只需更改`on`为`path/to/your/logfile`:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T09:04:12.480

我的 Ubuntu 服务器上安装了 nginx，但没有`/usr/local/nginx/on`.

我从`/etc/init.d/nginx on`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-31T04:36:26.077

你只需要共同创建目录 /usr/local/nginx 可写到 nginx 进程

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-10T13:19:15.110

我有完全相同的问题（“没有这样的文件或目录”mgs），原因如下 - 文件**有错误的回车符号**。就如此容易！我在 Windows 上，我的文本编辑器插入 CR+LF 用于回车，而 Unix 只接受 LF，否则无法解析文件。

您可以在此处阅读如何将 bash 脚本从 Windows 转换为 Unix 的更多详细信息 - [http://kb.iu.edu/data/acux.html](http://kb.iu.edu/data/acux.html)

# c - 使用 fscanf() 读取一行时遇到问题

> ID：861793
> 
> 赞同：6
> 
> 时间：2009-05-14T06:12:25.043
> 
> 标签：c, file, input, std

我正在尝试使用以下代码读取一行：

```
while(fscanf(f, "%[^\n\r]s", cLine) != EOF )
{
    /* do something with cLine */
} 
```

但不知何故，我每次都只得到第一行。这是读一行的坏方法吗？我应该修复什么以使其按预期工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-14T06:19:16.820

使用该函数几乎*总是*`fscanf()`一个坏主意，因为它会使您的文件指针在失败时留在未知位置。

我更喜欢使用`fgets()`让每一行进入然后`sscanf()`那个。然后，您可以继续检查您认为合适的读入行。就像是：

```
#define LINESZ 1024
char buff[LINESZ];
FILE *fin = fopen ("infile.txt", "r");
if (fin != NULL) {
    while (fgets (buff, LINESZ, fin)) {
        /* Process buff here. */
    }
    fclose (fin);
} 
```

`fgets()`似乎是您正在尝试做的事情，在字符串中读取直到遇到换行符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-15T11:59:07.460

如果您想逐行读取文件（此处，行分隔符 == '\n'），只需执行以下操作：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char **argv)
{
        FILE *fp;
        char *buffer;
        int ret;

        // Open a file ("test.txt")
        if ((fp = fopen("test.txt", "r")) == NULL) {
                fprintf(stdout, "Error: Can't open file !\n");
                return -1;
        }
        // Alloc buffer size (Set your max line size)
        buffer = malloc(sizeof(char) * 4096);
        while(!feof(fp))
        {
                // Clean buffer
                memset(buffer, 0, 4096);
                // Read a line
                ret = fscanf(fp, "%4095[^\n]\n", buffer);
                if (ret != EOF) {
                        // Print line
                        fprintf(stdout, "%s\n", buffer);
                }
        }
        // Free buffer
        free(buffer);
        // Close file
        fclose(fp);
        return 0;
} 
```

享受 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-08T12:29:18.060

使用 fscanf 读取/标记文件总是会导致代码脆弱或痛苦和痛苦。读取一行并标记或扫描该行是安全且有效的。它需要更多的代码行——这意味着你需要更长的时间来思考你想要做什么（并且你需要处理有限的输入缓冲区大小）——但在那之后，生活就变得不那么糟糕了。

不要与 fscanf 战斗。只是不要使用它。曾经。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T07:27:03.787

如果你尝试一下`while( fscanf( f, "%27[^\n\r]", cLine ) == 1 )`，你可能会有更多的运气。与您原来的三个变化：

*   长度限制读取的内容 - 我在`27`这里用作示例，不幸的是，该`scanf()`系列要求格式字符串中的字段宽度，并且不能使用can 传递值的`*`机制`printf()`
*   去掉`s`格式字符串中的 -`%[`是“所有匹配或不匹配集合的字符”的格式说明符，该集合由 a`]`自行终止
*   将返回值与您期望发生的转化次数进行比较（为了便于管理，请确保该数字为 1）

也就是说，通过使用`fgets()`尽可能多的行来读取适合缓冲区的内容，您将获得相同的结果，而且痛苦更少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T06:17:32.877

在我看来，您正在尝试在 fscanf 字符串中使用正则表达式运算符。该字符串 `[^\n\r]`对 fscanf 没有任何意义，这就是您的代码无法按预期工作的原因。

此外，如果项目不匹配， fscanf() 不会返回 EOF。相反，它返回一个表示匹配数的整数——在您的情况下可能为零。EOF 仅在流结束时或出现错误时返回。因此，在您的情况下发生的情况是，对 fscanf() 的第一次调用会一直读取到文件末尾以查找匹配的字符串，然后返回 0 以让您知道未找到匹配项。然后第二个调用返回 EOF，因为已读取整个文件。

最后，请注意 %s scanf 格式运算符仅捕获到下一个空白字符，因此您在任何情况下都不需要排除 \n 或 \r。

有关更多信息，请参阅 fscanf 文档：[http ://www.cplusplus.com/reference/clibrary/cstdio/fscanf/](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T07:22:43.937

您的循环有几个问题。你写了：

```
while( fscanf( f, "%[^\n\r]s", cLine ) != EOF ) 
    /* do something */; 
```

需要考虑的一些事项：

1.  fscanf() 返回存储的项目数。如果它读取到文件末尾或文件句柄有错误，它可以返回 EOF。您需要区分有效的零返回，在这种情况下，缓冲区中没有新内容与`cLine`成功读取。

2.  当发生匹配失败时，您会遇到问题，因为很难预测文件句柄现在在流中指向的位置。这使得从失败的匹配中恢复比预期的更难。

3.  您编写的模式可能没有达到您的预期。它匹配任意数量的不是 CR 或 LF 的字符，然后期望找到一个文字`s`.

4.  你还没有保护你的缓冲区免于溢出。无论分配给该缓冲区的大小如何，都可以从文件中读取任意数量的字符并将其写入缓冲区。这是一个不幸的常见错误，在许多情况下，攻击者可以利用该错误来运行攻击者选择的任意代码。

5.  除非您特别要求`f`以二进制模式打开，否则行结束翻译将发生在库中，您通常不会看到 CR 字符，通常不会出现在文本文件中。

您可能想要一个更像以下的循环：

```
while(fgets(cLine, N_CLINE, f)) {
    /* do something */ ;
} 
```

其中 N_CLINE 是缓冲区中可用的字节数，以`cLine`.

该`fgets()`函数是从文件中读取一行的首选方法。它的第二个参数是缓冲区的大小，它从文件中读取最多小于该大小的 1 个字节到缓冲区中。它总是用一个字符终止缓冲区，`nul`以便可以安全地将其传递给其他 C 字符串函数。

它在文件末尾、换行符或`buffer_size-1`读取的字节的第一个处停止。

它将换行符留在缓冲区中，这一事实使您可以区分比缓冲区长的单行和比缓冲区短的行。

如果由于文件结尾或错误而没有复制任何字节，则返回 NULL，否则返回指向缓冲区的指针。您可能想要使用`feof()`和/或`ferror()`区分这些情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-30T22:55:36.760

我认为这段代码的问题是因为当你用 %[^\n\r]s 阅读时，事实上，你阅读直到到达 '\n' 或 '\r'，但你没有阅读 '\n ' 或 '\r' 也是。因此，您需要在循环中再次使用 fscanf 读取之前获取此字符。做这样的事情：

```
do{
    fscanf(f, "%[^\n\r]s", cLine) != EOF

    /* Do something here */

}while(fgetc(file) != EOF) 
```

# cakephp - 如何在用户注册 CakePHP 后立即自动登录？

> ID：861796
> 
> 赞同：1
> 
> 时间：2009-05-14T06:13:38.033
> 
> 标签：cakephp

我正在使用 cakephp 框架来构建我的应用程序。我希望这样，每当用户注册时，他都会自动登录并显示特定页面。请告诉我如何实现此功能？使用 xampp，在 winXP 上使用 php 5.2 和 mysql 5.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T07:26:26.113

好吧，归结为以下几点：

*   当您的用户注册时，存储他的登录凭据
*   调用 $this->Auth->login()
*   重定向到您的页面

在此处查看有关 Auth::login() 的更多信息：

[http://api.cakephp.org/class/auth-component#method-AuthComponentlogin](http://api.cakephp.org/class/auth-component#method-AuthComponentlogin)

# javascript - 使用 javascript 禁用 FCKeditor 不起作用

> ID：861799
> 
> 赞同：0
> 
> 时间：2009-05-14T06:14:18.157
> 
> 标签：javascript, fckeditor

```
<script type="text/javascript">
window.onload = function()
{
    var oFCKeditor = new FCKeditor( 'content' ) ;
    oFCKeditor.BasePath = "js/Javascript/fckeditor/" ;
    oFCKeditor.Height = 300;
    oFCKeditor.Width = 600;
    oFCKeditor.ReplaceTextarea() ;
}
function fnenable(){
    var myValue=document.getElementById("checkbox1").checked;
    var oEditor = FCKeditorAPI.GetInstance('content');
    if(myValue==true) { 
        oEditor.EditorDocument.body.disabled=false;
    } else {
        oEditor.EditorDocument.body.disabled=true;
    }
}
</script> 
```

我已经关注了网站[http://www.fckeditor.net/forums/viewtopic.php?f=5&t=69](http://www.fckeditor.net/forums/viewtopic.php?f=5&t=69)。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T06:24:32.953

作为替代方案，我建议 TinyMCE：

[http://tinymce.moxiecode.com/](http://tinymce.moxiecode.com/)

抱歉，太久没用FCKeditor了。我的直觉告诉我，这取决于您如何尝试获得“body”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T21:13:37.103

你有没有试过这个：

```
editorInstance.EditorDocument.body.contentEditable='false'; 
editorInstance.EditorDocument.designMode='off'; 
```

我还建议将编辑器升级到新的 CKEDITOR（不带 F）：[http ://ckeditor.com/](http://ckeditor.com/)

# html - webkit浮动问题

> ID：861800
> 
> 赞同：3
> 
> 时间：2009-05-14T06:14:19.513
> 
> 标签：html, css, webkit, css-float

我有一些问题，我设置了 2 个浮动 div 元素，其中一个 div 包含**选择**元素，当页面加载时 div 没有问题，但是一旦我单击选择框上的元素，div定位在右移到底部？

这里有一些关于我在说什么的示例代码：

```
 #div1,#div2{float:left}
#div1{width:200px;margin-right:10px}
#div2{width:760px} 
```

和html

```
<div id="wrapper">
  <div id="div1"><!--here the select goes--></div>
  <div id="div2"><!--here the table goes--></div>
</div> 
```

这里是之后和之前发生的事情的截图：
[截图](http://img526.imageshack.us/img526/6834/screenshot.jpg)

完全不涉及 javascript

我已经使用 Opera (Presto)、Firefox (Gecko)、IE8 (Trident) 进行了测试，没有问题，似乎它只出现在基于 Webkit 的浏览器上，因为我已经在 Chrome 2、SR Iron 和 QTWeb 上进行了测试

PS：尽量忽略丑陋的表头，很快我会修复它（目前在 Opera、Firefox、IE8 浏览器上都可以）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T13:08:59.707

在 css 中尝试：

```
#div1{width:200px;margin-right:10px;float:left;}
#div2{width:760px;float:right;} 
```

希望这将解决选择问题，但因为您使用固定尺寸，如果窗口尺寸太小，它仍然会中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-15T10:10:06.033

如果您只想使用 css 定位 webkit 浏览器：

```
@media screen and (-webkit-min-device-pixel-ratio:0)
{    
    "element/class or id here"{
      whatever you need here, ie: padding-top: 24px;
    }    
} 
```

# php - 在 PDF 中插入换行符

> ID：861809
> 
> 赞同：40
> 
> 时间：2009-05-14T06:15:51.943
> 
> 标签：php, pdf, fpdf, carriage-return

我正在使用 PHP 即时生成一些 PDF 文件。我的问题是我需要在将插入 PDF 文件中的部分文本中插入换行符。就像是：

```
$pdf->InsertText('Line one\n\nLine two'); 
```

所以它打印：

> 第一行
> 
> 第二行

我知道`\n`不适用于 PDF，但是你们知道代表这些文件的换行符的任何字符或东西吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-14T06:36:16.543

如果您使用的是 fpdf，为了能够使用换行符，您需要使用[此处所述的多行文本单元格](http://www.fpdf.org/en/doc/multicell.htm)。

如果你使用它，那么你的文本中的换行符应该被正确解释和转换。

只是一个简单的例子：

```
$pdf->Multicell(0,2,"This is a multi-line text string\nNew line\nNew line"); 
```

这里，2 是多行文本框的高度。我不知道测量单位是什么，或者您是否可以将其设置为 0 并忽略它。如果一开始不起作用，也许可以尝试大量尝试。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-14T10:42:44.347

您的代码读取

```
$pdf->InsertText('Line one\n\nLine two'); 
```

我不知道您正在使用的 PDF 库，但通常如果您希望 \n 被解释为换行符，您必须在 PHP 中使用双引号，例如

```
$pdf->InsertText("Line one\n\nLine two"); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-06-25T17:02:15.407

我更改`'\n'`了**chr(10)**并且它起作用了：

```
$pdf->MultiCell(0,5,utf8_decode($variable1 . chr(10) . $variable2),1); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-02-02T03:29:52.133

你说

> 2是多行文本框的高度

不，这不对。2 是文本行之间的距离。

我认为没有一种真正的方法可以计算实际结果文本框的高度，除非您使用`GetY()`然后减去`SetXY()`语句中使用的原始 Y 值来首先放置 Multicell。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-06-20T02:46:35.617

另一种选择是使用[`TCPDF::Ln()`](http://www.tcpdf.org/doc/code/classTCPDF.html#a00969cf629d72b3d29ee435f15906820). 它在 PDF 中添加了一行，并带有设置高度的选项。

如果换行符已经在您的内容中，那么[`MultiCell()`](http://www.tcpdf.org/doc/code/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece)可能是要走的路，正如其他人所提到的，但我发现我喜欢使用：

```
$pdf->Cell(0, 0, 'Line 1', 0, 0, 'C');
$pdf->Ln();
$pdf->Cell(0, 0, 'Line 2', 0, 0, 'C'); 
```

这让我感到困惑[`Cell()`](http://www.tcpdf.org/doc/code/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31)并[`MultiCell()`](http://www.tcpdf.org/doc/code/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece)接受不同的论点，所以我倾向于坚持[`Cell()`](http://www.tcpdf.org/doc/code/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31)只使用。此外，它读起来像 PDF 的换行符，就像`\n`读起来像文本或`<br>`HTML 中的换行符一样。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-11-11T08:13:53.637

在做了这么多噩梦之后，我找到了解决办法。

```
utf8_decode(chr(10)) 
```

我试过了`\n`，`<br/>`但`chr(10)`没有任何效果。然后我意识到它是`utf-8`并且只是尝试了上面的那个。它适用于`MultiCell`但不适用于`Cell`.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-08-27T10:43:02.197

我只是`\n`用“ `<br>`”标签替换了“”。工作得很好。似乎 TCPDF 将文本呈现为 HTML

```
$strText = str_replace("\n","<br>",$strText);
$pdf->MultiCell($width, $height,$strText, 0, 'J', 0, 1, '', '', true, null, true); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-05-23T11:04:28.870

```
MultiCell($w, $h, 'text<br />', $border=0, $align='L', $fill=1, $ln=0,
    $x='', $y='', $reseth=true, $reseth=0, $ishtml=true, $autopadding=true,
    $maxh=0); 
```

您可以将其配置为`MultiCell`在基本级别上读取 html。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-03-27T14:03:07.457

我找到的解决方案是：

```
$text = 'Line one\n\nLine two');
$text = explode('\n', $text);

foreach ($text as $txt){
    $pdf->Write($txt);
    $pdf->Ln();
} 
```

因此，这样，您可以在任何位置有任意数量的 \n，如果您从数据库中动态地获取此文本，它将正确地换行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-05-14T03:10:15.287

```
$pdf->SetY($Y_Fields_Name_position);
$pdf->SetX(#);
$pdf->MultiCell($height,$width,"Line1 \nLine2 \nLine3",1,'C',1); 
```

在每一列中，在设置 X 位置之前，首先指示 Y 位置，所以它变成了这样

第 1 列

```
$pdf->SetY($Y_Fields_Name_position);
$pdf->SetX(#);
$pdf->MultiCell($height,$width,"Line1 \nLine2 \nLine3",1,'C',1); 
```

第 2 栏

```
$pdf->SetY($Y_Fields_Name_position);
$pdf->SetX(#);
$pdf->MultiCell($height,$width,"Line1 \nLine2 \nLine3",1,'C',1); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-22T09:17:08.987

或者只是在每个文本段落之后尝试这个换行。

`$pdf->Write(0, ' ', '*', 0, 'C', TRUE, 0, false, false, 0) ;`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-04T16:25:40.603

也许为时已晚，但我以一种非常简单的方式解决了这个问题，我正在使用 Multicell 选项并且文本来自表单，如果我使用输入字段来获取文本，我无法在任何文本中插入换行符方式，但是如果使用 textarea 字段，则文本区域中的换行符是多单元格中的换行符......就是这样，即使我使用`utf8_encode($text)`选项来保留重音符号，它也可以工作

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-01T20:23:06.937

另一种解决方案（与 TCPDF 一起使用）

对长字符串使用 HEREDOC。例如，将 HERDOC 用于 CONST（定义不同的语言）

```
$_prepare_const_EN = <<<EOT
this is a long string
and new line as well ...
EOT;

$define('STR_EN', $_prepare_const_EN);

$pdf->InsertText(STR_EN); 
```

对我很有效....

# c++ - 在没有子类化的情况下验证 CEdit

> ID：861832
> 
> 赞同：1
> 
> 时间：2009-05-14T06:24:28.507
> 
> 标签：c++, mfc, cedit

有没有办法在没有子类化的情况下验证 CEdit 框的内容？

我想检查 CEdit 框中的无效文件名字符，并且根本不允许用户输入它（不应该记录按键，如果粘贴在框中，无效字符不应该进入编辑框）..

有什么简单的方法可以做到这一点？

附带说明一下，如何创建一个与此框相关的变量？如果我添加一个不是控件的变量，该变量是否总是包含编辑控件中的内容？

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:31:52.343

很久以前我创建了[这个](http://www.codeproject.com/KB/library/Validators.aspx)。当然，这是非常过时的，但想法仍然存在：

![替代文字](https://www.codeproject.com/KB/library/Validators/Validators.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T06:31:32.343

每[http://msdn.microsoft.com/en-us/library/f7yhsd2b(VS.80).aspx](http://msdn.microsoft.com/en-us/library/f7yhsd2b(VS.80).aspx)，“如果您想处理由编辑控件发送到其父级的 Windows 通知消息（通常是从 CDialog 派生的类)，为每条消息添加一个消息映射条目和消息处理程序成员函数到父类。" 和“ON_EN_UPDATE 编辑控件即将显示更改的文本。在控件格式化文本之后但在屏幕显示文本之前发送，以便在必要时可以更改窗口大小。” -- 因此，无需子类化 CEdit，您可以通过父级中的 Windows 消息映射/消息处理程序来审查并可能阻止更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:19:14.623

在对话框中覆盖 PreTranslateMessage。当消息是 WM_KEYDOWN 并且 GetFocus() 返回您的编辑控件的 HWND 时，当您不喜欢该键时吃掉消息。

# c# - 如何在 C# 中基于现有的委托类型创建新的委托类型？

> ID：861835
> 
> 赞同：19
> 
> 时间：2009-05-14T06:25:31.437
> 
> 标签：c#, inheritance, delegates

有什么方法可以基于现有的委托类型创建新的委托类型？就我而言，我想创建一个`MyMouseEventDelegate`与`EventHandler<MouseEventArgs>`.

我为什么要这个？当然，要利用**编译时类型检查**！这样，我可以有两个不同的代表：`MyRightClickHandler`和`MyLeftClickHandler`，并且永远不会混淆这两个代表——即使它们在功能上都与`EventHandler<MouseEventArgs>`.

是否有语法来做这种事情？

哦，像这样的代码：

```
using MyRightClickHandler = EventHandler<MouseEventArgs> 
```

不够好。它不进行任何类型检查，因为它实际上并没有创建新类型。而且我必须将这样一行粘贴到我要引用的每个代码文件中`MyRightClickHandler`。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-14T06:32:35.477

好吧，这就像从原始副本中复制委托声明一样简单。C# 中没有任何东西可以自动执行此操作，但我看不出这是一个很大的负担：

```
public delegate void MyLeftClickHandler(object sender, MouseEventArgs e);
public delegate void MyRightClickHandler(object sender, MouseEventArgs e); 
```

好像不会`MouseEventHandler`很快改变...

你是否真的因为在错误的地方使用了错误的代表而被错误所困扰？我不记得自己曾经发现过这个问题，在我看来，您正在引入更多工作（以及其他开发人员不熟悉的一组代表）-您确定值得吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-14T06:33:23.417

我只想实现编译时类型检查，我想为您描述的情况创建专门的 EventArgs 类就足够了。这样您仍然可以利用预定义的委托：

```
class RightMouseButtonEventArgs : MouseEventArgs {}
class LeftMouseButtonEventArgs : MouseEventArgs {}

EventHandler<RightMouseButtonEventArgs>
EventHandler<LeftMouseButtonEventArgs> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-01-21T02:25:11.443

不可以。根据[C# 文档](https://msdn.microsoft.com/en-us/library/ms173172.aspx)，委托类型是密封的，您不能创建从现有委托类型继承的新委托类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-05T16:21:41.497

我不相信[乔恩斯基特](https://stackoverflow.com/users/22656/jon-skeet)。我不得不自己尝试一下。他是对的。

```
public void F(object sender, MouseEventArgs e) {}; 
public MyLeftClickHandler l;
public MyRightClickHandler r;
public void Test()
{
    l = F;  // Automatically converted.
    r = F;  // Automatically converted to a different type.
    l = r;  // Syntax error.  Incompatible types.
    l = new MyLeftClickHandler(r);  // Explicit conversion works.
} 
```

那并不明显！

# javascript - Ajax：构建 HTML 与注入 HTML

> ID：861841
> 
> 赞同：5
> 
> 时间：2009-05-14T06:28:54.970
> 
> 标签：javascript, html, ajax, json, asynchronous

尝试遵循 StackOverflow 提出问题而不是创建讨论的建议，让我们考虑使用 HTTPAsyncRquest 更新网页而不刷新网页的这两种方法：

1) AsyncRequest 返回的数据被解析/解释，以构建更新页面的结果 HTML，例如 JSON::parseAndExecute(returnedData); // 只是一个例子

2) AsyncRequest 返回的数据是原始的 jScript，它被执行并更新页面。例如普通的旧：eval（returnedData）；// 我们知道返回的数据不是恶意代码

为了排除学术/偏好问题，假设我们使用完全相同的框架来编程服务器和客户端，唯一的区别是有一个选项/标志可以让它输出 JSON 或原始 jscript。

在那种情况下，是否有技术上的原因应该选择哪一个？

我问这个是因为在大多数情况下，原始 JSCRIPT 应该更快、更灵活，但我发现的大多数框架都不返回 JSCRIPT，而是返回由 JSCRIPT 解释的数据。

（澄清一下：我问的是它更小吗？更快？有安全风险吗？兼容性风险？）

在stackoverflow上的第一篇文章，耶！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:35:33.567

您的第二种解决方案通常会更快、更容易实施并且使用更少的带宽。如果您在例如 Ajax 框架中同时控制服务器端和客户端，那么安全性就没有问题。所以你唯一的问题是你最终得到一个（邪恶的）评估。无论如何，您必须拥有它，因为除了在 IE8 上之外，如果您的代码中没有至少一个 eval，则无法“解析”JSON。

我们（Ra-Ajax）为我们的 Ajax 引擎使用 JSON 和 HTML（所有实际问题的内部 HTML）的组合。我们使用 JSON 来更改小部件的属性和属性，而我们在小部件的初始渲染（或完整更新）中使用 innerHTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T14:51:30.310

@托马斯汉森：

也许更快，更容易实施。但我不明白为什么它会使用更少的带宽。加载页面的 Javascript 代码会被缓存，因此解析和小部件构建代码只会下载一次，动态内容只是纯 JSON。

您也可能更喜欢第一个选项（JSON），因为您正在以某种方式转换/过滤数据以响应其他 GUI 回调，并且不想依赖服务器。

# java - JDK 1.5 是否支持 -Xdebug 选项？

> ID：861842
> 
> 赞同：1
> 
> 时间：2009-05-14T06:29:23.050
> 
> 标签：java, trace, xdebug

我找不到任何合适的文档。无论如何，在运行 JVM 进程（最好是 SUN 在其 JDK 包中提供的工具）时生成跟踪报告的最佳方式是什么，以便记录任何 JVM 崩溃？

提前致谢，

z0ltan

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:56:51.660

根据[“java - Java 应用程序启动器”](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/java.html)，在 JDK1.5 文档中，XDebug 是一个非标准选项：

> 从启用对[JVMDI](http://java.sun.com/j2se/1.5.0/docs/guide/jpda/jvmdi-spec.html)的支持开始。JVMDI 已被弃用并且不用于在 J2SE 5.0 中进行调试，因此在 J2SE 5.0 中调试不需要此选项。

从 J2SE 5.0 开始不推荐使用 JVMDI。应该使用[JVMTI 。](http://java.sun.com/j2se/1.5.0/docs/guide/jvmti/jvmti.html/)

对于执行期间的跟踪，一些线索在[“我可以强制生成 JVM 崩溃日志文件吗？”这个问题中。](https://stackoverflow.com/questions/337793/can-i-force-generation-of-a-jvm-crash-log-file)，但主要用于JDK1.6。
对于 1.5，这些[故障排除工具](http://java.sun.com/j2se/1.5.0/docs/tooldocs/index.html#debug)可能很有用。

# python - django中循环的使用

> ID：861855
> 
> 赞同：5
> 
> 时间：2009-05-14T06:33:33.760
> 
> 标签：python, django, django-templates

我有一个网页正在循环，并在循环内使用循环。

```
{% for o in something %}
{% for c in o %}
 <div class="{% cycle 'white' 'black'%}"></div>
{% endfor %} 
```

现在，这意味着每次在循环内，第一个 div 标签变白。但是，我想要的是在白色和黑色之间交替，即从白色开始，然后下次在循环内时，第一个 div 标签用黑色开始。有可能在这里实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-09-22T02:03:26.807

有一个关于这个问题的接受[错误打开。](http://code.djangoproject.com/ticket/5908)您可能想尝试建议的更改，看看它是否适合您。

如果您不想尝试，或者它不起作用，请试一试：

```
{% cycle 'white' 'black' as divcolors %}
{% for o in something %}
    {% for c in o %}
        <div class="{% cycle divcolors %}"></div>
    {% endfor %}
{% endfor %} 
```

据我了解，循环将从白色开始，然后每次在循环内循环遍历这些值（这意味着您不会每次都以白色重新开始）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T07:10:21.017

像这样的东西可能有效（未经测试）：

```
{% for o in something %}
 {% for c in o %}
  {% ifchanged forloop.parent.counter %}
   <div class="{% cycle 'white' 'black' %}"></div>
  {% else %}
   <div class="{% cycle 'black' 'white' %}"></div>
  {% endifchanged %}
 {% endfor %}
{% endfor %} 
```

# python - 是否有 Python 的“安全”子集可用作嵌入式脚本语言？

> ID：861864
> 
> 赞同：13
> 
> 时间：2009-05-14T06:37:43.313
> 
> 标签：python, security, scripting, scripting-language, embedded-language

在我创建的许多 Python 应用程序中，我经常创建只包含常量的简单模块，以用作配置文件。此外，因为配置文件实际上是一个 Python 代码文件，所以我可以添加简单的逻辑来根据调试级别等更改变量。

虽然这对内部应用程序非常有用，但我会警惕将此类应用程序发布到野外，因为担心有人意外或恶意地向文件添加破坏性代码。使用 Python 作为嵌入式脚本语言也是如此。

是否有一个 Python 子集被认为是“安全”的嵌入？我意识到它可以被认为是多么安全是相当主观的。但是，Java Applet 和 Flash 都有明确定义的安全沙箱。我想知道是否存在具有类似规则的 Python 版本？

**编辑：**我不是因为配置文件方法而要求太多，而是因为我有兴趣在较新的应用程序中实现一些脚本/插件机制并且不希望插件或脚本能够删除文件。这超出了应用程序应该能够做的范围。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T07:12:56.847

这里有几个链接可以让您了解您所面临的问题：

*   [如何安全地运行不受信任的 Python 脚本（即沙盒）](https://wiki.python.org/moin/Asking%20for%20Help/How%20can%20I%20run%20an%20untrusted%20Python%20script%20safely%20(i.e.%20Sandbox))
*   [Python 的能力？](http://neopythonic.blogspot.com/2009/03/capabilities-for-python.html)由圭多本人

[在http://code.google.com/p/sandbox-python/](http://code.google.com/p/sandbox-python/)还有一个死谷歌代码项目

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T06:41:01.370

pypy 项目提供沙盒功能，请参阅[http://doc.pypy.org/en/latest/sandbox.html](http://doc.pypy.org/en/latest/sandbox.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T06:42:57.073

不，没有“安全”的 Python 生产就绪子集。Python 有一些沙盒模块，由于缺陷而被弃用。

你最好的选择是要么创建你自己的解析器，要么用系统调用钩子和一个被监禁的帐户隔离 python 进程。

有些人可能会将您指向 PyPy，但它尚未完成。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-16T01:30:08.100

如果您需要做的只是设置简单的变量、循环、条件和函数，那么PyMite[虚拟机就可以满足您的需求。](http://pythononachip.org)PyMite 很小，用 C 语言编写，使用静态内存池并且可以嵌入。它有一组极其有限的易于配置的内置函数。同样，唯一的标准库是 string、dict、list 和 sys 的部分实现。PyMite VM 是 python-on-a-chip 项目的一部分，因此它被设计为在微控制器上运行，但可以在 posix 风格的桌面系统上运行。缺点是 PyMite 没有像其他 Python 实现那样广泛调试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T07:09:14.250

AFAIK，在标准python库中进行了一些尝试，但没有成功。有关详细信息，请参阅[受限执行](http://docs.python.org/library/restricted.html)。

> 警告
> 
> 在 Python 2.3 中，由于各种已知且不易修复的安全漏洞，这些模块已被禁用。这些模块仍然记录在此处，以帮助阅读使用 rexec 和 Bastion 模块的旧代码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-24T01:49:19.857

tinypy ( [tinypy.org](http://tinypy.org) ) 是一个小型的、可嵌入的 Python 子集，以 Lua 风格编写。由于 lua 有一种创建沙盒的方式，我估计 tinypy 也可能会被黑客入侵。由于 tinypy 的代码库非常小，因此很容易学习并弄清楚如何更改内容以满足您的需求。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T07:15:18.853

> 我会警惕将此类应用程序发布到野外，因为担心有人意外或恶意地向文件添加破坏性代码。

“在野外”的本机代码同样容易受到这种攻击；它在机器代码中只是一个减速带，没有安全性。

如果您非常偏执并且想要更高的减速带，您可以让托管脚本实例的本机应用程序检查内容的哈希值。那么偶然的改变是不可能的；只有故意的更改才会麻烦更新校验和。您可以进一步检查它们是否也使用公钥签名；那么只有破解您的本机应用程序才能让新脚本进入。

但是沙盒呢？别担心！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T07:35:37.197

您可能会在 Silverlight/Moonlight 上尝试 IronPython，因为[这些人](http://www.trypython.org/)似乎正在做令人印象深刻的事情。[Resolver One 开发人员在此处](http://www.voidspace.org.uk/ironpython/silverlight/index.shtml#python-interactive-interpreter-in-a-browser)提供了有关这些类型的 IronPython 应用程序的大量重要信息。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-14T07:37:09.130

我不太了解您在 Java 虚拟机或 .NET 运行时中获得的确切安全功能，但您可能需要考虑使用[Jython](http://www.jython.org/Project/)或[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)运行您的 python 代码是否可以让您获得额外的安全性。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-16T09:27:19.593

有点难以理解你想要做什么——没有足够的细节。

您是否托管本机应用程序并允许用户编写插件？考虑使用 OS 级别的解决方案，将 Python 应用程序作为一个单独的运行时进程运行在 jail/chroot/similar 中，并通过套接字进行通信。

您是否希望您的客户托管本机应用程序并让“不受信任的各方”编写插件？上面的解决方案不起作用是有原因的吗？（例如，客户希望在没有这些选项的情况下部署在奇怪的操作系统上......）

您是否期望相同的人托管本机应用程序和“不受信任的脚本”并希望保护他们免受自己的侵害？在保护他们不写“os.remove”并让它做他们写的事情的意义上？你能解释一下为什么吗？

请注意，如果没有更严格的限制（最大 CPU 周期、最大内存、内存所有权问题......），单独使用沙盒通常是不够的？你想阻止什么样的恶意？请注意，在这里，操作系统也具有并非所有沙盒环境都复制的出色功能（优先级、终止进程、ulimit）——而且安全测试肯定不如操作系统中的东西。（在我相信 PyPy 不会使恶意编码器占用无限量的内存之前，我会相信 Linux 没有可破坏的 ulimit，这仅仅是因为 Linux 在野外受到了更多的攻击。）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T01:03:10.660

有关模块先前遇到的问题的一些讨论`rexec`：

*   [http://mail.python.org/pipermail/python-dev/2002-December/031160.html](http://mail.python.org/pipermail/python-dev/2002-December/031160.html)
*   [http://mail.python.org/pipermail/python-dev/2003-January/031848.html](http://mail.python.org/pipermail/python-dev/2003-January/031848.html)

这些来自[Restricted Execution HOWTO](http://www.amk.ca/python/howto/rexec/)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-16T02:00:45.537

这听起来像你想要的：[恢复 Python 受限模式](http://lwn.net/Articles/321872/)。

Python 解释器有一个内置的“受限”模式，通过改变`__builtins__`魔法变量来启用。文章[为保护 Python 解释器的安全铺平了道路](http://tav.espians.com/paving-the-way-to-securing-the-python-interpreter.html)，更详细地解释了这个技巧。请注意，要完全工作，它需要 Python 解释器的补丁；不知道是不是已经申请了。

有关纯 Python 概念验证，请参阅他之前的文章[A Challenge To Break Python Security](http://tav.espians.com/a-challenge-to-break-python-security.html)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-11T07:28:54.203

[starlark](https://github.com/google/starlark-go)是用 go 实现的 Python 的一个子集。

Google 将其用作构建工具 Bazel 的配置语言。令人沮丧的是，关于它的文档/细节很少，但它可能符合要求。

# asp.net-mvc - Spark View Engine 的性能与 ASP.NET 相比如何？

> ID：861866
> 
> 赞同：5
> 
> 时间：2009-05-14T06:39:27.053
> 
> 标签：asp.net-mvc, spark-view-engine, performance

我有兴趣将[Spark](http://sparkviewengine.com/)用于我的一个使用 asp.net mvc 框架运行的开源宠物项目。我想知道是否有人对它有真正的经验并且知道与普通的 asp.net 视图引擎相比它的性能如何？

我知道marketwatch.com 运行asp.net mvc 和Spark。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T23:22:38.277

视图模板被解析以生成和编译一个除了写输出之外什么都不做的类。在视图的第一个请求之后，除了创建该类型的实例并渲染之外，没有做任何实际的工作。

它已针对 CPU 和内存成本进行了相当广泛的分析。我相信可以安全地假设 Spark 中没有什么明显变慢的地方——而且一般来说，Spark 或 WebForms 视图引擎中的渲染不太可能成为实际应用程序中的瓶颈。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-16T04:11:24.227

[这](http://mogadanez.blogspot.com/2009/07/aspnet-mvc-speed-test.html)是一个将 WebForms 与 Spark 进行比较的基准测试。Spark 的得分比 WebForms 慢 36%，这可能值得为使用 Spark 获得的额外灵活性付出代价。

# c# - 如何在我的本地机器上访问 DTD 文件的 URI？

> ID：861870
> 
> 赞同：0
> 
> 时间：2009-05-14T06:41:03.413
> 
> 标签：c#, localhost, dtd

我有一个 DTD 文件，我以前通过这个链接访问过：

```
http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd 
```

现在我希望我应该能够在没有任何网络访问的情况下访问我的本地计算机上的这个文件。我使用 WebRequest 来访问这个 URI。

你们中的任何人都可以告诉我如何使用 Dictionary 或 C# 中的任何其他类来访问它。

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T07:16:11.020

这通常是您的 XML 解析器的一个特性。搜索称为“实体处理程序”的东西。找到 DOCTYPE 声明后，将调用此处理程序以加载 DTD。它将获取 URL 和一些其他信息作为参数。

[编辑] 实体处理程序将返回 XML 解析器将读取的某种“流”。因此，您需要将 DTD 保存到一个文件中，在实体处理程序中打开该文件并将结果流返回给 XML 解析器。

您的 XML 解析器的文档中应该有如何执行此操作的示例。请注意，流必须在某处关闭；通常 XML 解析器会这样做（因为只有它知道何时处理完流）。

# windows - 为什么 COM+ 会忽略单元线程模型？

> ID：861871
> 
> 赞同：1
> 
> 时间：2009-05-14T06:41:08.717
> 
> 标签：windows, com, interop, com+

我有一个放入 COM+ 应用程序的 STA COM 组件。客户端在该组件中创建该类的多个实例并并行调用它们的方法。该类已正确注册 - 对应类 id 的“ThreadingModel”是“Apartment”。

我看到在组件内部并行执行同一类的同一方法的多个调用 - 在实际组件代码中。它们在同一个进程中执行，但在不同的线程中执行。

发生了什么？COM+ 是否忽略了线程模型？STA模型不应该一次只允许执行一个调用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T08:10:45.413

STA 保证您的对象只能从单个特定线程访问——不需要针对共享变量的保护。

我记得对于 VB6，有一个特殊模式（我不记得它是如何命名的）：您可以允许 COM+ 生成多个 STA，每个 STA 使用一个专用对象。然而，这些对象的变量被视为线程本地存储——因此，尽管从多个线程访问您的 COM 类的多个实例，但不会发生变量共享。您是否可能正在使用此功能？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T12:04:11.987

为避免混淆，我不会在此答案中使用“对象”一词。相反，让我们使用“类”和“实例”。我相信我们都理解它们之间的区别。

用“Apartment”的 ThreadingModel 标记您的 COM 类意味着它的实例将被加载到 STA 中。创建这些实例的过程将确定它们是全部进入同一个 STA，还是进入单独的 STA。

正如您所发现的，COM+ 已将多个实例加载到单独的 STA 中。

使用 STA 获得的保证是多个线程永远不会同时访问单个实例。同一个类的不同实例，如果它们被加载到不同的 STA 中，当然可以由不同的线程同时访问。

所以 STA 确实是一种保护您的实例数据的方法。不是你的班级数据。COM 代码中的任何“共享”或“静态”数据都必须受到您的保护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T06:48:46.640

不，不是。STA 的字面意思是“单线程单元”，这进一步意味着只有一个线程可以在单元中运行。现在的问题是什么是公寓。单元是进程中的一个逻辑空间，其实现可能因框架而异。Microsoft 将单元实现为线程，因为 STA（在 Microsoft 的 COM 上下文中）转换为单线程线程，即可以有多个单元/线程，但在 STA 的情况下每个单元/线程都是单线程的。

您可以自己将这件事概括为 MTA。根据我上面所说，MTA 是 COM 上下文中的多线程线程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T08:16:38.783

您是否将对象传递给住在另一间公寓的对象？如果是这样，您是否需要在执行之前编组接口？您是否碰巧聚合了免费的线程编组器？

粗略地说，如果您将对象的接口传递给另一个单元（线程）中的对象，那么您必须确保对[接口进行编组](http://msdn.microsoft.com/en-us/library/ms680112.aspx)。如果您不这样做，那么您可能会发现您的对象可以从另一个公寓中的对象自由调用，因为它们没有通过正确处理调用的代理进行调用。

> 对对象的所有调用都必须在其线程上（在其单元内）进行。禁止直接从另一个线程调用对象；以这种自由线程方式使用对象可能会给应用程序带来问题。这条规则的含义是，所有指向对象的指针在公寓之间传递时都必须进行编组。为此，COM 提供了以下两个函数：
> 
> ```
> * CoMarshalInterThreadInterfaceInStream marshals an interface into a stream object that is returned to the caller.
> * CoGetInterfaceAndReleaseStream unmarshals an interface pointer from a stream object and releases it. 
> ```
> 
> 这些函数包装对 CoMarshalInterface 和 CoUnmarshalInterface 函数的调用，这需要使用 MSHCTX_INPROC 标志。

# c# - 使用 C# 唤醒局域网

> ID：861873
> 
> 赞同：11
> 
> 时间：2009-05-14T06:42:13.207
> 
> 标签：c#, wake-on-lan

使用 C# 实现 LAN 唤醒的最佳方式是什么？

LAN 环境中的机器需要该功能（而不是通过 Internet）。该方法需要足够强大以处理防火墙和其他此类问题。此外，对于不支持或禁用此功能的系统，是否有替代方案？

主要目标 - 通过 LAN 唤醒机器（从关机/休眠状态） - 这将使用 C# 进行编程。

请指导。

PS：我遇到了以下情况：

1.  [http://blog.memos.cz/index.php/team/2008/06/12/wake-on-lan-in-csharp](http://blog.memos.cz/index.php/team/2008/06/12/wake-on-lan-in-csharp)
2.  [http://community.bartdesmet.net/blogs/bart/archive/2006/04/02/3858.aspx](http://community.bartdesmet.net/blogs/bart/archive/2006/04/02/3858.aspx)
3.  [http://www.codeproject.com/KB/IP/cswol.aspx](http://www.codeproject.com/KB/IP/cswol.aspx)

但是，我对此并不陌生，因此无法确定解决方案是否足够全面。如果有人可以推荐遵循上述任何一篇文章，那会有所帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2019-09-21T18:30:52.960

很老的问题，我知道，但仍然有效。由于在接受的答案中没有看到任何 C#，我编写了自己的“Wake On Lan”代码。

我的目标是制作一个**通用且简单`Wake On Lan class`**的：

*   适用于*ipv4*、*ipv6*和*dual-stack*。
*   适用于连接到不同网络（两台计算机）的*一个或多个网卡*(NICS)。
*   可与任何标准十六进制格式的*macaddress一起使用。*
*   使用*多播*工作（使用多个 NIC 时，Windows 中的广播有问题，使用 ipv6 时不支持）。

**如何使用：**

您所需要的只是您要唤醒的计算机上有线网卡的**MAC****地址。**任何标准的十六进制表示都可以。然后像这样调用代码：

 **```
string mac = "01-02-03-04-05-06";
await WOL.WakeOnLan(mac); 
```

**这是课程：**

```
using System;
using System.IO;
using System.Linq;
using System.Net;
using System.Net.NetworkInformation;
using System.Net.Sockets;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

public static class WOL
{

    public static async Task WakeOnLan(string macAddress)
    {
        byte[] magicPacket = BuildMagicPacket(macAddress);
        foreach (NetworkInterface networkInterface in NetworkInterface.GetAllNetworkInterfaces().Where((n) =>
            n.NetworkInterfaceType != NetworkInterfaceType.Loopback && n.OperationalStatus == OperationalStatus.Up))
        {
            IPInterfaceProperties iPInterfaceProperties = networkInterface.GetIPProperties();
            foreach (MulticastIPAddressInformation multicastIPAddressInformation in iPInterfaceProperties.MulticastAddresses)
            {
                IPAddress multicastIpAddress = multicastIPAddressInformation.Address;
                if (multicastIpAddress.ToString().StartsWith("ff02::1%", StringComparison.OrdinalIgnoreCase)) // Ipv6: All hosts on LAN (with zone index)
                {
                    UnicastIPAddressInformation unicastIPAddressInformation = iPInterfaceProperties.UnicastAddresses.Where((u) =>
                        u.Address.AddressFamily == AddressFamily.InterNetworkV6 && !u.Address.IsIPv6LinkLocal).FirstOrDefault();
                    if (unicastIPAddressInformation != null)
                    {
                        await SendWakeOnLan(unicastIPAddressInformation.Address, multicastIpAddress, magicPacket);
                        break;
                    }
                }
                else if (multicastIpAddress.ToString().Equals("224.0.0.1")) // Ipv4: All hosts on LAN
                {
                    UnicastIPAddressInformation unicastIPAddressInformation = iPInterfaceProperties.UnicastAddresses.Where((u) =>
                        u.Address.AddressFamily == AddressFamily.InterNetwork && !iPInterfaceProperties.GetIPv4Properties().IsAutomaticPrivateAddressingActive).FirstOrDefault();
                    if (unicastIPAddressInformation != null)
                    {
                        await SendWakeOnLan(unicastIPAddressInformation.Address, multicastIpAddress, magicPacket);
                        break;
                    }
                }
            }
        }
    }

    static byte[] BuildMagicPacket(string macAddress) // MacAddress in any standard HEX format
    {
        macAddress = Regex.Replace(macAddress, "[: -]", "");
        byte[] macBytes = new byte[6];
        for (int i = 0; i < 6; i++)
        {
            macBytes[i] = Convert.ToByte(macAddress.Substring(i * 2, 2), 16);
        }

        using (MemoryStream ms = new MemoryStream())
        {
            using (BinaryWriter bw = new BinaryWriter(ms))
            {
                for (int i = 0; i < 6; i++)  //First 6 times 0xff
                {
                    bw.Write((byte)0xff);
                }
                for (int i = 0; i < 16; i++) // then 16 times MacAddress
                {
                    bw.Write(macBytes);
                }
            }
            return ms.ToArray(); // 102 bytes magic packet
        }
    }

    static async Task SendWakeOnLan(IPAddress localIpAddress, IPAddress multicastIpAddress, byte[] magicPacket)
    {
        using (UdpClient client = new UdpClient(new IPEndPoint(localIpAddress, 0)))
        {
            await client.SendAsync(magicPacket, magicPacket.Length, multicastIpAddress.ToString(), 9);
        }
    }
} 
```

**这个怎么运作：**

该代码通过枚举所有“启动”并连接到您的网络（通常只有一个）的网卡来工作。它将使用多播向所有连接的网络发送“魔术包”，该多播适用于 ipv4 和 ipv6（不用担心网络泛滥，它只有 102 个字节）。

要工作，您要唤醒的计算机必须具有**有线**连接（无线计算机无法唤醒，因为它们未连接到任何网络，当它们关闭时）。发送数据包的计算机可以无线连接。

防火墙通常没有问题，因为计算机已关闭，因此防火墙未激活。

**您必须确保它`'Wake on lan'`在`enabled`计算机`BIOS`和网卡上。**

**.Net 6 的更新（和错误修复）：**

修复了一个错误，如果 Ipv6 在发送数据包的计算机上运行，​​但在应该被唤醒的计算机上没有，则它不会尝试 Ipv4（这在上面的代码中已修复）。

这是适用于 .Net 6 的代码（借用了@Oskar Sjôberg 的一些代码） - `implicit usings turned on`：

```
using System.Net;
using System.Net.NetworkInformation;
using System.Net.Sockets;
using System.Text.RegularExpressions;

public static class WOL
{
    public static async Task WakeOnLan(string macAddress)
    {
        byte[] magicPacket = BuildMagicPacket(macAddress);
        foreach (NetworkInterface networkInterface in NetworkInterface.GetAllNetworkInterfaces().Where((n) =>
            n.NetworkInterfaceType != NetworkInterfaceType.Loopback && n.OperationalStatus == OperationalStatus.Up))
        {
            IPInterfaceProperties iPInterfaceProperties = networkInterface.GetIPProperties();
            foreach (MulticastIPAddressInformation multicastIPAddressInformation in iPInterfaceProperties.MulticastAddresses)
            {
                IPAddress multicastIpAddress = multicastIPAddressInformation.Address;
                if (multicastIpAddress.ToString().StartsWith("ff02::1%", StringComparison.OrdinalIgnoreCase)) // Ipv6: All hosts on LAN (with zone index)
                {
                    UnicastIPAddressInformation? unicastIPAddressInformation = iPInterfaceProperties.UnicastAddresses.Where((u) =>
                        u.Address.AddressFamily == AddressFamily.InterNetworkV6 && !u.Address.IsIPv6LinkLocal).FirstOrDefault();
                    if (unicastIPAddressInformation != null)
                    {
                        await SendWakeOnLan(unicastIPAddressInformation.Address, multicastIpAddress, magicPacket);
                    }
                }
                else if (multicastIpAddress.ToString().Equals("224.0.0.1")) // Ipv4: All hosts on LAN
                {
                    UnicastIPAddressInformation? unicastIPAddressInformation = iPInterfaceProperties.UnicastAddresses.Where((u) =>
                        u.Address.AddressFamily == AddressFamily.InterNetwork && !iPInterfaceProperties.GetIPv4Properties().IsAutomaticPrivateAddressingActive).FirstOrDefault();
                    if (unicastIPAddressInformation != null)
                    {
                        await SendWakeOnLan(unicastIPAddressInformation.Address, multicastIpAddress, magicPacket);
                    }
                }
            }
        }
    }

    static byte[] BuildMagicPacket(string macAddress) // MacAddress in any standard HEX format
    {
        macAddress = Regex.Replace(macAddress, "[: -]", "");
        byte[] macBytes = Convert.FromHexString(macAddress);

        IEnumerable<byte> header = Enumerable.Repeat((byte)0xff, 6); //First 6 times 0xff
        IEnumerable<byte> data = Enumerable.Repeat(macBytes, 16).SelectMany(m => m); // then 16 times MacAddress
        return header.Concat(data).ToArray();
    }

    static async Task SendWakeOnLan(IPAddress localIpAddress, IPAddress multicastIpAddress, byte[] magicPacket)
    {
        using UdpClient client = new(new IPEndPoint(localIpAddress, 0));
        await client.SendAsync(magicPacket, magicPacket.Length, new IPEndPoint(multicastIpAddress, 9));
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-14T07:27:06.923

对于 WOL 问题，您必须澄清三个问题才能使其发挥作用：

1.  通过以太网电缆发送 WOL
2.  配置您的 PC 以侦听此类数据包并唤醒
3.  确保数据包从发送者到接收者（防火墙、网关等）

正如您已经在网上找到的那样，对于用 C# 编程的第一个问题，现有几种解决方案（在浏览了您的链接之后，我将从第一个开始）。

第二个是您只能通过配置网络适配器才能实现的目标。只需打开设备管理器并查看网络适配器的属性，如果存在这样的选项并且您是否可以启用它。这无法编程，因为每个网络适配器都有该功能的另一个实现以及如何启用它。

第三个问题也不能用 C# 解决。这是一个纯粹的网络问题，您必须配置您的路由器、网关、ids 系统等以允许这样的数据包并让它从发送方流向接收方。由于事实上，WOL 数据包始终是广播数据包（dest-ip 255.255.255.255），它不会离开您的本地网络，并且始终会从路由器、网关或任何其他网络之间的网桥（例如 vpns、 ETC。）。

最后但并非最不重要的一点是，我会提醒您，第一个问题可以分为一些较小的数据包，但据我所知，这些问题都被您提供的链接所限制。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2021-01-01T12:48:03.853

我正在尝试 Poul Bak 的答案，但无法唤醒我的目标计算机。在验证了第三方应用程序[WakeMeOnLan](https://www.nirsoft.net/utils/wake_on_lan.html)实际上能够唤醒我的目标计算机后，我编写了对我有用的代码：

```
void SendWakeOnLan(PhysicalAddress target)
{   
    var header = Enumerable.Repeat(byte.MaxValue, 6);
    var data = Enumerable.Repeat(target.GetAddressBytes(), 16).SelectMany(mac => mac);

    var magicPacket = header.Concat(data).ToArray();

    using var client = new UdpClient();

    client.Send(magicPacket, magicPacket.Length, new IPEndPoint(IPAddress.Broadcast, 9));
} 
```

用法：

只需像这样传入目标计算机的mac地址：

```
SendWakeOnLan(PhysicalAddress.Parse("0A-0B-0C-0D-0E-0F")); 
```

我认为这个答案和 Poul Bak 的答案之间的主要区别在于，这段代码使用 IPv4 上的广播而不是 IPv4/IPv6 上的多播，也许我的网络设备没有处理/设置正确地进行多播。

# java - 使用 POI HSSF API 从 excel 单元格中读取日期值

> ID：861877
> 
> 赞同：30
> 
> 时间：2009-05-14T06:43:34.657
> 
> 标签：java, excel, apache-poi, poi-hssf

我正在使用 POI HSSF API 进行 Java 中的 excel 操作。我的一个 Excel 单元格中有一个日期值“2009 年 8 月 1 日”，当我尝试使用 HSSF API 读取该值时，它会将单元格类型检测为数字并返回我的日期的“双倍”值。请参阅下面的示例代码：

```
cell = row.getCell(); // date in the cell '8/1/2009'
switch (cell.getCellType()) {

case HSSFCell.CELL_TYPE_STRING:
    cellValue = cell.getRichStringCellValue().getString();
    break;
case HSSFCell.CELL_TYPE_NUMERIC:
    cellValue = new Double(cell.getNumericCellValue()).toString();
    break;
default:
} 
```

Cell.getCellType() 返回 NUMERIC_TYPE，因此此代码将日期转换为双倍！:(

有什么方法可以读取 HSSF POI 中的日期！？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-14T07:05:44.383

你可以看看：

```
HSSFDateUtil.isCellDateFormatted() 
```

有关 HSSFDateUtil 的更多详细信息，请参阅 POI Horrible Spreadsheet Format API：

[http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFDateUtil.html](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFDateUtil.html)

这也提供了一些帮助方法来返回 Excel`getExcelDate()`和 Java 日期`getJavaDate()`。不过，您需要对不同的日期格式有所警惕......

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-08-31T18:09:37.460

如果您想以与 Excel 文件中相同的格式引用日期，则应使用 CellDateFormatter。示例代码：

```
CellValue cValue = formulaEv.evaluate(cell);
double dv = cValue.getNumberValue();
if (HSSFDateUtil.isCellDateFormatted(cell)) {
    Date date = HSSFDateUtil.getJavaDate(dv);

    String dateFmt = cell.getCellStyle().getDataFormatString();
    /* strValue = new SimpleDateFormat(dateFmt).format(date); - won't work as 
    Java fmt differs from Excel fmt. If Excel date format is mm/dd/yyyy, Java 
    will always be 00 for date since "m" is minutes of the hour.*/

    strValue = new CellDateFormatter(dateFmt).format(date); 
    // takes care of idiosyncrasies of Excel
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-14T07:10:36.837

Excel 将日期和时间视为数字...... Jon 说得更好，所以我不会在这里附和他......

但是，您在问题中提出的示例代码位于[http://poi.apache.org/spreadsheet/quick-guide.html#CellContents](http://poi.apache.org/spreadsheet/quick-guide.html#CellContents)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-08-04T07:38:47.760

如果您使用 POI 3.5，您可以使用以下

cell.getDateCellValue() 方法。这也适用于 excel 2007。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-21T11:07:36.027

从 POI 3.15 beta3 开始，一些功能是`deprecated`. 您可以检查数据格式并检索为 Java `Date`。

```
SimpleDateFormat format = new SimpleDateFormat("");
String cellValue;
if(cell != null && cell.getCellTypeEnum() != CellType.STRING &&
    cell.getCellTypeEnum() == CellType.NUMERIC && DateUtil.isCellDateFormatted(cell)){

    cellValue = format.format(cell.getDateCellValue());
} 
```

# asp.net - 使用多个子域会加速我的网站吗？

> ID：861880
> 
> 赞同：2
> 
> 时间：2009-05-14T06:44:31.597
> 
> 标签：asp.net, performance, subdomain

我正在考虑将我的图像移动到我网站上的子域，并且我在某处读到将脚本移动到另一个会使其更快！真的吗？或者如果我不考虑真正的 CDN，我应该把它留在原样吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T06:52:11.357

是和不是。该站点本身不会更快，但在大多数浏览器中加载速度可能会更快，因此它可能看起来更快。

原因是大多数浏览器将自己限制为与域的最大并发连接数。假设您在 www.mysite.com 上有您的网站。现在，当您的浏览器尝试下载您的 html、css、脚本和图像时，它可能需要从服务器下载 20-30 个文件。由于浏览器将自身限制为 4 个与您的域的并发连接，因此浏览器一次只能下载 4 个文件。

现在，如果您在单独的子域 css.mysite.com 上提供您的 css 文件，您在 images.mysite.com 上的图像和在 scripts.mysite.com 上的脚本，您的浏览器可以打开到每个域的 4 个并发连接。因此它可以同时下载多达 16 个文件。如果您的带宽允许，这可能会导致页面加载速度更快。

因此，对于访问者来说，您的网站可能看起来更快，但原因是加载时间，而不是代码或数据库访问的任何加速。

# iphone-sdk-3.0 - iPhone 3.0 sdk 安装到设备问题

> ID：861882
> 
> 赞同：1
> 
> 时间：2009-05-14T06:45:07.617
> 
> 标签：iphone-sdk-3.0

我无法使用 iphone3.0sdk 将我的应用程序安装到设备中，xcode 给我这个消息：

> 路径中没有可启动的可执行文件

在我的组窗口中，产品文件夹包含`name1.app`文件，但以红色勾勒，并始终保留在那里。即使我已经将我的产品名称更改`name2`为消息总是说*在`name1.app`路径中找不到*，但我当前的产品名称应该`name2.app`已经是。

在模拟器上构建很好，产品应用程序文件将根据产品名称更改，但在安装到设备时无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-11T17:26:57.343

您必须进入构建器的设置，更改为“Realese”，然后键入与您的应用程序相同的名称。

回到调试模式，然后单击“构建和调试”。

它完美地工作;）

# c# - 运行-EXE-through-web-services

> ID：861883
> 
> 赞同：0
> 
> 时间：2009-05-14T06:45:22.343
> 
> 标签：c#, web-services

我正在尝试在我的 Web 服务中调用 Windows 控制台应用程序。如果我将它作为本地服务运行，即在同一个解决方案中，它可以完美运行，但如果我尝试通过托管为 IIS localServer 的 Web 服务调用它，它不会调用它。我认为这是安全问题。我是网络服务的新手，我正在使用

```
 Process.Start() function... 
```

还有一件事，如果它是 Windows 服务，它工作得很好......

任何想法？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T07:17:22.670

将您的控制台视为一个单独的项目。确保首先有效。

我已经完成了您在 asp.net 网络应用程序中描述的内容。我已经测试过了；相同的代码在 Web 服务中运行良好。这里的诀窍是`startInfo.UseShellExecute = False`

在示例中，参数被传递给在运行时执行的控制台应用程序。（对不起，它在 VB 中）。

```
Dim startInfo As System.Diagnostics.ProcessStartInfo
Dim pStart As New System.Diagnostics.Process

startInfo = New System.Diagnostics.ProcessStartInfo("C:\Inetpub\wwwroot\KPIMi\Annotation Editor\Annotation_Console.exe")
startInfo.Arguments = strServerName & "-" & strPrimaryKey & "-" & txtStart.Text
startInfo.UseShellExecute = False

pStart.StartInfo = startInfo
pStart.Start() 
```

`pStart.WaitForExit()`'您的代码将停止，直到 exe 文件执行完毕。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T06:52:44.850

IUSR_* 用户帐户是否有权执行控制台应用程序？

# function - 你能给我打印屏幕并在javascript或flash中转换为jpg的功能吗

> ID：861884
> 
> 赞同：0
> 
> 时间：2009-05-14T06:45:50.127
> 
> 标签：function, printing, screen

你能给我打印屏幕并在javascript或flash中转换为jpg的功能吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T07:07:46.983

出于安全原因，这些功能不适用于 Web 浏览器，因此也不适用于在其中运行的任何代码。

否则，破解者可以很容易地观察到用户在屏幕上输入的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T07:07:50.337

我认为这两种方法都不可能，因为这将是一个很大的安全风险。考虑到您不能从其中任何一个写入文件，您会如何处理 JPG？

# javascript - 捕获所有链接，包括表单提交

> ID：861885
> 
> 赞同：1
> 
> 时间：2009-05-14T06:45:55.930
> 
> 标签：javascript, jquery

我想知道如何使用 jQuery 捕获页面上的所有链接。这个想法类似于Facebook。在 Facebook 中，如果您单击一个链接，它会捕获该链接并使用 ajax 加载相同的链接。只有当您在新标签等中打开链接时，它才会使用常规调用加载页面。

关于如何实现这种功能的任何线索？确定捕获链接应该不是问题，但是捕获表单提交然后通过 ajax 提交整个数据然后显示结果呢？

有没有已经存在的插件？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T15:26:29.163

亚历克，

你绝对可以做到这一点。

我有一个以这种方式处理的表格。它使用上面提到的 jquery 表单插件 kgiannakakis。下面的示例 javascript 显示了它是如何工作的。

```
$("form").ajaxForm({
    beforeSubmit: function(){
        //optional: startup a throbber to indicate form is being processed 
        var _valid = true;
        var _msg = '';
        //optional: validation code goes here. Example below checks all input
        //elements with rel attribute set to required to make sure they are not empty
        $(":input [rel='required']").each(function(i){
            if (this.value == '') { 
                _valid = false;
                _msg += this.name + " may not be empty.\n";
                $(this).addClass("error");       
            }
        });
        alert(_msg);
        return _valid; 
    },
    success: function(response){
        //success here means that the HTTP response code indicated success
        //process response: example assumes JSON response
        $("body").prepend('<div id="message" class="' + response.status + '"></div>');
        $("#message").text(response.message).fadeIn("slow", function(){
                $(this).fadeOut("slow").remove();
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T07:17:20.440

[表单插件](http://www.malsup.com/jquery/form/)可以将常规表单转换为 Ajax 表单：

```
$("#myForm").ajaxForm(
   {beforeSubmit: validate, success: showResponse} ); 
```

但是，对于任意形式，很难做你想做的事。如果表单使用验证或由 Ajax 提交怎么办？同样的事情也适用于链接。如果有一些 javascript 导航脚本（window.location = Url）怎么办？如果您无法完全控制页面，则很难做您想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T18:39:58.553

通常像facebook这样的页面，每个事件和每个表单都单独编码，因为服务器端文件通常是为每个单个操作/一组操作设置的。我怀疑是否会有一种干净的方法来仅使用插件来转换页面。如果是这样，我会看到很多开销。

您可以手动完成，但这又是对 Ajax 的滥用。这不是闪存，并且使用 ajax 进行所有服务器通信会遇到很多问题。

*   缺乏历史追踪。
*   注意并发事件及其结果。
*   向用户传达页面正在更改。
*   关闭了 javascript 的用户。
*   以及更多...

# asp.net-mvc - 部署asp.net MVC

> ID：861887
> 
> 赞同：0
> 
> 时间：2009-05-14T06:46:18.173
> 
> 标签：asp.net-mvc, deployment

我有一个 MVC 应用程序，它是我的营销网站，还有两个我想放在子目录中的常规 asp.net 应用程序。我可以有一个带有子应用程序的 asp.net 应用程序（即 mvc 营销）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T06:57:08.040

是的！你可以。您应该将每个应用程序定义为虚拟目录并将其标记为 IIS 中的应用程序。这样，您可以在不同的文件夹中并排运行 ASP.NET Web 窗体和 MVC 应用程序。

# .net - 对无法启动的 .NET 应用程序进行故障排除

> ID：861894
> 
> 赞同：7
> 
> 时间：2009-05-14T06:49:42.660
> 
> 标签：.net, debugging

我经常遇到无法启动的 .NET 应用程序（在我以外的其他系统上）的问题。不幸的是，事实是我不能总是创建一个运行平稳的包。因此，我经常需要发送我的 Debug 或 Release 文件夹的 ZIP 文件。

我真正的问题是这些应用程序没有告诉他们为什么没有启动。如果我从命令行启动它们，无论是在 EventLog 中，还是即使我尝试在输出上打印我所有应用程序的 Try Catch 块的结果，我都不会得到任何例外......我错过了什么吗？

大多数时候，它缺少库或与安全相关的问题。但是很高兴能无痛地找到到底发生了什么：D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T06:58:58.423

您是否尝试过查看融合日志？[Suzanne Cook 在这里](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx)有一篇关于此的文章。

另一件要做的事情（尽量减少无声错误）：尽量减少你的`Main`方法；这样做的原因是 JIT 按方法工作，如果它不能 JIT `Main`，它就不能使用你的异常处理：

```
/* for winform, you still new [STAThread] here */
static void Main() {
  try {
     MainCore();
  } catch (Exception ex) {
     // shout about it
  }
}

[MethodImpl(MethodImplOptions.NoInlining)] // usually overkill
static void MainCore() {
  // real code
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T07:00:40.713

看看[Assembly Binding Log Viewer](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-21T17:20:43.590

我遇到了 WPF 应用程序无法启动的问题 - 事实证明该问题与用户 PC 上的字体有关 - 禁用 WindowsPresentationFontCache 服务解决了该问题。

我还在其他地方找到了一个帖子，其中包含以下信息......

> ...由于某种未知原因，客户在用于构建堆栈跟踪中引用的“默认字体系列”缓存的注册表项中有错误的条目。客户被要求导出 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts 下的条目，并将文件发送给我。奇怪的是，有几个字体文件名以破折号 (---) 开头。这些都已修复，并将注册表文件发送回客户进行导入。之后，应用程序成功启动！
> 
> [根据此链接http://support.microsoft.com/kb/937135](http://support.microsoft.com/kb/937135)中的说明，可能还需要删除字体缓存

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T12:27:40.693

我知道这并没有直接解决问题 - 但是您是否尝试过发布您的应用程序（当然假设您使用的是 Visual Studio）？这*应该*将您需要的所有内容都包含在安装程序中。

# java - 在JPanel上检测鼠标移动事件

> ID：861895
> 
> 赞同：0
> 
> 时间：2009-05-14T06:49:58.103
> 
> 标签：java, events, mouse, jpanel

我有一个 JPanel，我想检测以下事件

(1) 当鼠标移入时

(2)当鼠标移出时

(1) 快速简单。(2) 有点棘手。目前，我必须在 JPanel 周围的所有组件中注册事件。如果JPanel周围的邻居检测到鼠标移动事件，这也意味着JPanel处于（2）情况。但是，这是一个相当肮脏的过程，因为我将来会添加新组件，这种肮脏的解决方法将被打破。

另一种方法是有一个计时器来监控 JPanel。如果鼠标位置在 x 秒内不在 JPanel 内，我可以认为 JPanel 有鼠标移出事件。

然而，这对我来说似乎也是一种肮脏的方式，因为有一个单独的计时器来执行这种常见的任务是矫枉过正的。

有没有更好的方法，哪个Java平台可以提供？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T06:54:55.080

让您的类实现 MouseListener 并将其添加为最外面的面板上的鼠标侦听器。当鼠标移到面板上时，你应该得到一个 mouse-entered 事件，当它离开时，你应该得到一个 mouse-exited 事件；无论面板包含什么组件。

来自 JavaDoc：

> void mouseEntered(MouseEvent e) 当鼠标进入组件时调用。
> 
> void mouseExited(MouseEvent e) 当鼠标退出组件时调用。

# c# - C#、Linq2SQL：CommandTimeout 应该多长时间以及应该在哪里设置？

> ID：861903
> 
> 赞同：2
> 
> 时间：2009-05-14T06:53:42.587
> 
> 标签：c#, sql-server, linq-to-sql, timeout, command

我们正在使用 C# 和 Linq2SQL 从数据库中获取一些报告的数据。在某些情况下，这需要一段时间。超过 30 秒，这似乎是默认的`CommandTimeout`。

所以，我想我必须升级`CommandTimeout`. 但问题是，多少钱？把它设置得很高是不是很糟糕？如果客户试图做某事，只是因为他的数据库中的数据比普通客户多得多，他因为超时而无法输出报告，这不是很糟糕吗？但是我怎么知道它可能需要多少时间呢？有没有办法将它设置为无穷大？或者这被认为是非常糟糕的？

我应该在哪里设置它？我有一个静态数据库类，它会在我需要时为我生成一个新的数据上下文。我可以创建一个常量并在创建新数据上下文时设置它吗？还是应该根据用例将其设置为不同的值？对于根本不需要太多时间的事情有一个高超时是不是很糟糕？还是真的不重要？

太高`ConnectionTimeout`当然会更烦人。但是是否存在用户/客户希望某事超时的情况？SQL Server 可以冻结以使命令永远不会完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T07:06:41.400

`CommandTimeout`等确实应该只在每个特定场景的基础上增加。这可以避免意外的长时间阻塞等情况（或更糟糕的是：未检测到的死锁情况）。至于*多高*……查询需要多长时间？增加一些空间，你就有答案了。

当然，另一件要做的事情是减少查询所花费的时间。这可能意味着手动优化存储过程中的一些 TSQL，通常与检查索引策略相结合，可能还有更大的更改，例如非规范化或其他模式更改。这可能还涉及数据仓库策略，因此您可以将负载转移到单独的数据库（远离事务数据），并使用针对报告进行优化的模式。也许是星型模式。

我不会将它设置为无穷大......我不希望它需要永远运行报告。选择一个对报告有意义的数字。

是的，SQL Server 可以冻结，因此命令永远不会完成。一个开放的阻塞事务将是最简单的......得到两个，你可以死锁。通常系统会检测到本地死锁——但并非总是如此，尤其是在涉及 DTC 的情况下（即非本地锁）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T07:13:00.373

恕我直言，您的用户设置 ConnectionTimeout 值的高级选项将比您确定的任何常量值更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T15:19:14.003

默认情况下，主键上会有一个聚集索引。我发现以下脚本（我认为它在 msdn 上）将生成代码以创建 SQL 服务器认为有用的任何索引（def 适用于 SQL2008，我认为这是在 2005 年引入的）：

```
SELECT 

  migs.avg_total_user_cost * (migs.avg_user_impact / 100.0) * (migs.user_seeks + migs.user_scans) AS improvement_measure, 

  'CREATE INDEX [missing_index_' + CONVERT (varchar, mig.index_group_handle) + '_' + CONVERT (varchar, mid.index_handle) 

  + '_' + LEFT (PARSENAME(mid.statement, 1), 32) + ']'

  + ' ON ' + mid.statement 

  + ' (' + ISNULL (mid.equality_columns,'') 

    + CASE WHEN mid.equality_columns IS NOT NULL AND mid.inequality_columns IS NOT NULL THEN ',' ELSE '' END 

    + ISNULL (mid.inequality_columns, '')

  + ')' 

  + ISNULL (' INCLUDE (' + mid.included_columns + ')', '') AS create_index_statement, 

  migs.*, mid.database_id, mid.[object_id]

FROM sys.dm_db_missing_index_groups mig

INNER JOIN sys.dm_db_missing_index_group_stats migs ON migs.group_handle = mig.index_group_handle

INNER JOIN sys.dm_db_missing_index_details mid ON mig.index_handle = mid.index_handle

WHERE migs.avg_total_user_cost * (migs.avg_user_impact / 100.0) * (migs.user_seeks + migs.user_scans) > 10

ORDER BY migs.avg_total_user_cost * migs.avg_user_impact * (migs.user_seeks + migs.user_scans) DESC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-06T16:38:50.227

```
//If you have an AseCommand object instance....
AseCommand _AseCommand = new AseCommand("procedure_test");

//You can set up the timeout infinite as follows
_AseCommand.CommandTimeout = System.Threading.Timeout.Infinite; 
```

# asp.net - ASP.NET 3.5 会话 ID 的大小是多少？

> ID：861911
> 
> 赞同：12
> 
> 时间：2009-05-14T06:57:07.463
> 
> 标签：asp.net, security, sessionid

它是 32 位、64 位、128 位还是更大？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-01-19T03:04:26.067

它既不是 int 也不是 guid；从[MSDN 帮助文件](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.sessionidmanager.aspx)...

> ASP.NET 会话标识符是一个随机生成的数字，编码为 24 个字符的字符串，由从 a 到 z 的小写字符和从 0 到 5 的数字组成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-10-27T12:57:30.500

数据库中额外 8 个字符与您在代码中获得的字符的原因是应用程序 ID。在数据库中，会话附加有 ASPStateTempApplications 表中的 tempApplicationID。这就是为什么您在代码中获得 24 个字符，在 db 中获得 32 个字符的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-27T13:53:04.217

我会选择 88 个字节。如果您查看 ASP.NET 状态数据库，就会发现它是这样定义的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-14T07:26:47.983

因为它是作为[System.Guid](http://msdn.microsoft.com/en-us/library/system.guid(VS.90).aspx)值类型生成的，所以它是一个 128 位整数，即 16 个字节。

# java - JButton 问题

> ID：861914
> 
> 赞同：1
> 
> 时间：2009-05-14T06:57:48.007
> 
> 标签：java, button

您可以在不使按钮本身变灰的情况下禁用 JButton 吗？当您使用 setEnbaled(false) 时，按钮禁用并变为灰色。是否可以禁用按钮但使按钮的外观仍然相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T07:00:46.207

如果设置了标志，您可以忽略[ActionListener中的按钮按下；](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/event/ActionListener.html)但是，您不应该在未将其显示为已禁用的情况下禁用该按钮：它只会使您的应用程序的用户感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T09:46:11.690

我建议设置 a`ButtonModel`覆盖`setArmed`和`setPressed`. 究竟如何覆盖它取决于您想要它做什么 - 例如，它是否应该在按下时看起来被按下？只`ButtonModel`为 a 设置一次`JButton`。在 上添加或重新调整状态`ButtonModel`以指示您希望它在任何给定时刻的行为方式。

显然，具有非标准行为的 GUI 可能会使用户感到困惑。

# c# - 在 DataGridView 中仅显示选定的标题

> ID：861925
> 
> 赞同：1
> 
> 时间：2009-05-14T07:01:56.797
> 
> 标签：c#, .net, ado.net, .net-2.0

如何在 DataGridView 控件中仅显示选定的标题？例如，我有带有标题的 DataTable（“Name”、“Age”、“Status”），但我想在显示时省略“Age”列。

谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T07:22:57.150

就个人而言，我可能会手动添加我想要的列 ( `AutoGenerateColumns=false`)，而不是尝试删除我不想要的列。

如果这是一个类模型（而不是`DataTable`），你可以做一些事情，比如设置`[Browsable(false)]`你不想看到的属性。~~我想知道你是否不能用`DataTable`非默认`DataView`...~~做一些事情。除此之外，您只需添加所需的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T07:07:51.227

在 DataBindingComplete() 方法中：

```
this.dataGridView1.Columns["Age"].Visible = false; 
```

参考：[如何：隐藏 Windows 窗体 DataGridView 控件中的列](http://msdn.microsoft.com/en-us/library/0c24a0d7.aspx)

# .net - .Net 数据类型存储在哪里？

> ID：861926
> 
> 赞同：1
> 
> 时间：2009-05-14T07:02:29.383
> 
> 标签：.net, types

.Net 数据类型存储在哪里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T07:23:55.230

如果您的意思是“数据存储在内存中的哪个位置 - 在堆栈或堆上”，它会变得非常复杂，并且部分取决于语言。

我已经写[了一篇关于它的文章，它](http://pobox.com/~skeet/csharp/memory.html)比我想在这里重复的更详细。诸如经常重复的“值类型存在于堆栈上，引用类型存在于堆上”之类的简单解释存在很大缺陷，`int`引用类型中的变量的明显反例 - 该变量的值将始终存储在堆，即使`int`是值类型。

但是，阅读 Eric Lippert 的[博客文章](http://blogs.msdn.com/ericlippert/archive/2009/04/27/the-stack-is-an-implementation-detail.aspx)也是明智之举- 这是一个实现问题，开发人员往往过于担心它。C# 团队*可以*决定在以后的版本中对其进行全部更改，并创建一个包含*所有*局部变量（而不仅仅是捕获的变量）的新对象。

诚然，这是一个*重要*的实现细节——你在堆栈上放了多少会影响你的堆栈的深度等等——但我们可能应该花很多时间来关注它。

如果这*不是*您想要的问题，请澄清它。例如，您可能的意思是：

*   类型元数据在执行时存在于哪里？
*   BCL 类型存储在磁盘的什么位置？
*   类型的 JIT 编译代码存在于哪里，它存储在哪里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T10:21:26.707

所有核心 CTS 类型，如 Int16、Int32、Int64、String、Byte 等都在 MSCorLib.dll 中定义。该文件可以在 C:\Windows\Microsoft.NET\Framework\v2.0.50727 目录中找到。

所有其他特殊用途的类型和类都存储在它们各自的 FCL [框架类库] 程序集中。与 Windows 窗体开发相关的所有类型一样，都可以在 System.Windows.Form 中找到。*.dll 和所有与 web/asp.net 开发相关的类型都在 System.Web 中定义。*.dll。您可以在本地机器的 GAC 中找到这些和相关程序集。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-14T07:05:14.883

它们被“存储”在各种 dll 中。

# c - 为什么我得到 errno EINVAL (innvalid parameters) 但只有当文件为空时

> ID：861931
> 
> 赞同：1
> 
> 时间：2009-05-14T07:04:50.610
> 
> 标签：c, winapi

我`[_fsopen](http://msdn.microsoft.com/en-us/library/8f30b0db%28VS.71%29.aspx)(path, "r+", _SH_DENYRW)`用于在 C 中打开文件的任何保护参数 (_SH_...) 都会导致同样的问题。

打开一个空文件时，`errno`设置为 22 ( `EINVAL`)，当文件不为空时不是这样 - 一切正常。我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T08:09:56.040

该文档暗示如果参数之一无效，则 EINVAL 将导致结果。由于`"r+"`必须是一个有效的指针，并且假设它完全编译`_SH_DENYRW`必须是一个有效的标志，唯一剩下的问题是你的变量`path`是否不是 NULL，指向存在且可以读取的内存，并且包含有效的路径名。

我刚刚尝试了以下方法：

```
#include <stdio.h>
#include <share.h>

int main(int argc, char **argv)
{
    FILE *f;

    if (argc != 2) {
        fprintf(stderr, "Usage: %s file\n", argv[0]);
        exit(1);
    }
    f = _fsopen(argv[1], "r+", _SH_DENYRW);
    if (f) {
        printf("Open ok.\n");
        fclose(f);
    } else {
        perror(argv[1]);
    }
    return 0;
} 
```

在存在并且可以写入的文件上，无论它们的大小如何，它都会打印“Open ok.”，这意味着`_fsopen()`成功。其他几个案例：

一个只读文件：

```
C:>fsopen ro.txt
ro.txt：权限被拒绝

```

无文件：

```
C:>fsopen nosuchfile
nosuchfile：没有这样的文件或目录

```

设备文件：

```
C:>fsopen NUL:
打开就好。

```

零长度文件：

```
C:>fsopen zero.txt
打开就好。

```

# asp.net - 连接池和单点登录

> ID：861939
> 
> 赞同：2
> 
> 时间：2009-05-14T07:07:38.810
> 
> 标签：asp.net, connection-string, connection-pooling, single-sign-on

带有 SQL Server 2005 的 ASP.NET 3.5 应用程序必须在 Intranet 环境上提供单点登录。这是通过使用 web.config 中的 Windows 身份验证模式来完成的。

我想尽可能地使用连接池。我还想在连接字符串中使用 SSPI 作为数据库访问，而不是使用模拟（在 web.config 中）

因此：有没有办法为 ASP.NET 应用程序使用连接池和单点登录机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T07:38:58.657

使用 Windows 身份验证并不一定意味着处理请求的线程在该用户身份下运行。默认情况下，ASP.NET 在其线程中使用工作进程标识，因此除非您有特定原因启用模拟，因为您的安全模型需要它（例如，您已将用户组作为 SQL 用户添加到 SQL 并控制对 SP/视图的访问通过这些用户），那么这里没有问题。

假设您在 ASP.NET 处理中模拟 Windows 用户：-

你在一个内网环境中，你有多少用户？

连接池已经存在很长时间了，以帮助提高应用程序的可扩展性，但是尽管机器在过去十年中有了很大的改进，但组织中的用户数量并没有以同样的速度增长。

IOW，您确定每个用户打开一个或两个连接实际上是一个问题吗？

连接池仍然有效，每个连接规范都有自己的池，导致大量的一两个连接池。因此，连接设置时间不会成为问题。一个 500 个用户的系统可能会导致 1000 个连接处于活动状态，但按照现代标准，这并不会像最初设想池化时那样造成太大的负担。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T07:27:45.580

您可以为您的应用程序使用单点登录，然后让应用程序为每个数据库连接模拟一个用户，理想情况下是一个没有登录权限的服务帐户。

# php - 将页面重定向到根路径

> ID：861945
> 
> 赞同：1
> 
> 时间：2009-05-14T07:08:16.873
> 
> 标签：php

我在这里有这个类，我想要做的是，如果检查的东西等于 false，那么用户将被重定向到根域路径。但它不工作。这是课程

```
class security {
    function checkAuth() {
        if(isset($_COOKIE['AUTHID'])) {
            $cookie = $this->secure($_COOKIE['AUTHID']);
            $query = mysql_query("select username,password,active from tbl_users where password = '$cookie'") or die(mysql_error());
            while($row = mysql_fetch_assoc($query)) {
                //check if cookie is set
                if(!isset($_COOKIE['AUTHID'])) {
                    header("Location: ".realpath($_SERVER['HTTP_HOST']));
                }

                //check if user is active
                if($cookie == $row['password']) { 
                    if($row['active'] == '0') {
                        setcookie("AUTHID","",time() - 100000);
                        header("Location: ".realpath($_SERVER['HTTP_HOST']));
                    }
                    else { //user is active
                    }
                }
                //check if hash in cookie matches hash in db
                if($cookie != $row['password']) { 
                    setcookie("AUTHID","",time() - 100000);
                    header("Location: ".realpath($_SERVER['HTTP_HOST']));
                }
            }
        }
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T08:52:11.367

1.  我认为重定向/直接在类中输出不是一个好主意，原因有很多，最重要的是它违背了面向对象的全部观点。而是返回 false 并让调用脚本执行重定向。
2.  您需要将标头作为您要做的第一件事发送，如果 PHP 已经开始输出文本，则基于标头的重定向将不起作用，因为标头已经发送。

尝试

```
$_SERVER['SCRIPT_URI']; 
```

或者

```
"http://" . $_SERVER['HTTP_HOST']; 
```

而且，是的，exit(); 发送该标头后。

不要忘记发送适当的 30x[标头响应代码](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)，用于重定向

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T07:22:40.740

为什么不简单：

```
header('Location: /'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T08:31:53.553

来自[PHP 文档](http://docs.php.net/manual/en/reserved.variables.server.php)：

> 'HTTP_HOST'：主机的内容：当前请求的标头，如果有的话。

在我看来，这是从客户端浏览器发送的值，并且由于客户端可以更改请求标头，我认为最好使用 SERVER_NAME：

> 'SERVER_NAME' 当前脚本在其下执行的服务器主机的名称。如果脚本在虚拟主机上运行，​​这将是为该虚拟主机定义的值。

**因此，我认为正确的做法是：**

```
header("Location: http://{$_SERVER['SERVER_NAME']}/");
die(); 
```

**对“位置：/”的评论**

如[Header Field Definitions](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)中所述，通过 Location 标头重定向应使用绝对 URI，包括[http://www.servername.com/redirect/to/this/resource.html](http://www.servername.com/redirect/to/this/resource.html)，而不仅仅是 /redirect/to/this/resource.html . （但它也可以重定向到 /，但它不是 100% 正确的）。

**编辑**：自 2014 年 6 月起，绝对和相对 URL 都可以使用。请参阅[RFC 7231](https://www.rfc-editor.org/rfc/rfc7231#section-7.1.2)，它取代了旧的[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)，其中只允许使用绝对 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T07:19:20.013

该[`realpath`函数](http://docs.php.net/realpath)在文件系统上工作并返回规范化的绝对​​文件系统路径。

但是你需要的是一个 URI。所以试试这个：

```
header("Location: http://".$_SERVER['HTTP_HOST']."/");
exit; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-13T03:32:00.733

我在我所有的开发程序中使用它，在每个包含非公共脚本的目录中......

```
<?php $url = 'http://' . $_SERVER['HTTP_HOST']; header('Location: ' . $url, true, 301);?> 
```

# .net - 如何使用框架库进行编译？

> ID：861949
> 
> 赞同：0
> 
> 时间：2009-05-14T07:09:33.827
> 
> 标签：.net, c++-cli, .net-2.0

我已经为 SMO 应用程序编写了一个托管代码。我如何使用它来编译它

.NETFRAMEWORK2.0。由于某些限制，我不想使用 visulastudio。

我怎样才能做到这一点。在这方面，任何机构都可以帮助我吗？

msbuild.exe TestMsBuild.sln /:t Rebuild /:p configuration=release 给出错误为

TestMsBuild.sln : 解决方案文件错误 MSB4054: 解决方案文件必须在 Visual Studio IDE 中打开并转换为最新版本才能由 MSBuild 构建。

即使我的项目已打开，我也收到此错误但它表明我不知道如何转换为最新版本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T18:56:04.067

这看起来就像您正在使用 VS2008 来编译 VS2005 解决方案（或 2005 来编译 2003 解决方案）。在 VS2008 中打开解决方案，通过升级向导，保存更改，关闭 VS2008 并再次尝试命令行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T07:15:59.600

也许是因为您拼错了“配置”？如果不是这样，那么它可能是您的代码。没有更多信息，很难说。

# qt - 对于 QMainWindow，我如何才能拥有更多的 UI？

> ID：861951
> 
> 赞同：3
> 
> 时间：2009-05-14T07:10:20.287
> 
> 标签：qt, user-interface

我想要一个 QMainWindow 可以在运行时改变它的外观，即当用户单击按钮时。除了保留对 QtDesigner 生成的不同 UI 类的引用之外，还有其他方法吗？也许通过将每个 UI 存储在布局中？你怎么看 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T16:37:46.693

您要更改多少主窗口？您可以使用`QStackWidget`任何想要更改内容的地方，并在按下按钮时更改小部件的显示页面。这将很快改变，但对于大型或复杂的 UI，它在启动时可能会稍微慢一些，因为它将同时为两个 UI 创建小部件。（也有相当简单的方法可以改变这一点，但它们确实增加了对大多数人来说可能很简单的事情的复杂性。）另外，如果两个布局应该有相同的数据，只是在不同的地方，你会有额外的开销在程序运行时保持两组 UI 都是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T07:14:34.270

您可以在运行时动态加载 UI 布局。查看[Qt 文档](http://doc.qt.io/qt-5/quiloader.html)以获取 QUiLoader 类。

这也使您无需修改​​任何代码即可升级 UI 布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T09:26:37.477

我想我现在明白了。

你有一个 QMainWindow，当某个事件被触发时，你想改变那个特定窗口的外观，比如删除一些按钮，添加一个树视图小部件等等。

那么直接的方法是手动完成，删除一些小部件并使用常规 C++ 代码添加新的小部件。如果您习惯于 Qt Designer，这可能会有点困难。

我能想到的另一种方法是使用 Qt Designer 生成其他外观的代码并将其复制到特殊函数中。Qt Designer 生成的代码通常位于名为“ui_classname.h”的头文件中，并不难理解。但是，您将需要删除其中的一些，因为并非所有都是必要的。

此外，您可以直接调用它，而不是从 Qt Designer 复制生成的代码。通常，您的小部件有一个指向生成的类的指针，并且在您的小部件的构造函数中，您会看到如下内容：

```
MyWindow::MyWindow(QWidget *parent) : QMainWindow(parent), m_ui(new Ui::MyWindow)
{
    m_ui->setupUi(this);
} 
```

并在相应的头文件中：

```
class MyWindow : public QMainWindow {
...
private:
    Ui::MyWindow *m_ui;
}; 
```

您可以为其他外观添加额外生成的类，并在您的事件触发时使用它们。

它可能看起来像这样：

```
class MyWindow : public QMainWindow {
...
private:
    void changeAppearance(int id);

    Ui::MyWindow *m_ui;
    Ui::MyWindowFirstAppearance *m_uiFirst;
    Ui::MyWindowSecondAppearance *m_uiSecond;
...
};

void MyWindow::changeAppearance(int id)
{
     // some code to remove the current appearance, basically the opposite of what setupUi is doing
     if (id == 0)
           m_ui->setupUi(this);
     else...
           m_uiFirst->setupUi(this);
     ...
} 
```

这样做的好处是直接使用生成的类，因此您在 Qt Designer 中所做的每次更改都不需要更改主窗口。问题是我不确定在小部件的构造函数以外的地方多次调用 setupUi 是否合法，所以你必须检查一下（通过查看 setupUi 函数中发生的情况）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T07:31:43.277

如果我做对了，我想你可能想在[样式表](http://doc.qt.io/qt-5/stylesheet.html)上大赚一笔。它允许您为小部件拥有“皮肤”，就像 CSS 一样。

如果我没有做对，而您尝试做的是即时生成 .ui 文件并使用 QUiLoader 创建小部件，那么您可能会走错路，因为我想不出有充分的理由定期应用程序需要它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-29T05:53:27.223

我所做的是在两个不同的 QFrame 下设计两个 UI，将两个 QFrame 放在 QMainWindow 中的布局中，然后 hide() 和 show() 你想要的正确 QFrame...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-30T11:25:15.363

您可以使用 a`QTabWidget`并隐藏其按钮。然后，您可以在`tabWidget`. 与隐藏框架相比，它的优势在于不会弄乱 Qt Creator 窗口。

# javascript - GWT 编译的 JavaScript 是被混淆了还是只被缩小了？

> ID：861953
> 
> 赞同：2
> 
> 时间：2009-05-14T07:10:26.917
> 
> 标签：javascript, gwt

那么，正如标题所说，当 GWT 将 Java 编译成 JavaScript 时，结果是被缩小了，还是也被混淆了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T07:37:40.110

根据[GWT FAQ](http://code.google.com/support/bin/answer.py?answer=55203&topic=10212)，代码被混淆了，但他们声明“这样做部分是为了保护您开发的应用程序的知识产权，但也因为混淆减少了生成的 JavaScript 文件的大小”。我不确定这是真正的混淆还是只是变量/方法的重命名和空格的剥离。“真正的”混淆实际上可能使代码比原始代码大。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T14:59:43.807

我还想说，GWT 编译器缩小了 Js 是因为它的优化。例如，它将在可能的情况下内联方法调用并将变量重命名为更短的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-19T16:54:12.527

目标是获得尽可能小（和快速）的代码。“混淆”只是一个结果。

# algorithm - 了解 Schönhage-Strassen 算法（大整数乘法）

> ID：861958
> 
> 赞同：10
> 
> 时间：2009-05-14T07:11:31.750
> 
> 标签：algorithm, multiplication

我需要在 Python 中尽可能高效地乘以几个 1000 位数的长整数。这些数字是从文件中读取的。

我正在尝试实现整数乘法的[Schönhage-Strassen](http://en.wikipedia.org/wiki/Sch%C3%B6nhage-Strassen_algorithm)算法，但我坚持理解它背后的定义和数学，特别是快速傅立叶变换。

任何理解这个算法的帮助，比如一个实际的例子或一些伪代码，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T07:35:58.477

Knuth 的[TAOCP](http://www-cs-staff.stanford.edu/~knuth/taocp.html)的第 4.3.3 章对其进行了描述，并且在其他章节中也有一些 FFT 伪代码可用于此目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T07:34:22.910

1000 位数字对于 Schönhage-Strassen 来说是“小”，真正值得使用。你可以看看[Tom Cook](http://en.wikipedia.org/wiki/Toom%E2%80%93Cook_multiplication)乘法。 [gmpy](http://www.aleax.it/gmpy.html)是提供这些功能的 gmp 的 Python 包装器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-03T03:35:25.247

不要重新发明轮子。GMP 对该算法有出色的高性能实现，任何用纯 Python 编写的算法都会慢至少 100 倍，这仅仅是因为 Python 是一种解释性语言。使用[gmpy](http://gmpy.sourceforge.net/)从 Python 应用程序调用 GMP。我也很好奇你正在开发的应用程序需要乘以这么大的数字 - 可能有一种更简单的方法来处理你的问题。

此外，正如其他答案所提到的，“几个 1000 位数字长”还不足以证明 Schönhage-Strassen 的合理性（您必须至少有 10000 个十进制数字，可能更多）。一些Toom-Cook 的变体，如Toom-3，通常用于此范围。再说一遍，不要自己用 Python 编写——GMP 的实现经过了非常仔细的优化。

# php - 如何将查找限制为 CakePHP 中的特定数字？

> ID：861960
> 
> 赞同：7
> 
> 时间：2009-05-14T07:12:03.230
> 
> 标签：php, cakephp

我有一个用户模型，它给我最新的用户作为输出。如何将记录限制为仅输出 200 条记录而不是数据库中的所有用户？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T07:15:47.603

[根据文档](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html)，该`find()`方法的第二个参数是一个`$params`数组。

在此数组中传递的可能值之一是`limit`键。因此，您可以执行以下操作：

```
$users = $this->User->find('all', array('limit' => 200)); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-05-14T00:08:48.350

*“我有它像 array('limit' => 21, 'page' => 1) 在一页中分页 21 个用户。如果我将限制更改为 200，那么它只在一页中分页 200 个用户......在这种情况下，如何限制适当的分页？？ - 匿名 2009 年 5 月 14 日 7:22"*

是的，您可以像有人提到的那样使用 cakePHP 分页助手。但在某些情况下，您可能希望自己进行分页或仅限制每次调用检索的记录数。值得一提的是我如何处理这种情况。

例如，您想在每页检索一定数量的记录，然后： $start = 0; -> 这是为了从第一个开始检索记录。如果需要说比如从31号开始，那么$start = 30;

所以，$start = 0; $长度 = 20; // 我们将从第一条记录开始检索 20 条记录

代码将类似于：

```
// To retrieve a number of Products per page
            $products = $this->Product->find('all', array(
                                            'order' => 'product_number ASC',
                                            'limit' => $start.','.$length,
                                            'recursive' => -1
                                            )
                                        ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T16:48:29.380

不要使用 find() 进行分页。

蛋糕分页：[http ://book.cakephp.org/2.0/en/core-libraries/components/pagination.html](http://book.cakephp.org/2.0/en/core-libraries/components/pagination.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-06T09:24:47.093

```
array(
  'conditions' => array('Model.field' => $thisValue), //array of conditions
  'recursive' => 1, //int
  //array of field names
  'fields' => array('Model.field1', 'DISTINCT Model.field2'),
  //string or array defining order
  'order' => array('Model.created', 'Model.field3 DESC'),
  'group' => array('Model.field'), //fields to GROUP BY
  'limit' => n, //int
  'page' => n, //int
) 
```

Limit * page = 200 根据您在页面中的舒适视图设置您的值。这可能会有所帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-16T06:55:20.103

你也可以试试这个

```
$results = $this->Model->find('all', 
       array('limit'=>10, 
             'order'=>array('date DESC'))); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-15T12:21:57.563

打开用户的模型文件并执行以下操作：

您将需要更改名为的关系变量中的“限制”属性

> var $hasMany = array( 'Abus' => array('className' => 'Abus', 'foreignKey' => 'user_id', 'dependent' => false, 'conditions' => '', 'fields' = > '', 'order' => '', **'limit' => '200',** 'offset' => '', 'exclusive' => '', 'finderQuery' => '', 'counterQuery' => '' ) );

或者你也可以试试这个...

在您的用户控制器中，将 $paginate 设置为这样。

> `var $paginate = array('limit' => 200);`

现在，无论您使用分页，记录都将限制为 200 条。

# php - 需要一种方法来呈现对象的先决条件

> ID：861978
> 
> 赞同：0
> 
> 时间：2009-05-14T07:18:02.747
> 
> 标签：php, jquery, mysql, user-interface

我真的不知道如何以一种可以理解的方式来解释这一点，但是就这样吧。

我正在做的项目是一个围绕课程的网络应用程序，每门课程都有一组先决条件，问题是我不知道向用户展示这些的好方法。

示例：要参加课程 4，此人必须销售至少 600 种产品并工作至少 90 天。她还必须完成（课程 1 或课程 2）和课程 3。

关于我应该如何以一种简单的方式向用户展示这个让他们理解的任何想法。然后我将如何去保存它。

项目在后面用php构建，前面用html/jquery构建，存储用mysql。

/S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:47:51.000

听起来您只需要 UI 帮助，对吧？

我的大学总是做类似清单的事情：

*   其中之一：课程 A、课程 B、课程 C
*   课程 D
*   课程E

然后，您可以将一些不错的类添加到缺少/已完成要求的列表项中：

```
<ul class="prerequisites">
  <li class="complete">One of:
    <a href="courseA">Course A</a>,
    <a href="courseB" class="complete">Course B</a>,
    <a href="courseC">Course C</a></li>
  <li class="complete"><a href="courseD" class="complete">Course D</a></li>
  <li><a href="courseE">Course E</a></li>
</ul> 
```

随着一些 CSS 做一些事情，比如......

```
ul.prerequisites {
  list-style-type: none;
}

ul.prerequisites li {
  background-image: url(images/incomplete.gif); /* a red X maybe? */
  padding-left: 14px;
}

ul.prerequisites li.complete {
  background-image: url(images/complete.gif); /* maybe a green check */
}

ul.prerequisites li a.complete {
  text-decoration: line-through;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T12:32:49.403

程序化方法

*   用某种结构表示代码中的先决条件
*   为这个结构做一个解析器，什么可以把它变成语法正确的句子
*   你必须在需要 i18n 时立即扩展解析器

简单的方法

*   存储用清晰的英文句子编写的先决条件并将其显示给访问者

如果我是你，我会说服自己拿走我的骄傲，选择第二个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T12:39:15.847

我假设您的问题是 UI 布局而不是下面的技术。

我想这取决于逻辑的复杂程度，但我会尝试显示一个“和”项目列表，其中每个项目都是一组一个或多个“或”选项（如单选按钮组列表）。该列表将是表中的行，缩进了“或”选项。

如果您需要显示“A 和（B 或 C）和（D 或 E 或 F）”，它会起作用。如果您需要“（A 和 B）或（C 和 D）”，则“或”选项必须能够包含“和”字符串。我怀疑它会变得比这更复杂，但如果是这样，你可以递归地处理它并继续缩进子条款。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T21:39:18.840

Another option would be to let the user select/enter the things they have done, eg. Type in how many products they have sold and how many days they have worked and select check boxes for the courses they have completed. Once you have that you can display which courses are available to them and possibly show what they need to do to qualify for the other ones

# c# - ListBox 中的 DataTextField 是 2 个字段的组合

> ID：861982
> 
> 赞同：2
> 
> 时间：2009-05-14T07:21:12.723
> 
> 标签：c#, asp.net, listbox, datasource, datatextfield

我有一个包含用户的列表框。数据源是用户类型的通用列表（包含，id，firstname，lastname，...）。现在我想将 id 用作数据值（通过 dataValueField），并且我想要 LastName + ' ' + Firstname 作为 DataTextField。

谁能告诉我这怎么可能？

我正在使用 C# (ASP.NET)。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T07:29:33.750

最简单的方法是向包含全名的 User 类添加一个新属性：

```
public string FullName
{
    get { return LastName + " " + FirstName; }
} 
```

并将列表框绑定到那个。

这具有集中构建全名背后的逻辑的优势，因此您可以在网站的多个位置使用它，如果您需要更改它（例如，更改为 Firstname + " " + Lastname），您只需要做在一个地方。

如果更改类不是一个选项，您可以创建一个包装类：

```
public class UserPresenter
{
    private User _user;

    public int Id
    {
        get { return _user.Id; }
    }

    public string FullName
    {
        get { return _user.LastName + " " + _user.Firstname; }
    }
} 
```

或者挂钩 itemdatabound 事件（可能在那里的名称错误）并直接更改列表框项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T07:30:50.127

```
list.DataTextField = string.Format("{0}, {1}", LastName, Firstname); 
```

如果您在其他地方使用它，您还可以将 DisplayName 属性添加到返回相同内容的 User 类。

# oracle - PL/SQL 中受 UPDATE 影响的行数

> ID：861983
> 
> 赞同：176
> 
> 时间：2009-05-14T07:21:22.210
> 
> 标签：oracle, plsql, sql-update

我有一个 PL/SQL 函数（在 Oracle 10g 上运行），我在其中更新了一些行。有没有办法找出 UPDATE 影响了多少行？手动执行查询时，它告诉我有多少行受到影响，我想在 PL/SQL 中获取该数字。

* * *

## 回答 #1

> 赞同：275
> 
> 时间：2009-05-14T07:33:00.433

您使用`sql%rowcount`变量。

您需要在需要查找受影响的行数的语句之后直接调用它。

例如：

```
set serveroutput ON; 
DECLARE 
    i NUMBER; 
BEGIN 
    UPDATE employees 
    SET    status = 'fired' 
    WHERE  name LIKE '%Bloggs'; 
    i := SQL%rowcount; 
    --note that assignment has to precede COMMIT
    COMMIT; 
    dbms_output.Put_line(i); 
END; 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-09-03T07:55:20.800

对于那些想要从普通命令获得结果的人，解决方案可能是：

```
begin
  DBMS_OUTPUT.PUT_LINE(TO_Char(SQL%ROWCOUNT)||' rows affected.');
end; 
```

基本问题是 SQL%ROWCOUNT 是一个 PL/SQL 变量（或函数），不能从 SQL 命令直接访问。通过使用 noname PL/SQL 块，可以实现这一点。

...如果有人有在 SELECT 命令中使用它的解决方案，我会很感兴趣。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-06T14:03:38.410

或者，`SQL%ROWCOUNT` 您可以在过程中使用它而无需声明变量

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-15T15:18:28.117

`SQL%ROWCOUNT`也可以在不分配的情况下使用（至少从*Oracle 11g*开始）。

只要在当前块内没有执行任何操作（更新、删除或插入），`SQL%ROWCOUNT`就设置为 null。然后它保持受最后一次 DML 操作影响的行数：

*假设我们有表 CLIENT*

```
create table client (
  val_cli integer
 ,status varchar2(10)
)
/ 
```

*我们会这样测试它：*

```
begin
  dbms_output.put_line('Value when entering the block:'||sql%rowcount);

  insert into client 
            select 1, 'void' from dual
  union all select 4, 'void' from dual
  union all select 1, 'void' from dual
  union all select 6, 'void' from dual
  union all select 10, 'void' from dual;  
  dbms_output.put_line('Number of lines affected by previous DML operation:'||sql%rowcount);

  for val in 1..10
    loop
      update client set status = 'updated' where val_cli = val;
      if sql%rowcount = 0 then
        dbms_output.put_line('no client with '||val||' val_cli.');
      elsif sql%rowcount = 1 then
        dbms_output.put_line(sql%rowcount||' client updated for '||val);
      else -- >1
        dbms_output.put_line(sql%rowcount||' clients updated for '||val);
      end if;
  end loop;  
end; 
```

*导致：*

```
Value when entering the block:
Number of lines affected by previous DML operation:5
2 clients updated for 1
no client with 2 val_cli.
no client with 3 val_cli.
1 client updated for 4
no client with 5 val_cli.
1 client updated for 6
no client with 7 val_cli.
no client with 8 val_cli.
no client with 9 val_cli.
1 client updated for 10 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-01-23T13:56:32.433

> 请试试这个..

* * *

```
create table client (
  val_cli integer
 ,status varchar2(10)
);

---------------------
begin
insert into client
select 1, 'void' from dual
union all
select 4, 'void' from dual
union all
select 1, 'void' from dual
union all
select 6, 'void' from dual
union all
select 10, 'void' from dual;
end;

---------------------
select * from client;

---------------------
declare
  counter integer := 0;
begin
  for val in 1..10
    loop
      update client set status = 'updated' where val_cli = val;
      if sql%rowcount = 0 then
        dbms_output.put_line('no client with '||val||' val_cli.');
      else
        dbms_output.put_line(sql%rowcount||' client updated for '||val);
        counter := counter + sql%rowcount;
      end if;
  end loop;
   dbms_output.put_line('Number of total lines affected update operation: '||counter);
end;

---------------------
select * from client;

-------------------------------------------------------- 
```

> 结果将如下所示：

* * *

2 客户端更新为 1
没有客户端 2 val_cli。
没有带有 3 val_cli 的客户端。
1 个客户端更新为 4 个
没有客户端，具有 5 个 val_cli。
1 个客户端更新为 6 个
没有客户端，7 个 val_cli。
没有 8 val_cli 的客户端。
没有 9 val_cli 的客户端。
1 个客户端更新了 10
影响更新操作的总行数：5

* * *

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2015-05-03T00:50:55.873

使用 Count(*) 分析函数 OVER PARTITION BY NULL 这将计算总行数

# c# - 通过网络查询 Windows 服务

> ID：861984
> 
> 赞同：2
> 
> 时间：2009-05-14T07:21:30.493
> 
> 标签：c#, windows-services, remote-administration

我用 C# 编写了一个 Windows 服务，它收集性能、磁盘和内存信息并将其写入 EventLog。它作为网络服务启用。我想做的是能够从远程位置收集这些信息。该服务将在各种客户端机器上运行，我想定期（每天一次）检索此信息并将它们存储在数据库表中。我对如何通过网络查询 Windows 服务感到困惑。换句话说，究竟是什么使服务成为“网络服务”？

我不希望该服务直接连接到我的数据库并写入此信息。但我想从远程机器启动它，检索信息，然后将该信息写入我的数据库表。

我找不到任何说明联网 Windows 服务的教程。他们中的大多数都涉及写入事件日志，而我几乎被困在那里。

这是可行的，有什么关于如何完成这类事情的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T09:01:18.770

如果转移到 WCF Web 服务的其他建议不是一个选项，您可以在 Windows 服务中使用自定义命令进行分配，而不必求助于远程处理。

实际上，您可以发送一个介于 128 和 256 之间的整数，然后让您的服务在收到该命令时执行您需要的任何代码，例如将所有信息发送到您的数据库或 Web 服务。

当服务在客户端机器上愉快地运行时，您将能够在需要时从您身边启动它。

请查看此代码项目文章以获取示例：[在 C# 中创建基本 Windows 服务](http://www.codeproject.com/KB/system/WindowsService.aspx)

看一下**OnCustomCammand**方法。

这是 Microsoft 的另一篇示例文章：[与 Windows 服务通信](http://msdn.microsoft.com/en-us/library/aa288037(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T07:27:14.473

使用[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)启用某种形式的[RESTful](http://en.wikipedia.org/wiki/REST) [Web 服务](http://en.wikipedia.org/wiki/Web_Service)。

请参阅MSDN 上[的 wcf-getting-started](http://msdn.microsoft.com/en-us/netframework/wcf-getting-started.aspx)，特别[是 A Guide to Designing and Building RESTful Web Services with WCF](http://msdn.microsoft.com/en-us/netframework/dd203052.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T08:24:36.393

AFAIK“网络服务”只是意味着它在“网络服务”帐户下运行，该帐户具有与“本地服务”或“系统”帐户不同的权限集。

但是，要将服务公开给网络上的另一台机器（除了通过服务管理单元 - *services.msc*获得的标准 STOP、START、RESTART 功能），您需要使用 Remoting、Webservices 或最理想的是 gimel 提到的[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)。

# ios - 如何为 UIScrollView 启用方向锁定？

> ID：861986
> 
> 赞同：11
> 
> 时间：2009-05-14T07:22:22.237
> 
> 标签：ios, swift, uiscrollview

我有`UIScrollView`一个`UIView`里面。我想锁定 x 轴，以便视图仅垂直滚动。如何启用定向锁定？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-14T07:42:46.493

首先，将`UIScrollView`'s`contentSize`的宽度设置为等于或小于 UIScrollView 框架的宽度。

接下来，设置`UIScrollView's` `alwaysBounceHorizontal`为 NO。即使您告诉它没有更多的水平内容要显示，这也将防止滚动视图出现“橡皮筋”。

```
UIScrollView *scrollView;
CGSize size = scrollView.contentSize;
size.width = CGRectGetWidth(scrollView.frame);
scrollView.contentSize = size;
scrollView.alwaysBounceHorizontal = NO; 
```

滚动视图中的实际内容并不重要。

**斯威夫特 5.0**

```
let scrollView = UIScrollView() // Or however you want to initialize it
var size = scrollView.contentSize
size.width = scrollView.frame.width
scrollView.contentSize = size
scrollView.alwaysBounceHorizontal = false 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T07:41:55.200

您将继承`UIScrollView`和覆盖`touchesBegan:withEvent:`方法、`touchesMoved:withEvent:`方法和`touchesEnded:withEvent:`方法。

您将使用这些方法以及触摸的起点和终点来计算发生了什么样的触摸事件：是简单的点击，还是水平或垂直滑动？

如果是水平滑动，则取消触摸事件。

看看[这里的源代码](https://stackoverflow.com/questions/728014/prevent-diagonal-scrolling-in-uiscrollview/844627#844627)，了解如何开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-08T10:15:26.857

```
#import <UIKit/UIKit.h>

@interface DemoButtonViewController : UIViewController <UIScrollViewDelegate>

@property (nonatomic, strong) UIScrollView *filterTypeScrollView;
@property (nonatomic, strong) UIBarButtonItem *lockButton;

- (void)lockFilterScroll:(id)sender;

@end

#import "DemoButtonViewController.h"

@implementation DemoButtonViewController

@synthesize filterTypeScrollView;
@synthesize lockButton;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];

    if (self) 
    {
        // Custom initialization
    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.view.backgroundColor = [UIColor darkGrayColor];
    self.filterTypeScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 130, self.view.frame.size.width, 320)];
    filterTypeScrollView.contentSize = CGSizeMake(self.view.frame.size.width*4, 320);
    filterTypeScrollView.pagingEnabled = YES;
    filterTypeScrollView.delegate = self;
    [self.view addSubview:filterTypeScrollView];

    UIToolbar *lockbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 450, self.view.frame.size.width, 30)];
    lockbar.barStyle = UIBarStyleBlackTranslucent;
    self.lockButton = [[UIBarButtonItem alloc] initWithTitle:@"Lock Filter Scroll" style:UIBarButtonItemStylePlain target:self action:@selector(lockFilterScroll:)];
    [lockbar setItems:[NSArray arrayWithObjects:[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],lockButton,nil]]; 
    [self.view addSubview:lockbar];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations  
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (void)lockFilterScroll:(id)sender
{
    filterTypeScrollView.scrollEnabled = !filterTypeScrollView.scrollEnabled;

    if (filterTypeScrollView.scrollEnabled) 
    {
        [lockButton setTitle:@"Lock Filter Scroll"];
    } 
    else {
        [lockButton setTitle:@"Unlock Filter Scroll"];
    }
}

@end 
```

# javascript - 从javascript中的url获取内容到工具提示

> ID：861990
> 
> 赞同：0
> 
> 时间：2009-05-14T07:23:07.087
> 
> 标签：javascript, jquery, tooltip, cluetip

我在我的网站中使用[线索](http://plugins.learningjquery.com/cluetip/)提示作为工具提示，我想根据链接 url 设置工具提示文本。

例如：我的页面上有一个指向“http:abc.com/display?content=sweeties”的链接，我希望工具提示显示为“sweeties”

有人告诉我怎么做，好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T08:02:16.930

您应该将链接的标题设置为“sweeties”，然后指示任何工具提示插件实际使用内容的标题属性。

我认为它可以与开箱即用的线索提示一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T08:17:53.743

```
var a = $("aTagsId");
var content = a.attr('href').match(/content\=([^\&]*)/)[1];
a.attr('title', content);
... setup cluetip w/ title... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-20T22:16:08.337

一种未记录的、很好的、直接的方法是使用一个函数作为线索提示调用中的第一个参数，它返回你想要的内容：

```
var normalcluetipsettings = {.. ... ... ... }
$('#mydiv').cluetip(function(){return 'hello'+' '+'world';}, normalcluetipsettings) 
```

# git - git-merge 是否可以忽略行尾差异？

> ID：861995
> 
> 赞同：167
> 
> 时间：2009-05-14T07:25:04.993
> 
> 标签：git, merge, git-svn, line-endings, eol

是否可以`git merge`忽略行尾差异？

也许我问错了问题......但是：

我尝试了 uisng `config.crlf input`，但事情变得有点混乱和失控，特别是当我*在事后*应用它时。

一方面，事后应用此配置似乎不会影响在应用此选项之前提交到存储库的文件。另一件事是突然间所有的提交都会导致大量关于 CRLF 被转换为 LF 的恼人警告消息。

老实说，我真的不在乎使用什么换行符，我个人更喜欢 Unix 风格`\n`，但无论如何。我所关心的`git merge`只是变得更聪明一点，并忽略行尾的差异。

有时我有两个相同的文件，但 git 会将它们标记为冲突（并且冲突是*整个*文件），因为它们使用了不同的行结束符。

### 更新：

我发现`git diff`接受一个`--ignore-space-at-eol`选项，是否也可以让`git merge`使用这个选项？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-14T11:57:44.853

2013 年更新：

最新的 git 版本授权使用合并策略`recursive`和策略*选项*（`-X`）：

*   来自“ [Git Merge and Fixing Mixed Spaces and Tabs with two Branches](https://stackoverflow.com/a/5262473/6309) ”：

    ```
    git merge -s recursive -Xignore-space-at-eol 
    ```

但使用“ `-Xignore-space-change`”[也是一种可能](https://stackoverflow.com/a/13415932/6309)

*   [Fab-V](https://stackoverflow.com/users/1441706/fab-v)[在](https://stackoverflow.com/a/16054884/6309)下面提到：

    ```
    git merge master -s recursive -X renormalize 
    ```

* * *

[jakub.g](https://stackoverflow.com/users/245966/jakub-g)还[评论](https://stackoverflow.com/questions/861995/is-it-possible-for-git-merge-to-ignore-line-ending-differences/862920?noredirect=1#comment41273803_862920)说这些**策略也适用于樱桃采摘**：

```
git cherry-pick abcd123456 --strategy=recursive --strategy-option=renormalize 
```

这比`ignore-all-space`.

* * *

在 Git 2.29（2020 年第四季度）之前，所有内部使用合并递归机制的“合并”操作都应该遵守**`merge.renormalize`**配置，但其中许多没有。

请参阅[Elijah Newren ( ) 的](https://github.com/newren)[commit 00906d6](https://github.com/git/git/commit/00906d6f227b259ac7c8cebd07bbea0ba4792185)、[commit 8d55225](https://github.com/git/git/commit/8d552258f45ba3886e8d508ece8585b509a04677)、[commit 6f6e7cf](https://github.com/git/git/commit/6f6e7cfb52a07578c275656a8fd735265eca1a07)、[commit fe48efb](https://github.com/git/git/commit/fe48efb5fd161babea245415ee4feef60fee4964)（2020 年 8 月 3 日[）](https://github.com/newren)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 4339259](https://github.com/git/git/commit/4339259d5fa45160fb75d17052038ba96fb3664a))^(中，2020 年 8 月 10 日）)[`newren`](https://github.com/newren)
^([`gitster`](https://github.com/gitster))

> ## [`merge`](https://github.com/git/git/commit/8d552258f45ba3886e8d508ece8585b509a04677):`merge.renormalize`为合并机器的所有用途工作
> 
> ^(签字人：以利亚·纽伦)

> ' `merge`' 命令不是唯一的合并命令；其他命令如`checkout -m`or rebase 也可以。
> 
> 不幸的是，检查“ `merge.renormalize`”配置设置的代码的唯一区域是 in [`builtin/merge.c`](https://github.com/git/git/blob/8d552258f45ba3886e8d508ece8585b509a04677/builtin/merge.c)，这意味着它只能影响由“ `merge`”命令执行的合并。
> 
> 将此配置设置的处理移动到，`merge_recursive_config()`以便其他命令也可以从中受益。

* * *

原始答案（2009 年 5 月）

忽略 eol 样式的补丁已于 2007 年[6 月](http://kerneltrap.org/index.php?q=mailarchive/git/2007/6/28/250172/thread)提出，但它只关注`git diff --ignore-space-at-eol`，不关注`git merge`。

当时有人问这个问题：

> 应该`--ignore-space-at-eol`是一个选项`git-merge`吗？
> 合并是这个功能很重要的地方。
> 与这些选项生效的自动解析合并的语义是什么——它们仅用于重命名检测，还是我们，例如，不标记仅与空白更改发生冲突？如果我们不这样做，我们会自动接受哪个版本？

Julio C Hamano 并不十分热情：

> 这当然很诱人，但我怀疑应该留到以后的回合。
> 我怀疑它会引入两种不同类型差异的概念，一种是机械处理的（即与“git-merge-recursive”合并使用，并与“git-am”一起应用），另一种由检查人类去理解。
> 对于后一种情况，调整输入通常很有用，即使比较经过调整的输入文件的输出可能不容易用于机械应用。

**一般的想法，当涉及到时`git merge`，是依靠第三方合并工具。**

例如，我将[DiffMerge](http://sourcegear.com/diffmerge/)设置为 Git 合并工具，设置一个**规则集**，允许该合并工具忽略特定类型文件的 eol。

* * *

在 Windows 上使用 MSysGit1.6.3 进行设置，用于 DOS 或 Git bash 会话，使用 DiffMerge 或 KDiff3：

*   在您的 PATH 中设置一个目录（此处为：）`c:\HOMEWARE\cmd`。
*   在该目录中添加脚本 merge.sh（您最喜欢的合并工具的包装器）

合并.sh：

```
#!/bin/sh

# Passing the following parameters to mergetool:
#  local base remote merge_result

alocal=$1
base=$2
remote=$3
result=$4

if [ -f $base ]
then
    #"C:/Program Files/SourceGear/DiffMerge/DiffMerge.exe" "$alocal" "$base" "$remote" -m --result="$result" --title1="Mine" --title2="Merging to: $result" --title3="Theirs"

    # for merge respecting eol, KDiff3 is better than DiffMerge (which will always convert LF into CRLF)
    # KDiff3 will display eol choices (if Windows: CRLF, if Unix LF)
    "C:/Program Files/KDiff3/kdiff3.exe" -m "$base" "$alocal" "$remote" -o "$result"
else
    #there is not always a common ancestor: DiffMerge needing 3 files, BASE will be the result
    #"C:/Program Files/SourceGear/DiffMerge/DiffMerge.exe" "$alocal" "$result" "$remote" -m --result="$result" --title1="Mine" --title2="Merging to: $result" --title3="Theirs"

    # KDiff3 however does know how to merge based on 2 files (not just 3)
    "C:/Program Files/KDiff3/kdiff3.exe" -m "$base" "$remote" -o "$result"
fi 
```

*   为 Git 声明合并包装器

Git 配置命令：

```
git config --global merge.tool diffmerge
git config --global mergetool.diffmerge.cmd "merge.sh \"$PWD/$LOCAL\" \"$PWD/$BASE\" \"$PWD/$REMOTE\" \"$PWD/$MERGED\"
git config --global mergetool.diffmerge.trustExitCode false
git config --global mergetool.diffmerge.keepBackup false 
```

*   检查 autoCRLF 是否为假

系统级别的 git 配置：

```
git config ---system core.autoCRLF=false 
```

*   **测试一下，当两行相同（但它们的 eol 字符）时，DiffMerge 或 KDiff3 将在合并期间忽略这些行。**

DOS脚本（注意：[dos2unix命令来自here](http://www.bastet.com/)，用于模拟Unix eol风格。该命令已复制到本答案开头提到的目录中。）：

```
C:\HOMEWARE\git\test>mkdir test_merge
C:\HOMEWARE\git\test>cd test_merge
C:\HOMEWARE\git\test\test_merge>git init
C:\HOMEWARE\git\test\test_merge>echo a1 > a.txt & echo a2 >> a.txt
C:\HOMEWARE\git\test\test_merge>git add a.txt
C:\HOMEWARE\git\test\test_merge>git commit -m "a.txt, windows eol style"
C:\HOMEWARE\git\test\test_merge>git checkout -b windows
Switched to a new branch 'windows'
C:\HOMEWARE\git\test\test_merge>echo a3 >> a.txt & echo a4 >> a.txt
C:\HOMEWARE\git\test\test_merge>git add a.txt
C:\HOMEWARE\git\test\test_merge>git commit -m "add two lines, windows eol style"
C:\HOMEWARE\git\test\test_merge>git checkout master
C:\HOMEWARE\git\test\test_merge>git checkout -b unix
Switched to a new branch 'unix'
C:\HOMEWARE\git\test\test_merge>echo au3 >> a.txt & echo au4 >> a.txt && echo au5 >> a.txt
C:\HOMEWARE\git\test\test_merge>dos2unix a.txt
Dos2Unix: Processing file a.txt ...
C:\HOMEWARE\git\test\test_merge>git add a.txt
C:\HOMEWARE\git\test\test_merge>git commit -m "add 3 lines, all file unix eol style"
[unix c433a63] add 3 lines, all file unix eol style

C:\HOMEWARE\git\test\test_merge>git merge windows
Auto-merging a.txt
CONFLICT (content): Merge conflict in a.txt
Automatic merge failed; fix conflicts and then commit the result.

C:\HOMEWARE\git\test\test_merge>git ls-files -u
100644 39b4c894078a02afb9b1dfeda6f1127c138e38df 1       a.txt
100644 28b3d018872c08b0696764118b76dd3d0b448fca 2       a.txt
100644 3994da66530b4df80189bb198dcfac9b8f2a7b33 3       a.txt

C:\HOMEWARE\git\test\test_merge>git mergetool
Merging the files: a.txt

Normal merge conflict for 'a.txt':
  {local}: modified
  {remote}: modified
Hit return to start merge resolution tool (diffmerge): 
```

此时（点击“return”），DiffMerge 或 KDiff3 将打开，您将亲自查看哪些行实际合并，哪些行被忽略。

**警告**：结果文件将始终处于带有 DiffMerge 的 Windows eol 模式 (CRLF)...
KDiff3 提供以一种或另一种方式保存。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2012-08-30T10:25:38.720

我一直在寻找相同的答案，我发现了[这个](http://www.kernel.org/pub/software/scm/git/docs/gitattributes.html)

> # 合并具有不同签入/签出属性的分支
> 
> 如果您向文件添加了导致该文件的规范存储库格式发生更改的属性，例如添加 clean/smudge 过滤器或 text/eol/ident 属性，则合并任何不存在该属性的内容通常会导致合并冲突.
> 
> 为了防止这些不必要的合并冲突，可以通过设置 merge.renormalize 配置变量告诉 git 在解决三向合并时运行文件的所有三个阶段的虚拟签出和签入。这可以防止在已转换的文件与未转换的文件合并时，由签入转换引起的更改导致虚假的合并冲突。
> 
> 只要“涂抹→清洁”的输出结果与“清洁”相同，即使在已经被涂抹的文件上，此策略将自动解决所有与过滤器相关的冲突。不以这种方式操作的过滤器可能会导致必须手动解决的其他合并冲突。

因此，在任何存储库中运行此命令都可以解决问题：

```
git config merge.renormalize true 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-04-17T08:12:50.800

阅读[https://stackoverflow.com/a/12194759/1441706](https://stackoverflow.com/a/12194759/1441706)和[https://stackoverflow.com/a/14195253/1441706后](https://stackoverflow.com/a/14195253/1441706)

对我来说，这个命令完美地做到了：

```
git merge master -s recursive -X renormalize 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-07T11:44:22.940

正如这个答案：[https ://stackoverflow.com/a/5262473/943928](https://stackoverflow.com/a/5262473/943928)

你可以试试：`git merge -s recursive -Xignore-space-at-eol`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-14T08:10:40.983

我所做的是将所有内容保留为默认值（即 autocrlf=true），触摸所有文件（查找 .-exec touch {} \;），让 git 将它们视为“已修改”并将它们提交回来，然后完成它。否则你要么总是被烦人的消息或令人惊讶的差异所困扰，要么不得不关闭 git 的所有空白功能。

你会失去责备信息，但最好早点而不是晚点:)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-09-04T21:25:09.437

“git merge -Xrenormalize”就像一个魅力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T03:12:15.397

现在在我看来，最好的方法是在合并它们之前标准化两个分支（和提交）上的行尾。

我用谷歌搜索“将 crlf 转换为 lf”，并发现这是第一个结果：
[http ://stahlforce.com/dev/index.php?tool=remcrlf](http://stahlforce.com/dev/index.php?tool=remcrlf)

我下载并使用它，似乎是一个不错的工具。

```
>sfk remcr . .py 
```

请务必指定目录和文件类型（例如 .py），否则它可能会尝试弄乱`.git`目录的内容！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-23T09:49:27.900

AFAICT，（我没试过）你可以`git diff`用来比较你想合并到共同祖先的分支，然后将结果应用到`git apply`. 这两个命令都有 `--ignore-whitespace`忽略行尾和空格错误的选项。

不幸的是，如果补丁没有完全应用，整个操作就会中止。您无法修复合并冲突。有一个`--reject`选项可以在文件中保留不可修补的块`.rej`，这有帮助，但与在一个文件中显示合并冲突不同。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-12-11T19:08:17.567

阅读[解决合并冲突后：强制覆盖所有文件](https://stackoverflow.com/questions/14250257)

我终于解决了这个问题的版本。我试图从上游 repo 中提取更新，但我当前的 repo 遇到了与 CRLF 相关的问题，因此无法合并。应该注意的是，我没有需要担心的本地更改。以下步骤解决了我的问题：

根据 github 关于同步分叉的说明（[https://help.github.com/articles/syncing-a-fork/](https://help.github.com/articles/syncing-a-fork/)）：

1.  `git fetch upstream`

2.  `git reset --hard upstream/master`
    我对 git 的有限理解告诉我这是在做我想做的事——重新定位我的 fork（没有实际未提交的更改）以获得对上游源所做的所有更改。根据源页面，通常不需要此步骤，但 CRLF 问题使其成为必需。

3.  `git merge upstream/master`

4.  `git push`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-03-18T19:33:18.137

但是我建议使用像 sed 这样的工具来实现正确的行尾，然后是 diff 文件。我花了几个小时来*区分*具有不同行尾的项目。

最好的方法是：

1.  仅将项目文件（省略`.git`目录）复制到另一个目录，在其中创建存储库，然后添加文件并提交它们（应该在新存储库的主分支上）。
2.  将文件从第二个项目复制到同一个文件夹，但是另一个分支，例如`dev`（`git checkout -b dev`），在这个分支上提交文件并运行（如果第一个项目在主项目中）： `git diff master..dev --names-only` 只查看更改文件的名称

# .net - 如何在 Visual Studio 6 中的 c++ cdialog 上放置 .net UserControl

> ID：861997
> 
> 赞同：0
> 
> 时间：2009-05-14T07:25:38.267
> 
> 标签：.net, c++, user-interface, com, mfc

我的任务非常简单，创建一个 .net 用户控件并在旧的 Visual Studio 6 项目中使用它。

我已经创建了用户控件（它只是一个带有标签的用户控件），然后我按照本指南（[http://support.microsoft.com/kb/828736](http://support.microsoft.com/kb/828736)），它似乎工作正常。但是如何显示用户控件？我必须使用 CreateControl，我应该怎么做？

.net 看起来像：

命名空间 dotnetcotrol {

```
public interface dotnetcontrol
{
    void setText(string str);
}
public partial class dontnetcontrolClass : UserControl, dotnetcontrol
{

    public dontnetcontrolClass()
    {
        InitializeComponent();
    }

    public void setText(string str)
    {
        label1.Text = str;
    }
} 
```

}

而且 c++ 代码看起来几乎就像 ms 示例中的代码，但是我的项目是一个窗口 mfc 项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T11:53:09.420

对于这么简单的事情，为什么不编写自己的继承 CWnd 的类呢？控件需要是.Net UserControl 是否有原因？

也就是说，我在 VC++ 6 表单上托管 .Net 控件的方法是对 VC++ 8 (VC++ 2005) CWinFormsUserControl 类的源代码进行逆向工程。如果您安装了带有 VC++ 的 Visual Studio 2005，则在 %PROGRAMFILES%\Microsoft Visual Studio 8\VC\atlmfc\src\mfcm 下有此类的源代码。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-14T07:57:50.967

用户控件被添加到要显示的表单中，而不仅仅是“显示”

```
Form.Controls.Add(myUserControl); 
```

但是，如果您使用的表单不​​是 .NET，则情况会有所不同********