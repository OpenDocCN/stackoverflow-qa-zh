# StackOverflow 问答 10755000-10755999

# jsf - PrimeFaces JSF 库：灯箱内的整个页面？

> ID：10755007
> 
> 赞同：0
> 
> 时间：2012-05-25T13:08:51.197
> 
> 标签：jsf, primefaces

我想将整个页面放在 PrimeFaces 库 UI 组件`lightBox`中。

例如我有：

*   Normal_page.xhtml
*   Popup_page.xhtml

是否可以从 Normal_page.xhtml 启动 Popup_page.xhtml 并将其显示在 lightBox 内，以便 Popup_page 覆盖在 Normal_page 上？

**ps**

我曾经使用`<p:dialog>`and来做到这一点`<ui:include>`，就像这样：

```
<p:dialog widgetVar="myPopup"...> 
    <ui:include src="/Popup_page.xhtml"/>
</p:dialog> 
```

和

```
<p:commandButton onclick="myPopup.show();"/> 
```

但这似乎不适用于`<p:lightBox>`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:25:24.990

这两种方法都对我有用：

**灯箱内联方法：**

```
<p:lightBox>
    <h:outputLink value="#">  
        <h:outputText value="Open Lightbox Popup (using inline)"/>  
    </h:outputLink>   
    <f:facet name="inline">
        <ui:include src="popup_Page.xhtml"/>
    </f:facet>
</p:lightBox> 
```

**灯箱 iframe 方法：**

```
<p:lightBox iframe="true">      
    <h:outputLink value="popup_Page.xhtml">  
        <h:outputText value="Open Lightbox Popup (using iframe)"/>  
    </h:outputLink>   
</p:lightBox> 
```

# nginx - nginx的活跃连接不断增长

> ID：10755008
> 
> 赞同：3
> 
> 时间：2012-05-25T13:08:51.243
> 
> 标签：nginx, netstat, keep-alive

我有几个 nginx Web 服务器作为反向代理。

我发现一些服务器（不是全部）中的活动连接（包括读取写入和等待，从 http_stub_status 模块看到）不断从 3000 增长到 5000、10000 .... 10k ... 50k，并且即使在深夜也不会减少。

同时，我从netstat得到了一个更可靠的号码

```
netstat -nap | grep 80 | grep EST  | wc -l
2743 
```

keepalive_timeout 为 10 秒

工作进程都同时启动

```
5265 nginx: master process         6-19:18:55 May19

24498  \_ nginx: worker process         59:34 19:16

24499  \_ nginx: worker process         59:34 19:16

24500  \_ nginx: worker process         59:34 19:16

24501  \_ nginx: worker process         59:34 19:16

24502  \_ nginx: cache manager pr       59:34 19:16 
```

我在以下位置发现了类似的问题：

[http://markmail.org/search/?q=Upload+module+%2B+PHP+causes+active+connections+to+continually#query:Upload%20module%20%2B%20PHP%20causes%20active%20connections%20to %20连续+页面：1+中间：fdgyk6v32lnvaxul+状态：结果](http://markmail.org/search/?q=Upload+module+%2B+PHP+causes+active+connections+to+continually#query:Upload%20module%20%2B%20PHP%20causes%20active%20connections%20to%20continually+page:1+mid:fdgyk6v32lnvaxul+state:results)

但似乎和我不一样

error.log 中没有相关错误

该系统是

```
cat /etc/issue
CentOS release 5.3 (Final)
Kernel \r on an \m

uname -a
Linux 2.6.18-128.el5xen #1 SMP Wed Jan 21 11:12:42 EST 2009 x86_64 x86_64 x86_64 GNU/Linux 
```

nginx版本：

```
nginx -V
nginx version: Nginx/1.0.14
built by gcc 4.1.2 20080704 (Red Hat 4.1.2-44)
TLS SNI support disabled
configure arguments: --prefix=/home/web/nginx/ --user=nobody --group=nobody 
--with-    http_ssl_module --with-http_sub_module --with-http_dav_module 
--with-http_flv_module --    with-http_gzip_static_module 
--with-http_stub_status_module --http-proxy-temp-path=/home/web/nginx/data/proxy 
--http-fastcgi-temp-path=/home/web/nginx/data/fastcgi 
--http-client-body-temp-path=/home/web/nginx/data/client --with-pcre=../pcre-7.9 
--add-module=../ngx_http_upstream_keepalive-d7643c291ef0 
--add-module=../hmux/ --add-module=../nginx-sticky-module-1.0/ 
--with-google_perftools_module --add-module=../nginx_upstream_check_module-660183a 
```

这些模块是：

```
1: for cookie sticky
nginx-sticky-module.googlecode.com
2: hmux module for resin
code.google.com/p/nginx-hmux-module/
3: upstream check module
github.com/yaoweibin/nginx_upstream_check_module
4: upstream keepalive
mdounin.ru/hg/ngx_http_upstream_keepalive/ 
```

所有补丁都应用于 nginx src 代码。

# nginx.conf：

```
user  nobody;
worker_processes  4;
worker_cpu_affinity 0001 0010 0100 1000;
google_perftools_profiles /home/web/nginx/tcmalloc/tc;

events {
    worker_connections 51200;
    use epoll;
    epoll_events 4096;
    multi_accept on;
    accept_mutex off;   }

http {
    include       mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] '
                  '$status $body_bytes_sent ';

    access_log  logs/access.log  main;

    sendfile        on;
    keepalive_timeout  10;

    server_tokens off;

    gzip  on;
    gzip_types  text/plain text/css application/x-javascript text/xml application/json application/xml application/xml+rss text/javascript;
    gzip_vary on;

    server_names_hash_max_size 4096;
    proxy_buffer_size   64k;
    proxy_buffers       8 64k;
    proxy_busy_buffers_size     64k;
    client_header_buffer_size 64k;
    large_client_header_buffers 4 64k;
    proxy_headers_hash_max_size 1024;
    proxy_headers_hash_bucket_size 128;
    client_max_body_size 25m;

upstream backend{
    check interval=5000 fall=3 rise=2 timeout=2000 default_down=false type=tcp;
    keepalive 1024;
    server server1:80;
    server server2:80;
 }
server {
    listen       80;
    server_name  xxx;

    location / {
         proxy_pass http://backend;
    }

    error_page   500 502 503 504  /50x.html;

    location = /50x.html {
        root   html;
    }
}  

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:16:27.950

这可能是需要一些 TCP 参数调整的问题。检查此主题以获取一些深入的信息：[https ://serverfault.com/questions/339412/nginx-timeout-after-200-concurrent-connections](https://serverfault.com/questions/339412/nginx-timeout-after-200-concurrent-connections)

特别是@jeffatrackaid 的回复：

> 这是对 sysctl.conf 的建议：
> 
> ```
> net.ipv4.ip_local_port_range = 1024 65000
> net.ipv4.tcp_rmem = 4096 87380 8388608
> net.ipv4.tcp_fin_timeout = 30
> net.ipv4.tcp_keepalive_time = 30
> net.ipv4.tcp_tw_recycle = 1
> net.ipv4.tcp_tw_reuse = 1 
> ```

# c# - 在 .net C# 中从纯 HTML 电子邮件切换到纯文本电子邮件有困难吗？

> ID：10755013
> 
> 赞同：2
> 
> 时间：2012-05-25T13:09:10.153
> 
> 标签：c#

我正在与一个咨询小组合作开发一个程序，该程序目前使用 .net C# 脚本定期发送 HTML 格式的电子邮件。

电子邮件本身除了是 HTML 格式外，虽然内容是带有一些
标签的文本，并且包含的​​文本少于一页。

我希望顾问将其更改为文本格式，
用换行符/回车符替换标签。有人告诉我这是一个四个小时的工作，但这对我来说似乎太过分了。

当我在线查看诸如[http://www.mattvanandel.com/771/c-sending-an-email/](http://www.mattvanandel.com/771/c-sending-an-email/)之类的页面时，似乎可以在不到 4 小时内完成更改，包括将 .net 代码重新编译成一个 DLL，测试代码并将其上传到服务器。

并非所有开发人员都是平等的，但假设 .Net 开发人员的经验足以保证每小时 250 美元的工资，这是否合理？如果它少于 4 小时（即更像是 4 分钟），有人可以告诉我可能需要做些什么来进行修改。从我可以看到它可能需要修改的两行代码（即正文字符串和 IsBodyHtml 语句）。我还可能缺少什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T13:22:47.880

取决于需要什么样的测试来验证系统在更改后是否稳定，那么 4 小时可能会也可能不会过多。

对于紧密耦合系统中的简单外观更改可能会产生巨大的影响和风险。另一方面，在松散耦合的系统中，风险应该是最小的。

所以问题是，为什么要 4 小时。如果是我。我要求详细说明 4 小时的含义。毕竟您是客户，如果您需要成本明细，我建议您在您的权限范围内提出请求。

但是，我建议您以非对抗性的方式询问（即不要在所有枪支都在燃烧的情况下跳进去），因为开发人员可能知道但您不知道的严重影响。也许只是问一个简单的问题——“实施这一改变涉及什么”。

并且不要觉得您必须接受给出的第一个答案，如果您不满意，您应该要求开发人员进一步澄清。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:15:01.010

这完全取决于代码的编写方式——我们目前只能推测。他们可能使用了非常复杂的第 3 方工具——在这种情况下，可能需要四个小时。

但是，如果使用`System.Net.Mail`then 完成，则可以像将`IsBodyHtml`属性设置为`MailMessage`to一样简单`true`，这是一个四秒钟的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T13:30:48.177

更改“IsBodyHtml”属性会使其发送文本，但您还需要修改文本以插入换行符 - 在静态文本上这并不完全困难，但您需要考虑换行符何时正确（在html具有“块”布局和简单的内联样式）。您也没有提到文本是动态的还是静态的，如果它是动态生成的，则会增加复杂性。

你付出的时间，也是知识。我让别人来修理我的车，不是因为我不能，而是因为他们更好，并且拥有我可能没有的工具。

仅从花费时间的角度来看：

1.  获取知识/使用已经存在的知识
2.  估计与您交流的时间
3.  设计改变
4.  编码更改
5.  部署更改
6.  测试变更/功能测试
7.  征求关于变更/验收测试的反馈（来自您？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T13:13:46.030

.net中只有一个 Class 的属性“ `IsBodyHtml`”`MailMessage`可以在 Html/Text 邮件消息类型之间切换。

所以你可以自己检查一下，除了删除 html 标签和在服务器上发布更新的 dll 之外，这项工作有多大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T13:14:49.293

切换代码本身的机制就像上面所说的那样简单，用新字符串替换 HTML 正文字符串并更改 IsBodyHtml 属性。（假设代码使用内置的 .NET Framework 邮件组件）。

但请记住，基于文本的电子邮件将删除所有格式，因此您将无法在内容中包含字体颜色、图像、超链接或任何其他内容，除非是纯文本。

如果您真的想减少估算，请让内部人员编辑文本，开发人员所要做的就是切换 2 行代码，然后进行测试/部署。

我无法评论测试/部署所需的时间，因为这完全取决于您的系统。

# ruby-on-rails-3 - 在 Rails 3 中的 Html5 元素之间使用 Haml 中的 Content_for 生成内容

> ID：10755014
> 
> 赞同：0
> 
> 时间：2012-05-25T13:09:22.540
> 
> 标签：ruby-on-rails-3, html, haml

我正在尝试在我的视图中生成动态内容。

在我的 application.html.haml

```
!!!
%html
  %head
    %title YieldUsage
    = stylesheet_link_tag "application", :media => "all"
    = javascript_include_tag "application"
    = csrf_meta_tags
  %body
    = yield
    = yield :head
    = yield :scripts
    = yield :name_section 
```

我的助手就像；

```
def name_section_form
    content_for :name_section do
      label_tag(@post.name)
    end
  end 
```

和我的看法；

```
%article
  = name_section_form 
```

但它呈现；

```
<body>
    <article>

    </article>

    <label for="asfd">Asfd</label>

</body> 
```

为什么会这样？虫子什么的？有任何想法吗？

谢谢。恰达什。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:13:23.970

您的视图被转储到`yield`. 该方法设置特定的内容`yield`。删除`content_for`你的助手中的。

# android - Android：如何防止移动物体越线

> ID：10755015
> 
> 赞同：3
> 
> 时间：2012-05-25T13:09:25.223
> 
> 标签：android, view, touch-event, ondraw

![在此处输入图像描述](../Images/dfef4f2635fe53f7eb06f6d8800fb3e9.png)

```
 @Override protected void onDraw(Canvas canvas) {
                //canvas.drawPicture();
                canvas.drawColor(Color.CYAN);
                Paint p= new Paint();
                p.setColor(Color.RED);
                p.setStrokeWidth(20);
                canvas.drawLine(100, 200, 400, 500, p);
                if(movingObjects.size() > 0){
                for (MovingObject ball : movingObjects) {
                    canvas.drawBitmap(ball.getBitmap(), ball.getX(), ball.getY(), null);
                  }
                }

            }

            public boolean onTouchEvent(MotionEvent event) {
                int eventaction = event.getAction(); 

                int X = (int)event.getX(); 
                int Y = (int)event.getY(); 
                boolean redraw = false;
                switch (eventaction ) { 

                case MotionEvent.ACTION_DOWN:
                    currentMovingObjectId = 0;
                    for (MovingObject movingObject : movingObjects) {

                        int topLeftX = movingObject.getX() ;
                        int topLeftY = movingObject.getY() ;

                        double imageSize = movingObject.getSize();
                        double radCircle  = Math.sqrt( (double) (((topLeftX-X)*(topLeftX-X)) + (topLeftY-Y)*(topLeftY-Y)));

                        if ( (radCircle < imageSize) && 
                                (X- topLeftX) < movingObject.getWidth() && (Y - topLeftY) <  movingObject.getHeight() && 
                                (X- topLeftX) > 0 &&  (Y- topLeftY) > 0){
                            currentMovingObjectId = movingObjects.indexOf(movingObject) + 1;
                            offsetX = X- topLeftX;
                            offsetY = Y - topLeftY;
                            redraw = true;
                            break;
                        }
                      }

                     break; 

                case MotionEvent.ACTION_MOVE:   

                    if ( currentMovingObjectId > 0) {
                        drawAtX = X - offsetX;
                        drawAtY = Y - offsetY;

                        if(drawAtX < 0 || (drawAtX + movingObjects.get(currentMovingObjectId-1).getWidth()) > MovingObject.screenWidth)
                            drawAtX = movingObjects.get(currentMovingObjectId-1).getX();
                        if(drawAtY < 0 || (drawAtY + movingObjects.get(currentMovingObjectId-1).getHeight()) > MovingObject.screenHeight)
                            drawAtY = movingObjects.get(currentMovingObjectId-1).getY();

                        if(drawAtX != movingObjects.get(currentMovingObjectId-1).getX() || drawAtY != movingObjects.get(currentMovingObjectId-1).getY()){
                            movingObjects.get(currentMovingObjectId-1).setX(drawAtX);
                            movingObjects.get(currentMovingObjectId-1).setY(drawAtY);
                            redraw = true;
                        }
                    }

                    break; 

                case MotionEvent.ACTION_UP: 

                     break; 
                } 
                if(redraw)
                    invalidate(); 
                return true; 

            } 
```

上面的代码描述了我的自定义视图类中的 onTouch 和 onDraw 方法，我必须防止图像越线。因为我们可以使用矩阵来实现，我们可以通过将墙设置在 4 个侧面来水平和垂直移动对象以避免对象单元格，但我必须在拼图中自由移动对象。任何逻辑都会对我有所帮助。提前致谢

# c++ - OpenCV-2.4.0，NetBeans7.0.1，Ubuntu11.10，未定义对 `cv::Mat::zeros(int, int, int) 的引用

> ID：10755017
> 
> 赞同：1
> 
> 时间：2012-05-25T13:09:32.167
> 
> 标签：c++, opencv, netbeans-7, ubuntu-11.10

我在 Ubuntu 11.10 上使用 OpenCV-2.4.0 和 NetBeans 7.0.1。以下调用：

```
intLeftTriangleIndexImage=cv::Mat::zeros(fpInput.iRows, fpInput.iColumns, CV_32S); 
```

结果是

```
undefined reference to `cv::Mat::zeros(int, int, int) 
```

OpenCV-2.4.0 似乎只有一个库目录，也就是说

```
OpenCV-2.4.0/release/lib/ 
```

我已经链接到其中的所有图书馆。我不明白为什么我会收到一个看似非常基本的调用的链接错误。

非常感谢您在这件事上提供的任何帮助，
彼得。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:13:21.620

该函数是在内部定义的`libopencv_core.so`，因此请确保您链接到`opencv_core`.

```
$ nm libopencv_core.so | c++filt | grep zeros
000db520 T cv::Mat::zeros(cv::Size_<int>, int)
000db330 T cv::Mat::zeros(int, int, int) 
```

# php - 创建“结帐后” Magento 扩展概述

> ID：10755033
> 
> 赞同：1
> 
> 时间：2012-05-25T13:10:31.523
> 
> 标签：php, magento

如何创建“结帐后”Magento 扩展？我想要它做的就是在结帐后执行特定的操作，比如调用一个函数。

我已经阅读了它的文档和一些文章（这可能对新手更友好一些）。有些人建议将代码添加到`success.phtml`，但我不想覆盖 Magento 的任何“现有”文件。

**我不需要深入的答案，只需要一个粗略的概述**——要创建哪些文件，将它们放在哪里，以及如何能够将它们“安装”到其他人的计算机上。我可以自己解决剩下的问题（我是一名资深的 Python 开发人员，但我有兴趣制作一个快速的 Magento 扩展）。

（我读过[“如何在 Magento 中创建一个简单的 hello world 模块？”](https://stackoverflow.com/questions/576908/how-to-create-a-simple-hello-world-module-in-magento)但这并不是我所需要的*。*）

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:16:10.307

您想使用 dispatchEvents 和观察者文件。在这种情况下，请尝试 checkout_onepage_controller_success_action 或 checkout_multishipping_controller_success_action。

# android - 如何在不使用矩阵的情况下放大位图？

> ID：10755034
> 
> 赞同：0
> 
> 时间：2012-05-25T13:10:36.857
> 
> 标签：android

如何在不使用 android 矩阵的情况下缩放图像？

这是我正在使用的代码：

```
public class SimpImageView extends BaseView{

  private Bitmap image = null;

  private Paint borderPaint = null;

  PointF start = new PointF();
  PointF lastPosition = new PointF();

  Matrix savedMatrix = new Matrix();

  private Paint imagePaint = null;

  private Matrix matrix = null;

  public Bitmap getImage() {
    return image;
  }

  public void setImage(Bitmap image) {
    this.image = image;
  }

  public SimpImageView(Bitmap image,int x,int y,int width,int height){
    super(x, y, width, height);
    this.image = image;
    borderPaint = new Paint();
    borderPaint.setARGB(255, 255, 128, 128);
    borderPaint.setStyle(Paint.Style.STROKE);
    borderPaint.setStrokeWidth(2);
    imagePaint = new Paint();
    imagePaint.setARGB(32, 255, 255, 255);
    imagePaint.setStyle(Paint.Style.FILL);

  }

  /* (non-Javadoc)
   * @see com.simplogics.surfaceview.Views.BaseView#onDraw(android.graphics.Canvas)
   */
  @Override
  public void onDraw(Canvas canvas) {
    // TODO Auto-generated method stub
    canvas.drawBitmap(image, getBounds().left, getBounds().top, null);

    //        canvas.drawBitmap(image, matrix, new Paint());

    //  canvas.drawBitmap(image, matrix, borderPaint);

    //  canvas.drawRect(getBounds() , borderPaint);
  }

  /* (non-Javadoc)
   * @see com.simplogics.surfaceview.Views.BaseView#onTouchEvent(android.view.MotionEvent)
   */

  static final int NONE = 0;
  static final int DRAG = 1;
  static final int ZOOM = 2;
  int mode = NONE;

  @Override

  public boolean onTouchEvent(MotionEvent event) {
    boolean handled = false;

    Log.d("SimpEditText", "(int)event.getX() " + (int)event.getX());
    Log.d("SimpEditText", "(int)event.getY() " + (int)event.getY());

    if(isTouchedInBounds((int)event.getX(), (int)event.getY())){
      Log.d("SimpEditText", "Touched in Bounds");
      handled = true;
      switch (event.getAction() & MotionEvent.ACTION_MASK) {
      case MotionEvent.ACTION_DOWN:
        start.set(event.getX(), event.getY());
        lastPosition.x = getBounds().left;
        lastPosition.y = getBounds().top;

        Log.d("VerticalLabelView", "mode=DRAG");
        mode = DRAG;
        break;
      case MotionEvent.ACTION_POINTER_DOWN:
        mode = ZOOM;
        Log.d("VerticalLabelView", "mode=ZOOM");
        break;
      case MotionEvent.ACTION_UP:
        mode = NONE;
        break;
      case MotionEvent.ACTION_POINTER_UP:
        mode = NONE;
        Log.d("VerticalLabelView", "mode=NONE");
        break;
      case MotionEvent.ACTION_MOVE:
        if (mode == DRAG) {
          int x = (int)(event.getX() - start.x);
          int y = (int)(event.getY() - start.y);
          setPosition((int)lastPosition.x + x, (int)lastPosition.y + y);
          mode = DRAG;
          break;
        }else if(mode == ZOOM){
          Log.d("SimpImageView", "MODE=ZOOM");
          Log.d("SimpImageView", "getImage().getWidth()="+getImage().getWidth());
          Log.d("SimpImageView"," getImage().getHeight()="+getImage().getHeight());

        }
        break;
      }
    }

    return handled;
  }
} 
```

baseView.java

```
public abstract class BaseView {

  private int id = -1;

  private Object tag = null;

  private Rect bounds = null;

  public Rect getBounds() {
    return bounds;
  }

  public BaseView() {
    bounds = new Rect();
  }

  public BaseView(int x, int y, int width, int height) {
    bounds = new Rect(x, y, x + width, y + height);
  }

  public abstract void onDraw(Canvas canvas);

  public abstract  boolean onTouchEvent(MotionEvent event);

  public void setBounds(int x, int y, int width, int height){
    bounds.set(x, y, x + width, y + height);
  }

  public void setPosition(int x, int y){
    if(x <= 0 || y <= 0){
      Log.e("SimpEditText1", "----------------------------------------------------------");
      Log.e("SimpEditText1", "-------------0000000000000000000000000000000000------------");
      Log.e("SimpEditText1", "----------------------------------------------------------");
    }
    bounds.set(x, y, x + bounds.width(), y + bounds.height());
  }

  public void setScale(int x,int y,int width,int height){
    bounds.set(x, y, x + bounds.width()+width, y + bounds.height()+height);
  }

  protected boolean isTouchedInBounds(int xPos, int yPos){
    return bounds.contains(xPos, yPos);
  }

  public Object getTag() {
    return tag;
  }

  public void setTag(Object tag) {
    this.tag = tag;
  }

  public int getId() {
    return id;
  }

  public void setId(int id) {
    this.id = id;
  }

  /**
   * @param w
   * @param h
   * @param oldw
   * @param oldh
   */
} 
```

# bash - 为什么 ps 格式选项 '%a' 会被截断？

> ID：10755036
> 
> 赞同：2
> 
> 时间：2012-05-25T13:11:00.027
> 
> 标签：bash, ps

我正在尝试读取`ps`使用指定的自定义格式的输出`-o`。因为我想指定一个自定义分隔符，所以我使用了 AIX 格式描述符（例如`%p`，对于 pid、`%a`对于 args 等），但是在使用普通格式代码时会出现同样的问题。

当我`%a`在此格式字符串的末尾指定时，一切都按预期工作：

```
$ echo 'while true; do sleep 1; done' > really-really-really-long-filename 

$ bash really-really-really-long-filename &
[1] 31181

$ ps -p 31181 -o '%p|%a'

  PID|COMMAND
31181|bash really-really-really-long-filename 
```

但是，如果`%a`不是最后一个字段，我会得到：

```
$ ps -p 31181 -o '%a|%p'

COMMAND                    |  PID
bash really-really-really-l|31181 
```

这似乎与任何屏幕宽度修饰符无关。这里还有其他东西在起作用吗？

（GNU 重击 4.1.5）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:25:49.610

也许不是最优雅的解决方案，但您可以混合和匹配格式，以便您可以对选定字段使用宽度控制。例如

```
[me@home]$ ps -p 780 -o "%a|%p"
COMMAND                    |  PID
dbus-daemon --system --fork|  780

[me@home]$ ps -p 780 -o args:50 -o "|%p"
COMMAND                                           |  PID
dbus-daemon --system --fork --activation=upstart  |  780 
```

至于为什么会发生截断，我的*猜测*是当它不是最后一个字段时，每个字段都有一个硬编码的宽度（除非用户指定了宽度）。这节省了程序必须首先缓冲输出以确定打印前的最大列宽。

在`args`默认硬编码的情况下，宽度似乎是`27`（请参阅[此实现`ps`](https://gitlab.com/procps-ng/procps/-/blob/master/ps/output.c#L1495)）。

我应该提一下，这只是我的一个纯粹的猜测，不一定是这样。

# ruby-on-rails - 无法将项目推送到 Heroku。指纹问题

> ID：10755041
> 
> 赞同：2
> 
> 时间：2012-05-25T13:11:47.603
> 
> 标签：ruby-on-rails, heroku

当我尝试将 git 项目推送到 heroku 时，它给了我一个错误 -

> 您的带有指纹 xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx 的密钥无权访问 my_heroku_app。

我已经尝试了几乎所有我在互联网上找到的东西——添加密钥、上传、删除每个密钥然后重试。我检查了没有多个帐户。我还检查了 .git/config 文件以查看项目名称是否准确。

我注意到，在我删除 known_hosts 文件并尝试推送项目后，它说 -

> 无法确定主机“heroku.com (50.19.85.132)”的真实性。
> RSA 密钥指纹是 *some.random.fingerprint。
> 您确定要继续连接（是/否）？是
> 警告：将 'heroku.com,50.19.85.154' (RSA) 永久添加到已知主机列表中。
> ！您的带有指纹*my.original.configured.fingerprint*的密钥无权访问 first-app。
> 致命：远端意外挂断

这很有趣，因为那不是我的指纹。我在 ib_rsa.pub 中的那个与 heroku 尝试使用的那个不同。我做了一个heroku键，我只看到一个键（它应该使用的那个）。我不知道它从哪里挑选这个奇怪的键。任何建议都会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T04:34:33.187

我找到了解决方案。

在 .git/config 中，将 [remote "heroku"] 中的项目名称更改为 heroku 给出的名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-04-11T11:14:00.917

避免指纹问题只需输入

`$ heroku git:remote -a your-heroku-app-name`

（我的案例：$ heroku git:remote -a blooming-plateau-75741）

并跟随`$ git push heroku master`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-08-19T08:01:09.620

一开始，应该，如上所述 -

> 避免指纹问题只需输入

```
$ heroku git:remote -a your-heroku-app-name 
```

然后，您需要再次创建密钥：

```
ssh-keygen -t rsa 
```

并添加到heroku：

```
heroku keys:add 
```

并关注你可以推送：

```
$ git push branch_name:master 
```

# java - 使用泛型绑定不匹配错误

> ID：10755046
> 
> 赞同：2
> 
> 时间：2012-05-25T13:12:12.023
> 
> 标签：java, generics, collections

当我尝试在 1.5 中编译我以前的 java 1.4 代码时，我遇到了这个泛型绑定不匹配问题。代码如下

```
try {
    ArrayList simplePrincipals = new ArrayList(
            ((java.util.Collection) (subject.getPrincipals(Class
                    .forName("com.efunds.security.jaas.SimplePrincipal")))));
    if (simplePrincipals.size() > 0) {
        ((SimplePrincipal) simplePrincipals.get(0))
                .setPermissions(webPerm);
    }
} 
```

**错误是：**

> 绑定不匹配：`getPrincipals(Class<T>)`Subject 类型的泛型方法不适用于 arguments `(Class<capture#1- of ?>)`。推断的类型`capture#1-of ?`不是有界参数的有效替代品`<T extends Principal>`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T13:18:10.960

如果您查看[Javadocs，](http://docs.oracle.com/javase/6/docs/api/javax/security/auth/Subject.html#getPrincipals%28java.lang.Class%29)您会发现它`getPrincipals()`现在被定义为采用`Class<T extends Principal>`- 即`Class`表示`Principal`. 您的代码必须考虑到这一点，例如，通过使用以下`asSubclass()`方法：

```
String className = "com.efunds.security.jaas.SimplePrincipal";
Class<? extends Principal> clazz =
    Class.forName(className).asSubclass(Principal.class); 
ArrayList<Principal> simplePrincipals =
    new ArrayList<Principal>(subject.getPrincipals(clazz)); 
```

请注意，您的强制转换`Collection`以及大多数括号都是不必要的。

# python - 将 MySQL 查询转换为 XML 时出现 Python 编码错误

> ID：10755048
> 
> 赞同：0
> 
> 时间：2012-05-25T13:12:14.547
> 
> 标签：python, mysql, xml, encoding, lxml

我使用此脚本生成必须采用某种格式的自定义 XML 文件。它查询数据库并将结果转换为一个大的 xml 文件。我对从库存零件清单到员工记录的多个数据库执行此操作。

```
import csv
import StringIO
import time
import MySQLdb
import lxml.etree
import lxml.builder
from datetime import datetime
import string
from lxml import etree
from lxml.builder import E as buildE
from datetime import datetime
from time import sleep
import shutil
import glob
import os
import logging

def logWrite(message):
    logging.basicConfig(
        filename="C:\\logs\\XMLSyncOut.log",
        level=logging.DEBUG,
        format='%(asctime)s %(message)s',
        datefmt='%m/%d/%Y %I:%M:%S: %p'
    )
    logging.debug(message)

def buildTag(tag,parent=None,content=None):
        element = buildE(tag)
        if content is not None:
                element.text = unicode(content)
        if parent is not None:
                parent.append(element)
        return element

def fetchXML(cursor):
        logWrite("constructing XML from cursor")
        fields = [x[0] for x in cursor.description]
        doc = buildTag('DATA')
        for record in cursor.fetchall():
                r = buildTag('ROW',parent=doc)
                for (k,v) in zip(fields,record):
                        buildTag(k,content=v,parent=r)
        return doc

def updateDatabase 1():
        try:
                conn = MySQLdb.connect(host = 'host',user = 'user',passwd = 'passwd',db = 'database')
                cursor = conn.cursor()

        except:
                sys.exit(1)
                logWrite("Cannot connect to database - quitting!")

        cursor.execute("SELECT * FROM database.table")
        logWrite("Dumping fields from database.table into cursor")                
        xmlFile = open("results.xml","w")
        doc = fetchXML(cursor)
        xmlFile.write(etree.tostring(doc,pretty_print=True))
        logWrite("Writing XML results.xml")
        xmlFile.close() 
```

出于某种原因，我从 Excel 电子表格导入的一个新数据库出现了某种类型的编码错误，而其他数据库则没有。这是错误

```
element.text = unicode(content)
UnicodeDecodeError: 'ascii' codec can't decode byte 0x96 in position 21: ordinal not in range(128) 
```

我尝试通过将 buildTag 函数更改为如下所示显式编码为 ascii：

```
def buildTag(tag,parent=None,content=None):
        element = buildE(tag)
        if content is not None:
            content = str(content).encode('ascii','ignore')
            element.text = content
        if parent is not None:
                parent.append(element)
        return element 
```

这仍然没有奏效。

关于我能做些什么来阻止这种情况的任何想法？我无法逃脱它们，因为我不能将“\x92”作为输出显示在记录中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:33:51.497

我专注于

```
element.text = unicode(content)
UnicodeDecodeError: 'ascii' codec can't decode byte 0x96 in position 21: ordinal not in range(128) 
```

我假设它`content`是 type `str`，即它包含字节码（仅适用于 Python 2）。您必须知道使用哪种编码来生成此字节码。然后，为了从这个字节码创建一个 unicode 对象，你必须明确告诉 Python 如何解码它，例如：

```
element.text = content.decode("utf-8") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:03:13.480

我认为您在 Windows 编码中存在问题，您可以在 shell 中尝试：

```
In: print '\x92'.decode('cp1251')
Out: ' 
```

# java - 使用 DTO 或值对象模式来应对延迟加载异常

> ID：10755050
> 
> 赞同：4
> 
> 时间：2012-05-25T13:12:21.117
> 
> 标签：java, spring, hibernate, rest, dto

只是 Java/Hibernate/Spring/Mysql 堆栈中的架构问题

我应该在服务层中使用 OpenSessionInView 模式还是使用 DTO 对象来应对延迟加载异常。

从服务层返回域/实体对象是一种好习惯吗？还是返回 DTO 对象是一种好习惯，这些对象稍后会在 Web 服务层中序列化为 xml/json。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:58:05.747

我遵循一个非常简单的规则：

DTO 或多或少是从一个域到另一个域的转换。这意味着我仅在两层之间有物理分离时才使用 DTO。

这意味着如果您有 JSP，您可以使用 OpenSessionInView 模式来避免翻译模型等的大量过度工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-19T18:41:56.693

由于视图反模式中打开会话的不可预测的性能影响，我将始终使用 DTO 方法。

我为该用例创建了[Blaze-Persistence 实体视图](https://github.com/Blazebit/blaze-persistence#entity-view-usage)。您基本上将 JPA 实体的 DTO 定义为接口并将它们应用于查询。它支持映射嵌套的 DTO、集合等，基本上是您所期望的一切，最重要的是，它将提高您的查询性能，因为它会生成仅获取 DTO 实际需要的数据的查询。

您的示例的实体视图可能如下所示

```
@EntityView(Person.class)
interface PersonDto {
  String getName();
} 
```

查询可能看起来像这样

```
List<PersonDto> dtos = entityViewManager.applySetting(
  EntityViewSetting.create(PersonDto.class),
  criteriaBuilderFactory.create(em, Person.class)
).getResultList(); 
```

# java - 使用自定义适配器刷新 ListView

> ID：10755052
> 
> 赞同：0
> 
> 时间：2012-05-25T13:12:39.993
> 
> 标签：java, android, listview, android-arrayadapter, asmack

我正在为 android 编写一个小型 google talk 客户端，但无法正确刷新 ListView。

此列表包含联系人列表，并显示联系人的姓名和状态。我的监听器工作正常，我可以在日志猫窗口中看到每个联系人的存在变化，但我的 ListView 不刷新......这是一些代码：

```
package de.marc.messenger;

// ofc here are the imports

public class RosterActivity extends Activity {

private Roster _roster;
private XMPPConnection _connection;
private List<HashMap<String, String>> _buddies;
private BuddyAdapter _adapter;
private ListView _list;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.roster);

    _buddies = new ArrayList<HashMap<String, String>>();
    _connection = LoginActivity.CONNECTION;

    makePauseForRoster();

    _roster = _connection.getRoster();

    addRosterListener();
    fillBuddyList();
    sortBuddyList();
    initializeListView();
}

/**
 * Lets the thread sleep for a second to ensure that the presence of every
 * user will be available
 */
private void makePauseForRoster() {
    try {
        Thread.sleep(1000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}

/**
 * Adds a listener to the roster, primarily for changes of presence
 */
private void addRosterListener() {
    _roster.addRosterListener(new RosterListener() {
        public void presenceChanged(Presence presence) {
            String user = presence.getFrom().split("/")[0];
            HashMap<String, String> buddy = findBuddyInRoster(user);
            String p = getPresenceString(user);
            buddy.put("presence", p);
            System.out.println(buddy.values().toString()); // this works
            _adapter.notifyDataSetChanged(); // this doesn't
            _list.invalidate(); // this neither
        }
    });
}

/**
 * Fills the list view with the roster entries
 */
private void initializeListView() {

    _adapter = new BuddyAdapter(this, R.layout.roster_item,
            _buddies);

    _list = (ListView) findViewById(R.id.list_roster);
    _list.setAdapter(_adapter);
}

/**
 * Fills the buddy list with relevant data from a RosterEntry. Relevant data
 * is the users' name, email and presence
 */
private void fillBuddyList() {
    // this just fills my list of hashmaps (_buddies)
}

/**
 * Get a predefined String depending on the presence of a user
 */
private String getPresenceString(String user) {
    // something like "available: away ()" -> "away"
}

/**
 * Sorts the buddy list. Only criterion is the presence of the user, because
 * we have linear algorithms for this kind of problem.
 */
private void sortBuddyList() {
    // move all offline contacts to the end
    // move all online contacts to the beginning
    // all other kind of contacts will stay in the middle
}

/**
 * Finds a specific buddy object for a user via his hashed email
 */
private HashMap<String, String> findBuddyInRoster(String user) {
    for (HashMap<String, String> buddy : _buddies) {
        if (user.equals(buddy.get("user"))) {
            return buddy;
        }
    }
    return null;
} 
```

}

这工作正常，一切都正确显示.. 唯一的麻烦似乎是在 addRosterListener() 方法中，其中实现了 onPresenceChanged() ..

这是我的适配器：

```
package de.marc.messenger;

// as well some imports

public class BuddyAdapter extends ArrayAdapter<HashMap<String, String>> {

private Context _context;
private List<HashMap<String, String>> _map;
    private LayoutInflater _inflater;

public BuddyAdapter(Context context, int id, List<HashMap<String, String>> map) {
    super(context, id, map);
    _context = context;
    _map = map;
            _inflater = (LayoutInflater) _context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    // find view of a single row in a listview
    View row = convertView;
    if (convertView == null) {
        row = _inflater.inflate(R.layout.roster_item, null);
    }

    // get data for a specific row
    String name = _map.get(position).get("name");
    String user = _map.get(position).get("user");
    String presence = _map.get(position).get("presence");

    // extract views from the row view
    TextView nameText = (TextView) row.findViewById(R.id.text_name);
    TextView userText = (TextView) row.findViewById(R.id.text_id);
    ImageView presenceImg = (ImageView) row
            .findViewById(R.id.image_presence);

    // set data in extracted views
    nameText.setText(name);
    userText.setText(user);

    int resource = 0;
    // something is done with this variable
    presenceImg.setImageResource(resource);

    return row;
} 
```

}

有什么我想念的吗？

**编辑：**我改变了我的 onPresenceChanged 方法，如下所示：

```
public void presenceChanged(Presence presence) {
    String user = presence.getFrom().split("/")[0];
    HashMap<String, String> buddy = findBuddyInRoster(user);
    _adapter.remove(buddy);
    String p = getPresenceString(user);
    buddy.put("presence", p);
    _adapter.add(buddy);
    _adapter.notifyDataSetChanged();
} 
```

它在某种程度上起作用：在屏幕上滑动一点后，改变他的存在的联系人现在不在列表中：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:41:41.383

构造 ArrayAdapter 时，它保存对传入的 List 的引用。如果您要传入一个作为 Activity 成员的 List，然后更改该 Activity 成员，则 ArrayAdapter 仍然持有对原始列表。适配器不知道您更改了 Activity 中的列表。

在我看来，这就是您正在做的事情，因此您需要使用新的列表数据重新创建适配器。

或者您可以使用 ArrayAdapter 方法来修改底层列表（`add`、、、、`insert`等`remove`）`clear`然后 notifyDataSetChanged 将起作用。

# ios - ios水平滚动菜单-背景按钮选择

> ID：10755054
> 
> 赞同：0
> 
> 时间：2012-05-25T13:12:41.163
> 
> 标签：ios, xcode, ios5, uibutton

我尝试在 scrollView 中制作水平导航菜单。对于菜单中的每个项目，我都有不同的图像。当我选择一个项目时，我想更改该项目的背景图像，但我不知道为什么我的代码不起作用：

```
for (int i=0; i<12; i++) {
            UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
            UIImage *normal=[UIImage imageNamed:@"icon1"];
            UIImage *selec=[UIImage imageNamed:@"icon1down"];
            [btn setFrame:CGRectMake(i*larg, 0, 42.0, 43.0)];
            [btn setBackgroundImage:normal forState:UIControlStateNormal];
            [btn setBackgroundImage:selec forState:UIControlStateSelected];

            [scrollCat addSubview:btn];
            cx+=42.0;
    }
    [scrollCat setContentSize:CGSizeMake(cx, 43)]; 
```

这段代码有什么不好的地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T07:14:12.623

尝试`UIControlStateHighlighted`代替`UIControlStateSelected`. 突出显示的是用户触摸您的按钮时的状态。Selected 仅用于某些控件，例如段；一个自定义按钮（一个保持选中状态的按钮）将/可以使用 Selected。

来自[developer.apple.com 上的 UIControl_Class 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIControl_Class/Reference/Reference.html)（强调我的）：

> **UIControlStateHighlighted**
> 
> 控件的突出显示状态。当在跟踪过程中触摸进入和退出以及发生触摸事件时，控件将进入此状态。...
> 
> **UIControlStateSelected**
> 
> 控件的选定状态。*对于许多控件，此状态对行为或外观没有影响*。但是其他子类（例如，UISegmentedControl 类）可能会根据它们选择的状态而具有不同的外观。...

# c++ - QFlags 枚举类型转换突然失败

> ID：10755058
> 
> 赞同：6
> 
> 时间：2012-05-25T13:12:53.687
> 
> 标签：c++, qt, qt4, qt4.7

我已经在库中运行了这段代码很长一段时间：

```
MyClass::MyClass() 
  : QDialog()
{
    // (...)
    setWindowFlags( Qt::CustomizeWindowHint | Qt::WindowTitleHint );
    // (...)
} 
```

然后，在更改库的各个部分后，我突然收到以下消息：

```
error C2664: 'QWidget::setWindowFlags': cannot convert parameter 1 from 'int' to 'Qt::WindowFlags' 
```

显然它没有找到 | QFlags 类提供的运算符重载使得 | 返回一个 int 而不是 QFlags 构造。

我知道我可以手动将结果转换为`(Qt::WindowFlags)`并使其工作，但 QFlags 通常会使这种转换变得不必要。

知道什么样的变化会导致这种行为吗？

我包括`<QtGui/QDialog>`通常就足够了。包括`<QtCore/QFlags>`不会改变行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-02-06T01:28:26.117

自[5.12.0 起，](https://code.qt.io/cgit/qt/qtbase.git/tree/dist/changes-5.12.0/?h=v5.12.0#n138)[此提交](https://code.qt.io/cgit/qt/qtbase.git/commit/src/corelib/global/qnamespace.h?id=e759d38d491d9044a0558b1d45911e3b4115e772)应修复此问题：“在 Qt 命名空间中声明运算符| 以用于该命名空间中的 QFlags”。在 5.12.0 之前，Qt 曾经将其枚举运算符放在全局命名空间（参见[qnamespace.h](https://code.qt.io/cgit/qt/qtbase.git/tree/src/corelib/global/qnamespace.h?id=add58edcdbd986e68cdd65a2a935b76d85d5b639#n1733)）而不是`Qt`命名空间中。

问题是当当前命名空间中有另一个运算符匹配时，编译器[不会搜索父范围](https://stackoverflow.com/questions/5195512/namespaces-and-operator-resolution)。因此，只要您为命名空间中的任何类型的运算符添加重载，Qt 的重载就不会在匹配集中。[ADL](http://en.cppreference.com/w/cpp/language/adl)通常用于解析在与类型相同的命名空间中声明的运算符，但如果运算符位于不同的命名空间中，这将不起作用。

真正的解决方案是 Qt 将运算符放在与它们操作的类型相同的命名空间中，他们在 5.12.0 中这样做了。如果您坚持使用以前的版本，您可以自己导入运算符：

```
using ::operator|;
setWindowFlags(Qt::CustomizeWindowHint | Qt::WindowTitleHint); 
```

请注意，这可能会产生意想不到的后果，因为您可能会在不应该使用的上下文中提供很多名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-11T04:02:12.687

检查您的源代码以查看您是否使用`Q_DECLARE_OPERATORS_FOR_FLAGS`在出现编译错误之前在命名空间中的某处声明自己的标志。

正如@isanae 所说，`If there is another operator that matches in the current namespace, ...`. 因此，您不应放置可能匹配的其他运算符。

解决方案是将您自己的所有`Q_DECLARE_OPERATORS_FOR_FLAGS`声明放在全局命名空间中，就像 Qt 所做的那样。

希望这会有所帮助。当我把所有东西都放到一个统一的构建环境中时，我遇到了同样的问题，我切换了源代码的顺序，最后找到了导致这个问题的代码片段：一个`Q_DECLARE_OPERATORS_FOR_FLAGS`在命名空间内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:58:16.713

你试过分开| 函数调用的表达式？就像是：

```
// ..
Qt::WindowFlags flags = Qt::CustomizeWindowHint | Qt::WindowTitleHint;
setWindowFlags( flags );
// ... 
```

只是想看看问题到底出在哪里......

如果是包含问题，那就做`#include <QtGui>`

# python - 绘制一个 3D 强度数据的立方体

> ID：10755060
> 
> 赞同：5
> 
> 时间：2012-05-25T13:13:08.200
> 
> 标签：python, plot, cube

我有 k 个`(n,n,n)`强度值的立方体，我想绘制它们。

我将它们视为扩散 MRI 中的扩散张量，我想将它们可视化（可能是椭圆体），然后尝试以某种方式“对齐”。目前我只是为每个立方体绘制它的 n 个“切片” `(n,n)`。

这个任务有没有python模块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T13:57:49.210

您可以为此使用 mayavi2。由于我没有你的数据的表示，我给出了一个最小的工作示例，在下面的网格上有一些随机球体：

```
import numpy
import mayavi.mlab as mlab

# Create some random data
N = 20
x, y, z = numpy.mgrid[-5:5:20j, -5:5:20j, -5:5:20j]
val = numpy.random.random(z.shape)

# Plot and show in mayavi2
pts = mlab.points3d(x, y, z, val, scale_factor=.5,transparent=True)
mlab.show() 
```

![在此处输入图像描述](../Images/bcdad39518cb852033e1dd6e409896c6.png)

# php - 作为辅助函数的结果包括一个视图

> ID：10755061
> 
> 赞同：0
> 
> 时间：2012-05-25T13:13:15.190
> 
> 标签：php, codeigniter, foreach, include, load

我正在编写一个辅助函数来共享视图的负载，因为它可以在某些页面上被多次调用。唯一的问题是它有时只能工作，但所有相关文件都在那里，并且 Code Igniter 不会生成错误消息。这是调用该函数的视图：

```
 <div id="newProducts" class="floatLeft">
        <div class="titleBar">
            <h4>New Product Arrivals</h4>
        </div>
<?php foreach($newProducts as $product) :
        loadshareProductPreview($product);
endforeach; ?> 
```

这是到目前为止的功能：

```
function loadShareProductPreview($product)
{

$time = microtime(true);

if($time % 3 == 0)
{

    include("/home/client/library/application/views/widgets/productPreview.php");

}
elseif($time % 3 == 1)
{

    include("/home/client/library/application/views/widgets/productPreviewLS1.php");

}
elseif($time % 3 == 2)
{

    include("/home/client/library/application/views/widgets/productPreviewLS2.php");

}

} 
```

关于如何让它一直加载的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:50:54.423

在遵循评论中的建议后，我创建了一个函数来替换 incude() 。这是代码：

```
<?php
function loadShareProductPreview($product)
{

    $time = microtime(true);

    if($time % 3 == 0)
    {

        load_view("widgets/productPreview", $product);

    }
    elseif($time % 3 == 1)
    {

        load_view("widgets/productPreviewLS1", $product);

    }
    elseif($time % 3 == 2)
    {

        load_view("widgets/productPreviewLS2", $product);

    }

}

function load_view($view, $vars = '', $return = FALSE)
{

  $CI =& get_instance();
  return $CI->load->view($view, $vars, $return);
} 
```

# c# - 表单隐藏DIV的回发

> ID：10755062
> 
> 赞同：0
> 
> 时间：2012-05-25T13:13:18.093
> 
> 标签：c#, asp.net, forms, html

我有一个竞赛表单，它是一个用户控件，它位于有几个用户控件的页面上。当用户单击一个按钮时，它会显示这个驻留在用户控件中的表单，div（在页面上）首先是隐藏的。我遇到的唯一问题是当页面帖子返回时，即使出现错误，它也会隐藏 DIV。如果出现错误，我需要它来保持 DIV 打开，表单验证的代码逻辑在用户控件中，所以我如何访问页面上的 DIV？该页面是母版页，我们在母版页中不做任何代码逻辑，有没有在母版页上没有代码的情况下完成此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:19:33.420

最好的方法是公开一些属性，说明用户控件是否发生任何错误，并根据该用户控件属性设置 Div 在页面本身上的可见性。

# php - 需要帮助将循环转换为可在 php 对象中使用的内容

> ID：10755064
> 
> 赞同：0
> 
> 时间：2012-05-25T13:13:30.553
> 
> 标签：php, arrays, loops

此独立代码完美运行

```
$pdf
->addPDF('../docx/tag_1.pdf', 'all')
->addPDF('../docx/tag_2.pdf', 'all')
->addPDF('../docx/tag_3.pdf', 'all')
->merge('file', 'merged.pdf'); 
```

我需要的是能够动态创建一个循环，该循环从一个保存创建的标签数量的变量中添加标签，例如：

```
$pdf 
```

开始循环

```
->addPDF("../docx/tag_{$count}.pdf", 'all')
->addPDF("../docx/tag_{$count}.pdf", 'all')
->addPDF("../docx/tag_{$count}.pdf, 'all') 
```

等等，直到循环完成

```
->merge('file', 'merged.pdf'); 
```

请问我怎样才能做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:15:56.980

```
for ($i = 1; $i <= 3; $i++) {
    $pdf->addPDF("../docx/tag_$i.pdf", 'all');
}
$pdf->merge('file', 'merged.pdf'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:17:09.913

试试这个

```
$number_of_tags = 7;

for($i = 1; $i <= $number_of_tags; $i++)
{
    $pdf->addPDF('../docx/tag_'.$i.'.pdf', 'all');
}

$pdf->merge('file', 'merged.pdf'); 
```

# membership-provider - Composite C1 - Membership Provider - 简单的注册和登录

> ID：10755067
> 
> 赞同：9
> 
> 时间：2012-05-25T13:13:35.017
> 
> 标签：membership-provider, c1-cms

我正在使用 Composite C1 CMS 作为核心系统开发我的第一个应用程序。我目前正在阅读文档并学习数据结构等。我看到可以购买付费的 Extranet 包，但我更愿意在网站内开发自己的会员系统。

对于我来说，允许用户在我的 Composite C1 网站的前端注册，然后在他们注册和登录后允许他们访问密码保护区域的最佳方式是什么？

我是一个相当有经验的 .net 开发人员，但 Composite C1 对我来说非常新（第一印象我非常喜欢它！）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:19:31.150

与商业 Extranet 包一样，您可以编写一个 RenderingResponseHandler 插件并将其注册到 ~/App_Data/Composite/Composite.config 文件中。

查看指南[“如何在提供页面或媒体文件之前验证用户？”](http://docs.composite.net/ASP-NET/ASPNETFAQ?q=How%20can%20I%20validate%20users%20before%20a%20page%20or%20media%20file%20is%20being%20served?)

RenderingResponseHandler 插件的任务是批准页面和媒体请求，它们可以让请求通过或将请求重定向到新的 URL。

您需要自己处理用户数据库和登录页面。此外，一些允许 cms 用户将页面标记为受保护/公共的机制可能是有意义的。

[CodePlex 线程“限制对 MediaArchive 文件](http://compositec1.codeplex.com/discussions/359276#post847855)的访问”有相关指针

# actionscript-3 - Flex - RichTextEditor 在视图更改后失去样式

> ID：10755070
> 
> 赞同：0
> 
> 时间：2012-05-25T13:13:54.537
> 
> 标签：actionscript-3, apache-flex, adobe

似乎 flex 的 RichTextEditor 中存在一个错误，即在视图更改（视图状态更改）时，RTE 会丢失其格式。有没有人遇到过这个问题并且知道如何解决它。任何帮助深表感谢。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx"
               minWidth="955" minHeight="600" xmlns:base="ui.components.base.*" xmlns:ui="ui.*" xmlns:local="*">

    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;

            protected function click_clickHandler(event:MouseEvent):void
            {
                trace(this.rte.htmlText);
                this.currentState = "other";

            }

            protected function clickother_clickHandler(event:MouseEvent):void
            {
                this.currentState = "normal"
            }
        ]]>
    </fx:Script>
    <s:states>
        <s:State name="normal"/>
        <s:State name="other"/>
    </s:states>

    <s:VGroup includeIn="normal">
        <mx:RichTextEditor id="rte">

        </mx:RichTextEditor>
        <s:Button id="click" x = "500" y = "500" click="click_clickHandler(event)">

        </s:Button>
    </s:VGroup>

    <s:VGroup includeIn="other" >
        <s:Label>
            test
        </s:Label>
        <s:Button id="clickother" click="clickother_clickHandler(event)">
        </s:Button>
    </s:VGroup>
</s:Application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:30:18.207

我遇到了这个问题，解决方案是在外部应用样式。

意味着当视图发生变化时，将 css 应用于 rte。

祝你今天过得愉快....

# c# - 实体框架代码优先多对多映射被忽略且不保存

> ID：10755071
> 
> 赞同：1
> 
> 时间：2012-05-25T13:13:56.247
> 
> 标签：c#, entity-framework, ef-code-first, entity-relationship

我目前正在开发一个适用于动态调查表的应用程序。在数据库中定义的表单，如下所示：表单 > 部分 > 控件 > 问题。

每个问题可以有许多业务规则，例如：required、minlength、maxlength 等。

每个 BusinessRule 都是针对一个 Question 的规则。但是，有一些复杂的业务规则需要获取另一个问题的值。因此，每个业务规则可以有许多链接问题以从中获取所需的值。

我第一次使用代码，并为这种关系定义了以下类和映射：

```
public class Question
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int ValueTypeId { get; set; }
    public int ParentQuestionId { get; set; }

    public virtual ValueType ValueType { get; set; }
    public virtual ICollection<Question> ChildQuestions { get; set; }

    public virtual ICollection<BusinessRule> BusinessRules { get; set; }
    public virtual ICollection<BusinessRule> LinkedBusinessRules { get; set; }
}

public class BusinessRule
{
    public int Id { get; set; }
    public string ValidationMessage { get; set; }
    public string ConditionValue { get; set; }
    public int QuestionId { get; set; }
    public int BusinessRuleTypeId { get; set; }

    public virtual BusinessRuleType BusinessRuleType { get; set; }
    public virtual Question Question { get; set; }
    public virtual ICollection<Question> LinkedQuestions { get; set; }
}

internal class QuestionConfigruation : EntityTypeConfiguration<Question>
{
    public QuestionConfigruation()
    {
        this.HasMany<Question>(q => q.ChildQuestions)
            .WithOptional()
            .HasForeignKey(q => q.ParentQuestionId);

        this.HasMany(q => q.BusinessRules)
            .WithRequired(br => br.Question)
            .WillCascadeOnDelete(false);
    }
}

internal class BusinessRuleConfiguration : EntityTypeConfiguration<BusinessRule>
{
    public BusinessRuleConfiguration()
    {
        this.HasMany(b => b.LinkedQuestions)
            .WithMany(q => q.LinkedBusinessRules)
            .Map(map =>
                {
                    map.ToTable("BusinessRuleLinkedQuestions");
                    map.MapLeftKey("LinkedQuestionId");
                    map.MapRightKey("BusinessRuleId");
                });
    }
} 
```

这导致在数据库中生成以下内容：

![在此处输入图像描述](../Images/bb42c1417977988ac59f4197cbcb6dda.png)

最后，我的问题：

**[解决]**

为什么多对多连接表忽略了我在 BusinessRuleConfiguration 中指定的表名和键的映射？

**[/解决]**

当我尝试通过执行以下操作使用自定义初始化程序插入测试表单时：

```
var companyName = new Question
        {
            Name = "CompanyName",
            ValueTypeId = _typeRepository.GetValueType(ValueTypes.String).Id,
            BusinessRules = new List<BusinessRule>{
                new BusinessRule
                {
                    BusinessRuleTypeId = _typeRepository.GetBusinessRuleType(BusinessRuleTypes.required).Id,
                    ValidationMessage = "Company name is required.",
                }
            }
        };

var form = new Form
{       
   Sections = new List<Section>
   {            
        new Section(){
            Controls = new List<Control>
            {
                new Control{
                     ControlTypeId = _typeRepository.GetControlType(ControlTypes.Textbox).Id

                     Questions = new List<Question>
                     {
                         companyName,
                     }
                }
            }
        }
   }
} 
```

我收到以下错误：

`Unable to determine a valid ordering for dependent operations. Dependencies may exist due to foreign key constraints, model requirements, or store-generated values.`

我在这个问题上花费了太长时间，现在试图解决它，因此非常感谢对 EF 和 Code First 有更多经验的人的帮助。我开始后悔选择代码优先，但我不知道是代码优先还是我对它的理解。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:08:17.807

在我们进入实体框架之前，我认为您的模型不能正确反映您的业务问题，因此无效关系会导致错误。

您能否提供有关 LinkedBusinessRules BusinessRules 业务问题的更多信息

根据您提到的内容，我看到您的问题/业务规则类看起来更像这样。

需要注意的事项，而不是“一个问题涉及许多业务规则并且该业务规则有很多问题”

它现在是“一个问题有一对多的业务规则”。

```
public class Question
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int ValueTypeId { get; set; }
    public int ParentQuestionId { get; set; }
    public virtual ValueType ValueType { get; set; }
    public virtual ICollection<BusinessRule> BusinessRules { get; set; }
}

public class BusinessRule
{
    public int Id { get; set; }
    public string ValidationMessage { get; set; }
    public string ConditionValue { get; set; }
    public int BusinessRuleTypeId { get; set; }
    public virtual string BusinessRuleType { get; set; }
} 
```

如果您仍然有问题并且具有良好的数据库设计技能，请使用[http://salardbcodegenerator.codeplex.com/](http://salardbcodegenerator.codeplex.com/)之类的工具， 然后您可以先创建数据库并基于此生成类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:39:52.920

解决！

第一个问题是因为我忘记添加 @Slauma 和 @Abhijit 指出的 BusinessRule 配置。

保存新表单的第二个问题实际上与我在问题中没有详细说明的一些问题有关。

# jquery - jQuery UI 动态选项卡内容样式不起作用

> ID：10755074
> 
> 赞同：0
> 
> 时间：2012-05-25T13:13:59.040
> 
> 标签：jquery, ajax, jquery-ui, codeigniter, jquery-ui-tabs

我将每个选项卡的 href 设置为“控制器/方法”，以便它显示在选项卡中。将内容加载到选项卡中确实很棒，但是当我设置 html 表的样式（来自控制器/方法的示例内容）时，它不起作用。

```
Below is the screenshot of the tab loaded via ajax. 
```

![在此处输入图像描述](../Images/45988a896b00d4dd60cd734a9fd52731.png)

```
Here is the result if the method is directly access from the URL. 
```

![在此处输入图像描述](../Images/7a857ec8fd75a5459cf95d8f96ab119a.png)

问题：为什么通过 ajax 加载时表格看起来不一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T04:28:47.267

已经解决了这个问题。

因此，我将 css 放置在主页中，使动态内容获得样式。

# c# - 如何使用图片在不同的点上由冷变为热？

> ID：10755081
> 
> 赞同：0
> 
> 时间：2012-05-25T13:14:21.350
> 
> 标签：c#, usb, image

**背景：**
我有一个带有 13 个传感器的微控制器，用于在这 13 个不同点上读取一只脚的压力。从每个传感器读取的值从 0 到 1023 并被存储，然后我通过 USB 将包含这些值的字符串发送到在 pc 端运行的 C# 程序。

**问题：**
在使用C#的pc端程序中，我怎样才能在这13个特定的13个点上根据来自USB的值将脚的图片从冷变热？这样可以显示脚特定部位的压力。压力越大越热，压力越小越冷。不需要显示热或冷的数值。

USB通讯没问题，只需要图片处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:22:35.917

您要做的通常称为[热图](http://en.wikipedia.org/wiki/Heat_map)，因此如果您进一步研究该术语，您可能会发现一些额外的信息。

我看到您的任务的三个基本步骤：

1.  将真实世界的传感器位置映射到足部图像上的像素位置（这样您就知道要为哪些像素着色）
2.  读取所有传感器后，通过将传感器值映射到颜色来构建热图（我假设您想要 0 时为黑色，1023 时为亮红色），然后在传感器位置之间进行[线性插值](http://en.wikipedia.org/wiki/Linear_interpolation#Interpolation_of_a_data_set)相对于每个像素。
3.  使用 Alpha 混合将热图值混合到脚的图片中。您还可以创建一个“热图”位图图像，然后将其绘制在具有透明度设置的足部图像之上。

[您可以使用类似这样的代码](http://msdn.microsoft.com/en-us/library/aa287582%28v=vs.71%29.aspx)写入位图。

# c# - 在 FormattedID 上查询时出现意外结果

> ID：10755082
> 
> 赞同：0
> 
> 时间：2012-05-25T13:14:22.037
> 
> 标签：c#, rally

我已经构建了一个自定义集成，它通过格式化的 ID 查询 API。如果存在不同类型的重复 ID（US181 和 DE181），我通常只会收到来自系统的单个响应，这似乎是错误的工件。我想使用格式化的 ID（US181 或 181）搜索任务、故事和缺陷并获得适当的结果。

C#代码如下：

```
public static string FindArtifactByFormattedId(string formattedId)
    {
        string artifactRef = null;

        Request req = new Request("Artifact");
        req.Query = new Query("FormattedId", Query.Operator.Equals, formattedId.Remove(0,2));
        req.Workspace = rallyWorkspace;
        QueryResult queryResult = restApi.Query(req);
        if (queryResult.TotalResultCount > 0)
        {
            foreach(DynamicJsonObject djo in queryResult.Results)
            {
                if (djo["FormattedID"] == formattedId)
                {
                    artifactRef = djo["_ref"];
                    break;
                }
            }
        }

        return artifactRef;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:53:44.237

这似乎是我们的 WSAPI 中的一个缺陷。我已在内部提交了此文件，以便对其进行优先级排序，在此之前，您始终可以查询每个单独的工件以通过 FormattedID 查找特定的工件。

# java - UPnP：intel：生成堆栈：java android：在网络灯样本上调用操作

> ID：10755083
> 
> 赞同：0
> 
> 时间：2012-05-25T13:14:27.340
> 
> 标签：java, android, stack, intel, upnp

我正在使用设备构建器创建的 java/android 生成堆栈的帮助下研究 UPnP，并附带英特尔的 UPnP 工具。制作一个作为 UPnP 系统控制点的 android 应用程序。

工具来源：http: [//opentools.homeip.net/dev-tools-for-upnp](http://opentools.homeip.net/dev-tools-for-upnp)

为了帮助我理解这些工具的原理，我创建了一个网络灯并为 android 生成了堆栈。但我似乎无法弄清楚如何打开和关闭网络灯。

有人可以给我一个建议吗？我几乎无法在网上找到该项目的任何参考资料。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:47:12.317

这是否意味着您的网络灯已经在运行？你看到你的安卓上的灯泡了吗？您的 Android 是否连接到专用本地网络？也许你的 WiFi。UPnP 旨在用于本地可信网络（每个设计不包含安全性）。

如果是这样，则使用上述工具集中的 DeviceSpy 访问与 Android 连接的同一网络，并查找类型为 DimmableLight 的设备“网络灯”。[可以在http://upnp.org/resources/upnpresources.zip](http://upnp.org/resources/upnpresources.zip)上找到关于它可以做什么的完整描述

标准化dcps/Lighting Controls_1/UPnP-ha-DimmableLight-v1-Device*.pdf

DeviceSpy 公开所有接口和状态变量，您可以对其进行检查、调用和修改。在引擎盖下没有火箭科学，简单的老式 SOAP over HTTP 带有一些扩展的标头并用多播进行了盐渍化。所以要自己驱动网络灯，你需要写一个控制点。我想有问题的开发工具也可以为您生成该堆栈。或者使用一些我不会在这里重复的独立库。

# c++ - Boost错误代码人类可读的描述

> ID：10755084
> 
> 赞同：20
> 
> 时间：2012-05-25T13:14:29.633
> 
> 标签：c++, boost, error-handling, boost-asio

我在 Boost Asio 程序中遇到错误，例如

```
if (!error)
{
    //do stuff
}
else
{
    std::cout << "Error : " << error << std::endl;
    //handle error
} 
```

但是该错误不是人类可读的（例如，在没有证书的情况下连接到 SSL 服务器会给出错误 asio.ssl:335544539）。有没有更好的方法来显示错误？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-25T13:22:38.617

如果您可能会使用`boost::system::error_code`，您可以致电：

```
error.message() 
```

以获得更人性化的信息。

使用`operator<<`转化为：

```
os << ec.category().name() << ':' << ec.value() 
```

[在这里](http://www.boost.org/doc/libs/1_49_0/libs/system/doc/reference.html#Class-error_code)，您可以查看 中可用成员的详细概述`error_code`。

# javascript - 是否可以在 FusionCharts 中使用 JSP 导出（服务器端）javascript 图表？

> ID：10755085
> 
> 赞同：2
> 
> 时间：2012-05-25T13:14:31.427
> 
> 标签：javascript, fusioncharts

在我的 Tomcat 容器中，我创建了一个 JSP 页面，我在其中使用纯 JavaScript 呈现图表。

现在我想使用 fusionchart 之类的服务器端导出技术导出这个 JavaScript 渲染图表。我的 Tomcat 容器中有 Java EE 中此导出功能所需的所有 jar 文件（FCExporter.jar 等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T10:02:55.803

我得到了答案。我已经创建了 Servlet 并将请求从 JS 传递到 tomcat 容器中的该 servlet ..

```
<"chart exportEnabled="1" exportAction="Save" exportAtClient="0" 
    html5ExportHandler="http://localhost:8085/FusionCharts_J2EE/JSP/ExportExample/IMGExporter" 
    caption="Brand Winner" yAxisName="Brand Value ($ m)" 
    xAxisName="Brand" bgColor="F1F1F1" showValues="0" canvasBorderThickness="1" 
    canvasBorderColor="999999" plotFillAngle="330" plotBorderColor="999999" 
    showAlternateVGridColor="1" divLineAlpha="0"> 
```

在servlet ..我得到了svg parameter.with

```
request.getparameter("svg"); 
```

并使用以下命令，我生成了融合图表的 jpeg ..

```
java -jar batik-rasterizer.jar -d D:\ -m image/jpeg samples/out.svg 
```

欢呼....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:07:53.527

通过一些调整是可能的。

请阅读：[http ://docs.fusioncharts.com/charts/contents/?exporting-image/ECPureJS.html#ownserver](http://docs.fusioncharts.com/charts/contents/?exporting-image/ECPureJS.html#ownserver)

[部分：设置您自己的服务器来处理和导出 JavaScript 图表]

这告诉您如何设置自己的服务器以用于 JS 图表的服务器端导出。

好吧，您需要在您的服务器中运行 php 并按照上述页面中列出的步骤下载蜡染 jar。

设置完成后，编辑 index.php（导出的）文件以将生成的图像保存到您的服务器位置。

如果您没有 php，则需要编写 Java EE 代码来完成 index.php 所做的相同工作

或者

[稍后添加]

如果您不想使用任何客户端渲染，而是在服务器端静默创建图表图像，您可以关注[http://fcimg.org/](http://fcimg.org/)

# ios - 在 iOS Web 应用程序中启用“保存图像”

> ID：10755088
> 
> 赞同：4
> 
> 时间：2012-05-25T13:14:45.470
> 
> 标签：ios, iphone-web-app, iphone-standalone-web-app

将此添加到我的网站：

```
<meta name="apple-mobile-web-app-capable" content="yes"> 
```

虽然大多数人问如何在全屏网络应用程序中禁用标注，但我需要启用它。

我基本上会有一个包含 iPhone 壁纸的滑块，所以我想让用户**能够**保存图像，就像他们在常规 Safari 中所做的那样。

[这是我的演示](http://icosmin.com/w/)，您需要将其添加到主屏幕，然后从那里打开它。保存图像被禁用 - 为什么？

这甚至可能吗？

注意：指定`-webkit-touch-callout: inherit;`不会做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T07:37:07.253

这个解决方案对您有帮助吗？

[保存图像触摸菜单随 iOS6 网络应用程序一起消失。](https://stackoverflow.com/questions/12627350/save-image-touch-menu-gone-with-ios6-web-apps)

Ir 要求您拥有第二个域，但它可能只是一个子域（？）

祝你好运！

# json - 从 Handlebars 模板中的 JSON 数组中获取最后一个元素

> ID：10755092
> 
> 赞同：6
> 
> 时间：2012-05-25T13:14:50.910
> 
> 标签：json, handlebars.js, client-side-templating

因此，我发现可以使用以下方法在 Handlebars 中访问数组元素：

```
{{myArray.2.nestedObject}} and {{myArray.0.nestedObject}} 
```

..例如获取第三个和第一个元素。（[车把访问阵列项](https://stackoverflow.com/questions/8044219/handlebars-access-array-item)）

有没有办法从数组中获取**最后一个元素？**我尝试为它创建一个助手：

```
Handlebars.registerHelper("lastElement", function(array) {
  return array.last();  //Array.prototype extension
}); 
```

...并在模板中按如下方式调用它：

```
{{lastElement myArray}} or even {{lastElement myArray.lastElement nestedArray}} 
```

可悲的是，这不起作用。辅助函数显然返回字符串。我需要的是一种即使使用多维数组也能做到这一点的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-19T09:02:20.373

应该可以，我测试过了。

模板：

```
{{last foo}} 
```

数据：

```
{foo : [1,2,3,4,5,6]} 
```

帮手：

```
Handlebars.registerHelper("last", function(array) {
  return array[array.length-1];
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-20T18:51:20.540

上面的代码在所有情况下都可以正常工作。但是，如果数组传递的是空数组，则车把函数抛出错误的可能性是存在的。而是执行空检查，然后相应地返回值。

# php - 在 PHP 函数中使用参考值作为默认参数

> ID：10755094
> 
> 赞同：1
> 
> 时间：2012-05-25T13:14:56.797
> 
> 标签：php, function, dom, reference, default

我正在寻找这样做：

```
/* example filename: config_load.php */

$config_file = "c:\path\to\file.php";

function read_config($file = &$config_file)
{
$settings = array();
$doc = new DOMDocument('1.0');
$doc->load($file); 
$xpath = new DOMXPath($doc); 
$all=$xpath->query('appSettings/add');
foreach ($all as $setting) {$settings[$setting->getAttribute('key')]=$setting->getAttribute('value');}

return $settings;
}

/* end config_load.php */ 
```

所以当我实际调用文件时，它会像这样 -

```
require_once "config_load.php";
// $config_file = "c:\path\to\file2.php"; //could also do this
$config = read_config(); 
```

这样，如果我不指定文件，它将读取默认配置文件。在进行函数调用之前，我还可以在任何地方定义 $config_file。并且没有访问 config_load 文件的人不必担心能够加载不同的文件，他们可以在调用 read_config() 之前在任何地方定义它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:20:41.797

这是不可能的：

> 默认值必须是常量表达式，而不是（例如）变量、类成员或函数调用。

~ [http://www.php.net/manual/en/functions.arguments.php#functions.arguments.default](http://www.php.net/manual/en/functions.arguments.php#functions.arguments.default)

但是，您可以像这样绕过它：

```
function read_config($file = false) {
    global $config_file;
    if ($file === false) $file = $config_file;

    $settings = array();
    $doc = new DOMDocument('1.0');
    $doc->load($file); 
    $xpath = new DOMXPath($doc); 
    $all=$xpath->query('appSettings/add');
    foreach ($all as $setting) {$settings[$setting->getAttribute('key')]=$setting->getAttribute('value');}

    return $settings;
} 
```

或像这样：

```
function read_config($file = false, $config_file = false) {
    if ($file === false && $config_file !== false) $file = $config_file;

    $settings = array();
    $doc = new DOMDocument('1.0');
    $doc->load($file); 
    $xpath = new DOMXPath($doc); 
    $all=$xpath->query('appSettings/add');
    foreach ($all as $setting) {$settings[$setting->getAttribute('key')]=$setting->getAttribute('value');}

    return $settings;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-25T13:46:21.350

是的你可以：

```
<?php

$greet = function()
{
   return "Hello";
};

$a = $greet();
echo $a;
?> 
```

在这里阅读更多：http: [//php.net/manual/en/functions.anonymous.php](http://php.net/manual/en/functions.anonymous.php)

# jquery - 将 URL 重定向到 Ajax 版本的最佳解决方案？

> ID：10755100
> 
> 赞同：0
> 
> 时间：2012-05-25T13:15:15.487
> 
> 标签：jquery, ajax, url-redirection

[关于wordpress Pluto Theme中Ajax永久链接的](https://stackoverflow.com/questions/10739926/ajax-permalink-in-wordpress-pluto-theme)更多问题

所以它是一个完全的 Ajax Wordpress 主题，所有出现在 Google 中的 URL 都不是来自用户版本的网站，而是它的“底层”版本。

示例：Google 中出现的链接：www.thaiorchid.be/menus/（奇怪的黑页） 对比用户网页：www.thaiorchid.be/#menu-item-21

我正在寻找自动将所有页面（例如一个 /menus 重定向到一个 /#menu-item-21）以至少有一些像样的东西的最佳方法，知道什么是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:20:03.813

为了向后兼容，以正确的方式编写链接，但添加一个您觉得舒服的关系/类：

```
<a href="http://example.com/path/to/file.html" rel="ajax" >link</a> 
```

然后从jquery：

```
$('a[rel=ajax]').click(function(e) {
    //do whatever
    e.preventDefault();
}); 
```

在某些情况下，我跳过了添加**rel="ajax"**或**class="ajax"**，只是寻找指向我网站域的链接：

```
$('a[href^="http://example.com"]').click(function(e) {
    //do whatever
    e.preventDefault();
}); 
```

通常我**会做任何方法**向初始链接中的相同地址发出 ajax get 请求。它只是添加了一个参数**?ajax=1**，因此模板可以跳过输出页眉/页脚（当我使用 AHAH 时）或 json_encode 响应（用于 JSON 输出）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T19:25:12.437

不幸的是，我目前无法测试以下内容，但我相信这样的事情应该可以工作，因为在这个主题中使用了标准的 Wordpress 菜单。

```
// functions.php
function get_menu_id_for_post($post_id) {
  global $wpdb;
  $query = $wpdb->prepare(
    "
      SELECT post_id 
      FROM $wpdb->postmeta 
      WHERE meta_key = '_menu_item_object_id' 
      AND meta_value = %s
    ", 
    $post_id
  );
  $menu_id = $wpdb->get_var($query);
  return $menu_id;
}

function is_ajax_request() {
  return (!empty($_SERVER['HTTP_X_REQUESTED_WITH']) &&   
          strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest');
}

// partial template, right on the top:
<?php if (!is_ajax_request()): ?>
  <script type="text/javascript"> 
    window.location = "http://www.thaiorchid.be/#menu-item-<?php echo get_menu_id_for_post($post->ID) ?>";
  </script>
<?php endif; ?> 
```

这将根据当前帖子或页面的 ID 确定正确的菜单 ID，然后如果当前页面未通过 AJAX 加载，则使用 Javascript 重定向。

同样，我现在根本无法对此进行测试，但也许它可以帮助您继续。

# mysql - 如何使用 MySQL 复制表并添加字段？

> ID：10755104
> 
> 赞同：1
> 
> 时间：2012-05-25T13:15:36.433
> 
> 标签：mysql, sql, copy, insert-select

我想将表**A**复制到表**B**中，`INSERT ... SELECT`而不在 MySQL 中声明所有字段。

但问题是我的表 B 在开头有一个自动增量字段，称为`id`：

**表_A**

```
 name    age      etc
-------|--------|--------|
 abc   | 28     | ...    | 
```

**表_B**

```
 id      name    age      etc
-------|-------|--------|--------| 
```

我试图做类似的事情：

```
INSERT INTO table_B SELECT auto, * FROM table_A 
```

但它没有用。什么是最好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:20:23.440

明确指定列名：

```
INSERT INTO table_B (name,age,etc) SELECT * FROM table_A 
```

甚至

```
INSERT INTO table_B (name,age,etc) SELECT name,age,etc FROM table_A 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:24:07.477

从 Table_A 插入记录时，您无需担心在 Table_B 中为 id 列生成值。

因为`Auto_Incerement`列就像具有默认值的列。不同之处仅在于默认值从该列中最后插入的值增加了某个指定的间隔。

# php - move_uploaded_file 返回错误代码 0

> ID：10755105
> 
> 赞同：0
> 
> 时间：2012-05-25T13:15:37.090
> 
> 标签：php

请参阅本文末尾的代码片段...

尝试使用`move_uploaded_file`将 tmp 文件移动到另一个目录时，我始终返回错误代码 0。我已经确认该目录存在并且权限设置为 775。我还与服务器管理员核实过，他说他在错误日志中没有看到任何可以解释我遇到的问题的错误。

使用时如何绕过错误代码 0 `move_uploaded_file`？

```
$audio_dir  = "/mbc/data/audio/";

if (isset($_POST['upload_audio'])) {

    $title      = mysql_real_escape_string($_POST['audio_title']);
    $category   = mysql_real_escape_string($_POST['audio_category']);
    $audio_name = basename($_FILES['audio_file']['name']);
    $uploadfile = $audio_dir.$audio_name;

    $query = mysql_query("SELECT COUNT(*) FROM media where path = '" . $audio_name . "'");
    $result = mysql_result($query, 0, 0);

    if (($title == '') || ($title == NULL) ||
        ($category == '') || ($category == NULL) ||
        ($audio_name == '') || ($audio_name == NULL)) {
        echo "<span class='error'>Title, Category and Audio file are required fields</span>";                            
    } else if ($result > 0) {
    echo "<span class='error'>Media $audio_name already exists - please upload with a different name</span>";                               
    } else if (ctype_alpha($category) === false) {
        echo "<span class='error'>Category can only have letters (no spaces, commas, numbers, etc...)</span>";              
    } else if (ctype_alnum(substr($audio_name, 0, strpos($audio_name, '.'))) === false) {
    echo "<span class='error'>Bad filename - $audio_name - can only contain letters and numbers (i.e. 'HowGreatThouArt.mp3')</span>";
    } else {
        if (move_uploaded_file($_FILES['audio_file']['tmp_name'], $uploadfile)) {
            $queryInsertAudio = "insert into media (title, path, category ) values ('{$title}','{$audio_name}','{$category}')";
            $result = mysql_query($queryInsertAudio);
            if ($result) {
                echo "<span class='success'>AUDIO $audio_name UPLOADED SUCCESSFULLY</span>";
            } else {
                echo "<span class='error'>FAILED TO INSERT RECORD FOR $audio_name - PLEASE CONTACT ADMINISTRATOR</span>";
            }
        } else {
            echo "<span class='error'>FAILED TO UPLOAD AUDIO $audio_name - PLEASE CONTACT ADMINISTRATOR<br />" . 
                 "ERROR CODE = " . $_FILES['audio_file']['error'] . "<br />" . 
                 "Temp filename=" . $_FILES['audio_file']['tmp_name'] . "<br />" .
                 "Uploadfile=" . $uploadfile . "<br />" .
                 print_r($_FILES) . 
                "</span>";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:43:58.003

哎呀...这是我的`$audio_dir`文件路径关闭...修复了它，现在我可以上传没有问题...

# jquery - 我想在一个 ajax 请求上发送两个参数

> ID：10755106
> 
> 赞同：2
> 
> 时间：2012-05-25T13:15:46.093
> 
> 标签：jquery, ajax

我有这段代码，我想发送两个值，如您所见，我有数据中的 ledit 我想用 ledit 发送 ledit2

```
$('.ledit').click(function() {
    var ledit = $(this).attr("id");
    var ledit2 = $('.valu').val();

    $.ajax({
        url: 'edit.php',
        data: 'ledit=' + ledit,
        // here i want send ledit2
        success: function(data) {
            $('.edito').html('dddddddddd');
        }
    });
});​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T13:17:49.353

您可以将`data`属性设置为对象：

```
$('.ledit').click(function() {
    var ledit = $(this).attr("id");
    var ledit2 = $('.valu').val();

    $.ajax({
        url: 'edit.php',
        data: {
            ledit : ledit,
            ledit2 : ledit2
        },
        success: function(data) {
            $('.edito').html('dddddddddd');
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:18:11.550

为什么要打两个电话？只需执行一个传递两个值的 ajax 调用

```
$.ajax({
        url: 'edit.php',
        data: 'ledit=' + ledit + "&ledit2=" + ledit2,
        ...
}); 
```

无论如何，除非您对值进行编码（例如使用`encodeURIComponent`），否则最好使用对象，正如@VisioN 所建议的那样

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T13:18:34.390

您可以对参数使用对象文字`data`：

```
data: { ledit: ledit, ledit2: ledit2 } 
```

或者您可以只使用`&`URL 中的运算符：

```
data: 'ledit=' + ledit + '&ledit2=' + ledit2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T13:26:03.833

你试过这样做吗？

```
 $.ajax({
        url: 'edit.php',
        data: '{ "ledit":' + ledit + ', "ledit2":' + ledit2 + '}',
        success: function(data) {
            $('.edito').html('dddddddddd');
        }
    }); 
```

或者更好：

```
 $.ajax({
        url: 'edit.php',
        data: JSON.stringify({ ledit: ledit, ledit2: ledit2}),
        success: function(data) {
            $('.edito').html('dddddddddd');
        }
    }); 
```

# php - 如何显示来自此 XML 提要的图像？

> ID：10755117
> 
> 赞同：-2
> 
> 时间：2012-05-25T13:16:46.343
> 
> 标签：php, xml, curl, feed

希望有人可以帮助解决这个问题。我正在使用以下脚本在我的网站上显示来自提要的数据。由于某种原因，我无法显示提要中的图像。我注意到图像地址中有一个空格，我想知道这是否是问题所在。但是我已经更改了提要并用“％20”替换了空格，希望它们随后会显示出来。仍然没有运气。有任何想法吗？

```
 <?php

            # INSTANTIATE CURL.
            $curl = curl_init();

            # CURL SETTINGS.
            curl_setopt($curl, CURLOPT_URL, "http://www.dpm.uk.com/feeds/rss/product-syndication.ashx?pgid=6&feed=opt1");
            curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
            curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 0);

            # GRAB THE XML FILE.
            $xml = curl_exec($curl);

            curl_close($curl);

            # SET UP XML OBJECT.
            $xmlObj = simplexml_load_string( $xml );

            $tempCounter = 0;

            foreach ( $xmlObj->item as $item )
            {                    
                # DISPLAY ONLY 10 ITEMS.
                if ( $tempCounter < 20 )
                {
                   echo "
                   <div class=\"feed-item\">
                   Title: {$item -> title}
                   Year: {$item -> Year}
                   Colours: {$item -> Colours}
                   Size: {$item -> Size}
                   Available: {$item -> Available}
                   Image: {$item -> Images}
                <br>

                   </div>
                   ";

                }

                $tempCounter += 1;
            }

            ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:34:08.743

```
<?php
error_reporting(E_ALL);

$data = file_get_contents("http://www.dpm.uk.com/feeds/rss/product-syndication.ashx?pgid=6&feed=opt1");
$xml = new SimpleXMLElement($data);
$counter = 0;
foreach ($xml->item as $item) {

    if ($counter < 20){
             echo "<div class=\"feed-item\">
                Title: " . $item->title . ", " . "
                Year:  " . $item->Year . "
        <br></div>";
    }
}
?> 
```

测试它有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:41:10.277

```
$img = $item->Images->img[0]->attributes();

echo "
  <div class=\"feed-item\">
    Title: {$item->title}
    Year: {$item->Year}
    Colours: {$item->Colours}
    Size: {$item->Size}
    Available: {$item->Available}
    Image: {$img['src']}
    <br>
  </div>
"; 
```

**更新：**

要显示图像：

```
echo "Image: <img src=\"{$img['src']}\" width=\"{$img['width']}\" height=\"{$img['height']}\" />"; 
```

显示所有图像：

```
foreach ($item->Images as $img) {
  $img = $img->attributes();
  echo "Image: <img src=\"{$img['src']}\" width=\"{$img['width']}\" height=\"{$img['height']}\" />";
} 
```

# php - 如何在现有的基于 PHP 和 Mysql 的分页上添加 Ajax

> ID：10755118
> 
> 赞同：2
> 
> 时间：2012-05-25T13:16:55.547
> 
> 标签：php, jquery, mysql, html, ajax

嗨，我是一名新程序员，我有一个**基于 PHP 和 Mysql 的**分页，我想向它**添加 Ajax**功能。我已经阅读了许多教程，但我找不到任何关于将 ajax 添加到现有分页上的教程，它们都讲述了制作基于 Ajax 的分页。

即使关闭了javascript，我也希望用户能够分页。所以我想在我的代码中添加一些 Ajax，这样我就可以使用 Ajax 和 PHP 进行分页。

我可以使用**jquery .load()**方法进行分页。

请查看我的代码并建议我如何获取 ajax 的页面 url 以进行分页我想这样的事情必须工作。我不知道怎么做，请帮忙。或者告诉我一些我可以学习的教程。

**jQuery代码**

```
 $(document).ready(function(){

    $('#pagination').click(function(){
    $('pageurl').load('is-test2.php #PaginationDiv');});        
}); 
```

**基于 PHP 和 MySQL 的分页**

```
<?php
    require_once('_ls-global/php/connection.php'); 
$db = mysql_select_db($database,$connection) or trigger_error("SQL", E_USER_ERROR);
$sql1 = "SELECT COUNT(*) FROM $table";
$result1 = mysql_query($sql1, $connection) or trigger_error("SQL", E_USER_ERROR);
$row = mysql_fetch_row($result1);
$numrows = $row[0];
$rowsperpage = 2;
$totalpages = ceil($numrows / $rowsperpage);
if (isset($_GET['page']) && is_numeric($_GET['page'])) {
   $currentpage = (int) $_GET['page'];
} else {
   $currentpage = 1;
}
if ($currentpage > $totalpages) {
   $currentpage = $totalpages;
}
if ($currentpage < 1) {
   $currentpage = 1;
}
$offset = ($currentpage - 1) * $rowsperpage;
$sql2 = "SELECT * FROM internet_security ORDER BY id DESC LIMIT $offset, $rowsperpage";
$result2 = mysql_query($sql2, $connection) or trigger_error("SQL", E_USER_ERROR);
$list = mysql_fetch_assoc($result2);
$startrow = ($currentpage-1) * $rowsperpage; 
```

**html中的代码**

```
h3>Results <?php echo ($startrow+1) ?> - <?php echo min($startrow + $rowsperpage, $row) ?> of <?php echo ($totalpages *$rowsperpage) ?></h3>
<ul><?php 
if ($currentpage!=$totalpages) {
echo " <li><a href='{$_SERVER['PHP_SELF']}?page=$totalpages'>$totalpages</a></li> ";
$nextpage = $currentpage + 1;
echo " <li><a href='{$_SERVER['PHP_SELF']}?page=$nextpage'>Next&raquo;&raquo;</a></li> ";
}?></ul>

<ul><?php    
if($currentpage<$totalpages){
for ($x = ($currentpage - 3); $x < (($currentpage + 3) + 1); $x++) {
if (($x > 0) && ($x <= $totalpages)) {
if ($x == $currentpage) {
echo " <li id='pcurrent'><a href='{$_SERVER['PHP_SELF']}?page=$x'>$x</a></li>";
} else {
echo " <li><a href='{$_SERVER['PHP_SELF']}?page=$x'>$x</a></li> ";
}}}  
}
}
?> </ul>

<ul><?php
if ($currentpage > 1){
$prevpage = $currentpage - 1;
echo " <li><a href='{$_SERVER['PHP_SELF']}?page=$prevpage'>&laquo;&laquo;Prev</a></li> ";
echo "<li><a href='{$_SERVER['PHP_SELF']}?page=1'>1</a></li> ";
}?></ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:42:08.390

由于您使用 GET 方法将页面变量放入 PHP 脚本，因此您可以像这样传递变量：

```
$(document).ready(function(){
    $('#pagination ul li a').click(function(){
        e.preventDefault();
        $('#divtoreplace').load($(this).attr("href"));            
    });        
}); 
```

# c# - .NET 中的“SelectFolderDialog”

> ID：10755119
> 
> 赞同：5
> 
> 时间：2012-05-25T13:16:58.010
> 
> 标签：c#, dialog, directory

.NET中没有`SelectFolderDialog`，但它本身存在于 .NET 中`Visual Studio 2010`。

我想知道是否有任何像这种形式的外部 .net 组件。

这是 VS2010 对话框：

![选择文件夹对话框](../Images/e4196a6a2d8b0262961d6a9b458dc356.png)

**请注意，我不想使用[`FolderBrowserDialog`](http://msdn.microsoft.com/en-us/library/system.windows.forms.folderbrowserdialog.aspx)并且我需要获取中描述的特定 UI`SelectFolderDialog`**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:21:34.450

这是一个提供对文件夹浏览器对话框等的访问的库。[http://www.ookii.org/software/dialogs/](http://www.ookii.org/software/dialogs/)

它是几个 Win32 对话框的包装器，它提供了 Windows 窗体和 WPF 变体，并且它提供了您已显示的“Vista 样式”SelectFolderDialog。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:18:41.053

要访问豪华的新[Vista 文件夹选择对话框](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776913.aspx)，我相信您需要：

1.  使用第三方组件，或
2.  使用本机`IFileDialog`组件。

[使用Windows API CodePack](http://archive.msdn.microsoft.com/WindowsAPICodePack)选项 2 很简单。您需要包含该[`FOS_PICKFOLDERS`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761832.aspx)选项。CodePack 附带了很多示例。我把它推荐给你。

# python - 使用 python urllib 下载受保护的文件

> ID：10755121
> 
> 赞同：0
> 
> 时间：2012-05-25T13:17:08.540
> 
> 标签：python, download, urllib

我正在尝试下载位于此处[http://elwatan.com/pdf/telecharger.php?dir=JOURNAL&file=20120524.pdf](http://elwatan.com/pdf/telecharger.php?dir=JOURNAL&file=20120524.pdf)的 PDF 文件，但是，此 pdf 文件需要在下载之前登录。我能够登录，但服务器将我重定向到主页[http://elwatan.com](http://elwatan.com)，当我再次尝试获取 pdf 的 url 时，我无法下载它，因为我似乎没有登录！我认为我需要使用 cookie，对吗？

如果是的话，请你解释一下如何，因为我以前从未使用过它们。?

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:24:31.487

[mechanize](http://wwwsearch.sourceforge.net/mechanize/)库对于这种情况非常有用。它模拟浏览器，包括填写表单（如登录表单）和保持状态（如 cookie）。有了它，您可以登录该站点，然后导航到 pdf 文件。您将使用类似于以下代码的内容：

```
br = mechanize.Browser()
br.open(login_url)
#code to log in with br
data = br.open(pdf_url).get_data() 
```

然后，您必须将数据解析为 pdf 文件，然后您可以使用它做任何您需要的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:40:45.537

使用该 Web 应用程序时，会为您生成一个“会话”。会话详细信息存储在您的客户端中的 cookie 中。您的客户端会随每个 HTTP 请求发送 cookie 内容。通过这样做，Web 应用程序知道您的 HTTP 请求对应于同一个会话。最初，您只是该会话中的未知用户。登录后，Web 应用程序知道该会话中的请求来自授权用户。

你有两个选择：

*   通过浏览器登录，制作 cookie 并使用 Python 在后续请求中伪造浏览器
*   用 Python 做所有事情（从初始请求、登录、文档检索开始）

两者都可能是大量工作（尤其是如果您不熟悉这些东西），因为您必须根据 Web 应用程序的具体情况调整代码。像 mechanize 这样的库（正如其他人已经提到的）可以节省一些工作。

# jconsole - JConsole 远程连接 james 服务器

> ID：10755123
> 
> 赞同：0
> 
> 时间：2012-05-25T13:17:14.810
> 
> 标签：jconsole

我正在尝试让 jconsole 远程连接到 james jmx。我在远程配置中设置了这些参数：

```
-Dcom.sun.management.jmxremote.ssl=false
-Dcom.sun.management.jmxremote.authenticate=false
-Djava.rmi.server.hostname=<host ip>
-Dcom.sun.management.jmxremote.port=<port>
-Dcom.sun.management.jmxremote 
```

我什至在本地为我的 JAVA_OPTS 设置了参数。无论如何，它无法连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T09:12:12.047

这个错误非常令人沮丧。在定义 jmx 属性的地方 ( `jmx.properties file`)，有两个参数：

```
jmx.address=${jmx.address}
jmx.port=${jmx.port} 
```

该值`${jmx.address}`是主机名，但必须是 IP 地址，否则无法连接。我花了一些时间才意识到，我希望这会有所帮助。

# java - 向 Dropbox 发送请求

> ID：10755127
> 
> 赞同：0
> 
> 时间：2012-05-25T13:17:36.853
> 
> 标签：java, tomcat, servlets, dropbox

我在 tomacat 中执行我的 servlet 时遇到了这个错误......

代码...用于发送数据...

```
String result= URLEncoder.encode(oauth_token , "UTF-8")+"&";     

        PostMethod get = new PostMethod("https://api.dropbox.com/1/oauth/request_token");
        get.addParameter("oauth_consumer_key", "fm5qq8panuw0rnm" );
        get.addParameter("oauth_nonce",String.valueOf(nonce));
        get.addParameter("oauth_signature_method", "PLAINTEXT");
        get.addParameter("oauth_signature", result);
        get.addParameter("oauth_timestamp",String.valueOf(timestamp.getTime()/1000));
        get.addParameter("oauth_token", "z3d00yk6qwh2eui");

        int status= client.executeMethod(get); 
```

///////////////////////////

HTTP 状态 500 -

```
type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling this request.

exception

javax.servlet.ServletException: Error instantiating servlet class Ser
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:395)
    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:250)
    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
    java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    java.lang.Thread.run(Thread.java:722)
root cause

java.lang.NoClassDefFoundError: org/apache/commons/httpclient/HttpMethod
    java.lang.Class.getDeclaredConstructors0(Native Method)
    java.lang.Class.privateGetDeclaredConstructors(Class.java:2404)
    java.lang.Class.getConstructor0(Class.java:2714)
    java.lang.Class.newInstance0(Class.java:343)
    java.lang.Class.newInstance(Class.java:325)
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:395)
    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:250)
    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
    java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    java.lang.Thread.run(Thread.java:722)
root cause

java.lang.ClassNotFoundException: org.apache.commons.httpclient.HttpMethod
    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1676)
    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1521)
    java.lang.Class.getDeclaredConstructors0(Native Method)
    java.lang.Class.privateGetDeclaredConstructors(Class.java:2404)
    java.lang.Class.getConstructor0(Class.java:2714)
    java.lang.Class.newInstance0(Class.java:343)
    java.lang.Class.newInstance(Class.java:325)
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:395)
    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:250)
    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
    java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    java.lang.Thread.run(Thread.java:722)
note The full stack trace of the root cause is available in the Apache Tomcat/7.0.12 logs. 
```

AI 正在尝试将发布请求发送到 Dropbox 以获取 request_token 但在我的 servlet 执行期间我收到此类错误.. 通过控制台 main() 函数执行相同的代码时...我得到了正确的结果但同样不是来自小服务程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T15:27:38.813

您正在请求令牌 PostMethod("https://api.dropbox.com/1/oauth/request_token");

还要传递一个令牌作为参数？

get.addParameter("oauth_token", "z3d00yk6qwh2eui");

# devexpress - Devexpress LookupEdit 下拉列表而不是显示单个元素

> ID：10755133
> 
> 赞同：1
> 
> 时间：2012-05-25T13:17:55.250
> 
> 标签：devexpress, repositorylookupedit

令我惊讶的是，Devexpress LookupEdit 一直在下拉（显示列表而不是只显示默认的编辑值 [一个元素]）。什么财产在惹我？

这是我设置属性的方式：

```
lkTest.Properties.DataSource=MyDataSource;
        lkTest.Properties.ValueMember = "TypeID" ;
        lkTest.Properties.DisplayMember = "pType";
        lkTest.EditValue=1; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:37:08.663

**你没有错过任何东西**。

这是 LookupEdit 的默认行为。如果您只想显示仅显示成员的列表，那么您必须在 lookupEdit 中显示该特定列。

为此，请在查找编辑中创建自定义列，然后它将仅显示您创建的列，如 gridview。

> *首先，你什么时候用`LookupEdit`？？？*

当您想显示特定项目的详细信息时，您可以使用它。如果您只想使用组合框之类的行为，请使用`ComboBoxEdit control`.

检查这些代码片段，当我分配 dataSource 和 EditValue 时，默认情况下它不会向我显示下拉菜单。

*将其添加到 gridview 时。*

```
lookupEdit = new RepositoryItemLookUpEdit();
lookupEdit.DataSource = dtResult;
lookupEdit.ValueMember = "Marks";
lookupEdit.DisplayMember = "Subject";        
gridView1.Columns[0].ColumnEdit = lookupEdit; 
```

*LookupEdit 托管在表单上：*

```
lookUpEdit1.Properties.DataSource = dtResultType;
lookUpEdit1.Properties.ValueMember = "ID";
lookUpEdit1.Properties.DisplayMember = "ResultSubject";
lookUpEdit1.EditValue = 1; 
```

参考这些链接和[搜索结果](http://search.devexpress.com/?q=lookupedit%20shows%20dropdown%20on%20databind&p=T4%7CP1%7C0)以了解您做错了什么。
最好我喜欢你看看这个 -[数据绑定后查找编辑编辑值](http://www.devexpress.com/Support/Center/p/Q259760.aspx)

[更改数据源中的位置时显示的 LookupEdit 下拉项](http://community.devexpress.com/forums/t/95240.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T12:32:31.037

如果您只需要 LookupEdit 控件中的一列，请执行以下操作：

```
lkTest.Properties.DataSource=MyDataSource;
lkTest.Properties.ValueMember = "TypeID" ;
lkTest.Properties.DisplayMember = "pType";
lkTest.EditValue=1;  
LookUpColumnInfoCollection colType = lkTest.Columns;
if (colType.VisibleCount == 0)
   colType.Add(new LookUpColumnInfo("TypeID", "Type"));
lkTest.BestFitMode = BestFitMode.BestFitResizePopup; 
```

确保您的数据源*MyDataSource*的 TypeID 等于 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-12T16:44:14.763

我遇到了同样的问题，并在手动设置 EditValue 后调用“ClosePopup()”方法解决了这个问题。

# eclipse - Scala 中 Casbah 的 JAR 不正确？

> ID：10755134
> 
> 赞同：0
> 
> 时间：2012-05-25T13:17:56.543
> 
> 标签：eclipse, scala, mongodb, jar, casbah

```
import com.mongodb.casbah.Imports._
val newObj = MongoDBObject( "abc" -> 1, "def" -> 2 ) 
```

这给了我以下错误：

“缺少 ValidDateOrNumericTypeHolder 所需的类文件。包 org 的参考值 joda 指的是不存在的符号。”

我四处搜索以解决此错误，但没有成功。有人可以指导我吗？

我在带有 Scala 2.9.0 插件的 Eclipse Java EE 中运行它。我的 Eclipse 项目中有以下引用的库。

casbah-commons_2.9.0-1-2.1.5-1.jar

casbah-gridfs_2.9.0-1-2.1.5-1.jar

casbah-core_2.9.0-1-2.1.5-1.jar

casbah-query_2.9.0-1-2.1.5-1.jar

casbah-dynamic_2.9.0-1-2.1.5.0.jar

mongo-1.0.jar

mongo-java-driver-2.7.1.jar

mongo-driver_2.9.0-1-0.2.0.jar

后续问题：

在 Antoine 的指导下解决了上述问题后，我继续尝试以下方法：

```
newObj( "abc" ) 
```

并得到这个错误：

java.lang.IncompatibleClassChangeError: com.mongodb.BasicDBObject 类没有实现请求的接口 org.bson.BSONObject

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:05:12.183

您可能需要将[JodaTime](http://joda-time.sourceforge.net/) jar 添加到您的类路径

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:27:36.610

谢谢，安托万。你的指针确实很有帮助。

我必须添加以下 JAR 才能使其正常工作：

slf4j-api-1.6.4.jar

joda-time-2.1.jar

slf4j-simple-1.6.4.jar

scalaj-collection_2.9.1-1.2.jar

# php - 如何在 php 中显示存储在变量中的 html 代码

> ID：10755141
> 
> 赞同：0
> 
> 时间：2012-05-25T13:18:18.197
> 
> 标签：php, html, echo

在我的`index.html`页面中，我从用户那里获取了一个嵌入链接，例如：

```
<iframe width='560' height='315' src='http://www.youtube.com/embed/GasAmUfvXJs'     frameborder='0' allowfullscreen></iframe> 
```

这段代码将被传递给我的 PHP 脚本，该脚本会将其存储在一个变量中并对其执行一些验证。验证成功后，我尝试在 PHP 脚本中回显变量。但它不能正确显示。

这是PHP脚本：

```
<?php

if(isset($_POST['embed']) && isset($_POST['date'])){

$embed = $_POST['embed'];
$date = $_POST['date'];

if(!empty($embed) && !empty($date)){

    echo "OK - VIDEO";
    $final = $embed;
    echo "$final";

}else{
    $final = "Try again - not empty";
    echo "$final";
}

}else{

echo "try again - not set";

} 

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:40:15.563

如果您回显 html，它将由浏览器呈现，如果您想回显 html 的源代码，那么您可以使用：[htmlentites()](http://php.net/manual/en/function.htmlentities.php)

```
echo htmlentites($final); 
```

如果这不是你的后，请解释：`But it does not display it correctly.`

**另外：**您不应该输出**任何**用户输入的 html，或者您的脚本是按设计对 XSS 开放的，验证不是`!empty($embed)`您应该只从代码中取出视频的 youtube id 并从中构建您自己的嵌入代码。

继承人如何做到这一点：

```
<?php 
if($_SERVER['REQUEST_METHOD']=='POST'){
    if(!empty($_POST['embed']) && !empty($_POST['date'])){

        if(preg_match('#http://www.youtube.com/embed/([a-zA-Z0-9_-]+)\"#',$_POST['embed'],$match)==true){

            $embed = <<<EMBEDCODE
<iframe width="640" height="360"
        src="http://www.youtube.com/embed/{$match[1]}?feature=player_embedded"
        frameborder="0" allowfullscreen>
</iframe>
EMBEDCODE;

        }else{
            $embed = "Not a real youtube embedcode! Try Again";
        }

    }else{
        $embed = "Enter youtube embedcode.";
    }
}
?>

<h1>Youtube Yada</h1>
<form method="POST" action="">
  <p>Embedcode:<textarea rows="9" name="embed" cols="44"></textarea></p>
  <p>Date:<input type="text" name="date" value="<?php echo date("F j, Y, g:i a");?>" size="20"></p>
  <p><input type="submit" value="Submit" name="B1"></p>
</form>

<?php echo(isset($embed)?$embed:null);?> 
```

测试：

```
<iframe width="560" height="315" src="http://www.youtube.com/embed/GasAmUfvXJs" frameborder="0" allowfullscreen></iframe> 
```

# android - Android捏缩放。捏合时焦点/图像偏移

> ID：10755148
> 
> 赞同：2
> 
> 时间：2012-05-25T13:18:45.327
> 
> 标签：android, android-canvas, multi-touch

我一直在努力创建一个具有非常流畅的捏缩放的自定义视图。到目前为止，我已经完成了缩放和平移工作，但是当我在屏幕的不同区域捏缩放时，图像会移动到屏幕的相反位置。

例如，如果图像在左侧，而我在左侧捏缩放，则图像将向右移动。

我确定我在某个地方犯了一个简单的错误，但我一辈子都无法弄清楚问题出在哪里。在过去的几天里，我尝试了大量的更改，并花了几个小时搜索 SO，但无济于事。

这是我到目前为止的代码：

```
private class PinchView extends View {

    private ScaleGestureDetector mScaleDetector;
    private float mScaleFactor = 1.f;
    private static final int INVALID_POINTER_ID = -1;

    // The ‘active pointer’ is the one currently moving our object.
    private int mActivePointerId = INVALID_POINTER_ID;

    private Drawable mIcon;
    private float mPosX;
    private float mPosY;

    private float mLastTouchX;
    private float mLastTouchY;

    private float focusX;
    private float focusY;

    public PinchView(Context context) {
        super(context);
        mIcon = context.getResources().getDrawable(R.drawable.ic_launcher);
        mIcon.setBounds(0, 0, mIcon.getIntrinsicWidth(), mIcon.getIntrinsicHeight());

        // Create our ScaleGestureDetector
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        // Let the ScaleGestureDetector inspect all events.
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN: {
            final float x = ev.getX()/mScaleFactor;
            final float y = ev.getY()/mScaleFactor;

            mLastTouchX = x;
            mLastTouchY = y;
            mActivePointerId = ev.getPointerId(0);
            break;
        }

        case MotionEvent.ACTION_MOVE: {
            final int pointerIndex = ev.findPointerIndex(mActivePointerId);
            final float x = ev.getX(pointerIndex)/mScaleFactor;
            final float y = ev.getY(pointerIndex)/mScaleFactor;

            // Only move if the ScaleGestureDetector isn't processing a gesture.
            if (!mScaleDetector.isInProgress()) {
                final float dx = x - mLastTouchX;
                final float dy = y - mLastTouchY;

                mPosX += dx;
                mPosY += dy;

                invalidate();
            }

            mLastTouchX = x;
            mLastTouchY = y;

            break;
        }

        case MotionEvent.ACTION_UP: {
            mActivePointerId = INVALID_POINTER_ID;
            break;
        }

        case MotionEvent.ACTION_CANCEL: {
            mActivePointerId = INVALID_POINTER_ID;
            break;
        }

        case MotionEvent.ACTION_POINTER_UP: {
            final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) 
                    >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
            final int pointerId = ev.getPointerId(pointerIndex);
            if (pointerId == mActivePointerId) {
                // This was our active pointer going up. Choose a new
                // active pointer and adjust accordingly.
                final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                mLastTouchX = ev.getX(newPointerIndex)/mScaleFactor;
                mLastTouchY = ev.getY(newPointerIndex)/mScaleFactor;
                mActivePointerId = ev.getPointerId(newPointerIndex);
            }

            break;
        }
        }

        return true;
    }

    @Override
    public void onDraw(Canvas canvas) {
        super.onDraw(canvas);

        canvas.save();

     //   canvas.scale(mScaleFactor, mScaleFactor);
        canvas.scale(mScaleFactor, mScaleFactor, focusX, focusY);
        canvas.translate(mPosX, mPosY);
        mIcon.draw(canvas);
        canvas.restore();
    }

    private float lastFocusX = -1;
    private float lastFocusY = -1;

    private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {

        @Override
        public boolean onScaleBegin(ScaleGestureDetector detector) {

        //  float x = detector.getFocusX();
        //  float y = detector.getFocusY();

            lastFocusX = -1;
            lastFocusY = -1;

            return true;
        }

        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();

            focusX = detector.getFocusX();
            focusY = detector.getFocusY();

            if(lastFocusX == -1) lastFocusX = focusX;
            if(lastFocusY == -1) lastFocusY = focusY;

            mPosX += (focusX - lastFocusX);
            mPosY += (focusY - lastFocusY);

            // Don't let the object get too small or too large.
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 5.0f));

          lastFocusX = focusX;
          lastFocusY = focusY;

            invalidate();
            return true;
        }

    }
} 
```

# html - 我添加了一个字符编码（utf-8）响应标头，现在我的 .css 没有被链接

> ID：10755149
> 
> 赞同：0
> 
> 时间：2012-05-25T13:18:46.623
> 
> 标签：html, css

情况：我有一个相当大的网站（windows server 2003）我想标准化为只使用 UTF-8。现在它使用各种字符编码，当方块开始出现在特定页面上后，我们决定只使用一种字符编码（utf-8），包括它使用的数据库。这是为了使网站易于维护。将所有内容更改为 utf-8 后，如果出现新的方块，然后需要以任何方式修复（当然不更改字符编码），这不是问题。

我添加了一个 http 响应标头，它将字符编码设置为 utf-8。在我浏览器的网站选项中，我确实看到现在出现了 utf-8。

问题是 .css 文件似乎不再有效（使用标签，我可以当场指定 .css 并且它确实有效）。当我删除这些行时：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

.css 文件有效果，但字体看起来仍然与我更改响应标头之前不同。我也不想删除这些行。

设置为 utf-8 怎么可能阻止我的 .css 文件被链接使用？我尝试更改编辑器的 BOM 和字符编码选项，但我无法解决问题。我究竟做错了什么？也许我不应该添加该响应标头并以完全不同的方式标准化网站？

编辑：新发现：如果我在

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN 
```

行它确实有效！我真的很想知道这里发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:24:56.633

某些非 UTF-8 字符可能会破坏您的 HTML。您可能在其中有一个打破分隔符的引号，因为它是 MS-WORD (Windows 1251) 引号而不是`"`. 在没有看到您的实际 HTML 的情况下，我们只能猜测。

使用调试器（例如 Firebug）来检查您的 HTML，它会向您显示该元素的样式来自何处。您可能还想通过验证器运行它，看看它是否真的被破坏了。

# jquery - jQuery 仅在 iOS 4.2.1 上被忽略

> ID：10755150
> 
> 赞同：1
> 
> 时间：2012-05-25T13:18:51.473
> 
> 标签：jquery, ios, mobile-safari

iOS 4.2.1 与之前和更新版本的 iOS 在 JavaScript 方面有什么根本不同吗？

我正在测试一个站点，并且在我测试的每个浏览器和设备上，jQuery 工作正常，但在我的 iPod Touch 测试设备上的 iOS 4.2.1 中它被完全忽略了。

如果需要，我可以提供代码示例。我正在使用以下内容：

[https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js) https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min .js

非常感谢任何见解。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T11:42:27.117

我最终在这种特殊情况下找到了问题。我有很多代码要去掉，所以我设置了一个测试页面，除了我的 jquery 调用和最基本的 jquery 警报功能之外什么都没有。

事实证明这是 http 和 http* *s* * 之间的区别。一旦我删除了“s”，调试控制台中的参考错误就消失了。

我希望这对其他人有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-27T23:06:34.167

我刚才遇到了同样的问题：

我现在喜欢使用这种导入脚本的方式

src="//code.jquery.com/jquery.min.js"

注意 // 如果加载脚本的页面是 https 它将执行 https 否则 http

# mysql - Mysql：“slow_query_log”与“log_slow_queries”有什么区别

> ID：10755151
> 
> 赞同：12
> 
> 时间：2012-05-25T13:18:53.750
> 
> 标签：mysql, profiling, server-variables

如果没有任何区别，为什么要使用两个服务器参数来实现一种行为？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-25T13:23:31.673

`log_slow_queries`在 MySQL 5.1.29 中被`slow-query-log`. MySQL 5.1参考[手册](http://dev.mysql.com/doc/refman/5.1/en/server-options.html#option_mysqld_log-slow-queries)有更多细节。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-25T13:28:26.693

来自 mysql 文档：

> --log-slow-queries 选项已被弃用并在 MySQL 5.6 中被删除（连同 log_slow_queries 系统变量）。相反，使用 --slow_query_log 选项启用慢查询日志，使用 --slow_query_log_file=file_name 选项设置慢查询日志文件名。

见这里：[http ://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_log-slow-queries](http://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_log-slow-queries)

# javascript - div下拉菜单问题

> ID：10755153
> 
> 赞同：0
> 
> 时间：2012-05-25T13:19:15.527
> 
> 标签：javascript, jquery, css, drop-down-menu

我决定采用一种更复杂的方法来编写菜单。看来我喜欢折磨自己。

无论如何，我创建了一个 div 菜单：

```
<div class="menu-bar">
    <div class="menu-item"><span class="menu-text">HOME</span></div>
    <div class="menu-item"><span class="menu-text">ABOUT US</span>
        <div class="sub-menu-items">
            <div class="sub-menu-item">History</div>
            <div class="sub-menu-item">Mission, vision and values</div>
            <div class="sub-menu-item">B-BBEE</div>
            <div class="sub-menu-item">Team</div>
            <div class="sub-menu-item">Professional Affiliations</div>
        </div>
    </div>
    <div class="menu-item"><span class="menu-text">SECTORS</span></div>
    <div class="menu-item"><span class="menu-text">SERVICES</span></div>
    <div class="menu-item"><span class="menu-text">CSR</span></div>
    <div class="menu-item"><span class="menu-text">PROJECTS</span></div>
    <div class="menu-item"><span class="menu-text">SUSTAINABILITY</span></div>
    <div class="menu-item"><span class="menu-text">CONTACT US</span></div>
</div> 
```

我的问题来自子菜单`.sub-menu-items`。一旦鼠标移出“关于我们”块并进入子菜单，我不知道如何使其保持打开状态。

这是我拥有的当前 Javascript 代码：

```
$('.sub-menu-items').hide();
$('.menu-text').hover(function(e) {
// Show highlight
    $(this).toggleClass('menu-text-hover');
    $(this).parent().toggleClass('menu-item-hover');
    if($(this).html().indexOf('ABOUT',0) !== -1)
        $('.sub-menu-items').show('fast');
},function(e) {
// Hide highlight
    $(this).toggleClass('menu-text-hover');
    $(this).parent().toggleClass('menu-item-hover');
    if($(this).html().indexOf('ABOUT',0) !== -1)
        $('.sub-menu-items').hide('fast');
}); 
```

这是我的CSS：

```
.menu-bar           { position:absolute; top:159px; height:54px; width:1024px; background-color:#fafafa; z-index:2; }
.menu-item          { display:table-cell; vertical-align:middle; position:relative; left:79px; height:54px; text-align:center; width:105px; border-right:dotted thin #000; border-bottom:dotted thin #000; background-color:#fafafa; }
.menu-item-hover    { border-bottom:none; }
.menu-text          { display:table-cell; vertical-align:middle; height:52px; width:101px; position:relative; left:2px; top:1px; text-align:center; border-top-right-radius:0px; margin-left:2px; margin-top:2px; margin-right:2px; }
.menu-text-hover    { border-top-right-radius:20px; background-color:#445921; color:#fff; cursor:pointer; }

.sub-menu-items     { position:absolute; display:inline-block; top:55px; width:105px; background: rgba(255, 255, 255, 0.8); font-size:12px; z-index:100; }
.sub-menu-item      { background:url(../images/devider-horizontal.png) no-repeat center top; display:block; height:40px; }
.sub-menu-item:last { background-image:none; display:block; height:40px; } 
```

任何人都可以帮助我实现当鼠标仍然悬停在下拉菜单上时使下拉菜单保持可见的目标吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:27:07.290

你可以重建你的代码：

```
$('.sub-menu-items').hide();
$('.menu-item').hover(function(e) {
    var el = $(this).children(".menu-text");
    el.toggleClass('menu-text-hover');
    $(this).toggleClass('menu-item-hover');
    if (el.html().indexOf('ABOUT', 0) !== -1)
        $(this).find('.sub-menu-items').show('fast');
}, function(e) {
    var el = $(this).children(".menu-text");
    el.toggleClass('menu-text-hover');
    $(this).toggleClass('menu-item-hover');
    if (el.html().indexOf('ABOUT', 0) !== -1)
        $(this).find('.sub-menu-items').hide('fast');
});​ 
```

**演示：http:** [//jsfiddle.net/vnRV4/](http://jsfiddle.net/vnRV4/)

* * *

好问题在评论中提出了@epascarello。您应该更好地使用嵌套列表而不是 div 块。此外，最好`$('.sub-menu-items').hide()`用 CSS 样式替换，`.sub-menu-items { display: none; }`以防止页面加载时闪烁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:34:51.483

你可以使用 setTimeout 和一个标志检查。

功能之外：

```
var submenuhovered=false; 
```

关于隐藏功能：

```
setTimeout(function(){
    if(submenuhovered==false){
        $(this).siblings(".sub-menu-items").hide();
    }
},200); 
```

关于子菜单鼠标悬停功能

```
submenuhovered = true; 
```

关于子菜单鼠标移出功能

```
submenuhovered = false; 
```

或者您可以使用菜单元素的 .data() 集合而不是全局变量。

```
$("menu").data("submenuhovered","true"); 
```

# c - 如何捕捉特定的linux系统返回

> ID：10755157
> 
> 赞同：0
> 
> 时间：2012-05-25T13:19:31.910
> 
> 标签：c, linux, file, return

我最近开始使用linux，所以我对它知之甚少。至少我知道linux中的每一件事都是一个文件。

我想知道如何捕捉特定的 linux 系统返回，例如如果我选择 install ruby​​ (sudo apt-get -y install ruby​​)，我怎么知道它安装成功了？

```
char buffer[1024];
char *buf = malloc(4096);

char *pl;
FILE *fp;

if (strcmp(cmd, "ruby") == 0)
{
        fp = popen("sudo apt-get -y install ruby", "r");
}

if (fp == NULL)
{
        printf("Failed to load file\n");
        exit(0);
}

while ((pl = fgets(buffer, sizeof(buffer), fp)) != NULL)
{
        strcat(buf, buffer);
}

strcat(buf, "\n");

pclose(fp); 
```

然后我使用 popen 读取打开的文件，但它包含终端中显示的相同内容，我只想要一个“标志”，如 OK 或 FAIL。

对不起我糟糕的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:29:49.513

apt-get 的退出代码会告诉你它是否成功（0 表示成功）。pclose(fp) 将返回退出代码，因此您可以执行以下操作：

```
if (pclose(fp) == 0) {
  // success
} else {
  // failure
} 
```

不过，您可能会注意到，现在我们实际上并没有从管道中读取。没有任何理由拥有它。因此，就像 Joachim 建议的那样， system() 函数可能更适合您的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:30:51.980

您需要检查正在运行的程序的退出状态。见： http: [//linux.die.net/man/3/popen](http://linux.die.net/man/3/popen)

```
The pclose() function waits for the associated process to terminate and returns the
exit status of the command as returned by wait4(2). 
```

每个进程都提供一个退出状态（一个整数，从 0 到 255），指示程序如何/为什么结束。0 通常用于正常（成功）执行，这是您应该寻找的。

尝试查看 apt-get 的手册页或在谷歌上搜索 apt-get 的正确退出代码。

希望能帮助到你！

# objective-c - 在 NSMutableArray 中搜索 NSString

> ID：10755159
> 
> 赞同：3
> 
> 时间：2012-05-25T13:19:35.047
> 
> 标签：objective-c, ios, nsstring, nsmutablearray, nspredicate

这可能是许多现有问题的重复，其中之一是： [这个](https://stackoverflow.com/questions/110332/filtering-nsarray-into-a-new-nsarray-in-objective-c)

或到目前为止我搜索过的其他链接。

我正在开发一个应用程序，我在其中显示人员信息，例如他们的位置、姓名、图像、性别、电话号码等。

我通过 xmls 获取这些数据。从 Parsing 我输入我的 NSMutableArray 并在我的表视图上显示详细信息。

我想对这个数组中的人名应用搜索。

我如何从这些获得人名？

这是我正在使用的代码：

在表视图中显示详细信息：

```
 if (cell == nil) 
 {
   NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"CustomCellDetail" owner:self options:nil];

   id firstObject =[topLevelObjects objectAtIndex:0];

   if ( [ firstObject isKindOfClass:[UITableViewCell class]] )
    cell = (CustomCellDetail *)firstObject;

     ParsingItem *item=[self.arrayPeoples objectAtIndex:indexPath.section];

     cell.lblUserName.text=[item.mdictXMLTagsData valueForKey:@"UserName"];
     cell.lblStatus.text=[item.mdictXMLTagsData valueForKey:@"StatusMessage"];
     cell.lblAge.text=[item.mdictXMLTagsData valueForKey:@"Gender"]; 
```

并且为了获取结果，我发现只能从 nsmutable 数组中搜索字符串，所以我应用搜索如下：

```
 -(void)FetchSearcheRecordsFromArray
  {
      self.filteredArray = self.arrayPeoples;

      NSLog(@"string :%@",strSearchingText);

      NSPredicate *Predicate = [NSPredicate predicateWithFormat:@"SELF contains[c] %@",self.strSearchingText];

      NSLog(@"string :%@",Predicate);

      [self.filteredArray filterUsingPredicate:Predicate];

      NSLog(@"Array count is : %d",[self.filteredArray count]);

      if ([self.filteredArray count] <= 0 )
      {
           self.lblNoRecordsFound.hidden = NO;
      }
      else 
      {
           self.lblNoRecordsFound.hidden = YES;
      }

      [self.tblViewPeople reloadData];
  } 
```

我的应用程序在线崩溃：

```
[self.filteredArray filterUsingPredicate:Predicate]; 
```

据我所知，我的数组中不存在该字符串，并且有一个解析项。

我想仅对人的姓名进行搜索，但我不知道如何从数组中仅获取姓名。

我怎样才能做到这一点？？？

有什么办法吗？？

我需要这样做，但不知道怎么做！

请帮忙 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T10:58:04.100

最后我放弃了应用搜索的想法，并将字符串名称与搜索到的文本匹配，如果名称包含搜索到的文本，则将该数组索引添加到过滤后的数组中。

这是相同的代码：

```
 NSPredicate *Predicate = [NSPredicate predicateWithFormat:@"SELF contains[c] %@",self.strSearchingText];

   NSLog(@"string :%@",Predicate);

   NSLog(@"arrayPeoples count is : %d",[self.arrayPeoples count]);

   NSMutableArray *arrSearch = [[NSMutableArray alloc] init];

   for (int i = 0; i < [self.arrayPeoples count];i++ ) 
   {
       ParsingItem *item = [self.arrayPeoples objectAtIndex:i];

       NSString * strUserName = [item.mdictXMLTagsData valueForKey:@"UserName"];

       if ([strUserName rangeOfString: strSearchingText options: NSCaseInsensitiveSearch].location != NSNotFound)
       {
           NSLog (@"Yay! '%@' found in '%@'.", self.strSearchingText, strUserName);

           [arrSearch addObject:item];
       }   
   }

   self.filteredArray = arrSearch; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T06:41:14.610

根据您对 Ashley Mills 回答的评论，您的数组似乎不包含字符串。谓词运算符仅适用于`contains`字符串——它对 ParsingItems 没有任何意义，除非 ParsingItem 是一种字符串。

根据您在编辑中添加的代码所暗示的 ParsingItem 的结构（您的数组包含 ParsingItems 并且您要搜索的字符串是该 ParsingItem 的 mdictXMLTagsData 属性中的 UserName 属性），您的谓词应该是这样的：

```
[NSPredicate predicateWithFormat:@"mdictXMLTagsData.UserName contains[c] %@", self.strSearchingText] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T10:08:16.767

好的，所以你有一个`ParsingItem`s 数组。

这里没有人知道它们是什么。对我来说，这听起来像是你在你的头上，并要求我们编写你的应用程序，而不是先尝试太多。

花一些时间 - 阅读（并理解）Apple 关于`NSArray`,的文档`NSPredicate`。阅读有关用于解析 XML 的类的文档。逐步检查您的代码以了解它在做什么。`NSLog`如果有帮助，请添加一些s。也许编写一个除了解析 XML 之外什么都不做的测试应用程序。

然后，当您完成所有这些后，如果您仍然不明白，请回来寻求帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T13:30:20.000

如何使用该`enumerateObjectsUsingBlock:`方法：

```
self.lblNoRecordsFound.hidden = YES;
[self.filteredArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if ([obj rangeOfString: strSearchingText options: NSCaseInsensitiveSearch].location != NSNotFound) {
        self.lblNoRecordsFound.hidden = NO;
        *stop = YES;
    }
}]; 
```

这假设您的数组包含字符串（您的代码示例表明）。根据您在下面的评论，情况并非如此。

# android - Android上的数据库限制

> ID：10755162
> 
> 赞同：0
> 
> 时间：2012-05-25T13:19:49.773
> 
> 标签：android, database

我是 Android 数据库的新手，我刚刚学习数据库。我有一些问题。

1.应用程序可以访问的数据库的最大限制（大小）是多少。

2.如果我正在使用使用数据库的应用程序并将该应用程序安装在新设备上，是否也可以将数据库传输到新设备（例如，在应用程序本身有一个选项通过蓝色发送齿）。

3.是否可以使用sqlite数据库以外的数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:33:45.007

1.  数据库的最大大小取决于应用程序可用的内存空间。
2.  当您在新设备中安装应用程序时，它将创建新的数据库。可能有一些方法可以从另一台设备的数据库中接收记录并将它们保存在新设备中，这是您的实现，就像联系人一样（您可以将联系人从一台设备发送到另一台设备并保存）。
3.  是的，您也可以使用其他数据库，但 Android 仅对 SQLite 提供本机支持。 [Android 是否支持 SQLite 以外的任何其他数据库系统？](https://stackoverflow.com/questions/7143602/does-android-support-any-other-database-system-other-than-sqlite)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:32:03.840

1) android.database.sqlite.SQLiteDatabase 有以下方法来获取数据库的最大大小getMaximumSize()。

2）不可能。但是从您的应用程序中，您可以读取数据库并将其写入 SDCard，同样您可以从 SDCard 中读取数据库并替换现有的。

3) 检查此链接[Android 是否支持 SQLite 以外的任何其他数据库系统？](https://stackoverflow.com/questions/7143602/does-android-support-any-other-database-system-other-than-sqlite)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:34:51.527

1.  数据库中的数据存储大小没有这样的限制。您可以存储与设备上可用空间一样多的数据。

2.  在设备之间共享数据的最佳方式是使用数据备份将数据存储在云上，然后将数据从云检索到设备。请参阅[数据备份](http://developer.android.com/guide/topics/data/backup.html)。

3.  我认为android不支持任何其他数据库。SQLite 是必须的。尽管 Amazons Simple DB 等其他数据库确实提供了[android API](http://aws.amazon.com/sdkforandroid/)来将数据存储在云上。此外，您当然可以使用远程数据库来存储数据并使其同时可供其他设备访问。

# facebook - Facebook 相册创建无法正常工作

> ID：10755164
> 
> 赞同：0
> 
> 时间：2012-05-25T13:19:50.977
> 
> 标签：facebook, facebook-graph-api, upload, image

我正在尝试将图像上传到 Facebook 相册。我想将图片上传到名为“上帝”的相册中。如果没有名为 Sunil 的相册，我想创建 alum 并将图片上传到其中。如果已经存在名为 Sunil 的相册，则需要上传图片。

我已经尝试了以下代码。现在这些图片被上传到名为“Picslanda”的相册中。如何将专辑名称更改为我自己的。

```
require_once 'fbpic/library/facebook.php';

$app_id     = "xxxxx";
$app_secret = "xxxxxx";
$facebook   = new Facebook(array(
  'appId'  => $app_id,
  'secret' => $app_secret,
  'cookie' => true
));
$fbcheck = $facebook->getUser();

if (is_null($fbcheck) or !$fbcheck or $fbcheck==0)
{
  header("Location:{$facebook->getLoginUrl(array('scope' => 'user_status,publish_stream,user_photos,photo_upload'))}");
}
$facebook->setFileUploadSupport("http://" . $_SERVER['SERVER_NAME']);
// add a status message
$photo = $facebook->api('/me/photos', 'POST', 
  array(
    'source'  => '@' .realpath("images/poovarty.jpg") ,
    'message' => 'It is a programming test'
  )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T05:39:27.780

好的，这是一个示例代码，此代码检查名为“Wall Photos”的相册，并将在该相册上上传 image.jpg，但用户必须批准该图像作为通过应用程序上传

```
<?php
include 'header.php'; // header.php is the basic auth file for facebook 
$FILE_PATH = 'image.jpg';

$graph_url = "https://graph.facebook.com/me/albums?"
        . "access_token=" . $token . '&limit=100';

$data = json_decode(file_get_contents($graph_url));

foreach ($data->data as $d) {
    if ($d->name == 'Wall Photos')
        $ALBUM_ID = $d->id;
}

$facebook->setFileUploadSupport(true);
$args = array('message' => 'Photo Caption');
$args['image'] = '@' . realpath($FILE_PATH);

$data = $facebook->api('/'. $ALBUM_ID . '/photos', 'post', $args);
print_r($data);

?> 
```

# python - 正则表达式匹配随机字符串中的两位数字而不匹配 3 位或更多位数字

> ID：10755179
> 
> 赞同：1
> 
> 时间：2012-05-25T13:20:58.480
> 
> 标签：python, regex

从字母数字字符串中，我需要选择所有两位数字。

例如：`input = 'abc123#d$45^abrt&89*'`

`output = [45, 89]`

当我这样做时，它甚至可以从三位数字中选择两位数字。

数字可以是字符串中的任何位置——开始、中间或结束。此外，锚点可以是任何东西（当然，数字除外。）

请建议使用正则表达式还是使用其他字符串操作更好。

如果提供 python 代码将很有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T13:22:58.817

您需要[环视断言](http://www.regular-expressions.info/lookaround.html)：

```
>>> re.findall(r"(?<!\d)\d\d(?!\d)", "abc123#d$45^abrt&89*")
['45', '89'] 
```

# magento-1.4 - MultiStore 1.4.2 - 找不到 mage.php

> ID：10755182
> 
> 赞同：2
> 
> 时间：2012-05-25T13:21:24.407
> 
> 标签：magento-1.4

我在主域下的 httpdocs 中安装了我的主商店，它工作得很好。现在我创建了一个子域 partners.mydomain.com，该文件夹位于 httpdocs (httpdocs > partners)。我在管理商店中设置了第二个商店，并更改了该商店配置中的 URL。并将 .htaccess 文件和 index.php 文件复制到该文件夹​​中。

我已将此添加到我的 .htaccess 文件中

```
RewriteCond %{HTTP_HOST} ^(.*)http://partners.mydomain.com/
RewriteRule ^ - [E=MAGE_RUN_CODE:partners_en] 
```

并更改为 index.php 到

```
$mageFilename = '../app/Mage.php'; 
```

和

```
/* Store or website code */
$mageRunCode = 'partners_en';

/* Run store or run website */
$mageRunType = 'store';    

Mage::run($mageRunCode, $mageRunType); 
```

我在 1.6 上对此没有任何问题，但在 1.4.2 上收到错误消息“../app/mage.php 未找到”。

有人有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T13:51:30.713

```
$compilerConfig = $_SERVER['DOCUMENT_ROOT'] . '/magento/includes/config.php';

$mageFilename = $_SERVER['DOCUMENT_ROOT'] . '/magento/app/Mage.php'; 
```

用这个。它对我有用。

`DOCUMENT_ROOT`是一个服务器变量，表示您的代码所在的基本目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-05T22:54:22.920

尝试像这样添加`/`之前`..`：

```
$mageFilename = '/../app/Mage.php'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-15T06:19:25.560

用这个：

```
$compilerConfig = MAGENTO_ROOT . '/../includes/config.php';

$mageFilename = MAGENTO_ROOT . '/../app/Mage.php'; 
```

# xslt - XSLT 横向

> ID：10755185
> 
> 赞同：3
> 
> 时间：2012-05-25T13:21:38.120
> 
> 标签：xslt

我不确定如何解决这个问题，因为我对 XSLT 还很陌生。

我正在使用`xsl:for-each`循环`Types`，这很好，但是当我在那个循环（类型）中时，我将如何选择`Rate`使用 中的属性`TypeCode`？我是否认为 select 仅具有我当时所处的 for-each 的范围？也可以有许多袋子元素。

```
<Bags>
<Bag>
    <Types>
        <Type TypeCode="DBL">
            <Description Name="BLAH">
                <Text>BLAH</Text>
                <Image/>
            </Description>
        </Type>
        <Type TypeCode="JRS">
            <Description Name="BLAH">
                <Text>BLAH BLAH</Text>
                <Image/>
            </Description>
        </Type>
    </Types>
    <Plans>
        <Plan PlanCode="DISC" PlanName="Best rate">
            <Description Name="Best rate">
                <Text>Best available rate</Text>
            </Description>
        </Plan>
        <Plan PlanCode="NOCC" PlanName="No CC Required">
            <Description Name="No CC Required">
                <Text>Rate- No CC Required</Text>
            </Description>
        </Plan>
    </Plans>
    <Rates>
        <Rate TypeCode="DBL" PlanCode="DISC">
            <Rates>
                <Rate>
                    <Base AmountBeforeTax="0" CurrencyCode="EUR"/>
                </Rate>
            </Rates>
        </Rate>
        <Rate TypeCode="JRS" PlanCode="DISC">
            <Rates>
                <Rate>
                    <Base AmountBeforeTax="0" CurrencyCode="EUR"/>
                </Rate>
            </Rates>
        </Rate>
    </Rates>
</Bag>
    </Bags> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:33:01.530

> 我是否认为 select 仅具有我当时所处的 for-each 的范围？

**不是真的**，XPath 表达式可以是*relative*，在这种情况下它是从当前节点计算出来的，或者是*absolute*（以 开头`/`），在这种情况下它是从当前文档节点计算出来的。

Even with a relative XPath expression it is possible to select nodes outside of the subtree rooted by the current node -- simply by using reverse axes or the `following::` or `following-sibling::` axis.

**Use**:

```
ancestor::Bag/Rates/Rate[@TypeCode = current()/@TypeCode] 
```

This assumes that bags cannot be nested, otherwise a slightly different expression needs to be used:

```
ancestor::Bag[1]/Rates/Rate[@TypeCode = current()/@TypeCode] 
```

# windows - 在没有 Visual Studio 的情况下创建 Windows 8 Metro 应用程序 (HTML5)

> ID：10755186
> 
> 赞同：8
> 
> 时间：2012-05-25T13:21:41.487
> 
> 标签：windows, visual-studio, windows-8, windows-store-apps

我知道这可能是一个愚蠢的问题，但有没有办法在不使用 Visual Studio 的情况下构建 Windows 8 Metro 应用程序（HTML5）？据我了解，html5 Metro 应用程序由典型的 Web 文件（html/js/css/images）和清单文件组成。是否可以简单地压缩包含所需文件的目录并将其用作应用程序？还是我走远了？

最好的问候维克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-26T04:08:33.060

有关可用于打包和部署应用程序，然后从“开始”屏幕运行它的 PowerShell 脚本的信息，请访问[http://social.msdn.microsoft.com/Forums/en-US/toolsforwinapps/thread/5013262a -2a18-4ce6-99d1-03451d6c9619](http://social.msdn.microsoft.com/Forums/en-US/toolsforwinapps/thread/5013262a-2a18-4ce6-99d1-03451d6c9619)。问题是这不会让你在调试方面走得很远，这是像 VS 这样的工具的最大价值之一。（别忘了 Blend……一个用于样式和调试 CSS 的优秀工具）。

我听说人们确实被 VS（包括我自己）吓到了，但是 Win8 的 Express 版本使用起来很简单，而且你为 JS、WinJS 和 WinRT 获得的 IntelliSense 非常有用。我提到调试了吗？

老实说，当我们在 2010 年 12 月第一次能够编写 Metro 风格的应用程序时，我们只有 PowerShell 脚本来完成所有这些工作，而且实际上是在记事本中编写代码。这真是太痛苦了……不得不在浏览器中使用 F12 工具调试 HTML 和脚本，但是你不能使用 WinRT API。VS 逐渐变得越来越好，值得花一些时间学习以代替其他可用于 Win8 平台的 IDE。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-13T00:07:55.373

是的，这是可能的。[这里](http://peterdn.com/post/To-make-a-Metro-Appx-Package-from-scratch-you-must-first-e280a6.aspx)有一个很好的教程。它使用 C# 而不是 HTML5/JavaScript，但在大多数情况下是相同的。虽然它是为 Windows 8 的 CTP 版本编写的，所以发布预览版发生了一些变化，但它应该是一个很好的起点。

# javascript - 厚盒或类似的具有 100% 窗口高度的东西

> ID：10755189
> 
> 赞同：1
> 
> 时间：2012-05-25T13:21:46.793
> 
> 标签：javascript, iframe, height

我正在建立一个带有视频背景的网站，为了让该视频与正在浏览的访问者一起播放，该网站带有弹出窗口。我已经使用Thickbox 来执行此操作，但似乎thickbox 只允许我使用定义的高度，因为我希望它的高度为100%，有谁知道是否不是这种情况或我将如何实现类似的东西用另一个js脚本？

尝试过使用fancybox，但是效果很好，但是它似乎不喜欢使用另一个js脚本，即。视频背景？

请有人帮忙，因为这让我发疯......

这是网站，提前为标题道歉，它只是我有时使用的保留页面。

提前致谢。

[http://pissflapsspissflaps.tumblr.com/](http://pissflapspissflaps.tumblr.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:41:38.407

使用类似于此处找到的 javascript 函数：

[窗口大小.js](http://www.geekdaily.net/2007/07/04/javascript-cross-browser-window-size-and-centering/)

然后传递`window.size()['y']`给您的视频背景功能。然后您可能必须在每次调整窗口大小时再次设置该值。

# python - 解析邮件问题

> ID：10755190
> 
> 赞同：0
> 
> 时间：2012-05-25T13:21:50.460
> 
> 标签：python, parsing, email

我在解码我正在获取的电子邮件时遇到问题。

该脚本应登录到电子邮件帐户，获取未读消息，然后将它们存储在数据库中。我只想要电子邮件中的实际文本，而不想要 html 的东西。

我找到了很多例子，但似乎都没有。我已经尝试过[这个](https://stackoverflow.com/questions/787739/python-email-get-payload-decode-fails-when-hitting-equal-sign)和[这个](https://stackoverflow.com/questions/7331351/python-email-header-decoding-utf-8)以及我发现的更多。

我现在拥有的代码：

```
import imaplib, sys, email
import email.parser

myparser = email.parser.Parser()
conn = imaplib.IMAP4_SSL(host='mail.something.com')

retcode, capabilities = conn.login('username', 'XXXXX')

conn.select('Inbox', readonly = 1) # Select inbox as read-only
retcode, messages = conn.search(None, '(UNSEEN)')
if retcode == 'OK':
    for message in messages[0].split(' '):
        if message == '':
            continue
         ret, data = conn.fetch(message,'(RFC822)')
         msg = email.message_from_string(data[0][1])
#        rootMessage = myparser.parse(data[0][1])

#        print 'Message %s\n%s\n' % (message, rootMessage)
        print msg
        print '---------------------------------------------------------------' 

 conn.close() 
```

正如你所看到的，这里没有解码，因为我尝试过的一切都失败了。

我对 python 很陌生，所以如果有人能引导我走向正确的方向，我将不胜感激。一个 hack 就可以了，它不是一个关键任务脚本，但一个通用的解决方案是最好的。

-G

更新：

没有错误，问题是输出没有正确解码。

示例输入：

```
 This is a test message.

 Gísli 
```

输出：

```
 This is a test message.

 G=EDsli 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:42:03.100

这可以帮助：

```
import quopri

print quopri.decodestring(msg).decode('utf8') 
```

或这个：

```
import base64  

body = base64.b64decode(msg) 
```

# java - EntityManager..getResultList() 中的 ArrayIndexOutOfBoundsException

> ID：10755191
> 
> 赞同：3
> 
> 时间：2012-05-25T13:21:56.857
> 
> 标签：java, mysql, hibernate, jpa, persistence

我在java中遇到持久性问题。

这是抛出异常的方法

```
public List<EscaleCatalogueKaravel> obtenirListeEscalesCroisiereAvecIdCroisiereKaravel(Integer idCroisiereKaravel, Integer refLangue) {
         List<EscaleCatalogueKaravel> listeEscales = entityManager.createQuery("select p from EscaleCatalogueKaravel p " +
                    "where p.idCroisiereComplete=:idCroisiereComplete and p.refLangue=:refLangue")
                    .setParameter("idCroisiereComplete", idCroisiereKaravel)
                    .setParameter("refLangue", refLangue)
                    .getResultList();

         if (listeEscales == null || listeEscales.size() == 0) {
            return null;
         }

         return listeEscales;
    } 
```

问题是它实际上在工作，但有时它会在**getResultList()**中崩溃并抛出这个：

是因为方法生成的List的类型？无论如何，工作查询和崩溃查询之间没有太大区别。我的意思是他们都或多或少有相同数量的结果。

有什么建议么？

```
java.lang.ArrayIndexOutOfBoundsException: 1
    at com.mysql.jdbc.StringUtils.getInt(StringUtils.java:702)
    at com.mysql.jdbc.StringUtils.getInt(StringUtils.java:771)
    at com.mysql.jdbc.ByteArrayRow.getInt(ByteArrayRow.java:109)
    at com.mysql.jdbc.ResultSetImpl.getIntWithOverflowCheck(ResultSetImpl.java:7209)
    at com.mysql.jdbc.ResultSetImpl.getInt(ResultSetImpl.java:2699)
    at com.mysql.jdbc.ResultSetImpl.getInt(ResultSetImpl.java:2814)
    at org.hibernate.type.IntegerType.get(IntegerType.java:28)
    at org.hibernate.type.NullableType.nullSafeGet(NullableType.java:163)
    at org.hibernate.type.NullableType.nullSafeGet(NullableType.java:154)
    at org.hibernate.type.AbstractType.hydrate(AbstractType.java:81)
    at org.hibernate.persister.entity.AbstractEntityPersister.hydrate(AbstractEntityPersister.java:2101)
    at org.hibernate.loader.Loader.loadFromResultSet(Loader.java:1380)
    at org.hibernate.loader.Loader.instanceNotYetLoaded(Loader.java:1308)
    at org.hibernate.loader.Loader.getRow(Loader.java:1206)
    at org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:580)
    at org.hibernate.loader.Loader.doQuery(Loader.java:701)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)
    at org.hibernate.loader.Loader.doList(Loader.java:2213)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)
    at org.hibernate.loader.Loader.list(Loader.java:2099)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)
    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)
    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)
    at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:66)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:310)
    at $Proxy33.getResultList(Unknown Source)
    at com.karavel.connectivity.gateway.croisiere.common.repository.impl.CatalogueKaravelRepositoryImpl.obtenirIdCroisiereCompleteAvecInfoCroisiere(CatalogueKaravelRepositoryImpl.java:75)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:196)
    at $Proxy23.obtenirIdCroisiereCompleteAvecInfoCroisiere(Unknown Source)
    at com.karavel.connectivity.gateway.croisiere.controller.service.RechercherCroisiereController.getItineraireCroisiere(RechercherCroisiereController.java:378)
    at com.karavel.connectivity.gateway.croisiere.controller.service.RechercherCroisiereController.obtenirListeCroisiere(RechercherCroisiereController.java:283) 
```

编辑以增加精度：

如果我更深入地调试一下，我会看到抛出异常的方法

**类 org.springframework.orm.jpa.SharedEntityManagerCreator.java**

```
private static class DeferredQueryInvocationHandler implements InvocationHandler {

        private final Query target;

        private final EntityManager em;

        public DeferredQueryInvocationHandler(Query target, EntityManager em) {
            this.target = target;
            this.em = em;
        }

        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
            // Invocation on Query interface coming in...

            if (method.getName().equals("equals")) {
                // Only consider equal when proxies are identical.
                return (proxy == args[0]);
            }
            else if (method.getName().equals("hashCode")) {
                // Use hashCode of EntityManager proxy.
                return hashCode();
            }
            else if (method.getName().equals("unwrap")) {
                // Handle JPA 2.0 unwrap method - could be a proxy match.
                Class targetClass = (Class) args[0];
                if (targetClass == null || targetClass.isInstance(proxy)) {
                    return proxy;
                }
            }

            // Invoke method on actual Query object.
            try {
                Object retVal = method.invoke(this.target, args);
                return (retVal == this.target ? proxy : retVal);
            }
            catch (InvocationTargetException ex) {
                throw ex.getTargetException();
            }
            finally {
                if (method.getName().equals("getResultList") || method.getName().equals("getSingleResult") ||
                        method.getName().equals("executeUpdate")) {
                    EntityManagerFactoryUtils.closeEntityManager(this.em);
                }
            }
        }
    } 
```

准确地说：

```
Object retVal = method.invoke(this.target, args); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:26:56.447

我能想到的唯一一件事是您的列表不为空并且包含单个元素。在这种情况下，array.get(1) 将导致错误，因为 array.get(0) 是第一个元素。也许您可以记录数组大小并查看大小是否符合您的期望。

# javascript - 在表单中输入字母时，如何阻止键盘功能触发？

> ID：10755197
> 
> 赞同：0
> 
> 时间：2012-05-25T13:22:26.717
> 
> 标签：javascript, jquery

我有这个脚本，当按下键盘上的“N”和“P”键时，它会触发滚动到下一个/上一个。我的问题是，当用户以任何形式（例如搜索字段、登录字段等）正常键入这些字母时，如何阻止它触发。因为当我在表单中按 n 例如 John 时，它不会写 N 而不是它触发滚动功能。如何解决这种行为？

我的代码如下：

```
$(document).keydown(function (evt) {
    if (evt.keyCode == 78) {
        evt.preventDefault();
        scrollToNew();
    } else if (evt.keyCode == 80) {
        evt.preventDefault();
        scrollToLast();
    }
}); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T13:24:20.753

事件对象有一个`target`属性，它告诉您事件实际发生的位置（之后它会冒泡到您的文档级处理程序）。因此，您可以`evt.target`针对表单字段元素进行测试，如果匹配，请不要执行您的特殊逻辑。

可能最简单的方法是使用[`closest`](http://api.jquery.com/closest)，例如：

```
$(document).keydown(function (evt) {
    if (!$(evt.target).closest('input, select, textarea')[0]) {
        if (evt.keyCode == 78) {
            evt.preventDefault();
            scrollToNew();
        } else if (evt.keyCode == 80) {
            evt.preventDefault();
            scrollToLast();
        }
    }
}); 
```

在那里我问最接近的表单字段是从元素开始（因为`closest`从你给它的元素开始）并通过祖先进行处理。如果没有，则返回的 jQuery 对象将为空，并`[0]`返回`undefined`. 因此，既然`!undefined`是`true`，我们将在*不在*表单字段中时处理您的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:27:09.613

我想像

```
$('form').on('keydown', function(event) {event.stopPropagation();}); 
```

如果您不需要来自表单内部的键盘控件，应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:35:00.390

使用[object](https://developer.mozilla.org/en/DOM/event)`target`的属性，它指向源 DOM 节点。因此，您可以轻松使用[`Event`](https://developer.mozilla.org/en/DOM/event)

```
var nn = evt.target.nodeName.toLowerCase();
if (nn != "input" && nn != "textarea")
    // do your special handling 
```

但检查[`form`属性](http://dev.w3.org/html5/spec/association-of-controls-and-forms.html#dom-fae-form)的存在可能更容易，它指向元素所有者形式：

```
if (! "form" in evt.target)
    // do your special handling 
```

# c# - 如何获取回收站列表？

> ID：10755198
> 
> 赞同：1
> 
> 时间：2012-05-25T13:22:29.147
> 
> 标签：c#, .net, sharepoint, caml, recycle-bin

我在回收站中有一些已删除的文件和文件夹。当我恢复一个项目时，我需要根据我的特殊算法恢复一些其他项目。因此，我在事件接收器中使用以下代码片段来获取回收站项目：

```
var recycleBinItems = properties.Web.GetRecycleBinItems(new SPRecycleBinQuery()); 
```

然后我列举他们。但这是一个漫长的操作，所以我想获取一个回收站列表以使用 CAML 检索数据。我怎样才能得到回收站的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:26:02.337

不幸的是，没有可用于将 CAML 查询传递到回收站的 API 调用。正如您所注意到的，SPWeb 类上有一个[GetRecycleBinItems](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.getrecyclebinitems.aspx)方法，但根据 MSDN 上的文档，它仅用于控制排序顺序或限制返回项目。

SPWeb的[RecycleBin](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.recyclebin.aspx)属性基本上是相同的网关，尽管它默认返回所有项目。

将来可能对您有所帮助的是，知道 SPWeb 有两个回收站 - 一个在 Web 级别，另一个在网站集。您可以将 Web 级别的回收站配置为仅保留文件一周或一个月 - 在更一般的情况下，考虑到您的容量来限制您需要搜索的文件，这是有意义的。这些文件将从 Web 级别移动到网站集级别的回收站，因此您仍然可以在需要时恢复它们，并且它们也可以在那里保留一段自定义时间。

# java - 这是转义 SQL 查询参数的安全方法吗？

> ID：10755204
> 
> 赞同：0
> 
> 时间：2012-05-25T13:22:46.453
> 
> 标签：java, mysql, sql, oracle, security

在我的工作中，通过不安全地将参数连接到查询字符串中来形成 SQL 查询是一种传统。当然，这会导致 SQL 注入漏洞。这并不是一个大问题，因为发生这种情况的所有 Java 软件都运行在所有用户都被信任的封闭网络上。此外，查询是从具有数据库访问权限的客户端应用程序执行的，因此用户在技术上无论如何都可以执行恶意查询。

尽管如此，它计划在新版本的数据库层中支持准备好的语句。同时，我在现有数据库层（仅支持从 SQL 字符串执行查询，没有准备好的语句或参数转义选项）之上编写了一个小库，允许通过转义字符串参数来编写安全的参数化查询.

作为该库的一部分，我编写了以下方法来转义字符串文字。我转义了与 PHP 的 addlashes 函数相同的字符，但我尝试通过检测补充（32 位）字符来避免其多字节字符漏洞：

```
private String escapeString(String str)
{
    List<Character> toEscape = Arrays.asList('\'', '"', '\\', '\0');

    StringBuilder result = new StringBuilder();
    for(int i = 0; i < str.length(); ++i)
    {
        char c = str.charAt(i);

        if(i < str.length() - 1 && c >= '\uD800' && c <= '\uDBFF')
        {
            char next = str.charAt(i + 1);

            if(next >= '\uDC00' && next <= '\uDFFF')
            {
                // Two-char supplementary character. Escape neither.
                result.append(c);
                result.append(next);
                ++i;
                continue;
            }
        }

        if(toEscape.contains(c))
        {
            // Special character. Add escaping \.
            result.append('\\');
        }

        // Copy character itself.
        result.append(c);
    }

    return result.toString();
} 
```

我的问题是这种转义查询的方法是否足够安全（而且我没有监督任何事情或犯了实施错误）。可以假设输入字符串是有效的 UTF-16。这将与 MySQL 和 Oracle 一起使用的 DBMS。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T13:29:03.887

如果没有 ORM、准备好的语句或存储过程，我会谨慎对待任何字符串 SQL 清理例程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:40:04.697

不。

假设您有一个整数字段，他们将 PIN 输入其中：

"SELECT columns FROM table WHERE PIN = " + sanitizedstring

然后输入：1234 OR 1 = 1

现在你的“别针”总是被接受，没有使用任何有趣的字符。

这也适用于除 int 之外的字段（因为是的，您可以验证 int 输入实际上是 int，然后再将其交给 SQL。）

# excel - 如何从一列中获取最大日期并与 Excel 中的另一列匹配？

> ID：10755207
> 
> 赞同：1
> 
> 时间：2012-05-25T13:23:08.103
> 
> 标签：excel, max

我有如下的excel表数据

```
CustomerNo LoginDate
101        25/05/2012
101        10/05/2012
101        20/05/2012
101        10/04/2012
102        21/05/2012
102        12/04/2012
103        20/05/2012
104        08/04/2012 
```

我想获得与客户编号匹配的最后登录日期和结果，如下所示。

```
101   25/05/2012
102   21/05/2012
103   20/05/2012
104   08/04/2012 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:59:41.877

您可以使用 DMAX 功能来执行此操作。

首先，我将 CustomerNo 放在 A1 中，将 08/04/2012 放在 B9 中。然后我将该范围命名为“theTable”。

其次，我添加了 A11 和 B11 我的条件，“CustomerNo”和“LoginDate”。

然后在 A12 中，我放置 101。

最后我准备好了我的 DMAX 功能。

在B12，我放置`=DMAX(theTable,"LoginDate", A11:A12)`

Excel 将 25/05/2012 放在 B12 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T18:38:53.830

你可以试试数据透视表。这有很好的能力一次获得所有客户数量的最大值，并且可以在任何数据发生变化时快速更新。

*   选择格式正确的表格
*   插入 | 数据透视表
*   拖动`CustomerNo`到`Row Labels`
*   拖动`LoginDate`到`Values`
*   将`Value Field Settings`（例如，通过右键单击数据透视表中的任何值）更改为`Summarize by` `Max`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-01T00:24:04.117

有两种方法：

1.  带数组功能（按`Ctrl + Shift + Enter`）：

`=MAX(IF($A$2:$A$9=C2,$B$2:$B$9))`

2.  常规公式：

`=MAX(INDEX(($A$2:$A$9=C2)*($B$2:$B$9),,1))`

我个人更喜欢第二种方式，因为数组功能会降低大数据的 PC 性能。无论如何，希望这会有所帮助。

# edit - 在 OpenLayers 中更改多边形的点

> ID：10755209
> 
> 赞同：0
> 
> 时间：2012-05-25T13:23:09.207
> 
> 标签：edit, openlayers, polygon, openstreetmap, points

我已经构建了一个脚本，您可以在其中使用 OpenLayers 输入多边形，因为 Google 地图已成为一项付费服务​​。我遇到的问题是，当你添加一个多边形时，你可以删除它，但你不能像谷歌地图那样改变角落的位置。我想知道 OpenLayers 是否也可以做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:37:04.510

看看[OpenLayers Modify Feature 示例](http://openlayers.org/dev/examples/modify-feature.html)。在那里你可以看到你如何使用`OpenLayers.Control.ModifyFeature`来修改多边形或线的形状或改变点的位置。

# .htaccess - mc_googlesitemap 和多种语言

> ID：10755210
> 
> 赞同：0
> 
> 时间：2012-05-25T13:23:09.240
> 
> 标签：.htaccess, internationalization, seo, sitemap, typo3

我尝试提供我的 XML 站点地图，如此[处所述](http://www.telos.de/web/typo3/mc_googlesitemap-multi-language/)。我有一个名为站点地图的页面，`Google Sitemap Index`上面有一个。在“选定页面”下，我选择了页面本身。对于每种语言，我在站点地图下创建了一个子页面，`Google Sitemap for Pages`上面有一个和相应的翻译。如果我调用站点地图（索引），我有多个条目：

```
<sitemapindex>
    <sitemap>
        <loc>http://www.yourdomain.com/sitemap/german.html</loc>
        <lastmod>2012-05-25T12:39:19Z</lastmod></sitemap>
    <sitemap>
        <loc>http://www.yourdomain.com/sitemap/english.html</loc>
        <lastmod>2012-05-25T12:39:19Z</lastmod>
    </sitemap>
    <sitemap>
        <loc>http://www.yourdomain.com/sitemap/english.html</loc>
        <lastmod>2012-05-25T12:39:19Z</lastmod>
    </sitemap>
    <sitemap>
        <loc>http://www.yourdomain.com/sitemap/croatian.html</loc>
        <lastmod>2012-05-25T12:39:19Z</lastmod>
    </sitemap>
    <sitemap>
        <loc>http://www.yourdomain.com/sitemap/croatian.html</loc>
        <lastmod>2012-05-25T12:39:19Z</lastmod>
    </sitemap>
</sitemapindex> 
```

如果我在（索引站点地图的）“选定页面”下选择子页面，则该子页面`sitemapindex`为空。如果我隐藏翻译，我只有一个条目，但调用单独的站点地图（不同语言的）不再起作用（参见我的网站，而不是 xml 文件，页面为空白）。我无法禁用记录，因为所有翻译也都被禁用。

接下来，如果我打电话，`http://www.yourdomain.com/sitemap/english.html`我总是会得到我主要语言的站点地图。我已经扩展了我的 htaccess：

```
RewriteCond %{QUERY_STRING} id=170
RewriteRule ^index.php$ index.php?id=170&L=0 [L]
RewriteCond %{QUERY_STRING} id=171
RewriteRule ^index.php$ index.php?id=171&L=1 [L]
RewriteCond %{QUERY_STRING} id=172
RewriteRule ^index.php$ index.php?id=172&L=2 [L] 
```

我需要这里的完整路径而不是`id=171`？

**编辑：**

我切换到以下内容：

```
Redirect /sitemap/german.html /index.php?id=170&L=0
Redirect /sitemap/english.html /index.php?id=171&L=1
Redirect /sitemap/croatian.html /index.php?id=172&L=2
Redirect /sitemap/german /index.php?id=170&L=0
Redirect /sitemap/english /index.php?id=171&L=1
Redirect /sitemap/croatian /index.php?id=172&L=2 
```

唯一的缺点是现在我没有说话的网址了......

**编辑 2：** 不是解决方案，但现在我提交了多个站点地图 URL（翻译的站点地图），而不是上述整个过程。

# php - php-mysql版本与Mysql服务器冲突

> ID：10755222
> 
> 赞同：2
> 
> 时间：2012-05-25T13:24:30.957
> 
> 标签：php, mysql

我安装了 php 5.3 和 mysql server 5.5。我需要安装 php-mysql，但出现以下冲突。我该如何解决这个问题？

```
百胜安装 php-mysql
加载的插件：fastestmirror
从缓存的主机文件加载镜像速度
 * 基地：mirrors.versaweb.com
 * elrepo：elrepo.org
 * 额外内容：yum.phx.singlehop.com
 * 更新：yum.phx.singlehop.com
设置安装过程
解决依赖关系
--> 运行事务检查
---> 安装包 php-mysql.x86_64 0:5.3.3-3.el6_2.8
--> 处理依赖：php-common = 5.3.3-3.el6_2.8 对于包：php-mysql-5.3.3-3.el6_2.8.x86_64
--> 处理依赖：libmysqlclient.so.16(libmysqlclient_16)(64bit) for package: php-mysql-5.3.3-3.el6_2.8.x86_64
--> 处理依赖：libmysqlclient.so.16()(64bit) for package: php-mysql-5.3.3-3.el6_2.8.x86_64
--> 运行事务检查
---> 将安装包 mysql-libs.x86_64 0:5.1.61-1.el6_2.1
---> 包 php-common.x86_64 0:5.3.3-3.el6_2.5 将被更新
--> 处理依赖：php-common = 5.3.3-3.el6_2.5 对于包：php-5.3.3-3.el6_2.5.x86_64
--> 处理依赖：php-common = 5.3.3-3.el6_2.5 用于包：php-cli-5.3.3-3.el6_2.5.x86_64
--> 处理依赖：php-common = 5.3.3-3.el6_2.5 用于包：php-pdo-5.3.3-3.el6_2.5.x86_64
---> 包 php-common.x86_64 0:5.3.3-3.el6_2.8 将是一个更新
--> 运行事务检查
---> 包 php.x86_64 0:5.3.3-3.el6_2.5 将被更新
---> 包 php.x86_64 0:5.3.3-3.el6_2.8 将是一个更新
---> 包 php-cli.x86_64 0:5.3.3-3.el6_2.5 将被更新
---> 包 php-cli.x86_64 0:5.3.3-3.el6_2.8 将是一个更新
---> 包 php-pdo.x86_64 0:5.3.3-3.el6_2.5 将被更新
---> 包 php-pdo.x86_64 0:5.3.3-3.el6_2.8 将是一个更新
--> 完成依赖解析

依赖关系已解决

==================================================== ==================================================== ==================================================== ==========================================
 包 Arch 版本库大小
==================================================== ==================================================== ==================================================== ==========================================
安装：
 php-mysql x86_64 5.3.3-3.el6_2.8 更新 79 k
安装依赖项：
 mysql-libs x86_64 5.1.61-1.el6_2.1 更新 1.2 M
更新依赖项：
 php x86_64 5.3.3-3.el6_2.8 更新 1.1 M
 php-cli x86_64 5.3.3-3.el6_2.8 更新 2.2 M
 php-common x86_64 5.3.3-3.el6_2.8 更新 522 k
 php-pdo x86_64 5.3.3-3.el6_2.8 更新 73 k

交易摘要
==================================================== ==================================================== ==================================================== ==========================================
安装 2 个软件包
升级 4 包

总尺寸：5.2M
这可以吗[是/否]：是
下载包：
运行 rpm_check_debug
运行事务测试

事务检查错误：
  来自安装 mysql-libs-5.1.61-1.el6_2.1.x86_64 的文件 /usr/share/mysql/charsets/Index.xml 与来自包 MySQL-server-5.5.20-1.linux2.6 的文件冲突。 x86_64
  安装 mysql-libs-5.1.61-1.el6_2.1.x86_64 中的文件 /usr/share/mysql/charsets/README 与包 MySQL-server-5.5.20-1.linux2.6.x86_64 中的文件冲突

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:03:44.357

我建议从[http://dev.mysql.com/](http://dev.mysql.com/)`shared-compat`下载一个包并用它替换默认值。提供所有版本的 MySQL 客户端库，它应该满足任何未来的软件升级或安装。例如使用名为`mysql-libs``shared-compat``MySQL-shared-compat-5.5.24-1.el6.x86_64.rpm`

要安装它，请删除现有`mysql-libs`包，同时忽略任何依赖项，`rpm -e --nodeps mysql-libs`然后立即使用`rpm -ihv MySQL-shared-compat-5.5.24-1.el6.x86_64.rpm`.

如果服务器正在处理任何生产流量，您当然应该安排一个维护窗口，因为在安装新库之前删除库可能会导致错误。

稍后您还应该考虑将服务器和客户端软件包也替换为官方软件包，以避免来自不同供应商的构建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-25T11:38:35.900

**我有类似的问题，**

```
Error: mysql conflicts with MySQL-server
Error: mysql-server conflicts with MySQL-server 
```

**在终端使用这四个命令解决了**

```
yum remove MySQL-devel* -y
yum remove MySQL-devel-community* -y
yum remove MySQL-client* -y
yum remove MySQL-server* -y 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:58:05.093

我有一个类似的问题。升级到 php 5.4 应该可以

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T15:49:33.337

我必须在启用 mysql 和 mysql pdo 的情况下从源代码重新安装 php，这种方式总是更简单。

# android - 如何将进度条添加到 ActionBarSherlock

> ID：10755224
> 
> 赞同：6
> 
> 时间：2012-05-25T13:24:35.760
> 
> 标签：android, actionbarsherlock

是否可以将进度条添加到 ActionBarSherlock？我需要在特定时间显示和隐藏它。但它必须位于 ActionBarSherlock 内。

我班的代码。你可以看到，我使用 requestWindowFeature(Window.FEATURE_PROGRESS) 但它没有任何区别。同样的结果。：

```
public class RecipeActivity extends SherlockActivity {

private String picture;
private String TAG = "RecipeActivity";
private ImageView viewPicture;
private RecipeGeneral recipeGeneral;
private Recipe recipe;
private String [] pictures;
private ArrayList<Step> steps;
//private ImageView viewStar;
private DataBaseFactory db;
private NyamApplication application;
private TextView viewDescription;
private TextView userView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_PROGRESS);
    setProgressBarIndeterminateVisibility(true);

    try {
        setContentView(R.layout.recipe_page);

        getSupportActionBar().setDisplayShowTitleEnabled(false);
        recipeGeneral = (RecipeGeneral)getIntent().getSerializableExtra("Recipe");
        Log.d(TAG, "recipeGeneral = " + recipeGeneral.toString());
        picture = Constants.URL + recipeGeneral.getImg_url();
        Log.d(TAG,"picture : " + picture);
        viewPicture = (ImageView)findViewById(R.id.picture);
        new DownloadImageTask().execute(pictures);

        viewDescription = (TextView)findViewById(R.id.recepy_description);
        TextView viewTitle = (TextView)findViewById(R.id.recepy_title);
        TextView ratingView = (TextView)findViewById(R.id.txtTitle3);
        userView = (TextView)findViewById(R.id.author_name);

        application = (NyamApplication)getApplication();
        db = application.getDB();

        if (getIntent().getBooleanExtra("isFavorites", false) == true) {
            Log.d(TAG, "isFavorites = " + getIntent().getBooleanExtra("isFavorites", false));

            viewDescription.setText(((Recipe)recipeGeneral).getDescription());
            viewTitle.setText(recipeGeneral.getTitle());
            Log.d(TAG, "Title = " + recipeGeneral.getTitle());
            ratingView.setText(String.valueOf(recipeGeneral.getFavorites_by()));
            Log.d(TAG, "Rating = " + String.valueOf(recipeGeneral.getFavorites_by()));
            userView.setText(((Recipe)recipeGeneral).getUser());
            Log.d(TAG, "User = " + ((Recipe)recipeGeneral).getUser());

            steps = db.getStepsByRecipeId(recipeGeneral.getId());
            if (steps != null) {
                ((Recipe)recipeGeneral).setSteps(steps);
            }

        } else {
            Log.d(TAG, "isFavorites = " + getIntent().getBooleanExtra("isFavorites", false));
            Object [] params = new Object[] {this, Constants.URL + recipeGeneral.getPath()+ Constants.JSON};

            new AsyncHttpGetRecipe().execute(params);   
            new AsyncHttpGetSteps().execute(params);    
            viewTitle.setText(recipeGeneral.getTitle());

            ratingView.setText(recipeGeneral.getFavorites_by());
            Log.d(TAG, "Rating = " + recipeGeneral.getFavorites_by());

        }

    } catch (Exception e) {
        e.printStackTrace();
    }
}

private class DownloadImageTask extends AsyncTask<String,Void,Bitmap> {

    Bitmap  bitmap = null;

    @Override
    protected Bitmap doInBackground(String... str) {
        try{   
            InputStream in = new java.net.URL(picture).openStream();
            bitmap = BitmapFactory.decodeStream(new SanInputStream(in));
            //viewPicture.setImageBitmap(bitmap);
        }
        catch(Exception e){
            e.printStackTrace();
        }
        return bitmap;
    }

    @Override 
    protected void onPostExecute(Bitmap result) {
        super.onPostExecute(result);
        viewPicture.setBackgroundDrawable(new BitmapDrawable(bitmap));
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    com.actionbarsherlock.view.MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.item_page_menu, (com.actionbarsherlock.view.Menu) menu);
    return super.onCreateOptionsMenu(menu);
}

public void onClick(View v) {
    switch(v.getId()) {
    case R.id.icon_little3:
        Log.d(TAG,"further");
        if (getIntent().getBooleanExtra("isFavorites", false) == false) {
            if (recipe != null && steps != null) {
                recipe.setSteps(steps);
                db.addRecipeToFavorites(recipe);
            }
        }
    }
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch(item.getItemId())  {
    case R.id.menu_further: 
        Log.d(TAG,"In menu_further");
        Intent stepIntent = new Intent(this, StepActivity1.class);

        if (getIntent().getBooleanExtra("isFavorites", false) == true) {
            Log.d(TAG,"id: " + recipeGeneral.getId());
            Log.d(TAG,"desc: " + recipeGeneral.getTitle());
            stepIntent.putExtra("Recipe1", recipeGeneral);
        } else {
            Log.d(TAG,"id: " + recipe.getId());
            Log.d(TAG,"desc: " + recipe.getTitle());
            recipe.setSteps(steps);
            stepIntent.putExtra("Recipe1", recipe);
        }
        startActivity(stepIntent);
        return true;
    case R.id.menu_cart: 
        Toast.makeText(this, "Cart", 10000).show();
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }

}

class AsyncHttpGetRecipe extends AsyncTask<Object, String, Recipe> {

    @Override
    protected  Recipe doInBackground(Object... params) {
        Recipe recipeAsync = null;
        try {
            recipeAsync = ApiFactory.getRecipe((Context)params[0], (String)params[1]);
        } catch (JSONException e) {
            e.printStackTrace();
        } 
        recipe  = recipeAsync;
        return recipeAsync;
    }

    @Override
    protected void onPostExecute(Recipe recipeTemp) {
        viewDescription.setText(recipeTemp.getDescription());
        Log.d(TAG, "Description = " + recipeTemp.getDescription());
        userView.setText(recipeTemp.getUser());
        Log.d(TAG, "User = " + recipeTemp.getUser());

    }
}

class AsyncHttpGetSteps extends AsyncTask<Object, String, ArrayList<Step>> {

    @Override
    protected  ArrayList<Step> doInBackground(Object... params) {
        ArrayList<Step> stepsAsync = null;
        try {
            stepsAsync = ApiFactory.getSteps((Context)params[0],  (String)params[1]);
        } catch (JSONException e) {
            e.printStackTrace();
        } catch (ParseException e) {
            e.printStackTrace();
        }
        return stepsAsync;
    }

    @Override
    protected void onPostExecute(ArrayList<Step> stepsAsync) {
        steps = stepsAsync;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-25T13:33:21.903

是的。您可以使用 ABS 将 ProgressBar 添加到 ActionBar。

*这是下面提供的来源的摘录，如果解决方案有帮助，+1 原始海报；-)*

在您的`onCreate()`方法中，添加这段代码：

```
requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);  
setProgressBarIndeterminateVisibility(true); 
```

当您完成需要为其显示 ProgressBar 的任务时，使用以下代码隐藏 ProgressBar：

```
setProgressBarIndeterminateVisibility(false); 
```

信用：[https ://stackoverflow.com/a/9157874/450534](https://stackoverflow.com/a/9157874/450534)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T13:47:20.290

是的，你可以，ABS 有这样的功能。下一段代码来自 ABS 的 Demos 示例应用程序：

```
public class Progress extends SherlockActivity  {
    Handler mHandler = new Handler();
    Runnable mProgressRunner = new Runnable() {
        @Override
        public void run() {
            mProgress += 2;

            //Normalize our progress along the progress bar's scale
            int progress = (Window.PROGRESS_END - Window.PROGRESS_START) / 100 * mProgress;
            setSupportProgress(progress);

            if (mProgress < 100) {
                mHandler.postDelayed(mProgressRunner, 50);
            }
        }
    };

    private int mProgress = 100;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        setTheme(SampleList.THEME); //Used for theme switching in samples
        super.onCreate(savedInstanceState);

        //This has to be called before setContentView and you must use the
        //class in com.actionbarsherlock.view and NOT android.view
        requestWindowFeature(Window.FEATURE_PROGRESS);

        setContentView(R.layout.progress);

        findViewById(R.id.go).setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View arg0) {
                if (mProgress == 100) {
                    mProgress = 0;
                    mProgressRunner.run();
                }
            }
        });
    }
} 
```

您可以在 ABS 的 samples\demos\ 目录中找到此示例（Eclipse 工作区中的 Progress.java）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-09T18:06:00.260

为了完全兼容，您应该使用：

```
setSupportProgressBarIndeterminateVisibility(true); 
```

这是一个例子：

```
public class MyActivity extends SherlockFragmentActivity {
    //...
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);     
        requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);        
        setContentView(R.layout.my_layout);
        //...
        setSupportProgressBarIndeterminateVisibility(true);
    }
} 
```

# c# - EF4 和创建新记录

> ID：10755225
> 
> 赞同：0
> 
> 时间：2012-05-25T13:24:43.297
> 
> 标签：c#, entity-framework

我是 Entity Framework 的新手，我的第一段代码似乎已经不正确，或者至少不是我所期望的。

我已经从数据库中生成了我的实体对象。我的一张桌子是`WebUser`。所以我知道有一个实体对象`WebUser`。数据库使用一个`Identity`名为的列，该列`WebUserID`也是表的主键。

但是，该`CreateWebUser`方法具有以下签名...

```
public static WebUser CreateWebUser(global::System.Int32 webUserID, 
                                    global::System.String userName, 
                                    global::System.String password, 
                                    global::System.String emailAddress) 
```

为什么它要求`WebUserID`? 这不能插入到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:43:35.097

您可以设置`webUserID`或保持默认。但是当您想添加两个或更多 WebUser 时，`webUserID`可用于设置项目的顺序。

```
db.CreateWebUser(2,"The Second Recored","2","2");
db.CreateWebUser(1,"The First Recored","1","1");
db.SaveChanges(); 
```

哪个会先插入数据库？答案是哪个`webUserID`较小的会先插入数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:36:32.247

如[手册](http://msdn.microsoft.com/en-us/library/bb896331.aspx)中所述，您应将 ID 设置为 0。它会在您调用时由 EF 更新`Context.SaveChanges()`。

您也可以使用[`Context.CreateObject<WebUser>()`](http://msdn.microsoft.com/en-us/library/dd468073)or （按照医生的建议）`var newUser = new WebUser()`创建一个新实体并在设置其他属性时省略 ID。

# hibernate - Hibernate Cache 中的可变实体

> ID：10755227
> 
> 赞同：1
> 
> 时间：2012-05-25T13:24:56.040
> 
> 标签：hibernate, caching

众所周知，在后续查询中使用的实体可以使用 Hibernate 缓存。我的问题是，这样的缓存实体在以这种方式放入缓存后是否不可变：

a) 从数据库加载实体

b) 当注解可缓存时，Hibernate 将这些实体放入缓存中

c) DAO 接收加载的对象

d) DAO 操作该实体的某些属性（例如解密某些加密字段），但将更改标记为“与缓存无关”

e) 对于后续查询，始终缓存和操作的实体由 Hibernate 缓存返回。

我希望这个愿望清单不是天真的，但我认为，对于基于 Spring/Hibernate 的现代应用程序来说，这些是非常正常的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:35:32.280

二级缓存不包含实体。它包含 Hibernate 从数据库表中加载的数据行。每次从缓存中加载实体时，都会从缓存中的数据构造一个新的实体实例，就好像它来自数据库一样。

您的实体的瞬态字段不存储在缓存中。

# iphone - 如何识别 OpenGL ES 立方体的哪个面被触摸？

> ID：10755231
> 
> 赞同：2
> 
> 时间：2012-05-25T13:25:22.397
> 
> 标签：iphone, ios, opengl-es

使用 OpenGL ES，我创建了一个带有纹理的立方体。我现在希望让每个带纹理的侧面都可以点击，这样我就可以创建一个立方体，在触摸特定侧面时导航到不同的视图。

我该如何实施？

此外，我如何知道立方体的哪些面当前是可见的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:42:34.493

有不同的技术可以执行对象的选择，或者像您的情况一样，在 OpenGL 中选择对象的面。

尽管正如 cthutu 所说，我发现光线相交技术对您的情况来说有点过头了，这是一个可行的解决方案。

无论如何，我建议您的解决方案是颜色选择技术。

它包括当用户在屏幕上“点击”时以预先确定的颜色渲染后缓冲区中的对象或对象的面。渲染是在纹理中完成的，工作是读取用户单击的像素的颜色。

获得像素颜色后，您可以轻松确定单击了哪个对象或面。

例如，假设您有一个有 6 个面的立方体，您为每个面指定一种颜色（即红色、蓝色、黄色、橙色、绿色、白色），并将指定的颜色存储在程序逻辑的某个位置。当用户单击时，您使用这些假颜色渲染立方体，读取颜色，然后使用实际颜色/纹理在屏幕上再次渲染。在该过程结束时，您检查像素的颜色，例如黄色，然后从那里确定选择。

我希望这在某种程度上有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:53:28.133

一种常见的 3d 图形任务，用于使用鼠标的游戏。您需要计算您触摸的屏幕上的 X 和 Y 位置，从该位置开始创建一条射线（Z = 0）并到达 Z = 无穷大，然后将该射线转换为世界空间（从相机空间）。然后使用该射线计算它首先与哪个三角形相交。

谷歌搜索“射线三角形相交”以获取数学和算法。对于一个简单的立方体，您可以遍历所有三角形。对于更复杂的场景，您需要对三角形进行空间散列（使用八叉树、bsps 等）以提高性能。

# asp.net - 从 asp.net 文件访问 Site.Master 对象

> ID：10755233
> 
> 赞同：1
> 
> 时间：2012-05-25T13:25:23.467
> 
> 标签：asp.net

我有一个使用 Site.Master 的 asp 页面。

我在 Site.Master 中放了一个链接，master 包含了 default.aspx。如何访问asp文件中的链接属性？

在 Site.Master ：

```
<asp:HyperLink ID="HyperLink1" runat="server" NavigateUrl="~/Register.aspx" 
                    Target="_blank">Register</asp:HyperLink> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T13:31:43.327

做到这一点的唯一方法是按照以下方式做一些事情：

```
HyperLink link =  this.Master.FindControl("id_of_the_control_you_are_looking_for") as HyperLink; 
```

但请注意`FindControl`，它不是递归的，因此您需要首先找到包含您要查找的超链接的控件，然后`FindControl`使用您需要的超链接的 id 在此容器上执行另一个操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:33:25.710

您需要做的第一件事是将 MasterType 指令添加到您的内容页面：

```
<%@ Page Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="Namespace.Default" %>
<%@ MasterType VirtualPath="~/Site.Master" %> 
```

现在，您可以从内容页面中的 MasterPage 访问每个*公共*项目。

假设您的 MasterPage 在其代码隐藏中有这个：

```
public partial class Site : System.Web.UI.MasterPage
{
    public string Name { get; set; }
} 
```

然后，您可以在内容页面中执行此操作：

```
public partial class Default
{
    public void Page_Load(object sender, EventArgs e)
    {
        Master.Name = "Bobby";
    }
} 
```

我不确定您的问题中的“链接属性”是什么意思，但如果您指的是超链接，那么您可以这样做：

```
public partial class Site : System.Web.UI.MasterPage
{
    public HyperLink SharedHyperLink { get { return myHyperLink; } }
}

public partial class Default
{
    public void Page_Load(object sender, EventArgs e)
    {
        Master.SharedHyperLink.NavigateUrl = "/Contact.aspx";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T13:37:31.373

假设您在母版页的某处有一个链接：

```
<asp:LinkButton ID="mylink" runat="server" Text="OK" CssClass="test" /> 
```

然后在子页面后面的代码中，您可以像这样获取它：

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        var link = FindControlRecursive(Master, "mylink") as LinkButton;
        if (link != null)
        {
            var css = link.CssClass;
            // TODO: do something with the link
        }
    }

    private static Control FindControlRecursive(Control control, string id)
    {
        if (control.ID == id)
        {
            return control;
        }

        foreach (Control ctrl in control.Controls)
        {
            var foundCtrl = FindControlRecursive(ctrl, id);
            if (foundCtrl != null)
            {
                return foundCtrl;
            }
        }
        return null;
    }
} 
```

# python - 将python输出保存到变量中

> ID：10755234
> 
> 赞同：1
> 
> 时间：2012-05-25T13:25:26.430
> 
> 标签：python

我有一个看起来像这样的 bitarray 文件：

```
10000000000000000000000000000000000000000000000000000000000000000000001000000 
```

我需要根据它们在位数组中的位置来计算位的总和：（第二位，第二位 + 7，第二位 + 14）。我尝试了下面的代码，但它只计算了第一个打印值的总和。你能指导我解决这个问题吗？

```
 lines = [line.strip() for line in open('test.txt')]
    bitp = range(1,len(lines[0]),7)
    for i in lines:
        for p in bitp:
            bitsum = sum(int(a) for a in i[p]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:32:25.940

我想你想每行存储一个总和？在这种情况下，您需要一个列表：

```
bitsums = list()
with open('test.txt') as fobj:
    for line in fobj:
        bitsums.append(sum(int(c) for c in line.strip()[1::7])) 
```

# javascript - Highcharts 根据值更改条形颜色

> ID：10755236
> 
> 赞同：12
> 
> 时间：2012-05-25T13:25:33.243
> 
> 标签：javascript, highcharts

我正在使用 Highcharts 并且想知道是否可以让条形图中的前 3 个结果与图表的其余部分具有不同的颜色条？我正在从 CSV 文件填充图表。

这是我的javascript：

```
$(document).ready(function() {

        var options = {
            chart: {
                renderTo: 'container',
                defaultSeriesType: 'bar'
            },
            title: {
                text: 'Spiritual Gifts Results'
            },
            colors: [
                '#3BBEE3'
            ],
            xAxis: {
                categories: []
            },

            yAxis: {
                title: {
                    text: 'Service'
                }
            },
            series: []
        };

        var data = document.getElementById("<%= hdn_Data.ClientID %>");
        // Split the lines
        if (data.value != "") {
            var lines = data.value.split('\n');

            // Iterate over the lines and add categories or series
            $.each(lines, function(lineNo, line) {
                var items = line.split(',');
                // header line containes categories
                if (lineNo == 0) {
                    $.each(items, function(itemNo, item) {
                        if (itemNo > 0) options.xAxis.categories.push(item);
                    });
                }
                // the rest of the lines contain data with their name in the first position
                else {
                    var series = {
                        data: []
                    };
                    $.each(items, function(itemNo, item) {
                        if (itemNo == 0) {
                            series.name = item;
                        } else {
                            series.data.push(parseFloat(item));
                        }
                    });

                    options.series.push(series);

                }

            });

            // Create the chart
            var chart1 = new Highcharts.Chart(options);
        }
    }); 
```

这是一个示例 CSV：

```
Categories,Administration,Evangelism,Mercy,Shepherding,Leadership,Wisdom,Teaching
Total Points,11,5,4,4,3,2,1 
```

所以在这个例子中，我希望“管理”、“传福音”和“慈悲”有一个“蓝条颜色”，而“牧羊人”、“领导”等有一个“红条颜色”。

这可能吗？

这是[小提琴](http://jsfiddle.net/vP2rM/6/)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-08-20T10:29:45.677

这是一个例子

```
data: [
  { y: 34.4, color: 'red'},   // this point is red
  21.8,                        // default blue
  {y: 20.1, color: '#aaff99'}, // this will be greenish
  20                           // default blue
] 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-25T19:22:16.837

根据OP的评论，我之前的回答被击中了。

~~正如你正在做的那样，~~

 ~~```
series.name = item; 
```~~ 

和

```
series.data.push(parseFloat(item)); 
```

明智地，你可以这样做，

```
series.color: '#f6f6f6' 
```

~~*（在您的循环中，您可以根据您的条件更改颜色）*~~

你可以做，

```
$(document).ready(function() {

    var options = {
        chart: {
            renderTo: 'container',
            defaultSeriesType: 'bar'
        },
        title: {
            text: 'Spiritual Gifts Results'
        },
        colors: [
            '#3BBEE3'
            ],
        xAxis: {
            categories: []
        },

        yAxis: {
            title: {
                text: 'Service'
            }
        },
        series: []
    };

    var data = document.getElementById("hdn_Data");
    // Split the lines
    if (data.value != "") {
        var lines = data.value.split('\n');

        // Iterate over the lines and add categories or series
        $.each(lines, function(lineNo, line) {
            var items = line.split(',');
            // header line containes categories
            if (lineNo == 0) {
                $.each(items, function(itemNo, item) {
                    if (itemNo > 0) options.xAxis.categories.push(item);
                });
            }
            // the rest of the lines contain data with their name in the first position
            else {
                var series = {
                    data: []
                };
                $.each(items, function(itemNo, item) {
                    var data = {};
                    if (itemNo == 0) {
                        series.name = item;
                    } else {
                        data.y = parseFloat(item);
                        if (itemNo <= 3) {
                            data.color = 'Gray';
                        }
                        else {
                            data.color = '#3BBEE3';
                        }
                        series.data.push(data);
                    }
                });
                options.series.push(series);
              }
            });

            // Create the chart
            var chart1 = new Highcharts.Chart(options);
        }
    }); 
```

[小提琴](http://jsfiddle.net/qeNRM/1/)

参考[this](http://www.highcharts.com/ref/#series)，您可以`data`通过3种方式给予。我用过第三个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T14:52:38.853

是的，在您的推送执行中，您应该能够为该点设置颜色。我对推送不太熟悉，因为我们使用的是我们发送的预编译数据对象。但是在我们的 .NET 内部，我们在特定点上设置颜色（如果需要），然后将数据对象发送到图表。

# android - 从另一个应用程序启动一个应用程序，应用程序启动的状态应在android中维护

> ID：10755241
> 
> 赞同：1
> 
> 时间：2012-05-25T13:25:51.127
> 
> 标签：android, launch

我想从 android 中的另一个应用程序启动一个应用程序。

在 App1 中说：

*   我在活动1
*   然后活动2
*   然后活动3

从 App2 我启动 App1。

*   应该直接显示 App1 的 Activity3 而不是 Activity1

我尝试使用以下代码：

```
Intent i = new Intent(Intent.ACTION_MAIN); 
PackageManager manager = getPackageManager(); 
i = manager.getLaunchIntentForPackage("com.android.emailDemo");     i.addCategory(Intent.CATEGORY_LAUNCHER);
i.setComponent(new ComponentName("com.android.emailDemo", "com.android.emailDemo.EmailAppDemo")); 
i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
startActivity(i); 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:41:44.147

Android 可以通过 Manifest 标志和启动模式来做到这一点。每个活动都可以有一组标志来指示系统如何管理他们的意图。我相信您必须发送 Activity3 负责的操作并设置标志，这样就不会创建其他任务。

阅读：http: [//developer.android.com/guide/topics/fundamentals/tasks-and-back-stack.html](http://developer.android.com/guide/topics/fundamentals/tasks-and-back-stack.html)

尝试将您的活动启动模式设置为“单顶” [http://developer.android.com/guide/topics/manifest/activity-element.html#lmode](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)

# javascript - HTML：存储实体ID的元素/属性

> ID：10755242
> 
> 赞同：0
> 
> 时间：2012-05-25T13:25:52.490
> 
> 标签：javascript, jquery, html

我有一个索引路由，它将数据库中的所有持久图像实体呈现为某种格式，如下所示：

```
<div class="image field">
  <h3>image-name</h3>
  <img src="imagefilename.jpg" />
</div> 
```

我现在如何在每个渲染的 div-image-container 中渲染一个 id，jquery 可以解析并用于 ajax？

抱歉忘记了：

我的意思不是整数形式的 id，而是字符串（slug）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:41:11.557

根据 HTML5，似乎最合适的方法是为 id 和其他用户定义的属性使用数据属性：

```
<div class="image field" data-id="1">
  <h3>image-name</h3>
  <img src="imagefilename.jpg" />
</div> 
```

您可以使用 id 代替 data-id。但我认为**id**属性用于 DOM 操作，而 data-id 是基于逻辑的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:33:03.353

您需要向标签中添加一个`id`，`<img>`或者您可以使用 JQuery 选择器来挑选具有相同`<div>`结构的每个元素，如下所示

见[jsfiddle](http://jsfiddle.net/6ySL7/)

```
<div class="image-field">
    <h3>image-name</h3>
    <img src="image.png" />
</div>

$(function() {
   alert($('div.image-field img').attr('src'))
})

// will output: "image.png" 
```

注意：我已经更改了此示例`id`的包含内容`div`

如果您在一个页面上有多个这些，您可以循环它们，如此[JSFiddle所示](http://jsfiddle.net/DtAhv/1/)

# javascript - jQuery ajax 完成后如何重新启用 document.write

> ID：10755244
> 
> 赞同：0
> 
> 时间：2012-05-25T13:26:03.133
> 
> 标签：javascript, jquery

我必须抓取其中包含 document.write 的 JS 片段——这会导致 document.write 呈现后页面变为空白。我可以通过重新定义 document.write 来解决这个问题，并将脚本的响应传递给我用来输出 getScript() jQuery 函数的响应的函数。但是，我遇到了稍后在页面中加载的其他元素和脚本的问题，我的重新定义阻止了在页面上输出。jQuery getScript() 完成后，如何将 document.write 设置回默认功能？

```
$.getScript('somescript.com/script/', function(){
  //Prevent document.write normal behavior
  document.write = function(markup) {
  fullMarkup += markup;
  appendResponse(markup);
  }
 }  
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:28:44.463

只需将原始引用保存 `document.write`在某个变量中并在使用替换后恢复它。

```
window.backupWrite = document.write; 
```

在成功加载（和执行）你的脚本之后

```
document.write = window.backupWrite; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:29:06.633

加载完所有内容后执行`document.write`后，它将空白页面。

如果您的目标只是检索和执行脚本，`$.getScript()`那么已经为您做到了。

```
$.getScript('somescript.com/script/'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:30:34.917

`document.write`如果在文档在某些大型浏览器中呈现后运行，则完全清除 DOM。也就是说，不要使用它。如果您无法选择外部脚本，那就太糟糕了。您可以使用各种 jQuery`.append`方法以字符串形式添加内容。

# javascript - 禁用输入字段，因此“getElementById(field_name).value =”将不再更改其值

> ID：10755247
> 
> 赞同：1
> 
> 时间：2012-05-25T13:26:11.150
> 
> 标签：javascript, html

我有一个根据其内容禁用或不禁用的输入字段。但是，我还有一个按钮，可以使用 javascript 更改此字段的值 `getElementById('field_name').value = "something"`。

是否有可能让它在禁用时不会改变字段的值？
我已尝试将字段设置为只读和禁用，但这并不能阻止按钮更改其值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:29:30.017

最简单的方法可能是在按钮的`click`处理程序中执行检查。

而不是这样做：

```
document.getElementById("field_name").value = "something"; 
```

做：

```
var element = document.getElementById("field_name");
if (!element.disabled) {
    element.value = "something";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:29:24.637

如果您想让设置代码尊重该`disabled`属性，只需将其设置为：

```
var el = getElementById('field_name');
if (!el.disabled) el.value = "something"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:29:32.257

试试这样的 -

```
if(!getElementById(field_name).disabled){
          getElementById(field_name).value = "something";
 } 
```

# c# - JSON不解析，抛出异常

> ID：10755252
> 
> 赞同：1
> 
> 时间：2012-05-25T13:26:35.790
> 
> 标签：c#, json, string, json.net

我从服务器获取字符串格式的 JSON，并将其保存到文本文件中

然后我正在读取该文本文件并将其返回给服务器，但我无法将其解析回对象。可能是因为转义序列导致了问题，或者我不知道。

请建议，我正在使用 C# 和 Newtonsoft 的 JSON.NET

以下是示例：

从服务器接收的字符串并将其保存到本地 txt 文件

```
{"data":"[{\"MenuId\":483,\"Name\":\"Nikhil menu\",\"Desc\":\"test\",\"ASAP\":\"T\",\"LT\":\"T\",\"FO\":\"T\",\"catList\":[{\"CatId\":5132,\"CatName\":\"Cate00\",\"Desc\":\"test\",\"P1\":{\"Id\":1,\"Name\":\"SML\"},\"P2\":{\"Id\":2,\"Name\":\"MED\"},\"P3\":null,\"P4\":null,\"P5\":null,\"P6\":null,\"CatType\":\"Normal\",\"ItemList\":[{\"Id\":38190,\"Name\":\"XXX\",\"Desc\":\"tesdt\",\"MinQ\":1,\"MaxQ\":99,\"MinP\":0.0,\"MaxP\":0.0,\"P1\":100.0,\"P2\":200.0,\"P3\":-99.0,\"P4\":-99.0,\"P5\":-99.0,\"P6\":-99.0,\"Img\":\"\",\"Icon1\":null,\"Icon2\":null,\"Icon3\":null,\"Icon4\":null,\"OpenOn\":{\"Mon\":\"T\",\"Tue\":\"T\",\"Wed\":\"T\",\"Thu\":\"T\",\"Fri\":\"T\",\"Sat\":\"T\",\"Sun\":\"T\"},\"SpecialOffer\":null,\"AddOnList\":[],\"ItemModList\":[]}]}]}]","message":"Processed Successfully","serviceName":"CreateCache","serviceStatus":"S"} 
```

从服务器读取相同的本地文本文件后的字符串

```
{"data":"[{\"MenuId\":483,\"Name\":\"Nikhil menu\",\"Desc\":\"test\",\"ASAP\":\"T\",\"LT\":\"T\",\"FO\":\"T\",\"catList\":[{\"CatId\":5132,\"CatName\":\"Cate00\",\"Desc\":\"test\",\"P1\":{\"Id\":1,\"Name\":\"SML\"},\"P2\":{\"Id\":2,\"Name\":\"MED\"},\"P3\":null,\"P4\":null,\"P5\":null,\"P6\":null,\"CatType\":\"Normal\",\"ItemList\":[{\"Id\":38190,\"Name\":\"XXX\",\"Desc\":\"tesdt\",\"MinQ\":1,\"MaxQ\":99,\"MinP\":0.0,\"MaxP\":0.0,\"P1\":100.0,\"P2\":200.0,\"P3\":-99.0,\"P4\":-99.0,\"P5\":-99.0,\"P6\":-99.0,\"Img\":\"\",\"Icon1\":null,\"Icon2\":null,\"Icon3\":null,\"Icon4\":null,\"OpenOn\":{\"Mon\":\"T\",\"Tue\":\"T\",\"Wed\":\"T\",\"Thu\":\"T\",\"Fri\":\"T\",\"Sat\":\"T\",\"Sun\":\"T\"},\"SpecialOffer\":null,\"AddOnList\":[],\"ItemModList\":[]}]}]}]","message":"Processed Successfully","serviceName":"CreateCache","serviceStatus":"S"} 
```

将它添加到另一个类的对象后得到的字符串，我用它再次将其发送到服务器，我在服务器上得到这个字符串

```
{"data":"[{\"MenuId\":483,\"Name\":\"Nikhil menu\",\"Desc\":\"test\",\"ASAP\":\"T\",\"LT\":\"T\",\"FO\":\"T\",\"catList\":[{\"CatId\":5132,\"CatName\":\"Cate00\",\"Desc\":\"test\",\"P1\":{\"Id\":1,\"Name\":\"SML\"},\"P2\":{\"Id\":2,\"Name\":\"MED\"},\"P3\":null,\"P4\":null,\"P5\":null,\"P6\":null,\"CatType\":\"Normal\",\"ItemList\":[{\"Id\":38190,\"Name\":\"XXX\",\"Desc\":\"tesdt\",\"MinQ\":1,\"MaxQ\":99,\"MinP\":0.0,\"MaxP\":0.0,\"P1\":100.0,\"P2\":200.0,\"P3\":-99.0,\"P4\":-99.0,\"P5\":-99.0,\"P6\":-99.0,\"Img\":\"\",\"Icon1\":null,\"Icon2\":null,\"Icon3\":null,\"Icon4\":null,\"OpenOn\":{\"Mon\":\"T\",\"Tue\":\"T\",\"Wed\":\"T\",\"Thu\":\"T\",\"Fri\":\"T\",\"Sat\":\"T\",\"Sun\":\"T\"},\"SpecialOffer\":null,\"AddOnList\":[],\"ItemModList\":[]}]}]}]","message":"Processed Successfully","serviceName":"CreateCache","serviceStatus":"S"} 
```

我无法将此字符串文件解析回列表

我努力了

```
JObject jObject = JObject.Parse(obj.cacheInfo.cData);
JToken jT = jObject["data"];
List<Menu> lMenu = JsonConvert.DeserializeObject<List<Menu>>(jT.ToString());

JObject jObject = JObject.Parse(obj.cacheInfo.cData);
JObject jObject = JObject.Parse(jObject["data"].ToString()); 
```

任何帮助都可以，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:37:50.280

我可能是错的，但是您是否尝试过将集合`Menu`作为数组接受？我不确定 Json.NET 是否会自动将 JavaScript 数组转换`T`为`List<T>`. 尝试这个：

```
List<Menu> lMenu = JsonConvert.DeserializeObject<Menu[]>(jT.ToString()).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T11:33:14.843

问题出在服务器上 JSON.NET 库的版本上。在一台服务器上是 3.5，另一台是 4.5。感谢大家的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:41:25.207

确保属性是公开的。确保您反序列化的类具有默认构造函数。类中的数组 - 它们是如何实现的？是的，哪个例外？

# javascript - CodeIgniter Gmaps 获取标记对象经纬度

> ID：10755254
> 
> 赞同：0
> 
> 时间：2012-05-25T13:26:45.817
> 
> 标签：javascript, codeigniter, google-maps

我正在使用[biostall](http://biostall.com/codeigniter-google-maps-v3-api-library)的 Google Maps CI 库。我想平移到已单击的标记，以便地图以该标记为中心。

我已经尝试过这个 JS，但似乎标记对象没有 getLatLng() 方法。

```
function open_marker(id){
    google.maps.event.trigger(markers[id],'click'); // this works fine, opens the correct marker
    map.panTo(markers[id].getLatLng());
    return;
} 
```

得到错误：

> 未捕获的类型错误：对象#V> 没有方法“getLatLng”

我需要获得一个可以 getLatLng() 的标记对象。

当我`alert(markers[id])`说对象时，我假设它存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:33:38.537

`getLatLng()`在 API v2 中

在 API v3 中`getPosition()`使用

有关所有选项和方法，请参阅[Google Maps Javascript API V3 参考](https://developers.google.com/maps/documentation/javascript/reference#Marker)

# ruby-on-rails-3 - Rail3 button_to 远程自定义操作

> ID：10755257
> 
> 赞同：0
> 
> 时间：2012-05-25T13:27:05.067
> 
> 标签：ruby-on-rails-3

我想在尝试时使用自定义远程操作制作按钮

```
<%= button_to "something", {:controller => :updates, :action => :new}, {:remote => true} %> 
```

它工作正常，但如果我将 :action 更改为我自己在控制器中定义的操作

```
<%= button_to "something", {:controller => :updates, :action => :destroy_all, :method => :delete}, {:remote => true} %> 
```

表单中生成的路径是错误的

```
<form action="/assets?action=destroy_all&controller=updates&method=delete" class="button_to" data-remote="true" method="post"> 
```

在 updates_controller 我定义了 :destroy_all

```
def destroy_all
    #some spaghetti code
end 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:47:18.307

查看[API](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to)。`:method`属于,`html_options`不属于`options`:

```
<%= button_to "something", {:controller => :updates, :action => :destroy_all}, {:remote => true, :method => :delete} %> 
```

您还需要在您的路由文件中添加一个指向`"updates#destroy_all"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:53:44.063

问题不在于更改方法名称。您没有正确传递选项。看

```
action="/assets?action=destroy_all&controller=updates&method=delete" 
```

我觉得这不是你想要的。尝试

```
<%= button_to "smth", {:controller => :updates, :method => :destroy_all}, {:remote => true, :method => :delete} %> 
```

或者

```
<%= button_to "smth", '/updates/destroy_all', {:remote => true, :method => :delete} %> 
```

小心使用方法 delete =)

# android - 画廊不响应使用 xy 的触摸事件

> ID：10755258
> 
> 赞同：1
> 
> 时间：2012-05-25T13:27:06.990
> 
> 标签：android, monkeyrunner

我只是使用 chimchat 来做 android UI 自动化。一切都很顺利，除了当我使用 xy 位置从画廊触摸图像时，有什么不同吗？有人帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:30:04.847

也许尝试使用`monkeydevice.press(x,y,MonkeyDevice.DOWN)`then`sleep(.1)`和 finally `monkeydevice.press(x,y,MonkeyDevice.UP)`。可能是您触摸该位置的时间不够长，无法进行任何注册。

# jquery - 如何在指定了 id 属性的 Jquery Mobile 页面上手动设置 data-url？

> ID：10755262
> 
> 赞同：0
> 
> 时间：2012-05-25T13:27:10.153
> 
> 标签：jquery, jquery-mobile, attributes, data-url

我有点失落...

我需要我的 Jquery Mobile 页面有一个 id，但将 data-url 设置为文件路径。默认情况下，JQM 将文件路径作为**data-url**，但如果提供了 id，则 data-url 将被 id 覆盖，这是我不想要的。

所以：

```
<div id="some" data-role="page"></div> 
```

将导致：

```
<div id="some" data-role="page" data-url="some"></div> 
```

虽然我需要它：

```
<div id="some" data-role="page" data-url="/path/to/this/file.html"></div> 
```

我正在尝试手动设置 data-url，但它不能像这样工作：

```
$('div:jqmData(role="page")')
     .jqmData('url', $.mobile.path.parseUrl( window.location.href ).pathname ) 
```

**问题**：
我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:04:07.687

行。似乎这只能像这样工作：

```
$('div:jqmData(role="page")').attr({'data-url': $.mobile.path.parseUrl( window.location.href ).pathname}); 
```

# java - 立方体渲染：纹理显示不正确

> ID：10755264
> 
> 赞同：2
> 
> 时间：2012-05-25T13:27:15.930
> 
> 标签：java, textures, jmonkeyengine

我试图通过创建彼此相邻的 4 个立方体来渲染墙壁，应用纹理时出现问题 - JME3 确实渲染了立方体并应用了纹理，但我看到了立方体的内部。这是我可以改变的某种形式的“视图”吗？如果是这样，怎么做？

下面是我的意思的代码和图像![在此处输入图像描述](../Images/7aa26727d91e2b915d6cd6c8e472b91c.png)

```
 Box ground = new Box(new Vector3f(1.0f, -1.0f, 1.0f), 5, 0,-5);
    Geometry groundPlane = new Geometry("GroundPlane", ground);
    Material groundMat = new Material(assetManager, "Common/MatDefs/Misc/Unshaded.j3md");
    groundMat.setColor("Color", ColorRGBA.Brown);
    groundPlane.setMaterial(groundMat);

    for(int i = 1; i < 5; i++)
    {
        Box wall = new Box(new Vector3f(0.0f, -1.0f, 0.0f), new Vector3f((float)i, 0.0f, -1.0f));
        Geometry wallFace = new Geometry("WallMesh", wall);
        Material wallSkin = new Material(assetManager, "Common/MatDefs/Misc/Unshaded.j3md");
        Texture tex_ml = assetManager.loadTexture("Interface/Wall.png");
        wallSkin.setTexture("ColorMap", tex_ml);
        wallFace.setMaterial(wallSkin);
        rootNode.attachChild(wallFace);            
    }

    rootNode.attachChild(groundPlane); 
```

亲切的问候

艾登·斯特莱多姆

***完成 - 最终代码***

```
 Vector3f oldVec = Vector3f.ZERO;
    Vector3f newVec = Vector3f.ZERO;

    for(int i = 0; i < 5; i++)
    {
        newVec = new Vector3f((float)i, 0.0f, 0.0f);
        Box wall = new Box(oldVec, newVec);
        Geometry wallFace = new Geometry("WallMesh", wall);
        Material wallSkin = new Material(assetManager, "Common/MatDefs/Misc/Unshaded.j3md");
        wallSkin.setTexture("ColorMap", tex_ml);
        wallFace.setMaterial(wallSkin);
        //wallSkin.getAdditionalRenderState().setWireframe(true);
        oldVec = new Vector3f((float)i, -1.0f, -1.0f);
        rootNode.attachChild(wallFace);            
    }

    rootNode.attachChild(groundPlane); 
```

![在此处输入图像描述](../Images/d7f7e92715411e236900c4f262bd707b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T08:21:32.743

看起来你的法线指向相反的方向。检查您的渲染引擎以查看您是否具有反向法线功能，或者您需要以相反的顺序提供顶点。

或者试试这个方法

```
Box wall = new Box(new Vector3f(i, 0.0f, 0.0f), 1.0f, 1.0f, 1.0f); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:06:49.437

这个`Box`类是你自己的，还是 jmonkey 提供的？

如果它是你自己的，你的三角形缠绕顺序似乎会被翻转。

# javascript - 使用 jquery 更改多个图像大小

> ID：10755267
> 
> 赞同：1
> 
> 时间：2012-05-25T13:27:37.040
> 
> 标签：javascript, jquery, css

我有以下html：

```
 <div id="ProductImages" align="center">
     <div id="divProductPicZ72" class="c1"></div>

      <div id="divProductPic72">
        <a href="javascript:void(0);" onclick=
        "popupimg('images/Product/large/72.jpg');"><img border="0" id="ProductPic72" name=
        "ProductPic72" class="c2" onclick="popupimg('images/Product/large/72.jpg')" title=
        "Click here to view larger image" src="images/product/medium/72_1_.png" alt=
        "SK100DS" /></a>
      </div>

    <img border="0" class="c2" onclick="setcolorpicidx_72(1);" alt="Show Picture 1"
          src="images/PRODUCT/icon/72_1_.png" /><img border="0" class="c2" onclick=
          "setcolorpicidx_72(2);" alt="Show Picture 2" src=
          "images/PRODUCT/icon/72_2_.png" />

    <img border="0" class="c2" onclick="setcolorpicidx_72(3);" alt="Show Picture 3" src=
          "images/PRODUCT/icon/72_3_.png" />

    <img border="0" class="c2" onclick="setcolorpicidx_72(4);" alt="Show Picture 4" src=
          "images/PRODUCT/icon/72_4_.png" />

    <img border="0" class="c2" onclick="setcolorpicidx_72(5);" alt="Show Picture 5" src=
          "images/PRODUCT/icon/72_5_.png" />

    <img border="0" class="c2" onclick="setcolorpicidx_72(6);" alt="Show Picture 6" src=
          "images/PRODUCT/icon/72_6_.png" />

    <img border="0" class="c2" onclick="setcolorpicidx_72(7);" alt="Show Picture 7" src=
          "images/PRODUCT/icon/72_7_.png" />
    </div>
</div> 
```

标签后面的 div`<div id="divProductPic72">`是主图片，当您单击它时，我有代码在新窗口中将其弹出更大。

我想注入一些 jquery 来使所有图像更小，因为它们是缩略图。他们在上面的div之后。

我喜欢制作 100x100 的缩略图。

我试过这个：

```
$("div#ProductImages img").css("width", "100px"); 
```

不确定这是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:31:22.450

你需要做两个维度：

```
$("div#ProductImages img").css("width", "100px");
$("div#ProductImages img").css("height", "100px"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:54:15.153

为了仅选择直接子代而不是所有祖先，请使用以下代码段

```
 $("#ProductImages>img") 
```

或者

```
 $("#ProductImages").children("img") 
```

# netty - ChannelBuffer 中的 int 支持

> ID：10755268
> 
> 赞同：0
> 
> 时间：2012-05-25T13:27:37.547
> 
> 标签：netty

编写 DownstreamHandler，我需要将 int 编码为 ChannelBuffer。

ChannelBuffers.copiedBuffer(...) 有一个将字符串转换为缓冲区的方法。

如何将 int 转换为 ChannelBuffer？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:47:34.870

我自己有一个解决方案：

```
final ChannelBuffer myIntBuffer = channel.getConfig().getBufferFactory().getBuffer(4);

myIntBuffer.writeInt(myInt); 
```

希望这是最好/正确的方法。

# mongodb - 在 MongoDb 中使用 $inc 更新多个文档的错误？

> ID：10755272
> 
> 赞同：0
> 
> 时间：2012-05-25T13:27:55.253
> 
> 标签：mongodb, mongodb-.net-driver

我在测试我的应用程序时遇到了奇怪的行为。我有一个更新多个文档的请求，并将其中一个字段增加 1（并将其他字段减少 -1，但不要认为这是重点）。

```
Query = { "_id" : { "$in" : [ObjectId("4fbf8481a975b5237c56f221"),
                             ObjectId("4fbf8481a975b5237c56f222"),
                             ObjectId("4fbf8481a975b5237c56f223")] } };
Update = { "$inc" : { "PartlyCompleted" : -1, "Completed" : 1 } } 
```

第一个文档更新正常，但其他两个不受影响。

可能是什么原因。请给我建议在哪里看。

一些额外的信息。我正在使用 C# 官方驱动程序。这是一些代码：

```
_personsId = new BsonArray();
_personsId.AddRange(personsId.Where(x => DataService.IsIdValid(x)).
                              Select(x => new ObjectId(x)).ToArray());

var query = Query.In("_id", _personsId);
var update = Update.Combine(
                    Update.Inc("Completed", 1 ),
                    Update.Inc("PartlyCompleted", -1));

DataService.PersonSet.Collection.Update(query, update); 
```

我还检查了下面查询返回的文档数，它是 3：

```
 var count = DataService.PersonSet.Collection.Count(query); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:39:30.107

默认情况下，更新只影响第一个匹配的文档。

因此，在您的示例中，mongo 选择这 3 个文档之一并递增计数器。要更新多个文档，您需要设置`UpdateFlags.Multi`标志。

我很好奇，您是否在其他更新中使用此标志？如果是，为什么要问这个问题？如果不是，您确定这些更新会同时涉及多个文档吗？

# ios - 在 iOS 上使用多个崩溃报告器

> ID：10755278
> 
> 赞同：13
> 
> 时间：2012-05-25T13:28:24.510
> 
> 标签：ios, service, crash-reports, testflight

我们成功地使用[TestFlightLive](https://testflightapp.com/sdk/live/)作为我们的崩溃报告器，但我认为缺少一些功能。这些缺失的功能在另一个崩溃报告器中：[Crashlytics](http://www.crashlytics.com)，但到目前为止我还不想完全切换崩溃报告器。所以我想知道是否可以在一个应用程序中同时使用这两个崩溃报告器（这意味着将来会出现在应用程序商店中）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-21T03:41:03.497

我同时运行 TestFlight 和 Crashlytics，它们都报告错误。就像上面[Jens Kohl](https://stackoverflow.com/users/408150/jens-kohl)所说的，它必须在初始化 TestFlight SDK 之后包含在内。这是我的代码：

```
#ifdef DEBUG
    // setup testflight if in debug (ie dev) mode
    [TestFlight takeOff:kTestFlightAPIKey];
#endif

    [Crashlytics startWithAPIKey:kCrashlyticsAPIKey]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T22:32:20.930

您只能使用 1 个崩溃报告框架。捕获崩溃的框架让另一个框架要么无法捕获它，要么得到错误的数据，因为线程上已经执行了新代码。

# ios - Google iOS API Auth2 登录黑屏

> ID：10755281
> 
> 赞同：9
> 
> 时间：2012-05-25T13:28:33.443
> 
> 标签：ios, xcode, google-api, youtube-api

对于我的生活，我无法弄清楚这一点。我按照此博客[http://hoishing.wordpress.com/2011/08/23/gdata-objective-c-client-setup-in-xcode-4/](http://hoishing.wordpress.com/2011/08/23/gdata-objective-c-client-setup-in-xcode-4/)上的说明帮助我在 youtube 上设置共享视频。但是，在我能够分享视频之前，我需要用户能够登录谷歌并获得许可。但是，只会弹出一个空白屏幕。我在错误中注意到我收到此错误“缺少 GTMOAuth2ViewTouch.nib”。

```
NSLog(@"PostVideoToYoutube");
    GTMOAuth2ViewControllerTouch *viewController;
    viewController = [[[GTMOAuth2ViewControllerTouch alloc] initWithScope:kMyscope
                                                                 clientID:kMyClientID
                                                             clientSecret:kMyClientSecret
                                                         keychainItemName:kKeychainItemName
                                                                 delegate:self
                                                         finishedSelector:@selector(viewController:finishedWithAuth:error:)] autorelease];

    [ITVC presentModalViewController:viewController animated:YES]; 
```

谁能指出我为什么没有显示谷歌登录页面的正确方向？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-12T21:40:19.753

老问题，但这是任何卡住的人的答案：

虽然您的项目目录中可能有 GTMOAuth2ViewTouch.xib 文件，但您需要将其添加到“编译源”中。

单击您的项目设置>“构建阶段”选项卡，然后单击“编译源”下的“+”图标。在这里添加“GTMOAuth2ViewTouch.xib”。

构建，运行，快乐的日子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T22:11:46.557

以下是我用来让它工作的步骤。我在我的项目中引用 libGDataTouchStaticLib.a 和 GData 项目。

1.  在 XCode 中，按住 Control 键单击您想要 .xib 的组
2.  选择将文件添加到“我的项目”...
3.  选择“GData Sources/Common/Optional/OAuth2/iOS/GTMOAuth2ViewTouch.xib”并单击添加。.xib 将被添加到您项目的 Copy Bundle Resources
4.  清理、构建、运行、测试。

感谢@DexCurl 的回答，因为它让我朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T07:07:25.170

正如您猜想的那样，听起来视图缺少它的 nib 文件。

您需要添加`GTMOAuth2ViewTouch.xib`（不是 xib，不是 nib 扩展名；虽然它们被称为“nib”文件，但它们很久以前已更改为 XML 格式，因此实际扩展名是 xib）。

您引用的博客文章似乎缺少该步骤。请参阅此处的 GTM 说明： [http ://code.google.com/p/gtm-oauth2/wiki/Introduction#Adding_the_Controllers_to_Your_Project](http://code.google.com/p/gtm-oauth2/wiki/Introduction#Adding_the_Controllers_to_Your_Project)

# php - Virtuemart 不适用于多家制造商

> ID：10755283
> 
> 赞同：0
> 
> 时间：2012-05-25T13:28:41.467
> 
> 标签：php, joomla, e-commerce, virtuemart

我正在使用 joomla2.5 和 meadowmart2 创建一个电子商务网站。当我添加新产品时，我无法为产品选择多个制造商。

我不知道破解源代码究竟需要哪个文件。

这里我修改了位置中的html集成部分

管理员/组件/com_virtuemart/views/product/tmpl/product_information.html 第 92 行

```
<?php if(isset($this->lists['manufacturers'])){?>
<tr class="row<?php echo $i?>">
<td width="21%" ><div style="text-align:right;font-weight:bold;">
<?php echo JText::_('COM_VIRTUEMART_MANUFACTURER'); echo'test-aaaaaaaaaa'; ?></div></td>
<td width="79%"><?php //echo $this->lists['manufacturers'];?>                       
<select class="inputbox" id="manufacturers" name="manufacturers[]" multiple="multiple" size="10">
<option value=""><?php echo $this->lists['manufacturers']; ?></option></select>                     </td></tr> 
```

但我无法从数据库中计算制造商列表。我不知道要更改哪个文件的源代码。有知道的请回复我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:25:38.613

看看这个：

[http://forum.virtuemart.net/index.php?topic=100170.0](http://forum.virtuemart.net/index.php?topic=100170.0)

我将它应用到我的美德市场中，并作为一种魅力发挥作用。我要开一家书店。我已将所有作者添加为制造商，现在通过此更改，我可以将多个制造商（在我的情况下为作者）添加到一本书中，就像添加多个类别一样。我认为它是你需要的。

# php - MSSQL 和 PHP：“向 sqlsrv_query 传递了一个无效参数。”

> ID：10755284
> 
> 赞同：4
> 
> 时间：2012-05-25T13:28:42.017
> 
> 标签：php, sql-server, object, sql-update

我正在尝试通过 PHP 运行一个非常简单的 MSSQL 更新语句，但我收到一条错误消息：*“An invalid parameter was passed to sqlsrv_query.”*

这是我正在使用的[连接类，最相关的是查询功能：](http://pastebin.com/3j4zmHJY)

```
function query($query) {
    $result = sqlsrv_query($query) or die( print_r( sqlsrv_errors(), true));
} 
```

最后，这是我用来尝试执行语句的代码：

```
$db = new mssqlClass();
$conn = $db->connect();

$SQL = "UPDATE table SET Title = 'Test' where ID = 1"
$SQL = $db->query($SQL); 
```

如果有人有任何建议，我将不胜感激，我想这是连接类的问题，但我不确定。谢谢！

（编辑）为了在此处发布而尝试编辑所有内容，我不知何故错过了我的陈述中的“哪里”，啊！对不起。不用说**查询很好，当复制到 SQL Server Studio Manager 中时执行没有任何问题**。干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T14:33:48.820

我不喜欢回答我自己的问题，但由于我一开始问这个问题时搞得一团糟，我希望这对任何从谷歌看到这个问题的人都有帮助。

与 mssql_query 不同，较新的 sqlsrv_query 函数需要将连接参数作为第一个变量传入，如下所示：

```
$result = sqlsrv_query($this->connection, $query) or die( print_r( sqlsrv_errors(), true)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:30:14.727

我相信您缺少 WHERE 关键字。是不是应该说：

```
UPDATE table SET Title = 'Test' WHERE ID = 1 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:30:37.630

尝试

```
 UPDATE table SET Title = 'Test', ID = 1 
```

你错过了逗号“，”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T13:32:41.793

我认为您正在尝试其中任何一个

```
UPDATE table SET Title = 'Test' WHERE ID = 1 
```

或者

```
UPDATE table SET Title = 'Test', ID = 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-15T09:07:09.600

这是一个旧的解决方案：

```
$result = sqlsrv_query($this->connection, $query) or die( print_r( sqlsrv_errors(), true)); 
```

但两年后救了我几英里！

# namespaces - XSD 导入命名空间

> ID：10755288
> 
> 赞同：2
> 
> 时间：2012-05-25T13:29:01.023
> 
> 标签：namespaces, xsd, xml-namespaces

我有两个 xsd 文件“first.xsd”和“second.xsd”。

在 second.xsd 中，我想引用 first.xsd 中定义的元素（具有不同的命名空间）。
我的 second.xsd 看起来像：

```
<xs:schema ... xmlns:schema1="http://www.schema.org/schema1" targetNamespace "http://www.schema.org/schema2   ...  >
<xs:import namespace = "http://www.schema.org/schema1" schemaLocation = "first.xsd" />

<xs:element name = "complex1">
<xs:complexType>
.........
<xs:element ref="schema1:name2"/>
.........
</xs:complexType>
</xs:element> 
```

现在我想在 first.xsd 中包含和导入 second.xsd 所以我在 first.xsd 中执行以下操作：

```
<xs:schema ... xmlns:schema2="http://www.schema.org/schema2" targetNamespace "http://www.schema.org/schema1  ... >
<xs:import namespace="http://www.schema.org/schema2" schemaLocation="second.xsd">
<xs:element name = "name1"/>
<xs:element name = "name2"/>
<xs:element name = "name3"/> 
```

这是正确的方法吗，因为我无法成功验证架构。
由于某些循环命名空间包含，这是一个问题吗？
我正在使用氧气 xml 开发人员来验证架构文件，并且我的 first.xsd 验证后说：
E[Xerces] src-resolve：无法将名称解析为 a(n) 类型定义组件。(第二个.xsd)

但是，如果我单独验证 second.xsd 文件，它会说架构有效。

在我的实际情况中，我有一个非常复杂的场景，因此我将其归结为一个简单的示例，如上所示。
有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:52:29.140

拥有这种循环依赖是完全有效的（尽管值得商榷）；您的架构集无法验证的原因不可能是它；您必须检查架构处理器生成的错误并尝试理解其中的每一个。人们普遍认为，最好从第一条错误消息开始。

您的代码段无效，因为您引用了`element2`未在**schema1**中列出的（在 second.xsd 中） 。这是一种无法通过验证的东西，因此请关注它们。

如果您需要帮助以了解真正的问题是什么，请首先使用实际的错误消息更新您的帖子。

# objective-c - UITableView 委托如何向 tableview 发送消息？

> ID：10755291
> 
> 赞同：0
> 
> 时间：2012-05-25T13:29:10.510
> 
> 标签：objective-c, uitableview, delegates

所以我有一个采用 UITableViewDelegate 的视图控制器：

```
@interface MyViewController:UIViewController<UITableViewDelegate>
@property (weak, nonatomic) IBOutlet UITabelView *myTableView;
@end 
```

在实现文件 MyViewController.m 中，我覆盖

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{} 
```

我的问题是，表格视图行的高度如何返回到 myTableView 并进一步设置每个单独行的高度？

编辑：为了清楚起见，我尝试在我自己的自定义视图类中实现此机制，其中要求特定信息来布置视图。我使用 UITabelView 本身没有问题。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:06:20.377

您的问题不是很清楚，但 UITableView 中向代表询问单元格高度的代码就是这样的。

```
CGFloat thisCellHeight = [self.delegate tableView:self heightForRowAtIndexPath:thisCellIndexPath]; 
```

它向代表发送一条消息并询问...

# python - 在python的列表中拆分元素

> ID：10755292
> 
> 赞同：1
> 
> 时间：2012-05-25T13:29:12.733
> 
> 标签：python

假设我有一个列表，例如：

```
lst = ["Line1\r\nLine2\r\n", "Line3\r\nLine4\r\n", etc.] 
```

有没有一种很好的pythonic方法来分割行尾的元素并使它们成为单独的元素，即

```
new_lst = ["Line1\r\n", "Line2\r\n", "Line3\r\n", "Line4\r\n"] 
```

我知道我可以有几行额外的代码来循环遍历列表，拆分元素并将它们存储在一个新列表中，但我对 python 比较陌生，想养成使用所有很酷的功能，例如列表推导。提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T13:35:25.107

```
>>> lst = ["Line1\r\nLine2\r\n", "Line3\r\nLine4\r\n"]
>>> new_lst = [elem for l in lst for elem in l.splitlines(True)]
>>> new_lst
['Line1\r\n', 'Line2\r\n', 'Line3\r\n', 'Line4\r\n'] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-25T13:33:50.620

```
import itertools as it
list(it.chain(*(elem.splitlines(True) for elem in lst))) 
```

或者

```
[line for elem in lst for line in elem.splitlines(True)] 
```

两者都返回：`['Line1\r\n', 'Line2\r\n', 'Line3\r\n', 'Line4\r\n']`

来自文档：

```
S.splitlines([keepends]) -> list of strings

Return a list of the lines in S, breaking at line boundaries.
Line breaks are not included in the resulting list unless keepends
is given and true. 
```

这适用于`\r\n`以及`\r`和`\n`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:34:19.513

```
new_lst = [x + '\r\n' for x in ''.join(lst).split('\r\n')][:-1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:15:35.687

为了完整起见，让我们添加这个丑陋的解决方案；）

```
new_lst = ('\r\n'.join(lst)).splitlines(True) 
```

# php - Facebook JSON 页面提要

> ID：10755296
> 
> 赞同：0
> 
> 时间：2012-05-25T13:29:25.837
> 
> 标签：php, facebook-graph-api

我需要从 Facebook 页面（不是墙）提取时间线提要我有 SDK 等。什么是正确的代码，我需要什么权限，因为这不起作用？

```
include('src/facebook.php');
$fb_config = array(
        'appId'  => 'XXXX',
        'secret' => 'XXXXXXXXX'
);
$facebook = new Facebook($fb_config);
$feed = $facebook->api("/{PageID/feed");
print_r($feed); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:40:28.787

这在 Graph API [Page 对象](https://developers.facebook.com/docs/reference/api/page/#feed)文档中进行了解释。您需要拥有当前用户的访问令牌，并在请求`/feed`页面连接时使用它。现在所有页面都是这种情况。

# silverlight - 在 Silverlight 中显示图像（绑定）

> ID：10755305
> 
> 赞同：1
> 
> 时间：2012-05-25T13:30:14.097
> 
> 标签：silverlight, image, upload

我需要解决以下问题：在 Silverlight 应用程序中，用户需要能够将图像上传到客户端（而不是服务器）。图像应显示在包装面板中。

我是 silverlight 的新手，所以您可能会在代码中发现几个错误。下面我贴出代码，希望足以回答问题！

应用程序.xaml：

```
<Application xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
             xmlns:local="clr-namespace:Dojo_3_wi10b012.ViewModel"
             x:Class="Dojo_3_wi10b012.App"
             >
    <Application.Resources>
        <local:ViewModel x:Key="viewModel"/>
    </Application.Resources>
</Application> 
```

MainPage.xaml：

```
<UserControl x:Class="Dojo_3_wi10b012.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"

    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"         
    xmlns:navigation="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Navigation"
    xmlns:local="clr-namespace:Dojo_3_wi10b012.ViewModel"

    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">

    <Grid x:Name="LayoutRoot" Background="White" DataContext="{StaticResource viewModel}">
        <sdk:Frame  Height="350" Width="450" 
                   Name="frameContainer" Margin="0,0,0,0">
        </sdk:Frame>

        <Button Content="Add Image" Command="{Binding Path=AddImageCommand}" Height="23" HorizontalAlignment="Left" Margin="468,454,0,0" Name="buttonAddImage" VerticalAlignment="Top" Width="75" />

    </Grid>
</UserControl> 
```

图库.xaml：

```
<navigation:Page x:Class="Dojo_3_wi10b012.View.Gallery" 
           xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
           xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
           xmlns:d="http://schemas.microsoft.com/expression/blend/2008"

           xmlns:navigation="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Navigation"
           xmlns:sys="clr-namespace:System;assembly=mscorlib"
           xmlns:local="clr-namespace:Dojo_3_wi10b012.ViewModel"

           xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
           mc:Ignorable="d"

           d:DesignWidth="640" d:DesignHeight="480"
           Title="Gallery Page"
           NavigationCacheMode="Required" xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit">
   <!-- trying to implement Mr. Eckkrammer's hint (wiki)-->
    <UserControl.Resources>
        <DataTemplate x:Key="galleryTemplate">
            <Image>
                <Image.Source>
                    <BitmapImage UriSource="{Binding Image}"/>
                </Image.Source>
            </Image>
        </DataTemplate>
    </UserControl.Resources>
   <!-- END OF trying to implement Mr. Eckkrammer's hint (wiki)--> 

        <Grid x:Name="LayoutRoot" Height="350" Width="450" Background="Beige" DataContext="{StaticResource viewModel}">
       <!-- "First attempt
        <ItemsControl ItemsSource="{Binding ElementName=ImageDescrList, Path=Image ,Mode=TwoWay}" >

            <ScrollViewer Width="449" Height="349" Margin="1,1,0,0">
                <toolkit:WrapPanel  Orientation="Horizontal" ItemWidth="90" ItemHeight="90" Width="Auto" />
            </ScrollViewer>
        </ItemsControl>

        -->

        <!-- 2nd attempt (Mr. Eckkrammer's hint (wiki): -->
        <ItemsControl ItemsSource="{Binding ElementName=ImageDescrList}" ItemTemplate="{StaticResource galleryTemplate}">
            <ScrollViewer Width="449" Height="349" Margin="1,1,0,0">
                <toolkit:WrapPanel  Orientation="Horizontal" ItemWidth="90" ItemHeight="90" Width="Auto" />
            </ScrollViewer>
        </ItemsControl>

    </Grid>
</navigation:Page> 
```

图像描述.cs：

```
namespace Dojo_3_wi10b012.Model
{
    public class ImageDescription : INotifyPropertyChanged
    {

        private string _description;
        private BitmapImage _image;

        public string Description
        {
            get { return _description; }
            set
            {
                _description = value;
                NotifyPropertyChanged("Description");
            }
        }

        public BitmapImage Image
        {
            get { return _image; }
            set
            {
                _image = value;
                NotifyPropertyChanged("Image");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void NotifyPropertyChanged(string propName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propName));
        }
    }
} 
```

ViewModel.cs：

```
using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using System.IO;
using System.IO.IsolatedStorage;
using System.Windows.Media.Imaging;
using System.Collections;
using System.Collections.ObjectModel;
using Dojo_3_wi10b012.Model;
using System.ComponentModel;

namespace Dojo_3_wi10b012.ViewModel
{
    public class ViewModel : INotifyPropertyChanged
    {
        public RelayCommand AddImageCommand { get; private set; }
        private ObservableCollection<ImageDescription> _imageDescrList = new ObservableCollection<ImageDescription>();

        #region properties

        public ObservableCollection<ImageDescription> ImageDescrList
        {
            get { return _imageDescrList; }
            set
            {
                _imageDescrList = value;
                NotifyPropertyChanged("ImageDescrList");
            }
        }

        #endregion

        #region Constructor

        public ViewModel()
        {
            AddImageCommand = new RelayCommand(AddImage);
            AddImageCommand.IsEnabled = true;
        }
        #endregion

        #region private methods

        private void AddImage()
        {
            //initial ideas: (copy paste + modified from source: http://msdn.microsoft.com/en-us/library/cc221415(v=vs.95).aspx )

            // Create an instance of the open file dialog box.
            OpenFileDialog openFileDialog1 = new OpenFileDialog();

            // Set filter options and filter index.
            openFileDialog1.Filter = "JPEG Files (.jpg)|*.jpg|PNG Files (.png)|*.png|GIF Files (.gif)|*.gif|BMP Files (.bmp)|*.bmp|TIFF Files (.tiff)|*.tiff";
            openFileDialog1.FilterIndex = 1;

            openFileDialog1.Multiselect = false;

            // Call the ShowDialog method to show the dialog box.
            bool? userClickedOK = openFileDialog1.ShowDialog();

            // Process input if the user clicked OK.
            if (userClickedOK == true)
            {

                // Open the selected file to read.
                using (var filestream = openFileDialog1.File.OpenRead())
                {
                    var buffer = new byte[filestream.Length];
                    filestream.Read(buffer, 0, buffer.Length);
                    //add the image to our list of images
                    MemoryStream ms = new MemoryStream(buffer, 0, buffer.Length);
                    BitmapImage temp = new BitmapImage();
                    temp.SetSource(ms);

                    ImageDescrList.Add(
                        new ImageDescription()
                        {
                          //  Description = filestream.Name,
                            Description="Default Description",
                            Image = temp
                        }
                    );
                    ms.Close();
                    filestream.Close();

                }

            }

        }
        #endregion

        #region event Handler (property changed)
        public event PropertyChangedEventHandler PropertyChanged;

        protected void NotifyPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:18:57.063

在您的 galleryTemplate 模板中尝试此操作以将图像源绑定到您的位图：

```
<DataTemplate x:Key="galleryTemplate">
     <Image Source="{Binding Image}"/>
</DataTemplate> 
```

您似乎正在尝试将位图 UriSource 绑定到位图（这需要一个 Uri）：

```
 <DataTemplate x:Key="galleryTemplate">
      <Image>
           <Image.Source>
               <BitmapImage UriSource="{Binding Image}"/>
           </Image.Source>
      </Image>
 </DataTemplate> 
```

# php - PHP array_push 在while 循环中创建一个数组级别太多？

> ID：10755310
> 
> 赞同：0
> 
> 时间：2012-05-25T13:30:28.153
> 
> 标签：php, arrays, while-loop

我将尝试解释这一点而不会引起任何混淆，首先是相关代码：

```
$week_start_dates = array($start_of_last_week, $start_of_last_week_last_year, $start_of_previous_week);
$week_end_dates   = array($end_of_last_week, $end_of_last_week_last_year, $end_of_previous_week);
$weekname         = array('TW', 'LY', 'PW'); 
```

基本上，这些数组包含的是以下查询的开始日期和结束日期：

```
$leads = array();

for ($i = 0; $i < sizeof($week_start_dates) ; $i++)
{
        $sql = '
    SELECT
        email.country,
            email_dailytotal.summarydate,   
            sum(email_dailytotal.conversions) as leads      
        FROM email_dailytotal
            left join email on email.email_id = email_dailytotal.email_id
            left join email_type on email.type = email_type.type_id
        WHERE                
            email_dailytotal.summarydate >= "' . $week_start_dates[$i] . '" and email_dailytotal.summarydate <= "' . $week_end_dates[$i]  . '" and email.business = "' . $business .'" and email.business_division = "' . $businessdivision .'"
    GROUP BY email.country
    ';

$dbresult = mysql_query($sql);

while($results = mysql_fetch_array($dbresult)) {
        $country        = $results['country'];
        $no_leads       = $results['leads'];

        array_push($leads, array(
            $country => array(
               $weekname[$i]=>$no_leads
            )
        ));
} 
```

输出如下：

```
[0] => Array
    (
        [uk] => Array
            (
                [TW] => 10334
            )

    )

[1] => Array
    (
        [de] => Array
            (
                [TW] => 315
            )

    )

 [2] => Array
    (
        [uk] => Array
            (
                [LY] => 18579
            )

    )

[3] => Array
    (
        [de] => Array
            (
                [LY] => 401
            )

    )

    [4] => Array
    (
        [uk] => Array
            (
                [PW] => 13410
            )

    )

etc... 
```

当我喜欢它时：

```
[0] => Array
    (
        [uk] => Array
            (
                [TW] => 10334
                [LY] => 18579
                [PW] => 13410
            )

    etc...

    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:32:46.443

尝试将其更改为：

```
$leads[$country] = array(
           $weekname[$i]=>$no_leads
        ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:37:13.413

```
while($results = mysql_fetch_array($dbresult)) {
        $country        = $results['country'];
        $no_leads       = $results['leads'];

        if( !isset($leads[$country]) ){
            $leads[$country] = array();
        }
        $leads[$country][$weekname[$i]] = $no_leads;
} 
```

# android - 列表视图打乱自定义组件视图

> ID：10755318
> 
> 赞同：0
> 
> 时间：2012-05-25T13:31:17.333
> 
> 标签：android, android-listview, android-custom-view

我正在使用自定义视图组件来绘制一个饼图（一个简单的饼图）。每个列表项都有一个具有不同值的饼图。

现在，当我在列表视图中使用它时，饼图的值会被打乱，有时不会更新。我的默认饼图值为 1。当我第一次打开列表时，第一项显示正确的值，其余列表项仅显示默认值 1，而不管实际值如何。

当我滚动列表时，饼图会得到值，但会被打乱。第一项的值为 5th ， 2nd 的值为 3rd ， 3rd 的值为其他值。

自定义视图代码：

```
 public class PieRating extends View{
    private float Rate;
    private Paint p;
    private int startX;
    private int startY;
    private int radius;
    private ArrayList<Integer> colors;
    private ArrayList<Float> values;
    Bitmap bitmap;
    Context mContext;
    public PieRating(Context context, AttributeSet attrs) {
        super(context, attrs);

        Rate=1;
        mContext = context;

        p = new Paint();
        p.setAntiAlias(true);

        colors = new ArrayList<Integer>();
        values = new ArrayList<Float>();

        startX = 0;
        startY = 0;
        radius = 20;

        colors.add(Color.GRAY);
        colors.add(Color.TRANSPARENT);

        values.add(Rate);
        values.add(5 - Rate);

    }

    public void setRating(float Rate) {
        this.Rate = Rate;
        values.clear();
        values.add(Rate);
        values.add(5 - Rate);

    }

    public float getRating(){
        return Rate;

    }

    @Override
    protected void onDraw(Canvas canvas) {

        float offset = 0;
        float sum = 0;
        for (int a = 0; a < values.size(); a++) {
            sum += values.get(a);
        }

        float angle = (float) (360 / sum);

        RectF rectF = new RectF();
        rectF.set(getStartX(), getStartY(), getStartX() + getRadius(),
                getStartY() + getRadius());

        for (int i = 0; i < values.size(); i++) {

            p.setColor(colors.get(i));

            if (i == 0) {
                canvas.drawArc(rectF, 270, values.get(i) * angle, true, p);
            } 
            else {
                canvas.drawArc(rectF, offset, values.get(i) * angle, true, p);
            }

            offset += (values.get(i) * angle + 270);
        }

        canvas.save();

    }

    public int getStartX() {
        return startX;
    }

    public void setStartX(int startX) {
        this.startX = startX;
    }

    public int getStartY() {
        return startY;
    }

    public void setStartY(int startY) {
        this.startY = startY;
    }

    public int getRadius() {
        return radius;
    }

    public void setRadius(int radius) {
        this.radius = radius;
    }

    public ArrayList<Integer> getColors() {
        return colors;
    }

    public void setColors(ArrayList<Integer> colors) {
        this.colors = colors;
    }   

    public ArrayList<Float> getValues() {
        return values;
    }

    public void setValues(ArrayList<Float> values) {
        this.values = values;
    }
} 
```

还有我的清单

```
public View getView(int position, View convertView, ViewGroup parent) {

PieRating pr =((PieRating)findViewById(R.id.score_pie_container));
            try
            {
            float rating = Float.parseFloat(JSONHelper.getString(mRestaurants, "restaurants.restaurant[].opinion.general", new int[] { position }));
            pr.setRating(rating);
            }
            catch (Exception e) {
                // TODO: handle exception
            }
} 
```

设置评分后尝试调用`pr.invalidate`，但效果不佳。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T18:09:40.243

愚蠢的错误

`((PieRating)convertView.findViewById(R.id.score_pie_container))`

我错过了`convertView`部分..

留下答案以防万一有人遇到类似问题

# tridion - 组件模板和页面模板需要 TBBS 以实现具有组件链接的组件的 SiteEdit

> ID：10755319
> 
> 赞同：0
> 
> 时间：2012-05-25T13:31:18.153
> 
> 标签：tridion, tridion-2011

我正在 Tridion 2011 SP1 和 SiteEdit 2012 中处理 Dreamweaver 模板。

我的组件有组件链接。我也想为组件链接启用 SitEdit。

我编写了一个组件模板来从链接组件中获取值，并在主组件模板构建块中引用它。

我的主要组件 CT 具有以下模板构建块。

```
Dreamweaver TBB(Referring to Component link CT internally)
Enable Inline Editing for the Component
Default Finish Actions. 
```

页TBB是这样的

```
<html>
   <head></head>
   <body>
      @@RenderComponentPresentation("ComponentID","ComponentTemplateID")@@
   </body>
</html> 
```

页面模板具有以下块：

```
Page TBB
Enable Inline Editing for the Page
Default Finish Actions 
```

预览页面时，我可以看到 SiteEdit 标签。我还可以从组件链接中看到内容。

但是当我发布页面时，我无法编辑内容。

我是否需要在任何块中添加任何模板构建块或任何修改？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:07:05.797

> 但是当我发布页面时，我无法编辑内容。

您的发布目标是否为 Tridion UI 2012 正确配置（**不是**SiteEdit！）

“我无法编辑内容”是什么意思？

*   您没有在左上角看到 SDL Tridion 按钮吗？
*   您看到按钮但单击它会导致错误？
*   您看到组件演示文稿的边框但字段不可编辑？

您是否还在组件演示文稿中添加了“启用组件内联编辑”TBB？

# java - 由于 ProgressDialog 试图绕过 AsyncTask 上的 NetworkOnMainThreadException

> ID：10755322
> 
> 赞同：0
> 
> 时间：2012-05-25T13:31:36.397
> 
> 标签：java, android, android-asynctask, progressdialog

我有以下问题。我正在使用 DropBox SDK 将文件上传到工作正常的 Dropbox。上传文件时（在 AsyncTask 内），将显示带有取消按钮的 ProgressDialog，在这里仍然可以。不能正常工作的是，当按下取消按钮时，会引发 NetworkOnMainThreadException。我是 Android 编程新手，但我怀疑它与构造函数中的 ProgressDialog 有关。因为它不在“doInBackground”部分。

试图通过实现 OnDismissListener 并进行 onDismiss 中止来修复它，但仍然没有运气。调用“mRequest.abort()”时出现错误。提前感谢您的任何答案！

所以这是我的代码

```
public class DropBoxUpload extends AsyncTask<Void, Long, Boolean> implements OnDismissListener {

    private DropboxAPI<?> mApi;
    private String mPath;
    private File mFile;

    private long mFileLen;
    private UploadRequest mRequest;
    private Context mContext;
    private final ProgressDialog mDialog;

    private String mErrorMsg;

    public DropBoxUpload(Context context, DropboxAPI<?> api, String dropboxPath, File file) {

        // We set the context this way so we don't accidentally leak activities
        mContext = context.getApplicationContext();

        mFileLen = file.length();
        mApi = api;
        mPath = dropboxPath;
        mFile = file;

        mDialog = new ProgressDialog(context);
        mDialog.setMax(100);
        mDialog.setMessage("Uploading " + file.getName());
        mDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        mDialog.setProgress(0);
        mDialog.setButton("Cancel", new OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                // This will cancel the putFile operation
                mDialog.dismiss();

            }
        });
        mDialog.setCancelable(true);
        mDialog.setOnDismissListener(this);

        mDialog.show();         
    }

    @Override
    protected Boolean doInBackground(Void... params) {

        try {
            // By creating a request, we get a handle to the putFile operation,
            // so we can cancel it later if we want to
            FileInputStream fis = new FileInputStream(mFile);
            String path = mPath + mFile.getName();
            mRequest = mApi.putFileOverwriteRequest(path, fis, mFile.length(),
                    new ProgressListener() {
                @Override
                public long progressInterval() {
                    // Update the progress bar every half-second or so
                    return 500;
                }

                @Override
                public void onProgress(long bytes, long total) {
                    publishProgress(bytes);
                }
            });

            if (mRequest != null) {
                mRequest.upload();
                return true;
            }

        } catch (DropboxUnlinkedException e) {
            // This session wasn't authenticated properly or user unlinked
            mErrorMsg = "This app wasn't authenticated properly.";
        } catch (DropboxFileSizeException e) {
            // File size too big to upload via the API
            mErrorMsg = "This file is too big to upload";
        } catch (DropboxPartialFileException e) {
            // We canceled the operation
            mErrorMsg = "Upload canceled";
        } catch (DropboxServerException e) {
            // Server-side exception.  These are examples of what could happen,
            // but we don't do anything special with them here.
            if (e.error == DropboxServerException._401_UNAUTHORIZED) {
                // Unauthorized, so we should unlink them.  You may want to
                // automatically log the user out in this case.
            } else if (e.error == DropboxServerException._403_FORBIDDEN) {
                // Not allowed to access this
            } else if (e.error == DropboxServerException._404_NOT_FOUND) {
                // path not found (or if it was the thumbnail, can't be
                // thumbnailed)
            } else if (e.error == DropboxServerException._507_INSUFFICIENT_STORAGE) {
                // user is over quota
            } else {
                // Something else
            }
            // This gets the Dropbox error, translated into the user's language
            mErrorMsg = e.body.userError;
            if (mErrorMsg == null) {
                mErrorMsg = e.body.error;
            }
        } catch (DropboxIOException e) {
            // Happens all the time, probably want to retry automatically.
            mErrorMsg = "Network error.  Try again.";
        } catch (DropboxParseException e) {
            // Probably due to Dropbox server restarting, should retry
            mErrorMsg = "Dropbox error.  Try again.";
        } catch (DropboxException e) {
            // Unknown error
            mErrorMsg = "Unknown error.  Try again.";
        } catch (FileNotFoundException e) {
        } 

        return false;
    }

    @Override
    protected void onProgressUpdate(Long... progress) {
        int percent = (int)(100.0*(double)progress[0]/mFileLen + 0.5);
        mDialog.setProgress(percent);
    }

    @Override
    protected void onPostExecute(Boolean result) {
        mDialog.dismiss();          
    }

    @Override
    public void onDismiss(DialogInterface arg0) {
        // TODO Auto-generated method stub
        mRequest.abort();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:46:21.787

您无法`mRequest`从主 UI 线程访问该对象，因为它负责网络操作。这就是为什么`NetworkOnMainThreadException`当你打电话时你会得到一个`mRequest.abort()`。

您应该修改代码，以便在取消对话框时使用，并在任务取消时定期[`AsyncTask.cancel`](http://developer.android.com/reference/android/os/AsyncTask.html#cancel%28boolean%29)检查并调用。`isCancelled``doInBackground``mRequest.abort()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:45:11.837

您应该调用取消方法来停止上传过程。

```
ast.cancel(true); 
```

ast 是你的 asynctask 对象

# c# - 使用 @Html.HiddenFor 渲染隐藏的表单字段

> ID：10755323
> 
> 赞同：1
> 
> 时间：2012-05-25T13:31:38.593
> 
> 标签：c#, asp.net-mvc-3, nullable, datetime-format

```
public class SearchForm {

     //Note: Property is nullable 
     public DateTime? CurrentViewDate {get;set;}       
     public DateTime  StartDate {get;set;}
}

//In the controller     
//[GET] 
public ActionResult Index()
{
}

//[POST]    
public ActionResult Index(SearchForm formModel)
{
     if(formModel.CurrentViewDate == null)            
        formModel.CurrentViewDate = DateTime.Now.AddDays(1d);
     else
        formModel.CurrentViewDate = formModel.CurrentViewDate.AddDays(1d);

    formModel.StartDate = DateTime.Now;   

}

//In view
@Html.HiddenFor(c => c.CurrentViewDate).
<input id="SearchForm_CurrentViewDate" name="SearchForm.CurrentViewDate" 
       type="hidden" value="5/25/2012 11:59:59 PM" />
<input type="submit" name="btnNext" id="btnNext" value="Go Increment" /> 
```

但是，当我单击提交时，值确实会增加，但隐藏的字段保留以前的值，它显示正确值的唯一方法是如果这样做 @Html.HiddenFor(c => c.CurrentViewDate.Value) ，然后打开重新发布 formModel.CurrentViewDate 具有空值，因为绑定名称不同。

有任何想法吗？感觉像是从 StartDate 属性而不是 CurrentViewDate 属性获取日期时间值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:38:49.873

如果您打算修改它，则需要从 ModelState 中删除该值：

```
public ActionResult Index(SearchForm formModel)
{
    ModelState.Remove("CurrentViewDate");

    if(formModel.CurrentViewDate == null)            
    {
        formModel.CurrentViewDate = DateTime.Now.AddDays(1d);
    }
    else
    {
        formModel.CurrentViewDate = formModel.CurrentViewDate.AddDays(1d);
    }

    return View(model);
} 
```

您需要这样做的原因是因为所有 Html 帮助程序（例如 TextBoxFor、HiddenFor、CheckBoxFor、...）在绑定它们的值时首先查看 ModelState，然后再查看模型。此行为是设计使然。因此，由于在您的 POST 操作中，ModelState （随请求发送的那个）中已经有一个值，因此正在使用这个值。

每次您尝试在 POST 控制器操作中修改视图模型上的某些属性并期望此更改反映在值中时，请不要忘记 ModelState。

# jquery - 在分组行中输入 jqgrid 链接

> ID：10755325
> 
> 赞同：0
> 
> 时间：2012-05-25T13:31:43.917
> 
> 标签：jquery, jqgrid

*   **429900**
*   合同单位行动
*   C1 10 显示
*   C2 20 显示
*   C3 25 显示
*   C4 25 显示
*   **80**

我想将显示链接添加到分组标题行，即**429900 - 显示**和/或操作列中的分组页脚（在总共 80 个组的单元格旁边）。

提前致谢

# php - 使用 `.htaccess` 在 url 末尾添加 `.php`

> ID：10755326
> 
> 赞同：-3
> 
> 时间：2012-05-25T13:31:46.960
> 
> 标签：php, .htaccess

我如何`.php`在 url 末尾添加使用`.htaccess`以下是 .htaccess 代码

## .htaccess

```
<IfModule mod_rewrite.c>
# Enable Rewriting
RewriteEngine on

RewriteRule ^search/(.*)/?$ search.php?loc=$1

</IfModule> 
```

## 搜索.php

如果网址是

```
search.php?loc=miami

echo "Location : " . $_GET['loc'];

output: Location : miami 
```

但到底怎么可能得到`search.php/miami.php`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:35:53.490

```
RewriteRule ^search\.php/(.+)\.php$ search.php?loc=$1 
```

# backbone.js - 应该如何使用 MVC 在 javascript 应用程序中组织规范文件

> ID：10755328
> 
> 赞同：6
> 
> 时间：2012-05-25T13:31:52.340
> 
> 标签：backbone.js, jasmine

我想知道您对如何使用 MVC（例如骨干网）在大型 Web 应用程序中组织文件/目录的看法。
我会做以下（*）。请告诉我你的意见。

* * *

( * )

```
js
js/models/myModel.js
js/collections/myCollection.js
js/views/myView.js
spec/model/myModel.spec.js
spec/collections/myCollection.spec.js
spec/views/myView.spec.js 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:45:44.510

这就是我传统上组织文件的方式。但是，我发现对于较大的应用程序，让所有内容保持组织、唯一命名等确实变得很痛苦。我一直在做的一种“新”方式是按功能而不是类型来组织我的文件。因此，例如：

```
js/feature1/someView.js
js/feature1/someController.js
js/feature1/someTemplate.html
js/feature1/someModel.js 
```

但是，通常有您需要的全局“事物”，例如“用户”或用户构建的位置集合。所以：

```
js/application/model/user.js
js/application/collection/location.js 
```

向我建议这种模式是因为您可以使用 requirejs 轻松处理功能集、打包和部署它们。它还减少了功能集之间发生依赖关系的可能性，因此如果您想删除一个功能或使用全新的代码更新它，您可以只替换一个“stuff”文件夹，而不是寻找每个文件。此外，在 IDE 中，它只会使您正在处理的文件更容易找到。

我的两分钱。

编辑：规范文件呢？

一些想法 - 你只需要选择我认为对你来说最自然的一个。

1.  您可以对规范文件遵循相同的“功能文件夹”模式。好处是所有规格都在一个地方。缺点是现在，就像您当前所做的一样，您必须为一个功能的文件放置位置。
2.  您可以将规格放在功能文件夹的“规格”文件夹中。好处是您现在拥有可以打包在单个 zip 文件中的实际包，而不会破坏其他工作。为编写测试找到直接相关的文件也更容易——它们都在同一个父文件夹中。缺点是现在您的生产代码和测试代码在同一个文件夹中，将其（可能）发布到世界各地。当然，您可能最终会在某个时候将生产 javascript 编译成一个文件。所以我不确定这是一个很大的问题。
3.  我的建议 - 如果这是一个大型应用程序，并且您认为您将有几只手接触文件，请在文件夹中保留类似“package.json/yml/xml”的文件。在那里，列出测试所需的生产、规范和任何数据文件（您很可能可以编写一个快速的 shell 脚本来为您执行此操作）。然后编写一个快速脚本来查看您的源文件夹中的“package.whateverYouChose”文件，获取测试文件，然后使用它构建您的单元测试页面。因此，假设您添加了另一个包.. 运行“updateSpecRunner”或您命名脚本的任何名称，它会为您生成另一个 SpecRunner.html 文件（或您命名的运行规范的文件）。然后你可以在浏览器中手动测试它，或者使用 phantomjs/rhino 自动化它。

那有意义吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:35:12.950

你可以找到一个很好的例子来组织你的应用程序到这个链接

[骨干茉莉花示例](https://github.com/froots/backbone-jasmine-examples)

它看起来或多或少像您的实现。

# core-data - NSManagedObjectContext：撤消保存操作？

> ID：10755332
> 
> 赞同：3
> 
> 时间：2012-05-25T13:32:03.900
> 
> 标签：core-data, ios5, nsundomanager

我想撤消我的 NSManagedObjectContext 上的保存操作；我一直认为，这就是 NSUndoManager 的用途，但似乎撤消保存操作不起作用......

一个例子：

```
[[NSManagedObjectContext MR_contextForCurrentThread] setUndoManager:[NSUndoManager new]];
[[NSManagedObjectContext MR_contextForCurrentThread].undoManager beginUndoGrouping];
MyDataObject *mdo = [MyDataObject MR_createInContext:[NSManagedObjectContext MR_contextForCurrentThread]];
mdo.name = @"...";
[[NSManagedObjectContext MR_contextForCurrentThread] save:nil];
[[NSManagedObjectContext MR_contextForCurrentThread].undoManager endUndoGrouping];
[[NSManagedObjectContext MR_contextForCurrentThread].undoManager undo]; 
```

但是插入并没有撤消......有没有办法做到这一点？比如交易？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T11:26:24.353

您是否可以使用子托管对象上下文进行保存（将其推送到父对象，但不触及磁盘上的文件），然后如果您想撤消它，则对父对象进行回滚？

我认为调用`save`就像提交自上次保存以来所做的所有更改，并且`rollback`就像丢弃它们一样。一旦您提交了更改，它们就在持久存储中，并且没有任何东西保存事务日志以支持回滚。

你能解释一下为什么你想要`save`在你的交易中间有一个吗？

# java - 获取事务中的所有插入 ID

> ID：10755334
> 
> 赞同：0
> 
> 时间：2012-05-25T13:32:10.573
> 
> 标签：java, mysql, transactions, last-insert-id

我在 MySQL 数据库中有两个表：“messages”和“message_tags”。“messages”表有一个自动增量列“message_id”。在 Java 中，我想使用 java.sql 包向数据库添加一批消息。我想在一个事务中执行此操作以保存查询。

我的 SQL 代码应如下所示：

```
START TRANSACTION
INSERT INTO messages(`message`) VALUES ('message1');
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagfoo1');
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagbar1');
INSERT INTO messages(`message`) VALUES ('message2');
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagfoo1');
INSERT INTO messages(`message`) VALUES ('message3');
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagfoo2');
...
COMMIT 
```

是否有可能以某种方式将所有新生成的 id 从消息表中返回给 java，使它们可以与原始消息匹配？像这样的东西：

```
message1 => 1234
message2 => 1235
message3 => 1236
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:43:18.733

你没有指定它是静态的还是动态的，但我想你可以使用这样的东西：

```
START TRANSACTION
INSERT INTO messages(`message`) VALUES ('message1');
@message1:=last_insert_id();
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagfoo1');
@message2:=last_insert_id();
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagbar1');
@message3:=last_insert_id();
INSERT INTO messages(`message`) VALUES ('message2');
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagfoo1');
@message4:=last_insert_id();
INSERT INTO messages(`message`) VALUES ('message3');
INSERT INTO messages_tags(`message_id`, `tags`) VALUES (LAST_INSERT_ID(), 'tagfoo2');
@message5:=last_insert_id();
...
COMMIT 
```

如果你做

```
select @message1; 
```

结果是 1234，所以你有

```
@message1 => 1234
@message2 => 1235
@message3 => 1236
... 
```

但是您必须手动指定 SQL 变量，至少您创建一个过程或一个函数。

# php - 添加到 JSON 字符串的字符

> ID：10755335
> 
> 赞同：1
> 
> 时间：2012-05-25T13:32:15.087
> 
> 标签：php, javascript, jquery, json

我正在使用`jQuery.parseJSON()`解析从`jQuery.ajax()`调用到 PHP 脚本的响应。该代码有效，但在某些服务器上，字符`0000`插入到响应字符串的开头导致`jQuery.parseJSON()`失败。

我不知道这些字符是如何插入的，有什么想法吗？在回显响应之前，这些字符不在 PHP 编码的字符串中。

这是场景：

PHP 脚本使用以下命令创建 JSON 字符串：

```
$html = json_encode(myArrayOfValues);
echo $html 
```

jQuery.ajax 在以下位置接收编码字符串：

```
....success: function(html, textStatus){
        var response = jQuery.parseJSON(html);
.... 
```

为了解决这个问题，我添加了删除插入字符并更改的功能：

```
var response = jQuery.parseJSON(html); 
```

至：

```
var response = parseJSONResponse(html); 
```

在哪里：

```
function parseJSONResponse(html){

    var foundChar =  html.indexOf("{");

    if(foundChar > 0 ){
        html = html.substring(foundChar);
    }

    var response = jQuery.parseJSON(html);

    return response;
} 
```

最终，它可以工作，但我想知道插入的字符来自哪里，以及是否有办法阻止它们被插入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:38:54.943

这可能是与字符编码相关的问题。\u0000 是 NULL 字符。尽管这可能只是巧合，但似乎值得研究。

我认为 json 的首选字符编码是 utf-8。尝试将此添加到调用页面的顶部，看看它是否解决了问题：

```
<meta charset="utf-8"> 
```

希望有帮助！

# nsis - NSIS 脚本未安装在正确的目录中

> ID：10755338
> 
> 赞同：1
> 
> 时间：2012-05-25T13:32:18.937
> 
> 标签：nsis, system32, syswow64

我正在尝试制作安装脚本：

*   在 32 位电脑上：tapi_32bits.tsp 在`C:\windows\system32`
*   在 64 位电脑上：tapi_64bits.tsp`C:\Windows\System32`和 tapi_32bits.tsp`C:\Windows\SysWOW64`

这是我写的脚本：

```
; The name of the installer
Name "TAPI Installer"

; The file to write
OutFile "TAPI Installer"

; The default installation directory
InstallDir $DESKTOP

;--------------------------------

; Install to the correct directory on 32 bit or 64 bit machines
Section
IfFileExists $WINDIR\SYSWOW64\*.* Is64bit Is32bit
Is32bit:
    ; Set output path to the installation directory.
    SetOutPath $SYSDIR

    ; Put file there
    File tapi_32bits.tsp

;   SectionEnd MessageBox MB_OK "32 bit"
        SetRegView 32
        StrCpy $INSTDIR "$PROGRAMFILES32\LANDesk\Health Check"
    GOTO End32Bitvs64BitCheck

Is64bit:
    ; install in  C:\Windows\System32
    SetOutPath $WINDIR\System32\

    ; file to put there
    File tapi_64bits.tsp

    ; install in C:\Windows\SysWOW64
    SetOutPath $WINDIR\SysWOW64

    ; file to put there
    File tapi_32bits.tsp

    ;SectionEnd MessageBox MB_OK "32 bit"
        SetRegView 32
        StrCpy $INSTDIR "$PROGRAMFILES32\LANDesk\Health Check"
        GOTO End32Bitvs64BitCheck    
    MessageBox MB_OK "64 bit"
        SetRegView 64
        StrCpy $INSTDIR "$PROGRAMFILES64\LANDesk\Health Check"

End32Bitvs64BitCheck:
SectionEnd
;-------------------------------- 
```

但在 64 位电脑上，它将两个文件（tapi_64bits.tsp 和 tapi_32bits.tsp）都放在 Syswow64 文件夹中。安装程序确实说它安装在正确的文件夹中，但两个文件都在 Syswow64 文件夹中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T20:06:02.090

NSIS 是一个 32 位应用程序，因此它受[文件重定向](http://msdn.microsoft.com/en-us/library/aa384187%28v=vs.85%29.aspx)的影响。

您必须使用[x64.nsh](http://nsis.sourceforge.net/Include/x64.nsh)，它具有检测 WOW64 并禁用重定向的代码（尽快将其重新打开）。另一种选择是提取到，`$windir\sysnative`但这更像是一种破解，不适用于 XP 64。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T17:09:17.243

以下代码应该可以工作。

```
!include x64.nsh    
; Install to the correct directory on 32 bit or 64 bit machines
Section
${If} ${RunningX64}
; install in  C:\Windows\System32
SetOutPath $WINDIR\System32\

; file to put there
File tapi_64bits.tsp

; install in C:\Windows\SysWOW64
SetOutPath $WINDIR\SysWOW64

; file to put there
File tapi_32bits.tsp
${Else}
; Set output path to the installation directory.
SetOutPath $SYSDIR
; Put file there
File tapi_32bits.tsp
${EndIf}
SectionEnd 
```

# c++ - OpenGL - 渲染成纹理

> ID：10755345
> 
> 赞同：5
> 
> 时间：2012-05-25T13:32:40.127
> 
> 标签：c++, opengl, buffer, textures

我希望能够在 OpenGL 上将某些东西渲染到纹理中，这样我就可以随时进一步使用它，而无需重新渲染所有内容。这个网站[在这里](http://steinsoft.net/index.php?site=Programming/Code%20Snippets/OpenGL/no9)给了我做这件事的指导方针，而不使用 FrameBuffer。由于兼容性问题，我不想使用 FrameBuffer 对象，因为这台旧机器不支持它。我已经完成了一些代码，它创建了我的纹理，渲染了我的场景，然后我创建了一个 Quad 来在其上渲染纹理。唯一的问题是纹理被渲染为“Alpha Mask”，这意味着，看起来它只考虑了 Alpha 值，保持我的矩形始终具有相同的颜色，但只是改变像素的透明度。这是我到目前为止所做的一些代码：

```
void CreateTexture ()
{
    xSize = 512;
    ySize = 512; //size of texture
//new array
    char* colorBits = new char[ xSize * ySize * 3 ];
//texture creation..
    glGenTextures(1,&texture);
    glBindTexture(GL_TEXTURE_2D,texture);
    glTexImage2D(GL_TEXTURE_2D,0 ,3 , xSize,
                 ySize, 0 , GL_RGB,
                 GL_UNSIGNED_BYTE, colorBits);
//you can set other texture parameters if you want
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER, GL_LINEAR);
//clean up
    delete[] colorBits;
} 
```

然后：

```
int viewport[4];
    glGetIntegerv(GL_VIEWPORT,(int*)viewport);
    glViewport(0,0,xSize,ySize);

    DrawScene(hDC);

    //save data to texture using glCopyTexImage2D
    glBindTexture(GL_TEXTURE_2D,texture);

    glCopyTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA,
                     0,0, xSize, ySize, 0);
    glClearColor(.0f, 0.5f, 0.5f, 1.0f);                // Set The Clear Color To Medium Blue
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glViewport(viewport[0],viewport[1],viewport[2],viewport[3]);
    // glBindTexture(GL_TEXTURE_2D,texture); 
```

最后：

```
glEnable(GL_TEXTURE_2D);                    // Enable 2D Texture Mapping
        glBlendFunc(GL_DST_COLOR,GL_ONE);               // Set Blending Mode
        glEnable(GL_BLEND);

        glClear(GL_COLOR_BUFFER_BIT);
        glBindTexture(GL_TEXTURE_2D,texture);

        glRotatef(theta, 0.0f, 0.0f, 0.01f);
        glBegin(GL_QUADS);
         //Front Face
        glTexCoord2f(0.0f, 0.0f);
        glVertex3f(-0.5, -0.5f,  0.5f);
        glTexCoord2f(1.0f, 0.0f);
        glVertex3f( 0.5f, -0.5f,  0.5f);
        glTexCoord2f(1.0f, 1.0f);
        glVertex3f( 0.5f,  0.5f,  0.5f);
        glTexCoord2f(0.0f, 1.0f);
        glVertex3f(-0.5f,  0.5f,  0.5f);
        glEnd();
        SwapBuffers(hDC); 
```

DrawScene() 函数简单地渲染一个矩形，上面有一个三角形，每个顶点都有不同的颜色……没什么特别的。

```
glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
glClear(GL_COLOR_BUFFER_BIT );//| GL_DEPTH_BUFFER_BIT);

glPushMatrix();
//    glRotatef(theta, 0.0f, 0.0f, 1.0f);

glBegin(GL_QUADS);
glColor3f(1.0f, 0.0f, 0.0f);
glVertex3f(-1.0f, -1.0f,  1.0f);
glColor3f(0.0f, 1.0f, 0.0f);
glVertex3f( 1.0f, -1.0f,  1.0f);
glColor3f(0.0f, 0.0f, 1.0f);
glVertex3f( 1.0f,  1.0f,  1.0f);
glColor3f(1.0f, 1.0f, 1.0f);
glVertex3f(-1.0f,  1.0f,  1.0f);
glEnd();

glBegin(GL_TRIANGLES);

glColor3f(1.0f, 0.0f, 0.0f);
glVertex2f(0.0f,   1.0f);
glColor3f(0.0f, 1.0f, 0.0f);
glVertex2f(0.87f,  -0.5f);
glColor3f(0.0f, 0.0f, 1.0f);
glVertex2f(-0.87f, -0.5f);
glEnd();
glPopMatrix(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T09:44:56.923

我在 nVidia 网站上找到了一些看起来很有用的东西，对于那些不能使用 FBO 进行屏幕外渲染的人来说：

[http://developer.download.nvidia.com/SDK/9.5/Samples/samples.html](http://developer.download.nvidia.com/SDK/9.5/Samples/samples.html)

这个网站包含一个名为“Simple P-Buffer”的项目，它基本上包含了一个P-buffer的实现。该示例的想法是您将上下文切换到 pBuffer，而您想在屏幕外模式下绘制像素，比方说。使用普通渲染函数绘制场景后，我们使用 glReadPixels 将数据从 pBuffer 读取到无符号字节数组 (GLubyte) 中。之后，我们再次进行上下文切换，将其设置回屏幕上下文，以便您可以使用 glReadPixels 从我们的数组中读取内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:05:01.723

在 FBO 可用之前的方法是使用备用渲染缓冲区（[请参阅，然后将像素从该缓冲区（`glDrawBuffer(GL_AUX0)`](http://www.opengl.org/sdk/docs/man/xhtml/glDrawBuffer.xml)[请参阅`glReadBuffer`](http://www.opengl.org/sdk/docs/man/xhtml/glReadBuffer.xml)）复制到纹理（[请参阅`glCopyTexImage2D`](http://www.opengl.org/sdk/docs/man/xhtml/glCopyTexImage2D.xml)。直接渲染到纹理中需要 FBO。

# bash - mysqldump 数据库名称中带有空格的数据库

> ID：10755349
> 
> 赞同：0
> 
> 时间：2012-05-25T13:32:42.637
> 
> 标签：bash, mysqldump

我正在构建一个备份脚本以在某些服务器上使用。问题是我有一个包含空格的数据库，`" aa_something_something"`. 这可能是设置中的一个错误，但我没有足够的信息来做出删除它的合格决定，所以我只是将它包含在备份中。

这是我当前的 mysqldump 调用：

```
mysqldump -B $db -u$DB_USER -p$DB_PASS --skip-lock-tables 2>> $ERROR_LOG_FILE 
```

由于空间在开头，mysqldump 认为我要备份`"aa_something_something"`而不是`" aa_something_something"`. 无论如何要转义变量内的空格吗？我试过`'`and `"`，但没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:39:48.657

只是引用它：

```
mysqldump -B "$db" ... 
```

但唯一长期明智的做法是删除该空间并修复使用该奇怪名称的地方。

另外，请确保您可以从该备份中恢复，然后再进行任何激进的操作。那个空白可能会搞砸任何事情。

# spring - Mybatis 配置 typeAliases

> ID：10755351
> 
> 赞同：1
> 
> 时间：2012-05-25T13:32:47.117
> 
> 标签：spring, mybatis

我正在开发一个基于 Mybatis 3.0.5、Mybatis-spring 1.0.1 和 Spring 3.0.5.RELEASE 的 Java EE 应用程序，我发现在 mybatis-config.xml 中使用 Alias 存在问题。痕迹是：

> org.springframework.beans.factory.BeanCreationException：
> 在 ServletContext 资源 [/WEB-INF/applicationContext.xml] 中定义名称为“sqlSessionFactory”的 bean 创建错误：
> 调用 init 方法失败；嵌套异常是 org.springframework.core.NestedIOException:
> 无法解析配置资源: 类路径资源 [mybatis-config.xml]; 嵌套异常是 org.apache.ibatis.builder.BuilderException:
> Error parsing SQL Mapper Configuration。原因：org.apache.ibatis.builder.BuilderException：
> 为“accesoUsuario”注册 typeAlias 时出错。原因：java.lang.ClassNotFoundException：
> 找不到类：[PACKAGE OMITTED BY ME].AccesoUsuario

我该如何解决这个问题？

这是我的 mybatis-config.xml ( **MYPACKAGE = es.my.package** )。

```
 <settings>
     <setting name="lazyLoadingEnabled" value="false" />
  </settings>

<typeAliases>
    <typeAlias alias="accesoUsuario" type="MYPACKAGE.persistencia.entidades.AccesoUsuario" />
    <typeAlias alias="agrupacion" type="MYPACKAGE.persistencia.entidades.Agrupacion" />
    <typeAlias alias="consulta" type="MYPACKAGE.persistencia.entidades.Consulta" />
    <typeAlias alias="consultaDim" type="MYPACKAGE.persistencia.entidades.ConsultaDim" />
    <typeAlias alias="consultaFiltro" type="MYPACKAGE.persistencia.entidades.ConsultaFiltro" />
    <typeAlias alias="dato" type="MYPACKAGE.persistencia.entidades.Dato" />
    <typeAlias alias="dimension" type="MYPACKAGE.persistencia.entidades.Dimension" />
            <typeAlias alias="dominio" type="MYPACKAGE.persistencia.entidades.Dominio" />
            <typeAlias alias="dominioDep" type="MYPACKAGE.persistencia.entidades.DominioDep" />
            <typeAlias alias="entidad" type="MYPACKAGE.persistencia.entidades.Entidad" />
    <typeAlias alias="error" type="MYPACKAGE.persistencia.entidades.ErrorProceso" />
    <typeAlias alias="informe" type="MYPACKAGE.persistencia.entidades.Informe" />
    <typeAlias alias="informeCabecera" type="MYPACKAGE.persistencia.entidades.InformeCabecera" />
    <typeAlias alias="informeSeccion" type="MYPACKAGE.persistencia.entidades.InformeSeccion" />
    <typeAlias alias="restriVariable" type="MYPACKAGE.persistencia.entidades.RestriVariable" />
    <typeAlias alias="usuario" type="MYPACKAGE.persistencia.entidades.Usuario" />
    <!-- ... -->
            <typeAlias alias="cadena" type="java.lang.String" />
</typeAliases> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:31:33.987

您的包不适用于 myBatis。您需要使用配置定义它：

```
<bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
    <property name="basePackage" value="es.your.packacke"/>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:56:14.173

在没有看到一些实际源代码的情况下，我怀疑我们能否查明任何错误，但[看看 DZone 上的这个示例](http://java.dzone.com/articles/getting-started-ibatis-mybatis)可能会有所帮助。

他们特别指出的一件事是，如果您没有遵循 mybatis-config.xml 文件中的正确顺序，可能会导致异常。可能是该文件中的某些内容位于错误的位置。

如果您想发布更多代码，我可以尝试提供更多帮助。

# prolog - 如何在 Strawberry Prolog 中导入谓词？

> ID：10755352
> 
> 赞同：2
> 
> 时间：2012-05-25T13:32:47.317
> 
> 标签：prolog

我想包含其他文件中的一些谓词。例如文件“task2”

```
nsk(A,B,NSK) :-nsd(A,B,NSD),NSK is (A*B)/NSD.

?- nsk(16,4,NSK),write(NSK). 
```

如何从文件“task11”中包含“nsd”谓词？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:27:56.000

假设谓词在文件中定义，`task11.pl`您应该能够发出

```
 ?- consult([task11]). 
```

# python - Omnicomplete 包含文档中的函数定义

> ID：10755355
> 
> 赞同：1
> 
> 时间：2012-05-25T13:32:59.580
> 
> 标签：python, vim, omnicomplete

使用 Omnicomplete for Python 时，如何在 Vim 中显示函数描述？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:03:20.720

它开箱即用:)

您需要拥有的一切：

*   vim 用`+python`选项编译。
    你可以用`vim --version`. 如果您在 Linux 上工作，大多数发行版在其软件包中默认启用此选项，或者提供增强版的 vim 软件包（vim-ext、exvim...）。
    如果您在 Windows 上工作，那么您可以下载[cream](http://cream.sourceforge.net/)，它是*“强大而著名的 Vim 的现代配置”*。它与使用有趣选项编译的 vim 捆绑在一起，例如`+python`
*   然后只需打开您的 .py 文件并 在您处于单词中间时键入`C-x C-o`（C 是**control ）。**
    将触发弹出窗口并打开新的缓冲区窗口，其中包含所选完成的文档。

```
import sys
sys.ver|      # | is a cursor position, press here C-x C-o 
```

您应该完成`version`和`version_info` ![全完成图像快照](../Images/25d1d739c14536f23d6ce143b961c0c7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:14:54.503

我找到了一个插件（python 模式），它可以完成上述操作，包括参考等。它没有任何依赖关系，并且具有文档窗口和运行时按钮。链接在这里：[https ://github.com/klen/python-mode](https://github.com/klen/python-mode)

感谢大家！

# java - Guava：分离器并考虑逃跑？

> ID：10755365
> 
> 赞同：4
> 
> 时间：2012-05-25T13:34:00.703
> 
> 标签：java, guava

我对番石榴的分裂可能性感兴趣：

```
Splitter.on("|").split("foo|bar|baz");
// => "foo", "bar", "baz" 
```

这可以正常工作。

现在如果我想在“|”上拆分怎么办 但不在“[”和“]”之间：

```
Splitter.on(something).split("foo|ba[r|ba]z");
// => "foo", "ba[r|ba]z" 
```

据我了解，不可能在番石榴中定义这个“东西”。

我发现了这个： [Issue 799: Add google escape library to Guava](http://code.google.com/p/guava-libraries/issues/detail?id=799)。这有关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:28:20.160

处理这个问题的正确方法是制作一个解析器。现在真的很容易，只需使用解析器组合器，例如 JParsec。你会得到这样的东西：

```
class ParserFactory {

    Parser escapedSequence() {
        return Parsers.between(Scanners.string("["), 
            Scanners.anyCharacterButNot("]"), Scanners.string("]"));
    }

    Parser chunk() {
        return Parsers.or(escapedSequence(), Scanners.anyCharacterButNot("|"));
    }

    Parsers wholeThing() {
        return Parsers.separatedBy(chunk().plus(), Scanners.string("|"));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T14:11:52.833

这是适用于给定用例的代码（使用现有的 Splitter 代码作为参考）

```
public class Splitter {
private final CharMatcher trimmer;
private final CharMatcher startTextQualifier;
private final CharMatcher endTextQualifier;
private final Strategy strategy;

private Splitter(Strategy strategy, CharMatcher trimmer, CharMatcher startTextQualifier, CharMatcher endTextQualifier) {
    this.strategy = strategy;
    this.trimmer = trimmer;
    this.startTextQualifier = startTextQualifier;
    this.endTextQualifier = endTextQualifier;
}

private Splitter(Strategy strategy) {
    this(strategy, CharMatcher.NONE, CharMatcher.NONE, CharMatcher.NONE);
}

public Splitter trimResults(CharMatcher trimmer) {
    checkNotNull(trimmer);
    return new Splitter(strategy, trimmer, startTextQualifier, endTextQualifier);
}

public Splitter ignoreIn(CharMatcher startTextQualifier, CharMatcher endTextQualifier) {
    checkNotNull(startTextQualifier);
    checkNotNull(endTextQualifier);
    return new Splitter(strategy, trimmer, startTextQualifier, endTextQualifier);
}

public Splitter ignoreIn(char startTextQualifier, char endTextQualifier) {
    return ignoreIn(CharMatcher.is(startTextQualifier), CharMatcher.is(endTextQualifier));
}

public Splitter trimResults() {
    return trimResults(CharMatcher.WHITESPACE);
}

public static Splitter on(final CharMatcher separatorMatcher) {
    checkNotNull(separatorMatcher);

    return new Splitter(new Strategy() {
        @Override public SplittingIterator iterator(Splitter splitter, final CharSequence toSplit) {
            return new SplittingIterator(splitter, toSplit) {
                @Override int separatorStart(int start) {
                    boolean wrapped = false;
                    for (int i = start; i < toSplit.length(); i++) {
                        /**
                         * Suppose start text qualifier = '[' and end text qualifier = ']' then following code
                         * doesn't address cases for multiple start-end combinations i.e it doesn't see whether
                         * end is properly closed e.g. for configuration like - {@code
                         * Splitter.on("|")..ignoreIn('[', ']').split("abc|[abc|[def]ghi]|jkl")
                         * results -> abc, [abc|[def]ghi], jkl
                         }
                         */
                        if (!wrapped && startTextQualifier.matches(toSplit.charAt(i))) {
                            wrapped = true;
                        } else  if (wrapped && endTextQualifier.matches(toSplit.charAt(i))) {
                            wrapped = false;
                        }
                        if (!wrapped && separatorMatcher.matches(toSplit.charAt(i))) {
                            return i;
                        }
                    }
                    return -1;
                }

                @Override int separatorEnd(int separatorPosition) {
                    return separatorPosition + 1;
                }
            };
        }
    });
}

public static Splitter on(final String separator) {
    checkArgument(!separator.isEmpty(), "The separator may not be the empty string.");
    checkArgument(separator.length() <= 2, "The separator's max length is 2, passed - %s.", separator);
    if (separator.length() == 1) {
        return on(separator.charAt(0));
    }
    return new Splitter(new Strategy() {
        @Override public SplittingIterator iterator(Splitter splitter, CharSequence toSplit) {
            return new SplittingIterator(splitter, toSplit) {
                @Override public int separatorStart(int start) {
                    int delimiterLength = separator.length();
                    boolean wrapped = false;

                    positions:
                    for (int p = start, last = toSplit.length() - delimiterLength; p <= last; p++) {
                        for (int i = 0; i < delimiterLength; i++) {
                            if (startTextQualifier.matches(toSplit.charAt(i))) {
                                wrapped = !wrapped;
                            }
                            if (!wrapped && toSplit.charAt(i + p) != separator.charAt(i)) {
                                continue positions;
                            }
                        }
                        return p;
                    }
                    return -1;
                }

                @Override public int separatorEnd(int separatorPosition) {
                    return separatorPosition + separator.length();
                }
            };
        }
    });
}

public static Splitter on(char separator) {
    return on(CharMatcher.is(separator));
}

public Iterable<String> split(final CharSequence sequence) {
    checkNotNull(sequence);

    return new Iterable<String>() {
        @Override public Iterator<String> iterator() {
            return spliterator(sequence);
        }
    };
}

private Iterator<String> spliterator(CharSequence sequence) {
    return strategy.iterator(this, sequence);
}

private interface Strategy {
    Iterator<String> iterator(Splitter splitter, CharSequence toSplit);
}

private abstract static class SplittingIterator extends AbstractIterator<String> {
    final CharSequence toSplit;
    final CharMatcher trimmer;
    final CharMatcher startTextQualifier;
    final CharMatcher endTextQualifier;

    /**
     * Returns the first index in {@code toSplit} at or after {@code start}
     * that contains the separator.
     */
    abstract int separatorStart(int start);

    /**
     * Returns the first index in {@code toSplit} after {@code
     * separatorPosition} that does not contain a separator. This method is only
     * invoked after a call to {@code separatorStart}.
     */
    abstract int separatorEnd(int separatorPosition);

    int offset = 0;

    protected SplittingIterator(Splitter splitter, CharSequence toSplit) {
        this.trimmer = splitter.trimmer;
        this.startTextQualifier = splitter.startTextQualifier;
        this.endTextQualifier = splitter.endTextQualifier;
        this.toSplit = toSplit;
    }

    @Override
    protected String computeNext() {
        if (offset != -1) {
            int start = offset;
            int separatorPosition = separatorStart(offset);
            int end = calculateEnd(separatorPosition);
            start = trimStartIfRequired(start, end);
            end = trimEndIfRequired(start, end);
            if (start != end)
                return toSplit.subSequence(start, end).toString();
        }
        return endOfData();
    }

    private int calculateEnd(int separatorPosition) {
        int end;
        if (separatorPosition == -1) {
            end = toSplit.length();
            offset = -1;
        } else {
            end = separatorPosition;
            offset = separatorEnd(separatorPosition);
        }
        return end;
    }

    private int trimEndIfRequired(int start, int end) {
        while (end > start && trimmer.matches(toSplit.charAt(end - 1))) {
            end--;
        }
        return end;
    }

    private int trimStartIfRequired(int start, int end) {
        while (start < end && trimmer.matches(toSplit.charAt(start))) {
            start++;
        }
        return start;
    }
} 
```

}

小测试——

```
public static void main(String[] args) {
    Splitter splitter = Splitter.on("|").ignoreIn('[', ']');
    System.out.println(Joiner.on(',').join(splitter.split("foo|ba[r|ba]z")));
    // yields -> foo,ba[r|ba]z
} 
```

请注意 - 此代码未经测试，不能解决所有情况，请随时根据您的需要进行修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T20:38:24.623

Guava splitter 非常强大，它可以处理正则表达式分隔符，它可以拆分成地图等等。但是您要实现的目标实际上超出了任何通用解析器的范围。

你想要一个带开/关开关的分离器。我相信这样做的唯一方法是手动，如下所示：

```
 List<String> ls=new ArrayList<String>();
    int b=0;
    int j=0;
    String str="foo|ba[r|ba]z";
    int e=str.indexOf('|');
    do{    

      if(b>j)
      {
      j=str.indexOf('[',j);

      while(j>0 && e>=j){
        j=str.indexOf(']',j);    
        if (j<0){
         ls.add(str.substring(b));
         return ;
         }
        j=str.indexOf('[',j);    
      }
      }
      ls.add(str.substring(b,e));
      System.out.println(str.substring(b,e));
      b=++e;
      e=str.indexOf('|',e);
    } while( e >= 0); 
```

（免责声明：此代码仅用于提供想法，它不起作用）

# perl - 清理庞大的 Perl 代码库

> ID：10755367
> 
> 赞同：6
> 
> 时间：2012-05-25T13:34:04.913
> 
> 标签：perl, web-applications, cgi, code-cleanup

我目前正在开发一个大约有 15 年历史的 Web 应用程序。

它主要包含带有**HTML::Template模板的****CGI** perl 脚本。

 **它有超过 12000 个文件和大约 260 MB 的总代码。我估计需要不超过 1500 个 perl 脚本，并且我想摆脱所有未使用的代码。

实际上没有为代码编写测试。

我的问题是：

*   您是否知道任何**CPAN 模块**可以帮助我获得仅包含`use`d 和`require`d 模块的列表？
*   如果您想摆脱所有额外的代码，您的方法是什么？

我在考虑以下方法：

*   尝试使用在特定位置输出加载的文件名的`use`和`require`perl 内置命令
*   覆盖`warnings`和/或`strict`模块`import`函数并在特定位置输出文件名
*   研究`Devel::Cover`perl 模块并在进行手动测试而不是自动化测试时采用相同的方法并分析代码
*   用自定义的替换 perl 可执行文件，这将记录它读取的每个文件名（我还不知道该怎么做）
*   [`lsof`](http://linux.about.com/library/cmd/blcmdl8_lsof.htm)(?!?)的一些创造性使用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:02:32.940

[Devel::Modlist](http://p3rl.org/Devel%3a%3aModlist)可能会给你你需要的东西，但我从未使用过它。

有几次我需要做这样的事情，我选择了`%INC`在程序结束时检查的更强力的方法。

```
END {
    open my $log_fh, ...;
    print $log_fh "$_\n" for sort keys %INC;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:54:39.863

作为第一个近似值，我会简单地运行

```
egrep -r '\<(use|require)\>' /path/to/source/* 
```

然后花几天时间清理输出。这将为您提供所有使用或需要的模块的列表。

您也可以`@INC`尝试排除某些库路径。

如果您尝试确定执行路径，您可以通过打开“trace”（即调试器中的“t”）的调试器运行代码，然后将输出重定向到文本文件以供进一步分析。我知道在运行 CGI 时这很困难......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T15:31:53.573

假设相关时间戳已打开，您可以检查各种脚本文件的访问时间 - 这应该排除任何未使用的顶级脚本文件。

可能值得向 CGI.pm 添加一些工具来记录当前脚本名称（$0）以查看发生了什么。**

# android - Android中的Tcpreplay？

> ID：10755369
> 
> 赞同：2
> 
> 时间：2012-05-25T13:34:16.210
> 
> 标签：android, pcap, libpcap

我正在执行一些实验，**我想重播以前从 Android 捕获的数据包跟踪**。到目前为止，我已经编写了自己的应用程序来重放跟踪，然后从服务器获得回复。只要在合理范围内（例如，几毫秒），计时精度就不是大问题。

但是，我更喜欢使用经过测试的工具，例如 tcpreplay。**有没有将 tcpreplay 移植到 Android 的项目？**鉴于 libpcap 可用，应该有可用的东西，但我找不到任何东西。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T03:07:32.860

我是 tcpreplay 的作者，我不能说我知道 Android 端口。从来没有拥有过 Android 设备，所以不能说很快就会有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-20T21:23:37.097

我已经在我的选项卡上运行了它，你需要安装 GNUroot 和 Debian no root，它们都来自同一个开发人员...... 得到它之后，打开 GNUroot，检查 emulate new root，创建​​ rootfs 并运行 rootfs，之后这个“apt-get install tcpreplay”。如果你想在 play store 中使用 TpacketCapture 进行抓包，你也可以让 Tpacketcapture Pro 只在一个应用程序中使用抓包。如果您打算破解游戏，请不要发布它，因为这个漏洞可以很容易地修补......任何问题给我发电子邮件。

# javascript - 求当前时间后播放

> ID：10755374
> 
> 赞同：3
> 
> 时间：2012-05-25T13:34:34.650
> 
> 标签：javascript, jquery, html

我正在尝试使用 javascript 控制 html5 视频。我想要的是当用户点击一个按钮时，视频会跳转到另一个帧并从那里继续播放。使用我当前的代码，播放总是在搜索后停止。

```
function jumpToTime(){
    var video = $("video")[0];
    video.currentTime = 160;
    document.getElementbyId("videoclip").play(); //not working
};

//the following code is probably not really related to the question:
var endtimeoffset = 2000;

video.addEventListener("timeupdate", function() {
    if (video.currentTime >= endtimeoffset) {
        video.pause();
    }
}, false); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-24T21:54:20.297

我遇到了类似的问题，并通过暂停视频，然后设置 currentTime，然后播放视频找到了解决方案。要更新您的代码：

```
function jumpToTime(){
    var video = $("video")[0];
    video.pause();
    video.currentTime = 160;
    video.play();
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:05:23.230

我会尝试一些事情：

1.  在 jumpToTime() 函数中，您有两个对假定相同视频的不同引用（一个通过 jQuery 获得，另一个通过 getElementById() 获得）。你确定这些引用的是同一个视频吗？为了安全起见，我只会在您设置 currentTime 的“视频”引用上调用 play()。
2.  这可能是一个复制和粘贴问题，因为如果这在实际代码中，控制台会抱怨，但您确实拼错了 getElementById()（需要大写 B）。
3.  出于调试目的，我将注释掉“timeupdate”事件代码，以确保这不是问题，并且在您更新时间头或调用播放后，此代码不会暂停视频。可能不是，因为您将当前时间设置为远小于您要与之比较的偏移量。但是，将其作为问题的可能原因进行消除将是一个简单的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:26:40.927

```
function jumpToTime(){
   document.getElementById("videoclip").currentTime = 160;
   document.getElementById("videoclip").play(); //not working
}; 
```

getElementbyId --> getElementById -- b --> B

通过 id 获取直接对象...

# php - PHP登录不起作用，并且没有显示错误

> ID：10755384
> 
> 赞同：-1
> 
> 时间：2012-05-25T13:35:33.383
> 
> 标签：php, sql

一段时间以来，我一直在努力解决这个错误。

我已经创建了一个个人资料站点，如果我在本地运行它，登录并重定向到个人资料页面没有问题。

但是很快我上传了它，当我按下登录时没有任何反应。我只是得到一个空页面......但是如果我打开页面源，我可以看到它正在读取我的 init.inc.php 文件。但只是阅读了评论代码。而且由于我不会收到任何错误消息，所以我真的不知道问题出在哪里。

aaa 希望你明白我想说的:)

这是我的登录页面

```
<?php 
 include 'core/inc/init.inc.php';
 if ($_SERVER['HTTP_HOST'] != 'localhost') // running in remote server
    $server = 'pixeltouch2.mysql.domeneshop.no';  
    else // running locally
    $server = 'pixeltouch2.mysql.domeneshop.no';

mysql_connect($server, "LOGIN", "pass") or die(mysql_error());
  mysql_select_db("pixeltouch2") or die(mysql_error()) ;

$errors = array();

if (isset($_POST['username'], $_POST['password'])){
    if(empty($_POST['username'])){
        $errors[] = 'The username cannot be empty.';    
    }
        if(empty($_POST['password'])){
        $errors[] = 'The password cannot be empty.';
    }
//Log in
    if (valid_credentials($_POST['username'], $_POST['password']) == false ){
        $errors[] = 'Username / Password incorrect.';
    }
        if (empty($errors)){
            $_SESSION['username'] = htmlentities($_POST['username']);
            $_SESSION['uid'] = fetch_user_id($_SESSION['username']);

            header("Location: profile.php?uid=" . $_SESSION['uid']);
                die();
                echo $_SESSION['uid'];
        }
}
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
<title>Pixeltouch</title> 

<link rel="stylesheet" type="text/css" href="ext/style.css" />

</head> 
<body> 
<div id="page-wrap"> 
<div id="main-content"> 
<br/>
<?php include_once('template/head.inc.php');
?>
<div id="menu"> 

<?php include_once('template/nav.inc.php');
?> 

</div> 
<!-- SKRIVBOX-->

<div>
<?php 
if(empty($errors) == false){
?>
<ul>

<?php

foreach ($errors as $error) {
    echo "<li>$error</li>";
}

?>
</ul>

<?php

}else{
echo 'Need an account ? <a href="register.php">Register here</a>'; 
}

?>

</div>
<br/>
<form method="post" action="" >
<p>
<label for="username">Username:</label>
<input type="text" name="username" id="username" value="<?php if (isset($_POST['username'])) echo  htmlentities($_POST['username']); ?>" />
</p>
<p>
<label for="password">Password: </label>
<input type="password" name="password"  id="password" />
</p>
<p>
<input type="submit" value="Login" />
</p>

</form>

<!-- SKRIVBOX END-->
</div> 

<?php include_once('template/foot.inc.php');
?>
</div>
</body>
</html> 
```

还有我的 init.inc.php 文件

```
 <?php
     session_start();

/*
     mysql_connect("pixeltouch2.mysql.domeneshop.no", "LOGIN", "PASS") or die(mysql_error()) ; 
     mysql_select_db("pixeltouch2") or die(mysql_error()) ;
     */

     if($_SERVER['HTTP_HOST'] != 'pixeltouch2.mysql.domeneshop.no')// running in remote server
        $server = 'pixeltouch2.mysql.domeneshop.no';  
        else // running locally
        $server = 'pixeltouch2.mysql.domeneshop.no';

    mysql_connect($server, "login", "pass") or die(mysql_error());
      mysql_select_db("pixeltouch2") or die(mysql_error()) ;

     $path = dirname(__FILE__);
     include("{$path}/user.inc.php");

     ?>

                                        <!--Registration/Login (START)-->
     <?php 

     $exceptions = array('register', 'login', 'user_list', 'profile', 'edit_profile', 'upload');

     $page = substr(end(explode('/', $_SERVER['SCRIPT_NAME'])), 0, -4);

     if(in_array($page, $exceptions) == false){
        if (isset($_SESSION['username']) == false){
        header('Location: login.php');
        die();
        }
      }
     ?>

                                        <!--Registration/Login (END)--> 

                                            <!--User Profile (START)-->
     <?php
     $_SESSION['uid'] = 1;

     ?>

                                            <!--User Profile (END)--> 
```

错误日志

```
Warning: Cannot modify header information - headers already sent by (output started at /home/3/p/pixeltouch/www/book/core/inc/init.inc.php:2) in /home/3/p/pixeltouch/www/book/login.php on line 32

When I look @ line 32 I its my  header("Location: profile.php?uid=" . $_SESSION['uid']);
                die();
                echo $_SESSION['uid']; 
```

所以它与会话有关，是否有另一种方法来编写代码以使其工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:43:52.053

好吧，错误就在那里说。您已经将输出发送到浏览器，并且说“输出”是指发送到浏览器的不是 http 标头的任何内容。

因此，在您的文件中查找：

*   在您的标题位置语句之前回显/打印语句。
*   标签前的空格或换行符`<?php`（即使在包含的文件中）。
*   在页面的开头使用字节顺序标记 (BOM)。

所以..看着你的代码示例我看到（`+`符号表示空格）

```
++++<?php
      session_start(); 
```

您需要更正该使用

```
<?php
  session_start();
// No spaces at the beginning 
```

甚至在这部分

```
 // You close the php tag
 ?>++++++++++
 ++++<!--Registration/Login (START)-->+++++++
 <?php 
 $exceptions = array('register', 'login', 'user_list', 'profile', 'edit_profile', 'upload'); 
```

您不需要这样做，并且您正在发送 html 评论。

为避免此类问题，您始终可以使用[输出缓冲](http://php.net/manual/en/function.ob-start.php)来确保没有输出在标头之前发送。

# maven - 具有远程存储库和 pscp 的 Windows 上的 Maven 不起作用

> ID：10755386
> 
> 赞同：0
> 
> 时间：2012-05-25T13:35:35.113
> 
> 标签：maven

我们在 linux 服务器上有一个远程存储库。当我在 linux 机器上工作时，使用 scp 访问存储库没有任何问题。我现在想在项目的 Windows 机器上工作，但我无法让远程存储库工作。

我遵循了这些说明：[http ://ekawas.blogspot.com/2007/02/maven-windows-and-deploying-to-remote.html](http://ekawas.blogspot.com/2007/02/maven-windows-and-deploying-to-remote.html)

我的 settings.xml 中有这个

```
<servers>
<server>
  <id>ssh-repository</id>
  <username>username</username>
  <password>password</password>
  <privateKey>C:\Dev\programs\ssh_private_key.ppk</privateKey>
  <configuration>
    <sshExecutable>plink</sshExecutable>
    <scpExecutable>pscp</scpExecutable>
  </configuration>
</server> 
```

```
 ...
  <profiles>
    <profile>
      <id>defaultProfile</id>
      <activation>
        <activeByDefault>true</activeByDefault>
      </activation>
      <repositories>
        <repository>
          <id>ssh-repository</id>
          <name>SSH-Repository</name>
          <url>scpexe://host:/path-to-rep</url>
        </repository>
      </repositories>
    </profile>
  </profiles> 
```

当我只是在命令提示符下制作 pscp 时，我没有任何问题。当我尝试 mvn package 或 mvn clean 时，会出现以下错误：

```
Non-resolvable parent POM: Could not transfer artifact .... from/ro ssh-repository ... 
```

我的 settings.xml 有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:21:16.807

我能给出的最佳建议是使用像[Archiva](http://archiva.apache.org)、[Artifactory](http://www.jfrog.org)或[Nexus](http://nexus.sonatype.org/)（按字母顺序排列）这样的存储库管理器。这将使您构建独立于您正在运行的平台的运行。此外，它将使设置的配置更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T14:29:22.463

只是如果有人有同样的问题。我设法使用winscp从我的Windows机器连接到我的ssh存储库。

这是步骤

1.  安装winscp
2.  使用 winscp 连接到您的主机
3.  设置 winscp 的设置 -> 内存 -> 将配置保存在 ini 文件中
4.  将 ssh-rsa 密钥添加到 know_hosts 文件 > username.ssh\known_hosts
5.  编辑 \username.m2\settings.xml 中的 settings.xml

    *   不要使用 sshExecutable 和 scpExecutable
    *   使用 scp://hostname/location/to/repo

# python - 使用 Django 模板在行中分页和显示记录

> ID：10755387
> 
> 赞同：1
> 
> 时间：2012-05-25T13:35:40.467
> 
> 标签：python, google-app-engine, pagination, google-cloud-datastore

我正在尝试为 python 获得一些 GAE 分页，但我什至无法让教程（https://docs.djangoproject.com/en/dev/topics/pagination/）正常工作。我在这里看到关于去哪里的相互矛盾的反应。这是我正在使用的代码：

```
class EditCompanyHandler(webapp.RequestHandler):

    # https://docs.djangoproject.com/en/dev/topics/pagination/

    def get(self):
        company_list = Company.all()    
        paginator = Paginator(company_list, 25) 

You are using the default Django version (0.96). The default Django version will change in an App Engine release in the near future. Please call use_library() to explicitly select a Django version. For more information see https://developers.google.com/appengine/docs/python/tools/libraries#Django

E 2012-05-25 06:31:36.341

<type 'exceptions.ImportError'>: cannot import name Paginator
Traceback (most recent call last):
  File "/base/data/home/apps/s~XX/1.359153909296057586/showcompanies.py", line 24, in <module>
    from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger

I 2012-05-25 06:31:36.343

This request caused a new process to be started for your application, and thus caused your application code to be loaded for the first time. This request may thus take longer and use more CPU than a typical request for your application. 
```

我正在寻找一种直接的分页方式。

如果我将 djnago 版本更新到 1.1，我会得到以下信息：

```
<type 'exceptions.ImportError'>: cannot import name Paginator
Traceback (most recent call last):
  File "/base/data/home/apps/s~biomapit/1.359154059826228765/showcompanies.py", line 25, in <module>
    from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T09:56:38.833

我知道，如果你想导入分页器，你应该使用 django > 0.96 版本。然后在顶部的 showcompanies.py 中添加“from django.core.paginator import Paginator”这个模块。我认为你可以定义错误的代码部分（来自 django.core.paginator 导入 Paginator）模块我使用 django 1.2 版本并且分页器在我的项目中运行。

# delphi - 是否有基于属性注入的 Delphi 依赖注入框架？

> ID：10755391
> 
> 赞同：6
> 
> 时间：2012-05-25T13:35:55.460
> 
> 标签：delphi, dependency-injection

我希望能够以这种方式在 Delphi 中编码，只需注释一个字段：

```
type
  TMyClass = class
  private
    [Inject]
    Factory: ISomeFactory;
    ...
  end; 
```

或通过归因于二传手

```
type
  TMyClass = class
  private
    FFactory: ISomeFactory;

    [Inject]
    procedure SetFactory(const AFactory: ISomeFactory);
    ...
  public
    property Factory: ISomeFactory read FFactory write SetFactory;
  end; 
```

* * *

背景：我将旧代码移动到面向服务的架构中，发现引用服务层总是会导致类似的结构

```
DataModule1.ServiceLayerInstance1.SubSystemN.InvokeSomething(Params, ...); 
```

这可能要短得多

```
type
  Form1 = class(TForm1)
  private
    [Inject]
    SubsystemN: ISubsystemN;
    ...
  end;
  ...
  SubsystemN.InvokeSomething(Params, ...); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T14:22:57.683

就在这里。Delphi Spring 框架

[http://www.spring4d.com/](http://www.spring4d.com/)

正是这样做的。它有一个 [Inject] 属性。

一个警告——要使用它，您需要在定义属性的代码中包含 Spring 单元。否则，编译器将忽略该属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:40:12.157

您可以通过 Emballo OpenSource 项目实现这一目标。

请参阅 Google 代码上的项目： [http ://code.google.com/p/emballo/wiki/WhyDependencyInjection](http://code.google.com/p/emballo/wiki/WhyDependencyInjection)

# .htaccess - .htaccess RewriteCond 语法

> ID：10755394
> 
> 赞同：0
> 
> 时间：2012-05-25T13:36:25.817
> 
> 标签：.htaccess, redirect, rewrite

我需要向我的网站的根 url 公开一个内部文件夹。
所以我需要将用户重定向到`/public/`
但如果您访问 site.com 它不应该重定向

我已经尝试过了，但无法让它工作：

```
重写条件 $1 !^(.*)$
重写规则 ^(.*)$ /public/$1 [L]

```

**编辑：**
例如它应该`/public/some-image.jpg`
在您访问时返回，`site.com/some-image.jpg`
否则只需执行`/index.php`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T19:12:19.870

```
RewriteEngine On
RewriteBase /
RewriteCond $1 !^public
RewriteCond $1 !^$
RewriteRule ^(.*)$ /public/$1 [L] 
```

# mysql - 更新 cakephp 中的一行

> ID：10755396
> 
> 赞同：0
> 
> 时间：2012-05-25T13:36:41.020
> 
> 标签：mysql, database, cakephp

我正在尝试创建一个简单的请求/接受函数。一个用户添加一个人 - 两个用户的用户名连同一个自动生成的 ID 添加到表中。现在，当其他用户检查他们的请求时，他们单击批准并将到期日期添加到记录中。当前发生的情况是，当用户单击接受并设置到期日期时，它会在关系表中创建一条新记录。

我的关系表的结构是

```
id
partyone
partytwo
active
expirydate 
```

公共函数添加（）{

```
 if($this->request->is('post')){
        $this->Relationship->create();
        if ($this->Relationship->save($this->request->data))
        {
            $id=$this->Relationship->id;
            $this->Session->setFlash('The relationship has been saved'); 

        }
        else { $this->Session->setFlash('The relationship could not be saved. Please, try again.'); }
        }

      }

        public function approve(){
            if($this->request->is('post')){
            $this->Relationship->id;
            $this->Relationship->getLastInsertID();
            $this->Relationship->save($this->request->data);
            $this->Session->setFlash('The information has been saved');}
            else{
            $this->Session->setFlash('The information couldnt be saved');}

        }

    } 
```

这是我的批准视图

```
<?php
echo $this->Form->create('Relationship', array('action'=>'approve'));
echo $this->Form->input('expirydate',array('label'=>'Expiry Date: ', 'class' => 'dateclass')); 
echo $this->Form->end('Submit');

?> 
```

这是我的添加视图

```
<?php
echo $this->Form->create('Relationship', array('action'=>'add'));
echo $this->Form->input('partyone',array('label'=>'Enter your username: '));
echo $this->Form->input('partytwo',array('label'=>'Username of user: '));
echo "<br />";
echo $this->Form->end('Click here to add relationship');

?> 
```

我该如何编写代码以便它更新而不是创建一个带有到期日期的新行，请帮助我对此失去理智。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:29:38.837

您必须在“批准”视图中添加一个隐藏字段，其中包含您要编辑的关系的 ID。如果提交的数据包含一个 id，该`save()`方法将更新指定的记录而不是创建一个新记录。

您可以在食谱中找到一个示例：http: [//book.cakephp.org/2.0/en/tutorials-and-examples/blog/part-two.html#editing-posts](http://book.cakephp.org/2.0/en/tutorials-and-examples/blog/part-two.html#editing-posts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:31:40.960

您需要提供更多信息，但基本思想是：

在您`approve`看来，您需要有一个字段来存储要批准`id`的。`relationship`

您可以将 存储`ID`为`approve`方法的参数或隐藏字段。

```
function approve($id=null) {
    /*Form action = Relationship/Approve/ID*/
    $this->Relationship->id = $id;
    /*or - hidden field/an input*/
    $this->Relationship->id = $this->request->data['Relationship']['id'];
    $this->Relationship->save($this->request->data);
} 
```

`id`在你保存之前设置好，Cake 会更新，而不是添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:59:31.940

这没有任何意义。这是一个错字吗：

```
 $this->Relationship->id;
        $this->Relationship->getLastInsertID(); 
```

它显然应该是：

```
 $this->Relationship->id = $this->Relationship->getLastInsertID(); 
```

# .htaccess - 检查 url 的字符串和 301 重定向到没有字符串的 url

> ID：10755397
> 
> 赞同：0
> 
> 时间：2012-05-25T13:36:42.603
> 
> 标签：.htaccess, redirect

我检查了很多 htaccess 重定向，但似乎找不到适合我需要的重定向。我们有一个像这样的旧网址：

www.domain.com/shoes/nike/filter/gender/men

我想要一个规则来检查字符串“过滤器”的 url，然后 301 将其重定向到：

www.domain.com/shoes/nike

用htaccess可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:58:58.953

这应该可以帮助您：

```
RewriteEngine On
RewriteRule (.*)/filter http://www.domain.com/$1 [R=301,L] 
```

它只是删除“过滤器”后的所有内容

# java - 渲染 Ajax 调用不起作用

> ID：10755398
> 
> 赞同：2
> 
> 时间：2012-05-25T13:36:44.867
> 
> 标签：java, jsf-2

在我的应用程序中，我有以下代码：

```
<h:form>
    <h:outputLabel for="type" style="font-weight: bold" value="*Type: " />
    <h:selectOneMenu label="type" id="type" binding="#{type}">
        <f:ajax execute="type" render="text article video" />
        <f:selectItem itemValue="article" itemLabel="Article" />
        <f:selectItem itemValue="video"   itemLabel="Video" />
    </h:selectOneMenu>
    <p:message for="type" />

    <h:outputText id="text" value="#{type.value}" />

    <h:panelGrid id="article" rendered="#{type.value == 'article'}" >
        ...
    </h:panelGrid>

    <h:panelGrid id="video" rendered="#{type.value == 'video'}" >
        ...
    </h:panelGrid>
</h:form> 
```

当我从菜单中选择一个选项时，我确信 Ajax 调用已被触发，因为它`<h:outputText>`已正确呈现`type.value`。但是，没有一个`<h:panelGrid>`被渲染。

如果您能告诉我应该如何解决这个问题，我将不胜感激。

最好的祝福，

詹姆斯·特兰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:43:26.297

JavaScript/Ajax 不能更新不是由 JSF 呈现的 HTML 元素。将其包装在*始终*呈现的组件中，然后对其进行更新。

```
<h:form>
    <h:outputLabel for="type" style="font-weight: bold" value="*Type: " />
    <h:selectOneMenu label="type" id="type" binding="#{type}">
        <f:ajax execute="type" render="text grids" />
        <f:selectItem itemValue="article" itemLabel="Article" />
        <f:selectItem itemValue="video"   itemLabel="Video" />
    </h:selectOneMenu>
    <p:message for="type" />

    <h:outputText id="text" value="#{type.value}" />

    <h:panelGroup id="grids">
        <h:panelGrid id="article" rendered="#{type.value == 'article'}" >
            ...
        </h:panelGrid>

        <h:panelGrid id="video" rendered="#{type.value == 'video'}" >
            ...
        </h:panelGrid>
    </h:panelGroup>
</h:form> 
```

# jquery - jquery - 鼠标悬停效果应该/必须保持点击直到另一个元素被点击

> ID：10755399
> 
> 赞同：1
> 
> 时间：2012-05-25T13:36:49.500
> 
> 标签：jquery, click, mouseover, mouseout

伙计们，

[首先是 jsfiddle 示例](http://jsfiddle.net/XvsQa/1/)

这是我的问题。我有3条路径。每条路径都应该/应该具有鼠标悬停效果（更改填充）。这对我行得通。3 条路径中的 2 条应该/应该是可点击的，点击鼠标悬停效果应该/应该保持，直到我点击另一个（可点击的）路径。所以新的点击路径会得到效果，而在点击路径之前会松动它。

问题在于鼠标移出功能消除了点击效果！！！

所以简而言之。点击效果应该一直存在，直到我点击另一条路径并且只有一条路径可以同时具有点击效果。

我希望你能理解我的问题。查看 jsfiddle 以便您更好地理解。

问候。

ps：在点击一个div框时出现一个关于路径的文本的功能是我需要的第二件事，但这很好用，所以你可以忽略它;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:16:12.647

看看[这个](http://jsfiddle.net/XvsQa/13/)。

一个重要的注意事项是，如果您正在调用元素集合并且必须在某个事件上赋予每个元素相同的行为，则必须使用[.on](http://api.jquery.com/on/)（或 .delegate() 用于旧 jQuery 版本）。

# matplotlib - 使用 gnuplot 绘制矩阵

> ID：10755400
> 
> 赞同：1
> 
> 时间：2012-05-25T13:36:49.747
> 
> 标签：matplotlib, gnuplot

我正在尝试在 Gnuplot 中绘制一个矩阵，就像在 Matplotlib 中使用 imshow 一样。这意味着我只想绘制实际的矩阵值，而不是值之间的插值。我已经能够通过尝试做到这一点

```
splot "file.dat" u 1:2:3 ps 5 pt 5 palette 
```

通过这种方式，我们告诉程序使用文件中的第 1,2 和 3 列，使用大小为 5 的正方形，并以非常窄的间隙间隔点。然而，我的数据集中的点不是均匀分布的，因此我得到不连续性。

任何人都可以在 gnuplot 中绘制矩阵值的方法，而不管 Xa 和 y 轴的间距不均匀吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:07:35.460

Gnuplot 不需要均匀分布 X 轴和 Y 轴。（请参阅我的另一个答案：[https](https://stackoverflow.com/a/10690041/748858) ://stackoverflow.com/a/10690041/748858 ）。我经常处理看起来像`x[i] = f_x(i)`和的网格`y[j] = f_y(j)`。这很容易绘制，数据文件看起来像：

```
#datafile.dat
x1 y1 z11
x1 y2 z12
...
x1 yN z1N
            #<--- blank line (leave these comments out of your datafile ;)
x2 y1 z21
x2 y2 z22
...
x2 yN z2N
            #<--- blank line
...
...
            #<--- blank line
xN y1 zN1
...
xN yN zNN 
```

（注意空行）

像这样的数据文件可以绘制为：

```
set view map
splot "datafile.dat" u 1:2:3 w pm3d 
```

该选项`set pm3d corners2color`可用于微调要为创建的矩形着色的角。

另请注意，您可以制作基本相同的情节：

```
set view map
plot "datafile.dat" u 1:2:3 w image 
```

虽然我自己不使用这个，所以它可能会因不等间距的矩形网格而失败（你需要尝试一下）。

**回复您的评论**

是的，pm3d 确实会生成 (M-1)x(N-1) 四边形，正如您在评论中提到的那样——它需要 4 个角并（默认情况下）平均它们的值来分配颜色。你似乎不喜欢这个——尽管（在大多数情况下）我怀疑你能否分辨出相当大的 M 和 N（大于 20）的情节差异。因此，在我们继续之前，您可能想问自己是否真的有必要绘制*EVERY POINT*。

话虽如此，只要稍加工作，**gnuplot 仍然可以做你想做**的事。解决方案是指定一个特定的角用于将颜色分配给整个四边形。

```
#specify that the first corner should be used for coloring the quadrilateral
set pm3d corners2color c1 #could also be c2,c3, or c4. 
```

然后简单地附加矩阵的最后一行和最后一列来绘制它两次（组成一个额外的网格点来容纳更大的数据集。你还没有到那里，你仍然需要将你的网格值移动半个单元格，以便你的四边形以所讨论的点为中心——移动单元格的方式取决于你选择的角（c1、c2、c3、c4）——你需要玩弄它来确定你想要哪个.

请注意，这里的问题不是 gnuplot。这是在给定 MxN 三元组的情况下，数据文件中没有足够的信息来构造 MxN 表面。在每一点，您需要知道它的位置 (x,y) 它的值 (z) 以及要在那里绘制的四边形的大小 - 这比您打包到文件中的信息更多。当然，您可以猜测内部点的大小（只需中途相遇），但无法猜测外部点。 *但是为什么不直接使用下一个内部点的大小呢？*. 这是一个很好的问题，它（通常）适用于矩形网格，但这只是一种特殊情况（尽管很常见）——对于许多其他网格来说，它（可能）会惨遭失败。关键是 gnuplot 决定平均角落通常“足够接近”，但随后您可以选择更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:05:06.237

[请参阅此处](http://t16web.lanl.gov/Kawano/gnuplot/datafile-e.html#3dim)输入数据的说明。您可能必须相应地更改数据文件的格式。

# jquery - jQuery获取具有特定类的选中复选框列表到数组

> ID：10755403
> 
> 赞同：1
> 
> 时间：2012-05-25T13:37:03.780
> 
> 标签：jquery, arrays, checkbox

我正在尝试获取具有特定类属性的选中复选框列表，并将它们的值放入数组中。我想用它来启用/禁用选择菜单。到目前为止，我有以下内容，这似乎对我不起作用：

```
<select name="inboxSelect" id="inboxSelect" class="selectDisabledSwitch" data-trigger="selectTrigger" disabled="disabled">
    <option value="">With selected</option>
    <option value="1">Archive</option>
    <option value="2">Mark as completed</option>
</select>

<input type="checkbox" name="inbox-1" id="inbox-1" value="1" class="selectTrigger" />
<input type="checkbox" name="inbox-2" id="inbox-2" value="2" class="selectTrigger" />
<input type="checkbox" name="inbox-3" id="inbox-3" value="3" class="selectTrigger" /> 
```

和 javascript / jquery：

```
var frontObject = {
    getCheckboxCheckedArray : function(objClass) {
        var thisArray = $('input:checkbox:checked.' + objClass).map(function () {
            return this.value;
        }).get();
        return thisArray;
    },
    selectDisabledSwitch : function(obj) {
        if (obj.length > 0) {
            var thisObj = $(this);
            var thisTrigger = thisObj.attr('data-trigger'); 
            var thisValues = frontObject.getCheckboxCheckedArray(thisTrigger);
            frontObject.disableMenu(thisObj, thisValues);
            $('.' + thisTrigger).live('change', function() {
                var thisValues = frontObject.getCheckboxCheckedArray(thisTrigger);
                frontObject.disableMenu(thisObj, thisValues);
            });
        }
    },
    disableMenu : function(thisObj, thisValues) {
        if (thisValues.length > 0) {
            thisObj.attr('disabled', false);
        } else {
            thisObj.attr('disabled', 'disabled');
        }
    }
};
$(function() {
    frontObject.selectDisabledSwitch($('.selectDisabledSwitch'));
}); 
```

抱歉 - 只是为了澄清 - 如果没有选中具有特定类的复选框，我希望禁用选择，并在至少选中一个时删除禁用属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:44:44.253

尝试改变

```
var thisObj = $(this); 
```

和

```
var thisObj = $(obj); 
```

小提琴示例：http: [//jsfiddle.net/eR7Vs/](http://jsfiddle.net/eR7Vs/)

# c++ - C++中的扫描线填充OpenGL/GLUT算法

> ID：10755404
> 
> 赞同：7
> 
> 时间：2012-05-25T13:37:04.227
> 
> 标签：c++, opengl, glut

我正在尝试学习在 OpenGL/GLUT 中实现的扫描线填充算法。我无法完全理解这个概念。有人能以相当简单的方式向我解释算法吗？算法如下：

```
#include<GL/glut.h>

float x1,x2,x3,x4,y1,y2,y3,y4;

void draw_pixel(int x,int y)
{
    glColor3f(0.0,1.0,1.0);
    glPointSize(1.0);
    glBegin(GL_POINTS);
    glVertex2i(x,y);
    glEnd();
}

void edgedetect(float x1,float y1,float x2,float y2,int *le,int *re)
{
    float temp,x,mx;
    int i;

    if(y1>y2)
    {
        temp=x1,x1=x2,x2=temp;
        temp=y1,y1=y2,y2=temp;
    }

    if(y1==y2)
        mx=x2-x1;
    else
        mx=(x2-x1)/(y2-y1);

    x=x1;

    for(i=int(y1);i<=(int)y2;i++)
    {
        if(x<(float)le[i]) le[i]=(int)x;
        if(x>(float)re[i]) re[i]=(int)x;
        x+=mx;
    }
}

void scanfill(float x1,float y1,float x2,float y2,float x3,float y3,float x4,float y4)
{
    int le[500],re[500],i,j;

    for(i=0;i<500;i++)
        le[i]=500,re[i]=0;

    edgedetect(x1,y1,x2,y2,le,re);
    edgedetect(x2,y2,x3,y3,le,re);
    edgedetect(x3,y3,x4,y4,le,re);
    edgedetect(x4,y4,x1,y1,le,re);

    for(j=0;j<500;j++)
    {
        if(le[j]<=re[j])
            for(i=le[j];i<re[j];i++)
                draw_pixel(i,j);
    }
}

void display()
{
    x1=250.0;y1=200.0;x2=150.0;y2=300.0;x3=250.0;
    y3=400.0;x4=350.0;y4=300.0;
    glClear(GL_COLOR_BUFFER_BIT);
    glColor3f(0.0,0.0,1.0);
    glBegin(GL_LINE_LOOP);
    glVertex2f(x1,y1);
    glVertex2f(x2,y2);
    glVertex2f(x3,y3);
    glVertex2f(x4,y4);
    glEnd();

    scanfill(x1,y1,x2,y2,x3,y3,x4,y4);

    glFlush();
}

void init()
{
    glClearColor(1.0,1.0,1.0,1.0);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0.0,499.0,0.0,499.0);
}

void main(int argc,char **argv)
{
    glutInit(&argc,argv);
    glutInitDisplayMode(GLUT_SINGLE|GLUT_RGB);
    glutInitWindowSize(500,500);

    glutCreateWindow("scanline");
    glutDisplayFunc(display);

    init();
    glutMainLoop();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:07:55.787

scanfill 函数正在填充由四个 xy 坐标描述的 4 边多边形所覆盖的像素。为此，它使用了 edgedetect 函数，该函数模拟绘制多边形的边缘并记住每个 y 坐标的最小和最大 x 坐标。然后，scanfill 函数遍历每个 y 坐标，并在记住的范围内绘制一条水平像素线。

# c - 合并排序：编译和链接时没有错误和警告，但输出不正确

> ID：10755407
> 
> 赞同：0
> 
> 时间：2012-05-25T13:37:19.060
> 
> 标签：c, sorting

```
// msort.h
#ifndef _MSORT_H

void msort(int a[], int b[], int left, int right);

#endif //_MSORT_H

// msort.c
#include "msort.h"

void msort(int a[], int b[], int left, int right)
{
    if (left < right)
    {
        msort(a, b, left, (left + right) / 2);
        msort(a, b, (left + right) / 2 + 1, right);
        merge(a, b, left, right);
    }
}

// merge.h
#ifndef _MERGE_H_

void merge(int a[], int b[], int low, int high);

#endif //_MERGE_H_ 

// merge.c
#include <stdio.h>
#include "merge.h"

void merge(int a[], int b[], int low, int high)
{
    int mid, begin1, end1, begin2, end2, k;

    mid = (low + high) / 2;
    begin1 = low;
    end1 = mid;
    begin2 = mid + 1;
    end2 = high;
    k = 0;

    while (begin1 <= end1 && begin2 <= end2)
    {
        if (a[begin1] <= a[begin2])
            b[k++] = a[begin1++];
        else
            b[k++] = a[begin2++];
    }

    while (begin1 <= end1)
        b[k++] = a[begin1++];

    while (begin2 <= end2)
        b[k++] = a[begin2++];
}

// test_merge.c
#include <stdlib.h>
#include <stdio.h>
#include <time.h>
#include <malloc.h>
#include "msort.h"
#include "merge.h"

#define N 10

int main()
{
    int *a, *b, i, left, right;

    left = 0;
    right = N - 1;

    a = malloc(sizeof(int) * N);
    if (a == NULL)
        exit(0);
    b = malloc(sizeof(int) * N);
    if (b == NULL)
        exit(0);

    srand((unsigned)time(NULL));

    printf("array before sort:\n");
    for (i = 0; i < N; i++)
    {
        a[i] = rand() % 50;
        printf("%-5d", a[i]);
    }
    printf("\n");

    msort(a, b, left, right);

    printf("array after sort:\n");
    for (i = 0; i < N; i++)
    {
        printf("%-5d", b[i]);
    }
    printf("\n");

    free(a);
    free(b);
    return 0;

} 
```

以上是合并排序代码。msort.h 和 msort.c 递归，直到数组顺序正确。merge.h 和 merge.c 合并两个子数组。test_merge.c 只是合并排序的测试。编译和链接时没有错误和警告。但是输出不正常，我找不到原因。

任何人都可以提供一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:00:29.663

您永远不会修改`msort`or中的第一个数组，因此对in`merge`的最终调用会愉快地覆盖递归调用中所做的事情，因此调用`merge``msort``msort`

```
msort(a, b, left, right); 
```

in`main`相当于

```
merge(a, b, left, right); 
```

在`merge`中，您需要将合并的块复制回数组`a`中，然后排序后的数组最终将位于`a`（以及`b`）中。

```
void merge(int a[], int b[], int low, int high)
{
    int mid, begin1, end1, begin2, end2, k;

    mid = (low + high) / 2;
    begin1 = low;
    end1 = mid;
    begin2 = mid + 1;
    end2 = high;
    k = 0;

    while (begin1 <= end1 && begin2 <= end2)
    {
        if (a[begin1] <= a[begin2])
            b[k++] = a[begin1++];
        else
            b[k++] = a[begin2++];
    }

    while (begin1 <= end1)
        b[k++] = a[begin1++];

    while (begin2 <= end2)
        b[k++] = a[begin2++];
    /* Now copy back into a */
    for(begin1 = low, begin2 = 0; begin1 <= high; ++begin1, ++begin2) {
        a[begin1] = b[begin2];
    } 
} 
```

# actionscript-3 - 在 as3 中写入/保存 xml

> ID：10755408
> 
> 赞同：0
> 
> 时间：2012-05-25T13:37:31.043
> 
> 标签：actionscript-3

我想创建一个独立的纯闪存应用程序，从同一目录加载外部 xml。在那我想更新/覆盖我的xml节点并在运行时将其保存在内部（我不想去fileReference类来保存/覆盖我的xml）。当我下次加载我的应用程序时，它将根据更新的 xml 做出反应。我不想选择 AIR，因为它需要在最终用户端安装。我不能使用任何服务器端脚本。

Flash AS3.0 可以吗？请提出任何可能的解决方案。谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:51:12.680

```
var file:File = File.userDirectory.resolvePath("test.txt");
var fileStream:FileStream = new FileStream();
fileStream.open(file, FileMode.WRITE);
fileStream.writeUTFBytes("text to save");
fileStream.close(); 
```

上次我尝试这个工作时没有任何关于保存位置的提示。. . 如果它可以帮助任何人。（以上适用于保存到 SD 卡的移动设备） - 您需要允许 (WRITE_EXTERNAL_STORAGE) 权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:45:29.590

这是可能的，[这](https://codegolf.stackexchange.com/a/550/299)是一个保存文件的示例[`FileReference.save()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/FileReference.html#save%28%29)
`.txt`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T18:31:50.797

如果没有 AIR 和 FileReference，您将无法访问 Flash 中的文件，但您可以将数据保存在[SharedObject](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/SharedObject.html)中。这类似于浏览器中的 cookie（但不绑定）。数据将保存在“C:\Users\UserName\Application Data\Macromedia\Flash Player\”目录中的某处（Win7 的示例），直到用户清除它或超出可用磁盘大小。

# php - 正则表达式在 PHP 中没有正确计算

> ID：10755412
> 
> 赞同：0
> 
> 时间：2012-05-25T13:38:28.470
> 
> 标签：php, regex

我遇到了 PHP 正则表达式匹配的问题。

我要解决的问题是我需要从字符串中获取十进制值。表达式需要满足以下所有条件（所有美元符号可选）：

```
($)1234.56
($)1,234.56
($)1.00
($)10
($).49
($)1,234,567.32
($)1,234,567 
```

在网上找到了一些精彩的例子后，我能够将弗兰肯斯坦的这个表达结合起来：

```
/(?:^|\s|\$)([1-9](?:\d*|(?:\d{0,2})(?:,\d{3})*)(?:\.\d*[0-9])?|0?\.\d*[0-9]|0)(?:\s|$)/ 
```

如果你[在 solmetra 上](http://www.solmetra.com/scripts/regex/index.php)使用这个 preg_match 测试器，使用上面的模式和测试字符串 'per unit price $19198.01 hey!' 您将得到以下结果：

```
Array
(
    [0] => $19198.01 
    [1] => 19198.01
) 
```

太棒了——这正是我需要的！

但是，当我在 PHP 5.3.10 中运行以下代码时，我得到 null 作为使用此模式字符串匹配的输出：

代码：

```
 $pattern = '/(?:^|\s|\$)([1-9](?:\d*|(?:\d{0,2})(?:,\d{3})*)(?:\.\d*[0-9])?|0?\.\d*[0-9]|0)(?:\s|$)/';
  $subject = 'per unit price $19198.01 hey!';
  $matches = preg_match($pattern,$subject);                
  var_dump($matches[0]); //dumps "null" 
```

我确定我做错了什么，但我就是看不到。

任何帮助将不胜感激。

环境：

```
PHP  5.3.10
Apache 2.2.21
Windows 2008 Server 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T13:42:43.133

您的错误只是在函数用法中：

```
 $matches = preg_match($pattern,$subject); 
```

你实际到达那里的是：

```
 $booleanresult = ... 
```

但是您需要第三个参数来[`preg_match`](http://php.net/preg_match)获得实际结果：

```
 $bool = preg_match($pattern, $subject, $matches); 
```

瞧，您的正则表达式确实有效。我还建议使用该`/x`标志以使其更具可读性。

# jsf - 获取请求的隐藏输入值之一，其中键相似

> ID：10755413
> 
> 赞同：1
> 
> 时间：2012-05-25T13:38:41.527
> 
> 标签：jsf, request, hidden

**JSF：**

```
<h:form>
    <h:inputHidden id="promo" value="promo-motopair"/>
    <h:commandButton value="#{m.buy}" action="#{showProducts.buy}"/>
</h:form>

<h:form>
    <h:inputHidden id="promo" value="promo-northduck"/>
    <h:commandButton value="#{m.buy}" action="#{showProducts.buy}"/>
</h:form> 
```

**Bean，获得点击的 id：**

```
String promo = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("promo"); 
```

无法得到它，因为`id`is equal `promo`，但前面有前缀，看起来像`j_idt40:promo`

如何处理这种情况？

我需要通过`key`. 我想，那个键（`id`在 中`inputhidden`）应该是单个的。我应该只依赖`promo`价值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:47:37.123

不要使用`<h:inputHidden>`. 它不适合您的特定功能要求。只需使用标准 HTML `<input type="hidden">`。

```
<h:form>
    <input type="hidden" name="promo" value="promo-motopair"/>
    <h:commandButton value="#{m.buy}" action="#{showProducts.buy}"/>
</h:form>

<h:form>
    <input type="hidden" name="promo" value="promo-northduck"/>
    <h:commandButton value="#{m.buy}" action="#{showProducts.buy}"/>
</h:form> 
```

顺便说一下，它在请求范围的 bean 中也可以通过

```
@ManagedProperty("#{param.promo}")
private String promo; 
```

无需手动从请求参数映射中抓取。

# android - AnimationDrawable 暂停？

> ID：10755416
> 
> 赞同：1
> 
> 时间：2012-05-25T13:39:09.770
> 
> 标签：android

您好，我试图暂停动画 Drawable，但未能成功。在堆栈溢出的帮助下，我至少得到了 animationDrawable end listener 的帮助，这里是它的代码。是否有任何可能的方法可以暂停动画 Drawable 并从它暂停的位置开始...

```
public abstract class CustomAnimationDrawable extends AnimationDrawable{

    /** Handles the animation callback. */
    Handler mAnimationHandler;
    Runnable r= new Runnable() {

        @Override
        public void run() {
            // TODO Auto-generated method stub
               onAnimationFinish();
        }
    };

    public CustomAnimationDrawable(AnimationDrawable aniDrawable) {
        /* Add each frame to our animation drawable */
        for (int i = 0; i < aniDrawable.getNumberOfFrames(); i++) {
            this.addFrame(aniDrawable.getFrame(i), aniDrawable.getDuration(i));
        }
    }

    @Override
    public void start() {
        super.start();
        /*
         * Call super.start() to call the base class start animation method.
         * Then add a handler to call onAnimationFinish() when the total
         * duration for the animation has passed
         */
        mAnimationHandler = new Handler();
        mAnimationHandler.postDelayed(r, getTotalDuration());

    }

    /**
     * Gets the total duration of all frames.
     * 
     * @return The total duration.
     */
    public int getTotalDuration() {

        int iDuration = 0;

        for (int i = 0; i < this.getNumberOfFrames(); i++) {
            iDuration += this.getDuration(i);
        }

        return iDuration;
    }

    /**
     * Called when the animation finishes.
     */
    abstract void onAnimationFinish();

     public void destroy()
    {

         mAnimationHandler.removeCallbacksAndMessages(r);
         mAnimationHandler.removeCallbacksAndMessages(null);

    } 
```

}

请帮助我有什么办法可以暂停吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T20:14:17.257

我一直在环顾四周，似乎没有办法直接做到这一点。AnimationDrawable 中用于设置帧的所有变量和方法都是私有的。但是，您可以在点击暂停时获取动画所在帧的索引，然后通过从播放的最后一帧的索引迭代原始动画来创建新动画（然后重新开始并添加其余动画，如果动画是周期性的）。

我从一个基于 XML 的动画循环开始，然后添加了另一个用于暂停和恢复的循环。这就是我最终做的事情，到目前为止它工作正常，首先列出了相关变量。

```
private ImageView sphere;
private AnimationDrawable sphereAnimation;
private AnimationDrawable sphereResume;
private AnimationDrawable activeAnimation;
private Drawable currentFrame;
private Drawable checkFrame;
private int frameIndex;

private void pause()
{
    looping = false;
    sphereResume = new AnimationDrawable();
    activeAnimation.stop();
    currentFrame = activeAnimation.getCurrent();

    frameLoop:
    for(int i = 0; i < sphereAnimation.getNumberOfFrames(); i++)
    {
        checkFrame = activeAnimation.getFrame(i);

        if(checkFrame == currentFrame)
        {
            frameIndex = i;
            for(int k = frameIndex; k < activeAnimation.getNumberOfFrames(); k++)
            {
                Drawable frame = activeAnimation.getFrame(k);
                sphereResume.addFrame(frame, 50);
            }
            for(int k = 0; k < frameIndex; k++)
            {
                Drawable frame = activeAnimation.getFrame(k);
                sphereResume.addFrame(frame, 50);
            }
            activeAnimation = sphereResume;
            sphere.setImageDrawable(activeAnimation);
            sphere.invalidate();
            break frameLoop;
        }
    }
}

private void play()
{
    looping = false;
    activeAnimation.setOneShot(true);
    activeAnimation.start();
}

private void stop()
{
    looping = false;
    activeAnimation.stop();
    activeAnimation = sphereAnimation;
    sphere.setImageDrawable(activeAnimation);
}

private void loop()
{
    looping = true;
    stopSoundEffect();
    activeAnimation.setOneShot(false);
    activeAnimation.start();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-03T02:58:18.200

Zorbert Crenshaw 的方法很好，但很复杂。

我有另一个解决方案。（需要用 try/catch 包围，因为反射是不安全的）。

您可以调用***getCurFrameFromAnimationDrawable***在停止动画之前保存当前帧，并调用***setCurFrameToAnimationDrawable***从任何帧开始。

'30L' 应该替换你的持续时间参数。

```
private int getCurFrameFromAnimationDrawable(AnimationDrawable drawable){
    try {
        Field mCurFrame = drawable.getClass().getDeclaredField("mCurFrame");
        mCurFrame.setAccessible(true);
        return  mCurFrame.getInt(drawable);
    }catch (Exception ex){
        Log.e(AnimTool.class.getName(), "getCurFrameFromAnimationDrawable: Exception");
        return 0;
    }
}

private void setCurFrameToAnimationDrawable(AnimationDrawable drawable, int curFrame){
    try {
        Field mCurFrame = drawable.getClass().getDeclaredField("mCurFrame");
        mCurFrame.setAccessible(true);
        mCurFrame.setInt(drawable, curFrame);
        Class[] param = new Class[]{Runnable.class, long.class};
        Method method = Drawable.class.getDeclaredMethod("scheduleSelf", param);
        method.setAccessible(true);
        method.invoke(drawable, drawable, 30L);
    }catch (Exception ex){
        Log.e(AnimTool.class.getName(), "setCurFrameToAnimationDrawable: Exception");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-09T06:38:28.883

这是对这个问题的迟到回答。但它可能对另一个有帮助。要暂停和恢复 AnimationDrawable，只需对其进行自定义并仅使用一个变量进行处理。

```
class CustomAnimationDrawable1() : AnimationDrawable() {

private var finished = false
private var animationFinishListener: AnimationFinishListener? = null
private var isPause = false
private var currentFrame = 0

fun setFinishListener(animationFinishListener: AnimationFinishListener?) {
    this.animationFinishListener = animationFinishListener
}

interface AnimationFinishListener {
    fun onAnimationFinished()
}

override fun selectDrawable(index: Int): Boolean {
    val ret = if (isPause) {
        super.selectDrawable(currentFrame)
    } else {
        super.selectDrawable(index)
    }

    if (!isPause) {
        currentFrame = index
        if (index == numberOfFrames - 1) {
            if (!finished && ret && !isOneShot) {
                finished = true
                if (animationFinishListener != null) animationFinishListener!!.onAnimationFinished()
            }
        }
    }
    return ret
}

fun pause() {
    isPause = true
}

fun resume() {
    isPause = false
} 
```

}

# php - PHP/Symfony：为 Cron/Task 创建应用程序上下文

> ID：10755417
> 
> 赞同：2
> 
> 时间：2012-05-25T13:39:09.967
> 
> 标签：php, symfony1, symfony-1.4, connection-timeout, cron-task

我有一个很长的操作，我无法再从 UI 运行，因为它超过了最大执行时间和内存限制。我很清楚如何在表中设置任务，并让 cron 执行`sfTask`完成待处理任务的任务。

有人可以让我知道以下内容：

1.  管理作业/任务的最佳 PHP/Symfony 插件是哪个？我没有使用 Zend 并且看到了`sfTaskLoggerPlugin`，`sfGearmanPlugin`并且`sfJobQueuePlugin`最近没有更新。
2.  如何创建上下文并使应用程序配置、设置等可用于任务？
3.  如何将参数添加到方法可以读取的上下文中，以识别它们是否已被 cron/task 或 HTTP 请求调用？

感谢所有输入。

PS：[在管理中提到过长脚本，在 Symfony 中提到过任务？](https://stackoverflow.com/questions/1658003/long-script-in-admin-task-in-symfony)和其他几个:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:35:51.157

我认为您需要的大部分内容都包含在标准文档中。

[http://www.symfony-project.org/cookbook/1_2/en/tasks](http://www.symfony-project.org/cookbook/1_2/en/tasks)

我经常通过脚本使用 Symfony 任务，这些脚本通过 cron 作业进行切换。我通过命令行使用环境切换，就像文档讨论的那样。我也使用参数传递。

Symfony 任务非常强大，可以从 CLI 中为您提供所需的一切，以便进入您的应用程序并执行您需要的内容。

如果在阅读文档后，您有更具体的问题，请将其发布，我们将尽力为您解答。

# html - IE兼容模式：强标签=不同PC上的宽度不同？

> ID：10755418
> 
> 赞同：0
> 
> 时间：2012-05-25T13:39:30.120
> 
> 标签：html, css, internet-explorer, cross-browser, width

我有一个案例，其中强标签内的文本在不同的 Windows PC 上以不同的宽度呈现。我已经使用开发工具检查了样式，它们具有相同的字体系列。DOC TYPE 在文档的开头。其他浏览器一致（排除PC上的字体差异）。

我知道不同的浏览器计算的东西不同，但我想知道不同的电脑有什么问题......

然而，似乎 font-weight:bold 给出了相等的宽度。我还看到 Chrome 从用户代理样式表中分配了一个 font-weight:bold 到 strong。我不知道IE。我会尝试在我的样式表中加入一个强大的 {font-family:bold} 。

任何人都经历过不同 PC 的重要风格差异？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:07:15.100

有一些情况可以解释这种差异，`<strong>`页面中标签和字体的呈现可能会因 Windows 版本而异。

Windows XP 上的 Firefox 3.6 和 Windows 7 上的相同 Firefox 应该有一些字体差异，因为 Windows 中安装的本机字体可能不同。也要小心 Service Pack 版本，它也可能与此不同。

您是否检查了两个窗口上使用的默认主题/字体？您是否检查过您测试的浏览器的所有默认设置是否已被重置？（字体大小，字体样式）... 有没有安装字体平滑使用的软件？（比如皮肤或主题？）。就像说的“daGUY”一样，还要检查 ClearType。

我认为问题不是来自您的代码，而是来自 PC 上安装的字体，我认为这是您看到的正常行为。

你应该做的测试是使用 CSS 应用你自己的字体`@font-face`。您将确保使用的字体在计算机之间是相同的。但是渲染也应该不同。

# lua - 嵌入式系统的 LuaJIT 或 eLua？

> ID：10755421
> 
> 赞同：2
> 
> 时间：2012-05-25T13:39:35.647
> 
> 标签：lua

我认为 LuaJIT 很棒，现在我也看到了 eLua。

我只是好奇嵌入式程序员何时会为嵌入式系统选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T14:16:35.663

这取决于您所说的“嵌入式系统”是什么意思。您是指“移动应用程序”还是“将其放入微波炉”？

eLua 是针对*后者*的。它用于在相当低的级别为特定硬件设备编写代码，但仍使用 Lua。您不一定要将它用于其他任何事情。

LuaJIT 并非专门针对任何特定类型的嵌入式编程。事实上，LuaJIT 在 ARM 设备中流行的唯一原因是它的 JIT/解释器能够识别浮点数和整数之间的区别（许多 ARM 芯片往往具有糟糕的浮点性能）。标准的 Lua 解释器不提供这一点，因为它是为浮点运算相当快的系统设计的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-09T09:05:11.420

Luajit 与 Lua 和 eLua 不同。与 Luajit 相比，这些解释器相当慢 - 所以嵌入式 Luajit 会更理想。
[http://luajit.org/performance_arm.html](http://luajit.org/performance_arm.html)
另外使用 ffi 您可以在 Lua 中调用其他模块函数。Luajit 也是符合 Lua 5.1.4 的字节码

# jquery - 如果它们已经属于一个类，如何在 jquery 中命名和选择一组元素？

> ID：10755422
> 
> 赞同：0
> 
> 时间：2012-05-25T13:39:35.973
> 
> 标签：jquery, css, html, jquery-selectors

如标题所述，如果它们已经属于一个类，我如何在 jquery 中命名和选择一组元素？

如果我有 2 个 div：

```
<div id="whateverDiv" class="bigstyle"/>
<div id="whateverDiv2" class="smallstyle"/> 
```

是否可以添加一个类（导致以下结果）：

```
<div id="whateverDiv" class="bigstyle slider"/>
<div id="whateverDiv2" class="smallstyle slider"/> 
```

为了让 jquery 通过`$('.slider')`?选择所有滑块

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:40:59.407

我看不出有什么问题。它应该工作得很好。

[jsfiddle](http://jsfiddle.net/LeYwC/)与演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:42:44.050

对我来说，您似乎不太了解 CSS。尝试阅读一些关于该主题的教程或书籍。

`class="bigstyle slider"`意味着您将 bigstyle 和滑块类添加到元素

`$('.slider')`然后返回所有具有滑块类的元素。所以答案是……是的，它完全没问题，而且有点琐碎……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:42:52.943

是的，将多个类分配给一个元素是完全有效的。任何 jQuery 选择器都适用于单独的类，因此它们可以单独用作选择某些 DOM 元素的方法。

***但是***，为了迂腐，您`ID`的 ' 必须是唯一的，（与您发布的代码不同）否则会导致您出现一些问题。

# c# - MEF 中的声明式服务要求？

> ID：10755423
> 
> 赞同：0
> 
> 时间：2012-05-25T13:39:41.687
> 
> 标签：c#, .net, mef

是否有一种声明方式来指定对 MEF 中其他组件的引用？抱歉，我是 .NET 新手，发现[这个 msdn MEF 教程](http://msdn.microsoft.com/en-us/library/dd460648%28v=vs.110%29.aspx)仅在代码中声明引用。

我要问的是你是否可以指定这部分：

```
[Import(typeof(ICalculator))]
public ICalculator calculator; 
```

在某种属性文件中是这样的：

```
Requires-Component: ICalculator 
```

正如你们中的一些人可能会说的那样，我正在尝试模仿 OSGi 的工作方式（Java 领域），尤其是其中的声明式服务部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:00:06.120

MEF 基于包含*可组合部件的**目录*概念，这些部件导入和导出由*合同名称*标识的其他*可组合部件*。这是非常抽象的，但在大多数情况下，MEF 中的部分是通过导入依赖于其他类型的类型（例如，要创建对象图，根对象依赖于图下方的其他对象）。合同名称是类型的名称。

 ***但是，您可以在 MEF 框架之上构建并创建您自己的具有依赖关系的部分。然后你将不再使用`AssemblyCatalog`（它适用于带有属性注释的类型），而是你必须实现你自己的`ServiceCatalog`，你可以从说“属性文件”构建它。`ComposablePartDefinition`您还必须通过从抽象类和抽象类派生来实现自己的部分`ComposablePart`。然后，MEF 将能够根据您使用自己的合同名称定义的导入和导出来创建部件并连接它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:25:35.577

你在评论中写了这个澄清：

> *我希望我的代码保持独立于框架、中立，并且没有 MEF 或其他任何东西的痕迹。*

当您查看其他依赖注入框架时，您会看到配置组件的三种常见策略：

1.  配置文件
2.  代码中的配置（与组件代码分开）
3.  组件类型的属性

从您的评论来看，您似乎想避免第三种方法，因为它“污染”了依赖注入框架的组件代码。我不反对。

目前 3\. 是 MEF 开箱即用支持的唯一方法。（您*可以*实现自己的`ExportProvider`或`ComposablePartCatalog`执行 1\. 或 2.，但这是一个相当高级的用例）。

在下一个 .NET 4.5 版本（目前处于测试阶段）中，MEF 将支持开箱即用的选项 2。它被称为[MEF 约定模型](http://blogs.msdn.com/b/hammett/archive/2011/03/08/mef-s-convention-model.aspx)。

或者，您可以只使用[另一个依赖注入容器](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)。至少[Castle Windsor](http://www.castleproject.org/container/documentation/v21/usersguide/externalconfig.html)、[Spring.NET](http://www.springframework.net/doc-latest/reference/html/objects.html)和[StructureMap](http://docs.structuremap.net/ConfiguringStructureMap.htm)支持外部配置文件。

但是，我会推荐选项 2\. 代码中的配置，因为它比外部配置文件更易于维护，同时仍将配置与组件代码分开。看看其他一些容器，例如[Autofac](http://code.google.com/p/autofac/)或[Ninject](http://www.ninject.org/)。***

# visual-studio - 在 x86 和 x64 机器上使用 Hintpath

> ID：10755433
> 
> 赞同：3
> 
> 时间：2012-05-25T13:40:33.823
> 
> 标签：visual-studio, msbuild

在我的 64 位机器上，我创建了一个作为 DLL 引用的项目

C:\Program Files (x86)\Microsoft SDKs\Silverlight\v5.0\Libraries\Server\System.ServiceModel.PollingDuplex.dll

如果我在 x86 机器上打开该项目，该引用将失败，因为该目录实际上是“C:\Program Files”

有没有办法做到这一点，所以它可以在两个环境中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:16:49.627

使用环境变量属性 $(ProgramFiles)

```
$(ProgramFiles)\SDKs\Silverlight\v5.0\Libraries\Server\System.ServiceModel.PollingDuplex.dll 
```

做到了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T09:58:31.170

如果你仔细分析，你可以简单地把那个dll放在你的代码库中一个常见的第三方库文件夹下，比如lib。如果您正在处理此 WCF 项目，则甚至不需要安装 Silverlight SDK。

# javascript - 未终止的字符串文字 - Javascript

> ID：10755435
> 
> 赞同：0
> 
> 时间：2012-05-25T13:40:46.083
> 
> 标签：javascript

我需要将参数传递给 Javascript 函数，并且该参数可能包含特殊字符，例如 %。如何转义这些字符以便正确传递给 JS？这些参数是动态生成的，因此我无法识别每个字符并在那里放置一个转义字符。

这是JSP部分...

```
<a href="javascript:redirect('<bean:write property="appId" name="appl"/>','<bean:write property="propId" name="appl"/>','<bean:write property="url" name="appl"/>');">
                                click this
                            </a> 
```

这是生成的部分...

```
<a href="javascript:redirect('A-0', '07', 'http://localhost:9083/xxxxx/aaa/bbbb/ccccc/redirectApply.do?token=9BsPtrGQPEYWv6dvbP9hsX9skeghTHnonkKZtsqrkZXSf7gKqKRYdo2i6CpcLOWxroqrWEDhyosk%0D%0A1aD1tQ0OBHHfsVjPKb%2B1kSFzjCg8lKyoGropGWc%2Bc7oCT8%2BYItwX');"> 
```

看起来是字符“%”导致了问题。我查看了 Firefox 中的错误控制台，它显示字符串到 ****WEDhyosk 并说字符串没有终止........

这个问题与[我之前发布](https://stackoverflow.com/questions/10745018/javscript-function-parameter-length)的一个问题有关，但是由于我当时对这个问题没有清楚的了解，所以我重新发布，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:52:25.907

尝试这样的事情：

```
String encodedurl = URLEncoder.encode("www.google.com","UTF-8"); 
```

单击链接时，浏览器应自动解码字符串。

# iphone - iPhone：应用不在应用商店提交

> ID：10755436
> 
> 赞同：-1
> 
> 时间：2012-05-25T13:40:54.333
> 
> 标签：iphone, app-store-connect

> **可能重复：**
> [无效的 iPhone 应用程序二进制文件](https://stackoverflow.com/questions/47941/invalid-iphone-application-binary)

我尝试在应用商店提交我的应用 5 到 6 次，但是当我在 itunesConnect 上检查状态时，状态为“无效二进制”

我的应用程序的基本 SDK 是 5.0 部署目标是 4.0

我的应用程序仅适用于 iphone 不适用于 ipad

而且我已经完成了从电脑成功提交应用程序的所有步骤。

我不明白为什么会产生这个错误。

任何帮助都将是可观的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:46:59.150

您应该联系 Apple - 登录 iTunes Connect，有一个链接（“联系我们”），特别是因为这个原因：`Having a problem uploading your application? Can't find a Finance Report? Use our Contact Us system to find an answer to your question or to generate a question to an iTunes Rep.`

# c# - .NET 环境中是否有一个继承自 MarshalByRefObject 的类？

> ID：10755439
> 
> 赞同：-1
> 
> 时间：2012-05-25T13:41:05.070
> 
> 标签：c#, .net

问题在标题中。

我正在寻找一些可用于将远程处理配置为客户端端点的类。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:43:34.537

[http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx#inheritanceContinued](http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx#inheritanceContinued)

我不明白为什么您不能为特定的远程处理方案创建自己的类。

# google-chrome - 为什么“-webkit-transform-style:preserve-3d;” 让一些 div 消失？

> ID：10755440
> 
> 赞同：7
> 
> 时间：2012-05-25T13:41:06.423
> 
> 标签：google-chrome, css, webkit, css-transforms

下面的代码应该显示一个标题栏、一个页脚栏和一个图像，但由于某种原因，我一添加就`.div1 { -webkit-transform-style: preserve-3d; }`只得到标题栏。我知道它似乎应用了一些不必要的 div 和样式，但我确实需要它们来实现我已经剥离的效果，以使调试更容易。我的页面代码是：

```
<html>
    <head>
        <title></title>
        <style>
            body {
                margin: 0px;
            }
            .div1 {
                -webkit-transform-style: preserve-3d;
            }
            .div2 {
                position: absolute;
                width: 100%;
                height: 100%;
            }
            img {
                max-width: 50%;
                max-height: 50%;
                display: block;
            }            
            .footer {
                position: fixed;
                bottom : 0px;
            }
        </style>
    </head>
    <body>
        <div class="div1">
            <div class="div2">
                <div class="header">
                    Header
                </div>
                <div class="imgdiv">
                    <img src="http://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2012/5/18/1337331092888/Cwm-Idwal-Snowdonia.-Mich-007.jpg">
                </div>
                <div class="footer">
                    Footer
                </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T23:53:00.163

I think the problem here is similar to the well-known behavior where `position: absolute / fixed` div's that don't have a defined height / width can often disappear. In your case, the 3d canvas is looking for `<div class="div1">` to have a width defined on it, otherwise it just floats aimlessly in space because you gave it properties that make use of the 3d canvas and I believe that in some indirect way causes it not to expand to contain the child divs.

In any case, you can see that defining `height` and `width` on the element with `preserve-3d` fixes the issue in the JS fiddle: [http://jsfiddle.net/nY9v6/](http://jsfiddle.net/nY9v6/)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-03T12:24:11.407

good sample

[http://unformedbuilding.com/demo/2012/css-transforms/3d/3d-transform-style.html](http://unformedbuilding.com/demo/2012/css-transforms/3d/3d-transform-style.html)

# jquery - 如何处理 jquery mobile 和 jquery-ui 中的数据图标？

> ID：10755447
> 
> 赞同：0
> 
> 时间：2012-05-25T13:41:17.393
> 
> 标签：jquery, jquery-ui, jquery-mobile

我正在使用 jquery mobile 和一些自动完成功能我正在使用 jquery-ui，但问题是我的按钮上的图标（>）和我的列表项上的图标（>）没有正确显示，而是它的显示一些奇怪的图标。任何建议如何解决这个问题？ ![在此处输入图像描述](../Images/39832bdedae5afdc169f40224bed47da.png)

```
<input type="submit" value="More" id="more" data-icon="arrow-d" data-iconpos="right" data-theme="b"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:55:15.667

我已经阅读了很多关于 ui 自动完成在移动环境中无法正常工作的信息，但我不确定你的按钮发生了什么，这看起来很奇怪。

如果您省略 jquery ui 样式，它看起来还可以吗？

你可以取消 jquery ui 的自动完成并尝试这个插件我一直在使用它并取得了一些成功： [http ://www.andymatthews.net/code/autocomplete/](http://www.andymatthews.net/code/autocomplete/)

**编辑**：尝试切换包含样式的顺序：将 jquery ui 样式放在 jquery 移动样式之前。

**编辑：** 好的，我刚刚在本地测试了它并且它有效：将jquery UI JAVASCRIPT放在jquery mobile javascript之前，它会好的：

这是一个完整的测试页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <title> - jsFiddle demo</title>

  <script type='text/javascript' src='http://code.jquery.com/jquery-1.7.1.js'></script>

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"></script>
  <script type="text/javascript" src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>

  <link rel="stylesheet" type="text/css" href="/css/result-light.css"/>

      <link rel="stylesheet" type="text/css" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css"/>

  <style type='text/css'>
    body {
    font-family: Verdana, Arial, sans-serif;
    font-size: 12px;
}

  </style>

<script type='text/javascript'>//<![CDATA[ 
$(function(){

});//]]>  

</script>

</head>
<body>
  <form>
    <div>
<input type="button" value="More" id="more" data-icon="arrow-d" data-iconpos="right" data-theme="b"/>
    </div>
</form>

</body>

</html> 
```

# javascript - 如何在函数之外获取变量的值？

> ID：10755448
> 
> 赞同：0
> 
> 时间：2012-05-25T13:41:17.497
> 
> 标签：javascript, jquery

我有这个函数，我需要在函数之外获取变量 $overall 的值，我该怎么做？

```
$(function(){
     function ca($tr_value, $qty ){
     window.$overall = 0;

    $($tr_value).each(function() {

        var $qnt = $(this).find($qty);
        var $price = $(this).find("td").eq(2);

        var sum = parseFloat($price.text()) * parseFloat($qnt.val());

        $(this).find("td").eq(3).text(sum);
        $(this).find(".priceitem").attr('value', $(this).find("td").eq(2).text());
        $(this).find(".totalitem").attr('value', sum);

        $overall += sum;

        return window.overall;

    });

    $("#total").text($overall);
    $(".total").attr('value', $overall);
}

    function ca_transp(){
    var $overall_transp = 0;

    $("tr.sum_transp").each(function() {

        var $qnt = $(this).find(".qty_transp");
        var $price = $(this).find("td").eq(2);

        var sum = parseFloat($price.text()) * parseFloat($qnt.val());

        $(this).find("td").eq(3).text(sum);
        $(this).find(".priceitem").attr('value', $(this).find("td").eq(2).text());
        $(this).find(".totalitem").attr('value', sum);

        $overall_transp += sum;

    });

    $("#total_transp").text($overall_transp);
    $(".total").attr('value', $overall_transp);

}

//]]>  

   function suma_total(){
    var $suma_total = 0;    

    $("tr.total").each(function() {

        //var $qnt = $(this).find(".total");

        var $total_parcial = $(this).find("td").eq(1);
        var sum = parseFloat($total_parcial.text());

        $(this).find("td").eq(1).text(sum);
        $suma_total += sum;

    });

    $("#total_cotizacion").text($suma_total);
    $(".total_cotizacion").attr('value', $suma_total);

}
    ca_transp();
    $('input.qty_transp').bind('change keyup',function(){ca_transp();});
    ca("tr.sum", ".qty");
    $('input.qty').bind('change keyup',function(){ca("tr.sum", ".qty");});
    alert($overall);

}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:42:44.050

在函数之外定义它，这将使它成为全局的。

```
$(function(){
    var $overall;
    function ca($tr_value, $qty ){
       $overall = 0;
       $($tr_value).each(function() { 
```

PS你也是嵌套`document.ready`函数。你不需要这样做。事实上，你的代码可以清理很多。我认为您不需要创建全局`$overall`变量。你的代码目前没有结构化，如果你清楚你的意图是什么，那么我可以修改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:43:04.647

这是简单的范围问题。

**选项：**

1.  将变量移动到全局范围
2.  将值存储在 DOM 中的隐藏元素中。
3.  使它们共享相同的范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T14:11:07.627

您可以从 ca 函数中返回它，而不是创建一个[邪恶的全局变量。](http://www.nczonline.net/blog/2006/06/05/global-variables-are-evil/)

```
$(function () {
   //$overall doesn't need to be the same name here, you could call it "$returnedOverall" for example, and it would still work
   var $overall = ca("tr.sum", ".qty");
   alert($overall); //will show you the value of $overall, returned from the above call
   $('input.qty').bind('change keyup', function () {
       ca("tr.sum", ".qty");
       var $overall2 = ca("tr.sum", ".qty");
       alert($overall2); //will show you the value of $overall2, returned from the above call
   });
});

//ca doesn't need to be in your jQuery document.ready function, it only needs to be called from within document.ready
function ca($tr_value, $qty) {
    var $overall = 0;
    $($tr_value).each(function () {
        var $qnt = $(this).find($qty);
        var $price = $(this).find("td").eq(2);
        ...
        $overall += sum;
        //don't return it here, this is inside your jQuery.each function
    });
    //return it here, from your ca function
    return $overall;
} 
```

# django - Django 查询集使用一次

> ID：10755449
> 
> 赞同：0
> 
> 时间：2012-05-25T13:41:18.503
> 
> 标签：django

对不起，但我不知道我应该给这个问题什么标题（建议？）

我有以下模型：

```
class Stuff(models.Model):
    summer = models.CharField()
    winter = models.CharField()
    #other fields 
```

和以下观点：

```
def get_stuff(request, type, id):
    if type == 'summer':
        qs = Stuff.objects.filter(summer=id)
    if type == 'winter':
        qs = Stuff.objects.filter(winter=id)
    return qs 
```

既然我知道要查看哪个字段，如何只使用一次查询？像这样：

```
Stuff.objects.filter(type=id) #type = summer or winter field 
```

例子：

```
type='summer'
id=1
Stuff.objects.filter(type=id) => Stuff.objects.filter(summer=id)

type='winter'
id=1
Stuff.objects.filter(type=id) => Stuff.objects.filter(winter=id) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T13:44:32.917

你并没有真正节省很多，但我想你想要这个：

```
qs = Stuff.objects.filter(**{type: id}) 
```

# tfs - 在 Team Foundation Server 2010 中找不到报告

> ID：10755451
> 
> 赞同：3
> 
> 时间：2012-05-25T13:41:21.713
> 
> 标签：tfs

我最近设置了 TFS 2010 并尝试访问报告功能。TFS 安装在 Windows Server 2008 R2 上，我正在使用 Visual Studio 2010 访问 TFS。

根据我在网上看到的情况，我应该在 Team Explorer 或 Visual Studio 的 Team 菜单中有一个报告选项。我根本没有这个选项。我看过 MSDN 文章说该选项旁边可能有一个红十字，但我根本看不到。

从 TFS 管理控制台，报告似乎已设置。所有三个选项（仓库、分析服务和报表服务器）都有一个绿色勾号并显示“已配置”。

如果我访问报告 URL，我会获得一个 Web 界面，但没有现成的报告。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T15:09:14.760

问题是尚未设置默认报告文件夹位置。我只是在绝望地点击所有屏幕时才注意到。

打开 TFS 管理控制台，转到 Application Tier > Team Project Collections。然后在底部的报告文件夹选项卡中确保您已设置一个值。我只是使用了默认示例，即 /TfsReports/DefaultCollection。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T14:46:30.900

您在此视图中没有看到“报告”文件夹？

![在此处输入图像描述](../Images/ea738e1e32ce5a8f9abba17d2b742786.png)

你有这样的屏幕吗？

![在此处输入图像描述](../Images/4f7afe39d087533744bdad7e0c90fd88.png)

# android - android - 如何删除Listview中某个位置的视图

> ID：10755457
> 
> 赞同：0
> 
> 时间：2012-05-25T13:41:46.787
> 
> 标签：android, android-listview

我想知道如何在列表视图中的某个位置删除子视图并在列表顶部添加相同的子视图。我尝试使用以下方法，但它会生成不受支持的异常。请问怎么办，谁能帮帮我。

```
lvAddedContacts.removeViewAt(AddUserView,nAddUserPosition );//Here i want to remove this view from the list

lvAddedContacts.addView(AddUserView, 0); //Add the same at the top

lvAddedContacts.invalidate();//list is refreshed

contactsAdapter.notifyDataSetChanged();

private class ContactsListViewAdapter extends BaseAdapter 
{

    private LayoutInflater mInflater;        

    public ContactsListViewAdapter(Context context) {
        // Cache the LayoutInflate to avoid asking for a new one each time.
        mInflater = LayoutInflater.from(context);   
    }

    public int getCount()
    {   
        int nListSize = DH_Constant.AddedContactsList_obj.response.size();
        if(nListSize > 0)
        {
            return nListSize;
        }
        else
        {
            return 0;
        }            
    }

    public Object getItem(int position)
    {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(final int position, View convertView, final ViewGroup parent)
    {            
        ViewHolder holder;      

        convertView = mInflater.inflate(R.layout.added_contacts_list, null);
        holder = new ViewHolder();

        //getting the id's
        holder.tvName = (TextView) convertView.findViewById(R.id.xrays_Name_tv);
        holder.btnRemove = (Button) convertView.findViewById(R.id.xrays_removebtn);

        //Name            
        String strName = DH_Constant.AddedContactsList_obj.response.get(position).Name;
        holder.tvName.setText(strName);

        //Change the color for differentiate the dicom and non dicom users
        if(DH_Constant.AddedContactsList_obj.response.get(position).IsDicomUser)
        {
            holder.tvName.setTextColor(Color.rgb(0, 135, 137));                 
        }
        else
        {
            holder.tvName.setTextColor(Color.BLUE);             
        }

        //Remove button Listener
        holder.btnRemove.setBackgroundResource(R.layout.xrays_contact_removebtn_widget);
        holder.btnRemove.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v)
            {
                lnIcontactId = DH_Constant.AddedContactsList_obj.response.get(position).ImportedContactsID; 
                nDicomUser = DH_Constant.AddedContactsList_obj.response.get(position).IsDicomUser?1:0;
                //Alert for remove the contact
                showDialog(DIALOG_removebtnalert);
            }
        });

        //Copy the view and position if the user is added
        if(DH_Constant.blnAddUserStatus)
        {    
            System.out.println("IContactID(xrays):"+DH_Constant.lnAddUserID);               
            if(DH_Constant.AddedContactsList_obj.response.get(position).ImportedContactsID == DH_Constant.lnAddUserID)
            {    
                nAddUserPosition = position;
                AddUserView = convertView;
            }
        }

        return convertView;
    }   

    class ViewHolder 
    {
       TextView tvName;
       Button btnRemove;        
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:54:39.240

不要自己删除由适配器支持的视图，因为它可能会导致奇怪的行为！您对 BaseAdapter 的实现对我来说也很奇怪。IE：

```
 public Object getItem(int position)
{
    return position;
}

public long getItemId(int position) {
    return position;
} 
```

似乎没有任何意义！

您应该使用[ArrayAdapter](http://developer.android.com/reference/android/widget/ArrayAdapter.html)将模型传递给它并`getView(int, View, ViewGroup)`相应地实现。如果你想在 Top 中移动一个 Item，你所要做的就是：

```
ArrayAdapter adapter = //initialize with your Model Objects and set it as ListAdapter
Object someItemInsideList = //some Item
adapter.remove(someItemInsideList);
adapter.insert(someItemInsideList, 0);
adapter.notifyDataSetChanged(); 
```

# oracle - 使用 CONTAINS 的 Oracle XML 全文查询， 和 INPATH

> ID：10755459
> 
> 赞同：0
> 
> 时间：2012-05-25T13:41:51.213
> 
> 标签：oracle, oracle-text, oracle-xml-db-repository

`<query>`我正在努力寻找一种使用语法和 INPATH 表达式组合全文查询进程的方法。

给定下一个代码，Oracle 将忽略 INPATH 表达式。

```
SELECT DISTINCT publication.id, SCORE (1)
   FROM TBL_PUBLICATION publication
   WHERE 
         ( ( (CONTAINS (
                     xmlcontent,
                     '(<query>
                         <textquery grammar="CONTEXT" >my text
                           <progression>    
                             <seq><rewrite>transform((TOKENS, "{", "}", " "))</rewrite></seq>    
                             <seq><rewrite>transform((TOKENS, "{", "}", " NEAR "))</rewrite></seq>    
                             <seq><rewrite>transform((TOKENS, "$(?{", "})", " AND "))</rewrite></seq>
                           </progression>
                         </textquery>
                      </query>) INPATH(//foo/bar)',
                     1) > 0))              
ORDER BY SCORE (1) DESC 
```

# c# - 为什么当传递相同类型作为方法 C# 的参数时，类的私有字段是可见的？

> ID：10755461
> 
> 赞同：5
> 
> 时间：2012-05-25T13:42:04.287
> 
> 标签：c#, private-members

让我们看看这堂课：

```
 public class Cluster
    {
        private List<Point> points; //private field

        public float ComputeDistanceToOtherClusterCLINK(Cluster cluster)
        {
            var max = 0f;
            foreach (var point in cluster.points) // here points field are accessible
            {
                  .......
            }
            return max;
        }
    } 
```

为什么我可以访问私有字段？

我可以使用此功能还是可能是不好的做法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T13:43:14.583

> 为什么我可以访问私有字段？

因为您在定义私有字段的同一个类中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T13:50:15.823

如有疑问，请检查语言规范。

根据 C# 语言规范，第 3.5.1 节：

> 3.5.1 声明的可访问性
> 
> 成员声明的可访问性可以是以下之一：
> 
> *   Public，通过在成员声明中包含 public 修饰符来选择。public 的直观含义是“访问不受限制”。
> *   受保护的，通过在成员声明中包含受保护的修饰符来选择。protected 的直观含义是“仅限于包含类或从包含类派生的类型的访问”。-Internal，通过在成员声明中包含 internal 修饰符来选择。internal 的直观含义是“访问受限于这个程序”。
> *   受保护的内部（意思是受保护的或内部的），通过在成员声明中同时包含受保护和内部修饰符来选择。protected internal 的直观含义是“访问仅限于此程序或从包含类派生的类型”。
> *   Private，通过在成员声明中包含 private 修饰符来选择。private 的直观含义是“仅限于包含类型的访问”。

正如您从上一节中看到的，*包含类*的所有方法（在您的情况下是`Cluster`）都可以访问私有字段`points`。

...不，这根本不是一个坏习惯：这正是私有领域的目的！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T13:50:46.577

Private 表示类范围的私有。令人惊讶的是，您甚至可以访问同一类的另一个对象的私有字段。

```
public class A
{
    private int _i;

    public bool AreEqual(A otherObject)
    {
        return this._i == otherObject._i;
    }
} 
```

* * *

OOP（面向对象编程）的主要方面之一是封装。这意味着一个对象禁止直接访问私有数据（字段）。相反，它提供了公共方法（包括属性 getter 和 setter）来操作和访问其数据。但这也意味着这些方法必须能够访问这些私有字段，否则私有字段将毫无意义。

* * *

澄清：但我同意，能够访问另一个对象的私有成员是出乎意料的，并且至少部分违反了封装原则。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-25T13:44:30.730

您在类的范围内定义字段，因此该类中的事物可以访问私有字段。这是定义明确的行为，非常有用，而且编程实践也不错。

查看[Scope](http://msdn.microsoft.com/en-us/library/aa691132%28v=vs.71%29.aspx)可能对您有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-25T13:47:47.597

private 关键字使该字段对类私有，而不是对该类的对象实例。因此，该类中的任何代码都可以访问该类类型的任何对象中的该字段（当然，前提是它具有对该对象的引用）。这样做一点也不坏。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-25T13:48:52.617

> 私有字段在定义它的范围内始终是可访问的，并且由于私有变量是在类范围内定义的，因此它是可访问的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-25T13:55:03.843

私有字段可以在类型内部访问。ComputeDistanceToOtherClusterCLINK 是同一个类的成员。所以私有字段应该可以从方法体中访问。

# wordpress - 当我在 wordpress 中上传插件时，插件在激活错误期间生成了 xxxx 个字符的意外输出

> ID：10755464
> 
> 赞同：0
> 
> 时间：2012-05-25T13:42:11.400
> 
> 标签：wordpress

我正在创建一个 WordPress 插件来获取报价。

当我尝试激活插件时出现错误

**该插件在激活期间生成了 123 个字符的意外输出。如果您注意到“标头已发送”消息、联合提要问题或其他问题，请尝试停用或删除此插件。**.

我搜索了互联网，发现它是由开始`<?php`标记之前或结束`?>`标记之后的空格或换行引起的。我检查了我的文件并删除了所有那种类型的空格并尝试重新安装我的插件。但错误仍然存​​在，并且它还在我的其他插件功能中产生了一些错误。

下面是我的插件脚本

```
<?php

/*

Plugin Name: get_a_quote
Plugin URI: http://galtech.org/beta.com
Version: 0.8.04b
*/

//ob_start();
error_reporting(E_ALL);
global $wpdb;
$get_a_quote_table = $wpdb->prefix . 'quote';
$get_a_quote_table_projectinfo = $wpdb->prefix . 'projectinfo';
$get_a_quote_table_settings = $wpdb->prefix . 'get_a_quote_settings';
define('GET_A_QUOTE_TABLE', $wpdb->prefix . 'quote');
define('GET_A_QUOTE_TABLE_PROJECTINFO', $wpdb->prefix . 'projectinfo');
define('GET_A_QUOTE_TABLE_SETTINGS', $wpdb->prefix . 'get_a_quote_settings');
/*define(NETWORKS_INV_TABLE_PICTURES, $wpdb->prefix . 'pictures');
define(STAFF_PHOTOS_DIRECTORY, WP_CONTENT_DIR . "/uploads/staff-photos/");*/
require_once( dirname (__FILE__).'/install.php' );
require_once( dirname (__FILE__).'/admin/admin.php' );
//require_once( dirname (__FILE__).'/functions.php' );
//trigger_error(ob_get_contents(),E_USER_ERROR);
//echo get_option('plugin_error');
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T14:40:31.857

我知道这个问题已经有几个月了，所以不确定你是否还需要答案。但是，该消息意味着有输出；任何输出。所以它不必是 php 标签之外的空格或文本，它也可以是 echo 或 printf 甚至是警告或错误。确定它来自何处的最佳方法是选择性地注释掉您的代码并激活插件以查看它何时停止显示。不过通常这没什么大不了的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-08T04:43:20.203

1) 去除内页或插件页中的多余间距。

2）删除页面或插件页面中的内联样式。

它每次都对我有用，当插件页面或 Wordpress 页面出现问题时，我多次使用相同的方法。

# email - 从触发器发送电子邮件

> ID：10755469
> 
> 赞同：23
> 
> 时间：2012-05-25T13:42:42.807
> 
> 标签：email, triggers, sql-server-2008-r2

我正在尝试开发邮件触发器。有人可以协助如何实现这一点，以便在用户插入记录时检查“速度”字段，以便当插入值超过 100 时，将邮件发送到指定地址。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-25T13:45:28.393

首先，您需要设置数据库邮件 - 如果您还没有这样做，这个问题可能会有所帮助：

*   [数据库邮件的脚本设置](https://stackoverflow.com/questions/3521456/scripting-setup-of-database-mail)

然后你需要一个触发器：

```
CREATE TRIGGER dbo.whatever
ON dbo.wherever
FOR INSERT
AS
BEGIN
    SET NOCOUNT ON;

    IF EXISTS (SELECT 1 FROM inserted WHERE speed > 100)
    BEGIN
        EXEC msdb.dbo.sp_send_dbmail
          @recipients = 'whoever@yourcompany.com', 
          @profile_name = 'default',
          @subject = 'Someone was speeding', 
          @body = 'Yep, they sure were.';
    END
END
GO 
```

现在，您可能会说您希望插入的数据实际包含在电子邮件中。您的第一个倾向是声明一些局部变量并从中分配它们`inserted`- 这不起作用，因为您的触发器可能响应多行插入。所以正确的做法是：

```
CREATE TRIGGER dbo.whatever
ON dbo.wherever
FOR INSERT
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @body NVARCHAR(MAX) = N'';

    SELECT @body += CHAR(13) + CHAR(10) + RTRIM(some_col) FROM inserted;

    IF EXISTS (SELECT 1 FROM inserted WHERE speed > 100)
    BEGIN
        EXEC msdb.dbo.sp_send_dbmail
          @recipients = 'whoever@yourcompany.com', 
          @profile_name = 'default',
          @subject = 'At least one person was speeding', 
          @body = @body;
    END
END
GO 
```

总而言之，我不是从触发器发送电子邮件的忠实粉丝。尽管数据库邮件使用服务代理，因此是异步的，但我更倾向于填充队列表，并有一个后台线程来发送所有适当的电子邮件。关于此的~~两个~~三个好处是：

1.  您可以最大限度地减少提交触发触发器的外部事务的潜在延迟 - 触发器中的逻辑越复杂，您执行该过程的速度就越慢。
2.  由于在插入行的微秒内发送电子邮件可能不是必需的，因此您可以轻松地波动后台进程的时间 - 这避免了必须一整天都检查表的时间，而这种情况很少会发生永远不得不实际做任何事情。
3.  正如@goodeye 指出的那样，将这个过程分开可以防止该过程的电子邮件部分中的错误干扰原始 DML（在他们的情况下，一个无效的参数`sp_send_dbmail`- 我无意中建议 - 阻止了插入）。

# java - 如何在 netbeans 平台应用程序中添加或使用 .DDL 文件

> ID：10755475
> 
> 赞同：0
> 
> 时间：2012-05-25T13:42:53.723
> 
> 标签：java, embedded-resource, ddl, netbeans-platform

我正在用 Java Swing 在 Netbeans 平台上制作应用程序。我想在我的应用程序模块中添加和使用 .DDL 文件。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:56:11.163

> 如何制作包含 .DDL 文件的 .jar 文件？

将其添加到应用程序运行时类路径上的 Jar 中。[这是一个用于添加图像](http://netbeans.org/kb/docs/java/gui-image-display.html#package)的 Netbeans 教程- 对于任何非源文件，该过程都大致相同。

`URL`通过或访问文件`InputStream`。这是获取 URL 的示例。

```
URL urlToResource = this.getClass().getResource("/path/to/the.ddl"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:50:49.630

提到 VC++ 和 JNI 让我觉得你在谈论 .DLL 文件。在那种情况下，似乎有[一个简单的解决方案](http://wiki.netbeans.org/DevFaqNativeLibraries)。

# html - 基本 HTML 布局

> ID：10755476
> 
> 赞同：4
> 
> 时间：2012-05-25T13:42:54.147
> 
> 标签：html, css

我正在尝试实现一个简单的布局，如下所示：

```
 _________________________
|     |   header    |     |
|  L  |_____________|  R  |
|     |             |     |
|     |             |     |
|     |             |     |
|     |    main     |     |
|     |             |     |
|     |             |     |
|     |             |     |
|_____|_____________|_____| 
```

我开发了这段代码来实现我的目标：

```
<!DOCTYPE html>
<html>
<head>
    <title>Layout</title>
<style>

    * {
        margin: 0px;
        padding: 0px;
    }
    p {
        text-align: center;
    }
    div#left {
        float: left;    
        background-color: #777;
        width: 200px;
        height: 650px;
    }
    div#header {
        float: left;    
        background-color: #eee;
        width: 940px;
        height: 60px;
    }
    div#main {
        float: left;    
        width: 940px;
    }
    div#right {
        float: right;   
        background-color: #777;
        width: 200px;
        height: 650px;
    }
</style>
</head>

<body>
    <div id="left">
        <p>Left</p>
    </div>

    <div id="header">
        <p>Header</p>
    </div>

    <div id="main">
        <p>Main</p>     
    </div>

    <div id="right">
        <p>Right</p>
    </div>
</body> 
```

但我无法让“正确”列与顶部保持一致。有人可以指出我的 CSS 中需要改变什么来纠正这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T13:43:59.167

将右列移动到 HTML 的顶部：

```
<body>

    <div id="right">
        <p>Right</p>
    </div>

    <div id="left">
        <p>Left</p>
    </div>

    <div id="header">
        <p>Header</p>
    </div>

    <div id="main">
        <p>Main</p>     
    </div>
</body> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:09:24.453

约翰康德的回答是正确的。但是为了帮助您可视化更改，将宽度更改为百分比，您将明白他的意思。:)

```
 <!DOCTYPE html>
    <html>
    <head>
       <title>Layout</title>
    <style>

      * {
       margin: 0;
       padding: 0;
      }
      p {
       text-align: center;
      }
      div#left {
       background-color: #777777;
       float: left;
       height: 650px;
       width: 15%;
      }
      div#header {
        background-color: #EEEEEE;
        float: left;
       height: 60px;
       width: 70%;
      }
      div#main {
       float: left;
       width: 70%;
      }
    div#right {
      background-color: #777777;
      float: right;
      height: 650px;
      width: 15%;
    }
    </style>
    </head>

    <body>
    <div id="left">
        <p>Left</p>
    </div>
    <div id="right">
        <p>Right</p>
    </div>
    <div id="header">
        <p>Header</p>
    </div>

    <div id="main">
        <p>Main</p>     
    </div>
    </body> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T14:11:46.503

为了实现正确的、跨浏览器兼容的浮动布局，正确排序元素很重要。为此，您应该始终在非浮动元素之前出现浮动元素。

您还必须优先考虑垂直布局，例如，如果您的示例中的页眉将分布在页面的整个宽度上，这将出现在任何跟随它的浮动元素之前。

# java - 如何在 webdriver 中捕获页面发出的所有请求？Browsermob有什么替代品吗？

> ID：10755480
> 
> 赞同：31
> 
> 时间：2012-05-25T13:43:05.597
> 
> 标签：java, selenium, proxy, webdriver, har

我正在使用 Selenium2/WebDriver 来测试我的 Web 应用程序。所有测试都是用 Java 编写的，并使用 Maven 运行。

在使用 webdriver 打开页面时，我想捕获页面发出的所有请求（图像、js 和 css 文件等）。我使用这些数据主要有两个原因

*   检查呼叫中的 404（和其他错误）
*   检查分析代码是否正常工作（检查它是否发送正确的请求）

根据项目，我使用带有 Netexport 的 Firebug 或 Browsermob 代理。在这两种情况下，我都可以轻松获取 HAR（Html ARchive）文件，对其进行解析并提取我想要的数据。

问题是：我对这两种解决方案都不满意。当页面包含加载时间过长的视频时，我在获取 HAR 文件时尤其遇到问题。我正在寻找更稳定的东西。

所以，问题是：

Browsermob有什么替代品吗？我知道 FiddlerCore，但它是一个 .NET 库，我的测试是用 Java 编写的。我也听说过 Ajax DynaTrace，我知道有一些方法可以将它与 Selenium 集成，但我发现的文档是针对 Selenium-RC 而不是 WebDriver。

有没有办法将 DynaTrace 与 WebDriver 集成或将 FiddlerCore 与 Java 一起使用？

还有其他方法可以实现我提到的目标吗？我正在寻找一个可以通过我的代码轻松控制的代理。将数据导出到 HAR 将是一大优势。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-19T06:30:35.330

我找到了[关于该主题](https://groups.google.com/forum/#!topic/webdriver/L07NvliQZRk)的 google 群组讨论。这些链接看起来像是 Browsermob 的有希望的替代品：

*   [Java 中的 Selenium CaptureNetworkTraffic 示例](http://blog.eviltester.com/2010/05/a-selenium-capturenetworktraffic-example-in-java.html)
*   [HOWTO：收集 WebDriver HTTP 请求和响应标头](http://www.supermind.org/blog/968/howto-collect-webdriver-http-request-and-response-headers)
*   [使用 Selenium 2 自动捕获 Web 时序](http://www.theautomatedtester.co.uk/blog/2010/selenium-webtimings-api.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-02T13:01:19.043

firefox ver 42+有一个替代方案，有一个名为Firefox HarExport的插件

```
File harExportApi = new File(System.getProperty("user.dir")
                     + "/src/main/resources/firebug/harexporttrigger-0.5.0-beta.7.xpi");

netExportProfile.addExtension(harExportApi);
netExportProfile.setPreference("extensions.netmonitor.har.enableAutomation", true);
    netExportProfile.setPreference("extensions.netmonitor.har.contentAPIToken", "test");
    netExportProfile.setPreference("extensions.netmonitor.har.autoConnect", true);

cap.setCapability(FirefoxDriver.PROFILE, netExportProfile); 
```

并运行以下脚本将为我们提供所有请求响应

```
 String getHarLogScript = "var options = {\n" +
                "    token: \"test\",\n" +
                "    getData: true,\n" +
                "    title: \"my custom title\",\n" +
                "    jsonp: false,\n" +
                "  };\n" +
                "\n" +
                "  HAR.triggerExport(options).then(result => {\n" +
                "    var har = JSON.parse(result.data);\n" +
                "\n" +
                "    // Use performance.timing to provide onContentLoad\n" +
                "    +
                "     +
                "    var t = performance.timing;\n" +
                "    var pageTimings = har.log.pages[0].pageTimings;\n" +
                "    pageTimings.onContentLoad = t.domContentLoadedEventStart - t.navigationStart;\n" +
                "    pageTimings.onLoad = t.loadEventStart - t.navigationStart;\n" +
                "\n" +
                "    window.HarEntries=har.log.entries\n" +
                "\n" +
                "    console.log(\"HAR log (\" + result.data.length + \") \", har.log);\n" +
                "  }, err => {\n" +
                "    console.error(err);\n" +
                "  });"

LOG.info("Loading HAR log entries object into browser HarEntries object");
SeleniumUtils.executeScript(driver, getHarLogScript);

harEntries = ((List<Object>) SeleniumUtils.executeScript(driver, "return window.HarEntries")); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-16T22:44:42.553

我最近一直在研究这种代理。项目很新鲜，我仍在处理文档，但可能值得检查。来源和例子在[这里](https://github.com/lukasz-aw/moxproxy)

1.  将依赖项添加到您的项目

```
 <dependency>
       <groupId>com.moxproxy</groupId>
       <artifactId>moxproxy.core</artifactId>
       <version>1.0.2</version>
    </dependency> 
```

2.  启动代理

```
 MoxProxy proxy = LocalMoxProxy.builder()
                .withPort(89)
                .build();
    proxy.startServer(); 
```

3.  设置 selenium webdriver 以在 localhost 上使用端口 89 的代理并运行测试

4.  收集流量

```
 List<MoxProxyProcessedTrafficEntry> requestTraffic = proxy.getAllRequestTraffic();
    List<MoxProxyProcessedTrafficEntry> responseTraffic = proxy.getAllResponseTraffic(); 
```

除了收集流量代理之外，还提供修改请求和响应的可能性 - [github上的详细信息](https://github.com/lukasz-aw/moxproxy/blob/master/moxproxy.local.examples/src/test/java/testing/e2e/LocalProxyTest.java)

# ms-access - 如何在浏览器页面上显示存储在 MsAccess 数据库中的 UNICODE 字符？

> ID：10755485
> 
> 赞同：1
> 
> 时间：2012-05-25T13:43:18.783
> 
> 标签：ms-access, unicode, asp-classic

我在我的 Windows7 操作系统上使用 IIS7 来运行我用 ASP3.0 语言编写的项目，并使用 Ms Access 2010 数据库。

我保存在 MsAccess DB 上的大部分数据都是阿拉伯语。如果您有字体，则必须查看示例：سلام

一切都是正确的，我正在使用在 IIS7 上运行的程序。但是有一天，我决定也在另一台计算机上运行这个程序。所以，我在那台计算机上的 Windows7 上安装了 IIS7 和 MsAccess2010，我在第二台计算机上运行了这个程序，我看到存储在数据库中的阿拉伯语文本显示为“???????” （问号）在浏览器上。但是 MsAccess 文件上存储的数据不是 ?????。

我试图通过阅读不同的文章来解决这个问题，但我无法克服。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:49:48.820

数据库和您的页面都需要使用 UTF-8 编码才能使其正常工作。

这应该在你的`<HEAD>`：

```
<meta http-equiv="Content-type" content="text/html; charset=UTF-8"/> 
```

如果数据存储为 Windows-1251 编码，这在使用 MS Word 等时很常见，那么你会有点痛苦。数据仍然会以错误的编码出现。

如果这是您所看到的，您可能需要将这些文档重新加载到 Word 2007/2010 中并将它们重新保存为 UTF-8，然后将它们重新插入到 MS Access 中。

# java - 在 log4j java 中将日志写入标准输出或文件

> ID：10755493
> 
> 赞同：0
> 
> 时间：2012-05-25T13:43:34.130
> 
> 标签：java, log4j

我想根据变量将 log4j 日志写入标准输出或文件。如果设置了变量 writeLogToFile，则日志应写入文件，否则写入标准输出。

我已尝试使用以下代码，但日志被写入文件和标准输出。

```
public class LTE {
    private static Logger logger = Logger.getLogger(LTE.class);

    public static void main(String[] args) {
        /*some code which sets variables writeLogToFile and logFile*/

        BasicConfigurator.configure();
        if(writeLogToFile) {
            FileAppender fappender = new FileAppender(new PatternLayout("%-6p [%t] (%F:%L) %m%n"), logFile);
            logger.addAppender(fappender);
        }

        /*some code which uses info and debug methods to write log*/
    }
} 
```

这在我希望将日志写入标准输出时有效，因为默认情况下日志会写入标准输出。但是当我想将日志写入文件时，这会失败。日志既写入标准输出，也写入文件。

所以，我尝试了以下代码，但这也不起作用。

```
public class LTE {
    private static Logger logger = Logger.getLogger(LTE.class);

    public static void main(String[] args) {
        /*some code which sets variables writeLogToFile and logFile*/

        BasicConfigurator.configure();
        if(writeLogToFile) {
            FileAppender fappender = new FileAppender(new PatternLayout("%-6p [%t] (%F:%L) %m%n"), logFile);
            logger.addAppender(fappender);
            Properties logProperties = new Properties();
            logProperties.setProperty("log4j.additivity.notRootLogger", "false");
            PropertyConfigurator.configure(logProperties);
        }

        /*some code which uses info and debug methods to write log*/
    }
} 
```

我也尝试了以下

```
public class LTE {
    private static Logger logger = Logger.getLogger(LTE.class);

    public static void main(String[] args) {
        /*some code which sets variables writeLogToFile and logFile*/

        BasicConfigurator.configure();
        if(writeLogToFile) {
            FileAppender fappender = new FileAppender(new PatternLayout("%-6p [%t] (%F:%L) %m%n"), logFile);
            logger.addAppender(fappender);
        }
        else {
            ConsoleAppender cappender = new ConsoleAppender(new PatternLayout("%-6p [%t] (%F:%L) %m%n"), "System.out");
            logger.addAppender(cappender);
        }

        /*some code which uses info and debug methods to write log*/
    }
} 
```

有人可以帮我解决这个问题吗？

[编辑]

好的。我想我解决了这个问题。`logger.setAdditivity(false);`我在我的代码中添加了这样一行

```
public class LTE {
    private static Logger logger = Logger.getLogger(LTE.class);

    public static void main(String[] args) {
        /*some code which sets variables writeLogToFile and logFile*/

        BasicConfigurator.configure();
        if(writeLogToFile) {
            FileAppender fappender = new FileAppender(new PatternLayout("%-6p [%t] (%F:%L) %m%n"), logFile);
            logger.addAppender(fappender);
            logger.setAdditivity(false);    //added line here
        }

        /*some code which uses info and debug methods to write log*/
    }
} 
```

现在它工作正常。如果`writeLogToFile=true`然后将日志写入标准输出，否则将其写入文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:02:49.507

您可以使用此示例： [如何使用相同的 log4j 记录器将不同的信息写入两个不同的文件？](https://stackoverflow.com/questions/4707847/how-to-write-different-information-to-two-different-files-using-same-logger-of-l)

然后在您的程序中决定使用哪个记录器。

```
if(writeLogToFile)
   logger.debug("My normal log");
else
   otherLogger.info("My special text"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:57:34.853

也许您已将记录器配置为已经包含 ConsoleAppender？您应该尝试显示所有 Appender：尝试使用 Logger.getAllAppenders() 并显示它们的类。

您还可以查看 log4j.properties 和 log4j.xml 文件。

# c++ - 通过引用传递指针？

> ID：10755496
> 
> 赞同：-7
> 
> 时间：2012-05-25T13:43:45.643
> 
> 标签：c++

> **可能重复：**
> [在 C++ 中通过引用传递指针](https://stackoverflow.com/questions/9231483/passing-a-pointer-by-reference-in-c)

我有一个需要修改指针的函数，例如：

```
bool someFunc(Something* something)
{
   something = somethingElse;
   return true;
} 
```

指针是按值传递的，不会被修改。我该如何修改它？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T13:45:12.600

只需将函数签名更改为

```
bool someFunc(Something* &something) 
```

你会得到一个可修改的指针`someFunc()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T13:45:21.700

```
bool someFunc(Something * &something) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T13:45:55.127

```
bool someFunc ( Something * & something ); 
                         // ^ notice the reference symbol 
```

# javascript - Jquery .append 和 appendto() 悲伤

> ID：10755501
> 
> 赞同：0
> 
> 时间：2012-05-25T13:44:27.300
> 
> 标签：javascript, jquery, html

我需要将以下 HTML 片段附加到文档中，用一个值替换 display_spinner 参数：

```
<script type="text/javascript" src="http://public.tableausoftware.com/javascripts/api/viz_v1.js"></script>
<div class="tableauPlaceholder" id="tableauPlaceholder" style="visibility:hidden;width:654px; height:1469px;background-image: url('http://tableau.russellchristopher.org:81/Background.gif'); top: 0px; left: 0px; width: 100%; margin-left: 76px;">
    <noscript>
        <a href="#"><img alt="Analytics, Inc. " 
                    src="http://tableau.russellchristopher.org:81/Background.gif" 
                    style="border: none" /></a>
    </noscript>
    <object class="tableauViz" width="654" height="1469" style="display:none;">
        <param name="host_url" value="http%3A%2F%2Fpublic.tableausoftware.com%2F"
        />
        <param name="site_root" value="" />
        <param name="name" value="AnalyticsIncJavaScript&#47;AnalyticsInc" />
        <param name="tabs" value="no" />
        <param name="toolbar" value="yes" />
        <param name="static_image" value="tableau.russellchristopher.org:81/Background.gif"
        />
        <param name="animate_transition" value="yes" />
        <param name="display_static_image" value="yes" />
        <param name="display_spinner" value="" id="display_spinner" />
        <param name="display_overlay" value="yes" />
        <param name="display_count" value="yes" />
    </object>
</div> 
```

这是我想出的（这里的JSFiddle：http: [//jsfiddle.net/9vBGq/](http://jsfiddle.net/9vBGq/)）

```
$(document).ready(function () {
    var $placeholder = $('<div class="tableauPlaceholder" style="width:654px; height:1469px;background-image:  url("http%3A%2F%2Ftableau.russellchristopher.org:81%2FBackground.gif"); top: 0px; left: 0px; width: 100%; margin-left: 76px;"></div>'),
        $noscript = $('<noscript> <a href="#"><img alt="Analytics, Inc. " src="http%3A%2F%2Ftableau.russellchristopher.org:81/Background.gif" style="border: none" /></a></noscript>'),
        $tableauViz = $('<object class="tableauViz" width="654" height="1469"></object>'),
        $host_url = $('<param name="host_url" value="http%3A%2F%2Fpublic.tableausoftware.com%2F">'),
        $site_root = $('<param name="site_root" value="" />'),
        $sheetName = $('<param name="name" value="AnalyticsIncJavaScript&#47;AnalyticsInc" />'),
        $tabs = $('<param name="tabs" value="no" />'),
        $toolbar = $('<param name="toolbar" value="yes" />'),
        $static_image = $('<param name="static_image" value="http://tableau.russellchristopher.org:81/Background.gif"/>'),
        $animate_trasnsition = $('<param name="animate_transition" value="yes" />'),
        $display_static_image = $('<param name="display_static_image" value="yes" />'),
        $display_overlay = $('<param name="display_overlay" value="yes" />'),
        $display_count = $('<param name="display_count" value="yes" />'),
        $display_spinner = $('<param name="display_spinner" value="' + 'no' + '" />');
    $placeholder.append($noscript).append($tableauViz).append($host_url).append($site_root).append($sheetName).append($tabs).append($toolbar).append($static_image).append($animate_trasnsition).append($display_static_image).append($display_overlay).append($display_count).append($display_spinner).appendTo('body');
    console.log(document.body);
});​ 
```

从我在 console.log 中看到的内容来看，存在多个问题 - 我对这些东西还太陌生，无法确切知道原因：

![在此处输入图像描述](../Images/d3055d8f4059d9f0600b65cbcdb174ef.png)

*   我的 URL 编码`<div>`看起来很糟糕。我做错什么了？
*   `<a>`嵌套在 noscript 块内的标签看起来很糟糕
*   `</object>`在我列出我的参数后它应该关闭时有一个结束标签
*   关闭`/>`每个我的参数都丢失了——我假设 URL 编码又是奇怪的，但不确定如何处理。

我怀疑你是专业人士，并在几秒钟内将我踢向正确的方向......请在你认为合适的时候踢我？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:57:32.407

我认为最好的解决方案是在您的 html 中创建一个模板并阅读它，而不是在 javascript 中制作它。

就像是

```
<!-- template code follows -->
<script type="text/template" id="tableau">
<div class="tableauPlaceholder" id="tableauPlaceholder" ..
..snip..
        <param name="display_spinner" value="{placeholder}" id="display_spinner" />
..snip..
</div>
</script>
<!-- end of template --> 
```

那么您需要此代码来加载模板并更改占位符

```
var template = $('#tableau').html(),
    filledTemplate = template.replace('{placeholder}','value for spinner');

$('body').append( filledTemplate ); 
```

**演示在** [http://jsfiddle.net/gaby/9vBGq/1/](http://jsfiddle.net/gaby/9vBGq/1/)

（*我已经`noscript`从模板中删除了元素，因为一切都是通过脚本完成的*）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:52:38.960

> 我的 URL 编码看起来很糟糕。我做错什么了？

你过早地结束了风格。从背景图片 url 中删除引号。

```
var $placeholder = $('<div style="background: url(some_very_long_url)"></div>') 
```

* * *

> 在我列出我的参数后它应该关闭时有一个结束标签

它已经自己关闭了。你所做的是将参数附加到`$placeholder`，而不是`$tableauViz` 如果你想要它们，你应该将它们附加到它。

```
$tableauViz.append(stuff).append(some_more_stuff) 
```

* * *

> 在我的每个参数上关闭 /> 都丢失了-再次 URL 编码奇怪，我假设但不确定如何处理。

控制台忽略`/>`显示期间。没关系，他们都是兄弟姐妹。如果不是，每个参数都将嵌套在前一个参数中。

* * *

关于`<noscript>`，通过关闭你的 JS 来测试它。这样你就可以看到它是否正确渲染。

# mysql - 对 UPDATE 查询感到困惑。如何将选择转换为使用 MySQL 进行更新？

> ID：10755504
> 
> 赞同：1
> 
> 时间：2012-05-25T13:44:38.217
> 
> 标签：mysql, sql

*我在这里看到了非常相似的问题，但我尝试将以下查询转换为 UPDATE 语句的尝试失败了。*

```
SELECT table.* FROM table JOIN (
  SELECT   column, COUNT(*) AS rank
  FROM     table
  GROUP BY column
) AS t USING (column) WHERE t.rank = 1
ORDER BY t.rank DESC 
```

我想更新使用上面的查询选择的所有结果的列。

如何将其转换为更新语句？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:46:47.483

这应该这样做：

```
update table
set column = 'somevalue'
where id in
(select id from (

SELECT table.* FROM table JOIN (
  SELECT   column, COUNT(*) AS rank
  FROM     table
  GROUP BY column
) AS t USING (column) WHERE t.rank = 1) x) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:47:31.203

不完全确定，但我认为它类似于

```
update tblname set columname = value where tblname.columncompare = (select statement) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:07:33.840

```
INSERT INTO table (id, value)
SELECT table.id, table.value
FROM table
JOIN (
  SELECT   column, COUNT(*) AS rank
  FROM     table
  GROUP BY column
) AS t USING (column)
WHERE t.rank = 1
ORDER BY t.rank DESC
ON DUPLICATE KEY UPDATE value = VALUES(value) 
```

[插入副本](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)以进行救援！

基本上，这允许您像往常一样执行任何 SELECT，然后在 INSERT INTO 前面加上 ON DUPLICATE。

我猜这个查询是组成的，但是过滤和排序同一列有什么意义呢？

# oop - R中的公共和私人插槽？

> ID：10755509
> 
> 赞同：10
> 
> 时间：2012-05-25T13:45:01.973
> 
> 标签：oop, r

在定义类时，R 是否有私有与公共插槽的概念？

如果语言中对此没有严格的特性，是否有通用的命名方案？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-25T14:08:24.133

编辑 ：

提供一点历史：在 setClass 函数中，提供了一个选项“访问”来创建所谓的“特权插槽”，只能通过类提供的 getter 和 setter 访问。这将允许创建私有插槽（通过不提供 getter），但此功能从未实现。当前的帮助页面为`?setClass`：

> 访问权限和版本，包括与 S-Plus 的兼容性，但目前被忽略。

* * *

所以没有私有和公共插槽之类的东西，因为通过`@`符号每个插槽都是可以访问的。就我个人而言，我对此非常满意，因为它允许我使用通过使用包中包含的 getter 和 setter 无法轻松访问的对象的信息。它还允许我通过避免 getter 和 setter 产生的开销来节省繁重的计算。

我不知道有任何命名约定来区分公共和“私人”插槽。您可以通过在“私有”插槽前面加上一个点来为自己做出区分，但这对插槽的行为方式没有影响。这也不是常见的做法，因为大多数 R 程序员并不关心公共和私有插槽。他们只是不为普通用户不应该访问的插槽提供 getter 和 setter。

举一个简单的例子：下面创建一个有两个槽的类，以及一个只有一个槽的 getter 和 setter。

```
setClass("Example",
  representation(
    aslot = "numeric",
    .ahiddenslot = "character"
  )
)

setGeneric("aslot", function(x) standardGeneric("aslot"))

setMethod("aslot","Example",function(x){
    x@aslot
})

setGeneric("aslot<-", function(x,value) standardGeneric("aslot<-"))

setMethod("aslot<-","Example",function(x,value){
    x@aslot <- value
    x
}) 
```

您还可以设置一个`show`不打印隐藏插槽的方法：

```
setMethod("show","Example",function(object){
  cat("Example with value for aslot: ", object@aslot,"\n")
}) 
```

这给出了以下正常使用：

```
> X <- new("Example",aslot=1,.ahiddenslot="b")
> X
Example with value for aslot:  1 
> aslot(X)
[1] 1
> aslot(X) <- 3 
```

但是 .ahiddenslot 仍然可以访问：

```
> slot(X,".ahiddenslot")
[1] "b" 
```

# jquery - 使用 fadeIn() fadeOut() 函数闪烁 div/奇怪的行为

> ID：10755513
> 
> 赞同：0
> 
> 时间：2012-05-25T13:45:14.570
> 
> 标签：jquery, anchor, fadein, fadeout, behavior

我正在为博主博客开发一个具有索引功能的自动锚定 jquery 插件。这是 jsfiddle： http: [//jsfiddle.net/fd7ee/7/](http://jsfiddle.net/fd7ee/7/) 它几乎完成了，但是当我点击其中一个标题然后点击“mostra tutto/show all”时我有一个奇怪的行为。div 在淡入淡出期间开始闪烁半秒钟。此外，在淡入/淡出效果期间，标题覆盖索引菜单并使其在动画持续之前无法使用（您可以通过在索引菜单前面闪烁的绿色边框注意到它）。我无法找到这种行为的解决方案，它可能是什么？再次感谢，文森佐

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:54:11.753

如果您添加`z-index:1;`到您的`div.autoanchors`css 类，它将起作用。

[更新了 jsFiddle](http://jsfiddle.net/fd7ee/8/)

# java - 春季Tomcat问题

> ID：10755516
> 
> 赞同：3
> 
> 时间：2012-05-25T13:45:20.560
> 
> 标签：java, spring, tomcat

我有 Spring 3.1.1.jar 和 Tomcat 6.0。当我尝试运行我简单的一个 bean 应用程序（它只有一个 hello world stmt）时，我得到以下异常。

```
 May 25, 2012 6:58:51 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /usr/java/jdk1.7.0/jre/lib/i386/server:/usr/java/jdk1.7.0/jre/lib/i386:/usr/java/jdk1.7.0/jre/../lib/i386:/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/lib/i386/client:/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0/jre/lib/i386::/usr/java/packages/lib/i386:/lib:/usr/lib
May 25, 2012 6:58:51 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:CMWP' did not find a matching property.
May 25, 2012 6:58:51 PM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
May 25, 2012 6:58:51 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 886 ms
May 25, 2012 6:58:51 PM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
May 25, 2012 6:58:51 PM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.32
May 25, 2012 6:58:52 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
May 25, 2012 6:58:52 PM org.springframework.web.context.ContextLoader initWebApplicationContext
INFO: Root WebApplicationContext: initialization started
May 25, 2012 6:58:52 PM org.springframework.context.support.AbstractApplicationContext prepareRefresh
INFO: Refreshing Root WebApplicationContext: startup date [Fri May 25 18:58:52 IST 2012]; root of context hierarchy
May 25, 2012 6:58:52 PM org.springframework.web.context.ContextLoader initWebApplicationContext
SEVERE: Context initialization failed
java.lang.ExceptionInInitializerError
    at org.springframework.context.support.AbstractRefreshableApplicationContext.createBeanFactory(AbstractRefreshableApplicationContext.java:195)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:128)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:522)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:436)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4205)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4704)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.lang.NullPointerException
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.<clinit>(DefaultListableBeanFactory.java:106)
    ... 22 more

May 25, 2012 6:58:52 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
java.lang.ExceptionInInitializerError
    at org.springframework.context.support.AbstractRefreshableApplicationContext.createBeanFactory(AbstractRefreshableApplicationContext.java:195)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:128)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:522)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:436)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4205)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4704)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.lang.NullPointerException
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.<clinit>(DefaultListableBeanFactory.java:106)
    ... 22 more

May 25, 2012 6:58:52 PM org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart
May 25, 2012 6:58:52 PM org.apache.catalina.core.StandardContext start
SEVERE: Context [/CMWP] startup failed due to previous errors
May 25, 2012 6:58:52 PM org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
May 25, 2012 6:58:52 PM org.springframework.context.support.AbstractApplicationContext doClose
INFO: Closing Root WebApplicationContext: startup date [Fri May 25 18:58:52 IST 2012]; root of context hierarchy
May 25, 2012 6:58:52 PM org.springframework.context.support.AbstractApplicationContext doClose
WARNING: Exception thrown from ApplicationListener handling ContextClosedEvent
java.lang.IllegalStateException: ApplicationEventMulticaster not initialized - call 'refresh' before multicasting events via the context: Root WebApplicationContext: startup date [Fri May 25 18:58:52 IST 2012]; root of context hierarchy
    at org.springframework.context.support.AbstractApplicationContext.getApplicationEventMulticaster(AbstractApplicationContext.java:337)
    at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:324)
    at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1025)
    at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:988)
    at org.springframework.web.context.ContextLoader.closeWebApplicationContext(ContextLoader.java:556)
    at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:142)
    at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4244)
    at org.apache.catalina.core.StandardContext.stop(StandardContext.java:4879)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4749)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)

May 25, 2012 6:58:52 PM org.springframework.context.support.AbstractApplicationContext doClose
WARNING: Exception thrown from LifecycleProcessor on context close
java.lang.IllegalStateException: LifecycleProcessor not initialized - call 'refresh' before invoking lifecycle methods via the context: Root WebApplicationContext: startup date [Fri May 25 18:58:52 IST 2012]; root of context hierarchy
    at org.springframework.context.support.AbstractApplicationContext.getLifecycleProcessor(AbstractApplicationContext.java:350)
    at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1033)
    at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:988)
    at org.springframework.web.context.ContextLoader.closeWebApplicationContext(ContextLoader.java:556)
    at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:142)
    at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4244)
    at org.apache.catalina.core.StandardContext.stop(StandardContext.java:4879)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4749)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)

May 25, 2012 6:58:52 PM org.apache.catalina.core.StandardContext listenerStop
SEVERE: Exception sending context destroyed event to listener instance of class org.springframework.web.context.ContextLoaderListener
java.lang.IllegalStateException: BeanFactory not initialized or already closed - call 'refresh' before accessing beans via the ApplicationContext
    at org.springframework.context.support.AbstractRefreshableApplicationContext.getBeanFactory(AbstractRefreshableApplicationContext.java:172)
    at org.springframework.context.support.AbstractApplicationContext.destroyBeans(AbstractApplicationContext.java:1066)
    at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1040)
    at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:988)
    at org.springframework.web.context.ContextLoader.closeWebApplicationContext(ContextLoader.java:556)
    at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:142)
    at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4244)
    at org.apache.catalina.core.StandardContext.stop(StandardContext.java:4879)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4749)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)

May 25, 2012 6:58:52 PM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
May 25, 2012 6:58:52 PM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
May 25, 2012 6:58:52 PM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/32  config=null
May 25, 2012 6:58:52 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 600 ms 
```

* * *

我的 /WEB-INF/applicationContext.xml 看起来像这样

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
    <bean name="abcd" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
        <property name="jobClass" value="YYYY" />
    </bean>

    <bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <property name="triggers">
            <list>
                <ref bean="cronTrigger" />
            </list>
        </property>
    </bean>

    <!-- the cron trigger that is used by the scheduler to run the syncdbjob -->
    <bean id="cronTrigger"
        class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="abcd" />
        <property name="cronExpression" value="0 17 18 * * ?" />
    </bean>
</beans> 
```

* * *

我的 web.xml 看起来像这样

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>CMWP</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>

 <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:applicationContext.xml</param-value>
  </context-param>  
<listener>  
 <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>  
</listener>    
</web-app> 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T13:49:28.387

作为问题根源的行包含：

```
javaxInjectProviderClass = cl.loadClass("javax.inject.Provider"); 
```

并且似乎`cl`( `DefaultListableBeanFactory.class.getClassLoader()`) 为空，这意味着 DefaultListableBeanFactory 是由 ApplicationClassLoader 加载的，而不是 Tomcat 的 WebApp 或 Shared 类加载器。

也许您已将 spring-beans-3.1.1.RELEASE.jar 放入认可目录或 Java 安装中的某个位置？

# eclipse - 在 Egit 上同步。一切都是外向的

> ID：10755525
> 
> 赞同：2
> 
> 时间：2012-05-25T13:46:14.910
> 
> 标签：eclipse, git, egit

我在 Eclipse 上使用 Egit。

我已经克隆了一个项目，并在 Eclipse 上导入了它。我还没有做任何改变。

当我执行“拉取”或“从上游获取”时，它会按预期显示“没有要更新的内容 - 一切都是最新的”。但是，当我执行“同步工作区”时，所有文件都出现“传出”，这是用黑色箭头标记的。无论我在“比较编辑器”中打开哪个文件，都会出现一个涵盖所有行的巨大差异。

以防万一，我检查了我是否以与项目创建者相同的方式配置了“文本文件行分隔符”和“文本文件编码”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:13:01.987

依次进行“Untrack”，“Add to Index”和“Overwrite”似乎解决了问题，但无论如何，我觉得这是一个可疑的行为。

# jquery - jQuery 警报和转义引号

> ID：10755529
> 
> 赞同：1
> 
> 时间：2012-05-25T13:46:29.153
> 
> 标签：jquery

我有一个 php 页面，当用户将产品添加到购物车时，我会在该页面上显示 jQuery 警报。警报中显示的消息是来自存储所有语言元素的 php 页面的变量。

```
$cartaddeditem='The product was added to your cart.\r\n You can view your <a href=\'cart.php?action=show\'>shopping cart</a> or click OK to continue shopping'; 
```

然后，在页面上：

```
<body onload="jAlert('success', '<?=$cartaddeditem?>', '<?=$minicart?>');" <? } > 
```

问题是由于 $cartaddeditem var 中的引号导致警报无法触发，并且我在 firebug 中收到错误消息：

```
Error: missing ) after argument list
Line: 1, Column: 22
Source Code:
jAlert('success', The product was added to your cart.\r\n You can view your <a href=\ 
```

如何转义 jQuery 消息字符串中的引号？我尝试了几种带有双引号和单引号、一两个反斜杠的转义类型，但没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:48:41.063

尝试使用双引号来引用您的 HTML 属性。

```
$cartaddeditem = 'The product was added to your cart.\r\n You can view your <a href="cart.php?action=show">shopping cart</a> or click OK to continue shopping'; 
```

我还可以建议不要添加`onload`属性`$(document).ready(`而是使用吗？

```
$(function(){
    jAlert('success', '<?=$cartaddeditem?>', '<?=$minicart?>');
}); 
```

**更新**：您还可以`json_encode`用来确保引号不会发生冲突。 `json_encode`也适用于字符串，它输出一个用双引号括起来的字符串（所以不要在参数周围添加引号）。

```
$(function(){
    jAlert('success', <?=json_encode($cartaddeditem)?>, <?=json_encode($minicart)?>);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:51:18.073

正确转义您的 PHP 输出：

```
<body onload="jAlert('success', 
  <?php echo json_encode($cartaddeditem); ?>, 
  <?php echo json_encode($minicart); ?>);" <? } > 
```

**更新**

因为它写在标签属性中，所以双引号不起作用（感谢 Rocket）！

所以你要么必须希望`addslashes`就足够了：

```
<body onload="jAlert('success', 
  '<?php echo addslashes($cartaddeditem); ?>', 
  '<?php echo addslashes($minicart); ?>');" <? } > 
```

或者你按照火箭在他的回答中描述的那样做。

**更新 2**

顺便说一句，您应该将 PHP 字符串更改为双引号，以便将其`\r\n`评估为换行符：

```
$cartaddeditem = "The product was added to your cart.\r\n You can view your <a href='cart.php?action=show'>shopping cart</a> or click OK to continue shopping"; 
```

# java - 如何将“rājshāhi”打印到 Eclipse 输出控制台？

> ID：10755531
> 
> 赞同：2
> 
> 时间：2012-05-25T13:46:36.907
> 
> 标签：java, eclipse, unicode

我尝试了以下方法：

```
System.out.println("rājshāhi");
new PrintWriter(new OutputStreamWriter(System.out), true).println("rājshāhi");
new PrintWriter(new OutputStreamWriter(System.out, "UTF-8"), true).println("rājshāhi");
new PrintWriter(new OutputStreamWriter(System.out, "ISO-8859-1"), true).println("rājshāhi"); 
```

产生以下输出：

```
r?jsh?hi
r?jsh?hi
rÄ?jshÄ?hi
r?jsh?hi 
```

那么，我做错了什么？

谢谢。

附言

我在 Windows 7 上使用 Eclipse Indigo。输出到 Eclipse 输出控制台。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:56:09.193

java 文件必须正确编码。查看该文件的属性，并正确设置编码：

![在此处输入图像描述](../Images/6731deeb0203094d58bdd6dd6c0e21a3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T13:54:57.757

`System.out.println`如果你有最新版本的 eclipse ，你所做的应该可以工作，即使是简单的。

请看以下内容：

*   您正在使用的 Eclipse 版本
*   文件是否编码正确。请参阅@Matthew 的回答。我认为会是这种情况，否则 Eclipse 将不允许您保存文件（会警告“不支持的字符”）
*   控制台字体 ( `Windows -> Preferences -> Fonts -> Default Console Font`)
*   将文本保存到文件时是否正确获取字符

![在此处输入图像描述](../Images/980c77fd036b81163ca15c2bb413f239.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T13:52:23.097

实际上，复制您的代码并在我的计算机上运行它给了我以下输出：

```
rājshāhi
rājshāhi
rājshāhi
r?jsh?hi 
```

看起来除了最后一行外，所有行都有效。获取您的系统默认字符集（请参阅[此答案](https://stackoverflow.com/a/1749237/971592)）。我的是UTF-8。看看更改默认字符集是否会有所不同。

以下任何一行都将获得您的默认字符集：

```
System.out.println(System.getProperty("file.encoding"));
System.out.println(Charset.defaultCharset()); 
```

要更改默认编码，请参阅[此答案](https://stackoverflow.com/a/623036/971592)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:10:34.647

确保在创建类时分配文本文件编码值`UTF-8`。稍后使用任何其他文本文件编码创建一个类后，您将无法更改编码样式，即使 eclipse 允许您它不会反映。因此，使用 TextFile Encoding 创建一个新类`UTF 8`。它肯定会工作。

编辑：在您的情况下，尽管您尝试以编程方式分配文本文件编码，但它不会产生任何影响，它正在采用容器继承编码（Cp1252）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-05T04:46:22.633

使用最新的 Eclipse 版本帮助我在控制台上实现了 UTF-8 编码我使用了 Luna 版本的 Eclipse 并设置了 Properties->Info->Others->UTF-8

# java - 如何在不使用 GPS 的情况下以编程方式检测 android 设备当前位于哪个国家/地区？

> ID：10755534
> 
> 赞同：6
> 
> 时间：2012-05-25T13:46:47.500
> 
> 标签：java, android

当我的应用程序运行时，我想检测当前位置的国家名称并为该特定国家名称做一些事情，我可以使用地理编码器、gps 轻松完成。但我想从 Locale 或如果有更多可用的东西得到它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-11-05T09:26:42.057

使用此链接[http://ip-api.com/json](http://ip-api.com/json)，这将以 json 格式提供所有信息。从这个json你可以很容易地得到这个国家。该站点使用您当前的 IP 运行，它会自动检测 IP 和回发详细信息。

文档[http://ip-api.com/docs/api:json](http://ip-api.com/docs/api:json) 希望对您有所帮助。

这就是我得到的。

```
{
"as": "AS55410 C48 Okhla Industrial Estate, New Delhi-110020",
"city": "Kochi",
"country": "India",
"countryCode": "IN",
"isp": "Vodafone India",
"lat": 9.9667,
"lon": 76.2333,
"org": "Vodafone India",
"query": "123.63.81.162",
"region": "KL",
"regionName": "Kerala",
"status": "success",
"timezone": "Asia/Kolkata",
"zip": "" 
```

}

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T14:07:56.753

我不知道 Android API 是否允许您检查相关 GSM 网络的提供商代码。如果可能的话，您可以使用此代码进行检查，即对照此列表：[http](http://www.techgsm.com/page/gsm-provider-codes/network-provider-identify-codes.html) ://www.techgsm.com/page/gsm-provider-codes/network-provider-identify-codes.html找出哪个国家/地区手机是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-20T23:23:45.967

您可以（并且应该）使用 Android 的国家/地区检测器服务。该服务由三个方法组成，都在它们的 .aidl 中定义，使您能够获取国家代码、注册侦听器或删除它。具体来说，您想要第一个 -`Country detectCountry();`它返回一个 android.location.Country 对象（AOSP 中的 framework/base/location/java/android/location/Country.java）。我假设您知道如何以编程方式调用方法（您需要 getSystemService ("country_detector")）。

要从命令行进行测试，请尝试：

```
shell@flounder:/ $ service call country_detector 1
Result: Parcel(
  0x00000000: 00000000 00000001 00000002 00530055 '............U.S.'
  0x00000010: 00000000 00000003 1d809dda 00000000 '................') 
```

对象序列化基本上只不过是 2 个字母的国家/地区代码（此处为：US）、来源（此处为 3，暗示这是从 Locale 收集到的）和一个时间戳（1d809dda...），实际上并非如此重要的。您不必担心序列化，因为对象是 Parcelable。

# git - 应用补丁并跨分支包含丢失的文件

> ID：10755536
> 
> 赞同：0
> 
> 时间：2012-05-25T13:46:57.473
> 
> 标签：git

我想应用补丁并包含丢失的文件。新文件和补丁来自一个分支，并希望将其应用到我的主分支。我正在寻找一个单班轮，如果它存在的话。我想我想合并补丁中提到的丢失文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:53:09.103

你可以挑选它们：

*   [http://alblue.bandlem.com/2011/06/git-tip-of-week-cherry-picking.html](http://alblue.bandlem.com/2011/06/git-tip-of-week-cherry-picking.html)
*   [Git从以前的提交范围创建分支？](https://stackoverflow.com/questions/9853681/git-create-branch-from-range-of-previous-commits)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:40:14.880

如果我正确理解了您的问题，您想合并一个分支，该分支具有您期望对主分支进行的必要更改。如果这是对的，那么

结帐大师

```
git checkout master 
```

合并对 ​​master 进行更改的分支

```
git merge branch_name 
```

如果我弄错了您的问题，而您所拥有的只是一组补丁，例如 000x-feature-y.patch，然后是 checkout master，然后像这样将所有补丁应用于它

```
git am /path/to/the/patches/dir/*.patch 
```

如果以上没有回答你的问题，请尽量把你的问题说清楚！

高温高压

# c# - 代码优先：将实体添加到 dbset 时出现空引用异常

> ID：10755537
> 
> 赞同：0
> 
> 时间：2012-05-25T13:46:58.467
> 
> 标签：c#, wpf, ef-code-first

我有一个非常简单的数据库，其中包含 2 个表：Test 和 Tester，Test 有一个 Id 和一个 Name，Tester 有一个 Id、一个 TestName 和一个 TestId。两者之间存在 1 : N 连接。我只是喜欢做的是向其中一个表添加一个新条目，但我得到了一个空引用异常。

我有一个上下文类：

```
 public class TestContext : DbContext, ITestContext
{
    public DbSet<Test> Tests { get; set; }
    public DbSet<Tester> Testers { get; set; }

    public TestContext()
        : base(){}

    public TestContext(DbConnection connection) : base (connection, false)
    {

    }

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new TestConfiguration());
        modelBuilder.Configurations.Add(new TesterConfiguration());
    }
} 
```

这两个配置文件包含关系和一些限制。

我有一个 EntityManager 类，可以将新实体添加到对象之一：

```
 private ITestContext _context;

    public ObservableCollection<Test> Tests { get; set; }
    public ObservableCollection<Tester> Testers { get; set; }

    private static EntityManager _instance;
    public static EntityManager Instance
    {
        get { return _instance ?? (_instance = new EntityManager()); }
    }

    private EntityManager()
    {
        Tests = new ObservableCollection<Test>();
        Testers = new ObservableCollection<Tester>();

        Database.DefaultConnectionFactory = new SqlConnectionFactory("System.Data.SqlClient");
        connection = Database.DefaultConnectionFactory.CreateConnection(@"Data Source=.;Initial Catalog=Test;Integrated Security=True");

        _context = new TestContext(connection);

        _context.Tests.Add(new Test {Name = "new Test"});
        _context.SaveChanges();
        LoadData();
    }

    private void LoadData()
    {
        Tests.Clear();
        Testers.Clear();

        _context.Tests.ToList().ForEach(Tests.Add);
        _context.Testers.ToList().ForEach(Testers.Add);
    } 
```

因此，当我尝试将“新测试”添加到测试中时，我得到了一个空引用异常。如果我将添加部分排除在外，它会完美运行，但是我失去了将新实体添加到集合的功能。有人可以告诉我可能出什么问题吗？干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-11T15:10:44.457

希望这会帮助某人...

我遇到了一个类似的问题，在 DbSet.Add 上有一个 NullReferenceException，有趣的是它只发生在控制器操作中调用的每个 DbSet 一次。有三个，所以在三个重复请求之后，代码成功了。

**原因：**我在调用 Add 之前调用了异步 DB 读取，最后只等待它。当我将 await 移到这些调用前面时，问题就消失了。

*这会导致问题*

```
var task = UserManager.FindByIdAsync(User.Identity.GetUserId()); // Uses the same DB Context
DbContext.Stages.Add(...);
await task; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:36:04.747

好的。我也遇到了这个问题。对我来说，这是因为我有一个 WPF 应用程序试图在它的一个 ICommands 中读取我的 EntityState，而我的 Entity 正在被事件触发器修改。不知道为什么这是一个问题，因为我看到所有东西都在同一个 Dispatcher 线程上，但是通过使用

```
System.Windows.Application.Current.Dispatcher.BeginInvoke(new Action(() => MyEntity.MyEntityProperty=SomeValue)); 
```

对于我的事件中的代码，我能够解决我的问题。

希望这对其他人有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T12:13:14.263

模型和配置存在问题。表之间的错误连接。

# c# - Mono gtk.RadioButton Clicked 事件触发两次

> ID：10755541
> 
> 赞同：2
> 
> 时间：2012-05-25T13:47:11.570
> 
> 标签：c#, mono, gtk#

我对`Gtk.RadioButton`小部件的`Clicked`事件有疑问。这是示例代码：

```
using System;
using Gtk;

public partial class MainWindow: Gtk.Window
{   
    public MainWindow (): base (Gtk.WindowType.Toplevel)
    {
        Build ();
        RadioButton rbt1 = new RadioButton (null, "rbt1");
        RadioButton rbt2 = new RadioButton (rbt1, "rbt2");
        RadioButton rbt3 = new RadioButton (rbt1, "rbt3");
        VBox vbx1 = new VBox ();
        vbx1.PackStart (rbt1, false, false, 0);
        vbx1.PackStart (rbt2, false, false, 0);
        vbx1.PackStart (rbt3, false, false, 0);
        this.Add (vbx1);
        this.ShowAll ();
        rbt1.Clicked+= HandleClicked;
    rbt2.Clicked+= HandleClicked1;
    rbt3.Clicked+= HandleClicked2;
    }

    void HandleClicked2 (object sender, EventArgs e)
    {
        Console.WriteLine ("rbt3.Clicked");
    }

    void HandleClicked1 (object sender, EventArgs e)
    {
        Console.WriteLine ("rbt2.Clicked");
    }

    void HandleClicked (object sender, EventArgs e)
    {
        Console.WriteLine ("rbt1.Clicked");
    }
 } 
```

问题是：

当我单击 rbt2 时，输出为：

> rbt1.Clicked
> rbt2.Clicked

当我单击 rbt3 时，输出为：

> rbt2.Clicked
> rbt3.Clicked

当我单击 rbt1 时，输出为：

> rbt3.Clicked
> rbt1.Clicked

但我期望的是，当我单击 rbt* 时，唯一的输出是“rbt*.Clicked”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T17:58:42.213

你的期望是错误的。您应该改为连接到`Toggled`信号并检查按钮是否被激活或停用：

```
void HandleToggled(object sender, EventArgs e)
{
    if(sender.Active)
    {
        Console.WriteLine("rbt1.Toggled");
    }
} 
```

在您的情况下，`Clicked`当按钮被激活或停用时会调用该信号。单击停用的按钮会激活它，并停用不同的按钮，因此会调用两个信号。在这`Toggled`两种情况下也会调用信号。我不太确定有什么区别，`Clicked`如果按钮的状态以编程方式更改，则可能无法保证调用它。

# android - 如何使用 Android NDK 修复 Eclipse CDT 错误“无法解析函数‘isdigit’”？

> ID：10755547
> 
> 赞同：6
> 
> 时间：2012-05-25T13:47:27.520
> 
> 标签：android, eclipse, android-ndk, java-native-interface, eclipse-cdt

我将 Eclipse Indigo 与 Android/NDK 混合项目一起使用。我添加了 C++ 特性，几乎一切正常。自动构建工作；也就是说，当我编辑一个文件时，ndk-build 被调用并成功完成 - 没有构建错误。鼠标悬停代码辅助工作（小窗口弹出有关该功能的信息）。如果我将光标放在包含行上并按 F3，则会打开一个相关的头文件（不是我根据我的配置所期望的头文件，而是一个相关的头文件 - 也许是一个线索？）。

如果我在 .cpp 文件中选择以下行，它将打开 $NDKROOT/platform/android-3/arch-arm/usr/include/ctype.h：

```
#include <ctype.h> 
```

（isdigit 在此文件中定义）

但是，Eclipse 坚持 isdigit 没有定义。我已经阅读了许多帖子，暗示静态分析器或索引器应该受到指责，但我尝试了许多建议的解决方案都无济于事。

如果我添加如下一行，错误就会消失，并且该函数的鼠标悬停代码辅助工作：

```
extern int isdigit(int); 
```

同样，这不是链接器错误或编译器错误 - ndk-build 完成时没有错误。这是eclipse里面的东西。谢谢参观！

编辑：我现在认为这是一个代码分析问题。更好的解决方案是编辑代码分析选项，使“无法解析函数”成为警告而不是错误。这样您就可以在“问题”视图中看到警告，但可以继续工作。如果函数真的丢失了，编译器会告诉你的！我还有一个新理论，即问题出在符号链接之后的代码分析器上，因为所有“缺失”的函数都在符号链接的包含文件中。希望对这个理论有任何意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T13:10:16.697

在花了几天时间解决此类问题后，我开发了以下处理问题的方法。

我希望它可以帮助您或其他人：

### 摘要：通常，您在*eclipse*中的问题是由于eclipse配置问题引起的。以下假设您的 C++ 代码可以使用`ndk_build`or `ndk_build.cmd`（在 Windows 上）构建。

*   eclipse juno (4.2) 和 CDT 8.1 版没有乐趣。使用日食靛蓝 (3.7)

*   通过查看“安装新软件”，确保您已安装并启用了 CDT for indigo（8.0X 版）。在某些下载中，它默认为已安装但未*在*indigo 上启用。

*   当您处理本机代码或本机代码的 android 配置时，请*确保*您处于 eclipse 中的 C++/C 视角，*而不是*java 视角。它具有欺骗性，但在 Java 透视图中只有一部分选项可用。如果您在执行“项目 > 属性”时将“C/C++ 通用”视为选项，那么您可以确定您是 C++/C 视角。

*   通常的问题是 C/C++ 领域中的索引器认为没有错误时存在错误（例如，使用 ndk-build 构建工作正常，通常您甚至可以在控制台窗口中看到这一点）。这是由第一个选项卡上“项目 > 属性 > C/C++ 常规”的“路径和符号”部分中的错误路径引起的。

*   要解决此问题，主要工具是右键单击项目，选择“索引”和“搜索未解决的包含”。这将告诉它找不到哪些文件 - 这些通常*不是*您在文件中带有小粉红色标记的文件。

*   要找到正确的文件，请在您的 NDKROOT 目录（安装 NDK 的位置）中搜索。一个典型的添加是： `${NDKROOT}/platforms/android-9/arch-arm/usr/include`或者你的android目标的正确的android-N。由于 android 的多个版本和 C++ 标准库的副本，NDK 中有许多标准包含目录的副本。

### 两大警告

*   当您在 Properties > C/C++ General/Paths and Settings 上更改索引器配置时，eclipse 中的“未解决的包含”视图*不会*自动更新，因此请确保每次再次运行它。eclipse 中的大多数视图都正确执行此更新！

*   此外，eclipse 编辑器中源代码视图中的红色/粉色小错误标记也不会自动更新。您必须以某种方式“触摸”该文件，因为它发现错误现在已修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T22:43:16.740

I worked around this issue via the approach I suggested in my question and haven't been able to find a better way yet.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T12:14:33.807

也许这会有所帮助：

1.  转到项目 > 属性
2.  导航到 C/C++ 构建 > 设置
3.  转到 GCC C 链接器 > 其他设置
4.  在链接器标志中添加以下内容：-lc

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T12:50:23.563

我在使用不同工具链的 Linux 上遇到了同样的问题。即使是最简单的 C++ 代码（如由 hello 向导创建的代码）也会有语法错误，而不会出现构建问题。正如 Thorbjorn Jemander 在另一篇文章中指出的那样，问题出在索引器中，可以通过取消选择“允许包含的启发式结果”选项来消除它。明确地：Winsow -> Preferences -> C/C++ -> Indexer -> 取消选择上述选项。

之后，您可能会看到在编辑器中打开文件并在编辑器页面中单击后突出显示的错误消失...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-27T16:05:50.943

您是否尝试过重建索引器？（右键单击项目资源管理器中的项目 index->​​rebuild）有时这会解决问题......如果您从早期版本的 eclipse 升级，您的索引器设置可能会出现问题 - 您可能想尝试恢复索引器默认值（首选项c/c++ 索引器）...希望这会有所帮助——这个问题可能会“令人抓狂”（似乎经常发生）

# android - 在布局结束时在android中设置页脚

> ID：10755552
> 
> 赞同：0
> 
> 时间：2012-05-25T13:47:40.353
> 
> 标签：android, android-layout

我正在查看以下网站的示例。

[布局链接](http://www.androidhive.info/2011/12/android-dashboard-design-tutorial/)

有一个关于开发仪表板布局的精彩教程。

对于主屏幕页脚完全位于布局的末尾，但对于其他屏幕，当我尝试将页脚放置在布局的中间时。

我还附上了代码以便更好地理解。

这是为 style.xml

```
<resources>
<style name="ActionBarCompat">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">50dp</item>
    <item name="android:orientation">horizontal</item>
    <item name="android:background">@drawable/actionbar_background</item>
</style>

<style name="DashboardButton">
    <item name="android:layout_gravity">center_vertical</item>
    <item name="android:layout_width">wrap_content</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:gravity">center_horizontal</item>
    <item name="android:drawablePadding">2dp</item>
    <item name="android:textSize">16dp</item>
    <item name="android:textStyle">bold</item>
    <item name="android:textColor">#ff29549f</item>
    <item name="android:background">@null</item>
</style>    

 <style name="FooterBar">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">40dp</item>
    <item name="android:orientation">horizontal</item>
    <item name="android:background">#dedede</item>
</style>     
</resources> 
```

这是针对 header(action_bar) actionbar_layout.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
style="@style/ActionBarCompat" >

<ImageView
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:clickable="false"
    android:paddingLeft="15dip"
    android:scaleType="center"
    android:src="@drawable/facebook_logo" />

</LinearLayout> 
```

下面是页脚栏footer_layout.xml

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   style="@style/FooterBar"
   android:id="@+id/footerMenuOptions" >
<TextView android:text="www.facebook.com"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textColor="#606060"
        android:gravity="center"
        android:paddingTop="10dip"/>
  </LinearLayout> 
```

以下是附加屏幕的布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"  
android:background="#f8f9fe">
<include layout="@layout/actionbar_layout"/>

<LinearLayout android:layout_width="fill_parent"
            android:layout_height="wrap_content">
        <TextView android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="Events Screen"
                android:textSize="25dip"
                android:padding="15dip"
                android:textStyle="bold"
                android:textColor="#ff29549f"/> 

</LinearLayout>   
 <include layout="@layout/footer_layout"/>
</LinearLayout> 
```

在附图中，我们可以清楚地看到页脚是如何进入屏幕中间的。![布局之间的页脚渲染](../Images/80d00ac4e086acef6fc11f30c4149683.png)

尝试设置`RelativeLayout`但同样的渲染问题

尝试在线性布局中`LinearLayout`设置
`android:layout_alignParentBottom="true"`和放置页脚的包含，`<include layout="@layout/footer_layout">`但呈现相同的问题。

期待你的答复。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:29:04.437

尝试`RelativeLayout`使用它的`android:layout_below`and`android:layout_above`用于中心内容和`android:layout_alignParentBottom`用于`View`坚持底部这样做：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content" android:layout_height="wrap_content"
    android:orientation="vertical">
    <RelativeLayout android:layout_width="fill_parent"
        android:layout_height="wrap_content" android:id="@+id/top_control_bar">
        <include layout="@layout/actionbar_layout"/>
    </RelativeLayout>
    <LinearLayout android:id="@+id/bottom_control_bar"
        android:layout_width="fill_parent" android:layout_height="wrap_content"
        android:layout_alignParentBottom="true">
         <include layout="@layout/footer_layout"/>
    </LinearLayout>
    <LinearLayout android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/top_control_bar"
            android:layout_above="@id/bottom_control_bar">
            <TextView android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="Events Screen"
                    android:textSize="25dip"
                    android:padding="15dip"
                    android:textStyle="bold"
                    android:textColor="#ff29549f"/> 

    </LinearLayout>   

</RelativeLayout> 
```

# apache-flex - 如何使用 AsyncListView 作为 AdvancedDataGrid 的数据提供者来显示分层数据？

> ID：10755553
> 
> 赞同：0
> 
> 时间：2012-05-25T13:47:41.687
> 
> 标签：apache-flex

我想使用 AsyncListView 通过远程处理获取数据并将其作为数据提供者提供给 AdvancedDataGrid。我正在使用 [博客] [http://www.jamesward.com/2010/10/11/data-paging-in-flex-4/中的 PagedList 组件](http://www.jamesward.com/2010/10/11/data-paging-in-flex-4/)

AdvancedDataGrid 未填充记录。我已经对运行良好的简单数据网格进行了测试。

这里有什么问题？

这是代码：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
     xmlns:s="library://ns.adobe.com/flex/spark" 
     xmlns:mx="library://ns.adobe.com/flex/mx"
     xmlns:local="*"
     width="400" height="300">

<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->

    <local:PagedList id="pagedList" pageSize="100" length="1000"  
                                             loadItemsFunction="loadItems"/>
    <s:AsyncListView id="asyncListView" list="{pagedList}" 
                          createPendingItemFunction="handleCreatePendingItemFunction"/>
    <s:RemoteObject id="ro" destination="helloService" 
                       endpoint="http://localhost:8080/SpringRemoting/messagebroker
                                 /amf"/>

</fx:Declarations>

<fx:Script>
    <![CDATA[
        import mx.collections.ArrayCollection;
        import mx.collections.Grouping;
        import mx.collections.GroupingCollection;
        import mx.collections.GroupingField;
        import mx.collections.IList;
        import mx.collections.errors.ItemPendingError;
        import mx.controls.Alert;
        import mx.controls.List;
        import mx.events.FlexEvent;
        import mx.rpc.AsyncResponder;
        import mx.rpc.AsyncToken;
        import mx.rpc.events.FaultEvent;
        import mx.rpc.events.ResultEvent;
        import mx.utils.ObjectUtil;

        private function handleCreatePendingItemFunction(index:int, ipe:ItemPendingError):Object {
            mx.controls.Alert.show("handleCreatePendingItemFunction index = " + index + " : " + ipe.message); 
            return {};
        }

        public function loadItems(list:IList, start:uint, count:uint):void
        {
            mx.controls.Alert.show("loadItems lenght : start = " + list.length + " : " + start);
            var asyncToken:AsyncToken = ro.getRecordsFromDB(start, count);
            asyncToken.addResponder(new AsyncResponder(onResult, onFault, start));

        }

        private function onResult(event:ResultEvent, token:Object):void {
            //1\. Fetch data from database

            var items:Vector.<Object> = new Vector.<Object>();
            for each (var item:Object in event.result ) {
                items.push(item);
            }

            //2\. Update pagedList
            pagedList.storeItemsAt(items, token as int);

            //3\. Update GroupingCollection's source 
            asyncListView.list = pagedList;
            gc.source = asyncListView.list;
            gc.refresh();
            adg1.validateNow();
        }

        private function onFault(event:FaultEvent, token:Object):void {
            mx.controls.Alert.show("fault : " + event.fault.message);
        }

    ]]>
</fx:Script>

<mx:AdvancedDataGrid id = "adg1" 
                     initialize="gc.refresh();"
                     sortExpertMode="true"
                     defaultLeafIcon="{null}" 
                     folderClosedIcon="{null}"
                     folderOpenIcon="{null}"
                     height="200"
                     width="500"
                     displayItemsExpanded="false"
                     x="10">
    <mx:dataProvider>
        <mx:GroupingCollection2 id="gc" 
                                childrenField="col1"
                                >
            <mx:grouping>
                <mx:Grouping label="GroupLabel1">
                    <mx:GroupingField  name="col1"> </mx:GroupingField>
                    <mx:GroupingField  name="col2"> </mx:GroupingField>
                    <mx:GroupingField  name="col3"> </mx:GroupingField>
                    <mx:GroupingField  name="col4"> </mx:GroupingField>
                </mx:Grouping>  
            </mx:grouping>
        </mx:GroupingCollection2>
    </mx:dataProvider>
    <mx:columns>
        <mx:AdvancedDataGridColumn dataField="GroupLabel1" headerText="col1" />
        <mx:AdvancedDataGridColumn dataField="col2" />
        <mx:AdvancedDataGridColumn dataField="col3" />
        <mx:AdvancedDataGridColumn dataField="col4" />
        <mx:AdvancedDataGridColumn dataField="col5" />
    </mx:columns>
</mx:AdvancedDataGrid>

<mx:DataGrid dataProvider="{asyncListView}" x="10" y="300">
    <mx:columns>
        <mx:DataGridColumn dataField="col1"/>
        <mx:DataGridColumn dataField="col2"/>
        <mx:DataGridColumn dataField="col3"/>
        <mx:DataGridColumn dataField="col4"/>
        <mx:DataGridColumn dataField="col5"/>
        <mx:DataGridColumn dataField="col6"/>
    </mx:columns>
</mx:DataGrid> 
```

# c# - C# MVC3 连接 SDF 数据表

> ID：10755554
> 
> 赞同：1
> 
> 时间：2012-05-25T13:47:41.587
> 
> 标签：c#, database, asp.net-mvc-3, razor

我创建了一个管理项目的 MVC 3 Razor 应用程序，并且应该`Sections`在这些`Projects`.

因此，我制作了一个模型`Projects.cs`、控制器`ProjectsController`，并为自己准备了一个`Projects.sdf`数据表。工作得很好

然后我添加了相同的 for `Sections`，但`Sections`应该有一个名为`projectID`（当然是）与`ID`in连接（连接）的字段`Projects.sdf`；另外，我需要它能够被排序`projectID`，并且从`DropDown`

例如：`DropDown`用于更改表数据。如果假设我从项目列表中选择*project1*，我希望列表与 CRUD 一起显示其中的所有`Sections`内容。`Project`

我已经尝试了几件事，但到目前为止都没有奏效，我知道如何在常规应用程序中做到这一点，但在 MVC 中却不知道，所以我请求一些帮助。还尝试添加视图并使其从模型数据中填充`DropDown`，但一点也不好。`Sections``Project`

所以我需要关于如何做到这一点的帮助:(

谢谢，麻烦您了。

**添加**

项目有很多部分，是的，我正在使用 EF，但正如我所说，对它不太有经验。

至于数据上下文，这是`Project`

```
namespace MyProject.Models
{
    public class Projects
    {
        public int ID { get; set; }
        public string projectName { get; set; }
        public string shortDesc { get; set; }
    }

    public class ProjectsDBContext : DbContext 
    {
        public DbSet<Projects> Projects { get; set; }        
    }
} 
```

这是`Section`

```
namespace MyProject.Models
{
    public class Sections
    {
        public int ID { get; set; }
        public int projectID { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
    }

    public class SectionsDBContext : DbContext 
    {
        public DbSet<Sections> Sections { get; set; }
    }
} 
```

**加法2**

所以我做了一个模型命名`MyProjectModels.cs`

```
namespace MyProject.Models 
{
    public class Project
    {
        public int ID { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
    }

    public class Section
    {
        public int ID { get; set; }
        public int projectID { {get; set;}
        public string Name { get; set; }
        public string Description { get; set;}
    }
} 
```

所以基本上我有点想明白了。请让我知道这对于模型是否可以，或者我需要将它们放在单独的文件中吗？另外，我应该如何从这一点声明上下文，提示就足够了:)

谢谢

* * *

我就是这样做的。它显示正确，但我不知道如何使用它，例如在表格中显示不同的值......

```
<select id="select1" name="select1">
        @foreach (var item in Model.Enrollments)
        {
        <option value=@Html.DisplayFor(modelItem => item.Course.Title)>@Html.DisplayFor(modelItem => item.Course.Title)</option>
        }
</select> 
```

我的意思是表中的不同值，当我在这种情况下选择不同的注册时。我想在表格中显示不同的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:54:57.367

你真的需要有不同的 dbcontexts 吗？如果它是一个 sdf 文件，那么我猜不是，你的 dbcontext 应该看起来像

```
namespace MyProject.Models
{
    public class DatabaseContext: DbContext 
    {
         public DbSet<Projects> Projects { get; set; } 
         public DbSet<Sections> Sections{ get; set; }         
    }
} 
```

然后在您的项目模型中，您将拥有部分的属性

```
namespace MyProject.Models
{
    public class Projects
    {
        public int ID { get; set; }
        public string projectName { get; set; }
        public string shortDesc { get; set; }
        public Sections section { get; set; }
    }
} 
```

你的部分只需要一个 id 字段

```
namespace MyProject.Models
{
    public class Sections
    {
        public int ID { get; set; }
        public int projectID { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
    }
} 
```

只要您的sections 类有一个称为ID 的主键字段或标记为主键的id 属性，那么EF 就会实现Projects 在表结构中具有section 的外键的逻辑飞跃。然后，您的项目模型将可以访问 section 对象。我在使用 EF 时遇到的最大障碍是过度考虑数据库方面的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T12:38:09.790

对于下拉列表，这是我的做法

```
public class ChangeUserNameViewModel
{
    public ChangeUserNameViewModel()
    {
        var user = User.GetAllButBuiltIn();
        Users = new SelectList(user, "UserName", "UserName");
    }

    public User User
    {
        get;
        set;
    }

    [DisplayName("User Name")]
    public SelectList Users
    {
        get;
        set;
    }

    public string UserName
    {
        get;
        set;
    }
} 
```

然后在视图中我引用视图模型

```
@model ChangeUserNameViewModel
@Html.DropDownList("UserName", Model.Users, "Choose") 
```

第一个参数是 html 中下拉菜单的名称。第二个选择列表填充它，第三个选择值。我确信有更好的方法来做到这一点。例如，您可以在模型中有一个 IList，然后在您的视图中执行一个 foreach 循环。这一切都取决于在您的情况下最有效的方法。

# python - 限制文件资源管理器迷你读取

> ID：10755559
> 
> 赞同：2
> 
> 时间：2012-05-25T13:47:55.163
> 
> 标签：python, filesystems, google-docs-api, fuse

我正在为 Google Drive 实现 FUSE 驱动程序。目的是允许用户将她的 Google Drive/Docs 帐户挂载为虚拟文件系统。完整源代码位于[https://github.com/jforberg/drivefs](https://github.com/jforberg/drivefs)。我使用[fusepy](http://code.google.com/p/fusepy/)绑定将 FUSE 与 Python 集成，并使用 Google 的[Document List](https://developers.google.com/google-apps/documents-list/) API 来访问 Drive。

我的驱动程序已经完成到 readdir(2)、stat(2) 和 read(2) 按预期工作的程度。在文件系统中，每个文件读取都会转换为具有很大开销的 HTTPS 请求。我已经设法通过强制读取更大的缓冲区大小来限制开销。

现在到我的问题。Thunar 和 Nautilus 等文件浏览器通过读取每个文件的第一部分（前 4k 字节左右）来构建拇指并确定文件类型。**但是在我的文件系统中，一次读取多个文件是一个痛苦的过程，与简单的ls**相比（每个文件只 stat(2)s），在 thunar 中获取文件列表需要很长时间。

我需要一些方法来告诉文件浏览器我的文件系统不能很好地使用“迷你读取”，或者某种方法来识别这些迷你读取并为他们提供虚构的数据以让他们开心。任何帮助，将不胜感激！

**编辑**：问题不在于 HTTPS 开销，而在于我对 Google 的原生“doc”格式的处理。我添加了一行以使 read(2) 在有人尝试读取本机文档时返回一个空字符串，并且文件列表现在几乎是即时的。

这似乎是一个轻微的限制，因为即使是 Google 的官方客户端程序也无法编辑原生文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:02:23.417

这是[pycloudfuse](https://github.com/Memset/pycloudfuse)，它是一个类似的尝试，但用于云文件/openstack 对象存储，您可能会在其中找到有用的位。

在写这篇文章时，我不能说我注意到 Thunar 和 Nautilus 的目录列表有任何问题。

我认为您不能为文件管理器提供数据——这必然会导致问题。

我喜欢的选项是向文件资源管理器发出信号，不要做缩略图等，但我认为这也不可能。

我认为最好的选择是提醒你的用户这`drivefs`不是一个真正的文件系统，并列出它的限制，如果有的话`pycloudfuse`就会有很多！

# sql-server - 当 DBNETLIB ConnectionWrite 一般网络错误导致 ADO 连接在 Delphi 应用程序中脱机时自动恢复？

> ID：10755560
> 
> 赞同：8
> 
> 时间：2012-05-25T13:47:57.013
> 
> 标签：sql-server, delphi, ado

谷歌搜索此 ADO 错误消息表明它在 ASP.NET 开发中经常遇到，但我没有发现太多提及它何时发生在 Delphi 应用程序中。我们有一些客户站点正在经历暂时的网络问题，这是有症状的错误消息。我们可以很容易地在办公室测试中复制它；只需在您的 delphi TADOConnection 对象连接到该服务器实例上的数据库时关闭 MS SQL Server 服务，您就会得到以下异常：

```
 [DBNETLIB][ConnectionWrite (send()).]General network error. Check your network documentation. 
```

是的，抓住这个异常，你就知道（或者你知道吗？）这个错误已经发生了。除了这是一个 800 KLOC+ 应用程序，在数据库操作周围有超过 10,000 个 try-except 块，其中任何一个都可能因此错误而失败。

`TADOConnection`有一些错误事件，在这种情况下都不会触发。但是，一旦发生这种情况，ADO 连接本身就会出现故障，即使您重新启动 SQL 数据库，TADOConnection.Connected 仍然是正确的，但它是在骗您。它确实处于故障状态。

**那么，我的问题是：**

*你能以任何比进入 10,000 个单独的 try-except 块并设置一些全局“重新连接 ADO 全局变量”更简单的方式检测到这种错误状态并从中恢复吗？*

我希望有一种方法可以进入 TADOConnection.ConnectionObject （底层原始 OLEDB COM ADO 对象）并在我们开始新查询时检测到此故障情况，以便我们可以重置 ADOConnection 并在下次运行时继续一个问题。由于我们的代码的组织方式允许我们在“失败后”检测到这一点，而不是像我在 10 行演示应用程序中那样做。

[This other SO question](https://stackoverflow.com/questions/2784391/sql-server-2005-and-general-network-error)询问为什么会发生，这**不是**我要问的，请不要给我“预防”答案，我已经知道了，我正在寻找恢复和检测停滞的ADO - 连接技术，而不是捕获异常。事实上，这是异常出错的一个很好的例子；在这种故障模式下，ADO 是一个 schrodingers-cat 对象。

我知道 MS 知识库文章，以及互联网上流传的各种解决方案。一旦错误情况（在我们的情况下通常是短暂的）已经清除，我正在询问是否在不丢失客户数据的情况下进行恢复。这意味着我们冻结我们的应用程序，向客户显示异常，当客户单击重试或继续时，我们会尝试修复并继续。请注意，我们现有的代码执行了一百万个 try-except-log-and-continue 代码，这会妨碍我们，所以我期待有人回答未处理异常的应用程序处理程序是最好的方法，但遗憾的是我们不能使用它。但是，我真的希望可以检测到冻结/故障/死 ADO 连接对象。

这是我所拥有的：

```
try
  if fQueryEnable and ADOConnection1.Connected then begin
    qQueryTest1.Active := false;
    qQueryTest1.Active := true;
    Inc(FQryCounter);
    Label2.Caption := IntToStr(qQueryTest1.RecordCount)+' records';

  end;
except
      on E:Exception do begin
         fQueryEnable := false;
         Memo1.Lines.Add(E.ClassName+' '+E.Message);
         if E is EOleException and Pos('DBNETLIB',E.Message)>0 then begin
            ADOConnectionFaulted := boolean; { Global variable. }
         end;
         raise;
      end;
end; 
```

上述解决方案的问题是我需要在我的应用程序中复制并粘贴大约 10,000 个位置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-30T14:57:15.727

好吧，没有人回答这个问题，我认为一些后续行动会有所帮助。

这是我学到的：

*   没有可靠的情况可以在测试环境中重现此一般网络错误。也就是说，我们正在处理 Irreproducible Results，这是许多开发人员跳入邪恶黑客的地方，试图“修补”他们损坏的系统。

*   当 SQL 库给出“一般网络错误”时，修复底层故障总是比在代码中修复更好。没有任何修复被证明是可能的，因为通常这意味着“网络非常不可靠，以至于 TCP 本身已经放弃传递我的数据”，这种情况发生在以下情况：

    *   你的网线坏了。

    *   您在网络上有重复的 IP 地址。

    *   您有决斗的 DHCP 服务器，每个服务器处理不同的默认网关。

    *   您有本地以太网段，它们之间的连接性很差。

    *   您的以太网交换机或集线器出现故障。

    *   您被出现故障的防火墙间歇性地阻止。

    *   您的客户可能已经更改了他们网络上的某些内容，现在可能无法使用您的软件。（这最后一个实际上发生的比你想象的要多）

    *   有人可能已经使用`cliconfg`特定于单个工作站的注册表设置的其他客户端配置元素配置了 SQL 别名，并且这种本地配置可能会导致难以诊断的不良行为，并且可能仅限于大型工作站上的一个或多个工作站网络。

在 TCP 或 SQL 级别都无法检测和报告上述任何情况。当 SQL 最终放弃时，它给出了这个“一般网络错误”，我的软件再多的哄骗都不会让它放弃，即使它放弃了，我也会做一个“尝试/除/忽略”反模式。这个错误非常严重，我们应该将它一直提交给用户，在错误日志中将其记录到磁盘，放弃（退出程序），并告诉用户网络连接已关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-03T15:32:43.977

由于编码错误，我也看到了这种情况。

如果您使用连接打开记录集，并且在第一个连接未关闭的情况下在循环中将同一连接重复用于另一个记录集，则可能会导致类似的错误。

另一个在 Web 应用程序中很少见的情况是，当应用程序池正在回收时，您可能会收到类似的错误。

我们在同一台服务器上有不同的站点，我注意到使用相同的应用程序但具有不同的定制，只有一个站点导致了这个问题。这导致了上述发现。

这个博客帮助我找到了问题：

[http://offbeatmammal.hubpages.com/hub/Optimising_SQL_Server](http://offbeatmammal.hubpages.com/hub/Optimising_SQL_Server)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-26T17:13:16.920

此处的代码检测到断开事件触发并使用计时器重新连接。假设您在阅读此代码时意识到必须将 TTimer 拖放到此处显示的此数据模块上，并使用下面显示的代码创建 OnTimer 事件。

请检查下一个代码：

```
unit uDM;

interface

uses
  SysUtils, Classes, DB, ADODB, Vcl.ExtCtrls;

type
  TDM = class(TDataModule)
    ADOConnection: TADOConnection;
    ConnectionTimmer: TTimer;
    procedure ADOConnectionDisconnect(Connection: TADOConnection;
      var EventStatus: TEventStatus);
    procedure ConnectionTimmerTimer(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  DM: TDM;

implementation

{$R *.dfm}

procedure TDM.ADOConnectionDisconnect(Connection: TADOConnection;
  var EventStatus: TEventStatus);
begin
  if eventStatus in [esErrorsOccured, esUnwantedEvent] then
    ConnectionTimmer.Enabled := True;
end;

procedure TDM.ConnectionTimmerTimer(Sender: TObject);
begin
  ConnectionTimmer.Enabled := False;
  try
    ADOConnection.Connected := False;
    ADOConnection.Connected := True;
  except
    ConnectionTimmer.Enabled := True;
  end;
end;

end. 
```

# php - PHP中的数字格式

> ID：10755563
> 
> 赞同：0
> 
> 时间：2012-05-25T13:48:11.007
> 
> 标签：php, number-formatting

我想在首页显示价格。但所需数字的格式是，

*   输入价格：10000 显示：10,000
*   输入价格：10000.10 显示：10,000.1
*   输入价格：10000.01 显示：10,000.01

如果我使用以下代码

```
echo  number_format ($price,2,'.',','); 
```

但是通过这种方式，结果以这种方式显示。
**输入价格：10000 显示：10,000.00**

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T13:50:37.383

PHP 中有一个函数叫做`money_format()`.

[在http://php.net/manual/en/function.money-format.php](http://php.net/manual/en/function.money-format.php)上查看它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:52:45.213

当然，从清晰度和一致性的角度来看，小数点后有 2 位数字更有意义，尤其是在显示价格时。

@barryhunter 提出了一个有效的观点，以下不起作用。

```
echo rtrim(number_format($price,2,'.',','),'0.'); 
```

但是，这样做：

```
trim(trim(number_format($price,2,'.',','),'0'),'.'); 
```

看：

```
<?php
$a=array('10000.00','10000.10','10000.01');

foreach ($a as $price)
{
    echo $price.' - '.rtrim(rtrim(number_format($price,2,'.',','),'0'),'.')."\n";
}
?>

$> php -f t.php
10000.00 - 10,000
10000.10 - 10,000.1
10000.01 - 10,000.01 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T13:53:05.327

您已将小数点数设置为 2，这就是您拥有 10,000.00 的原因。尝试以这种方式使用用户：

```
echo  number_format ($price,1,'.',','); 
```

如果您使用货币值，最好使用[money_format 。](http://www.php.net/manual/en/function.money-format.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T13:54:18.837

我个人会做

```
echo number_format($price,floor($price)==$price?0:2,'.',','); 
```

显示价格为 10,000.1 对我来说很奇怪。

但如果你真的必须

```
$bits = explode('.',$price);
echo number_format($price,strlen($bits[1]),'.',','); 
```

（编辑）回复评论，它对我有用......

```
<?php
$a=array(10000.00,10000.10,10000.01);

foreach ($a as $price)
{
    $bits = explode('.',$price);
    echo $price.' - '.number_format($price,strlen($bits[1]),'.',',')."\n";
}
?>

$ php t.php
10000 - 10,000
10000.1 - 10,000.1
10000.01 - 10,000.01 
```

# google-api - 谷歌分析 API 错误

> ID：10755564
> 
> 赞同：2
> 
> 时间：2012-05-25T13:48:15.597
> 
> 标签：google-api, google-analytics-api

我正在尝试拨打电话以从 Google Analytics 获取数据。

```
<?php

require_once 'lib/apiClient.php';
require_once 'lib/contrib/apiAnalyticsService.php';
session_start();

$client = new apiClient();

$service = new apiAnalyticsService($client);

if (isset($_GET['logout'])) {
    unset($_SESSION['token']);
}

if (isset($_GET['code'])) {
    $client->authenticate();
    $_SESSION['token'] = $client->getAccessToken();
    $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];
    header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));
}

if (isset($_SESSION['token'])) {
    $client->setAccessToken($_SESSION['token']);
}

if ($client->getAccessToken()) {
    $accounts = $service->management_accounts->listManagementAccounts();
    print "<h1>Accounts</h1><pre>" . print_r($accounts, true) . "</pre>";

    try {
        $data = $service->data_ga->get('ga:29214712', '2012-01-01', '2012-01-15',
            'ga:visits', array('dimensions' => 'ga:source,ga:keyword', 'sort' =>
            '-ga:visits,ga:source', 'filters' => 'ga:medium==organic', 'max-results' => '25'));
    }
    catch (apiServiceException $e) {
        echo $e->getCode();
        print_r($data);
    }

    $_SESSION['token'] = $client->getAccessToken();
} else {
    $authUrl = $client->createAuthUrl();
    print "<a class='login' href='$authUrl'>Connect Me!</a>";
} 
```

在 TRY Catch 块中包装代码后，我收到以下错误

> 403
> 
> 调用 GET [https://www.googleapis.com/analytics/v3/data/ga?ids=ga%3A29214712&start-date=2012-01-01&end-date=2012-01-15&metrics=ga%3Avisits](https://www.googleapis.com/analytics/v3/data/ga?ids=ga%3A29214712&start-date=2012-01-01&end-date=2012-01-15&metrics=ga%3Avisits)时出错：(403)禁止的
> 
> ( ! ) 注意：未定义变量：第 43 行 C:\wamp\www\gitgrow\index.php 中的数据

**注意：**我已授予权限并已强制配置文件 ID 对其进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T20:30:07.877

您收到的 403 错误意味着*授权用户*无权访问您的查询中定义的 ga:29214712 报告配置文件。

查看 examples/analytics/demo 目录中的 HelloAnalyticsAPI.php 示例，并确保您可以连接到 API： [http ://code.google.com/p/google-api-php-client/source/浏览/#svn%2Ftrunk%2Fexamples%2Fanalytics%2Fdemo](http://code.google.com/p/google-api-php-client/source/browse/#svn%2Ftrunk%2Fexamples%2Fanalytics%2Fdemo)

另外，请查看 Google Analytics（分析）开发人员指南。它将描述如何获取正确的配置文件 ID： [https ://developers.google.com/analytics/devguides/reporting/core/v3/#user_reports](https://developers.google.com/analytics/devguides/reporting/core/v3/#user_reports)

# ios5 - 空时如何知道uitableview被按下

> ID：10755566
> 
> 赞同：0
> 
> 时间：2012-05-25T13:48:23.503
> 
> 标签：ios5, uitableview, uibutton, uigesturerecognizer

我正在制作一个聊天应用程序，在聊天窗口中 uitableviewcells 中有 uilabels。最初键盘会出现，但是当用户触摸 uitableview 上的任何地方时，我会将聊天窗口设为全屏（消失的键盘）。

我找不到实现此目的的方法/技巧。

我尝试了以下方法：通过使用 tableview:didselectrowatindexpath，我能够做到，但是，用户需要按下现有的 uitableviewcell。但即使 uitableview 为空，我也想了解媒体。

*注意：我的聊天表视图是交互式的，例如某些行将包括需要按下的图像按钮，所以我不能只在 uitableview 上放置一个不可见的按钮。*

谢谢你的想法

艾通克·伊塞文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:33:59.580

您要做的是向 UITableView 添加一个手势识别器，以响应适当的手势。我建议不要使用 UITapGestureRecognizer，因为 UITableView 已经在使用点击来选择单元格，因此您可能想尝试使用 UILongPressGestureRecognizer。我整理了一个小样本，说明如何做到这一点，如下所示：

在我的 viewDidLoad 中，我做了以下事情：

```
UILongPressGestureRecognizer *gesture = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(handleLongPressFrom:)];
[self.tableView addGestureRecognizer:gesture]; 
```

和 handleLongPressFrom: 如下：

```
- (void)handleLongPressFrom:(UILongPressGestureRecognizer *)recognizer {
    NSLog(@"handleLongPressFrom: %@", recognizer);
    // Add real code here
} 
```

可以在[此处](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIGestureRecognizer_Class/Reference/Reference.html)找到完整的手势列表。

哦，如果你还想继续使用 tap，请查看[这个](https://stackoverflow.com/questions/8192480/uitapgesturerecognizer-breaks-uitableview-didselectrowatindexpath)堆栈溢出问题。我不知道所介绍的方法是否完全有效，但这将是一个很好的起点。

* * *

将 UITapGestureRecognizer 与 UITableView 一起使用：好的，因为点击手势似乎是您的用例的正确手势，您可以尝试执行以下操作。第 1 步是设置我上面列出的手势识别器，使用轻击手势而不是长按手势。

viewDidLoad 中的代码与一个重要的补充非常相似......

```
UITapGestureRecognizer *gesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapFrom:)];
// we need to set the gesture delegate so we can allow the tap to pass through to the
// UITableViewCell if necessary.
gesture.delegate = self;
[self.tableView addGestureRecognizer:gesture]; 
```

handleTapFrom: 函数几乎相同，只是将不同的手势识别器作为参数。

```
- (void)handleTapFrom:(UITapGestureRecognizer *)recognizer {
    NSLog(@"handleTapFrom: %@", recognizer);
    // Add real code here
} 
```

这种方法的主要变化是我们需要实现 UIGestureRecognizerDelegate 协议。由于我们的目标是允许点击手势通过 UITableView 传递到它的子视图（即 UITableViewCell 和它的组件），我们需要实现 gestureRecognizer:shouldRecieveTouch: 函数。以下实现应涵盖您正在尝试的内容。

```
#pragma mark UIGestureRecognizerDelegate methods
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    // If the view that is touched is not the view associated with this view's table view, but
    // is one of the sub-views, we should not recognize the touch.
    if (touch.view != self.tableView && [touch.view isDescendantOfView:self.tableView]) {
        return NO;
    }
    return YES;
} 
```

isDescendantOfView: 如果它正在测试的视图与进行测试的视图相同，则函数返回 YES，因此我们需要单独适应这种情况。你可以通过使用gestureRecognizer.view而不是self.tableView来生成这个函数，但我认为在这种情况下没有必要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T01:11:44.130

诀窍是让您的 viewController 在视图上放置一个点击识别器，但通过从委托方法“gestureRecognizerShouldBegin”返回 NO 来使其始终选择退出。这样，每次触摸视图都会调用gestureRecognizerShouldBegin，但您不会干扰表格的正常事件处理。

```
 - (void)viewDidLoad {
      [super viewDidLoad];
      [self detectTouchesOnView:self.tableView];
    }

    - (void)detectTouchesOnView:(UIView*)theView {
      UITapGestureRecognizer* tapR = [[UITapGestureRecognizer alloc]initWithTarget:nil action:nil];
      tapR.delegate = self;
      [theView addGestureRecognizer:tapR];
    }

    - (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer {
       // React to the UITableView being touched E.G. by hiding the keyboard as below.
      [self.view endEditing:YES]; 
      return NO;
    } 
```

# regex - url 模式在 dev 和 prod 之间工作不同的行为 - Django

> ID：10755567
> 
> 赞同：1
> 
> 时间：2012-05-25T13:48:30.417
> 
> 标签：regex, django, url-pattern

我在使用 Django urlconf 时遇到问题。

基本上我有这个模式：

`^publication/(?P<pub_search>[\w\.=&]+)?(/keyword/(?P<key_search>[\w=&]+))?(/author/(?P<auth_search>[\w=&]+))?(/tag/(?P<tag_search>[\w=&]+))?(/from/(?P<from_date>[\w\d=&]+))?(/until/(?P<until_date>[\w\d=&]+))?$`

根据这种模式，我应该能够拥有这种形式的 URL：

`http://127.0.0.1:8000/publication//author/name=crock`

事实上，这个 url 表单在我的 django 开发服务器中被识别。但在生产服务器（Apache + mod_wsgi）上，它与 url 不匹配。

我不知道它在产品服务器上以这种方式运行的原因。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:59:08.100

Apache 删除路径内的多个斜杠。你可以用一些 mod_rewrite 魔法来解决这个问题。

[从这里](https://stackoverflow.com/questions/831355/diggbar-modrewrite-how-do-they-pass-urls-through-modrewrite/869017#869017)引用：

```
RewriteCond %{THE_REQUEST} ^GET\ /(https?://[^\s]+)
RewriteRule ^https?:/ index.php?url=%1 [L] 
```

# html - 在 iFrame HTML 5 嵌入中获取视频元素

> ID：10755570
> 
> 赞同：3
> 
> 时间：2012-05-25T13:48:47.183
> 
> 标签：html, api, video, iframe, youtube

我正在尝试在新的 Youtube Embed 中获取 HTML5 视频元素。如果我尝试使用 player.getIframe() 访问 iframe，但我无法深入 iFrame Html 以访问标签和元素

我的目标是更改视频元素的 DOMAttribute

我会很感激你的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:04:08.123

根据[Youtube IFRAME 嵌入](https://developers.google.com/youtube/iframe_api_reference)

您可以通过 onYouTubePlayerAPIReady() 获得 iframe 嵌入的参考

Youtube 相关的 DOMAttribute 也可以通过 playerVars 参数进行配置，如下所述

> ```
> player = new YT.Player('player', {
>       height: '390',
>       width: '640',
>       videoId: 'u1zgFlCw8Aw',
>       playerVars: {
>          listType:'playlist',
>          list: 'UUPW9TMt0le6orPKdDwLR93w'
>       },
>       events: {
>         'onReady': onPlayerReady
>       }
> }); 
> ```

# ruby - 如何使用 Rack map 在不同端口上运行两台瘦（或其他）服务器？

> ID：10755571
> 
> 赞同：4
> 
> 时间：2012-05-25T13:48:47.203
> 
> 标签：ruby, ssl, rack

我的目标是通过 Rack 对 HTTP 和 HTTPS/SSL 进行一些自动化测试，而无需求助于代理服务器设置或类似的东西。我有一个我想测试的 gem，我希望其他人也能够运行测试，所以我希望它尽可能独立。

**App 的代码在单独运行时运行良好，所以这里不包含，问题出在 Rack 部分。**

我想做这样的事情：

```
app = Rack::Builder.app do
  map "/" do
    Rack::Handler::WEBrick.run App, Port: 3000
  end

  map "/ssl" do
    Rack::Handler::WEBrick.run App, Port: 3001 # more options for SSL here...
  end
end

run app 
```

我已经尝试了上面代码的几种组合，例如：

```
http = Rack::Builder.app do
  map "/" do
    run App
  end
end

https = Rack::Builder.app do  
  map "/ssl" do
    run App
  end
end

Rack::Handler::WEBrick.run http, Port: 3000
Rack::Handler::WEBrick.run https, Port: 3001 # more options for SSL here... 
```

设置两个服务器后，我倾向于让一个服务器在列出的第一个端口上运行，然后在中断时它将在列出的下一个端口上运行第二个服务器 - 然后，在下一个中断时，另一个服务器在 9292 上或它关闭下。

我显然在做一些不太正确的事情。

这非常接近，但最终通过两个不同的命令行命令运行两个服务器： [在不同端口上启动瘦服务器](https://stackoverflow.com/questions/8008436/starting-thin-server-on-different-ports)

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T22:00:35.820

Current Thin 不支持这一点——我检查了源代码。

Thin v2 仍然是预发布版本，但配置代码看起来通过在配置文件中声明多个侦听器来支持这一点。

但是 Thin v2 仍然是 alpha 软件。

您还可以切换到像 Unicorn 这样明确支持绑定到多个端口或地址的另一*台*服务器。

# ios - 如何更改 UIImage 的颜色

> ID：10755576
> 
> 赞同：51
> 
> 时间：2012-05-25T13:49:09.877
> 
> 标签：ios, uiimage, uicolor

我不想改变 UIImage 的 backgroundColor，
而是改变整个图像的颜色。

因为我有标准表格，我可以从弹出窗口移动到视图。
在我的应用程序中，可以将图像修补为一个大图像，即一张桌子。
此外，我想将颜色更改为白棕色或其他颜色。

但问题是：我只能改变backgroundColor
有什么办法可以改变UIImage的颜色吗？

先感谢您

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2014-10-29T10:04:58.420

接受的答案是正确的，但有一种更**简单**的方法`UIImageView`：

**对象-C：**

```
UIImage *image = [UIImage imageNamed:@"foo.png"];
theImageView.image = [image imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate];
[theImageView setTintColor:[UIColor redColor]]; 
```

**斯威夫特 2：**

```
let theImageView = UIImageView(image: UIImage(named:"foo")!.imageWithRenderingMode(UIImageRenderingMode.AlwaysTemplate))
theImageView.tintColor = UIColor.redColor() 
```

**斯威夫特 3：**

```
let theImageView = UIImageView(image: UIImage(named:"foo")!.withRenderingMode(.alwaysTemplate))
theImageView.tintColor = UIColor.red 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-05-25T14:04:11.920

```
UIImage *image = [UIImage imageNamed:@"triangle.png"];

CGRect rect = CGRectMake(0, 0, image.size.width, image.size.height);
UIGraphicsBeginImageContext(rect.size);
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextClipToMask(context, rect, image.CGImage);
CGContextSetFillColorWithColor(context, [[UIColor redColor] CGColor]);
CGContextFillRect(context, rect);
UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImage *flippedImage = [UIImage imageWithCGImage:img.CGImage 
                                            scale:1.0 orientation: UIImageOrientationDownMirrored];

yourUIImageView.image = flippedImage; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-06-14T09:15:43.953

对于 swift 3.2 和 4

```
extension UIImageView{
    func changePngColorTo(color: UIColor){
        guard let image =  self.image else {return}
        self.image = image.withRenderingMode(.alwaysTemplate)
        self.tintColor = color
    }
} 
```

利用 ：

```
self.yourImageView.changePngColorTo(color: .red) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-11-30T09:23:04.673

## Details

*   Xcode 10.2.1 (10E1001), Swift 5

## Way 1\. Extension UIImage

source: [https://stackoverflow.com/a/40177870/4488252](https://stackoverflow.com/a/40177870/4488252)

```
extension UIImage {

    convenience init?(imageName: String) {
        self.init(named: imageName)
        accessibilityIdentifier = imageName
    }

    // https://stackoverflow.com/a/40177870/4488252
    func imageWithColor (newColor: UIColor?) -> UIImage? {

        if let newColor = newColor {
            UIGraphicsBeginImageContextWithOptions(size, false, scale)

            let context = UIGraphicsGetCurrentContext()!
            context.translateBy(x: 0, y: size.height)
            context.scaleBy(x: 1.0, y: -1.0)
            context.setBlendMode(.normal)

            let rect = CGRect(x: 0, y: 0, width: size.width, height: size.height)
            context.clip(to: rect, mask: cgImage!)

            newColor.setFill()
            context.fill(rect)

            let newImage = UIGraphicsGetImageFromCurrentImageContext()!
            UIGraphicsEndImageContext()
            newImage.accessibilityIdentifier = accessibilityIdentifier
            return newImage
        }

        if let accessibilityIdentifier = accessibilityIdentifier {
            return UIImage(imageName: accessibilityIdentifier)
        }

        return self
    }
} 
```

**Usage**

```
let imageView = UIImageView(frame: CGRect(x: 40, y: 250, width: 40, height: 40))
view.addSubview(imageView)
// Set color
imageView.image = UIImage(imageName: "Apple")?.imageWithColor(newColor: UIColor.blue)
// Reset color
//imageView.image = imageView.image?.imageWithColor(newColor: nil) 
```

## Way 2\. Extension UIImageView

```
extension UIImageView {

    var imageColor: UIColor? {
        set (newValue) {
            guard let image = image else { return }
            if newValue != nil {
                self.image = image.withRenderingMode(.alwaysTemplate)
                tintColor = newValue
            } else {
                self.image = image.withRenderingMode(.alwaysOriginal)
                tintColor = UIColor.clear
            }
        }
        get { return tintColor }
    }
} 
```

**Usage**

```
let imageView = UIImageView(frame: CGRect(x: 40, y: 250, width: 40, height: 40))
view.addSubview(imageView)
imageView.image = UIImage(imageName: "Apple")
// Set color
imageView.imageColor = UIColor.green
// Reset color
//imageView.imageColor = nil 
```

## Full sample

> Do not forget to paste here all code which placed above

```
import UIKit

class ImageView: UIImageView {
    enum ImageColorTransformType {
        case none, imageExtension, imageViewExtension
    }
    var imageColorTransformType = ImageColorTransformType.none
}

class ViewController: UIViewController {

    weak var colorSwitchButton: UIBarButtonItem?

    private var imageViews = [ImageView]()
    private var appleImage: UIImage { return UIImage(imageName: "apple")! }
    private var redAppleImage: UIImage { return UIImage(imageName: "red_apple")! }

    override func viewDidLoad() {
        super.viewDidLoad()
        createNewImageView(x: 40, y:100, image:appleImage, imageColorTransformType: .none)
        createNewImageView(x: 100, y:100, image:appleImage, imageColorTransformType: .imageExtension)
        createNewImageView(x: 160, y:100, image:appleImage, imageColorTransformType: .imageViewExtension)

        createNewImageView(x: 40, y:160, image:redAppleImage, imageColorTransformType: .none)
        createNewImageView(x: 100, y:160, image:redAppleImage, imageColorTransformType: .imageExtension)
        createNewImageView(x: 160, y:160, image:redAppleImage, imageColorTransformType: .imageViewExtension)

        let buttonItem = UIBarButtonItem(title: "switch", style: .plain, target: self,
                                         action: #selector(colorSwitchButtonTouchedUpInside(_:)))
        navigationItem.rightBarButtonItem = buttonItem
        colorSwitchButton = buttonItem
        useOriginalColors = false
    }

    private func createNewImageView(x:CGFloat, y: CGFloat, image: UIImage, imageColorTransformType: ImageView.ImageColorTransformType) {
        let imageView = ImageView(frame: CGRect(x: x, y: y, width: 40, height: 40))
        imageView.image = image
        imageView.imageColorTransformType = imageColorTransformType
        imageViews.append(imageView)
        view.addSubview(imageView)
    }

    private var _useOriginalColors = false
    private var useOriginalColors: Bool {
        set(value) {
            _useOriginalColors = value
            if (value) {
                navigationItem.title = "Original colors"
                for imageView in imageViews {
                    switch imageView.imageColorTransformType {
                    case .imageExtension: imageView.image = imageView.image?.imageWithColor(newColor: nil)
                    case .imageViewExtension: imageView.imageColor = nil
                    case .none: break
                    }
                }
            } else {
                navigationItem.title = "Template colors"
                for imageView in imageViews {
                    switch imageView.imageColorTransformType {
                    case .imageExtension: imageView.image = imageView.image?.imageWithColor(newColor: UIColor.blue)
                    case .imageViewExtension: imageView.imageColor = UIColor.green
                    case .none: break
                    }
                }
            }
        }
        get { return _useOriginalColors }
    }

    @objc func colorSwitchButtonTouchedUpInside(_ sender: Any) { useOriginalColors = !useOriginalColors }
} 
```

## Storyboard

[![enter image description here](../Images/9a9c611aaa2cb13f7388237ccd890683.png)](https://i.stack.imgur.com/qOtT4.png)

## Result

[![enter image description here](../Images/c8e0efecadffcd656ef56e2e787ae737.png)](https://i.stack.imgur.com/cSJXe.png) [![enter image description here](../Images/ac777a62a0fe0810663360289d2859dc.png)](https://i.stack.imgur.com/AYQLI.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-02-24T01:24:52.507

您也可以使用以下代码快速执行此操作：

```
// language: Swift
let tintedImage = UIImageView(image: UIImage(named:"whatever")!.imageWithRenderingMode(UIImageRenderingMode.AlwaysTemplate))

tintedImage.tintColor = UIColor.redColor() 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-12-09T20:36:53.560

Swift + 界面构建器（故事板）

如果您在界面生成器中添加了 UIImageView：

```
myIcon.image = myIcon.image!.withRenderingMode(UIImageRenderingMode.alwaysTemplate)
myIcon.tintColor = UIColor.red // your color 
```

`myIcon`你的故事板的出口在哪里，例如：`@IBOutlet weak var myIcon: UIImageView!`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-07-30T06:42:15.997

更改 UIImageView 中图像的颜色：

```
public extension UIImageView {
    func tintImage(color: UIColor) {
        image = image?.tint(color: color)
    }
} 
```

只需调用方法：

```
imageView.tintImage(color: .red) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-20T20:16:27.373

添加到[skywinder的答案](https://stackoverflow.com/a/26627433/2704776)

您也可以在按钮上执行此操作：

```
UIImage *image = [UIImage imageNamed:@"foo.png"];
[myButton setImage:[image imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate] forState:UIControlStateNormal];
[myButton setTintColor:[UIColor redColor]]; 
```

# android - ListView Scroll 上的 EditText 内容更改

> ID：10755581
> 
> 赞同：0
> 
> 时间：2012-05-25T13:49:30.960
> 
> 标签：android, android-layout, android-widget

我有一个带有自定义适配器的 Android 应用程序，该适配器扩展了光标适配器。
我重写了 CursorAdapter 的 bindView 和 newview 方法。我的每个 ListView 行都包含一个 EditText。当我在 EditText 中输入一些文本并向下滚动 ListView 时，EditText 文本的内容将移动到另一个 EditText。
任何人都可以帮我解决这个问题，以便在向下滚动 ListView 时防止 EditText 重用其内容。

提前致谢，

这是代码：

```
 private class AddScreenArrayAdapter extends ArrayAdapter<AddScreenItems>{

  ViewHolder viewHolder = null;
  public String[] holder_values;

public AddScreenArrayAdapter(Context context, int textViewResourceId,
        List<AddScreenItems> objects) {
    super(context, textViewResourceId, objects);
    holder_values = new String[objects.size()];

    // TODO Auto-generated constructor stub
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub

    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater)getActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.additem_row, null);
        viewHolder = new ViewHolder();
        viewHolder.label = (TextView) v.findViewById(R.id.label_add_item);
        viewHolder.dbName=(TextView)v.findViewById(R.id.dbtable_name);
        viewHolder.value = (EditText) v.findViewById(R.id.value_add_item);
        viewHolder.value.addTextChangedListener(new TextWatcher()
        {

            @Override
            public void afterTextChanged(Editable arg0) {
                // TODO Auto-generated method stub
                holder_values[viewHolder.ref]= arg0.toString();

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start,
                    int count, int after) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onTextChanged(CharSequence s, int start,
                    int before, int count) {
                // TODO Auto-generated method stub

            }

        });
        v.setTag(viewHolder);
    }
    else{
        viewHolder = (ViewHolder) v.getTag();
    }
    AddScreenItems addScreenItems = addScreenItemsList.get(position);
    if(addScreenItems!=null)
    {
        viewHolder.label.setText(addScreenItems.labelname);
        viewHolder.dbName.setText(addScreenItems.databaseTableName);
    //  viewHolder.ref = position;
        if (holder_values[position] != null) 
         { 
            viewHolder.value.setText(holder_values[position]); 
        } 

         else { 
             viewHolder.value.setText(""); 
         }

    }
    return v;

}

    }

             static class ViewHolder {
    public TextView label;
    public EditText value;
    public TextView dbName;
    int ref;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:57:35.780

如果您在滚动后遇到问题，那就是视图回收让您感到困惑。您基本上需要设置一个数组来保存 EditTexts 的内容，这样当您滚动它们时它们就不会被弄乱。

这是我在类似主题上给出的另一个答案的链接。它应该为你指明方向。 [所以回答](https://stackoverflow.com/a/10713257/1105376)

**编辑**

`setOnFocusChangeListener`当用户完成 EditText 框中的条目时，我使用它来运行代码。

```
qty.setOnFocusChangeListener(new View.OnFocusChangeListener() {
@Override
public void onFocusChange(View v, boolean hasFocus) {
    if (!hasFocus) {
        LinearLayout parent = (LinearLayout) v.getParent();
        EditText qtyTemp = (EditText) parent.findViewById(R.id.qty);
        quantity[pos] = qtyTemp.getText().toString();
    }
}
}); 
```

# php - preg_replace 不起作用

> ID：10755582
> 
> 赞同：0
> 
> 时间：2012-05-25T13:49:32.083
> 
> 标签：php, preg-replace

我有小的 preg_replace 问题。我需要调整 iframe 代码输出的大小，所以我使用 preg_replace，正则表达式似乎工作正常，但结果与输入相同，没有变化。这里我使用的代码：

```
$video_code = preg_replace( '/width="(.*?)"/', 'width="'.$width.'"',  $video_code );
$video_code = preg_replace( '/height="(.*?)"/', 'height="'.$height.'"',  $video_code ); 
```

此 iframe`$video_code`包含：

```
<iframe class='sproutvideo-player' type='text/html' src='http://videos.sproutvideo.com/embed/189bd8b4191ee1c390/d0dc5859e1d409ed?type=hd&regularColors0=666565&regularColors1=595756&hoverColors0=ed2409&hoverColors1=d1390f&highlightColors1=c9c3c9&noBigPlay=true' width='768' height='432' frameborder='0'></iframe> 
```

知道为什么会这样吗？

谢谢

乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:53:56.823

试试这个：

```
$video_code = preg_replace ('/(width=[\'"])(.*?)([\'"])/', '$1620$3',  $video_code);

$video_code = preg_replace ('/(height=[\'"])(.*?)([\'"])/', '$1' . $height . '$3',  $video_code); 
```

转义了一些字符，您将替换 之间的所有内容`()`，因此替换模式中的文本`height=`是不必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T13:54:57.760

我使用了你的代码，对我来说效果很好。（做了一些小改动，但不多）

这是我使用的代码： http: [//codepad.viper-7.com/fafGYW](http://codepad.viper-7.com/fafGYW)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T14:11:50.590

```
$video_code = preg_replace('/width=[\'"][^\'"]+[\'"]/', 'width="'.$width.'"', $video_code);
$video_code = preg_replace('/height=[\'"][^\'"]+[\'"]/', 'height="'.$height.'"', $video_code); 
```

# javascript - Javascript 滑动图像 - 如何添加元素/类

> ID：10755583
> 
> 赞同：0
> 
> 时间：2012-05-25T13:49:46.343
> 
> 标签：javascript, html

我有这个 Javascript 滑动图像脚本。它效果很好，但我想以段落标签的形式将文本添加到滑动效果中，幻灯片中的每个图像都有一个段落。怎么做？我的代码：

```
<script language="JavaScript">
var image = new Array("images/ref1.png", "images/ref2.png", 
                "images/bb.png", "images/windows.png")
                var imgNumber=1     
                var numberOfImg = image.length                  

                function previousImage(){
                  if(imgNumber > 1){
                    imgNumber--
                    }

                  else{
                    imgNumber = numberOfImg
                    }

                  document.slideImage.src = image[imgNumber-1]                              
                  }

                function nextImage(){
                  if(imgNumber < numberOfImg){
                    imgNumber++
                    }

                  else{
                    imgNumber = 1
                    }

                  document.slideImage.src = image[imgNumber-1]  
                  }

                if(document.images){                                       
                   var image1 = new Image()                                        
                   image1.src = "images/ref1.png"
                   var image2 = new Image()
                   image2.src = "images/ref2.png"
                   var image3 = new Image()
                   image3.src = "images/bb.png"
                   var image4 = new Image()
                   image4.src = "images/windows.png"
                   }
</script>
<table>
        <tr>
          <td><img src="images/ref1.png" name="slideImage"></td>
        </tr>
        <tr>
          <td><a href="JavaScript:previousImage()">
          <img src="" border="none"/>prev</a>
          </td>
          <td><a href="JavaScript:nextImage()">
          <img src="" border="none" />next</a>  
          </td>
        </tr>
</table> 
```

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:49:16.037

基本上你只需要添加一个元素来保存你的文本，一个包含要旋转的文本的数组，然后添加一点 JavaScript 来进行更改。

这是一个**[jsFiddle 示例](http://jsfiddle.net/j08691/eLTb5/)**。

我在您的 HTML 中添加了一个 ID 为“文本”的新段落元素，并在您的 JavaScript 中创建了一个数组来保存文本。文本会像使用此行的图像一样更改：`document.getElementById('text').innerHTML = text[imgNumber - 1];`.

**JavaScript**：

```
var image = new Array("http://www.dummyimage.com/60x60/&text=1", "http://www.dummyimage.com/60x60/&text=2", "http://www.dummyimage.com/60x60/&text=3", "http://www.dummyimage.com/60x60/&text=4");
var text = new Array('one', 'two', 'three', 'four');
var imgNumber = 1;
var numberOfImg = image.length;

function previousImage() {
    if (imgNumber > 1) {
        imgNumber--;
    }
    else {
        imgNumber = numberOfImg;
    }
    document.slideImage.src = image[imgNumber - 1];
    document.getElementById('text').innerHTML = text[imgNumber - 1];
}
function nextImage() {
    if (imgNumber < numberOfImg) {
        imgNumber++;
    }
    else {
        imgNumber = 1;
    }
    document.slideImage.src = image[imgNumber - 1];
    document.getElementById('text').innerHTML = text[imgNumber - 1];
}
if (document.images) {
    var image1 = new Image();
    image1.src = "http://www.dummyimage.com/60x60/&text=1";
    var image2 = new Image();
    image2.src = "http://www.dummyimage.com/60x60/&text=2";
    var image3 = new Image();
    image3.src = "http://www.dummyimage.com/60x60/&text=3";
    var image4 = new Image();
    image4.src = "http://www.dummyimage.com/60x60/&text=4";
}​ 
```

# android - 如何在 Android 中使用 SpanWatcher？

> ID：10755585
> 
> 赞同：7
> 
> 时间：2012-05-25T13:49:50.477
> 
> 标签：android, xamarin.android

我一直在尝试解决[零长度格式 Spans 的 android 问题](http://code.google.com/p/android/issues/detail?id=14786)。我想，好吧，我将删除长度为零的 Span。在环顾四周后，我认为 SpanWatcher 将是一个很好的方法。然而，似乎缺乏关于如何实现或添加 SpanWatchers 的示例。

我在 MonoDroid 中试过这个：

```
public class PreventZeroLenSpan : Java.Lang.Object, ISpanWatcher
{
    void ISpanWatcher.OnSpanAdded (ISpannable text, Java.Lang.Object what, int start, int end)
    {
        if (what==this) return;
        var CS = what as Android.Text.Style.CharacterStyle;
        if (CS==null) return;
        if (start==end) text.RemoveSpan(CS);
    }

    void ISpanWatcher.OnSpanChanged (ISpannable text, Java.Lang.Object what, int ostart, int oend, int nstart, int nend)
    {
        if (what==this) return;
        var CS = what as Android.Text.Style.CharacterStyle;
        if (CS==null) return;
        if (nstart==nend) text.RemoveSpan(CS);
    }

    void ISpanWatcher.OnSpanRemoved (ISpannable text, Java.Lang.Object what, int start, int end)
    {
        // nothing
    }
} 
```

如果我先将其直接添加到 SpannableStringBuilder 或 SpannableString，则会调用这些事件，但是在它进入 EditText 控件之后它不再响应。

```
 var Str = new SpannableStringBuilder("Test IT");
        var Sty = new ForegroundColorSpan(Android.Graphics.Color.Blue);
        Str.SetSpan(SpanWatch,0,Str.Length(), SpanTypes.InclusiveInclusive);
        Str.SetSpan(Sty,5,7, SpanTypes.InclusiveInclusive);
        txEdit.SetText(Str, TextView.BufferType.Editable); 
```

SpanWatcher 实现了 NoCopySpan，因此它不会被复制到 EditText 中。我找不到任何将 SpanWatcher 直接添加到 EditText 的方法（有一种方法可以添加 TextWatcher）。

我想如果我无法弄清楚 SpanWatcher，我可以在每次文本更改时扫描整个内容的零长度跨度。只是看起来效率低下。（稍后我可能需要为我的图形换行指示器删除事件。）

任何想法都值得赞赏，欢迎使用 Java 或 MonoDroid 中的示例。

**编辑**

我仍然有兴趣知道如何使用 SpanWatcher 执行此操作（似乎更有效），但对于其他在零长度 Span 移除方面苦苦挣扎的人，您可以使用以下 TextWatcher 执行 EditText.AddTextChangedListener()：

```
public class PreventZeroLenSpanWatcher : Java.Lang.Object, ITextWatcher
{
    void ITextWatcher.AfterTextChanged (IEditable s)
    {
        var Objs = s.GetSpans(0,s.Length(), Java.Lang.Class.FromType(typeof(Android.Text.Style.CharacterStyle)));
        foreach (Android.Text.Style.CharacterStyle CS in Objs)
        {
            int Start = s.GetSpanStart(CS);
            int End = s.GetSpanEnd(CS);
            if (Start == End) s.RemoveSpan(CS);
        }
    }

    void ITextWatcher.BeforeTextChanged (Java.Lang.ICharSequence s, int start, int count, int after)
    {
        // nothing
    }

    void ITextWatcher.OnTextChanged (Java.Lang.ICharSequence s, int start, int before, int count)
    {
        // nothing
    }
} 
```

**编辑2**

如果你这样做，你至少可以让 SpanWatcher 进入 EditText，但是一旦用户编辑文本，你似乎又失去了它。控件内部必须进行一些复制，并且 SpanWatcher 不可复制。

```
 IEditable txEditFormatted = ((IEditable)txEdit.TextFormatted);
        txEditFormatted.SetSpan(SpanWatch,0,txEditFormatted.Length(), SpanTypes.InclusiveInclusive); 
```

我还尝试使用 TextWatcher 重新添加 SpanWatcher，但到那时跨度已经改变。

# xcode - 有关 xcode 中错误的更多控制台信息

> ID：10755587
> 
> 赞同：0
> 
> 时间：2012-05-25T13:50:04.157
> 
> 标签：xcode, console, assertion

嗨，我的控制台中出现此错误：

```
2012-05-25 15:42:32.157 Mehdi Bensafi[426:f803] *** Assertion failure in -[UITableView _endCellAnimationsWithContext:], /SourceCache/UIKit_Sim/UIKit-1914.84/UITableView.m:1021 
```

但我想要更多信息，有可能吗？

例如，我看到了一些完整的错误消息，如下所示：

```
An exception was caught from the delegate of NSFetchedResultsController during a call to -controllerDidChangeContent:.  Invalid update: invalid number of rows in section 0\.  The number of rows contained in an existing section after the update (5) must be equal to the number of rows contained in that section before the update (5), plus or minus the number of rows inserted or deleted from that section (0 inserted, 3 deleted). with userInfo (null) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:51:14.797

在控制台上使用`backtrace`（或`bt`）命令。

# javascript - Google Maps API 3 中的复选框有问题

> ID：10755588
> 
> 赞同：0
> 
> 时间：2012-05-25T13:50:04.337
> 
> 标签：javascript, google-maps, checkbox, google-maps-markers

我正在尝试在嵌入我网站的谷歌地图页面上显示大量标记。目前，我有地图和标记工作，但我也试图能够使用我添加到代码中的 4 个复选框对这些标记进行排序。

但是，复选框在被选中时不会做任何事情。几天来，我一直试图找出我的代码的问题，但我无法解决这个问题。

```
['Anchorage Air Route Traffic Control Center (ZAN)', 61.228391,-149.779551,1], 
['Anchorage TRACON (A11)', 61.17736,-149.979644,2],
['Allentown Tower (ABE)', 40.658666,-75.440991,3],
['Anchorage ATCT (ANC)', 61.177515,-149.979644,4],
var markers = [];     
var i, newMarker;     
for (i = 0; i < facilities.length; i++) 
{newMarker = new google.maps.Marker({        
position: new google.maps.LatLng(facilities[i][1], facilities[i][2]),    
map: map,
title: facilities[i][0],
clickable:true,
zindex: 10,      
});
newMarker.category = facilities[i][3];      
newMarker.setVisible(true);       
markers.push(newMarker);

}   

 function displayMarkers(categ) {      
var i, categ;       
for (i = 0; i < markers.length; i++) {        
if (markers[i].category === categ && markers[i].getVisible()== true) 
{         
 markers[i].setVisible(false);        
 } 
else if (markers[i].category === categ && markers[i].getVisible()== false) 
{
    markers[i].setVisible(true);        
}
 }    
} 
```

然后，在页面的正文中，我有： id="artccb" value="ARTCC" onclick="displayMarkers(1)">
ARTCC

```
<input type="checkbox" checked="checked"           
id="traconb" value="TRACON" onclick="displayMarkers(2)">     
<label>TRACON</label>  

<input type="checkbox" checked="checked"           
id="bothb" value="ATCT/TRACON" onclick="displayMarkers(3)">     
<label>ATCT/TRACON</label> 

 <input type="checkbox" checked="checked"           
id="atctb" value="ATCT" onclick="displayMarkers(4)">     
<label>ATCT</label> 

</div> 

<body onload="initialize()"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:56:28.803

是在单独的函数中向地图添加标记的部分吗？如果是这样，则数组在函数`markers`中不可见。`displayMarkers`放在`var markers = [];`全局范围内，它应该可以工作。编辑：通过全球范围，我的意思是：

```
var markers = [];
function initialize() {
...
}
function displayMarkers(... 
```

编辑2：也`displayMarkers`替换：

```
var i, categ; 
```

和

```
var i; 
```

您不应该重新定义`categ`变量，因为它是作为参数传递的。

# php - 遍历类树而不覆盖方法？

> ID：10755590
> 
> 赞同：0
> 
> 时间：2012-05-25T13:50:14.267
> 
> 标签：php, inheritance, overloading

我有以下内容：

```
class A
{
    public function getDependencies()
    {
        //returns A.default.css, A.default.js, A.tablet.css, A.tablet.js, etc,
        //depending on what files exist and what the user's device is.
    }
} 
```

在扩展 A 的 B 类中，如果我调用 getDependencies，我会得到如下内容：B.default.css、B.default.js 等等。

我现在要做的是将 A 的结果也包括在内，而不必覆盖 B 中的 getDependencies()。事实上，我什至不确定覆盖是否会起作用。这可能吗？

这是用于模板的动态 CSS/JS 加载，最终也用于生产编译。

EDIT= 我应该指出 getDependencies 返回的是动态生成的，而不是一组存储的值。

EDIT2= 我的想法是仅仅从 A 继承将提供行为。我可能需要某种遍历层次结构树的递归，从 B 开始，到 B 的父级，一直到 A，在此过程中不会发生任何方法覆盖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:03:05.853

使用`parent::getDependencies()`，例如：

```
class B
{
  public function getDependencies()
  {
    $deps = array('B.style.js' 'B.default.js', 'B.tables.js' /*, ... */);
    // merge the dependencies of A and B
    return array_merge($deps, parent::getDependencies());
  }
} 
```

您还可以尝试使用[ReflectionClass](http://php.net/manual/class.reflectionclass.php)来迭代所有父级的代码：

```
<?php

class A
{
  protected static $deps = array('A.default.js', 'A.tablet.js');
  public function getDependencies($class)
  {
    $deps = array();

    $parent = new ReflectionClass($this);

    do 
    {
      // ReflectionClass::getStaticPropertyValue() always throws ReflectionException with
      // message "Class [class] does not have a property named deps"
      // So I'm using ReflectionClass::getStaticProperties()

      $staticProps = $parent->getStaticProperties();
      $deps = array_merge($deps, $staticProps['deps']);
    }
    while ($parent=$parent->getParentClass());

    return $deps;
  }
}
class B extends A
{
  protected static $deps = array('B.default.js');
}

class C extends B
{
  protected static $deps = array('C.default.js');
}

$obj = new C();
var_dump( $obj->getDependencies($obj) ); 
```

[在 Ideone.com 上](http://ideone.com/LAhz9)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:07:46.837

使用反射 API 非常简单。

我可以简单地遍历父类：

```
$class = new \ReflectionClass(get_class($this));
while ($parent = $class->getParentClass()) 
{
        $parent_name = $parent->getName();
        // add dependencies using parent name.
        $class = $parent;
} 
```

感谢 ComFreek，他为我指出了正确的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:58:00.580

您可以使用 self 关键字 - 这将返回 A 类值，然后您可以使用 $this 获取 B 类值。

# iphone - iPhone 无法在我的 iPhone 上调试任何新项目

> ID：10755597
> 
> 赞同：0
> 
> 时间：2012-05-25T13:50:31.210
> 
> 标签：iphone

当我将 iPhone 插入 USB 端口时，我听到了咔哒声，在我的项目中它显示正在检查 dd 符号并出现一个小进度条。但是，当我点击右上角的下拉列表时，我的设备没有出现，仍然显示任何 iOS 设备。当我单击调试时，会出现一个框，说 xcode 无法使用所选设备运行。“没有提供兼容 iOS 版本的预置 iOS 设备。将 iOS 设备与最新版本的 iOS 连接以运行您的应用程序或选择 iOS 模拟器作为目标”

我查看了我的项目使用的 sdk 版本，它是 5.1。在管理器上显示我的 iPhone 使用的是 5.0.1.1 版软件，

问题，我必须将我的 iPhone 升级到 5.1 吗？我去 iTunes 升级它，他们只有 5.1.1 的选项，如果我将它升级到 5.1.1，它仍然可以与我的 xcode 一起使用，它有 sdk 5.1 而不是 5.1.1

知道如何让我的 iPhone 与创建的新项目一起工作吗？此外，旧项目正在使用 sdk 5.1 并且运行良好，这可能是一个不同的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:58:41.360

尝试运行任何 XCode 3。然后打开他的 Organizer。然后会显示一个关于收集设备的问题。按下并重新连接设备。必须帮忙。这对我来说有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:05:14.807

只需将目标和项目的“部署目标”设置为您的设备版本。

为此，请单击导航器中的项目 -> 项目信息和目标摘要。在那里您可以找到部署目标。

希望这可以帮助

# javascript - javascript，如果当前 url 带有我们的请求部分

> ID：10755604
> 
> 赞同：0
> 
> 时间：2012-05-25T13:50:54.550
> 
> 标签：javascript

我想做一些事情：如果某些类型的 url 地址如：（`www.mydomain.com/search`没有请求部分），我想用 javascript 做一些事情，用 url 填充`www.mydomain.com/search?search=car`，但我的代码中没有发生任何事情。

```
 <script>
    var curent_url = document.URL;
    if(document.URL.indexOf("?") < 0){ //if(!document.URL.match(/\?/)){
        //alert('ok');
        document.URL = curent_url+'?search=car';
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T13:53:56.217

而不是`document.URL`，检查一个空的`document.location.search`：

```
if (document.location.search.length === 0) {
  // empty query string... append your part to doc
  document.location.href = document.location.href + "?search=car";
} 
```

检查`document.location`控制台中的对象以查看它还提供了什么。通常不需要解析`document.URL`或`document.location.href`直接解析。

```
console.dir(document.location); 
```

# sharepoint - TFS 2010 构建具有自定义输出的 Sharepoint 2010 解决方案

> ID：10755609
> 
> 赞同：0
> 
> 时间：2012-05-25T13:51:44.743
> 
> 标签：sharepoint, sharepoint-2010, msbuild-4.0, wsp

我对这个 SO 帖子有一个非常相似的问题：[TFS Build 2010 - Custom Binary Location and SharePoint WSP](https://stackoverflow.com/questions/6274637/tfs-build-2010-custom-binary-location-and-sharepoint-wsp)。没有明显的答案，但提供的唯一答案似乎是要走的路。

我正在构建几个解决方案，需要将解决方案和项目放入自己的文件夹中。这导致生成输出更改为我正在使用的模板中的 MSBuild 调用。我已经使用它一段时间了，没有任何问题。

最近，一位开发人员抱怨我们的日常构建中没有生成 .wsp 文件。我对此进行了调查，并遇到了前面提到的 SO 帖子。

我按照说明操作，现在有一个新错误：

> C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\SharePointTools\Microsoft.VisualStudio.SharePoint.targets (411)：找不到方法：'Boolean Microsoft.VisualStudio.SharePoint.PathUtils.HasIllegalDeploymentPathCharacters(System.细绳）'。

我在目标文件中查看了这一行（411）：

```
<PackageFiles LayoutPath="$(LayoutPath)%(EnumeratedFiles.Package)\" PackagePath="$(BasePackagePath)%(EnumeratedFiles.Package).$(PackageExtension)" /> 
```

*PackageFiles*目标定义为：

```
<UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="PackageFiles" /> 
```

我检查了 GAC 并没有看到它，所以我添加了它。TFS 2010 Build 机器上安装了 Visual Studio 2010 和 Sharepoint 2010。除了更改此任务之外，我认为我不需要做任何事情：

```
<CreateSharePointProjectService Configuration="$(Configuration)"
                                Platform="$(Platform)"
                                ProjectFile="$(MSBuildProjectFile)"
                                ProjectReferences="@(SharePointProjectReference)"
                                OutDir="$(TargetDir)">
  <Output PropertyName="ProjectService" TaskParameter="ProjectService" />
</CreateSharePointProjectService> 
```

所以*OutDir 指向 $(TargetDir)*。

我是否遗漏了一些关于为什么在现在找不到方法的情况下出现此错误的信息？这个错误非常令人恼火，因为无论使用 Google Fu，网络上都没有任何信息！

**更新** 我已经拆开了构建服务器上的 Microsoft.VisualStudio.SharePoint.dll。没有 PathUtils 类或命名空间。我可能有这个文件的错误版本吗？我怎样才能检测到这个？我应该在构建服务器上安装 Sharepoint SDK。它已经安装了 Sharepoint 2010。

**更新 2**
我检查了 GAC。Microsoft.VisualStudio.Sharepoint 程序集出现。但是，我只能在运行 x64 版本的 Visual Studio 命令提示符时找到它。当我运行正常时，我没有得到任何组装。我假设这是因为 Sharepoint 程序集是 64 位的。据我所知，TFS 设置为 64 位。这会是我的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:58:29.840

PathUtils.HasIllegalDeploymentPathCharacters 方法存在于 Microsoft.VisualStudio.SharePoint.Designers.Models.dll 的版本 10.0.40219.1 中，而不是版本 10.0.30319.1 中（我看到此错误的地方）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:16:29.587

我找到了解决这个问题的方法。我认为没有人遇到过这种情况，所以我怀疑是否会有“正确”的解决方案。我将在这里发布我所做的以允许我的 .wsp 文件在解决方案中构建。

如果您认为有更好的解决方案或者我解决问题的方式不符合标准，请务必发布答案（或对此答案或原始问题发表评论）。

我将按照我想出的解决问题的步骤来解释这一点。

**第一步***PackageFiles* 任务给了我这个问题。此任务找不到要调用的方法。查看文件*C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\SharePointTools\Microsoft.VisualStudio.SharePoint.targets*我们可以在第 56 行找到：

```
<UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="PackageFiles" /> 
```

我知道在哪里可以找到*PackageFiles*任务/类。

**第二步** 知道在哪里看后，我反编译了任务。我使用了 Telerik 的 JustDecompile，但我也在 Reflector 中提出了相同的代码。

我可以清楚地看到这条线：

```
if (PathUtils.HasIllegalDeploymentPathCharacters(str2)) 
```

这是错误的。

**第三步** 我最终决定*PathUtils.HasIllegalDeploymentPathCharacters*方法只是作为安全检查。我可以在自己的自定义库中重新创建此任务，然后将其插入自定义目标文件中。

这是我想出的课程：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Reflection;
using Microsoft.VisualStudio.SharePoint.Tasks;
using Microsoft.Build.Framework;

namespace SharepointTaskLibrary
{
  public class PackageFiles : BuildTask
  {
    [Required]
    public ITaskItem LayoutPath
    {
      get;
      set;
    }

    [Required]
    public ITaskItem PackagePath
    {
      get;
      set;
    }

    public PackageFiles()
    {

    }

    protected override void OnCheckParameters()
    {
      if (this.LayoutPath == null)
      {
        throw new InvalidOperationException(Strings.GetString("LayoutPathNotSpecified"));
      }
      if (this.PackagePath == null)
      {
        throw new InvalidOperationException(Strings.GetString("PackagePathNotSpecified"));
      }
    }

    protected override void OnExecute()
    {
      object[] objArray;
      object[] objArray2;
      object[] objArray3;
      string metadata = this.LayoutPath.GetMetadata("FullPath");
      string str1 = this.PackagePath.GetMetadata("FullPath");

      Assembly sharepointTasksAss = Assembly.Load("Microsoft.VisualStudio.SharePoint.Tasks");

      if (sharepointTasksAss != null)
        base.Log.LogMessage(MessageImportance.High, "Found Tasks assembly!");
      else
      {
        base.Log.LogError("Couldn't find the tasks assembly");
        return;
      }

      if (!Directory.Exists(metadata))
      {
        base.Log.LogErrorFromResources("LayoutPathDoesNotExist", new object[] { metadata });
      }
      else
      {
        MethodInfo createCabMethod = GetStaticMethod(sharepointTasksAss, "Microsoft.VisualStudio.SharePoint.Tasks.Utilities.CabCreator", "CreateCabinet");

        if (createCabMethod == null)
        {
          base.Log.LogError("the method could not be retrieved on type.");
          return;
        }
        else
          base.Log.LogMessage(MessageImportance.High, "Found method: " + createCabMethod.Name);

        IEnumerable<string> strs = createCabMethod.Invoke(null, new object[] { metadata, str1 }) as IEnumerable<string>;

        /*
         * The following code would error in the original task.
         */
        //foreach (string str2 in strs)
        //{
        //  if (PathUtils.HasIllegalDeploymentPathCharacters(str2))
        //  {
        //    base.Log.LogWarningFromResources("FileNameContainsIllegalDeploymentPathCharacters", new object[] { str2 });
        //  }
        //}
        base.Log.LogMessage(MessageImportance.High, Strings.GetString("PackageCreatedSuccessfully"), new object[] { str1 });
      }

      Type codeMarkersType = null;

      try
      {
        codeMarkersType = sharepointTasksAss.GetType("Microsoft.Internal.Performance.CodeMarkers", true);
      }
      catch (Exception e)
      {
        base.Log.LogErrorFromException(e, true);
      }

      if (codeMarkersType == null)
      {
        base.Log.LogError("Couldn't get the CodeMarkers class!");
        return;
      }
      else
        base.Log.LogMessage(MessageImportance.High, "Found the type: " + codeMarkersType.FullName);

      /*
       * This has yet to be added back in.
       */
      //CodeMarkers.Instance.CodeMarker(CodeMarkerEvent.perfSharePointPackageWspPackageEnd);
    }

    private MethodInfo GetStaticMethod(Assembly assembly, string typeName, string methodName)
    {
      Type type = null;

      try
      {
        type = assembly.GetType(typeName, true);
      }
      catch (Exception e)
      {
        base.Log.LogErrorFromException(e, true);
      }

      if (type == null)
      {
        base.Log.LogError("Couldn't get the type: " + typeName);
        return null;
      }
      else
        base.Log.LogMessage(MessageImportance.High, "Found the type: " + type.FullName);

      MethodInfo methodInfo = type.GetMethod(methodName, BindingFlags.Static);

      if (methodInfo == null)
      {
        MethodInfo[] methods = type.GetMethods().Union(type.GetMethods(BindingFlags.Static)).ToArray();

        base.Log.LogWarning(string.Format("Wasn't able to find {0} directly. Searching through the static {1} method(s) on {2}", methodName, methods.Length, type.FullName));

        foreach (MethodInfo info in methods)
        {
          if (info.Name == methodName && methodInfo == null)
            methodInfo = info;
        }

        if (methodInfo == null)
        {
          MemberInfo[] members =
                  type.GetMembers().Union(type.GetMembers(BindingFlags.Static | BindingFlags.NonPublic)).Union(type.GetMembers(BindingFlags.NonPublic)).ToArray();

          base.Log.LogWarning(string.Format("Wasn't able to find {0}. Searching through the {1} members(s) on {2}", methodName, methods.Length, type.FullName));

          MemberInfo createCabMember = null;

          foreach (MemberInfo member in members)
          {
            if (member.Name == methodName)
            {
              createCabMember = member;
              break;
            }
            else
              base.Log.LogMessage(MessageImportance.High, "Found member: " + member.Name);
          }

          if (createCabMember == null)
            base.Log.LogError("Still wasn't able to find " + methodName + " in the members!");
        }
      }

      return methodInfo;
    }
  }
} 
```

由于大多数类和方法都被标记为*内部*的，我不得不使用反射来获取实际构建 cab/wsp 文件所需的类型和方法。这是在方法中完成的：*GetStaticMethod*

**第四步** 如果您阅读反编译代码和我的自定义版本的类，您会注意到*Strings*类。它似乎是一个资源访问器类。我决定我也只是反编译该代码并将其用于我的解决方案中，以生成自定义任务，而不是每次我想访问字符串资源时都进行反映。该文件最终不是直接反编译，因为它有一行*this.GetType().Assembly*用于获取包含资源的当前程序集。这在原始程序集中可以正常工作，但在此自定义程序集中会导致问题。

原行：

```
internal Strings()
{
    this.resources = new ResourceManager("Strings", this.GetType().Assembly);
} 
```

该行必须更改为：

```
Assembly sharepointTasksAss = Assembly.Load("Microsoft.VisualStudio.SharePoint.Tasks");
this.resources = new ResourceManager("Strings", sharepointTasksAss); 
```

**第五步** 在我有一个模仿原始的自定义构建任务之后，我现在需要将它放入目标文件中。然后，我备份了原始目标文件并制作了一个自定义文件来替换*UsingTask*部分，如下所示：

```
 <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="CreateSharePointProjectService" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="EnumerateFiles" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="EnumerateFeature" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="EnumeratePackage" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="EnumerateProjectItem" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="LayoutFiles" />
  <!-- The next task is a mimic of the one from the other assembly.  I decompiled it and recreated it so it wouldn't error.  LOL -->
  <UsingTask AssemblyFile="C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\SharePointTools\SharepointTaskLibrary.dll" TaskName="PackageFiles" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="ResolveProjectMember" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="SetPackagingProperties" />
  <UsingTask AssemblyFile="Microsoft.VisualStudio.SharePoint.Tasks.dll" TaskName="ValidatePackage" /> 
```

这使得*任务指向包含自定义任务的我的 DLL。具体来说，这一行：*

 *```
<UsingTask AssemblyFile="C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\SharePointTools\SharepointTaskLibrary.dll" TaskName="PackageFiles" /> 
```

**最后**
，我将编译的 DLL 和编辑的目标文件放入*C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\SharePointTools*目录（再次备份原始目标文件）。

这使我能够通过 TFS 2010 构建自定义输出由 SharePoint 解决方案生成的 wsp 文件！

我将此站点用作资源：http: [//blogs.like10.com/2011/08/04/team-build-2010-customized-output-directories-sharepoint-2010-wsps/](http://blogs.like10.com/2011/08/04/team-build-2010-customized-output-directories-sharepoint-2010-wsps/)

（我可能使用了另外一两个站点作为资源，但我现在可以在浏览器历史记录中找到它们）。

您的里程可能会有所不同，但请让我知道是否有人有类似的问题并且能够以非“黑客”的方式修复它。

**更新**
这整个问题似乎来自我正在管理的原始 TFS 安装。我最近将我们的团队搬到了一个合适的 TFS 服务器（2012），安装了全新的操作系统和一个新的数据库服务器。一旦我迁移数据库并在 TFS 中运行升级任务，我就能够进行一些小的构建编辑以使我的构建与 2012 一起工作，并且我没有第二次遇到这个问题。我相信，因为最初的 2010 TFS 是在经过转换的*开发*机器上，所以会导致这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:33:28.670

您缺少程序集“Microsoft.VisualStudio.SharePoint.Designers.Models.dll”

必须将以下程序集复制到构建系统的 GAC：

> Microsoft.VisualStudio.SharePoint.Designers.Models.dll Microsoft.VisualStudio.SharePoint.Designers.Models.Features.dll Microsoft.VisualStudio.SharePoint.Designers.Models.Packages.dll Microsoft.VisualStudio.SharePoint.dll

有关所需程序集的更多信息，请参阅以下文章：

[http://msdn.microsoft.com/en-us/ff622991.aspx](http://msdn.microsoft.com/en-us/ff622991.aspx)

问候，

韦斯麦克唐纳*

# javascript - 如何在循环中对一堆动态函数进行原型设计？

> ID：10755616
> 
> 赞同：0
> 
> 时间：2012-05-25T13:52:17.667
> 
> 标签：javascript, closures

我正在尝试对具有不同级别（调试、信息、警告...）的自定义记录器进行原型设计，每个记录器都具有不同的属性，如颜色、名称等。

我要做的是动态构建所有这些级别，从我存储所有属性的 Hashmap 中获取它们。因此，例如，我的自定义记录器对象带有`logger.debug('test')`、`logger.info('text)`等。你明白了。

但是，我遇到了这个特定代码的问题：

```
var MyLogger = function(opts) {
    this.level = opts.level || 0
    this.loggers = {}

    var self = this

    for (l in LEVELS) {
        this.addLogger(l, new loggerOutput(LEVELS[l]))
        this[l] = function(message) {
            self.getLogger(l).output(message)
        }
    }
} 
```

问题在于**self.getLogger(l)**，因为它总是指向我的最后一个记录器（错误）。如果我用静态字符串替换变量，它可以工作：**self.getLogger('info')**

解决方法是手动制作所有记录器的原型，并且显然可行，但我期待找到更好的解决方案：

```
MyLogger.prototype = {
    debug: function(message) {
        this.getLogger('debug').output(message)
    },
    info: function(message) {
        this.getLogger('info').output(message)
    }
        ...
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:11:21.480

使用原型解决方案，但通过将当前“级别”传递给函数工厂来循环分配函数。

```
for (var L in LEVELS)
    MyLogger.prototype[L] = loggerMaker(L)

function loggerMaker(l) {
    return function(message) {
        this.getLogger(l).output(message)
    };
} 
```

在这里，我使用了一个函数来创建一个新的变量作用域，该作用域引用`L`循环中的当前变量。

如果您只为现代 JavaScript 环境编写代码，我会使用 Array 而不是 Object 来保存关卡，然后`forEach`与匿名函数一起使用。

```
;['debug','info','warn'].forEach(function(L) {
    MyLogger.prototype[L] = function(message) {
        this.getLogger(L).output(message);
    };
}); 
```

# google-visualization - 谷歌图表api中的换行符

> ID：10755617
> 
> 赞同：2
> 
> 时间：2012-05-25T13:52:18.367
> 
> 标签：google-visualization

我正在使用 google map chat api 创建图像。我正在生成以下 url [googlechartapi](http://chart.apis.google.com/chart?chst=d_bubble_text_small&chld=bb%7Chelo%20world%20by%20qwerty%20%7Cff0000%7C000000)

![在此处输入图像描述](../Images/21c456cec35129e3caf5189f83eedfe8.png)

这是我得到的图像。但我想在另一行中使用“by qwerty”。我试图插入
或 | 但它不工作。知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:35:09.773

你正在寻找类似的东西，我猜：

[http://chart.apis.google.com/chart?chst=d_bubble_texts_big&chld=bb|ff0000|000000|hello+world|by+qwerty](http://chart.apis.google.com/chart?chst=d_bubble_texts_big&chld=bb|ff0000|000000|hello+world|by+qwerty)

查看[多行气泡文档](https://developers.google.com/chart/image/docs/gallery/dynamic_icons?hl=pl-PL#bubbles)。

第一行总是会更大，而且您似乎对此无能为力。

> 一行或多行文本，用于多行文本气泡。每行由 | 分隔 标记。第一行将显示为更大和粗体。空格必须替换为 +。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:22:49.083

[https://chart.googleapis.com/chart?chst=d_text_outline&chld=FFCC33|16|h|FF0000|b|Hello+world|by+qwerty](https://chart.googleapis.com/chart?chst=d_text_outline&chld=FFCC33|16|h|FF0000|b|Hello+world|by+qwerty)

[https://chart.googleapis.com/chart?chst=d_bubble_texts_big&chld=bb|FFB573|000000|Helo+world|by+qwerty](https://chart.googleapis.com/chart?chst=d_bubble_texts_big&chld=bb|FFB573|000000|Helo+world|by+qwerty)

![你好世界](../Images/c36d1fea99185190ed100cb622358169.png)

解释：

[https://developers.google.com/chart/image/docs/gallery/dynamic_icons?hl=pl-PL#single_line_outlined_text_icon](https://developers.google.com/chart/image/docs/gallery/dynamic_icons?hl=pl-PL#single_line_outlined_text_icon)

[https://developers.google.com/chart/image/docs/gallery/dynamic_icons?hl=pl-PL#bubbles](https://developers.google.com/chart/image/docs/gallery/dynamic_icons?hl=pl-PL#bubbles) ？

# php - 使用模式匹配在 PHP 中验证字符串

> ID：10755621
> 
> 赞同：0
> 
> 时间：2012-05-25T13:52:34.377
> 
> 标签：php

嘿，有人可以帮我测试一个字符串是否与用冒号分隔的 3 个两位数匹配吗？例如：

12:13:14

我知道我应该使用 preg_match 但我不知道如何

最好第一个数字应该在 0 到 23 之间，第二个数字应该在 0 到 59 之间，就像时间一样，但我总是可以用 if 语句解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:41:54.380

此答案在整个字符串中正确匹配（其他答案将匹配较长字符串中的正则表达式），无需任何额外测试：

```
if (preg_match('/^((?:[0-1][0-9])|(?:2[0-3])):([0-5][0-9]):([0-5][0-9])$/', $string, $matches))
{
    print_r($matches);
}
else
{
    echo "Does not match\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:55:15.370

```
$regex = "/\d\d\:\d\d\:\d\d/";

$subject = "12:13:14";

preg_match($regex, $subject, $matches);

print_r($matches); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:55:53.437

```
if (preg_match ('/\d\d:\d\d:\d\d/', $input)) {
    // matches
} else {
    // doesnt match
} 
```

`\d`表示任何数字，因此中间有两个数字`:`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:03:46.177

您可以将[preg_match](http://co.php.net/manual/en/function.preg-match.php)与数字比较一起使用`$string = '23:24:25';`

```
preg_match('~^(\d{2}):(\d{2}):(\d{2})$~', $string, $matches);

if (count($matches) != 3 || $matches[1] > 23 || $matches[2] > 59 || $matches[3] > 59 ......)
    die('The digits are not right'); 
```

或者您甚至可以放弃常规表达式并使用带数字比较的[explode 。](http://php.net/manual/en/function.explode.php)

```
$numbers = explode(':', $string);

if (count($numbers) != 3 || $numbers[0] > 23 || $numbers[1] > 59 || $numbers[2] > 59 ......)
    die('The digits are not right'); 
```

# xml - postgres xpath 所有节点并在其中少数节点上使用功能

> ID：10755622
> 
> 赞同：0
> 
> 时间：2012-05-25T13:52:37.727
> 
> 标签：xml, postgresql, xpath

我在 postgresql 中编写函数时遇到问题，该函数获取 xml 数据的输入，然后获取所有节点，并且对于以 work 'key' 结尾的节点调用函数。例如，我必须这样做：

```
function readdata(data xml) RETURNS VOID AS $$
INSERT INTO data_table SELECT FROM xpath('//text()',data) 
```

一些xml是这样的：

```
< node1>sometext< /node1>
< node2_key>anyvalue< /node2_key>
< node3_key>integer< /node3_key>
< node4>anyvalue< /node4> 
```

但我不知道如何`check_val('node2',valueof node2_key )`在从数据参数中选择时调用函数。

我试图实现的是：在我的 SELECT 在 myfunction 中，当它们不以单词'key'结尾时，它给了我节点的值，而以它结尾的节点给了我 check_val 函数的结果。

有没有办法用 postgresql 9.1 做到这一点？我将不胜感激任何代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:16:31.980

我不了解 Postgres，但获取名称以结尾的所有节点（元素）的文本的 XPath`key`是：

```
//*[string-length(name())>2 and substring(name(),string-length(name())-2,3)='key']/text() 
```

以及用于获取名称不以结尾的所有节点（元素）的文本的 XPath`key`是：

```
//*[string-length(name())<3 or substring(name(),string-length(name())-2,3)!='key']/text() 
```

# javascript - Onblur 事件在另一个 div 的 onclick 之前触发

> ID：10755625
> 
> 赞同：3
> 
> 时间：2012-05-25T13:52:48.637
> 
> 标签：javascript, jquery, html, onclick, onblur

![在此处输入图像描述](../Images/16ec05a3f1f1c049206fa3e3bfd90b6e.png)

如上所述，我有一个按钮，单击该按钮将打开子菜单。对于子菜单中的每个选项，都有三个元素（我认为实际上还有更多元素，但为简单起见，将其保留为 3）。我将焦点放在子菜单的主 div（白色“框架”）上。这个 div 的 Onblur - 然后我隐藏子菜单。

这一切都按预期运行 - 但我有一个问题，当单击特定选项的 3 个元素之一（即给定焦点）时，主 div 将关闭，因为它是 onblur 事件处理程序 - 以及链接到的 PopUp 函数未触发/到达子菜单中选项的元素的 onClick 事件。

如果未单击选项，我需要以某种方式仅以这种方式处理主 div 的 onblur 事件。

我显然可以使用 JQuery，所以我非常乐意使用它来解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:10:05.413

我将发布此答案-希望有人可以改进它或提出替代方案，因为它确实感觉像是一种解决方法。

但是，我所做的是 onblur 事件 - 我没有立即隐藏 div，而是使用超时设置了一个小延迟，因此我不会更改触发的 onblur/onclick 事件的优先级，但实际上给出onclick 'a chance' 触发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:05:37.020

您可以尝试以下想法：（未经测试，因此需要一些调整/调试..）

```
function mouseOverSubMenu(mouseX, mouseY) {
    var divTop = $('.sub_menu').offset().top;
    var divLeft = $('.sub_menu').offset().left;
    var divRight = divLeft + $('.sub_menu').width();
    var divBottom = divTop + $('.sub_menu').height();

    return (mouseX >= divLeft && 
            mouseX < divRight &&
              mouseY >= divTop &&
              mouseY < divBottom);
}

$('.sub_menu, .other_elements').hover(
    function(e) {
        if (mouseOverStartButton(e.pageX, e.pageY)) {
            // show menu
        }
    },
    function(e) {
        if (!mouseOverStartButton(e.pageX, e.pageY)) {  
            //hide menu
        }
    }
); 
```

# asp.net-mvc - 缺少 ASP MVC ModelState 值

> ID：10755628
> 
> 赞同：2
> 
> 时间：2012-05-25T13:52:55.047
> 
> 标签：asp.net-mvc

我有一个标有 [HttpPost] 的方法，带有许多参数。当我的表单发布时，我可以看到参数具有正确的值（代码 ==“popppppppp”）但是当我查看 ViewData.ModelState 时，我没有看到“代码”的条目，但我*确实*看到了 DefaultLeadDays 的条目这是一个可以为空的整数。

这怎么可能是这种情况，有谁知道我需要做些什么来解决它？

![在此处输入图像描述](../Images/8cd43f26f0b41f75c9ff98a26ee24a87.png)

# r - R ggplot facet：通过 facet 改变 x 轴格式和改变美学

> ID：10755631
> 
> 赞同：2
> 
> 时间：2012-05-25T13:53:05.697
> 
> 标签：r, ggplot2, facet

我希望有人可以提供帮助 1）在刻面图中改变面板中 x 轴的格式 2）仅在刻面的左侧显示黄土更平滑。

左边是更长的历史，右边是过去十二个月。真实数据集有更多数据（更多时间和更多变量），因此这些问题变得更糟，但我认为下面的代码应该显示我的问题。右边的日期被压扁了，只需要十二点就不需要更平滑了。

非常感谢任何帮助！谢谢艾丹

```
 g<-structure(list(Date = structure(c(13909, 13938, 13969, 13999,
    14029, 14060, 14091, 14120, 14152, 14183, 14211, 14244, 14274,
    14302, 14334, 14364, 14393, 14425, 14456, 14487, 14517, 14547,
    14578, 14609, 14638, 14666, 14699, 14729, 14760, 14790, 14820,
    14852, 14882, 14911, 14943, 14974, 15005, 15033, 15064, 15093,
    15125, 15155, 15184, 15217, 15247, 15278, 15308, 15338, 15370,
    15399, 15429, 15460, 15125, 15155, 15184, 15217, 15247, 15278,
    15308, 15338, 15370, 15399, 15429, 15460), class = "Date"), value = c(199.8,
    195.7, 200.1, 201, 207.7, 215.1, 210.3, 202.9, 191, 186.5, 180.1,
    175.7, 164.6, 168.2, 169.9, 166.6, 174.7, 181.8, 181.3, 177.3,
    176.1, 172.2, 170, 170.7, 164.9, 164.6, 169.6, 172.3, 174.6,
    182.9, 182.1, 177.3, 171.4, 170.6, 170.2, 168.8, 157.9, 156.1,
    159.8, 161.1, 169.3, 175.6, 171.2, 171.2, 165.3, 160.8, 164,
    162.2, 154.6, 155.6, 164.8, 177.4, 169.3, 175.6, 171.2, 171.2,
    165.3, 160.8, 164, 162.2, 154.6, 155.6, 164.8, 177.4), variable = structure(c(1L,
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = "NAR Median Hse Price ($000)", class = "factor"),
        var2 = c("History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "History",
        "History", "History", "History", "History", "History", "LTM",
        "LTM", "LTM", "LTM", "LTM", "LTM", "LTM", "LTM", "LTM", "LTM",
        "LTM", "LTM")), .Names = c("Date", "value", "variable", "var2"
    ), row.names = c("1016", "1017", "1018", "1019", "1020", "1021",
    "1022", "1023", "1024", "1025", "1026", "1027", "1028", "1029",
    "1030", "1031", "1032", "1033", "1034", "1035", "1036", "1037",
    "1038", "1039", "1040", "1041", "1042", "1043", "1044", "1045",
    "1046", "1047", "1048", "1049", "1050", "1051", "1052", "1053",
    "1054", "1055", "1056", "1057", "1058", "1059", "1060", "1061",
    "1062", "1063", "1064", "1065", "1066", "1067", "10561", "10571",
    "10581", "10591", "10601", "10611", "10621", "10631", "10641",
    "10651", "10661", "10671"), class = "data.frame")

    gp<-ggplot(g,aes(x=Date,y=value,group=variable)) +
         opts(
            panel.background = theme_rect(size = 1, colour = "lightgray"),
            panel.grid.minor = theme_blank(),
            strip.background = theme_blank(),
            axis.title.x = theme_blank(),
            axis.title.y = theme_blank()
      ,strip.text.y = theme_text(size = 12,angle = 0)
        )
    gp<- gp + geom_line(size=1)
    gp <-gp + facet_grid(variable ~ var2, scales="free")
    gp<-gp+geom_smooth(method=loess,size=1,span=.35,alpha=.005)
    gp 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:55:28.447

在一个面板上获得更平滑很容易：

```
gp<-ggplot(g,aes(x=Date,y=value,group=variable)) +
    opts(
        panel.background = theme_rect(size = 1, colour = "lightgray"),
        panel.grid.minor = theme_blank(),
        strip.background = theme_blank(),
        axis.title.x = theme_blank(),
        axis.title.y = theme_blank()
        ,strip.text.y = theme_text(size = 12,angle = 0)
    )
gp<- gp + geom_line(size=1)
gp <-gp + facet_grid(variable ~ var2, scales="free")
gp<-gp+geom_smooth(data=g[g$var2=="History",],
                   method=loess,size=1,span=.35,alpha=.005)
gp 
```

至于改变 x 轴上标签的外观，请查看此处的选项：[https ://github.com/hadley/ggplot2/wiki/+opts()-List](https://github.com/hadley/ggplot2/wiki/+opts()-List)

# java - 在 Collection 中查找重复条目

> ID：10755632
> 
> 赞同：10
> 
> 时间：2012-05-25T13:53:05.903
> 
> 标签：java, collections, duplicates, equality

是否有工具或库可以根据可以实现的特定标准在集合中查找重复条目？

* * *

为了让自己清楚：我想根据特定标准将条目相互比较。所以我认为`Predicate`回归只是`true`或`false`不够。

* * *

我不能用`equals`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T14:00:28.350

它取决于标准的语义：

**如果你的标准对于给定的类***总是相同的，并且是******底层概念所固有的***，你应该只实现`equals`和`hashCode`使用一个集合。**

 *****如果您的标准取决于 context***， [org.apache.commons.collections.CollectionUtils.select(java.util.Collection, org.apache.commons.collections.Predicate)](https://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html#select%28java.util.Collection,%20org.apache.commons.collections.Predicate%29)可能是适合您的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T14:08:59.717

如果您想*查找*重复项，而不仅仅是删除它们，一种方法是将集合放入数组中，通过实现您的标准的 Comparator 对数组进行排序，然后线性遍历数组，查找相邻的重复项。

这是一个草图（未经测试）：

```
 MyComparator myComparator = new MyComparator();
   MyType[] myArray = myList.toArray();
   Arrays.sort( myArray, myComparator );
   for ( int i = 1; i < myArray.length; ++i ) {
      if ( 0 == myComparator.compare( myArray[i - 1], myArray[i] )) {
         // Found a duplicate!
      }
   } 
```

**编辑：**从您的评论中，您只想知道是否有*重复*。上面的方法也适用于此。但是您可以更简单地创建一个带有自定义比较器的 java.util.SortedSet。这是一个草图：

```
 MyComparator myComparator = new MyComparator();
   TreeSet treeSet = new TreeSet( myComparator );
   treeSet.addAll( myCollection );
   boolean containsDuplicates = (treeSet.size() != myCollection.size()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T14:11:20.713

您可以调整 Java 集以在任意类型的对象中搜索重复项：将目标类包装在私有包装器中，该包装器根据您的标准评估相等性，并构造一组包装器。

这是一个有点长的例子来说明这项技术。它认为两个名字相同的人是相等的，因此它在五个对象的数组中检测到三个重复项。

```
import java.util.*;
import java.lang.*;

class Main {
    static class Person {
        private String first;
        private String last;
        public String getFirst() {return first;}
        public String getLast() {return last;}
        public Person(String f, String l) {
            first = f;
            last = l;
        }
        public String toString() {
            return first+" "+last;
        }
    }
    public static void main (String[] args) throws java.lang.Exception {
        List<Person> people = new ArrayList<Person>();
        people.add(new Person("John", "Smith"));
        people.add(new Person("John", "Scott"));
        people.add(new Person("Jack", "First"));
        people.add(new Person("John", "Walker"));
        people.add(new Person("Jack", "Black"));
        Set<Object> seen = new HashSet<Object>();
        for (Person p : people) {
            final Person thisPerson = p;
            class Wrap {
                public int hashCode() { return thisPerson.getFirst().hashCode(); }
                public boolean equals(Object o) {
                    Wrap other = (Wrap)o;
                    return other.wrapped().getFirst().equals(thisPerson.getFirst());
                }
                public Person wrapped() { return thisPerson; }
            };
            Wrap wrap = new Wrap();
            if (seen.add(wrap)) {
                System.out.println(p + " is new");
            } else {
                System.out.println(p + " is a duplicate");
            }
        }
    }
} 
```

[你可以在 ideone [link]](http://ideone.com/moP94)上玩这个例子。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-25T14:00:19.147

您可以使用地图，并在遍历集合时将元素放入地图中（谓词将形成键），如果已经有一个条目，则您发现了重复项。

有关更多信息，请参见此处：[在集合中查找重复项](https://stackoverflow.com/questions/8108179/finding-duplicates-in-a-collection)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-29T19:13:36.227

我创建了一个类似于[.NET](https://duckduckgo.com/?q=.net%20framework)[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)中的接口的新接口。

然后我将这样的`EqualityComparator<T>`传递给以下检测重复项的方法。

```
public static <T> boolean hasDuplicates(Collection<T> collection,
        EqualsComparator<T> equalsComparator) {
    List<T> list = new ArrayList<>(collection);
    for (int i = 0; i < list.size(); i++) {
        T object1 = list.get(i);
        for (int j = (i + 1); j < list.size(); j++) {
            T object2 = list.get(j);
            if (object1 == object2
                    || equalsComparator.equals(object1, object2)) {
                return true;
            }
        }
    }
    return false;
} 
```

这样我就可以根据自己的需要自定义比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-17T13:36:50.840

Treeset 允许您轻松地做到这一点：

```
Set uniqueItems = new TreeSet<>(yourComparator);
List<?> duplicates = objects.stream().filter(o -> !uniqueItems.add(o)).collect(Collectors.toList()); 
```

`yourComarator`在调用 时使用`uniqueItems.add(o)`，它将项目添加到集合中，`true`如果项目是唯一的则返回。如果比较器认为该项目重复，`add(o)`将返回 false。

请注意，该项目的`equals`方法必须与 TreeSet 文档一致`yourComarator`才能[正常](https://docs.oracle.com/javase/8/docs/api/java/util/TreeSet.html)工作。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-03-07T17:44:47.627

迭代`ArrayList`其中包含重复项并将它们添加到`HashSet`. 当 add 方法返回 false 时，`HashSet`只需将副本记录到控制台。**

# c# - C#按列排序列表视图？

> ID：10755633
> 
> 赞同：1
> 
> 时间：2012-05-25T13:53:06.653
> 
> 标签：c#, winforms

我用列表视图构建了一个包含 2 列的数据表，我需要按第二列对数据表进行排序。

它看起来像这样：

Name - Points
------------------
John - 10
Peter - 14
Marcus - 9

那么如何按点数排序呢？

**解决了！！**

```
 private class PointsComparer : IComparer
        {
            private const int pointsColumnIndex = 1;

            public int Compare(object x, object y)
            {
                ListViewItem listX = (ListViewItem)x;
                ListViewItem listY = (ListViewItem)y;

                // Convert column text to numbers before comparing.
                // If the conversion fails, just use the value 0.
                decimal listXVal, listYVal;
                try
                {
                    listXVal = Decimal.Parse(listX.SubItems[pointsColumnIndex].Text);
                }
                catch
                {
                    listXVal = 0;
                }

                try
                {
                    listYVal = Decimal.Parse(listY.SubItems[pointsColumnIndex].Text);
                }
                catch
                {
                    listYVal = 0;
                }

                return (-Decimal.Compare(listXVal, listYVal));
            }
        } 
```

这对我来说是一种魅力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:13:19.463

使用[ListViewItemSorter](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.listviewitemsorter.aspx)属性`IComparer`为您的项目设置自定义。然后简单地调用`Sort()`方法：

```
// adding data
listView1.Items.Add(new ListViewItem(new string[] { "John", "10" }));
listView1.Items.Add(new ListViewItem(new string[] { "Peter", "14" }));
listView1.Items.Add(new ListViewItem(new string[] { "Markus", "9" }));
// setting comparer and sorting
listView1.ListViewItemSorter = new PointsComparer();
listView1.Sort(); 
```

这是可用于比较点的比较器示例：

```
private class PointsComparer : IComparer
{
    private const int pointsColumnIndex = 1;

    public int Compare(object x, object y)
    {
        int pointsX = Int32.Parse(((ListViewItem)x).SubItems[pointsColumnIndex].Text);
        int pointsY = Int32.Parse(((ListViewItem)y).SubItems[pointsColumnIndex].Text);
        return pointsX.CompareTo(pointsY);
    }
} 
```

或者，正如我之前发布的，您可以使用来自 msdn 示例的按列文本比较器。

更新：您可以将所需的排序顺序传递给比较器的实例：

```
private class PointsComparer : IComparer
{
    private const int pointsColumnIndex = 1;
    private SortOrder _sortOrder;            

    public PointsComparer(SortOrder sortOrder)
    {
        _sortOrder = sortOrder;
    }

    public int Compare(object x, object y)
    {
        int pointsX = Int32.Parse(((ListViewItem)x).SubItems[pointsColumnIndex].Text);
        int pointsY = Int32.Parse(((ListViewItem)y).SubItems[pointsColumnIndex].Text);
        int comparisonResult = pointsX.CompareTo(pointsY);

        switch (_sortOrder)
        {
            case SortOrder.Ascending:
                return comparisonResult;
            case SortOrder.Descending:
                return (-1) * comparisonResult;
            default:
                return 0;
        }
    }
} 
```

然后像这样使用它：

```
listView1.ListViewItemSorter = new PointsComparer(SortOrder.Descending); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:00:53.573

> // 根据 ID 对数据进行排序
> 
> 假设 dt 是您要排序的数据表对象。您可以按照以下说明进行操作：

```
dt.DefaultView.Sort = "Points ASC"; 
```

> 现在 dt 是您的排序数据表

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:01:44.217

这帮助我解决了同样的问题。[http://support.microsoft.com/kb/319401](http://support.microsoft.com/kb/319401)

我发现我必须调整一些数学，因为当按数字排序时，有时会输入 1、10、11、12、2、20、21 等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:27:34.407

正如 Reniuz 所说，为了在 SQL 查询中获得更好的性能排序，并为 Xtra-gain 在字典或 arrayList 或通用列表（ List ）中实现它，您也可以使用 Datagridview 在 GUI 上显示 .. SQL 查询语法：

```
Select [Column1], [Column2] from [YourTable] order by [ColumnWhichYouWantToOrder1], [ColumnWhichYouWantToOrder2] [ {ASC} or {DESC} ] 
```

语法规则：

*   DESC 排序从最后一个到第一个或从 Z 到 A

*   ASC 排序从第一个到最后一个或从 A 到 Z

*   ASC 是默认值。因此，如果您按 ASC 订购，您可以使用 ..order by [Column] ... 无需编写 ASC

*   当您对多于 1 列进行排序时，SQL 开始从左列到右列排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T13:56:37.773

做喜欢

```
datatableinstance.DefaultView.Sort = "Points ASC"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T13:57:14.280

```
yourDt.DefaultView.Sort = "Points";
DataView dv = yourDt.DefaultView; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-25T13:58:55.463

```
 DataView dv = dt.DefaultView;  
   //apply the sort on CustomerSurname column  
   dv.Sort = "CustomerSurname";  
   //save our newly ordered results back into our datatable  
   dt = dv.ToTable(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-25T14:21:06.427

这里有一些样本

将以下代码粘贴到 ListView 控件的 ColumnClick 事件中：

```
 private void listView1_OnColumnClick(object sender, System.Windows.Forms.ColumnClickEventArgs e)
    {
        ListViewSorter Sorter = new ListViewSorter();
        listView1.ListViewItemSorter = Sorter;
        if (!(listView1.ListViewItemSorter is ListViewSorter))
            return;
        Sorter = (ListViewSorter) listView1.ListViewItemSorter;

        if (Sorter.LastSort == e.Column)
        {
            if (listView1.Sorting == SortOrder.Ascending)
                listView1.Sorting = SortOrder.Descending;
            else
                listView1.Sorting = SortOrder.Ascending;
        }
        else{
            listView1.Sorting = SortOrder.Descending;
        }
        Sorter.ByColumn = e.Column;

        listView1.Sort ();
    } 
```

* * *

```
 public class ListViewSorter : System.Collections.IComparer
    {
        public int Compare (object o1, object o2)
        {
            if (!(o1 is ListViewItem))
                return (0);
            if (!(o2 is ListViewItem))
                return (0);

            ListViewItem lvi1 = (ListViewItem) o2;
            string str1 = lvi1.SubItems[ByColumn].Text;
            ListViewItem lvi2 = (ListViewItem) o1;
            string str2 = lvi2.SubItems[ByColumn].Text;

            int result;
            if (lvi1.ListView.Sorting == SortOrder.Ascending)
                result = String.Compare (str1, str2);
            else
                result = String.Compare (str2, str1);

            LastSort = ByColumn;

            return (result);
        }

        public int ByColumn
        {
            get {return Column;}
            set {Column = value;}
        }
        int Column = 0;

        public int LastSort
        {
            get {return LastColumn;}
            set {LastColumn = value;}
        }
        int LastColumn = 0;
    } 
```

排序示例 [http://support.microsoft.com/kb/319401](http://support.microsoft.com/kb/319401)

多排序

[http://www.c-sharpcorner.com/uploadfile/nipuntomar/sort-a-multicolumn-listview-in-C-Sharp/](http://www.c-sharpcorner.com/uploadfile/nipuntomar/sort-a-multicolumn-listview-in-C-Sharp/)

# php - 在 localhost 上读取 cookie

> ID：10755634
> 
> 赞同：0
> 
> 时间：2012-05-25T13:53:07.900
> 
> 标签：php, macos, cookies, localhost

我已经在 mac 上安装了 phpmyadmin，但是有问题，当我使用 $_COOKIE[] 时，我在我的网页中看到了这条消息

> 注意：未定义变量：coo in

我该如何解决这个问题？

谢谢你 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:50:26.617

***用户1219391：***

您可以使用以下代码检查 cookie 值是否存在：

```
if (array_key_exists('user', $_COOKIE))
 {
     $userStatus=$_COOKIE['user'];
 }
 else
 {
     $userStatus='Not Set';
 }

 echo 'The value of Cookie user is '. $userStatus; 
```

***有了这个，你可以解决你的问题......***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:00:59.830

我认为这可能会有所帮助：

首先，您必须设置一个 cookie 值：

```
<?php
$expire=time()+60*60*24*30;
setcookie("user", "Alex Porter", $expire);
?> 
```

之后，您可以检索此值：

```
<?php
// Print a cookie
echo $_COOKIE["user"];

// A way to view all cookies
print_r($_COOKIE);
?> 
```

> 来源：[http ://www.w3schools.com/php/php_cookies.asp](http://www.w3schools.com/php/php_cookies.asp)

# android - 无法从我的服务访问 SharedPreferences

> ID：10755636
> 
> 赞同：1
> 
> 时间：2012-05-25T13:53:36.027
> 
> 标签：android, sharedpreferences

**我正在尝试做的事情**

* * *

大家好。

我得到了一个服务，每当在 SharedPreference 中启动或停止服务（启动 = 真 / 停止 = 假）时，它的布尔值设置为 true 或 false。现在，当我尝试在我的活动中获取布尔值时，它总是找不到它。我该如何解决这个问题……这是给你们的代码。

**代码**

* * *

我的服务中的方法：

```
private void setStarted(boolean started) {
    // SharedPreferences casten

    mPrefs = this.getSharedPreferences(LOG_TAG, MODE_PRIVATE);
    // Boolean in SharedPreferences hinzufügen
    SharedPreferences.Editor editor = mPrefs.edit();
    editor.clear().apply();
    editor.putBoolean(PREF_STARTED, started).commit();
    editor.commit();

    //mPrefs.edit().putBoolean(PREF_STARTED, started).commit();

    Log.d(LOG_TAG, "Variabel " + mPrefs.getBoolean(PREF_STARTED, false));
} 
```

在我的活动中

```
// mPrefs caten
        mPrefs = this.getSharedPreferences(GPSService.LOG_TAG, MODE_PRIVATE);

        // boolean holen ob service gestartet oder nicht
        run = mPrefs.getBoolean(GPSService.PREF_STARTED, false); 
```

我如何从那里取出布尔值？它总是返回我必须在 getBoolean Methode 中提供的默认值。

提前感谢您的帮助

苹果浏览器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:57:42.443

这是我在我的一个应用程序中成功使用的一些代码。它用于应用程序的各个部分，例如活动和服务：

```
void putValue(Context context, String pref, boolean value) {
    SharedPreferences settings = context.getSharedPreferences(PREFS_NAME, Activity.MODE_PRIVATE);
    SharedPreferences.Editor editor = settings.edit();
    editor.putBoolean(pref, value);
    editor.commit();                
}

boolean getValue(Context context, String value, boolean defaultValue) {
    SharedPreferences settings = context.getSharedPreferences(PREFS_NAME, Activity.MODE_PRIVATE);
    return settings.getBoolean(value, defaultValue);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:00:03.167

尝试在您的服务和活动中使用[PreferenceManager](http://developer.android.com/reference/android/preference/PreferenceManager.html)的getDefaultSharedPreferences(Context context) 方法。

```
private void setStarted(boolean started) {

    mPrefs = PreferenceManager.getDefaultSharedPreferences(this);
    mPrefs.edit().putBoolean(PREF_STARTED, started).commit();

    Log.d(LOG_TAG, "Variabel " + mPrefs.getBoolean(PREF_STARTED, false));
} 
```

在您的活动中

```
mPrefs = PreferenceManager.getDefaultSharedPreferences(this);    
run = mPrefs.getBoolean(GPSService.PREF_STARTED, false); 
```

还要确保你：

*   永远不要在编辑器上调用 .clear() 。
*   您在任何地方都使用 PreferenceManager.getDefaultSharedPreferences(this)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-19T17:04:55.027

只需以与活动的一部分相同的方式构建您的首选项对象。唯一的区别是拉入应用程序的上下文。

```
SharedPreferences prefs = _ getApplicationContext().getSharedPreferences("com.example.appname", Activity.MODE_PRIVATE);

Boolean tmpBool = prefs.getBoolean("PREF_NAME", null); 
```

# python - 为什么 tkinter 不能很好地处理多处理？

> ID：10755641
> 
> 赞同：7
> 
> 时间：2012-05-25T13:54:00.663
> 
> 标签：python, tkinter, multiprocessing

以下代码在 linux 中的 python 3.2.2 中没有做任何事情就挂起：

```
import tkinter
from multiprocessing import Process

def f():
    root = tkinter.Tk()
    label = tkinter.Label(root)
    label.pack()
    root.mainloop()

p = Process(target=f)
p.start() 
```

我发现的关于这个问题的唯一信息是[issue 5527](http://bugs.python.org/issue5527)，其中指出问题在于`tkinter`在进程分叉之前被导入，它可以通过`tkinter`在函数内部导入来修复`f`，并且问题发生在 Linux 但不是索拉里斯。

有谁知道究竟是什么导致了这个问题，如果它是故意的还是最终会得到解决？`tkinter`除了在我需要的任何地方本地导入（这看起来很糟糕）之外，还有其他解决方法吗？其他模块是否有类似的多处理问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T19:01:50.510

截至 2013 年 9 月，错误报告中有一些额外的评论，可以更深入地了解实际问题是什么。

[http://bugs.python.org/issue5527#msg194848](http://bugs.python.org/issue5527#msg194848)
[http://bugs.python.org/issue5527#msg195480](http://bugs.python.org/issue5527#msg195480)

基于上述情况，我猜测正在发生以下情况： Tkinter 不是线程安全的，因此（无论出于何种原因）Tkinter 想知道哪个线程是主线程。Tkinter 假设加载 Tkinter 模块时的主线程也将是程序执行的主线程。当你在加载 Tkinter 后 fork 或 multiprocess 时，这个假设就被打破了。（例如，在 fork 之后，记住的主线程在父线程中，而不是子线程中。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:08:40.290

我怀疑问题与与 X 服务器的连接（通常是套接字）有关。如果这是在进程被`fork()`-ed 之前创建的，则子进程继承此连接。但是如果它试图使用它，X 服务器就会变得混乱。

粗略查看后`Tkinter.py`，看起来`NoDefaultRoot`在开始进程之前调用该函数*可能*很有用。这完全取决于连接到 X 服务器的时间*。*

否则，在分叉之后导入 Tkinter 似乎是可行的方法。

# git - Git：忽略跟踪的文件

> ID：10755655
> 
> 赞同：240
> 
> 时间：2012-05-25T13:54:57.553
> 
> 标签：git

我在存储库中有一些跟踪文件，这些文件在构建代码时会自动修改。我不想取消跟踪它们，我只是不希望它们显示为已修改，并且我不希望它们在我 git add 时上演。

这可能吗？

* * *

## 回答 #1

> 赞同：365
> 
> 时间：2012-05-25T13:57:52.607

当然。

```
git update-index --assume-unchanged [<file> ...] 
```

要撤消并重新开始跟踪：

```
git update-index --no-assume-unchanged [<file> ...] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-01-30T16:55:44.983

另一种方法（来自 Seth Robertson 现在已删除的答案，但我发现它很有帮助，因此将其复活）是维护一个“跟踪”模板文件，然后拥有它的本地未跟踪版本，例如：“config.sample.ini”或“ config.ini.template”参见[https://gist.github.com/canton7/1423106](https://gist.github.com/canton7/1423106)获取完整示例。

如果文件在 git 等中发生更改，则不会有任何问题，您可以在本地未跟踪文件上使用 .gitignore （最终）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-05T11:22:19.013

在过滤器命令中使用 git 属性和 %f 的另一种解决方案：

```
git config filter.orig.clean "cat %f.orig"
cp filename filename.orig
echo "filename filter=orig" >> .git/info/attributes
echo "filename.orig" >> .git/info/exclude 
```

# python - 从类（非类成员）范围访问类对象内置值

> ID：10755667
> 
> 赞同：0
> 
> 时间：2012-05-25T13:55:33.403
> 
> 标签：python, class

如何从顶级类范围内访问类值？我的意思是，您如何执行以下操作：

```
class FooClass(object):
    zeroith_base = __bases__[0]
    .
    .
    . 
```

在这种情况下，我特别想做的是派生所有基类的元类以动态生成一个元类，该元类对所有基类的元类进行子类化，以解决元类冲突问题。我找到了[http://code.activestate.com/recipes/204197-solving-the-metaclass-conflict/](http://code.activestate.com/recipes/204197-solving-the-metaclass-conflict/)，虽然所有的概念对我来说都有意义，但食谱的实际代码超出了我的理解能力。我不想使用我无法理解的代码，所以相反，我尝试实现我自己的、更基本的系统，但我被困在第一阶段，试图在创建过程中检查类对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:02:10.657

你会发现它`__bases__`不是类命名空间的一部分。类命名空间作为第三个参数传递给元类；基数作为*第二个*参数传递。在创建类之前，它们是完全分开的。

所以你需要做的是编写一个合成你想要的元类的元类，然后使用它来创建类。我不知道这是否真的有效，但我看不出有什么理由不这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:31:01.157

您无法在创建类之前对其进行检查，并且在语句套件或类主体完成执行之前尚未创建它。您第一次访问此信息将是在`MetaClass.__new__`创建相关类的类的方法中，或在创建相关类的事物的执行中，从技术上讲，它们根本不需要是元类或类（如下例所示）。

这是一个非常粗略的原型，它可能不适用于所有情况，但适用于简单的情况，并且可能比配方更容易遵循。

```
def meta_class_synthesize(name, bases, attrmap):
    seen = set()
    seen_add = seen.add
    metas = [type(base) for base in bases]
    metas = tuple([
        meta for meta in metas
        if meta is not type and meta not in seen and not seen_add(meta)])
    if not metas:
        return type(name, bases, attrmap)
    elif len(metas) == 1:
        return metas[0](name, bases, attrmap)
    newmeta_name = "__".join(meta.__name__ for meta in metas)
    newmeta = type(newmeta_name, metas, {})
    return newmeta(name, bases, attrmap)

class M_A(type):
    pass

class M_B(type):
    pass

class A:
    __metaclass__ = M_A

class B:
    __metaclass__ = M_B

class C(A, B):
    __metaclass__ = meta_class_synthesize

print type(C)  # prints "<class '__main__.M_A__M_B'>" 
```

# r - 使用 data.table 时在 := 赋值中按编号引用列

> ID：10755669
> 
> 赞同：1
> 
> 时间：2012-05-25T13:55:52.640
> 
> 标签：r, data.table

根据[R 中的逐行矩阵运算，](https://stackoverflow.com/questions/9564588/row-wise-matrix-operations-in-r)我想在我拥有的 data.table 上应用逐行函数。我希望每行计算该行中许多列的平均值。我目前的尝试是：

```
columns <- c(1,5,10,15,20) # Actually obtained via grep
my.data.table[,"average" := mean(columns),with=FALSE] # Or...
my.data.table[,average := mean(columns)] 
```

不幸的是，这只是返回“列”向量的平均值，而不是它们所引用的列的平均值。有没有办法按数字引用这些列？

这是我想要达到的平均值：

```
key  a b c average
A    5 5 5 5
B    1 2 3 2
C    2 4 9 5 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T16:06:06.570

另一种选择是构建您真正想要执行的调用，然后`eval()`在`DT[]`. 这是 data.table FAQ 的第 1.5 和 1.6 节中描述的策略（通过键入查看`vignette("datatable-faq")`）。

这种方法的运行速度比涉及`rowMeans()`. （这种差异是由于`rowMeans()`“将 data.frames 转换为矩阵的初始耗时，正如 Matthew Dowle 在下面的评论中指出的那样。）

```
## Prepare data
library(data.table)
N <- 1000000
DT <- data.table(ID = 1:N,
                 Year1 = rnorm(N),
                 Year2 = rnorm(N),
                 Year3 = rnorm(N),
                 Year4 = rnorm(N))    
x <- c(2, 3, 4, 5)

## Construct the desired expression:   (Year1 + Year2 + Year3 + Year4)/4
addCols <- paste(names(DT)[x], collapse = " + ")
e <- paste("(", addCols, ")/", length(x), sep="")
e <- parse(text=e)[[1]]

## Compare timings
system.time(x2 <- DT[,eval(e)])
#    user  system elapsed 
#    0.11    0.00    0.11 
system.time(x1 <- rowMeans(DT[, ..x]))
#    user  system elapsed 
#    0.53    0.14    0.77 

## Check results
# all.equal(x1,x2)
# [1] TRUE 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T14:36:12.510

这里有两种可能的解决方案。它们基本上都来自您已经提供的链接，所以也许我错过了这个问题的一些东西。开始了：

解决方案 1（使用`rowMeans`）：

```
library(data.table)
N <- 1000000
my.data.table <- data.table(ID = 1:N,
                            Year1 = rnorm(N),
                            Year2 = rnorm(N),
                            Year3 = rnorm(N),
                            Year4 = rnorm(N))

x <- c(2, 3, 4, 5)
system.time(x1 <- rowMeans(my.data.table[, ..x]))
   user  system elapsed 
   0.08    0.00    0.08 
```

解决方案2：首先将其转换为长格式。我认为这更快，主要是因为马修在另一个问题中的评论说这`data.table`是针对`DT[,mad(variable),by=group]`语法的。我想我错过了一些东西，但看不到什么：

```
library(reshape2)
DT <- as.data.table(melt(as.data.frame(my.data.table), id.var="ID"))
setkey(DT, ID)
system.time(x2 <- DT[, mean(value), by="ID"][[2]])
   user  system elapsed 
  11.28    0.00   11.33 
all.equal(x1, x2)
[1] TRUE 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T14:02:45.630

好吧，再来一次……

这样可以吗

```
x<-1:5
y<-1:5
z<-1:5
xy<-data.table(x,y,z)
id<-c("x","y")
newxy<-rowMeans(xy[, id, with=FALSE]) 
```

# php - 使用 PHP 发送电子邮件失败

> ID：10755673
> 
> 赞同：0
> 
> 时间：2012-05-25T13:55:58.397
> 
> 标签：php, email, spf

**情况：** 我们的客户（domain.com 的所有者）已将 www.domain.com 的 A 记录设置为我们在 domain.com 后面运行网站的其中一台服务器的 IP 地址。我们只为这个域提供托管，他们有自己的电子邮件服务器。

这意味着 domain.com 的 IP 不是 domain.com 的邮件服务器。

**问题：** 从 PHP 向 foo@bar.com 发送邮件可以工作，但是向 *@domain.com 发送邮件不起作用。

**问题：** 这是否与 SPF 记录有关？我该如何解决这个问题？

谢谢

邦迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T07:12:26.977

这发生在我的共享主机上，可能是因为网络服务器上存在本地传递机制，即当您的网络服务器看到@domain.com 的电子邮件时，它假定它将是处理的，并且不会传递到实际的邮件服务器。

进入您的网络服务器的面板（Cpanel 或其他）并检查该域的电子邮件设置。确保对 domain.com 禁用“本地交付”或类似功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:02:51.950

您的主要 domain.com（没有 www.）是否有 CNAME 记录？这将自动将域的 mx 记录引用到 cname 记录。

> MX 记录的特征负载信息是邮件主机的完全限定域名和首选项值。主机名必须直接映射到 DNS 中的一个或多个地址记录（A 或 AAAA），并且不得指向任何 CNAME 记录。

[http://en.wikipedia.org/wiki/MX_record#cite_note-0](http://en.wikipedia.org/wiki/MX_record#cite_note-0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:56:34.360

发送电子邮件的最佳方式是使用 smtp 方法：

[http://sourceforge.net/projects/phpmailer/files/phpmailer%20for%20php4/0.90/](http://sourceforge.net/projects/phpmailer/files/phpmailer%20for%20php4/0.90/)

示例文件：

```
<?php
require("class.phpmailer.php");

$mail = new PHPMailer();

$mail->IsSMTP();                                      // set mailer to use SMTP
$mail->Host = "mail.example.net";  // specify main and backup server
$mail->SMTPAuth = true;     // turn on SMTP authentication
$mail->Username = "user@example.net";  // SMTP username
$mail->Password = "password"; // SMTP password

$mail->From = "example@example.net";
$mail->FromName = "Mailer";
$mail->AddAddress("destiny@example.net");

//$mail->AddReplyTo("info@example.com", "Information");

$mail->WordWrap = 50;                                 // set word wrap to 50 characters
//$mail->AddAttachment("/var/tmp/file.tar.gz");         // add attachments
//$mail->AddAttachment("/tmp/image.jpg", "new.jpg");    // optional name
$mail->IsHTML(true);                                  // set email format to HTML

$mail->Subject = "Here is the subject";
$mail->Body    = "This is the HTML message body <b>in bold!</b>";
$mail->AltBody = "This is the body in plain text for non-HTML mail clients";

if(!$mail->Send())
{
    echo "Message could not be sent. <p>";
    echo "Mailer Error: " . $mail->ErrorInfo;
    exit;
}

echo "Message has been sent";
?> 
```

# c# - 如何将值添加到列表 目的

> ID：10755674
> 
> 赞同：1
> 
> 时间：2012-05-25T13:55:58.897
> 
> 标签：c#, asp.net

我有一个`List<ValuePair>`对象：`listUserRoleValuePair`。我必须在 foreach 循环的列表中添加`ixUser`和`name`作为我的值对。我怎样才能添加这个？

```
List<ValuePair> listUserRoleValuePair = new List<ValuePair>();
var ixUserList= _mapper1.FindUserRoleLike(sName);
User result = null;

foreach (var ixUser in ixUserList)
{
    result = new UserMapper(connection).FindById(ixUser);
    var name = result.SFirstName + " " + result.SLastName;

    //listUserRoleValuePair.Add(ixUser);
    // listUserRoleValuePair.Add(    
} 
```

我的 ValuePair 课程如下

```
public class ValuePair
{
    private string _index;
    private string _sName;

    public ValuePair(string index, string sName)
    {
        _index = index;
        _sName = sName;
    }

    public string Index
    {
        get { return _index; }
        set { _index = value; }
    }

    public string SName
    {
        get { return _sName; }
        set { _sName = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:01:44.167

您可以使用 KeyValuePair 类：

```
List<KeyValuePair<string,string>> listUserRoleValuePair = new List<KeyValuePair<string,string>>(); 
```

接着：

```
listUserRoleValuePair.Add(new KeyValuePair<string,string>(name, ixUser); 
```

您也可以使用字典而不是列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:58:47.640

在您的情况下，您只能添加支持子对象类型的项目，您可以使用其中之一。

```
collection.Add(new ValuePair(index, Name))

or
collection.Add(new ValuePair(){Index = index,SName= Name}); 
```

或非常简单的创建对象并传递为

```
Valuepair valpair = new ValuePair();
valpair.Index = index;
valpair.SName = name;

collection.Add(valpair); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T14:04:09.117

```
listUserRoleValuePair.Add(new ValuePair(index, name)); 
```

我不清楚你的对象的索引值是什么，但不管它是什么，只需在上面的行中替换它

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-25T14:03:27.523

如果 ixUser 是索引字符串，请使用以下代码：

```
List<ValuePair> listUserRoleValuePair = new List<ValuePair>();
var ixUserList= _mapper1.FindUserRoleLike(sName);
User result = null;

foreach (var ixUser in ixUserList)
{
    result = new UserMapper(connection).FindById(ixUser);
    var name = result.SFirstName + " " + result.SLastName;
    listUserRoleValuePair.Add(new ValuePair(ixUser, name));
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-25T14:03:59.100

```
listUserRoleValuePair.Add(new ValuePair(ixUser, name)); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-25T14:03:16.550

尝试这个

```
var pair = new ValuePair();
// somehow intialize pair
listUserRoleValuePair.Add(pair); 
```

# elisp - Emacs 口齿不清；如何从任何类型的变量中创建一个字符串？

> ID：10755677
> 
> 赞同：5
> 
> 时间：2012-05-25T13:56:10.287
> 
> 标签：elisp

就像错误调用函数的错误消息一样，例如：

```
(message (file-attributes ".")) 
```

产生消息：

```
"eval: Wrong type argument: stringp, ("/home14/tjones" 1 0 0 (20415 35598) (20211 19255) (20211 19255) 14 "lrwxrwxrwx" t ...)" 
```

您如何故意进行此类翻译，例如：

```
(message (thing-to-string (file-attributes "."))) 
```

要发送消息，例如：

```
("/home14/tjones" 1 0 0 (20415 35598) (20211 19255) (20211 19255) 14 "lrwxrwxrwx" t ...) 
```

这仅用于调试/信息。我假设有一种方法作为消息正在这样做，但这会暴露给我们用户吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T14:38:32.733

查看`prin1-to-string`相关功能（`prin1`,`princ`等）。并尝试手册！[http://www.gnu.org/software/emacs/manual/html_node/elisp/Output-Functions.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Output-Functions.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-26T13:40:30.653

在您的示例中，`message`没有做任何事情（它只是拒绝运行），因此对字符串的翻译是由 read-eval-print 循环完成的，该循环捕获了错误并将其转换为文本消息。但是，是的，`message`也可以这样做，它通过调用 来做到这一点，它在`format`内部使用诸如`prin1-to-string`. 所以`(format "%S" <foo>)`会做你的事情到字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-02T22:53:48.077

的第一个参数`message`应该是一个格式字符串（与传递给`format`函数的那个​​相同。如果你给它格式“%s”（或[Stefan 的回答中的“%S”。](https://stackoverflow.com/a/10766741/35881)）它将把你给的任何东西都串起来它作为下一个论点。

大写的 S 版本将转义字符串中的字符，以便可以再次将其作为 s 表达式读取。在这种情况下，我认为这就是你想要的。因此，您无需对代码进行太多更改即可获得所需的内容：

```
(message "%S" (file-attributes ".")) 
```

# xml - Windows Phone 7 列表框未更新

> ID：10755683
> 
> 赞同：0
> 
> 时间：2012-05-25T13:56:40.627
> 
> 标签：xml, windows-phone-7, listbox

我正在从互联网上提取一个 XML 文件并将其加载到手机上。一切正常，减去列表框在应用程序初始加载时未更新。

应用程序的简单路径如下：

在应用程序加载时，如果它已连接到 Internet，它会运行更新联系人方法。如果不是，它会检查它是否是第一次加载，如果是，它会在运行应用程序之前通知用户连接到移动或无线网络，否则它会加载旧数据。

在 update 方法中，它检查 web 服务以查看自上次更新以来是否有任何更新。如果它是第一次加载，它说已经有 2000 次更新，强制更新。如果更新次数大于零，它会运行下载然后加载数据（这是这里的问题），否则它会加载旧数据（当前数据）。

问题是下载后，它不会加载数据。这是所述项目的代码。

获取数据函数：

```
private void getData()
        {
            try
            {
                using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
                {
                    IsolatedStorageFileStream isoFileStream = myIsolatedStorage.OpenFile("contacts.xml", FileMode.Open);
                    using (StreamReader reader = new StreamReader(isoFileStream))
                    {
                        XElement xmlContact = XElement.Parse(reader.ReadToEnd());
                        lstContacts.ItemsSource = from contact in xmlContact.Descendants("contact")
                                                               select new ContactItem
                                                               {
                                                                   ImageSource = contact.Element("Image").Value,
                                                                   FName = contact.Element("FName").Value,
                                                                   LName = contact.Element("LName").Value,
                                                                   Extension = contact.Element("Extension").Value,
                                                                   Email = contact.Element("Email").Value,
                                                                   Cell = contact.Element("Cell").Value,
                                                                   Title = contact.Element("TitleName").Value,
                                                                   Dept = contact.Element("deptName").Value,
                                                                   Office = contact.Element("officename").Value,
                                                                   ID = contact.Element("ID").Value
                                                               };
                    }
                }
            }
            catch
            {
            }
        } 
```

更新功能：

```
void contact_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
        {
            if (e.Error != null)
            {
                return;
            }

            XElement xmlContact = XElement.Parse(e.Result);
            string updates = xmlContact.Element("updates").Element("number").Value;
            if (firstrun)
            {
                updates = "2000";
                settings["firstRun"] = (bool)false;
            }
            MessageBox.Show(updates);
            if (Convert.ToInt32(updates) > 0)
            {
                MessageBox.Show("Updating Contacts");
                ContactReader cr = new ContactReader("http://domain.tld/RLContactApp/getContactsWP7.php?sqlQueryType=C&lastUpdated=01%2F01%2F2000&format=xml", "contacts.xml");
                bool downloaded = cr.Download();
                if (downloaded)
                {
                    getData();
                }
            }
            else
            {
                MessageBox.Show("Not Updating Contacts");
                getData();
            }

        } 
```

我正在寻找一种方法来让数据加载到列表框中，而不告诉用户关闭应用程序并重新加载它。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:07:12.023

最后使用 .toList() 将您的 linq 查询转换为结果

```
 lstContacts.ItemsSource = (from contact in xmlContact.Descendants("contact")
                                                               select new ContactItem
                                                               {
                                                                   ImageSource = contact.Element("Image").Value,
                                                                   FName = contact.Element("FName").Value,
                                                                   LName = contact.Element("LName").Value,
                                                                   Extension = contact.Element("Extension").Value,
                                                                   Email = contact.Element("Email").Value,
                                                                   Cell = contact.Element("Cell").Value,
                                                                   Title = contact.Element("TitleName").Value,
                                                                   Dept = contact.Element("deptName").Value,
                                                                   Office = contact.Element("officename").Value,
                                                                   ID = contact.Element("ID").Value
                                                               }).ToList<ContactItem>(); 
```

现在这将执行查询并返回列表，这将能够绑定数据。

试试这个 (query }).ToList();

# database-design - 数据库设计 - 写一些关于现有用户或不现有用户或一般的东西

> ID：10755684
> 
> 赞同：0
> 
> 时间：2012-05-25T13:56:48.243
> 
> 标签：database-design

我正在开发一个与母亲有关的网站。任何人都可以在网站上注册并**可以写关于他的母亲或关于母亲的一般评论**

1）母亲也可以是用户的一部分（注册用户表）

2）如果注册用户表中不存在她，则用户必须写下他母亲的名字

3) 和他妈妈无关，写一些关于妈妈的泛泛话题

**用户表：-**

```
 `user_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_name` varchar(25) CHARACTER SET latin1 NOT NULL,
  `surname` varchar(30) CHARACTER SET latin1 NOT NULL,
  `name` varchar(30) CHARACTER SET latin1 NOT NULL, 
```

**关于母亲表（第一种情况）：-**

```
 `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `mother_id` int(10) unsigned NOT NULL,  ( user_id of the above table)
  `subject` varchar(150) NOT NULL,
  `details` text NOT NULL, 
```

上表处理系统中是否存在母亲

**关于母亲表（第 2 例）：-**

```
 `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `mother_name` varchar(50) unsigned NOT NULL,  
  `subject` varchar(150) NOT NULL,
  `details` text NOT NULL, 
```

上表处理系统中不存在母亲的情况

**关于母亲表（第三种情况）：-**

```
 `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `subject` varchar(150) NOT NULL,
  `details` text NOT NULL, 
```

上表处理的是关于母亲的通用性

**现在显示母亲的不同名单（首先是最近的，而不是关于母亲的详细信息）**

我必须将第一个母亲表与用户表加入以获取名称，并且必须与第二个母亲表联合并按日期降序。

**如果我必须显示有关母亲的详细信息**

我有三个按日期降序的表

一些我认为我使这变得复杂的方式。

如果我将三个表合并为一个表，则 ID 将为不存在的 Null，如果它是通用注释，则 ID 和 Mother's name 将为空。有人能给我最好的设计方法吗？

谢谢你

问候

基兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:33:26.067

由于母亲也可以是用户，并且假设每个孩子最多可以写一条关于他们母亲的评论，看起来你需要这样的东西：

![在此处输入图像描述](../Images/169ae21983abee8c31fba92a8e04980f.png)

您需要限制某些字段的 NULLability，以确保如果一个人有母亲，则该人是注册用户（有用户名）并且存在主题和描述：

```
CHECK (
    (MOTHER_ID IS NULL AND MOTHER_SUBJECT IS NULL AND MOTHER_DETAILS IS NULL)
    OR (USER_NAME IS NOT NULL AND MOTHER_ID IS NOT NULL AND MOTHER_SUBJECT IS NOT NULL AND MOTHER_DETAILS IS NOT NULL)
) 
```

要获得所有同时也是母亲的人，您可以执行以下操作：

```
SELECT *
FROM PERSON T1
WHERE EXISTS (
    SELECT *
    FROM PERSON T2
    WHERE T1.PERSON_ID = T2.MOTHER_ID
) 
```

用简单的英语：选择那些至少是一个人的母亲的人。

您需要 MOTHER_ID 上的索引以优化执行此查询（某些数据库会自动在外键上创建索引）。

### - - 编辑 - -

如果用户可以写很多关于母亲的记忆，设计可能是这样的：

![在此处输入图像描述](../Images/e6144af68dbd0443e4025d08e8b739bd.png)

不幸的是，这确实允许非用户写入内存的情况。如果您绝对必须避免这种情况，请使用可以使用 NULL-able UNIQUE 约束作为外键的父端点的数据库，并使用 USER_NAME 而不是 PERSON_ID 来连接表，或者如果您不介意一些复杂性，请执行这个：

![在此处输入图像描述](../Images/11de6630fd76abb85585d824ee5d6931.png)

符号：![在此处输入图像描述](../Images/99a5e7f02cdf3bac5703451848b16524.png)表示类别（又名继承、泛化层次结构等），但在这个特定模型中有一个转折点：一个 PERSON 既可以是 USER 又可以是 MOTHER（即，这就是所谓的“非歧视”类别）。

# java - 如何在java中更改JTable中单个单元格的背景颜色？

> ID：10755685
> 
> 赞同：1
> 
> 时间：2012-05-25T13:56:53.907
> 
> 标签：java, swing, jtable, tablecellrenderer

我在表格中搜索，当我找到匹配项时，我想更改该单元格的背景颜色。我做了如下但仍然无法修复它？任何机构都可以帮助解决这个问题吗？

```
public class SearchTable extends JTable {
JTable table;
JTextField textField;

public SearchTable(JTable table, JTextField textField) {
    this.table = table;
    this.textField = textField;

    textField.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            search();
        }
    });

    textField.getDocument().addDocumentListener(new DocumentListener() {
        public void insertUpdate(DocumentEvent e) {
            search();
        }
        public void removeUpdate(DocumentEvent e) {
            search();
        }
        public void changedUpdate(DocumentEvent e) {
            search();
        }
    });
}

private void search() {
    String target = textField.getText();
    for (int row = 0; row < table.getRowCount(); row++)
        for (int col = 0; col < table.getColumnCount(); col++) {
            String next = (String) table.getValueAt(row, col);
            if (next.equals(target)) {
                changeBackgroundColor(row, col);
                return;
            }
        }
    table.repaint();
}

private void changeBackgroundColor(int row, int col) {
    table.setColumnSelectionAllowed(true);
    table.setRowSelectionAllowed(true);
    boolean toggle = false;
    boolean extend = false;
    table.changeSelection(row, col, toggle, extend);
    //first atempt sets bg color for all cells, it is not OK
    //table.setSelectionBackground(Color.green);

    //second atempt getting no result
    table.getCellEditor(row,col).getTableCellEditorComponent(table,table.getValueAt(row,col),true,row,col).setForeground(Color.red);

    //3th atempt getting no result
    //Component c = table.getCellRenderer(row, col).getTableCellRendererComponent(table, table.getValueAt(row, col), true, true, row, col);
    //c.setForeground(Color.red);

    //4th atempt getting no result
    //DefaultTableCellRenderer renderer = (DefaultTableCellRenderer) table.getCellRenderer(row, col).getTableCellRendererComponent(table, table.getValueAt(row, col), true, true, row, col).;
      //renderer.setBorder(new LineBorder(Color.red));
}

   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:02:42.060

你可以使用`XxxCellRenderer`，更好和最简单的是使用`prepareRenderer()`

要获得正确的代码，您必须在 if-else 中覆盖或测试以下参数

*   被选中

*   有焦点

*   柱子

*   排

请检查关于类似问题的[答案](https://stackoverflow.com/search?q=user:714968%20%5Bjava%5D%20prepareRenderer&submit=search)和一个[问题](https://stackoverflow.com/questions/7132400/jtable-row-hightlighter-based-on-value-from-tablecell)，有两种简单的方法，对不起，我在 FRI 交通中，brrrrr

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:33:18.253

您需要先将单元格渲染器设置为列 -

```
col.setCellRenderer( new TableCellRenderer() {
public Component getTableCellRendererComponent( JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column ) 
                {
                    Component cell = centerRenderer.getTableCellRendererComponent( table, value, isSelected, hasFocus, row, column );
    cell.setForeground(Color.green);
}
}); 
```

# iphone - 从 iPhone/iPod 与 Windows 通信

> ID：10755688
> 
> 赞同：0
> 
> 时间：2012-05-25T13:57:05.357
> 
> 标签：iphone, ios, networking, service, ipod

我正在寻找一个需要在 iPhone/iPod 和在 Windows 上运行的服务之间来回发送/接收数据的 iOS 应用程序。通信方面，我将使用套接字。

*   手机将向/从 Windows 服务（不是 Web 服务）发送/接收数据
*   套接字将用作通信手段
*   iPhone/iPod 将使用静态 IP 地址连接到 WiFi
*   iPhone/iPod 旨在成为尽可能瘦的客户端

目的是让 Windows 服务侦听来自 iPhone/iPod 的事件。例子：

输入需要从 UITextField 获取并通过按下按钮保存为字符串。在按下按钮时，必须触发一个事件并通过 WiFi 发送到 Windows 服务，然后 Windows 服务将接收该事件，执行“服务器端”操作，并将响应发送回 iPhone/iPod。

我对 iOS 开发还是很陌生，我知道这是一些更高级的东西，但是任何有助于实现这一点的帮助或资源，我都会很感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:04:50.377

这是与您使用的平台无关的标准网络内容。在 iOS 上，您可以执行以下任一操作：

1）使用berkley套接字（标准的unix东西）。2) 使用 Cocoa 包装器进行套接字（NSSocketPort 等）。3）使用一个框架，如 MKNetworkKit（[这里](http://blog.mugunthkumar.com/ios-components/mknetworkkit/)）。

我自己会使用选项 3 :)

对您有利的一件事是 Windows 机器和 iPad 都是 little-endian，因此您不必担心字节交换（如果您只是发送字符串，则无论如何都不会担心）。

编辑：要让 Windows 发现您的设备，您需要使用 IP 地址详细信息进行配置设置，或者使用 Apple 的 bonjour 服务或一些自定义解决方案。

# regex - 无法使用 sed 正则表达式删除空行

> ID：10755692
> 
> 赞同：3
> 
> 时间：2012-05-25T13:57:15.417
> 
> 标签：regex, sed, linefeed

我有一个这样的文件：

```
2733617     3.00    3   3

2733617 E1b1    8.00    8   16
2733617 E1b1b1b 2.00    2   4

2733617 I1  294.00  296 590
2733617 I2  1.00    1   2

2733617 I2a1    2.00    2   4 
```

`sed '/^$/d'`对我不起作用。Outfile 看起来就像 infile。它应该删除空行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T11:22:30.063

不幸的是，手册说使用范围 like`[!-~]`是不安全的。但是，最终只打印包含可打印字符的行`:print:`对我有用：

```
sed -n '/[[:print:]]/p' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-24T22:41:29.147

删除空行：

```
sed '/^[[:space:]]*$/d' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-04T17:15:30.210

由于“空白”行中似乎存在未知的不可打印字符，您可以重新编写 sed 命令以仅显示其中包含可打印字符的行：

```
sed -n '/[!-~]/p' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:01:21.280

你也可以试试：

```
 sed -n '/^./p' 
```

它只打印行首至少有一个字符的行。（顺便说一句`sed '/^$/d'`对我有用）

# installation - 如何使用 NSIS 以管理员身份打开文件

> ID：10755694
> 
> 赞同：1
> 
> 时间：2012-05-25T13:57:18.957
> 
> 标签：installation, admin, nsis

我正在使用安装程序脚本 nsis 打开一个文件，我需要以管理员身份打开它才能正常运行，但我似乎无法弄清楚如何执行此操作。

目前我的开放代码如下所示：

```
FileOpen $4 "$R0" w
FileRead $4 $1
FileClose $4 
```

它打开它，但作为普通用户，我需要它作为管理员。有没有办法做到这一点？？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T20:11:26.767

您无法在普通应用程序中以其他用户身份打开文件。如果您需要这种电源，整个安装程序可能需要[运行提升](https://stackoverflow.com/a/8735349/3501)：

```
Outfile RequireAdmin.exe
RequestExecutionLevel admin ;Require admin rights on NT6+ (When UAC is turned on)

!include LogicLib.nsh

Function .onInit
UserInfo::GetAccountType
pop $0
${If} $0 != "admin" ;Require admin rights on NT4+
    MessageBox mb_iconstop "Administrator rights required!"
    SetErrorLevel 740 ;ERROR_ELEVATION_REQUIRED
    Quit
${EndIf}
FunctionEnd

Page InstFile

Section
SectionEnd 
```

# php - cURL 和 Facebook 问题

> ID：10755695
> 
> 赞同：0
> 
> 时间：2012-05-25T13:57:19.487
> 
> 标签：php, facebook, curl

我正在使用 cURL 访问 Facebook 页面。在本地它工作得很好，但是当我将它上传到我的开发服务器时，它会中断并返回一个空字符串。我已经检查并在服务器上安装了 cURL。这是我用来访问 facebook 的代码：

```
$header = array();
$header[] = 'Accept: text/json';
$header[] = 'Cache-Control: max-age=0';
$header[] = 'Connection: keep-alive';
$header[] = 'Keep-Alive: 300';
$header[] = 'Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7';
$header[] = 'Accept-Language: en-us,en;q=0.5';
$header[] = 'Pragma: ';

$ch = curl_init(); 

curl_setopt($ch, CURLOPT_URL, 'http://facebook.com/feeds/page.php?format=json&id=135137236003');
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.11) Gecko/2009060215 Firefox/3.0.11 (.NET CLR 3.5.30729)');
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_AUTOREFERER, true); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_ENCODING, '');
curl_setopt($ch, CURLOPT_TIMEOUT, 20);

$result = curl_exec($ch);

curl_close ($ch); 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:18:39.853

将接受标头更改为`*/*`或`application/json`facebook 将响应标头发送为`application/json`.

并更改此网址

```
http://facebook.com/feeds/page.php?format=json&id=135137236003 
```

到

```
http://www.facebook.com/feeds/page.php?format=json&id=135137236003 
```

由于 facebook 将非 www 请求重定向到 www 请求。虽然它适用于您作为放置跟随位置，但它可以节省一次往返行程

# facebook - 重新加载后 Facebook 签名请求为空

> ID：10755696
> 
> 赞同：4
> 
> 时间：2012-05-25T13:57:24.077
> 
> 标签：facebook, facebook-like, facebook-apps

我的 Facebook 应用程序上的签名请求有问题。第一次很好，我知道用户是否喜欢我的应用程序。但是当我重新加载应用程序（链接、表单等）时，我失去了签名请求，（仅刷新 [F5]，并且不像工作）..

我真的不明白为什么？？

*链接不再起作用:(*

*   这是我的测试页面：[https ://www.facebook.com/pages/TestCactOos/255835411190164](https://www.facebook.com/pages/TestCactOos/255835411190164)
*   和测试应用程序：[https ://www.facebook.com/pages/TestCactOos/255835411190164?sk=app_335457189856398](https://www.facebook.com/pages/TestCactOos/255835411190164?sk=app_335457189856398)

在应用程序上，您可以看到 $facebook、$_REQUEST 和 $_SERVER 信息。

感谢大家的时间和帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:40:25.163

签名的请求位于 Facebook 推荐的标头中。它不会从链接到链接进行维护，因为后续推荐将来自您自己的页面。使用 signed_request 获取一些信息并将其保留在页面之间的会话中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:23:24.823

您只能获得一次签名请求。这正是 Facebook 在 iframe 中加载您的应用程序的时候。然后您必须保存 signed_request 以供进一步使用（子页面）。在那里，您必须通过 $_REQUEST 检查数据或回退到您存储的 signed_request 值。这是 fbHelper 组件的一个小示例。我希望这能给你一些如何处理这个问题的想法：

来源： http: [//www.facebook.com/HelperComponentlCommunity/app_412923142052609](http://www.facebook.com/HelperComponentlCommunity/app_412923142052609)

```
 if(array_key_exists('signed_request', $_REQUEST))
        $signed_request = $_REQUEST['signed_request'];
    elseif(array_key_exists('signed_request' . $this->pageId, $_SESSION))
        $signed_request = $_SESSION['signed_request' . $this->pageId];
    else
        return false;

    $facebook_data= $this->parse_signed_request($signed_request); 
```

# mysql - 选择不同的地方，速度如此之慢

> ID：10755697
> 
> 赞同：0
> 
> 时间：2012-05-25T13:57:28.993
> 
> 标签：mysql, sql

```
table1
row_id      row_one     row_two
1           1           5
2           1           5
3           2           5
4           2           5
5           2           6

table2
row2_id     row2_one    row2_two
1           1           somevalue
2           2           somevalue2

"select distinct row_one from table1 where row_two=5" 
```

结果

```
row_one
1
2 
```

之后我要选择

```
select * from table2 where row2_one=1
select * from table2 where row2_one=2 
```

我想用一个查询进行选择。我正在尝试这个查询

```
 select * from table2 where row2_one in (select distinct row_one from table1 where  
          row_two where row_two=5) 
```

但花了 8s `Showing rows 0 - 14 ( 15 total, Query took 8.3255 sec)`

为什么这么慢。我想更快地选择。请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:06:10.343

你不需要`DISTINCT`那里。你可以这样做：

```
SELECT * 
FROM table2 
WHERE row2_one IN (SELECT row_one FROM table1 WHERE row_two=5) 
```

并且使用`EXISTS`可能会更快：

```
SELECT * 
FROM table2 A
WHERE EXISTS  (SELECT * FROM table1 WHERE row_two=5 AND row_one = A.row2_one) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:08:01.880

假设这是您的查询：

```
select *
from table2 where row2_one in (select distinct row_one from table1 where row_two=5) 
```

那么这是格式良好的。一件事，您不需要子查询中的 distinct 。

如果在 row_two 列上为 table1 添加索引，应该会获得更好的性能。table2 中 row2_one 的索引也会加快速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:05:22.787

让我补充一下下面所说的 - 使用[GROUP BY](http://readvitamin.com/2007/10/18/using-%E2%80%9Cgroup-by%E2%80%9D-instead-of-%E2%80%9Cdistinct%E2%80%9D-clause/)或[EXISTS](http://www.zimbio.com/member/vijaya_krishna_birju/articles/M0M0UJrtZab/Use+EXISTS+instead+DISTINCT+improve+Query)而不是 DISTINCT 它可以真正提高你的表现。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-25T14:06:22.730

```
Select distinct table2.* 
from table1 t1, table2 t2 
where t1.row_two =5 and t1.row2_one = t2.row2_one 
```

# exception - 如何在 PowerShell 中配置调用深度？

> ID：10755699
> 
> 赞同：4
> 
> 时间：2012-05-25T13:57:34.543
> 
> 标签：exception, powershell, recursion

我只是在 PowerShell 中尝试，并在某些测试递归函数中收到关于*调用深度*设置为 1000 的错误。我在网上查找了一些资料，发现这是由于 PowerShell 中的错误处理造成的（如果我没记错的话）：

> 递归深度限制在版本 1 中已修复。由于处理异常的方式，深度递归在 64 位模式下会导致问题。它导致级联的内存不足错误。最终结果是我们硬限制了所有平台上的递归深度，以帮助确保脚本可以移植到所有平台。- Bruce Payette，PowerShell 的联合设计师

我在[这里](http://weblogs.asp.net/jgalloway/archive/2011/12/15/working-around-a-powershell-call-depth-disaster-with-trampolines.aspx)找到了。

我还在 MSDN 上发现了这个异常页面，指出这个限制是可配置的（但我没有找到任何关于如何执行此操作的信息） - 请参阅[此处](http://msdn.microsoft.com/en-us/library/system.management.automation.scriptcalldepthexception(v=vs.85).aspx)的备注部分。

**如何设置此限制？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T15:16:22.430

*   在**PowerShell V1**中，最大调用深度为 100：

使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)`System.Management.ExecutionContext` ，我们可以从类代码中看到这个片段，

```
internal int IncrementScopeDepth()
{
    using (IDisposable disposable = tracer.TraceMethod("{0}", new object[] { this.scopeDepth }))
    {
        if (this.CurrentPipelineStopping)
        {
            throw new PipelineStoppedException();
        }
        this.scopeDepth++;
        if (this.scopeDepth > 100)
        {
            ScriptCallDepthException exceptionRecord = new
            ScriptCallDepthException(this.scopeDepth, 100);
            tracer.TraceException(exceptionRecord);
            throw exceptionRecord;
        }
        return this.scopeDepth;
    }
} 
```

无法修改***硬编码的 100***。

*   在**PowerShell V2**中，最大调用深度为 1000

再次查看代码时，似乎没有办法绕过默认的最大调用深度。

*   在**PowerShell V3 (CTP)**中，似乎没有最大调用深度（当然，除非您用完资源）。此行为已被[描述为](http://connect.microsoft.com/PowerShell/feedback/details/746032/v3-rc-hangs-on-deep-recursive-calls-with-not-predictable-recursion-depth)连接上的错误，因此它可能会在最终版本中更改。

# .net - 将字节数组复制到类实例的内存位置

> ID：10755702
> 
> 赞同：0
> 
> 时间：2012-05-25T13:57:51.203
> 
> 标签：.net, vb.net, arrays, data-structures

我正在尝试将字节数组复制到第三方库中的类中

```
 Dim usr As New RSI_USER_RECORD
    Dim ba(RSI_USER_RECORD.RSI_LEN_USER_REC - 1) As Byte
    'populate ba here
    usr = ba 'how can I do this? 
```

这甚至可能吗？

这是类的定义（来自Reflector）

```
Public Class RSI_USER_RECORD
    ' Methods
    Public Function Clone() As RSI_USER_RECORD
        Return New RSI_USER_RECORD With { _
            .pID = Me.pID.Clone, _
            .pTemplateVector = Me.pTemplateVector.Clone, _
            .authorityLevel = Me.authorityLevel, _
            .rejectThreshold = Me.rejectThreshold, _
            .timeZone = Me.timeZone _
        }
    End Function

    ' Fields
    Public authorityLevel As RSI_AUTHORITY_LEVEL = RSI_AUTHORITY_LEVEL.RSI_AUTHORITY_NONE
    Public pID As RSI_ID = New RSI_ID
    Public pTemplateVector As RSI_TEMPLATE = New RSI_TEMPLATE
    Public rejectThreshold As UInt16 = 0
    Public Const RSI_LEN_USER_REC As Integer ModOpt(IsConst) = &H10
    Public timeZone As Byte = 0
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:04:23.260

```
 Dim usr As  USER_RECORD() ' init the values
    Dim ba As  USER_RECORD() = New  USER_RECORD(usr.Length - 1) {}

    For i As Integer = 0 To usr.Length - 1
        ba(i) = usr(i) ' if USER_RECORD is value type
       'ba(i) = DirectCast( usr(i).Clone(), USER_RECORD) ' if USER_RECORD is reference type

    Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:59:51.973

字节数组中的每个数据都必须分配给其中一个属性。基本上你将不得不做类似的事情

```
authorityLevel = byte(someIndex)
pID = byte(someIndex)
pTemplateVector = byte(someIndex)
rejectThreshold = byte(someIndex)
timeZone =byte(someIndex) 
```

在您的代码中：

```
Dim usr As New RSI_USER_RECORD
Dim ba(RSI_USER_RECORD.RSI_LEN_USER_REC - 1) As Byte
'populate ba here
usr = ba 'how can I do this? 
```

您不能在对象中分配数组，但可以使用数组来初始化对象。喜欢

```
dim anInstance as new RSI_USER_RECORD(ba) 
```

并创建一个新的构造函数来完成这项工作。

# c# - 如何创建一个将其类型存储在 Type 变量中的类的实例？

> ID：10755711
> 
> 赞同：0
> 
> 时间：2012-05-25T13:58:23.840
> 
> 标签：c#, wpf

我想让 WPF UserControl 尽可能通用。我已经定义了一个所有用户控件都可以从中获取的基类。我希望能够通过为 UserControl 甚至基类指定类型参数来使其通用，但这似乎是不可能的。

作为一种解决方法，我正在尝试将 Type 设置为参数，例如：

```
public class UCBase : UserControl
{
    public virtual Type UCType { get; private set; }
    public virtual Type PanelType { get; private set; }

    internal void SetType<TVM, TPanel>() where TPanel : new()
    {
        UCType = typeof(TVM);
        PanelType = typeof(TPanel);

    }
} 
```

稍后，我需要创建一个`UCType`代表类的实例，特别是另一个知道如何处理我将要传递的 ViewModel 的用户控件。

```
 public ZonesAccordionPanel(List<ViewModelBase> vmItems)
    {
        InitializeComponent();

        foreach (var item in vmItems)
        {
            var exp = new Expander { Header = new ZoneReport(item) };
            exp.Resources.Add("item", item);
            exp.Expanded += exp_Expanded;

            accordion.Children.Add(exp);
        }

    }

    void exp_Expanded(object sender, RoutedEventArgs e)
    {
        var expander = (Expander) sender;
        var currentItem = expander.Resources["item"];

        // I have my data and I'd like to pass that to a specific UserControl
        // that knows how to deal with that data the way I want

    } 
```

如何根据我设置的类型参数进行用户控制`SetType<TVM, TPanel>()`？

我是否可以创建一个类型存储在其中的类的实例`public virtual Type PanelType { get; private set; }`？

如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:59:46.697

[Activator.CreateInstance（类型）](http://msdn.microsoft.com/en-us/library/wccyzw83.aspx)

# java - 用 entityManager.persist(Object) 插入 ... 值；

> ID：10755717
> 
> 赞同：4
> 
> 时间：2012-05-25T13:58:57.430
> 
> 标签：java, hibernate, jpa, persistence, hql

```
public void miseAJourTranscoIdCroisiere(Integer idCroisiereKaravel, String idCroisiereArmateur, TypeArmateur typeArmateur) {
        IdCroisiereKaravelArmateur idRelationship = new IdCroisiereKaravelArmateur();

        idRelationship.setIdCroisiereKaravel(idCroisiereKaravel);
        idRelationship.setIdCroisiereArmateur(idCroisiereArmateur);
        idRelationship.setTypeArmateur(typeArmateur);

        entityManager.persist(idRelationship);
    } 
```

这个代码片段应该自己工作吗？它不会抛出异常。然而它什么也没做。我对 Java 的持久性感到很困惑。

因为我不能用 hql 插入 ... 值，所以我应该直接用 jpa 来做，对吧？

我试图以[这种方式](https://stackoverflow.com/questions/3085716/jpa-insert-statement)做到这一点，但我得到了这个

```
java.lang.IllegalStateException: Not allowed to create transaction on shared EntityManager - use Spring transactions or EJB CMT instead
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:198)
    at $Proxy19.getTransaction(Unknown Source)
    at com.karavel.connectivity.gateway.croisiere.common.repository.impl.CatalogueKaravelRepositoryImpl.miseAJourTranscoIdCroisiere(CatalogueKaravelRepositoryImpl.java:56)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:196)
    at $Proxy23.miseAJourTranscoIdCroisiere(Unknown Source)
    at com.karavel.connectivity.gateway.croisiere.controller.service.RechercherCroisiereController.getItineraireCroisiere(RechercherCroisiereController.java:385)
    at com.karavel.connectivity.gateway.croisiere.controller.service.RechercherCroisiereController.obtenirListeCroisiere(RechercherCroisiereController.java:283)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:426)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:414)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.web.filter.AbstractRequestLoggingFilter.doFilterInternal(AbstractRequestLoggingFilter.java:193)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:291)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662) 
```

所以我考虑创建另一个 EntityManager 来执行此操作。但是，这不是我不能使用 EntityManagerFactory 的静态方法。

在ddbb中做一个简单的插入会这么乱吗？

如果我说愚蠢或混淆概念，我很抱歉，但我在 Java 持久性和 Hibernate 方面有两天的经验。

**编辑以显示我的课程：**

我确实需要一个事务，但我不能从共享的 EntityManager 中获得它（这是什么意思？）

我是否需要为该方法使用 EntityManager？如果我这样做，我不能使用 EntityManagerFactory 来保持静态。

对不起，这不是我创建的架构。我刚从 Spring 和 Hibernate 开始，所以这里有一个很大的组合……

应用上下文：

```
<bean id="gateway.croisiere.catalogueKaravel.dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${gateway.croisiere.catalogueKaravel.driver.className}" />
    <property name="url" value="${gateway.croisiere.catalogueKaravel.driver.url}" />
    <property name="username" value="${gateway.croisiere.catalogueKaravel.driver.username}" />
    <property name="password" value="${gateway.croisiere.catalogueKaravel.driver.password}" />
</bean>
<bean id="gateway.croisiere.catalogueKaravel.entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceXmlLocation" value="classpath:/catalogueKaravel-persistence.xml" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="generateDdl" value="${gateway.croisiere.catalogueKaravel.hibernate.hbm2ddl.auto}" />
            <property name="databasePlatform" value="${gateway.croisiere.catalogueKaravel.hibernate.dialect}" />
            <property name="showSql" value="${gateway.croisiere.catalogueKaravel.hibernate.show_sql}" />
        </bean>
    </property>
    <property name="dataSource" ref="gateway.croisiere.catalogueKaravel.dataSource" />
    <property name="persistenceUnitName" value="gateway-croisiere-catalogueKaravel-persitence-unit" />
</bean>
<bean id="gateway.croisiere.catalogueKaravel.transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="gateway.croisiere.catalogueKaravel.entityManagerFactory" />
    <property name="defaultTimeout" value="${gateway.croisiere.catalogueKaravel.hibernate.transaction.timeout}" />
</bean>
<tx:annotation-driven transaction-manager="gateway.croisiere.catalogueKaravel.transactionManager" />persistence:
<persistence xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">
    <persistence-unit name="gateway-croisiere-catalogueKaravel-persitence-unit" transaction-type="RESOURCE_LOCAL">
        <class>com.karavel.connectivity.gateway.croisiere.common.domain.cataloguekaravel.IdCroisiereKaravelArmateur</class>
        <class>com.karavel.connectivity.gateway.croisiere.common.domain.cataloguekaravel.CroisiereInfoCatalogueKaravel</class>
        <class>com.karavel.connectivity.gateway.croisiere.common.domain.cataloguekaravel.CroisiereOffreItineraireCatalogueKaravel</class>
        <class>com.karavel.connectivity.gateway.croisiere.common.domain.cataloguekaravel.EscaleCatalogueKaravel</class>
        <class>com.karavel.connectivity.gateway.croisiere.common.domain.cataloguekaravel.CroisiereItineraireCatalogueKaravel</class>
    </persistence-unit>
</persistence> 
```

实体：

```
@Entity
@Table(name="transco_idcroisierekaravel_idcroisierearmateur")
public class IdCroisiereKaravelArmateur implements Serializable {

    private static final long serialVersionUID = -2764921376397148157L;

    @Id
    @GeneratedValue
    @Column(name="id")
    private Integer id;

    @Column(name="idCroisiereKaravel")
    private Integer idCroisiereKaravel;

    @Column(name="idCroisiereArmateur")
    private String idCroisiereArmateur;

    @Column(name="typeArmateur")
    @Enumerated(EnumType.STRING)
    private TypeArmateur typeArmateur;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Integer getIdCroisiereKaravel() {
        return idCroisiereKaravel;
    }

    public void setIdCroisiereKaravel(Integer idCroisiereKaravel) {
        this.idCroisiereKaravel = idCroisiereKaravel;
    }

    public String getIdCroisiereArmateur() {
        return idCroisiereArmateur;
    }

    public void setIdCroisiereArmateur(String idCroisiereArmateur) {
        this.idCroisiereArmateur = idCroisiereArmateur;
    }

    public TypeArmateur getTypeArmateur() {
        return typeArmateur;
    }

    public void setTypeArmateur(TypeArmateur typeArmateur) {
        this.typeArmateur = typeArmateur;
    }
} 
```

存储库

```
@SuppressWarnings("unchecked")
public class CatalogueKaravelRepositoryImpl implements CatalogueKaravelRepository {
    @PersistenceContext(unitName="gateway-croisiere-catalogueKaravel-persitence-unit")
    private EntityManager entityManager;

    @Override
    @Transactional
    public void miseAJourTranscoIdCroisiere(Integer idCroisiereKaravel, String idCroisiereArmateur, TypeArmateur typeArmateur) {

        IdCroisiereKaravelArmateur idRelationship = new IdCroisiereKaravelArmateur();

        idRelationship.setIdCroisiereKaravel(idCroisiereKaravel);
        idRelationship.setIdCroisiereArmateur(idCroisiereArmateur);
        idRelationship.setTypeArmateur(typeArmateur);

        EntityManager em = getEntityManager();

        // begin transaction 
        em.getTransaction().begin();

        // persist object - add to entity manager
        em.persist(idRelationship);

        // flush em - save to DB
        em.flush();

        // commit transaction at all
        em.getTransaction().commit();   
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:04:26.863

看起来你的问题很简单：它想要一个交易。您正在使用 Spring。将 Spring 拖入持久化领域的主要原因是获得基于 AOP 的注入事务.. ? 您应该能够注释您的方法 @Transaction 并在您的 applicationContext.xml 或通过其他一些引导程序启动 TransactionManager。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:01:59.660

是的，`EntityManager#persist`应该可以保存记录，

1.  您的实体管理器坚持似乎正在抛出运行时异常，将其包装在 try catch 块中

2.  确保您的类在 spring 事务下声明，如果您使用基于注释的配置，那么您的类应标记为 @Transactional 并且您的 entityManager 应标记为 @PersistenceContext

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T22:55:31.213

*正如问题的原始海报所述：*

* * *

## 我的解决方案：

实际上 TranscationManager 的 bean 没有正确设置。我拿了在 Spring 配置文件中找到的第一个。由于审计系统工作正常，我只使用了相同的配置。但是，对于其他 DDBB 访问，它尝试使用 Audit TransactionManager（第一个出现在配置文件中）

我希望这可以帮助别人。很抱歉这样一个模糊的解决方案，但这是几个月前的事了，我无法再访问代码了。

# android - 有谁知道为什么facebook放错图片

> ID：10755719
> 
> 赞同：1
> 
> 时间：2012-05-25T13:59:02.763
> 
> 标签：android, facebook, share, image

我有此代码用于在 facebook 上共享应用程序，但是当我共享它时，它会放置正确的链接，但应用程序的图片错误

```
Button bShare = (Button) findViewById(R.id.button7);
    bShare.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            final Intent intent = new Intent(Intent.ACTION_SEND);
            intent.setType("text/plain");
            intent.putExtra(Intent.EXTRA_TEXT, "https://play.google.com/store/apps/details?id=com.myglobaljournal.christmascarol");
            startActivity(Intent.createChooser(intent, "Share with")); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T14:14:23.537

您可以使用[调试工具](http://developers.facebook.com/tools/debug/og/object?q=https://play.google.com/store/apps/details?id=com.myglobaljournal.christmascarol)来检查 facebook 如何“看到”这个 url。

从结果中您可以看到没有定义 og 元标记，因此 facebook 可能会从内容中随机获取一张图片。

* * *

# 编辑

Facebook 使用开放图元标签来提取信息，然后将这些信息用于在 Facebook 体验中呈现分享故事。

[您可以在 Open Graph 协议](http://developers.facebook.com/docs/opengraphprotocol/)的存档版本中看到一个示例，新版本使用那里的标签，但它对您的需求来说太复杂了。

唯一的问题是：您可以控制应用程序的 google play 商店的输出吗？我的猜测是您不能，如果您查看其他示例（例如[instagram](http://developers.facebook.com/tools/debug/og/object?q=https://play.google.com/store/apps/details?id=com.instagram.android)或[opera mobile](http://developers.facebook.com/tools/debug/og/object?q=https://play.google.com/store/apps/details?id=com.opera.browser)），图像也会随机出现。

# java - 多个 if 语句

> ID：10755721
> 
> 赞同：4
> 
> 时间：2012-05-25T13:59:19.520
> 
> 标签：java, android, performance, button, if-statement

假设我正在使用一个 if 语句来解释十种不同的可能按钮按下，这些按钮按下将事件值发送到事件侦听器：

```
public boolean onTouch(int v) { //this is my only listener for all ten buttons
  if(event.getAction() == MotionEvent.ACTION_DOWN){
   if(v==button_one){pool.play(bass1, 1f,1f, 1, 0, 1f);}
   if(v==button_two){pool.play(bass2, 1f,1f, 1, 0, 1f);}
   if(v==button_three){pool.play(bass3, 1f,1f, 1, 0, 1f);}
   if(v==button_four){pool.play(snare1, 1f,1f, 1, 0, 1f);}
   if(v==button_five){pool.play(snare2, 1f,1f, 1, 0, 1f);}
   if(v==button_six){pool.play(snare3, 1f,1f, 1, 0, 1f);}
   if(v==button_seven){pool.play(hh1, 1f,1f, 1, 0, 1f);}
   if(v==button_eight){pool.play(hh2, 1f,1f, 1, 0, 1f);}
 }
 return false;
} 
```

对这些进行分类会更有效吗？说... 一个用于军鼓的 onClick 事件，一个用于贝司的事件，一个用于踩镲的事件，这样当按下按钮时，程序就不必计算每个 if 语句，只有在监听器中的那个用于触发事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T14:10:43.953

这样的事情呢？

```
HashMap<int,int>  soundMap = new HashMap<int,int>();
soundMap.put(button_one, bass1);
soundMap.put(button_two, bass2);
soundMap.put(button_three, bass3);
soundMap.put(button_four, snare1);
soundMap.put(button_five, snare2);
soundMap.put(button_six, snare3);
soundMap.put(button_seven, hh1);
soundMap.put(button_eight, hh2); 
```

将 HashMap 作为类变量，并在 onCreate 或其他东西中初始化映射。然后你可以将它用于你的听众：

```
public boolean onTouch(int v) {
    if(event.getAction() == MotionEvent.ACTION_DOWN) {
        pool.play(soundMap.get(v), 1f, 1f, 1, 0, 1f);
    }
    return false;
} 
```

这样做的好处是，如果以后要添加更多按钮，只需要用新的声音映射修改映射初始化方法即可；侦听器不需要任何更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:33:15.150

只是为了在这里添加丰富的建议和意见，并同意之前关于“这真的是一个性能问题”的所有观点，我会选择使代码最容易阅读和维护的结构，以及其他任何人可能需要维护它。通过维护，还要考虑扩展它。如果您想再添加 5 个音垫，在 3 个月内会发生什么？

减少到最少的行数可能会给您带来几乎无法估量的性能提升，并在您的 APK 中节省几个字节，但在大多数情况下，我会以可读性为代价。

尽管如此，我确实喜欢 kcoppocks 的解决方案。对我来说，这很简短，我会怎么做更好，一个开关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:05:53.780

在你知道这是一个问题之前，我不会担心打破它。switch 将有助于减少重复的`if`语句：

```
public boolean onTouch(int v) {
  if(event.getAction() == MotionEvent.ACTION_DOWN) {
    switch (v) {
    case button_one: pool.play(); break;
    case button_two: pool.play(..); break;
    ...
    }
  }
 return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:18:48.197

我不知道这`if`运行了多少次，但对我来说似乎并没有效率低下。这个布尔测试非常快。无论如何，如果您确实想让它尽可能高效，我看到两个选项：

1.  最简单的一个：使用`else if`而不是`if`.
2.  复杂的一个：使用一组`ActionIf`对象来做你想做的事：

 `````
public interface ActionIf {
    public void go();
}

public class ActionBass1 implements ActionIf {
    @Override
    public void go() {
        pool.play(bass1, 1f,1f, 1, 0, 1f);
    }
}

public class ActionBass2 implements ActionIf {
    @Override
    public void go() {
        pool.play(bass2, 1f,1f, 1, 0, 1f);
    }
}

...

public ActionIf[] actions = {new ActionBass1(), new Action Bass2(), ...);

public boolean onTouch(int v) { //this is my only listener for all ten buttons
    if(event.getAction() == MotionEvent.ACTION_DOWN && v >= 0 && v <= (button_eight-button_one)){
        actions[button_one+v].go();
    }
    return false;
} 
````  `* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T14:16:23.533

在这种情况下，真的不值得担心性能；条件语句所花费的时间将被它周围的事件处理代码完全相形见绌。绩效的第一至第三定律是衡量、衡量、衡量，我对找到差异的机会持怀疑态度。

我不禁注意到唯一改变的是 pool.play 的第一个参数。bass1、bass2 等与对应的 v 值之间是否存在关系？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T14:16:43.397

我认为没有必要，但我肯定会推荐 switch 和 case。您可以订购最常见到最不常见的，但它的变化很小，不会被注意到。通过这些 if 语句根本不需要很长时间。``

# javascript - 拖动应用程序phonegap

> ID：10755722
> 
> 赞同：1
> 
> 时间：2012-05-25T13:59:25.450
> 
> 标签：javascript, ios, html, cordova

我想知道当我在应用程序上拖动鼠标时，滚动PhoneGap在我的应用程序中没有这个，它会向上或向下，因为我将它固定？我发布了正在发生的事情的照片，谢谢！ [http://postimage.org/image/pa2kyvvwb/](http://postimage.org/image/pa2kyvvwb/) [http://postimage.org/image/gf8cnrjsx/](http://postimage.org/image/gf8cnrjsx/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:07:02.573

这似乎在每个苹果设备上都是一样的。这不是PhoneGap 功能。在我的 mac mini 上拖动网站时也会发生同样的情况。所以你必须在objectiv-c中以编程方式完成它。也许这行得通

```
CGSize scrollableSize = CGSizeMake(320, myScrollableWidth);
[myScrollView setContentSize:scrollableSize]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:16:51.493

您可以使用此脚本，但如果页面大于屏幕，则必须自己处理滚动：

```
//Prevent dragging of canvas on iOS
$(document.body).bind('touchmove', function(event) {
    event.preventDefault();
}); 
```

# google-app-engine - 什么是描述为“下载 PDF 和任意文件”的 2-legged oauth 范围

> ID：10755723
> 
> 赞同：4
> 
> 时间：2012-05-25T13:59:26.850
> 
> 标签：google-app-engine, google-apps, google-drive-api

“下载 PDF 和任意文件”范围名称似乎是指下载任何非本地 google 文件类型，但我找不到有关它的更多信息。我可以使用文档列表 API 文档提要条目来获取下载链接，这通常可以工作，但我最近在尝试下载时遇到了一些意外的身份验证失败，这导致我发现了这个额外的应用程序清单 oauth 范围。

此处描述了定义的范围，[此处](https://developers.google.com/google-apps/marketplace/manifest#supported_scopes)描述了另一个列表（省略了“下载”范围[）](https://developers.google.com/gdata/articles/oauth#TokenScope)。这个范围是什么，我在哪里可以找到有关它的更多信息？

**编辑**

我在谷歌应用引擎的上下文中使用各种谷歌数据 API，它是应用引擎实例清单，它声明了它所需的范围。由于根据使用 google 数据 API 的上下文不同的范围列表记录不同，我指的是应用程序引擎应用程序清单的文档，我包括应用程序引擎标记。

**编辑**

[本文档](https://developers.google.com/google-apps/documents-list/#downloading_documents_and_files)中还提到了范围（通过 URL - [https://docs.googleusercontent.com/](https://docs.googleusercontent.com/)），并且似乎需要包含所有潜在的下载源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:32:39.317

我刚刚做了一些快速测试，似乎该范围`https://docs.google.com/feeds/`使您可以访问 Document List API 本身（列出文件、读取和写入元数据），同时`https://docs.googleusercontent.com/`允许您下载非本地 Google Docs 格式的文件，例如 PDF、图像等。 .. 已由用户上传到云端硬盘。对我来说，这似乎`https://docs.googleusercontent.com/feeds/download/`是一个别名`https://docs.googleusercontent.com/`

# c# - 温莎城堡中的多个装饰器模式

> ID：10755727
> 
> 赞同：14
> 
> 时间：2012-05-25T13:59:40.533
> 
> 标签：c#, .net, dependency-injection, castle-windsor, ioc-container

我们正在重新设计一些遗留软件以使其更具可测试性，并决定使用 Dependency-Injection 和 Castle.Windsor 来帮助我们。

首先，我们的目标： * 一些装饰器都在数据流上工作。* 装饰器的多种组合是可能的，并且每种情况下的根节点都可能需要从不同的地方获取数据。

从技术上讲，我们的设计如下：

```
interface IUpdateableValue<T> 
{
  T Get();
}; 
```

例如，我们需要使用多个组件检索三组数据，它们都实现了 IUpdateableValue()（伪代码）：

```
JsonParser(
    Decompressor(
        Decrypter(decryptionKey
            FileCache(filename, 
                HttpWebDownloader(url))))

XmlParser(
    Decompressor(
        Decrypter(decryptionKey2
            FileCache(filename2, 
                HttpWebDownloader(url2)))) 
```

我很难将设计融入到像 Castle-Windsor 这样的 DI 框架中。我怀疑其中一些可以由命名实例处理，但这对于这种用法来说似乎很臭。

这个想法是，例如 JsonParser 和 XmlParser 实例的“用户”不知道（或关心）数据是来自 HttpUrl、文件还是神奇地从帽子里拉出来。

我认为我们的设计有问题，但不确定如何解决。

关于如何进步的任何想法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-29T22:13:20.147

使用 Castle Windsor，您可以通过以正确的顺序注册装饰器来隐式配置装饰器。您需要先注册外部装饰器：

```
container.Register(Component
  .For<IUpdateableValue>()
  .ImplementedBy<JsonParser>());
container.Register(Component
  .For<IUpdateableValue>()
  .ImplementedBy<Decompressor>());
container.Register(Component
  .For<IUpdateableValue>()
  .ImplementedBy<Decrypter>());
... 
```

当您解析 IUpdateableValue 时，Caste Windsor 将自动连接依赖项，因此它们被正确嵌套。

# javascript - 使用javascript获取弹出窗口的当前url

> ID：10755730
> 
> 赞同：7
> 
> 时间：2012-05-25T13:59:48.723
> 
> 标签：javascript, jquery

我有一个带有链接的网页，它会在弹出窗口中打开一个新页面。到目前为止一切都很好，弹出窗口包含一些第三方服务器持有的信用卡支付页面。完成付款流程后，将显示响应并且 URL 发生了变化。

我需要得到那个网址。

在javascript中可以吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-25T14:16:48.063

[可以通过 window 对象的location](https://developer.mozilla.org/en/DOM/window.location)属性访问页面的 URL 。如果您正在访问与您在同一个子域上的站点，那么您可以通过以下方式获取地址

```
popupWindow.location.href 
```

但是，如果弹出窗口来自第三方，则应用[相同的来源策略](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)，并且不允许您检查弹出窗口的 location.href。绕过同源政策的唯一方法是与第三方合作。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-25T14:17:53.300

谷歌是你的朋友；D

```
 var newURL = window.location.protocol + "://" + window.location.host + "/" 
              + window.location.pathname; 
```

# jquery - jquery 将 div 包裹在循环的每次迭代中

> ID：10755732
> 
> 赞同：1
> 
> 时间：2012-05-25T14:00:01.857
> 
> 标签：jquery, json

此代码从执行 json_encode 的 php 文件中获取数据，该文件从 csv 文件中提取信息。我希望在第二个循环中的每组值周围都有一个父 div。我用 newDiv2 试过这个，但它用 .sub_row 包裹了每个 .field。

而不是这个：

```
 <div class="row"> // This one happens to only have one payment
     <div class="sum_field">Total: 79.99</div>
          <div class="field">BENV5239</div> // Details of payment
          <div class="field">11111</div>
</div>
 <div class="row"> // Based on Vendor ID
     <div class="sum_field">Total: 2487.01</div> // Sums up all payments for that Vendor
     <div class="field">BENV2137</div>
     <div class="field">11111</div>
     <div class="field">BENV2137</div>
     <div class="field">111111</div>
</div>
<div class="row"></div> // Another Vendor ID 
```

应该是这样的：

```
 <div class="row">
     <div class="sum_field">Total: 200.00</div>
     <div class="sub_row">  // one payment
          <div class="field">BENV5239</div> // Details of payment
          <div class="field">11111</div>
     </div>
</div>
 <div class="row">
     <div class="sum_field">Total: 2487.01</div>
  <div class="sub_row"> // each payment that has the same vendor id is in it's own div
     <div class="field">BENV2137</div> 
     <div class="field">11111</div>
 </div>
 <div class="sub_row">
     <div class="field">BENV2137</div>
     <div class="field">111111</div>
 </div>
</div> 
```

PHP 代码

```
 $(document).ready(function() {
 $.getJSON('WF-XML.php', function(data) {

    //JSON.stringify(data); 
    var prevCardCode = '';
    var newDiv;

    $.each(data, function(index, element) {
        if (element['CardCode'] != prevCardCode) {
            newDiv = $('<div/>').addClass('row').appendTo('#showdata');
            $('<div class="sum_field">' + 'Total: ' + element['payment_sum'] + '</div>').appendTo(newDiv);      
            }
        prevCardCode = element['CardCode'];

        $.each(element, function(key, value) {

            switch (key) {
                case 'InvKey':
                case 'PostDate':
                case 'City':
                break;

                default:
                //newDiv2 = $('<div/>').addClass('sub_row').appendTo('.row');
                $('<div class="field">' + value + '</div>').appendTo(newDiv);
                break;
                 }
             });
         });
     });
  }); 
```

JSON - 我循环了两次，第一次我只打印总和（这是在 SQL 中计算的，第二次打印出其余的信息。你可以看到最后 2 个对象是对于相同的供应商 ID - 因此我希望在每个新供应商周围放置一个父 div，然后是每个单独的付款。我的代码已经用父 div 包装了发送给一个供应商的每组付款，但我不能弄清楚如何用父 div 包装每个单独的付款。

```
 {"VendorID":"BENV5239","payment_sum":"79.99","Address":"525 Sapper St.","ZipCode":"19116"},
 {"VendorID":"BENV2137","payment_sum":"2487.01","InvPayAmnt":"108.92","Address":"340 Middle Road","ZipCode":"19037"},
 {"VendorID":"BENV2137","payment_sum":"2487.01","InvPayAmnt":"57.60","Address":"340 North Middle Road","ZipCode":"19037"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:21:49.447

```
 $(document).ready(function() {
 $.getJSON('WF-XML.php', function(data) {

//JSON.stringify(data); 
var prevCardCode = '';
var newDiv;

$.each(data, function(index, element) {
    if (element['CardCode'] != prevCardCode) {
        newDiv = $('<div/>').addClass('row').appendTo('#showdata');
        $('<div class="sum_field">' + 'Total: ' + element['payment_sum'] + '</div>').appendTo(newDiv);      
        }
    newDiv2 = $('<div/>').addClass('sub_row').appendTo(newDiv);
    prevCardCode = element['CardCode'];

    $.each(element, function(key, value) {

        switch (key) {
            case 'InvKey':
            case 'PostDate':
            case 'City':
            break;

            default:
            //newDiv2 = $('<div/>').addClass('sub_row').appendTo('.row');
            $('<div class="field">' + value + '</div>').appendTo(newDiv2);
            break;
             }
         });
     });
 }); 
```

});

# java - 如何收听测试套件更改以更改某些配置

> ID：10755736
> 
> 赞同：1
> 
> 时间：2012-05-25T14:00:14.557
> 
> 标签：java, junit, junit4, test-suite, spring-test

我有许多 Spring Test 类（使用 定义`@RunWith(SpringJUnit4ClassRunner)`），我想将它们分组到测试套件中，以便为每个套件而不是每个测试类加载一次新配置。

现在我`TestExecutionListener`对每个 Spring 测试都有一个监听器，它将重新加载配置，但我想保存它，因为许多测试共享相同的配置。

遗憾的是，Spring既不支持监听`JUnit TestSuite`s，也不`JUnit`支持 s 的监听器概念`TestSuite`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:24:02.490

如果您希望在 junit 测试套件之前/之后执行操作，您可以使用[@BeforeClass](http://kentbeck.github.com/junit/javadoc/latest/org/junit/BeforeClass.html)和[@AfterClass](http://kentbeck.github.com/junit/javadoc/latest/org/junit/AfterClass.html)，甚至是[@ClassRule](http://kentbeck.github.com/junit/javadoc/latest/org/junit/ClassRule.html)。您可以在那里为整个套件进行设置。使用以下示例：

```
@RunWith(Suite.class)
@SuiteClasses({ ExpectedFailureTest.class, RetryTest.class })
public class BeforeClassSuite {
  @BeforeClass
  public static void beforeClass() {
    System.out.println("beforeClass");
  }

  @AfterClass
  public static void afterClass() {
    System.out.println("afterClass");
  }

  @ClassRule
  public static ExternalResource resource = new ExternalResource() {
    @Override
    protected void before() throws Throwable {
      System.out.println("before");
    };

    @Override
    protected void after() {
      System.out.println("after");
    };
  };
} 
```

这产生作为输出：

```
before
beforeClass
... output from tests
afterClass
after 
```

# database - 数据库囤积和缓存

> ID：10755742
> 
> 赞同：1
> 
> 时间：2012-05-25T14:00:32.967
> 
> 标签：database, caching

数据库囤积和缓存有什么区别？他们在我看来是一样的。我知道在设备与服务器断开连接时，囤积与使用数据库有关。缓存对此没有帮助吗？有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T04:19:50.520

当与服务器的连接性很强时，就会进行囤积。在这个阶段，客户端变得积极并根据用户访问模式预取数据。另一方面，缓存与连接性无关，它是在本地对经常使用的数据执行的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T08:51:34.880

缓存更适合按需请求，您可以在其中缓存缓存未命中所需的数据。它通常会存储在内存中并在一段时间后清除，以避免过时的数据无法让您在断开连接模式下操作。另一种选择更适合断开模式，通过将所需数据预取到本地缓存中，并且在某些实现中会尝试使其与远程数据库保持同步。这样您仍然可以在断开连接模式下操作，但您可能会看到陈旧的数据。

您可以在 IMDG（内存数据网格）中考虑相同的语义，其中远程客户端可以按需缓存数据或预取数据并使其与远程 IMDG 在幕后异步同步。GigaSpaces XAP 正是通过其内存数据网格提供了这种功能，第一个按需缓存概念称为本地缓存，而第二个预取概念称为本地视图，您可以在创建时指定应在幕后预加载哪种类型的数据它将与数据网格中所做的更改保持同步。

[http://www.gigaspaces.com/datagrid](http://www.gigaspaces.com/datagrid) http://www.gigaspaces.com/wiki/display/XAP9/Client+Side+Caching

艾坦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-23T14:03:13.997

当您连接到服务器时使用囤积，并且在没有任何连接的情况下使用缓存。两者的工作方式相同：它们存储经常搜索的数据。它们存储应用程序的设备压缩数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-03T19:20:22.543

移动设备并不总是连接到服务器或网络，设备也不会从服务器或网络中为每次计算检索数据。相反，在设备连接到服务器或网络的时间间隔内，设备会缓存一些特定数据，这些数据可能需要用于未来的计算。缓存需要从具有大型数据库的连接系统中保存选定数据的副本或数据库的一部分。缓存的数据存储在移动设备数据库中。将缓存的数据囤积在数据库中，确保即使设备没有连接到网络，也可以从数据库中获取所需的数据进行计算。

囤积的一些例子是下载的铃声、音乐等，也可以离线使用。

# ios - touchesMoved 处理第一次触摸事件 iOS

> ID：10755743
> 
> 赞同：1
> 
> 时间：2012-05-25T14:00:35.917
> 
> 标签：ios, touchesmoved

我正在使用这种方法在视图中移动我的对象：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
```

在这个方法中，我接下来写了：

```
NSLog(@"event: %@", event); 
```

并得到这个结果：

```
event: <UITouchesEvent: 0x310d00> timestamp: 5277.16 touches: {(
    <UITouch: 0x3f1110> phase: Moved tap count: 1 window: <UIWindow: 0x3117d0; frame = (0 0; 768 1024); layer = <UIWindowLayer: 0x30cb20>> view: <UIView: 0x330520; frame = (0 0; 768 1024); transform = [0, -1, 1, 0, 0, 0]; autoresize = W+H; layer = <CALayer: 0x330550>> location in window: {279, 677} previous location in window: {305, 694} location in view: {347, 279} previous location in view: {330, 305},
    <UITouch: 0x4a1a710> phase: Stationary tap count: 1 window: <UIWindow: 0x3117d0; frame = (0 0; 768 1024); layer = <UIWindowLayer: 0x30cb20>> view: (null) location in window: {412, 89} previous location in window: {413, 89} location in view: {412, 89} previous location in view: {413, 89}
)} 
```

在这个日志中，我可以看到我所有的触摸（现在这是两次触摸）。

我的问题是如何取得联系？

这需要移动我的对象。

现在我正在使用这个：

```
UITouch *touch = [[event allTouches] anyObject];
CGPoint touchLocation = [touch locationInView:self.view]; 
```

但是当我移动我的对象时，我会得到所有的触摸值。如何处理第一次触摸？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:15:58.700

你这样做的方式没有错，但如果你真的想知道如何获得第一个对象，就在这里。

参数 touches 是`NSSet`类型。如果您查看[NSSet 类参考](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSSet_Class/Reference/Reference.html)，您还可以找到一个方法 [`- (NSArray *)allObjects`](http://developer.apple.com/library/ios/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSSet_Class/Reference/Reference.html#//apple_ref/doc/uid/20000143-CHDDFHBE)。

因此，您可以通过以下方式检索第一次触摸：

```
UITouch *touch = (UITouch *)[[[event allTouches] allObjects] objectAtIndex: 0]; 
```

另请查看[UIEvent Class Reference](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIEvent_Class/Reference/Reference.html)。在那里你会发现 allTouches 不是唯一的方法。类也知道如何返回：

```
- (NSSet *)touchesForGestureRecognizer:(UIGestureRecognizer *)gesture

- (NSSet *)touchesForView:(UIView *)view

- (NSSet *)touchesForWindow:(UIWindow *)window 
```

所有这些方法都返回一个`NSSet`. 您可以使用's方法将其*转换*为。`NSArray``NSSet``allObjects`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T14:21:14.550

如果您使用触摸事件来拖动视图，则可以使用 UIPanGestureRecognizer。

识别器具有最小/最大触摸次数等属性，并且由 Apple 专门用于拖动视图。

[UIPanGestureRecognizer 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPanGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/cl/UIPanGestureRecognizer)

# javascript - 在 URL 中生成的 Base64 编码/解码和下载内容

> ID：10755749
> 
> 赞同：5
> 
> 时间：2012-05-25T14:01:05.333
> 
> 标签：javascript, base64

我正在通过 JavaScript 生成一个字符串，我需要将它下载到具有预定义动态文件名的文本文件中。这样员工就没有犯错的余地。

由于安全问题，这在 JavaScript 中显然是不可能的。但是，从我读过的内容来看，base64 编码应该是可能的。

我设法对字符串进行编码并用解码后的数据打开一个 url。此 URL 中的字符串已成功解码。格式如下：

```
var data = 'data:text/plain;base64,'+L_EncodedData;
document.location = data; 
```

我需要打开一个包含解码数据的文件对话框，以便员工可以下载此 URL 中生成的内容。

有什么帮助吗？

提前谢谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-03T03:20:19.443

如果您仍在寻找答案，请[在此处查看我的答案](https://stackoverflow.com/questions/9707604/output-a-pdf-in-php-from-a-byte-array/16350999#16350999)。这就是我将如何调整它以满足您的需求。

```
// Convert the Base64 string back to text.
var txt = atob(data.reportBase64Bytes);

// Blob for saving.
var blob = new Blob([byteString], { type: "text/plain" });

// Tell the browser to save as report.txt.
saveAs(blob, "report.txt"); 
```

如果您使用它，请确保您使用了我在另一篇文章中提到的 polyfill。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-24T13:13:25.850

这个块是固定的。

```
window.OpenWindowForBase64 = function(url, callback) {
    var image = new Image();
    image.src = url;
    var w = window.open("");
    w.document.write(image.outerHTML);
    if (callback) {
        callback(url);
    }
} 
```

# biopython - 从 Bio.PDB 导入时出现 ImportError

> ID：10755751
> 
> 赞同：0
> 
> 时间：2012-05-25T14:01:21.950
> 
> 标签：biopython

我想使用 Biopython 的 PDBParser 下载 PDB 文件，但是当我尝试导入它时出现此错误：

> 回溯（最后一次调用）：文件“C:\Python27\TAREA 3 FINAL.PY”，第 33 行，在 [HTML] 中来自 Bio.PDB 导入 * 文件“C:\Python27\lib\site-packages\Bio\ PDB_init_.py"，第 15 行，在 [HTML] from PDBParser import PDBParser File "C:\Python27\lib\site-packages\Bio\PDB\PDBParser.py"，第 13 行，在 [HTML] import numpy ImportError: No名为 numpy 的模块

这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T05:42:05.463

Biopython 需要[numpy](http://numpy.scipy.org/)模块。您需要安装 numpy 才能使用 Biopython。[您可以在此处](http://sourceforge.net/projects/numpy/files/NumPy/1.6.2/)找到最新版本。

# wpf - 由元素数据过滤的 observablecollection 的多个视图

> ID：10755754
> 
> 赞同：0
> 
> 时间：2012-05-25T14:01:33.353
> 
> 标签：wpf, filter, observablecollection

我正在构建一个 WPF 应用程序，它接收数据行，并根据行中包含的数据将它们输出到 GUI 中的不同选项卡中。但是，这些选项卡直到运行时才知道，因此我需要动态构建未知数量的选项卡，其中包含从我的主要 ObservableCollection 中使用不同过滤器的集合视图。

我一直遇到的问题是，使用 ListCollectionViews 我需要一个谓词过滤器，但我不知道一种基于局部变量的动态谓词的方法？我尝试了变量捕获，但每次添加新选项卡时都会更改我的所有过滤器。

```
//class variables
string currTab;
public ObservableCollection<MyData> myCollection = new ObservableCollection<myData>();
private void DataAdd(object sender, RoutedEventArgs e)
{
   currTab = inputData.ToString();
   ListCollectionView c = new ListCollectionView(myCollection);
   c.Filter = new Predicate<object>(MyFilter);
}
public bool MyFilter(object foo)
{
   if (foo).ToString() != currTab)
      return false;
   else
      return true;
} 
```

我还尝试使用 lambda 表达式和 ICollectionView，但集合不会更新为新值，所以我只看到空选项卡。

```
CollectionView c = new CollectionViewSource { Source = myCollection.Where(z => z.ToString() == tabName) }.View; 
```

有没有办法使这些方法中的任何一种都起作用？或者更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:57:48.200

原来我只需要为谓词使用局部变量

```
var b = currTab
c.Filter = (foo) =>{return foo.ToString() == b;}; 
```

# python - 无法在 MySQL 中插入日期

> ID：10755755
> 
> 赞同：0
> 
> 时间：2012-05-25T14:01:38.660
> 
> 标签：python, mysql

我正在尝试使用 Python 在 MySQL 中插入数据。**将,_**和**,:-)**插入数据库时​​出错。

```
TypeError: not all arguments converted during string formatting 
```

在代码中：

```
emoticons = 'C:/Users/user/Desktop/emoticons.txt'
csv_data = csv.reader(open(emoticons, 'rb'))
count = 0
for row in csv_data:
   count = count + 1
   c.execute("INSERT INTO Emoticons (Emotions) VALUES (%s)", row)
db.close() 
```

我错过了代码中的某些内容吗？有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:07:12.923

```
csv.reader(open(emoticons, 'rb')) 
```

以逗号作为默认分隔符将文件读取为 CSV 并返回一个列表（`row`变量）。

```
c.execute("INSERT INTO Emoticons (Emotions) VALUES (%s)", row) 
```

等待一个`row`只有一个元素的元组（因为`%s`查询字符串中有一个）。

您的文件可能包含逗号，这些行将被分成几个元素，这些元素无法格式化到查询中。

如果要将文件中的整行插入 DB，则不必使用`csv`：

```
emoticons = 'C:/Users/user/Desktop/emoticons.txt'
with open(emoticons, 'r') as f:
    for row in f:
        c.execute("INSERT INTO Emoticons (Emotions) VALUES (%s)", (row,))
db.close() 
```

# crystal-reports - Crystal Reports - 搜索依赖项

> ID：10755758
> 
> 赞同：1
> 
> 时间：2012-05-25T14:01:46.677
> 
> 标签：crystal-reports, dependencies, crystal-reports-2008

是否有一种工具可以让您搜索许多不同的水晶报表以查看特定表/视图/SP 的使用位置？

场景是这样的：我们有 200 多个报告，因此当对视图或存储过程进行更改时，如果不打开每个报告并检查“数据库专家”或“数据源位置”，就很难找到哪些报告会受到影响。

我已经在他们身上尝试过 Agent Ransack，它没有选择任何表或视图名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:15:55.507

在此处查看问题： [在 Crystal Report 中进行搜索的任何方式](https://stackoverflow.com/questions/8313625/anyway-to-search-inside-a-crystal-report)

另一种选择是滚动你自己的软件来完成它，但这可能比你想要的更耗时。或者，找一个已经这样做过的人 :) 如果你找到了可行的方法，请让我们其他人知道，因为我们都在同一条船上。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:45:44.880

我从未找到执行此操作的工具，因此在 C# .Net 4.0 中推出了我自己的工具。

如果水晶报表使用“SQL 命令”而不是拖入表格，那就有点棘手了。我建议只搜索 TableName 而不是完全限定的 Database.dbo.TableName - 因为这可能在粘贴的 SQL 命令中被省略了。

用法：

```
var reports = CrystalExtensions.FindUsages("C:/Reports", "table_name"); 
```

代码：

```
namespace Crystal.Helpers
{
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Reflection;
    using CrystalDecisions.CrystalReports.Engine;
    using Microsoft.CSharp.RuntimeBinder;

    public static class CrystalExtensions
    {
        public static List<string> FindUsages(string directory, string tableName)
        {
            var result = new List<string>();

            foreach (var file in Directory.EnumerateFiles(directory, "*.rpt", SearchOption.AllDirectories))
            {
                using (var report = new ReportClass { FileName = file })
                {
                    if (report.Database == null) continue;

                    var tables = report.Database.Tables.ToList();
                    var hasTable = tables.Any(x => x.Name == tableName || x.GetCommandText().Contains(tableName));

                    if (hasTable)
                        result.Add(file);
                }
            }

            return result;
        }

        public static List<Table> ToList(this Tables tables)
        {
            var list = new List<Table>();
            var enumerator = tables.GetEnumerator();

            while (enumerator.MoveNext())
                list.Add((Table)enumerator.Current);

            return list;
        }

        public static string GetCommandText(this Table table)
        {
            var propertyInfo = table.GetType().GetProperty("RasTable", BindingFlags.NonPublic | BindingFlags.Instance);

            try
            {
                return ((dynamic)propertyInfo.GetValue(table, propertyInfo.GetIndexParameters())).CommandText;
            }
            catch (RuntimeBinderException)
            {
                return ""; // for simplicity of code above, really should return null
            }
        }
    }
} 
```

希望有帮助！

# jqgrid - jqGrid：双击一行需要禁用两次

> ID：10755761
> 
> 赞同：2
> 
> 时间：2012-05-25T14:01:50.877
> 
> 标签：jqgrid, jquery

我有一个名为：grid2 的 jqgrid。当我点击一行时，它开始编辑它并在旁边添加一些小的编辑图标。但是，如果我在该编辑输入中再次双击（或数百次），它会一遍又一遍地附加图标，导致混乱。

```
ondblClickRow: function(id){
$("#grid2").editRow(id);
displayEditIcons('grid2', id, 'id');
}, 
```

我需要取消两次双击事件或删除输入的 dbclick 事件处理程序。

一个线索是在 jqGrid 事件中添加这一行：

```
$("#grid2 input").bind('dblclick',function(e){$(this).attr('disabled', 'disabled');}); 
```

但我需要： 1\. 不是禁用输入而是禁用处理程序 2\. 它只适用于第三次点击。3\. 它应该适用于所有活动的行字段。

**附言。我找到了修复**我找到了修复以防有人感兴趣。

```
$("#grid2 input").bind('dblclick',function(e){ return false; }); 
```

# android - 列表项长按（Android 4.0，上下文操作栏）

> ID：10755767
> 
> 赞同：2
> 
> 时间：2012-05-25T14:02:14.137
> 
> 标签：android, android-4.0-ice-cream-sandwich

我的应用程序中有一个 ListView，我想在长按手势上显示上下文操作栏，就像在 ICS 的设计最佳实践中一样

[http://developer.android.com/design/patterns/selection.html](http://developer.android.com/design/patterns/selection.html)

有没有默认的方法来做到这一点？或者我需要编写自己的自定义操作栏？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:35:14.150

所以，我认为这是一个很好的教程： [http ://www.vogella.com/articles/Android/article.html#tutorial_contextualmenu](http://www.vogella.com/articles/Android/article.html#tutorial_contextualmenu)

非常好的一个在这里 [http://developer.android.com/guide/topics/ui/menus.html](http://developer.android.com/guide/topics/ui/menus.html)

# javascript - 离线时用图片替换谷歌地图

> ID：10755770
> 
> 赞同：1
> 
> 时间：2012-05-25T14:02:22.027
> 
> 标签：javascript, html, css, google-maps

我对javascript相当陌生，我只是想知道是否有办法将其中包含谷歌地图的div更改为连接丢失时的静态图像。该代码进行位置跟踪，因此缓存地图对我来说毫无用处。我有一个每 10 秒更新一次地图的功能（这将用于带有移动 wifi 系统的汽车），但只有在有连接时才会这样做。离线时有没有办法可以将地图更改为图像？我尝试使用可见性和显示属性，但地图仍然存在。我要叠加的图像是 id="alt_img"

```
<div id="right_top_div" style="position:absolute; right: 0; width:50%; height:768px; z-index:10; background-color: #FFF" >
    <img id="show_more_button" src="images/show_more_button.png" style="position:absolute; left:0;top:38%; width:40px; height:150px; z-index: 12" />
    <img id="alt_img" style="position:absolute;left:0%;visibility:hidden; z-index:10" src="images/greencab_ad.png" />
    <div id="map_canvas" style="position:absolute; right:0; width:100%; height:100%; background-color: #FFF" >
        <img style="position:absolute;left:48%;top:50%; z-index:1" src="images/ajax-loader.gif" />
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:05:45.113

将图像放在地图顶部（z-index）的另一个 div 中怎么样，然后你只需调整它的可见性，而不是真正改变地图本身（这样你就不必重新初始化一遍又一遍地绘制地图，因为这些会计入您的地图配额）：

```
<div id="right_top_div" style="position:absolute; right: 0; width:50%; height:768px; z-index:10; background-color: #FFF" >
    <div id="not_connected" style="position:absolute; right:0; width:100%; height:100%; z-index:15; display:none;"><img src="image_for_no_connection.png"></div>
    <img id="show_more_button" src="images/show_more_button.png" style="position:absolute; left:0;top:38%; width:40px; height:150px; z-index: 12" />
    <img id="alt_img" style="position:absolute;left:0%;visibility:hidden; z-index:10" src="images/greencab_ad.png" />
    <div id="map_canvas" style="position:absolute; right:0; width:100%; height:100%; background-color: #FFF" >
        <img style="position:absolute;left:48%;top:50%; z-index:1" src="images/ajax-loader.gif" />
    </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:52:23.133

您可以定期保存当前地图的图像：

```
var google_tile = "http://maps.google.com/maps/api/staticmap?sensor=false&center="+
  currentPosition.lat() + "," + currentPosition.lng()+
  "&zoom="+selectedZoom+"&size="+w+"x"+h;
// w=width of canvas/map; h = height

var canvas = document.getElementById("saved_image");
var context = canvas.getContext("2d");
var imageObj = new Image();
imageObj.onload = function(){
  context.drawImage(imageObj, 0, 0);
}
imageObj.src = google_tile; 
```

好了，画布`saved_image`现在包含地图的“屏幕截图”。将其放入一个函数中，并定期调用它。当连接断开时，改为显示。

# hadoop - 数据版本控制（Hadoop、HDFS、Hbase 后端）

> ID：10755772
> 
> 赞同：1
> 
> 时间：2012-05-25T14:02:23.810
> 
> 标签：hadoop, mapreduce, versioning, hbase, bigdata

我想知道如何在 Hadoop/HDFS/Hbase 中对数据进行版本控制。它应该是您模型的一部分，因为很可能会发生变化（长时间收集大数据）。

HDFS（基于文件的后端）的主要示例。

*样本日志文件.log*：

```
timestamp x1 y1 z1 ...
timestamp x2 y2 z2 ...

```

我现在想知道在哪里添加版本信息。我看到了两种选择：

# 文件格式内的版本

*日志文件.log*：

```
 timestamp V1 x1 y1 z1 ...
timestamp V2 w1 x2 y2 z1 ... 

```

# 文件名中的版本

*日志文件_V1.log*

```
 timestamp x1 y1 z1 ... 

```

*日志文件_V2.log*

```
timestamp w1 x1 y1 z1 ...

```

第二个选项（文件名中的版本）对我来说感觉更干净并且适合 HDFS（我可以简单地使用 *_v2* 作为排除旧版本样式文件的模式）。另一方面，我需要运行 2 个不同的作业，因为我无法在一个作业中分析版本片段。

HBase 怎么样，我猜在 HBase 中版本肯定会在另一个表列中结束（HDFS 是实现细节并用作 HBase 的后端）？

用于后端 Hadoop/HDFS/HBase 的版本控制数据的任何其他替代方法？

谢谢！

编辑：我的问题与如何处理版本信息本身有关，而不是时间戳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:04:17.257

对于 HDFS，将时间戳存储在文件中会占用更多空间（每行都重复时间戳），但可以灵活地将多个日期保存在单个文件中。哪个更可取完全取决于您的用例。

对于 HBase，您有几个选择：您可以在行键中显式包含时间戳（和/或版本号），并将不同版本的数据项放入表中的不同行中；或者，您可以使用 HBase 的内置时间维度，它实际上包括数据库中每个单元格的时间戳（即每一行中每一列中的每个值），并允许您保留可配置数量的版本。默认情况下，扫描仅返回每个键/值的最新版本，但您可以在扫描时更改该行为以返回多个版本，或仅返回给定时间范围内的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T07:37:19.670

在我看来，有效的数据版本控制需要在一定程度上存储相同版本的记录。然后，您可以使用应用逻辑来选择适合您需要的版本。它类似于一些关系数据库正在做的事情。
CoachDB 可能会使用这种方法，尽管我不是 100% 确定它。
现在让我们看看 HDFS/HBase。从这个角度来看，它们是完全不同的，因为 HBase 允许数据变异和编辑，而 HDFS 则不允许。
因此，对于 HBase，您可以将 timestemp 作为密钥的最后一部分，并且所有版本都将放在一起
HDFS 适合存储少量大文件，我们无法编辑它们。我建议按照文件到达的顺序将所有版本写入文件，并使用 MapReduce 在 reducer 中将具有不同时间戳的所有版本记录组合在一起。这不会是有效的，因为所有数据都会通过洗牌，但你会控制。为了解决这个问题，我们可以通过定期执行此解决方案并将大多数记录的数据存储在一个版本中。

# c# - 如何使用 Moq 模拟 Response.StatusCode？

> ID：10755783
> 
> 赞同：10
> 
> 时间：2012-05-25T14:03:00.677
> 
> 标签：c#, asp.net-mvc, unit-testing, moq

我有以下方法：

```
 public void SetHttpStatusCode(HttpStatusCode httpStatusCode)
    {
        Response.StatusCode = (int)httpStatusCode;
    } 
```

以及以下测试：

```
 [TestMethod]
    public void SetHttpStatusCode_SetsCorrectStatusCode()
    {
        //Arrange
        //Any url will suffice
        var mockHttpContext = TestHelpers.MakeHttpContext(""); 
        mockHttpContext.SetupSet(x => x.Response.StatusCode = It.IsAny<int>());

        //creates an instance of an asp.net mvc controller
        var controller = new AppController()
        {
         ControllerContext = new ControllerContext() { 
                   HttpContext = mockHttpContext.Object }
                             };

        // Act
        controller.SetHttpStatusCode(HttpStatusCode.OK);

        //Assert
        mockHttpContext.VerifySet(x => x.Response.StatusCode = It.IsAny<int>());
    } 
```

另外，这里是 MakeHttpContext

```
 public static Mock<HttpContextBase> MakeHttpContext(string url)
    {
        var mockHttpContext = new Mock<HttpContextBase>();
        var mockRequest = new Mock<HttpRequestBase>();
        var mockResponse = new Mock<HttpResponseBase>();
        var mockSession = new Mock<HttpSessionStateBase>();

        //request
        mockRequest.Setup(x => x.AppRelativeCurrentExecutionFilePath).Returns(url);
        mockHttpContext.Setup(x => x.Request).Returns(mockRequest.Object);

        //response
        mockResponse.Setup(x => x.ApplyAppPathModifier(It.IsAny<string>())).Returns<string>(x => x);
        mockHttpContext.Setup(x => x.Response).Returns(mockResponse.Object);

        //session
        mockHttpContext.Setup(x => x.Session).Returns(mockSession.Object);

        return mockHttpContext;
    } 
```

当我运行测试时，我得到以下异常：

```
 Test method PA.Tests.Controllers.AppControllerTest.SetHttpStatusCode_SetsCorrectStatusCode
threw exception: 

      Moq.MockException: 
        Expected invocation on the mock at least once, 
        but was never performed: x => x.StatusCode = It.IsAny<Int32>()

        Configured setups:
        x => x.StatusCode = It.IsAny<Int32>(), Times.Never
        No invocations performed. 
```

Moq 如何期望/要求调用被调用？我已经调试了 SetHTTPStatusCode 方法，响应对象确实是一个模拟对象，但是 Moq 坚持认为没有调用。我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-25T14:10:33.963

你还没有展示你的`TestHelpers.MakeHttpContext`方法做了什么，所以有点难以理解发生了什么。

试试这样：

```
// Arrange
var mockHttpContext = new Mock<HttpContextBase>();
var response = new Mock<HttpResponseBase>();
mockHttpContext.SetupGet(x => x.Response).Returns(response.Object);

//creates an instance of an asp.net mvc controller
var controller = new AppController()
{
    ControllerContext = new ControllerContext() 
    { 
        HttpContext = mockHttpContext.Object 
    }
};

// Act
controller.SetHttpStatusCode(HttpStatusCode.OK);

//Assert
response.VerifySet(x => x.StatusCode = (int)HttpStatusCode.OK); 
```

# powershell - 使用 PhoneGap 上传 PowerShell 文件未检索页面

> ID：10755785
> 
> 赞同：0
> 
> 时间：2012-05-25T14:03:06.137
> 
> 标签：powershell, http-status-code-404, webclient

我正在尝试将存档文件（如果重要，则为 Zip 存档）上传到外部站点的现有 API，虽然我可以让 Web 客户端连接并获取到该站点的令牌，但上传似乎永远无法正常工作，但我不断得到404 错误。问题可能在他们这边，但我似乎是唯一一个在他们的网站上发布过它的人，但我想知道我是否正确使用 UploadFile，或者是否有办法从命令中捕获响应，我想知道是否只是为了改进我的 PowerShell 编码。

我正在运行的是以下内容：

```
# Variables I want to use
$appArchive = "\\networkpath\Releases\CodeReleasePackage.zip"
$localArchive = "c:\temp\CodeReleasePackage.zip"
[string]$appUrl = "https://site.com/api/v1/apps/(id)/"
[string]$tokenUrl = "https://site.com/token"
[string]$uploadUrl = "https://site.com/api/v1/apps/(id)/?auth_token=$mytoken"
# $appCred = Get-Credential
$username = "email@address"
$password = "password"
# Create the web client
"Creating the client.`n"
$pgup = new-object System.Net.WebClient
$pgup.Credentials = New-Object net.NetworkCredential($username,$password)
"Going to the token page"
$pgToken = $pgup.UploadString($tokenUrl,"")
$mytoken = $pgToken -replace '{|}|"|:|token',''
"Now trying to upload the latest file with my token: $mytoken"
$pgup.UploadFile($uploadUrl,$appArchive) 
```

我得到类似于 {"token","hkjuihgkjhiuhhlkhuhk"} 的令牌并且不知道是否有更好的方法来处理生成的令牌我做了替换以摆脱除令牌字符串之外的所有内容。将其添加到 URL 应该可以工作，但根据 Fiddler，我只会收到 404 错误。

因此，当我运行 $pgup.UploadFile() 时，我希望能够捕获来自站点的响应，但是当我这样做时，似乎什么都没有回来，有没有一种特殊的方法来捕获它？我找不到一个明确的例子，当我做类似 $response = $pgup.UploadFile() 的事情时，我在 $response 中什么都没有。任何对诊断 webclient 错误有用的东西都会很棒，我想了解更多关于这方面的信息，因为它看起来非常有用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:54:46.417

我不确定这是否是您要寻找的，但是这里有一些代码，我用来将 zip 文件上传到服务器。

```
$File = "yourfile.zip" #File to be uploaded
$ftp = "ftp://yourserver/directory #Location for the zip file to be uploaded

$webclient = New-Object System.Net.WebClient
$uri = New-Object System.Uri($ftp)
$webclient.Credentials =  Get-Credential #Will prompt for user info. You can use your above way to gather credentials as well
$webclient.UploadFile($uri,$File) 
```

如您所见，它相当简短，几乎与您的代码相同，但不处理令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:00:57.617

看起来我无法使用 PowerShell 作为驱动程序访问该站点，由于某种原因，我永远无法进行上传，但我可以阅读该站点上的页面并实际获得我的帐户的响应。可能是他们的 API 不喜欢 PowerShell 运行连接的方式，尽管我无法从 PhoneGap 确认任何内容，因为他们还没有回应我的问题。

已编辑：2012 年 6 月 14 日 失败的全部原因是他们这边的 Apache 实现不接受 WebClient 发送的 HTTP 1.1 请求。如果我能回到 HTTP 1.0 那么他们说我应该能够完成这个。或者我可以等待 OAUTH 2.0 实施，然后从那里开始。

# ruby-on-rails-3 - 有没有办法删除heroku上的分支

> ID：10755791
> 
> 赞同：9
> 
> 时间：2012-05-25T14:03:32.873
> 
> 标签：ruby-on-rails-3, git, deployment, heroku

我正在使用 heroku 来托管我的应用程序。通过合并和变基，我得到了我的应用程序的 2 个不同阶段。

本地大师与heroku上的大师不同。

推送到 heroku master 失败：

```
 ! [rejected]        master -> master (non-fast-forward) 
 error: failed to push some refs to 'git@heroku.com:xxxxx.git'             
 Merge the remote changes (e.g. 'git pull') before pushing again.  See the    
 'Note about fast-forwards' section of 'git push --help' for details. 
```

有没有办法删除heroku master？然后我可以再次将其推送给heroku master..

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-25T14:05:20.553

你可以强制推送

```
git push --force origin master 
```

这将覆盖远程主机。

您也可以通过这样做来删除远程分支

```
git push origin :master 
```

注意分支名称前的冒号。这个命令说“从本地机器中取 void 并把它而不是远程分支 'master'”

# php - 安装 Php5-curl 会出现 http 500 错误

> ID：10755793
> 
> 赞同：0
> 
> 时间：2012-05-25T14:03:36.893
> 
> 标签：php, curl, internal-server-error

我们正在为我们的 wordpress 网站使用轮播文件（位于 cdn 上）。我认为只有在 ubuntu 实例上安装 curl 时才能访问它。

但是我安装 curl 的那一刻 - sudo apt-get install php5-curl 网站正在返回

> HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到了意外情况。

我无法弄清楚问题到底出在哪里。请为此提出解决方案。

# serialization - 如何序列化 boost::uuids::uuid

> ID：10755794
> 
> 赞同：9
> 
> 时间：2012-05-25T14:03:39.577
> 
> 标签：serialization, boost, uuid

我目前在项目中使用 boost::uuids::uuid，我想序列化包含 boost::uuids::uuid 的对象。我尝试了下面的简单示例，但出现错误：

/usr/include/boost/archive/basic_text_oprimitive.hpp:92: 错误：'operator<<' 在 '((boost::archive::basic_text_oprimitive >*)this)->boost::archive::basic_text_oprimitive 中不匹配>::os << t'

如果有人可以帮助我，我真的很感激。

```
#include <fstream>
#include <boost/uuid/uuid.hpp>
#include <boost/uuid/uuid_generators.hpp>
#include <boost/uuid/uuid_serialize.hpp>
#include <boost/archive/text_iarchive.hpp>
#include <boost/archive/text_oarchive.hpp>

class classA {
public:
    classA() : id(boost::uuids::random_generator()()) {}
private:
    friend class boost::serialization::access;
    boost::uuids::uuid id;
    template <class Archive>
    void serialize(Archive& ar, const unsigned int version) {
        ar & id;
    }
};

int main(void) {
    classA a;
    std::ofstream ofs("uuid.txt");
    boost::archive::text_oarchive oa(ofs);
    oa << a;
    ofs.close();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-28T18:59:25.497

包括`<boost/uuid/uuid_serialize.hpp>`以启用 uuid 的序列化。 [http://www.boost.org/doc/libs/1_42_0/libs/uuid/uuid.html#boost/uuid/uuid_serialize.hpp](http://www.boost.org/doc/libs/1_42_0/libs/uuid/uuid.html#boost/uuid/uuid_serialize.hpp)

# css - Firefox 12 html 元素不会缩小到 376px 以下

> ID：10755797
> 
> 赞同：2
> 
> 时间：2012-05-25T14:03:47.867
> 
> 标签：css, html, firefox-12

我刚刚在顶部中心创建了一个带有背景图像的 HTML5 页面。

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Example</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <p>Example</p>
    </body>
</html> 
```

使用以下 CSS：

```
body 
{
    background-image: url('images/bg.png');
    background-position: top center;
    background-repeat: no-repeat;
    margin: 0;
    padding: 36px 0 0 0;
} 
```

但我在 Firefox 12 中发现了一个问题。

无论我将浏览器窗口缩小多少，HTML 元素都不会低于 376 像素。这会导致背景位置不再出现在中心，而是看起来像右对齐（然后裁剪图像的右侧部分）。

在 Chrome、Opera 和 Internet Explorer 中，它按预期工作，但在 Firefox 中，我得到了这种奇怪的行为。我添加了显示此页面的所有四个浏览器的屏幕截图。

**更新**

这似乎与浏览器中工具栏的大小有关，因为它停止的宽度与浏览器工具栏的宽度相同。一位同事刚刚尝试过，他的工具栏是 427px，它停在这个值上。我认为这是一个 Firefox 错误。

![Firefox HTML 元素大于浏览器窗口](../Images/cd1523ee29f842a03f4f0baa48e54025.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:26:36.650

对我来说，您的代码在 Firefox 12 中正确收缩。

我认为这是导致问题的插件之一。所以你可能想禁用一些，看看问题是否消失。

另外，尝试在安全模式下运行 Firefox 并查看问题是否存在。

```
"C:\Program Files\Mozilla Firefox\firefox.exe" -safe-mode 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T11:03:29.813

我想我解决了 Firefox 的问题。[在此处](https://stackoverflow.com/questions/10883401/divs-wont-resize-for-a-width-of-less-than-420px/10947548#10947548)查看我对同一主题的回答，如果有帮助，请给我反馈；）我不想在两个地方粘贴相同的答案；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T15:43:54.737

看起来这是 Firefox 中的一个真正的错误，所以我提出了一个错误。

# web-services - Google Places API“类型”问题

> ID：10755800
> 
> 赞同：0
> 
> 时间：2012-05-25T14:03:51.827
> 
> 标签：web-services, google-places-api, google-places

我习惯于从 google places 网络服务获取数据。但是，本周我意识到网络服务链接：[https://maps.googleapis.com/maps/api/place/search/json?location=41.025414,29.114866&radius=5000&types=gas_station&sensor=true&key=XXXXXXXXX](https://maps.googleapis.com/maps/api/place/search/json?location=41.025414,29.114866&radius=5000&types=gas_station&sensor=true&key=XXXXXXXXX)正在返回“ZERO_RESULTS” . 它用于返回 50 个位置，我没有更改任何代码。

当我删除 types=gas_stations 时，它运行良好。那么，你知道为什么“类型”不像以前那样运作良好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T03:35:51.840

我认为您不会收到 50 个结果，因为 Places API 一次只能返回 20 个机构。

我建议`types=gas_station`在多个位置尝试该参数以确保它无法正常工作，之后如果您仍然没有收到任何结果，我建议您在[Google Places API 问题跟踪器](http://code.google.com/p/gmaps-api-issues/issues/entry?template=Places%20API%20-%20Bug)上提交此问题。

临时解决方案是使用该`keyword=gas station`参数。这似乎返回了相关结果。

# java - 只需在浏览器的地址栏上添加 url

> ID：10755816
> 
> 赞同：0
> 
> 时间：2012-05-25T14:04:51.480
> 
> 标签：java, javascript, jquery

> **可能重复：**
> [更改浏览器中的 URL 而不使用 JavaScript 加载新页面](https://stackoverflow.com/questions/136458/change-the-url-in-the-browser-without-loading-the-new-page-using-javascript)

我只想在浏览器的地址栏中添加网址`Note: dont want redirect`

我有一个网址`www.example.com/index.html`

我想在“地址栏”上设置网址，例如`www.example.com/index/page2.html`

我用`document.location.hash = 'foo';`

`but it is add only # data like www.example.com/index.html#foo`

`note : i dont want to redirect only want to add url in address bar so don't answer document.location like that`

有什么解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:22:51.433

在这里阅读。

[http://badassjs.com/post/840846392/location-hash-is-dead-long-live-html5-pushstate](http://badassjs.com/post/840846392/location-hash-is-dead-long-live-html5-pushstate)

可能有帮助。

```
window.history.pushState('abc', "Title", "/new-url"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:35:45.150

做不到。这是一项安全功能，可让网站更难欺骗（例如，用于网络钓鱼攻击）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:44:34.880

我不确定您是否可以在不使用重定向的情况下执行此操作。

不过，这是实现目标的一种方法。

`www.example.com/index/page2.html`为包含一个框架的页面创建页面`www.example.com/index.html`

如果不在框架内，则将 `www.example.com/index.html`用户重定向到。`www.example.com/index/page2.html``www.example.com/index.html`

# android - 升级应用时更改目标版本和其他功能

> ID：10755818
> 
> 赞同：0
> 
> 时间：2012-05-25T14:04:52.373
> 
> 标签：android, permissions

我正在开发一个应用程序，我会把它放在谷歌游戏中。

我想在未来的升级中实现其他功能。

此升级可能会更改我的应用程序的目标版本，或者例如具有推送通知。

我想知道的是，当我发布升级时，android 是否允许开发人员更改此功能？

它如何适用于新权限等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:12:04.537

您只需将该通知权限添加到您的清单，增加构建版本并构建并上传到 google play，这不会有任何问题。

额外的权限将在用户安装应用程序时显示给他们。

提示：将您的签名密钥保存在安全的地方。在升级应用程序时，您将一直需要它。

# c# - 使用 LINQ 从两个 IEnumerable 中进行选择

> ID：10755821
> 
> 赞同：1
> 
> 时间：2012-05-25T14:04:53.120
> 
> 标签：c#, .net, linq, entity-framework

这似乎很容易，但我无法集中注意力。
假设我有 2 个这样定义的类：

```
class Class1
{
    public int Document;
    public decimal Amount;
}

class Class2
{
    public string Document;
    public decimal Amount;
} 
```

有定义`IEnumerable<Class1> result1`和`IEnumerable<Class2> result2`填充数据。

我有这样定义的第三个类：

```
class ResultClass
{
    public string Document;
    public decimal? AmountFromClass1;
    public decimal? AmountFromClass2;
} 
```

我想要一个 LINQ 查询，它从第一个结果中选择一些字段，从第二个结果中选择一些字段，并将它们放入定义为`List<ResultClass> result`.
例如，如果我有这样`result1`填充的第一个结果 ()：

```
 Document    Amount
     1         1.55
     2         2.55 
```

第二个结果 ( `result2`) 填充如下：

```
 Document    Amount
   "d-1"        1.22
   "d-2"        2.22 
```

我希望最终`result`填充这样的内容（顺序无关紧要）：

```
 Document    AmountFromClass1    AmountFromClass2
    "1"             1.55                null
   "d-1"            null                1.22
    "2"             2.55                null
   "d-2"            null                2.22 
```

目前，我使用两个`foreach`语句来执行此操作，如下所示：

```
List<ResultClass> result = new List<ResultClass>();

foreach (var o in result1)
    result.Add(new ResultClass 
    { 
        Document = o.Document.ToString(), 
        AmountFromClass1 = o.Amount, 
        AmountFromClass2 = null 
    });

foreach (var o in result2)
    result.Add(new ResultClass 
    { 
        Document = o.Document, 
        AmountFromClass1 = null, 
        AmountFromClass2 = o.Amount 
    }); 
```

但我想使用 LINQ 来做到这一点。
是否可以？

**编辑：完善问题** （还添加了*实体框架*标签）
由于这只是一个代码示例，我知道在单个 LINQ 语句中执行此操作可能没有真正的好处，因为它会这样做。
但是，我正在寻找性能改进，`result1`实际上`result2`是来自 LINQ-to-Entities 的 IQueryables，在某种程度上，我可以这样做：

```
List<ResultClass> MyFunc()
{
    Database DB = new Database(); // object context
    var result1 = DB.Class1s.Where(...);
    var result2 = DB.Class2s.Where(...);
    return SomeMagic()
        .Select(x => new ResultFunc { ... })
        .ToList();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:10:07.220

将两个集合中的每个项目投影到一个`ResultClass`对象并连接两个结果枚举：

```
var query1 = from o in result1
             select new ResultClass
             {
                 Document = o.Document.ToString(),
                 AmountFromClass1 = o.Amount
             };

var query2 = from o in result2
             select new ResultClass
             {
                 Document = o.Document,
                 AmountFromClass2 = o.Amount
             };

var result = query1.Concat(query2).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:16:41.570

这是你转换成 LINQ 的代码

```
var result = result1
  .Select(c => new ResultClass() { Document = c.Document.ToString(), AmountFromClass1 = c.Amount })
  .Concat(result2.Select(c => new ResultClass() { Document = c.Document, AmountFromClass2 = c.Amount }))
  .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:16:45.283

根据您需要的输出，似乎您需要一个 Union

```
 var class1 = new List<Class1>();
        var class2 = new List<Class2>();
        class1.Add(new Class1 (){Document=1, Amount = 1.0M});
        class1.Add(new Class1 (){Document=2, Amount = 1.0M});
        class2.Add(new Class2 (){Document="1", Amount = 1.0M});
        class2.Add(new Class2 (){Document="3", Amount = 1.0M});
            var result = class1.Select(x=> new ResultClass{Document = x.Document.ToString(), AmountFromClass1=x.Amount, AmountFromClass2 = null}).Union(
                            class2.Select(x=> new ResultClass{Document = x.Document, AmountFromClass2=x.Amount, AmountFromClass1 = null})   ); 
```

如果您想要交叉连接，那么您可以使用带有多个 from 子句的查询语法。[例子](https://stackoverflow.com/questions/4076319/linq-cross-join-query-for-nested-list)

# apache - .htaccess 重定向[强制除 index.php 的 www]

> ID：10755822
> 
> 赞同：0
> 
> 时间：2012-05-25T14:04:53.947
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, conditional-statements

我正在尝试根据这种情况进行 htaccess 重定向：

将所有没有“www”的页面重定向`http://siteweb.com`到`http://www.siteweb.com/index.html` 除`http://siteweb.com/index.php`

`http://siteweb.com/index.php`必须重定向到`http://www.siteweb.com/index.php`

实际上我使用这段代码[但它有问题：s]

```
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule !^/index.php$ http://www.%{HTTP_HOST}/$1 [R=301,L]

RewriteCond %{REQUEST_URI} ^/index\.php$ [NC]
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1 [R=301,L] 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:20:13.880

您可以在 .htaccess 中使用此代码：

```
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule (?!^index\.php$)^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L,NC] 
```

这会将所有 URI 重定向`index.php`到带有`www`. 但是，您的问题令人困惑，因为您还写道：

`The http://siteweb.com/index.php must to be redirected To http://www.siteweb.com/index.php`

这告诉我，您可能希望将每个 URI 重定向`index.php`到带有`www`.

# zend-framework - 引导程序和 index.php

> ID：10755823
> 
> 赞同：0
> 
> 时间：2012-05-25T14:05:00.090
> 
> 标签：zend-framework

谁能告诉我zend 框架中的**Bootstrap.php**和**index.php**文件有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:40:10.390

在`index.php`你只设置`Zend_Application`运行。这意味着`include_path`s、`require_once`s`application.ini`等。

在`Bootstrap.php`您已经“内部”运行的应用程序中。这是设置更具体的资源（数据库、缓存、插件...）的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:42:12.807

`index.php`用于设置路径和配置您的环境。

`Bootstrap.php`用于加载特定于应用程序的内容，例如数据库、语言环境或其他内容。

# java - EntityManager 不坚持合并，当刷新时我得到一个无法初始化代理 - 没有抛出会话

> ID：10755826
> 
> 赞同：0
> 
> 时间：2012-05-25T14:05:06.990
> 
> 标签：java, hibernate, seam2

我的应用程序是用 Seam(2.2.1.CR2) 编写的，在最近的一次更新中，我为我的用户实体实现了一个名为 points 的字段。这个字段应该包含从许多其他字段和操作聚合的点，所以由于我有一个包含大量用户的数据库，我认为动态更新这些用户是个好主意。我通过将 User 实体中的新列分配给 -1 来做到这一点，然后每当调用 getPoints 时抛出一个事件并更新点，但只有一次。

```
@Entity(name = "User")
public class User {

@Column(nullable = false, columnDefinition = "int(11) default -1")
    private int points;

public int getPoints() {
        if (points == -1) {
            Events.instance().raiseEvent(AppreciatedInitialUpdate.EVENT_NAME, this);
        }
        return points;
    }
} 
```

然后我创建了一个pointsBean：

```
@Name("pointsBean")    
@AutoCreate
public class PointsBean implements Serializable, AppreciatedInitialUpdate {

    @Logger
    private Log log;

    @In
    EntityManager entityManager

    @Observer(AppreciatedInitialUpdate.EVENT_NAME)
    public void handleAppreciatedInitialUpdate(User User) {
        this.calculateInitialPoints(user);
    }

    private void calculateInitialPoints(User user) {

        int likes = 0;

        List<Flag> appreciateFlags = user.getAppreciateFlags();
        likes = appreciateFlags.size();

        user.setLikes(likes);
        entityManager.merge(user);
        log.info("Initial update of points for user " + user.getId() + ". Now he/she has " + points);
    }           
} 
```

但是正如我的标题所述，当这样做时，实体不会持久化，如果我刷新，那么我会得到一个异常：

```
[org.hibernate.LazyInitializationException] could not initialize proxy - no Session
org.hibernate.LazyInitializationException: could not initialize proxy - no Session
    at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:62)
    at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:116)
    at org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:166) 
```

我可能在这里遗漏了一些重要的东西。我究竟做错了什么？

// 雅各布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:26:41.003

可能该`user`变量是在较旧的会话中从数据库中检索到的，该会话已经关闭，因此当您调用 时`user.getAppreciateFlags();`，这可能是一个 LAZY 数据库引用，它会尝试从数据库中检索它们，并且由于会话已关闭，因此会发生该错误.

一种快速修复（不确定它是否是最好的）是在`getAppeciateFlags`调用之前将用户合并到会话中，因此代码将是：

```
entityManager.merge(user);
List<Flag> appreciateFlags = user.getAppreciateFlags();
likes = appreciateFlags.size();
user.setLikes(likes); 
```

# python - 如何在 Heroku 中使用 Flask/Peewee？

> ID：10755833
> 
> 赞同：5
> 
> 时间：2012-05-25T14:05:26.613
> 
> 标签：python, postgresql, deployment, heroku, flask

我正在尝试将[Flask](http://flask.pocoo.org/)应用程序部署到[Heroku](http://www.heroku.com/)。我使用[Peewee](http://peewee.readthedocs.org/en/latest/)作为 Postgres 数据库的 ORM。当我按照[标准 Heroku 步骤部署 Flask](https://devcenter.heroku.com/articles/python)时，进入后 Web 进程崩溃`heroku ps:scale web=1`。以下是日志所说的：

```
Starting process with command `python app.py`
/app/.heroku/venv/lib/python2.7/site-packages/peewee.py:2434: UserWarning: Table for <class 'flask_peewee.auth.User'> ("user") is reserved, please override using Meta.db_table
cls, _meta.db_table,
Traceback (most recent call last):
File "app.py", line 167, in <module>
auth.User.create_table(fail_silently=True)
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 2518, in create_table if fail_silently and cls.table_exists():
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 2514, in table_exists return cls._meta.db_table in cls._meta.database.get_tables()
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 507, in get_tables ORDER BY c.relname""")
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 313, in execute cursor = self.get_cursor()
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 310, in get_cursor return self.get_conn().cursor()
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 306, in get_conn self.connect()
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 296, in connect self.__local.conn = self.adapter.connect(self.
database, **self.connect_kwargs)
File "/app/.heroku/venv/lib/python2.7/site-packages/peewee.py", line 199, in connect return psycopg2.connect(database=database, **kwargs)
File "/app/.heroku/venv/lib/python2.7/site-packages/psycopg2/__init__.py", line 179, in connect connection_factory=connection_factory, async=async)
psycopg2.OperationalError: could not connect to server: No such file or directory
Is the server running locally and accepting connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?
Process exited with status 1
State changed from starting to crashed 
```

我尝试了很多不同的方法来让 Heroku 允许我的应用程序与 Postgres 数据库通信，但没有任何运气。是否有捷径可寻？我需要做什么来配置 Flask/Peewee 以便我可以在 Heroku 上使用数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-07-23T16:31:46.073

根据[Peewee 文档](http://docs.peewee-orm.com/en/latest/peewee/database.html?highlight=postgres#dynamically-defining-a-database)`Proxy()`，除非您的本地数据库驱动程序与远程驱动程序不同（即本地，您正在使用 SQLite，而远程您正在使用 Postgres），否则您不想使用。但是，如果您在本地和远程都使用 Postgres，则更改要简单得多。在这种情况下，您只需在运行时更改连接值（数据库名称、用户名、密码、主机、端口等），而无需使用`Proxy()`.

Peewee 有一个[用于数据库连接的内置 URL 解析器](http://docs.peewee-orm.com/en/latest/peewee/playhouse.html#database-url)。以下是如何使用它：

```
import os
from peewee import *
from playhouse.db_url import connect

db = connect(os.environ.get('DATABASE_URL'))

class BaseModel(Model):
    class Meta:
        database = db 
```

在这个例子中，peewee 的`db_url`模块读取环境变量`DATABASE_URL`并解析它以提取相关的连接变量。然后它使用这些值创建一个`PostgresqlDatabase` [对象。](http://docs.peewee-orm.com/en/latest/peewee/api.html#PostgresqlDatabase)

在本地，您需要设置`DATABASE_URL`为环境变量。您可以根据您使用的任何外壳的说明执行此操作。或者，如果您想使用 Heroku 工具链（使用 启动本地服务器`heroku local`），您可以将其添加到[项目顶层](https://devcenter.heroku.com/articles/heroku-local#set-up-your-local-environment-variables)[调用的文件`.env`](https://devcenter.heroku.com/articles/heroku-local#set-up-your-local-environment-variables)中。对于远程设置，您需要[将数据库 URL 添加为远程 Heroku 环境变量](https://devcenter.heroku.com/articles/config-vars#setting-up-config-vars-for-a-deployed-application)。您可以使用以下命令执行此操作：

```
heroku config:set DATABASE_URL=postgresql://myurl 
```

您可以通过进入 Heroku、导航到您的数据库并单击“数据库凭据”来找到该 URL。它列在 下`URI`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-21T20:31:31.153

heroku 配置：设置 HEROKU=1

```
import os
import urlparse
import psycopg2
from flask import Flask
from flask_peewee.db import Database

if 'HEROKU' in os.environ:
    DEBUG = False
    urlparse.uses_netloc.append('postgres')
    url = urlparse.urlparse(os.environ['DATABASE_URL'])
    DATABASE = {
        'engine': 'peewee.PostgresqlDatabase',
        'name': url.path[1:],
        'user': url.username,
        'password': url.password,
        'host': url.hostname,
        'port': url.port,
    }
else:
    DEBUG = True
    DATABASE = {
        'engine': 'peewee.PostgresqlDatabase',
        'name': 'framingappdb',
        'user': 'postgres',
        'password': 'postgres',
        'host': 'localhost',
        'port': 5432 ,
        'threadlocals': True
    }

app = Flask(__name__)
app.config.from_object(__name__)
db = Database(app) 
```

修改了 coleifer 的回答以回答 hasenj 的评论。请将其中之一标记为已接受的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T14:58:39.277

你在解析 DATABASE_URL 环境变量吗？它看起来像这样：

```
postgres://username:password@host:port/database_name 
```

因此，您需要在打开与数据库的连接之前将其拉入并解析它。根据您声明数据库的方式（在您的配置中或在您的 wsgi 应用程序旁边），它可能如下所示：

```
import os
import urlparse

urlparse.uses_netloc.append('postgres')
url = urlparse.urlparse(os.environ['DATABASE_URL'])

# for your config
DATABASE = {
    'engine': 'peewee.PostgresqlDatabase',
    'name': url.path[1:],
    'password': url.password,
    'host': url.hostname,
    'port': url.port,
} 
```

请参阅此处的注释：[https ://devcenter.heroku.com/articles/django](https://devcenter.heroku.com/articles/django)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-17T15:38:48.727

我已经设法让我的 Flask 应用程序使用 Peewee 使用以下代码在 Heroku 上工作：

```
# persons.py

import os
from peewee import *

db_proxy = Proxy()

# Define your models here
class Person(Model):
    name = CharField(max_length=20, unique=True)
    age  = IntField()

    class Meta:
        database = db_proxy

# Import modules based on the environment.
# The HEROKU value first needs to be set on Heroku
# either through the web front-end or through the command
# line (if you have Heroku Toolbelt installed, type the following:
# heroku config:set HEROKU=1).
if 'HEROKU' in os.environ:
    import urlparse, psycopg2
    urlparse.uses_netloc.append('postgres')
    url = urlparse.urlparse(os.environ["DATABASE_URL"])
    db = PostgresqlDatabase(database=url.path[1:], user=url.username, password=url.password, host=url.hostname, port=url.port)
    db_proxy.initialize(db)
else:
    db = SqliteDatabase('persons.db')
    db_proxy.initialize(db)

if __name__ == '__main__':
    db_proxy.connect()
    db_proxy.create_tables([Person], safe=True) 
```

您应该已经将 Postgres 数据库插件附加到您的应用程序。您可以通过命令行或 Web 前端执行此操作。假设数据库已经附加到您的应用程序并且您已经部署了上述更改，请登录到 Heroku 并创建表：

```
$ heroku login
$ heroku run bash
$ python persons.py 
```

检查表是否已创建：

```
$ heroku pg:psql
your_app_name::DATABASE=> \dt 
```

然后在另一个 Python 脚本（例如请求处理程序）中导入此文件（本例中为 persons.py）。您需要显式管理数据库连接：

```
# server.py

from flask import g
from persons import db_proxy

@app.before_request
def before_request():
    g.db = db_proxy
    g.db.connect()

@app.after_request
def after_request(response):
    g.db.close()
    return response

… 
```

参考：

*   [https://devcenter.heroku.com/articles/heroku-postgresql](https://devcenter.heroku.com/articles/heroku-postgresql)
*   [http://peewee.readthedocs.org/en/latest/peewee/database.html#dynamically-defining-a-database](http://peewee.readthedocs.org/en/latest/peewee/database.html#dynamically-defining-a-database)
*   [http://peewee.readthedocs.org/en/latest/peewee/example.html#establishing-a-database-connection](http://peewee.readthedocs.org/en/latest/peewee/example.html#establishing-a-database-connection)
*   [https://stackoverflow.com/a/20131277/3104465](https://stackoverflow.com/a/20131277/3104465)
*   [https://gist.github.com/fprieur/9561148](https://gist.github.com/fprieur/9561148)

# sql - 具有多个外键链接到同一个主表的表 (2)

> ID：10755834
> 
> 赞同：3
> 
> 时间：2012-05-25T14:05:27.663
> 
> 标签：sql

只是为了扩展我之前的问题 - 我的数据库中有两个表，我想提取某些信息。下表：

```
 (player): player_id (primary), playerName
    (match): match_id (primary), playerID1, playerID2, playerID3, scorer etc.. 
```

您向我提供了以下代码来获取玩家的姓名：

```
SELECT p.Name 
FROM `match` m
INNER JOIN `player` p 
    ON p.player_id IN (m.playerID1, m.playerID2, m.playerID3) //etc 
```

工作得很好，谢谢 - 我只想做两个调整：

1.  我想返回得分手的姓名以及球员姓名。由于 m.scorer 是一个 ID，如果 p.Name 已经被映射到 m.playerID，我如何将它映射到 p.Name 属性？
2.  上面的查询返回所有玩家的名字。我将很快添加一个搜索功能，您可以在其中搜索某个球员的所有比赛。是否有从结果中排除该球员（正如我们已经知道该球员在他被搜索时在比赛中）。所以几乎返回所有比赛，以及某个球员的其他球员，但从结果中排除实际搜索的球员。抱歉，如果不清楚，请告诉我，我将对此进行扩展。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:07:25.013

尝试以下操作（假设字段名称）。它将向您显示球员的姓名、比赛的 matchId 以及他们是否在那场比赛中得分:)。

```
SELECT p.Name as 'Player Name', m.matchId as 'Match Id',
CASE s.scorerId WHEN ISNULL(S.SCORERID,0) THEN 'YES' ELSE 'NO' END as 'Scored?',
s.name as 'Scorer Name' --as requested from comment
FROM match m
INNER JOIN player p ON p.player_id IN (m.playerID1, m.playerID2, m.playerID3)
LEFT JOIN scorer s ON s.matchId = m.matchId
    AND s.player_id IN (m.playerID1, m.playerID2, m.playerID3) 
```

[在此处](http://sqlfiddle.com/#!3/35fb2/1)查看此 SQLFiddle

# jsp - tomcat - 他们以前运行的类仍然加载在内存中

> ID：10755836
> 
> 赞同：6
> 
> 时间：2012-05-25T14:05:40.637
> 
> 标签：jsp, tomcat, servlets, memory-leaks

当停止我的项目时，tomcat 说：

以下 Web 应用程序已停止（重新加载、取消部署），但它们之前运行的类仍加载到内存中，从而导致内存泄漏（使用分析器确认）。

我们在哪里发现哪些类留在内存中？

请帮我 。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-25T14:28:58.837

您可以运行`jmap -histo`它将显示您加载的类。

例如：

```
jmap -histo[:live] <pid>
    to connect to running process and print histogram of java object heap
    if the "live" suboption is specified, only count live objects

Example: jmap -dump:live,format=b,file=heap.bin <pid> 
```

另一种方法是启用类加载调试信息并执行一些脚本来检测剩余加载的内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-25T20:08:39.450

发生这种情况时，通常内存中有一些东西将 WebappClassLoader（负责为 webapp 实例加载类的类加载器）“固定”到内存中。如果您多次重新加载您的 web 应用程序，您将能够看到每次执行重新加载时 WebappClassLoader 实例的数量都会增加 1。这通常*不是*Tomcat 中的泄漏，而是直接在您的 web 应用程序代码中的泄漏、您使用的库中的泄漏，或者由一些执行愚蠢操作的特定 Java API 调用触发的泄漏。

首先，请阅读： http: [//people.apache.org/~markt/presentations/2010-11-04-Memory-Leaks-60mins.pdf](http://people.apache.org/~markt/presentations/2010-11-04-Memory-Leaks-60mins.pdf)。这是对正在发生的事情的一个很好的描述。

其次，使用分析器来确定对 WebappClassLoader 加载的对象的引用。很多时候，只需使用 ServletContextListener 就可以在 webapp 停止时清理这些引用。

第三，如果您发现您使用的库有泄漏，请让他们知道。如果您发现来自 JRE 中的类的泄漏，请查看使用 JreMemoryLeakPreventionListener 的选项：http: [//tomcat.apache.org/tomcat-6.0-doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener_-_org.apache .catalina.core.JreMemoryLeakPreventionListener](http://tomcat.apache.org/tomcat-6.0-doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener_-_org.apache.catalina.core.JreMemoryLeakPreventionListener)。如果您找到的任何内容都没有选项，请前往 Tomcat 用户并告诉我们缺少的内容：我们将添加它。

# windows - crossdomain.xml Windows Azure 的位置

> ID：10755837
> 
> 赞同：0
> 
> 时间：2012-05-25T14:05:42.590
> 
> 标签：windows, azure, unity3d

我需要在我的 Windows Azure Web 角色中放置一个 crossdomain.xml 文件。但是哪里 ？

我试图把它放在：F:\sitesroot\0

但是我的 Unity3D Web 应用程序说：异常：无法连接，因为没有找到有效的跨域策略。我不知道我错过了什么。Unity 默认使用端口 (843)。

将 crossdomain.xml 放在哪里

欢迎任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:38:29.733

CrossDomainPolicy.xml 必须位于应用程序的根目录。

如果您使用单个 Web 角色，只需在应用程序的根目录中添加 CrossDomainPolicy.xml 并正确设置，如下所示：

![在此处输入图像描述](../Images/dc35b39a9e09fc3de25badee2acb222d.png)

取决于您在角色的 ServiceDefinition.csdef 中有多少“站点”部分，您将获得那么多 \sitesroot\0 和 \sitesroot\1 并且 CrossDomainPolicy.xml 将分发给所有取决于您的角色解决方案设置。

一旦我在以下博客中讨论过这个问题： [Silverlight front end calls to WCF Service，all in one Windows Azure Web Role Sample](http://blogs.msdn.com/b/avkashchauhan/archive/2011/11/29/silverlight-front-end-calling-to-wcf-service-all-in-one-windows-azure-web-role-sample.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T00:32:23.503

您提到了 843 端口，听起来它需要 Flash 协议，它是端口 843 上的 TCP 套接字侦听器，当它接收到 text 时会以跨域策略进行响应`<policy-file-request/>`。你需要这样做吗？您的应用程序使用套接字吗？

如果您只需要通过 Web 应用程序的端口 80 提供 XML 文件的位置，Avkash 的答案是正确的，但如果您需要执行原始套接字，则需要在处理该问题的服务器上运行某些东西。

# php - 乳胶不能在 php exec() 中工作

> ID：10755838
> 
> 赞同：1
> 
> 时间：2012-05-25T14:05:43.527
> 
> 标签：php, apache, ubuntu, latex, file-permissions

我正在尝试在 Ubuntu10.04 的 Apache2 中的 PHP 中调用 Latex，例如

```
$output  = exec("latex ".$filename, $return_var); 
```

但它不起作用，并输出：

```
...
 [2] => ! I can't write on file `report.log'.
... 
```

我可以调用 file_put_contents() 在该文件夹中写入文件，并且我已将自己添加到组 www-data。

此外，我可以在终端中使用“latex report.tex”作为“www-data”；并且 PHP exec('whoami') 返回 'www-data'。而且，该文件夹和report.tex 的权限是'777'。

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-26T02:39:51.187

当*report.log*文件存在并由您作为用户创建时会发生这种情况。PHP 本身在系统中有自己的个人用户，`_www`当 PHP 开始执行`exec()`命令时，系统没有权限`_www`重写日志文件。

# jquery - Firefox 页面刷新时忘记了动态类

> ID：10755843
> 
> 赞同：0
> 
> 时间：2012-05-25T14:05:53.850
> 
> 标签：jquery, css, firefox

我已经编写了一些 jQuery，一旦用户在页面上滚动超出它，它就会修复一个子菜单。jQuery 更改子菜单上的类以使其固定。这一切都很好，除了一种情况，那就是如果我在 Firefox 中刷新页面 - 我在任何其他浏览器中都没有遇到这个问题。

```
$(function(){
    var menu = $('#submenu_wrapper'),
        pos = menu.offset();
        $(window).scroll(function(){
            if($(this).scrollTop() >= pos.top-57 && menu.hasClass('')){
                menu.addClass('fixed');
                $('.content_push').css({"height":"109px"});
            } else if($(this).scrollTop() <= pos.top-57 && menu.hasClass('fixed')){
                menu.removeClass('fixed');
                $('.content_push').css({"height":"57px"});
            }
        });
}); 
```

我是否可以进行一些更改，以便在刷新页面时 Firefox 将保留更改后的类状态？我见过类似的固定菜单行为设法做到这一点，但似乎无法弄清楚如何。[例如， Twitter Bootstrap 站点](http://twitter.github.com/bootstrap/javascript.html)，如果您访问 Javascript 部分，就会执行此操作。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:06:56.380

不，重新加载后，脚本所做的任何修改都消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:10:40.420

我认为盗贼大师是正确的。令我惊讶的是，其他浏览器的行为不同。

作为一种解决方法，在显示子菜单时添加一个 URL 片段（使用 #），并在页面加载时检查该片段，如果存在，则运行显示子菜单的脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:10:55.460

唯一想到的是将值存储在 cookie 中，并根据刷新时此 cookie 的值，将适当的类应用于元素。

# cakephp - 为什么 saveAll() 只保存最后一条记录？

> ID：10755847
> 
> 赞同：5
> 
> 时间：2012-05-25T14:06:12.620
> 
> 标签：cakephp, cakephp-1.3

我有一种情况，由于外部原因，我必须直接保存连接记录，而不是将它们保存为连接的一部分。这就是我的意思：

*   我有一个`Firm`模型，其数据是从外部来源提取的。
*   `County`我的应用数据库中有一个模型
*   我有一个`counties_firms`连接表，用于将这些外部公司与县关联起来。

由于生活在哪里，我没有编辑`Firm`模型，也没有编辑`County`模型。我真的只是在编辑关联。我有一个`Firm`模型来封装我需要对公司数据做的任何事情，其中​​一种方法是`Firm::saveCounties( $data )`. 它：

*   接受包含公司 ID 和应关联的县 ID 的传入数据。
*   删除该县的所有现有连接记录
*   *尝试*保存所有新的连接记录。

我发现只有最后一个县记录被保存。这是传入的数据：

```
Array
(
    [0] => Array
        (
            [firm_id] => 13
            [county_id] => 4fa16e24-a25c-4523-8a9e-7d1d147402e8
        )

    [1] => Array
        (
            [firm_id] => 13
            [county_id] => 4fa16e27-ccd0-4f22-97da-7d1d147402e8
        )

    [2] => Array
        (
            [firm_id] => 13
            [county_id] => 4fa16e4a-68f8-4fb1-95bb-7d1d147402e8
        )

) 
```

鉴于这些数据，我正在创建 和 之间的动态关联`Firm`，`CountiesFirm`并试图`$this->CountiesFirm->saveAll( $data )`.

正如我所提到的，在这个例子中只有最后 3 个县协会得到了保存。知道我可能会错过什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-14T11:55:13.150

你的数组很好。模型似乎没有清除其 id，您可以尝试将 ['id'] => null 添加到数组中的每条记录以强制清除模型 id。

这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T13:19:44.300

我相信你的数组中缺少一个级别......它应该看起来更像这样......

```
Array(
    'CountiesFirm' => array(
        [0] => Array
        (
            [firm_id] => 13
            [county_id] => 4fa16e24-a25c-4523-8a9e-7d1d147402e8
        )
        [1] => Array
        (
            [firm_id] => 13
            [county_id] => 4fa16e27-ccd0-4f22-97da-7d1d147402e8
        )
        [2] => Array
        (
            [firm_id] => 13
            [county_id] => 4fa16e4a-68f8-4fb1-95bb-7d1d147402e8
        )
    )
) 
```

试试看，让我知道你的结果

# string - 如何在 Haskell 中连接两个（IO）字符串？

> ID：10755852
> 
> 赞同：22
> 
> 时间：2012-05-25T14:06:34.217
> 
> 标签：string, haskell, concat

我知道这听起来很简单，但我没能将两个字符串组合成一个新字符串。

来自 gtk 条目的 IO 字符串“a”由

```
 a <- (entryGetText text_field) 
```

目标是将其组合为：

newstring = "文本："+a

有什么想法可以实现吗？谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-25T14:08:53.003

使用字符串连接：

```
 do a <- entryGetText text_field
    let b = "Text:" ++ a
    return b 
```

更简单地说：

```
 do a <- entryGetText text_field
    return $ "Text:" ++ a 
```

你也可以玩游戏：

```
 ("Text:" ++) <$> (entryGetText text_field) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-25T14:07:07.167

我相信在 Haskell 中，字符串连接运算符是`++`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-25T14:10:20.880

当您将赋值运算符`x <- expr`与某个 monad 一起使用时，`expr :: m a`它不是 an而是 an 。在您的情况下，该变量具有 type而不是，因此您可以像在纯代码中那样将其连接起来，例如.`m``x``m a``a``a``String``IO String``"hello world " ++ a`

# c# - linq-to-sql null 或默认值

> ID：10755854
> 
> 赞同：0
> 
> 时间：2012-05-25T14:06:37.083
> 
> 标签：c#, linq-to-sql

我有一个看起来像这样的查询：

```
var TheQuery = (from....
               where x.TheDate >= StartDate && x.TheDate <= EndDate
               select new MyModel()
               {
                   Total = (int?)x.Count() ?? 0,
                   ....
               }).Single(); 
```

基本上，我正在查询基于 2 个日期之间的许多记录。如果日期有 0 个值，则返回 0 作为总计。但是，如果根本没有值，它会返回 null 并崩溃。我可以添加`.SingleOrDefault()`，但它会返回 null 而不是用 0 填充的 MyModel。属性 Total 定义为 int。

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:14:52.773

Count 有一个谓词的重载，当没有项目与谓词匹配时返回 0

```
 var result = new MyModel {
                          Total = <yourDataSource>
                            .Count(x.TheDate >= StartDate && x.TheDate <= EndDate)
                          }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:08:15.113

```
if(TheQuery !=null || TheQuery .Count()>0){
 //do something you wanna do 
```

}

或者

```
 var v = TheQuery.ToList(); 
```

现在检查

```
if (v.Count > 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:14:55.223

你应该选择：

```
int count = (from x in ...
where x.TheDate >= StartDate && x.TheDate <= EndDate
select c).Count(); 
```

那就是你想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T14:15:23.707

```
var TheQuery = (from....
               where x.TheDate >= StartDate && x.TheDate <= EndDate
               select new MyModel()
               {
                   Total = (int?)x.Count() ?? 0,
                   ....
               }).DefaultIfEmpty(0).Single()' 
```

# firefox - 火狐插件更新

> ID：10755863
> 
> 赞同：0
> 
> 时间：2012-05-25T14:07:08.970
> 
> 标签：firefox, firefox-addon

我有第二生命插件的源代码可以在浏览器中播放，但问题是它是为 Firefox 3.5 创建的，所以我想做的是让它加速并将其升级到当前的 Firefox。

不幸的是，我不确定如何解决这个问题，因为我现在只是在研究这个问题，非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:58:14.987

你在这里的主要目的是什么？您是否有兴趣在最新的 Firefox 中以某种方式简单地使扩展工作，或者您对优化性能更感兴趣？

应用程序的优化是一个非常普遍的话题。[您可以查看Gecko](https://developer.mozilla.org/en/Gecko)在最新版本中进行的升级。如果 Gecko 现在似乎有任何特定模块为其提供更好的接口/兼容性，您可以尝试调整相同的模块。再次，这确实是程序员的判断力和技能，让他在可行和不可行的开发之间划出了界限。对于与许多其他模块广泛链接的模块，最好保留它以避免不眠之夜（当然这只是我的观点。对于某些人来说，这是真正的踢:D）。

如果您对创建高性能插件感兴趣，不妨试试[Google Web Toolkit 。](https://developers.google.com/web-toolkit/)它是一个 Java 库，可将 java 编译成优化的 javascript，引入各种面向性能的怪癖。我了解将整个应用程序轻松切换到 GWT 是不可能的，而且现在对您没有帮助，但我认为值得一提，以备将来使用。

另一方面，如果您只是对使扩展工作感兴趣，您可以查看[Nightly Tester Tools](https://addons.mozilla.org/en-US/firefox/addon/nightly-tester-tools/)，这是一个用于覆盖添加兼容性的扩展。

# coffeescript - 使用hubot检测用户何时离开或进入频道

> ID：10755865
> 
> 赞同：11
> 
> 时间：2012-05-25T14:07:12.307
> 
> 标签：coffeescript, irc, hubot

我试图让 Hubot 检测用户何时进入或离开频道，但到目前为止，我实际上无法找到与此相关的任何信息。

有谁知道如何做到这一点？:)

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T02:08:06.380

Hubot 的`Robot`类具有函数`enter`，当*任何*用户进入或离开房间时，`leave`它会触发你给出的回调。该回调采用 a ，它具有type的属性，而后者又具有type的属性。*`Response``message``Message``user``User`*

 *```
module.exports = (robot) ->
   robot.enter (response) ->
     # at this point you can get the user's name with:
     # response.message.user.name
     # works the same for robot.leave 
```

但是，[hubot](https://github.com/nandub/hubot-irc/pull/26)的 IRC 适配器目前似乎没有触发使这些功能正常工作所需的消息。*

# git - Github 如何检测镜像仓库？

> ID：10755869
> 
> 赞同：6
> 
> 时间：2012-05-25T14:07:19.830
> 
> 标签：git, github

在此处查看 Github 存储库：

[https://github.com/apache/](https://github.com/apache/)

它们被标记为镜像，甚至提到了源镜像 URL。

我也想做同样的事情（在 Github 上镜像一些 SVN/Git/Mercurial 存储库），但是当我按照镜像方式执行[此](http://exyr.org/2011/git-mirrors/)操作[时](http://jnrbsn.com/2010/11/how-to-mirror-a-subversion-repository-on-github)，我的存储库不会被标记为镜像。它们显示为普通存储库。

那么这里的诀窍是什么？这是您必须在 Github 上支付的一些特殊功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T18:17:23.590

“标记为镜像”的东西是 github 功能，而不是 git 功能。大概他们有一些内部框架，可以更轻松地管理所有镜像。你不能在他们的服务器上运行代码，所以你不能以同样的方式管理镜像。

# javascript - Javascript - 迭代对象的属性并更改它们

> ID：10755873
> 
> 赞同：1
> 
> 时间：2012-05-25T14:07:49.827
> 
> 标签：javascript, jquery

我希望遍历对象的属性并将它们全部更改为包括`""`存储在其中的值。此对象被传递给 REST 调用，并且必须强制执行上述格式。我更喜欢`""`在中央位置处理添加，而不是在分配实际值时（代码非常复杂且冗长）。

我知道您可以轻松地遍历对象的属性：

```
$.each(queryOptions, function(obj){console.log(obj)}) 
```

但是，我可以以某种方式获取对实际属性的引用并在迭代中设置它吗？

输入：

```
queryOptions.value1 = 1234;
queryOptions.value2 = "testing";
queryOptions.value3 = 555; 
```

期望的输出：

```
queryOptions.value1 = "1234";
queryOptions.value2 = ""testing"";
queryOptions.value3 = "555"; 
```

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T14:09:52.370

我同意 Pointy 的观点，这似乎是一个奇怪的要求。但如果它真的是一个要求：

使用[`$.each`](http://api.jquery.com/jQuery.each/)：

```
$.each(queryOptions, function(key) {
    queryOptions[key] = '"' + queryOptions[key] + '"';
}); 
```

或者只使用没有任何库内容的 JavaScript：

```
var key;
for (key in queryOptions) {
    if (queryOptions.hasOwnProperty(key)) {
        queryOptions[key] = '"' + queryOptions[key] + '"';
    }
} 
```

# android - Android：ICS 拼写检查不起作用

> ID：10755881
> 
> 赞同：1
> 
> 时间：2012-05-25T14:08:19.373
> 
> 标签：android

我刚刚在第一次运行 ICS 的物理设备上试用了我的应用程序，令我惊讶和沮丧的是，模拟器中带下划线的拼写错误单词的拼写检查不起作用。有问题的设备是 HTC One S。拼写更正似乎存在于其他应用程序中。在模拟器上运行时，它一直存在于我的应用程序中。

我没有发现任何迹象表明我需要打开任何东西才能使拼写检查工作，而且它在模拟器中工作但在真实设备中不起作用的事实非常令人担忧。还有什么我想念的吗？

# python - ctypes不会加载库

> ID：10755882
> 
> 赞同：2
> 
> 时间：2012-05-25T14:08:23.900
> 
> 标签：python, dll, ctypes

我查看了有关此主题的其他帖子，但我想知道是否有某种方法可以在不直接更改到库目录或显式指定绝对路径（例如通过 sys.path.append 或使用 PATH）的情况下执行此操作或 Windows 上的 CLASSPATH 环境变量。我现在要做的是加载“jvm.dll”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:23:21.223

如果有问题的 DLL 没有任何依赖关系，则可以通过将 ctypes 工厂传递给 DLL 的绝对路径来加载库（您可以根据需要确定）。但是，DLL 通常捆绑在一起并具有相互依赖关系。您最可靠的选择可能是添加 DLL 的包含目录，`os.environ['PATH']`以确保依赖的 DLL 可以由 OS 库加载器自动解析。请注意，如果您担心污染环境，您可以暂时执行此操作。

```
dll_dir = r'c:\foo\bar\path'
tmp = os.environ['PATH']
os.environ['PATH'] = dll_dir + ';' + tmp
ctypes.LoadLibrary( dll_name )
os.environ['PATH'] = tmp 
```

# css - 使用#ID 作为风格挂钩的充分理由

> ID：10755885
> 
> 赞同：0
> 
> 时间：2012-05-25T14:08:33.070
> 
> 标签：css

我读过这篇 [为什么在 CSS 中不推荐按 ID 选择？](https://stackoverflow.com/questions/8084555/why-selecting-by-id-is-not-recommended-in-css)

它提出了为什么你会使用类而不是 ID 的论据。并且许多开发人员对风格选择不以为然，根本拒绝使用 ID。

但是，我敢肯定，即使不是最有经验的开发人员，也有很多人仍然使用 ID 作为风格挂钩（同时偏爱类）。

有哪些可能的情况可以证明使用 ID 而不是类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:25:25.187

当您定位独特的项目（您不想重复使用该特定样式）时，您可以使用 id，例如`#header`, `#footer`.
另一个使用 id 的好理由可能是如果你是一个前端开发人员，也需要处理一些基本的 javascript。Javascript 通过 id 访问元素比通过其他链式类名快得多，因此出于性能原因，您（作为 js 开发人员）可能希望向您的小部件添加一个 id，以便您更快地访问该元素。
例如

```
#widget 
```

通过 js 访问比类似的东西更快更容易

```
.wrapper .container .sidebar .widget:nth-child(n) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:47:11.463

根据我的发现，尝试只使用类和属性选择器的人（不是所有人，而是大多数人）会弄乱他们的样式表。他们最终在所有东西上都放了一个类，然后有很长的选择器字符串试图移动一个特定的元素，这就是 ID 选择器的亮点。ID 被实现到 CSS 中是有原因的，如果使用得当，它们会很棒。

只需谨慎使用。

# sql - SQL 查询不起作用

> ID：10755887
> 
> 赞同：0
> 
> 时间：2012-05-25T14:08:39.140
> 
> 标签：sql, sql-server

我有这四个表：

```
SELECT [B_Key]
  ,[B_FiscalYear]
  ,[B_OrgCode]
  ,[B_SubObject]
  ,[B_Explanation]
  ,[B_CIPrefNo]
  ,[B_OrgBudgetAmt]
  ,[B_BudgetAmt]
  ,[B_Initials]
FROM [NAOLI].[dbo].[BudgetTbl]

SELECT [F_Fykey]
  ,[F_FiscalYear]
  ,[F_Year]
FROM [NAOLI].[dbo].[codeFiscalYearTbl]

SELECT [O_OrgKey]
  ,[O_OrgCode]
  ,[O_OrgDesc]
  ,[O_Divisions]
FROM [NAOLI].[dbo].[codeOrgCodeTbl]

SELECT [S_SubKey]
  ,[S_SubObject]
  ,[S_SubDescrip]
FROM [NAOLI].[dbo].[codeSubObjectTbl] 
```

我需要组合这些表格中的不同信息，以制作下面的信息表格：

```
 [B_FiscalYear]
  ,[O_OrgCode]
  ,[O_OrgDesc]
  ,[S_SubObject]
  ,[S_SubDescrip]
  ,[B_BudgetAmt]
  ,[B_Initials]
  ,[B_CIPrefNo]
  ,[B_OrgBudgetAmt] 
```

我尝试了下面的查询，但它返回了 20750 条记录中的 0 条。我该如何做到这一点？谢谢

```
SELECT [B_FiscalYear]
  ,[B_OrgCode]
  ,[O_OrgDesc]
  ,[B_SubObject]
  ,[S_SubDescrip]
  ,[B_BudgetAmt]
  ,[B_Initials]
  ,[B_CIPrefNo]
  ,[B_OrgBudgetAmt]

INTO dbo.BudgetsTbl
  FROM [BudgetTbl] BT, [codeFiscalYearTbl] FY, [codeOrgCodeTbl] OC, [codeSubObjectTbl] SO
WHERE BT.B_FiscalYear = FY.F_Year and BT.B_OrgCode = OC.O_OrgCode and BT.B_SubObject = SO.S_SubObject 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:26:09.543

连接应该是这样的：

```
SELECT [B_FiscalYear]
  ,[B_OrgCode]
  ,[O_OrgDesc]
  ,[B_SubObject]
  ,[S_SubDescrip]
  ,[B_BudgetAmt]
  ,[B_Initials]
  ,[B_CIPrefNo]
  ,[B_OrgBudgetAmt]
FROM BudgetTbl BT
JOIN codeFiscalYearTbl FY ON BT.B_FiscalYear = FY.F_Year
JOIN codeOrgCodeTbl OC ON BT.B_OrgCode = OC.O_OrgCode
JOIN codeSubObjectTbl SO ON BT.B_SubObject = SO.S_SubObject 
```

您可以查看[http://sqlfiddle.com/#!3/8ff6b/7](http://sqlfiddle.com/#!3/8ff6b/7)了解更多信息。如果需要，您也可以添加左连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:17:09.987

正确的连接语法是：

```
SELECT [B_FiscalYear], [B_OrgCode], [O_OrgDesc], [B_SubObject], [S_SubDescrip],
       [B_BudgetAmt], [B_Initials], [B_CIPrefNo], [B_OrgBudgetAmt]
INTO dbo.BudgetsTbl
FROM BudgetTbl BT join
     codeFiscalYearTbl FY
     on BT.B_FiscalYear = FY.F_Year  join
     codeOrgCodeTbl OC
     on BT.B_OrgCode = OC.O_OrgCode join
     codeSubObjectTbl SO
     on BT.B_SubObject = SO.S_SubObject 
```

大概，您的一个或多个查找表是空的。如果您想要所有行，请将上述查询中的“join”替换为“left outer join”。

# java - @InjectMocks 在 Java 6 和 7 中表现不同

> ID：10755890
> 
> 赞同：11
> 
> 时间：2012-05-25T14:08:52.917
> 
> 标签：java, mockito, java-7, type-erasure, java-6

通过一个非常简单的 Mockito 运行 JUnit 测试和类，当使用 Java 1.6.0_32 和 Java 1.7.0_04 运行测试时，我看到了不同的输出，并且想了解*为什么*会发生这种情况。我怀疑正在进行某种类型的擦除，但想要一个明确的答案。

这是我的示例代码和有关如何从命令行运行的说明：

### FooServiceTest.java

```
import org.junit.*;
import org.junit.runner.*;
import org.mockito.*;
import org.mockito.runners.MockitoJUnitRunner;
import static org.mockito.Mockito.*;
import java.util.*;

@RunWith(MockitoJUnitRunner.class)
public class FooServiceTest {
  @Mock Map<String, String> mockStringString;
  @Mock Map<String, Integer> mockStringInteger;

  @InjectMocks FooService fooService;

  public static void main(String[] args) {
    new JUnitCore().run(FooServiceTest.class);
  }

  @Before
  public void setup() {
    MockitoAnnotations.initMocks(this);
  }

  @Test
  public void checkInjection() {
    when(mockStringString.get("foo")).thenReturn("bar");
    fooService.println();
  }
} 
```

### FooService.java

```
import java.util.*;

public class FooService {
  private Map<String, String> stringString = new HashMap<String, String>();
  private Map<String, Integer> stringInteger = new HashMap<String, Integer>();

  public void println() {
    System.out.println(stringString.get("foo") + " " + stringInteger);
  }
} 
```

要编译并运行此示例：

*   将以上内容保存到文件中
*   下载并放在同一目录[下 junit.4.10.jar](https://github.com/downloads/KentBeck/junit/junit-4.10.jar)和[mockito-all-1.9.0.jar](http://mockito.googlecode.com/files/mockito-all-1.9.0.jar)
*   设置 PATH 以包含 JDK
*   编译`javac -cp junit-4.10.jar;mockito-all-1.9.0.jar *.java`
*   运行`java -cp .;junit-4.10.jar;mockito-all-1.9.0.jar FooServiceTest`

我相信上面的输出是`null {}`因为[@InjectMocks](http://docs.mockito.googlecode.com/hg/latest/org/mockito/InjectMocks.html)字段注入无法正确解析类型，因为它们都是 Map 类型。**这是正确的**吗？

现在更改其中一个模拟名称以匹配类中的字段应该允许 Mockito 找到匹配项。例如改变

```
@Mock Map<String, Integer> mockStringInteger; 
```

到

```
@Mock Map<String, Integer> stringInteger; 
```

然后使用 Java 1.6.0_32 编译/运行会给出（恕我直言是预期的）输出`bar stringInteger`，但使用 1.7.0_04 会给出`null stringInteger`.

这是我运行它的方式（从 Windows 7 中的命令行）：

```
E:\src\mockito-test>set PATH="C:\Program Files (x86)\Java\jdk1.6.0_32\bin"
E:\src\mockito-test>javac -cp junit-4.10.jar;mockito-all-1.9.0.jar *.java
E:\src\mockito-test>java -cp .;junit-4.10.jar;mockito-all-1.9.0.jar FooServiceTest
    bar stringInteger
E:\src\mockito-test>set PATH="C:\Program Files (x86)\Java\jdk1.7.0_04\bin"
E:\src\mockito-test>javac -cp junit-4.10.jar;mockito-all-1.9.0.jar *.java
E:\src\mockito-test>java -cp .;junit-4.10.jar;mockito-all-1.9.0.jar FooServiceTest
    null stringInteger 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T19:30:27.863

> 我相信上面的输出是 I null {} 因为@InjectMocks 字段注入无法正确解析类型，因为它们都是 Map 类型。它是否正确？

是的，在这些字段上正确 Mockito 无法清除歧义，因此它只是忽略了这些歧义字段。

> 通过一个非常简单的 Mockito 运行 JUnit 测试和类，当使用 Java 1.6.0_32 和 Java 1.7.0_04 运行测试时，我看到了不同的输出，并且想了解为什么会发生这种情况。

实际上，差异在于 Arrays.sort 的不同行为，因此 JDK 6 和 JDK 7 之间的 Collections.sort()。不同之处在于新的算法应该减少 20% 的交换。这可能是这种交换操作使事情在 JDK6 和 JDK7 下工作。

如果您只重命名具有相同类型（或相同擦除）的字段的一个模拟字段，我可能会“自找麻烦”。当不能按类型区分模拟时，您确实应该将所有模拟字段命名为相应的字段，但 Javadoc 并没有明确说明。

非常感谢您报告这种奇怪的行为，我[在 Mockito 上创建了一个问题](https://code.google.com/p/mockito/issues/detail?id=353)，但是现在我不会真正解决这个问题，而是确保跨 JDK 的行为相同。解决这种情况可能需要在保持兼容性的同时编写新的算法，同时您应该根据测试类的字段命名所有字段模拟。

现在要做的事情可能是通过额外的比较来调整比较器，以在 JDK6 和 JDK7 上强制执行相同的顺序。加上在 Javadoc 中添加一些警告。

**编辑**：进行两次通过可能会解决大多数人的问题。

希望有帮助。感谢您发现问题。

* * *

另外顺便说一下，您需要 any`MockitoAnnotations.initMocks(this);`或 runner `@RunWith(MockitoJUnitRunner.class)`，两者都不是必需的，甚至可能会导致一些问题。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T23:10:52.533

如果有多个模拟与将要注入的字段之一匹配，则 Mockito 的行为是未定义的。在这里，“匹配”意味着它是正确的类型，忽略任何类型参数 - 类型擦除阻止 Mockito 知道类型参数。因此，在您的示例中，两个模拟中的任何一个都可以注入两个字段中的任何一个。

您已经设法观察到 Java 6 与 Java 7 的不同行为这一事实有点牵强附会。在任何一个 Java 版本中，都没有理由期望 Mockito 正确地在它注入的两个字段中的任何一个之间选择`mockStringString`or 。`mockStringInteger`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T09:49:58.817

**这是正确的**吗？

事实上，由于[类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)，Mockito 在运行时/通过反射无法看到各种 Map 之间的差异，这让 Mockito 很难进行正确的注入。

`null`响应可能有`stringString.get("foo")`两个原因：

1.  stringString 正确模拟，但没有发生存根（`get`总是返回`null`）。
2.  stringString 没有被嘲笑，所以仍然是`HashMap`没有值的`"foo"`，所以`get`会返回`null`。

对变量的`{}`响应`stringInteger`意味着它已被初始化（在类中）为实际的 (empty) `HashMap`。

所以你的输出告诉你的是，`stringInteger`它没有被嘲笑。怎么样`stringString`？

如果这两个`@Mock`s 中没有一个名称与被测类的任何字段匹配，则不会模拟任何内容。原因？我怀疑它无法决定注入哪个字段，所以它不会做任何模拟。您可以通过显示两个变量来验证这一点，这两个变量都会产生`{}`。这解释了你的`null`价值。

如果其中一个`@Mock`s 有一个匹配的名称，而另一个有一个不匹配的名称（您的修改， one`mockedStringString`和 one `stringInteger`，即具有相同的名称），Mockito 应该怎么做？

您想要它做的只是注入其中一个，并且只在*具有相应名称*的字段中注入。在您的情况下，您有`mockedStringString`（您希望这不匹配）和`stringInteger`（您希望它匹配）。`mockedStringString`由于您将不匹配的 (!)存根，*因此预期的结果将是`null`*.

换句话说，对于给出的具体示例，我认为 Java 7 的响应是可以的，而 Java 6 的响应是不行的。

要查看 Java 6 的（意外）行为发生了什么，请尝试只使用一个`@Mock`- 如果我正确地模拟`stringString`并且*没有*模拟 for `stringInteger`，则模拟 for`stringString`被注入到该`stringInteger`字段中。换句话说，Mockito 似乎首先弄清楚它可以注入（给定名称），然后将模拟注入到匹配的可能性之一（但不一定是正确的那个）。

# java - 如果 init() 从未成功，如何在 stop() 中处理 thread.join

> ID：10755894
> 
> 赞同：-1
> 
> 时间：2012-05-25T14:09:03.173
> 
> 标签：java, multithreading, nullpointerexception, daemon, runnable

我有个问题。我编写了一个 Java 程序，它作为一个守护进程启动。所以我有一个类来实现 Daemon 和 Runnable。在`init()`我做一些检查，然后，当检查没问题时，我开始一个新线程。

```
thread = new Thread(this); 
```

如果检查不正确，我会打电话给`stop()`.In stop 我有这个电话：

```
thread.join(); 
```

但是，如果我从未创建过新线程，这将如何工作。我会得到一个`NullPointerException`. 我应该如何处理这个问题？抓住`NullPointerException`？仅`thread.join()`在线程不为空​​时调用？不打电话`thread.join()`？什么是最好的方法，为什么？谢谢 ：-）

我问这个问题的原因只是我以前从未实现过守护进程，而且我不确定如何在那里处理线程。也许我不应该问。不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:33:55.257

如果你扩展了 apache 的接口守护进程，那么如果 init() 方法失败，你必须抛出 DeamonInitException。在线程上执行此启动将永远不会被调用，并且守护程序将中止其执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:19:30.710

这似乎有点像 Java 101 的答案，所以我不确定我是否理解这个问题。

在您`init()`的方法中，您可能会或可能不会启动新线程并设置`thread`字段。在您的`stop()`方法中，该`thread`字段可能为空或不为空。如果您只想在`join()`该线程不为空​​的情况下使用该线程，那么您将使用以下代码：

```
 if (thread != null) {
      thread.join();
   } 
```

`NullPointerException`应避免捕捉。创建异常实际上是一个相当昂贵的过程——尤其是在它们拍摄堆栈帧的快照时。这是一个很好的讨论，它引用了“Effective Java”一书的话说，异常比非慢约 70 倍。

> [Exceptions 有多昂贵](https://stackoverflow.com/questions/567579/how-expensive-are-exceptions)

许多人使用异常将状态信息返回给调用者，但这是 IMO 的错误模式。异常适用于“异常”条件，*不能替代*错误代码和返回的对象。

如果我不理解这个问题，请编辑您的帖子，我会调整我的答案。

# android - actionBarSherlock 字幕 textSize

> ID：10755895
> 
> 赞同：3
> 
> 时间：2012-05-25T14:09:04.463
> 
> 标签：android, android-layout, android-actionbar, actionbarsherlock, android-theme

我正在使用 ActionBarSherlock 字幕并尝试使用样式更改字幕文本大小，但这似乎不起作用。我对主题不太熟悉，所以..我该如何改变呢？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T12:22:55.393

```
<style name="Theme.Styled" parent="Theme.Sherlock">
    <item name="actionBarStyle">@style/Widget.Styled.ActionBar</item>
    <item name="android:actionBarStyle">@style/Widget.Styled.ActionBar</item>
</style>

<style name="Widget.Styled.ActionBar" parent="Widget.Sherlock.ActionBar.Solid">
    <item name="subtitleTextStyle">@style/TextAppearance.Sherlock.Widget.Styled.ActionBar.Subtitle</item>
    <item name="android:subtitleTextStyle">@style/TextAppearance.Sherlock.Widget.Styled.ActionBar.Subtitle</item>
</style>

<style name="TextAppearance.Sherlock.Widget.Styled.ActionBar.Subtitle" parent="Widget">
    <item name="android:textSize">18sp</item>
</style> 
```

# fortran - Fortran：如何将值 255 存储到一个字节中？

> ID：10755896
> 
> 赞同：5
> 
> 时间：2012-05-25T14:09:06.643
> 
> 标签：fortran, gfortran

我想从 Fortran 调用一个 C api 函数。C 函数接受一个字节数组：

```
void image(const void *bitmap, int w, int h); 
```

其中三个连续字节`*bitmap`表示 RGB 颜色三元组，并被解释为`unsigned char`在 C 中。我想在 Fortran 中初始化位图并注意在 C 中绘图。Fortran 中的当前定义使用

```
integer*1 rgbImage(6,2) 
```

例如初始化 2x2 的图像，但编译器不接受赋值

```
rgbImage(1,1) = 255 
```

得到红色。我已经看到将`BYTE`, `UNSIGNED*1`,`LOGICAL*1`用于无符号单字节的提示，但是 gfortran（MacPort 的 gcc 4.4 或 Mac OS X 下的 4.6）对它们中的任何一个都不满意。我可能会通过作弊和分配价值`-1`而不是 来逃脱`255`，但这使用起来非常不舒服。编译器标志`-fno-range-check`有助于编译代码，但在其他 Fortran 编译器中可能不可用，我认为这是一个丑陋的解决方案（我仍然想捕捉其他警告）。值`'FF'X`or`'11111111'B`也被识别为 32 位整数。

非常希望代码可以跨不同的 Fortran 编译器移植。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-25T14:18:30.017

我的建议是使用`CHARACTER`变量，并用于`ACHAR`设置值（并`ICHAR`根据需要转换回整数）。这应该可以让您得到您想要的并且完全便携。例如，

```
character, dimension(6,2) :: rgbImage

rgbImage(1,1) = achar(255) 
```

***更新添加***：如果您要使用 Fortran 2003 iso_c_binding 东西来连接 C 例程（强烈推荐！）那么您不妨将 rgbImage 数组字符设为 kind`c_char`，例如

```
character(kind=c_char), dimension(6,2) :: rgbImage
integer(kind=c_int) :: w, h

...
rgbImage(1,1) = achar(255)
...

call image(rgbImage, w, h) 
```

您在哪里定义了例程的接口

```
 interface
    subroutine image(img, w, h) bind(C)
       use, intrinsic :: iso_c_binding
       implicit none
       integer(kind=c_int), intent(in), value :: w, h
       character(kind=c_char) :: img(:,:)
    end subroutine image
 end interface 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-12T22:12:53.473

可能适用于某些情况的另一种策略是将 1 字节 c int 数组传递给 Integer(1) 数组，例如 iVal(:)，然后创建另一个 Int 数组，例如 Integer(2) iVal2(:)，然后：

```
Where(iVal(:) < 0)
    iVal2(:) = -iVal(:)+127
ElseWhere
    iVal2(:) = iVal(:)
End Where 
```

...与转换为/来回字符（有时）相比，这可能更有效/更清洁，并且需要更少的编码（有时）。

If you do a lot of this type of thing (interfacing various types of usigned's etc to Fortran), a few utility routines relying on Fortran's bit intrinsics may be a worthwhile investment (e.g. BTest(), iBSet() etc).

# python - Matplotlib 许多子图 xtick 标签拦截

> ID：10755897
> 
> 赞同：0
> 
> 时间：2012-05-25T14:09:10.490
> 
> 标签：python, matplotlib, scipy

我在同一个图中绘制了许多子图。我遇到了 xtick 标签相互拦截的问题。我不希望子图之间有任何空间。这是一个例子：
[![正方形和线条的示例](../Images/019a261ea82c5b3b873bb4814d231670.png)](https://i.stack.imgur.com/Cc9eJ.png)

特别是我希望 xtick 标签不要高于/低于绿线，就像它发生在用红色方块指示的点上一样。
到目前为止，我的一个想法是，在我的 max=4 和 min=0 的情况下，我会在它们各自的位置（例如 1、2、3）绘制 1 2 和 3 的刻度标签。然后我会在 3.8 的位置画 4，在 0.2 的位置画 0。有任何想法吗？
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:46:09.747

不完全符合您的要求，但一个快速的解决方案是设置对齐参数：

```
pylab.xticks(..., horizontalalignment='left')
pylab.yticks(..., verticalalignment='bottom') 
```

这将适用于所有刻度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-14T16:44:17.620

我会这样做：

```
axScatter.set_xticks([0, 1, 2, 3, 4 ,5 ,6])
axScatter.set_yticks([-8, -6, -4, -2, 0, 2, 4, 6]) 
```

你可以使用：

```
axScatter.yaxis.set_major_formatter(nullfmt) 
```

使右上角和右下角的 y 轴标签消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-26T12:30:06.360

整个 plt.figure 例程应该如下所示：

```
fig = plt.figure()

axplot_topleft = fig.add_subplot(2,2,1)
axplot_topleft.xaxis.set_major_formatter(nullfmt)
axplot_topleft.set_yticks([-8, -6, -4, -2, 0, 2, 4, 6])

axplot_topright = fig.add_subplot(2,2,2)
axplot_topright.xaxis.set_major_formatter(nullfmt)
axplot_topright.yaxis.set_major_formatter(nullfmt)

axplot_bottomleft = fig.add_subplot(2,2,3)
axplot_bottomleft.set_xticks([0, 1, 2, 3, 4 ,5 ,6])
axplot_bottomleft.set_yticks([-8, -6, -4, -2, 0, 2, 4, 6])

axplot_bottomright = fig.add_subplot(2,2,4)
axplot_bottomright.yaxis.set_major_formatter(nullfmt)
axplot_bottomright.set_xticks([0, 1, 2, 3, 4 ,5 ,6]) 
```

# c - 如何检查文件大小是否大于确定的数字？

> ID：10755900
> 
> 赞同：1
> 
> 时间：2012-05-25T14:09:29.673
> 
> 标签：c, if-statement, fopen, filesize, fclose

我想使用 if 语句来检查文件大小是否大于以 kb 为单位的确定数字。例如：

```
if(filesize GTREATER than VARX){
 DO
}else{
 DO
} 
```

我是 C 的新手，所以请你解释清楚，如果我必须使用不同的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:16:43.137

如果您已经`fopen()`编辑了该文件，那么您可以使用`fstat()`. `stat()`or`lstat()`可以按名称（在字符串中）用于文件，但如果重复执行，效率会降低。您需要使用从返回的`fileno()`文件描述符 ( `int`) 获取. 否则，手册页有合理的示例。`FILE *``fopen()`

# java - XML 解析错误：UTF-8

> ID：10755901
> 
> 赞同：2
> 
> 时间：2012-05-25T14:09:32.923
> 
> 标签：java, android, xml, dom

我正在尝试将 XML 文件（带有“NDS”扩展名）作为数据读入我的 Android 应用程序。我选择走 DOM DocumentBuilder 路线，调用它的 parse 方法。

问题是其中一个节点名称中存在非 ASCII 增量 (Δ) 字符。这会导致解析操作失败并出现 DOMException。当我去掉有问题的线时，它就起作用了。

我在 Windows 下使用 .NET 库方法创建的 XML 文件本身，它的标题为`<?xml version="1.0" encoding="utf-8"?>`. （我还注意到这个标头前面有 3 字节的 BOM。）

违规行周围的 XML 层次结构看起来像

```
<?xml version="1.0" encoding="utf-8"?>
<NDS SoftwareIdentity="MicroAnalyzer 2000" SoftwareVersion="3.5.8" WindowsVersion="Microsoft Windows NT 5.1.2600 Service Pack 3" CLRVersion="2.0.50727.3615" MachineName="SYSTEM2000_3033" MachineDescription="" DataSource="System2000_3033\SQLEXPRESS" Date="3/31/2012" Time="11:15 AM">
    <ASME_B46_1_2002DataSet xmlns="http://tempuri.org/ASME_B46_1_2002DataSet.xsd">
        <ASME_B46_1_2002RoughnessInstanceTable>
            <InstanceAppendixId>-1</InstanceAppendixId>
            <RΔaEnabled>false</RΔaEnabled>
        </ASME_B46_1_2002RoughnessInstanceTable>
    </ASME_B46_1_2002DataSet>
</NDS> 
```

您会认为 delta 字符在 UTF-8 下是可以接受的，实际上 Internet Explorer 可以正确解释此 XML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:18:24.350

阅读[http://www.w3.org/TR/REC-xml/#NT-NameChar](http://www.w3.org/TR/REC-xml/#NT-NameChar)

```
[4]     NameStartChar      ::=      ":" | [A-Z] | "_" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]

[4a]    NameChar       ::=      NameStartChar | "-" | "." | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040] 
```

在 XML 1.0 中有有效的 unicode 字符，但不是全部。你的角色 (#x394) 是一个有效的 NameStartChar，在 [#x37F-#x1FFF] 范围内。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-25T14:47:14.287

我相信 XML 1.0 要求元素和属性名称仅包含 ASCII 字符（并且禁止某些非打印 ASCII 字符）。声明 UTF-8 编码允许非 ASCII 字符出现在元素和属性的*值中。*

XML 1.1 放宽了这一点，允许在元素和属性名称中使用 Unicode、非 ASCII 字符。

# css - 在中心对齐可变宽度的 div

> ID：10755903
> 
> 赞同：1
> 
> 时间：2012-05-25T14:09:50.810
> 
> 标签：css, html, alignment

申请重复问题，但其他问题的答案似乎都无法解决我的问题。我想`div`在页面中心对齐 a 。`div`只能与其中的内容一样宽。它将用作模式弹出窗口。我在这里设置了一个 jsFiddle：http: [//jsfiddle.net/PDzNj/11/](http://jsfiddle.net/PDzNj/11/)

将`div`其左侧对齐在中间而不是中心`div`（这是所需的效果）

预先感谢您的任何帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T14:15:59.033

一种选择是用`<div>`的环境模拟一张桌子。

```
<div class='outer'>
    <div class='inner'>
        <div class='thebox'>Contents</div>
    </div>
</div> 
```

然后使用CSS：

```
div.outer {
    display:table;
    width:100%; //Or however wide you want the container to be
}
div.inner {
    display:table-cell; //This allows the use of vertical-align
    vertical-align:middle;
    text-align:center;
    width:100%;
}
div.thebox { //Your variable-width container
    display:inline-block; //Makes it obey text-aligning.
} 
```

您当然可以根据需要添加高度值。这比使其相对或使用边距更整洁，CSS 明智，并且对周围环境的破坏也更少。

# fancybox - 在fancybox的onClosed函数中，如何访问被点击的元素以关闭fancybox

> ID：10755906
> 
> 赞同：0
> 
> 时间：2012-05-25T14:09:53.750
> 
> 标签：fancybox

在 onClosed 函数中，我想确定单击以关闭花式框的元素的 ID 是什么。我需要根据盒子的关闭方式提供不同的 onClosed 行为。

假设我的幻想框中有一个按钮，用户可以单击该按钮关闭该框并转到注册页面：

```
<button id="user-register" onclick="parent.jQuery.fancybox.close();parent.location.href='/user/register';"><h3>Sign Up <strong>Now!</strong></h3></button> 
```

在我打开盒子的 fancybox 调用中，我有一个 onClose 函数，它通常会重新加载父对象：

```
'onClosed': function() { 
        /*mytest = $('#fancybox-content iframe').contents().find('#user-register');
        console.log(mytest);*/
        if ($('body').hasClass('not-logged-in')) { 
          parent.location.reload(true);
        }  
      } 
```

重新加载父级的原因是因为在某些情况下用户会在fancybox中登录，我希望父级反映用户已经登录。但是在用户单击注册按钮的情况下，我不希望父重新加载，因为这样用户不会被发送到 /user/register。您可以看到，在我的 onClosed 函数中，我试图在注释掉的代码中找到一种方法来访问 #user-registered 按钮。我希望它的长度在 onClosed 函数中不会为零，因为它是单击以关闭框的元素，但实际上在这种情况下它的长度始终为零，大概是因为当 onClosed 函数时框已经关闭运行。我还尝试检查 onClosed 函数中可用的 arguments 变量，但它指的是打开盒子的元素，

我还尝试将一个参数传递给 close() 函数，以查看它是否会在 onClosed 函数中以某种方式可用——例如，close('user-register')。不过，那个 arg 似乎不可用。

任何想法如何知道一个盒子是如何从 onClosed 函数中关闭的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:27:57.303

在父页面上声明一个变量（具有全局范围），您可以使用 parent.varname 在fancybox 页面中访问该变量。设置此变量的值 onclick 按钮或任何在 fancybox 关闭之前触发的事件。然后在父页面中，可以在fancybox的OnClosed事件中查看该变量的值。希望这可以帮助。

# c++ - 模板参数的默认参数可以特化吗？

> ID：10755908
> 
> 赞同：7
> 
> 时间：2012-05-25T14:09:58.720
> 
> 标签：c++, templates, template-specialization, traits

在 C++ 中，如果我有一个模板参数，我怎样才能干净地专门化一个默认参数？例如，考虑以下情况：

```
template <class Key, class Value = int > class Association; 
```

如果我想`Value`改为默认为`float`for class`Special`怎么办？有没有一种方法可以有效地专门化该类`Association`，如果 Key 是`Special`Value 默认为而不是`float`？

我想这样做的一种方法是使用特征：

```
template <class Key> struct Traits {
  typedef int defaultValue;
}
template<> struct Traits<Special> {
  typedef float defaultValue;
}
template <class Key, class Value = Traits<Key>::defaultValue> class Association; 
```

是否有一种更简洁的方法来做到这一点，并且不那么涉及并且更容易表明 int 是定义 Association 的地方的正常默认值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T14:16:36.503

好吧，一个不一定更漂亮的单线：

```
#include <type_traits>

template <typename Key,
          typename Value = typename std::conditional<std::is_same<Key, Special>::value, float, int>::type>
class Association { /* ... */ }; 
```

# php - 从在线广播/电视获取当前歌曲信息

> ID：10755909
> 
> 赞同：-1
> 
> 时间：2012-05-25T14:10:01.387
> 
> 标签：php, stream, radio

我想从特定的在线广播/电视广播 url 获取歌曲或节目名称的详细信息。这个 url 可以是带有 *.pls 扩展名的文件或 mms 协议形式的文件。

是否有任何网络请求技术、php 库或任何流行语言？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:30:03.483

我不太确定这个答案是否会对您有所帮助，但它可以引导您找到解决方案

```
$url    = parse_url(URL); 
```

abouve url 将为您提供以下格式的数组

```
Array 
```

`( [scheme] => http [host] => eksensc.radyotvonline.com [path] => /listen.pls )`

你可以`$url['path']`从那个数组中得到，

希望它有帮助！谢谢

# algorithm - QuadTree 中的相邻单元格

> ID：10755913
> 
> 赞同：1
> 
> 时间：2012-05-25T14:10:14.080
> 
> 标签：algorithm, quadtree

有没有办法在四叉树细分中找到相邻的单元格？我的意思是在任何级别与所选单元格相邻的所有单元格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:19:28.810

空间填充曲线完全填充空间并将 2 维减少为 1 维。我在 phpclasses.org（希尔伯特曲线）上写了一个免费的 php 类。它包括az曲线、4条希尔伯特曲线和摩尔曲线和一个四键功能。这是一篇关于碰撞检测和四叉树的博客：lab.polygonal.de/?p=202?

![在此处输入图像描述](../Images/1e9bb56e6f02d225847cf4efa869b390.png)

morton aka z 曲线很容易构建。将 x 和 y 值转换为二进制并连接这些值。您可以在这里找到一些代码：http: [//msdn.microsoft.com/en-us/library/bb259689.aspx](http://msdn.microsoft.com/en-us/library/bb259689.aspx)。您可以使用最高有效位来验证上限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:13:54.410

您需要跟踪节点是哪个子节点。如果相邻节点在同一个父节点中，则返回它。如果没有，你需要在树中向上走，直到找到一个共同的祖先。然后沿着类似的路径向下，直到回到正确的水平（或到达底部）。

```
Node WalkLeft(Node node)
{
    if (node == null) return null;

    Node leftParent;
    switch (node.ChildDirection)
    {
        case ChildDirection.Root:
            return null;
        case ChildDirection.TopRight:
            return node.Parent.TopLeft;
        case ChildDirection.BottomRight:
            return node.Parent.BottomLeft;
        case ChildDirection.TopLeft:
            leftParent = WalkLeft(node.Parent);
            return leftParent.TopRight ?? leftParent;
        case ChildDirection.BottomLeft:
            leftParent = WalkLeft(node.Parent);
            return leftParent.BottomLeft ?? leftParent;
    }
} 
```

其他方向也一样。

`x ?? y`选择第一个非空值。

# java - 将行插入 MySQL 数据库

> ID：10755918
> 
> 赞同：1
> 
> 时间：2012-05-25T14:10:34.800
> 
> 标签：java, android, mysql, jdbc, jtds

我正在使用带有 JDTS 驱动程序的 eclipse。我正在尝试在 MySQL 数据库中插入一行。连接和语句生成得很好（我认为）但是当我运行我的 executeUpdate 方法时，我得到一个空指针异常。

我有一个 DBclient 类来处理与 DB 的连接，然后我有一个 Uploader 类，它将收集所有相关信息并将其提供给我的 insert 方法。

我的 DBclient 类：

```
public class DBclient {

String driver="net.sourceforge.jtds.jdbc";
String URL="xxxx";
String user="xxxx";
String pass="xxxx";
Connection connection;
Statement statement;
ResultSet rs;

public void connect() throws SQLException
{
    try {
        Class.forName(driver);
        }//try 
    catch (ClassNotFoundException e) 
        {
            e.printStackTrace();
        }//catch

    try {
        connection=DriverManager.getConnection(URL, user, pass);
        statement=connection.createStatement();

        } //try
    catch (SQLException e)
    {
        e.printStackTrace();
    }//catch
}//connect
public void insertToDB(String sqlstatement) throws SQLException
{
    int i=statement.executeUpdate(sqlstatement);
} 
```

}//数据库客户端

然后是我的 Uploader 类

```
private String testinsert="insert into xxxx (Latitude, Longitude) values (1, 2)";

public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
     setContentView(R.layout.uploader);
     initialize();
     getaddress();
     update();
     try {
        client.insertToDB(testinsert);
    } catch (SQLException e) {
        // TODO Auto-generated catch block
        Toast t=Toast.makeText(getApplicationContext(), "oops", 4);
        t.show();
    }

   }//onCreate 
public void initialize()
{
    client = new DBclient();
    geocoder = new Geocoder(this);
    Bundle coords = getIntent().getExtras();
    street = (TextView) findViewById(R.id.street);
    town = (TextView) findViewById(R.id.town);
    state = (TextView) findViewById(R.id.state);
    country = (TextView) findViewById(R.id.country);
    lat=coords.getDouble("Latitude");
    lon=coords.getDouble("Longitude");

}//initialize
public void update()
{
    street.setText(address.getAddressLine(0));
    town.setText(address.getLocality());
    state.setText(address.getAdminArea());
    country.setText(address.getCountryName());
}//update
public void getaddress()
{
    try 
    {
        addresslist = geocoder.getFromLocation(lat, lon, 1);
    } //try
    catch (IOException e) 
    {
        Toast t=Toast.makeText(getApplicationContext(), "Input Error", 2);
        t.show();
    }//catch
     address=addresslist.get(0);

} 
```

}//上传者

空指针异常是从 DBclient 类的 insertToDB() 方法引发的。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:15:52.630

```
public void insertToDB(String sqlstatement) throws SQLException
{
    int i=statement.executeUpdate(sqlstatement);
} 
```

看起来`statement`只`connect()`在`DBClient`类中设置过，但在问题中显示的任何其他代码中都没有调用此方法。因此`statement`将为 null，并且从中调用方法将导致`NullPointerException`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T17:44:44.733

原来我和[这里的用户有同样的问题](https://stackoverflow.com/questions/2247998/noclassdeffounderror-eclipse-and-android)

我要做的就是将 jtds.jar 添加到我的资产文件夹中，将其添加到我的构建路径中，然后在“配置构建路径”菜单中，转到订购和导出，并检查 jar 文件。

# android - 运行 android 的 MID 平板电脑上的应用程序到 sdcard 存储的 mp3 文件的相对路径不起作用

> ID：10755920
> 
> 赞同：0
> 
> 时间：2012-05-25T14:10:41.647
> 
> 标签：android, android-sdcard

当我在 View Pad7 上运行时，成功使用了**sdcard/night1/9472012051_346.mp3**。

如果我从应用程序中提示输入根目录，我会得到**/mnt/sdcard/**，但`Prompt(IsFileExist("/mnt/sdcard/night1/9472012051_346.mp3"));`返回 false。

平板电脑上的资源管理器应用程序将路径显示为**SD Card/night1/9472012051_346.mp3**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:31:07.933

许多平板电脑都有自己的内部存储器，这就是挂载到 /mnt/sdcard（由 /sdcard 符号链接到）的内容。在这些情况下，您安装的任何外部 SD 卡通常位于 /mnt/external_sd

# mysql - Nodejs Expressjs 会话 ip 和浏览器代理匹配

> ID：10755923
> 
> 赞同：1
> 
> 时间：2012-05-25T14:10:46.863
> 
> 标签：mysql, node.js, express

我正在使用 connect-mysql-session 将会话存储在数据库中。现在我的问题是如何添加包含浏览器代理和 IP 地址的用户数据来检查会话是否有效？我如何获得这些信息？我如何检查它是否匹配？

```
 users.login(credentials,function(err, results) {

  //On errors
  if (err) {
    res.render(routes.index, {
      title: 'Login'
    });

  //On success
  } else if (results[0]) {
    //Set session data and redirect to start page
    req.session.userdata = results[0];
    req.session.userdata.email = req.body.email_login;
    req.session.is_logged_in = true;
    res.redirect('/start');

  //Wrong credentials
  } else {
    req.flash('warning','Wrong password or login');
    res.render('index', {
      title: 'Login'
    });
  }
}); 
```

**更新：**

我现在将此添加到会话中：

```
req.session.ip = req.connection.remoteAddress;
req.session.useragent = req.headers['user-agent']; 
```

并在我的身份验证中间件中检查它：

```
 if(req.session.userdata && req.session.is_logged_in === true && req.session.ip === req.connection.remoteAddress && req.session.useragent === req.headers['user-agent']) {
    next();
  } else {
    res.redirect('/');
  } 
```

这是安全的还是您认为这样做有任何风险？我应该换一种方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:39:03.280

你的实现看起来不错，并且会给你一些 - 非常 - 防止会话劫持的基本保护。

但是，我不确定我是否了解您的中间件。是什么阻止了用户`/start`直接请求？而且，更重要的是，当中间件拦截所有请求时，即使是那些 for `/start`，这看起来不是无限重定向循环吗？

我的建议只是考虑在 ip 或用户代理不匹配时始终注销用户。

# c# - 如何从 C# 中的 HTTP Post 访问 Header 信息？

> ID：10755924
> 
> 赞同：3
> 
> 时间：2012-05-25T14:10:51.600
> 
> 标签：c#, asp.net, .net, http-headers

我正在开发一个 MVC Web 应用程序，我需要找到一种方法来访问从另一个应用程序/源调用的 HTTP Post 的标头信息。所以我希望我的应用程序做的就是在特定视图上监听 HTTP Post，然后从它的 Header 中提取信息，有什么想法吗？？？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:13:38.663

在您的控制器中使用 Request.Headers。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:13:58.637

使用`Request.Headers`which 将为您提供客户提交的所有内容：

[http://msdn.microsoft.com/en-us/library/system.web.httprequest.headers.aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.headers.aspx)

# ios - 从游戏中心下载数据

> ID：10755926
> 
> 赞同：0
> 
> 时间：2012-05-25T14:10:56.183
> 
> 标签：ios, xcode, game-center

我有一个 iOS 应用程序。有一个主要功能 - 我需要知道来自 iOS 游戏中心的所有数据。我在这个游戏中谈论游戏名称和分数。我想在用户的游戏中心收集所有游戏的统计数据和分数。

我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:14:17.023

如果遇到任何问题，如何阅读[文档并提出更具体的问题？](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/LeaderBoards/LeaderBoards.html#//apple_ref/doc/uid/TP40008304-CH6-SW13)

# performance - Adobe Air SQLite 性能与 SQLite cli

> ID：10755931
> 
> 赞同：1
> 
> 时间：2012-05-25T14:11:08.110
> 
> 标签：performance, sqlite, air

我有一个简单的 SQL 表结构，其中包含三个表：**entry**（~70k 行）、**tag**（~27k 行）和**entry_tag**（~250 万行）。**entry_tag -table**包含条目和标签之间的关系（nn 关系），就像这个**entry_tag**（*entry_id*，*tag_id*，*...*）。

当我第一次尝试使用特定标签获取所有*entry_id*时，我进行了如下查询

```
SELECT entry_id FROM entry_tag et, tag t 
WHERE t.id=et.tag_id AND t.name LIKE 'Something'; 
```

没有明显的原因，在 Win7 x64（i5-2500K，8GB RAM，7200rpm 硬盘）上的 Adob​​e Air 应用程序上的查询花费了 6 秒以上，这太慢了（特别是对于更复杂的`INTERSECT`查询）。在 SQLite 命令行工具查询立即返回结果。我比较了 cli`EXPLAIN`和`EXPLAIN QUERY PLAN`Air（使用基于 Air 的 SQLite Sorcerer）和相同的结果。两个查询都使用索引。

在我通过切换表的顺序来重组查询之后，性能在 Air 中成倍增长到 250 毫秒，这是令人满意的：

```
SELECT entry_id FROM tag t, entry_tag et
WHERE et.tag_id=t.id AND t.name LIKE 'Something'; 
```

所以我想知道，为什么 cli 工具比 Adob​​e Air 环境快得多？对于背景信息，我已经使用 PHP（所有列`INTEGER`或`TEXT`）生成了 db 文件。

以下是原始慢查询的查询计划：

```
sele  order          from  deta
----  -------------  ----  ----
0     0              0     SCAN TABLE entry_tag AS et USING INDEX idx_et_eid (~1000000 rows)
0     1              1     SEARCH TABLE tag AS t USING INTEGER PRIMARY KEY (rowid=?) (~1 rows) 
```

（~1000000 行看起来很糟糕；）

# android - 拖放操作栏选项卡（Android 4.0 ICS）？

> ID：10755934
> 
> 赞同：2
> 
> 时间：2012-05-25T14:11:14.753
> 
> 标签：android, tabs, drag-and-drop, android-actionbar

是否允许用户拖放操作栏中的导航选项卡以在 Android 4.0 ICS 上重新排序？我不是指已弃用的 TabHost 中的选项卡，我指的是您添加到在 Honeycomb 及更高版本中使用的 ActionBar 的选项卡。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T13:29:18.513

就使用[`ActionBar.Tabs`](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/app/ActionBar.java)而言，他们根本没有实现这一目标的功能。另一方面，创建您自己的模仿 的自定义类`Tabs`很容易，那么您所要做的就是创建并添加一个`OnDragListener`and`OnTouchListener`来`View`填充您的标签栏。

例如，这是我在我的一个应用程序中使用的一个类，它模仿`ActionBar.Tabs`.

**可滚动标签视图**

```
 public class ScrollableTabView extends HorizontalScrollView implements OnPageChangeListener {

    private final Context mContext;

    private final LinearLayout mContainer;

    private final ArrayList<View> mTabs = new ArrayList<View>();

    private final int mDividerColor = 0xFF636363;

    private int mDividerMarginTop = 12;

    private int mDividerMarginBottom = 12;

    private int mDividerWidth = 1;

    private ViewPager mPager;

    private TabAdapter mAdapter;

    private Drawable mDividerDrawable;

    public ScrollableTabView(Context context) {
        this(context, null);
    }

    public ScrollableTabView(Context context, AttributeSet attrs) {
        this(context, attrs, 0);
    }

    public ScrollableTabView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs);

        mContext = context;

        final LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(
                android.view.ViewGroup.LayoutParams.MATCH_PARENT,
                android.view.ViewGroup.LayoutParams.MATCH_PARENT);

        mDividerMarginTop = (int)(getResources().getDisplayMetrics().density * mDividerMarginTop);
        mDividerMarginBottom = (int)(getResources().getDisplayMetrics().density * mDividerMarginBottom);
        mDividerWidth = (int)(getResources().getDisplayMetrics().density * mDividerWidth);

        setHorizontalScrollBarEnabled(false);
        setHorizontalFadingEdgeEnabled(false);

        mContainer = new LinearLayout(context);
        mContainer.setOrientation(LinearLayout.HORIZONTAL);
        mContainer.setLayoutParams(params);

        addView(mContainer);
    }

    /**
     * Set the tabs Adapter
     * 
     * @param adapter
     */
    public void setAdapter(TabAdapter adapter) {
        mAdapter = adapter;

        if (mPager != null && mAdapter != null) {
            initTabs();
        }
    }

    /**
     * Attach ViewPager
     * 
     * @param pager
     */
    public void setViewPager(ViewPager pager) {
        mPager = pager;
        mPager.setOnPageChangeListener(this);

        if (mPager != null && mAdapter != null) {
            initTabs();
        }
    }

    /**
     * Initiate the tabs
     */
    private void initTabs() {

        mContainer.removeAllViews();
        mTabs.clear();

        if (mAdapter == null) {
            return;
        }

        for (int i = 0; i < mPager.getAdapter().getCount(); i++) {

            final int index = i;

            final View tab = mAdapter.getView(i);
            mContainer.addView(tab);

            tab.setFocusable(true);

            mTabs.add(tab);

            if (i != mPager.getAdapter().getCount() - 1) {
                mContainer.addView(getSeparator());
            }

            tab.setOnClickListener(new OnClickListener() {
                @Override
                public void onClick(View v) {
                    if (mPager.getCurrentItem() == index) {
                        selectTab(index);
                    } else {
                        mPager.setCurrentItem(index, true);
                    }
                }
            });

        }

        selectTab(mPager.getCurrentItem());
    }

    @Override
    public void onPageScrollStateChanged(int state) {
        // Nothing to do
    }

    @Override
    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
        // Nothing to do
    }

    @Override
    public void onPageSelected(int position) {
        selectTab(position);
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        super.onLayout(changed, l, t, r, b);

        if (changed) {
            selectTab(mPager.getCurrentItem());
        }
    }

    /**
     * @return Separates the tabs
     */
    private View getSeparator() {
        final View v = new View(mContext);

        final LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(mDividerWidth,
                android.view.ViewGroup.LayoutParams.MATCH_PARENT);
        params.setMargins(0, mDividerMarginTop, 0, mDividerMarginBottom);
        v.setLayoutParams(params);

        if (mDividerDrawable != null) {
            v.setBackground(mDividerDrawable);
        } else {
            v.setBackgroundColor(mDividerColor);
        }

        return v;
    }

    /**
     * @param position
     */
    private void selectTab(int position) {

        for (int i = 0, pos = 0; i < mContainer.getChildCount(); i += 2, pos++) {
            final View tab = mContainer.getChildAt(i);
            tab.setSelected(pos == position);
        }

        final View selectedTab = mContainer.getChildAt(position * 2);

        final int w = selectedTab.getMeasuredWidth();
        final int l = selectedTab.getLeft();

        final int x = l - this.getWidth() / 2 + w / 2;

        smoothScrollTo(x, this.getScrollY());
    }
} 
```

**选项卡适配器**

```
 public interface TabAdapter {
    public View getView(int position);
} 
```

**附加您的 TabAdapter**

```
 public class ScrollingTabsAdapter implements TabAdapter {

    private final FragmentActivity activity;

    private final LayoutInflater inflater;

    private Button mTabs;

    // Tab titles
    private static final String[] mTitles = {
            "RECENT", "ARTISTS", "ALBUMS", "SONGS", "PLAYLISTS", "GENRES"
    };

    /**
     * @param act
     */
    public ScrollingTabsAdapter(FragmentActivity act) {
        activity = act;
        inflater = activity.getLayoutInflater();
    }

    @Override
    public View getView(int position) {
        mTabs = (Button)inflater.inflate(R.layout.tabs, null);
        if (position < mTitles.length) {
            mTabs.setText(mTitles[position]);
        }
        return mTabs;
    }
} 
```

您可以使用真实的默认可绘制对象和属性来设置您充气`ActionBar.Tabs`的样式。`Button`您可以从 SDK 或网络上的某个地方获取它们。要使用它，请将一个`ViewPager`对象附加到`ScrollableTabView`并将每个对象添加`Fragments`到`FragmentPagerAdapter`. [如果您对添加默认可绘制对象和属性后的样式感到好奇，这就是它们的样子](http://i.imgur.com/d8sNZ.png)

就拖放而言，Android 在他们的网站上有一些不错的文档。[拖放](http://developer.android.com/guide/topics/ui/drag-drop.html)

网上也有一些简单易学的教程。[Android 拖放教程，来自 Lars Vogel](http://www.vogella.com/articles/AndroidDragAndDrop/article.html)

[或者您可以随时使用 Google 查找更多信息](https://www.google.com/search?sugexp=chrome,mod=12&sourceid=chrome&ie=UTF-8&q=drag+and+drop+views+android&qscrl=1)

# python - 如何在 wxpython 面板中重绘 mathplotlib 图形？

> ID：10755937
> 
> 赞同：2
> 
> 时间：2012-05-25T14:11:28.190
> 
> 标签：python, wxpython, matplotlib

`draw()`我想在每个操作上绘制一个新图形。我拼凑了用于绘制静态图形的[代码](https://stackoverflow.com/questions/10737459/embedding-a-matplotlib-figure-inside-a-wxpython-panel)，该图形在创建对象后**永远不会更新。**但我希望能够在呈现新数据时**重绘。**

我如何构建我的代码来做可重绘的数字？

* * *

这是有问题的代码，它只绘制一次：

```
from numpy import arange, sin, pi
import matplotlib
matplotlib.use('WXAgg')

from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg as FigureCanvas
from matplotlib.backends.backend_wx import NavigationToolbar2Wx

class CanvasPanel(wx.Panel):
    def __init__(self, parent):
        wx.Panel.__init__(self, parent)
        #self.size = (800, 50)
        self.figure = Figure()
        self.figure.set_size_inches( (8,1) )
        self.figure.set_dpi(80)
        #self.axes = self.figure.add_subplot(111)
        self.canvas = FigureCanvas(self, -1, self.figure )
        self.sizer = wx.BoxSizer(wx.VERTICAL)
        self.sizer.Add(self.canvas, 1, wx.LEFT | wx.TOP | wx.GROW)
        self.SetSizer(self.sizer)
        self.Fit()

    def draw(self):
        self.axes = self.figure.add_subplot(111)
        t = arange(0.0, 3.0, 0.01)
        s = sin(2 * pi * t)
        self.axes.plot(t, s)
        #time.sleep(5)
        #self.figure.clear() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T06:26:10.343

正如@acattle 在他的评论中所建议的那样，您所要做的就是在更新绘图后将这些行添加到您的绘图子程序中：

```
 self.canvas.draw()
 self.canvas.Refresh() 
```

# iphone - iAd 活动横幅过多 (10)。新横幅的创建将受到限制

> ID：10755938
> 
> 赞同：0
> 
> 时间：2012-05-25T14:11:33.780
> 
> 标签：iphone, iad, adbannerview

我在 ViewWillAppear 和 ViewWillDisappear 上分别创建和删除了 ADBannerView，即使在切换到另一个没有创建 ADBannerView 的视图后，我仍然看到大量警告。这是什么意思？我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:17:21.987

我使用 IB 或在 viewDidLoad 而不是 viewWillAppear 创建和设置 adView 取得了更大的成功。这是一个源自我的一个应用程序中使用的代码的示例。我希望它有所帮助。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    adView = [[AdBannerView alloc]initWithFrame:GCResctMake(0,0,320,50)];
    adView.requiredContentSizeIdentifiers = [NSSet setWithObject:ADBannerContentSizeIdentifier320x50];
    adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifier320x50;
    adView.delegate=self;
    bannerIsVisible=NO;
    adView.hidden = YES;
    [adContainerView addSubview:adView];
    [adView release];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T14:26:54.237

您真的应该在您的应用程序中创建一个 AdBannerView 对象，并通过根据需要动态添加/删除它来在您的其他视图中重用它。当有或没有可用的 iAd 时，您还必须处理它的显示/隐藏，以及调整内容视图的大小以为显示子视图腾出空间。看看 Apple [iAdSuite](http://developer.apple.com/library/ios/samplecode/iAdSuite/Introduction/Intro.html)示例中的 TabbedBanner 项目，它很好地封装了此功能。

# jquery-ui - 从淘汰赛绑定打开对话框时更改标题

> ID：10755941
> 
> 赞同：1
> 
> 时间：2012-05-25T14:11:39.617
> 
> 标签：jquery-ui, knockout.js

我的代码基于这个例子

[http://jsfiddle.net/rniemeyer/WpnTU/](http://jsfiddle.net/rniemeyer/WpnTU/)

当您选择一个项目时，我希望对话框的标题具有可观察的值

我设法通过创建另一个自定义绑定来做到这一点

```
ko.bindingHandlers.dialogOptions = {
    update: function(element, valueAccessor) {
        var options = ko.utils.unwrapObservable(valueAccessor());
        if (options ) {
          $(element).dialog(options);
        }         

    }
} 
```

为 viewmodel 添加了一个新的 observable 并在选择项目时设置它

```
this.selectProduct = function(product) {
        self.dialogOptions({ title: product.name() });
        self.selectedProduct(product);
} 
```

工作示例：http: [//jsfiddle.net/WpnTU/76/](http://jsfiddle.net/WpnTU/76/)

它可以工作，但我不喜欢它，它添加了一个与 GUI 非常耦合的新 observable，如果我可以使用已经退出的 selectProduct observable 并指出 GUI 中的 name 属性，例如 { title:选择产品名称 }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:11:02.793

这是一个将`.dialog`调用移动到`update`函数中并解包选项的示例，以便在任何时候发生变化时都会触发它。

```
//custom binding to initialize a jQuery UI dialog
ko.bindingHandlers.jqDialog = {
    init: function(element) {
       ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            $(element).dialog("destroy");
        }); 
    },
    update: function(element, valueAccessor) {
       var options = ko.toJS(valueAccessor());

        if (options) {
            $(element).dialog(options);
        }            
    }
}; 
```

我向您的示例添加了一个计算的 observable，只是为了处理`selectedProduct`null （可以在线完成）。

[http://jsfiddle.net/rniemeyer/Gt5Hw/](http://jsfiddle.net/rniemeyer/Gt5Hw/)

# delphi - 为什么不调用 Destroy？

> ID：10755942
> 
> 赞同：7
> 
> 时间：2012-05-25T14:11:43.517
> 
> 标签：delphi, memory-leaks, destroy

给定以下 Delphi 代码，`Foo`是`Free`'d on `FormClose`，但`TFoo.Destroy`没有被调用 - 因此`Bar`不是`Free`'d，导致内存泄漏？

我在这里错过了什么还是不应该 Foo.Free 在某个时候调用 Foo.Destroy ？

```
type
  TBar = class
  SomeInteger : integer;
end;

TFoo = class
  Bar : TBar;

  constructor Create();
  destructor Destroy();
end;

var
  Foo : TFoo;

implementation

constructor TFoo.Create;
begin
  Bar := TBar.Create;
  Bar.SomeInteger := 2;
end;

destructor TFoo.Destroy;
begin
  Bar.Free;
  Bar := nil;

  showmessage('Destroyed!');
end;

procedure TForm10.FormCreate(Sender: TObject);
begin
  Foo := TFoo.Create;

  showmessage('Foo created');
end;

procedure TForm10.FormDestroy(Sender: TObject);
begin
  Foo.Free;
  Foo := nil;
end; 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-25T14:18:32.693

您必须使用覆盖标记析构函数的签名。

```
destructor Destroy(); override; 
```

你应该`inherited`在析构函数的末尾有。但是由于您的类不是从 TObject 以外的任何东西派生的，我怀疑这并不重要。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-25T14:20:31.430

Destroy 是虚拟的，因此您必须在后代类中覆盖它。

```
TFoo = class
  Bar : TBar;

  constructor Create();
  destructor Destroy(); override; // must add override here
end; 
```

如果没有覆盖，则永远不会调用您的析构函数，而是调用基类。

# javascript - IE 在更改 HREF 后忘记了 A-Tag 的主机名

> ID：10755943
> 
> 赞同：2
> 
> 时间：2012-05-25T14:11:43.523
> 
> 标签：javascript, internet-explorer, dom

我在项目中动态设置`href`-Tag 的`<a ...>`-Attribute。在其他时候，我检查了`<a>`名为 的 DOM-Property `hostname`，以确定它是否是内部链接。

基本上，这就是发生的事情。

```
<!--HTML-->
<a id="my" href="/my/first/link">MyLink</a>
<div id="log"></div> 
```

JS是：

```
// js
var a = document.getElementById( 'my' ),
    log = document.getElementById( 'log' );

log.innerHTML += a.hostname + '<br/>';

a.setAttribute('href',"/my/other/link");
log.innerHTML += a.hostname; 
```

（参见这个小提琴：http: [//jsfiddle.net/RurQT/](http://jsfiddle.net/RurQT/)）

当我设置`d.href`为相对路径时，我希望`d.hostname`保持不变 - 所以`log`-Div 包含两次相同的主机名。这在 FF 和 Chrome 中是正确的。

但是，InternetExplorer 7、8 和 9 都坚持第二次，主机名是空的。

我特别困惑，因为第一个环节一直是相对的！顺便说一句，我没有任何`<base href>`设置。

我将非常感谢任何关于如何让 InternetExplorer 更新`a`-DOM-Element 的“主机名”-Property 的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T14:45:51.570

您必须隐藏并重新设置它：

```
var d = document.getElementById( 'my' ),
var h = d.hostname
d.setAttribute('href',"/my/other/link");
d.hostname = h 
```

# xmpp - Openfire：添加联系人订阅状态设置为“来自”而不是“两者”

> ID：10755944
> 
> 赞同：0
> 
> 时间：2012-05-25T14:11:45.187
> 
> 标签：xmpp, openfire, smack

嗨，我遇到了 openfire 和 smack 的问题。我有一个使用 smack 和 openfire 开发的 jabber 机器人。当任何用户添加bot有他/她的联系人时，在整个过程结束时，ofRoster(openfire)表的订阅状态设置为'from'。这个过程的期望结果是“两者”。

这是我处理新添加连接的代码，

```
xmppConnection.getConnection().getRoster().setSubscriptionMode(Roster.SubscriptionMode.manual);
xmppConnection.getConnection().addPacketListener(
    new PacketListener() {
        @Override
        public void processPacket(Packet paramPacket) {
            System.out.println("\n\n");

            if(paramPacket instanceof Presence){
                Presence presence = (Presence)paramPacket;
                String email = getEmailIdFromJabberId(presence.getFrom());
                System.out.println("chat invite status changed by user: : " + email + " calling listner");
                //if(presence.getType().equals(Presence.Type.subscribed) || presence.getType().equals(Presence.Type.subscribe) ){
                System.out.println("presence: " + presence.getFrom() + "; type: " + presence.getType() + "; to: " + presence.getTo() + "; " + presence.toXML());
                Roster roster = xmppConnection.getConnection().getRoster();
                for(RosterEntry rosterEntry : roster.getEntries()){
                    System.out.println("jid: " + rosterEntry.getUser() + "; type: " + rosterEntry.getType() + "; status: " + rosterEntry.getStatus());
                }
                System.out.println("\n\n\n");

                if( presence.getType().equals(Presence.Type.subscribe) ){
                    //chatInviteAcceptanceListner.onChatInviteAccept(email);

                    Presence newp = new Presence(Presence.Type.subscribed);
                    newp.setMode(Presence.Mode.available);
                    newp.setPriority(24);
                    newp.setTo(presence.getFrom());
                    //presence.addExtension(new AvatarBroadcastExtension(imageHash));
                    xmppConnection.getConnection().sendPacket(newp);
                } else if(presence.getType().equals(Presence.Type.unsubscribe)){
                    //chatInviteAcceptanceListner.onChatInviteReject(email);
                    Presence newp = new Presence(Presence.Type.unsubscribed);
                    newp.setMode(Presence.Mode.available);
                    newp.setPriority(24);
                    newp.setTo(presence.getFrom());
                    //presence.addExtension(new AvatarBroadcastExtension(imageHash));
                    xmppConnection.getConnection().sendPacket(newp);
                }
            }

        }
    }, 
    new PacketFilter(){
        public boolean accept(Packet packet) {

            if(packet instanceof Presence){
                Presence presence = (Presence)packet; 
                if(presence.getType().equals(Presence.Type.subscribed) 
                        || presence.getType().equals(Presence.Type.subscribe)
                        || presence.getType().equals(Presence.Type.unsubscribed) 
                        || presence.getType().equals(Presence.Type.unsubscribe) ){
                    //System.out.println("packet: " + packet);
                    return true;
                }
            } 
            return false;
        }
    }); 
```

添加联系人的用户的日志。使用 pidgin

```
(18:32:22) jabber: jabber_roster_add_buddy(): Adding testdoctor@answers.exampledomain.com
(18:32:22) jabber: jabber_roster_update(testdoctor@answers.exampledomain.com): [Source: local blist]: groups: Buddies
(18:32:22) jabber: Sending (ssl) (testuser2@answers.exampledomain.com/pidgin): <iq type='set' id='purple8dde9bec'><query xmlns='jabber:iq:roster'><item jid='testdoctor@answers.exampledomain.com' name=''><group>Buddies</group></item></query></iq>
(18:32:22) jabber: Sending (ssl) (testuser2@answers.exampledomain.com/pidgin): <presence to='testdoctor@answers.exampledomain.com' type='subscribe'/>
(18:32:22) jabber: Recv (ssl)(231): <iq type="set" id="88-4977" to="testuser2@answers.exampledomain.com/pidgin"><query xmlns="jabber:iq:roster"><item jid="testdoctor@answers.exampledomain.com" name="" subscription="none"><group>Buddies</group></item></query></iq>
(18:32:22) jabber: Sending (ssl) (testuser2@answers.exampledomain.com/pidgin): <iq type='result' id='88-4977'/>
(18:32:22) jabber: Recv (ssl)(89): <iq type="result" id="purple8dde9bec" to="testuser2@answers.exampledomain.com/pidgin"/>
(18:32:22) jabber: Unhandled IQ with id purple8dde9bec
(18:32:23) jabber: Recv (ssl)(248): <iq type="set" id="963-4978" to="testuser2@answers.exampledomain.com/pidgin"><query xmlns="jabber:iq:roster"><item jid="testdoctor@answers.exampledomain.com" name="" ask="subscribe" subscription="none"><group>Buddies</group></item></query></iq>
(18:32:23) jabber: Sending (ssl) (testuser2@answers.exampledomain.com/pidgin): <iq type='result' id='963-4978'/>
(18:32:23) jabber: Recv (ssl)(247): <iq type="set" id="445-4981" to="testuser2@answers.exampledomain.com/pidgin"><query xmlns="jabber:iq:roster"><item jid="testdoctor@answers.exampledomain.com" name=" Ask a Doctor Now" subscription="to"><group>Buddies</group></item></query></iq>
(18:32:23) jabber: Sending (ssl) (testuser2@answers.exampledomain.com/pidgin): <iq type='result' id='445-4981'/>
(18:32:23) jabber: Recv (ssl)(164): <presence id="ERM59-6" to="testuser2@answers.exampledomain.com" type="subscribed" from="testdoctor@answers.exampledomain.com"><priority>24</priority></presence>
(18:32:23) jabber: Recv (ssl)(283): <presence id="ERM59-5" from="testdoctor@answers.exampledomain.com/smoke" to="testuser2@answers.exampledomain.com/pidgin"><status>141 Doctors Online! Type your question &amp; get an answer now. To find out more, type "Help" and hit ENTER</status><priority>24</priority></presence>
(18:32:23) blist: Updating buddy status for testdoctor@answers.exampledomain.com (XMPP) 
```

机器人日志（启用 smack 调试）

发送

```
 <presence id="ERM59-6" to="testuser2@answers.exampledomain.com" type="subscribed"><priority>24</priority></presence> 
```

已收到

```
 <presence to="testdoctor@answers.exampledomain.com" type="subscribe" from="testuser2@answers.exampledomain.com"/>
<iq type="set" id="612-4980" to="testdoctor@answers.exampledomain.com/smoke"><query xmlns="jabber:iq:roster"><item jid="testuser2@answers.exampledomain.com" subscription="from"/></query></iq> 
```

解释的

```
 <presence to="testdoctor@answers.exampledomain.com" from="testuser2@answers.exampledomain.com" type="subscribe"></presence>
<iq id="612-4980" to="testdoctor@answers.exampledomain.com/smoke" type="set"><query xmlns="jabber:iq:roster"><item jid="testuser2@answers.exampledomain.com" subscription="from"></item></query></iq> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T08:28:49.797

您需要发送自己的`<presence type="subscribe" to="testusrer@answers.exampledomain.com"/>`，然后该用户需要像您一样回复`<presence type="subscribed"/>`。

[这在 XMPP6121 中有描述](http://xmpp.org/rfcs/rfc6121.html#sub)。

# css - 有什么方法可以用元素“剪切”背景？

> ID：10755949
> 
> 赞同：0
> 
> 时间：2012-05-25T14:11:52.400
> 
> 标签：css, background, cut

我需要通过以下方式剪切带有标题的 div 的背景：

![](../Images/8abb3f762addf7ca928abdbd55148853.png)

虽然它可以在纯色背景上轻松实现（通过将元素设置为 inline-block 并使用与主背景相同的 bg 颜色），但当背景是图像时它实际上不起作用：

![](../Images/42c9f142dff5a6d3cb9c163bb0d83a49.png)

是否可以在第二个示例中达到相同的效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:29:30.427

也许不是最好的解决方案，但你可以这样做：

假设 HTML 标记类似于：

```
<div id='outer'>
  <div id='heading'>
    <span id='date'>May 20th, 2012</span>
    ...
  </div>
</div> 
```

如果背景`outer`是图片，背景`heading`是虚线，可以设置s`background-image`的`span`和相同`outer`，然后设置`background-position`图片偏移量与元素相同，这样就对齐了与其他背景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:38:38.597

CSS3 解决方案是[http://dabblet.com/gist/2788465](http://dabblet.com/gist/2788465) - 它使用最少的标记和样式。

另一个也适用于 IE9 的解决方案[http://dabblet.com/gist/2788690](http://dabblet.com/gist/2788690)

另一个也适用于 IE7 和 IE8 [http://jsfiddle.net/thebabydino/Njtzb/](http://jsfiddle.net/thebabydino/Njtzb/)

# c# - WlanQueryInterface 莫名其妙地失败

> ID：10755952
> 
> 赞同：0
> 
> 时间：2012-05-25T14:12:03.563
> 
> 标签：c#, pinvoke, wifi

一段时间以来，我一直在努力解决这个问题。WLAN 中一个看似简单的命令对我来说失败了。我正在尝试执行以下代码：

```
[DllImport("Wlanapi.dll", EntryPoint = "WlanQueryInterface", SetLastError = true)]
public static extern uint WlanQueryInterface(
    [In] IntPtr hClientHandle, 
    [In] ref Guid pInterfaceGuid,
    WLAN_INTF_OPCODE OpCode, 
    IntPtr pReserved,
    [Out] out uint pdwDataSize, 
    ref IntPtr ppData,
    IntPtr pWlanOpcodeValueType);

var tempID = InterfaceID;
UInt32 dataSize;
IntPtr pData = IntPtr.Zero;

uint results = WlanQueryInterface(
    _sessionHandle, 
    ref tempID, 
    WLAN_INTF_OPCODE.wlan_intf_opcode_current_connection,
    IntPtr.Zero, 
    out dataSize, 
    ref pData, 
    IntPtr.Zero); 
```

我每次得到的都是 50 和没有指针的结果。我已经搜索并无法确定 50 作为返回值的含义。我最好的猜测是 ERROR_INVALID_STATE。但我也无法找到文档列出的错误状态的任何定义。

我之前打开了一个句柄并验证它仍然有效。我还验证了 Interface Guid 是否正确（在本例中是从 InterfaceInfo 结构中检索的）。我使用了很多没有类似问题的各种 WLan 方法，所以我猜我错误地定义了 P/Invoke 声明。

如果有人看到我的错误，我发誓我会改变！

# java - Maven 不使用本地仓库

> ID：10755955
> 
> 赞同：10
> 
> 时间：2012-05-25T14:12:26.723
> 
> 标签：java, jakarta-ee, maven, maven-plugin

我正在使用没有 m2e 的 maven，我的 mvn 安装失败，因为插件在 maven Central 上不再可用。我正在使用 2008 年的旧 pom.xml，并且必须使用 maven-cdk-plugin 版本 3.3.3.Final。

由于它不再可用，我将它放在其他计算机上并将其放入我的 .m2 本地存储库中。.m2\org\richfaces\cdk\maven-cdk-plugin\3.3.3.Final

但是我仍然收到此错误。

```
[ERROR] Plugin org.richfaces.cdk:maven-cdk-plugin:3.3.3.Final or one of its depe
ndencies could not be resolved: Failed to read artifact descriptor for org.richf
aces.cdk:maven-cdk-plugin:jar:3.3.3.Final: Failure to find org.richfaces.cdk:mav
en-cdk-plugin:pom:3.3.3.Final in http://uk.maven.org/maven2 was cached in the lo
cal repository, resolution will not be reattempted until the update interval of
UK has elapsed or updates are forced -> [Help 1] 
```

他为什么要检查 maven2，它在我的本地仓库中？丁：

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-25T14:47:38.193

您必须使用[install plugin`](http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html)安装该 jar 。

```
mvn install:install-file -Dfile=[jar] -DgroupId=org.richfaces.cdk \
-DartifactId=maven-cdk-plugin -Dversion=3.3.3.Final -Dpackaging=jar 
```

Maven 将保留结构并生成它需要的东西。

尽量`mvn clean install -o`不要在互联网上查找依赖项。

也`echo $M2_REPO`。它应该指向.m2。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T14:39:20.797

首先，您提到的 maven-cdk-plugin 从未出现在 Maven Central 上，因为它可以通过richfaces 存储库获得，因此您还必须配置使用richfaces 存储库。这导致使用像[Archiva](http://archiva.apache.org)、[Artifactory](http://www.jfrog.org)或[Nexus](http://nexus.sonatype.org/)（按字母顺序）这样的存储库管理器。因此，您需要配置使用richfaces 存储库。

请参阅此处：[https](https://community.jboss.org/wiki/MavenRepository) ://community.jboss.org/wiki/MavenRepository如何执行此操作。

在这里你可以看到插件存在于这个仓库[https://repository.jboss.org/nexus/](https://repository.jboss.org/nexus/)

一件非常重要的事情。Maven Central 中的任何工件以后都不会被删除，否则**会破坏世界各地的构建**。

# php - 如何确定特定 mysql 表在代码的哪一行被更改？

> ID：10755958
> 
> 赞同：0
> 
> 时间：2012-05-25T14:12:53.817
> 
> 标签：php, mysql

我有一个正在处理的代码。而且它的巨大真的很大。有没有办法通过我的 php 代码的哪一行来理解特定的 mysql 表已被更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:32:11.777

@user1413647 您的问题似乎含糊不清！为了检查数据库进程，你应该在你的 php 代码中查找查询语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:42:49.000

如果你想知道你的代码在哪里改变了你的数据库，你必须通读你的代码——即使它很大。没有替代品。

您可以通过扫描提及您关注的数据库名称或表名称或列名称（如果您有特定信息）的代码来加速该过程。

# iphone - 每次用户登录应用程序时如何选择选项卡？

> ID：10755959
> 
> 赞同：0
> 
> 时间：2012-05-25T14:12:57.533
> 
> 标签：iphone, login, uitabbarcontroller

在我的应用程序中，我使用了一个包含 4 个选项卡的选项卡控制器。在其中一个选项卡中，添加了注销功能，我在单击注销选项卡时显示登录视图控制器。现在，当用户登录时，我希望默认选择第一个选项卡。如何设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T14:18:01.460

这样做：

```
TabBarController* tabBar =  thisIsYourTabBarInstance; //
[tabBar setSelectedIndex:4]; 
```

在标签的子级`UIViewController`使用中获取 TabBarController

```
TabBarController* tabBar = [self tabBarController]; 
```

像这样在应用程序委托中创建一个方法

在 AppDelegate.h 文件中

```
- (void)userIsLoggedOut; 
```

和 AppDelegate.m 文件

```
- (void)userIsLoggedOut    
{
    TabBarController* tabBar =  thisIsYourTabBarInstance; //
    [tabBar setSelectedIndex:4];
} 
```

现在在任何地方写这个：

```
AppDelegate *d= (AppDelegate*)[UIApplication sharedApplication].delegate;
[d userIsLoggedOut]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:15:31.233

在注销时设置一个 NSUSerDefault，确定在 AppDelegate 的 tabbarController 中首先显示哪个视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T14:18:44.597

您可以在 tabBarController 的 viewDidLoad 方法中设置活动选项卡

[[self tabBarController] setSelectedIndex:0];

# python - 如何在 mongo 中使用点符号查询带空格的字符串？

> ID：10755960
> 
> 赞同：3
> 
> 时间：2012-05-25T14:12:58.437
> 
> 标签：python, mongodb, pymongo

我在 mongo 数据库中有一个子对象，其中包含空格的字段，例如：

```
{name: "John Doe", subdata: {"Field 1": "Something", "Field 2": "Something else"}} 
```

据我所知，mongo 允许字段 1 和字段 2，但我无法找到任何指示如何构造查询以查找 subdata.Field 1。有没有办法我可以在我的示例中搜索字段 1 和字段 2，还是应该重组数据以消除空格？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T14:26:39.320

除非我误解了你的问题，否则你可以这样做：

```
db.test.find({ "subdata.Field 1" : 'Something' } );

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:20:22.847

好吧，我不了解 pymongo，但是许多其他语言的库都提供对象-文档映射功能。我敢打赌你也会遇到这个问题，因为“字段 1”在我听说过的每种语言中都是无效的标识符。

我的建议：去掉空格，你会在未来节省大量时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-30T11:13:15.977

空格是 Mongo 字段名称的有效字符。

[**字段名称限制**](https://docs.mongodb.com/manual/reference/limits/#Restrictions-on-Field-Names)

> 字段名称不能包含点（即.）或[空字符](https://en.wikipedia.org/wiki/Null_character)（即\0），并且它们不能以美元符号（即$）开头。

所以这种查找应该像一个魅力：

```
db.collection.find({"subdata.Field 1": {$exists: true}}) 
```

# windows - 设置文件修改时间在 1900 年之前

> ID：10755961
> 
> 赞同：0
> 
> 时间：2012-05-25T14:13:00.527
> 
> 标签：windows, perl, filesystems

我正在创建一个有问题的数据集，我希望将文件修改时间的年份设置为 <1900。我知道[Time::Local](http://perldoc.perl.org/Time/Local.html)使用 1900 年的偏移量。我想知道是否有任何方法可以使用此偏移量来创建修改时间发生在 1900 年之前的文件。（Windows 环境顺便说一句。）

这是我到目前为止一直在使用的代码：

```
use strict;
use warnings;
use File::stat; 
use Time::localtime;
use Time::Local;

my $file = "test.txt";      
my $when = timelocal(0,0,10,25,6,1899);

#current mod time of the file
my $datetime_string = ctime(stat($file)->mtime);
print $datetime_string,"\n";

#change the mod time of the file
utime $when, $when, $file;

#new mod time
$datetime_string = ctime(stat($file)->mtime);
print $datetime_string,"\n"; 
```

**编辑**：关于@ikegami 的评论，我确实开始研究`Win32::API`. 具体来说`Win32API::File::Time`。这是我到目前为止的代码：

```
use Win32API::File::Time qw{:win};
$filename="AnnotationTest.java";
($atime, $mtime, $ctime) = GetFileTime ($filename);
print $mtime,"\n";
SetFileTime ($filename, $atime, $mtime, $ctime);
($atime, $mtime, $ctime) = GetFileTime ($filename);
print $mtime,"\n"; 
```

有了这段代码，我不能 100% 确定修改时间的格式是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:41:34.700

我不确定 utime 是否支持那么远。如果它是从 1970 年开始的有符号 32 位偏移量，那么这只会让您对 1901 年产生影响。-(2**31) 附近是否有截止点？

# c# - 使用反射创建在构建时未知的接口的模拟

> ID：10755968
> 
> 赞同：4
> 
> 时间：2012-05-25T14:13:10.807
> 
> 标签：c#, reflection, dll, rhino-mocks, end-to-end

为了结束测试，重要的是我的测试程序集不会预加载依赖程序集的影子副本。

程序集 T 是加载和测试程序集 A 的测试框架。程序集 A 依赖于 B 中定义的接口。

出于测试目的，我必须替换 A 中的一些静态成员，而在构建时它们不可用。

这是一些伪代码，说明了我所处的困境：

```
 A_assembly = Assembly.LoadFrom("A.dll");
        A_type = A_assembly.GetType("TheSingleton.Master", true);
        MethodInfo Master_Init_Info = type.GetMethod("Init", BindingFlags.Public | BindingFlags.Static | BindingFlags.Instance);
        //before init is called some things need to be replaced
        FieldInfo semiknown = A_type.GetField("needsmocking", BindingFlags.Public | BindingFlags.Static));
        ??? mock_semiknown = MockRepository.GenerateMock<???>();
        semiknown.SetValue((???)mock_semiknown, mock_semiknown);
        //testing makes only sense if that static is replaced.
        Master_Init_Info.Invoke(null, null); 
```

1.  我可以通过访问该类型，`semiknown.FieldType`但这对我有什么好处？我可以以某种方式使用该信息来创建模拟并用它替换静态成员吗​​？
2.  假设我得到了类型并且能够替换静态成员 - 我如何在模拟中建立我的期望？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T06:39:53.143

你可以通过反射调用它

```
var method = typeof(MockRepository).GetMethod("GenerateMock").MakeGenericMethod(semiknown.FieldType);
var mock_semiknown = method.Invoke(null, null); 
```

# php - 在 PHP S3 上传时生成缩略图

> ID：10755970
> 
> 赞同：1
> 
> 时间：2012-05-25T14:13:20.977
> 
> 标签：php, amazon-s3, amazon-web-services

我有一个上传图像的 PHP 应用程序。我正在使用 S3 PHP 类 (http://undesign.org.za/2007/10/22/amazon-s3-php-class)

是否可以创建一个较小的缩略图并将其也上传到 S3？我在网上搜索，但找不到任何东西。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T00:28:56.973

文件上传到您的服务器后，您可以对它进行任何操作。PHP 会在变量中为你提供上传文件的临时位置`$_FILES['your_form_element_name']['tmp_name']`

从那里您可以使用 Imagick 调整文件大小，然后将调整大小的图像与原始图像一起上传到 S3。

Imagick 有一个`Imagick::thumbnailImage()`非常容易使用的方法。

有关 PHP 文件上传的更多详细信息： http ://www.php.net/manual/en/features.file-upload.post-method.php 有关如何在此处使用 Imagick 的更多信息： [http :](http://www.php.net/manual/en/features.file-upload.post-method.php) [//php.net /manual/en/book.imagick.php](http://php.net/manual/en/book.imagick.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T14:16:03.490

是的，有可能，有很多库可以为您调整图像大小。

[http://www.white-hat-web-design.co.uk/blog/resizing-images-with-php/](http://www.white-hat-web-design.co.uk/blog/resizing-images-with-php/)

调整图像大小后，只需以相同方式上传即可。

# ms-access - Access VBA 中的更新语句错误

> ID：10755977
> 
> 赞同：1
> 
> 时间：2012-05-25T14:13:39.183
> 
> 标签：ms-access, vba

我正在尝试更新名为“tbl_Responses”的表中的几列，但它在运行后给出了一个我一直试图找到的错误！

```
varX= DLookup("[ID]", tableName, "[supplierNum] = " & supplierNum)
updateFieldsTbl1="column1,column2,column3,column4"
updateValuesTbl1 ="name,lastname, bla bla"
'There is nothing wrong with those 3 variables above.

sqlUp = "UPDATE " & tableName & "(" & updateFieldsTbl1 & ")" & " SET " & "(" & _ updateValuesTbl1 & ") WHERE ID = " & varX
DoCmd.RunSQL sqlUp 
```

它在 UPDATE 语句行中给出错误。你能告诉我我做错了什么吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:36:28.893

您的字符串解析为：

```
UPDATE tableName (column1,column2,column3,column4) SET (name,lastname, bla bla) ... 
```

这类似于对`INSERT`a 无效的`UPDATE`格式，正确的格式是：

```
UPDATE tableName 
SET column1 = 'name',
    column2 = 'lastname',
    columnN =  valueN
WHERE ID = X 
```

因此构建字符串，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T14:38:22.607

这是 INSERT 的语法 - 对于 UPDATE 它是

```
UPDATE Table SET Field1=Value1, Field2=Value2, etc WHERE ... 
```

# sparql - sparql - 正则表达式不区分大小写

> ID：10755979
> 
> 赞同：0
> 
> 时间：2012-05-25T14:13:43.397
> 
> 标签：sparql

我在 C# 中使用 SemWeb.Sparql.dll 通过 C# 在 sparql 中执行一些查询我需要将给定的字符串变量与我的本体中的字符串（rdfs:label）进行比较，但我需要这个比较不区分大小写，所以我使用了正则表达式功能。我使用了这个查询：

```
disease = "'^" + disease + "'";
string query = prefixes + @"
               Select ?a ?name Where{
               ?a ?c owl:Class .
               ?a rdfs:label ?name.
               FILTER (Regex(?name," + @disease + ",'i'))}"; 
```

在某些情况下可以正常工作，而在其他情况下则不能。任何人都可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:33:43.757

您可以尝试以下方法：

```
FILTER (regex(str(?name), ... 
```

即包裹`?name`。`str()`这将确保第一个参数是一个字符串。

# java - Pdf 签名有效性复选标记在 Acrobat Reader 上不可见

> ID：10755989
> 
> 赞同：0
> 
> 时间：2012-05-25T14:14:26.513
> 
> 标签：java, pdf, itext, signature

我正在用 iText 签署一个 pdf 文件。当我在 Acrobat Reader 9 上查看文件时，签名矩形内没有像以前在 Acrobat Reader 7 中那样出现绿色勾号。

请注意，我可以在页面顶部看到有效标记，但我特别希望该标记出现在签名矩形中。

有人说 Acrobat 版本 9 不再支持此功能，但是我查看了一些在版本 9 上带有绿色复选标记的数字签名文件。

那么，我需要使用 itext 上的特定标志或图层吗？我已经使用 setAcro6Layers、setVisibleSignature、setLayer2Text、setLayer2Font、setImage、setImageScale 等。

任何帮助深表感谢。谢谢

![在 Acrobat Reader 9 上看到的 pdf 文件文件绿色复选标记的屏幕截图](../Images/9fab5f38f1f0b16cc9fb1e84d2daff91.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:44:39.380

事实证明我只需要将 Acro6Layers 设置为 false 并且不使用 setImage 方法设置任何图像...而不是 setImage，我使用了 setSignatureGraphic 方法...

```
pdfSignatureAppearance.setAcro6Layers(false);
pdfSignatureAppearance.setImage(null);
pdfSignatureAppearance.setSignatureGraphic(Image...); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T13:13:29.087

```
pdfSignatureAppearance.setAcro6Layers(true);
pdfSignatureAppearance.setImage(null); 

using itext-2.1.7.jar 
```

# java - 根据内容调整 SmartGWT 窗口大小

> ID：10755990
> 
> 赞同：6
> 
> 时间：2012-05-25T14:14:29.630
> 
> 标签：java, gwt, smartgwt

我正在尝试`SmartGWT Window`根据其内容确定尺寸。

将元素添加到 Window 的正确方法是通过`addItem`方法。

因此，当我运行此代码时，窗口不会调整大小。但是，如果我通过调整大小添加标签`addMember`可以正常工作，但这会破坏窗口外观

```
Window window = new Window();
window.setOverflow(Overflow.VISIBLE);

window.addItem(new Label("aaaaaaaa"));
window.addItem(new Label("aaaaaaaa"));
window.addItem(new Label("aaaaaaaa"));
window.addItem(new Label("aaaaaaaa"));
window.addItem(new Label("aaaaaaaa"));
window.show(); 
```

有任何想法吗 ？

*使用 SmartGWT 2.5*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T14:32:47.193

我错过了 AutoSize 属性...按预期工作

```
window.setAutoSize(true); 
```

# .htaccess - htaccess www 到非 www 不适用于子目录

> ID：10755992
> 
> 赞同：0
> 
> 时间：2012-05-25T14:14:34.833
> 
> 标签：.htaccess

我正在使用以下 .htaccess 代码。

.htaccess 在根文件夹中

```
#for redirecting www to non-www
RewriteCond %{HTTP_HOST} ^www\.(.*)
RewriteRule (.*) http://%1/$1 [R=301,L]

#temporary redirect root to dir/
RedirectMatch ^/$ /dir/ 
```

.htaccess 在 dir 文件夹中

```
RewriteEngine  on
#for changing index file to a custom one
DirectoryIndex abc.php?tag=ho

#for simple url
RewriteRule ^what/([^/]*)\.html$ /dir/abc.php?tag=$1 [L] 
```

使用当前代码 www.domain.com 重定向到 domain.com 但 www.domain.com/dir/ 不重定向。

我需要修改两点：

1.  将 www 重定向到非 wwww
2.  将 domain.com 重定向到 domain.com/dir/

请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T19:16:19.197

结合 Redirect(match) 和 rewriterule 是自找麻烦。而不是您的 RedirectMatch 使用：

```
RewriteCond $1 !^dir/
RewriteRule ^(.*)$ /dir/$1 [R=301,L] 
```

# android - 如何获取所有联系人及其所有属性

> ID：10755994
> 
> 赞同：4
> 
> 时间：2012-05-25T14:14:40.663
> 
> 标签：android, contacts

有人知道获取所有联系人及其所有属性（姓名、电话、电子邮件……）的舒适方法吗？

我需要一个适用于 Android 1.5 到 4.0 的解决方案。

多谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T14:24:35.783

要获取姓名和号码，请使用以下代码::

```
private void getNameNumber(){
        Uri uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
        ContentResolver cr = getContentResolver();
        Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI,null, null, null, null);
        String[] projection    = new String[] {ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
                        ContactsContract.CommonDataKinds.Phone.NUMBER };
        Cursor names = getContentResolver().query(uri, projection, null, null, null);

        int indexName = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
        int indexNumber = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);
        names.moveToFirst();
        do {

            String name   = names.getString(indexName);
            Log.e("Name new:", name);
            String number = names.getString(indexNumber);
            Log.e("Number new:","::"+number);

        } while (names.moveToNext());
    } 
```

并获取所有详细信息，请使用以下代码并根据您的要求进行修改。

```
private void getDetails(){
        Uri uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
        ContentResolver cr = getContentResolver();
        Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI,null, null, null, null);
            String[] projection    = new String[] {ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
                        ContactsContract.CommonDataKinds.Phone.NUMBER ,ContactsContract.CommonDataKinds.Email.DATA };
        Cursor names = getContentResolver().query(uri, projection, null, null, null);

        int indexName = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
        int indexNumber = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);
        names.moveToFirst();
        do {

            String name   = names.getString(indexName);
            Log.e("Name new:", name);
            String number = names.getString(indexNumber);
            Log.e("Number new:","::"+number);

        } while (names.moveToNext());
        // email

            while (cur.moveToNext()) {
                String id = cur.getString(cur.getColumnIndex(ContactsContract.Contacts._ID));
                Cursor email = cr.query( 
                        ContactsContract.CommonDataKinds.Email.CONTENT_URI, null,
                        ContactsContract.CommonDataKinds.Email.CONTACT_ID + " = ?", 
                                new String[]{id}, null); 
                while (email.moveToNext()) { 
                    //to get the contact names
                    // if the email addresses were stored in an array
                    String emailid = email.getString(email.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
                    Log.e("Email id ::", emailid);
                    String emailType = email.getString(email.getColumnIndex(ContactsContract.CommonDataKinds.Email.TYPE)); 
                    Log.e("Email Type ::", emailType);

                } 
                email.close();
            }

        //address
            while (cur.moveToNext()) {
            String id = cur.getString(cur.getColumnIndex(ContactsContract.Contacts._ID));
            Cursor addrCur = cr.query(ContactsContract.CommonDataKinds.StructuredPostal.CONTENT_URI,null,
                    ContactsContract.CommonDataKinds.StructuredPostal.CONTACT_ID+ " = ?",
                    new String[] { id },null);
            while(addrCur.moveToNext()) {
                String street = addrCur.getString(addrCur.getColumnIndex(ContactsContract.CommonDataKinds.StructuredPostal.STREET));
                Log.e("Street ::", street);
                String city = addrCur.getString(addrCur.getColumnIndex(ContactsContract.CommonDataKinds.StructuredPostal.CITY));
                Log.e("City ::", city);
                String state = addrCur.getString(addrCur.getColumnIndex(ContactsContract.CommonDataKinds.StructuredPostal.REGION));
                Log.e("State ::", state);
                String postalCode = addrCur.getString(addrCur.getColumnIndex(ContactsContract.CommonDataKinds.StructuredPostal.POSTCODE));
                Log.e("Postal Code ::", postalCode);
            } 
            addrCur.close();

        }
    } 
```

# hibernate - JBoss 7 + 休眠 + Log4j

> ID：10755995
> 
> 赞同：2
> 
> 时间：2012-05-25T14:14:44.247
> 
> 标签：hibernate, jboss, log4j, jboss7.x

我以 Jboss 7.1 中的 log4j 快速入门为起点设置了我的 Java EE 6 应用程序。

我的关键 pom.xml 添加是：

```
<dependencyManagement>
        <dependencies>
            <!-- Define Log4j dependency and its version -->
            <dependency>
                <groupId>log4j</groupId>
                <artifactId>log4j</artifactId>
                <version>${log4j.version}</version>
            </dependency>
...
        </dependencies>
    </dependencyManagement>

<dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <scope>provided</scope>
        </dependency> 
```

版本是 1.2.16。

现在我可以这样做：

> private static final Logger logger = Logger.getLogger(MacchinarioController.class);

并按预期使用记录器。好的！

我没有 log4j.xml 也没有 .properties 文件。

现在我希望 Hibernate 在控制台中打印所有正在执行的 SQL 语句，**包括参数值**。

我创建了这个 log4j.xml 并将其放在 src/main/resources 源文件夹中：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration>

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">

    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        <param name="Threshold" value="info"/>
        <param name="Target" value="System.out"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d{ABSOLUTE} [%t] %-5p %c{1} - %m%n"/>
        </layout>
    </appender>

    <appender name="rolling-file" class="org.apache.log4j.RollingFileAppender">
        <param name="file" value="Program-Name.log"/>
        <param name="MaxFileSize" value="1000KB"/>
        <param name="MaxBackupIndex" value="4"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] %-5p %l - %m%n"/>
        </layout>
    </appender>
    <logger name="org.hibernate">
        <level value="ALL" />
    </logger>

    <root>
        <priority value ="debug" />
        <appender-ref ref="console" />
        <appender-ref ref="rolling-file" />
    </root>
</log4j:configuration> 
```

但是什么都没有出现，我在哪里做错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:55:14.627

您是否使用[jboss-deployment-structure.xml](https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F)来排除 log4j 的服务器版本？

如果您从头开始应用程序，我绝对不会选择 log4j。我偏向于 JBoss Logging，但 JBoss Logging、slf4j 或 logback 都比 log4j 好得多。

默认情况下，JBoss AS 7 使用 JBoss 日志和 JBoss 日志管理器。虽然你真的会/可以只使用 JBoss Logging，因为它可以与任何日志管理器一起使用。

如果您确实想使用 log4j，请不要使用 log4j 配置。将记录器/类别添加到记录子系统以查看您正在寻找的结果。

话虽如此，在 JBoss AS 7 的下一个版本中，您的 log4j 配置将被找到，并且会按照您期望的方式为您工作。更改已推送到[上游](https://github.com/jbossas/jboss-as/commit/6da8615681b86c8cde2cd1d3d84188a67466f07e)。

# sql - Informix 存储过程错误

> ID：10755996
> 
> 赞同：1
> 
> 时间：2012-05-25T14:14:44.520
> 
> 标签：sql, informix

我正在尝试创建一个简单的过程，在给定数字时查找 fname 和 lname

```
create procedure _lookup_name (_no int)
select (fname || ' ' || lname)  from table where number = _no;
end procedure; 
```

我不断收到一条错误消息，说“SELECT 语句需要 INTO TEMP 表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:20:03.333

您需要将`select`语句的结果放入变量或表中。请参阅： [w3schools（进入表）](http://www.w3schools.com/sql/sql_select_into.asp)或[内存中的临时表](http://www.sqlteam.com/article/using-table-variables)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-29T17:09:30.650

也许 ：

```
define var1 char(30);
define var2 char(30);
create procedure _lookup_name (_no int)
    select (fname || ' ' || lname) into var1,var2 from table where number = _no;
end procedure; 
```

# django - 如何向所有 django 模板添加方法？

> ID：10755997
> 
> 赞同：0
> 
> 时间：2012-05-25T14:14:46.487
> 
> 标签：django, django-templates

向我的项目中的所有模板添加类似方法的功能的最佳方法是什么？

我需要的方法如下：

```
def has_access(user, code):
    return user has access to code 
```

在模板中，它可以像这样使用：

```
{% if has_access(request.user, 'add-project') %}
    html code here
{% endif %} 
```

自定义过滤器不起作用，因为我没有“过滤”任何东西。此外，据我所知，自定义上下文处理器不接受额外参数。

不知道如何在 django 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:29:11.573

自定义过滤器实际上可以工作：

```
{{ user|has_access:code }} 
```

自定义模板标签可以工作：

```
{% has_access user code %} 
```

中间件可以工作......但如果没有更多信息，很难说出解决您的问题的最佳方法是什么。

# c# - 需要帮助添加停止按钮 --> HttpWebRequest

> ID：10755999
> 
> 赞同：0
> 
> 时间：2012-05-25T14:14:52.820
> 
> 标签：c#, wpf, httpwebrequest

我有一个程序，当按下该按钮时，它有一个名为“research”的按钮，它从输入文本框中读取，可能会显示“how to *”

它开始从谷歌中提取自动建议，星号被字母表中的每个字母替换。

我的问题是：

我想要一个按钮来停止搜索。当它在运动时。

实现这一目标的最佳方法是什么？

```
private void btnResearch_Click(object sender, RoutedEventArgs e)
        {            
            if (string.IsNullOrWhiteSpace(txtResearch.Text.Trim()))
            {
                MessageBox.Show("Please enter a search query", "Oops", MessageBoxButton.OK, MessageBoxImage.Exclamation);
                return;              
            }
            //Robin: Temporal fix to the multi asterisk
            if (txtResearch.Text.Trim().Count(s => s == '*') > 1)
            {
                MessageBox.Show("Too many asterisk", "Oops", MessageBoxButton.OK, MessageBoxImage.Exclamation);
                return;            
            }

            if (!ValidateLimitations())
            {
                return;
            }

            ((LongTailBot.MainWindow)App.Current.MainWindow).PlaySound("button_double_click.wav");

            this.chbSelAll.IsChecked = false;
            List<KeywordItem> keyList = new List<KeywordItem>();
            this.dgrResearch.ItemsSource = null;

            List<string> seetKeywords = SetupSeetKeywords(txtResearch.Text.Trim().Replace(" ", "%20"));
            if (seetKeywords.Count() < 1)
                return;

            foreach (string seetKey in seetKeywords)
            {
                this.txbResearch.Text = (seetKeywords.IndexOf(seetKey) + 1).ToString()
                    + "/" + seetKeywords.Count() + " " + seetKey.Replace("%20", " ");
                Application.Current.Dispatcher.Invoke(DispatcherPriority.Background,
                                                      new Action(delegate { }));

                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(this.GetRequestUriString(seetKey));
                request.Method = "GET";
                request.UserAgent = @"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0)";
                WebResponse response = request.GetResponse();

                if (((HttpWebResponse)response).StatusDescription.Trim().ToUpper() == "OK")
                {
                    using (Stream dataStream = response.GetResponseStream())
                    {
                        using (StreamReader reader = new StreamReader(dataStream))
                        {
                            string responseFromServer = reader.ReadToEnd();

                            var keywordsFound = this.GetKeywordsFound(responseFromServer);
                            foreach (var key in keywordsFound)
                            {
                                keyList.RemoveAll(k => k.Keyword == key);                                                                
                                keyList.Add(new KeywordItem() { Checked = false, Keyword = key });

                                Application.Current.Dispatcher.Invoke(DispatcherPriority.Background,
                                          new Action(delegate { }));                                
                            }

                        }
                    }
                    if (keyList.Count > 0)
                    {
                        dgrResearch.ItemsSource = null;
                        dgrResearch.ItemsSource = keyList;
                        dgrResearch.ScrollIntoView(dgrResearch.Items[dgrResearch.Items.Count - 1]);                        
                    }
                }

                response.Close();                
            }

            this.txbResearch.Text = this.dgrResearch.Items.Count.ToString() + " POPULAR PHRASES AVAILABLE!";            
            this.chbSelAll.IsChecked = dgrResearch.Items.Count > 0? true : false;
            ((LongTailBot.MainWindow)App.Current.MainWindow).PlaySound("abstractbtn.wav");
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T18:44:34.987

您应该使用[BeginGetResponse](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetresponse%28v=vs.100%29.aspx)方法并将您的响应处理作为回调参数传递。然后在您的取消按钮中，调用[中止](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.abort.aspx)方法。

没有尝试过，但这通常应该有效。