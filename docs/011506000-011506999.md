# StackOverflow 问答 11506000-11506999

# python - django.core.exceptions.ImproperlyConfigured：找不到带有标签测试的应用程序？

> ID：11506000
> 
> 赞同：0
> 
> 时间：2012-07-16T14:02:46.983
> 
> 标签：python, django

我有一个项目结构

```
myApp/
     apps/
         tests/
              __init__.py
              tests.py 
```

外观`tests.py`如下

```
from django.test import TestCase

class VideoTest(TestCase):
    def test_video_insert(self):
        self.assertTrue(true) 
```

当我尝试从命令行对此进行测试时，我会

```
dirBeforeMyApp$python manage.py test test.VideoTest --settings=myApp.settings.dev 
```

我看到以下错误

```
 File "/Users/user/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/loading.py", line 152, in get_app
    raise ImproperlyConfigured("App with label %s could not be found" % app_label)
django.core.exceptions.ImproperlyConfigured: App with label test could not be found 
```

我在这里没有做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:08:08.777

好吧，您的应用程序称为测试，复数..无论如何，出于明显的原因，您可能希望避免使用该名称

# javascript - 如何等到异步请求完成

> ID：11506010
> 
> 赞同：0
> 
> 时间：2012-07-16T14:03:30.400
> 
> 标签：javascript, ajax

我有一个 ajax 注册表单。用户可以在输入字段中输入所需的用户名，然后立即点击注册按钮，而检查用户名是否可用的 ajax 请求尚未完成。对于这种情况，我希望仅当检查用户名的 ajax 请求完成时才开始执行注册按钮的操作，否则等待它完成然后继续。这该怎么做？

我希望用户名验证功能保持异步，因为每次用户在输入字段上进行按键操作时它都会执行。

一种方法是在单击注册按钮时进入 setTimeout() 循环，并一直停留在该循环中，直到标志正确为止。另一种方法是在异步请求未完成时调用同步用户名检查请求。有没有更好的方法？

如果您在不使用 jQuery 的情况下给出答案，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:05:35.027

不要为此使用 setTimeout。

只需使用[jquery ajax](http://api.jquery.com/jQuery.ajax/)`success`的回调功能：在回调或新`done`助手中执行“之后”代码：

```
$.ajax({
  url: "test.html"
}).done(function() { 
  // do things after the answer has been received
}); 
```

**编辑 ：**

没有 jquery，也没有立即触发：

```
var httpRequest = new XMLHttpRequest();
var requestDoneAndOK = false;
httpRequest.onreadystatechange = function() {
    if (httpRequest.readyState === 4) {
        if (httpRequest.status === 200) {
                requestDoneAndOK = true;
        }               
    }
};
httpRequest.open('GET', url);
httpRequest.send(); 
```

当“注册”按钮被点击时，你只需要检查`requestDoneAndOK`它是否真的调用你的其他函数。

**编辑 2：**

一旦实现 2 个条件，就会执行代码：收到答案并单击注册按钮。

```
var registerClicked = false;
var ajaxAnswerReceived = false;
function check() {
    if (registerClicked && ajaxAnswerReceived) {
         // do the thing !
    }
}
var httpRequest = new XMLHttpRequest();
var requestDoneAndOK = false;
httpRequest.onreadystatechange = function() {
    if (httpRequest.readyState === 4) {
        if (httpRequest.status === 200) {
              ajaxAnswerReceived = true;
                check();
        }               
    }
};
httpRequest.open('GET', url);
httpRequest.send();
document.getElementById('registerButton').onclick = function(){
     registerClicked = true;
     check();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:10:56.747

如果您想在不使用 jQuery 的情况下执行此操作，则需要使用使用 onreadystatechange 的默认 JavaScript 调用机制。请记住，jQuery 只是默认机制的一个包装器。我确实建议您使用 jQuery 或其他东西，以防止出现大量跨浏览器问题和 http 状态更改逻辑。

在此处阅读有关本机内容的所有信息：http: [//www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp](http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:14:37.840

您需要使用回调并存储验证标志布尔值，然后您需要在用户提交注册页面之前对其进行检查。这是一个jquery实现，但是把它变成普通的js并不难。该方法在这里定义：

```
var goodUsername = false;

// keyup handler, pseudo code 
$('#username').keyup(function(event) { 
    // perform the username validation with an ajax call:
    $.ajax({
        url: "validateUsername.php"
    }).done(function(data) {
        // set the goodUsername if its good or not
        if (data.usernameIsGood)
            goodUserName = true;
    });
});

// submit the registration form only if the username has been checked and is good
$('#registrationFormButton').click(function(event){
     if (goodUsername)
         return true; // allows the browser to submit the form
     else
         return false;
}); 
```

# iphone - 断点在 Xcode 3.2.5 中不起作用

> ID：11506015
> 
> 赞同：-4
> 
> 时间：2012-07-16T14:03:44.157
> 
> 标签：iphone, breakpoints

我正在使用 Xcode 3.2.5。我在代码中保留了断点。但它不起作用。任何人都可以告诉如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:34:54.083

在 Xcode 4.4 刚刚转为 GM 并准备提交应用程序的时候，您可能不太幸运地回答了这个问题。Xcode 3*真的很*老了，而且有相当多的问题。分手后要往前看了。

公平地说，即使在 Xcode 4 中，断点也不*总是*有效。但是 LLDB 变得更好了，而且现在非常可靠。

# javascript - 在javascript中从css中查找数据

> ID：11506016
> 
> 赞同：1
> 
> 时间：2012-07-16T14:03:50.020
> 
> 标签：javascript

我现在在 css 中定义了几种颜色我想获取所有颜色并进行一些检查，例如用所有颜色构建新对象，在这种情况下，我希望对象包含第一个第二个和第三个颜色的数据运行时有可能吗？

```
<html>
<head>
  <style>

   p.first { color: gray; }
   p.second { color: red; }
   p.third { 
    background: purple;
    color: white;
   }

  </style>
</head>
<body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:07:25.043

[jQuery](http://jquery.com/)让这种事情变得微不足道。

一旦你加载了 jQuery，你可以做一些简单的事情（使用[jQuery.css](http://api.jquery.com/css/)）：

```
var color = jQuery("p.first").css("color"); 
```

按照您在问题中的说明设置对象：

```
var colors = {firstcolor:jQuery("p.first").css("color"), secondcolor:jQuery("p.second").css("color")}; 
```

注意：这将返回 RGB 值。要转换为十六进制，请参阅[此 Stackoverflow 答案](https://stackoverflow.com/questions/638948/background-color-hex-to-javascript-variable-jquery/639030#639030)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:20:05.647

不用 jQuery 也很简单：

```
var p = document.getElementsByTagName('p');
var first = p.getElementsByClassName('first');
console.log(first.item(0).style.color); // etc 
```

# google-maps - Google 地图 - 自定义磁贴 - 基于 URL

> ID：11506017
> 
> 赞同：0
> 
> 时间：2012-07-16T14:03:56.380
> 
> 标签：google-maps

我有一个返回 PNG 的 REST URL。现在我需要在 GMaps 中渲染那个 PNG。如果我使用 getTileURL、新 GtileLayerOverlay 和 addOverlay，它似乎会将 PNG 添加到每个 GMaps 磁贴中。任何人都有任何关于如何正确渲染这样的 PNG 并处理不同缩放的示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T00:01:38.020

您想制作自定义叠加层。请参阅[https://developers.google.com/maps/documentation/javascript/overlays#CustomOverlays](https://developers.google.com/maps/documentation/javascript/overlays#CustomOverlays)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:19:01.257

不允许直接访问瓷砖。请参阅：[https ://developers.google.com/maps/faq#tos_tiles](https://developers.google.com/maps/faq#tos_tiles)

# python - Python正则表达式搜索数字

> ID：11506018
> 
> 赞同：0
> 
> 时间：2012-07-16T14:04:01.243
> 
> 标签：python, regex

我是正则表达式的新手，但是通过字符串查找是否存在模式。

我尝试使用以下 python 代码：

```
prog=re.compile('555.555.555')
m=prog.match(somestring)
if m: print somestring 
```

我试图找到由任意数字分隔的 3 组 5。不过，此代码不会返回我正在寻找的内容。

有什么建议么？

编辑：

这是一些测试更基本版本的代码：

```
i,found=0,0
while found==0:
    istr=str(i)
    prog=re.compile(r'1\d2\d3')
    m=prog.search(istr)
    if m:
        print i
        found=1
        break
    i=i+1 
```

这将返回 1312 而不是 10203

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:06:24.953

你的正则表达式没问题（有点），但你用错了。你需要

```
m = prog.search(somestring) 
```

或者正则表达式[只会在字符串的开头找到匹配项](http://docs.python.org/library/re.html#re.match)。

此外，如果您真的只想在每组`555`s 之间允许一个数字，请使用

```
prog = re.compile(r'555\d555\d555') 
```

# python - 在 pyplot 的顶部和底部添加填充

> ID：11506020
> 
> 赞同：3
> 
> 时间：2012-07-16T14:04:05.907
> 
> 标签：python, matplotlib, padding

我正在使用以下代码生成 pyplot：

```
plotCount = 1
for key in resultsDictionary:
  count = 1
  p1 = plt.subplot(5,1,plotCount)
  plotCount+=1
  for item in resultsDictionary[key]:
    print count , item , key
    plt.plot(item, count, marker='o')
    count+=1 
```

生成的图在图表上“压扁”了顶部和底部的结果。如何在图表顶部添加某种填充和图表大小（或者是否可以设置图表的确切大小（我知道最小/最大值）。

如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T15:04:39.040

您可能想看一下[tight_layout 指南](http://matplotlib.sourceforge.net/users/tight_layout_guide.html)，它描述了如何自动执行此类操作。不过，这只是最近才引入的（在 1.1 版中）。

[或者，如果您使用add_axes](http://matplotlib.sourceforge.net/api/figure_api.html#matplotlib.figure.Figure.add_axes)命令而不是 subplot()，您可以获得更多控制权，它允许您设置每个图形的相对位置和大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T15:02:30.813

我想你是在问关于设置图表的限制。您需要添加

```
plt.set_xlim([xmin,xmax])
plt.set_ylim([ymin,ymax]) 
```

到您在外循环中的代码（具有合理的值`xmin,xmax,ymin,ymax`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-16T22:02:55.987

布局调整对我不起作用，因为整个图形只会在标签仍然被压扁或超出范围的情况下调整大小。

我发现的一种解决方法是让 y 轴始终在最高或最低 y 值之上保持一定的余量：

```
x1,x2,y1,y2 = plt.axis()
plt.axis((x1,x2,y1 - 100 ,y2 + 100)) 
```

# ios - 如何将关闭按钮添加到 UIwebview

> ID：11506027
> 
> 赞同：0
> 
> 时间：2012-07-16T14:04:25.157
> 
> 标签：ios, button, webview

我创建了一个 webview 并在同一个 ViewController 的另一个视图上使用按钮加载它。webview 正在从 Doc 目录加载一个 pdf 文件。到目前为止一切正常。但是现在用户应该有一个按钮来关闭 webview。我该怎么做呢？

谢谢您的回答！

编辑：现在我设法添加了关闭按钮。请参阅下面的更新代码。但是如果我尝试关闭

这是我的代码，它创建了 webview：

```
- (IBAction)globeButton:(id)sender {
NSArray *paths = NSSearchPathForDirectoriesInDomains
(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

NSString *filePathAndDirectory = [documentsDirectory stringByAppendingPathComponent:@"files"];

NSString *fileName = [NSString stringWithFormat:@"%@/PDFfilename.pdf", 
                      filePathAndDirectory];

UIWebView *webView = [[UIWebView alloc] initWithFrame:CGRectMake(10, 50, 900, 650)];

NSURL *targetURL = [NSURL fileURLWithPath:fileName];
NSURLRequest *request = [NSURLRequest requestWithURL:targetURL];
[webView loadRequest:request];
[self.view addSubview:webView];
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[button addTarget:self 
           action:@selector(aMethod:)
 forControlEvents:UIControlEventTouchDown];
[button setTitle:@"Close" forState:UIControlStateNormal];
button.frame = CGRectMake(390, 605, 160, 40);
[button addTarget:self action:@selector(close:) forControlEvents:UIControlEventTouchDown];
[webView addSubview:button];} 
```

但是下一行导致错误：-[SecondViewController aMethod:]: unrecognized selector sent to instance 0x78327c0'

*   (IBAction)close:(id)sender {[self.GlobeWebView removeFromSuperview];}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:08:44.227

遵循[UIWebViewDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)协议，您可以等待页面加载完成，也可以在 webView 自身添加后将按钮添加为 webView 子视图。在此“关闭”按钮操作中，您需要在取消 Web 视图加载后从超级视图中删除按钮和 Web 视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T14:49:19.093

你的**方法：**有任何参数吗？如果不删除选择器中的**:**。

# wpf - WPF DataGrid 按名称对列进行排序

> ID：11506029
> 
> 赞同：0
> 
> 时间：2012-07-16T14:04:34.763
> 
> 标签：wpf, datagrid, wpfdatagrid

我有一个 Datagrid，它作为 Itemssource 获得一个 DataTable：

```
dataGrid.ItemsSource = transfer.DataTarget.Table.DefaultView; 
```

但现在主要问题是他按名称对列进行了处理。例如：我有一个包含此列的表：XYZUV

我得到显示：UVXYZ

我怎样才能禁用它。我也试过这个：

```
private void LoadTransfer(Transfer transfer)
{
    dataGrid.ItemsSource = transfer.DataTarget.Table.DefaultView;
    //spalten selbst genererieren damit diese nicht nach alphabeth geordnet werden
    int index = 0;
    foreach (DataColumn column in transfer.DataTarget.Table.Columns)
    {
        dataGrid.Columns.Add(new DataGridTextColumn()
        {
            Header = column.ColumnName,
            Binding = new Binding(column.ColumnName),
            DisplayIndex = index++
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:55:42.257

创建一个新属性，该属性保存表示为整数的值的权重。然后在有排序问题的列上将它的**SortMemberPath**设置为该属性。

# iphone - 如何将 nsstring 转换为 php 也支持的加密格式？

> ID：11506032
> 
> 赞同：0
> 
> 时间：2012-07-16T14:04:41.733
> 
> 标签：iphone, encryption, nsstring, cryptography

我想将一个转换`NSString`成某种加密格式，然后也解密它，但问题是我使用的是 php web 服务，我也关心我使用的方法是否受支持。

所以我想要一些在objective-c和php之间都支持或兼容的方法。我的字符串在服务器上，所以我想转换它们。

提前致谢：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:10:31.540

[RNCryptor github链接](https://github.com/rnapier/RNCryptor)

我在这个库上取得了很好的成功，你只需调用`encryptData:`你想要的任何选项，然后`decryptData`稍后再取回它。有关详细信息，请参阅 github 页面以及 RNCryptor.h 和 .m，如果您想实际了解正在发生的事情。

# python - 对基于文本的信息进行分类（即实现字符串内核）

> ID：11506033
> 
> 赞同：0
> 
> 时间：2012-07-16T14:04:41.943
> 
> 标签：python, machine-learning, cluster-analysis, svm

我需要对一组消费者数据运行聚类算法，但我不确定如何处理基于文本的字段（完美的例子是字母数字邮政编码，例如 SE1 8XR）。

显然我需要使用的是一个字符串内核，我理解它的基本思想，但还不足以成功实现。

理想情况下，我希望新的数字向量能够编码这样一个想法，即两个邮政编码越不同，数据点彼此之间的距离就越远，但不知道如何做到这一点，而且我找不到一个有用的教程、指南或教科书！

我也在 Python 中执行此操作，以防有人知道某些库可能有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:14:50.520

**重新邮政编码**

您不能将邮政编码作为字符串进行比较。“AL1 1AA”是圣奥尔本斯，“AB1 1AA”是阿伯丁。它们的编辑距离非常接近，但 CR6 7DX 更接近圣奥尔本斯 :)

你最好的方法可能是从[http://www.ordnancesurvey.co.uk/oswebsite/products/os-opendata.html](http://www.ordnancesurvey.co.uk/oswebsite/products/os-opendata.html)获取一些查找表（我知道你可以从 Royalmail 购买它们），它需要一个邮政编码，或者在例如，至少一个扇区“AL1 1”（甚至可能是“AL1”区），并将其映射到纬度/经度，然后您可以将其用于存储数据。

**其他字符串**

一种可能的选择是使用`difflib.SequenceMatcher`它返回两个字符串彼此相似程度的百分比分数（那里有很多其他算法：谷歌“遗传字符串算法”、“模糊字符串匹配”、“字符串相似度算法”等...）。将所有（可能）80% 相似的字符串分组，并将它们分配给一个组 - 然后在该组上进行聚类。

`ntlk`根据您的要求和数据的复杂性，您还可能会发现变音位和双变位音（并且可能）很有用。

# php - Yii 与 WYSIWYG 编辑器如何连接并上传图片？

> ID：11506043
> 
> 赞同：-2
> 
> 时间：2012-07-16T14:05:25.503
> 
> 标签：php, image, frameworks, yii, wysiwyg

任何扩展？或示例代码，请帮助）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T09:36:29.927

您可以使用 redactorjs 进行检查。
这是扩展页面： [http ://www.yiiframework.com/extension/yii-redactorjs-wysiwyg-widget](http://www.yiiframework.com/extension/yii-redactorjs-wysiwyg-widget)

您还应该查看文档： [http ://redactorjs.com/docs/](http://redactorjs.com/docs/)

我希望这将有所帮助。

# shell - 传递文件中存在的命令行参数

> ID：11506047
> 
> 赞同：0
> 
> 时间：2012-07-16T14:05:28.933
> 
> 标签：shell, automation, command-line-arguments

我有一个需要某些命令行参数的可执行文件。我正在自动安装软件。此可执行文件是自动化 shell 脚本的一部分。此脚本的参数之一存储在一个文件中，比如说 file.txt。它有一个字符串，它是这个可执行文件的参数。如何将此字符串传递给 shell 脚本中的可执行文件？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:23:57.347

这适用于`bash`：

```
echo -l > foo
ls $(< foo) 
```

# mysql - 错误类型：ADODB.Recordset (0x800A0E79) 对象打开时不允许操作

> ID：11506053
> 
> 赞同：0
> 
> 时间：2012-07-16T14:05:40.587
> 
> 标签：mysql, excel, ms-access, asp-classic

我正在处理此代码，但它给了我一个错误，提示错误类型：ADODB.Recordset (0x800A0E79) 对象打开时不允许操作。我以前从未遇到过这个错误。我要做的是在特定文件夹中掺杂新文件时更新访问文件。我用完美工作的excel做同样的事情，当我向它添加访问部分时，它给了我错误。这是我的代码，如果我能得到一些帮助，那就太好了。

```
<!--#include file="header.inc"-->
<%

file = Request.querystring("file")

file = "C:\Reports\" & file

log("UPDATE UTILITY RUN---------" & file)

'Initialize Connection to report

Const adOpenStatic = 3

Const adLockOptimistic = 3

Const adCmdText = &H0001

Set objConnection = CreateObject("ADODB.Connection")

Set rows = CreateObject("ADODB.Recordset")

objConnection.Open "Provider=Microsoft.ACE.OLEDB.12.0;" & _

    "Data Source=" & file & ";" & _

        "Extended Properties=" &  Chr(34) & "Excel 12.0 Xml;HDR=No;IMEX=1" & Chr(34) & ";"  

'Initlialize Connection to Data

Set objConnection2 = CreateObject("ADODB.Connection")

Set rows2 = CreateObject("ADODB.Recordset")

objConnection2.Open "Provider=Microsoft.ACE.OLEDB.12.0;" & _

    "Data Source=" & Server.MapPath("data.xlsx") & ";" & _

        "Extended Properties=" &  Chr(34) & "Excel 12.0 Xml;HDR=Yes;IMEX=0" & Chr(34) & ";"  

'initialize Connection3 to Data

Set objConnection3 = CreateObject("ADODB.Connection")

Set rows3 = CreateObject("ADODB.Recordset")

objConnection3.Open "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & 
Server.MapPath("tracker_dev_nik.accdb") & ";Persist Security Info=False;"       

'Query the spreadsheet

rows.Open "Select * FROM [WC-Stages$]", _

    objConnection, adOpenStatic, adLockOptimistic, adCmdText

'Print off the row's data

DIM JUR

DIM WC

DIM WC_NAME

DIM PRIORITY

DIM REP

DIM DELIVER

DIM ACCEPT

DIM REJECT

DIM REDELIVER

DIM STATUS

DIM SDATE

DIM DATA_STATUS

DIM DATA_STATUS_2

DIM DATA_SDATE

DIM DATA_SDATE_2

Do Until rows.EOF

    JUR = rows.Fields("F3").Value

    WC = rows.Fields("F4").Value

    WC_NAME = rows.Fields("F5").Value

    PRIORITY = rows.Fields("F7").Value

    REP = rows.Fields("F23").Value

    DELIVER = rows.Fields("F22").Value

    ACCEPT = rows.Fields("F24").Value

    REJECT = rows.Fields("F25").Value

    REDELIVER = rows.Fields("F26").Value

    STATUS = ""

    SDATE = ""

    DATA_STATUS = ""

    DATA_SDATE = ""

    IF NOT ( JUR = "" OR JUR = "Jur" ) THEN 'Ignore invalid rows (first two and 

last three)

        If IsNull(DELIVER) THEN

            STATUS = "undelivered"

            SDATE = "1/1/2000"

        ELSE

            IF IsNull(ACCEPT) THEN

                IF IsNull(REJECT) THEN

                    STATUS = "delivered"

                    SDATE = DELIVER

                ELSE

                    IF IsNull(REDELIVER) THEN

                        STATUS = "rejected"

                        SDATE = REJECT

                    ELSE

                        STATUS = "redelivered"

                        SDATE = REDELIVER

                    END IF

                END IF

            ELSE

                STATUS = "accepted"

                SDATE = ACCEPT

            END IF

        END IF

        query = "SELECT * FROM [Sheet1$] WHERE JUR = '" & JUR & "' AND WC = " & WC

        rows2.Open query, _

            objConnection2, adOpenStatic, adLockOptimistic, adCmdText

        'For access database connection

        query = "SELECT * FROM [Sheet1] WHERE JUR = '" & JUR & "' AND WC = " & WC

        rows3.Open query, _

            objConnection3, adOpenStatic, adLockOptimistic, adCmdText

        ' DATA_STATUS = rows2.Fields("Status").Value

        ' DATA_SDATE = rows2.Fields("SDate").Value

        DATA_STATUS = rows3.Fields("Status").Value

        DATA_SDATE= rows3.Fields("SDate").Value

        if dateafter( SDATE, DATA_SDATE ) AND STATUS <> DATA_STATUS then

            'Need to update the data with the new value

            log("UPDATE: " & jur & ":" & wc & "has been changed to " & STATUS)

            query = "UPDATE [Sheet1] SET [STATUS] = '" & STATUS & "', [SDATE] = 

'" & SDATE & "' WHERE [JUR] = '" & JUR & "' AND [WC] = " & WC

            response.write(query)

            objConnection3.execute(query)

        END IF  

        rows2.close
    END IF
    rows.MoveNext
Loop

log("UPDATE COMPLETE")      
        %>

<!--#include file="footer.inc"--> 
```

谢谢尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:55:28.487

查看您的代码，我注意到在您的循环内您关闭了 Recordset rows2，但您忘记关闭 Recordset rows3。因此，在第一个循环之后的下一个循环中，当您尝试重新打开 rows3 记录集时会收到错误消息。
快速解决方法是：

```
 ....
    rows2.close 
    rows3.Close
END IF 
```

# magento-1.4 - 如何防止页面出现萤火虫？

> ID：11506055
> 
> 赞同：0
> 
> 时间：2012-07-16T14:05:42.050
> 
> 标签：magento-1.4

我也是新的magento。我在为可下载产品创建激活密钥时遇到了一个问题。我在我的产品页面中隐藏了我的文本字段。但是黑客，如果他们使用萤火虫，那么他们很容易改变文本值并将其存储在数据库中。任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:07:56.400

您永远不应该依赖隐藏字段来确保安全。如果此密钥是秘密的，则永远不要将其发送到用户浏览器，请将其保存在后端。

切勿在未先清理数据库的情况下将用户输入存储在数据库中。

始终将您的用户视为黑客。我建议你在这里阅读更多信息：http: [//owasp.com/index.php/Main_Page](http://owasp.com/index.php/Main_Page)

PS：如果我可以补充，Firebug 与该问题无关。有无数的工具可以做到这一点。例如。所有浏览器都允许您查看源代码，因此隐藏字段实际上对任何用户都是可见的。大多数现代工具都包含开发人员工具，例如。IE 中的 f12。

# silverlight - 访问控件的父级父级的数据上下文

> ID：11506057
> 
> 赞同：1
> 
> 时间：2012-07-16T14:05:54.637
> 
> 标签：silverlight, windows-phone-7, xaml

我有一个这样的xaml

```
<Grid>
<Grid.DataContext>
    <bin:ItemsCollViewModel/>
</Grid.DataContext>
<controls:Pivot ItemsSource="{Binding Items}">
    <controls:Pivot.HeaderTemplate>
        <DataTemplate>
            <Grid>
                <TextBlock Text="{Binding ItemName}" />                            
                <toolkit:ContextMenuService.ContextMenu>
                    <toolkit:ContextMenu >
                        <toolkit:ContextMenu.Items>                                        
                            <toolkit:MenuItem Header="Remove" />
                        </toolkit:ContextMenu.Items>
                    </toolkit:ContextMenu>
                </toolkit:ContextMenuService.ContextMenu>
            </Grid>
        </DataTemplate>
    </controls:Pivot.HeaderTemplate>
    <controls:Pivot.ItemTemplate>
        ....
    </controls:Pivot.ItemTemplate>
</controls:Pivot> 
```

我需要将上下文菜单项的命令属性绑定到我的视图模型（ ItemsCollViewModel ）中的 ICommand 属性（例如**TryRemove**）。此**TryRemove**属于**ItemsCollViewModel**。但其父项（Pivot）的 DataContext 是**Items**，它是**ItemsCollViewModel**中的一个属性。那么如何将此上下文菜单项的命令属性绑定到其父（枢轴）父（网格）的属性。

简而言之，我如何访问控件的父级父级的数据上下文。我得到了这个[如何将按钮的 DataContext 更改为父级父级 DataContext？](https://stackoverflow.com/questions/1471643/how-to-change-the-datacontext-of-a-button-to-the-parents-parent-datacontext) 但编译器找不到**AncestorType={x:Type Grid}**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:54:14.150

```
<ContextMenu>
                <MenuItem Command="{Binding DatContext.TryRemove,  RelativeSource={RelativeSource AncestorType={x:Type Grid},AncestorLevel=1}  }"/>
            </ContextMenu> 
```

也试试 AncestorLevel。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T19:53:02.673

本着迟到总比没有好的精神：

将 Name 属性添加到您的 Pivot 控件并执行以下操作： `{Binding DataContext.TryRemove, ElementName=MyPivot}`

# java - BigDecimal 上的 Hibernate 搜索和范围查询

> ID：11506059
> 
> 赞同：1
> 
> 时间：2012-07-16T14:06:11.207
> 
> 标签：java, hibernate, search, lucene, hibernate-search

我很难设计一个查询来搜索价格在 100 到 200 之间的 Item 类的所有实例。

这是我的项目类：

```
@Entity
public class Item {
    @Id @DocumentId
    Long id

    @Field(index = Index.UN_TOKENIZED, store = Store.YES)
    @NumericField
    @FieldBridge(impl = BigDecimalNumericFieldBridge.class)
    BigDecimal price = BigDecimal.ZERO
} 
```

BigDecimalNumericFieldBridge 是这里描述的类：[https ://hibernate.onjira.com/secure/attachment/15952/proposed_doc.txt](https://hibernate.onjira.com/secure/attachment/15952/proposed_doc.txt)

卢克向我展示了我有几份价格在 100 到 200 之间的文件。

这是我的查询：

```
FullTextSession fullTextSession = Search.getFullTextSession(session);
final QueryBuilder queryBuilder =     fullTextSession.getSearchFactory().buildQueryBuilder().forEntity(Item).get();

Query rootQuery = queryBuilder.bool()
    .must(queryBuilder.range().onField('price').above(100).createQuery())
    .must(queryBuilder.range().onField('price').below(200).createQuery())
    .createQuery();

FullTextQuery ftq = fullTextSession.createFullTextQuery(rootQuery, Item);
List<Item> instanceList = ftq.list(); 
```

但无论范围如何，列表始终是空的。知道我做错了什么吗？

顺便说一句，我正在使用 Hibernate Search 3.4.1 和 Hibernate 3.6.10。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T15:14:44.100

事实上，我进行查询的方式存在错误。Hibernate Search 是特定于类型的，并且我的值存储为 long，我也需要使用 long 进行查询。我必须将值乘以 100，因为这是桥中的乘数：

```
Query rootQuery = queryBuilder.bool()
    .must(queryBuilder.range().onField('price').above(10000L).createQuery())
    .must(queryBuilder.range().onField('price').below(20000L).createQuery())
    .createQuery(); 
```

有关单元测试的更详细答案，请参阅 Hibernate 论坛上的这篇文章：[https ://forum.hibernate.org/viewtopic.php?p=2457657#p2457657](https://forum.hibernate.org/viewtopic.php?p=2457657#p2457657)

# android - 用于 PhoneGap 的 ChildBrowser Android 插件 - 浏览器在页面完全加载之前不会关闭

> ID：11506064
> 
> 赞同：1
> 
> 时间：2012-07-16T14:06:44.237
> 
> 标签：android, cordova, childbrowser

我正在使用最新版本的 ChildBrowser 和 PhoneGap 1.8.1 (Android)。如果我启动浏览器窗口，然后在页面完全加载（在本例中为 espn.com）之前触摸“x”关闭窗口，则窗口不会关闭，而是无法关闭。奇怪的是，当我第一次触摸“x”时，您可以看到窗口的透明关闭/缩小，但主浏览器窗口仍然保持原位。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T08:03:45.547

尝试将您的呼叫包装`childBrowser.showWebPage()`在一个`.setTimeout()`. 这有时会解决这样的奇怪问题，尽管我从未见过 ChildBrowser 的这个问题。

```
window.setTimeout( function () {
    window.plugins.childBrowser.showWebPage( url );
}, 1 ); 
```

# asp.net - 制表符分隔的平面文件到 SQL

> ID：11506065
> 
> 赞同：1
> 
> 时间：2012-07-16T14:06:45.087
> 
> 标签：asp.net, sql-server, flat-file, csv

我有一个制表符分隔的平面文件，我需要从中提取数据并更新我的 MS-SQL 数据库中的表。

有没有人有任何关于我将如何去做的细节？也许是某个地方的网站或教程？

提前致谢。

***更新：***基本上亚马逊返回一个制表符分隔的平面文件，我需要从中提取数据，然后使用该数据更新我的数据库。我已经知道如何从 MS SQL 数据库中导出数据 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:09:03.063

如果您使用的是 MS SQL，则应该查看该`BCP`程序。

[http://msdn.microsoft.com/en-us/library/aa174646(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa174646(v=sql.80).aspx)

或`BULK INSERT`命令

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:11:27.290

以下是步骤：

1-右键单击您的数据库并选择任务/导出数据，

2-数据源：平面文件

3- 分隔符：制表符

接下来在向导中...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T11:07:57.143

我设法使用下面的代码找出需要什么。添加作为参考，以防有人需要类似的东西。

```
try
     {
        //start with the second row
        string[] rowRow = row.Split('\t');

        string sku = rowRow[0].Trim();
        string qty = rowRow[1].Trim();
        decimal price = Convert.ToDecimal(rowRow[2].Trim());
        string asin = rowRow[3].Trim();

        int pcType = dc.productCodeTypes.Where(c => c.length == asin.Length).FirstOrDefault().id;

        //Save to DB
        abcProduct aUpdate = dc.abcProducts.Single(p => p.sku == sku);
        if (aUpdate.asin == asin) { }
           else { aUpdate.asin = asin; }
        if (aUpdate.codeType == pcType) { }
           else { aUpdate.codeType = pcType; }
        if (aUpdate.amzPrice == price) { }
           else { aUpdate.amzPrice = price; }
        dc.SubmitChanges();
     } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-16T14:16:52.497

如果您使用 WAMP 服务器安装了 mysql，最简单的方法是：

1.  假设您的数据库在您自己的计算机上，请在浏览器上打开 PHPMyAdmin，如下所示：localhost/phpmyadmin

2.  打开你的 mysql 数据库。如果您还没有，请创建一个。即，只有数据库（没有表）

3.  激活数据库后，使用 phpmyadmin 上的 IMPORT 功能。找到屏幕顶部的按钮。

4.  指定要导入的文件并将分隔字符指示为 TAB。默认情况下它是一个逗号。

您现在可以直接在数据库中保存您的记录。

不过有一点......默认情况下，一些 phpmyadmin 设置对文件大小有限制。

# extjs - extjs 中面板的工具提示

> ID：11506067
> 
> 赞同：1
> 
> 时间：2012-07-16T14:06:57.567
> 
> 标签：extjs, extjs4.1

我正在将面板动态添加到容器中。我想在悬停时为此面板设置一个工具提示。怎么做？

```
var myPanel = Ext.create('myClass.extending panel');
myPanel.id = 'my-id';
myPanel.setTitle('myTitle');              
myPanel.collapsed = true;
this.add(myPanel); 
```

**更新：**我也尝试过，但没有工作

```
var panelToolTip = Ext.create('Ext.tip.ToolTip', {
        target: 'my-id',
        html: 'I am a tooltip on your panel.'
});
this.add(panelToolTip); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T07:01:10.253

我通过在面板扩展类上添加以下代码解决了这个问题。

```
 listeners: {
    render: function () {
        this.getEl().dom.title = 'my custom tool tip';
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:14:06.327

以下代码段将工具提示添加到指定的 id。

编辑：这是我的面板代码，用 Firefox 测试过。

```
 var myPanel = Ext.create('Ext.panel.Panel', {
     id : 'myPanel',
                    width: 200,
                    height: 150,
                    title: 'Panels are cool',
                    collapsible: true,
                    renderTo: Ext.getBody(),
                    .. .some other properties
});
 var tip = Ext.create('Ext.tip.ToolTip', {
                target: 'myPanel',
                html: 'I am a tooltip on myPanel'
            }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-23T06:16:16.900

当您想显示两个单独的工具提示时，您可以使用以下方式。

```
listeners: {
"collapse": function () {
    this.getEl().dom.title = 'collapse tooltip';
},
"expand": function () {
    this.getEl().dom.title = 'expand tooltip';
}
}, 
```

# java - 如何使用 apex 为 apex 调度程序创建自定义对象？（编译错误：比较参数必须是兼容类型）

> ID：11506075
> 
> 赞同：1
> 
> 时间：2012-07-16T14:07:31.173
> 
> 标签：java, salesforce, apex-code, scheduler, visualforce

我是 apex 的新手，正在尝试构建一个每天运行的 apex 时间表课程。如果佣金的帐户审核日期是两周（14 天）之后，调度员将向我们的销售部门发送一封电子邮件。

我几乎完成了该程序，但我不断收到此错误：

错误：编译错误：比较参数必须是兼容类型：Schema.SObjectField，第 9 行第 9 列的日期

这是我的代码：

```
global class AccountReviewScheduler implements Schedulable
{
    global void execute (SchedulableContext ctx) 
    {
        sendEmail();
    }
public void sendEmail()
{
    if (Account__r.Next_Account_Review_Date__c == System.today().addDays(14))
    {
        Messaging.SingleEmailMessage mail = new Messaging.SingleEmailMessage();
        Mail.setTemplateId('00XF0000000LfE1');
        Messaging.sendEmail(new Messaging.SingleEmailMessage[] {mail });
    }
}

} 
```

我做了一些研究，另一个讨论板上的评论者告诉我它不起作用，因为 Account__r.Next_Account_Review_Date__c 只是一个字段。

我必须将它与记录一起使用以使其具有价值。然后我可以将该值与 system.today() 进行比较。

我不确定这意味着什么......创建一个自定义对象？我不知道该怎么做。这是我遇到问题的修改后的代码。这是我修改后的代码：

这是修改后的代码（星号**表示更改）

```
global class AccountReviewScheduler implements Schedulable
{
    global void execute (SchedulableContext ctx) 
    {
        sendEmail();
    }
public void sendEmail()
{
    **CustomObj__c co = [select Account__r.Next_Account_Review_Date__c from CutomObj__c limit 1];**
    **if(co.Account__r.Next_Account_Review_Date__c == system.today().addDays(14))** 
    {
        Messaging.SingleEmailMessage mail = new Messaging.SingleEmailMessage();
        Mail.setTemplateId('00XF0000000LfE1');
        Messaging.sendEmail(new Messaging.SingleEmailMessage[] {mail });
    }
}

} 
```

更改以粗体显示...我知道自定义 obj 代码可能是错误的...我从其他人那里得到了它，但我不知道该怎么做。

注意：基于时间的工作流程在此处不起作用，因为此电子邮件必须每年（多年）在帐户审核日期前 14 天发送。基于时间的工作流将在设置为触发一年后运行一次，但不要重复。它们不会按设计重复出现。请参阅：[http ://success.salesforce.com/questionDetail?qId=a1X30000000JnPMEA0](http://success.salesforce.com/questionDetail?qId=a1X30000000JnPMEA0)

我已阅读调度文档： http: [//www.salesforce.com/us/developer/docs/apexcode/Content/apex_scheduler.htm](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_scheduler.htm)

并浏览了 Apex 工作簿教程：http://blogs.developerforce.com/developer-relations/2010/02/spring-10-saw-the-general-availability-of-one-of-my-favorite-new- features-of-the-platform-the-apex-schedulerwith-the-apex-s.html 以及官方 Apex 指南中的教程 14，但我仍然遇到问题。

对我的代码/新资源链接的任何帮助/见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:50:25.557

问题在于`Account__r.Next_Account_Review_Date__c`在这种情况下使用它只是一个字段令牌不引用任何数据。此标记与 Apex 中的模式/元数据方法一起使用，以获取有关字段本身的信息，例如它的类型、标签等。帮助的这一部分应该为您提供更多关于该主题的信息[http://www.salesforce .com/us/developer/docs/apexcode/index_Left.htm#CSHID=apex_methods_system_fields_describe.htm](http://www.salesforce.com/us/developer/docs/apexcode/index_Left.htm#CSHID=apex_methods_system_fields_describe.htm)

您遇到此问题的原因是您没有从数据库中选择任何数据进行处理。如果看起来更像这样，我猜你的发送电子邮件方法会起作用

```
public void sendemail(){
  for(Account acc : [SELECT Id FROM Account WHERE Next_Review_Date__c = :system.today().addDays(14)]){

    Messaging.SingleEmailMessage mail = new Messaging.SingleEmailMessage();
    mail.setTemplateId('00XF0000000LfE1');
    mail.setTargetObjectId(acc.Id);
    Messaging.sendEmail(new Messaging.SingleEmailMessage[] {mail });

  }

} 
```

这将选择下一个审核日期等于 14 天时间的所有帐户。然后它将遍历它们并发送电子邮件。我假设 Next_Review_Date__c 字段位于 Account 对象上，并且我还假设电子邮件模板需要到期的 Account 才能成功创建自己。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:45:53.223

我相信你在这里真正想做的是一个可批处理的接口和一个可调度的接口。

调度界面将让您执行批处理界面。您将需要使用批处理接口，以便您的代码将随着可能处于超过 14 天通知窗口状态的帐户数量而扩展。其基本代码如下所示：

```
global without sharing class AccountReviewScheduler implements 
Database.Batchable<sObject>
, Database.Stateful, Schedulable
{
//Batchable Methods
global Database.Querylocator start(Database.BatchableContext bcContext) {
    return Database.getQueryLocator([SELECT 
                                        Id
                                        , Next_Account_Review_Date__c 
                                    FROM 
                                        Account 
                                    WHERE 
                                        Next_Account_Review_Date__c = :System.today().addDays(14)]);
}

global void execute(Database.BatchableContext bcContext, List<sObject> listAccounts)
{
    for (sObject oSObject : listAccounts) {
        Account oAccount = (Account) oSObject;

        //Build a list of email messages here
    }

    //Send Email Here
}

global void finish(Database.BatchableContext bcContext) {}

//Schedulable Methods
global void execute(SchedulableContext sc) {
    Id batchJobId = Database.executeBatch(new AccountReviewScheduler());
}
} 
```

您的电子邮件逻辑将在批量执行方法中，该方法将批量处理帐户。每个批次在州长限制方面都有自己的上下文。您可以更改批量大小，但默认情况下它一次处理 200 条记录。

这是批处理界面上一些文档的链接，应该有助于填补一些空白。

[http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_batch_interface.htm](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_batch_interface.htm)

# javascript - 设置“with”语句引用的字段和对象

> ID：11506076
> 
> 赞同：0
> 
> 时间：2012-07-16T14:07:32.117
> 
> 标签：javascript, with-statement

在 JavaScript 中，我模拟这样的类：

```
function MyClass() {} // Constructor

MyClass.prototype.myField = "foo"; 
```

我想我会通过使用`with`关键字使代码更具可读性并节省击键：

```
function MyClass() {} // Constructor

with (MyClass.prototype)
{
    myField = "foo";

    myOtherField = "bar";

    myMethod = // etc
} 
```

但是，如果我随后创建一个实例并尝试访问这些字段中的任何一个，它们就是`undefined`. 但是，如果我这样做`with (MyClass.prototype)`然后尝试从中读取值，那会起作用 - 只有当我尝试更改它们或创建新字段时它才会失败。我假设这是因为`with (myObject)`将您的范围限定为 myObject 的克隆，而不是对原始实例的实际引用。

那么，有没有办法解决这个问题？有什么方法可以产生我想要的结果，有或没有`with`？还是我注定要`MyClass.prototype`一遍又一遍地写出来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:10:02.500

> *“如果我然后创建一个实例并尝试访问这些字段中的任何一个，它们就是`undefined`”*

您不能以这种方式创建新字段。

> *“如果我这样做`with (MyClass.prototype)`，然后尝试从中读取值，那就行了”*

这是因为您可以读取和更新现有字段。

> *“我假设这是因为`with (myObject)`将您的范围限定为 的克隆`myObject`，而不是对原始实例的实际引用。”*

不，这是对对象的实际引用。

* * *

这种混乱是人们避免的部分原因`with`。

* * *

> “*那么，有什么方法可以解决这个问题吗？有什么方法可以产生我想要的结果，无论是否使用？还是我注定要一遍又一遍地写出 MyClass.prototype ？”*

只需使用一个变量。

```
var p = MyClass.prototype;

p.myField = "foo";
p.myOtherField = "bar";
p.myMethod = "etc"; 
```

您还可以覆盖现有的原型对象，允许对象文字表示法...

```
function MyClass() {}

MyClass.prototype = {
    myField: "foo",
    myOtherField: "bar",
    myMethod: "etc"
}; 
```

`constructor: MyClass`如果需要，您也可以添加一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:13:43.957

看看[这篇文章](http://www.yuiblog.com/blog/2006/04/11/with-statement-considered-harmful/)，它解释了为什么你不应该使用 with 语句 - myField、myOtherField 和 myMethod 变量将在你的代码中创建为全局变量，因为它们不作为原型对象的属性存在。

# mongodb - Mongo 查询会话长度

> ID：11506077
> 
> 赞同：1
> 
> 时间：2012-07-16T14:07:35.623
> 
> 标签：mongodb, mapreduce

在 Mongo 中，我有一个包含两个字段 SessionId 和 Ticks 的文档；SessionId 是一个键，而 Ticks 是从某个时间点开始的长整数。

我想做的是按 SessionId 对它们进行分组，并获取该会话的最大 Ticks 和最小 Ticks 之间的差异。在 SQL 中，这很容易：

```
SELECT sessionId, MAX(ticks) - MIN(ticks) as session_length
FROM weblog
GROUP BY sessionId 
```

但是在 Mongo 中，这似乎是一个相当复杂的 MapReduce。你们会怎么做呢？MapReduce？JS for 循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:32:11.607

假设我了解您的数据模型，您可以使用 group 命令：

```
db.coll.group({
    key:{session:true}, 
    initial: {max: 0, min:100}, 
    reduce: function(obj, prev){
       if(obj.ticks > prev.max){
          prev.max=obj.ticks;
       }
       if(obj.ticks <prev.min){
          prev.min=obj.min;
       }
     },
     finalize: function(out){
       out.session_length=out.max - out.min;
     }
 }) 
```

示例输入：

```
{ "_id" : 1, "session" : 1, "ticks" : 10 }
{ "_id" : 2, "session" : 1, "ticks" : 4 }
{ "_id" : 3, "session" : 1, "ticks" : 12 }
{ "_id" : 4, "session" : 2, "ticks" : 6 }
{ "_id" : 5, "session" : 2, "ticks" : 8 }
{ "_id" : 6, "session" : 2, "ticks" : 3 } 
```

示例输出：

```
 [
    {
        "session" : 1,
        "max" : 12,
        "min" : 4,
        "session_length" : 8
    },
    {
        "session" : 2,
        "max" : 8,
        "min" : 3,
        "session_length" : 5
    }
] 
```

[http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Group](http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Group)

# boost-spirit - 语义操作未禁用属性兼容性

> ID：11506079
> 
> 赞同：1
> 
> 时间：2012-07-16T14:07:39.510
> 
> 标签：boost-spirit, boost-spirit-qi, boost-spirit-lex

我有一个看起来像这样的语法规则：

```
rule<Iterator, utree()> expr, factor;

expr =
    (
       +(
           (
              toks.symbol // toks.symbol attribute type is an std::string
              [
                 // I'm trying to force the attribute type to be utree
                 _val = construct<utree::list_type>()
                 // some code here
              ]
           |  (
                 factor >>
                +(
                    // the 3 tokens here have unsigned long attribute
                    toks.arrow >> factor
                 |  toks.squiggleArrow >> factor
                 |  toks.dot >> factor
                 )
              )
              [

                 // I'm trying to force the attribute type to be utree
                 _val = construct<utree::list_type>()
                 // some code here
              ]
           ) >> toks.assign // toks.assign is token_def<omit>
        ) >> factor
     ) [ _val = ternary(_1, _2) ]
   ; 
```

据我了解：

[http://boost-spirit.com/home/articles/attribute_handling/attribute-propagation-and-attribute-compatibility/](http://boost-spirit.com/home/articles/attribute_handling/attribute-propagation-and-attribute-compatibility/)

在这种情况下应该禁用属性兼容性，因为存在语义操作。尽管如此，我在 ternary() 中看到了一个编译错误，这表明 _1 的类型不是我所期望的向量，而是：

```
vector<
    variant<std::string,
            fusion::vector2<utree,
                            fusion::vector2<long unsigned int, utree>
                           >
           >
       > 
```

这意味着由于某种原因，语义动作没有起作用！

任何提示为什么会发生这种情况？

**注意：**我在此处粘贴了一个显示问题的最小化示例：

[http://pastebin.com/rgiy2QBW](http://pastebin.com/rgiy2QBW)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:54:50.363

编译器抱怨的赋值在`ternaryImpl::operator()`主体内部，这意味着，很明显，语义动作确实起作用了！

现在，尽管 SA 阻止自动属性传播是正确的（除非运算符 %= 用于规则分配），但这并不**意味着**原始解析器公开的类型会神奇地改变。

您在问题中列出的类型准确地反映了解析器表达式/运算符将返回的内容：

*   Or ( `|`) 解析成一个变体
*   Sequence ( `>>`) 解析为`fusion::vector2<...>`等。

现在，这是我进行编译的简单、最小的更改。确切地说，诀窍是通过*使用显式属性类型*拆分子规则来使属性分配*为*您工作。这允许 Spirit 为您进行属性转换。

 *```
struct Parser: public qi::grammar<Iterator, utree()>
{
    template <typename Tokens>
        Parser(const Tokens &toks):
            Parser::base_type(expression)
    {
        chain = +(
            (
               toks.symbol
               [
                  _val = construct<utree::list_type>()
                  // some code here
               ]
            |  (
                  factor >>
                 +(
                     toks.arrow >> factor
                  |  toks.dot >> factor
                  )
               )
               [
                  _val = construct<utree::list_type>()
                  // some code here
               ]
            ) >> toks.assign
         );
        expression = factor
            | (chain >> factor) [ _val = ternary(_1, _2) ]
            ;
    }

   rule<Iterator, utree::list_type()> chain;
   rule<Iterator, utree()> expression, factor, test;
}; 
```

> **注意**：*如果你想要你应该能够在没有额外规则定义的情况下做同样的事情（使用`qi::attr_cast<>`，`qi::as<>`例如），但我怀疑它是否可读/可维护。*

**PS。**类似的点可以从它，必然地，拼写比使用 SA 的版本[`calc_utree_naive.cpp`](http://www.boost.org/doc/libs/1_50_0/libs/spirit/example/qi/calc_utree_naive.cpp)更明确的规则属性类型。[`calc_utree_ast.cpp`](http://www.boost.org/doc/libs/1_50_0/libs/spirit/example/qi/calc_utree_ast.cpp)

这是完整的编译版本，注释中有一些内联注释：

```
// #define BOOST_SPIRIT_USE_PHOENIX_V3
// #define BOOST_RESULT_OF_USE_DECLTYPE
#include <algorithm>
#include <string>
#include <boost/spirit/include/lex_lexertl.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/support_utree.hpp>
#include <boost/spirit/include/phoenix_function.hpp>
#include <boost/spirit/include/phoenix_object.hpp>
#include <boost/spirit/include/phoenix_stl.hpp>

namespace lex    = boost::spirit::lex;
namespace qi     = boost::spirit::qi;
namespace spirit = boost::spirit;
namespace phx    = boost::phoenix;

using lex::token_def;
using qi::rule;
using qi::_1;
using qi::_2;
using qi::_val;
using spirit::utree;
using phx::construct;

// base iterator type
typedef std::string::iterator BaseIteratorT;

// token type
typedef lex::lexertl::token<BaseIteratorT, boost::mpl::vector</*double, int, */std::string> > TokenT;

// lexer type
typedef lex::lexertl::actor_lexer<TokenT> LexerT;

template <typename LexerT>
struct Tokens: public lex::lexer<LexerT>
{
   Tokens()
   {
      using lex::_pass;
      using lex::pass_flags;

      // literals
      symbol = "[a-zA-Z_?](\\w|\\?)*|@(\\w|\\?)+";
      arrow  = "->";
      dot    = '.';
      assign = "=";

      // literal rules
      this->self += symbol;
      this->self += arrow;
      this->self += dot;
      this->self += assign;
   }

   ~Tokens() {}

   // literal tokens
   token_def<std::string> symbol;
   token_def<> arrow, dot; // HINT: lex::omit here? 
   /*
    * ^ Otherwise, expect these to be all exposed as Qi attributes as well, so
    * _1, _2, _3, _4 a bit more than you'd expect
    */
   token_def<lex::omit> assign;
};

struct ternaryImpl
{
   template <typename Expr1Type, typename Expr2Type>
   struct result { typedef utree type; };

   template <typename Expr1Type, typename Expr2Type>
   utree operator()(Expr1Type &vec, Expr2Type &operand) const {
      utree ret;

      for (typename Expr1Type::iterator it = vec.begin(); it != vec.end(); ++it) {
         // some code
         ret = *it;
         // more code
      }

      // some code here

      return ret;
   }
};

phx::function<ternaryImpl> ternary = ternaryImpl();

template <typename Iterator>
struct Parser: public qi::grammar<Iterator, utree()>
{
    template <typename Tokens>
        Parser(const Tokens &toks):
            Parser::base_type(expression)
    {
        chain = +(
            (
               toks.symbol
               [
                  _val = construct<utree::list_type>()
                  // some code here
               ]
            |  (
                  factor >>
                 +(
                     toks.arrow >> factor
                  |  toks.dot >> factor
                  )
               )
               [
                  _val = construct<utree::list_type>()
                  // some code here
               ]
            ) >> toks.assign
         );
        expression = factor
            | (chain >> factor) [ _val = ternary(_1, _2) ]
            ;
    }

   rule<Iterator, utree::list_type()> chain;
   rule<Iterator, utree()> expression, factor, test;
};

int main()
{
   typedef Tokens<LexerT>::iterator_type IteratorT;

   Tokens<LexerT> l;
   Parser<IteratorT> p(l);
} 
```*

# jquery - 客户端验证问题 - MVC 4 RC

> ID：11506080
> 
> 赞同：1
> 
> 时间：2012-07-16T14:07:40.197
> 
> 标签：jquery, asp.net-mvc, jquery-validate, asp.net-mvc-4

有人可以帮我解决客户端验证问题（MVC4 RC，VS2010）吗？Intellisense 未在 jQuery.validator 中显示 addMethod。当我运行应用程序时，它会在此方法中引发 javascript null 错误。我想允许用户输入大于当前时间的时间。我的 CustomValidation.js 文件如下所示：

```
/// <reference path="jquery-1.7.2-vsdoc.js" />
/// <reference path="jquery.validate-vsdoc.js" />
/// <reference path="jquery.validate.unobtrusive.js" />

jQuery.validator.addMethod('dategreaterthan', function (value, element, param) {   
      var today = new Date();
      return Date.parse(value) > today; 
});

$.validator.unobtrusive.adapters.add("dategreaterthan", function (options) {
    options.rules["dategreaterthan"] = true;
    options.messages["dategreaterthan"] = options.message;
}); 
```

这是自定义验证属性代码：

```
public class DateGreaterThanAttribute : ValidationAttribute, IClientValidatable
    {
        private const string DefaultErrorMessage = "{0} Time must be greater than current time";

        public DateGreaterThanAttribute() :
            base(DefaultErrorMessage) 
        { }

        protected override ValidationResult IsValid(object value, ValidationContext validationContext)
        {
            ValidationResult validationResult = ValidationResult.Success;

            if (((DateTime)value).TimeOfDay >= DateTime.Now.TimeOfDay)
                return validationResult;
            else
            {
                return new ValidationResult(FormatErrorMessage(this.ErrorMessage));                
            }
        }

        public override string FormatErrorMessage(string name)
        {
            return base.FormatErrorMessage(name);
        }

        #region IClientValidatable Members

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
        {
             var rule = new ModelClientValidationRule();
             rule.ErrorMessage = FormatErrorMessage(metadata.GetDisplayName());
             rule.ValidationType = "dategreaterthan";
             yield return rule;                
        }

        #endregion
    } 
```

我已将 CustomValidation.js 添加到 BundleConfig.cs 文件中，如下所示： public class BundleConfig（不确定是否正确）：

```
 public static void RegisterBundles(BundleCollection bundles)
    {
        bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-1.*"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                    "~/Scripts/jquery-ui*"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                    "~/Scripts/jquery.unobtrusive*",
                    "~/Scripts/jquery.validate*"));

        bundles.Add(new ScriptBundle("~/bundles/modernizr").Include(
                    "~/Scripts/modernizr-*"));

        bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));

        bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
                    "~/Content/themes/base/jquery.ui.core.css",
                    "~/Content/themes/base/jquery.ui.resizable.css",
                    "~/Content/themes/base/jquery.ui.selectable.css",
                    "~/Content/themes/base/jquery.ui.accordion.css",
                    "~/Content/themes/base/jquery.ui.autocomplete.css",
                    "~/Content/themes/base/jquery.ui.button.css",
                    "~/Content/themes/base/jquery.ui.dialog.css",
                    "~/Content/themes/base/jquery.ui.slider.css",
                    "~/Content/themes/base/jquery.ui.tabs.css",
                    "~/Content/themes/base/jquery.ui.datepicker.css",
                    "~/Content/themes/base/jquery.ui.progressbar.css",
                    "~/Content/themes/base/jquery.ui.theme.css"));
        bundles.Add(new ScriptBundle("~/bundles/customvalidation").Include(
                    "~/Scripts/CustomValidation.js"));     
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:58:29.123

确保在您的自定义捆绑包（与 关联）之前包含`jqueryval`捆绑包（包含`~/Scripts/jquery.unobtrusive*`和脚本）。所以按照这个顺序：`~/Scripts/jquery.validate*``jqueryui`

```
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jqueryval")
@Scripts.Render("~/bundles/jqueryui") 
```

# android - 如何以编程方式在 AsyncTask.onPreExecute 中添加 ProgressBar？

> ID：11506083
> 
> 赞同：1
> 
> 时间：2012-07-16T14:08:06.067
> 
> 标签：android, android-progressbar

异步任务中的代码：

```
 @Override
    protected void onPreExecute() {
        super.onPreExecute();
        ScrollView sv = (ScrollView)findViewById(mScrollViewID);
        sv.removeAllViews();
        pb = new ProgressBar(mContext, null, android.R.attr.progressBarStyleSmall);
        pb.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
        pb.setIndeterminate(true);
        pb.setVisibility(View.VISIBLE);

        TextView tv = new TextView(mContext);
        tv.setText("Some text here.");
        sv.addView(pb);
    } 
```

请注意`TextView`最后的 - 如果我将其添加到其中`ScrollView`，它会显示得很好。但是，我似乎根本无法`ProgressBar`显示任何内容。这是我第一次使用控件 - 我错过了什么愚蠢的东西吗？

编辑：如果重要，`ScrollView`使用中的 XML 定义为：

```
<ScrollView android:id="@+id/scrollview0" android:layout_width = "match_parent" android:layout_height="match_parent"
            android:fillViewport="true" android:padding="5dp"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:09:15.950

当您动态创建 ProgressBar 时，会经常出现此问题

我建议通过 xml 创建一个 ProgressBar

并设置默认**可见性 GONE**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:28:14.180

如果你`tv`在`pb`它之后添加 deffinatyl 显示错误？

这是因为`ScrollView`只有一个孩子。所以你需要在你的中添加一个然后`LinearLayout`在你的中`ScrollView`添加其他东西`Linear layout`

# python - Python：使用百分比后清理 Windows 磁盘的脚本

> ID：11506090
> 
> 赞同：1
> 
> 时间：2012-07-16T14:08:24.803
> 
> 标签：python, windows, disk

我创建了一个 python 脚本来清理 Windows 磁盘上的旧文件。现在我想改进该脚本并检查我是否超过了预定义的磁盘使用情况，然后删除文件......我该怎么做？这是我的代码：

```
import os, time

path = r"f:\backup"
now = time.time()
for f in os.listdir(path):
    if os.stat(f).st_mtime < now - 180 * 86400:
        if os.path.isfile(f):
            os.remove(os.path.join(path, f)) 
```

我需要它，因为我已经在外部磁盘上配置了我的计算机的备份，有时由于磁盘已满而无法进行备份。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:48:10.027

我建议查看这个答案：

[使用python的卷上剩余的跨平台空间](https://stackoverflow.com/questions/51658/cross-platform-space-remaining-on-volume-using-python)

os 模块的 nt 实现不包括 statvfs 属性，因此您需要使用 c_types 重新创建该功能。

# jquery - jQuery表单在提交时序列化空POST数据

> ID：11506093
> 
> 赞同：0
> 
> 时间：2012-07-16T14:08:28.433
> 
> 标签：jquery, serialization, post

我在一个 PHP 循环中填充了多个表单，并用`<form id='X'>` 它们来区分它们在 HTML 中看起来像这样：

```
<form id='34' class='customer_contact' name='customercontact' method='post' action='customerUpdate.php'>
    Förnamn: <br /><input type='text' name='contact_firstname' class='textbox' value='text....'>
    Efternamn: <br /><input type='text' name='contact_lastname' class='textbox' value='text....'>
    Telefonnummer: <br /><input type='text' name='contact_phone' class='textbox' value='text....'>
    Mobiltelefon: <br /><input type='text' name='contact_cellphone' class='textbox' value='text....'>
    E-mail: <br /><input type='text' name='contact_email' class='textbox' value='text....'>
    <select name='isActive'>
        <option value="0" selected>Inaktiv</option>
        <option value="1">Aktiv</option>
    </select>
</form> 
```

我尝试使用以下代码对它们进行序列化：

```
<script type="text/javascript">
$(document).ready(function() {
$('#customer_contact_save').live('click', function(e){
    e.preventDefault();
    $.each($('form.customer_contact'), function(index) { 
        var sData = $(this).serialize();
        $.ajax({
            type: "POST",
            url: "updateCustomer.php",
            data: sData,
            success: function(someMessageFromPhp) {
                alert(someMessageFromPhp); 
            }
        });
    });
  });
}); 
```

*（感谢 Zagor23 在 SO 上的代码）*

**但是我的`POST`数据是空的**（我正在使用 FireBug 来查看正在发送的内容）。

我尝试添加`console.log(sData);`脚本，但 FireBug 返回：`(an empty string)`并且 php`var_dump($_POST);`也是空的..

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T08:27:12.460

事实证明，在我的实际代码中，我忘记添加`name`到我的输入字段（facepalm）。

不管怎么说，还是要谢谢你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:21:23.403

像这样的东西呢？

```
$(".customer_contact").each(function()
{ 
    var form_id = $(this).attr("id");
    var sData = $("#" + form_id).serialize();
    $.ajax({
        type: "POST",
        url: "updateCustomer.php",
        data: sData,
        success: function(someMessageFromPhp) {
            alert(someMessageFromPhp); 
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T06:17:15.047

这是我用你的代码制作的小提琴 - [http://jsfiddle.net/7Y9vn/](http://jsfiddle.net/7Y9vn/) 如果你打开 firebug 并按下按钮，你会看到两个请求都运行正常，所以你可能应该搜索其他错误页面代码

# c# - C# SaveFileDialog 从多个扩展名中设置一个在未键入扩展名时自动添加扩展名

> ID：11506100
> 
> 赞同：4
> 
> 时间：2012-07-16T14:08:49.803
> 
> 标签：c#, .net, winforms, savefiledialog

我`SaveFileDialog`用来保存图像。

控件的过滤器是：`PNG|*png;|GIF|*gif;|BMP|*bmp;|JPEG|*jpg;*jpeg;`

但是，如果扩展名没有输入文件名，它不会自动添加扩展名。

我知道我可以设置 a `DefaultExt`，但是，在从多个扩展名中进行选择时，我不知道如何处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:24:32.337

您遇到的问题是您使用的过滤器根据规则不正确[`FileDialog.Filter`](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.filter.aspx)（您已经遗漏了`.`模式中的字符）。在`SaveFileDialog`自动添加扩展之前，它首先验证选定的过滤器。在您的情况下，此验证失败；这就是为什么自动添加没有按预期工作的原因。

尝试以下过滤器：

```
PNG|*.png|GIF|*.gif|BMP|*.bmp|JPEG|*.jpg;*.jpeg 
```

尽管我相信这是默认设置，但明确`dialog.AddExtension = true;`不会在这里受到伤害。

# php - 在 cron-job 和 webserver 执行的 PHP 脚本之间共享数据

> ID：11506101
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:08:52.707
> 
> 标签：php, cron, data-sharing

以下是*主*脚本和*子*脚本进行数据共享的常用方式：

> cron 作业 -- 计划 --> 主脚本
> 
> HTTP 请求 -- 触发器 --> 子脚本
> 
> 主脚本 --> [数据库] <-- 子脚本

但是他们是否可以使用以下任何一种方式而不是数据库来共享数据？

*   `global`多变的
*   系统存储
*   会话存储
*   memcache / apc / 任何其他类似的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:40:54.813

我第二个文件解决方案：

*   编码/理解/维护很简单
*   它是万无一失的，出现问题时您不会丢失内容。
*   它可以防止并发写入
*   如果您的操作系统决定需要对其进行缓存以进行频繁访问，则它与内存一样快。（通常不尝试替换操作系统优化更简单/更安全/更快。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:12:17.823

1.  不可能
2.  系统存储是什么意思？
3.  不可能
4.  memcach：如果两个应用程序都知道值的关键，那将没问题，apc：不可能

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:14:16.960

剩下的唯一方法是fs。DaveRandom 建议的套接字或简单文件。

为什么不想使用数据库？你具体想做什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T14:15:32.770

当然，您可以从 cron-job ( `php-cli`) 执行的脚本连接到 MySQL 服务器，就像您可以从 web 服务器一样，假设`php.ini`for 命令行已加载数据库库。

如果您不想使用数据库，您可以设置套接字或使用临时直通文件。但是使用数据库将是最有效和最整洁的方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T14:22:20.293

1.  全局变量 -**否**
2.  系统存储*（来自评论：这是命令行）* -**不**，因为这将涉及一个启动另一个，并且仍然是单向的......
3.  session storage -**是**的，使用*命名 session*，但这将默认使用*文件*（可以配置为使用**shm**然后在内存中......）
4.  [`memcached`](http://php.net/memcahched)-**是的**
5.  [`apc`](http://php.net/apc)-**是**的，但需要显式配置才能在*cli* sapi中启用
6.  文件 -**是**的。为了加快速度，您可以使用`ramfs`将文件存储在内存文件系统中。
7.  套接字 -**是**的（创建一个监听器并从另一个连接）
8.  数据库 -**是**的（实际上，为什么不呢？）

如果我遗漏了任何内容，您可以搜索*php interprocess communication*

# wcf - WCF InvalidOperationException：绑定实例已关联到侦听 URI

> ID：11506107
> 
> 赞同：9
> 
> 时间：2012-07-16T14:09:19.350
> 
> 标签：wcf

我是 WCF 的初学者，我正在学习 Essential WCF。

我在使用 ServiceContract NameSpace 和 Name 时遇到了问题。当我运行代码时，我捕捉到了下面的 InvalidOperationException。但我无法理解清楚。

*绑定实例已关联到侦听 URI 'http://localhost:8080/NamespaceChange01'。如果两个端点想要共享同一个 ListenUri，它们也必须共享同一个绑定对象实例。两个冲突的端点要么在 AddServiceEndpoint() 调用中指定，要么在配置文件中指定，要么在 AddServiceEndpoint() 和 config 的组合中指定。*

有谁知道如何避免 InvalidOperationException ？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;

namespace NamespaceChange01
{

    [ServiceContract(Name = "MyServiceName", Namespace = "http://ServiceNamespace")]
    public interface IBurgerMaster
    {
        [return: MessageParameter(Name = "myOutput")]
        [OperationContract(Name = "OperationName", Action = "OperationAction", ReplyAction = "ReplyActionName")]
        double GetStockPrice(string ticker);
    }

    [ServiceBehavior(Namespace = "http://MyService")]
    public class BurgerMaster : IBurgerMaster
    {

        public double GetStockPrice(string ticker)
        {
            return 100.99;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            ServiceHost host = new ServiceHost(typeof(BurgerMaster));
            host.Open();
            Console.ReadLine();
            host.Close();
        }
    }
} 
```

*   应用程序配置

    ```
    <?xml version="1.0" encoding="utf-8" ?>
    <configuration>
      <system.serviceModel>
        <services>
          <service name="NamespaceChange01.BurgerMaster" behaviorConfiguration="mexServiceBehavior">
            <host>
              <baseAddresses>
                <add baseAddress="http://localhost:8080/NamespaceChange01"/>
              </baseAddresses>
            </host>
            <endpoint name="basic" binding="basicHttpBinding" contract="NamespaceChange01.IBurgerMaster"/>
            <endpoint name="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
          </service>
        </services>
        <behaviors>
          <serviceBehaviors>
            <behavior name="mexServiceBehavior">
              <serviceMetadata httpGetEnabled="true"/>
            </behavior>
          </serviceBehaviors>
        </behaviors>
      </system.serviceModel>
    </configuration> 
    ```

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-16T15:16:51.280

两个端点（basic 和 mex）不能在同一个地址上。为其中一个（或两个）添加一些特定地址。

例如：

```
<endpoint name="mex" address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T15:16:08.217

您缺少元数据端点中的**地址**属性：

```
<endpoint name="mex" binding="mexHttpBinding" contract="IMetadataExchange" address="mex" /> 
```

没有它，WCF 认为您希望将 mex 端点托管在同一地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-24T11:48:57.220

我知道这是一个老问题，但我最近遇到了一个非常相似的问题，谷歌把我带到了这里，而且我有一个不同的潜在解决方案：

由于相关服务的标记完全缺失`service`，并且在 IIS 中为其设置了 HTTP 和 HTTPS 绑定，我遇到了所描述的完全相同的错误消息。

自然，添加`service`标签解决了这个问题。有趣的是，删除 IIS 中的 HTTPS 绑定使 HTTP 版本可用（尽管这显然是不可取的）。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-16T14:48:43.900

在创建您的服务类时，您为什么像代码中所说的那样使用 ServiceContract 属性对其进行标记？

```
[ServiceBehavior(Namespace = "http://MyService")]
public class BurgerMaster : IBurgerMaster 
```

请删除那个并重试。

# git - 为什么将 git 存储库复制到另一个目录后我修改了文件？

> ID：11506113
> 
> 赞同：16
> 
> 时间：2012-07-16T14:09:31.567
> 
> 标签：git, copy, repository, commit, copy-paste

我的笔记本电脑上有我的个人小型 git 存储库。我刚刚提交了更改并检查了我没有什么要提交的 - 每个暂存和修改的文件都已提交。

之后，我已经将所有文件从这个 repo 复制到另一个位置，然后繁荣！我有未提交的更改。

我相信我缺少一些基本的 git 规则。任何人都可以建议我吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-24T07:58:39.177

我做了什么，跑

```
git diff | grep -B 2 @@ | grep +++ 
```

获取实际更改的文件，然后还原所有其他文件

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-16T14:25:29.887

您在 windows 上的文件可能有回车换行换行符结尾，并且您的 windows 框上可能有 core.autocrlf true。不要在不同平台之间复制它。而是在 linux 机器上创建一个新的 git 存储库并从 Windows 机器中提取。您可以使用`git bundle`或`git daemon`在 Windows 机器上公开存储库。或者，您可以在 linux 机器上创建一个裸仓库，`git push --mirror`然后从 Windows 机器复制到它，然后将其克隆到您希望最终版本结束的地方。

或者 - 很可能您已经可以`git reset --hard HEAD`按原样在 linux 机器上执行并修复它。可能您应该首先删除除 .git 文件夹之外的所有内容，以确保工作树完全干净。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-23T13:21:29.363

如果您没有任何东西可以丢失，请执行以下操作：

`git checkout .`

这会将工作树恢复到您之前的提交

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T14:11:50.130

文件夹之间的权限是否改变？Git 将注册权限的更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T15:32:30.183

从 Windows 复制到 Linux 引入了文件权限的差异，这些更改也被 git 跟踪。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-25T10:31:58.850

我面临同样的问题。但是，我已将文件从主机 linux 系统复制到 Virtual Box 来宾系统。一些链接被删除，而一些文件权限被更改，我可以通过执行 git config core.filemode false 来修复。

# android - ListView 项目：将背景颜色更改为最后选择（或单击）的项目

> ID：11506116
> 
> 赞同：1
> 
> 时间：2012-07-16T14:09:40.773
> 
> 标签：android, android-listview, selector

我正在开发一个带有 ListActivity 的 Android 2.3.3 应用程序。

我想做一些事情来向用户展示他/她选择的项目。我已经完成了以下操作，但它没有（我在 stackoverflow 中搜索，它们是相互矛盾的答案）。

**这是 layout_item.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/txtName"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/selector"
        android:text="" />

</LinearLayout> 
```

**这是 res/drawable 上的 selector.xml 文件**

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_selected="true"
        android:color="#00FF00" />
    <item android:state_pressed="true"
        android:color="#555555" />
    <item android:color="#000000" />
</selector> 
```

但它不起作用，因为它说我必须`@drawable`放入`selector.xml`.

如何将背景颜色设置为蓝色以最后单击列表项？

**更新**

**与此列表一起使用的阵列适配器：**

```
public class GatesAdapter extends ArrayAdapter<Gate>
{
    /**
     * Application context.
     */
    private Context context;
    /**
     * 
     */
    private int itemLayoutId;
    /**
     * 
     */
    private ArrayList<Gate> gates;
    private int selectedGateIndex;

    public int getSelectedGateIndex() {
        return selectedGateIndex;
    }

    public void setSelectedGateIndex(int selectedGateIndex) {
        this.selectedGateIndex = selectedGateIndex;
    }

    public Gate getSelectedGate()
    {
        return gates.get(selectedGateIndex);
    }

    public void removeSelectedGate()
    {
        this.gates.remove(selectedGateIndex);
    }

    public ArrayList<Gate> getGates()
    {
        return this.gates;
    }

    public GatesAdapter(Context context, int listItemResourceId,
            ArrayList<Gate> objects)
    {
        super(context, listItemResourceId, objects);

        this.context = context;
        this.itemLayoutId = listItemResourceId;
        this.gates = objects;
        this.selectedGateIndex = -1;

        this.setNotifyOnChange(true);
    }

    @Override
    public int getCount()
    {
        return gates.size();
    }

    @Override
    public View getView(final int position, View convertView, ViewGroup parent)
    {
        Log.v("GatesAdapter", "getView.postion: " + position);
        View row = convertView;
        if (row == null)
        {
            LayoutInflater inflater = ((Activity)context).getLayoutInflater();
            row = inflater.inflate(itemLayoutId, parent, false);
        }

        Gate gate = gates.get(position);
        if (gate != null)
        {
            TextView itemText = (TextView)row.findViewById(android.R.id.text1);
            if (itemText != null)
            {
                itemText.setText(gate.getName());
                //selectedGateIndex = position;
                if (selectedGateIndex == position)
                {
                    row.setBackgroundColor(Color.BLUE);
                }
            }
        }

        return row;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:15:08.490

我已经使用自定义数组适配器完成了它，只是在`getView()`方法中检查了：

```
if (position == lastClicked) {
    v.setBackgroundColor(0x...)
} else {
    v.setBackgroundColor(0x...)
} 
```

由于大型列表视图的特定行为，else 块很重要

更新：这是我的自定义数组适配器，它工作正常：

```
public class AbcArrayAdapter extends ArrayAdapter<UniversalListItem> {

private Context c;
private int id;
private List<UniversalListItem>items;

public AbcArrayAdapter(Context context, int viewResourceId, List<UniversalListItem> objects){
    super(context,viewResourceId,objects);
    c=context;
    id=viewResourceId;
    items=objects;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater)c.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(id, null);
    }

    final UniversalListItem o = items.get(position);
    if (o != null) {
        if ( o.isInList() ) {
            v.setBackgroundColor(0x00ffffff);
        } else {
            v.setBackgroundColor(0x4d0099cc);
        }
        /*....*/
    }
    return v;
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:16:15.623

是的，选择器中的项目只接受可绘制对象。但是，您可以使用颜色创建可绘制对象：在您的 colors.xml 中添加颜色：

```
<drawable name="color1">#00FF00</drawable>
<drawable name="color2">#00FF00</drawable>
<drawable name="color3">#000000</drawable> 
```

然后，将它们用作可绘制对象：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_selected="true"
        android:drawable="@drawable/color1" />
    <item android:state_pressed="true"
        android:drawable="@drawable/color2" />
    <item android:drawable="@drawable/color3" />
</selector> 
```

希望这会帮助你=）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-18T21:54:13.343

我更喜欢这个更简单的解决方案：

```
 lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long arg3) {
            statusText.setText("Redes:" + lv.getCount()+"\n Posición / First:" +position + "/" + lv.getFirstVisiblePosition());

            NetsArrayAdapter aA = (NetsArrayAdapter) parent.getAdapter();

            for(int a = 0; a < parent.getChildCount(); a++) {
                parent.getChildAt(a).setBackgroundColor(Color.TRANSPARENT);
            }

            view.setBackgroundColor(Color.BLUE);
            aA.setLastSelected(position);
        }
    });

private class NetsArrayAdapter extends ArrayAdapter<String> {
    private ArrayList<String> mData;
    private int id;
    private Context c;

    private int lastSelected = -1;

    // declaring our ArrayList of items
    private ArrayList<String> objects;

    /* here we must override the constructor for ArrayAdapter
    * the only variable we care about now is ArrayList<Item> objects,
    * because it is the list of objects we want to display.
    */
    public NetsArrayAdapter(Context context, int textViewResourceId, ArrayList<String> objects) {
        super(context, textViewResourceId, objects);
        c = context;
        id = textViewResourceId;
        mData = objects;
    }

    @Override
    public View getView(final int position, View view, ViewGroup parent) {
        View currView = super.getView(position, view, parent);

        System.out.println("Paint / selected:"+position+" / "+lastSelected);

        if(lastSelected != position)
            currView.setBackgroundColor(Color.BLACK);
        else
            currView.setBackgroundColor(Color.BLUE);

        return currView;
    }

    public int getLastSelected() {
        return lastSelected;
    }

    public void setLastSelected(int lastSelected) {
        this.lastSelected = lastSelected;
    }

} 
```

# ios - 通过 http 在 iOS 设备上流式传输和下载大型视频

> ID：11506117
> 
> 赞同：0
> 
> 时间：2012-07-16T14:09:41.707
> 
> 标签：ios, http, video, stream, download

是否可以访问存储在 http 服务器上的大型视频文件（最大 300 MB）？用户应该能够在设备（iPhone 和 iPad）上下载视频文件 (mp4) 并随时访问它，或者只需流式传输视频而不在设备上保存任何数据。

处理这些问题的好方法是什么？有什么好的教程吗？

在此先感谢，包茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:23:31.607

```
NSString *urlStr = [NSURL URLWithString:@"http://www.linktoyourmovie.mp4"];
NSURL *url = [NSURL URLWithString:urlStr];
MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:url];
moviePlayer.view.frame = CGRectMake(0, 0, 300, 400);  
[self.view addSubview:moviePlayer.view];
[moviePlayer play];
[moviePlayer release]; 
```

这就是如何流式传输视频而不将其保存在设备上。希望其他人可以帮助解决这个问题。

# css - iphoney App不显示继承？或者是

> ID：11506119
> 
> 赞同：0
> 
> 时间：2012-07-16T14:09:48.577
> 
> 标签：css, inheritance, ios-simulator

iphoney 模拟器应用程序是否尊重 css 继承？有谁知道是否有办法清除它的缓存？

例子

```
 <link rel="stylesheet" type="text/css" media="screen" href="$ThemeDir/css/style.css"/>

    <!--[if !IE]>-->
    <link type="text/css" rel="stylesheet" media="only screen and (max-device-width: 480px)" href="$ThemeDir/css/iphone.css" />
    <!--<![endif]--> 
```

即使我忽略了所有图像并隐藏 iphone.css 中的标题

```
#header, img{dispay:none;
visibility:hidden;
} 
```

他们仍然出现在iphoney上！！

有趣的是他们没有出现在说黑莓手机上，这让我认为它是缓存或 iphoney 问题 [http://marketcircle.com/iphoney/](http://marketcircle.com/iphoney/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:16:24.847

您在上面的 css 代码中有错字。它应该是“显示”，而不是“显示”。

# objective-c - 如何去检测dismissModalViewControllerAnimated

> ID：11506123
> 
> 赞同：1
> 
> 时间：2012-07-16T14:09:58.990
> 
> 标签：objective-c, ios

有没有办法实现自己的机制来检测dismissModalViewControllerAnimated 何时消失？我试过 viewdiddisappear，但这并没有被调用，因为我认为它只在从视图中删除子视图时调用。对于模态，我认为 iOS 对待它们的方式不同。

有任何想法吗？

我希望我的代表在此模式视图被解除后执行一些操作。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:13:20.460

在关闭视图控制器之前，使用 NSNotificationCenter 发布通知。将您的其他视图控制器添加为观察者。这是广播事件的简单方法。

所以在你解雇之前：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"DismissModalViewController" 
                                                    object:nil];

[self dismissModalViewControllerAnimated:YES]; 
```

然后在您的视图控制器中

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(yourCallback)
                                             name:@"DismissModalViewController" 
                                           object:nil]; 
```

回调将类似于：

```
- (void) yourCallback
{
    // some code to run when modal view controller is dismissed
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:13:16.763

添加之前调用的委托方法`dismissModalViewController`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:14:45.463

您可以使用父视图控制器的`viewWillAppear`. `presentViewController`通过父视图控制器，我的意思是（或`presentModalViewController`）的接收者

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T14:15:16.757

我发现了这个问题。

进行此调用的视图控制器，我忘记设置委托人是谁。

# git - 如何为 git pull 输入带有密码的命令？

> ID：11506124
> 
> 赞同：179
> 
> 时间：2012-07-16T14:10:00.200
> 
> 标签：git, bash, command

我想在一行中执行此命令：

```
git pull && [my passphrase] 
```

怎么做？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-07-16T14:15:54.980

这不完全是您所要求的，但对于 http(s)：

*   您可以将密码放入 .netrc 文件（Windows 上的 _netrc）。从那里它将被自动拾取。它将以 600 权限进入您的主文件夹。
*   您也可以只克隆 repo ，`https://user:pass@domain/repo`但这并不是真正推荐的，因为它会在很多地方显示您的用户/通行证......
*   一个新选项是使用[凭证助手](http://www.kernel.org/pub/software/scm/git/docs/git-credential-cache.html)。请注意，凭据将使用标准凭据帮助程序以明文形式存储在本地配置中。带有 wincred 的 credential-helper 也可以在 Windows 上使用。

凭证助手的使用示例

*   `git config credential.helper store`- 无限期地存储凭据。
*   `git config credential.helper 'cache --timeout=3600'`- 存储 60 分钟

对于基于 ssh 的访问，您将使用 ssh 代理，该代理将在需要时提供 ssh 密钥。这将需要在您的计算机上生成密钥，将公钥存储在远程服务器上并将私钥添加到相关的密钥库中。

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2015-08-05T14:54:33.653

我找到了一种在命令行上为 https 连接提供凭据的方法。您只需要指定 git pull 的完整 URL 并在其中包含凭据：

```
git pull https://username:password@mygithost.com/my/repository 
```

您之前不需要使用凭据克隆存储库，这意味着您的凭据不会以`.git/config`. （但请确保您的 shell 不会背叛您并将命令行存储在历史文件中。）

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2016-04-29T23:39:39.377

没有直接回答这个问题，但是我在寻找一种方法时发现了这个问题，基本上，**每次我拉远程服务器时都不会重新输入密码**。

好吧，`git`允许您在有限的时间内缓存您的凭据。它是可定制的`git config`，这个页面很好地解释了它：

[https://help.github.com/articles/caching-your-github-password-in-git/#platform-linux](https://help.github.com/articles/caching-your-github-password-in-git/#platform-linux)

在终端中，运行：

```
$ git config --global credential.helper cache
# Set git to use the credential memory cache 
```

要自定义缓存超时，您可以执行以下操作：

```
$ git config --global credential.helper 'cache --timeout=3600'
# Set the cache to timeout after 1 hour (setting is in seconds) 
```

然后，您的凭据将在请求的时间内存储在内存中。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2020-07-09T17:39:40.103

如果密码中没有@，则下面的 cmd 将起作用： `git pull https://username:pass@word@mygithost.com/my/repository` 如果密码中有@，则将其替换为 %40，如下所示： `git pull https://username:pass%40word@mygithost.com/my/repository`

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2020-11-18T20:05:32.547

使用凭证助手命令行[选项](https://git-scm.com/docs/gitcredentials#_custom_helpers)：

```
git -c credential.helper='!f() { echo "password=mysecretpassword"; }; f' fetch origin 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2021-03-12T19:45:09.273

我刚刚经历了这个，所以提供了我的答案，因为我最终使用了[Gitlab 访问令牌](https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html)，尽管有些人可能需要[Github 访问令牌](https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token)

我更喜欢使用 SSH，但有一个 gitlab 错误阻止了它。将我的密码放在 .netrc 或 URL 中并不理想。凭据管理器需要在服务器重新启动时重新启动，这并不理想。

因此我选择了一个可以像这样使用的访问令牌：`git clone https://<username>:<accessToken>@gitlab.com/ownerName/projectName.git`

访问令牌与 url 一起存储，因此这并不安全，但它比使用 username:password 更安全，因为访问令牌可以限制为某些操作并且可以轻松撤销。

一旦它被克隆下来（或手动更新 URL），您的所有 git 请求都将使用访问令牌，因为它存储在 URL 中。

如果您希望更新已克隆的存储库，这些命令可能会有所帮助：

```
git remote show origin

git remote remove origin

git remote add origin https://<username>:<accessToken>@gitlab.com/ownerName/projectName.git 
```

编辑：一定要检查下面的评论。我添加了 2 个重要说明。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2020-08-27T12:10:06.093

您可以只使用用户名而无需使用密码，因为密码将在 git bash 中提示。

```
git pull https://username@github.com/username/myrepo 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-05-12T08:15:17.077

请注意，git 凭证助手“存储”将[存储未加密密码](https://github.com/git/git/blob/17c7f4d8e4e0e54148f77db4cf73e07aae484ae9/Documentation/git-credential-store.txt)的方式随 Git 2.5+（2014 年第二季度）发生变化。
请参阅[Junio C Hamano (](https://github.com/gitster) [)](https://github.com/gitster)的[提交 17c7f4d](https://github.com/git/git/commit/17c7f4d8e4e0e54148f77db4cf73e07aae484ae9)[`gitster`](https://github.com/gitster)

> ## `credential-xdg`
> 
> 调整凭证助手的示例“ `store`”后端，以在指定时遵守 XDG 配置文件位置。

医生现在说：

> 如果未指定：
> 
> *   将从`~/.git-credentials`和中搜索凭据`$XDG_CONFIG_HOME/git/credentials`，并且
> *   `~/.git-credentials`如果凭据存在，或者`$XDG_CONFIG_HOME/git/credentials`如果存在而前者不存在，则将写入凭据。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-12-07T15:40:19.213

在搜索 Google 和 stackoverflow 一段时间后，我没有找到问题的答案，所以我想在这里分享我的解决方案。

```
git config --global credential.helper "/bin/bash /git_creds.sh"
echo '#!/bin/bash' > /git_creds.sh
echo "sleep 1" >> /git_creds.sh
echo "echo username=$SERVICE_USER" >> /git_creds.sh
echo "echo password=$SERVICE_PASS" >> /git_creds.sh

# to test it
git clone https://my-scm-provider.com/project.git 
```

我也是为 Windows 做的。[完整答案在这里](https://stackoverflow.com/a/65184673/7709964)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-10-19T15:52:39.723

如果您希望在 Gitlab ( `gitlab-ci.yml`) 上的 CI/CD 脚本中执行此操作。你可以使用

```
git pull $CI_REPOSITORY_URL 
```

这将转化为：

```
git pull https://gitlab-ci-token:[MASKED]@gitlab.com/gitlab-examples/ci-debug-trace.gi 
```

而且我很确定它使用的令牌是临时/每个作业令牌 - 所以这种方法的安全漏洞大大减少了。

# c# - 线程无法访问 RichTextBox.Lines

> ID：11506135
> 
> 赞同：-2
> 
> 时间：2012-07-16T14:10:42.130
> 
> 标签：c#

```
 Thread main;

    public void bomb()
    {
        string link = textBox1.Text;

        for (int i = 0; i <= richTextBox1.Lines.Length; i++)
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://" + link + "/");
            WebProxy myproxy = new WebProxy(this.richTextBox1.Lines[i], false);
            //request.Proxy = myproxy;
            request.Method = "GET";
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            label1.Invoke((MethodInvoker)delegate { label1.Text = i.ToString(); });
        }

    }

    private void button1_Click(object sender, EventArgs e)
    {

        main = new Thread(bomb);
        main.Start();

    } 
```

但是行：richTextBox1.Lines.Length 和richTextBox1.Lines.[i]

产生错误：

> 跨线程操作无效：控件 'richTextBox1' 从一个线程而不是创建它的线程访问。

如果我想从richtextbox 中获取文本，一切都可以，但是如果我想获取行，我会出错。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:33:27.343

用于`Invoke`访问`richTextBox1.Lines`_`label1`

```
var lines = (string[])richTextBox1.Invoke(
                           (Func<string[]>)(() => this.richTextBox1.Lines)); 
```

同样适用于`textBox1`

# c++ - CALLBACK DialogProc()定义中的uMsg参数是什么意思

> ID：11506138
> 
> 赞同：1
> 
> 时间：2012-07-16T14:10:57.530
> 
> 标签：c++, visual-c++, dialog, callback, modal-dialog

MSDN 链接[http://msdn.microsoft.com/en-us/library/windows/desktop/ms645469(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645469%28v=vs.85%29.aspx)

解释了**DialogProc 回调函数**。

在这里，我在以下签名中没有看到关于第二个参数（UINT uMsg）的任何解释：

```
INT_PTR CALLBACK DialogProc(   
  __in  HWND hwndDlg,   
  __in  UINT uMsg,   
  __in  WPARAM wParam,   
  __in  LPARAM lParam   
); 
```

谁能解释一下这个第二个参数（UINT uMsg）是什么意思。一些详细的解释（为什么我们需要这个 uMsg 参数，它的用途是什么，它是如何使用的等等......）将非常感激。非常感谢。

PS：我是 Callbacj 函数的新手，Win32 API 编程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:12:48.400

在这种情况下，它是一个[窗口消息](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644927.aspx)或更准确地说是一个对话框消息。类似的参数也存在于[普通的窗口过程](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633573.aspx)中。

有各种类型的窗口消息，其中许多以`WM_`窗口类开头或另一个不同的前缀（此处的类不是 OOP 意义上的，而是 Win32 意义上的）。

该消息说明正在发生什么样的“操作”（从窗口/对话框的角度来看）或您想要诱导（从外部查看）。参数`lParam`，`wParam`然后允许提供有关该“操作”的更多信息。

有些消息只是通知，有些消息可以发送到窗口以诱导某些操作。

# maps - 由于指南针旋转谷歌地图

> ID：11506140
> 
> 赞同：3
> 
> 时间：2012-07-16T14:11:01.100
> 
> 标签：maps, rotation, compass-geolocation

由于指南针，我正在尝试使用 javascript Google API 旋转谷歌地图。我找不到与此相关的任何内容。我需要一些代码示例。

# google-chrome - 我的网络应用作为扩展安装在 Chrome 商店

> ID：11506144
> 
> 赞同：0
> 
> 时间：2012-07-16T14:11:17.687
> 
> 标签：google-chrome, chrome-web-store

我在 chrome 网上商店发布了一个程序，它作为扩展安装，而不是在 chrome 主页上显示图标。

如何停止程序作为扩展安装并使其安装为可安装的网络应用程序？

我在上传选项页面中看不到任何选项。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:30:59.933

您可能正在开发一个打包的应用程序，这是一个新的并且经常变化的东西（根据谷歌的规范）。

看看：http: [//developer.chrome.com/apps/first_app.html](http://developer.chrome.com/apps/first_app.html)

需要确保的一些事项：

*   您的清单表明这是一个打包的应用程序
*   一旦您上传了 chrome 仪表板表明这是一个打包的应用程序的应用程序

* * *

考虑到问题的年龄，从那时到现在，您的情况将发生变化。打包的应用程序现在比 7 个月前成熟得多。

# r - 将零转换为非常小的数字

> ID：11506146
> 
> 赞同：1
> 
> 时间：2012-07-16T14:11:29.677
> 
> 标签：r

我有一些数据要记录下来，然后制作热图。`-Inf`由于我的数据框中的零生成了热图，因此抱怨。

我想将所有的零转换成非常小的数字。我认为这应该相对容易，但我遇到了错误。例如。

```
Error in ifelse(ztest = 0, 1e-05, ztest) : unused argument(s) (ztest = 0) 
```

以下是一些示例数据：

```
 ztest<-data.frame(A=c(0,1,2,3),B=c(0,0,1,2),C=c(1,2,3,4)) 
```

这是我所做的一些尝试，它们都抱怨未使用的论点，所以我想我不明白如何正确编写这些函数。尽管这些尝试看起来都与本网站上发布的类似问题的答案非常相似。

1.  `z_inf <- ifelse(ztest=0,0.00001,ztest)`
2.  `z[z=0]<-0.00001`
3.  `inf_conv <- function(x){ifelse(x=0,0.00001,x)} z_inf<-apply(z,c(1,2),inf_conv)`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:09:31.383

所以你有更多的评论，这里是你的尝试#2的编辑，它应该做你想要的：

```
z[z==0] <- .00001 
```

您之前只有一个“=”，因此它试图将 0 值分配给数据框 z，而不是按照您的意图对 0 值进行子集化。

# ios - build.xml 中唯一的 Xcode BUILD_PATH 环境变量不可用

> ID：11506148
> 
> 赞同：2
> 
> 时间：2012-07-16T14:11:31.897
> 
> 标签：ios, xcode, ant, build, jenkins

自从使用 CocoaPods 以来，我的 ant 脚本 / Jenkins 出现问题（我认为这不是问题的真正原因，它更像是一类问题），这将 Xcode 项目变成了 Xcode 工作区。

我们使用 Jenkins 进行 OTA（无线）分发。

其中有一个作业，它执行一个 ant 脚本。build.xml 是：

```
<project name="iOS Compile" default="simulatorbuild" basedir=".">

    <!-- properties --> 
    <property file="default.properties" />

    <property environment="env" />
    <property name="sdk.simulator" value="iphonesimulator${sdk.version}" />
    <property name="sdk.device" value="iphoneos${sdk.version}" />
    <property name="build.dir" location="build"/>

    <!-- clean -->
    <target name="clean">
        <exec executable="xcodebuild" failonerror="true">
            <arg line="clean" />    
        </exec>

        <delete dir="${build.dir}" />
        <mkdir dir="build"/>
    </target>

    <!-- simulator build -->
    <target name="simulatorbuild" depends="clean">
        <exec executable="xcodebuild" failonerror="true">
            <arg line="-sdk ${sdk.simulator}" />
            <arg line="-configuration ${config.simulator}" />       
            <!--<arg line="-target ${target.app}" />-->
            <arg line="-workspace ${app.title}.xcworkspace" />
            <arg line="-scheme ${app.title}" />
        </exec>
    </target>

    <!-- simulator build for code coverage -->
    <target name="-cc_simulatorbuild">
        <exec executable="xcodebuild" failonerror="true">
            <arg line="-sdk ${sdk.simulator}" />
            <arg line="-configuration ${config.simulator}" />       
            <!--<arg line="-target ${target.app}" />-->
            <arg line="-workspace ${app.title}.xcworkspace" />
            <arg line="-scheme ${app.title}" />

            <!-- Changing some project settings to activate code coverage. -->
            <!--<arg line="OTHER_CFLAGS=- -coverage" /> -->

            <arg line="GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES" />
            <arg line="GCC_GENERATE_TEST_COVERAGE_FILES=YES" />
            <!--<arg line="GCC_PRECOMPILE_PREFIX_HEADER=NO" />-->
        </exec>
    </target>

    <!-- device build -->   
    <target name="devicebuild">
        <exec executable="xcodebuild" failonerror="true">
            <arg line="-sdk ${sdk.device}" />
            <arg line="-configuration ${config.device}" />
            <!--<arg line="-target ${target.app}" />-->
            <arg line="-workspace ${app.title}.xcworkspace" />
            <arg line="-scheme ${app.title}" />
        </exec>
    </target>

    <!-- unit tests -->
    <target name="unittest" depends="simulatorbuild">
        <exec executable="xcodebuild" output="${build.dir}/tmp" errorproperty="error.unittest">
            <arg line="-sdk ${sdk.simulator}" />
            <arg line="-configuration Debug" />
            <arg line="-target ${target.unittests}" />
        </exec>

        <exec executable="ruby">
            <arg line="ocunit2junit.rb" />
            <arg file="${build.dir}/tmp" />
        </exec>

        <delete file="${build.dir}/tmp" />
    </target>

    <!-- code coverage -->
    <target name="codecoverage" depends="-cc_simulatorbuild">
        <exec executable="xcodebuild" output="${build.dir}/tmp" errorproperty="error.unittest">
            <arg line="-sdk ${sdk.simulator}" />
            <arg line="-configuration Debug" />
            <arg line="-target ${target.unittests}" />

            <!-- Changing some project settings to activate code coverage. -->
            <!--<arg line="OTHER_CFLAGS=- -coverage" /> --> 

            <arg line="GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES" />
            <arg line="GCC_GENERATE_TEST_COVERAGE_FILES=YES" />
        </exec>

        <exec executable="ruby">
            <arg line="ocunit2junit.rb" />
            <arg file="${build.dir}/tmp" />
        </exec>

        <delete file="${build.dir}/tmp" />

        <mkdir dir="${build.dir}/code-coverage"/>
        <exec executable="python">
            <arg line="gcovr" />
            <arg line="-x" />               <!-- set XML-Output-->
            <arg line="-v" />               <!-- set more output details -->
            <arg line="-r '${basedir}'" />  <!-- set the root dir -->
            <arg line="-o '${build.dir}/code-coverage/coverage.xml'" />  
        </exec>
    </target>

    <!-- Distribute Target -->
    <target name="distribute" depends="devicebuild">
        <echo message="Set up Over-The-Air-Distribution"/>
        <property name="fileprefix" value="${env.JOB_NAME}-${env.BUILD_NUMBER}-${config.device}"/>
        <property name="app.path" value="${build.dir}/${config.device}-iphoneos/${target.app}.app"/>
        <property name="dSYM.path" value="${build.dir}/${config.device}-iphoneos/${target.app}.app.dSYM"/>
        <property name="output.dir" location="${basedir}/output"/>
        <delete dir="${output.dir}" />
        <mkdir dir="${output.dir}/${fileprefix}" />

        <exec executable="perl">
            <arg line="parsePlist.pl" />
            <arg line="${target.app}" />
        </exec>
        <property file="${target.app}-Infoplist.properties" />

        <!-- generate ipa file -->       
        <exec executable="xcrun" failonerror="true">
            <arg line="-verbose" />
            <arg line="-sdk ${sdk.device}" />
            <arg line="PackageApplication" />
            <arg line="-v '${app.path}'" />
            <arg line="-o '${output.dir}/${fileprefix}/${app.title}.ipa'" />
            <arg line="--sign '${codesign}'" />
            <arg line="--embed '${basedir}/${provisioningprofile}'" />
        </exec>

        <!-- manage app icons -->
        <copy file="${basedir}/${icon.small}" tofile="${output.dir}/${fileprefix}/Icon-57.png"/>
        <copy file="${basedir}/${icon.large}" tofile="${output.dir}/${fileprefix}/Icon-512.png"/>

        <!--copy file="${dSYM.path}" tofile="${output.dir}/${fileprefix}/${target.app}.app.dSYM"/-->

        <!-- generate app manifest -->
        <echoxml file="${output.dir}/${fileprefix}/app-manifest.plist">
            <!--<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">-->
            <plist version="1.0">
                <dict>
                    <key>items</key>
                    <array> 
                        <dict>
                            <key>assets</key>
                            <array>
                                <dict>
                                    <key>kind</key>
                                    <string>software-package</string>
                                    <key>url</key>
                                    <string>${OTAURL}/output/${fileprefix}/${app.title}.ipa</string>
                                </dict>
                                <dict>
                                    <key>kind</key>
                                    <string>full-size-image</string>
                                    <key>needs-shine</key>
                                    <true/>
                                    <key>url</key>
                                    <string>${OTAURL}/output/${fileprefix}/Icon-512.png</string>
                                </dict>
                                <dict>
                                    <key>kind</key>
                                    <string>display-image</string>
                                    <key>needs-shine</key>
                                    <true/>
                                    <key>url</key>
                                    <string>${OTAURL}/output/${fileprefix}/Icon-57.png</string>
                                </dict>
                            </array>
                            <key>metadata</key>
                            <dict>
                                <key>bundle-identifier</key>
                                <string>${CFBundleIdentifier}</string>
                                <key>bundle-version</key>
                                <string>${CFBundleShortVersionString} #${env.BUILD_NUMBER}</string>
                                <key>kind</key>
                                <string>software</string>
                                <key>title</key>
                                <string>${app.title}</string>
                                <key>subtitle</key>
                                <string>${app.subtitle}</string>
                            </dict>
                        </dict>
                    </array>
                </dict>
            </plist>
        </echoxml>
    </target>

</project> 
```

还有一个 default.properties 文件：

```
# default properties
sdk.version         = 5.1
app.title           = <APP_NAME>
app.subtitle        = <APP_NAME>
config.simulator    = Debug
config.device       = Release
target.app          = <APP_NAME>
target.unittests    = <APP_NAME>Test
provisioningprofile = <APP_NAME>AdHoc.mobileprovision
codesign            = iPhone Distribution: <COMPANY_NAME>
icon.small          = Icon.png
icon.large          = Icon@2x.png
OTAURL              = http://<COMPANY_NAME>.com/OTA/<APP_NAME> 
```

当我跑

```
ant distribute 
```

在我的本地机器上（甚至在 CI 服务器上），出现以下错误：

```
[exec] error: Specified application doesn't exist or isn't a bundle directory : '/Users/<MY_USERNAME>/Documents/<COMPANY_NAME>/projects/<APP_NAME>/build/Release-iphoneos/<APP_NAME>.app' 
```

我最近几天做了很多研究。但现在，我没有，还有什么办法......

到目前为止我得到了什么：

1.  从 Xcode 4 开始，构建路径不再是您的项目目录，而是用户库中的唯一文件夹。可以在“派生数据”下找到此设置。“Legacy”是项目文件夹，“unique”（新的默认设置）是用户库。

2.  “distribute”的依赖是“devicebuild”。该目标使用唯一文件夹并在下正确创建它

    /用户//库/开发人员/Xcode/DerivedData

3.  在另一边（在目标“分发”中）我需要更改的唯一行是

    < arg line="-v '${app.path}'" />

它指向本地/项目目录。

我需要设置唯一文件夹（用户库），而不是 app.path。

4.  在[如何在 Xcode 项目中打印“构建设置”列表？](https://stackoverflow.com/questions/6910901/canonical-list-of-xcode-environment-variables)我找到了 Xcode 环境变量的列表。这

    BUILD_DIR

变量接近我需要的。它在文件夹层次结构中有点深，但没关系。

5.  我想，也许是[Xcrun PackageApplication，failed unable to copy application](https://stackoverflow.com/questions/8536728/xcrun-packageapplication-failed-unable-to-copy-application)出现了类似的问题。但实际上并不相同。

尽管 BUILD_DIR 不是绝对正确的，但我尝试使用那个。但我没有成功。

如何在我的 ant 脚本中调用 Xcode 环境变量？这甚至可能吗？

我试过了：

```
< arg line="-v '${BUILD_DIR}'" />
< arg line="-v '$BUILD_DIR'" />
< arg line="-v 'BUILD_DIR'" /> 
```

请告诉我我在不知情的情况下犯了哪个愚蠢的错误。:-)

真的非常感谢提前！如果您需要更多信息（即使我认为我不认为，还有很多我没有告诉您），请问。

问候，祝你有美好的一天，多米尼克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-27T09:39:48.307

嗨，我想这有点晚了，但由于没有人回答这个话题，我会做的。有一个 xcrun 和 xcode-select 命令行工具可以管理开发者文件夹和许多其他有趣的东西。

[https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/xcrun.1.html#//apple_ref/doc/man/1/xcrun](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/xcrun.1.html#//apple_ref/doc/man/1/xcrun)

[https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/xcode-select.1.html](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/xcode-select.1.html)

祝你好运

# uitableview - 在 PopOver 内的 UITableview 之间导航

> ID：11506149
> 
> 赞同：0
> 
> 时间：2012-07-16T14:11:34.967
> 
> 标签：uitableview, uinavigationcontroller, uipopovercontroller

我`UITableview`在 PopOver 内有一个，带有一个`UINavigationController`.

`UITableview`1）当点击第一个单元格中的一个时，如何在弹出框内导航到另一个`UITableview`？

2）另外，`UITableview`加载的新表是否可能比弹出窗口中的前一个表更大？也就是说，新的较大的会相应地`UITableview`调整弹出框的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T00:53:17.357

1.  使用`UINavigationController method pushViewController:animated:`
2.  使用`UIPopoverController method setPopoverContentSize:animated:`

# jquery - 如何通过放置在相关控件的上方或下方来在屏幕上保留下拉 div？

> ID：11506150
> 
> 赞同：0
> 
> 时间：2012-07-16T14:11:34.577
> 
> 标签：jquery, asp.net, css, html, drop-down-menu

应该是一个简单的，但我的搜索提出了不相关的问题。

基本上我已经为 ASP.Net 创建了一个自定义 DropDown CheckBoxList。

它使用像这个简化示例一样的嵌套 Div（列表/表格本身由 ASP.Net CheckBoxList 生成）：

```
<DIV class="dropDownComboxBoxList">
    <DIV class="dropDownControl">
        <DIV class="dropDownLeft">
            <INPUT class="dropDownEdit" type="text" > 
        </DIV>
        <DIV class="dropDownRight">
            <IMG class="img-swap" src="/Images/DropDown_off.gif"> 
        </DIV>
    </DIV>
    <DIV style="MIN-WIDTH: 300px; DISPLAY: none; MAX-HEIGHT: 150px" class="dropDownDiv">
        <TABLE style="WIDTH: 100%; HEIGHT: 40px" id="checkBoxList" class="dropDownTable">
            <TBODY>
                <TR>
                    <TD class="firstCheck">
                        <INPUT class="dropDownCheck" type="checkbox">
                        <LABEL class="dropDownLabel">All</LABEL>
                    </TD>
                </TR>
                <TR class="checkSel">
                    <TD>
                        <INPUT class="dropDownCheck" type="checkbox">
                        <LABEL class="dropDownLabel">Item 0</LABEL>
                    </TD>
                </TR>
            </TBODY>
        </TABLE>
    </DIV>
</DIV> 
```

控件显示如下：

![在此处输入图像描述](../Images/c8cd5a531152874bb8a6c4f64d18deaa.png)

问题是***当 Text 控件位于屏幕中间下方时，弹出 Div 应该出现在 Text 控件上方***，就像任何其他标准下拉菜单一样，例如：

![在此处输入图像描述](../Images/4d5bc31e3d43fdc3bc476f9207e58a1e.png)

## 在 JQuery/CSS 中执行此操作的最简单方法是什么？

**更新 - 我的第一次蹩脚测试尝试看起来像这样（但它跳起来的视觉效果很糟糕）：**

```
function DropDown(id, idt) 
    $(id).toggle('fast', function () {
        if ($(id).css('display') != 'none') {
            var pos = $(id).height() + $(idt).height();
            $(id).css("margin-top", -pos+"px");
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:26:13.230

**这实际上可行，但如果可能的话，我希望看到它改进，以使用最佳实践等：**

```
function DropDown(id, idt) {
    var dd = $(id);
    var tb = $(idt);
    var pos = (tb.position().top > $(window).height() / 2 + $(document).scrollTop()) ? -(dd.height() + tb.height() + 9) : 0;
    dd.css("margin-top", pos + "px");
    dd.toggle(1, function () {
        ... Do more stuff in here
    });
} 
```

剩下的问题包括：

*   您不能为切换设置动画（例如，使用“快速”，因为它会导致动画飞起来）。
*   它需要对位置偏移进行校正，以适应父 div 的填充。

# tfs - 在 TFS 2010 中保存工作项时出现 TF26212 错误

> ID：11506152
> 
> 赞同：1
> 
> 时间：2012-07-16T14:11:40.677
> 
> 标签：tfs

我创建了一个名为“Bug_Tracker”的工作项类型，并明确定义了状态和转换。当使用此工作项创建新错误时，它会分配给开发人员，但是当开发人员将其标记为“已解决”并分配回 QA 时，保存工作项时会出现以下错误：-

***“TF26212：Team Foundation Server 无法保存您的更改。工作项类型定义可能存在问题。重试或联系您的 Team Foundation Server 管理员。”***

以下是工作项的**XML** -

```
<q1:WITD application="Work item type editor" version="1.0" xmlns:q1="http://schemas.microsoft.com/VisualStudio/2008/workitemtracking/typedef">
  <WORKITEMTYPE name="Bug Tracker">
    DESCRIPTION>Describes a divergence between required and actual behavior, and tracks the work done to correct the defect and verify the correction.</DESCRIPTION>
    <FIELDS>
      FIELD reportable="dimension" refname="System.Title" name="Title" type="String">
        <REQUIRED />
        <HELPTEXT>Stories affected and how</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="System.State" name="State" type="String">
        <HELPTEXT>Change on reviewing, fixing or verifying the fix. Active = not yet fixed; Resolved = fix not yet verified; Closed = fix verified.</HELPTEXT>
      </FIELD>
      FIELD reportable="dimension" refname="System.Rev" name="Rev" type="Integer" />
      <FIELD reportable="dimension" refname="System.ChangedBy" name="Changed By" syncnamechanges="true" type="String">
        <ALLOWEXISTINGVALUE />
        <VALIDUSER />
      </FIELD>
      <FIELD refname="Microsoft.VSTS.TCM.SystemInfo" name="System Info" type="HTML">
        <HELPTEXT>Test context, provided automatically by test infrastructure</HELPTEXT>
      </FIELD>
      FIELD refname="Microsoft.VSTS.TCM.ReproSteps" name="Repro Steps" type="HTML">
        <HELPTEXT>How to see the bug. End by contrasting expected with actual behavior.</HELPTEXT>
      </FIELD>
      <FIELD refname="Microsoft.VSTS.Common.StateChangeDate" name="State Change Date" type="DateTime">
        <WHENCHANGED field="System.State">
          <SERVERDEFAULT from="clock" />
        </WHENCHANGED>
        <WHENNOTCHANGED field="System.State">
          <READONLY />
        </WHENNOTCHANGED>
      /FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ActivatedDate" name="Activated Date" type="DateTime">
        <WHENNOTCHANGED field="System.State">
          <READONLY />
        </WHENNOTCHANGED>
      /FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ActivatedBy" name="Activated By" syncnamechanges="true" type="String">
        <WHENNOTCHANGED field="System.State">
          <ALLOWEXISTINGVALUE />
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD reportable="dimension" refname="System.Reason" name="Reason" type="String">
        <HELPTEXT>The reason why the bug is in the current state</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ResolvedBy" name="Resolved By" syncnamechanges="true" type="String">
        <WHENNOTCHANGED field="System.State">
          <ALLOWEXISTINGVALUE />
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD reportable="dimension" refname="System.AssignedTo" name="Assigned To" syncnamechanges="true" type="String">
        <ALLOWEXISTINGVALUE />
        <VALIDUSER />
        <HELPTEXT>The person currently working on this bug</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="System.WorkItemType" name="Work Item Type" type="String" />
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ClosedBy" name="Closed By" syncnamechanges="true" type="String">
        <WHENNOTCHANGED field="System.State">
          <ALLOWEXISTINGVALUE />
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.Priority" name="Priority" type="Integer">
        <ALLOWEDVALUES>
          <LISTITEM value="1" />
          <LISTITEM value="2" />
          <LISTITEM value="3" />
          <LISTITEM value="4" />
        </ALLOWEDVALUES>
        <DEFAULT from="value" value="2" />
        <HELPTEXT>Business importance. 1=must fix; 4=unimportant.</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ResolvedReason" name="Resolved Reason" type="String">
        <ALLOWEDVALUES>
          <LISTITEM value="As Designed" />
          <LISTITEM value="Cannot Reproduce" />
          <LISTITEM value="Deferred" />
          <LISTITEM value="Duplicate" />
          <LISTITEM value="Fixed" />
          <LISTITEM value="Obsolete" />
        </ALLOWEDVALUES>
        <FROZEN />
        <HELPTEXT>The reason why the bug was resolved</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.StackRank" name="Stack Rank" type="Double">
        <HELPTEXT>Work first on items with lower-valued stack rank. Set in triage.</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Build.IntegrationBuild" name="Integration Build" type="String">
        <SUGGESTEDVALUES>
          <LISTITEM value="&lt;None&gt;" />
        </SUGGESTEDVALUES>
        <SUGGESTEDVALUES filteritems="excludegroups">
          <GLOBALLIST name="Builds - TranstutorsProjects" />
        </SUGGESTEDVALUES>
        <HELPTEXT>The build in which the bug was fixed</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Build.FoundIn" name="Found In" type="String">
        <SUGGESTEDVALUES>
          <LISTITEM value="&lt;None&gt;" />
        </SUGGESTEDVALUES>
        <SUGGESTEDVALUES filteritems="excludegroups">
          <GLOBALLIST name="Builds - TranstutorsProjects" />
        </SUGGESTEDVALUES>
        <HELPTEXT>The build in which the bug was found</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="System.CreatedDate" name="Created Date" type="DateTime" />
      <FIELD reportable="dimension" refname="System.CreatedBy" name="Created By" syncnamechanges="true" type="String" />
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.Severity" name="Severity" type="String">
        <ALLOWEDVALUES>
          <LISTITEM value="1 - Critical" />
          <LISTITEM value="2 - High" />
          <LISTITEM value="3 - Medium" />
          <LISTITEM value="4 - Low" />
        </ALLOWEDVALUES>
        <DEFAULT from="value" value="3 - Medium" />
        <HELPTEXT>Assessment of the effect of the bug on the project</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ResolvedDate" name="Resolved Date" type="DateTime">
        <WHENNOTCHANGED field="System.State">
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ClosedDate" name="Closed Date" type="DateTime">
        <WHENNOTCHANGED field="System.State">
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD refname="System.Description" name="Description" type="PlainText" />
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ReopenedDate" name="Reopened Date" type="DateTime">
        <WHENNOTCHANGED field="System.State">
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD refname="System.History" name="History" type="History">
        <HELPTEXT>Discussion thread plus automatic record of changes</HELPTEXT>
      </FIELD>
      <FIELD reportable="dimension" refname="Microsoft.VSTS.Common.ReopenedBy" name="Reopened By" type="String">
        <WHENNOTCHANGED field="System.State">
          <ALLOWEXISTINGVALUE />
          <READONLY />
        </WHENNOTCHANGED>
      </FIELD>
      <FIELD refname="System.RelatedLinkCount" name="Related Link Count" type="Integer" />
      <FIELD reportable="dimension" refname="System.IterationPath" name="Iteration Path" type="TreePath">
        <HELPTEXT>The iteration within which this bug will be fixed</HELPTEXT>
      </FIELD>
      <FIELD refname="System.IterationId" name="Iteration ID" type="Integer" />
      <FIELD refname="System.ExternalLinkCount" name="External Link Count" type="Integer" />
      <FIELD reportable="dimension" refname="System.TeamProject" name="Team Project" type="String" />
      <FIELD refname="System.HyperLinkCount" name="Hyperlink Count" type="Integer" />
      <FIELD refname="System.AttachedFileCount" name="Attached File Count" type="Integer" />
      <FIELD refname="System.NodeName" name="Node Name" type="String" />
      <FIELD reportable="dimension" refname="System.AreaPath" name="Area Path" type="TreePath">
        <HELPTEXT>The area of the product with which this bug is associated</HELPTEXT>
      </FIELD>
      <FIELD reportable="detail" refname="System.RevisedDate" name="Revised Date" type="DateTime" />
      <FIELD reportable="dimension" refname="System.ChangedDate" name="Changed Date" type="DateTime" />
      <FIELD reportable="dimension" refname="System.Id" name="ID" type="Integer" />
      <FIELD refname="System.AreaId" name="Area ID" type="Integer" />
      <FIELD refname="System.AuthorizedAs" name="Authorized As" syncnamechanges="true" type="String" />
    </FIELDS>
    <WORKFLOW>
      <STATES>
        <STATE value="Resolved">
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
              <REQUIRED />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedDate">
              <EMPTY />
            </FIELD>
          </FIELDS>
        </STATE>
        <STATE value="Closed">
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
              <READONLY />
            </FIELD>
          </FIELDS>
        </STATE>
        <STATE value="Verified">
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
              <REQUIRED />
            </FIELD>
          </FIELDS>
        </STATE>
        <STATE value="New">
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedBy">
              <COPY from="currentuser" />
              <REQUIRED />
              <VALIDUSER />
            </FIELD>
            <FIELD refname="System.AssignedTo">
              <DEFAULT from="currentuser" />
            </FIELD>
          </FIELDS>
        </STATE>
      </STATES>
      <TRANSITIONS>
        <TRANSITION from="" to="New">
          <REASONS>
            <DEFAULTREASON value="New Bug" />
          </REASONS>
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedBy">
              <ALLOWEXISTINGVALUE />
              <COPY from="currentuser" />
              <VALIDUSER />
              <REQUIRED />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="System.AssignedTo">
              <COPY from="field" field="System.CreatedBy" />
            </FIELD>
          </FIELDS>
        </TRANSITION>
        <TRANSITION from="New" to="Resolved">
          <ACTIONS>
            <ACTION value="Microsoft.VSTS.Actions.Checkin" />
          </ACTIONS>
          <REASONS>
            <REASON value="Deferred">
              <FIELDS>
                <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
                  <COPY from="value" value="Deferred" />
                  <ALLOWEDVALUES>
                    <LISTITEM value="Deferred" />
                  </ALLOWEDVALUES>
                </FIELD>
              </FIELDS>
            </REASON>
            <REASON value="Duplicate">
              <FIELDS>
                <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
                  <COPY from="value" value="Duplicate" />
                  <ALLOWEDVALUES>
                    <LISTITEM value="Duplicate" />
                  </ALLOWEDVALUES>
                </FIELD>
              </FIELDS>
            </REASON>
            <REASON value="As Designed">
              <FIELDS>
                <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
                  <COPY from="value" value="As Designed" />
                  <ALLOWEDVALUES>
                    <LISTITEM value="As Designed" />
                  </ALLOWEDVALUES>
                </FIELD>
              </FIELDS>
            </REASON>
            <REASON value="Cannot Reproduce">
              <FIELDS>
                <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
                  <COPY from="value" value="Cannot Reproduce" />
                  <ALLOWEDVALUES>
                    <LISTITEM value="Cannot Reproduce" />
                  </ALLOWEDVALUES>
                </FIELD>
              </FIELDS>
            </REASON>
            <REASON value="Obsolete">
              <FIELDS>
                <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
                  <COPY from="value" value="Obsolete" />
                  <ALLOWEDVALUES>
                    <LISTITEM value="Obsolete" />
                  </ALLOWEDVALUES>
                </FIELD>
              </FIELDS>
            </REASON>
            <DEFAULTREASON value="Fixed">
              <FIELDS>
                <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
                  <COPY from="value" value="Fixed" />
                  <ALLOWEDVALUES>
                    <LISTITEM value="Fixed" />
                  </ALLOWEDVALUES>
                </FIELD>
              </FIELDS>
            </DEFAULTREASON>
          </REASONS>
          <FIELDS>
            <FIELD refname="System.AssignedTo">
              <COPY from="field" field="System.CreatedBy" />
              <ALLOWEXISTINGVALUE />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedDate">
              <READONLY />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedBy">
              <ALLOWEXISTINGVALUE />
              <READONLY />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedBy">
              <ALLOWEXISTINGVALUE />
              <COPY from="currentuser" />
              <VALIDUSER />
              <REQUIRED />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
              <COPY from="value" value="Fixed" />
            </FIELD>
          </FIELDS>
        </TRANSITION>
        <TRANSITION from="Resolved" to="Verified">
          <REASONS>
            <DEFAULTREASON value="Fixed" />
          </REASONS>
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedBy">
              <ALLOWEXISTINGVALUE />
              <COPY from="currentuser" />
              <VALIDUSER />
              <REQUIRED />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedReason">
              <COPY from="value" value="Fixed" />
            </FIELD>
          </FIELDS>
        </TRANSITION>
        <TRANSITION from="Verified" to="Resolved">
          <REASONS>
            <REASON value="Reopened" />
            <DEFAULTREASON value="Not fixed" />
          </REASONS>
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedBy">
              <ALLOWEXISTINGVALUE />
              <COPY from="currentuser" />
              <VALIDUSER />
              <REQUIRED />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ActivatedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="System.AssignedTo">
              <COPY from="field" field="Microsoft.VSTS.Common.ResolvedBy" />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ReopenedBy">
              <ALLOWEXISTINGVALUE />
              <COPY from="currentuser" />
              <VALIDUSER />
              <REQUIRED />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ReopenedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
          </FIELDS>
        </TRANSITION>
        <TRANSITION from="Verified" to="Closed">
          <REASONS>
            <DEFAULTREASON value="Verified Fixed" />
          </REASONS>
          <FIELDS>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedBy">
              <ALLOWEXISTINGVALUE />
              <READONLY />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ResolvedDate">
              <READONLY />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ClosedDate">
              <SERVERDEFAULT from="clock" />
            </FIELD>
            <FIELD refname="Microsoft.VSTS.Common.ClosedBy">
              <ALLOWEXISTINGVALUE />
              <COPY from="currentuser" />
              <VALIDUSER />
              <REQUIRED />
            </FIELD>
          </FIELDS>
        </TRANSITION>
      </TRANSITIONS>
    </WORKFLOW>
    <FORM>
      <Layout>
        <Group>
          <Column PercentWidth="100">
            <Control FieldName="System.Title" Type="FieldControl" Label="&amp;Title:" LabelPosition="Left" />
          </Column>
        </Group>
        <Group>
          <Column PercentWidth="50">
            <Group Label="Status">
              <Column PercentWidth="100">
                <Control FieldName="System.State" Type="FieldControl" Label="&amp;State:" LabelPosition="Left" />
                <Control FieldName="System.Reason" Type="FieldControl" Label="&amp;Reason:" LabelPosition="Left" />
                <Control FieldName="Microsoft.VSTS.Common.ResolvedReason" Type="FieldControl" Label="Resolved Reason:" LabelPosition="Left" ReadOnly="True" />
                <Control FieldName="System.AssignedTo" Type="FieldControl" Label="Assigned To:" LabelPosition="Left" />
              </Column>
            </Group>
          </Column>
          <Column PercentWidth="50">
            <Group Label="Classification">
              <Column PercentWidth="100">
                <Control FieldName="System.AreaPath" Type="WorkItemClassificationControl" Label="&amp;Area:" LabelPosition="Left" />
                <Control FieldName="System.IterationPath" Type="WorkItemClassificationControl" Label="Ite&amp;ration:" LabelPosition="Left" />
              </Column>
            </Group>
          </Column>
        </Group>
        <Group>
          <Column PercentWidth="100">
            <Group Label="Planning">
              <Column PercentWidth="33">
                <Control FieldName="Microsoft.VSTS.Common.StackRank" Type="FieldControl" Label="Stack Ran&amp;k:" LabelPosition="Left" NumberFormat="DecimalNumbers" MaxLength="10" />
              </Column>
              <Column PercentWidth="33">
                <Control FieldName="Microsoft.VSTS.Common.Priority" Type="FieldControl" Label="&amp;Priority:" LabelPosition="Left" />
              </Column>
              <Column PercentWidth="33">
                <Control FieldName="Microsoft.VSTS.Common.Severity" Type="FieldControl" Label="Se&amp;verity:" LabelPosition="Left" />
              </Column>
            </Group>
          </Column>
        </Group>
        <TabGroup>
          <Tab Label="Details">
            <Group>
              <Column PercentWidth="50">
                <Control FieldName="Microsoft.VSTS.TCM.ReproSteps" Type="HtmlFieldControl" Label="Steps to Repro&amp;duce:" LabelPosition="Top" Dock="Fill" MinimumSize="(100,200)" />
              </Column>
              <Column PercentWidth="50">
                <Control FieldName="System.History" Type="WorkItemLogControl" Label="&amp;History:" LabelPosition="Top" Dock="Fill" />
              </Column>
            </Group>
          </Tab>
          <Tab Label="System Info">
            <Group>
              <Column PercentWidth="50">
                <Control FieldName="Microsoft.VSTS.Build.FoundIn" Type="FieldControl" Label="&amp;Found in Build:" LabelPosition="Left" />
              </Column>
              <Column PercentWidth="50">
                <Control FieldName="Microsoft.VSTS.Build.IntegrationBuild" Type="FieldControl" Label="In&amp;tegrated in Build:" LabelPosition="Left" />
              </Column>
            </Group>
            <Control FieldName="Microsoft.VSTS.TCM.SystemInfo" Type="HtmlFieldControl" Label="System I&amp;nfo:" LabelPosition="Top" Dock="Fill" />
          </Tab>
          <Tab Label="Test Cases">
            <Control Type="LinksControl" Label="Test &amp;Cases testing this Bug:" LabelPosition="Top" Name="TestedBy">
              <LinksControlOptions>
                <LinkColumns>
                  <LinkColumn RefName="System.ID" />
                  <LinkColumn RefName="System.WorkItemType" />
                  <LinkColumn RefName="System.Title" />
                  <LinkColumn RefName="System.AssignedTo" />
                  <LinkColumn RefName="System.State" />
                  <LinkColumn LinkAttribute="System.Links.Comment" />
                </LinkColumns>
                <WorkItemLinkFilters FilterType="include">
                  <Filter LinkType="Microsoft.VSTS.Common.TestedBy" FilterOn="forwardname" />
                </WorkItemLinkFilters>
                <ExternalLinkFilters FilterType="excludeAll" />
                <WorkItemTypeFilters FilterType="include">
                  <Filter WorkItemType="Test Case" />
                </WorkItemTypeFilters>
              </LinksControlOptions>
            </Control>
          </Tab>
          <Tab Label="All Links">
            <Control Type="LinksControl" LabelPosition="Top" Name="GeneralLinks">
              <LinksControlOptions>
                <LinkColumns>
                  <LinkColumn RefName="System.ID" />
                  <LinkColumn RefName="System.WorkItemType" />
                  <LinkColumn RefName="System.Title" />
                  <LinkColumn RefName="System.AssignedTo" />
                  <LinkColumn RefName="System.State" />
                  <LinkColumn LinkAttribute="System.Links.Comment" />
                </LinkColumns>
                <WorkItemLinkFilters FilterType="includeAll" />
                <ExternalLinkFilters FilterType="includeAll" />
                <WorkItemTypeFilters FilterType="includeAll" />
              </LinksControlOptions>
            </Control>
          </Tab>
          <Tab Label="Attachments">
            <Control Type="AttachmentsControl" LabelPosition="Top" />
          </Tab>
        </TabGroup>
      </Layout>
    </FORM>
  </WORKITEMTYPE>
</q1:WITD> 
```

非常感谢这方面的任何帮助！

# couchdb - 为什么 couchdb 中没有 validate_doc_update 的读取模拟？

> ID：11506154
> 
> 赞同：2
> 
> 时间：2012-07-16T14:11:44.240
> 
> 标签：couchdb

我将它作为 couchdb 的建议功能，因为这是表达我想要实现的最佳方式，并且作为咆哮，因为我没有找到缺乏它的充分理由：为什么没有 validate_doc_read(doc, userCtx ) 功能，以便我可以实现每个文档的读取控制？它的工作方式与 validate_doc_update 完全一样，在您想要拒绝读取时抛出错误。我错过了什么？有人找到了按文档读取控制的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:16:25.280

我不确定真正的原因是什么，但是进行读取验证会使读取变得非常缓慢，并且查看索引很难增量更新（或者可能是不可能的，这意味着您基本上必须拥有每个用户的索引）。

实现您想要的方法是通过过滤复制，因此您创建一个新数据库，其中仅包含您希望给定用户能够阅读的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-29T14:27:58.907

创建 validate_doc_read 的主要问题是我们如何使用具有该行为的 reduce 函数。

我不敢相信 validate_doc_read 是最好的解决方案，因为我们会放弃一个特性来支持另一个特性。

这样，您必须使用代理限制视图访问。

# php - 如何根据symfony 2中的角色重定向到不同的url

> ID：11506155
> 
> 赞同：17
> 
> 时间：2012-07-16T14:11:48.437
> 
> 标签：php, symfony

我在网站上有一个登录页面。我有 4 种不同类型的用户，我希望他们在登录时根据分配的角色转到不同的页面。

有什么办法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-16T14:23:15.253

解决此问题的一种方法是在事件上使用事件侦听器`security.interactive_login`。在这种情况下，我只需在该事件侦听器中附加另一个侦听器，以便它会在响应时触发。这让身份验证仍然发生，但在完成后仍然执行重定向。

```
<service id="sotb_core.listener.login" class="SOTB\CoreBundle\EventListener\SecurityListener" scope="request">
    <tag name="kernel.event_listener" event="security.interactive_login" method="onSecurityInteractiveLogin"/>
    <argument type="service" id="router"/>
    <argument type="service" id="security.context"/>
    <argument type="service" id="event_dispatcher"/>
</service> 
```

还有班级...

```
class SecurityListener
{
    protected $router;
    protected $security;
    protected $dispatcher;

    public function __construct(Router $router, SecurityContext $security, EventDispatcher $dispatcher)
    {
        $this->router = $router;
        $this->security = $security;
        $this->dispatcher = $dispatcher;
    }

    public function onSecurityInteractiveLogin(InteractiveLoginEvent $event)
    {
        $this->dispatcher->addListener(KernelEvents::RESPONSE, array($this, 'onKernelResponse'));
    }

    public function onKernelResponse(FilterResponseEvent $event)
    {
        if ($this->security->isGranted('ROLE_TEAM')) {
            $response = new RedirectResponse($this->router->generate('team_homepage'));
        } elseif ($this->security->isGranted('ROLE_VENDOR')) {
            $response = new RedirectResponse($this->router->generate('vendor_homepage'));
        } else {
            $response = new RedirectResponse($this->router->generate('homepage'));
        }

        $event->setResponse($response);
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-18T18:40:39.480

对于 Symfony >= 2.6 现在将是：

```
<?php

namespace CommonBundle\Listener;

use Monolog\Logger;
use Symfony\Component\EventDispatcher\EventDispatcherInterface;
use Symfony\Component\HttpKernel\Event\FilterResponseEvent;
use Symfony\Component\HttpKernel\KernelEvents;
use Symfony\Component\Routing\Router;
use Symfony\Component\Security\Core\Authentication\Token\Storage\TokenStorage;
use Symfony\Component\Security\Http\Event\InteractiveLoginEvent;

class LoginListener
{
    /** @var Router */
    protected $router;

    /** @var TokenStorage */
    protected $token;

    /** @var EventDispatcherInterface */
    protected $dispatcher;

    /** @var Logger */
    protected $logger;

    /**
     * @param Router $router
     * @param TokenStorage $token
     * @param EventDispatcherInterface $dispatcher
     * @param Logger $logger
     */
    public function __construct(Router $router, TokenStorage $token, EventDispatcherInterface $dispatcher, Logger $logger)
    {
        $this->router       = $router;
        $this->token        = $token;
        $this->dispatcher   = $dispatcher;
        $this->logger       = $logger;
    }

    public function onSecurityInteractiveLogin(InteractiveLoginEvent $event)
    {
        $this->dispatcher->addListener(KernelEvents::RESPONSE, [$this, 'onKernelResponse']);
    }

    public function onKernelResponse(FilterResponseEvent $event)
    {
        $roles = $this->token->getToken()->getRoles();

        $rolesTab = array_map(function($role){
            return $role->getRole();
        }, $roles);

        $this->logger->info(var_export($rolesTab, true));

        if (in_array('ROLE_ADMIN', $rolesTab) || in_array('ROLE_SUPER_ADMIN', $rolesTab)) {
            $route = $this->router->generate('backend_homepage');
        } elseif (in_array('ROLE_CLIENT', $rolesTab)) {
            $route = $this->router->generate('frontend_homepage');
        } else {
            $route = $this->router->generate('portal_homepage');
        }

        $event->getResponse()->headers->set('Location', $route);
    }
} 
```

和 services.yml

```
services:
common.listener.login:
    class: CommonBundle\Listener\LoginListener
    arguments: [@router, @security.token_storage, @event_dispatcher, @logger]
    scope: request
    tags:
        - { name: kernel.event_listener, event: security.interactive_login, method: onSecurityInteractiveLogin } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-07-26T21:00:00.403

> 在 Symfony 3.1 中测试

您还可以在用户成功登录后为 security.yml 文件中的所有用户设置默认路径，如下所示：

**[配置/安全.yml]**

```
...

firewalls:
    # disables authentication for assets and the profiler, adapt it according to your needs
    dev:
        pattern: ^/(_(profiler|wdt)|css|images|js)/
        security: false
    main:
        pattern: /.*
        form_login:
            login_path: /login
            check_path: /login_check
            default_target_path: /login/redirect <<<<<<<<<<<<<<<<<<<<<<<<<
        logout:
            path: /logout
            target: /
        security: true
        anonymous: ~
... 
```

**然后**在`default_target_path`方法中根据用户角色进行简单的重定向。非常直截了当。有人说，最简单的方法总是最好的方法。你决定 ：）

**[SomeBundle/Controller/SomeController.php]**

```
/**
 * Redirect users after login based on the granted ROLE
 * @Route("/login/redirect", name="_login_redirect")
 */
public function loginRedirectAction(Request $request)
{

    if (!$this->get('security.authorization_checker')->isGranted('IS_AUTHENTICATED_FULLY'))
    {
        return $this->redirectToRoute('_login');
        // throw $this->createAccessDeniedException();
    }

    if($this->get('security.authorization_checker')->isGranted('ROLE_ADMIN'))
    {
        return $this->redirectToRoute('_admin_panel');
    }
    else if($this->get('security.authorization_checker')->isGranted('ROLE_USER'))
    {
        return $this->redirectToRoute('_user_panel');
    }
    else
    {
        return $this->redirectToRoute('_login');
    }
} 
```

像魅力一样工作，但请记住始终向下检查最受限制的角色，以防您的 ROLE_ADMIN 也具有 ROLE_USER 等权限......

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-19T08:12:43.267

我使用了 Mdrollette 答案，但这个解决方案有一个很大的缺点，你完全覆盖了 symfony 的原始响应，并通过这样做删除了 symfony 在标题中设置的记住我的 cookie。

我的解决方案是以这种方式更改 OnKernelResponse ：

```
public function onKernelResponse(FilterResponseEvent $event)
{
    if ($this->security->isGranted('ROLE_TEAM')) {
        $event->getResponse()->headers->set('Location', $this->router->generate('team_homepage'));    
    } elseif ($this->security->isGranted('ROLE_VENDOR')) {
        $event->getResponse()->headers->set('Location', $this->router->generate('vendor_homepage'));
    } else {
        $event->getResponse()->headers->set('Location', $this->router->generate('homepage'));
    }
} 
```

这样你就可以保持原封不动的记住我的 cookie。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-16T15:44:48.547

如果您正在寻找比@MDrollette 更简单的答案，您可以将类似的重定向块放入登录成功页面的控制器中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-19T08:57:02.197

为了测试，如果您想保留原始响应，您也可以只复制标头。Redirect 对象上的 clone 方法只复制标头。

```
public function onKernelResponse(FilterResponseEvent $event)
{
    if ($this->security->isGranted('ROLE_TEAM')) {
        $response = new RedirectResponse($this->router->generate('team_homepage'));
    } elseif ($this->security->isGranted('ROLE_VENDOR')) {
        $response = new RedirectResponse($this->router->generate('vendor_homepage'));
    } else {
        $response = new RedirectResponse($this->router->generate('homepage'));
    }

    $response->headers = $response->headers + $event->getResponse()->headers;

    $event->setResponse($response);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-01T12:14:36.727

我在登录表单身份验证器中使用它来根据角色重定向用户（symfony：4.26.8）：

```
use Symfony\Component\Routing\Generator\UrlGeneratorInterface;
use Symfony\Component\Security\Core\Security;

private $urlGenerator;
/**
 * @var Security
 */
private $security;

public function __construct(UrlGeneratorInterface $urlGenerator ,Security $security)
{
    $this->urlGenerator = $urlGenerator;
    $this->security = $security;
}

public function onAuthenticationSuccess(Request $request, TokenInterface $token, string $firewallName): ?Response
    {        
    // redirecting user by role : 
        $user = $this->security->getUser();
        $roles = $user->getRoles();
        $rolesTab = array_map(function($role){
            return $role;
        }, $roles);
        if (in_array('ROLE_ADMIN', $rolesTab) || in_array('ROLE_SUPER_ADMIN', $rolesTab)) {
            return new RedirectResponse($this->urlGenerator->generate('admin'));
        }
        else{
            return new RedirectResponse($this->urlGenerator->generate('home'));
    }
} 
```

# ios - UIScrollView Child 的坐标倒置

> ID：11506158
> 
> 赞同：0
> 
> 时间：2012-07-16T14:11:55.780
> 
> 标签：ios, uiscrollview

我有一个 UIScrollView 作为 ViewController.view 的孩子，由于某种原因，UISCrollView 中的坐标系统似乎是反转的？是否有一个原因？

当我将 UILabels 或 UIImages 添加到 UISCrollView 时，它似乎添加了相反的内容。

像这样的声明

```
tempLabel = [[UILabel alloc] initWithFrame:
CGRectMake(tempImage.frame.origin.x,
           tempImage.frame.origin.y + tempImage.frame.size.height * 1.5,
           80, 
           25)]; 
```

将标签添加到图像的左上角，而不是中间的下方。什么可能导致坐标翻转？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:22:09.047

检查界面构建器中的“Origin”属性，确保它在左上角，如您所愿： ![在此处输入图像描述](../Images/ed77460a1a983dbbd8b22e01cebff690.png)

# java - Hibernate 中的最大并发事务数是否有限制？

> ID：11506159
> 
> 赞同：2
> 
> 时间：2012-07-16T14:11:56.697
> 
> 标签：java, hibernate, transactions

我有一个客户端向使用 Hibernate 的服务层发送 3 个请求。

每个单独的请求都会导致 Hibernate 开始一个事务 ( `session.beginTransaction()`)。

我发现，**有时**，一个事务（来自 2+ 个正在运行的并发事务）以`createQuery is not valid without active transaction`.

这是我使用的 Hibernate 配置（在 Tomcat 6.0.x 和 OC4j 10.1.3.4 中运行）：

```
<property name="hibernate.connection.pool_size">5</property>
        <!--  <property name="hibernate.current_session_context_class">thread</property> -->
        <property name="hibernate.current_session_context_class">org.hibernate.context.ThreadLocalSessionContext</property>
        <property name="connection.autoReconnect">true</property>
        <property name="connection.autoReconnectForPools">true</property>
        <property name="connection.is-connection-validation-required">true</property>
        <property name="hibernate.show_sql">true</property>
        <property name="hibernate.format_sql">false</property>

        <!-- auto commit -->
        <!-- <property name="connection.autocommit">true</property> -->

        <!-- configuration pool via c3p0 -->
        <property name="c3p0.idleConnectionTestPeriod">1000</property>
        <property name="c3p0.initialPoolSize">5</property>
        <property name="c3p0.maxPoolSize">10</property>
        <property name="c3p0.maxIdleTime">1</property>
        <property name="c3p0.maxStatements">30</property>
        <property name="c3p0.minPoolSize">1</property>

        <property name="cache.use_query_cache">true</property>
        <property name="cache.provider_class">org.hibernate.cache.EhCacheProvider</property>
        <property name="cache.use_second_level_cache">true</property> 
```

编辑：我正在使用以下代理来管理所有事务：

```
import java.lang.reflect.Field;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;
import java.lang.reflect.Proxy;
import java.util.HashMap;
import java.util.Map;
import java.util.logging.Logger;

import org.hibernate.HibernateException;
import org.hibernate.Session;
import org.hibernate.Transaction;

/**
 * http://stackoverflow.com/questions/2587702
 * 
 * @author mohammad_abdullah
 */
public class ServiceProxy implements InvocationHandler {

    private Object object;
    private Logger logger = Logger.getLogger(this.getClass().getSimpleName());
    private static final String SESSION_FIELD = "session";

    public static final Map<Long, Transaction> ACTIVE_TRANSACTIONS = new HashMap<Long, Transaction>();

    private ServiceProxy(Object object) {
        this.object = object;
    }

    public static Object newInstance(Object object) {
        return Proxy.newProxyInstance(object.getClass().getClassLoader(), object.getClass().getInterfaces(), new ServiceProxy(object));
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {

        Object result = null;
        Session session = null;
        boolean joined = false;
        try {
            if (Modifier.isPublic(method.getModifiers())) {

                session = HibernateUtil.getSessionFactory().getCurrentSession();

                Field sessionField = object.getClass().getSuperclass().getDeclaredField(SESSION_FIELD);
                if (sessionField == null)
                    throw new UPSAdminException("Service Implementation should have field named: \"" + SESSION_FIELD + "\".");
                sessionField.setAccessible(true);
                sessionField.set(object, session);

                if (session.getTransaction().isActive()) {
                    joined = true;
                    logger.info("Using Already Active transaction" + " Method: " + method.getName() + " Thread: "
                            + Thread.currentThread().getId());
                    ACTIVE_TRANSACTIONS.put(Thread.currentThread().getId(), session.getTransaction());
                } else {
                    logger.info("Transaction Began" + " Method: " + method.getName() + " Thread: " + Thread.currentThread().getId());
                    Transaction newTnx = session.beginTransaction();
                    ACTIVE_TRANSACTIONS.put(Thread.currentThread().getId(), newTnx);
                }
                result = method.invoke(object, args);

                if (!joined) {
                    ACTIVE_TRANSACTIONS.get(Thread.currentThread().getId()).commit();
                    ACTIVE_TRANSACTIONS.remove(Thread.currentThread().getId());
                    logger.info("Transaction Commited" + " Method: " + method.getName() + " Thread: " + Thread.currentThread().getId());
                }
            } else {
                result = method.invoke(object, args);
            }

            return result;

        } catch (InvocationTargetException _ex) {
            Throwable cause = _ex.getCause();
            logger.severe("Caller Exception: " + cause + " Method: " + method.getName() + " Thread: " + Thread.currentThread().getId());

            if (!joined && session != null && session.getTransaction().isActive()) {
                ACTIVE_TRANSACTIONS.get(Thread.currentThread().getId()).rollback();
                ACTIVE_TRANSACTIONS.remove(Thread.currentThread().getId());
            }

            if (cause instanceof HibernateException) {
                logger.severe("Hibernate Error. Rollbacked Back. Method: " + method.getName() + " Thread: "
                        + Thread.currentThread().getId());
                throw new DBException(cause.getCause().getMessage());

            } else if (cause instanceof SetRollbackException) {
                logger.severe("Transaction marked for Rollback. Rollbacked Back. Method: " + method.getName() + " Thread: "
                        + Thread.currentThread().getId());
                return result;

            } else {
                logger.severe("Error in Business Method : " + method + ". Rollbacked Back." + " Thread: " + Thread.currentThread().getId());
                throw cause;
            }
        } catch (Exception ex) {
            logger.severe("Error in Proxy code :" + ex + " Method :" + method + " Thread: " + Thread.currentThread().getId());

            if (!joined && session != null && session.getTransaction().isActive()) {
                ACTIVE_TRANSACTIONS.get(Thread.currentThread().getId()).rollback();
                ACTIVE_TRANSACTIONS.remove(Thread.currentThread().getId());
            }

            if (ex instanceof HibernateException)
                throw new DBException(ex.getCause().getMessage());

            throw ex;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:46:00.000

你测试你的 beginTransaction() 成功吗？

您是否在释放池后关闭连接而不等待它自动关闭？

[来自http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html)的示例：

```
Session sess = factory.openSession();
Transaction tx;
try {
   tx = sess.beginTransaction();
   //do some work
   ...
   tx.commit();
}
catch (Exception e) {
   if (tx!=null) tx.rollback();
      throw e;
   }
finally {
   sess.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:35:23.377

由于您已经创建了一个大小为 5 的连接池，因此对于并发事务来说，它应该不会出现太多问题。**createQuery()**方法更新脏持久化它需要在事务中运行的对象。我认为这就是你错误的原因。

当涉及到**事务和连接**时，每个事务都必须持有一个连接，但是由于连接是池化的，如果事务处于等待状态，它将释放连接回到池中。如果并发事务太多，而连接数较少，则会延迟处理。对于长时间的交易，甚至有可能出现死锁等问题......

[您可以在链接中找到用于事务](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/transactions.html)和[上下文会话](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/architecture.html#architecture-current-session)的休眠 API 。

# android - 安卓手机usb绑定后如何获取系统ip地址？

> ID：11506160
> 
> 赞同：3
> 
> 时间：2012-07-16T14:11:57.353
> 
> 标签：android, networking, usb, mobile-application, android-1.6-donut

我正在用 android 开发一个移动应用程序。
在这里，我想在任何 android 手机的 USB 绑定后检测计算机、系统等的 IP 地址，但
我找不到解决方案。
如果我输入以下代码，那么它只需要电话的 IP 地址，我需要系统的 IP 地址

以下是代码

```
 ArrayList<InetAddress> arrayList=new ArrayList<InetAddress>();

        try {
            for (Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();) {
                NetworkInterface intf = en.nextElement();
                for (Enumeration<InetAddress> enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();) {
                    InetAddress inetAddress = enumIpAddr.nextElement();
                    arrayList.add(inetAddress);
                    inetAddress=null;
                }
            }
        } catch (SocketException ex) {
            Log.e("SALMAN", ex.toString());
        }
        return arrayList; 
```

请帮我获取系统的IP地址，如果我们无法获取方法，请提及我。因为我是安卓新手。

我正在使用 android 1.6 。

windows xp系统中有服务器端应用程序。该应用程序是由 C# .net 开发的 Windows 服务。
该Windows服务侦听某些端口，例如234等。如果某些数据到达端口，那么它将处理数据并通过该端口发送响应。

在 android 中，android 应用程序通过套接字将数据发送到 windows 服务。
安卓手机通过USB连接到运行windows服务的系统，系统假设安卓手机为modem，并为系统生成额外的IP地址。这个IP地址是安卓手机连接时动态生成的。
对于通过套接字将数据从移动设备传输到系统。我需要在我的 android 编码中提供系统的 IP 地址（绑定后）。
如果android编码中有任何方法可以获取此IP地址。
所有人都请就此提出您的想法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T05:47:03.940

绑定后无法从 android 中找到在 PC 中创建的 IP 地址。没有 API 或其他方法可以找到它。

如果您使用 InetAddress ，它将返回 192.168.42.129 - 这是由 USB Tethering 创建的 DHCP 地址。它不会帮助你沟通。

另一种方法是扫描IP列表。USB Tethering 将创建 192.168.42.1 到 192.168.42.255 的 ip。您可以编写一个简单的扫描仪来查找哪个处于活动状态。但这需要一些时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-19T07:35:27.593

感谢上面的“Swim N Swim”。[我在Retrieve IP and MAC addresses from /proc/net/arp (Android)](https://stackoverflow.com/questions/34592493/retrieve-ip-and-mac-addresses-from-proc-net-arp-android)中找到了一个代码

并稍作修改以获得具有有效 MAC 地址的第一个 IP。在您的 PC 上作为单一用户进行开发时非常有效。您可以按照上面的链接根据公司名称等进一步选择 IP。

```
public static String getUSBThetheredIP() {

    BufferedReader bufferedReader = null;
    String ips="";

    try {
        bufferedReader = new BufferedReader(new FileReader("/proc/net/arp"));

        String line;
        while ((line = bufferedReader.readLine()) != null) {
            String[] splitted = line.split(" +");
            if (splitted != null && splitted.length >= 4) {
                String ip = splitted[0];
                String mac = splitted[3];
                if (mac.matches("..:..:..:..:..:..")) {
                    if (mac.matches("00:00:00:00:00:00")) {
                        //Log.d("DEBUG", "Wrong:" + mac + ":" + ip);
                    } else {
                        //Log.d("DEBUG", "Correct:" + mac + ":" + ip);
                        ips = ip;
                        break;
                    }
                }
            }
        }

    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally{
        try {
            bufferedReader.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    return ips;
} 
```

请注意，每次在 untether 之后进行 tether 时，都必须在 PC 上启动 apache 或其他进程才能使新 IP 生效。这就是我所经历的。

# php - 如何编辑我的网站源代码

> ID：11506164
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:12:11.770
> 
> 标签：php, html

嗨，伙计们，我确定这个问题已经被问过了，但我是一个喜欢画画的人，所以我需要用我自己的语言再次提问。我有一个网站，当我在上面运行 W3 Validator 时，它说我需要修复一些代码区域。

这就是问题所在：它是用 .php 编写的。我只知道.html。

如何将 php 源代码转换为 html 源代码，以便我可以成功修复需要修复的内容？

非常感谢您花时间回答这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:19:42.963

您的 Web 服务器已经将您的 PHP 代码转换为 HTML 代码，以允许客户端 Web 浏览器显示它。如果您有验证问题，那么您必须在您的 PHP 代码中修复它，否则下次客户端请求您的网页时，您的验证修复将被覆盖。

因此，首先要做的是在您的 PHP 文件中定位验证问题。如果幸运的话，也许它只是您的一个 PHP 文件中的一堆 HTML 代码。然后使用通用编辑器（Vim、Gedit、Eclipse 等）打开您的 PHP 文件并更改代码以修复验证问题。

然后，学习 PHP，它将永远为您服务 ;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:18:19.320

PHP 完全在服务器端执行。您的浏览器永远不会收到任何 PHP 代码（除非您的服务器配置存在重大错误，并且这是一个安全问题）。
在您的网络浏览器中使用“查看源代码”，您将看到 W3C 验证器尝试验证的内容。
然后编辑您的 PHP 代码以生成正确的 HTML 代码并使 W3C 验证器满意。

# asp.net - 如何将输入类型 =“文件”转换为 .net 文件上传？

> ID：11506165
> 
> 赞同：0
> 
> 时间：2012-07-16T14:12:13.610
> 
> 标签：asp.net, .net

我有使用标准表单的现有遗留代码。

我想在后面代码的页面初始化事件中获取此输入 type="file" 元素的句柄，并将其转换为 .net fileUpload 对象。

这可能吗？不重写整个表格？

提前致谢。

编辑：不寻找如何处理上传处理的示例，只是寻找入口点 - 如何获取对输入 type=file 的引用并将其视为 .net fileupload 对象。- 再次感谢。

我在想：

```
Dim myControl1 as FileUpload = FindControl("myFileElement") 
```

如果我能解决选角问题，这行得通吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:14:43.317

类外的`Files`财产`HttpRequest`就足够了吗？

[http://msdn.microsoft.com/en-us/library/system.web.httprequest.files.aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.files.aspx)

# iphone - 一致的 NSUserDefaults 保存

> ID：11506167
> 
> 赞同：0
> 
> 时间：2012-07-16T14:12:22.740
> 
> 标签：iphone, ios, xcode

所以在我的应用程序中，我保存了一些整数键`NSUserDefaults`，比如至少 20 个。

像这样的东西，但很多：

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
[prefs setInteger:1 forKey:@"game1"];
[prefs setInteger:1 forKey:@"game2"];
[prefs setInteger:1 forKey:@"game3"]; 
```

所以我只是想知道， **我应该打电话给**：

```
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

**每次我保存？**

因为有时我会遇到我保存的整数不一致的情况，并且一直在加载停止、在主页按钮中`xCode`或从主页按钮运行应用程序。

我在一个网站上读过几篇文章，上面写着：

在 iOS4 中，您的用户默认设置在按下主页按钮时可能不会被保存。手动调用应确保您正确保存`[[NSUserDefaults standardUserDefaults] synchronize]`。`applicationDidEnterBackground:``User Defaults`

**这在 iOS5 中是真的吗？**或者有更准确的方法，更短的方法来保存整数。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:17:07.537

苹果的文档是这样说的：

“由于此方法会定期自动调用，因此仅当您无法等待自动同步（例如，如果您的应用程序即将退出）或您想要更新用户默认值时才使用此方法虽然你没有做任何改变。”

因此，根据您设置的数据的紧迫性，您可能不需要调用同步。完整的文档在[这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:16:01.890

不，您不需要，当您调用`setInteger:forKey:`时`prefs`，它会自动保存。

# c++ - Opencv cvThreshold 错误

> ID：11506174
> 
> 赞同：0
> 
> 时间：2012-07-16T14:12:53.157
> 
> 标签：c++, opencv

您好，我不知道我是否做错了什么，但是当我执行以下操作时：

```
IplImage *testimage;
testimage = cvCreateImage(cvSize(10,10),IPL_DEPTH_8U,1);
cvThreshold(testimage,testimage,127,127,CV_THRESH_TRUNC); 
```

当我尝试使用无符号短值时，一切正常：

```
IplImage *testimage;
testimage = cvCreateImage(cvSize(10,10),IPL_DEPTH_16U,1);
cvThreshold(testimage,testimage,127,127,CV_THRESH_TRUNC); 
```

我的程序崩溃了...我使用 opencv 2.4.2 我认为这可能是 opencv 中的错误。不知何故，如果我尝试以下操作：

```
IplImage *testimage;
testimage = cvCreateImage(cvSize(10,10),IPL_DEPTH_16S,1);
cvThreshold(testimage,testimage,127,127,CV_THRESH_TRUNC); 
```

它不再崩溃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:17:27.303

它没有崩溃。它正在引发异常，并且由于您没有捕获它，因此您的程序正在中止。OpenCV Thresholding 不支持 16U。

```
The supported ones are: 8U, 16S and 32F 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:18:56.037

[有关函数阈值](http://docs.opencv.org/modules/imgproc/doc/miscellaneous_transformations.html?highlight=cvthreshold#double%20cvThreshold%28const%20CvArr%2a%20src,%20CvArr%2a%20dst,%20double%20threshold,%20double%20max_value,%20int%20threshold_type%29)，请参阅 OpenCV 文档。第一个参数是 8 位或 32 位图像
PS 在崩溃消息中，您应该看到崩溃的原因

# java - RSA 密钥交换 iOS 到 Java

> ID：11506177
> 
> 赞同：3
> 
> 时间：2012-07-16T14:12:54.690
> 
> 标签：java, ios, certificate, rsa, exchange-server

**在我的 iPhone 应用程序上，我使用SecKeyGeneratePair**生成了一个公私密钥对。

现在我想将公钥发送到我的 Java 服务器。是否有可能从我的公钥中提取模数和指数或生成 X509 证书，以便我可以在我的 java 服务器上使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:15:25.900

是的，您可以从公钥生成 X509 证书并从您的 java 服务器中使用它。阅读这篇文章，它很有帮助： http: [//www.mayrhofer.eu.org/create-x509-certs-in-java/](http://www.mayrhofer.eu.org/create-x509-certs-in-java/)

# javascript - Web Audio API 从暂停中恢复

> ID：11506180
> 
> 赞同：16
> 
> 时间：2012-07-16T14:12:57.353
> 
> 标签：javascript, html, google-chrome, html5-audio, web-audio-api

我经常读到无法使用[**Web Audio API**](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html)暂停/恢复音频文件。
但现在我看到了一个[**例子**](http://www.htmlfivewow.com/demos/hal/index.html)，他们实际上可以暂停和恢复它。我试图弄清楚他们是怎么做到的。我认为也许`source.looping = false`是关键，但事实并非如此。
现在我的音频总是从头开始重新播放。

这是我当前的代码

```
var context = new (window.AudioContext || window.webkitAudioContext)();

function AudioPlayer() {
  this.source = context.createBufferSource();
  this.analyser = context.createAnalyser();
  this.stopped = true;
}

AudioPlayer.prototype.setBuffer = function(buffer) {
  this.source.buffer = buffer;
  this.source.looping = false;
};

AudioPlayer.prototype.play = function() {
  this.source.connect(this.analyser);
  this.analyser.connect(context.destination);

  this.source.noteOn(0);
  this.stopped = false;
};

AudioPlayer.prototype.stop = function() {
  this.analyser.disconnect();
  this.source.disconnect();
  this.stopped = true;
}; 
```

有人知道该怎么做，让它工作吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-09-01T20:56:43.690

Oskar 的回答和 ayke 的评论非常有帮助，但我错过了一个代码示例。所以我写了一个：http: [//jsfiddle.net/v3syS/2/](http://jsfiddle.net/v3syS/2/)我希望它有所帮助。

```
var url = 'http://thelab.thingsinjars.com/web-audio-tutorial/hello.mp3';

var ctx = new webkitAudioContext();
var buffer;
var sourceNode;

var startedAt;
var pausedAt;
var paused;

function load(url) {
    var request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.responseType = 'arraybuffer';
    request.onload = function() {
        ctx.decodeAudioData(request.response, onBufferLoad, onBufferError);
    };
    request.send();
};

function play() {
    sourceNode = ctx.createBufferSource();
    sourceNode.connect(ctx.destination);
    sourceNode.buffer = buffer;
    paused = false;

    if (pausedAt) {
        startedAt = Date.now() - pausedAt;
        sourceNode.start(0, pausedAt / 1000);
    }
    else {
        startedAt = Date.now();
        sourceNode.start(0);
    }
};

function stop() {
    sourceNode.stop(0);
    pausedAt = Date.now() - startedAt;
    paused = true;
};

function onBufferLoad(b) {
    buffer = b;
    play();
};

function onBufferError(e) {
    console.log('onBufferError', e);
};

document.getElementById("toggle").onclick = function() {
    if (paused) play();
    else stop();
};

load(url); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-10-14T12:51:31.597

在当前的浏览器（Chrome 43、Firefox 40）中，AudioContext 现在有 'suspend' 和 'resume' 方法可用：

```
var audioCtx = new AudioContext();
susresBtn.onclick = function() {
  if(audioCtx.state === 'running') {
    audioCtx.suspend().then(function() {
      susresBtn.textContent = 'Resume context';
    });
  } else if(audioCtx.state === 'suspended') {
    audioCtx.resume().then(function() {
      susresBtn.textContent = 'Suspend context';
    });  
  }
} 
```

[（来自https://developer.mozilla.org/en-US/docs/Web/API/AudioContext/suspend](https://developer.mozilla.org/en-US/docs/Web/API/AudioContext/suspend)的修改示例代码）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-16T17:56:06.753

实际上，网络音频 API 可以为您完成暂停和播放任务。它知道音频上下文的当前状态（运行或暂停），因此您可以通过以下简单方式执行此操作：

```
susresBtn.onclick = function() {
  if(audioCtx.state === 'running') {
    audioCtx.suspend()
  } else if(audioCtx.state === 'suspended') {
    audioCtx.resume()  
  }
}
```

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-16T14:45:55.983

无需花费任何时间检查示例的来源，我会说您将要使用 AudioBufferSourceNode 的 noteGrainOn 方法（[https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/规范.html#methodsandparams-AudioBufferSourceNode](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#methodsandparams-AudioBufferSourceNode) )

只需跟踪调用 noteOff 时进入缓冲区的距离，然后在新的 AudioBufferSourceNode 上恢复时从那里执行 noteGrainOn。

这有意义吗？

编辑： ~~有关更新的 API 调用，请参阅下面的评论。~~

2019 年第 2 版：请参阅 MDN 了解更新的 API 调用；[https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode/start](https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode/start)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-12-27T17:54:21.393

对于 chrome 修复，每次要播放声音时，请将其设置为：

```
if(audioCtx.state === 'suspended') {
    audioCtx.resume().then(function() {
      audio.play();
   });  
}else{
     audio.play();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-09T09:29:27.713

WebAudio API 中缺乏内置的暂停功能对我来说似乎是一个重大疏忽。将来可能会使用计划的 MediaElementSource 来执行此操作，这将使您可以将元素（支持暂停）连接到 Web 音频。目前，大多数解决方法似乎都是基于记住播放时间（例如 imbrizi 的回答中所述）。这样的解决方法在循环声音时会出现问题（实现是否循环无缝？），以及当您允许动态更改声音的播放速率时（因为两者都会影响时间）。另一个同样 hack-ish 并且在技术上不正确，但您可以使用的更简单的解决方法是：

```
source.playbackRate = paused?0.0000001:1; 
```

不幸的是， 0 不是一个有效的回放速率值（它实际上会暂停声音）。但是，对于许多实际用途，一些非常低的值（例如 0.000001）已经足够接近，并且不会产生任何可听输出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-27T13:26:13.807

更新：这仅对 Chrome 有效。Firefox (v29) 尚未实现该`MediaElementAudioSourceNode.mediaElement`属性。

假设您已经拥有 AudioContext 引用和媒体源（例如通过`AudioContext.createMediaElementSource()`方法调用），您可以在源上调用`MediaElement.play()`和`MediaElement.pause()`，例如

```
source.mediaElement.pause();
source.mediaElement.play(); 
```

无需破解和变通方法，它是受支持的。如果您使用`<audio>`标签作为源，则不应直接在 JavaScript 中的音频元素上调用 pause，这将停止播放。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-20T18:07:34.290

在 2017 年，使用 ctx.currentTime 可以很好地跟踪歌曲中的点。下面的代码使用一个按钮 (songStartPause) 在播放和暂停按钮之间切换。为了简单起见，我使用了全局变量。变量 musicStartPoint 跟踪您在歌曲中的时间。音乐 api 以秒为单位跟踪时间。

将您的初始 musicStartPoint 设置为 0（歌曲的开头）

```
var ctx = new webkitAudioContext();
var buff, src;
var musicLoaded = false;
var musicStartPoint = 0;
var songOnTime, songEndTime;
var songOn = false;

songStartPause.onclick = function() {

  if(!songOn) {
    if(!musicLoaded) {
      loadAndPlay();
      musicLoaded = true;
    } else {
      play();
    }

    songOn = true;
    songStartPause.innerHTML = "||"  //a fancy Pause symbol

  } else {
    songOn = false;
    src.stop();
    setPausePoint();
    songStartPause.innerHTML = ">"  //a fancy Play symbol
  }
} 
```

使用 ctx.currentTime 从歌曲开始时减去歌曲结束的时间，并将此时间长度附加到您最初在歌曲中的距离。

```
function setPausePoint() {
  songEndTime = ctx.currentTime;
  musicStartPoint += (songEndTime - songOnTime);
} 
```

加载/播放功能。

```
function loadAndPlay() {
  var req = new XMLHttpRequest();
  req.open("GET", "//mymusic.com/unity.mp3")
  req.responseType = "arraybuffer";
  req.onload = function() {
    ctx.decodeAudioData(req.response, function(buffer) {
      buff = buffer;
      play();
    })
  }
  req.send();
}

function createBuffer() {
      src = ctx.createBufferSource();
      src.buffer = buff;
    }

function connectNodes() {  
  src.connect(ctx.destination); 
} 
```

最后，播放函数告诉歌曲从指定的 musicStartPoint 开始（并立即播放），并设置 songOnTime 变量。

```
function play(){
  createBuffer() 
  connectNodes();
  songOnTime = ctx.currentTime;
  src.start(0, musicStartPoint);
} 
```

*旁注：我知道在 click 函数中设置 songOnTime 可能看起来更简洁，但我认为尽可能接近 src.start 获取时间码是有意义的，就像我们如何尽可能接近获取暂停时间一样到 src.stop。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-21T08:49:34.587

我没有关注完整的讨论，但我很快就会关注。我只是通过 HAL 演示来了解。对于那些现在喜欢我的人，我想告诉 1 - 如何让这段代码现在工作。2 - 从这段代码中获得暂停/播放的技巧。

1 : 将 noteOn(xx) 替换为 start(xx) 并将任何有效的 url 放入 sound.load() 中。我想这就是我所做的一切。您将在控制台中收到一些非常有指导意义的错误。跟着他们。或不：有时你可以忽略它们，它现在可以工作了：它与某些函数中的 -webkit 前缀有关。新的被给予。2：在某些时候，当它起作用时，您可能想要暂停声音。它会起作用的。但是，众所周知，新的比赛压力会引发错误。结果，错误的source_.start(0)之后的this.play()中的代码没有被执行。我只是将这些行包含在 try/catch 中：

```
 this.play = function() {
    analyser_ = context_.createAnalyser();

    // Connect the processing graph: source -> analyser -> destination
    source_.connect(analyser_);
    analyser_.connect(context_.destination);
  try{
    source_.start(0);
  }
  catch(e){
    this.playing = true;

    (function callback(time) {
      processAudio_(time);
      reqId_ = window.webkitRequestAnimationFrame(callback);
    })();
  } 
```

它有效：您可以使用播放/暂停。我想提一下，这个[HAL 模拟](http://jazz-miracles.com/hal.html)真的令人难以置信。按照这些简单的步骤，这是值得的！

# java - java htmlcleaner在清理时崩溃

> ID：11506181
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:07.730
> 
> 标签：java, xhtml, html-parsing, htmlcleaner

嗨，在我的代码中，我运行以下几行，但此代码在执行期间崩溃。

```
ByteArrayInputStream input = new ByteArrayInputStream(fileContent);

final HtmlCleaner cleaner = new HtmlCleaner();
CleanerProperties props = cleaner.getProperties();

DomSerializer doms = new DomSerializer(props, true);

org.w3c.dom.Document xmlDoc = null;

try {
    TagNode node = cleaner.clean(input);
    xmlDoc = doms.createDOM(node);
} catch (Exception e) {
    System.out.println("Tiding error ");
    e.printStackTrace();
} 
```

这是错误的堆栈跟踪：

```
NAMESPACE_ERR: An attempt is made to create or change an object in a way which is incorrect with regard to namespaces.
    at com.sun.org.apache.xerces.internal.dom.CoreDocumentImpl.checkDOMNSErr(CoreDocumentImpl.java:2535)
    at com.sun.org.apache.xerces.internal.dom.AttrNSImpl.setName(AttrNSImpl.java:113)
    at com.sun.org.apache.xerces.internal.dom.AttrNSImpl.<init>(AttrNSImpl.java:74)
    at com.sun.org.apache.xerces.internal.dom.CoreDocumentImpl.createAttributeNS(CoreDocumentImpl.java:2138)
    at com.sun.org.apache.xerces.internal.dom.ElementImpl.setAttributeNS(ElementImpl.java:656)
    at org.htmlcleaner.DomSerializer.setAttributes(DomSerializer.java:97)
    at org.htmlcleaner.DomSerializer.createDOM(DomSerializer.java:37) 
```

任何人都可以帮助找出它发生的原因吗？

真诚的，佐利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T01:26:42.647

HTMLCleaner 在处理命名空间时遇到了问题。下面是一个 XML 命名空间声明的例子，它会给它带来麻烦：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de"
  xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml" 
  itemscope itemtype="http://schema.org/CreativeWork"> 
```

如您所见， itemscope 属性已损坏，因此 HtmlCleaner 抛出 NAME_SPACE_ERR。

避免该问题的一种方法是添加该行

```
props.setNamespacesAware(false); 
```

这会关闭命名空间处理。

# c++ - 为c++游戏引擎搭建增量开发环境

> ID：11506182
> 
> 赞同：2
> 
> 时间：2012-07-16T14:13:08.763
> 
> 标签：c++, editor, game-engine

假设我用 C++ 编写了一个游戏引擎。是adPlayer(Vec3f position, Model playerModel), addExplosion(Vec3f position, Size explodeSize)等函数。

现在，可以在某种测试类中调用这些函数，然后可以编译和运行项目。这需要永远。

理想的是有一些基本的文本编辑器，我可以在其中键入这些函数，按 ctrl+u 然后这会以某种方式调用游戏引擎的预编译函数。例如，它不会重新编译游戏引擎。

这将如何完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:18:10.220

通常，您会将引擎编译为 .dll 并将其链接到您的项目。然后，您可以只链接该函数，如果您只想使用这些函数，则不必编译它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:18:44.343

**如果您询问设计迭代**，您可以创建一种数据格式，在场景图中读取并转换为实体。您需要使用工厂模式。您可以使用序列化库，其中每个对象都知道如何读取/写入/持久化自身。

通过拥有代表游戏状态“快照”的数据格式，您可以从游戏和编辑器中读取/保存它。稍后，您可以通过在运行时重新读取数据的函数来对正在运行的游戏实例进行设计更改

现在似乎您可能已经硬编码/混合了客户端代码和引擎代码，这可能很难分开。

**如果您询问编译**，那么您将希望编译为库（.dll 或静态 .lib/.so）。然后针对您的引擎库编译您的客户端/特定代码。他们应该在单独的项目中。

# c++ - QMdiArea::addSubwindow 处的 Qt4.8.1 未处理异常

> ID：11506188
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:29.460
> 
> 标签：c++, qt, visual-c++, qt4.8

我使用这些说明编译了 Qt 4.8.1：http: [//www.holoborodko.com/pavel/2011/02/01/how-to-compile-qt-4-7-with-visual-studio-2010/](http://www.holoborodko.com/pavel/2011/02/01/how-to-compile-qt-4-7-with-visual-studio-2010/)

对于我的系统（Visual Studio 2010，x64）。编译工作正常，一切似乎都很好。虽然编译有很多输出，但它非常快，因此我无法阅读它，所以我想这应该不是问题。

在我成功编译当前项目后，我得到了一个未处理的运行时异常。过了一会儿，我发现它来自`QMdiArea::addSubwindow`函数，这似乎引发了异常（虽然我无法使用覆盖的通知函数来捕获它）。所以我搜索了一个示例项目，看看它是我的代码还是其他东西。我在这里找到了这个例子：http: [//www.codeprogress.com/cpp/libraries/qt/qMdiAreaAddSubWindow.php](http://www.codeprogress.com/cpp/libraries/qt/qMdiAreaAddSubWindow.php)

它在 32 位模式和 x64 的调试模式下都可以正常工作，但在 `QMdiArea::addSubwindow`函数中再次出现未处理的异常。有谁知道出了什么问题或有同样的问题？

目前我正在重新编译 Qt 以再次获取调试信息（我事先清理了它）。

但也许有人对我有同样的问题和解决方案。

//更新：代码在这里（与链接中的完全相同）

```
#include <QApplication>
#include <QMainWindow>
#include <QMdiArea>
#include <QMdiSubWindow>

int main(int argc, char **argv)
{
    QApplication app(argc, argv);

    QMainWindow window;
    window.setFixedSize(800,600);
    window.setWindowTitle(QString::fromUtf8("My QMdiWindow"));
    QMdiArea* area = new QMdiArea();
    area->setSizePolicy(QSizePolicy::Expanding,QSizePolicy::Expanding);

    //Create QMdiSubWindow
    QMdiSubWindow* subWindow = new QMdiSubWindow();
    subWindow->setFixedSize(200,100); 

    //Add subWindow to Main QMdiWindow here
    area->addSubWindow(subWindow);

    window.setCentralWidget(area);
    window.show();

    return app.exec();
} 
```

//Update2：我[在这里](http://qt-project.org/forums/viewthread/18819/)打开了另一个讨论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T09:50:41.503

好的，我发现了问题。这是 MSVC++ 编译器中的一个错误。安装[服务包](http://www.microsoft.com/en-us/download/details.aspx?id=23691)并重新编译 Qt 会有所帮助。

# .net - 在 .NET MVC 3 中，如何让我的 SearchViewModel 的 ID 属性使用我的自定义路由？

> ID：11506191
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:32.050
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-3, razor

我已经定义了以下自定义路线：

```
routes.MapRoute(
               "EditSearch",
               "EditUser/Edit/{userId}",
               new { controller = "EditUser", action = "Edit" }
           ); 
```

当我手动输入 URL 时，路由工作得很好。但是，当我的搜索页面的 GET 表单发布时，URL 显示为`../EditUser/Edit/?userId=aaa9999`. GET 表单在我的 Search.cshtml 文件中定义为`@using (Html.BeginForm("Edit", "EditUser", FormMethod.Get ))`，并且应该将`userId`参数发送到 Edit 操作。

我的 Search.cshtml 页面有一个`Html.EditorFor(model => model.userId)`包含我希望在我的 URL 地址中显示的 userId 参数。

当按下“搜索”按钮时，我希望我的搜索页面指向下面的 URL：

```
../EditUser/Edit/aaa9999 
```

PS 我知道 EditUser 控制器名称和 Edit 操作名称是多余的，但我稍后会修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:30:04.717

您可以将路由值传递给`BeginForm`方法。

```
@using(Html.BeginForm("Edit", "EditUser", new { userId = Model.userId }, FormMethod.Get))
{
   ...
} 
```

通常，当您编辑模型时，您的 url 通常看起来像这样，

```
http://mysite.com/users/edit/1 
```

当您提交 GET 或 POST 表单（我建议使用 POST）时，表单使用当前 URL，在这种情况下，您必须使用所有表单，

```
@using(Html.BeginForm())
{
  ...
} 
```

生成的表格看起来像

```
<form action="/" method="post">
   ...
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:17:36.883

只需要添加 userId 参数就可以了，它会起作用。

> ```
> routes.MapRoute(
>                "EditSearch",
>                "EditUser/Edit/{userId}",
>                new { controller = "EditUser", action = "Edit", userId="" }
>            ); 
> ```

# active-directory - 在活动目录设置之后将在哪里创建注册表项

> ID：11506192
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:34.950
> 
> 标签：active-directory, group-policy

我正在使用活动目录在应用程序中创建用户，之后将在注册表编辑器中创建注册键。

# html - 使表格行不可见，但其内容可见

> ID：11506193
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:35.997
> 
> 标签：html, css, html-table

我正在使用 IE7 和 IE8。无论如何，是否有一个完全不可见或透明的表格行，其中包含可见的表格数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:24:41.587

你的意思是只有一个透明的行吗？这可以通过为表格数据行分配一个特定的类来使用 CSS 来实现：

**HTML**

```
<table>
    <tr>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td class="invisible"></td>
        <td class="invisible"></td>
        <td class="invisible"></td>
    </tr>
</table> 
```

**CSS**

```
td {
    border: 1px solid black;
}

.invisible {
    border: 0;
} 
```

JS 小提琴：http: [//jsfiddle.net/sK338/](http://jsfiddle.net/sK338/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:18:36.590

也许您需要添加边框=“0”？

# javascript - 谷歌地图样式查询

> ID：11506194
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:42.327
> 
> 标签：javascript, google-maps, google-fusion-tables

我使用 FusionTablesLayer 向导 ( [http://gmaps-samples.googlecode.com/svn/trunk/fusiontables/fusiontableslayer_builder.html](http://gmaps-samples.googlecode.com/svn/trunk/fusiontables/fusiontableslayer_builder.html) ) 在北德文郡创建风力涡轮机地图。

[http://www.thisisnorthdevon.co.uk/images/localpeople/ugc-images/275834/binaries/WindTurbines.html](http://www.thisisnorthdevon.co.uk/images/localpeople/ugc-images/275834/binaries/WindTurbines.html)

但是有两个问题。

首先是我在 Fusion Table 图层中创建的样式没有实现。是否有强制图层采用这种样式的开关？

第二个是我不希望 shapefile 图层可点击。我该如何关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:07:24.997

> 但是有两个问题。
> 
> *   首先是我在 Fusion Table 图层中创建的样式没有实现。是否有强制图层采用这种样式的开关？

不知道你问的是什么样式。它是在 FusionTable 中定义的样式吗？通过 FusionTables 向导？看起来您可能缺少将样式应用到地图 this 或等效项：

```
 map.setOptions({styles: styles}); 
```

您可能需要查看[有关设置地图样式的文档](https://developers.google.com/maps/documentation/javascript/styling#creating_a_styledmaptype)

> *   第二个是我不希望 shapefile 图层可点击。我该如何关闭它？

要禁用对该 FusionTablesLayer 的点击，请在构建它时使用[suppressInfoWindows选项。](https://developers.google.com/maps/documentation/javascript/reference#FusionTablesLayerOptions)

[您的页面在多边形层和样式上抑制了 infowindows](http://www.geocodezip.com/v3_FusionTables_thisisnorthdevon_co_uk_WindTurbines.html)，请注意您的 html 无效（无正文）。

# ruby-on-rails-3 - Rails 3：将“通用”控制器路由与标准资源路由混合

> ID：11506197
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:46.220
> 
> 标签：ruby-on-rails-3, routes

我有一组如下所示的路线：

```
resources :placements do
  match '/foo' => "placements#foo"
  match '/bar' => "placements#bar"
end 
```

这会产生行为与您期望的一样的路由：

```
/placements/1234/foo
/placements/1234/bar 
```

但是，我还需要一些不需要单独放置的方法的“通用”路由。因此，我构建了一个如下所示的路线块：

```
resources :placements do
  match '/foo' => "placements#foo"
  match '/bar' => "placements#bar"
end
match '/placements/baz' => "placements#baz" 
```

如果 I `rake routes`，我会得到一条看起来不错的路线：

```
/placements/baz 
```

请注意缺少 id。但是，如果我尝试*访问*该路由，Rails 会尝试调用`show`控制器上的方法，就好像“baz”是一个 ID，而不是一个方法名称。如何构建一个路由结构，让我得到我所追求的，而不必将我的路由的第一段 ( `placements`) 更改为其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:16:28.010

将第二条路线移到`resources`块上，即

```
match '/placements/baz' => "placements#baz"
resources :placements, :id => /\d+/ do
  match '/foo' => "placements#foo"
  match '/bar' => "placements#bar"
end 
```

或为`id`in添加正则表达式`resources`，例如：

```
resources :placements, :id => /\d+/ do
  match '/foo' => "placements#foo"
  match '/bar' => "placements#bar"
end
match '/placements/baz' => "placements#baz" 
```

# c# - 创建 XNA 3.1 项目 - 奇怪的错误

> ID：11506200
> 
> 赞同：0
> 
> 时间：2012-07-16T14:13:53.590
> 
> 标签：c#, visual-studio-2008, xna

我刚刚下载并安装了 xna 3.1，当我尝试在 VS 2008 C# EXPRESS 中创建一个新的 XNA 3.1 项目时，我收到以下错误：![在此处输入图像描述](../Images/b3d1a74734d9ecc88c567e2d581fc4eb.png)

我已经尝试为此寻找解决方案，但没有找到任何解决方案（解决方案是在我尝试创建**新**项目时打开现有项目时。

谢谢！

# sql - 小时：Oracle 中的分钟演示

> ID：11506205
> 
> 赞同：0
> 
> 时间：2012-07-16T14:14:10.100
> 
> 标签：sql, oracle

我必须在每分钟的时间演示中创建表格。将有三个字段

TIME_DESC 值：00:00、00:01、...、12:32、12:33、...、23:58、23:59（根据小时和分钟） 小时值：00-23（根据小时）分钟值：00-59（根据分钟）

所以，单条记录看起来像 || 01:05 || 01 || 05 || 或 || 22:25 || 22 || 25 ||

如何在单个 Oracle 查询中实现此表创建？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:43:11.497

你可以这样做：

```
select to_char(hr, '00')||':'||to_char(mi, '00') as time_desc,
       to_char(hr, '00') as hours, to_char(mi, '00') as minutes
from (select level-1 from dual connect by level <= 24) as hr cross join
     (select level-1 from dual connect by level <= 60) as mi 
```

这里的技巧是生成从 0 到 23 和 0 到 59 的数字。其余的只是按照您想要的方式格式化这些数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:47:33.880

你可以试试：

```
WITH t AS (
  SELECT to_date('0001-01-01', 'yyyy-mm-dd') + interval '1' MINUTE * (LEVEL-1) datetime
  FROM dual
CONNECT BY LEVEL <= 1440
)
SELECT to_char(t.datetime, 'hh24:mi') time,
       to_char(t.datetime, 'hh24') hh,
       to_char(t.datetime, 'mi') mi
FROM t 
```

[这](http://www.sqlfiddle.com/#!4/d41d8/1378)是一个小提琴

# vba - VBA Inet1 GetChunk 函数

> ID：11506206
> 
> 赞同：1
> 
> 时间：2012-07-16T14:14:13.280
> 
> 标签：vba, excel

编辑

我正在尝试调用 inet1.GetChunk 以在一个变量名下呈现文档的整个 HTML。但是，我遇到了问题。我在下面发布了我的代码：

```
Sub File_Names()

Dim myURL

ActiveSheet.Range("a1").End(xlDown).Select
lastColumn = Selection.Row

For columnNumber = 2 To lastColumn
    workbench = Cells(columnNumber, 1).Value
    myURL = "my_web_page"&workbench
    Dim inet1 As Inet

Set inet1 = New Inet
With inet1
    .Protocol = icHTTP
    .URL = myURL
    .Execute , "Get"
End With

While inet1.StillExecuting
    DoEvents
Wend

mypage = inet1.GetChunk(1024, icString)

Do While Len(ReturnStr) <> 0
    DoEvents
    mypage = mypage & ReturnStr
    Cells(2, 10).Value = mypage
    ReturnStr = myURL.GetChunk(1024, icString)
Loop

CAMnum = InStr(mypage, "Component Accessory Matrix")
intStart = InStrRev(mypage, "pkid=", CAMnum) + 5
newnum = Mid(mypage, intStart, 6)
Cells(columnNumber, 2).Value = newnum

Next columnNumber

End Sub 
```

我得到的问题是`mypage = inet1.GetChunk(1024,icString)`。它显示“运行时错误 24：需要对象”。我不确定为什么会收到此错误消息。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:43:28.617

`.OpenURL`是同步的；它会打开 URL 然后阻塞，直到它完全加载到`**mypage**`变量中，所以内容已经“在一个变量名下”。

如果您想要异步读取，则需要使用`.Execute`方法和事件。`_StateChanged`（[将状态事件与 GetChunk 方法一起使用](http://msdn.microsoft.com/en-us/library/aa733648%28v=vs.60%29.aspx)）

# cuda - 尝试构建我的 CUDA 程序时出现错误 MSB4062

> ID：11506220
> 
> 赞同：4
> 
> 时间：2012-07-16T14:15:14.423
> 
> 标签：cuda

当我尝试构建我的第一个 GPU 程序时出现以下错误。有什么建议可能会出错吗？

> 错误 1 ​​错误 MSB4062：无法从程序集 C:\Program Files\MSBuild\Microsoft.Cpp\v4.0\BuildCustomizations\Nvda.Build.CudaTasks.dll 加载“Nvda.Build.CudaTasks.SanitizePaths”任务。无法加载文件或程序集 'file:///C:\Program Files\MSBuild\Microsoft.Cpp\v4.0\BuildCustomizations\Nvda.Build.CudaTasks.dll' 或其依赖项之一。该系统找不到指定的文件。确认声明正确，程序集及其所有依赖项都可用，并且任务包含实现 Microsoft.Build.Framework.ITask 的公共类。C:\Program Files\MSBuild\Microsoft.Cpp\v4.0\BuildCustomizations\CUDA 3.2.targets 70 4 gpu

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-09T22:48:44.277

我遇到过这个问题。在互联网上搜索了很多，但我找不到任何东西。最后我意识到我在控制面板的 Windows 功能部分关闭了 Microsoft .NET Framework 3.5.1 功能。

要打开 Microsoft .Net Framework 3.5.1，您可以轻松按照这些说明进行操作；

[http://www.sevenforums.com/tutorials/5023-windows-features-turn-off.html](http://www.sevenforums.com/tutorials/5023-windows-features-turn-off.html)。

我希望这个解决方案能帮助你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-24T08:34:07.723

将系统升级到 Windows 10 后，我遇到了这个问题。事实证明，我必须重新安装 Visual Studio，因为一些依赖的 dll 已移至 Windows.old 文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-27T15:36:25.333

我在远程服务器上编译时遇到了同样的错误。我认为这是因为我使用远程桌面 (RDP) 登录。当我使用 VNC 登录并编译时，错误不再发生。

请注意，甚至无法通过 RDP 安装 CUDA Toolkit，因此这不太可能发生，除非您经常使用这两种方法连接到服务器。

# android - 通过 Post 上传的进度

> ID：11506223
> 
> 赞同：0
> 
> 时间：2012-07-16T14:15:17.823
> 
> 标签：android, http, upload, progress-bar

我想通过 POST 向服务器发送文本、图片等。通常我使用 ASynchHTTPClient 一个类，我在 web ( [https://github.com/AsyncHttpClient/async-http-client](https://github.com/AsyncHttpClient/async-http-client) ) 中找到了它。

现在我想从上传中获得努力，用进度条将其可视化。

任何人都有想法或知道如何通过命名类来实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-16T14:19:54.200

检查这个[http://toolongdidntread.com/android/android-multipart-post-with-progress-bar/](http://toolongdidntread.com/android/android-multipart-post-with-progress-bar/)

# php - XAMPP中的phpMyAdmin“配置中定义的controluser连接失败”

> ID：11506224
> 
> 赞同：132
> 
> 时间：2012-07-16T14:15:18.590
> 
> 标签：php, phpmyadmin, xampp

我刚刚在我的 Windows XP 机器上安装了 XAMPP，我收到一条错误消息：

> 配置中定义的 controluser 连接失败。

在我安装 XAMPP 之前，我安装了一个 MySQL 数据库并且它有一个密码。我更改了密码并将其放入 MySQL 的 config.inc.php 中，但出现此错误：

```
<?php
if (!empty($_SERVER['HTTPS']) && ('on' == $_SERVER['HTTPS'])) {
    $uri = 'https://';
} else {
    $uri = 'http://';
}
$uri .= $_SERVER['HTTP_HOST'];
header('Location: '.$uri.'/xampp/');
exit;
?> 
```

当我尝试访问 index.php 时，XAMPP 安装似乎有问题。我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2012-07-16T14:31:07.190

1.  在浏览器中打开 phpMyAdmin 并以 root 身份登录。
2.  创建一个名为`phpmyadmin`
3.  创建一个名为的用户`pma`并将“主机”设置为您的 Web 服务器的主机名或 IP 地址（如果 Web 服务器和 MySQL 在同一个框上使用`localhost`），记下密码，并授予新用户完全控制权`phpmyadmin`数据库。建议此用户无权访问此数据库以外的任何内容。
4.  转到 phpMyAdmin 安装目录，您应该在其中找到一个名为`sql`.
5.  在`sql`您将找到一个名为`create_tables.sql`. 在文本编辑器中打开它。
6.  在 phpMyAdmin 中，选择`phpmyadmin`数据库并单击“SQL”选项卡。
7.  将整个文本复制/粘贴`create_tables.sql`到文本框中，然后运行查询。
8.  打开`config.inc.php`phpMyAdmin 安装目录中的文件，并添加以下行（或更改现有设置，如果它们已经存在）：

    ```
    $cfg['Servers'][1]['pmadb'] = 'phpmyadmin';
    $cfg['Servers'][1]['controluser'] = 'pma';
    $cfg['Servers'][1]['controlpass'] = '<your password>';

    // Note: The list below may grow as PMA evolves and more control tables are added
    // Use your common sense! Don't just blindly copypasta, look at what it means!
    $cfg['Servers'][1]['bookmarktable'] = 'pma_bookmark';
    $cfg['Servers'][1]['relation'] = 'pma_relation';
    $cfg['Servers'][1]['userconfig'] = 'pma_userconfig';
    $cfg['Servers'][1]['table_info'] = 'pma_table_info';
    $cfg['Servers'][1]['column_info'] = 'pma_column_info';
    $cfg['Servers'][1]['history'] = 'pma_history';
    $cfg['Servers'][1]['recent'] = 'pma_recent';
    $cfg['Servers'][1]['table_uiprefs'] = 'pma_table_uiprefs';
    $cfg['Servers'][1]['tracking'] = 'pma_tracking';
    $cfg['Servers'][1]['table_coords'] = 'pma_table_coords';
    $cfg['Servers'][1]['pdf_pages'] = 'pma_pdf_pages';
    $cfg['Servers'][1]['designer_coords'] = 'pma_designer_coords'; 
    ```

9.  保存并关闭文件。

**重要**- PMA 在登录时加载配置，对其进行评估并将其存储到会话数据中，因此在您执行以下操作之前消息不会消失：

10.  退出 phpMyAdmin 并重新登录

问题解决了。

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2012-11-01T14:43:31.003

如果您来到这里并且使用的是 Debian/Ubuntu（或任何其他基于 dpkg 的发行版），请执行以下命令：

```
sudo dpkg-reconfigure phpmyadmin 
```

phpmyadmin 包包含为您执行此操作的脚本，它只需要一个具有权限的用户。当然，如果您以 root 身份登录，则不需要 sudo。

编辑：可能值得尝试删除当前的 phpmyadmin 用户。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-11-26T09:54:20.280

只需注释掉`config.inc.php`.

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-11-16T12:50:05.537

您最近是否更改了 MySQL 服务器的 root 密码？如果答案是肯定的，那么这就是 phpMyAdmin 控制台中的错误/警告的原因。要解决此问题，只需编辑 phpMyAdmin 的 config-db.php 文件并设置正确的数据库密码。

在我看来，第一个答案太混乱了，第二个答案对我不起作用。所以：

在基于 Linux 的服务器中，该文件通常位于：

```
/etc/phpmyadmin/config-db.php 
```

或者：

```
/etc/phpMyAdmin/config-db.php 
```

示例：（我的文件看起来像这样，我将用户从 更改`phpmyadmin`为`admin`，这是我为通过 phpmyadmin 维护我的数据库而创建的用户名，并输入了适当的密码。

```
$dbuser='phpmyadmin';
$dbpass=''; // set current password between quotes ' '
$basepath='';
$dbname='phpmyadmin';
$dbserver='';
$dbport='';
$dbtype='mysql'; 
```

学分：[http ://tehnoblog.org/phpmyadmin-error-connection-for-controluser-as-defined-in-your-configuration-failed/](http://tehnoblog.org/phpmyadmin-error-connection-for-controluser-as-defined-in-your-configuration-failed/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-01-13T20:17:04.843

这对我在 Ubuntu 16.04 下的 phpmyadmin 有效：

我编辑了 /etc/phpmyadmin/config.inc.php 并更改了以下两行：

```
$cfg['Servers'][$i]['controluser'] = 'root'; 
$cfg['Servers'][$i]['controlpass'] = 'thepasswordgiventoroot'; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-26T17:09:53.143

在 Ubuntu 上。

Ben 的消息很接近，但问题不是 root 密码，我发现的问题是我在安装 phpmyadmin 数据库时为其创建了密码。ubuntu 安装时不会携带此密码，因此变量 $dbpass=''; 在数据库设置文件中是空的而不是你设置的密码。

1.  要在命令行登录 mysql 时检查您是否有正确的密码，请使用以下命令： mysql -u phpmyadmin -p 尝试使用空白密码 我发现访问被拒绝，请使用您在安装期间设置的密码再次输入命令。如果它登录你现在知道密码是什么。
2.  编辑**/etc/phpadmin/config-db.php**并更改**$dbpass='';** to **$dbpass='你的密码';** 并保存文件。
3.  编辑**/etc/dbconfig-common/phpmyadmin.conf**更改**dbc_dbpass=''** ; to **dbc_dbpass='你的密码';** 并保存文件。关闭浏览器并重新加载，您现在会发现消息已经消失。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-07-04T22:25:08.650

“为了让我再次工作，我只是删除了文件

ib_logfile0 和

ib_logfile1 。

从 ：

/应用程序/MAMP/db/mysql56/ib_logfile0“

在 XAMPP 上，它的 Xampp/xamppfiles/var/mysql

从[PHP 警告：mysqli_connect(): (HY000/2002): Connection denied](https://stackoverflow.com/questions/27905049/php-warning-mysqli-connect-hy000-2002-connection-refused)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-29T11:10:27.423

在 ubuntu 上`/etc/phpmyadmin/config-db.php`

确保密码与控制用户的 config.inc.php 匹配

也适用于河豚太短的错误

`edit /var/lib/phpmyadmin/blowfish_secret.inc.php`并使密钥更长

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-25T17:25:24.703

这对我在 Ubuntu 16.04 下的 phpmyadmin 有效：

我编辑`/etc/phpmyadmin/config.inc.php`并更改了以下两行：

```
$cfg['Servers'][$i]['controluser'] = 'pma'; 
$cfg['Servers'][$i]['controlpass'] = 'pass pma'; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-12T16:08:29.253

问题是PhpMyAdmin控制用户（通常是：pma）密码与mysql用户：pma（相同用户）密码不匹配。

要修复它， 1\. 在此处为用户 pma 设置所需的密码：

> "C:\xampp\phpMyAdmin\config.inc.php"
> 
> $cfg['Servers'][$i]['controlpass'] = 'your_new_phpmyadmin_pass';
> 
> （应该像第 32 行）

然后进入mysql，以root登录，进入：（我用phpmyadmin进入这里）

> 数据库：mysql »表：用户

编辑用户：pma

从函数列表（左列）中选择“密码”并在右列中设置“your_new_phpmyadmin_pass”，然后点击执行。

重启mysql服务器。

现在消息应该消失了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-12-09T08:39:06.327

我只是简单地对 config.inc.php 文件进行更改。此链接中有密码错误 $cfg['Servers'][$i]['password'] = 'your password'; 现在它完美地工作了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-18T05:25:32.657

在 ubuntu 18.04 上`etc/phpmyadmin/config.inc.php` 评论所有块

可选：高级功能的用户

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-04-23T05:01:55.830

在ubuntu上，这些步骤对我有用......

```
1\. sudo gedit /etc/phpmyadmin/config.inc.php.

2\. uncomment[remove(/)]  following lines :-

    $cfg['Servers'][$i]['AllowNoPassword'] = TRUE;

3\. comment[add(/)] following lines :-     

   //$cfg['Servers'][$i]['controluser'] = $dbuser;
   //$cfg['Servers'][$i]['controlpass'] = $dbpass; 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-12-12T16:14:59.487

今天刚刚安装了 XAMPP，我决定为 mysql 使用不同的默认端口，这太可怕了。确保将这些行添加到 phpMyAdmin `config.inc.php`：

```
$cfg['Servers'][$i]['host'] = 'localhost';

$cfg['Servers'][$i]['port'] = 'port';` 
```

# php - 使用 PHP 加密并使用 SQL Server 解密

> ID：11506228
> 
> 赞同：2
> 
> 时间：2012-07-16T14:15:31.257
> 
> 标签：php, sql-server, database, encryption

我正在做的是在插入新客户时使用 PHP 加密数据。但是稍后我将需要使用 SQL Server 命令解密整个表。但是我遇到了一个问题，我认为 DecryptByKey 只会接受`Varbinary`. 但是，当我使用 PHP 加密时，它不会产生`Varbinary`变量。两种加密算法应该相同。

我究竟做错了什么？

我用来加密的PHP：

```
function fnE($sV, $sS)
{
    return trim(
        base64_encode(
            mcrypt_encrypt(
                MCRYPT_RIJNDAEL_256,
                $sS, $sV,
                MCRYPT_MODE_ECB,
                mcrypt_create_iv(
                    mcrypt_get_iv_size(
                        MCRYPT_RIJNDAEL_256,
                        MCRYPT_MODE_ECB
                    ),
                MCRYPT_RAND)
            )
        )
    );
} 
```

这会将“James”转换为“/mucJj8Znec7aygh3ly2DI45bSxyv6vG4dzFz4SVVHk=”，它被插入到名为“customer_details”的表中，列名为“first_name”。

然后在 SQL Server 中，我创建了一个主密钥，其密码与我在 PHP 中使用的密码相同。

然后我做：

```
Create Symmetric Key AdvSym
With Algorithm =AES_256
Encryption by Certificate AdvCert
GO 
```

但每当我尝试解密时，它只会显示 NULL：

```
Select first_name,
Convert(Varchar(100), DecryptByKey(first_name)) as DecryptedName from customer_details
go 
```

编辑：应该知道我在仅使用 SQL 时加密和解密是成功的。但是我需要能够使用 PHP 加密然后使用 SQL 解密。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T23:26:56.407

您在 sql 和应用程序中使用相同的凭据吗？

SQL 文档指出，当不允许的数据库用户尝试解密一个值时，即使使用正确的密钥名称和 salt（如果使用），如果数据库用户对所述密钥的视图定义为 false，则结果将返回 null。

我使用的一种解决方法是，如果您不希望您的应用程序用户能够对某个键拥有权限，则在用户定义的多语句表函数中编写选择，并在其中更改使用 'with execute as [ allowedUserhere]。

请记住允许您的应用程序用户“模拟”您的“关键用户”以使其正常工作。

# c++ - 修改子 QWidget 内的父 QWidget

> ID：11506232
> 
> 赞同：1
> 
> 时间：2012-07-16T14:15:48.947
> 
> 标签：c++, qt

我有一个 QWidget B，它包含在 QWidget A 中。QWidget A 有一个 QLabel。我在 QWidget B 中有一些数据，我想将其设置为 QLabel 的值。这样的事情怎么能做到？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:22:53.660

首先，如果我正确理解您的主题，那么您对 ​​A 和 B 有自己的 QWidget 派生。

您的问题的干净解决方案是 B 发出一个信号，例如`newLabelText(QString text);`. 然后，A 提供一个 slot `setLabelText(QString text);`。您将信号连接到插槽，您就完成了。

在该解决方案中，只需一个实体同时知道 A 和 B 即可执行 Signal/Slot-Connection，而 A 和 B 不必相互认识或相互混淆。

# java - 通过 ISAPI 或 URL 重写通过 IIS 公开 Java Web 应用程序

> ID：11506248
> 
> 赞同：2
> 
> 时间：2012-07-16T14:16:42.780
> 
> 标签：java, url, iis, url-rewrite-module, isapi-redirect

我想通过 IIS 公开一个 Java 应用程序。我在[Running a java web application in IIS](https://stackoverflow.com/questions/2256084/running-a-java-web-application-in-iis)中找到了引用[isapi redirector](http://tomcat.apache.org/connectors-doc/reference/iis.html "isapi 重定向器")的答案。然而，似乎对我有用的是设置 IIS URL 重写规则。例如，我设置了一个匹配`^java/(.*)`并将其重写为的重写规则`http://localhost:8080/{R:1}`

我是一名程序员而不是网络服务器管理员，所以我不明白一个与另一个的含义。哪种方法是首选方法，为什么？URL 重写似乎更易于设置，因为它涉及更少的“移动部件”和更少的配置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T22:05:15.730

根据我的经验，当满足以下条件时，我不得不使用 ISAPI 重定向器：

1.  公司/系统策略不允许在服务器上暴露另一个 HTTP 端口（即 8080/tcp），并且 IIS 已经拥有 80/tcp，因此不能将另一个服务器绑定到此或任何 HTTP 端口。在这种情况下，IIS 和 Java 服务器通过 AJP 端口进行通信，并且必须将工作文件配置为仅重定向到 Java 应用程序的上下文。
2.  *[可选]*出于性能原因，静态内容（html、js、css、jpg、...）必须托管在 IIS 上，只有动态内容留给 Java 服务器。这再次要求在每台服务器上进行一些仔细的工作人员配置和内容的选择性部署。

如果您不必满足这些条件中的任何一个，并且如果公司/系统策略不强制所有请求都通过 IIS，那么 URL 重写规则可能是可以的。

# php - 如何在 zend 框架中使用 phpThumb()

> ID：11506262
> 
> 赞同：0
> 
> 时间：2012-07-16T14:17:23.873
> 
> 标签：php, zend-framework, phpthumb

我正在尝试使用我从[http://phpthumb.sourceforge.net](http://phpthumb.sourceforge.net)在 zend 框架中下载的 phpThumb() 我喜欢它生成缩略图和调整大小图像的方式。它使用简单。我只需要添加一个图像标签来生成定义宽度和高度的图像：

```
<img src="phpThumb.php?src=image.jpg&w=100"/> 
```

我想在 zend 框架中使用它。如果有人在 zend 框架中使用它，请告诉我如何使用它。目前我打算将 phpThumb() 库放在公用文件夹中并将其称为

```
<img src="public/phpThumb.php?src=image.jpg&w=100"/> 
```

这是一个好主意吗？我也想知道好不好用？如果有安全漏洞是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:29:37.420

在我的项目中，我将 phpThumb 放在*library/Vendor/PHPThumb 中*，然后使用：

```
$file = 'PATH_TO_FILE';
$thumb = Vendors_PHPThumb_Thumb::create($file);
$thumb->resize($width, $height)->save($file); 
```

这将调整源文件的大小

# php - Trying to understand $_POST and Database

> ID：11506267
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:17:35.577
> 
> 标签：php, database

Here's the html structure:

```
<select name="marke" class="marke">
<option value="1">Bosch</option></select>

<select name="modell" class="modell">
<option value="2">Nocria 14 LBC</option></select> 
```

Here is my Php string (simplified)

```
$modellz = $_POST['marke']. ' ' .$_POST['modell'];
$insertQuery = "INSERT INTO producz (model)
VALUES
('" . $modellz . "')"; 
```

Im trying to get the name inside the `<option>` - tag to Post into the database. But with this code I just get the values. So when i run this i get `1 2` in the database.

But I want `Bosch Nocria 14 LBC`

OBS: I NEED THE VALUE attribute for my jquery selection script.

Please help!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:20:06.187

The `value` of the option is what gets passed to the server, if you want to receive the text within the option instead just remove the `value` attribute altogether:

```
<option>Nocria 14 LBC</option> 
```

Will submit that actual string when its selected.

Other than that, please read up about SQL Injections because your current PHP code is vulnerable to attacks.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:20:40.773

either make value='Bosch' or create an array in your php that converts '1' to the string you require.

This:

```
<select name="marke" class="marke">
<option value="Bosch">Bosch</option></select>

<select name="modell" class="modell">
<option value="Nocria 14 LBC">Nocria 14 LBC</option></select> 
```

or

```
<?
Options = Array();
Options['1'] = "Bosch";
Options["2"] = "Nocria 14 LBC";
?> 
```

and use Options[insert] to get the real value

Also remember to use mysql_real_escape_string or string->real_escape() for security

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:21:17.803

The issue is with the HTML. The `value` for each `<option>` tag is what's sent in the POST request.

Change the HTML to:

```
<select name="marke" class="marke">
<option value="Bosch">Bosch</option></select>

<select name="modell" class="modell">
<option value="Nocria 14 LBC">Nocria 14 LBC</option></select> 
```

and you will see the results you desire.

Also, please validate/sanitize your form-input before saving into the database. If you're using mysql functions, try `mysql_real_escape_string()`.

If jQuery needs access to the original ID for each option, I would suggest one of two methods. Either add a separate attribute to each option, such as rel: `<option value="Bosch" rel="1">Bosch</option>`, or keep your code as-is (`<option value="1">Bosch</option>`) and have PHP aware of the ID/value combinations.

The actual database-structure could, and possibly *should*, modified to support the actual IDs instead of textual values.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T14:21:40.333

That's because you need to set the value of the option to Bosch and Nocria. POST stores what ever the option value to its corresponding `<select>` name. Try this

```
<select name="marke" class="marke">
<option value="Bosch">Bosch</option></select>

<select name="modell" class="modell">
<option value="Nocria 14 LBC">Nocria 14 LBC</option></select> 
```

# java - 在 GlassFish 3.0.1 中集成 ActiveMQ5.6.0 Web 控制台

> ID：11506269
> 
> 赞同：0
> 
> 时间：2012-07-16T14:17:38.837
> 
> 标签：java, glassfish, integration, activemq, glassfish-embedded

大家好，有这样的问题我都喜欢这个教程说 [javadudeTutorial](http://javadude.wordpress.com/2011/07/21/glassfish-v3-1-running-embedded-activemq-for-jms-part-1/)

但我不能在 GlassFish 中部署 web-console.war。堆栈跟踪只说我

没有安装的容器能够处理这个应用程序 com.sun.enterprise.deploy.shared.FileArchive@1b9b6ab5

我做错了什么。我已经通过的所有其他步骤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:35:17.333

答案是删除 web-console.war 中 manifest.mf 中的所有 OSGi 标头。但我真的不明白为什么我应该编辑战争文件以及如何使用 GlassFish 属性修复它......有什么建议吗？

# c++ - C++ 问题中的断言失败

> ID：11506272
> 
> 赞同：0
> 
> 时间：2012-07-16T14:17:54.027
> 
> 标签：c++, assert

我正在处理的一些代码遇到问题。此代码正在基于 linux 的系统上运行，我收到的错误如下：/root/cvswork/pci_sync_card/Code/SSBSupport/src/CRCWbHfChannel/CRCWbHfMSBSimulator.cpp:447: virtual void CCRCWbHfMSBSimulator::Process():断言“pcBasebandOutput”失败。

我尝试单步执行此代码以找出失败的原因，但我似乎无法弄清楚。不幸的是，我有太多文件无法在此处真正共享代码（逐步完成 pcBasebandOutput 分配需要相当长的时间）。我知道这是一个比真正可以问到的更复杂的问题。我的主要问题是：

1.  是我的断言（pcBasebandOutput）；需要的代码行？我只问是因为在 Visual Studio 上运行此代码时，我的程序的结果是可取的。
2.  当它评估我的 pcBasebandOutput 变量时，为什么它会将其评估为假？这是否是说实际上没有为 pcBasebandOutput 分配任何值？或者可以为它分配一个值，但它不是正确的类型（指向两个变量的结构的指针，这两个变量都是双精度的）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:21:28.537

`assert`检查逻辑条件。如果条件为 ，则断言失败`false`。所以写`assert(cond)`在逻辑上和写是一样的：

```
if (!cond)
{
    assert(false);
} 
```

我不建议您`assert`从代码中删除，因为它是一个守卫，告诉您某些事情没有按照预期的方式进行。忽略这一点并不是一个好主意，因为它可能会在以后射你一腿

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:22:51.713

1.  只有你能知道

2.  pcBasebandOutput 的类型是什么？也许它没有正确初始化？

assert 的主要目的是让您的 IDE 在 assert 命中的地方进入调试会话。从那里您可以读取所有变量并查看调用堆栈/线程。其他解决方案（除了使用调试器）是添加大量日志记录，这在线程环境中可能会自行导致问题（日志记录非常慢）。

# html - 如果 GoogleFont 服务不可用，如何加载自托管字体文件？

> ID：11506273
> 
> 赞同：9
> 
> 时间：2012-07-16T14:17:54.310
> 
> 标签：html, css, fonts, typography, google-font-api

我想使用 Google Fonts 目录中的字体集合。我选择了样式并将 CSS`link`标记包含在我的项目模板中。

或者，您也可以使用 Google Fonts 下载该集合，您会得到一个包含所有字体样式的 zip 文件。

我可以创建一个与 Google 让我包含在 HTML 中的 CSS 等效的 CSS，因此如果访问者无法访问 Google 字体 API，我想提供自托管字体文件作为后备。

我该如何设置，并防止下载 Google 字体文件和自托管字体文件？如果用户确实有权访问 Google 字体，则其浏览器不应下载该字体的自托管版本。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T21:56:16.523

我建议只自行托管它们。这是[fontsprings 的](http://www.fontspring.com/blog/the-new-bulletproof-font-face-syntax)“防弹”字体语法。

```
@font-face {
font-family: 'MyFontFamily';
src: url('myfont-webfont.eot?#iefix') format('embedded-opentype'), 
     url('myfont-webfont.woff') format('woff'), 
     url('myfont-webfont.ttf')  format('truetype'),
     url('myfont-webfont.svg#svgFontName') format('svg');
} 
```

拥有所有这四个集合将确保它可以跨浏览器工作。只需确保所有四种类型的字体都有。[Font Squirrel](http://www.fontsquirrel.com/fontface)也有很棒的字体工具包。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-16T14:52:14.073

您有 3 个选项：

1.  使用 2 组`@font-face`at 规则，使用不同的`font-family`名称（例如`"Droid Sans"`和`"Droid Sans Local"`），然后使用像`"Droid Sans", "Droid Sans Local", Helvetica, Arial, sans-serif`. 但是，这将导致两种字体都被下载，从而增加加载时间。
2.  使用一组`@font-face`at 规则，但使用 2 组`src`属性。如果浏览器决定下载所有指定的字体文件，这也可能会增加加载时间。
3.  像大多数 CDN 一样，通过 DNS 在网络层进行镜像。这需要网络设置，但您的 CSS 将保持不变，并且对浏览器最透明，无需额外下载。

Google Web Fonts 已经在使用第 3 个选项，所以如果您已经在使用 CDN 托管的源，我个人不会打扰。但如果您使用来源不太可靠的字体，这可能是值得的。但是，如果您要努力为您的字体设置它，为什么不为您的所有静态资源（图像、样式表、JS 等）设置它呢？最合乎逻辑的做法是获得一个免费或付费的 CDN 来托管您所有的静态资产。

# c++ - 包括具有一个头文件和单独源文件的特定于平台的库

> ID：11506277
> 
> 赞同：3
> 
> 时间：2012-07-16T14:18:02.893
> 
> 标签：c++, static-linking

我正在编写一个独立于平台的套接字库。基本的文件结构是这样的：

```
source directory
|_________________________
|            |            |
v            v            v    
header.hpp   win32        linux
             |            |
             v            v
             source.cpp   source.cpp 
```

头文件包含`#include`跨操作系统通用的任何 s。源文件`#include`平台特定的库。

我已经建立了很多这样的项目，但是我遇到了套接字的问题。因为我正在为函数参数指定默认值，所以需要在头文件`header.h`中使用特定于平台的库，例如、和.`#defines``SOCK_STREAM``AF_INET``SOMAXCONN`

现在，我不想`#ifdef _WIN32`在我的头文件中使用语句，因为我希望所有特定于平台的代码都位于单独文件夹中的源文件中。

我是否基本上被困在岩石和坚硬的地方之间？是否避免`#ifdef #includes`和指定与标头相关的默认参数值是`#defines`互斥的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:28:16.983

您可以使用通常无效的其他默认值。然后，您的平台特定代码可以检测到这个特殊的默认值，并将该值替换为您实际希望它表示的值。

```
/* header */
int mysocket (int domain = -1, int type = -1, int protocol = 0);

/* implementation */
int mysocket (int domain, int type, int protocol) {
    if (domain == -1) domain = AF_INET;
    if (type == -1) type = SOCK_STREAM;
    // ...wrapper specific stuff for the platform...
    return ::socket(d, t, p);
} 
```

另一种可能性是在原型中遗漏参数。

```
/* header */
int mysocket ();
int mysocket (int domain);
int mysocket (int domain, int type);
int mysocket (int domain, int type, int protocol);

/* implementation */
int mysocket () { return mysocket(AF_INET, SOCK_STREAM, 0); }
int mysocket (int d) { retrun mysocket(d, SOCK_STREAM, 0); }
int mysocket (int d, int t) { return mysocket(d, t, 0); }
int mysocket (int d, int t, int p) {
    // ...wrapper specific stuff for the platform...
    return ::socket(d, t, p);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:40:16.427

您可以通过在独立于平台的标头中声明并在特定于平台的 .cpp 文件中适当定义的函数检索默认参数来获取默认参数。

或者，您也可以在独立于平台的标头中将它们声明为 extern const，并在特定于平台的 .cpp 中适当地定义它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:05:30.103

在您的库中添加一个抽象层，该层被转换为平台本机类型。

```
namespace MySocketLibrary
{
    enum SocketType
    {
        StreamSocket,
        DataGramSocket,
        RawSocket,
        // etc.
    }
} 
```

对于我的平台特定`Win32`实现，然后：

```
int translate_socket_type(const MySocketLibrary::SocketType socket)
{
    switch(socket)
    {
        case  MySocketLibrary::StreamSocket:
            return 1;
        // etc.
    }
} 
```

许多图书馆（如`boost::asio`）都这样做。

# html - html 4.1 动作属性

> ID：11506279
> 
> 赞同：0
> 
> 时间：2012-07-16T14:18:11.237
> 
> 标签：html, forms, post, get, action

任何人都可以向我解释一下操作属性是否会获取本地磁盘文件并使用 get 和 post 方法来发送和检索数据。我想要解释和例子。

请并感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:29:58.667

尝试阅读更多关于 HTML 表单的内容并制作一些教程，操作类似于您要将表单信息发送到的“链接”。然后，该“链接”可以询问已通过表单字段传递给它的信息。

在 google 中搜索返回了很多不错的起点：

[http://www.w3schools.com/html/html_forms.asp](http://www.w3schools.com/html/html_forms.asp)

[http://www.tizag.com/htmlT/forms.php/](http://www.tizag.com/htmlT/forms.php/)

我给的第一个链接说：

> 数据被发送到表单的 action 属性中指定的页面。action 属性中定义的文件通常对接收到的输入做一些事情

第二个说：

> HTML 表单元素依赖于动作和方法属性来识别将表单数据发送到哪里进行处理（动作）以及如何处理数据（方法）

这是一个很好的开始。试一试，阅读更多内容，如果您仍然遇到问题，请回来寻求更多帮助。

# sql - wordpress：通过 post_title 清理帖子、术语、关系、分类（和其他关联）的 SQL

> ID：11506281
> 
> 赞同：3
> 
> 时间：2012-07-16T14:18:19.720
> 
> 标签：sql, wordpress, taxonomy, posts

我需要一个 SQL 来通过 post_title 清理我的 wordpress 数据库。

例如，以下内容从 wordpress 中查找标题中包含单词“apple”的所有帖子：

```
SELECT * FROM wp_posts WHERE post_title LIKE '%apples%'; 
```

这会删除那些相同的帖子：

```
DELETE FROM wp_posts WHERE post_title LIKE '%apples%'; 
```

但是，我不确定如何按标题删除其他表中的所有引用，因为我不知道它们与 wp_posts 表有何关系。我认为您可以在删除包含“apple”的帖子后通过以下方式从 postmeta 中删除与帖子相关的行：

```
DELETE FROM wp_postmeta WHERE NOT EXISTS (SELECT * FROM wp_posts WHERE wp_postmeta.post_id = wp_posts.ID) 
```

这应该有效，因为在初始 SQL 命令之后，您现在在 wp_postmeta 中有与 wp_posts 表没有关系的行并删除了所述行。简单的。

但我不确定如何删除类别和标签引用，因为我不确定 wp_posts 和 wp_terms、wp_term_relationships 或 wp_term_taxonomy 之间的关系（除了可能受第一个查询影响的任何其他表）。

有人可以在这里帮助我吗？

谢谢大家的考虑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T23:02:05.920

如果您的数据库支持级联，请使用它。您提出的 DELETE SQL 或类似的东西是最后的东西。保存连接数据的列名不共享名称是很常见的；其他表中没有 tablename.post_id 不足为奇。

# c# - zxing C# 没有条形码时性能变慢

> ID：11506287
> 
> 赞同：0
> 
> 时间：2012-07-16T14:18:47.060
> 
> 标签：c#, barcode, zxing

我将条形码用于扫描应用程序。所有扫描的页面都需要检查条形码。由于条形码总是在同一个位置，我可以裁剪该区域以加快处理速度。问题是，只有一些扫描的页面中有条形码。其他人没有。

*   在带有条形码的页面上搜索条形码大约需要 1-3 秒。
*   在没有条形码的页面上搜索条形码大约需要 10 秒

现在条形码应该很容易在有条形码的那些页面上找到，因为这些页面只包含这个 Code128，否则就是一张普通的白皮书。我可以设置任何选项来加快该过程吗？TryHarder-Flag 已经设置为 false，顺便说一句。

有人有想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:44:16.007

看起来您的图书馆正在查看整个图像以查找条形码，如果没有，则需要很长时间 - 因为它会遍历整个图像（线性复杂性）。另一方面，如果它找到一个（并且应该向下几行/列） - 它可能会使用一条或多条水平线来提取条形码数据，这在这些情况下会非常快。

为了加快您的应用程序的速度，我建议您首先尝试自己检测条形码，如果检测到，请将其传递给 zxing。您可以通过检查图像中间行的像素值来做到这一点，如果没有发现“像黑色”像素，则假设没有条形码。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T04:55:18.843

除了 ananthonline 提供的解决方案外，您还可以尝试以下方法来加快处理速度：

1.  像你已经完成的那样裁剪该区域。
2.  由于页面仅包含 Code128，您可以在代码中指定条形码类型。否则，zxing 将检查并验证所有支持的条形码类型，这会大大降低性能。

# .net - 使用 NPOI (1.2.5.0) 删除 Excel 工作表的列

> ID：11506288
> 
> 赞同：1
> 
> 时间：2012-07-16T14:18:48.037
> 
> 标签：.net, excel, npoi

我正在尝试查找一列并将其删除，但我不知道删除一列的方法是什么。

我尝试删除单元格，代码如下。但我想删除完整的列。

```
HSSFRow row = (HSSFRow)Sheet.GetRow(r);
HSSFCell newCell = (HSSFCell)row.GetCell(nIndex);
row.RemoveCell(newCell); 
```

上面的代码只是清除单元格的内容。不要删除单元格。我现在循环所有行以清除特定列的所有单元格。

现在，我正在搜索一种叫做列移位的东西，但似乎没有办法解决这个问题。请让我知道是否有用于列移位的 NPOI 方法。

.net Framework-3.5 VS 2008 NPOI(1.2.5.0)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T04:37:11.160

现在我只能想到一种方法：清除列并从其他列复制值。因此该列不会被删除，而是向右移动（到其他空列）。我不知道它如何与公式一起使用，但对于简单的文本或数字应该没问题。
示例代码：

```
FileStream fs = new FileStream(filePaths[i], FileMode.Open, FileAccess.ReadWrite);
HSSFWorkbook templateWorkbook = new HSSFWorkbook(fs, true);
ISheet sheet = templateWorkbook.GetSheet("Input");
for (int h = 0; h <= sheet.LastRowNum; h++)
{
    IRow row = sheet.GetRow(h);
    row.RemoveCell(row.GetCell(cellIndex)); //Remove cell value
    row.Cells[cellIndex].SetCellValue(row.Cells[cellIndex + 1].StringCellValue); //Copy right column values to left
} 
```

# google-analytics - Google Analytics 目标 URL，仅记录用户第一次点击该页面

> ID：11506289
> 
> 赞同：0
> 
> 时间：2012-07-16T14:18:51.020
> 
> 标签：google-analytics

在我们的用户注册过程中，每次用户完成 4 个步骤并登陆其个人用户主页 ( `/publications\/.*`) 时，都会定义转换。RegEx 运行正常，但是我意识到，每次用户重新登录并第二次、第三次访问同一页面等时，GA 都会记录一次“转换”，因为该页面只是每个用户的“家”返回登录页面。

有没有办法强制 GA 仅在用户第一次点击该页面时识别访问？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:46:20.680

不，您最好在该过程完成时创建一个新网址，或者在用户完成注册后触发[虚拟网页浏览。](https://developers.google.com/analytics/devguides/collection/gajs/asyncMigrationExamples#VirtualPageviews)

您还可以将流程的第一步标记为必需步骤。您创建一个 URL 目标，但将注册表单添加为必需的步骤。这个 setp 的问题是它只适用于漏斗视图。总转化次数仍会计算所有转化次数，但当您查看漏斗视图时，您只会看到完成所需第一步的转化次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:53:09.253

我可以想到几种方法：

1.  成功注册时记录的 Eduardo 的虚拟网页浏览量将是我的第一推荐。此综合浏览量将成为您的目标转换 URL，并将处理屡犯者。
2.  为您的注册用户设置一个 cookie，并让其确定转化跟踪。

# actionscript-3 - 从 Flash AS3 迁移到 AIR

> ID：11506292
> 
> 赞同：0
> 
> 时间：2012-07-16T14:18:58.880
> 
> 标签：actionscript-3, air, migrate

我一直在用 AS3 开发一个项目，但决定改用 AIR，因为我发现在没有提示出现的情况下无法将文件保存在用户的硬盘上。我的问题是，我必须期待哪些变化？代码是用相同的 AS3 语法/样式编写的吗？在 AIR 中实例化对象/绘制形状/定位系统/舞台是否发生了变化？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:41:31.363

从代码的角度来看，一切都是一样的，除了 AIR SDK 包含大量限制较少且面向应用程序开发的新 API，因为部署目标不再是 Web 浏览器。

如果可以的话，您应该花一两天时间通读[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html)，这样您就会知道您可以使用什么。确保在下面选择最新版本的 AIR 和 Flash Player，`Packages and Class Filters: Runtimes`以便文档中包含您需要的内容。

# sql - 使用 PK 反馈循环复制行

> ID：11506294
> 
> 赞同：3
> 
> 时间：2012-07-16T14:19:10.710
> 
> 标签：sql, sql-server-2005

鉴于以下（表1）：

```
Id    Field1  Field2     ...
--    ------  -------
NULL  1        2
NULL  3        4
... 
```

我想将 Field1 和 Field2 的值插入到不同的表（Table2）中。Table2 有一个自增整数主键。我想从 Table2 中检索新的 PK 并更新上面的 Id 列（Table1）。

我意识到这不是传统的 - 这不是我需要定期做的事情，只是一次性完成一些迁移工作。我做了一些尝试使用`INSERT INTO, OUTPUT, INSERTED.Id`，但失败了。“环回”到 Table1 中的 PK 必须与插入的 Field1/Filed2 的值相关联。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:35:39.277

您应该能够进行插入，然后删除并重新插入。

```
create table t1
( id int, f1 int, f2 int);

create table t2
( id int primary key IDENTITY , f1 int, f2 int);

insert into t1 (id, f1, f2) values (null, 1, 2);    
insert into t1 (id, f1, f2) values (null, 3, 4);
insert into t1 (id, f1, f2) values (null, 5, 6);
insert into t1 (id, f1, f2) values (null, 5, 6);

insert into t2 (f1, f2) 
select f1, f2 from t1 where id is null;

delete t1 
  from t1 join t2 on (t1.f1 = t2.f1 and t1.f2 = t2.f2);

insert into t1
select id, f1, f2 from t2;

select * from t1; 
```

请参阅[SQLFiddle](http://sqlfiddle.com/#!3/2e630/1)上的此示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:51:12.423

您将需要某种类型的唯一键来匹配每个表中的行。我冒昧地将 TempGuid 列添加到您的每个表（您以后可以删除）：

```
-- Setup test data
declare @Table1 table (
      Id int null
    , Field1 int not null
    , Field2 int not null
    , TempGuid uniqueidentifier not null unique
)
insert into @Table1 (Field1, Field2, TempGuid) select 1, 2, newid()
insert into @Table1 (Field1, Field2, TempGuid) select 3, 4, newid()

declare @Table2 table (
      Id int not null primary key identity(1, 1)
    , Field1 int not null
    , Field2 int not null
    , TempGuid uniqueidentifier not null unique
)

-- Fill Table2
insert into @Table2 (Field1, Field2, TempGuid)
select Field1, Field2, TempGuid
from @Table1

-- Update Table1 with the identity values from Table2
update a
set a.Id = b.Id
from @Table1 a
    join @Table2 b on a.TempGuid = b.TempGuid

-- Show results
select * from @Table1 
```

`Output`如果您在 Table1 上已经有一个要插入 Table2 的唯一键，那将是可行的。您还可以在循环或游标中执行临时唯一键（可能再次使用 GUID）并一次处理一行，但这对我来说似乎更糟。

**更新**

这是在您的表上运行的实际 SQL：

```
-- Add TempGuid columns
alter table Table1 add TempGuid uniqueidentifier null
update Table1 set TempGuid = newid()
alter table Table2 add TempGuid uniqueidentifier not null

-- Fill Table2
insert into Table2 (Field1, Field2, TempGuid)
select Field1, Field2, TempGuid
from Table1

-- Update Table1 with the identity values from Table2
update a
set a.Id = b.Id
from Table1 a
    join Table2 b on a.TempGuid = b.TempGuid

-- Remove TempGuid columns
alter table Table1 drop column TempGuid
alter table Table2 drop column TempGuid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:33:21.370

假设您可以完全控制架构定义，请`Table2`向该引用`Table1`的主键添加一个外键。
执行数据插入：

```
INSERT INTO Table2 (Field1, Field2, T1PK)
SELECT Field1, Field2, PK FROM Table1 
```

然后回填Table1：

```
UPDATE t1 SET Id = t2.PK
FROM Table1 t1 INNER JOIN Table2 t2 ON t2.T1PK = t1.PK 
```

然后从 中删除多余的列 ( `T1PK`) `Table2`。

编辑：

由于 中没有 PK `Table1`，因此只需在 中添加一个`Table1`，使用它，然后将其放在最后。

例如...

```
ALTER TABLE Table1 ADD COLUMN T1PK UNIQUEIDENTIFIER CONSTRAINT Table1_PK PRIMARY KEY DEFAULT NEWID();

ALTER TABLE Table2 ADD COLUMN T1PK UNIQUEIDENTIFIER NULL

INSERT INTO Table2 (Field1, Field2, T1PK)
SELECT Field1, Field2, T1PK FROM Table1

UPDATE t1 SET Id = t2.PK
FROM Table1 t1 INNER JOIN Table2 t2 ON t2.T1PK = t1.T1PK

ALTER TABLE Table1 DROP CONSTRAINT Table1_PK

ALTER TABLE Table1 DROP COLUMN T1PK

ALTER TABLE Table2 DROP COLUMN T1PK 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:04:59.193

这并不漂亮，但应该一次性完成。

```
create table tableA
(
id int,
field1 int,
field2 int
)

create table tableB
(
id int identity(1,1),
field1 int,
field2 int
)

insert into tableA select NULL, 1, 2
insert into tableA select NULL, 2, 3

declare @field1_value int;
declare @field2_value int;
declare @lastInsertedId int;

DECLARE tableA_cursor CURSOR FOR 
    select field1, field2 from tableA

    OPEN tableA_cursor
    FETCH NEXT FROM tableA_cursor INTO @field1_value, @field2_value 

    WHILE @@FETCH_STATUS = 0
    BEGIN

        insert into tableB select @field1_value, @field2_value
        set @lastInsertedId = (SELECT SCOPE_IDENTITY())
        update a
            set id = @lastInsertedId
            from tableA a
        where field1 = @field1_value
            and field2 = @field2_value
    print @field1_value

    FETCH NEXT FROM tableA_cursor 
    INTO @field1_value, @field2_value
    END
CLOSE tableA_cursor
DEALLOCATE tableA_cursor 
```

不存在检查：

```
declare @field1_value int;
declare @field2_value int;
declare @lastInsertedId int;

DECLARE tableA_cursor CURSOR FOR 
    select field1, field2 from tableA

    OPEN tableA_cursor
    FETCH NEXT FROM tableA_cursor INTO @field1_value, @field2_value 

    WHILE @@FETCH_STATUS = 0
    BEGIN

        IF NOT EXISTS    
            (
                select * from tableB 
                where field1 = @field1_value 
                and field2 = @field2_value   
            )    
            BEGIN
                insert into tableB 
                select @field1_value, @field2_value

                set @lastInsertedId = (SELECT SCOPE_IDENTITY())

                update a
                    set id = @lastInsertedId
                    from tableA a
                where field1 = @field1_value
                    and field2 = @field2_value
            END     

    FETCH NEXT FROM tableA_cursor 
    INTO @field1_value, @field2_value
    END
CLOSE tableA_cursor
DEALLOCATE tableA_cursor 
```

# wix - 用于用户名和密码的 WiX 标准 UI

> ID：11506299
> 
> 赞同：1
> 
> 时间：2012-07-16T14:19:20.407
> 
> 标签：wix, wix3.6, bootstrapper, burn

我正在为将使用 Burn 构建的新引导程序进行概念验证。到目前为止，我已经设法让一切正常工作。老实说，它比预期的要好。

我唯一无法确定的是如何在 WiX UI 中构建以请求服务用户名和密码，然后将其发送到适当的 MSI。有什么内置的东西可以做到这一点吗？

在一个更普遍的问题中，是否有任何很好的资源可以帮助您开始或充分利用 Burn？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T10:24:34.077

我知道这是一个老问题 - 但如果有人来这里寻找，这是一种将信息传递给您的 MSI 的方法。您可以在捆绑包中设置 MsiPackage 的 MsiProperty，然后用于`Engine.StringVariables`设置/获取它们。例如：

```
<MsiPackage Id="PackageID" SourceFile="C:\Location...\Package.msi" DownloadUrl="https://downloadurl/Package.msi">
   <MsiProperty Name="MyProperty" Value="[MyProperty]"/>
</MsiPackage> 
```

# windows-7 - 无法使用 SHGetFileInfo 获取“我的电脑”特殊文件夹的图标

> ID：11506301
> 
> 赞同：0
> 
> 时间：2012-07-16T14:19:26.357
> 
> 标签：windows-7, .net-2.0, pinvoke

我`SHGetFileInfo`用来获取文件夹图标。一切正常，除非`SHGetFileInfo`在“我的电脑”特殊文件夹 - CLSID 上调用`::{20D04FE0-3AEA-1069-A2D8-08002B30309D}`。对于这种特殊情况，调用结构后`SHGetFileInfo`的值为零。`SHFILEINFO.hIcon`这发生在 Windows 7 上。早期在 WinXP 上代码运行良好。

我用来调用的标志`SHGetFileInfo`是`SHGFI_ICON`and `SHGFI_SMALLICON`，所以没什么特别的。

这可能是什么原因？如何在 Windows 7 上获得“我的电脑”图标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T11:06:51.543

我决定直接从（图标索引 15）使用`ExtractIconEx`和读取图标。与 Win API 不同，图标列表似乎没有改变 :)`MyComputer``shell32.dll`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T12:33:49.260

您必须首先使用 SHGetSpecialFolderLocation 获取“我的电脑”的 PIDL，然后将此 PIDL 作为 SHGetFileInfo 的第一个参数传递。

```
IntPtr pidl;
SHGetSpecialFolderLocation(0, CSIDL_DRIVES, pidl);
SHGetFileInfo(pidl, 0, shinfo, Marshal.SizeOf(shinfo), (SHGFI_PIDL | SHGFI_DISPLAYNAME | SHGFI_ICON | SHGFI_SMALLICON)); 
```

# javascript - 如何获取接近另一种颜色的颜色的 rgb 值？

> ID：11506302
> 
> 赞同：1
> 
> 时间：2012-07-16T14:19:30.897
> 
> 标签：javascript, html, canvas, colors, rgb

如果我有 RGB 中的颜色。如何创建一个 JavaScript 函数，当另一个 RGB 值接近初始 RGB 时返回 true，否则返回 false？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:33:08.960

我已经使用了它，它对我来说效果很好：

```
// assuming that color1 and color2 are objects with r, g and b properties
// and tolerance is the "distance" of colors in range 0-255
function isNeighborColor(color1, color2, tolerance) {
    if(tolerance == undefined) {
        tolerance = 32;
    }

    return Math.abs(color1.r - color2.r) <= tolerance
        && Math.abs(color1.g - color2.g) <= tolerance
        && Math.abs(color1.b - color2.b) <= tolerance;
} 
```

并且根据您的特定问题，颜色距离的含义可能会有所不同，例如，在您的情况下，您可能需要更改`&&`为`||`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:35:33.270

这一切都取决于对您来说“接近”意味着什么。您可以制作如下功能：

```
var color1 = { "r": 255, "g": 255, "b": 255 }
var color2 = { "r": 250, "g": 252, "b": 252 }

function isClose(color1, color2) {
    var threshold = 30;
    var distance = Math.abs(color1.r - color2.r) + Math.abs(color1.g - color2.g) + Math.abs(color1.b - color2.b);

    if (distance < threshold) return true;
    return false;
} 
```

这将匹配*非常*接近的颜色（基于简单的 rgb 矢量距离），但仍然存在必须通过实验选择的*阈值参数。*

# c++ - 参考VC++代码还是转换成DLL？

> ID：11506307
> 
> 赞同：1
> 
> 时间：2012-07-16T14:19:50.763
> 
> 标签：c++, visual-c++, microsoft-metro

我正在编写一个新的应用程序，它引用了一个我有解决方案和项目的 VC++ 库。我正在使用的 Visual Studio 版本（Microsoft Visual Studio Express 2012 RC for Windows 8）不允许我在新项目中包含 VC++ 库，所以以某种方式将旧的 VC++ 库转换为 DLL 或手动对我来说更好吗？将我所有的库类包含到我的新项目中。

最佳实践是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:24:09.247

我认为您误认为新项目不支持旧库。你为什么这么认为？
但如果真的是这样，最好还是创建一个动态库并将其添加到项目依赖项中。然后简单地调用所需的函数

# css - 使用 XPATH 和 CSS 设置特定元素的样式

> ID：11506309
> 
> 赞同：2
> 
> 时间：2012-07-16T14:19:54.837
> 
> 标签：css, xpath

我想针对以下项目：

```
/html/body/div[2]/div/div[5]/div/table/tbody/tr[2]/td[2]/img 
```

我怎样才能准确地设计这个？

目前我有这个css，它似乎将样式应用于`img`div中的所有内容

```
div.PageHeaderDescription img {
    border-radius: 7px 7px 7px 7px;
    bottom: 10px;
    float: none;
    height: auto;
    margin-right: 10px;
    position: relative;
    right: -230px;
    width: 614px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:57:38.550

您可以使用

```
div.PageHeaderDescription img:first-child {
border-radius: 7px 7px 7px 7px;
bottom: 10px;
float: none;
height: auto;
margin-right: 10px;
position: relative;
right: -230px;
width: 614px; 
```

仅访问第一张图片或

```
 div.PageHeaderDescription > img {
border-radius: 7px 7px 7px 7px;
bottom: 10px;
float: none;
height: auto;
margin-right: 10px;
position: relative;
right: -230px;
width: 614px; 
```

仅访问 PageHeaderDescription div 中的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:55:55.960

`nth-child`您可以使用伪类指定特定的子节点。

```
div.PageHeaderDescription div table tbody tr:nth-child(2) td:nth-child(2) img 
```

[nth-child MDN 参考](https://developer.mozilla.org/en/CSS/%3anth-child)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:54:59.113

用这个

```
div.PageHeaderDescription div table tbody tr td > img
{
border-radius: 7px 7px 7px 7px;
bottom: 10px;
float: none;
height: auto;
margin-right: 10px;
position: relative;
right: -230px;
width: 614px;
} 
```

这仅适用于 td 内的图像

> 符号用于指定直接后代

[http://www.456bereastreet.com/archive/200510/css_21_selectors_part_2/](http://www.456bereastreet.com/archive/200510/css_21_selectors_part_2/)

它在现代浏览器中也有很好的支持:-)

# sql-server - 动态 SQL 和字段名称数组中的对象名称 #temp 无效

> ID：11506314
> 
> 赞同：0
> 
> 时间：2012-07-16T14:20:12.840
> 
> 标签：sql-server, arrays, temp

我在两个单独的存储过程中使用#temp 表。在一种情况下，它工作正常，而在另一种情况下，它给出错误“无效的对象名称#temp”。

第一种情况：

```
SELECT SubsID,
       SubsName,
       AbbrName
INTO   #TEMP
FROM   SubsList
WHERE  CAST (SubsID AS VARCHAR(10)) LIKE '%' + @intRight + '%'
        OR SubsName LIKE '%' + @intRight + '%' 
```

  它工作正常。

为了使这个 SQL 更加动态，我使用 QUOTENAME 并进行了以下更改： 1.我将 @ColName、@sourceName、@intField 和 @txtField 的数据类型设置为 sysname。2.事实上，我删除了参数@tableName as sysname（值：#temp 已传递给它），因为它在Select and Drop SQL 中给出了错误。3.我在@ColName 中传递一个字段名称。当我传递所有三个字段名称时，它给出了错误。4.我声明@cmd nvarchar(max) 并将SQL分配给它执行。

```
SET @cmd = N'Select ' + QUOTENAME(@ColName) + 
           N' INTO #temp from ' + QUOTENAME(@sourceName) + 
           N' where CAST(' + QUOTENAME(@intField) + N' AS VARCHAR(10)) like ''%' + @strVal + 
           N'%'' or ' + QUOTENAME(@txtField) + ' like ''%' + @strVal + N'%''' --working
EXEC sp_executesql @cmd;

SELECT *
FROM   #temp;

DROP TABLE #temp; 
```

我将 EXEC sp_executesql @cmd 更改为 EXEC(@cmd) 但错误仍然存​​在。

我收到无效对象名称的错误，但如果我将 #temp 更改为 ##temp，则不会出现此错误。

我的第一个问题：如果使用#temp，这个错误可能是什么原因？第二个问题：如何制作字段名称数组并将其传递给存储过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:27:44.987

exec 完成后临时表超出范围。“exec”或“sp_executesql”在自己的范围内运行。因此，一旦执行结束，像临时表和变量这样创建的任何东西都会被破坏或超出范围。想想这些就像存储的过程。

要解决这个问题。在主代码中创建临时表..然后使用动态 sql 插入其中，然后在主代码中读取它。

# android - findviewbyid 不工作

> ID：11506317
> 
> 赞同：0
> 
> 时间：2012-07-16T14:20:18.627
> 
> 标签：android, findviewbyid

Eclipse 无法识别 R.id。我刚开始学习Android，所以请在这里帮助我。

```
 import android.app.Activity;
 import android.os.Bundle;
 import android.widget.EditText;

 public class SecondappActivity extends Activity {

     EditText ed;
     /** Called when the activity is first created. */
     @Override
     public void onCreate(Bundle savedInstanceState) {

         super.onCreate(savedInstanceState);
         setContentView(R.layout.main);
         ed=(EditText) findViewById(R.id.b1);
    }
} 
```

它是说*id 无法解析或不是字段*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:23:45.507

检查您的 xml 文件并确保它没有任何错误。看起来生成 R 文件有问题。它可能是由 xml 中的错误引起的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:26:29.703

检查您的 xml 文件或 res 文件夹中的任何错误。清理并重建项目。它会工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:38:02.790

放

```
import YourWholePackage.R; 
```

在进口环节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T14:22:51.743

您的 main.xml 文件是什么样的？你的java代码没有问题。假设你所有的进口都在工作。bn1 可能不在该布局中。或者您没有在您的 android:id 字段中添加“+”以确保它进入 R.java 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-18T20:04:03.893

我有同样的问题：/我刚刚进入 android 开发并且已经卡住了。这是我的代码：

```
class MainActivity : AppCompatActivity() {
  override fun onCreate(savedInstanceState: Bundle?) {
     super.onCreate(savedInstanceState)
     setContentView(R.layout.activity_main)
     EditText nameEditText = (EditText) findViewById(R.id.nameEditText)
  }
} 
```

没什么花哨的，只有一个编辑文本字段和一个按钮，activity_main.xml 中没有错误。但是当我输入 findViewById 时 - 它甚至在自动建议列表中都不可用。谢谢

# r - 在 levelplot 上改变色阶范围

> ID：11506319
> 
> 赞同：4
> 
> 时间：2012-07-16T14:20:20.067
> 
> 标签：r, levelplot

我想对图像做一点调整。我生成简单的相关热图的命令如下：

```
psticorr <- cor(psti)
rgb.palette <- colorRampPalette(c("blue", "yellow"), space = "lab")
levelplot(psticorr, col.regions=rgb.palette(120), scales=list(x=list(cex=.3), y=list(cex=.3)), main="PstI: Correlations of loci coverage", xlab="Samples", ylab="Samples" ) 
```

我得到了我需要的东西，但我真的很想设置色阶的范围，例如从 0 到 1，此时它从我的最低相关 (r) 值开始。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T15:18:08.370

`levelplot`您可以使用参数控制颜色断点`at`。尝试类似的东西 `at=seq(min(psticorr), max(psticorr), length.out=120)`

# java - 如何ping一个IP地址

> ID：11506321
> 
> 赞同：85
> 
> 时间：2012-07-16T14:20:29.440
> 
> 标签：java, ping, host

我正在使用这部分代码在java中ping一个ip地址，但只有ping localhost是成功的，对于其他主机，程序说主机无法访问。我禁用了我的防火墙，但仍然有这个问题

```
public static void main(String[] args) throws UnknownHostException, IOException {
    String ipAddress = "127.0.0.1";
    InetAddress inet = InetAddress.getByName(ipAddress);

    System.out.println("Sending Ping Request to " + ipAddress);
    System.out.println(inet.isReachable(5000) ? "Host is reachable" : "Host is NOT reachable");

    ipAddress = "173.194.32.38";
    inet = InetAddress.getByName(ipAddress);

    System.out.println("Sending Ping Request to " + ipAddress);
    System.out.println(inet.isReachable(5000) ? "Host is reachable" : "Host is NOT reachable");
} 
```

输出是：

> 向 127.0.0.1
> 主机
> 发送 Ping 请求可达 向 173.194.32.38
> 主机发送 Ping 请求不可达

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-07-16T16:16:38.283

`InetAddress.isReachable()`根据[javadoc](http://docs.oracle.com/javase/7/docs/api/java/net/InetAddress.html#isReachable%28int%29)：

> “.. 如果可以获得特权，典型的实现将使用 ICMP ECHO REQUEST，否则它将尝试在目标主机的端口 7 (Echo) 上建立 TCP 连接..”。

选项 #1 (ICMP) 通常需要管理`(root)`权限。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-04-05T18:26:58.717

我认为这段代码会帮助你：

```
public class PingExample {
    public static void main(String[] args){
        try{
            InetAddress address = InetAddress.getByName("192.168.1.103");
            boolean reachable = address.isReachable(10000);

            System.out.println("Is host reachable? " + reachable);
        } catch (Exception e){
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-07-16T14:51:32.607

检查您的连接性。在我的电脑上，这两个 IP 都打印了 REACHABLE：

> 向 127.0.0.1 发送 Ping 请求
> 主机可达
> 向 173.194.32.38 发送 Ping 请求
> 主机可达

编辑：

您可以尝试修改代码以使用 getByAddress() 来获取地址：

```
public static void main(String[] args) throws UnknownHostException, IOException {
    InetAddress inet;

    inet = InetAddress.getByAddress(new byte[] { 127, 0, 0, 1 });
    System.out.println("Sending Ping Request to " + inet);
    System.out.println(inet.isReachable(5000) ? "Host is reachable" : "Host is NOT reachable");

    inet = InetAddress.getByAddress(new byte[] { (byte) 173, (byte) 194, 32, 38 });
    System.out.println("Sending Ping Request to " + inet);
    System.out.println(inet.isReachable(5000) ? "Host is reachable" : "Host is NOT reachable");
} 
```

getByName() 方法可能会尝试某种在您的机器上可能无法进行的反向 DNS 查找，getByAddress() 可能会绕过它。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-07-16T15:48:29.553

您不能简单地在 Java 中 ping，因为它依赖于 ICMP，遗憾的是 Java 不支持它

[http://mindprod.com/jgloss/ping.html](http://mindprod.com/jgloss/ping.html)

改用套接字

希望能帮助到你

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-08-03T07:05:06.740

您可以使用此方法在 Windows 和其他平台上 ping 主机：

```
private static boolean ping(String host) throws IOException, InterruptedException {
    boolean isWindows = System.getProperty("os.name").toLowerCase().contains("win");

    ProcessBuilder processBuilder = new ProcessBuilder("ping", isWindows? "-n" : "-c", "1", host);
    Process proc = processBuilder.start();

    int returnVal = proc.waitFor();
    return returnVal == 0;
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-01-01T13:27:58.470

它肯定会起作用

```
import java.io.*;
import java.util.*;

public class JavaPingExampleProgram
{

  public static void main(String args[]) 
  throws IOException
  {
    // create the ping command as a list of strings
    JavaPingExampleProgram ping = new JavaPingExampleProgram();
    List<String> commands = new ArrayList<String>();
    commands.add("ping");
    commands.add("-c");
    commands.add("5");
    commands.add("74.125.236.73");
    ping.doCommand(commands);
  }

  public void doCommand(List<String> command) 
  throws IOException
  {
    String s = null;

    ProcessBuilder pb = new ProcessBuilder(command);
    Process process = pb.start();

    BufferedReader stdInput = new BufferedReader(new InputStreamReader(process.getInputStream()));
    BufferedReader stdError = new BufferedReader(new InputStreamReader(process.getErrorStream()));

    // read the output from the command
    System.out.println("Here is the standard output of the command:\n");
    while ((s = stdInput.readLine()) != null)
    {
      System.out.println(s);
    }

    // read any errors from the attempted command
    System.out.println("Here is the standard error of the command (if any):\n");
    while ((s = stdError.readLine()) != null)
    {
      System.out.println(s);
    }
  }

} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-03-06T18:10:56.137

简短的建议：不要使用 isReachable()，调用系统 ping，如上面一些答案中所建议的那样。

长解释：

*   ping 使用 ICMP 网络协议。要使用 ICMP，需要一个“原始套接字”
*   操作系统不允许标准用户使用原始套接字
*   以下适用于fedora 30 linux，windows系统应该类似
*   如果 java 以 root 身份运行，isReachable() 实际上会发送 ICMP ping 请求
*   如果 java 不以 root 身份运行，isReachable() 会尝试连接到 TCP 端口 7，即回显端口。该服务一般不再使用，尝试使用可能会产生不正确的结果
*   对连接请求的任何类型的回答，也是一个拒绝（TCP 标志 RST）从 isReachable() 产生一个“真”
*   一些防火墙会为任何未明确打开的端口发送 RST。如果发生这种情况，您将获得 isReachable() == true 对于甚至不存在的主机
*   进一步尝试为 java 进程分配必要的功能：
*   setcap cap_net_raw+eip *java 可执行文件*（分配使用原始套接字的权利）
*   测试：getcap *java executable* -> 'cap_net_raw+eip'（已分配能力）
*   正在运行的 java 仍然向端口 7 发送 TCP 请求
*   使用 getpcaps *pid*检查正在运行的 java 进程表明正在运行的 java 没有原始套接字功能。显然我的 setcap 已被某些安全机制覆盖
*   随着安全要求的增加，这可能会变得更加受限，除非 sb 实现了一个特别是 ping 的异常（但到目前为止在网上没有发现任何东西）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-05-17T14:20:58.313

只是对其他人给出的内容的补充，即使它们运行良好，但**在某些情况下，如果互联网速度慢或存在一些未知的网络问题，某些代码将无法工作（`isReachable()`）。**但是下面提到的这段代码创建了一个进程，该进程充当 Windows 的命令行 ping (cmd ping)。它在所有情况下都适用于我，经过尝试和测试。

**代码 ：-**

```
public class JavaPingApp {

public static void runSystemCommand(String command) {

    try {
        Process p = Runtime.getRuntime().exec(command);
        BufferedReader inputStream = new BufferedReader(
                new InputStreamReader(p.getInputStream()));

        String s = "";
        // reading output stream of the command
        while ((s = inputStream.readLine()) != null) {
            System.out.println(s);
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
}

public static void main(String[] args) {

    String ip = "stackoverflow.com"; //Any IP Address on your network / Web
    runSystemCommand("ping " + ip);
}
} 
```

希望有帮助，加油！！！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-08-29T09:02:50.283

尽管这不依赖于 Windows 上的 ICMP，但此实现与新的[Duration API配合得很好](https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html)

```
public static Duration ping(String host) {
    Instant startTime = Instant.now();
    try {
        InetAddress address = InetAddress.getByName(host);
        if (address.isReachable(1000)) {
            return Duration.between(startTime, Instant.now());
        }
    } catch (IOException e) {
        // Host not available, nothing to do here
    }
    return Duration.ofDays(1);
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-02-06T08:12:32.320

在带有 oracle-jdk 的 linux 上，OP 提交的代码在非 root 时使用端口 7，在 root 时使用 ICMP。当按照文档说明以 root 身份运行时，它会执行真正的 ICMP 回显请求。

如果您在 MS 机器上运行它，您可能必须以管理员身份运行应用程序才能获得 ICMP 行为。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-08-21T09:21:55.360

我更喜欢这种方式：

```
 /**
     *
     * @param host
     * @return true means ping success,false means ping fail.
     * @throws IOException
     * @throws InterruptedException
     */
    private static boolean ping(String host) throws IOException, InterruptedException {
        boolean isWindows = System.getProperty("os.name").toLowerCase().contains("win");

        ProcessBuilder processBuilder = new ProcessBuilder("ping", isWindows? "-n" : "-c", "1", host);
        Process proc = processBuilder.start();
        return proc.waitFor(200, TimeUnit.MILLISECONDS);
    } 
```

这种方式可以将阻塞时间限制在特定的时间，比如200毫秒。

在 MacOS、Android 和 Windows 上运行良好，应该在 JDK 1.8 中使用。

> 这个想法来自[Mohammad Banisaeid](https://stackoverflow.com/users/671988/mohammad-banisaeid)，但我无法发表评论。（您必须有 50 声望才能发表评论）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-17T18:28:39.550

这是一种 ping IP 地址的方法，该方法应该`Java`适用于系统：`Windows``Unix`

```
import org.apache.commons.lang3.SystemUtils;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class CommandLine
{
    /**
     * @param ipAddress The internet protocol address to ping
     * @return True if the address is responsive, false otherwise
     */
    public static boolean isReachable(String ipAddress) throws IOException
    {
        List<String> command = buildCommand(ipAddress);
        ProcessBuilder processBuilder = new ProcessBuilder(command);
        Process process = processBuilder.start();

        try (BufferedReader standardOutput = new BufferedReader(new InputStreamReader(process.getInputStream())))
        {
            String outputLine;

            while ((outputLine = standardOutput.readLine()) != null)
            {
                // Picks up Windows and Unix unreachable hosts
                if (outputLine.toLowerCase().contains("destination host unreachable"))
                {
                    return false;
                }
            }
        }

        return true;
    }

    private static List<String> buildCommand(String ipAddress)
    {
        List<String> command = new ArrayList<>();
        command.add("ping");

        if (SystemUtils.IS_OS_WINDOWS)
        {
            command.add("-n");
        } else if (SystemUtils.IS_OS_UNIX)
        {
            command.add("-c");
        } else
        {
            throw new UnsupportedOperationException("Unsupported operating system");
        }

        command.add("1");
        command.add(ipAddress);

        return command;
    }
} 
```

确保添加[`Apache Commons Lang`](https://mvnrepository.com/artifact/org.apache.commons/commons-lang3)到您的依赖项。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-09-18T17:34:11.703

我知道以前的条目已经回答了这个问题，但是对于遇到这个问题的其他人，我确实找到了一种不需要在 Windows 中使用“ping”过程然后擦洗输出的方法。

我所做的是使用 JNA 调用 Window 的 IP 帮助程序库来执行 ICMP 回显

查看[我自己对我自己的类似问题的回答](https://stackoverflow.com/a/19383757/2821263)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-03-02T09:56:13.683

InetAddress 并不总是返回正确的值。在本地主机的情况下成功，但对于其他主机，这表明主机无法访问。尝试使用 ping 命令，如下所示。

```
try {
    String cmd = "cmd /C ping -n 1 " + ip + " | find \"TTL\"";        
    Process myProcess = Runtime.getRuntime().exec(cmd);
    myProcess.waitFor();

    if(myProcess.exitValue() == 0) {

    return true;
    }
    else {
        return false;
    }
}
catch (Exception e) {
    e.printStackTrace();
    return false;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-03-27T07:07:48.533

我尝试了几个选项：

1.  Java 网络地址

`InetAddress.getByName(ipAddress)`，尝试几次后，Windows 上的网络开始出现异常

2.  Java HttpURL 连接

    ```
     URL siteURL = new URL(url);
            connection = (HttpURLConnection) siteURL.openConnection();
            connection.setRequestMethod("GET");
            connection.setConnectTimeout(pingTime);
            connection.connect();

            code = connection.getResponseCode();
            if (code == 200) {
                code = 200;
            }. 
    ```

这是可靠的，但有点慢

3.  Windows 批处理文件

我终于决定在我的 Windows 机器上创建一个包含以下内容的批处理文件：`ping.exe -n %echoCount% %pingIp%` 然后我在我的 java 代码中调用了 .bat 文件，使用

```
public int pingBat(Network network) {
ProcessBuilder pb = new ProcessBuilder(pingBatLocation);
Map<String, String> env = pb.environment();

env.put(
        "echoCount", noOfPings + "");
env.put(
        "pingIp", pingIp);
File outputFile = new File(outputFileLocation);
File errorFile = new File(errorFileLocation);

pb.redirectOutput(outputFile);

pb.redirectError(errorFile);

Process process;

try {
    process = pb.start();
    process.waitFor();
    String finalOutput = printFile(outputFile);
    if (finalOutput != null && finalOutput.toLowerCase().contains("reply from")) {
        return 200;
    } else {
        return 202;
    }
} catch (IOException e) {
    log.debug(e.getMessage());
    return 203;
} catch (InterruptedException e) {
    log.debug(e.getMessage());
    return 204;
} 
```

}

事实证明这是最快最可靠的方法

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2017-03-02T01:22:23.490

这应该有效：

```
import java.io.BufferedReader;
import java.io.InputStreamReader;

public class Pinger {

private static String keyWordTolookFor = "average";

public Pinger() {
    // TODO Auto-generated constructor stub
}

 public static void main(String[] args) {
 //Test the ping method on Windows.
 System.out.println(ping("192.168.0.1")); }

public String ping(String IP) {
    try {
        String line;
        Process p = Runtime.getRuntime().exec("ping -n 1 " + IP);
        BufferedReader input = new BufferedReader(new InputStreamReader(p.getInputStream()));
        while (((line = input.readLine()) != null)) {

            if (line.toLowerCase().indexOf(keyWordTolookFor.toLowerCase()) != -1) {

                String delims = "[ ]+";
                String[] tokens = line.split(delims);
                return tokens[tokens.length - 1];
            } 
        }

        input.close();
    } catch (Exception err) {
        err.printStackTrace();
    }
    return "Offline";
} 
```

}

# emacs - 是否有 .emacs 文件可用于使其键绑定的行为与任何现代 IDE 一样？

> ID：11506325
> 
> 赞同：2
> 
> 时间：2012-07-16T14:20:45.803
> 
> 标签：emacs, configuration, key-bindings

我学习了使用 Notepad++、Gedit、Netbeans 等 GUI 编辑器进行编程，因此我习惯了几乎所有这些程序中常见的一些键绑定（以及其他一些程序，如 LO Writer 等）。

有没有什么地方可以找到一个 .emacs 文件让它像那样工作，这样我就可以拥有它的所有功能，而无需花费我一半的时间来学习它的键绑定或配置它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:39:58.240

你可以试试[ErgoMacs](http://ergoemacs.org/)，它是为使 Emacs 现代化而构建的。我没有尝试过，因为当我发现它时，我已经有太多自己的键绑定需要切换，但如果我重新开始，我很确定我会使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T14:27:08.807

[cua-mode](http://www.emacswiki.org/CuaMode)重新映射 emacs 以使用大多数其他程序使用的键绑定。它是内置在 emacs 中的，您可以`.emacs`使用以下命令启用它：

```
(cua-mode t) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:22:52.390

这有点取决于你的意思。有一些方法可以让 Emacs 使用 Windows 中的标准键盘快捷键，例如 ataylor 所指出的。但是，当您说希望它更像*IDE*时，您似乎不仅对文本编辑键绑定感兴趣（例如，移动点、复制和粘贴、标记区域等），而且特别是IDE 提供的功能：编译、代码项目管理、部署、代码重构等。

但是 Emacs 不是 IDE。它是一个文本编辑器。好的，它确实是一个基于文本缓冲区可视模型的 lisp 解释器。

因此，它可以执行 IDE 执行的许多任务，但开箱即用，IDE 可以更好地执行上述许多任务，因为它们是为这些任务而设计的。由于 Emacs 只是一个 lisp 解释器，所以很多人已经以所谓的“模式”的形式编写了对其核心功能的扩展。所以，是的，通过在 vanilla Emacs 上安装正确的模式，您可以使它成为一个非常强大的工具，可以与 IDE 竞争。

但这并不能不*花费我半生的时间来学习它的键绑定或配置它*。好吧，你的半生有点牵强。Emacs 有一个[陡峭的学习曲线](https://unix.stackexchange.com/a/988)，这是真的，但它是值得的——因为它*不是*一个 IDE。不仅如此。

如果你不愿意学习新东西，也许你可能想花点时间重新考虑一下编程是否真的适合你。因为 IT 环境一直在快速变化。也许五年后，Java 将死去，再也没有人使用 Eclipse。但是你可以很确定一件事：Emacs 仍然存在。

好的，最后一段完全是 FUD，所以忽略它。但说真的，学习新的键绑定并不像你想象的那么难。而且也不需要很长时间。您可以在 Emacs 中完全按照自己的喜好重新配置和重新分配，但为什么不给标准键绑定一个机会呢？

# asp.net - 重置我的文本框并不总是有效。怎么修？

> ID：11506326
> 
> 赞同：1
> 
> 时间：2012-07-16T14:20:53.717
> 
> 标签：asp.net, webforms

我正在使用 asp.net 3.5（代码隐藏 c#）。我的用户正在运行 IE 7 或 8。我有一个包含多个`TextBox`es 的数据输入页面。

当我想清除所有`TextBox`es 时，我会执行 sever.transfer 回到同一页面。

**也许 99% 的时间，这会清除`TextBox`es。每隔一段时间它就不会。**

我知道发生了到服务器的往返，因为：

*   页面上的下拉列表和单选按钮列表被重置，并且
*   DB 处理发生，如已保存到 DB 的记录所示。

这种不一致让我感到困惑。

什么可能导致`TextBox`es 以这种方式保存数据，我该如何防止它发生？

这导致用户两次保存相同的数据。

我不认为这与它有任何关系，但是页面上还有各种js函数用于验证，将输入的第一个字母大写等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T08:05:30.407

由于这篇[MSDN 文章描述了 Server.Transfer 方法](http://msdn.microsoft.com/en-us/library/ms525800%28v=vs.90%29.aspx)，这可能不是清空`TextBox`es 的正确方法。该方法显式保留所有状态信息。

[此答案](https://stackoverflow.com/a/10880887/79485https://stackoverflow.com/a/10880887/79485https://stackoverflow.com/a/10880887/79485)中描述了一种更好的方法：

```
foreach (var item in Page.Controls)
        {
            if (item is TextBox)
            {
                ((TextBox)item).Text = "";
            }
        } 
```

您将只保留一次往返，如果您愿意，您可以保留所有其他用户输入。

# c# - 包括不使用实体框架查询

> ID：11506327
> 
> 赞同：6
> 
> 时间：2012-07-16T14:20:59.797
> 
> 标签：c#, entity-framework, eager-loading

我不确定发生了什么变化，但是，在回到几周前我正在处理的应用程序之后，我的`.Include()`电话不再适用于我的一个相关表。奇怪的是它适用于不同的表。这是一些带有注释的代码，显示了我的结果：

```
//Get the order and nothing else.
using (OrderEntity orderContext = new OrderEntity(OrdersConnectionString)) {
    var query = from order in orderContext.ShippingOrders
                where order.ShipperId == shippingId
                select order;

    //I got a value!
    shippingOrder = query.ToList().FirstOrDefault();
}

//Get the line item and nothing else.
using (OrderEntity orderContext = new OrderEntity(OrdersConnectionString)) {
    var query = from orderItem in orderContext.ShippingOrderItems
                where orderItem.ShipperId == shippingId
                select orderItem;

    //I got a value!
    shippingOrderItems = query.ToList();
} 
```

这是我感到困惑的地方：

```
//Get the order *AND* the line item
using (OrderEntity orderContext = new OrderEntity(OrdersConnectionString)) {
    var query = from order in orderContext.ShippingOrders.Include("ShippingOrderItems")
                where order.ShipperId == shippingId
                select order;

    //I get a ShippingOrder result, but no items are returned.  I used the SQL Server Profiler and saw the SQL that got executed; it contains the item, EF just isn't loading the object.
    shippingOrder = query.ToList().FirstOrDefault();
} 
```

我能够取回不同相关表的结果。这让我认为 EF 缺少我的订单和订单项表之间的关系，但是，我不确定如何解决这个问题。

**编辑**：这是订单实体

```
/// <summary>
/// No Metadata Documentation available.
/// </summary>
[EdmEntityTypeAttribute(NamespaceName="OrderModel", Name="ShippingOrder")]
[Serializable()]
[DataContractAttribute(IsReference=true)]
public partial class ShippingOrder : EntityObject
{
    #region Factory Method

    /// <summary>
    /// Create a new ShippingOrder object.
    /// </summary>
    /// <param name="shipperId">Initial value of the ShipperId property.</param>
    public static ShippingOrder CreateShippingOrder(global::System.String shipperId)
    {
        ShippingOrder shippingOrder = new ShippingOrder();
        shippingOrder.ShipperId = shipperId;
        return shippingOrder;
    }

    #endregion
    #region Primitive Properties

    /// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [EdmScalarPropertyAttribute(EntityKeyProperty=true, IsNullable=false)]
    [DataMemberAttribute()]
    public global::System.String ShipperId
    {
        get
        {
            return _ShipperId;
        }
        set
        {
            if (_ShipperId != value)
            {
                OnShipperIdChanging(value);
                ReportPropertyChanging("ShipperId");
                _ShipperId = StructuralObject.SetValidValue(value, false);
                ReportPropertyChanged("ShipperId");
                OnShipperIdChanged();
            }
        }
    }
    private global::System.String _ShipperId;
    partial void OnShipperIdChanging(global::System.String value);
    partial void OnShipperIdChanged();

    /// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=true)]
    [DataMemberAttribute()]
    public global::System.String OrderNumber
    {
        get
        {
            return _OrderNumber;
        }
        set
        {
            OnOrderNumberChanging(value);
            ReportPropertyChanging("OrderNumber");
            _OrderNumber = StructuralObject.SetValidValue(value, true);
            ReportPropertyChanged("OrderNumber");
            OnOrderNumberChanged();
        }
    }
    private global::System.String _OrderNumber;
    partial void OnOrderNumberChanging(global::System.String value);
    partial void OnOrderNumberChanged();

    /// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=true)]
    [DataMemberAttribute()]
    public Nullable<global::System.DateTime> OrderDate
    {
        get
        {
            return _OrderDate;
        }
        set
        {
            OnOrderDateChanging(value);
            ReportPropertyChanging("OrderDate");
            _OrderDate = StructuralObject.SetValidValue(value);
            ReportPropertyChanged("OrderDate");
            OnOrderDateChanged();
        }
    }
    private Nullable<global::System.DateTime> _OrderDate;
    partial void OnOrderDateChanging(Nullable<global::System.DateTime> value);
    partial void OnOrderDateChanged();

    /// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=true)]
    [DataMemberAttribute()]
    public global::System.String CustomsComment
    {
        get
        {
            return _CustomsComment;
        }
        set
        {
            OnCustomsCommentChanging(value);
            ReportPropertyChanging("CustomsComment");
            _CustomsComment = StructuralObject.SetValidValue(value, true);
            ReportPropertyChanged("CustomsComment");
            OnCustomsCommentChanged();
        }
    }
    private global::System.String _CustomsComment;
    partial void OnCustomsCommentChanging(global::System.String value);
    partial void OnCustomsCommentChanged();

    #endregion

    #region Navigation Properties

    /// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [XmlIgnoreAttribute()]
    [SoapIgnoreAttribute()]
    [DataMemberAttribute()]
    [EdmRelationshipNavigationPropertyAttribute("OrderModel", "FK_ShippingOrderItem_ShippingOrder", "ShippingOrderItem")]
    public EntityCollection<ShippingOrderItem> ShippingOrderItems
    {
        get
        {
            return ((IEntityWithRelationships)this).RelationshipManager.GetRelatedCollection<ShippingOrderItem>("OrderModel.FK_ShippingOrderItem_ShippingOrder", "ShippingOrderItem");
        }
        set
        {
            if ((value != null))
            {
                ((IEntityWithRelationships)this).RelationshipManager.InitializeRelatedCollection<ShippingOrderItem>("OrderModel.FK_ShippingOrderItem_ShippingOrder", "ShippingOrderItem", value);
            }
        }
    }

    /// <summary>
    /// No Metadata Documentation available.
    /// </summary>
    [XmlIgnoreAttribute()]
    [SoapIgnoreAttribute()]
    [DataMemberAttribute()]
    [EdmRelationshipNavigationPropertyAttribute("OrderModel", "FK_ShippingOrderItemTracking_ShippingOrder", "ShippingOrderTracking")]
    public EntityCollection<ShippingOrderTracking> ShippingOrderTrackings
    {
        get
        {
            return ((IEntityWithRelationships)this).RelationshipManager.GetRelatedCollection<ShippingOrderTracking>("OrderModel.FK_ShippingOrderItemTracking_ShippingOrder", "ShippingOrderTracking");
        }
        set
        {
            if ((value != null))
            {
                ((IEntityWithRelationships)this).RelationshipManager.InitializeRelatedCollection<ShippingOrderTracking>("OrderModel.FK_ShippingOrderItemTracking_ShippingOrder", "ShippingOrderTracking", value);
            }
        }
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:44:32.810

我仍然不确定问题的原因是什么。我决定只删除我的数据库并重新创建我的表（以及主键和外键）并再次迁移所有数据。它实际上修复了它，但是，我不确定最终会有什么不同。我没有记录任何异常，并且基于 SQL Server Profiler，看起来正在执行正确的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T06:50:08.623

你也可以试试这个：

```
if (Order.shippingId != null && Order.shippingId > 0)
    orderContext.LoadProperty(Orders, Order => Order.ShippingOrderItems); 
```

这将在 ShippingOrderItems 中获取匹配的订单 ID。

# iphone - 如何在 iPod 仍在播放音频时将 iOS 上的视频静音？

> ID：11506328
> 
> 赞同：2
> 
> 时间：2012-07-16T14:21:04.303
> 
> 标签：iphone, objective-c, ios, audio, video

我正在开发一个教学应用程序，播放没有声音的视频动画。我想阻止电影播放器​​在启动视频时停止其他音频会话（例如 iPod）。

有什么方法可以指示 iOS 视频没有音频或在静音模式下播放？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T04:16:08.400

您始终可以检测音乐是否正在播放，并在电影开始播放后立即恢复播放。

检测玩家状态 `[MPMusicPlayerController iPodMusicPlayer] playbackState]`

恢复 `[[MPMusicPlayerController iPodMusicPlayer] play];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:37:48.977

我想也许是这样的

```
UInt32 allowMixing = YES;
AudioSessionSetProperty(kAudioSessionProperty_OverrideCategoryMixWithOthers, sizeof(allowMixing), &allowMixing);
AudioSessionSetActive(YES); 
```

应该做的伎俩。

请记住，您需要将`AudioToolbox`库添加到您的应用程序中，并添加：

```
 #import <AudioToolbox/AudioToolbox.h> 
```

为了使用上面的代码，您的类导入。

它应该允许您的应用程序的声音在后台与其他应用程序的声音混合。在这种情况下，由于您的应用程序是静音的，它只会允许背景声音继续播放。

希望能帮助到你！

# python - python tsp 旅行商无向图

> ID：11506330
> 
> 赞同：3
> 
> 时间：2012-07-16T14:21:10.687
> 
> 标签：python, graph, networkx, traveling-salesman

在其他帖子中，Networkx 被建议为“我的朋友”。但是对于 TSP 问题的特定解决方案似乎没有现成的功能。即[在Python中创建无向图](https://stackoverflow.com/questions/6197339/creating-undirected-graphs-in-python)

我有一个无向图，建议的解决方案都与有向图有关，我想知道使用可用边访问所有节点的短途旅行。

（另外，我在 networkx 的文档中找不到带有有向图的 tsp）

有没有人为无向图做了这样的事情，或者我应该修改有向图的解决方案，对于未连接的节点具有无限成本？

编辑：我正在学习：实际上，由于图未加权（或“所有权重”相同），并且并非每个节点都连接到所有其他节点，我只需要在包含所有节点的图中找到一个循环。当该循环不存在时，节点可能会重复（因此，它不再是循环......）。没有孤立的组（从每个节点到另一个节点都有一条路径）。我想这不是推销员的问题？！

到目前为止感谢您的反馈（当毫秒开始重要时，我将安装照片完成 :)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:27:55.093

如果您已经有有向图的代码，我只会转换您的无向图。用两个有向边替换每个无向边，每个方向一个，保留边权重。

# .net - 实体框架中未映射外键（4.0 版）

> ID：11506333
> 
> 赞同：0
> 
> 时间：2012-07-16T14:21:18.800
> 
> 标签：.net, asp.net-mvc-3, linq, entity-framework

我使用现有数据库创建了一个 edmx 文件。我正在尝试实现[JOIN](http://msdn.microsoft.com/en-us/library/bb896266.aspx)。但是有一段时间我试图创建一个类似的查询。存在编译时问题。

> CodeBox.FB.DataAccess.PlayerTeamSeason' 不包含“PlayerID”的定义，并且找不到接受“CodeBox.FB.DataAccess.PlayerTeamSeason”类型的第一个参数的扩展方法“PlayerID”（您是否缺少 using 指令或装配参考？！

而且我可以看到基于表格的相应类。但是我发现在 Mapping Details 窗口中，有些列没有等效的字段/属性，我发现这些是 forgein key feilds 。我在 SO 中发现了很多问题，但我没有找到解决问题的方法。我找到了这个[链接](http://msdn.microsoft.com/en-us/library/bb896266.aspx) 当我尝试加入两个表时，我无法使用外键加入。

但我可以加入这样的事情

```
 var query =
        from contact in contacts
        join order in orders
        on contact.ContactID
        equals order.Contact.ContactID into contactGroup
        select new
        {
            ContactID = contact.ContactID,
            OrderCount = contactGroup.Count(),
            Orders = contactGroup
        }; 
```

`order.Contact.ContactID`像这样我可以加入。

但我预计会出现以下查询。

```
var query =
        from order in orders
        join detail in details
        on order.SalesOrderID equals detail.SalesOrderID
        where order.OnlineOrderFlag == true
        && order.OrderDate.Month == 8
        select new
        {
            SalesOrderID = order.SalesOrderID,
            SalesOrderDetailID = detail.SalesOrderDetailID,
            OrderDate = order.OrderDate,
            ProductID = detail.ProductID
        }; 
```

`order.SalesOrderID equals detail.SalesOrderID`. 当我尝试使用我生成的 edmx 时，我在我的实体中找不到相应的外键。

这是我希望编写的查询。但它有错误`PTS.PlayerID`并且`PTS.TeamID`

```
var pl2 = from PTS in dataContext.PlayerTeamSeasons
                      join P in dataContext.Players on PTS.PlayerID equals P.ID
                      where PTS.TeamID == 3
                      select P.ID; 
```

如果我将查询更改为此，它将正常工作。

```
 var pl3 = from Pts in dataContext.PlayerTeamSeasons
                  join P in dataContext.Players on Pts.Player.ID equals P.ID
                  where Pts.Team.ID == 3
                  select P.ID; 
```

我可以知道为什么会这样。

请看我的截图。

![映射详细信息](../Images/1092451d286f5be832697f09f80dae41.png) 谢谢

# ajax - 多个 AJAX 发布到返回值的 Web 服务。我应该同步吗？

> ID：11506338
> 
> 赞同：0
> 
> 时间：2012-07-16T14:21:34.743
> 
> 标签：ajax, rest, posts, synchronize

我的网站正在向我的 Web 服务发送 ajax 帖子，而 Web 服务作为回报将返回一个 json，并且该 json 将在成功回调中进一步使用。

现在，这是我的问题，当我的网站发送多个 ajax 帖子时，Web 服务返回的那些 json 似乎混乱了。

我正在考虑同步 ajax 帖子或网络服务 (REST)？我读到您不需要同步 REST 服务，是这样吗？如果同步是解决方案，我应该在哪里同步它？ajax 中的 async: false 会同步帖子吗？

谢谢。

我想过包括一些代码：

网络服务：

```
@POST
@Override
@Produces("application/json")
@Consumes("application/json")
public Customer create(Customer cust){
    custManager.save(cust);
    return custManager.getCust(custManager.getCount());
} 
```

阿贾克斯：

```
$.ajax({
  url:  custURL,
  type: 'POST',
  data: JSON.stringify(sdata),
  dataType: 'json',
  contentType: 'application/json; charset=utf-8',
  success: function(json){
     var cust = JSON.parse(JSON.stringify(json));
     var newId = cust.id;
     updateCustId(oldId, newId);
  }
}); 
```

它所做的是将客户的数据发布到 Web 服务，并且 Web 服务为其指定一个 id 并将其返回给客户端以更新其客户 id。不仅如此，我还将引用旧客户 ID 的其他表更新为从服务器生成的新表，并且在更新这些其他表之后，它也将被发送到 Web 服务。我说的表是 web sql，它的查询也是异步工作的。所以最终结果是有时 id 被弄乱了，其他表被发送到 web 服务，但它使用的 customerid 仍然是旧的（我使用了回调，确保在发送之前需要先更新它到服务器）。

让我的 ajax 调用 async: false 使它们同步而不是混在一起工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:31:44.660

我不认为你的问题是异步的，特别是。听起来您的 Web 服务实现中有一些错误。您所描述的应该可以正常工作。

多个 Ajax 请求是完全独立的。后端服务器应分别处理每个请求。

在 Web 应用程序的线程之间共享数据时，您可能会遇到问题，这会导致同时访问相同数据时出现问题。如果是这样，这就是要解决的问题，并且（在最坏的情况下），只需在一小段代码周围放置一个互斥体，即进行交叉污染。

如果您发现数据可以正常离开服务器，但在您的应用程序中已损坏，那么错误就在那里。

我强烈建议不要尝试通过使整个应用程序同步来掩盖听起来像是重大后端错误的内容。修复潜在的损坏问题，如果该问题是由无法使线程安全的东西引起的，那么就锁定那一点点。

您关于 REST 的问题有点无关紧要。无论代码是否需要同步，REST 服务与其他架构都不会改变。当您使用 Ajax 时，您使用的是 HTTP 协议，该协议旨在实现异步和无状态。在我看来，需要客户端同步访问的任何样式的 Web 应用程序都是一个很大的危险信号。

除了一般建议之外，您还需要询问基于代码的特定问题以获取更多详细信息。

# javascript - 缺少 ) 与 JavaScript 代码

> ID：11506341
> 
> 赞同：1
> 
> 时间：2012-07-16T14:21:51.767
> 
> 标签：javascript

这是错误。

```
Timestamp: 16/07/2012 06:05:02 م
Error: missing ) after argument list
Source File: http://www.tfwefffepchat.com/Register.aspx
Line: 210, Column: 411
Source Code:

SendSMS(96892042638,'There is a job equalvalent to you plz visit this link: http://www.twefffepchat.com/ApplyJob.aspx?id=8');

SendEmail('noor.al3alam@gmail.com','Matching Job','sss');

SendSMS(96892042638,'There is a job equalvalent to you plz visit this link: http://www.twefffepchat.com/ApplyJob.aspx?id=9');

SendEmail('noor.al3alam@gmail.com','Matching Job','sss');

SendEmail('noor.al3alam@gmail.com','Welcome',Welcome to Online Job Seekers your validation link : http://twefffepchat.com/Validate.aspx?id=__Page');SendSMS(96892042638,'noor.al3alam@gmail.com You have registered successfuly.your validation link :__Page'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:23:37.483

你的错误在这里：

```
SendEmail('noor.al3alam@gmail.com','Welcome',Welcome to Online Job Seekers your validation link : http://twefffepchat.com/Validate.aspx?id=__Page');
//                                           ^ Here 
```

您缺少开场白：

```
SendEmail('noor.al3alam@gmail.com','Welcome','Welcome to Online Job Seekers your validation link : http://twefffepchat.com/Validate.aspx?id=__Page'); 
```

# rust - “带有非无 lp 的别名 ptr”在 rust 中意味着什么

> ID：11506342
> 
> 赞同：0
> 
> 时间：2012-07-16T14:22:01.827
> 
> 标签：rust

对于以下代码：

```
import io::*;
import to_str::*;

impl <T : to_str copy> of to_str for @[mut T] {
    fn to_str() -> str {
        let tmp = copy self;
        tmp.map(|x| { x.to_str() }).to_str()
    }
}

fn main() {
    println((@[mut 1, 2, 3]).to_str());
} 
```

我收到一个错误：

```
example.rs:7:8: 7:11 error: internal compiler error: aliased ptr with a non-none lp
example.rs:7         tmp.map(|x| { x.to_str() }).to_str()
                     ^~~ 
```

如何解决？还有什么`aliased ptr with a non-none lp`意思呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:38:32.783

内部编译器错误始终是 Rust 中的错误。当你看到一个问题时，最好的办法是在[https://github.com/mozilla/rust/issues](https://github.com/mozilla/rust/issues)提交一个问题，其中包含导致错误的代码。

至于如何解决这个错误，如果你使用`~[mut T]`而不是`@[mut T]`？我们最近刚刚添加了`@`向量，但仍然缺少许多使用它们的库代码。

# php - 使用 PHP 与 Map 和 Reduce MongoDB 的经典平均演算

> ID：11506346
> 
> 赞同：0
> 
> 时间：2012-07-16T14:22:14.213
> 
> 标签：php, mongodb, mapreduce

我需要计算图表的平均值。

我在数据库中有 15k 行，我的索引是时间。

我以两种不同的方式做到了：

1）我重复时间间隔（对于每个间隔）：-日期之间的原始数据请求-此间隔的 PHP 平均计算

2) Map and Reduce：对于每个区间，reduce 函数计算数据，然后在 finalize 函数中取平均值。

```
 m = function() { 
        var k = new Date(this.date);
        k.setSeconds(0);
        k.setMilliseconds(0);
        emit(
            k, { 
                note: this.note
            }
        );
    }
    r = function(key, values) {
        var reduced = { 
                note:0,
                count:0,
                noteAvg:0,
                };
        values.forEach(function(val) {
            reduced.note += val.note; 
            reduced.count += val.count;
        });
        return reduced;
    }
    f = function(key, reduced) {
        reduced.noteAvg = reduced.note / reduced.count;
        return reduced;
    }

    $data_graph = $this->db->command(array(
        "mapreduce" => "notes",
        "map" => $map,
        "reduce" => $reduce,
        "finalize" => $finalize,
        "query" => $req,
        "out" => array("inline"=>1)
    )); 
```

第二种解决方案比第一种解决方案要慢很多时间。为什么？我应该尝试使用更多数据进行比较吗？

我在 MongoLab（免费版）和我的本地 mongo 服务器上进行了尝试，没有任何变化。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:12:35.180

听起来您正在映射所有数据并使用 reduce 将其过滤掉，而不是将查询限制在您的 PHP 查询获得的同一子集。

如果您还没有这样做，请在您的 mapreduce 调用中添加一个 {query:{}} 参数，如此[处所述。](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-Overview)

这只会将满足查询的文档子集传递给 map/reduce 操作。

# php - 如何在php中通过URL传递变量

> ID：11506351
> 
> 赞同：0
> 
> 时间：2012-07-16T14:22:35.140
> 
> 标签：php

您好我正在尝试通过 URL 将值从一个文件传递到另一个文件。

我的做法是：`<a href='fund_view.php?idfund="<? echo $row['idfund']; ?>"'>`

毕竟我在其他文件中使用

```
$aidi = $_GET['idfund'];

echo 'ID= '.$aidi;` 
```

但我得到的结果是这种格式`ID= \"10\"`

我通过 id 后的 url 看起来像

```
http://example.com/fund_view.php?idfund="10" 
```

我想要的结果只是`ID="10"`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:24:48.267

关闭php.ini 中的[magic_quotes](http://php.net/magic_quotes)，你应该去掉那些反斜杠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:25:18.437

改变

```
<a href='fund_view.php?idfund="<? echo $row['idfund']; ?>"'> 
```

到

```
<a href='fund_view.php?idfund=<? echo $row['idfund']; ?>'> 
```

另请记住，您的代码非常不安全......至少在使用之前将参数转换为 int ：

```
$aidi = (integer) $_GET['idfund']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:54:24.563

PHP 的早期版本（低于 5.4）有一个非常违反直觉的功能，称为[“魔术引号”](http://www.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc)，它会自动（并且无声地）转义所有 GET/POST 字符串，就好像它们将在 MySQL 查询中使用一样。

逆向相对简单，只是当你不知道存在这样的功能时会很头疼。

[解决方案 1：使用ini_set](http://php.net/manual/en/function.ini-set.php)关闭 magic_quotes

有时您将无法使用 ini_set（限制性主机提供程序），因此以下是我使用过的下一个最佳（和可移植）解决方案：

**注意：[get_magic_quotes_gpc](http://php.net/manual/en/function.get-magic-quotes-gpc.php)功能页面上提供的功能**

```
<?php
    function stripslashes_deep(&$value)
    {
        $value = is_array($value) ?
                    array_map('stripslashes_deep', $value) :
                    stripslashes($value);

        return $value;
    }

    if (get_magic_quotes_gpc())
    {
        stripslashes_deep($_GET);
        stripslashes_deep($_POST);
    }

?> 
```

# css - 按钮 ontouchstart

> ID：11506356
> 
> 赞同：1
> 
> 时间：2012-07-16T14:22:38.750
> 
> 标签：css, button, mobile, safari

我创建了一个带有一些按钮的移动网站。我通过 css 添加了背景渐变，并为#button:active 添加了倒置渐变。当我在我的 iPhone 上打开我的网站并点击按钮时，渐变会发生变化，但也会出现“Mobile-Safari-native”——使按钮变暗/变暗的效果。有没有办法禁用第二个效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:41:03.150

添加

```
-webkit-appearance: none; 
```

到按钮的 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:09:07.237

在您的课程中添加`border:0;`属性`.button`

# java - JavaPN 抛出 SSLHandshakeException java.io.EOFException: SSL peer 错误关闭

> ID：11506357
> 
> 赞同：1
> 
> 时间：2012-07-16T14:22:38.900
> 
> 标签：java, apple-push-notifications

我正在为苹果开发 Java 推送通知服务，为此我使用[了 JavaPNS 2.2](http://code.google.com/p/javapns/)。我已使用此[站点](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)上提供的教程在 Apple 中创建我的证书并成功运行演示（在 PHP 中）。（我还转换了 .p12、.pem 文件中的证书）。

但是，当我尝试在我的测试类中运行 java 中的简单推送通知时（如 JavaPNS 教程中所述），

```
public class PushTest {

public static void main(String[] args) {
     try {
         List<PushedNotification> notifications = Push.alert("Hello World!", "<filename>.p12", "<password>", true, "<devicetoken>");
         System.out.println("List of Device: "+notifications);

         List<Device> inactiveDevices = Push.feedback("<filename>.p12", "<password>", true);
    } catch (CommunicationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (KeystoreException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

我正进入（状态，

```
javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure
    at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Unknown Source)
    at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.recvAlert(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecord(Unknown Source)
    at com.sun.net.ssl.internal.ssl.AppOutputStream.write(Unknown Source)
    at java.io.OutputStream.write(Unknown Source)
    at javapns.notification.PushNotificationManager.sendNotification(PushNotificationManager.java:402)
    at javapns.notification.PushNotificationManager.sendNotification(PushNotificationManager.java:350)
    at javapns.notification.PushNotificationManager.sendNotification(PushNotificationManager.java:320)
    at javapns.Push.sendPayload(Push.java:177)
    at javapns.Push.test(Push.java:132)
    at javapns.test.NotificationTest.pushTest(NotificationTest.java:83)
    at javapns.test.NotificationTest.main(NotificationTest.java:46) 
```

在eclipse中调试JavaPNS代码后，我知道错误是由于，

```
java.io.EOFException: SSL peer shut down incorrectly 
```

现在我不明白问题出在哪里，因为我的证书（带有 .PEM 扩展名）适用于 PHP 示例。

如果它在 PHP 中而不是在 Java 中工作，我怀疑它的证书的错误，并且 JavaPNS 站点也没有指定天气，我必须通过`keytool`或不导入生成的证书。

谁能帮我解决我的问题？仅供参考：我的系统配置，操作系统：Win 7 Java：jdk1.6.0_05 JavaPNS：2.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T13:37:58.370

最后我找到了我的问题的答案，

它的证书。问题是，有 2 个具有相同 URL (com.xxx.xxx) 的证书，因此发生了混淆。

我已经删除了设备未使用的那个，并从设备中使用的那个和 Bingo 中创建了一个新的 .p12，它起作用了。

# ruby-on-rails-3 - mysql2上的rails_sql_views未定义方法'base_tables'

> ID：11506362
> 
> 赞同：1
> 
> 时间：2012-07-16T14:22:51.730
> 
> 标签：ruby-on-rails-3

我需要创建视图，发现使用 SQL 创建它们会导致运行测试出现问题。

在我的开发系统 sqlite3 上，我将数据库迁移回滚到创建视图之前。

我从 git://github.com/unleashed/rails_sql_views 添加了 rails_sql_views gem。

我修改了视图的迁移，所以现在是

```
def up
 # dividing by 100 for percentages and 1000 for kW, hence 100000
create_view :view_sub_power_ratings,
  "select
        ((s.power_off * p.percent_off + s.standby * p.percent_standby + s.idle * p.percent_idle + s.normal * p.percent_normal + s.maximum * p.percent_max) * p.working_days * 24 +
        (s.power_off * percent_off_nw + s.standby * percent_standby_nw + s.idle * p.percent_idle_nw + s.normal * p.percent_normal_nw + s.maximum * percent_max_nw) * (365 - p.working_days) * 24) /100000
                                                               as power_usage,
        p.subscription_id,
        s.device_id
    from sub_category_params p
    inner join devices d on d.device_category_id = p.device_category_id
    inner join device_power_summaries s on  s.device_id = d.id"

# dividing by 100 for percentage accuracy, 100  for percent used, and 1000 for kW, hence 10000000

create_view :view_sub_power_ratings_variations,

"select

(s.standby * s.standby_accuracy * p.percent_standby + s.idle * s.idle_accuracy *p.percent_idle + s.normal * s.normal_accuracy * p.percent_normal +
 s.maximum * s.maximum_accuracy * p.percent_max + s.power_off * s.power_off_accuracy * p.percent_off) * 24 * p.working_days/ 10000000 as variation_wd,

(s.standby * s.standby_accuracy * p.percent_standby_nw + s.idle * s.idle_accuracy *p.percent_idle_nw + s.normal * s.normal_accuracy * p.percent_normal_nw +
 s.maximum * s.maximum_accuracy * p.percent_max_nw + s.power_off * s.power_off_accuracy * p.percent_off_nw) * 24 * (365-p.working_days)/ 10000000 as variation_nw,
        p.subscription_id,
        s.device_id
    from sub_category_params p
    inner join devices d on d.device_category_id = p.device_category_id
    inner join device_power_summaries s on  s.device_id = d.id"

  create_view :view_sub_power_maximums,
  "select
    r.power_usage + (v.variation_nw + v.variation_wd) as maximum_power_usage,
    r.power_usage - (v.variation_nw + v.variation_wd)   as minimum_power_usage,
          v.subscription_id,
        v.device_id
    from sub_category_params p
    inner join devices d on d.device_category_id = p.device_category_id
    inner join device_power_summaries s on  s.device_id = d.id
    inner join view_sub_power_ratings r on d.id = r.device_id and p.subscription_id = r.subscription_id
    inner join view_sub_power_ratings_variations v on  d.id = v.device_id and p.subscription_id = v.subscription_id"

end

def down
  drop_view :view_sub_power_ratings
  drop_view :view_sub_power_ratings_variations
  drop_view :view_sub_power_maximums
end 
```

然后我再次运行迁移，一切都很好。视图被创建并且 create_view 在 schema.rb 中。结果！

但是，在部署到我的登台服务器时，我在迁移时遇到错误。这是在 MySQL2 上。

这是痕迹

```
** Execute db:schema:dump
rake aborted!
undefined method `base_tables' for #<ActiveRecord::ConnectionAdapters::Mysql2Adapter:0xb876f1c>
/usr/local/rvm/gems/ruby-1.9.3-p125/bundler/gems/rails_sql_views-9d781715bcab/lib/rails_sql_views/schema_dumper.rb:98:in `tables_with_views_excluded'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/schema_dumper.rb:27:in `dump'
/usr/local/rvm/gems/ruby-1.9.3-p125/bundler/gems/rails_sql_views-9d781715bcab/lib/rails_sql_views/schema_dumper.rb:27:in `dump_with_views'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/schema_dumper.rb:21:in `dump'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/railties/databases.rake:354:in `block (4 levels) in <top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/railties/databases.rake:352:in `open'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/railties/databases.rake:352:in `block (3 levels) in <top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/railties /databases.rake:161:in `block (2 levels) in <top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'  
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/local/rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.1/lib/active_record/railties/databases.rake:156:in `block (2 levels) in <top (required)>'   
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/bin/rake:19:in `load'
/usr/local/rvm/gems/ruby-1.9.3-p125@global/bin/rake:19:in `<main>'
Tasks: TOP => db:schema:dump 
```

我的 Gemfile 有

```
gem 'rails_sql_views', :git => 'git://github.com/unleashed/rails_sql_views', require: 'rails_sql_views' 
```

捆绑安装运行正常：

```
 ** [out :: myserver.com] 
 ** [out :: myserver.com] Using rails_sql_views (0.8.0.1.unleashed) from git://github.com/unleashed/rails_sql_views (at master)
 ** [out :: myserver.com] 
 ** [out :: myserver.com] Using sass (3.1.15)
 ** [out :: myserver.com] * mysql2-0.3.11.gem
 ** [out :: myserver.com] Removing outdated .gem files from vendor/cache
 ** [out :: myserver.com] * rails_sql_views-0.8.0.gem
 ** [out :: myserver.com] Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.
  command finished in 4018ms 
```

我见过一些人报告类似情况，解释是没有适用于 MySQL2 的适配器。但它在 lib/rails_sql_views/connection_adapters 目录中：mysql2_adapter.rb

我看了一眼，有一种 base_tables 的方法

那么我错过了什么？抱歉，我知道这将是一件很明显的事情，但我仍然不太了解宝石是如何集成到系统中的。

提前谢谢了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:14:57.527

我已将 gem 的来源更改为：

git://github.com/centresource/rails_sql_views

这已经解决了问题 - 迁移现在工作正常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:28:20.450

当您将 gem 添加到您的 Gemfile 时，您需要运行`bundle install`.

这将查看您的 Gemfile 是否已更改，如果已更改，例如添加一个新 gem，它将转到源，拉入 gem 代码，然后将其包含在您的应用程序中。

要查看项目有哪些 gem，只需查看从最后一个包生成的 Gemfile.lock 文件。

# vba - 使用 VBA 为特定的 Excel 错误消息制作消息？

> ID：11506364
> 
> 赞同：4
> 
> 时间：2012-07-16T14:22:55.083
> 
> 标签：vba, excel

有没有办法说是否出现错误 1004，显示消息“消息”，如果错误 9，显示消息“消息 2”，而不是最终用户的通用非描述符极客讲话消息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:25:29.963

您正在尝试做的事情称为错误处理。

请参阅此示例。您可以使用以下方法捕获错误号`Err.Number`

```
Sub Sample()
    On Error GoTo Whoa

    '~~> Rest of the code

    Exit Sub
Whoa:
    Select Case Err.Number
        Case 9
            MsgBox "Message1"
        Case 1004
            MsgBox "Message2"
    End Select
End Sub 
```

**跟进**

```
Sub Sample1()
    On Error GoTo Whoa

    '~~> Rest of the code

    Exit Sub
Whoa:
    MsgBox GetErrMsg(Err.Number)
End Sub

Sub Sample2()
    On Error GoTo Whoa

    '~~> Rest of the code

    Exit Sub
Whoa:
    MsgBox GetErrMsg(Err.Number)
End Sub

Function GetErrMsg(ErNo As Long) As String
    Select Case ErNo
        Case 9
            GetErrMsg = "Message1"
        Case 1004
            GetErrMsg = "Message2"
        Case Else
            GetErrMsg = "Message3"
    End Select
End Function 
```

# flash - 闪存 - 错误 1014

> ID：11506365
> 
> 赞同：0
> 
> 时间：2012-07-16T14:22:56.410
> 
> 标签：flash, apache-flex

```
error 1014 class mx.core application could not be found. 
```

大家好，我的客户收到上面发布的错误消息，我不明白为什么。

该应用程序在我们这里的所有机器上运行良好，并且它曾经与这个应用程序的早期版本一起工作（事实上，我没有向应用程序添加代码，只编辑了包含我们资产的 XML 文件，以包含新资产） .

是什么导致了这个错误？大约一周前我确实升级到了 AIR3.3，我不得不覆盖一些文件，但是这个应用程序是使用 Flex SDK 3.6 编码的，所以它应该不会影响它，对吧？

此外，它确实适用于我们内部的其他工作站，这是库存.. 所以我不明白为什么他们现在突然收到这个错误。

任何帮助都会很棒。谢谢！

编辑：好的，所以当我找到我们的客户并检查问题时，我发现他试图从压缩档案中运行它。明显不行。。

至少我了解了一些关于 RSL 之类的知识！=) 感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:23:05.077

原来客户忘记提取档案，所以他试图从压缩档案中运行程序。;)

至少我学到了一点关于 RSL 的知识！感谢 www.Flextras.com

# windows-phone-7 - HttpWebRequest 在设备上不起作用

> ID：11506367
> 
> 赞同：0
> 
> 时间：2012-07-16T14:23:05.053
> 
> 标签：windows-phone-7, httpwebrequest

我已经阅读了一些包含该问题的主题，但没有一个答案是有用的，或者主题最终没有得到解决。

所以我的应用程序在模拟器上运行良好，但在设备上运行不正常（HTC Trophy 是否重要？）。我正在捕捉这样的异常：

```
System.Net.WebException: The remote server returned an error: NotFound. ---> System.Net.WebException: The remote server returned an error: NotFound.
   at System.Net.Browser.ClientHttpWebRequest.InternalEndGetResponse(IAsyncResult asyncResult)
   at System.Net.Browser.ClientHttpWebRequest.<>c__DisplayClass2.<EndGetResponse>b__1(Object sendState)
   at System.Net.Browser.AsyncHelper.<>c__DisplayClass4.<BeginOnUI>b__0(Object sendState)
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(RuntimeMethodInfo rtmi, Object obj, BindingFlags invokeAttr, Binder binder, Object parameters, CultureInfo culture, Boolean isBinderDefault, Assembly caller, Boolean verifyAccess, StackCrawlMark& stackMark)
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, StackCrawlMark& stackMark)
   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
   at System.Delegate.DynamicInvokeOne(Object[] args)
   at System.MulticastDelegate.DynamicInvokeImpl(Object[] args)
   at System.Delegate.DynamicInvoke(Object[] args)
   at System.Windows.Threading.Dispatcher.<>c__DisplayClass4.<FastInvoke>b__3()
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(RuntimeMethodInfo rtmi, Object obj, BindingFlags invokeAttr, Binder binder, Object parameters, CultureInfo culture, Boolean isBinderDefault, Assembly caller, Boolean verifyAccess, StackCrawlMark& stackMark)
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, StackCrawlMark& stackMark)
   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
   at System.Delegate.DynamicInvokeOne(Object[] args)
   at System.MulticastDelegate.DynamicInvokeImpl(Object[] args)
   at System.Delegate.DynamicInvoke(Object[] args)
   at System.Windows.Threading.DispatcherOperation.Invoke()
   at System.Windows.Threading.Dispatcher.Dispatch(DispatcherPriority priority)
   at System.Windows.Threading.Dispatcher.OnInvoke(Object context)
   at System.Windows.Hosting.CallbackCookie.Invoke(Object[] args)
   at System.Windows.Hosting.DelegateWrapper.InternalInvoke(Object[] args)
   at System.Windows.RuntimeHost.ManagedHost.InvokeDelegate(IntPtr pHandle, Int32 nParamCount, ScriptParam[] pParams, ScriptParam& pResult)

   at System.Net.Browser.AsyncHelper.BeginOnUI(SendOrPostCallback beginMethod, Object state)
   at System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
   at Birdaholic1.AddSighting.GetResponseCallback(IAsyncResult asynchronousResult)
   at System.Net.Browser.ClientHttpWebRequest.<>c__DisplayClassa.<InvokeGetResponseCallback>b__8(Object state2)
   at System.Threading.ThreadPool.WorkItem.WaitCallback_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadPool.WorkItem.doWork(Object o)
   at System.Threading.Timer.ring() 
```

我应该怎么办？我应该从哪里开始修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T09:00:09.413

要查看的事项清单：

*   -object是否`URI`设置了`UriKind.Absolute`属性？
*   我的手机是否有数据连接（例如 Facebook、Internet Explorer 等其他应用程序是否可用）？
*   如果是这样，我可以在网络浏览器中打开 URL（假设它是一个`GET`-request）并找到它吗？

如果所有这些问题的答案都是肯定的，请尽可能尝试使用第二台设备并尝试重现问题。如果它仍然存在，请查看服务器端，也许缓存出于某种原因搞砸了。

快乐（错误）狩猎！

# c - Valgrind 报告空 C 程序的未初始化值

> ID：11506370
> 
> 赞同：13
> 
> 时间：2012-07-16T14:23:17.207
> 
> 标签：c, memory, gcc, linker, valgrind

我用`gcc test.c`or编译了这个 C 程序`clang test.c`：

```
int main (void) {
    return 0;
} 
```

`valgrind ./a.out`给了我这个：

```
==9232== Memcheck, a memory error detector
==9232== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==9232== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==9232== Command: ./a.out
==9232== 
==9232== Conditional jump or move depends on uninitialised value(s)
==9232==    at 0x4017876: index (in /usr/lib/ld-2.16.so)
==9232==    by 0x4007902: expand_dynamic_string_token (in /usr/lib/ld-2.16.so)
==9232==    by 0x4008204: _dl_map_object (in /usr/lib/ld-2.16.so)
==9232==    by 0x400180D: map_doit (in /usr/lib/ld-2.16.so)
==9232==    by 0x400E785: _dl_catch_error (in /usr/lib/ld-2.16.so)
==9232==    by 0x40010DB: do_preload (in /usr/lib/ld-2.16.so)
==9232==    by 0x4004546: dl_main (in /usr/lib/ld-2.16.so)
==9232==    by 0x4014B5D: _dl_sysdep_start (in /usr/lib/ld-2.16.so)
==9232==    by 0x4004DFD: _dl_start (in /usr/lib/ld-2.16.so)
==9232==    by 0x4001627: ??? (in /usr/lib/ld-2.16.so)
==9232== 
==9232== Conditional jump or move depends on uninitialised value(s)
==9232==    at 0x401787B: index (in /usr/lib/ld-2.16.so)
==9232==    by 0x4007902: expand_dynamic_string_token (in /usr/lib/ld-2.16.so)
==9232==    by 0x4008204: _dl_map_object (in /usr/lib/ld-2.16.so)
==9232==    by 0x400180D: map_doit (in /usr/lib/ld-2.16.so)
==9232==    by 0x400E785: _dl_catch_error (in /usr/lib/ld-2.16.so)
==9232==    by 0x40010DB: do_preload (in /usr/lib/ld-2.16.so)
==9232==    by 0x4004546: dl_main (in /usr/lib/ld-2.16.so)
==9232==    by 0x4014B5D: _dl_sysdep_start (in /usr/lib/ld-2.16.so)
==9232==    by 0x4004DFD: _dl_start (in /usr/lib/ld-2.16.so)
==9232==    by 0x4001627: ??? (in /usr/lib/ld-2.16.so)
==9232== 
==9232== 
==9232== HEAP SUMMARY:
==9232==     in use at exit: 0 bytes in 0 blocks
==9232==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
==9232== 
==9232== All heap blocks were freed -- no leaks are possible
==9232== 
==9232== For counts of detected and suppressed errors, rerun with: -v
==9232== Use --track-origins=yes to see where uninitialised values come from
==9232== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0) 
```

GCC 版本 4.7.1 和 Clang 版本 3.1。这怎么了？我的记忆有问题吗？自从我上次使用 valgrind 以来已经有一段时间了，但我认为这不是正常行为。喊叫？

* * *

**解决方案**：从我从@Shawn 那里学到的知识可以使用 valgrind`.supp`文件来抑制这些链接器错误。我所做的是使用以下`--gen-suppressions=all`选项在我的程序上运行 valgrind：

```
valgrind --gen-suppressions=all ./a.out 
```

然后我提取括号中的新块并将它们直接放入文件中`my.supp`：

```
{  
   <linker>
   Memcheck:Cond
   fun:index
   fun:expand_dynamic_string_token
   fun:_dl_map_object
   fun:map_doit
   fun:_dl_catch_error
   fun:do_preload
   fun:dl_main
   fun:_dl_sysdep_start
   fun:_dl_start
   obj:/usr/lib/ld-2.16.so
} 
```

现在我可以运行 valgrind 并`--suppressions`选择指向我的新文件，并且消息将被禁止：

```
valgrind --suppressions=/home/foo/my.supp ./a.out 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T14:45:32.323

这是 valgrind 的一个[已知](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=623876) [问题](https://bugzilla.redhat.com/show_bug.cgi?id=798968)，通常[使用 valgrind suppresss 来解决](https://bugzilla.redhat.com/show_bug.cgi?id=245682)。假设您的发行版已报告该问题，则禁止列表应很快更新，并将在下一次更新中消失。

目前，忽略该消息是安全的。

如果它困扰您，您可以维护[自己的抑制文件](http://wiki.wxwidgets.org/Valgrind_Suppression_File_Howto)并使用它，直到您的发行版更新默认文件（通常`/var/lib/valgrind/default.supp`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T14:24:31.320

这是动态链接器中的一个“问题”，并且很常见。它出现在`main()`被调用之前。您可以忽略该消息。

# jquery - jQuery UI DateTimepicker - 无法隐藏时间

> ID：11506371
> 
> 赞同：6
> 
> 时间：2012-07-16T14:23:30.233
> 
> 标签：jquery, datetimepicker, timepicker

我正在使用来自[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)的日期时间选择器组件。试图隐藏时间选择器，但我的代码不起作用：

```
$('#id_start_date_time').datetimepicker('option', 'showTimepicker', false); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-12-08T23:44:14.523

我刚遇到这个问题。我知道自从 OP 提出这个问题以来已经有一段时间了，他可能已经解决了这个问题。只是为了以后可能会遇到这个问题的人，如果要隐藏时间选择器，只需调用原始jquery ui datepicker方法即可

```
datepicker() 
```

代替

```
datetimepicker() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-24T05:13:18.837

**当另一个代码不起作用时，我使用我的这个代码。**

```
 $('#datetimepicker_date_to_view').datetimepicker({
            timepicker:false,
            format:'d.m.Y',
        }).on('change', function() {
            $('.xdsoft_datetimepicker').hide();
            var str = $(this).val();
            str = str.split(".");
            $('#alt_date_field').val(str[2]+'-'+str[1]+'-'+str[0]);
        });

<input type="hidden" id="alt_date_field"> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-02T19:45:24.077

timepicker：jquery.datetimepicker 的 false

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-06T11:45:28.887

您需要添加以下选项：

**时间选择器：假**

（时间选择器必须小写）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T14:26:50.497

您必须像这样定义选项：

```
$('#id_start_date_time').datetimepicker({
    showTimePicker: false
}); 
```

要添加更多选项，您可以用逗号分隔：

```
$('#id_start_date_time').datetimepicker({
    showTimePicker: false,
    showSecond: true,
    timeFormat: 'hh:mm:ss'
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-12T15:21:10.993

我使用了“showTimepicker”：true，/“showTimepicker”：false，如果不需要，可以显示/隐藏时间选项。

有些页面有时间和没有时间选项，这就是我需要使用这个选项的原因。

当我将此设置为 false 时，它​​会按照设计的方式隐藏时间选项，但会覆盖

```
$.datepicker._base_gotoToday = $.datepicker._gotoToday; 
```

导致问题。当我点击今天/现在按钮时，它将日期设置为今天但隐藏了日历，当我再次点击输入框时没有任何反应，只有当我点击其他任何地方然后再次点击输入框时才会显示日历.

我已删除该行

```
$('.ui-datepicker-today', $dp).click(); 
```

这似乎解决了这个问题。

当我单击今天按钮时，它失去了关闭的能力，但我可以忍受

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-30T12:02:11.797

此代码工作正常：

```
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.min.css">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js"></script>

<input class="form-control" id="datetimepicker" type="text" name="date" placeholder="Date">

<script>
$('#datetimepicker').datetimepicker({
    format:'Y-m-d',timepicker: false,
});
</script> 
```

此外，包括 jquery 库

# jquery - $.post 变成了 GET

> ID：11506373
> 
> 赞同：0
> 
> 时间：2012-07-16T14:23:31.390
> 
> 标签：jquery, asp.net-mvc, post, get, request

我的 jQuery $.post 调用在我的环境中工作正常。但在生产中，$.posts 神秘地变成了 GET，返回 404。

开发人员调用：$.post('/Home/Destaques')（调用正常）

生产调用： $.post('/Home/Destaques') 产生 GET /Home/Destaques/ 404（未找到）

响应标头之间存在差异，即：

开发：服务器：Microsoft-IIS/7.0 X-AspNet-Version：4.0.30319 X-AspNetMvc-Version：2.0

生产：服务器：Microsoft-IIS/6.0 X-AspNet-Version:2.0.50727（无 AspNetMvc 标头）

为什么 POST 会变成 GET？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:26:15.033

`@Url.Action`在指定位置时使用。`Url.Action`这是发生问题的最好例子，也是在 MVC 中引入的主要原因。

**编辑-**

伙计 看看会发生什么，我们将 Url.Action 或 Url.Content 用于相同目的，因为它的部署方式可能不在根目录本身。

类比可以映射到-*当您在到达目的地的方式之间迷路时，您问某人到目的地的路，他回答{Right-Right-left-Right}，您就在那里。但是，如果您不在同一点上并遵循这种方式，这可能行不通。*

所以对于服务器来说也是一样的。当它在子站点上时，由于深度级别不同，它无法找到出路，并且当您更改它时它开始工作。所以，AFAIK就是这种情况。

阅读 Url.Action 文档。给出一个例子：[Scott Guthrie 的（MVC GURU）博客](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)

# jquery - jQuery 未在 ajax 加载的页面中加载

> ID：11506380
> 
> 赞同：0
> 
> 时间：2012-07-16T14:24:02.823
> 
> 标签：jquery, ajax, asp.net-mvc-3

我有一个“打印机友好版本”类型的页面，它使用 ajax 调用在新窗口中打开页面，如下所示：

```
$.ajax({
                type: "POST",
                url: actionURL + qs,       //qs is a query string
                data: $(this).serialize(),
                success: function (outputString) {
                    //$("#reportJSON").html(outputString).fadeIn();
                    var contentFromFirstPage = document.getElementById('reportArea').innerHTML;
                    var printContent = outputString;
                    var windowUrl = 'about:blank';
                    var uniqueName = new Date();
                    var windowName = 'Print' + uniqueName.getTime();
                    var printWindow = window.open("", windowName, 'scrollbars=1,menubar=1,height=800,width=600,resizable=1');
                    printWindow.focus();
                    printWindow.document.write(printContent);

                    printWindow.document.close();

                }
            }).error(function (response) {
                alert("something went wrong here with PrintPreview!!!" + response);
            }); 
```

但是我发现在新页面中，脚本没有正确加载，所以我得到一个`"jQuery is undefined"`错误。但是，当我重新加载页面时，页面加载正常。这让我相信 jQuery 可能只是在页面呈现之后才加载。有人知道我该如何解决这个问题吗？基本上我只需要确保页面开头有 jQuery。

# android - 无论如何以编程方式动画线性布局的布局权重属性

> ID：11506381
> 
> 赞同：21
> 
> 时间：2012-07-16T14:24:07.550
> 
> 标签：android, android-layout, android-linearlayout, android-animation

我在线性布局中有两个视图，我以编程方式更改了它们的 layout_weight 属性。有没有一种方法可以为这种重量变化设置动画，所以当重量改变时，视图会滑向新的尺寸？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2015-12-04T13:59:18.833

您可以简单地使用 ObjectAnimator。

```
ObjectAnimator anim = ObjectAnimator.ofFloat(
                viewToAnimate,
                "weight",
                startValue,
                endValue);
        anim.setDuration(2500);
        anim.start(); 
```

一个问题是 View 类没有 setWeight() 方法（ObjectAnimator 需要它）。为了解决这个问题，我编写了简单的包装器来帮助归档视图权重动画。

```
public class ViewWeightAnimationWrapper {
    private View view;

    public ViewWeightAnimationWrapper(View view) {
        if (view.getLayoutParams() instanceof LinearLayout.LayoutParams) {
            this.view = view;
        } else {
            throw new IllegalArgumentException("The view should have LinearLayout as parent");
        }
    }

    public void setWeight(float weight) {
        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) view.getLayoutParams();
        params.weight = weight;
        view.getParent().requestLayout();
    }

    public float getWeight() {
        return ((LinearLayout.LayoutParams) view.getLayoutParams()).weight;
    }
} 
```

以这种方式使用它：

```
 ViewWeightAnimationWrapper animationWrapper = new ViewWeightAnimationWrapper(view);
    ObjectAnimator anim = ObjectAnimator.ofFloat(animationWrapper,
                    "weight",
                    animationWrapper.getWeight(),
                    weight);
            anim.setDuration(2500);
            anim.start(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-25T16:28:38.450

我也一直在看这个。最终我通过动画父的 weightsum 属性解决了这个问题，如果你在 LinearLayout 中有两个视图，它会非常有用。

请参阅： [使用 ObjectAnimator 为 weightSum 属性设置动画](https://stackoverflow.com/questions/8341745/animating-weightsum-property-using-objectanimator)

在下面的示例中，如果您将 weightSum 从 1.0 设置为 2.0，Screen 2 将很好地显示在视图中。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/dual_pane"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal"
    android:weightSum="1.0">

<!-- Screen 1 -->
<LinearLayout
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:background="#ff0000"
    android:layout_weight="1">
</LinearLayout>

<!-- Screen 2 -->
<LinearLayout
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:background="#ff6600"
    android:layout_weight="1">
</LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-27T17:36:44.267

***注意：我不确定这是最好的方法，但我试过了，效果很好***

只需使用`ValueAnimator`

```
ValueAnimator m1 = ValueAnimator.ofFloat(0.2f, 0.5f); //fromWeight, toWeight
m1.setDuration(400);
m1.setStartDelay(100); //Optional Delay
m1.setInterpolator(new LinearInterpolator());
m1.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {
         @Override
         public void onAnimationUpdate(ValueAnimator animation) {
             ((LinearLayout.LayoutParams) viewToAnimate.getLayoutParams()).weight = (float) animation.getAnimatedValue();
             viewToAnimate.requestLayout();
         }

});
m1.start(); 
```

[更多关于`ValueAnimator`](https://developer.android.com/reference/android/animation/ValueAnimator.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-02T11:11:30.917

上面的所有答案都对我不起作用（它们只会“捕捉”而不是动画），但是在我将 weight_sum="1" 添加到父布局之后，它开始起作用了。以防万一其他人提出同样的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-03T18:50:26.860

另一种方法是使用旧`Animation`类，如[https://stackoverflow.com/a/20334557/2914140](https://stackoverflow.com/a/20334557/2914140)中所述。在这种情况下，您可以同时更改多个视图的权重。

```
private static class ExpandAnimation extends Animation {
    private final View[] views;
    private final float startWeight;
    private final float deltaWeight;

    ExpandAnimation(View[] views, float startWeight, float endWeight) {
        this.views = views;
        this.startWeight = startWeight;
        this.deltaWeight = endWeight - startWeight;
    }

    @Override
    protected void applyTransformation(float interpolatedTime, Transformation t) {
        float weight = startWeight + (deltaWeight * interpolatedTime);
        for (View view : views) {
            LinearLayout.LayoutParams lp = (LinearLayout.LayoutParams) view.getLayoutParams();
            lp.weight = weight;
            view.setLayoutParams(lp);
        }
        views[0].getParent().requestLayout();
    }

    @Override
    public boolean willChangeBounds() {
        return true;
    }
} 
```

# forms - Access 表单中的自动编号

> ID：11506393
> 
> 赞同：0
> 
> 时间：2012-07-16T14:24:47.420
> 
> 标签：forms, vba, ms-access-2010

我有一个可访问的表单，将数据保存在数据库中，我希望其中一个字段自动计算为 ID 中的下一个值，这样用户就不会写入 ID。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:27:05.127

使用自动编号数据类型创建表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:32:03.100

如果您手动创建表，则此语句

```
CREATE TABLE TableThatIncrements
(
    Id AUTOINCREMENT(1001,1)
) 
```

或者，您可以使用以下方法编辑现有表 ID 列：

```
ALTER TABLE TableThatIncrements
   ALTER COLUMN Id AUTOINCREMENT(1001,1) 
```

如果您不这样做，那么您可以通过 GUI 界面按照我提到的文章进行更改。请参阅本文中的步骤： [https ://superuser.com/questions/288087/how-do-i-set-the-first-value-of-autonumber-in-access](https://superuser.com/questions/288087/how-do-i-set-the-first-value-of-autonumber-in-access)

您可以通过执行以下操作在 Access 中运行查询：

```
Go to the "Create" tab and click "Query Design"

Just close the window that appears which asks you to select tables, we don't need that.

Go to the "Design" tab and click the button with the arrow until you get a textual input screen.  (By default, it says SELECT;).

Delete the default text and paste the above query.

Click "Run". 
```

# asp.net-mvc - ASP.NET MVC 3 - MultiSelectList 的 FormCollection

> ID：11506395
> 
> 赞同：0
> 
> 时间：2012-07-16T14:24:52.833
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

这是我正在尝试做的事情：

我正在尝试从 MultiSelectList 收集多个字符串值，并在 HttpPost 上创建一个新的、单独的数据库行，该行对应于关联模型的 MultiSelectList 中的每个值。

在本例中，我尝试为服务位置创建数据库条目（例如，在洛杉矶、圣地亚哥和旧金山提供服务的管道工）。所以他会进入我的应用程序并选择州：加利福尼亚，然后选择城市：洛杉矶、圣地亚哥、旧金山……这将创建三个新记录，每个记录都有一个新的 SPServiceLocationID：

SPServiceLocationID：1 SPCompanyAccountID：4 州：3 城市：洛杉矶

这是我的模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.ComponentModel.DataAnnotations;

namespace BidFetcher.Models
{
public class SPServiceLocation
{
public int SPServiceLocationID { get; set; }
public int SPCompanyAccountID { get; set; }

[Display(Name = "State")]
public string state { get; set; }

[Required]
[Display(Name = "Cities (select all that apply)")]
public string city { get; set; }

public virtual SPCompanyAccount SPCompanyAccount { get; set; }
}
} 
```

这是用于生成视图的控制器，在其中填充 MultiSelectList 没有问题：

```
public ActionResult Create()
{

    ViewBag.sessionName = HttpContext.Session["SPCompanyName"].ToString();

    var compID = HttpContext.Session["SPCompanyAccountID"].ToString();

    ViewBag.companyID = compID;

    ViewBag.state = new SelectList(simpleDB.simpleState, "simpleStateID", "simpleStateID");

    ViewBag.city = new MultiSelectList(simpleDB.simpleCity, "cityFull", "cityFull");

    return View();
} 
```

这是生成 MultiSelectList 的查看代码：

```
@Html.ListBox("city", ViewBag.city as MultiSelectList, new { @class = "chzn-select", data_placeholder = "Select cities..." }) 
```

最后，这是我用于发布到数据库的 Controller 数据，这是我认为我需要帮助的部分：

```
[HttpPost]
public ActionResult Create(SPServiceLocation spservicelocation, FormCollection formValues)
{
    if (ModelState.IsValid)
    {

        db.SPServiceLocation.Add(spservicelocation);
        db.SaveChanges();
        return RedirectToAction("Create", "SPServiceLocation");
    }

return View(spservicelocation); 
```

}

如果有人可以为我参考教程，或提供一些帮助，关于我如何在这种情况下处理 FormCollection 并修改我上面的 HttpPost 以便它创建多个整体？

我的知识非常基础，因此不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:29:22.693

这是一个应该有帮助的教程：

[http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)

你应该考虑放弃使用 ViewBag 并使用 ViewModels 来处理你的信息（它会让你的生活更轻松）：

[ViewModel 最佳实践](https://stackoverflow.com/questions/664205/viewmodel-best-practices)

# android - 定期从android调用.net webservice

> ID：11506397
> 
> 赞同：0
> 
> 时间：2012-07-16T14:25:07.060
> 
> 标签：android, asp.net, web-services, ksoap2

我有一个 android 应用程序，它调用托管在 asp.net 应用程序中的简单 .asmx Web 服务来获取数据并显示它。我正在使用 ksoap2，它运行良好，在我调用 webService 的主要活动中。但我的问题是我想每 30 分钟调用一次该 .asmx Web 服务并获取要显示的数据。我已经搜索并找到了 timertask 类，但我不确定它是否适合我想做的事情。有什么建议么？非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:42:01.460

看看计划任务服务：http: [//developer.android.com/reference/java/util/concurrent/ScheduledExecutorService.html](http://developer.android.com/reference/java/util/concurrent/ScheduledExecutorService.html)

它将让您每 x 秒设置一个重复事件，并将继续运行该任务，直到您告诉它停止。

我发现它很容易设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:51:14.187

您应该有一个服务来为您执行此操作，创建一个服务，并且在该服务中您可以安排一个线程每 30 分钟调用一次您的 web 服务，即使您的应用程序没有运行。[这](http://marakana.com/forums/android/examples/60.html)是关于如何使用服务让您入门的好教程。这是关于[如何](https://stackoverflow.com/questions/4015866/why-use-a-android-service)以及何时使用服务的有用链接。请考虑通过单击左侧绿色勾选图标来接受答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T15:17:11.917

很抱歉回答我自己的问题，谢谢你的帮助。我找到了一个解决方案，我按照[本教程](http://www.sschauhan.com/index.php?option=com_content&view=article&id=21%3acreating-service&catid=6%3aandroid-category&Itemid=3)进行了操作，并且效果很好。

希望这会有所帮助。

# objective-c - NSTimer 未及时触发

> ID：11506398
> 
> 赞同：0
> 
> 时间：2012-07-16T14:25:12.573
> 
> 标签：objective-c, ios, networking, nstimer, nsstream

我正在尝试连接到给定 IP 地址上的端口。一个问题是，当使用不存在的 IP 地址建立连接时，写入命令（如下所示）：

```
NSData * imageRequest = [@"640" dataUsingEncoding: NSUTF8StringEncoding];

int image = [self.outputImageStream write:[imageRequest bytes] maxLength:[imageRequest length]]; 
```

响应时间超过 75 秒。我尝试通过使用以下方法调用启动计时器来处理此问题：

```
self.connectionTimeoutTimer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(respondToTimer:)userInfo:nil repeats:NO]; 
```

它不会在我定义的 1 秒间隔内调用。

有什么办法可以确保计时器在 1 秒内触发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:30:13.290

这可能会回答您关于[NSTimer 实时行为](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html)的问题：

> 定时器不是实时机制；它仅在已添加计时器的运行循环模式之一正在运行并且能够检查计时器的触发时间是否已过时触发。由于典型的运行循环管理的各种输入源，计时器的时间间隔的有效分辨率被限制在 50-100 毫秒的数量级。如果计时器的触发时间发生在长时间调用期间或运行循环处于不监视计时器的模式下，则计时器不会触发，直到运行循环下次检查计时器。因此，定时器触发的实际时间可能是计划触发时间之后的一个重要时间段。

您没有指定如何安排 NSTimer，但如果您安排它`NSRunLoopCommonModes`而不是`NSRunLoopDefaultModes`：

```
[[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes]; 
```

如果这不能改善情况，那么您应该寻找较低级别的替代方案。

特别是，您可能会查看[`CADisplayLink`](http://developer.apple.com/library/ios/#documentation/QuartzCore/Reference/CADisplayLink_ClassRef/Reference/Reference.html)：

> CADisplayLink 对象是一个计时器对象，它允许您的应用程序将其绘图与显示器的刷新率同步。

它可以以与 NSTimer 非常相似的方式使用。

CADisplayLink 的优势在于它与刷新率相关联，因此它应该在 1/60 秒的时间间隔内提供相当可靠的行为。

CADisplayLink 的使用示例：

```
CADisplayLink* displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(respondToTimer)];
[displayLink setFrameInterval:60];
[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes]; 
```

这将调用`respondTimer`每 60 个刷新帧，即每秒一次。由于您希望只调用一个方法，因此可以使用：

```
dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 1.0 * NSEC_PER_SEC),
                           dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
                               [self respondToTimer];
                           }); 
```

这对你来说可能会更容易。（当然，您可以用该方法的完整实现替换对 [self respondToTimer] 的调用）。

# string - 内存分配和释放

> ID：11506399
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:25:15.007
> 
> 标签：string, oop, memory-management, memory-leaks

这是整个程序，请帮助我，我已经尝试了一切来找出内存到底发生了什么。问题是一切都运行得很好，但是输出时打印了一些额外的字符。

这是.h文件：

```
 class MyString
 {
    public:
            MyString();
            MyString(const char *message);
            MyString(const MyString &source);
            ~MyString();
            const void Print() const;
            const int Length() const;
            MyString& operator()(const int index, const char b);
            char& operator()(const int i);

            MyString& operator=(const MyString& rhs);
            bool operator==(const MyString& other) const;
            bool operator!=(const MyString& other) const;
            const MyString operator+(const MyString& rhs) const;
            MyString& operator+=(const MyString& rhs);
            friend ostream& operator<<(ostream& output, const MyString& rhs);
            const int Find(const MyString& other);
            MyString Substring(int start, int length);

    private:
            char *String;
            int Size;

 };

 istream& operator>>(istream& input, MyString& rhs); 
```

.cpp 文件：

```
 MyString::MyString()
 {
    char temp[] = "Hello World";

    int counter(0);
    while(temp[counter] != '\0')
    {
            counter++;
    }
    Size = counter;
    String = new char [Size];
    for(int i=0; i < Size; i++)
            String[i] = temp[i];

 }

 //alternate constructor that allows for setting of the inital value of the string

  MyString::MyString(const char *message)
  {
    int counter(0);
    while(message[counter] != '\0')
    {
            counter++;
    }
    Size = counter;
    String = new char [Size];
    for(int i=0; i < Size; i++)
            String[i] = message[i];
 }

 //copy constructor
 MyString::MyString(const MyString &source)
 {

    int counter(0);
    while(source.String[counter] != '\0')
    {
       counter++;
    }
    Size = counter+1;
    String = new char[Size];
    for(int i = 0; i <= Size; i++)
            String[i] = source.String[i];

 }

 //Deconstructor
 MyString::~MyString()
 {
    delete [] String;
 }

 //Length() method that reports the length of the string
 const int MyString::Length() const
 {
    int counter(0);

    while(String[counter] != '\0')
    {
            counter ++;
    }
    return (counter);
 }

 /*Parenthesis operator should be overloaded to replace the Set and Get functions of  your previous assignment. Note that both instances should issue exit(1) upon violation of the string array bounaries.
 */

    MyString& MyString::operator()(const int index, const char b)
    {
    if(String[index] == '\0')
    {
            exit(1);
    }
    else
    {
            String[index] = b;
    }
 }

 char& MyString::operator()(const int i)
 {
    if(String[i] == '\0')
    {
            exit(1);
    }
    else
    {
            return String[i];
  }
 }
 /*Assignment operator (=) which will copy the source string into the destination string. Note that size of the destination needs to be adjusted to be the same as the source.
 */

 MyString& MyString::operator=(const MyString& rhs)
 {
    if(this != &rhs)
    {
            delete [] String;
            String = new char[rhs.Size];
            Size = rhs.Size;

            for(int i = 0; i < rhs.Size+1 ; i++)
            {
                    String[i] = rhs.String[i];
            }
    }

    return *this;
 }
 /*Logical comparison operator (==) that returns true iff the two strings are identical in size and contents.
 */

  bool MyString::operator==(const MyString& other)const
  {
    if(other.Size == this->Size)  {         
        for(int i = 0; i < this->Size+1; i++)
            {
                    if(&other == this)
                            return true;
            }
    }
    else
            return false;
 }

 //Negated logical comparison operator (!=) that returns boolean negation of 2

 bool MyString::operator!=(const MyString& other) const
 {
    return !(*this == other);
 }

 //Addition operator (+) that concatenates two strings

 const MyString MyString::operator+(const MyString& rhs) const
 {
    char* tmp = new char[Size + rhs.Size +1];

    for(int i = 0; i < Size; i++)
    {
            tmp[i] = String[i];
    }
    for(int i = 0; i < rhs.Size+1; i++)   {           
        tmp[i+Size] = rhs.String[i];
    }

    MyString result;

    delete [] result.String;
    result.String = tmp;
    result.Size = Size+rhs.Size;

    return result;
 }
 /*Addition/Assigment operator (+=) used in the following fashion: String1 += String2 to operate as String1 = String1 + String2
 */

 MyString& MyString::operator+=(const MyString& rhs)
  {
    char* tmp = new char[Size + rhs.Size + 1];

    for(int i = 0; i < Size; i++)        {
            tmp[i] = String[i];
    }
    for(int i = 0; i < rhs.Size+1; i++)
    {
            tmp[i+Size] = rhs.String[i];
    }

    delete [] String;
    String = tmp;
    Size += rhs.Size;

    return *this;
 }

 istream& operator>>(istream& input, MyString& rhs)
 {
    char* t;
    int size(256);
    t = new char[size];
    input.getline(t,size);

    rhs = MyString(t);
    delete [] t;

    return input;
 }

 ostream& operator<<(ostream& output, const MyString& rhs)
 {
    if(rhs.String != '\0')
    {
            output << rhs.String;
    }
    else
    {
            output<<"No String to output\n";
    }

    return output;
 }

 /*MyString::Find that finds a string in a larger string and returns the starting location of the substring. Note that your string location starts from 0 and ends at length -1\. If the string is not found, a value of -1 will be returned
 */

 const int MyString::Find(const MyString& other)
 {

    int nfound = -1;

    if(other.Size > Size)
    {
            return nfound;
    }   
      int i = 0, j = 0;      
      for(i = 0; i < Size; i++)    {            
        for(j = 0; j < other.Size; j++)  {            
             if( ((i+j) >= Size) || (String[i+j] != other.String[j]) )

                    {
                            break;
                    }

            }

            if(j == other.Size)
            {

                    return i;

            }

      }

    return nfound;
 }
 /*MyString::Substring(start, length). This method returns a substring of the original string that contains the same characters as the original string starting at location start and is as long as length.
 */

 MyString MyString::Substring(int start, int length)
 {
    char* leo = new char[length+1];
    for(int i = start; i < start + length+1; ++i)
    {
            leo[i-start] = String[i];
    }

    MyString sub;
    delete [] sub.String;        sub.String = leo;        sub.Size = Size;
    return sub;
 }

  //Print() method that prints the string

 const void MyString::Print() const
 {

    for(int i=0; i < Size; i++)
    {
            cout<<String[i];
    }
    cout<<endl;
 } 
```

main.cpp 文件：

```
 int main (int argc, char **argv)
 {

   MyString String1; 

  const MyString ConstString("Target string");    //Test of alternate constructor

   MyString SearchString;  //Test of default constructor that should set "Hello World".

 MyString TargetString (String1); //Test of copy constructor

   cout << "Please enter two strings. ";
  cout << "Each string needs to be shorter than 256 characters or terminated by /\n." << endl;
 cout << "The first string will be searched to see whether it contains exactly the second string. " << endl;

  cin >> SearchString >> TargetString; // Test of cascaded string-extraction operator

   if(SearchString.Find(TargetString) == -1) {

    cout << TargetString << " is not in " << SearchString << endl;
    }

  else {

    cout << TargetString << " is in " << SearchString << endl;

    cout << "Details of the hit: " << endl;

    cout << "Starting position of the hit: " << SearchString.Find(TargetString) << endl;
    cout << "The matching substring is: " << SearchString.Substring(SearchString.Find(TargetString), TargetString.Length()-1)<<"\n";
    }
  return 0;

 } 
```

运行程序你得到这个：

请输入两个字符串。每个字符串必须少于 256 个字符或以 / 结尾。将搜索第一个字符串以查看它是否正好包含第二个字符串。

第一

真实的

房地产世界不在第一

请帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:31:46.610

@Sam 的回答是正确的。我将添加它以帮助您了解正在发生的事情。

C 和 C++ 字符串实际上是遵循字符串以 终止的约定的字符数组`\0`，有时称为 NUL（*非*空），它是一个所有位都为 0 的字符。

您的代码的第一部分是正确的，因为它创建了一个字符数组。但是，您不应用字符串必须以 NUL 终止的*约定。*

然后，您将不遵循 NUL 终止约定的字符串传递给`cout`，它*确实*遵循该约定。换句话说，它遍历字符串，将每个字符打印到`stdout`，直到它*发生*`\0`在内存中的字符上。它终止实际上是相当幸运的。如果它输出的字符数组中没有 a `\0`，它将继续运行，直到到达不属于您的程序的内存地址并因分段错误而失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:52:54.090

`MyString::MyString(const char *message)`尝试在构造函数的字符串末尾添加 '\0'

# database - 表单信息到另一台服务器上的数据库

> ID：11506401
> 
> 赞同：1
> 
> 时间：2012-07-16T14:25:20.973
> 
> 标签：database, registration

我有两个网站；`website1.com`和`website2.com`。我`website1`有包含客户信息的数据库和一个简洁的 CMS。现在我想在 上制作一个注册表`website2`并将该信息插入到数据库中`website1`。

这可能吗？我可以简单地使用`mysql INSERT INTO~`吗？还是我需要使用其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:28:29.367

您可以远程连接到另一台服务器：

```
mysql -h host_name -D db_name -ppassword -c "insert into ..." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:28:04.003

如果您的网站位于不同的机器上，您需要允许 MySQL 远程连接。[*保护远程 MySQL*](https://stackoverflow.com/questions/9004249/securing-remote-mysql-connection)

在这两种情况下（远程或本地），方法是相同的：[打开](http://php.net/manual/en/function.mysql-connect.php)到 website1 的数据库的连接并使用`INSERT INTO`.

# c# - 从 2 个 mySQL 表动态创建表并允许更新

> ID：11506404
> 
> 赞同：0
> 
> 时间：2012-07-16T14:25:25.553
> 
> 标签：c#, html, mysql, asp.net

我拥有的是两个 mysql 表，例如：

```
Table 1:

----------------
|  ID |  Time  |
****************
| 1  | 3:00pm  | 
----------------    
| 2  | 4:00pm  | 
----------------
| 3  | 5:00pm  | 
----------------
| 4  | 6:00pm  |
 ---------------
| 5   7:00pm   |    
================ 

Table 2:
----------------
|  ID  |  Type |
****************
|  1   |   A   |
----------------    
|  2   |   B   | 
----------------
|  3   |   C   | 
----------------
|  4   |   D   |
----------------
|  5   |   E   |    
================ 
```

我基本上想要实现的是在 ASP.NET 中有一个表单，它将类别显示`A,B,C,D,E`为顶部的列，左侧的时间与每个单元格的文本框，以便我可以放置一个值，然后更新另一个表映射分配。EG 类别 A 下午 3 点有 5 个等。

这可能吗？此外，类别和/或时间可能会有所不同，因此必须根据从 select 语句中检索到的值来创建表。

*编辑*

在 Excel 中快速散列以显示我的意思，所以基本上它根据从 mySQL 检索到的内容创建行和列。然后我可以在每个单元格的文本框中键入并单击一个更新按钮，该按钮将值存储在我用于分配的单独表中。

![图像1](../Images/07d225cfccfd8dc7b8717b7387838ded.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-26T05:04:00.983

您可能需要有一个作为主键的 ID，然后是每个表的另一组 ID，这将是一个外键才能正常工作。比如ID > 主键，TypeID(for type table) > foreign key 对应时间，TimeID(for time table) > foreign key 对应类型。这真的是我看到您合并表格以进行更新的唯一方式。现在将其放入网格视图中，可能是另一个问题。为此，我建议您参考：[如何合并两个表](http://forums.asp.net/t/1668955.aspx/1)

# selenium - phpunit selenium 获取打开的 url 的标头信息

> ID：11506407
> 
> 赞同：2
> 
> 时间：2012-07-16T14:25:38.207
> 
> 标签：selenium, header, phpunit

我正在使用[phpunit](https://github.com/sebastianbergmann/phpunit/)和[selenium](http://www.phpunit.de/manual/3.6/en/selenium.html)为我的项目编写一些功能测试。我正在寻找的是检索响应标头的方法

有些 URL 没有`.js`扩展名，但返回 javascript 作为代码。

我正在寻找的是用函数`content-type`打开的 URL 的标头信息（尤其是 ）`$this->open();`

例如：

```
//if I do
$this->open('http://stackoverflow.com');
// or
$this->open('http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js')

// and then use some function like
$this->getResponseHeaders();
// returns me array of header information or
// some function just for content type
$this->getContentType();
// which return text/html or text/javascript 
```

selenium 是否有任何方式提供此功能或破解或获取详细信息的技巧。我浏览了 selenium 文档和 TestCase 文件，但没有找到任何接近它的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-07T05:50:29.450

很难过，但你不能。phpunit[不允许，](https://github.com/sebastianbergmann/phpunit-selenium/issues/199)因为[WebDriver 不允许](http://code.google.com/p/selenium/issues/detail?id=141)。

> 我们不会将此功能添加到 WebDriver API，因为它超出了我们当前的范围（模拟用户操作）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T14:40:52.903

如果我理解您的问题，您需要以下两个步骤：

```
$this->open('http://stackoverflow.com');
$htmltext = $this->getHtmlSource(); 
```

然后你可以通过拆分htmltext来获取信息......

# c# - WCF 客户端：限制对 BeginGetX 的调用，直到调用 EndGetX

> ID：11506412
> 
> 赞同：0
> 
> 时间：2012-07-16T14:26:02.883
> 
> 标签：c#, asynchronous, thread-safety, mutex

在我的 winforms 客户端应用程序中，我为我的 WCF 服务（开始...和结束...）生成了异步方法。

当应用程序启动时，它对服务器进行异步调用以获取和缓存稍后将在应用程序中使用的数据（例如国家列表）。

如果应用程序的主线程在异步调用有机会完成之前需要这些数据（例如填充组合框），我想阻塞主线程直到异步调用结束。我想避免对 WCF 服务器进行冗余调用。

我曾尝试使用 Monitor/Mutex，`Monitor.Enter(countryLock)`然后`BeginGetCountries`在主线程中以及`Monitor.Exit(countryLock)`在调用该`EndGetCountries`方法时调用。但是，我面临以下异常：

> 对象同步方法是从未同步的代码块中调用的。

我应该调用调用`Monitor.Exit(...)`的同一个线程`Monitor.Enter(...)`吗？如果是，我如何知道`Monitor`对象的所有者并在其上下文中进行调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T20:32:38.317

就像 Peter Richie 所说，你不想锁定你的 UI 线程。真的，您只需要一个“忙碌”标志。

其次，尝试像您描述的那样使用 Monitor.Enter 执行此操作是行不通的，因为允许同一个线程两次进入同一个监视器而不会阻塞。

如果您确实锁定，那么是的，您应该在调用 Monitor.Enter(...) 的同一线程上调用 Monitor.Exit(...)。如果这是唯一的问题，您可以使用 this.BeginInvoke() 将其编组回 UI 线程。但就像我说的，在单线程场景中使用 Monitor 锁定是没有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T20:23:48.770

不，您不想真正阻塞主线程。您想要做的是设置一个操作处于挂起状态的标志，并禁用取决于结果的 UI 部分。当从异步 WCF 操作返回结果时，您可以启用 UI 的这些部分并填充数据。

*如果*您阻塞主线程，它会显示应用程序已停止，这对您的用户来说将是一个糟糕的体验。

# php - 如何在启动时调用 index.php

> ID：11506429
> 
> 赞同：0
> 
> 时间：2012-07-16T14:26:57.733
> 
> 标签：php, html

我只有通过键入以下内容才能显示我的网站：[www.example.com/index.php](http://www.mywebsite.com/index.php)

键入时：[www.example.com](http://www.mywebsite.com)没有任何反应。

如何`index.php`通过键入我的网站地址来调用启动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:29:12.910

创建一个 .htaccess 文件并将其放在您的服务器根目录中。将以下内容添加到文件中：

```
DirectoryIndex index.php index.html index.htm 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:31:13.473

在`server`您的 nginx.conf 部分（或它包含的任何文件）中，确保您有以下行：

```
index index.php; 
```

你正在运行 nginx，不是吗？;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:31:55.713

虽然您没有在您的网络服务器上提供任何技术细节，但我建议您查看[DirectoryIndex](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)。

> 当客户端通过在目录名称末尾指定 / 来请求目录索引时，DirectoryIndex 指令设置要查找的资源列表。Local-url 是服务器上文档相对于请求目录的（% 编码的）URL；它通常是目录中文件的名称。可能会给出几个 URL，在这种情况下，服务器将返回它找到的第一个。如果不存在任何资源并且设置了 Indexes 选项，则服务器将生成自己的目录列表。

例子：

```
DirectoryIndex index.html index.php 
```

[对http://mysite.com/docs/](http://mysite.com/docs/)的请求如果存在则返回[http://mysite.com/docs/index.php](http://mysite.com/docs/index.php)，如果不存在则列出目录。

# jquery - 使用 jQuery 更改响应式站点中的 HTML 结构

> ID：11506430
> 
> 赞同：1
> 
> 时间：2012-07-16T14:27:00.510
> 
> 标签：jquery, append, structure, responsive-design

我在这里遇到了一些问题，设计师坚持某个设计已经完成，并用我们都知道的开发人员说它可以完成但你做不到。

我认为这是不可能的，但是在这里阅读了有关使用 jQuery .append 的信息，所以它很可能毕竟是。任何建议都会非常感谢。

这是我的代码：

```
<section id="technologies">
   <ul>
       <li class="technology" id="ddTechnology1">
    <div class="technologyTitle">Title1</div>
   </li>
   <li class="technology" id="ddTechnology2">
    <div class="technologyTitle">Title2</div>
   </li>
   <li class="technology" id="ddTechnology3">
    <div class="technologyTitle">Title3</div>
   </li>
   <li class="technology" id="ddTechnology4">
    <div class="technologyTitle">Title4</div>
   </li>
   </ul>
</section>
<div id="ddWrapper">
    <div id="ddContent" class="targetDiv">
         Content Content
    </div>
</div> 
```

ul 是 4 个浮动的左白框，每个框都有一个图像。下方的 div 只是与 . 相同的一段内容。

该站点是一个响应式站点，因此当它缩小为平板电脑视图时，四个左侧浮动的 li 会变成两排两排，并且在智能手机视图中一个堆叠在另一个之上。

在每个视图中，该部分下方的 div 只是调整大小以适应并重新排列内容。

设计师不高兴，因为他的设计说在 960px 视图中， div id="ddWrapper" 在四个左对齐框的下方；在平板电脑 600px 视图中，div 必须位于两行之间，而在智能手机 320px 视图中，它必须位于第一个 li 之下。

对我来说，这不是一个响应式布局，但我一直在尝试使用 jQuery 将兔子从帽子中拉出来，让设计师开心。

有没有办法使用 jQuery 的 append() 根据当前布局将 div id="ddWrapper" 移动到 HTML 中的不同位置？这个问题已经超出了我目前对 jQuery 的了解，所以我寻求任何人都可以提供的帮助。

干杯

坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:40:03.570

实现这一点的最简单方法可能是多次包含某些内容并仅显示：无；你不想要的内容。IE

```
<section class="desktop-technologies">
   <ul>
       <li class="technology" id="ddTechnology1">
    <div class="technologyTitle">Title1</div>
   </li>
   <li class="technology" id="ddTechnology2">
    <div class="technologyTitle">Title2</div>
   </li>
   <li class="technology" id="ddTechnology3">
    <div class="technologyTitle">Title3</div>
   </li>
   <li class="technology" id="ddTechnology4">
    <div class="technologyTitle">Title4</div>
   </li>
   </ul>
</section>

<section class="tablet-technologies">
  <ul>
       <li class="technology" id="ddTechnology1">
    <div class="technologyTitle">Title1</div>
   </li>
   <li class="technology" id="ddTechnology2">
    <div class="technologyTitle">Title2</div>
   </li>
 </ul>
</section>

<section class="mobile-technologies">
  <ul>
       <li class="technology" id="ddTechnology1">
    <div class="technologyTitle">Title1</div>
   </li>
 </ul>
</section>

<div id="ddWrapper">
    <div id="ddContent" class="targetDiv">
         Content Content
    </div>
</div>

<section class="tablet-technologies">
  <ul>
   <li class="technology" id="ddTechnology3">
    <div class="technologyTitle">Title3</div>
   </li>
   <li class="technology" id="ddTechnology4">
    <div class="technologyTitle">Title4</div>
   </li>
   </ul>
</section>

<section class="mobile-technologies">
  <ul>
   <li class="technology" id="ddTechnology2">
    <div class="technologyTitle">Title2</div>
   </li>
   <li class="technology" id="ddTechnology3">
    <div class="technologyTitle">Title3</div>
   </li>
   <li class="technology" id="ddTechnology4">
    <div class="technologyTitle">Title4</div>
   </li>
   </ul>
</section> 
```

那么你可以申请：

```
.tablet-technologies, .mobile-technologies {
    display:none;
} 
```

适当的部分显示适当的样式。

这不是最干净的解决方案，但它不会增加文件大小的太多开销，并且无需 javascript 即可控制。

希望有帮助！

# c# - WCF 提高性能并停止阻塞

> ID：11506433
> 
> 赞同：0
> 
> 时间：2012-07-16T14:27:01.987
> 
> 标签：c#, wcf

我有一个客户端-服务器应用程序，可以将市场数据从服务器传送到客户端。现在我遇到了两个问题： 1\. 糟糕的回调性能。我达到了每秒最多 1.5K 回调 2\. 当一个客户端开始“卡住”时 - 所有用户开始缓慢地检索数据（每秒 200 次回调）。这是我的服务器绑定：

```
<netTcpBinding>
<binding name="Net_Tcp_Binding" receiveTimeout="10:00:00" sendTimeout="00:00:30"
  maxConnections="100">
 <readerQuotas maxArrayLength="2147483647" />
 <security mode="None" />
</binding>
   </netTcpBinding> 
```

和服务合同（95% 的数据使用 MarketDepthUpdate 和 EntityUpdate 交付）：

```
namespace TradePlatform.DataDeliveryContracts.ServiceContracts

public interface ITradeServiceCallback
{
    [OperationContract(IsOneWay = true)]
    void InstrumentUpdate(InstrumentInfo instrument);

    [OperationContract(IsOneWay = true)]
    void OrderUpdate(OrderInfo order);

    [OperationContract(IsOneWay = true)]
    void OrderFailedUpdate(OrderFailInfo orderFailed);

    [OperationContract(IsOneWay = true)]
    void MyTradeUpdate(MyTradeInfo myTrade);

    [OperationContract(IsOneWay = true)]
    void TradeUpdate(TradeInfo trade);

    [OperationContract(IsOneWay = true)]
    void PortfolioUpdate(DSPortfolioInfo portfolio);

    [OperationContract(IsOneWay = true)]
    void PositionUpdate(PositionInfo position);

    [OperationContract(IsOneWay = true)]
    void MarketDepthUpdate(MarketDepthShortInfo marketDepth);

    [OperationContract(IsOneWay = true)]
    void DisconnectUser();

    [OperationContract(IsOneWay = true)]
    void UserUpdate(UserInfo user);

    [OperationContract(IsOneWay = true)]
    void FileUpdate(FileDataInfo file);

    [OperationContract(IsOneWay = true)]
    void SimulationDataUpdate(SimulationModeData simulationData);

    [OperationContract(IsOneWay = true)]
    void MessageUpdate(MessageId message, params object[] parameters);

    [OperationContract(IsOneWay = true)]
    void EntityUpdate(DataUpdateInfo updateInfo);

    [OperationContract(IsOneWay = true)]
    void Ping();

} 
```

这是客户：

```
NetTcpBinding binding = new NetTcpBinding
        {
            Security = { Mode = SecurityMode.None },
            MaxReceivedMessageSize = 2147483647
        };
        binding.ReaderQuotas = new XmlDictionaryReaderQuotas();
        binding.ReaderQuotas.MaxArrayLength = 2147483647;
        binding.ReceiveTimeout = new TimeSpan(0, 10, 0);
        binding.SendTimeout = new TimeSpan(0, 10, 0); 
```

# python - 根据 ID 在 Django 中加载页面

> ID：11506437
> 
> 赞同：0
> 
> 时间：2012-07-16T14:27:10.910
> 
> 标签：python, django, django-templates, django-views

我一直在使用 Django 来制作我的作品集，并且我已经成功地制作了一个简单的页面管理器。问题是，它不能按照我希望的方式工作：

1.  我创建页面。
2.  它加载我给它的内容。
3.  使用 jQuery，我只加载该内容（作为格式化的 HTML）。
4.  它无需重新加载或移动到另一个页面即可显示自己。

问题在于最后两个步骤，我无法让视图和模板仅加载一个。

视图.py：

```
def paginas(request, title):
    get_page = Page.objects.all() # I can't think of a way to make a proper filter
    return render_to_response('template.html', {'get_page': get_page}, context_instance=RequestContext(request), mimetype="text/html") 
```

模板.html：

```
{% if get_page %}
    {% for page in get_page %}
            {{ page.content|safe }}
            <p>Full path is {{ request.get_full_path }} and page id is {{ page.id }}</p>
    {% endfor %}
{% else %}
    <p>Nothing.</p>
{% endif %} 
```

我知道我应该过滤它，但我不知道如何。

我感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:33:27.977

tbh，django[教程](https://docs.djangoproject.com/en/dev/intro/tutorial03/#design-your-urls)非常清楚地解释了 url、参数和表单，但这里的想法是：

```
url(r'^/someapp/(?P<page_id>\d+)/$', paginas),

def paginas(request, **kwargs):
    id = kwargs.pop('page_id')
    page = get_object_or_404(Page, id=id)
    # etcetera

class Page(models.Model):
    # regular stuff
    def get_absolute_url(self):
        return "/someapp/%d/" % self.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:00:50.130

在`paginas`你显然得到所有的页面。

要获得一页，您可以使用该`get`功能

```
def paginas(request, title):
   try:
     your_page = Page.objects.get(title=title)
   except Page.DoesNotExist:
     # error no page for that title
     # could use built in get_object_or_404 as ArgsKwargs suggested 
```

考虑使用 slug 以确保编码正确也很重要。页面ID会更好用

# asp.net - 子文件夹中重写的 404/500 错误页面无法解析 CSS/链接

> ID：11506438
> 
> 赞同：0
> 
> 时间：2012-07-16T14:27:11.760
> 
> 标签：asp.net, iis, webforms

我的 web.config 文件中有以下内容：

```
<httpErrors errorMode="Custom" existingResponse="Replace">
    <remove statusCode="404" subStatusCode="-1" />
    <remove statusCode="500" subStatusCode="-1" />
    <error statusCode="404" path="/ErrorPage.aspx?status=404" responseMode="ExecuteURL" />
    <error statusCode="500" path="/ErrorPage.aspx?status=500" responseMode="ExecuteURL" />
</httpErrors> 
```

我想在遇到错误时重写 URL，而不是重定向到错误页面，因为我注意到人们点击 404 页面，被重定向到 404 页面，然后继续刷新 404 页面。我认为重写是一个更好的解决方案。

如果我去[http://mysite.com/blahblahblah](http://mysite.com/blahblahblah) (a 404)，上面的配置就可以工作。但是，如果我访问[http://mysite.com/foo/blahblahblah](http://mysite.com/foo/blahblahblah) ，则会显示错误/404 页面，但是所有链接和 CSS 都是从 /foo 而不是 Web 根目录解析的，因此页面显示为没有样式。（甚至来自 /App_Themes 文件夹的 CSS 文件，通常根据子文件夹重写）

我的 web.config 中有几个 URL 重写，它们重写了根目录中的一些文件，使其看起来像一个子文件夹，并且 CSS/链接在那里被正确解析：

```
<rewrite>
    <rules>
        <clear />
        <rule name="Rewrite Products" stopProcessing="true">
            <match url="^p([0-9]+)/([_0-9a-z-]+).aspx" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false" />
            <action type="Rewrite" url="Product.aspx?pID={R:1}&amp;pName={R:2}" appendQueryString="false" />
        </rule> 
```

[因此http://mysite.com/p145/product.aspx](http://mysite.com/product.aspx)的 URL显示[http://mysite.com/product.aspx](http://mysite.com/p145/product.aspx)的页面，所有 CSS/链接都正确。

链接和 CSS（我在 ASP 中使用 ~ 运算符解析）始终正确显示有效的子文件夹（因此在[http://mysite.com/Admin](http://mysite.com/Admin)查看时，我网站根目录中的链接将指向[http ://mysite.com/someLink](http://mysite.com/someLink)，而不是[http://mysite.com/Admin/someLink](http://mysite.com/Admin/someLink)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:41:33.930

只需使用 ResolveUrl 包装您的链接，它就会始终解析到根目录。

```
hyperlink1.NavigateUrl = ResolveUrl("~/path/page.aspx") 
```

您也可以使用如下样式表执行此操作：

```
<link href="<%=ResolveUrl("~/resources/global.css")%>" rel="stylesheet" type="text/css" /> 
```

并使用这样的脚本：

```
<script src="<%=ResolveUrl("~/resources/myscript.js")%>" type="text/javascript"></script> 
```

# c# - 如何获得 FrameworkElement 的真实位置？

> ID：11506443
> 
> 赞同：0
> 
> 时间：2012-07-16T14:27:51.043
> 
> 标签：c#, .net, wpf, position, frameworkelement

我正在做`rotationTransform`并且`scaleTransform`在用户控件内的椭圆中。我已经尝试过了，但没有奏效。

```
Point myUiElementPosition = 
   ellipse.TransformToAncestor(this.Parent as Panel).Transform(new Point(0, 0)); 
```

我正在使用鼠标旋转对象，但上面的代码总是返回相同的值！

我究竟做错了什么？我已经尝试将`App.Current.MainWindow`而不是`this.Parent as Panel`.

我也尝试使用`this`而不是`ellipse`.

帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:19:43.187

使用`ellipse.Parent`而不是`this.Parent`. 我希望这将有所帮助。

# visual-studio-2008 - VSS/VC++ 集成：需要检查 SLN/VCPROJ

> ID：11506448
> 
> 赞同：1
> 
> 时间：2012-07-16T14:27:59.073
> 
> 标签：visual-studio-2008, visual-c++, visual-sourcesafe

使用与 VC++ 2005 的 VSS 集成，每次我想绑定项目以使用集成时，似乎都需要检查 SLN/VCPROJ 文件，以便它可以将源代码控制数据添加到这些文件中。

这看起来很奇怪，为什么 VCS 需要将元数据放入我的文件中？当我使用其他 VCS 集成时，这还没有发生。

是否可以在不这样做的情况下简单地启用集成（我们必须考虑执行的任何提交）？

*不，摆脱 VSS 不是一种选择！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:55:10.673

vcproj 文件（有时还有 sln 文件）包含您将项目绑定到的数据库和路径。这些条目看起来像这样：

```
<SccProjectName>"$/MyProject.root/MyProject", CAAAAAAA</SccProjectName>
<SccLocalPath>.</SccLocalPath>
<SccProvider>MSSCCI:Microsoft Visual SourceSafe</SccProvider> 
```

所以要绑定你的项目 Visual Studio 需要编辑 vcproj 文件。这就是它的工作方式，没有办法改变它。

这样做的副作用是，当您分支项目时，您需要记住编辑分支的 vcproj 和 sln 文件，并更新它们以指向新分支。

# iphone - 无效的权利 iTunes

> ID：11506453
> 
> 赞同：0
> 
> 时间：2012-07-16T14:28:16.050
> 
> 标签：iphone, ios, ipad, itunes

当我尝试通过 iTunes 安装 iPhone 应用程序时出现以下错误：

权利无效。

此错误的可能原因是什么？以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:08:32.987

尝试从 iTunes 中删除配置文件，并生成新的，然后将其添加到 iTunes，然后将授权文件添加到 iTunes，它应该可以工作

# objective-c - UInavigationbar 和 super dealloc 导致应用程序崩溃

> ID：11506458
> 
> 赞同：0
> 
> 时间：2012-07-16T14:28:37.247
> 
> 标签：objective-c, ios, ios5

当我在 UINavigation child 和 child [super dealloc] 中使用后退按钮时，我遇到了应用程序崩溃，称为 application get crash。我试过了，但我找不到任何错误。仪器说下面的问题，但我不明白这里的意思

```
#   Address Category    Event Type  RefCt   Timestamp   Size    Responsible Library Responsible Caller
0   0x9e8c8c0   CALayer Malloc  1   00:05.082.180   48  UIKit   -[UIView _createLayerWithFrame:]
1   0x9e8c8c0   CALayer Zombie  -1  00:18.855.037   0   QuartzCore  CA::release_objects(X::List<void const*>*) 
```

如果你能帮助我，我将非常感谢你。

这是根页面代码

```
//
//  TNTScenarioViewController.m
//  TurfNutritionTool
//
//  Created by Aashish Joshi on 10/20/11.
//  Copyright 2011 Abacus Consultancy Services. All rights reserved.
//

#import "TNTScenarioViewController.h"
#import "ScenarioDetailViewController.h"
#import <QuartzCore/QuartzCore.h>

@implementation TNTScenarioViewController

@synthesize scenarioTable =             _scenarioTable;
@synthesize scenarioDetail =            _scenarioDetail;
@synthesize scenarioId =                _scenarioId;
@synthesize scenarioTableCellStyle =    _scenarioTableCellStyle;
@synthesize dbObject =                  _dbObject;
@synthesize headerDateLabel =           _headerDateLabel;
@synthesize headerTurfAcresLabel =      _headerTurfAcresLabel;
@synthesize headerScenarioIDLabel =     _headerScenarioIDLabel;
@synthesize headerDescriptionLabel =    _headerDescriptionLabel;
@synthesize headerProductTypeLabel =    _headerProductTypeLabel;
@synthesize headerTargetNitrogenLabel = _headerTargetNitrogenLabel;
@synthesize headerView =                _headerView;
@synthesize synchronize =               _synchronize;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    UIColor *_background = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"main_login_bg.png"]];
    self.view.backgroundColor = _background;
    [_background release];

    _scenarioTable.delegate = self;
    _scenarioTable.dataSource = self;

    // Set the table view to be rounded
    [[self.scenarioTable layer] setCornerRadius:5.0];

    [self loadDBAccessDatabase];
    // [self didApplicationLaunchedFirstTime];

    self.navigationItem.leftBarButtonItem = self.editButtonItem;

    UIToolbar* _rightNavBarTools = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 260, 44)];

    // create the array to hold the buttons, which then gets added to the toolbar
    NSMutableArray* _rightNavBarButtons = [[NSMutableArray alloc] initWithCapacity:4];

    UIBarButtonItem *_signout = [[UIBarButtonItem alloc] initWithTitle:@"Sign out" style:UIBarButtonItemStyleBordered target:self action:@selector(didApplicationLaunchedFirstTime)];
    [_rightNavBarButtons addObject:_signout];

    [_signout release];

    UIBarButtonItem *_syncronize = [[UIBarButtonItem alloc] initWithTitle:@"Synchronize" style:UIBarButtonItemStyleBordered target:self action:@selector(syncronize)];
    [_rightNavBarButtons addObject:_syncronize];
    [_syncronize release];

    UIBarButtonItem *_addNewScenario = [[UIBarButtonItem alloc] 
                                        initWithTitle:@"New TNT" style:UIBarButtonItemStyleBordered target:self 
                                        action:@selector(startNewScenario)];
    [_rightNavBarButtons addObject:_addNewScenario];
    [_addNewScenario release];

    [_rightNavBarTools setItems:_rightNavBarButtons animated:NO];
    [_rightNavBarButtons release];

    self.navigationItem.rightBarButtonItem = [[[UIBarButtonItem alloc] initWithCustomView:_rightNavBarTools] autorelease];
    [_rightNavBarTools release];

    [self loadAllScenario];
}

- (void)viewWillAppear:(BOOL)animated
{
    NSLog(@"%d", [self retainCount]);
    [super viewWillAppear:animated];
    [self loadAllScenario];
    [self.scenarioTable reloadData];
}

- (void)viewDidUnload
{
    [_scenarioTable release];
    [_scenarioDetail release];
    [_scenarioId release];
    [_scenarioTableCellStyle release];

    self.scenarioTable = nil;
    self.scenarioDetail = nil;
    self.scenarioId = nil;
    self.scenarioTableCellStyle = nil;
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return YES;
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // #warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // #warning Incomplete method implementation.
    // Return the number of rows in the section.
    return [self.scenarioId count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {

        [[NSBundle mainBundle] loadNibNamed:@"scenarioTableCellStyle" owner:self options:nil];
        cell = self.scenarioTableCellStyle;
        self.scenarioTableCellStyle = nil;
    }

    if (indexPath.row % 2 == 0) {
        cell.contentView.backgroundColor = [UIColor colorWithWhite:253.0/255 alpha:1];
    } else {
        cell.contentView.backgroundColor = [UIColor colorWithWhite:250.0/255 alpha:1];
    }

    NSDictionary * _scenarioDetailRow = [self.dbObject getScenarioDetail:[self.scenarioId objectAtIndex:indexPath.row]];

    NSNumber* _tempNumber;
    NSNumberFormatter* _formatter = [[NSNumberFormatter alloc] init];
    NSString* _convertedNumber;

    // Configure the cell...
    _tempNumber = [_scenarioDetailRow objectForKey:@"scenarioid"];
    [_formatter setNumberStyle:NSNumberFormatterDecimalStyle];
    _convertedNumber = [_formatter stringForObjectValue:_tempNumber];

    UILabel* _label = (UILabel *)[cell viewWithTag:1];
    _label.text = _convertedNumber;

    _label = (UILabel *)[cell viewWithTag:2];
    NSString* _turftype = [_scenarioDetailRow objectForKey:@"turf"];
    _label.text = _turftype;

    _label = (UILabel *)[cell viewWithTag:3];
    _tempNumber = [_scenarioDetailRow objectForKey:@"targetnitrogen"];
    [_formatter setNumberStyle:NSNumberFormatterDecimalStyle];
    _convertedNumber = [_formatter stringForObjectValue:_tempNumber];
    _label.text = _convertedNumber;

    _label = (UILabel *)[cell viewWithTag:4];
    _tempNumber = [_scenarioDetailRow objectForKey:@"turfacre"];
    [_formatter setNumberStyle:NSNumberFormatterDecimalStyle];
    _convertedNumber = [_formatter stringForObjectValue:_tempNumber];
    _label.text = _convertedNumber;
    [_formatter release];

    _label = (UILabel *)[cell viewWithTag:5];
    NSString* _dateCreated = [_scenarioDetailRow objectForKey:@"datecreated"];

    NSDateFormatter *inputFormatter = [[[NSDateFormatter alloc] init] autorelease];
    [inputFormatter setDateFormat:@"yyyy-MM-dd HH:mm:ss"];

    NSDate *_inputDateCreated = [inputFormatter dateFromString:_dateCreated];
    NSDateFormatter *outputFormatter = [[[NSDateFormatter alloc] init] autorelease];
    [outputFormatter setDateFormat:@"MM-dd-yyyy"];

    NSString *_outputDateCreated = [outputFormatter stringFromDate:_inputDateCreated];

    _label.text = _outputDateCreated;

    _label = (UILabel *)[cell viewWithTag:6];

    if (([_scenarioDetailRow objectForKey:@"description"] != nil) && ([_scenarioDetailRow objectForKey:@"description"] != (id)[NSNull null])){

        NSString* _discription = [_scenarioDetailRow objectForKey:@"description"];
        _label.text = _discription;

    } else {

        _label.text = [NSString stringWithString:@""];
    }

    return cell;
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
    if (UIInterfaceOrientationIsLandscape(fromInterfaceOrientation))
    {
        // Move the plots into place for portrait
        _headerScenarioIDLabel.frame        = CGRectMake(-30, 2, 125, 20);
        _headerDescriptionLabel.frame       = CGRectMake(52, 2, 125, 20);
        _headerProductTypeLabel.frame       = CGRectMake(278, 2, 125, 20);
        _headerTargetNitrogenLabel.frame    = CGRectMake(368, 2, 125, 20);
        _headerTurfAcresLabel.frame         = CGRectMake(437, 2, 125, 20);
        _headerDateLabel.frame              = CGRectMake(545, 2, 125, 20);
    }
    else
    {
        // Move the plots into place for landscape
        _headerScenarioIDLabel.frame        = CGRectMake(-26, 2, 125, 20);
        _headerDescriptionLabel.frame       = CGRectMake(85, 2, 125, 20);
        _headerProductTypeLabel.frame       = CGRectMake(390, 2, 125, 20);
        _headerTargetNitrogenLabel.frame    = CGRectMake(526, 2, 125, 20);
        _headerTurfAcresLabel.frame         = CGRectMake(626, 2, 125, 20);
        _headerDateLabel.frame              = CGRectMake(759, 2, 125, 20);

    }
}

- (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section { 

    _headerScenarioIDLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
    _headerDateLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
    _headerDescriptionLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
    _headerProductTypeLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
    _headerTargetNitrogenLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];
    _headerTurfAcresLabel = [[[UILabel alloc] initWithFrame:CGRectZero] autorelease];

    UIInterfaceOrientation orientation = [UIApplication sharedApplication].statusBarOrientation;    
    BOOL isLandscape = UIDeviceOrientationIsLandscape(self.interfaceOrientation);

    if (UIInterfaceOrientationIsLandscape(orientation) || isLandscape)

    {
        // Move the plots into place for landscape
        _headerScenarioIDLabel.frame        = CGRectMake(-26, 2, 125, 20);
        _headerDescriptionLabel.frame       = CGRectMake(85, 2, 125, 20);
        _headerProductTypeLabel.frame       = CGRectMake(390, 2, 125, 20);
        _headerTargetNitrogenLabel.frame    = CGRectMake(526, 2, 125, 20);
        _headerTurfAcresLabel.frame         = CGRectMake(626, 2, 125, 20);
        _headerDateLabel.frame              = CGRectMake(759, 2, 125, 20);
    }

    else
    {
        // Move the plots into place for portrait
        _headerScenarioIDLabel.frame        = CGRectMake(-30, 2, 125, 20);
        _headerDescriptionLabel.frame       = CGRectMake(52, 2, 125, 20);
        _headerProductTypeLabel.frame       = CGRectMake(278, 2, 125, 20);
        _headerTargetNitrogenLabel.frame    = CGRectMake(368, 2, 125, 20);
        _headerTurfAcresLabel.frame         = CGRectMake(437, 2, 125, 20);
        _headerDateLabel.frame              = CGRectMake(545, 2, 125, 20);
    }

    if(_headerView == nil) {
        //allocate the view if it doesn't exist yet
        _headerView  = [[UIView alloc] init];

        UIColor *_background = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"toolbar_bkg.png"]];
        _headerView.backgroundColor = _background;
        [_background release];

        _headerScenarioIDLabel.backgroundColor = [UIColor clearColor];
        _headerScenarioIDLabel.opaque = NO;
        _headerScenarioIDLabel.textColor = [UIColor whiteColor];
        _headerScenarioIDLabel.font = [UIFont boldSystemFontOfSize:12];
        _headerScenarioIDLabel.textAlignment = UITextAlignmentCenter;
        _headerScenarioIDLabel.text = @"ID";

        _headerDateLabel.backgroundColor = [UIColor clearColor];
        _headerDateLabel.opaque = NO;
        _headerDateLabel.textColor = [UIColor whiteColor];
        _headerDateLabel.font = [UIFont boldSystemFontOfSize:12];
        _headerDateLabel.textAlignment = UITextAlignmentCenter;
        _headerDateLabel.text = @"Date";

        _headerDescriptionLabel.backgroundColor = [UIColor clearColor];
        _headerDescriptionLabel.opaque = NO;
        _headerDescriptionLabel.textColor = [UIColor whiteColor];
        _headerDescriptionLabel.font = [UIFont boldSystemFontOfSize:12];
        _headerDescriptionLabel.textAlignment = UITextAlignmentCenter;
        _headerDescriptionLabel.text = @"Description";

        _headerProductTypeLabel.backgroundColor = [UIColor clearColor];
        _headerProductTypeLabel.opaque = NO;
        _headerProductTypeLabel.textColor = [UIColor whiteColor];
        _headerProductTypeLabel.font = [UIFont boldSystemFontOfSize:12];
        _headerProductTypeLabel.textAlignment = UITextAlignmentCenter;
        _headerProductTypeLabel.text = @"Product Type";

        _headerTargetNitrogenLabel.backgroundColor = [UIColor clearColor];
        _headerTargetNitrogenLabel.opaque = NO;
        _headerTargetNitrogenLabel.textColor = [UIColor whiteColor];
        _headerTargetNitrogenLabel.font = [UIFont boldSystemFontOfSize:12];
        _headerTargetNitrogenLabel.textAlignment = UITextAlignmentCenter;
        _headerTargetNitrogenLabel.text = @"Target N";

        _headerTurfAcresLabel.backgroundColor = [UIColor clearColor];
        _headerTurfAcresLabel.opaque = NO;
        _headerTurfAcresLabel.textColor = [UIColor whiteColor];
        _headerTurfAcresLabel.font = [UIFont boldSystemFontOfSize:12];
        _headerTurfAcresLabel.textAlignment = UITextAlignmentCenter;
        _headerTurfAcresLabel.text = @"Turf Acres";

        //add the button to the view
        [_headerView addSubview:_headerScenarioIDLabel];
        [_headerView addSubview:_headerDescriptionLabel];
        [_headerView addSubview:_headerProductTypeLabel];
        [_headerView addSubview:_headerTargetNitrogenLabel];
        [_headerView addSubview:_headerTurfAcresLabel];
        [_headerView addSubview:_headerDateLabel];

    }

    //return the view for the footer
    return _headerView;
}
// specify the height of your footer section
- (CGFloat)tableView:(UITableView *)tableView
heightForHeaderInSection:(NSInteger)section {
    //differ between your sections or if you
    //have only on section return a static value
    return 24;
}

- (CGFloat)tableView:(UITableView *)tableView
heightForFooterInSection:(NSInteger)section {
    //differ between your sections or if you
    //have only on section return a static value
    return 14;
}

- (UIView *) tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section { 

    UIColor *_background = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"toolbar_bkg.png"]];
    UIView* _customView = [[[UIView alloc]initWithFrame:CGRectMake(10.0, 0.0, 300.0, 44.0)]autorelease];
    _customView.backgroundColor = _background;
    [_background release];
    return _customView; 
}

/*
 // Override to support conditional editing of the table view.
 - (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
 {
 // Return NO if you do not want the specified item to be editable.
 return YES;
 }
 */

/*
 // Override to support editing the table view.
 - (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
 {
 if (editingStyle == UITableViewCellEditingStyleDelete) {
 // Delete the row from the data source
 [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
 }   
 else if (editingStyle == UITableViewCellEditingStyleInsert) {
 // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
 }   
 }
 */

/*
 // Override to support rearranging the table view.
 - (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
 {
 }
 */

/*
 // Override to support conditional rearranging of the table view.
 - (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
 {
 // Return NO if you do not want the item to be re-orderable.
 return YES;
 }
 */

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.

     ScenarioDetailViewController* _detailViewController = [[ScenarioDetailViewController alloc] initWithNibName:@"ScenarioDetailViewController" bundle:nil];
     _detailViewController.dbObject = self.dbObject;
     [_detailViewController setScenarioId:[self.scenarioId objectAtIndex:indexPath.row]];
     [self.navigationController pushViewController:_detailViewController animated:YES];
    [_detailViewController release];
}

- (void)setEditing:(BOOL)editing animated:(BOOL)animated {
    // Updates the appearance of the Edit|Done button as necessary.
    [super setEditing:editing animated:animated];
    [self.scenarioTable setEditing:editing animated:YES];
    // Disable the add button while editing.
}

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle
forRowAtIndexPath:(NSIndexPath *)indexPath {

    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // must update the database before updating the tableView
        // so that the tableView never has a row that's missing from the database
        [self.dbObject deleteScenarioRow:[self.scenarioId objectAtIndex:indexPath.row]];
        [self loadAllScenario];
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]
                         withRowAnimation:UITableViewRowAnimationFade];
        [self.scenarioTable reloadData];
    }   
}

- (void)dealloc {

    [_synchronize release];    
    [_scenarioTable release];
    [_scenarioDetail release];
    [_scenarioId release];
    [_scenarioTableCellStyle release];
    [_headerDateLabel release];
    [_headerTurfAcresLabel release];
    [_headerScenarioIDLabel release];
    [_headerDescriptionLabel release];
    [_headerProductTypeLabel release];
    [_headerTargetNitrogenLabel release];
    [_headerView release];
    [super dealloc];
}

// Called when an alertview button is touched
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

    switch (buttonIndex) {
        case 0: 
        {       
            NSLog(@"user not want to sync");
        }
            break;

        case 1: 
        {
            [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];

            _synchronize = [[TNSynchronize alloc] init];
            _synchronize.delegate = self;
            [_synchronize jesonRequest];

            [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
        }   
            break;
    }
}

- (void) reloadAfterSyncronize {

    [self loadAllScenario];
    [self.scenarioTable reloadData];
}

#pragma mark - TNTScenarioViewController lifecycle methods

- (void) syncronize {

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:NSLocalizedString(@"Syncronize process", nil)
                                                    message:NSLocalizedString(@"\n Syncronize process will be start and work in background.", nil)
                                                   delegate:self 
                                          cancelButtonTitle:NSLocalizedString(@"Cancel", nil)
                                          otherButtonTitles:NSLocalizedString(@"Ok", nil), nil];
    [alert show];
    [alert release];
}

- (void) didApplicationLaunchedFirstTime {

    LoginViewController *loginViewObj = [[[LoginViewController alloc] init] autorelease];
    loginViewObj.dbObject = self.dbObject;

    UINavigationController *navigationController = [[[UINavigationController alloc]
                                                     initWithRootViewController:loginViewObj] autorelease];

    navigationController.modalPresentationStyle = UIModalPresentationFullScreen;
    [self presentModalViewController:navigationController animated:YES];
} 

- (void)loadSynchronizeController {

    [self.scenarioTable reloadData];
}

// This is Method to New Scenario
- (void) startNewScenario {

    ScenarioDetailViewController* _detailViewController = [[ScenarioDetailViewController alloc] initWithNibName:@"ScenarioDetailViewController" bundle:nil];
    [_detailViewController setScenarioId:[NSNumber numberWithInt:0]];
    [self.navigationController pushViewController:_detailViewController animated:YES];
    // [_detailViewController release];
}

// This Method use for Load Value of Scenario
- (NSMutableArray *) loadAllScenario {
    // NSLog(@"%s", __FUNCTION__);

    // First, test for existence.
    NSArray* _paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString* _documentsDirectory = [_paths objectAtIndex:0];
    NSString* _writableConfigPath = [_documentsDirectory stringByAppendingPathComponent:@"Configuration.plist"];
    NSMutableDictionary* _configFile = [[NSMutableDictionary alloc] initWithContentsOfFile:_writableConfigPath];

    NSString* _loginStatus= [NSString stringWithString:[_configFile objectForKey:@"UserEmail"]];
    [_configFile autorelease];

    [self.scenarioId removeAllObjects];

    if (!_dbObject) [self loadDBAccessDatabase];
    self.scenarioId = [NSMutableArray arrayWithArray:[_dbObject getRelatedScenarioArray:_loginStatus]];

    return self.scenarioId;
}

- (NSArray *) loadScenarioIDsIfEmpty {
    // NSLog(@"%s", __FUNCTION__);

    // First, test for existence.
    NSArray* _paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString* _documentsDirectory = [_paths objectAtIndex:0];
    NSString* _writableConfigPath = [_documentsDirectory stringByAppendingPathComponent:@"Configuration.plist"];
    NSMutableDictionary* _configFile = [[NSMutableDictionary alloc] initWithContentsOfFile:_writableConfigPath];

    NSString* _loginStatus = [NSString stringWithString:[_configFile objectForKey:@"UserEmail"]];
    [_configFile autorelease];

    if (!_dbObject) [self loadDBAccessDatabase];
    if (!self.scenarioId || ![self.scenarioId count]) self.scenarioId = [NSMutableArray arrayWithArray:[_dbObject getRelatedScenarioArray:_loginStatus]];
    return self.scenarioId;
}

- (DBAccess *) loadDBAccessDatabase {
    // NSLog(@"%s", __FUNCTION__);

    _dbObject = [DBAccess sharedDBObjectAccess];
    return _dbObject;
} 
```

@结尾

这是你问的dealloc方法

```
- (void)dealloc {

    [_scenarioProductTable release];
    [_attributePopover release];
    [_gotMapRegion release];
    [_gotTargetN release];
    [_gotTurfAcres release];
    [_gotTurftype release];
    [_scenarioId release];
    [_granularProductData release]; 
    [_liquidProductData release];
    [_areaGraphData release];
    [_scenarioAppId release];
    [_scenarioProductTableCellStyle release];
    [_scenarioProductTable release];
    [_carryOver release];
    [_tempDiscription release];
    [_scenarioDetailRow release];
    [_turfacresTextField release];
    [_discriptionTextField release];
    [_footerView release];
    [_headerView release];
    [selectedTurftypeLabel release];
    [selectedTargetNLabel release];
    [selectedMapregionLabel release];
    [selectedTurfAcresLabel release];
    [_loginUser release];
    [super dealloc];
} 
```

在这个函数中它说我有问题

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.

     ScenarioDetailViewController* _detailViewController = [[ScenarioDetailViewController alloc] initWithNibName:@"ScenarioDetailViewController" bundle:nil];
     _detailViewController.dbObject = self.dbObject;
     [_detailViewController setScenarioId:[self.scenarioId objectAtIndex:indexPath.row]];
     [self.navigationController pushViewController:_detailViewController animated:YES];
    [_detailViewController release];
} 
```

这条线在函数中有 100% 的责任

```
[self.navigationController pushViewController:_detailViewController animated:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:34:46.010

从崩溃报告中，很明显你正在过度释放一个对象（注意它说僵尸 CALayer 的保留计数为 -1；小于 0 的任何东西都被过度释放）。我的建议是搜索您的代码直到找到它，使用 Instruments 工具“Zombies”（*仅在 Simulator 上进行分析时有效*），或者将您的项目升级到 ARC。

我绝对会推荐升级到 ARC 作为最佳选择。ARC 简化了您的代码并降低了峰值内存占用，提高了效率并大大降低了崩溃的机会。

编辑：

升级到 ARC：（从 Xcode 菜单）

```
Edit -> Refactor -> Convert to Objective-C ARC... 
```

（来自 Apple 的人脸检测示例项目）

![在此处输入图像描述](../Images/6d7e44ba18892fb2153e5eba92376b3e.png)

编辑2：

回应@Chris的回答：

在 viewDidUnload 中，您应该只释放在 viewDidLoad 中创建的对象；此外，您通常应该只将 IBOutlets 设置为 nil。每次调用 viewDidUnload 时，都会调用 viewDidLoad 来重新创建在 viewDidUnload 中销毁的所有内容。所以课程**在 viewDidUnload 中，只有在 viewDidLoad 中创建的对象为零**。如果您释放了未在 viewDidLoad 中创建的内容，则*当您返回该视图时不会重新创建它，这可能会导致崩溃。*

然而，我认为这不是你的问题。viewDidUnload 在视图控制器被销毁时实际上并没有被调用（因为控制器从导航堆栈中弹出或者模式视图控制器被解除，所以调用了dealloc）。只有当应用程序收到内存警告时才会调用 viewDidUnload - viewDidUnload 的工作是释放任何可以在以后重新创建的对象。假设您没有收到任何内存警告并且您只是从堆栈中推送/弹出视图控制器，则双重释放是 viewDidUnload 不会导致***此***问题（尽管它可能会在以后导致）。

故事的道德启示：

使用弧。它不是玩具，它确实有效。它不会“减少”您对内存管理的控制——它消除了对它的需要。除了保留周期（Brad Larson 在这里给出了一个很好的解释：[Objective-C 中的自动引用计数不能防止或最小化什么样的泄漏？](https://stackoverflow.com/questions/6260256/what-kind-of-leaks-does-automatic-reference-counting-in-objective-c-not-prevent?lq=1)），ARC 将负责几乎所有的内存管理，尤其是泄漏。您仍然可以通过以下方式摆脱对象：

```
someObject = nil; 
```

所以你仍然可以控制你的内存占用。@autoreleasepools 仍然是 ARC 的一个选项。

所以，故事的最终寓意：

**使用弧。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:34:02.733

```
- (void)viewDidUnload
{
    [_scenarioTable release];
    [_scenarioDetail release];
    [_scenarioId release];
    [_scenarioTableCellStyle release];

    self.scenarioTable = nil;
    self.scenarioDetail = nil;
    self.scenarioId = nil;
    self.scenarioTableCellStyle = nil;
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
} 
```

你的`-viewDidUnload`方法是双重释放。首先，您通过引用它们的实例变量来明确`release`对象，即：`[_scenarioTable release];`. 但是你不要`nil`在这样做之后将 ivar 设置为。所以那些实例变量仍然指向释放的对象。

然后将这些实例变量支持的属性设置为`nil`. 这些属性可能被声明为使用`retain`内存管理策略。这意味着当您这样做时`self.scenarioTable = nil;`，它将`release`与该属性关联的 ivar。

要解决这个问题，只需去掉`release`顶部的 4 个调用。

```
- (void)viewDidUnload
{
    self.scenarioTable = nil;
    self.scenarioDetail = nil;
    self.scenarioId = nil;
    self.scenarioTableCellStyle = nil;
    [super viewDidUnload];
} 
```

如果您真的想保留这些，请将其更改为：

```
- (void)viewDidUnload
{
    [_scenarioTable release]; _scenarioTable = nil;
    [_scenarioDetail release]; _scenarioDetail = nil;
    [_scenarioId release]; _scenarioId = nil;
    [_scenarioTableCellStyle release]; _scenarioTableCellStyle = nil;
    [super viewDidUnload];
} 
```

这就是为什么`-viewDidUnload`在 iOS 6 中被弃用的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:37:07.760

就像 Rickay 说的，在你的`dealloc`方法中，`viewDidUnload`你释放了 4 个场景对象两次。我只使用过 ARC，但我很确定那是你的问题

# java - 按下 Ctrl+C 时将字符串打印到 JEditorPane 中的插入符号位置

> ID：11506461
> 
> 赞同：0
> 
> 时间：2012-07-16T14:28:57.453
> 
> 标签：java, keyevent, jeditorpane, bufferedwriter, getcaretpos

当按下 CTRL+C 时，我正在尝试将某个字符串打印到 JEditorPane 中的当前插入符号位置。我不确定如何处理两个关键事件并打印到当前插入符号位置。API 不能很好地描述它们。我想它会是这样的：

```
@Override 
public void keyPressed( KeyEvent e) {
    if((e.getKeyChar()==KeyEvent.VK_CONTROL) && (e.getKeyChar()==KeyEvent.VK_C))
        //JEditorPane.getCaretPosition();
        //BufferedWriter bw = new BufferedWriter();
        //JEditorPane.write(bw.write("desired string"));
} 
```

有人可以告诉我这是否可行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:40:04.113

该事件的 keyChar 永远不会同时等于 VK_CONTROL 和 VK_C。您要做的是检查 CONTROL 键作为事件的修饰符。如果您想在编辑器窗格中插入或附加文本，最好抓住包含文本的基础 Document 对象，然后将文本插入其中。如果您知道此上下文中的关键事件只能来自您的编辑器窗格，您可以执行以下操作：

```
if (e.getKeyCode() == KeyEvent.VK_C &&
       (e.getModifiers() & KeyEvent.CTRL_MASK) == KeyEvent.CTRL_MASK) {
    JEditorPane editorPane = (JEditorPane) e.getComponent();
    int caretPos = editorPane.getCaretPosition();
    try {
        editorPane.getDocument().insertString(caretPos, "desired string", null);
    } catch(BadLocationException ex) {
        ex.printStackTrace();
    }
} 
```

这是一个完整的例子：

```
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;

import javax.swing.JEditorPane;
import javax.swing.JFrame;
import javax.swing.text.BadLocationException;

public class EditorPaneEx {

public static void main(String[] args) {
    JFrame frame = new JFrame();
    JEditorPane editorPane = new JEditorPane();
    editorPane.addKeyListener(new KeyAdapter() {
        @Override
        public void keyPressed(KeyEvent ev) {
            if (ev.getKeyCode() == KeyEvent.VK_C
                    && (ev.getModifiers() & KeyEvent.CTRL_MASK) == KeyEvent.CTRL_MASK) {
                JEditorPane editorPane = (JEditorPane) ev.getComponent();
                int caretPos = editorPane.getCaretPosition();
                try {
                    editorPane.getDocument().insertString(caretPos,
                            "desired string", null);
                } catch (BadLocationException ex) {
                    ex.printStackTrace();
                }
            }
        }
    });
    frame.add(editorPane);
    frame.pack();
    frame.setVisible(true);
} 
```

}

# c# - 查询字符串和文本大小写

> ID：11506463
> 
> 赞同：4
> 
> 时间：2012-07-16T14:29:02.283
> 
> 标签：c#, query-string, case-sensitive

评估查询字符串的字符串并考虑大小写（大写/小写）对我来说是否安全？例如，某些浏览器是否会降低整个字符串？编码是否足够可靠，就像我添加到查询字符串中的任何参数一样，以保持大小写相同？（显然将用户可能会弄​​乱它的事实放在一边）。

用 C# 标记，因为我不确定评估查询字符串的平台是否会影响这个问题的答案；我正在编码的是 C#。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:34:46.293

约定是关键。如果您在整个应用程序中使用驼峰式查询字符串，请使用驼峰式等。您将成为传递参数和指定查询字符串的人，因此请保持一致以使自己的生活更轻松。除了保持一致之外，特定的大小写约定并没有真正的好处。

浏览器将保持大写不变。

# android - 裁剪图像以获取特殊路径

> ID：11506466
> 
> 赞同：0
> 
> 时间：2012-07-16T14:29:15.827
> 
> 标签：android, image, crop

我有一个特殊项目列表：左侧照片和项目右侧一些文本。在具有特殊纹理的列表背景下。图像应以五边形的形式裁剪。如何裁剪图像而不破坏其下的纹理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:27:10.790

我会说创建一个图像但是你想裁剪你的图像，我的意思是它是蒙版并将它放在你的 imageView 上......然后设置你的 imageView 低于蒙版。所以看起来你的图像已经被裁剪了。

# xslt - 报告 Saxon XSLT 处理器缺陷的正确位置在哪里？

> ID：11506472
> 
> 赞同：1
> 
> 时间：2012-07-16T14:29:47.183
> 
> 标签：xslt, xslt-2.0

我用谷歌搜索，但我发现的每个可能适合此目的的论坛都已关闭或损坏。报告 Saxon XSLT 处理器缺陷的正确位置在哪里？

对于好奇的人，这是我的小宝石，它使撒克逊人崩溃，并将成为我报告的主题。

```
<xsl:stylesheet version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:fn="http://www.w3.org/2005/xpath-functions"
  exclude-result-prefixes="xsl xs fn">
<xsl:output indent="yes"/>

<xsl:template match="/">
  <t/>
  <xsl:message><xsl:value-of select="
   'Two false values'[for $i in 1 to 2 return false()]"/>
  </xsl:message>  
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:28:50.053

撒克逊邮件列表[https://lists.sourceforge.net/lists/listinfo/saxon-help](https://lists.sourceforge.net/lists/listinfo/saxon-help)应该可以工作，它是活跃的。不过，我不确定这是目前首选的方式，但我相信 Michael Kay 稍后会告诉你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T15:31:12.720

使用[撒克逊帮助](https://lists.sourceforge.net/lists/listinfo/saxon-help)邮件列表。顺便说一句，这不是一个错误，Saxon 给你一个明确的错误信息：

> FORG0006：没有为以布尔值开头的两个或多个项目的序列定义有效的布尔值

如果你改变`1 to 2`它的`1 to 1`工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:55:32.187

几个月前，dev.saxonica.com 上有一个官方的错误报告网站，欢迎您使用；但也欢迎您使用 SourceForge 的 saxon-help 列表（我们不积极鼓励商业产品的用户使用该资源，因为它是为开源社区的利益而提供的，但如果人们这样做，他们会得到答案）。

我期待看到错误报告。确保提供足够的信息来重现问题，包括产品版本号，当然还有错误消息或堆栈跟踪。

请注意，当前版本是 9.4.0.4。当早期版本出现问题但最新分支中没有出现问题时，我们通常不会修复它们，除非修复对付费客户很重要。

# jquery - 使用 jquery 进行 Cookie 管理不起作用

> ID：11506473
> 
> 赞同：0
> 
> 时间：2012-07-16T14:29:50.447
> 
> 标签：jquery, jsp

我有一个简单的 cookie 和 jquery 应用程序。我希望当用户从 jsp 页面上的表单登录时。会生成一个 cookie，用于存储在表单中输入的电子邮件。导航到另一个页面，我正在尝试访问 cookie 并用电子邮件的 cookie 值填充文本字段。但似乎既没有生成cookie，我也无法访问cookie。

我的表单代码：

```
<s:form id="login" action="login" method="post" cssClass="text">
                    <s:textfield id="email" name="email" label="Email address:"/>
                    <s:password name="pswd" label="Password :"/>
                    <s:submit value="Login"/>
                </s:form> 
```

我的 form.jsp 脚本标签

```
<script type="text/javascript" src="jquery.cookie.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                $("#login").submit(function() {
                        var email = $('#email').val();
                        $.cookie('email', email, { expires: 1 });
                });
            });
        </script> 
```

我的导航页面 navigated.jsp 是：

```
<s:textfield label="Your Email :" id="email" name="email"/> 
```

navigated.jsp 中的脚本代码是：

```
 <script type="text/javascript" src="jquery.cookie.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                var email = $.cookie('email');
                $('#email').val(email);
            });
        </script> 
```

请指出可能是什么问题..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:54:55.720

如果你不能让 jQuery cookie 插件工作，你可以尝试另一个库。

Cookie 处理相当简单。

Mozilla 开发者网站只有几十行代码就拥有一个完整的 cookie 库 - 从这里复制它：[https ://developer.mozilla.org/en/DOM/document.cookie](https://developer.mozilla.org/en/DOM/document.cookie)

希望有帮助。

# opengl - 错误的 OpenGL 初始化

> ID：11506474
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:29:51.650
> 
> 标签：opengl

我的程序将视频帧显示为 OpenGL 纹理。

我有 OpenGL 初始化的问题。要查看视频，我需要开始渲染线程，停止它并重新开始。我想我在 CRenderThread::InitOpenGL() 函数中遗漏了一些东西。我应该怎么做才能正确初始化 OpenGL？

我的环境：

> 视窗 7 x64
> 
> 微软视觉工作室 2008 x64

这是代码：

```
#include "RenderThread.h"
#include <QtDebug>
#include <vm_time.h>

static Ipp32u UMCToInternalFormat(UMC::ColorFormat format)
{
switch(format)
{
case UMC::BGR24: return GL_BGR;
case UMC::BGR32: return GL_BGRA;
case UMC::RGB24: return GL_RGB;
case UMC::RGB32: return GL_RGBA;
}
return 0;
}

CRenderThread::CRenderThread(const WId& rnWindowHandle)
:   m_bInitialized(false)
,   m_WindowHandle(rnWindowHandle)
,   m_Texture(0)
,   m_fTextureWidth(0.0f)
,   m_fTextureHeight(0.0f)
,   m_nFrameWidth(0)
,   m_nFrameHeight(0)
,   m_nWindowWidth(0)
,   m_nWindowHeight(0)
{
}

void CRenderThread::PrepareWork()
{
// Wait until first frame comes
if(!m_bAbort)
    Suspend();
}

void CRenderThread::DoOnStop()
{
if(m_WindowGLResourceContext)
{
    wglDeleteContext(m_WindowGLResourceContext);
    m_WindowGLResourceContext = 0;
}
    ReleaseDC(m_WindowHandle, m_WindowDC);

if(m_Texture)
{
    glDeleteTextures(1, &m_Texture);
    m_Texture = 0;
}
}

void CRenderThread::InitOpenGL()
{
PIXELFORMATDESCRIPTOR pfd = {
    sizeof(PIXELFORMATDESCRIPTOR),  1, PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER,
    PFD_TYPE_RGBA, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, PFD_MAIN_PLANE, 0, 0, 0, 0
};

m_WindowDC = GetDC(m_WindowHandle);
if(!m_WindowDC)
    return;

if(!SetPixelFormat(m_WindowDC, ChoosePixelFormat(m_WindowDC, &pfd), &pfd))
    return;

m_WindowGLResourceContext = wglCreateContext(m_WindowDC); // create rendering context
if(!m_WindowGLResourceContext)
    return;

if(!wglMakeCurrent(m_WindowDC, m_WindowGLResourceContext)) // set it as current
    return;

// OpenGL context already tied to output window
// to disable all slow GL components
// it is not mandatory to disable all if we have accelerated card
glClearColor(0.0f, 170.0f, 255.0f, 1.0f);
glClearDepth(1.0);
glDepthFunc(GL_NEVER);

// disable slow GL extensions
glDisable(GL_DEPTH_TEST); glDisable(GL_ALPHA_TEST);   glDisable(GL_BLEND);
glDisable(GL_DITHER);     glDisable(GL_FOG);          glDisable(GL_STENCIL_TEST);
glDisable(GL_LIGHTING);   glDisable(GL_LOGIC_OP);     glDisable(GL_TEXTURE_1D);
glDisable(GL_TEXTURE_2D);

glPixelTransferi(GL_MAP_COLOR, GL_FALSE);
glPixelTransferi(GL_RED_SCALE,   1);  glPixelTransferi(GL_RED_BIAS,   0);
glPixelTransferi(GL_GREEN_SCALE, 1);  glPixelTransferi(GL_GREEN_BIAS, 0);
glPixelTransferi(GL_BLUE_SCALE,  1);  glPixelTransferi(GL_BLUE_BIAS,  0);
glPixelTransferi(GL_ALPHA_SCALE, 1);  glPixelTransferi(GL_ALPHA_BIAS, 0);

glEnable(GL_TEXTURE_2D);
glGenTextures(1, &m_Texture);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

glViewport(0, 0, m_nWindowWidth, m_nWindowHeight);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glRasterPos2i(-1, 1);       // move to the upper left corner
glPixelZoom(1.0, -1.0);     // top to bottom

SwapBuffers(m_WindowDC);

m_bInitialized = true;
}

void CRenderThread::SetRenderFrame(PVideoData pFrame)
{
Q_ASSERT(pFrame.get());
{
    //boost::mutex::scoped_lock Lock(m_FrameMutex);
    m_pFrameToRender = pFrame;
}

// Resume thread to render current frame
Resume();
}

void CRenderThread::DoWork()
{
IppiSize    CurWinSize;
UMC::Status nStatus = UMC::UMC_OK;

::RECT rect;
GetClientRect(m_WindowHandle, &rect);
CurWinSize.height = rect.bottom;
CurWinSize.width  = rect.right;

if(!m_bInitialized)
    InitOpenGL();

if(CurWinSize.width > IPP_MAX_16S || CurWinSize.height > IPP_MAX_16S) // window seems to be destroyed
    return;

// reinit buffers if window size has been changed
if(CurWinSize.height != m_nWindowHeight || CurWinSize.width != m_nWindowWidth)
{
    m_nWindowWidth  = CurWinSize.width;
    m_nWindowHeight = CurWinSize.height;

    glViewport(0, 0, m_nWindowWidth, m_nWindowHeight);
}

// Render frame
{
    //boost::mutex::scoped_lock Lock(m_FrameMutex);
    if(m_pFrameToRender.get())
    {
        if(m_nWindowWidth && m_nWindowHeight)
        {
            glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

            m_nFrameWidth   = m_pFrameToRender->GetWidth();
            m_nFrameHeight  = m_pFrameToRender->GetHeight();
            m_nRenderFormat = UMCToInternalFormat(m_pFrameToRender->GetColorFormat());

            glTexImage2D(GL_TEXTURE_2D, 0, 3, m_nFrameWidth, m_nFrameHeight, 0, GL_RGB, GL_UNSIGNED_BYTE, m_pFrameToRender->GetBufferPointer());
            //glTexSubImage2D(GL_TEXTURE_2D, 0, 0, 0, m_nFrameWidth, m_nFrameHeight, m_nRenderFormat, GL_UNSIGNED_BYTE, m_pFrameToRender->GetBufferPointer());

            glBegin(GL_POLYGON);
            glTexCoord2i(0, 0); glVertex2f(-1.0,  1.0);
            glTexCoord2i(1, 0); glVertex2f( 1.0,  1.0);
            glTexCoord2i(1, 1); glVertex2f( 1.0, -1.0);
            glTexCoord2i(0, 1); glVertex2f(-1.0, -1.0);
            glEnd();

            glFlush();

            SwapBuffers(m_WindowDC);   // to draw on physical screen
        }
    }
}

// Wait for next frame to render
if(!m_bAbort)
    Suspend();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:11:47.670

几个想法，不一定都与您的问题有关：

`glClearColor(0.0f, 170.0f, 255.0f, 1.0f);`

清晰的颜色被限制在 [0,1] 的范围内，而不是 [0,255]。

* * *

```
// disable slow GL extensions
glDisable(GL_DEPTH_TEST); glDisable(GL_ALPHA_TEST);   glDisable(GL_BLEND);
glDisable(GL_DITHER);     glDisable(GL_FOG);          glDisable(GL_STENCIL_TEST);
glDisable(GL_LIGHTING);   glDisable(GL_LOGIC_OP);     glDisable(GL_TEXTURE_1D);
glDisable(GL_TEXTURE_2D); 
```

默认情况下禁用这些（以及大多数所有 opengl 设置）。这些都是无所作为。虽然不伤任何东西。

* * *

```
glPixelTransferi(GL_MAP_COLOR, GL_FALSE);
glPixelTransferi(GL_RED_SCALE,   1);  glPixelTransferi(GL_RED_BIAS,   0);
glPixelTransferi(GL_GREEN_SCALE, 1);  glPixelTransferi(GL_GREEN_BIAS, 0);
glPixelTransferi(GL_BLUE_SCALE,  1);  glPixelTransferi(GL_BLUE_BIAS,  0);
glPixelTransferi(GL_ALPHA_SCALE, 1);  glPixelTransferi(GL_ALPHA_BIAS, 0); 
```

同样，这些都是默认值。

* * *

```
glEnable(GL_TEXTURE_2D);
glGenTextures(1, &m_Texture);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); 
```

这实际上可能是一个真正的问题。`glTexParameter`仅影响当前绑定的纹理，但您在这里调用它们时没有绑定纹理。所以这些都无能为力。当您稍后实际使用纹理时，它会在 min 过滤器上设置 mipmapping，这可能会导致它不显示。`glTexParameter`在绑定了您希望它们影响的纹理后，将您的调用移动到。

# c# - 如果我想将类型约束 (T=int) 方法添加到泛型 (T) 类中，是否必须创建扩展方法？

> ID：11506479
> 
> 赞同：3
> 
> 时间：2012-07-16T14:30:12.633
> 
> 标签：c#, generics, extension-methods

例如，我有一个 ( `non-static`) 类`Foo<T>`

我想添加一个方法`bar()`，`Foo`但是这个方法应该只适用于`Foo<int>`。

因为我们不能重载类型约束，
我是否必须在单独的`static`类中创建扩展方法`bar(this Foo<int> myFoo)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:42:28.790

基本上，是的。C#（以及一般的 CLR）不支持 C++ 中已知的模板特化。

当您的类的实现根本不关心实际类型时，应该使用类型参数。

作为替代方案，添加运行时检查以确保该方法仅在`typeof(T) == typeof(int)`.

# .net - 为什么我无法在 .NET 中捕获某些异常类型？

> ID：11506480
> 
> 赞同：3
> 
> 时间：2012-07-16T14:30:15.080
> 
> 标签：.net, dllimport

我们正在 C#/.NET 项目中使用一些旧版 DLL。为什么无法捕获遗留代码上的某些异常并且应用程序崩溃？与标准 .NET 异常有何不同？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:22:14.303

Jeffrey Ritcher 在其精彩的“通过 C# 的 CLR”中告诉我们：一些非托管代码故障被 .Net 运行时 (CLR) 视为“损坏的状态异常”(CSE)。通常（见下文），我们这些普通人无法捕捉到这些异常。在这些失败之一时，甚至`finally`不会执行块，其中包括：

*   访问冲突
*   非法指令
*   堆栈溢出
*   页面错误

但是，您可以将[HandleProcessCorruptedStateExceptionsAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.exceptionservices.handleprocesscorruptedstateexceptionsattribute.aspx)和[SecurityCriticalAttribute](http://msdn.microsoft.com/en-us/library/system.security.securitycriticalattribute%28v=vs.80%29.aspx)属性应用于您期望 CSE 发生的特定方法。在此方法中，您可以编写一个`try...catch`将捕获 CSE 的块。

可以在本文中找到更多详细信息：http: [//msdn.microsoft.com/en-us/magazine/dd419661.aspx](http://msdn.microsoft.com/en-us/magazine/dd419661.aspx)

# github - 您可以/应该重用 GitHub 拉取请求吗？

> ID：11506481
> 
> 赞同：1
> 
> 时间：2012-07-16T14:30:15.967
> 
> 标签：github

我刚刚为一个 GitHub 项目提出了第一个拉取请求，该项目接受了我的部分更改，然后被我分叉的 repo 的所有者关闭。我想对该回购进行另一项更改，但我不确定如何进行。由于我的拉取请求被接受并关闭，我是否需要删除我的分叉然后创建一个新的？或者有没有办法刷新我的叉子以从主人那里提取新的变化？或者我应该只是手动将更改复制到我的分叉项目中，然后将我的新更改放在上面？感谢您的任何建议/指导。

G

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:32:10.240

抱歉，这是一个简短的答案，但为了保持清洁，您应该再次分叉。您当前分支的所有历史记录都已涵盖，因此无需保留所有历史记录。

# javascript - 尝试返回值时出现javascript函数错误

> ID：11506482
> 
> 赞同：1
> 
> 时间：2012-07-16T14:30:34.753
> 
> 标签：javascript, jquery, function

我的目标：我正在为一项工作编写一个小部件，它将用内容填充一个 div。我什至没有执行信息，因为得到错误：未捕获的语法错误：意外的令牌返回

我编写了一个执行此函数的对象，如下所示：

```
function TreeView(){
    this.rebuild = contructRoot();
}

function constructRoot(){
    var resultant = ajax_Request();
    var content = $(resultant);

    var root = $("<div>");
    var root_nodes = ajax_Request("/startTreeAJAX");
    root_nodes.split("|");
    root.html(
        $("<div>").html(
            $("<ul>").append($('<li>').html(root_nodes[0])).append($("<li>").html(root_nodes[1]))
        )
    );
    root.find("li").click(function(){
        clickExpand(this);
    });

    return root.html();
} 
```

我试图从本质上返回元素内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T14:33:04.907

缺少的关闭`)`，`.click()`并且不要忘记`}`在`return`. 当您看到诸如意外标记之类的语法错误时，请立即开始查看它之前的内容以找到您的问题...

```
 root.find("li").click(function(){ 
     clickExpand(this);
  }); // <----

  return root.html();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:32:35.827

检查你的花括号和括号。你错过了其中的几个。

```
root.find("li").click(function () {
    clickExpand(this);
});  // <-- you're missing the `)` here 
```

```
 return root.html();
} // <-- You're missing the `}` here 
```

**更新**：正如其他人所说，此代码还有其他问题。

```
root_nodes.split("|"); 
```

这没有任何作用。你需要设置`root_nodes`为那个。

```
root_nodes = root_nodes.split("|"); 
```

```
var c = $('<li>').html(root_nodes[0]) + $("<li>").html(root_nodes[1]); 
```

这并不像你认为的那样。将`+`连接字符串，从而返回：

```
"[object Object][object Object]" 
```

`.append`可以接受 jQuery 对象（或数组），所以我建议这样做：

```
var c = [$('<li>').html(root_nodes[0]), $("<li>").html(root_nodes[1])];
root.html($("<div>").html($("<ul>").append(c))); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T14:32:49.087

Javascript 的 split() 方法返回一个数组。在上面的代码中，您需要接收并存储该数组。

```
root_nodes = root_nodes.split("|") 
```

# sql - BULK INSERT / OPENROWSET CSV 文件的格式文件终止符，数据中带有 ,（逗号）

> ID：11506484
> 
> 赞同：1
> 
> 时间：2012-07-16T14:30:41.710
> 
> 标签：sql, sql-server, c#-4.0, bulkinsert, openrowset

我为我的百万行 CSV 编写了一个很好的导入，效果很好（使用 OPENROWSET BULK（我没有使用 BULK INSERT，因为我需要与其他一些列交叉连接）。格式文件使用逗号作为终止符。

这是我用来开发的 CSV 示例：

```
Reference, Name, Street
1,Dave Smith, 1 Test Street
2,Sally SMith,1 Test Street 
```

一旦我得到它的工作，有人提醒我数据本身可能有一个逗号，哎呀！！！！

```
Reference, Name, Street
"1","Dave Smith", "1 Test Street"
"2","Sally Smith","1,Test Street" <-comma in street 
```

人们如何使用 FormatFiles 处理数据中带有逗号的 CSV？（或者我只是说文件必须用TAB分隔）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:43:57.177

如果您的字段终止符可以出现在数据中，那么最好使用 TAB 或 PIPE 分隔符（或任何适用于您的数据的）。

> 如果数据中出现终止符，则将其解释为终止符，而不是数据，并且该字符之后的数据被解释为属于下一个字段或记录。因此，请仔细选择您的终止符，以确保它们永远不会出现在您的数据中

[http://msdn.microsoft.com/en-us/library/ms191485.aspx](http://msdn.microsoft.com/en-us/library/ms191485.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-30T20:25:21.767

数据字段中的分隔符是分隔文件的常见问题。解决此问题的一些常见策略包括：

1.  重新创建数据文件，并在将数据字段写入文件之前将所有出现的定界符从数据字段中剥离出来：这会消除 OPENROWSET 错误，但不会保留数据的完整性。
2.  使用不同的分隔符重新创建数据文件：根据我的经验，制表符分隔符是更好的选择。在数据中遇到制表符比遇到逗号要少见。但这肯定不是闻所未闻的。我也看到了数据中的标签。
3.  用双引号将数据字段括起来：这需要对 XML 格式文件进行一些调整。

对于上述任何选项，手动编辑数据文件可能是可行的。但这可能很乏味，尤其是对于大文件。（只需在 Notepad.exe 中打开几个 GB 的文件是一种耐心练习。）实际上，您希望作者为您重新创建它。选项 #1 应该始终“有效”。但同样，您可能无法忍受数据完整性问题。选项 #2 可能适用于许多情况，但它不是万无一失的。选项#3 也不是万无一失的（在数据字段中总是*可以*有一个分隔符），但它几乎是你能得到的。此外，它还保留了数据完整性。

这是您的 XML 格式文件的一种可能性：

```
<?xml version="1.0"?>
<BCPFORMAT xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 <RECORD>
  <FIELD ID="1" xsi:type="CharTerm" TERMINATOR='","' MAX_LENGTH="5"/>
  <FIELD ID="2" xsi:type="CharTerm" TERMINATOR='","' MAX_LENGTH="128" COLLATION="SQL_Latin1_General_CP1_CI_AS"/>
  <FIELD ID="3" xsi:type="CharTerm" TERMINATOR='"\r\n' MAX_LENGTH="128" COLLATION="SQL_Latin1_General_CP1_CI_AS"/>
 </RECORD>
 <ROW>
  <COLUMN SOURCE="1" NAME="Reference" xsi:type="SQLVARYCHAR"/>
  <COLUMN SOURCE="2" NAME="Name" xsi:type="SQLVARYCHAR"/>
  <COLUMN SOURCE="3" NAME="Street" xsi:type="SQLVARYCHAR"/>
 </ROW>
</BCPFORMAT> 
```

注意 FIELD TERMINATOR：我使用单引号来标识`","`终止符和`"\r\n`行终止符（COLUMN 3 终止符）。我做了一个有根据的猜测，`Name`最多`Street`有 128 个字符——根据需要进行编辑。

问题：

1.  OPENROWSET() 查询将返回`Reference`前导`"`双引号字符。也正因为如此...
2.  `Reference`不能作为 INT（或 SMALLINT、BIGINT 等）返回。它以 VARCHAR ( `xsi:type="SQLVARYCHAR"`)形式返回

对于提供的特定数据示例，我将删除`Reference`数据字段中的双引号，调整 XML 格式文件以使其`FIELD ID="1"`具有`TERMINATOR=',"'`，并进一步调整 XML 格式文件以使其`COLUMN SOURCE="1"`具有`xsi:type="SQLINT"`。

有关其他信息，此博客文章可能会有所帮助：[OPENROWSET 和 BULK Rowset Provider 入门 - 第 2 部分](http://itsalljustelectrons.blogspot.com/2016/01/Openrowset-Bulk-Rowset-Provider-Part-2.html)

# java - 动态更改@ManagedResource objectName

> ID：11506486
> 
> 赞同：8
> 
> 时间：2012-07-16T14:30:43.163
> 
> 标签：java, spring, jmx, spring-3

我正在以编程/动态方式创建原型 bean。我希望启动后的这些 bean 在 jmx 控制台中。我如何区分它们？我正在使用注释来将我的 bean 添加到 jmx 并且我有

```
@ManagedResource(objectName="bean:name=MybBean") 
```

我需要动态注入 objectName。知道我该怎么做吗？

这是我的 jmx 配置：

```
<context:mbean-export server="mbeanServer" />

<bean id="mbeanServer" class="org.springframework.jmx.support.MBeanServerFactoryBean" />

<bean id="exporter" class="org.springframework.jmx.export.MBeanExporter"
        lazy-init="false">

        <property name="beans">
            <map>
                <entry key="Server:name=HttpAdaptor">
                    <bean class="mx4j.tools.adaptor.http.HttpAdaptor">
                        <property name="port" value="8000" />
                        <property name="host" value="0.0.0.0" />
                        <property name="processor">
                            <bean class="mx4j.tools.adaptor.http.XSLTProcessor" />
                        </property>

                    </bean>
                </entry>                
            </map>
        </property>
        <property name="listeners">
            <list>
                <!--

                -->
                <bean class="com.fixgw.jmx.HttpAdaptorMgr">
                    <property name="mbeanServer" ref="mbeanServer" />
                </bean>
            </list>
        </property>
    </bean>

   <bean id="sessionMDB" class="com.fixgw.mdb.SessionMDB"
        scope="prototype" lazy-init="true">
        <constructor-arg ref="0" />
        <constructor-arg ref="0" />
    </bean> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-21T06:09:24.967

你可以通过实现来做到这一点[`org.springframework.jmx.export.naming.SelfNaming`](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jmx/export/naming/SelfNaming.html)：

```
@Component("MyPrototypeScopedBeanName")
@ManagedResource     
public class MyPrototypeScopedBeanName implements SelfNaming
{
    @Override
    public ObjectName getObjectName() throws MalformedObjectNameException {
        return new ObjectName("com.foobar", "name", this.toString());
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T14:40:15.700

您可以使用 JMX 命名策略来执行此操作。在工作中我们使用一个接口：

```
public interface RuntimeJmxNames {
    /** this is the name= part of the object name */
    public String getJmxName();
    /** this sets the folders as 00=FirstFolder,01=Second */
    public String[] getJmxPath();
} 
```

我已经发布了实现[RuntimeMetadataNamingStrategy 命名策略](http://pastebin.com/XyYSiV2e)的代码。

然后类似于以下 Spring bean：

```
<bean id="jmxAttributeSource"
 class="org.springframework.jmx.export.annotation.AnnotationJmxAttributeSource" />

<bean id="jmxAssembler"
    class="org.springframework.jmx.export.assembler.MetadataMBeanInfoAssembler">
    <property name="attributeSource" ref="jmxAttributeSource" />
</bean>

<bean id="jmxNamingStrategy" class="com.j256.jmx.RuntimeMetadataNamingStrategy">
    <property name="attributeSource" ref="jmxAttributeSource" />
</bean>

<bean id="mbeanExporter" class="org.springframework.jmx.export.MBeanExporter">
    <property name="autodetect" value="true" />
    <property name="assembler" ref="jmxAssembler" />
    <property name="namingStrategy" ref="jmxNamingStrategy" />
    <property name="ensureUniqueRuntimeObjectNames" value="false" />
    <property name="excludedBeans" ref="excludedJmxBeans" />
</bean> 
```

在您的代码中，您执行以下操作：

```
@ManagedResource(objectName = "foo.com:name=replaced", description = "...")
public class Foo implements RuntimeJmxNames {
    ...
    public String getJmxName() {
        // here's where you can make the name be dynamic
        return toString();
    }
    @Override
    public String[] getJmxPath() {
        return new String[] { "folder" };
    }
} 
```

[这是关于JMX 命名](http://static.springsource.org/spring/docs/2.0.x/reference/jmx.html)的 Spring 文档，尽管我不能 100% 确定它涵盖了自定义命名的内容。

此外，我的[SimpleJMX 包](http://256stuff.com/sources/simplejmx/)也可以做到这一点。它使用一个[JmxSelfNaming 接口](http://256stuff.com/sources/simplejmx/javadoc/simplejmx/com/j256/simplejmx/common/JmxSelfNaming.html)，该接口允许对象的每个实例定义它自己的 bean-name 以使它们独一无二并且与 Spring 配合得很好。

# entity-framework - 使用实体框架跨多个表创建动态查询？

> ID：11506487
> 
> 赞同：1
> 
> 时间：2012-07-16T14:30:47.527
> 
> 标签：entity-framework, linq-to-entities

[我正在尝试按照使用实体框架创建动态查询](https://stackoverflow.com/questions/5541234/creating-dynamic-queries-with-entity-framework)中的模式在几个表中创建搜索功能

我有 3 张桌子：

```
 People:
        pk ID
        varchar FirstName
        varchar LastName
        fk AddressMap_ID

   AddressMap:
        pk ID

   Address:
        pk ID
        varchar StreetName
        varchar StreeNumber
        fk AddressMap_ID 
```

多个人可以住在一个地址。我传入一个 Search 模型，并填充 results 属性：

```
public class Search
{
   public string streetname { get; set; }
   public string streetnumber { get; set; }
   public string fname { get; set; }
   public string lname { get; set; }
   public IEnumerable<Results> results { get; set; }
}
public class Results
{
   public int AddressID { get; set; }
   public string StreetNumber { get; set; }
   public string StreetName { get; set; }
   public IEnumerable<PeopleResults> people { get; set; }
}
public class PeopleResults
{
   public int personID { get; set; }
   public string First { get; set; }
   public string Last { get; set; }
} 
```

如果我过滤地址或名称+地址，则此方法有效：

```
public void GetResults(Search model)
{
  Entities _context;
  _context = new Entities();

  var addr = from a in _context.Addresses
             select a;
  addr = addr.Where(filter => filter.StreetNumber == model.streetnumber);
  addr = addr.Where(filter => filter.StreetName == model.streetname);
  addr = from a in addr
         group a by a.AddressMap_ID into addrs
         select addrs.FirstOrDefault();

  var ppl = from p in addr.SelectMany(p => p.AddressMap.People) select p;
  ppl = ppl.Where(filter => filter.FirstName.StartsWith(model.fname));
  ppl = ppl.Where(filter => filter.LastName.StartsWith(model.lname));

  model.results = from a in addr
                  select new Results
                  {
                     AddressID = a.ID,
                     StreetName = a.StreetName,
                     StreetNumber = a.StreetNumber,
                     people = from p in ppl
                              select new PeopleResults
                              {
                                 First = p.FirstName,
                                 Last = p.LastName
                              }
                  };
} 
```

但是，如果我只是尝试过滤一个名称，它会返回一个笛卡尔连接 - 每个地址都包含所有匹配的人。

有 3 种搜索方式：仅按地址过滤、按地址 + 名称过滤或仅按名称过滤。

所以如果有人搜索“123 Main”，结果应该是

```
123 Main St  SticksVille   Joe Smith
                           Jane Smith
                           Mary Smith

123 Main St  Bedrock       Fred Flintstone
                           Wilma Flintstone 
```

搜索“J Smith 123 Main”应该只返回：

```
123 Main St  SticksVille   Joe Smith
                           Jane Smith 
```

只搜索“J Smith”应该会返回：

```
123 Main St  SticksVille   Joe Smith
                           Jane Smith

456 Another St Sometown    Jerry Smith 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:30:49.683

看起来像这样的方法可能会奏效：

```
IQueryable<Person> ppl = _context.People;
ppl = addr.Where(filter=>filter.First.StartsWith(model.fname));
ppl = addr.Where(filter=>filter.Last.StartsWith(model.lname));
var pplIds = ppl.Select(p => p.PersonId);

model.results = from a in addr
                where a.AddressMap.People.Any(p => pplIds.Contains(p.PersonId))
                select new Results {
                          AddressID = a.ID,
                          StreetName = a.StreetName,
                          StreetNumber = a.StreetNumber,
                          people = from p in a.People
                                   select new PeopleResults {
                                         First = p.FirstName,
                                         Last = p.LastName
                                   }
                }; 
```

您不想将`people`属性基于匹配的人，而是希望将整个地址集基于匹配的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T20:03:02.723

就人员和地址而言，您的查询对我来说看起来是“对称的”，它只会在最终的投影结果中变得“不对称”。所以，我的想法是尽可能在查询中表达这种对称性：

*   获取一组`IQueryable<Address>`按街道名称和街道号码过滤的地址（ ，不立即执行）

*   获取`IQueryable<Person>`按名字和姓氏开头过滤的一组人（ ，不立即执行）

*   通过 加入两组`AddressMap_ID`。生成的人员和地址集仅包含满足地址*和*人员过滤条件的那些对。如果未提供人员或地址的过滤条件之一（问题底部的第一个和第三个示例），则连接发生在所有人员/地址的未过滤集上，即连接对始终包含所有人被过滤的地址（或被过滤的人的所有地址）

*   按以下方式对加入的人员和地址对进行分组`Address.ID`

*   将组投影到您的`Results`收藏中。组键是`AddressID`. `StreetName`并且`StreetNumber`可以从每个组中的第一个地址获取，并且从每个组中`people`的人投影。

*   执行查询

以下代码未具体涵盖未提供四个过滤条件的情况。它在这种情况下有效，但只会将所有地址与这些地址的所有人一起加载。也许你想在这种情况下抛出一个异常。或者什么都不返回（`model.Results = null`左右），然后直接跳出方法。

```
public void GetResults(Search model)
{
    using (var _context = new Entities())
    {
        // "All" addresses
        IQueryable<Address> addresses = _context.Addresses;
        // "All" people
        IQueryable<Person> people = _context.People;

        // Build a Queryable with filtered Addresses
        if (!string.IsNullOrEmpty(model.streetname))
            addresses = addresses.Where(a => a.StreetName
                                              .StartsWith(model.streetname));
        if (!string.IsNullOrEmpty(model.streetnumber))
            addresses = addresses.Where(a => a.StreetNumber
                                              .StartsWith(model.streetnumber));

        // Build a Queryable with filtered People
        if (!string.IsNullOrEmpty(model.fname))
            people = people.Where(p => p.FirstName == model.fname);
        if (!string.IsNullOrEmpty(model.lname))
            people = people.Where(p => p.LastName == model.lname);

        // Join the two Queryables with AddressMap_ID
        // and build group by Address.ID containing pairs of address and person
        // and project the groups into the Results collection
        var resultQuery = from a in addresses
                          join p in people
                            on a.AddressMap_ID equals p.AddressMap_ID
                          group new { a, p } by a.ID into g
                          select new Results
                          {
                              AddressID = g.Key,
                              StreetName = g.Select(ap => ap.a.StreetName)
                                            .FirstOrDefault(),
                              StreetNumber = g.Select(ap => ap.a.StreetNumber)
                                              .FirstOrDefault(),
                              people = g.Select(ap => new PeopleResults
                              {
                                  First = ap.p.FirstName,
                                  Last = ap.p.LastName
                              })
                          };

        // Execute query (the whole code performs one single query)
        model.results = resultQuery.ToList();
    }
} 
```

我不确定我是否将`AddressMap`表正确解释为一种多对多关系的连接表（`Address`可以有很多人，`Person`可以有很多地址），但上面的代码在您的示例中产生了三个查询的三个结果正如预期的那样，如果表格是这样填充的：

![在此处输入图像描述](../Images/1b1a3e9de3dab7054b020465e5b3a347.png)

该`AddressMap`表实际上并未在查询中使用，因为`Addresses`表是通过列`People`直接连接的。`AddressMap_ID`

# ibm-midrange - 如何从 ILE 程序中读取 liblist？（最好是RPG或CL）

> ID：11506488
> 
> 赞同：3
> 
> 时间：2012-07-16T14:30:47.540
> 
> 标签：ibm-midrange, environment, rpgle

我们通过使用不同的库列表运行它们来控制我们在 as400 上的程序工作的对象。但是有些操作不能直接控制。因此，我的程序需要读取 liblist 并决定其中的一些库，如何操作。

我找不到任何 api 来从程序中读取 liblist 条目。我期望的是某种 api，它可以让我按优先级遍历 liblist 条目，或者按照 liblist 给出的顺序给我一个数组。如果可能，我更喜欢 RPG 或 CL，但也可以使用其他 ILE 语言。

（如果您想知道为什么我要这样做，我问了另一个问题，它解释了我面临的封闭问题：[如何在由作业库列表控制的两个不同库之一中创建 DTAQ？](https://stackoverflow.com/questions/11507092/how-can-i-create-a-dtaq-in-one-of-two-different-libs-controlled-by-the-jobs-lib) 但是liblist 解析是一种解决该问题的方法，并且是一个单独的问题）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T15:06:32.543

您可以使用[QUSRJOBI API](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/apis/qusrjobi.htm#HDRJOBI7)来检索作业的库列表。您还可以使用 CL 命令 ADDLIBLE 并监视错误消息 CPF2103（库列表中已存在库）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T15:09:47.967

[List Objects (QUSLOBJ)](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/apis/quslobj.htm) API可用于检索库列表。

> **对象和库名称**
> 当 *ALLUSR 指定库名称 *LIBL 和对象类型参数 *LIB 时，返回线程库名称空间中所有用户库的列表。指定 *LIBL 时，如果指定了辅助存储池 (ASP) 控制参数，则辅助存储池 (ASP) 设备名称必须是星号 (*)。用户库的定义参见本参数后10个字符的说明中的*ALLUSR。

更改库[列表 (QLICHGLL)](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/apis/qlichgll.htm) API 可用于更改库列表。

RTVJOBA命令可以检索[SYSLIBL](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/cl/rtvjoba.htm)、[CURLIB](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/cl/rtvjoba.htm#RTVJOBA.CURLIB)和[USRLIBL](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/cl/rtvjoba.htm#RTVJOBA.SYSLIBL) [。](http://publib.boulder.ibm.com/infocenter/iseries/v7r1m0/topic/cl/rtvjoba.htm#RTVJOBA.USRLIBL)

* * *

这本书[APIs at work，第 3 章，List APIs](http://bit.ly/NO1XcY)有很多信息可以帮助你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T18:15:13.640

一个更简单的替代方法可能是值得的，具体取决于您的情况。如果您事先知道目标库，也许您可​​以在每个库中创建一个包含库名称的数据区。您的程序将读取它首先在库列表中找到的任何数据区域，并为您提供库的名称以供您创建数据队列。

它并不复杂，但有效且非常简单，因此也更容易编码/调试/维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-17T12:09:06.423

Kratenko，如果您想要比 API 更简单、更少的代码替代方案。创建可以在 rpg 中调用的简单 CL pgm。您的 cl 可以拥有 RTVJOBA（有获取 libl 的参数）。您可能会从中获得许多库，并且您需要解析和识别您想要的特定库？关于识别你必须知道其中的一个限定词。您想要运行 pgm 的库还是“某些”文件所在的库？如果是，那么您可以使用 RTVOBJD 来获取特定的库。然后在您的 CRTDTAQ cmds 中使用该库。

# email - 如何创建一个从右到左对齐的电子邮件主题行，其中包含一些从左到右的文本

> ID：11506491
> 
> 赞同：2
> 
> 时间：2012-07-16T14:30:56.870
> 
> 标签：email, right-to-left

我正在创建一个从右到左文本对齐的阿拉伯语电子邮件，html 部分很好，但我需要为邮件创建一个主题行，其中部分文本是从左到右英语。问题是主题行不会呈现任何 css 或 html 代码，并且将以纯文本形式输出。因此，在某些电子邮件代理中，英文文本位于右侧，而在某些代理中，英文文本位于文本左侧。我的问题是如何创建在一行中包含阿拉伯语和英语的主题行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:49:22.583

这可能不是你想听到的，但我不认为这是可以做到的。正如您所说，主题行是纯文本，不支持任何格式的格式（例如，您不能将其设为粗体或斜体）。

主题的位置取决于电子邮件客户端，并且在大多数情况下可能还取决于操作系统的本地化。主题的格式化基本上只能通过修改电子邮件客户端的设置来完成，而电子邮件本身无法做到这一点。

# php - Magento - 获取当前产品

> ID：11506492
> 
> 赞同：19
> 
> 时间：2012-07-16T14:30:59.497
> 
> 标签：php, magento, caching

我的布局中有一个侧边栏块，它显示在不同的页面上。

在这个块中，我有一个产品列表，我想在产品页面上选择当前产品。

我在用着 ：

```
$current_product = Mage::registry('current_product'); 
```

获取当前产品，但这仅适用于我第一次加载产品页面。当我选择不同的产品时，上面的代码返回相同的值（第一个产品）。

我假设发生这种情况是因为我正在使用 Magento 缓存。我该怎么做才能获得正确的价值？

当我使用时也会发生同样的事情：

```
$currentCategory = Mage::registry('current_category'); 
```

侧边栏块是我在此处添加的导航模板：..\app\design\frontend\default\mytheme\template\catalog\navigation\page_left.phtml。

我用这个 XML 将它添加到布局中：

```
<block type="catalog/navigation" name="left.navigation.block" as="left.navigation.block" template="catalog/navigation/page_left.phtml"/> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-20T10:41:51.850

如何获取当前产品ID

尝试以下代码以获取当前加载的产品 ID：

```
$product_id = $this->getProduct()->getId(); 
```

当您无权访问 $this 时，您可以使用 Magento 注册表：

```
$product_id = Mage::registry('current_product')->getId(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T14:53:39.930

如果您不愿意使用自己的继承自 的块类`Mage_Catalog_Block_Navigation`，您可以在其中设置自己的缓存信息（例如，根据当前产品进行设置），您可以通过在它的布局定义：

```
<block type="catalog/navigation" name="left.navigation.block" as="left.navigation.block" template="catalog/navigation/page_left.phtml">
    <action method="unsetData"><key>cache_lifetime</key></action>
</block> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-30T06:44:42.607

```
$_proId  = $this->getProduct()->getId();
$_product= Mage::getModel('catalog/product')->load($_proId); 
```

这确实有效。它在上面被否决了，但它对我有用。我了解该产品在您使用时确实会加载`getProduct()`，但是，我只获得了该产品的部分信息。获取 ID 并重新加载产品会带回所有信息。

它可能特定于 Magento 的某个版本，但它确实有效，尽管它看起来很愚蠢。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-07-16T14:47:43.413

您可以从以下代码中获取当前的产品 ID 和产品详细信息。

```
$_proId  = $this->getProduct()->getId();
$_product= Mage::getModel('catalog/product')->load($_proId); 
```

# apache-flex - Windows 上的 AIR 中不再发送 flex amf 请求

> ID：11506497
> 
> 赞同：0
> 
> 时间：2012-07-16T14:31:12.837
> 
> 标签：apache-flex, air

我有一个在浏览器中运行的 Flex 应用程序，并作为 AIR 的独立应用程序运行。在我们的应用程序中，您可以下载在服务器端生成的包含报告的 zip 文件。这个 zip 文件可能非常大（数 GB）并且需要一段时间才能下载。基本上，我们从客户端执行 HTTP POST：

```
m_file = new FileReference();
m_file.download( request, filename ); 
```

另一方面，我们每 15 秒从客户端向服务器发送一次 ping，以确保服务器仍然存在。服务器用他的名字响应 ping。当我们在 30 秒内没有得到响应时，我们会向用户显示服务器已关闭的消息。

现在，实际的问题是，在我们下载报告时，对服务器的 ping 请求永远不会被发送。奇怪的是，*这只发生在 Windows 上的 Adob​​e AIR 中*。在 Windows 上的 Firefox 上这*不是问题。*Mac OS X 上的 AIR 也不是问题*。*

我在 ping 操作周围放置了一些日志来显示它：

```
[trace] 1: Mon Jul 16 16:00:20 GMT+0200 2012
[trace] return : 1: Mon Jul 16 16:00:20 GMT+0200 2012
[trace] 2: Mon Jul 16 16:00:35 GMT+0200 2012
[trace] return : 2: Mon Jul 16 16:00:35 GMT+0200 2012
[trace] 3: Mon Jul 16 16:00:50 GMT+0200 2012
[trace] return : 3: Mon Jul 16 16:00:50 GMT+0200 2012
[trace] 4: Mon Jul 16 16:01:05 GMT+0200 2012
[trace] 5: Mon Jul 16 16:01:20 GMT+0200 2012
[trace] 6: Mon Jul 16 16:01:35 GMT+0200 2012
[trace] 7: Mon Jul 16 16:01:50 GMT+0200 2012
[trace] fault 4: Mon Jul 16 16:02:05 GMT+0200 2012
[trace] fault 5: Mon Jul 16 16:02:05 GMT+0200 2012
[trace] fault 6: Mon Jul 16 16:02:05 GMT+0200 2012
[trace] fault 7: Mon Jul 16 16:02:05 GMT+0200 2012
[trace] 8: Mon Jul 16 16:02:05 GMT+0200 2012
[trace] fault 8: Mon Jul 16 16:02:20 GMT+0200 2012
[trace] 9: Mon Jul 16 16:02:21 GMT+0200 2012
Player session terminated
[AIR Debug Launcher]: Process finished with exit code 1 
```

您可以看到操作 1、2 和 3 运行良好并立即返回。此时，我们开始下载报告。注意操作 4 不会立即返回。15 秒后，操作 5 开始，然后是 6 和 7，各间隔 15 秒。然后突然，恰好在 1 分钟之后，操作 4 像在那一分钟内启动的所有其他请求一样返回到故障处理程序。

Note that in the background, the HTTP POST keeps running as long as the AIR app keeps running (checked with [Charles](http://www.charlesproxy.com)). The ping request itself does not show up in charles, nor do I see them in the BlazeDS debug loggin if I enable that. It is like the AIR application never even tries to do the ping request on the server.

Is there anybody who has an idea what might be wrong? Any additional things I can check/debug?

I am using Flex SDK 4.5 and Adobe AIR 3.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T08:33:54.720

Maybe this is due to a HTTP connection limit on Windows. I found this post that describes a similar issue: [Adobe AIR HTTP Connection Limit](https://stackoverflow.com/questions/7645763/adobe-air-http-connection-limit)

# php - 带有 reCAPTCHA 的可配置联系表？

> ID：11506500
> 
> 赞同：1
> 
> 时间：2012-07-16T14:31:24.253
> 
> 标签：php, html, recaptcha, contact-form

在过去的一个小时（以及今天之前的几次），我一直在网上寻找一个使用 reCAPTCHA 并且易于配置的简单的联系表格。我需要能够轻松地创建新字段和需要字段，而无需进入并编写大量 PHP（我对此只有基本的了解）。

要求清单：

*   轻松创建新字段，如下所示：`input type="text" name="example-name"`
*   轻松指定需要哪些字段，类似于：`input type="hidden" name="required" value="field-name,field-name"`
*   轻松设置表单应发送到的电子邮件地址，类似于：`input type="hidden" name="recipient" value="email@example.com"`

所有的代码示例只是示例，显然它们可以不同，我只需要类似简单的东西。我将在许多不同的网站上使用这个脚本，所以简单是必要的。我想使用 reCAPTCHA，但如有必要，它可以是其他形式的 CAPTCHA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-18T14:19:24.233

哇，好久没发这个了！我很久以前就知道了。Tectite 的 Formmail 脚本与 reCAPTCHA 完美集成。

[https://www.tectite.com/dlformmail.php](https://www.tectite.com/dlformmail.php)

# database - 快速的写入性能，即使读取速度非常慢

> ID：11506505
> 
> 赞同：0
> 
> 时间：2012-07-16T14:31:47.530
> 
> 标签：database, performance, insert, scalable

抱歉，如果已经有答案，我搜索了它，但没有找到我的方案。

又是一个类似“什么是最快/最佳性能数据库？”之类的问题。但由于答案取决于场景，我的场景是这样的：我想将许多日志写入数据库，每秒数千。但我不会经常阅读它们。确实，其中 99,99% 将永远不会再被阅读，但有时我需要阅读。模式并不复杂，只是键/值。偶尔我会按价值阅读，如果阅读需要几分钟，我根本不在乎。读取的正确性至关重要，但对性能而言并不重要。

到目前为止，最好的解决方案似乎是 MongoDB、Cassandra……也许是最好的 DynamoDB？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:57:58.053

我想说，任何 DBMS 都切换到最低的隔离级别并且没有索引。如果你把它和一个好的存储系统放在一起，也许是一个带有 SSD 的 RAID 0。禁食永远写。

很难说哪个 DBMS 是最好的，通常你想要最好的 dbms，它特别擅长做某事，但你需要一个基本上只写限制最少的东西的 dbms，我听说 mysql 在这方面可以做得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T17:13:14.017

如果您追求的是快速写入，那么您有几个选择。假设您将是维护数据库的人，您可以将插入写入内存，并在它们达到一定大小后刷新它们。这样你就不会多次敲击磁盘。

如果我没记错的话，MongoDB 已经这样做了，而且如果你禁用日志，它可以大大提高写入性能，这正是你想要的。

无论哪种方式，缓存和批量插入都是适用于任何数据库的方式。

# java - 计算数组中单词的出现次数

> ID：11506509
> 
> 赞同：0
> 
> 时间：2012-07-16T14:31:59.353
> 
> 标签：java, arrays, vector

我一直在做一些事情，它需要一个字符流，形成单词，创建一个单词数组，然后创建一个包含每个唯一单词及其出现次数的向量（基本上是一个单词计数器）。

无论如何，我已经很长时间没有使用 Java，或者说实话，我对它目前的外观并不满意。我拥有的部分让矢量看起来很难看，我想知道我是否可以让它不那么凌乱。

```
 int counter = 1;
    Vector<Pair<String, Integer>> finalList = new Vector<Pair<String, Integer>>();
    Pair<String, Integer> wordAndCount = new Pair<String, Integer>(wordList.get(1), counter); // wordList contains " " as first word, starting at wordList.get(1) skips it.

    for(int i= 1; i<wordList.size();i++){
        if(wordAndCount.getLeft().equals(wordList.get(i))){
            wordAndCount = new Pair<String, Integer>(wordList.get(i), counter++);
        }
        else if(!wordAndCount.getLeft().equals(wordList.get(i))){
            finalList.add(wordAndCount);
            wordAndCount = new Pair<String, Integer>(wordList.get(i), counter=1);
        }
    }
    finalList.add(wordAndCount); //UGLY!! 
```

作为第二个问题，这给了我一个所有单词按字母顺序排列的向量（如数组中）。我想让它按出现次数排序，其中的字母顺序。

最好的选择是：

*   向下迭代向量，用上面的一个测试每个出现的 int，`Collections.swap()`如果它更高，然后检查上面的下一个（因为它现在向上移动 1），依此类推，直到它不再大于它上面的任何东西。可以跳过任何出现的 1。

*   再次向下迭代向量，针对向量的第一个元素测试每个元素，然后向下迭代，直到出现次数减少并将其插入该元素上方。将再次跳过所有出现的 1。

第一种方法在迭代元素方面做得更多，但第二种方法需要您添加和删除向量的组件（我认为？）所以我不知道哪个更有效，或者是否值得考虑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:40:42.277

为什么不使用 a`Map`来解决您的问题？

```
String[] words // your incoming array of words.
Map<String, Integer> wordMap = new HashMap<String, Integer>();
for(String word : words) {
  if(!wordMap.containsKey(word))
    wordMap.put(word, 1);
  else
    wordMap.put(word, wordMap.get(word) + 1);
} 
```

可以使用 Java 的排序集合进行排序：

```
SortedMap<Integer, SortedSet<String>> sortedMap = new TreeMap<Integer, SortedSet<String>>();
for(Entry<String, Integer> entry : wordMap.entrySet()) {
  if(!sortedMap.containsKey(entry.getValue()))
    sortedMap.put(entry.getValue(), new TreeSet<String>());

  sortedMap.get(entry.getValue()).add(entry.getKey());
} 
```

现在你应该把排序留给语言的库。多年来，它们已被证明是正确的。

请注意，由于涉及的所有数据结构，代码可能会使用大量内存，但这是我们为更高级别的编程支付的费用（并且内存每秒钟都在变得更便宜）。

我没有运行代码来查看它是否有效，但它确实可以编译（直接从 eclipse 复制）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:46:43.323

re：排序，一种选择是编写一个自定义`Comparator`，首先检查每个单词出现的次数，然后（如果相等）按字母顺序比较单词。

```
private final class PairComparator implements Comparator<Pair<String, Integer>> {
    public int compareTo(<Pair<String, Integer>> p1, <Pair<String, Integer>> p2) {
        /* compare by Integer */
        /* compare by String, if necessary */
        /* return a negative number, a positive number, or 0 as appropriate */
    }
} 
```

然后你会`finalList`通过调用排序`Collections.sort(finalList, new PairComparator());`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T15:53:19.707

使用谷歌番石榴库怎么样？

```
 Multiset<String> multiset = HashMultiset.create();
   for (String word : words) {
       multiset.add(word);
   }

   int countFoo = multiset.count("foo"); 
```

从他们的javadocs：

支持顺序无关相等的集合，如 Set，但可能有重复元素。多重集有时也称为包。

够简单吗？

# javascript - 没有 jquery 或 iframe 的 AJAX 文件上传/表单提交？

> ID：11506510
> 
> 赞同：8
> 
> 时间：2012-07-16T14:32:00.777
> 
> 标签：javascript, ajax, struts, asyncfileupload

是否可以在没有 jQuery 或 IFrames 的情况下提交 AJAX 表单（所以只是纯 JavaScript）？我目前正在发送到一个有效的 struts fileUploadAction。操作的代码是否仍可用于异步提交，或者是否需要添加异步表单提交？

我正在使用 struts 1.x，目前我的形式是：

```
<html:form action="fileUploadAction" method="post" enctype="multipart/form-data">
    ...form elements...
    <html:file property="theFile" />
    ...other elements...
</html:form> 
```

可以提交此表单，从而使用 AJAX 上传文件吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-19T07:03:06.167

如果我的理解正确，您可以使用以下代码异步上传文件。随意修改

```
var AjaxFileUploader = function () {
    this._file = null;
    var self = this;

    this.uploadFile = function (uploadUrl, file) {
        var xhr = new XMLHttpRequest();
        xhr.onprogress = function (e) {
            ...
        };

        xhr.onload = function (e) {
            ...
        };

        xhr.onerror = function (e) {
            ...
        };

        xhr.open("post", uploadUrl, true);

        xhr.setRequestHeader("Content-Type", "multipart/form-data");
        xhr.setRequestHeader("X-File-Name", file.name);
        xhr.setRequestHeader("X-File-Size", file.size);
        xhr.setRequestHeader("X-File-Type", file.type);

        xhr.send(file);
    };
};

AjaxFileUploader.IsAsyncFileUploadSupported = function () {
    return typeof (new XMLHttpRequest().upload) !== 'undefined';
}

 if (AjaxFileUploader.IsAsyncFileUploadSupported) {
        ajaxFileUploader = new AjaxFileUploader();

        $("form").submit(function () {
            var uploader = $("#fileUploader")[0];

            if (uploader.files.length == 0) {
                return;
            } else {
                ajaxFileUploader.uploadFile(
                    "/YourUploadUrl",
                    uploader.files[0]);
            }

            return false;
        });
    } 
```

要上传表单，请使用 FormData 类，使用表单值填充它并使用 XHR 发布它。

**更新：** 对于 HTML4，请尝试以下操作

*   [http://www.albanx.com/?pid=5&subid=21](http://www.albanx.com/?pid=5&subid=21)
*   [使用jsp和javascript进行异步文件上传（AJAX文件上传）](https://stackoverflow.com/questions/1276916/asynchronous-file-upload-ajax-file-upload-using-jsp-and-javascript)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T17:01:37.467

[http://fineuploader.com/](http://fineuploader.com/)是一个 ajax 文件上传器。

> 该插件使用 XHR 在 FF3.6+、Safari4+、Chrome 中使用进度条上传多个文件，并在其他浏览器中回退到基于隐藏 iframe 的上传，在任何地方提供良好的用户体验。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2015-09-02T10:39:41.977

无需添加 jquery 或任何其他第三方库，只需添加 IPerfect JS 库即可。

IP_uploadFile(URL,responseType,this[object],[dynamicFunctionForResponse])

如果用户选择 responseType 为“html”，那么 dynamicFunctionForResponse 将获得 HTML 格式的响应。在下面的示例中，您将在警报中获得“完成”响应。

HTML

```
 <script type="text/javascript" src="http://services.iperfect.net/js/IP_generalLib.js"></script>

    <script language='javascript'>
    function testResponse(data){
    alert(data)
    }
    </script> 
```

身体

```
 <form method="POST" enctype="multipart/form-data"  onsubmit="IP_uploadFile('testupload.php','html',this,testResponse); return false;">
        <input type="file" name="file1">
        <input type="submit" name="submit1" value="Click here">
    </form> 
```

PHP：测试上传.php

```
 move_uploaded_file($_FILES['file1']['tmp_name'], realpath("./")."/upload/".$_FILES["file1"]["name"]);
    echo "done"; 
```

# php - 使用 jquery validate 插件检查数据库中是否存在电子邮件

> ID：11506511
> 
> 赞同：1
> 
> 时间：2012-07-16T14:32:02.223
> 
> 标签：php, javascript, jquery, ajax, jquery-validate

我正在尝试使用 ajax 将表单提交到数据库。我已经成功地使用 AJAX 发布到数据库。但不是问题是我不确定如何检查提交的值是否已经存在于数据库中。

我已经有这样做的 php，但我正在尝试使用 AJAX。我正在使用**jquery validate 插件**以下是代码。

```
$('#subscribeForm').validate({
  errorElement: "p",
  errorPlacement: function(error, element) {
  $('.status').html(error);
},

rules: {
  email: {
    required: true,
    email: true,
    remote: {
        url: 'index.php',
        type: 'post',
        data: {
            email: function(){
            // not sure how to check this
        }
    }
}
}
},

messages: {
email: {
required: "Please enter your email.",
email: "Please enter a valid email.",
// remote: jQuery.format("{0} is already in use")  // doesnt work
}
},

submitHandler: function(form) {
var btn = $(".submit_button");
btn.attr("value", "Submitting..");

$(form).ajaxSubmit({
    success: function(){
        btn.attr("value", "Submitted");
    }
});
return false;
}
}); 
```

这是我的PHP：

```
if(isset($_REQUEST['subscribeForm'])){
$email = trim($_POST['email']);

if(empty($email) || !valid_email($email)){
    $status = 'Please provide valid email address.';
} else {
    if(email_exist($email)){
        $status = 'You are already subscribed.';
    } else {
        add_email($email);
        $status = 'Thank you for subscribing.';
    }
   }
 } 
```

# 编辑

这是我尝试过的，但又失败了。

```
if(isset($_REQUEST['subscribeForm'])){
$email = trim($_POST['email']);

if(empty($email) || !valid_email($email)){
    $status = 'Please provide valid email address.';
} else {
    if(email_exist($email)){
        $status = 'You are already subscribed.';
        echo false;
    } else {
        add_email($email);
        $status = 'Thank you for subscribing.';
        echo true;
    }
}
} 
```

还有我的 Javascript

```
rules: {
email: {
required: true,
email: true,
remote: {
  url: 'index.php',
  type: 'post'
   }
}
},

messages: {
 email: {
required: "Please enter your email.",
email: "Please enter a valid email.",
remote: "You are already subscribed."
   }
 }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:36:44.780

您应该在您的 JS 中做一些事情，以在返回“感谢您订阅”回声时执行成功功能。

尝试;

**Javascript**

```
messages: {
email: {
required: "Please enter your email.",
email: "Please enter a valid email.",
success: "Thank you for subscribing.",
// remote: jQuery.format("{0} is already in use")  // doesnt work
}
}, 
```

**PHP**

```
if(isset($_REQUEST['subscribeForm'])){
$email = trim($_POST['email']);

if(empty($email) || !valid_email($email)){
    $status = 'false';
} else {
    if(email_exist($email)){
        $status = 'false';
    } else {
        add_email($email);
        $status = 'true';
    }
   }
 }
echo $status; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:34:15.923

只需在您的 PHP 文件中回显错误代码并使用 Javascript 中的 AJAX 来解析错误代码并确定电子邮件是否已注册。

**PHP**：

```
define('ERROR_SUCCESS', 0);
define('ERROR_ALREADY', 1);
define('ERROR_INVALID', 2);

if (isset($_REQUEST['subscribeForm'])) {
    $email = trim($_POST['email']);

    if (empty($email) || !valid_email($email)) {
        $status = 'Please provide valid email address.';
        echo ERROR_INVALID;
    } else {
        if (email_exist($email)) {
            $status = 'You are already subscribed.';
            echo ERROR_ALREADY;
        } else {
            add_email($email);
            $status = 'Thank you for subscribing.';
            echo ERROR_SUCCESS;
        }
    }
} 
```

# google-chrome - 无法使用 Cygwin 从 Jenkins 运行 Chrome

> ID：11506514
> 
> 赞同：0
> 
> 时间：2012-07-16T14:32:13.390
> 
> 标签：google-chrome, windows-services, cygwin, jenkins, js-test-driver

我正在使用 Cygwin（在我的系统路径的前面）在 Windows XP 上使用 Jenkins 在本地测试 JsTestDriver。

Jenkins 调用一个 .sh 脚本，其中包含以下内容：

```
java -jar "D:\Tools\jstestdriverexample\JsTestDriver-1.3.4.b.jar" --port 9876 --server http://localhost:9876 --tests all --reset --config jsTestDriver-Jasmine.conf --testOutput results-jasmine --browser "C:/Program Files/Internet Explorer/iexplore.exe","C:/Program Files/Mozilla Firefox/firefox.exe","C:\Documents and Settings\alynch\Local Settings\Application Data\Google\Chrome\Application\chrome.exe" 
```

当包含谷歌浏览器时，詹金斯作业停止，我最终在控制台输出中得到这个错误：

```
Failures during test run.
Caused by:
Tried 1times: 
com.google.jstestdriver.util.RetryException: 
Failure 1: java.lang.NullPointerException
    at com.google.jstestdriver.util.RetryingCallable.call(RetryingCallable.java:62)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown 
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown 
    at java.util.concurrent.FutureTask.run(Unknown 
    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(Unknown Source)
    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(Unknown 
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException
    at com.google.jstestdriver.browser.CommandLineBrowserRunner.stopBrowser(CommandLineBrowserRunner.java:94)
    at com.google.jstestdriver.browser.BrowserControl.stopBrowser(BrowserControl.java:148)
    at com.google.jstestdriver.browser.BrowserCallable.call(BrowserCallable.java:30)
    at com.google.jstestdriver.util.RetryingCallable.call(RetryingCallable.java:49)
    ... 10 more

    at com.google.jstestdriver.browser.BrowserActionExecutorAction.run(BrowserActionExecutorAction.java:154)
    at com.google.jstestdriver.ActionRunner.runActions(ActionRunner.java:81)
    at com.google.jstestdriver.embedded.JsTestDriverImpl.runConfigurationWithFlags(JsTestDriverImpl.java:342)
at com.google.jstestdriver.embedded.JsTestDriverImpl.runConfiguration(JsTestDriverImpl.java:233)
    at com.google.jstestdriver.Main.main(Main.java:70)
Caused by:
Tried 1times: 
com.google.jstestdriver.util.RetryException: 
Failure 1: java.lang.NullPointerException 
```

如果我尝试在 Cygwin 中运行 Google Chrome，它可以工作，但我收到以下消息：

```
[5424:5192:3977000:ERROR:gpu_info_collector_win.cc(90)] Can't retrieve a valid WinSAT assessment. 
```

问题是我**将 Jenkins 作为 Windows 服务**运行并且它无法运行 Chrome，因为它需要以我的身份运行（我的用户配置文件）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:07:19.883

这些症状确实表明将 Jenkins 作为服务运行是问题所在。要确定是否确实如此，请在前台运行 Jenkins：

```
java -jar jenkins.war <other options> 
```

[您可以在此处](https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins)找到常用选项列表。

# c# - 使用C#截取Opera Mobile模拟器截图

> ID：11506516
> 
> 赞同：1
> 
> 时间：2012-07-16T14:32:17.983
> 
> 标签：c#, emulation, opera

有问题困扰了我好几天。。

我需要执行以下操作..启动一个进程（带有一些参数），找到该进程的窗口，对该窗口拍照，然后终止该进程，我需要重复此操作 X 次..

我可以使用 user32 启动该过程：找到它的主句柄，获取窗口大小，所以我知道图像的大小，将窗口位置设置为 0,0，并将其设为 topMost，然后使用 copyFromScreen 方法捕获该图像..从0,0到窗口大小..

所以看起来一切都很好，但是有一个我无法解决的问题..

当进程启动时，我注意到要使用 setWindowPos 本机函数，应该经过一段时间，所以我使用 Thread.sleep(x seconds)，但每个系统的时间都不同..这就是问题..我必须知道每个系统要延迟多长时间..我不能让不必要的大延迟，因为这个过程重复了数百次..每一毫秒都很重要，

请如果你有一些解决方案，我会很高兴听到..

该过程是opera mobile emulator ..其他解决方案是使用sendMessage，并更改url，而不是一遍又一遍地启动该过程..我会等待一次，但这也行不通..使用Spy ++我尝试找到有关该过程的详细信息，例如 className .. 它说无效窗口.. 所以我可能也不能使用 sendMessage ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:37:23.543

浏览器不是为这种用途而设计的。如果您想可靠地知道某些浏览器何时准备好渲染新页面并想要获取结果，请尝试实际集成到浏览器渲染引擎/核心中的东西。

对于完整的框架，请参阅[http://phantomjs.org/](http://phantomjs.org/)对于自己的解决方案 - 尝试将浏览器小部件直接嵌入到您的应用程序中，而不是与另一个进程交互。我确信.net 有正确的控制。通过这种方式，您可以直接挂钩相关事件，而不是猜测正确的延迟。

# c# - 向 nHibernate ICriteria 添加过滤器

> ID：11506520
> 
> 赞同：1
> 
> 时间：2012-07-16T14:32:30.450
> 
> 标签：c#, nhibernate, fluent-nhibernate, filtering, icriteria

我正在尝试使用 ICriteria 向此查询添加过滤器。在应用程序的其余部分中，我们使用了 linq 到 nHibernate，这些过滤器工作正常，但是当我们使用 I 标准时，它们会中断。

日期过滤器以这种方式工作正常，但是当它尝试为操作系统名称设置过滤器时会引发错误。

```
 var query =
            this.session.QueryOver<AppEvent>();

        if (StartDate.HasValue) query = query.Where(a => a.Time >= StartDate);
        if (EndDate.HasValue) query = query.Where(a => a.Time <= EndDate);
        if (!string.IsNullOrEmpty(OSVersion)) query = query.Where(a => a.App.Version == OSVersion);
        if (!string.IsNullOrEmpty(OSName)) query = query.Where(a=> a.App.OperatingSystemName == OSName);
        if (!string.IsNullOrEmpty(Model)) query = query.Where(a => a.Client.ClientInfos.Any(x => x.DeviceModel == Model));

        var executedSql = query.Where(a => a.Name == eventName)
            .Left.JoinQueryOver<AppEventParameter>(t => t.Parameters)
            .Where(r => r.ParameterKey.IsIn(parameters))
            .TransformUsing(Transformers.DistinctRootEntity)
            .List();

        var results = executedSql.Select(a => new DTO
                                              {
                                                  param1 = a.Parameters.FirstOrDefault(x => x.ParameterKey == "param1") == null ? "" : a.Parameters.First(x => x.ParameterKey == "param1").ParameterValue,
                                                  param2 = a.Parameters.FirstOrDefault(x => x.ParameterKey == "param2") == null ? "" : a.Parameters.First(x => x.ParameterKey == "param2").ParameterValue

                                              }).Distinct(new DTOUniqueComparer()); 
```

抛出的错误是：

```
NHibernate.QueryException : could not resolve property: App.OperatingSystemName of: Domain.Entities.AppEvent 
```

感谢您的提前帮助

编辑：我设法使用 JoinAlias 方法解决了它。在这里查看：

```
 if (StartDate.HasValue) query = query.Where(a => a.Time >= StartDate);
        if (EndDate.HasValue) query = query.Where(a => a.Time <= EndDate);
        if (!string.IsNullOrEmpty(OSVersion)) query = query.Where(a => a.App.Version == OSVersion);
        if (!string.IsNullOrEmpty(OSName)) query = query.JoinAlias(()=>appEventAlias.App,()=>appAlias).Where(()=>appAlias.OperatingSystemName==OSName);
        if (!string.IsNullOrEmpty(Model)) query = query.JoinAlias(()=>appEventAlias.Client, ()=>clientAlias).Where(()=>clientAlias.Id==appEventAlias.Client.Id).JoinAlias(()=>clientAlias.ClientInfos, () => clientInfoAlias).Where(()=>clientInfoAlias.DeviceModel == Model); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:33:12.043

我设法解决了它。最终需要使用 JoinAlias 方法。这是我解决过滤器的方法：

```
 if (StartDate.HasValue) query = query.Where(a => a.Time >= StartDate);
        if (EndDate.HasValue) query = query.Where(a => a.Time <= EndDate);
        if (!string.IsNullOrEmpty(OSVersion)) query = query.Where(a => a.App.Version == OSVersion);
        if (!string.IsNullOrEmpty(OSName)) query = query.JoinAlias(()=>appEventAlias.App,()=>appAlias).Where(()=>appAlias.OperatingSystemName==OSName);
        if (!string.IsNullOrEmpty(Model)) query = query.JoinAlias(()=>appEventAlias.Client, ()=>clientAlias).Where(()=>clientAlias.Id==appEventAlias.Client.Id).JoinAlias(()=>clientAlias.ClientInfos, () => clientInfoAlias).Where(()=>clientInfoAlias.DeviceModel == Model); 
```

# java - Java - 使用 Collections.sort() 进行排序

> ID：11506525
> 
> 赞同：3
> 
> 时间：2012-07-16T14:32:52.300
> 
> 标签：java, sorting, collections, integer, double

我必须编写一个方法来对整数和双精度数进行排序。

```
public ArrayList<Number> sortDescending(ArrayList<Number> al){
    Comparator<Number> c=Collections.reverseOrder();
    Collections.sort(al,c);
    return al;
}

public ArrayList<Number> sortAscending(ArrayList<Number> al){
    Collections.sort(al);
    return al;
} 
```

问题是在sortAscending中，出现如下错误：

> 绑定不匹配：Collections 类型的泛型方法 sort(List) 不适用于参数 (ArrayList)。推断的类型 Number 不是有界参数 < T extends Comparable < ? 超级T>>

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T14:36:02.957

您需要使用与相交的通用*上限*：`Number``Comparable<T>`

```
public <T extends Number & Comparable<T>> ArrayList<T> sortDescending(ArrayList<T> al){
    Comparator<T> c=Collections.reverseOrder();
    Collections.sort(al,c);
    return al;
}

public <T extends Number & Comparable<T>> ArrayList<T> sortAscending(ArrayList<T> al){
    Collections.sort(al);
    return al;
} 
```

所有 JDK `Numbers`（例如`Float`，`Integer`等）都匹配此类型。

对于初学者来说，语法`<T extends A & B>`是你绑定`T`到*和* `A`的方式`B`。

仅供参考，“或”逻辑没有语法（如果您考虑一下也没有意义）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T14:35:47.843

您收到错误是因为 number 未实现`Comparable<Number>`。您需要添加一个通用约束，以便它扩展 number 和 Comparable。在这种情况下：

```
public <T extends Number & Comparable<T>> ArrayList<T> sortAscending(ArrayList<T> al){
    Collections.sort(al);
    return al;
} 
```

# android - 统计sqlite数据库中的表数

> ID：11506527
> 
> 赞同：9
> 
> 时间：2012-07-16T14:32:56.233
> 
> 标签：android, sqlite

我需要计算当前在我的 sqlite 数据库中的表。尝试搜索但没有得到任何直接的方法。

我在我的 DbHelper 中尝试了这种方法。

```
public int countTables() {
    int count = 0;
    String SQL_GET_ALL_TABLES = "SELECT * FROM sqlite_master WHERE type='table'";
    Cursor cursor = getReadableDatabase()
            .rawQuery(SQL_GET_ALL_TABLES, null);
    cursor.moveToFirst();
    for (cursor.moveToFirst(); !cursor.isAfterLast(); cursor.moveToNext()) {

        count++;
        getReadableDatabase().close();

    }
    cursor.close();
    return count;
} 
```

但是这种方法给了我一个错误的计数。我的数据库中只有 3 个表，但此方法返回计数为 5。此方法可能有什么问题。有没有直接的方法来获得计数。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-16T14:43:43.693

你的方法很好，你甚至可以使用`SELECT count(*) ...`. 但是有两个表是自动创建的`android_metadata`，`sqlite_sequence`只需将这些考虑在内：5 - 2 = 您创建的 3 个表。

或者由于 Squonk 提供了关于何时[`sqlite_sequence`](http://www.sqlite.org/autoinc.html)创建以及何时可能*不*存在的优秀文档，我推荐这个查询：

```
SELECT count(*) FROM sqlite_master WHERE type = 'table' AND name != 'android_metadata' AND name != 'sqlite_sequence'; 
```

**缩短代码的几点建议**

所有这些：

```
cursor.moveToFirst();
for (cursor.moveToFirst(); !cursor.isAfterLast(); cursor.moveToNext()) { 
```

可以这样实现：

```
while(cursor.moveToNext()) { 
```

如果下一行存在，则 Cursor.moveToNext() 返回 true。如果新游标不为空，moveToNext() 将返回 true 并将此索引设置在第一个位置。时`cursor.isAfterLast() == true`，moveToNext() 返回 false。

但是，如果您只是想计算 Cursor 中有多少行，请使用：

```
int count = cursor.getCount(); 
```

最后，将可写数据库存储在变量中。

```
getReadableDatabase().close(); 
```

我没有对此进行测试，但是如果 getReadableDatabase() 每次都返回一个新的 SQLiteDatabase 对象，那么您只需在创建此新数据库后立即关闭它...我将关闭数据库*一次*，然后在我关闭它*之后*已经关闭了我从中检索到的所有游标。

```
SQLiteDatabase database = getReadableDatabase();
...

database.close(); 
```

如果您使用大量查询，请考虑在 onResume() 中打开数据库并在 onPause() 中关闭它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-30T05:44:14.143

# 查找计数和表名

## 查找计数

```
ResultSet rs = st.executeQuery("select count(*) from sqlite_master as tables where type='table'");
System.out.println(rs.getInt(1)); 
```

## 检索表名

```
ResultSet rs2 = st.executeQuery("select name from sqlite_master as tables where type='table'");
    while(rs2.next())
    {
          String tid = rs2.getString(1);
          System.out.println(tid);
    }
    rs.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:45:06.037

尝试

```
 vvvvvv
SELECT * FROM YourDataBaseName.sqlite_master WHERE type='table'; 
```

只需将您的 DatabseName 如图所示。

# jquery - 第一次单击时不显示确认模式

> ID：11506528
> 
> 赞同：0
> 
> 时间：2012-07-16T14:33:04.190
> 
> 标签：jquery, datatables

在这方面需要一些帮助。我正在单击一个删除图像，该图像存在于其中一行的一个单元格中。单击删除图像后，应该有一个模式确认框，要求用户确认行删除。好吧，该功能正在运行，但模式确认框不会在第一次单击删除图像时显示 - 但在第二次单击时显示。我在单击图像时写了console.log-每次单击图像时都会记录-但确认框不会第一次出现。如果没有确认框逻辑，如果我单击删除图像，则该行仅在第一次单击时被删除。

这是代码：

```
$('#example.display tbody tr td img#delete').live('click', function(){
  console.log("Delete clicked");

  var oTable = $('#example').dataTable();
  var nRow = $(this).closest("tr").get(0);
  var aData = oTable.fnGetData(nRow);

  ("#DeleteConfirmationModalWindow").html('<h6>'+'Are you sure you wish to delete order:'+'<br />'+aData[0]+'?'+'</h6>');
  $("#DeleteConfirmationModalWindow").dialog('open');

  $("#DeleteConfirmationModalWindow").dialog({
      title: "Delete Confirmation",
      autoOpen: false,
      dialogClass: "DeleteConfirmationModalWindow",
      closeOnEscape: false,
      draggable: false,
      width: 400,
      height: 200,
      modal: true,
      buttons: {
            "Yes, I'm sure": function() {
                $( this ).dialog( "close" );
                console.log("Delete");
                deleteDatabaseRow(oTable, nRow);    
                oTable.fnDeleteRow(nRow);
            },
            Cancel: function() {
                $( this ).dialog( "close" );
                console.log("No delete");
            }
        },
    resizable: false,
    open: function() {
              $('body').css('overflow','hidden');
          },
    close: function() {
              $('body').css('overflow','auto');
          }
    });                     
}); 
```

请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:44:15.193

您的代码中有错误。`$("#DeleteConfirmationModalWindow").dialog('open');`您在创建对话框之前正在调用。

首先，删除`$("#DeleteConfirmationModalWindow").dialog('open');`和您的选项`autoOpen: false`，让我知道它是否有效。

`.live`如果您使用的是 jQuery 1.4+，则不推荐使用，请参见[此处](http://api.jquery.com/live/)。只需使用即可`.click`。

# php - Ajax 限制返回的项目数量

> ID：11506533
> 
> 赞同：1
> 
> 时间：2012-07-16T14:33:15.160
> 
> 标签：php, ajax

我正在发出这样的 AJAX 请求：

```
$("#botao_pesquisar_material").click(function(){
    $(this).attr("disabled", "disabled");
    $("#material").addClass('loading');
    $.ajax({
        url: '{{ URL::base() }}/material/lista_ajax/',
        dataType: 'json',
        cache: false,
        error: function(data)
        {
            console.log(data);
        },
        success: function(data) {
            for(x in data)
            {
                console.log(data[x]);
            }
        }
    }); 
```

我的 PHP 方法没问题，因为当我通过 URL 访问它时，它返回给我预期的 JSON，当我在 localhost 上调用它时，它工作得很好，所以它与特殊字符或其他数据无关。

当我在我的服务器上运行它时，我有这个：

```
GET http://dc.portaldeideias.com.br:8080/sergios/public/material/lista_ajax/?callback=jQuery172007718208665028214_1342725644520&_=1342725649090 500 (Internal Server Error) jquery.js:4
f.support.ajax.f.ajaxTransport.send jquery.js:4
f.extend.ajax jquery.js:4
$.click.$.ajax.url
f.event.dispatch jquery.js:3
f.event.add.h.handle.i 
```

使用`console.log(data)`我有整个 JSON 响应，但这里真的很奇怪：

`readyState`是_`4`

`responseText`是_`[{"attributes":{"pk_a030_id":78,"a030_descricao":"Camur\u00e7a"},"original":{"pk_a030_id":78,"a030_descricao":"Camur\u00e7a"},"relationships":[],"exists":true,"includes":[]}]`

`statusText`是_`Internal Server Error`

因此，创建了请求的值，但我收到了一个`Internal Server Error`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T04:09:56.817

很抱歉将其发布为答案，但我没有必要的权限将其添加为您的问题的评论。

您是否注意到 javascript 日志中的 URL 与`http://localhost:8080/sergios/public/material/lista_ajax/`屏幕截图中提供的 URL 不同`http://dc.p[...]s.com.br:8080/sergios/public/material/lista_ajax`？

是否有两种不同版本的`lista_ajax`PHP 方法托管在两台不同的服务器上（可能是一台远程服务器，另一台是本地服务器），这就是为什么它在从浏览器中查看时完美无缺，并且在使用 ajax 测试时出现错误的原因?

同样重要的是要注意，如果您正在浏览托管在远程服务器上的网站，并且 ajax 配置为一个`localhost`地址，它将对您自己的机器发出请求，而不是远程服务器（javascript 在浏览器中运行，所以`localhost`翻译到它自己的客户地址）。

也许情况并非如此，但值得评论。

# c# - 从字符串中删除选择性部分

> ID：11506535
> 
> 赞同：1
> 
> 时间：2012-07-16T14:33:19.867
> 
> 标签：c#, regex, split, tokenize

我需要帮助弄清楚如何`"</span>"`从字符串中只删除最后一个标签。他是其中一根弦可能看起来的一个例子，但有时会有一些

```
<DIV style="TEXT-ALIGN: center"><span style="text-decoration:underline;"> some text   </span> </span></DIV> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:42:20.060

```
 var originalString = @"<DIV style='TEXT-ALIGN: center'><span style='text-decoration:underline;'> some text   </span> </span></DIV>";

        var lastIndex = originalString.LastIndexOf("</span>");

        var newwString = originalString.Substring(0, lastIndex) + originalString.Substring(lastIndex + 7); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:42:13.240

使用这个正则表达式`</span>(?=[(</span>)])`

# javascript - 输入字段值未正确加起来

> ID：11506538
> 
> 赞同：0
> 
> 时间：2012-07-16T14:33:23.053
> 
> 标签：javascript, jquery

> **可能的重复：**
> [JavaScript 的数学被破坏了吗？](https://stackoverflow.com/questions/588004/is-javascripts-math-broken)

我正在尝试将三个输入字段相加，每个字段包含一个 33.3 的值，总计应为 99.9，但它们总计为 99.89999999999999

有人可以解释这是如何发生的。下面是我的代码。提前致谢。

```
$("#modify-funding input.percentCalc").sumValues()

$.fn.sumValues = function () {
    var sum = 0;
    this.each(function () {
        sum += $(this).fieldVal();
    });
    return sum;
};

$.fn.fieldVal = function () {
    var val;
    if ($(this).is(':input')) {
        val = $(this).val();
        alert("val " + val);
    } else {
        val = $(this).text();
    }       
    return parseFloat(('0' + val).replace(/[^0-9-\.]/g, ''), 10);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:37:13.933

欢迎来到浮点数的美妙世界。浮点数是您要表示的数字的近似值。因此，当您按原样保存一个数字时，`33.3`但不完全是`33.3`这个错误在多次操作后加起来。比较浮点数的最佳方法不是测试是否相等，而是测试它们在一个范围内的天气。

代替

```
if(x == 99.9) 
```

尝试

```
if(Math.abs(99.9 - x) < .1) 
```

如果你只想要字符串表示。您可以尝试将浮点数作为整数处理。即`33.3`等于`333`然后当你把它变成一个字符串时，你在适当的地方添加小数。这将是您问题的最佳解决方案。

# iphone - 一个额外的 popViewControllerAnimated：当用户按下返回按钮时？

> ID：11506539
> 
> 赞同：1
> 
> 时间：2012-07-16T14:33:26.577
> 
> 标签：iphone, ios, xcode, ipad, uinavigationcontroller

当用户按下返回按钮从活动的 UINavigationController 弹出当前 UIViewController 时，我需要 - 在某种特殊情况下 - 以编程方式从同一个导航控制器弹出另一个 UIViewController（新的顶部）。

（不详述，请相信我，这并没有违反 Apple 的人机界面指南。相反，如果我不弹出额外的 VC，它可能会违反指南）。

我能想到的唯一方法是将 a `popViewControllerAnimated:`in放置`viewWillDisappear:`，但不幸的是这不起作用（即使我要弹出的 VC 仍然显示为 in 中的最后一个对象`self.navigationController.viewControllers`）。我在通话中尝试了“是”和“否”。

我找不到一种方法来检测 VC 何时将被弹出，`viewWillDisappear:`因为`UINavigationControllerDelegate`没有行为来检测 VC 何时将被弹出，只有当它即将被推送时。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:41:46.193

iOS5 中有一些不错的新方法，您可以使用它们来检测您是否即将被弹出。

请参阅 UIViewController 包含部分。

```
- (BOOL)isBeingPresented __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0);
- (BOOL)isBeingDismissed __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0);
- (BOOL)isMovingToParentViewController __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0);
- (BOOL)isMovingFromParentViewController __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0); 
```

# xml - XQuery：同一个模块中有两个名称空间？

> ID：11506543
> 
> 赞同：0
> 
> 时间：2012-07-16T14:33:33.240
> 
> 标签：xml, xpath, module, namespaces, xquery

是否可以在其中声明 2 个命名空间和第 2 组不同的函数组，然后在同一个主脚本中导入它们？

例如：主脚本中的类似内容

```
 import module namespace i = "UtilIntegers" at "Utils.xqm";
    import module namespace s = "UtilStrings" at "Utils.xqm"; 
```

文档非常模糊且依赖于实现：[http ://www.xquery.com/tutorials/guided-tour/external-functions-variables.html](http://www.xquery.com/tutorials/guided-tour/external-functions-variables.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:48:57.320

模块导入的很多方面确实是实现定义的，但是一个库模块只能有一个目标命名空间（因为它只能包含一个 ModuleDecl），并且规则是明确的：

库模块中声明的每个变量和函数的名称必须具有与模块的目标命名空间相同的命名空间 URI；否则会引发静态错误 [err:XQST0048]。

在您的示例中，“导入模块”声明之一将失败，因为“导入模块”中出现的命名空间与正在导入的模块的目标命名空间不匹配。

# python - 无论如何将列表转换为变量以用作字典键？

> ID：11506544
> 
> 赞同：0
> 
> 时间：2012-07-16T14:33:34.123
> 
> 标签：python, list, variables, dictionary

所以我有一个包含一组字母值的列表，它们是字典中的名称，例如：

```
['H', 'I', 'B'] 
```

其中各个变量名称是我在字典中使用的键，但我的问题是，HIB 列表一起代表另一个变量，我希望在字典中将其定义为 HIB 的关键字。所以我的问题是，我如何将此列表转换为变量，最好是：

```
nodeName = 'HIB' 
```

因此，我可以使用以下方法在我的字典中为其分配一个键：

```
Tree[nodeName] = ... 
```

因为obv。您不能调用字典中的列表。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T14:34:32.867

```
>>> ''.join(['H', 'I', 'B'])
'HIB' 
```

或者您可以将其转换为元组：

```
>>> tuple(['H', 'I', 'B']) 
```

或一般来说

```
>>> tuple(li) 
```

可以用作字典键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T14:35:42.053

```
my_list = ['H', 'I', 'B']
"".join(my_list)
>> 'HIB' 
```

正如其他人所建议的，更好的方法是使用`tuple`：

```
my_list = ['H', 'I', 'B']
tuple(my_list)
>> ('H', 'I', 'B') 
```

这将解决在尝试确定`'HIB'`是从`['H', 'I', 'B']`还是从创建时的歧义`['HI', 'B']`

# ios - 内存管理，要明确的事情

> ID：11506545
> 
> 赞同：1
> 
> 时间：2012-07-16T14:33:39.293
> 
> 标签：ios, objective-c, memory-management, retain

我需要弄清楚 Objective-C 内存管理：

如果我在类头中将一个对象声明为没有@property 的 ivar：

```
 @interface MyFacebooDelegate : UIViewController 
 {
     TableViewController *tableController;
 }
 ...
 @end 
```

以及代码中的一些地方，例如`- (void)viewDidLoad`我做的：

```
tableController = [[TableViewController alloc] init]; 
```

所以最好的方法是在哪里释放它。如果我将即时对象设为属性，会有什么不同？以及内存管理将如何

```
@interface MyFacebooDelegate : UIViewController 
 {
     TableViewController *tableController;
 }
 ...
 @end
@property (nonatomic, strong) TableViewController *tableController; 
```

以下语法对对象 viewController 的作用：

。H

```
 @interface AppDelegate : UIResponder <UIApplicationDelegate>
 @property (strong, nonatomic) ViewController *viewController;
 @end 
```

.m

```
@implementation AppDelegate

@synthesize window = _window;
@synthesize viewController = _viewController;

- (void)dealloc
{
  [_window release];
  [_viewController release];
  [super dealloc];
}
.....
@end 
```

如果我想通过一个方法将一个对象返回给另一个类，我是否需要先`autorelease`在方法体中，然后`retain`在接收方？例如，这个方法在方法体和接收方到底要做什么：

```
-(NSString *)getFriendId
 {
NSArray *ar = [NSArray arrayWithObjects:@"1",@"2",@"3", nil];
return [ar objectAtIndex:0];
 } 
```

我知道很多，但我真的很困惑，需要你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:40:14.053

1）最好的方法是在dealloc；或在重新设置之前。

2）财产为您保留/释放。但是警告！你总是把事情搞混。您在这里使用与 ARC 相关的“强”。如果您真的坚持使用经典的保留/释放（您不应该），那么请改用（非原子，保留）。

3) 你的属性在 dealloc 上被释放。再次强调，这里的强是错误的。

4) 是的。理想情况下你应该。ARC 很棒的另一个原因是，它会自动为您完成这一切。

tl；博士：使用 ARC。永远不要回去。（不过还是要学手动内存管理）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:57:39.563

ARC 是您所有内存管理问题的答案。除了 , 关于强和弱属性的非常重要的说明

iOS Strong 属性：So strong 与 ARC 之前的属性声明中的 retain 相同。对于 ARC 项目，我会使用 strong 而不是 retain，我会使用 assign 来表示 C 原始属性。

iOS 出口应定义为声明的属性。出口通常应该是弱的，除了从文件所有者到 nib 文件中的顶级对象（或者，在 iOS 中，故事板场景）应该是强的。因此，默认情况下，您创建的 Outlets 通常是弱的，因为： 您创建的 Outlets，例如，视图控制器的视图或窗口控制器的窗口的子视图，是不暗示所有权的对象之间的任意引用。

# android - 在 Java-Android 和 JNI 之间发送/接收音频数组

> ID：11506552
> 
> 赞同：1
> 
> 时间：2012-07-16T14:34:00.643
> 
> 标签：android, c++, audio, java-native-interface, recording

我是 Android 编程领域的新手，我已经在 Internet 上对 Android 中的 JNI 实现进行了全面搜索。顺便说一句，有很多方法可以做到这一点，而且我没有找到太多关于 Android 的 C/C++ 中的 DSP 的文档。

我已经从录音（PCM 到浮动）中获得了音频数据，我想将数据发送到 C/C++ 函数来处理这些数据。转换后，我想将数组返回给 Java 活动以播放结果。有没有关于使用 JNI 发送和接收数组的简单示例或文档？

我正在使用 Windows 7、Eclipse 和 Cygwin。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:35:32.880

应该很简单，

要将 byteArray 从 Java 传输到 C++，您可以考虑以下示例：

第 1 步：在将调用本机方法的 java 类中声明该方法（在我的示例中是一个简单的 zip）

```
private native byte[] jniZipString(byte[] unpackedData, int datasize); 
```

第 2 步：在 c++ 中，使用 javah.exe [note] 从 bin/classes 文件夹调用 javah 生成头文件和实现（因为您为 android 编码

```
javah -jni com.example.JavaClassWithNativeMethods 
```

第 3 步：在 C++ 中接收字节数组并转换为 C++ 字节数组

```
jbyte* tempPointer = env->GetByteArrayElements(jInput, 0);
const char* cinput = (const char*) tempPointer;
int dataSize = (int)env->GetArrayLength(jInput) 
```

第 4 步：处理您的数据

```
whatever you do to process the bytearray 
```

步骤 5：将生成的字节数组返回给 java

```
jbyteArray result = (env)->NewByteArray(newDataSize);
(env)->SetByteArrayRegion(result, 0, newDataSize, (jbyte *) processedCharArray); 
return result; 
```

# php - PHP：对保持状态与隐藏字段感到困惑

> ID：11506553
> 
> 赞同：0
> 
> 时间：2012-07-16T14:34:02.287
> 
> 标签：php, html

我想在每次提交时更新民意调查的选择。但它似乎不起作用。任何人都可以建议我保持隐藏字段的状态吗？以及如何清除当前页面中的所有内容以显示投票结果表？

```
<?php

if ($_POST['choice']==0)
    $a_count = $_POST['a_count']+1;
if ($_POST['choice']==1)
    $b_count = $_POST['b_count']+1;
if ($_POST['choice']==2)
    $c_count = $_POST['c_count']+1;
if ($_POST['choice']==3)
    $d_count = $_POST['d_count']+1;
?>
<html>
<head>
</head>
<body>
    <form action="index.php" method="POST">
    <table align="center">
        <tr><td>Please select</td></tr>
        <tr><td><input type="radio" name="choice" value="0">aaaa</td></tr>
        <input type="hidden" name="a_count" value="<?php print $a_count ?>">
        <tr><td><input type="radio" name="choice" value="1">bbbb</td></tr>
        <input type="hidden" name="b_count" value="<?php print $b_count ?>">
        <tr><td><input type="radio" name="choice" value="2">cccc</td></tr>
        <input type="hidden" name="c_count" value="<?php print $c_count ?>">
        <tr><td><input type="radio" name="choice" value="3">dddd</td></tr>
        <input type="hidden" name="d_count" value="<?php print $d_count ?>">
        <tr><td><input type="submit" value="submit"></td></tr>
    </table>
    <table align="center" border="1" cellspacing="0">
        <tr align="center"><th>Member Name</th><th>Vote</th></tr>
        <tr><td>aaaa</td><td><?php echo"$a_count";?></td></tr>
        <tr><td>bbbb</td><td><?php echo"$b_count";?></td></tr>
        <tr><td>cccc</td><td><?php echo"$c_count";?></td></tr>
        <tr><td>dddd</td><td><?php echo"$d_count";?></td></tr>
    </table>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:38:39.597

您提交的代码看起来应该在用户的活动会话期间保持用户的选择/状态（只要他们不离开该页面） - 但一旦他们离开，它就会丢失。此外，他们的“投票”不能在任何其他用户之间共享。

为了保持用户的状态，探索 PHP 会话的使用或将结果存储在文件/数据库中。

要与其他用户分享用户的投票，请探索文件或数据库的使用。

要在没有表单的情况下显示结果表，在用户“投票”后，您可以执行以下两项操作之一。您可以在表单周围放置一个 if 语句来检查是否已经选择了答案 - 如果是，请不要显示表单。另一种方法是将结果表放在没有表单的单独页面上（只需将表单 POST 到单独的页面，或者将带有表单的页面重定向到单独的页面）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:15:27.710

为什么不使用数据库来存储值？您可以将用于输入的表格置于 if 条件中，以便在提交表单时不会呈现。希望这可以帮助！

# sql - 带有密码的加密 SSIS 包是否完全加密？

> ID：11506554
> 
> 赞同：1
> 
> 时间：2012-07-16T14:34:10.510
> 
> 标签：sql, sql-server, ssis

如果您使用密码加密 (EncryptAllWithPassword) 对 SSIS 包进行本地加密，从 MS 标识为：“使用密码加密整个包。使用用户在创建或导出包时提供的密码对包进行加密。要在 SSIS 设计器中打开包或使用 dtexec 命令提示实用程序运行包，用户必须提供包密码。如果没有密码，用户将无法访问或运行包。" 这是否意味着包内的所有数据也都被加密了？或者只是周围的包裹以及它是如何传输的？

我问的原因是，我对 SSIS 比较陌生，我的客户对他们的数据如何通过 Internet 发送非常小心。如果我创建一个 SSIS 包并将保护级别设置为使用密码加密所有内容，我是否可以安全地说该包中的所有内容都是安全的，直到它使用正确的密码运行？还是我需要采取不同的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:46:37.100

使用密码加密所有数据 - 使用包设计者提供的任意密码来加密整个包内容，应用三重 DES 密码算法。需要密码才能打开、导入、导出或执行包。由于其内容被混淆，试图直接查看它并不能提供对其结构的任何有意义的洞察。

[http://www.databasejournal.com/features/mssql/article.php/3898676/Securing-the-Content-of-SSIS-Packages.htm](http://www.databasejournal.com/features/mssql/article.php/3898676/Securing-the-Content-of-SSIS-Packages.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:52:01.530

[本文](http://msdn.microsoft.com/en-us/library/ms141747.aspx)介绍了加密级别。使用密码加密所有内容可以保护连接字符串、密码和数据库模式（所有包都已加密），因此可以将此选项用于敏感数据。

使用用户密钥加密可能会稍微好一些，因为密钥通常比密码长，但实际上只使用更方便的方法。

# c - 在 C 中，如何访问该结构中的元素？

> ID：11506557
> 
> 赞同：1
> 
> 时间：2012-07-16T14:34:22.467
> 
> 标签：c, pointers, struct, malloc

如果我按如下方式初始化列表，如何访问该结构中的元素：

```
group **list = (group **) malloc(sizeof(group)); 

typedef struct
{
    // ID of the group, 'A' to 'D'
    char id;

    // a list of members in the group 
    char **members;
} group; 
```

我尝试使用`(*list)->id = 'A'`它并编译但在运行程序时出现分段错误错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:40:09.120

```
struct group
{
    // ID of the group, 'A' to 'D'
    char id;

    // a list of members in the group 
    char **members;
};

//this initializes one group
group *a_group = malloc(sizeof(struct group)); //cast not needed in C

//this initializes an array of 10 group
group **list = malloc(sizeof(struct group *) * 10);

//initialize each one of the 10
for(int i = 0; i < 10; ++i){
  list[i] = malloc(sizeof(struct group));
}

//get something out of group
a_group->id;

//get first group out of list
list[0]->id;
*list->id;

// 10 elements continuous memory
group *array_of_groups = malloc(sizeof(struct group) * 10);
array_of_groups[0].id;
*array_of_groups.id; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T14:54:58.147

虽然它编译得很好，但你没有正确分配内存。

您为 分配了内存`group **list`，这最终是一个指向 struct 的指针数组`group`。我认为你*打算*做的是：

```
group** list = malloc(sizeof(group*) * 5);  // e.g. 5 pointers 
```

现在为数组中的每个指针分配自己的内存：

```
int i;
for (i = 0; i < 5; i++) {
    list[i] = malloc(sizeof(group));
} 
```

例如，要访问`id`第二个结构，您可以：

```
list[1]->id = 'A'; 
```

注意`*list`访问第*一个*结构，和等价于`list[0]`.

**旁注：**
两级间接允许您以非连续方式将结构存储在内存中。或者，您可以使用一级间接并连续存储它们：

```
group list* = malloc(sizeof(group) * 5);  // Again, 5 structs 
```

然后通过以下方式访问成员：

```
list[0].id = 'A'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T14:47:17.977

请记住，双重间接指针只是一个指向默认情况下恰好指向第一个条目的*列表的指针。*您需要为单个条目/条目分配，而不仅仅是列表指针 (**list)，以下一些风格：

```
//rough code, not tested... std caveats apply :)
group *one_group = malloc(sizeof(group));

list[0]=one_group;
list[0]->id = 'A'; // or one_group->id='A'; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-16T14:59:21.720

可以说我必须制作一个**指针列表**。此列表的成员每个都指向按类型组映射的**内存块。**

现在假设我有 10 件物品，

所以：

```
group *tmp = malloc(sizeof(group) * 10); 
```

现在 tmp 指向这些块的开始。

现在我想创建一个指针列表，列表中的每个项目都指向一个块。

让我们创建 10 个指针，

```
group ** list = malloc(sizeof(group *) * 10) 
```

现在初始化这个指针列表：

```
i = 10;
while(i--) {
    list++ = &(tmp++);
} 
```

现在您的列表已使用指向块的指针进行初始化。仍然存在一个问题，您的列表指向最后一个问题。如果你不想那样

```
list-= 10; 
```

现在你想从列表中检索一些东西：

```
while(i--) {
    printf("%c\n", (*(list++))->a);
} 
```

但是这种列表管理很奇怪，更不用说容易出错了。您应该认真考虑通过“链接列表”维护您的列表。像您给出的简单场景可以通过单链表轻松实现。

# javascript - 获取用户拥有/管理的 Facebook 粉丝页面

> ID：11506559
> 
> 赞同：0
> 
> 时间：2012-07-16T14:34:31.110
> 
> 标签：javascript, facebook, facebook-graph-api

我正在使用 Facebook JavaScript SDK 来获取登录用户拥有/管理的所有粉丝页面。

```
FB.api('/me/accounts', function(response){
    console.log(response);
}); 
```

但这仅显示我拥有的 Facebook 应用程序。我使用了错误的链接吗？

**编辑**

我将此添加到我的登录按钮：

```
<fb:login-button perms="email,user_birthday,manage_pages" id="auth-loginlink"></fb:login-button> 
```

并在身份验证对话框（在仪表板中）中添加`manage_pages`了扩展权限。在身份验证对话框中，我看不到`manage_pages`权限，并且在响应中仍然看不到粉丝页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T10:03:14.880

答案是 ：

```
FB.login(function(){}, {perms:'manage_pages'}); 
```

# html - html颜色到动态表的替代行

> ID：11506563
> 
> 赞同：1
> 
> 时间：2012-07-16T14:34:49.837
> 
> 标签：html, css, jsp

我有一个动态表，我想在替代行上赋予颜色。我怎样才能用css实现这一点？我需要代码才能在 IE7+ 中工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:36:29.180

研究在 CSS3 中使用偶数/奇数规则。

**参考**：[https ://developer.mozilla.org/en/CSS/:nth-child](https://developer.mozilla.org/en/CSS/:nth-child)

例如，

`tr:nth-child(odd)`将代表每个`2n + 1`孩子的 CSS，而`tr:nth-child(even)`将代表每个`2n`孩子的 CSS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:36:49.107

CSS3 nth-child 选择器：

```
tr:nth-child(odd) {
  background: red /* or whatever */;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T14:47:22.093

您可以使用[CSS3 选择器](http://www.w3.org/Style/Examples/007/evenodd.en.html)：

```
tr:nth-child(even) {background: #CCC}
tr:nth-child(odd) {background: #FFF} 
```

或[jQuery](http://api.jquery.com/even-selector/)：

```
$("tr:even").css("background-color", "#CCC");
$("tr:odd").css("background-color", "#FFF"); 
```

或者在[服务器端](https://stackoverflow.com/questions/241897/how-to-alternate-html-table-row-colors-using-jsp)进行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T15:20:26.500

星期五我遇到了同样的问题，我使用了 jquery 解决方案

```
$("tr:even").css("background-color", "#CCC");
$("tr:odd").css("background-color", "#FFF"); 
```

*   此处发布的堆栈溢出解决方案 .js [检测 DOM 中的更改](https://stackoverflow.com/questions/3219758/detect-changes-in-the-dom)

所以基本上你在头部添加 .js 脚本并触发 dom 更改的 jquery 规则。

我完成的 .js 看起来像这样

```
<script type="text/javascript">
    (function (window) {

        var last = +new Date();
        var delay = 100; // default delay

        // Manage event queue
        var stack = [];

        function callback() {
            var now = +new Date();
            if (now - last > delay) {
                for (var i = 0; i < stack.length; i++) {
                    stack[i]();
                }
                last = now;
            }
        }

        // Public interface
        var onDomChange = function (fn, newdelay) {
            if (newdelay)
                delay = newdelay;
            stack.push(fn);
        };

        // Naive approach for compatibility
        function naive() {

            var last = document.getElementsByTagName('*');
            var lastlen = last.length;
            var timer = setTimeout(function check() {

                // get current state of the document
                var current = document.getElementsByTagName('*');
                var len = current.length;

                // if the length is different
                // it's fairly obvious
                if (len != lastlen) {
                    // just make sure the loop finishes early
                    last = [];
                }

                // go check every element in order
                for (var i = 0; i < len; i++) {
                    if (current[i] !== last[i]) {
                        callback();
                        last = current;
                        lastlen = len;
                        break;
                    }
                }

                // over, and over, and over again
                setTimeout(check, delay);

            }, delay);
        }

        //
        //  Check for mutation events support
        //

        var support = {};

        var el = document.documentElement;
        var remain = 3;

        // callback for the tests
        function decide() {
            if (support.DOMNodeInserted) {
                window.addEventListener("DOMContentLoaded", function () {
                    if (support.DOMSubtreeModified) { // for FF 3+, Chrome
                        el.addEventListener('DOMSubtreeModified', callback, false);
                    } else { // for FF 2, Safari, Opera 9.6+
                        el.addEventListener('DOMNodeInserted', callback, false);
                        el.addEventListener('DOMNodeRemoved', callback, false);
                    }
                }, false);
            } else if (document.onpropertychange) { // for IE 5.5+
                document.onpropertychange = callback;
            } else { // fallback
                naive();
            }
        }

        // checks a particular event
        function test(event) {
            el.addEventListener(event, function fn() {
                support[event] = true;
                el.removeEventListener(event, fn, false);
                if (--remain === 0) decide();
            }, false);
        }

        // attach test events
        if (window.addEventListener) {
            test('DOMSubtreeModified');
            test('DOMNodeInserted');
            test('DOMNodeRemoved');
        } else {
            decide();
        }

        // do the dummy test
        var dummy = document.createElement("div");
        el.appendChild(dummy);
        el.removeChild(dummy);

        // expose
        window.onDomChange = onDomChange;

    })(window);

    $(document).ready(function () {
        $("tr:even").css("background-color", "#CCC");
        $("tr:odd").css("background-color", "#FFF");
        onDomChange(function () {
            $("tr:even").css("background-color", "#CCC");
            $("tr:odd").css("background-color", "#FFF");
        });
    });
</script> 
```

我想提醒这个答案，这可能不是最好的解决方案，但可以满足我的需要。:-)

# android - 从我的活动中隐藏 DataBaseHelper 和 DAO

> ID：11506565
> 
> 赞同：1
> 
> 时间：2012-07-16T14:34:55.110
> 
> 标签：android, ormlite

我想在我的 Activity 中对 Order 对象调用 CRUD 操作。我想知道“服务”类的以下实现是一个很好的方法吗？我不想在我的 Activity 代码中引用 DatabaseHelper 或 DAO 对象，因为我认为这是不可取的。这是我的服务类

```
public class OrderService 
{
    private static OrderService instance;
    private static Dao<Order, Integer> orderDAO;

    static public void init(Context ctx) {
        if (null == instance) {
            instance = new OrderService(ctx);
        }
    }

    public static OrderService getInstance() {
        return instance;
    }

    private OrderService(Context ctx) {
        DatabaseHelper helper = DatabaseHelper.getInstance(ctx);
        helper.getWritableDatabase();
        orderDAO = helper.getOrderDao();
    }

    public Order getOrderWithId(int orderId) {
        Order myOrder = null;
        try {
            myOrder = orderDAO.queryForId(orderId);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return myOrder;
    }

    public Order neworder(Order order) {
        try {
            orderDAO.create(order);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return order;
    }

    public void deleteorder(Order order) {
        try {
            orderDAO.delete(order);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public void updateorder(Order order) {
        try {
            orderDAO.update(order);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public List <Order> getordersForCategory(int orderId) {
        List <Order> orders = null;
        try {
            orders = orderDAO.queryForAll();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return orders;
    }
} 
```

这就是我打算如何使用该服务

```
public class OrderProcessingActivity extends Activity {

    int orderID;
    private Order order;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.myview);
        order = OrderService.getInstance().getOrderWithId(orderID);
        ...... 
```

这看起来像是访问 SQLlite DB 的好方法吗？我已经阅读了可以在 Android 中配置的“服务”实现，所以我觉得这是我应该使用的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:39:56.357

这或多或少是我采取的方法。我的应用程序架构通常如下所示：

`Activity <--> Service <--> DAO <--> SQLite`

这看起来非常接近你所拥有的，所以我会说它看起来不错！但是，我通常不会将其实现为单例，因为我不喜欢`Context`在应用程序的整个生命周期内保持不变。相反，我传入 以`Context`从每个`Activity`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:51:11.500

尽管将您的数据库逻辑移动到不同的类，但您在 UI 线程中执行所有数据库操作，这并不理想。另请注意，即使您的类被称为“服务”，它也不会继承自`Service`Android 中的任何类。

一种替代方法是从[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)`doInBackground`的方法执行数据库操作，从该方法返回所需的数据。然后，使用返回的数据在方法中更新您的活动。`onPostExecute`

# java - 如何处理外部程序中不同的标准输出行为？

> ID：11506566
> 
> 赞同：0
> 
> 时间：2012-07-16T14:34:57.630
> 
> 标签：java, stdout, bufferedreader, stderr, external-process

您好我正在尝试从 Java 程序执行外部程序并读取标准输出消息`in real time`，而无需等待程序退出。但是，我发现在不同的 .exe 程序中有不同的 stdout 行为，我不知道如何处理它。

**示例 1：**
server1.exe 是一个控制台程序。当我运行它时，它会不断地监听一个端口。当客户端连接到它时，它将`stdout`每 1 秒生成 1 行输出。除非我按“ctrl-C”，否则它不会退出。

在命令提示符下，我运行这个：

```
server1.exe > stdout.out 2> stderr.err 
```

当客户端连接到它时，我发现它`stdout.out file`会实时更新。即使 server1.exe 仍在运行，我也可以`stdout.out file`实时打开并读取标准输出。

**例2：**
与server1.exe类似，server2.exe也是一个控制台程序。当我运行它时，它也会不断地监听一个端口。当客户端连接到它时，它将每 1 秒生成 1 行 stdout 输出。除非我按“ctrl-C”，否则它不会退出。

在命令提示符下，我运行这个：

```
server2.exe > stdout.out 2> stderr.err 
```

即使客户端已连接到 server2.exe，我发现它`stdout.out file`是空的。只要 server2.exe 仍在运行，就不会将标准输出写入`stdout.out file`. 该文件未在`real time`. 当我按下`ctrl-C`时，它突然将许多行输出写入`stdout.out file`。

假设我`ctrl-C`在 t=11 时按下，它将把从 t=1 到 t=11 的所有 stdout 输出写入`stdout.out file`. 在此之前，在 t=10，`stdout.out`文件为空。

示例 2 中的程序给我带来了问题，因为我无法`read the stdout in real time`在我的 Java 程序中使用。我的java程序如下：

```
process = Runtime.getRuntime().exec(command);

input = new BufferedReader(new InputStreamReader(process.getInputStream()));

String inputtext = null;

while ((inputtext = input.readLine()) != null)
{
    //print out the text in Real Time, when the .exe program is still running
} 
```

我可以知道为什么示例 2 中的程序不会生成`stdout output`，除非我按`ctrl-C`吗？

奇怪的是，当我在控制台窗口中手动运行该程序时，我可以看到控制台窗口每 1 秒打印一次标准输出输出。但是当我尝试使用 Java 从 Java 中读取它时，`inputtext = input.readLine()`只要程序仍在运行（我已经通过打印输入文本对其进行了测试）。当我按下时，BufferedReader 将突然被所有待处理的 stdout 输出填充。`inputtext``null``ctrl-C`

如何`stdout`实时读取 server2.exe？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:48:28.740

您描述事物的方式，在您的第二台服务器中发生了一些缓冲。服务器可能决定在内部缓冲输出，除非它连接到实时交互式控制台窗口。

虽然可能有[办法解决这个问题](https://stackoverflow.com/q/3385427/1468366)，但我会在`server2`源代码中解决这个问题。每当该应用程序写入其每秒一次的输出时，它*应该*在之后刷新其输出流。也许有一些选项可以启用该行为。如果没有，并且该程序的来源超出您的控制范围，请要求开发人员添加刷新，以便更好地集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T11:41:24.183

简而言之：您需要刷新缓冲区。

```
System.out.flush() 
```

您需要在这些流上写入每一块相关数据之后执行此操作，尝试在每行打印后执行此操作。

# asp.net-mvc-3 - 单选按钮列表枚举的 MVC 3 助手

> ID：11506570
> 
> 赞同：3
> 
> 时间：2012-07-16T14:35:20.470
> 
> 标签：asp.net-mvc-3, html-helper

我需要一些帮助。我正在尝试构建一个需要枚举类型单选按钮组的视图。我有几个这样的枚举类型（类）：

```
[DataContract(Namespace = Constants.SomeDataContractNamespace)]
public enum OneEnumDataContract
{
    [Display(Name = "Text_None", Description = "Text_None", ResourceType = typeof(TextResource))]
    [EnumMember]
    None = 0,

    [Display(Name = "Text_Medium", Description = "Text_Medium", ResourceType = typeof(TextResource))]
    [EnumMember]
    Medium = 1,

    [Display(Name = "Text_Very", Description = "Text_Very", ResourceType = typeof(TextResource))]
    [EnumMember]
    Very = 2
} 
```

在我的模型（一个数据合同，使用 WCF）中，我有这个枚举数据合同的属性：

```
 [DataMember(Order = 23)]
    [Display(Name = "EnumValue", Description = "EnumValue_Description", ResourceType = typeof(TextResource))]
    public OneEnumDataContract EnumClass1 { get; set; } 
```

在我看来，我会尝试制作这样的单选按钮组（使用助手）：

```
@Html.RadioButtonListEnum("EnumList1", Model.EnumClass1) 
```

我的帮手：

```
public static MvcHtmlString RadioButtonListEnum<TModel>(this HtmlHelper<TModel> helper, string  NameOfList, object RadioOptions)
    {
        StringBuilder sb = new StringBuilder();
        //som other code for pairing with resourcefile...

        foreach(var myOption in enumTexts.AllKeys)
        {
            sb.Append("<p>");
            sb.Append(enumTexts.GetValues(myOption)[0]);
            sb.Append(helper.RadioButton(NameOfList, System.Convert.ToInt16(myOption)));
            sb.Append("</p>");
        }
        return MvcHtmlString.Create(sb.ToString());
    } 
```

这给了我 , 中的第一个枚举值`OneEnumDataContract`作为`None`参数`RadioOptions`。如何将 datacontract 中的所有枚举值放入助手中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:56:24.073

这是我最近创建的。如果您在非枚举上尝试它将不起作用，但可以满足我的枚举需求。我从不同的 DropDownList 助手（如 nikeaa 发布）中复制了一些片段。

```
#region RadioButtonList

public static MvcHtmlString RadioButtonListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IDictionary<string, object> htmlAttributes = null) where TModel : class
{
    ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
    String field = ExpressionHelper.GetExpressionText(expression);
    String fieldname = htmlHelper.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldId(field);
    var inputName = fieldname;
    TProperty val = GetValue(htmlHelper, expression);

    var divTag = new TagBuilder("div");
    divTag.MergeAttribute("id", inputName);
    divTag.MergeAttribute("class", "radio");
    foreach (var item in Enum.GetValues(val.GetType()))
    {

        DisplayAttribute[] attr = (DisplayAttribute[])item.GetType().GetField(item.ToString()).GetCustomAttributes(typeof(DisplayAttribute), true);
        if (attr == null || attr.Length == 0 || attr[0].Name != null)
        {
            string name = attr != null && attr.Length > 0 && !string.IsNullOrWhiteSpace(attr[0].Name) ? attr[0].Name : item.ToString();
            var itemval = item;
            var radioButtonTag = RadioButton(htmlHelper, inputName, new SelectListItem { Text = name, Value = itemval.ToString(), Selected = val.Equals(itemval) }, htmlAttributes);

            divTag.InnerHtml += radioButtonTag;
        }
    }

    return new MvcHtmlString(divTag.ToString());
}

public static string RadioButton(this HtmlHelper htmlHelper, string name, SelectListItem listItem,
                     IDictionary<string, object> htmlAttributes)
{
    var inputIdSb = new StringBuilder();
    inputIdSb.Append(name)
        .Append("_")
        .Append(listItem.Value);

    var sb = new StringBuilder();

    var builder = new TagBuilder("input");
    if (listItem.Selected) builder.MergeAttribute("checked", "checked");
    builder.MergeAttribute("type", "radio");
    builder.MergeAttribute("value", listItem.Value);
    builder.MergeAttribute("id", inputIdSb.ToString());
    builder.MergeAttribute("name", name);
    builder.MergeAttributes(htmlAttributes);
    sb.Append(builder.ToString(TagRenderMode.SelfClosing));
    sb.Append(RadioButtonLabel(inputIdSb.ToString(), listItem.Text, htmlAttributes));
    sb.Append("<br>");

    return sb.ToString();
}

public static string RadioButtonLabel(string inputId, string displayText,
                             IDictionary<string, object> htmlAttributes)
{
    var labelBuilder = new TagBuilder("label");
    labelBuilder.MergeAttribute("for", inputId);
    labelBuilder.MergeAttributes(htmlAttributes);
    labelBuilder.InnerHtml = displayText;

    return labelBuilder.ToString(TagRenderMode.Normal);
}

public static TProperty GetValue<TModel, TProperty>(HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression) where TModel : class
{
    TModel model = htmlHelper.ViewData.Model;
    if (model == null)
    {
        return default(TProperty);
    }
    Func<TModel, TProperty> func = expression.Compile();
    return func(model);
}

#endregion 
```

我这样用

```
@Html.RadioButtonListFor(m => m.PlayFormat) 
```

您可能需要更多代码来为更复杂的用途设置正确的元素名称。

如果枚举项具有 Display 属性，则显示名称。否则显示枚举项。如果显示名称为空，则该值不会显示为选项。在这个枚举中，不显示“None”，从枚举值显示“Singles”，“Men's Doubles”和所有其他的都有来自 [Display(Name="Men's Doubles")] 的文本

```
public enum PlayFormat
{
    [Display(Name=null)]
    None = 0,
    Singles = 1,
    [Display(Name = "Men's Doubles")]
    MenDoubles = 2,
    [Display(Name = "Women's Doubles")]
    WomenDoubles = 3,
    [Display(Name = "Mixed Doubles")]
    MixedDoubles = 4,
    [Display(Name = "Men's Group")]
    MenGroup = 5,
    [Display(Name = "Women's Group")]
    WomenGroup = 6,
    [Display(Name = "Mixed Group")]
    MixedGroup = 7
} 
```

页面看起来像这样（除了每个 - 是一个单选按钮）

```
- Singles
- Men's Doubles
- Women's Doubles
- Mixed Doubles
- Men's Group
- Women's Group
- Mixed Group 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:52:01.280

这是我在互联网上找到的一种帮助方法，用于从枚举中创建下拉列表。您应该能够修改此代码以创建单选按钮而不是下拉菜单。

```
namespace Localicy.HtmlHelpers {
    public static class HtmlHelperExtensions {
        private static Type GetNonNullableModelType(ModelMetadata modelMetadata) {
            Type realModelType = modelMetadata.ModelType;
            Type underlyingType = Nullable.GetUnderlyingType(realModelType);
            if (underlyingType != null)
                realModelType = underlyingType;

            return realModelType;
        }

        private static readonly SelectListItem[] SingleEmptyItem = new[] { new SelectListItem { Text = "", Value = "" } };

        public static string GetEnumDescription<TEnum>(TEnum value) {
            FieldInfo fi = value.GetType().GetField(value.ToString());
            DescriptionAttribute[] attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);
            if ((attributes != null) && (attributes.Length > 0))
                return attributes[0].Description;
            else
                return value.ToString();
        }

        public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression) {
            return EnumDropDownListFor(htmlHelper, expression, null, null);
        }

        public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression, string defaultValueText) {
            return EnumDropDownListFor(htmlHelper, expression, defaultValueText, null);
        }

        public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression, string defaultValueText, object htmlAttributes) {
            ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
            Type enumType = GetNonNullableModelType(metadata);
            IEnumerable<TEnum> values = Enum.GetValues(enumType).Cast<TEnum>();
            IEnumerable<SelectListItem> items = from value in values
                                                select new SelectListItem {
                                                    Text = GetEnumDescription(value),
                                                    Value = value.ToString(),
                                                    Selected = value.Equals(metadata.Model)
                                                };

            // If the enum is nullable, add an 'empty' item to the collection
            if (metadata.IsNullableValueType || defaultValueText != null)
                if(defaultValueText != null) {
                    SelectListItem[] tempItem = new[] { new SelectListItem { Text = defaultValueText, Value = "" } };
                    items = tempItem.Concat(items);
                }
                else
                    items = SingleEmptyItem.Concat(items);
                //items = (new ).Concat(items)

            return htmlHelper.DropDownListFor(expression, items, htmlAttributes);
        }
    }
} 
```

# git - 在 github 上合并来自不同用户的提交

> ID：11506577
> 
> 赞同：1
> 
> 时间：2012-07-16T14:35:43.427
> 
> 标签：git, github

我已经使用 github 一年左右了，这期间我换了一堆电脑。我在 github 上只使用了一个帐户，但由于 git 设置不同，github 认为我的大部分提交都是其他人的。所以我的提交统计数据很差，尽管事实并非如此。有没有办法让 github 相信所有这些提交都来自我的特定帐户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:43:25.683

GitHub 有以下脚本，它将重写提交历史以修复作者身份： [GitHub 的作者更改脚本](https://help.github.com/articles/changing-author-info "GitHub 的作者更改脚本")

设置它涉及一些手动工作，但它应该可以解决问题。唯一的问题是这会影响存储库的历史记录，因此所有分叉都必须相应地处理这个问题。

# php - Solr：当其中一个值为 * 时，计算两个给定日期之间的差异

> ID：11506578
> 
> 赞同：3
> 
> 时间：2012-07-16T14:35:44.527
> 
> 标签：php, search, solr

我正在研究当范围过滤器处于活动状态时，范围方面将相应更新。如果没有给出过滤器，我将使用默认范围和间隙。如果设置了过滤器，我会进行第二次 solr 调用以重新计算构面范围间隙。

因此，例如，起初我显示了 10 年差距的范围方面。当您过滤其中一个时，它会显示 1YEAR 的 10 个范围方面。如果您再次过滤，它将显示 12 个桶，范围为 1 个月等...

它有点工作，但是当范围过滤器包含 *. 当给出 solrfield:[1960-01-01T00:00:00Z TO *] 时，Solr 知道如何正确过滤结果，但我不知道如何根据 *. 现在，我将两个日期之间的差异计算为 unix 时间戳，并据此计算范围差距。

另外，我在这里尝试做的事情有名字吗？我将其称为“可变范围差距”，但我不确定这是否正确。

我什至不确定我正在做的是否是最好的方法。欢迎任何建议。

编辑：我的问题归结为：我想计算每个 solr 查询中字段的最高和最低日期之间的差异（作为 unix 时间戳）。

编辑 2：我做的每个 solr 调用大约需要 300 毫秒（在相对较小的索引上）。如果我使用日期排序进行 2 次额外调用以查找查询中的最高和最低日期值，这将是相当多的。然后使用正确的日期间隔（以及从/到值）执行第 4 次 solr 调用会有点慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T11:39:39.703

您可能可以将其变成熟悉的“有限日期范围”案例。如果您的数据不可能在将来设置日期时间，您可以将 * 替换为 NOW 始终接收相同的结果集（因为没有日期可以晚于当前时刻）并根据当前时间戳计算间隙。

# python - python：在shell上显示经过的时间

> ID：11506580
> 
> 赞同：1
> 
> 时间：2012-07-16T14:35:47.983
> 
> 标签：python, shell, time, timer

当我运行我的 Python 脚本时，有一些功能需要几分钟才能完成，所以我想在 shell 上显示某种计时器，通知用户经过的时间。

有没有这样的东西已经准备好在 Python 中使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T15:35:14.387

一种简单的方法是在[`sys.ps1`](http://docs.python.org/2/library/sys.html?highlight=sys.ps1#sys.ps1)提示中包含一个时钟（通常定义`>>>`提示的东西）

从文档中[`sys.ps1`](http://docs.python.org/2/library/sys.html?highlight=sys.ps1#sys.ps1)：

> 如果将非字符串对象分配给任一变量，`str()`则每次解释器准备读取新的交互式命令时都会重新评估它；这可用于实现动态提示。

在[`~/.local/usercustomize.py`](http://www.doughellmann.com/PyMOTW/site/)（或更准确地说，在`python -c 'import site; print site.USER_BASE'`显示的任何文件夹中）中，您可以添加：

```
import sys
import datetime

class ClockPS1(object):
  def __repr__(self):
    now = datetime.datetime.now()
    return str(now.strftime("%H:%M:%S >>> "))

sys.ps1 = ClockPS1() 
```

然后您的提示将如下所示：

```
16:26:24 >>> import time
16:26:27 >>> time.sleep(10)
16:26:40 >>> 
```

这并不完美，因为最后一次出现提示时，而不是执行该行时，但它可能会有所帮助。您可以轻松地显示`__repr__`调用之间的时间（以秒为单位），并在提示中显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:30:39.507

如果您使用的是 Linux 或 BSD 系统，请尝试使用`pv`命令 ( [http://www.ivarch.com/programs/pv.shtml](http://www.ivarch.com/programs/pv.shtml) )。

```
$ python -c 'import time;time.sleep(5)' | pv
   0B 0:00:05 [   0B/s ] [<=>                   ] 
```

它会给你一个计时器，取决于你如何编码你的应用程序的输出，还有一些其他的统计数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:06:24.753

最简单的方法是计算函数中经过的时间，该时间需要几分钟才能完成，然后将该时间简单地打印到 shell。但是，根据您的功能，这可能不是最佳解决方案。

第二种方法是使用多线程。因此，让需要一段时间的函数在线程中运行，而您的程序然后处于循环中并每隔一段时间打印出经过的时间并寻找要完成的线程。

就像是：

```
import threading
import time
arg1=0
arg2=1
etc=2

# your function that takes a while.
# Note: If your function returns something or if you want to pass variables in/out,
# you have to use Queues
def yourFunction(arg1,arg2,etc):
    time.sleep(10) #your code would replace this

# Setup the thread
processthread=threading.Thread(target=yourFunction,args=(arg1,arg1,etc)) #set the target function and any arguments to pass
processthread.daemon=True
processthread.start() # start the thread

#loop to check thread and display elapsed time
while processthread.isAlive():
    print time.clock()
    time.sleep(1) # you probably want to only print every so often (i.e. every second)

print 'Done' 
```

然后，您可以通过覆盖 shell 中的时间来变得更漂亮，甚至更好的是，使用 gui 来显示进度条！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:28:30.420

您可以使用`datetime`

例如，

```
import datetime
import time

class Profiler(object):
    def __init__(self):
        self.start = 0
        self.duration = 0

    def start(self):
        self.start = datetime.datetime.now()

    def end(self):
        self.duration = datetime.datetime.now() - self.start

class SomeClass(Profiler):
    def __init__(self):
        Profiler.__init__(self)

    def do_someting(self):
        self.start()
        time.sleep(10)
        self.end()

if __name__ == "__main__":
    foo = SomeClass()
    foo.do_something()
    print 'Time :: ', foo.duration 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T15:15:18.020

您是在谈论测量功能完成然后打印 HH:MM:SS.MS 所需的时间吗？

你可以做：

```
import datetime, time

time_begin = datetime.datetime.fromtimestamp(time.time())
# call your function here
time_end = datetime.datetime.fromtimestamp(time.time())

print("Time elapsed: ", str(time_end - time_begin)) 
```

# c# - FileUpload.FileBytes 不存储所有图像数据

> ID：11506583
> 
> 赞同：0
> 
> 时间：2012-07-16T14:35:52.897
> 
> 标签：c#, asp.net, oracle11g

我有以下代码来上传图片：

```
FileUpload uniformItemImageFileUpload = uniformItemsGrid.FooterRow.FindControl("UniformImageInsert") as FileUpload;
byte[] itemBytes = uniformItemImageFileUpload.FileBytes; 
```

并将以下内容绑定到数据库：

```
OracleParameter itemImageParameter = new OracleParameter("itemImage", OracleDbType.Blob, 4000);
itemImageParameter.Value = itemImageBytes;
oraCommand.Parameters.Add(itemImageParameter); 
```

我有一个问题，当通过这种机制上传图像时，它不会存储该图像的所有二进制数据，但如果它是大于 4kb 的图像，它只会存储部分数据。但是，问题不在于存储，因为 4000 大小的 blob 可以容纳更大的文件，事实上，如果我直接通过 SQL Navigator 上传它，它可以完全存储它，但是，当尝试上传相同的文件时没有问题图像通过代码，它不会存储所有它。

有没有人遇到过这个问题？如何修复？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:41:44.537

需要给OracleParameter指定Blob的大小，即

```
OracleParameter itemImageParameter = new OracleParameter("itemImage", OracleDbType.Blob, itemBytes.Length);
itemImageParameter.Value = itemImageBytes;
oraCommand.Parameters.Add(itemImageParameter); 
```

希望这会奏效:)

# objective-c - NSNumberFormatter 与 NSNumberFormatterCurrencyStyle: numberFromString 负值似乎关闭了一个

> ID：11506585
> 
> 赞同：2
> 
> 时间：2012-07-16T14:35:56.917
> 
> 标签：objective-c, ios, nsnumberformatter

我在具有 NSNumberFormatterCurrencyStyle 和负最小值的 NSNumberFormatter 上遇到了 numberFromString 明显的一对一问题。从下面的测试中可以看出，numberFromString 在尝试转换最小金额时返回 nil，但在低于最小值 1 时正确返回。

我是否误解了“最小值”在负面上下文中的含义？或者这是 numberFromString 中的错误？还是？

谢谢。

```
- (void)test {
    NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
    [numberFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
    [numberFormatter setMinimum:[NSDecimalNumber decimalNumberWithMantissa:2142 exponent:-2 isNegative:YES]];
    [numberFormatter setMaximum:[NSDecimalNumber decimalNumberWithMantissa:100 exponent:0 isNegative:NO]];
    [numberFormatter setNegativeFormat:[@"-" stringByAppendingString:[numberFormatter positiveFormat]]];

    NSLog(@"[numberFormatter positiveFormat] is: %@", [numberFormatter positiveFormat]);
    NSLog(@"[numberFormatter negativeFormat] is: %@", [numberFormatter negativeFormat]);
    NSLog(@"[numberFormatter minimum] is: %@", [numberFormatter minimum]);
    NSLog(@"[numberFormatter maximum] is: %@", [numberFormatter maximum]);
    NSLog(@"[numberFormatter numberFromString:@\"-$21.43\"] is: %@", [numberFormatter numberFromString:@"-$21.43"]);
    NSLog(@"[numberFormatter numberFromString:@\"-$21.42\"] is: %@", [numberFormatter numberFromString:@"-$21.42"]);
    NSLog(@"[numberFormatter numberFromString:@\"-$21.41\"] is: %@", [numberFormatter numberFromString:@"-$21.41"]);
    NSLog(@"[numberFormatter numberFromString:@\"-$21.40\"] is: %@", [numberFormatter numberFromString:@"-$21.40"]);

} 
```

控制台输出：

```
2012-07-16 10:13:04.242 Am[21075:15203] [numberFormatter positiveFormat] is: ¤#,##0.00
2012-07-16 10:13:04.244 Am[21075:15203] [numberFormatter negativeFormat] is: -¤#,##0.00
2012-07-16 10:13:04.244 Am[21075:15203] [numberFormatter minimum] is: -21.42
2012-07-16 10:13:04.245 Am[21075:15203] [numberFormatter maximum] is: 100
2012-07-16 10:13:04.246 Am[21135:15203] [numberFormatter numberFromString:@"-$21.43"] is: (null)
2012-07-16 10:13:04.247 Am[21075:15203] [numberFormatter numberFromString:@"-$21.42"] is: (null)
2012-07-16 10:13:04.248 Am[21075:15203] [numberFormatter numberFromString:@"-$21.41"] is: -21.41
2012-07-16 10:13:04.248 Am[21135:15203] [numberFormatter numberFromString:@"-$21.40"] is: -21.4 
```

# excel - 为什么函数 SUMIFS 比 iterate 好（for）

> ID：11506587
> 
> 赞同：0
> 
> 时间：2012-07-16T14:36:05.937
> 
> 标签：excel, vba, optimization

如果关闭其他工作簿，Excel SUMIFS 函数将无法执行。所以，我做了一个 SUMIFS 函数来打开我的工作簿，通过​​“for”循环进行迭代并验证是否需要将值列添加到我的总变量中。

我做了另一个删除我的“for”循环并使用“WorksheetFunction.SumIfs(...)”的函数。我的新功能比旧功能运行得更快。

excel函数和VBA迭代背后的魔力是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:49:20.833

来自：http: [//msdn.microsoft.com/en-us/library/ff726673.aspx#xlUsingFuncts](http://msdn.microsoft.com/en-us/library/ff726673.aspx#xlUsingFuncts)

（重点补充）

> 用户定义的函数
> 
> 使用 C 或 C++ 编程并使用 C API（XLL 插件函数）的用户定义函数通常比使用 VBA 或自动化（XLA 或自动化插件）开发的用户定义函数更快。有关详细信息，请参阅开发 Excel 2010 XLL。
> 
> XLM 函数也可以很快，因为它们使用与 C XLL 插件函数相同的紧密耦合 API。VBA 用户定义函数的性能对您如何编程和调用它们很敏感。
> 
> 更快的 VBA 用户定义函数
> 
> **使用 Excel 公式计算和工作表函数通常比使用 VBA 用户定义函数更快。这是因为每个用户定义函数调用的开销很小，而将信息从 Excel 传输到用户定义函数的开销很大。**但精心设计和调用的用户定义函数可以比复杂的数组公式快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:24:16.267

获得更多洞察力的一种方法是测试性能比如何随着不同的输入大小而变化。例如，如果输入大小增加 100 倍时性能比保持大致相同，则可能是由于 VBA 抽象开销所致。

# html - 单击链接时，拉起并显示该信息

> ID：11506589
> 
> 赞同：0
> 
> 时间：2012-07-16T14:36:08.640
> 
> 标签：html

我想弄清楚如何做一些HTML。基本上我想要的是：如果用户点击“优惠券”，页面的一部分会显示它。但只有当它被点击时。我不知道在哪里寻找这个或我想要做的事情的名称是什么。有人可以指出我正确的方向吗？我已经尝试过了，`<a name="">`但这会将我带到一个已经存在的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T02:59:49.320

在大多数情况下，这需要 JavaScript。但是您仍然可以在没有脚本的情况下执行此操作，除非该部分必须始终可见。实际内容将放置在单独的 HTML 页面中（即：文件）。下面是一个简单的例子：

`main.html`文件：

```
<HTML>
<BODY>
  <A HREF="content1.html" TARGET="section">Content 1</A><BR />
  <A HREF="content2.html" TARGET="section">Content 2</A><BR />
  <A HREF="content3.html" TARGET="section">Content 3</A><BR />
  <BR />
  <IFRAME ID="section" WIDTH="800" HEIGHT="600" />
</BODY>
</HTML> 
```

`content1.html`文件：

```
<HTML>
<BODY>
  This is content 1
</BODY>
</HTML> 
```

`content2.html`文件：

```
<HTML>
<BODY>
  This is content 2
</BODY>
</HTML> 
```

`content3.html`文件：

```
<HTML>
<BODY>
  This is content 3
</BODY>
</HTML> 
```

加载页面时，上述`main.html`内容部分将为空白。要设置初始内容，请更改`IFRAME`标签，使其如下所示：

```
 <IFRAME SRC="content1.tml" ID="section" WIDTH="800" HEIGHT="600" /> 
```

如果您不想在页面加载时显示该部分，则必须使用 JavaScript，如以下示例：

`main.html`文件：

```
<HTML>
<BODY>
  <SCRIPT>
    function showSection() {
      document.getElementById('section').style.display='';
    }
  </SCRIPT>
  <A HREF="content1.html" TARGET="section" onclick="showSection();">Content 1</A><BR />
  <A HREF="content2.html" TARGET="section" onclick="showSection();">Content 2</A><BR />
  <A HREF="content3.html" TARGET="section" onclick="showSection();">Content 3</A><BR />
  <BR />
  <IFRAME ID="section" WIDTH="800" HEIGHT="600" style="display:none" />
</BODY>
</HTML> 
```

# axapta - 普通日记帐 AIF 服务无法导入客户类型的抵销帐户 - AX 2012

> ID：11506591
> 
> 赞同：0
> 
> 时间：2012-07-16T14:36:11.167
> 
> 标签：axapta, ax, dynamics-ax-2012, aif

我正在尝试使用 AIF 将数据从 CSV 文件导入 AX 2012，并通过 C# Web 应用程序使用 Web 服务。

我试图提取的数据来自：

![在此处输入图像描述](../Images/25ac7a96672c9cb6de03b06ea6fc48b7.png)

我使用的网络服务是[基本的 GeneralJournalService](http://msdn.microsoft.com/en-us/library/cc967432%28v=ax.50%29.aspx)。Web 应用程序中用于使用 Web 服务的代码是（假设它正在解析 CSV 文件`string[]`并`ImportingHelper.EnumUtils.Parse`解析为枚举类型）：

```
public class ImportingJournals : ImportClass
{

           internal static int TransDateIndex = 0;
           internal static int AccountTypeIndex = 2;
           internal static int LedgerDimensionMainAccountIndex = 3;
           internal static int LedgerDimensionOnDisplayValueIndex = 4;
           internal static int LedgerDimensionValuesIndex = 5;
           internal static int DescriptionOnLineIndex = 6;
           internal static int DebittIndex = 7;   
           internal static int CreditIndex = 8;
           internal static int CurrencyIndex = 9;
           internal static int OffsetAccountTypeIndex = 10;
           internal static int OffsetMainAccountIndex = 11;  
           internal static int OffsetDisplayAccountIndex = 12;
           internal static int OffsetAccountValuesIndex = 13;
           internal static int JournalNameIndex = 14;
           internal static int DescriptionHeaderIndex = 15;
           internal static int CompanyIndex = 16;
           internal static int OffsetCompanyIndex = 16;
           internal static int FromCompanyIndex = 16;

           internal static int  ActiveIndex = 3;
           internal static int  ApproveIndex = 4;
           internal static int  FixedOffsetAccountIndex = 5;

           internal static int  ApprovalWorkflowIndex = 8;
           internal static int DetailLevelIndex = 12;
           internal static int FeesPostingIndex = 13;
           internal static int LinesLimitIndex = 14;
           internal static int PrivateForUserGroupIndex = 15;
           internal static int VoucherSeriesIndex = 16;
           internal static int NewVoucherIndex = 17;
           internal static int NumberAllocationAtPostingIndex = 18;
           internal static int DocumentIndex = 19; 
           internal static int FixedRateIndex = 20;

           internal static int AmountIncludedSalesTaxIndex = 22;
           internal static int HideSalesTaxFieldsInJournalEntryFormIndex = 23;

           internal static int LanguageIndex = 27;

           internal static int DescriptionTransIndex = 30;

        public void CreateFromCSVFile()
        {
            throw new NotImplementedException();
        }

        public void CreateFromCSVFile(System.IO.Stream fileStream)
        {

            GeneralJournalServiceClient generalJournalServiceClient = new GeneralJournalServiceClient();

            try
            {
                List<string[]> JournalData = Helper.ImportCSVFile.ParseCSVFile(fileStream, true);

                foreach (string[] journal in JournalData)
                {
                    CallContext callContext = new CallContext();

                    callContext.Company = journal[CompanyIndex];
                    callContext.Language = "en-gb";

                    AxdLedgerGeneralJournal journalEntity = new AxdLedgerGeneralJournal();

                    AxdEntity_LedgerJournalTable journalHeader = new LedgerServices.AxdEntity_LedgerJournalTable();

                    journalHeader.JournalName = journal[JournalNameIndex].Trim();
                    journalHeader.Name = journal[DescriptionHeaderIndex].Trim();

                    if (journal[DetailLevelIndex] != String.Empty)
                    {
                        journalHeader.DetailSummaryPostingSpecified = true;
                        AxdEnum_DetailSummary? parsingDetailSummary = ImportingHelper.EnumUtils.Parse<AxdEnum_DetailSummary>("Detail");
                        if (parsingDetailSummary != null)
                            journalHeader.DetailSummaryPosting = (AxdEnum_DetailSummary) parsingDetailSummary;

                    }
                    else
                        journalHeader.DetailSummaryPostingSpecified = false;

                    journalHeader.DetailSummaryPosting = AxdEnum_DetailSummary.Detail;

                    AxdEntity_LedgerJournalTrans journalLine = new AxdEntity_LedgerJournalTrans();

                    if (journal[TransDateIndex] != null)
                    {
                        journalLine.TransDateSpecified = true;
                        journalLine.TransDate = DateTime.Parse(journal[TransDateIndex]);
                    }
                    else
                        journalLine.TransDateSpecified = false;

                    if (journal[AccountTypeIndex] != null)
                    {
                        journalLine.AccountTypeSpecified = true;

                        AxdEnum_LedgerJournalACType? parsingLedgerJournalACType = ImportingHelper.EnumUtils.Parse<AxdEnum_LedgerJournalACType>(journal[AccountTypeIndex]);
                        if (parsingLedgerJournalACType != null)
                            journalLine.AccountType = (AxdEnum_LedgerJournalACType)parsingLedgerJournalACType;
                    }
                    else
                        journalLine.AccountTypeSpecified = false;

                    AxdType_MultiTypeAccount LedgerDimension = new AxdType_MultiTypeAccount();

                    LedgerDimension.DisplayValue = journal[LedgerDimensionOnDisplayValueIndex];
                    LedgerDimension.Account = journal[LedgerDimensionMainAccountIndex];
                    journalLine.LedgerDimension = LedgerDimension;

                    journalLine.Txt = journal[DescriptionOnLineIndex];

                    if (journal[DebittIndex] != String.Empty)
                    {
                        journalLine.AmountCurDebitSpecified = true;
                        journalLine.AmountCurDebit = Decimal.Parse(journal[DebittIndex]);
                    }
                    else
                        journalLine.AmountCurDebitSpecified = false;

                    if (journal[CreditIndex] != String.Empty)
                    {
                        journalLine.AmountCurCreditSpecified = true;
                        journalLine.AmountCurCredit = Decimal.Parse(journal[CreditIndex]);
                    }
                    else
                        journalLine.AmountCurCreditSpecified = false;

                    if (journal[OffsetAccountTypeIndex] != String.Empty)
                    {
                        journalLine.OffsetAccountTypeSpecified = true;
                        AxdEnum_LedgerJournalACType? parsingLedgerJournalACType = ImportingHelper.EnumUtils.Parse<AxdEnum_LedgerJournalACType>(journal[OffsetAccountTypeIndex]);
                        if (parsingLedgerJournalACType != null)
                            journalLine.OffsetAccountType = (AxdEnum_LedgerJournalACType)parsingLedgerJournalACType;

                    }
                    else
                        journalLine.OffsetAccountTypeSpecified = false;

                    AxdType_MultiTypeAccount ledgerOffsetDimension = new AxdType_MultiTypeAccount();
                    ledgerOffsetDimension.Account = journal[OffsetMainAccountIndex];
                    ledgerOffsetDimension.DisplayValue = journal[OffsetDisplayAccountIndex];
                    journalLine.OffsetLedgerDimension = ledgerOffsetDimension;

                    journalLine.CurrencyCode = journal[CurrencyIndex];

                    journalLine.OffsetCompany = journal[OffsetCompanyIndex];

                    journalLine.Company = journal[FromCompanyIndex];

                    AxdEntity_LedgerJournalTrans[]  journalTransCollection =  new AxdEntity_LedgerJournalTrans[1] 
                    {
                        journalLine
                    };

                    journalHeader.LedgerJournalTrans = journalTransCollection;
                    journalEntity.LedgerJournalTable = 
                    new AxdEntity_LedgerJournalTable[1] 
                    {
                        journalHeader
                    };

     generalJournalServiceClient.create(callContext, journalEntity);
                }

            }
            catch (Exception ex)
            {
                String message = ex.Message;
            }
            finally
            {
                generalJournalServiceClient.Close();
            } 
```

如果有人知道如何解决这个问题，请告诉我。银行和分类帐之间的交易是可能的。但是银行和客户之间的交易是不可能的。我收到错误消息：

**抵销科目类型必须是以下类型之一：Ledger、Bank。**

我不知道问题是否出在 General Journal Service 是否识别 OffsetAccount Cust。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:13:03.940

经过数小时的研究，我发现可能是一些配置数据，但问题与此博客中报告的问题非常相似：

[http://www.amer-ax.com/2011/06/how-to-use-the-gl-aif-service-to-integrate-non-ledger-transactions/](http://www.amer-ax.com/2011/06/how-to-use-the-gl-aif-service-to-integrate-non-ledger-transactions/)

Web 服务提供 C# 上的类：

```
/// <remarks/>
    [System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "4.0.30319.233")]
    [System.SerializableAttribute()]
    [System.Xml.Serialization.XmlTypeAttribute(Namespace="http://schemas.microsoft.com/dynamics/2008/01/sharedtypes")]
    public enum AxdEnum_LedgerJournalACType {

        /// <remarks/>
        Ledger,

        /// <remarks/>
        Cust,

        /// <remarks/>
        Vend,

        /// <remarks/>
        Project,

        /// <remarks/>
        FixedAssets,

        /// <remarks/>
        Bank,
    } 
```

和

```
 /// <remarks/>
        [System.Xml.Serialization.XmlElementAttribute(IsNullable=true, Order=9)]
        public System.Nullable<AxdEnum_LedgerJournalACType> OffsetAccountType {
            get {
                return this.offsetAccountTypeField;
            }
            set {
                this.offsetAccountTypeField = value;
                this.RaisePropertyChanged("OffsetAccountType");
            }
        } 
```

但是 AX 2012 在 X++ 的另一端不支持它。查看类的`validateOffsetAccountType`方法`LedgerTransType` ：

```
protected boolean validateOffsetAccountType()
{
    boolean isValid = true;

    switch (ledgerJournalTable.JournalType)
    {
        case LedgerJournalType::Daily :
                if (ledgerJournalTrans.OffsetAccountType != LedgerJournalACType::Ledger &&
                    ledgerJournalTrans.OffsetAccountType != LedgerJournalACType::Bank)
                {
                    if (this.isConsumerStateTracked())
                    {
                        // service limitation
                        isValid = AifFault::checkFailedLogFault("@SYS118081", #OffsetAccountTypeIsNotSupported);
                    }
                }
            break;

        default :
            break;
    }

    return isValid;
} 
```

# ios - 修改 Cocos2D 滑动菜单网格添加额外的 BUY ME 按钮

> ID：11506592
> 
> 赞同：0
> 
> 时间：2012-07-16T14:36:11.730
> 
> 标签：ios, menu, cocos2d-iphone, sliding

我正在尝试在我的应用程序中使用 SlidingMenuGrid 代码并改变一些行为。问题是我有点卡住了。在 Brandon Reynolds 的[博客](http://brandonreynolds.com/blog/2011/01/09/cocos2d-sliding-menu-grid/)中，您可以找到一个带有菜单的示例项目，非常棒。我非常感谢他分享他有用的代码。

我想要实现的是一个滑动菜单，其中不仅可以触摸图像项目，而且还可以触摸表示带有购买产品选项的按钮的图像（或更多按钮 - 例如购买/出售 - 使用/停止使用等。RPG风格）。在下图中，我使用了带有文本的菜单项，但在最终版本中，我希望使用带有精灵的菜单项。

SlidingMenuGrid 通过接受 CCMenuItemSprite 数组来工作，并且 API 允许设置显示类型、列和行的 nr。

我曾尝试在 CCLayer 中添加带有选择器的 CCMenu，我还添加了 SlidingMenuGrid 实例，但不幸的是，即使我启用了触摸，单击它时也不会调用选择器。

我认为正在发生的事情是 SlidingMenuGrid 吞下了所有的触摸。我试图修改它，但我并不真正理解代码，我试图找到一个更简单、更容易的解决方案（例如，通过在图层上添加一个菜单项而不是使用 SlidingMenuGrid）。

有什么想法或建议吗？

![这就是我想要实现的 - 或多或少](../Images/3563b263177d3ff78771a4c87af1703c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:43:51.237

一些以前的用户提到他们已经在系统中添加了一个“返回”按钮，方法是将其放置在另一层并将菜单网格设置为不吞下触摸。我没有对此进行测试，但我认为它应该可以工作..

[[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:INT_MIN+1swallowsTouches:NO]

有关更多信息，请参阅我博客上帖子的其余评论。

-布兰登雷诺兹

# jquery - 验证成功后禁用提交操作

> ID：11506609
> 
> 赞同：0
> 
> 时间：2012-07-16T14:37:08.840
> 
> 标签：jquery, validation

我正在使用这个插件[http://code.google.com/p/bvalidator/](http://code.google.com/p/bvalidator/)

```
 $('#vendorDetailsForm').bValidator();

 if ( $('#vendorDetailsForm').data('bValidator').isValid() ) {
     $("#addVendorsTabs").tabs('select', 4);
 } 
```

上述逻辑绑定到嵌套在 vendorDetailsForm 元素内的按钮，但我想在验证成功后禁用提交操作，而是导航到索引 4 中的选项卡。

目前它导航到索引 4，但随后它提交了表单！

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:47:05.020

jQuery 的[preventDefault](http://api.jquery.com/event.preventDefault/)是您的最佳选择，因此它在浏览器中的工作更加一致。

```
$("#submit").submit(function(evt) {
    ...
    evt.preventDefault(); // prevent default behavior of the event, in this case form submission
    return false; // return false, just in case, but in theory is not necessary
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:43:33.807

您应该在按钮`return false`触发的函数的末尾放置一个。`submit`

例如

```
$("#submit").submit(function() {
    $('#vendorDetailsForm').bValidator();
    if ($('#vendorDetailsForm').data('bValidator').isValid()) {
        $("#addVendorsTabs").tabs('select', 4);
    }
    return false;
});​ 
```

# sql - 如何将 null 写入 Guid？数据库中的字段？

> ID：11506613
> 
> 赞同：0
> 
> 时间：2012-07-16T14:37:28.587
> 
> 标签：sql, asp.net-mvc, entity-framework

我有向导吗？我的 POCO 中的字段，当我在我的数据库中创建一个新条目并通过 SSMSE 查看它时，我在该字段中看到 NULL。在为这个新用户条目选择了一个经理后，guid? 字段被更新以保存新经理的 id。但是，如果我想将用户改回没有经理，如何将字段设置回 NULL？

我应该使用 Guid 而不是 Guid 吗？而是将 Guid.Empty 写入数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:44:06.330

> 我应该使用 Guid 而不是 Guid 吗？而是将 Guid.Empty 写入数据库？

并不真地。你可以这样做，但你不会真正获得太多。从语义上讲，如果字段没有“无”值，则 NULL 是正确的值。你所说的是使用[魔法值](https://softwareengineering.stackexchange.com/questions/142278/are-nullable-types-preferable-to-magic-numbers)。

> 如何将字段设置回 NULL？

`Guid?`在您的 POCO 上将设置为 null。例如，如果您的 POCO 看起来像这样：

```
public class Poco
{
    public Guid? Manager { get; set; }
} 
```

像这样将其设置为 null：

```
somepocoinstance.Manager = null; 
```

然后提交更改。

# java - SQL中的maxdrawdown计算

> ID：11506617
> 
> 赞同：1
> 
> 时间：2012-07-16T14:37:50.413
> 
> 标签：java, sql, oracle11gr2

好吧，假设我有一个来自交易账户的简单表格，其中包含所有典型的交易信息：

```
Account     ID  Type OrderID    Points  NetPL   Balance
13543564678 16  BUY  389745683  4.55    100.00  1,000,000.00
13543564678 16  BUY  389745684  4.55    100.00  1,000,100.00
13543564678 16  BUY  389745685  4.55    100.00  1,000,200.00
13543564678 16  SELL 389745686  4.55    100.00  1,000,300.00
13543564678 16  BUY  389745687  4.55    100.00  1,000,400.00
13543564678 16  SELL 389745688  4.55    100.00  1,000,500.00
13543564678 16  SELL 389745689  4.55    100.00  1,000,600.00
13543564678 16  SELL 389745690  4.55    -100.00 1,000,700.00
13543564678 16  SELL 389745691  4.55    -100.00 1,000,600.00
13543564678 16  SELL 389745692  4.55    -100.00 1,000,500.00
13543564678 16  SELL 389745693  4.55    -100.00 1,000,400.00
13543564678 16  SELL 389745694  4.55    100.00  1,000,300.00
13543564678 16  SELL 389745695  4.55    100.00  1,000,400.00
13543564678 16  BUY  389745696  4.55    100.00  1,000,500.00
13543564678 16  BUY  389745697  4.55    100.00  1,000,600.00
13543564678 16  BUY  389745698  4.55    100.00  1,000,700.00
13543564678 16  BUY  389745699  4.55    100.00  1,000,800.00
13543564678 16  BUY  389745700  4.55    100.00  1,000,900.00
13543564678 16  BUY  389745701  4.55    100.00  1,001,000.00
13543564678 16  BUY  389745702  4.55    100.00  1,001,100.00
13543564678 16  BUY  389745703  4.55    100.00  1,001,200.00
13543564678 16  BUY  389745704  4.55    -100.00 1,001,300.00
13543564678 16  BUY  389745705  4.55    -100.00 1,001,200.00
13543564678 16  BUY  389745706  4.55    -100.00 1,001,100.00
13543564678 21  BUY  389745707  4.55    -100.00 1,001,000.00
13543564678 21  SELL 389745708  4.55    -100.00 1,000,900.00
13543564678 21  SELL 389745709  4.55    -100.00 1,000,800.00
13543564678 21  SELL 389745710  4.55    -100.00 1,000,700.00
13543564678 21  BUY  389745711  4.55    -100.00 1,000,600.00
13543564678 21  SELL 389745712  4.55    -100.00 1,000,500.00
13543564678 21  BUY  389745713  4.55    -100.00 1,000,400.00
13543564678 21  SELL 389745714  4.55    -100.00 1,000,300.00
13543564678 21  SELL 389745715  4.55    100.00  1,000,200.00
13543564678 21  BUY  389745716  4.55    100.00  1,000,300.00 
```

我在这里需要的是仅使用 sql 计算最大回撤。我可以在 java 上轻松地做到这一点（运行一个循环），但这应该是一个大查询的一部分，计算不同的 acc 参数。

所以让我解释一下公式：对于数据库中所有可用的 acc 记录，最大回撤是一个显示最大余额下降到负数的值。看看上面的 ex，第一个回撤是 400 美元（第一个负 100 美元部分），第二个更大，它是 1200 美元（第二个）。如您所知，这些回撤经常发生，因此 acc 历史应该有很多，而不仅仅是此处显示的 2 次。通常它会在一个巨大的数据集上计算这种数据，从 100,000 条记录开始。

env 是 oracle 11gr2，只读访问。任何聪明的想法将不胜感激！

好的，看起来系统会覆盖编辑，所以我必须将其放入 1 个合并中。我尝试添加一个 artif 列，其中映射负数交易为“Y”，并试图找到一种方法如何在它之后对它们执行 sum()。这里的问题是任何单个记录都可以超过任何结果记录的 sum()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:34:38.753

您想首先列举下降。我通过使用带有累积和的滞后函数来做到这一点。通过查看先前的 PL 为正数和当前的负数，滞后找到了下跌的开始。累积和分配一个值。

其余的来自识别这些时期。

```
select Account, MAX(DrawDownAmount)
from (select Account, DrawDownNum, SUM(-NetPl) as DrawDownAmount
      from (select t.*,
                   sum(BeginDrawDown) over (partition by Account order by orderid) as DrawDownNum
            from (select t.*,
                         (case when NetPL < 0 then 1 else 0 end) as isdrawdown,
                         (case when coalesce(lag(NetPl, 1) over (partition by Account order by orderid), 1) >= 0 and
                                    NetPl < 0
                               then 1
                               else 0
                    end) as BeginDrawDown
                  from t
                 ) t
           ) t
      where isdrawdown = 1
      group by Account, DrawDownNum
     ) t
 group by Account 
```

# javascript - 在画布中拖动时图像闪烁

> ID：11506619
> 
> 赞同：5
> 
> 时间：2012-07-16T14:38:03.430
> 
> 标签：javascript, html, html5-canvas

我正在画布内拖动图像。但是在拖动图像的过程中会闪烁。我认为函数调用存在一些问题。我已经使用 onmousedown、onmouseup 和 onmousemove 事件实现了功能。我在拖动过程中将图像绘制到画布上。

这是我的代码，

```
<html>
    <head>
    </head>
    <body>
    <div>
    <canvas id="canvas5" height="500" width="500" style = "position:relative;left:500px; border:2px  solid black;"> This text is displayed if your browser does not support HTML5 Canvas. </canvas>
    </div>
    <script type="text/javascript">
    var x2 = 100;
    var y2 = 100;
    var ctx; 
    var can;  
    var img=new Image();
    function drawcan() {
    can = document.getElementById("canvas5");
    ctx = can.getContext('2d');
    ctx.clearRect(0, 0, 500, 500);
    img.onload = function(){
    ctx.drawImage(img,x2 - img.width/2,y2 - img.height/2, img.width,img.height);
    };
    img.src="images/213.jpg";
    };

    function myMove(e){
    x1 = e.pageX - x2 - can.offsetLeft;
    x2 = x2 + x1;
    y1 = e.pageY - y2 - can.offsetTop;
    y2 = y2 + y1;
    drawcan();
    };

    function myDown(e) {
    if (e.pageX < x2 + img.width/2 + canvas5.offsetLeft)
    if (e.pageX > x2 - img.width/2 + canvas5.offsetLeft)
    if (e.pageY < y2 + img.height/2 + canvas5.offsetTop)
    if (e.pageY > y2 - img.height/2 + canvas5.offsetTop){ 
    can.onmousemove = myMove;
    };
    };  

    function myUp(e){
    can.onmousemove = null;   
    };

    drawcan();
    can.onmousedown = myDown;
    can.onmouseup = myUp;
    </script>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:44:30.957

```
function drawcan() {
    can = document.getElementById("canvas5");
    ctx = can.getContext('2d');
    ctx.clearRect(0, 0, 500, 500);
    img.onload = function(){
        ctx.drawImage(img,x2 - img.width/2,y2 - img.height/2, img.width,img.height);
    };
    img.src="images/213.jpg";
}; 
```

看看这是做什么的？每次调用时`drawcan`，它都会在稍后绘制之前加载图像。当然，图像是缓存的，但这个过程需要时间。相反，在做任何事情之前等待图像加载，然后永远不要再次加载它。

```
var img = new Image(),
    load = false,
    can = document.getElementById("canvas5"),
    ctx = can.getContext('2d');
img.onload = function() {
    load = true;
    drawcan(); // init
};
img.src="images/213.jpg";

function drawcan() {
    if (!load) return;
    ctx.clearRect(0, 0, 500, 500);
    ctx.drawImage(img, x2 - img.width/2,y2 - img.height/2, img.width,img.height);
}; 
```

# asp.net - 有条件地在 Gridview Boundfield Cell 中显示图像

> ID：11506620
> 
> 赞同：1
> 
> 时间：2012-07-16T14:38:05.567
> 
> 标签：asp.net, datagrid

我有一个`Gridview`有 2 列的：***计划值***和***实际值***。

我正在从表中获取数据。我需要根据如下所示的值在第二列（值之后）显示向上或向下箭头图像：

```
| plan | actual |                       

| 40    | 50 ^  | 
```

也就是说，如果实际 > 计划则在相反情况下在实际列向下箭头的值之后显示向上箭头。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:50:39.330

试试这个：

添加模板字段：

```
<asp:TemplateField HeaderText="Territories"><ItemTemplate>
          <asp:Literal ID="litActual" runat="server"></asp:Literal>
        </ItemTemplate>
        </asp:TemplateField> 
```

C#代码：

```
 void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            Literal litActual= (Literal)e.Row.FindControl("litActual");

    if(Convert.ToInt32( ((DataRowView) e.Row.DataItem)["actual"]) > Convert.ToInt32( ((DataRowView) e.Row.DataItem)["plan"]))
      litActual.Text = ((DataRowView) e.Row.DataItem)["actual"].ToString() + " <img src="upimageurl"></img>";
   else
    litActual.Text = ((DataRowView) e.Row.DataItem)["actual"].ToString() + " <img src="downimageurl"></img>";

        }
    } 
```

# java - 如何使用数字获取货币对象

> ID：11506625
> 
> 赞同：3
> 
> 时间：2012-07-16T14:38:29.853
> 
> 标签：java, android, currency

我有一项服务向我发送我应该使用的货币的货币 ID。ID 是一个代表 ISO-4217 货币的数字。

java Currency 对象能够根据货币字符串ID（即USD、JPY...）获取实例，而不是根据ISO 编号代码（即840、392...）

如何使用数字值获取实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-03T20:23:54.313

Maven 工件**com.neovisionaries:nv-i18n:1.9**包含**CurrencyCode**，这是一个列出所有 ISO 4217 代码的 Java 枚举。使用 CurrencyCode，从 ISO 4217 数字代码中获取 Currency 实例可以编写如下。

```
import java.util.Currency;
import com.neovisionaries.i18n.CurrencyCode;

public class Test
{
    public static void main(String[] args)
    {
        // Get the Currency instance for 392 (Japanese Yen).
        Currency currency
            = CurrencyCode.getByCode(392).getCurrency();

        // This prints "JPY".
        System.out.println("currency = " + currency);
    }
} 
```

nv-i18n 项目页面：
[https ://github.com/TakahikoKawasaki/nv-i18n](https://github.com/TakahikoKawasaki/nv-i18n)

马文：

```
<dependency>
    <groupId>com.neovisionaries</groupId>
    <artifactId>nv-i18n</artifactId>
    <version>1.9</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:17:31.560

由于 Java 7（可能不适用于 Android，除非 Android 支持 Java 7），数字代码包含在货币数据中，但不幸的是（出于某种奇怪的原因）Currency 类中没有静态查找方法。

您可以自己实现这样的方法，可能会为性能优化创建一个查找图，而不是在每次调用中遍历所有货币：

```
public static Currency getByCode(int code) {
    for(Currency c : Currency.getAvailableCurrencies()) {
        if(c.getNumericCode() == code) {
            return c;
        }
    }
    throw new IllegalArgumentException("Unkown currency code: " + code);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-28T11:36:10.553

ISO 4217 货币可以在以下位置以 xml 格式找到：

[http://www.currency-iso.org/dam/downloads/table_a1.xml](http://www.currency-iso.org/dam/downloads/table_a1.xml)

您可以将文件保存在您的应用程序中，并使用一些 xpath 来提取相关的货币代码，然后您可以在`Currency.getInstance(String currencyCode)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T14:48:58.993

您必须创建一个映射，将数字映射到 ISO 字符串。

```
class MyISO4217Mapper {
    private static final Map<Integer, String> mapOfISO4217 = new HashMap<>();

    static {
        // create static mappings here:

        mapOfISO4217.put(710, "ZAR");
        // .
        // .
        // .
        mapOfISO4217.put(840, "USD");
    }

    public static Currency getISOCode(Integer id) {
        String isoCode = mapOfISO4217.get(id);
        return Currency.getInstance(isoCode);
    }
} 
```

# jquery - 当我更改类名时，webkit 转换延迟不适用

> ID：11506631
> 
> 赞同：0
> 
> 时间：2012-07-16T14:39:00.077
> 
> 标签：jquery, webkit

我正在制作幻灯片，为此，我制作了一个叠加层来显示，而人们点击列表中的图像。

在覆盖 div 中，我在不透明度更改中应用了“1s”延迟。但是当我将课程从隐藏更改为显示时，我没有得到不透明的一天。

有什么好的方法可以做到这一点，或者是正确的方法吗？

功能：

```
var showOverlay = function(params){
    var layer = params.overlay;
    console.log(layer);
    if('layer:hidden'){
        layer.removeClass('hidden');
        layer.addClass('show');
    }
}

var basicLayout = function (params) {

    var $list = params.list;

    $list.click( function () {
        showOverlay(params);
    } );
}

$(document).ready( function () {
    var params = {
        list : $('#container').find('li'),
        overlay : $('#overlay')
    }
    basicLayout(params)
})​ 
```

[这是jsfiddle](http://jsfiddle.net/RhPhb/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T05:40:38.870

通过一些实验，我将我的功能拆分为：

```
var showOverlay = function(params){
    var layer = params.overlay;

    if( layer.is(':hidden') ){
        layer.removeClass('hidden');//1
        layer.show();//2
        layer.addClass('show');//3 - applying separately, now it works fine.
    }
}

var basicLayout = function (params) {

    var $list = params.list;

    $list.click( function () {
        showOverlay(params);
    } );
}

$(document).ready( function () {
    var params = {
        list : $('#container').find('li'),
        overlay : $('#overlay')
    }
    basicLayout(params)
}) 
```

谢谢大家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:45:03.573

条件错误：

```
if ( layer.is(':hidden') ) { 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T14:56:54.997

你不需要在你`#overlay.show`的`#overlay.hidden`CSS 中。而是设置`#overlay`为`display: none`而不是`opacity: 0`.

然后删除：

```
if('layer:hidden'){
    layer.removeClass('hidden');
    layer.addClass('show');
} 
```

并将其替换为：

```
layer.fadeIn(); 
```

或者，如果您想要一秒钟的延迟，您可以使用：

```
layer.delay(1000).fadeIn(); 
```

# sharepoint - sharepoint 先决条件安装

> ID：11506632
> 
> 赞同：0
> 
> 时间：2012-07-16T14:39:16.793
> 
> 标签：sharepoint, sharepoint-2010

在 Windows Server R2 Standard 上安装 sharepoint 2010。

运行安装先决条件时，我得到： ![在此处输入图像描述](../Images/ff4e17463f000edc55c5a8dab1559deb.png)

如果我重新启动它会继续安装并产生相同的结果。IIS 配置上总是出现错误，提示它需要重新启动。我做了4次以上。

该日志包含以下内容：

```
2012-07-16 16:32:39 - Request for install time of Application Server Role, Web Server (IIS) Role
2012-07-16 16:32:40 - Request for install time of Application Server Role, Web Server (IIS) Role
2012-07-16 16:32:41 - Request for install time of Application Server Role, Web Server (IIS) Role
2012-07-16 16:32:42 - Request for install time of Application Server Role, Web Server (IIS) Role
2012-07-16 16:32:43 - Request for install time of Application Server Role, Web Server (IIS) Role
2012-07-16 16:32:44 - Install process returned (0X3E9=1001)
2012-07-16 16:32:44 - [In HRESULT format] (0X800703E9=-2147023895)
2012-07-16 16:32:44 - Last return code (0X3E9=1001)
2012-07-16 16:32:44 - Error: A pending restart blocks the installation 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:23:49.907

运行 windows update 并获取 2008 R2 服务器的所有更新。

这是安装 SharePoint 2010 之前的第一步。

# linux - Gnome，显示身份验证对话框

> ID：11506635
> 
> 赞同：1
> 
> 时间：2012-07-16T14:39:26.037
> 
> 标签：linux, authentication, root, privileges, sudo

我正在使用 Qt 编写一个 GUI 应用程序。我想使用超级用户/root 权限在我的 GUI 应用程序中运行终端命令。我的应用程序没有以超级用户/root 身份启动。

在 Ubuntu 上使用 gksu，在基于 KDE 的发行版上使用 kdesu，可以解决问题。但是其他基于 Gnome 的发行版没有 GUI 实用程序来为 su 或 sudo 终端命令提供身份验证对话框。

安装 beesu 是一种选择，但我想使用安装的认证实用程序，例如 gksu 或 kdesu。例如，在 Fedora 17 Gnome 中，当用户想要使用添加/删除软件工具安装某些软件时，会显示一个身份验证对话框。这是对话框： [http ://dox.abv.bg/files/fdw?eid=87844171](http://dox.abv.bg/files/fdw?eid=87844171)

这个身份验证对话框可能集成在 Fedora 的添加/删除软件实用程序中，因为当它显示时，不会启动其他进程，因为从系统监视器工具中可以明显看出这一点。

以下是对此案的更详细解释：http: [//qt-project.org/forums/viewthread/18737/](http://qt-project.org/forums/viewthread/18737/)

我在使用 openSuse 12.1 Gnome linux 时遇到了同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:30:32.290

为什么不在 Qt 中创建一个窗口并将输入传递给 sudo / su？

# matplotlib - Matplotlib Figure()（区分大小写）没有属性 figlegend

> ID：11506636
> 
> 赞同：0
> 
> 时间：2012-07-16T14:39:29.520
> 
> 标签：matplotlib, python-2.7, figure

如果我在 matplotlib 中初始化我的图形，`myfigure=Figure((5.0, 4.0), dpi=100)`为什么我不能使用`figlegend(handles,labels,'upper center')`？为什么我通常不能使用适用的功能`myfigure = plt.figure()`？（如果我像进口一样`from matplotlib import pyplot as plt`）

如果我可以，我会怎么做？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:33:05.873

figlegend pyplot 函数是一个非常简单的图形方法包装器。无花果的代码：

```
def figlegend(handles, labels, loc, **kwargs):
    ...
    l = gcf().legend(handles, labels, loc, **kwargs)
    draw_if_interactive()
    return l 
```

如您所见，您真正需要做的就是在图形上使用图例方法来获得相同的结果。

高温高压

# php - 不要拆分连字符的单词

> ID：11506640
> 
> 赞同：4
> 
> 时间：2012-07-16T14:39:48.927
> 
> 标签：php, html, css, wordpress, hyphenation

我正在开发一个网站（Wordpress、HTML、CSS、jQuery），其内容是用葡萄牙语编写的。有很多带有连字符的单词，如果它们出现在行尾，就会被分成两半。这是一个例子：

```
Batata frita pála-
pála, é uma tara de
sabor. 
```

有没有一种方法可以检测一个单词是否连字符，如果它位于行尾，则不将其分成两半？理想的情况是整个单词都转到下一行，但如果不可能，我愿意接受建议。像这样的东西：

```
Batata frita
pála-pála, é uma
uma tara de sabor. 
```

对我来说，比知道解决方案更重要的是理解它。提前致谢。

**编辑**

该网站是在CMS平台上开发的，内容由客户端插入，是动态的。我不能指望客户自己使用不间断的连字符（HTML `&#8209;`）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:45:30.273

**[用不间断连](http://www.fileformat.info/info/unicode/char/2011/index.htm)**字符替换所有连字符。它与不间断空格 ( `&nbsp;`) 相同，只是它是一个连字符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T14:44:18.003

如果您谈论的是浏览器自己的文本/HTML 内容包装（而不是正则表达式拆分），我可以想到两种方法来做到这一点：

*   使用不间断连字符 (HTML `&#8209;`) 而不是常规连字符
*   添加`<span style="white-space: nowrap">`您不想包装的部分

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:56:16.697

正如其他人所建议的那样，您需要用不间断的连字符替换常规连字符。

这可以由 CMS 自动完成。

对于 Wordpress，您可以在主题中添加[内容过滤](https://codex.wordpress.org/Plugin_API/Filter_Reference/the_content)器`functions.php`：

```
function non_breaking_hyphens($content){
    return str_replace('-', '&#8209;', $content);
}

add_filter('the_content', 'non_breaking_hyphens'); 
```

这将在帖子正文发送到浏览器之前应用所需的搜索替换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T18:14:42.063

有几种可能性：

```
<nobr>pála-pála</nobr>
<span class=nobr>pála-pála</span>
pála&#8209;pála 
```

各有利弊（见[http://www.cs.tut.fi/~jkorpela/html/nobr.html](http://www.cs.tut.fi/~jkorpela/html/nobr.html)）。

无论您选择哪种方法，您都可以尝试在服务器端或客户端自动化流程。由于这或多或少是展示性的，我认为它可以通过客户端 JavaScript 来完成。我建议采用类似于 Firefox 的策略：可以分割长连字符的化合物（它通常会改进格式），但如果连字符两边的字符少于 4 个，请防止分割。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T13:08:46.253

关于问题中的更新：

我看到了三种可能的解决方案，但没有一个简单的解决方案:)

1.  使用正则表达式解析内容，如果子字符串在 内`>....<`，则使用`str_replace`或包裹在`<nobr>`=> 中容易出错且复杂
2.  使用内容构建 DOMDocument，遍历 DOM 并使用您选择的非破坏性解决方案处理每个 textNode。=> 服务器资源可能很昂贵
3.  客户端：我见过的大多数 WYSIWYG 都有用于扩展的 API。添加一个插入不间断连字符的按钮或添加一个替换为的 onKeyUp 侦听`-`器`&#8209;`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-04T19:49:59.477

如果您因为在 iOS 移动浏览器中检查您的网站而面临这一挑战，您必须放置更强大的代码。例如，Apple iPhone 将重排文本，但也会自行决定使用连字符。所以，这样做可以完全消除这个问题：

```
.yourclass{
    -moz-hyphens: none;
    -ms-hyphens: none;
    -webkit-hyphens: none;
    hyphens: none;
} 
```

# ms-access - 使用 VBA 解析 XML 文件

> ID：11506651
> 
> 赞同：3
> 
> 时间：2012-07-16T14:40:25.110
> 
> 标签：ms-access, xml-parsing, vba, msxml

我有一个类似于以下结构的 XML 文件：

```
<egh_eval>
<eval_set>
    <eval_id>FLOAT</eval_id>
    <eval_d>
        <height>INT</height>
        <weight>INT</weight>
    </eval_d>
    <eval_e>
        <height>INT</height>
        <weight>INT</weight>
    </eval_e>
    <eval_cred>
        <credit>FLOAT</credit>
    </eval_cred>
</eval_set> 
```

我需要解析完整的文件并将其放在一个表中。（注意：eval_d 和 eval_e 实际上各有一百多个属性）。我尝试使用 MSXML2，但是当我尝试解析文件时卡住了。通过使用[如何在 VBA 中粘贴 XML 和在 VBA 中](https://stackoverflow.com/questions/11305/how-to-parse-xml-in-vba)解析[XML 中](https://stackoverflow.com/questions/7271075/parse-xml-in-vba)的答案，我能够到达那里：

```
Dim fSuccess As Boolean
Dim oDoc As MSXML2.DOMDocument
Dim oRoot As MSXML2.IXMLDOMNode ' Level 0 egh_eval
Dim oChild As MSXML2.IXMLDOMNode ' Level 1 eval_set
Dim oChildren As MSXML2.IXMLDOMNode ' Level 2 eval_id, eval_d, eval_e, eval_cred

Dim domList As MSXML2.IXMLDOMNodeList

Set oDoc = New MSXML2.DOMDocument
oDoc.async = False
oDoc.validateOnParse = False

fSuccess = oDoc.Load(Application.CurrentProject.Path & "\file.xml")

Set oRoot = oDoc.documentElement
Set oChild = oRoot.childNodes(0)
Set oChildren = oChild.childNodes(0)

For i = 0 To oChild.childNodes.length - 1
    For y = 0 To oChildren.childNodes.length - 1
        MsgBox oChildren.nodeName & " : " & oChildren.nodeTypedValue
        oChildren.childNodes.nextNode
    Next
    oChild.childNodes.nextNode
Next 
```

但是，它没有给我正确的值，而是给了我 eval_id 中的浮点数 4 次...

谢谢 ！

编辑：我正在使用 Microsoft Access 2002 SP3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T15:05:23.643

你的循环全错了。不要使用计数循环。有`For Each`哪个可以完全满足您的需要，而且它也更具可读性。

```
Dim egh_eval As MSXML2.IXMLDOMNode
Dim eval_set As MSXML2.IXMLDOMNode
Dim eval_prop As MSXML2.IXMLDOMNode

Set egh_eval = oDoc.documentElement.childNodes(0)

For Each eval_set In egh_eval.childNodes
  If eval_set.nodeType = NODE_ELEMENT Then
    For Each eval_prop In eval_set.childNodes
      If eval_prop.nodeType = NODE_ELEMENT Then
        MsgBox eval_prop.nodeName & " : " & eval_prop.childNodes.length
      End If
    Next eval_prop
  End If
Next eval_set 
```

使用`childNodes`时必须检查`nodeType`属性。评论、文本节点等都将在子节点列表中，而不仅仅是元素节点。

考虑使用 XPath 选择元素可能是一个好主意。使用 DOM 方法执行此操作容易出错且很麻烦。继续阅读[`IXMLDOMNode::selectNodes`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms754523%28v=vs.85%29.aspx)和[`IXMLDOMNode::selectSingleNode`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms757846%28v=vs.85%29.aspx)。

```
For Each eval_set In oDoc.selectNodes("/egh_eval/eval_set")
  Set eval_id = eval_set.selectSingleNode("eval_id")

  ' always check for empty search result!
  If Not eval_id Is Nothing Then
    MsgBox eval_id.text
    ' ...
  End If
Next eval_set 
```

* * *

另外，一般来说。这：

```
fSuccess = oDoc.Load(Application.CurrentProject.Path & "\file.xml") 
```

实际上既没有必要也不是一个坏主意，因为您似乎从未检查过`fSuccess`) 的值。更好的：

```
Sub LoadAndProcessXml(path As String)
  Dim oDoc As MSXML2.DOMDocument

  If oDoc.Load(path) Then
    ProcessXmlFile oDoc
  Else
    ' error handling
  End If
End Sub

Sub ProcessXml(doc As MSXML2.DOMDocument) 
  ' Process the contents like shown above
End Sub 
```

创建多个子/函数有几个优点

*   使错误处理更容易，因为每个函数只有一个目的。
*   您将需要更少的变量，因为您可以在函数参数中定义一些变量
*   代码将变得更易于维护，因为 3 个短函数的作用比一个长函数的作用更明显。

# ios - 使用手势识别器通过情节提要创建滚动视图

> ID：11506652
> 
> 赞同：-2
> 
> 时间：2012-07-16T14:40:29.757
> 
> 标签：ios, interface-builder, scrollview, uistoryboard

我想为我的视图控制器制作一个垂直滚动视图，我真的更愿意通过故事板而不是代码来创建它。

我该怎么办？

我看到在对象库中有一个可拖动的滚动视图和可拖动的点击手势识别器。由于我只想要垂直滚动，我应该使用滑动手势识别器还是平移手势识别器？

我应该用滚动视图切换我放在情节提要中的一般视图吗？

然后为我的滚动视图在我的代码中创建一个弱出口？谁能给我一个大致的想法，我需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:14:40.767

您要求的内容无法通过界面生成器完成。

这是一个常见的误解（老实说，我最初也有）认为故事板是其中一部分的界面构建器不仅仅是一个界面布局工具。

它不像 CS5 的 Flash 界面生成器或 iMovie 的画布，它允许您执行视觉操作。

它的唯一目的是让开发人员能够直观地看到他们创建的视图和元素。它确实允许执行一定程度的显示相关逻辑（即视图的定位、出口属性和操作方法的定义），但您不能使用它来定义任何业务逻辑。

您仍然需要为此编写一些代码。

我建议[在这里阅读有关界面构建器的信息](http://developer.apple.com/library/mac/#documentation/IDEs/Conceptual/Xcode4TransitionGuide/InterfaceBuilder/InterfaceBuilder.html#//apple_ref/doc/uid/TP40009984-CH6)

# algorithm - 使用预定义数量的正方形平铺不规则形状的公式

> ID：11506654
> 
> 赞同：2
> 
> 时间：2012-07-16T14:40:33.620
> 
> 标签：algorithm, apache-flex, math, shape

我有一个定义为向量的形状。然后我会得到一个数字，它代表我需要在我的形状上平铺多少个相同大小的正方形，在一系列行中。行内每个正方形的 X 坐标**不需要**与其他行的 X 坐标对齐。我需要确定正方形所需的大小，以及它们在形状（X 和 Y）上的位置，以便完全覆盖形状的内部，并且在周边上，每个正方形的大部分面积都在形状内.

有谁知道我可以用来计算这个的任何公式？或者我会通过解决这个问题来获得自己的博士学位吗？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:01:37.597

迭代过程的可能解决方案：

初步说明：-我正在标记稍后使用符号 <...> 使用的变量名称，如果它是一个数组，我会在方括号中记下变量的维度。- 在圆括号中，您可以找到通常以“i”作为迭代计数器的迭代段落。

给定：

I1) 二维直边图形的顶点数组 [2,n]：(1:i:2, 1:j:n)，因此是一个大小为 2 x n 的整数数组。

I2) 覆盖图形的最大网格元素数： ，所以是一个标量值

I3) 作为顶点定位参考的 2D OCS（正交坐标系）：默认情况下，所有顶点将通过它们自己的值提供 OCS。将其称为前参考，但它并不是真正的变量。

输出：

O1) 提供了最多覆盖给定形状的方形网格的边长： ，所以是一个标量。

O2) 生成的行数： ，另一个标量

O3）每串（一行）方格的X值数组，表示第一个方格网格元素的左下角：用1:i:R，其中R是前面提到的输出，所以生成的行数由算法。

O4）包含每行网格元素数量的整数数组：1：i：R

辅助功能：

//计算覆盖因子

ACF：（平均覆盖因子），计算整个原始形状的面积与生成的所有正方形数组的总和之间的比率（给定正方形的左下角列表加上边长）。

SCF：（单个元素覆盖因子）：计算每个单个正方形区域被（重叠）形状覆盖的百分比。这很棘手，但可以通过以有限元网格划分样式进行三角剖分来计算（您可以在线找到网格划分三角形元素技术）。

算法：

1）定义最小边界框（包含整个形状的第一个正方形）

1.1）定义原始OCS中的最低Y形点：所以一个标量表示OCS0和OCS1之间的垂直偏移。

1.2）在原始OCS中定义最左边的形状点（顶点之一）：

1.3) 用刚性线性变换 T:T(x,y) -> (x-dx, y-dy) 移动形状；现在边界框在新坐标系的原点左下角（这是将 OCS0 映射到 OCS1 的原因）

1.4）在OCS1中移动整个图形；

1.6）在步骤0计算平均覆盖因子；

注意：这已经是一个解决方案，不是最好的，而是一个数学上可接受的解决方案。

1.7）检查有多少元素（在这个阶段只有一个）完全包含在形状中，调用它（在第一步中这是零），有多少元素被形状边界完全排除（在第一步中这是零），以及有多少部分重叠（在第一步中，这是 1）。请注意，在迭代过程中，这三个数组的长度之和必须等于边界正方形的细化生成的正方形数。

1.8) 从网格中删除所有属于 NFULLOUT(0) 的正方形。在第 0 步，该例程不提供任何结果，因为解决方案数组中只有一个部分覆盖的元素。

2）循环细化

2.1）通过RF = M /（QTY（1：R）的总和）计算细化因子

注意：第 2.1 点考虑面积计算中权重为 1 的所有全覆盖元素以及部分元素，更精确的方法是在每个单个部分覆盖正方形上使用 SCF 函数来计算要用于的元素的有效权重网格面积计算。

2.2) 通过L(1) = L(0)/RF计算新的正方形边长；

2.3）如果（方格数低于允许的方格数），通过用新边重新生成方格矩阵来细化网格。

2.3.1）检查有多少元素（在此阶段只有一个）完全包含在形状中（在第一步中为零），有多少元素被形状边界完全排除（在第一步中为零） )，以及有多少部分重叠（在第一步中，这是 1），其中“i”表示迭代的步骤以进行细化。

2.3.2) 从网格中删除所有属于 NFULLOUT(i) 的正方形。在第 0 步，此例程不提供任何结果，因为解决方案数组中只有一个部分元素。

2.3.4）通过RF = M /（QTY（1：R）的总和）计算细化因子

2.3.5) 通过L(1) = L(0)/RF计算新的正方形边长；

2.3.6) if L(i) > 0 then re-loop from 2) else break。

3）休息后，分而治之以求改进

3.1）对于网格的每一行，尝试左右移动大约一半边长的整行，计算效率并决定哪个更好。然后你将尝试和验证的那条线移动得更好，再次选择左右边长为 1/4 的长度，依此类推，直到你得到比上一步更低的效率。

注意：只有当您使用 O 和 1 之间的权重对每个单独的部分元素进行加权时，才应用最后一个 divide et impera 部分。如果您将部分覆盖元素视为完全覆盖元素，这不会为您提供任何改进。

最后注：考虑您可以对 RF 应用比例因子，例如在第一次通过时，比例因子会给您 RF = M，可能会立即使您摆脱约束。每当您获得 RF > 2 时，如果您通常的元素数量在 100-1000 个或更多元素的范围内，则可以对 RF 应用 0.8 因子。

最后注2：如果您可以消除正方形应具有所有相同长度的约束，那么它会变得容易得多，而且最重要的是，当您只接近边界时，它会变得更快。

抱歉，如果这不是一个真正的公式，但我认为它是让您远离可以从计算分析中获取的复杂网格划分算法的最快元素之一。我也为不常见的符号道歉。我尽力解释自己，我不习惯标准符号。

# ios - 使用 NSUserDefaults 杀死应用程序后保存的数据丢失

> ID：11506658
> 
> 赞同：6
> 
> 时间：2012-07-16T14:40:42.417
> 
> 标签：ios, nsuserdefaults

我在我的设置中使用 NSUserDefaults。应用程序运行良好，即使我按主页键让应用程序进入后台，但如果我终止应用程序，保存在 NSUserDefaults 中的数据将丢失。这是我的代码。我有使用同步。第一次初始化：

```
 if (![userDefaults integerForKey:
          kORFootageAirPlayModeKey])
    {
        [userDefaults setInteger:TRUE forKey:kORFootageAirPlayModeKey];
    }
    [userDefaults synchronize]; 
```

在 viewController 中读取值：

```
airPlayMode = [[NSUserDefaults standardUserDefaults]integerForKey:kORFootageAirPlayModeKey]; 
```

将其设置在一个动作中：

```
- (IBAction)changeAirPlayStatus:(id)sender
{

    if (sender)
    {
        airPlayMode = [sender tag];

        [[NSUserDefaults standardUserDefaults] setInteger:airPlayMode forKey:kORFootageAirPlayModeKey];
        [[NSUserDefaults standardUserDefaults] synchronize];
    }
..... 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:54:45.353

确保保存数据的最佳方法是在应用程序委托中包含对`-synchronize`in`applicationWillTerminate:`和 in的调用。`applicationWillResignActive:`

编辑：

此外，steipete 关于使用 setInteger:TRUE 的评论是准确的 - 使用 setBool:YES 代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:44:20.547

我看不出有什么理由。

您是否检查了 Simulator 目录，在 Library/Caches 下有保存 NSUserDefaults 的 plist。检查是否写入正确。

请不要使用 setInteger:TRUE。这在很多层面上都是错误的。请改用 setBOOL:YES。或 setInteger:1。

# perl - Perl 删除第一次出现

> ID：11506660
> 
> 赞同：2
> 
> 时间：2012-07-16T14:40:53.713
> 
> 标签：perl, replace

好的，所以我想删除文件中第一次出现的字符串，比如“dog”，并且只删除第一次出现。因此，如果文件读取：

> 狗很高兴。
> 狗喜欢跑。

输出将是

> 很高兴。
> 狗喜欢跑。

我有以下代码：

```
#!/usr/local/bin/perl

use warnings;
use strict;

my $file = $ARGV[0];
my $out = $ARGV[1];

open (IN, "<$file");
open (OUT, ">$out");
while(<IN>){
  s/dog/ /;
  print OUT $_;
}

close IN;
close OUT; 
```

它可以工作，但不是只替换第一个实例，而是替换该单词的所有实例。我以为我必须使用全局修饰符 g 来使其替换所有实例？为什么它要替换我正在搜索的字符串的所有实例？这可能是我没有看到的一些简单错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:44:00.873

每次评估运算符时，它都会替换第一个实例，并为每一行评估运算符，因此您替换每行中的第一个实例。如果您使用`/g`，您将替换每一行中的所有实例。

```
my $seen;
while (<>) {
   ++$seen if !$seen && s/dog//;
   print;
} 
```

或作为单行：

```
perl -pe'++$seen if !$seen && s/dog//;' infile >outfile 
```

* * *

您可以重新添加文件句柄，但上面接受更标准和更灵活的用法。要获得与您的代码相同的效果，您只需使用

```
script.pl infile >outfile 
```

代替

```
script.pl infile outfile 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T15:16:12.450

这可以通过单线来实现：

```
perl -0777 -pe 's/dog/ /' inputfile > outputfile 
```

该`-0777`开关会将文件作为单行读取，这将使您的替换按预期工作。这一行就相当于程序文件：

```
$/ = undef; 
$\ = undef;
while (<>) {
    s/dog/ /;
    print;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T15:36:42.397

```
while ( <> ) { 
    my $found = s/dog//;
    print;
    last if $found;
}
print while <>; 
```

# bash - 如何删除sed中以相同字符开头的两行？

> ID：11506662
> 
> 赞同：0
> 
> 时间：2012-07-16T14:40:58.707
> 
> 标签：bash, shell, sed, awk

我有一个文本文件。如果有多个以@开头的连续行，我想删除所有这些行，除了最后一次出现@的行。

例如，假设我有输入文件：

> 美国广播公司
> 
> @abc
> 
> @def
> 
> 333
> 
> @asd
> 
> @poi
> 
> @789

输出应该是：

> 美国广播公司
> 
> @def
> 
> 333
> 
> @789

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:55:10.737

您可以将 tr 与 sed 一起使用：

```
cat input_file | tr '\n' ' ' | sed s/<pattern>// 
```

tr 用空格替换换行符，使正则表达式更容易。

这种模式似乎有效：

```
cat file.txt | tr '\n' ' ' | sed -e "s/\(@\w*\s\)*\(@\w*\s\)/\2/g" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:25:28.153

多线`sed`解决方案：

```
sed -n '
  $p         # Always print last line
  N          # Append next line to pattern space
  /@.*\n@/D  # Delete first line of pattern space if both
             # lines start with an @, and start over
  P          # Otherwise print first line of pattern space,
  D          # delete it and start over
  ' infile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:57:42.777

我看到了 awk 标签。所以我添加了一个 awk one-liner，它可以解决你的问题：（见下面的测试）

```
kent$  cat a.txt
abc
@abc
@def
333
@asd
@poi
@789

kent$  awk 'BEGIN{FS=""}
        {if(c==$1){l=$0;next;} if(c) print l;c=$1;l=$0;} 
        END{print }' a.txt 
abc
@def
333
@789 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T14:55:28.320

[http://ideone.com/Ng7p2](http://ideone.com/Ng7p2)

```
/^@/ { last_line=$0; line_to_print=true }
/^[^@]/ { if ( line_to_print == true ) print last_line; print $0; line_to_print=false }
END { if ( line_to_print == true ) print last_line } 
```

# amazon-ec2 - 如何查看哪些 EC2 实例与我的 Elastic Beanstalk 应用程序相关联？

> ID：11506668
> 
> 赞同：8
> 
> 时间：2012-07-16T14:41:24.420
> 
> 标签：amazon-ec2, amazon-web-services, amazon-elastic-beanstalk

如何查看哪些 EC2 实例与我的 Elastic Beanstalk 应用程序相关联？我可以看到我的所有实例都在 EC2 中运行，但不知道哪些实例与哪个 Beanstalk 应用程序/环境一起使用。Beanstalk 控制台似乎也不提供此信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:43:21.593

这记录在[列出和连接到服务器实例中](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/using-features.ec2connect.html)：

> 您可以通过 AWS 管理控制台查看运行 AWS Elastic Beanstalk 应用程序环境的 Amazon EC2 实例列表。

嗯，是的，但它确实不是很明显，应该更容易;) - 简而言之，您需要探索与您各自的[AWS Elastic Beanstalk环境关联的](http://aws.amazon.com/elasticbeanstalk/)[弹性负载均衡器](http://aws.amazon.com/elasticloadbalancing/)，链接文章中的屏幕截图正确说明了这一点至少。

# mysql - 本书重点介绍 SQL Server 存储过程

> ID：11506678
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:42:13.343
> 
> 标签：mysql, sql-server, stored-procedures

你能推荐一本 Microsoft SQL Server 相当于[MySQL 存储过程编程](http://shop.oreilly.com/product/9780596100896.do)的书吗？我正在寻找一些专注于存储过程、存储函数和触发器的书。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T14:55:18.210

SQL Server 存储过程、XML 和 HTML 大师指南

[http://www.amazon.com/Gurus-Guide-Server-Stored-Procedures/dp/0201700468](https://rads.stackoverflow.com/amzn/click/com/0201700468)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:50:56.370

为什么不是这本书 ->[高性能 MySQL](http://www.play.com/Books/Books/4-/5113473/High-Performance-MySQL/Product.html?searchstring=MYSQL&searchsource=0&searchtype=allproducts&urlrefer=search)？

# unit-testing - 我想针对多个不同的数据库运行 teambuild 的单元测试（不止一次）

> ID：11506681
> 
> 赞同：1
> 
> 时间：2012-07-16T14:42:24.653
> 
> 标签：unit-testing, tfsbuild

我想针对不同的数据库运行 teambuild 的单元测试（不止一次），例如我想测试我的构建编译，然后针对 SQLServer、Oracle 等数据库运行相同的测试套件。

我很确定我可以做一些笨拙的事情，比如针对第一个配置文件构建/测试然后针对第二个配置文件构建/测试等，但我正在寻找更优雅的东西（最好没有毫无意义的第二次重新编译）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:17:07.187

您需要为每种数据库类型进行单独的单元测试（这些被认为是系统测试，实际上 - 因为它们涉及数据库）。如果相同的单元测试可能在 1 个 DB 平台上失败并在另一个平台上通过，那么当您查看通过/失败状态以及该测试随时间推移的测试结果历史记录时，它并不能告诉您任何足够具体的信息。

否则，请考虑以这样一种方式解耦或抽象数据库连接，以便您可以在设置测试时以编程方式更改它（请参阅 MSTEST[单元测试框架](http://msdn.microsoft.com/en-us/library/ms182517.aspx)中的 [ClassInitialize()] 和 [TestInitialize()] 属性）。

优雅的解决方案是不依赖数据库进行单元测试；为检查您正在调用的查询和过程返回的数据的数据库创建单独的测试。

Visual Studio 2010 Premium[能够运行单元测试来验证 SQL Server 2005（及更高版本）数据库的数据和行为](http://msdn.microsoft.com/en-us/library/dd172118.aspx)。如果您还找不到测试 Oracle Dbs 的工具或推出自己的测试返回内容的系统，我会感到惊讶（类似[ndbUnit](http://code.google.com/p/ndbunit/)的东西可能会有所帮助）

# javascript - 使用 Javascript 在新窗口中弹出图像

> ID：11506682
> 
> 赞同：3
> 
> 时间：2012-07-16T14:42:25.123
> 
> 标签：javascript, jquery, image, popup

我有一个网页，其中单击了一个元素，并使用 JQuery 发布功能从服务器获取了图像，并且应该显示在调整为图像大小的新窗口中。相关的 Javascript 函数如下（其中 myImage 是返回的 base 64 格式的图像）。

```
function showPicture(label) {
        var newWindow = window.open("", label,"scrollbars=0, toolbar=0");
        $.post( 'picture-view', { labelname: label },
        function(myImage) {
            newWindow.document.write("<img src='data:image/png;base64," + myImage + "'/>");
            newWindow.resizeTo(newWindow.document.getElementsByTagName("img")[0].width,     newWindow.document.getElementsByTagName("img")[0].height+newWindow.outerHeight-newWindow.innerHeight);
            newWindow.focus(); 

        }
    );          
} 
```

有三件事给我带来了问题。

1.  图像被插入到带有白色边框的新窗口中，我无法弄清楚如何删除。

2.  在调整窗口大小时，该术语`newWindow.outerHeight-newWindow.innerHeight`应该考虑工具栏等，但两者都输出为零。

3.  最后一个真的让我很烦。如果我将该行`var newWindow = window.open("", label,"scrollbars=0, toolbar=0");`放在从第四行开始的回调函数中，则新窗口创建得太小，并且不会被 resizeTo 函数调整大小。

任何进一步阅读的建议或指导都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:41:03.720

你正在使用 jQuery，所以你可以简化很多，但是因为你已经在使用普通的 JS 了，所以我继续使用它。

您应该等到图像加载完毕后再打开新窗口，这样您就可以将大小设置为与图像相同，如下所示：

```
function showPicture(label) {
    $.post( 'picture-view', { labelname: label }, function(ImageSrc) {
       var myImage = new Image;
           myImage.src = "data:image/png;base64," + ImageSrc;
           myImage.style.border = 'none';
           myImage.style.outline = 'none';
           myImage.style.position = 'fixed';
           myImage.style.left = '0';
           myImage.style.top = '0';
           myImage.onload = function() {        
               var newWindow = window.open("", label,"scrollbars=0, toolbar=0, width="+myImage.width+", height="+myImage.height);
                   newWindow.document.write(myImage.outerHTML);
          }​
    });
} 
```

这是一个[FIDDLE](http://jsfiddle.net/GEfsW/)，展示了它是如何完成的，base64 刚刚添加到文件中，因为我没有时间创建某种假 Ajax 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:20:07.047

您可以通过这种方式在新窗口中引用图像：

```
var img = $("img",newWindow.document)[0]; // Get my img elem 
```

适应您的代码：

```
function showPicture(label) {
    var newWindow = window.open("", label,"scrollbars=0, toolbar=0");
    $.post( 'picture-view', { labelname: label },
    function(myImage) {
        newWindow.document.write("<body marginheight='0' marginwidth='0'><img src='data:image/png;base64," + myImage + "'/></body>");
        var img = $("img",newWindow.document)[0];
        newWindow.resizeTo($(img).width(), $(img).height());
        alert($(img).width()+","+$(img).height()); //Just to check values
        newWindow.focus(); 
    });          
} 
```

我猜白色边框是由于body margins，所以我添加了

```
<body marginheight='0' marginwidth='0'> 
```

在

newWindow.document.write

删除它们。

我在 Firefox 中对其进行了测试，它可以工作，但有时它会打开一个较小的窗口，可能是因为调整大小是在整个图像加载之前完成的。在这种情况下，您可以添加一个 window.setTimeout 来避免该问题。

# entity-framework - 实体框架和继承 - EF 中可能存在的错误？

> ID：11506683
> 
> 赞同：0
> 
> 时间：2012-07-16T14:42:34.290
> 
> 标签：entity-framework, odac

我一直在尝试开始使用实体框架并遇到了一种特殊的行为。我准备了这个简短的例子来演示。

简而言之，我正在尝试使用基本类型和继承类型“Person”和“Employee”来创建每个类型的表模型。问题是，当我使用诸如

```
var list = entities.PersonSet.OfType<Person>().ToList(); 
```

我希望得到一个人员对象列表。尽管列表是 List 类型，但列表中的所有对象都是**Employee**对象，即使表中只有一条记录是针对员工的。看起来 EF 返回了错误的类型。

但是，添加另一个从 Person 继承的类型，例如“Superhero”（我试图将其作为一个明显的示例 :)，并创建一个 Superhero 记录，现在相同的命令会按预期返回 Persons、Employees 和 Superheroes 的混合（以前我只有员工，即使他们不是员工）

**细节**

我正在使用 VS2010 和 Oracle 数据库，以及 ODAC 11.2.0.3 ！我需要一些帮助来确认这是否是与 Oracle 相关的问题，或者这是否也发生在 MSSQL 数据库和 DDL 生成中。

我创建了一个新的控制台应用程序，然后转到 Add->New file->ADO.NET Entity Data Model。然后我制定了这个模型

![英孚模型](../Images/35b9902d56f64c6654142713864536da.png)

我的代码如下所示：

```
class Program
{
    static void Main(string[] args)
    {
        var e = new Entities();

        var result1 = e.PersonSet.OfType<Superhero>().ToList();
        var result2 = e.PersonSet.OfType<Employee>().ToList();
        var result3 = e.PersonSet.OfType<Person>().ToList();
    }
} 
```

结果：

![结果 1](../Images/101aaef94f392332faffeefa072c8ed3.png)

一切都很好。

现在，如果我删除 Employee 实体并注释掉“var result2 ...”行，我会得到以下结果：

![结果 2](../Images/b4fe28b192f6e719b840dc600c5b6b45.png)

我没有对数据库中的数据进行任何更改。请注意所有实体现在如何拥有一种超级英雄！值得注意的是，我必须将“Superpower”属性设置为 Nullable=True，否则会出现异常，因为实际上只有一条记录是超级英雄（其他记录在 PersonSet_Superhero 表中没有任何整数）

**那么，这是实体框架、ODAC 或其他任何东西中的错误，还是我在这里做错了什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:47:52.547

如果您使用 Oracle Express 作为数据库，这似乎是个问题。看看[这个线程。](https://forums.oracle.com/forums/thread.jspa?messageID=10682944&#10682944)我经历了同样的事情，罪魁祸首原来是 Oracle XE，但这适用于 Oracle 11g 企业版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-18T21:22:14.570

我发现如果我将基本类型抽象化，它可以在 EF 5 w/Oracle 11g xe 中工作。

# javascript - 谷歌浏览器扩展 Http 请求

> ID：11506687
> 
> 赞同：3
> 
> 时间：2012-07-16T14:42:48.750
> 
> 标签：javascript, google-chrome, google-chrome-extension

我想知道 Google Chrome 扩展程序是否可以发出 HTTP 请求并解析结果的正文（如 Curl）。例如，有一台服务器 1.2.3.4`?a=1&b=2`通过汇总 URL 参数来回答问题。该查询`"http://1.2.3.4?a=1&b=2"`将返回一个包含 的正文`3`，我的扩展想要提交这样的查询并解析结果。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T14:45:46.057

是的，使用[跨域 XMLHttpRequest](http://code.google.com/chrome/extensions/xhr.html)。

1.  设置[权限](https://stackoverflow.com/a/31799066)_`manifest.json`

2.  然后在您的扩展页面中像这样使用它：

    ```
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "http://api.example.com/data.json", true);
    xhr.onreadystatechange = function() {
      if (xhr.readyState == 4) {
        // WARNING! Might be injecting a malicious script!
        document.getElementById("resp").innerHTML = xhr.responseText;
        ...
      }
    }
    xhr.send(); 
    ```

笔记：

*   内容脚本无法在现代 Chrome 中发出跨域请求，[更多信息](https://stackoverflow.com/a/55292071)。
*   ManifestV3 后台脚本没有 XMLHttpRequest，因此您将在此处使用[fetch](https://developer.mozilla.org/en-US/docs/Web/API/fetch)。

# tomcat - Tomcat 上的 Axis2

> ID：11506688
> 
> 赞同：1
> 
> 时间：2012-07-16T14:42:48.960
> 
> 标签：tomcat, service, axis2

我最近开始在本地 Tomcat 服务器上使用 Axis2 进行一些工作。一切都很顺利，我在周末让我的电脑休眠了。今天早上开始工作时，我在尝试检查我的服务时遇到了内部服务器错误。执行验证检查时，我收到以下错误：

检查版本服务

Axis2 版本服务出现问题，可能是服务不可用或出现问题。但这并不意味着系统不工作！尝试上传其他一些服务并检查它是否正常工作。

任何想法如何解决这个问题？重新启动我的电脑没有帮助，我以前没有遇到过这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T01:01:46.660

当tomcat停止时，请从tomact的webapp文件夹中删除**axis2.war和axis2目录。**然后启动tomcat，看到axis2删除成功。之后将axis2.war再次放入webapp目录。它会起作用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T14:44:09.923

似乎重新安装Tomcat就可以了。

对于其他有同样问题的人：

1.  从控制面板中的添加/删除程序卸载 Tomcat
2.  删除 Tomcat/Apache 文件夹
3.  重新安装 Tomcat
4.  将axis2.war 文件放回Tomcat

为我工作。

# php - PHP Mailer Class 问题：邮件正文为空

> ID：11506691
> 
> 赞同：3
> 
> 时间：2012-07-16T14:43:02.403
> 
> 标签：php

当我尝试使用 PHPMailer 类发送电子邮件时，我收到此错误：Mailer Error: Message body empty：

```
<?php

    include("class.phpmailer.php");

    $mail = new PHPMailer();
    $mail->IsSMTP();

    $mail->SMTPAuth   = true;

    $mail->SMTPSecure = "ssl";
    $mail->Host       = "rsb20.rhostbh.com";
    $mail->Port       = 465;
    $mail->Username   = "jobserreker+furrtexlab.com";
    $mail->Password   = "12345678a";

    $mail->From       = "jobserreker@furrtexlab.com";
    $mail->FromName   = "Job Seeker";
    $mail->Subject    = $_GET['subject'];
    $mail->MsgHTML($_GET['msg']);

    $mail->AddAddress($_GET['to'],"name to");
    $mail->IsHTML(false);

    if(!$mail->Send())
    {
      echo "Mailer Error: " . $mail->ErrorInfo;

    }else{

        echo "Message sent!";
    }
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T15:15:56.773

正如 Gerald Versluis 所说，由于您将 IsHTML() 设置为 false，因此您必须使用 ->Body 属性来设置邮件的实际正文。

```
$mail->Body = $_GET['msg']; 
```

您还应该使用 POST 而不是 GET 来提交导致执行操作的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T18:08:28.110

这篇文章过去曾在这里提到过。[Phpmailer 发送附件，但不发送正文](https://stackoverflow.com/questions/6736899/phpmailer-sending-attachments-but-not-the-body)

他们发现无法发送正文和附件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-01T16:27:03.707

我有这两行代码，但没有任何 contents.html 文件，我必须创建一个以避免错误。

```
//Read an HTML message body from an external file, convert referenced imagesto embedded,
//convert HTML into a basic plain-text alternative body
$mail->msgHTML(file_get_contents('contents.html'), dirname(__FILE__));

//Replace the plain text body with one created manually
$mail->AltBody = 'This is a plain-text message body';` 
```

# css-float - 如何通过 css 浮点数排列 div？

> ID：11506694
> 
> 赞同：0
> 
> 时间：2012-07-16T14:43:24.020
> 
> 标签：css-float

我有六个 div，想将它们排列成两行三列

```
#topLeft {float:left;} //ok
#topMiddle {float:left;} //ok
#topRight {float:right;} //ok
#bottomLeft {}
#bottomMiddle {}
#bottomRight {} 
```

在第二行中，我尝试了许多与浮动和清除的组合 - 没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:47:31.600

添加`clear: left; float: left;`到`#bottomLeft`最后`float: left;`两个。

这是一个小提琴：http: [//jsfiddle.net/5nGUe/2/](http://jsfiddle.net/5nGUe/2/)

# excel - 来自不同工作表的单元格的条件副本

> ID：11506696
> 
> 赞同：0
> 
> 时间：2012-07-16T14:43:25.247
> 
> 标签：excel, vba, search

我想从工作表中取一个名字（比如在名为“Names”的工作表中的 A2）并在另一个工作表中搜索相同的名字（比如“Jobs”中的 A2）。在另一个工作表中找到该名称后，我想从它旁边的单元格中复制值（仍在“工作”但 B2 中）并将其返回到第一个工作表中的不同单元格（E2）（“名称”） . 我最终想遍历“名称”的 A1 中的所有值并填写整张表。

我已经做到了这一点：

```
Sub fixThis()
    Dim i As Long, j As Long, col1 As Long, col2 As Long, lastrow1 As Long, lastrow2 As Long
    Dim sheetOne As String
    Dim sheetTwo As String

    col1 = 5
    col2 = 1
    sheetOne = "Names"
    sheetTwo = "Job"
    lastrow1 = Cells(Rows.Count, col1).End(xlUp).Row
    lastrow2 = Cells(Rows.Count, col2).End(xlUp).Row

    For i = 2 To lastrow1
        For j = 2 To lastrow2

           If sheetOne.Cells(i, col1).Value = sheetTwo.Cells(j, col2).Value Then

                sheetOne.Cells(i, 6).Value = sheetTwo.Cells(j, 2).Value

           End If
        Next
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:02:12.710

可以将工作表名称存储为字符串。但是当你使用它们时，你需要像这样使用它们来引用工作表对象：`Sheets("Sheetname").Cells().Value` 或者你可以使用这样的变量：

```
Dim strSheet1name as String
strSheet1name = "Sheet1"

Sheets(strSheet1name).Cells().Value 
```

最后，如果您真的想要，可以声明自己的工作表对象，例如

```
Dim ws as worksheets
ws = Sheets("Sheet1")

ws.Cells.value 
```

要保持上述所有代码相同，您需要尝试替换

```
 If sheetOne.Cells(i, col1).Value = sheetTwo.Cells(j, col2).Value Then

            sheetOne.Cells(i, 6).Value = sheetTwo.Cells(j, 2).Value

       End If 
```

和

```
 If Sheets(sheetOne).Cells(i, col1).Value = Sheets(sheetTwo).Cells(j, col2).Value Then

            Sheets(sheetOne).Cells(i, 6).Value = Sheets(sheetTwo).Cells(j, 2).Value

       End If 
```

最后，如果您正在处理多张工作表，则需要在这些行中添加更多细节：

```
lastrow1 = Cells(Rows.Count, col1).End(xlUp).Row
lastrow2 = Cells(Rows.Count, col2).End(xlUp).Row 
```

并将它们更改为：

```
lastrow1 = Sheets(SheetOne).Cells(Sheets(SheetOne).Rows.Count, col1).End(xlUp).Row
lastrow2 = Sheets(SheetTwo).Cells(Sheets(SheetTwo).Rows.Count, col2).End(xlUp).Row 
```

最终版本看起来像这样：

```
Sub fixThis()
    Dim i As Long, j As Long, col1 As Long, col2 As Long, lastrow1 As Long, lastrow2 As Long
    Dim sheetOne As String
    Dim sheetTwo As String

    col1 = 5
    col2 = 1
    sheetOne = "Names"
    sheetTwo = "Job"
    lastrow1 = Sheets(sheetOne).Cells(Sheets(sheetOne).Rows.Count, col1).End(xlUp).Row
    lastrow2 = Sheets(sheetTwo).Cells(Sheets(sheetTwo).Rows.Count, col2).End(xlUp).Row

    For i = 2 To lastrow1
        For j = 2 To lastrow2
            If Sheets(sheetOne).Cells(i, col1).Value = Sheets(sheetTwo).Cells(j, col2).Value Then
                Sheets(sheetOne).Cells(i, 6).Value = Sheets(sheetTwo).Cells(j, 2).Value
            End If
        Next j
    Next i
End Sub 
```

# visual-studio - 使用 jom 为 MSVS 2010 构建带有调试信息的 QT

> ID：11506700
> 
> 赞同：1
> 
> 时间：2012-07-16T14:43:41.080
> 
> 标签：visual-studio, qt, build, visual-studio-debugging

我正在尝试在开源应用程序中使用 QT 库。我已经下载了 QT 的源文件，然后尝试使用 jom 构建它。首先在

```
C:\QT\4.8.2 
```

我跑了这个：

```
configure -debug-and-release -opensource -platform win32-msvc2010 
```

然后我运行了这个命令：

```
..\jom\jom.exe -j 2 
```

作为参考，我遵循了以下建议的步骤：

[http://www.holoborodko.com/pavel/2011/02/01/how-to-compile-qt-4-7-with-visual-studio-2010](http://www.holoborodko.com/pavel/2011/02/01/how-to-compile-qt-4-7-with-visual-studio-2010)

现在，当我尝试在 MSVS2010 中调试我的项目时，我收到此错误（在调试模式下）：

```
qtmain.lib(qtmain_win.obj) : error LNK2038: mismatch detected for '_ITERATOR_DEBUG_LEVEL': value '0' doesn't match value '2' in audiomixerboard.obj 
```

看起来 QT 不是使用调试信息构建的。有谁知道出了什么问题，我该怎么办？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:10:59.840

您的 APP 似乎是在发布模式下构建的。因为 qtmain.lib 用于发布，而 qtmaind.lib 用于调试。调试库以 'd' 结尾。

# ios - iOS 一键按住并拖动

> ID：11506702
> 
> 赞同：0
> 
> 时间：2012-07-16T14:43:45.700
> 
> 标签：ios

我有一个`tableView`，我希望当我长按一个单元格时，它会在顶层视图中添加一个子视图，我可以在屏幕上拖动那个新的子视图。

现在我已经添加了一个`UILongPressGestureRecognizer`，`tableView`并且在长按句柄中我添加了我想要的子视图。但我不能移动它。我在子视图类中添加了 -`(void) touchesMoved:(NSSet *) touches withEvent:(UIEvent *)`事件。它起作用了，但我必须用 2 次点击来完成，一次是在长按处理程序中添加新的子视图，另一次是在子视图类中调用 touchesMoved。

知道如何在一次按住和拖动中做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:32:59.193

在我进行任何挖掘之前，我已经考虑了你的问题，似乎做你想做的更好的方法是将代码移动`-touchesMoved:withEvent:`到你的 UITableViewCell 类中。这样，单元格仍在处理触摸，您不必在添加子视图后重新处理触摸的处理方式。所以：

在您的自定义 UITableViewCell 子类的实现文件中：

```
- (void)touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event {
    UITouch* touch = [touches anyObject];
    CGPoint location = [touch locationInView:self];
    [yourSubview setCenter:location];
} 
```

这应该够了吧。

# c++ - hid_device.h 中的错误 C2664

> ID：11506709
> 
> 赞同：0
> 
> 时间：2012-07-16T14:44:01.720
> 
> 标签：c++, visual-studio-2008, stderr, hid, c2664

```
std::string get_path( void ) { return m_devicePath; } 
```

调试输出：

> hid_device.h(37) : error C2664: >'std::basic_string<_Elem,_Traits,_Ax>::basic_string(std::basic_string<_Elem,_Traits,_Ax>::>_Has_debug_it)' : 无法从'unsigned long' 到 >'std::basic_string<_Elem,_Traits,_Ax>::_Has_debug_it' 与 [ _Elem=char, _Traits=std::char_traits, _Ax=std::allocator ] 结构 'std::basic_string 的构造函数<_Elem,_Traits,_Ax>::_Has_debug_it' 用 [ _Elem=char, _Traits=std::char_traits, _Ax=std::allocator ] 声明为“显式”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:46:32.080

*   选项1：

错误包括。您应该在文件顶部有`#include <string>`, not或任何其他变体。`#include <string.h>`

*   选项 2：

`m_devicePath`是一个`unsigned long`（怀疑），不能直接转换为`std::string`.

使用`std::to_string()` **(C++11)**：

```
std::string get_path( void ) { return std::to_string(m_devicePath); } 
```

或 a `stringstream` **(C++03)**将其转换`unsigned long`为 a `std::string`：

```
std::string get_path( void ) { 
     std::stringstream ss;
     ss << m_devicePath;
     return ss.str(); 
} 
```

# collections - 在主干集合上使用下划线方法“查找”

> ID：11506730
> 
> 赞同：11
> 
> 时间：2012-07-16T14:44:50.723
> 
> 标签：collections, backbone.js, find, underscore.js

我正在尝试在集合上使用下划线方法“查找”，但它没有给我预期的结果：

我有一个没有默认值的基本模型和一个默认集合。我收藏的模型只有两个属性：tranId（作为字符串的 guid）和 perform（要执行的函数）。

我正在尝试在集合中找到与我传递的 tranId 匹配的项目...

```
 var tranId = "1a2b3c";

    var found = _.find(myCollection, function(item){
        return item.tranId === tranId;
    }); 
```

Found 始终未定义，即使调试器显示我的集合确实存在，其中确实有一个项目，其中 tranId 与我的变量匹配。我无法在 return 语句中设置断点来查看 item.tranId 等同于什么。这个我也试过。。。

```
 var found = _.find(myCollection, function(item){
        return item.get('tranId') === tranId;
    }); 
```

但是，同样的事情。'found' 总是未定义的。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-16T14:50:20.847

Backbone 集合实现[了许多下划线功能](http://backbonejs.org/#Collection-Underscore-Methods)，因此您可以这样做：

```
var found = myCollection.find(function(item){
        return Number(item.get('tranId')) === tranId;
}); 
```

如果值不是您期望的值，也可以调试：

```
var found = myCollection.find(function(item){
        console.log('Checking values', item, item.get('tranId'), tranId);   
        return Number(item.get('tranId')) === tranId;
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-10-10T09:24:58.383

一个更简单的：

```
var found = myCollection.findWhere({'tranId': tranId}) 
```

有关详细信息，请参见[此处](http://backbonejs.org/#Collection-where)。

如果必须使用下划线方法：

```
var found = _.find(myCollection.models, function(item){
    return item.get('tranId') === tranId;
}); 
```

因为 myCollection.models 是一个数组，所以 myCollection 不是。

我更喜欢前者。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-16T15:06:31.750

在 Backbone（管理模型列表的对象）和 Underscore（对象列表）中，集合的含义并不完全相同。你应该传递给`_.find`的是`myCollection.models`

```
_.find(myCollection.models, function(model) {
    return model.get('tranId')===tranId;
}); 
```

正如@Daniel Aranda 解释的那样，Backbone 代理[在集合上使用下划线方法](http://backbonejs.org/#Collection-Underscore-Methods)，您可以将示例编写为

```
myCollection.find(function(model) {
    return model.get('tranId')===tranId;
}); 
```

最后，如果`tranId`是您的模型 ID，您可以[将 id 设置为 idAttribute](http://backbonejs.org/#Model-idAttribute)并通过使用简化整个事情`get`

```
var M=Backbone.Model.extend({
   idAttribute: "tranId"
});
var C=Backbone.Collection.extend({
    model:M
});

var myCollection=new C([
    {tranId:'not this one'} ,
    {tranId:'another'} ,
    {tranId:'1a2b3c'}
]);

myCollection.get(tranId); 
```

还有一个小提琴[http://jsfiddle.net/rYPLU/](http://jsfiddle.net/rYPLU/)

# android - Android SDK：Xml Pull Parser - 如何获取节点名称

> ID：11506732
> 
> 赞同：0
> 
> 时间：2012-07-16T14:44:55.463
> 
> 标签：android, android-xml, xmlpullparser, android-parser

我正在使用 Xml Pull Parser 从 URL 中解析一些 Xml。我正在毫无问题地检索节点的值，但是我似乎无法获取节点名称 - 它只是返回 null。

例如：

```
<ArtistName>Joe</ArtistName> 
```

我可以检索“Joe”，但无法获取“Joe”来自哪个节点，因此它不是返回“ArtistName”，而是返回 null。

这是我的代码：

```
public static void getAllXML(String url) throws 
       XmlPullParserException, IOException, URISyntaxException{ 

           Log.i("*****PARSER CALLED******","****PARSER CALLED*****");

         XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
         factory.setNamespaceAware(true);

         XmlPullParser parser = factory.newPullParser(); 
         String tagName = parser.getName();
         parser.setInput(new InputStreamReader(getUrlData(url)));  
         XmlUtils.beginDocument(parser,"EventsPricePoints");
         int eventType = parser.getEventType();
         do{
           XmlUtils.nextElement(parser);
           parser.next();
           String nodeName = parser.getName();
           eventType = parser.getEventType();
           if(eventType == XmlPullParser.TEXT){

             Log.i("************PARSER**********",nodeName+"....."+parser.getText());
           }
         } while (eventType != XmlPullParser.END_DOCUMENT) ;       
       } 
```

如您所见，我正在尝试使用

> 解析器.getName()

这是返回null。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T14:57:01.893

查看[文档](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html)

将您的代码更改为

```
do{ 
   XmlUtils.nextElement(parser);
   parser.next();
   String nodeName;
   eventType = parser.getEventType();
   if(eventType == XmlPullParser.TEXT){
     if(nodeName!=null) {
       Log.i("************PARSER**********","Last parsed node name="+nodeName+"....."+parser.getText());
     }
   } else if(eventType == XmlPullParser.START_TAG) {
       nodeName = parser.getName()
   }

 } while (eventType != XmlPullParser.END_DOCUMENT) ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-09T01:48:14.673

从以下位置更改您的 XML：

```
<ArtistName>Joe</ArtistName> 
```

至

```
<ArtistName name="ArtistName">Joe</ArtistName> 
```

其余的应该按照实施的方式工作。

# ruby-on-rails - 当omniauth 注册失败时出现“路由错误没有路由匹配{}”

> ID：11506734
> 
> 赞同：2
> 
> 时间：2012-07-16T14:45:04.107
> 
> 标签：ruby-on-rails, registration, omniauth

我正在使用omniauth-identity 并配置其“注册失败”。

我的文件：

配置/初始化程序/omniauth.rb

```
OmniAuth.config.logger = Rails.logger

Rails.application.config.middleware.use OmniAuth::Builder do
  #...
  provider :identity, on_failed_registration: lambda { |env|
    IdentitiesController.action(:new).call(env)
  }
end 
```

配置/路由.rb

```
Wie::Application.routes.draw do
  root to: 'categories#index'

  ActiveAdmin.routes(self)
  devise_for :admin_users, ActiveAdmin::Devise.config

  match 'auth/:provider/callback', to: 'sessions#create'
  match 'auth/failure', to: 'sessions#failure'
  match 'signout', to: 'sessions#destroy', as: 'signout'
  resources :identities#, only: [:new]
  resources :categories, path: '', only: [:index] do
    resources :entries, path: '', only: [:index, :show]
  end
end 
```

应用程序/控制器/identities_controller.rb

```
class IdentitiesController < ApplicationController
  def new
    ariane.add "New Account"

    @identity = env['omniauth.identity']
  end
end 
```

**当我注册失败（传递不正确的邮件）时，我得到以下信息：**

在浏览器中：

> 路由错误
> 
> 没有路线匹配{} 尝试运行 rake 路线以获取有关可用路线的更多信息。

在服务器日志中：

> 在 2012-07-16 17:35:48 +0300 (0.1ms) 开始 POST "/auth/identity/register" for 127.0.0.1 (0.1ms) begin transaction Identity Exists (0.2ms) SELECT 1 AS one FROM "identities" WHERE "identities "."email" = 'foo' LIMIT 1 (0.1ms) 回滚事务由 IdentitiesController#new 作为 HTML 参数处理：{"utf8"=>"✓", "authenticity_token"=>"HIDDEN :)>=", " name"=>"", "email"=>"foo", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]", "commit"=>"Register"}
> 渲染身份/布局/应用程序中的 new.html.erb（11.2 毫秒）在 44 毫秒内完成 500 内部服务器错误
> 
> ActionController::RoutingError (No route matches {}):
> app/views/layouts/application.html.erb:35:in `_app_views_layouts_application_html_erb___1224394470845933684_70120630781720' config/initializers/omniauth.rb:8:in`call'
> config/initializers/omniauth.rb:8:in `block (2 levels) in '
> 
> 在救援/布局中渲染 /Users/ayia/.rvm/gems/ruby-1.9.3-p125@global/gems/actionpack-3.2.6/lib/action_dispatch/middleware/templates/rescues/routing_error.erb (0.6ms)

**这可能是什么原因？我做错了什么？**

**更新** 我不明白的是 - 为什么我得到`Started POST "/auth/identity/register"`？根据omniauth 配置，我应该得到与IdentitiesController.action(:new) 对应的视图，即/identities/new ...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T10:50:03.163

该问题无法在 1.1.0 版本的 omniauth-identiry 上重现。所以更新到最新版本解决了这个问题。

# c++ - 在 C++ 中使用集合与使用数组

> ID：11506738
> 
> 赞同：3
> 
> 时间：2012-07-16T14:45:10.333
> 
> 标签：c++, arrays, set

我想从一个 seach 函数中保存一组迭代器。**是否有“更好的方法”来保存一组迭代器（数组与集合）。就内存效率而言，每种方法的优缺点是什么？**

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T15:11:48.167

在不了解您要完成的工作的情况下谈论哪个更好的数组或集合是没有意义的。

您应该考虑一个考虑因素：迭代器指向的容器类型，以及该容器是否应该被更新？

例如，如果您将迭代器存储到向量中（无论您将这些迭代器放在哪里），并且您更新了向量，则先前存储的迭代器可能无效。存储迭代器时要非常小心。

听起来您正在缓存结果以提高速度。如果您需要缓存结果，最好使用无序容器之一。对搜索结果使用与缓存相同的键。不要存储迭代器，只存储查询键和实际结果。unordered_set 具有 O(1) 查找时间，并且它们不会占用太多空间，因为它们散列键并存储结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:46:25.043

Set 仅包含唯一对象[http://en.cppreference.com/w/cpp/container/set](http://en.cppreference.com/w/cpp/container/set)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-22T16:12:12.003

在内存方面，两者在空间效率上并没有太大的区别。但是，需要考虑的是，`set`您的条目将被排序，但您`array`将按照您放入的顺序保留它们。您`set`也不允许您存储重复项。根据您的用例，可能会为您提供更好的运行时间或性能。

此外，需要考虑的是您使用的是基本`array`的还是`vector`; 它`vector`是 C++ 的 wrap `array`，使其可重新调整大小，允许插入、删除和处理内存分配以增加`array`. 如果您希望您的数组大小发生变化，这将是一个很好的优化。

# javascript - 如何防止 html/javascript 代码在文本框上运行

> ID：11506739
> 
> 赞同：2
> 
> 时间：2012-07-16T14:45:10.720
> 
> 标签：javascript, html

我有一个用 javascript 编写的聊天应用程序，当用户输入类似的 html 代码时

```
 <button>click</button> 
```

聊天中出现一个按钮。我使用此代码

```
 if(message.indexOf('<button') != -1)
            {   
              message = message.replace(message, '&#45;'); 
            } 
```

但这只是替换了 < 按钮

有一个空格，我希望它显示为文本而不是实际按钮。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:47:54.793

我只是用这个：

```
message = message.replace(/</g,"&lt;"); 
```

这就是防止插入 HTML 所需的全部内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:53:05.910

您在这里的一般编码程序是：

```
value = value.toString().replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/'/g, "&#39;").replace(/"/g, "&#34;"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:51:02.157

你用什么 html 元素来打印聊天？尝试使用 textarea 或 pre 标签。

尝试在后端控制这些错误，因为每个人都可以停用 javascript。

# java - 带有 Android 的 SQLCipher。创建工作正常，选择+插入不要

> ID：11506740
> 
> 赞同：0
> 
> 时间：2012-07-16T14:45:21.683
> 
> 标签：java, android, sqlite, sqlcipher

下午好。

我正在使用以下代码在 Android 应用程序中创建一个加密的数据库文件：

```
String dbPath = context.getDatabasePath(NAME_OF_MY_FILE).getPath();
SQLiteDatabase sampleDB = SQLiteDatabase.openOrCreateDatabase(dbPath, "password", null); 
```

这工作正常并创建了文件，尽管在尝试访问此加密文件时出现多个错误，例如：

没有这样的表 TABLE_NAME 并且文件已加密或不是数据库

我只是使用相同的代码打开文件进行编辑，因为该函数被调用`openOrCreateDatabase()`。我假设打开文件的过程与创建过程相反，并且您传递了原始密码？

请注意我正在使用正确的导入：

```
import net.sqlcipher.database.SQLiteDatabase; 
```

`SQLiteDatabase.loadLibs(this);`并在`onCreate()`方法中初始化。

如果他们有任何想法，有人可以指出我哪里出错了。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T14:49:39.943

您只需要在该呼叫中输入“密码”即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:26:52.033

在您调用 之后`SQLiteDatabase.openOrCreateDatabase`，您是在那里创建数据库模式，还是创建一个子类`net.sqlcipher.datdatabase.SQLiteOpenHelper`来管理数据库迁移？没有它，您的表名将不存在。也许您可以显示更多代码来帮助诊断您遇到的问题。

# c# - 提供“选择”的类

> ID：11506750
> 
> 赞同：0
> 
> 时间：2012-07-16T14:46:03.823
> 
> 标签：c#, selectall

有没有提供基本选择机制的类？例如：

想象一下，我有 WAVE 文件和用 C# 编写的简单 WAV 编辑器。现在我可以将这个波形文件以图形表示形式显示为波形。在主菜单中，我可以单击 Edit -> Select All，这将选择我的所有样本。

```
 MySelector ms = new MySelector (0, numOfSamples-1);
 ms.SelectAll; 
```

当然应该可以选择范围块：

```
ms.Select (from, to); 
```

甚至反转：

```
ms.InvertSelection (); 
```

多选：

```
ms.AppendSelection (from ,to); 
```

获取有关所选样本的信息：

```
for (int i=0; i< ms.Size; i++)
if (ms.SelectedAt (i)) DoSomeLogic (); 
```

那么，这门课是已经写好了还是我明天应该写：O？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:08:48.527

这门课你已经写了多少？事实上，我看到你*描述*

1.  一组两个数字（可能是长整数？）来定义时间范围或样本选择。
2.  方便选择所有时间/样本的能力。
3.  时间范围的集合。
4.  “命中测试”给定时间/样本的选择能力。

如果您有用于波形数据的 API/POCO，则可以在其上实现通用或访问者模式以获得所需的功能。我不确定我是否知道 .net 框架中的通用“样本范围”项目。

但是，作为示例，您可以查看[构建通用范围类](http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class)中的代码示例，看看您是否可以使用它。我不完全确定我是否同意他的一些运算符重载，但这可能是你开始的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:58:01.677

我无法找到任何与您描述的内容模糊匹配的“官方”（内置于框架中）类，但我发现[这篇文章](http://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class)应该对您有所帮助 - 我看不到与您的等价物`InvertSelection()`方法，但除此之外它看起来很有希望。

编辑：经过进一步搜索，我发现 Jon Skeet 在他的 C# 书中有一个关于创建通用范围类的章节 - 在他的网站上查看它的[摘录](http://csharpindepth.com/Articles/Chapter6/Ranges.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:00:11.170

我不知道框架中有什么只做这个的。这似乎高度依赖于您希望如何跟踪选择（`Selected`属性、索引范围）。

# spring - 使用 Spring Oxm 设置脚轮属性

> ID：11506755
> 
> 赞同：2
> 
> 时间：2012-07-16T14:46:27.770
> 
> 标签：spring, spring-batch, castor, spring-batch-admin, spring-oxm

[Spring Oxm](http://static.springsource.org/spring-ws/site/reference/html/oxm.html)允许您使用不同的编组器/解组器，[Castor](http://www.castor.org/)就是其中之一。

默认情况下，castor marshalles xml 文档未缩进，官方文档告诉将 castor.properties 文件放在包括该行在内的[搜索位置](http://castor.org/xml-faq.html#Where-does-Castor-search-for-the-castor.properties-file?)`org.exolab.castor.indent=true`将覆盖默认行为。

现在，在 Web 应用程序（Spring Batch Admin）中使用 Spring Oxm 时，如何覆盖 castor jar 中的 castor.properties？

我有以下 bean 配置（删除了多余的行），据我所知，它们没有为此设置的必要属性。

```
<bean id="myCastorMarshaller" 
    class="org.springframework.oxm.castor.CastorMarshaller">
<property name="mappingLocation" value="classpath:/mapping/my-mapping.xml" />
</bean>

<bean id="myXmlWriter" 
   class="org.springframework.batch.item.xml.StaxEventItemWriter">
<property name="marshaller" ref="myCastorMarshaller" />
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T11:15:10.757

回答我自己的问题：使用 Spring 3.1.2 这个问题没有解决方案。

该类`org.springframework.oxm.castor.CastorMarshaller`应负责设置属性，并且此[SPR-8470](https://jira.springsource.org/browse/SPR-8470)甚至存在 jira 问题，但补丁在一年多后未提交到主分支。

任何人都可以将[Github 上的 CastorMarshaller](https://github.com/SpringSource/spring-framework/blob/master/spring-oxm/src/main/java/org/springframework/oxm/castor/CastorMarshaller.java)与提议的[补丁](http://jira.codehaus.org/secure/attachment/55354/SpringOXM%20CastorMarshaller%20Properties%2031.05.11.patch)进行比较。

简而言之，我们在 CastorMarshaller 中需要一个 setProperties(...) 方法，但补丁没有提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:36:25.000

### 在 Web 应用程序（Spring Batch Admin）中使用 Spring Oxm 时，如何覆盖 castor jar 中的 castor.properties？

一般在你提到的链接[搜索位置都有描述：](http://castor.org/xml-faq.html#Where-does-Castor-search-for-the-castor.properties-file?)

> Castor 按以下顺序加载 castor.properties：
> 
> 1.  从类路径（通常来自 jar 文件）
> 2.  来自 {java.home}/lib（如果存在）
> 3.  从本地工作目录
> 
> 每个属性文件都会覆盖前一个。所以你不必想出一个包含所有属性和值的属性文件，只需要你想要更改的那些。这也意味着您不必触摸 jar 文件中的属性文件。

* * *

Castor 扫描加载的属性文件（文件名固定）一般有两种，具体可以查看 Castor 源码：

*   默认属性文件：`castor.core.properties`，签出源代码[loadDefaultProperties()](http://grepcode.com/file/repo1.maven.org/maven2/org.codehaus.castor/castor-core/1.3.3-rc1/org/castor/core/util/AbstractProperties.java#AbstractProperties.loadDefaultProperties%28java.lang.String%2Cjava.lang.String%29)
*   用户属性文件：`castor.properties`，查看源代码[loadUserProperties()](http://grepcode.com/file/repo1.maven.org/maven2/org.codehaus.castor/castor-core/1.3.3-rc1/org/castor/core/util/AbstractProperties.java#AbstractProperties.loadUserProperties%28java.lang.String%29)

我们通常放在`castor.properties`classpath 根目录下，也就是你的项目`src/`目录（如果你使用 maven，在 下`src/main/java/`）。

希望这可以帮助。

# file-upload - 在 JSF 中显示上传的图像

> ID：11506762
> 
> 赞同：9
> 
> 时间：2012-07-16T14:46:44.303
> 
> 标签：file-upload, jsf-2, primefaces, graphicimage

我有一个视图范围的 bean，我在其中创建了一个人。一个人可以有一张照片。这张照片是在创建此人的同一页面上上传的。图片未存储在数据库或磁盘中（因为尚未创建此人）。bean 必须是视图范围的，因为可以在其他地方创建一个人，并且这使用相同的 bean。如果 bean 是 session 范围的，并且用户上传了图片但没有保存人员，则该图片将在用户下次尝试创建人员时显示。

我用两个豆子解决了这个问题；一个视图范围 bean 用于创建人员，一个会话范围 bean 用于上传图片并将图片作为流获取。然而，这会导致上述问题。

我怎样才能以更好的方式解决这个问题？

上传 bean：

```
@ManagedBean(name = "uploadBean")
@SessionScoped
public class UploadBean
{
    private UploadedFile    uploadedFile;

    public UploadedFile getUploadedFile()
    {
        return uploadedFile;
    }

    public StreamedContent getUploadedFileAsStream()
    {
        if (uploadedFile != null)
        {
            return new DefaultStreamedContent(new ByteArrayInputStream(uploadedFile.getContents()));
        }
        return null;
    }

    public void uploadFile(FileUploadEvent event)
    {
        uploadedFile = event.getFile();
    }
} 
```

create-a-person bean：

```
@ManagedBean(name = "personBean")
@ViewScoped
public class PersonBean
{
    private Person newPerson = new Person();

    public Person getNewPerson()
    {
        return newPerson;
    }

    private UploadedFile getUploadedPicture()
    {
        FacesContext context = FacesContext.getCurrentInstance();
        ELContext elContext = context.getELContext();
        UploadBean uploadBean = (UploadBean) elContext.getELResolver().getValue(elContext, null, "uploadBean");
        return uploadBean.getUploadedFile();
    }

    public void createPerson()
    {
        UploadedFile uploadedPicture = getUploadedPicture();
        // Create person with picture;
    }
} 
```

相关的 JSF 页面部分：

```
<h:form enctype="multipart/form-data">
    <p:outputPanel layout="block" id="personPicture">
        <p:graphicImage height="150"
            value="#{uploadBean.uploadedFileAsStream}"
            rendered="#{uploadBean.uploadedFileAsStream != null}" />
    </p:outputPanel>
        <p:fileUpload auto="true" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
            fileUploadListener="#{uploadBean.uploadedFile}"
            update="personPicture" />
    <p:commandButton value="Save" actionListener="#{personBean.createPerson()}"/>
</h:form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T21:43:27.530

我已经采取了不同的方法。我最初是为了显示上传的图像，但是如果`Person`还没有创建，那么将它全部保留在客户端似乎是一个更好的主意。我发现[了这个问题](https://stackoverflow.com/questions/4459379/preview-an-image-before-it-is-uploaded)，并根据选择的答案创建了以下内容：

如果浏览器是 IE 并且版本小于 9 以兼容，我在头部包含[html5shiv ：](https://code.google.com/p/html5shiv/)

```
<h:outputText value="&lt;!--[if lt IE 9]&gt;" escape="false" />
<h:outputScript library="js" name="html5shiv.js" />
<h:outputText value="&lt;![endif]--&gt;" escape="false" /> 
```

要显示/上传图像，我有以下元素：

```
<p:fileUpload binding="#{upload}" mode="simple"
    allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
    value="#{personBean.uploadedPicture}"/>
<p:graphicImage value="#" height="150" binding="#{image}" /> 
```

还有一些 JavaScript/jQuery 魔法：

```
function readPicture(input, output)
{
    if (input.files && input.files[0])
    {
        var reader = new FileReader();
        reader.onload = function(e)
        {
            output.attr('src', e.target.result);
        };
        reader.readAsDataURL(input.files[0]);
    }
}

$("[id='#{upload.clientId}']").change(
    function()
    {
        readPicture(this, $("[id='#{image.clientId}']"));
    }); 
```

该`uploadedPicture`属性现在是一个简单的属性：

```
@ManagedBean(name = "personBean")
@ViewScoped
public class PersonBean
{
    private UploadedFile uploadedPicture;

    public UploadedFile getUploadedPicture()
    {
        return uploadedPicture;
    }

    public void setUploadedPicture(UploadedFile uploadedPicture)
    {
        this.uploadedPicture = uploadedPicture;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-09T15:32:40.623

添加.xhtml

```
<h:form id="add-form" enctype="multipart/form-data">
         <p:growl id="messages" showDetail="true"/>
         <h:panelGrid columns="2">
              <p:outputLabel for="choose" value="Choose Image :" />
              <p:fileUpload id="choose" validator="#{productController.validateFile}" multiple="false" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"  value="#{productController.file}" required="true" mode="simple"/>
            <p:commandButton value="Submit" ajax="false" update="messages" id="save-btn" actionListener="#{productController.saveProduct}"/>
         </h:panelGrid>
</h:form> 
```

这是托管 Bean 代码：

```
@ManagedBean
@RequestScoped
public class ProductController implements Serializable{
    private ProductBean bean;
    @ManagedProperty(value = "#{ProductService}")
    private ProductService productService;
    private StreamedContent content;
    private UploadedFile file;
    public StreamedContent getContent() {
        FacesContext context = FacesContext.getCurrentInstance();

         if (context.getCurrentPhaseId() == PhaseId.RENDER_RESPONSE) {
                return new DefaultStreamedContent();
            }
         else{
             String imageId = context.getExternalContext().getRequestParameterMap().get("id");
            Product product = getProductService().getProductById(Integer.parseInt(imageId));
            return new DefaultStreamedContent(new ByteArrayInputStream(product.getProductImage()));
         }
    }
    public ProductController() {
        bean = new ProductBean();
    }

    public void setContent(StreamedContent content) {
        this.content = content;
    }
    public UploadedFile getFile() {
        return file;
    }

    public void setFile(UploadedFile file) {
        this.file = file;
    }
    public void saveProduct(){
        try{
            Product product = new Product();
            product.setProductImage(getFile().getContents());

            getProductService().saveProduct(product);
            file = null;

        }
        catch(Exception ex){
            ex.printStackTrace();
        }
    }
    public void validateFile(FacesContext ctx,
            UIComponent comp,
            Object value) {
        List<FacesMessage> msgs = new ArrayList<FacesMessage>();
        UploadedFile file = (UploadedFile)value;
        int fileByte = file.getContents().length;
        if(fileByte > 15360){
            msgs.add(new FacesMessage("Too big must be at most 15KB"));
        }
        if (!(file.getContentType().startsWith("image"))) {
            msgs.add(new FacesMessage("not an Image file"));
        }
        if (!msgs.isEmpty()) {
            throw new ValidatorException(msgs);
        }
    }
} 
```

在 web.xml 中添加这些代码行

```
<filter>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <filter-class>org.primefaces.webapp.filter.FileUploadFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping> 
```

以及 WEBINF/lib 文件夹中的 jar 文件。

```
commons-io-X.X  and commons-fileupload-X.X, recommended most recent version. 
```

~~**commons-io-2.4,commons-io-2.4-javadoc,commons-io-2.4-sources,commons-io-2.4-tests,commons-io-2.4-test-sources,commons-fileupload-1.3,commons-fileupload- 1.3-javadoc、commons-fileupload-1.3-sources、commons-fileupload-1.3-tests、commons-fileupload-1.3-test-sources**~~

查看.xhtml

```
<h:form id="ShowProducts">
    <p:dataTable rowsPerPageTemplate="3,6,9" var="products" paginator="true" rows="3" emptyMessage="Catalog is empty" value="#{productController.bean.products}">
        <p:column headerText="Product Name">
            <p:graphicImage width="80" height="80" value="#{productController.content}">
                <f:param name="id" value="#{products.productId}" />
            </p:graphicImage>
            #{products.productName}
        </p:column>
    </p:dataTable>
</h:form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-13T15:29:32.917

我设法通过简单地将上传的图像编码为base64然后通过html`<img>`标签正常显示它来做到这一点。

这是我的托管bean：

```
@ManagedBean
@ViewScoped
public class ImageMB {

private String base64Image;

public void onUploadImage(FileUploadEvent event) {
    String fileName = event.getFile().getFileName();
    //Get file extension.
    String extension = "png";
    int i = fileName.lastIndexOf('.');
    if (i > 0) {
        extension = fileName.substring(i + 1).toLowerCase();
    }

    String encodedImage = java.util.Base64.getEncoder().encodeToString(event.getFile().getContents());
    this.base64Image = String.format("data:image/%s;base64, %s", 
         extension, encodedImage));
} 
```

这是 JSF 部分：

```
<p:fileUpload id="imageFileUploader"
              fileUploadListener="#{imageMB.onUploadImage}"
              mode="advanced"    
              multiple="false"
              fileLimit="1"
              allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
              update="@form"/>

<div>
    <img src="#{toolAddEditMB.base64Image}" 
         style="#{toolAddEditMB.base64Image eq null ? 'display: none' : ''}"/>
</div> 
```

# c# - SSIS - TaskHost 对象 - 数据库架构

> ID：11506763
> 
> 赞同：1
> 
> 时间：2012-07-16T14:46:45.437
> 
> 标签：c#, ssis

如何在 C# 中使用 TaskHost 对象（我在 SSIS 脚本任务中使用它，但这通常也适用于 C#）并处理不在“dbo”模式中的表？

我已经编写了基本上连接到源数据库和目标数据库的代码，然后应该一个一个地跨越特定的表（在循环内），包括表模式和数据。

在我的本地主机上，这很有效，但在我的客户中，供应商正在使用模式；不是我们最初考虑的东西，这给我带来了一些麻烦。

我曾尝试使用 TaskHost 对象的“SchemasList”属性，但一直遇到同样的错误：

```
? child.Errors[0]
{Microsoft.SqlServer.Dts.Runtime.DtsError}
    base {Microsoft.SqlServer.Dts.Runtime.DtsObject}: {Microsoft.SqlServer.Dts.Runtime.DtsError}
    Description: "Table \"[theSchema].[theTable]\" does not exist at the    source.\r\n"
ErrorCode: -1073548445
HelpContext: 0
HelpFile: ""
IDOfInterfaceWithError: "{B6F6D221-FC27-4F71-B5A0-597583986C28}"
Source: "{D6DF0C1F-0AC8-4748-836C-BEF052454AEE}"
SubComponent: "Transfer SQL Server Objects Task"
TimeStamp: {16-07-2012 13:41:43} 
```

这是代码：

```
if (Dts.Variables["tableName"].Value.ToString() != "0") {
        string tableName;
        tableName = Dts.Variables["tableName"].Value.ToString();

        // Add a child package 
        Package child = new Package();

        child.Name = tableName;
        Executable moveTable = child.Executables.Add("STOCK:TransferSQLServerObjectsTask");
        TaskHost moveTableTask = (TaskHost)moveTable;

        // Set properties for the task
        moveTableTask.Properties["CopyAllObjects"].SetValue(moveTableTask, false);
        moveTableTask.Properties["CopyAllTables"].SetValue(moveTableTask, false);
        moveTableTask.Properties["CopySchema"].SetValue(moveTableTask, true);
        moveTableTask.Properties["DropObjectsFirst"].SetValue(moveTableTask, true);
        moveTableTask.Properties["CopyData"].SetValue(moveTableTask, true);

        // Set schemas
        //StringCollection schemas = new StringCollection();
        //String[] schemaList = new String[] {"[theSchema].[" + tableName + "]"};
        //schemas.AddRange(schemaList);
        //moveTableTask.Properties["SchemasList"].SetValue(moveTableTask, schemas);

        // Set tablenames
        StringCollection tables = new StringCollection();
        tables.Add(tableName);
        moveTableTask.Properties["TablesList"].SetValue(moveTableTask, tables);

        // Set up connections
        ConnectionManager source;
        ConnectionManager destination;

        source = child.Connections.Add("SMOServer");
        source.ConnectionString = "SqlServerName=*****;UseWindowsAuthentication=False;UserName=*****;Password=*****;";
        source.Name = "Source";

        destination = child.Connections.Add("SMOServer");
        destination.ConnectionString = "SqlServerName=*****;Persist Security Info=True;Password=*****;USER ID=*****;Initial Catalog=*****";
        destination.Name = "Destination";
        moveTableTask.Properties["SourceConnection"].SetValue(moveTableTask, "Source");
        moveTableTask.Properties["SourceDatabase"].SetValue(moveTableTask, "*****");
        moveTableTask.Properties["DestinationConnection"].SetValue(moveTableTask, "Destination");
        moveTableTask.Properties["DestinationDatabase"].SetValue(moveTableTask, "*****");

        child.Execute();

        child.Dispose(); 
```

如您所见，有一个注释位试图查看我是否可以以这种方式添加架构。我尝试的另一个选项是使用 CopyAllSchemas 属性，但这也无济于事。

我还尝试在将表名添加到表 stringcollection 的代码行中添加架构，但这会产生相同的错误，无论是否使用方括号 ([])。默认情况下，TaskHost 似乎只接受“dbo”模式中的表，除非我遗漏了一些东西。

有谁知道我如何让 TaskHost 处理数据库模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:15:47.997

事实证明，这些表不是表，而是视图。使用 Views 集合的组合，以及对架构进行的一些额外调整，我设法让事情正常工作:)

# php - 图片分享到 Facebook 效果不佳

> ID：11506765
> 
> 赞同：1
> 
> 时间：2012-07-16T14:46:58.103
> 
> 标签：php, facebook, image, sharing

我正在尝试使用 php 将图像从我的网站共享到 facebook。但它只共享一个缩略图和图像链接。我想获得完整尺寸的图像而不是图像网址。

这是我的代码

```
$attachment = array(

    'link' =>$_COOKIE['purl'],
    'picture' =>'http://cutefacebooktimelinecovers.com/'.$imgurl,
    'actions' => array(array(
            'name' => 'Cutefacebooktimelinecovers.com',
            'link' => 'http://cutefacebooktimelinecovers.com'
        ))
    );
    try {
        $result = $facebook->api(
        '/me/feed/',
        'post',
        $attachment 
```

);

# regex - htaccess 动态子域重写

> ID：11506766
> 
> 赞同：1
> 
> 时间：2012-07-16T14:47:01.997
> 
> 标签：regex, .htaccess, mod-rewrite

我保证我已经在这里寻找了几个小时的答案，但它仍然没有工作。这是我所拥有的：

```
RewriteCond %{HTTP_HOST} ^([^\.]*)\.example\.com [NC]
RewriteCond %{REQUEST_URI} !^/%1/ [NC]
RewriteRule ^(.*)$ /%1/$1 [L] 
```

这会创建一个无限循环，因为第二行没有正确匹配。但是，如果我将`%1`第二行替换为`www`and go to `www.example.com`，它工作正常。显然它不再适用于其他子域，但是当我明确输入`www`第二行而不是让它`%1`照顾它时，这一事实很奇怪，因为我知道 is 的`%1`值`www`。

我要完成的工作如下：我有一个域“example.com”。在根目录中有几个子目录，比如说“dev”、“test”和“www”。在我的 htaccess 文件中，如果子域为空 (example.com)、w (w.example.com) 或 ww (ww.example .com），其他任何东西都不管（dev.example.com，test.example.com）。现在这部分文件应该根据子域将请求重写到正确的子目录。因此，像“dev.example.com/something.jpg”这样的请求被重写（而不是重定向）到“dev.example.com/dev/something.jpg”。

这里的计划是能够在服务器上创建开发和测试环境，而不必在我的家庭服务器上重新创建环境，确保所有服务器设置完全相同。此外，我想它可以做任何我想让它做的事情，但这是当务之急。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:22:18.553

问题是您不能在 a 的匹配表达式中使用反向引用变量`RewriteCond`。还行吧：

```
# ----------V
RewriteCond %1 <regex> 
```

但这不是：

```
# -------------------------V
RewriteCond %{REQUEST_URI} %1 
```

如果您需要进行这样的匹配，您可以做的事情是使用匹配反向引用`\1`从同一个正则表达式中访问匹配。然后，您可以将`%1`反向引用放在相同的左侧参数中`RewriteCond`并用于`\1`匹配它。像这样的东西：

```
RewriteCond %{REQUEST_URI}:%1 !^/([^/]+)[^:]*:\1 [NC] 
```

所以该`%{REQUEST_URI}:%1`位可能看起来像这样：`/foo:subdomain`，并且`^/([^/]+)[^:]*:\1`不会匹配，因为表达式在“:”（=“foo”）之后寻找**foo 。**`\1`所以规则被应用，URI 是 now `/subdomain/foo`，第二次`%{REQUEST_URI}:%1`变成`/subdomain/foo:subdomain`，这一次正则表达式匹配，因为`\1`= "subdomain" 并且`!`使得规则*不*被应用。

# php - 如何实现mysql事件的历史记录？

> ID：11506767
> 
> 赞同：1
> 
> 时间：2012-07-16T14:47:03.473
> 
> 标签：php, mysql, html

我有一个带有下一个字段的 MySQL 表：

```
id int(11) primary auto_increment
data(text)
user varchar(20)
date text 
```

我有一个带有 php 的基于 Web 的 UI，我在其中显示数据（数据、用户和日期），人们也可以添加或删除数据。结果正确显示在表中。

现在我想以某种方式实现历史。因此，如果我曾经删除了一行，我希望在可以说“历史”sql 表中看到这一点。我想按用户和日期存储所有事件（添加或删除），仅此而已。

我应该如何处理这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:52:15.977

我建议使用[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)。

本文应该可以帮助您掌握使用触发器的方法： http: [//codepatter.com/2008/05/06/how-to-use-triggers-to-track-changes-in-mysql/](http://codespatter.com/2008/05/06/how-to-use-triggers-to-track-changes-in-mysql/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:52:47.223

用提供的信息来回答并不容易。换句话说：您的问题非常笼统。

无论如何我都会尝试回答：我认为您应该设置一个表历史记录，其中外键是 user_id。然后，您只需将该表中的每个操作（添加、删除等）连同 user_id 和时间戳一起保存，并说出添加或删除的数据或任何其他有用的信息。（*更新：* @Gibbs 提出的方式是一种可能性）

当您想要显示历史记录时，您可以轻松选择一个用户按时间戳排序的所有操作。

还有一件事：对日期使用日期时间格式（例如时间戳）比使用 VARCHAR 好得多***。***

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:06:47.263

我现在实际上创造了自己的“历史”。我为历史条目创建了另一个表，并编写了另一个函数（php），每次有人添加/删除某些内容并将数据写入预先创建的表时都会执行该函数。然后我只是在“历史”页面中显示数据，它运行良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T14:53:32.117

我希望它可以保存表的所有实例，但是您在结构中添加一个新列，该列显示“实时”行。

例如：

```
------------------------------------------------
- id - user - data - live- date                -
------------------------------------------------
- 1  - 53   - ???  - 0   - 2012-07-16 15:51:45 -
- 1  - 53   - ???  - 0   - 2012-07-16 15:45:45 -
- 1  - 53   - ???  - 1   - 2012-07-16 14:51:42 -
- 1  - 53   - ???  - 0   - 2012-07-16 15:12:45 -
- 1  - 53   - ???  - 0   - 2012-07-16 13:54:21 -
- 1  - 53   - ???  - 0   - 2012-07-16 11:41:33 -
------------------------------------------------ 
```

然后我会通过添加查询表以查找“实时”行`WHERE live=1;`，这样，剩下的就是历史了。

# asp.net-mvc-3 - 在同一个解决方案中分离项目。“找到的程序集的清单定义与程序集引用不匹配”

> ID：11506768
> 
> 赞同：1
> 
> 时间：2012-07-16T14:47:03.750
> 
> 标签：asp.net-mvc-3, ravendb, ext.net, json.net

***更新：***我尝试在 web.config 中以不同的组合使用dependentAssembly -> bindingRedirect。我还尝试将 app.config 添加到我的**“DataAccess”**项目并在其中添加 bindingRedirect。我已经使用了我能想到的所有可能的组合，但是在配置文件和它们自己的配置文件中，但似乎没有任何效果。也许我做错了

我决定尝试使用 n 层架构的 MVC3 + EXT.Net V2.0 和 RavenDB。

我在我的**MVC 项目**中使用 NuGet 添加了 Ext.Net ，这又添加了**Newtonsoft.Json（版本 4.5.7）**，因为它是一个依赖项。一切都还好，一切都按预期构建和执行。

接下来我决定添加一个新项目**“实体”**，我将在其中实现我的实体及其存储库接口/类。好的，一切都还不错并且可以构建。

然后我添加了另一个项目**"DataAccess"**。我手动添加了对与 Raven 捆绑的RavenDB 和**Newtonsoft.Json（版本 4.0.8.0）的引用。**我实现了一个简单的 RavenDB 会话和存储对象的方法。

我重建了整个解决方案并且没有错误，但是当我运行应用程序时出现以下错误

`Could not load file or assembly 'Newtonsoft.Json, Version=4.0.8.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)`

在

`Line 17: store = new DocumentStore()`（这是在我的**“DataAccess”**项目中）

堆栈跟踪

`[FileLoadException: Could not load file or assembly 'Newtonsoft.Json, Version=4.0.8.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)] Raven.Client.Document.DocumentConvention..ctor() in c:\Builds\RavenDB-Stable\Raven.Client.Lightweight\Document\DocumentConvention.cs:84...`

有没有办法在不自己重建任何第三方程序集的情况下解决这个错误？

*如果我删除对 EXT.Net 和 Newtonsoft.Json (4.5.7) 的引用，RavenDB 代码将自行工作，反之亦然，当我删除对 RavenDB 和 Newtonsoft.Json (4.0.8.0) 的引用时，EXT.Net 代码将工作*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:05:13.310

RavenDB 960 使用 Newtonsoft.Json 4.0.8，你可以使用 RavenDB 1.2 不稳定，它内化了 Newtonsoft.Json 支持。

# java - Primefaces 选项卡更改通知

> ID：11506771
> 
> 赞同：1
> 
> 时间：2012-07-16T14:47:16.287
> 
> 标签：java, jsf, primefaces

我们使用 PrimeFaces 3.3.1、Mojarra 2.1.10 和 Tomcat 7.0.26。

我们应用程序中的所有组件都是以编程方式创建的，并且仅绑定了页面上的根组件。这是页面——模板的一部分——绑定到根组件，Panel 称为 rootPanel：

```
<ui:composition template="/layout/template.xhtml"
   xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:porta="http://java.sun.com/jsf/composite/porta"
   xmlns:p="http://primefaces.org/ui">

   <ui:define name="body">
      <h:messages globalOnly="true" styleClass="message" />
      <p:ajaxStatus onstart="statusDialog.show();"
                    onsuccess="statusDialog.hide();" />

      <p:dialog modal="true" widgetVar="statusDialog" header=".::."
                draggable="false" closable="false">
         <p:graphicImage value="/img/progressbar.gif" />
      </p:dialog>

      <h:form id="initForm" name="initform">
         <p:panel id="rootPanelId" binding="#{applicationErp.rootPanel}" 
                  rendered="true">
         </p:panel>
       </h:form>
   </ui:define>
</ui:composition> 
```

这就是我们以编程方式创建 TabView 组件的方式：

```
mainTabbedPane = new TabView();
mainTabbedPane.setId("formErpMainTabViewId");
mainTabbedPane.setStyle("height: 100%; width: 100%;");

AjaxBehavior ajaxBehavior = new AjaxBehavior();
MethodExpression methodExpression = FacesUtil.createMethodExpression("#{formerpmain.tabChanged}", Void.class, new Class<?>[]{TabChangeEvent.class});

ajaxBehavior.addAjaxBehaviorListener(new AjaxBehaviorListenerImpl(methodExpression));
ajaxBehavior.setListener(methodExpression);
ajaxBehavior.setUpdate(":initForm:formErpMainTabViewId");

mainTabbedPane.addClientBehavior("tabChange",ajaxBehavior); 
```

这是 tabChanged 方法：

```
public void tabChanged(TabChangeEvent event){
  requestPartialRendering();
} 
```

在上面的 MethodExpression 中指定的方法 tabChanged 永远不会在选项卡更改时被调用。这是指定在选项卡更改时调用的方法的正确方法吗？如何指定要在选项卡更改时调用的 bean 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T14:14:52.800

经过几天的实验，我们找到了解决方案。我们将“@parent”值设置为 setProcess 方法，只有该值有效，并从 MethodExpression 的参数列表中删除 TabChangedEvent。经过这些更改后，它工作正常。

代码：

```
AjaxBehavior ajaxBehavior = new AjaxBehavior();
MethodExpression methodExpression = FacesUtil.createMethodExpression(
        "#{formerpmain.onTabChange}", void.class, new Class<?>[]{});

ajaxBehavior.addAjaxBehaviorListener(
        new AjaxBehaviorListenerImpl(methodExpression));
ajaxBehavior.setListener(methodExpression);
ajaxBehavior.setProcess("@parent"); 
```

# powershell - 启用模拟并将 Powershell 用作管理员角色

> ID：11506775
> 
> 赞同：0
> 
> 时间：2012-07-16T14:47:29.300
> 
> 标签：powershell, admin, impersonation, exchangewebservices

我正在制作一个使用 EWS API 的应用程序，该应用程序访问不同的帐户，为此我必须使用模拟。我已经尝试过模拟......但我收到的错误是我没有模拟权限。所以我尝试修改交换服务器以添加模拟能力，但是当我尝试遵循 MSDN 给出的一些命令时

```
New-ManagementRoleAssignment -Name <impersonationAssigmentName> -Role applicationImpersonation -User <serviceAccount> 
```

但我得到这个错误

```
The term 'New-ManagementRoleAssignment' is not recognized as the name of a cmdlet, function, script file, or operable 
```

据我的朋友说，这可能是没有使用管理员使用交换服务器的问题，但我正在使用管理员帐户登录到服务的 Windows。老实说，我对 Exchange Server 完全陌生，我需要解决这个管理问题，希望它能解决我的问题。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:06:33.330

您是否在本地加载了 Exchange 工具？您需要这些工具才能调用 cmdlet。

或者，使用远程处理并打开到 Exchange 服务器的 pssession，然后尝试在远程会话中运行 cmdlet。

# jboss7.x - JBoss 7 服务加载器

> ID：11506778
> 
> 赞同：0
> 
> 时间：2012-07-16T14:47:33.960
> 
> 标签：jboss7.x, serviceloader

有一个接口**MyInteface**。

System 有几个 EAR，每个 EAR 都有自己的接口实现。我需要找到所有没有名称的实现（**? extends MyInterface**）。

我决定使用**java.util.ServiceLoader**并创建了一个带有 META-INF/services/com.example.MyInterface 的 jar，这个 jar 可以部署在任何 EAR 中。

jar 在 int 的 init 方法中有一个 servlet 和以下代码：

```
ServiceLoader<MyInterface > loader = ServiceLoader.load(MyInterface .class);
Iterator<MyInterface > it = loader.iterator(); 
```

但是迭代器仍然是空的..

我尝试在 EARs META-INF 中添加 services/com.example.MyInterface，但结果是一样的。

这种方法在 jboss 6 和 tomcat 中运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T13:54:55.263

当我遇到同样的问题时，通过尝试延迟加载解决了

```
private static class LoaderHolder {
   ServiceLoader<MyInterface > loader = ServiceLoader.load(MyInterface .class);
  }

Iterator<MyInterface > it = LoaderHolder .loader.iterator(); 
```

# android - 在真实设备上播放 Android 渐进式媒体 - MediaPlayer.prepare() 永远耗时

> ID：11506779
> 
> 赞同：0
> 
> 时间：2012-07-16T14:47:41.567
> 
> 标签：android, android-mediaplayer

我有一个包含歌曲及其网址的播放列表当我尝试执行以下操作时：

```
mp.setDataSource(getCurrentSong().getUrl());
mp.prepareASync(); 
```

它在模拟器上就像一个魅力，但是当我尝试在真实设备（Acer Liquid Mini）上运行它时，它只是卡在准备中，`onPrepared()`永远不会被调用，并且我在`onInfo()`给我什么 = 1 时得到一个信息，额外= 44; 所以我试着打电话

```
mp.reset();
mp.setDataSource(getCurrentSong.getUrl());
mp.prepareASync(); 
```

但这无济于事，它仍然从不调用 onPrepared()，并且总是给我相同的 what = 1，extra = 44 信息。是否有任何 MediaPlayer onInfo/onError 代码列表？我该如何解决这个问题？是的，我在 2.2 上运行我的应用程序，适用于模拟器和真实设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:49:36.260

哦，我刚刚发现Info(1,44) 和Info(1,26) 不代表我有错误，我不应该重置播放器。现在一切都很好。这是来自 android 源的完整信息列表：[https ://github.com/android/platform_external_opencore/blob/master/pvmi/pvmf/include/pvmf_return_codes.h](https://github.com/android/platform_external_opencore/blob/master/pvmi/pvmf/include/pvmf_return_codes.h)

# ruby-on-rails - Rails 3.2 后台任务

> ID：11506786
> 
> 赞同：0
> 
> 时间：2012-07-16T14:48:07.063
> 
> 标签：ruby-on-rails, heroku, background, delayed-job

我在 Heroku 上运行 Rails 3.2，并且使用**Delayed_job**来管理后台任务。

该应用程序生成一个 CSV，该 CSV 通过浏览器下载给请求它的人。但是，该文件非常大，生成时间长达 30 秒。

我的控制器如下所示：

```
def index
    @unpaginated = @search.result.order("created_at DESC")   # load all matching records

respond_to do |format|
      format.csv { render csv: @unpaginated, filename: 'outlets_' + Time.now.strftime("%Y_%m_%d") }

end 
```

我如何将这样的事情转移到后台工作中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T20:45:40.237

我会做这样的事情：

1.  为文件生成创建后台作业。
2.  重定向到等待后台作业完成并定期刷新的等待页面
3.  后台作业完成后，重定向到文件的 url。

（可选）步骤 2.5 是将生成的文件上传到 amazon s3，这使步骤 3 更容易。

# c# - 类型化工厂默默地丢弃无法映射到构造函数的参数？

> ID：11506789
> 
> 赞同：2
> 
> 时间：2012-07-16T14:48:09.677
> 
> 标签：c#, castle-windsor, windsor-facilities

**问题**

如果在创建函数中指定了无法映射到构造函数的参数，类型化工厂是否应该抛出异常？例如

```
public class Foo
{
    public Foo() : Foo(new Guid())
    {
    }

    // Used to be 'public Foo(string bar)'
    public Foo(Guid guid)
    {
    }
}

public interface FooFactory
{
    Foo CreateFoo(string bar);
} 
```

我们发现部分错误是由类型化工厂静默调用默认构造函数引起的，而不是当它在 Foo 上找不到接受字符串的构造函数时抛出异常。Foo 的构造函数已更改，但在类型化工厂中创建它的方法尚未更新。

**部分解决方案？**

我们做了一些实验，找到了一个潜在的解决方案：

```
public class OurComponentSelector : DefaultTypedFactoryComponentSelector
{
    public override IDictionary GetArguments(MethodInfo method, object[] arguments)
    {
        // Check an appropriate constructor can be found, throw exception if not
    }
} 
```

这会是一个合适的解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:34:26.597

是的。这正是 ITypedFactoryComponentSelector 旨在提供的可扩展性类型。

Windsor 自己的 DefaultDelegateComponentSelector 使用相同的扩展点来转换参数，然后再将它们传递给容器。

# opencl - 了解 OpenCL 中的寄存器

> ID：11506790
> 
> 赞同：1
> 
> 时间：2012-07-16T14:48:14.603
> 
> 标签：opencl, gpgpu

我对 OpenCL 内核内部寄存器的使用有点困惑。我正在使用 -cl-nv-verbose 来捕获内核的寄存器使用情况。目前，我的内核正在记录内核中`ptxas info: Used 4 registers`的一些代码。对于以下部分：

```
double a;
a = pow(2.0,2.0)
if (index != 0) {
} 
```

使用的寄存器发生了变化`ptxas info: Used 6 registers`。我知道 if 循环中没有任何内容。但是，如果我再次重组为：

```
double a;
if (index != 0) {
    a = pow(2.0,2.0)
} 
```

这会将寄存器用法更改为`ptxas info: Used 15 registers`. 我不会更改内核的工作组大小。也许答案在于查看 ptx 代码，但我不明白（尽管如果需要我可以得到它）。我更感兴趣的是，为什么只移动一行代码，寄存器使用量就跳到了两倍。有任何想法吗？（指数为`private`）

更新：PTX 代码[之前](http://pastebin.com/tWuN7D8k)和[之后](http://pastebin.com/4dyZSNgP)

更新：内核代码：

```
__kernel void butterfC( __global double *sI,    
                        __global double *sJ,
                        __global double *sK,
                        const int zR, 
                        const int yR,   
                        const int xR,
                        unsigned int l1,
                        const int dir,
                        unsigned int type   ) 
{
    int idX = get_global_id(0);
    int idY = get_global_id(1);
    int idZ = get_global_id(2);

    int BASE = idZ*xR*yR;
    int STRIDE = 1;

    int powX = pow(4.0f,l1);
    int powXm1 = pow(4.0f,l1-1);

    int yIndex, kIndex;

    switch(type)
    {
        case 1: BASE += idY*xR; 
                yIndex  = idX / powXm1 * powX;
                kIndex  = (idX % powXm1) + yIndex;  
                break;
        case 2: BASE += idX; STRIDE = xR; 
                yIndex  = idY / powXm1 * powX;
                kIndex  = idY % powXm1 + yIndex;
                break;
        case 3: BASE = idY*xR + idX; STRIDE = xR * yR; 
                yIndex  = idZ / powXm1 * powX;
                kIndex  = idZ % powXm1 + yIndex;
                break; 
    }

    double a;   

    //a = pow(2.0,2.0);
    if (kIndex != 0) {
        a = pow(2.0,2.0);
        .... do stuff
    }
} 
```

# javascript - Javascript 和 RegEx：匹配函数返回一个数组

> ID：11506791
> 
> 赞同：1
> 
> 时间：2012-07-16T14:48:14.950
> 
> 标签：javascript, regex

我有一个字符串：

```
var doi_id= "10.3390/metabo1010001" 
```

我只想匹配最后的第一组数字。

为此，我正在使用这个正则表达式：

```
var doinumericpart = doi_id.match(/(\d*)$/); 
```

“问题”（或不是）是 doinumericpart 返回

```
1010001,1010001 
```

而不是 1010001 我不知道为什么。

当我在这里尝试这个正则表达式时：[http](http://regexr.com?31htm) ://regexr.com?31htm一切似乎都很好。

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T14:50:47.427

`match()`返回一个应有的数组。第一个元素是与模式匹配的整个子字符串，然后第一个元素开始包含子模式。

在您的情况下，只需摆脱`()`- 您不需要它们，因为它们包含整个模式。

```
var doinumericpart = doi_id.match(/\d*$/)[0]; 
```

`[0]`取消引用数组以提供您想要的确切元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T14:50:23.387

`match`返回`null`匹配项或匹配项的数组。匹配的数量取决于您的正则表达式中有多少个捕获组。该项目`[1]`将是您的匹配项，因此您可以执行以下操作：

```
var doinumericpart = doi_id.match(/(\d*)$/)[1]; //Access second item in the matches array 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T14:51:12.263

`match`返回完整的匹配项和每个捕获组，或者`null`如果没有匹配项。

如果您想提供一些上下文，这很有用：

```
"10.3390/metabo1010001".match(/metabo(\d*)/)
// => ["metabo1010001", "1010001"] 
```

*   `metabo1010001`是整场比赛
*   `1010001`是第一个捕获组

# linux - 64位堆栈驻留缓冲区溢出？

> ID：11506799
> 
> 赞同：4
> 
> 时间：2012-07-16T14:48:46.837
> 
> 标签：linux, gdb, 64-bit, stack-overflow, callstack

我正在研究一些与安全相关的东西，现在我正在玩我自己的堆栈。我所做的应该很简单，我什至没有尝试执行堆栈，只是为了表明我可以控制我的 64 位系统上的指令指针。我已经关闭了所有我知道的保护机制，只是为了能够使用它（NX-bit，ASLR，也使用 -fno-stack-protector -z execstack 编译）。我在 64 位汇编方面没有太多经验，在花了一些时间搜索和试验自己之后，我想知道是否有人可以对我遇到的问题有所了解。

我有一个程序（下面的源代码），它只是将一个字符串复制到一个没有边界检查的堆栈驻留缓冲区中。但是，当我用一系列 0x41 覆盖时，我希望看到 RIP 设置为 0x4141414141414141，但我发现我的 RBP 设置为这个值。我确实遇到了分段错误，但 RIP 在执行 RET 指令时不会更新到这个（非法）值，即使 RSP 设置为合法值。我什至在 GDB 中验证了在 RET 指令之前的 RSP 中有包含一系列 0x41 的可读内存。

我的印象是 LEAVE 指令做了：

MOV (E)SP, (E)BP

POP (E)BP

但是在 64 位上，“LEAVEQ”指令似乎可以执行（类似于）：

MOV RBP，QWORD PTR [RSP]

我认为它只是通过在执行该指令之前和之后观察所有寄存器的内容来做到这一点。LEAVEQ 似乎只是 RET 指令的上下文相关名称（GDB 的反汇编程序给它），因为它仍然只是一个 0xC9。

RET 指令似乎对 RBP 寄存器做了一些事情，也许是取消引用它？我的印象是 RET 做了（类似于）：

MOV RIP，QWORD PTR [RSP]

然而，就像我提到的，它似乎取消了 RBP 的引用，我认为它这样做是因为当没有其他寄存器似乎包含非法值时，我得到了分段错误。

程序的源代码：

```
#include <stdio.h>
#include <string.h>

int vuln_function(int argc,char *argv[])
{
    char buffer[512];

    for(int i = 0; i < 512; i++) {
        buffer[i] = 0x42;
    }

    printf("The buffer is at %p\n",buffer);

    if(argc > 1) {
        strcpy(buffer,argv[1]);
    }

    return 0;
}    

int main(int argc,char *argv[])
{
    vuln_function(argc,argv);

    return 0;
} 
```

for 循环只是在那里用 0x42 填充缓冲区的合法部分，这使得在溢出之前在调试器中很容易看到它在哪里。

调试会话摘录如下：

```
(gdb) disas vulnerable
Dump of assembler code for function vulnerable:
   0x000000000040056c <+0>:     push   rbp
   0x000000000040056d <+1>:     mov    rbp,rsp
   0x0000000000400570 <+4>:     sub    rsp,0x220
   0x0000000000400577 <+11>:    mov    DWORD PTR [rbp-0x214],edi
   0x000000000040057d <+17>:    mov    QWORD PTR [rbp-0x220],rsi
   0x0000000000400584 <+24>:    mov    DWORD PTR [rbp-0x4],0x0
   0x000000000040058b <+31>:    jmp    0x40059e <vulnerable+50>
   0x000000000040058d <+33>:    mov    eax,DWORD PTR [rbp-0x4]
   0x0000000000400590 <+36>:    cdqe   
   0x0000000000400592 <+38>:    mov    BYTE PTR [rbp+rax*1-0x210],0x42
   0x000000000040059a <+46>:    add    DWORD PTR [rbp-0x4],0x1
   0x000000000040059e <+50>:    cmp    DWORD PTR [rbp-0x4],0x1ff
   0x00000000004005a5 <+57>:    jle    0x40058d <vulnerable+33>
   0x00000000004005a7 <+59>:    lea    rax,[rbp-0x210]
   0x00000000004005ae <+66>:    mov    rsi,rax
   0x00000000004005b1 <+69>:    mov    edi,0x40070c
   0x00000000004005b6 <+74>:    mov    eax,0x0
   0x00000000004005bb <+79>:    call   0x4003d8 <printf@plt>
   0x00000000004005c0 <+84>:    cmp    DWORD PTR [rbp-0x214],0x1
   0x00000000004005c7 <+91>:    jle    0x4005e9 <vulnerable+125>
   0x00000000004005c9 <+93>:    mov    rax,QWORD PTR [rbp-0x220]
   0x00000000004005d0 <+100>:   add    rax,0x8
   0x00000000004005d4 <+104>:   mov    rdx,QWORD PTR [rax]
   0x00000000004005d7 <+107>:   lea    rax,[rbp-0x210]
   0x00000000004005de <+114>:   mov    rsi,rdx
   0x00000000004005e1 <+117>:   mov    rdi,rax
   0x00000000004005e4 <+120>:   call   0x4003f8 <strcpy@plt>
   0x00000000004005e9 <+125>:   mov    eax,0x0
   0x00000000004005ee <+130>:   leave  
   0x00000000004005ef <+131>:   ret 
```

我在调用 strcpy() 之前就中断了，但是在缓冲区被 0x42 填充之后。

```
(gdb) break *0x00000000004005e1 
```

程序以 650 0x41 作为参数执行，这应该足以覆盖堆栈上的返回地址。

```
(gdb) run `perl -e 'print "A"x650'` 
```

我在内存中搜索返回地址 0x00400610（我通过查看 main 的反汇编发现）。

```
(gdb) find $rsp, +1024, 0x00400610
0x7fffffffda98
1 pattern found. 
```

我用 x/200x 检查内存并得到一个很好的概述，由于它的大小，我在这里省略了它，但我可以清楚地看到表示缓冲区的合法大小的 0x42 和返回地址。

```
0x7fffffffda90: 0xffffdab0      0x00007fff      0x00400610      0x00000000 
```

strcpy() 之后的新断点：

```
(gdb) break *0x00000000004005e9
(gdb) set disassemble-next-line on
(gdb) si
19 }
=> 0x00000000004005ee <vulnerable+130>:  c9     leave  
   0x00000000004005ef <vulnerable+131>:  c3     ret    
(gdb) i r
rax            0x0      0
rbx            0x0      0
rcx            0x4141414141414141       4702111234474983745
rdx            0x414141 4276545
rsi            0x7fffffffe17a   140737488347514
rdi            0x7fffffffdb00   140737488345856
rbp            0x7fffffffda90   0x7fffffffda90
rsp            0x7fffffffd870   0x7fffffffd870
r8             0x1      1
r9             0x270    624
r10            0x6      6
r11            0x7ffff7b9fff0   140737349550064
r12            0x400410 4195344
r13            0x7fffffffdb90   140737488346000
r14            0x0      0
r15            0x0      0
rip            0x4005ee 0x4005ee <vulnerable+130>

   0x00000000004005ee <vulnerable+130>:  c9     leave  
=> 0x00000000004005ef <vulnerable+131>:  c3     ret    
(gdb) i r
rax            0x0      0
rbx            0x0      0
rcx            0x4141414141414141       4702111234474983745
rdx            0x414141 4276545
rsi            0x7fffffffe17a   140737488347514
rdi            0x7fffffffdb00   140737488345856
rbp            0x4141414141414141       0x4141414141414141
rsp            0x7fffffffda98   0x7fffffffda98
r8             0x1      1
r9             0x270    624
r10            0x6      6
r11            0x7ffff7b9fff0   140737349550064
r12            0x400410 4195344
r13            0x7fffffffdb90   140737488346000
r14            0x0      0
r15            0x0      0
rip            0x4005ef 0x4005ef <vulnerable+131>
(gdb) si

Program received signal SIGSEGV, Segmentation fault.
   0x00000000004005ee <vulnerable+130>:  c9     leave  
=> 0x00000000004005ef <vulnerable+131>:  c3     ret    
(gdb) i r
rax            0x0      0
rbx            0x0      0
rcx            0x4141414141414141       4702111234474983745
rdx            0x414141 4276545
rsi            0x7fffffffe17a   140737488347514
rdi            0x7fffffffdb00   140737488345856
rbp            0x4141414141414141       0x4141414141414141
rsp            0x7fffffffda98   0x7fffffffda98
r8             0x1      1
r9             0x270    624
r10            0x6      6
r11            0x7ffff7b9fff0   140737349550064
r12            0x400410 4195344
r13            0x7fffffffdb90   140737488346000
r14            0x0      0
r15            0x0      0
rip            0x4005ef 0x4005ef <vulnerable+131> 
```

我确认返回地址已被覆盖，并且我应该期望看到 RIP 被设置为该地址：

```
(gdb) x/4x 0x7fffffffda90
0x7fffffffda90: 0x41414141      0x41414141      0x41414141      0x41414141
(gdb) x/4x $rsp          
0x7fffffffda98: 0x41414141      0x41414141      0x41414141      0x41414141 
```

然而 RIP 显然是：

```
rip            0x4005ef 0x4005ef <vulnerable+131> 
```

为什么 RIP 没有像我预期的那样更新？LEAVEQ 和 RETQ 在 64 位上真正做了什么？简而言之，我在这里缺少什么？我试图在编译时省略编译器参数只是为了看看它是否有任何区别，它似乎没有任何区别。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T22:08:41.640

这两个指令正在做你期望他们做的事情。您已经用 's 覆盖了先前的堆栈帧，`0x41`因此当您点击 时`leaveq`，您正在执行以下操作：

```
mov rsp, rbp
pop rpb 
```

现在`rsp`指向`rbp`以前做过的地方。但是，您已经覆盖了该内存区域，因此当您执行 时`pop rbp`，硬件实际上是在执行此操作

```
mov rbp, [rsp]
add rsp,1 
```

不过`[rsp]`现在有了`0x41`。所以这就是为什么你会看到`rbp`充满了这个价值。

至于为什么`rip`没有像您期望的那样设置，这是因为`ret`设置了`rip`to`0x41`然后在指令获取时生成异常（页面错误）。在这种情况下，我不会依赖 GDB 来展示正确的东西。您应该尝试用程序文本段中的有效地址覆盖返回值，您可能不会看到这种奇怪的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-24T15:33:21.947

“kch”和“import os.boom.headshot”给出的答案并不完全正确。

实际发生的情况是堆栈上的值 (0x4141414141414141) 将由 RET 指令弹出到 RIP 中包含一个位于处理器“非规范”地址范围内的地址。这会导致 CPU 生成一般保护故障 (GPF) 中断，而不是内核预检查生成的故障。GPF 反过来触发内核在 RIP 实际更新之前报告分段错误，这就是您在 GDB 中看到的情况。

大多数现代 CPU 仅提供 48 位地址范围，该地址范围分为上半部分和下半部分，分别占据地址范围 0x0000000000000000 到 0x00007FFFFFFFFFFF 和 0xFFFF800000000 到 0xFFFFFFFFFFFFFFFF。有关更多信息，请参阅[此维基百科链接](http://en.wikipedia.org/wiki/X86-64#Canonical_form_addresses)。

如果地址超出了非规范范围（0x00008FFFFFFFFFFF 到 0xFFFF7FFFFFFFFFFF），那么 RIP 将按预期更新。当然，如果新地址由于任何其他原因（即超出进程的地址范围）无效，则内核可能会生成后续故障。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-15T04:36:46.223

在 x32 上出现 EIP 0×41414141 崩溃的原因是，当程序将先前保存的 EIP 值从堆栈中弹出并返回 EIP 时，CPU 会尝试在内存地址 0×41414141 处执行指令，这会导致段错误。（当然它必须在执行之前获取页面）

现在，在 x64 执行期间，当程序将先前保存的 RIP 值弹出回 RIP 寄存器时，内核会尝试执行内存地址 0×4141414141414141 处的指令。首先，由于规范形式的寻址，任何虚拟地址的第 48 位到第 63 位都必须是第 47 位的副本（以类似于符号扩展的方式），否则处理器将引发异常。如果这不是问题——内核在调用页面错误处理程序之前会进行额外的检查，因为最大用户空间地址是 0x00007FFFFFFFFFF。

回顾一下，在 x32 架构中，地址在没有任何“验证”的情况下传递给页面错误处理程序，该处理程序尝试加载触发内核发送程序段错误的页面，但 x64 并没有做到这一点。

测试它，用 0×0000414141414141 覆盖 RIP，你会看到预期值被放置在 RIP 中，因为内核通过了预检查，然后像 x32 情况一样调用了页面错误处理程序（当然，这会导致程序碰撞）。

# apache-flex - Flex 使用 ItemRenderer 类在自定义项渲染器中实现 IDropInListItemRenderer

> ID：11506800
> 
> 赞同：0
> 
> 时间：2012-07-16T14:48:51.843
> 
> 标签：apache-flex, itemrenderer

我在 Flex 中为 DataGrid 制作了一个自定义 ItemRenderer。我的问题是，我需要能够使用 listData，这样我才能弄清楚 ItemRenderer 所在的当前行。不过，我似乎无法正确实现 IDropInListItemRenderer，因为无论什么 listData 对我来说总是空的。

这是我在顶部的代码：

```
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009"xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:s="library://ns.adobe.com/flex/spark" autoDrawBackground="false" styleName="gRenderer" dataChange="setStates()" implements=" mx.controls.listClasses.IDropInListItemRenderer"> 
```

然后我有：

```
 private var _listData:BaseListData; 
```

然后我有：

```
public function get listData():BaseListData {
        return this._listData;
    }

    public function set listData( value:BaseListData ):void {
        this._listData = value;
    } 
```

但是然后在我的设置数据方法中，我尝试这样做：

```
 override public function set data( value:Object ):void {
        super.data = value;
       var row : int = listData.rowIndex;
    } 
```

但是在运行时它会抛出一个错误，说明它正在尝试访问空对象的属性。在我的调试器中，我可以看到 listData 为空。我不知道为什么。从我在网上到处阅读的内容来看，我似乎正在做所有需要的事情。我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:26:44.163

看起来您正在为 spark 数据网格构建自定义 ItemRenderer。如果是这样，请使用 s:GridItemRenderer，而不是使用基类 s:ItemRenderer。您可以引用 rowIndex 的公共属性。

```
override public function set data( value:Object ):void {
    super.data = value;
    trace(rowIndex);
} 
```

# javascript - 按字符位置内换行文本元素

> ID：11506804
> 
> 赞同：0
> 
> 时间：2012-07-16T14:49:04.993
> 
> 标签：javascript, jquery, dom

我正在尝试根据给定的起始偏移量和长度将子元素添加到另一个元素。例子：

```
<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit,
sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p> 
```

给定的起始偏移量为 6 个字符，长度为 20 个字符，我想用 span 元素对父元素 (p) 进行内部包装。

```
<p>Lorem <span>ipsum dolor sit amet</span>,
consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt
ut laoreet dolore magna aliquam erat volutpat. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:53:47.257

您有一个文本节点，您可以使用以下方法拆分它：http [`splitText`](https://developer.mozilla.org/en/DOM/Text.splitText): [//jsfiddle.net/VNY2k/](http://jsfiddle.net/VNY2k/)。

如果您有一个文本节点`node`和拆分索引`n`，`node.splitText(n)`则将*修改* `node`为仅包含`node`该索引之前的文本，并*返回*一个带有其余文本的新文本节点。

```
var node1 = ​$("p").contents()[0];  // whole text node
var node2 = node1.splitText(6);    // right of splitting point #1
var node3 = node2.splitText(20);   // right of splitting point #2
$(node2).wrap("<span>");           // node2 will contain the text
                                   // you want to wrap: right of #1
                                   // and left of #2 
```

请注意，您不能编辑文本节点本身以包含`<span>`. 一个文本节点实际上只包含文本，而一个元素（例如`<span>`）本身就是一个节点。因此，您需要拆分文本节点。

# delphi - TFileStream 和使用 String 操作

> ID：11506805
> 
> 赞同：2
> 
> 时间：2012-07-16T14:49:07.607
> 
> 标签：delphi, tfilestream

我正在尝试使用 TFileStream 编写和读取非固定字符串。我收到*访问冲突*错误。这是我的代码：

```
// Saving a file
  (...)
  count:=p.Tags.Count; // Number of lines to save (Tags is a TStringList)
  FS.Write(count, SizeOf(integer));
  for j := 0 to p.Tags.Count-1 do
  begin
    str:=p.Tags.Strings[j];
    tmp:=Length(str)*SizeOf(char);
    FS.Write(tmp, SizeOf(Integer));
    FS.Write(str[1], Length(str)*SizeOf(char));
  end;

// Loading a file
  (...)
  p.Tags.Add('hoho'); // Check if Tags is created. This doesn't throw an error.
  Read(TagsCount, SizeOf(integer)); // Number of lines to read
  for j := 0 to TagsCount-1 do
  begin
    Read(len, SizeOf(Integer)); // length of this line of text
    SetLength(str, len); // don't know if I have to do this
    Read(str, len); // No error, but str has "inaccessible value" in watch list
    p.Tags.Add(str); // Throws error
  end; 
```

该文件似乎保存得很好，当我用十六进制编辑器打开它时，我可以找到保存在那里的正确字符串，但是加载会引发错误。

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T14:53:50.453

您保存*字节*数，这就是您写入的*字节数。*当您读取该值时，您将其视为*字符*数，然后读取那么多*字节*。不过，这不会导致您现在看到的问题，因为您正在使缓冲区*大于*Delphi 2009 所需的大小。

问题是您正在读取字符串变量，而不是字符串的内容。你`str[1]`写的时候用过；阅读时也这样做。否则，您将覆盖调用时分配的字符串引用`SetLength`。

```
Read(nBytes, SizeOf(Integer));
nChars := nBytes div SieOf(Char);
SetLength(str, nChars);
Read(str[1], nBytes); 
```

是的，您*确实*需要致电`SetLength`. `Read`不知道它读到了什么，所以它无法知道它需要提前将大小设置为任何东西。

# asp.net - ASP.NET 内存泄漏 - OracleCommand 对象

> ID：11506807
> 
> 赞同：2
> 
> 时间：2012-07-16T14:49:19.713
> 
> 标签：asp.net, debugging, windbg

我有内存泄漏，我很难找出问题所在。ASP.NET 进程时不时地增加到 1GB。我已按照此页面 (http://humblecoder.co.uk/tag/windbg) 上的说明进行操作，!gcroot 命令返回以下内容（最后 x 行）。我查看了所有 OracleConnections 和 OracleCommands，它们似乎已正确关闭和处置：

```
 6523dfd4      282        28200 System.Data.SqlClient.SqlParameter
    0e90d850      548        28496 System.IO.MemoryStream
    67b71a0c     1461        29220 System.Transactions.SafeIUnknown
    7a5ee588     1924        30784 System.Collections.Specialized.ListDictionary+NodeKeyValueCollection
    648c91f4      665        31920 System.Configuration.ConfigurationValues
    7a5e5d04     1342        32208 System.Threading.Semaphore
    652410f8      670        34840 System.Data.ProviderBase.DbConnectionPool+PoolWaitHandles
    6613228c     1319        36932 System.Web.Security.FileSecurityDescriptorWrapper
    66106948     2449        39184 System.Web.UI.AttributeCollection
    0e8ff780     2021        40420 Microsoft.Win32.SafeHandles.SafeLsaPolicyHandle
    01e34730      336        43008 Oracle.DataAccess.Client.OracleDataReader
    648c9434     2218        44360 System.Configuration.ConfigurationValue
    7a5ea0e4     1918        46032 System.Collections.Specialized.ListDictionary+NodeKeyValueCollection+NodeKeyValueEnumerator
    7a5eaaa8     3088        49408 System.Collections.Specialized.NameObjectCollectionBase+NameObjectEntry
    652435c4     1138        59176 System.Data.SqlClient.SqlBuffer
    0e912c9c     2491        59784 System.Collections.ArrayList
    0e9132c0     1236        69216 System.Collections.Hashtable
    6614bf64       45        69660 System.Web.Caching.ExpiresEntry[]
    0e8ff7d8     4042        80840 Microsoft.Win32.SafeHandles.SafeLsaMemoryHandle
    66105ff4     5434        86944 System.Web.UI.StateBag
    01e364c8     5686        90976 Oracle.DataAccess.Client.OpoSqlValTimeoutCtx
    0e912e08     1007        91556 System.Int32[]
    7a5ee300     3942        94608 System.Collections.Specialized.ListDictionary+NodeEnumerator
    01e35ef8     7918        95016 Oracle.DataAccess.Client.OpoSqlRefCtx
    01e353bc     6043        96688 Oracle.DataAccess.Client.MetaData
    0e8f83e8     5017       100340 Microsoft.Win32.SafeHandles.SafeLocalAllocHandle
    7a5ef738     6284       125680 System.Collections.Specialized.HybridDictionary
    7a5ef7f4     5143       144004 System.Collections.Specialized.ListDictionary
    661060d0    10908       174528 System.Web.UI.StateItem
    0e91189c      533       184492 System.Char[]
    6610d15c     2426       203784 System.Web.UI.WebControls.TableCell
    01e362ec     7918       221704 Oracle.DataAccess.Client.OracleXmlQueryProperties
    7a5ef8b4    11231       224620 System.Collections.Specialized.ListDictionary+DictionaryNode
    65242390     1814       232192 System.Data.SqlClient._SqlMetaData
    0e8f832c    12124       242480 Microsoft.Win32.SafeHandles.SafeTokenHandle
    01e36444     7918       253376 Oracle.DataAccess.Client.OracleXmlSaveProperties
    0e8f7ca8    13394       267880 Microsoft.Win32.SafeHandles.SafeWaitHandle
    0e9133bc     1255       267912 System.Collections.Hashtable+bucket[]
    0e8f7a98    12048       289152 System.Threading.ManualResetEvent
    0e8e443c     7886       385508 System.Object[]
    01e34b60     6456       387360 Oracle.DataAccess.Client.OpoConRefCtx
    01e33860     6432       668928 Oracle.DataAccess.Client.OracleConnection
    01e34f9c     6439       824192 Oracle.DataAccess.Client.OpoConCtx
    01e34038     7918      1171864 Oracle.DataAccess.Client.OracleCommand
    000dfbe0       70      5839608      Free
    0e9136dc     2622     17492932 System.Byte[]
    0e910c6c    56049     19472876 System.String
    Total 283875 objects 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T07:53:05.680

如果一段时间后内存使用量下降到 200 MB，这表明您的内存正在被收集，但您仍然可能存在内存误用问题。这个转储没有显示很多，但如果它是在进程为 1GB 时采取的，如你所说，你仍然可以使用它：1）在几个对象上使用 !gcroot，看看它们是如何附加到内存的（我会检查数据库使用情况，似乎你有大量的 oracle 连接（6432），还有很多其他的数据库东西。）像这样：

```
!dumpheap -MT <mt = the left most number> 
```

对象将显示内存地址

```
!gcroot <address> 
```

对象堆栈将显示对象如何附加到内存树。 [此过程的示例](http://blogs.msdn.com/b/delay/archive/2009/03/11/where-s-your-leak-at-using-windbg-sos-and-gcroot-to-diagnose-a-net-memory-leak.aspx)

2）检查性能计数器（start->run->perfmon）添加这些计数器： - .Net Clr Memory-> #bytes all heaps - Process->private bytes 计算它们之间的差异 - 这是非托管资源消耗的内存（像 DB 客户端对象）在低内存和高内存情况下检查这一点，您将看到内存消耗主要是由于托管内存（所有堆）还是非托管内存。3）如果内存是非托管的，它仍然可能由托管对象持有，因为主应用程序是托管的，因此确保在完成非托管资源后释放它们是关键。（关闭 DBConnections、处理 DBCommands、关闭文件句柄、释放 COMObjects 等）

希望这会有所帮助，阿米特。

# registry - WSO2 ESB 对治理注册表的依赖

> ID：11506812
> 
> 赞同：0
> 
> 时间：2012-07-16T14:49:29.660
> 
> 标签：registry, wso2, wso2esb, soa

如果 WSO2 ESB 与远程治理存储库集成，并且治理注册表崩溃，ESB 是否会检测到这一点并且在存储库恢复之前不刷新缓存？

并且任何人都知道有人在生产中结合 ESB 使用治理存储库的用例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T12:12:15.477

如果您不使用对注册表 API 的编程访问，则没有问题。ESB 直接访问 GREG 数据库。

# c# - 嵌入式资源以项目名称为前缀

> ID：11506813
> 
> 赞同：1
> 
> 时间：2012-07-16T14:49:30.880
> 
> 标签：c#, .net, resources

我正在使用一个名为“MyApp”的项目，所有嵌入式资源都像“MyApp.Sdk.System”一样发布到dll中，而不仅仅是我想要的“Sdk.System”。

如何在资源路径中省略项目名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:15:43.930

您是否检查了项目属性中的“默认命名空间”选项？您可以在那里更改影响命名方案如何与嵌入式资源一起使用的内容。

**编辑**有关嵌入式资源的命名约定， 请参阅[此](http://www.codeproject.com/Articles/3089/Understanding-Embedded-Resources-in-Visual-Studio)链接。

# javascript - 原型 - var x = [] - 将函数添加到 x

> ID：11506814
> 
> 赞同：3
> 
> 时间：2012-07-16T14:49:48.063
> 
> 标签：javascript, jquery, prototypejs

我是 Prototype 的新手，但我总是使用 jQuery。我有一个需要使用 jQuery 和 Prototype 的网站。我在使用以下代码时遇到问题：

```
var x = [];
console.log(x);
for (var l in x)
{
console.log(l);
} 
```

运行此代码，x 包含以下内容：

```
    每个
    每片
    全部
    任何
    搜集
    探测
    找到所有
    选择
    grep
    包括
    成员
    inGroupsOf
    注入
    调用
    最大限度
    分钟
    分割
    采摘
    拒绝
    排序方式
    数组
    条目
    压缩
    尺寸
    检查
    寻找
    _撤销
    _每个
    清除
    第一的
    最后的
    袖珍的
    展平
    没有
    独特的
    相交
    克隆

```

预期结果（无原型）：

```
没有子对象

```

Prototype 这样做的任何原因，以及如何阻止它？！

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:51:40.210

你不应该使用[`for...in`](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for...in)数组，这正是原因。

`for...in`循环遍历对象的所有属性。这包括其属性（在本例中为数组索引），以及添加到`prototype`.

对于数组，只需使用普通[`for`](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for)循环。

```
var x = [];
console.log(x);
for(var i = 0, len = x.length; i<len; i++){
    console.log(i, x[i]);
} 
```

注意：我这样做`var i = 0, len = x.length`是因为它只`length`从数组中抓取一次，而不是每次迭代。它*可能*会更快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T14:52:20.333

你不应该`for..in`在数组上使用，你应该使用`for( i=0; i<length; i++)`. 但除此之外：

```
for( l in x) {
    if( x.hasOwnProperty(l)) {
        // l is a property of your object
    }
} 
```

这基本上忽略了循环的原型链。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T15:07:03.630

使用时，`for ... in`您将枚举数组的所有（可枚举）*属性*，而不仅仅是数字索引。

由于 Prototype.js 向其中添加了许多新函数`Array.prototype`并且未能将它们标记为不可枚举，因此它们也都出现在属性列表中。

# jquery - jQuery - 在选择时减去数据的值

> ID：11506816
> 
> 赞同：0
> 
> 时间：2012-07-16T14:49:55.837
> 
> 标签：jquery, variables, var, addition

我想知道是否可以在选择下拉列表时添加一个值。

例如：如果选择以下之一。.

```
<select class="item_print-colour">
    <option value="0" selected="selected" disabled="disabled">Print Colour..</option>
    <option value="B&W" value="Print Colour:"> Black And White </option>
    <option value="Full-Colour"> Full Colour </option>
</select> 
```

我希望将以下 data-base_price 增加 0.20：

```
<span class="item_price cd_price" data-base_price="0.53"></span> 
```

**我已经尝试过** ，但无论我尝试什么，我都无法在选择时改变它：

```
$(".item_print-colour").on("select", function() {
    var base_price = $(".cd_price").data("base_price");
    var addition = 0;

    if (this.value = B&W) addition = 0.20;
    $(".cd_price").text((base_price + addition).toFixed(2));
    }).trigger("select"); 
```

**编辑**

我还有其他因素决定了 data-base_price，这就是为什么我试图添加到当前 data-base_price 中的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:54:17.317

*   `on('change'...`不选择
*   `if(this.value == 'B&W')`
*   您可以重构为：`base_price += 0.2;`
*   你不需要`trigger('select');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:56:49.110

尝试以下操作：

```
$(".dvd_case_quantity").on("change", function() {
    var base_price = $(".cd_price").data("base_price");
    var addition = (this.value == 'B&W' ? 0.20 : 0);
    var newPrice = (base_price + addition).toFixed(2);
    $(".cd_price").text(newPrice);
}); 
```

注意：上述解决方案将 分隔`newPrice`成一个单独的变量。您可以保持原样，但我尝试采用更易于调试的风格，这将使测试更加容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T14:51:54.560

也许你只是错过了报价？

```
if (this.value == "B&W")
... 
```

# php - 让 PHP 显示单选按钮信息

> ID：11506817
> 
> 赞同：0
> 
> 时间：2012-07-16T14:49:58.340
> 
> 标签：php, radio-button

我想要几个单选按钮来显示动态网页的信息。我有（在 PHP 中）：

```
echo '
    <html>
        <head>
            <title> Dynamic PHP </title>
        </head>
        <body>
            <form action="dynamic.php" method="get">
                <input type="radio" name="dynamic" value="home" checked> Home </br>
                <input type="radio" name="dynamic" value="site1"> Site 1 </br>
                <input type="radio" name="dynamic" value="site2"> Site 2
            </form>

        </body>
    </html>
';

if (isset($_GET["home"])){
    echo "Home";
}
if (isset($_GET["site1"])){
    echo "Site 1";
}
if (isset($_GET["site2"])){
    echo "Site 2";
} 
```

我没有收到任何错误，但也没有任何反应。非常感谢。

编辑：这就像我要问的：[php中的单选按钮值](https://stackoverflow.com/questions/2580614/radio-button-value-in-php)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T14:53:13.217

因为您的单选按钮的名称属性设置为“动态”，所以我想您必须尝试以下操作：

```
if(isset($_GET["dynamic"])) {
    // do something here
    echo $_GET["dynamic"];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:43:06.123

PHP 通过它们的“名称”属性访问表单变量，而不是它们的“值”属性。为了检索所选单选按钮的值，您可以使用`$_GET['dynamic']`and not `$_GET['home']`or `$_GET['site1']`or `$_GET['site2']`。

所以假设这个页面被称为dynamic.php，你的代码来回显所选页面将是：

```
if(!empty($_GET['dynamic'])){

    echo $_GET['dynamic'];

} 
```

希望这可以帮助！

编辑：为了回显所选选项：

```
<?php 
if(!empty($_GET['dynamic'])){
      $selected = $_GET['dynamic'];
}
else{
      //if no option was selected, set home as default
      $selected = 'home';
}
?>

<form action="dynamic.php" method="get">
         <input type="radio" name="dynamic" value="home"  /> Home <?php echo ($selected == 'home' ? 'This was selected!' : '');?> </br>
         <input type="radio" name="dynamic" value="site1" /> Site 1 <?php echo ($selected == 'site1' ? 'This was selected!' : '');?> </br>
         <input type="radio" name="dynamic" value="site2" /> Site 2 <?php echo ($selected == 'site2' ? 'This was selected!' : '');?> </br>
</form> 
```

# python - Python非重复循环

> ID：11506819
> 
> 赞同：0
> 
> 时间：2012-07-16T14:50:02.950
> 
> 标签：python, loops

我想将 5 点（A、B、C、D、E）与线连接起来。

使用 For Loop 很容易实现，但会有重复链接（AB = BA）。

任何人有想法防止它发生？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T14:51:27.273

使用[`itertools.combinations`](http://docs.python.org/library/itertools.html#itertools.combinations)：

```
import itertools as it
points = ('A', 'B', 'C', 'D', 'E')
for pt1, pt2 in it.combinations(points, 2):
    print '{0}-{1}'.format(pt1, pt2) 
```

印刷

```
A-B
A-C
A-D
A-E
B-C
B-D
B-E
C-D
C-E
D-E 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T14:54:04.040

您可以修改内部循环以仅迭代剩余的项目：

```
points = ['A', 'B', 'C', 'D', 'E']
for i, x in enumerate(points):
    for y in points[i + 1:]:
        print x, y 
```

# sql - 运行时错误 3061 帮助（毫秒访问）

> ID：11506820
> 
> 赞同：1
> 
> 时间：2012-07-16T14:50:04.090
> 
> 标签：sql, ms-access, runtime-error, recordset

我一直在绞尽脑汁试图找出这个查询有什么问题，但我只是看不到它。我正在尝试打开一个记录集，但我不断收到运行时错误 3061：“参数太少：预期为 1。”

这是我的代码...

```
Dim ansRs As Recordset
Dim qRs As Recordset
Dim ansQuery As String
Dim qQuery As String
Dim i As Integer

qQuery = "Select * From TrainingQuizQuestions Where TrainingQuizID = (Select TrainingQuiz.TrainingQuizID From TrainingQuiz Where QuizName = Forms!MainMenu!txtVidName);"
ansQuery = "Select * From TrainingQuizQuestAns"
Set qRs = CurrentDb().OpenRecordset(qQuery)
Set ansRs = CurrentDb().OpenRecordset(ansQuery) 
```

我从“Set qRs = CurrentDb().OpenRecordset(qQuery)”行收到错误消息。我将该查询复制并粘贴到访问中并运行它，它准确地返回了我想要在我的记录集中获得的内容，但是当我在 VBA 中运行它时出现错误。我错过了一些非常简单的东西吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:53:39.737

首先确保您的表单是打开的，然后将表单参考放在引号之外。

```
 qQuery = "Select * From TrainingQuizQuestions Where TrainingQuizID = " _
   & "(Select TrainingQuiz.TrainingQuizID From TrainingQuiz Where QuizName = '" _
   & Forms!MainMenu!txtVidName) & "';" 
```

表单值不可用于 VBA 中使用的记录集。

# c++ - 如何在 C++ 中调用带有参数和用户控制台输入的函数？

> ID：11506821
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:50:08.317
> 
> 标签：c++, function, console

这是 C++ 控制台片段。

我希望根据用户输入在几个函数中调用一个保存参数的函数。

例如：

```
#include<iostream>
using namespace std;

void Add (int x, int y)
    {
        cout << x + y << endl;
    }

void Subs (int x, int y)
    {
        cout << x - y << endl;
    }

int main(int argc, char* argv[])
{
    // Variable initialization
    char calc_type;
    int x;
    int y;

    // Console input
    cout << "Add or Substract (a or s)?" << endl;
    cin >> calc_type;
    cout << "1st number" << endl;
    cin >> x;
    cout << "2nd number" << endl;
    inc >> y;

    if (calc_type == "a")
    {
        Add(x, y);
    }
    else
    {
        Subs(x, y);
    }

return 0;

} 
```

但是在写这篇文章时，我返回了如下错误消息：

**错误 C2446：“==”：没有从“const char *”到“int”的转换**

**没有可以进行这种转换的上下文**

**错误 C2040：“==”：“int”与“const char [2]”的间接级别不同**

我该如何解决这个问题（也许引用或指针是首选？？？）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:52:29.503

`calc_type`是一个`char`变量。常数“a”是一个字符串。在 C 中，char 常量用单引号括起来，而不是用双引号括起来。所以改写为：

```
if (calc_type == 'a') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T14:51:17.770

对字符文字使用单引号。

```
if (calc_type == "a") 
```

这里的双引号表示的`"a"`是字符串字面量，表示它的类型为`const char[2]`( `{'a', '\0'}`)。`calc_type`是 a `char`，所以类型不匹配。`'a'`, 另一方面，有一个字符类型，你可以很好地比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:51:41.210

也许你的意思是：

```
calc_type == 'a' 
```

代替

```
calc_type == "a" 
```

因为`calc_type`是 a`char`并且`"a"`是 a `const char*`?

# playframework - 可以像这样播放 2.x 匹配动态网址

> ID：11506823
> 
> 赞同：2
> 
> 时间：2012-07-16T14:50:11.360
> 
> 标签：playframework, playframework-2.0

我知道 play 可以匹配 /something/{id}。我们想要的有点复杂，因为我可能会移植一个原型来玩，因为我真的很喜欢异步东西的能力。

我们有这样的网址

```
/services/<moduleA>/<moduleB>/.... 
```

我真正想要的是这样的模式

```
/services/{capture-all-of the modules} 
```

在现有系统中，将有 10 个模块，可能是 3 个，但客户端决定如何将模块连接在一起，并且返回的数据基于该 url 通过每个模块进行管道传输。在 playframework 中是否有这样做的潜力？

谢谢，院长

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T15:39:11.120

您可以捕获所有以 /services/ 开头的 URL 并创建自己的 requestDispatcher（未测试）：

```
//routes
GET     /services/*toBeRouted    controllers.Dispatcher.dispatch(toBeRouted: String)

//Dispatcher object
def dispatch(toBeRouted: String) = Action { implicit request => 
    toBeRouted.split("/") match {
        case Nil => BadRequest(views.html.default.wrongModule())
        case _ => {
            ...//Route to the right controller
        }
    }
} 
```

**重要提示：**跨越多个斜杠的路径规则必须带有星号而不是冒号：`*toBeRouted`

您可以更进一步，使用[regexp仅在路由文件中捕获有效模式](http://www.playframework.org/documentation/2.0/ScalaRouting)

# c# - 如果 web.config 丢失或损坏，防止 YSOD？

> ID：11506824
> 
> 赞同：2
> 
> 时间：2012-07-16T14:50:13.903
> 
> 标签：c#, asp.net

是否有可能捕获从 asp.net 应用程序的 web.config 丢失/损坏/损坏发生的 YSOD 并实际显示更有用的有意义的消息，这可能有助于用户解决问题。

最近使用 WordPress，当我不小心删除了 wp_congif.php 文件时，它显示了一个可爱的错误消息。我喜欢它如何检测、处理它、继续运行并告诉我我可能做了什么以及如何修复它。确实想知道在实时站点上以及在部署时进行完整性检查等。

考虑使用自定义错误捕获，但我不确定它是否会工作，因为没有 web.config 应用程序甚至会运行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T14:56:35.023

这必须在 IIS 配置级别发生，因为如果没有有效的 web.config，应用程序会在处理异常之前引发异常。您无法从应用程序中对其进行任何操作。

如果自定义应用程序配置文件丢失/损坏，那么您的 ASP.Net 代码可以通过应用程序启动中的检测来处理它，但是如果 web.config 损坏，您将不会走得那么远（丢失，您可以通过检测在 appsettings 中寻找一个值，如果它不存在则优雅地死去）。

# python - 通过查询嵌入字段来检索字段子集

> ID：11506828
> 
> 赞同：4
> 
> 时间：2012-07-16T14:50:21.890
> 
> 标签：python, django, mongodb, django-nonrel

是否可以使用[Django mongodb nonrel](http://django-mongodb.org/)检索字段子集。我对 python 完全陌生，但对 mongo 有很好的了解。

我的要求非常直接，我想通过其嵌入字段查询集合并仅返回一些特定字段

我可以在 mongodb 中做到这一点

```
db.Contract.find({'owner.name':'Ram'},{'address':1}) 
```

我在 django 中试过这个

```
Contract.objects.filter(owner__name='Ram') 
```

但它会引发错误

> raise FieldError("Join on field %r not allowed. 你拼错了%r for the lookup type?" % (name, names[pos + 1])) FieldError: Join on field 'owner' not allowed. 您是否拼错了查找类型的“名称”？

我完全被打动了。我相信我有文档中指定的模型。

```
class SimplePerson(models.Model):
    name = models.CharField(max_length=255)
    user_key = models.CharField(max_length=255)

class Contract(models.Model):
    owner = EmbeddedModelField('SimplePerson')
    title = models.CharField(max_length=120, ) 
```

这真的很奇怪。我在文档站点中找不到有关如何查询嵌入字段和检索字段子集的任何参考。

最后我使用[raw_query](http://django-mongodb.org/reference/lowerlevel.html)来查询嵌入字段

```
Contract.objects.raw_query({'owner.name':'Ram'}) 
```

但仍然无法弄清楚如何检索字段子集。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:40:44.397

子对象过滤器尚不可用，因此您需要下拉到`raw_query`（您已经想通了）。要检索字段子集，请使用`.values('field1', 'field2', ...)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-01T08:04:06.667

现在可以使用以下语法按 EmbeddedField 进行过滤：

```
Contract.objects.filter(owner={'name': 'Ram'}) 
```

# php - 某些浏览器中 cookie 的未定义索引

> ID：11506833
> 
> 赞同：1
> 
> 时间：2012-07-16T14:50:34.027
> 
> 标签：php, javascript, postgresql, cross-browser, browser

我正在使用我在专家交换中找到的登录脚本在用户登录时制作 cookie。

登录页面流程如下：

```
function process_login() {

    var username = $.trim($('#input_username').val());
    var password = $.trim($('#input_password').val());

    username = $.trim(username);
    password = $.trim(password);
    var remember = document.getElementById("remember_user_checkbox").checked;

    if (!username || !password) {

        return false;

    }

    remember == true ? remember = "true" : remember = "false";

    $.ajax({
        type: "POST",
        cache: false,
        url: "login_user.php",
        data: "username=" + username + "&password=" + password + "&remember=" + remember,
        dataType: "json",
        success: function (data) {

            if (data == "FALSE") {

                $('#input_password').val("");

                alert("The username or password you have entered is incorrect.");

                return false;
            }

            window.location = "orders-home.php?<?=time()?>";

        }

    });

} 
```

并提交到`login-user.php`，这里：

```
<?php
include('login-config.php');
$username = pg_escape_string($_POST['username']);
$password = pg_escape_string($_POST['password']);

//no encryption for now

//php gets this as a string
$remember = $_POST['remember'];

if ( $remember == "true" )
{
    $remember = TRUE;   
}
else
{
    $remember = FALSE;  
}

$user_query = "SELECT * FROM users WHERE username = '$username' AND password = '$password' LIMIT 1";

$user_result = pg_query( $con , $user_query );

if ( !$user_result )
{
    echo json_encode("FALSE");  
}

$arr = array();

if (!$user_result)
{
die( pg_last_error($con) );
}
else
{ 

       while ( $row = pg_fetch_array($user_result) )
       {

          //put the customer id in a session so we can put it in a cookie later
          //then when the page is refreshed the stored customer id will be used
          //as their ksisoldby identifier
          if ( $row['cust_id'] )
          {
             $_SESSION['customer_id'] = $row['cust_id'];
             $_SESSION['customer_name'] = $row['first_name']." ".$row['last_name'];
             $_SESSION['uid'] = $row['id'];

             if ( $remember )
             {
                remember_user($row["id"]);
             }
          }

         $arr[] = array(

         "first_name"          =>$row['first_name'],
         "last_name"           =>$row['last_name'],
         "customer_id"         =>$row['cust_id'],
         "accepted_terms"      =>$row['accepted_terms'],
         );   
       }

}

if ( empty($arr) ){
echo json_encode('FALSE');
}
else
{

    $path = '/webtrack';
    $site = 'www.isco.net';

    if ($remember === TRUE)
    {
         $remember_time =  time()+60*60*24*30;

         setcookie('username', $username, $remember_time, $path, $site);
         setcookie('customer_id', $_SESSION['customer_id'], $remember_time, $path, $site);
         setcookie('customer_name', $_SESSION['customer_name'], $remember_time, $path, $site);
        // setcookie('uuk', $uuk, $remember_time, $path, $site);

    }
    else
    {
         setcookie('username', $username, false, $path, $site);
         setcookie('customer_id', $_SESSION['customer_id'], false, $path, $site);
         setcookie('customer_name', $_SESSION['customer_name'], false, $path, $site);

    }

echo json_encode($arr);

}
?> 
```

然后我从那个 cookie 打印到主屏幕上

```
<div class="fl customer_id">
    <?= strtoupper($_COOKIE['customer_name']); ?>
</div> 
```

但我得到了错误

`Notice: Undefined index: customer_name in /home/iscotest/public_html/webtrack/orders-home.php`

实际站点是 www.isco.net。但该网站托管在 iscotest.com。isco.net 只是指向 iscotest.com。这可能是我的 cookie 没有被设置的原因吗？

这是一个相当大的问题，因为这完全停止了页面的加载，因为该 cookie 信息用于检索显示的数据

另一个奇怪的事情是，这个错误并没有始终如一地出现。我在一台计算机上的 safari 和 chrome 上出现错误，但该站点在 safari 和 chrome 的另一台计算机上正常运行。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:02:45.737

当您使用 setcookie() 创建一个 COOKIE 时，它只会在另一个页面上可用。因此，这可能是您的 AJAX 的问题。

# azure - azure - linux虚拟机卡在“停止”

> ID：11506836
> 
> 赞同：0
> 
> 时间：2012-07-16T14:50:55.307
> 
> 标签：azure, restart, azure-virtual-machine, hung

我一直在使用我的 msdn 帐户试验 azure 服务。我创建了一个 suse 企业 linux 虚拟机。部署了 sonar+mysql 和一些简单的 java 应用程序。近一个月一切都很好，直到上周末。我尝试通过 ssh 连接，但无法得到响应。我尝试访问声纳网站，再次没有响应。我使用axure门户重新启动了vm，它似乎重新启动但仍然没有响应。我使用 azure 门户停止服务。它的状态已经“停止”了好几天。关于我可以做些什么来恢复连接有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:04:53.737

很有可能是您的虚拟机中的某些东西导致了此问题，最好的办法是将此问题报告给以下与 Windows Azure Linux 虚拟机相关的专用论坛，以便您获得适当的帮助来解决您的问题：

[http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforLinux/threads](http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforLinux/threads)

# php - 在 Yii 中保存多个子模型

> ID：11506838
> 
> 赞同：1
> 
> 时间：2012-07-16T14:50:58.367
> 
> 标签：php, yii

**注意：**在 SO 上还有其他与此相关的问题，但没有一个真正为我回答。我不担心服务器端，因为有很多方法可以处理保存相关模型信息（以及如何执行此操作的大量示例）。

我需要知道的是：如何实现视图代码以在创建父模型时添加许多子模型？

它肯定会像在这个页面上看到的那样：[http](http://www.yiiframework.com/doc/guide/1.1/en/form.table) ://www.yiiframework.com/doc/guide/1.1/en/form.table 。除了代码处理一堆模型的**更新，而不是它们的****插入**。这就是我需要的。

简而言之，我有一个事件表单，用户可以在其中添加许多约会（每个约会都有一天，start_time 和 end_time）。我想使用 Yii 助手在事件表单中呈现约会字段，以便获得验证和其他框架优势。

用户将能够在创建事件时为同一事件添加多个约会。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-07T10:59:05.667

## 这是完整的解决方案，享受yii的力量！

[http://scriptbaker.com/how-to-save-multiple-related-models-in-yii-complete-solution/](http://scriptbaker.com/how-to-save-multiple-related-models-in-yii-complete-solution/)

**表结构：**

```
CREATE TABLE IF NOT EXISTS `fathers` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `children` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `father_id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `age` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `father_id` (`father_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

ALTER TABLE `children`
  ADD CONSTRAINT `children_ibfk_1` FOREIGN KEY (`father_id`) REFERENCES `fathers` (`id`) ON DELETE CASCADE; 
```

**父亲型号：**

```
/**
 * This is the model class for table "fathers".
 *
 * The followings are the available columns in table 'fathers':
 * @property integer $id
 * @property string $name
 *
 * The followings are the available model relations:
 * @property Children[] $childrens
 */
class Father extends CActiveRecord
{

    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Father the static model class
     */
    public static function model($className=__CLASS__)
    {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName()
    {
        return 'fathers';
    }

    /**
     * @return array validation rules for model attributes.
     */
    public function rules()
    {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            array('name', 'required'),
            array('name', 'length', 'max' => 255),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('id, name', 'safe', 'on' => 'search'),
        );
    }

    /**
     * @return array relational rules.
     */
    public function relations()
    {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
            'children' => array(self::HAS_MANY, 'Child', 'father_id'),
        );
    }

    /**
     * @return array customized attribute labels (name=>label)
     */
    public function attributeLabels()
    {
        return array(
            'id' => 'ID',
            'name' => 'Name',
        );
    }

    /**
     * Retrieves a list of models based on the current search/filter conditions.
     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.
     */
    public function search()
    {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria = new CDbCriteria;

        $criteria->compare('id', $this->id);
        $criteria->compare('name', $this->name, true);

        return new CActiveDataProvider($this, array(
                    'criteria' => $criteria,
                ));
    }

    public function behaviors()
    {
        return array('ESaveRelatedBehavior' => array(
                'class' => 'application.components.ESaveRelatedBehavior')
        );
    }

} 
```

**儿童型号：**

```
<?php

/**
 * This is the model class for table "children".
 *
 * The followings are the available columns in table 'children':
 * @property integer $id
 * @property integer $father_id
 * @property string $name
 * @property integer $age
 *
 * The followings are the available model relations:
 * @property Fathers $father
 */
class Child extends CActiveRecord
{

    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Child the static model class
     */
    public static function model($className=__CLASS__)
    {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName()
    {
        return 'children';
    }

    /**
     * @return array validation rules for model attributes.
     */
    public function rules()
    {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            array('father_id, name, age', 'required'),
            array('father_id, age', 'numerical', 'integerOnly' => true),
            array('name', 'length', 'max' => 255),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('id, father_id, name, age', 'safe', 'on' => 'search'),
        );
    }

    /**
     * @return array relational rules.
     */
    public function relations()
    {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
            'father' => array(self::BELONGS_TO, 'Father', 'father_id'),
        );
    }

    /**
     * @return array customized attribute labels (name=>label)
     */
    public function attributeLabels()
    {
        return array(
            'id' => 'ID',
            'father_id' => 'Father',
            'name' => 'Name',
            'age' => 'Age',
        );
    }

    /**
     * Retrieves a list of models based on the current search/filter conditions.
     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.
     */
    public function search()
    {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria = new CDbCriteria;

        $criteria->compare('id', $this->id);
        $criteria->compare('father_id', $this->father_id);
        $criteria->compare('name', $this->name, true);
        $criteria->compare('age', $this->age);

        return new CActiveDataProvider($this, array(
                    'criteria' => $criteria,
                ));
    }

} 
```

**父亲控制器：**

```
<?php

class FatherController extends Controller
{

    /**
     * @var string the default layout for the views. Defaults to '//layouts/column2', meaning
     * using two-column layout. See 'protected/views/layouts/column2.php'.
     */
    public $layout = '//layouts/column2';

    /**
     * @return array action filters
     */
    public function filters()
    {
        return array(
            'accessControl', // perform access control for CRUD operations
            'postOnly + delete', // we only allow deletion via POST request
        );
    }

    /**
     * Specifies the access control rules.
     * This method is used by the 'accessControl' filter.
     * @return array access control rules
     */
    public function accessRules()
    {
        return array(
            array('allow', // allow all users to perform 'index' and 'view' actions
                'actions' => array('index', 'view'),
                'users' => array('*'),
            ),
            array('allow', // allow authenticated user to perform 'create' and 'update' actions
                'actions' => array('create', 'update', 'loadChildByAjax'),
                'users' => array('@'),
            ),
            array('allow', // allow admin user to perform 'admin' and 'delete' actions
                'actions' => array('admin', 'delete'),
                'users' => array('admin'),
            ),
            array('deny', // deny all users
                'users' => array('*'),
            ),
        );
    }

    /**
     * Displays a particular model.
     * @param integer $id the ID of the model to be displayed
     */
    public function actionView($id)
    {
        $this->render('view', array(
            'model' => $this->loadModel($id),
        ));
    }

    /**
     * Creates a new model.
     * If creation is successful, the browser will be redirected to the 'view' page.
     */
    public function actionCreate()
    {
        $model = new Father;

        // Uncomment the following line if AJAX validation is needed
        // $this->performAjaxValidation($model);

        if (isset($_POST['Father']))
        {
            $model->attributes = $_POST['Father'];

            if (isset($_POST['Child']))
            {
                $model->children = $_POST['Child'];
                $model->saveWithRelated('children');
            }
            if ($model->save())
                $this->redirect(array('view', 'id' => $model->id));
            else
            {
                //CVarDumper::dump($model->errors,10,1);die;
            }

        }

        $this->render('create', array(
            'model' => $model,
        ));
    }

    /**
     * Updates a particular model.
     * If update is successful, the browser will be redirected to the 'view' page.
     * @param integer $id the ID of the model to be updated
     */
    public function actionUpdate($id)
    {
        $model = $this->loadModel($id);

        // Uncomment the following line if AJAX validation is needed
        // $this->performAjaxValidation($model);

        if (isset($_POST['Father']))
        {
            $model->attributes = $_POST['Father'];
            if (isset($_POST['Child']))
            {
                $model->children = $_POST['Child'];
                $model->saveWithRelated('children');
            }
            if ($model->save())
                $this->redirect(array('view', 'id' => $model->id));
        }

        $this->render('update', array(
            'model' => $model,
        ));
    }

    /**
     * Deletes a particular model.
     * If deletion is successful, the browser will be redirected to the 'admin' page.
     * @param integer $id the ID of the model to be deleted
     */
    public function actionDelete($id)
    {
        $this->loadModel($id)->delete();

        // if AJAX request (triggered by deletion via admin grid view), we should not redirect the browser
        if (!isset($_GET['ajax']))
            $this->redirect(isset($_POST['returnUrl']) ? $_POST['returnUrl'] : array('admin'));
    }

    /**
     * Lists all models.
     */
    public function actionIndex()
    {
        $dataProvider = new CActiveDataProvider('Father');
        $this->render('index', array(
            'dataProvider' => $dataProvider,
        ));
    }

    /**
     * Manages all models.
     */
    public function actionAdmin()
    {
        $model = new Father('search');
        $model->unsetAttributes();  // clear any default values
        if (isset($_GET['Father']))
            $model->attributes = $_GET['Father'];

        $this->render('admin', array(
            'model' => $model,
        ));
    }

    /**
     * Returns the data model based on the primary key given in the GET variable.
     * If the data model is not found, an HTTP exception will be raised.
     * @param integer the ID of the model to be loaded
     */
    public function loadModel($id)
    {
        $model = Father::model()->findByPk($id);
        if ($model === null)
            throw new CHttpException(404, 'The requested page does not exist.');
        return $model;
    }

    /**
     * Performs the AJAX validation.
     * @param CModel the model to be validated
     */
    protected function performAjaxValidation($model)
    {
        if (isset($_POST['ajax']) && $_POST['ajax'] === 'father-form')
        {
            echo CActiveForm::validate($model);
            Yii::app()->end();
        }
    }

    public function actionLoadChildByAjax($index)
    {
        $model = new Child;
        $this->renderPartial('child/_form', array(
            'model' => $model,
            'index' => $index,
        ));
    }

} 
```

**创建父窗体：**

```
<?php
/* @var $this FatherController */
/* @var $model Father */
/* @var $form CActiveForm */
?>

<div class="form">

    <?php
    $form = $this->beginWidget('CActiveForm', array(
        'id' => 'father-form',
        'focus' => array($model, 'name'),
        'enableClientValidation' => true,
        'enableAjaxValidation' => true,
            ));
    ?>

    <p class="note">Fields with <span class="required">*</span> are required.</p>

    <?php echo $form->errorSummary($model); ?>

    <div class="row">
        <?php echo $form->labelEx($model, 'name'); ?>
        <?php echo $form->textField($model, 'name', array('size' => 60, 'maxlength' => 255)); ?>
        <?php echo $form->error($model, 'name'); ?>
    </div>

    <?php
    echo CHtml::link('Add Child', '#', array('id' => 'loadChildByAjax'));
    ?>
    <div id="children">
        <?php
        $index = 0;
        foreach ($model->children as $id => $child):
            $this->renderPartial('child/_form', array(
                'model' => $child,
                'index' => $id,
                'display' => 'block'
            ));
            $index++;
        endforeach;
        ?>
    </div>

    <div style="clear:both;"></div>
    <div class="row buttons">
        <?php echo CHtml::submitButton($model->isNewRecord ? 'Create' : 'Save'); ?>
    </div>

    <?php $this->endWidget(); ?>

</div><!-- form -->

<?php
Yii::app()->clientScript->registerCoreScript('jquery');
Yii::app()->clientScript->registerScript('loadchild', '
var _index = ' . $index . ';
$("#loadChildByAjax").click(function(e){
    e.preventDefault();
    var _url = "' . Yii::app()->controller->createUrl("loadChildByAjax", array("load_for" => $this->action->id)) . '&index="+_index;
    $.ajax({
        url: _url,
        success:function(response){
            $("#children").append(response);
            $("#children .crow").last().animate({
                opacity : 1, 
                left: "+50", 
                height: "toggle"
            });
        }
    });
    _index++;
});
', CClientScript::POS_END);
?> 
```

**子表：** `views\father\child_form.php`

```
<div style="margin-bottom: 20px; display: <?php echo!empty($display) ? $display : 'none'; ?>; width:100%; clear:left;" class="crow">

    <div class="row" style="width:200px;float: left;">
        <?php echo CHtml::activeLabelEx($model, '[' . $index . ']name'); ?>
        <?php echo CHtml::activeTextField($model, '[' . $index . ']name', array('size' => 20, 'maxlength' => 255)); ?>
        <?php echo CHtml::error($model, '[' . $index . ']name'); ?>
    </div>

    <div class="row" style="width:200px;float: left;">
        <?php echo CHtml::activeLabelEx($model, '[' . $index . ']age'); ?>
        <?php echo CHtml::activeTextField($model, '[' . $index . ']age'); ?>
        <?php echo CHtml::error($model, '[' . $index . ']age'); ?>
    </div>
    <div class="row" style="width:100px;float: left;">
        <br />
        <?php echo CHtml::link('Delete', '#', array('onclick' => 'deleteChild(this, ' . $index . '); return false;'));
        ?>
    </div>
</div>

<?php
Yii::app()->clientScript->registerScript('deleteChild', "
function deleteChild(elm, index)
{
    element=$(elm).parent().parent();
    /* animate div */
    $(element).animate(
    {
        opacity: 0.25, 
        left: '+=50', 
        height: 'toggle'
    }, 500,
    function() {
        /* remove div */
        $(element).remove();
    });
}", CClientScript::POS_END); 
```

本方案使用 sluderitz 开发的 esaverelatedbehavior 来保存相关模型，可以在这里下载

[http://www.yiiframework.com/extension/esaverelatedbehavior/](http://www.yiiframework.com/extension/esaverelatedbehavior/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T09:41:49.920

渲染模型数组（无论它们是否是子模型）的正确语法需要对相关模型进行实例化。所以你必须在你的观点中做这样的事情：

```
$child = new ChildModel();
$form->textFieldRow($child,'[]PROPERTY',$dateAtts); 
```

其中 PROPERTY 是您要为其呈现文本框的属性的名称。

如果您想要一个用于创建和更新父模型的表单，唯一的方法是实例化一个模拟对象来呈现表单。在我的例子中，Event 有一个 Appointment 的集合，所以在我的控制器操作中我做了：

```
$event->appointments = array(new Appointment); 
```

然后，在视图中

```
<?php foreach($model->appointments as $id => $item) : ?>
    <div class="appointment">
        <?php echo $form->textFieldRow($item,'[$id]day',$htmlAtts); ?>
    </div>
<?php endforeach; ?> 
```

我将尝试使用此扩展程序来保存相关模型：[https ://github.com/yiiext/with-related-behavior](https://github.com/yiiext/with-related-behavior)

**更新**

如果你想让子模型在 $_POST 中的父模型数组中，你必须覆盖 name 属性。按照问题示例...

```
$form->textFieldRow(
            $item,
            '[$id]day', 
            array('name' => "Event[appointments][$id][day]")
       ); 
```

# php - 尝试使用 CAKEPHP 使用 jquery 在 div 中加载内容

> ID：11506844
> 
> 赞同：0
> 
> 时间：2012-07-16T14:51:18.883
> 
> 标签：php, jquery, cakephp

好的，我已经找了一段时间了......当使用帮助器 $this->Js->link 将内容加载到 div 时，我找不到与 jquery 和 cakephp 相关的任何内容......所以我决定发布我的在这个很棒的网站上提出问题......我的第一个问题很愚蠢（我猜）。

所以......机制工作正常，我的意思是......它将内容加载到一个名为“algo”的div中，但现在我尝试添加一些效果（淡入淡出）并且我无法为此找到正确的语法！我是全新的蛋糕......只有 1 个月大的使用它。

显示这个该死的 div 时如何添加“淡入”效果？我已经尝试了很多东西，但到目前为止，没有任何东西可以让 div 加载具有淡入淡出效果的内容......

```
echo $this->Js->link('Categoria 1',  array('controller' => 'Categories', 'action' => 'categorias1'), array('update' => '#algo')); 
```

这完美地加载了我在 div 内的类别 1 上的一堆图片，我问...我应该怎么做才能添加淡入淡出效果？我添加了一些疯狂的东西，看看它们是否有效，但是......不......没有运气

我什至试过这个疯狂的：

```
echo $this->Js->link('Categoria 1',  array('controller' => 'Categories', 'action' => 'categorias1'), array('update' => '#algo', array('effect' =>array('fadeIn', array('speed' => 'slow'), true)))); 
```

任何帮助将不胜感激！没有人展示带有 cakephp 的 div 示例.. 或者至少我无法找到适合我需要的示例！

顺便说一句，很棒的网站！这些年来它对我帮助很大！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:22:22.500

我终于设法完成了我想做的事情，我想与你们分享我所做的事情：

```
echo $this->Js->link('categoria 1', array('controller' => 'Categories', 'action' => 'categorias1'),array('update' => '#categorias', 'evalscripts' => true, 'before' => $this->Js->get('#algo,#categorias2')->effect('fadeOut', array('buffer' => false)), 'complete' => $this->Js->get('#categorias')->effect('fadeIn', array('buffer' => false)))); 
```

这段巨大的代码正在做我所期望的，我还为我的 jquery 助手添加了一些编辑，以便将它们传递给多个 div，这样我就可以同时刷新它们。

如果你们想破解你的助手，这里是代码：

cake/libs/view/helpers/jquery_engine.php

找到这一行：

```
$success .= $this-jQueryObject . '("' . $options['update'] . '").html(data);'; 
```

并将其替换为：

```
if(is_array($options['update'])){
                $success .= 'var temp = ' . $this->jQueryObject . '("     <div/>").html(data);';
                foreach($options['update'] as $divId){
                    $success .= $this->jQueryObject . '("' . $divId . '").html('     . $this->jQueryObject . '("' . $divId . '", temp).html());';
                }
            } else {

            $success .= $this->jQueryObject . '("' . $options['update'] .     '").html(data);'; //linea que ya estaba

            }
            //termina agregado 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:39:57.810

正如 Dunhamzzz 所建议的，我所有的 jQuery 都是手工编写的，从不使用助手。tbh 似乎没有任何意义。

一个有用的提示是将基本 URL 和任何其他有用的蛋糕变量作为 javascript 变量传递到您的页面中。将此添加到您的布局中：

```
<?php 
$baseUrl = Router::url('/');

echo $this->Html->scriptBlock(<<<EOJS
var baseUrl = '{$baseUrl}';
EOJS
); ?> 
```

# api - 获取所有体式任务（不仅仅是未归档的）

> ID：11506859
> 
> 赞同：1
> 
> 时间：2012-07-16T14:52:02.800
> 
> 标签：api, asana

当我使用 Asana-Api 请求我的工作区时，如下所示：

```
curl -u <api_key>: "https://app.asana.com/api/1.0/tasks?workspace=14916&assignee=me" 
```

我没有得到文档中写的那些未归档的。（[https://asana.com/developers/api-reference/tasks](https://asana.com/developers/api-reference/tasks)部分：查询任务）

我想知道我是否做错了什么，或者只是 API 向我发送了错误的结果。有没有人有同样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:33:57.163

根据 Asana 团队的 Ryan 的说法（感谢电子邮件支持），这只是事实，您必须在正确的视图中存档任务。我总是将它存档在项目视图中，但这似乎与“我的任务视图”中的不同。如上所述的 API 请求在“我的任务视图”中查找任务的状态。

瑞恩斯 回复:

> 值得注意的是，Asana 中的归档是如何工作的。归档是按视图/项目进行的。如果我在项目 A 中分配了一个已完成的任务，并且我将已完成的任务存档在我的任务列表中，则该操作不会将其存档在项目 A 中。

# perl - 在 Perl 中拆分 4 个空格

> ID：11506860
> 
> 赞同：2
> 
> 时间：2012-07-16T14:52:05.253
> 
> 标签：perl

我有一个文件，其中包含以下格式的行：

```
field1    field2    field3 
```

每个字段由 4 个空格分隔。

我正在尝试使用 Perl 从上面的列表中提取 field2。

所以，这就是我所做的，

```
#! /usr/bin/perl

($input, $output) = @ARGV;

chomp $output;

open(INPUT,"<",$input);
open(OUTPUT,">>",$output);

while(<INPUT>)
{
chomp $_;
($f1,$f2,$f3)= split("\t",$_,3); // *** This line was modified later.
print OUTPUT $f2."\n";
}

close INPUT;
close OUTPUT; 
```

这给了我一个空白文件。

我试图将上面用星号指示的行修改为：

```
($f1,$f2,$f3)= split("\t",$_);
($f1,$f2,$f3)= split("    ",$_);
($f1,$f2,$f3)= split("\s\s\s\s",$_); 
```

在所有这些情况下，我再次得到一个空文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T15:07:31.663

可能是您的未决陈述失败。你不应该在不检查它是否失败的情况下使用 open ，例如

```
open my $fh, '<', $file or die $!; 
```

正如推荐的那样，我使用了三个带有词法文件句柄的参数 open。有关详细信息，请参阅[perldoc -f open](http://perldoc.perl.org/functions/open.html)。

如果您使用 会显示这样的错误`use warnings`，并给出错误：

```
readline() on closed filehandle INPUT at ... 
```

但是，如果您不使用警告，则错误将是无声且致命的。不言而喻，您当然应该始终

```
use warnings;
use strict; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T15:00:17.167

如果字段由您声称的四个空格分隔，则您的代码有效。

```
$ echo 'field1    field2    field3' | perl -nlE'say for split "    ";'
field1
field2
field3 
```

验证您的文件实际上包含四个空格，使用`od -c`.

* * *

顺便说一句，您使用`split "..."`而不是`split /.../`. 第一个 arg of[`split`](http://perldoc.perl.org/functions/split.html)是一个正则表达式。如果你让它看起来像一个，它会更清楚。

# python - 如何从 python smtp 服务器检索电子邮件

> ID：11506866
> 
> 赞同：2
> 
> 时间：2012-07-16T14:52:35.140
> 
> 标签：python, email, smtp, smtp-auth, smtpd

我在 python 中使用 smtpd 模块制作了一个 SMTP 服务器。我已经能够获取电子邮件并将它们存储在 sqlite 数据库中，但问题是我不知道如何检索它们。

我尝试使用以下代码，但我不确定它是否可靠。

```
import smtpd
import asyncore
import sqlite3
import datetime
import dol     # custom module that i have created to do authentication while retrieving the email 
import threading
class CustomSMTPServer(smtpd.SMTPServer):
def process_message(self, peer, mailfrom, rcpttos, data):
    print 'Receiving message from:', peer
    print 'Message addressed from:', mailfrom
    print 'Message addressed to  :', rcpttos
    print 'Message length        :', len(data)
    print "Message :",data
    print data.split("\n\n")
    smtp_auth_cursor.execute("SELECT username FROM smtp_auth_table")
    smtp_entry=smtp_auth_cursor.fetchall()
    print smtp_entry
    subject="project"
    for x in smtp_entry:
        x=x[0]
        name=x+"@example.com"
        if x in name:
            print "entry"
            d=datetime.date.today()
            print "entry"
            date=d.strftime("%A %d. %B %Y")
            print date
            time=datetime.datetime.now().strftime("%I:%M %p")
            print time
            rcpt=rcpttos[0]
            try :
                mail_list_cursor.execute("INSERT INTO mail_list VALUES(101,NULL,?,?,?,?,?,?)",(mailfrom,rcpt,subject,data,date,time))
            except sqllite3.Error, e:
                print "Error %s:" % e.args[0]
                return
            print "hasdf"
            return
    return
def __del__(self):
    server.close()

def Smtp_service(ip,port):
    server = CustomSMTPServer(('127.0.0.1', 2035), None)
    server.set_reuse_addr=True
    threading.Thread(target=dol.Mail_retrive,args=(ip,port,1)).start()
    asyncore.loop() 
```

然后我制作了这个身份验证模块，在检索电子邮件时进行身份验证。这是我开始迷路的地方：

```
class Handler(BaseHTTPRequestHandler):
''' Main class to present webpages and authentication. '''
def do_HEAD(self):
    print "send header101"
    self.send_response(200)
    self.send_header('Content-type', 'text/html')
    self.end_headers()

def do_AUTHHEAD(self):
    print "send header"
    self.send_response(401)
    self.send_header('WWW-Authenticate', 'Basic realm=\"Test\"')
    self.send_header('Content-type', 'text/html')
    self.end_headers()

def authenticate(self):
    conn=sqlite3.connect(smtp_auth_table,isolation_level=None)
    cursor=conn.cursor()
    cursor.execute("SELECT MAX(SNO)FROM smtp_auth_table")
    max_no=cursor.fetchone()
    cursor.execute("SELECT * FROM smtp_auth_table")
    entry=cursor.fetchall()
    passstring=self.headers.getheader('Authorization')
    flag_no=0
    for x in entry:
        setstring=''
        setstring=x[1]+":"+x[2]
        setstring=str(setstring)
        checkstring=base64.b64encode(setstring)
        checkstring="Basic "+checkstring
        if checkstring==passstring:
            return 1
        flag_no=flag_no+1
        if flag_no==max_no:
            return 0

def do_GET(self):
    ''' Present frontpage with user authentication. '''
    if self.headers.getheader('Authorization') == None:
        self.do_AUTHHEAD()
        self.wfile.write('no auth header received')
        pass
    elif self.authenticate():
        self.do_HEAD()
        self.wfile.write(self.headers.getheader('Authorization'))
        self.wfile.write('authenticated!')
        pass
    else:
        self.do_AUTHHEAD()
        self.wfile.write(self.headers.getheader('Authorization'))
        self.wfile.write('not authenticated')
        pass

httpd = SocketServer.TCPServer(("", 10009), Handler)

httpd.serve_forever()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T15:25:12.600

SMTP 是一种仅用于发送消息的传输协议 - 严格用于传递。您不能使用它来检索消息。您需要在消息存储之上实现 POP 或 IMAP，以便客户端（电子邮件程序）可以检索消息。

但是，如果您的最终目标只是在网页上显示消息；您可以使用任何 Python 框架来读取消息存储并显示消息正文和标头。

我最喜欢[`Flask`](http://flask.pocoo.org)这样的轻量级任务。

# javascript - ExtJS 面板总是“在前面”/总是“在上面”

> ID：11506869
> 
> 赞同：2
> 
> 时间：2012-07-16T14:52:47.100
> 
> 标签：javascript, extjs, extjs4, extjs4.1

场景描述：我有一个带有 ExtJS 容器的边框布局，其中包含一对多窗口和一个面板（充当任务栏）。我希望任务栏*始终位于顶部*。如果 Window*处于活动状态*并因此*位于 front*，则调用[toFront](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.panel.Panel-method-toFront)不会按预期将其放在前面。

保留在最前面的 ExtJS[窗口在](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.window.Window)[Border 布局](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.layout.container.Border)`center`区域内，而作为任务栏的面板在该区域内，如下所示：`south`

```
items: [
        { 
            xtype: 'maincontainer', id:'maincontainer',
            region : 'center'
        },
        {
            xtype: 'launchpanel', id:'launchpanel', 
            region: 'south',
            collapsible : true,
        }        
], 
```

where`maincontainer`和`launchpanel`extend`Ext.container.Container`和`Ext.panel.Panel`分别。此代码位于主容器中，它是 ExtJS MVC 应用程序中唯一的项目`Viewport`。

**我怎样才能让`launchpanel`总是在前面/在上面？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:44:11.200

从我同时阅读的内容来看*，前面*出现的内容是由 CSS [z-index](http://www.w3schools.com/cssref/pr_pos_z-index.asp)属性决定的。

然后我找到了这个关于如何为面板设置 z-index 的[答案。](https://stackoverflow.com/questions/3424665/how-sets-z-index-to-ext-panel-extjs)因此，我通过在控制器中使用以下代码段来为 Panel 设置每次渲染时的 z-index：

```
'launchpanel': {
    expand: function(panel) { 
        panel.getEl().setStyle('z-index','80000');
    },
... 
```

不过，如果有人有更好的方法来完成上述操作，请分享！

# javascript - Javascript将一个变量从函数调用传递给innerHtml

> ID：11506871
> 
> 赞同：0
> 
> 时间：2012-07-16T14:52:56.883
> 
> 标签：javascript

好的，这可能很容易，我只是不知道该怎么做。我有一个主要功能，它接受一个“id”。这个 id 是唯一的，我想将它传递给另一个正在为我进行计数的函数，并将该计数返回给 innerHtml 跨度标记。

这样做的原因是因为我可以同时打开其中的 5 个，但它们将具有相同的跨度 id 名称“editCommentsCounter”......我希望它们像“editCommentsCounter-id”

```
function editCommentToggle( id )
{
    theRow = document.getElementById("id"+id);
    //user = theRow.cells[0].innerHTML;
    //date = theRow.cells[1].innerHTML;
    com = theRow.cells[2].innerText ;
    comLength = theRow.cells[2].innerText.length ;

    idx = 2;
    maxlength = 250;
    count = maxlength - comLength;

        // Comment field
        cell = theRow.cells[idx];
        while( cell.childNodes.length > 0 ) cell.removeChild(cell.childNodes[0]);

        spanTag = document.createElement("span"); 
        spanTag.innerHTML = "You have <strong><span id='editCommentsCounter'>"+count+"</span></strong> characters left.<br/>"; 
        cell.appendChild(spanTag);
        element = document.createElement("textarea");
        element.id="commentsTextArea-"+id;
        element.rows="3";
        element.value = com;
        element.style.width = "400px";
        element.maxLength = "250";
        element.onfocus = element.onkeydown = element.onkeyup = function(){return characterCounterEdit('editCommentsCounter', maxlength, this);}; 
        cell.appendChild(element); 
```

}

基本上我想采取：

```
 spanTag.innerHTML = "You have <strong><span id='editCommentsCounter'>"+count+"</span></strong> characters left.<br/>"; 
```

并将其变成类似 `span id='editCommentsCounter-' + id

所以当我这样称呼时：

`element.onfocus = element.onkeydown = element.onkeyup = function(){return characterCounterEdit('editCommentsCounter', maxlength, this);};`

我在上面使用带有该 ID 的 editCommentsCounter 调用它

看看我在说什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:56:55.777

采用：

```
document.getElementById("editCommentsCounter-" + id).innerHTML = someVal; 
```

你有很多东西，但似乎这就是你试图编写 innerHTML val 的方法。如果没有，请在评论中告诉我更多信息，我可以提出更多建议。

* * *

我看到您想动态构建一个新跨度，然后填充内容。一开始令人费解的一件事是您引用元素并连接“id”+id。不得不考虑这一点，因此为太快的反应道歉；只是在看你的最终结果。

设置唯一标识：

```
var spanTag = document.createElement("span");
spanTag.id = 'editCommentsCounter-' + id;
spanTag.innerHTML = 'You have ...' + count + '...';
document.body.appendChild(spanTag); 
```

我希望这有帮助！

# cmake - 将 cmake-gui 与 Qt Creator 一起使用

> ID：11506874
> 
> 赞同：3
> 
> 时间：2012-07-16T14:53:07.440
> 
> 标签：cmake, qt-creator

我开始尝试将项目转换为使用 CMake，以便我可以将项目导入 QtCreator 以使用 QtCreator IDE 来处理这个直接的 C 代码。就给我自动完成，代码潜水等而言，这非常有效。

我花了一些时间让 CMake 按照我的预期构建代码，主要是因为这是我第一次使用它。我最近发现有一个 cmake-gui 可以指向你的源代码，它会显示 CMake 变量等。在 QtCreator 中实际使用 cmake-gui 的正确方法是什么？当我在项目中手动创建 CMakelists.txt 文件时，将项目放入其中就足够了。我应该只使用定位器运行 Cmake-gui 并将其指向这些文件吗？我应该在从 QtCreator 创建的 cmake-gui 中保留相同的构建目录吗？任何教程链接或指导都受到赞赏 - 没有找到一大堆谷歌搜索。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T15:06:14.737

我使用`cmake-gui`QtCreator 的方式是这样的：

1.  创建一个构建目录并使用 配置它`cmake-gui`，例如：

    ```
    cmake/project$ mkdir build
    cmake/project$ cd build
    cmake/project/build$ cmake-gui .. 
    ```

2.  在 QtCreator 中打开`CMakeLists.txt`文件，并将构建路径设置为您进行配置的位置：

    ![带有 CMake-GUI 的 QtCreator](../Images/c7ad0eb8481223b66832860b1416ed68.png)

3.  通过单击“运行 CMake”让 QtCreator 运行配置，它将使用您`cmake-gui`在步骤 1 中配置的值：

    ![QtCreator 与 CMake-GUI 步骤 2](../Images/bb71f7c195d7937428da5ab1a74f00dc.png)

4.  你完成了:)

5.  当您需要重新配置 CMake 构建时，只需启动命令行，导航到构建目录并重新运行`cmake-gui`.

# java - 如何通过jdbc获取主键的列名

> ID：11506884
> 
> 赞同：10
> 
> 时间：2012-07-16T14:53:49.657
> 
> 标签：java, jdbc

我的代码如下：

```
DatabaseMetaData dmd = connection.getMetaData();
ResultSet rs = dmd.getPrimaryKeys(null, null, tableName);

while(rs.next()){
    primaryKey = rs.getString("COLUMN_NAME");
} 
```

rs 不是 null 而`rs.next()`总是 return `false`，有人知道吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:19:06.373

1.  元数据接口实现由驱动程序供应商实现。某些驱动程序和某些数据库可能不支持它。下面是来自 javadoc 的文本：一些 DatabaseMetaData 方法以 ResultSet 对象的形式返回信息列表。常规 ResultSet 方法，例如 getString 和 getInt，可用于从这些 ResultSet 对象中检索数据。如果给定形式的元数据不可用，则将返回一个空的 ResultSet。

2.  oracle中的表名区分大小写

3.  或尝试以下方法

    ```
    数据库元数据 dm = conn.getMetaData( );
    结果集 rs = dm.getExportedKeys( "" , "" , "table1" );
    同时（rs.next（））
    {    
      字符串 pkey = rs.getString("PKCOLUMN_NAME");
      System.out.println("主键 = " + pkey);
    }

    ```

    您还可以使用 getCrossReference 或 getImportedKeys 来检索主键

# extjs - extjs 中的 CSS Mixins

> ID：11506889
> 
> 赞同：2
> 
> 时间：2012-07-16T14:54:07.463
> 
> 标签：extjs, extjs4.1

什么是 CSS Mixin？我将其视为 extjs 文档中的选项卡？

我想了解[http://oocss.org/spec/css-mixins.html](http://oocss.org/spec/css-mixins.html) 如何在 extjs 中使用 CSS Mixins？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:58:02.110

ExtJS 使用 Sass 预编译器作为其 CSS 主题。

一个 mixin 可以让你定义和重用一大块 CSS。

[http://sass-lang.com/documentation/file.SASS_REFERENCE.html#mixins](http://sass-lang.com/documentation/file.SASS_REFERENCE.html#mixins)

你可以在这里阅读更多关于 ExtJS 主题的信息：

[http://docs.sencha.com/ext-js/4-1/#!/guide/theming](http://docs.sencha.com/ext-js/4-1/#!/guide/theming)

# c# - 如何在 C# 中从文件中加载 RSA 公钥

> ID：11506891
> 
> 赞同：41
> 
> 时间：2012-07-16T14:54:14.633
> 
> 标签：c#, rsa, encryption-asymmetric, public-key

我需要从文件中加载以下 RSA 公钥以用于 RSACryptoServiceProvider 类。我怎样才能做到这一点？

```
-----BEGIN PUBLIC KEY-----
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/syEKqEkMtQL0+d
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX+izR
KbGMRtur2TYklnyVkjeeHfAggo8vWQmWesnOG55vQYHbOOFoJbk0EkwEr5R/PbKm
byXPPN8zwnS5/XXXXXXXXXXXX
-----END PUBLIC KEY----- 
```

* * *

此代码适用于我的 pub 密钥： http: [//www.jensign.com/opensslkey/](http://www.jensign.com/opensslkey/)

这是我正在使用的代码

```
 static string RSA(string input)
        {
            RSACryptoServiceProvider rsa = DecodeX509PublicKey(Convert.FromBase64String(GetKey()));

            return (Convert.ToBase64String(rsa.Encrypt(Encoding.ASCII.GetBytes(input), false)));
        }

        static string GetKey()
        {
            return File.ReadAllText("master.pub").Replace("-----BEGIN PUBLIC KEY-----", "").Replace("-----END PUBLIC KEY-----", "");
            //.Replace("\n", "");
        }

        private static bool CompareBytearrays(byte[] a, byte[] b)
        {
            if (a.Length != b.Length)
                return false;
            int i = 0;
            foreach (byte c in a)
            {
                if (c != b[i])
                    return false;
                i++;
            }
            return true;
        }

        public static RSACryptoServiceProvider DecodeX509PublicKey(byte[] x509key)
        {
            // encoded OID sequence for  PKCS #1 rsaEncryption szOID_RSA_RSA = "1.2.840.113549.1.1.1"
            byte[] SeqOID = { 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00 };
            byte[] seq = new byte[15];
            // ---------  Set up stream to read the asn.1 encoded SubjectPublicKeyInfo blob  ------
            MemoryStream mem = new MemoryStream(x509key);
            BinaryReader binr = new BinaryReader(mem);    //wrap Memory Stream with BinaryReader for easy reading
            byte bt = 0;
            ushort twobytes = 0;

            try
            {

                twobytes = binr.ReadUInt16();
                if (twobytes == 0x8130) //data read as little endian order (actual data order for Sequence is 30 81)
                    binr.ReadByte();    //advance 1 byte
                else if (twobytes == 0x8230)
                    binr.ReadInt16();   //advance 2 bytes
                else
                    return null;

                seq = binr.ReadBytes(15);       //read the Sequence OID
                if (!CompareBytearrays(seq, SeqOID))    //make sure Sequence for OID is correct
                    return null;

                twobytes = binr.ReadUInt16();
                if (twobytes == 0x8103) //data read as little endian order (actual data order for Bit String is 03 81)
                    binr.ReadByte();    //advance 1 byte
                else if (twobytes == 0x8203)
                    binr.ReadInt16();   //advance 2 bytes
                else
                    return null;

                bt = binr.ReadByte();
                if (bt != 0x00)     //expect null byte next
                    return null;

                twobytes = binr.ReadUInt16();
                if (twobytes == 0x8130) //data read as little endian order (actual data order for Sequence is 30 81)
                    binr.ReadByte();    //advance 1 byte
                else if (twobytes == 0x8230)
                    binr.ReadInt16();   //advance 2 bytes
                else
                    return null;

                twobytes = binr.ReadUInt16();
                byte lowbyte = 0x00;
                byte highbyte = 0x00;

                if (twobytes == 0x8102) //data read as little endian order (actual data order for Integer is 02 81)
                    lowbyte = binr.ReadByte();  // read next bytes which is bytes in modulus
                else if (twobytes == 0x8202)
                {
                    highbyte = binr.ReadByte(); //advance 2 bytes
                    lowbyte = binr.ReadByte();
                }
                else
                    return null;
                byte[] modint = { lowbyte, highbyte, 0x00, 0x00 };   //reverse byte order since asn.1 key uses big endian order
                int modsize = BitConverter.ToInt32(modint, 0);

                byte firstbyte = binr.ReadByte();
                binr.BaseStream.Seek(-1, SeekOrigin.Current);

                if (firstbyte == 0x00)
                {   //if first byte (highest order) of modulus is zero, don't include it
                    binr.ReadByte();    //skip this null byte
                    modsize -= 1;   //reduce modulus buffer size by 1
                }

                byte[] modulus = binr.ReadBytes(modsize);   //read the modulus bytes

                if (binr.ReadByte() != 0x02)            //expect an Integer for the exponent data
                    return null;
                int expbytes = (int)binr.ReadByte();        // should only need one byte for actual exponent data (for all useful values)
                byte[] exponent = binr.ReadBytes(expbytes);

                // ------- create RSACryptoServiceProvider instance and initialize with public key -----
                RSACryptoServiceProvider RSA = new RSACryptoServiceProvider();
                RSAParameters RSAKeyInfo = new RSAParameters();
                RSAKeyInfo.Modulus = modulus;
                RSAKeyInfo.Exponent = exponent;
                RSA.ImportParameters(RSAKeyInfo);
                return RSA;
            }
            catch (Exception)
            {
                return null;
            }

            finally { binr.Close(); }

        } 
```

只需使用要加密的文本调用“RSA”方法即可。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2015-08-27T07:27:52.013

您可以`RSACryptoServiceProvider`使用以下类（`GetRSAProviderFromPemFile`方法）从 PEM 文件创建一个。

**警告：** **不要未经验证就从 StackOverflow 复制代码！尤其不是加密代码！这段代码有错误（见评论）。您可能希望在生产中使用它之前编写和运行测试（如果您真的没有更好的选择）。**我拒绝编辑代码来修复它，因为如果没有测试和积极的维护者，它会像以前一样不可靠。

**来源：** 此代码似乎取自`opensslkey`此[站点](http://jensign.com/dotnet/opensslkey/index.html)。版权所有 (c) 2000 JavaScience Consulting, Michel Gallant。原始包是在类似 BSD 的许可证下发布的，因此使用它可能是可以的（但您可能需要仔细检查）。同一作者还有一个[NuGet 包](https://www.nuget.org/packages/opensslkey)。

这是最初发布到此答案的复制粘贴的源代码：

```
RSACryptoServiceProvider provider = PemKeyUtils.GetRSAProviderFromPemFile(  @"public_key.pem" );

public class PemKeyUtils
{
    const String pemprivheader = "-----BEGIN RSA PRIVATE KEY-----";
    const String pemprivfooter = "-----END RSA PRIVATE KEY-----";
    const String pempubheader = "-----BEGIN PUBLIC KEY-----";
    const String pempubfooter = "-----END PUBLIC KEY-----";
    const String pemp8header = "-----BEGIN PRIVATE KEY-----";
    const String pemp8footer = "-----END PRIVATE KEY-----";
    const String pemp8encheader = "-----BEGIN ENCRYPTED PRIVATE KEY-----";
    const String pemp8encfooter = "-----END ENCRYPTED PRIVATE KEY-----";

    static bool verbose = false;

    public static RSACryptoServiceProvider GetRSAProviderFromPemFile( String pemfile )
    {
        bool isPrivateKeyFile = true;
        string pemstr = File.ReadAllText( pemfile ).Trim();
        if (pemstr.StartsWith( pempubheader ) && pemstr.EndsWith( pempubfooter ))
            isPrivateKeyFile = false;

        byte[] pemkey;
        if (isPrivateKeyFile)
            pemkey = DecodeOpenSSLPrivateKey( pemstr );
        else
            pemkey = DecodeOpenSSLPublicKey( pemstr );

        if (pemkey == null)
            return null;

        if (isPrivateKeyFile)
            return DecodeRSAPrivateKey( pemkey );
        else
            return DecodeX509PublicKey( pemkey );

    }

    //--------   Get the binary RSA PUBLIC key   --------
    static byte[] DecodeOpenSSLPublicKey( String instr )
    {
        const String pempubheader = "-----BEGIN PUBLIC KEY-----";
        const String pempubfooter = "-----END PUBLIC KEY-----";
        String pemstr = instr.Trim();
        byte[] binkey;
        if (!pemstr.StartsWith( pempubheader ) || !pemstr.EndsWith( pempubfooter ))
            return null;
        StringBuilder sb = new StringBuilder( pemstr );
        sb.Replace( pempubheader, "" );  //remove headers/footers, if present
        sb.Replace( pempubfooter, "" );

        String pubstr = sb.ToString().Trim();   //get string after removing leading/trailing whitespace

        try
        {
            binkey = Convert.FromBase64String( pubstr );
        }
        catch (System.FormatException)
        {       //if can't b64 decode, data is not valid
            return null;
        }
        return binkey;
    }

    static RSACryptoServiceProvider DecodeX509PublicKey(byte[] x509Key)
    {
        // encoded OID sequence for  PKCS #1 rsaEncryption szOID_RSA_RSA = "1.2.840.113549.1.1.1"
        byte[] seqOid = { 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00 };
        // ---------  Set up stream to read the asn.1 encoded SubjectPublicKeyInfo blob  ------
        using (var mem = new MemoryStream(x509Key))
        {
            using (var binr = new BinaryReader(mem))    //wrap Memory Stream with BinaryReader for easy reading
            {
                try
                {
                    var twobytes = binr.ReadUInt16();
                    switch (twobytes)
                    {
                        case 0x8130:
                            binr.ReadByte();    //advance 1 byte
                            break;
                        case 0x8230:
                            binr.ReadInt16();   //advance 2 bytes
                            break;
                        default:
                            return null;
                    }

                    var seq = binr.ReadBytes(15);
                    if (!CompareBytearrays(seq, seqOid))  //make sure Sequence for OID is correct
                        return null;

                    twobytes = binr.ReadUInt16();
                    if (twobytes == 0x8103) //data read as little endian order (actual data order for Bit String is 03 81)
                        binr.ReadByte();    //advance 1 byte
                    else if (twobytes == 0x8203)
                        binr.ReadInt16();   //advance 2 bytes
                    else
                        return null;

                    var bt = binr.ReadByte();
                    if (bt != 0x00)     //expect null byte next
                        return null;

                    twobytes = binr.ReadUInt16();
                    if (twobytes == 0x8130) //data read as little endian order (actual data order for Sequence is 30 81)
                        binr.ReadByte();    //advance 1 byte
                    else if (twobytes == 0x8230)
                        binr.ReadInt16();   //advance 2 bytes
                    else
                        return null;

                    twobytes = binr.ReadUInt16();
                    byte lowbyte = 0x00;
                    byte highbyte = 0x00;

                    if (twobytes == 0x8102) //data read as little endian order (actual data order for Integer is 02 81)
                        lowbyte = binr.ReadByte();  // read next bytes which is bytes in modulus
                    else if (twobytes == 0x8202)
                    {
                        highbyte = binr.ReadByte(); //advance 2 bytes
                        lowbyte = binr.ReadByte();
                    }
                    else
                        return null;
                    byte[] modint = { lowbyte, highbyte, 0x00, 0x00 };   //reverse byte order since asn.1 key uses big endian order
                    int modsize = BitConverter.ToInt32(modint, 0);

                    byte firstbyte = binr.ReadByte();
                    binr.BaseStream.Seek(-1, SeekOrigin.Current);

                    if (firstbyte == 0x00)
                    {   //if first byte (highest order) of modulus is zero, don't include it
                        binr.ReadByte();    //skip this null byte
                        modsize -= 1;   //reduce modulus buffer size by 1
                    }

                    byte[] modulus = binr.ReadBytes(modsize); //read the modulus bytes

                    if (binr.ReadByte() != 0x02)            //expect an Integer for the exponent data
                        return null;
                    int expbytes = binr.ReadByte();        // should only need one byte for actual exponent data (for all useful values)
                    byte[] exponent = binr.ReadBytes(expbytes);

                    // We don't really need to print anything but if we insist to...
                    //showBytes("\nExponent", exponent);
                    //showBytes("\nModulus", modulus);

                    // ------- create RSACryptoServiceProvider instance and initialize with public key -----
                    RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
                    RSAParameters rsaKeyInfo = new RSAParameters
                    {
                        Modulus = modulus,
                        Exponent = exponent
                    };
                    rsa.ImportParameters(rsaKeyInfo);
                    return rsa;
                }
                catch (Exception)
                {
                    return null;
                }
            }
        }
    }

    //------- Parses binary ans.1 RSA private key; returns RSACryptoServiceProvider  ---
    static RSACryptoServiceProvider DecodeRSAPrivateKey( byte[] privkey )
    {
        byte[] MODULUS, E, D, P, Q, DP, DQ, IQ;

        // ---------  Set up stream to decode the asn.1 encoded RSA private key  ------
        MemoryStream mem = new MemoryStream( privkey );
        BinaryReader binr = new BinaryReader( mem );    //wrap Memory Stream with BinaryReader for easy reading
        byte bt = 0;
        ushort twobytes = 0;
        int elems = 0;
        try
        {
            twobytes = binr.ReadUInt16();
            if (twobytes == 0x8130) //data read as little endian order (actual data order for Sequence is 30 81)
                binr.ReadByte();    //advance 1 byte
            else if (twobytes == 0x8230)
                binr.ReadInt16();   //advance 2 bytes
            else
                return null;

            twobytes = binr.ReadUInt16();
            if (twobytes != 0x0102) //version number
                return null;
            bt = binr.ReadByte();
            if (bt != 0x00)
                return null;

            //------  all private key components are Integer sequences ----
            elems = GetIntegerSize( binr );
            MODULUS = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            E = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            D = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            P = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            Q = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            DP = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            DQ = binr.ReadBytes( elems );

            elems = GetIntegerSize( binr );
            IQ = binr.ReadBytes( elems );

            Console.WriteLine( "showing components .." );
            if (verbose)
            {
                showBytes( "\nModulus", MODULUS );
                showBytes( "\nExponent", E );
                showBytes( "\nD", D );
                showBytes( "\nP", P );
                showBytes( "\nQ", Q );
                showBytes( "\nDP", DP );
                showBytes( "\nDQ", DQ );
                showBytes( "\nIQ", IQ );
            }

            // ------- create RSACryptoServiceProvider instance and initialize with public key -----
            RSACryptoServiceProvider RSA = new RSACryptoServiceProvider();
            RSAParameters RSAparams = new RSAParameters();
            RSAparams.Modulus = MODULUS;
            RSAparams.Exponent = E;
            RSAparams.D = D;
            RSAparams.P = P;
            RSAparams.Q = Q;
            RSAparams.DP = DP;
            RSAparams.DQ = DQ;
            RSAparams.InverseQ = IQ;
            RSA.ImportParameters( RSAparams );
            return RSA;
        }
        catch (Exception)
        {
            return null;
        }
        finally { binr.Close(); }
    }

    private static int GetIntegerSize( BinaryReader binr )
    {
        byte bt = 0;
        byte lowbyte = 0x00;
        byte highbyte = 0x00;
        int count = 0;
        bt = binr.ReadByte();
        if (bt != 0x02)     //expect integer
            return 0;
        bt = binr.ReadByte();

        if (bt == 0x81)
            count = binr.ReadByte();    // data size in next byte
        else
            if (bt == 0x82)
            {
                highbyte = binr.ReadByte(); // data size in next 2 bytes
                lowbyte = binr.ReadByte();
                byte[] modint = { lowbyte, highbyte, 0x00, 0x00 };
                count = BitConverter.ToInt32( modint, 0 );
            }
            else
            {
                count = bt;     // we already have the data size
            }

        while (binr.ReadByte() == 0x00)
        {   //remove high order zeros in data
            count -= 1;
        }
        binr.BaseStream.Seek( -1, SeekOrigin.Current );     //last ReadByte wasn't a removed zero, so back up a byte
        return count;
    }

    //-----  Get the binary RSA PRIVATE key, decrypting if necessary ----
    static byte[] DecodeOpenSSLPrivateKey( String instr )
    {
        const String pemprivheader = "-----BEGIN RSA PRIVATE KEY-----";
        const String pemprivfooter = "-----END RSA PRIVATE KEY-----";
        String pemstr = instr.Trim();
        byte[] binkey;
        if (!pemstr.StartsWith( pemprivheader ) || !pemstr.EndsWith( pemprivfooter ))
            return null;

        StringBuilder sb = new StringBuilder( pemstr );
        sb.Replace( pemprivheader, "" );  //remove headers/footers, if present
        sb.Replace( pemprivfooter, "" );

        String pvkstr = sb.ToString().Trim();   //get string after removing leading/trailing whitespace

        try
        {        // if there are no PEM encryption info lines, this is an UNencrypted PEM private key
            binkey = Convert.FromBase64String( pvkstr );
            return binkey;
        }
        catch (System.FormatException)
        {       //if can't b64 decode, it must be an encrypted private key
            //Console.WriteLine("Not an unencrypted OpenSSL PEM private key");  
        }

        StringReader str = new StringReader( pvkstr );

        //-------- read PEM encryption info. lines and extract salt -----
        if (!str.ReadLine().StartsWith( "Proc-Type: 4,ENCRYPTED" ))
            return null;
        String saltline = str.ReadLine();
        if (!saltline.StartsWith( "DEK-Info: DES-EDE3-CBC," ))
            return null;
        String saltstr = saltline.Substring( saltline.IndexOf( "," ) + 1 ).Trim();
        byte[] salt = new byte[saltstr.Length / 2];
        for (int i = 0; i < salt.Length; i++)
            salt[i] = Convert.ToByte( saltstr.Substring( i * 2, 2 ), 16 );
        if (!(str.ReadLine() == ""))
            return null;

        //------ remaining b64 data is encrypted RSA key ----
        String encryptedstr = str.ReadToEnd();

        try
        {   //should have b64 encrypted RSA key now
            binkey = Convert.FromBase64String( encryptedstr );
        }
        catch (System.FormatException)
        {  // bad b64 data.
            return null;
        }

        //------ Get the 3DES 24 byte key using PDK used by OpenSSL ----

        SecureString despswd = GetSecPswd( "Enter password to derive 3DES key==>" );
        //Console.Write("\nEnter password to derive 3DES key: ");
        //String pswd = Console.ReadLine();
        byte[] deskey = GetOpenSSL3deskey( salt, despswd, 1, 2 );    // count=1 (for OpenSSL implementation); 2 iterations to get at least 24 bytes
        if (deskey == null)
            return null;
        //showBytes("3DES key", deskey) ;

        //------ Decrypt the encrypted 3des-encrypted RSA private key ------
        byte[] rsakey = DecryptKey( binkey, deskey, salt ); //OpenSSL uses salt value in PEM header also as 3DES IV
        if (rsakey != null)
            return rsakey;  //we have a decrypted RSA private key
        else
        {
            Console.WriteLine( "Failed to decrypt RSA private key; probably wrong password." );
            return null;
        }
    }

    // ----- Decrypt the 3DES encrypted RSA private key ----------

    static byte[] DecryptKey( byte[] cipherData, byte[] desKey, byte[] IV )
    {
        MemoryStream memst = new MemoryStream();
        TripleDES alg = TripleDES.Create();
        alg.Key = desKey;
        alg.IV = IV;
        try
        {
            CryptoStream cs = new CryptoStream( memst, alg.CreateDecryptor(), CryptoStreamMode.Write );
            cs.Write( cipherData, 0, cipherData.Length );
            cs.Close();
        }
        catch (Exception exc)
        {
            Console.WriteLine( exc.Message );
            return null;
        }
        byte[] decryptedData = memst.ToArray();
        return decryptedData;
    }

    //-----   OpenSSL PBKD uses only one hash cycle (count); miter is number of iterations required to build sufficient bytes ---
    static byte[] GetOpenSSL3deskey( byte[] salt, SecureString secpswd, int count, int miter )
    {
        IntPtr unmanagedPswd = IntPtr.Zero;
        int HASHLENGTH = 16;    //MD5 bytes
        byte[] keymaterial = new byte[HASHLENGTH * miter];     //to store contatenated Mi hashed results

        byte[] psbytes = new byte[secpswd.Length];
        unmanagedPswd = Marshal.SecureStringToGlobalAllocAnsi( secpswd );
        Marshal.Copy( unmanagedPswd, psbytes, 0, psbytes.Length );
        Marshal.ZeroFreeGlobalAllocAnsi( unmanagedPswd );

        //UTF8Encoding utf8 = new UTF8Encoding();
        //byte[] psbytes = utf8.GetBytes(pswd);

        // --- contatenate salt and pswd bytes into fixed data array ---
        byte[] data00 = new byte[psbytes.Length + salt.Length];
        Array.Copy( psbytes, data00, psbytes.Length );      //copy the pswd bytes
        Array.Copy( salt, 0, data00, psbytes.Length, salt.Length ); //concatenate the salt bytes

        // ---- do multi-hashing and contatenate results  D1, D2 ...  into keymaterial bytes ----
        MD5 md5 = new MD5CryptoServiceProvider();
        byte[] result = null;
        byte[] hashtarget = new byte[HASHLENGTH + data00.Length];   //fixed length initial hashtarget

        for (int j = 0; j < miter; j++)
        {
            // ----  Now hash consecutively for count times ------
            if (j == 0)
                result = data00;    //initialize 
            else
            {
                Array.Copy( result, hashtarget, result.Length );
                Array.Copy( data00, 0, hashtarget, result.Length, data00.Length );
                result = hashtarget;
                //Console.WriteLine("Updated new initial hash target:") ;
                //showBytes(result) ;
            }

            for (int i = 0; i < count; i++)
                result = md5.ComputeHash( result );
            Array.Copy( result, 0, keymaterial, j * HASHLENGTH, result.Length );  //contatenate to keymaterial
        }
        //showBytes("Final key material", keymaterial);
        byte[] deskey = new byte[24];
        Array.Copy( keymaterial, deskey, deskey.Length );

        Array.Clear( psbytes, 0, psbytes.Length );
        Array.Clear( data00, 0, data00.Length );
        Array.Clear( result, 0, result.Length );
        Array.Clear( hashtarget, 0, hashtarget.Length );
        Array.Clear( keymaterial, 0, keymaterial.Length );

        return deskey;
    }

    static SecureString GetSecPswd( String prompt )
    {
        SecureString password = new SecureString();

        Console.ForegroundColor = ConsoleColor.Gray;
        Console.Write( prompt );
        Console.ForegroundColor = ConsoleColor.Magenta;

        while (true)
        {
            ConsoleKeyInfo cki = Console.ReadKey( true );
            if (cki.Key == ConsoleKey.Enter)
            {
                Console.ForegroundColor = ConsoleColor.Gray;
                Console.WriteLine();
                return password;
            }
            else if (cki.Key == ConsoleKey.Backspace)
            {
                // remove the last asterisk from the screen...
                if (password.Length > 0)
                {
                    Console.SetCursorPosition( Console.CursorLeft - 1, Console.CursorTop );
                    Console.Write( " " );
                    Console.SetCursorPosition( Console.CursorLeft - 1, Console.CursorTop );
                    password.RemoveAt( password.Length - 1 );
                }
            }
            else if (cki.Key == ConsoleKey.Escape)
            {
                Console.ForegroundColor = ConsoleColor.Gray;
                Console.WriteLine();
                return password;
            }
            else if (Char.IsLetterOrDigit( cki.KeyChar ) || Char.IsSymbol( cki.KeyChar ))
            {
                if (password.Length < 20)
                {
                    password.AppendChar( cki.KeyChar );
                    Console.Write( "*" );
                }
                else
                {
                    Console.Beep();
                }
            }
            else
            {
                Console.Beep();
            }
        }
    }

    static bool CompareBytearrays( byte[] a, byte[] b )
    {
        if (a.Length != b.Length)
            return false;
        int i = 0;
        foreach (byte c in a)
        {
            if (c != b[i])
                return false;
            i++;
        }
        return true;
    }

    static void showBytes( String info, byte[] data )
    {
        Console.WriteLine( "{0}  [{1} bytes]", info, data.Length );
        for (int i = 1; i <= data.Length; i++)
        {
            Console.Write( "{0:X2}  ", data[i - 1] );
            if (i % 16 == 0)
                Console.WriteLine();
        }
        Console.WriteLine( "\n\n" );
    }

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T15:03:24.240

如果您谈论的是 X509 证书：

```
FileStream fs = new FileStream("your_cert_file.crt", FileMode.Open);
byte[] certBytes = new byte[fs.Length];
fs.Read(certBytes, 0, (Int32)fs.Length);
fs.Close();
System.Security.Cryptography.X509Certificates.X509Certificate x509cert = 
    new X509Certificate(certBytes);
Console.WriteLine(x509cert.GetPublicKey());
Console.WriteLine(x509cert.GetPublicKeyString()); 
```

**在“7/16/2012 15:04:58 Z”中完成@hkproj 的评论后编辑：**

环顾四周，我发现“[仅使用 Bouncy Castle 读取 PEM RSA 公钥](https://stackoverflow.com/a/11367152/1350308)”。我想你想要的是这样的：

```
using (StreamReader reader = File.OpenText(@"c:\RSA.txt"))
{
    Org.BouncyCastle.OpenSsl.PemReader pr = 
        new Org.BouncyCastle.OpenSsl.PemReader(reader);
    Org.BouncyCastle.Utilities.IO.Pem.PemObject po = pr.ReadPemObject();

    Console.WriteLine("PemObject, Type: " + po.Type);
    Console.WriteLine("PemObject, Length: " + po.Content.Length);
} 
```

但是，对于您的文件，我收到一个错误：`System.IO.IOException : base64 data appears to be truncated`.

因此，将您的文件更改为：

```
-----BEGIN PUBLIC KEY-----
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/syEKqEkMtQL0+d
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX+izR
KbGMRtur2TYklnyVkjeeHfAggo8vWQmWesnOG55vQYHbOOFoJbk0EkwEr5R/PbKm
byXPPN8zwnS5/XXXXXXXXXXXXZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ
-----END PUBLIC KEY----- 
```

结果是：

```
PemObject, Type: PUBLIC KEY
PemObject, Length: 192 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T15:03:45.693

您是在谈论存储在文件中的证书吗？

如果你有一个像这样的对象：

```
X509Certificate2 certificate; 
```

您可以使用以下代码：

```
RSACryptoServiceProvider rsaprovider =
                    (RSACryptoServiceProvider)certificate.PublicKey.Key; 
```

然后使用类 RSACryptoServiceProvider（参见[http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.aspx)）。

要加载 X509Certificate2，请使用其构造函数（请参阅[http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509certificate2.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509certificate2.aspx)）。

这个程序对我来说很好：

```
 static void Main(string[] args)
    {
        try 
        {
            X509Certificate2 certificate = 
                new X509Certificate2("<PFX Certificate Path", "<Certificate-Password>");
            RSACryptoServiceProvider rsaprovider = (RSACryptoServiceProvider)certificate.PublicKey.Key;
        }
        catch(Exception e)
        {

        }
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-04-28T11:29:10.697

从 .Net 5.0 开始，您可以从字符串中导入 RSA 公钥，如下所示：

```
var rsaPublicKey = RSA.Create();
rsaPublicKey.ImportFromPem(publicKeyString); 
```

如果您不知道如何将文件读取到字符串，请参阅

[如何使用 C# 将整个文件读入字符串？](https://stackoverflow.com/q/7387085/5517088)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-05T07:54:59.103

```
string private_key = File.ReadAllText(private_key_file).Trim();
Regex regex = new Regex(@"-----(BEGIN|END) (RSA|OPENSSH|ENCRYPTED) PRIVATE KEY-----[\W]*");
string private_key_base64 = regex.Replace(private_key, "");
byte[] bytes_privake_key = Convert.FromBase64String(private_key_base64);
rsa.ImportRSAPrivateKey(new ReadOnlySpan<byte>(bytes_privake_key), out bytesRead); 
```

# sql - 每个 ID 和日期仅选择一行

> ID：11506893
> 
> 赞同：1
> 
> 时间：2012-07-16T14:54:19.673
> 
> 标签：sql, sql-server, tsql

我需要在 SQL 中做一些事情，我现在很困惑！

所以我有这样的事情：

```
idEvent   idService   dateCreated
-------   ---------   -----------
1         1           2012-01-01
2         1           2012-02-02
3         2           2012-01-01
4         2           2012-02-02 
```

`idEvent`是自动递增的。

我需要得到的是`dateCreated DESC`每个`idService`.

所以我需要得到这个结果：

```
idEvent
-------
2
4 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:56:37.430

您可以使用公用表表达式将“行号”应用于每个 idService / dateCreated 组合。你没有指定你的表名，所以你必须解决这个问题。

```
;WITH x AS 
(
  SELECT idEvent, idService, dateCreated, rn = ROW_NUMBER() OVER 
    (PARTITION BY idService ORDER BY dateCreated DESC)
  FROM dbo.table_something_like_this
)
SELECT idEvent, idService, dateCreated
FROM x
WHERE rn = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:56:49.860

与 Aaron 的非常相似，但只是主题上的一个小变化。在[这里提琴](http://sqlfiddle.com/#!3/86915/4)

```
create table the_table 
(
  idEvent INT,
  idService INT,
  dateCreated DATETIME
)

insert into the_table
values
 ( 1, 1, '01 JAN 2012'),
 ( 2, 1, '02 FEB 2012'),
 ( 3, 2, '01 JAN 2012'),
 ( 4, 2, '02 FEB 2012')

SELECT *
FROM 
     the_table a
    INNER JOIN 
        (
        SELECT 
          idEvent
          , rk = RANK() OVER (PARTITION BY idService ORDER BY dateCreated DESC) 
        FROM the_table 
        )b
        ON
        a.idEvent = b.idEvent
        AND b.rk= 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:03:34.970

从Whytheq 中窃取了一些代码，我将其重写为使用 group by 和 table 变量。

```
 DECLARE @the_table TABLE
        (
         idEvent INT
        ,idService INT
        ,dateCreated DATETIME
        )

INSERT  INTO @the_table
VALUES  (1,1,'01 JAN 2012'),
        (2,1,'02 FEB 2012'),
        (3,2,'01 JAN 2012'),
        (4,2,'02 FEB 2012')

SELECT  MAX(idEvent)
FROM    @the_table
GROUP BY idService 
```

# mysql - MySQL：每天按顺序选择 10 行，并在特定组中

> ID：11506894
> 
> 赞同：0
> 
> 时间：2012-07-16T14:54:20.297
> 
> 标签：mysql

我有 MySql 数据库，其中包含许多带有日期（时间戳）和更多属性的记录。例如，“testTable”看起来像

a varchar(255)
b int(11)
时间戳 bigint(20)

我需要在 1 月 1 日至 1 月 15 日的一段时间内每天找到 sum(b) 的前 10 名，这些日期可以由用户指定。

迭代查询会是什么样子？粗略的方法可能是单独的选择语句，其间有 UNION ALL。

```
select a, sum(b) from testTable where FROM_UNIXTIME( timestamp ) between '2012-01-01 05:10:00' and '2012-01-02 05:10:00' group by a order by sum(b) desc LIMIT 10
UNION ALL
select a, sum(b) from testTable where FROM_UNIXTIME( timestamp ) between '2012-01-02 05:10:00' and '2012-01-03 05:10:00' group by a  order by sum(b) desc LIMIT 10
UNION ALL
select a, sum(b) from testTable where FROM_UNIXTIME( timestamp ) between '2012-01-03 05:10:00' and '2012-01-04 05:10:00' group by a order by sum(b) desc LIMIT 10
..
..
..
UNION ALL
select a, sum(b) from testTable where FROM_UNIXTIME( timestamp ) between '2012-01-14 05:10:00' and '2012-01-15 05:10:00' group by a order by sum(b) desc LIMIT 10 ;</br> 
```

但我希望它更通用，用户可以运行具有 2 个给定日期的脚本。

输出就像
一个 | FROM_UNIXTIME（时间戳）| 总和 (b)
------------+------------+------
测试 | 2012-01-01 03:24:41-04 | 500
测试 | 2012-01-01 03:19:40-04 | 420
测试| 2012-01-01 03:14:39-04 | 261
测试 | 2012-01-01 03:09:38-04 | 244
测试| 2012-01-01 03:04:37-04 | 231
测试| 2012-01-01 02:59:36-04 | 223
测试| 2012-01-01 02:54:35-04 | 211
测试1 | 2012-01-01 02:49:34-04 | 199
测试1 | 2012-01-01 03:24:41-04 | 195
测试1 | 2012-01-01 03:19:40-04 | 191
新 | 2012-01-02 06:11:06-04 | 1000
新| 2012-01-02 06:06:06-04 | 978
新| 2012-01-02 06:01:06-04 | 867
新 | 2012-01-02 05:56:05-04 | 786
新| 2012-01-02 05:51:05-04 | 698
新| 2012-01-02 05:46:05-04 | 第598
章 2012-01-02 06:11:06-04 | 第476
章 2012-01-02 05:41:04-04 | 第345
章 2012-01-02 06:06:06-04 | 250 新2
| 2012-01-02 06:01:06-04 | 125

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:15:54.310

试试这个...更改介于范围内的日期以仅通过该范围一次。

**更正**了错字、省略的行和缺少逗号：

```
select day, a, tot
from 
   (
   select 
      *,
      @num := if(@day =  tt4.day, @num + 1, 1) as row_number,
      @day := tt4.day as dummy
   from
      (
      select
         ts as day, 
         tt1.a, 
         sum(tt1.b) as tot
      from 
         testTable tt1, 
         ( select distinct date(FROM_UNIXTIME(tt2.timestamp)) as ts
           from   testTable tt2
           where  date(FROM_UNIXTIME(tt2.timestamp)) between cast('2012/01/01' as date) and cast('2012/01/15' as date) ) as tt3
      where 
         date(FROM_UNIXTIME(tt1.timestamp)) = tt3.ts
      group by 
         date(FROM_UNIXTIME(tt1.timestamp)), 
         tt1.a
      order by 
         date(FROM_UNIXTIME(tt1.timestamp)),
         sum(tt1.b) desc,
         tt1.a
      ) as tt4
   ) as tt5
where 
   tt5.row_number <=10 
```

**已修改**- 为 Vertica 更改了 SQL 的风格...语法可能已关闭（我没有要测试的 Vertica 安装），但要点就在那里。

```
select day, a, tot
from 
   (
   select 
      *,
      ROW_NUMBER() OVER (PARTITION BY tt4.day) as row_number
   from
      (
      select
         ts as day, 
         tt1.a, 
         sum(tt1.b) as tot
      from 
         testTable tt1, 
         ( select distinct date(TO_TIMESTAMP(tt2.timestamp)) as ts
           from   testTable tt2
           where  date(TO_TIMESTAMP(tt2.timestamp)) between cast('2012/01/01' as date) and cast('2012/01/15' as date) ) as tt3
      where 
         date(TO_TIMESTAMP(tt1.timestamp)) = tt3.ts
      group by 
         date(TO_TIMESTAMP(tt1.timestamp)), 
         tt1.a
      order by 
         date(TO_TIMESTAMP(tt1.timestamp)),
         sum(tt1.b) desc,
         tt1.a
      ) as tt4
   ) as tt5
where 
   tt5.row_number <=10 
```

# javascript - 预选 UI 上的下拉菜单

> ID：11506896
> 
> 赞同：1
> 
> 时间：2012-07-16T14:54:23.017
> 
> 标签：javascript, jquery, asp.net-mvc

在我的应用程序 UI 中，我有以下字段：显示日期的日期选择器、小时下拉列表、分钟下拉列表和上午/下午下拉列表。

ViewModel 正在返回一个日期时间值，我根据该值设置下拉列表：

```
 function setSelectedIndex(s, valsearch) {
        // Loop through all the items in drop down list
        for (i = 0; i < s.options.length; i++) {
            if (s.options[i].value == valsearch) {
                // Item is found. Set its property and exit
                s.options[i].selected = true;
                break;
            }
        }
        return;
    }

        setSelectedIndex($("#ScheduledHour"), '<%= Model.Scheduled.Value.Hour %>');
        setSelectedIndex($("#ScheduledMinute"), '<%= Model.Scheduled.Value.Minute %>'); 
```

这是标记：

```
<select id="ScheduledHour" name="ScheduledHour" >
                        <option value="1">1 </option>
                        <option value="2">2 </option>
                        <option value="3">3 </option>
                        <option value="4">4 </option>
                        <option value="5">5 </option>
                        <option value="6" >6 </option>
                        <option value="7">7 </option>
                        <option value="8">8 </option>
                        <option value="9">9 </option>
                        <option value="10">10 </option>
                        <option value="11">11 </option>
                        <option value="12">12 </option>                       
                    </select></li> 
```

Model.Scheduled.Value.Hour 和 Model.Scheduled.Value.Minute 返回正确的值，但未在 UI 上设置它们。关于我可能遗漏的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:09:01.333

尝试这个：

```
$("#ScheduledHour").val("<%= Model.Scheduled.Value.Hour %>");
$("#ScheduledMinute ").val("<%= Model.Scheduled.Value.Minute %>"); 
```

**jQuery：**

**.val（值）**

描述：设置匹配元素集合中每个元素的值。

```
value: A string of text or an array of strings corresponding to the value of each matched element to set as selected/checked. 
```

**.val()**

描述：获取匹配元素集中第一个元素的当前值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:00:32.730

是在做：

```
$('#ScheduledHour option[value="<%= Model.Scheduled.Value.Hour %>"]').attr("selected", "selected");

$('#ScheduledMinute option[value="<%= Model.Scheduled.Value.Minute %>"]').attr("selected", "selected"); 
```

不在话下？？我很欣赏这是一个基于 jquery 的解决方案，但你已经包含了该标签，所以看起来很合适。

# java - 由于 SWIG 似乎不适用于托管 C++/CLI，我还能使用什么（与 Java 通信）？

> ID：11506897
> 
> 赞同：2
> 
> 时间：2012-07-16T14:54:22.950
> 
> 标签：java, c++-cli, swig

我有一个 Java GUI 应用程序，它通过 SWIG 生成的文件在后端与基于标准 C++ 的 DLL 进行了很好的交互。后端程序目前是 C++ 和托管 C++/CLI 的组合。问题是我们最终可能会将其全部移植到 C++/CLI。

如果我错了，请纠正我，但据我所知，SWIG 目前不适用于 C++/CLI，并且没有计划这样做。我想我可以编写 JNI 代码来使其工作。但是使用 SWIG 要容易得多。那么还有哪些其他选择呢？使用越简单越好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T20:14:29.550

说 SWIG 不能与 C++/CLI 一起使用是不正确的……您应该能够以与您完全相同的方式使用生成的互操作存根。我没有遇到过启用 CLR 支持会破坏现有格式良好的 C++ 代码的情况......

# rally - 从用户故事自定义字段的下拉列表中进行多选

> ID：11506899
> 
> 赞同：2
> 
> 时间：2012-07-16T14:54:24.603
> 
> 标签：rally

目前，我有一个关于用户故事和缺陷的自定义字段，供我们的开发人员标记哪些系统受到他们的代码更改的影响。目前我只看到一个下拉菜单，这是一个单一的选择。有没有办法让他们有机会在下拉菜单中多选选项？还是有其他更好的对象？提前感谢我一直在这里得到的所有巨大帮助:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:21:26.347

模拟多选自定义字段的最佳选择是使用[Tags](http://www.rallydev.com/help/use-tags)。如果您使用自定义应用程序管理这些故事和缺陷，您可以限制您显示的标签或允许他们在该应用程序中进行选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:38:44.093

正如查尔斯所指出的，您可能想尝试使用扩展它的 MultiObjectPicker 或 TagPicker。如果您想坚持使用 ComboBox，则可以通过将“multiSelect”配置字段设置为“true”来启用多选。

# java - 何时在代码中捕获 RuntimeExceptions？

> ID：11506900
> 
> 赞同：6
> 
> 时间：2012-07-16T14:54:43.123
> 
> 标签：java, exception, exception-handling

在使用 java 编程时，我作为程序员是否应该考虑捕获 RuntimeExceptions ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T14:56:59.143

您捕获 RuntimeException 的原因与捕获任何异常的原因相同：您计划对它做一些事情。也许您可以纠正导致异常的任何原因。也许您只是想用不同的异常类型重新抛出。

然而，捕捉并忽略任何异常是非常糟糕的做法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T14:59:40.850

这是我能想到的。

1.  如果您想在出现问题时向最终用户显示一条好消息，请捕获**RuntimeException**并记录它。然后在屏幕上显示一些好消息而不是爆破错误。
2.  要将特定于框架的**CheckedExceptions**包装到特定于应用程序的**RuntimeExceptions**中。最好使用**RuntimeException**作为您的自定义异常，如此[处](http://jyops.blogspot.in/2012/03/why-should-you-use-unchecked-exceptions.html)所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T15:01:54.237

如果要向用户显示自定义消息，则基于用户验证，然后选择`RuntimeException`.

将您的自定义消息包装起来，然后将其扔掉。

```
throw new RuntimeException("Invalid userName/Password !"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:16:07.927

基本上，您唯一想抓住一个的时间是当您不能让您的应用程序崩溃时。[这是一篇很好的文章](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html)，更详细地描述了这一点，但这里引用了一个总结：

```
"If a client can reasonably be expected to recover from an exception, make it a 
checked exception. If a client cannot do anything to recover from the exception,
make it an unchecked exception". 
```

由于未经检查的异常基本上只是代码中的错误，并且实际上应该只在对它们无能为力的情况下抛出，所以您想要捕获的唯一实时是当您不能让您的应用程序崩溃时。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-16T15:01:32.720

是的：只要你能并且想从他们那里恢复过来。

许多常见的异常都继承自`RuntimeException`，并且根据特定情况，每个异常可能会或可能不会恢复。类`RuntimeException`本身并不意味着必须或不能捕获异常。

例如，您可能有一个`IllegalArgumentException`在某些输入上引发的库方法。如果适用于您的程序，您可以捕获此异常并以某种方式恢复，例如尝试不同的输入，或向用户解释操作无法继续的原因。

# python - Python：解析指标数据的简单脚本

> ID：11506902
> 
> 赞同：0
> 
> 时间：2012-07-16T14:54:48.830
> 
> 标签：python

我有一个小的 Python 脚本需要修改，因为度量文件的格式略有变化。我根本不了解 Python，并试图诚实地自己修复它。这些更改对我来说很有意义，但显然脚本仍然存在一个问题。否则，其他一切都在工作。脚本如下所示：

```
import sys
import datetime

##########################################################################

now = datetime.datetime.now();
logFile = now.strftime("%Y%m%d")+'.QE-Metric.log';

underlyingParse = True;
strParse = "UNDERLYING_TICK";
if (len(sys.argv) == 2):
    if sys.argv[1] == '2':
    strParse = "ORDER_SHOOT";
        underlyingParse = False;
elif (len(sys.argv) == 3):
    logFile = sys.argv[2];    
    if sys.argv[1] == '2':
    strParse = "ORDER_SHOOT";
        underlyingParse = False;
else:
    print 'Incorrect number of arguments. Usage: <exec> <mode (1) Underlying (2) OrderShoot> <FileName (optional)>'
    sys.exit()

##########################################################################

# Read the deployment file
FIput = open(logFile, 'r');
FOput = open('ParsedMetrics.txt', 'w');

##########################################################################

def ParseMetrics( file_lines ):

    ii = 0
    tokens = []; 
    for ii in range(len(file_lines)):

        line = file_lines[ii].strip()

        if (line.find(strParse) != -1):

             tokens = line.split(",");
             currentTime = float(tokens[2])

             if (underlyingParse == True and ii != 0):
                 newIndex = ii-1
                 prevLine = file_lines[newIndex].strip()
                 while (prevLine.find("ORDER_SHOOT") != -1 and newIndex > -1):
                     newIndex -= 1;
                     tokens = prevLine.split(",");
                     currentTime -= float(tokens[2]);
                     prevLine = file_lines[newIndex].strip();

         if currentTime > 0:
                 FOput.write(str(currentTime) + '\n')

##########################################################################

file_lines = FIput.readlines()
ParseMetrics( file_lines );

print 'Metrics parsed and written to ParsedMetrics.txt' 
```

一切工作正常，除了应该反向迭代前几行以添加自上次发生 UNDERLYING_TICK 事件以来的 ORDER_SHOOT 数字的逻辑（从代码开始：if (underlyingParse == True and ii != 0):.. .) 然后从正在处理的当前 UNDERLYING_TICK 事件行中减去该总数。这是正在解析的文件中的典型行的样子：

```
08:40:02.039387(+26): UNDERLYING_TICK, 1377, 1499.89 
```

基本上，我只对最后一个数据元素（1499.89）感兴趣，它是以微秒为单位的时间。我知道这一定很愚蠢。我只需要另一双眼睛。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:37:38.363

目前还不清楚您的输出有什么问题，因为您没有显示您的输出，我们也无法真正理解您的输入。

我假设以下内容：

1.  行被格式化为“absolutetime: TYPE, positiveinteger, float_time_duration_in_ms”，其中最后一项是事物所花费的时间。
2.  行按“绝对时间”排序。因此，属于 UNDERLYING_TICK 的 ORDER_SHOOT 始终位于自最后一个 UNDERLYING_TICK（或文件开头）以来的行上，并且*仅*位于那些行上。如果这个假设*不*成立，那么您需要先对文件进行排序。您可以使用单独的程序（例如管道输出`sort`）来执行此操作，或者使用该[`bisect`](http://docs.python.org/library/bisect.html)模块来存储排序的行并轻松提取相关行。

如果这两个假设都成立，请查看以下脚本。（未经测试，因为我没有大的输入样本或输出样本可供比较。）

这是一种更 Pythonic 的风格，更容易阅读和理解，不使用全局变量作为函数参数，并且应该更高效，因为它不会向后迭代行或将整个文件加载到内存中解析它。

它还演示了如何使用该[`argparse`模块](http://docs.python.org/howto/argparse.html)进行命令行解析。这不是必需的，但如果您有很多命令行 Python 脚本，您应该熟悉它。

```
import sys

VALIDTYPES = ['UNDERLYING_TICK','ORDER_SHOOT']

def parseLine(line):
    # format of `tokens`:
    # 0 = absolute timestamp
    # 1 = event type
    # 2 = ???
    # 3 = timedelta (microseconds)
    tokens = [t.strip(':, \t') for t in line.strip().split()]
    if tokens[1] not in VALIDTYPES:
        return None
    tokens[2] = int(tokens[2])
    tokens[3] = float(tokens[3])
    return tuple(tokens)

def parseMetrics(lines, parsetype):
    """Yield timedelta for each line of specified type

    If parsetype is 'UNDERLYING_TICK', subtract previous ORDER_SHOOT 
    timedeltas from the current UNDERLYING_TICK delta before yielding
    """
    order_shoots_between_ticks = []
    for line in lines:
        tokens = parseLine(line)
        if tokens is None:
            continue # go home early
        if parsetype=='UNDERLYING_TICK':
            if tokens[1]=='ORDER_SHOOT':
                order_shoots_between_ticks.append(tokens)
            elif tokens[1]=='UNDERLYING_TICK':
                adjustedtick = tokens[3] - sum(t[3] for t in order_shoots_between_ticks)
                order_shoots_between_ticks = []
                yield adjustedtick
        elif parsetype==tokens[1]:
            yield tokens[3]

def parseFile(instream, outstream, parsetype):
    printablelines = ("{0:f}\n".format(time) for time in parseMetrics(instream, parsetype))
    outstream.writelines(printablelines)

def main(argv):
    import argparse, datetime
    parser = argparse.ArgumentParser(description='Output timedeltas from a QE-Metric log file')
    parser.add_argument('mode', type=int, choices=range(1, len(VALIDTYPES)+1),
        help="the types to parse. Valid values are: 1 (Underlying), 2 (OrderShoot)")
    parser.add_argument('infile', required=False,
        default='{}.QE-Metric.log'.format(datetime.datetime.now().strftime('%Y%m%d'))
        help="the input file. Defaults to today's file: YYYYMMDD.QE-Metric.log. Use - for stdin.")
    parser.add_argument('outfile', required=False,
        default='ParsedMetrics.txt',
        help="the output file. Defaults to ParsedMetrics.txt. Use - for stdout.")
    parser.add_argument('--verbose', '-v', action='store_true')
    args = parser.parse_args(argv)

    args.mode = VALIDTYPES[args.mode-1]

    if args.infile=='-':
        instream = sys.stdin
    else:
        instream = open(args.infile, 'rb')

    if args.outfile=='-':
        outstream = sys.stdout
    else:
        outstream = open(args.outfile, 'wb')

    parseFile(instream, outstream, args.mode)

    instream.close()
    outstream.close()

    if args.verbose:
        sys.stderr.write('Metrics parsed and written to {0}\n'.format(args.outfile))

if __name__=='__main__':
    main(sys.argv[1:]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:02:35.510

因此，如果命令行选项为 2，该函数会创建一个输出文件，其中所有行仅包含输入文件中包含“order_shoot”标记的行的“时间”部分？

如果命令行选项为 1，该函数会为输入文件中包含“underlying_tick”标记的每一行创建一个输出文件，除了你想要的数字是 underlying_tick 时间值减去所有 order_shoot 时间值发生在前面的基础标记值之后（或者如果这是第一个，则从文件的开头开始）？

如果这是正确的，并且所有行都是唯一的（没有重复），那么我建议使用以下重写脚本：

```
#### Imports unchanged.

import sys 
import datetime 

#### Changing the error checking to be a little simpler.
#### If the number of args is wrong, or the "mode" arg is
#### not a valid option, it will print the error message
#### and exit.

if len(sys.argv) not in (2,3) or sys.argv[2] not in (1,2):
    print 'Incorrect arguments. Usage: <exec> <mode (1) Underlying (2) OrderShoot> <FileName (optional)>'
    sys.exit()  

#### the default previously specified in the original code.

now = datetime.datetime.now()

#### Using ternary logic to set the input file to either
#### the files specified in argv[2] (if it exists), or to
#### the default previously specified in the original code.

FIput = open((sys.argv[2] if len(sys.argv)==3 
                          else now.strftime("%Y%m%d")+'.QE-Metric.log'), 'r');

#### Output file not changed.

FOput = open('ParsedMetrics.txt', 'w');

#### START RE-WRITTEN FUNCTION

def ParseMetrics(file_lines,mode): 

#### The function now takes two params - the lines from the 
#### input file, and the 'mode' - whichever the user selected
#### at run-time. As you can see from the call down below, this
#### is taken straight from argv[1]. 

    if mode == '1':

#### So if we're doing underlying_tick mode, we want to find each tick,
#### then for each tick, sum the preceding order_shoots since the last
#### tick (or start of file for the first tick).

        ticks = [file_lines.index(line) for line in file_lines \
                                        if 'UNDERLYING_TICK' in line]

#### The above list comprehension iterates over file_lines, and creates
#### a list of the indexes to file_lines elements that contain ticks.
#### 
#### Then the following loop iterates over ticks, and for each tick,
#### subtracts the sum of all times for order_shoots that occure prior
#### to the tick, from the time value of the tick itself. Then that
#### value is written to the outfile.

        for tick in ticks:
            sub_time = float(file_lines[tick].split(",")[2]) - \
                       sum([float(line.split(",")[2]) \ 
                       for line in file_lines if "ORDER_SHOOT" in line \
                       and file_lines.index(line) <= tick]
            FOput.write(float(line.split(",")[2]))    

#### if the mode is 2, then it just runs through file_lines and
#### outputs all of the order_shoot time values.

    if mode == '2':
        for line in file_lines:
            if 'ORDER_SHOOT' in line:
                FOput.write(float(line.split(",")[2]))

#### END OF REWRITTEN FUNCTION

#### As you can see immediately below, we pass sys.argv[2] for the
#### mode argument of the ParseMetrics function.

ParseMetrics(FIput.readlines(),sys.argv[2])

print 'Metrics parsed and written to ParsedMetrics.txt' 
```

这应该可以解决问题。主要问题是，如果您有任何带有“UNDERLYING_TICK”的行与任何其他此类行完全相同，那么这将不起作用。需要应用不同的逻辑来获得正确的索引。

我相信有办法让这变得更好，但这是我的第一个想法。

还值得注意的是，为了便于阅读，我在上面的源代码中添加了很多内联换行符，但如果你按照书面方式使用它们，你可能想要拉它们。

# dynamics-crm-2011 - 功能区按钮的自定义快捷方式

> ID：11506907
> 
> 赞同：0
> 
> 时间：2012-07-16T14:55:08.460
> 
> 标签：dynamics-crm-2011

我希望用户能够从 Products 实体的主网格中复制产品编号。

为此，我添加了请求产品编号的按钮并将其放入剪贴板中`window.clipboardData.setData('text', 'P/N')`。

但是为了更容易，功能区按钮必须有一个快捷方式（`Ctrl`+ `C`）。

如何以受支持的方式为按钮分配快捷方式？

我有哪些不受支持的选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:06:27.827

我知道的唯一选择是

1) 在 IE 中，您可以使用 execCommand('copy') 功能。您必须突出显示文本框中的文本才能实际复制它。

2) 在 ZeroClipboard 中使用 flash add

[https://github.com/jonrohan/ZeroClipboard](https://github.com/jonrohan/ZeroClipboard)

无论哪种方式，它都不受支持。

# ios - 滚动后 UITableViewCell 中的自定义视图被切断

> ID：11506910
> 
> 赞同：0
> 
> 时间：2012-07-16T14:55:15.040
> 
> 标签：ios, uitableview, custom-view

我有带有自定义 UITableViewCells 的 UITableView。Cells 包含一个自定义视图，它是 SSCheckBoxView 的略微修改版本（可在 GitHub 上获得）

当我在 TableView 中滚动并且单元格从屏幕上消失时，自定义视图在重新出现时被切断。

在滚动我的单元格之前看起来像这样： [https ://www.dropbox.com/s/hcyvgumhr7t1fxg/before.png](https://www.dropbox.com/s/hcyvgumhr7t1fxg/before.png)

这就是视图重新出现时的样子： [https ://www.dropbox.com/s/p6wirtj60ffssxm/after.png](https://www.dropbox.com/s/p6wirtj60ffssxm/after.png)

这是我的 TableViewController 中的 cellForRowAtIndexPath 方法

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *myIdentifier = @"CarpartTableViewCell";

    CarpartTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:myIdentifier];

    if (cell == nil) {
        cell = (CarpartTableViewCell*) [[[NSBundle mainBundle] loadNibNamed:@"CarpartTableViewCell" 
                                                           owner:self 
                                                         options:nil] objectAtIndex:0];
    }

    cell.delegate = self;
    cell.tag = indexPath.row;

    Carpart *part = [_parts objectAtIndex:indexPath.row];

    cell.carpart.text = part.name;

    [cell.checkboxMaterial setText:@"Alubauteil"];
    [cell.checkboxPushing setText:@"Vordrücken"];

    cell.checkboxMaterial.checked = part.material.boolValue;
    cell.checkboxPushing.checked = part.pushing.boolValue;

    cell.checkboxPushing.tag = indexPath.row;
    cell.checkboxMaterial.tag = indexPath.row;

    [cell.checkboxMaterial setStateChangedTarget:self selector:@selector(materialChanged:)];
    [cell.checkboxPushing setStateChangedTarget:self selector:@selector(pushingChanged:)];

    return cell;
} 
```

# html - 将 div 一分为二，占用所有可用的垂直空间

> ID：11506914
> 
> 赞同：4
> 
> 时间：2012-07-16T14:55:34.000
> 
> 标签：html, css

我正在尝试将一个 div 拆分为两个并排的 div。我知道这里有几个例子，但我已经搜索过，但没有找到一个允许 div 垂直占用所有可用空间，没有任何内容的例子。

看看[http://jsfiddle.net/kpDDM/3/](http://jsfiddle.net/kpDDM/3/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T14:57:53.327

要为您的 div 设置百分比高度，它们的父元素必须具有特定的高度。在这种情况下，您似乎需要它基于视口高度。为此，每个祖先 div 的高度必须为 100%：

```
*, html, body, .parent {
    height: 100%;
} 
```

JS 小提琴：http: [//jsfiddle.net/kpDDM/6/](http://jsfiddle.net/kpDDM/6/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T14:59:48.513

`&nbsp;`在您的 div 标签中添加。因为它们是 100% 而不是固定像素，所以它们需要内部的东西才能使它们可见。

If you want to make the div tags 100% of the page, then you need to state the page is 100% (so the div tags understand what 100% is).

`* { height:100%; }`

Changing the body and html tags to 100% is not necessary.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:59:08.530

`parent`即使它是父容器，你的分隔线也需要一个 %height `body`，没有明确的高度量。这表明您的`parent`分隔线将覆盖，`height:auto`而不是您想要的高度。

`parent`如果您希望这样做，您需要声明一个固定的高度。今天的现代浏览器不支持 parent 的默认显式高度量`body`。

因此，您需要确保明确定义您的高度`html`和`body`分隔线高度，如下所示：

```
html, body {
    height:100%;
} 
```

享受和好运！

# port - 在路由器或防火墙中阻止端口 1935

> ID：11506916
> 
> 赞同：1
> 
> 时间：2012-07-16T14:55:41.060
> 
> 标签：port, block

我需要通过尝试阻止端口 1935 连接到家用计算机的远程服务器来解决问题。注意，1935 是 Fl​​ash Media Server 的 RTMP 协议的默认端口。我的家用路由器是 Netgear 的。我按照他们的指示创建了一个“服务”，其中端口 1935 被“始终阻止”，然后将该服务添加到路由器防火墙规则的“传出”部分。但我的测试仍然显示从 Flash 客户端到端口 1935 的连接成功。

我认为 Windows 7 防火墙中可能有一些方法，但没有看到任何方法？任何想法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T06:27:15.467

尝试重新启动路由器。许多防火墙更改在路由器重新启动之前不会生效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T12:37:03.587

正确的答案是我在对@Matt 的评论中以及根据我的屏幕截图已经说过的话：

[https://docs.google.com/open?id=0BxaCdcZpiglQQ0ZPbERzS0pPWFE](https://docs.google.com/open?id=0BxaCdcZpiglQQ0ZPbERzS0pPWFE)

我在路由器中进行了正确设置：端口 1935 确实被阻止了。但是，我的测试 Flash 应用程序仍然报告 rtmp，这让我认为它仍然是端口 1935。它实际上是 rtmp over 端口 443，正如我后来发现的那样。

因此，如果有人想阻止 Netgear 路由器中的某些远程端口，那么他们可以按照我采取的步骤操作：使用所需端口创建“服务”；然后根据我的屏幕截图将该服务添加到防火墙规则“传出”部分。谢谢你，马特，你的帮助！

# javascript - HTML 5 - Drag n Drop - 如果放置目标被完全占用，则不会触发 ondragover 事件

> ID：11506917
> 
> 赞同：0
> 
> 时间：2012-07-16T14:55:45.043
> 
> 标签：javascript, html, drag-and-drop, jquery-events

我有一个带有左窗格和右窗格的容器。您可以从左窗格拖动，然后放在右窗格中。由于某种原因，如果放置目标已经完全被占用，则不会触发 html 5 ondragover 事件。我的放置目标是一个 div，当 ondrop 事件发生时，我会在其中动态创建 iframe。当我第一次从左侧拖动某些东西并将其放到左侧时，我能够创建第一个 iframe。但是现在第二次，如果我从左边拖动一些东西并尝试将它放到右边，ondragover 没有被触发（我放了断点，它没有被击中），因为放置目标已经被我的第一个 iframe 填满. 在 ondragover 监听器中，我想将现有 iframe 的高度降低到一半，以便为创建新 iframe 腾出空间。但不幸的是，ondragover 并没有被触发。有什么方法可以修改 ondragover 的行为，即使放置目标完全被占用，它也会被触发？任何帮助将不胜感激。所以，这里是代码..

```
function onDragOver(ev) {
 ev.preventDefault();
 if(iframes_count > 4)
 {
   return;
 }
 if (iframes_count == 2)
 {
    if ((getDivLeftCoordinate() < ev.pageX < getDroppableWidth()) && (getDivTopCoordinate() < ev.pageY < getDroppableHeight()/2))
    {
        var existingFrames = document.getElementsByTagName("iframe");
        for (var i = 0; i < existingFrames.length; i++)
        {
          $(this).attr("height" , 500);
        }
    }
 }
 $("#right_pane").css("background-color", "grey");
}

function onDrop(ev) {
 ev.preventDefault();

var data_id = ev.dataTransfer.getData("Text");
var data_id_selector= "#" + data_id;
var content_id = data_id + "content";
var content_id_selector = "#" + content_id;
var url = $(data_id_selector).data("url");
var iframe_width = 100 + "%";
var iframe_height = 100 + "%";

$(data_id_selector).remove();
$("<iframe />", {
class: "myFrame",
id : content_id,

}).appendTo('#right_pane');

$(content_id_selector).attr("height", iframe_height);
$(content_id_selector).attr("width", iframe_width);
$(content_id_selector).attr("src", url);
$(content_id_selector).attr("background-color", "white");
$("#right_pane").css("background-color", "white");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:31:45.613

也许只是语法问题，HTML5 中的事件是`dragover`(no `on`)

更多 html5 拖放信息：

*   [http://www.w3.org/TR/2010/WD-html5-20101019/dnd.html](http://www.w3.org/TR/2010/WD-html5-20101019/dnd.html)
*   [http://www.whatwg.org/specs/web-apps/current-work/multipage/dnd.html](http://www.whatwg.org/specs/web-apps/current-work/multipage/dnd.html)
*   [http://www.html5rocks.com/en/tutorials/dnd/basics/](http://www.html5rocks.com/en/tutorials/dnd/basics/)
*   [http://html5demos.com/drag](http://html5demos.com/drag)

# groovy - 在 Groovy XML Parser 中使用字符串作为代码

> ID：11506920
> 
> 赞同：3
> 
> 时间：2012-07-16T14:55:57.787
> 
> 标签：groovy, xml-parsing

我是 groovy 的新手——我希望这是一件很容易解决的事情。我正在阅读一个 xml 文档，然后我可以访问这样的数据：

```
def root = new XmlParser().parseText(xmlString)
println root.foo.bar.text() 
```

我想做的是从文件或数据库中加载路径的“foo.bar”部分，这样我就可以做这样的事情：

```
def paths = ["foo.bar","tashiStation.powerConverter"] // defined for this example
paths.each { 
    path ->
    println path + "\t" + root.path.text()
} 
```

显然，编写的代码不起作用......我想也许这会起作用：

```
paths.each { 
    path ->
    println path + "\t" + root."${path}".text()
} 
```

...但事实并非如此。我的初始解决方案基于 Groovy for DSL 的 pg 153，其中可以以类似的方式创建动态方法。

想法？理想的解决方案不会添加大量代码，也不会添加任何额外的库依赖项。我总是可以回退到用 JDOM 在 Java 中做这些事情，但我希望有一个优雅的 groovy 解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T15:15:36.950

[这与3 天前](https://stackoverflow.com/questions/11468189/accessing-a-property-with-object-property)的这个问题和[这个问题](https://stackoverflow.com/questions/11468189/accessing-a-property-with-object-property)非常相似

你基本上需要分割你的路径`.`，然后沿着这个列表遍历你的对象图

```
def val = path.split( /\./ ).inject( root ) { obj, node -> obj?."$node" }?.text()
println "$path\t$val" 
```

在这种情况下应该这样做:-)

# facebook-credits - 应用程序中的促销横幅

> ID：11506922
> 
> 赞同：-1
> 
> 时间：2012-07-16T14:56:04.357
> 
> 标签：facebook-credits, promotions

在我的应用程序中播放，出现在右侧面板中，一个关于获得 Facebook 积分的促销活动将在我的应用程序中播放。我不允许这种促销活动，显然，我的应用程序中没有必要的 Facebook 积分。谁是该横幅的负责人，我如何与他们联系并删除该横幅？

点击促销后，会出现购买Facebook Credits的界面。我担心网络钓鱼活动，我想最后一点是我的玩家会对游戏以及游戏和公司的政治产生错误的看法。

有没有办法删除这些促销？

亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:40:09.420

Facebook 根据自己的秘密算法自动执行此操作。我不知道禁用它的任何选项。

在我实施 Credits 之前，我从未在我的应用程序上看到过。您是说即使您没有实施 Facebook Credits 也会看到它出现？我认为这值得在 Facebook 上打开一个错误。

# jquery - Jquery选择自定义标签的innerText

> ID：11506927
> 
> 赞同：1
> 
> 时间：2012-07-16T14:56:26.183
> 
> 标签：jquery, jquery-selectors, innertext

我希望这很简单，但是在进行了很多谷歌搜索并尝试了选择器、find()、content()、text() 等之后，我并没有完全做到这一点。任何帮助，将不胜感激。

我在网页中有一些自定义标记。

```
<div id="myGrid">
    <url>www.google.com</url>
    <columns>
        <column>ID</column>
        <column>Position</column>
        <column>FirstName</column>
        <column>LastName</column>
    </columns>
</div> 
```

我需要将文本选择`<url>`到变量中。我还需要将`<columns>`'s 的集合放入一个变量（数组/集合）中。

标签名称将是标识符，即我不能使用 ID 或 CLASS 来查找这些元素。

似乎它应该是可行的，但到目前为止我的尝试都是失败的......非常感谢任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:07:17.430

我将为您提供有关 url 的帮助，因为它非常基本。这应该可以帮助您处理这些列。

Jquery 将选择您提供的任何元素。您可以使用任何元素名称。在这里查看[jsfiddle](http://jsfiddle.net/7cNwv/)。

如果你担心 IE 问题，使用`document.createElement('url')`which 会告诉 IE url 是文档的一个元素

```
document.createElement('url');  //crutch for IE

$(document).ready(function() {
    alert($('url').html());  
})​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:10:13.037

```
var $t = {}
var i = 0;   

$('#myGrid').find('column').each(function(){

    $t[i] = $(this).text();
    i++;

});

alert($('#myGrid url').text());
alert($t.toSource()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T15:07:06.713

```
var url = $("url").html();
var columns = $.makeArray($("column").find("columns").html()); 
```

虽然我没有测试以上，更好的方法是使用 jQuery 'each' 函数：

```
var a = Array();
$('#myGrid').find('column').each(function(){
    a.push($(this).html());
}); 
```

并测试：`alert(a[2]);`其中数字是数组编号。

其中 url 是您的 url（duh），而 columns 是您的列数组。如果只有一个，或者如果您在函数中使用它，这将非常有用，在这种情况下，我会将选择器更改为`$("url", this).html();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:07:24.207

这个怎么样（jsbin版本[http://jsbin.com/ucivav](http://jsbin.com/ucivav)）？

```
var url = $("#myGrid url").text();
var $cols = $("#myGrid columns column");
alert(url);
alert($cols.first().text()); 
```

# msbuild - Nuget：是否有可用于获取包工具文件夹位置的转换令牌？

> ID：11506935
> 
> 赞同：1
> 
> 时间：2012-07-16T14:56:57.133
> 
> 标签：msbuild, nuget

我正在尝试使用 Nuget 分发 ms build .targets 文件。我需要修改文件的一些元素以包含一些程序集的安装路径。为此，我想使用工具文件夹。我很难找到令牌（如果存在）来进行替换。有没有人遇到过这个问题或知道解决方法？

[http://docs.nuget.org/docs/creating-packages/configuration-file-and-source-code-transformations](http://docs.nuget.org/docs/creating-packages/configuration-file-and-source-code-transformations)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:10:58.323

您必须走 PowerShell 路线才能完成此操作，因为 AFAIK 不存在任何转换。init.ps1 文件可以处理 NuGet VSIX 提供的一些参数。

只需将以下内容添加到 init.ps1 文件的顶部，并在修改文件内容的脚本中使用**$installPath**变量。

> 参数（$installPath，$toolsPath，$package，$project）

[在此处](https://github.com/myget/NuGetPackages/blob/master/NuSpec/tools/init.ps1)查看示例用法。

# vmware - VMWare VIM SDK。列出所有 VM 的工作，但不列出所有数据源。我错过了什么吗？

> ID：11506936
> 
> 赞同：0
> 
> 时间：2012-07-16T14:56:57.977
> 
> 标签：vmware

我的目标是获取特定数据中心中所有数据存储的列表。我能够列出所有主机和虚拟机，但不能列出数据存储，我不明白为什么（我仍在学习 API）。任何见解将不胜感激。

这是获取所有 VM 的代码（按预期工作）：

```
public List<VM> getVMsInDatacenter(String datacenter, IEnumerable<String> properties)
{
  List<VM> VMs = null;

  this.joinConnection((appUtil) =>
  {
    var svcUtil = appUtil.getServiceUtil();
    var dcMoRef = svcUtil.GetDecendentMoRef(null, "Datacenter", datacenter);

    var typeinfo = buildTypeInfo("VirtualMachine", properties.ToList());

    VMs = buildVMsFromObjectContent(svcUtil.GetContentsRecursively(null, dcMoRef, typeinfo, true));
  });
  return VMs;
} 
```

这是 Datastore 的类似代码（不能按预期工作）：

```
public List<DataStore> getDataStoresInDatacenter(String datacenter, IEnumerable<String> properties)
{
  List<DataStore> DataStores = null;

  this.joinConnection((appUtil) =>
  {
    var svcUtil = appUtil.getServiceUtil();
    var dcMoRef = svcUtil.GetDecendentMoRef(null, "Datacenter", datacenter);

    var typeinfo = buildTypeInfo("Datastore", properties.ToList());

    DataStores = buildDataStoresFromObjectContent(svcUtil.GetContentsRecursively(null, dcMoRef, typeinfo, true));
  });
  return DataStores;
} 
```

appUtil 是随 VIM SDK 示例一起提供的 AppUtil 类的实例化。它包含连接、查询等功能。

joinConnection 是一种连接方法，如果我们已经连接，则重新使用连接。

如果对代码有任何其他问题，请告诉我。

另外，如果有更好的方法，我也想知道:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:13:53.557

发现了问题。getContentsRecursively 方法调用了一个名为“buildFullTraversal”的方法，该方法构建了一个遍历/选择规范。此方法没有为数据存储添加遍历。我添加了一个这样的：

```
TraversalSpec vmToDs = new TraversalSpec();
  vmToDs.name = "vmToDs";
  vmToDs.type = "VirtualMachine";
  vmToDs.path = "datastore";
  HToVm.skip = false;
  HToVm.skipSpecified = true; 
```

然后我修改了 visitFolders 遍历，如下所示：

```
// Recurse through the folders
  TraversalSpec visitFolders = new TraversalSpec();
  visitFolders.name = "visitFolders";
  visitFolders.type = "Folder";
  visitFolders.path = "childEntity";
  visitFolders.skip = false;
  visitFolders.skipSpecified = true;
  visitFolders.selectSet = new SelectionSpec[] { new SelectionSpec(), new SelectionSpec(), new SelectionSpec(), new SelectionSpec(), new SelectionSpec(), new SelectionSpec(), new SelectionSpec(), new SelectionSpec() };
  visitFolders.selectSet[0].name = "visitFolders";
  visitFolders.selectSet[1].name = "dcToHf";
  visitFolders.selectSet[2].name = "dcToVmf";
  visitFolders.selectSet[3].name = "crToH";
  visitFolders.selectSet[4].name = "crToRp";
  visitFolders.selectSet[5].name = "HToVm";
  visitFolders.selectSet[6].name = "rpToVm";
  visitFolders.selectSet[7].name = "vmToDs";
  return new SelectionSpec[] { visitFolders, dcToVmf, dcToHf, crToH, crToRp, rpToRp, HToVm, rpToVm, vmToDs }; 
```

现在，对 getContentsRecursively 的调用还将包括属于 VM 的数据存储，因此问题中的方法将按预期工作。

# .net - Asp.Net MVC数据传输原理

> ID：11506939
> 
> 赞同：2
> 
> 时间：2012-07-16T14:57:04.920
> 
> 标签：.net, asp.net-mvc

我知道 MVC 有很多方法来传递数据，例如 return View() 会将强类型模型从控制器发送到视图。也可以使用viewbag、viewdata、tempdata等等...

我只知道如何使用，但我想弄清楚它是如何传递数据的。谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:05:28.170

传递数据的最佳方法是通过`Model`类，然后返回它`return View(model);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:19:28.030

我认为要了解幕后真正发生的事情，就是看看 Asp.Net MVC 的来源。[你可以在这里](http://aspnet.codeplex.com/wikipage?title=MVC&referringTitle=Home)下载它们

# perl - 使用 Parallel::ForkManager 限制进程

> ID：11506940
> 
> 赞同：3
> 
> 时间：2012-07-16T14:57:05.100
> 
> 标签：perl, fork

我正在尝试使用 Parallel::ForkManager 来控制一些子进程。我想将同时运行的进程数限制为 10。我总共需要运行 20 个。

我知道我可以在对象声明的第一行将进程限制设置为 10，但我也使用 $pm 对象来运行执行不同操作的子进程（当前函数占用更多内存，因此需要加以限制）。

我目前的代码不起作用，永远不会调用完成时运行，所以剩下的 10 个孩子永远不会被分叉。我不明白为什么会这样——我原以为孩子在退出时仍会调用完成代码，并减少计数，但“if”语句似乎阻止了这一点。有人可以解释为什么会这样吗？

谢谢你的帮助！

```
# Parallel declarations
my $pm = Parallel::ForkManager->new(30);

$pm->run_on_finish(sub {
    my ($pid, $exit_code, $ident, $exit_signal, $core_dump, $data_str_ref) = @_; 
    --$active_jobs;
    })

my $total_jobs = 0;
my $active_jobs = 0;
while( $total_jobs < 20) {
    sleep 300 and next if $active_jobs > 10; 

    my $pid = $pm->start and ++$active_p1_jobs and ++$total_p1_jobs and next;

    my $return = module::function(%args);

    $pm->finish(0, { index => $total_jobs, return => $return }); 
    }

print STDERR "Submitted all jobs, now waiting for children to exit.\n";
$pm->wait_all_children(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:00:15.047

我将把限制为 10 个的工作称为“类型 2”。

这就是我使用 P::FM 的方式：

```
use strict;
use warnings;

use List::Util            qw( shuffle );
use Parallel::ForkManager qw( );
use POSIX                 qw( WNOHANG );
use Time::HiRes           qw( sleep );

use constant MAX_WORKERS       => 30;
use constant MAX_TYPE2_WORKERS => 10;

sub is_type2_job { $_[0]{type} == 2 }

my @jobs = shuffle(
   ( map { { type => 1, data => $_ } } 0..19 ),
   ( map { { type => 2, data => $_ } } 0..19 ),
);

my $pm = Parallel::ForkManager->new(MAX_WORKERS);

my $type2_count = 0;
$pm->run_on_finish(sub {
   my ($pid, $exit_code, $ident, $exit_signal, $core_dump, $job) = @_;
   --$type2_count if is_type2_job($job);
   print "Finished: $pid, $job->{type}, $job->{data}, $job->{result}\n";
});

my @postponed_jobs;
while (@postponed_jobs || @jobs) {
   my $job;
   if (@postponed_jobs && $type2_count < MAX_TYPE2_WORKERS) {
      $job = shift(@postponed_jobs);
   }
   elsif (@jobs) {
      $job = shift(@jobs);
      if ($type2_count >= MAX_TYPE2_WORKERS && is_type2_job($job)) {
         push @postponed_jobs, $job;
         redo;
      }
   }
   # elsif (@postponed_jobs) {
   #     # Already max type 2 jobs being processed,
   #     # but there are idle workers.
   #     $job = shift(@postponed_jobs);
   # }
   else {
      local $SIG{CHLD} = sub { };
      select(undef, undef, undef, 0.300);
      $pm->wait_one_child(WNOHANG);
      redo;
   }

   ++$type2_count if is_type2_job($job);

   my $pid = $pm->start and next;
   $job->{result} = $job->{data} + 100;  # Or whatever.
   $pm->finish(0, $job);
}

$pm->wait_all_children(); 
```

但这被打破了。选择下一项工作的代码应该在中间完成`start`（即在它等待孩子完成之后，但在它分叉之前），而不是在`start`. 这可能会导致作业无序运行。这不是我第一次希望 P::FM 有一个 pre-fork 回调。也许你可以向维护者要一个。

# script# - 在脚本上使用 Ember js

> ID：11506942
> 
> 赞同：0
> 
> 时间：2012-07-16T14:57:14.807
> 
> 标签：script#

我想用 script sharp 写下下面这行：

```
App.SP = SP = Ember.Object.extend({
init: function (lineV, lineH, resourceMethod){... 
```

这可能吗？我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:14:56.563

一般来说，每个脚本框架都有自己的定义类的变体模式，并且 script# 不支持所有可能的变体......所以你可以编写一个名为 SP 的 ac# 类，带有一个 Init 方法，并期望 EmberJS 的方式结果是定义类。

您可以做的是使用带有字典的扩展方法为 Ember.Object 定义类，用一堆名称/值对填充字典，例如“init”，其值设置为静态方法的委托。

示例（这只是一个开始，如果您继续这条路，我相信这将需要调整和更多的返工）：

在导入库中：

```
namespace EmberApi {

    [Imported, ScriptNamespace("Ember"), ScriptName("Object")]
    public static class EmberObject {

        public static object Extend(Dictionary<string, object> nameValuePairs) {
            return null;
        }
    }
} 
```

在您的代码中：

```
public static void App {

    static App() {
        Dictionary<string, object> members = new Dictionary<string, object>();
        members["init"] = Init;

        object sp = EmberObject.Extend(members);
    }

    public static void Init(int lineV, int lineH, string resourceMethod) { ... }
} 
```

所以我认为这是可能的，但是你失去了一堆价值道具，那就是像 c# 一样编写你的代码。

更合适的是能够使用现有的 API/框架，但将您自己的代码编写为常规 c# 类，利用将这些类型构造转换为脚本的 script# 模式。

如果有关于模式本身的建议，非常欢迎，尤其是。因为有考虑使 script# 模式在未来变得更轻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T18:06:37.650

在回答另一个问题时，我想到了一种新方法，我将把它作为一个有潜力的想法分享，以防你仍然感兴趣，或者为其他人感兴趣。

编译器假设有一个特定的运行时契约（由 mscorlib.js 实现），其中包括 Type.registerClass 等 API 和其他相关方法。与其他具有自己定义类型的模式的框架一起工作的一种方法是简单地重新实现 mscorlib.js，这样 registerClass 之类的方法就可以作为通往其他库的桥梁。

# java - JTable 未显示在 SQL 准备语句的 AS 部分中设置的列名

> ID：11506943
> 
> 赞同：0
> 
> 时间：2012-07-16T14:57:17.300
> 
> 标签：java, mysql, sql, swing, jtable

我知道如何手动设置 JTable 列名，但想知道是否有更好的方法，因为目前我有一个准备好的 sql 语句，它从 DB 中选择列名，使用 AS 'New Column Name' 显示为不同的名称，但是AS 部分中的名称没有显示出来，只是标准的 DB 列名......这应该以这种方式工作，还是除了使用 getColumnModel().getColumn(2) 手动设置列标题名称之外还有更好的方法。 setHeaderValue("新名称") ... ? 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:18:42.113

该`ResultSetMetaData`方法`getColumnLabel()`应该提供给定的文本`SELECT AS label`。例如，

```
PreparedStatement ps = conn.prepareStatement("SELECT name AS moniker, …");
ResultSet rset = ps.executeQuery();
while (rset.next()) {
    String name = rset.getString(1);
    System.out.println(rset.getMetaData().getColumnLabel(1)+ ": " + name …);
} 
```

# objective-c - 如何选择性地忽略 clang 关于使用已弃用的 Objective-C 实现的警告？

> ID：11506944
> 
> 赞同：15
> 
> 时间：2012-07-16T14:57:28.250
> 
> 标签：objective-c, clang, pragma, suppress-warnings

我正在为 iOS 5.1 更新[MGSplitViewController](https://github.com/mattgemmell/MGSplitViewController/)，并且我希望收到有关使用已弃用的 Objective-C 方法的警告。不幸的是，`MGSplitViewController`支持 iOS 3.2，所以我想支持所有已弃用的回调，但忽略有关它们的警告。

我已经`CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS`在我的目标构建设置中启用了关于“覆盖已弃用的 Objective-C 方法”（）的警告，但我不能忽略它

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS"

- (void) deprecated_objc_method_override {
}

#pragma clang diagnostic pop 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-16T14:57:28.250

`CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS`对应于`-Wdeprecated-implementations`，Xcode 不会在其“快速帮助”区域中显示。所以以下工作：

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wdeprecated-implementations"

- (void) deprecated_objc_method_override {
}

#pragma clang diagnostic pop 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-03-10T10:15:26.907

还有相关的`deprecated-declarations`标志。这会抑制类似“'foo' is deprecated: first deprecated in OS X 10.10 - Use -bar instead”之类的警告。

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wdeprecated-declarations"

   :

#pragma clang diagnostic pop 
```

# c# - 从本地托管的 Web 应用程序强制执行许可证

> ID：11506946
> 
> 赞同：4
> 
> 时间：2012-07-16T14:57:30.483
> 
> 标签：c#, javascript, .net, web-applications, licensing

假设我们有一个 Web 应用程序，它将是

*   可通过 Internet 访问的托管解决方案
*   能够在本地安装以用作“Intranet”应用程序

对此 Web 应用程序强制执行许可的最佳方式是什么，基本上可以轻松打开/关闭客户端的访问权限。我在想流程会是这样的：

> 客户端安装在本地 ---> 使用中央服务器授权 ---> 允许/拒绝访问

此外，我希望能够确保我们可以提供免费试用，本质上是打开和关闭应用程序的某些功能。我们还必须考虑如果我们“倒闭”会发生什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T15:15:12.367

你有正确的想法，

使用您的中央服务器（这可以是您的托管解决方案），

如果您在托管（外部）解决方案上构建许可证检查器，您只需添加一个需要许可证密钥加密发布的 Web 请求，例如

对 {domain} 的请求

```
https://{domain}.{tdl}/licenceValid/internal 
```

发布查询字符串

```
licenceCrypt={licenceKey(though SHA1)}&companyId={company_id} 
```

做你的检查然后返回一个字符串 JSON，一旦你有一个纯文本版本，你就可以引入密码学，这样你就不会通过互联网发送纯文本

```
Succsess : {'status':'OK','expire':'20/07/2012 00:00:00', 'check':'18/07/2012 00:00:00'}
Fail     : {'status':'FAIL','Message':'Licence has expired'} 
```

然后使用此信息缓存该结果。然后，您可以从文件中加载此信息并检查日期是否小于当前日期。但是，如果失败并且许可证尚未过期，请再次下载，请继续让他们使用应用程序，但会显示一条通知，告诉他们许可证验证有错误。如果许可证从缓存日期块过期，则许可证将在 {date} 过期，阻止应用程序告诉他们他们需要检查服务器与 Internet 的连接，如果这不起作用，请致电您。

如果所有其他方法都失败了，那么您可以使用带有小应用程序的笔式驱动器弹出，以使用新的许可证详细信息更新缓存文件，以便他们可以再次使用该软件，现在对于缓存，我建议您使用2 路加密 EG base64 但是我会推荐一个更强的

然后，您的托管解决方案可以在类中加载并检查所请求版本的许可证，而无需任何帖子，或者如果您想分离托管应用程序和许可证服务器，您可以对本地副本实施相同的检查，这样您就没有2个不同的代码库

**注意：** 您不必通过 companyId 发送，您可以使用数据库的 SHA1 函数搜索您的数据库并进行直接查找检查以获取过期和东西

**安全数据：** 如果您实施一个安全应用程序，因为它包含由于某种原因无法公开的数据以减少黑客攻击，请在不同的端口上设置许可证系统，并在服务器设置中允许它仅在该端口上从外部调用首先一个 linux 路由框将是理想的，因为 iptables 可以很简单地做到这一点我不确定在 Windows 上设置有多容易

**更新：** *防止许可证无效*

您可以实施以防止人们“取消”您的许可证并且不需要任何本地更改的另一个功能是在许可证服务器上验证主机名，因此当第一次使用许可证密钥时，它会将主机名保存到数据库中许可证密钥，如果另一个请求来自不同的主机名，请告诉他们他们必须联系您重新启用许可证，因为那里的主机名已更改大多数公司应该运行静态 IP 地址，因此他们将始终拥有静态主机名，即使它有 ISP 主机名

这仍然不能阻止有经验的人，他们可以绕过所有他们需要的环回黑客，以防止您的应用程序与您的服务器通信，然后他们将不得不在那里设置一个虚拟服务器环回以响应虚假信息

*额外一英里*

您可以通过使许可证系统成为 C# 库来防止这种情况，并且应用程序下载新版本卸载现有程序集并加载新的 DLL 程序集，您只需确保不更改公共方法的名称，然后您就可以在不破坏服务器或完整客户端更新的情况下添加更多安全性，您还可以在通信中使用某种形式的 AES 或基于证书的加密，并使用嵌入式资源将证书编译到 DLL 中。

有了上述内容，您甚至可以做得更好，为每个许可证密钥制作一个新证书，这应该会使“无效”变得非常困难*

就像另一个不是 * 这将需要服务器编译 DLL 我强烈建议您不要在托管服务器上执行此操作，因为它将使用大量内存和 CPU 功率来最小化此使用 MSBuild 并保留所有编译数据，因此您唯一更改的是证书应该意味着它保留 .pdb 文件并且应该更快地编译

# ruby - Ruby - 正则表达式在文件中返回字体 URL

> ID：11506949
> 
> 赞同：0
> 
> 时间：2012-07-16T14:57:39.803
> 
> 标签：ruby, regex

我试图解析一个 javascript 文件以返回字体 url。

文件看起来像这样

```
@font-face {
  font-family: 'AlfaSlab';
  iesrc: url('/lib/assets/themes/ek/skins/default/alfaslabone-regular-webfont.eot');
  url('/lib/assets/themes/ek/skins/default/alfaslabone-regular-webfont.woff') 
```

我想获取所有带有文件扩展名的字体链接（eot、woff、svg、otf）

我想出了这个正则表达式`/(\/lib\/.*?\/.*?\.(eot|woff|ttf|svg))/`，但它也返回文件扩展名（因为文件扩展名中的 () ）

在红宝石中我这样做`files.map {|file| File.read(file).scan(regex)} #=> ['/lib/assets/themes/ek/skins/default/alfaslabone-regular-webfont.eot','eot','/lib/assets/themes/ek/skins/default/alfaslabone-regular-webfont.woff','woff']`

我如何修复正则表达式以仅返回文件路径而不是 2 个数组元素中的文件路径 + 文件扩展名，谢谢:)

### 编辑：

我想返回带有文件扩展名的整个路径，`['/lib/assets/themes/ek/skins/default/alfaslabone-regular-webfont.eot','/lib/assets/themes/ek/skins/default/alfaslabone-regular-webfont.woff']`应该是匹配的。谢谢你的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T15:10:57.497

您可以重写您的正则表达式：

```
/([\w\-\/]+\.(?:eot|woff|ttf|svg))/ 
```

*   `[\w\-\/]`定义一组字符：
    *   `\w`单词字符，即字母（`a-z`, `A-Z`）、数字（`0-9`）和下划线（`_`）
    *   `\-`连字符 ( `-`)
    *   `\/`斜线 ( `/`)
*   `+`表示这些字符中的一个或多个
*   `\.`是文件扩展名前的点
*   `(eot|woff|ttf|svg)`是文件扩展名
*   `?:`告诉正则表达式引擎*不要*为此捕获组生成*反向引用*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:48:32.530

看到你的评论后，我认为这个长的正则表达式会起作用。因为，正如您所说，将所有可能的扩展包含在“（）”中将始终创建第二个数组元素

```
/(\/lib\/.*?\/.*?\.eot|\/lib\/.*?\/.*?\.woff)|\/lib\/.*?\/.*?\.ttf|\/lib\/.*?\/.*?\.svg)/ 
```

我不是 Ruby 专家，但你可以通过定义一个变量来概括一下

```
$v = "\/lib\/.*?\/.*?\."
$m = "("+$v+"eot|"+$v+"woff|"+$v+"ttf|"+$v+"svg)"
Regexp.new $m 
```

# android - TextViews之间的线性视图中的项目符号列表（或类似）

> ID：11506951
> 
> 赞同：0
> 
> 时间：2012-07-16T14:57:43.950
> 
> 标签：android, listview, android-arrayadapter

我尝试使用 ListView 构建项目符号列表并在可滚动的 LinearLayout 中使用它，但它不会扩展列表（我必须滚动 ListView）。

这里是截图：[http ://www.pic-upload.de/view-15149543/2012-07-16_16-28-42.jpg.html](http://www.pic-upload.de/view-15149543/2012-07-16_16-28-42.jpg.html)

Listview 位于 > Kontraindikation 下。

我用了这个例子：[http ://www.technotalkative.com/android-bullets-in-listview/](http://www.technotalkative.com/android-bullets-in-listview/)

这是我的xml：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scroll" 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">
    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"     
        android:orientation="vertical">
        <TextView
            android:id="@+id/wirk_t"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold" 
            android:textColor="#FFFFFF"
            android:background="#33B5E5" 
            android:text="@string/notmedi_wirk" />  
        <TextView
            android:id="@+id/wirk_f"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold"  />
        <TextView
            android:id="@+id/handel_t"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold" 
            android:textColor="#FFFFFF"
            android:background="#33B5E5" 
            android:text="@string/notmedi_handel" 
            android:onClick="onClick"
            android:clickable="true"
            android:drawableLeft="@drawable/right" /> 
        <TextView
            android:id="@+id/handel_f"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold"  
            android:visibility="gone" />    
        <TextView
            android:id="@+id/ind_t"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold" 
            android:textColor="#FFFFFF"
            android:background="#33B5E5" 
            android:text="@string/notmedi_ind" 
            android:onClick="onClick"
            android:clickable="true"
            android:drawableLeft="@drawable/right" /> 
        <TextView
            android:id="@+id/ind_f"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:visibility="gone" />    
        <TextView
            android:id="@+id/medi_kontra_t"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold" 
            android:textColor="#FFFFFF"
            android:background="#33B5E5" 
            android:text="@string/notmedi_medi_kontra" 
            android:onClick="onClick"
            android:clickable="true"
            android:drawableLeft="@drawable/right" /> 
        <ListView
            android:id="@+id/listView"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:listSelector="@android:color/transparent"
            android:divider="@null"/>
        <TextView
            android:id="@+id/medi_beschr_t"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:textSize="18sp" 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:textStyle="bold" 
            android:textColor="#FFFFFF"
            android:background="#33B5E5" 
            android:text="@string/notmedi_medi_kontra" 
            android:onClick="onClick"
            android:clickable="true"
            android:drawableLeft="@drawable/right" />
        <TextView
            android:id="@+id/medi_beschr_f"
            android:paddingTop="10dp"
            android:paddingBottom="10dp"
            android:paddingLeft="10dp"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:visibility="gone" />     
    </LinearLayout>
</ScrollView> 
```

这是我的项目 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:id="@+id/itemText"
    android:drawableLeft="@drawable/bullet"
    android:drawablePadding="8dp"
    android:padding="5dp"
    android:text="List Item"/> 
```

这是我的适配器：

```
ListView listView = (ListView)findViewById(R.id.listView);  
listView.setAdapter(new ArrayAdapter<String>(  
this, R.layout.medi_notmedi_detail_list_item, medi_kontra_list)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:04:15.237

如果要`ListView`在 a中使用`ScrollView`，则需要以`ListView Height`编程方式设置。[这](https://stackoverflow.com/a/3495908/1436931)是计算/设置“ListView”高度的好代码。

# javascript - 在表格中选择一个类进行拖动

> ID：11506953
> 
> 赞同：0
> 
> 时间：2012-07-16T14:57:46.567
> 
> 标签：javascript, jquery, ajax, jquery-ui

我有一张桌子。在它里面我有一个叫做拖动的类。我需要拖动那个类。我应该如何拖动它？

```
//Counter
counter = 0;
//Make element draggable
$('.drag').draggable({
  revert: 'invalid',
  helper: 'clone',
  containment: 'frame',
  cursorAt: { left: -1, top: -1 },
  //When first dragged
  stop: function (ev, ui) {
    //code here
  }
}); 
```

这是我的下表。我应该如何拖动表格？

```
<div class="options">
  <div>
    <table id="gvEventDetails" cellspacing="0" border="1"
      style="border-collapse:collapse;" rules="all">
      <tbody>
        <tr><th scope="col">EventID</th></tr>
        <tr>
          <td>
            <div id="drag0" class="drag"
              style="background-color:RGB(30,140,70)" height:32px;=""
              width:32px;="" position:absolute;="">Event1
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div id="drag1" class="drag"
              style="background-color:RGB(40,30,255)" height:32px;=""
              width:32px;="" position:absolute;="">Event2
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:58:17.073

将其放入[http://jsfiddle.net/ABt8h/](http://jsfiddle.net/ABt8h/)后，我看不出您的代码有任何问题..

我在您自己的代码中进行了更多调试。也许你的 js 中有一个重叠选择器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T10:16:10.110

我使用 ajax 控件为 div 加载和动态创建 id。所以它不起作用。因为 ajax 控件将在 javascript 加载后加载。

```
 $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "Eventcalander.aspx/BindDatatable",
                data: "{}",
                dataType: "json",
                success: function (data) {
                    for (var i = 0; i < data.d.length; i++) {

  $("#gvEventDetails").append("<tr><td><div width:32px; height:32px; id= drag" + i + " class=\"dragg\" style= background-color:" + data.d[i].Color + ">" + data.d[i].EventID + "</div></td></tr>");

                    }
                },
                error: function (result) {
                    alert("Error");
                }

            }); 
```

在代码隐藏中我这样使用

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;
using System.Data.SqlClient;
using System.Web.Services;

namespace DragDropDynamically
{
    public partial class Eventcalander : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                BindColumnToGridview();
            }

        }

        /// <summary>
        /// This method is used to bind dummy row to gridview to bind data using JQuery
        /// </summary>
        private void BindColumnToGridview()
        {
            DataTable dt = new DataTable();
            dt.Columns.Add("EventID");
            dt.Rows.Add();
            gvEventDetails.DataSource = dt;
            gvEventDetails.DataBind();
            gvEventDetails.Rows[0].Visible = false;
        }

        [WebMethod]
        public static EventDetails[] BindDatatable()
        {
            DataTable dt = new DataTable();
            List<EventDetails> lstEventdetails = new List<EventDetails>();

            using (SqlConnection con = new SqlConnection("Server=CTSINDLFVMOSS;Database=databasename;uid=userid;pwd=password"))
            {
                using (SqlCommand cmd = new SqlCommand("SELECT TOP 1000 [EventID],[EventStartDate],[EventEndDate],[EventPeriod],[Feature],[Display],[FeatureandDisplay],[TPR],[Color] FROM [DB_CGTPO_DEVE].[dbo].[HistoryEvent]", con))
                {
                    con.Open();
                    SqlDataAdapter da = new SqlDataAdapter(cmd);
                    da.Fill(dt);
                    foreach (DataRow dtrow in dt.Rows)
                    {

                        eventdetails.EventID = dtrow["EventID"].ToString();

                        eventdetails.Color = dtrow["Color"].ToString().Trim();

                        lstEventdetails.Add(eventdetails);
                    }
                }
            }
            return lstEventdetails.ToArray();
        }
        public class EventDetails
        {
            public string EventID { get; set; }
            public string Color { get; set; }
        }
    }
} 
```

# c# - 游戏服务器的线程架构

> ID：11506954
> 
> 赞同：1
> 
> 时间：2012-07-16T14:57:52.823
> 
> 标签：c#, multithreading

我开始制作我的 2D 游戏/引擎，但不知道处理服务器端客户端的最佳线程架构。

最初，我考虑的是 Thread-per-map 设计，而不是 Thread-per-user。但是还有另一种理想的方法吗？

在我的地图线程概念中，线程只会在地图上玩家的入口处创建，并且会在它清空后很快被销毁。但是有了这个概念，有太多玩家（例如，玩家商店）的地图可能会导致严重的延迟。

使用用户线程方法，会有大量线程 - 因此会分配大量内存。

那么，还有另一种更好的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T01:50:28.187

您的问题的答案只是使用一个线程来模拟许多游戏实例。由于游戏编程的复杂性以及以任何有意义/安全/有益的方式划分内存访问的难度，游戏从多线程中受益的情况很少。即使是您听说过的大型游戏的服务器，对于整个游戏逻辑也是单线程的。例如，一个暗黑破坏神风格的游戏每个核心有 1 个线程，每个线程负责数百个游戏，并带有少量的跨线程（真正跨机器）逻辑来启动游戏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T15:13:52.857

当您的服务器具有多个 CPU 内核时，您将从多线程架构中获得一些好处。因此，如果您的游戏架构是纯事件驱动的（您从不在事件处理程序中等待任何内容），最佳性能将是线程数等于 CPU 核心数。

# bash - bash 中的这一行是什么意思？“。~/some_env 数据库名称”

> ID：11506959
> 
> 赞同：3
> 
> 时间：2012-07-16T14:58:12.260
> 
> 标签：bash

```
#!/bin/bash
#
. ~/some_env database_name 
```

代码看起来就像上面一样，每次我尝试在 bash 中运行它时，都会收到文件或目录不存在的错误。如果我创建目录，它会抱怨我正在使用目录。如果我创建一个文件，它会抱怨“文件名不是函数”。

这行代码有什么作用？很难弄清楚该行的作用，因为搜索字符串太短了。

另外，我对 bash 很陌生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T15:00:34.427

`.`是[source](http://ss64.com/bash/period.html)的简写，所以这个命令只执行`~/some_env`with 参数的内容`database_name`。请注意，`source`在当前 shell 上下文中（即不在子 shell 中）执行命名文件的内容，命名文件是否不可执行无关紧要。如果您没有`some_env`在您的主目录中命名的文件或`database_name`在当前工作目录中命名的文件，那么您将收到一条错误消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T15:02:13.973

`.``some_env`就像您在当前 shell 中键入命令一样运行脚本。这称为采购，与将其作为普通脚本运行不同，因为它可以设置环境变量、创建函数等，这些在运行该命令后将出现在您当前的 shell 中。

`database_name`是第一个参数，将`$1`在脚本中可用。

如果您在 处没有文件`~/some_env`，您将收到一个错误，因为没有可运行的内容；脚本中的某些内容也可能引用了不存在的文件。您可能需要发布有关脚本的更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:02:30.200

你知道它`~`引用了你的主目录吗？如果脚本来自另一个用户，当他运行它时，它会在他的主目录中找到文件 some_env。当您运行它时，该文件要么不存在，要么不包含脚本所期望的内容。

# ruby-on-rails - Postgres + Heroku Ruby 创建

> ID：11506961
> 
> 赞同：0
> 
> 时间：2012-07-16T14:58:18.610
> 
> 标签：ruby-on-rails, post, heroku, carrierwave, rails-postgresql

我有一个在 Heroku 上运行良好的应用程序，我正在尝试使用 Carrierwave 将该应用程序连接到亚马逊的 S3 服务。我以为我的配置文件都适用于所有内容，但是在创建图片实例时遇到了问题。我认为这与 Postgres 及其某些特定格式等有关，但这是主要问题。

我正在`TypeError (can't convert nil into String):`了解似乎是 POST 到数据库的内容（特别是在 create 方法上）。错误如下所示：

```
app/controllers/pictures_controller.rb:62:in `create'

TypeError (can't convert nil into String):
POST xxxxxxxx.herokuapp.com/684-536-025/pictures dyno=web.1 queue=0 wait=0ms service=510ms status=500 bytes=643 
```

这也是 POST 的开始：

```
#<Picture id: nil, description: nil, image: nil, gallery_id: 15, gallery_url_id: "a432b35_21cc", original_filename: "Sunflower.gif", order_number: nil, created_at: nil, updated_at: nil> 
```

我假设这里的问题是 Postgres 不允许在有字段为零时启动 POST。奇怪的是，sqlite 在这方面做得很好，这就是为什么我猜测问题是 Postgres，不幸的是我将使用 Postgres 进行生产。我对 Postgres 的了解还不够，无法真正缩小这个问题的范围，所以我想我会在这里询问是否可以得到任何帮助/建议！

谢谢！

编辑：这是额外帮助的创建方法

```
def create
# Creates a picture class instance based on the json objects being passed in from 
# Carrierwave
p_attr = params[:picture]
p_attr[:image] = params[:picture][:image].first if params[:picture][:image].class == Array

# Gets the gallery vai the uuid gallery url
@gallery = Gallery.where(:url_id => params[:url_id]).first
# Builds the picture based on the attributes passed in above from the json
@picture = @gallery.pictures.build(p_attr)
# Assigns the gallery_url_id attribute
@picture.gallery_url_id = @gallery.url_id

puts @picture.inspect

# Handle the picture save according to success or not
LINE 62 -> if @picture.save
  respond_to do |format|
    format.html {
      # Calls the method in the model to format the json repsonse
      render :json => [@picture.to_jq_upload].to_json,
      :content_type => 'text/html',
      :layout => false
    }
    format.json {
      render :json => [@picture.to_jq_upload].to_json
    }
  end
else
  render :json => [{:error => "custom_failure"}], :status => 304
end 
```

结尾

代码中标记了第 62 行。

编辑2：这是所要求的模型......

```
class Picture < ActiveRecord::Base

  # The attributes accesible via an @picture
  attr_accessible :gallery_id, :description, :image, :gallery_url_id, :original_filename, :order_number
  belongs_to :gallery

  # Attatches the carrierwave uploader to the picture class
  mount_uploader :image, ImageUploader

  # Referenced when each picture is created, the json is formatted as the following form
  def to_jq_upload
    {
      "name" => read_attribute(:image),
      "size" => image.size,
      "url" => image.url,
      "thumbnail_url" => image.thumb.url,
      "delete_url" => id,
      "picture_id" => id,
      "delete_type" => "DELETE",
      "url_id" => read_attribute(:gallery_url_id),
      "original_filename" => read_attribute(:original_filename),
      "order_number" => ""
    }
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:01:36.820

我最终将其用作 config/initilizers/fog.rb

```
CarrierWave.configure do |config|
  config.fog_credentials = {
    :provider               => 'AWS',
    :aws_access_key_id      => 'asdf',
    :aws_secret_access_key  => 'asdfadsf',
    :region                 => 'us-east-1'
  }
  config.fog_directory  = 'modea-design-comp-viewer'
end 
```

此外，在控制器中，我必须手动将数据库中作为 nil 发布的两个字段设置为空字符串，如下所示：

```
def create
    # Creates a picture class instance based on the json objects being passed in from 
    # Carrierwave
    p_attr = params[:picture]
    p_attr[:image] = params[:picture][:image].first if params[:picture][:image].class == Array

    # Gets the gallery vai the uuid gallery url
    @gallery = Gallery.where(:url_id => params[:url_id]).first
    # Builds the picture based on the attributes passed in above from the json
    @picture = @gallery.pictures.build(p_attr)
    # Assigns the gallery_url_id attribute
    @picture.gallery_url_id = @gallery.url_id

    @picture.order_number = ""
    @picture.description = ""

    # Handle the picture save according to success or not
    if @picture.save
      puts @picture.inspect
      respond_to do |format|
        format.html {
          # Calls the method in the model to format the json repsonse
          render :json => [@picture.to_jq_upload].to_json,
          :content_type => 'text/html',
          :layout => false
        }
        format.json {
          render :json => [@picture.to_jq_upload].to_json
        }
      end
    else
      render :json => [{:error => "custom_failure"}], :status => 304
    end
  end 
```

那是为我做的！

# forms - Orbeon 3.9 Liferay 代理 portlet java.lang.NullPointerException 任何用户交互错误

> ID：11506962
> 
> 赞同：0
> 
> 时间：2012-07-16T14:58:19.063
> 
> 标签：forms, liferay, portlet, orbeon

我正在尝试将 Orbeon Forms 3.91 PE 与 Liferay 6.0.6 集成。我已经安装了 Liferay，部署了 orbeon.war，orbeon-proxy-portlet.war，复制了许可文件并创建了 file-local.xml 属性（如 wiki 中所述）。

使用表单生成器，我创建了一个表单（默认内容（一个输入字段））。

接下来，我在 Liferay 中添加了两个包含 portlets 表单的页面： - 一个运行器带有我的表单 - 第二个表单指的是“联系人”表单（默认表单）。

与我的表单集成后（例如尝试保存表单）我收到错误：

```
ERROR ProcessorService  - Exception at line 55, column 65 of oxf:/ops/xforms/xforms-server.xpl (reading processor output: name='response', id='xforms-response')
java.lang.NullPointerException
    at org.orbeon.oxf.xforms.state.XFormsStateManager.checkUUIDInSession(XFormsStateManager.java:92)
    at org.orbeon.oxf.xforms.state.XFormsStateManager.findOrRestoreDocument(XFormsStateManager.java:277)
    at org.orbeon.oxf.xforms.processor.XFormsServer.doIt(XFormsServer.java:152)
    at org.orbeon.oxf.xforms.processor.XFormsServer.access$000(XFormsServer.java:56)
    at org.orbeon.oxf.xforms.processor.XFormsServer$1.readImpl(XFormsServer.java:88)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl$TopLevelOutputFilter.read(ProcessorOutputImpl.java:263)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl.read(ProcessorOutputImpl.java:406)
    at org.orbeon.oxf.processor.ProcessorImpl.readInputAsSAX(ProcessorImpl.java:260)
    at org.orbeon.oxf.processor.pipeline.TeeProcessor$TeeProcessorOutputImpl.readImpl(TeeProcessor.java:89)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl$TopLevelOutputFilter.read(ProcessorOutputImpl.java:263)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl.read(ProcessorOutputImpl.java:406)
    at org.orbeon.oxf.processor.ProcessorImpl.readInputAsSAX(ProcessorImpl.java:260)
    at org.orbeon.oxf.processor.ProcessorImpl.readInputAsTinyTree(ProcessorImpl.java:286)
    at org.orbeon.oxf.processor.ProcessorImpl$3.read(ProcessorImpl.java:315)
    at org.orbeon.oxf.processor.ProcessorImpl.readCacheInputAsObject(ProcessorImpl.java:365)
    at org.orbeon.oxf.processor.ProcessorImpl.readCacheInputAsObject(ProcessorImpl.java:330)
    at org.orbeon.oxf.processor.ProcessorImpl.readCacheInputAsTinyTree(ProcessorImpl.java:313)
    at org.orbeon.oxf.processor.pipeline.choose.ConcreteChooseProcessor.start(ConcreteChooseProcessor.java:186)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor$5.run(PipelineProcessor.java:664)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.executeChildren(PipelineProcessor.java:729)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.start(PipelineProcessor.java:661)
    at org.orbeon.oxf.processor.pipeline.choose.ConcreteChooseProcessor.start(ConcreteChooseProcessor.java:248)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor$5.run(PipelineProcessor.java:664)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.executeChildren(PipelineProcessor.java:729)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.start(PipelineProcessor.java:661)
    at org.orbeon.oxf.pipeline.InitUtils.runProcessor(InitUtils.java:89)
    at org.orbeon.oxf.webapp.ProcessorService.service(ProcessorService.java:97)
    at org.orbeon.oxf.servlet.OrbeonServletDelegate.service(OrbeonServletDelegate.java:133)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:619) 
```

它看起来像 AJAX 错误和问题会话管理。

移动以形成“联系人”并与之交互后，我收到错误消息：

```
[file:/C:/liferay-portal-6.0.6/tomcat-6.0.29/temp/upload__1b3fa11c_1388fbc4805__7ff4_00000095.tmp|null|null|000|true|false|false|false|[false|true|false|false|false|false]]
2012-07-16 14:47:20,240 ERROR ProcessorService  - Exception at line 55, column 65 of oxf:/ops/xforms/xforms-server.xpl (reading processor output: name='response', id='xforms-response')
org.orbeon.oxf.common.OXFException: Session has expired. Unable to process incoming request.
    at org.orbeon.oxf.xforms.state.XFormsStateManager.checkUUIDInSession(XFormsStateManager.java:94)
    at org.orbeon.oxf.xforms.state.XFormsStateManager.findOrRestoreDocument(XFormsStateManager.java:277)
    at org.orbeon.oxf.xforms.processor.XFormsServer.doIt(XFormsServer.java:152)
    at org.orbeon.oxf.xforms.processor.XFormsServer.access$000(XFormsServer.java:56)
    at org.orbeon.oxf.xforms.processor.XFormsServer$1.readImpl(XFormsServer.java:88)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl$TopLevelOutputFilter.read(ProcessorOutputImpl.java:263)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl.read(ProcessorOutputImpl.java:406)
    at org.orbeon.oxf.processor.ProcessorImpl.readInputAsSAX(ProcessorImpl.java:260)
    at org.orbeon.oxf.processor.pipeline.TeeProcessor$TeeProcessorOutputImpl.readImpl(TeeProcessor.java:89)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl$TopLevelOutputFilter.read(ProcessorOutputImpl.java:263)
    at org.orbeon.oxf.processor.impl.ProcessorOutputImpl.read(ProcessorOutputImpl.java:406)
    at org.orbeon.oxf.processor.ProcessorImpl.readInputAsSAX(ProcessorImpl.java:260)
    at org.orbeon.oxf.processor.ProcessorImpl.readInputAsTinyTree(ProcessorImpl.java:286)
    at org.orbeon.oxf.processor.ProcessorImpl$3.read(ProcessorImpl.java:315)
    at org.orbeon.oxf.processor.ProcessorImpl.readCacheInputAsObject(ProcessorImpl.java:365)
    at org.orbeon.oxf.processor.ProcessorImpl.readCacheInputAsObject(ProcessorImpl.java:330)
    at org.orbeon.oxf.processor.ProcessorImpl.readCacheInputAsTinyTree(ProcessorImpl.java:313)
    at org.orbeon.oxf.processor.pipeline.choose.ConcreteChooseProcessor.start(ConcreteChooseProcessor.java:186)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor$5.run(PipelineProcessor.java:664)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.executeChildren(PipelineProcessor.java:729)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.start(PipelineProcessor.java:661)
    at org.orbeon.oxf.processor.pipeline.choose.ConcreteChooseProcessor.start(ConcreteChooseProcessor.java:248)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor$5.run(PipelineProcessor.java:664)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.executeChildren(PipelineProcessor.java:729)
    at org.orbeon.oxf.processor.pipeline.PipelineProcessor.start(PipelineProcessor.java:661)
    at org.orbeon.oxf.pipeline.InitUtils.runProcessor(InitUtils.java:89)
    at org.orbeon.oxf.webapp.ProcessorService.service(ProcessorService.java:97)
    at org.orbeon.oxf.servlet.OrbeonServletDelegate.service(OrbeonServletDelegate.java:133)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:619) 
```

从那时起，这个错误也出现在我的表单上（第一个）。

根据 Firebug 标头包含 JSESSIONID（我无法附加图像

```
Response:
Cache-Control   private, max-age=0
Content-Length  2299
Content-Type    application/xml;charset=utf-8
Date    Mon, 16 Jul 2012 14:47:20 GMT
Expires Mon, 16 Jul 2012 14:47:20 GMT
Last-Modified   Mon, 16 Jul 2012 14:47:20 GMT
Server  Apache-Coyote/1.1
Request:
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language pl,en-us;q=0.7,en;q=0.3
Connection  keep-alive
Content-Length  409
Content-Type    application/xml; charset=UTF-8
Cookie  JSESSIONID=BD09C08F33458793AB9DB94057DF7BDF; GUEST_LANGUAGE_ID=en_US; COOKIE_SUPPORT=true
Host    localhost:8080
Referer http://localhost:8080/web/guest/contact
User-Agent  Mozilla/5.0 (Windows NT 5.1; rv:13.0) Gecko/20100101 Firefox/13.0.1
X-Requested-With    XMLHttpRequest 
```

)

我该如何解决？（来自 localhost: 8080/orbeon 的两种形式都可以正常工作）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:52:56.493

不幸的是，代理 portlet 在 3.9.1 中被破坏了。自该版本以来，我们已经对 portlet 实施了许多修复和改进，并且代理 portlet 应该可以与[Orbeon Forms 4.0 M7](http://blog.orbeon.com/2012/07/orbeon-forms-40-m7.html)很好地配合使用。

# javascript - 在另一个选项卡中打开相同域时，窗口标题会发生变化

> ID：11506963
> 
> 赞同：-2
> 
> 时间：2012-07-16T14:58:22.377
> 
> 标签：javascript, javascript-events

我正在使用 x.com，最初我的窗口标题为“one”。我正在通过 Javascript 将窗口标题更改为“两个”。现在，如果我在另一个选项卡中打开同一个 x.com，浏览器会自动将第一个选项卡标题从“两个”更改为“一个”。如何避免这种变化？

我正在使用 Firefox 13。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:28:04.493

只要您不将标题的更改（您在客户端使用 javascript 进行）提交给服务器，它就会交付与您最初声明的标题相同的页面（`title="one"`）。

您在客户端所做的更改（非常普遍地说）不会持久，直到您通过表单提交或 ajax 调用将它们保存在服务器上。

# mysql - SQL 操作性能：列号、SUM

> ID：11506965
> 
> 赞同：1
> 
> 时间：2012-07-16T14:58:30.230
> 
> 标签：mysql

我正在开发一个让人们回答问题的应用程序，它已经在不同的列中存储了正确和错误问题的数量。对于其他功能（例如所有时间得分），我需要获得每天、所有时间等的总回答量。

因此，最好： 1\. 将每个问题的答案存储到数据库中： answer_correct、answer_incorrect 和 answers_total

或者

1.  对于每个答案，存储到数据库： answer_correct, answer_incorrect,
2.  做排名功能的时候，数据库有没有那个时候的SUM？

我知道这看起来很通用，但是随着我对 MySQL 的深入了解，我正在尝试开发最佳实践：性能。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:07:54.797

我建议采用以下结构：

```
CREATE TABLE IF NOT EXISTS `answers` (
  `userId` int(11) NOT NULL,
  `questionId` int(11) NOT NULL,
  `isCorrect` tinyint(3) unsigned NOT NULL,
  `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`userId`,`questionId`),
  KEY `isCorrect` (`isCorrect`),
  KEY `time` (`time`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

在每个答案上，您都会在此表中添加一条记录。当您需要时，您可以从该表中获得给定时间段内正确/错误答案的数量。

..我不知道是否允许用户多次回答一个问题，请注意主索引。

# sql - 如何删除特定列SQL中具有重复值的行

> ID：11506971
> 
> 赞同：0
> 
> 时间：2012-07-16T14:59:22.123
> 
> 标签：sql

```
SELECT      P.CODE,
            P.STATUS,
            G.DESCRIPTION,
            x.xref_code,
            X.XREF_STATUS

FROM        table1.price_data p,
            TABLE2.GENERAL_DATA G,
            TABLE3.XREF_DATA X

WHERE        
        P.CODE = G.CODE
        AND G.CODE=X.CODE
        AND x.code=4545645
        AND X.VEHICLE_CODE=9999999 
```

实际上有 30,000 行要过滤...如何更改上述查询以仅显示 x.xref_status 的唯一值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:09:29.730

目前尚不清楚为什么您的 X.XREF_STATUS 重复：TABLE3 表中有重复项？或者，更有可能的是，相关记录中有很多对 XREF_STATUS 值的引用？

如果 X.XREF_STATUS 以外的其他列的行不同，您将无法选择一行而不是另一行来仅显示唯一的 X.XREF_STATUS 值。

可以通过以下方式获得唯一 X.XREF_STATUS 值的列表：

```
select distinct X.XREF_STATUS
from TABLE3.XREF_DATA X
where x.code=4545645
AND X.VEHICLE_CODE=9999999 
```

这可以连接到其他表以获取相关数据，但同样，如果您与包含多个 X.XREF_STATUS 引用的表连接，这将相应地重复。您必须聚合其他列（COUNT、SUM 等）以避免重复。

# php - 防止数据库错误的服务器端验证

> ID：11506972
> 
> 赞同：2
> 
> 时间：2012-07-16T14:59:28.863
> 
> 标签：php, jquery, database, validation

我对服务器端编码相当陌生，目前正在建立一个站点，该站点涉及从数据库中提取对象，允许用户编辑它们，然后将这些元素重新插入到数据库中。

但是，我不确定如何防止用户通过使用开发工具破坏数据库。

本质上，元素显示在列表中，每个元素都是一个脚本。它有自己的唯一 ID 和名称（不一定是唯一的）。因此，当从数据库中提取它时，名称是列表的文本，而 id 包含在属性字段中。当它们被编辑时，我从 html 属性中提取 id 并使用它来保存对数据库的任何更改。

当然，我会检查服务器端以确定是否允许用户进行的所有编辑。

但是，我遇到的问题是用户可以轻松地打开任何形式的开发人员工具，更改脚本 ID（切换它们或以任何他们喜欢的方式改变它们），这肯定会损害数据库。

有人可以提供一些技术来防止这个问题吗？我真的很感激。谢谢！

我不知道它会有什么帮助，但我的大部分代码都在 Javascript（使用 jquery 和 jquery ui）和 php（使用 CodeIgniter 作为框架）中。

**编辑：**

想象两个元素

ID -> 标题 -> 描述

5 -> 你好 -> 世界

6 -> 再见 -> 睡觉

在服务器端，这些显示为列表，并且有另一种编辑值的方法。

```
<li data-id=5>Hello</li>
<li data-id=6>Bye</li> 
```

有人可以加载火虫并更改我用于查询的数据ID，例如将第一个设为7。或者两者都交换。在这种情况下，这并不重要，但实际上更多的是出于我的好奇心，有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:30:22.603

使用 mysql_real_escape_string 向数据库发送安全查询：

```
 $user_input = mysql_real_escape_string($_POST['user_input']); 
```

# php - 如何一次选择一行的整个数据表？

> ID：11506974
> 
> 赞同：0
> 
> 时间：2012-07-16T14:59:41.373
> 
> 标签：php, sql, select, row

我有一个包含 10,000 条记录的表（客户）。我想一次修改每一条记录并修改一些数据，然后将其更新回数据库。SELECT * FROM customer 然后 fetchAll 没有意义，因为有 10,000 条记录。

我想在 PHP 中创建一个 while 循环，它执行一个递增的 SELECT 语句，但是如果没有可以很好地递增的稳定主键，像这样的 select 语句会是什么样子？从逻辑上讲，while 循环看起来像：

```
$row = 1;
while(Number_Rows_In_Table)
{
  $record = $this->db->exec("SELECT * FROM customer WHERE ROW = $row");
  $row++;
  //Do something with the data then update it
} 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:01:21.110

您*可以*使用 MySQL 中可用的 offset、limit 语法……但这似乎是一件奇怪的事情

```
SELECT * FROM customer LIMIT $row, 1 
```

假设`$row`从 0 开始并自动递增（如您的示例中所示）。您可能也必须订购它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T15:04:19.727

你不必使用 fetchAll 你知道的：

```
$stmt = $pdo->query("SELECT * FROM `table`");
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
    //Do stuff with specific rows one a time
} 
```

这**将比**拥有 10,000 个选择查询快得多。我可以向你保证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T15:01:03.113

您不必调用`fetchAll()`并获取所有行，只需从`SELECT * FROM customer`使用[`fetch()`](http://php.net/manual/en/pdostatement.fetch.php).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:06:13.953

根据您需要更新的内容，您可能只使用 SQL。例如，要查找和替换刺痛：

```
update TABLE_NAME set FIELD_NAME = replace(FIELD_NAME, ‘find this string’, ‘replace found string with this string’); 
```

# javascript - Node JS 需要没有 var

> ID：11506976
> 
> 赞同：7
> 
> 时间：2012-07-16T14:59:47.410
> 
> 标签：javascript, node.js, requirejs

**{这与 Twitter 无关}**

一个有趣的问题，有趣的是它可能很愚蠢，你可以笑，但我至少会对这个该死的痒有一个答案。

目前我使用

```
var Bootstrap = require('library/Bootstrap');
Bootstrap.run(); 
```

如果我可以在 Bootstrap index.js 中做这样的事情，那真的很棒

```
module.exports.Bootstrap = My_Bootstrap; 
```

并称它为willy nilly 像这样

```
require('library/Bootstrap');
Bootstrap.run(); 
```

无需向我的空间声明另一个变量，有没有办法做到这一点，或者我盯着屏幕想知道、做梦、迷路、回来并浪费时间？

**编辑** 所以这就是我最后所做的：

我创建了一个全局对象，并且只向其中添加了重要的模块，以便可以访问和实例化它们。事实证明这是一个了不起的答案和解决方案，非常方便

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T15:08:55.557

那么你可以只修改[`global`](http://nodejs.org/docs/latest/api/all.html#all_global)对象。这类似于浏览器上的窗口对象。因此，您可以为您的模块编写一个包装器，如下所示：

```
global.Bootstrap = My_Bootstrap 
```

全局对象在模块之间共享。然后，无论您身在何处，都可以使用`Bootstrap`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:27:47.983

你不能按照你说的那样做，这意味着一个全球性的，这几乎肯定不是你想要的。

但是你可以做的是：

```
require('your_library').call(this,arg1,arg2); 
```

例如，您可能正在使用[节点验证器](https://github.com/chriso/node-validator)库。

您打算像这样使用它：

```
sanitize = require('validator').sanitize
var str = sanitize('aaaaaaaaab').ltrim('a'); 
```

但是你可以跳过所有这些并做

```
var str = require('validator').sanitize('aaaaaaaaab').ltrim('a') 
```

据我了解，在内存/速度方面这样做没有缺点。

在你的具体情况下，你知道你可以跳过一点......

文件：MyBootStrap.js

```
Module.exports = MyBootstrap 
```

文件：index.js（或其他）

```
require('library/Bootstrap.js')() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:05:02.000

不，您必须声明变量。不过，你可以进入`require`函数内部，让它为你工作。我对 Bootstrap 的内部架构并不太熟悉，但看起来像这样的东西应该可以解决问题：

```
// put this in some out-of-the-way cubbyhole somewhere
var oldRequire = require;
function require(path) {
    Bootstrap = oldRequire(path);
}

// and this would go in your main file
require("library/Bootstrap");
Bootstrap.run(); 
```

# javascript - 标签不显示图像

> ID：11506982
> 
> 赞同：-5
> 
> 时间：2012-07-16T15:00:09.903
> 
> 标签：javascript, jquery, html

我有一个`img`标签`src = "file:///C:/Users/king/Documents/testing.jpg"`。此标签未显示图像。有什么问题 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T15:01:37.607

`img`标签没有`href`属性..那是链接。

*   改为使用`src="image path here"`。完整的标签是`<img src="path" alt="alt text" />`
*   确保路径指向有效文件
*   将路径放在引号中
*   知道它将显示来自您计算机的文件，并且仅当 HTML 页面本地存储在您的计算机上时才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:02:50.497

问题可能是因为您拥有的地址转到您计算机上的文件。如果其他人试图从网络服务器访问此页面，他们很可能不会将您的文件放在他们计算机上的同一位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:05:13.333

```
<a href="file:///C:/Users/King/Documents/testing.jpg"><img src="file:///C:/Users/King/Documents/testing.jpg" /></a> 
```

必须工作

确定 testing.jpg 是否存在..也许是 testing.JPG ..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:38:00.780

使用相对路径而不是绝对路径，例如，如果图像文件位于您在使用时存储网页的位置上方的文件夹中../../testing.jpg

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T15:10:19.230

由于安全原因，我不确定浏览器是否始终可以访问 file:// 协议您是否在 localhost 上运行？如果不是那是你的理由。如果可能，我建议您始终使用关系 URL，因此如果您的 HTML 在 Documents 中，那么 src="testing.jpg" 就可以了。

一般来说，我建议将图像放在索引文件所在的子文件夹中，以使其更容易并允许使用相对 url，例如“./images/testing.jpg”或“../images/testing.jpg”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T15:03:16.847

`<img src="FILE">`是正确的格式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-16T15:03:30.723

`<img src="path/to/file.jpg" alt="This is my image" />`是一个正确的标签...试试吧而且你不能使用这样的本地路径，它会转到你硬盘上的一个文件，如果你把它放到网上，其他人都无法访问它。使用相对链接，例如“rootfolder/images/yourimage.jpg”

# c# - 解析变量字符串

> ID：11506990
> 
> 赞同：2
> 
> 时间：2012-07-16T15:00:36.780
> 
> 标签：c#, combobox, string-parsing

我在组合框中有一些项目。每个项目都有一个 ID 和一个名称。

```
 ______________
    │_____________▼│
    │111  Simon    │              
    │222  Patrick  │              
    │3333 John     │
    │155555 Ted    │
    └──────────────┘ 
```

我需要将所选项目的 Id 传递给存储过程。我将不得不`Parse`部分获取项目的 ID。我的问题是，当我不知道 ID 的长度时，我该怎么做。（可以是 1 到 100 个字符）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T15:03:51.947

您可以只拆分空格字符并获取第一个结果：

```
var id = comboBox.SelectedText.Split(' ')[0]; // Using array index
var id = comboBox.SelectedText.Split(' ').First(); // Using LINQ 
```

作为旁白：

*   如果使用移动框架`ComboBox`类，我建议使用[ValueMember](http://msdn.microsoft.com/en-us/library/microsoft.dynamics.mobile.framework.controls.combobox.valuemember%28v=mag.15%29.aspx)属性来存储 ID，然后使用它而不是仅使用显示的文本。
*   如果使用 System.Windows.Forms `ComboBox`，您可以使用[SelectedItem](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selecteditem.aspx)属性来访问 ID。
*   如果使用 System.Windows.Controls `ComboBox`，您可以使用[SelectedItem](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selecteditem.aspx)属性访问 ID。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T15:03:52.690

您必须将项目填充到组合框中，以便：

```
comboboxName.DataSource = ds;
comboboxName.ValueMember = "Id";
comboboxName.DisplayMember = "Name"; 
```

否则用于`comboboxName.SelectedText.Split(' ');`获取这些值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T15:04:07.120

试试这个：

```
var foo = str.Split(' ');  //from 111  Simon will get '111'
var id = foo.Length > 1 ? foo[0] : null; 
if(id != null) {
  //do something with '111';
} else {
   //error
} 
```

**编辑**

我建议您使用自定义`Combobox`类来做到这一点：

```
public class Foo
{
    public string Text { get; set; }
    public int Value { get; set; }

    public Foo(int id, string name)
    {
        Value = id;
        Text = name;
    }

    public override string ToString()
    {
        return Text;
    }
} 
```

然后将`object`(foo) 添加到`combobox`：

```
comboBox1.Items.Add(new Foo(111, "simon")); 
```

然后您可以通过将`SelectedItem`属性转换为您的类来访问这些值：

```
//assuming that comboBox1.SelectedText is "simon", the following is true:
var val = (Foo)comboBox1.SelectedItem;
val.Value // 111
val.Text // simon 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T15:04:49.357

在选定的响应上尝试 String.Split。这将在空格处拆分所选项目的文本。您应该得到一个二元素数组，第一个成员是您在上面表示的 id。

不过，更广泛地说，您可能会考虑修改解决方案以将值放在 .ValueMember 属性中，并将名称放在 .DisplayMember 属性中（无需解析任何内容）。看看你的列表框实现是否不支持。

祝你好运！

# firefox - SCSS: Mixins 只能定义在文档的根目录

> ID：11506999
> 
> 赞同：1
> 
> 时间：2012-07-16T15:01:19.533
> 
> 标签：firefox, sass

我已经使用 SASS 几天了，遇到了一个问题。

这是完美呈现的 SCSS：

```
@import "light";
@import "basic";
@import "fancybox"; 
```

由于它是一种用户样式，Firefox 需要在 @-moz-document 规则中使用所有特定于站点的 CSS，如下所示：

```
@namespace url(http://www.w3.org/1999/xhtml);
@-moz-document domain("clubfile.ru"){
    @import "light";
    @import "basic";
    @import "fancybox";
} 
```

不幸的是，这不起作用，编译器返回错误：

> Mixins 只能定义在文档的根目录

以及 _basic.scss 中对 mixins 的引用。Gem 版本是 Sass 3.1.20 和 Compass 0.12.2。

那么，有没有办法修复或忽略该错误？

**更新 1：**我认为类似于 SCSS mixins 的 -moz 规则语法造成了所有麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:12:49.967

您的“light”、“basic”或“fancybox”文件是否包含 mixin 定义，或者导入包含 mixin 定义的文件？如果是这样，您将不得不将 mixins 移出。

您可以尝试将您的 mixins 移动到 _mixins 部分中，并仅在需要的地方使用 @import。