# StackOverflow 问答 000282000-000282999

# c# - C#查找相关文档片段以显示搜索结果

> ID：282002
> 
> 赞同：10
> 
> 时间：2008-11-11T20:10:17.843
> 
> 标签：c#, algorithm, search, relevance, significance

在为我正在构建的站点开发搜索时，我决定采用便宜快捷的方式并使用 Microsoft Sql Server 的全文搜索引擎，而不是像 Lucene.Net 这样更强大的引擎。

不过，我希望拥有的功能之一是谷歌式的相关文档片段。我很快发现确定“相关”片段比我意识到的要困难。

我想根据找到的文本中的搜索词密度选择片段。所以，本质上，我需要在文本中找到搜索词最密集的段落。一个段落是任意数量的字符（比如 200 - 但它真的没关系）。

我的第一个想法是在循环中使用 .IndexOf() 并构建一个术语距离数组（从先前找到的术语中减去找到的术语的索引），然后......什么？将任意两个、任意三个、任意四个、任意五个顺序数组元素相加，并使用总和最小的元素（因此，搜索词之间的距离最小）。

这似乎很乱。

有没有比我想出的更成熟、更好或更明显的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-08-11T21:28:53.790

虽然它是用 Java 实现的，但您可以在这里看到解决该问题的一种方法： [http ://rcrezende.blogspot.com/2010/08/smallest-relevant-text-snippet-for.html](http://rcrezende.blogspot.com/2010/08/smallest-relevant-text-snippet-for.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-24T01:46:09.070

我知道这个线程已经很老了，但我上周试了一下，结果很痛苦。这远非完美，但这是我想出的。

片段生成器：

```
public static string SelectKeywordSnippets(string StringToSnip, string[] Keywords, int SnippetLength)
    {
        string snippedString = "";
        List<int> keywordLocations = new List<int>();

        //Get the locations of all keywords
        for (int i = 0; i < Keywords.Count(); i++)
            keywordLocations.AddRange(SharedTools.IndexOfAll(StringToSnip, Keywords[i], StringComparison.CurrentCultureIgnoreCase));

        //Sort locations
        keywordLocations.Sort();

        //Remove locations which are closer to each other than the SnippetLength
        if (keywordLocations.Count > 1)
        {
            bool found = true;
            while (found)
            {
                found = false;
                for (int i = keywordLocations.Count - 1; i > 0; i--)
                    if (keywordLocations[i] - keywordLocations[i - 1] < SnippetLength / 2)
                    {
                        keywordLocations[i - 1] = (keywordLocations[i] + keywordLocations[i - 1]) / 2;

                        keywordLocations.RemoveAt(i);

                        found = true;
                    }
            }
        }

        //Make the snippets
        if (keywordLocations.Count > 0 && keywordLocations[0] - SnippetLength / 2 > 0)
            snippedString = "... ";
        foreach (int i in keywordLocations)
        {
            int stringStart = Math.Max(0, i - SnippetLength / 2);
            int stringEnd = Math.Min(i + SnippetLength / 2, StringToSnip.Length);
            int stringLength = Math.Min(stringEnd - stringStart, StringToSnip.Length - stringStart);
            snippedString += StringToSnip.Substring(stringStart, stringLength);
            if (stringEnd < StringToSnip.Length) snippedString += " ... ";
            if (snippedString.Length > 200) break;
        }

        return snippedString;

    } 
```

查找示例文本中所有关键字的索引的函数

```
 private static List<int> IndexOfAll(string haystack, string needle, StringComparison Comparison)
    {
        int pos;
        int offset = 0;
        int length = needle.Length;
        List<int> positions = new List<int>();
        while ((pos = haystack.IndexOf(needle, offset, Comparison)) != -1)
        {
            positions.Add(pos);
            offset = pos + length;
        }
        return positions;
    } 
```

它的执行有点笨拙。它的工作方式是查找字符串中所有关键字的位置。然后检查没有关键字彼此之间的距离比所需的片段长度更近，这样片段就不会重叠（这就是它有点不确定的地方......）。然后抓取以关键字位置为中心的所需长度的子字符串，并将整个内容缝合在一起。

我知道这已经晚了好几年，但张贴以防万一它可能会帮助遇到这个问题的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-14T00:33:43.497

```
public class Highlighter
{        
    private class Packet
    {
        public string Sentence;
        public double Density;
        public int Offset;
    }

    public static string FindSnippet(string text, string query, int maxLength)
    {
        if (maxLength < 0)
        {
            throw new ArgumentException("maxLength");
        }
        var words = query.Split(' ').Where(w => !string.IsNullOrWhiteSpace(w)).Select(word => word.ToLower()).ToLookup(s => s);             
        var sentences = text.Split('.');
        var i = 0;
        var packets = sentences.Select(sentence => new Packet 
        { 
            Sentence = sentence, 
            Density = ComputeDensity(words, sentence),
            Offset = i++
        }).OrderByDescending(packet => packet.Density);
        var list = new SortedList<int, string>();            
        int length = 0;                
        foreach (var packet in packets)
        {
            if (length >= maxLength || packet.Density == 0)
            {
                break;
            }
            string sentence = packet.Sentence;
            list.Add(packet.Offset, sentence.Substring(0, Math.Min(sentence.Length, maxLength - length)));
            length += packet.Sentence.Length;
        }
        var sb = new List<string>();
        int previous = -1;
        foreach (var item in list)
        {
            var offset = item.Key;
            var sentence = item.Value;
            if (previous != -1 && offset - previous != 1)
            {
                sb.Add(".");
            }
            previous = offset;             
            sb.Add(Highlight(sentence, words));                
        }
        return String.Join(".", sb);
    }

    private static string Highlight(string sentence, ILookup<string, string> words)
    {
        var sb = new List<string>();
        var ff = true;
        foreach (var word in sentence.Split(' '))
        {
            var token = word.ToLower();
            if (ff && words.Contains(token))
            {
                sb.Add("[[HIGHLIGHT]]");
                ff = !ff;
            }
            if (!ff && !string.IsNullOrWhiteSpace(token) && !words.Contains(token))
            {
                sb.Add("[[ENDHIGHLIGHT]]");
                ff = !ff;
            }
            sb.Add(word);
        }
        if (!ff)
        {
            sb.Add("[[ENDHIGHLIGHT]]");
        }
        return String.Join(" ", sb);
    }

    private static double ComputeDensity(ILookup<string, string> words, string sentence)
    {            
        if (string.IsNullOrEmpty(sentence) || words.Count == 0)
        {
            return 0;
        }
        int numerator = 0;
        int denominator = 0;
        foreach(var word in sentence.Split(' ').Select(w => w.ToLower()))
        {
            if (words.Contains(word))
            {
                numerator++;
            }
            denominator++;
        }
        if (denominator != 0)
        {
            return (double)numerator / denominator;
        }
        else
        {
            return 0;
        }
    }
} 
```

例子：

> highlight “光流定义为图像中结构光的变化，例如视网膜或相机传感器上的结构光，由于眼球或相机与场景之间的相对运动。文献中的进一步定义突出了光流的不同属性” “光流”

输出：

[[HIGHLIGHT]] 光流 [[ENDHIGHLIGHT]] 被定义为图像中结构光的变化，例如... 文献中的进一步定义突出了 [[HIGHLIGHT]] 光流 [[ENDHIGHLIGHT]] 的不同属性

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T14:25:02.893

好吧，这是我使用上面描述的算法制作的破解版。我不认为这一切都很好。它使用三个（count em，三个！）循环一个数组和两个列表。但是，好吧，总比没有好。我还硬编码了最大长度，而不是把它变成一个参数。

```
private static string FindRelevantSnippets(string infoText, string[] searchTerms)
    {
        List<int> termLocations = new List<int>();
        foreach (string term in searchTerms)
        {
            int termStart = infoText.IndexOf(term);
            while (termStart > 0)
            {
                termLocations.Add(termStart);
                termStart = infoText.IndexOf(term, termStart + 1);
            }
        }

        if (termLocations.Count == 0)
        {
            if (infoText.Length > 250)
                return infoText.Substring(0, 250);
            else
                return infoText;
        }

        termLocations.Sort();

        List<int> termDistances = new List<int>();
        for (int i = 0; i < termLocations.Count; i++)
        {
            if (i == 0)
            {
                termDistances.Add(0);
                continue;
            }
            termDistances.Add(termLocations[i] - termLocations[i - 1]);
        }

        int smallestSum = int.MaxValue;
        int smallestSumIndex = 0;
        for (int i = 0; i < termDistances.Count; i++)
        {
            int sum = termDistances.Skip(i).Take(5).Sum();
            if (sum < smallestSum)
            {
                smallestSum = sum;
                smallestSumIndex = i;
            }
        }
        int start = Math.Max(termLocations[smallestSumIndex] - 128, 0);
        int len = Math.Min(smallestSum, infoText.Length - start);
        len = Math.Min(len, 250);
        return infoText.Substring(start, len);
    } 
```

我能想到的一些改进是返回多个长度较短的“片段”，加起来就是较长的长度——这样可以对文档的多个部分进行采样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-27T17:41:03.990

这是一个很好的问题:)

我想我会创建一个索引向量：对于每个单词，如果搜索项创建一个条目 1，否则为 0。然后找到 i 使得 sum(indexvector[i:i+maxlength]) 最大化。

这实际上可以相当有效地完成。从第一个 maxlength 单词中的搜索词数开始。然后，当您继续前进时，如果 indexvector[i]=1（即当您增加 i 时您将丢失该搜索项），则减少您的计数器，如果 indexvector[i+maxlength+1]=1，则增加它。当你走的时候，跟踪具有最高计数器值的 i。

一旦你得到你最喜欢的 i，你仍然可以做微调，比如看看你是否可以在不影响计数器的情况下减小实际大小，例如为了找到句子边界或其他什么。或者像选择具有相同计数器值的多个 is 中的右侧 i 一样。

不确定这是否比您的方法更好 - 这是一种不同的方法。

您可能还想查看有关该主题的这篇论文，它带有另一个基线：[http ://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.72.4357&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.72.4357&rep=rep1&type=pdf)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-12-13T23:46:35.720

我采取了另一种方法，也许它会帮助某人......

首先，它使用 IgnoreCase 搜索它是否出现在我的案例中（您当然可以自己更改）。然后我在每个分隔符上创建一个正则表达式匹配列表并搜索单词的第一次出现（允许部分不区分大小写的匹配）。从该索引中，我得到了单词前后的 10 个匹配项，这就是片段。

```
public static string GetSnippet(string text, string word)
{
    if (text.IndexOf(word, StringComparison.InvariantCultureIgnoreCase) == -1)
    {
        return "";
    }

    var matches = new Regex(@"\b(\S+)\s?", RegexOptions.Singleline | RegexOptions.Compiled).Matches(text);

    var p = -1;
    for (var i = 0; i < matches.Count; i++)
    {
        if (matches[i].Value.IndexOf(word, StringComparison.InvariantCultureIgnoreCase) != -1)
        {
            p = i;
            break;
        }
    }

    if (p == -1) return "";
    var snippet = "";
    for (var x = Math.Max(p - 10, 0); x < p + 10; x++)
    {
        snippet += matches[x].Value + " ";
    }
    return snippet;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-10T09:43:35.220

如果你使用 CONTAINSTABLE 你会得到一个 RANK back ，这本质上是一个密度值 - RANK 值越高，密度就越高。这样，您只需运行查询即可获得所需的结果，而不必在返回时对数据进行按摩。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-14T16:32:29.930

刚才写了一个函数来做这个。你想传入：

# 输入：

**文档文本**
这是您从中提取片段的文档的全文。您很可能希望从该文档中删除任何 BBCode/HTML。

**原始查询**
用户作为搜索输入的字符串

**片段长度**
您希望显示的片段的长度。

# 返回值：

要从中获取片段的文档文本的起始索引。要获取代码片段，只需执行`documentText.Substring(returnValue, snippetLength)`. 这样做的好处是您知道片段是否从开始/结束/中间获取，因此您可以添加一些装饰，例如`...`您希望在片段开始/结束处。

# 表现

一`resolution`组 to`1` *将找到最佳片段*，但一次将窗口沿 1 个字符移动。将此值设置得更高以加快执行速度。

# 调整

你可以随心所欲地锻炼`score`。在这个例子中，我已经做`Math.pow(wordLength, 2)`了更喜欢更长的词。

```
private static int GetSnippetStartPoint(string documentText, string originalQuery, int snippetLength)
{
    // Normalise document text
    documentText = documentText.Trim();
    if (string.IsNullOrWhiteSpace(documentText)) return 0;

    // Return 0 if entire doc fits in snippet
    if (documentText.Length <= snippetLength) return 0;

    // Break query down into words
    var wordsInQuery = new HashSet<string>();
    {
        var queryWords = originalQuery.Split(' ');
        foreach (var word in queryWords)
        {
            var normalisedWord = word.Trim().ToLower();
            if (string.IsNullOrWhiteSpace(normalisedWord)) continue;
            if (wordsInQuery.Contains(normalisedWord)) continue;
            wordsInQuery.Add(normalisedWord);
        }
    }

    // Create moving window to get maximum trues
    var windowStart = 0;
    double maxScore = 0;
    var maxWindowStart = 0;

    // Higher number less accurate but faster
    const int resolution = 5;

    while (true)
    {
        var text = documentText.Substring(windowStart, snippetLength);

        // Get score of this chunk
        // This isn't perfect, as window moves in steps of resolution first and last words will be partial.
        // Could probably be improved to iterate words and not characters.
        var words = text.Split(' ').Select(c => c.Trim().ToLower());
        double score = 0;
        foreach (var word in words)
        {
            if (wordsInQuery.Contains(word))
            {
                // The longer the word, the more important.
                // Can simply replace with score += 1 for simpler model.
                score += Math.Pow(word.Length, 2);
            }                   
        }
        if (score > maxScore)
        {
            maxScore = score;
            maxWindowStart = windowStart;
        }

        // Setup next iteration
        windowStart += resolution;

        // Window end passed document end
        if (windowStart + snippetLength >= documentText.Length)
        {
            break;
        }
    }

    return maxWindowStart;
} 
```

您可以添加更多内容，例如，而不是比较确切的单词，也许您可​​能想尝试比较`SOUNDEX`您对 soundex 匹配的权重小于完全匹配的位置。

# php - PHP 中的引用

> ID：282004
> 
> 赞同：5
> 
> 时间：2008-11-11T20:10:58.343
> 
> 标签：php, trackback, pingback

我正在编写一个自定义博客引擎，并希望有类似于 Wordpress 的引用。我可以看一下 Wordpress 的源代码，但我真的更喜欢某种教程，但到目前为止我还没有找到。有没有在 PHP5 中实现 trackbacks 或 pingbacks 的好教程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T20:15:44.010

实现 trackbacks 一点也不难。[在这里](http://www.sixapart.com/pronet/docs/trackback_spec)您可以在底部找到官方规范和示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T22:35:05.717

引用很好，但它们很容易产生垃圾邮件，因为没有验证它们的来源。您使用简单的发现方法来查找 trackpack 入口点；在目标站点的源中查找 RDF。然后，它只是一个 RESTful POST 请求，向目标站点的 trackback 入口点传递必要的 trackback 信息。Sebastian Hörl 链接的规范应该为您提供大量信息。

Pingback 有点复杂，因为它们需要 XMLRPC 和回链接。因此，虽然您可以只使用 REST 调用将匿名引用发送到任何站点，但您 pingback 的站点将查看您的站点以确定您是否实际链接到被 ping 的页面。

此外，在接收端实现 Pingback 有点复杂，因为您必须验证 ping。我想您不必这样做，但不这样做是愚蠢的，否则它将容易受到与 Trackbacks 相同的垃圾邮件技术的影响。

[Pingback 规范](http://hixie.ch/specs/pingback/pingback-1.0)包含实现该实现所需的所有信息。

另一个建议是，与其费力地浏览不可避免的密集和意大利面条式的 WordPress Pingback 代码，不如看看[Habari](http://habariproject.org/)的自包含[Pingback 实现](https://trac.habariproject.org/habari/browser/trunk/htdocs/system/plugins/pingback/pingback.plugin.php)，它将任务的一些关键特性隔离成更容易消化的单元。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T20:15:54.620

不知道引用是什么，我所注意到的只是它们用混乱的文本块将网站弄得一团糟，通常还夹杂着文章评论。

但是，如果他们允许您在没有日志分析的情况下实时查看谁在链接到您：

您可以使用 HTTP-Referer (sic) 标头来查看人们是否链接到您的文章。每篇文章都会有一张这些推荐人的地图（和一个计数，因此您可以按受欢迎程度进行组织）。然后，您实现一个基本的爬虫，该爬虫访问新的引荐来源网址以抓取内容。

我确信也有第三方实现可用。或规范。由于另一张海报已链接到，所以，错误，忽略这一点。

# c++ - 如何禁用无线网络连接通知气球？

> ID：282007
> 
> 赞同：2
> 
> 时间：2008-11-11T20:12:04.643
> 
> 标签：c++, windows, wireless, balloon, wlanapi

我想以编程方式禁用连接到无线网络时收到的通知。我知道有一种方法可以禁用所有通知（请参见[此处](http://www.howtogeek.com/howto/windows/disable-notification-balloons-in-xp/)），但有没有一种方法可以只禁用由 Windows 无线管理器（即 wlanapi.dll）发出的通知。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T03:17:10.853

我认为这是不可能的，除非在 Windows 7 中可用。（它显然包括一个更可配置的托盘程序管理器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T15:27:27.823

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
New \ DWORD
EnableBalloonTips
Hexadecimal
0 
```

# c# - .NET Windows 窗体设计时规则

> ID：282014
> 
> 赞同：10
> 
> 时间：2008-11-11T20:16:25.477
> 
> 标签：c#, .net, winforms, design-time

我有一个对象，它启动一个线程，打开一个文件，并等待来自其他类的输入。当它接收到输入时，它会将其写入磁盘。基本上，它是一个线程安全的数据记录类......

这是奇怪的部分。当我在使用该对象的设计器 (Visual Studio 2008) 中打开一个表单时，该文件被创建。它显然是在设计时虚拟主机进程下运行的......

奇怪的是我无法在另一个项目中重现该问题。我不确定在设计器中执行的代码和不执行的代码的规则是什么。例如，在 Windows 窗体构造函数中创建文件实际上并没有在设计时创建文件......

解释是什么？有参考吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-02-18T21:41:29.463

在设计器中编辑该类时不会执行控件或表单的构造函数（也不会调用 OnLoad）。我偶尔使用它在设计器中设置一个值（例如，使其子控件在设计器中全部可见），但在构造函数中将其中一些覆盖为不同的默认值（例如，隐藏某些只会显示的子控件在某些情况下，例如状态栏上的指示器）。

但是，如果控件作为子控件放置在设计器中的另一个控件或窗体上，则构造函数会被执行*。*OnLoad 也被执行。这可能是您的日志记录代码在设计器中意外触发的方式。

为了检测设计与运行时，另一个[问题](https://stackoverflow.com/questions/34664/designmode-with-controls)[的答案](https://stackoverflow.com/questions/34664/designmode-with-controls/708594#708594)有一些经验测试的屏幕截图，显示了一些常见方法返回的值。似乎在设计器中正在编辑的表单或控件的子控件（向下两层）的子控件看到自己的 DesignMode == false，因此正常的属性检查将无法保护代码（例如在 OnLoad 方法中) 用于嵌套在设计器中添加的控件中的控件。如果您按照预期检查 DesignMode，则可能是嵌套导致它绕过该检查。它也总是在构造函数中看到 DesignMode == false。

另外，请注意 LicenseManager.UsageMode 检查*仅*在构造函数中看到 DesignTime；当调用 OnLoad 时，它位于 RunTime LicenseContext 中。最完整的解决方案似乎是在控件或表单（或组件）的构造函数中检查 LicenseManager.UsageMode 并将设置保存到成员变量或属性中，您可以稍后检查以避免运行不应在设计器中运行的代码即使嵌套。[在另一个问题的另一个答案](https://stackoverflow.com/questions/34664/designmode-with-controls/2693338#2693338)中还有另一种方法，它解释了嵌套，但只能在构造函数之外工作。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-11T21:57:12.713

您可以检查 LicenseManager 的 UsageMode，以检查代码是否在设计时。

System.ComponentModel.LicenseManager.UsageMode == System.ComponentModel.LicenseUsageMode.Designtime

这是一个简单的例子：

```
using System;
using System.ComponentModel;
using System.Windows.Forms;

namespace Test
{
    public class ComponentClass : Component
    {
        public ComponentClass()
        {
            MessageBox.Show("Runtime!");
        }
    }
} 
```

当此组件在设计器中添加到您的表单时，您将立即获得一个消息框。

为了防止这种情况，您可以添加一个简单的 if 语句来检查代码是否不在设计时

```
using System;
using System.ComponentModel;
using System.Windows.Forms;

namespace Test
{
    public class ComponentClass : Component
    {
        public ComponentClass()
        {
            if (LicenseManager.UsageMode != LicenseUsageMode.Designtime)
            {
                MessageBox.Show("Runtime!");
            }
        }
    }
} 
```

添加 if 语句后，通过设计器将组件添加到表单时不再出现消息框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T08:20:58.113

您还可以使用它来检查 Visual Studio 设计器是否正在运行代码：

```
public static bool DesignMode
{
    get {  return (System.Diagnostics.Process.GetCurrentProcess().ProcessName == "devenv"); }
} 
```

然后在 Form_Load 中：

```
if (!DesignMode)
{
    // Run code that breaks in Visual Studio Designer (like trying to get a DB connection)
} 
```

但是，这不如使用`LicensManager.UsageMode`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-19T04:06:24.647

好吧，既然这已经复活了，这是我用来确定我是否处于设计模式的函数：

```
public static bool IsAnyInDesignMode(Control control){
    while(control != null){
        if(control.Site != null && control.Site.DesignMode)
            return true;
        control = control.Parent;
    }
    return false;
} 
```

这可以处理控件是由另一个控件创建的子控件的情况。该`DesignMode`属性仅为设计器本身创建的控件设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T20:24:16.397

有些事情你不应该和设计师一起做。我没有任何确凿的证据，但我发现当您从中删除默认构造函数时，Windows 窗体设计者讨厌它。继续创建新的重载，但保留空的构造函数。

还要尽量避免在`Form_Load`您继承的基类中执行事件。

# c# - 在 C# 中为客户端和服务器使用 C++ COM 接口

> ID：282016
> 
> 赞同：2
> 
> 时间：2008-11-11T20:17:41.730
> 
> 标签：c#, c++, com, interop, idl

我需要让一段 C# 代码通过 COM 与各种实现进行交互。

为了使该集成的用户更容易，我在 IDL 中包含了交互接口（作为相关现有 DLL 的一部分，但没有 coclass 或实现），然后通过运行 Tlbimp 将其放入我的 C# 代码中以创建类型定义。

我实现了我的 C#，基于 Windows 注册表信息创建 COM 对象并将对象转换为我需要的接口。

然后我在一个单独的项目中创建了接口的 C# 实现并注册了它。主程序正确创建了测试 COM 对象，但未能将其转换为接口（使用 C#'as' 时获取空对象，获取显式转换的 InvalidCastException）。

有人可以建议为什么接口没有被测试对象识别为实现吗？

这是 IDL 中的接口定义（在 VS 2005 中用 C++ 编译）：

```
 [
    object,
    uuid(B60C546F-EE91-48a2-A352-CFC36E613CB7),
    dual,
    nonextensible,
    helpstring("IScriptGenerator Interface"),
    pointer_default(unique)
]
interface IScriptGenerator : IDispatch{

    [helpstring("Init the Script generator")] 
        HRESULT Init();
    [helpstring("General purpose error reporting")] 
        HRESULT GetLastError([out] BSTR *Error);
}; 
```

这是 Tlbimp 为 C# 创建的存根：

```
[TypeLibType(4288)]
[Guid("B60C546F-EE91-48A2-A352-CFC36E613CB7")]
  public interface IScriptGenerator
  {
    [DispId(1610743813)]
    void GetLastError(out string Error);
    [DispId(1610743808)]
    void Init();
  } 
```

这是主要 C# 代码的一部分，通过其 ProgID 创建一个 COM 对象并将其转换为 IScriptGenerator 接口：

```
public ScriptGenerator(string GUID)
{
  Type comType = Type.GetTypeFromProgID(GUID);
  object comObj = null;
  if (comType != null)
  {
    try
    {
      comObj = Activator.CreateInstance(comType);
    }
    catch (Exception ex)
    {
      Debug.Fail("Cannot create the script generator COM object due to the following exception: " + ex, ex.Message + "\n" + ex.StackTrace);
      throw ex;
    }
  }
  else
    throw new ArgumentException("The GUID does not match a registetred COM object", "GUID");

  m_internalGenerator = comObj as IScriptGenerator;
  if (m_internalGenerator == null)
  {
    Debug.Fail("The script generator doesn't support the required interface - IScriptGenerator");
    throw new InvalidCastException("The script generator with the GUID " + GUID + " doesn't support the required interface - IScriptGenerator");
  }

} 
```

这是实现 C# 代码，以测试它是否正常工作（但它不是）：

```
 [Guid("EB46E31F-0961-4179-8A56-3895DDF2884E"),
  ProgId("ScriptGeneratorExample.ScriptGenerator"),
  ClassInterface(ClassInterfaceType.None),
  ComSourceInterfaces(typeof(SOAAPIOLELib.IScriptGeneratorCallback))]
  public class ScriptGenerator : IScriptGenerator
  {
   public void GetLastError(out string Error)
    {
      throw new NotImplementedException();
    }
    public void Init()
    {
      // nothing to do
    }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T23:52:51.700

再次 - 感谢您的建议。

我终于能够自己解决这个问题。我尝试了上述建议并没有取得任何进展。然后我在“测试”代码中更改了互操作的命名空间——它与主代码中的命名空间不同，因为使用 Tlbimp 时使用了不同的参数。这解决了问题。

这是我对原因的猜测：.Net 创建了 COM 对象，但是当它检测到这实际上是一个 .Net 对象时，它会绕过 COM 层并直接进行通信。在这种情况下，不使用 queryInterface（带有接口 GUID）并且接口确实因不同的 C# 命名空间而不同。

这意味着为了支持与 .Net 代码的集成，我需要在 IDL 旁边发布我的原始互操作程序集。

谢谢， 因巴尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T22:14:12.977

我认为您需要在界面上使用它

```
[InterfaceType(ComInterfaceType.InterfaceIsDual)] 
```

# c# - 嵌套视图 - 如何从控制器访问？

> ID：282017
> 
> 赞同：2
> 
> 时间：2008-11-11T20:17:43.540
> 
> 标签：c#, asp.net-mvc

在我的管理视图中，我想要几个子目录，例如：

```
管理员/用户/list.aspx
```

我也有：

```
管理员/list.aspx
```

从控制器访问**admin/users/list.aspx的正确代码是什么？**

或者管理子目录应该在 View/ 的根级别，然后使用路由？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-11T21:07:43.407

尝试查看有关[asp.net mvc 领域的](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)*黑客*帖子

# svn - svn 的单个只读用户

> ID：282018
> 
> 赞同：5
> 
> 时间：2008-11-11T20:17:49.263
> 
> 标签：svn

我正在对私人 svn 服务器进行一些维护。身份验证通过 Apache 基本 HTTP+mod_authz_svn 处理。我需要拥有它，以便每个用户都有读/写访问权限，除了一个只读用户。但是，只读用户仍然需要进行身份验证。我像这样设置我的 authz 配置文件：

```
[/]
* = rw
只读 = r
```

但这不起作用。“只读”用户仍然可以提交更改。我可以让每个人都只读，但 * 位似乎覆盖了我试图为“只读”设置的内容。

FWIW，Apache conf的相关部分是：

```
<位置/repos>
   DAV svn
   SVN路径...
   SVNIndexXSLT "/svnindex.xsl"

   AuthzSVNAccessFile ...

   AuthType 基本
   身份验证...
   验证用户文件 ...
   需要有效用户
 </位置>

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-11T20:32:14.493

在这种情况下，只读用户仍然具有写入权限，因为它也匹配 * 组。

实现您想要的一种安全方法是创建一组除只读用户之外的所有用户，例如

```
[groups]
all-but-ro = harry, sally, ...

[/]
@all-but-ro = rw
read-only = r 
```

（或者，您可能只是从 passwd 文件中生成许多 =rw 行）

可能是 svn 从上到下匹配 - 这没有记录，我也没有测试。所以试试

```
[/]
read-only = r
* = rw 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T20:41:38.890

嗯，之前的帖子在 ACL 顺序上可能是正确的，但是......

我的配置包括

```
AuthzSVNAccessFile "<path-to-svn-acl-file>" 
```

这可能也是一个问题吗？

# delphi - 如何模拟 Delphi 记录中的位域？

> ID：282019
> 
> 赞同：26
> 
> 时间：2008-11-11T20:17:53.897
> 
> 标签：delphi, record, bit-fields

我想在 Delphi 中声明一条记录，其中包含与 C 中相同的布局。

对于那些感兴趣的人：此记录是 Windows 操作系统的 LDT_ENTRY 记录中联合的一部分。（我需要在 Delphi 中使用此记录，因为我正在 Delphi 中开发 Xbox 模拟器 - 请参阅 sourceforge 上的 Dxbx 项目）。

无论如何，有问题的记录定义为：

```
 struct
    {
        DWORD   BaseMid : 8;
        DWORD   Type : 5;
        DWORD   Dpl : 2;
        DWORD   Pres : 1;
        DWORD   LimitHi : 4;
        DWORD   Sys : 1;
        DWORD   Reserved_0 : 1;
        DWORD   Default_Big : 1;
        DWORD   Granularity : 1;
        DWORD   BaseHi : 8;
    }
    Bits; 
```

据我所知，Delphi 中没有位域。我确实试过这个：

```
 Bits = record
      BaseMid: Byte; // 8 bits
      _Type: 0..31; // 5 bits
      Dpl: 0..3; // 2 bits
      Pres: Boolean; // 1 bit
      LimitHi: 0..15; // 4 bits
      Sys: Boolean; // 1 bit
      Reserved_0: Boolean; // 1 bit
      Default_Big: Boolean; // 1 bit
      Granularity: Boolean; // 1 bit
      BaseHi: Byte; // 8 bits
  end; 
```

但是很可惜：它的大小变成了 10 个字节，而不是预期的 4 个。我想知道我应该如何声明记录，以便获得具有相同布局、相同大小和相同成员的记录。最好没有大量的 getter/setter。

TIA。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-11T22:39:52.880

谢谢大家！

基于此信息，我将其简化为：

```
RBits = record
public
  BaseMid: BYTE;
private
  Flags: WORD;
  function GetBits(const aIndex: Integer): Integer;
  procedure SetBits(const aIndex: Integer; const aValue: Integer);
public
  BaseHi: BYTE;
  property _Type: Integer index $0005 read GetBits write SetBits; // 5 bits at offset 0
  property Dpl: Integer index $0502 read GetBits write SetBits; // 2 bits at offset 5
  property Pres: Integer index $0701 read GetBits write SetBits; // 1 bit at offset 7
  property LimitHi: Integer index $0804 read GetBits write SetBits; // 4 bits at offset 8
  property Sys: Integer index $0C01 read GetBits write SetBits; // 1 bit at offset 12
  property Reserved_0: Integer index $0D01 read GetBits write SetBits; // 1 bit at offset 13
  property Default_Big: Integer index $0E01 read GetBits write SetBits; // 1 bit at offset 14
  property Granularity: Integer index $0F01 read GetBits write SetBits; // 1 bit at offset 15
end; 
```

索引编码如下`(BitOffset shl 8) + NrBits`：其中 1<=NrBits<=32 和 0<=BitOffset<=31

现在，我可以按如下方式获取和设置这些位：

```
{$OPTIMIZATION ON}
{$OVERFLOWCHECKS OFF}
function RBits.GetBits(const aIndex: Integer): Integer;
var
  Offset: Integer;
  NrBits: Integer;
  Mask: Integer;
begin
  NrBits := aIndex and $FF;
  Offset := aIndex shr 8;

  Mask := ((1 shl NrBits) - 1);

  Result := (Flags shr Offset) and Mask;
end;

procedure RBits.SetBits(const aIndex: Integer; const aValue: Integer);
var
  Offset: Integer;
  NrBits: Integer;
  Mask: Integer;
begin
  NrBits := aIndex and $FF;
  Offset := aIndex shr 8;

  Mask := ((1 shl NrBits) - 1);
  Assert(aValue <= Mask);

  Flags := (Flags and (not (Mask shl Offset))) or (aValue shl Offset);
end; 
```

很漂亮，你不觉得吗？！？！

PS：Rudy Velthuis 现在在他出色[的“转换的陷阱”](http://praxis-velthuis.de/rdc/articles/articles-convert.html#propertyindex)一文中包含了一个修订版。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-11T21:00:32.750

[Rudy 的 Delphi Corner](http://rvelthuis.de/)是我所知道的有关 Delphi 和 C/C++ 互操作性的最佳资源。在 Delphi 中使用 C/C++ API 时，他[的转换陷阱](http://rvelthuis.de/articles/articles-convert.html)几乎是必读的。您最感兴趣的章节是[Records and alignment -> Bitfields](http://rvelthuis.de/articles/articles-convert.html#bitfields)，但我强烈建议您从上到下阅读整个内容，*两次*。其他文章也绝对值得花时间投资。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-11T21:56:53.730

好的，我的位操作有点生疏，所以我可以反转字节。但是下面的代码给出了一般的想法：

```
type
  TBits = record
  private
    FBaseMid     : Byte;
    FTypeDplPres :  Byte;
    FLimitHiSysEa: Byte;
    FBaseHi      : Byte;

    function GetType: Byte;
    procedure SetType(const AType: Byte);
    function GetDpl: Byte;
    procedure SetDbl(const ADpl: Byte);
    function GetBit1(const AIndex: Integer): Boolean;
    procedure SetBit1(const AIndex: Integer; const AValue: Boolean);
    function GetLimitHi: Byte;
    procedure SetLimitHi(const AValue: Byte);
    function GetBit2(const AIndex: Integer): Boolean;
    procedure SetBit2(const AIndex: Integer; const AValue: Boolean);

  public
    property BaseMid: Byte read FBaseMid write FBaseMid;
    property &Type: Byte read GetType write SetType; // 0..31
    property Dpl: Byte read GetDpl write SetDbl; // 0..3
    property Pres: Boolean index 128 read GetBit1 write SetBit1; 
    property LimitHi: Byte read GetLimitHi write SetLimitHi; // 0..15

    property Sys: Boolean index 16 read GetBit2 write SetBit2; 
    property Reserved0: Boolean index 32 read GetBit2 write SetBit2; 
    property DefaultBig: Boolean index 64 read GetBit2 write SetBit2; 
    property Granularity: Boolean index 128 read GetBit2 write SetBit2; 
    property BaseHi: Byte read FBaseHi write FBaseHi;
  end;

  function TBits.GetType: Byte;
  begin
    Result := (FTypeDplPres shr 3) and $1F;
  end;

  procedure TBits.SetType(const AType: Byte);
  begin
    FTypeDplPres := (FTypeDplPres and $07) + ((AType and $1F) shr 3);
  end;

  function TBits.GetDpl: Byte;
  begin
    Result := (FTypeDplPres and $06) shr 1;
  end;

  procedure TBits.SetDbl(const ADpl: Byte);
  begin
    FTypeDblPres := (FTypeDblPres and $F9) + ((ADpl and $3) shl 1);
  end;

  function TBits.GetBit1(const AIndex: Integer): Boolean;
  begin
    Result := FTypeDplPres and AIndex = AIndex;
  end;

  procedure TBits.SetBit1(const AIndex: Integer; const AValue: Boolean);
  begin
    if AValue then
      FTypeDblPres := FTypeDblPres or AIndex
    else
      FTypeDblPres := FTypeDblPres and not AIndex;
  end;

  function TBits.GetLimitHi: Byte;
  begin
    Result := (FLimitHiSysEa shr 4) and $0F;
  end;

  procedure TBits.SetLimitHi(const AValue: Byte);
  begin
    FLimitHiSysEa := (FLimitHiSysEa and $0F) + ((AValue and $0F) shr 4);
  end;

  function TBits.GetBit2(const AIndex: Integer): Boolean;
  begin
    Result := FLimitHiSysEa and AIndex = AIndex;
  end;

  procedure TBits.SetBit2(const AIndex: Integer; const AValue: Boolean);
  begin
    if AValue then
      FLimitHiSysEa := FLimitHiSysEa or AIndex
    else
      FLimitHiSysEa := FLimitHiSysEa and not AIndex;
  end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T20:30:27.990

好吧，您基本上需要通过位操作来解决问题。

为什么，具体来说，您需要保留该结构？

如果您只需要与以这种方言（TCP/IP 或类似方言）交谈或以这种方式存储数据（文件等）的遗留程序交谈，那么我会将普通的 Delphi 结构映射到位版本兼容的。换句话说，我会在内存中使用正常结构化的 Delphi 结构，并编写代码以兼容的方式写入和读取该结构。

如果您需要节省内存，我会制作 getter 和 setter 来操作内部整数或类似的位。这会对性能产生影响，但不会比原始 C 程序的影响大多少，唯一的区别是位操作将由 C 版本中的编译器魔法添加，而您必须自己编写。

如果您在内存中没有很多记录，并且不需要与另一个程序对话，我会使用自然的 Delphi 结构。更高性能的权衡将是使用更多内存。

但这一切都取决于您的标准。

在任何情况下，您都无法让 Delphi 编译器为您完成与 C 编译器相同的工作。

PACKED RECORD，这里的另一个人建议的，没有这样做，也从来没有打算这样做。它只会删除对齐填充以将整数放在 32 位边界和类似位置上，但不会将多个字段打包到一个字节中。

请注意，执行此操作的常用方法是通过 Delphi SETS，它在内部使用位域实现。同样，您将拥有与 C 变体不同的代码。

# java - 使用 Hibernate 和 AOP 审计模式映射

> ID：282023
> 
> 赞同：3
> 
> 时间：2008-11-11T20:20:35.407
> 
> 标签：java, hibernate, audit

我正在尝试审核用户执行的导致相应表更改的操作。例如，如果用户要在 2 个账户之间转账，这将产生以下事件序列：

1.  将转账金额插入转账表
2.  从账户 1 的余额表中的余额中减去转账金额。
3.  将转账金额添加到账户 2 的余额表中的余额。

所有表的父审计消息将是：“用户生成的金额为 XXX 的转账”

这是通过以下模式实现的： [模式](http://img48.imageshack.us/img48/7460/auditloggingiv6.png)

[替代文字 http://img48.imageshack.us/img48/7460/auditloggingiv6.png](http://img48.imageshack.us/img48/7460/auditloggingiv6.png)

问题是我如何在hibernate中表示这个？

我创建了以下内容：

在 Balance and Transfer 的映射文件中

```
<set name="auditRecords" table="TransferAuditRecord" inverse="false" cascade="save-update">
  <key>
    <column name="AuditRecordID" not-null="true" />
  </key>
  <one-to-many class="audit.AuditRecord"/>
</set> 
```

Transfer 和 Balance 类然后实现具有方法的 IAuditable

```
public void setAuditRecords(Set<AuditRecord> auditRecord);
public Set<AuditRecord> getAuditRecords(); 
```

在 AuditRecord 的映射文件中，我有：

```
<many-to-one name="parentAuditRecord" lazy="false"
             column="parent_id"
             class="audit.AuditRecord"
             cascade="all" /> 
```

然后在使用 AOP 和 Hibernate 拦截器的 Logging 类中，我有：

```
AuditRecord auditRecord = new AuditRecord();
auditRecord.setUser(userDAO.findById(
    org.springframework.security.context.SecurityContextHolder.getContext()
        .getAuthentication().getName()));

auditRecord.setParentAuditRecord(getCurrentActiveServiceRecord());

auditable.getAuditRecords().add(auditRecord); 
```

然后在服务类中，我调用以下方法，包含在事务中：

```
save(balance1);
save(balance2);
transfer.setPassed(true);
update(transfer); 
```

parentAuditRecord 是使用带有线程安全堆栈的 AOP 创建的，并且 AuditRecordType_id 是使用方法上的注释设置的。

我遗漏了转移表上的“通过”列。以前我调用 save(transfer) 将转账金额插入到 Transfer 表中，并将传递设置为 false。（此操作也经过审核）。

我的要求比上面的例子稍微复杂一些：P

因此，上述事件的顺序应该是：

1.  更新传输表
2.  插入 AuditRecord（父）
3.  插入 AuditRecord（子）
4.  插入 TransferAuditRecord
5.  插入平衡表
6.  插入 AuditRecord（子）
7.  插入 BalanceAuditRecord
8.  插入平衡表
9.  插入 AuditRecord（子）
10.  插入 BalanceAuditRecord

但是，上面定义的级联选项在更新语句中失败。Hibernate 拒绝将记录插入到多对多表中（即使 AuditRecord 映射上的 unsaved-value="any" ）。我总是想将行插入到多对多表中，因此一个传输可能有许多标记先前事件的审计记录。但是，最新的事件决定了用户想要看到的消息。Hibernate 要么尝试更新多对多表和以前的 AuditRecord 条目，要么只是拒绝插入 AuditRecord 和 TransferAuditRecord，从而引发 TransientObjectException。

审核消息的检索方式如下：

```
msg=... + ((AuditRecord) balance.getAuditRecords().toArray()[getAuditRecords().size()-1])
    .getParentAuditRecord().getAuditRecordType().getDescription() + ...; 
```

消息应该是这样的：“用户名设置转移到 2008 年 10 月 11 日 12:00 传递”

**编辑**我决定显式映射多对多表（具有关联的接口），然后在 afterTransactionCompletion 中，调用父审计记录上的保存（将保存级联到子审计记录），然后显式保存接口在所有子映射表上。这不是真正的审计历史，而是记录用户操作的非侵入性方法。如果我以后需要更完整的审计历史，我会研究 Envers。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T20:40:07.800

似乎 parentAuditRecord 与 transferauditrecord 和 balance auditrecord 之间的关系不应该是一对多的。当我阅读您输入的内容时，我将其视为该审计层次结构的每个子类使用的表，这是一对一的关系。

[http://www.hibernate.org/hib_docs/reference/en/html/inheritance.html](http://www.hibernate.org/hib_docs/reference/en/html/inheritance.html)

您可能还想查看 JBoss 的 Envers 项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T01:21:15.880

在设计级别，似乎只有插入的 db 设计在这里会产生奇迹。

如果您想保持现在的状态（我相信您会这样做），您可以查看 Hibernate 侦听器/拦截器/事件（在文档中明确定义： [http ://www.hibernate.org/hib_docs /v3/reference/en-US/html_single/](http://www.hibernate.org/hib_docs/v3/reference/en-US/html_single/) )

否则，我刚刚查看了 JBoss Envers，它似乎也非常有用。

# asp-classic - ASP - 随机函数为两个不同的种子返回相同的值

> ID：282024
> 
> 赞同：0
> 
> 时间：2008-11-11T20:20:58.337
> 
> 标签：asp-classic

所以我使用 Rnd 和 Randomize 生成一个随机数来设置一个看起来像这样的种子：

```
Randomize lSeed
Response.Write Rnd 
```

我注意到它为 lSeed 连续两个值返回相同的结果（例如 123、124），但是在 125 上它将返回一个新值，但 126 将与 125 上的相同。为什么会这样是？

编辑：

我尝试过这样的事情

```
Randomize
Randomize lSeed
Response.write Rnd 
```

我得到了与上面描述的相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T20:33:42.353

这就是随机数的问题...

[http://web.archive.org/web/20011027002011/http://dilbert.com/comics/dilbert/archive/images/dilbert2001182781025.gif](http://web.archive.org/web/20011027002011/http://dilbert.com/comics/dilbert/archive/images/dilbert2001182781025.gif)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T20:23:19.940

您应该在每次获得随机值之前重新播种。我建议播种到计时器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T20:24:17.550

您还可以从当前似乎工作得很好的时间中播种

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T20:24:31.280

```
' For ASP, you can create a function like:
Public Function RandRange(ByVal low As Integer, ByVal high As Integer) As Integer
    Randomize()
    Return ((Rnd() * (high - low)) + low)
End Function

' For ASP.NET, you can create a function like:
Private _rnd As System.Random()
Public Function RandRange(ByVal low As Integer, ByVal high As Integer) As Integer
    ' Purpose: Returns Random Integer between low and high, inclusive
    ' Note: _rnd variable must be defined outside of RandRange function
    If _rnd Is Nothing Then
        _rnd = New System.Random()
    End If
    Return _rnd.Next(low, high)
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T16:17:14.200

问题是种子的值在其他环境中太大（递增的数据库值）。我最终做了价值 Mod 100 以获得半随机的东西，而这将是低的，无法始终工作。

# asp.net - ASP.NET 3.5 Web 应用程序项目是否可以“进行中”扩展或修补？

> ID：282028
> 
> 赞同：2
> 
> 时间：2008-11-11T20:23:50.610
> 
> 标签：asp.net, architecture, .net-3.5, deployment, extensibility

在构建 ASP.NET 3.5 WAP 时，我总是感到沮丧，因为无论我如何“隔离”或“封装”逻辑或 UI 位，我仍然会在需要时随时关闭整个站点更新一行代码。我可能会误解 ASP.NET 如何处理“bin”目录中的更改，但考虑到“为什么我的 AppDomain 正在卸载？”的数量。各个组中的消息，这似乎仍然是要避免的。

有没有人有任何指导和/或框架来真正模块化 ASP.NET 3.5 WAP，以便可以“在飞行中”添加/更新逻辑和页面？我用 Google 搜索了 System.AddIn，但它似乎专注于 WPF 应用程序。

谢谢你的帮助！

詹姆斯怀特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T20:30:16.713

这真的很难实现，因为 .NET 不支持卸载已加载到应用程序域中的类型。

一种方法是使用应用程序域，或者让 WCF 为您做这件事。

另一个是实现ayende 的[hod 代码交换](http://ayende.com/hibernating-rhinos.aspx)。

第三种方法是将逻辑放在动态编译的部分（ASPX）中。但是，应用程序将在可配置的更改量后重新启动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T20:31:44.463

使用两台或多台服务器。当你需要升级时，取下一个，升级它，提升它，取下另一个，升级它，提升它。

能够做到这一点需要一些努力 - 同时运行两个版本 - 因为数据库更改等可能很棘手。但是同样的努力在能够回滚更改方面也得到了回报，也许在“实验性”服务器上只托管几个用户等。更不用说水平扩展通常是一件好事:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T20:33:17.267

您可以在此处采用不同的方法，即重新启动 AppDomain 不会影响站点的可用性。

为此，请将会话移出进程，或完全停止依赖会话。

如果您这样做，重新启动 appdomain 并不是什么大问题，并且您正在准备您的应用程序，以便在您达到这一点时更轻松地跨集群进行可扩展性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T05:04:57.670

只是一个额外的想法，但我敢打赌，这就是整个“COM+”位所允许的（共享主机除外）。将逻辑分解为小型无状态香肠工厂可能允许顺利进行飞行中的修复操作。

# .net - 如何将表单的焦点“锁定”到特定控件？

> ID：282035
> 
> 赞同：3
> 
> 时间：2008-11-11T20:25:22.930
> 
> 标签：.net, winforms, focus

如何将 .net 应用程序的焦点锁定到特定控件？例如，如果我有一个包含 5 个文本框的表单，并且我希望它们按特定顺序填写，我如何阻止框 1 中的人点击/单击框 2，或者点击确定或取消或其他任何东西? 有没有简单的方法，或者我必须在适当的时候手动禁用/启用彼此的控件？

显而易见的解决方案（当焦点丢失时重置焦点）的问题在于 MSDN 说您可以通过这种方式锁定您的机器：

（来源：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.control.leave.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.leave.aspx)）

警告：

不要尝试从 Enter、GotFocus、Leave、LostFocus、Validating 或 Validated 事件处理程序中设置焦点。这样做可能会导致您的应用程序或操作系统停止响应。[有关详细信息，请参阅“键盘输入参考”部分中的 WM_KILLFOCUS 主题，以及位于http://msdn.microsoft.com/library](http://msdn.microsoft.com/library)的 MSDN 库中“关于消息和消息队列”主题的“消息死锁”部分.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T20:34:35.113

处理 textBox1 的 Leave 事件。在事件处理程序中，如果不满足您的条件，例如，如果用户没有输入某些输入，则将焦点重置回控件。

```
private void textBox1_Leave(object sender, EventArgs e)
{
    if string.isNullOrEmpty(textBox1.Text)
    {
        textBox1.focus();
    }
} 
```

为您的每个控件执行此操作，或者执行更通用的操作，例如：

```
private void textBox_Leave(object sender, EventArgs e)
{
    TextBox textBox = sender as TextBox;
    if (string.isNullOrEmpty(textBox.Text)
    {
        textBox.focus();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T20:36:02.723

基本上，您的设计必须严格。

*   检查文本框何时失去焦点，如果它没有有效的数据输入，则重新获得焦点。
*   当表单试图关闭时捕获——检查文本框是否有正确的数据，如果它没有取消关闭。
*   捕获鼠标事件并检查数据，无论用户尝试什么，都将焦点发送到您想要的位置。

尽管如此，这是一个坏主意，会导致疯狂的用户。我的建议是为您的数据输入提出另一种范式，它可以处理以稳健的形式接收数据，而不是在您的设计中作恶并强制执行某些行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T08:05:13.550

I think TextBox.Validating event is more appropriate, and it's meant for this specifically. Also it's much easier as you don't have to set the focus, all you need to do is set `e.Cancel = true;` to return focus to the current control

```
 void textBox1_Validating(object sender, CancelEventArgs e)
    {
        if (true) //Condition not met
        {
            e.Cancel = true;//Return focus to the current control
        }
    } 
```

Make sure the CauseValidation under the property of the textbox is true, which is by default set to true anyway.

# java - 使用 XML Beans 导入和使用外部模式

> ID：282061
> 
> 赞同：0
> 
> 时间：2008-11-11T20:35:06.420
> 
> 标签：java, xsd, schema, xmlbeans, multiple-schema

我有一点问题。我很久以前为我们的生产系统编写了一个 API，它使用了 Apache XML Beans。模式是同质的（即没有导入，所有内容都来自同一个模式），并且一切正常，即使 API 处理的代码非常冗长。从那以后，我使用 JAXB 编写了一个更简单、更优雅的 restful API，考虑到旧 API 的部分内容，即不同的模式，但一些元素是相同的。为了清理和简化我在旧 API 中的绑定代码，我通过删除它们并导入新模式并改用这些元素来替换一些部分。但是，每当我尝试解析使用新模式混合的文档时，都会从 XML Beans 收到验证错误：

```
error: cvc-complex-type.2.4a: Expected element 'redundant-element@http://www.my.com/old/xmlns' instead of 'redundant-element@http://www.my.com/new/xmlns' here in element redundant-element-list@http://www.my.com/old/xmlns 
```

有没有人遇到过这个？有什么解决方案或想法吗？我真的很感激。非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T18:15:58.760

看起来文档中的命名空间仍然是旧的。没有架构和文档很难说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T19:55:54.143

感谢您的回复。我已经尝试在文档的根目录和“冗余元素”本身上以多种排列方式显式添加新的命名空间。IE：

```
<oldxmlns:root xmlns:oldxmlns="abc" xmnls:newxmlns="xyz">
      .....
</oldxmlns:root> 
```

.. 和 ...

```
<oldxmlns:root xmlns:oldxmlns="abc">
   <oldxmlns:nested-element>
         .....
      <newxmlns:redundant-element xmnls:newxmlns="xyz">
           .....
      </newxmlns:redundant-element>
         .....
   </oldxmlns:nested-element>
</oldxmlns:root> 
```

...而且我还尝试了许多与默认命名空间等的组合，但都没有奏效。

# silverlight - 我需要做什么才能使属性元素语法适用于 Silverlight 中的自定义附加属性？

> ID：282062
> 
> 赞同：4
> 
> 时间：2008-11-11T20:35:32.707
> 
> 标签：silverlight, silverlight-2.0

我有这样的课：

```
public class Stretcher : Panel {

    public static readonly DependencyProperty StretchAmountProp = DependencyProperty.RegisterAttached("StretchAmount", typeof(double), typeof(Stretcher), null);

    public static void SetStretchAmount(DependencyObject obj, double amount)
    {
        FrameworkElement elem = obj as FrameworkElement;
        elem.Width *= amount;

        obj.SetValue(StretchAmountProp, amount);
    }
} 
```

我可以使用属性语法在 XAML 中设置拉伸量属性：

```
<UserControl x:Class="ManagedAttachedProps.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:map="clr-namespace:ManagedAttachedProps"
    Width="400" Height="300">

    <Rectangle Fill="Aqua" Width="100" Height="100" map:Stretch.StretchAmount="100" />

</UserControl> 
```

我的矩形被拉伸了，但我不能使用这样的属性元素语法：

```
<UserControl x:Class="ManagedAttachedProps.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:map="clr-namespace:ManagedAttachedProps"
    Width="400" Height="300">

    <Rectangle Fill="Aqua" Width="100" Height="100">
        <map:Stretcher.StretchAmount>100</map:Stretcher.StretchAmount>
    </Rectangle>
</UserControl> 
```

使用属性元素语法，我的 set 块似乎完全被忽略了（我什至可以在其中放置无效的双精度值），并且永远不会调用 SetStretchAmount 方法。

我知道可以做这样的事情，因为 VisualStateManager 做到了。我尝试过使用 double 以外的类型，但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T22:49:46.790

我想我明白了这一点，尽管我不完全确定我理解它起作用的原因。

为了让您的示例正常工作，我必须创建一个名为 Stretch 的自定义类型，并带有一个名为 StretchAmount 的属性。一旦我这样做并将其放在属性元素标签中，它就可以工作了。否则它不会被调用。

```
public class Stretch
{
    public double StretchAmount { get; set; }
} 
```

并且属性更改为..

```
public static readonly DependencyProperty StretchAmountProp = DependencyProperty.RegisterAttached("StretchAmount", typeof(Stretch), typeof(Stretcher), null);

public static void SetStretchAmount(DependencyObject obj, Stretch amount) 
{ 
    FrameworkElement elem = obj as FrameworkElement; 
    elem.Width *= amount.StretchAmount; 
    obj.SetValue(StretchAmountProp, amount); 
} 
```

要让它在您不使用属性元素的场景中工作，您需要创建一个自定义类型转换器以允许它工作。

希望这会有所帮助，即使它没有解释我仍在努力理解的原因。

顺便说一句 - 对于真正的脑筋急转弯，请查看反射器中的 VisualStateManager。VisualStateGroups 的依赖属性和 setter 都是**internal**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T15:19:04.907

所以 Bryant 的解决方案有效，它确实需要对 XAML 稍作修改：

```
<Rectangle Fill="Aqua" Width="100" Height="100" x:Name="the_rect">
        <map:Stretcher.StretchAmount>
            <map:Stretch StretchAmount="100" />
        </map:Stretcher.StretchAmount>
</Rectangle> 
```

# c# - C# - ODP.NET 和 ora-01475 必须重新解析游标以更改绑定变量数据类型

> ID：282067
> 
> 赞同：0
> 
> 时间：2008-11-11T20:38:00.580
> 
> 标签：c#, .net, oracle, odp.net

在已经插入了一些具有真实日期值的记录之后`ora-01475`，每当我尝试在（类型的）列中插入空值时，我都会得到。`DateTime`

我正在使用将`OracleParameter`名称和值作为对象的构造函数（我假设数据类型从对象的数据类型中隐含），但由于有时我的参数的值为 null，因此将其设置`String`为因此抛出此错误。

我不想使用显式采用数据类型的构造函数，因为我大量使用反射来构建`OracleCommand`对象及其参数。

如果我发现这种情况，如何重新解析光标（如错误所示）？
有没有其他人遇到过这个并有解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T20:23:35.830

您是否尝试过使用可为空的类型？

```
 DateTime? myDate;
            //Code to set myDate value...
            string sql = "[your SQL]"
            using (OracleCommand command = new SqlCommand(sql, cn))
            {
                OracleParameter param = new OracleParameter(":Name",myDate);
                command.Paerameters.add(param);
                command.ExecuteNonQuery();
            } 
```

# c# - 10 年后重回 Windows 编程

> ID：282075
> 
> 赞同：5
> 
> 时间：2008-11-11T20:42:22.397
> 
> 标签：c#, windows

我想学习编写 Windows 桌面应用程序的最新技术。我上次的经验是使用 MFC 使用 VC++ 6。现在的情况似乎更复杂了，我不确定我是否应该学习.NET，不知道什么是 Windows 窗体、WPF 等等。我想做的只是能够编写一些简单的 Windows GUI 应用程序，可能在此过程中使用和学习 C#。

有什么推荐的书读之类的吗？

另外，VC2008的免费版是否足以编写小应用程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-11T20:44:56.043

我会选择 .NET 和 WPF。WinForms 仍然可用，但此时它确实是 .NET 的一个遗留分支，如果您从头开始，不值得学习。WPF 提供了许多很好的功能，并且非常适合启动和运行。

我发现“ [Windows Presentation Foundation Unleashed](https://rads.stackoverflow.com/amzn/click/com/0672328917) ”很好地介绍了 WPF。它很好地解释了基本概念，而不仅仅是那些充满屏幕截图的 2,000 页教程之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T21:07:21.113

我推荐[Head First C#](https://rads.stackoverflow.com/amzn/click/com/0596514824)。如果您以前使用 C++ 进行过编程，那么您应该可以很快上手。

[替代文字 http://ecx.images-amazon.com/images/I/51u3iZDwU6L._SL500_AA240_.jpg](http://ecx.images-amazon.com/images/I/51u3iZDwU6L._SL500_AA240_.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-11T20:45:28.600

我将从阅读[Code Project中的 C# 在线教程和文章开始](http://www.codeproject.com)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-11T20:47:39.923

自 vc 6 以来，MFC 几乎没有什么变化，您应该能够轻松地再次使用它，虽然这种技能集可能不像 .net 那样需要，但仍然有工作，您仍然可以编写引人注目的 Windows 应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-11T21:46:04.530

实际上，我只是浏览 Stack Overflow 并在这里发布了一些问题就学到了很多东西。我认为 Visual Studio Express 工具非常适合新开发人员。我也是 Bob Tabor 的粉丝 ( [http://www.learnvisualstudio.net/](http://www.learnvisualstudio.net/) ) 他确实在 MSDN 上提供了一些免费的东西，[这](http://msdn.microsoft.com/en-us/vstudio/aa700773.aspx)对于像我这样具有大部分脚本背景的人来说真的很有帮助。由于您过去的经验，您可能领先于我，所以可能对您来说太初级了。

我真的开始喜欢 C# 和 .NET 并且刚刚开始能够阅读代码并且在很大程度上理解它。这对我来说是一个很大的突破。

[吉姆](http://hellocsharp.blogspot.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-11T20:44:38.493

好吧，如果您使用的是 C#，那么您使用的是 .NET。.NET 确实是用于创建桌面应用程序的绝佳框架。我认为你在正确的轨道上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-17T07:46:33.283

使用 Visual Studio 和 .Net 开发 Windows 应用程序根本不是一项艰巨的任务。

只需安装 Visual Studio，从 www.youtube.com 观看一些 Visual Studio 和 C# .net 的视频教程，然后开始您的开发。

由于您有开发背景，因此编写逻辑不会有障碍，您可能会遇到类问题，使用 Visual Studio 的对象浏览器来克服类问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-13T16:04:09.657

如果您有 C++ 背景并且不怕指针/堆栈/堆等，那么这[本书](http://www.amazon.co.uk/CLR-Via-Applied-Framework-Programming/dp/0735621632)(CLR vi C#) 将使您对 .Net 有一个极好的理解。它可读性很强，将为您提供理解任何新的/即将到来的 .Net 技术（例如 Linq、扩展方法等）所需的基础。

[VS2008 express 版本在这里](http://www.microsoft.com/Express/)免费提供，足以编写小型应用程序。

# php - php访问远程数据库

> ID：282084
> 
> 赞同：2
> 
> 时间：2008-11-11T20:45:29.770
> 
> 标签：php, mysql

帮助！

我在 HOST1 上有一个 PHP (PHP 5.2.5) 脚本，试图连接到 MySql 数据库 HOST2。两台主机都在通过 CPanel 控制的共享主机环境中。

HOST2 设置为允许来自 HOST1 的远程数据库连接。

我使用的 PHP 连接是：- $h2 = IPADDRESS; $dbu = 数据库用户；$dbp = DBPASS；

```
$DBlink = mysql_connect($h2, $dbu, $dbp); 
```

这总是失败： -

```
Access denied for user '<dbusername>'@'***SOMESTRING***' (using password: YES) 
```

注意：***SOMESTRING***看起来可能与共享主机环境有关。

有任何想法吗？？？

顺便说一句：我可以使用 OpenOffice 通过 ODBC 和 SQLyog 从我的笔记本电脑远程连接到 HOST2。SQLyog 和 ODBC 设置与 PHP 脚本尝试使用的设置完全相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T21:07:53.860

somestring 可能是您的网络服务器的反向查找。

您可以从您的 cPanel 修改权限吗？您是否已采取任何措施允许从您的工作站 (ODBC) 进行访问？

错误消息似乎表明您具有对 mysql 服务器的网络访问权限，但没有来自该特定主机的用户名的权限。

如果您被允许为您的数据库授予权限，请调用：

GRANT SELECT ON database.* TO username@ip.address.of.host1 IDENTIFIED BY 'password'

可能对你有用。我只是在脑海中写下这个，你可能想仔细检查 mysql-docs 中的语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T21:05:53.053

*   您是否阅读过有关[拒绝访问错误原因](http://dev.mysql.com/doc/refman/5.0/en/access-denied.html)的 MySQL 文档？

*   您是否联系过托管服务提供商的支持？他们应该有权对数据库连接进行故障排除。互联网上的人无法访问。

*   是否需要指定数据库名称？您的帐户可能只能连接到特定数据库。该`mysql_connect()`函数不允许您指定数据库，但[`new mysqli()`](http://php.net/manual/en/mysqli.connect.php)可以。我不确定这是否相关——它可能允许您连接，但当您尝试查询不在数据库中的表时会给您错误。

*   您确定您使用的密码正确吗？MySQL 允许每个帐户在每个客户端主机上使用不同的密码。诚然，这不是一种常见的配置，但它是可能的。您的托管服务提供商应该能够告诉您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T20:56:54.850

只是一些想法：

*   HOST1 没有对 HOST2 的远程访问（共享主机不允许）
*   MySQL 帐户无权从 HOST1 访问（创建帐户时指定的 IP 地址或通配符）

编辑：

在回复您的评论时，我的意思是 HOST1 无法访问 HOST2 上的 MySQL 端口。当然，Web 服务会起作用，因为端口 80 对公众开放。正如另一位用户指出的那样，您得到了响应，因此您正在达到它。我会尝试指定数据库，并仔细检查您运行的帐户创建命令。

对于第二部分，我的意思是： http: [//dev.mysql.com/doc/refman/5.0/en/adding-users.html](http://dev.mysql.com/doc/refman/5.0/en/adding-users.html)

您可以指定用户名可以连接的主机。如果未设置为 HOST2 的 IP 或通配符，则 HOST2 无法使用这些凭据登录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T21:10:01.453

该错误消息意味着您可以联系 mySql 服务器，但您尝试登录的用户没有访问权限。

用户根本没有访问权限，或者它可以在本地访问，但不能从您连接的主机访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T20:49:14.500

您应该尝试使用主机名和端口，例如 $h2 = IPADDRESS:3307;

# c# - 学习 C#、ASP.NET 3.5 - 我应该按什么顺序学习/跳过什么？

> ID：282086
> 
> 赞同：8
> 
> 时间：2008-11-11T20:46:27.757
> 
> 标签：c#, .net, asp.net

C# 和 ASP.net 有很多内容。我应该从哪里开始？我不应该专注于什么？

我应该学习Winforms然后WPF吗？网络表单/Silverlight 也一样？我应该学习 ASP.MVC 还是经典的 ASP.NET？如果两者都有，哪个先？

在非此即彼的情况下-先了解另一个更有意义？

我应该预先学习哪些主要的 .NET 功能，从而打开理解未来的大门？

我故意不提及诸如值/引用类型、类、面向对象的概念等基础知识，因为它们应该放在第一位，然后是细节。在这里，我对细节感兴趣。

[编辑 - 添加了我的目标的详细信息] 提出的要点 - “我想写什么”？

基本上，一个 Intranet 应用程序，它监视一组文档并将工作流实现为更改控制过程。该应用程序还将审核文件并报告问题，自我纠正常见错误。许多参数需要最终用户可定义和可插入。文档格式需要适应不同的专有格式，尽管它们基本相同。该应用程序将非常模块化。

我倾向于使用 Web 界面，因为客户端规格和管理员权限会有所不同——浏览器确实是我唯一可以依靠的东西。

正如你所看到的，它是所有东西的一部分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-11T20:53:24.480

你想写什么？如果您想编写 Windows 客户端应用程序，请查看 WinForms 和 WPF（实际上不需要在 WPF 之前学习 WinForms，除了许多教程/书籍可能会将 WPF 概念与 WinForms 概念进行比较的方式）。如果您正在查看 Web 应用程序，那么 ASP.NET 或 ASP.MVC - 我不知道您是否真的需要 MVC 之前的“普通” ASP.NET。

在某种程度上，Silverlight 两者兼而有之——富客户端可能与服务器对话以获取有趣的数据等。

不过，在学习其中任何一个之前，我建议您学习比您提到的主题更上一层楼的基础知识——比如文本在 .NET 中的工作方式（包括编码和正则表达式）、I/O，也许还有线程。哦，还有 LINQ :) 在这方面有几本书非常好：

*   [简而言之 C# 3.0](https://rads.stackoverflow.com/amzn/click/com/0596527578)
*   [CLR 通过 C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)
*   [加速 C# 2008](https://rads.stackoverflow.com/amzn/click/com/1590598733)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T21:15:23.283

当我从 Classic ASP 迁移到 .NET 2.0 时，我遇到了同样的问题…….NET 非常庞大：那么我应该从哪里开始呢？

我所做的只是弄脏了手，开始缓慢，拿一个项目（在我的情况下是一个**非常重要的项目**- 一个涵盖并自动化所有 4 人工作的金融网络应用程序）并开始实施，每次我没有知道如何完成某事，或者我在 ASP 中有想法但在 ASP.NET 中没有我会去**[www.asp.net](http://www.asp.net/learn)**或**[4GuysFromRolla](http://www.4GuysFromRolla.com)**网站并搜索示例，复制/粘贴，了解我在做什么，然后......继续下一堵墙。

**我花了 6 个月**的时间让一切正常运行，但最糟糕的是！现在已经过去了将近 3 年，我知道我做了正确的选择，但那时……我很害怕！

现在......你指的是.NET 3.5，它有一堆新的东西，比如扩展、linq等......我会通过简单的部分，当时机成熟时，“也许我可以在这里使用LINQ，让我搜索如何在这部分使用它”

希望你走自己的路，**买一些参考书**，这样你就可以阅读一些新的东西，并在你需要的时候得到参考“啊，我在书的某个地方读到这个，让我搜索一下……它在哪里？”

我[从 Wrox 购买了 Professional ASP.NET](https://rads.stackoverflow.com/amzn/click/com/0764576100)作为参考书，即使今天我也去那里看新事物，即使我开始使用 .NET 3.5，想法就在那里，只有一种新的方法来完成它.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-11T20:51:39.197

我建议学习任何你感兴趣的东西。选择一个“宠物项目”并尝试使用你列出的技术之一来创建它。如果您喜欢制作 Windows 桌面风格的应用程序，请使用 WPF 或 WinForms。如果您喜欢在 Web 上制作丰富的桌面风格应用程序的想法，那么请选择 Silverlight。会有大量的重叠。

但就核心 .NET 开发而言，如果我刚开始，我建议先学习 ASP.NET MVC，因为它会为您提供良好的基础，例如：为可测试性而设计、无 ViewState 的编码、SEO 友好网址等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-11T20:53:44.793

这取决于（可怕的反应，我知道，但让我解释一下）

你打算做任何Windows窗体开发吗？你提到了 C# 和 ASP.NET，所以对我来说听起来你正在做基于 Web 的编程。如果是这样，请暂时跳过 Winforms 和 WPF。

Silverlight 值得一试，但它仍然相当新，所以我将其列为第二优先级。

现在讨论 MVC 或 Web 表单问题。MVC 使您可以完全控制发出的 HTML、CSS 和 Javascript，但需要更多的工作，而 Web 表单使您易于开发，但不能 100% 控制发出的标记。您可以使用 Web 表单做很多事情，并且 MVC 的引入不会威胁 Web 表单的未来。MVC 是非常新的事物，所以事情正在发生变化，但最终我看到他们俩幸福地并肩生活。

关于学习 .NET 的总体情况，我听说过一本名为 CLR via C# 的书，其中介绍了 .NET 的所有基础知识和内部工作原理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-11T20:58:59.587

一定要学习基础知识（就像你已经提到的那样），比如 CLR 如何处理类型、垃圾收集、安全性、“AppDomains”、线程等。

对于ASP.NET，学习“页面生命周期”和“控件生命周期”是必不可少的。此外，会话状态和数据绑定可能是很好理解的东西。

我暂时不用担心 WinForms、WPF 或 Silverlight。它们不会直接帮助 ASP.NET，并且在您学习了 CLR 和 .NET Framework 基础知识之后相对容易上手。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-11T21:04:52.930

你的主要目标是什么——为了乐趣或可雇佣性而学习？如果你是一名学生，并且多年来一直担心编程职业，那么我会强烈赞同选择一个你感兴趣的相对简单的项目然后就去做的想法。

假设您要创建一个应用程序来跟踪您的视频游戏收藏。首先，您需要一种存储信息的方法——这将是 c# 和一些持久性策略（如 mySql 或 SQL Server 或 XML）的组合。

然后你需要一种方法来展示你的集合并与之交互——添加、删除和编辑对象以及持久化更改。在此步骤中，使用您感兴趣的每一种演示技术 - WPF、WinForms、Asp.net、带有 MVC 的 asp.net、Silverlight - 无论您感兴趣。当您学习使用一种技术时，您将学习技术你需要在接下来使用。

不要只选择一个 - 与所有你感兴趣的人一起玩。

现在，如果您主要对哪些技能可以让您最快被雇用感兴趣，我会说看看您的市场，但最需要的可能是直接的 ASP.Net 技能 - 或者至少是这样从我的角度来看它是什么样的。几年后，它很可能是 ASP.Net MVC 技能。但在某些市场中，您更容易获得 VB6 工作。这一切都取决于您在何时何地寻找。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T20:50:23.470

我强烈推荐以下书籍，以了解 ASP.NET 3.5 中的新功能

*   [ASP.NET MVC 1.0 网站编程](https://rads.stackoverflow.com/amzn/click/com/0470410957)
*   [专业的 ASP.NET MVC 1.0](https://rads.stackoverflow.com/amzn/click/com/0470384611)
*   [ASP.NET 3.5 网站编程](https://rads.stackoverflow.com/amzn/click/com/0470187581)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T23:44:50.307

有时视频可能会有所帮助。我从 Total Training 的一组视频教程中学到了开始时需要知道的[一切](http://www.totaltraining.com/prod/bundle/aspnet2_bwa.asp)。如果您购买磁盘，价格会很高，但有一个更便宜的仅限在线选项。

# asp.net - 在 asp.net 中使用数据源控件进行更新

> ID：282087
> 
> 赞同：0
> 
> 时间：2008-11-11T20:47:06.693
> 
> 标签：asp.net, .net-datasourcecontrol

如何通过按钮在数据源控件中运行更新查询？我有数据源控件，其中配置了更新查询。我只是不知道在 button_click 事件中放置什么来让它运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T21:46:49.553

啊哈更新命令后我需要括号

sdsUpdateName.Update();

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T20:56:46.970

在事件处理程序中，只需调用 Datasource 控件的 Update 方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-11T21:30:54.623

调用数据源的 Update 方法时出现错误

sdsUpdateName.Update；

只有赋值、调用、递增、递减和新对象表达式可以用作语句

# c++ - 从 C++ 设置 OLE 请求超时

> ID：282091
> 
> 赞同：6
> 
> 时间：2008-11-11T20:48:18.267
> 
> 标签：c++, com, ole

我正在使用 CoCreateInstance 实例化本地 COM 服务器。有时，提供服务器的应用程序需要很长时间才能启动。发生这种情况时，Windows 会弹出一个对话框，如下所示：

**服务器繁忙**

该操作无法完成，因为其他程序正忙。选择“切换到”以激活繁忙的程序并纠正问题。

[切换到...] [重试] [取消]

我在 Application 对象上发现了一个 Visual Basic 属性，OleRequestPendingTimeout，它可用于控制此对话框出现之前的时间。我找不到任何关于此的好的文档或对 C++ 有用的等效文档。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-11T23:03:33.843

如果您使用的是 MFC，我们曾经做过这样的事情：

```
// prevent the damned "Server Busy" dialog.
AfxOleGetMessageFilter()->EnableBusyDialog(0);
AfxOleGetMessageFilter()->EnableNotRespondingDialog(0); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T22:10:12.157

看看`IMessageFilter`和`CoRegisterMessageFilter`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-24T13:42:07.567

增加超时调用：

```
AfxOleGetMessageFilter()->SetMessagePendingDelay(nTimeout); 
```

在此处查看详细信息[如何防止在长时间 COM 操作期间出现 OLE 服务器忙对话框](http://support.microsoft.com/kb/248019)

# php - 在php中尚不存在的文件夹中创建文件

> ID：282093
> 
> 赞同：26
> 
> 时间：2008-11-11T20:49:07.220
> 
> 标签：php, file-io, directory

我希望我的 php 脚本根据日期在文件夹中创建一个输出文件。我这样做的方式是它应该从另一个我无法编辑的程序输出的文本文件中获取文件夹名/文件名。

因此，它从中获取数据的文件如下所示：

```
data/newfolder/10302008/log_for_Today.txt | 24234234 
```

只有多行，我只需要脚本逐行遍历它，获取文件夹/文件名并在该位置创建一个具有该名称的空文件。

目录都是 777。现在我知道如何在文件夹中创建一个新的空 exe 文件，但似乎无法弄清楚如何先创建文件夹，然后再创建其中的 exe，有​​什么想法吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-11-11T21:07:05.140

```
if(!file_exists(dirname($file)))
    mkdir(dirname($file), 0777, true);
//do stuff with $file. 
```

使用[mkdir()](http://php.net/mkdir)的第三个参数，这使它递归地创建目录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T21:06:14.923

和

```
$directories = explode( '/', $path ); 
```

您可以拆分路径以获取单个目录名称。然后遍历数组并创建设置 chmod 777 的目录。（执行 php 的系统用户必须有能力这样做。）

```
$file = array_pop( $directories );
$base = '/my/base/dir';

foreach( $directories as $dir )
{

   $path = sprintf( '%s/%s', $base, $dir )
   mkdir( $path ); 
   chmod( $path, 777 );
   $base = $path;

}

// file_put_contents or something similar
file_put_contents( sprintf( '%s/%s', $base, $file ), $data ); 
```

这里的问题是你可能没有从你的 php 脚本中设置 chmod。

另一种方法是使用 FTP。用户将 FTP 登录数据传递给脚本，它使用 FTP 功能来管理文件。

[http://www.php.net/FTP](http://www.php.net/FTP)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-19T22:39:39.933

为时已晚，但我发现了这个问题，我有一个解决方案，这里有一个示例代码，无论你的文件有多深，它对我都有好处。如果您在 Windows 服务器上运行它，您应该更改第 1 行和第 3 行的目录分隔符。

```
$pathToFile = 'test1/test2/test3/test4/test.txt';
$fileName = basename($pathToFile);
$folders = explode('/', str_replace('/' . $fileName, '', $pathToFile));

$currentFolder = '';
foreach ($folders as $folder) {
    $currentFolder .= $folder . DIRECTORY_SEPARATOR;
    if (!file_exists($currentFolder)) {
        mkdir($currentFolder, 0755);
    }
}
file_put_contents($pathToFile, 'test'); 
```

最好的问候，乔治！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-11T21:00:48.787

使用 mkdir() 创建任何丢失的文件夹，然后使用 touch() 创建空文件。

在这两种情况下都可以使用绝对路径，这意味着：

```
mkdir('数据');
mkdir('数据/新文件夹');
mkdir('data/newfolder/10302008');
touch('data/newfolder/10302008/log_for_Today.txt');

```

如果你想知道它的起点在哪里，你可以使用 getcwd() 告诉你工作目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T20:55:24.040

你不能通过使用 mkdir ( [http://nl.php.net/manual/en/function.mkdir.php](http://nl.php.net/manual/en/function.mkdir.php) ) 创建目录然后 chmod it 777 ( [http://nl.php.net/manual /en/function.chmod.php ) 使用 chdir (](http://nl.php.net/manual/en/function.chmod.php) [http://nl.php.net/manual/en/function.chdir.php](http://nl.php.net/manual/en/function.chdir.php) )更改目录，然后创建文件 (touch)？

# database - 什么是 Hi/Lo 算法？

> ID：282099
> 
> 赞同：488
> 
> 时间：2008-11-11T20:53:00.957
> 
> 标签：database, algorithm, primary-key, identifier, hilo

什么是 Hi/Lo 算法？

我在[NHibernate](http://en.wikipedia.org/wiki/NHibernate)文档中找到了这一点（这是生成唯一密钥的一种方法，第 5.1.4.2 节），但我还没有找到关于它如何工作的很好的解释。

我知道 Nhibernate 处理它，我不需要知道里面，但我只是好奇。

* * *

## 回答 #1

> 赞同：575
> 
> 时间：2008-11-11T20:57:35.020

基本思想是你有两个数字来组成一个主键——一个“高”数字和一个“低”数字。客户端基本上可以增加“高”序列，知道它可以安全地从前一个“高”值的整个范围内生成具有各种“低”值的键。

例如，假设您有一个当前值为 35 的“高”序列，而“低”数字在 0-1023 范围内。然后客户端可以将序列增加到 36（以便其他客户端能够在使用 35 时生成密钥）并知道密钥 35/0、35/1、35/2、35/3... 35/1023 是全部可用。

能够在客户端设置主键，而不是在没有主键的情况下插入值然后将它们取回客户端，这可能非常有用（尤其是使用 ORM）。*除此之外，这意味着您可以轻松地建立父/子关系并在执行任何*插入之前将键全部到位，这使得它们的批处理更简单。

* * *

## 回答 #2

> 赞同：166
> 
> 时间：2008-11-11T22:08:43.860

除了乔恩的回答：

它用于能够断开连接工作。然后，客户端可以向服务器请求一个 hi 号码并创建增加 lo 号码本身的对象。在 lo 范围用完之前，它不需要联系服务器。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-06-23T14:27:11.250

该`hi/lo`算法将序列域分成`hi`组。一个`hi`值是同步分配的。每个`hi`组都有最大数量的`lo`条目，可以离线分配，而不必担心并发重复条目。

1.  `hi`令牌由数据库分配，保证两个并发调用看到唯一的连续值

2.  检索到`hi`令牌后，我们只需要`incrementSize`（`lo`条目数）

3.  标识符范围由以下公式给出：

    ```
     [(hi -1) * incrementSize) + 1, (hi * incrementSize) + 1) 
    ```

    并且“lo”值将在以下范围内：

    ```
     [0, incrementSize) 
    ```

    从以下起始值开始应用：

    ```
     [(hi -1) * incrementSize) + 1) 
    ```

4.  当所有`lo`值都被使用时，获取一个新`hi`值并继续循环

这种视觉呈现也很容易理解：

[![在此处输入图像描述](https://i.stack.imgur.com/VElVV.png)](https://vladmihalcea.com/the-hilo-algorithm/)

虽然[`hi/lo`](https://vladmihalcea.com/the-hilo-algorithm/)优化器可以很好地优化标识符生成，但它不能很好地与其他系统将行插入到我们的数据库中，而对我们的标识符策略一无所知。

Hibernate 提供了[`pooled-lo`](http://vladmihalcea.com/hibernate-hidden-gem-the-pooled-lo-optimizer/)优化器，它提供了 hi/lo 生成器策略的优势，同时还提供了与其他不了解此序列分配策略的 3rd 方客户端的互操作性。

pooled-lo 优化器既高效又可与其他系统互操作，是比传统的 hi/lo 标识符策略更好的候选者。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-08-26T09:29:34.877

Lo 是一个缓存分配器，它将键空间分成大块，通常基于一些机器字大小，而不是人类可能明智地选择的有意义大小的范围（例如，一次获得 200 个键）。

Hi-Lo 的使用往往会在服务器重启时浪费大量的密钥，并生成大量对人类不友好的密钥值。

比 Hi-Lo 分配器更好的是“线性块”分配器。这使用了类似的基于表的原则，但分配了小的、大小方便的块并生成了对人类友好的值。

```
create table KEY_ALLOC (
    SEQ varchar(32) not null,
    NEXT bigint not null,
    primary key (SEQ)
); 
```

要分配下一个，比如说，200 个键（然后作为一个范围保存在服务器中并根据需要使用）：

```
select NEXT from KEY_ALLOC where SEQ=?;
update KEY_ALLOC set NEXT=(old value+200) where SEQ=? and NEXT=(old value); 
```

如果您可以提交此事务（使用重试来处理争用），您已经分配了 200 个密钥并可以根据需要分配它们。

该方案的块大小仅为 20，比从 Oracle 序列分配快 10 倍，并且在所有数据库中 100% 可移植。分配性能相当于hi-lo。

与 Ambler 的想法不同，它将键空间视为连续的线性数字线。

这避免了复合键的推动（这从来都不是一个好主意），并避免在服务器重新启动时浪费整个低字。它生成“友好的”、人性化的关键值。

相比之下，Ambler 先生的想法是分配高 16 位或 32 位，并随着高字数的增加生成对人类不友好的大键值。

分配键的比较：

```
Linear_Chunk       Hi_Lo
100                65536
101                65537
102                65538
.. server restart
120                131072
121                131073
122                131073
.. server restart
140                196608 
```

在设计方面，他的解决方案在数字行（复合键、大型 hi_word 产品）上比 Linear_Chunk 更复杂，但没有获得比较优势。

Hi-Lo 设计很早就出现在 OO 映射和持久性中。如今，诸如 Hibernate 之类的持久性框架提供了更简单、更好的分配器作为默认设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-23T17:08:32.163

根据我的经验，我发现 Hi/Lo 算法非常适合具有复制场景的多个数据库。想象一下。您在纽约有一台服务器（别名 01），在洛杉矶有另一台服务器（别名 02），然后您有一个 PERSON 表......所以在纽约创建一个人时......您总是使用 01 作为 HI 值LO 值是下一个连续的。例如。

*   010000010 杰森
*   010000011 大卫
*   010000012 西奥

在洛杉矶，您总是使用 HI 02。例如：

*   020000045 鲁珀特
*   020000046 奥斯瓦尔德
*   020000047 马里奥

因此，当您使用数据库复制（无论是什么品牌）时，所有主键和数据都可以轻松自然地组合在一起，而无需担心重复主键、冲突等。

这是在这种情况下最好的方法。

# continuous-integration - 使用持续集成构建设置时，代码冻结仍然相关吗？

> ID：282105
> 
> 赞同：4
> 
> 时间：2008-11-11T20:54:29.893
> 
> 标签：continuous-integration, development-process, code-freeze

我过去使用持续集成服务器取得了巨大成功，并且不需要在源代码控制系统上执行代码冻结。

然而，最近似乎在我所见的任何地方，大多数商店在准备发布时使用代码冻结的概念，甚至是他们产品的新测试版本。这个想法甚至在我当前的项目中运行。

当您提前且经常签入，并使用单元测试、集成测试、验收测试等时，是否还需要冻结代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-11T21:04:48.873

持续集成是一种“构建”，但它是开发周期编程部分的一部分。就像 TDD 中的“测试”是开发周期的编程部分的一部分。

作为整个开发周期的一部分，仍然会有构建和测试。

持续集成和测试的重点是缩短反馈循环并为程序员提供更多可见性。最终，这确实意味着测试和构建中的问题更少，但这并不意味着您不再执行开发周期的原始部分 - 它们只是更有效并且可以提升到更高的水平，因为正在解决更多琐碎的问题在开发周期的早期发现。

因此，您仍然必须冻结代码（或至少是一个分支），以确保您交付的产品的基线符合预期。仅仅因为某人可以高度自信地实现某些东西并不意味着它会在不经过相同的最终周期的情况下进入您的版本，而代码冻结是其中的重要部分。

使用 CI，您的代码冻结可能会非常短，因为您的最终构建、测试和发布可能非常可靠，并且代码冻结甚至可能不存在于小型项目中，因为不需要分支 - 您发布并立即返回很快就开始开发下一组功能。

我还想补充一点，CI 和 TDD 允许最终的构建和测试阶段恢复到更接近传统的瀑布（做所有的开发，做所有的测试，然后发布），而不是已经完成的更持续的 QA在每周或每月构建的项目上。您的测试人员可以使用 CI 构建来提供早期反馈，但它实际上是一种与最终测试不同的反馈，在最终测试中，您正在寻找稳定性和可靠性而不是功能（显然在单元“测试”中遗漏了功能）开发商建造的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T20:59:17.090

代码冻结很重要，因为持续集成不会取代运行时回归测试。

构建应用程序并通过单元测试只是挑战的一小部分，理想情况下，当您冻结发布代码时，您将签署两件事：

*   此代码已完全回归，并且没有缺陷
*   此代码正是应该在生产中使用的代码（为了符合 SOX）。

如果您使用现代 SCM，只需在此时分叉代码并开始在分支中处理下一个版本，并在部署项目时进行合并。（当然，放置一个标签，以便在需要应用中断补丁时回滚该点）。

一旦代码处于“发布模式”，就不应触摸它。

我们的典型流程：

```
Development
   ||
   \/
   QAT 
   ||
   \/
   UAT => Freeze until deploy date => Deploy  => Merge and repeat
            \                                     /
             \- New Branch for future dev -------/ 
```

当然，我们在开发过程中通常有许多并行分支，它们在 UAT 之前合并到发布流中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T21:10:38.487

代码冻结与 QA 的关系比与 Dev 的关系更大。代码冻结是 QA 说的：“够了。我们只有带宽来全面测试到目前为止添加的新功能。” 这并不意味着开发人员没有足够的带宽来添加更多功能，只是 QA 需要时间来处理静止的代码库，以确保一切都能协同工作。

如果您都处于持续集成模式（包括 QA），这可能只是很短时间的冻结，而 QA 会在整个软件包发布之前对其进行最终批准。

这完全取决于您的 QA 和回归测试与开发周期的集成程度。

我会支持已经提到的关于 SCM 分支的投票，并允许开发人员继续使用与 QA 测试的代码分支不同的代码分支。这一切都回到了同一件事上。QA 和回归测试需要在发布前一段时间的静态代码库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T21:47:41.253

我听起来像是一个上下文驱动的人，但答案是“这取决于”。

代码冻结是一种应对问题的策略。如果您没有它擅长解决的问题，那么不，不需要它。如果您有另一种解决问题的技术，那么不，不需要它。

代码冻结是一种降低风险的技术。如果带来的优点是稳定性和简单性。它带来的缺点是

另一种技术是使用分支，例如使用“特征分支”。分支的缺点是处理分支和合并更改的成本。

您描述的降低风险的技术是自动化测试，以提供快速反馈。这里的权衡是增加一些风险的速度（你会错过一些错误）。

在我和你在一起的这些方法中，我更喜欢自动化测试。但是在某些情况下，例如非常高的失败成本，代码冻结确实提供了很多价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T20:58:01.413

我认为代码冻结很重要，因为每个新功能都是潜在的新错误来源。当然回归测试很棒，有助于解决这个问题。但是代码冻结允许开发人员专注于修复*当前突出的错误*并将当前的功能设置为值得发布的状态。

充其量，如果我真的想在代码冻结期间开发新代码，我会分叉冻结的树，在那里完成我的工作，然后在冻结之后，将分叉的树合并回来。

# c# - C# WinForms 中的切换按钮

> ID：282118
> 
> 赞同：78
> 
> 时间：2008-11-11T20:58:07.483
> 
> 标签：c#, winforms, button

是否可以在 C# WinForms 中创建切换按钮？我知道您可以使用 CheckBox 控件并将其 Appearance 属性设置为“Button”，但它看起来不正确。我希望它在按下时看起来是凹陷的，而不是平坦的。有什么想法吗？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2010-09-23T09:21:57.133

您可以只使用 a`CheckBox`并将其外观设置为`Button`：

```
CheckBox checkBox = new System.Windows.Forms.CheckBox(); 
checkBox.Appearance = System.Windows.Forms.Appearance.Button; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-11T21:10:14.120

检查 FlatStyle 属性。将其设置为“系统”会使复选框在我的环境中下沉。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-12-10T14:52:06.357

这是一种创建切换按钮的简单方法。我在vs2010中测试它。这是完美的。

ToolStripButton 具有“Checked”属性和“CheckOnClik”属性。您可以将其用作切换按钮

```
tbtnCross.CheckOnClick = true; 
```

或者

```
 tbtnCross.CheckOnClick = false;
    tbtnCross.Click += new EventHandler(tbtnCross_Click);
    .....

    void tbtnCross_Click(object sender, EventArgs e)
    {
        ToolStripButton target = sender as ToolStripButton;
        target.Checked = !target.Checked;
    } 
```

此外，您可以像这样创建切换按钮列表：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        arrToolView[0] = tbtnCross;
        arrToolView[1] = tbtnLongtitude;
        arrToolView[2] = tbtnTerrain;
        arrToolView[3] = tbtnResult;
        for (int i = 0; i<arrToolView.Length; i++)
        {
            arrToolView[i].CheckOnClick = false;
            arrToolView[i].Click += new EventHandler(tbtnView_Click);
        }
        InitTree();
    }

    void tbtnView_Click(object sender, EventArgs e)
    {
        ToolStripButton target = sender as ToolStripButton;
        if (target.Checked) return;
        foreach (ToolStripButton btn in arrToolView)
        {
                btn.Checked = false;
                //btn.CheckState = CheckState.Unchecked;
        }
        target.Checked = true;
        target.CheckState = CheckState.Checked;

    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-08-21T12:52:27.363

这个怎么样？

假设您引用了 System.Windows.Forms。

```
var cbtnToggler = new CheckBox();
cbtnToggler.Appearance = Appearance.Button;
cbtnToggler.TextAlign = ContentAlignment.MiddleCenter;
cbtnToggler.MinimumSize = new Size(75, 25); //To prevent shrinkage! 
```

希望这可以帮助 ;）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-07-22T18:13:21.167

这是我的简单代码，希望对您有所帮助

```
private void button2_Click(object sender, EventArgs e)
    {
        if (button2.Text == "ON")
        {
            panel_light.BackColor = Color.Yellow; //symbolizes light turned on

            button2.Text = "OFF";
        }

        else if (button2.Text == "OFF")
        {
            panel_light.BackColor = Color.Black; //symbolizes light turned off

            button2.Text = "ON";
        }
    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-11T21:14:01.243

如果您不介意将 ToolStripButton 控件托管在 ToolStripContainer 中，您也可以考虑使用它。我认为它可以原生支持按下和未按下状态。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-05-02T15:44:37.723

当我的按钮的 FlatStyle 设置为 system 时，它看起来是扁平的。当它设置为弹出时，它只会在鼠标悬停时弹出。要么是我想要的。我希望它在选中时看起来是凹陷的，在未选中时看起来是凸起的，并且在鼠标悬停时没有变化（按钮实际上是一个复选框，但复选框的外观属性设置为按钮）。

我最终将 FlatStyle 设置为 flat 并编写了一个新的 Paint 事件处理程序。

```
 private void checkbox_paint(object sender, PaintEventArgs e)
        {
            CheckBox myCheckbox = (CheckBox)sender;
            Rectangle borderRectangle = myCheckbox.ClientRectangle;
            if (myCheckbox.Checked)
            {
                ControlPaint.DrawBorder3D(e.Graphics, borderRectangle,
                    Border3DStyle.Sunken);
            }
            else
            {
                ControlPaint.DrawBorder3D(e.Graphics, borderRectangle,
                    Border3DStyle.Raised);
            }
        } 
```

我对这个问题给出了类似的答案： [C# winforms button with solid border, like 3d](https://stackoverflow.com/questions/37484556/c-sharp-winforms-button-with-solid-border-like-3d) sorry for double 张贴。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-11T21:02:24.993

您始终可以使用自定义图形和 PictureBox 编写自己的按钮，尽管它不一定与用户的 Windows 主题相匹配。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T13:36:34.050

我最终覆盖了 OnPaint 和 OnBackgroundPaint 事件并完全按照我的需要手动绘制按钮。它工作得很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-01T07:47:46.083

使用 if 命令检查状态并让其作为切换按钮操作

```
private void Protection_ON_OFF_Button_Click(object sender, EventArgs e)
        {

            if (FolderAddButton.Enabled == true)
            {
                FolderAddButton.Enabled = false;
            }
            else
            {
                FolderAddButton.Enabled = true;
            }
        } 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2013-12-26T14:37:30.603

将 CheckBox 外观更改为 Button 会使您难以调整。您无法更改其尺寸，因为它的大小取决于您的文本或图像的大小。

你可以试试这个：（首先将*count*变量初始化为 1 | int count = 1）

```
private void settingsBtn_Click(object sender, EventArgs e)
    {
        count++;

        if (count % 2 == 0)
        {
            settingsPanel.Show();
        }
        else
        {
            settingsPanel.Hide();
        }
    } 
```

这很简单，但很有效。

**警告：**这适用于偶尔使用的按钮（即设置），如果使用超过其容量而不关闭应用程序的进程， *int/long中的计数值可能会过载。*（检查数据类型范围：http: [//msdn.microsoft.com/en-us/library/s3f49ktz.aspx](http://msdn.microsoft.com/en-us/library/s3f49ktz.aspx)）

**好消息：**如果您运行的应用程序不适合全年 24/7 使用，我认为这很有帮助。重要的是，当应用程序的进程结束并再次运行时，*计数*将重置为 1。

# ruby-on-rails - 带有 has_many 的 rails map.resources :through 不起作用？

> ID：282127
> 
> 赞同：3
> 
> 时间：2008-11-11T21:02:26.383
> 
> 标签：ruby-on-rails, resources, map, has-many

我有三个（相关的）模型，指定如下：

```
class User < ActiveRecord::Base
  has_many :posts
  has_many :comments
  has_many :comments_received, :through => :posts, :source => :comments
end

class Post < ActiveRecord::Base
  belongs_to :user
  has_many :comments
end

class Comment < ActiveRecord::Base
  belongs_to :user
  belongs_to :post
end 
```

我希望能够通过路线引用所有的`comments_received`a `user`- 假设它是为了批量批准所有帖子的评论。*（请注意，您也可以`comments`通过 获得`user`，但用户无法对自己的帖子发表评论，因此`comments`通过 a`post`是不同且互斥的）*。从逻辑上讲，这应该适用于：

```
map.resources :users, :has_many => [:posts, :comments, :comments_received] 
```

这应该给我路线

```
user_posts_path
user_comments_path
user_comments_received_path 
```

前两个有效，最后一个无效。我已经尝试过，但`_`无济于事`comments_received`。我正在寻找一个像

```
http://some_domain.com/users/123/comments_received 
```

我也尝试过嵌套它，但也许我做错了。在这种情况下，我认为地图将是：

```
map.resources :users do |user|
  user.resources :comments
  user.resources :posts, :has_many => :comments
end 
```

然后网址可能是：

```
http://some_domain.com/users/123/posts/comments 
```

也许这是正确的方法，但我的语法错误？

我在想这个错误的方式吗？对我来说，我应该能够获得所有`comments`添加到所有用户帖子的页面，这似乎是合理的。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T08:39:55.707

尽管 deinfe 资源和模型关系的语法相似，但您不应该误以为资源映射到模型。阅读[大卫布莱克所说的话](http://dablog.rubypal.com/2008/3/23/splitting-hairs-over-resource)。

您遇到的问题是您正在生成的路线。像这样使用嵌套语法：

```
map.resources :users do |user|
  user.resources :posts
  user.resources :comments
  user.resources :comments_received
end 
```

然后运行`'rake routes'`，给了我（在很多其他的东西中！）：

```
 users GET /users                              {:action=>"index", :controller=>"users"}
                  user_posts GET /users/:user_id/posts               {:action=>"index", :controller=>"posts"}
               user_comments GET /users/:user_id/comments            {:action=>"index", :controller=>"comments"}
user_comments_received_index GET /users/:user_id/comments_received   {:action=>"index", :controller=>"comments_received"} 
```

因此，rails 似乎将 _index 添加到 comments_received 路由的末尾。我承认我不知道为什么（与其他评论路线发生冲突有关？）但它解释了你的问题。

一个更好的选择可能是在您的评论资源上定义一个收集操作，如下所示：

```
map.resources :users do |user|
  user.resources :posts
  user.resources :comments, :collection => {:received => :get}
end 
```

这将为您提供以下路线：

```
 users GET /users                             {:action=>"index", :controller=>"users"}
            user_posts GET /users/:user_id/posts              {:action=>"index", :controller=>"posts"}
         user_comments GET /users/:user_id/comments           {:action=>"index", :controller=>"comments"} 
received_user_comments GET /users/:user_id/comments/received  {:action=>"received", :controller=>"comments"} 
```

注意：收到的动作现在在评论控制器上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T23:03:46.403

我必须承认，我对变量名有点困惑，但首先，我很惊讶你的 has_many :through 完全按照它定义的方式工作。模型的行为是否符合您的预期，将路线搁置一秒钟？

其次，这是变量名真正发挥作用的地方，路由对复数有一些依赖性，因此您的 foos bar 和 bazs 可能是问题的原因，或者可能隐藏了问题。无论如何，你绝对可以这样写：

```
map.resources :users do |user|
  user.resources :awards
  user.resources :contest_entries do |contest_entry|
    contest_entry.resources :awards
  end
end 
```

我相信会给你：

```
user_path, user_awards_path, user_contest_entry_path, and user_contest_entry_awards_path. 
```

我不确定这是否真的回答了您的问题，如果您将 foo、bar 和 baz 更改为更接近真实情况的内容，这可能有助于更清楚地了解这里发生的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T23:36:20.507

Quick-n-dirty 解决方案是向您的用户控制器添加一个自定义方法（例如 getusercomments），该方法将返回所有评论：

```
def getusercomments
@user = User.find(params[:id])
@comments = @user.posts.comments
end 
```

然后将此方法添加到您的用户路由：

```
map.resources :users, :member => { :getusercomments => :get } 
```

之后，您应该能够调用以下命令来获取用户的所有评论：

```
http://some_domain.com/users/123/getusercomments 
```

# javascript - Visual Studio 中用于 Ajax 和 JavaScript 库的 IntelliSense

> ID：282129
> 
> 赞同：8
> 
> 时间：2008-11-11T21:03:17.223
> 
> 标签：javascript, visual-studio

我知道为[IntelliSense](http://en.wikipedia.org/wiki/IntelliSense)使用 -vsdoc.js 文件，而用于 jQuery 的文件很容易找到。还有哪些其他 JavaScript、Ajax 和 DHTML 库有它们，我在哪里可以找到这些文件？另外，是否有文档概述了 -vsdoc.js 文件的规范？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-22T22:56:19.760

一篇来自 Betrand LeRoy 的关于 JavaScript 的 IntelliSense 格式的优秀博客文章： *[JavaScript 文档注释的格式](http://weblogs.asp.net/bleroy/archive/2007/04/23/the-format-for-javascript-doc-comments.aspx)*。

简而言之：

摘要 - 用于描述函数/方法或事件。句法：

```
<summary locid="descriptionID">Description</summary> 
```

参数 - 描述函数/方法的参数。句法：

```
<param name="parameterName"
    mayBeNull="true|false" optional="true|false"
    type="ParameterType" parameterArray="true|false"
    integer="true|false" domElement="true|false"
    elementType="ArrayElementType" elementInteger="true|false"
    elementDomElement="true|false"
    elementMayBeNull="true|false">Description</param> 
```

param 标签用于描述方法或构造函数的参数。param 标签应该与方法或构造函数的参数的顺序相同，并且具有相同的名称。

函数返回类型 - 语法：

```
<returns
    type="ValueType" integer="true|false" domElement="true|false"
    mayBeNull="true|false" elementType="ArrayElementType"
    elementInteger="true|false" elementDomElement="true|false"
    elementMayBeNull="true|false">Description</returns> 
```

值类型 - 描述一个属性（不应该使用 'summary' 作为属性） - 语法：

```
<value
    type="ValueType" integer="true|false" domElement="true|false"
    mayBeNull="true|false" elementType="ArrayElementType"
    elementInteger="true|false" elementDomElement="true|false"
    elementMayBeNull="true|false"
    locid="descriptionID">Description</value> 
```

Field - 用于描述 JavaScript 类中的字段 - 语法：

```
<field name="fieldName" type="FieldType"
    integer="true|false" domElement="true|false" mayBeNull="true|false"
    elementType="ArrayElementType" elementInteger="true|false"
    elementDomElement="true|false" elementMayBeNull="true|false"
    locid="descriptionID">Description</field> 
```

如何为外部 JavaScript 文件包含 IntelliSense，以下语法作为 JavaScript 文件中的第一行：

```
<reference path="path/to/the/script/reference.js"
    assembly="Assembly.Name" name="ScriptResourceName.js"/> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-01T06:28:44.407

我写了一篇文章来总结（通过调查）vsdoc 的哪些部分用于帮助 VS 2010 中的 Intellisense：[http ://www.scottlogic.co.uk/2010/08/vs-2010-vs-doc-and- javascript智能感知/](http://www.scottlogic.co.uk/2010/08/vs-2010-vs-doc-and-javascript-intellisense/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T14:21:18.043

您可以在此处找到 MooTools 的 Intellisense：[http ://code.google.com/p/mootoolsintellisense/downloads/list](http://code.google.com/p/mootoolsintellisense/downloads/list)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-26T19:27:57.340

有人为 Google Maps V3 构建了一个非常好的[**vsdoc**](http://gmapvsdoc.codeplex.com/)。我用它，效果很好。;-)

# java - 寻找用于创建基于 SOAP 的 Web 服务的轻量级 Java 堆栈

> ID：282132
> 
> 赞同：2
> 
> 时间：2008-11-11T21:04:31.650
> 
> 标签：java, web-services, soap

我可能会使用 Tomcat 和 Apache Axis webapp 插件，但我对任何其他潜在的轻量级解决方案感到好奇。

这样做的主要目标是连接到 MySQL 数据库以进行一些演示。

谢谢，托德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T00:35:18.497

[Jetty](http://www.mortbay.org/jetty/)是一个轻量级的 servlet 容器，您可能想研究一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T00:36:02.457

定义轻量级？（如今这到底意味着什么？？）

使用 JAX-WS/Metro，您只需对 web.xml 进行样板更改，然后使用 @WebService 和即时 Web 服务注释 POJO。

该发行版中有几个罐子（我认为大约有十几个，但它们都在安装中——你不必为它们爬网），但是实现是一流的，而且“简单“东西很简单。

编辑：JAX-WS 可以很容易地部署在 Tomcat 和 Jetty 中，并且在 Glassfish 和 Glassfish V3 Prelude 中“免费”提供。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T00:11:23.147

我同意麦德斯的观点。如果您要运行演示，那么您真的应该考虑将 Jetty 和 Maven 添加到您的堆栈中。我在Tomcat下运行我的生产，但是......

```
mvn jetty:run 
```

...非常方便。查看[Maven Jetty 插件配置指南](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T00:29:30.223

Tomcat 是一个不错的选择。正如您所提到的，它的重量很轻，并且得到很好的支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T21:07:41.503

查看[XFire](http://xfire.codehaus.org/)，它显然已演变为[CXF](http://cxf.apache.org/)。

他们有一个[用户指南](http://cwiki.apache.org/CXF20DOC/index.html)来帮助你入门。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-13T14:22:52.220

Thanks for the suggestions. I'm looking at the Glassfish/Metro solution, in addition, talking to a couple guys around here suggested looking at GRAILS which supports XFire via plugins.

Updated: My actual solution seems pretty slick. I'm using Grails, with the Metro plugin. In about 5 minutes, I was able to get up and running with a demo WebService. Also, Grails in development uses Jetty. So thanks for all the suggestions again, and it seems I was able to incorporate all of them. Looking forward to digging into this Grails, JAX-WS (Metro), etc..

# command-line - 简单的 DOS 命令行，用于忽略最后一个反斜杠后一行上的数据

> ID：282139
> 
> 赞同：1
> 
> 时间：2008-11-11T21:06:42.253
> 
> 标签：command-line, dos

我正在创建一个批处理文件以从文本文件中的列表创建多个目录，但是在列出目录之后，有时文件名也是如此。有没有一种简单的方法让它忽略一行最后一个 \ 之后的所有数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T21:43:32.413

你可以使用这样的东西：

```
@echo off
set filename="c:\temp\my files\file.txt"
for /f "tokens=*" %i in ("%filename%") do set filename="%~dpi"
echo %filename% 
```

结果将是`"c:\temp\my files\"`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T21:29:10.353

我可能会建议 DOS 批处理不是这项工作的正确工具，因为它没有像这样需要的用于字符串操作的内置工具。

如果你有 Perl 可用，你可以这样做：

```
#!/usr/bin/perl -w

while (<>) {
    s/\\[^\\]*$//; # this removes a the last backslash and anything after it
    mkdir $_;
} 
```

# .net - 为非 VB6 的人挑选一个 VB6 项目

> ID：282146
> 
> 赞同：5
> 
> 时间：2008-11-11T21:08:05.777
> 
> 标签：.net, sql-server, vb6

我被赋予了修改 VB6 项目的任务。没有什么特别严重的，添加了几个表单并在大多数情况下修复了一些错误。该项目使用 SQL Server（如果有任何相关性）。

我的编程背景是 VB/C# .NET、PHP、C++ 和主要是 MySQL，尽管我使用的 SQL Server 规模要小得多。任何人都可以给我什么样的建议或 VB6 编程的资源。自从我完成任何 VB .NET 工作以来已经有几年了，虽然我可以阅读 VB6 代码并了解发生了什么，但我不确定我将能够多好地开始写作和/或修改没有破坏任何东西的机会。

其他人可以提供什么样的建议？任何资源和/或故事都会很棒。随意贡献你可能觉得相关但我没有提及的东西。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-11T21:29:03.630

它可能已经存在，但请确保**Option Explicit**位于所有文件的顶部。它强制变量声明并减少拼写错误无意中动态创建变量的机会。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-11T21:33:48.893

VB6 有一个损坏的类型系统——事实上它有两个不完全兼容的类型系统。在架构上，VB4-6 是对 COM 的一个相当薄的包装器，并使用 COM 的类型系统。VB 以前的版本有自己的类型系统，有点像传统的 BASIC 和 C 的交叉。两者不能自由混合和匹配。

没有继承，也没有真正的异常处理，所以期望编写大量的样板代码用于错误处理和反复重复的基本表单功能。这就是 VB 在剪切和粘贴软件工程方面享有盛誉的地方。

您可以在 VB 中声明的某些类型不是“自动化兼容的”，这意味着它们不能在 COM 边界上进行序列化或存储在 Variant 中（稍后会详细介绍）。这些类型可以追溯到 VB 不支持 COM 的前 VB4-6 天。其中一种类型是记录（如 ac 结构）类型，它的名称让我无法理解，因此不可能实现可扩展的集合或结构的关联数组（这是人们可能想要做的自然事情）。定义一个类（见下文）是可能的，但有点笨拙。

VB 不支持多线程，对此的解决方法有很多陷阱。如果您正在使用 MTS 或 COM+ 进行 3 层开发，那么其中的第一个可能会咬到您。创建 VB 模块实际上在幕后创建了一个单例 COM 对象。这将存在于它自己的单线程单元中。公寓本质上是轻量级的运行 COM 服务器，具有序列化/反序列化机制（称为消息泵），其中调用被序列化并排队等待单个线程。如果你做了（表面上）明智的事情并尝试模块化你的代码，你将在你的中间层创建热点。解决方案：更多的剪切和粘贴。

第二个主要问题是 COM 的垃圾收集相当基本 - 一个简单的引用计数机制。这意味着 COM 组件崩溃或由于某种原因在自身泄漏内存后不进行整理。还记得 VB6 只是 COM 上的一个薄层吗？这种紧密耦合意味着在使用包含对控件的引用的 UI 管理代码、外部应用程序（例如 Excel）上的 OLE 自动化或设置引用的任何其他内容时，您必须非常小心。VB 非常擅长在背后做一些隐藏的事情，并且不知道什么时候该清理自己。它也是幕后生成的循环引用的来源。弄错了，它会泄漏资源 - 你需要小心这一点。

另一个主要问题是变体。我见过的对 Variant 类型的最佳描述是“电子表格单元格”。这些可能会引起很多恶作剧，尤其是变体数组。许多 API 仅适用于变体或具有使用变体的随机部分（Excel 经常这样做），因此您并不总是能够避免它们。如果您在 COM 边界上对内容进行序列化（例如多个断开连接的 Recordsets），您很快就会学会厌恶 Variant Arrays。

您可能会发现 VB 的类型系统如此糟糕，以至于维护一个非常复杂的数据结构的最简单方法是创建一个库，将其编码为字符串并基本上对其进行序列化和反序列化。VB6 应用程序中的复杂数据结构几乎是不可能的。

最后，在使用了 VB6 的 GUI 工具包之后，您将了解做 WinForms 的团队从 VB6 团队的错误中吸取了多少教训。

尽管它被宣传为简单易用，但由于所有的架构缺陷和小问题，在 VB 中构建一个非平凡的应用程序而不造成混乱比看起来要困难得多。[这是 Spolsky泄漏抽象定律的](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)一个很好的例子。.

Appleman[在 Visual BASIC 6](https://rads.stackoverflow.com/amzn/click/com/1562765760)中开发 COM/ActiveX 组件对 COM 与 VB6 交互的来龙去脉进行了很好的处理。[他在Win32 和 VB 编程](https://rads.stackoverflow.com/amzn/click/com/0672315904)方面也做得很好。.

PS（感谢 Daok 提醒我），如果你发现有人一直在使用`On Error Resume Next`，你有我的权限可以用[头撞](http://en.wikipedia.org/wiki/Head_butt)他们。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-12T00:02:47.860

由于我在 Visual Basic 上咬牙切齿（简历上写着 VB3-6 10 年以上），我会尝试用“On Error Resume Next”以外的其他内容来回答你的问题（确实如此，但你会发现它）到处都是，否则你不会，这更糟）。您可以执行以下操作：

1.  当你接管一个 VB 项目时，最困难的事情通常就是让它在你的机器上编译。这通常是由于对安装在原始开发人员机器上但未安装在您的机器上的东西的引用损坏（又名“DLL Hell”）。您只能希望安装程序仍然存在于某个地方，或者如果不存在，您可以随时将 DLL 和 OCX 放到系统目录中（记得注册它们）。有时，DLL 地狱来自损坏的内部引用。VB 开发人员通常喜欢将应用程序划分为尽可能多的不同组件项目。通常，当您将所有内容组合到一个该死的项目中时，您的许多或所有兼容性问题通常都会消失，它本来应该放在首位。
2.  一旦一切都编译好了，你就在那里 99%。此处帖子中提到的大多数常见问题都是立即在应用程序中表现出来的问题。如果您继承的应用程序是一个简单、可靠的应用程序，并且这些年来一直在悄悄地嗡嗡作响（它发生在 VB 中），那么您可能会没事的。
3.  一旦您在 IDE 中编译并运行了应用程序（我认为这就是它当时的名称），您就可以开始在这里和那里尝试一些小的更改。
4.  **在此处发布您的问题**。回忆过去很有趣。

关于一般的 Visual Basic，我想说不要相信反炒作。它是一种允许好代码或坏代码的语言，就像任何其他语言一样。请记住，所有糟糕的 VB 程序员现在都是糟糕的 C# 程序员。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-11T21:11:41.980

请不要使用“ **On error resume next** ”。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-12T13:32:25.680

如果您的应用程序使用 ActiveX DLL 项目，那么您确保这是最小化 DLL Hell 的情况

*   将您的 DLL 设置为 BinaryCompatibility。
*   确保您有一个兼容目录。
*   将最后一个版本的 DLL 放在那里。
*   将二进制兼容性指向该 DLL。
*   确保您的 EXE 和 DLL 编译到它的项目目录。
*   测试时从其项目目录运行 EXE。这样它将使用您编译的 DLL。
*   您需要编写一个实用程序，以便您可以以正确的顺序分别编译每个项目。VB6 编译器可以从命令行运行。
*   使用 Virtual PC 或另一台计算机测试您的设置。

尽管缺少继承，您会发现 VB6 能够实现许多常见的面向对象设计模式。如果您查看设计模式，可重用面向对象软件的元素，您会发现大多数模式都涉及实现接口而不是继承行为。他们从第 16 页开始讨论这个问题。

强类型的集合不是直接实现的，你用包括只读 Item 属性在内的所有内容编写集合。完成后，您需要点击 {F2} 并打开对象浏览器。找到您创建的集合类并右键单击项目。

您将需要

*   选择属性
*   单击高级按钮
*   将过程 ID 更改为默认值

然后 Item 将成为默认属性，Strongly 类型集合将按预期运行。

要在集合类上启用 For Each，您需要添加此

```
Public Property Get NewEnum() As IUnknown
    Set NewEnum = mCol.[_NewEnum]
End Property 
```

mCol 是私有 Collection 变量的名称

再次使用对象浏览器并右键单击 NewEnum。

您将需要

*   选择属性
*   单击高级按钮
*   将过程 ID 更改为 -4

请记住，Integer 是 16 位，Long 是 32 位。我建议将大多数整数变量声明为 Long。过去它对速度和内存占用很重要，但对于今天的计算机，最好只使用 Long 而不必担心超出限制。

像其他地方建议的那样使用 Option Explicit。

Visual BASIC 6 非常擅长隐式类型转换。如果你想确定的话，你有 Cxxx 系列的转换函数。

Variant 在处理包括类在内的各种对象类型方面比 .NET 的对象要好。如果您需要制作处理数据库的自定义表单并且用户可以选择用于该表单的表，您可能会发现它很有用。使用 Variant 可以更轻松地处理不同表的字段类型不同的事实。

Visual Basic 6 可用于制作多层应用程序。表单可以像类一样实现接口。

请记住，ActiveX 控件在您编译和编辑表单时运行。如果您不知道，这可能会导致各种奇怪。如果您有自己的 ActiveX 控件，这尤其成问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-11T21:48:50.017

而不是使用`on error resume next`than `on error goto X`，但总是立即捕获错误，然后重置错误处理。

例子：

```
...
On Error Resume Next
oDbConn.Open sDbConnString
Select Case Err.Number
  Case &H80004005
    MsgBox "Cannot connect to SQL-server, check your settings."
    frmSettings.Show
    Exit Sub
  Case Else
    ShowErrorAndQuit Err
End Select
On Error Goto 0
... 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-12T14:40:32.860

声明对象时的一般智慧是避免使用“Dim myObj As New MyClass”。而是使用“Dim myObj As MyClass”并在需要时使用“Set myObj = New MyClass”显式实例化对象。前一种方法在遇到“Dim”时不会实例化对象，但会在第一次引用对象的属性或方法时自动执行。这需要运行时执行一些额外的开销，因为它必须在每个属性/方法引用之前检查对象是否存在。此外，该对象声明方法还有一些其他古怪的副作用。例如，如果 myObj 设置为 Nothing，并且程序遇到另一个对它的引用，则会自动创建一个新实例。如果发生这种情况，很有可能，您的程序有问题，但不会产生错误，告诉您您的对象不存在，这可能导致一些难以追踪的错误。通常，最好使用“Set = New”语法自己显式创建和销毁对象实例。“Dim As New”语法的支持者通常引用更好的可读性，但它的潜在陷阱有时会抓住你。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-11T22:14:17.423

在这里发帖并说“On Error Resume Next”是有史以来最糟糕的语言功能的人大错特错。

有史以来最糟糕的语言功能是“ **On Error Resume** ”。相信我这个。

对于 VB 受损的人来说，On Error Resume Next 的意思是“出了点问题，继续下一行”。On Error Resume 的意思是“出了点问题，最好一次又一次地尝试，然后……”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-11T22:16:47.073

就个人而言，我喜欢`On Error goto ErrorHandler`在每个函数的底部都有一个错误处理程序。

记住在调用方法时不要包含括号，除非你要查看它的返回值。在单参数方法上很容易摆脱这一点，但有时它会咬你，因为传递（变量）**与**传递变量不同。

编写 VB 的人不太确定他们更喜欢 0 索引数组还是 1 索引数组。您可以使用`UBound`/`LBound`检查数组的开始和结束位置。

不要使用“textcomparison”来转换大小写。将字符串与文本进行比较不仅仅是忽略大小写。只需将一个或两个字符串转换为大写即可。

如果您在运行时调用它们，则必须关闭项目-> 属性-> 删除有关未使用的 ActiveX 控件的信息。

工具->编辑器->自动语法检查。如果你不习惯它，也许把它关掉。

工具->编辑器->需要变量声明。上。

工具->环境->程序启动时->保存更改。如果关闭，即使您运行它也不会保存您的程序。

使用 Run->Start With Full Compile，而不是 Run->Start，来运行你的代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-11T22:28:17.583

除非确实必要，否则不要使用`On Error Resume Next`（有一些特殊情况，例如错误处理后的最终清理或 VB Collection 元素存在检查，但通常在函数体内不需要它）。

实施正确的错误处理，不要使用多个出口点，不要使用 If-Then 单行，使用 Case Else 块，不要使用 Subs - 类似下一个非常简单的函数骨架：

```
Private Function MyFunc() As Boolean
    On Error Goto ErrHandler

    ''some code here
    If SomeBadExitConditionIsSet Then
        GoTo FuncExit
    End If

    ''some more code here
    MyFunc = True

FuncExit:
    ''kill error handling to avoid error cycling
    On Error Resume Next
    ''cleanup code here - you need to check Err.Number after critical operations!
    ''single exit point
    Exit Function

ErrHandler:
    ''you can insert local specific error processing here, do not forget save Err.Number etc
    ''there is possibility to raise errors to caller function, 
    ''but in this function we do not do that
    Select Case MyGlobalErrHandler(Err.Number, Err.Description)
        Case eRetry
            Resume    ''this is useful while debugging - good place to "Set Next Statement"
        Case eIgnore
            Resume Next
        Case eCancel
            Resume FuncExit
        Case Else
            Resume FuncExit
    Select End
End Function 
```

# php - 如何在 PHP 中编写单元测试？

> ID：282150
> 
> 赞同：101
> 
> 时间：2008-11-11T21:09:23.683
> 
> 标签：php, unit-testing, testing, tdd

我到处读到它们有多棒，但由于某种原因，我似乎无法弄清楚我应该如何测试某些东西。有人可以发布一段示例代码以及他们将如何测试它吗？如果不是太麻烦:)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-12T01:22:21.163

还有第三个“框架”，它更容易学习——甚至比*简单*测试更容易，它被称为 phpt。

可以在这里找到入门：http: [//qa.php.net/write-test.php](http://qa.php.net/write-test.php)

**编辑：**刚刚看到您对示例代码的请求。

假设您在名为*lib.php*的文件中有以下函数：

```
<?php
function foo($bar)
{
  return $bar;
}
?> 
```

非常简单直接，您传入的参数被返回。所以让我们看一下这个函数的测试，我们将调用测试文件*foo.phpt*：

```
--TEST--
foo() function - A basic test to see if it works. :)
--FILE--
<?php
include 'lib.php'; // might need to adjust path if not in the same dir
$bar = 'Hello World';
var_dump(foo($bar));
?>
--EXPECT--
string(11) "Hello World" 
```

简而言之，我们为参数`$bar`提供值`"Hello World"`以及`var_dump()`函数调用的响应`foo()`。

要运行此测试，请使用：`pear run-test path/to/foo.phpt`

这需要在您的系统上[安装 PEAR](http://pear.php.net/manual/en/installation.php)，这在大多数情况下很常见。如果您需要安装它，我建议安装可用的最新版本。如果您需要帮助来设置它，请随时询问（但提供操作系统等）。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-11-11T21:12:36.080

有两个框架可用于单元测试。[Simpletest](//web.archive.org/web/20180916202612/http://simpletest.org/)和[PHPUnit](http://www.phpunit.de/)，我更喜欢。在 PHPUnit 的主页上阅读有关如何编写和运行测试的教程。这很容易并且描述得很好。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-15T06:59:22.020

你可以通过改变你的编码风格来适应它，从而使单元测试更有效。

我建议浏览[Google 测试博客](http://googletesting.blogspot.com/)，尤其是关于[编写可测试代码](http://googletesting.blogspot.com/2008/08/by-miko-hevery-so-you-decided-to.html)的帖子。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-15T08:17:49.817

我自己动手了，因为我没有时间学习别人的做事方式，这花了大约 20 分钟来写，10 分钟来适应它以张贴在这里。

单元测试对我**非常**有用。

这有点长，但它解释了自己，底部有一个例子。

```
/**
 * Provides Assertions
 **/
class Assert
{
    public static function AreEqual( $a, $b )
    {
        if ( $a != $b )
        {
            throw new Exception( 'Subjects are not equal.' );
        }
    }
}

/**
 * Provides a loggable entity with information on a test and how it executed
 **/
class TestResult
{
    protected $_testableInstance = null;

    protected $_isSuccess = false;
    public function getSuccess()
    {
        return $this->_isSuccess;
    }

    protected $_output = '';
    public function getOutput()
    {
        return $_output;
    }
    public function setOutput( $value )
    {
        $_output = $value;
    }

    protected $_test = null;
    public function getTest()
    {
        return $this->_test;
    }

    public function getName()
    {
        return $this->_test->getName();
    }
    public function getComment()
    {
        return $this->ParseComment( $this->_test->getDocComment() );
    }

    private function ParseComment( $comment )
    {
        $lines = explode( "\n", $comment );
        for( $i = 0; $i < count( $lines ); $i ++ )
        {
            $lines[$i] = trim( $lines[ $i ] );
        }
        return implode( "\n", $lines );
    }

    protected $_exception = null;
    public function getException()
    {
        return $this->_exception;
    }

    static public function CreateFailure( Testable $object, ReflectionMethod $test, Exception $exception )
    {
        $result = new self();
        $result->_isSuccess = false;
        $result->testableInstance = $object;
        $result->_test = $test;
        $result->_exception = $exception;

        return $result;
    }
    static public function CreateSuccess( Testable $object, ReflectionMethod $test )
    {
        $result = new self();
        $result->_isSuccess = true;
        $result->testableInstance = $object;
        $result->_test = $test;

        return $result;
    }
}

/**
 * Provides a base class to derive tests from
 **/
abstract class Testable
{
    protected $test_log = array();

    /**
     * Logs the result of a test. keeps track of results for later inspection, Overridable to log elsewhere.
     **/
    protected function Log( TestResult $result )
    {
        $this->test_log[] = $result;

        printf( "Test: %s was a %s %s\n"
            ,$result->getName()
            ,$result->getSuccess() ? 'success' : 'failure'
            ,$result->getSuccess() ? '' : sprintf( "\n%s (lines:%d-%d; file:%s)"
                ,$result->getComment()
                ,$result->getTest()->getStartLine()
                ,$result->getTest()->getEndLine()
                ,$result->getTest()->getFileName()
                )
            );

    }
    final public function RunTests()
    {
        $class = new ReflectionClass( $this );
        foreach( $class->GetMethods() as $method )
        {
            $methodname = $method->getName();
            if ( strlen( $methodname ) > 4 && substr( $methodname, 0, 4 ) == 'Test' )
            {
                ob_start();
                try
                {
                    $this->$methodname();
                    $result = TestResult::CreateSuccess( $this, $method );
                }
                catch( Exception $ex )
                {
                    $result = TestResult::CreateFailure( $this, $method, $ex );
                }
                $output = ob_get_clean();
                $result->setOutput( $output );
                $this->Log( $result );
            }
        }
    }
}

/**
 * a simple Test suite with two tests
 **/
class MyTest extends Testable
{
    /**
     * This test is designed to fail
     **/
    public function TestOne()
    {
        Assert::AreEqual( 1, 2 );
    }

    /**
     * This test is designed to succeed
     **/
    public function TestTwo()
    {
        Assert::AreEqual( 1, 1 );
    }
}

// this is how to use it.
$test = new MyTest();
$test->RunTests(); 
```

这输出：

```
测试：TestOne 失败
/**
* 此测试旨在失败
**/（行：149-152；文件：/Users/kris/Desktop/Testable.php）
测试：TestTwo 成功
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-02T18:15:45.393

获取 PHPUnit。这是非常容易使用。

然后从非常简单的断言开始。在你开始做其他事情之前，你可以用 AssertEquals 做很多事情。这是让你的脚湿透的好方法。

您可能还想先尝试编写测试（因为您给问题提供了 TDD 标签），然后再编写代码。如果你之前没有这样做过，那你会大开眼界。

```
require_once 'ClassYouWantToTest';
require_once 'PHPUnit...blah,blah,whatever';

class ClassYouWantToTest extends PHPUnit...blah,blah,whatever
{
    private $ClassYouWantToTest;

   protected function setUp ()
    {
        parent::setUp();
        $this->ClassYouWantToTest = new ClassYouWantToTest(/* parameters */);
    }

    protected function tearDown ()
    {
        $this->ClassYouWantToTest = null;
        parent::tearDown();
    }

    public function __construct ()
    {   
        // not really needed
    }

    /**
     * Tests ClassYouWantToTest->methodFoo()
     */
    public function testMethodFoo ()
    {
        $this->assertEquals(
            $this->ClassYouWantToTest->methodFoo('putValueOfParamHere), 'expectedOutputHere);

    /**
     * Tests ClassYouWantToTest->methodBar()
     */
    public function testMethodFoo ()
    {
        $this->assertEquals(
            $this->ClassYouWantToTest->methodBar('putValueOfParamHere), 'expectedOutputHere);
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-23T01:28:53.500

对于简单的测试和文档，[php-doctest](http://pear.php.net/package/Testing_DocTest)非常好，而且它是一种非常简单的入门方法，因为您不必打开单独的文件。想象一下下面的函数：

```
/**
* Sums 2 numbers
* <code>
* //doctest: add
* echo add(5,2);
* //expects:
* 7
* </code>
*/
function add($a,$b){
    return $a + $b;   
} 
```

如果您现在通过 phpdt（php-doctest 的命令行运行程序）运行此文件，将运行 1 个测试。doctest 包含在 <code> 块内。Doctest 起源于 python，非常适合提供有用且可运行的示例来说明代码应该如何工作。您不能只使用它，因为代码本身会充斥着测试用例，但我发现它与更正式的 tdd 库一起很有用——我使用 phpunit。

[这里](https://stackoverflow.com/questions/361675/python-doctest-vs-unittest)的第一个答案很好地总结了它（它不是 unit vs doctest ）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-16T22:30:27.000

phpunit 几乎是 php 的事实上的单元测试框架。还有[DocTest](http://pear.php.net/package/Testing_DocTest)（作为 PEAR 包提供）和其他一些。php 本身通过[phpt 测试](http://qa.php.net/write-test.php)进行回归等测试，也可以通过 pear 运行。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-25T22:09:36.660

Codeception tests are much like common unit tests but are much powerful in things where you need mocking and stubbing.

Here is the sample controller test. Notice how easily stubs are created. How easily you check the method was invoked.

```
<?php
use Codeception\Util\Stub as Stub;

const VALID_USER_ID = 1;
const INVALID_USER_ID = 0;

class UserControllerCest {
public $class = 'UserController';

public function show(CodeGuy $I) {
    // prepare environment
    $I->haveFakeClass($controller = Stub::makeEmptyExcept($this->class, 'show'));
    $I->haveFakeClass($db = Stub::make('DbConnector', array('find' => function($id) { return $id == VALID_USER_ID ? new User() : null ))); };
    $I->setProperty($controller, 'db', $db);

    $I->executeTestedMethodOn($controller, VALID_USER_ID)
        ->seeResultEquals(true)
        ->seeMethodInvoked($controller, 'render');

    $I->expect('it will render 404 page for non existent user')
        ->executeTestedMethodOn($controller, INVALID_USER_ID)
        ->seeResultNotEquals(true)
        ->seeMethodInvoked($controller, 'render404','User not found')
        ->seeMethodNotInvoked($controller, 'render');
}
} 
```

Also there are other cool things. You can test database state, filesystem, etc.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-23T20:34:39.173

除了已经给出的关于测试框架的优秀建议之外，您是否使用其中一种内置了自动化测试的 PHP Web 框架（例如[Symfony](http://www.symfony-project.org/book/1_0/15-Unit-and-Functional-Testing)或[CakePHP](http://book.cakephp.org/view/160/Testing) ）来构建您的应用程序？有时，有一个地方可以放入您的测试方法，这会减少一些人与自动化测试和 TDD 相关的启动摩擦。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-01T15:21:14.777

我知道这里已经有很多信息，但是由于这仍然出现在 Google 搜索中，我不妨将***Chinook 测试套件***添加到列表中。它是一个简单而小型的测试框架。

您可以使用它轻松测试您的类并创建模拟对象。您通过 Web 浏览器和***（尚未）***通过控制台运行测试。在浏览器中，您可以指定要运行的测试类甚至测试方法。或者您可以简单地运行所有测试。

来自github页面的截图：

![Chinook 单元测试框架](https://i.stack.imgur.com/GmSnw.png)

我喜欢它的是你断言测试的方式。这是通过所谓的“流利断言”完成的。例子：

```
$this->Assert($datetime)->Should()->BeAfter($someDatetime); 
```

创建模拟对象也很容易（使用流利的语法）：

```
$mock = new CFMock::Create(new DummyClass());
$mock->ACallTo('SomeMethod')->Returns('some value'); 
```

无论如何，可以在 github 页面上找到更多信息以及代码示例：

[https://github.com/w00/Chinook-TestSuite](https://github.com/w00/Chinook-TestSuite)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-10-04T06:49:10.843

在这里重新发布太多了，但这里有[一篇](http://quickshiftin.com/blog/2013/10/practical-phpt/)关于使用*phpt*的好文章。它涵盖了*phpt*的许多经常被忽视的方面，因此除了编写测试之外，扩展您的 php 知识可能值得一读。幸运的是，本文还讨论了编写测试！

主要讨论点

1.  发现 PHP 的少量文档是如何工作的（或几乎任何部分）
2.  为您自己的 PHP 代码编写简单的单元测试
3.  编写测试作为扩展的一部分或将潜在的错误传达给内部人员或 QA 组

# php - PHP __get 和私有类变量

> ID：282157
> 
> 赞同：9
> 
> 时间：2008-11-11T21:11:16.880
> 
> 标签：php, oop

假设一个有一个定义的抽象基类`foo`和一个继承自私有变量`__get()`的子类，当尝试从类外部 访问私有时会调用父类吗？`bar``foo``$var``__get()``$var`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-11T21:14:28.933

是的。

```
<?php
    abstract class foo
    {
        public function __get($var)
        {
            echo "Parent (Foo) __get() called for $var\n";
        }
    }

   class bar extends foo
   {
        private $var;
        public function __construct()
        {
            $this->var = "25\n";
        }

        public function getVar()
        {
            return $this->var;
        }
    }

    $obj = new bar();
    echo $obj->var;
    echo $obj->getVar();
?> 
```

输出：

$ php 测试.php

父 (Foo) __get() 调用 var

25

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T21:33:37.927

是的。 `__get()`和`__set()`（`__call()`就此而言）在访问当前执行不可见的数据成员时被调用。

在这种情况下，`$var`它是私有的，因此公开访问它会调用`__get()`钩子。

# apache - 直通 .png 到 8.png 如果 IE<=6 并且 8.png 存在

> ID：282161
> 
> 赞同：1
> 
> 时间：2008-11-11T21:12:26.813
> 
> 标签：apache, .htaccess, png

我刚刚发现通过 Photoshop 将 PNG32 转换为 PNG8 将修复 IE<=6 中的 PNG 透明度错误。

所以我有这样的想法，如果客户端使用 IE<=6，为什么不为所有浏览器提供 PNG32，为什么不提供 PNG8。

当谈到 htaccess/httpd 指令时，我并不是真正的专家，所以我在这里寻求帮助。

标题是伪代码本身。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-11T21:39:02.393

我实际上还没有尝试过，但我认为它应该可以工作：

```
RewriteEngine on
RewriteCond %{HTTP_USER_AGENT} ^Mozilla/4.0\ \(compatible;\ MSIE\ [1-6]\.
RewriteCond %{REQUEST_FILENAME} ^(.+)(\.png)$
RewriteCond %18%2 -f
RewriteRule ^(.+)\.png$ $18.png [L,QSA] 
```

第一行打开 mod_rewrite （如果你已经这样做了，可以省略）。第二个是 IE <= 6 过滤器。第三个主要是对第四行的文件名进行拆分，检查<filename>8.png是否存在。第五行实际上做了重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T21:18:38.550

把它放在你的 .htaccess 中

```
RewriteEngine on
RewriteRule ^/(.*)\.png$ /$18.png [L,QSA] 
```

应该管用。

# html - 如何在 HTML 中编写 CC（知识共享徽标）

> ID：282171
> 
> 赞同：13
> 
> 时间：2008-11-11T21:16:05.543
> 
> 标签：html, html-encode

我如何在 HTML 中编写 CC 徽标，是否有类似`&copy;`（给出©）的东西？

（CC 代表知识共享）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-03-07T04:44:54.077

*正如schnaader*指出的那样，有一个 TTF 字体，但是按照他的回答，它实际上可以为没有使用 CSS`@font-face`标签安装它的人正确呈现。

```
<!DOCTYPE html> 
<html> 
    <head> 
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
        <title>Test</title> 
        <style type="text/css">
            @media screen {
            @font-face {
            font-family: 'CC-ICONS';
            font-style: normal;
            font-weight: normal;
            src: url('http://mirrors.creativecommons.org/presskit/cc-icons.ttf') format('truetype');
            }

            span.cc {
            font-family: 'CC-ICONS';
            color: #ABB3AC;
            }
            }
        </style>
    </head> 
    <body> 
        <p>Key: a: SA, b: BY, c: CC Circle, d: ND, n: NC, m: Sampling, s: Share, r: Remix, C: CC Full Logo</p>
        <span class="cc">a b c d n m s r C</span>
        <p>This page is licensed under <span class="cc">C</span></p>
    </body> 
</html> 
```

[在 jsFiddle 中试试这个例子](http://jsfiddle.net/VUA2N/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-11T21:19:12.260

据我所知，这个没有字符，所以你必须使用图形。

[这里](http://creativecommons.org/about/downloads/)有一些不错的。顺便说一句，在这个页面上，还有一个您可以在 HTML 中使用的徽标字体，但是对于没有安装该字体的其他用户，它不会正确显示。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-04-20T00:10:51.273

现在是 2020 年，[Unicode 13 出来了](http://blog.unicode.org/2020/03/announcing-unicode-standard-version-130.html)。它引入了[新的知识共享许可符号](https://creativecommons.org/2020/03/18/the-unicode-standard-now-includes-cc-license-symbols/)。新的兼容 Unicode 的 HTML 实体（带圆圈的 CC 符号）是`&#x1f16d;`您需要兼容的字体才能工作。您可以使用[CC Symbols 字体](https://www.ctrl.blog/entry/creative-commons-unicode-fallback-font.html)作为备用字体，该字体只能在没有兼容字体的设备上下载。链接中的说明。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-16T23:22:50.863

这不是严格意义上的“知识共享”字符，而是“copyleft”符号，对于像我这样的人来说可能具有相同的含义。

将版权符号放在带有 CSS 类的标签`&copy;`之间；`<p></p>`在这种情况下称为“copy-left”，然后使用 CSS 属性翻转它。

HTML：

```
<p class="copy-left">&copy;</p> 
```

CSS：

```
.copy-left {
     display: inline-block;
     text-align: right;
     margin: 0px;
    -moz-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: FlipH;
    -ms-filter: "FlipH";
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-11T21:26:55.803

正如[@schnaader](https://stackoverflow.com/questions/282171/writing-cc-creative-common-in-html#282175)所说，我不认为有一个HTML实体代码，但也许你可以看看[这里](http://creativecommons.org/presskit)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-31T16:08:26.043

另一个答案是使用 Font Awesome

> 链接：[字体真棒](http://fortawesome.io)

它为您提供了 ![](https://mirrors.creativecommons.org/presskit/icons/cc.large.png)您正在寻找的符号，但在第一次提出这个问题时并不存在。

> 要使用此符号，请将以下链接复制到页面顶部：

```
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-3dkvEK0WLHRJ7/Csr0BZjAWxERc5WH7bdeUya2aXxdU= sha512-+L4yy6FRcDGbXJ9mPG8MT/3UCDzwR9gPeyFNMCtInsol++5m3bk2bXWKdZjvybmohrAsn3Ua5x8gfLnbE1YkOg==" crossorigin="anonymous"> 
```

> 然后这是您希望符号所在的位置：

```
<i class="fa fa-creative-commons"></i> 
```

有关使用 Font Awesome 访问的可用图标的完整列表：

> 链接：[字体真棒图标](http://fortawesome.github.io/Font-Awesome/icons)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-11T08:13:32.400

这看起来不错

```
.creative-commons{
  font-family:Arial;
  border: 1px solid black;
  box-sizing: border-box;
  border-radius: 1em;
  width: 2em;
  height: 2em;
  display: inline-block;
  line-height: 2em;
  text-align: center;
  font-size: 1em;
 }
```

```
<span class="creative-commons">CC</span>
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-11T22:50:43.840

只是为了记录，你不需要它是一个 HTML 实体，理论上你可以使用任何[unicode character](http://unicode.org)，编码为像`&#nnnn;`（十进制）或`&#xhhhh;`（十六进制）这样的字符实体。

因此，如果 unicode 中有一个 Creative Commons 徽标，您也许可以使用它。但是，尽管肯定有很多[符号](http://en.wikipedia.org/wiki/Unicode_Symbols)，但知识共享 AFAIK 却没有。

看起来至少在 unicode 论坛上已经[讨论](http://unicode.org/mail-arch/unicode-ml/y2006-m11/0110.html)过了，所以谁知道将来会发生什么。

但就目前而言，图形几乎可以肯定是最好的方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-02T14:15:34.470

谢谢妮基！还有一个 CC 符号（普通版和精简版），您可以将其放置在您的 HTML 页面中，来自[Creative Commons 网站本身](https://creativecommons.org/choose/)。

```
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-02T13:42:11.623

也许你检查一下：

1.  导入 fontawesome.io

2.  将此链接放在您的样式表中：`https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css`

3.  把这个图标`class="fa fa-creative-commons"`

# c++ - Waitpid 等效于超时？

> ID：282176
> 
> 赞同：53
> 
> 时间：2008-11-11T21:19:59.403
> 
> 标签：c++, c, linux

想象一下，我有一个启动多个子进程的进程。父母需要知道孩子何时离开。

我可以使用`waitpid`，但是如果/当父级需要退出时，我无法告诉被阻止的线程`waitpid`优雅地退出并加入它。让事情自己清理是件好事，但这可能没什么大不了的。

我可以使用`waitpid`with `WNOHANG`，然后休眠一段时间以防止忙碌等待。但是，我只能知道孩子是否经常退出。在我的情况下，我知道孩子什么时候离开可能不是超级关键，但我想尽快知道......

我可以使用信号处理程序`SIGCHLD`，并在信号处理程序中执行我在孩子退出时要做的任何事情，或者将消息发送到不同的线程以执行某些操作。但是使用信号处理程序会稍微混淆代码流。

我真正想做的是`waitpid`在一些超时时使用，比如 5 秒。由于退出进程不是时间关键的操作，我可以懒惰地向线程发出退出信号，同时在`waitpid`其余时间仍然阻止它，随时准备做出反应。*linux中有这样的调用吗？在备选方案中，哪一个是最好的？*

* * *

编辑：

基于回复的另一种方法是使用\阻止`SIGCHLD`所有线程。然后在一个线程中，在寻找. 这意味着我可以在该调用上超时并检查线程是否应该退出，如果没有，则保持阻塞等待信号。一旦 a被传递到这个线程，我们可以立即对它做出反应，并且在等待线程的行中，而不使用信号处理程序。`pthread``_sigmask()``sigtimedwait()``SIGCHLD``SIGCHLD`

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-11-14T13:08:56.300

不要`alarm()`与`wait()`. 您可能会以这种方式丢失错误信息。

使用自管技巧。这会将任何信号转换为`select()`有效事件：

```
int selfpipe[2];
void selfpipe_sigh(int n)
{
    int save_errno = errno;
    (void)write(selfpipe[1], "",1);
    errno = save_errno;
}
void selfpipe_setup(void)
{
    static struct sigaction act;
    if (pipe(selfpipe) == -1) { abort(); }

    fcntl(selfpipe[0],F_SETFL,fcntl(selfpipe[0],F_GETFL)|O_NONBLOCK);
    fcntl(selfpipe[1],F_SETFL,fcntl(selfpipe[1],F_GETFL)|O_NONBLOCK);
    memset(&act, 0, sizeof(act));
    act.sa_handler = selfpipe_sigh;
    sigaction(SIGCHLD, &act, NULL);
} 
```

然后，您的类似 waitpid 的函数如下所示：

```
int selfpipe_waitpid(void)
{
    static char dummy[4096];
    fd_set rfds;
    struct timeval tv;
    int died = 0, st;

    tv.tv_sec = 5;
    tv.tv_usec = 0;
    FD_ZERO(&rfds);
    FD_SET(selfpipe[0], &rfds);
    if (select(selfpipe[0]+1, &rfds, NULL, NULL, &tv) > 0) {
       while (read(selfpipe[0],dummy,sizeof(dummy)) > 0);
       while (waitpid(-1, &st, WNOHANG) != -1) died++;
    }
    return died;
} 
```

您可以了解`selfpipe_waitpid()`如何控制超时甚至与其他`select()`基于 IO 的混合。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-11-05T13:02:12.247

分叉一个中间孩子，它分叉真正的孩子和一个超时过程并等待它的所有（两个）孩子。当一个退出时，它会杀死另一个并退出。

```
pid_t intermediate_pid = fork();
if (intermediate_pid == 0) {
    pid_t worker_pid = fork();
    if (worker_pid == 0) {
        do_work();
        _exit(0);
    }

    pid_t timeout_pid = fork();
    if (timeout_pid == 0) {
        sleep(timeout_time);
        _exit(0);
    }

    pid_t exited_pid = wait(NULL);
    if (exited_pid == worker_pid) {
        kill(timeout_pid, SIGKILL);
    } else {
        kill(worker_pid, SIGKILL); // Or something less violent if you prefer
    }
    wait(NULL); // Collect the other process
    _exit(0); // Or some more informative status
}
waitpid(intermediate_pid, 0, 0); 
```

出乎意料的简单:)

如果您确定程序中没有其他模块正在生成自己的子进程，您甚至可以省略中间子进程。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-11-24T10:42:17.943

这是个有趣的问题。我发现[sigtimedwait](http://man7.org/linux/man-pages/man2/sigtimedwait.2.html)可以做到。

编辑 2016/08/29：感谢 Mark Edington 的建议。我已经在 Ubuntu 16.04 上测试了您的示例，它按预期工作。

注意：这仅适用于子进程。遗憾的是，在 Linux/Unix 中似乎没有与 Window 的 WaitForSingleObject(unrelated_process_handle, timeout) 等效的方法来获取超时内无关进程终止的通知。

好的，Mark Edington 的示例代码在[这里](https://www.linuxprogrammingblog.com/code-examples/signal-waiting-sigtimedwait)：

```
/* The program creates a child process and waits for it to finish. If a timeout
 * elapses the child is killed. Waiting is done using sigtimedwait(). Race
 * condition is avoided by blocking the SIGCHLD signal before fork().
 */
#include <sys/types.h>
#include <sys/wait.h>
#include <signal.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>

static pid_t fork_child (void)
{
    int p = fork ();

    if (p == -1) {
        perror ("fork");
        exit (1);
    }

    if (p == 0) {
        puts ("child: sleeping...");
        sleep (10);
        puts ("child: exiting");
        exit (0);
    }

    return p;
}

int main (int argc, char *argv[])
{
    sigset_t mask;
    sigset_t orig_mask;
    struct timespec timeout;
    pid_t pid;

    sigemptyset (&mask);
    sigaddset (&mask, SIGCHLD);

    if (sigprocmask(SIG_BLOCK, &mask, &orig_mask) < 0) {
        perror ("sigprocmask");
        return 1;
    }

    pid = fork_child ();

    timeout.tv_sec = 5;
    timeout.tv_nsec = 0;

    do {
        if (sigtimedwait(&mask, NULL, &timeout) < 0) {
            if (errno == EINTR) {
                /* Interrupted by a signal other than SIGCHLD. */
                continue;
            }
            else if (errno == EAGAIN) {
                printf ("Timeout, killing child\n");
                kill (pid, SIGKILL);
            }
            else {
                perror ("sigtimedwait");
                return 1;
            }
        }

        break;
    } while (1);

    if (waitpid(pid, NULL, 0) < 0) {
        perror ("waitpid");
        return 1;
    }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-11T21:29:59.697

该函数可以被信号中断，因此您可以在调用 waitpid() 之前设置一个计时器，并且在引发计时器信号时它将以 EINTR 退出。编辑：它应该像在调用 waitpid() 之前调用 alarm(5) 一样简单。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-10-19T15:44:10.250

我认为当孩子发出信号时它`select`会返回。我相信这应该有效：`EINTR``SIGCHLD`

```
while(1)
{
  int retval = select(0, NULL, NULL, NULL, &tv, &mask);
  if (retval == -1 && errno == EINTR) // some signal
  { 
      pid_t pid = (waitpid(-1, &st, WNOHANG) == 0);
      if (pid != 0) // some child signaled
  }
  else if (retval == 0)
  {
      // timeout
      break;
  }
  else // error
} 
```

注意：您可以使用`pselect`来覆盖电流`sigmask`并避免来自不需要的信号的中断。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-12T00:05:05.420

如果您无论如何都要使用信号（根据史蒂夫的建议），您可以在想要退出时手动发送信号。这将导致 waitpid 返回 EINTR，然后线程可以退出。无需定期报警/重启。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-18T13:49:20.133

由于某些情况，我绝对需要它在主线程中运行，并且使用自管道技巧或 eventfd 并不是很简单，因为我的 epoll 循环在另一个线程中运行。所以我通过搜索其他堆栈溢出处理程序来想出这个。请注意，通常以其他方式执行此操作更安全，但这很简单。如果有人想评论这真的很糟糕，那么我会全神贯注。

*注意*：绝对有必要阻止任何线程中的信号处理，除了要在其中运行的线程。我默认这样做是因为我认为在随机线程中处理信号会很混乱。

```
static void ctlWaitPidTimeout(pid_t child, useconds_t usec, int *timedOut) {
    int rc = -1;

    static pthread_mutex_t alarmMutex = PTHREAD_MUTEX_INITIALIZER;

    TRACE("ctlWaitPidTimeout: waiting on %lu\n", (unsigned long) child);

    /**
     * paranoid, in case this was called twice in a row by different
     * threads, which could quickly turn very messy.
     */
    pthread_mutex_lock(&alarmMutex);

    /* set the alarm handler */
    struct sigaction alarmSigaction;
    struct sigaction oldSigaction;

    sigemptyset(&alarmSigaction.sa_mask);
    alarmSigaction.sa_flags   = 0;
    alarmSigaction.sa_handler = ctlAlarmSignalHandler;
    sigaction(SIGALRM, &alarmSigaction, &oldSigaction);

    /* set alarm, because no alarm is fired when the first argument is 0, 1 is used instead */
    ualarm((usec == 0) ? 1 : usec, 0);

    /* wait for the child we just killed */
    rc = waitpid(child, NULL, 0);

    /* if errno == EINTR, the alarm went off, set timedOut to true */
    *timedOut = (rc == -1 && errno == EINTR);

    /* in case we did not time out, unset the current alarm so it doesn't bother us later */
    ualarm(0, 0);

    /* restore old signal action */
    sigaction(SIGALRM, &oldSigaction, NULL);

    pthread_mutex_unlock(&alarmMutex);

    TRACE("ctlWaitPidTimeout: timeout wait done, rc = %d, error = '%s'\n", rc, (rc == -1) ? strerror(errno) : "none");
}

static void ctlAlarmSignalHandler(int s) {
    TRACE("ctlAlarmSignalHandler: alarm occured, %d\n", s);
} 
```

*编辑*：我已经过渡到使用与我现有的基于 epoll() 的事件循环很好地集成的解决方案，使用 timerfd。自从我使用 epoll 以来，我并没有真正失去任何平台独立性，而且我获得了额外的睡眠，因为我知道多线程和 UNIX 信号的邪恶组合不会再次伤害我的程序。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-28T10:51:11.237

除了直接调用 waitpid() 之外，您还可以使用 SIGCHLD 调用 sigtimedwait() （在子进程退出后将其发送到父进程）并等待它被传递到当前线程，正如函数名称所建议的那样，超时参数是支持的。

请检查以下代码片段以了解详细信息

```
 static bool waitpid_with_timeout(pid_t pid, int timeout_ms, int* status) {
    sigset_t child_mask, old_mask;
    sigemptyset(&child_mask);
    sigaddset(&child_mask, SIGCHLD);

    if (sigprocmask(SIG_BLOCK, &child_mask, &old_mask) == -1) {
        printf("*** sigprocmask failed: %s\n", strerror(errno));
        return false;
    }

    timespec ts;
    ts.tv_sec = MSEC_TO_SEC(timeout_ms);
    ts.tv_nsec = (timeout_ms % 1000) * 1000000;
    int ret = TEMP_FAILURE_RETRY(sigtimedwait(&child_mask, NULL, &ts));
    int saved_errno = errno;

    // Set the signals back the way they were.
    if (sigprocmask(SIG_SETMASK, &old_mask, NULL) == -1) {
        printf("*** sigprocmask failed: %s\n", strerror(errno));
        if (ret == 0) {
            return false;
        }
    }
    if (ret == -1) {
        errno = saved_errno;
        if (errno == EAGAIN) {
            errno = ETIMEDOUT;
        } else {
            printf("*** sigtimedwait failed: %s\n", strerror(errno));
        }
        return false;
    }

    pid_t child_pid = waitpid(pid, status, WNOHANG);
    if (child_pid != pid) {
        if (child_pid != -1) {
            printf("*** Waiting for pid %d, got pid %d instead\n", pid, child_pid);
        } else {
            printf("*** waitpid failed: %s\n", strerror(errno));
        }
        return false;
    }
    return true;
} 
```

参考：[https ://android.googlesource.com/platform/frameworks/native/+/master/cmds/dumpstate/DumpstateUtil.cpp#46](https://android.googlesource.com/platform/frameworks/native/+/master/cmds/dumpstate/DumpstateUtil.cpp#46)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-11-25T11:01:49.297

如果您的程序仅在当代 Linux 内核（5.3 或更高版本）上运行，首选方法是使用`pidfd_open`（[https://lwn.net/Articles/789023/](https://lwn.net/Articles/789023/) [https://man7.org/linux/man-pages/man2/ pidfd_open.2.html](https://man7.org/linux/man-pages/man2/pidfd_open.2.html)）。

这个系统调用返回一个代表进程的文件描述符，然后你可以`select`，`poll`或者`epoll`它，就像你等待其他类型的文件描述符一样。

例如，

```
int fd = pidfd_open(pid, 0);
struct pollfd pfd = {fd, POLLIN, 0};
poll(&pfd, 1, 1000) == 1; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-11T21:35:32.447

> 我可以为 SIGCHLD 使用信号处理程序，并在信号处理程序中执行我在孩子退出时要做的任何事情，或者将消息发送到不同的线程以执行某些操作。但是使用信号处理程序会稍微混淆代码流。

为了避免竞争条件，您应该避免做任何比在信号处理程序中更改 volatile 标志更复杂的事情。

我认为在您的情况下最好的选择是向父母发送信号。waitpid() 然后将 errno 设置为 EINTR 并返回。此时您检查 waitpid 返回值和 errno，注意您已收到信号并采取适当的措施。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-07T01:37:14.193

如果第三方库是可接受的，那么[libkqueue](https://github.com/mheily/libkqueue)项目将模拟（*BSD 事件系统）并使用+`kqueue`提供基本的进程监控。`EVFILT_PROC``NOTE_EXIT`

使用`kqueue`or的主要优点`libkqueue`是它是跨平台的，并且没有信号处理的复杂性。如果您的程序使用异步 I/O，您可能还会发现它比使用类似的东西`epoll`和各种`*fd`功能（`signalfd`、、`eventfd`等`pidfd`）的摩擦接口更低。

```
#include <stdio.h>
#include <stdint.h>
#include <sys/event.h> /* kqueue header */
#include <sys/types.h> /* for pid_t */

/* Link with -lkqueue */

int waitpid_timeout(pid_t pid, struct timespec *timeout)
{
    struct kevent changelist, eventlist;
    int kq, ret;

    /* Populate a changelist entry (an event we want to be notified of) */
    EV_SET(&changelist, pid, EVFILT_PROC, EV_ADD, NOTE_EXIT, 0, NULL);

    kq = kqueue();

    /* Call kevent with a timeout */
    ret = kevent(kq, &changelist, 1, &eventlist, 1, timeout);

    /* Kevent returns 0 on timeout, the number of events that occurred, or -1 on error */
    switch (ret) {
    case -1:
        printf("Error %s\n", strerror(errno));
        break;

    case 0:
        printf("Timeout\n");
        break;

    case 1:
        printf("PID %u exited, status %u\n", (unsigned int)eventlist.ident, (unsigned int)eventlist.data);
        break;
    }
    close(kq);

    return ret;
} 
```

在 Linux 的幕后使用Linux 内核 >= 5.3 上的`libkqueue` [pidfd](https://github.com/mheily/libkqueue/blob/master/src/linux/proc.c)或在进程退出时侦听并通知一个或多个实例的[服务员线程。](https://github.com/mheily/libkqueue/blob/master/src/posix/proc.c)第二种方法效率不高（它扫描感兴趣的已注册使用的 PID ），但这并不重要，除非您正在等待大量的 PID。`SIGCHLD``kqueue``waitid`

`EVFILT_PROC`自成立以来一直包含支持`kqueue`，并且`libkqueue`自`v2.5.0`.

# ruby-on-rails - 如何在 Rails 模型中运行“do”块，同时仍然列出 :dependent？

> ID：282178
> 
> 赞同：2
> 
> 时间：2008-11-11T21:20:43.473
> 
> 标签：ruby-on-rails, model, associations

所以我有一个用户模型：有许多其他模型，如文档、视频、帖子等。当我从 User 模型执行“do”块时，我的问题出现了，如下所示：

```
has_many :posts do
    def recent
      find(:all, :order => 'created_at desc', :limit => 12)
    end
  end 
```

这只是让我调用 user.posts.recent 之类的东西来仅查找与用户关联的那些帖子。有了这个，我怎么还能添加一个 :dependent => :destroy 或 :dependent => :delete_all 到这个关联？到目前为止，我所尝试的一切都对我有误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-11T21:28:55.190

看起来你应该看看使用[named_scope](http://railscasts.com/episodes/108)。

你没有理由对你的协会设置一个 do 块。

您应该将最近的方法转换为命名范围，然后您可以添加 :dependent => destroy 等。

祝你好运！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-12T04:17:11.310

这应该可以正常工作AFAIK：

```
has_many :posts, :dependent => :destroy do
    def recent
      find(:all, :order => 'created_at desc', :limit => 12)
    end
  end 
```

# iphone - iPhone 上的屏幕关闭事件或属性

> ID：282183
> 
> 赞同：10
> 
> 时间：2008-11-11T21:24:25.620
> 
> 标签：iphone, cocoa-touch, ios-simulator

有没有办法通过顶部的电源按钮确定屏幕是否已关闭？

我只需要知道屏幕是否以某种方式设置为关闭以终止更新位置的循环。

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-11T21:57:14.820

您的应用程序委托将`applicationWillResignActive:`在屏幕锁定之前（或者当电话响铃或弹出另一个窗口时）收到一条消息。这是杀死任何空闲时间进程的绝佳时机。重新激活后，您会收到一条`applicationDidBecomeActive:`消息，您可以在其中重新启动所有这些东西。

# javascript - Javascript 明确的目的

> ID：282184
> 
> 赞同：3
> 
> 时间：2008-11-11T21:25:57.363
> 
> 标签：javascript, coding-style

在过去的五年中，Javascript 的使用变得更加复杂和强大。这类函数式编程的一个方面，尤其是 Javascript 的特殊性，是如何通过注释或代码明确正在发生的事情。即使您了解原型、一流的函数式 Javascript 方式，这类代码通常也需要一段时间才能破译。有什么想法或技术可以完全清楚您的代码在 Javascript 中的作用和方式？

我在别处问过这个问题，但没有得到太多回应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-11T21:38:39.413

使用通用库是一回事，但我认为很多“获取”JavaScript 只是花时间编写它。看似深奥的事情会慢慢变得平凡。几乎任何语言或框架都是如此。

JavaScript 中使用的许多习语，例如匿名函数、文字语法等，只有在您第一次接触它们时才会显得陌生。我认为编写可理解的 C#/Java/C++/VB/等的规则相同。代码适用于 JavaScript - 使用具有语义含义的变量名称，编写有助于理解意图和确认假设的注释，明确等。

现在，如果你真的在问“我怎样才能让不熟悉 JavaScript 的人理解它？” 你还有另一个问题——JavaScript 就是 JavaScript，开发人员必须努力学习它，然后才能精通它并与它“合二为一”。

例如，对于不熟悉 JavaScript 的人来说，这个函数可能看起来很奇怪，但对我（我肯定还有很多其他人）来说，这并不难弄清楚：

```
// comments are not included *on purpose* for illustrating 
// my point about the need for language knowledge
function copy(obj) {
  return new (function(o) {
    for(var property in o) {
      if(o[property].constructor == Array) {
        this[property] = [];
        for(var i = 0; i < o[property].length; i++) {
          this[property][i] = new arguments.callee(o[property][i]);
        }
      } else if(o[property].constructor == Object) {
        this[property] = new arguments.callee(o[property]);
      } else {
        this[property] = o[property];
      }
    }
  })(obj);
} 
```

这个函数有一个名字这一事实可以帮助普通读者知道它的作用，但要真正理解它在做什么，我们必须了解为什么这个函数可能是必要的、如何引用 JavaScript 对象属性、哪些数据JavaScript 支持的类型、构造函数如何工作、匿名函数如何工作等等。只有对这些东西有相当深入的了解才会有所帮助（或者一个除了厨房水槽之外什么都有的库）。

* * *

更新：对于那些说上述示例中的评论会帮助开发人员试图理解它的人 - 显然。评论很有​​用，我认为这是理所当然的。上面的示例代码旨在说明多个特定于 JavaScript 的特性，只有对语言有足够深入了解的人才能理解这些特性。

正如我在别人的答案的评论中所说，**我的代码，我可以根据我的 JavaScript 知识完全理解，不应该*如此*评论，以至于它成为语言知识的替代品**。例如，我不应该解释匿名函数在哪里，或者我在上面的代码中将一个匿名函数用作匿名构造函数，并且它将改变`this`关键字的感知标准行为（对于 C# 和 Java 开发人员） ，所有会让较小的 JavaScript 开发人员感到困惑的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T21:43:42.367

我的观点是双重的：

*   **学习语言**。JavaScript 闭包`{key: {function}}`并不难理解。事实上，这是一种很常见的方言。
*   **学习框架**。jQuery、原型等都是伟大的框架，它们试图在所有 API 中遵循规律性和同质性原则。如果您在自己的 JavaScript 代码中掌握这种做事方式，事情就会变得清晰。

例如，我最近需要一种将自定义行为应用于某些输入的方法。我没有采用函数式风格，而是`<input>`使用我的方法（我正在使用原型）扩展了所有元素，这与原型的其余部分保持一致。如果在开发时牢记这些**原则**，大多数代码都会变得非常简单。

我对 JavaScript 的最大抱怨是知道如何组织我的*.js*文件，但那是另一回事了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T21:37:11.523

做到这一点的一种好方法是使用 Unobtrusive JavaScript 的原则来分离关注点。Sebastian 所建议的 jQuery 的使用使用了这个原则。

[不显眼的 JavaScript](http://www.onlinetools.org/articles/unobtrusivejavascript/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T21:51:58.483

不要忘记，当您编写（或遇到）一段特别深奥的代码时，您可能应该考虑通过快速注释来解释它在做什么（以及为什么这样做），这将有助于其他必须阅读代码，但谁可能没有足够的语言知识来理解实际发生的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T23:32:52.180

@杰森彩旗

我不得不说我不同意“只有深入了解 javascript 的来龙去脉”才能帮助人们理解您的 copy() 示例。诸如“深拷贝”或“递归调用以复制对象属性”之类的注释可以很快为那些不是耳熟能详但不了解 Javascript 特性的所有细节的程序员解释清楚。

*我知道在你真正了解*Javascript之前，有许多重要的概念需要学习，但这并不意味着代码不能一目了然。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T21:32:00.473

我认为隐藏大部分 JavaScript 内容是原型或 jQuery 等框架的目标之一。由于它不容易理解，因此它们被设计得尽可能简单。因此，如果你使用这样的框架，JavaScript 会变得更干净。我所做的是写很多评论，使用很多空格和线条等等。但是那些 {{function(){... 故事仍然存在。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-18T07:28:52.377

1.  **格式化您的代码**。如果您不知道如何使用它 - 依靠 IDE（NetBeans 或 WebStorm 内置）或 JS Beautyfier（如果您仍在记事本中编码，出于某种原因。）

2.  **使用干净代码的一般原则**。使用括号，坚持一种代码约定，使用易于理解的命名方案，谨慎注释，避免全局变量，深度嵌套，长函数和深奥的代码。

3.  **确保您的 IDE 可以识别您的代码。**通常这意味着您必须放弃*模块模式*（也称为*强力构造函数* `var module = ( function () { ... } )();`）以支持*经典构造函数* `Module = function () { ... }; Module.prototype.method1 = function () { ... };`

4.  **在 function 的开头声明 vars**，以避免众所周知的变量提升问题。

5.  **用更好的名称替换`this`构造函数。**这以某种方式显示了实际的对象目的。`function Car() { _car = this; _car.accelerate = function () { ... }; }`

6.  **为现代浏览器编写跨浏览器代码**，如果您需要支持 IE8 及以下的旧垃圾，请使用 jQuery 或其他框架。如果可能，请避免在初始化函数之后的任何地方进行浏览器检测。

7.  **尽可能使用 JS Doc** - 即，如果您的 IDE 或 repo-browser 支持它。

8.  **当您的代码非常复杂时，**为 debug编写。**即：不要`function() { return {`大块代码，不要滥用链接，不要内联可能会破坏的东西。**

***   **不要**`setTimeout`在or中使用 eval ，既不是独立的，也不是隐式的 eval `addEventListener`。** 

 **# apache-flex - 使用 ItemRenderer 在 Tilelist 中的拖放问题

> ID：282191
> 
> 赞同：4
> 
> 时间：2008-11-11T21:30:00.367
> 
> 标签：apache-flex, flash, actionscript-3, drag-and-drop, tilelist

在我的 flex 应用程序中，我创建了一个 Tilelist。在这个 Tilelist 中，我使用 ItemRenderer 在每个 tile 中创建一个由图像和 VSlider 组成的框。

当您单击图像时，图块需要可拖动，但在滑动滑块时不可拖动。我怎样才能做到这一点？我在谷歌上搜索了一天，我真的不知道。

我期待着你的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T18:04:36.473

我找到了解决问题的方法，但它可能不是最好的。

使用这个：

```
 public var overImage:Boolean = false;

        public function checkAllow(evt:DragEvent):void {

            if(overImage == false)
            {
                evt.preventDefault()
            }
        }

        public function isOverImage():void {
            overImage = true;
        }

        public function isOutImage():void {
            overImage = false;
        } 
```

我这样称呼这些函数：

在我的图像组件上

```
mouseOver="outerDocument.isOverImage()" mouseOut="outerDocument.isOutImage()" 
```

对于我的 tilelist，我这样做了

```
Tiles.addEventListener(DragEvent.DRAG_START, checkAllow); 
```

希望它可以帮助一些人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T07:24:16.930

```
 if(event.target is ScrollThumb )
        {
            return;
        } 
```

通过在 imageDragStart 方法中返回 sroller 的 scrollThumb 属性解决了问题...

背景：我的 TileList 提供了 mouseDown ="event.currentTarget.addEventListener(MouseEvent.MOUSE_MOVE, imageDragStart )";

它与滚动条一起影响了完整的 TileList ，

以上是临时修复，但期待专家的建议。

基本上这是用于 Native 应用程序 (AIR)，使用 NativeDragStart。但我被迫在我的 TileList 上使用 mouseDown 来调用我的 imageStartDrag() 方法....

# coldfusion - CFMail中的特殊字符

> ID：282192
> 
> 赞同：2
> 
> 时间：2008-11-11T21:30:04.517
> 
> 标签：coldfusion, cfmail

我正在尝试自动生成带有商标符号的纯文本电子邮件。我已经尝试了我能想到的一切，但仍然没有通过。

```
<cfmail from="#x#" to="#y#" subject="test" charset="UTF-8">
  ™
  &trade;
  #Chr(153)#
</cfmail> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T22:37:33.757

这是一个编码问题。

您声明邮件被编码为 UTF-8，但`Chr(153)`没有返回 Unicode 中的商标符号。它适用于 Windows-1252，但`Chr()`适用于 Unicode 代码点。

用于`Chr(8482)`将其钉在[Unicode TM 符号](http://www.fileformat.info/info/unicode/char/2122/index.htm)上。

我找到了一个[很好地概述了这个问题的信息页面](http://www.pemberley.com/janeinfo/latin1.html#unicode)。

顺便说一句，写字面的 TM 符号也对我有用。但这假设您的 .cfm 文件实际上被编码为 Windows-1252 *，*并且 ColdFusion 运行时配置为预期这一点（*这两者都是 Windows 系统上的默认设置，我已经对其进行了测试。模拟规则适用于其他系统.* ). ColdFusion 在内部将所有字符串转换为 Unicode，因此在您的设置中，这条期望链中可能出现了某些问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T21:38:48.510

我认为这不是 CFMail 的问题，而是电子邮件客户端在纯文本消息中显示字符代码而不是将它们转换为相应字符的问题。

在 HTML 模式下使用 CFMail 应该会提供您正在寻找的结果。

# c++ - 如何在 C++ 中获取 Windows 下的内存使用情况

> ID：282194
> 
> 赞同：60
> 
> 时间：2008-11-11T21:30:25.343
> 
> 标签：c++, windows, memory-management

我试图从程序本身中找出我的应用程序消耗了多少内存。我要查找的内存使用情况是 Windows 任务管理器的“进程”选项卡上“内存使用情况”列中报告的数字。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-11-11T21:39:42.843

一个好的起点是[GetProcessMemoryInfo](http://msdn.microsoft.com/en-us/library/ms683219.aspx)，它报告有关指定进程的各种内存信息。您可以`GetCurrentProcess()`作为进程句柄传递，以获取有关调用进程的信息。

可能的`WorkingSetSize`成员`PROCESS_MEMORY_COUNTERS`是与任务管理器中的 Mem Usage 列最接近的匹配项，但不会完全相同。我会尝试不同的值，以找到最接近您需求的值。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-12-14T05:50:25.657

我想这就是你要找的：

```
#include<windows.h>
#include<stdio.h>   
#include<tchar.h>

// Use to convert bytes to MB
#define DIV 1048576

// Use to convert bytes to MB
//#define DIV 1024

// Specify the width of the field in which to print the numbers. 
// The asterisk in the format specifier "%*I64d" takes an integer 
// argument and uses it to pad and right justify the number.

#define WIDTH 7

void _tmain()
{
  MEMORYSTATUSEX statex;

  statex.dwLength = sizeof (statex);

  GlobalMemoryStatusEx (&statex);

  _tprintf (TEXT("There is  %*ld percent of memory in use.\n"),WIDTH, statex.dwMemoryLoad);
  _tprintf (TEXT("There are %*I64d total Mbytes of physical memory.\n"),WIDTH,statex.ullTotalPhys/DIV);
  _tprintf (TEXT("There are %*I64d free Mbytes of physical memory.\n"),WIDTH, statex.ullAvailPhys/DIV);
  _tprintf (TEXT("There are %*I64d total Mbytes of paging file.\n"),WIDTH, statex.ullTotalPageFile/DIV);
  _tprintf (TEXT("There are %*I64d free Mbytes of paging file.\n"),WIDTH, statex.ullAvailPageFile/DIV);
  _tprintf (TEXT("There are %*I64d total Mbytes of virtual memory.\n"),WIDTH, statex.ullTotalVirtual/DIV);
  _tprintf (TEXT("There are %*I64d free Mbytes of virtual memory.\n"),WIDTH, statex.ullAvailVirtual/DIV);
  _tprintf (TEXT("There are %*I64d free Mbytes of extended memory.\n"),WIDTH, statex.ullAvailExtendedVirtual/DIV);

} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-11T21:41:16.693

GetProcessMemoryInfo 是您正在寻找的功能。MSDN 上的文档将为您指明正确的方向。从您传入的 PROCESS_MEMORY_COUNTERS 结构中获取您想要的信息。

您需要包含 psapi.h。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-11T21:41:23.527

尝试查看[GetProcessMemoryInfo](http://msdn.microsoft.com/en-us/library/ms683219(VS.85).aspx)。我没有使用它，但它看起来像你需要的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-02-07T09:58:40.853

为了补充 Ronin 的答案，indead 函数`GlobalMemoryStatusEx`为您提供了适当的计数器来得出调用进程的虚拟内存使用情况：只需减去即可`ullAvailVirtual`获得`ullTotalVirtual`分配的虚拟内存。您可以使用 ProcessExplorer 或其他工具自行检查。

令人困惑的是，系统调用`GlobalMemoryStatusEx`不幸地具有混合目的：它提供系统范围和进程特定的信息，例如虚拟内存信息。

# java - 将数据从 C 传递到 Java

> ID：282195
> 
> 赞同：2
> 
> 时间：2008-11-11T21:30:34.703
> 
> 标签：java, c, serialization

在 C 服务器和 Java 小程序之间传递数据的最佳方式是什么？目前它是通过使用缓冲区并使用 memcpy 将字节复制到它来完成的，但是如果对象发生变化，我必须寻找它被发送到小程序的每个实例并对其进行更改。

有没有更好的方法将对象传递给java？你会怎么做？

编辑澄清：它只是从 C 服务器到 Java 小程序，没有 Java servlet。Applet 传递给 C 服务器的唯一内容是一个十六进制数字，表示要采取的行动

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T21:45:11.787

您可能想看看[协议缓冲区](http://code.google.com/p/protobuf/)

它们允许您定义结构化数据，然后生成代码以使用任何受支持的语言读取和写入消息。唯一的问题是我认为他们现在只支持 C++，尽管我知道人们对直接的 C 实现很感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T21:38:25.530

我会在两个应用程序之间打开一个套接字连接。您可以将对象序列化为字节数组，并让 Java servlet 将其反序列化为具有相同值的 Java 对象。这样，如果类定义发生变化，您只需在两个地方更改代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T21:44:22.383

我会将对象序列化为 C 端的 XML 或 google protobuf，并使用单个反序列化器在小程序端对它们进行反序列化。即没有一个以上的类进行反序列化。让用户知道您对序列化进行版本化，并且如果它尝试读取的版本不向后兼容，则执行反序列化的对象会引发异常。在整个代码中进行序列化和反序列化是一种不好的做法。

# jquery - 选择具有特定背景颜色的元素

> ID：282198
> 
> 赞同：30
> 
> 时间：2008-11-11T21:31:25.310
> 
> 标签：jquery, css, jquery-selectors

我想在其 CSS 包含特定背景颜色的 s 中选择一堆`span`s 。`div`我如何实现这一目标？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-12T00:08:49.733

如果我正确理解了这个问题，则选择器`[attribute=value]` **将不起作用**，因为`<span>`它不包含属性“背景颜色”。您可以快速测试它以确认它不会匹配任何内容：

```
$('#someDiv span[background-color]').size(); // returns 0 
```

给定：

```
.one, .two {
  background-color: black;
}

.three {
  background-color: red;
} 
```

这是一个**可以工作**的片段：

```
$('div#someDiv span').filter(function() {
    var match = 'rgb(0, 0, 0)'; // match background-color: black
    /*
        true = keep this element in our wrapped set
        false = remove this element from our wrapped set
                                                         */
    return ( $(this).css('background-color') == match );

}).css('background-color', 'green'); // change background color of all black spans
```

```
.one, .two {
  background-color: black;
}

.three {
  background-color: red;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

<div id="someDiv">
    <span class="one">test one</span>
    <span class="two">test two</span>
    <span class="three">test three</span>
</div>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-30T11:17:25.953

# Javascript 方法

1.  获取所有跨度
2.  将 spans 节点列表转换为数组
3.  过滤器跨越数组
4.  更改匹配的 span 元素的背景颜色

```
// Get all spans
let spans = document.querySelectorAll('div#someDiv span'); 

// Convert spans nodeslist to array
spans = Array.from( spans ); 

// Filter spans array
// Get CSS properties object of selected element - [MDN](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
let arr = spans.filter( span => String( document.defaultView.getComputedStyle( span, null ).backgroundColor ) == 'rgb(0, 0, 0)' );

// Change background color of matched span elements
arr.forEach( span => {
    span.style.backgroundColor = 'green';
});
```

```
.one, .two {
  background-color: black;
}

.three {
  background-color: red;
}
```

```
<div id="someDiv">
    <span class="one">test one</span>
    <span class="two">test two</span>
    <span class="three">test three</span>
</div>
```

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2008-11-11T21:35:19.983

使用属性选择器 [attribute=value] 来查找某个属性值。

```
#id_of_the_div span[background-color=rgb(255,255,255)] 
```

# html - 自定义 Outlook 桌面警报对我的电子邮件收件人的显示方式

> ID：282201
> 
> 赞同：2
> 
> 时间：2008-11-11T21:32:22.750
> 
> 标签：html, email, outlook

1.  有没有办法强制 Outlook 在桌面警报中显示 HTML 而不是多部分消息的文本？
2.  有什么方法可以自定义显示的文本吗？还是总是电子邮件的前两行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T01:37:01.913

我不确定我是否正确理解了您的问题，但如果我正确阅读了您的问题标题，您希望以编程方式更改出现在系统托盘上方的 Outlook 2003 / 2007 用户的新邮件通知警报。

桌面警报没有 Outlook 对象模型引用。如果您真的很感兴趣，您也许可以使用其中一种 Win32 API。但是您的问题是您是否可以为您的邮件*收件人*更改此设置，而不是您自己。答案是肯定的。对不起。您为操作收件人的应用程序或环境而编写的任何代码都将（默认情况下）被视为恶意代码并且不会运行。

# sql-server - 我应该如何按小时将数据从 ODBC 应用程序传输到 SQL？

> ID：282207
> 
> 赞同：1
> 
> 时间：2008-11-11T21:33:56.287
> 
> 标签：sql-server, sql-server-2005, ssis, odbc, mirror

我正在尝试每小时将数据从 ODBC 应用程序提取到 SQL2005(dev ed) DB。当我运行 SSIS 时，导入所有表和视图的选项显示为灰色，并强制您编写查询。我将如何设置 SSIS 集成服务以每小时更新所有 250 个表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T21:01:30.033

您的 ODBC 数据源指向哪种数据库？SSIS 可能不会为您提供用于为所有数据库类型选择表/视图的 GUI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T22:11:48.740

也许你可以稍微改一下你的问题，我不是 100% 确定你在这里问什么。您是否尝试通过 SSIS 使用与应用程序的 ODBC 连接通过数据转换任务将数据从应用程序获取到 SQL Server？

Anyhoo，对您问题的 MS Access 部分的简单回答是“不，不”MS Access 永远不是任何事情的答案；-)

我倾向于找出表格和视图变灰的原因并解决该问题。（这个问题中没有足够的信息来确定它们为什么是灰色的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T02:12:41.173

使用导入和导出向导可能会更好。进入 SQL Server Management Studio，右键单击要导入数据的数据库，然后选择任务 -> 导入数据。它将启动向导，引导您完成导入过程的定义。

在向导结束时，您可以选择执行导入，甚至可以将其保存为 SSIS 包，您可以稍后对其进行调整。

# objective-c - 与 Web 服务器的持久连接（如 Web 上的 AJAX）

> ID：282212
> 
> 赞同：2
> 
> 时间：2008-11-11T21:37:12.537
> 
> 标签：objective-c, cocoa, comet

我想创建一个与 Cometd 服务器对话的程序，以允许将数据推送到应用程序。

我已经使用 AJAX 在 Web 端完成了此操作，但我有点不确定使用 Cocoa 执行此操作的最佳方法。

我可以使用 NSURLRequest 和 NSURLConnection 建立标准连接，但是如何保持此连接处于活动状态，以便在需要时发送数据并在需要时获取推送的信息。

我什至会以正确的方式解决这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T22:12:29.750

在推送通知方面，如果 http 服务器没有关闭关闭连接，则 NSURLConnection 将保持打开状态，您将继续获取数据。请注意，如果您正在设计类似的东西，则必须使用异步 NSURLConnection 方法，因为在服务器关闭连接之前，同步连接不会结束。

至于发送更多数据，它确实不是为了这样做而设计的。如果您想在发送后在单个 http 请求中推送更多数据（这对我来说似乎是一个非常糟糕的主意），您将不得不滚动您的 http 堆栈以找到一些您可以使用的开源组件。

请注意，NSURLConnection 将使用它认为合适的保持活动状态和其他东西，因此如果您在应用程序中启动到同一主机的多个逻辑连接，它们最终可能会使用相同的保持活动连接等连接到网络上。

# windows - 哪个分布式版本控制系统具有最好的 Windows GUI 前端？

> ID：282221
> 
> 赞同：5
> 
> 时间：2008-11-11T21:39:57.337
> 
> 标签：windows, version-control, dvcs

在我的工作场所，我们使用 CVS 作为版本控制系统。由于我们主要使用 Windows，TortoiseCVS 和 WinCVS 作为 CVS 的 GUI 前端。

对于分布式 VCS（bzr、hg、git）之一，是否有类似这些前端的东西？我知道我们可以使用命令行，但这不是一个选项。

我已经尝试过 Bazaar，但对 TortoiseBzr 感到失望。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T21:43:23.897

试试[水银](http://www.selenic.com/mercurial/wiki/)。它有一个[龟壳插件](http://tortoisehg.sourceforge.net/)并[与 Eclipse 集成](http://www.vectrace.com/mercurialeclipse/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T21:46:40.693

水银

用于 shell 和[MercurialEclipse的 TortoiseHG](http://trac-hg.assembla.com/mercurialeclipse)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-22T12:20:16.923

Mercurial 目前似乎有最好的 Windows GUI 工具，但 CVS 或 SVN GUI 工具似乎更好，我希望这在未来会有所改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T23:02:21.183

Mercurial 在 DVCS 方面拥有最好的支持。TortoiseHg 用于与 Explorer 和 Nautilus (Linux) 集成，并且有两个 Eclipse 插件（MercurialEclipse 和 Merclipse）可以工作。前者提供了 Mercurial 提供的几乎所有东西，包括 Rebase、Push、Pull、图形历史、工作空间同步等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T16:48:17.900

我喜欢bzr，但是没用过tortoise插件；我相信 Canonical 也在为此开发一些前端。哦，当然还有一个 Eclipse 插件，所以你可以使用你的 IDE 作为它的 GUI。

# oracle - UNIX inside/within IF..THEN 语句中的 SQL 选择语句

> ID：282222
> 
> 赞同：2
> 
> 时间：2008-11-11T21:41:14.010
> 
> 标签：oracle, unix, shell, sqlplus

我只是想在尝试在 UNIX 内部/内部 IF..THEN..FI 语句中创建一个简单的 SQL 选择语句时询问这些步骤。

我知道如何在 SQL*Plus 中使用 'select' 和 'if..then' 语句，但是我在使用 UNIX 脚本指向变量时遇到了困难： If 'ABC' to 'Select...'

## 例子：

如果[“$？” = 'ABC' ] 然后 SELECTemployid, name, age FROM tablename; 否则退出 1 fi

如果[“$？” = 'XYZ' ] 然后 SELECTemployid, name, age FROM tablename; 否则退出 1 fi

如何更正确地将其放入 UNIX 脚本中？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T21:49:42.653

这听起来像是您试图将 SQLPlus 嵌入到 shell 脚本中。从记忆中，咒语应该看起来像：

```
if [ $? -eq ABC ]; then
SQLPLUS /S USER/PASS@Instance <<EOF
SET echo off;
SET pagesize 0;
SET heading off;
SPOOL foo.out
select foo from bar
EOF
fi 
```

SQLPLUS 和 EOF 之间的所有内容都传递给 SQLPlus，因此我们有一些语句来控制格式（您可能需要不同的）和实际查询。SQLPlus 脚本中的 SPOOL 命令将输出发送到文件。有关使用 SQLPlus 的更详细文档，您可以从[Oracle 的网站下载它们。](http://www.oracle.com/technology/docs/tech/sql_plus/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T01:25:36.227

记住那`echo`是你的朋友。

```
if [ "$?" = "ABC" ] then echo SELECT employid, name, age FROM tablename; else exit 1; fi 
```

您可以嵌入 shell 脚本变量等。注意需要引用 shell 想要操作的东西，比如引号和分号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T20:31:54.850

您是否考虑过使用 perl 或其他包含数据库连接功能的脚本语言。这样您就可以避免笨拙的 shell 脚本/SQL*Plus 链接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T01:20:38.887

上面的答案是可以的。但是，我知道，在 shell 脚本中使用 SQLPlus，不幸的是，我不需要 SQLPlus 脚本来将输出发送到文件。换句话说：有没有其他方法可以做到这一点，只需将输出打印到日志中？

# c# - 在文本框中解析没有日期的时间

> ID：282226
> 
> 赞同：4
> 
> 时间：2008-11-11T21:42:20.670
> 
> 标签：c#, wpf, vb.net, datetime, .net-3.5

我正在开发一个时间表应用程序，我希望用户能够在 TextBoxes 中输入时间，例如：8 a 或 8:00 a 等，就像在 Excel 中一样。

现在，如果您在 TextBox 中输入*日期*，然后使用 DateTime.TryParse，您可以以多种格式输入日期（2007 年 1 月 31 日；2007 年 1 月 31 日；2007 年 1 月 31 日；2007 年 1 月 31 日等）和.NET 会弄清楚并将其转换为 DateTime。

但是当我在“8 a”或“8:00 a”之类的字符串上使用 DateTime.TryParse 时，它​​无法理解。

我知道我可以使用 ParseExact，但我想知道是否有更灵活的解决方案。我希望 .NET 从“8 a”或“8:00 a”获取 8:00a，并将日期组件保留为默认的 1/1/0001。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T22:05:09.157

你总是可以欺骗系统（很容易）：

```
DateTime blah = DateTime.Parse("1/1/0001 " + myTimeString); 
```

我自己也做过类似的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T21:44:27.110

我会重新考虑您的 UI 功能并将其替换为两个组合框或其他形式的时间选择器。

最终，即使是世界上最好的时间解析器，仍然无法通过白痴用户测试。

除此之外， Parse.Exact 就是您所需要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-11T21:47:29.303

想一想，没关系。我刚刚注意到，如果我使用“am”和“pm”而不是“a”和“p”，它可以正常工作。它假定今天的日期，而不是默认的 1/1/0001，但这对我来说不是问题。

（不过，任何让“a”和“p”工作的相当简单的解决方案都是受欢迎的。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T21:54:55.573

您可以使用验证或验证事件来捕获文本并添加“m”。

# c# - 不以本地管理员身份运行时 .NET Web 服务客户端中的奇怪行为

> ID：282228
> 
> 赞同：1
> 
> 时间：2008-11-11T21:43:27.343
> 
> 标签：c#, permissions, timeout, service

我们在客户站点部署应用程序时遇到了一个非常奇怪的情况。此应用程序在 .NET 3 上使用 C# 作为服务实现。该应用程序与使用 gSOAP 编写的 Web 服务进行通信。在我们的 .NET 应用程序中，包装 Web 服务的类是通过在 Visual Studio 中执行“添加服务”并引用 WSDL 来创建的。使用 HTTPS 进行通信，但使用端口 35000。

我们看到的是，当我们的应用程序作为“本地管理员帐户”运行时，一切正常。但是，当我们的应用程序作为任何其他帐户运行时，包括“本地系统帐户”甚至具有网络管理员权限的用户帐户，Web 服务方法调用有时会超时。其他时候他们成功了，但是在非常非常长的时间之后，例如 100 秒而不是预期的不到 1 秒。

该客户在其网络中使用 Cisco 交换机。

我们在其他站点没有遇到过这种行为。任何见解或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T21:47:11.940

任何有关超时、异常等的事件日志消息？

应用程序是 Windows 服务吗？您是否使用 RunAs 在不同的用户上下文下运行？它是否需要桌面交互或对 System.Windows.Forms 有任何引用？

@评论 1：Windows 服务、Web 服务、WCF 服务？

为服务可能使用的资源启用本地和远程计算机的[安全审计。](http://support.microsoft.com/kb/300549)

另一件事是像这样添加调试级别的日志记录......（对不起伪VB）

```
Sub OnStart(args())
 LogToFile("Starting Service, processing arguments")
 'process args'
 LogToFile("ArgsProcessed calling main worker method")
 'call main worker method'
End OnStart

Sub LogToFile(message as String)
 If (AppConfigKeys[debugLogging] = True) Then
   'writes "DateTime.Now.ToString() & "-" & message" to a text file log' 
 End If
End Sub 
```

在任何可能失败的过程之前和之后将这种登录嵌入到应用程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T21:52:11.150

客户在防火墙硬件上是否有 BI 规则？（我正在抓住稻草，但几年前我们的一位客户使用我们的一项服务时也有类似的行为，因为他们在防火墙上启用了一些时髦的 BI 规则。）

# javascript - DOM 事件优先级

> ID：282245
> 
> 赞同：63
> 
> 时间：2008-11-11T21:47:15.090
> 
> 标签：javascript, event-handling, dom-events, eventqueue

JavaScript 中处理事件的优先顺序是什么？

以下是按字母顺序排列的事件...

1.  onabort - 图像加载中断
2.  onblur - 元素失去焦点
3.  onchange - 用户更改字段的内容
4.  onclick - 鼠标点击一个对象
5.  ondblclick - 鼠标双击一个对象
6.  onerror - 加载文档或图像时发生错误
7.  onfocus - 元素获得焦点
8.  onkeydown - 按下键盘键
9.  onkeypress - 按下或按住键盘键
10.  onkeyup - 释放键盘键
11.  onload - 页面或图像已完成加载
12.  onmousedown - 按下鼠标按钮
13.  onmousemove - 鼠标移动
14.  onmouseout - 鼠标从元素上移开
15.  onmouseover - 鼠标移到一个元素上
16.  onmouseup - 释放鼠标按钮
17.  onreset - 单击重置按钮
18.  onresize - 调整窗口或框架的大小
19.  onselect - 文本被选中
20.  onsubmit - 单击提交按钮
21.  onunload - 用户退出页面

他们在事件队列中的处理顺序是什么？

我相信优先级不是先进先出（FIFO）。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-11T21:55:25.247

据我所知，这在过去没有明确定义。不同的浏览器可以自由地实现它们认为合适的事件排序。虽然大多数情况对于所有实际目的来说都足够接近，但已经存在并且继续存在一些奇怪的边缘情况，其中浏览器有所不同（当然，更多的情况是某些浏览器*根本*无法发送某些事件）。

也就是说，[HTML 5 草案建议](http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html)确实尝试指定事件将如何排队和分派 -[事件循环](http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#event-loops)：

> 为了协调事件、用户交互、脚本、渲染、网络等，用户代理必须使用本节中描述的事件循环。
> 
> 每个用户代理必须至少有一个事件循环，并且每个相关的同源浏览上下文单元最多有一个事件循环。
> 
> 一个事件循环有一个或多个任务队列。任务队列是任务的有序列表 [...] 当用户代理要对任务进行排队时，它必须将给定任务添加到相关事件循环的任务队列之一。来自一个特定任务源的所有任务必须始终添加到同一个任务队列中，但来自不同任务源的任务可能被放置在不同的任务队列中。[...]
> 
> [...]用户代理可以有一个用于鼠标和按键事件的任务队列（用户交互任务源），另一个用于其他所有事件。然后，用户代理可以在四分之三的时间内将键盘和鼠标事件优先于其他任务，保持界面响应但不会饿死其他任务队列，并且永远不会无序地处理来自任何一个任务源的事件。[...]

请注意最后一点：由浏览器实现决定哪些事件将被组合在一起并按顺序处理，以及赋予任何特定类型事件的优先级。因此，几乎没有理由期望所有浏览器都以固定顺序调度*所有事件，无论是现在还是将来。*

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-06-08T06:06:13.537

对于任何想知道调用顺序相关事件的人，请参见下文。到目前为止，我只在 Chrome 中进行了测试。

1.  鼠标移到
2.  鼠标移动
3.  鼠标移出

* * *

1.  鼠标按下
2.  改变（聚焦输入）
3.  模糊（在焦点元素上）
4.  重点
5.  mouseup
6.  点击
7.  dblclick

* * *

1.  按键
2.  按键
3.  键位

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-09T13:56:19.370

如果您正在查看鼠标/触摸事件，Patrick H. Lauke 发表[了关于该主题的演讲](http://patrickhlauke.github.io/getting-touchy-presentation/)。绝对是一本有趣的读物——涉及不同浏览器、不同设备和不同标准的所有怪癖。

他还捆绑[了一套全面的测试](http://patrickhlauke.github.io/touch/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-10-03T23:18:49.493

这是一些事件的演示：

```
<input  onclick="console.log('onclick - Mouse clicks an object')" 
     ondblclick="console.log('ondblclick - Mouse double-clicks an object')"
    onmousedown="console.log('onmousedown - A mouse button is pressed')"
      onmouseup="console.log('onmouseup - A mouse button is released')"
    onmousemove="console.log('onmousemove - The mouse is moved')"
   onmouseenter="console.log('onmousenter - The mouse is moved over an element (not bubbling)')"
    onmouseover="console.log('onmouseover - The mouse is moved over an element')"
     onmouseout="console.log('onmouseout - The mouse is moved off an element')"
   onmouseleave="console.log('onmouseout - The mouse is moved off an element (not bubbling)')"
       onchange="console.log('onchange - The user changes the content of a field')"
      onfocusin="console.log('onfocusin - An element gets focus')"
        onfocus="console.log('onfocus - An element gets focus (not bubbling)')"
      onkeydown="console.log('onkeydown - A keyboard key is pressed')"
     onkeypress="console.log('onkeypress - A keyboard key is pressed or held down')"
onselectionchange="console.log('onselectionchange - The caret position changed')"
        onkeyup="console.log('onkeyup - A keyboard key is released')"
       onselect="console.log('onselect - Text is selected')"
     onfocusout="console.log('onfocusout - Loosing focus')"
         onblur="console.log('onblur - Loosing focus (not bubbling)')"
   ontouchstart="console.log('ontouchstart')"
    ontouchmove="console.log('ontouchmove')"
     ontouchend="console.log('ontouchend')"
  ontouchcancel="console.log('ontouchcancel')"
    placeholder="edit me"
/>
```

我注意到之前在 chrome/firefox 桌面上`onselectionchange`触发过`onkey`，而在 android chrome 上则相反。

[https://jsfiddle.net/yv8zg5d1](https://jsfiddle.net/yv8zg5d1)

# c# - 多个有序列表归结为一个列表，其中顺序是相对的

> ID：282252
> 
> 赞同：2
> 
> 时间：2008-11-11T21:49:29.640
> 
> 标签：c#, sorting, diff

我有多个有序列表。不幸的是，项目的顺序不是简单的字母或数字比较，否则这是微不足道的。所以我所拥有的是：

```
List #1        List #2       List #3
groundhog      groundhog     easter
mothersday     mayday        mothersday
midsummer      laborday      halloween
christmas 
```

并且从这里我可以收集到比土拨鼠<母亲节，但土拨鼠和复活节的关系是未知的。我保证从列表到列表的项目顺序是自洽的。（即无论它出现在哪个列表中，复活节总是在万圣节之前）

但我需要的是一个新的有序列表，它只代表其他列表中的每个项目一次，它保留了上面所有已知的关系：

```
groundhog
easter
mayday
mothersday
midsummer
laborday
halloween
christmas 
```

但是，以下列表也是完全有效的：

```
easter
groundhog
mothersday
mayday
midsummer
laborday
halloween
christmas 
```

我正在寻找一种相当快速的通用算法，我可以用这种算法对 N 个列表进行排序。（工作 C# 代码当然是一个加分项，但不是必需的。）

我有可行的解决方案，但它的 O(N^2) 和一只狗甚至拥有适度的数据集。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T21:52:50.070

您可能想看看[拓扑排序](http://en.wikipedia.org/wiki/Topological_sort)。我认为它非常适用于您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T22:28:46.697

我同意@bdumitriu，你想要拓扑排序。

这种类型的排序假定您的数据项之间存在*偏序*，这意味着对于*某些*项对，您可以比较它们以查看哪个在另一个之前。在这种情况下，就像您说的那样，有多种方法可以创建一个保留所有约束的项目列表。

拓扑排序通常通过首先创建项目的有向无环图来工作，其中每个项目成为一个顶点，从节点 X 到节点 Y 的有向边意味着项目 X 在输入列表中位于项目 Y 之前。（因此，您将遍历您的输入排序列表集，每次遇到新项目时，都会为其创建一个顶点，并且对于每个排序列表中的每一对连续项目，您都会从第一项到第二项。请​​注意，您不需要创建从一个项目到每个输入列表中*所有*先前项目的有向边；例如，在您的输入列表 1 中，您将创建边`groundhog`-> `mothersday`，`mothersday`-> `midsummer`, 和`midsummer`-> `christmas`.)

拓扑排序将花费时间 O(V+E)，其中 V 是您要排序的项目总数（顶点数），E 是输入列表中前导关系的总数（边数） .

——菲尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T22:56:36.120

我将使用 Array.Sort 方法和一个比较方法，该方法需要比较两个字符串，然后检查它们是否存在于任何列表中；任何同时包含它们的列表，找到它们的相对位置，并基于此返回；如果没有列表同时包含它们，则返回相等。

MSN 文档指出他们的排序算法使用快速排序；平均 nlog(n) 顺序，最坏的情况是 n^2 的顺序。

这样，您就可以利用他们对排序算法的实现；您所要做的就是实现比较代码。

# open-source - 您会推荐什么作为易于修改的论坛包？

> ID：282262
> 
> 赞同：0
> 
> 时间：2008-11-11T21:53:03.440
> 
> 标签：open-source, forums

我正在建立一个新网站，这将极大地受益于拥有用户论坛。

由于我已经有用户帐户和个人资料详细信息，因此我似乎可以从选择一个我可以修改的开源论坛包中受益，以便针对我现有的数据库测试登录。

现在我的所有网站都是基于 Perl 的，环顾四周，我没有看到很多很棒的 Perl 论坛——我能找到的唯一明显的有特色的是[yabb——](http://www.yabbforum.com/ "雅布")但它是为了对平面文件进行身份验证而编写的，坦率地说代码很*讨厌*。

如果我需要使用 PHP 解决方案，那就这样吧，但首先有没有你建议的用 perl 编写的简单论坛？我希望有不同的论坛组并提名特定用户作为版主。不仅如此，我不需要，只是基本的线程和有吸引力的外观。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T03:24:32.850

真正简单的论坛通常是非常不安全的论坛。如果您决定使用 perl，则不会想到主要的网络论坛，如果您在安全方面有能力，我会说自己动手。你甚至可以将它发布到开源社区来帮助像你这样的人。我知道那里有几个很棒的 PHP，它们不是那么不安全，而是相当发达。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T05:20:14.553

我似乎记得 Drupal 作为一个模块很合适。

# flash - 垃圾收集器 Flash 播放器

> ID：282280
> 
> 赞同：0
> 
> 时间：2008-11-11T21:58:51.540
> 
> 标签：flash, memory-management, garbage-collection

有没有办法强制闪存垃圾收集器清理释放的内存？我已经看到闪存清理未引用的内存需要很长时间......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T22:48:22.940

不幸的是没有。这是格兰特·斯金纳（Grant Skinner）写过很多的东西，所以请查看[他的博客](http://www.gskinner.com/blog/archives/2006/06/as3_resource_ma.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-03T00:31:47.840

您可以将内容添加到自己的垃圾收集器中，然后在它们完成时对其进行鞭打。

```
var antiGC:Dictionary = new Dictionary(false);

var loaderwidth:Tween = new Tween(maskbox, "width", Regular.easeIn, 1, 1000, 25, false);

antiGC[loaderwidth] = loaderwidth;

loaderwidth.addEventListener(TweenEvent.MOTION_FINISH, lwfinished);

function lwfinished(e:TweenEvent){

    loaderwidth.removeEventListener(TweenEvent.MOTION_FINISH, lwfinished);
    antiGC[e.currentTarget] = null;
    delete antiGC[e.currentTarget];
} 
```

# javascript - StackOverflow 的“标签”文本框自动完成是如何工作的？

> ID：282282
> 
> 赞同：38
> 
> 时间：2008-11-11T21:59:14.723
> 
> 标签：javascript, jquery, ajax, textbox, autocomplete

我知道他们使用的是 jQuery 插件，但我似乎无法找到他们使用的是哪个插件。特别是，我正在寻找的是具有与 SO 的自动完成功能完全相同的功能的自动完成功能，它将在输入的每个新单词时执行 AJAX 命令，并允许您从下拉列表中选择一个。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-11T22:14:31.353

请注意，标签编辑器[现在已经完全重新编写](https://meta.stackexchange.com/questions/100669/feedback-wanted-improved-tag-editor)，不再类似于装饰网站近三年的原始、简单的文本框和建议下拉菜单。

如果您对新表单感兴趣，请参阅此元问题：[https ://meta.stackexchange.com/questions/102510/can-i-use-the-tag-textbox-script](https://meta.stackexchange.com/questions/102510/can-i-use-the-tag-textbox-script)

[自动完成](http://docs.jquery.com/UI/Autocomplete)是最初使用的插件，尽管多年来对其进行了各种调整和定制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-03T08:49:42.697

你可能还喜欢这个：

*   [http://code.google.com/p/jquery-autocomplete/](http://code.google.com/p/jquery-autocomplete/)

在此处阅读历史记录：[http ://code.google.com/p/jquery-autocomplete/wiki/History](http://code.google.com/p/jquery-autocomplete/wiki/History)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-03T10:35:32.447

看看[SO_Tag](http://www.iog3.com/322/so_tag-tagging-system-based-on-stackoverflows-tag-search/)，一个基于 StackOverflows 标记系统的标记系统。

和[Github](https://github.com/iog3/SOTag)。

# apache - 如何对特定 URL（不是目录）使用 HTTP 身份验证

> ID：282298
> 
> 赞同：1
> 
> 时间：2008-11-11T22:05:53.993
> 
> 标签：apache, mod-rewrite

我有一个使用 mod_rewrite 将 /controller 重定向到 /index.php?controller=%controller% 的 htaccess 文件

像这样：

```
# Various rewrite rules.
<IfModule mod_rewrite.c>
  RewriteEngine on

  # Rewrite current-style URLs of the form 'index.php?controller=x&action=y'.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ index.php?controller=$1 [L,QSA]
</IfModule> 
```

现在，我需要做的是让其中一个控制器使用 HTTP 身份验证。我不是在问这是否是最好的做事方式，我只是在问如何去做。

例子：

```
http://www.example.com/ - It requires no auth
http://www.example.com/secret - requires auth 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T22:39:41.817

```
<Location /secret>
  AuthName localhost
  AuthType Basic
  AuthUserFile <file>
  Require valid-user
</Location> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T22:30:32.600

我最终使用 PHP 来做到这一点：

```
if (in_array($controllerString, $configuration['protected']))
{
    $authenticated = false;
    if (!isset($_SERVER['PHP_AUTH_USER'])) {
        header('WWW-Authenticate: Basic realm="My Realm"');
        header('HTTP/1.0 401 Unauthorized');
        echo 'You are unatuhorized to access this section of the website.';
    } else if ($_SERVER['PHP_AUTH_USER'] == 'admin' && $_SERVER['PHP_AUTH_PW'] == 'admin'){
        $authenticated = true;
    }

    if (!$authenticated)
    {
        unset($_SERVER['PHP_AUTH_USER']);
        die();
    }
} 
```

# .net - ASP.net 2.0 GridView Columns dependant on multiple columns in the bound result set

> ID：282308
> 
> 赞同：2
> 
> 时间：2008-11-11T22:09:52.033
> 
> 标签：.net, gridview, asp.net-2.0

I'm working with an ASP.net 2.0 GridView control that is bound to the results of a sql query, so it looks something like this:

```
<asp:GridView ID="MySitesGridView" runat="server" AutoGenerateColumns="False" DataSourceID="InventoryDB" AllowSorting="True" CellPadding="4" ForeColor="#333333" GridLines="None" OnRowCommand="GridView1_RowCommand" OnRowDataBound="siteRowDataBound">
        <Columns>
            <asp:BoundField DataField="Server" HeaderText="Server"/>
            <asp:BoundField DataField="Customer" HeaderText="Customer" SortExpression="Customer" />
            <asp:BoundField DataField="PublicIP" HeaderText="Site Address" DataFormatString="&lt;a href='http://{0}/foo'&gt;Go To Site&lt;/a&gt;" />
        </Columns>
</asp:GridView> 
```

As you can see, I'm displaying links with addresses in one of the columns (the one bound to the PublicIP field) using the format string:

```
&lt;a href='http://{0}/foo'&gt;Go To Site&lt;/a&gt; 
```

Here's the problem: I need to use one of the *other* columns from the result set as well as the PublicIP column in my links, but I don't know how to make that available to my format string. I essentially need that column bound to two columns from the result set. To clarify, I need something like:

```
&lt;a href='http://{0}/{1}'&gt;Go To Site&lt;/a&gt; 
```

Where {1} is the value of my other column. Is there any way to accomplish this cleanly (even if it doesn't use format strings)? I've looked into using TemplateFields as well, but can see no easy way to do it with them either.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T22:22:34.567

TemplateFields are the way to go.

I usually prefer to have a private string function in the Page which I pass several object variables, and calculate the resulting string.

```
<a href="<%# CalculateUrl(Eval("PublicIP"), Eval("Customer")) %>">site</a> 
```

and in the code-behind:

```
private string CalculateUrl(object PublicIP, object Customer)
{
    if (PublicIP==null || PublicIP==DBNull.Value)
        return "";
    if (Customer==null || Customer==DBNull.Value)
        return "";
    return "http://" + PublicIP.ToString() + "/" + Customer.ToString();
} 
```

Advantage is that the function can be shared in a common parent class, or as a static public function of a utility class.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T22:13:55.210

Have you tried TemplateField in combination with Eval?

```
<asp:TemplateField>
    <ItemTemplate>
        <a href='<%#Eval("PublicIP")/<%# Eval("Customer") %>'>Go to site</a>
    </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T23:15:19.640

If you want an actual link, you can also use a HyperLinkField, which has a property DataNavigateUrlFields (plural) that you can use to specify multiple fields. You then set DataNavigateUrlFormatString to something containing {0}, {1} etc. This will become your link. For the link text, you use DataTextFormatString and DataTextField (singular, don't ask me why). This is probably a bit easier than a TemplateField (although less flexible).

# xml - 在 XSL-FO 驱动 (Pdf) 中嵌入 Excel 文件 - 文档生成

> ID：282312
> 
> 赞同：1
> 
> 时间：2008-11-11T22:10:45.073
> 
> 标签：xml, excel, pdf, xsl-fo

我们目前正在使用 XSL-FO 转换生成所有官方文档，使用 .xml 文件作为输入并生成 .pdf 文件，并且这些 .xml 文件中的所有内容基本上都是纯文本或 xhtml。这非常适合日常用例，但我们的一些用户引用了我们的 XSL-Fo 转换器（天线屋）无法原生处理的 Microsoft Excel 文件（而且，afaik，也没有其他人真正做到这一点）。

因此，作为中间的短期解决方案，我们所做或正在做的事情是，我们从用户定义的打印区域创建图像，并将这些图像嵌入到 .pdf 文件中。

然而，由于这些图像显然不是“可搜索”的内容，我们正在寻找 OCR 对这些 .pdf 等进行 OCR 的后处理步骤，但在我看来，这一切都深入到了解决方法的漏洞中。

我有将这些 .xls 文件转换为 SpreadsheetML 的想法，并用我们的 xsl-fo 样式表覆盖它，但是看着电子表格的规范，我也有点放弃了这个希望.. 至少没有在实施过程中投入几十个人工月。

那么，来回答我的实际问题，在 xsl-fo 驱动的文档生成中，您将如何处理 Microsoft Excel 文件？

干杯和感谢，-J

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T21:09:19.130

您的 .xls 文件有公式吗？如果不只是使用 fo 中的表格、行和单元格标记将 xlsx 转换为 xsl-fo。从来没有在 xml 中查看过带有公式的 xlsx 文件。让我想知道您是否可以将 Excel 文档保存为“可见”而没有公式只是结果？有点像“打印到excel”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T01:14:19.560

您可以将 Excel 文件转换为 PDF，然后合并生成的文档。它不是直接通过 XSL-FO 处理。

就个人而言，我什至不会尝试将 Excel 文件存储在 PDF 中，我会从 PDF 链接到它。Excel 是封闭的，非常复杂，对于开放的部分（新的 XML 格式），它仍然可以（通常）包含二进制 blob 及其移动目标。我不认为这是一场值得打的战争。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-18T15:58:29.803

[Windward Docgen](https://www.windwardstudios.com/)完全符合您的要求。使用 Windward，您可以在 Word、Excel 或 PowerPoint 中设计文档，然后我们的引擎将该模板与数据合并以创建最终文档。该引擎在 Java 和 .NET 中可用，并且不使用服务器上的 Office，因此速度非常快，并为您提供嵌入了 Excel 并评估所有宏的最终 PDF。（免责声明 - 我是 Windward 的 CTO。）

# c# - C# 中泛型类的专业化模式？

> ID：282317
> 
> 赞同：10
> 
> 时间：2008-11-11T22:11:50.720
> 
> 标签：c#, .net, design-patterns, generics

在 C# 中，我有时希望可以为泛型类的某些“实例化”创建特殊方法。

**更新：以下代码只是一个更抽象问题的愚蠢示例 - 不要过多关注时间序列，只是为某些 T “添加额外方法”的原则**。

例子：

```
class Timeseries<T> 
{ 
    ...
    TimeSeries<T> Slice(...) { ... }
} 
```

在 T 为 double 的情况下，我想要一些额外的方法，比如`Integrate()`，`Interpolate()`等等，这些方法只对 有意义`double`，因为我需要对它们进行算术运算。

有几种方法可以做到这一点，但我找不到我满意的一种。

**1.继承到特殊的类**

```
class TimeseriesDouble : Timeseries<double>
{ 
    double Interpolate(...) { ... }
    ...
} 
```

**缺点：** `TimeseriesDouble.Slice()`将返回一个新`Timeseries<double>`对象，现在缺少我的特殊方法。

**2.外部方法**

```
public static double Interpolate(Timeseries<double> ts, ...) { ... } 
```

**缺点：**违反了 OO 原则。而且我不想放弃我的方法。此外，这些方法可能需要私有/受保护状态。

**3\. 扩展方法**

与 2 相同，只是使用了更好的调用语法。

**4.通用基类**

```
class TimeSeries_base { ... }
class TimeSeries<T> : TimeSeries_base { .. typesafe versions of methods .. }
class TimeSeriesDouble : TimeSeries_base { .. typesafe versions of methods .. } 
```

**缺点：**`TimeSeries_base`从两个子类中重复的东西太多。基类可能只是子类的实用函数的占位符。

**亲：**`List<TimeSeries_base>`我现在可以动态地做一些事情。

**5\. 忘记一个普通的类**

即，在代码中保持`Timeseries<T>`和`TimeseriesDouble`分开。

**缺点：**然后我并没有得到将 a 视为 a 的所有好处`TimeseriesDouble`，`TimeSeries<T>`例如将两个时间序列与 ZIP(A,B) 结合起来，其中一个恰好是双打。

* * *

**还有其他想法吗？** 目前，我认为我最喜欢设计（1）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-11T23:46:43.553

您总是可以使用自引用泛型技巧：

```
public class TimeSeries<T, U> where U : TimeSeries<T, U>
{
    U Slice(...)
}

public class TimeSeriesDouble : TimeSeries<double, TimeSeriesDouble>
{
    ...
} 
```

它可能会有点脑筋急转弯，但它可以工作。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-12T00:04:18.137

```
interface ITimeSeries<T> { ... }

abstract class TimeSeriesBase<TS> where TS : TimeSeriesBase<TS> 
 { public TS Slice() { ... } 
 }

class TimeSeries<T>:TimeSeriesBase<TimeSeries<T>>,ITimeSeries<T> {}

class TimeSeriesDouble:TimeSeriesBase<TimeSeriesDouble>,ITimeSeries<double>
 { public double Interpolate() { ... }
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T23:29:36.100

我会选择（1）并酌情选择。

```
 TimeSeriesDouble tsD = new TimeSeriesDouble();
 TimeSeriesDouble subTSD = tsD.Slice(...) as TimeSeriesDouble; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T22:56:11.690

我会考虑实现一个工厂来返回适当的子类。

# opengl - 在同一应用程序的不同窗口中混合opengl和directdraw？

> ID：282321
> 
> 赞同：2
> 
> 时间：2008-11-11T22:13:27.253
> 
> 标签：opengl, directx, directdraw

我正在开发一个有两个窗口的应用程序：

*   窗口 1：渲染直接绘制表面
*   窗口 2：我想让*它*做纯 OpenGL 调用

我不想在同一个窗口中混合使用 OpenGL 和 DirectDraw。

我从 Open GL 常见问题解答 ( [http://www.opengl.org/resources/faq/technical/mswindows.htm](http://www.opengl.org/resources/faq/technical/mswindows.htm) ) 中看到，您不能在同一个窗口中混合 API 调用。

所以，我的问题是：一个应用程序可以让一个窗口进行直接绘制而另一个进行 OpenGL 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T22:29:00.030

在同一进程中运行两者应该没有问题，当然 ICD 视频驱动程序中的错误除外。

最快的判断方法可能是注释掉 OpenGL 代码并检查应用程序是否仍然崩溃。

或者，强制您的 OpenGL 代码使用 Microsoft 实现——它是基于 XP 的软件和基于 Vista 的 Direct3D——不应该有冲突。如果 ddraw 问题仍然存在，很可能不是 OGL 故障。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T22:36:45.100

最坏的情况：让您的主程序生成执行一种类型的渲染（比如说 DirectDraw）。让它产生一个执行其他类型（OpenGL）的进程。使用管道在两者之间进行通信。这将要求您有两个进程，这可能是一种解决方法，但它至少可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T22:41:11.690

嗯.....我已经将 OpenGL 的东西隔离到一个线程。你是这个意思吗？或者，我认为您是在说开始一个新的过程。

问题是：我看到 BLT 上的 DirectDraw 代码崩溃。这是随机的，但我担心 OpenGL 的东西正在扼杀它。

# sql - SQL：对 SELECT 语句返回的行进行编号

> ID：282322
> 
> 赞同：4
> 
> 时间：2008-11-11T22:13:33.167
> 
> 标签：sql, sql-server, sql-server-2000

假设我有一个返回一组结果的 SELECT 语句。有什么方法可以按以下方式对结果进行编号：

> 从 PuppyNames 中选择前 3 个名称，按 NumberOfVotes 排序

会给我...

> 菲多
> 
> 漫游者
> 
> 弗雷迪克鲁格

...但我想要...

> 1、菲多
> 
> 2、罗孚
> 
> 3、弗雷迪克鲁格

当然，逗号表示数字在它们自己的列中。[我使用的是 SQL Server 2000。]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T22:23:41.460

在 Microsoft SQL Server 2005 中，您拥有的`ROW_NUMBER()`功能正是您想要的。

如果您被 SQL Server 2000 卡住，典型的技术是创建一个新的临时表来包含您的查询结果，并添加一个`IDENTITY`列并生成增量值。请参阅此处讨论此技术的文章： [http ://www.databasejournal.com/features/mssql/article.php/3572301/RowNumber-function-in-SQL-Server-2005.htm](http://www.databasejournal.com/features/mssql/article.php/3572301/RowNumber-function-in-SQL-Server-2005.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T22:26:16.510

使用 SQL 2000，您需要使用相关子查询。

```
 SELECT (
              SELECT COUNT(*)
                FROM PuppyNames b
               WHERE b.Popularity <= a.Popularity
          ) AS Ranking
        , a.Name
     FROM PuppyNames a
 ORDER BY a.Popularity 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-11T22:17:21.597

在客户端应用程序中添加数字通常更容易。SQL 中有一些技巧，但对于纯粹主义者来说，它们涉及作弊，而且它们通常不可移植。

对我来说，这是我最基本的重构模式之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-11T22:35:05.150

您也可以使用临时表来执行此操作：

```
SELECT TOP 3 Name FROM PuppyNames ORDER BY NumberOfVotes DESC 
```

变成

```
CREATE TABLE #RowNumberTable (
    RowNumber int IDENTITY (1,1),
    PuppyName varchar(MAX)
)
INSERT #RowNumberTable (PuppyName)
SELECT TOP 3 Name FROM PuppyNames ORDER BY NumberOfVotes DESC
SELECT * from #RowNumberTable ORDER BY RowNumber
DROP TABLE #RowNumberTable 
```

如果您注意到，您的 SELECT 语句就在其中。它只是被使行号起作用的东西所包围。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-11T22:59:25.287

您可以使用此查询，它考虑到 PK 以便在相同 NumberOfVotes 的情况下提供正确的编号：

```
SELECT TOP 3 COUNT(*) AS Number, p1.Name
FROM PuppyNames AS p1 INNER JOIN PuppyNames AS p2 
    ON p1.NumberOfVotes < p2.NumberOfVotes OR (p1.NumberOfVotes = p2.NumberOfVotes AND p1.ID >= p2.ID)
GROUP BY p1.Name
ORDER BY Number 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T22:22:12.930

SQL 2005、2008：

选择 TOP 3 ROW_NUMBER() OVER(ORDER BY NumberOfVotes DESC) 作为 VoteRank，名称来自 PuppyNames

编辑：对不起 - 刚刚看到你指定 2000。

# .net - SpeechSynthezier.PhonemeReached 事件和控制字符

> ID：282323
> 
> 赞同：2
> 
> 时间：2008-11-11T22:13:38.297
> 
> 标签：.net, speechsynthesizer, speech-synthesis

我正在创建一个小的 silverlight 小部件，它可以发音一个单词并在发音时突出显示每个音节。

作为其中的一部分，我使用[SpeechSynthesizer.PhonemeReached 事件](http://msdn.microsoft.com/en-us/library/system.speech.synthesis.speechsynthesizer.phonemereached.aspx)来确定每个音素的开始和结束时间（作为确定每个音节开始和结束时间的一个步骤）。

奇怪的是，[PhonemeReachedEventArgs.Phoneme 属性](http://msdn.microsoft.com/en-us/library/system.speech.synthesis.phonemereachedeventargs.phoneme.aspx)有时是一个控制字符，至少（但可能不完全是）[U+0004 END OF TRANSMISSION](http://www.fileformat.info/info/unicode/char/0004/index.htm)，包括不是，嗯，传输结束的地方（例如，开始）。

我找不到任何关于这应该意味着什么的文档，有人知道吗？

**编辑**：澄清一下，我没有在 Silverlight 中进行语音合成（因为不支持），我在服务器上进行，并在音频的 HTTP 标头中返回音节边界时间和单词的 IPA 转录回复。我可能根本不应该提到silverlight部分，因为它并不真正相关，我只是没有真正考虑解释上下文。哎呀。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T01:27:42.763

如果您想弄清楚每个音素的开始和结束时间（这确实是一个不同的问题）...尝试使用 PhonemeReachedEventArgs.Duration 属性。开始时间将是“短语的开始时间”+所有先前发音的音素的累积持续时间。结束时间将是“当前音素的开始时间”+当前音素的持续时间。

至于回答您的“已发布”问题，我假设您使用英语作为您的综合语言。在这种情况下，您看到的“字符”很可能实际上是[美式英语音素表](http://msdn.microsoft.com/en-us/library/ms717239(VS.85).aspx)的索引值。您也可能会看到[中文音素](http://msdn.microsoft.com/en-us/library/ms720566(VS.85).aspx)相同，但是[日语音素](http://msdn.microsoft.com/en-us/library/ms720568(VS.85).aspx)具有 unicode 表示，它们都在“控制字符”范围之外。

# multithreading - 我可以阻止垃圾收集器停止我的一些线程吗？

> ID：282327
> 
> 赞同：2
> 
> 时间：2008-11-11T22:14:30.933
> 
> 标签：multithreading, garbage-collection, compact-framework, real-time

是否可以在 Compact Framework 应用程序中阻止垃圾收集器无条件地停止至少一个线程，或者至少在代码的某些部分阻止 GC 收集？

我认为它必须处理设置实时优先级，但我发现很多建议不要这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-11T22:24:51.583

GC 需要冻结所有线程才能检查所有对象。如果某个线程正在运行并且正在修改/创建一个对象，它怎么能完成它的工作？

最好不要这样做。

您可以做的是在您进入不想被中断的状态之前调用 GC.Collect() 和 GC.WaitForPendingFinalizers()。这会给你一些时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-28T16:49:28.520

非托管代码不允许访问未固定的托管对象，但它会在垃圾回收期间无阻塞地运行。如果您有某些例程必须在垃圾收集期间继续运行，并且它们不需要访问未固定的托管对象，那么您可以在非托管代码中编写这些例程并且 GC 不会影响它们。

# programming-languages - 你讨厌你最喜欢的语言的五件事是什么？

> ID：282329
> 
> 赞同：403
> 
> 时间：2008-11-11T22:14:43.663
> 
> 标签：programming-languages, language-agnostic

最近在 Stack Overflow 上出现了一大群 Perl 仇恨，所以我想我应该把我的“[关于你最喜欢的语言的五件事](http://use.perl.org/~brian_d_foy/journal/32556)”的问题带到 Stack Overflow。用你最喜欢的语言，告诉我你讨厌它的五件事。这些可能只是让您烦恼、承认设计缺陷、公认的性能问题或任何其他类别的事情。你只需要讨厌它，它必须是你最喜欢的语言。

不要将它与另一种语言进行比较，也不要谈论你已经讨厌的语言。不要用你最喜欢的语言谈论你喜欢的事情。我只想听听你讨厌但容忍的事情，这样你就可以使用所有其他的东西，我想听听你希望其他人使用的语言。

每当有人试图将他们最喜欢的语言强加给我时，我都会问这个问题，有时作为面试问题。如果有人找不到他最喜欢的工具的五个讨厌的地方，那么他对它的了解还不够充分，无法提倡它或使用它赚大钱。他还没有在足够多的不同情况下使用它来充分探索它。他提倡将其作为一种文化或宗教，这意味着如果我不选择他最喜欢的技术，那我就错了。

我不在乎你使用哪种语言。不想使用特定语言？然后不要。您通过尽职调查做出明智的选择，但仍然不使用它？美好的。有时正确的答案是“你有一个强大的编程团队，拥有良好的实践和丰富的 Bar 经验。换成 Foo 会很愚蠢。”

* * *

这对于代码审查来说也是一个很好的问题。真正了解代码库的人会对它提出各种建议，而不太了解它的人则会有非具体的抱怨。我会问诸如“如果你可以重新开始这个项目，你会做些什么不同的事情？” 在这片梦幻之地，用户和程序员可以抱怨任何他们不喜欢的事情。“我想要一个更好的界面”、“我想将模型与视图分离”、“我会使用这个模块而不是另一个模块”、“我会重命名这组方法”，或者他们真正不需要的任何东西不喜欢现在的情况。这就是我了解特定开发人员对代码库了解多少的方式。这也是一个关于程序员有多少的线索'

仇恨不是弄清楚人们知道多少的唯一维度，但我发现它是一个非常好的维度。他们讨厌的事情也让我知道他们对这个主题的思考程度。

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2008-11-13T13:38:32.870

哇，我很惊讶**SQL**还没有在这里完成。猜猜这意味着没有人喜欢它:)

*   跨实现的语法不一致
*   由于看似模糊的原因，细微的代码差异可能会产生巨大的性能影响
*   对文本操作的支持不佳
*   入门成本低，但掌握语言的学习曲线陡峭
*   整个社区的最佳实践的最小标准化，这包括语法风格。

...还有一些讨厌它的额外理由，无需额外费用

*   WHERE 子句放在最后，很容易过早执行 UPDATE 或 DELETE，从而破坏整个表。相反，WHERE 应该放在前面的某个地方。
*   很难实现关系划分。
*   我可以将一个值设置为 NULL，但我无法测试它是否与 NULL 相等。我可以检查 IS NULL，但这只会使代码复杂化——在我看来，这是不必要的。
*   为什么我们需要完全重新指定 GROUPed 列的公式，而不是在列上设置别名，然后按别名 GROUP BY（或使用 SORT 的列索引）？

* * *

## 回答 #2

> 赞同：182
> 
> 时间：2008-11-24T16:04:07.173

我讨厌 Java 的五件事：

*   没有一流的功能。
*   没有类型推断。
*   例如图形中缺乏健全的默认值。
*   NullPointerException 不包含关于什么是 null 的更多信息。
*   毫无意义的“可配置”框架/服务提供者接口/工厂类/依赖注入系统的激增。几乎从未使用过可配置性，严重违反了 DRY，代码大小翻了四倍，易读性减半。

我知道，我应该看看 Scala。

* * *

## 回答 #3

> 赞同：159
> 
> 时间：2008-11-12T00:26:19.933

**JavaScript**：

1.  所有最酷的东西都是极其复杂的，但是，所有的酷也都被包裹在如此少量的代码中，以至于你为努力遵循它而感到愚蠢

2.  '+' 是弱类型语言中连接运算符的荒谬选择。他们是*想*吓跑菜鸟吗？

3.  这是一个跨浏览器兼容性的雷区（不管它是否已打开）

4.  它通常是不受信任的 - 与诸如阻止后退按钮、永不消失的弹出窗口等垃圾相关。

5.  调试几乎是不可能的，因为只有少数不同的错误消息和几种不同的类型（数字、字符串、对象等）

如果不是 jQuery，我可能仍然会像以前一样讨厌它 :)

* * *

## 回答 #4

> 赞同：148
> 
> 时间：2008-11-11T23:59:12.047

PHP：

1）强迫我做不必要的变量：

```
$parts = explode('|', $string);
$first = $parts[0]; 
```

2) 一个 lambdas 的实现如此蹩脚，它大致相当于使用`eval()`，而且非常错误，我从未使用过它（参见[http://www.php.net/create_function](http://www.php.net/create_function)）。

3) 一个 try/catch 系统，它只能捕获大约 80% 可能发生的错误。

4) Regex 支持与 lambda 支持一样蹩脚，因为它必须写在常规字符串中，这使得最难学习的编程工具之一的难度提高了三倍。PHP应该是一种“简单”的语言？！？！？

5) 如果不编写两次或构建自己的函数或使用“@”运算符，就无法安全地从 $_POST 中提取内容：

```
$x = isset($_POST['foo']['bar']) ? $_POST['foo']['bar'] : null; 
```

6）奖励答案：'@'。如果您不介意正确编写代码，只需添加“@”，这对于以后必须调试代码的任何人来说都太糟糕了。

* * *

## 回答 #5

> 赞同：135
> 
> 时间：2008-11-11T22:41:21.377

C++

*   随机破坏内存并创建几乎不可能找到的错误太容易了（尽管[Valgrind](http://en.wikipedia.org/wiki/Valgrind)在修复这个问题上走了很长一段路）。
*   模板错误消息。
*   使用模板时，很容易最终不得不将所有内容都包含在一个文件中，然后编译时间就会变得愚蠢。
*   标准库在现代是个笑话（默认情况下仍然没有线程或网络？）
*   很多讨厌的 C 代码（特别是 short/int/unsigned/etc 之间的所有转换）

* * *

## 回答 #6

> 赞同：129
> 
> 时间：2008-11-11T22:21:00.967

C#/.NET：

*   默认情况下，类应该是密封的
*   不应该有任何`lock`声明——相反，您应该有特定的锁定对象，并且应该有诸如`Acquire`返回一次性锁定令牌之类的方法。推论：不应该对每个对象都有一个监视器。
*   `GetHashCode()`并且`Equals()`不应该在`System.Object`- 不是所有东西都适合散列。相反，使用which 做同样的事情，`IdentityComparer`并保留`IComparer<T>`、和接口以进行自定义比较。`IComparable<T>``IEqualityComparer<T>``IEquatable<T>`
*   对不变性的支持不佳
*   发现扩展方法的糟糕方式 - 这应该是一个更明智的决定，而不仅仅是我使用命名空间的事实。

这些都是我的想法 - 明天问我，我会想出一个不同的 5 :)

* * *

## 回答 #7

> 赞同：113
> 
> 时间：2008-11-11T22:27:42.187

C

*   字符串操作。

必须手动处理字符串缓冲区是一种容易出错的痛苦。由于如此多的计算确实在移动和修改字符串（计算机并不像人们认为的那样大量用于处理大数字的东西），因此能够使用托管语言或 C++ 的字符串真是太好了处理这些的对象。当我必须在直 C 中进行时，感觉就像在流沙中游泳。

* * *

## 回答 #8

> 赞同：94
> 
> 时间：2009-06-17T05:20:46.963

关于“我讨厌某些语言的事情”列表中我讨厌的五件事怎么样？:D

**5- 涂上橙红色并不代表它是苹果。**

当设计一种语言时，设计者通常会考虑它的用途。将它用于完全不同的事情*可能会*奏效，但是当它不起作用时抱怨只是愚蠢的。以 Python 为例。我敢肯定，总有一天有人会或有人会制作一个实用程序来从 Python 代码创建 exe。为什么在上帝的地球上你会*想*要这样做？它会很整洁——不要误会我的意思——但它没有用。所以别再抱怨了！

一个设计良好的项目可能包含来自多种语言的代码。这并不是说你不能只用一种语言完成一个项目。有些项目可能完全在您使用的任何语言的能力范围内。

**4-你站在木腿上吗？**

该平台可能会对语言的功能产生很大影响。现在的垃圾收集器，甚至帕斯卡早期尝试“垃圾收集”，都可以帮助内存褪色（也许 malloc 更多的内存？？）。计算机速度更快，所以当然，我们对我们的语言有更多期望。坦率地说，我们可能应该这样做。然而，为了方便编译器创建哈希表或字符串或各种其他概念，需要付出巨大的代价。这些东西可能不会继承到使用它们的平台。说它们很容易包含在一种语言中只是告诉我你可能没有一条腿可以站立。

**3-真的是谁的错？**

错误。你知道。我喜欢虫子。为什么我喜欢虫子。因为这意味着我可以保住工作。没有虫子，就会有许多关闭的比萨店。但是，用户讨厌错误。但这里有一点冷水。每个错误*都是*程序员的错。不是语言的。具有如此严格语法的语言将显着减少可能生成的错误数量，这将是一种完全无用的语言。它的能力恐怕只能用一只手来计算。你想要灵活性还是力量？你有错误。为什么？因为你并不完美，你会犯错误。在 C 中举一个真正可识别的例子：

```
int a[10];
for (int idx = 0; idx < 15; idx++) a[idx] = 10; 
```

我们都知道那会发生什么。然而，我们中的一些人可能没有意识到的是......该功能可能非常有益。取决于你在做什么。缓冲区溢出是该功能的成本。上面那个代码。如果我真的向公众发布了它。又是这样……跟我说……“我的错”。不是 C 允许我这样做。

**2-我们不应该把它放在回收站吗？**

用我们不理解的语言指出一个特性是很容易的，因为我们不经常使用它并称它为愚蠢。抱怨它在那里等等。Goto 总是让我开心。人们总是抱怨 goto 是一种语言。但我敢打赌，你的最后一个程序包含了一种 goto。如果您曾经使用过 break 或 continue，那么您就使用过 goto。就是这样。当然，这是一个“安全”的 goto，但它就是这样。Goto 有它们的用途。是使用“隐式” goto（如 continue 或 break）还是使用显式 goto（对任何语言使用实际关键字“goto”）。并不是说语言开发人员是完美无缺的，而是通常......如果功能从一开始就存在（对于该语言）。这方面可能是该语言的决定性品质。意思是..它' s 正在使用，并且由于向后兼容性而可能不会闲逛。今天正在使用它。就像 5 分钟前一样。并且使用得当。好吧..可以说有人也在不正确地使用它，但这与我列表中的#3有关。

**1\. - 一切都是对象。**

好的..这个真的是#2的一个子集。但这是迄今为止我在仇恨列表中看到的最烦人的抱怨。并非一切都是对象。有很多概念不属于或不需要成为对象。把东西放在不属于它们的地方是丑陋的，并且会降低程序的效率。当然。可能并不多，取决于语言。这也与#5 有关。这意味着……是的。全局正常。与静态方法相对的功能是可以的。将 OO 编程与全局函数相结合是可以的。现在..这并不意味着我们都应该出去并从它的对象模型中“释放”我们的代码。在设计一段代码或整个项目时，幕后发生了什么*应该*放在一起的时候要考虑。不仅是这个概念所在的地方，还有许多其他因素。如果全局函数无用，为什么还要在类或命名空间概念中包装全局函数？取静态成员变量。这让我很开心，因为……嗯……当然取决于语言和实现，但一般来说，你只是声明了一个全局变量。是的，有一些理由将这些非 OO 概念包装在 OO 包装器中。其中之一当然是自我记录的代码。这是有道理的。所以..就像我说的。不要出去“释放”你的代码。但是任何好的现代语言都会在它的面向对象建模之外有一个全局概念。是的，我特别想指出，没有全局概念的 OO 编程语言很可能存在严重的设计缺陷。再次虽然.. 取决于语言的意图和设计，所以我不想选择任何特定的语言，这里有太多的分析。任何人，考虑代码应该放在哪里并且是最有效的。在不增加功能或支持的东西上添加一堆闪光只会更快地磨损键盘。这对任何人都没有好处。好吧..除非你喜欢那个可能错误地告诉你一切都是对象的人的布朗尼点。

简而言之，编程不仅仅是盲目地敲击键盘。任何项目都有很多设计考虑。我知道这是陈词滥调，但你必须从各个角度看待它。即使是现在的类型安全语言。你不只是扔掉代码并期望它运行良好。当然..它可能有效，但它可能不是正确的方法。总体而言，选择最适合特定工作和环境的语言和格式。但*没有*一种语言能带走它背后的思想。如果你不思考.. 你只是在打字。

* * *

## 回答 #9

> 赞同：88
> 
> 时间：2008-11-11T22:38:59.400

我讨厌**Java**（目前是我最喜欢的语言）的五件事，排名不分先后。

1.  尽管我是 Java 泛型的粉丝，但它的设计方式却产生了很多奇怪之处。因此，泛型存在无数恼人的限制（其中一些是类型擦除的结果）。
2.  Object.clone() 和 Cloneable 接口的工作方式完全被破坏了。
3.  Sun 没有走大路，将一切都变成对象（a.la. SmallTalk），而是创建了两种不同类别的数据类型：对象和原语。结果，现在有*两种*表示基本数据类型和奇怪的好奇心，例如装箱/拆箱和不能将原语放入集合中。
4.  Swing 太复杂了。不要误会我的意思：Swing 可以做很多很酷的事情，但它是过度设计的一个很好的例子。
5.  这最后的抱怨同样是 Sun 和那些为 Java 编写 XML 库的人的错。Java XML 库太复杂了。为了简单地读入 XML 文件，我经常不得不担心我使用的是什么解析器：DOM 还是 SAX？每个 API 都同样令人困惑。语言的本机支持用于**轻松**解析/编写 XML 会非常好。
6.  java.util.Date 糟透了。它不仅不必要地复杂，而且所有**有用**的方法都已被弃用（并被其他增加复杂性的方法所取代）。

* * *

## 回答 #10

> 赞同：73
> 
> 时间：2008-11-11T23:29:13.840

**Ruby**有很多与速度有关的缺陷，但我并不讨厌这些。它也存在社区布道过度的缺陷，但这并没有真正困扰我。这些是我讨厌的：

*   闭包（块）有 4 种不同的创建语法，它们都不是最优的。优雅的语法是不完整的，并且与散列有歧义，完整的语法是丑陋的。
*   社区倾向于反对真实的文档，倾向于“阅读代码”。我觉得这既幼稚又懒惰。
*   元编程滥用，特别是在库中，使错误成为追踪的噩梦。
*   与此相关的是，普遍的元编程使得一个全面的 IDE 变得困难，如果不是不可能的话。
*   将块传递给函数的方式很愚蠢。没有理由将块传递到参数列表之外，或者具有奇怪的特殊语法来访问（yield）。我认为块应该被赋予一个不那么模棱两可的语法（或者哈希可以使用不同的分隔符；也许是 <> 而不是 {}），并且作为参数传递给方法应该就像所有其他参数一样。

    ```
    object.method(1, {|a| a.bar}, "blah") 
    ```

    这些奇怪的东西，比如块必须是传递的最后一个参数，并且传递多个块与更长的语法不同，真的让我很恼火。

* * *

## 回答 #11

> 赞同：72
> 
> 时间：2008-11-12T01:10:28.473

## Perl

*   符号的混合使用

    ```
    my @array = ( 1, 2, 3 );
    my $array = [ 4, 5, 6 ];

    my $one  = $array[0]; # not @array[0], you would get the length instead
    my $four = $array->[0]; # definitely not $array[0]

    my( $two,  $three ) = @array[1,2];
    my( $five, $six   ) = @$array[1,2]; # coerce to array first

    my $length_a = @array;
    my $length_s = @$array;

    my $ref_a = \@array;
    my $ref_s = $array; 
    ```

    *   例如，这些**都不**相同：

        ```
        $array[0]   # First element of @array
        @array[0]   # Slice of only the First element of @array
        %array[0]   # Syntax error
        $array->[0] # First element of an array referenced by $array
        @array->[0] # Deprecated first element of @array
        %array->[0] # Invalid reference
        $array{0}   # Element of %array referenced by string '0'
        @array{0}   # Slice of only one element of %array referenced by string '0'
        %array{0}   # Syntax error
        $array->{0} # Element of a hash referenced by $array
        @array->{0} # Invalid reference
        %array->{0} # Deprecated Element of %array referenced by string '0' 
        ```

    `Perl6`里面[写着](http://dev.perl.org/perl6/doc/design/syn/S09.html)：_

    ```
    my @array = ( 1, 2, 3 );
    my $array = [ 4, 5, 6 ];

    my $one  = @array[0];
    my $four = $array[0]; # $array.[0]

    my( $two,  $three ) = @array[1,2];
    my( $five, $six   ) = $array[1,2];

    my $length_a = @array.length;
    my $length_s = $array.length;

    my $ref_a = @array;
    my $ref_s = $array; 
    ```

*   缺乏真正的OO

    ```
    package my_object;
    # fake constructor
    sub new{ bless {}, $_[0] }
    # fake properties/attributes
    sub var_a{
      my $self = shift @_;
      $self->{'var_a'} = $_[0] if @_;
      $self->{'var_a'}
    } 
    ```

    `Perl6`里面[写着](http://dev.perl.org/perl6/doc/design/syn/S12.html)：_

    ```
    class Dog is Mammal {
        has $.name = "fido";
        has $.tail is rw;
        has @.legs;
        has $!brain;
        method doit ($a, $b, $c) { ... }
        ...
    } 
    ```

*   设计不佳的正则表达式功能

    ```
    /(?=regexp)/;           # look ahead
    /(?<=fixed-regexp)/;    # look behind
    /(?!regexp)/;           # negative look ahead
    /(?<!fixed-regexp)/;    # negative look behind
    /(?>regexp)/;           # independent sub expression
    /(capture)/;            # simple capture
    /(?:don't capture)/;    # non-capturing group
    /(?<name>regexp)/;      # named capture
    /[A-Z]/;                # character class
    /[^A-Z]/;               # inverted character class
    # '-' would have to be the first or last element in
    # the character class to include it in the match
    # without escaping it
    /(?(condition)yes-regexp)/;
    /(?(condition)yes-regexp|no-regexp)/;
    /\b\s*\b/;              # almost matches Perl6's <ws>
    /(?{ print "hi\n" })/;  # run perl code 
    ```

    `Perl6`里面[写着](http://dev.perl.org/perl6/doc/design/syn/S05.html)：_

    ```
    / <?before pattern>  /;   # lookahead
    / <?after pattern>   /;   # lookbehind
    / regexp :: pattern  /;   # backtracking control
    / ( capture )        /;   # simple capture
    / $<name>=[ regexp ] /;   # named capture
    / [ don't capture ]  /;   # non-capturing group
    / <[A..Z]>           /;   # character class
    / <-[A..Z]>          /;   # inverted character class
    # you don't generally use '.' in a character class anyway
    / <ws>               /;   # Smart whitespace match
    / { say 'hi' }       /;   # run perl code 
    ```

*   缺乏多重派送

    ```
    sub f(   int $i ){ ... }  # err
    sub f( float $i ){ ... }  # err
    sub f($){ ... } # occasionally useful 
    ```

    `Perl6`里面[写着](http://dev.perl.org/perl6/doc/design/syn/S06.html)：_

    ```
    multi sub f( int $i ){ ... }
    multi sub f( num $i ){ ... }
    multi sub f( $i where $i == 0 ){ ... }
    multi sub f(     $i ){ ... } # everything else 
    ```

*   运算符重载不佳

    ```
    package my_object;
    use overload
      '+' => \&add,
      ...
    ; 
    ```

    `Perl6`里面[写着](http://dev.perl.org/perl6/doc/design/syn/S13.html)：_

    ```
    multi sub infix:<+> (Us $us, Them $them) |
                        (Them $them, Us $us) { ... } 
    ```

* * *

## 回答 #12

> 赞同：57
> 
> 时间：2008-11-11T23:02:02.240

我有时会按照我喜欢的方式来做**PHP**，而 Python 会做得太多。

*   没有命名空间；一切都在一个非常大的命名空间中，这在更大的环境中是地狱

*   在函数方面缺乏标准：数组函数将针作为第一个参数，干草堆作为第二个参数（参见[array_search](http://ca3.php.net/manual/en/function.array-search.php)）。字符串函数通常先是大海捞针，其次是针（参见 [strpos](http://ca3.php.net/manual/en/function.strpos.php)）。其他函数只是使用不同的命名方案： [bin2hex](http://ca3.php.net/manual/en/function.bin2hex.php)、[strtolower](http://ca3.php.net/manual/en/function.strtolower.php)、 [cal_to_jd](http://ca3.php.net/manual/en/function.cal-to-jd.php)

    一些函数的返回值很奇怪，超出了正常范围：这迫使您突然声明第三个变量，而 PHP 可以通过其类型杂耍有效地将空数组解释为 false。几乎没有其他功能可以做到这一点。

    ```
    $var = preg_match_all('/regexp/', $str, $ret);
    echo $var; //outputs the number of matches 
    print_r($ret); //outputs the matches as an array 
    ```

*   该语言（直到 PHP6）尽最大努力尊重近乎延迟的向后兼容性，使其在不需要时携带不良做法和功能（参见 [mysql_escape_string](http://ca3.php.net/manual/en/function.mysql-escape-string.php)与 [mysql_real_escape_string](http://ca3.php.net/manual/en/function.mysql-real-escape-string.php)）。

*   该语言从模板语言演变为全后端语言。这意味着任何人都可以在他们想要的时候输出任何东西，并且它会被滥用。您最终会使用模板语言的模板引擎...

*   它在导入文件时很糟糕。你有 4 种不同的方法来做（包括、include_once、require、require_once），它们都很慢，非常慢。事实上，整个语言都很慢。至少，从我收集的数据来看，它比 python（即使使用框架）和 RoR 慢得多。

不过，我仍然喜欢 PHP。这是 Web 开发的电锯：您想要一个中小型网站真正快速完成并确保任何人都可以托管它（尽管配置可能不同）？PHP 就在那里，它无处不在，只需 5 分钟即可安装完整的 LAMP 或 WAMP 堆栈。好吧，我现在要回去使用 Python 了……

* * *

## 回答 #13

> 赞同：50
> 
> 时间：2008-11-11T22:31:21.350

以下是我不喜欢 Java（这不是我最喜欢的语言）的一些地方：

*   泛型类型擦除（即没有具体化的泛型）
*   无法在单个 catch 块中捕获多个（不同类型的）异常
*   缺少析构函数（finalize() 是一个非常糟糕的替代品）
*   不支持闭包或将函数视为数据（匿名内部类是非常冗长的替代品）
*   一般的检查异常，或者更具体地说，检查不可恢复的异常（例如 SQLException）
*   没有对文字集合的语言级支持
*   调用泛型类的构造函数时没有类型推断，即类型参数必须在“=”的两侧重复

* * *

## 回答 #14

> 赞同：40
> 
> 时间：2008-11-11T22:26:42.467

**C++**

1.  模板语法
2.  钻石继承问题
3.  现代语言所拥有的标准库过多/缺乏（尽管提升很接近）。
4.  IO 流
5.  围绕 IOStreams 使用的语法

**Python**

1.  空间是有意义的（有时）
2.  带下划线的关键字
3.  有限的线程支持（至少目前）
4.  “自我”而不是“这个”
5.  空间是有意义的（有时）

* * *

## 回答 #15

> 赞同：37
> 
> 时间：2008-11-12T03:01:42.833

**Objective-C**

1）没有命名空间，只有手动命名约定——我不介意类分离，但我确实想念能够在一行中导入命名空间中的所有类定义（比如 import com.me.somelibrary. *)。

2) 图书馆在 RegEx 支持等重要领域仍有一些漏洞。

3) 属性语法有点笨拙，需要三行（在两个单独的文件中）来声明一个属性。

4）我喜欢保留/释放模型，但它比释放引用然后意外使用它要容易。

5）虽然不是真正的语言功能，但 Xcode 与 Objective-C 的使用如此交织在一起，我不禁想到这方面......基本上是自动完成，非常不确定。它更像是一个系统，奖励你找到你想要的东西，然后将其作为选择呈现。但后来我想我从来不喜欢自动完成引擎。

* * *

## 回答 #16

> 赞同：36
> 
> 时间：2008-11-15T10:35:47.840

C++

*   **字符串。**
    它们不能与平台字符串互操作，因此您最终会使用 std::vector 一半的时间。未定义复制策略（写入时复制或深度复制），因此无法为简单的语法提供性能保证。有时他们依赖于使用起来不是很直观的 STL 算法。太多的库自己推出，不幸的是使用起来更舒服。除非你必须将它们结合起来。

*   **各种字符串表示**
    现在，这是一个平台问题——但我仍然希望，如果更早提供不那么顽固的标准字符串类，情况会更好。我经常使用以下字符串表示形式：

    *   通用 LPCTSTR，
    *   由 CoTaskMemAlloc 分配的 LPC(W)STR，
    *   BSTR, _bstr _t
    *   （w）字符串，
    *   字符串，
    *   标准::向量
    *   一个滚动我自己的类（*sigh*），它将范围检查和基本操作添加到已知长度的 (w)char * 缓冲区
*   **建立模型。**
    我厌倦了花时间在谁包含什么、前向声明、优化预编译头文件和包含以保持至少可以承受的增量构建时间等问题上。这在八十年代很棒，但现在呢？打包一段代码要重用它有很多障碍，以至于即使是妈妈的狗也会厌倦听我说话。

*   **难以解析**
    这使得外部工具特别难以编写和正确。而今天，我们 C++ 人主要缺乏工具链。我喜欢我的 C# 反射和委托，但我可以没有它们。没有伟大的重构，我不能。

*   **线程太难了**
    语言甚至不承认它（现在），编译器的自由——虽然很好——是痛苦的。

*   **静态和按需初始化** 从技术上讲，我在这里作弊：这是“包装代码以供重用”中的另一个难题：仅在需要时才初始化某些东西是一场噩梦。所有其他 redist 问题的最佳解决方案是将所有内容都放入标题中，这个问题说“neeener - 你不能”。

* * *

诚然，其中很多都超出了严格的语言范围，但 IMO 整个工具链都需要进行判断和发展。

* * *

## 回答 #17

> 赞同：35
> 
> 时间：2008-12-07T02:16:16.903

**JavaScript**：

*   `Object`原型可以修改。程序中的每个对象都会获得新属性，并且可能会出现问题。

*   所有对象都是哈希映射，但很难安全地使用它们。特别是，如果您的其中一个键恰好是`__proto__`，那么您就有麻烦了。

*   在函数引用时没有对象关闭。事实上，根本没有对象闭包——相反，`this`每当使用对象表示法或运算符调用函数时，都会设置对象闭包`new`。导致很多混乱，特别是在创建事件回调时，因为`this`没有设置为程序员所期望的。

    *   推论：调用*没有*对象表示法或`new`运算符的函数导致`this`设置为等于全局对象，从而导致大量损坏。
*   加法运算符重载以执行字符串连接，尽管这两个操作根本不同。当您期望是数字的值实际上是字符串时，会导致痛苦。

*   `==`和`!=`运算符执行类型强制。不同类型之间的比较涉及一个凡人无法完整记住的规则列表。`===`和运算符的存在减轻了这种情况`!==`。

*   两者都`null`存在`undefined`，具有微妙不同但多余的含义。为什么？

*   用于设置原型链的奇怪语法。

*   `parseInt(s)`需要一个 C 样式的数字，因此将带有前导零的值视为八进制等。您至少可以，`parseInt(s, 10)`但默认行为令人困惑。

*   没有块范围。

*   可以多次声明同一个变量。

*   可以使用变量而不声明它，在这种情况下它是全局的并且可能会破坏你的程序。

*   `with { }`.

*   **使用 JavaDoc 之类的工具真的**很难记录。

* * *

## 回答 #18

> 赞同：34
> 
> 时间：2008-11-11T22:31:35.983

Python：

*   缺乏静态类型
*   默认参数处理（特别是您可以为未来的调用者[*更改*默认参数的事实！）](https://stackoverflow.com/questions/146329/what-is-the-worst-gotcha-youve-experienced#147877)
*   需要的下划线太多（必须调用构造函数`__init__`）
*   缺乏适当的私有成员和函数（约定只是说大多数以下划线开头的东西都是私有的，除了所有类似的东西`__getattr__`不是）
*   ing 到文件的有趣语法`print`（但他们正在 Python 3 中修复）

* * *

## 回答 #19

> 赞同：32
> 
> 时间：2008-12-22T05:36:30.717

**C＃**

*   我希望我可以`switch()`在任何类型上，那`case`可以是任何表达方式。

*   不能将对象初始化器语法与“只读”字段/`private set`自动属性一起使用。一般来说，我需要语言帮助来制作不可变类型。

*   用于**命名空间**`{}`、类**和**方法**以及**属性**/索引器块**和**多语句块**和**数组初始**值设定项。当它们相距很远或不匹配时，很难弄清楚你在哪里。

*******   我讨厌写作`(from x in y ... select).Z()`。我不想回退到方法调用语法，因为查询语法缺少一些东西。

    *   我想要一个`do`关于查询语法的子句，就像`foreach`. 但这并不是一个真正的查询。****** 

 ******我真的到了这里。我认为 C# 很棒，而且很难找到很多损坏的地方。

* * *

## 回答 #20

> 赞同：26
> 
> 时间：2008-11-13T14:37:57.510

**PHP**

1.  如果您不控制服务器，则没有调试功能，即使那样它们也很烂
2.  大量的糟糕的 PHP 代码让所有 PHP 程序员名声扫地
3.  函数命名不一致
4.  如果我想要一个静态类型变量，就无法拥有一个（我 90% 的时间都是动态类型的忠实粉丝）
5.  REGISTER_GLOBALS 是魔鬼

* * *

## 回答 #21

> 赞同：25
> 
> 时间：2008-11-11T22:38:47.593

C（好吧，这不是我最喜欢的，但还没有完成。）

*   套接字库语法。
*   没有函数重载。
*   C 风格的字符串。
*   缓冲区溢出。
*   神秘的语法。不知道有多少次，我查过atoi之类的东西，拍了拍我的额头，喊道：“当然！”

编辑：如果我使用更多的库代码，我可能会想出更多（就像我对套接字所做的那样，但那些特别糟糕），但我已经觉得我在欺骗 C。这么多语言的存在只是为了接受C 的好的部分并替换掉坏的部分，这有点像打死马。

* * *

## 回答 #22

> 赞同：24
> 
> 时间：2008-11-11T22:50:52.140

普通 Lisp：

1.  关键字通常过于冗长。
2.  图书馆的支持很可怜。
3.  在想要更严格地处理内存的操作系统中效果不佳。
4.  没有与操作系统交互的良好设施。
5.  “循环”设施没有很好的定义，而且看起来不像 Lispy。

* * *

## 回答 #23

> 赞同：24
> 
> 时间：2010-05-26T06:33:28.197

**脑筋急转弯**

*   你的亮点是你是*图灵完备*的？！我可以在 Perl 正则表达式中做更多事情！

*   缺少对象。来吧，人们！就像，*你好*...

*   没有网络库。我只想抓取一个网页，天哪。

*   没有一流的功能。恭喜——你开始同情你的 Java 朋友了。

*   用于存储的无限磁带，仅此而已。这太自命不凡了，我们还不如写 Lisp。

* * *

## 回答 #24

> 赞同：23
> 
> 时间：2008-11-11T23:44:18.833

**JavaScript**

1.  数字作为字符串 - 当数字被解释为字符串时，数学可能会令人沮丧。5 + 2 = 52？呃……
2.  权限 - 所有最好的东西都需要用户的许可！
3.  屏幕更新 - 浏览器必须处于稳定状态才能更新屏幕。似乎没有办法强制屏幕在脚本中间更新。
4.  慢 - 虽然谷歌的 Chrome 很好......
5.  浏览器的差异使使用该语言成为 [审查]。

* * *

## 回答 #25

> 赞同：20
> 
> 时间：2008-11-11T22:32:36.683

PHP：

*   人们永远无法确定某些*几乎常见*的扩展在所有网络服务器上都可用。
*   试图成为未来的一切（goto，闭包，...）
*   没有经验的用户面临许多安全风险
*   更多的运算符重载会很好
*   所有不学习如何使它正常工作的可怜程序员，并给它一个坏名声

尽管如此，PHP 是*（*脚本）语言。;-)

* * *

## 回答 #26

> 赞同：18
> 
> 时间：2008-11-12T03:54:41.697

VB6

1.  仅限窗户。
2.  不再支持。
3.  数组可以从任意数字开始，而不是全部归一化为 0。
4.  编译的应用程序依赖于许多 dll 才能正常运行。
5.  当您运行未编译的代码时，许多复杂的控件（如浏览器控件或复杂的代码片段）往往会破坏 IDE，但在编译后却可以正常工作。

* * *

## 回答 #27

> 赞同：18
> 
> 时间：2008-11-13T00:09:46.020

Ruby 是我最喜欢的语言，以下是我不喜欢的语言：

*   绿色线程 + 阻塞 C 库 = 巨大失败
*   非常缓慢
*   标准库本身与它的 bang 使用不一致！方法
*   模块包含 + 扩展很乱。
*   “开放类”不能限定范围 - 我想添加一个 String#dostuff，但我不希望它泄漏到所有第三方库中
*   没有二进制部署打包解决方案。

* * *

## 回答 #28

> 赞同：17
> 
> 时间：2008-11-11T22:44:07.003

德尔福：

*   IDE有点不稳定。
*   代码洞察力有时会令人困惑。
*   调试有时是错误的。
*   更新多个项目文件可能很麻烦。
*   如果在一个或多个包不可用时启动，则会多次弹出错误消息。

* * *

## 回答 #29

> 赞同：16
> 
> 时间：2008-12-07T15:19:00.240

**JavaScript**

*   每个脚本都在一个全局“命名空间”中执行......在使用来自不同来源的脚本时必须注意这一点

*   如果使用了变量但事先没有定义，则认为它是全局变量

*   浏览器供应商随心所欲地制定标准，使我们开发人员使用如此优美的语言进行编码比应有的困难

*   区分大小写 - 考虑到没有像样的 IDE 用于开发带有编译时检查的 js

*   变通方法（例如使用`hasOwnProperty`方法）来执行一些原本简单的操作。

* * *

## 回答 #30

> 赞同：15
> 
> 时间：2008-11-12T01:25:07.320

哈斯克尔：

1.  惰性求值导致空间泄漏。
2.  数字层次结构不是根据数学抽象构造的。
3.  严格的 monadic IO 会使调试变得更加困难。
4.  大型实现以与标准不太兼容的方式处理 I/O。（特别是，输出字符只输出低 8 位——然后构建使用此假设进行二进制 I/O 的代码。Ick。）
5.  `($)`可以更改运算符的关联性以使某些表达式更漂亮。

其中大多数都没有上升到仇恨的程度，并且有人试图为每一个修复或构建可靠的解决方法。

编辑：关于第 5 点有一些混淆。特别是有些人似乎认为我的意思是论点的顺序，我不是。我不会解释我的意思，而是将人们指向以下链接，[http://hackage.haskell.org/trac/haskell-prime/wiki/ChangeDollarAssociativity](http://hackage.haskell.org/trac/haskell-prime/wiki/ChangeDollarAssociativity)，它很好地表达了它。

* * *

## 回答 #31

> 赞同：13
> 
> 时间：2008-11-11T22:48:39.803

短暂聊天

*   我不想再用 java、delphi、c# 或 ruby​​ 进行开发（这是不切实际的，因为我公司的主要开发语言是 c#、delphi 和 java）。
*   从左到右的评价。
*   有类注释但没有方法注释（至少在 Squeak 中）
*   没有真正的标准库，细节差异很大
*   缺乏命名空间

* * *

## 回答 #32

> 赞同：13
> 
> 时间：2009-04-09T16:23:32.147

我知道我迟到了，但仇恨是永恒的！

**爪哇**

*   **运行时.exec()。** 那么，如果我不手动清除 STDOUT 和 STDERR 缓冲区，我的代码会挂起吗？哇。去死吧，请。
*   **空指针异常。** 负责任的编程意味着我必须将大多数对象视为未爆炸的炸弹，这在面向对象的语言中有点令人讨厌。当不可避免的事情发生时，我有点需要知道*哪个*物体在我的脸上爆炸了，但 Java 显然觉得告诉我会作弊。
*   **文件 I/O。** 为什么我必须跳过这么多圈才能阅读一个当当的文本文件？并且在复制文件时，我必须将源文件汇集到我的代码中并手动处理输出字节缓冲区？你是认真的吗？
*   **基元与基元包装器。** 请注意，Java 现在有许多特性允许您在某些地方将原语及其包装对象视为可互换的，但在其他地方则不能；别担心，编译器会让你知道哪个是哪个。这感觉像是解决一个根本性破坏性设计决策的黑客行为。它是。（**编辑：** 实际上，编译器的安全网比我想象的要糟糕得多，尤其是在进行相等检查时。如果 `a` 和 `b` 是整数，则只有在至少其中一个是`int`类型。如果它们都是`Integer`类型，那么只有当两个数字在-128和127之间时，该语句才会执行您的想法。`Integer a = 1000; Integer b = 1000 ; return a == b;` 将返回 `false`。真的。）
*   **XML。** 我有这个非常简单的小 XML 文件需要创建，我必须做*什么？*

* * *

## 回答 #33

> 赞同：12
> 
> 时间：2009-01-09T16:25:59.333

## 卢阿

我喜欢这种语言，但有些事情让我困扰多年！

*   不（内置）支持二进制操作（从 5.1 开始，它可能与 5.2 一起提供）。
*   应该有一个内置的二进制缓冲区实现，例如允许长字符串连接。
*   我知道它不太适合语法，但有时我会想念 longVariableName++ 或 verboseVariableName += 5。
*   参考假设 C 的知识（我有，但它对新手来说是一个减号）并推迟对 C 参考的一些帮助！有时它太简洁了。
*   它开始拥有大量的图书馆，但你必须从不同的地方获取它们。另一方面，下载量非常小！;-)

* * *

## 回答 #34

> 赞同：11
> 
> 时间：2008-11-13T13:00:22.557

VB.NET

*   行为`AndAlso`/`OrElse`和`And`/`Or`似乎倒退了。也许他们应该被交换。
*   `When`只能用于异常捕获。做`When`有条件的能力对于其他一些事情会很好。
*   VS IDE 中没有 friggin 重构（实际上不是语言的错），就像 C# 一样
*   `Not <obj> Is Nothing`. 是的，这已被 纠正`IsNot`，但由于某种原因，我看到它`Not Is`被使用得太频繁了。（我更经常看到将英语作为第二语言的开发人员，从这个角度看是否更有意义？）
*   它不需要`()`on`ToString()`和 most 功能。（导致草率的编码习惯）
*   `_`断线时必须做的事情。
*   它允许可选参数。（导致草率的编码习惯）
*   声明一个数组是`UpperBound`由容量而不是容量完成的。“Dim arr(2) as String”实际上将包含 3 个元素。
*   具有`=`比较*和*赋值运算符。

* * *

## 回答 #35

> 赞同：11
> 
> 时间：2008-11-26T19:26:10.480

# Python

*   1-3：打包/构建/文档系统没有*一个明显*的选择（例如 Perl 的`cpan`，`POD`或 Ruby 的`gem`，，，`rake`）`rdoc`。

*   4：Python 3.0 不够兼容，以至于每个 Python 项目都需要两个源分支（2.x 和 3.x）。但是 Python 3.0 的兼容性并*不足以*证明它的合理性。大多数 py3k 的优势都太微妙了。

*   5：Jython、IronPython、CPython 不兼容。

* * *

## 回答 #36

> 赞同：10
> 
> 时间：2009-05-27T04:25:07.077

**客观凸轮**

1.  *非并发垃圾收集器。* 我可以整天编写多线程程序，但它们一次只能获得我的八个内核中的一个。这让我很难过。

2.  *没有类型类（或它们的道德等价物）。* 有 Furuse-san 的[GCaml](http://web.yl.is.s.u-tokyo.ac.jp/~furuse/gcaml/)，但它 A) 不如类型类好，并且 B) 不在 INRIA 发行版中。

3.  *急需一座可可桥。* 严重地。如果我写更多的代码与基于 DNA 的生命形式的实际接口，那么我可能会分解并自己编写该死的东西。为什么其他人还没有这样做？

4.  *函子是可恶的。* 说真的，模块应该是一流的价值。应该只有一种功能。在你为此激怒我之前，请阅读[蒙塔古和雷米。](http://gallium.inria.fr/~montagu/publications/2009/talks/slides@popl09:fzip.pdf)

5.  *应该使用 LLVM 作为其后端。* 我必须杀死谁才能让 OCaml 为我愚蠢的小 ARM6 内核编译？

所以，是的，我有一些问题。我仍然喜欢这种语言。这太棒了。

* * *

## 回答 #37

> 赞同：9
> 
> 时间：2008-11-11T23:03:05.267

VBA（包括 MS Office IDE）：

1) 糟糕的文档
2) 糟糕的错误消息
3) 不充分的数组操作例程
4) 必须为 DIM 语句重复类型
5) 不会彩色打印（必须购买第 3 方插件）

* * *

## 回答 #38

> 赞同：9
> 
> 时间：2009-06-16T13:27:33.883

**我自己的前 5 名“我在 C++ 中真正讨厌什么”：**

[5] 自动生成构造函数、析构函数和赋值运算符。伙计，每当我没有在课堂上声明某些东西时，就意味着*我不需要它*，而不是*我忘记了它*。你们，编译器，听到了吗？！

[4] 模板语法。哦，每当我决定从类主体中提取定义时，我真的需要输入所有这些“<”和“>”吗？

[3] 字符串。天哪，我受够了“const char*”，我必须处理 NULL 情况，我必须浪费 O(N) 来获得它的长度，我必须为 concat 操作分配一个缓冲区。

[2] 宏处理。每当我不明白我的编译器发生了什么时，我就会开始寻找一个宏。

[1] 运算符重载。我看到代码“A + B * C”，在看到 A、B 和 C 的实际类型之前，我无法说出这段代码的含义。

* * *

## 回答 #39

> 赞同：8
> 
> 时间：2008-11-14T00:59:57.003

Delphi（又名 Object Pascal），我将讨论本机版本，而不是 .NET。

*   变量块！
*   该语言中的接口在设计时考虑了 COM 的使用——因此比 C# 或 Java 中的接口更复杂。IE。除非您明确禁用它，否则涉及引用计数。
*   不`try except finally end;`
*   对象创建过于明确：

    ```
    var obj: TMyObject;
    ...
    obj := TMyObject.Create;
    try
      ...
    finally
      obj.Free;
    end; 
    ```

取而代之的是

```
auto obj: TMyObject; // compiler adds the default constructor call and the destructor call in a try/finally block. 
```

*   好的，语言太好了，我真的想不出更多了，所以我在这里推自己：字符串，整数..或枚举等内置类型最好有方法。IE。`i.ToString`而不是`IntToStr(i)`.

* * *

## 回答 #40

> 赞同：7
> 
> 时间：2009-01-12T00:47:42.737

卢阿：

*   我明白其中的原因，但很认真。默认情况下，变量应该是本地的，带有`global`关键字，反之亦然。
*   我一般不是 do/end 样式语义的忠实粉丝。我更喜欢 C 风格的大括号。
*   动态类型。我知道，你们中的一些人会说“嗯？” 但是我完全被给定变量中确切的数据类型所宠坏了。恒定`if (type(var) == "string") then stuff() end`是一种痛苦。
*   变量在使用之前不需要定义。我宁愿明确说明我正在尝试做的事情，也不愿冒一个错字导致我喜欢称之为“古怪的豆子”的风险。

PHP：

*   再次，动态类型。
*   缺乏关闭。我知道，你可以做到，`$function($arg);`但这不算数。
*   同样，变量可以在定义之前使用。我有一个个人策略，即在使用任何变量之前始终将其显式初始化为已知值，并且我将其扩展到我可以控制的任何最佳实践文档。

C/C++：

*   标题 = 颈部疼痛。
*   不支持闭包。（我对拥有它们的 C++0x 感到兴奋。）
*   静态类型。“等等，”你说。“你刚才说你不喜欢动态打字！” 是的，我确实说过。但是静态类型也可能会让人头疼。（如果有选择，我仍然会选择静态类型。）最理想的情况是，我想要一种默认为静态类型的语言，但也支持动态类型。（我还想要一匹小马，500 亿美元，还有全世界，拜托。）

* * *

## 回答 #41

> 赞同：7
> 
> 时间：2009-01-12T00:50:58.253

红宝石：

1.  真他妈慢
2.  自负社会
3.  这不是小事
4.  在 nil 上调用方法而不是仅仅返回 nil à la Objective C 时出错
5.  非原生线程

* * *

## 回答 #42

> 赞同：7
> 
> 时间：2009-05-28T09:21:41.607

**C**

1.  **没有参数多态性**（即 C++ 模板）。它使编写可重用的数据结构和算法变得很痛苦（并且几乎没有任何静态检查）。例如，参见 qsort 和 bsearch 的比较器参数：比较器采用 void 指针:(
2.  **没有数据结构库**。我真的很讨厌编写自己的哈希表。我也非常讨厌在网上搜索可重用数据结构库。特别是如果它被证明是不完整的。
3.  **字符串**。低效的表示，如果你让它理智起来就很笨拙，很难安全地输入一个字符串。没有标准`snprintf`。用 来创建格式字符串太难了`sprintf`，然后用它以`sprintf`安全的方式再次创建字符串。
4.  **只有词法宏**。如果不同的编译器在不同的地方期望函数注释，我必须`HAS_NO_SIDE_EFFECTS`在不同的地方放同样的。为什么不能直接抓取函数，切换编译器类型，然后通过宏调用将其插入到正确的位置？
5.  **没有通用功能的可移植库**。对于套接字和线程，我使用 SDL ——一个非常有趣的*游戏*库。对于 .ini 样式的解析器，我能找到的唯一一个为 ubuntu 打包的库，我在每日 wtf 上发布（它计算一个哈希值数组，然后对其进行线性扫描......）

**C++**

1.  **模板语法笨重且笨重**。让我们看看，`for(map<string, int>::const_iterator it = mymap.begin(); it != mymap.end(); ++it)`。
2.  **STL 中的设计错误**。改变向量的分配策略真的应该改变它的*类型*吗？
3.  **过于复杂的类型系统**。类型 T1 有一个 convert-to-T2 方法，而 T2 有一个隐式的 from-T1 构造函数。这就是所谓的？重载、覆盖和多重继承如何交互？可怜，我猜...
4.  **来自模板的令人难以置信的冗长和笨拙的错误消息**。你知道我的意思...
5.  **引用意味着您在调用站点看不到输出参数**。在 C 语言中，您可以猜测什么`foo(bar, &baz)`可以修改，什么不能修改。

* * *

## 回答 #43

> 赞同：6
> 
> 时间：2008-11-11T22:24:56.357

我的主要语言是 Java。这是我讨厌它的地方：

5.) 缺少指针
4.) 异常捕获
3.) Boolean 类型
2.) BigDecimal 类型
1.) C# fanboys 和 Java fanboys

`Boolean`可以为空。我觉得这违反直觉。

`BigDecimal`是一个库而不是语言功能。我的烦恼`BigDecimal`和`Exception`困扰主要源于编写测试类，这些类必须跳过一堆圈才能完成实际工作。我应该澄清我对这些事情感到恼火，我不打算游说改变。

* * *

## 回答 #44

> 赞同：6
> 
> 时间：2008-11-11T22:26:52.390

Python：

1.  太慢了！
2.  列表操作不返回列表，所以你不能做 list.append(4).append(5)。（我的意思是对同一个列表的引用，而不是副本）。这是一个小问题。它只出现了几次。
3.  语句不返回值（if、print、while、for 等）。这只是处理 lambda 时的问题。
4.  lambda 只能是一个表达式。没有真正需要这种限制，因为它们在其他方面都等效于函数。如果我想要一个调用两个函数的按钮按下事件怎么办？我需要创建一个命名函数来为动作侦听器提供该功能，同时执行“lambda: f1(); f2()”不会受到伤害。
5.  您只能将标准 a-zA-Z_0-9 作为名称。有像“真的”这样的功能吗？和“+”会很棒。当然，这可能会导致严重的混淆，但我并不是说我们立即将所有函数重命名为“p@$%3”。你觉得哪个读起来更清楚：“dec2bin”还是“dec->bin”？（“store_results”或“storeResults”）还是“store-results”？

* * *

## 回答 #45

> 赞同：6
> 
> 时间：2008-11-11T22:40:53.140

Groovy/Grails

1.  鸭子打字
2.  约定优于配置，假设您知道约定
3.  你讨厌春天的一切
4.  你讨厌 Hibernate 的一切
5.  [Groovy] 跨集合的通用操作不是（但最近的版本改进了这一点）

* * *

## 回答 #46

> 赞同：6
> 
> 时间：2008-11-11T23:34:47.883

## 冷融合

1.  大型 Flash 表单的编译时间。
2.  动态变量类型（有时我讨厌它们。）
3.  CFScript 中缺少功能。
4.  CFTable（永远无法正确显示）。
5.  CFChart 缺少图表类型。
6.  完全缺乏 NTLM 支持（企业准备就绪 - 是的）
7.  CFC 中的 Moronic var 作用域
8.  没有真正 NULL 的概念 - 你的变量就消失了！
9.  无法测试某些事物的存在（例如范围，只是其中的成员）

* * *

## 回答 #47

> 赞同：6
> 
> 时间：2008-11-26T20:04:12.993

**JavaScript**

1.  函数对象语法：

    ```
    f = new Function( "foo", "bar", "return foo+bar;" ); 
    ```

    （它需要 n 个参数，第一个 n-1 是函数的参数，然后 nth 是实际的函数，以字符串形式。这很愚蠢。）

2.  函数参数可以重复。

    ```
    f = new Function( "foo", "foo", "return foo;" ); 
    ```

    不过，最后一次重复是唯一使用过的重复：

    ```
    f( "bye", "hi" ) // returns "hi"
    f( "hi" ) // returns undefined 
    ```

3.  E4X 应该死了。我的用户总是抱怨它没有按照他们认为的方式工作。让我们面对现实吧，当你需要一页半的伪代码作为 setter 时，是时候重新考虑一下了。

4.  stdin/stdout/stderr（和文件！）的标准概念会很好。

5.  空！=未定义

    不得不同时处理它们很烦人。有时它很有用，但大多数语言都能很好地适应一种。

* * *

## 回答 #48

> 赞同：6
> 
> 时间：2008-12-05T18:18:36.680

**Python**

*   `__init__`
*   有些库很尴尬，比如 smtplib
*   'self' 必须在方法声明中！！！
*   （对于 pre-3.0）有点差的 unicode 支持
*   缺少内联 try-catch
*   没有直接引用“this”/当前模块（而是必须使用`sys.modules[__name__]`）

* * *

## 回答 #49

> 赞同：6
> 
> 时间：2008-12-08T15:29:46.723

动作脚本/AS3

*   没有抽象类
*   没有私有构造函数（所以单例是 hack）
*   FP10 之前没有类型化数组
*   Flash IDE 中的编译/发布时间非常慢
*   内置函数（例如数学）的性能很慢

否则它实际上是一门好语言——比 JavaScript 好得多，这与流行的看法相反，比 PHP 之类的语言好一百万倍。

* * *

## 回答 #50

> 赞同：6
> 
> 时间：2009-01-04T01:33:35.633

**C＃**

它是一门很棒的语言，尤其是 LINQ，但与 C++ 相比，*泛型支持很差。*它有很大的潜力，但目前的实现只对强类型集合和类似的琐碎事情有用。它掉下来的一些例子：

*   泛型参数不能仅限于枚举（仅限类或结构）。
*   泛型参数不能是静态类。为什么？这似乎是一个完全人为的限制。
*   您不能指定泛型类型必须具有具有特定签名的构造函数，因为您不能在接口上具有构造函数。为什么不？这只是另一种具有特殊名称“.ctor”的方法。
*   同样，您不能指定泛型类型必须具有静态方法，因为它们也不能在接口上声明。类似的东西`static T Parse(string s)`经常会派上用场。
*   编译器太急于禁止程序员知道实际上会起作用的一些强制转换，所以它们需要像这样的丑陋`(TheRealType)(object)value`
*   没有协方差，例如。`IList<string>`不能转换为`IList<object>`，即使`string[]`可以转换为`object[]`。（不过，微软可能会在 C# 4.0 中解决这个问题。）

* * *

## 回答 #51

> 赞同：6
> 
> 时间：2009-01-08T15:29:46.023

Python。

尽管已经提到了 python 处理范围的奇怪方式，但我觉得它最糟糕的后果是这是有效的：

```
import random

def myFunction():

    if random.choice(True, False):
        myString = "blah blah blah"

    print myString 
```

也就是说，if 块内部与函数的其余部分具有相同的范围，这意味着变量声明可以发生在条件分支内部，并且可以在它们外部访问。大多数语言要么阻止你这样做，要么至少为你提供某种严格模式。

这个函数有时会成功，有时会抛出异常。虽然这是一个人为的例子，但这可能会导致一些微妙的问题。

* * *

## 回答 #52

> 赞同：6
> 
> 时间：2009-07-07T07:45:57.203

哈斯克尔：

*   空间泄漏——默认情况下为懒惰付出的代价——也许代价太高了？
*   `head`甚至像and这样的纯函数也`tail`可以调用`error`和引导你到`IO`.
*   `fail`从`Monad`- 带回来`MonadZero`。
*   `Num`班级 -`(+)`应该是`AdditiveGroup`或类似的。
*   那`Monad`不是一个`Applicative`.

* * *

## 回答 #53

> 赞同：6
> 
> 时间：2010-05-25T20:19:00.570

这里有更多关于 Perl 5 的内容，从创建了很多 Perl 模块的人的角度来看，特别是在[Moose](http://moose.perl.org)上工作过。

1.  重载和绑定变量的可怕破坏。这两个特性都是对内置类型进行透明扩展的失败尝试。

    它们都以各种方式失败，并要求像我这样的模块作者要么实现可怕的黑客来支持它们，要么说“永远不要将重载的对象传递给 foo() 方法”。这两种选择都不是真正可以接受的。

2.  编译过程和元模型缺乏适当的挂钩。如果 Perl 核心允许我们通过允许我们挂钩到元模型（包、类等）的健全 API 来影响编译过程，那么 Moose，尤其是角色使用，可以变得更加安全。

3.  缺乏语言内置的命名参数。相反，每个人都重新发明了这一点。它很烦人。

4.  同样，缺少可选类型。我不想要静态语言，但是指定类型和约束的能力，特别是在函数/方法参数上，会很棒。Perl 6 做到了这一点。类型是可选的，但非常丰富，内置类型和用户定义类型之间没有根本区别。

5.  向后兼容性警察。这更像是一个文化问题。上述许多问题永远无法真正解决，因为 Perl 5 对向后兼容性做出了非常坚定的承诺。因此，即使要添加一些东西来有效地取代当前的平局和超载，这些功能也永远不会被删除。当然，向后兼容也是 Perl 5 的最大优势之一。

6.  **奖励讨厌**：Perl 的内置异常机制是个笑话。异常可能是字符串或对象这一事实导致了繁琐的异常捕获代码的永恒，而语言语法中缺少捕获是疣上的疣。

* * *

## 回答 #54

> 赞同：5
> 
> 时间：2008-11-11T23:04:27.290

[我有一本书探讨了SNOBOL](http://en.wikipedia.org/wiki/SNOBOL)中的各种项目。第一章探讨了 SNOBOL 编程和语言的历史和文化，并花一些时间来论证一个好的程序员喜欢一门语言不是因为它的缺陷，而是*尽管*有缺陷。

我最喜欢的语言是[Icon](http://en.wikipedia.org/wiki/Icon_programming_language) / [Unicon](http://unicon.sourceforge.net/)。但是还是有一些让我讨厌的地方：

1.  它不是众所周知的，也不是那么受欢迎。
2.  与 PHP、Perl、Java 等相比，它的库要小得多。数据库访问是通过 ODBC 完成的，这实际上很烦人。
3.  尽管它在列表处理方面非常出色，但我想念 PHP 的内置`explode()`和`implode()`.
4.  它没有表常量。列表，是的，表格，不。
5.  它是一种编译（实际翻译）的语言。

* * *

## 回答 #55

> 赞同：5
> 
> 时间：2008-11-26T19:46:32.373

**C++**

*   与 char* 和 std::string 相关的库中的不一致。所有 C++ 库都应该采用 std::strings。

*   相对于 iostream，字符不是字节。我做了很多面向字节的工作。拥有“字节”类型和“字符”类型会显着简化它。这也将允许更容易地扩展到 Unicode。

*   对一个值进行位操作应该很容易。我应该能够在不玩 AND/OR 跳舞的情况下访问和设置值的第 n 位。

*   缺乏用于 GUI 的标准化接口。这就是微软真正能够用 C# 很好地定位自己的地方。操作系统制造商提供的标准接口绑定对我的工作有很大帮助。

* * *

## 回答 #56

> 赞同：5
> 
> 时间：2008-12-04T08:42:50.573

**F＃**

1.  类型推断是有限的。

    1.  它只向前传播。

    2.  F# 不会尝试根据使用的方法和属性来推断对象类型：当它没有线索时，您将收到“查找不确定对象类型”错误。

2.  不能混合浮点数和整数：1 + 2.3 是类型错误。

3.  为了定义 monad 或计算表达式，必须创建一个构建器对象有点尴尬。在 Haskell 或 Scala 中，您可以直接在 monadic 对象上定义 monad 操作。

4.  虽然#light 语法是首选，但缩进规则有时不是很直观或变得很麻烦。

* * *

## 回答 #57

> 赞同：5
> 
> 时间：2009-01-04T01:46:34.000

PHP

1.  没有构造函数重载
2.  函数命名不一致（str_replace，但 strtolower）
3.  define() 不像 C++ 那样替换全局变量。
4.  当与 XHTML 结合使用时，像 if 语句这样的语句必须以不缩进开始，即使要保持 XHTML 缩进一致，XHTML 也是缩进的。

前任：

您必须键入：

```
<?php
if($x == NULL)
{
?>
                     <p><?= $x . ' is null' ?></p>
<?php
}
?> 
```

5.  错误捕捉是可怕的

（不知道为什么SO将＃5再次更改为＃1，但无论如何）

* * *

## 回答 #58

> 赞同：5
> 
> 时间：2009-01-12T02:43:48.943

C：

*   函数指针（可执行文件）和数据指针（你真的不想执行它）之间缺乏区别。
*   极度不可读。让代码看起来像它所做的事情比让它首先完成任务要困难几个数量级。
*   缺乏对 lisp-think 的明确支持。做功能性的事情是可能的，几乎没有，但还不清楚。
*   库之间关于如何返回错误代码的严重不一致。
*   过时的字符串处理。字符串不是字符串，它们是以 null 结尾的 blob。这一切都值得畏缩。

语言：

*   () 涉及按 shift 键。每次我做很多 lisp 时，我都会把它和 [] 交换。

* * *

## 回答 #59

> 赞同：5
> 
> 时间：2010-05-26T16:10:06.587

## 德语

我的母语……虽然它听起来比克林贡语还要优美，但它是一个语法地狱……

1.  **共轭**：即使是规则动词对于每个人和时间也有不同的形式（除了少数例外）......示例：我看到，你看到，他/她/它看到，我们看到，你看到，他们看到翻译成：Ich sehe， du siehst, er/sie/es sieht, wir sehen, ihr seht, sie sehen。
2.  **称谓的礼貌形式**：等于第三人称复数，中年用来等于第二人称复数……我真的很讨厌区分“杜”和“锡”的概念，因为我的哲学是每个人都应该被认为是平等的尊重它应得的（我的意思是，什么是脏话，嗯？）
3.  **标点符号**：告诉我一种经常使用更多逗号的语言！
4.  **缺少合适的词**：例如。没有*真正的*德语相当于“方便”或这个词的任何派生词......在几乎所有情况下，您都无法将其翻译成另一个德语单词并保持其含义......相反，您必须组成一个完整的子集形容一下就够了……
5.  **Anglicisms和[Denglish](http://en.wikipedia.org/wiki/Denglisch)**：当然，英语有“Kindergarten”或“Poltergeist”，但德语中充斥着没有人需要的 Anglicisms……更糟糕的是：我们重新定义了我们采用的一些词，例如。在德语中，“Handy”的意思是手机，与英语中的形容词无关......语法上也有大量涌入，导致“Denglish”表达（参见维基百科上的链接文章）还有更多，但我不想夸大这一点，这些是我个人最讨厌德语的前五名……

* * *

## 回答 #60

> 赞同：5
> 
> 时间：2010-06-01T12:34:23.927

Python：

*   您通常在文件末尾有程序的入口点。（因为如果它调用模块中定义的任何函数，它必须在源代码中的那些函数之后发生。）当你不得不花时间寻找程序的入口点时，我讨厌它，所以我总是有一个简单的`main.py`文件：

    ```
    def main():
        ...

    if __name__ == '__main__':
        main() 
    ```

*   当引发异常时，它只能被主线程捕获。或类似的东西。

*   析构函数毫无用处，因为当用 Python 编写时，它们可能会破坏垃圾回收 IIRC。

*   我从来没有弄清楚相对导入在 Python 2 中是如何工作的。

*   我希望在标准库中看到更多集合。例如：链表、线程安全集合、...

* * *

## 回答 #61

> 赞同：5
> 
> 时间：2010-07-16T03:37:30.217

**Perl 5**按从最讨厌到最不讨厌的顺序。

1.)*向后兼容警察*。是的，backcompat 是一种优势，但 Perl 5 太过分了。现在，我们甚至没有在我们的语言中获得新功能，而无需显式启用它们。我更喜欢相反的情况，如果新功能导致问题，让我禁用它或强制执行旧行为。例如 perl 5.10 添加了如果我有自己的实现，`say`我宁愿拥有，而不是必须放置，或者 如果 5.8 工作但 5.10 没有。我宁愿将我的代码限制为仅使用 5.8 及以下可用的功能，如果没有定义，那么它应该默认为您正在运行的任何版本，并且建议不要限制它，除非您必须这样做。`no feature 'say'``say``use feature 'say';``use 5.010;``use 5.008;``use version;`

2.)*过多的样板*。

```
#!/usr/bin/perl
use strict;
use warnings;
use utf8;
use autodie;
use English '-no_match_vars';
use 5.010;
package Package::Name;

BEGIN {
    Package::Name::VERSION = 0.1;
}

sub somesub {
    my $self = shift;
    my ( $param1, $param2 ) = @_;
}
1; 
```

现在你可以开始编码了。由于#1，这不会改变。当然，这些东西有一些捷径，比如`use common::sense;` 或`use modern::perl;`会缩短上面的内容，你可能需要一些稍微不同的模块或编译指示。但是由于#1，我们永远无法将其减少到。

```
#!/usr/bin/perl
package Package::Name 0.01;

sub somesub ( $param1, $param2 ) {
} 
```

一些模块正在帮助解决这个问题，5.0.12 中有新的包版本，虽然我认为它`use 5.012;`首先需要它，`Method::Signatures`但它永远不会完全解决（用语言）。

3.)*变量选择不佳*

啜食一个文件

```
#!/usr/bin/perl
use strict;
use warnings;
open my $fh, "< foo" or die $!;
local $/; # enable localized slurp mode
my $content = <$fh>;
close $fh; 
```

wtf 是`$!`和`$/`？重写为易读。

```
#!/usr/bin/perl
use strict;
use warnings;
use English '-no_match_vars';
open my $fh, "< foo" or die $ERRNO;
local $INPUT_RECORD_SEPARATOR; # enable localized slurp mode
my $content = <$fh>;
close $fh; 
```

并且不要忘记`'-no_match_vars'`如果您不想受到性能影响，则必须存在。

没有直接的方法来创建匿名标量怎么办？

```
#!/usr/bin/perl
my $scalar_ref = \do{ my $anon_scalar }; 
```

他们就不能想出点什么吗？

```
#!/usr/bin/perl
my $scalar_ref = <>; 
```

哦，perl 是如何对线程不友好的，因为默认情况下所有变量（包括特殊变量）都是全局的。至少现在您可以将`my $_;`其用于词法范围并用于`local`其他范围。

4.)*非常丑陋的语法*

MooseX::Declare 是一种更好的语法。我也希望 -> 被替换为 . （个人喜好无关紧要）

5.) *TIMTOWTDI*过多或*最佳实践过多*似乎您必须阅读 3-5 本书才能弄清楚*您应该如何做事*。

6.) 以前的（不再适用）。*不理智的发布*。5.10.0 的功能 5.10.1 的功能没有设定时间，直到下一个版本。现在它是每年一次的功能发布，每季度更新一次。

7.)*象牙塔视角*。社区问题，似乎是大量开发人员想要高准入门槛，并认为可以不尊重地对待*n00bs*（或实际上任何不同意他们的人）。

8.)*疯狂的版本号/字符串*Perl 有浮点版本号，而且它们很丑。哦，开发人员不知道并非所有下游都以相同的方式处理版本比较。不是语言问题

```
0.012 # simple
5.012001 # semantic 
4.101900 # time based + version (for multiple versions in a day)
0.035_002 # prerelease 
```

perl 中的所有有效版本..我们不能像这样使用...

```
0.12 # simple
5.12.1 # semantic
20100713 # time based (just use the date and be careful not to need to release more than 1 a day)
0.35-beta2 # prerelease 
```

**添加**

9.)*升级后没有明显的方法来重新安装所有 XS 模块*

* * *

## 回答 #62

> 赞同：5
> 
> 时间：2010-08-20T04:21:48.827

**蟒蛇 (3.1)**

*   `T if C else F`条件语句的奇怪的乱序语法。
*   `bytes`文字看起来太像`str`文字了。我们应该有类似的东西`x'414243'`而不是`b'ABC'`.
*   `str`在某些平台上是 UTF-16，在其他平台上是 UTF-32。（尽管至少它是对 2.x 字符串的改进。）
*   具有相同的加法和连接运算符。这对像`numpy.array`.
*   运行缓慢。

* * *

## 回答 #63

> 赞同：4
> 
> 时间：2008-11-14T20:45:55.283

Python

*   调试时错误/异常不明确
*   我不在工作中使用它
*   在类中使用 __init__、__repr__、__str__ 等
*   不能简单地编译可执行文件（.exe 或其他）
*   我还没有尝试过的其他一些事情，但我肯定会打扰我

对于所有那些 C 语言程序员来说， self 对我来说比这更有意义，因为对象指的是它的 self

* * *

## 回答 #64

> 赞同：4
> 
> 时间：2008-11-24T04:24:58.210

Python：

*   数字运算慢。这不会是什么大问题，除了它......
*   没有一种简单的方法可以将 C 代码包含在您的程序中，该程序在导入时会自动编译。
*   在 py3k 接管之前，我们仍然必须忍受愚蠢的整数除法规则。
*   在 py3k 接管之前，我们仍然必须忍受 imap 和 izip 这样的好东西在一个单独的模块中。
*   在 py3k 能够接管之前，我们必须做很多工作。

* * *

## 回答 #65

> 赞同：4
> 
> 时间：2009-01-08T07:27:34.967

**Emacs Lisp**

*   没有足够的商业市场可以全职使用 elisp 编码
*   GNU Emacs 与 XEmacs 不兼容
*   Scheme 中的嵌套函数很简洁，我希望 elisp 有这个概念 [1]
*   用于简单循环列表的 do 循环或其他一些工具不是标准的（当然，您现在可以使用 lambda 进行 mapc）[1]
*   (function (lambda (...))) [1] 应该有一个简写形式

[1] 当然，Lisp 的一大优点是在你自己的代码中用单行代码修复这些东西并不难。仍然让我恼火的是它不是内置的。

好问题; 我有点尴尬，我想不出更好的东西来讨厌，但老实说，大人，没有什么可讨厌的。

* * *

## 回答 #66

> 赞同：4
> 
> 时间：2009-01-08T15:09:33.083

**自己**

*   没有真正的代码浏览器，而是数百个小窗口飞来飞去。
*   只是一个研究项目，不够稳定，没有活跃的社区。
*   没有适用于 Linux 或 Windows 的快速版本。仅限 Mac OS X。
*   不支持标准键盘命令。
*   哦！而且关于编写原生插件的文档已经过时了！

* * *

## 回答 #67

> 赞同：4
> 
> 时间：2009-01-08T19:32:09.933

C#（嗯，其中一部分是 VisualStudio IDE，我猜）：

*   没有协方差（还），即使 type派生自 type ，`Class<D>`也不能使用 like 代替。 `Class<B>``D``B`
*   图形设计师不支持基于泛型的继承（或从抽象类继承），即使如果您通过添加额外的继承级别来解决设计器问题，那么继承本身就可以正常工作，这样设计人员总是可以看到代码的具体非泛型变体.
*   没有构造函数继承
*   泛型类型参数的 where 子句中没有构造函数
*   在打开解决方案时，VisualStudio 似乎倾向于神秘地检出文件（如项目文件和/或单元测试定义），即使这些文件似乎实际上并没有被更改。

如果你明天再问我，可能是不同的列表。尽管协方差和设计器的问题在我解决之前会排在前 5 位（在 C# 4.0 中添加了方差，这似乎至少发生在其中一个...）。

* * *

## 回答 #68

> 赞同：4
> 
> 时间：2009-02-19T08:22:36.890

## 甲骨文 SQL

1.  `DUAL`桌子 。

2.  不能`GROUP BY`化名。

3.  我永远记不起分析函数的语法，所以我忘记/懒得使用它们。

4.  缺乏组合`LIKE`和`IN`条件运算符。（不过，在 10g 之后，有一个`REGEX_LIKE`操作员可以做到这一点。）

5.  尴尬的连接语法。

SQL 并不是我最喜欢的语言，但它是我日常使用的三大语言之一。可能还有更多项目，但这些是我最关心的。

我有一大堆问题`SQL*PLUS`。我编写了一个 Perl 替代品，它可以从命令行执行我想要的操作，并将其[`sql.el`](http://www.emacswiki.org/cgi-bin/wiki/sql.el)用于`Emacs`交互式`SQL`会话。这些工具帮助我解决我的`SQL*PLUS`问题。

* * *

说到这里：

## Perl

1.  “只能`perl`解析 Perl。” （但这主要是语法高亮中的一个问题，我不想再对任何语言使用太多了。）

2.  我有时对“简单（但偶尔令人惊讶）的规则......：它看起来像一个函数，因此它是函数，优先级无关紧要”感到惊讶。（来自`perlfunc(1)`）

3.  取消引用复杂的数据结构有时会让人感到困惑。我无法确定这是 Perl 中的真正缺陷，还是仅仅是拥有非常强大的数据结构设施的结果。无论哪种方式，我通常可以通过花几分钟思考我在做什么来做对。

4.  没有像 DBI 模块那样导致系统调用引发错误的选项。（感谢 brian d foy，我现在知道`autodie`CPAN 上的模块可以做到这一点，但我希望它是内置的。）

5.  默认情况下，脚本中未启用警告和限制。（该`-e`选项将关闭它们以供命令行使用。）

同样，肯定会有更多的事情，但这些是我最近注意到的问题。我会在 中添加对`=over`and`=back`和古怪`L<...>`语法的需求`POD`，但也许这应该是一个单独的列表。

* * *

现在是三连击：

## KornShell

1.  使用参数获取文件会替换父脚本参数的值。（执行`. file arg1`puts `arg1`in `$1`。）

2.  `ksh`不是一个理想的交互式 shell，默认为`vi`键绑定，而不是`emacs`. （我的解决方案是`bash`用于交互式外壳。）

3.  通用实用程序（例如`grep`）在不同平台上的实现方式不同，从而妨碍了完美的可移植性。一些有用的命令需要安装在某些平台上，并且是其他平台上操作系统核心的一部分。

4.  条件句的语法过于繁重。( `if [ ... ]; then ... fi`)

5.  尽管它是图灵完备的，但您最终还是会想要升级到像 Perl 这样更具表现力的语言。

＃4的一种解决方案是习惯于短路评估：

```
[ ... ] && ... 
```

* * *

## 回答 #69

> 赞同：4
> 
> 时间：2009-02-19T23:41:17.527

D

*   我们有 in 运算符，但没有 !in 运算符？
*   动态数组“长度”属性 - 你可以做

    `array.length += 512;`

*   没有退出语句 - 如 python 的 sys.exit() 等。当然，你可以调用 C 的退出，但未刷新的输出不会被刷新
*   关联数组文字 + 字符串文字很烂

    在关联数组文字中按原样找到的字符串文字被解释为静态的，因此这

    `char[][char[]] hash = ["hello":"world","goodbye":"angels"];`

    由于不同长度的字符串文字，尽管
    a. 我没有要求将其解释为静态数组
    b。无论如何，关联数组中不允许使用静态数组

*   不允许循环依赖（想要移植那个 java lib？重新设计类层次结构很有趣）

有人检查我这些；不确定它们是否仍然相关。

* * *

## 回答 #70

> 赞同：4
> 
> 时间：2009-04-09T23:57:54.257

**爪哇**

1.  检查异常
2.  类型擦除
3.  缺少运算符重载（例如 BigInteger/BigDecimal）
4.  缺少正则表达式/日期/持续时间/复杂文字
5.  对不变性的支持很差

* * *

## 回答 #71

> 赞同：4
> 
> 时间：2009-06-16T01:12:23.553

第一篇文章，所以请放轻松:) ... 很棒的社区网站，顺便说一句！

我尝试阅读所有其他 C# 回复，以免我的回复重叠

**C#** ... 没有特别的顺序：

1) switch 语句中的 case 没有失败。如果没有失败……为什么必须显式键入break？反正？它只是迟钝和混乱，因为它意味着没有休息的能力；！！！

2）不能在子作用域中声明同名变量，但可以声明与类变量同名的变量？要么都允许，要么都不允许。否则，它没有意义。

3) 函数中没有可选/默认参数

4) finally{} 中的异常应该为每一行隐式捕获。或者至少，只是 NullReferenceException 异常。例如，在访问数据库后，应该始终清理。所以，finally 块应该是这样的：

```
finally
{
  if(par1 != null)
    par1.Dispose();
  if(comm != null)
    comm.Dispose();
  if(conn != null)
    conn.Dispose();
} 
```

如果它可以写成这样会更干净：

```
finally
{
    par1.Dispose();
    comm.Dispose();
    conn.Dispose();
} 
```

但是，不......你必须检查你是否正在访问一个空对象，否则它可能会从 finally 块中抛出一个 NullReferenceException ......并且无论如何谁真的需要 finally 块中的异常？

5) 泛型：您可以指定 new() 来实例化您的泛型对象，但该对象需要有一个默认构造函数。为什么你不能指定一个签名，这样就不需要创建空的构造函数，如果它还没有它们，只需使用它有的构造函数。

* * *

## 回答 #72

> 赞同：4
> 
> 时间：2009-06-16T01:48:09.600

## 哈斯克尔。

1.  Prelude 是默认导入的。
2.  类型类的范围是通用的。
3.  模块不是一流的。
4.  类型不能依赖于值。
5.  Monad 没有与 Functor 统一。

* * *

## 回答 #73

> 赞同：4
> 
> 时间：2009-10-30T14:10:09.957

我不敢相信，我最喜欢的 Python 小毛病还没有被提及：

1.  （在 3.x 之前）相对导入看起来像绝对导入。

    ```
    import foo 
    ```

    这是从您所在的目录还是从 sys.path 导入 foo？

2.  压缩鸡蛋，导致 sys.path 充满垃圾。压缩鸡蛋意味着你不能使用`grep`和`find`（除其他外调试问题1）！幸运的是，有点子。使用点子。
3.  一些随附的电池是非pythonic。使用它们很有趣。
4.  可能是发行版和打包程序的错，但仍然：在安装/编译时将 sourcefile-encoding 设置为 fscking ASCII。怎么回事？意味着我必须在我制作的每一个 .py 文件中添加“# coding: UTF-8”-stuff。

Py3k 修复了我的其他几个讨厌的问题，例如坚持字符串是 unicode 并且 8 位的东西被区别对待......

* * *

## 回答 #74

> 赞同：4
> 
> 时间：2010-05-04T10:09:15.113

C++：

# 1：头文件。

链接你的代码比编译它更难。此外，要求模板具有该翻译单元中的完整源代码是荒谬的。它在那里的另一个文件中结束了.. 你两秒钟前编译的那个。去那里看看。愚蠢的编译器。

# 2：空标准库。

我的意思是，是的，C++0x 中有 std::thread，但没有 std::socket 或类似的东西。没有跨平台代码的主要原因是您必须为要在多个平台上执行的每个功能学习一个新库。如果没有作为标准提供的 OS 标头或 OS 函数，C++ 仅适用于推送位。

# 3：没有多重返回或返回值重载

双 x，int y，char z = func(); 与 void func(double x, int y, char z); 一样有效。请。没有返回值重载的唯一原因是因为我们“可能”编写模棱两可的代码。可能！请在我实际编写模棱两可的代码时给我悲伤，而不是以前。

# 4：无反射

可以使反射编译时。确实如此。没有任何库会使编写大量库变得困难，充其量，并且严重惹恼了我。我可以滥用预处理器但是..

# 5：鸭子在模板上打字

雅格。请，概念和正确的模板错误消息。几乎不可能使用像 Boost 这样的库，因为如果你弄错了，你就是在黑暗中拍摄。

* * *

## 回答 #75

> 赞同：4
> 
> 时间：2010-06-02T05:27:04.880

卢阿：

*   元表在“点击”之前非常令人困惑
*   缺少像这样的赋值运算符`a += 20`很痛苦
*   没有集成的面向对象解决方案意味着每个人和他的狗都使用自己的风格
*   用于注释 ( `--`) 的语法排除了前后递增/递减运算符的可能性
*   如果不破解 C 端，就不可能拥有任何类型的先发制人的多任务系统

* * *

## 回答 #76

> 赞同：3
> 
> 时间：2008-11-12T06:41:12.843

C/C++

1.  缺乏完整的 SWAP 功能
2.  模板语法
3.  你不能#define a #define（没有多遍）
4.  编译器之间的结构打包不兼容
5.  char 是有符号还是无符号？

爪哇

1.  边缘的不变性
2.  没有像 C# 这样的 ref 关键字
3.  到处尝试/捕获块
4.  运行时性能不佳
5.  所有与字符串相关的东西

Python

1.  没有“主要”（我已经习惯了！）
2.  带下划线的关键字
3.  有限的线程支持
4.  “自我”而不是“这个”
5.  缺乏类似 C/C++ 的语法

* * *

## 回答 #77

> 赞同：3
> 
> 时间：2008-11-29T05:44:01.233

在这里再次为 C++ 投票......仍然是我最喜欢的几个密切追随者 - C 和 Python。这是我目前的仇恨列表，不分先后：

*   从 C 继承的大量整数类型 - 有符号与无符号错误导致的问题太多
*   复制构造函数和赋值运算符 - 为什么编译器不能自动从另一个创建一个？
*   可变参数疯狂 - va_list 只是不适用于对象，我厌倦了 sprintf()、snprintf()、vsnprintf() 以及它们所有的亲戚所产生的问题。
*   模板实现需要在编译时完全可见 - 我正在考虑缺乏“导出”实现或至少可用的实现
*   缺乏对属性的支持——我想要一个像“ax”这样的只读成员，它可以公开读取并且只能在内部分配。我真的很讨厌“val=obj.getX()”和“obj.setX(val)”。我真的想要具有访问控制和一致语法的属性。

* * *

## 回答 #78

> 赞同：3
> 
> 时间：2008-12-05T17:32:47.867

Perl 5：

1.  现在所有真正好的东西似乎都需要 mod_perl，它在我想去的任何地方都具有低可用性。
2.  一些真正令人难以置信的功能可以封装在模块中，但引擎盖下的东西通常是脆弱或可怕的：源过滤器、typeglobs，无论 Moose 正在做什么......
3.  DateTime 很棒，但仍然做出了一些非常糟糕的设计决定（[减去两个 DateTime 对象时不返回秒表持续时间](http://marc.info/?l=perl-datetime&m=110451908609630&w=2)）
4.  核心和 CPAN 上的双生命模块仍然会导致冲突
5.  模块作者仍然在他们的模块配置脚本中放置交互的东西，这样它们就不能被自动安装

* * *

## 回答 #79

> 赞同：3
> 
> 时间：2008-12-22T05:18:42.877

**.NET**框架（库）

*   很少使用的嵌套类型（例如`MessageBoxButton`应该是`MessageBox.Button`）
*   可变结构 ( `Rect`, `Point`)
*   `System`命名空间中的东西太多
*   太多不同的平等概念（`Object.Equals`, `Object.ReferenceEquals`, `operator ==`, `operator !=`, `IComparable.CompareTo() == 0`）
*   数组具有可变成员但不可变长度。

还有一个：

*   XmlSerialization 不适用于不可变类型

* * *

## 回答 #80

> 赞同：3
> 
> 时间：2008-12-22T05:47:11.117

**C＃**

我的大部分抱怨都与假设 C++ 约定自动成为 C# 的最佳选择有关

*   **Class 接口中不允许使用静态变量。**它仍然是课堂的一部分。为什么它不能成为界面的一部分？！我不得不为此创造出如此愚蠢的 hack-y 变通办法。
*   **区分大小写。**我知道此时它会破坏遗留应用程序，但为什么不区分大小写不是从一开始的规则

**.NET**的奖励之一（不是 C# 特定的）

*   **编译器不够聪明。**在 .NET 3.x 中，编译器可以在编译时找出“var”，那么为什么不能进行其他常见优化呢？我们都知道字符串 vs. StringBuilder / 不可变 vs. 可变的东西。为什么在很多情况下 StringBuilder 明显优于多个 concat.s 时，编译器不为您转换它？我敢肯定，默认情况下编译器可以为我们做很多其他优化（带有否决选项）并为我们节省大量时间。

* * *

## 回答 #81

> 赞同：3
> 
> 时间：2009-03-13T05:54:45.867

C＃

1.  当被枚举的集合中的对象发生变化时，foreach 命令会爆炸，
2.  UI 控件吐出假人，因为它们是在错误的线程上访问的。当然，所有 dispatcher.invoke 调用都可以移到 CLR 管道中，
3.  PInvoke，编组等，
4.  我浪费了两年的时间学习远程，
5.  它不像Ruby那样性感。

* * *

## 回答 #82

> 赞同：3
> 
> 时间：2009-07-22T21:37:33.317

Objective-C / Cocoa / Cocoa Touch：

*   缺乏命名空间
*   使用 Cocoa 的任何有趣且强大的技术（例如分布式对象、通知、KVO）难以使用原始值
*   与使用快捷点语法访问属性不一致，通常必须使用全长访问器
*   iPhone 上没有 GC，而且通常 GC 对其他高度动态的语言来说是相当晚的
*   不一致的库支持，至少在 Cocoa Touch 中是这样；一些非常基本的东西直到最近才获得高级支持，例如音频处理。
*   缺少方块！

* * *

## 回答 #83

> 赞同：3
> 
> 时间：2009-10-09T20:39:51.623

Haskell（包含所有 GHC 扩展，而不仅仅是基本的 Haskell'98 规范）。

我讨厌它只有一件事：它不是主流。

* * *

## 回答 #84

> 赞同：3
> 
> 时间：2009-12-28T02:13:39.747

我最喜欢的是 C#，但 C# 已经有很多答案了，所以我会选择我的下一个“最爱”：

### T-SQL

1.  该`GO`语句，以及您在所有方式的 DDL/DML 脚本中都需要它的事实，以及它还破坏事务语义的事实，这使得编写原子脚本比您真正需要的要困难得多为了升级生产数据库。
2.  分号语义不一致。99% 的语法不需要它，`MERGE`语句必须以它结尾，`WITH`语句必须以它开头……下定决心！
3.  `WITH CHECK CHECK`/ `WITH NOCHECK CHECK`。呜呜。
4.  UDF 中的可选参数并不是真正的可选参数。调用者必须指定`DEFAULT`（甚至不要尝试使用`NULL`）。与真正可选的 SP*相比。*
5.  *“......可能会导致循环或多个级联路径。”* **恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨恨**

* * *

## 回答 #85

> 赞同：3
> 
> 时间：2009-12-28T05:32:21.030

**TCL**

这是我最喜欢做几乎所有事情的语言。多年来，它已经发展（缓慢，非常缓慢）以解决大多数让我烦恼的事情。而且语言非常灵活，很容易实现语法糖来覆盖仍然让我烦恼的事情。但是有些东西不能轻易改变，只是打破了它的禅意：

*   数组（关联类型，Perl 称之为散列）没有正确的值语义。这使得它们难以传递到函数和从函数返回。此外，这意味着它们不能嵌套。出于这个原因，发明了 dicts（字典），但为时已晚，漂亮的数组访问语法：

    `$array($foo)`

    现在永远被愚蠢的数组用于向后兼容。我们现在被困在：

    `dict get $dict $foo`

    这更加冗长，对我来说可读性较差。

*   没有真正的关闭。虽然它可以通过全局变量或命名空间来模拟，但这首先破坏了关闭的原因。虽然，我现在无法真正看到如何在纯值语义系统中实现闭包。

*   Teacup 很难使用，与所有其他存储库工具相比，它一点也不直观。这比 tcl-core 更多是 ActiveState 的错，并且在编码时并没有真正破坏 tcl 的 Zen，但它仍然很烦人。

* * *

## 回答 #86

> 赞同：3
> 
> 时间：2009-12-28T13:34:45.970

C++

（除了 lambda 函数，我已经避免了 Cpp0X 中可用的东西）

*   不强制使用“this”来访问成员变量，::GlobalFunction 来访问全局命名空间。
*   中的所有内容（更具体地说，算法中缺少 lambda 函数，将在 0x 中修复）
*   处理依赖项/头文件和源文件
*   基本数据类型的愚蠢名称（应命名为 uint8、int16 等）
*   const_cast 功能

* * *

## 回答 #87

> 赞同：3
> 
> 时间：2010-05-23T15:47:08.523

## 二郎

*   没有像 Haskell 中那样的静态推断类型。这可能会导致运行时错误，并且需要仔细编写代码或用于 `dialyzer(1)`发现差异。动态类型也被认为是慢的；
*   与 C、Java 等相比几乎不为人知；
*   的`lists(3)`模块非常精简，有时我缺少有用的列表处理功能（例如`Data.List`Haskell 中的功能）；
*   让我把`,`每个语句放在子句的末尾，并`.`放在后者的末尾。

* * *

## 回答 #88

> 赞同：3
> 
> 时间：2010-05-25T20:16:38.113

Erlang 不在此列表中。在我最喜欢的语言中，但肯定有一些缺陷：

*   句法。这包括 3 个终止标记 (,;.) 和美学，但更普遍的是代码的语义含义如何在文本中表达。一个例子是关于所有小写标记如何是原子，所以要引用一个函数，你不能只命名它，你必须`fun my_function/1`, 和`?PRECEDE_CONSTANTS_WITH_QUESTION_MARKS`. 来自 Scheme、Haskell 等，你只是希望你可以使用一个名字。

*   图书馆支持是蹩脚的。这主要是外部库，甚至是旧的标准库。较新版本的 Erlang 具有合理的 POSIX 正则表达式，但旧版本具有用于基本字符串操作的非常糟糕的库。您也永远不知道何时获得价值，或`{ok, Value}`.

*   相关：用于构建和分发的非统一工具。Ruby 有`gem`和`rake`，RSpec。Perl 有 CPAN。我不知道 Erlang 中的等价物。

*   少数 Erlang 专用工具非常奇怪。Mnesia 是一个很棒的数据库，但是从 SQL 开始你有很多琐碎的事情要学习。与文档相同`@spec`，它有一种描述签名的奇怪方式。

*   当您只想要一点点突变时，功能范式通常会受到伤害。假设你想要一个哈希表，你不能像在 Scheme 或 SML 中那样破解它。 `ets`并`dets`减轻一些痛苦，但不多。

六、奖金：

*   模块的导入和导出语法是一堆失败，与 Java 的 80 多行`import`语句不同。

话虽如此，Erlang 是一种乐趣^_^

* * *

## 回答 #89

> 赞同：3
> 
> 时间：2010-05-25T21:09:38.153

**R**

不是我最喜欢的语言，但我经常使用它并且有很多可抱怨的......

*   S3 对象只是美化了`lists`，S4 类仍然将所有数据暴露给用户
*   赋值运算符可以是`<-` `->`or `=`，参见[Mike Dewar 的咆哮](http://mikedewar.wordpress.com/2010/05/19/going-both-ways-in-r/)
*   `my.var`是 OO 语言的一个非常混乱的变量命名约定，请参阅[Google 的样式指南](http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html)
*   我不应该后悔使用循环
*   神秘的错误信息

* * *

## 回答 #90

> 赞同：3
> 
> 时间：2010-05-26T03:11:37.077

Scala 是我最喜欢的语言。讨厌的五件事？简单的：

1.  需要很长时间才能正确学习。我知道您可以将 Scala 编写为“更好的 java”。这也是我们过去常说的关于 C++ 和 C 的说法。我同意这是语言中深刻思想的必然结果。但是还是...

2.  方法与函数：`def f(x: Int) = x*x`定义方法 f，而不是函数 f。尽管许多早期的 Scala 教程材料模糊了区别，但方法不是函数。该语言也试图模糊它，因为如果您在*某些*需要函数的地方提供方法，它就会被接受。我们必须同时拥有方法和功能吗？是的，这是基本的。但它最初让我感到困惑。

3.  以“蛋糕”模式从 mixins 组合类或对象很容易出现 NPE。eg`trait X { val host: String; val url = "http://" + host }`是一个mixin，它在实例化时是否会NPE，这取决于它在类声明中的位置。编译器可以告诉您它是否会失败，但不会。（无论如何在 2.7 中。）在复杂的继承图中很难诊断问题。

4.  2.8 中的数组依赖于隐式来与主要的 scala 集合类型相结合。但隐式并不适用于任何地方。可以在预期 a 的`Array`地方提供一个。`Seq`但是`Option[Array]`不能在`Option[Seq]`预期 an 的地方提供 an。我知道没有完全“正确”的方法来处理 java 数组。

5.  类型擦除。说够了。

* * *

## 回答 #91

> 赞同：3
> 
> 时间：2010-05-26T08:16:45.817

C＃。

我最讨厌的：

5.  没有多重继承——想象一下你可以提供任何 GUI 框架基类（控件、窗口等）与 MVC 相关的东西等等......框架/基类不可知！

6.  没有“朋友”关键字......我知道，RAD - 受害者会因为各种臭代码和搞笑的不当行为而滥用它，但对于 OOD - 执行 demeter 法律的人来说会很好

7.  没有语言集成 DBC 功能，有合同，但我宁愿拥有那种 Spec# - 带有通用“！”的风格 - 后缀运算符

8.  没有AOP（我不明白......这种语言有属性，在编译器中添加拦截代码会很容易！）

9.  没有弱事件委托 - 观察者模式只不过是现在的内存泄漏诱饵...... :-(

* * *

## 回答 #92

> 赞同：3
> 
> 时间：2010-05-26T16:39:26.973

我讨厌所有语言的五件事（至少我知道）：

1.  照我说的/输入的，而不是我的意思
2.  无疑会遇到那些认为自己是该语言专家，但只是把它弄得一团糟的人（例如，坚持删除注释/未使用的局部变量会加快程序执行时间的人）
3.  除非该语言已经过时，否则它可能会继续发展（无论是实际的语言，还是有效使用它背后的概念），要求您积极使用它进行开发，以免落后。
4.  无法修改词法分析器/编译器（添加自己的上下文相关语法）
5.  没有完美的语言（每种语言都缺少某种有用的功能，这些功能通常要么无法模拟，要么不可避免地具有丑陋的界面，要么需要太多时间来实现并正确处理）

* * *

## 回答 #93

> 赞同：2
> 
> 时间：2008-11-11T22:35:19.097

我使用 Java，我最大的不满是字符串操作的低效率。当您使用 + 运算符时。说真的，编译器不能弄清楚我添加了多少个字符串，然后在后台为我生成 StringBuffer 的东西吗？

通常使用 + 的代码比一系列 StringBuffers 操作更具可读性。

另外，我讨厌原生数组和集合框架之间的冗余。.toArray() 的语法非常难看。

* * *

## 回答 #94

> 赞同：2
> 
> 时间：2008-11-14T00:00:49.870

客观凸轮

1.  缺乏命名空间设施。
2.  冗长的类和对象规范化。
3.  复杂的构建系统。
4.  不方便做中缀。

* * *

## 回答 #95

> 赞同：2
> 
> 时间：2008-11-14T06:27:52.567

Python：

1.  全局解释器锁定 - 处理此问题会使并行处理复杂化。
2.  Lambdas 函数有点笨拙。
3.  没有内置的有序字典类型。
4.  根据 Python 的编译方式，它可以使用 UCS-2 和 UCS-4 进行内部 Unicode 编码，对于超过默认宽度的多字节字符，许多字符串运算符和迭代器可能会产生意外结果。字符串切片和迭代取决于位宽，而不是检查和计数字符。（大多数其他编程语言也做类似的事情，并且对这些字符有类似的奇怪行为。）
5.  围绕 Python 的 GUI 框架存在不一致之处。

* * *

## 回答 #96

> 赞同：2
> 
> 时间：2008-11-15T10:48:55.880

方案：

*   缺乏用户/小社区

* * *

## 回答 #97

> 赞同：2
> 
> 时间：2008-12-04T08:17:58.033

**卢阿**

我喜欢在 Lua 中编程，但让我感到很痛心的是：

1.  没有办法用这种语言写下 API——不像 C .h 文件或 Java 接口
2.  该语言具有一流的功能，但有人忘记告诉设计库的人。
3.  编写函数的语法太重了。
4.  语法分为语句和表达式。
5.  表达式形式是贫乏的：没有'let'形式，没有真正的条件表达式，......

尽管如此，我会坚持认为 Lua 非常棒:-)

* * *

## 回答 #98

> 赞同：2
> 
> 时间：2008-12-10T01:53:22.300

方案

*   缺乏静态类型
*   没有静态函数重载（由于上述原因）导致字段访问器的名称过长
*   没有统一的对象系统
*   有点慢
*   相对较小的社区

* * *

## 回答 #99

> 赞同：2
> 
> 时间：2009-01-03T03:08:09.563

**C++：**

*   缺乏象征意义。
*   过度痴迷于 C 兼容性。
*   可笑的复杂的预处理器。
*   模板错误几乎是不可理解的。
*   没有垃圾收集。

* * *

## 回答 #100

> 赞同：2
> 
> 时间：2009-01-03T13:33:55.837

Javascript；

1.  如果您不确切知道自己在做什么，“this”的动态绑定会非常混乱和危险。
2.  函数声明需要关键字“function”。我反对的不是打字，而是当我想做一些稍微聪明的事情时阅读它。Hrm 现在我想这也许是一个加号。阻止我做聪明的事情。
3.  由于数字 2，如果它是一个相当短的惯用语，通常只需复制/粘贴代码段而不是将其声明为函数的代码（就字符而言）。不幸的是，这助长了不好的做法，尤其是在我自己的代码中。
4.  Javascript 通过具有一流的函数和闭包来成为一种函数式语言，但是在运行时或编译时都无法验证函数中的引用透明性。没有这个，一些架构会变得有风险或笨重。
5.  它的名声非常糟糕，因此我无法在不被嘲笑的情况下向任何人说“我用 javascript 编程”。

* * *

## 回答 #101

> 赞同：2
> 
> 时间：2009-01-06T19:09:21.463

**R（R-统计项目）**

1.  糟糕的，糟糕的字符串支持
2.  对于一些简单的描述性任务（例如交叉制表）来说非常困难
3.  大型数据集操作在内存中完成。

* * *

## 回答 #102

> 赞同：2
> 
> 时间：2009-02-19T07:24:03.177

**Perl**

我喜欢这门语言，我不想添加已经用过的东西，但还没有人提到这个，所以我把它扔到锅里。当我使用这个功能时，我发现它是我一生中最可怕的经历（而且我曾使用过汇编语言）：

*   和`write()`函数`format()`。

它们拥有可以想象到的最糟糕、最丑陋、最可怕的语法，但它们无法为您提供*比*您已经通过一些（无限漂亮）`printf()`工作所能实现的功能更多的功能。*任何人**都不*应该尝试使用这两个函数来做任何输出，仅仅因为它们有多糟糕。

我相信有人会不同意，但是当我研究它们时，希望它们能解决我的问题，我发现它们是一个“痛苦的世界”（引用 Big Lebowski 的话），并希望 Perl6 要么废除它们，或者更好的是，完全重写它们以使其更实用和有用。

* * *

## 回答 #103

> 赞同：2
> 
> 时间：2009-02-20T03:55:34.293

C

1.  位字段——语言没有很好地指定它们，它们的工作方式取决于编译器和体系结构。
2.  通常很难找到在大量代码中定义特定符号的位置，尤其是。如果该符号是由宏产生的。这使我想起...
3.  预处理器是一个相当丑陋的黑客，可以接受各种滥用。
4.  缺少标准大小的整数（最近被 uint*_t 补救，但是有很多旧代码漂浮在那里，带有自定义 typedef 或 DWORD、WORD、BYTE 等的#defines）
5.  缺少类似于 Perl 的 cpan.org 的东西（很想弄错那个。）

编辑：在考虑 C 的 CPAN 时，我想......我该怎么称呼这样的东西，并想到“ccan”，并在谷歌上搜索它，我遇到了这个： [http ://ccan.ozlabs.org/](http://ccan.ozlabs.org/)

不过，它似乎还处于起步阶段。

* * *

## 回答 #104

> 赞同：2
> 
> 时间：2009-02-23T04:43:35.590

因为我不能真正全职使用它，所以我会四处走动，但无论如何我都会尝试！

**Perl 6**

1.  func（“frew”）！= func（“frew”）
    *   这让我很恼火，但这是有充分理由的。在 Perl 5 中 print (5 + 6) * 10*仍然*时不时地让我
2.  在很多地方它可能比 Perl 5 更容易解析，但有时它仍然会杀死我的编辑器
3.  它仍然有很多 Perl 5 的线路噪音，这让很多人感到害怕。这意味着更难让他们兴奋等等。
4.  还没有图书馆。
    *   如果 Perl 6 确实最终支持 Perl 5，这将不是问题，但这可能是不值得承担的负担。
5.  没有 REPL，或者红宝石学家所说的 irb。
    *   具有制表符补全、颜色编码等功能的可靠交互式 Perl 6 将使使用和学习它变得更好。
6.  目前该[文档](http://svn.pugscode.org/pugs/docs/Perl6/Spec/)基本上是英文规范。不完全是一个容易阅读。
7.  我知道这是一个愚蠢的陈词滥调，但它还没有出来！
    *   （我可以抱怨，因为我在帮忙:-P）

前三个是语言；其余的并不是真正的语言本身，而是它还没有出现的事实。

* * *

## 回答 #105

> 赞同：2
> 
> 时间：2009-03-13T18:04:16.487

**C**

*   它非常灵活和强大，很容易编写非常糟糕或非常危险的代码（或者，如果您愿意，“能力越大，责任越大”）。
*   '=' 表示赋值，'==' 表示相等；容易在“if”语句中混淆。
*   该语言的许多基本部分的实现依赖于编译器；例如基本类型的大小、位域中的位顺序、联合中的填充和字节顺序。
*   位域不可参数化（即您可以使用整数数组，但不能拥有位数组）。
*   字符串处理可以改进。

* * *

## 回答 #106

> 赞同：2
> 
> 时间：2009-04-10T12:45:34.800

**Python**

*   s中没有陈述`lambda`。GRRRR
*   `foo( a for b in c if d )`感觉不对，每次我逃脱它都会让我感到惊讶。不应该`foo( (a for b in c if d) )`吗？
*   我可以理解听写吗？
*   map 和 filter 运算符在列表推导中有特殊的语法，reduce 怎么样？或排序？
*   只需在其中添加一条`yield`语句，一个函数就神奇地变成了一个生成器，并且它的接口完全改变了。此外，该生成器在第一个`next()`. 至少，不是不使用返回生成器的函数。

**JavaScript**

*   没有用于制作模块化代码库的简短语法。您必须调用一个返回公共方法字典的函数。每次更改模块的界面时，您都必须在（至少）两个位置进行编辑。
*   创建闭包涉及从一个函数返回它，该函数从 ('sup dog) yo' 函数返回一个函数。杂乱无章！
*   `for each ( foo )`语法和行为感觉像是事后才想到的。
*   知道你的代码何时真正运行（以及以什么顺序）更像是一门黑暗的艺术。确定正确的唯一方法是将所有内容（是的，也是如此）放在一个大文件中。即便如此，您仍然需要等待 document.onload
*   我错过了什么吗？没有手动构建json序列化值的简单方法吗？（是的，jQuery 可以做到这一点）。

* * *

## 回答 #107

> 赞同：2
> 
> 时间：2009-06-05T17:35:45.077

**VBA**（因为你认为你的语言不好）

1.  行内的空格是严格执行的。
2.  语句刚刚结束，需要一个“_”来换行到下一行，但不是每一行都可以换行。
3.  没有 ++,--,+=,-= 语句。严重地？
4.  数组可以从任何索引开始，而不仅仅是 0。
5.  某些类型（即：定点“十进制”值）必须是 Variant 的子类型，并且不能作为它们自己的类型使用。
6.  != 和 <>。
7.  “=”既用作比较器又用作分配，而不是分成“=”和“==”。
8.  “选项显式”。
9.  用户界面自 2000 年以来未更新。
10.  Office2k7 没有升级到 VB.NET
11.  大多数对象模型都是无意义的并且过于冗长。

* * *

## 回答 #108

> 赞同：2
> 
> 时间：2009-06-12T23:25:49.107

C＃：

1) 静态方法必须是类的成员

2）静态扩展方法只能添加到静态类

3) 接口函数的实现没有标有“覆盖”之类的东西，以表明它们来自基类或接口（很难确保仅通过代码审查来覆盖您期望的方法（具有正确的签名）） .

我只有3个。我想那还不错。

* * *

## 回答 #109

> 赞同：2
> 
> 时间：2009-06-16T03:34:47.627

Python：

我仍然是 python 的温和用户，所以我的抱怨很可能是知识锁定或误用。欢迎评论。我很喜欢这种语言。

1.  线程支持和 GIL 较差。如果您想使用多核平台，大多数 python 程序员可能会推荐多处理或某种类型，不要使用线程。它不会给你你所期望的表现。
2.  属性仅适用于实例变量。_class_var = property(classmethod(some_method)) 只是行不通。如何获得属性包装的类变量？
3.  没有访问控制。所有访问控制都是语法修饰。像private是__private，protect是_protected等等……希望大家编程python都遵循命名约定。来吧，我们可以做得更好。
4.  我同意简单明了的语法的 Python 哲学，但在我看来，一些简单明了的语法不被支持似乎锁定了良好的判断力。比如，a++，++a，a--和--a，自减/自增，这些有什么问题？foo = (a > b ? a : b) 一元运算，这些有什么问题？（我知道 py2.6 也引入了类似的东西，但是鉴于几乎所有其他语言都对这些简单的语法提供了大量支持，为什么要重新发明轮子？为什么不只是遵循最佳实践呢？一件好事不应该保持良好状态“形式”？）
5.  程序接口。Python 没有接口或抽象类的概念（py3k 有一个叫做 abc 的东西），一切都是具体的。我认为提供“接口”或“抽象”关键字来构建类骨架并保护类继承和扩展并不是一个坏主意。它有助于自上而下的设计。目前，我只需要用 NotImplementedError 填充每个方法，这是一项相当乏味的工作。
6.  我必须添加这个。低于 3.x 的版本具有 str 和 unicode 类型。这是一场真正的噩梦。它使 ascii 和非 ascii/unicode 混合最有可能失败（坏，坏）

我看到人们抱怨速度。我不明白。它是一种解释语言，代码直到运行时才编译为机器代码，这就是它的本质。您无法将解释语言的速度与编译语言的速度进行比较。据我所知，在解释/脚本语言中，python 并不慢。

* * *

## 回答 #110

> 赞同：2
> 
> 时间：2009-07-13T06:32:59.260

**C++**缺乏好的重构工具，缺乏检查异常

**Java**缺少模板，缺少`const`关键字

* * *

## 回答 #111

> 赞同：2
> 
> 时间：2009-09-10T08:55:18.250

**PHP**

*   几乎每个标准函数都在全局范围内
*   函数参数顺序不一致
*   函数命名不一致
*   不区分大小写的函数
*   脚本的行为可能因 php.ini 文件而异
*   能够使用未定义的变量
*   在某些情况下，必须先将结果分配给变量，然后才能在函数中使用它

更主观的是：

*   动态打字

* * *

## 回答 #112

> 赞同：2
> 
> 时间：2009-10-09T19:59:12.220

通用 Lisp

*   缺乏更多现代功能（套接字、线程等）的标准库
*   可以使用映射到本机窗口系统的标准化 UI
*   Scheme 将 lambda 表达式分配给变量并将变量直接用作函数调用的能力看起来比 APPLY for FUNCALL 更简洁。我猜有多个名称空间的副作用
*   库的标准化源代码级打包系统，以便可以在多个实现中轻松使用它们

我想知道强类型的 lisp 会是什么样子

* * *

## 回答 #113

> 赞同：2
> 
> 时间：2010-03-22T17:58:56.880

**C＃**

*   缺少基于方法参数的运行时类型的多重分派。`dynamic`应该可以解决大部分问题，但尚未发布。*   接口实现是声明性的而不是结构性的。我真的很喜欢谷歌的**方式**语言处理类型 的方式*   进行异步方法调用非常庞大（我很确定所有线程都是操作系统线程，而不是轻量级线程）*   没有宏系统。我在这里不是在谈论 C 风格的宏。我说的是 LISP/Scheme 风格的宏*   运算符是静态方法，它们的签名受到过度约束（您不能创建新的）。

* * *

## 回答 #114

> 赞同：2
> 
> 时间：2010-05-23T12:07:39.710

**C＃**

*   引用类型默认可以为空；语言中的 null 关键字是无类型的。
*   缺乏受歧视的工会
*   异常作为*默认*的、非异常的错误处理方法——没有太多的替代方法。
*   过时的 switch 语句语法和限制
*   构造函数+静态方法的不必要区别
*   静态方法不能成为接口的一部分
*   缺乏按形状接口实现而不是显式接口实现 - 导致大量语言设计黑客，例如 linq 查询语法、foreach、集合和对象初始化器 - 没有一个可以灵活重用。例如，对象初始值设定项语法可能很好，但对不可变对象表现不佳。
*   不能独立于实现继承类的“接口”——导致代码重复和提供接口、抽象基类、一些常见实现的过度架构代码，并且无法挑选每个要使用的位。还; 导致太多代码与特定实现紧密耦合，因为通常显式引用实现类型而不是接口。
*   由于类“接口”与其实现紧密耦合，因此无法通过组合进行多重继承；有效地缺乏混合。
*   接口的上述限制导致几乎相同的接口激增，这些接口在任何类型的类型层次结构中都不会自然重叠。 `IComparable`vs. `IEquatable`vs. `IComparable<T>`vs object.Equals vs. operator == 等等等等。通过扩展，制作满足所有这些事情的自定义类型比必要的工作要多得多（特别是对于集合类）。显然，语言设计者意识到了这一点，因此针对 linq、foreach 和集合初始化程序等事物的各种变通方法是按形状而不是按接口工作的。
*   重复使用括号和大括号，而不是布局即结构。
*   返回值可以被忽略，从而限制了类型推断的有效性。
*   枚举不是普通类型，不能有方法。此外，枚举值不是类型安全的，尽管没有 0 值，但可能会初始化为 0。通过将标志和非标志枚举混合在一起来混合隐喻。
*   缺乏适当的值类型支持。值类型不能被继承，具有不同的构造函数语义，并且由于 CLR 限制而性能不佳。此外，关于值类型的语义令人困惑：一些值实际上是值（并且不能修改），而另一些值实际上是非别名、非空引用（变量）。这对于下一个问题尤其令人困惑：
*   字段和属性之间的语义区别，特别是在缺少可变性修饰符的情况下（ala C++'s `const`）
*   不能专门化泛型
*   不能提供默认的泛型类型参数（例如工厂泛型）
*   缺少 typedef 使得泛型使用起来很痛苦（`using`是一种有限但值得了解的替代品！）
*   不能泛化除类型以外的事物（例如函数、纯值或名称）。这意味着您不能执行诸如对依赖属性进行通用实现之类的操作，从而导致诸如依赖属性之类的令人讨厌的实现以及代码片段的过度使用和代码可读性差的结果。
*   指定泛型类型要求的能力有限，例如同时采用 int、double 和 bigint 的泛型 sum 方法（没有棘手且通常很慢的 hack）。
*   接口方法实现或虚拟方法覆盖不能返回更具体的类型或接受更通用的类型；即即使在 C# 4 中也有限的协/逆变支持。

* * *

## 回答 #115

> 赞同：2
> 
> 时间：2010-05-23T12:08:59.633

**我对Nemerle**不满的五件事：

*   局部函数不能产生
*   编译 lambda 的能力有时取决于它是否被内联
*   元组的值/引用类型语义不一致
*   数组索引和类型参数之间偶尔的歧义
*   缺乏普遍采用

* * *

## 回答 #116

> 赞同：2
> 
> 时间：2010-05-23T12:46:35.457

**Clojure**

*   函数定义中的可选参数和关键字参数缺少内置语法。当然，您可以很容易地添加它，但这意味着库编写者不会使用它。普遍的解构尚未被证明是一个好的替代品
*   缺乏方法组合（在 Common Lisp 中找到的那种之前/之后/周围的方法）
*   过于依赖 Java 互操作，例如没有内置文件 IO
*   有时我想要静态类型。这不是纯粹的仇恨；我通常更喜欢动态，并且尝试将两者混合在一起基本上不能令人满意
*   内置数据结构没有内置的快速二进制序列化格式，尽管我听说人们正在研究它

* * *

## 回答 #117

> 赞同：2
> 
> 时间：2010-05-23T13:27:45.457

**Python**，再次：

1.  没有 switch 关键字。不，字典不是它的替代品。连一堆`elif`陈述都没有。

2.  换行处理不一致。为什么我可以这样做：

    ```
     test = (1,
             2,
             3) 
    ```

    并不是：

    ```
    from itertools import cycle,
                          islice,
                          izip 
    ```

    为什么我不能这样做：

    ```
    if stuff \
       and foo \
       or bar:
        return "Formated string with %(arg)s" % \
               {'arg': "bloody slash"} 
    ```

    不使用斜线？

3.  没有一种明显且只有一种方法可以做到这一点。Python 在它的座右铭上失败了，就像 Java 在“一次编写，随处运行”失败一样。

    ```
    # what somebody from an another language would do
    if not test.has_key('foo'):
        test['foo'] = 0
    n = test['foo'] = test['foo'] + 1 
    ```

    对比

    ```
    # what an agnostic beginer would do 
    try:
        test['foo'] += 1
    except KeyError:
        test['foo'] = 1
    n = test['foo'] 
    ```

    对比

    ```
    # what you end up after looking for dictionary default value in the python doc
    test.setdefault('foo', 0)
    n = test['foo'] = test['foo'] + 1 
    ```

    对比

    ```
    # what I would do
    n = test['foo'] = test.get('foo', 0) + 1 
    ```

    最糟糕的是，他们做的事情并不*完全相同*。有细微的差别。

4.  空格和制表符之间的选择。应该没有选择。选择，把它放在石头上，停止战斗。

5.  为什么你可以这样做：

    ```
    test = {}
    test['foo'] = 0 
    ```

    但不是：

    ```
    test = []
    test[] = 0 
    ```

PS：`" ".join(l)`是精人。停止抱怨它，这并不明显，但考虑到迭代器模式，这只是正确的方法。

* * *

## 回答 #118

> 赞同：2
> 
> 时间：2010-05-23T18:01:53.157

通用 Lisp

*   条件不是类（因为类是后来出现的），即使它们的接口几乎相同
*   有些名称很奇怪，例如 flet / labels（唯一区别：范围）和 defvar / defparameter（唯一区别：已定义时的行为）或任何位旋转函数（dpb、ldb 等）
*   包......真的很难正确 - 每次我认为我理解它们时，它们不会做我想要的
*   内置的数据结构和函数并不像它们应该的那样通用（例如，为什么我不能定义我自己的散列函数可移植？）
*   函数、变量等的多个命名空间（原则上我并不反对，但 CL 让它太复杂了；Norvig 说他无法从规范中分辨出来，但似乎至少有 7 个命名空间）

* * *

## 回答 #119

> 赞同：2
> 
> 时间：2010-05-25T18:35:50.847

哈斯克尔

1.  有时类型系统感觉是倒退的。如果我不希望编译器为我的变量推断类型怎么办？如果我想要相反的情况怎么办，它在哪里对所述变量进行约束检查？例如，它不是推断列表元素的类型，而是确保它们都属于特定的类型类。这是一个微妙但巨大的差异，让我很难编写 UI。可以做到，但它比其他一些语言需要更多的努力。Haskell 非常适合非 UI 部分，但我将 UI 留给了无类型语言。

2.  允许构造无限值有时会导致一些非常令人沮丧的错误。

3.  无单态限制。

4.  字节串处理有时会让我很生气，直到你的程序崩溃，因为你不正确地混合它们而你不知道它。当我们丢失本应阻止这种情况的类型信息时，这里出了点问题。

5.  类型类应该为琐碎的情况自动派生，例如见证类型，但那里有很大的滥用潜力。

* * *

## 回答 #120

> 赞同：2
> 
> 时间：2010-05-25T18:41:19.447

C＃

我知道它很愚蠢，但我希望数据类型能够自行转换为我想要的，而无需我添加`(int)`或`Convert.ToInt32`其他任何东西。这只会节省我的时间。让我烦恼的是，如果我写了一些东西来输出 an`int`然后结果我需要 a `long`，那么我经常必须经历并改变我所做的一切以使其工作。只为我做！

抱歉，想不到五个，但我是新手，所以也许我会回来再添加更多：P

* * *

## 回答 #121

> 赞同：2
> 
> 时间：2010-05-25T20:24:25.573

我讨厌 C++ 的五件事

*   链接时间。通过分布式构建，我可以在链接器运行的同时重建整个项目。
*   没有标准的方法来防止内存操作的重新排序。使用写组合内存通常需要滥用 volatile 关键字。防止读取重新排序（在处理 SIMD 数学管道时通常对优化至关重要）通常通过在例程中间注入空 ASM 块来实现。
*   用于解决字符串化问题的多步宏：

```
#define STR_LINE2(x) #x
#define STR_LINE(x)   STR_LINE2(x)
#define LINE_NUMBER STR_LINE(__LINE__)
```

*   进行字符串操作通常很痛苦。
*   非标准化 printf 变体的扩散（vsnprintf_s vs _vsnprintf_s）。

* * *

## 回答 #122

> 赞同：2
> 
> 时间：2010-05-25T20:34:45.823

**C++**

*   涉及模板时的神秘错误消息
*   缺少模板约束（很多情况下可以使用模板元编程来解决，但是在大多数情况下这会导致代码不可读（至少对于普通程序员来说））
*   指向成员函数语法的指针
*   c++ 标准委员会应该更频繁地发布官方标准（或者至少发布标准库本身的单独更新），我的意思是 TR1 是 2005 年发布的，我们仍然没有标准库中的 shared_ptr、bind 等。

* * *

## 回答 #123

> 赞同：2
> 
> 时间：2010-05-25T20:47:35.757

关于C#：

1.  我讨厌没有关键字来指定从 java 中的方法抛出哪些异常。与使用 XML 注释相比，它是一种记录异常的更好方法。
2.  我还希望为通用约束（如约束的 oring 和 anding）提供更好的语法。
3.  为什么一个方法不能返回多个值？
4.  缺乏对语言中面向方面编程的支持。
5.  为什么不能用属性注释每个属性访问器？
6.  缺乏像 perl 那样的内置正则表达式支持。

* * *

## 回答 #124

> 赞同：2
> 
> 时间：2010-05-25T22:25:40.410

**Python**

1.  标准库在许多地方都违反了他们自己的风格准则。(PEP-8)
2.  Py3k 的 super 关键字充满了不需要的魔法（你不能给它分配一个不同的名字，没有*self*也能工作，为什么我们有这个显式参数呢？）
3.  Unicode 支持在 Py2k 中是不完整的，并且在 Py3k 中很糟糕（Unicode 中的标准输入，没有二进制数据！WTF？创建一个新的 WSGI 标准是 hacky。）
4.  吉尔。非常有限的多线程支持（使用 CPython）
5.  PyPI（Python 包索引）很烂。*羡慕的一瞥红宝石*

* * *

## 回答 #125

> 赞同：2
> 
> 时间：2010-05-26T00:37:18.520

PHP：

*   荒谬的 assert() 函数......它在里面的代码上运行 eval()
*   ?> 标签会删除它后面的任何换行符？！
*   数字字符串的奇怪处理（尝试将它们作为数组键）
*   PHP 6似乎*不再支持痛苦的 unicode 支持*
*   入门成本低意味着 95% 的 PHP 程序员给 PHP 程序员起一个可怕的名字——试图在 5% 的人中找到一个人来雇用是疯狂的。

* * *

## 回答 #126

> 赞同：2
> 
> 时间：2010-05-26T01:53:17.677

**Python**

1.  Python 3 没有 Django。
2.  静态类型。是的，动态类型是很棒的东西，但*有时*我确实想让它成为静态的。
3.  适当的 unicode 支持（在 Python 3 中修复）
4.  构造函数命名。我讨厌所有这些都强调了我的代码。
5.  线程效率不高

* * *

## 回答 #127

> 赞同：2
> 
> 时间：2010-09-09T17:06:57.373

EL - 表达式语言，JSP 页面和 JSF 2.0 Facelets 中的`${...}`东西`#{...}`，用于从底层 Java 代码中提取数据。

*   所有有趣的东西，比如带有参数的方法调用和基于注解的命名都只存在于 Java EE 6 的 EL 中，而后者仅在 Glassfish v3 中可用。
*   1) 为早期的 Servlet 2.5 容器获取正确的 jar，以及 2) 在不干扰容器中任何先前可用实现的情况下让它们工作是一件非常痛苦的事情。
*   只有 JSF 的早期版本，如 1.2，带走了方法调用，让您使用 f:setPropertyActionListener - [http://weblogs.java.net/blog/2009/07/22/say-sayon](http://weblogs.java.net/blog/2009/07/22/say-sayonara-spal) ​​ara-spal - 其中，相信我，这不是很好。
*   EL 解析器*不*知道要解析和解释的代码片段来自哪里，所以你倾向于给所有东西一个 id，这样你至少可以识别哪个*标签*让它变得暴躁。
*   Eclipse 在每次调用 EL 方法时都会发出警告，因为它是 JSF 1.2。也只是。

* * *

## 回答 #128

> 赞同：2
> 
> 时间：2011-01-27T04:44:15.547

到目前为止，我最讨厌我最喜欢的语言的事情是我的选择不断变化。每次我认为我找到*了 The One*时，我都会发现五件（或更多）我讨厌的事情。然后那边的草看起来更绿了……

* * *

## 回答 #129

> 赞同：1
> 
> 时间：2008-11-11T22:52:34.333

Python：数组部分选择不能满足您的要求。

a[1] 给你一个元素
a[1:2] 给你一个元素，而不是 [ a[1], a[2] ]
a[1:3] 给你两个元素

我讨厌这样，但也许这只是因为我主要在 Verilog 工作。

* * *

## 回答 #130

> 赞同：1
> 
> 时间：2008-11-12T01:14:31.897

C++

1.  制作一个简单的代码片段需要花费很多时间。
2.  for(std::vector::const_iterator iter = [...]
3.  vector.remove() 不会删除。
4.  vector.push_front() 不存在。
5.  头文件
6.  没有拉姆达
7.  如果至少有一个虚函数，则不会自动清空虚析构函数。

* * *

## 回答 #131

> 赞同：1
> 
> 时间：2008-11-12T08:54:43.963

C＃

*   ~~泛型参数是不变的~~C# 4.0 为泛型类型引入了协变和逆变
*   可覆盖的类成员必须显式标记为*虚拟*

爪哇

*   缺少无符号数字数据类型
*   原始数据类型不是对象

* * *

## 回答 #132

> 赞同：1
> 
> 时间：2008-11-14T00:24:12.567

Python：

*   速度
*   静态分析（缺乏）
*   匿名函数仅限于一个表达式

* * *

## 回答 #133

> 赞同：1
> 
> 时间：2008-11-14T01:13:38.880

红宝石：

*   重要的空白。对于解释器，行尾 = 语句结束，除非该语句看起来应该继续（或者您明确转义换行符）。
*   慢的
*   在线文档不如 Python 的好（在防御方面，Python 非常好）
*   我提到慢了吗？

* * *

## 回答 #134

> 赞同：1
> 
> 时间：2008-11-15T08:18:54.793

红宝石

1.  没有类型推断
2.  方法/函数不是一流的对象
3.  尽管块变量的范围是词法的，但变量的范围不是词法的
4.  def 里面 def
5.  super 和 super() 的区别

* * *

## 回答 #135

> 赞同：1
> 
> 时间：2008-11-24T04:12:33.617

我觉得无法选择最喜欢的语言。动态类型和静态类型不能完全比较，所以我只列出我使用的哪个

C++：

*   模板元编程语法很丑陋。隐式`::value`会使它更简洁
*   `->.`为什么编译器无法确定我正在为我做`ptr.thing`并且只是`->`为我做？
*   我讨厌空白。所以整体`vector<vector<int>>`必须`vector<vector<int> >`让我感到不安，然后每当我看到那行代码时我就无法集中注意力，我最终试图找出一种使用方法`int[][]`或其他东西
*   宏。我个人喜欢宏的概念。但是对于 C++，我认为系统是一个 hack
*   我讨厌`;`

Python：

*   字符串是不可变的。做到了，所以我不能只做 string[4]="b"
*   通过引用隐式复制的列表。哪个泄漏到 [[0]*width]*height 问题
*   缺少尾递归（每当我输入错误的递归函数时，我必须安装 IDLE 以不吐出 1000 条错误消息）
*   字典键不接受列表/字典
*   缺乏深度范围。当我进行列表理解时，我不希望其中的变量影响外部范围

* * *

## 回答 #136

> 赞同：1
> 
> 时间：2008-12-07T02:33:46.680

我可以为 Python 添加另一个：

给定一个列表`l = [l1, l2, ..., ln]`, 那么`repr(l) = [repr(l1), repr(l2), ..., repr(ln)]`, 但是`str(l) != [str(l1), str(l2), ..., str(ln)] (str(l) = repr(l))`. 之所以这样决定，是因为列表中*可能*有一些晦涩的条目，例如`l = ["foo], [bar,", "],["]`并且`str(l)`会返回`"[foo], [bar, ], []"`“可能使用户感到困惑”。但是，这使得`str`仅用于转储数据成为不可能，因为 list 会杀死“仅以可读格式转储数据”。啊！

* * *

## 回答 #137

> 赞同：1
> 
> 时间：2008-12-17T03:40:18.323

MEL（玛雅表达语言）：

*   **单维数组：**强迫我手动同步两个或多个列表，或者使用分隔字符串来模拟更复杂的数据结构。当然，它们也是不可变的。
*   **单线程且速度慢：**导致整个 Maya 应用程序在完成任务时挂起。无法终止长时间操作的奖励积分，而是必须关闭并重新打开 Maya。
*   **脚本来源路径不是递归的：这**意味着您要存储脚本的每个目录都必须添加到脚本路径中。
*   **无命名空间：**强制使用不一致的命名约定以确保全局过程不会发生冲突。
*   **模态命令：** 每个命令都是模态的，这意味着创建、修改和查询操作都是通过设置标志来处理的。这也迫使开发人员导致大多数命令返回数组
*   **不一致的命令样式：**大多数数组命令实际上返回数组，但 Tokenize 命令必须将数组作为参考，然后填充，而不是吐出数组。这与其他不一致。

这些和其他几个原因是 AutoDesk 采用 Python 作为辅助脚本语言的原因，这带来了一些其他令人讨厌的因素：

*   **并非所有 MEL 命令都受支持：**大多数都受支持，但您时不时会发现自己不得不使用 mel() 函数来执行一些任意代码。更糟糕的是你必须对它进行所有烦人的逃避。
*   **继承了模态命令样式：**必须使用相同的 create=True、query=True、edit=True 的东西。

* * *

## 回答 #138

> 赞同：1
> 
> 时间：2009-01-03T14:09:53.097

C是我最喜欢的，但它也很糟糕。

*   它拥有有史以来最糟糕的预处理器。他们为什么不使用 m4 之类的东西？
*   整个头文件与源文件模型被破坏了。帕斯卡在单位方面做得很好。
*   它需要 switch 语句中的 case 范围。
*   来自 void* 的联合和强制类型转换破坏了类型系统。这使得垃圾收集器成为不可能。
*   没有嵌套函数。GNU C 有这个，但它应该是标准的。
*   不对分配的内存进行边界检查。有一些工具可以发现这一点，但它们不会检测到一段代码错误计算地址并写入根本不相关的分配区域的错误。我讨厌整个指针算术。
*   没有对数组进行边界检查。
*   关于便携性的问题太多了。甚至 wchar_t 也因平台而异。

* * *

## 回答 #139

> 赞同：1
> 
> 时间：2009-06-12T23:18:11.137

**雷博尔**

REBOL 是*我*最喜欢的语言之一。我不能说我有一个最喜欢的，尽管 Haskell 的排名也很高。

1.  它奇怪的语​​法吓跑了许多开发人员，甚至在他们尝试之前。

    ```
    使用 [电子邮件规则 url] [

    ```
    ; A small DSL that sends email to people about URLs.
    rules: [
        some [
            into [
                set email email!
                set url url!
                (send/subject email url reform [ "Check Out" url ])
            ]
        ]
    ]

    ; Global context
    notify: func [ [catch] dsl [block!] ] [
        unless parse dsl rules [
            throw make error! "You screwed up somehow."
        ]
    ] 
    ```

    ]

    通知 [[a@b.com http://www.google.com] [b@c.com http://www.yahoo.com]]
    ```

2.  递归方言很容易验证，`PARSE`但很难评估。（堆栈在这里会有所帮助。）

3.  REBOL 与许多流行技术的集成很差，尤其是 XML。我怀疑这部分是自大，因为 REBOL`BLOCK!`数据类型几乎可以做 XML 可以做的所有事情。但是，现实世界中有 XML。
4.  没有统一码。
5.  感谢 AltMe，REBOL 的用户社区非常孤立。我能理解他们为什么要使用 AltMe。它是用 REBOL 编写的，展示了它的优势。不幸的是，这也让他们离开了自己的小岛。

即将到来的 REBOL 3 有望解决其中的许多问题，除了最后一个问题。

* * *

## 回答 #140

> 赞同：1
> 
> 时间：2009-10-12T16:34:16.463

C＃

1）缺乏为值类型编写泛型的实践能力。例如，任何白痴（大多数白痴）都可以在 C++ 中编写一个计算 int、float、double 等列表的标准差的例程，它易于编写、易于阅读并且执行速度与非通用代码一样快. 我认为，如果您可以用 C# 编写一些接近于这 3 个中的任何一个而不在其他 2 个上荒谬的东西，那么您就是一个非常出色的程序员。

2）协方差和反方差，尽管这被添加到 4。

3) LINQ 的文档极差（好吧，不是语言的一部分）。

4）当我每次都想做同样的事情时尝试使用 foreach/iterators，除了上次略有不同的事情（例如在它们和单词之间以及在最后两个之间用逗号连接一堆字符串）。如果我用 IEnumerable 编写它，则很难读写，而使用 for (int i=0 i < ...) 并不会好很多，效率也较低。

5）我知道我会对此提出投诉，但缺乏检查异常。这不需要像在 java 中那样实现（框架开发人员确实对他们为什么不这样做提出了一些非常好的观点），但我会很高兴编译器警告不喜欢检查异常的用户可以关闭。

* * *

## 回答 #141

> 赞同：1
> 
> 时间：2009-11-25T07:17:56.597

## 昆雅语

• 社区太小。当附近很难找到另一个演讲者时，几乎不可能进行一个好的语言沉浸式程序。
• 不规则动词。是的，我知道英语和西班牙语也提到了它们，但昆雅语是*发明*的。为什么还需要不规则动词？
• 不支持Unicode。我必须在我的计算机上安装三种不同的 Tengwar 字体才能阅读大多数消息，其中一些字体的字距很差。考虑到罗马化转录的存在，这真的不是一个大问题，但是 Tengwar 是如此美丽，你不想使用它。
• 并非所有概念都可以在昆雅语中轻松引用，这会导致烦人的迂回曲解，或者诉诸辛达语、努门诺尔语或（Manwë 救我）克林贡语来表达我的观点。

* * *

## 回答 #142

> 赞同：1
> 
> 时间：2010-01-02T08:27:14.147

**C＃**

一直以来对 C# 最讨厌的人必须是：

**(1)**事件对所有侦听器都有强引用，从而防止对侦听事件的任何东西进行垃圾收集。如果您想查看这导致的问题，只需在网上搜索所有试图通过创建某种“弱引用事件处理程序”来解决问题的人。

**(2)**在调用之前需要检查事件是否等于 null 似乎应该由语言处理。

**(3)** XML 序列化程序无法读取/写入 XML 文件中的注释。在手动和用 C# 编写的工具修改 XML 文件的环境中效果不佳。可以通过仅使用原始 XmlDocument 来解决，但能够将其抽象为一个类会更好。

**(4)**构建过程不允许您直接访问 xsd 文件之类的内容，而是需要一个中间步骤来创建 C# 部分类。这也会导致 XAML 文件出现问题，有时您需要重新构建两次才能使更改正确通过。

**(5)**不支持 MMX 和 SSE 1、2、3、4 等 CPU 内在函数，因此在运行 C# 应用程序时，这些宝贵的 CPU 功能未被利用。

其他没有进入我的前 5 名的：

**(6)**不能将字段标记为属性，所有属性都必须从一开始就显式实现：

例如，目前有：

```
public class MyClass {
    private int someInt;

    public int SomeInt {
        get {
                return someInt;
        }
        set {
                someInt = value;
        }
    }
} 
```

想

```
public class MyClass {
    [IsProperty(public, get, set)]
    private int someInt;
} 
```

**(7)**不支持多个返回值，例如：

```
public int, string, double MyFunction()
{
    ....
    return x,y,z;
}

public void TestMyFunction()
{
    int x, string y, double z = MyFunction();
} 
```

**(8)**不支持协变返回类型

我对泛型实现有一些抱怨，但我会在那里切开它。我认为 C# 是一种用于执行所有 GUI、网络和配置管道的出色语言，并且是我以一种可以长期支持的方式快速启动和运行的第一语言。

* * *

## 回答 #143

> 赞同：1
> 
> 时间：2010-02-07T21:23:28.320

**Python**

那些我只是不明白...

*   `math.ceil()`并`math.floor()`返回浮点数，而不是整数（可能是为了避免底层 C 函数中的整数溢出 - 但为什么不强制转换为 Python long？）
*   `len()`是函数不是方法
*   `reload()`非常有限，在 10 次中不会重新加载模块 9 次，如果它是模块，则仅重新加载导入的标签 - 即`from bar import foo; reload(foo)`如果 foo 本身不是模块，则不能这样做
*   可变的默认参数只有一个引用（为什么每个函数调用都没有一个新实例？！）
*   所有这些带下划线的变量——如果它们如此私密，我们怎么会在代码中看到如此多的内置变量？获取命名空间！
*   字符串是不可变的 - 也许有一个很好的理由，但我遇到过很多我想调整一个特定字符的情况......

那些基于实现有意义但很烦人的......

*   `array.sort()`不返回数组（我想它发生在原地）
*   列表/生成器推导没有定义新的范围（只是`for`循环的语法糖，对吧？）

和一对在 Python 3 中修复的

*   默认整数除法
*   `global`只能引用顶级命名空间

* * *

## 回答 #144

> 赞同：1
> 
> 时间：2010-02-16T12:50:21.917

斯卡拉：

*   标准库的怪异之处：它并不总是展示最佳实践，而且文档不足
*   硬编码的 FunctionX、TupleX 类
*   缺乏属性：getter 和 setter 是分开的，这违反了 DRY，并使 FRP 之类的东西几乎不可能
*   需要 = _ 来初始化属性

* * *

## 回答 #145

> 赞同：1
> 
> 时间：2010-03-23T17:09:28.893

我的德尔福 5：

1.  如果没有参数化，过程和函数不一定与变量区分开来（例如，我可以使用诸如 x := GetPositionOnScreen; 而不是 x := GetPositionOnScreen(); 之类的语句）
2.  Try/Finally 和 Try/Except 需要嵌套（之前说过一次，但它仍然是我的一个）。
3.  不区分大小写。
4.  可以有多个对象（函数、全局变量、局部变量）命名相同，Delphi 会很高兴地尝试弄清楚你的意思。名称应该是唯一的。
5.  奇数 if 条件规则。单个条件检查不需要 () 围绕它，但如果我进行多个检查，我需要一个 () 围绕每个检查，有时需要多个嵌套集以进行更大的检查。
6.  没有继承的包含。如果我需要在基础形式和继承形式中引用 Windows 单元的功能，我必须在两者中都包含 Windows。

* * *

## 回答 #146

> 赞同：1
> 
> 时间：2010-05-23T11:21:20.230

*经过一番思考，重新写了...*

尽管我喜欢 PHP，但我讨厌 PHP 的五件事（排名不分先后）：

*   内置函数中的命名和参数顺序不一致。
*   多亏了 SPL，面向对象的数组方法，但遗憾的是（还没有）。
*   PHP 本身没有真正的并发性，只能通过托管网络服务器进行多处理
*   没有像 JavaScript 那样的异步调用
*   仅通过扩展缓存操作码。不是很糟糕，只是很烦人。

这些是让我烦恼的语言特性（或缺乏），但更大的问题是这些更多的人/社区相关的事情：

1.  事实上，很多使用 PHP 的人对编程和一般的良好实践一无所知，并且产生了非常混乱的代码。JavaScript 也有同样的问题。

2.  大量的教程/书籍教授非常糟糕的做法和风格。这可能是#3的主要原因。

3.  它的坏名声主要是因为#3 和#4。

* * *

## 回答 #147

> 赞同：1
> 
> 时间：2010-05-23T12:15:35.217

不得不假设我们有一种语言。我们要不要？

* * *

## 回答 #148

> 赞同：1
> 
> 时间：2010-05-23T14:59:59.260

### C＃

我对 C# 很满意，但这两个真的让我很恼火：

*   不可变类的基于构造函数的初始化不太方便，不太直观（当您阅读代码时，您不了解分配给了什么），比内联对象初始化具有更少的 IDE 支持。这使您不可避免地倾向于可变类。我知道这之前已经提到过，但是我在不可变类的初始化语法方面确实存在问题。

*   `switch`太冗长了。每当我看到适当的开关情况时，我真的倾向于使用`if..else if..`just 因为它更简洁（打字少了约 30%）。我认为 switch 应该没有失败，`break`应该是隐含的，并且`case`应该允许逗号分隔的值列表。

* * *

## 回答 #149

> 赞同：1
> 
> 时间：2010-05-23T16:54:33.900

许多人认为 Java 很慢，但我同意一定程度的使用。

Java 是戏剧性的。他们有很多课程只是为了你想做的一件事。但是你知道灵活性属性 XD。

Java 一开始很难，但一如既往的有趣。

当您编写用于打印“Hello,World！”的简单代码时 请不要使用 JAVA！XD 我确信我是有道理的。

Java 是一种混合体，所以不要说它纯粹是一种 OOP 语言。

还有更多，但我只限于五个 XD。谢谢！

* * *

## 回答 #150

> 赞同：1
> 
> 时间：2010-05-25T19:05:44.247

C＃

1.  没有简单的方法来检查类型是否为数字
2.  这意味着您可能无法使用大多数 microsoft stack、IIS 和 MSSQL
3.  C# 不是针对特定问题的特定工具，而是尝试成为每种范式的语言。
4.  缺乏社区。当然，已经开始有 C# 的开源框架和库。Java 开发人员多年来一直可以使用的相同。
5.  很难找到好的帮助。互联网上充斥着如何用 C# 解决问题的糟糕例子。这又回到了问题 #3。

* * *

## 回答 #151

> 赞同：1
> 
> 时间：2010-05-25T20:30:30.913

**JavaScript**

来自 ECMAScript 5 规范：

*   7.6.1.2 未来保留字：

    类、枚举、扩展、超级、常量、导出、导入

    **在严格模式下：** implements、let、private、public、interface、package、protected、static、yield

*   11.9.4 严格等于运算符 (===) 与 11.9.1 TheEqualsOperator(==)
*   11.9.6 严格等式比较算法（NaN === NaN 为假）
*   8.5 数字类型 - 没有真正的整数，一切都是浮点数。
*   4.2.1 对象——原型继承

好吧，我有点喜欢最后一个，但它有 7 种令人困惑的地方

* * *

## 回答 #152

> 赞同：1
> 
> 时间：2010-05-25T20:38:42.987

**VB .NET，但这只是因为 VB6 毒害了整整一代程序员**

我在一家曾经是 VB6 商店的 VB .NET 商店工作，在这里工作的每个曾经是 VB6 开发人员的人都固执地拒绝学习任何有关 .NET 的知识。他们的代码就好像它仍然是 VB6，他们的应用程序就像 VB6 应用程序一样糟糕。我的老板非常不鼓励任何使用 LINQ，因为她担心其他人难以理解，这是真的，因为没有人想理解它。

我认为如果 MS 只使用 C#，我们都会变得更好，这让我很难说，因为我认为花括号远不如 VB 冗长的结束语句。

* * *

## 回答 #153

> 赞同：1
> 
> 时间：2010-05-25T21:22:51.993

红宝石。

1.  奇怪的范围规则——变量、常量和方法的行为彼此不同。规则也会根据您用于创建闭包的关键字而改变。或者你是否在一个类、特征类、对象、模块或模块的自我中。然后是instance_eval，它将规则更改为一组不同的规则。当一个模块被“包含”或“扩展”时，它们会再次改变，它们本身对范围做了不同的事情。并且有些规则集是元编程无法模拟的，所以必须使用eval。除非您使用的是 ruby​​ 1.9，否则所有这些都是不同的。
2.  命名空间基本上是没用的。如果您有 Foo::File，则所有 Foo 的 stdlib 文件可能都已损坏。
3.  要求语句被破坏。如果两个文件相互需要，则这些文件的行为可能会发生巨大变化，具体取决于首先从其他地方加载哪个文件。
4.  库会急剧而突然地更改 API，因此您必须要求所有依赖项的特定次要修订号。对于系统上的每个 ruby​​ 应用程序。
5.  rubygems 包系统覆盖“require”而不是将文件放在搜索路径中 - 因为当您可以替换系统时为什么要使用它？

* * *

## 回答 #154

> 赞同：1
> 
> 时间：2010-05-25T22:06:21.207

### 蟒蛇 3

*   **制表符和空格都允许缩进**
    你会认为人们从过去学习（Makefile）。只需选择空格并禁止制表符。*YAML 做对了。*
*   **缺乏流行的第三方库**
    标准库很棒，但是 Python 2 如此强大的很多原因在于第三方领域。*Python 2 做对了 :-)。*
*   **IEEE 浮点数**
    编程语言中的浮点数令人困惑，因为它们与我们在数学中使用它们的方式不同。相反，应将数字运算视为仅在需要时才转换为小数点格式的表达式（即打印到屏幕上）。*我认为 Maple 和 Mathematica 做得对。*
*   **标识符的字符集过于受限**甚至
    `list.empty?`优于. 同样，会比. *Ruby 和 lisp 做到了这一点。*`list.is_empty``len(list) != 0``process.kill!``process.kill`
**   **当调用一个函数时，你必须*总是*写括号**
    如果我们可以在明确的情况下省略它们会很好。又怎么样了？`dict.items`还是`dict.items()`？*Ruby 也做对了这一点。**

 ** * *

## 回答 #155

> 赞同：1
> 
> 时间：2010-05-26T00:03:02.190

Python：

1.  没有标准的 GUI 工具包（社区对此进行了反复讨论，但似乎从未解决过任何问题）。

2.  分发和安装 Python 应用程序和库的工具和方法的演变一直很艰难。（尽管最近这似乎越来越接近修复。）

3.  随着解释器的使用，CPython 仍然很慢（尽管 PyPy 这些天看起来不错，如果它成为“标准”Python，这个问题就会消失）。

4.  你不能在不覆盖很多方法的情况下子类化内置类（例如，list 和 dict），即使你想做的只是简单地挂钩到事件中（例如，挂钩到正在添加或删除的项目）从列表中，您需要覆盖**delitem**、 append、extend、insert、pop 和 remove ——没有可子类化的“更改”事件通知，也没有任何“受保护”方法可以排除上述所有方法使用的通用代码）。

5.  在 virtualenv 被发明之前，在一台机器上为不同的目的保留不同的 Python 环境是一件非常痛苦的事情。

* * *

## 回答 #156

> 赞同：1
> 
> 时间：2010-05-26T08:30:07.713

**Java** - 不支持语言级别的组合

* * *

## 回答 #157

> 赞同：1
> 
> 时间：2010-05-29T18:57:57.027

爪哇：

1.  很不协调。
2.  图形 API 有时使用起来很痛苦
3.  NullPointerExceptions 不会告诉你什么是 null
4.  我编写的程序有时无法在不同的 JVM 上运行，这是一个巨大的痛苦，并且与 Java 的“一次编写，随处运行”的声明相矛盾。
5.  挥杆没有它应该的那么好。

* * *

## 回答 #158

> 赞同：0
> 
> 时间：2008-11-14T00:29:15.770

VB.NET

1) If Not x Is "foo" (而不是 <> "foo")
2) "OrElse" 和 "AndAlso" 短路（而不是简单的 "Or" 和 "And"，它们的作用不同）
3) 没有（而不是空）

* * *

## 回答 #159

> 赞同：0
> 
> 时间：2008-11-24T15:18:20.277

C# 中缺少预处理器。

我知道他们忽略了它，因为有些人会滥用它，但我认为他们把婴儿和洗澡水一起扔了出去。代码生成被认为是一件好事，而在 C++ 中，预处理器是我的第一行代码生成器。

* * *

## 回答 #160

> 赞同：0
> 
> 时间：2009-02-05T00:18:34.800

爪哇：

*   没有程序编码，它编译成程序代码，所以让我使用它！
*   没有多重继承，试图用 15,000 个接口做同样的事情很糟糕。
*   约会课，我还需要多说。
*   我不能完全使用多态性。Java 不会覆盖要触发的不同参数类型。
*   我想不出第五个原因，如果我这样做了，我会回来编辑这篇文章。

* * *

## 回答 #161

> 赞同：0
> 
> 时间：2009-05-28T08:52:52.803

Python：

1）它是一种脚本语言，而不是完全编译的语言（我希望能够编译二进制文件——我不关心字节码）。如果我必须使用非常多的库（即每个使用我的程序的人都必须安装所有库，这基本上意味着没有普通人能够或有耐心正确设置它——除非我做了很多不必要的工作）。我知道制作二进制文件的方法，但它们并不*总是*工作，我猜他们无论如何都将解释器捆绑在二进制文件中（我不希望那样）。现在，如果我能得到一个字节码编译器，它将包含我导入的所有文件（并且只有那些）的副本放在我的程序文件夹中，这可能是一个合适的折衷方案（那么没有人需要下载额外的库和这样的）。如果可以将编译后的 python 文件压缩成一个文件，并指定一个文件作为在此完成之前运行程序的文件，那也很好。

2) 有时似乎有点马车；有几次本应工作的代码根本没有（没有程序员错误），特别是与“from moduleX import *”等相关的代码，以及其他与导入相关的问题，以及一些与到全局变量和局部变量。

3) 最大递归深度可能更高。至少有一次我觉得我需要它走得更高。

4) 没有 switch 语句（更不用说允许数字、字符串和范围的语句了）

5) 较新的 Python 版本似乎取消了许多有用的字符串操作，而且它们似乎没有简单的文档说明如何在没有它们的情况下执行相同的操作。

6）强制自动垃圾收集（我希望*能够*手动完成，尽管不一定强制这样做）。

7) 没有使用 GUI 就没有预制的 Timer 类（嗯，可能有一个，但经过我的所有搜索，它肯定不方便找到！我确实找到了一些东西，但它没有当我尝试它时完全可以工作。）通过计时器，我的意思是每x秒执行一次指定功能的排序，并且能够在需要时将其关闭，等等。

8) 社区中给出示例的人很少告诉他们导入了哪些模块，以及如何导入它们。

9) 与 Lua 集成的支持不多。

10) 似乎没有办法将额外的函数添加到类的特定实例（而不是整个类），除非您动态地将对象变量添加到具有所需功能的对象的类中（但是，您仍然必须为此开设另一个课程）。

* * *

## 回答 #162

> 赞同：0
> 
> 时间：2009-11-25T07:13:12.530

## C＃

**5\. 空合并运算符**

这 ？？运算符允许您编写：

```
x = y ?? z; 
```

代替：

```
x = (y == null) ? y : z; 
```

我喜欢这个运算符，但我想要另一个：

```
x = y ??? y.foo() : z.foo(); 
```

代替

```
x = (y == null) ? y.foo() : z.foo(); 
```

我一直在使用这种东西，而且我觉得打字很烦人`== null`。

* * *

**4.equals应该有更好的支持**

我必须从每个`Equals(object obj)`方法开始： MyClass other = obj as MyClass; 如果（其他 == null）返回假；

你应该只需要写：

```
public override bool Equals(MyClass other) {...} 
```

并且语言应该注意提供`Equals(object obj)`方法。
注意： other 应保证不为空。

* * *

**3\. 不能使用不同类型的三元运算符**

这不编译，我认为它应该！

```
string foo = "hello";
int bar = 4;
object baz = foo == null ? foo : bar; 
```

* * *

**2\. 缺少命名空间私有**

我喜欢这种`internal`保护，但我希望有一种保护只允许从同一个确切的命名空间内访问。这将有助于更好地控制大型类库中的访问。

* * *

**1.没有多重继承**

我真的只对接口的默认实现使用实现（类）继承，但有很多时候我想这样做。

* * *

## 回答 #163

> 赞同：0
> 
> 时间：2010-05-04T07:57:12.257

## 超话：

*   很久很久以前就死了
*   没有简单的任务（你不能只说`a := 3`，你必须说`put 3 into a`
*   没有嵌套函数
*   没有真正的数据结构，只有字符串。要制作“列表”，您可以使用 分隔项目`itemDelimiter`并手动对其进行转义。您还可以获取线条和单词，例如`get word 2 of line 5 of txt`

顺便说一句，我认为 HyperTalk 独有的最酷的功能之一是特殊`it`变量：

```
ask "How many years old are you?"
answer "You are " & it*12 & " months old." 
```

* * *

## 回答 #164

> 赞同：0
> 
> 时间：2010-05-04T08:53:05.133

Python

*   没有命名空间。
*   伪私有属性/名称修改（主要使用 getattr）。
*   文件路径操作分布在多个模块中。将 os.path 调用串在一起很难看，难以阅读，而且在大多数情况下，违反了 DRY。常见的文件路径操作仍然没有方便的功能，例如获取目录中的文件列表。修复此问题的`path`-type 模块被拒绝。

( `[f for f in os.listdir('/file/path') if os.path.isfile(os.path.join('/file/path', f))]`)

*   Python 文档（我非常、非常、非常感谢有文档，而且它的格式很好，但我讨厌通过 5000 行快速入门使用示例来查找特定模块的单个函数文档（我'我看着你 optparse 和记录））。内置类型在近 10 个不同的地方被零星地记录。

* * *

## 回答 #165

> 赞同：0
> 
> 时间：2010-05-04T09:39:28.760

**卢阿**

*   如果您执行 foo.bar(1,2) ，则 bar 方法中的 'self' 为零。您必须记住改为执行 foo:bar(1,2) 。我宁愿切换（'self'应该默认定义，除非你使用'：'运算符，或者你调用一个不是方法的函数）。
*   变量默认是全局的。我宁愿放弃“本地”关键字，而改用“全局”关键字。
*   未声明的变量被分配为零。我宁愿收到一条错误消息。您可以通过操作全局 env 的元表来回避这一点，但我宁愿让它默认实现并能够停用它。
*   参数上的多个返回值处理得不是很好。假设您有一个函数 foo() 返回 1,2,3（三个值），而 bar() 返回 4,5（两个值）。如果你做 print(foo(),bar()) 你会得到 "1,4,5" ...只有 "last" 元组在调用时被扩展。
*   #（表长度）运算符仅适用于以连续整数索引的表。如果您的表不是这样，并且您想知道它有多少元素，则需要使用循环解析它，或者每次插入/删除元素时更新计数器。

* * *

## 回答 #166

> 赞同：0
> 
> 时间：2010-05-04T10:13:49.573

我刚刚发现在 c# 中创建通用方法时我不能使用 Enum 作为类型约束。

微软对原因有足够好的解释，但仍然如此。我生气了

```
public static T MyFunc<T>(string arg) where T:Enum //wont work :( 
```

* * *

## 回答 #167

> 赞同：0
> 
> 时间：2010-05-04T11:46:27.410

JavaFX

*   类型推断有时不会像您预期的那样运行，因此您经常需要显式声明类型。
*   def 的行为类似于 C 中的 const 而不是 Java 中的 final
*   您可以通过访问索引> = seq.length 在序列中插入一个值，这实际上应该引发编译器错误（根据参考）。
*   如果将 null 分配给字符串，则默认为“”。如果将 null 分配给 Integer，则会引发编译器错误（与参考中所说的相反）。
*   以与 RuntimeExceptions 相同的方式处理 CheckedExceptions

* * *

## 回答 #168

> 赞同：0
> 
> 时间：2010-05-08T21:37:48.807

C＃

*   无法创建引用（var &t = struct）
*   没有本地范围的析构函数（IDispose 接近但不一样）
*   ToString，我几乎不喜欢每个对象都有它，但事实证明我不喜欢使用它的所有东西，就像 string.format 一样。我宁愿接受某种类型的东西（如整数、浮点数、文本、字符）。因此，我不需要传入任何对象，而是需要传入带有隐式类型转换或接口的东西。我最终写了这样的东西来安全地转义 html 的文本，效果很好。
*   不能使用虚拟类型转换 (blah)obj；如果 obj 不继承/不具有 blah 的接口，则不起作用。简单的解决方法是提供具有转换功能的接口。
*   没有本地创作。而不是写 var o = new Item(); 我想写（类似的东西）`Item o()`（如果有的话，自动处理）。

* * *

## 回答 #169

> 赞同：0
> 
> 时间：2010-05-25T17:56:11.840

*   length 属性很容易与 length() 函数混淆；改用 size()
*   在选择器字符串中插入变量的语法('" +$.month+ "') 很糟糕
*   $(event.currentTarget) 并不总是适用于冒泡和捕获
*   属性语法 ("[class='foot']") 在选择器语法 (".foot") 不返回任何内容的地方起作用
*   包含选择器 ([class~=done]) 有时会在 JavaScript (this.className.search("done") > 0) 工作的地方失败

* * *

## 回答 #170

> 赞同：0
> 
> 时间：2010-05-26T05:31:06.500

Python：

*   没有表示块结束的分隔符会引入歧义，因此自动缩进不适用于格式错误的代码。
*   没有宏（装饰器不算）
*   没有像 haskell 的 cabal 或 perl 的 CPAN 这样的库自动获取
*   不能声明变量 const （是的，可以扮演自己的角色，但是......）
*   元编程被削弱了
*   差点忘了全局解释器锁

* * *

## 回答 #171

> 赞同：0
> 
> 时间：2010-05-26T08:08:32.970

我只有一个，但我相信它值得分享。

**CSharp / .NET**

我们有 Length 属性来获取数组中的元素数量和 Count 属性来获取集合中的元素数量。如果您考虑到 CLR 自动将 IList、ICollection、IEnumerable 添加到从零开始的一维数组背后的事实，它看起来会更加奇怪。

我相信 CLR 团队和 BCL 团队很难讨论这个主题；）

* * *

## 回答 #172

> 赞同：0
> 
> 时间：2010-05-26T08:22:09.737

对象帕斯卡：

*   您正在编辑的文件中有很多来回跳转，因为接口和实现分为两部分，但仍然卡在同一个文件中。
*   数组的动态索引，字符串从 1 开始，在声明固定数组时指定起始索引，动态分配的数组总是从 0 开始。
*   类和对象（更不用说接口）固定在语言之上，除其他外，不能像记录那样进行堆栈分配。
*   当调用不带参数的函数时，() 是可选的，当您处理函数指针或尝试使用函数名引用函数的结果时会导致很多痛苦。
*   没有外部类型定义，参数列表无法处理固定数组类型或函数指针类型。

这只是语言，标准库和易碎 IDE 的遗憾借口应该有自己的清单。

* * *

## 回答 #173

> 赞同：0
> 
> 时间：2010-05-26T19:30:29.933

Objective-C 2.0

严格遵守语言和运行时，而不是库，也没有任何特定的顺序：

1.  缺少 cVar。
2.  没有模块。我对缺少命名空间并不十分不满意，但是拥有模块会很好。
3.  基于 Ivar 的属性语法要求在 3 个位置使用变量名进行声明。这是相当可怕的。
4.  C遗产。除了 OO 和 GC，C 语言的任何讨厌之处都存在。
5.  对象不能存在于堆栈中。与 Obj-C 相比，它对其他语言的编程实践没有什么问题。例如，当我在 C++ 中的堆栈上获得返回值时，我觉得很奇怪。如果我在编写代码时实际上并没有查看库文档，我会假设每个函数都返回一个指针，这通常会在以后进行一些重要的清理。

* * *

## 回答 #174

> 赞同：0
> 
> 时间：2010-05-27T18:51:59.293

Python：

1) 行继续语法：“...\”有效，但“...\”无效，并且尾随空格通常是不可见的，编辑器没有异常的 eol 标记。
2) 堆栈跟踪中不可见裸露的“引发”，因为堆栈跟踪看起来像之前引发的异常。
3) 慢
4) 与网络服务器的集成不佳（mod_python：已死，mod_wsgi：操作范围有限）。这被 3] 复杂化了，需要守护进程或某种内存持久性才能正常运行。
5) 过度容忍混合制表符和空格，允许对控制流的更改有时保持隐藏。（可能在最近的版本中修复）

* * *

## 回答 #175

> 赞同：0
> 
> 时间：2011-01-22T12:06:51.960

**卢阿：**

*   **内置的错误系统绝对可怕**

    你可以通过修改 Lua 解释器来实现一个 try-catch 系统；但它与内置函数抛出的错误不兼容。

*   **他们有 __newindex 而不是 __setindex 作为设置器的事实**

    ...并且 __newindex 仅在密钥不存在时才被触发。如果是这样，则根本不会调用元方法。

*   **没有好的类型比较系统。**

    有 type() 函数，但它只处理基本类型（所有表都是表）。它确实需要一个用于类型比较的元方法。我之前使用 'is' 运算符和 __type 元方法实现了这一点，它工作得非常好。

*   **定义新关键字是个婊子。**

    你可以做到，但是 Lua 中的代码没有很好的文档记录，所以要找出如何得到你想要的结果是一种反复试验。当你想自己实现我上面提到的东西时，这是一个主要问题（虽然不是那么多 __setindex，这是一个简单的修改）。

*   **我无法在网络浏览器中使用它。**

    是的，语言本身并不是真正的问题，但是该死，我希望能够使用 Lua 而不是 Javascript... :)

* * *

## 回答 #176

> 赞同：0
> 
> 时间：2011-01-26T11:23:22.770

C

*   字符串处理
*   内存管理（决定谁应该分配和谁应该释放它）
*   没有命名空间（最大）
*   标准库中没有列表/数组和其他基本 DS

JavaScript

*   使用不带 var 的变量会自动使其成为全局变量
*   分号不是强制性的
*   比较运算符“==”和“===”及其用法的混淆
*   没有适当的支持来处理二进制数据
*   再次..没有命名空间
*   变量没有块作用域。（来自C世界的很烦人）

* * *

## 回答 #177

> 赞同：-1
> 
> 时间：2009-02-19T06:48:55.353

**Python**

*   慢的
*   终于习惯了print语句，现在有了这个print函数？？？(py3k)
*   从来没有 py2exe 或 cxFreeze 工作
*   不标准化（轻微挑剔）
*   递归深度仅为 100 (iirc)

* * *

## 回答 #178

> 赞同：-1
> 
> 时间：2010-01-19T12:12:48.620

**VB.NET**

*   默认情况下弱类型*（Option Strict 修复此问题，但默认情况下未启用）*
*   方法上不需要括号*（myFunction 而不是 myFunction() 等等）*
*   是否使用括号进行数组定义/使用*（myArray(12) 而不是 myArray[12]）*
*   不支持直接递增 (i++)
*   是否支持遗留`On Error`关键字和整个 VB6 命名空间

* * *

## 回答 #179

> 赞同：-1
> 
> 时间：2010-05-26T19:43:32.900

C# 4.0

“动态”关键字，很容易被滥用。如果您想/需要使用反射，请使用并使其明显您正在使用它，不要尝试用动态来伪装它。

* * *

## 回答 #180

> 赞同：-2
> 
> 时间：2010-05-04T08:21:37.747

我讨厌**Python**的地方：

*   没有编译器
*   它没有被认真对待

Python让我烦恼的事情：

*   `(self,`
*   不`private`
*   破坏兼容性

* * *

**我讨厌PHP** 的五件事：

*   当它显然是一个错误时“按预期工作”
*   不`goto`
*   错误的引用 ( `foreach $arr => &$val`... `foreach $arr => $val`)
*   没有多重继承
*   没有一个编译器可以在不向黑暗之神献祭一只羔羊的情况下真正工作

* * *

## 回答 #181

> 赞同：-2
> 
> 时间：2010-05-25T20:27:01.480

[SAS](http://en.wikipedia.org/wiki/SAS_%28software%29)

*   从来没有自己的想法（一切都是借来的）。

*   贪婪的庞大数据集。

*   使用 Java，但从未了解对象是什么。

*   窃取 Perl，但将其隐藏在其数据步骤中。

*   永远和统计学家说谎！

* * *

## 回答 #182

> 赞同：-7
> 
> 时间：2008-12-19T23:43:25.893

Perl 代表一种可怕的语言。

1.  没有“公共”或“私人”或“受保护”声明/定义。
2.  “我的 $variable_name;” 不声明子例程之外的全局变量。
3.  “我的 $variable_name;” 被子程序访问但“使用严格；” 或其他“使用”会产生警告。
4.  函数原型最终会出现无法解释、未证明、不需要或其他一些借口。
5.  在阅读大量符号时，过度使用符号最终会“酷而快速”。
6.  当一个人变热时，他们喜欢保持热度，并且不需要任何东西来冷却它们。
7.  经过一周的 Perl，我最终无法编写函数并对其进行原型设计。
8.  模块到底是什么，它真的需要“.pm”扩展名吗？
9.  如果您想创建一个公共变量并从子程序内部访问它，您如何在不产生警告的情况下完成此操作？
10.  你在哪里可以找到一些可以教人一些简洁的 Perl 的简洁脚本？

# java - java web 应用程序装饰/包含问题

> ID：282332
> 
> 赞同：1
> 
> 时间：2008-11-11T22:15:42.273
> 
> 标签：java, jsp, jakarta-ee, stripes, sitemesh

背景：我们有一个系统是在 2002-2003 年期间用基于 Java 的旧 CMS 编写的。我们希望继续使用我们的新产品，使用 tomcat、stripes 和 sitemesh。我们有导航、布局、“pods”、js、css 等，我们已经从旧的 CMS 中取出这些内容，并融入了我们的一些新应用程序，因此我们具有一致的外观和感觉。

我们现在需要某种解决方案来摆脱所有的代码重复。我们的应用程序目前在同一个虚拟机上运行，​​但这可能会改变。我们需要一种方法让我们所有的 tomcat 实例访问一些公共元素（这些元素可能/可能不需要做一些服务器端的事情）。

到目前为止，我们想出的最好的方法是制作一个相当标准的 sitemesh 装饰器，它使用 c:import 来获取它需要的东西，并将其插入。这个解决方案有一些网络开销，可能会陷入困境并引入失败观点。我们也看过 <%@ include file="/something.jsp" %> ，但这似乎只是与上下文相关的。我们可以使用 c:import 并将其指向 localhost，这似乎是迄今为止最好的解决方案。

是否有其他模板/装饰框架（Tiles？）可以使这更简单？我们缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T17:07:06.623

我不太确定你想在这里做什么。我的解释是：你有很多资源想要在多个应用程序中重用。您不希望在所有应用程序中都复制这些文件，因为这样会难以在应用程序之间保持一致性。

如果这是您的问题，我建议您将公共资源保存在 jar 文件中。这为您提供了几个优势：

1.  您的资源是本地的 - 没有网络开销
2.  您可以控制资源的更新。

nr 2 的示例：您将常用页面布局保存在 page-layouts-1.x.jar 中。您继续制作不影响使用它的应用程序的页面布局的次要版本 - 它们是直接替代品。有一天，您决定彻底重新设计您的应用程序并发布 page-layouts-2.0.jar。这需要对使用它的应用程序进行一些重写。现在，如果应用程序捆绑页面布局，而不是将它们保存在服务器上的共享类加载器中，那么迁移到 2.0 布局就不是全有或全无的事情。您可以一次迁移一个应用程序以使用 2.0 布局，而其他应用程序仍使用 1.x 布局。

我们使用 JSF 和 Facelets 非常成功地做到了这一点。

您可能想看看[Weblets](https://weblets.dev.java.net/)。我不知道 SiteMesh 或 Tiles 是否直接支持从类路径提供资源，但我假设您可以调整它们来做到这一点。

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T17:26:45.957

我们已经使用 Sitemesh 多年了，我对它的感觉很复杂。

我更喜欢编写标准的 JSP 标记文件（.tag 或 .tagx）来使用 applydecorator。我认为随着标签文件的出现，applydecorator 标签实际上已经过时了，但是太多的 Sitemesh 用户没有注意到。

几乎我们所有的 Sitemesh 使用都是这种类型。我们有一些通用的页面模板，我们的 JSP 页面将明确地称为布局。“使用标准布局，这里是导航菜单，这里是页面正文。” 标记文件与此功能完全相同，但它们是标准化的，受任何 J2EE Web 工具的支持，并且内置于容器而不是其他依赖项中。

对于真正装饰一个页面，JSP 页面本身根本不引用 Sitemesh，我认为这在高层是有意义的，但我仍然不喜欢重新解析整个页面。

第二个问题真的不是 Sitemesh 的错。考虑到它必须使用的 Servlet API，我不知道它还能做什么。但这确实让我想知道基于 DOM 的替代基于流的 Servlet API 是否有价值。换句话说，与其让 servlet 将其输出写入流，不如将节点添加到树中会怎样？这将强制执行格式良好的输出，并使像 Sitemesh 那样进行结构转换或将输出编码为不同格式（如 XHTML、HTML 或 JSON）的成本更低。

# javascript - jquery 可排序，除了这个

> ID：282348
> 
> 赞同：14
> 
> 时间：2008-11-11T22:23:36.203
> 
> 标签：javascript, jquery

需要一种允许排序的方法，除了列表中的最后一项。

尝试使用取消选项，但它不起作用，我认为这不是它的用途。

我认为解决方案可能与事件有关，但希望您能接受。

在实践中，列表是动态生成的，并且依赖于标签和相对引用而不是 id 进行选择。

示例代码：

```
$("ul").sortable({});
...
<ul>
<li>red</li>
<li>blue</li>
<li>white</li>
<li>black</li>
<li>this li should not be sorted</li>
</ul> 
```

浏览器是 Internet Explorer 6。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-11T23:16:09.483

```
$("ul").sortable( { items: "> li:not(:last)" } ); 
```

# backgroundworker - BackgroundWorker 线程：更新 UI 和中止操作

> ID：282363
> 
> 赞同：5
> 
> 时间：2008-11-11T22:29:15.303
> 
> 标签：backgroundworker

我在后台工作线程上运行了一系列耗时的操作。在各个阶段，我通过调用委托来更新（Windows 窗体）进度条。但是，更多时间操作之一发生在单行代码上。

是否有可能 ：

a) 在执行该单行代码时更新 UI，或者至少显示一个动画图标，向用户显示工作正在完成。

b) 让用户在执行该单行代码时取消后台工作线程

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T22:37:10.387

不幸的是，可能不是。后台工作线程需要调用 ReportProgress 来更新 UI 线程，并且需要观察 CancellationPending 来知道是否应该停止。因此，如果您的工作线程在单行中运行沿运行操作，则无法使其工作。

也许，我误解了，所以这是模拟我所得到的代码：

```
public void DoWork() {
    System.Threading.Thread.Sleep(10000);

    // won't execute until the sleep is over
    bgWorker.ReportProgress(100);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T22:45:10.917

a) 您可以使用**PictureBox**控件在表单上显示动画 GIF 而不是进度条。[您可以在此博客文章](http://www.devcow.com/blogs/adnrg/archive/2006/01/13/Adding-animated-gifs-to-Windows-Forms-applications.aspx)中找到有关如何执行此操作的详细信息。

b) **BackgroundWorker**类有一个**CancelAsync**方法，该方法将提交取消当前操作的请求。
这会将 BackgroundWorker 的**CancellationPending**属性设置为“True”。然后，在您的**DoWork**事件处理程序中，您必须定期轮询此属性，以便在其值更改时采取适当的操作。
另请注意，要使其正常工作，您必须将 BackgroundWorker 的**WorkerSupportsCancellation**属性设置为“True”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T22:50:23.620

Your ui code can display the animation before it starts the background worker, And if need be to cancel, you can terminate the background thread. You will not unfortunately beable to utilize the background worker design.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-18T09:00:26.020

You can update the **UI** (or class properties) in *ReportProgress()* method

So, if , as you state, your long-time operation is solid and unresponsive, how would you like to calculate its progress? It's evidently impossible.
Separate your operation to as much snippets as you can and call *ReportProgress()* after every snippet.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T22:47:25.047

您没有误解 - 使用 ReportProgress 或使用委托（就像我一样）可以实现基本相同的目标。

# c# - POP-Before-SMTP

> ID：282369
> 
> 赞同：2
> 
> 时间：2008-11-11T22:31:57.433
> 
> 标签：c#, email, smtp, pop3

最近，我不得不将我的一个 Web 应用程序转移到一个新的托管服务提供商。邮件和网络服务仍保留在旧托管站点上，但是，当我尝试从新服务器发送电子邮件时，出现错误；

“服务器拒绝了一个或多个收件人地址。服务器响应是：

```
450 <email_address>: Recipient address rejected: Greylisted for 5 minutes 
```

我问我的旧托管服务提供商我需要做些什么来解决这个问题，他们回答说

> 邮件服务器在 SMTP 之前在 POP 上运行。如果在通过服务器发送邮件之前未收到有效的 POP 登录，则邮件将被列入灰名单并保留 5 分钟，然后重试。
> 
> 为了防止这种情况，只需在发送邮件之前进行接收

有谁知道我如何在 C# 中的 SMTP 之前执行 POP？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T22:40:43.063

我不确定 C# 将如何处理细节（套接字？），但基本上你只想连接到你的新 POP 服务器。这是一个示例 POP 交易：

```
$ telnet new-pop-server.com 110
Connected to new-pop-server.com.
Escape character is '^]'.
+OK
USER <username>
+OK 
PASS <password>
+OK               // you're authenticated at this point 
LIST
+OK 
.                 // no new messages!
QUIT
+OK 
```

获得授权后，您应该能够以编程方式发送邮件。(USER, PASS, LIST, QUIT) 都是您要发送的命令 ( [pop3 RFC](http://www.faqs.org/rfcs/rfc1939.html) )。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T00:02:40.997

我很确定 POP3 没有内置到 .NET Framework 中，因此您需要按照 Owen 的建议自己实现它，或者寻找现有的 POP3 库，例如[这个](http://www.codeproject.com/KB/IP/pop3library.aspx).NET Framework 。

更好的是说服您的新托管服务提供商放宽灰名单规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T01:47:26.907

按照建议，我将代码添加到我的博客中。这不是有史以来最好的博客，但有人可能会觉得它很有用...... [POP-Before-SMTP](http://dotnetdilemmas.blogspot.com/2008/11/pop-before-smtp.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-11T22:47:48.307

他们将您列入灰名单是因为您从新的提供商处连接，对吗？新提供商是否没有允许来自服务器 IP 范围的连接的 SMTP？

另一种方法是自己进行 MX 查找，然后直接连接到您要向其发送电子邮件的地址的权威 SMTP 服务器。但是，这也需要您处理灰名单，即重试 4xx 响应，以便获得可靠的交付。

也许您应该询问您的提供商他们是否也提供身份验证 SMTP 作为替代方案，这是另一个可能的故障点，在使用 SMTP 服务之前需要 POP 登录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T05:58:09.990

你已经有了你要找的代码，但是如果我可以补充一下我的想法：就像其他人已经建议的那样，我会与旧的提供商核实他们是否提供带有 SMTP 的 AUTH。对我来说，他们的意思是，“只有当您来自相同的 IP 范围/子网，或者您已经通过身份验证时，您才能使用 SMTP”。许多 ISP 使用他们的 SMTP 服务器执行此操作。如果您通过特定的 ISP 连接，则可以使用 SMTP 而无需明确提供任何 AUTH 凭据。如果您切换到另一个 ISP 并想使用旧 ISP 的 SMTP，则必须明确地通过 SMTP 服务器进行身份验证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T22:08:46.980

我设法为此编写代码。我愿意分享解决方案，（如果有人感兴趣？）但不确定如何最好地将代码放在 Stackoverflow 上？大约有 50 行代码。

# c++ - 将 boost::function 降级为普通函数指针

> ID：282372
> 
> 赞同：22
> 
> 时间：2008-11-11T22:33:30.270
> 
> 标签：c++, boost, functor

想要将 boost::bind 传递给一个需要普通函数指针（相同签名）的方法。

```
typedef void TriggerProc_type(Variable*,void*);
void InitVariable(TriggerProc_type *proc);
boost::function<void (Variable*, void*)> triggerProc ...
InitVariable(triggerProc);

error C2664: 'InitVariable' : cannot convert parameter 1 from 
'boost::function<Signature>' to 'void (__cdecl *)(type *,void *)' 
```

我可以避免存储 boost::function 并直接传递绑定函子，但随后我得到类似的错误：

```
error C2664: 'blah(void (__cdecl *)(type *,void *))' : cannot convert parameter
1 from 'boost::_bi::bind_t<R,F,L>' to 'void (__cdecl *)(type *,void *)' 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-08-10T21:32:04.930

有没有人注意到[接受的答案](https://stackoverflow.com/a/282433/20003)只适用于微不足道的情况？function<>::target() 返回可以绑定到 C 回调的对象的唯一方法是，如果它是使用可以绑定到 C 回调的对象构造的。如果是这种情况，那么您可以直接绑定它并跳过所有 function<> 废话开始。

如果你仔细想想，没有任何神奇的解决方案。C 风格的回调存储为指向可执行代码的单个指针。任何重要的 boost::function<> 都需要至少两个指针：一个指向可执行代码，另一个指向设置调用所需的数据（例如，在绑定成员的情况下，“this”指针功能）。

将 boost::function 和 boost::bind 与 C 回调一起使用的正确方法是创建一个满足回调签名的 shim 函数，确定要调用哪个函数<>，然后调用它。通常，C 回调对于“用户数据”会有某种 void*；那是你存放函数指针的地方：

```
typedef void (*CallbackType)(int x, void* user_data);
void RegisterCallback(CallbackType cb, void* user_data);

void MyCallback(int x, void* userData) {
  boost::function<void(int)> pfn = static_cast<boost::function<void(int)> >(userData);
  pfn(x);
}

boost::function<void(int)> fn = boost::bind(myFunction(5));
RegisterCallback(MyCallback, &fn); 
```

当然，如果您的回调签名不包含某种用户数据指针，那么您就不走运了。但是任何不包含用户数据指针的回调在大多数实际场景中已经无法使用，需要重写。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-11T23:01:08.063

我认为您想使用 boost::function 的 target() 成员函数（那不是一口……）

```
#include <boost/function.hpp>
#include <iostream>

int f(int x)
{
  return x + x;
}

typedef int (*pointer_to_func)(int);

int
main()
{
  boost::function<int(int x)> g(f);

  if(*g.target<pointer_to_func>() == f) {
    std::cout << "g contains f" << std::endl;
  } else {
    std::cout << "g does not contain f" << std::endl;
  }

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T16:56:20.917

> 你能让它与绑定一起工作吗？
> 
> ```
> cb_t cb = *g.target<cb_t>(); //target returns null 
> ```

这是[设计使然](http://www.boost.org/doc/libs/1_37_0/doc/html/boost/function_base.html#id2623958-bb)。基本上，由于`bind`返回一个完全不同的类型，所以这是不可能的。基本上，活页夹代理对象不能转换为 C 函数指针（因为它不是一个：它是一个函数对象）。返回的类型`boost::bind`很复杂。当前的 C++ 标准不允许做你想做的事。C++0x 将配备一个`decltype`表达式，可用于实现如下目的：

```
typedef decltype(bind(f, 3)) bind_t;
bind_t target = *g.target<bind_t>(); 
```

请注意，这可能有效，也可能无效。我没有办法测试它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T03:21:11.433

请参阅 boost 邮件页面 [[boost] [Function] 将 target() 与 boost::mem_fn 和 boost::bind 一起使用时出现问题](http://lists.boost.org/Archives/boost/2008/12/145709.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T16:45:41.453

你能让它与绑定一起工作吗？

```
#include <boost/function.hpp>
#include <boost/bind.hpp>

void f(int x)
{
    (void) x;
    _asm int 3;
}

typedef void (*cb_t)(int);

int main()
{
    boost::function<void (int x)> g = boost::bind(f, 3);
    cb_t cb = *g.target<cb_t>(); //target returns null
    cb(1);

    return 0;
} 
```

更新：好的，目的是将方法绑定到函数回调中。那么现在怎么办？

# visual-studio - Visual Studio：如何显示从基类继承的所有类？

> ID：282377
> 
> 赞同：158
> 
> 时间：2008-11-11T22:36:11.373
> 
> 标签：visual-studio, class, abstract-class

在 Visual Studio 中，如何显示从基类继承的所有类？

**例如**，在 ASP.NET MVC 中有几种“ [ActionResult](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionresult.aspx) ”类型——它们都继承自/实现基类`ActionResult`。

看起来除非您只是“知道”`View`并且`Json`是有效`ActionResult`类型，否则您无法轻松找到此信息。

*请证明我错了。*

对象浏览器中有什么东西可以很容易找到吗？

我什至愿意为 Visual Studio 之外的工具提供建议，以发现有关各种类的这些信息。例如：Resharper 中有什么可以帮助我的吗？

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2013-06-29T01:53:12.963

对于 VS2012，

1.  在解决方案资源管理器中导航到文件
2.  展开并选择您的班级
3.  右键单击类项（不是文件项）-> 派生类型

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2011-01-25T08:37:25.657

您不一定需要 Reflector - Visual Studio 的“类图”视图也可以让您轻松找到特定类的所有派生类。右键单击“类视图”中的类，然后选择“查看类图”。如果图表没有显示层次结构所需的详细级别，请右键单击图表中类的框，然后选择“显示派生类”。

可能不像 ReSharper 那样直接，但如果您还没有 R#，它是一个选项。

不幸的是，我不确定 Visual Studio 的哪个特定版本有它。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2008-11-11T22:40:32.020

当然，[Resharper](http://www.jetbrains.com/resharper/)可以做到这一点。以及更多。

只需在任意位置右键单击类型名称，然后在上下文菜单中选择“转到继承者”。“Go To Inheritor”也可以应用于导航到覆盖的方法和接口方法的实现。对于一个界面，您可以再次调用“Find Usages Advanced”，只需右键单击）在哪里可以找到所有扩展和实现。对于一个类型 - 派生类型。还有我最喜欢的功能 - 在任何类型/方法上按住 Control 单击以导航到其声明。

我认为它是.net 开发人员必备的工具。

* * *

在 Resharper 9.2 中，在源代码中的任何类型上，右键单击“Find Usage Advanced”，选择 Find="Derived" 和 Scope="Solutions and Libraries"。
例如，要在来自任何供应商的包含的 DLL 中查找某个基类的所有继承者（在库和您的代码中），请在您的代码中使用该基类声明一个变量。然后右键单击您刚刚键入的基类名称。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-06-16T08:36:29.813

从“Visual Studio 2015 Update 1”开始，您只需在类代码编辑器中右键单击类名，然后从上下文菜单中选择“Go To Implementation”：快捷键为 Ctrl + F12。

有关更多详细信息，请参阅[https://blogs.msdn.microsoft.com/dotnet/2015/11/30/whats-new-in-visual-studio-update-1-for-net-managed-languages/](https://blogs.msdn.microsoft.com/dotnet/2015/11/30/whats-new-in-visual-studio-update-1-for-net-managed-languages/)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-06-26T15:26:05.340

**这是最不懒惰的答案（我只是为这个答案感到自豪:)**

我没有 ReSharper，以前试过但不想买。我尝试了一个类图，但根本不实用，因为层次图跨越了世界 3 倍，而且我的笔记本电脑的屏幕没有无限宽度。所以我自然而简单的解决方案是编写一些 Windows 窗体代码来迭代程序集中的类型并使用反射将节点添加到树视图，如下所示：

*请假设您在运行此代码的表单上有一个文本框、一个树形视图和其他所需的东西*

```
//Go through all the types and either add them to a tree node, or add a tree
//node or more to them depending whether the type is a base or derived class.
//If neither base or derived, just add them to the dictionary so that they be
//checked in the next iterations for being a parent a child or just remain a
//root level node.

var types = typeof(TYPEOFASSEMBLY).Assembly.GetExportedTypes().ToList();
Dictionary<Type, TreeNode> typeTreeDictionary = new Dictionary<Type, TreeNode>();
foreach (var t in types)
{
    var tTreeNode = FromType(t);
    typeTreeDictionary.Add(t, tTreeNode);

    //either a parent or a child, never in between
    bool foundPlaceAsParent = false;
    bool foundPlaceAsChild = false;
    foreach (var d in typeTreeDictionary.Keys)
    {
        if (d.BaseType.Equals(t))
        {
            //t is parent to d
            foundPlaceAsParent = true;
            tTreeNode.Nodes.Add(typeTreeDictionary[d]);
            //typeTreeDictionary.Remove(d);
        }
        else if (t.BaseType.Equals(d))
        {
            //t is child to d
            foundPlaceAsChild = true;
            typeTreeDictionary[d].Nodes.Add(tTreeNode);
        }
    }

    if (!foundPlaceAsParent && !foundPlaceAsChild)
    {
        //classHierarchyTreeView.Nodes.Add(tn);
    }
}

foreach (var t in typeTreeDictionary.Keys)
{
    if (typeTreeDictionary[t].Level == 0)
    {
        classHierarchyTreeView.Nodes.Add(typeTreeDictionary[t]);
    }
}

StringBuilder sb = new StringBuilder();
foreach (TreeNode t in classHierarchyTreeView.Nodes)
{
    sb.Append(GetStringRepresentation(t, 0));
}
textBox2.Text = sb.ToString(); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-08-07T15:30:59.890

还没有人提到这个，所以我会添加它。
**Jetbrains dotPeek**是一款免费的 .NET 反编译器，能够轻松显示这些信息。

免费下载： http: [//www.jetbrains.com/decompiler/](http://www.jetbrains.com/decompiler/)

Jetbrains 是制造 Resharper 的公司。

## 查找派生类的步骤：

1.  启动 dotPeek
2.  选择“从 GAC 打开...”并添加 System.Web.MVC 程序集
3.  选择“导航/转到输入”并输入`ActionResult`
4.  在`ActionResult`类声明上，右键单击并选择“派生符号”
5.  瞧！显示了每个派生类（即使是一些我不知道的！）

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-10-19T15:34:04.533

假设您安装了[Resharper](http://www.jetbrains.com/resharper/)：将光标放在类/接口上，右键单击 - 检查 - 层次结构

这显示了子类、实现和超类。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-04-29T13:24:51.153

[![尝试 Visual Studio 类视图](https://i.stack.imgur.com/ydXU0.png)](https://i.stack.imgur.com/ydXU0.png)

在 Visual Studio 类视图中，导航到您感兴趣的类并找到它的基类和派生类。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-11-03T04:05:35.057

您也可以使用[反射器](http://www.red-gate.com/products/reflector/)。

加载您希望它查看的所有程序集，导航到一个类型，然后展开 Derived Types 项。

您也可以在对象浏览器中执行此操作，但出于某种原因，VS2008 只能在 .Net Framework 视图之一中执行此操作。（VS2010 Beta 2 在任何视图下都可以做到）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-11T22:51:16.070

对于框架类，我使用 MSDN 库。Inheritance Hierarchy 部分是双向的。诚然，对于某些 3d 派对库来说帮助不大。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-08-09T08:47:13.293

[在ReSharper](https://www.jetbrains.com/resharper/)（版本 2016.1.2）的帮助下，只需在基类上使用`Ctrl`++ 。你会看到这样的东西：`Alt``Click`

[![查看派生类 reSharper](https://i.stack.imgur.com/A0xZs.png)](https://i.stack.imgur.com/A0xZs.png)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-12-28T10:59:17.800

将类或命名空间从**对象资源管理器**拖到**类图**文件中。

[如何为内置的 .net 类获得漂亮的类图？](https://stackoverflow.com/questions/8152000/how-to-get-a-nice-class-diagram-for-built-in-net-classes)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-02-13T18:46:59.900

作为使用 Visual Assist 的一个选项，您还可以按 Shift + ALT + G（插入符号位于类名上）以调出“转到相关”上下文菜单，如果有派生类，您将获得一个子菜单因为它列出了它们，甚至显示了这些派生类之间的继承结构。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-01-08T08:15:38.207

选择类型并右键单击查看内容---在代码图上显示---选项选择它为继承此类型的人生成图像格式作为非常好的图像作为 .dgml 文件格式它提供了有关类型的更多信息

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-08-08T15:04:42.550

只需编码即可。

```
Assembly asm = Assembly.LoadFrom(PATH_TO_PROJECT_OUTPUT);

var types = from t in asm.GetTypes()
            where t.BaseType != null && t.BaseType.ToString() == "System.Web.UI.Page"
            // if you want to add reference - where typeof (System.Web.UI.Page).Equals(t.BaseType) 
            select t;

foreach (var type in types)
{
    Console.WriteLine(type);
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-02-21T22:29:43.240

如果您升级到 VS2012，您可以使用“代码图”。
右键单击要查看其继承层次结构的类型，然后选择“添加到代码映射”。然后在代码图视图中，您可以展开节点并右键单击以选择“显示派生/基类”。不幸的是，它不适用于 .NET 提供的类。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-18T12:39:42.980

对于 Visual Studio 2012（**没有 ReSharper**）

1.  在解决方案资源管理器中，右键单击类（您要查看其派生类）。
2.  在类图中，右键单击类并选择“显示派生类”。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-04-16T11:17:04.153

**2020年更新：**

您可以使用 Visual Studio 的[代码映射](https://docs.microsoft.com/en-us/visualstudio/modeling/map-dependencies-across-your-solutions)，它工作得很好。

只需右键单击类并导航到：
`Code Map`> `Show Related Items on Code Map`>`Show All Derived Types`

[![在此处输入图像描述](https://i.stack.imgur.com/xNt3B.png)](https://i.stack.imgur.com/xNt3B.png)

**笔记：**

*   此功能**仅**在 Visual Studio 的企业版上可用，如果您**没有**，可以通过从[**此处**](https://visualstudio.microsoft.com/vs/preview/)下载企业预览版**免费**获得。[](https://visualstudio.microsoft.com/vs/preview/)
***   或者，您可能只要求团队中的任何人使用[此](https://docs.microsoft.com/en-us/visualstudio/modeling/share-code-maps)功能共享代码图，如果他们有该版本。**

 **PS 在您的机器中保留企业版（或至少是预览版）真的很值得，因为它有很多其他版本中不包含的[非常有用的工具。](https://visualstudio.microsoft.com/vs/compare/)

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2015-04-30T11:26:54.643

一个非常简单的方法是`: Classname`在“查找和替换窗口”（CTRL + F）中搜索并使用“查找选项/匹配整个单词”选项。您只会找到继承的类。

# sql - LINQ to SQL 可以查询 XML 字段 DB-serverside 吗？

> ID：282391
> 
> 赞同：28
> 
> 时间：2008-11-11T22:41:19.287
> 
> 标签：sql, xml, linq-to-sql, .net-3.5

.NET 3.5，C#

我有一个带有“搜索”功能的网络应用程序。一些可搜索的字段是表中的一等列，但其中一些实际上是 XML 数据类型中的嵌套字段。

以前，我为我的搜索构建了一个动态构建 SQL 的系统。我有一个很好的类层次结构，可以构建 SQL 表达式和条件语句。唯一的问题是它对 SQL 注入攻击并不安全。

我正在阅读[Rob Conery 的优秀文章](http://blog.wekeroad.com/2008/02/27/creating-in-queries-with-linq-to-sql/)，该文章指出，如果从未枚举 IQueryable 结果，则可以将多个查询组合为服务器的单个 TSQL 查询。这让我想到我的动态搜索结构太复杂了——我只需要组合多个 LINQ 表达式。

例如（人为）：

```
Author:
    ID (int),
    LastName (varchar(32)), 
    FirstName (varchar(32))

    context.Author.Where(xx => xx.LastName == "Smith").Where(xx => xx.FirstName == "John") 
```

结果如下查询：

```
SELECT [t0].[ID], [t0].[LastName], [t0].[FirstName]
FROM [dbo].[Author] AS [t0]
WHERE ([t0].[LastName] = Smith) AND ([t0].[FirstName] = John) 
```

我意识到这可能是一个简单的动态查询生成的完美解决方案，它可以避免 SQL 注入 - 我只需循环我的 IQueryable 结果并执行额外的条件表达式来获得我的最终单次执行表达式。

但是，我找不到任何对 XML 数据评估的支持。在 TSQL 中，要从 XML 节点获取值，我们会执行类似的操作

```
XMLField.value('(*:Root/*:CreatedAt)[1]', 'datetime') = getdate() 
```

但我找不到创建此评估的 LINQ to SQL 等效项。一个存在吗？我知道我可以在 DB 端评估所有非 XML 条件，然后在代码端进行 XML 评估，但是我的数据足够大，以至于 A）有很多网络流量会拖累性能，B）我会出去-如果我无法评估 XML 第一个 DB 端以排除某些结果集，则会出现内存异常。

想法？建议？

额外的问题 - 如果 XML 评估实际上是可能的 DB 端，那么 FLWOR 支持呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-11T23:32:05.737

现在这是一个有趣的问题。

现在，您不能直接从 Linq 指示 SQL Server 执行 XML 函数。但是，您可以让 Linq 使用用户定义的函数……因此，您可以设置一个 udf 来处理 xml、获取正确的数据等，然后在您的 Linq 表达式中使用它。这将在服务器上执行，并且应该做你想做的事。但是有一个重要限制：您要查找的 XML 路径（第一个参数`xmlColumn.value`或类似参数）必须内置到函数中，因为它必须是字符串*文字*，不能从输入参数构建（例如）。因此，您可以在编写 UDF 时使用 UDF 来获取您知道的字段，但不能作为从 XML 列中获取数据的通用方式。

查看[Scott Gutherie 关于 Linq to SQL 的优秀博客系列](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)的 Supporting User Defined Functions (UDF) 部分，了解有关实施的更多信息。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-14T12:00:34.307

为了澄清丹尼尔的答案 - 除非查询的 XPath 部分已修复，否则您不能使用函数来执行此操作。请参阅我的博客条目：[http ://conficient.wordpress.com/2008/08/11/linq-to-sql-faq-xml-columns-in-sql/](http://conficient.wordpress.com/2008/08/11/linq-to-sql-faq-xml-columns-in-sql/)

基本上，您不能通过 LINQ to SQL 查询 xml 列。尽管它返回一个 XElement 类型，但您在尝试过滤此列时无法执行任何 SQL 转换。

LINQ to SQL 确实支持使用 UDF - 但 SQL 本身不允许您在 XML xpath 查询中使用参数字符串 - 它必须是字符串文字。这意味着如果 XPath 在设计时是固定的，它就可以工作，但如果您希望能够传递变量 XPath 语句，则不能。

这导致只有另外两种替代方法：内联 SQL 语句（否定使用 LINQ 的价值）和在 .NET CLR 中编写 SQL 库函数来执行此操作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-21T09:44:12.087

这不是最好的，不适用于所有查询，也不是完全 linq，但可以工作并且速度很快：

一个 xml sql 字段接受“ **.ToString** ”，所以你可以这样做：

```
Dim txt as String = "<File>3</File>"
Return (From P In DC.LPlanningRefs Where P.Details.ToString.Contains(txt) Select P).FirstOrDefault 
```

我用它来限制返回的行，然后，我查找每个返回的行

# python - 调用前的 Python 装饰函数

> ID：282393
> 
> 赞同：9
> 
> 时间：2008-11-11T22:42:44.447
> 
> 标签：python, decorator

我有一个由其他人编写的相当复杂的装饰器。我想要做的是根据决定一次调用函数的修饰版本，或者再次调用原始函数（未修饰）。这可能吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-11T22:45:52.243

和：

```
decorator(original_function)() 
```

没有：

```
original_function() 
```

装饰器只是一个函数，它接受一个函数作为参数并返回另一个函数。@ 语法是完全可选的。也许筛选一些[文档](https://wiki.python.org/moin/PythonDecorators)可能有助于澄清事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T02:26:08.490

```
def original_function():
    pass

decorated_function= decorator(original_function)

if use_decorated:
    decorated_function()
else:
    original_function() 
```

只装饰一次，然后选择调用哪个版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T18:57:04.217

这是我为这个问题想出的食谱。我还需要保持签名相同，所以我使用了装饰器模块，但你可以重新调整以避免这种情况。基本上，诀窍是向函数添加一个属性。'original' 函数是未绑定的，因此您需要传入一个 'self' 作为第一个参数，所以我添加了一些额外的代码来检查它。

```
# http://www.phyast.pitt.edu/~micheles/python/decorator-2.0.1.zip
from decorator import decorator, update_wrapper

class mustbe : pass

def wrapper ( interface_ ) :
    print "inside hhh"
    def call ( func, self, *args, **kwargs ) :
        print "decorated"
        print "calling %s.%s with args %s, %s" % (self, func.__name__, args, kwargs)
        return interface_ ( self, *args, **kwargs )
    def original ( instance , *args, **kwargs ) :
        if not isinstance ( instance, mustbe ) :
            raise TypeError, "Only use this decorator on children of mustbe"
        return interface_ ( instance, *args, **kwargs )
    call = decorator ( call, interface_ )
    call.original = update_wrapper ( original, call )
    return call

class CCC ( mustbe ):
    var = "class var"
    @wrapper
    def foo ( self, param ) :
        """foo"""
        print self.var, param

class SSS ( CCC ) :
  @wrapper ( hidden_=True )
  def bar ( self, a, b, c ) :
    print a, b, c

if __name__ == "__main__" :
    from inspect import getargspec

    print ">>> i=CCC()"
    i=CCC()

    print ">>> i.var = 'parrot'"
    i.var = 'parrot'

    print ">>> i.foo.__doc__"
    print i.foo.__doc__

    print ">>> getargspec(i.foo)"
    print getargspec(i.foo)

    print ">>> i.foo(99)"
    i.foo(99)

    print ">>> i.foo.original.__doc__"
    print i.foo.original.__doc__

    print ">>> getargspec(i.foo.original)"
    print getargspec(i.foo.original)

    print ">>> i.foo.original(i,42)"
    i.foo.original(i,42)

    print ">>> j=SSS()"
    j=SSS()

    print ">>> j.bar(1,2,3)"
    j.bar(1,2,3) 
```

# vb.net - 在 VB.net 中转换 ComObject 的问题

> ID：282401
> 
> 赞同：2
> 
> 时间：2008-11-11T22:46:45.953
> 
> 标签：vb.net, interop, ms-word

我有一个 Word.Field 对象，它是一个复选框，`Type`属性等于 wdFieldFormCheckBox。我正在尝试将 Word.Field 对象转换为 Word.CheckBox 对象，但出现转换错误。

```
Dim chkBox as Word.CheckBox
chkBox = DirectCast( myFieldInstance, Word.Checkbox) 
```

如何将 Word.Field 对象转换为 Word.CheckBox 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T14:59:35.510

这是不可能的。CheckBox 是 FormField 对象的属性，而不是字段对象。

# c# - IoC 容器是否取代了工厂的使用

> ID：282406
> 
> 赞同：9
> 
> 时间：2008-11-11T22:48:01.800
> 
> 标签：c#, inversion-of-control, factory

我刚刚开始使用 IoC 容器，如果这是一个愚蠢的问题，我深表歉意。

我在应用程序中有如下代码

```
internal static class StaticDataHandlerFactory
    {
        public static IStaticDataHandler CreateHandler(StaticDataUpdate staticDataUpdate)
        {
            if (staticDataUpdate.Item is StaticDataUpdateOffice)
            {
                return new OfficeUpdateHandler();
            }

            if (staticDataUpdate.Item is StaticDataUpdateEmployee)
            {
                return new EmployeeUpdateHandler();   
            }

            if (staticDataUpdate.Item == null)
            {
                throw new NotImplementedException(
                    string.Format("No static data provided"));
            }
            else
            {
                throw new NotImplementedException(
                    string.Format("Unimplemented static data type of {0}", staticDataUpdate.Item.GetType().FullName));
            }
        }
    } 
```

它基本上是一个简单的工厂，它返回处理输入数据的正确策略。

IoC 容器会允许我消除这样的代码吗？也就是说：它是否允许我根据输入参数的类型动态选择要加载的具体实现？

还是我在这里偏离了方向？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-13T09:54:17.133

实际上，虽然可以用控制系统反转来替换一些代码，但对我来说并不明显这是一个好主意。依赖注入往往最适合系统配置，而不是对象的动态创建。换句话说，容器本身是一个巨大的全局变量，因此应该出现在您的大部分代码中。

顺便说一句，该代码似乎违反[了得墨忒耳法则](http://googletesting.blogspot.com/2008/07/breaking-law-of-demeter-is-like-looking.html)。看来参数应该是“StaticDataUpdateItem”类型而不是“StaticDataUpdate”类型。观察到这一点，有一个非常强大的论点来将此代码重写为对 StaticDataUpdateItem 的方法调用。

我大量使用了 IoC，但使用抽象工厂模式仍然可以更好地处理动态对象创建。简而言之，如果您不喜欢向项目本身添加方法以生成句柄的想法，那么代码可能最好保持原样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T23:17:36.187

你一点也不偏离路线；按照我的理解，你已经很接近了。

我最常用的构建此类事物的方式是将您的 Factory 类转换为您的 IoC 容器，只需允许使用依赖注入指定返回的 UpdateHandlers。因此，您可以将代码转换为简单地说 StaticDataUpdateOffice 返回（新指定的）`m_officeUpdateHandler`变量包含的任何内容，而不是在代码中指定 StaticDataUpdateOffice 意味着返回 OfficeUpdateHandler 的逻辑；只要您的框架确保您`m_officeUpdateHandler`在调用工厂之前设置了 的值，您就可以开始了。您可以根据`m_officeUpdateHandler`需要在运行时将 的值更改为您想要的任何值。

这种依赖注入允许您控制控制反转过程；您可以有一个简单的工厂来返回您的处理程序，并且您可以根据需要抽象控制哪些处理程序返回到不同位置的逻辑。

注意：我对这类事情的体验很大程度上是由我对 Spring 的（非常积极的）体验所驱动的，因此这可能会影响我对您的问题（和答案）的解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T22:57:53.793

简短的回答是肯定的，它允许这样做。这篇[博文](http://ayende.com/Blog/archive/2008/10/05/components-implementations-and-contextual-decisions.aspx)展示了一种使用 Windsor 在运行时选择实现的巧妙方法。作者 Ayende[在此处](http://ayende.com/Blog/archive/2008/10/05/windsor-ihandlerselector.aspx)和[此处](http://ayende.com/Blog/archive/2008/10/05/windsor-imodelinterceptersselector.aspx)进行了详细说明。

我还没有尝试过，但我希望很快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T17:26:35.787

我同意这里的其他答案，是的，你可以这样做。但是，为什么不使用泛型呢？

```
public static IStaticDataHandler CreateHandler<T>( params object[] args )
{... 
```

其中 args 可以作为 ctor 参数传入（例如，Activator）。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-10-11T19:26:51.617

我还没有在这里读到任何有意义的词。

IoC 更适合配置？

动态对象创建更好的是什么？泛型？这都是题外话。

1) 与实现“组合胜过专业化/继承”的福音相比，IoC 只不过是节省时间的好方法。

所以使用 IoC 的规则 #1 是你应该真的厌倦了不得不处理遵循“绑定到合同而不是实现”的长构造函数。

换句话说，出于同样的原因（封装......），这是策略模式作为模板模式的替代方案......但是创建所有额外的接口/抽象类型需要更多的工作，而且还有更多的工作要做每次都使用所有 IServiceProvicerThis 和 IResolverThat ...如果您不厌倦必须繁琐地履行代码合同，例如：

IInterestingService 有趣 = ...但是你得到一个实例..

添加大约三行这样的..

然后

IAmazementService 服务 = new AmazementService（有趣，thesecondstrategy，thethird，等等...）

那变老了。所以 IoC 从来都不是问题，因为任何聪明到可以使用可靠设计进行编码的人都会知道得更好。那些问的人都有错误的答案。

因此，如果您确实满足上述条件，那么绝对。IoC 容器有责任做尽可能多的“创造性”工作，让您可以从让它们处理中受益。最常见的对显式 new 的创作抽象是 Mr. Factory。

达蒙

# compact-framework - .Net Compact Framework - SerialPort 类中有什么方法可以将 RTS 控件设置为 TOGGLE？

> ID：282416
> 
> 赞同：1
> 
> 时间：2008-11-11T22:51:04.183
> 
> 标签：compact-framework, serial-port

我发现 .NET Framework 中的 SerialPort 类不允许将 rts 控件设置为 TOGGLE 的事实非常烦人。

有一个名为 RTSEnable 的属性可以让我直接控制 RTS 信号的状态，但是在 Compact Framework 应用程序中，没有太多的精度可以使其正常工作。

另一种解决方案是编写一个调用非托管 API 的类并通过 DCB 结构设置 rts 控件，但我不喜欢它，因为我使用了一些需要引用 SerialPort 实例的外部库。

你有什么别的想法吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T23:17:53.160

你试过[OpenNETCF 串行类](http://www.opennetcf.com/FreeSoftware/OpenNETCFIOSerial/tabid/252/Default.aspx)吗？不确定这是否具有您需要的精确功能，但 IMO 总体上更好。

说我疯了，但我发誓 CF 版本用线程做奇怪的事情。

# c++ - 如何在 Scons 中为具有相对路径的构建目标创建别名？

> ID：282419
> 
> 赞同：3
> 
> 时间：2008-11-11T22:51:55.630
> 
> 标签：c++, build, scons

## 背景

我正在通过设置一个包含两个子项目的基本 C++ 示例项目来尝试 Scons：

*   Prj1 是一个依赖于 Prj2 的 EXE
*   Prj2 是一个导出一些函数的DLL

[您可以在此处查看](https://stackoverflow.com/questions/279860/how-do-i-get-projects-to-place-their-build-output-into-the-same-directory-with)我的 SConstruct 和 SConscript 文件的目录结构和内容

## 问题

我遇到的问题是，为了从命令行构建这些目标，我必须指定它们的构建目录的相对路径和特定于平台的文件扩展名。

例如，要构建 Prj1，我必须这样做：

```
 build> scons ../bin/project1.exe 
```

同样，要构建 Prj2，我必须这样做：

```
 build> scons ../bin/project2.dll 
```

## 问题

如何在不指定相对路径和平台特定文件扩展名的情况下让 SCons 构建这些项目？

**期望：**

```
 build> scons project1 
build> scons project2 
```

## 潜在的解决方案

*   使用别名 - 我很确定这**是**我想要的，但我显然搞砸了。我尝试了以下但没有成功：

```
 prj1_env.Alias( 'project1', PROG)
prj1_env.Alias( 'project1', os.path.join( BIN_DIR, PROG) ) 
```

## 参考

*   [如何让项目将其构建输出与 Scons 放在同一目录中？](https://stackoverflow.com/questions/279860/how-do-i-get-projects-to-place-their-build-output-into-the-same-directory-with)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T17:25:38.097

将此移至答案而不是评论。:)

**参考**

*   如何让项目将其构建输出与 Scons 放在同一目录中？

Alias 需要一个实际目标作为其第二个参数。我认为问题在于“project1”（PROG 的值）不是实际目标。纠正此问题的简单方法如下。使 PrefixProgram 返回一个值：

```
def PrefixProgram(env, outdir, trgt, srcs):
    return env.Program(target = os.path.join(outdir, trgt), source = srcs) 
```

然后：

```
target = PrefixProgram( prj1_env, BIN_DIR, PROG, SOURCES )
prj1_env.Alias("project1", target) 
```

你当然可以这样做：

```
prj1_env.Alias("project1", PrefixProgram( prj1_env, BIN_DIR, PROG, SOURCES )) 
```

但我认为第一种方式更容易理解。

我希望这有帮助。

# apache-flex - 如何从 Flex/Flash 登录 Drupal 用户（或获取当前登录的用户）？

> ID：282422
> 
> 赞同：1
> 
> 时间：2008-11-11T22:54:44.067
> 
> 标签：apache-flex, flash, drupal

我有一个从 Drupal 页面托管的 Flash 应用程序。Flash 应用程序的某些部分应该可供所有用户使用，但有些部分应该只对登录用户可用。（具体角色无关紧要，只要他们是站点的任何授权用户）。

在 Flash 中，我可以通过屏幕抓取“？q=user”页面来检测用户是否登录，但这非常脆弱。这样做的“正确”方法是什么？如有必要，我可以安装其他模块，但它们需要与 Drupal 6 兼容，而不是 5。

同样，如果当前没有用户登录，我如何获取他们提供给我的用户名和密码并登录（或确定密码错误）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T23:10:49.960

## “正确”的解决方案

您可能想查看类似[服务模块](http://drupal.org/project/services)的内容。基本上，您希望向您的 Flash 应用程序公开用户服务，因此您可以发送请求（通过 XML-RPC 或您选择的任何实现）以获取诸如“当前登录用户具有什么访问权限”或“登录此用户”之类的信息使用用户名 x 和密码 y" 等...

## 快速自己动手解决方案

如果您熟悉模块开发，则可以快速创建自己的模块以获得所需的功能，而无需通过“真正的”Web 服务层。这是一个简单的示例，创建一个名为“myservices”的模块：

```
<?php
// myservices.info
   name = My Services
   description = Expose basic services
   core = 6.x

<?php
// myservices.module

   function myservices_menu() {
       $items['myservices/user'] = array(
         'title' => 'Get auth',
         'page callback' => 'myservices_get_user',
         'access arguments' => array('access content'),
       );
       return $items;
   }

   function myservices_get_user() {
       global $user;
       if (in_array('authenticated user', $user->roles) ) {
           print 'yes';
       } else {
           print 'no';
       }
   } 
```

将这两个文件放在模块目录中的目录“myservices”中，激活它，然后转到`http://yourdomain.com/myservices/user`

如果您通过了身份验证，它只会返回`yes`，如果没有`no`，等等...您可以在您的 Flash 应用程序中获取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T22:06:34.717

我能够使用 Drupal 的“系统”和“用户”服务来做到这一点：

*   安装[服务模块](http://drupal.org/project/services)
*   启用“系统”和“用户”服务
*   对于下面的代码，禁用 API 密钥。（或者让它们启用并提供额外的参数）
*   允许经过身份验证的用户和匿名用户访问服务

在撰写本文时，AMFPHP 服务还没有移植到 Drupal 6，所以我使用了 XMLRPC。为了使用 ActionScript 中的 XMLRPC，我使用了[as3-rpclib](http://code.google.com/p/as3-rpclib/)的帮助程序库。该库是为 ActionScript2 编写的，因此将它与 Flex3 一起使用需要我对其进行修补，如[本页](http://code.google.com/p/as3-rpclib/wiki/Resources)所述（向下滚动页面并搜索“jameshyu”于 2008 年 5 月 10 日发表的评论）。

处理完所有这些先决条件后，您可以检查当前登录的用户（如果有）和/或使用如下代码登录用户。

这是实际实现登录的模块：

```
package
{
    import com.ak33m.rpc.xmlrpc.XMLRPCObject;

    import flash.events.*;
    import flash.net.*;

    import mx.collections.ItemResponder;
    import mx.rpc.AsyncToken;
    import mx.rpc.events.FaultEvent;
    import mx.rpc.events.ResultEvent;

    public class DrupalLogin
    {
        private var _api:XMLRPCObject;

        public function DrupalLogin( url:String )
        {
            _api = new XMLRPCObject();
            _api.endpoint = url;
            _api.destination = "";
        }

        public function set LoginResult( fn:Function ):void {_handleLoginResult = fn; }
        public function set CheckResult( fn:Function ):void {_handleCheckResult = fn; }
        public function set LogoutResult( fn:Function ):void {_handleLogoutResult = fn; }
        public function get User():String { return _user; }
        public function set TraceResult( fn:Function ):void {_handleTrace = fn; }

        private var _handleLoginResult:Function;
        private var _handleCheckResult:Function;
        private var _handleLogoutResult:Function;
        private var _handleTrace:Function;

        private function onTrace( st:String ):void
        {
            _handleTrace(st);
        }

        private var _firstCheckDone:Boolean = false;
        private var _loggedIn:Boolean = false;

        // The logged-in user's ID (if any)
        private var _user:String = "";

        // *****************************************
        // doLogin
        // *****************************************

        // Function doLogin kicks off the process.
        public function doLogin( user:String, pwd:String ):void
        {
            onTrace( "******************* doLogin ********************" );

            if( !_firstCheckDone )
            {
                _handleLoginResult( false, "ALWAYS CALL doCheck() FIRST TO SEE IF YOU NEED TO LOG IN OR NOT" );
                return;
            }
            if( _loggedIn )
            {
                _handleLoginResult( true, "YOU ARE ALREADY LOGGED IN" );
                return;
            }

            var token:AsyncToken = _api.call( "user.login", _sid, user, pwd );
            var tresponder:ItemResponder = new ItemResponder(this.onLoginInfo,this.onLoginFault);
            token.addResponder(tresponder);
        }

        private function onLoginInfo (event:ResultEvent,token:Object = null):void
        {
            onTrace( "... got onLoginInfo" );

            _user = event.result.user.name;
            _loggedIn = true;
            _handleLoginResult( true, "logged in ok" );         
        }

        private function onLoginFault (event:FaultEvent, token:Object=null):void
        {
            onTrace( "   got onLoginFault" );

            _loggedIn = false;
            _handleLoginResult( false, "Fault: " + event.fault.faultString + " -- " + event.fault.faultCode);
        }

        // *****************************************
        // doLogout
        // *****************************************

        public function doLogout():void
        {
            onTrace( "******************* doLogout ********************" );

            if( !_firstCheckDone )
            {
                _handleLogoutResult( false, "ALWAYS CALL doCheck() FIRST TO SEE IF YOU ARE ABLE TO LOG OUT OR NOT" );
                return;
            }
            if( !_loggedIn )
            {
                _handleLogoutResult( true, "YOU ARE ALREADY LOGGED OUT" );
                return;
            }

            var token:AsyncToken = _api.call( "user.logout", _sid );
            var tresponder:ItemResponder = new ItemResponder(this.onLogoutInfo,this.onLogoutFault);
            token.addResponder(tresponder);
        }

        private function onLogoutInfo (event:ResultEvent,token:Object = null):void
        {
            onTrace( "got onLogoutInfo" );

            _loggedIn = false;
            _handleLogoutResult( true, "logged out ok" );           
        }

        private function onLogoutFault (event:FaultEvent, token:Object=null):void
        {
            onTrace( "got onLogoutFault" );

            _loggedIn = false;
            _handleLogoutResult( false, "Fault: " + event.fault.faultString + " -- " + event.fault.faultCode);
        }

        // *****************************************
        // doCheckLogin
        // *****************************************

        private var _sid:String;

        public function doCheckLogin():void
        {
            onTrace( "******************* doCheckLogin ********************" );

            var token:AsyncToken = _api.call( "system.connect" );
            var tresponder:ItemResponder = new ItemResponder(this.onCheckInfo,this.onCheckFault);
            token.addResponder(tresponder);

        }

        private function onCheckInfo (event:ResultEvent,token:Object = null):void
        {
            onTrace( "got onCheckInfo" );

            _user = event.result.user.name;
            _sid = event.result.user.sid;
            var roles:Object = event.result.user.roles;
            _loggedIn = false;
            for( var i:int=0; i<10; i++ )
            {
                var tmp:String = roles[i.toString()];
                if( tmp == "authenticated user" )
                    _loggedIn = true;
            }

            trace( "user = " + _user + ", sid=" + _sid + ", loggedIn=" + _loggedIn );
            _firstCheckDone = true;

            _handleCheckResult( _loggedIn, _loggedIn?("Currently logged in as " + _user):"Not logged in yet" );
        }

        private function onCheckFault (event:FaultEvent, token:Object=null):void
        {
            onTrace( "got onCheckFault" );

            _handleCheckResult( false, "Fault: " + event.fault.faultString + " -- " + event.fault.faultCode);
        }

    }
} 
```

这是一个使用它的例子：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:Script source="LoginExample.as" />
    <mx:Button id="btnGoodLogin" click="btnGoodLogin_onClick()"  label="Good Login" enabled="true" y="28"/>
    <mx:Button id="btnBadLogin" click="btnBadLogin_onClick()"  label="Bad Login" enabled="true" y="28" x="112"/>
    <mx:Button id="btnLogout" click="btnLogout_onClick()"  label="Logout" enabled="true" y="28" x="219"/>
    <mx:Button id="btnCheck" click="btnCheck_onClick()"  label="Check" enabled="true" y="28" x="325"/>
    <mx:Text id="txtResult"  y="58" width="263"/>
</mx:Application>

import flash.events.*;
import flash.net.*;

private var _login:DrupalLogin;

private function setup():void
{
    if( _login==null )
    {
        var url:String = "http://myserver/mydrupal?q=services/xmlrpc";

        _login = new DrupalLogin(url);
        _login.CheckResult = handleCheckResult;
        _login.LoginResult = handleLoginResult;
        _login.LogoutResult = handleLogoutResult;
        _login.TraceResult = handleTraceResult;
    }
}

private function btnGoodLogin_onClick():void
{
    setup();
    _login.doLogin( "goodname", "goodpwd" );
}

private function btnBadLogin_onClick():void
{
    setup();
    _login.doLogin( "badname", "badpwd" );
}

private function btnLogout_onClick():void
{
    setup();
    _login.doLogout();
}

private function btnCheck_onClick():void
{
    setup();
    _login.doCheckLogin();
}

private function showResult( result:String):void
{
    trace( "showResult: " + result );
    txtResult.text = result;    
}

private function handleTraceResult( text:String ):void
{
    trace( text );
}

private function handleCheckResult( loggedIn:Boolean, txt:String="" ):void
{
    if( txt != "" )
        txt = " (" + txt + ")";

    if( loggedIn )
        showResult( "ALREADY LOGGED IN AS " + _login.User + txt);
    else
        showResult( "NOT LOGGED IN YET" + txt );
}

private function handleLoginResult( loggedIn:Boolean, txt:String="" ):void
{
    if( txt != "" )
        txt = " (" + txt + ")";

    if( loggedIn )
        showResult( "LOGIN ATTEMPT SUCCEEDED" + txt);
    else
        showResult( "LOGIN ATTEMPT FAILED" + txt );
}

private function handleLogoutResult( loggedOut:Boolean, txt:String="" ):void
{
    if( txt != "" )
        txt = " (" + txt + ")";

    if( loggedOut )
        showResult( "LOGOUT ATTEMPT SUCCEEDED" + txt );
    else
        showResult( "LOGOUT ATTEMPT FAILED" + txt);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T13:26:20.303

我知道这距离这篇文章最初的发布还有很长的路要走，但如果你仍然对此感兴趣并且从未花时间研究它，我想出了如何通过 Flash 文档成功处理登录。（就此而言，它是嵌入式的或外部的。）它甚至不需要在系统上安装 AMFPHP。（这很好，因为我上次检查了 AMFPHP 所依赖的服务模块还没有推荐状态。）

我在这里设置了一个演示页面：[AS3 Login Demo Page](http://demo.andrewnprice.com)

你可以登录和注销，它会检测你是否已经登录。它仍在进行中，但你需要的大部分东西都已经为你准备好了。

如果您想查看文档并想要一份源代码的副本，所有这些都可以在此处获得：[www.andrewnprice.com](http://www.andrewnprice.com/seo_consultant/development_blog/create_external_flash_login_page_drupal_or_any_other_cms_matter_as3_)

我希望这会有所帮助。我应该在下周的某个时间对该演示进行更新，所以如果你想要我在帖子中提到的其他一些功能，请回来查看。

# ajax - 返回重定向作为对 XHR 请求的响应

> ID：282429
> 
> 赞同：156
> 
> 时间：2008-11-11T22:59:13.197
> 
> 标签：ajax, http

如果浏览器收到对 ajax 请求的重定向响应，会发生什么？

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2010-04-04T04:45:11.507

*如果浏览器收到对 ajax 请求的重定向响应，会发生什么？*

如果服务器发送重定向（也就是 302 响应加上 Location: 标头），浏览器会自动跟随重定向。对*第二个*请求的响应（假设它也不是另一个重定向）是暴露给您的程序的内容。

实际上，您没有能力检测是否发生了 302 响应。如果 302 重定向导致 200，那么您的程序的行为与原始请求直接导致 200 相同。

这既是我的经验，[也是规范中提到的行为](http://dvcs.w3.org/hg/xhr/raw-file/tip/Overview.html#infrastructure-for-the-send%28%29-method)。

**2016 年更新：**时间已经过去，好消息是新的[fetch() API](https://fetch.spec.whatwg.org/)被指定为如何处理重定向提供[更细粒度的控制](https://fetch.spec.whatwg.org/#concept-request-redirect-mode)，默认行为类似于 XHR。也就是说，它仅适用于 fetch()*本地*实现的情况。[fetch() 的 Polyfill 版本（](https://github.com/github/fetch)基于 XHR）<a href="https://github.com/github/fetch/issues/137" rel="noreferrer">继续存在 XHR 的限制。幸运的是，[本机浏览器支持](http://caniuse.com/#search=fetch)似乎正在完善。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-11T23:05:45.290

将`ajax-request`遵循重定向 afaik。实际内容 ( `.responseText`, `.responseXML`) 将是您被重定向到的页面的内容。

您可能能够拦截 2 或 3 上的重定向 ( `status-code`, `location-header`) `readyState`，但不确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-10T01:29:00.713

TLDR：它是可行的`fetch`。
更多信息在这里：[https ://github.com/axios/axios/issues/932#issuecomment-515229573](https://github.com/axios/axios/issues/932#issuecomment-515229573)

# open-source - 古典音乐理论/作曲/和声与对位软件

> ID：282431
> 
> 赞同：5
> 
> 时间：2008-11-11T23:00:29.747
> 
> 标签：open-source, artificial-intelligence

是否有任何软件可以帮助学习/理解/尝试和声和对位规则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-11T23:23:39.577

巴赫风格的 4 声部和声实际上确实遵循一些非常严格的规则（例如，没有平行的 4 度、5 度或八度），一旦你了解了这些规则，将旋律分成四个部分进行和声是一件相当简单的事情。这就是我在英国 A-Level 的教学方式，我们不应该偏离这些规则——事实上，偏离几乎是一种即时的降价。

然而，正如 gnud 所说，真正的好东西来自于知道你可以在哪里打破哪些规则，并聪明地应用这些知识。我想人们可以编写一些软件，它可以采用旋律并提出一些遵循规则的东西，以及一些预先定义的打破或弯曲规则的方式。不过，我不知道。对不起。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T03:02:20.547

我是一个不读书的作曲家，只是“坚持”了很长时间，现在我已经掌握了它。我几乎用电脑作曲。

你可以得到一个简单的 midi 音序器，或者像 Propellorhead Reason（伟大的作曲工具）中的那个非常好的一个，自己试验，或者下载巴赫和其他古典作曲家的免费 MIDI 文件，然后你可以看到音符在哪里在MIDI音序器的键盘上。另外，您可以移动它们以查看会发生什么。

一个非常好的学习语音引导和和弦变化（进行）的网站，是

[http://www.musicnovatory.com/](http://www.musicnovatory.com/)

这不是一个非常直观的导航网站。但是，通过语音引导和和弦选择，可以学到很多东西来帮助做出良好的声音变化。要有耐心并且非常好奇，也就是说，在网站上四处逛逛，你会发现宝石。

一旦你掌握了其中的一些内容，就可以买一本关于对位的体面的书，你会在不知不觉中飞起来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-01T15:11:11.600

您可能想查看[Cognitone](http://cognitone.com/)的 Harmony Navigator 。我似乎正是您正在寻找的...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T01:32:31.733

您还可以查看[Ars-Nova 的“CounterPointer”](http://www.ars-nova.com/cp/)。

该软件将根据巴赫的声乐风格规则训练您的声音引导和对位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T23:04:34.390

虽然非常仔细编码的应用程序可以给你一些提示，但我发现最重要的教训是何时打破规则。计算机程序永远无法解决这个问题。

我建议你买一本书。好的包括

*   [Palestrina的风格和不和谐](https://rads.stackoverflow.com/amzn/click/com/0486442683)
*   [二十世纪的和谐](https://rads.stackoverflow.com/amzn/click/com/0393095398)

我没有读过任何关于巴洛克风格、维纳风格或浪漫风格的英文书籍。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T23:16:51.447

我认为学习这些东西的最好方法有点像最好的编程方法。通过实际播放音乐并聆听它。我不确定软件将如何帮助解决这个问题。精选的 CD，也许还有一些带有讲座的 CD，是您最好的选择。

那里有软件可以教您如何演奏乐器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-20T18:47:58.230

查找 Frederick Horwood 的这些书，名为 Theory, Harmony, and Counterpoint。这三本小书中包含的经过时间验证和可转移的信息，直接适用于现场表演的需求和音乐技术的现状，我所合作过的任何工作的、有偿的表演音乐家都没有从中受益。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-31T13:49:59.500

你可以试试 APP [MIND](https://itunes.apple.com/gb/app/midi-mind/id551958423?mt=8)或[MTBX MIDI Monitor](https://itunes.apple.com/gb/app/mtbx/id891039931?mt=12)

但是学习和听力的建议是非常正确的祝一切顺利

# version-control - 在源代码控制术语中，什么是尖峰？

> ID：282434
> 
> 赞同：19
> 
> 时间：2008-11-11T23:01:18.000
> 
> 标签：version-control, terminology, cvs

我已经看到与源代码控制有关的“尖峰”一词。

例如，我正在处理的一个项目有三个顶级文件夹：主干、分支和尖峰。

这个词的含义是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2018-08-21T16:55:58.710

接受的答案不再一定是正确的。随着 2010 年 GitFlow 的推出（在提出并回答了这个问题之后），“尖峰”的定义发生了变化。至少在 GitFlow 的上下文中，“尖峰分支”是用于探索特定主题的分支。它*永远不会*被合并到 master/develop 分支或部署。

该术语来自极限编程：

> 创建尖峰解决方案以找出棘手的技术或设计问题的答案。尖峰解决方案是一个非常简单的程序，用于探索潜在的解决方案。建立尖峰以仅解决正在检查的问题并忽略所有其他问题。大多数尖刺都不足以保留，所以希望将其扔掉。目标是降低技术问题的风险或提高用户故事估计的可靠性。

[http://www.extremeprogramming.org/rules/spike.html](http://www.extremeprogramming.org/rules/spike.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-11T23:04:45.120

“Spike”是“Tag”的同义词。它是地面上的“尖峰”，意味着它不会移动，而树枝会生长。

为了进一步说明，“标签”或“尖峰”代表项目的发布版本。标签是该版本的快照，因此没有积极开发，尽管可以从标签创建分支然后进一步开发。

# javascript - 如何在客户端使用 JavaScript 来检测页面是否已加密？

> ID：282444
> 
> 赞同：51
> 
> 时间：2008-11-11T23:04:03.703
> 
> 标签：javascript, http, https

是否可以在客户端检测用户是否使用加密页面？

换句话说——我想知道当前页面的 URL 是以 http 还是 https 开头的。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-11-11T23:06:45.883

用于`window.location.protocol`检查是否是`https:`

```
function isSecure()
{
   return window.location.protocol == 'https:';
} 
```

或者，如果您没有本地范围的位置，则可以省略指定“窗口”。

```
function isSecure()
{
   return location.protocol == 'https:';
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-03-18T20:45:42.423

正如谷歌分析告诉我的：

```
if ("https:" == document.location.protocol) {
    /* secure */
} else {
    /* unsecure */
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-24T20:19:45.850

最新浏览器的第二种方法：

```
var secure = window.isSecureContext; 
```

或者只是获取 isSecureContext：

```
if (isSecureContext) {
   ...
} 
```

更多信息：[https ://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts#Feature_detection#Feature_detection](https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts#Feature_detection#Feature_detection)

# soap - WSDL 最佳实践

> ID：282448
> 
> 赞同：5
> 
> 时间：2008-11-11T23:04:46.527
> 
> 标签：soap, wsdl, gsoap

我正在开发一个与第 3 方集成的 SOAP 应用程序。我觉得这个第三方的 WSDL 很奇怪。我对 SOAP 很陌生，所以如果它没有损坏，我不想去要求他们修复它。以下是我注意到的一些我认为错误的事情，尽管我确信它在技术上是一个有效的文档（因此我在标题中写了“最佳实践”）。另外，我使用 gSOAP 作为我的 SOAP 库，这可能就是为什么我认为其中一些东西很奇怪（我对 gSOAP 的了解甚至比对 SOAP 的了解还要新）。

1.  它们在同一个 WSDL 中为 SOAP 1.1 和 SOAP 1.2 指定了接口。这会导致 gSOAP 生成两倍于它需要的类，因为我只打算使用 1.2。

2.  他们所有的命名空间都是`http://tempuri.org`. 那不应该是这样的，对吧？

3.  尽管定义了一堆 RPC 调用，但它们的 WSDL 使用文档格式。我正在考虑要求他们切换到 RPC 格式，因为 gSOAP 似乎不会生成将 C++ 类型参数用于文档格式的方法。相反，它为每个 API 函数的输入和响应数据创建一个新类。如果我不能解决这个问题，我将不得不编写另一层包裹 gSOAP 的东西，以便为我的应用程序的其余部分提供合理的 API。此外，AFAICT，如果他们切换到 RPC，将来回传输的 XML 将与现在完全相同，所以我认为这并不困难。

4.  元素具有 minOccurs = 0 但是当我在没有它们的情况下提交请求时，我得到返回的错误表明它们是必需的（有时甚至是空指针异常的堆栈跟踪）。如果需要，他们应该将它们指定为 minOccurs = 1，对吗？

5.  几乎所有的 Web 服务函数都指定了一个响应，其中包括一个表示成功的整数（实际上是一个布尔值）和一个错误消息字符串。他们应该为此使用 SOAP 错误吗？我认为如果它是一个错误，我的应用程序会更容易处理，因为 gSOAP 会让我很容易地解决这个问题（并简单地打印错误消息）。

当然，我不希望这家第 3 方公司仅仅因为我要求他们就改变他们的 WSDL。至少我会学到一些东西……据我所知，这些都不是错误的，甚至没有问题。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T15:31:55.980

我想对创建 WSDL 的最佳实践稍微概括一点：

**1\. 契约优先开发**
与 James 相比，我强烈强调契约优先方法的使用，因为它使开发人员能够使用 XML 的全部功能（限制、模式等），并且从那里它是公平的易于为任何编程语言生成代码。另一个原因是 <wsdl:types> 中的模式是两个系统之间相互交谈的契约。如果开发人员从代码创建 WSDL，可能会引入对特定编程语言的技术依赖（数据类型，...）。

**2\. 文档/文字样式**
RPC 编码的 SOAP 的验证可能很棘手，XPATH 查询和 XSLT 转换也是不可能的，而且这种样式无论如何都被弃用了。

RPC/literal 也会导致验证 XML 的问题（考虑到某些命名约定）。一些 SOAP 引擎丢弃了模式定义的名称空间，因此验证变得不可能。

使用 Document/literal 样式，SOAP 主体完全作为 XML 文档处理，可以以标准方式验证、转换和查询。

**3\. 关注点**
分离 通过使用<import..> 和<include..> 指令将模式定义与WSDL 文件本身分离。这促进了模式的重用和将命名空间分离到不同的 .xsd 文件中，并且还减小了文件的大小；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-11T23:26:09.773

1 - 他们可能认为这是一项功能。:-)

2 - 这太可怕了。

3 - 很多人推荐这个。它被称为包装格式。

4 - 你是对的。

5 - 这取决于。从理论上讲，您可能是正确的，但实际上许多 SOAP 工具包对 SOAP 错误没有很好的支持，因此它们可能故意选择不使用异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T20:04:06.773

在我看来，您尝试与之交互的第三方也不知道 Web 服务。

根据您的描述，这听起来非常典型的 Microsoft ASP.NET Web 服务实现，第三方编写了一点 VB 或 C# 来接口他们必须提供的东西，将其推送到 ASP.NET 服务器并调用它，具体取决于在 ASP.NET 引擎上根据请求自动生成 WSDL。

您可以要求他们不要提供 SOAP 1.1 定义，但我认为他们不会帮助您，因为他们不知道如何提供。你可以问他们为什么命名空间是 tempuri.org，我相信他们的回答会是“我们必须调查一下”，而他们真正想说的是“是吗？？” 因为他们也不知道为什么。

命名空间由代码中的编译器指令控制，并且 tempuri.org 是 Microsoft 默认的（不记得它叫什么 atm sorry）。当然，命名空间的值并不重要（除了看起来很奇怪），因为它实际上只是为了为变量名称解析提供唯一的字符串标识符。也许其他东西可以以类似的方式控制，我不知道，我真的不知道 Web 服务或 ASP.NET 或任何那些东西，我自己不是该技术的忠实粉丝。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T15:38:21.067

首先，没有人真正编写 WSDL——它是由工具生成的。您的供应商工具可能会为命名空间插入正确的 url，并且可能有一些单选按钮说——V1.0、V1.1、两者。供应商可能有一些现有的非 SOAP 代码并使用一些工具将它们包装为 SOAP 服务。

没有人写 WSDL，所以你不应该读它！获得一个像样的工具集，像 SOAPUI 之类的东西将解码 WSDL 并允许您浏览它而不会爆炸。它是 Java，但无论您使用哪种语言编写代码，它都是最好的测试工具。

我的 SOA 经验主要是在 Java 中，就库和工具而言，您可以选择太多。C++ 在这方面可能还不够成熟，但听起来确实问题出在工具选择上，而不是 WSDL 上。在现实世界中，您将看到不太完美的 WSDL，因此您的工具应该能够以合理的方式处理它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-11T03:24:22.093

刚才遇到这个，发现必须正确写前缀，前缀必须是跟两个连续的下划线'youtns__methodname'

例如

```
typedef double xsd_double;
int ns__add(xsd_double a, xsd_double b, xsd_double &result);
int ns__sub(xsd_double a, xsd_double b, xsd_double &result);
int myns__sqrt(xsd_double a, xsd_double &result); 
```

这将在运行 soapcpp2 后生成两个 wsdl 文件： **ns.wsdl**和**myns.wsdl**

但是你是这样定义你的方法吗（一个下划线）

```
int ns_add(xsd_double a, xsd_double b, xsd_double &result); // wrong 
```

spapcpp2 不会产生任何东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T23:39:11.307

您遇到的是典型的第三方在创建 Web 服务时的懒惰。我想您不会很幸运地尝试与他们推理，但是您可以手动编辑 WSDL 以删除 1.1 定义。

# .net - 即使有事务回滚，SQL 标识（自动编号）也会增加

> ID：282451
> 
> 赞同：83
> 
> 时间：2008-11-11T23:05:58.910
> 
> 标签：.net, sql, sql-server-2005, transactions, identity-column

我有一个带有 SQL 插入到 SQL Server 2005 数据库的 .net 事务。该表具有标识主键。

当事务中发生错误时，`Rollback()`调用。行插入正确回滚，但是下次我将数据插入表时，标识会增加，就好像回滚从未发生过一样。所以本质上在身份序列中存在差距。有没有办法让该`Rollback()`方法恢复丢失的身份？

我不是以正确的方式接近这个吗？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2008-11-11T23:24:16.847

如果您考虑一下，自动增量数字**不应该**是事务性的。如果其他事务必须等待查看自动编号是否将被使用或“回滚”，它们将被使用自动编号的现有事务阻止。例如，考虑下面我的伪代码，表 A 使用 ID 列的自动编号字段：

```
User 1
------------
begin transaction
insert into A ...
insert into B ...
update C ...
insert into D ...
commit

User 2
-----------
begin transaction
insert into A ...
insert into B ...
commit 
```

如果用户 2 的事务在用户 1 之后一毫秒开始，那么他们对表 A 的插入将不得不等待用户 1 的整个事务完成，以查看是否使用了第一次插入 A 的自动编号。

这是一个功能，而不是一个错误。如果您需要它们紧密顺序，我建议使用另一种方案来生成自动编号。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-12T01:11:21.340

如果你依赖于你的身份价值观是无缝的，那么是的——你做错了。[代理键](http://en.wikipedia.org/wiki/Surrogate_key)的全部意义在于没有*商业意义*。

而且，不，没有办法改变这种行为（除了滚动你自己的自动增量，并遭受阻塞其他插入的性能后果）。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-11T23:56:53.270

如果您也`DELETE`排成一排，您的序列中也会出现空白。

序列必须是唯一的，但它们不需要是连续的。它们单调递增的事实只是实施的侥幸。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-14T02:15:24.013

所有其他说不用担心，你*应该*有差距的海报都是对的。如果该数字具有商业意义，并且该意义不存在空白，则不要使用标识列。

仅供参考，如果您出于某种原因想要消除差距，大多数数据库都有办法将自动编号重新设置为您选择的编号。这很麻烦，如果您发现自己需要定期这样做，那么您绝对不应该使用自动编号/身份字段，如上所述。但这是在 SQL Server 中执行此操作的代码：

DBCC CHECKIDENT('Product', RESEED, 0)

这会将产品表设置为从 1 开始（尽管如果表中有记录，它显然会跳过已经采用的 ID 值。）其他 RDBMS 供应商有自己的语法，但效果大致相同，所以在系统帮助文件或互联网中查找“重新种子身份”或“重新种子自动编号”。

再说一遍：这是用于特殊场合，而不是经常使用。不要把它放在一个存储过程中，让我们都过来。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-11T23:10:40.053

据我所知，插入的行声明了自动编号，并且在回滚时，该编号将永远丢失。如果您依赖于排序中的自动编号，您可能需要考虑您正在使用的方法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-11T23:12:24.497

我认为没有任何要求自动编号的键是连续的。事实上，我不认为他们可以被要求：

*   事务 a 开始并插入

*   事务 b 开始并插入

*   交易中止

    你得到一个洞。无事可做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-11T23:22:39.953

Muhan 尝试在执行此事务的许多同时连接的上下文中考虑它，而不是一次一个。有些会失败，有些会成功。您希望 SQL Server 专注于在新请求进入时运行它们，而不是维护无间隙的标识列。IMO it（价值观的差距）绝对不值得花时间在上面。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-11T23:31:09.047

不，序列实现使用自治事务。在 Oracle 中，自治事务曾经在 dbms 内部，但现在公开供您自己使用（并且经常被错误地使用）

```
PRAGMA AUTONOMOUS_TRANSACTION;' 
```

# c# - 当数组的成员可能包含多个单词时，如何拆分 C# 字符串？

> ID：282457
> 
> 赞同：-1
> 
> 时间：2008-11-11T23:08:20.247
> 
> 标签：c#, algorithm

我正在做一个小项目，以获取 CSV 文件，然后将其数据插入 HTML 表（我会使用数据网格和数据集或数据表，但我将与之交谈的系统不支持 ASP.NET 上传以发送时事通讯） .

无论如何，我将使用 file.readalllines 方法将 csv 文件的内容返回到字符串数组中。

但是对于数组的每个字符串成员，我将使用 string.split 函数将字符串拆分为 char 数组。问题是（并且 csv 文件是由我与 btw 交谈的系统生成的 - 我从该系统获取数据并将数据输入其中），csv 内容是汽车制造的。这意味着我可以：

日产阿尔梅拉

日产阿尔梅拉 1.4 TDi

大众高尔夫 1.9 SE

等等……

有没有一种可靠的方法可以确保我拥有 Almera 1.4 TDi，例如，它是我将每个字符串拆分成的 char 数组中的一个成员，而不是单独的成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-11T23:24:47.467

使用`string.Split()`限制返回值数量的重载版本。

```
 string makeModel = csvArray[0]; // or whichever column it is in
    string[] makeAndModel = makeModel.Split( new char[] { ' ' } , 2 );
    string make = makeAndModel[0];
    string model = makeAndModel[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T00:32:36.957

> 您将需要使用正则表达式。

我不太确定你*需要*一个正则表达式，但你*可以*用一个来解决问题，然后你就会遇到两个问题。

5 秒的 Google 搜索会`regex csv`产生[一个博客条目](http://regexadvice.com/blogs/dneimke/archive/2004/01/17/201.aspx)

```
,(?=([^"]*"[^"]*")*(?![^"]*")) 
```

虽然起初它看起来可以解决问题，但这个正则表达式虽然不匹配逗号的内部字符串，但匹配了逗号的位置。所以你会认为把它变成有用的东西是非常微不足道的，或者至少给你一个起点。

请注意，如果您有一个像这样的输入字符串，它会惨遭失败

> ```
> 123,456,"Unbalanced quote 
> ```

它不匹配任何逗号的地方。

* * *

第 2 步，另一个 Google 搜索，这次是`c# split csv files`

[C# 中的 CSV 文件解析器和编写器（第 3 部分）](http://knab.ws/blog/index.php?/archives/14-CSV-file-parser-and-writer-in-C-Part-3.html)（但请查看第 1 部分和第 2 部分的代码）

它看起来更健壮，甚至有测试用例。

因为没有标准的 CSV 格式，所以您必须判断这是否适用于您允许的输入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T01:47:07.557

据我了解这个问题：

*   正在解析的文件中的行不是 CSV，它们是用空格分隔的。
*   每行（品牌/型号）的第一个字段的值可能包含 0 个或多个实际空格。
*   每行中其他字段的值不包含空格，因此空格分隔符适用于它们。

假设您有四列，第一列的值应该是“Nissan Almera 1.4 TDi”。使用普通的 Split() 会产生 7 个字段而不是 4 个。

（未经测试的代码）

首先，只需拆分它：

```
int numFields = 4;
string[] myFields = myLine.Split(' '); 
```

然后，修复数组：

```
int extraSpaces = myFields.length-numFields;
if(extraSpaces>0) {
  // Piece together element 0 in the array by adding the extra elements
  for(int n = 1; n <= extraSpaces; n++) {
    myFields[0] += ' ' + myFields[n];
  }
  // Move the other values back to elements 1, 2, and 3 of the array
  for(int n = 1; n < numFields; n++) {
    myFields[n] = myFields[n + extraSpaces];
    }
  } 
```

最后，忽略数组中您实际想要解析的四个元素之外的每个元素。

另一种方法是正则表达式。我认为这样的事情会起作用：

```
 MatchCollection m = RegEx.Matches(myLine, "^(.*) ([^ ]+) ([^ ]+) ([^ ]+)$");
 string MakeModel = m.Groups[1].Captures[0].ToString();
 string ModelYear = m.Groups[2].Captures[0].ToString();     
 string Price     = m.Groups[3].Captures[0].ToString();     
 string NumWheels = m.Groups[4].Captures[0].ToString(); 
```

这里没有拆分或数组，只有 RegEx 捕获的组。

如果有内置的 String.Reverse() 方法（没有），我可能会建议使用带有 Count 参数的 VB.NET 的 Replace() 函数来替换反转中前三个空格（假设四个字段）之后的所有空格原始字符串，然后再次反转并拆分它。就像是：

```
string[] myFields = Microsoft.VisualBasic.Replace(myLine.Reverse(), " ", "_", 0, 3).Reverse().Split(' ');
myFields[0] = myFields[0].Replace("_", " "); //fix the underscores 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T05:45:47.207

正如其他人指出的那样， string.split() 接受一个参数，因此您可以传递一个 ',' 以基于该参数进行拆分。值中是否有空格无关紧要。但是，除非您真的确定不会有包含逗号的值，否则我不建议这样做。解析 CSV 文件比最初看起来要复杂一些（处理引号和包含逗号的值），我建议使用一些现有的库，例如[http://www.codeproject.com/KB/database/CsvReader.aspx](http://www.codeproject.com/KB/database/CsvReader.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T23:21:22.997

说到汽车，我有点笨，但你能不能把主要品牌指定为分隔符，而不是空格？

EG: Nissan Almera Nissan _X100_Ultra_Model Ford Prefect Toyota Foo Bar Honda Prius

解析主要品牌（日产、福特、丰田、本田）会产生：

*   日产阿尔梅拉
*   日产_X100_Ultra_Model
*   福特级长
*   丰田富吧
*   本田普锐斯

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-11T23:20:43.497

Split() 方法采用可用于指定分隔符的 char 参数。因此，您可以执行以下操作：

```
String.Split(Convert.ToChar(",")); 
```

从你的问题来看，所有的汽车都应该用逗号分隔，所以这应该有效。

# c# - 什么是 C# 等价于 Java 的 isInstance()？

> ID：282459
> 
> 赞同：90
> 
> 时间：2008-11-11T23:09:50.523
> 
> 标签：c#, reflection, introspection, instanceof

我知道`is`and `as`for `instanceof`，但是反射[isInstance()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Class.html#isInstance(java.lang.Object))方法呢？

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2008-11-12T05:12:24.740

```
bool result = (obj is MyClass); // Better than using 'as' 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-11-11T23:13:08.473

C#中Java的等价物`obj.getClass().isInstance(otherObj)`如下：

```
bool result = obj.GetType().IsAssignableFrom(otherObj.GetType()); 
```

请注意，虽然 Java 和 C# 都在(via vs ) 的运行时类型对象 (Java `java.lang.Class`≣ C# `System.Type`) 上工作，但 Java将对象作为其参数，而 C#需要另一个对象。`obj``.getClass()``.getType()``isInstance``IsAssignableFrom``System.Type`

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-11-12T05:30:53.157

取决于，`is`如果您不想使用演员表的结果，请使用，`as`如果您愿意，请使用。你几乎不想写：

```
if(foo is Bar) {
    return (Bar)foo;
} 
```

代替：

```
var bar = foo as Bar;
if(bar != null) {
    return bar;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T01:10:18.457

就在我的脑海中，你也可以这样做：

```
bool result = ((obj as MyClass) != null) 
```

不确定哪个会更好。我将把它留给其他人进行基准测试:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-28T12:52:57.437

下面的代码可以替代`IsAssignableFrom`.

```
parentObject.GetType().IsInstanceOfType(inheritedObject) 
```

请参阅MSDN 中的[Type.IsInstanceOfType](https://msdn.microsoft.com/en-us/library/system.type.isinstanceoftype%28v=vs.110%29.aspx)描述。

# svn - 如何找出 Subversion 存储库版本？

> ID：282460
> 
> 赞同：76
> 
> 时间：2008-11-11T23:10:24.550
> 
> 标签：svn, berkeley-db, fsfs

如何确定我的存储库的当前版本以查看是否需要升级它（svnadmin upgrade）？

实际上，我正在与第 3 方一起托管 SVN，我想知道是否需要让他们升级我的存储库。

我在问，因为 1.5 服务器会将 repo 版本保持在 1.4，除非我错过了什么？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-11T23:18:01.990

看看`<REPO>/db/format`。升级到 1.5 格式后，我的`format`文件显示：

```
3
layout sharded 1000 
```

以前是：

```
2 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-11T23:24:22.680

获取`http`或`https`链接到您的存储库并将其剪切并粘贴到浏览器中。Subversion~~存储库~~ ***服务器***版本默认显示在页脚中。

> 由 Subversion 版本 1.4.5 (r25188) 提供支持。

有人会假设`1.4`服务器不会针对`1.5`存储库运行。

有关详细信息，请参阅[Subversion 1.5 发行说明](http://subversion.tigris.org/svn_1.5_releasenotes.html)

感谢@Omus 的更正。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-17T22:42:08.127

您可以查看“db”目录下的文件“format”的内容。如果显示为 3，则它已升级到 1.5（即更新后的字段系统的版本）。如果它是 2，那么它是 1.4 或更高版本。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-06-23T11:48:31.183

Subversion Repository Version / Schema (1) 和 Subversion Repository FSFS Version (2) 之间存在差异。

FSFS 与 Berkeley DB 或开发中的 FSX 相比，是一种后端数据存储方法。[FSFS](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.reposadmin.basics.backends)是“直接使用本机 OS 文件系统的版本化文件系统实现”。

(1)：Subversion 存储库版本/模式在 [REPO]/format 文件中找到。[Subversion repos_upgrade_HOWTO](https://svn.apache.org/repos/asf/subversion/trunk/notes/repos_upgrade_HOWTO)文档的当前版本是：

```
SUBVERSION VERSION NUMBER           SCHEMA VERSION
-------------------------           --------------
Up to and including 0.27            1
0.28 - 0.33.1                       2
0.34 - 1.3                          3
(no released version used this)     4
1.4 -                               5 
```

(2): 但是，存储库 FSFS 格式位于 [REPO]/db/format 文件中。当前版本位于*文件系统格式*部分的[libsvn_fs_fs FSFS 结构](https://svn.apache.org/repos/asf/subversion/trunk/subversion/libsvn_fs_fs/structure)文档中。他们目前是：

 *```
Format 1, understood by Subversion 1.1+
Format 2, understood by Subversion 1.4+
Format 3, understood by Subversion 1.5+
Format 4, understood by Subversion 1.6+
Format 5, understood by Subversion 1.7-dev, never released
Format 6, understood by Subversion 1.8
Format 7, understood by Subversion 1.9
Format 8, understood by Subversion 1.10+ 
```

此外，从 Subversion 1.9 开始，您现在可以使用*svnadmin info*命令来获取 Subversion 存储库版本/模式，以及 Subversion 存储库 FSFS 版本（请参阅： [Subversion 1.9 发行说明 - FSFS 改进](https://subversion.apache.org/docs/release-notes/1.9.html#fsfs-improvements)以及[Subversion 1.9 发行说明 - svnadmin 更改和改进](https://subversion.apache.org/docs/release-notes/1.9.html#svnadmin-info)）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-07-22T03:06:52.703

对于VisualSVN Server，即使它使用自定义页面，您仍然可以查看页面源:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T16:40:46.683

我还建议欺骗响应标头，因为某些服务器安装（想到[VisualSVN 服务器）使用自定义页面，不幸的是不显示 Subversion 服务器版本。](http://www.visualsvn.com/server/)

您可以使用[Fiddler2](http://www.fiddlertool.com/fiddler/)欺骗对服务器的请求/响应。如果您使用的是 HTTPS 连接，请务必在工具->Fiddler 选项->HTTPS 中选中“解密 HTTPS 流量”选项

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-23T14:30:06.313

如果您使用 VisualSVN Server，您可以通过 VisualSVN Server Manager 控制台或通过 PowerShell 找到存储库的格式。阅读文章[KB135：了解 Subversion 存储库类型和格式](https://www.visualsvn.com/support/topic/00135/)以获取更多信息。

## VisualSVN 服务器管理器

按照以下步骤找出存储库的格式：

1.  启动**VisualSVN 服务器管理器**控制台。
2.  右键单击存储库，然后单击**属性**。
3.  单击**详细信息**选项卡。

![](https://i.stack.imgur.com/lSNAL.png)

# 电源外壳

按照以下步骤通过 PowerShell 找出存储库的格式：

1.  [启动 PowerShell 控制台](https://www.visualsvn.com/support/topic/00165/)。
2.  执行以下命令： `Get-SvnRepository MyRepo | Format-List`

![](https://i.stack.imgur.com/LgbdC.png)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-02-16T02:41:12.863

我认为你想要的是“svnlook youngest”

# c# - C#中的字符串操作优化

> ID：282468
> 
> 赞同：7
> 
> 时间：2008-11-11T23:12:49.287
> 
> 标签：c#, string, optimization, performance

以下 C# 代码需要 5 分钟才能运行：

```
int i = 1;
string fraction = "";
while (fraction.Length < 1000000)
{
    fraction += i.ToString();
    i++;
} 
```

像这样“优化它”会导致它在 1.5 秒内运行：

```
int i = 1;
string fraction = "";
while (fraction.Length < 1000000)
{
    // concatenating strings is much faster for small strings
    string tmp = "";
    for (int j = 0; j < 1000; j++)
    {
        tmp += i.ToString();
        i++;
    }
    fraction += tmp;
} 
```

**编辑：**有些人建议使用`StringBuilder`，这也是一个很好的建议，这在 0.06 秒时出现：

```
int i = 1;
StringBuilder fraction = new StringBuilder();
while (fraction.Length < 1000000)
{
    fraction.Append(i);
    i++;
} 
```

寻找最佳值`j`是另一个话题，但是为什么这种不明显的优化效果如此之好呢？另外，在一个相关的话题上，我听说你永远不应该使用`+`带字符串的运算符，而支持`string.Format()`，这是真的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-11T23:35:28.663

我根本没有得到你的结果。在我的盒子上，StringBuilder 胜出。你能发布你的完整测试程序吗？这是我的，具有三个变体 - 您的字符串连接优化，“简单” StringBuilder 一个，以及具有初始容量的 StringBuilder。我增加了限制，因为它在我的盒子上运行得太快而无法有效测量。

```
using System;
using System.Diagnostics;
using System.Text;

public class Test
{
    const int Limit = 4000000;

    static void Main()
    {
        Time(Concatenation, "Concat");
        Time(SimpleStringBuilder, "StringBuilder as in post");
        Time(SimpleStringBuilderNoToString, "StringBuilder calling Append(i)");
        Time(CapacityStringBuilder, "StringBuilder with appropriate capacity");
    }

    static void Time(Action action, string name)
    {
        Stopwatch sw = Stopwatch.StartNew();
        action();
        sw.Stop();
        Console.WriteLine("{0}: {1}ms", name, sw.ElapsedMilliseconds);
        GC.Collect();
        GC.WaitForPendingFinalizers();
    }

    static void Concatenation()
    {
        int i = 1;
        string fraction = "";
        while (fraction.Length < Limit)
        {
            // concatenating strings is much faster for small strings
            string tmp = "";
            for (int j = 0; j < 1000; j++)
            {
                tmp += i.ToString();
                i++;
            }
            fraction += tmp;            
        }
    }

    static void SimpleStringBuilder()
    {
        int i = 1;
        StringBuilder fraction = new StringBuilder();
        while (fraction.Length < Limit)
        {
            fraction.Append(i.ToString());
            i++;
        }
    }

    static void SimpleStringBuilderNoToString()
    {
        int i = 1;
        StringBuilder fraction = new StringBuilder();
        while (fraction.Length < Limit)
        {
            fraction.Append(i);
            i++;
        }
    }

    static void CapacityStringBuilder()
    {
        int i = 1;
        StringBuilder fraction = new StringBuilder(Limit + 10);
        while (fraction.Length < Limit)
        {
            fraction.Append(i);
            i++;
        }
    }
} 
```

结果：

```
Concat: 5879ms
StringBuilder as in post: 206ms
StringBuilder calling Append(i): 196ms
StringBuilder with appropriate capacity: 184ms 
```

你的连接比第一个解决方案更快的原因很简单——你正在做几个“便宜”的连接（每次复制的数据相对较少）和相对较少的“大”连接（到目前为止的整个字符串） . 原来，*每一步*都会复制目前得到的所有数据，显然成本更高。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-11T23:16:13.337

使用[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)连接（大约）5 个以上的字符串（结果可能略有不同）。另外，给 StringBuilder 的构造函数一个关于预期最大大小的提示。

[更新]：只是评论您对问题的编辑。`StringBuilder`如果您对连接字符串的最终大小有一个近似（或精确）的想法，您还可以提高性能，因为这将减少它必须执行的内存分配数量：

```
// e.g. Initialise to 10MB
StringBuilder fraction = new StringBuilder(10000000); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-11T23:21:52.577

您可能会看到前 1000 个字符与后 1000 个字符相比几乎不需要时间。

我认为耗时的部分是每次添加 char 时将大字符串实际复制到新的内存区域中，这对您的计算机来说是一项艰巨的工作。

您的优化可以很容易地与您通常对流所做的比较，您使用缓冲区。较大的块通常会带来更好的性能，直到您达到不再产生任何影响的临界大小，并且在处理少量数据时开始成为不利因素。

但是，如果您从一开始就定义了一个具有适当大小的字符数组，它可能会非常快，因为这样就不必一遍又一遍地复制它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-11T23:16:39.077

> 另外，在一个相关主题上，我听说你永远不应该将 + 运算符与字符串一起使用，而应使用 string.Format()，这是真的吗？

不，就像所有绝对陈述一样，这是无稽之谈。但是，*确实*使用`Format`通常会使格式化代码更具可读性，并且通常比串联略快——但速度并不是这里的决定因素。

~~至于您的代码……它会导致在连接中复制较小的字符串（即`tmp`）。当然，在`fraction += tmp`您复制更大的字符串时，这种情况发生的频率较低。~~

因此，您已将许多大副本减少为几个大副本和许多小副本。

嗯，我刚刚注意到你的外循环在两种情况下都有相同的大小。那么，这不应该更快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-11T23:16:59.433

我现在不能做测试，但尝试使用 StringBuilder。

```
int i = 1;
    StringBuilder fraction = new StringBuilder();
    while (fraction.Length < 1000000)
    {
        fraction.Append(i);
        i++;
    }
return sb.ToString(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-11T23:52:56.100

回答修改后的问题（“为什么这种非显而易见的优化工作得这么好”和“你真的不应该在字符串上使用 + 运算符”）：

我不确定您在谈论哪种非显而易见的优化。但我认为，第二个问题的答案涵盖了所有基础。

字符串在 C# 中的工作方式是它们被分配为固定长度，并且不能更改。这意味着每当您尝试更改字符串的长度时，都会创建一个全新的字符串，并将旧字符串复制到适当的长度。这显然是一个缓慢的过程。当您使用 String.Format 时，它在内部使用 StringBuilder 来创建字符串。

StringBuilders 通过使用比固定长度字符串更智能地分配的内存缓冲区来工作，因此在大多数情况下表现得更好。我不确定内部 StringBuilder 的详细信息，因此您必须为此提出一个新问题。我可以推测它要么不重新分配字符串的旧部分（而是在内部创建一个链表，并且仅在 ToString 需要时才实际分配最终输出），要么它以指数增长重新分配（当内存不足时，它分配下一次是两倍，因此对于 2GB 的字符串，它只需要重新分配大约 30 次）。

您的嵌套循环示例线性增长。它需要一个小字符串并将其增长到 1000，然后在一次大型操作中将 1000 附加到较大的字符串上。随着大字符串变得非常大，创建新字符串所产生的副本需要很长时间。当您减少执行此操作的次数时（改为更频繁地调整较小字符串的大小），您会提高速度。当然，StringBuilder 在分配内存方面更加智能，因此速度更快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-11T23:59:01.050

将字符添加到字符串会产生两个后果：

*   如果字符仍有空间，则将其添加到末尾；（正如评论者所注意到的，c# 字符串不会发生这种情况，因为它们是不可变的）。
*   如果末尾没有空间，则为新字符串分配新的内存块，将旧字符串的内容复制到那里并添加字符。

要分析您的代码，添加 1000000 次单个字符会更简单。您的确切示例解释起来有点复杂，因为对于更高的 i，您一次添加更多字符。

然后在没有预留额外空间的情况下，第一个示例必须进行 1000000 次分配和复制，平均 0.5 * 1000000 个字符。第二个必须执行 1000 次分配和平均 0.5 * 1000000 个字符的副本，以及 1000000 次分配和 0.5 * 1000 个字符的副本。如果复制是线性的，复制和分配的大小是免费的，第一种情况需要 500 000 000 000 个时间单位，第二种情况需要 500 000 000 + 500 000 000 个时间单位。

# javascript - 在启用 UAC 的 Vista 上调试 Internet Explorer 中的 JavaScript 错误

> ID：282475
> 
> 赞同：2
> 
> 时间：2008-11-11T23:16:13.180
> 
> 标签：javascript, visual-studio, debugging, internet-explorer, windows-vista

考虑以下引发错误的简单 HTML 页面：

```
<html><head><script>
  throw new Error('oops');
  alert('should not reach here');
</script></head></html> 
```

我登录 Vista 的用户是管理员和调试器用户组的成员。

如果我在 Vista 上以管理员身份运行 Internet Explorer（右键单击 →**以管理员身份运行**）并加载页面，我会收到以下错误提示：

[![替代文字](https://i.stack.imgur.com/pIdR1.png)](https://i.stack.imgur.com/pIdR1.png)

单击“是”会显示以下提示，我可以从中成功打开 Visual Studio 2008 并调试问题：

[替代文字 http://img227.imageshack.us/img227/9751/debuguy3.png](http://img227.imageshack.us/img227/9751/debuguy3.png)

如果我改为正常启动 Internet Explorer 并加载页面，则不会显示错误提示（或任何有关此错误的指示）并且我无法跳入并调试问题。

我已尝试使该站点的页面由 Internet Explorer 中的受信任站点提供。这会导致页面显示错误提示，但单击“是”不会执行任何操作，浏览器只会挂起。

同样，如果 Internet Explorer 以管理员身份运行，我只能从 Visual Studio 成功附加到现有 Internet Explorer 进程以调试 JavaScript。

**在启用 UAC 的情况下运行 Internet Explorer 时，如何使用 Visual Studio 成功调试 JavaScript？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-23T15:06:17.540

你进过IE的高级选项吗？我认为您正在寻找的设置默认情况下对于普通用户是关闭的。

不过，我可能弄错了，我一直在使用 Vista 的工作不多。

编辑：让我改写一下：您是否仔细检查了受限帐户下的设置。有时为了“提供帮助”，我会看到 XP（或者它可能是安全软件）自动更改受限帐户中的某些设置的位置。

我意识到您的管理员帐户会启用这些功能，并且您肯定足够聪明，可以在管理员帐户上进行检查。我只是建议像许多其他人一样，您可能需要重新检查受限帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T14:02:18.793

Internet Explorer 8 带有一个内置的调试器，可以巧妙地避开这个问题。这应该可以减少我在早期版本的 Internet Explorer 中进行调试所需的时间，所以我可以忍受这种烦恼，直到这些版本像 Dodo 一样 :)

# css - 带边框图像的 Div

> ID：282489
> 
> 赞同：7
> 
> 时间：2008-11-11T23:20:56.757
> 
> 标签：css, html

设置一个带有一些边框图像的单个容器 div 的好方法是什么（在我的情况下仅在左侧、底部和右侧）？我把它放在页面顶部的中心，与其他所有内容重叠（就像那个 OSX 样式的向下滑动对话框）。

这是基本布局：

![替代文字](https://i.stack.imgur.com/HoGAj.jpg)

这是我到目前为止所得到的（我可以避免内容的静态宽度/高度吗？）：

**HTML：**

```
<div class="contentbox">
    <div class="contentbox-wrapper" style="width: 400px">
        <div class="contentbox-mid" style="height: 200px">
            <div class="contentbox-w"></div>
            <div class="contentbox-content">
                Content Box Test
            </div>
            <div class="contentbox-e"></div>
        </div>
        <div class="contentbox-bottom">
            <div class="contentbox-sw"></div>
            <div class="contentbox-s"></div>
            <div class="contentbox-se"></div>
        </div>
    </div>
</div> 
```

**CSS：**

```
.contentbox {
    width: 100%;
    position: fixed;
    z-index: 2;
}

.contentbox-wrapper {
    width: 300px;
    margin-left: auto;
    margin-right: auto;
}

.contentbox-mid {
    height: 100px;
}

.contentbox-w {
    width: 30px;
    height: 100%;
    background: transparent url("../../images/contentbox_w.png");
    float: left;
}

.contentbox-content {
    width: auto;
    height: 100%;
    background: #e8e8e8;
    float: left;
}

.contentbox-e {
    width: 30px;
    height: 100%;
    background: transparent url("../../images/contentbox_e.png");
    float: left;
}

.contentbox-bottom {
    width: 300px;
    height: 30px;
}

.contentbox-sw {
    width: 30px;
    height: 30px;
    background: transparent url("../../images/contentbox_sw.png");
    float: left;
}

.contentbox-s {
    height: 30px;
    background: transparent url("../../images/contentbox_s.png");
    margin-left: 30px;
    margin-right: 30px;
}

.contentbox-se {
    width: 30px;
    height: 30px;
    background: transparent url("../../images/contentbox_se.png");
    float: right;
    position: relative;
    bottom: 30px;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T23:32:40.370

虽然这些都不值得推荐（混合标记和设计），但最终决定权的往往不是集成商。但是，您仍应尽量保持一切清洁。

您的结构几乎是您可以使用的唯一一种结构，尽管如果您的宽度是静态的（300 像素？），我建议您将 div 背景作为一个更大的图像垂直重复。

然后，您的 div 中有一种页脚，您可以将两个底角和底部图片放在一个图像中。而不是在一个内有 5 个 div，你只有一个。请注意，在更大的环境中，这也意味着用户可以并行下载 2 个以上的图像（单个主机最多 4 个），从而使页面的整体下载速度更快。

如果您的宽度相对于父级或可以以任何方式更改，这显然不起作用。

* * *

编辑：碰巧你指定宽度是可变的，我不认为有一种更简洁的方式来实现 HTML 方式。

但是，如果您仍然想最大限度地提高图像的下载速度，请考虑使用精灵：东侧和西侧图像可以放在同一个更大的图像中：您唯一修改的是背景位置：

```
background-position: 32px 0px; /* this should move the background to the right */ 
```

优点是您只需要一张图片，为客户端下载它们需要更少的连接（更快），并且它占用了尽可能多的位置。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T13:43:47.827

通过使用“滑动门”技术，您可以用更少的标记来实现这一点。基本上，您只需确保每个角的图像足够大，以便在框处于您期望的最大尺寸时它们仍然会重叠一点。请参阅此示例以获取所有四个侧面都有图像的框：

```
<style>
div.box { float: left; }
div.tl { background: transparent url('topleft.gif') no-repeat top left; padding-top: 8px; padding-left: 8px; }
div.bl { background: transparent url('bottomleft.gif') no-repeat bottom left; height: 8px; padding-left: 8px; }
div.tr { background: transparent url('topright.gif') no-repeat top right; padding-right: 8px; }
div.br { background: transparent url('bottomright.gif') no-repeat bottom right; padding-right: 8px; }
</style>

<div class="box">
    <div class="tr">
        <div class="tl">
            Lorem ipsum dolor sit amet...
        </div>
    </div>    
    <div class="br">
        <div class="bl"></div>
    </div>
</div> 
```

对于只有三个侧面的图像的盒子，代码会更简单，因为您只需要两个 div 即可将图像附加到：

```
<style>
div.box { float: left; }
div.bl { background: transparent url('bottomleft.gif') no-repeat bottom left; padding-left: 8px; }
div.br { background: transparent url('bottomright.gif') no-repeat bottom right; padding-right: 8px; }
</style>

<div class="box">
    <div class="br">
        <div class="bl">
        Lorem ipsum dolor sit amet...
        </div>
    </div>
</div> 
```

这些示例将为您提供一个可拉伸的框，只要包含角和边框的图像大小足够，它就可以随心所欲地增长。另请注意，包含 div 的“填充”设置不应小于图像的宽度/角半径，但如果您愿意，它当然可以更大。快乐编码！

# javascript - 什么是 setTimeout(function(){//dostuff}, 0); 其实应该怎么做？

> ID：282499
> 
> 赞同：2
> 
> 时间：2008-11-11T23:25:46.077
> 
> 标签：javascript, performance

这种模式是否：

```
setTimeout(function(){
             // do stuff
}, 0); 
```

实际上从循环中将控制权返回给 UI？你应该什么时候使用它？它在所有浏览器中都同样有效吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T23:36:42.653

[http://blog.thinkature.com/index.php/2006/11/26/escaping-the-javascript-call-stack-with-settimeout/](http://blog.thinkature.com/index.php/2006/11/26/escaping-the-javascript-call-stack-with-settimeout/)

里面有一些很好的信息。基本上，你是对的，它几乎适用于所有浏览器。很酷的把戏。

您可能希望在帖子作者给出的示例中使用它，以及在执行代码之前需要将执行返回给调用函数的实例。Javascript 显然不是多线程的，但这很接近。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T23:45:19.157

它异步运行代码（虽然不是并行）。延迟通常更改为至少 10 毫秒，但这并不重要。

这个技巧的主要用途是避免调用堆栈深度的限制。如果你冒着达到极限的风险（走深树结构并计划在叶子上做很多工作），你可以使用超时来启动一个新的、空的调用堆栈的函数。

您还可以使用它来避免阻塞当前线程。例如，如果您不希望`<script>`元素延迟页面的加载：

```
<script>compute_last_pi_digit()</script> <!-- blocking -->

<script>setTimeout(compute_last_pi_digit,0)</script> <!-- non-blocking --> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T23:42:34.483

一旦线程上的任何其他未决指令完成（如果没有任何其他指令，则立即执行），它将异步调用该函数并将控制权返回给 UI。您应该在事件处理程序中使用它，您不想在事件仍在传播时运行代码[*](http://novemberborn.net/javascript/threading-quick-tip)。它适用于所有浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T00:16:39.953

可以把它想象成在过去设置一个中断向量。

它不会并行处理该代码，而是会在触发事件（在本例中为计时器完成）时跳转并执行它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T20:48:13.470

我发现当多个事件处理程序从同一个动作触发时，它对于避免竞争条件非常有用。

# eclipse - 什么是概要分析以及如何概要分析我的 Java 程序？

> ID：282502
> 
> 赞同：4
> 
> 时间：2008-11-11T23:26:29.883
> 
> 标签：eclipse, profiling

我听说过很多关于剖析的事情。这是怎么回事？据我了解，这是某种性能测量，但有人可以更清楚地阐述这一点，以便新手能够掌握这个想法。此外，我将 Eclipse IDE 用于我的 Java 程序。我可以使用 Eclipse IDE 分析我的程序吗？分析时要考虑哪些因素（我的意思是最佳实践）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-11T23:31:09.607

分析基本上显示了给定代码行的执行频率以及在其中花费了多少时间（与其他行相比）。这可以很容易地确定代码大部分时间花费的位置。

它还可以找到您的代码花费大量时间而不做任何事情的地方：这是[缓存未命中](http://en.wikipedia.org/wiki/Cache_miss#Cache_misses)的典型迹象，这是您应该激活的地方。

通常，程序会在一个地方花费大量时间（例如，90%）。不幸的是，没有分析是不可能找到这个地方的。猜测经常出错。因此，如果您在错误的位置进行优化，这将毫无帮助：如果在该行中花费的总时间只有 10%，那么您的代码只会加快 10%（充其量！）。但是，如果您成功地删除了占用 90% 时间的调用，那么您的程序将*快十倍*。

简而言之，这就是剖析。

Eclipse 提供了内置的分析功能，有人告诉我它们非常好，但由于我不了解它们，所以让其他人来回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T10:51:13.870

Konrad 是对的，但分析也涵盖了程序的其他方面，例如内存消耗。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T00:23:58.283

[YourKit](http://www.yourkit.com/)是一个优秀的 Java 分析器，可以很好地与 Eclipse 集成。它绝对物有所值，通常被认为是最好的 Java 分析器。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-11T23:31:51.603

根据我对使用 Eclipse 进行 Java 分析所做的少量研究，您可以使用[JProfiler](http://www.ej-technologies.com/products/jprofiler/java-profiler-IDE.html)。我从来没有真正比安装它并快速了解它。

# c# - PropertyGrid：从 CollectionEditor 获取 PropertyValueChanged 通知

> ID：282503
> 
> 赞同：1
> 
> 时间：2008-11-11T23:28:27.493
> 
> 标签：c#, winforms, .net-2.0

该`PropertyGrid`控件对于在运行时编辑对象非常有用。我使用它如下：

```
Form form = new Form();
form.Parent = this;
form.Text = "Editing MyMemberVariable";

PropertyGrid p = new PropertyGrid();
p.Parent = form;
p.Dock = DockStyle.Fill;
p.SelectedObject = _MyMemberVariable;
p.PropertyValueChanged += delegate(object s, PropertyValueChangedEventArgs args) 
{ 
    _MyMemberVariable.Invalidate(); 
};

form.Show(); 
```

如您所见，我正在使用`PropertyValueChanged`通知来确定何时更新`_MyMemberVariable`。然而，`_MyMemberVariable`是一个我没有写的类，它的一个成员是一个`Collection`类型。调用集合编辑器`PropertyGrid`来编辑此类型。但是，当集合编辑器关闭时，我没有收到`PropertyValueChanged`通知。

显然，我可以通过在对话框关闭后使用`ShowDialog()`和无效来解决这个问题。`_MyMemberVariable`

但是我想`PropertyValueChanged`在编辑集合时真正触发事件。有没有办法在不修改的情况下做到这一点`_MyMemberVariable`（我无权访问它的源代码）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-06T08:55:44.210

这不是很优雅，但它解决了我在有人更新/更改属性网格中的集合顺序时遇到的问题：

```
propertyGrid1.PropertyValueChanged += (o, args) => PropertyGridValueChanged();
propertyGrid1.LostFocus += (sender, args) => PropertyGridValueChanged(); 
```

`LostFocus`当他们单击其他内容时，我会收听该事件。对于我的特定用例，此解决方案就足够了。以为我会提到它，以防其他人发现这很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T02:55:01.927

我做了一些研究，甚至重现了这个问题，但是我找到的解决方案对你没有帮助，但我希望这些信息可以帮助另一个人帮助你。

开始

通过创建一个新的 windows 窗体项目、向窗体添加属性网格和列表框并将列表框设置为属性网格的选定对象，可以轻松重现该问题。

```
//designer code excluded
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        propertyGrid1.SelectedObject = listBox1;

        propertyGrid1.PropertyValueChanged += delegate(object s, PropertyValueChangedEventArgs args)
        {
            MessageBox.Show("Invalidate Me!");
        };

    }
} 
```

编辑列表框的项目集合时，该事件永远不会触发，原因是因为 Items 属性返回对集合的引用。由于将项目添加到集合中实际上并不会在属性似乎从未更改时更改引用，因此属性网格。

我尝试的解决方案是扩展属性网格，并更新比较两者的逻辑并检查集合中的数据是否已更改并调用事件。我试过了，但是 PropertyGrid 有一个内部类 PropertyGridView 给我带来了问题。

我希望这可以帮助其他人解决您的问题。

-杰里米

# algorithm - 为 FTP 和 HTTP 传输选择缓冲区大小

> ID：282504
> 
> 赞同：16
> 
> 时间：2008-11-11T23:28:57.583
> 
> 标签：algorithm, http, ftp, communication

在实现低级 HTTP 和 FTP 传输时，如何选择缓冲区的大小（我从套接字读取或写入套接字的字节数）以获得最大吞吐量？我的应用程序应该使用 HTTP 或 FTP 在 130 Kbps 到 3 Mbps 的连接上传输数据（我事先知道预期的速度）。有时是单向传输，有时是双向传输。我应该坚持一些平均缓冲区大小还是必须根据连接速度改变它？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-11T23:42:20.880

选择超过 8KB 的缓冲区大小。9000 通常是即使在最快的网络中使用的最大 MTU（最大传输单元）大小。

当您使用大于连接的 MTU 的缓冲区时，操作系统会根据需要将其分解为 MTU 大小的片段，因此您在 MTU 上使用的任何内容对网络性能几乎没有影响。

但是，使用大缓冲区可能会对性能产生其他影响，如果您正在传输文件，那么使用大缓冲区可能会提高读取性能，从而提高应用程序的速度。

所以，通常选择一个像 16KB 这样的好整数是个好主意。绝对不要低于 1500，因为这会对网络性能产生负面影响（导致操作系统有时会发送小数据包，从而降低网络性能）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-11T23:59:50.657

首先，进行一些测量。

然后，在进行可靠的性能测量后，更改缓冲区大小并绘制速度与缓冲区大小的关系图。

由于您事先知道连接速度，因此您应该能够获得不同实际缓冲区大小的实际速度的一些测量值。

操作系统、协议栈和网络过于复杂，无法从第一原理中得出答案。你需要在做任何事情之前进行测量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-27T06:31:16.943

您可以获得缓冲区大小：httpSocket.getReceiveBufferSize(); 我强烈建议在读取过程中将此缓冲区写入 RAM。例如：ByteArrayOutputStream 内存文件。并且只有在填充缓冲区后才将其写入磁盘。

# communication - 你如何在 Eclipse 声明式服务和视图（ContentProviders）之间进行通信

> ID：282509
> 
> 赞同：4
> 
> 时间：2008-11-11T23:31:07.643
> 
> 标签：communication, osgi, eclipse-pde, declarative-services

假设您有一个带有各种视图的 Eclipse 插件，这些视图应该显示来自将数据推送到视图的某些 OSGi 包的数据。我不是让每个视图都与 OSGi 包通信，而是有一个中间 Facade 类，它充当视图的黑板并管理视图与其他 OSGi 包之间的通信——嗯，这就是理论。

问题的出现是因为 ui 包（带有视图和外观）使用声明式服务与另一个包（称为 DataStore）进行通信。由于 Data Store 从另一个源接收异步数据更新，因此它需要将内容推送到 Facade（以及其他捆绑包，如果它们可用）。OSGi 实例化 Facade 以满足对 DataStore 的 DS 配置的基数要求，但视图由 Plugin 的 IApplication 实现实例化。即使 IApplication 和 Facade 是同一个类，我也会得到两个彼此不认识的独立实例。

如何启用这些组件（插件应用程序、视图等和 OSGi 实例化外观）之间的通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T23:33:25.313

一种解决方案是使用单例，并使用该单例注册 Application 和 Facade 中的一个或两个。

但是，我真的不喜欢在这个问题上抛出一个全局变量的想法。这似乎没有意义——这一定是一个常见问题，所以我假设有一个优雅的解决方案，我只是不知道如何搜索它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:41:46.810

您还可以使用[Spring DM](http://www.springsource.org/osgi)连接您的 OSGi 服务并使用[Martin Lippert 胶水插件](http://martinlippert.blogspot.com/2008/10/new-version-of-spring-extension-factory.html)将视图与 OSGi 服务（或 Spring bean）连接起来，它的好处是您不需要编写任何基于服务 API 或 spring API...

# ant - 将 Ant 参数列表复制到属性中

> ID：282522
> 
> 赞同：6
> 
> 时间：2008-11-11T23:34:12.427
> 
> 标签：ant, psexec

在 Ant 中有没有办法做这样的事情：

```
<arguments id="arg-list">
    <arg value="arg1" />
    <arg value="arg2" />
</arguments>

<property name="prop1" refid="arg-list" /> 
```

我正在尝试为 psexec 编写一个宏，并且正在寻找一种传入参数列表的好方法。

我知道你可以用类路径做类似的事情......

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T00:01:53.993

我不知道你的具体问题的答案。文档清楚地表明 refid '仅对 PATH 之类的结构或属性的引用产生合理的结果。

如果没有更多关于你想要做什么的信息，很难发表评论。冒着改变你的设计的风险，而不是回答你的问题，我建议：

1）您可以将参数列表作为一行传递给 exec：

```
<macrodef name="example">
  <attribute name="args"/>
  <sequential>
    <exec executable="example.exe">
      <arg value="somearg" />
      <arg line="@{args}"/>
    </exec>
  </sequential>
</macrodef>

<example args="somearg arg1 arg2"/> 
```

它将运行 example.exe：

```
example.exe arg1 arg2 
```

2）我将参数传递给调用外部应用程序的宏，如下所示：

```
<macrodef name="example">
  <element name="params" optional="yes" implicit="yes"/>
  <sequential>
    <exec taskname="eg" executable="example.exe">
      <arg value="somearg" />
      <params />  
    </exec>  
  </sequential>
</macrodef>

<example>
  <arg value="arg1"/>
  <arg value="arg2"/>
</example> 
```

这将运行 example.exe：

```
example.exe somearg arg1 arg2 
```

我希望我没有教祖母在这里吸鸡蛋。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-29T14:14:44.233

你知道 Ant-Contrib 任务 For 和 ForEach 吗： [http://ant-contrib.sourceforge.net/tasks/tasks/for.html](http://ant-contrib.sourceforge.net/tasks/tasks/for.html)

还有查找任务：`<find ... delimiter=""/> ... </find>`。这允许您创建一个列表。

# c++ - 注释掉评论

> ID：282526
> 
> 赞同：2
> 
> 时间：2008-11-11T23:36:06.587
> 
> 标签：c++, comments

我注意到，使用 Visual Studio 2003，我可以“注释掉”我的评论，使它们不再是评论。这需要一个例子：

如果我有：

```
/*
int commented_out = 0;
*/ 
```

我可以用 // 注释掉 /* 和 */ 并且 /* 和 */ 中的代码不再“注释掉”（文本变为非注释颜色**，**编译器再次将其视为代码）。像这样：

```
///*
int commented_out = 0;
//*/ 
```

我发现这对于 msvc 2003 是正确的，这是正常的 C++ 行为还是只是与此编译器一起工作的侥幸？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-11T23:47:37.047

是的，这是完全正常的行为。C++ 标准规定，`/*`只有当它本身没有被注释掉时，a 才是注释块的开始。我经常使用您在上面编写的内容通过添加/删除一个字符来注释或取消注释代码块。在两个代码块之间切换的一个很好的小技巧，其中一个总是被注释掉的是：

```
//*
code block 1 (uncommented)
/*/
code block 2 (commented)
//*/
```

现在，从头开始删除一个斜杠，它变成

```
/*
code block 1 (commented)
/*/
code block 2 (uncommented)
//*/
```

不是在生产代码中使用的东西，但对于快速调试更改非常有用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-11T23:40:13.023

它应该在任何编译器中工作，因为它`//`首先在输入流中遇到。

我倾向于使用`#if 0`这种东西并将其更改`#if 1`为取消注释，如下所示：

```
#if 0
    int commented_out = 0;
#endif 
```

然后我根本不必担心评论标记。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T00:21:32.580

实际上，这几乎适用于任何具有 C 样式块注释的语言。

```
/*
int foo = 0;
/*/
int foo = 1;
//*/ 
```

甚至是 XML 注释

```
<!--->
a
<!-->
b
<!----> 
```

不幸的是，我在 lua 的光剑评论上画了一个空白

```
--[[---------
---------]]-- 
```

# c# - 在 C# 中导出到 Word 文档

> ID：282531
> 
> 赞同：4
> 
> 时间：2008-11-11T23:39:43.053
> 
> 标签：c#, ms-word, export

我正在寻找一个允许创建 Word 文档的 .NET 库。我需要将基于 HTML 的内容导出到 Word 文档（97-2003 格式，而不是 docx）。

我知道有 Microsoft Office 自动化库和 Office 互操作，但据我所知，它们要求您实际安装了 office，并且它们通过打开 word 本身来进行转换。但我不想要求安装办公室才能转换为工作。

编辑：如果可能的话，转换为 RTF 甚至可以工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T13:33:49.750

*如果我以某种方式将 CSS 转换为嵌入 HTML，它会起作用吗？*

是的。正如我所提到的，我使用内部样式表。

文档示例：

```
<html>
<head>
<STYLE type="text/css">
    h1 {text-align:center; font-size:12.0pt; font-family:Arial; font-weight:bold;}

    p {margin:0in; margin-bottom:0pt; font-size: 10.0pt;font-family: Arial;}
    p.Address {text-align:center;font-family:Times; margin-bottom: 10px;}
</style></head>
<body>
<p class="Address">The Street</p>
<h1>Head</h1> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T13:38:02.817

我使用 Aspose 处理 Word，让一切变得轻而易举：[http ://www.aspose.com/](http://www.aspose.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-11T23:50:19.350

我发现输出到 HTML 但称为 .doc 的文档将在 Word 中以正确格式打开。我用 Word 2000 和一个带有内部样式表的文件进行了测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T02:48:50.973

从 ASP.NET 使用 Word 自动化不是一个好主意（请参阅 MSKB - [http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2](http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2)）

如果您不使用 WinForms，恕我直言，您最好的选择是生成 RTF，ms word 会很高兴地打开它。（请参阅已引用文章中的链接）。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T23:47:33.007

由于文档格式规范未开放，并且互操作程序集是 Microsoft 解决方案，我担心它们是您的主要（甚至唯一）选项。

它们确实需要安装 office，并且它们会打开 Word（尽管显示窗口是可选的）。

我认为 Word 可以打开 HTML 文档；这是你的选择吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T13:24:55.900

我尝试直接在 word 中打开 html，这在技术上是有效的，除了一件事......我的 html 文档*还*包含 CSS，当在 Word 中打开时，它完全忽略了 CSS，所以我不再有任何格式。我意识到我不会从 CSS 中获取所有内容，但我至少希望仍然拥有指定的字体、字体大小等......有什么方法可以让它读取 CSS 吗？如果我以某种方式将 CSS 转换为嵌入 HTML，它会起作用吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T19:12:15.250

有一个名为 JODConverter 的工具可以连接到开放式办公室以公开它的文件格式转换器，还有作为 web 应用程序（位于 tomcat 中）发布的版本和命令行工具。我一直在使用 html 并成功转换为 .doc 和 pdf，它在一个相当大的项目中，还没有上线，但我想我会使用它。 [http://sourceforge.net/projects/jodconverter/](http://sourceforge.net/projects/jodconverter/)

# java - 用于无名 JButton 的 Java actionListener？

> ID：282539
> 
> 赞同：0
> 
> 时间：2008-11-11T23:42:32.753
> 
> 标签：java, swing, jbutton, actionlistener

我想知道是否有一种方法可以为没有名称的 Jbutton 实现动作侦听器。例如，我有以下 for 循环，它为字母表的每个字母创建一个按钮。

```
for (int i = 65; i < 91; i++){
     alphabetPanel.add(new JButton("<html><center>" + (char)i));
} 
```

有没有一种方法可以为每个按钮添加一个动作侦听器，而无需摆脱我的 for 循环并对每个 JButton 进行硬编码，然后为每个按钮创建一个动作侦听器？

提前致谢，

托梅克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T23:51:11.610

你的问题有点含糊。修改循环以在循环内添加侦听器将是微不足道的：

```
ActionListener listener = something;

for (int i = 65; i < 91; i++){
     JButton button = new JButton("<html><center>" + (char)i);
     button.addActionListener( listener );
     alphabetPanel.add(button);
} 
```

如果您不能修改循环，您可以遍历面板的所有子级，并将侦听器添加到任何作为 jbutton 的子级。

还有你为什么要使用 html 来使文本居中？这不是矫枉过正吗？jbutton不是已经居中文本了吗？
你也可以使用 setHorizo​​ntalAlignement(SwingConstants.CENTER) 来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T23:54:30.777

这样做有什么问题？

```
for (int i = 65; i < 91; i++){
     JButton button = new JButton("<html><center>" + (char)i));
     button.addActionListener( new ButtonListener());
     alphabetPanel.add(button);
} 
```

...

```
class ButtonListener implements ActionListener {
     ButtonListener() {
     }
     public void actionPerformed(ActionEvent e) {
         //TODO:
     }
} 
```

此外，如果按钮的文本不能识别按钮，您可以使用字母来设置按钮的名称。

```
button.setName((char)i)); // or button.setName(i); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T14:27:38.673

通过命名，您似乎是指将按钮实例存储在即时方法的局部变量中。试图避免这种情况可能会使您的代码更难阅读。但要回答你的问题：

最明显的方法是使用旧的但最近流行的双括号成语。

```
alphabetPanel.add(new JButton("<html><center>" + (char)i) {{
    addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent event) {
            ...
        }
    });
}}); 
```

请注意，在这种情况下，因为 i 不是 final ，所以它不能从匿名内部类中使用。将其分配给另一个（最终）变量或重新构造循环。

另一条路线是通过一个动作。（通常我建议避免使用 Actions，因为它们只是一个穷人的 Hashtable。ButtonModel 是“好”的。）

```
alphabetPanel.add(new JButton(new AbstractAction("<html><center>" + (char)i) {
    public void actionPerformed(ActionEvent event) {
        ...
    }
})); 
```

然后当然有应用程序特定的库方式：

```
Form alphabetForm = new Form(alphabetPanel);
for (char c='A'; c <= 'Z'; ++c) {
    alphabetForm.button("<html><center>" + c, new ActionListener() {
        public void actionPerformed(ActionEvent event) {
            ...
        }
    });
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T02:59:39.000

可以将 ActionListener 添加到匿名组件，如下所示：

```
new JButton().addActionListener(new ActionListener(){
            @Override
            public void actionPerformed(ActionEvent arg0) {
                // TODO your action             
            }           
        }); 
```

但是，在您尝试将匿名 JButton 添加到面板的情况下，此方法将不起作用，因为将采用 addActionListener 方法的返回类型（为 void）而不是 JButton 的构造函数，如下所示：

```
for (int i = 65; i < 91; i++){
             alphabetPanel.add(new JButton("<html><center>" + (char)i).addActionListener(new ActionListener(){
                    @Override
                    public void actionPerformed(ActionEvent arg0) {
                        // TODO your action             
                    }           
                }));
        } 
```

上面的代码抱怨 panel.add() 方法的参数无效。

因此，在您的情况下，您必须创建 JButton 的命名实例。

希望这可以澄清。

最好的问候， 苏雷什

# .htaccess - .htaccess 中的重定向规则将我带到错误的地方

> ID：282541
> 
> 赞同：3
> 
> 时间：2008-11-11T23:43:31.813
> 
> 标签：.htaccess, redirect, http-status-code-301

我在使用 .htaccess 文件重定向 url 时遇到问题。这是我的 .htaccess 文件的样子：

```
Redirect 301 /file-name/example.php http://www.mysite.com/file-name/example-001.php
Redirect 301 /section-name/example.php http://www.my-site.com/section-name/example-002.php

RewriteEngine on
RewriteCond %{HTTP_HOST} !^www.mysite.com$ [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [L,R=301]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)/(.*)$ hqtemplates/articles.php?file_name=$2 [L]
php_value session.use_only_cookies 1
php_value session.use_trans_sid 0 
```

现在的问题是，当我转到 page: 时`www.my-site.com/file-name/example.php`，不是将我重定向到`www.my-site.com/file-name/example-001.php`它，而是将我重定向到 `www.my-site.com/file-name/example.php?file_name=example-001.php`.

**出于某种原因，它会将“？file_name=example-001.php”添加到 url**。有谁知道为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T01:00:31.533

问题是将`mod_alias`重定向规则与`mod_rewrite`. 解决方案是坚持一个。这是纯 mod_rewrite only 方法的解决方案（我只包含了与问题相关的部分）：

```
RewriteEngine on
# emulate specific mod_alias Redirect rules
#
# Flags explanation:
#   [L] = last rule, stop processing further rules
#   [R=301] = 301 Redirect
#
RewriteRule ^file-name/example.php$ http://www.mysite.com/file-name/example-001.php [L,R=301]
RewriteRule ^section-name/example.php$ http://www.my-site.com/section-name/example-002.php [L,R=301]

# handle other rewrite requests
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)/(.*)$ hqtemplates/articles.php?file_name=$2 [L] 
```

至于您的 .htaccess 中发生了什么，这是重写日志：

```
(2) rewrite 'file-name/example.php' -> \
        'hqtemplates/articles.php?file_name=example.php'
(2) strip document_root prefix: /home/test/hqtemplates/articles.php -> \
         /hqtemplates/articles.php
(1) internal redirect with /hqtemplates/articles.php [INTERNAL REDIRECT]
(1) pass through /home/test/Sites/file-name/example-001.php 
```

这表明：

1.  应用`mod_rewrite`“重写规则 ^(.+)/(.*)$ hqtemplates...”
2.  `file-name/example.php`现在相当于`hqtemplates/articles.php?file_name=example.php`
3.  应用`mod_alias`“重定向 301...”
4.  显示决赛`file-name/example-001.php?file_name=example.php`

# compact-framework - .Net Compact Framework 3.5 HTTP POST

> ID：282545
> 
> 赞同：2
> 
> 时间：2008-11-11T23:45:45.507
> 
> 标签：compact-framework, http-post

我正在使用 .NET Compact Framework v3.5 编写我的第一个 Windows CE 应用程序。
我需要该应用程序能够对 URL 进行 HTTP POST。
.NET CF 似乎没有 System.Web。
因此，我可以使用一些关于如何使用 .Net CF 完成和 HTTP 帖子的指南。谢谢，格雷格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T01:39:05.887

这是否满足您的需求？

您需要导入
System.IO
System.Net
System.Net.HttpWebRequest

```
Try
   Dim Request As HttpWebRequest = CType(WebRequest.Create("<The server>"), HttpWebRequest)

   Request.AllowWriteStreamBuffering = True
   Request.KeepAlive = False
   Request.Credentials = CredentialCache.DefaultCredentials
   Request.ContentType = "text/html"
   Request.Method = "POST"

   'If required
   'Dim proxyURI As New Uri("193.129.241.46", UriKind.Absolute)
   'Dim webProxy As New WebProxy
   'webProxy.Address = proxyURI
   'webProxy.Credentials = New NetworkCredential("", "")
   'Request.Proxy = webProxy

   Dim requestStream As Stream = Request.GetRequestStream
   Dim Writer As New IO.BinaryWriter(requestStream)
   Writer.Close()

   Dim Reader As New BinaryReader(Request.GetResponse.GetResponseStream)
   Reader.Close()
Catch ex As Exception
   Throw ex
End Try 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T01:34:12.557

HTTPWebRequest[类](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest_members.aspx)存在于 CF 中，可用于发布和抓取响应。快速搜索发现了几篇关于使用它们进行 POST 的有前途的桌面文章，其中许多可能可以移植。

# visual-studio-2005 - 如何将“现有解决方案文件夹递归”添加到我的 VS2005 解决方案中

> ID：282552
> 
> 赞同：4
> 
> 时间：2008-11-11T23:47:33.380
> 
> 标签：visual-studio-2005

我尝试从资源管理器拖放，但没有以下错误：

> “文件夹不能作为解决方案项目删除或粘贴。请选择单个文档。”

我知道我们可以手动创建每个文件夹/子文件夹并添加每个文件，但是在 Visual Studio 2005 上有什么快速的方法吗？

**更新：** 感谢您的回复，但我不希望将文件夹添加到任何项目下，它应该像任何其他项目一样在我的解决方案中显示为单独的节点。在这种情况下，显示所有文件不起作用，因为解决方案本身没有任何文件夹，只有当我们选择它工作的任何项目时。

我知道我们可以手动创建每个文件夹/子文件夹并添加每个文件，但任何快捷方式，因为有几百个文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T23:50:32.720

*   将有问题的文件夹复制到项目的本地路径中。
*   单击 VS 解决方案工具栏中的“显示所有文件”按钮
*   单击刷新
*   您应该将此文件夹视为白色图标。
*   右键单击该文件夹，然后选择“包含在项目中”。

# c++ - C++ 打开文件并将数据输入到类对象

> ID：282570
> 
> 赞同：0
> 
> 时间：2008-11-11T23:56:56.217
> 
> 标签：c++, class, input, ifstream

简单的问题，希望是一种简单的方法，只是想验证我是否以正确/有效的方式进行操作。

我有一个类 T 对象，它通常被放入在我的 main() 函数中创建的向量中。它可以是任何类型的数据、字符串、int、float.. 等。我正在从一个文件中读取......它是从用户输入并传递给函数的。这是我的基本阅读功能：

```
template <class T, class U>
void get_list(vector<T>& v, const char *inputFile, U)
{
ifstream myFile;
T object;

myFile.open("inputFile")
while(!myFile.eof())
   {
   myFile >> object;
   insert(v, object, U)
   }
} 
```

insert 只是另一个函数，它将通过并将数据插入到我的数据结构中。我只是想确保这是传递该数据的最佳方式，如果它甚至可以工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T00:11:10.883

您犯了在条件下针对 eof 进行测试的老错误。直到您尝试读取文件末尾之后才设置 EOF。所以这个方法会在你不想要的向量中插入一个额外的值。

```
template <class T, class U>
void get_list(vector<T>& v, const char *inputFile, U)
{
    ifstream myFile("inputFile");  // Why hard code this?
                                   // When you pass inputFile as a parameter? 
    T object;

    while(myFile >> object)  // Get the object here.
                             // If it fails because of eof() or other
                             // It will not get inserted.
    {
         insert(v, object, U)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T23:59:10.800

看起来它可以正常工作，我想说这可能是最好的方法。但是你为什么要在这里问而不是自己测试呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T00:09:23.353

不要`.eof()`在`while`-condition 的流上使用。*只有在*尝试读取文件末尾之后，该条件才会评估为真。更好的方法是

```
while(myFile >> object)
    insert(v, object, U); 
```

你的使用`U`是有缺陷的。我不知道它是用来做什么的。一次它被用作一种类型，但另一次你将它`insert`作为一个值传递给函数。

# asp.net-mvc - ASP.NET MVC 一种路线，两种不同的看法

> ID：282571
> 
> 赞同：7
> 
> 时间：2008-11-11T23:57:37.277
> 
> 标签：asp.net-mvc, view

我正在尝试根据用户是否登录为具有两个不同视图的 MVC 站点设计主页。

因此，图像默认（未登录）视图显示一般的、非特定的信息。如果我已登录，则视图主要显示个人内容。

处理此问题的最佳做法是什么？别忘了，我们还需要对此进行单元测试。

多谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-12T00:02:45.253

这应该是从控制器返回适当视图的简单案例。

```
public ActionResult Index()

    If (User.IsLoggedOn)
    {
        // Do user-specific controller stuff here...

        return View("LoggedOnIndex");
    }
    else
    {
        // Do anon controller stuff here...

        return View("AnonymousIndex");
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T20:16:41.627

我不确定你能不能做到

`User.IsloggedOn`

过去，但现在我不得不说

`User.Identity.IsAuthenticated`

如果您使用的是内置 Web 表单身份验证。

# asp.net - 如何在 ASP.NET 中实现直读文件缓存？

> ID：282575
> 
> 赞同：2
> 
> 时间：2008-11-11T23:59:17.337
> 
> 标签：asp.net, caching

我有一个系统，它位于 Web 服务器上，并动态生成文件以响应 HTTP 请求。这目前是作为 HTTPHandler 实现的。

生成文件后，它们不会经常更改，因此我想实现缓存。

理想情况下，我希望网络服务器查看缓存文件夹并直接从那里提供文件，而无需执行**任何**代码（网络服务器毕竟设计为擅长提供文件，所以如果我可以避开那样的方式更好！）。

然后我想做的是挂钩服务器的“找不到文件”事件作为创建文件的机会，在下次请求时将副本放入缓存文件夹中，并将其返回给用户而不是“找不到文件”消息。

这样，对文件的重复请求将很快减轻，并且我的代码只会在“异常”情况下被调用。

所以 - 问题是 - 我如何以尽可能不显眼和轻量级的方式将我的代码连接到“找不到文件”事件中？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T00:27:56.983

这实际上非常简单，只需将 IIS 中的 404 错误页面指向您的 HTTPHandler。

Request.RawUrl 看起来像：

```
http://yourdomain.com/yourhandler.ashx;originally/requested/url 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T00:24:29.533

如何使用 customError 配置重定向到您的 HttpHandler 。

```
<customErrors mode="On">
   <error statusCode="404" redirect="FileGeneratorHandler.ashx" />
</customErrors> 
```

唯一的问题是引用页面是否可供处理程序使用。

# ruby - Merb 中的管理控制器

> ID：282576
> 
> 赞同：0
> 
> 时间：2008-11-11T23:59:25.057
> 
> 标签：ruby, merb

如何在 Merb 中使用命名空间控制器，例如为站点创建一个管理部分？在 Rails 中会使用 Admin::CategoriesController，这在 Merb 中是否类似，或者这是另一种推荐的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T06:49:26.820

命名空间方法似乎可以做到这一点。

这被放置在路由文件（router.rb）中：

```
namespace :admin do
  resources :categories
end 
```

这会生成如下路线：

```
edit_admin_category - /admin/categories/:id/edit(.:format)
delete_admin_category - /admin/categories/:id/delete(.:format)
admin_categories - /admin/categories(/index)(.:format)
new_admin_category - /admin/categories/new(.:format)
admin_category - /admin/categories/:id(.:format)

```

然后我把我的控制器放在一个这样的模块中：

```
module Admin
  class Categories < Application
    def index
      ...
    end

    .
    .
    .
  end
end 
```

我不确定这是否是推荐的方式，对此的任何建议都会很棒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T20:00:30.770

上面的答案是正确的，但是对于它的价值，我很难在我的观点中尝试使用带有 link_to 的新路线。

我最终得到了这个工作：

```
<%= link_to("Categories Admin", resource(:admin, :categories) %> 
```

# image - 图像 DPI 解释

> ID：282580
> 
> 赞同：1
> 
> 时间：2008-11-12T00:00:54.540
> 
> 标签：image, printing, bitmap, resolution, dpi

尝试编写 DPI 的定义导致我：

DPI（点）、PPI（点）、LPI（线）都是指同一个概念，以下简称 DPI。

DPI 是依赖于设备的测量。它说，“这是这个设备的分辨率。”

基于矢量的文件不依赖于任何一个 DPI（它们会扩展和收缩以符合特定的分辨率）。

当该基于矢量的文件被渲染为基于“位图”的格式 - （bmp，png，tiff，jpg）等......该“位图”文件以特定DPI创建以在“条带”上打印（或显示）或以特定 DPI 输出的基于“扫描线”的设备。

现在，有些人会争辩说，基于“位图”的文件中不存在 DPI。

我正在寻找 DPI 的定义，以及如何或为什么认为它不存在于位图图像中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T00:19:36.810

因为位图图像没有物理尺寸，所以它没有 dpi。如果你有一个物理大小被建模的文件格式，你可以有一个（建模的）dpi。

您可能想要区分可寻址性和覆盖区域。如果一个点不是方形而是圆形，则覆盖面积更大。

顺便说一句，LPI 是一个不同但相关的概念。用于 600 DPI 打印机的 100 LPI 屏幕意味着有 6*6 像素的正方形可用于创建 37 种不同级别的灰度（旋转 0 度）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T00:11:07.547

某些文件格式将包含 DPI 值，但在大多数情况下可以忽略它。您关心的是像素大小与您正在显示或打印的大小的比率。较低的级别通常会导致图像更模糊。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T00:12:17.373

位图图像将指定每个点，并将 DPI 和渲染留给系统的其他部分。我可以用投影仪在墙上画一个十六乘十六的位图，并声称我每英寸得到一个点。更高级的文件格式将指定如何呈现它们，因为它们关心它们的外观。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T00:11:02.210

如果位图图像指定了 DPI，如果我们也知道显示器/打印机的 DPI，我们可以将其打印/显示为“预期”。

我认为人们应该少考虑 DPI，多考虑以厘米/英寸为单位的预期尺寸。DPI 的一个好处是它可以让我们衡量输出看起来有多好。

# math - 在不存储所有数据点的情况下计算平均置信区间

> ID：282600
> 
> 赞同：6
> 
> 时间：2008-11-12T00:11:53.100
> 
> 标签：math, language-agnostic, statistics, montecarlo

对于大`n`（请参阅下文了解如何确定足够大），通过中心极限定理将样本均值的分布视为正态（高斯）是安全的，但我想要一个为任何`n`. 这样做的方法是使用具有`n-1`自由度的学生 T 分布。

所以问题是，给定您一次收集或遇到一个数据点的流，您如何计算`c`（例如，`c=.95`）数据点均值的置信区间（不存储所有先前遇到的数据）？

另一种问这个问题的方法是：如何在不存储整个流的情况下跟踪数据流的第一时刻和第二时刻？

奖励问题：您可以在不存储整个流的情况下跟踪更高的时刻吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T00:37:26.870

这是一篇关于[如何在单次通过中计算均值和标准差](http://www.johndcook.com/standard_deviation.html)的文章，而不存储任何数据。一旦你有了这两个统计数据，你就可以估计一个置信区间。`[mean - 1.96*stdev, mean + 1.96*stdev]`假设您的数据和大量数据点呈正态分布，则 95% 的置信区间为 。

对于较少数量的数据点，您的置信区间将取决于您的样本量和置信水平`[mean - c(n)*stdev, mean + c(n)*stdev]`。`c(n)`对于 95% 的置信水平，这里是您的值`c(n)`for `n`= 2, 3, 4, ..., 30

> 12.70620，4.302653，3.182446，2.776445，2.570582，2.446912，2.364624，2.306004，2.262157，2.228139，2.200985，2.178813，2.160369，2.144787，2.131450，2.119905，2.109816，2.100922，2.093024，2.085963，2.079614，2.073873，2.068658，2.063899，2.059539， 2.055529、2.051831、2.048407、2.045230

这些数字是具有`g(0.025, n-1)`n`g`个自由度的 t 分布的逆 CDF。如果您想要 99% 的置信区间，请将 0.025 替换为 0.005。通常，对于 的置信水平`1-alpha`，使用`alpha/2`。

这是生成上述常量的[R命令。](http://www.r-project.org/)

```
n = seq(2, 30); qt(0.025, n-1) 
```

这是一篇[博客文章](http://www.johndcook.com/blog/2008/11/12/normal-approximation-for-student-t-distribution-isnt-good-enough/)，解释了为什么上面的数字不像您预期​​的那样接近 1.96。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T06:25:51.610

[非常感谢约翰·D·库克（John D Cook）在整理这个答案时学到了很多东西！]

首先，这是不使用平方和的原因：http: [//www.johndcook.com/blog/2008/09/26/](http://www.johndcook.com/blog/2008/09/26/)

你应该怎么做：

跟踪计数 (n)、平均值 (u) 和数量 (s)，从中可以确定样本方差和标准误差。（改编自[http://www.johndcook.com/standard_deviation.html](http://www.johndcook.com/standard_deviation.html)。）

初始化`n = u = s = 0`.

对于每个新数据点，`x`：

```
u0 = u;
n ++;
u += (x - u) / n;
s += (x - u0) * (x - u); 
```

则样本方差为`s/(n-1)`，样本均值的方差为 ，样本均值`s/(n-1)/n`的标准误为`SE = sqrt(s/(n-1)/n)`。

仍然需要计算 Student-t`c`置信区间（`c`在 (0,1) 中）：

```
u [plus or minus] SE*g((1-c)/2, n-1) 
```

其中`g`是均值为 0 方差为 1 的 Student-t 分布的逆 cdf（又名分位数），取概率和自由度（比数据点数少一）：

```
g(p,df) = sign(2*p-1)*sqrt(df)*sqrt(1/irib(1, -abs(2*p-1), df/2, 1/2) - 1) 
```

其中`irib`是逆正则化不完全 beta 函数：

```
irib(s0,s1,a,b) = z such that rib(s0,z,a,b) = s1 
```

哪里`rib`是正则化不完全 beta 函数：

```
rib(x0,x1,a,b) = B(x0,x1,a,b) / B(a,b) 
```

其中`B(a,b)`是 Euler beta 函数，`B(x0,x1,a,b)`是不完全 beta 函数：

```
B(a,b) = Gamma(a)*Gamma(b)/Gamma(a+b) = integral_0^1 t^(a-1)*(1-t)^(b-1) dt
B(x0,x1,a,b) = integral_x0^x1 t^(a-1)*(1-t)^(b-1) dt 
```

典型的数值/统计库将具有 beta 函数的实现（或直接的 Student-t 分布的逆 cdf）。对于 C，事实上的标准是 Gnu Scientific Library (GSL)。通常给出 beta 函数的 3 参数版本；对 4 个论点的概括如下：

```
B(x0,x1,a,b) = B(x1,a,b) - B(x0,a,b)
rib(x0,x1,a,b) = rib(x1,a,b) - rib(x0,a,b) 
```

最后，这是 Mathematica 中的一个实现：

```
(* Take current {n,u,s} and new data point; return new {n,u,s}. *)
update[{n_,u_,s_}, x_] := {n+1, u+(x-u)/(n+1), s+(x-u)(x-(u+(x-u)/(n+1)))}

Needs["HypothesisTesting`"];
g[p_, df_] := InverseCDF[StudentTDistribution[df], p]

(* Mean CI given n,u,s and confidence level c. *)
mci[n_,u_,s_, c_:.95] := With[{d = Sqrt[s/(n-1)/n]*g[(1-c)/2, n-1]}, 
  {u+d, u-d}] 
```

相比于

```
StudentTCI[u, SE, n-1, ConfidenceLevel->c] 
```

或者，当整个数据点列表可用时，

```
MeanCI[list, ConfidenceLevel->c] 
```

最后，如果您不想为 beta 函数之类的东西加载数学库，您可以为`-g((1-c)/2, n-1)`. 这里是`c=.95`和`n=2..100`：

12.706204736174698，4.302652729749464，3.182446305283708，2.7764451051977934，2.570581835636314，2.4469118511449666，2.3646242515927853，2.306004135204168，2.262157162798205，2.2281388519862735，2.2009851600916384，2.178812829667226，2.1603686564627917，2.1447866879178012，2.131449545559774，2.1199052992212533，2.1098155778333156，2.100922040241039，2.093024054408307，2.0859634472658626，2.0796138447276835，2.073873067904019，2.0686576104190477，2.0638985616280254，2.0595385527532963， 2.05552943864287，2.051830516480281，2.048407141795243，2.0452296421327034，2.042272456301236，2.039513446396408，2.0369333434600976，2.0345152974493392，2.032244509317719，2.030107928250338，2.0280940009804462，2.0261924630291066，2.024394163911966，2.022690920036762，2.0210753903062715，2.0195409704413745，2.018081702818439，2.016692199227822，2.0153675744437627，2.0141033888808457，2.0128955989194246，2.011740513729764，2.0106347576242314，2.0095752371292335，2.0085591121007527，2.007583770315835，2.0066468050616857，2.005745995317864，2.0048792881880577，2.004044783289136，2.0032407188478696，2.002465459291016，2.001717484145232，2.000995378088259，2.0002978220142578，1.9996235849949402，1.998971517033376，1.9983405425207483，1.997729654317692，1.9971379083920013，1.9965644189523084，1.996008354025304，1.9954689314298386，1.994945415107228， 1.9944371117711894，1.9939433678456229，1.993463566661884，1.9929971258898527，1.9925434951809258，1.992102154002232，1.9916726096446793，1.9912543953883763，1.9908470688116922，1.9904502102301198，1.990063421254452，1.989686323456895，1.9893185571365664，1.9889597801751728，1.9886096669757192，1.9882679074772156，1.9879342062390228，1.9876082815890748，1。9872898648311672，1.9869786995062702，1.986674540703777，1.986377154418625，1.9860863169510985，1.9858018143458114，1.9855234418666061，1.9852510035054973，1.9849843115224508，1.9847231860139618，1.98446745450849，1.9842169515863888

渐近地逼近 的正态 (0,1) 分布的逆 CDF `c=.95`，即：

```
-sqrt(2)*InverseErf(-c) = 1.959963984540054235524594430520551527955550... 
```

有关反函数，请参见[http://mathworld.wolfram.com/InverseErf.html 。](http://mathworld.wolfram.com/InverseErf.html)`erf()`请注意，`g((1-.95)/2,n-1)`在至少有 474 个数据点之前，它不会四舍五入到 1.96。当有 29 个数据点时，它四舍五入为 2.0。

根据经验，您应该使用 Student-t 而不是正常的近似值，`n`最多至少 300，而不是按照传统观点的 30。参照。[http://www.johndcook.com/blog/2008/11/12/](http://www.johndcook.com/blog/2008/11/12/)。

另见康奈尔大学李平的“改进压缩计数”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T00:40:02.120

```
 sigma = sqrt( (q - (s*s/n)) / (n-1) )
   delta = t(1-c/2,n-1) * sigma / sqrt(n) 
```

其中 t(x, n-1) 是具有 n-1 个自由度的 t 分布。如果您使用的是[gsl](http://www.gnu.org/software/gsl/manual/html_node/The-t_002ddistribution.html)

```
t = gsl_cdf_tdist_Qinv (c/2.0, n-1) 
```

除了平方和之外，无需存储任何数据。现在，您可能会遇到数值问题，因为平方和可能非常大。您可以使用 s 的替代定义

```
sigma = sqrt(sum(( x_i - s/n )^2 / (n-1))) 
```

并通过两次。我鼓励您考虑使用[gnu 科学库](http://www.gnu.org/software/gsl/manual/html_node/Mean-and-standard-deviation-and-variance.html)或[R](http://www.r-project.org/)之类的包来帮助您避免数值问题。此外，请注意使用中心极限定理。滥用它部分归咎于目前正在发生的整个金融危机。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T00:46:04.090

您不想累积平方和。得到的统计数据在数字上是不准确的——你最终会减去两个相似的大数字。你想保持方差，或 (n-1)*variance，或类似的东西。

直接的方法是增量地累积数据点。该公式并不复杂或难以推导（参见 John D. Cook 的链接）。

一种更准确的方法是成对递归地组合数据点。您可以使用 n 中的内存对数来执行此操作：寄存器 k 保存 2^k 个旧数据点的统计信息，这些数据与 2^k 个较新点的统计信息相结合以获得 2^(k+1) 个点的统计信息...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-05T18:00:18.993

我认为你不必太担心 的大小，`n`因为它很快就会超过 30 的数量，这里的分布可以认为是正常的。如果您不想存储来自先前样本的任何数据点，我认为使用贝叶斯递归对总体均值和方差参数进行后验推断（假设是正常模型）是最好的方法。您可以查看[此文档](http://nitro.biosci.arizona.edu/courses/EEB596/handouts/Bayesian.pdf)以了解均值和方差的联合推断，特别是方程 38a、38b 和 38c。

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2008-11-12T00:37:22.877

我想你可以。我必须在谷歌/维基百科上找到它，所以我会把它作为练习留给读者。

# eclipse - Cusp Eclipse 插件中的“Package LISP-UNIT 未加载”错误

> ID：282601
> 
> 赞同：1
> 
> 时间：2008-11-12T00:12:10.947
> 
> 标签：eclipse, eclipse-plugin, common-lisp, cusp

我在使用 Cusp 插件的 Eclipse 中收到以下错误：

> 包 LISP-UNIT 未加载

我如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T00:39:07.037

这是一个错误吗？我在 google 群组中找到了以下内容（如果您 google 查找该消息，则为第一项）：

> 首选项中有一个选项，允许打开`lisp-unit`或关闭使用。

lisp-unit 似乎是一个单元测试包。

# c++ - 传递参数的 C++ 编译器优化

> ID：282603
> 
> 赞同：9
> 
> 时间：2008-11-12T00:13:55.637
> 
> 标签：c++, optimization, compiler-construction, arguments

我正在使用可以在运行时启用/禁用报告的日志记录模块。电话通常是这样的：

```
WARN(
     "Danger Will Robinson! There are "
     + boost::lexical_cast<string>(minutes)
     + " minutes of oxygen left!"
); 
```

我正在为 WARN 使用内联函数，但我很好奇幕后进行了多少优化——评估整个程序中的参数会很昂贵。`WARN`函数是这样的：

```
bool WARNINGS_ENABLED = false;
inline void WARN(const string &message) {
    if (!WARNINGS_ENABLED) {
       return;
    }
    // ...
} 
```

鉴于构造字符串参数没有副作用，编译器会优化它吗？是否需要一定程度的优化（`-Ox`在`g++`某些情况下`x`）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-12T00:52:16.700

如果您需要能够在运行时选择性地启用和禁用警告，编译器将*无法*优化调用。

您需要将*函数*重命名为`WARN2`并添加一个宏，例如：

```
#define WARN(s) do {if (WARNINGS_ENABLED) WARN2(s);} while (false) 
```

除非您启用了警告，否则这将阻止在运行时对 s 进行评估。

do-while 东西是一种技巧，它允许在代码中的任何地方使用它（裸语句、带括号的 if 块中的语句、不带括号的 if 块中的语句、带括号和不带括号的 while 语句等）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-12T00:37:37.493

您可以使用**-S**选项检查 GCC/G++ 的功能。这将在实际组装之前输出代码 - 参见[gcc(1)](http://linux.die.net/man/1/gcc)。

在这种情况下，GCC 和 G++ 的行为或多或少是相同的。所以我首先将代码翻译成 C 来做一些进一步的测试：

```
char WARNINGS_ENABLED = 0;

inline void WARN(const char* message) {
    if (!WARNINGS_ENABLED) {
        return;
    }
    puts(message);
}

int main() {
    WARN("foo");
    return 0;
} 
```

运行**gcc -O3 -S file.c**并查看输出文件' **file.s** '
你会看到 GCC**没有删除任何东西**！

这不是您要求的，但为了让编译器有机会优化该代码，您必须使 WARNINGS_ENABLED**常量**。另一种方法是使其成为**静态**而不更改该文件中的值。*但是*：将其*设为静态*具有符号不会被导出的副作用。

```
static const char WARNINGS_ENABLED = 0;

inline void WARN(const char* message) {
  if (!WARNINGS_ENABLED) {
      return;
  }
  puts(message);
}

int main() {
    WARN("foo");
    return 0;
} 
```

GCC 然后完全清理代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T00:21:56.713

我猜它只有在可以证明没有副作用的情况下才有机会对其进行优化（编译器可能很难为昂贵的函数调用做这件事）。

我不是提升专家，但我猜有一种方法可以构建一个 lambda，如果 WARNINGS_ENABLED 为真，它只会被评估以生成字符串。就像是...

```
inline void warnFunc(some_boost_lambda &message_generator) {
  if (WARNINGS_ENABLED) {
    cerr << message_generator() << endl;
  }
}

#define WARN(msg) warnFunc(...insert boost magic here to turn msg into a lambda...) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T01:35:51.963

不，编译器在任何情况下*都不应该优化代码，除非全局 WARNING_ENABLED 被声明为 const。*

顺便说一句，如果 WARN 是内联函数，即使它被禁用，您仍然会付出消息构造的代价（在您的示例中使用 lexical_cast 和 operator+ 字符串时，这非常低效）。

以下是一些有效的（在禁用运行时时开销最小（使用分支预测 CPU 时接近于零）开销）的[日志记录宏](http://github.com/vicaya/hypertable/tree/master/src/cc/Common/Logger.h)，它们同时支持函数和流式日志记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T00:45:27.570

你不能用预处理器定义整个事情吗？

```
void inline void LogWarning(const string &message) 
{
  //Warning
}

#ifdef WARNINGS_ENABLED
#define WARN(a) LogWarning(a)
#else
#define WARN(a)
#endif 
```

这就是 ASSERT() 宏的工作原理。WARN 中括号内的所有代码甚至都没有通过预处理器到达编译器。这意味着你可以做其他事情，比如

```
#ifdef WARNINGS_ENABLED
// Extra setup for warning
#endif
//....
WARN(uses setup variables) 
```

它将以两种方式编译。

至于让优化器意识到括号中没有副作用，您可以在其中放置一些很难证明的非常复杂的语句（即高级字符串操作）。

# sql-server-2008 - 导出/导入 MS Sql 2008 地理数据的最佳方式

> ID：282604
> 
> 赞同：9
> 
> 时间：2008-11-12T00:15:29.830
> 
> 标签：sql-server-2008, export, geography, bcp

### (ANSWER) 如何从 Microsoft Sql Server 2008 中导出一些地理数据。

您需要使用命令行参数 BCP 将原始（本机）格式的数据转储到二进制文件中。然后在另一台服务器上，您可以将此二进制数据批量插入到相同结构的表中。

这是一些代码。

### 出口

```
Command Line: bcp "geodata.dbo.GeographyData" out "C:\GeoData.bin" -T -n -S <servername> 
```

### 笔记

*   这使用受信任的连接
*   使用 bcp /? 如果您需要成为铁杆，请为您的出口选项提供更多帮助。

### 导入数据

```
T-SQL: bulk insert GeographyData from 'C:\GeoData.bin' with (dataFileType='Native') 
```

我通过空间大师[Isaac Kunen并在](http://blogs.msdn.com/isaac/)[Kent Tegels](http://sqlblog.com/blogs/kent_tegels/)的帮助下了解了这一切，在[这里](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4182363&SiteID=1)的讨论线程中。

Isaac 在这段引文中强调了 BCP 方法的原因：

> 值得指出的是，WKB 是一种有损格式，因为它不存储 SRID。因此，如果您提取并插入 WKB，您必须自己携带 SRID。我们的内部二进制格式确实存储了 SRID，所以像这样的 BCP 应该不那么麻烦。

HTH。

编辑：将整个帖子问题替换为社区 wiki .. 这个帖子是一个答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-06T01:06:32.270

我最初删除了开篇文章中的问题，用答案（在 08 年末）替换它......并使其成为一个 wiki。

所以是的.. OP就是答案：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T05:48:03.313

批量插入错误！！！消息 6522，级别 16，状态 1，第 1 行在执行用户定义的例程或聚合“几何”期间发生 .NET Framework 错误：

# .net - ASP.net 配置文件和成员资格 - 自定义提供程序还是我应该完全自己推出？

> ID：282613
> 
> 赞同：5
> 
> 时间：2008-11-12T00:22:19.053
> 
> 标签：.net, asp.net, membership-provider

首先，我知道这个问题可能与这个问题重复[，](https://stackoverflow.com/questions/1683/)是的，我问一个我什至自己回答的问题有点讽刺。

现在，我说的是 ASP.net Profiles。如果这很重要，我正在使用 MVC 构建应用程序，并且我相信内置的 Profile Provider 是无用的。

所以此刻，我在问自己：我应该按照自己的建议编写自定义配置文件提供程序，还是应该完全推出自己的配置文件？

一些假设：

*   我希望我的数据在我决定的数据库结构中
*   这是一个全新的应用程序，没有需要集成的遗留数据库结构或用户群
*   中小型用户（最多约 5000 个用户）
*   ASP.net MVC，很可能是 Silverlight 2，甚至可能是一些 Windows Azure，但我仍在试验它，但肯定是 .net 3.5 SP1。
*   并且，可能作为主要决策点：不一定使用 Forms Auth，应用程序最终可能会使用 Active Directory 或 OpenID 进行身份验证

我仍然需要调查是否可以将 ASP.net Membership 与非标准身份验证提供程序 (OpenID) 一起使用，因为我认为 ASP.net Profiles 只有在我使用 ASP.net Membership 时才有意义，所以我最终可能会同时编写两者OpenID 的自定义成员资格提供程序（本质上只是充当桥梁）和自定义配置文件提供程序。

所以是的，我认为这可能是一个好方法，因为我继续使用框架已经给我的东西，但我几乎没有会员资格和个人资料方面的经验，所以也许这里有人对我是否应该完全滚动有所了解我自己的身份验证和/或配置文件，或者如果我最好编写自定义成员资格和配置文件提供程序，这显然是[这样做](https://stackoverflow.com/questions/264272/)的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T06:00:01.180

我没有编写自己的个人资料提供商的经验，但我已经编写了自己的会员提供商。这相对容易（有很多方法*不需要*实现）。事实上，看起来真正需要的唯一方法是 GetUser() 和 ValidateUser() 方法。

唯一有点棘手（并且值得分析）的部分是 GetUser() 似乎被非常频繁地调用，您应该考虑缓存结果，这样您就不会总是访问数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T02:57:31.423

为了能够回答要做什么的问题，您需要坐下来准确地确定您的身份验证和配置文件模型需要的所有功能和要求，然后查看内置的 .net 东西提供了什么。只有拥有了需求列表后，您才能准确评估您是否最好自己滚动或使用内置提供程序。

对您来说，更好的提问方式是说“我需要与我的会员和个人资料提供商一起做 x、y 和 z，我最好的选择是什么？”

# .net - 使用来自同一解决方案的自定义 MSBuild 任务？

> ID：282615
> 
> 赞同：22
> 
> 时间：2008-11-12T00:23:46.630
> 
> 标签：.net, msbuild

我是 MSBuild 的新手，想尝试一下，但我就是不明白为什么这不起作用。

所以我的解决方案有两个项目：“模型”和“BuildTasks”。BuildTasks 只有一个类：

```
using Microsoft.Build.Utilities;

namespace BuildTasks
{
    public class Test : Task
    {
        public override bool Execute()
        {
            Log.LogMessage( "FASDfasdf" );
            return true;
        }
    }
} 
```

然后在 Model.csproj 我添加了这个：

```
 <UsingTask TaskName="BuildTasks.Test" AssemblyFile="$(SolutionDir)src\BuildTasks\bin\BuildTasks.dll" />
  <Target Name="AfterBuild">
    <Test />
  </Target> 
```

我已经设置了构建顺序，因此“BuildTasks”在“模型”之前构建。但是当我尝试构建模型时，我得到了这个错误：

> 无法从程序集 C:\WIP\TestSolution\src\BuildTasks\bin\BuildTasks.dll 加载“BuildTasks.Test”任务。无法加载文件或程序集 'file:///C:\WIP\TestSolution\src\BuildTasks\bin\BuildTasks.dll' 或其依赖项之一。该系统找不到指定的文件。确认 <UsingTask> 声明正确，并且程序集及其所有依赖项都可用。

这个文件肯定存在，为什么MSBuild找不到呢？

我什至尝试用硬编码“C:\WIP\TestSolution”代替“$(SolutionDir)”并得到同样的错误。但是，如果我将该 .dll 复制到我的桌面并将路径硬编码到我的桌面，它*确实*可以工作，我不知道为什么。

**编辑**：我没有路径错误。我修改了 BuildTasks 的 Debug/Release 构建以将 .dll 输出到 bin 文件夹，因为我不希望 Debug/Release 具有不同的路径。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-08T21:52:29.317

我们尝试了这个，我们发现您必须将 UsingTask 放在项目文件的顶部（并且所有路径都正确）。但是，一旦到位并且任务加载，它只会工作一次。之后构建开始失败，因为它无法复制任务所在的 DLL。我们实际上是在我们正在构建的同一个程序集/项目中运行一个构建后任务。

我们为解决这个问题所做的是在单独的 MSBuild 文件上启动单独的 MSBuild 进程来运行 Post Build 任务。这样，在构建并复制到 bin 目录之后，才会加载 DLL。

```
<Target Name="AfterBuild">
    <Exec Command="$(MSBuildBinPath)\MSBuild.exe 
          &quot;$(MSBuildProjectDirectory)\PostBuild.msbuild&quot; 
          /property:SomeProperty=$(SomeProperty)" />
</Target> 
```

请注意，您可以在命令行上将属性传递到此子构建任务中。

PostBuild.msbuild 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="PostBuild" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">
    <UsingTask TaskName="PostBuild" AssemblyFile="$(MSBuildProjectDirectory)\bin\AssemblyThatJustBuiltAndContainsBuildTask.dll" />
    <PropertyGroup>
        <SomeProperty>SomePropertyDefaultValue</SomeProperty>
    </PropertyGroup>

    <Target Name="PostBuild">
        <MyPostBuildTask SomeProperty="$(SomeProperty)" />
    </Target>
</Project> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-20T10:46:07.817

[如果所有自定义任务都继承自AppDomainIsolatedTask](https://msdn.microsoft.com/en-us/library/microsoft.build.utilities.appdomainisolatedtask.aspx) 并且`MSBUILDDISABLENODEREUSE = 1`在启动 Visual Studio 之前设置环境变量，则可以避免锁定自定义任务 DLL 。

具有自定义生成任务的程序集被 devenv.exe 和 msbuild.exe 锁定。

您可以使 msbuild.exe 进程消失，但如果您的自定义任务继承自[Task](https://msdn.microsoft.com/en-us/library/microsoft.build.utilities.task.aspx)`MSBUILDDISABLENODEREUSE = 1`，devenv.exe 仍会偶尔锁定自定义任务程序集。

另一方面，如果您只从 AppDomainIsolatedTask 继承并且不设置`MSBUILDDISABLENODEREUSE`空闲的 MSBuild 进程，仍然会锁定程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T01:55:54.277

[斯莱斯](https://stackoverflow.com/users/11388/slace)说得对。您很可能有错误的组装路径。它可能应该是：

```
<UsingTask 
    TaskName="BuildTasks.Test" 
    AssemblyFile="$(SolutionDir)src\BuildTasks\bin\$(Configuration)\BuildTasks.dll" />

<Target Name="AfterBuild">
    <Test />
</Target> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-20T10:09:46.950

禁用 MSBuild 节点重用也将解决此问题：

*   在 MSBuild 命令行上，传递该`/nr:false`选项。
*   对于 Visual Studio，您必须在启动 VS 之前将`MSBUILDDISABLENODEREUSE`环境变量设置为。`1`

请参阅[Visual Studio 2012 RTM 关闭后内存中有 MSBuild.exe](https://stackoverflow.com/questions/12174877/visual-studio-2012-rtm-has-msbuild-exe-in-memory-after-close)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T23:08:43.960

您可能会尝试使用 fuslogvw 来诊断问题，以为我不清楚它是否已经那么远了......

[http://msdn.microsoft.com/en-us/library/e74a18c4.aspx](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T00:33:39.200

你确定你有你的路径写？不应该在里面`bin\Configuration Type\BuildTasks.dll`吗？

我发现这个链接：[http](http://bartdesmet.net/blogs/bart/archive/2008/02/15/the-custom-msbuild-task-cookbook.aspx) ://bartdesmet.net/blogs/bart/archive/2008/02/15/the-custom-msbuild-task-cookbook.aspx在开始编写 MSBuild 任务时非常有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-08T11:08:38.920

在我们的例子中，将 PlaformTarget 添加到项目文件 (.csproj) 中，解决了这个问题。

# c++ - 计算派生类的最大大小

> ID：282619
> 
> 赞同：3
> 
> 时间：2008-11-12T00:26:34.737
> 
> 标签：c++, uml

我们有一个 My_list 类，它有一个指向 Abstract_things 的指针列表。为了优化内存使用，所有派生的事物都使用一个以“新建和删除”原型建立的内存池。为了在应用程序初始化期间正确调整池的大小，构建器会确定哪个事物是最大的，并以此为基础调整池的大小。

设计困境是，如果向模型中添加了新事物（用红色的 Thing_4 表示），设计者必须知道转到 Builder 来调整逻辑。我观察到我们的团队很难记住这样做（大约一半的事情没有在 Builder 中考虑）。我非常担心后代会忽略这一点。

我的问题是如何改善这一点？如果在创建 Thing_4 类的过程中，自动处理所有 max_size 的东西，那就太好了。不过我想不出办法。

注意：查看我的照片我意识到有一个错误。代码框中的最后一行应为 Abstract_thing::set_max_pool_size(max_size, max_number)。

编辑：我不知道如何显示图片。预览窗口中的一切看起来都不错，但发布时却不存在。有什么帮助吗？

编辑：为了提供更多背景知识，这是安全关键系统中嵌入式应用程序设计的一部分。当应用程序初始化时，我们可以在堆外分配内存，但是在我们退出初始化阶段后，就不能分配动态内存了。尝试这样做会使应用程序崩溃。因此，我们编程到最大尺寸和我们使用的最大实例数。拥有一个包含所有派生对象的足够空间的池是比为每个派生对象拥有一个池更好的方法。

[替代文字 http://img262.imageshack.us/img262/4470/designproblemof1.png](http://img262.imageshack.us/img262/4470/designproblemof1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T00:42:31.867

**更新**：好的......嵌入式系统要求有所改变。

您可以使用一个类自动注册派生类，然后将此类的静态实例添加到每个派生类。不过，您仍然必须记住这样做，但至少它是自包含在一个地方的。

就像是：

```
template<class T>
class RegisterPoolClass
{
public:
    RegisterPoolClass() { init_pool.Register(sizeof(T)); }
};

class Thing_1 : public Abstract_Thing
{
   static RegisterPoolClass<Thing_1> sInitializer;
    ...
};

RegisterPoolClass<Thing_1> Thing_1::sInitializer; 
```

您可以使用宏以与 ATL 相同的方式封装每个派生类中所需的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T00:38:52.700

我不确定我是否理解正确，但是是什么阻止了您进行枚举所有派生类的构建步骤，以您现在使用的任何方式估计它们的大小来计算您的东西的大小，并找到最大的一个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T00:43:56.077

grep 类，构建一个测试所有大小的应用程序，如果它们搞砸了就会失败。

```
echo '#include"head"' > out.cpp
grep "class \w+ : TheClass" *.cpp | sed  "s/.*class \(\w\)+ : TheClass.*/assert(sizeof($1) <= MAX_SIZE); >> out.cpp
echo '#include"tail"' >> out.cpp
gcc out.cpp
./a.out 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T00:44:52.377

这个怎么样：

抽象事物.h

```
#ifndef ABSTRACT_THING
#define ABSTRACT_THING
class AbstractThing
{
private:
    static  size_t                  maxChildSize;
    static  bool                    maxChildLock;
    static  std::vector<type_info>  validChildren;

    static size_t   getMaxChildSize()
    {
        maxChildLock    = true;
        return maxChildSize;
    }
public:
    template<typename T>
    static  void setChildSize()
    {
        // This is to stop registering things after getMaxChildSize()
        // has been called. This check is only needed during testing
        if (maxChildLocked)
        {
            exit(1);
        }
        maxChildSize    = std::max(maxChildSize,sizeof(T));
        validChildren.push_back(typeid T);
    }
    template<typename T>
    static bool testValidType()
    {
        // While testing call this method.
        // Don't call in production to speed things up.

        // Only registered children will be allowed to get memory.
        // Or maybe generate a warning in the log if it fails.
        return validChildren.find(typeid T) != validChildren.end();
    }
};
template<typename T>
class RegisterAbsoluteThing
{
public:
    RegisterAbsoluteThing()
    {
        AbstractThing::setChildSize<T>();
    }
};
#endif 
```

东西1.h

```
#ifndef THING_1
#define THING_1

#include "AbstractThing.h"
class Thing1: public AbstractThing
{
};

namespace
{
    // Because this is in an anonymous namespace
    // It does not matter how many times different files it is included
    // This will then all be registered at startup before main.
    RegisterAbsoluteThing<Thing1>   RegisterAsValidThing1;

    // All class that derive from AbstractThing should have this block.
    // Any that do not that try and use the pool will cause the tests to fail.
}
#endif 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T01:50:31.823

您可以使用 CTAGS 或类似的解析器来提取所有派生类的名称并使用它来自动生成您的 init_pool 实现吗？

# data-access-layer - 定义数据访问层

> ID：282622
> 
> 赞同：8
> 
> 时间：2008-11-12T00:28:47.557
> 
> 标签：data-access-layer

似乎每个人都知道您应该清楚地区分 GUI、业务逻辑和数据访问。我最近与一位吹嘘始终拥有干净的数据访问层的程序员交谈。我查看了这段代码，结果发现他的数据访问层只是一个包含一些 SQL 方法（如 ExecuteNonQuery 和 ExecuteReader）的小类。事实证明，在他的页面背后的 ASP.NET 代码中，他有大量的 SQL 硬编码到 page_load 和其他事件中。但他发誓他正在使用数据访问层。

所以，我抛出这个问题。您将如何定义数据访问层？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T00:44:26.497

大多数人认为你的同事所说的不是 DAL。DAL 应该封装对数据库的任何调用，无论是通过动态 SQL、存储过程还是使用 IRepository 之类的 ORM 完成的。您的网页永远不应该包含 SQL 或业务逻辑，否则它将成为维护的噩梦。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T01:38:59.787

.NET 的一个非常简单的示例如下。

如果有两个类：SomePage（这是一个 ASP.NET 页面）和 DataService（这是一个普通的旧 C# 类）

如果 SomePage 总是调用 DataService 来读取/写入数据，那么您有一个数据访问层。SomePage 将不包含 SQL 或对 System.Data.SqlClient 类的引用。

但 SomePage 可以使用从 DataService 类传入和传给 DataService 类的 DataSet 或业务对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-10T14:36:53.003

我发现这篇关于创建 DAL 的文章：

[http://www.simple-talk.com/dotnet/.net-framework/.net-application-architecture-the-data-access-layer/](http://www.simple-talk.com/dotnet/.net-framework/.net-application-architecture-the-data-access-layer/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T01:01:06.820

除了其他人所说的之外，我通常认为它是抽象出数据存储方式的地方。一个非常好的数据访问层应该允许您交换 Oracle、SQL Server、Access、纯文本文件、XML 或任何您想要的东西，并且这样做对其他应用程序层是透明的。换句话说，数据访问层和其他层之间的契约应该以与数据库无关的方式定义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T00:36:55.887

我个人将 DAL 定义为我的应用程序和数据库之间存在交互的地方。所以我可能有一个与 DAL 交互以允许 CRUD 操作的业务层。

例如，我可能有一个与 DAL 交互的 ModelClass.LoadAll() 方法，该方法将获取数据，而 ModelClass 将以任何需要的方式使用该数据。

我更喜欢让 DAL 尽可能轻，但其他一些人更喜欢在 DAL 中填充模型数据的另一种方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-04T06:41:35.373

数据访问层访问数据，仅此**而已**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T00:34:42.413

保存您的数据的“黑匣子”。如果它是用户关心/可以告诉那里有一个数据库（除了每个考虑），这不是我想要的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-10T12:03:45.813

我很乐意分享这种*数据检索器*（只读）层的设计。

架构的关键：

*   这个想法是创建一个几乎是单例的对象（如下所述），该对象用于保存使用 get 方法检索的数据 - 下面我将其称为`DRO`( `DataRetrieverObject`)。
*   客户端对象应该很容易到达`DRO`.
*   维护类应该很容易。

该结构基于三步构造。

1.  使用`DataRetrieverFactory`具有（重载）静态方法，一个用于您需要的每个表。使用重载来匹配不同类型的键。该方法将返回一个 DRO。

2.  将`DataRetrieverFactory`施工作业委托给`<TableNameAndKey>DR`将创建实际 DRO 的第二类。

3.  在`<TableNameAndKey>DR`我们有一个指向 DRO 的静态指针列表中，循环该列表以查看您是否已经有一个具有特定键的 DRO。

    3.1。如果您找到 DRO - 检查它是否正常（意思是：

    *   它不应该是“旧的”，
    *   它应该属于会话运行，
    *   ETC。）

    3.1.1。如果 DRO 正常，则返回 DRO。

    3.1.2。如果 DRO 不正常，则删除对象（及其指针）并使用数据库中的数据创建一个新的 DRO。将指针存储在列表中。

    3.2\. 如果指针列表中没有命中，那么我们使用数据库中的数据创建一个新的 DRO，并将指针存储到静态列表中。

使用这种技术，可以根据需要重用 DRO，但是该类不是单例的，因为我们可以拥有该类的大量实例。

# vbscript - VBScript LDAP：有没有办法使用 Active Directory 中的电子邮件地址查询physicalDeliveryOfficeName？

> ID：282627
> 
> 赞同：4
> 
> 时间：2008-11-12T00:34:03.397
> 
> 标签：vbscript, active-directory, ldap

我正在尝试使用[VBScript](http://en.wikipedia.org/wiki/VBScript)通过提供电子邮件地址 来连接拉动[Active Directory](http://en.wikipedia.org/wiki/Active_Directory)`physicalDeliveryOfficeName`中的属性。

我知道如何使用如下通用名称进行操作：

```
Set MyUser = GetObject ("LDAP://cn=" & uname & ",ou=" & strname & ",DC=bobdom,DC=net") 
```

但是，只有电子邮件地址可用。这该怎么做？我什至试过

```
Set MyUser = GetObject ("LDAP://mail=" & uname & ",ou=" & strname & ",DC=bobdom,DC=net") 
```

那是行不通的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-21T17:43:52.483

我最终写了以下内容：

```
Function getOffice (strname, uname) 

strEmail = uname
WScript.Echo "email: " & strEmail 
Dim objRoot : Set objRoot = GetObject("LDAP://RootDSE")
Dim objDomain : Set objDomain = GetObject("LDAP://" & objRoot.Get("defaultNamingContext"))
Dim cn : Set cn = CreateObject("ADODB.Connection")
Dim cmd : Set cmd = CreateObject("ADODB.Command")
cn.Provider = "ADsDSOObject"
cn.Open "Active Directory Provider"
Set cmd.ActiveConnection = cn

cmd.CommandText = "SELECT physicalDeliveryOfficeName FROM '" & objDomain.ADsPath & "' WHERE mail='" & strEmail & "'"
cmd.Properties("Page Size") = 1
cmd.Properties("Timeout") = 300
cmd.Properties("Searchscope") = ADS_SCOPE_SUBTREE

Dim objRS : Set objRS = cmd.Execute
    If IsNull(objRS.Fields(0)) = TRUE Then 
        getOffice = "BLANK"
    Else 
    getOffice = objRS.Fields(0)
    WScript.Echo getOffice 
    End If 

Set objRS = Nothing
Set cmd = Nothing
Set cn = Nothing
Set objDomain = Nothing
Set objRoot = Nothing
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T00:26:05.840

如果使用[LDAP](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)查询（不确定在您的情况下是否需要服务器名称）：

```
<LDAP://SERVERNAME/DC=bobdom,DC=net>;(&(objectClass=user)(mail=mike.spencer@kenblanchard.com)); 
```

在我自己的环境中尝试一下，它看起来像这样（有一些通用化的东西）：

```
<LDAP://SERVERNAME/DC=bobdom,DC=net>;(&(mail=email@company.com));name,mail,member,description,memberOf,userParameters,userAccountControl,whenCreated,CN;subTreeCount=1 
```

整个批次看起来像这样（在 ASP 中；如果在 .vbs 文件中完成，您需要将其更改`Server.CreateObject`为`CreateObject`...我认为）。

```
Set oCon        = Server.CreateObject("ADODB.Connection")
oCon.Provider   = "ADsDSOObject"
oCon.Open "ADProvider", "ADUsername", "ADPassword"

Set oCmd        = Server.CreateObject("ADODB.Command")
Set oCmd.ActiveConnection = oCon

sQuery = "<LDAP://SERVERNAME/DC=bobdom,DC=net>;(&(mail=email@company.com));name,distinguishedName,physicalDeliveryOfficeName;subTreeCount=1>"

oCmd.CommandText = sQuery
Set ADRecordSet = oCmd.Execute 
```

您可能需要摆弄`subTreeCount`.

# .net - Windows 窗体中的 MVP 和 IOC？

> ID：282628
> 
> 赞同：4
> 
> 时间：2008-11-12T00:34:30.010
> 
> 标签：.net, winforms, inversion-of-control, mvp

我已经开始在我的几个表单的 Windows 表单应用程序中使用 MVP 模式。这些表单创建一个演示者并将它们自己传回给演示者。

我没有使用任何特定的框架，表单仍然可以打开其他表单。

我是否应该更改此设置以便演示者可以打开其他表单（通过视图）？我相信必须使用 IOC 框架来做到这一点？

这可能会节省我在 UI 中打开相关表单的逻辑，并允许我从表单中删除对演示者的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-13T23:42:53.290

You should have a separate class that is responsible for creating / managing forms. I would recommend using the Command pattern to invoke the code that opens a new form. It will end up scaling a lot better and you can change the Command implementation to do different things. In my projects, I just do the data changes in the form itself, but anything that interacts with the "application" is delegated to a Command object.

You don't NEED an IOC framework to do this, but it helps. If you just have simple needs, you can keep it simple.

I have a WinForms MVP example on my site here: [ModelViewPresenter](http://garoyeri.blogspot.com/search/label/modelviewpresenter). I don't use any IOC containers, but structure the code such that using one would be a quick hop.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T01:17:09.143

我正在对几个 winforms 项目做类似的事情，一个用于工作，一个用于家庭。

我的解决方案是为视图使用工厂，允许调用者访问并将消息传递给新的演示者。在某些情况下，我通过将服务接口放置在演示者本身或可以注入的中间类上来进一步抽象它们。

# asp.net - ASP.NET - 使用 jQuery 实现基于 JSON 的 Web 服务的正确方法是什么？

> ID：282644
> 
> 赞同：5
> 
> 时间：2008-11-12T00:44:15.933
> 
> 标签：asp.net, javascript, jquery, web-services, json

将基于 ASP.NET SOAP 的 Web 服务转换为基于 JSON 的响应的正确方法是什么？...然后从 jQuery 调用这些？

集成基于 jQuery 的 AJAX 和 ASP.NET 时的“最佳实践”是什么？文章？图书？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T01:16:55.090

可以使用**System.Runtime.Serialization**和**System.Runtime.Serialization.JSON**将 JSON 转换为 .NET 类。我怀疑您对设置从客户端到服务器的函数调用更感兴趣。我认为值得尝试[本教程](http://asp.net/AJAX/Documentation/Live/tutorials/ASPNETAJAXWebServicesTutorials.aspx)。

在本教程中，您需要添加一个 web 服务“.asmx”文件。在 asmx 文件中，您将能够创建可从客户端脚本调用的函数。您的 ASP.NET 页面还可以引用生成的客户端脚本来调用 .asmx 函数。

如果你真的想做 JSON 序列化，你也可以使用以下命令：

```
using System.Runtime.Serialization;
using System.Runtime.Serialization.Json;

public class JsonSerializer
{
    // To make a type serializeable, mark it with DataContractAttribute
    // To make a member of such types serializeable, mark them with DataMemberAttribute
    // All types marked for serialization then need to be passed to JsonSerialize as
    // parameter 'types'

    static public string JsonSerialize(object objectToSerialize, params Type[] types)
    {
        DataContractJsonSerializer serializer = new DataContractJsonSerializer(
            types[0], types.Skip(1));

        MemoryStream ms = new MemoryStream();
        serializer.WriteObject(ms, objectToSerialize);
        ms.Seek(0, SeekOrigin.Begin);
        StreamReader sr = new StreamReader(ms);
        return sr.ReadToEnd();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T01:43:57.343

Bobby Soares 在 codproject.com 上的以下文章[扩展现有的 ASP.NET Web 服务以支持 JSON讨论了使用自定义方法属性来实现所需的结果。](http://www.codeproject.com/KB/webservices/XML_and_JSON_on_same_We_S.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T03:00:40.200

我使用 ASP.Net Ajax 已经有一段时间了，但从未担心过 JSON 或 XML 通信。相反，我使用 Web 服务直接返回您可以使用 innerHTML 设置的内容。

这很容易实现。只需创建一个 Web 服务 (ASMX) 文件，并将您的方法声明为 WebMethods（设置 WebMethod 属性）。

现在你可以从你的 Javascript 代码调用你的 web 服务，就像一个普通的函数一样。

函数的结果将返回给回调函数。这是结构

```
//Webmethod returns some HTML content
Myservice.DoSomething(myParam, callBackFunction);

//Content is set on the webpage
function callBackFunction(result){
  document.getElementById('myElemID').innerHTML = result;
} 
```

# php - Perl 有类似 PHP 的动态变量吗？

> ID：282647
> 
> 赞同：11
> 
> 时间：2008-11-12T00:45:07.853
> 
> 标签：php, perl, dynamic, variables

在 PHP 中，我可以写：

```
$vname = 'phone';
$$vname = '555-1234';
print $phone; 
```

...脚本将输出“555-1234”。

Perl 中是否有任何等价物？

有没有办法限制`$phone`本地块的范围，就像我写的一样`my $phone`？使用`my $$vname`给我“无法在我的 at ... 中声明标量取消引用”错误。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-11-12T02:25:22.300

您尝试做的事情称为“符号引用”。虽然您可以在 Perl 中执行此操作，但[您不应该这样](http://perl.plover.com/varvarname.html)做。符号引用仅适用于全局变量——不适用于词法 ( `my`) 变量。没有办法限制它们的范围。**符号引用是危险的。**`strict`出于这个原因，它们在pragma下不起作用。

通常，每当您认为需要符号引用时，都应该使用散列：

```
my %hash;
$hash{phone} = '555-1234';
print $hash{phone}; 
```

在少数情况下，symrefs 很有用，甚至是必要的。例如，Perl 的导出机制使用它们。这些是高级主题。当你准备好迎接他们时，你不需要问如何。;-)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-12T08:08:20.530

*[阅读 Mark-Jason Dominus 在“为什么将变量用作变量名是愚蠢的”](http://www.plover.com/perl/varvarname.html)*中反对这样做的咆哮。

您可以通过以以下方式开始块来限制对 $phone 的更改范围

```
local $phone; 
```

甚至

```
local $$vname; 
```

（尽管对于从您的块中调用的任何 subs 都更改了 $phone ，但它与`my()`声明的词法范围不同。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-12T00:56:46.893

您可以以非常相似的方式进行操作：

```
$vname = "phone";
$$vname = "555-1234";
print $phone; 
```

但你可以并不意味着你应该。[正如 Michael Carman 所说](https://stackoverflow.com/questions/282647/does-perl-have-php-like-dynamic-variables/282814#282814)，最好的管理方法是**使用 HASH！**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-12T01:12:19.683

您不能在启用 strict pragma 的情况下执行此操作，并且通常应该始终启用 strict pragma。不过，您可以在关闭编译指示的情况下执行此操作，请看一下这一行：

```
perl -le 'my $vname = "phone"; ${ $vname } = "555-1234"; print $phone' 
```

这将起作用，但这不会：

```
perl -Mstrict -le 'my $vname = "phone"; ${ $vname } = "555-1234"; print $phone' 
```

“-Mstrict”告诉它“使用严格”。

对这样的事情使用散列几乎总是更好，这与 PHP 中的关联数组大致相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-21T01:24:30.113

您确实意识到 PHP 继承了 Perl 的许多特性，对吧？

Perl 不仅可以做 PHP 可以做的所有符号引用的事情，

```
use strict;
use warnings;
use 5.010;

our $test=1;

# Access $test through the special hash %::
say ${$::{test}}++;

# This is essentially what the previous line did.
say ${\$test}++

# Same as $test
say ${test}++;

{
  # PHP's simple symbolic ref
  my $ref = "test";
  no strict 'refs';
  say $$ref++;
  say ${"test"}++;
}
{
  package d;
  say ${$main::{test}}++;

  my $ref = $main::{"test"};
  say $$ref++;

  $ref = \$main::test;
  say $$ref++;
} 
```

# iis - IIS 的最佳 GZIP 压缩设置是什么？

> ID：282650
> 
> 赞同：3
> 
> 时间：2008-11-12T00:46:17.757
> 
> 标签：iis, compression, gzip

您可以将 HcDynamicCompressionLevel 设置为 0-10 之间的任何位置。我听说 10 不好（CPU 使用率高），但最有效的幻数是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T04:52:02.840

*动态压缩DO*设置为 5 到 9实际上会影响 CPU 负载。静态压缩只发生一次（直到文件被重新缓存），您可以将静态压缩设置为高。

这篇深入的文章推荐**4 用于动态压缩**和**7 到 9 用于静态压缩**。本文使用您可以阅读和自行决定的信息来支持此建议。

[http://weblogs.asp.net/owscott/archive/2009/02/22/iis-7-compression-good-bad-how-much.aspx](http://weblogs.asp.net/owscott/archive/2009/02/22/iis-7-compression-good-bad-how-much.aspx)

较小的动态页面可以从较高的动态压缩设置中受益，因为较大的文件会增加 CPU 负载。在大小约为 200 KB 时，您将需要考虑较低的页面动态设置。另外，请注意，高动态压缩设置会增加从每个页面请求中获取第一个字节的时间。这些因素支持使用更受限制的设置 4 进行动态压缩。

同样，静态资源可以使用高设置，因为只有第一个请求会影响 CPU 负载和客户端等待时间。但是，如果您提供许多大型静态资源，那么静态压缩也不会得到回报，因为您的缓存将填满并开始踢出资源；因此，压缩资源不会从缓存中重复提供服务中受益。

**注意：没有“10”的设置。**

还有两点需要考虑：

文件中的`httpCompression`元素`.config`具有在 CPU 负载过高时禁用压缩的设置：

```
dynamicCompressionDisableCpuUsage="90"
dynamicCompressionEnableCpuUsage="80"

staticCompressionDisableCpuUsage="100"
staticCompressionEnableCpuUsage="80" 
```

`EnableCpuUsage`当 CPU 负载低于指定值时，该设置会重新启用压缩。

另一个设置禁用小文件的压缩：

```
minFileSizeForComp="2700" 
```

IIS 7.5 在意识到某些压缩文件比原始文件大后，将压缩的最小文件大小从 IIS 7.0 中的默认 256 字节提高到默认的 2,700 字节。我不知道 2,700 字节是否最好，但由于 IP 数据包可以合理地约为 1,400 字节，因此此设置将阻止压缩文件少于两个数据包。在任意挑战微软提高此设置的决定之前，我想进行真正的测试或阅读专家的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T00:59:00.600

当 CPU 比现在慢两个数量级时，10 很糟糕。就目前的压缩算法而言，gzip 算法非常快，所以我将其设置为 10 看看会发生什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T00:54:29.847

在我看来，这真的取决于你的情况。如果您要处理大量大文件并且有一些 CPU 资源可用，那么更大的数量会更好。但是，由于您有更多的并发连接、更小的文件和更不强大的 CPU，因此数量越少越好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T09:05:13.100

我发现将它设置为 8 可以提供相当不错的压缩率，而不会过多地敲击服务器。这将取决于您的服务器负载和规格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-28T21:27:13.967

在我工作的公司中，启用了 ASPX 的动态压缩和动态生成的 javascript/css 和页面似乎需要更长的时间来下载。我们尝试将压缩级别设置为 1 和最大值。cpu 90% 但在没有压缩的情况下仍然最糟糕。是我的

# c# - 在事件分派之前检查 null ......线程安全吗？

> ID：282653
> 
> 赞同：35
> 
> 时间：2008-11-12T00:50:26.890
> 
> 标签：c#, multithreading, events

一些让我感到困惑，但从未引起任何问题的事情......调度事件的推荐方式如下：

```
public event EventHandler SomeEvent;
...
{
    ....
    if(SomeEvent!=null)SomeEvent();
} 
```

在多线程环境中，这段代码如何保证另一个线程不会改变`SomeEvent`检查空值和事件调用之间的调用列表？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-11-12T01:36:44.970

正如您所指出的，在多个线程可以`SomeEvent`同时访问的情况下，一个线程可以检查是否`SomeEvent`为 null 并确定它不是。就在这样做之后，另一个线程可以从`SomeEvent`. 当第一个线程尝试 raise`SomeEvent`时，将引发异常。避免这种情况的合理方法是：

```
protected virtual void OnSomeEvent(EventArgs args) 
{
    EventHandler ev = SomeEvent;
    if (ev != null) ev(this, args);
} 
```

这是因为每当使用 add 和 remove 访问器的默认实现将委托添加到事件中或从事件中删除委托时，都会使用 Delegate.Combine 和 Delegate.Remove 静态方法。这些方法中的每一个都返回一个新的委托实例，而不是修改传递给它的那个。

此外，.NET 中对象引用的分配是[原子](https://stackoverflow.com/questions/14370575/why-are-atomic-operations-considered-thread-safe)的，添加和删除事件访问器的默认实现是[同步](http://www.albahari.com/threading/part2.aspx)的。因此，上面的代码通过首先将多播委托从事件复制到临时变量来成功。在此之后对 SomeEvent 的任何更改都不会影响您制作和存储的副本。因此，您现在可以安全地测试是否有任何委托已注册并随后调用它们。

请注意，此解决方案解决了一个竞争问题，即事件处理程序在调用时为空。它不处理事件处理程序在被调用时失效或事件处理程序在获取副本后订阅的问题。

例如，如果事件处理程序依赖于处理程序取消订阅后立即销毁的状态，则此解决方案可能会调用无法正常运行的代码。有关更多详细信息，请参阅[Eric Lippert 的出色博客条目](http://blogs.msdn.com/ericlippert/archive/2009/04/29/events-and-races.aspx)。另外，请参阅[此 StackOverflow 问题和答案](https://stackoverflow.com/questions/786383/c-events-and-thread-safety)。

编辑：如果您使用的是 C# 6.0，那么[Krzysztof 的回答](https://stackoverflow.com/a/32421409/13118)看起来是个不错的选择。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-09-06T08:09:08.557

在 C# 6.0 中，您可以使用单子 Null 条件运算符`?.`来检查 null 并以简单且线程安全的方式引发事件。

```
SomeEvent?.Invoke(this, args); 
```

它是线程安全的，因为它只对左侧进行一次评估，并将其保存在一个临时变量中。[你可以在这里](https://github.com/dotnet/roslyn/wiki/New-Language-Features-in-C%23-6)阅读更多标题为 Null 条件运算符的内容。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-12T06:01:02.380

删除此空检查的最简单方法是将事件处理程序分配给匿名委托。所产生的惩罚非常少，并且可以免除您所有的空检查、竞争条件等。

`public event EventHandler SomeEvent = delegate {};`

相关问题：[在事件声明中添加匿名空委托是否有不利之处？](https://stackoverflow.com/questions/170907/is-there-a-downside-to-adding-an-anonymous-empty-delegate-on-event-declaration)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T00:53:10.380

推荐的方式有点不同，使用临时如下：

```
EventHandler tmpEvent = SomeEvent;
if (tmpEvent != null)
{
    tmpEvent();
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-12T02:53:46.487

更安全的方法：

```
 public class Test
{
    private EventHandler myEvent;
    private object eventLock = new object();

    private void OnMyEvent()
    {
        EventHandler handler;

        lock(this.eventLock)
        {
            handler = this.myEvent;
        }
        if (handler != null)
        {
            handler(this, EventArgs.Empty);
        }
    }

    public event MyEvent
    {
        add
        {
            lock(this.eventLock)
            {
                this.myEvent += value;
            }
        }
        remove
        {
            lock(this.eventLock)
            {
                this.myEvent -= value;
            }
        }

    }
} 

```

-账单

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-08T11:25:31.693

我想通过使用 EventHandler 的扩展函数来建议对 RoadWarrior 的回答稍作改进：

```
public static class Extensions
{
    public static void Raise(this EventHandler e, object sender, EventArgs args = null)
    {
        var e1 = e;

        if (e1 != null)
        {
            if (args == null)
                args = new EventArgs();

            e1(sender, args);
        }                
    }
  } 
```

有了这个范围的扩展，可以简单地通过以下方式引发事件：

类 SomeClass { 公共事件 EventHandler MyEvent;

```
void SomeFunction()
{
    // code ...

    //---------------------------
    MyEvent.Raise(this);
    //---------------------------
} 
```

}

[c#](/questions/tagged/c%23 "显示标记为“c#”的问题") [事件](/questions/tagged/events "显示标记为“事件”的问题")

# lucene - 对与 Lucene 或 Solr 一起使用的爬虫工具的建议？

> ID：282654
> 
> 赞同：16
> 
> 时间：2008-11-12T00:50:36.407
> 
> 标签：lucene, solr, web-crawler

对 HTML 和 XML 文档（本地或基于 Web）使用并在 Lucene / Solr 解决方案空间中运行良好的爬虫（蜘蛛）是什么？可以是基于 Java 的，但不是必须的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T21:28:16.720

在我看来，这是一个非常重要的漏洞，它阻碍了 Solr 的广泛采用。新的 DataImportHandler 是导入结构化数据的良好第一步，但 Solr 没有一个好的文档摄取管道。Nutch 确实有效，但是 Nutch 爬虫和 Solr 之间的集成有点笨拙。
我已经尝试了所有我能找到的开源爬虫，但它们都没有与 Solr 开箱即用地集成。
密切关注 OpenPipeline 和 Apache Tika。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T21:06:02.113

我试过 nutch，但很难与 Solr 集成。我会看看Heritrix。它有一个广泛的插件系统，可以很容易地与 Solr 集成，而且它的爬行速度要快得多。它广泛使用线程来加快进程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T01:19:12.947

我建议您查看[Nutch](http://lucene.apache.org/nutch/about.html)以获得一些灵感：

> Nutch 是开源网络搜索软件。它建立在 Lucene Java 之上，添加了 Web 特性，例如爬虫、链接图数据库、HTML 和其他文档格式的解析器等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T17:33:38.137

还要检查 Apache Droids [ [http://incubator.apache.org/droids/]——](http://incubator.apache.org/droids/])这希望不是一个简单的蜘蛛/爬虫/工人框架。

它是新的，现成的还不容易使用（需要一些时间才能运行），但值得关注。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T01:02:18.883

Nutch 可能是您最接近的匹配项，但它不太灵活。

如果你需要更多东西，你将不得不破解你自己的爬虫。它并不像听起来那么糟糕，每种语言都有网络库，所以你只需要连接一些任务队列管理器与 HTTP 下载器和 HTML 解析器，这并不是真正的工作。你很可能只需要一个盒子就可以逃脱，因为爬行主要是带宽密集型的，而不是 CPU 密集型的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-03T20:27:03.303

[http://arachnode.net](http://arachnode.net)

C#，但生成 Lucene（Java 和 C#）可使用的索引文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-08T11:17:22.410

有人试过Xapian吗？它的接缝比 solr 快得多，并且是用 c++ 编写的。

# oracle - 使用哪个 Web 服务器，用于 Oracle 应用程序

> ID：282659
> 
> 赞同：3
> 
> 时间：2008-11-12T00:52:36.887
> 
> 标签：oracle, jakarta-ee

我对 J2ee 网络服务器感到困惑！我从 sun 下载了一个免费的 Glassfish 服务器，然后作为一名 Oracle 开发人员下载了最新的 JDeveloper，它带有一个来自 BEa/Oracle 的 Weblogic 服务器。一个是免费的，另一个需要 1000 美元。真正的区别是什么。

我想为我的 Oracle 数据库 10g 编写一个 SOAP 接口，我可以不用 Glassfish 服务器吗，为什么要使用 Weblogic 服务器，这与用于 J2EE 应用程序的 Oracle 应用程序服务器有何不同。

如您所见，至少可以说我很困惑，并且希望得到任何启发。我是一名经验丰富的 SQL PL/SQL 开发人员，但对 Java 不熟悉，因此在这方面缺乏一定的知识。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T04:45:08.040

就个人而言，如果您正在寻找开源 J2EE 应用程序服务器，我会倾向于选择 JBoss，因为它拥有更大的市场份额，这使得您更有可能找到这样的人可以回答问题或已完成某些特定任务并已发布说明。

在大多数情况下，如果您正在编写一个纯 J2EE 应用程序，那么对于开发人员来说，您部署到什么应用程序服务器是相对透明的。如果您决定利用应用程序服务器特定的扩展，那么应用程序服务器的选择可能对开发人员很重要，但大多数 Java 商店都使用相当普通的设置，可以在应用程序服务器之间合理轻松地移动。如果您想采用特定应用程序服务器的扩展，可能会获得一些性能/生产力提升，以换取生产力损失。

更可能关心您使用的应用程序服务器的人是管理员。不同的应用程序服务器具有非常不同的管理界面（以及不同级别的管理复杂性和可配置性）。网站越大，应用程序越重要，这类事情就越多。不同的应用服务器也有不同的 JVM 实现，具有不同的性能特征。您还需要支付支持费用。即使您使用像 JBoss 这样的免费应用程序服务器，如果您在那里部署任务关键型应用程序，您也可能需要购买支持合同。如果您正在部署较小规模的东西，您可以放心地依赖免费的帮助资源（即 Google、Stackoverflow 等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T09:50:19.437

这应该可以消除您对 Weblogic 和 Oracle 应用服务器的困惑。 [Oracle 会淘汰 10gAS 以支持 WebLogic 吗？](https://stackoverflow.com/questions/231812/will-oracle-retire-10gas-in-favor-of-weblogic)Weblogic 是 Oracle 未来的战略 J2EE 平台。

我不特别了解 Glassfish 或 JBoss，但 Oracle 和 Weblogic 应用服务器都将提供一套完全集成的功能，包括 SOA、安全性、网格/集群、系统管理和开发工具，而不仅仅是标准 J2EE 容器。更不用说非常高标准的客户支持了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T17:53:54.587

If you just want to write SOAP interface, you don't need to use glassfish because it's application server,and has a lot of J2EE stuff which is just slow down request processin. You could use lightweigh web application containers like Jetty and Tomcat. Also you could use any soap endpoint implementation AXIS,XFIRE and etc.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T09:19:20.653

我认为 Glassfish 是一个比 JBoss 更好的 J2EE 应用服务器。JBoss 是一个大而复杂的应用程序，而 Glassfish 更小，我发现它更容易理解。

但我同意 JBoss 的文档和市场份额更好。

各种商业 J2EE 应用程序服务器更适合大型生产环境，在开发应该独立于应用程序服务器的 J2EE 应用程序时，它们显得过于矫枉过正。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-16T07:25:24.133

虽然这是一个有点老的问题，但想分享一些细节。

**Glassfish**服务器与 Java 企业版捆绑在一起。您可以使用它进行大多数通用 Java 相关开发。

但是，**WebLogic 服务器**与 Oracle 企业应用程序套件捆绑在一起，并且需要商业许可才能在生产环境中使用。它是一个强大且功能齐全的应用服务器，您可以在其中配置以启用身份验证提供程序、SSO 服务并部署 Oracle 企业套装产品。

因此，用法很明确，前者用作开源开发环境，后者用作商业企业级服务器。
但是，在高事务、企业级服务中，最好使用 Jboss 等应用程序服务器而不是 Glassfish。至少这是我的偏好。

# mysql - 在 MySQL 中使用 varchar 代替日期字段类型

> ID：282660
> 
> 赞同：2
> 
> 时间：2008-11-12T00:52:43.563
> 
> 标签：mysql, date, varchar

是否有任何理由在 MySQL 中使用 varchar 字段而不是日期字段？我正在查看现有网站，我看到开发人员已经这样做了。有什么理由吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T00:58:56.873

除非它真的*主要*作为一个字符串——比如说，它想要保留日期格式样式、以语言环境命名的月份、命名的时区等，并且不关心可计算性——不，varchar 不是一个好的选择。

处理真实日期数据类型在不同的 DBMS/数据访问层之间可能存在问题/不可移植，但通常的解决方案是使用整数（Unix 样式）时间戳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T00:54:22.840

因为日期是一个棘手的话题，会给开发人员带来无穷无尽的困惑？上面的例子对我来说似乎很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T00:58:53.987

我见过很多“开发人员转为 DBA”类型的人完全滥用数据库类型，只是因为缺乏经验。

# c - 如何从用户扫描两个数组？

> ID：282667
> 
> 赞同：0
> 
> 时间：2008-11-12T00:55:53.773
> 
> 标签：c, arrays, loops, user-input

我对编程比较陌生，我必须编写一个函数来读取用户的输入并填充两个数组然后比较它们。我想我很困惑的是如何在两个数组中读取。

这是我应该做的，

编写一个 table_diff 函数，比较两个整数数组并返回它们第一个不同处的下标。如果数组相同，则函数应返回 -1 例如：

345 & 345 --> -1（相同）

345 & 346 --> 2（在索引 2 处不同）

1234 & 123 --> 3（在索引 3 处不同）

这就是我所拥有的，任何帮助表示赞赏！

```
while((r = scanf("%i", &value)) != 1 && ptra < endptra)
{
     *ptra ++ = value;                      

     if (r==1)
         printf("No room after reading values\n\n");
     else if(r != EOF)
         printf("invalid char");
}   

while((r = scanf("%i\n", &value))!= 1 && ptrb < endptrb){
    *ptrb ++ = value;

    if (r==1)
        printf("No room after reading values\n\n");       
    else if(r != EOF)
        printf("invalid char");                      
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T01:40:13.187

我认为您想将代码更改为以下内容：

```
while((r = scanf("%i", &value)) != 1 && ptra < endptra)
{
     *(ptra++) = value;                      

     if (r==1)
         printf("No room after reading values\n\n");
     else if(r != EOF)
         printf("invalid char");
}   

while((r = scanf("%i\n", &value))!= 1 && ptrb < endptrb){
    *(ptrb++) = value;

    if (r==1)
        printf("No room after reading values\n\n");       
    else if(r != EOF)
        printf("invalid char");                      
} 
```

运算符的`*`优先级高于`++`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T01:18:13.213

这并不能真正回答您的问题，但是在您的“while”条件下，您已经检查了“r！= 1”，因此在 while 块中，检查“if(r == 1) ...”是不必要的，和技术上无法访问的代码。

该计划的重点是什么？现在的样子，你读入数组 ptra 直到一个空行，然后读入 ptrb 直到一个空行......然后你说你需要比较两者，但你的意思是什么？结果应该是什么？逐项比较数组？还是仅按内容而不是按位置？需要更多信息...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T01:47:32.813

另外，你`copy - paste`这里有一个案例。你做同样的事情两次。你这样做呢？使用通用代码编写一个函数，并仅使用相应的参数调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T01:55:22.187

看起来您缺少实际的检查部分。现在您已经读取了每个数组，您应该使用另一个循环遍历它并检查每个数组中的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T16:16:00.860

我不认为 scanf 像你认为的那样工作。不看你如何输入就很难说；为了像这样循环，我认为您需要在每个整数输入后发送一个 EOF（来自标准输入的 CTRL-D）。如果这就是你这样做的方式，那么唯一会终止你的循环的是指针比较。你有一个已知的最大数组大小吗？另一方面，如果您的输入是“1234^D”，那么您最终将得到一个整数 1234 的数组条目，而不是 1、2、3、4。

最后，该 if 语句看起来像是在尝试确定循环退出的原因；如果是这样，它应该在 while 循环之外。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-18T09:37:25.933

解决编程循环问题的方法之一是我大约 15 年前在我的一门大学课程中学到的东西。那就是“**循环不变量**”。

做出一个永远正确的陈述。在循环内部，条件可能会改变，但请确保如果您进行下一次迭代，您的不变量再次有效。

喜欢：

“数组的前 i 个位置相同”

所以从 0 开始（始终为真），并在循环期间首先检查第一个位置是否相同。如果为真，您可以将“i”变量增加一。对 2nd 等做同样的事情。所以基本上 i 变量确定将检查哪个下一个索引。

我相信互联网会提供一些更好的例子，但它可能会帮助你，同时提高你的开发人员技能。

# javascript - 对 DOM 节点进行排序的最简单方法？

> ID：282670
> 
> 赞同：71
> 
> 时间：2008-11-12T00:58:44.597
> 
> 标签：javascript, dom

如果我有这样的列表：

```
<ul id="mylist">
    <li id="list-item1">text 1</li>
    <li id="list-item2">text 2</li>
    <li id="list-item3">text 3</li>
    <li id="list-item4">text 4</li>
</ul> 
```

根据我的喜好重新排列 DOM 节点的最简单方法是什么？（这需要在页面加载时自动发生，列表顺序首选项是从 cookie 中获得的）

例如

```
<ul id="mylist">
    <li id="list-item3">text 3</li>
    <li id="list-item4">text 4</li>
    <li id="list-item2">text 2</li>
    <li id="list-item1">text 1</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-11-12T01:23:32.113

尽管使用 JS 库可能有更简单的方法来做到这一点，但这里有一个使用 vanilla js 的工作解决方案。

```
var list = document.getElementById('mylist');

var items = list.childNodes;
var itemsArr = [];
for (var i in items) {
    if (items[i].nodeType == 1) { // get rid of the whitespace text nodes
        itemsArr.push(items[i]);
    }
}

itemsArr.sort(function(a, b) {
  return a.innerHTML == b.innerHTML
          ? 0
          : (a.innerHTML > b.innerHTML ? 1 : -1);
});

for (i = 0; i < itemsArr.length; ++i) {
  list.appendChild(itemsArr[i]);
} 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2018-05-02T05:38:40.417

使用 es6 语法来处理孩子：

```
var list = document.querySelector('#test-list');

[...list.children]
  .sort((a,b)=>a.innerText>b.innerText?1:-1)
  .forEach(node=>list.appendChild(node)); 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-11-12T03:32:41.447

您可能会发现对 DOM 节点进行排序的效果不佳。另一种方法是在您的 javascript 中包含一个数组，该数组表示将进入 DOM 节点的数据，对该数据进行排序，然后重新生成包含 DOM 节点的 div。

也许你没有那么多节点要排序，所以没关系。我的经验是基于尝试通过操纵 DOM 对 HTML 表格进行排序，包括具有数百行和几十列的表格。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-06-15T14:18:44.870

在行动中看到它：http: [//jsfiddle.net/stefek99/y7JyT/](http://jsfiddle.net/stefek99/y7JyT/)

```
 jQuery.fn.sortDomElements = (function() {
        return function(comparator) {
            return Array.prototype.sort.call(this, comparator).each(function(i) {
                  this.parentNode.appendChild(this);
            });
        };
    })(); 
```

**简洁**

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-09-19T09:34:16.857

我的版本，希望对其他人有用：

```
var p = document.getElementById('mylist');
Array.prototype.slice.call(p.children)
  .map(function (x) { return p.removeChild(x); })
  .sort(function (x, y) { return /* your sort logic, compare x and y here */; })
  .forEach(function (x) { p.appendChild(x); }); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-01-04T18:40:29.663

如果您已经在使用 jQuery，我建议您使用 tinysort：[http ://tinysort.sjeiti.com/](http://tinysort.sjeiti.com/)

```
$("li").tsort({order:"asc"});
$("li").tsort({order:"desc"}); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-08-31T16:15:54.710

这是一个用于对 DOM 节点进行适当排序的 ES6 函数：

```
const sortChildren = ({ container, childSelector, getScore }) => {
  const items = [...container.querySelectorAll(childSelector)];

  items
    .sort((a, b) => getScore(b) - getScore(a))
    .forEach(item => container.appendChild(item));
}; 
```

以下是您如何使用它[按分数对未开发的用户评论](https://untappd.com/user/LukeTheLush)进行排序：

```
sortChildren({
  container: document.querySelector("#main-stream"),
  childSelector: ".item",
  getScore: item => {
    const rating = item.querySelector(".rating");
    if (!rating) return 0;
    const scoreString = [...rating.classList].find(c => /r\d+/.test(c));
    const score = parseInt(scoreString.slice(1));
    return score;
  }
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-04T13:42:57.920

如果这会给表格带来任何新的东西，而无需过多分析，我通常使用这个：

```
function forEach(ar, func){ if(ar){for(var i=ar.length; i--; ){ func(ar[i], i); }} }
function removeElement(node){ return node.parentNode.removeChild(node); }
function insertBefore(ref){ return function(node){ return ref.parentNode.insertBefore(node, ref); }; }

function sort(items, greater){ 
    var marker = insertBefore(items[0])(document.createElement("div")); //in case there is stuff before/after the sortees
    forEach(items, removeElement);
    items.sort(greater); 
    items.reverse(); //because the last will be first when reappending
    forEach(items, insertBefore(marker));
    removeElement(marker);
} 
```

其中 item 是同一父级的子级数组。我们从最后一个开始删除并从第一个开始附加，以避免在屏幕上可能出现的顶部闪烁。我通常会像这样得到我的 items 数组：

```
forEachSnapshot(document.evaluate(..., 6, null), function(n, i){ items[i] = n; }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-04T18:18:45.693

我能想到的最简洁的方法：

参数`compare`就像[Array.sort()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort)中使用的比较函数。

对子节点进行排序。

```
/**
 * @param {!Node} parent
 * @param {function(!Node, !Node):number} compare
 */
function sortChildNodes(parent, compare) {
  const moveNode = (newParent, node) => {
    // If node is already under a parent, append() removes it from the
    // original parent before appending it to the new parent.
    newParent.append(node);
    return newParent;
  };
  parent.append(Array.from(parent.childNodes) // Shallow copies of nodes.
                    .sort(compare) // Sort the shallow copies.
                    .reduce(moveNode, document.createDocumentFragment()));
} 
```

对子元素（子节点的子集）进行排序。

```
/**
 * @param {!Element} parent
 * @param {function(!Element, !Element):number} compare
 */
function sortChildren(parent, compare) {
  const moveElement = (newParent, element) => {
    // If element is already under a parent, append() removes it from the
    // original parent before appending it to the new parent.
    newParent.append(element);
    return newParent;
  };
  parent.append(Array.from(parent.children) // Shallow copies of elements.
                    .sort(compare) // Sort the shallow copies.
                    .reduce(moveElement, document.createDocumentFragment()));
} 
```

# google-maps - 如何在 Google Maps / MS Virtual Earth 上显示一些 shapefile / Well-Known-Text 数据？

> ID：282676
> 
> 赞同：3
> 
> 时间：2008-11-12T01:00:48.740
> 
> 标签：google-maps, geography, virtual-earth

我有一些 shapefile（美国的人口统计/热图数据，例如纽约的犯罪）数据导入 sql server 2008 数据库，字段数据类型：*Geography*。

我怎样才能从*选择*查询中以我可以在谷歌地图或微软虚拟地球上显示的格式获取这些数据？

谢谢！

编辑 1：到目前为止，最好的解决方案是使用（免费）第 3 方 dll（[SharpMap](http://www.codeplex.com/SharpMap)）。我希望有人可能会在 sql2008 中建议一些 sql 技巧以兼容格式返回它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T13:21:56.890

Geri Langlois 的 Sharpmap 链接是 0.9 如果你想要最前沿，存储库在这里： [http ://sharpmapv2.googlecode.com/svn](http://sharpmapv2.googlecode.com/svn)

此外，在开始将坐标信息放入 KML 之前，您必须确保您的数据是 Lat/Long WGS84 而不是其他数据。我不知道在 SQLServer2008 中这样做的方法（可能需要使用[ogr2ogr](http://www.gdal.org)）。

使用 STX 和 STY，您可能可以为 KML 生成一些坐标标签

```
select SHAPE.STX as X
    ,SHAPE.STY as Y
    ,SHAPE.STAsText() as WKT
    ,SHAPE.AsGml() as GML
from dpu.SW_SERVICE_LOCATIONS 
```

也许是这样的：

```
SELECT '<coordinates>'+convert(varchar,convert(decimal(20,6), SHAPE.STX),1)+
    ','+ convert(varchar,convert(decimal(20,6), SHAPE.STY),1) 
    + '</coordinates>'
FROM sw_service_locations; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T01:11:30.257

看看[这篇文章](http://geekswithblogs.net/JuanDoNeblo/archive/2008/04/13/showing-esri-shapefile-layers-on-a-virtual-earth-map.aspx)——我成功地用它来读取 shapefile 并将它们显示在 Virtual Earth 上。这应该让您了解如何将形状文件数据叠加到虚拟地球上。

要使用 sql server 2008 空间数据，我会查看codeplex上的[SharpMap项目。](http://www.codeplex.com/SharpMap)这些是我引用的帖子中使用的工具，它们确实支持 sql server 数据类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T01:32:56.010

最简单的方法是选择 XML，然后将数据转换为 GeoRSS 或 KML。Virtual Earth 和 Google Maps 都支持 KML，因此这可能是最简单的方法。

不过也有考虑。如果您的数据中有很多顶点，您可能希望实现某种 AJAX 方法来仅检索地图视图中的数据。您可以概括 SQL 2008 中的数据，以根据您的缩放级别制作较少数量的顶点。如果您缩小到国家级别，则不需要像放大到城镇一样多的细节。

[MapDotNet](http://www.mapdotnet.com/Pages2.0/Index.aspx)具有许多功能，可以更轻松地在虚拟地球地图中获取数据。执行选择查询并根据需要显示数据相对容易。我敢肯定还有其他类似的谷歌地图产品，但我没有亲自使用过。它支持多边形和热图，并为您提供比仅使用虚拟地球更多的功能。Virtual Earth 功能强大，但有很多 GIS 工具，具有地图背景的人会认为您必须自己编写程序。

# php - 添加动态视频内容（YouTube 之类）（PHP）

> ID：282683
> 
> 赞同：3
> 
> 时间：2008-11-12T01:07:57.323
> 
> 标签：php, flash, mp3, flv

我正在为网站上的用户设置视频上传，并希望通过 Flash 播放器查看他们。该站点已经部分构建（由其他人），我想知道有哪些技术可以处理视频文件，特别是在 PHP 中。

我认为这些文件需要转换为 FLV。之后我认为它只是加载 FLV，就像 Flash 中的 SWF。

他们还想用 Flash 流媒体制作 mp3，所以如果它也能支持 mp3 就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T01:13:36.203

[ffmpeg](http://ffmpeg.mplayerhq.hu/)是适合您的工具。它是许多其他工具所基于的主要开源视频编码库。直接使用有点棘手，但我认为有一些包装器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T01:28:03.787

除了 Daniels 的回答，我建议您检查[ffmpeg-php](http://ffmpeg-php.sourceforge.net/)，它是 PHP 的包装库，它添加了一个面向对象的 API，用于使用[ffmpeg](http://ffmpeg.mplayerhq.hu/)从视频和音频文件中访问和检索信息。

您可以做很多事情，从格式之间的转换、获取缩略图的视频帧图像等等……

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T10:08:27.527

您是否尝试过[SWFObject](http://code.google.com/p/swfobject/)来显示 FLV？最近在一个项目中使用了它，它就像一个魅力。也很容易配置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-12T06:56:40.807

我实际上发现使用其他服务对文件进行编码是最简单的选择，也是最快的设置。我最终使用[Hey!Watch](http://heywatch.com)这个项目。我还没有担心流媒体服务器/服务，因为在大多数情况下，视频都很短，人们不会在视频中跳来跳去。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-24T22:42:20.673

[这篇](https://stackoverflow.com/questions/1146468/making-a-video-sharing-site-need-a-videoplayer/1146903#1146903)被高度低估的帖子包含 3 个很棒的开源解决方案链接，就像 youtube 一样，非常适合您的问题（以及至少[另一个](https://stackoverflow.com/questions/1182002/online-video-streaming)问题）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T01:47:29.303

使用 YouTube API，让他们为您完成繁重的工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-09T21:48:05.533

仅供参考：如果您有 HQ 视频，则无需将它们编码为 FLV。Flash Player 10 内置了 H264 支持，这是 HQ 在流行的视频网站中所做的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-09T22:49:19.993

*   对于将电影转换为 flv 我建议（就像以前的大多数人一样）[ffmpeg](http://ffmpeg.org/)
*   您可以通过 http 流式传输这些 flv，但随后用户无法在电影中向前跳过。你需要像[FlashMediaServer](http://www.adobe.com/products/flashmediaserver/)或[Red5](http://www.red5.org/)这样的流媒体服务器。（这些服务器也比纯 HTTP 更高效）
*   最后，您需要播放流的 FlashMovie。自己写一个很容易，或者你选择了一个开源/免费的播放器。（例如：[JW 播放器](http://www.longtailvideo.com/players/jw-flv-player/)）

# apache-flex - 如何在 FLEX 中创建带有富文本的列表控件？

> ID：282690
> 
> 赞同：0
> 
> 时间：2008-11-12T01:12:42.680
> 
> 标签：apache-flex, actionscript, flex3

我是 FLEX 新手，正在尝试将基于 Javascript 的原型移植到 FLEX 中。我的原始原型有一个无序列表 (ul)，其中包含包含富文本的列表项，即我在每个项中混合了不同样式和颜色的文本以及一些图像。我查看了 FLEX 的 List 控件，它只支持显示一个简单的字符串和一个图标。我将如何制作支持富文本的列表控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T01:37:54.877

还没有帮助？我创立了它。它被称为 ItemRenderers [http://livedocs.adobe.com/flex/3/html/help.html?content=cellrenderer_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=cellrenderer_1.html)

很像 Java Swing 中的渲染。

# boolean - 布尔表达式

> ID：282692
> 
> 赞同：3
> 
> 时间：2008-11-12T01:14:12.863
> 
> 标签：boolean, logic

你怎么能用布尔逻辑表达 Y 中的 X 是真的？像以下 2 条这样的规则必须为真（A、B、C、D、E、F）它是乘法还是集合运算的一种形式？
最终结果是所有排列，如 AB OR AC OR AD，如果你说 3 跟随它就像 ABC、ABD、ABE 等。所以它就像 (A,B,C)^2？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T01:34:21.137

在布尔逻辑中（**v**是 OR，**'**后面的谓词是 NOT）：

```
A B C'D'E'F' v
A B'C'D'E'F  v
A'B C'D'E'F' v
: : : : : :
<absolute bucketload of boolean expressions>
: : : : : :
A'B'C'D'E F 
```

通过排列，您需要编写大量子表达式。

当然，如果这是一个编程问题，您可以将布尔值转换为 0 或 1，将它们全部相加并确保结果为 2。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T01:39:59.427

假设 C# 或 bool != int 的其他语言：

```
bool nOf(int n, bool[] bs)
{
    foreach(bool b in bs)
    {
      if((n -= b ? 1 : 0) <= 0) break;
    }
    return n == 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T02:27:56.180

Python：

```
expressions = [A, B, C, D, E, F, G ]
numTrue = len(filter(None, expressions) 
```

PHP：

```
$expressions = array(A, B, C, D, E, F, G);
$numTrue = count(array_filter($expressions)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T01:32:24.823

你有这个想法。要表达“n 中的 k 个”，您将需要列举所有 k 成立的案例。所以，如果我们有变量 ABCDE，并且你想要 3 of 5，你需要

```
(A  &  B &  C & ~D & ~E) |
(A  &  B & ~C &  D & ~E) |
(A  &  B & ~C & ~D &  E) | ...
(~A & ~B &  C &  D &  E) 
```

其中 & 是“和”，| 是“或”，〜是“不是”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T01:33:25.447

假设“A或更多”

你可以通过建造一棵树来做得更好

```
2 : a&(b|c|d|e|f) | b&(c|d|e|f) | c&(d|e|f) | d&(e|f) | e*f
3 : a&(b&(c|d|e|f) | c&(d|e|f) | d&(e|f) | e*f) | b&(c&(d|e|f) | d&(e|f) | e*f) | c&(d&(e|f) | e*f) | d&e&f 
```

或作为代码

```
bool AofB(int n, bool[] bs)
{
   if(bs.length == 0) return false;
   if(n == 0) return true;

   foreach(int i, bool b; b[0..$-n])
      if(b && AofB(n-1,b[i+1..$]) return true;

   return false;
} 
```

更好

```
bool AofB(int n, bool[] bs)
{
   foreach(bool b; bs) if(b && --n == 0) return true;
   return false;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T21:14:40.827

我会数他们。但是，如果您必须仅使用布尔运算生成谓词，那么您可以将输入视为加法器系统中的位。

```
Basic Half-Adder

A, B : 1st 2nd bits
O, C : unit output and carry to next unit

O := A xor B;
C := A and B; 
```

您可以在 [Wikipedia][ [http://en.wikipedia.org/wiki/Half_adder](http://en.wikipedia.org/wiki/Half_adder) (Half-Adder)]找到更多示例和链接

然后你可以将这六个变量分成三对，然后弄清楚如何使用这些输出来更接近答案并自己解决其余的问题。

另一种选择是使用电路来查找弹出计数（横向添加）并检查唯一的位是否与 2 匹配。组装而不是逻辑门的著名示例是 [Hakmem 169][ [http://home.pipeline.com /~hbaker1/hakmem/hacks.html#item169](http://home.pipeline.com/~hbaker1/hakmem/hacks.html#item169) (popcount)]。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T20:29:17.697

您的意思是“恰好两个必须为真”还是“至少两个必须为真”会有所不同。

对于变量集 {A..F}，Pax 和 Charlie Martin 的回答涵盖了“正好两个”的情况（两个为真，其余为假），而您问题中的表达式似乎处理“在至少两个”案例：

```
(A && B) || (A && C) || ... || (D && E) || (D && F) || (E && F) 
```

例如，当 A 和 B 为真且其余变量为任意值（真或假）时，该表达式为真。

如果您要求的是一个类似集合论的表达式来*描述*上述情况，您可以这样表达：

```
#{x | x <- {A, B, C, D, E, F} | x} = 2 
```

符号以这种方式工作的地方：

```
#{...} 
```

表示封闭集合的大小，以及集合本身：

```
{x | x <- {A, B, C, D, E, F} | x} 
```

读取“的集合`x`，其中`x`一个是`A`通过`F`，并且`x`是真的”。换句话说，给定变量集`A`到`F`，由具有真值的变量组成的子集正好有两个元素。（使用`<=`而不是 '=' 来表达您问题的其他解释。）

# php - 如何从 Perl 或 PHP 调用 c++ 二进制文件（在 Linux 上使用 Apache 的 CGI-BIN）？

> ID：282696
> 
> 赞同：1
> 
> 时间：2008-11-12T01:17:04.573
> 
> 标签：php, c++, perl, cgi-bin

我有一个用 c++ 编写的网站 cgi-bin 程序。

不幸的是，我朋友网站的网站提供商只允许 Perl 或 PHP cgi-bin 脚本。

有没有一种简单的方法来简单地拥有一个非常小的 Perl 或 PHP 包装器，它只调用 c++ 编译的二进制文件？

c++ 程序是否仍然能够从标准输入读取 POST 命令，还是必须由 Perl 或 PHP 读取然后转发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T01:31:40.520

您可以使用 Perl 的反引号或“系统”命令来运行 shell 命令。此外，perl 有很多“内联”类，允许您用其他语言编写代码以在 perl 中调用，包括用于[C++](http://search.cpan.org/~neilw/Inline-CPP-0.25/)的一个。如果您找不到有用的东西，也许您可​​以使用该包制作自己的包装器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T01:21:50.663

你可以使用 PHP 的 system() 函数来执行一个 shell 命令，你可以用它来启动另一个程序。然后该程序的 STDOUT 将转到与 php 的 stdout 相同的位置（到 HTTP 连接）。你可能不得不做一些事情来让标准输入从 get/post/etc 中读取。

但很可能网站提供商已禁用您以这种方式执行程序的能力。这可能是一个安全风险，如果他们专门只允许 php 和 perl，那么他们可能会专门禁用尽可能多的运行非 php/perl 的方法。所以，简短的回答是你可能不走运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T02:09:07.433

有关解决我的问题的一些 PHP 代码，请参阅我的[Awstats Wrapper](http://blog.matthewsmith.id.au/2008/02/15/awstats-wrapper/)博客文章。我的方法是构建一个命令行，该命令行从 CGI 查询参数中设置了正确的环境变量，然后对结果输出进行替换，这样任何返回 CGI 的链接都会转到我的包装脚本。由于 PHP 提供了自己的标头，因此我还对 CGI 的标头输出进行了核对。

# c++ - ld：重复符号

> ID：282700
> 
> 赞同：14
> 
> 时间：2008-11-12T01:17:53.700
> 
> 标签：c++, xcode, linker

我正在做一个学校项目，我从 Xcode 中得到了一些奇怪的错误。我正在使用 TextMate 的 Command+R 函数来编译项目。编译似乎工作正常，但链接失败并出现我不明白的错误消息。

ld输出：

> ld：在 /path/final/build/final.build/Release/final.build/Objects-normal/ppc/generics.o 和 /path/final/build/final 中重复符号 text_field(std::basic_istream >&)。 build/Release/final.build/Objects-normal/ppc/main.o collect2：ld返回1退出状态

下面是我的文件io_functions.cpp，这是整个项目中唯一的text_field声明。

```
#include <string>
#include <iostream>
#include <iomanip>

using namespace std;

#ifndef ENDF
#define ENDF '|'
#define ENDR '\n'

/**
reads one field from a given input stream
Usage: var = text_field(in)
*/
string text_field(istream &in){
    string s;
    getline(in, s, ENDF);
    return s; 
}

long long_field(istream &in){
    return atol(text_field(in).c_str()); 
}

int int_field(istream &in){
    return atoi(text_field(in).c_str()); 
}

double double_field(istream &in){
    return atof(text_field(in).c_str()); 
}

#endif 
```

出了什么问题？出于多种原因，我不想发布我的项目的全部源代码。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-12T01:26:54.633

我的第一个想法是你在链接器命令中包含了两次，但它似乎抱怨在`main.o`and中具有相同的功能`generics.o`。

所以看起来你正在将`io_functions.cpp`文件包含在其中`main.cpp`，`generics.cpp`这在最好的情况下是个坏主意。

您应该有一个头文件（例如`io_functions.h`），它指定包含在其中的所有内容，`io_functions.cpp`并将该*头*文件包含在另外两个中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T01:22:59.943

听起来 io_functions.cpp 被包含两次（一次由 generics.cpp，一次由 main.cpp）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-23T07:50:52.053

使用“inline”关键字修饰重复方法

```
inline string text_field(istream &in) 
```

内联函数是实际函数，其函数体的副本直接注入到调用函数的每个位置。

详情请看[文章](https://chunminchang.github.io/blog/post/how-to-avoid-duplicate-symbols-when-compiling)

# java - 哈希表的基本原理？

> ID：282712
> 
> 赞同：55
> 
> 时间：2008-11-12T01:23:45.403
> 
> 标签：java, hashtable

我对哈希表的基本概念感到很困惑。如果我要编写一个哈希，我什至会如何开始？哈希表和普通数组有什么区别？

基本上，如果有人回答了这个问题，我想我的所有问题都会得到回答：如果我有 100 个随机生成的数字（作为键），我将如何实现哈希表，为什么这比数组更有利？

伪代码或 Java 将被视为一种学习工具......

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-11-12T02:57:43.403

到目前为止的答案有助于定义哈希表并解释一些理论，但我认为一个示例可以帮助您更好地了解它们。

*哈希表和普通数组有什么区别？*

哈希表和数组都是允许您存储和检索数据的结构。两者都允许您指定*索引*并检索与其关联的值。正如 Daniel Spiewak 所指出的，不同之处在于数组的索引是*顺序*的，而哈希表的索引是基于与它们关联*的数据的值。*

*为什么要使用哈希表？*

哈希表可以提供一种非常有效的方式来搜索大量数据中的项目，尤其是在其他情况下不易搜索的数据。（这里的“Large”是指[*巨大*](http://en.wiktionary.org/wiki/ginormous)的，意思是执行顺序搜索需要很长时间）。

*如果我要编写一个哈希，我什至会如何开始？*

没问题。最简单的方法是发明一个可以对数据执行的任意数学运算，它返回一个数字`N`（通常是整数）。然后将该数字用作“桶”数组的索引，并将您的数据存储在桶 #`N`中。诀窍在于选择一个倾向于将值放置在不同存储桶中的操作，以便您以后轻松找到它们。

**示例：** 一家大型购物中心保留了顾客汽车和停车位置的数据库，以帮助购物者记住他们的停车地点。数据库存储`make`、`color`、`license plate`和`parking location`。在离开商店时，购物者通过输入其品牌和颜色来找到他的汽车。该数据库返回一个（相对较短的）车牌和停车位列表。快速扫描定位购物者的汽车。

您可以使用 SQL 查询来实现这一点：

```
SELECT license, location FROM cars WHERE make="$(make)" AND color="$(color)" 
```

如果数据存储在一个数组中，它本质上只是一个列表，您可以想象通过扫描一个数组以查找所有匹配条目来实现查询。

另一方面，想象一个哈希规则：

> 将make和color中所有字母的ASCII码相加，除以100，余数作为hash值。

此规则会将每个项目转换为 0 到 99 之间的数字，本质上将数据*分类*到 100 个桶中。每次客户需要定位汽车时，您都可以对品牌和颜色进行哈希运算，从 100*个*存储桶中找出包含该信息的存储桶。您立即将搜索量减少了 100 倍！

现在将示例扩展到大量数据，例如一个包含数百万个条目的数据库，根据数十个标准进行搜索。一个“好的”散列函数将以最小化任何额外搜索的方式将数据分配到存储桶中，从而节省大量时间。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-11-12T02:36:23.243

首先，您必须了解哈希函数是什么。哈希函数是一个函数，它接受一个键（例如，任意长度的字符串）并返回一个*尽可能唯一*的数字。相同的键必须始终返回相同的散列。java中一个非常简单的字符串散列函数可能看起来像

```
public int stringHash(String s) {
    int h = s.length();
    for(char c : s.toCharArray()) {
        h ^= c;
    }
    return h;
} 
```

[您可以在http://www.azillionmonkeys.com/qed/hash.html](http://www.azillionmonkeys.com/qed/hash.html)学习一个好的哈希函数

现在，哈希映射使用此哈希值将值放入数组中。简单的java方法：

```
public void put(String key, Object val) {
    int hash = stringHash(s) % array.length;
    if(array[hash] == null) {
        array[hash] = new LinkedList<Entry<String, Object> >();
    }
    for(Entry e : array[hash]) {
        if(e.key.equals(key)){
            e.value = val;
            return;
        }
    }
    array[hash].add(new Entry<String, Object>(key, val));
} 
```

（此映射强制执行唯一键。并非所有映射都这样做。）

两个不同的键可以散列到相同的值，或者两个不同的散列映射到相同的数组索引。有很多技术可以解决这个问题。最简单的方法是为每个数组索引使用链表（或二叉树）。如果散列函数足够好，您将永远不需要线性搜索。

现在查找密钥：

```
public Object get(String key) {
    int hash = stringHash(key) % array.length;
    if(array[hash] != null) {
        for(Entry e : array[hash]) {
            if(e.key.equals(key))
                return e.value;
        }
    }

    return null;
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-11-12T01:30:02.270

哈希表是*关联*的。这与数组有很大的不同，数组只是线性数据结构。使用数组，您可能会执行以下操作：

```
int[] arr = ...
for (int i = 0; i < arr.length; i++) {
    System.out.println(arr[i] + 1);
} 
```

请注意如何通过指定精确的内存偏移量 ( `i`) 从数组中获取元素。这与哈希表形成对比，哈希表允许您存储键/值对，然后根据键检索值：

```
Hashtable<String, Integer> table = new Hashtable<String, Integer>();
table.put("Daniel", 20);
table.put("Chris", 18);
table.put("Joseph", 16); 
```

使用上表，我们可以进行以下调用：

```
int n = table.get("Chris"); 
```

...并确保`n`其价值为`18`.

我想这可能会回答你的大部分问题。哈希表的实现是一个相当有趣的话题，[维基百科很好地解决了这个](http://en.wikipedia.org/wiki/Hash_table)话题。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-12T02:35:43.603

“我对哈希表查找密钥的方式以及密钥的生成方式更感兴趣。”

1.  散列将关键对象转换为数字。这称为“散列”——它对对象进行散列。请参阅[散列函数](http://en.wikipedia.org/wiki/Hash_function)。例如，对字符串的字节求和是一种标准的散列技术。您计算总和模 2 ^(32)以将散列保持在可管理的大小。哈希总是给出相同的答案。这是**O** (1)。

2.  该数字在哈希表中为您提供了一个“插槽”。给定一个任意键对象，哈希值计算一个哈希值。然后哈希值会为您提供表中的插槽。通常`mod( hash, table size )`. 这也是**O** (1)。

这是一般的解决方案。两个数值计算，你已经从任意对象作为键到任意对象作为值。很少有事情可以这么快。

从对象到哈希值的转换以这些常见方式之一发生。

1.  如果它是 4 字节的“原始”对象，则该对象的本机值是一个数字。

2.  对象的地址是4个字节，那么对象的地址可以作为哈希值。

3.  一个简单的[散列函数](http://en.wikipedia.org/wiki/Hash_function)（MD5、SHA1 等等）累积对象的字节以创建一个 4 字节的数字。高级哈希不是简单的字节总和，简单的总和并不能充分反映所有原始输入位。

哈希表中的槽是 mod( number, size of table )。

如果该插槽具有所需的值，那么您就完成了。如果这不是所需的值，则需要寻找其他地方。有几种流行的探测算法可以在表格中寻找空闲位置。线性是对下一个空闲位置的简单搜索。Quadratic 是一种寻找空闲槽的非线性跳跃。随机数生成器（具有固定种子）可用于生成一系列探针，这些探针将均匀但任意地传播数据。

探测算法不是**O** (1)。如果桌子足够大，那么碰撞的几率就会很低，探测也无关紧要。如果表太小，则会发生冲突并进行探测。到那时，就需要“调整和调整”来平衡探测和表大小以优化性能。通常我们只是把桌子变大。

请参阅[哈希表](http://en.wikipedia.org/wiki/Hash_table)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-12T02:47:03.707

我还没有看到特别指出的东西：

在数组上使用哈希表的重点是性能。

遍历数组通常需要从 O(1) 到 O(x) 的任何时间，其中 x 是数组中的项目数。但是，找到您的项目的时间会非常*多变*，特别是如果我们谈论的是数组中的数十万个项目。

一个适当加权的哈希表通常具有几乎*恒定*的访问时间，略高于 O(1)，无论哈希表中有多少项。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-12T01:30:23.690

您不希望对 100 个随机生成的数字使用哈希表。

考虑哈希表的一个好方法是考虑值对。让我们以学生为例，假设每个人都有一个学生证号码。在您的程序中，您存储有关学生的信息（姓名、电话号码、账单等）。您希望仅使用基本信息（例如姓名或学生 ID）来查找有关学生的所有信息。

假设您有 10,000 名学生。如果您将它们全部存储在一个数组中，那么您必须遍历整个数组，将每个条目的学生 ID 与您要查找的学生 ID 进行比较。

相反，如果您将他们的学生 ID 号“散列”（见下文）到数组中的某个位置，那么您只需搜索学生的编号具有相同的散列即可。找到你想要的东西的工作要少得多。

在此示例中，假设学生 ID 只是 6 位数字。我们的哈希函数只能使用数字的后 3 位作为“哈希键”。因此 232145 被散列到数组位置 145。所以你只需要一个包含 999 个元素的数组（每个元素都是一个学生列表）。

这对你来说应该是一个好的开始。当然，您应该阅读教科书或维基百科以获取此类信息。但我假设你已经这样做了，并且厌倦了阅读。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-12T02:38:27.297

简而言之，这是哈希表的工作原理。

想象一下，你有一个图书馆，里面装满了书。如果您要将书籍存储在一个阵列中，您会将每本书放在书架上的一个位置，然后当有人要求您找一本书时，您会浏览所有书架 - 非常慢。如果有人说“book #12345”，你可以很容易地找到它。

假设您说，如果书名以“A”开头，则位于第 1 行。如果第二个字母为“B”，则位于第 1 行，第 2 架。如果第三个字母为“C”，则进入第 1 行、第 2 架子、第 3 架子……以此类推，直到您确定书的位置。然后，根据书名，您可以确切地知道它应该在哪里。

现在，我描述的简单的“散列”算法存在一些问题——一些书架会超载，而另一些书架会空着，一些书会被分配到同一个插槽..所以真正的散列函数是经过精心构造的尽量避免此类问题。

但这是基本思想。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T01:31:53.920

我将回答关于哈希表和数组之间区别的那部分......但由于我以前从未实现过任何导入的哈希算法，我将把它留给更有知识的人:)

数组只是对象的有序列表。对象本身并不重要......重要的是，如果您想按插入顺序列出对象，它始终是相同的（意味着第一个元素的索引*始终*为 0）。

至于哈希表，它是按键索引的，而不是顺序...我认为对哈希算法的基本搜索会给您比我更多的洞察力...维基百科有一个非常不错的...确定“桶" 用于快速检索用作键的任意对象的键。

至于优点：如果插入顺序很重要，则需要数组或某种有序列表。如果通过任意键（由各种散列函数作为键）进行快速查找很重要，那么散列表是有意义的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T01:47:24.933

*[这是对上面me.yahoo.com/a的评论的回复]*

这取决于您的哈希函数。假设您的哈希函数根据单词的长度对单词进行哈希处理，chris 的键为 5。同样，yahoo 的键也为 5。现在，两个值（chris 和 yahoo）都将低于 5（即在由 5 键入的“桶”中）。这样，您不必使数组等于数据的大小。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-24T12:46:24.603

我相信，这个问题现在已经得到了非常清楚的回答，而且有很多不同的方式。

我只想添加另一个观点（这也可能使新读者感到困惑）

在最抽象的层次上，数组只是连续的内存块。给定单个元素的起始地址 ( `startAddress`)、大小 ( `sizeOfElement`) 和 ，`index`元素的地址计算如下：

```
elementAddress = startAddress + sizeOfElement * index 
```

这里要注意的有趣的事情是，可以将数组抽象/视为具有`index`as 键的哈希表，并将上述函数作为哈希函数计算**O(1)中值的位置**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-24T10:27:49.240

哈希表是一种为快速查找而创建的数据结构。

当条目数非常小时，哈希表无效。

[参考](https://stackoverflow.com/a/18417489/730807)

一些例子：

```
 import java.util.Collection;
    import java.util.Enumeration;
    import java.util.Hashtable;
    import java.util.Set;

    public class HashtableDemo {

    public static void main(String args[]) {

// Creating Hashtable for example

     Hashtable companies = new Hashtable();

// Java Hashtable example to put object into Hashtable
// put(key, value) is used to insert object into map

     companies.put("Google", "United States");
     companies.put("Nokia", "Finland");
     companies.put("Sony", "Japan");

// Java Hashtable example to get Object from Hashtable
// get(key) method is used to retrieve Objects from Hashtable

     companies.get("Google");

// Hashtable containsKey Example
// Use containsKey(Object) method to check if an Object exits as key in
// hashtable

     System.out.println("Does hashtable contains Google as key: "+companies.containsKey("Google"));

// Hashtable containsValue Example
// just like containsKey(), containsValue returns true if hashtable
// contains specified object as value

      System.out.println("Does hashtable contains Japan as value: "+companies.containsValue("Japan"));

// Hashtable enumeration Example
// hashtabl.elements() return enumeration of all hashtable values

      Enumeration enumeration = companies.elements();

      while (enumeration.hasMoreElements()) {
      System.out.println("hashtable values: "+enumeration.nextElement());
      }

// How to check if Hashtable is empty in Java
// use isEmpty method of hashtable to check emptiness of hashtable in
// Java

       System.out.println("Is companies hashtable empty: "+companies.isEmpty());

// How to find size of Hashtable in Java
// use hashtable.size() method to find size of hashtable in Java

      System.out.println("Size of hashtable in Java: " + companies.size());

// How to get all values form hashtable in Java
// you can use keySet() method to get a Set of all the keys of hashtable
// in Java

      Set hashtableKeys = companies.keySet();

// you can also get enumeration of all keys by using method keys()

      Enumeration hashtableKeysEnum = companies.keys();

// How to get all keys from hashtable in Java
// There are two ways to get all values form hashtalbe first by using
// Enumeration and second getting values ad Collection

      Enumeration hashtableValuesEnum = companies.elements();

      Collection hashtableValues = companies.values();

// Hashtable clear example
// by using clear() we can reuse an existing hashtable, it clears all
// mappings.

       companies.clear();
      }
     } 
```

输出：

```
Does hashtable contains Google as key: true

Does hashtable contains Japan as value: true

hashtable values: Finland

hashtable values: United States

hashtable values: Japan

Is companies hashtable empty: false

Size of hashtable in Java: 3 
```

# windows - 针对行为不端的 ColdFusion 应用程序的 Windows CPU 通知

> ID：282713
> 
> 赞同：8
> 
> 时间：2008-11-12T01:24:57.990
> 
> 标签：windows, coldfusion, monitoring, cpu, notifications

我有一个用 ColdFusion 编写的 Web 应用程序，它会定期启动 100% 的服务器 CPU 并导致 ColdFusion 服务崩溃。

由于我自己无法重现该问题，我想找到一个实用程序，它会在 CPU 使用率开始攀升时通过电子邮件通知我，这样我就可以跳上服务器，查看 FusionReactor 看看发生了什么，并识别行为不端的代码。

我已经用 Google 搜索过，但找不到合适的实用程序，所以我想问问其他程序员是否找到了可以进行这种监视的工具。鉴于我的具体需求，我不想编写自己的监控工具。

如果您对解决整体问题有其他建议，我也很乐意听到这些建议。

对答案的回应：

使用 Windows perfmon 触发命令行听起来很有希望。任何人都可以向我指出如何做到这一点的教程吗？

我们没有设置用于接收 SNMP 陷阱的监控系统。

我们正在运行 ColdFusion 8 标准版，它不包括 ColdFusion 性能监控工具——只有 Enterprise 包括那些。

Peter Boughton 的回答可能会让我解决问题，但它并不能帮助我在 CPU 开始飙升时主动解决问题，所以我仍在寻找通知解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T05:11:25.030

几周前我遇到了类似的问题，并被引导到一个名为 AlwaysUp 的程序。

[http://www.coretechnologies.com/products/AlwaysUp/](http://www.coretechnologies.com/products/AlwaysUp/)

通过以下任意组合监控任何进程：

*   内存使用
*   CPU使用率
*   反应迟钝
*   运行自定义脚本以确定是否应重置

从这里您可以重新启动服务，或发送通知电子邮件，或运行脚本来记录事情等。

他们有一个 30 天的演示，我在第二天就被卖掉了。当你找到问题的根源时，这是一个很好的快速修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T02:07:59.790

在 Windows 上，您可以使用 Windows 标配的性能和监控工具 (perfmon)。当 CPU 达到某个点时，它可以触发一个 SNMP 通知，大多数系统监控工具都可以接收到该通知并以此方式提醒您。它还可以运行命令或执行各种其他有用的事情，这可能会帮助您确定它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T09:50:53.337

如果您正在运行 Coldfusion 8 - 性能监视器，则可以使用另一种选择。您可以设置警报以根据不同的标准向您发送电子邮件、呼叫另一个 CFC 等。

我经常使用服务器监视器——它是一个很棒的工具，即使我自己并没有过多地使用警报，它们可能非常值得研究，因为它们看起来很容易设置。

至于整体方法...

在我们公司，我们使用一台服务器上的 Windows Perfmon 每 30 秒轮询一次我们所有的 CF 服务器，以获取一些指标，例如总 CPU 和平均响应时间。我们将其记录到 CSV 文件中。每隔几分钟就会运行一个计划任务，它会读取这些文件的详细信息并将它们保存到数据库表中。然后它会截断文件，使它们不会变得太大。

最后，每天一次，我们会收到一份报告，详细说明所有服务器指标到我们的技术部门，该报告绘制了我们所有服务器的 CPU 和平均响应时间。

我们发现这是将服务器性能保持在开发人员意识中并尽早发现趋势（例如 CPU 利用率低）的好方法。我们发现它非常有效，因为在您开始衡量指标之前，您无法知道自己是否表现不佳。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T23:49:47.230

您不一定需要此通知 - FusionReactor 具有日志文件，因此您可以在它发生后检查这些文件，并识别当时正在运行的脚本。

如果你不确定它什么时候发生，我很确定其中一个日志包含内存和 CPU 使用情况——虽然我现在不记得名字是什么了，但是你可以在日志中戳一下应该找到相关信息。

# code-analysis - 使用 NDepend 查找处理表单事件的所有方法

> ID：282729
> 
> 赞同：0
> 
> 时间：2008-11-12T01:32:36.617
> 
> 标签：code-analysis, ndepend, cql

我想知道是否有人能够帮助我为 NDepend 编写一个 CQL 查询，它将向我显示我的表单类中处理表单事件的所有方法。所以我希望能够找到所有看起来像这样的方法：

```
Private Sub AddFolderButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles AddFolderButton.Click 
```

我浏览了一些选项，但我真的找不到任何可以满足我需要的东西。

我才刚刚开始使用 NDepend，所以我还没有真正习惯它，但我确实知道一件事，如果没有它，我到底是如何生活的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-13T08:25:03.367

我是来自 NDepend 团队的 Patrick，我确认，到目前为止，在“方法名称 + 签名”上使用条件“Namelike + 正则表达式”是使用 CQL 实现所需功能的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T03:29:21.420

我有一些东西可以工作，但它并不是 100% 正确，因为所有表单生成的事件处理程序的名称中都有下划线，我使用下划线作为过滤器，我还过滤了名称中包含“EventArgs”的位置. 查询如下所示：

```
SELECT METHODS WHERE NameLike "_" OR NameLike "EventArgs" AND !IsSpecialName AND IsPrivate 
```

该查询几乎返回所有处理事件的方法，但我仍然想找到更正确的方法。

# php - MYSQL 中的 UPDATE 子句使用 PHP 可以在一个查询中更新多条记录吗？

> ID：282733
> 
> 赞同：0
> 
> 时间：2008-11-12T01:34:16.553
> 
> 标签：php, mysql

好吧，我有这个带有示例值的消息表，如下所示：

```
msg_id  recipient_id   read   locked   new
  0         1            N       Y      Y
  2         1            Y       N      N 
```

好的，让我们说这是一个消息表，我想重置所有发给 id=1 的收件人的消息

我想知道为什么

```
UPDATE `messages` SET `new`='Y',`read`='N',`locked`='N' where `recipient_id`=1; 
```

不起作用，MYSQL 总是返回 0 个受影响的行......谁能帮助我？

**罗伯特赌博：**是的，我确定值已更改，因为我进行此更新查询的目的是重置我用于测试阶段的数据：D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T01:39:22.500

你有一些浮动的单引号。您可能正在将一个字符串分配给另一个字符串或其他内容。

可以说

```
UPDATE messages  
SET new = 'y', read = 'N', locked = 'N'  
WHERE recipient_id = 1 
```

# cocoa - 奇怪的绑定问题

> ID：282739
> 
> 赞同：1
> 
> 时间：2008-11-12T01:36:17.657
> 
> 标签：cocoa, cocoa-bindings, key-value-coding

我正在尝试使用带有绑定的浏览器视图来表示一些数据，但我收到一条错误消息：

```
2008-11-11 17:22:28.636 BrowserViewTest[18269:813] Cocoa Bindings: Error accessing value
 for key path arrangedObjects.projects of object <NSTreeController: 0x1321e0>[object class: BillingCode] 
(from bound object <NSBrowser: 0x126930> with object ID 0 in Nib named MainMenu.nib): 
[<_NSControllerTreeProxy 0x128630> valueForUndefinedKey:]: this class is not key 
value coding-compliant for the key displayString.
2008-11-11 17:22:28.638 BrowserViewTest[18269:813] Brow view cont awakeFromNib
2008-11-11 17:22:28.639 BrowserViewTest[18269:813] project count: 0 
```

如 NSLog 输出所示，这种情况甚至发生`awakeFromNib`在我的应用程序控制器中调用之前，即使我知道 BillingCode 对于 displayString 是 KVC 兼容的。

它似乎与我的树控制器->属性->对象控制器下为“类”设置的值有关，好像我更改了该类的名称，错误消息中的名称也随之变化。`awakeFromNib`奇怪的是，据我所知，此时内容数组中不应该有任何对象，因为在被调用之前我不会添加它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T03:11:44.123

这几乎听起来像当前在您的字典中的对象类型不是您期望的类型，因此运行时无法获取键 displayString 的值我会尝试弄清楚何时将对象添加到您的字典，然后从那里找出为什么它不是您期望的类型。

# windows - 如何查找 Windows 用户是否属于指定组？

> ID：282740
> 
> 赞同：3
> 
> 时间：2008-11-12T01:36:43.740
> 
> 标签：windows

目前我们有一个 DLL，它使用 Windows API LogonUser 方法检查用户名/密码是否是有效的 Windows 用户。我们需要对其进行增强，以便它检查用户是否也属于指定的组。有没有一种 Windows 方法可以做到这一点？

给定 Windows 用户名和密码，确定用户是否属于指定组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T02:07:35.503

您可以使用 netapi32.dll 中的“NetUserGetLocalGroups”函数来获取给定用户所属的所有组，然后检查函数返回的组名中是否存在指定的组名。[你可以在这里](http://www.pinvoke.net/default.aspx/netapi32/NetUserGetLocalGroups.html)找到函数用法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T01:54:55.607

最接近的单个 API 是[CheckTokenMembership](http://msdn.microsoft.com/en-us/library/aa376389(VS.85).aspx)，它只是留下了获取用户的 SID 和组句柄的问题。

如果您可以使用 ATL，请查看[CAccessToken](http://msdn.microsoft.com/en-us/library/f42z4h7d(VS.71).aspx)类的方法……即使您不能使用它，请查看 atlsecurity.h 中的实现以获取示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T03:18:58.010

感谢 Abhijit，该功能似乎可以完成这项工作，我还找到了包含示例代码的链接：

[http://delphi.newswhat.com/geoxml/forumhistorythread?groupname=borland.public.delphi.nativeapi.win32&messageid=40914cf6@newsgroups.borland.com](http://delphi.newswhat.com/geoxml/forumhistorythread?groupname=borland.public.delphi.nativeapi.win32&messageid=40914cf6@newsgroups.borland.com)

```
unit GetGroupsForUserUnit;

interface

uses
  Windows, SysUtils, Classes, ShellAPI;

type
  {$EXTERNALSYM NET_API_STATUS}
  NET_API_STATUS = DWORD;
  LPLOCALGROUP_USERS_INFO_0 = ^LOCALGROUP_USERS_INFO_0;
  {$EXTERNALSYM LPLOCALGROUP_USERS_INFO_0}
  PLOCALGROUP_USERS_INFO_0 = ^LOCALGROUP_USERS_INFO_0;
  {$EXTERNALSYM PLOCALGROUP_USERS_INFO_0}
  _LOCALGROUP_USERS_INFO_0 = record
    lgrui0_name: LPWSTR;
  end;
  {$EXTERNALSYM _LOCALGROUP_USERS_INFO_0}
  LOCALGROUP_USERS_INFO_0 = _LOCALGROUP_USERS_INFO_0;
  {$EXTERNALSYM LOCALGROUP_USERS_INFO_0}
  TLocalGroupUsersInfo0 = LOCALGROUP_USERS_INFO_0;
  PLocalGroupUsersInfo0 = PLOCALGROUP_USERS_INFO_0;

const
  {$EXTERNALSYM MAX_PREFERRED_LENGTH}
    MAX_PREFERRED_LENGTH = DWORD(-1);
  {$EXTERNALSYM NERR_Success}
    NERR_Success = 0;
  {$EXTERNALSYM NERR_BASE}
    NERR_BASE = 2100;
  {$EXTERNALSYM NERR_UserNotFound}
    NERR_UserNotFound = (NERR_BASE+121);
  {$EXTERNALSYM NERR_InvalidComputer}
    NERR_InvalidComputer = (NERR_BASE+251);
  {$EXTERNALSYM LG_INCLUDE_INDIRECT}
    LG_INCLUDE_INDIRECT = $0001;

{$EXTERNALSYM NetUserGetLocalGroups}
function NetUserGetLocalGroups(servername: PWideChar; username: PWideChar;
  level: DWORD; flags: DWORD; var bufptr: Pointer; prefmaxlen: DWORD;
  var entriesread: DWORD; var totalentries: DWORD): NET_API_STATUS; stdcall;
{$EXTERNALSYM NetApiBufferFree}
function NetApiBufferFree(Buffer: Pointer): NET_API_STATUS; stdcall;

function GetGroupsForNetUser(uname: widestring): string;

implementation

function NetUserGetLocalGroups; external 'netapi32.dll' name
'NetUserGetLocalGroups';
function NetApiBufferFree; external 'netapi32.dll' name 'NetApiBufferFree';

function GetGroupsForNetUser(uname: widestring): string;
// NetUserGetLocalGroups - returns semi-colon delim string of groups.
// Pass in user value returned by GetUserName to get current user.
var
  bufptr: Pointer;
  Status: NET_API_STATUS;
  PrefMaxLen, EntriesRead, TotalEntries: DWord;
  i: integer;
  pTmpBuf: LPLOCALGROUP_USERS_INFO_0;
begin
  PrefMaxLen := MAX_PREFERRED_LENGTH;
  Status := NetUserGetLocalGroups(nil, PWideChar(uname), 0 ,
        LG_INCLUDE_INDIRECT, bufptr, PrefMaxLen,
        EntriesRead, TotalEntries);
  case Status of
    NERR_Success: begin
      result := 'success, but no groups';
      pTmpBuf := bufptr;
      if pTmpBuf <> nil then
        begin
        result := '';
        for i := 0 to EntriesRead - 1 do
        begin
          if pTmpBuf <> nil then
          begin
            if result = '' then
            begin
              result := pTmpBuf.lgrui0_name
            else
              result := result + ';' + pTmpBuf.lgrui0_name;
          end;
          Inc(pTmpBuf);
        end;
      end;
    end;
    ERROR_ACCESS_DENIED: begin
      result := 'The user does not have access.';
    end;
    NERR_InvalidComputer: begin
      result := 'The computer name is invalid.';
    end;
    NERR_UserNotFound: begin
      result := 'The user name could not be found. (' + uname + ')';
    end;
    else begin
      result := 'Unknown error.';
    end;
  end;
   if bufptr <> nil then
          NetApiBufferFree(bufptr);
end;

end. 
```

# c# - 连接到 C# 中的 COM 事件 - 支持托管和非托管服务器

> ID：282746
> 
> 赞同：1
> 
> 时间：2008-11-12T01:38:21.613
> 
> 标签：c#, com, interop, iconnectionpoint

我正在编写需要连接到 COM 事件的 C# 代码。我因此实现了 IConnectionPointContainer 和 IConnectionPoint 的使用：

```
 IConnectionPointContainer connectionPointContainer = internalGenerator as IConnectionPointContainer;
      if (connectionPointContainer == null)
      {
        Debug.Fail("The script generator doesn't support the required interface - IConnectionPointContainer");
        throw new InvalidCastException("The script generator doesn't support the required interface - IConnectionPointContainer");
      }
      Guid IID_IScriptGeneratorEvents = typeof(IScriptGeneratorCallback).GUID;
      connectionPointContainer.FindConnectionPoint(ref IID_IScriptGeneratorEvents, out m_connectionPoint);
      m_connectionPoint.Advise(this, out m_cookie); 
```

问题是，当 COM 服务器实际上是在 .Net（例如 C#）中实现时，在 .Net 创建它之后，它会将其作为 .Net 对象而不是 COM 对象来处理。由于 .Net 对象没有实现 IConnectionPointContainer 接口，因此在尝试将对象强制转换为该接口时，我得到了 null。

知道如何解决这个问题吗？我当然可以在 C# COM 服务器中自己实现 IConnectionPointContainer，但是我想要一个更简单的解决方案，我可以轻松地向其他需要实现 COM 服务器的开发人员解释。

PS 我必须使用 IConnectionPointContainer，因为 COM 服务器可能在非 .Net（C++、Java）中实现。

谢谢， 因巴尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T02:11:56.757

IConnectionPointContainer 在 CCW（COM 可调用包装器）上实现，当将您的 .NET 对象作为外部 COM 对象公开时，.NET 会自动生成该 CCW。

尝试在 .NET 对象上调用[Marshal.GetComInterfaceForObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getcominterfaceforobject.aspx)以获取 IConnectionPointContainer 的 COM 接口，而不仅仅是强制转换它。

**更新**......如果这不起作用[Marshal.GetIUnknownForObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getiunknownforobject.aspx)必须返回一些东西，也许这将支持[Marshal.QueryInterface](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.queryinterface.aspx)调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T17:30:24.907

我没有找到办法做到这一点。最终，我将在 .Net 中定义另一个接口，并编写 2 个代码路径，一个用于 .Net 对象，一个用于真正的 COM 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-25T10:01:45.710

问题是执行 GetIUnknownForObject 调用会返回一个指针，然后您可以使用其 GUID 成功调用该指针以获取对象的 IConnectionPointContainer。但是，对 QueryInterface 的调用只返回原始的 .NET 对象，而不是 IConnectionPointContainer 接口。

我也坚持这一点，如果有人有任何进一步的见解，请分享。我的场景是我使用 COM 互操作将 .NET 控件公开为 ActiveX。我为事件接收器定义了一个 ComSourceInterface，但在 VB6 主机中，事件没有按预期连接。因此，我试图为暴露的 .NET 控件获取 IConnectionPointContainer 接口，以便手动连接事件，但如果确实实现了该接口，则无法访问该接口 - 或者我只是在查看错误的对象？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-26T08:31:07.203

我更进一步，因为在使用 COM 互操作将 .NET 控件公开为 ActiveX 时，手动连接事件时遇到了同样的问题。

如果您使用 Reflector（例如 Redgate Reflector）深入了解 UserControl 类，您会看到一个“ActiveXImpl”嵌套类成员，其中包含另一个名为“AdviseHelper”的嵌套静态类，它具有成员 ComConnectionPointContainer 和 ComConnectionPoint。它还具有根据需要连接点的辅助功能。

有问题。当 COM 互操作将事件从控件（事件源）连接到连接点容器（其中包含控件事件的事件接收器）时，将调用 IQuickActivate.QuickActivate 函数，然后调用 AdviseHelper 类''AdviseConnectionPoint ' 功能。

一个指向事件接收器的 IUnknown 接口指针，在您的客户端（即不是您的控件，包含它的东西）被传递给这个 QuickActivate 函数（参数'pUnkEventSink'。在反射器中，这个函数看起来像这样，我已经突出显示它的位置做实际的事件连接：

```
internal void QuickActivate(UnsafeNativeMethods.tagQACONTAINER pQaContainer, UnsafeNativeMethods.tagQACONTROL pQaControl)
{
    int num;
    this.LookupAmbient(-701).Value = ColorTranslator.FromOle((int) pQaContainer.colorBack);
    this.LookupAmbient(-704).Value = ColorTranslator.FromOle((int) pQaContainer.colorFore);
    if (pQaContainer.pFont != null)
    {
        Control.AmbientProperty ambient = this.LookupAmbient(-703);
        IntSecurity.UnmanagedCode.Assert();
        try
        {
            Font font2 = Font.FromHfont(((UnsafeNativeMethods.IFont) pQaContainer.pFont).GetHFont());
            ambient.Value = font2;
        }
        catch (Exception exception)
        {
            if (ClientUtils.IsSecurityOrCriticalException(exception))
            {
                throw;
            }
            ambient.Value = null;
        }
        finally
        {
            CodeAccessPermission.RevertAssert();
        }
    }
    pQaControl.cbSize = UnsafeNativeMethods.SizeOf(typeof(UnsafeNativeMethods.tagQACONTROL));
    this.SetClientSite(pQaContainer.pClientSite);
    if (pQaContainer.pAdviseSink != null)
    {
        this.SetAdvise(1, 0, (IAdviseSink) pQaContainer.pAdviseSink);
    }
    IntSecurity.UnmanagedCode.Assert();
    try
    {
        ((UnsafeNativeMethods.IOleObject) this.control).GetMiscStatus(1, out num);
    }
    finally
    {
        CodeAccessPermission.RevertAssert();
    }
    pQaControl.dwMiscStatus = num;
    if ((pQaContainer.pUnkEventSink != null) && (this.control is UserControl))
    {
        Type defaultEventsInterface = GetDefaultEventsInterface(this.control.GetType());
        if (defaultEventsInterface != null)
        {
            IntSecurity.UnmanagedCode.Assert();
            try
            {
                **AdviseHelper.AdviseConnectionPoint(this.control, pQaContainer.pUnkEventSink, defaultEventsInterface, out pQaControl.dwEventCookie);**
            }
            catch (Exception exception2)
            {
                if (ClientUtils.IsSecurityOrCriticalException(exception2))
                {
                    throw;
                }
            }
            finally
            {
                CodeAccessPermission.RevertAssert();
            }
        }
    }
    if ((pQaContainer.pPropertyNotifySink != null) && UnsafeNativeMethods.IsComObject(pQaContainer.pPropertyNotifySink))
    {
        UnsafeNativeMethods.ReleaseComObject(pQaContainer.pPropertyNotifySink);
    }
    if ((pQaContainer.pUnkEventSink != null) && UnsafeNativeMethods.IsComObject(pQaContainer.pUnkEventSink))
    {
        UnsafeNativeMethods.ReleaseComObject(pQaContainer.pUnkEventSink);
    }
} 
```

'pUnkEventSink' 变量通过 tagQACONTROL 结构传递给此函数，但正如您所见，与 IAdviseSink、控件容器、字体样式等不同，此变量未设置为 'ActiveXImpl' 类的任何成员，并且因此，在框架最初调用此函数后，您将无法访问它。

您需要获取此 IUnknown pUnkEventSink 变量来调用 AdviseHelper.AdviseConnectionPoint() 函数，该函数将执行手动事件连接。这就是我遇到的问题 - 遗憾的是，您似乎根本无法掌握它。

任何其他人对此有任何进一步的发展，请告诉我！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-02T16:04:33.987

我知道我对此有点晚了，但我能够使用 IConnectionPoint 让接收器事件工作。[在这里](https://stackoverflow.com/a/16326350/351028)查看我的答案。具体检查`MyAppDotNetWrapper`课程以及如何使用测试。

最终我认为你的`m_connectionPoint.Advise(this, out m_cookie);`失败是因为`this`必须`[ComVisible(true)]`是`[ClassInterface(ClassInterfaceType.None)]`和`public`。

# wpf - WPF - 从水平滚动条识别滚动事件？

> ID：282752
> 
> 赞同：2
> 
> 时间：2008-11-12T01:39:50.097
> 
> 标签：wpf, listview, scrollbars

如果您有一个同时具有水平和垂直滚动条的 ListView。你如何判断滚动事件来自哪一个？

ScrollBar.Scroll="xxx" 似乎没有区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T01:59:47.390

哎呀想通了：

路由事件的原始来源将是滚动条，只需检查其 Orientation 属性即可。

# javascript - 很好地截断字符串以适应给定的像素宽度

> ID：282758
> 
> 赞同：9
> 
> 时间：2008-11-12T01:42:03.230
> 
> 标签：javascript, text, reference, refactoring

有时您的字符串必须适合某个像素宽度。这个函数试图有效地做到这一点。请在下面发布您的建议或重构:)

```
function fitStringToSize(str,len) {
    var shortStr = str;
    var f = document.createElement("span");
    f.style.display = 'hidden';
    f.style.padding = '0px';
    document.body.appendChild(f);

    // on first run, check if string fits into the length already.
    f.innerHTML = str;
    diff = f.offsetWidth - len;

    // if string is too long, shorten it by the approximate 
    // difference in characters (to make for fewer iterations). 
    while(diff > 0)
    {
        shortStr = substring(str,0,(str.length - Math.ceil(diff / 5))) + '&hellip;';
        f.innerHTML = shortStr;
        diff = f.offsetWidth - len;
    }

    while(f.lastChild) {
        f.removeChild(f.lastChild);
    }
    document.body.removeChild(f);

    // if the string was too long, put the original string 
    // in the title element of the abbr, and append an ellipsis
    if(shortStr.length < str.length)
    {
        return '<abbr title="' + str + '">' + shortStr + '</abbr>';
    }
    // if the string was short enough in the first place, just return it.
    else
    {
        return str;
    }
} 
```

更新：@some 下面的解决方案要好得多；请使用它。

更新 2：代码现在作为[要点](https://gist.github.com/24261/7fdb113f1e26111bd78c0c6fe515f6c0bf418af5)发布；随意分叉并提交补丁:)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-12T13:55:02.330

您的代码有几个问题。

*   为什么`/ 5`？字符的宽度取决于`font-family`和`font-size`。
*   您必须在缩写标题中转义`str`（否则 " 将使代码无效）。
*   `diff`未声明并在全局范围内结束
*   `substring`不应该那样工作。你使用的是什么浏览器？
*   `hidden`不是 的有效值`style.display`。要隐藏它，您应该使用该值`none`，但浏览器不计算`offsetWidth`. 改为使用`style.visibility="hidden"`。
*   寻找合适的长度是非常低效的。
*   必须逃走`&lt;/abbr&gt;`”

我为您重写并添加了它，`className`以便您可以使用样式来设置`font-family`and `font-size`。Fooz 先生建议您使用鼠标悬停来显示整个字符串。这不是必需的，因为现代浏览器会为您执行此操作（已使用 FF、IE、Opera 和 Chrome 进行测试）

```
 function fitStringToSize(str,len,className) {
    var result = str; // set the result to the whole string as default
    var span = document.createElement("span");
    span.className=className; //Allow a classname to be set to get the right font-size.
    span.style.visibility = 'hidden';
    span.style.padding = '0px';
    document.body.appendChild(span);

    // check if the string don't fit 
    span.innerHTML = result;
    if (span.offsetWidth > len) {
        var posStart = 0, posMid, posEnd = str.length;
        while (true) {
            // Calculate the middle position
            posMid = posStart + Math.ceil((posEnd - posStart) / 2);
            // Break the loop if this is the last round
            if (posMid==posEnd || posMid==posStart) break;

            span.innerHTML = str.substring(0,posMid) + '&hellip;';

            // Test if the width at the middle position is
            // too wide (set new end) or too narrow (set new start).
            if ( span.offsetWidth > len ) posEnd = posMid; else posStart=posMid;
        }
        //Escape
        var title = str.replace("\"","&#34;");
        //Escape < and >
        var body = str.substring(0,posStart).replace("<","&lt;").replace(">","&gt;");
        result = '<abbr title="' + title + '">' + body + '&hellip;<\/abbr>';
    }
    document.body.removeChild(span);
    return result;
    } 
```

编辑：在进行更多测试时，我发现了一些错误。

*   我使用`Math.ceil`而不是预期`Math.floor`（我将此归咎于英语不是我的母语）

*   如果输入字符串有 html-tags，那么结果将是未定义的（在中间截断标签或留下打开的标签是不好的）

改进：

*   转义复制到所有位置跨度的字符串。您仍然可以使用 html-entities，但不允许使用标签（`<`并将`>`显示）
*   重写了`while`-statement（它有点快，但主要是为了摆脱导致额外回合的错误并摆脱break-statement）
*   将函数重命名为`fitStringToWidth`

版本 2：

```
function fitStringToWidth(str,width,className) {
  // str    A string where html-entities are allowed but no tags.
  // width  The maximum allowed width in pixels
  // className  A CSS class name with the desired font-name and font-size. (optional)
  // ----
  // _escTag is a helper to escape 'less than' and 'greater than'
  function _escTag(s){ return s.replace("<","&lt;").replace(">","&gt;");}

  //Create a span element that will be used to get the width
  var span = document.createElement("span");
  //Allow a classname to be set to get the right font-size.
  if (className) span.className=className;
  span.style.display='inline';
  span.style.visibility = 'hidden';
  span.style.padding = '0px';
  document.body.appendChild(span);

  var result = _escTag(str); // default to the whole string
  span.innerHTML = result;
  // Check if the string will fit in the allowed width. NOTE: if the width
  // can't be determined (offsetWidth==0) the whole string will be returned.
  if (span.offsetWidth > width) {
    var posStart = 0, posMid, posEnd = str.length, posLength;
    // Calculate (posEnd - posStart) integer division by 2 and
    // assign it to posLength. Repeat until posLength is zero.
    while (posLength = (posEnd - posStart) >> 1) {
      posMid = posStart + posLength;
      //Get the string from the beginning up to posMid;
      span.innerHTML = _escTag(str.substring(0,posMid)) + '&hellip;';

      // Check if the current width is too wide (set new end)
      // or too narrow (set new start)
      if ( span.offsetWidth > width ) posEnd = posMid; else posStart=posMid;
    }

    result = '<abbr title="' +
      str.replace("\"","&quot;") + '">' +
      _escTag(str.substring(0,posStart)) +
      '&hellip;<\/abbr>';
  }
  document.body.removeChild(span);
  return result;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T01:54:27.090

乍一看，它对我来说看起来不错。以下是一些小建议：

*   使用二分查找而不是线性查找最佳大小。

*   （可选）添加鼠标悬停，以便工具提示提供完整的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-09T15:24:54.057

您可以编写相同的函数但要适应 div 的宽度和高度吗？我有一个固定宽度和高度的 div，我需要从数据库中放置文本。如果文本对于 div 来说太大，我想剪掉它并在最后做广告...？可能的？谢谢

编辑：我为我的问题找到了 JS 解决方案：

```
<p id="truncateMe">Lorem ipsum dolor sit amet, consectetuer adipiscing
elit. Aenean consectetuer. Etiam venenatis. Sed ultricies, pede sit
amet aliquet lobortis, nisi ante sagittis sapien, in rhoncus lectus
mauris quis massa. Integer porttitor, mi sit amet viverra faucibus,
urna libero viverra nibh, sed dictum nisi mi et diam. Nulla nunc eros,
convallis sed, varius ac, commodo et, magna. Proin vel
risus. Vestibulum eu urna. Maecenas lobortis, pede ac dictum pulvinar,
nibh ante vestibulum tortor, eget fermentum urna ipsum ac neque. Nam
urna nulla, mollis blandit, pretium id, tristique vitae, neque. Etiam
id tellus. Sed pharetra enim non nisl.</p>

<script type="text/javascript">

var len = 100;
var p = document.getElementById('truncateMe');
if (p) {

  var trunc = p.innerHTML;
  if (trunc.length > len) {

    /* Truncate the content of the P, then go back to the end of the
       previous word to ensure that we don't truncate in the middle of
       a word */
    trunc = trunc.substring(0, len);
    trunc = trunc.replace(/\w+$/, '');

    /* Add an ellipses to the end and make it a link that expands
       the paragraph back to its original size */
    trunc += '<a href="#" ' +
      'onclick="this.parentNode.innerHTML=' +
      'unescape(\''+escape(p.innerHTML)+'\');return false;">' +
      '...<\/a>';
    p.innerHTML = trunc;
  }
}

</script> 
```

出于我的目的，我从...中删除了链接，因为我的页面上有另一个包含完整文本的选项卡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-08T08:04:40.240

幸运的是，[CSS3 text-overflow](http://www.css3.info/preview/text-overflow/)最终应该会解决这个问题。

如果有人使用 ASP.NET 并对服务器端解决方案感兴趣，请查看此博客文章：

[http://waldev.blogspot.com/2010/09/truncate-text-string-aspnet-fit-width.html](http://waldev.blogspot.com/2010/09/truncate-text-string-aspnet-fit-width.html)

# security - 简单的社区网站是否需要 SSL 证书？

> ID：282762
> 
> 赞同：3
> 
> 时间：2008-11-12T01:44:06.533
> 
> 标签：security, ssl, ssl-certificate

我正在部署一个小型社区站点。用户注册只需要用户名、电子邮件地址和密码。我什至不问名字，当然也不存储任何敏感数据。

我还应该投资 SSL 证书吗？在没有密码的情况下传输用户密码会被认为是一种糟糕的做法吗？

这只是一个个人项目，所以如果可以的话，我想避免额外的费用，但我不禁觉得如果我没有妥善保护一切，我会不负责任。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T02:13:37.207

我建议在用户向您的网站提交密码时获取 SSL 证书并要求 https。尽管您的用户不会传输任何敏感信息，但仍有一个重要原因：许多人访问的每个站点都使用相同的用户名和密码，如果有人在咖啡店使用开放式无线网络的笔记本电脑，您应该尽你所能保护他们和他们的身份安全。

如果成本是一个问题，一个很好的折衷方案是[CACert](http://www.cacert.org/)。他们的证书在大多数浏览器（目前）默认情况下不受信任，但任何具有可验证身份的人都可以免费从他们那里获得证书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T02:37:21.260

只要您不介意一个人能够冒充另一个人或在途中嗅探数据，那么您就不需要 SSL。

您可以尝试在没有 SSL 的情况下创建尽可能安全的站点。但是，如果您不确切知道后果是什么、将暴露什么以及如何在没有 SSL 的情况下保护它，这将是非常危险的。在某些情况下，甚至可能无法实现真正​​的保护。

此外，请记住人们经常为多个帐户使用一个密码。这意味着您数据库中的许多密码将与用户的银行、电子邮件、网络等相同。

**如果您让人们与您一起存储密码，则您必须负责保护它，即使您自己网站的安全性并不重要。**

我建议花 20 美元购买一个 Godaddy 证书，以确保安全。此外，请务必阅读会话安全和安全身份验证方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T18:16:12.957

感谢您的回复。我想我确信花一点钱来保护人们的密码是值得的。

I did think about using OpenID. Probably won't be part of the initial release, but I may add support for it later. I would question how well my audience would understand the concept of OpenID. I think it works well for SO because of the nature of the audience. I have a hard time asking the general population to summon the enthusiasm to get an OpenID just to use what will probably be a very modest site.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T01:46:47.853

我不会因为这样的事情而为 SSL 烦恼。

想想看……互联网上有一百万个留言板，但没有一个使用 SSL。

除非您存储信用卡号码或其他敏感的财务/个人信息，否则我认为这不值得。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T01:51:54.317

只要您的用户不提供任何信用卡或其他个人信息，我也不会费心为证书付费。

但如果它是一个社交网站，那么我会考虑入手一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T02:06:42.727

可能没有帮助，但某些 SSL 提供商比其他提供商便宜，例如 www.instantssl.com 相对便宜。还有一些主机允许您使用共享证书，您可以将它们仅用于登录过程，尽管您的域不会出现在地址栏中，至少流量将被加密，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T02:10:03.377

SSL 对此可能是矫枉过正。

不过，鼓励您的用户不要使用他们用来存储敏感信息的密码！您可能不会存储任何重要的东西，但如果“kitty37”也是他们银行账户的钥匙，事情可能会变得很糟糕......

这提醒了我——人们应该查看 CMU 的 Perspectives 项目，该项目一方面试图解决自签名证书太难使用的问题，另一方面，“官方”证书可能被伪造，通过使用共识监控服务来跟踪大量的安全证书，并观察它们是否在变化等。

他们有一个 Firefox 扩展，所以它很容易使用（还有一个 openSSH 客户端）。 [http://www.cs.cmu.edu/~perspectives/](http://www.cs.cmu.edu/~perspectives/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T02:28:03.463

为小型社区网站投资 SSL 证书将是浪费金钱。我相信最好把时间花在确保用户注册和登录页面易于访问和理解上，让用户有足够的时间和空间来查看他们是否会保持登录状态。如果你总是将这样的参数设置为不，那么这个例子就不是问题了。

如果我们正在处理一个大型网站，那么获得一个可能是个好主意。您是否考虑过使用[OpenID](http://openid.net/)作为用户登录的一种方式？它似乎在这个网站上运行得相当好，那么为什么不自己实现它呢？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T03:10:52.690

SSl 部分可能是矫枉过正，更糟糕的是，它成为“货物​​崇拜安全”的真正诱惑——在那里你做一些听起来像安全但并没有真正增加任何东西的事情。

你最好考虑一下如何确保你正在构建一个加固的站点，并保持你的安全补丁是最新的。

哦，还有一件事：热情的用户他们没有使用安全密码，因此他们不会使用他们在所有银行网站上使用的最喜欢的“joe”密码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-12T17:14:34.517

如果您只是想识别用户，为什么不像 stackoverflow 那样允许 OpenID 呢？;) [http://openid.net/](http://openid.net/)

# java - 如何在 java swing 库中浏览文件？

> ID：282779
> 
> 赞同：36
> 
> 时间：2008-11-12T01:58:25.457
> 
> 标签：java, swing, file

我想知道 java swing 库中是否有某种 J 工具可以打开文件浏览器窗口并允许用户选择文件。然后文件的输出将是所选文件的绝对路径。

提前致谢，

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-12T02:04:25.180

您可以使用[JFileChooser](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JFileChooser.html)类，查看[此示例](http://www.java2s.com/Code/Java/Swing-JFC/DemonstrationofFiledialogboxes.htm)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-12T02:09:04.813

我最终使用了这段代码，它完全符合我的需要：

```
final JFileChooser fc = new JFileChooser();
fc.showOpenDialog(this);

try {
    // Open an input stream
    Scanner reader = new Scanner(fc.getSelectedFile());
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-12T03:12:38.273

下面的示例创建一个文件选择器，并首先将其显示为打开文件对话框，然后显示为保存文件对话框：

```
String filename = File.separator+"tmp";
JFileChooser fc = new JFileChooser(new File(filename));

// Show open dialog; this method does not return until the dialog is closed
fc.showOpenDialog(frame);
File selFile = fc.getSelectedFile();

// Show save dialog; this method does not return until the dialog is closed
fc.showSaveDialog(frame);
selFile = fc.getSelectedFile(); 
```

这是一个更详细的示例，它创建了两个按钮来创建和显示文件选择器对话框。

```
// This action creates and shows a modal open-file dialog.
public class OpenFileAction extends AbstractAction {
    JFrame frame;
    JFileChooser chooser;

    OpenFileAction(JFrame frame, JFileChooser chooser) {
        super("Open...");
        this.chooser = chooser;
        this.frame = frame;
    }

    public void actionPerformed(ActionEvent evt) {
        // Show dialog; this method does not return until dialog is closed
        chooser.showOpenDialog(frame);

        // Get the selected file
        File file = chooser.getSelectedFile();
    }
};

// This action creates and shows a modal save-file dialog.
public class SaveFileAction extends AbstractAction {
    JFileChooser chooser;
    JFrame frame;

    SaveFileAction(JFrame frame, JFileChooser chooser) {
        super("Save As...");
        this.chooser = chooser;
        this.frame = frame;
    }

    public void actionPerformed(ActionEvent evt) {
        // Show dialog; this method does not return until dialog is closed
        chooser.showSaveDialog(frame);

        // Get the selected file
        File file = chooser.getSelectedFile();
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T14:06:51.993

In WebStart and the new 6u10 PlugIn you can use the FileOpenService, even without security permissions. For obvious reasons, you only get the file contents, not the file path.

# linux - 在 Linux 中使用 Photoshop CS3 的最佳方式

> ID：282782
> 
> 赞同：0
> 
> 时间：2008-11-12T02:02:30.380
> 
> 标签：linux, photoshop

我不想在工作中使用 Mac 或 Windows，但是当我必须从 Photoshop 设计创建 HTML 页面时，我在 Photoshop 中有很多工作。

在 Linux、Wine、虚拟化中使用 Photoshop CS3 的最佳方式是什么……？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T02:06:46.360

在使用 Photoshop 之前，Wine 对我来说有点不稳定（键盘快捷键表现得很奇怪），而且它不支持最新版本。

不过，使用虚拟化就像一种魅力，您可以使用 VirtualBox 等软件轻松实现。它易于使用，网上有很多教程，而且通常在您的默认存储库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T02:27:56.307

实际上，我有 Photoshop CS3 在 Gentoo Linux 上的 wine 下工作。安装完美无瑕，运行无误。工具栏上有一些显示问题，但没有什么无法解决的。

Photoshop CS2 在 wine 应用程序数据库中具有[金牌评级](http://appdb.winehq.org/objectManager.php?sClass=version&iId=2631)，因此如果您准备牺牲更高版本中引入的一些功能，则可以使用它。

就我个人而言，我发现 Photoshop 7 对于我作为网页设计师的工作来说仍然是可以接受的最低要求。

不过，对于长期解决方案，我推荐 CS2/wine 或 Mac。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T02:13:38.453

我不想这么说，但如果你想使用 Photoshop，你可能只需要接受它并使用 Windows 或 OSX。如前所述，Wine 不能与 CS3 一起使用，并且在尝试使用 Fedora Core 的 VirtualBox 使用 Photoshop CS3 之后，体验并不愉快。再说一次，如果你在一台相当强大的机器上，那么它可能没问题。

除了需要打开 PSD 文件之外，您的工作是否需要使用 Photoshop？如果需要，您可能会很好地使用 GIMP。此外，我确信 OSX 还会有一些其他出色的光栅图形工具。

因此，您可以选择使用 VirtualBox、使用 Windows/OSX 或使用 Windows 机器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-22T05:33:15.587

Abe，如果您只需要文件中的图像层，我有一个便携式命令行工具，可以将它们提取为 PNG：[http ://telegraphics.com.au/sw/#psdparse](http://telegraphics.com.au/sw/#psdparse)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-08T21:41:40.503

它在 VirtualBox 下运行良好，但在我看来非常慢，例如读/写文件访问。我有一个带有 2 Gb 内存、SATA2 HD 和 NVIDIA 8600 的 Intel Core Duo 2

我以这种方式使用了很长时间，但从前一段时间我通过[葡萄酒](http://www.winehq.org)使用它，我很高兴，它运行得很快。当然，通过wine，它的外观和工作方式与窗口版本不同，但足以让我快速使用Camera Raw和图像处理

# sql - 下一代数据库

> ID：282783
> 
> 赞同：54
> 
> 时间：2008-11-12T02:02:42.890
> 
> 标签：sql, database, nosql, non-relational-database

我正在学习传统的关系数据库（使用[PostgreSQL](http://www.postgresql.org/)）并进行一些研究，我遇到了一些新型数据库。[CouchDB](http://couchdb.apache.org/)、[Drizzle](https://launchpad.net/drizzle)和[Scalaris](http://www.zib.de/CSR/Projects/scalaris/)等等，下一个需要处理的数据库技术是什么？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-11-12T02:24:59.913

我会说下一代*数据库*，而不是下一代 SQL。

SQL 是一种用于查询和操作关系数据库的语言。SQL 由国际标准规定。虽然标准被修订，但它似乎总是在关系数据库范式中工作。

以下是目前受到关注的一些新的数据存储技术：

*   [**CouchDB**](http://couchdb.apache.org/)是一个非关系型数据库。他们称之为面向文档的数据库。
*   [**Amazon SimpleDB**](http://aws.amazon.com/simpledb/)也是一种通过 Web 服务以分布式方式访问的非关系型数据库。**亚马逊还有一个名为Dynamo**的分布式键值存储，它支持它的一些 S3 服务。
*   [**Dynomite**](http://github.com/cliffmoon/dynomite/tree/master)和[**Kai**](http://kai.wiki.sourceforge.net/)是受 Amazon Dynamo 启发的开源解决方案。
*   [**BigTable**](http://research.google.com/archive/bigtable.html)是谷歌使用的专有数据存储解决方案，并使用他们的谷歌文件系统技术实现。Google 的 MapReduce 框架使用 BigTable。
*   [**Hadoop**](http://hadoop.apache.org/core/)是一种受 Google 的 MapReduce 启发的开源技术，它服务于类似的需求，用于分发超大规模数据存储的工作。
*   [**Scalaris**](http://www.zib.de/CSR/Projects/scalaris/)是一个分布式事务键/值存储。也不是关系型的，也不使用 SQL。这是德国柏林 Zuse 研究所的一个研究项目。
*   [**RDF**](http://www.w3.org/RDF/)是一种存储语义数据的标准，其中数据和元数据是可互换的。它有自己的查询语言 SPARQL，表面上和 SQL 很像，但实际上完全不同。
*   [**Vertica**](http://www.vertica.com/)是一个高度可扩展的面向列的分析数据库，专为分布式（网格）架构而设计。它确实声称是关系型和 SQL 兼容的。它可以通过亚马逊的弹性计算云使用。
*   [**Greenplum**](https://greenplum.org/)是一个大规模的数据仓库 DBMS，它同时实现了 MapReduce 和 SQL。
*   [**XML**](http://www.w3.org/XML/)根本不是 DBMS，它是一种交换格式。但是一些 DBMS 产品使用 XML 格式的数据。
*   [**ODBMS**](http://www.odbms.org/)或对象数据库用于管理复杂数据。主流中似乎没有任何占主导地位的 ODBMS 产品，这可能是因为缺乏标准化。标准 SQL 正在逐渐获得一些 OO 特性（例如可扩展的数据类型和表）。
*   [**Drizzle**](https://launchpad.net/drizzle)是一个关系型数据库，它的很多代码都来自 MySQL。它包括旨在管理可扩展“云计算”系统架构中的数据的各种架构更改。据推测，它将继续使用标准 SQL 和一些 MySQL 增强功能。
*   [**Cassandra**](http://incubator.apache.org/cassandra/)是一个高度可扩展、最终一致、分布式、结构化的键值存储，由 Amazon Dynamo 的作者之一在 Facebook 开发，并为 Apache 项目做出了贡献。
*   [**Project Voldemort**](http://project-voldemort.com/)是一个非关系的分布式键值存储系统。它用于 LinkedIn.com
*   [**Berkeley DB**](http://www.oracle.com/technology/products/berkeley-db/index.html)也值得一提。它不是“下一代”，因为它可以追溯到 1990 年代初期。它是一种流行的键值存储，易于嵌入到各种应用程序中。该技术目前归甲骨文公司所有。

另请参阅 Richard Jones 的这篇精彩文章：“ [Anti-RDBMS：分布式键值存储列表](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/)”。他更详细地描述了其中一些技术。

可以肯定的是，关系数据库有弱点。自首次引入数据建模需求以来，人们一直在争辩说他们并没有处理所有的数据建模需求。

年复一年，研究人员提出了管理数据的新方法以满足特殊要求：要么处理不适合关系模型的数据关系的要求，要么要求完成数据处理的高规模或速度要求在分布式服务器集合上，而不是中央数据库服务器。

尽管这些先进技术在解决它们设计的专门问题方面做得很好，但关系数据库仍然是满足大多数业务需求的良好通用解决方案。SQL 不会消失。

* * *

我在 php|Architect 杂志上写了一篇关于非关系数据库的创新，以及关系与非关系数据库中的数据建模的文章。[http://www.phparch.com/magazine/2010-2/september/](http://www.phparch.com/magazine/2010-2/september/)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-26T22:26:22.440

到目前为止，我在答案中缺少**图形数据库。**对象的图形或网络在编程中很常见，在数据库中也很有用。它可以有效地处理半结构化和互连的信息。图数据库引起广泛关注的领域包括语义网和生物信息学。提到了RDF，它实际上是一种表示图的语言。以下是图形数据库区域中正在发生的事情的一些指针：

*   [图——更好的数据库抽象](http://whydoeseverythingsuck.com/2008/03/graphs-better-database-abstraction.html)
*   [Graphd，Freebase 的后端](http://blog.freebase.com/2008/04/09/a-brief-tour-of-graphd/)
*   [Neo4j 开源图数据库引擎](http://neo4j.org/)
*   [AllegroGraph RDFstore](http://agraph.franz.com/)
*   [Graphdb 生物信息学抽象层](http://code.google.com/p/pygr/)
*   [有向边推荐引擎背后的 Graphdb](http://blog.directededge.com/2009/02/27/on-building-a-stupidly-fast-graph-database/)

我是[Neo4j](http://neo4j.org/)项目的一部分，该项目是用 Java 编写的，但也绑定到 Python、Ruby 和 Scala。有些人将它与 Clojure 或 Groovy/Grails 一起使用。还有一个不断发展的[GUI 工具](http://wiki.neo4j.org/content/Neoclipse)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-03-19T10:26:01.590

可能不是回答这个问题的最佳地点，但我想分享这个由 Steve Yen 创建的 noSQL 世界分类法（请在[http://de.slideshare.net/northscale/nosqloakland-200911021](http://de.slideshare.net/northscale/nosqloakland-200911021)找到它）

1.  **键值缓存**

    *   内存缓存
    *   重新缓存
    *   连贯性
    *   无限期
    *   极端规模
    *   jboss缓存
    *   速度
    *   兵马俑</li>
2.  **键值存储**

    *   键空间
    *   耀斑
    *   无图式
    *   内存云 </li>
3.  **最终一致的键值存储**

    *   发电机
    *   伏地魔
    *   炸药
    *   子记录
    *   蒙古数据库
    *   燕尾数据库
4.  **有序键值存储**

    *   东京暴君
    *   光云
    *   纳米数据库
    *   卢西奥
    *   内存缓存数据库
    *   演员</li>
5.  **数据结构服务器**

    *   redis </li>
6.  **元组存储**

    *   千兆空间
    *   坐标
    *   阿帕奇河
7.  **对象数据库**

    *   佐佩数据库
    *   db4o
    *   浅滩</li>
8.  **文件存储**

    *   沙发数据库
    *   蒙哥
    *   长耳兔
    *   XML 数据库
    *   直通数据库
    *   CloudKit
    *   坚持不懈
    *   里亚克芭蕉
    *   标量</li>
9.  **宽柱状存储**

    *   大表
    *   Hbase
    *   卡桑德拉
    *   超表
    *   凯
    *   开放网络

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-28T11:15:43.430

要了解下一代数据库领域正在进行的学术研究，请查看以下内容：[http ://www.thethirdmanifesto.com/](http://www.thethirdmanifesto.com/)

关于 SQL 语言作为关系模型的正确实现，我引用维基百科，“SQL，最初作为关系数据库的标准语言被推，在几个地方偏离了关系模型。当前的 ISO SQL 标准没有提及关系模型或使用关系术语或概念。但是，如果不使用某些 SQL 功能，则可以使用 SQL 创建符合关系模型的数据库。

[http://en.wikipedia.org/wiki/Relational_model](http://en.wikipedia.org/wiki/Relational_model)（在 2010 年 3 月 28 日的“SQL 和关系模型”一节中引用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T02:05:24.883

不要迂腐，但我想指出，至少 CouchDB 不是基于 SQL 的。我希望下一代 SQL 能让 SQL 少很多……丑陋且不直观。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T17:30:34.413

有一些特殊的 XML 数据库，如 MarkLogic 和 Berkeley XMLDB。他们可以索引 xml-docs，并且可以使用 XQuery 查询它们。我期待 JSON 数据库，也许它们已经存在。做了一些谷歌搜索，但找不到一个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T02:15:26.577

SQL 自 1970 年代初就已经存在，所以我认为它不会很快消失。

也许'新（-ish）sql'会oql（见[http://en.wikipedia.org/wiki/ODBMS](http://en.wikipedia.org/wiki/ODBMS)）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T22:00:22.903

我还听说过 Jim Starkey 的 NimbusDB

Jim Starkey 是“创造”Interbase 的人

谁在 Vulcan（火鸟前叉）上工作

Falcon for MySQL 的创始人是谁

# active-directory - 无法使用 Active Directory 域服务运行 GPO 登录脚本

> ID：282786
> 
> 赞同：2
> 
> 时间：2008-11-12T02:06:39.827
> 
> 标签：active-directory, group-policy

我刚刚将我们公司的域控制器从 NT 4.0 升级到了 Windows 2008 Server。我使用了就地升级路径，首先从 NT 4.0 升级到 Windows 2003 Server，然后从 2003 Server 升级到 2008 Server。最初的 NT 4.0 域名称为*Company*。新域是*Company* .local。我已确认用户和计算机信息已正确迁移，新域已运行一周，几乎没有问题。

我现在遇到的问题是为一组用户设置 GPO 用户登录脚本。我相信我已经正确设置了 GPO，但是登录后脚本没有在客户端上执行。

经过调查，我注意到如果我直接导​​航到域控制器，我可以在登录后手动从客户端执行脚本（批处理文件）：\\ *ServerName* \SysVol\ *Company* .local\Policies\{GUID}\User\Scripts\Logon

但是，如果我的理解是正确的，客户端在执行登录脚本时不会使用此路径，而是使用域（林？）名称作为源（在这种情况下域和林名相同）：\ \ *Company* .local\SysVol\ *Company* .local\Policies\{GUID}\User\Scripts\Logon

从客户端手动执行此批处理文件时，我收到一个“打开文件 - 安全警告”对话框，声称客户端无法验证发布者。上面的两条路径本质上是同一个地方，只是用不同的路径访问。

*知道为什么客户端在通过 \\ Company* .local 而不是 \\ *ServerName*访问时不信任来自他们自己的域控制器的内容吗？还有其他地方我应该寻找可能的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T22:27:45.413

安全警告很可能是一条红鲱鱼。我们可以了解它出现的原因，但我更感兴趣的是首先讨论在登录期间执行的脚本。

使用应执行脚本的用户帐户登录到客户端计算机并运行“策略结果集”工具（从空白 MMC，添加“策略结果集”管理单元，然后突出显示并右键单击范围窗格中的“策略结果集”并选择“生成 RSoP 数据...”采用所有默认值...）

我假设您没有使用过脚本上的 NTFS ACL 或 GPO 本身上的 ACL。

我的直觉说这是一个 GPO 范围问题。收集策略后，看看脚本是否被放置在要为用户执行的脚本列表中。收集 RSoP 数据后，右键单击范围窗格中的“用户配置”节点，然后检查与用户关联的 GPO 列表。您是否在该列表中看到包含您的脚本的 GPO？

假设您确实看到 GPO 正在应用并且确实看到要为用户执行的登录脚本中列出的脚本，接下来我将前往应用程序事件日志，看看 USERINIT 在登录期间是否记录了有关执行脚本问题的任何内容。

假设您没有看到您的 GPO 应用于用户，我会考虑您将 GPO 与用户帐户相关联的位置（这是我谈到的“范围界定问题”）。GPO 必须链接到用户对象所在的 OU、用户对象所在的 OU 的父 OU、域的顶部或与客户端所在的 IP 子网关联的站点对象计算机的 IP 地址已分配。

如果这没有意义，并且您仍然没有看到您所期望的，请发布有关对象的逻辑拓扑的一些描述 - 即显示域的树形图，以及包含用户的任何子 OU有问题的对象，以及有关 GPO 链接位置的注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-02T09:21:18.563

I recently had the exact same issue. I did find that the script ran, but "invisible". there is a option on the GPO to run scripts "visibly" by going to "Administrative Templates", "System", "Scripts"

# c# - ?: LINQ 查询中的运算符

> ID：282791
> 
> 赞同：10
> 
> 时间：2008-11-12T02:08:39.383
> 
> 标签：c#, linq, linq-to-sql

*   如何在 LINQ 查询的 SELECT 子句中使用 ?: 运算符？如果这不能做到，我怎么能效仿呢？目标是在我的选择子句中获得一个 CASE 块。正如您可能怀疑的那样，我收到一个错误：*无效的匿名类型成员声明符。必须使用成员分配、简单名称或成员访问来声明匿名类型成员。*

*   这是说“从a.ipid=i.id 上的内部连接i 在i.uid=u.id 上的内部连接i”的正确方式还是充分方式？如果没有，请提供一份。谢谢。

    ```
    var query =
        from a in db.tblActivities
        from i in db.tblIPs
        from u in db.tblUsers 
        select new {
            u.UserName == null
                ? i.Address
                : u.UserName,
            a.Request,
            a.DateTime }; 
    ```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-12T03:01:09.717

创建匿名类型时（您在没有指定类型的情况下使用“新”执行的操作）您必须为每个属性指定成员名称。从您的示例中，它看起来像这样：（也修复了您的连接）

```
var query = from a in db.tblActivities
            join i in db.tblIPs on a.ipid equals i.id
            join u in db.tblUsers on i.uid equals u.id
            select new {
               UserName = (u.UserName ?? i.Address),
               Request = a.Request,
               Date = a.DateTime
            }; 
```

您也可以按照自己的方式使用 UserName：

```
UserName = (u.UserName == null) ? i.Address : u.UserName, 
```

但是？？运算符更简洁。它类似于 SQL 中的“isnull”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T02:25:50.207

您必须使用 join 关键字，并定义实体之间的关系才能进行正确的内部连接。

[在这里](http://msdn.microsoft.com/en-us/library/bb397941.aspx)你可以找到一些例子，我也强烈推荐你获取[LinqPad](http://www.linqpad.net/)，它是一个非常有价值的工具来测试你的查询，它也很好学，它有 200 多个例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T02:19:53.603

我对 Linq to SQL 还很陌生，但我很确定它会是这样的：

```
var query =
    from a in db.tblActivities
    from i in a.tblIPs
    from u in i.tblUsers 
    select new
    {
        userName = (u.UserName == null)
            ? i.Address
            : u.UserName,
        a.Request,
        a.DateTime
    }; 
```

if 语句需要在括号中，结果在括号之外。至于连接，您按照从一到多的链条向下移动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T02:28:56.660

如果你只检查 null，你也可以使用 ??

```
string something = null;
string somethingElse = something ?? "default value"; 
```

至于上面的例子，做那些是正确的......

```
string something = (somethingElse == null ? "If it is true" : "if it is false"); 
```

括号不是必需的，但它们确实有助于阅读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T03:13:45.883

真的。这个问题取决于您的 linq 表达式将返回的 IQueryable 的特定实现。我看到你有 db.XXX 那么你是使用 linq to sql 还是一些 linq to 数据存储？如果是这样，IQueryable 的具体实现将需要有一种方法将您的表达式转换为存储表达式。除了上述评论之外，其他一些评论是正确的，在匿名类型中您必须为每个成员指定一个名称。这真的是你的错误。

# c++ - C++ 奇怪的编译错误：错误：从类“对象”更改“对象”的含义

> ID：282800
> 
> 赞同：12
> 
> 时间：2008-11-12T02:13:50.887
> 
> 标签：c++, xcode

我什至不知道该去哪里。谷歌不是很有帮助。和我之前的问题一样。我正在使用 TextMate 的 Command+R 来编译项目。

> game.h:16:error: 'Player* HalfSet::Player() const'的声明</p>
> 
> player.h:11:error: 将 'Player' 的含义从 'class Player' 更改</p>
> 
> game.h:21:error: 'Player' 不是类型

player.h 文件（部分）

```
#ifndef PLAYERS_H
#define PLAYERS_H
using namespace std;

#include <string>
#include <vector>
#include <istream>
#include <iomanip>
#include "generics.h"

class Player{ //Line 11
public:
    //getters
    long Id() const;
    string FirstName() const;
    string LastName() const;
    string Country() const;
    //setters
    void setId(long id);
    void setFirstName(string s);
    void setLastName(string s);
    void setCountry(string s);
    //serializing functions
    void display(ostream &out);
    void read(istream &in);
    void write(ostream &out);
    //Initalizers
    Player();
    Player(istream &in);
    Player(string firstName, string lastName);
    Player(string firstName, string lastName, string country);
    Player(long id, string firstName, string lastName, string country);
    ~Player();
private:
    long _id;
    string _firstName;
    string _lastName;
    string _country;
}; 
```

game.h 文件（部分）

```
#ifndef GAME_H
#define GAME_H

#include "generics.h"
#include "players.h"
#include <string>
#include <vector>
#include <istream>
#include <iomanip>

using namespace std;

class HalfSet{
public:
    //getters
    Player* Player() const; //Line 16
    int GamesWon() const;
    int TotalPoints() const;
    int Errors() const;
    //setters
    void setPlayer(Player* p);
    void setGamesWon(int games);
    void setTotalPoints(int points);
    void setErrors(int errors);
    //Serialization
    void display(ostream &out) const;
    void read(istream &in) const;
    void write(ostream &out) const;
    //Initalizers
    HalfSet();
    ~HalfSet();
private:
    Player* _player;
    int _gamesWon;
    int _points;
    int _errors;
}; 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-12T02:26:43.513

在 C++ 中，您不能将函数命名为与类/结构/类型定义相同的名称。您有一个名为“Player”的类，因此 HalfSet 类有一个名为“Player”的函数（“Player *Player()”）。您需要重命名其中之一（可能将 HalfSet 的 Player() 更改为 getPlayer() 或类似名称）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-12T09:57:06.083

您的问题是在范围内查找名称。在 的声明中，需要查找`HalfSet::setPlayer(Player*)`不合格的名称。`Player`尝试的第一个范围是`class HalfSet`. 在该范围内，查找`Player`find 函数`HalfSet::Player`，而不是`global class ::Player`.

解决方案是使用限定名称`::Player`. 这告诉编译器要使用哪个范围进行查找（全局），这反过来意味着`HalfSet::Player`甚至不考虑。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-11-02T03:30:43.790

这个问题的当前答案是不正确的，它说：

> 在 C++ 中，您不能将函数命名为与类/结构/类型定义相同的名称

允许通过函数隐藏类的名称，如果我们去[草案 Pre C++11 标准](http://www.open-std.org/Jtc1/sc22/wg21/docs/papers/2005/n1804.pdf)部分`3.3.7` *名称隐藏*它说：

> 类名 (9.1) 或枚举名 (7.2) 可以被在同一范围内声明的对象、函数或枚举器的名称隐藏。如果一个类或枚举名称和一个对象、函数或枚举器在同一范围内（以任何顺序）以相同的名称声明，则无论对象、函数或枚举器名称可见，该类或枚举名称都会隐藏。

因此，您拥有该函数和一个名为的类这一`Player`事实不是问题，实际上以下代码是有效的：

```
class Player
{
} ;

Player* Player() ; 
```

我们可以使用[详细的类型说明符](https://stackoverflow.com/questions/10902518/when-to-use-an-elaborated-type-specifier)来取消隐藏类类型。

据我所知，这违反了`3.3.6` *Class scope*段落`2`，它说：

> 在 S 类中使用的名称 N 应在其上下文中引用相同的声明，并且在 S 的完整范围内重新评估时。违反此规则不需要诊断。

因此，在这种情况下，`Player`将含义从*class*更改为*function*，我不清楚它的意图是如此严格，但我可以看到如何以这种方式阅读它。`gcc`正如我们从一个[类似的问题](https://stackoverflow.com/q/26681873/1708801)中看到的那样，这似乎是它检测到这种违规时使用的消息。

使用详细的类型说明符可以防止含义的改变：

```
class Player* Player() const ; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-21T03:15:20.227

我的代码出现此错误，我无法理解

> 在 S 类中使用的名称 N 应在其上下文中引用相同的声明，并且在 S 的完整范围内重新评估时。违反此规则不需要诊断。

但这就是我所做的，所以它解决了我的错误

以前的代码

```
#include "a.h"

class System {
 public:
  car car;    /*This line is problem, Can't declare object with same name as 
               class*/
}; 
```

修改后的代码

```
#include "a.h"

 class System {
  public:
   car Car;      //Here is the difference, Just changed first letter of object
  }; 
```

# svn - 如何查看 SVN 中文件的所有历史更改

> ID：282802
> 
> 赞同：181
> 
> 时间：2008-11-12T02:16:08.277
> 
> 标签：svn

我知道我可以 `svn diff -r a:b repo` 查看两个指定修订版之间的更改。我想要的是更改文件的每个修订版的差异。这样的命令可用吗？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2008-11-12T06:26:25.870

它没有内置命令，所以我通常只做这样的事情：

```
#!/bin/bash

# history_of_file
#
# Outputs the full history of a given file as a sequence of
# logentry/diff pairs.  The first revision of the file is emitted as
# full text since there's not previous version to compare it to.

function history_of_file() {
    url=$1 # current url of file
    svn log -q $url | grep -E -e "^r[[:digit:]]+" -o | cut -c2- | sort -n | {

#       first revision as full text
        echo
        read r
        svn log -r$r $url@HEAD
        svn cat -r$r $url@HEAD
        echo

#       remaining revisions as differences to previous revision
        while read r
        do
            echo
            svn log -r$r $url@HEAD
            svn diff -c$r $url@HEAD
            echo
        done
    }
} 
```

然后，您可以使用以下命令调用它：

```
history_of_file $1 
```

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2008-11-12T06:37:34.910

与您描述的略有不同，但我认为这可能是您真正需要的：

```
svn blame filename 
```

它将打印文件，每一行都以最后一次更改它的提交的时间和作者为前缀。

* * *

## 回答 #3

> 赞同：101
> 
> 时间：2014-07-24T15:56:18.353

如果您想查看包含代码更改的文件的整个历史记录：

```
svn log --diff [path_to_file] > log.txt 
```

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-11-12T03:07:18.300

您可以使用`git-svn`将存储库导入 Git 存储库，然后使用`git log -p filename`. 这显示了文件的每个日志条目，后跟相应的差异。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2008-11-12T03:44:10.143

从...开始

```
svn log -q file | grep '^r' | cut -f1 -d' ' 
```

这将为您提供文件更改的修订列表，然后您可以使用它来编写重复调用`svn diff`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-04-30T19:07:03.440

奇怪的“责备”命令就是这样做的。如果您使用 Tortoise，它会为您提供一个“来自修订版”对话框，然后是一个文件列表，旁边有一个修订号和作者的逐行指示符。

如果您右键单击修订信息，您可以打开一个“显示日志”对话框，其中提供完整的签入信息，以及属于签入的其他文件。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-12T03:31:53.193

据我所知，没有内置的 svn 命令来完成此操作。您需要编写一个脚本来运行多个命令来构建所有差异。如果可以的话，更简单的方法是使用 GUI svn 客户端。其中许多（例如 Eclipse 的颠覆性插件）将列出文件的历史记录，并允许您查看每个修订版的差异。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-08-13T14:33:20.953

谢谢，本丁。我非常喜欢你的解决方案。

我将其更改为以相反的顺序工作，首先显示最近的更改。这对于维护多年的长期代码很重要。我通常用管道将它输入更多。

```
svnhistory elements.py |more 
```

我将 -r 添加到排序中。我删除了规范。处理“第一条记录”。它会在最后一个条目上出错，因为没有什么可以区分的。虽然我忍受它，因为我从来没有走得那么远。

```
#!/bin/bash                                                                    

# history_of_file                                                              
#                                                                              
# Bendin on Stack Overflow: http://stackoverflow.com/questions/282802          
#   Outputs the full history of a given file as a sequence of                  
#   logentry/diff pairs.  The first revision of the file is emitted as         
#   full text since there's not previous version to compare it to.             
#                                                                              
# Dlink                                                                        
#   Made to work in reverse order                                              

function history_of_file() {
    url=$1 # current url of file                                               
    svn log -q $url | grep -E -e "^r[[:digit:]]+" -o | cut -c2- | sort -nr | {
        while read r
    do
            echo
            svn log -r$r $url@HEAD
            svn diff -c$r $url@HEAD
            echo
    done
    }
}

history_of_file $1 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-01-06T17:57:46.793

在研究这个主题时，我看到了很多部分答案。这对我有用，希望对其他人有所帮助。此命令将在命令行上显示输出，显示修订号、作者、修订时间戳和所做的更改：

```
svn blame -v <filename> 
```

为了使您的搜索更容易，您可以将输出写入文件并 grep 查找您要查找的内容。

# c# - ASP.NET 开发服务器模拟 IIS6 还是 IIS7？

> ID：282805
> 
> 赞同：3
> 
> 时间：2008-11-12T02:18:34.090
> 
> 标签：c#, asp.net, visual-studio-2008

在 Visual Studio 2008 中，当我们按下 Ctrl+F5 时，会启动 ASP.NET 开发服务器来模拟 Web 服务器。我想知道它模拟的是什么服务器？IIS6 还是 IIS7？是否可以自定义它模拟的服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T02:24:38.650

我不认为它“模拟”了，tbh，它只是一个用于本地开发的 Web 服务器，其中 IIS 不是一个选项，基于[Cassini](http://www.asp.net/Downloads/archived/cassini/)。更多信息[在这里](http://msdn.microsoft.com/en-us/library/58wxa9w5(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T02:31:00.760

它不会像这样模拟服务器，它在基于 cassini 的服务器上运行，该服务器是用 .net 编写的并且具有可用的源代码。我想它更类似于 IIS6，因为它不支持 IIS7 集成管道功能。如果安装了 VS，您始终可以选择让 VS 使用 II6 或 IIS7（取决于您的 DEV PC 上是否有 XP 或 Vista）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T02:24:33.393

抱歉，这是一个问题，而不是答案：IIS6 和 II7 之间的服务器差异对您的代码有什么影响？

对于 ASP.NET 开发，Web 服务器本身在某种程度上是 ASP.NET 中立的。它将请求转发到 .NET 框架，所以这才是最重要的部分。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/58wxa9w5.aspx](http://msdn.microsoft.com/en-us/library/58wxa9w5.aspx)

将 Morgan Cheng 的评论添加到答案中：IIS6 和 IIS7 在如何解释 web.config 方面存在一些差异。例如，要自定义 UrlRouteHandler，根据 MSDN。IIS6 和 IIS7 是不同的。[http://msdn.microsoft.com/en-us/library/system.web.routing.urlroutinghandler.aspx](http://msdn.microsoft.com/en-us/library/system.web.routing.urlroutinghandler.aspx)中的详细信息

# database - 多个数据库与单个数据库

> ID：282823
> 
> 赞同：7
> 
> 时间：2008-11-12T02:29:12.870
> 
> 标签：database, database-design

我正在查看一个现有站点，他们正在使用单独的数据库。数据库似乎以下列方式设置：

*   一般类型（user_type、语言、年龄等）
*   会员资料（注册信息和登录）
*   站点配置

就个人而言，我会将所有内容放入 1 个数据库中。对我来说，这比几乎总是必须将数据库名称放在每个表的前面更容易。

从安全角度来看，我可以确保人们不会意外访问错误的数据，但是在这个站点上，将有管理员（大约 10% 的站点用户）需要访问所有数据库，进行交叉操作数据库搜索。

做独立数据库的原因可能是什么？（该站点使用 PHP 和 MySQL。）

**编辑：**数据库的名称是：

*   `sitename`（实际站点名称）（一般类型）
*   `member`（会员资料）
*   `siteconfig`（网站配置）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T02:35:14.120

纯粹猜测创作者的想法：

也许数据的波动性不同，因此不同的物理数据库可能有不同的备份/复制策略？

也许一个想法说，“一般类型”可以在多个应用程序之间共享，但“站点配置”，例如，将特定于一个应用程序？

也许一个想法是不同的数据库可以放在具有不同性能特征的不同硬件上，比如它们的 RAID 配置。大量读取但未更新的数据与大量更新的数据。

再次，纯粹的猜测......

@Darryl - 我的回答是考古学而不是技术。我不是说我买任何一个。我只是想进入祖先的心态......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T02:41:05.230

也纯粹是猜测：也许这是支持关注点分离的架构决策。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T02:49:27.837

我想不出为您列出的信息创建多个数据库的理由，特别是如果这些数据需要交叉链接。听起来更像是有人不知道如何使用权限，所以他们没有授予对表的访问权限，而是创建了新数据库。只是一种意见，但将事情减少到一个数据库可能会是一种改进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-08T06:16:31.380

我们在android中尤其面临这样一个问题*（供参考）*

**在 Android 的多模块应用程序中使用数据库**

当我们模块化一个应用程序时，我们面临着将数据库保存在哪里的问题。虽然没有特定的正确方法可以做到这一点，但其中一种实现是为整个应用程序使用单个公共数据库。另一种是为核心通用功能创建一个数据库，然后为功能模块分离。

**单一数据库的优缺点**

*优点：*

1.  易于维护数据库连接，因为我们只需要打开一个数据库连接。
2.  易于共享表。

*缺点：*

1.  模块之间没有隔离，因此我们需要重命名这些表，以免模块之间发生冲突。
2.  共享域中没有特定实体。我们需要将所有实体和 daos 放入 app 附带的核心模块中。

**一个数据库/模块的优点/缺点**

*优点：*

1.  模块之间的完美隔离。

*缺点：*

1.  数据库连接维护。如果我们想跨模块编写查询，那是很复杂的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-12T03:12:40.050

如果有充分的理由将数据库拆分成这样的一组较小的数据库，那么这些数据库的名称可能会像“hadronsupercolliderrawdata”和“googlebackup_2008”。像“generaltypes”和“memberdata”这样的名字表明他们只是被愚蠢所淹没。

# ruby-on-rails - Rails 是黑盒子吗？

> ID：282825
> 
> 赞同：19
> 
> 时间：2008-11-12T02:30:05.410
> 
> 标签：ruby-on-rails

我最近一直在做一些简单的 Rails 应用程序。我非常了解 ruby​​，但是当我开始以“rails 方式”做事时，我注意到有些事情是“仅仅因为”而完成的，而且（rails）新手很难知道代码的作用。

Rails 是否错过了重点并变成了某种第四代语言？我的意思是，为了开发 Rails 网站，您必须做一些事情（您不需要了解），而另一种方法是探索源代码以弄清楚什么是做什么的。

我还看到人们向任何可以做好的 Rails 教程的人付钱......我们正在谈论一个将简单性放在首位的框架，是否有必要为好的教程付费？

不要误会我的意思，我相信 Rails 为主流带来了非常好的想法（比如约定优于配置），但是这种过度简化（“只需输入这行代码......它就可以了！”）降低了框架的简单性试图实现？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-12T03:50:33.920

我认为这是一个观点问题。从广泛的角度来看，Rails 社区认为该框架*是*那么简单的东西。但事实是，事实并非如此。事实上，我使用 Rails 的次数越多，我就越不喜欢。我不认为这是 Rails 的错，但我认为很多人都认为编写 Rails 是应用程序在某种程度上类似于挥舞魔杖（我自己也喝过那杯饮料）。

Rails 确实兑现了许多承诺，因为它提供了许多几乎不需要配置的功能。诸如 ORM、模型关系和验证之类的东西设置起来很简单，并且为微调应用程序逻辑和专注于设计之类的事情留下了更多的时间。Rails 代码也非常非常容易重构。Rails 绝对可以让您用很少的代码完成很多工作。

当我想走出人迹罕至的道路时，我会感到沮丧。我可能想实现“非常具体的功能 X”，但我不知道从哪里开始。我发现我对框架越深入，信息就越稀疏。部分 API 的文档记录严重不足。这迫使我依赖第三方插件，其中一些没有文档，并且维护得不好。我几乎被一篇博客文章所困扰，告诉我将这段代码或那段代码复制到我的应用程序中，一切都会奏效（谢天谢地，他们通常会这样做）。

我的一些麻烦可能与我的一般经验不足有关（仍在从设计师过渡到程序员），但我经常觉得尽管 Rails 为构建网站提供了出色的工具，但至少从表面上看，它并没有为构建网站提供出色的工具。构建其他工具。它有潜力，但你真的必须深入挖掘。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-12T03:33:02.880

约定优于配置的问题在于您需要了解约定。至少有了一个配置文件，您在开始时就可以阅读一些内容......一旦您了解了约定，它就会变得更快，但与此同时您还有学习悬崖要应对。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-12T20:32:13.603

> Rails 是黑盒子吗？

Rails 确实有一些“神奇的代码”，您只需编写教程所说的内容，并且东西神奇地工作，但它根本不是一个黑匣子。

1.  根据定义，“黑匣子”是您无法查看的东西。因此，您不能拥有“黑匣子”开源项目。[这里是rails 2.1 stable源码](http://github.com/rails/rails/tree/2-1-stable/)，看一下

2.  如果您不喜欢阅读源代码，那么大多数这些“神奇功能”在许多网站和博客上都有很好的记录和解释（如果不是，您可以随时在这里提问，我 100% 确定您会得到一个很好的回应）

3.  请记住，如果您仍处于教程阶段，那么任何教程都会有很多“只需输入这行代码”，因为他们试图让*概念*理解，而不是深入研究所有内容的内部工作原理。这个星球上的所有其他框架，不仅仅是 rails，在他们的教程中都有“魔法”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-12T03:08:50.713

我发现 Rails 很容易使用。您可能想[学习使用 Rails 进行敏捷 Web 开发](http://www.pragprog.com/titles/rails2/agile-web-development-with-rails)。这对我学习“Rails 方式”有很大帮助。我将它用作参考而不是教程，但它会引导您创建应用程序并解释正在发生的事情。FWIW，我比 ASP.NET（我还在学习）更快地学习 Rails，并且知道 Rails 对学习 ASP.NET MVC 有很大帮助。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-12T03:24:12.977

与任何事情一样，我认为魔鬼在细节中。是的，建立一个站点并将各个部分拼凑在一起以制作出可行的东西非常容易，但是要提出一个设计良好且强大的系统需要更深入的设计和思考。很容易开始做出糟糕的 OO 决策，比如违反 Demeter 法则，因为事情很快就会放在一起。Rails 就是*这么*简单。Great Rails 不是。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-12T12:46:10.627

我相信“了解你的约定”不是问题。我知道，如果我做 X，那么我就有 Y 工作。但是 X 做了什么？Rails 对我来说就像一个黑盒子，讽刺的是，当它谈到“约定优于配置”时，构建 Rails 应用程序的整个过程更像是配置而不是编程。

不久前，我在遵循 Jruby on Rails (Ola Bini) 的示例时遇到了这个奇怪的异常......

> CreateProductCategories 不缺少常量 ProductType！

发生这种情况是因为 rails 版本不同，但关键是……一切都很好，直到你走错了黄金之路，黑匣子不再帮助你，然后你意识到你不知道自己在做什么自始至终开始在论坛/邮件列表中寻求帮助（然后您会发现大多数人不知道他们在做什么或为什么，只是它起作用了）。

无论如何，很高兴知道我没有疯，有些人遇到过这种问题。谢谢大家。

PS：英语不是我的自然语言，所以如果您发现语法错误，请编辑它们。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-09T02:24:12.680

我对 Rails 内部如何工作有一些小知识，我真的希望 Katz 为 rails 3.0 所做的工作将使 Rails 内部更容易理解，特别是更多文档。AFAIK，他一直在“模块/层”之间创建一些定义良好的接口，例如所有 ORM 共享一个通用接口，因此您不仅可以替换 ORM，还可以轻松理解与 rails 和ORM。

反对主流观点，我认为 rails 是一个非常困难的框架，比纯 php 复杂得多。在您不了解的框架上进行中继会产生一些后果，并且即使对于经验丰富的 ruby​​ist 来说，学习 Rails 内部也并不容易。

另一方面，生态系统的发展速度非常快，这又增加了一层难度，在上个月，我添加了至少 3 到 4 颗宝石，而在我完全改变工作流程的前一个月，我将黄瓜添加到了我的流程中。但是，我想这就是我为 IT 行业付出的代价。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-25T20:25:14.607

我同意布莱恩 M。

如此多的黑魔法和诡异的事情正在发生，数千行代码，元元编程无处不在。

但公平地说，Rails 让我非常喜欢规范驱动的开发、REST 和对 Ruby 的良好理解。

现在，我有 20% 的时间是顺利的，而另外 80% 的时间我都在与 Rails 约定作斗争。当我编写纯 Ruby 时，我感觉效率更高。

在某些时候，Merb 似乎是一种选择，下一个项目我将使用 Rack/Sinatra 和 CouchDB。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T19:47:32.820

Pablo 你可能想研究 Django，它是由一个选择专注于提供高质量文档作为优先事项的团队开发的。

# javascript - XmlHttpRequest 在不同浏览器中的行为有何不同？

> ID：282831
> 
> 赞同：2
> 
> 时间：2008-11-12T02:33:36.293
> 
> 标签：javascript, xmlhttprequest

我想看看使用 XmlHttpWebRequest 的问题是什么，以便它适用于 Safari、Firefox 和 IE？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T02:40:13.690

可能最明显的区别是如何首先获取 XMLHttpRequest：

```
var xhr;
if (window.XMLHttpRequest) {
   xhr = new XMLHttpRequest(); // Mozilla/Webkit/Opera
} else if (window.ActiveXObject) {
   xhr = new ActiveXObject('Msxml2.XMLHTTP'); // IE
} else {
   throw new Error('Ajax likely not supported');
} 
```

话虽如此，我会强烈研究一个抽象库，例如[jQuery](http://jquery.com)。它使 ajax 之类的事情变得非常容易：

```
$('#container').load('/ajax/resource'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T09:15:49.617

有一篇非常好的文章，介绍了[在 XMLHttpRequest 实现中发现的所有主要错误，](http://www.ilinsky.com/articles/XMLHttpRequest/)以及一个非常[简单的 XMLHttpRequest 包装器实现，](http://code.google.com/p/xmlhttprequest/)它可以解决这些错误，同时暴露完全相同的 XMLHttpRequest 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T02:39:39.227

这是一个被这个问题弄脏的人：

[http://www.webmasterworld.com/javascript/3195000.htm](http://www.webmasterworld.com/javascript/3195000.htm)

研究这些问题的一种通用方法是查看 javascript 库（如 jQuery）的源代码，因为该库的功能之一是处理差异。这是处理 XMLHttpRequest 的 jQuery 片段。请注意有关浏览器差异的注释。

```
 // Create the request object; Microsoft failed to properly
    // implement the XMLHttpRequest in IE7, so we use the ActiveXObject when it is available
    var xhr = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();

    // Open the socket
    // Passing null username, generates a login popup on Opera (#2865)
    if( s.username )
        xhr.open(type, s.url, s.async, s.username, s.password);
    else
        xhr.open(type, s.url, s.async);

    // Need an extra try/catch for cross domain requests in Firefox 3
    try { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T02:53:19.357

我知道这是一个逃避现实的答案，但如果你使用内置的和跨浏览器不一致的方法，这种事情会让你发疯。选择任何 javascript 库，然后松一口气。

# c# - 通用字典作为参考方法参数

> ID：282832
> 
> 赞同：0
> 
> 时间：2008-11-12T02:34:06.120
> 
> 标签：c#

我正在尝试做这样的事情

```
public void GetData(ref Dictionary<T,V> dataDictionary)
{

} 
```

其中 T 可以是 GUID、字符串或 int，而 V 是自定义用户或项目对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T02:41:05.717

为什么你想要改变调用者参考的能力？为什么不是

```
public Dictionary<T,V> GetData<T,V>() 
```

够好了？

在您的基于 ref 的世界中：

```
public void GetData<T,V>(ref Dictionary<T,V> dictionary) 
```

* * *

编辑：并不是说我以任何方式纵容以下内容，但是......

如果您需要关心 T 的不同类型，您可以创建泛型覆盖，就像创建任何覆盖方法一样。

```
// client code
Dictionary<int, object> x = null;
GetData(ref x);

Dictionary<string, Guid> y = null;
GetData(ref y); 
```

通用覆盖：

```
public void GetData<V>(ref Dictionary<int, V> dictionary)
{
    dictionary = new Dictionary<int,V>(); // reassign reference.
}
public void GetData<V>(ref Dictionary<string, V> dictionary) { ... }
public void GetData<V>(ref Dictionary<Guid, V> dictionary) { ... } 
```

虽然在语义上相同，但由于歧义，返回值不可能进行以下覆盖。

```
public Dictionary<int, T> ReturnData<T>() { ... }
public Dictionary<string, T> ReturnData<T>() { ... } 
```

> 错误 CS0111：类型“测试”已经定义了一个名为“ReturnData”的成员，具有相同的参数类型

您可以通过传入和传出对象来解决歧义，但这同样可怕：

```
public Dictionary<int, T> ReturnData<T>(Dictionary<int, T> self) { ... }
public Dictionary<string, T> ReturnData<T>(Dictionary<string, T> self) { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T02:40:43.813

这有帮助吗？任何其他信息都会有所帮助。

```
public void GetData<T, V>(ref Dictionary<T, V> dataDictionary) {
    if (typeof(T) == typeof(string) || typeof(T) == typeof(int) || typeof(T) == typeof(Guid)) {
       ...
    } else {
        throw new ArgumentException();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T07:33:46.420

这里的目标是什么？你提到`string`/ `Guid`etc 只是例子，所以我认为我们不需要关注那些......

如果您只是想能够操作字典内容，那么“完成” - 这已经有效。由于`Dictionary<,>`是引用类型，调用者将已经看到您所做的任何更改。也可以去掉`ref`...

```
public void GetData(Dictionary<T,V> dataDictionary) // or IDictionary<T,V>
{
    T key = GetSomeKey();
    V value = dataDictionary[key]; // query
    dataDictionary.Remove(key); // mutate
} 
```

# c# - 在面板内的控件顶部绘图（C# WinForms）

> ID：282838
> 
> 赞同：46
> 
> 时间：2008-11-12T02:37:24.023
> 
> 标签：c#, .net, winforms

我知道这个问题已经被问了好几次了，但到目前为止我还没有找到一个好的解决方案。

我有一个面板，上面有其他控件。
我想在它上面画一条线，在面板中的所有控件之上

我遇到了 3 种类型的解决方案（没有一种按我想要的方式工作）：

1.  获取桌面 DC 并在屏幕上绘制。
    如果它们与表单重叠，这将利用其他应用程序。

2.  覆盖面板的“CreateParams”：

=

```
protected override CreateParams CreateParams {  
  get {  
    CreateParams cp;  
    cp = base.CreateParams;  
    cp.Style &= ~0x04000000; //WS_CLIPSIBLINGS
    cp.Style &= ~0x02000000; //WS_CLIPCHILDREN
    return cp;  
  }  
} 
```

//注意我也试过禁用 WS_CLIPSIBLINGS

然后画线 OnPaint()。但是...由于面板的 OnPaint 是在其中控件的 OnPaint 之前调用的，因此内部控件的绘制只是在线上绘制。
我看到有人建议使用消息过滤器来收听 WM_PAINT 消息，并使用计时器，但我认为这种解决方案既不是“好的做法”，也不是有效的。
你会怎么做 ？判断里面的控件在X ms后绘制完毕，设置定时器为X ms ?

* * *

此屏幕截图显示了 WS_CLIPSIBLINGS 和 WS_CLIPCHILDREN 已关闭的面板。
蓝线是在面板的 OnPaint 上绘制的，并且只是由文本框和标签绘制。
红线被绘制在顶部只是因为它不是从面板的 OnPaint 绘制的（它实际上是由于单击按钮而绘制的）
![替代文字](https://i73.photobucket.com/albums/i201/sdjc1/temp/screen3.png)

* * *

第三：创建一个透明层并在该层之上绘图。
我使用以下方法创建了一个透明控件：

```
protected override CreateParams CreateParams {  
  get {  
    CreateParams cp = base.CreateParams;  
    cp.ExStyle |= 0x00000020; //WS_EX_TRANSPARENT  
    return cp;  
  }  
} 
```

问题仍然是，将透明控件放在面板及其所有控件的顶部。
我已经尝试使用： "BringToFront()" 将它带到最前面，但它似乎没有帮助。
我已将它放在 Line 控件的 OnPaint() 处理程序中。
我应该尝试将它放在其他地方吗？
- 这也会造成在面板顶部有另一个控件的问题。（捕捉鼠标点击等..）

**任何帮助将不胜感激！**

**编辑：黑线是我尝试做的一个示例。（用窗户漆来画它）

![替代文字](https://i73.photobucket.com/albums/i201/sdjc1/temp/screen2.jpg)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-25T06:48:03.443

事实证明这比我想象的要容易得多。感谢您不接受我的任何其他答案。**这是创建Fline**的两步过程（**f**浮动**线**- 抱歉，来晚了）：

[![替代文字](https://i.stack.imgur.com/MG0Lw.jpg)](https://i.stack.imgur.com/MG0Lw.jpg)

**第 1 步**：将 UserControl 添加到您的项目中，并将其命名为“Fline”。在 using 语句中添加以下内容：

```
using System.Drawing.Drawing2D; 
```

**第 2 步**：将以下内容添加到 Fline 的 Resize 事件中：

```
int wfactor = 4; // half the line width, kinda
// create 6 points for path
Point[] pts = {
    new Point(0, 0), 
    new Point(wfactor, 0), 
    new Point(Width, Height - wfactor),
    new Point(Width, Height) ,
    new Point(Width - wfactor, Height),
    new Point(0, wfactor) };
// magic numbers! 
byte[] types = {
    0, // start point
    1, // line
    1, // line
    1, // line
    1, // line
    1 }; // line 
GraphicsPath path = new GraphicsPath(pts, types);
this.Region = new Region(path); 
```

编译，然后将 Fline 拖到您的窗体或面板上。重要提示：默认 BackColor 与表单相同，因此**将 Fline 的 BackColor 更改为 Red**或其他明显的东西（在设计器中）。一个奇怪的怪癖是，当你在设计器中拖动它时，它会显示为一个实心块，直到你释放它——这没什么大不了的。

此控件可以出现在任何其他控件的前面或后面。如果将 Enabled 设置为 false，它仍然可见，但不会干扰下方控件上的鼠标事件。

当然，您会希望根据自己的目的来增强它，但这显示了基本原则。您可以使用相同的技术来创建您喜欢的任何形状的控件（我对此的初步测试制作了一个三角形）。

**更新**：这也是一个很好的密集单线。只需将它放在您的 UserControl 的 Resize 事件中：

```
this.Region=new Region(new System.Drawing.Drawing2D.GraphicsPath(new Point[]{new Point(0,0),new Point(4,0),new Point(Width,Height-4),new Point(Width,Height),new Point(Width-4,Height),new Point(0,4)},new byte[]{0,1,1,1,1,1})); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-12T02:51:07.490

如果您希望线条只是一条简单的水平线或垂直线，请在主面板上放置另一个面板（禁用，因此它不会拾取任何鼠标事件），将其高度（或宽度）设置为 3 或 4 像素（或无论你想要什么），然后把它带到前面。如果您需要在运行时更改线条的位置，您只需移动面板并使其可见和不可见。这是它的外观：

[![替代文字](https://i.stack.imgur.com/hI7Le.jpg)](https://i.stack.imgur.com/hI7Le.jpg)

你甚至可以点击任何你喜欢的地方，而且线条完全不会干扰。这条线是在任何类型的控件上绘制的（尽管 ComboBox 或 DatePicker 的下拉部分仍然显示在这条线的上方，这无论如何都很好）。蓝线是同样的东西，但发送到后面。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-18T01:37:32.433

是的，这是可以做到的。问题是面板和它上面的控件都是独立的窗口（在 API 意义上），因此都是独立的绘图表面。没有一个绘图表面可以绘制来获得这种效果（除了顶级屏幕表面，在上面绘制被认为是不礼貌的）。

（ cough- **hack** -cough）技巧是在控件下方的面板上画线，并在每个控件本身上画线，从而导致这种情况（即使您单击按钮并四处移动鼠标也会持续存在） ):

[![替代文字](https://i.stack.imgur.com/w81SF.gif)](https://i.stack.imgur.com/w81SF.gif)

创建一个 winforms 项目（默认情况下应与 Form1 一起提供）。如图所示，在面板上添加一个面板（名为“panel1”）和两个按钮（“button1”和“button2”）。在表单的构造函数中添加以下代码：

```
panel1.Paint += PaintPanelOrButton;
button1.Paint += PaintPanelOrButton;
button2.Paint += PaintPanelOrButton; 
```

然后将此方法添加到表单的代码中：

```
private void PaintPanelOrButton(object sender, PaintEventArgs e)
{
    // center the line endpoints on each button
    Point pt1 = new Point(button1.Left + (button1.Width / 2),
            button1.Top + (button1.Height / 2));
    Point pt2 = new Point(button2.Left + (button2.Width / 2),
            button2.Top + (button2.Height / 2));

    if (sender is Button)
    {
        // offset line so it's drawn over the button where
        // the line on the panel is drawn
        Button btn = (Button)sender;
        pt1.X -= btn.Left;
        pt1.Y -= btn.Top;
        pt2.X -= btn.Left;
        pt2.Y -= btn.Top;
    }

    e.Graphics.DrawLine(new Pen(Color.Red, 4.0F), pt1, pt2);
} 
```

为了使线条持续存在，需要在每个控件的 Paint 事件中绘制类似的内容。直接在 .NET 中的控件上绘图很容易，但是当有人单击按钮或将鼠标移到它上面时，您绘制的任何内容都会被擦除（除非它在 ​​Paint 事件中永久重绘，如此处所示）。

请注意，要使其正常工作，任何绘制的控件都必须具有 Paint 事件。我相信您将不得不修改此示例以实现您所需要的。如果您为此提出了一个很好的通用功能，请发布。

更新：此方法不适用于滚动条、文本框、组合框、列表视图或基本上任何带有文本框类型的东西作为它的一部分（并不是因为它只偏移上面示例中的按钮 - 你只是不能在一个文本框的顶部，至少不是来自它的 Paint 事件，至少如果你是我的话）。希望这不会是一个问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-12T04:25:11.043

Windows 窗体面板是控件的容器。如果您想在面板中的其他控件之上绘制一些东西，那么您需要的是另一个控件（在 z 顺序的顶部）。

幸运的是，您可以创建具有非矩形边框的窗体控件。看看这个技术： http: [//msdn.microsoft.com/en-us/library/aa289517 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa289517(VS.71).aspx)

要在屏幕上绘制一些东西，请使用标签控件，然后关闭 AutoSize。然后附加到 Paint 事件并设置 Size 和 Region 属性。

这是一个代码示例：

```
private void label1_Paint(object sender, PaintEventArgs e)
{
    System.Drawing.Drawing2D.GraphicsPath myGraphicsPath = new  System.Drawing.Drawing2D.GraphicsPath();
    myGraphicsPath.AddEllipse(new Rectangle(0, 0, 125, 125));
    myGraphicsPath.AddEllipse(new Rectangle(75, 75, 20, 20));
    myGraphicsPath.AddEllipse(new Rectangle(120, 0, 125, 125));
    myGraphicsPath.AddEllipse(new Rectangle(145, 75, 20, 20));
    //Change the button's background color so that it is easy
    //to see.
    label1.BackColor = Color.ForestGreen;
    label1.Size = new System.Drawing.Size(256, 256);
    label1.Region = new Region(myGraphicsPath);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-18T11:09:02.467

制作一个新的 LineControl ：像这样控制：

然后在 InitializeComponent 之后调用 BringToFront()

```
public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
            this.simpleLine1.BringToFront();
        }
    }

using System;
using System.Windows.Forms;
using System.Drawing;
using System.Collections.Generic;

public class SimpleLine : Control
{
    private Control parentHooked;   
    private List<Control> controlsHooked;

    public enum LineType
    {
        Horizontal,
        Vertical,
        ForwardsDiagonal,
        BackwardsDiagonal
    }

    public event EventHandler AppearanceChanged;
    private LineType appearance;
    public virtual LineType Appearance
    {
        get
        {
            return appearance;
        }
        set
        {
            if (appearance != value)
            {
                this.SuspendLayout();
                switch (appearance)
                {
                    case LineType.Horizontal:
                        if (value == LineType.Vertical)
                        {
                            this.Height = this.Width;
                        }

                        break;
                    case LineType.Vertical:
                        if (value == LineType.Horizontal)
                        {
                            this.Width = this.Height;
                        }
                        break;
                }
                this.ResumeLayout(false);

                appearance = value;
                this.PerformLayout();
                this.Invalidate();
            }
        }
    }
    protected virtual void OnAppearanceChanged(EventArgs e)
    {
        if (AppearanceChanged != null) AppearanceChanged(this, e);
    }

    public event EventHandler LineColorChanged;
    private Color lineColor;
    public virtual Color LineColor
    {
        get
        {
            return lineColor;
        }
        set
        {
            if (lineColor != value)
            {
                lineColor = value;
                this.Invalidate();
            }
        }
    }
    protected virtual void OnLineColorChanged(EventArgs e)
    {
        if (LineColorChanged != null) LineColorChanged(this, e);
    }

    public event EventHandler LineWidthChanged;
    private float lineWidth;
    public virtual float LineWidth
    {
        get
        {
            return lineWidth;
        }
        set
        {
            if (lineWidth != value)
            {
                if (0 >= value)
                {
                    lineWidth = 1;
                }
                lineWidth = value;
                this.PerformLayout();
            }
        }
    }
    protected virtual void OnLineWidthChanged(EventArgs e)
    {
        if (LineWidthChanged != null) LineWidthChanged(this, e);
    }

    public SimpleLine()
    {
        base.SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.Selectable, false);
        base.SetStyle(ControlStyles.SupportsTransparentBackColor, true);
        base.BackColor = Color.Transparent;

        InitializeComponent();

        appearance = LineType.Vertical;
        LineColor = Color.Black;
        LineWidth = 1;
        controlsHooked = new List<Control>();

        this.ParentChanged += new EventHandler(OnSimpleLineParentChanged);
    }

    private void RemoveControl(Control control)
    {
        if (controlsHooked.Contains(control))
        {
            control.Paint -= new PaintEventHandler(OnControlPaint);
            if (control is TextboxX)
            {
                TextboxX text = (TextboxX)control;
                text.DoingAPaint -= new EventHandler(text_DoingAPaint);
            }
            controlsHooked.Remove(control);
        }
    }

    void text_DoingAPaint(object sender, EventArgs e)
    {
        this.Invalidate();
    }

    private void AddControl(Control control)
    {
        if (!controlsHooked.Contains(control))
        {
            control.Paint += new PaintEventHandler(OnControlPaint);
            if (control is TextboxX)
            {
                TextboxX text = (TextboxX)control;
                text.DoingAPaint += new EventHandler(text_DoingAPaint);
            }
            controlsHooked.Add(control);
        }
    }

    private void OnSimpleLineParentChanged(object sender, EventArgs e)
    {
        UnhookParent();

        if (Parent != null)
        {

            foreach (Control c in Parent.Controls)
            {
                AddControl(c);
            }
            Parent.ControlAdded += new ControlEventHandler(OnParentControlAdded);
            Parent.ControlRemoved += new ControlEventHandler(OnParentControlRemoved);
            parentHooked = this.Parent;
        }
    }

    private void UnhookParent()
    {
            if (parentHooked != null)
            {
                foreach (Control c in parentHooked.Controls)
                {
                    RemoveControl(c);
                }
                parentHooked.ControlAdded -= new ControlEventHandler(OnParentControlAdded);
                parentHooked.ControlRemoved -= new ControlEventHandler(OnParentControlRemoved);
                parentHooked = null;
            }
    }

    private void OnParentControlRemoved(object sender, ControlEventArgs e)
    {
        RemoveControl(e.Control);
    }   

    private void OnControlPaint(object sender, PaintEventArgs e)
    {
        int indexa =Parent.Controls.IndexOf(this) , indexb = Parent.Controls.IndexOf((Control)sender);
        //if above invalidate on paint
        if(indexa < indexb)
        {
            Invalidate();
        }
    }

    private void OnParentControlAdded(object sender, ControlEventArgs e)
    {
        AddControl(e.Control);
    }

    private System.ComponentModel.IContainer components = null;
    private void InitializeComponent()
    {
        components = new System.ComponentModel.Container();
    }
    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    protected override CreateParams CreateParams
    {
        get
        {
            CreateParams cp = base.CreateParams;
            cp.ExStyle |= 0x20;  // Turn on WS_EX_TRANSPARENT
            return cp;
        }
    }

    protected override void OnLayout(LayoutEventArgs levent)
    {
        switch (this.Appearance)
        {
            case LineType.Horizontal:
                this.Height = (int)LineWidth;
                this.Invalidate();
                break;
            case LineType.Vertical:
                this.Width = (int)LineWidth;
                this.Invalidate();
                break;
        }

        base.OnLayout(levent);
    }

    protected override void OnPaintBackground(PaintEventArgs pevent)
    {
        //disable background paint
    }

    protected override void OnPaint(PaintEventArgs pe)
    {
        switch (Appearance)
        {
            case LineType.Horizontal:
                DrawHorizontalLine(pe);
                break;
            case LineType.Vertical:
                DrawVerticalLine(pe);
                break;
            case LineType.ForwardsDiagonal:
                DrawFDiagonalLine(pe);
                break;
            case LineType.BackwardsDiagonal:
                DrawBDiagonalLine(pe);
                break;
        }
    }

    private void DrawFDiagonalLine(PaintEventArgs pe)
    {
        using (Pen p = new Pen(this.LineColor, this.LineWidth))
        {
            pe.Graphics.DrawLine(p, this.ClientRectangle.X, this.ClientRectangle.Bottom,
                                    this.ClientRectangle.Right, this.ClientRectangle.Y);
        }
    }

    private void DrawBDiagonalLine(PaintEventArgs pe)
    {
        using (Pen p = new Pen(this.LineColor, this.LineWidth))
        {
            pe.Graphics.DrawLine(p, this.ClientRectangle.X, this.ClientRectangle.Y,
                                    this.ClientRectangle.Right, this.ClientRectangle.Bottom);
        }
    }

    private void DrawHorizontalLine(PaintEventArgs pe)
    {
        int  y = this.ClientRectangle.Height / 2;
        using (Pen p = new Pen(this.LineColor, this.LineWidth))
        {
            pe.Graphics.DrawLine(p, this.ClientRectangle.X, y,
                                    this.ClientRectangle.Width, y);
        }
    }

    private void DrawVerticalLine(PaintEventArgs pe)
    {
        int x = this.ClientRectangle.Width / 2;
        using (Pen p = new Pen(this.LineColor, this.LineWidth))
        {
            pe.Graphics.DrawLine(p,x, this.ClientRectangle.Y,
                                   x, this.ClientRectangle.Height);
        }
    }
} 
```

编辑：添加对角线支持

我添加了一些对在获得焦点时重绘的控件的支持。

文本框和组合框无法正常工作，因为您需要自己制作并在其中挂上类似这样的油漆命令：

```
public class TextboxX : TextBox
{
    public event EventHandler DoingAPaint;
    protected override void WndProc(ref Message m)
    {
        switch ((int)m.Msg)
        {
            case (int)NativeMethods.WindowMessages.WM_PAINT:
            case (int)NativeMethods.WindowMessages.WM_ERASEBKGND:
            case (int)NativeMethods.WindowMessages.WM_NCPAINT:
            case 8465: //not sure what this is WM_COMMAND?
                if(DoingAPaint!=null)DoingAPaint(this,EventArgs.Empty);
                break;
        }           
        base.WndProc(ref m);
    }
} 
```

它未经测试，我相信你可以改进它

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-12T03:09:21.353

我能想到的唯一简单的解决方案是为要在其上绘制的每个控件创建 Paint 事件处理程序。然后协调这些处理程序之间的线条绘制。这不是最方便的解决方案，但是这将使您能够在控件 *之上进行绘制。*

假设按钮是面板的子控件：

```
panel.Paint += new PaintEventHandler(panel_Paint);
button.Paint += new PaintEventHandler(button_Paint);

protected void panel_Paint(object sender, PaintEventArgs e)
{
    //draw the full line which will then be partially obscured by child controls
}

protected void button_Paint(object sender, PaintEventArgs e)
{
    //draw the obscured line portions on the button
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-12-30T17:30:45.660

解决方案#1（获取桌面 DC 并在屏幕上绘制）怎么样：

1.  获取桌面 DC 和该 DC 的图形对象 [Graphics.fromHDC(...)]
2.  将生成的 Graphics 对象的 Clip 属性设置为窗体的当前可见区域。（我还没有研究如何找到表单的可见区域）
3.  进行图形渲染。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-05-17T12:59:22.853

**编辑**找到了一种方法来摆脱我遇到的递归绘画问题。所以，现在，对我来说，这看起来非常、非常、非常接近你想要实现的目标。

这是我能想到的。它使用原始问题中概述的方法#3。代码有点长，因为涉及三个类：

1.  一个名为DecorationCanvas 的私有类。这派生自 Panel 并使用 WS_EX_TRANSPARENT 提供透明画布来绘制我们的东西
2.  面板类本身，我称之为 DecoratedPanel，它派生自 Panel
3.  一个名为 DecoratedPanelDesigner 的面板设计器类，以确保在设计期间可以保留 ZOrder。

基本方法是：

*   在 DecoratedPanel 的构造函数中，创建DecoratedCanvas 的实例并将其添加到DecoratedPanel Controls 集合中。
*   覆盖 OnControlAdded 和 OnControlRemoved，以自动挂钩/取消挂钩子控件的绘制事件，并确保 DecorationCanvas 保持在 ZOrder 之上。
*   每当一个包含的控件绘制时，使相应的DecorationCanvas 矩形无效。
*   覆盖 OnResize 和 OnSizeChanged 以确保 DecorationCanvas 与 DecoratedPanel 具有相同的大小。（我尝试使用 Anchor 属性来完成此操作，但它以某种方式失败了）。
*   提供一个内部方法来从 DecoratedPanelDesigner 中重置 DecorationCanvas ZOrder。

在我的系统（VS2010 / .net4 / Windows XP SP3）上运行良好。这是代码：

```
using System;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.Design;

namespace WindowsFormsApplication3
{
  [Designer("WindowsFormsApplication3.DecoratedPanelDesigner")]
  public class DecoratedPanel : Panel
  {
    #region decorationcanvas

    // this is an internal transparent panel.
    // This is our canvas we'll draw the lines on ...
    private class DecorationCanvas : Panel
    {
      public DecorationCanvas()
      {
        // don't paint the background
        SetStyle(ControlStyles.Opaque, true);
      }

      protected override CreateParams CreateParams
      {
        get
        {
          // use transparency
          CreateParams cp = base.CreateParams;
          cp.ExStyle |= 0x00000020; //WS_EX_TRANSPARENT
          return cp;
        }
      }
    }

    #endregion

    private DecorationCanvas _decorationCanvas;

    public DecoratedPanel()
    {
      // add our DecorationCanvas to our panel control
      _decorationCanvas = new DecorationCanvas();
      _decorationCanvas.Name = "myInternalOverlayPanel";
      _decorationCanvas.Size = ClientSize;
      _decorationCanvas.Location = new Point(0, 0);
      // this prevents the DecorationCanvas to catch clicks and the like
      _decorationCanvas.Enabled = false;
      _decorationCanvas.Paint += new PaintEventHandler(decoration_Paint);
      Controls.Add(_decorationCanvas);
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing && _decorationCanvas != null)
      {
        // be a good citizen and clean up after yourself

        _decorationCanvas.Paint -= new PaintEventHandler(decoration_Paint);
        Controls.Remove(_decorationCanvas);
        _decorationCanvas = null;
      }

      base.Dispose(disposing);
    }

    void decoration_Paint(object sender, PaintEventArgs e)
    {
      // --- PAINT HERE ---
      e.Graphics.DrawLine(Pens.Red, 0, 0, ClientSize.Width, ClientSize.Height);
    }

    protected override void OnControlAdded(ControlEventArgs e)
    {
      base.OnControlAdded(e);

      if (IsInDesignMode)
        return;

      // Hook paint event and make sure we stay on top
      if (!_decorationCanvas.Equals(e.Control))
        e.Control.Paint += new PaintEventHandler(containedControl_Paint);

      ResetDecorationZOrder();
    }

    protected override void OnControlRemoved(ControlEventArgs e)
    {
      base.OnControlRemoved(e);

      if (IsInDesignMode)
        return;

      // Unhook paint event
      if (!_decorationCanvas.Equals(e.Control))
        e.Control.Paint -= new PaintEventHandler(containedControl_Paint);
    }

    /// <summary>
    /// If contained controls are updated, invalidate the corresponding DecorationCanvas area
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    void containedControl_Paint(object sender, PaintEventArgs e)
    {
      Control c = sender as Control;

      if (c == null)
        return;

      _decorationCanvas.Invalidate(new Rectangle(c.Left, c.Top, c.Width, c.Height));
    }

    protected override void OnResize(EventArgs eventargs)
    {
      base.OnResize(eventargs);
      // make sure we're covering the panel control
      _decorationCanvas.Size = ClientSize;
    }

    protected override void OnSizeChanged(EventArgs e)
    {
      base.OnSizeChanged(e);
      // make sure we're covering the panel control
      _decorationCanvas.Size = ClientSize;
    }

    /// <summary>
    /// This is marked internal because it gets called from the designer
    /// to make sure our DecorationCanvas stays on top of the ZOrder.
    /// </summary>
    internal void ResetDecorationZOrder()
    {
      if (Controls.GetChildIndex(_decorationCanvas) != 0)
        Controls.SetChildIndex(_decorationCanvas, 0);
    }

    private bool IsInDesignMode
    {
      get
      {
        return DesignMode || LicenseManager.UsageMode == LicenseUsageMode.Designtime;
      }
    }
  }

  /// <summary>
  /// Unfortunately, the default designer of the standard panel is not a public class
  /// So we'll have to build a new designer out of another one. Since Panel inherits from
  /// ScrollableControl, let's try a ScrollableControlDesigner ...
  /// </summary>
  public class DecoratedPanelDesigner : ScrollableControlDesigner
  {
    private IComponentChangeService _changeService;

    public override void Initialize(IComponent component)
    {
      base.Initialize(component);

      // Acquire a reference to IComponentChangeService.
      this._changeService = GetService(typeof(IComponentChangeService)) as IComponentChangeService;

      // Hook the IComponentChangeService event
      if (this._changeService != null)
        this._changeService.ComponentChanged += new ComponentChangedEventHandler(_changeService_ComponentChanged);
    }

    /// <summary>
    /// Try and handle ZOrder changes at design time
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    void _changeService_ComponentChanged(object sender, ComponentChangedEventArgs e)
    {
      Control changedControl = e.Component as Control;
      if (changedControl == null)
        return;

      DecoratedPanel panelPaint = Control as DecoratedPanel;

      if (panelPaint == null)
        return;

      // if the ZOrder of controls contained within our panel changes, the
      // changed control is our control
      if (Control.Equals(panelPaint))
        panelPaint.ResetDecorationZOrder();
    }

    protected override void Dispose(bool disposing)
    {
      if (disposing)
      {
        if (this._changeService != null)
        {
          // Unhook the event handler
          this._changeService.ComponentChanged -= new ComponentChangedEventHandler(_changeService_ComponentChanged);
          this._changeService = null;
        }
      }

      base.Dispose(disposing);
    }

    /// <summary>
    /// If the panel has BorderStyle.None, a dashed border needs to be drawn around it
    /// </summary>
    /// <param name="pe"></param>
    protected override void OnPaintAdornments(PaintEventArgs pe)
    {
      base.OnPaintAdornments(pe);

      Panel panel = Control as Panel;
      if (panel == null)
        return;

      if (panel.BorderStyle == BorderStyle.None)
      {
        using (Pen p = new Pen(SystemColors.ControlDark))
        {
          p.DashStyle = System.Drawing.Drawing2D.DashStyle.Dash;
          pe.Graphics.DrawRectangle(p, 0, 0, Control.Width - 1, Control.Height - 1);
        }
      }
    }
  }
} 
```

让我知道你的想法 ...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-17T12:13:49.030

原始代码应该是：

```
 protected override CreateParams CreateParams
    {
        get
        {
            CreateParams cp;
            cp = base.CreateParams;
            cp.Style &= 0x7DFFFFFF; //WS_CLIPCHILDREN
            return cp;
        }
    } 
```

这行得通！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-12T09:53:35.000

我认为最好的方法是继承要在其上画线的控制权。覆盖 OnPaint 方法，从内部调用 base.Paint()，然后使用相同的图形实例绘制线条。同时，你也可以有一个参数来指定在哪一点画线，这样你就可以直接从你的主窗体中控制线。

# gcc - 什么标志使 GCC 关于文件结尾没有换行符的警告静音？

> ID：282851
> 
> 赞同：6
> 
> 时间：2008-11-12T02:47:42.567
> 
> 标签：gcc, warnings, compiler-flags

我刚刚阅读[了这篇](https://stackoverflow.com/questions/72271/no-newline-at-end-of-file-compiler-warning)关于为什么存在换行警告的帖子，但老实说，我的团队有一些人在几个不同的平台上工作，并与几个不同的编辑器一起工作（每个人都使用最适合他们的东西），所以警告已经无处不在，而且因为它不是真正值得关注的警告已成为噪音，并使查找严重警告变得麻烦。

很多时候重要的警告都被忽视了，因为人们已经习惯了无数无用的警告经过，所以他们显然只是停止仔细查看它们，恕我直言。可以说在我们的案例中，GCC 哭得太狼狈了，以至于任何人都不再认真对待它，这是一种不好的态度，但它只是人性。

现在我们用 编译`-Wall`，因为我们想要警告，但是是否有一个计数器标志来避免换行警告？

**注意：**我仔细阅读了手册，但没有在任何明显的地方找到答案，所以我放弃了。

**注意：**作为对 Robert Gamble 完全合理的解决方案的回应，我们的代码是跨平台的，并且我们有人员并在 Linux、Solaris 和 Windows 上构建，因此新行……尚未达成共识。并且某人的编译器总是会哭狼。因为有超过 40 名开发人员，以及其他非程序员人员。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T03:27:45.107

假设您使用某种源代码控制系统，您可以添加一个预提交挂钩，以确保文本文件以正确的换行符结尾。此外，根据您使用的源代码控制系统，您可以添加一个预提交钩子，如果它不存在，它实际上会*修复*行尾。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T03:08:55.893

据我所知，没有一个，我已经使用 GCC 多年了。

**更新：** C++11 标准不应该有任何警告。[相关问](https://stackoverflow.com/a/72409/463758)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T02:56:38.617

你为什么不只是确保你的文件有一个终止的换行符，就像他们应该的那样？这应该是有问题的编辑器中的简单配置更改，并且似乎是“消除”警告的一种非常简单的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-18T20:01:30.337

```
-Wno-eof-newline 
```

这是与[gcc 错误 14331的修复一起添加的](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=14331)

* * *

奇怪的是，我实际上无法让 gcc 输出缺少换行符的警告。我想较新的版本完全没有这个警告。

我可以让 gcc 接受`-Wno-eof-newline`，但是当我尝试时它抱怨无法识别的标志`-Weof-newline`。C++11 取消了对文件末尾换行符的要求，但是为了在旧标准中编写可移植代码，确实应该可以启用这种迂腐警告。

* * *

幸运的是，clang 仍然正确支持有关缺少换行符的诊断：此警告可以`-Wnewline-eof`在所有模式下启用，或者在 C++11 和更高模式下也可以使用`-Wc++98-compat-pedantic`.

这些警告默认情况下是关闭的，但是如果您利用 clang 的`-Weverything`标志来启用“减法”策略来控制警告，那么在 C++11 和更高模式下，您需要同时`-Wno-newline-eof`禁用`-Wno-c++98-compat-pedantic`警告。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T03:00:59.263

我有 90% 的把握将其关闭。

警告的原因是没有结束行的文件在编译时会给出未定义的行为：

见标准： [http ://c0x.coding-guidelines.com/5.1.1.2.html](http://c0x.coding-guidelines.com/5.1.1.2.html)

这是一篇包含一些python代码（我没有尝试过）的博客文章，它说它将修复这个问题的源文件。

[http://www.johndcook.com/blog/tag/gcc/](http://www.johndcook.com/blog/tag/gcc/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T04:01:50.747

在源代码管理中添加一个钩子，在添加换行符之前不允许成功的代码签入？

# apache-flex - Actionscript 对象（类？）语法

> ID：282856
> 
> 赞同：2
> 
> 时间：2008-11-12T02:50:10.563
> 
> 标签：apache-flex, flash, actionscript

在尝试学习如何在 ActionScript 中创建对象时，我没有成功。我注意到的一件事是，似乎有十亿种不同的方式来做这件事。即使他们都没有为我工作。这真的让我很困惑，我不知道尝试调试哪种方法。

似乎最常出现的方法是：

```
函数 myClass() {
   这个.val = 1;
}

var test = new myClass();
跟踪（test.val）；

```

但这只会给我编译器错误，无论我做得多么简单，而且对我来说，一个函数可以是一个对象是没有意义的。如果函数是一个对象，那么当它在函数中的函数中时“this”指向哪里（被解释为对象）。

另一种似乎不太常见的方式是：

```
类我的类{
   函数 myClass() {
       这个.val = 1;
   }
}

变种测试 = ....
```

这也给了我编译器错误，而且看起来更正式。但我可以找到很少的文档比较。大多数指南要么非常简单，要么假设您正在谈论内置对象。

出现的第三种方法是创建一个

```
新对象（）；
```

在一个函数中，添加你想要的所有东西并返回它。似乎合乎逻辑。但是我读过各种提到原型的东西，而且似乎以这种方式创建的对象不适合作为原型。但实际上我只是很困惑。

我还遇到了一些说法，说 AS2 和 AS3 之间的对象语法不同，但仅此而已。

我应该如何创建对象？什么是最佳实践，看在上帝的份上，有人知道我在哪里可以找到深入的教程吗？（我的 google-fu 显然很弱）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T04:04:03.973

AS2 和 AS3 之间的类语法确实不同。对于 AS3，语法如下所示：

```
package somePackage {

    public class SomeClass {
        public function SomeClass() {

        }
    }
} 
```

作为解释，包是可以包含多个类的包装器，因此您必须声明包含每个类定义的包。

一个类需要一个构造函数。在大多数语言中，构造函数的名称与类的名称相同。在 ActionScript 中就是这种情况。

调用你的类的实例看起来像这样：

```
package somePackage {

    public class OtherClass {
        public function OtherClass() {
            var something = new SomeClass();
        }
    }
} 
```

我面前有我的 AS3 参考，所以我对上面的代码片段很有信心，但不幸的是，我的 AS2 参考正在工作，但代码应该如下所示：

```
class ThirdClass {
    public function ThirdClass() {

    }
} 
```

然后实例化一个变量应该是这样的：

```
var third = new ThirdClass(); 
```

请注意，提供的示例未使用强类型，我建议您在 ActionScript 工作中尽可能使用强类型。

虽然我强烈建议您选择[Essential ActionScript 2.0](https://rads.stackoverflow.com/amzn/click/com/0596006527)和/或[Essential ActionScript 3.0](https://rads.stackoverflow.com/amzn/click/com/0596526946)的副本，但我发现以下链接可用于入门教程：

[开始 Flash 和 ActionScript 教程](http://www.educationonlineforcomputers.com/blogs/post/Free_Training_Photoshop_Flash_Dreamweaver_FrontPage_Adobe_Macromedia_Apps/707/Beginning-Flash-and-ActionScript-Tutorials)

[更多初学者教程](http://www.actionscript.org/resources/categories/Tutorials/Flash/Beginner/)

# svn - Drupal 源代码控制策略？

> ID：282858
> 
> 赞同：33
> 
> 时间：2008-11-12T02:52:14.257
> 
> 标签：svn, version-control, drupal

在标准 php 或基于源代码的项目中，我们可以轻松地将所有代码保存在 SVN 中，每个开发人员都可以签出他们自己的副本并就相同的代码进行协作。

然而，在开发 Drupal 站点时，大部分工作都在“设置”中。除了主题和模块之外，您实际上没有任何“源代码”。您如何运行同一站点的多个实例，以便开发人员可以同时工作并共享他们的工作？

示例场景：

我们启动了一个 Drupal 站点的初始版本，其中创建了内容类型“X”。我们最初还在网站上启动了一个视图，该视图按时间顺序列出了所有类型为“X”的节点。客户开始使用网站，添加内容、菜单项等。

下一个版本计划为该视图添加用户搜索功能。但是，该设置包含在数据库中。我们可以将生产数据库复制到我们的开发版本，以在我们更改视图时获取最新数据。然而，在那段时间里，客户端仍然可以更新站点，使我们的开发数据库不同步。当我们准备将新视图推送到生产环境时，除了手动重复在生产安装中设置它的步骤之外，还有更简单的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T20:43:50.197

我认为这里的一个好策略是使用安装配置文件 API。使用安装配置文件 API，您可以完成使用 Drupal 管理工具所做的大多数事情。大多数核心表单只是在变量表中设置变量。为了能够明智地对非内容数据库内容（即配置）进行版本控制，明智的做法是使用更新功能。

在我的网站上，我们有一个模块“ec”，除了它的 ec.install 文件包含更新功能，例如 ec_update_6001()

您的主要安装功能可以负责在您进行的任何新安装上实际运行更新，以使您的模块保持最新。

```
function ec_install() {
  $ret = array();
  $num = 0;
  while (1) {
   $version = 6000 + $num;
   $funcname = 'ec_update_' . $version;
   if (function_exists($funcname)) {
     $ret[] = $funcname();
     $num++;
   } else {
     break;
   }
  }
return $ret;
} 
```

现在跟随我们实际文件中的一个或两个示例更新函数

```
// Create editor role and set permissions for comment module
function ec_update_6000() {
  install_include(array('user'));
  $editor_rid = install_add_role('editor');
  install_add_permissions(DRUPAL_ANONYMOUS_RID, array('access comments'));
  install_add_permissions(DRUPAL_AUTHENTICATED_RID, array('access comments', 'post comments', 'post comments without approval'));
  install_add_permissions($editor_rid, array('administer comments', 'administer nodes'));
  return array();
}
// Enable the pirc theme.
function ec_update_6001() {
  install_include(array('system'));
  // TODO: line below is not working due to a bug in Install Profile API. See http://drupal.org/node/316789.
  install_enable_theme('pirc');
  return array();
}

// Add the content types for article and mtblog
function ec_update_6002() {
  install_include(array('node'));
  $props = array(
    'description' => 'Historical Movable Type blog entries',
  );
  install_create_content_type('mtblog', 'MT Blog entry', $props);
  $props = array(
    'description' => 'Article',
  );
install_create_content_type('article', 'Article', $props);
return array();
} 
```

实际上，这主要解决了数据库和 Drupal 代码的版本控制问题。我们广泛使用它。它允许我们推广更改数据库配置的新代码，而无需重新导入数据库或进行实时更改。这也意味着我们可以正确地测试版本，而不必担心隐藏的数据库更改。

最后 cck 和 views 支持这种方法。请参阅此代码段

```
// Enable CCK modules, add CCK types for Articles in prep for first stage of migration,
// enable body for article, enable migration modules.
function ec_update_6023() {
  $ret = array();
  drupal_install_modules(array('content', 'content_copy', 'text', 'number', 'optionwidgets'));
  install_include(array('content', 'content_copy'));
  install_content_copy_import_from_file(drupal_get_path('module', 'ec') . '/' . 'article.type', 'article');
  $sql = "UPDATE {node_type} SET body_label='Body', has_body=1
  WHERE type = 'article'";
  $ret[] = update_sql($sql);
  return $ret;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-12T03:33:37.980

不久前，我写了一篇关于[使用 CVS 和 Subversion](http://nicksergeant.com/2007/painless-drupal-revision-control-with-cvs-and-subversion-on-a-shared-host/)最佳实践的无痛 Drupal 修订控制的文章。

不幸的是，正如您所指出的，仍然存在源代码控制数据库的问题。有一些建议的方法，我在[另一篇文章](http://nicksergeant.com/2008/my-thoughts-on-small-scale-drupal-development-to-production-environments-with-cvs-and-subversion/)中提到。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-07-10T00:30:51.427

将 Drupal 设置从数据库转换到代码中一直在突飞猛进。在这个领域真正有帮助的两个模块是：

[功能](http://drupal.org/project/features)- 允许您将内容类型、分类法、视图甚至提要等实体聚集在一起。我们非常成功地使用了它，并且可以在开发人员之间共享这些更改。

[Strongarm](http://drupal.org/project/strongarm) - 允许使用上述模块存储和导出变量。我已经用这个模块做了一些测试，但我们没有使用它，很简单，因为我们真的不需要这个功能。

这些解决了将站点设置保存在数据库中的最大问题。然而，它们并不完美。. . 我们发现不支持或不正确支持的模块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T21:12:33.000

[如果您使用svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html "外部定义")属性，您可以免去一些配置和使用 SVN 的痛苦，如 Nick 的文章中所述。这将使您的本地版本的 Drupal 自动与指定的 Drupal 分支保持同步，并且您可以对模块使用完全相同的机制。此外，因为 SVN 会从文件中读取外部定义，所以您也可以将它们置于版本控制之下！

我不认为 CVS 具有等效的功能。然而，很容易编写一个简单的脚本来自动安装 Drupal 模块，只需要一个 URL（我这样做是为了让我自己的 Drupal 站点保持最新）。

就数据库版本控制而言，这是一个更棘手的问题。我建议将“库存” Drupal 数据库导出到 SQL 文件并将其置于版本控制之下。每个开发人员都可以使用自己的本地私有数据库服务器。然后，您可以提供一个脚本，将指定的数据库恢复为 SQL 文件中包含的库存版本。

作为如何以其他方式解决此问题的示例，我将描述工作中的情况。我在一个网络应用程序上工作；它不使用数据库，因此不会遇到这些问题。我们解决站点重复设置的方法是从源代码控制中重建，并提供一个程序来实现站点的自动部署。我们的客户也使用该程序作为他们创建网站的方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T15:42:58.223

CCK 和 Views 等一些模块允许将其设置数据作为文本导出和导入。您可以将这些文本表示形式保存在源代码控制系统下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-07T16:11:25.820

不幸的是，这里没有一个好的/简单的解决方案。这个问题不仅是 Drupal 架构的一个不幸的副作用，而且是所有框架类型的 CMS，其中应用程序通过配置（即存储在数据库中的数据）与通过源代码定义一样多。管理配置数据的两个选项都不是很好。首先是您正在做的事情：将单个数据库定义为规范（即生产数据库）并让开发人员在本地使用生产数据库的快照并通过生产站点的手动配置将新配置信息“合并”到生产数据库中管理界面。在定义良好的子系统（即视图）的情况下，您可能能够利用为简化这种配置迁移而开发的导入/导出功能。第二种选择——即 我认为您正在寻找的自动化 - 很困难但可能值得 - 或需要 - 对于具有复杂项目自动化预算的大型项目：深入研究系统/模块数据库结构并开发自定义脚本以合并新的配置数据例如，作为最新数据库的夜间“构建”的一部分，表/记录级别进入生产数据库。恐怕没有任何中间解决方案。

在配置数据历史跟踪的版本控制方面，像 backup_migrate 这样的模块允许您执行数据库的自动 SQL 转储。您可以通过定义备份“配置文件”来选择转储哪些表，并且可以创建一个将大内容、日志记录和缓存表（例如节点、缓存内容、看门狗）留在转储之外的表，这样您就剩下一个更易于管理的版本控制块. 服务器或其他地方的一些简单脚本可以获取最新的转储并将其添加到您的存储库中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-07T18:58:58.153

Drupal 现在支持*可导出配置*，允许您将大部分站点配置移动到代码中。借助[features](http://drupal.org/project/features)模块，可导出配置变量、视图、内容类型、字段、输入格式等。

*您还可以通过中央控制器*配置文件或模块管理初始的、不可导出的配置和配置更改。使用它来启用模块、创建用户等。

请参阅[Drupal 中的开发 -> 暂存 -> 生产工作流程问题](http://developmentseed.org/blog/2009/jul/09/development-staging-production-workflow-problem-drupal)和[代码驱动的开发：在 Drupal 6 和 7](http://www.archive.org/details/CodeDrivenDevelopmentUsingFeaturesEffectivelyInDrupal6And7)演示文稿中有效使用功能。

# java - 数组作为 switch 语句的选项

> ID：282859
> 
> 赞同：2
> 
> 时间：2008-11-12T02:52:43.350
> 
> 标签：java, enums, switch-statement

我记得在大学时使用带有“二进制搜索”或“二进制开关”的开关。类似的东西，我的 google foo 今天坏了。无论如何，它是这样的：你定义了一个可能的选项数组（通常是字符串），一些神奇的事情发生了，数组中的那些选项变成了 switch 发生的情况。我记得他们必须按字母顺序才能工作。你能帮我记住魔法吗？即使是我应该看的名字也会很棒。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-12T02:58:44.727

我认为您正在寻找的是[Enum](http://java.sun.com/docs/books/tutorial/java/javaOO/enum.html)。

从上面的链接...

```
public enum Day {
    SUNDAY, MONDAY, TUESDAY, WEDNESDAY, 
    THURSDAY, FRIDAY, SATURDAY 
}

public class EnumTest {

    Day day;

    public EnumTest(Day day) {
        this.day = day;
    }

    public void tellItLikeItIs() {
         switch (day) {
            case MONDAY:
                 System.out.println("Mondays are bad.");
                 break;

            case FRIDAY:
                 System.out.println("Fridays are better.");
                 break;

            case SATURDAY:
            case SUNDAY:
                 System.out.println("Weekends are best.");
                 break;

            default:
                 System.out.println("Midweek days are so-so.");
                 break;
        }
    }

    ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T03:58:18.460

你说的是gperf吗？或者您可能指的是一般的理论（散列）？

[http://www.gnu.org/software/gperf/](http://www.gnu.org/software/gperf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T03:11:26.077

通常，我不会以这种方式滥用开关（即使我可以）。尝试一下，您将无法让数组在 switch 语句中工作，因为它只允许在 case 行中使用常量值。你确定你没有想到像下面这样的模式或枚举吗？

```
final int RED = 0;
final int YELLOW = 1;
final int BLUE = 2;
final int GREEN = 3;

String[] colors = new String[] { "red", "yellow", "blue", "green" };

switch (color) {
    case RED:
        System.out.println(colors[RED]);
        break;
    case YELLOW:
        System.out.println(colors[YELLOW]);
        break;
    ...the rest
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T19:53:53.913

使用不带开关的 Enum 如下所示：

```
public enum Day {
    SUNDAY {
      public String tellItLikeItIs() {
        return "Weekends are best.";
      }
    },
    MONDAY {
      public String tellItLikeItIs() {
        return "Mondays are bad.";
      }
    }, 
    TUESDAY, 
    WEDNESDAY, 
    THURSDAY, 
    FRIDAY {
      public String tellItLikeItIs() {
        return "TGI Friday.";
      }
    }, 
    SATURDAY {
      public String tellItLikeItIs() {
        return "Weekends are best.";
      }
    }

    public String tellItLikeItIs() {
       return "Midweek days are so-so.";
    }
}

public class TodayIs{
    public static void main(String... args) {
         Day day = Day.valueOf(args[0].toUppercase());
         System.out.println(day.tellItLikeItIs());
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T20:22:52.470

```
public enum Day {
    SUNDAY ("sundays are this"),
    MONDAY ("mondays are that"), 
    TUESDAY ("blah"), 
    WEDNESDAY ("blah"), 
    THURSDAY ("blah"), 
    FRIDAY ("blah"), 
    SATURDAY ("more blah");

    private final String tell;

    public Day(String tell){
       this.tell = tell;
    }
    public String tellItLikeItIs() {
       return this.tell;
    }
}

public class TodayIs{
    public static void main(String... args) {
         Day day = Day.valueOf(args[0].toUppercase());
         System.out.println(day.tellItLikeItIs()); 
```

我是 Java 枚举的新手，但我认为这也应该有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-14T12:51:02.947

***如果您选择使用 enum 并且您的 enum 集合很大，请使用：***

**魔法：**

如果您在*eclipse*中工作，它会为您做一个“魔术”，您只需编写以下内容（考虑到接受的答案代码）：

```
switch (day) {
} 
```

选择`switch`并按*Ctrl + 1*，神奇的作品！（所有`enum`值都将填充在块的`case`部分中`switch`）

# c# - 返回要在c#中编辑的引用的函数

> ID：282862
> 
> 赞同：0
> 
> 时间：2008-11-12T02:54:05.627
> 
> 标签：c#

有没有办法让函数返回对某些内部数据的可编辑引用。这是一个例子，我希望能帮助说明我的意思。

```
class foo
{
    public int value;
}

class bar
{
    bar()
    {
       m_foo = new foo();
       m_foo.value = 42;
    }
    private m_foo;
    foo getFoo(){return m_foo;}
}

class main
{
    int main()
    {
        bar b = new bar();
        b.getFoo().value = 37;
    }
} 
```

根据“==”返回的 getFoo() 与内部 m_foo 相同，直到我尝试对其进行编辑。在 c/c++ 中，我会返回一个引用或指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T03:01:48.793

实际上，经过一些清理后，您的代码示例确实表明，当您将 37 分配给 value 时，您也在更改 bar 的 interman m_foo。所以答案是，你的函数返回一个引用类型。现在，也许你的真实代码是不同的，它返回的不是引用类型，而是一个 int、一个值类型或字符串，一种特殊的野兽......

```
using System;

namespace ConsoleApplication1
{
    public class foo
    {
        public int value;
    };

    public class bar
    {
        public bar()
        {
            m_foo = new foo();
            m_foo.value = 42;
        }

        private foo m_foo;
        public foo getFoo() { return m_foo; }
    };

    public class Program
    {
        public static int Main()
        {
            bar b = new bar();
            b.getFoo().value = 37;
            return 0;
        }
    };
} 
```

有关参考与值类型的更多信息： [http ://www.albahari.com/valuevsreftypes.aspx](http://www.albahari.com/valuevsreftypes.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T03:01:38.450

您已经返回了`foo`in的引用`getFoo`（默认情况下会发生这种情况）。因此，您对 的返回值所做的任何更改`getFoo`都将反映`foo`在`bar`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T03:02:38.403

您想为此使用属性

```
class bar
{
    private m_foo;
    bar()
    {
       m_foo = new foo();
       m_foo.value = 42;
    }

    foo Foo
    {
    get { return m_foo;}
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T03:02:55.907

炸了。我将弄清楚如何将我的非工作代码简化为一个实际中断的示例。原谅我的愚蠢。

# sql-server - 如何在 Visual Studio 中启用存储过程的调试？

> ID：282876
> 
> 赞同：8
> 
> 时间：2008-11-12T03:01:16.500
> 
> 标签：sql-server, visual-studio, debugging

好吧，这让我发疯了。

我已经做了所有我能做的事情来启用对 sql server 2005 数据库的存储过程的调试。

[http://arjunachith.blogspot.com/2007/05/debugging-stored-procedures-debug.html](http://arjunachith.blogspot.com/2007/05/debugging-stored-procedures-debug.html)

[http://msdn.microsoft.com/en-us/library/zefbf0t6(vs.71).aspx](http://msdn.microsoft.com/en-us/library/zefbf0t6(vs.71).aspx)

我的电流设置：

1.  视觉工作室 2008 SP1
2.  SQL server 2005 express 数据库（是的，您可以在此调试）
3.  我的本地机器上的 DEV 数据库，以 sysadmin 身份使用“root”登录

我要做的就是在 VS 2008 的服务器资源管理器中右键单击存储过程，然后查看“步入存储过程”。我已尽我所能，但我看不到这一点。我只是想访问本地机器上的本地数据库，我已经创建了一个帐户

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T03:31:54.647

你运行的是哪个版本的VS2008？我刚刚检查了 Pro 和 Team System，两者都有这个选项；我也有 C# Express，但它没有提供这个选项。（我没有标准，所以不能检查那个......）

[编辑] 从您提供的第二个链接 (MSDN)，右侧有一个 VS2008 的链接，表明它仅适用于 Pro 和 Team。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-05T08:42:05.620

只需在服务器资源管理器中选择您的连接并右键单击它，然后选择 `Allow SQL/CLR Debugging`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T05:47:57.650

要在托管代码或 Visual Studio 中进行 sql 调试，应将 Visual Studio 配置为启用 sql server 调试。此链接可帮助您直接解决[http://support.microsoft.com/kb/316549](http://support.microsoft.com/kb/316549)和[http://msdn.microsoft.com/en-us/library/aa984533(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa984533(v=vs.71).aspx)但版本应该考虑视觉工作室的。请参考这个[http://msdn.microsoft.com/en-us/library/ms165038(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms165038(v=vs.80).aspx)。

显然，尽管版本是 pro/team 并且如果它是一个 Web 应用程序项目，但您可能不会获得 Debug 选项卡。要使其工作，您需要选择 web 选项卡->向下滚动屏幕->获取 3 个选项，如下图所示。

![查看图像寻求帮助](https://i.stack.imgur.com/YbUE8.png)

# flexbuilder - Flex 的链接报告文件与多个模块相互覆盖

> ID：282877
> 
> 赞同：4
> 
> 时间：2008-11-12T03:01:23.413
> 
> 标签：flexbuilder

我正在使用 Flex Builder 3 中的链接报告选项来尝试跟踪我的 Flex 应用程序模块中的依赖关系。

但是，每个模块都会生成不同的报告，并且它们都使用相同的文件名，因此它们最终会相互覆盖！

有没有办法为每个模块生成单独的文件 - 无需创建文件观察器来在生成时复制它们！

我正在使用以下命令行参数：

`-locale en_US -link-report=linkreport.xml -optimize`

理想情况下，我想要类似的东西，`-locale en_US -link-report=linkreport_%MODULE%.xml -optimize`但我不知道这是否可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-06T00:45:27.373

我同意，这很烦人，应该得到编译器的支持。

一种不太优雅的方法（假设您的模块和主 swf 都在同一个项目中）是创建一个项目，并将源文件夹指向现有项目的源文件夹，但使用不同的输出文件夹.

现在只编译模块，你应该能够得到模块的链接报告。

糟糕的方法，但在尝试追踪泄漏的引用时对完成任务很有用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-01T09:35:12.983

我认为您正在使用依赖模块。如果您使用独立模块，那么它们将有自己的类并且不与主应用程序共享，这可能会为您提供所需的结果。

# java - 基于插件的程序中的语言环境和资源包

> ID：282883
> 
> 赞同：4
> 
> 时间：2008-11-12T03:03:49.040
> 
> 标签：java, internationalization, locale, resourcebundle

我们需要开始为我们的程序添加国际化。谢天谢地，还不是全部，只是一点点，但我希望我们这样做的方式可以扩大到可能覆盖整个程序。问题是，我们的程序是基于插件的，所以并不是所有的字符串都属于同一个地方。

据我了解，Java 的`ResourceBundle`工作是这样的。您创建了一个扩展类`ResourceBundle`，称为类似的类`MyProgramStrings`，以及特定于语言的类，称为`MyProgramStrings_fr`等`MyProgramStrings_es`。这些类中的每一个都将键（字符串）映射到值（任何对象）。从哪里获取数据取决于这些类中的每一个，但它们的常见位置是属性文件。

您在两个阶段查找值：首先您获得正确的捆绑包，然后查询它以获取您想要的字符串。

```
Locale locale = Locale.getDefault(); // or = new Locale("en", "GB");
ResourceBundle rb = ResourceBundle.getBundle("MyProgramStrings", locale);
String wotsitName = rb.getString("wotsit.name"); 
```

但是，我们需要将多个语言环境的结果组合到一个资源空间中。例如，插件需要能够覆盖已定义的字符串，并在代码查找该字符串时返回该新值。

我有点迷失在这一切中。有人可以帮忙吗？

* * *

**更新：**大卫沃特斯问：

> 我已经把我的答案放在了底部，但我很想听听你是如何解决这个问题的。

好吧，我们还没有走多远——长期的 WIBNI 总是成为最新危机的受害者——但我们基于插件实现的接口，约定资源与接口具有相同的完全限定名称.

所以一个接口`UsersAPI`可能有各种不同的实现。默认情况下，该接口上的方法`getBundle()`返回等效于 `ResourceBundle.get("...UsersAPI", locale)`. 可以替换该文件，或者如果用户需要更复杂的内容，UsersAPI 的实现可以覆盖该方法。

到目前为止，这可以满足我们的需要，但我们仍在寻找基于插件的更灵活的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T03:21:33.263

您不必*将*ResourceBundles 实现为一系列类，每个语言环境有一个类（即名为`MyProgramStrings`, `MyProgramStrings_fr`,的类`MyProgramStrings_de`）。如果需要，ResourceBundle 类将回退到使用属性文件：

```
public static void main(String[] args) {

    ResourceBundle bundle = ResourceBundle.getBundle("MyResources");
    System.out.println("got bundle: " + bundle);

    String valueInBundle = bundle.getString("someKey");
    System.out.println("Value in bundle is: " + valueInBundle);
} 
```

如果我有一个`MyResources.properties`在类路径上命名的文件，那么此方法将导致：

```
got bundle: java.util.PropertyResourceBundle@42e816  
Value in bundle is: someValue 
```

[至于设置捆绑包的层次结构，或者将](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/context/MessageSource.html)它们“合并”在一起，恐怕我[无能为力](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#context-functionality-messagesource)，除了我知道 Spring 确实有一个在java.util.ResourceBundle 的顶部，所以也许你可以使用 Spring 的功能来实现你想要的？

`ResourceBundle.getBundle()`顺便说一句，这里是解释它的“搜索和实例化策略”的 javadoc 的相关部分：

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/ResourceBundle.html#getBundle(java.lang.String](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ResourceBundle.html#getBundle(java.lang.String) , java.util.Locale, java.lang.ClassLoader)

> *   首先，它尝试使用候选包名称加载一个类。如果可以使用指定的类加载器找到并加载这样的类，与 ResourceBundle 的分配兼容，可以从 ResourceBundle 访问，并且可以实例化，则 getBundle 创建此类的新实例并将其用作结果资源包。
> *   否则，getBundle 会尝试定位属性资源文件。它通过替换所有“。”从候选包名称生成路径名称。带有“/”的字符并附加字符串“.properties”。它尝试使用 ClassLoader.getResource 查找具有此名称的“资源”。（请注意，getResource 意义上的“资源”与资源包的内容无关，它只是数据的容器，例如文件。）如果找到“资源”，它会尝试创建从其内容中创建一个新的 PropertyResourceBundle 实例。如果成功，此实例将成为结果资源包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T03:30:15.787

我知道 Struts 和 Spring 有这方面的东西。但是假设您不能使用 Struts 或 Spring，那么我要做的是创建 ResourceBundle 的子类并在此 ResourceBundle 中加载 *.properties（每个插件一个）。然后你可以使用

> ResourceBundle bundle = ResourceBundle.getBundle("MyResources");

就像您通常对属性文件所做的那样。

当然，您应该缓存结果，这样您就不必每次都搜索每个属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T03:38:47.783

getBundle 加载使用指定语言环境（如果有）和默认语言环境生成的一组候选捆绑文件。

通常，没有语言环境信息的资源文件具有“默认”值（例如，`en_US`值可能在 MyResources.properties 中），然后为不同的语言环境创建覆盖资源值（例如`ja`，字符串在 MyResources_ja.properties 中）更具体的文件会覆盖不太具体的文件属性。

现在您想为每个插件添加提供它自己的一组属性文件的能力。目前尚不清楚该插件是否能够修改主应用程序或其他插件的资源，但听起来您希望拥有一个单例类，其中每个插件都可以注册其基本资源文件名. 所有对属性值的请求都通过那个单例，然后它会查看每个插件的资源包（以某种顺序...），最后是应用程序本身的属性值。

Netbeans NbBundle 类做类似的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T09:33:51.853

我有一个稍微类似的问题，请参阅[问题 653682](https://stackoverflow.com/questions/653682/how-to-override-some-resources-from-a-propertyresourcebundle)。我找到的解决方案是有一个扩展 ResourceBundle 的类，如果不委托给从文件生成的 PropertyResourceBundle，则检查我们是否覆盖了该值。

因此，如果您想为 UI 存储标签，您将拥有一个类 com.example.UILabels 和一个属性文件 com.example.UILabelsFiles。

```
package com.example;

public class UILabels extends ResourceBundle{
    // plugins call this method to register there own resource bundles to override
    public static void addPluginResourceBundle(String bundleName){
        extensionBundles.add(bundleName);
    }

    // Find the base Resources via standard Resource loading
    private ResourceBundle getFileResources(){
        return ResourceBundle.getBundle("com.example.UILabelsFile", this.getLocale());
    }
    private ResourceBundle getExtensionResources(String bundleName){
        return ResourceBundle.getBundle(bundleName, this.getLocale());
    }

    ...
    protected Object handleGetObject(String key){
        // If there is an extension value use that
        Object extensionValue = getValueFromExtensionBundles(key);
        if(extensionValues != null)
            return extensionValues;
        // otherwise use the one defined in the property files
        return getFileResources().getObject(key);
    }

    //Returns the first extension value found for this key, 
    //will return null if not found    
    //will return the first added if there are multiple.
    private Object getValueFromExtensionBundles(String key){
        for(String bundleName : extensionBundles){
            ResourceBundle rb = getExtensionResources(bundleName);
            Object o = rb.getObject(key);
            if(o != null) return o;
        }
        return null;
    }    

} 
```

# .net - 取消异步远程调用

> ID：282886
> 
> 赞同：2
> 
> 时间：2008-11-12T03:05:53.277
> 
> 标签：.net, architecture, remoting, client-server

我有一个客户端-服务器架构，其中客户端使用 .NET Remoting 与服务器通信。服务器处理所有业务逻辑和数据库交互。我需要添加一个可能需要一段时间才能执行的操作，并且它返回的数据集可能非常大。我正在考虑为此使用异步调用。现在问题出现了：假设客户端进行了这个异步调用，操作启动了 SQL 查询，用户要么关闭客户端，要么单击取消——操作会发生什么？有什么方法可以取消挂起的异步调用，它正忙于与 SQL 服务器交谈？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T03:10:46.060

您可以设计您的客户端/服务器交互，以便服务器让工作线程执行 SQL 工作，以便它准备好接收来自客户端的另一个调用。因此，客户拨打电话 1 并说做 SQL 工作。服务器将该工作交给工作线程，并为新的传入做好准备。然后客户拨打电话 2 并说“没关系”。服务器会做一些记账，以确保在工作线程完成时它不会回调客户端。

服务器能否安全地中断工作线程。我不确定。这会对 SQL Server 正在做什么有任何影响。没有把握。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T15:00:56.567

当客户端关闭应用程序时，您现在如何处理正在进行的呼叫？你可以用异步调用做同样的事情。

是的，异步是处理长时间运行请求的方式。如果结果集足够大，您甚至可以考虑从服务器发送多个响应的块。

当用户单击取消时，您将向服务器发送一条新消息，说明您不再对结果感兴趣。如果 SQL 请求在线程池上运行，则无法真正取消它。

# c - 在机器码中查找位置 (gcc/objdump -d)

> ID：282899
> 
> 赞同：5
> 
> 时间：2008-11-12T03:12:28.397
> 
> 标签：c, gcc, objdump, object-code

如果您要在机器输出中检查特定的 C 代码行，您将如何在 objdump 输出中找到它。这是一个例子

```
if (cond)
   foo;
   bar(); 
```

我想看看 bar 是否按我的意愿内联。或者你会使用一些替代工具而不是 objdump 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T03:30:51.683

`-S`您可以使用选项（如）启动 objdump `"objdump -Sd a.out"`。如果编译代码的源文件可用，它将显示与汇编代码混合的源代码。

或者，您可以使用以下方式：

```
int main(void) {
    int a = 0;
    asm("#");
    return a;
} 
```

变成

```
 .file   "a.c"
        .text
.globl main
        .type   main, @function
main:
        leal    4(%esp), %ecx
        andl    $-16, %esp
        pushl   -4(%ecx)
        pushl   %ebp
        movl    %esp, %ebp
        pushl   %ecx
        subl    $16, %esp
        movl    $0, -8(%ebp)
#APP
# 3 "a.c" 1
        #
# 0 "" 2
#NO_APP
        movl    -8(%ebp), %eax
        addl    $16, %esp
        popl    %ecx
        popl    %ebp
        leal    -4(%ecx), %esp
        ret
        .size   main, .-main
        .ident  "GCC: (GNU) 4.3.2"
        .section        .note.GNU-stack,"",@progbits 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T07:02:52.567

You debugger should also let you see source code and matching assembly if you compiled with debug symbols. This is gcc option -g and gdb disass command.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T03:56:30.290

如果使用 gcc 编译，可以使用 -S 直接生成汇编文件。该文件通常包含一些有用的信息，包括函数名称，有时还包含代码行号（取决于您使用的编译选项）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-29T21:07:22.777

Function calls are detected in the assembly by the common function prolog.

With i386 it is

```
 55      push %ebp
  89 e5   mov %esp, %ebp
  ...
  c9      leave # optional
  c3      ret 
```

with amd64/x86_64 is is similar (just the quad prefix `48`):

```
 55                    push   %rbp
  48 89 e5              mov    %rsp,%rbp
  ..
  c9                    leaveq # optional
  c3                    retq 
```

So when you detect that inside your `objdump -S bla.o` or `gcc bla.c -g -fsave-temps -fverbose-asm` output of your main function and for bar also, bar is not inlined. Also when main has a call or jump to bar it is not inlined.

In your case you could see if bar has local vars, which needs room on the local stack. If bar is inlined the stack adjust (e.g. `sub $0x8,%esp`) is done right after the main prolog, main could access that var. If not it is private to bar.

# producer-consumer - 生产者完成后通知消费者

> ID：282901
> 
> 赞同：1
> 
> 时间：2008-11-12T03:12:35.357
> 
> 标签：producer-consumer, concurrency

我正在从 ldap 读取大量数据，这些数据需要与数据库中的相应记录进行比较。为了尽量减少 SQL 查询的数量，我想将多个 ldap 记录批处理到一个查询中。

所有这一切都非常简单：一个产生 ldap 结果的线程，以及一个使用这些结果并运行 SQL 查询的线程。

```
ldap_results = Queue.Queue(10)
定义生产者（）：
  对于 ldap_results() 中的结果：
    ldap_results.put（结果）

定义消费者（）：
  缓冲区 = []
  缓冲区大小 = 5
  而真：
    记录 = ldap_results.get()
    buffer.append(记录)
    如果 len(buffer) >= buffer_size:
      do_sql（缓冲区）
      缓冲区 = []

```

问题是：如果 ldap 只返回 3 个结果并且`buffer_size`是 5 个结果，它将永远阻塞。我意识到我可以将一些特殊的标记放入缓冲区中，例如`None`, 或`"EOF"`，但这似乎是一个糟糕的设计：“迭代直到你完成，哦，除非你看到这个特殊值，这意味着你也完成了”。

我想出了两个替代的想法。首先是有一个共享`eof`变量，但我不知道如何正确同步它。

```
定义生产者（）：
  而数据：
    缓冲区.put()
  eof = 真

定义消费者（）：
  虽然不是 eof：
    缓冲区.get()

```

第二个是`ProduceChunks(chunk_size)`为生产者提供一个方法，它会处理结果的批处理，但我不喜欢这样，因为它假设生产者知道如何最好地缓冲结果，而实际上，我认为是消费者的责任。

有没有人有任何指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T03:19:43.547

我会遵循“让它运行，让它正确，让它快速，让它变得简单”的模式。

如果没有特殊的“EOF”令牌，你能正确实现吗？如果没有，那么你只需要使用 EOF 令牌，不要担心。是的，终止条件更复杂，但现在是“对”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T03:16:47.610

“EOF”方法非常受人尊敬。让我们看一下 ANSI 字符串的缩影。空值是 EOF。那有什么不好呢？

或者，让我们看看 BSTR 的缩影。第一个字节不是尾随空值，而是告诉您字节是如何到来的。

无论哪种方式都很好。

没关系。

# php - 使用 Twitter API 的 PHP 应用程序适用于某些帐户，而不适用于其他帐户

> ID：282904
> 
> 赞同：1
> 
> 时间：2008-11-12T03:13:06.820
> 
> 标签：php, curl, twitter

我有一个我编写的 PHP 脚本，用于自动关注发布带有特定条款的消息的用户。它在一堆测试帐户上 100% 的时间有效，但在我想使用它的帐户上无效。

我已经检查了帐户的 API 速率限制，并且在界限内。我还验证了用户名和密码是否正确。如果我只将用户名和密码更改为另一个帐户，它将起作用，但是当（正确）更改回主帐户时，没有任何反应。我完全感到困惑。有没有人遇到过这个？

我包括下面使用的两个文件。如果还有其他有用的信息，请告诉我，如果可以，我会提供。谢谢！

索引.php

```
<?php
$url = "http://search.twitter.com/search.atom?q=SEARCHTERM&show_user=true&rpp=100";
$search = file_get_contents($url);

$regex_name = '/\<name\>(.+?) \(/';
preg_match_all($regex_name,$search,$user);
for($i=0;$user[1][$i];$i++)
    {
    $follow = $user[1][$i];
    include("follow.php");
    }
?> 
```

关注.php

```
<?php
define('TWITTER_CREDENTIALS', 'username:password');
$url = "http://twitter.com/friendships/create/".$follow.".xml";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_USERPWD, TWITTER_CREDENTIALS);
$result= curl_exec ($ch);
curl_close ($ch);
?> 
```

对此的快速更新：原来问题出在 Twitter 上——由于某种原因，有问题的帐户比正常的 API 限制更严格。我没有将任何响应标记为答案，因为它是一个相当特殊的实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T13:52:33.950

要调试你的 cURL 请求，一切都已经说了，但也许你可以使用[Services_Twitter](http://pear.php.net/package/Services_Twitter)，它是一个包装在 Twitter-API 周围的包。它提供了非常强大的响应处理。

目前还支持搜索和友谊。

如果您不想这样做，那么对于 Twitter-Search API，我会使用 JSON 并执行以下操作：

```
<?php
$url    = "http://search.twitter.com/search.json?q=SEARCHTERM&show_user=true&rpp=100";
$search = file_get_contents($url);
if ($search === false) {
    die('Error occurred.');
}
$hits = json_decode($search);
var_dump($hits);
?> 
```

它的解析更少，并且[ext/json](http://docs.php.net/json)在*大多数*PHP5 安装中都可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T18:34:47.303

尝试使用：

```
curl_setopt($ch,     CURLOPT_VERBOSE, 1); 
```

看看它是否有助于识别问题。

# emacs - 除了 Emacs 之外，还有其他适合 Lisp 编程的编辑器吗？

> ID：282905
> 
> 赞同：17
> 
> 时间：2008-11-12T03:13:44.447
> 
> 标签：emacs, text, editor, lisp, notepad++

我正在寻找替代方案，因为我发现 emacs 很难使用。我宁愿使用支持所有常用快捷键的编辑器，例如箭头键移动光标，CTRL+SHIFT+RightArrow 选择下一个单词等。

基本上，我不想为了使用 emacs 而重新学习所有熟悉的快捷方式。

谁能推荐一个合适的编辑器？

另一件事 - Notepad++ 支持 LISP 语法着色，但它没有像 emacs 那样的集成 LISP 控制台。是否可以并排打开一个 Notepad++ 窗口和一个命令行窗口，并在我想运行我的程序时使用命令行？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-12T05:05:50.353

首先，箭头键​​在 Emacs 上应该可以正常工作。（Emacs 顽固分子会告诉您 Ctrl-f/b/p/n 更可取，但您不必听他们的。）如果默认情况下它们不起作用，则说明有问题。

最新版本的 Emacs 带有 cua-mode，这将使所有其他常用快捷键（如用于剪切复制粘贴的 Ctrl-x/c/v、用于选择的 shift-arrows 等）也能正常工作。如果默认情况下它们不起作用，请键入“Mx（大多数键盘上的 Alt-x）cua-mode”。

一般来说，如果你想让一个特定的按键调用某个函数，然后输入 Mx global-set-key [hit Return] [hit the keystroke] [type name of function]，例如 Mx global-set-key RET [hit the向下箭头] 下一行 RET。

Emacs 是由 Lisp 程序员为 Lisp 制作的，它是 Lisp 最好的编辑器，仅仅因为几十年来一直是标准的 Lisp 编辑器并且实现了每一个改进的想法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T03:37:47.677

使用[DrScheme](http://www.drscheme.org/)。它具有您可能期望的所有标准键绑定。[这](http://www.wisdomandwonder.com/article/139/working-with-drscheme-372)是我使用它的注意事项。是的，它是为 Scheme 构建的，但也许它对你有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-10T09:45:33.323

试试[LispIDE](http://www.daansystems.com/lispide/ "LispIDE")。这有点初级，但可能会对你有所改善。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-13T06:27:35.290

您想要使用的不仅仅是 emacs，它也是 SLIME。SLIME 会让你连接到 Lisp REPL（运行 Swank 后端）。您可以连接到服务器进程并开始与之交互。[看看 SLIME 主页](http://common-lisp.net/project/slime/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-12T05:22:02.207

[Zeus](http://www.zeusedit.com)程序员编辑器有一个可配置的语法高亮器，因此应该可以将其配置为 Lisp 高亮显示。

[Zeus](http://www.zeusedit.com)甚至有一个**Emacs 键盘仿真**模式并且是**完全可编写脚本**的，但不幸的是它在 Lisp 中不可编写脚本；）

**编辑：**作为回应 Luís Oliveira 评论：*他正在寻找 Lisp IDE。*

Zeus 确实有项目/工作区管理、编译器/链接器/工具支持、类浏览、代码完成、集成版本控制，就像很多 IDE 一样。

但是 Zeus 不仅仅是一个 IDE，因为它提供了 IDE 的许多功能，而不依赖于任何一种特定的语言，实际上就像 Emacs 一样。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-16T03:01:13.607

除了 emacs 之外，我试图为我的方案代码找到一个好的编辑器，但即使使用 emacs triger foubles，它仍然是最好的。jEdit 是第二好的，但有点像是说蛋糕、锯末和泥土之间的选择，锯末是第二好的。

具有 paredit 模式的 Emacs 只**拥有**s 表达式的结构化编辑。再加上高亮括号模式，它会变得更好。

使用 emacs 的一点是，编辑器扩展语言是 lisp，所以它是学习 lisp 的好方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T03:39:52.180

看看这个问题

[https://stackoverflow.com/questions/22850/getting-started-with-lisp](https://stackoverflow.com/questions/22850/getting-started-with-lisp)

它提到的一件事是在 Eclipse 中运行的[CUSP 。](http://sergeykolos.com/cusp/intro/)

另外，如果你在做 Scheme（你没有说你指的是哪个 Lisp），我支持 DrScheme 的推荐。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-12T04:09:34.803

我怀疑几乎所有编写 LISP 程序的人都会使用 emacs。如果你不得不与真正的 LISP 程序员一起工作，你可能会让自己处于不利地位。

此外，优秀的程序员不应该被任何一个编辑器束缚。学会在没有基于 Windows 的密钥加速的情况下进行处理。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-12T17:48:59.720

除了已经提到的[CUSP](http://www.bitfauna.com/projects/cusp/)之外，还有[ABLE](http://phil.nullable.eu/)，一个相对简单的 Lisp 编辑器，具有 REPL 集成和其他东西。就个人而言，我没有使用它的经验，因为我对 SLIME 很满意。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-15T23:55:42.047

毫无疑问，我在这方面有点晚了，但是普通的旧 vi(1) --- 常规的遗留 vi --- 工作得很好，有括号匹配和至少一些基本的 s-exp 东西。设置您的 EXRC 以使用

```
:set ai lisp aw 
```

它不是 SLIME，而是某种东西。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T12:32:51.437

一些商业化的 Lisp 系统（Allegro CL、LispWorks、Corman CL）都带有自己的编辑器。通常可以在特定于平台的键绑定和类似 Emacs 的键绑定之间进行选择。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-08-03T15:35:18.427

如果您有 Mac，我会推荐 Aquamacs，它是 GNU-emacs 的初学者友好版本，因此具有 emacs 的所有功能，同时仍提供“标准”复制粘贴、保存和其他功能，包括普通文件对话框和窗口。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-12T03:38:12.853

有些人说除了 emacs 之外没有**什么好的编辑器。**我相信你会在这里找到其中的一些（尽管我是 vim 的粉丝）。

vim 宏语言是一种功能强大的宏语言，它可以让您运行外部程序（包括当前编辑缓冲区中的程序）。

但是，如果您习惯使用 Notepad++，您可能会发现迁移到 vim 和迁移到 emacs 一样困难，因此您提出的解决方案可能是最好的解决方案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-16T04:41:46.900

试试 McCLIM，newlisp

[http://www.cliki.net/IDE](http://www.cliki.net/IDE)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-27T11:09:45.800

> 另一件事 - Notepad++ 支持 LISP 语法着色，但它没有像 emacs 那样的集成 LISP 控制台。是否可以并排打开一个 Notepad++ 窗口和一个命令行窗口，并在我想运行我的程序时使用命令行？

是的！不过，利用 ASD 并在进行更改后重新加载系统。

不要每次都重新启动您的图像。

不过，如果您想要 REPL 集成，请尝试使用 Eclipse/Cusp 或 Limp。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-09-23T17:31:03.193

Emacs 不再像以前那样怪异和不友好了。根据您喜欢的平台，有两个现代的、更新的 Emacs 实现具有更熟悉的用户界面。

如果你是 Mac OS X 用户，更精致的是[Aquamacs](http://aquamacs.org/)：

如果您更喜欢 Linux 或 Windows，那么有 Xah Lee 的[ErgoEmacs](http://ergoemacs.org/)：

两者都是 FOSS 并且可以免费下载。

# python - 如何在防火墙后面下载 python .egg 文件

> ID：282907
> 
> 赞同：1
> 
> 时间：2008-11-12T03:15:07.753
> 
> 标签：python, windows, linux, cygwin, turbogears

我将尝试涡轮齿轮，但我在 windows vista 上。但是由于防火墙代理问题，我似乎无法下载 .egg 文件，这是安装 turbogears 在我的 Windows 环境中安装所必需的。我确实有一个可启动的，或者我可以制作一个可启动的 Linux USB，我可以尝试 cygwin，但我不知道从哪里开始 cygwin，所以我想知道如何解决我的防火墙/代理问题，比如安装 turbogears。

如果可能的话，是否有一些非在线版本的 turbogears 我可以通过访问网站下载，然后以某种方式将该非在线版本导入到我的 python 环境中？

非常感谢！：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T06:56:14.640

也许问题不在于防火墙本身，而在于您需要使用 HTTP 代理这一事实。如果确实需要使用代理，请尝试设置 http_proxy 环境变量。可能是您的防火墙使用 NTLM 代理身份验证（Python 不支持）；在这种情况下，请尝试在本地计算机上设置[APS 代理服务器](http://ntlmaps.sourceforge.net/)，并将 http_proxy 指向 localhost。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T06:32:48.633

[您可以从 windows 本地](http://docs.turbogears.org/1.0/InstallWindows)运行 TG 。`tgsetup.py`安装方法使用[setuptools](http://pypi.python.org/pypi/setuptools/0.6c9) ，这取决于能否`.egg`从 Internet 引入文件。正如其他人建议的那样，最好的方法是向鸡蛋开放防火墙。TG 有一个[鸡蛋文件列表](http://www.turbogears.org/download/filelist.html)，您可以尝试手动引入（可能来自开放的互联网连接）。手动安装 egg 是可能的，但[不推荐](http://www.turbogears.org/download/filelist.html)。

如果无法更改防火墙规则，您可以使用具有预配置 TG 包的 Linux（可引导或虚拟）安装。例如，[Fedora 有一个](http://mirror.isoc.org.il/pub/fedora/releases/9/Everything/i386/os/Packages/TurboGears-1.0.4.4-2.fc9.noarch.rpm). 这样，TG 包（希望）作为`.rpm`文件穿过防火墙。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T07:52:24.760

You could use the old firewall hack... try throwing "?file.jpg" or "#file.jpg" on the end (sans quotes). The firewall may see this as you're trying to download an image file which it'll allow, the responding server probably won't care that you've attached a query string, and (I think) python will just see an egg.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T03:32:16.190

将 python 添加到防火墙例外列表中。当然，只要确保你没有运行任何用 python 编写的有问题的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T20:40:16.177

这可能不是您想要的，但您可以[绕过代理隧道 SSH](http://www.mtu.net/~engstrom/ssh-proxy.php)。另一种可能性是使用[Tor](http://tor.eff.org)。

# php - 使用循环创建数组

> ID：282916
> 
> 赞同：23
> 
> 时间：2008-11-12T03:19:59.413
> 
> 标签：php, arrays, loops, data-structures

我对 php 非常陌生，我想知道是否有人可以帮助我使用 for 或 while 循环来创建一个长度为 10 个元素的数组

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-12T03:20:54.357

```
$array = array();
$array2 = array();

// for example
for ($i = 0; $i < 10; ++$i) {
    $array[] = 'new element';
}

// while example
while (count($array2) < 10 ) {
    $array2[] = 'new element';
}

print "For: ".count($array)."<br />";
print "While: ".count($array2)."<br />"; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-12T03:42:00.850

`for`循环的另一种方法是......

```
$array = array();

foreach(range(0, 9) as $i) {
    $array[] = 'new element';
}

print_r($array); // to see the contents 
```

我使用这种方法，我发现它更容易浏览一下它的作用。

正如*strager*指出的那样，它可能会或可能不会更容易读给您听。他/她还指出创建了一个临时数组，因此比普通的 for 循环稍微贵一些。这个开销很小，所以我不介意这样做。你实施什么取决于你。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-12T03:48:10.900

对于初学者来说可能更容易理解......

```
<?php

// for loop
for ($i = 0; $i < 10; $i++) {

$myArray[$i] = "This is element ".$i." in the array";

echo $myArray[$i];

}

//while loop
$x = 0;

while ($x < 10) {

$someArray[$x] = "This is element ".$x." in the array";

echo $someArray[$x];

$x++;
}

?> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-17T05:18:44.740

我不确定你的目的到底是什么。PHP 的数组是动态的，这意味着您可以在创建它们之后继续向它们添加元素——也就是说，您不需要在开始时定义数组的长度。我假设你想把 10 个任意的东西放在一个数组中。

for循环：

```
$arr = array();
for ($i = 0; $i < 10; ++$i) {
    $arr[] = "Element $i";
} 
```

while循环：

```
$arr = array();
$i = 10;
while (--$i) {
    $arr[] = "Element $i";
} 
```

通过定义它：

```
$arr = array("Element 1", "Element 2", "Element 3" ...); 
```

或者，如果您只想要一系列字母或数字：

```
$arr = range(0, 9);
$arr = range('a', 'j'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-17T05:19:38.420

最简单的方法是使用[`array_fill()`](http://www.php.net/array_fill)：

```
$array = array_fill(0, 10, 'Hello World'); 
```

但是您应该知道 PHP 数组可以随时调整大小，我从来不需要创建特定大小的数组。

# optimization - 内存分配的时间复杂度

> ID：282926
> 
> 赞同：49
> 
> 时间：2008-11-12T03:27:08.460
> 
> 标签：optimization, memory-management, malloc, time-complexity

使用new、malloc等动态内存分配的时间复杂度是多少？我对如何实现内存分配器知之甚少，但我认为答案是它取决于实现。因此，请回答一些更常见的案例/实现。

编辑：我隐约记得听说堆分配在最坏的情况下是无限的，但我对平均/典型情况真的很感兴趣。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-29T18:39:31.333

在处理 O 表示法时，您必须意识到的一件事是，了解*n*是什么通常非常重要。如果*n*与您可以控制的某些事物相关（例如：您想要排序的列表中的元素数量），那么仔细查看它是有意义的。

在大多数堆实现中，您的*n*是管理器正在处理的连续内存块的数量。这绝对**不是**通常在客户控制之下的事情。客户端真正可以控制的唯一*n是她想要的内存块的大小。*通常这与分配器花费的时间无关。大的*n*可以像小的*n*一样快速分配，或者可能需要更长的时间，甚至可能无法使用。对于相同的*n* ，所有这些都可能发生变化，具体取决于以前来自其他客户端的分配和解除分配的方式。所以真的，除非你正在实现一个堆，否则**正确的答案是它是不确定的**.

这就是为什么硬实时程序员试图避免动态分配（在启动之后）。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-12T06:22:20.073

堆分配器的时间复杂度在不同系统上可能不同，具体取决于它们可能优化的目标。

在桌面系统上，堆分配器可能混合使用不同的策略，包括缓存最近的分配、常见分配大小的后备列表、具有特定大小特征的内存块箱等，以尝试减少分配时间，同时保持碎片可管理。有关所使用的各种技术的概述，请参阅 Doug Lea 的 malloc 实现的注释：http: [//g.oswego.edu/dl/html/malloc.html](http://g.oswego.edu/dl/html/malloc.html)

对于更简单的系统，可以使用第一次拟合或最佳拟合的策略，将空闲块存储在一个链表上（这将给出 O(N) 时间，N 是空闲块的数量）。但是更复杂的存储系统（例如 AVL 树）可能用于在 O(log N) 时间内定位空闲块（[http://www.oocities.org/wkaras/heapmm/heapmm.html](http://www.oocities.org/wkaras/heapmm/heapmm.html)）。

实时系统可能会使用像 TLSF（两级分离拟合）这样的堆分配器，其分配成本为 O(1)：http: [//www.gii.upv.es/tlsf/](http://www.gii.upv.es/tlsf/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-10T15:08:47.613

只说两句：

*   [TLSF](http://www.gii.upv.es/tlsf/)在没有单个循环的意义上是 O(1)；并管理高达 2Gb。虽然真的很难相信，只要检查代码。

*   并不是说“最适合”的策略（找到紧块）最适合实现小碎片。证明这一说法绝非易事，事实上它还没有被正式证明，但有很多证据表明这个方向。（很好的研究课题）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T03:31:27.470

我认为它通常是 O(n)，其中 n 是可用内存块的数量（因为您必须扫描可用内存块以找到合适的内存块）。

话虽如此，我已经看到了可以使其更快的优化，特别是根据其大小范围维护多个可用块列表（因此小于 1k 的块在一个列表中，从 1k 到 10k 的块在另一个列表中，依此类推）。

然而，这仍然是 O(n)，只是 n 更小。

我很想看看你的消息来源，有一个无界的堆分配（如果你的意思是它可能需要永远）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-29T17:56:17.130

看看典型的分配器是如何工作的。

Bump-the-pointer 分配器在*O(1)*中工作，它是一个小的“ *1* ”。

对于隔离存储分配器，k 字节的分配意味着“从 List( *n* ) 返回第一个块”，其中 List( *n* ) 是 n 字节的块列表，其中*n >= k*。它*可能会*发现 List( *n* ) 是空的，因此必须拆分下一个列表 (List( *2n )) 中的块，并将结果的**n*字节块放入 List( *n* )，这种影响*可能会*产生涟漪通过所有可用的大小，使得复杂度为*O(ns)*，其中 ns 是可用的不同大小的数量，并且*ns = log (N)*其中*N*是可用的最大块大小的大小，所以即使这样也会很小。在大多数情况下，尤其是在分配和释放多个块之后，复杂度为*O(1)*。

# qt - 在 Qt 中显示颜色选择的结果？

> ID：282938
> 
> 赞同：7
> 
> 时间：2008-11-12T03:32:03.210
> 
> 标签：qt, user-interface, colors

为用户提供颜色选择反馈的最佳方式是什么？
我有一个带有“选择颜色”按钮的对话框，它会弹出一个`QColorDialog`. 做出选择后，我想向用户显示选择的颜色。
通常我会使用 a`QLabel`并在调色板中更改它的背景颜色。这种方法很麻烦，我认为不是很便携。

有这样做的标准方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T07:43:01.130

我这样做的方式如下：

我实际上改变了按钮的颜色，以反映用户的选择。为此，我使用了 Qt 样式表，以确保它是可移植的：

```
const QString COLOR_STYLE("QPushButton { background-color : %1; color : %2; }");

QColor ChosenColor; // Color chosen by the user with QColorDialog
QColor IdealTextColor = getIdealTextColor(ChosenColor);
btnChooseColor->setStyleSheet(COLOR_STYLE.arg(ChosenColor.name()).arg(IdealTextColor.name())); 
```

为了确保按钮的标签始终可读，我调用了 getIdealTextColor() 方法，这是我从 codeproject 文章中找到的方法：

```
//==============================================================================
//  Nom : getIdealTextColor
//! @return an ideal label color, based on the given background color.
//! Based on http://www.codeproject.com/cs/media/IdealTextColor.asp
//==============================================================================
QColor JSPreferencesDlg::getIdealTextColor(const QColor& rBackgroundColor) const
{
    const int THRESHOLD = 105;
    int BackgroundDelta = (rBackgroundColor.red() * 0.299) + (rBackgroundColor.green() * 0.587) + (rBackgroundColor.blue() * 0.114);
    return QColor((255- BackgroundDelta < THRESHOLD) ? Qt::black : Qt::white);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-19T13:06:11.443

```
QColor chosenColor = QColorDialog::getColor(); //return the color chosen by user
setColorButton->setBackgroundColor(chosenColor);
setColorButton->setAutoFillBackground(true);
setColorButton->setFlat(true); 
```

how about this?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-10T22:08:55.767

您可以通过从 QPushButton 子类化并覆盖其`paintEvent`. 这应该为您提供一个漂亮的、具有原生外观的颜色按钮。我会尝试以下类似的方法。

颜色按钮.h：

```
#ifndef COLORBUTTON_H
#define COLORBUTTON_H

#include <QtGui>

class ColorButton : public QPushButton
{
    Q_OBJECT
public:
    explicit ColorButton(const QColor & color = Qt::black, QWidget *parent = 0);
    QColor getColor();

signals:
    void colorChanged(QColor);

public slots:
    void changeColor(const QColor &);
    void chooseColor();
    void paintEvent(QPaintEvent *event);

private:
    QColor currentColor;
};

#endif // COLORBUTTON_H 
```

颜色按钮.cpp：

```
#include "colorbutton.h"

ColorButton::ColorButton(const QColor & color, QWidget *parent) :
    QPushButton(parent)
{
    this->setMinimumWidth(50);
    currentColor = color;
    connect(this, SIGNAL(clicked()), this, SLOT(chooseColor()));
}

QColor ColorButton::getColor()
{
    return currentColor;
}

void ColorButton::changeColor(const QColor & color)
{
    currentColor = color;
    colorChanged(currentColor);
}

void ColorButton::chooseColor()
{
    QColor color = QColorDialog::getColor(currentColor, this);
    if (color.isValid())
        changeColor(color);
}

void ColorButton::paintEvent(QPaintEvent *event)
{
    QPushButton::paintEvent(event);

    int colorPadding = 5;

    QRect rect = event->rect();
    QPainter painter( this );
    painter.setBrush( QBrush( currentColor ) );
    painter.setPen("#CECECE");
    rect.adjust(colorPadding, colorPadding, -1-colorPadding, -1-colorPadding);
    painter.drawRect(rect);
} 
```

请注意，其中大部分是现场制作的，尚未完全微调。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-11T08:37:38.133

我认为在这个用例中更改样式表和调色板是不合适的。我更喜欢生成一个 QPixmap 并在 QLabel 中显示它：

```
QPixmap pixmap(16, 16);
pixmap.fill(color);
label->setPixmap(pixmap); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T19:22:32.260

您使用的方法很麻烦，但是是什么让您认为它不便携？它应该可以在 Qt 的任何地方工作。

除此之外，我会尝试以某种方式制作一个充满颜色的按钮，类似于 Jérôme 的回答，只是我可能会制作一个专用按钮来做到这一点，并以某种方式弄乱调色板。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T21:38:20.723

Shihe Zhang 为我工作，除了在我的实现 QPushButton 没有 backgroundColor 属性。要设置按钮的颜色：

```
QPalette p;
p.setColor(QPalette::Button, color);
gColorButton->setPalette(p); 
```

# sql - 您将如何在 Microsoft SQL Server 中实现序列？

> ID：282943
> 
> 赞同：36
> 
> 时间：2008-11-12T03:35:54.573
> 
> 标签：sql, sql-server, database, sequences

有没有人有在 SQL Server 中实现类似序列的好方法？

有时您只是不想使用 GUID，除了它们丑陋的事实。也许你想要的序列不是数字？此外，插入一行然后询问数据库的数字是多少看起来很骇人听闻。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2011-12-11T15:55:17.393

Sql Server 2012 引入了[`SEQUENCE`objects](http://msdn.microsoft.com/en-us/library/ff878058.aspx)，它允许您生成不与任何表关联的顺序数值。

创建它们很容易：

```
CREATE SEQUENCE Schema.SequenceName
AS int
INCREMENT BY 1 ; 
```

在插入之前使用它们的示例：

```
DECLARE @NextID int ;
SET @NextID = NEXT VALUE FOR Schema.SequenceName;
-- Some work happens
INSERT Schema.Orders (OrderID, Name, Qty)
  VALUES (@NextID, 'Rim', 2) ; 
```

请参阅我的博客以深入了解如何使用序列：

[http://sqljunkieshare.com/2011/12/11/sequences-in-sql-server-2012-implementingmanaging-performance/](http://sqljunkieshare.com/2011/12/11/sequences-in-sql-server-2012-implementingmanaging-performance/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-12-10T02:02:19.490

正如[sqljunkieshare](https://stackoverflow.com/users/1092386/sqljunkieshare)正确所说，从 SQL Server 2012 开始，有一个内置[`SEQUENCE`](https://msdn.microsoft.com/en-us/library/ff878091.aspx)功能。

最初的问题没有澄清，但我认为对序列的要求是：

1.  它必须提供一组独特的增长数字
2.  如果多个用户同时请求序列的下一个值，他们都应该得到不同的值。换句话说，无论如何都保证生成值的唯一性。
3.  由于可能会回滚某些事务，因此生成的数字的最终结果可能会有差距。

我想评论原始问题中的声明：

> “此外，插入一行，然后询问数据库，这个数字看起来如此骇人听闻。”

好吧，我们在这里无能为力。DB 是序列号的提供者，DB 处理所有这些您自己无法处理的并发问题。我看不到向数据库询问序列的下一个值的替代方法。必须有一个*原子*操作“给我序列的下一个值”，并且只有 DB 可以提供这样的*原子*操作。没有客户端代码可以保证他是唯一使用该序列的人。

要回答标题“你将如何实现序列”中的问题 - 我们使用的是 2008，它没有该`SEQUENCE`功能，所以在阅读了这个主题之后，我得到了以下内容。

对于我需要的每个序列，我只创建一个单独的帮助表，其中只有一`IDENTITY`列（以与 2012 年相同的方式，您将创建一个单独的序列对象）。

```
CREATE TABLE [dbo].[SequenceContractNumber]
(
    [ContractNumber] [int] IDENTITY(1,1) NOT NULL,

    CONSTRAINT [PK_SequenceContractNumber] PRIMARY KEY CLUSTERED ([ContractNumber] ASC)
) 
```

您可以为其指定起始值和增量。然后我创建一个存储过程，它将返回序列的下一个值。过程将启动一个事务，在帮助表中插入一行，记住生成的标识值并回滚事务。因此，帮助表始终保持为空。

```
CREATE PROCEDURE [dbo].[GetNewContractNumber]
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;
    SET XACT_ABORT ON;

    DECLARE @Result int = 0;

    IF @@TRANCOUNT > 0
    BEGIN
        -- Procedure is called when there is an active transaction.
        -- Create a named savepoint
        -- to be able to roll back only the work done in the procedure.
        SAVE TRANSACTION ProcedureGetNewContractNumber;
    END ELSE BEGIN
        -- Procedure must start its own transaction.
        BEGIN TRANSACTION ProcedureGetNewContractNumber;
    END;

    INSERT INTO dbo.SequenceContractNumber DEFAULT VALUES;

    SET @Result = SCOPE_IDENTITY();

    -- Rollback to a named savepoint or named transaction
    ROLLBACK TRANSACTION ProcedureGetNewContractNumber;

    RETURN @Result;
END 
```

关于程序的一些注释。

首先，如何在只有一个标识列的表中插入一行并不明显。答案是`DEFAULT VALUES`。

然后，如果在另一个事务中调用它，我希望程序能够正常工作。如果存在嵌套事务，则简单[`ROLLBACK`](https://msdn.microsoft.com/en-us/library/ms181299.aspx)回滚所有内容。在我的情况下，我只需要回滚`INSERT`到辅助表中，所以我使用了[`SAVE TRANSACTION`](https://msdn.microsoft.com/en-us/library/ms188378.aspx).

> 没有 savepoint_name 或 transaction_name 的 ROLLBACK TRANSACTION 回滚到事务的开头。嵌套事务时，该语句将所有内部事务回滚到最外层的 BEGIN TRANSACTION 语句。

这就是我使用该程序的方式（在其他一些大程序中，例如，创建一个新合同）：

```
DECLARE @VarContractNumber int;
EXEC @VarContractNumber = dbo.GetNewContractNumber; 
```

如果您需要一次生成一个序列值，这一切都很好。在合同的情况下，每个合同都是单独创建的，因此这种方法非常有效。我可以确定所有合同总是有唯一的合同编号。

注意：只是为了防止可能的问题。这些合同号是我的合同表具有的代理身份密钥的补充。代理键是用于参照完整性的内部键。生成的合同编号是打印在合同上的人性化编号。此外，同一个 Contracts 表同时包含最终合同和提案，它们可以成为合同，也可以永久保留为提案。提案和合同都包含非常相似的数据，这就是它们保存在同一个表中的原因。只需在一行中更改标志，提案就可以成为合同。提案使用单独的数字序列编号，为此我有第二个表格`SequenceProposalNumber`和第二个过程`GetNewProposalNumber`。

* * *

不过，最近我遇到了一个问题。我需要批量生成序列值，而不是一个接一个。

我需要一个程序来一次性处理给定季度内收到的所有付款。这种处理的结果可能是我想在`Transactions`表中记录的约 20,000 笔交易。我这里有类似的设计。`Transactions`表具有最终用户永远不会看到的内部`IDENTITY`列，并且它具有将打印在语句上的人性化交易编号。所以，我需要一种方法来批量生成给定数量的唯一值。

本质上，我使用了相同的方法，但很少有特殊之处。

首先，没有直接的方法可以在只有一`IDENTITY`列的表中插入多行。虽然 (ab)using 有一个解决方法[`MERGE`](https://dba.stackexchange.com/questions/36553/how-do-i-insert-a-default-row)，但我最终没有使用它。我决定添加一个虚拟`Filler`列更容易。我的序列表将始终为空，因此额外的列并不重要。

辅助表如下所示：

```
CREATE TABLE [dbo].[SequenceS2TransactionNumber]
(
    [S2TransactionNumber] [int] IDENTITY(1,1) NOT NULL,
    [Filler] [int] NULL,
    CONSTRAINT [PK_SequenceS2TransactionNumber] 
    PRIMARY KEY CLUSTERED ([S2TransactionNumber] ASC)
) 
```

该过程如下所示：

```
-- Description: Returns a list of new unique S2 Transaction numbers of the given size
-- The caller should create a temp table #NewS2TransactionNumbers,
-- which would hold the result
CREATE PROCEDURE [dbo].[GetNewS2TransactionNumbers]
    @ParamCount int -- not NULL
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;
    SET XACT_ABORT ON;

    IF @@TRANCOUNT > 0
    BEGIN
        -- Procedure is called when there is an active transaction.
        -- Create a named savepoint
        -- to be able to roll back only the work done in the procedure.
        SAVE TRANSACTION ProcedureGetNewS2TransactionNos;
    END ELSE BEGIN
        -- Procedure must start its own transaction.
        BEGIN TRANSACTION ProcedureGetNewS2TransactionNos;
    END;

    DECLARE @VarNumberCount int;
    SET @VarNumberCount = 
    (
        SELECT TOP(1) dbo.Numbers.Number
        FROM dbo.Numbers
        ORDER BY dbo.Numbers.Number DESC
    );

    -- table variable is not affected by the ROLLBACK, so use it for temporary storage
    DECLARE @TableTransactionNumbers table
    (
        ID int NOT NULL
    );

    IF @VarNumberCount >= @ParamCount
    BEGIN
        -- the Numbers table is large enough to provide the given number of rows
        INSERT INTO dbo.SequenceS2TransactionNumber
        (Filler)
        OUTPUT inserted.S2TransactionNumber AS ID INTO @TableTransactionNumbers(ID)
        -- save generated unique numbers into a table variable first
        SELECT TOP(@ParamCount) dbo.Numbers.Number
        FROM dbo.Numbers
        OPTION (MAXDOP 1);

    END ELSE BEGIN
        -- the Numbers table is not large enough to provide the given number of rows
        -- expand the Numbers table by cross joining it with itself
        INSERT INTO dbo.SequenceS2TransactionNumber
        (Filler)
        OUTPUT inserted.S2TransactionNumber AS ID INTO @TableTransactionNumbers(ID)
        -- save generated unique numbers into a table variable first
        SELECT TOP(@ParamCount) n1.Number
        FROM dbo.Numbers AS n1 CROSS JOIN dbo.Numbers AS n2
        OPTION (MAXDOP 1);

    END;

    /*
    -- this method can be used if the SequenceS2TransactionNumber
    -- had only one identity column
    MERGE INTO dbo.SequenceS2TransactionNumber
    USING
    (
        SELECT *
        FROM dbo.Numbers
        WHERE dbo.Numbers.Number <= @ParamCount
    ) AS T
    ON 1 = 0
    WHEN NOT MATCHED THEN
    INSERT DEFAULT VALUES
    OUTPUT inserted.S2TransactionNumber
    -- return generated unique numbers directly to the caller
    ;
    */

    -- Rollback to a named savepoint or named transaction
    ROLLBACK TRANSACTION ProcedureGetNewS2TransactionNos;

    IF object_id('tempdb..#NewS2TransactionNumbers') IS NOT NULL
    BEGIN
        INSERT INTO #NewS2TransactionNumbers (ID)
        SELECT TT.ID FROM @TableTransactionNumbers AS TT;
    END

END 
```

这就是它的使用方式（在一些计算事务的大存储过程中）：

```
-- Generate a batch of new unique transaction numbers
-- and store them in #NewS2TransactionNumbers
DECLARE @VarTransactionCount int;
SET @VarTransactionCount = ...

CREATE TABLE #NewS2TransactionNumbers(ID int NOT NULL);

EXEC dbo.GetNewS2TransactionNumbers @ParamCount = @VarTransactionCount;

-- use the generated numbers...
SELECT ID FROM #NewS2TransactionNumbers AS TT; 
```

这里几乎没有什么需要解释的。

我需要在表中插入给定数量的行`SequenceS2TransactionNumber`。我为此使用了一个辅助`Numbers`表。该表仅保存从 1 到 100,000 的整数。它也用于系统中的其他地方。我检查表中是否有足够的行，`Numbers`并在需要时通过与自身交叉连接将其扩展为 100,000 * 100,000。

我必须将批量插入的结果保存在某处并以某种方式将其传递给调用者。在存储过程之外传递表的一种方法是使用临时表。我不能在这里使用表值参数，因为不幸的是它是只读的。另外，我不能直接将生成的序列值插入到临时表中`#NewS2TransactionNumbers`。我不能`#NewS2TransactionNumbers`在`OUTPUT`子句中使用，因为`ROLLBACK`会清理它。幸运的是，表变量不受`ROLLBACK`.

因此，我使用表变量`@TableTransactionNumbers`作为`OUTPUT`子句的目标。然后我`ROLLBACK`清理序列表的事务。然后将生成的序列值从表变量复制`@TableTransactionNumbers`到临时表`#NewS2TransactionNumbers`，因为`#NewS2TransactionNumbers`存储过程的调用者只能看到临时表。`@TableTransactionNumbers`存储过程的调用者看不到表变量。

此外，可以使用`OUTPUT`子句将生成的序列直接发送给调用者（正如您在使用的注释变体中看到的那样`MERGE`）。它本身工作正常，但我需要在某个表中生成的值以便在调用存储过程中进一步处理。当我尝试这样的事情时：

```
INSERT INTO @TableTransactions (ID)
EXEC dbo.GetNewS2TransactionNumbers @ParamCount = @VarTransactionCount; 
```

我收到一个错误

> 不能在 INSERT-EXEC 语句中使用 ROLLBACK 语句。

但是，我需要`ROLLBACK`在里面`EXEC`，这就是为什么我最终有这么多临时表。

毕竟，切换到具有适当`SEQUENCE`对象的最新版本的 SQL Server 是多么美好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T03:44:14.760

[Identity 列](http://msdn.microsoft.com/en-us/library/ms186775.aspx)大致类似于序列。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-12T03:44:26.210

您可以只使用普通的旧表并将它们用作序列。这意味着您的插入将始终是：

```
BEGIN TRANSACTION  
SELECT number from plain old table..  
UPDATE plain old table, set the number to be the next number  
INSERT your row  
COMMIT 
```

但不要这样做。锁定会很糟糕...

我从 SQL Server 开始，对我来说，Oracle“序列”方案看起来像是一个 hack。我猜你是从另一个方向过来的，而且 scope_identity() 看起来像一个黑客。

克服它。在罗马做到入乡随俗。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-08-28T19:48:26.643

我用来解决这个问题的方法是一个表'Sequences'，它存储了我所有的序列和一个'nextval'存储过程。

Sql 表：

```
CREATE TABLE Sequences (  
    name VARCHAR(30) NOT NULL,  
    value BIGINT DEFAULT 0 NOT NULL,  
    CONSTRAINT PK_Sequences PRIMARY KEY (name)  
); 
```

PK_Sequences**只是**用来确保永远不会有同名的序列。

Sql存储过程：

```
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'nextVal') AND type in (N'P', N'PC')) DROP PROCEDURE nextVal;  
GO  
CREATE PROCEDURE nextval  
    @name VARCHAR(30)  
AS  
    BEGIN  
        DECLARE @value BIGINT  
        BEGIN TRANSACTION  
            UPDATE Sequences  
            SET @value=value=value + 1  
            WHERE name = @name;  
            -- SELECT @value=value FROM Sequences WHERE name=@name  
        COMMIT TRANSACTION  
        SELECT @value AS nextval  
    END; 
```

插入一些序列：

```
INSERT INTO Sequences(name, value) VALUES ('SEQ_Workshop', 0);
INSERT INTO Sequences(name, value) VALUES ('SEQ_Participant', 0);
INSERT INTO Sequences(name, value) VALUES ('SEQ_Invoice', 0); 
```

最后得到一个序列的下一个值，

```
execute nextval 'SEQ_Participant'; 
```

一些 c# 代码从序列表中获取下一个值，

```
public long getNextVal()
{
    long nextval = -1;
    SqlConnection connection = new SqlConnection("your connection string");
    try
    {
        //Connect and execute the select sql command.
        connection.Open();

        SqlCommand command = new SqlCommand("nextval", connection);
        command.CommandType = CommandType.StoredProcedure;
        command.Parameters.Add("@name", SqlDbType.NVarChar).Value = "SEQ_Participant";
        nextval = Int64.Parse(command.ExecuteScalar().ToString());

        command.Dispose();
    }
    catch (Exception) { }
    finally
    {
        connection.Dispose();
    }
    return nextval;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-23T15:27:35.870

在 SQL Server 2012 中，您可以简单地使用

```
CREATE SEQUENCE 
```

在 2005 年和 2008 年，您可以使用公用表表达式获得任意序列号列表。

这是一个示例（请注意，MAXRECURSION 选项很重要）：

```
DECLARE @MinValue INT = 1;
DECLARE @MaxValue INT = 1000;

WITH IndexMaker (IndexNumber) AS
(
    SELECT 
        @MinValue AS IndexNumber
    UNION ALL SELECT 
        IndexNumber + 1
    FROM
        IndexMaker
    WHERE IndexNumber < @MaxValue
)
SELECT
    IndexNumber
FROM
    IndexMaker
ORDER BY
    IndexNumber
OPTION 
    (MAXRECURSION 0) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-12T05:33:09.533

Oracle 实现的序列需要在插入之前调用数据库。SQL Server 实现的标识需要在插入后调用数据库。

一个并不比另一个更骇人听闻。最终效果是相同的 - 依赖/依赖数据存储以提供唯一的人工键值和（在大多数情况下）对存储的两次调用。

我假设您的关系模型基于人工键，在这种情况下，我将提供以下观察：

我们永远不应该试图赋予人造钥匙以意义；它们的唯一目的应该是链接相关记录。

您对订购数据有什么需求？它可以在视图（演示文稿）中处理，还是必须保留的数据的真实属性？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-01-13T18:45:29.367

创建一个带有标识符的阶段表。

在加载阶段表之前，截断并重新设置标识符以从 1 开始。

加载你的表。现在每一行都有一个从 1 到 N 的唯一值。

创建一个包含序列号的表。这可能是几行，每个序列一个。

从您创建的序列表中查找序列号。通过将阶段表中的行数添加到序列号来更新序列号。

通过添加您查找的序列号来更新阶段表标识符。这是一个简单的一步过程。或加载您的目标表，在 ETL 中加载时将序列号添加到标识符中。这可以利用批量加载程序并允许其他转换。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-08T14:51:25.350

考虑以下代码段。

```
CREATE TABLE [SEQUENCE](
    [NAME] [varchar](100) NOT NULL,
    [NEXT_AVAILABLE_ID] [int] NOT NULL,
 CONSTRAINT [PK_SEQUENCES] PRIMARY KEY CLUSTERED 
(
    [NAME] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

CREATE PROCEDURE CLAIM_IDS (@sequenceName varchar(100), @howMany int)
AS
BEGIN
    DECLARE @result int
    update SEQUENCE
        set
            @result = NEXT_AVAILABLE_ID,
            NEXT_AVAILABLE_ID = NEXT_AVAILABLE_ID + @howMany
        where Name = @sequenceName
    Select @result as AVAILABLE_ID
END
GO 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-09-28T22:14:59.407

正如[sqljunkiesshare 所述](https://stackoverflow.com/a/8465306/3347858)，序列已添加到 SQL Server 2012。以下是如何在 GUI 中执行此操作。这是等价的：

```
CREATE SEQUENCE Schema.SequenceName
AS int
INCREMENT BY 1 ; 
```

1.  在*Object Explorer*中，展开*Programmability*文件夹
2.  在*Programmability*文件夹下，右键单击*Sequences* 文件夹，如下图所示：

[![在此处输入图像描述](https://i.stack.imgur.com/cKQDY.png)](https://i.stack.imgur.com/cKQDY.png)

3.  下划线是您将更新以获得与上述 SQL 语句等效的值，但是，我会考虑根据您的需要更改这些值（请参阅下面的注释）。

[![在此处输入图像描述](https://i.stack.imgur.com/SIPcJ.png)](https://i.stack.imgur.com/SIPcJ.png)

笔记：

*   默认起始值​​、最小值和最大值由数据类型的范围确定，在这种情况下为 int。[如果您想使用除 int 以外的其他内容，请参阅此处了解更多数据类型范围](https://msdn.microsoft.com/en-us/library/ms187745.aspx)。

*   很有可能您希望您的序列从 1 开始，并且您可能也希望您的最小值为 1。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-15T15:56:28.900

如果您使用的是 SQL Server 2005，您可以选择使用 Row_Number

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-12T03:47:19.280

我完全同意并在去年的一个项目中做到了这一点。

我刚刚创建了一个包含序列名称、当前值和增量数量的表。

然后我创建了一个 2 procs 来添加和删除它们。还有 2 个功能可以获取下一个并获取最新信息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-12T04:13:10.833

如果您想使用顺序键插入数据，但又不想再次查询数据库以获取刚刚插入的键，我认为您唯一的两个选择是：

1.  通过返回新插入的键值的存储过程执行插入
2.  实现序列客户端（以便在插入之前知道新密钥）

如果我正在生成客户端密钥，我*喜欢*GUID。我觉得他们很漂亮。

```
row["ID"] = Guid.NewGuid(); 
```

那条线应该放在某处跑车的引擎盖上。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-17T14:52:37.250

标识列的另一个问题是，如果您有多个表的序列号需要唯一，则标识列不起作用。就像 Corey Trager 提到的那样，自己滚动的序列实现类型可能会带来一些锁定问题。

最直接等效的解决方案似乎是创建一个 SQL Server 表，其中包含一个用于标识的列，它代替了单独类型的“序列”对象。例如，如果在 Oracle 中，您将有来自一个序列的两个表，例如 Dogs <-- 序列对象 --> Cats，那么在 SQL Server 中，您将创建三个数据库对象，所有表都像 Dogs <-- Pets with identity column -->猫。您将在 Pets 表中插入一行以获取您通常使用 NEXTVAL 的序列号，然后在您从用户那里获得宠物的实际类型后像往常一样插入到 Dogs 或 Cats 表中。任何额外的公共列都可以从 Dogs/Cats 表移动到 Pets 超类型表中，其后果是 1) 每个序列号会有一行，

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-01-24T22:28:57.267

**交易安全！**对于 2012 年之前的 SQLServer 版本...（感谢 Matt G。）此讨论中缺少的一件事是事务安全。如果您从序列中获取数字，则该数字必须是唯一的，并且没有其他应用程序或代码应该能够获取该数字。在我的例子中，我们经常从序列中提取唯一的数字，但是实际的交易可能会跨越相当长的时间，所以我们不希望其他人在我们提交交易之前得到相同的数字。 ***我们需要模仿 oracle 序列的行为***，其中一个数字在拉取时被保留。我的解决方案是使用 xp_cmdshell 在数据库上获取单独的会话/事务，以便我们可以立即更新整个数据库的序列，甚至在事务完成之前。

```
--it is used like this:
-- use the sequence in either insert or select:
Insert into MyTable Values (NextVal('MySequence'), 'Foo');

SELECT NextVal('MySequence');

--you can make as many sequences as you want, by name:
SELECT NextVal('Mikes Other Sequence');

--or a blank sequence identifier
SELECT NextVal(''); 
```

该解决方案需要一个表来保存使用过的序列值，以及一个***创建第二个自主事务***以确保并发会话不会纠缠的过程。您可以拥有任意数量的唯一序列，它们按名称引用。下面的示例代码被修改为省略序列历史表上的请求用户和日期戳（用于审计），但我认为示例不太复杂；-)。

```
 CREATE TABLE SequenceHolder(SeqName varchar(40), LastVal int);

GO
CREATE function NextVAL(@SEQname varchar(40))
returns int
as
begin
    declare @lastval int
    declare @barcode int;

    set @lastval = (SELECT max(LastVal) 
                      FROM SequenceHolder
                     WHERE SeqName = @SEQname);

    if @lastval is null set @lastval = 0

    set @barcode = @lastval + 1;

    --=========== USE xp_cmdshell TO INSERT AND COMMINT NOW, IN A SEPERATE TRANSACTION =============================
    DECLARE @sql varchar(4000)
    DECLARE @cmd varchar(4000)
    DECLARE @recorded int;

    SET @sql = 'INSERT INTO SequenceHolder(SeqName, LastVal) VALUES (''' + @SEQname + ''', ' + CAST(@barcode AS nvarchar(50)) + ') '
    SET @cmd = 'SQLCMD -S ' + @@servername +
              ' -d ' + db_name() + ' -Q "' + @sql + '"'
    EXEC master..xp_cmdshell @cmd, 'no_output'

    --===============================================================================================================

    -- once submitted, make sure our value actually stuck in the table
    set @recorded = (SELECT COUNT(*) 
                       FROM SequenceHolder
                      WHERE SeqName = @SEQname
                        AND LastVal = @barcode);

    --TRIGGER AN ERROR 
    IF (@recorded != 1)
        return cast('Barcode was not recorded in SequenceHolder, xp_cmdshell FAILED!! [' + @cmd +']' as int);

    return (@barcode)

end

GO

COMMIT; 
```

现在要使该过程正常工作，您将需要启用 xp_cmdshell，有很多关于如何做到这一点的很好的描述，这是我在尝试使事情正常工作时所做的个人笔记。基本思想是你需要在 SQLServer Surface 中打开 xp_cmdshell 是一个配置，你需要设置一个用户帐户作为 xp_cmdshell 命令将在其下运行的帐户，该帐户将访问数据库以插入序列号并提交它。

```
--- LOOSEN SECURITY SO THAT xp_cmdshell will run 
---- To allow advanced options to be changed.
EXEC sp_configure 'show advanced options', 1
GO
---- To update the currently configured value for advanced options.
RECONFIGURE
GO
---- To enable the feature.
EXEC sp_configure 'xp_cmdshell', 1
GO
---- To update the currently configured value for this feature.
RECONFIGURE
GO

—-Run SQLServer Management Studio as Administrator,
—- Login as domain user, not sqlserver user.

--MAKE A DATABASE USER THAT HAS LOCAL or domain LOGIN! (not SQL server login)
--insure the account HAS PERMISSION TO ACCESS THE DATABASE IN QUESTION.  (UserMapping tab in User Properties in SQLServer)

—grant the following
GRANT EXECUTE on xp_cmdshell TO [domain\user] 

—- run the following:
EXEC sp_xp_cmdshell_proxy_account 'domain\user', 'pwd'

--alternative to the exec cmd above: 
create credential ##xp_cmdshell_proxy_account## with identity = 'domain\user', secret = 'pwd'

-—IF YOU NEED TO REMOVE THE CREDENTIAL USE THIS
EXEC sp_xp_cmdshell_proxy_account NULL;

-—ways to figure out which user is actually running the xp_cmdshell command.
exec xp_cmdshell 'whoami.exe'  
EXEC xp_cmdshell 'osql -E -Q"select suser_sname()"'
EXEC xp_cmdshell 'osql -E -Q"select * from sys.login_token"' 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-10-21T07:52:35.770

通过 SQL 你可以使用这个策略；

```
CREATE SEQUENCE [dbo].[SequenceFile]
AS int
START WITH 1
INCREMENT BY 1 ; 
```

并通过此 SQL 读取唯一的下一个值

```
SELECT NEXT VALUE FOR [dbo].[SequenceFile] 
```

# jquery - jquery 一个滑块控制另一个

> ID：282944
> 
> 赞同：2
> 
> 时间：2008-11-12T03:36:48.550
> 
> 标签：jquery, slider

如何让一个 jquery ui 滑块控制另一个？如果我滑动滑块#1，它也应该滑动滑块#2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T04:07:14.357

创建滑块一时提供一个滑动/更改函数，该函数使用滑块一上正在更改的句柄的 ui.value 并设置滑块 2 上的句柄值。根据您的滑块有多少个手柄，您需要调整以下内容：

**注意**我还没有尝试过，所以您可能需要对其进行一些调整。

```
<div id='example1' class='ui-slider-1' style="margin:10px;">
<div class='ui-slider-handle'></div>    
</div>

<div id='example2' class='ui-slider-1' style="margin:10px;">
<div class='ui-slider-handle'></div>    
</div>

$('#example1').slider( { slide: moveSlider2 } );
$('#example2').slider( );

function moveSlider2( e, ui ) 
{
    $('#example2').slider( 'moveTo', ui.value );
} 
```

# c++ - 使用 Chromium 作为 MFC CWnd

> ID：282966
> 
> 赞同：2
> 
> 时间：2008-11-12T03:50:15.373
> 
> 标签：c++, mfc, google-chrome

我希望将 Google Chromium 用于我的 MFC 应用程序作为 HTML 渲染器。我找到了这个测试床应用程序，我想知道是否有人知道我可以理解它的方法或资源，以便我可以将 Webkit/Webview 的东西提取到我的应用程序中。谢谢。

~/webkit/tools/test_shell ~/webkit/tools/test/reference_build/webkit-release/test_shell.exe

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T18:32:32.813

#chromium 在 irc.freenode.net

[http://groups.google.com/group/chromium-dev](http://groups.google.com/group/chromium-dev)

# linux - 什么是适用于 Linux 的好的 Prolog IDE？

> ID：282968
> 
> 赞同：46
> 
> 时间：2008-11-12T03:50:56.447
> 
> 标签：linux, ide, prolog

我需要为一个类编写一些 Prolog 程序。

有什么建议吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-12T03:52:48.627

(X)Emacs 的 Prolog 模式。

见[http://bruda.ca/emacs-prolog/](http://bruda.ca/emacs-prolog/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-08-04T16:57:43.103

如前所述，您可以使用 SWI-Prolog。如果您喜欢 Eclipse，那么有一个 Eclipse 插件可以将 SWI-Prolog 集成到 Eclipse 中。这样您就拥有了两全其美的优势，例如 Eclipse 的 SVN 等功能和 SWI-Prolog 的图形调试器。值得一试。

[http://sewiki.iai.uni-bonn.de/research/pdt/start](http://sewiki.iai.uni-bonn.de/research/pdt/start)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-07-22T08:09:58.897

[SWI-Prolog](http://www.swi-prolog.org/IDE.html)带有出色的 IDE 工具、一个 Emacs 克隆文本编辑器、交互式调试器、完整的可浏览帮助系统和文档。试试看。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-12T03:58:06.760

我没有尝试过（主要是因为我以前从未想过将“Prolog”和“NetBeans”这两个词结合起来），但似乎[Prolog 支持 NetBeans](http://platform.netbeans.org/tutorials/60/nbm-prolog.html)。它不是一个简单的插件，而是一个展示如何向 NetBeans 添加 Prolog 支持的教程。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-15T01:24:47.147

一个好的开始点是使用 Emacs 的默认 Prolog 模式以及[此处](http://www.metalevel.at/pceprolog/pceprolog.html)描述的附加功能。您也可以尝试[ediprolog](http://www.metalevel.at/ediprolog/ediprolog.html)，它旨在实现更紧密的 Emacs-Prolog 集成。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-02-04T12:32:35.533

[Ideone](http://ideone.com)支持 Prolog。您可以通过浏览器在线使用它。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-09-04T05:30:12.420

Prolog 开发工具 (ProDT) 是一个 Prolog 集成开发环境 (IDE)，旨在提供与 Eclipse 的 java IDE 一样丰富的功能，为开发人员提供一个单一的环境，在该环境中，它可以从代码编辑、测试执行控制 Prolog 项目的开发， ETC...

该项目位于 Eclipse 项目之上，以利用其已经存在的特性和可扩展性，并适用于 Eclipse 工作的任何环境，包括 windows、linux 和 mac OSX。

它支持作为底层解释器：SWI-prolog、XSB prolog、B-prolog

该站点包含有关该项目的更多信息，包括安装和功能列表： http: [//prodevtools.sourceforge.net/](http://prodevtools.sourceforge.net/)

希望你能发现它有用！！！:)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-09-04T06:29:33.953

[SPIDER](http://www.sics.se/sicstus/spider/site/index.html)是[SICStus Prolog](http://www.sics.se/isl/sicstuswww/site/index.html)的基于 Eclipse 的 IDE 。SICStus Prolog 还有一个非常有用的 Emacs 模式。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-04-25T15:16:10.870

如果您习惯于 Emacs 环境，我会推荐 Ciao 发行版。访问：[http ://ciaohome.org/](http://ciaohome.org/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-05-29T13:29:23.170

swi prolog 和 emacs 扩展几乎预装在每个 linux 发行版中。您可以使用以下命令在启用 X11 的（图形）环境中检查这一点。这应该会打开一个带有内置 Emacs 克隆的新窗口。

```
% swipl
?- emacs. 
```

[http://www.swi-prolog.org/build/LinuxDistro.txt](http://www.swi-prolog.org/build/LinuxDistro.txt)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-06-24T22:42:15.830

[Visual Prolog](http://www.visual-prolog.com/)（与 Wine 一起使用）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-12T04:04:11.663

我只是使用 Vim 或 jEdit。Prolog 作为一种语言并不真正适合强大的 IDE 支持。一方面，它是动态类型的，这给工具带来了巨大的麻烦。另一方面，它是一种基于逻辑的语言，这意味着“代码流”（构建程序的顺序）是非线性的。用于构建高度先进的 IDE 的现有技术并不适用于那种范式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-22T16:43:23.470

你可以使用 Gprolog，我们在课堂上使用它。使用consult('filename') 加载数据库。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-12-11T23:19:56.293

老实说，我看不到“IDE”对 prolog 有多大帮助。它只会帮助查找语法错误。其余的都在调试和思考过程中。

使用任何编辑器获得语法高亮显示，您就可以开始了。

# installation - 在 InstallShield 中以编程方式设置 INSTALLDIR

> ID：282976
> 
> 赞同：0
> 
> 时间：2008-11-12T03:56:32.427
> 
> 标签：installation, installshield

我正在尝试在 InstallShield v8.02 中以编程方式设置更改 INSTALLDIR（无法对版本执行任何操作）。

我的代码在此代码 (C#) 的第三行出现异常“未知错误”崩溃

```
String originalInstallDir = testProject.get_INSTALLDIR();
String installDir = originalInstallDir.Replace("Company", "Company Test");
testProject.set_INSTALLDIR(ref(installDir)); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-10T09:08:22.043

更好地迁移到最新版本的 Installshield，并在 Installscript 的帮助下，您可以使用 INSTALLDIR 属性来实现它。

# java - 哪个类调用了我的静态方法？

> ID：282977
> 
> 赞同：8
> 
> 时间：2008-11-12T03:57:28.057
> 
> 标签：java, reflection

假设我有一个带有静态方法的 Java 类，如下所示：

```
A级
{
    静态无效 foo()
    {
        // 哪个类调用了我？
    }
}

```

并进一步假设 A 类有任意数量的子类：

```
B 类扩展 A { }
C 类扩展 A { }
D 类扩展 A { }
...

```

现在考虑以下方法调用：

```
A.foo();
B.foo();
C.foo();
D.foo();
...

```

我的问题是，方法如何`foo()`判断哪个类正在调用它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-12T04:11:56.250

它不能，这是静态方法问题的一部分。就编译器而言`A.foo()`，`B.foo()`它们是完全相同的东西。事实上，它们编译成相同的字节码。你不能得到比这更相似的了。

如果您真的需要此类信息，请使用单例并`foo()`转换为实例方法。如果你仍然喜欢静态语法，你可以构建一个外观`A.foo()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T12:39:43.743

尽管您无法找出*调用*了静态方法的类，但可以找出在运行时实际*调用*了该方法的类：

```
static void foo()
{
   Throwable t = new Throwable();
   StackTraceElement[] trace = t.getStackTrace();
   String className = trace[1].getClassName();
   Class whoCalledMe = null;
   try
   {
      whoCalledMe = Class.forName( className );
   }
   catch( Exception e )
   {
   }
} 
```

我并不是说这是一种好的做法，从性能的角度来看它也可能不是很好，但它应该可以工作。不知道对你有没有帮助...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T10:26:47.990

```
class A
{
    static void foo(A whoIsCalingMe)
    {
        // Which class invoked me?
    }
} 
```

# wpf - 当鼠标在 UC 区域之外时，WPF 用户控件可以检测到 MouseMovement

> ID：282982
> 
> 赞同：2
> 
> 时间：2008-11-12T03:59:25.463
> 
> 标签：wpf, events, user-controls, mouse, onmousemove

我正在编写一个 WPF 应用程序，通过该应用程序以编程方式动态创建用户控件以响应事件。主窗口画布有一个网格，我正在添加新的 columndefs 和 rowdefs，其中包含新的用户控件。

我需要这些用户控件来跟踪鼠标的位置，以便它们可以根据鼠标相对于 UC 边界的位置来响应事件。这在 UC 的范围内可以正常工作，但是一旦鼠标离开 UC 区域（进入另一个 UC 的区域或父窗口的区域），UC 就会失去对鼠标所在位置的跟踪，并且无法再响应。

关于如何让我的 UC 跟踪鼠标下落的任何建议？也许来自父窗口？

非常感谢格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T04:13:39.850

您想查看[Mouse.Capture](http://msdn.microsoft.com/en-us/library/ms591452(VS.85).aspx)。不过，请确保牢记[CaptureMode](http://msdn.microsoft.com/en-us/library/system.windows.input.capturemode(VS.85).aspx)。

# assembly - 设置 IRQ 映射

> ID：282983
> 
> 赞同：9
> 
> 时间：2008-11-12T04:01:01.670
> 
> 标签：assembly, x86, kernel, osdev, irq

我正在关注几个教程和参考资料，试图设置我的内核。我在一个根本没有解释它的教程中遇到了一些不熟悉的代码。我被告知将其映射`16 IRQs (0-15)`到 ISR 位置的代码`32-47`：

```
void irq_remap(void)
{
    outportb(0x20, 0x11);
    outportb(0xA0, 0x11);
    outportb(0x21, 0x20);
    outportb(0xA1, 0x28);
    outportb(0x21, 0x04);
    outportb(0xA1, 0x02);
    outportb(0x21, 0x01);
    outportb(0xA1, 0x01);
    outportb(0x21, 0x0);
    outportb(0xA1, 0x0);
} 
```

的代码`outportb()`如下，但我已经清楚地掌握了它的作用：

```
void outPortB(unsigned short port, unsigned char data)
{
    __asm__ __volatile__ ("outb %1, %0" : : "dN" (port), "a" (data));
} 
```

我应该提一下，这是在保护模式下的 x86 架构上。此源代码工作正常，我了解它的作用，但我不明白它是如何做到的。有人可以向我解释这里发生了什么，以便万一我需要对此进行扩展，我会知道我在做什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-12T04:24:06.537

`outb`和类似的，写入硬件 IO 端口。基本上，与设备通信有 2 个主要选项。您可以将设备映射到内存或 IO 端口。

至于这段代码是如何工作的，我会为你评论它：

ICW 代表“初始化命令词”

```
outportb(0x20, 0x11); /* write ICW1 to PICM, we are gonna write commands to PICM */
outportb(0xA0, 0x11); /* write ICW1 to PICS, we are gonna write commands to PICS */

outportb(0x21, 0x20); /* remap PICM to 0x20 (32 decimal) */
outportb(0xA1, 0x28); /* remap PICS to 0x28 (40 decimal) */

outportb(0x21, 0x04); /* IRQ2 -> connection to slave */ 
outportb(0xA1, 0x02);

outportb(0x21, 0x01); /* write ICW4 to PICM, we are gonna write commands to PICM */
outportb(0xA1, 0x01); /* write ICW4 to PICS, we are gonna write commands to PICS */

outportb(0x21, 0x0); /* enable all IRQs on PICM */
outportb(0xA1, 0x0); /* enable all IRQs on PICS */ 
```

希望这可以帮助

欢迎来到 OS 开发者的世界 :) 我还建议您访问：http: [//forum.osdev.org/](http://forum.osdev.org/)，对于一个新的爱好 OS 开发者来说，这是一个非常宝贵的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-30T21:38:03.080

简单的答案是，在保护模式下，第一个可编程中断控制器使用的中断是保护模式异常，这意味着它们必须重新映射。

令人高兴的答案是只`PIC`需要重新映射第一个（第二个的重新映射只是为了方便，因为它开始于`int 70h`）。这是原始 AT BIOS 的引述。

```
INTA00    equ  020h        ; 8259 port
INTA01    equ  021h        ; 8259 port
INTB00    equ  0A0h        ; 2nd 8259
INTB01    equ  0A1h
INT_TYPE  equ  070h        ; start of 8259 interrupt table location

;---------------------------------------------------------
;    re-initialize the 8259 interrupt #1 controller chip :
;---------------------------------------------------------
  mov  al, 11h             ; icw1 - edge, master, icw4
  out  INTA00,al
  jmp  $+2                 ; wait state for i/o
  mov  al, 8               ; setup icw2 - int type 8 (8-f)
  out  INTA01, al
  jmp  $+2
  mov  al, 4               ; setup icw3 - master lv 2
  out  INTA01, al
  jmp  $+2
  mov  al, 1               ; setup icw4 - master, 8086 mode
  out  INTA01, al
  jmp  $+2
  mov  al, 0FFh            ; mask all ints. off
  out  INTA01, al          ; (video routine enables interrupts)
;---------------------------------------------------------
;    re-initialize the 8259 interrupt #2 controller chip  :
;---------------------------------------------------------
  mov  al, 11h             ; icw1 - edge, slave icw4
  out  INTB00, al
  jmp  $+2
  mov  al, INT_TYPE        ; setup icw2 - int type 70 (70-7f)
  out  INTB01, al
  mov  al, 2               ; setup icw3 - slave lv 2
  jmp  $+2
  out  INTB01, al
  jmp  $+2
  mov  al, 1               ; setup icw4 - 8086 mode, slave
  out  INTB01, al
  jmp  $+2
  mov  al, 0FFh            ; mask all ints. off
  out  INTB01, al
;-------------------------------------------------------------------------------- 
```

技术参考 AT BIOS (c) 1984 IBM

笔记：

在`jmp $+2 ; wait state for i/o`当前 PC 上不需要。

`icw1`清除中断屏蔽寄存器，从而启用该 PIC 上的中断。

8259A 芯片早已不复存在，但仍然使用编程接口。 [8259A 可编程中断控制器](http://pdos.csail.mit.edu/6.828/2005/readings/hardware/8259A.pdf "8259A 可编程中断控制器")

# database - 命名数据库中的中间表

> ID：282984
> 
> 赞同：1
> 
> 时间：2008-11-12T04:01:08.627
> 
> 标签：database, naming-conventions

考虑两个表事务和类别，每个表都有自己的 ID 和信息。

一个事务可以有多个类别，我已经阅读过创建第三个表以使用它们的 ID 链接事务和类别是最好的。但是，假设您有很多人喜欢它，您会怎么称呼这张桌子？

transactionCategories 是我想出的最好的，还有更好的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T04:05:21.317

我对这些的命名方案是使用域的术语进行交互，如果有的话（例如 not `student_class`, but `enrollment`）。如果没有这样的术语，那么你就会退回到`transaction_category`听起来`category_transaction`更好的那个。

另外，我总是用单数命名我的表（例如学生而不是学生）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T04:04:52.847

我通常使用相同的方法，复数有助于将其区分为关系表，并且它包含两个名称，因此很清楚哪些表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T04:04:02.693

TransactionCategories 很好。可能没有什么“更好”，只是不同。

过去有时，当我创建一个只有两个外键的表时，它需要解析多对多，我将“Xref”附加到它的名称中，这表明它没有任何属性。它只是为了解决多对多问题。

# c - 退出前是否需要关闭文件描述符？

> ID：282992
> 
> 赞同：26
> 
> 时间：2008-11-12T04:05:16.700
> 
> 标签：c, embedded, file-descriptor

当然，大多数情况下的直接答案是**“是”**，我坚信一个进程应该正确清理它分配的任何资源，但我的情况是一个长时间运行的系统守护进程，它打开一个固定的启动时文件描述符的数量，并在退出之前将它们全部关闭。

这是一个嵌入式平台，我试图使代码尽可能紧凑，同时不引入任何不好的风格。但是由于文件描述符在退出之前已经关闭，这个文件描述符清理代码有什么用途吗？您是否总是关闭所有文件描述符？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-12T04:11:59.620

使用完文件描述符后关闭它们会使您的代码更可重用且更易于扩展。在我看来，这听起来像是您有正当理由让它们自动关闭的情况。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T05:20:53.397

是的，关闭你的文件描述符并释放所有堆内存，即使你知道操作系统会清理它——这样，当你运行 valgrind 或一些类似的工具时，你不会在结果中得到很多噪音，并且您可以轻松识别“合法”的 fd 泄漏。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-12T05:10:39.190

在嵌入式平台的美丽世界里，真的很难说会发生什么。但是，如果我处于您的情况，我只需手动测试以查看文件 ID 是否真的被释放。而且，如果空间如此重要，也许您可​​以在其他地方记录这一事实。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-01-22T01:30:35.683

关于将关闭文件描述符留给自动清理，我会担心的一个问题是，您对写入所述文件描述符的任何数据的关心程度以及您是否可以合理地处理写入失败。

write() 不需要阻塞（取决于它首先是如何打开（））并等待数据成功提交，因此在某些情况下关闭可能会失败，因为底层子系统无法提交挂起的写入，因此关闭退出失败并将 errno 设置为 EIO，并且根据您刚刚编写的内容，您可能想要也可能不想采取一些纠正措施。

诚然，这是您真正关心数据一致性的极端情况，即 DBMS 类型的应用程序或报告备份的成功/失败。在许多（大多数？）情况下，这并不重要，您可以不用 close() 来处理清理/退出。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-12T04:09:48.267

人3退出：

```
....
All open stdio(3) streams are flushed and closed.  Files created by tmpfile(3) are removed. 
```

所以我相信离开 main 有效地调用了带有 main 的返回值的 exit 函数。虽然我认为这是一种糟糕的风格。就个人而言，我*总是*明确地释放/关闭任何获得的资源。

# mysql - 如何设计可与 MySQL 和 SQL Server 一起使用的数据库模式？

> ID：282993
> 
> 赞同：4
> 
> 时间：2008-11-12T04:05:18.323
> 
> 标签：mysql, sql-server, database-design

我想给客户一个选择数据库引擎的机会，同时也想尽量减少我这样决定的麻烦。
有问题的引擎是 MySQL（5 或更高版本）和 SQL Server（2005 或更高版本）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T04:11:47.170

谷歌了解数据类型的差异。

但是模式只是图片的一部分。

SQL 方言也不同。谷歌这些差异。然后，要么坚持两者通用的 SQL 子集，要么构建一个方案以在每个中使用稍微不同的 SQL。

不要等到最后才在“其他”数据库上进行测试。从一开始就对两者进行测试，这样您就不会在死胡同的设计方向上投入太多。

这是一个起点： http:
[//www.microsoft.com/technet/prodtechnol/sql/2000/deploy/mysql.mspx#EZD](http://www.microsoft.com/technet/prodtechnol/sql/2000/deploy/mysql.mspx#EZD)
和：
[http://troels.arvin.dk/db/rdbms/#insert](http://troels.arvin.dk/db/rdbms/#insert)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T04:44:45.670

我对这样的跨数据库开发的四个主要指导方针是：

1.  不要在 *任何名称中使用空格*
2.  不要将任一数据库中的关键字用作列名（ORDER、DATE 等）
3.  尽可能使用最简单的列类型（CHAR、INT）。日期和时间戳类型的列差异可能会在某些时候让您感到困惑，因此请尽可能避免使用它们（我知道这通常不现实）。
4.  去规范化比你认为合适的更多。您的查询越复杂和 JOIN-y，您就越有可能最终不得不维护查询的特定于 db 的配对版本，以使所有内容都可以在两个数据库上可接受地工作。一旦你到了那里，你就注定了。

1 和 2 确实是同一个问题 - 所有数据库都允许转义对象名称（因此您可以使用带有空格的名称以及 ORDER 和 DATE 之类的名称），但它们通常以不同的方式执行此操作，因此 SQL Server 的此查询：

```
SELECT [ORDER], [Why This Name] FROM [Table From Hell] 
```

必须

```
SELECT "ORDER", "Why This Name" FROM "Table From Hell" 
```

在 Oracle 中，然后您有每个查询的两个版本或一些 uber-janky 分隔符替换代码。我通常采用更简单的方法，即不使用关键字或空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T04:24:47.940

本文介绍了一些主要区别。

[MSSQL 和 mySQL 的区别](http://www.dotnetspider.com/resources/21688-difference-between-MSSQL-MYSQL.aspx)

您可能想要处理数据访问层中的差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T05:32:24.247

根据您使用的语言，您可以在中间插入一个 ORM 层，例如（例如）Doctrine PHP，它应该可以帮助您不必直接编写 SQL。就其他评论中的初始模式而言，有许多很好的建议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-03T13:54:50.847

Mysql 提供了一个导出功能，可让您将架构导出为与 SQL Server 兼容的格式。

如前所述，尽可能使用最简单的类型，不要依赖标准 SQL。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T04:58:10.820

一个“有趣”的选项是根本不编写 SQL。构建一个系统，您可以抽象出您想要做什么的规范，然后生成模式/查询等。我有一个项目，我正在通过 C 预处理器构建 SQL 代码。

*除非您喜欢*使用高度抽象的代码，否则我不会推荐上述任何一种。它往往充当一个长杠杆，你在短端非常努力地推动它，移动它一点点，就会发生巨大的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T05:08:24.920

如果您下载并使用 VisioModeler 来捕获您的概念和/或逻辑设计，它非常适合为多个 RDBMS 提供等效物理设计的 DDL。

[http://www.microsoft.com/downloads/details.aspx?familyId=27fe6786-a439-4286-b8b6-7a9b84cfa709&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyId=27fe6786-a439-4286-b8b6-7a9b84cfa709&displaylang=en)

或者有许多其他 ERD 类型的工具可以完成大致相同的事情。你可以试试 DBDesigner。

[http://www.fabforce.net/downloads.php](http://www.fabforce.net/downloads.php)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T18:28:17.223

在使用旨在使用多个后端的数据库时，我遇到了几个问题。

首先是数据类型不同，处理数据的方式也不同。在处理日期和大量文本时，这往往特别棘手。

我注意到的下一件事是，因为他们尝试使用 ANSII 标准 SQL，所以当数据库不完全支持该标准时会出现问题。更大的问题是标准通常不是从特定数据库获取数据的最有效方式。当您在表中获得大量记录时，我曾经使用过的每个提供多个后端的商业数据库都非常缓慢。ANSII 标准也没有提供解决更复杂问题的好方法，因此您最终会遇到复杂的解决方法。

另一种方法是使用存储过程并为您支持的每个数据库后端编写一个，但跨数据库使用相同的名称。通过这种方式，您可以利用可用于每个数据库和不同数据库结构的性能调整，而无需更改用户界面，但维护起来要困难得多，因为必须为每个数据库编写每个更改。但是，对于您的用户而言，它可能会比您的竞争对手快得多，因此您可以更改产品的溢价。您将需要收取额外费用，因为需要额外的维护成本和额外的数据库专家来调整每种类型的数据库的性能（mysql 专家可能不知道如何最好地调整 SQL Server 数据库反之亦然）

要考虑的另一种方法是您托管数据并且用户从 Web 访问它。然后你只需要设计和支持你选择的一个数据库。您将需要一大堆服务器和网络以及 dba 人员来执行此操作，因为您需要为每个客户端维持基本 24 小时的正常运行时间，并且他们可能要求您将他们的数据存储在不包含来自竞争对手的任何数据的服务器上。不了解您正在为其开发软件的业务，很难说这是否是一个可行的选择。

最便宜的路线是需要一个特定的后端。不过，您可能会失去不想购买不同后端的潜在客户。如果你这样做，我会调查潜在客户以找到他们现在使用的数据库，这可能是事实上的行业标准，如果要求它作为后端，你会失去很少的潜在客户。此外，如果您可以宣传产品比竞争对手快得多，因为您有一个标准的后端，那么您无论如何都可以说服他们。但如果你走这条路，你最好设计一个速度极快的数据库。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-13T14:33:16.833

设计一个特定于 SQL 但独立于 SQL 方言的逻辑数据库。设计应包括表、列、域和约束。约束包括但不限于主键约束和外键约束。

域规范将很难用不偏爱一种 SQL 方言的术语来定义。

为每个后端创建符合逻辑设计的物理设计，并使用特定后端的功能。

在应用程序中，尽可能使用最低公分母 SQL，而不会对性能或代码灵活性造成太大的损失。如有必要，在后端特定方法中编码。将这些后端依赖项隐藏在几个对象中。使大多数应用程序 DBMS 不可知。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-02T13:53:34.273

Datanamic 的 DeZign for Databases 支持独立于数据库的建模。************