# StackOverflow 问答 10807000-10807999

# google-app-engine - 应用引擎上的 urllib2 错误

> ID：10807001
> 
> 赞同：1
> 
> 时间：2012-05-29T21:31:16.623
> 
> 标签：google-app-engine, urllib2, freebase, urlfetch, api-key

以下内容在本地有效，但在部署时无效：

```
import urllib
import urllib2
import simplejson as json

url = 'https://www.googleapis.com/rpc'
requests = [{
  'method': 'freebase.text.get', 
  'apiVersion': 'v1', 
  'params': {
   'id': ['en','bob_dylan']
  }
},{
  'method': 'freebase.text.get', 
  'apiVersion': 'v1', 
  'params': {
    'id': ['en','blade_runner']
  }
}]
headers = { 'Content-Type': 'application/json' }
req = urllib2.Request(url, json.dumps(requests), headers)
response = urllib2.urlopen(req)
print response.read() 
```

部署时会抛出以下错误：

```
class 'urllib2.HTTPError': HTTP Error 404: Not Found
Traceback (most recent call last):
File "/base/data/home/apps/s~34thquote/1.359254037177435492/test.py", line 38, in <module>
  response = urllib2.urlopen(req)
File "/base/python_runtime/python_dist/lib/python2.5/urllib2.py", line 124, in urlopen
  return _opener.open(url, data)
File "/base/python_runtime/python_dist/lib/python2.5/urllib2.py", line 387, in open
  response = meth(req, response)
File "/base/python_runtime/python_dist/lib/python2.5/urllib2.py", line 498, in http_response
  'http', request, response, code, msg, hdrs)
File "/base/python_runtime/python_dist/lib/python2.5/urllib2.py", line 425, in error
  return self._call_chain(*args)
File "/base/python_runtime/python_dist/lib/python2.5/urllib2.py", line 360, in _call_chain
  result = func(*args)
File "/base/python_runtime/python_dist/lib/python2.5/urllib2.py", line 506, in http_error_default
  raise HTTPError(req.get_full_url(), code, msg, hdrs, fp) 
```

它可能与这个问题有关：[部署到 appengine 时的 freebase api 错误：DownloadError: ApplicationError: 2](https://stackoverflow.com/questions/10800245/freebase-api-error-on-deployment-to-appengine-downloaderror-applicationerror)在这种情况下，向请求中添加 api 密钥可以修复它。虽然我尝试添加密钥（使用 urlfetch）导致错误：

```
{u'code': 100, u'message': u'Invalid API Key (Key not found)', u'stat': u'fail'}. 
```

我注册了 freebase 服务并将浏览器应用程序的简单 API 密钥添加到查询中：'&key=apikeystringhere'。我已将关键问题添加为单独的问题：[Setup api key for freebase queries from appengine](https://stackoverflow.com/questions/10807184/setup-api-key-for-freebase-queries-from-appengine)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:50:21.807

为什么不使用 urlfetch API 而不是 urllib2？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T13:15:58.560

我现在可以工作了。它在遥控器上不起作用，因为我需要一把钥匙。我之前尝试添加密钥的尝试失败了，因为我在应该使用时使用了已弃用的[http://api.freebase.com](http://api.freebase.com) API：[https ://www.googleapis.com/freebase/v1/search?q=bob&key =](https://www.googleapis.com/freebase/v1/search?q=bob&key=)

# linux - 当 ppp0 拨号时保护 /etc/resolv.conf 不被覆盖

> ID：10807003
> 
> 赞同：1
> 
> 时间：2012-05-29T21:31:30.743
> 
> 标签：linux, dhcp, ppp, dial-up

我有一个运行busybox发行版的嵌入式系统，由于某种原因，我似乎找不到我的dhclient.conf（[http://www.freebsd.org/cgi/man.cgi?query=dhclient.conf&sektion=5](http://www.freebsd.org/cgi/man.cgi?query=dhclient.conf&sektion=5)）会让我“保护”resolv.conf wt，但 DHCP 仍然有效，这怎么可能？此外，还有另一种方法来保护 resolv.conf 中的名称服务器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T21:32:38.477

```
chattr +i /etc/resolv.conf 
```

会帮助你 ;）

这将转换特殊属性来保护文件以供删除或修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:40:38.057

创建此文件的权限。

chmod 0644 /etc/resolv.conf。

所有者可以读写。6组可以阅读。4 其他人可以阅读。4

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T18:35:06.260

建立拨号后，将我的名称服务器回显到 /etc/resolv.conf 中......

# actionscript-3 - As3 奇怪的 If 语句求值行为

> ID：10807004
> 
> 赞同：0
> 
> 时间：2012-05-29T21:31:39.657
> 
> 标签：actionscript-3

我正在写一个小游戏来获得一点乐趣。这是一个简单的回合制战斗游戏，有点像口袋妖怪风格的战斗，但有愚蠢/开玩笑的角色。

我在用户界面的主时间线上有一些东西，但其他一切都在外部动作脚本文件中处理。我有一个战斗类，它有一些与战斗相关的方法，如攻击等，我也有角色作为他们自己的类，它们从接口继承。

在我的用户界面中有一些按钮，当战斗开始时，我的攻击按钮上有一个事件监听器，每次都会执行以下代码：

```
public function attack(attacker:Character, defender:Character):void
    {

        var defenderHp:int;
        var attackPower:int;
        var postAttackHp:int;

        defenderHp = defender.getHP();
        attackPower = attacker.getAttack();

        if (! passiveBlock(defender))
        {
            if (! criticalStrike(attacker))
            {
                trace("defender hp trace: " + (defenderHp - attackPower));
                postAttackHp = (defenderHp - attackPower);
            }
            else
            {
                trace("defender hp trace: " + Math.floor((defenderHp - (attackPower*1.5))));
                postAttackHp = Math.floor((defenderHp - (attackPower*1.5)));
                displayText = attacker.getName() + " landed a critical strike!";
            }

            if (! postAttackHp > 0)
            {
                gameIsOver(attacker, defender);
            }
            else
            {
                defender.setHP(postAttackHp);
            }
        }
        else
        {
            displayText = defender.getName() + " blocked the attack!";
        }

    } 
```

代码每次都被按钮很好地调用，问题在于 if (! postAttackHp > 0) 条件。出于某种原因，只有在防守方的 HP 低于 0 时才会偶尔调用 game over 方法。我每次都在追踪 postAttackHp 变量，我每次都能看到它低于 0，但 if 语句往往会跳过到其他部分。

奇怪的是，有时它可以正常工作，有时不能正常工作，但更常见的是不工作。

这种设置方式有什么根本上愚蠢的吗？

在此先感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T21:36:37.753

我没有在这台机器上安装 Flash，否则我会尝试看看这是否是问题，但我的第一个猜测是

```
! postAttackHp > 0 
```

评估为`(! postAttackHp) > 0`。在这种情况下，只有 是 才是`postAttackHp`真的`== 0`。其他任何东西，即使是负数，都会评估为 False，因为`! -10`= False。False > 0 是 False，因为类型转换 False 会将其保留为 0。

试试看，

```
if (! (postAttackHp > 0)) 
```

或者

```
if (postAttackHp <= 0) 
```

# c# - C# 中的提取方法以在整个项目中使用

> ID：10807005
> 
> 赞同：0
> 
> 时间：2012-05-29T21:31:41.557
> 
> 标签：c#, oop, methods

原谅这里冗长的代码，我也意识到这对于任何面向对象的开发人员来说可能是一个非常基本的基本问题，但我是一名前端开发人员，深陷 .NET 并试图了解类和方法用一个实际的例子。我已经阅读了解释这些东西的资源，但立即陷入了现实世界代码的复杂性。

基本上，我有很多方法可以向网页添加评论和操作状态（标记为垃圾邮件、删除等）。其中许多方法称为“EmailNotification”方法，该方法在每个阶段向管理员发送电子邮件。它工作得很好。

但是，我想在项目的其他地方使用“EmailNotification”方法，从不同的 .cs 文件中调用它。当我尝试这样做时，它无法识别该方法，因为（我认为！？）它不是公共静态方法。

谁能向我解释如何提取 EmailNotification 方法，以便我可以在代码周围的不同位置使用它？我曾尝试在其中使用此方法创建一个新类，但我无法让它工作。

```
using System;
using System.Net.Mail;

namespace UComment.Domain
{
public class Comment
{
    public delegate void CommentCreatedEventHandler(Comment sender, EventArgs e);
    public delegate void CommentDeletedEventHandler(Comment sender, EventArgs e);
    public delegate void CommentSpamEventHandler(Comment sender, EventArgs e);
    public delegate void CommentApprovedEventHandler(Comment sender, EventArgs e);

    public static event CommentCreatedEventHandler CommentCreated;
    public static event CommentDeletedEventHandler CommentDeleted;
    public static event CommentSpamEventHandler CommentSpam;
    public static event CommentApprovedEventHandler CommentApproved;

    protected virtual void OnCommentCreated(EventArgs e)
    {
        if (CommentCreated != null) CommentCreated(this, e);
    }

    protected virtual void OnCommentSpam(EventArgs e)
    {
        if (CommentSpam != null) CommentSpam(this, e);
    }

    protected virtual void OnCommentApproved(EventArgs e)
    {
        if (CommentApproved != null) CommentApproved(this, e);
    }

    protected virtual void OnCommentDelete(EventArgs e)
    {
        if (CommentDeleted != null) CommentDeleted(this, e);
    }

    public int Id { get; set; }
    public int ParentNodeId { get; set; }
    public string Name { get; set; }
    public string Email { get; set; }
    public string Website { get; set; }
    public bool Spam { get; set; }
    public bool Approved { get; set; }
    public DateTime Created { get; set; }
    public string CommenText { get; set; }
    public int StatusId { get; set; }

    public Comment(int id)
    {
        Id = id;
        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        var reader = sqlHelper.ExecuteReader("select * from Comment where id = @id",
                                             sqlHelper.CreateParameter("@id", id));

        if(!reader.HasRecords) throw new Exception(string.Format("Comment with id {0} was not found", id));

        reader.Read();

        Name = reader.GetString("name");
        ParentNodeId = reader.GetInt("nodeid");
        Email = reader.GetString("email");
        Website = reader.GetString("website");
        Approved = reader.GetBoolean("approved");
        Spam = reader.GetBoolean("Spam");
        Created = reader.GetDateTime("created");
        CommenText = reader.GetString("comment");
        StatusId = reader.GetInt("statusid");
    }

    private Comment()
    {
    }

    /// <summary>
    /// Set as approved, mark as Not Spam - ignore HAM status
    /// </summary>
    public void MarkAsApproved()
    {
        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        sqlHelper.ExecuteNonQuery(
             "update comment set approved = 1, spam = 0, statusid = 2 where id = @id",
             sqlHelper.CreateParameter("@id", Id));

        OnCommentApproved(EventArgs.Empty);

        // Send approval email
        EmailNotification(1);

    }

    /// <summary>
    /// Remove approval status. Ignore Spam and Ham states
    /// </summary>
    public void MarkAsNotApproved()
    {
        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        sqlHelper.ExecuteNonQuery(
             "update comment set approved = 0, statusid = 3 where id = @id",
             sqlHelper.CreateParameter("@id", Id));

        OnCommentApproved(EventArgs.Empty);

        // Send rejection email
        EmailNotification(2);
    }

    /// <summary>
    /// Spam cannot be ham or approved
    /// </summary>
    public void MarkAsSpam()
    {
        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        sqlHelper.ExecuteNonQuery(
             "update comment set spam = 1, ham = 0, approved = 0, statusid = 3 where id = @id",
             sqlHelper.CreateParameter("@id", Id));

        OnCommentSpam(EventArgs.Empty);

        // No email notification required - spammer not worthy of a reason for rejection
    }

    /// <summary>
    /// Ham is "not spam" - approved comments from Akismet. 
    /// </summary>
    public void MarkAsHam()
    {
        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        sqlHelper.ExecuteNonQuery(
           "update comment set spam = 0, ham = 1 where id = @id",
           sqlHelper.CreateParameter("@id", Id));

        // No email notification required, simply marking spam as ham
    }

    public void Delete()
    {
        if (Id < 1) return;

        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        sqlHelper.ExecuteNonQuery("delete from comment where id = @id", sqlHelper.CreateParameter("@id", Id));

        Id = -1;
        OnCommentDelete(EventArgs.Empty);

        // Permanent deletion
    }

    public void Reject()
    {
        if (Id < 1) return;

        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);
        sqlHelper.ExecuteNonQuery("update comment set statusid = 3 where id = @id", sqlHelper.CreateParameter("@id", Id));

        //Id = -1;
        //OnCommentDelete(EventArgs.Empty);

        // Send rejection email
        EmailNotification(2);
    }

    public static Comment MakeNew(int parentNodeId, string name, string email, string website, bool approved, bool spam, DateTime created, string commentText, int statusId)
    {

        var c = new Comment
            {
                ParentNodeId = parentNodeId,
                Name = name,
                Email = email,
                Website = website,
                Approved = approved,
                Spam = spam,
                Created = created,
                CommenText = commentText,
                StatusId = statusId
            };

        var sqlHelper = DataLayerHelper.CreateSqlHelper(cms.GlobalSettings.DbDSN);

        c.Id = sqlHelper.ExecuteScalar<int>(
            @"insert into Comment(mainid,nodeid,name,email,website,comment,approved,spam,created,statusid) 
                values(@mainid,@nodeid,@name,@email,@website,@comment,@approved,@spam,@created,@statusid)",
            sqlHelper.CreateParameter("@mainid", -1),
            sqlHelper.CreateParameter("@nodeid", c.ParentNodeId),
            sqlHelper.CreateParameter("@name", c.Name),
            sqlHelper.CreateParameter("@email", c.Email),
            sqlHelper.CreateParameter("@website", c.Website),
            sqlHelper.CreateParameter("@comment", c.CommenText),
            sqlHelper.CreateParameter("@approved", c.Approved),
            sqlHelper.CreateParameter("@spam", c.Spam),
            sqlHelper.CreateParameter("@created", c.Created),
            sqlHelper.CreateParameter("@statusid", c.StatusId));

        c.OnCommentCreated(EventArgs.Empty);

        if (c.Spam)
        {
            c.OnCommentSpam(EventArgs.Empty);
        }

        if (c.Approved)
        {
            c.OnCommentApproved(EventArgs.Empty);
        }

        return c;
    }

    public override string ToString()
    {
        return @"ParentNodeId " + ParentNodeId + @"
        Name " + Name + @"
        Email " + Email + @"
        Website " + Website + @"
        Approved " + Approved + @"
        Spam " + Spam + @"
        Created "+ Created + @"
        CommenText " + CommenText + Environment.NewLine;
    }

    /// <summary>
    /// Send email notification
    /// </summary>
    public void EmailNotification(int notificationType)
    {

        var uCommentAdminEmail = Config.GetUCommentSetting("uCommentAdminEmail");

        MailAddress to = null;
        MailAddress from = new MailAddress(uCommentAdminEmail);
        string subject = null;
        string body = null;

        switch (notificationType)
        {
            case 1:
                // Comment approved
                to = new MailAddress("me@mydomain.com");
                subject = "Comment approved";
                body = @"The comment you posted has been approved";
                break;
            case 2:
                // Comment rejected
                to = new MailAddress("me@mydomain.com");
                subject = "Comment rejected";
                body = @"The comment you posted has been rejected";
                break;
        }

        MailMessage message = new MailMessage(from, to);
        message.Subject = subject;
        message.Body = body;
        SmtpClient client = new SmtpClient();           

        try
        {
            client.Send(message);
        }
        catch (Exception ex)
        {
            Console.WriteLine("Exception caught in EmailNotification: {0}", ex.ToString());
        }
        finally
        {
            //
        }

    }

}
} 
```

感谢大家的指点！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T21:38:14.923

你可以：

1.  将其提取到静态类的静态方法中
2.  创建一个具有实例方法的单例类
3.  为 MessageSender 创建一个类和接口，并使用 DI 在需要的地方注入它。

这取决于项目的大小：对于小型项目 1\. 可能就足够了，对于大型和复杂的（如果您有 DI）则需要 3 个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:45:31.627

你的课做的东西太多了！

将其拆分为不同的类型，每个问题都必须根据[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)解决一种类型的问题。

电子邮件发送也是如此，创建一个 EmailSender 类（或其他名称）并将 Send 方法集中在那里。

您还可以创建一个接口（例如`ISmtpClientFactory`）传递给 EmailSender 类，以抽象具体系统以发送电子邮件并改善测试体验。

只有在生产环境你真正发送邮件，在测试环境你可以使用假工厂来模拟发送。

```
public class EmailSender
{
    private readonly ISmtpClientFactory factory;

    public EmailSender(ISmtpClientFactory factory)
    {
        this.factory = factory;
    }

    public void Send(MailMessage message)
    {
        using (var client = factory.Create())
        {
            using (message)
            {
                client.Send(message);
            }
        }
    }
}

new EmailSender(new SmtpClientFactory()).Send(AdviceMessageFactory.Create(...)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T21:51:17.993

您在这里拥有的是一个公共方法，但是因为它没有被声明为静态（`public static void EmailNotification`...），所以如果不创建它所在的类的实例，就无法使用它。

```
using System;

namespace UComment.Domain
{
    public class MyOtherClass
    {
         public void MyMethod()
         {
             Comment c = new Comment();
             c.EmailNotification(1);
         }
    }
} 
```

您可以声明静态方法，这样您就可以像这样调用它：

```
using System;

namespace UComment.Domain
{
    public class MyOtherClass
    {
         public void MyMethod()
         {
             Comment.EmailNotification(1);
         }
    }
} 
```

如果您尝试从不同的命名空间使用它，那么您需要通过 using 语句或通过指定完整的内联命名空间来包含命名空间。

```
using System;
using UComment.Domain;

namespace UComment.OtherNamespace
{
    public class MyOtherClass
    {
         public void MyMethod()
         {
             Comment c = new Comment();
             c.EmailNotification(1);
         }
    }
} 
```

或者

```
using System;

namespace UComment.OtherNamespace
{
    public class MyOtherClass
    {
         public void MyMethod()
         {
             UComment.Domain.Comment c = new UComment.Domain.Comment();
             c.EmailNotification(1);
         }
    }
} 
```

你的想法是正确的，如果你想让它成为一个通用方法，它应该独立于 Comment 类。我刚才描述的相同限制也适用于这样做。此外，您必须确保任何适当的 using 语句都在新类上，并且 EmailNotification 中的依赖关系也被考虑在内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T21:38:56.530

您可以将它放在它自己的类中（就像您已经尝试过的那样）并使方法静态。

如果这个新类是 EmailHelper，您可以像这样调用该方法：

```
EmailHelper.EmailNotification(1); 
```

根据新类的命名空间，您可能还需要在使用它的每个文件的顶部添加一条 using 语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T21:39:59.367

如果您创建一个（公共）类并在其中包含该方法，它看起来不会引起任何问题。该方法应该接受发送电子邮件所需的所有属性。您可以创建该类的实例并调用该方法。

# asp.net-mvc - asp.net mvc 如何在渲染前启动对象验证

> ID：10807007
> 
> 赞同：0
> 
> 时间：2012-05-29T21:31:44.023
> 
> 标签：asp.net-mvc, validation, modelstate

我使用 ASP.NET MVC 2 和 Visual Studio 2008，我的视图是强类型的。使用`ValidationAnnotation`工作的验证。
我试图找到的是如何在打开表单时启动验证。当它打开模型有错误，但错误没有出现。当我按下提交按钮时，控制器验证模型并返回表单。

```
Public Function EditVente(ByVal pNoEnreg As Integer) As ActionResult
            Dim dossierVente As VenteDansMedianePlus = model.Helper.selectDossierVente(pNoEnreg)

        Return View(dossierVente)
    End Function

    Public Function enregistrerVente(ByVal pVente As VenteDansMedianePlus) As ActionResult
        If ModelState.IsValid Then
            model.Helper.updateDossierVente(pVente)
            Return RedirectToAction("EditVente", "A009P003", New With {Key .pNoEnreg = pVente.noEnreg})
        Else
            Return View("EditVente", pVente)
        End If

    End Function 
```

我尝试`ModelState.IsValid`输入该`editVente`功能，但它不起作用。

我的问题是如何在返回视图之前启动模型验证，所以视图有错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:57:03.567

我认为您正在寻找 TryUpdateModel 方法。您可以在控制器上调用此方法并传入您的模型：（对不起，我是 C# 开发人员，希望这是正确的）

```
Public Function EditVente(ByVal pNoEnreg As Integer) As ActionResult
     Dim dossierVente As VenteDansMedianePlus = model.Helper.selectDossierVente(pNoEnreg)

     'Update the validation
     TryUpdateModel(dossierVente)

     Return View(dossierVente)
End Function 
```

有关更多信息，请查看此 SO 帖子：[您何时以及为什么在 asp.net mvc 2 中使用 TryUpdateModel？](https://stackoverflow.com/questions/5268421/when-and-why-do-you-use-tryupdatemodel-in-asp-net-mvc-2)

**编辑**

TryUpdateModel 方法的工作原理与 UpdateModel 方法大致相同，只是 UpdateModel 在验证失败时会抛出错误，而 TryUpdateModel 则不会。

# ruby-on-rails - Redis-objects 按我的模型上的列计算模型实例的数量

> ID：10807014
> 
> 赞同：1
> 
> 时间：2012-05-29T21:32:15.580
> 
> 标签：ruby-on-rails, ruby, redis, redis-objects

我试图了解如何使用 Redis-Objects gem。

我的目标是计算`Purchase`模型实例的数量`customer_id`。例如，客户加载一个页面，我想查看该客户的购买次数。需要明确的是，购买模型有一`customer_id`列。由于点击量大，我想用redis来缓解我的服务器压力。

是否有人使用[set](https://github.com/nateware/redis-objects#sets)来完成这项任务？如何使用[redis-objects](https://github.com/nateware/redis-objects) gem 来完成这项任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T02:56:57.967

使用 Redis 时，最好根据您的访问模式对数据进行建模。换句话说，对您的数据进行反规范化。

这是我要做的：

1.  `Customer``Purchase`对象存储在哈希中。
2.  客户哈希应该有一个字段 total_purchases
3.  每次客户购买东西时，使用[HINCRBY](http://redis.io/commands/hincrby)增加 total_purchases 字段
4.  在页面加载时，只需读取 total_purchases 的值

# zend-framework - 如何在子表单中对错误进行分组？

> ID：10807015
> 
> 赞同：1
> 
> 时间：2012-05-29T21:32:17.713
> 
> 标签：zend-framework, zend-form

是否可以在其子表单中出现表单组错误，以便子表单中元素的所有错误都显示在子表单下？目前，我可以通过将`FormErrors`装饰器添加到主表单来为整个表单执行此操作。我已经尝试过这两种方法的子表单，`setSubFormDecorators`但`setDecorators`没有运气。

这不起作用：

```
$this->setSubFormDecorators(array('ViewHelper','FormErrors')); 
```

有任何想法吗？

# c# - 使用数据库信息配置 Unity 容器

> ID：10807023
> 
> 赞同：2
> 
> 时间：2012-05-29T21:33:21.477
> 
> 标签：c#, .net, unity-container, dependency-management

通常，Unity（DIC）使用标准的 XML 配置文件进行配置，例如 web.config。

出于该项目的目的，Unity 提供了我喜欢使用的强大功能。但是，由于其他客户可能想要使用它，并且并非所有人都希望使用 XML 配置文件，因此希望能够创建适配器，以便客户可以通过这种方式加载他/她自己的配置（ s) 他想要它。

因此，根据需要，从 txt、自定义 xml 文件、标准 web.config 文件，或者更重要的是，从他们定义的数据库模式加载配置。这样容器的所有映射都在这些方式中的任何一种上。

我在想什么是最好的方法来做到这一点。可能最终会以自定义方式进行。

与 Unity 竞争的意见或其他工具允许这样做吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:55:02.830

Unity API 让您可以在配置文件中执行所有操作。实际上，配置文件加载器只是简单地读取指令并调用相应的 API。

我的第一个建议是考虑使用 API 而不是配置文件来配置容器。其次，如果您确实想从其他地方加载配置，那么只需为您想要的任何格式编写一个阅读器，并根据您加载的内容调用容器 API。

“盒子”中没有任何东西可以从其他来源读取配置，但它很容易编写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T00:30:54.837

一种方法是使用反射将作为字符串存储在数据库中的类型名称转换为`type`实例。然后可以在应用程序启动时通过以编程方式将类型映射加载到容器中来配置 Unity。

我目前没有打开 VS，但我认为语法类似于：

```
var mapFrom = typeof(IMyInterface);
var mapTo = Type.GetType("My.App.MyType"); // load the string from the DB
var container = new UnityContainer();
container.RegisterType(mapFrom, mapTo); 
```

* * *

您可能还想查看[Microsoft MEF](http://mef.codeplex.com/)。它并没有*完全按照*您所说的那样做，但它更多地围绕插件架构设计，并且能够将不同的 .dll 拖放到文件夹中并让应用程序自动使用它们。

# jquery - 您可以针对特定的模态元素（例如 Colobox）进行事件吗？

> ID：10807025
> 
> 赞同：0
> 
> 时间：2012-05-29T21:33:25.143
> 
> 标签：jquery, events, callback, colorbox

在 colorbox 中，您可以在触发“关闭”事件时触发事件，例如警告消息或其他操作。例如：

```
var originalClose = $.colorbox.close;
$.colorbox.close = function(){

     var response;
     response = confirm(Are you sure you want to close this window?');
     if(!response){
    return;
     }
     originalClose();
}; 
```

但是，此代码的唯一问题是它适用于打开的任何颜色框窗口。我曾尝试使用 jquery 选择器（$("#elementID") 或 $(".colorboxWindow")），但似乎 .colorbox.close 事件会覆盖/忽略任何选择器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:43:25.530

只需添加另一个 if/else 以查看您是否应该使用此方法或原始方法。或者使用 onOpen/onClosed 回调来设置和重置特定元素组的关闭方法。

# python - Tkinter 意外行为

> ID：10807027
> 
> 赞同：0
> 
> 时间：2012-05-29T21:33:39.523
> 
> 标签：python, tkinter

我的程序中有一组使用 Tkinter 的方法，它们的行为不像我想象的那样。我希望能够在窗口中按下按钮并显示更多文本字段，并能够在文本字段中返回结果列表。这是我所拥有的：

```
def expandChoice(self):
    root = Tk()

    choices = []

    plusButton = Button (root, text='+', command=self.addChoice(root, choices)) 
    plusButton.pack()

    quitButton = Button (root, text='Ok', command=root.destroy ) 
    quitButton.pack()

    root.mainloop()

    return choices

def addChoice(self, parent, variables):

    variables.append(StringVar())

    text = Entry(parent, textvariable=variables[len(variables)-1])
    text.pack() 
```

发生的情况是，当窗口加载时（在按钮上方）出现一个文本字段，而加号按钮什么也不做。我究竟做错了什么？似乎 addChoice 方法在调用第一个按钮的构造函数时自动调用，然后就不起作用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:55:46.293

该`command`选项引用可调用对象。但是，您会`addChoice`立即调用，然后将返回的内容（无）分配给该`command`选项。

你需要做类似的事情`Button(...command=self.addChoice)`

如果您需要传递参数，则需要使用 lambda 或`functools.partial`. 在此站点上搜索其中任何一个-在 SO 上已多次询问并回答了此问题的变体。

# c - CryptoApi：导出没有私钥的证书？

> ID：10807029
> 
> 赞同：2
> 
> 时间：2012-05-29T21:33:47.583
> 
> 标签：c, security, winapi, rsa, cryptoapi

我已经使用该`CertCreateSelfSignCertificate`函数生成了一个自签名证书。这会产生一个 PCCERT_CONTEXT。

如何仅使用公钥导出存储在 PCCERT_CONTEXT 变量中的证书？我想这样做，将其发送给网络中的其他方，以便它们能够使用公钥加密消息。

我认为这是一个直接的选择，但事实并非如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T04:23:47.983

不需要 pfx。

证书存在于结构**CERT_CONTEXT 中**：只需保存成员**pbCertEncoded**指向的缓冲区的内容，其长度是成员**cbCertEncoded**的值。

此外，该证书的公钥直接存在于**CERT_CONTEXT**结构中：**pCertInfo->SubjectPublicKeyInfo**。例如，您可以使用**CryptImportPublicKeyInfo**导入它，然后调用**CryptEncrypt**来加密数据。

有了这两个选项，您就拥有了开始加密消息所需的一切。当然，必须妥善保管私钥才能解密加密数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:42:44.487

看起来您需要首先[将](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376009%28v=vs.85%29.aspx)证书放入证书存储区，然后使用[PFXExportCertStoreEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387313%28v=vs.85%29.aspx)将其导出，并通过 dwFlags 为 0（即不设置 EXPORT_PRIVATE_KEYS）。

PS 在处理加密库时，没有什么是直截了当的，无论是 CryptAPI、JSSE、OpenSSL ......它总是一场噩梦。

# mediaelement.js - 使用 MediaElementJS 播放器播放 RTSP 音频流

> ID：10807030
> 
> 赞同：3
> 
> 时间：2012-05-29T21:33:56.293
> 
> 标签：mediaelement.js

我想使用“MediaElementJS”播放器（mediaelementjs.com）播放“RTSP 音频流”。我尝试使用 RTSP url 更新 TAG，但它没有成功播放音频。

然后我尝试在 VLC Player 中使用相同的 RTSP 流，它在那里工作。还想让您知道 VLC 将流显示为“MPEG AAC Audio (mp4a)”。

我在 Firefox、IE 9.0、Chrome 18 上尝试了代码。我知道浏览器只支持特定类型的音频格式，所以我尝试了每个浏览器上的所有组合。请参阅下面我使用的代码（查看“类型”属性）。

```
<h2>wma</h2>
<audio id="player2" src="rtsp://xx.xxxx.xxxx/D/445/117988/v0001/reflector:44444" type="audio/wma" controls="controls">      
</audio>    

<h2>m4a</h2>
<audio id="player2" src="rtsp://xx.xxxx.xxxx/D/445/117988/v0001/reflector:44444" type="audio/mp4" controls="controls">      
</audio>    

<h2>MP3</h2>
<audio id="player2" src="rtsp://xx.xxxx.xxxx/D/445/117988/v0001/reflector:44444" type="audio/mp3" controls="controls">      
</audio>    

<h2>wav</h2>
<audio id="player2" src="rtsp://xx.xxxx.xxxx/D/445/117988/v0001/reflector:44444" type="audio/wav" controls="controls">      
</audio>    

<h2>mpeg</h2>
<audio id="player2" src="rtsp://xx.xxxx.xxxx/D/445/117988/v0001/reflector:44444" type="audio/mpeg" controls="controls">     
</audio> 
```

1) 有没有人在 MediaElementJS 播放器上成功运行 RTSP 流？如果是，请分享您使用的代码/配置？

2) 你知道我可以对我的播放器进行测试的任何示例工作 RTSP url 吗？我在网上搜索了很多，但没有一个 RTSP url 有效。

提前感谢您的所有帮助。

# visual-c++ - 使用金字塔混合从缝合图像中去除接缝？

> ID：10807032
> 
> 赞同：1
> 
> 时间：2012-05-29T21:34:10.013
> 
> 标签：visual-c++, image-processing, opencv, computer-vision

我缝合了两张图片，但它们之间有一条可见的接缝。我正在考虑使用金字塔混合来去除接缝，使用来自[这个网站](http://www.morethantechnical.com/2011/11/13/just-a-simple-laplacian-pyramid-blender-using-opencv-wcode/)的灵感。

在这个他们已经实现了他们自己的功能，他们正在输入两个图像和一个蒙版，但我只有拼接的图像。我的输入图像是什么，我的面具的长度是多少？最后一个是通过使用单应矩阵和warpPerspective来缝合的。

（我也对任何其他类型的混合持开放态度）

# java - 在 Java 中处理图像时提高性能

> ID：10807036
> 
> 赞同：3
> 
> 时间：2012-05-29T21:34:18.367
> 
> 标签：java, performance, swing, image-processing

我正在编写一个程序，其中包括一个图像文件夹（通常大约 2000 个 jpeg 图像）调整它们的大小，并将它们添加到图像时间轴中。结果如下：

![在此处输入图像描述](../Images/822e932336569cfab76a0aed0436c80e.png)

这很好用，但是我这样做的方式似乎非常低效。处理这些图像的代码如下所示：

```
public void setTimeline(Vector<String> imagePaths){

    int numberOfImages = imagePaths.size();     

    JLabel [] TotalImages = new JLabel[numberOfImages];
    setGridPanel.setLayout(new GridLayout(1, numberOfImages, 10, 0));

    Dimension image = new Dimension(96, 72);

    if (imagePaths != null){
        for(int i = 0; i <numberOfImages; i++){
            TotalImages[i] = new JLabel("");
            TotalImages[i].setPreferredSize(image);

            ImageIcon tempicon = new ImageIcon(imagePaths.elementAt(i));
            Image tempimage = tempicon.getImage();

            Image newimg = tempimage.getScaledInstance(96, 72,  java.awt.Image.SCALE_SMOOTH);
            ImageIcon newIcon = new ImageIcon(newimg);
            TotalImages[i].setIcon(newIcon);

            setGridPanel.add(TotalImages[i]);
        }
    }
} 
```

可以看出，此代码循环遍历每个图像路径，将其添加到标签并将其添加到面板 - 使用正确的输出完全按照应有的方式执行。

然而，这样做所花费的时间是巨大的。2000 张图像通常需要 5 分钟左右（取决于机器）。我想知道是否有任何方法可以通过使用不同的技术来提高这种性能？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:44:36.340

保存您的扩展实例并直接加载它们。硬盘空间便宜。这不会绕过生成拇指的初始成本，但任何后续出现都将是闪电般的速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T22:13:43.303

为了增加 mKorbel 的出色答案，我肯定会使用后台线程，例如 SwingWorker。这可能不会使程序更快，但它***看起来***会快很多，这可以使一切变得不同。就像是：

```
// use List<String> not Vector<String> so you can use Vector now, or change your 
// mind and use ArrayList later if desired
// pass dimensions and components in as parameters to be cleaner
public void setTimeLine2(List<String> imagePaths, Dimension imgSize,
     JComponent imgDisplayer) {

  if (imagePaths != null && imgSize != null && imgDisplayer != null) {

     // are you sure you want to set the layout in here?
     imgDisplayer.setLayout(new GridLayout(1, 0, 10, 0));

     // create your SwingWorker, passing in parameters that it will need
     ImageWorker imgWorker = new ImageWorker(imagePaths, imgSize,
           imgDisplayer);
     imgWorker.execute(); // then ask it to run doInBackground on a background thread
  } else {
     // TODO: throw exception
  }
}

private class ImageWorker extends SwingWorker<Void, ImageIcon> {
  private List<String> imagePaths;
  private JComponent imgDisplayer;
  private int imgWidth;
  private int imgHeight;

  public ImageWorker(List<String> imagePaths, Dimension imgSize,
        JComponent imgDisplayer) {
     this.imagePaths = imagePaths;
     this.imgDisplayer = imgDisplayer;
     imgWidth = imgSize.width;
     imgHeight = imgSize.height;
  }

  // do image creation in a background thread so as not to lock the Swing event thread
  @Override
  protected Void doInBackground() throws Exception {
     for (String imagePath : imagePaths) {
        BufferedImage bImg = ImageIO.read(new File(imagePath));
        Image scaledImg = bImg.getScaledInstance(imgWidth, imgHeight,
              Image.SCALE_SMOOTH);
        ImageIcon icon = new ImageIcon(scaledImg);
        publish(icon);
     }
     return null;
  }

  // but do all Swing manipulation on the event thread
  @Override
  protected void process(List<ImageIcon> chunks) {
     for (ImageIcon icon : chunks) {
        JLabel label = new JLabel(icon);
        imgDisplayer.add(label);
     }
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T21:47:25.620

> 获取图像文件夹

通过使用过程`tempimage.getScaledInstance(96, 72, java.awt.Image.SCALE_SMOOTH);`

*   使用，你也`JTable`可以使用减少的功能`JList`

> 2000 张图像通常需要 5 分钟左右

`Image.getScaledInstance`是简单的异步，没有保证快速和性能，那么你必须将图像的加载重定向到后台任务

*   优势图像的第一部分立即可用

*   dis_advantage 需要为用户显示加载状态，非常了解`Swing`和`Event Dispatch Thread`

我建议查看`Runnable#Thread`, 并将输出放入`DefaultTableModel`, 请注意此输出必须包装到`invokeLater`

另一种最复杂的方法是使用，但也需要非常`SwingWorker`好的知识`Java``Swing`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-29T21:39:09.580

使用瓷砖。这意味着不是对屏幕上未显示的图像进行操作，而是仅在必须在屏幕上显示图像时进行操作。

您需要保持时间线的逻辑位置以及显示的图像。当用户将光标移动到先前隐藏的位置时，您计算接下来需要显示哪些图像。如果图像尚未处理，则处理它们。这与网络浏览器用于性能的技术相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T21:39:59.067

*   您可以做的第一件事是异步添加图像，而不是尝试一次添加所有图像。像你一样循环它们，将它们添加到面板并每隔几张图像渲染一次，这样用户就不需要等待很长的初始化时间。

*   重用图像对象。会想到享元模式，并且可能将屏幕重绘限制为仅在异步加载中添加新图像的部分。

*   如果您将来可能会重新绘制相同的图像（或重新加载相同的文件夹），您可能需要考虑缓存一些图像对象，并可能将调整大小的缩略图保存到文件中（许多照片查看器会这样做并且将缩略图版本 - 和一些有用的元数据 - 存储在隐藏文件或文件夹中，以便他们下次可以更快地重新加载它们。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-29T21:44:44.073

您可以通过创建 4 个线程来使其更快，并让它们同时计算图像。我不知道虚拟机是否会将它们分布在多个 cpu 内核上。需要研究的东西，因为这会提高多核 pc 上的性能

# c# - DDD 和 C# - 限制对子实体的访问

> ID：10807040
> 
> 赞同：3
> 
> 时间：2012-05-29T21:35:06.580
> 
> 标签：c#, oop, domain-driven-design, aggregateroot

我几乎可以肯定我忽略了一些简单的事情，但它没有点击。

我有一个 Person 实体（Person 聚合的根）。我还有一个用于身份验证和授权 (Auth) 的子实体，它具有角色列表和权限列表。

我希望通过根管理对角色和权限的修改，在根上使用 AddAuthRole 等方法。

这相当简单，但是我将如何在不暴露 Auth 实体中的任何类似功能的情况下执行此操作？我不希望消费者使用孩子的参考来尝试添加和删除这些列表。

我有一种感觉，这是一些基本的 OO 概念，我应该为不知道而感到羞耻......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T09:10:19.473

限制对聚合成员的访问是 IMO 更多的惯例问题，而不是严格执行。我不相信您可以在聚合周围设置“物理”边界，它们过于严格且不必要地复杂。请参阅[.NET 中的 DDD / 聚合](https://stackoverflow.com/questions/6588792/ddd-aggregates-in-net)

我不太了解您示例中的类的设计，但是如果身份验证和授权是 Person Aggregate 的成员并且您想保护它们，请不要从外部引用它们。这只是一个基本的 DDD 约定，您团队中的每个程序员都应该关心 - 没有跨聚合引用，除了直接指向聚合根的引用。

如果您使用不可变值对象，则对域对象的访问限制和保护的需求也将大大减少。角色和权限通常可以是这样的值对象，允许您将它们公开给世界，而不会有外部对象摆弄它们的状态和修改它们的风险。因为这就是聚合首先要做的：将某些实体的所有操作规则收集在一个地方，以防止任何人摆弄这些实体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T09:23:52.637

如果您通过更严格的界面（IEnumerable）公开您的列表，您将能够控制您的聚合用户如何访问它们。您通过 IEnumerable 公开的列表与根目录上的添加/删除方法相结合，应该可以为您提供我解释过的您想要的内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T22:01:43.237

暴露的方法应该受到保护所有其他的应该是私有的

# ruby-on-rails - 提高地图命令的效率？

> ID：10807042
> 
> 赞同：1
> 
> 时间：2012-05-29T21:35:31.903
> 
> 标签：ruby-on-rails, ruby, performance, inventory, foreach

我的 rails 程序中有 4 个数据库，产品、产品、产品和订单

样品供应：中型套件

中型套件包含 2 种产品（在 OfferingProduct db 中设置） 1 小 2 中

客户订购 2 个中号套件

该程序应占该订单的 2 个小型和 4 个中型以及许多类似的订单

我正在尝试建立一个库存系统来跟踪每周售出的每种产品的数量，以便我可以重新订购产品。为了计算这个，我有：

```
def get_trend
  product = Product.first
  customer_orders =[]
  product.offerings.each do |o|
    customer_orders = customer_orders + o.orders
  end
  o=customer_orders.group_by { |t| t.date.beginning_of_week }
  y = []
  op=self.offering_products;
  o.sort.each do |week, orders|
    y << orders.map { |o| o.quantity*op.find_by_offering_id(o.offering).quantity }.sum
  end
  return y
end 
```

这似乎可行，但计算大约需要 20 秒。有什么办法可以让这更快吗？我知道大部分时间都被

```
y << orders.map { |o| o.quantity*op.find_by_offering_id(o.offering).quantity }.sum 
```

计算给定一周内订购的产品数量的行。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T00:37:01.533

问题是当您最好使用声明（即数据库中的连接）时，您正在使用迭代（即应用程序代码中的循环）。循环永远不会像连接一样快，将数据集移动到应用程序的内存中也无济于事。

我猜你正在使用 ActiveRecord？如果是这样，这可能有助于如何使用连接进行查询：http: [//guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:04:13.790

多亏了 Iain 的信息，这就是我最终所做的

```
def get_trend
    sql = ActiveRecord::Base.connection()
    if Rails.env == "production"
        d=sql.execute("SELECT SUM(orders.quantity * offering_products.quantity), EXTRACT(ISOYEAR FROM orders.date) AS year, EXTRACT(WEEK FROM orders.date) AS week " +
        " FROM orders " +
        " INNER JOIN offerings ON offerings.id = orders.offering_id " + 
        " INNER JOIN offering_products ON offering_products.offering_id = offerings.id " +
        " INNER JOIN products ON products.id = offering_products.product_id " +
        " WHERE (products.id = #{self.id}) GROUP BY year, week ORDER BY year, week ")
        y=d.map { |a| a["sum"].to_i }
    else
        d=sql.execute("SELECT SUM(orders.quantity * offering_products.quantity), strftime('%G-%V', orders.date) AS year " +
        " FROM orders " +
        " INNER JOIN offerings ON offerings.id = orders.offering_id " +
        " INNER JOIN offering_products ON offering_products.offering_id = offerings.id " + 
        " INNER JOIN products ON products.id = offering_products.product_id " +
        " WHERE (products.id = #{self.id}) GROUP BY year")
        y=d.map { |a| a[0] }
    end
    return y
end 
```

更新：需要区分生产和本地代码，因为heroku使用postgresql，并且日期函数的工作方式不同:(这也意味着结果不完全相同，因为函数对一年中的第一周的处理方式不同。

# ruby-on-rails - 对当前设计用户的范围授权？

> ID：10807045
> 
> 赞同：0
> 
> 时间：2012-05-29T21:35:47.637
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我的 Rails 3.2 项目有一个设计生成的用户和一组模型，这些模型都包含特定于该用户的数据。我希望登录用户能够通过控制器公开的 API 仅访问他自己的数据。

现在，启用此功能的一种蛮力方法是更改​​每个控制器，例如：

```
def index
  @stuff = Stuff.all 
```

到

```
def index
  @stuff = Stuff.find_all_by_user_id current_user.id 
```

我必须对每个控制器的每一个动作重复这一点。是否有更简洁和干燥的方式来实现相同的效果？我必须写的样板数量感觉不对。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:54:31.713

看看[CanCan](https://github.com/ryanb/cancan)宝石。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:16:08.957

a）您可以**在 application_controller.rb 中有一个 before 回调**，看起来像

```
def find_stuff_from_current_user
  @stuff = Stuff.find_all_by_user_id current_user.id
end 
```

而不是像这样在每个控制器中调用它：

```
before_filter :find_stuff_from_current_user 
```

现在您在每个控制器和每个操作中都有可用的 @stuff 变量。

b）或者**您可以在东西 model.rb**中使用范围界定，您可以在其中说：

```
scope :stuff_from_current_user, where(:user => current_user) 
```

# cucumber - 用 Cucumber 在 html-head 中搜索 von 字符串

> ID：10807046
> 
> 赞同：1
> 
> 时间：2012-05-29T21:35:52.183
> 
> 标签：cucumber, watir, meta-tags, watir-webdriver

我想知道如何检查 HTML 文档的头部是否存在带有黄瓜的特定字符串。实际上我对特定的机器人指令感兴趣，所以我在第一步启动浏览器（atm Firefox）并打开一个本地站点。

在第二步中，我检查整个 html 代码中的字符串：

```
@b.html.include?('<meta name="robots" content="noindex, follow">').should == true 
```

并看到我的场景在第二步失败。（预期为真，结果为假）令人惊讶的是，对部分字符串的检查成功了：

```
@b.html.include?('name="robots"').should == true 
```

但是一旦我检查

```
@b.html.include?('<meta name="robots"').should == true 
```

要不就

```
@b.html.include?('a name="robots"').should == true 
```

我又弄错了。

所以，我认为空格的存在会导致这种行为。快速检查，只有一个额外的空格

```
@b.html.include?(' name="robots"').should == true 
```

并且测试场景是绿色的。

在文档正文中搜索整个句子

```
@b.html.include?('<h1>Yarr, that "is" supeb!</h1>').should == true 
```

也是路过。

我还尝试将 h1 标题移动到文档的头部（测试仍然通过）并将元标记移动到正文（测试仍然失败）

我正在使用 cucumber 1.2.0 和 ruby​​ 1.9.3p0 以及通过 watir-webdriver 驱动的 Firefox，并且想知道我是否做错了什么。实际上，我只有一个带有这个简单步骤的功能和一个带有元数据和这个“Yarr”句子的最小 html 站点。没有导轨，没有耙子。OS X 10.7 请告诉我是否应该提供更多信息……我正在修补这些东西几个小时。

**Edit1**：添加了我检查的站点的 HTML。

```
<!DOCTYPE html>
<html>
<head>
    <title>Home</title>
    <meta charset="utf-8">
    <link rel="stylesheet" media="screen" href="/public/stylesheets/main.css">
    <link rel="shortcut icon" type="image/png" href="/public/images/favicon.png">
    <script src="/public/javascripts/jquery-1.6.4.min.js" type="text/javascript" charset="utf-8"></script>
    <link rel="canonical" href="google.de">
    <meta name="robots" content="noindex, follow">
  </head>
<body>
    <h1>Yarr, that "ist" superb!</h1>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:58:08.657

**问题：**

似乎 HTML 标记的属性并不总是按照它们编写的顺序排列。看到这个：

```
puts @b.html
#=> <!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <title>Home</title>
    <meta charset="utf-8" />
    <link href="/public/stylesheets/main.css" media="screen" rel="stylesheet" />
    <link href="/public/images/favicon.png" type="image/png" rel="shortcut icon" />
    <script charset="utf-8" type="text/javascript" src="/public/javascripts/jquery-1.6.4.min.js"></script>
    <link href="google.de" rel="canonical" />
    <meta content="noindex, follow" name="robots" />
  </head>
<body>
    <h1>Yarr, that "ist" superb!</h1>

</body></html> 
```

请注意，这`<meta content="noindex, follow" name="robots" />`与您的 HTML 文件的顺序不同。这解释了为什么您的测试给出了它们的结果。

**建议解决方案：**

假设您只关心特定的元标记出现在标题中（而不是标记的特定顺序），我建议使用：

```
b.head.meta(:name => 'robots', :content => 'noindex, follow').exists?.should == true 
```

# ruby-on-rails-3 - ActionController::RoutingError fontawesome

> ID：10807047
> 
> 赞同：4
> 
> 时间：2012-05-29T21:36:06.257
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, font-awesome

```
Completed 200 OK in 7905ms (Views: 7560.5ms | ActiveRecord: 3.1ms | Solr: 0.0ms)

Started GET "/font/fontawesome-webfont.woff" for 127.0.0.1 at 2012-05-29 22:18:49 +0100

ActionController::RoutingError (No route matches [GET] "/font/fontawesome-webfont.woff"):

Rendered /Users/bet/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.1ms)

Started GET "/font/fontawesome-webfont.ttf" for 127.0.0.1 at 2012-05-29 22:18:50 +0100

ActionController::RoutingError (No route matches [GET] "/font/fontawesome-webfont.ttf"):

Rendered /Users/bet/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.0ms)

Started GET "/font/fontawesome-webfont.svgz" for 127.0.0.1 at 2012-05-29 22:18:50 +0100

ActionController::RoutingError (No route matches [GET] "/font/fontawesome-webfont.svgz"):

Rendered /Users/bet/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.1ms)

Started GET "/font/fontawesome-webfont.svg" for 127.0.0.1 at 2012-05-29 22:18:50 +0100

ActionController::RoutingError (No route matches [GET] "/font/fontawesome-webfont.svg"):

Rendered /Users/bet/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.1.3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.0ms) 
```

# c# - 分段错误：11

> ID：10807059
> 
> 赞同：1
> 
> 时间：2012-05-29T21:37:44.737
> 
> 标签：c#, recursion, segmentation-fault

我正在使用以下代码完成一个非常简单的[编程练习：](http://www.spoj.pl/problems/FCTRL/)

```
 using System;

    namespace Factorial

{
    class MainClass
    {

        static int fives(int x) {

            int r = 0;
            while(x % 5 == 0) {
                r++;
                x /= 5;
            }
            return r;

        }

        static int z(int x) {

            if (x == 1)
                return 0;
            else
                return z (x-1) + fives (x);

        }

        public static void Main (string[] args)
        {
            int testCases = Convert.ToInt32 (Console.ReadLine ());
            int[] xs = new int[testCases];
            for (int i=0; i<testCases; i++)
                xs [i] = Convert.ToInt32 (Console.ReadLine ());
            foreach (int x in xs)
                Console.WriteLine (z (x));
        }
    }
} 
```

小数字似乎可以正常工作，但是示例中的 8735373 会打印“分段错误：11”。这是否意味着由于递归太深而导致内存不足？是什么原因造成的？

（我在 Mac 上的 Mono 2.10.8 中运行 C#。）

PS：如果有人对 excersize 本身感兴趣，[这是我的最终解决方案](http://pastebin.com/7NHQijqx)（更加优化）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:48:25.777

这看起来像一个未处理的`StackOverflowException`- 在过度使用递归时很常见。所以......*不要过度使用递归*。它可能适用于数学和一些非常特定的语言（F# 可能会应付），但 C# ......不是那么多。

看起来像（未验证）：

```
 static int z(int x)
    {
        int accumulator = 0;
        while(x!=1)
        {
            accumulator += fives(x);
            x--;
        }
        return accumulator;
    } 
```

这不会出错 - 它不会递归（尽管`fives`每次迭代都会调用）。更好的是：做代数找到直接公式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:55:40.587

当您使用较大的数字时，您的递归步骤会导致 StackOverflowException 并且如果您查看调试器，您将看到发生了多少递归步骤后异常发生。

我认为 Mono 代码以某种方式考虑了 Segmentaiton 故障的 stackoverflow 异常，这可能是它的处理方式。

![在此处输入图像描述](../Images/63b22e1f02f725ea35016ad5acd69a04.png)

如果您愿意，您可以调试它： [如何在没有任何调试器的情况下在 Ubuntu 上调试 Mono 中的分段错误？](https://stackoverflow.com/questions/10320450/how-do-i-debug-a-segmentation-fault-in-mono-on-ubuntu-without-any-debugger)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:51:37.117

从递归到循环的简单转换似乎解决了这个问题：

```
 static int z (int x)
    {
        int result = 0;
        for (int i=1; i<=x; i++) {
            result += fives (i);
        }
        return result;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T22:00:04.907

如果问题是由大量递归引起的，则错误可能是 StackOverflowException。正如前面所说的 golergka，我很确定这是 Mono 故障。当试图到达不应到达的内存地址而对内存管理不善时，就会出现分段错误。这种类型的错误是系统错误......不是 C# 异常。我几乎可以肯定 Mono 不能很好地管理大量的内存。我希望这对你的研究有所帮助。

# javascript - 强制 div 填充浏览器宽度

> ID：10807063
> 
> 赞同：2
> 
> 时间：2012-05-29T21:37:53.473
> 
> 标签：javascript, html, css

我有一个小的 js 文件，它在页面顶部添加了一个栏。该文件可以包含在各种网站设计中。任何将正文边距/填充设置为 0 的页面，该栏都可以正常显示。但是，如果页面有左或右填充，则栏将不会拉伸整个宽度。

问题是我不想操纵页面正文样式，因为设计可能有原因。所以我的问题是：

如何在不操纵主体填充/边距的情况下强制 div 填充浏览器的宽度？

我已经搜索了一段时间，答案都说要设置正文填充/边距。

谢谢

编辑：

我不能为此依赖 jquery。目前使用纯 javascript 为栏添加 html。doc = dochtml+' html 字符串.... '+dochtml...

编辑2：

我正在编写所有样式和 HTML。不链接到任何外部文件。就像 CSS 重置一样，这会给其余元素带来问题。这个栏是人们将包含在他们的网站中的东西，我不能搞乱他们的设计。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T21:53:03.857

在开始`<body>`标签之后，您需要添加一个`<div>`标签。div 的样式应该类似于

```
div {
    position:absolute;
    top:0px;
    left:0;
    width:100%
    height: 20px;
} 
```

div 应该始终是浏览器的宽度。如果您需要为其添加一些填充，则需要在包含的 div 中添加另一个 div，否则填充会使宽度超过 100%。您还需要为正文添加边距，以确保浮动 div 不会与正文内容重叠。我希望这是有道理的！

[这是一个例子](http://jsfiddle.net/rZKrL/show/)

# javascript - 除了这个，这个类还有什么简洁的选择器吗？

> ID：10807066
> 
> 赞同：0
> 
> 时间：2012-05-29T21:38:09.370
> 
> 标签：javascript, jquery, optimization, jquery-selectors

例子：

```
<div>
    <A><span class="bla">test</span></a>
    <A><span class="bla">test test</span></a>
    <A><span class="bla">test test test</span></a>
</div> 
```

只是想知道我们是否可以这样做：

```
$('span.bla').click(function(){
   $(this).addClass('selected').others_with_this_class().removeClass('selected');
}); 
```

或者我们真的需要制作两个不同的选择器，并一个一个地处理它们。

**编辑**：

谢谢大家有想法，我发现做这样的事情：:-)

```
if (!$(this).hasClass('selected'))
$(this).addClass('selected').parent().siblings('a').children('.selected').removeClass('selected'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:40:40.660

你是什​​么意思“一个一个地处理它们”？

为什么不从`.selected`项目中删除类，然后将类添加到您单击的项目中：

```
$('span.bla').click(function(){
   $('.selected').removeClass('selected');
   $(this).addClass('selected');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:40:17.897

我喜欢从所有内容中清除类，然后将其添加到单个类中：

```
$('span.bla').click( function() {
    $('span.bla').removeClass('selected');
    $(this).addClass('selected');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:40:03.207

使用[`$.siblings()`](http://api.jquery.com/siblings/)：

```
$('span.bla').click(function(){
    $(this).addClass('selected')
           .parent()
           .siblings()
           .children('span')
           .removeClass('selected');
}); 
```

这将找到 span ( ) 的父代、它的所有兄弟姐妹以及作为这些兄弟姐妹的子代的`<a>`任何s，并将其添加到它们中。`<span>``.current`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T21:40:48.680

```
$('span.bla').click(function(){
   $('span.bla').removeClass('selected');
   $(this).addClass('selected');
}); 
```

# php - 带有特殊字符的 Apache SetEnv

> ID：10807068
> 
> 赞同：1
> 
> 时间：2012-05-29T21:38:15.047
> 
> 标签：php, apache, url, setenv

我正在尝试在我的 vhosts.conf 文件中使用 SetEnv 在 Apache 中设置环境变量，其中包含以下内容：

```
SetEnv FACEBOOK_SECRET 13jf93jjdshut7qpm321b1vv5nod973j10
SetEnv DATABASE_URL "postgresql://postgres:sdfesf@localhost:5432/public" 
```

FACEBOOK_SECRET 环境使用 genenv() 函数显示在 php 中，但 DATABASE_URL 为空。我假设这是由于连接字符串中的特殊字符，但我不知道是否或如何转义这些字符。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:40:48.840

将要设置的值放在引号中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-26T05:00:34.633

尝试替换`localhost`为`127.0.0.1`apache 不喜欢虚拟主机配置块中的 localhost 关键字。

```
SetEnv DATABASE_URL "postgresql://postgres:sdfesf@127.0.0.1:5432/public" 
```

# jquery - 使用 jquery 验证文本框值服务器端

> ID：10807071
> 
> 赞同：1
> 
> 时间：2012-05-29T21:38:32.147
> 
> 标签：jquery, struts2

当用户在模糊的文本框中输入一个值时，我有订单列表我想在服务器端验证该值，然后根据服务器的真假显示正确或错误的图标。我正在使用struts2，jquery。

我在ajax方面很差，所以请帮助我尽可能详细地回答

提前致谢。

**更新**感谢您的回复，我已经尝试过[Fluidbyte](https://stackoverflow.com/users/957500/fluidbyte)解决方案，但作为回应，我得到了整个 html。我在不同地方的条目如下。

struts.xml

```
<action name="validate" class="orders" method="validate"/> 
```

jsp

```
<td><s:textfield name="serial" id="serial" theme="simple"/></td>
<td><SPAN id="result"></SPAN> </td> 
```

动作类

```
public String validate() {
result = myOrdSvc.validate(value);
return SUCCESS;
}

/**
 * @param result
 *            the result to set
 */
public void setResult(String result) {
    this.result = result;
}

/**
 * @return the result
 */
public String getResult() {
    return result;
} 
```

订单.js

```
 $('#serial').blur(function(){
            $.post('validate',{ value: $(this).val() },function(data){
               $("#result").html(data);
            });
        }); 
```

结果**“数据”**完全是一个html，而不仅仅是我返回的**“真”**或**“假” 。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:41:15.200

从服务器端获得响应非常容易：

```
$('input').blur(function(){
    $.post('path/to/file.ext',{ value: $(this).val() },function(data){
       // 'data' is whatever the server returns...
    });
}); 
```

在服务器端，您将获得一个名为“值”的 POST，然后您可以对其进行评估。

回调函数返回“数据”，其中包含您的脚本返回的任何内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:42:14.827

调用`jQuery ajax`服务器页面并让服务器给出响应并基于该响应显示相关图像

```
$(function(){

  $("#txtUserName").keyup(function(){
    $.get("someserverpage.php?key="+$(this).val(),function(data){
      //check value in data variable and do whatever you want to do (show hide image)
    });

  });    

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T21:44:57.017

除了[Fluidbyte](https://stackoverflow.com/users/957500/fluidbyte)解决方案之外，Action 类的变化是，

**再次感谢[Fluidbyte](https://stackoverflow.com/users/957500/fluidbyte)**。

1) 将返回类型更改为 void

2）使用[PrintWriter](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html)将结果写入jsp。

```
public void validate() {
   result = myOrdSvc.validate(value);
   PrintWriter writer = ServletActionContext.getResponse().getWriter();
   writer.write(result);
} 
```

# python - 使用 Python 替换或交换文件中的子字符串

> ID：10807072
> 
> 赞同：2
> 
> 时间：2012-05-29T21:38:40.753
> 
> 标签：python, regex, string

假设我在以下形式的 ASCII 文件中有一行：

```
{text1} {stringA} {text2} {stringB} {text3} 
```

where`{stringA}`和`{stringB}`是感兴趣的子串。我们分别称它们为“A”和“B”。字符串`{text1}`、`{text2}`和`{text3}`是不包含 A 或 B 的任意长度（可能为空）的字符串。

我想在 Python 中做的只是交换 A 和 B 使得该行从

```
{text1} {stringA} {text2} {stringB} {text3} 
```

到

```
{text1} {stringB} {text2} {stringA} {text3} 
```

我很感激这里的任何帮助。我认为通过在这个问题上获得帮助，它将帮助我学习更好地使用 Python 中的正则表达式。

**请注意`{text1}`，`{text2}`, 和`{text3}`是未知字符串。**

我们确切地知道子串 A 和 B。我们知道 A 在该行中位于 B 之前。但是，我们不知道它们之前/之间/之后是什么（如果有的话）。

**示例（A=约翰，B=蒂姆）：**

(1) 这个：

“我告诉约翰把袋子给蒂姆。”

改成这样：

“我告诉蒂姆把袋子给约翰。”

(2) 这：

“约翰向蒂姆问好。”

改成这样：

“蒂姆向约翰问好。”

(3) 这个：

“约翰！h9aghagTim”

改成这样：

“蒂姆！h9aghagJohn”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T21:43:26.917

```
>>> import re
>>> text = '{text1} {stringA} {text2} {stringB} {text3}'
>>> re.sub(r'(stringA)(.*)(stringB)', r'\3\2\1', text)
'{text1} {stringB} {text2} {stringA} {text3}' 
```

将`stringA`和替换`stringB`为您感兴趣的子字符串，请注意您可能需要[`re.escape()`](http://docs.python.org/library/re.html#re.escape)它们，以防子字符串在正则表达式中具有特殊含义的字符。

测试用例：

```
>>> stringA = 'John'
>>> stringB = 'Tim'
>>> regex = re.compile(r'(%s)(.*)(%s)' % (stringA, stringB))
>>> regex.sub(r'\3\2\1', "I told John to give the bag to Tim.")
'I told Tim to give the bag to John.'
>>> regex.sub(r'\3\2\1', "John said hello to Tim.")
'Tim said hello to John.'
>>> regex.sub(r'\3\2\1', "John!h9aghagTim")
'Tim!h9aghagJohn' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:42:14.190

采用的方法是使用捕获组，以便您以后可以参考它们

```
result = re.sub(r"(\{text1\}) (\{stringA\}) (\{text2\}) (\{stringB\}) (\{text3\})", r"\1 \4 \3 \2 \5", subject) 
```

捕获组由括号 () 标识，您在 python 中通过 \x 引用它们，其中 x 是捕获组的编号

**更新 1**

您的示例使您更清楚您想要什么以及您目前对正则表达式的看法。正则表达式匹配字符模式。你想交换名字（Tom,Tim,...）所以我们需要想出一个模式来匹配一个只有通过完整枚举才有可能的名字。在我的语言中，（我认为）有数千个名字，其中一些也用于指代对象而不是人。要做出这种区分，您必须考虑正则表达式不能考虑的上下文。让我知道这是否有意义，因为如果您想更进一步，这很重要。

**更新 2**

我怀疑您的问题是出于好奇，而不是为了解决现实生活中的问题。但如果我们继续下去，这会让你走得更远，但它并不完美，也不可能

正则表达式

```
(.*)\b(John|Tim|Jo)\b(.*)\b(John|Tim|Jo)\b 
```

用。。。来代替

```
\1\4\3\2 
```

在蟒蛇

```
result = re.sub(r"(?sm)(.*)\b(John|Tim|Jo)\b(.*)\b(John|Tim|Jo)\b", r"\1\4\3\2", subject) 
```

请注意正则表达式中的 \b ，它表明匹配应该发生在单词边界处。这可以防止像 Johndoe 这样的比赛。

还要注意上面的正则表达式对于句子会失败

> Tim 从 John 那里购买了一些以 Jo 结尾的 Jordan 顶级域名

# workflow-foundation-4 - 坚持在 IIS 中托管的 NativeActivity

> ID：10807074
> 
> 赞同：0
> 
> 时间：2012-05-29T21:38:42.297
> 
> 标签：workflow-foundation-4, workflow-foundation, persist

我创建了一个本地活动，该活动使用持久性参与者提升一个或多个属性，并且下次在父工作流中使用持久性活动时，信息将持久化到数据库中。我真正想要的是在我的本机活动中添加一个 AutoPersist 属性，以便我可以选择将数据立即持久化到数据库中，但我似乎无法让它工作。

我已经看到通过调用底层工作流主机来完成它，但是当我在 IIS 中运行我的工作流时，我认为我无法访问它。当我在完成本机活动后尝试安排持久性活动时，出现无法捕获的错误（除非有人能告诉我不同​​的错误），而当我创建包含本机活动和持久性的复合活动时，我会遇到类似的结果。

有什么我想念的吗？我想我无法捕捉到的错误可能会给我更多关于我做错了什么的线索，但我会认为复合活动会起作用。我开始认为坚持只能在工作流线程中完成 - 任何人都可以确认或否认吗？

非常感谢任何帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:29:47.750

持久化只能发生在活动边界，因此您将无法从本机活动的执行方法内部安排持久化。

当你在你的原生活动之后放置一个 Persist 时，你会得到什么例外？

# android - 添加具有自定义文本颜色的列表项

> ID：10807075
> 
> 赞同：-1
> 
> 时间：2012-05-29T21:38:46.320
> 
> 标签：android, arraylist, textcolor

如果满足某个条件，我希望我的代码添加一个文本颜色为 GREEN 的列表项，否则我只希望它添加没有指定文本颜色的项目

这是我的代码：

```
 if (cursor.getString(4).equals("yes")) {
                    achievementList.add(cursor.getString(1)+" (completed)");
                }
                else {
                    achievementList.add(cursor.getString(1));
                } 
```

我尝试在 cursor.getString 以及成绩列表.add 上使用 setTextColor(Color.GREEN)，但两者都抛出错误。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:46:51.783

基本上，您应该创建自己的 ArrayAdapter 并从默认的扩展。比你应该覆盖`getView()`和创建、填充和修改那里的视图。在那里你可以设置你选择的 TextView 的文本颜色。

那里有很多很好的教程，只需搜索即可。

# c++ - 进程以状态 1 终止

> ID：10807076
> 
> 赞同：0
> 
> 时间：2012-05-29T21:38:46.637
> 
> 标签：c++, c, codeblocks

我正在处理 code::blocks 10.05，我想用 c/c++ 读取 TIFF 图像文件。为此，我使用的是 LibTiff 库，因此我将 tiffio.h 作为头文件包含在内。现在当我编译时，我收到一个错误“进程以状态 1 终止。我还提供了链接器的库的完整路径。

整个构建日志说：

链接控制台可执行文件：bin\Release\tifff.exe

mingw32-g++.exe: E:\Image: 没有那个文件或目录

mingw32-g++.exe：Transforms\Libraries\tifflib\libs\libtiff：没有这样的文件或目录

进程以状态 1 终止（0 分 8 秒）0 个错误，0 个警告

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:07:34.237

鉴于您提供的输出，正如@gcbenison 所说，链接器似乎没有找到 libtiff。

更重要的是，鉴于它显示了两行输出，我假设您的 libtiff 库位于“E:\Image Transforms\Libraries\tifflib\libs\libtiff”中，对吧？

好吧，Code::Blocks[似乎不喜欢](http://wiki.codeblocks.org/index.php?title=Debugging_with_Code%3a%3aBlocks)带空格的路径。所以尝试将“Image Transforms”重命名为“Image_Transforms”，更正 Code::Blocks 中的库路径并重试。

**编辑**：详细说明答案

另外，请确保您可以拥有已编译的 libtiff 库。我从[GNUwin32项目下载了](http://gnuwin32.sourceforge.net/packages/tiff.htm)[libtiff 3.8.2-1.exe](http://ufpr.dl.sourceforge.net/project/gnuwin32/tiff/3.8.2-1/tiff-3.8.2-1.exe)进行测试，它运行良好。尝试执行以下操作来构建使用 libtiff 的最小工作程序：

*   在 C:\GnuWin32 中安装上述 libtiff 库。安装好之后，里面会有很多目录，包括bin、contrib、doc、include、lib等等；
*   在 Code::Blocks 中新建一个**Console 应用项目；**
*   Tell Code::Blocks 它是一个 C 程序；
*   创建项目后，通过单击您的项目然后单击“构建选项...”访问“构建选项”对话框；
*   在“链接器设置”选项卡的“链接库”框架中，单击“添加”并添加 libtiff.dll.a。如果你在 C:\GnuWin32 中安装了 libtiff，你想要的库将是 C:\GnuWin32\lib\libtiff.dll.a；
*   在“搜索目录”选项卡中，您将：
    *   选择“编译器”选项卡并在其中添加“C:\GnuWin32\include”；
    *   选择“链接器”选项卡并将“C:\GnuWin32\lib”添加到其中；
*   在“构建选项”对话框中单击“确定”，因为现在一切都应该没问题了。

您现在可以尝试构建您的程序，看看构建是否成功。我使用了[使用 libtiff 进行图形编程中的第一个示例，第 2 部分](https://www.ibm.com/developerworks/linux/library/l-libtiff2/)作为测试程序：

```
#include <stdio.h>
#include <stdlib.h>
#include <tiffio.h>
int main()
{
  TIFF *output;
  uint32 width, height;
  char *raster;
  printf("Trying to write TIFF...\n");
  if((output = TIFFOpen("output.tif", "w")) == NULL){
    fprintf(stderr, "Could not open outgoing image\n");
    exit(42);
  }
  width = 42;
  height = 42;
  if((raster = (char *) malloc(sizeof(char) * width * height * 3)) == NULL){
    fprintf(stderr, "Could not allocate enough memory\n");
    exit(42);
  }
  TIFFSetField(output, TIFFTAG_IMAGEWIDTH, width);
  TIFFSetField(output, TIFFTAG_IMAGELENGTH, height);
  TIFFSetField(output, TIFFTAG_COMPRESSION, COMPRESSION_DEFLATE);
  TIFFSetField(output, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG);
  TIFFSetField(output, TIFFTAG_PHOTOMETRIC, PHOTOMETRIC_RGB);
  TIFFSetField(output, TIFFTAG_BITSPERSAMPLE, 8);
  TIFFSetField(output, TIFFTAG_SAMPLESPERPIXEL, 3);
  if(TIFFWriteEncodedStrip(output, 0, raster, width * height * 3) == 0){
    fprintf(stderr, "Could not write image\n");
    exit(42);
  }
  TIFFClose(output);
  printf("TIFF written successfully.\n");
  return 0;
} 
```

现在尝试构建 (Ctrl+F9) 并运行您的程序。我按照上面提到的步骤完成了我的程序编译和工作。

对于构建，Code::Blocks 的输出是（我将我的程序命名为 libtiff）：

```
-------------- Build: Debug in libtiff ---------------

Compiling: main.c
Linking console executable: bin\Debug\libtiff.exe
Output size is 27,93 KB
Process terminated with status 0 (0 minutes, 0 seconds)
0 errors, 0 warnings 
```

对于运行，它输出：

```
Trying to write TIFF...
TIFF written successfully.

Process returned 0 (0x0)   execution time : 0.125 s
Press any key to continue. 
```

# python - 从网页中提取数据的脚本

> ID：10807081
> 
> 赞同：9
> 
> 时间：2012-05-29T21:39:09.917
> 
> 标签：python

我希望提取网页上呈现的部分数据。我可以使用下面的代码从页面中提取整个数据并将其保存在文本文件 (RAW) 中。

```
curl http://webpage -o "raw.txt" 
```

只是想知道是否还有其他选择和优势。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T21:46:35.870

我会使用[requests](http://docs.python-requests.org/en/latest/index.html)和[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)的组合。

```
from bs4 import BeautifulSoup
import requests    

session = requests.session()    
req = session.get('http://stackoverflow.com/questions/10807081/script-to-extract-data-from-wbpage')    
doc = BeautifulSoup(req.content)    
print(doc.findAll('a', { "class" : "gp-share" })) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:50:40.620

cURL 是一个好的开始。更好的命令行将是：

```
curl -A "Mozilla/5.0" -L -k -b /tmp/c -c /tmp/c -s http://url.tld 
```

因为它使用 cookie、用户代理、SSL 证书和其他东西。

看`man curl`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:55:33.560

1.  **保存/处理单个 Web 资源：**上述方法适用于单个文件/Web 资源。您还可以根据预设模式管道正则表达式和截断/跳过数据。例如：保存所有标签源网址。

2.  **递归地保存/处理整个目录或网站：**使用 Python 或 Perl 脚本，它可以迭代地拉下属于页面或网站 dns 名称的所有链接和资源。在 Python 中，我会使用 http lib 并递归解析标签（确保有深度限制，或者对于大型网站，您最终可能会保存大量数据！）。[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)是一个简单而安全的选择——它是一个 Python 库，可以抓取 Web 数据、导航、搜索远程 Web 资源的解析树。它还可以修改解析的本地内容等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T21:46:51.643

您的示例代码将从网页中获取所有数据。如果您想解析网页并提取特定信息，我建议您使用一些现有的解析器。

我通常使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)从 html 页面中提取数据。

# iphone - 在 iOS 设备上捕获日志输出并使用移动设备框架将该文件传输到主机

> ID：10807082
> 
> 赞同：3
> 
> 时间：2012-05-29T21:39:27.677
> 
> 标签：iphone, ios, ios-ui-automation, ios5

这个问题是关于使用 iOS 进行日志记录的。

我正在使用仪器的命令行版本在 iOS 上运行应用程序。那部分工作正常。

我想知道的是如何捕获正在运行的应用程序的日志输出？也就是说，在不越狱设备的情况下做相当于 syslog 的输出？

我对应用程序进行了轻微修改，以将 stdout 和 stderr 捕获到日志文件中。这保存在应用程序的 Documents 文件夹中（即 /Documents/syslog.txt）。我可以使用 Xcode 的管理器复制这个文件夹，它显示它位于 package_name/AppData/Documents/syslog.txt 文件中。但是，我想以编程方式为我们的测试自动化框架执行此操作。

一位同事建议使用 AFC 协议（Xcode 使用该协议），但我想确定这是最好的方法。到目前为止看起来是这样，那么如何使用 AFC 和/或其他移动设备 API 来复制文件？

有一些建议可以查看 github 上的项目，但我想要一个直接的示例，说明在 C 代码中执行此任务所需的内容。

谢谢，

何塞

# cucumber - 用黄瓜和 aruba 宣布 rake 标准输出

> ID：10807086
> 
> 赞同：0
> 
> 时间：2012-05-29T21:39:57.730
> 
> 标签：cucumber, rake, rake-task, aruba

如何告诉 cucumber/aruba 显示 rake 命令的标准输出。以下代码对我不起作用

```
@announce
Scenario: test rake task
 When I run 'rake -verion'
 Then the output should contain "0.9.2.2" 
```

即使有@announce 标签，也不会输出命令“rake -version”的标准输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:13:00.610

rake 命令有一个错字，[不推荐使用带引号的命令的 aruba 调用以支持 backticks](https://github.com/cucumber/aruba/blob/master/lib/aruba/cucumber.rb)，并且您缺少 Given 子句（尽管没有它它确实有效）：

```
Scenario: test rake task
 When I run `rake --version`
 Then the output should contain "0.9.2.2" 
```

# php - Symfony2 事件监听器

> ID：10807092
> 
> 赞同：5
> 
> 时间：2012-05-29T21:40:17.510
> 
> 标签：php, symfony

所以，我试图找出这些听众，但我在 symfony 网站上查找有关他们的任何信息时遇到问题。

最初，我想创建一个在每次页面加载时触发的侦听器......我认为这可能对整体系统性能有害，所以我想让它只在：/和/otherpage上触发

但同样，我在查找有关从何处开始使用侦听器的任何信息时遇到问题。任何帮助表示赞赏..所有这个监听器将做的，是使用 Doctrine 检查数据库并根据它找到的内容设置会话..

再次感谢任何帮助或建议。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T22:33:07.920

我做了类似的事情来检查子域没有改变。您可以将侦听器作为服务放入配置文件中，如下所示：

```
services:
    page_load_listener:
        class: Acme\SecurityBundle\Controller\PageLoadListener
        arguments: 
            security: "@security.context", 
            container: "@service_container"
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest, priority: 64 } 
```

我不确定优先级是如何工作的，但我发现如果它设置得太高，它就不会在应用程序的其余部分之前运行。在我的待办事项清单上进行更多研究。

这是监听器外观的示例。

```
namespace Acme\SecurityBundle\Controller;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\Security\Core\SecurityContext;
use Symfony\Component\HttpKernel\Event\GetResponseEvent;

class PageLoadListener extends controller
{
    private $securityContext;
    protected $container;
    protected $query;

    public function __construct(SecurityContext $context, $container, array $query = array())
    {
        $this->securityContext = $context;
        $this->container = $container;
        $this->query = $query;
    }

    public function onKernelRequest(GetResponseEvent $event)
    {       
        //if you are passing through any data
        $request = $event->getRequest();

        //if you need to update the session data
        $session = $request->getSession();              

        //Whatever else you need to do...

    }
} 
```

我不确定将其设置为仅在某些页面上运行的最佳方法，但我最好的猜测是检查路由并仅在路由与您设置的任何内容匹配时才访问您的数据库。

希望这能让你开始！

格雷格

# php - php echo html 不带引号和空格

> ID：10807094
> 
> 赞同：0
> 
> 时间：2012-05-29T21:40:20.080
> 
> 标签：php, html

我正在尝试回显自动生成的 html 表单元素，但页面始终将 html 代码显示为文本。当我通过 Chrome 检查输出时，它会显示生成的带有引号和空格的表单输入。这是我尝试过的结果：

这是代码生成整个表单

```
<form action="<?php echo url_for('/survey/submit?id='.$Survey->getId()) ?>" method="post">
    <ul>
    <?php foreach($Questions as $Question): ?>
        <li><?php echo $Question->questionHtml() ?></li>
    <?php endforeach; ?>
    </ul>
</form> 
```

这是一个示例结果：

```
"<li>
                                <input class="survey" size="40" type="text" name="Sample Survey[input_1]" id="Sample_Survey_input_1" />             </li>" 
```

我也尝试了 htmlentities。

```
echo htmlentities($Question->questionHtml())
"
                                &lt;input class=&quot;survey&quot; size=&quot;40&quot; type=&quot;text&quot; name=&quot;Sample Survey[input_1]&quot; id=&quot;Sample_Survey_input_1&quot; /&gt;             " 
```

**问题是我无法在页面上显示这些生成的表单元素，而只能显示它们的纯文本格式。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:45:47.527

如果它显示您需要解码 html 实体的代码

```
echo html_entity_decode( $Question->questionHtml() ); 
```

[http://www.php.net/manual/en/function.html-entity-decode.php](http://www.php.net/manual/en/function.html-entity-decode.php)

**但**

这不应该做。questionHtml() 函数应该只将表单值转换为其实体，而不是整个表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:49:31.270

If `$Question->questionHtml()` is echoing the correct HTML, then all you need is to use `trim()` to remove the whitespace.

# javascript - JavaScript 数学公式

> ID：10807103
> 
> 赞同：0
> 
> 时间：2012-05-29T21:41:11.627
> 
> 标签：javascript, math

我得到了以下 Excel 公式来计算贷款的法国系统利息：

```
=+G15*B15/(1-(1+G15)^(-H15)) 
```

在哪里：

```
G15 = 1.33%
B15 = importe
H15 = plazo 
```

由于我通常对解决问题的顺序有疑问，所以我将公式分解为小和平。这就是我所拥有的

```
// user input
var importe = parseFloat($('#importe_prestamo').val());
var plazo = parseFloat($('#plazo_prestamo').val());

//formula
var formula1 = 0.0133 * importe;
var parentesis1 = parseFloat(1 + importe);
var potencia = Math.pow(parentesis1,plazo);
var parentgde = 1 - potencia;
var totalcount = formula1 / parentgde;
console.log(totalcount); 
```

我在“importe”中输入 10000，在 plazo 中输入“144”，但`totalcount = 0`由于“var potencia”返回“Infinity”而得到

几个星期以来，我一直在为这个项目做各种各样的公式，我对这么多信息感到困惑，现在我不知道如何继续解决这个公式。任何指针都会很棒。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:49:57.580

您错过了该行的减号：

```
var potencia = Math.pow(parentesis1,plazo); 
```

它应该是

```
var potencia = Math.pow(parentesis1, -plazo); 
```

尽管您可以将整个公式写在一行中……</p>

编辑：又如何？;-)

```
var G15 = 0.0133, B15 = importe, H15 = plazo;
var total = G15 * B15 / (1 - pow(1 + G15, -H15)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:51:02.013

根据公式...

```
var parentesis1 = parseFloat(1 + importe); 
```

应该

```
var parentesis1 = parseFloat(1 + 0.0133); 
```

如前所述，您也缺少-。

# recursion - 如何在递归方法中使用 Future 和 Callable？

> ID：10807105
> 
> 赞同：1
> 
> 时间：2012-05-29T21:41:16.383
> 
> 标签：recursion, parallel-processing, future, executor, callable

我正在尝试使用 Future 和 Callable 将 dfs 递归方法转换为并行以提高效率。但不知道如何正确地做到这一点。这是代码：

```
public MyResult compute(MyTree tree, int depth, ExecutorService exec) {
    if (depth >= 3) {
        Callable<MyResult> callable = new Callable<MyResult>() {
            @Override
            public MyResult call() throws Exception {
                return compute(tree, 0, exec);
            }
        };
        Future<MyResult> task = exec.submit(callable);
        return task.get();
    }
    else {
        MyResult result = new MyResult();
        if (something) {
            tree = tree.leftChild;
            result = compute(tree,depth+1,exec);
        }
        else if (something else){
            tree = tree.rightChild;
            result = compute(tree,depth+1,exec);
        }
        else
            return result;
    }
} 
```

我期望做的是递归方法将继续计算而不等待task.get()的返回值。因此，每当它进入深度 3 时，它都会提交一个未来任务，然后返回计算另一个子树，同时该任务将计算自己的子树。

但是，我发现这个方法仍然是顺序的，而不是并行的。（我每次调用方法时都打印出深度，结果和没有使用future和executor的方法一样，而且总是比较慢。）

我相信这不是使用 Future 和 Callable 的正确方法，我找到了一些示例，但它们没有使用递归方法。最常见的例子是有一个 Future List> 的列表，并且每次提交一个任务，然后在另一个循环中迭代 Future 列表。

有谁知道如何以递归方法实现 Future 和 Executor ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:43:03.077

您可能对 Java 1.7 ForkJoinPool 更满意，它专门针对递归分而治之。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T23:29:59.923

```
 Future<MyResult> task = exec.submit(callable);
    return task.get(); 
```

这段代码相当于调用`callable.run()`. Future.get() 阻塞输出。

也许这个例子太简单了。看来逻辑永远不需要处理多个子树。如果您需要来自同一节点的多个递归调用，您可以将它们全部提交为`Callable`s 并在一个单独的循环中等待它们，正如您所提到的。（当然，您的 ExecutorService 也需要有多个线程。）

# testing - 在 3g 上测试移动网站

> ID：10807107
> 
> 赞同：1
> 
> 时间：2012-05-29T21:41:32.250
> 
> 标签：testing, mobile, 3g

我一直在四处寻找，试图找到一些可以在 3g 连接上测试我的移动网站性能的软件。我还希望能够监控呼叫，以便细分哪些部分花费的时间最多。

我想要类似 firebug 或 safari web 检查器上的网络选项卡的东西。我知道可以通过限制计算机上的连接然后通过 wi-fi 连接我的手机来使用 Charles，但我真的想使用实际的 3g 连接进行测试。

有人对可用的最佳测试方法或软件有任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T07:38:05.250

我自己也在研究同样的事情。到目前为止，我已经找到了以下解决方案。不过，所有这些都不完全让我满意。

**[使用netspeed 的](http://developer.android.com/tools/devices/emulator.html#netspeed)** **Android 模拟器**
+ 操纵 netspeed（手动、umts、gprs 等）
+ 操纵网络延迟（延迟）
- 不是实际设备 - 仅限 android

**Chrome 浏览器桌面 + ADB + chrome 浏览器移动**（[远程调试](https://developers.google.com/chrome-developer-tools/docs/remote-debugging)）
- 仅在 chrome 浏览器
+ 实际设备中
- 仅限 android
- 只有 wifi 速度（所以没有 umts、gprs 等。）

**一般**
1\. 记录 http 流量并在负载驱动程序中重放。
2\. 使用 WAN 模拟器来模拟各种 Wi-Fi 条件、更高的延迟、丢包等
3\. [Webwait](http://webwait.com/)测量页面加载时间（基本）
4\. [Weinre](http://people.apache.org/~pmuellr/weinre/docs/latest/)

希望有用！

# scala - Lift：如何通过属性和值在 NodeSeq 中选择一个节点？

> ID：10807109
> 
> 赞同：1
> 
> 时间：2012-05-29T21:41:39.567
> 
> 标签：scala, select, attributes, lift, nodes

我有一个 NodeSeq 对象，并且想要选择一个标有属性的给定节点。例如，假设`<div id="content">...</div>`NodeSeq 中有一个标签。

我尝试使用`\\`NodeSeq 上的方法以及过滤器进行选择。

假设*seq*是我的 NodeSeq 对象。

`seq \\ "div"`有效，但这会选择所有`<div>`元素。

`seq.filter(_.attribute("id").equals("content"))`根本不选择任何节点，结果列表为空。

如何选择此节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T21:50:42.947

尝试

```
scala> var x= <b>
 | <h id="bla"/>
 | <h id="blub"/>
 | </b>

x \\ "h" filter (h=>(h \ "@id" toString) == "bla") 
```

这应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-28T05:49:04.237

或者，您可以尝试以下方法：

```
seq.filter(_.attribute("id").exists(_.text.equals("content"))) 
```

# c++ - static 关键字是否会提高性能？

> ID：10807112
> 
> 赞同：1
> 
> 时间：2012-05-29T21:42:11.507
> 
> 标签：c++, performance

我很欣赏这是一个微优化，但我感兴趣的是，`static`与非实现相比，将函数或成员变量声明为是否提供任何性能提升`static`？

我记得读过`const`可用于编译器进行优化的文章，所以这让我想知道是否`static`有任何类似的优势。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T21:47:37.710

考虑到非变量`static`和非`static`变量的*语义*截然不同，你是否可以声明`static`真的与性能无关。

此外，缓存和其他问题很可能意味着“不”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:47:20.613

如果构建需要很长时间（例如预先计算的缓冲区或从磁盘读取的内容），它可能用于数据。通常，这仅在数据不可变时才是理想的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T23:02:06.970

@DeadMG 已经指出将成员变量更改为静态将完全改变语义，这同样适用于静态函数。

一般来说，答案是否定的，`static`对性能没有帮助（[也没有`const`](http://www.gotw.ca/gotw/081.htm)），但`static`可以提供帮助的一种方法是在 ELF 共享库中，其中静态函数在外部不可见，因此不需要调用它通过[过程链接表](http://www.airs.com/blog/archives/41)，它提供了一个小的性能优势，在为共享库编写代码时值得考虑。

# java - 有没有办法判断程序是否仍在运行方法？

> ID：10807117
> 
> 赞同：0
> 
> 时间：2012-05-29T21:42:25.087
> 
> 标签：java

我正在从我的 main 运行一个生成数据的方法，并且我还派生了一个线程，该线程监视该方法正在写入的队列，如果有数据，它会将其保存到磁盘。

我的问题是过去我会多线程它并且能够监视其他线程的生命但是我不确定如果它只是主要方法该怎么做？该方法生成数据缓慢并且使用 sleep 或 !queue.empty() 的问题一旦清空分叉文件写入器进程停止的队列就不起作用。

我知道最坏的情况是我可以在生成数据的方法中写入文件，但除此之外，我还能做些什么来监控是否仍在执行另一种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T21:51:43.670

听起来对一个[`ExecutorService`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html). 在您的主要方法中创建它：

```
ExecutorService pool = Executors.newFixedThreadPool(10); 
```

`ExecutorService`基本上是一个队列和一组在该队列上等待的线程的包装器（上面示例中的 10 个）。当队列中出现某些内容（已提交）时，恰好有一个线程将其拾取：

```
pool.submit(someWork); 
```

Runnable在哪里`someWork`，例如包装要写入磁盘的数据和写入过程。在主线程中完成后，您只需要求`pool`优雅地终止：

```
pool.shutdown();
pool.awaitTermination(60, TimeUnit.SECONDS); 
```

此代码将等待 60 秒以等待其他线程完成并处理队列中的所有项目。

向我们展示更多代码，我可以帮助您重构它。如果您不想走那么远，一些 Java 集合中的一些方法会在队列为空时阻塞，并在出现某些内容时唤醒线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:52:04.663

您还可以使用[jstack](http://docs.oracle.com/javase/7/docs/technotes/tools/share/jstack.html)命令打印 JVM 线程的堆栈跟踪。

# facebook - 如何强制 Facebook 访问令牌过期？

> ID：10807122
> 
> 赞同：30
> 
> 时间：2012-05-29T21:43:28.663
> 
> 标签：facebook, facebook-graph-api

在offline_access 到期后，我正在做一些测试。我认为，由于我的应用程序与 Facebook 的所有交互都是通过我的服务器完成的，并且是由用户在多个应用程序端点（手机应用程序、网站、桌面应用程序）上的活动发起的，所以我可以使用应用程序访问令牌发布到墙上代表我的用户，假设即使我在授权期间请求的访问令牌已过期，应用程序仍然被授权。这似乎是[这里](https://developers.facebook.com/docs/authentication/applications/)的文档所暗示的

> 作为应用程序进行身份验证允许您获取访问令牌，该令牌允许您代表应用程序而不是用户向 Facebook API 发出请求。[...] 应用访问令牌还可用于代表已授予您应用程序发布权限的用户向 Facebook 发布内容。
> 
> 应用程序访问令牌通常不会过期。一旦生成，它们将无限期有效。

但是，我需要对此进行测试。所以我需要使一些令牌过期。我尝试使用您在开发人员站点中创建的官方测试用户，该用户只能与您的应用程序的沙箱和其中的其他用户进行交互，但他们的令牌似乎永久有效一小时。

因此，我尝试使用为此创建的真实 Facebook 用户，并更改我读过的密码应该使令牌过期。但事实并非如此。该令牌在调试器中仍然报告有效，我仍然可以将它用于许多事情，包括发布到我的墙上。我什至可以在完全退出 Facebook 网站后继续使用此令牌。

是什么赋予了？如何获取过期的 access_token 以便测试我的应用程序访问令牌？

编辑：我认为它会起作用。我创建了我的应用程序访问令牌并使用 CLIENT-SIDE 流程来获取仅持续 2 小时的用户访问令牌，因此我实际上可以等待它过期。到期后，我使用 Graph API 资源管理器尝试发布状态更新，但未能告诉我我的令牌何时过期。然后，我使用成功的应用程序令牌尝试了相同的操作。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-29T22:34:35.570

但它在文档中说，就在你引用的最后一行之后：

> 应用程序访问令牌通常不会过期。一旦生成，它们将无限期有效。**但是，如果您出于某种原因需要使您的 App Access Token 失效，您可以在您的应用设置中重置您的 App Secret。重置您的 App Secret 后，您将需要执行以下步骤来生成新的应用访问令牌。**

因此，出于您的测试目的，请重置应用程序密钥。

* * *

# 编辑

哦，我完全误解了你的意思。
使用户令牌无效更容易，您只需将[me/permissions](http://developers.facebook.com/tools/explorer?method=GET&path=me/permissions)连接与 DELETE 请求一起使用。

这将删除登录用户的应用程序。
您可以从资源管理器工具中尝试，只需在路径字段左侧的选择框中选择 DELETE。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-30T05:44:00.740

这应该工作，检查下面。

使您的令牌无效（又名注销）；对该端点进行 HTTP GET 调用；

```
https://api.facebook.com/restserver.php?method=auth.expireSession&format=json&access_token=<access_token> 
```

*ps 我的回答是从 2012 年开始......从那时起，Facebook API 发生了许多重大变化。阅读 up2date Facebook 开发者文档更可靠*

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-07-27T21:19:37.593

就像@guleryuz 的回应一样，但以实用的方式：

给定一个有效的 access_token `${token}`：

```
$ curl -X GET "https://graph.facebook.com/v2.7/me/permissions?access_token=${token}"
{"data":[{"permission":"user_friends","status":"granted"},{"permission":"email","status":"granted"},{"permission":"manage_pages","status":"granted"},{"permission":"business_management","status":"granted"},{"permission":"pages_messaging","status":"granted"},{"permission":"pages_messaging_phone_number","status":"granted"},{"permission":"public_profile","status":"granted"}]} 
```

撤销请求：

```
$ curl -X DELETE "https://graph.facebook.com/v2.7/me/permissions?access_token=${token}"
{"success":true} 
```

验证撤销：

```
$ curl -X GET "https://graph.facebook.com/v2.7/me/permissions?access_token=${token}"
{"error":{"message":"Error validating access token: The session was invalidated explicitly using an API call.","type":"OAuthException","code":190,"error_subcode":466,"fbtrace_id":"E2UhrNzyyzZ"}} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-01-20T19:48:28.110

此处发布的答案已过时。要强制您的令牌过期：登录您的 Facebook 帐户，转到“设置”，然后单击左侧的“应用程序”

[![设置选择](../Images/d02c7f165a9f4828042d742ed036080f.png)](https://i.stack.imgur.com/uqQRT.png)

删除应用程序：

[![在此处输入图像描述](../Images/7f00399bfd88f74c002a33f363048f05.png)](https://i.stack.imgur.com/FCdlD.png)

这将强制令牌过期。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-07-26T19:15:51.867

另一种可能的解决方案是使用具有自定义过期时间的测试帐户：

[![在此处输入图像描述](../Images/a27db414a1634032864b3a2f432d478e.png)](https://i.stack.imgur.com/Vjh9e.png)

[![在此处输入图像描述](../Images/9cd4515417d74ff3445cacf963464104.png)](https://i.stack.imgur.com/TUXwS.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-05T12:15:45.790

查看权限

```
https://graph.facebook.com/v2.7/{userID}/permissions?access_token={acessToken} 
```

对于删除权限添加`"method=delete"`之前`&access_token=`

```
https://graph.facebook.com/v2.7/{userID}/permissions?method=delete&access_token={acessToken} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-01T06:58:30.677

您可以尝试通过更改您的 Facebook 密码来复制该行为

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-04-11T05:22:55.513

在此 url `https://www.facebook.com/connect/login_success.html#access_token="access_token" &expires_in=1.minutes` 中`"access_token"`输入不带引号的访问令牌，访问令牌将在 1 分钟后过期。

# c# - .NET 4.0 业务 API 是否适用于 Win 8 Metro Apps？

> ID：10807123
> 
> 赞同：1
> 
> 时间：2012-05-29T21:43:30.863
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

我们有大量在 .NET 4.0 中开发的业务 API/程序集（其中大部分是从 .NET 2.0 升级而来的）。它们目前没有作为 Web 服务公开。

我们想基于这些 API 开始 Win 8 Metro 应用程序开发（使用 C#/XAML）。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T00:08:59.637

另一种选择是针对可移植类库 (PLC)

[http://msdn.microsoft.com/en-us/library/gg597391.aspx](http://msdn.microsoft.com/en-us/library/gg597391.aspx)

这样，您可以将单个程序集编译为多目标普通 .net 和 Metro/WinRT .net。

您当然必须对暴露给两个框架的 API 子集进行编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T03:05:07.553

您的类可能会在 Metro 风格应用程序中使用，但这不太可能。完整的 .NET Framework 不会暴露给 Metro 风格的应用程序。它实际上是 .NET Framework 的一个子集，称为 Core Profile。您可以在 ...

```
C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETCore\v4.5\ 
```

Check out [A .NET developer's view of Windows 8 app development](http://channel9.msdn.com/Events/BUILD/BUILD2011/TOOL-930C) from Build for a discussion of the .NET Profile for Metro style apps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:58:49.847

如果可以将它们重新编译为 WinRT 类库，则可以使用它们。很可能这意味着不，您需要先更新它们以使用 WinRT API，无论您使用 WinAPI 还是之前未迁移到 WinRT 的某些 .NET 库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:59:44.447

我认为现在的发展方式是 SaaS/云解决方案。

您最好的选择可能是将这些程序集公开为 Web 服务并从您的应用程序访问这些服务。

当然，这是假设您没有来回的大量数据。

在这种情况下，您应该能够将那些重新编译为 WinRT 类库的程序集包含在内……尽管我不鼓励这样做，因为它可能会使您正在开发的应用程序的大小非常大。

# database - 从 APEX 更改 Oracle 数据库密码

> ID：10807124
> 
> 赞同：3
> 
> 时间：2012-05-29T21:43:48.600
> 
> 标签：database, oracle, oracle-apex

我正在尝试在 APEX 上实现一个表单，该表单允许用户（在本例中为 dba）选择一个数据库，然后更改他们的用户名和密码。

我能够正确设置输入字段，但我完全不知道如何将其与实际数据库联系起来。我假设我将不得不使用数据库链接来访问不同的数据库。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T05:49:04.487

我不认为你将能够做这样的事情：

```
alter user xyz@remote_database identified by new_password 
```

您可能需要在远程数据库上编写一个接受用户名和密码并为您更改用户密码的存储过程。然后你可以执行：

```
begin
   change_password('xyz','new_password')@remote_database;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:12:05.253

我设计了一个不需要存储过程或单个用户提升访问权限的解决方案。它有点被黑客攻击，但它有效！

1.  用户通过常规 APEX 表单输入他们的凭据和所需的新密码。

2.  表单数据在一个带有 iframe 的 HTML 区域中使用替换字符串进行处理。IE：`<iframe height='300' width='100%' scrolling="no" src="http://***SERVER***/cgi-bin/chguserpwd.cgi dbname=&DATABASE_NAME.&username=&USERNAME.&oldpwd=&CURR_PASSWORD.&newpwd=&NEW_PASSWORD."></iframe>`

3.  cgi 脚本完成工作并通过 iframe 返回结果

    ```
    #!/usr/bin/ksh 
    my_input=$QUERY_STRING;
    dbname=`echo "$QUERY_STRING" |awk '{FS="&"} {print $1}'|awk '{FS="="} {print $2}'`
    username=`echo "$QUERY_STRING" |awk '{FS="&"} {print $2}'|awk '{FS="="} {print $2}'`
    oldpwd=`echo "$QUERY_STRING" |awk '{FS="&"} {print $3}'|awk '{FS="="} {print $2}'`
    newpwd=`echo "$QUERY_STRING" |awk '{FS="&"} {print $4}'|awk '{FS="="} {print $2}'`
    print "Content-Type: text/html\n\n"; print " Database Name is       $dbname ............ User is $username "; 

    cd **dir**
    ./chguserpwd  $dbname $username $oldpwd  $newpwd 
    ```

4.  从 cgi 脚本执行 SQL`./chguserpwd`

    ```
    set markup HTML on
    prompt .
    alter user &1 identified by &2;
    prompt Password has been changed 
    ```

# python - 动态创建方法的更好方法

> ID：10807128
> 
> 赞同：2
> 
> 时间：2012-05-29T21:44:12.657
> 
> 标签：python, dynamic, methods

所以我需要在对象初始化时根据输入改变一个方法`__init__`（对于那些感兴趣的人，我正在`navigate_to`根据正在实例化的自动化器类型（Selenium、移动设备自动化器等）更改测试框架中的方法）。我想出了一个使用有条件地创建闭包的解决方案`__init__`，但似乎应该有一种更优雅和优化的方法来做到这一点。作为该方法的示例：

```
class Foo(object):
    def __init__(self, x):
        self.x = x
        if x % 2:
            def odd_or_even():
                return '%d odd' % self.x
        else:
            def odd_or_even():
                return '%d even' % self.x
        self.odd_or_even = odd_or_even 
```

导致：

```
>>> foo1 = Foo(1)
>>> foo2 = Foo(2)
>>> foo1.odd_or_even()
'1 odd'
>>> foo2.odd_or_even()
'2 even' 
```

这行得通，但我觉得应该有一些更好的方法来做到这一点。建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:06:47.437

我建议委派这个 - 比如

```
class Automator(object):
    def navigate_to(self, url):
        pass

class SeleniumAutomator(Automator):
    def navigate_to(self, url):
        # do it the Selenium way
        pass

class MobileAutomator(Automator):
    def navigate_to(self, url):
        # do it the mobile-browser way
        pass

class Foo(object):
    def __init__(self, x, automator):
        self.x = x
        self.automator = automator

    def navigate_to(self, url):
        return self.automator.navigate_to(url)

f = Foo(3, SeleniumAutomator())
f.navigate_to('http://www.someplace.org/') 
```

...您可以仅使用函数来执行此操作，但我认为有一堆依赖于接口的方法，并且将它们分组在一个类中似乎最干净。

**编辑：**哦-那么您想要的不是Foo，而是自动化工厂-类似于

```
def makeAutomator(type, *args, **kwargs):
    return {
        "selenium": SeleniumAutomator,
        "mobile":   MobileAutomator
    }[type](*args, **kwargs)

myauto = makeAutomator("selenium") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:11:15.797

我会为每种类型的自动机创建一个不同的方法，然后使用一个通用方法`self`来确定要调用哪个特定方法。

为什么你需要创建一个包含决策的闭包，当你可以只记录决策时`self`？

# python - 如何使用 Flask 设置 mako 模板以产生可破译的异常？

> ID：10807132
> 
> 赞同：4
> 
> 时间：2012-05-29T21:44:39.770
> 
> 标签：python, flask, mako

我喜欢 mako，希望它更容易与 Flask 框架集成。我设置了[flask-mako](https://github.com/tzellman/flask-mako)扩展，但很快发现，我得到了一个几乎没用的版本，而不是像jinja那样产生易于理解的回溯，而不是非常漂亮的[flask调试器屏幕](http://kay-docs.shehas.net/_images/debugger.png)，几乎没有用的版本，几乎没有描述和不准确的行号（我会提供一些硬证据，但我已经卸载）。

[该线程](https://stackoverflow.com/questions/390409/how-do-you-debug-mako-templates)描述了一种使用更好的异常处理设置 mako 的方法，我认为这是我的问题，但据我所知，看起来我需要在我的每个 url 函数上运行 try/except ？

有没有办法让这种异常处理“始终打开”，这样烧瓶调试器就可以在没有所有这些额外努力的情况下使用？

有几个地方提到在烧瓶中交换 jinja/mako 是多么容易，但我发现情况并非如此。希望我错过了什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:15:07.000

flask-mako 是一个非常简单的包。与其用 try:except: 包装你的每一个渲染调用，我建议你改为 fork flask-mako，并在 flaskext/mako.py 中用 mako try except 包装渲染调用（当前主服务器上的第 53 行）。可以在以下位置找到快速通过：[https ://github.com/jd-boyd/flask-mako](https://github.com/jd-boyd/flask-mako)

然而，虽然这使得 mako 模板中的错误更容易找到，但它仍然不允许您使用 flask 调试器来调试 mako 模板。

# wcf - Azure 服务总线中继 - 服务重新启动后出现 502 错误网关

> ID：10807134
> 
> 赞同：2
> 
> 时间：2012-05-29T21:44:57.540
> 
> 标签：wcf, azure, wcf-binding, azure-web-roles, azureservicebus

我们正在使用[**Azure 服务总线中继**](https://www.windowsazure.com/en-us/develop/net/how-to-guides/service-bus-relay/)将我们的本地 WCF 服务连接到我们的 Azure 托管的 Web 角色。当我们升级我们的本地 WCF 服务时，在服务总线主机与中继重新建立自身之后，我们总是从我们通过 Azure 服务总线的前几个请求中获得**502 Bad Gateway响应（***我们没有得到“没有服务托管在指定的地址。”*因为服务托管正确）。

在给定的超时时间之后 - 似乎错误消失了，WCF 请求通过中继正确处理。我们在[禁用 HTTP Keep-Alives](https://stackoverflow.com/a/9386502/175679)[`basicHttpRelayBinding`](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.basichttprelaybinding.aspx)的情况下使用（*以防止*）。*`CommunicationExceptions`*

这是我们在 WCF 请求从 Web 角色到中继期间捕获的错误消息：

> **System.ServiceModel.ProtocolException** : 内容类型 application/soap+xml；响应消息的 charset=utf-8 与绑定的内容类型不匹配 (text/xml; charset=utf-8)。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 550 个字节是……

```
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing">
    <s:Header>
        <a:Action s:mustUnderstand="1">http://schemas.microsoft.com/netservices/2009/05/servicebus/relay/FaultAction</a:Action>
    </s:Header>
    <s:Body>
        <s:Fault>
            <s:Code>
                <s:Value>s:Receiver</s:Value>
                <s:Subcode>
                    <s:Value>s:Receiver</s:Value>
                </s:Subcode>
            </s:Code>
            <s:Reason>
                <s:Text xml:lang="en-US">50200: Bad Gateway.TrackingId:8bd21714-ae0f-41b5-b810-851b59a345fb_28,TimeStamp:5/29/2012 8:27:14 PM</s:Text>
            </s:Reason>
        </s:Fault>
    </s:Body>
</s:Envelope> 
```

我们目前正在尝试禁用 WCF 绑定( *via )*[中的默认 Web 代理](http://kennyw.com/work/indigo/54)，但想知道其他人是否在 Azure 服务总线中看到了相同的 HTTP 502 行为以及如何修复它。*`useDefaultWebProxy=false`*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T21:06:26.970

在将本地 WCF 服务连接到 Azure 托管的 Web 角色时，我已经看到了这样的问题，这些问题主要是由于本地网络中有代理造成的。在任何企业 IT 环境中，所有机器网络设置都设置为使用代理服务器，或者自动检测，或者如果您有多个代理服务器，您实际设置选择哪一个。当 WCF 服务连接外部世界时，它会通过相同的代理设置，这实际上会改变连接它的动态并引入行为。

通过将**UseDefaultWebProxy 设置为 false**，您要求 Web 服务不使用特定于机器的代理并使用作为 Web 服务配置一部分的用户设置。

我认为您可以很好地禁用网络代理并查看它是如何工作的。还可以尝试在此处使用服务跟踪查看器查看相关跟踪和故障排除[。](http://msdn.microsoft.com/en-us/library/aa751795.aspx)

# ms-access - 通过 VBScript 将 XML 导入 MS Access 的问题

> ID：10807135
> 
> 赞同：1
> 
> 时间：2012-05-29T21:45:05.780
> 
> 标签：ms-access, vbscript, import

可能的菜鸟问题，但在这里幽默我......

我每晚将至少两个 xml 文件拉入一个单独的目录，这些文件被命名为“order_'type1/2'.12345.12345.xml”，其中“type1/2”可以是两个单词之一，并且数字字符串会有所不同基于日期。我正在寻找一些东西来拉入（不管日期字符串）名为“order_'type1'*.xml 的 xml 文件。据我所知，VBScript 不一定能很好地使用通配符，所以我在损失在这里。

我最初尝试了以下方法：

```
Const acAppendData = 2

Set objAccess = CreateObject("Access.Application")
objAccess.OpenCurrentDatabase ("C:\Path_to_testdb\test.accdb")

Application.ImportXML ("Path_on_the_server_\order_'type1'*.xml"), acAppendData 
```

但无论出于何种原因，它停止工作（我发誓我没有疯）。所以，我环顾四周，发生了这样的事情：

```
Dim strPathFile As String
Dim strFile As String
Dim strPath As String

strPath = "C:\_where ever file is located_\"

strFile = Dir(strPath & "order_'type1'*.xml")
strPathFile = strPath & strFile

Application.ImportXML strPathFile, acAppendData 
```

我希望这可以解决问题，但是它在第 1 行（哎哟！）char 17 上给了我一个“预期的语句结束”错误......在这一点上，我对语言本身的了解还不够，无法接受教育搜索我真正需要的东西。任何朝着正确方向的轻推都会受到欢迎！

**TLDR：**我希望使用 VBScript 从（可能）许多使用类似命名约定（不同日期字符串）的文件将单个 xml 文件导入 Access，并附加数据。这将每天进行，并且在新的一天放置在目录中的新文件将具有新的命名。用通配符来做这件事会很棒，但是 VBScript 要么不喜欢我，要么不喜欢通配符！

同样，我对 VBScript 的了解非常有限，因此非常感谢任何方向/帮助！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:07:00.883

不确定您的问题是什么（没有注意到您的帖子中有任何问号）。

但是，错误（第 1 行）是由于 VBScript 只有一种数据类型（Variant）。在这里阅读更多：http: [//msdn.microsoft.com/en-us/library/9e7a57cf (VS.85).aspx](http://msdn.microsoft.com/en-us/library/9e7a57cf(VS.85).aspx)

所以你的前三行应该是：

```
Dim strPathFile
Dim strFile
Dim strPath 
```

或者，甚至更好：

```
Dim strPathFile, strFile, strPath 
```

# makefile - 在 makefile 中指定目标而不显示在 $^ 中

> ID：10807136
> 
> 赞同：1
> 
> 时间：2012-05-29T21:45:09.640
> 
> 标签：makefile

我有一个程序链接到一个也在开发过程中的库。我想在库更改时重新链接我的程序（因此`.a`在我的先决条件列表中包含该文件，但我也希望能够使用`$^`自动变量（或类似的东西）列出所有*其他*目标链接器的调用。我还可以将 makefile 本身列为某些目标的依赖项，以确保在我更改 makefile 时重新编译它们。

有什么方法可以将特定文件标记为依赖项，而无需将其显示在自动变量中，例如`$^`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T01:12:30.160

我不知道有什么方法可以修改`$^`自己，但是 GNUMake 有一些很好[的操作文本的功能](http://www.gnu.org/software/make/manual/make.html#Text-Functions)，例如`filter-out`：

```
foo: bar baz quartz.a Makefile
    @echo I want $(filter-out %.a Makefile, $^), not $(filter %.a Makefile, $^) 
```

# mysql - 文件权限的嵌套集或邻接列表模型 (MySQL)

> ID：10807138
> 
> 赞同：0
> 
> 时间：2012-05-29T21:45:18.320
> 
> 标签：mysql, adjacency-list, nested-set-model, adjacency-list-model

# 问题：

在 MySQL 数据库中存储所有用户文件/文件夹权限时应该使用什么设计？

# 细节：

我无法确定嵌套集是否需要太多插入时间，或者邻接列表是否需要太多访问分层数据的时间。我很确定随着文件/文件夹数量的增加，嵌套集会花费很长时间。例如，插入一个节点（行）需要在遍历该节点之后更新每个单个节点。是否可以在路径上使用字符串标记化（即`/home/user/pictures` `-->` `/`, `/home`, `/home/user`）并在查询中使用它，相当于可变长度邻接列表模型？第三种选择是拥有一个`parent_folders`执行完全相同功能但使用更多空间而不是更多时间的表。

以下是对`files`和`folders`表的简要描述：

**文件：**

```
CREATE TABLE IF NOT EXISTS files
(
   id                    INT NOT NULL AUTO_INCREMENT,
   path                  VARCHAR(500) NOT NULL,
   r                     BOOL NOT NULL DEFAULT FALSE,

   PRIMARY KEY ( id )
)
engine=innodb; 
```

**文件夹：**

```
CREATE TABLE IF NOT EXISTS folders
(
   id                    INT NOT NULL AUTO_INCREMENT,
   path                  VARCHAR(500) NOT NULL,
   r                     BOOL NOT NULL DEFAULT FALSE,

   PRIMARY KEY ( id )
)
engine=innodb; 
```

这是上面的两个表，经过修改并带有潜在`parent_folders`表：

**文件：**

```
CREATE TABLE IF NOT EXISTS files
(
   id                    INT NOT NULL AUTO_INCREMENT,
   parent_folder_id      INT NOT NULL,
   path                  VARCHAR(500) NOT NULL,
   r                     BOOL NOT NULL DEFAULT FALSE,

   FOREIGN KEY ( parent_folder_id ) REFERENCES folder ( id ),
   PRIMARY KEY ( id )
)
engine=innodb; 
```

**文件夹：**

```
CREATE TABLE IF NOT EXISTS folders
(
   id                    INT NOT NULL AUTO_INCREMENT,
   path                  VARCHAR(500) NOT NULL,
   r                     BOOL NOT NULL DEFAULT FALSE,

   PRIMARY KEY ( id )
)
engine=innodb; 
```

**父文件夹：**

```
CREATE TABLE IF NOT EXISTS parent_folders
(
   id                    INT NOT NULL AUTO_INCREMENT,
   parent_folder_id      INT NOT NULL,
   folder_id             INT NOT NULL,

   FOREIGN KEY ( parent_folder_id ) REFERENCES folders ( id ),
   FOREIGN KEY ( folder_id ) REFERENCES folders ( id ), 
   PRIMARY KEY ( id )
)
engine=innodb; 
```

# php - HTML / CSS 模块 - 最佳实践？

> ID：10807141
> 
> 赞同：5
> 
> 时间：2012-05-29T21:45:34.060
> 
> 标签：php, html, css

我开始将独立的 HTML 片段提取到它们自己的文件中，并使用 PHP`include`关键字将它们包含在内。

我有一个大约 1500 行长的 CSS 文件。我正在考虑做的是将嵌入的 CSS 与相应的 HTML 文件一起放置。

当然会留下在不同 HTML 块中使用的组件。

这样我就有了模块化的 HTML / CSS 块，我只是使用 PHP 将它们包含在服务器上`include`

这是最佳实践吗？是/否，为什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T21:53:48.757

浏览器缓存 CSS 文件...因为加载一个大的 CSS 文件并不是什么大问题。

如果你想让它变得超级高效，你可以将 css 拆分成不同的模块。然后创建一个“构建系统”来检查正在使用的模块并创建一个仅包含必要 CSS 的 CSS 文件（甚至缩小）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:48:22.297

我不会将您的 CSS 直接嵌入到 HTML 文件中，但每个文件都有一个外部样式表。就像你应该让你的 JS 和你的 HTML 分开一样，这也让你的 CSS 也分开。那么你需要做的就是包含你的 CSS

```
<link rel="stylesheet" href="path/to/style.css"> 
```

您可以将其放在任何全局样式表下方。这也使特定页面的 CSS 仅限于加载在*该页面上*，因此不会浪费带宽来传输您永远不会使用的样式。

* * *

但是，如果您`include()`要说，15 个文件进入您的页面，您不希望对 CSS 文件发出 15 个请求。在这种情况下，您应该将它们分组到更大的文件中以减少所需的请求数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:53:49.173

这里有几件事情需要考虑，看看什么最适合你：

*   您的服务器当前是否发送了 CSS 文件的 http-gzip 压缩版本以使其尽可能快？
*   你有没有缩小 CSS 看看你能得到多小（有几个工具可以为你缩小文件，比如 YUI Compressor）？
*   将 CSS 作为片段发送意味着文件不能被浏览器缓存；检查这是否值得。它取决于许多变量，例如每个访问者的平均页面数（查看 Google Analytics 或其他统计软件可能会有所帮助）、块的大小与整体 CSS 大小等。
*   与没有 PHP 的平面文件相比，使用 PHP 服务块可能有也可能没有最小的服务器计算开销；检查这是否与您的情况有关。
*   你提供依赖于媒体的 CSS 吗？如果是这样，请确保仅在需要时才提供块（例如，移动设备可能只需要移动块）。

# c# - 如何填充 BitArray 以便将其复制到字节中

> ID：10807146
> 
> 赞同：3
> 
> 时间：2012-05-29T21:45:53.873
> 
> 标签：c#, bit-manipulation, bitarray

请考虑将斜杠符号（例如 24、30）转换为子网掩码的这个（非家庭作业）练习。

**当我将 a 复制`BitArray`到`byte[]`时，内部排序`BitArray`导致输出不正确。**

例如，输入`numberOfSetBits=24`,`ToString()`应该返回`255.255.255.0`（这是有效的，因为位是对称的）。但是，`30`结果的输入`255.255.255.63`而不是预期的`255.255.255.252`。是的，我意识到这[只是 BitArray 处理它的孩子的方式](https://stackoverflow.com/questions/9066831/bitarray-returns-bits-the-wrong-way-around)（有一个关于这个问题的[旧讨论](http://www.pcreview.co.uk/forums/wrong-bitarray-copyto-might-have-posted-twice-sorry-t1366528.html)，不幸的是没有*解决方案*，只是关于为什么一个排序会更好的永无止境的争论）。

但是，看在上帝的份上，我怎样才能让这段代码按原样处理`1111 1100`（=252）而不是把它改成`0011 1111`（=63）？我相信我必须首先更改添加位的顺序，但我无法让它工作。

```
public class SubnetMask
{
    private byte[] parts = new byte[4];

    public static SubnetMask FromSlash(int numberOfSetBits)
    {
        BitArray bits = new BitArray(32);
        for (int i = 0; i < numberOfSetBits; i++)
        {
            bits[i] = true;
        }
        return new SubnetMask(bits);
    }

    private SubnetMask(BitArray bits)
    {
        bits.CopyTo(parts, 0);
    }

    public override string ToString()
    {
        return string.Join(".", parts);
    }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T21:52:44.273

这难道不是通过这样做来解决的：

```
int bitPlace = 32;
for (int i = 0; i < numberOfSetBits; i++)
{
    bits[--bitPlace] = true;
} 
```

这将设置高位（而不是低位）。这里的推理正是您链接的答案中提到的 - BitArray 将最低有效数字存储在最低索引中，因此`11111000000000`下面的位数组是 [indexed] 因此：

```
(Most Significant)                  (Least Significant)
 1    1    1    1    1   0   0   0   0   0   0   0   0   0
[14] [13] [11] [10] [9] [8] [7] [6] [5] [4] [3] [2] [1] [0] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:58:23.493

您不需要 a `BitArray`，您可以通过移动整数来创建掩码，并用于`BitConverter.GetBytes`将其作为字节获取：

```
public static SubnetMask FromSlash(int numberOfSetBits) {
  int mask = numberOfSetBits == 0 ? 0 : -1 << (32 - numberOfSetBits);
  byte[] bits = BitConverter.GetBytes(mask);
  if (BitConverter.IsLittleEndian) Array.Reverse(bits);
  return new SubnetMask(bits);
} 
```

# php - 在 php/mysql 中为我的用户上传和下载

> ID：10807149
> 
> 赞同：1
> 
> 时间：2012-05-29T21:46:07.923
> 
> 标签：php, mysql, upload, download

我有一个关于上传和下载系统如何与 php 和 mysql 一起工作的问题。

我希望能够上传文件（最好通过我的网页），以便只有特定用户才能查看按某些类别排序的可用文件并下载他/她想要的文件。

问这个问题我觉得很愚蠢，但是文件保存在哪里？桌子里面？或者该表是否指向我的网络服务器中的目录？

我问这个是因为我真的很想学习这个，但即使是基本问题也很难制定，更不用说解决了...... :)

期待一些输入

干杯亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:00:05.017

这完全取决于你让它变得多么复杂。

最简单的方法是让用户上传文件。使用 PHP 读取文件信息 ( `$_FILE`) 并将文件移动到某个文件夹，并将信息放入数据库中。假设您链接用户和文件，用户将能够看到所有文件，然后从列表中下载他们的文件。

一个更复杂、更安全且整体更好的选择是让用户上传他们的文件。仍然使用 PHP 读取文件信息，将其存储在数据库中。使用 id 或一些唯一的哈希重命名文件，使其永远不会被覆盖，并将它们移动到受保护的目录中，用户或任何其他用户可以访问它的地方。为根据哈希找到请求文件的用户设置下载页面，然后在正确登录的情况下为他们提供请求的文件。

同样，这实际上取决于您想要使它变得多么复杂以及您要实现的目标。当您处理它并遇到困难时，请回来就问题的特定部分提出问题，您一定会得到更多帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:07:07.930

PHP 文件上传实际上是一个两步过程（如果您想将其保存到所需的路径）。$_FILES 变量包含您尝试上传文件时的所有详细信息，包括名称、类型、大小和临时名称。temp_name 实际上包含文件的临时路径。然后，您可以使用 move_uploaded_file 函数将文件移动到您想要的任何路径。

关于保存在数据库中，一旦您能够成功地将文件移动到所需位置，您就可以更新您的数据库。我建议，最好有一个仅用于文件名和 id 的表，我假设您可能也有一个用于用户的表。然后，您可以拥有一个可以映射用户 ID 和文件 ID 的新表。这将使您能够在用户之间共享访问权限。当然，还有其他方法可以做到这一点。我认为这可能是一个简单的实现。

我也刚刚意识到，您可能想看一个简单的文件上传示例。你可以参考[这个](http://www.w3schools.com/php/php_file_upload.asp)链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T21:53:31.473

您可以使用全局变量在 PHP 中上传文件`$_FILES`。上传文件后..它们会临时存储在系统的临时文件夹中..

例如.. 如果您使用 XAMMP.. 上传的文件临时存储在`xammp/tmp/`.

检查`http://php.net/manual/en/reserved.variables.files.php`使用 $_FILES 变量的解释

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:20:18.070

看来您对 PHP 完全陌生。我给你一个示例代码。使用它并继续前进。这是给我的一个学生的。尝试一下。

```
<?php
session_start();
if(!isset($_SESSION['Usernm']))
    {
        echo header("Location:../Common/MI_Login.php");
    }
$usernm = $_SESSION['Usernm'];

include("../Connection/Connection.php");
if(isset($_POST['BTN_Submit_mi_songdesc']))
    {
        validate_song();
        if(count($error) == 0)
            {
                $SongNm = $_POST['TXT_Nm'];

                $ext=strchr($_FILES['FF_Song']['name'],".mp3");
                $newfile=str_replace($_FILES['FF_Song']['name'],$SongNm,$_FILES['FF_Song']['name']);

                $song = 'Songs/'.$newfile.$ext; 
                $album = $_POST['DDL_AlbumNm'];
                $singernm = $_POST['DDL_SingerNm'];
                $bitrate = $_POST['DDL_Bitrate'];
                $catg = $_POST['DDL_Catg'];
                $ins_song = "INSERT INTO mi_songdesc (SD_SongName, SD_File, SD_AlbumID, SD_SingerID, SD_Bitrate, SD_CatgID, SD_Approved, SD_UploadedBy) VALUES ('$SongNm','$song','$album','$singernm','$bitrate','$catg','1','$usernm')";
                mysql_query($ins_song) or die(mysql_error());
                move_uploaded_file($_FILES['FF_Song']['tmp_name'],'../'.$song);
                header("Location:".$_SERVER['PHP_SELF']);
            }
        else
            {
                foreach($error as $i)
                    {
                        $test .= $i."<br />";
                    }
            }
    }
function validate_song()
    {
        global $error;
        $error = array();
        if($_POST['TXT_Nm'] == "")
            {
                $error[] = "Error : Enter Song Name";
            }
        if($_FILES['FF_Song']['name'] == "")
            {
                $error[] = "Error : Browse a Song"; 
            }
        if($_POST['DDL_AlbumNm'] == "")
            {
                $error[] = "Error : Select Album";
            }
        if($_POST['DDL_SingerNm'] == "")
            {
                $error[] = "Error : Select Singer";
            }
        if($_POST['DDL_Bitrate'] == "")
            {
                $error[] = "Error : Select Bitrate ";
            }
        if($_POST['DDL_Catg'] == "")
            {
                $error[] = "Error : Select Category";
            }
    }
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Upload Song</title>
</head>

<body>
<form action="" method="post" enctype="multipart/form-data" name="form1" id="form1">
  <table width="520" border="1" align="center">
    <tr>
      <td colspan="3" align="center" valign="middle">Enter Song Details</td>
    </tr>
    <tr>
      <td width="185">Song Name</td>
      <td width="16">&nbsp;</td>
      <td width="297"><label for="TXT_Nm"></label>
      <input name="TXT_Nm" type="text" id="TXT_Nm" value="<?php echo $_POST['TXT_Nm']; ?>" size="30" maxlength="30"/></td>
    </tr>
    <tr>
      <td>File</td>
      <td>&nbsp;</td>
      <td><label for="FF_Song"></label>
      <input type="file" name="FF_Song" id="FF_Song"/></td>
    </tr>
    <tr>
      <td>Album Name</td>
      <td>&nbsp;</td>
      <td><label for="DDL_AlbumNm"></label>
        <select name="DDL_AlbumNm" id="DDL_AlbumNm">
        <option value="">Select</option>
        <?php
            $res_alb = mysql_query("SELECT * FROM mi_album");
            while($row_alb = mysql_fetch_array($res_alb))
                {
                    if($_POST['DDL_AlbumNm']==$row_alb['Alb_SlNO'])
                    {
        ?>
        <option  selected="selected" value="<?php echo $row_alb['Alb_SlNO']; ?>"><?php echo $row_alb['Alb_Name']; ?></option>
        <?php
                    }
                    else
                    {
        ?>
        <option value="<?php echo $row_alb['Alb_SlNO']; ?>"><?php echo $row_alb['Alb_Name']; ?></option>
        <?php
                    }
                }
        ?>
      </select></td>
    </tr>
    <tr>
      <td>Singer Name</td>
      <td>&nbsp;</td>
      <td><label for="DDL_SingerNm"></label>
        <select name="DDL_SingerNm" id="DDL_SingerNm">
        <option value="">Select</option>
        <?php
            $res_singer = mysql_query("SELECT * FROM mi_singer");
            while($row_singer = mysql_fetch_array($res_singer))
                {
                    if($_POST['DDL_SingerNm']==$row_singer['SI_SlNo'])
                    {
        ?>
        <option  selected="selected" value="<?php echo $row_singer['SI_SlNo']; ?>"><?php echo $row_singer['SI_Name']; ?></option>
        <?php
                    }
                    else
                    {
        ?>
        <option value="<?php echo $row_singer['SI_SlNo']; ?>"><?php echo $row_singer['SI_Name']; ?></option>
        <?php
                    }
                }
        ?>
      </select></td>
    </tr>
    <tr>
      <td>Bitrate</td>
      <td>&nbsp;</td>
      <td><label for="DDL_Bitrate"></label>
        <select name="DDL_Bitrate" id="DDL_Bitrate">
          <option value="">Select</option>
          <option value="128">128</option>
          <option value="256">256</option>
      </select>
        kbps</td>
    </tr>
    <tr>
      <td>Select Category</td>
      <td>&nbsp;</td>
      <td><label for="DDL_Catg"></label>
        <select name="DDL_Catg" id="DDL_Catg">
        <option value="">Select</option>
        <?php
            $res_catg = mysql_query("SELECT * FROM mi_catg");
            while($row_catg = mysql_fetch_array($res_catg))
                {
                    if($_POST['DDL_Catg']==$row_catg['C_SlNo'])
                    {
        ?>
        <option  selected="selected" value="<?php echo $row_catg['C_SlNo']; ?>"><?php echo $row_catg['C_Name']; ?></option>
        <?php
                    }
                    else
                    {
        ?>
        <option value="<?php echo $row_catg['C_SlNo']; ?>"><?php echo $row_catg['C_Name']; ?></option>
        <?php
                    }
                }
        ?>
      </select></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td align="center" valign="top"><input type="submit" name="BTN_Submit_mi_songdesc" id="BTN_Submit_mi_songdesc" value="Submit" /></td>
    </tr>
    <tr>
      <td colspan="3"><?php echo $test; ?>&nbsp;</td>
    </tr>
  </table>
</form>
</body>
</html> 
```

# android - 如何从php webservice解析android应用程序arraylist

> ID：10807150
> 
> 赞同：1
> 
> 时间：2012-05-29T21:46:09.020
> 
> 标签：android, web-services, soap, xml-parsing

```
public static UserFriendListContainer getFriendList(SoapObject wizardobject)//TESTED
    {
        UserFriendListContainer container= new UserFriendListContainer();

        List<UserFriendListModel> list= new ArrayList();    

        String currobj= wizardobject.getProperty("FriendListResult").toString();

        Log.v("CurrentObjet+++++++",currobj.toString());

        container.setParserResult(currobj);

        SoapObject result = (SoapObject)wizardobject;
        for(int i=0;i<result.getPropertyCount();i++)
        {

                SoapObject object = (SoapObject)wizardobject.getProperty(i);//here it is break

Log.v("result:::::",result.toString());
                Log.v("obj:::::",object.toString());
                Log.v("friendID",object.getProperty("friendid").toString());
                String friendID=object.getProperty("friendid").toString();

                Log.v("friendname",object.getProperty("friendname").toString());
                String friendname=object.getProperty("friendname").toString();

                Log.v("lastaction",object.getProperty("lastaction").toString());
                String lastaction=object.getProperty("lastaction").toString();

                Log.v("friendphoto",object.getProperty("friendphoto").toString());
                String friendphoto=object.getProperty("friendphoto").toString();

                UserFriendListModel model=new UserFriendListModel();
                model.setfriendID(friendID);
                model.setfriendName(friendname);
                model.setfriendPhoto(friendphoto);
                model.setLastAction(lastaction);

                list.add(model);
            }
            container.setList(list);

        return container;
    }

}

-----
<message name="FriendListRequest"/>
<message name="FriendListResponse">
<part name="FriendListResult" type="tns:FirendListArray"/>
</message> 
```

我来自webservice的xml部分就是那个。我试图通过解析来访问我的好友列表。我无法理解..当我调试它时它打破了“SoapObject object =（SoapObject）wizardobject.getProperty（i）”..我想知道如何我可以解析一个我从 web 服务中获取的列表吗？谢谢您提前提供的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T13:12:33.307

```
public static UserFriendListContainer getfriendlist(SoapObject wizardobject) throws XmlPullParserException, IOException {

        UserFriendListContainer container= new UserFriendListContainer();
        UserFriendListModel model = new UserFriendListModel();

         List<UserFriendListModel> list= null;
          list=new ArrayList<UserFriendListModel>();
        Vector vector = (Vector) wizardobject.getProperty("FriendListResult");

          Log.v("vector+++++++",vector.toString());
          System.out.println("vectorsize+++++++"+vector.size());

          int count=vector.size();

          for (int i = 0; i <count; ++i) { 

        SoapObject test=(SoapObject)vector.get(i);

          Log.v("test+++++++",test.toString());  

               Log.v("friendid",test.getProperty("friendid").toString());
                String friendID=test.getProperty("friendid").toString();

                Log.v("friendname",test.getProperty("friendname").toString());
                String friendname=test.getProperty("friendname").toString();

                Log.v("lastaction",test.getProperty("lastaction").toString());
                String lastaction=test.getProperty("lastaction").toString();

                Log.v("friendphoto",test.getProperty("friendphoto").toString());
                String friendphoto=test.getProperty("friendphoto").toString();

                model.setfriendID(friendID);
                model.setfriendName(friendname);
                model.setfriendPhoto(friendphoto);
                model.setLastAction(lastaction);

                list.add(model);
            }
            container.setList(list);
            System.out.println("List==="+list);

         return container;
    } 
```

大家好， 经过这么多努力，我找到了答案..我可以用上面的代码解析我的数组..谢谢你的兴趣..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T08:44:32.517

你确定**wizardobject.getProperty(i)**

返回一个 SoapObject?? 我会尝试使用字符串，或者只是在不进行强制转换的情况下对其进行调试，看看它是什么类型的对象。

检查这个-> [SoapObject 文档](http://ksoap.objectweb.org/software/documentation/api/org/ksoap/SoapObject.html)

顺便说一句，如果您发布错误堆栈跟踪会更方便。

# mysql - 创建外部表需要很长时间

> ID：10807154
> 
> 赞同：0
> 
> 时间：2012-05-29T21:46:30.847
> 
> 标签：mysql, sql, netezza, squirrel-sql

我有一个名为表 B 的表，它作为 Netezza 中的 2800 万条记录，我想将它导出到一个文本文件，以便我可以将文本文件导出到 mysql 服务器。当我运行下面的命令时，SQL 客户端挂起。我正在使用 SquirrelSQL。

```
CREATE EXTERNAL TABLE '/Users/blah/A.txt'
USING(DELIM '\t' REMOTESOURCE 'JDBC')
AS
SELECT * FROM tableB; 
```

我不确定这是否应该是这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T03:40:21.403

好吧，我确定您是否在 Window 机器上运行 Squirrel，但如果您需要在路径中使用反斜杠，您可能还需要转义它们。下面是我在 Window 7 笔记本电脑上运行的 Squirrel 中使用的示例

```
CREATE EXTERNAL TABLE ‘C:\\Users\\ValuedCustomer\\customer dim dump.csv’ 
    USING ( DELIMITER ‘,’ Y2BASE 2000 ENCODING ‘internal’ REMOTESOURCE ‘JDBC’ ESCAPECHAR ‘\’ ) AS 
    SELECT CUSTOMER_FIRST_NAME, CUSTOMER_LASTNAME, CUSTOMER_ADDRESS, CUSTOMER_CITY, CUSTOMER_STATE 
    FROM DIM_CUSTOMER 
```

你可以在我的博客上找到更多信息

[http://nztips.com/2012/07/returning-and-saving-large-result-sets-locally/](http://nztips.com/2012/07/returning-and-saving-large-result-sets-locally/)

# javascript - “getElementsByTagName(...)[0]”未定义？

> ID：10807156
> 
> 赞同：8
> 
> 时间：2012-05-29T21:46:35.093
> 
> 标签：javascript, html, events

我有以下代码，它基本上在一堆图像之间切换。

```
<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript">
            var num = 1;
            img = document.getElementsByTagName("img")[0];
            hbutton = document.getElementsByTagName("h1")[0];
            hbutton.onclick = function() {
                num += 1;
                img.src = num + ".jpg";
            }
        </script>
    </head>
    <body>
        <h1>Press Here!</h1>
        <img src = "1.jpg"></img>
    </body>
</html> 
```

出于某种原因，当我运行它时，什么也没有发生，因为我的 Firebug 控制台显示了以下错误。

```
 hbutton is undefined    
---
    hbutton.onclick = function() { 
```

但是，当我在页面加载后只运行 JS 时，它工作得非常好！！！为什么是这样？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T21:49:14.277

您的代码在定义 h1 标记之前执行。您必须在 onload 处理程序中运行它或将其放在 /body 之前

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T21:51:52.143

JavaScript 从上到下解释。`<script>`所以在你执行的地方，还没有`h1`已知的标签。

尝试将`<script>`-Tag 放在页面底部。否则，如果您需要页面开头的脚本，onLoad-Handler 可能会有所帮助：

```
<script type="text/javascript">
    function onLoadHandler() {
         // your original javascript code here...
    }
</script> 
<body onload="onloadHandler()">
<!-- HTML Code here--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:49:57.160

当你把它放在标题中时，你的 h1 还没有加载。hbutton 变得未定义，而不是对象。然后，当您尝试设置 .onclick 时，它会中断，因为您无法设置未定义的属性。当您将代码放入正文时，您的 h1 已经加载，因此代码按您预期的方式工作。

您可以通过将代码留在顶部来解决此问题，但只能在 onload 事件之后调用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T21:50:39.567

在加载 dom 之前执行 head。把它放在页面的按钮上或者在body标签里放一个onload函数。

当 Document 还没有准备好时，它找不到 document.getElementsByTagName("img") ，因为它根本不存在。

```
<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript">
          function onDocumentReady(){
            var num = 1;
            img = document.getElementsByTagName("img")[0];
            hbutton = document.getElementsByTagName("h1")[0];
            hbutton.onclick = function() {
                num += 1;
                img.src = num + ".jpg";
            }
          }  
        </script>
    </head>
    <body onload="onDocumentReady()">
        <h1>Press Here!</h1>
        <img src = "1.jpg"></img>
    </body>
</html> 
```

或者干脆这样做：

```
<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <h1>Press Here!</h1>
        <img src = "1.jpg"></img>
        <script type="text/javascript">
            var num = 1;
            img = document.getElementsByTagName("img")[0];
            hbutton = document.getElementsByTagName("h1")[0];
            hbutton.onclick = function() {
                num += 1;
                img.src = num + ".jpg";
            }
        </script>
    </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T21:51:56.003

问题是在页面加载期间遇到的脚本正在立即执行。

由于它位于页面顶部的页眉中，这意味着它在页面加载`<h1>`元素（或正文的任何​​其余部分）之前执行。

因此，当它要求时`getElementsByTagName('h1')`，当时没有任何匹配的元素。

您需要： * 将代码移动到脚本的末尾。* 或者将其包装在一个函数中，并在页面加载完成时触发该函数执行——即使用`onload`方法。

# vb.net - 如何让 VB.Net 安装程序运行我的代码

> ID：10807157
> 
> 赞同：3
> 
> 时间：2012-05-29T21:46:35.493
> 
> 标签：vb.net, windows-installer

我一直在网上寻找这个问题的答案，但在我的情况下找不到任何有用的东西。我将部署添加到我的项目中，但我希望该部署将 JavaScript 文件复制到某个动态位置。我能想到的唯一方法是让部署调用我可以在 VB.net 中编写的函数。如果你们对如何做到这一点或其他一些想法有任何想法，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:57:40.610

因为我有一个类似的问题，所以最简单的方法是......

1.  右键单击解决方案，然后转到添加 - 新项目。
2.  新项目 - （设置/部署 - Visual Studio 安装程序）
3.  在“目标机器上的文件系统”下 - 添加一个新文件夹，其中包含您希望部署的所有 JavaScript 项。
4.  将默认文件夹位置更改为您打算用于安装过程的位置

对于默认文件夹位置的文件夹属性 - 使用此链接。会有很大帮助的！ [http://msdn.microsoft.com/en-us/library/aa372057(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/aa372057(v=vs.80).aspx)

这是我收集到的关于你的帖子的基本想法。

最好的，吉米

# java - JSF 和 PostgreSQL 中拉丁美洲和西班牙最常见的语言环境配置是什么？

> ID：10807159
> 
> 赞同：0
> 
> 时间：2012-05-29T21:46:35.853
> 
> 标签：java, sql, postgresql, jsf

使用 PostgreSQL 在 JSF 中编程时，在国际软件中编程时需要进行一些配置，例如：

*   数字作为货币（区域设置）
*   字符（支持ñ）

在开始项目之前，您会考虑哪些语言环境配置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-14T14:40:27.500

如果您想为“拉丁美洲西班牙语”使用特定的语言环境，您可以使用 es_419。以下是有关该语言环境的更多详细信息：[http ://www.localeplanet.com/icu/es-419/index.html](http://www.localeplanet.com/icu/es-419/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T04:44:59.170

如果您想获得西班牙的语言环境，请使用“es_ES”，但拉丁美洲有很多语言环境。我的意思是秘鲁使用“es_PE”，巴拉圭使用“es_PY”等等。请查看此链接以了解有关语言环境的更多信息，[http://www.webreference.com/programming/Globalize-Web-Applications12_Java/index.html](http://www.webreference.com/programming/Globalize-Web-Applications12_Java/index.html)

# c++ - MPL 工厂方法创建 mixin 类

> ID：10807160
> 
> 赞同：3
> 
> 时间：2012-05-29T21:46:42.063
> 
> 标签：c++, boost, metaprogramming, mixins, boost-mpl

我有一个 Visual Studio 2008 C++03 项目，其中工厂方法用于使用大型 switch/case 语句基于一组位标志创建 mixin 类。

例如：

```
inline boost::shared_ptr< MyInterface > Create( DWORD flags )
{
    int a, b, c;
    /* ... */

    /*
        0x000000 - MixinBase
        0x000001 - AddOnA
        0x001000 - AddOnB
        0x002000 - AddOnC
        0x400000 - AddOnD
        ... several more
    */

    switch( flags )
    {
    case 0x000001:
        return boost::make_shared< AddOnA< MixinBase > >( a, b, c );
    case 0x001001:
        return boost::make_shared< AddOnB< AddOnA< MixinBase > > >( a, b, c );
    case 0x003001:
        return boost::make_shared< AddOnC< AddOnB< MixinBase > > >( a, b, c );    
    case 0x003001:
        return boost::make_shared< AddOnC< AddOnB< AddOnA< MixinBase > > > >( a, b, c );    
    case 0x402001:
        return boost::make_shared< AddOnD< AddOnC< AddOnA< MixinBase > > > >( a, b, c );    
    default:
        return boost::make_shared< MixinBase >( a, b, c );
    }
} 
```

不幸的是，这个 switch/case 语句很快就变得非常庞大，只需要几个标志。有一个更好的方法吗？可能使用模板元编程？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T12:41:14.133

这绝对是可能的，尽管并不简单：因为`flags`只在运行时知道，所以您需要将编译时和运行时计算交织在一起。

这是一个通用的解决方案，可以与任何基接口、基类和 mixins 一起使用：

```
// recursive case
template < typename Interface, typename BaseMixin, 
           typename It, typename End, typename WrappersToApply >
struct MixinCreatorIteration
{
  static boost::shared_ptr< Interface > apply( int flags )
  {
    typedef typename mpl::deref< It >::type               flag_to_wrapper;
    typedef typename mpl::first< flag_to_wrapper >::type  flag;
    typedef typename mpl::second< flag_to_wrapper >::type wrapper;

    if ( flags & flag::value )  // add current wrapper
    {
      return MixinCreatorIteration<
        Interface, 
        BaseMixin, typename
        mpl::next< It >::type,
        End, typename
        mpl::push_back<
          WrappersToApply,
          wrapper
        >::type
      >::apply( flags );
    }
    else                        // don't add current wrapper
    {
      return MixinCreatorIteration<
        Interface,
        BaseMixin, typename
        mpl::next< It >::type,
        End,
        WrappersToApply
      >::apply( flags );
    }
  }
};

//base case through partial template specialization
template < typename Interface, typename BaseMixin, 
           typename End, typename WrappersToApply >
struct MixinCreatorIteration< Interface, BaseMixin, 
                              End, End, WrappersToApply >
{
  static boost::shared_ptr< Interface > apply( int flags )
  {
    using mpl::placeholders::_1;
    using mpl::placeholders::_2;

    typedef typename
      mpl::fold<
        WrappersToApply,
        BaseMixin,
        mpl::apply1< _2, _1 >
      >::type mixin;

    return boost::make_shared< mixin >();
  }
};

template < typename Interface, typename BaseMixin, typename WrapperMap >
struct MixinCreator
{
  static boost::shared_ptr< Interface > apply( int flags )
  {
    return MixinCreatorIteration<
      Interface, 
      BaseMixin, typename
      mpl::begin< WrapperMap >::type, typename
      mpl::end< WrapperMap >::type,
      mpl::vector< >
    >::apply( flags );        
  }
}; 
```

这是一个示例用法，类似于您的示例：

```
boost::shared_ptr< MyInterface > create( int flags )
{
  using namespace mpl::placeholders;

  typedef mpl::map<
    mpl::pair< mpl::int_< 0x01 >, AddOnA<_> >,
    mpl::pair< mpl::int_< 0x02 >, AddOnB<_> >,
    mpl::pair< mpl::int_< 0x04 >, AddOnC<_> >
  > flag_to_wrapper;

  return MixinCreator< MyInterface, MixinBase, flag_to_wrapper >::apply( flags );
}

int main()
{
    create( 0x01 ); // creates AddOnA< MixinBase >
    create( 0x02 ); // creates AddOnB< MixinBase >
    create( 0x07 ); // creates AddOnC< AddOnB< AddOnA< MixinBase > > >
    create( 0x08 ); // creates MixinBase
} 
```

基本上，这个想法是将标志和包装器之间的关系存储到编译时数据结构（此处为 an `mpl::map`）并迭代此结构，保持包装器在此过程中应用。在迭代结束时，应用所有包装器并创建实例。

在您的示例中，构造需要参数：如果您可以使用 C++11，您可以轻松地调整我的解决方案以使用可变参数和完美转发；否则，您可以使用预处理器生成各种版本的`apply`函数（请参阅[Boost.Preprocessor](http://www.boost.org/doc/libs/release/libs/preprocessor/doc/index.html)了解如何执行此操作）。

# amazon-ec2 - amazon ses 与 Amazon EC2 网站：530 必须先发出 STARTTLS 命令

> ID：10807163
> 
> 赞同：0
> 
> 时间：2012-05-29T21:46:56.460
> 
> 标签：amazon-ec2

我正在尝试在 Amazon EC2 linux 服务器上使用 Amazon SES。我尝试了一切，我已经按照所有教程进行操作，但我无法在我的应用程序上使用我的 Amazon SES 中的 SMTP。

错误：SMTP 错误：无法验证。SMTP 错误消息：SMTP -> FROM SERVER:220 email-smtp.amazonaws.com ESMTP SimpleEmailService-222567251 SMTP -> FROM SERVER: 250-email-smtp.amazonaws.com 250-8BITMIME 250-SIZE 10485760 250-STARTTLS 250-AUTH PLAIN LOGIN 250 Ok SMTP -> ERROR: AUTH not accepted from server: 530 必须先发出 STARTTLS 命令 SMTP -> FROM SERVER:250 Ok SMTP 错误：无法验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:15:37.273

可以用telnet建立连接吗？

该线程有很多建议： [https ://forums.aws.amazon.com/message.jspa?messageID=301767](https://forums.aws.amazon.com/message.jspa?messageID=301767)

## 从该线程的大约 2/3 开始：

围绕 SSL 和 TLS 的术语有时在第三方文档中以不一致或令人困惑的方式使用。我相信您遇到的问题与这些库的功能集有关，而不是 SSL 和 TLS 工作方式之间的差异。建立安全连接的两种不同方式包括 STARTTLS 和握手协议。

STARTTLS 为文本协议（SMTP、IMAP、POP3 等）提供了一种在现有已建立的明文连接中使用 TLS/SSL 协商安全连接的方法。

握手协议（又名包装模式）支持在应用程序协议开始之前建立 TLS/SSL 连接。Amazon SES SMTP 接口当前需要握手协议并且不支持 STARTTLS。我们支持 SSL 3.0 和 TLS 1.0。

SSL 和 TLS 规范是有关握手协议的更多信息的良好来源： •SSL 3.0 规范 (RFC 6101) •TLS 1.0 规范 (RFC 2246) Net::SMTP::SSL 的文档声称它支持握手协议SSL，而 Net::SMTP::TLS 表明它只支持 STARTTLS 不支持 TLS 握手协议。我相信图书馆缺乏对握手协议的支持解释了为什么它不适合你。

# python - Windows中的Python时间格式不同

> ID：10807164
> 
> 赞同：21
> 
> 时间：2012-05-29T21:46:59.053
> 
> 标签：python, cross-platform

我可能错过了一个明显的平台差异，我应该适应但我在尝试做时间格式（Python2.7）时得到了这个......

在 Linux 环境中：

```
>>> import time
>>> time.strftime("%a, %d-%b-%Y %T GMT", time.gmtime())
'Tue, 29-May-2012 21:42:04 GMT' 
```

在 Windows 中：

```
>>> import time
>>> time.strftime("%a, %d-%b-%Y %T GMT", time.gmtime())
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: Invalid format string 
```

从 time.gmtime() 返回的元组似乎是相同的，所以我不完全确定我需要更改什么。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-29T21:51:05.607

通常，您会发现 python`time.strftime()`支持与其运行的平台（或者更具体而言是该平台的 libc）相同的格式说明符集。但是，其中只有一部分是可移植的。有关列表，请参阅[http://docs.python.org/library/time.html](http://docs.python.org/library/time.html)。引用文档：

> 某些平台可能支持其他指令，但只有此处列出的指令具有 ANSI C 标准化的含义。

在这种情况下，`%T`可以替换为`%H:%M:%S`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:53:45.650

我没有看到[Python 文档](http://docs.python.org/library/time.html?highlight=strftime#time.strftime)`%T`中列出的格式指令- 不能在 Windows 平台上使用/实现（我刚刚尝试使用 Python v2.7.3 和 3.2.3）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-14T14:39:04.887

我发现我遇到了这个问题，因为 MacOS 支持`"%D"`，我不得不将其替换`"%m/%d/%Y"`为跨平台。一般来说，组合“简单”格式的字符串`%m`似乎比使用“聚合”字符串如`%T`or更安全`%D`。

# php - 你调用的对象是空的。php

> ID：10807169
> 
> 赞同：3
> 
> 时间：2012-05-29T21:47:37.080
> 
> 标签：php, .net, web-services, soap

我知道这个“对象引用未设置为对象的实例”已经出现了很多，但我看过的所有答案似乎都没有帮助我。

这是我的 WSDL：[https ://app.20-20insights.com/testepos/servicetrx.svc?wsdl](https://app.20-20insights.com/testepos/servicetrx.svc?wsdl)

我正在尝试调用 BeginTrx() 函数，但出现错误。

非常感谢任何建议或帮助。

谢谢，马丁。

设置 TrxIdentifier 对象

```
$trxIdentifier = new TrxIdentifier;

$trxIdentifier->ClientId = 9372490002639296;
$trxIdentifier->DeviceId = "123";
$trxIdentifier->OpId = "123";
$trxIdentifier->PosDescription = "123";
$trxIdentifier->PosId = "123";
$trxIdentifier->PosTxnId = "123";
$trxIdentifier->SiteId = "12312";
$trxIdentifier->Token = "3";
$trxIdentifier->TrxdateTime = new DateTime; 
```

正在执行呼叫...

```
$client = new SoapClient($wsdl,  array('trace'=>true,
'exceptions'=>true,
'classmap'=>array('TrxIdentifier'=>"TrxIdentifier", 'MemberInfo'=>"MemberInfo", 'Response'=>"Response", 'MemberDetail'=>"MemberDetail")));

$response = $client->BeginTrx($trxIdentifier ); 
```

错误 ：

```
Object reference not set to an instance of an object.
a:InternalServiceFaultObject reference not set to an instance of an object.Object reference not set to an instance of an object. at CatalystSpsTrx.Contracts.Service.ServiceTrx.BeginTrx(MemberInfo& mem, TrxIdentifier conTrx) in C:\Projects\2010\CatTrxServices\CatalystSpsTrx.Contracts\Service\ServiceTrx.cs:line 38
 at _dynamic_CatalystSpsTrx.Contracts.Service.ServiceTrx.BeginTrx(Object , Object[] )
 at Spring.Reflection.Dynamic.SafeMethod.Invoke(Object target, Object[] arguments)
 at Spring.Aop.Framework.DynamicMethodInvocation.InvokeJoinpoint()
 at Spring.Aop.Framework.Adapter.AfterReturningAdviceInterceptor.Invoke(IMethodInvocation invocation)
 at Spring.Aop.Framework.Adapter.ThrowsAdviceInterceptor.Invoke(IMethodInvocation invocation)
 at CompositionAopProxy_d0e73463863e4ccd9c2db0a96530bd0d.BeginTrx(MemberInfo& mem, TrxIdentifier conTrx)
 at ServiceTrx.BeginTrx(MemberInfo& mem, TrxIdentifier conTrx)
 at SyncInvokeBeginTrx(Object , Object[] , Object[] )
 at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]& outputs)
 at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc)
 at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc& rpc)
 at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc& rpc)
 at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)System.NullReferenceException 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T10:44:57.423

发生该错误是因为您的输入结构错误。您的 WSDL 声明必须以这种方式调用它：

```
$response = $client->BeginTrx(array('trx' => $trxIdentifier)); 
```

看一下 WSDL，这里是 service 的根输入定义`BeginTrx`：

```
<wsdl:message name="IServiceTrx_BeginTrx_InputMessage">
    <wsdl:part name="parameters" element="tns:BeginTrx"/>
</wsdl:message> 
```

如您所见，输入的类型为`BeginTrx`。如果您遵循 WSDL，您会发现它被定义为：

```
<xs:element name="BeginTrx">
    <xs:complexType>
        <xs:sequence>
            <xs:element minOccurs="0" name="trx" nillable="true" type="tns:TrxIdentifier"/>
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

所以你可以看到它`BeginTrx`有一个参数名称`trx`和一个值类型`TrxIdentifier`。

再次遵循 WSDL，`TrxIdentifier`定义为：

```
<xs:complexType name="TrxIdentifier">
    <xs:sequence>
    <xs:element minOccurs="0" name="ClientId" type="xs:int"/>
    <xs:element minOccurs="0" name="DeviceId" nillable="true" type="xs:string"/>
    .................
    </xs:sequence>
</xs:complexType> 
```

# gridview - asp.net gridview viewstate，数据太多（溢出）

> ID：10807172
> 
> 赞同：0
> 
> 时间：2012-05-29T21:47:58.537
> 
> 标签：gridview, viewstate

我在页面中有一个gridview。填写实体列表。名单很大。我想保留它以进行分页和排序。但似乎我的视图状态中有太多数据。

你有一个想法来解决仍然使用视图状态的溢出。

保护你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:37:43.747

您应该使用视图状态压缩，请参阅链接：

[http://www.codeproject.com/Articles/14733/ViewState-Compression](http://www.codeproject.com/Articles/14733/ViewState-Compression)

# c# - 未输出 XmlDocument 前缀

> ID：10807173
> 
> 赞同：1
> 
> 时间：2012-05-29T21:48:07.817
> 
> 标签：c#, xmldocument

我正在尝试在新的 XMLDocument 中的几个 xmlnodes 上添加前缀（100% 从头开始​​创建，而不是从文件加载等）。

用最简单的话来说，我有这个：

```
XmlDocument doc = new XmlDocument();
XmlElement RootElement = (XmlElement)doc.AppendChild(doc.CreateElement("root"));
foreach (string line in CSV)
{
    XmlElement navPointElement = (XmlElement) RootElement.AppendChild(doc.CreateElement("navPoint"));
    XmlElement navPointTypeElement =(XmlElement) navPointElement.AppendChild(doc.CreateElement("type"));
    navPointTypeElement.Prefix = "acp";
    navPointTypeElement.InnerText = nodeCount == 0 ? "cover" : "article";
} 
```

还有更多代码，但这让您了解我在做什么。现在文档输出正常，但它完全跳过了前缀声明。我已经阅读了有关定义名称空间的信息，但我尝试了以下操作无济于事。

```
XmlNamespaceManager ns = new XmlNamespaceManager(doc.NameTable);
ns.AddNamespace("acp", "http://www.namespace.com"); 
```

我确信这很简单，但我找不到任何关于它的文档。xmldocument 前缀的 MSDN 文档只是简单地添加了前缀，就像我在不需要名称空间的情况下所做的一样（或者至少他们在代码示例中是这样显示的）。

任何帮助深表感谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:07:25.340

好吧，你确实需要一个命名空间。like`<acp:type/>`本身是无效的，因为`acp`它没有映射到任何命名空间，这是前缀应该做的。

您需要做的是在元素的 CreateElement 调用中为要添加的元素设置命名空间`type`。

```
public class StackOverflow_10807173
{
    public static void Test()
    {
        XmlDocument doc = new XmlDocument();
        XmlElement RootElement = (XmlElement)doc.AppendChild(
            doc.CreateElement("root"));
        string[] CSV = "hello world how are you".Split(' ');
        int nodeCount = 0;
        XmlAttribute xmlnsAttr = doc.CreateAttribute(
            "xmlns", "acp", "http://www.w3.org/2000/xmlns/");
        string acpNamespace = "http://www.namespace.com";
        xmlnsAttr.Value = acpNamespace;
        RootElement.Attributes.Append(xmlnsAttr);
        foreach (string line in CSV)
        {
            XmlElement navPointElement = (XmlElement)RootElement.AppendChild(
                doc.CreateElement("navPoint"));
            XmlElement navPointTypeElement = (XmlElement)navPointElement.AppendChild(
                doc.CreateElement("type", acpNamespace)); // namespace here
            navPointTypeElement.Prefix = "acp";
            navPointTypeElement.InnerText = nodeCount == 0 ? "cover" : "article";
        }

        Console.WriteLine(doc.OuterXml);
    }
} 
```

注意：您实际上并不需要在根元素中添加命名空间；只是如果您不这样做，您将`xmlns:acp="yournamespace"`在所有`type`元素中拥有该属性（因为该前缀不在范围内）。在父元素中添加它使得在子元素中添加它是不必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T21:55:23.003

我遇到了类似的问题，我发现内置的 .NET System.XML 对象无法满足我的需求。

我需要使用 NAXML 标记在我们的 POS 系统中创建燃料价格变化记录。 ***一些***元素需要一个“nax”前缀，而另一些则不需要。System.Xml 对象似乎想将其添加到***所有***元素或***none***。我无法将它们仅应用于我需要的元素。

因为 System.XML 对象没有给我所需的精细控制，我最终不得不使用 System.Text.StringBuilder 手动写出 Xml。

我的应用程序中的示例代码可让您了解如何操作：

```
System.Text.StringBuilder sb = new StringBuilder("<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n");
sb.Append("<FuelPriceMaintenanceRequest xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"http://www.POSVENDOR.com/NAXML-Extension\" xmlns:nax=\"http://www.naxml.org/POSBO/Vocabulary/2003-10-16\" xsi:schemaLocation=\"http://www.POSVENDOR.com/NAXML-Extension FuelPriceMaintenance.xsd\">\r\n");
sb.Append("  <nax:TransmissionHeader>\r\n");
sb.Append("    <nax:StoreLocationID>" + StoreNumber.ToString() + "</nax:StoreLocationID>\r\n");
sb.Append("  </nax:TransmissionHeader>\r\n");
...snip...
sb.Append("</FuelPriceMaintenanceRequest>"); 
```

# django - Django 新手：python manage.py syncdb 错误？

> ID：10807174
> 
> 赞同：2
> 
> 时间：2012-05-29T21:48:13.373
> 
> 标签：django, sqlite

目前正在处理 Django 教程，并在尝试时遇到此错误：

```
python manage.py syncdb 
```

使用 sqlite3

```
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/Library/Python/2.6/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/Library/Python/2.6/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Library/Python/2.6/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/Library/Python/2.6/site-packages/django/core/management/base.py", line 232, in execute
    output = self.handle(*args, **options)
  File "/Library/Python/2.6/site-packages/django/core/management/base.py", line 371, in handle
    return self.handle_noargs(**options)
  File "/Library/Python/2.6/site-packages/django/core/management/commands/syncdb.py", line 57, in handle_noargs
    cursor = connection.cursor()
  File "/Library/Python/2.6/site-packages/django/db/backends/__init__.py", line 306, in cursor
    cursor = self.make_debug_cursor(self._cursor())
  File "/Library/Python/2.6/site-packages/django/db/backends/sqlite3/base.py", line 281, in _cursor
    self._sqlite_create_connection()
  File "/Library/Python/2.6/site-packages/django/db/backends/sqlite3/base.py", line 271, in _sqlite_create_connection
    self.connection = Database.connect(**kwargs)
sqlite3.OperationalError: unable to open database file 
```

我的 settings.py 文件内容如下：

```
 'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': '/Users/username/django_tutorial/mysite', 
```

有人知道这里的问题吗？好像我正在放入完整的文件目录，但仍然无法创建数据库？):

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:50:45.523

您应该使用文件的路径，包括文件名：

```
 'NAME': '/Users/username/django_tutorial/mysite/data.sqlite', 
```

您也可以只给它文件名：

```
 'NAME': 'data.sqlite', 
```

在这种情况下，它将在与您运行的目录相同的目录中创建`manage.py`。

最佳实践是传递一个绝对路径，但要确保这个绝对路径是相对于设置文件创建的。例如：

```
import os

SETTINGS_DIR = os.path.dirname(os.path.abspath(__file__)) 
```

然后是后者：

```
 'NAME': os.path.join(SETTINGS_DIR, 'data.sqlite'), 
```

请记住，设置文件是 Python 文件，您可以在其中使用 Python 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T00:29:33.283

项目的 wiki 上有一个 Django 新手错误列表。请参阅此条目：[https ://code.djangoproject.com/wiki/NewbieMistakes#DjangosaysUnabletoOpenDatabaseFilewhenusingSQLite3](https://code.djangoproject.com/wiki/NewbieMistakes#DjangosaysUnabletoOpenDatabaseFilewhenusingSQLite3)

这个特定的错误是 Django 新手的常见错误。请参阅下面的详细说明。

> **问题**
> 
> 您使用的是 SQLite3，您`DATABASE_NAME`的设置为数据库文件的完整路径，数据库文件可由 Apache 写入，但仍然出现上述错误。
> 
> **解决方案**
> 
> 确保 Apache 也可以写入数据库的父目录。SQLite 需要能够写入此目录。
> 
> 确保数据库文件完整路径的每个文件夹不以数字开头，例如。`/www/4myweb/db`（在 Windows 2000 上观察）。
> 
> 如果`DATABASE_NAME`设置为类似 `'/Users/yourname/Sites/mydjangoproject/db/db'`，请确保您`db`首先创建了 ' ' 目录。
> 
> 确保您的`/tmp`目录是全局可写的（这是一个不太可能的原因，因为您系统上的其他东西也不起作用）。`ls /tmp -ald`应该产生`drwxrwxrwt`....
> 
> 确保 中指定的数据库`settings.py`路径是完整路径。
> 
> 如果您在 Windows 上工作，请确保您的 db 目录的路径用双反斜杠编写
> 
> ```
> 'C:\\django\\sqlite\\django.db' 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:44:40.100

我认为您不需要名称的完整路径，只需输入文件名，即“my_db.db”。那是假设你已经安装了 sqlite3。

# google-app-engine - 为来自 appengine 的 freebase 查询设置 api 密钥

> ID：10807184
> 
> 赞同：2
> 
> 时间：2012-05-29T21:49:38.643
> 
> 标签：google-app-engine, freebase, api-key

我已按照以下说明操作：[https](https://developers.google.com/console/help/#generatingdevkeys/) ://developers.google.com/console/help/#generatingdevkeys/ 。我注册了 freebase 服务并将浏览器应用程序的简单 API 密钥添加到查询中：[https](https://api.freebase.com/api/service/mqlread?key=keygoeshere&query=) ://api.freebase.com/api/service/mqlread?key=keygoeshere&query= {MQLquery}

然后我收到以下错误：

```
 {u'code': 100, u'message': u'Invalid API Key (Key not found)', u'stat': u'fail'} 
```

如果我从查询中删除密钥，它在本地工作但远程我得到：[freebase api error on deployment to appengine: DownloadError: ApplicationError: 2](https://stackoverflow.com/questions/10800245/freebase-api-error-on-deployment-to-appengine-downloaderror-applicationerror)。我认为这是由于freebase阻止了appengine，因为密钥未注册或识别

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:15:18.573

文档说旧的`http://api.freebase.com`API[已被弃用](http://wiki.freebase.com/wiki/Freebase_API)（第一段）。

您应该通过 google url 访问 Freebase：`https://www.googleapis.com/freebase/v1/search?q=bob&key=<YOUR_API_KEY>`

# java - Eclipse Java 小程序的 .au 声音剪辑文件的正确位置

> ID：10807189
> 
> 赞同：0
> 
> 时间：2012-05-29T21:50:10.220
> 
> 标签：java, audio, applet

这个问题应该很简单，尽管我显然很想念它。我有一个带有图像和声音剪辑的 Java 小程序。所有图像都正确显示并且它们在 /bin 文件中。

但是，声音剪辑也在 /bin 文件中，根本不播放。

问题是： 1) 这个声音片段的代码片段格式是否正确？

mySound = getAudioClip(getDocumentBase(), "OnPoint.au");

和 2) 声音剪辑应该放在哪里，不是 /bin 文件夹吗？

下面是代码，请指教，谢谢！

```
import java.net.*;
import java.io.*;
import java.lang.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.Frame;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.MediaTracker;
import java.applet.Applet;
import java.applet.AudioClip; 
```

导入 java.util.*；// 定时器在这个库中

```
public class bTrainAnimation extends Applet
{
private Image trainAndBush[];    // "Image" is inherited
private int totalImages = 17,    // total number of images in array
currentImage = 0,                // set current image array subscript to 0
sleepTime = 500;                 //  milliseconds to sleep
MediaTracker myImageTracker;     // "MediaTracker" is inherited
Timer myTimer;                // "Timer" is inherited
private AudioClip mySound;    // "AudioClip" is a inherited

public void init()
{
 // load the images when the applet begins executing
setSize(400,400);
mySound = getAudioClip(getDocumentBase(), "OnPoint.au");
myTimer = new Timer(true);
myTimer.schedule(
    new TimerTask()
    {
        public void run() // "run" is action performed by timer task
        {
            repaint(); 
                    }
    }
           ,0,sleepTime); // global VAR "sleepTime" = 500 milliseconds

// create array of all the images in slide show
  trainAndBush = new Image[ totalImages ];    // global VAR "totalImages" = 17 images
  myImageTracker = new MediaTracker( this ); 
  for( int i = 0; i < trainAndBush.length; i++ )
   {
   trainAndBush[i] = getImage(getDocumentBase(), // load an image in an applet 
     "Hill" + (i + 1 ) + ".jpg" );  

 // track loading image
 myImageTracker.addImage(trainAndBush[i], i);
   }

    try
     {
       catch ( InterruptedException e ){}
       mySound.play();
     }

 public void start(Graphics g)
 {
g.drawImage(trainAndBush[0],50,50,300,300, this );
currentImage = 1;       
 public void paint(Graphics g)
  {
{
if (myImageTracker.checkID(currentImage, true))
          {
      g.drawImage(trainAndBush[ currentImage ],50,50,300,300, this );
      if (currentImage == 0 )
        trainAndBush[ totalImages -1].flush();

        else trainAndBush [ currentImage -1].flush();
        currentImage = ++currentImage % totalImages;
      }
     else
            postEvent( new Event( this, Event.MOUSE_ENTER, ""));
       }
   }
 // override update to eliminate flicker
  public void update(Graphics g)
   {
  paint( g );
   }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:22:53.557

很难通过格式阅读您的代码，但我会尽力回答。（如果您更新/编辑您的问题，我会尝试更新/编辑我的答案）：

我不确定你从哪里得到“bin”目录的想法。如果这适用于图像，那么还有其他事情正在发生。

现在，我已经有一段时间没有这样做了，但我对[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/applet/Applet.html)的解释是：

getDocumentBase() 为您提供包含页面的 URL，因此如果您的 applet 包含在[http://example.com/folder/hello.html](http://example.com/folder/hello.html)中，那么这就是 getDocumentBase() 为您提供的。

如果您的音频位于

[http://example.com/folder/audio/OnPoint.au](http://example.com/folder/audio/OnPoint.au)

那么您的代码将如下所示：

mySound = getAudioClip(getDocumentBase().parent().child("audio"), "OnPoint.au")

请注意，Java 的 URL 类没有 parent() 和 child() 函数（这太容易了！），我只是为了解释的目的编造了它并包含它。

# java - 使用正则表达式将大写 html 属性转换为小写 html 属性

> ID：10807191
> 
> 赞同：1
> 
> 时间：2012-05-29T21:50:26.477
> 
> 标签：java, html

我正在尝试将大写的 html 属性转换为小写，以使我的文档符合 XHTML 1.0 ADA 合规标准。

但我无法获得所需的输出。以下是我用来执行此操作的代码片段。请帮助我。

```
private static String LowerCaseAttributes(String htmlfile){

        String[] attributes = new String[] { 
        "border-bottom", "margin", "padding","bgcolor","width", "border", 
        "style", "alt", "title", "for", "col", "header", "clear", 
        "colspan", "rows", "cols", "type", "name", "id", "target", "method" 
        }; 

        for(String s1 : attributes){ 
            htmlfile = htmlfile.replace(s1.toUpperCase() + "=", s1 + "="); 
        } 
        return htmlfile; 
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:06:03.223

我认为问题在于您在替换方法中使用了“=”，而在您的输入中它有“：”。

试试这个：

```
 for(String s1 : attributes){ 
        htmlfile = htmlfile.replaceAll(s1.toUpperCase() + ":", s1 + ":"); 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:23:02.453

正如@c0deNinja 所说，您需要使用`:`而不是`=`. 此外，您定义的属性列表仅`BORDER-BOTTOM`与您在评论中提供的示例字符串匹配。其余项目`BORDER-LEFT,BACKGROUND-COLOUR`等不在您定义为的属性列表中`String[]`。所以你可能没有看到这些。尝试添加整个列表。

# jquery - jQuery Uncaught TypeError: 对象 [object Window] 的属性“$”不是函数

> ID：10807200
> 
> 赞同：92
> 
> 时间：2012-05-29T21:50:46.273
> 
> 标签：jquery

全部，我下载了一个预先捆绑的 JS/CSS 表单应用程序，我正在尝试在 Wordpress 中使用它。我有以下代码：

```
$(document).ready(function () {

/*----------------------------------------------------------------------*/
/* Parse the data from an data-attribute of DOM Elements
/*----------------------------------------------------------------------*/

$.parseData = function (data, returnArray) {
    if (/^\[(.*)\]$/.test(data)) { //array
        data = data.substr(1, data.length - 2).split(',');
    }
    if (returnArray && !$.isArray(data) && data != null) {
        data = Array(data);
    }
    return data;
};

/*----------------------------------------------------------------------*/
/* Image Preloader
/* http://engineeredweb.com/blog/09/12/preloading-images-jquery-and-javascript
/*----------------------------------------------------------------------*/

// Arguments are image paths relative to the current page.
$.preload = function() {
    var cache = [],
        args_len = arguments.length;
    for (var i = args_len; i--;) {
        var cacheImage = document.createElement('img');
        cacheImage.src = arguments[i];
        cache.push(cacheImage);
    }
};

/*----------------------------------------------------------------------*/
/* fadeInSlide by revaxarts.com
/* Fades out a box and slide it up before it will get removed
/*----------------------------------------------------------------------*/

$.fn.fadeInSlide = function (speed, callback) {
    if ($.isFunction(speed)) callback = speed;
    if (!speed) speed = 200;
    if (!callback) callback = function () {};
    this.each(function () {

        var $this = $(this);
        $this.fadeTo(speed / 2, 1).slideDown(speed / 2, function () {
            callback();
        });
    });
    return this;
};

/*----------------------------------------------------------------------*/
/* fadeOutSlide by revaxarts.com
/* Fades out a box and slide it up before it will get removed
/*----------------------------------------------------------------------*/

$.fn.fadeOutSlide = function (speed, callback) {
    if ($.isFunction(speed)) callback = speed;
    if (!speed) speed = 200;
    if (!callback) callback = function () {};
    this.each(function () {

        var $this = $(this);
        $this.fadeTo(speed / 2, 0).slideUp(speed / 2, function () {
            $this.remove();
            callback();
        });
    });
    return this;
};

/*----------------------------------------------------------------------*/
/* textFadeOut by revaxarts.com
/* Fades out a box and slide it up before it will get removed
/*----------------------------------------------------------------------*/

$.fn.textFadeOut = function (text, delay, callback) {
    if (!text) return false;
    if ($.isFunction(delay)) callback = delay;
    if (!delay) delay = 2000;
    if (!callback) callback = function () {};
    this.each(function () {

        var $this = $(this);
        $this.stop().text(text).show().delay(delay).fadeOut(1000,function(){
            $this.text('').show();
            callback();
        })
    });
    return this;
};

/*----------------------------------------------------------------------*/
/* leadingZero by revaxarts.com
/* adds a leding zero if necessary
/*----------------------------------------------------------------------*/

$.leadingZero = function (value) {
    value = parseInt(value, 10);
    if(!isNaN(value)) {
        (value < 10) ? value = '0' + value : value;
    }
    return value;
};

}); 
```

我假设 Wordpress 没有冲突导致问题，所以我更新了最后一个括号，如下所示：

```
}, "jQuery"); 
```

但是，我仍然遇到同样的错误。有谁知道什么会导致这个问题以及如何解决它？

提前致谢！

* * *

## 回答 #1

> 赞同：260
> 
> 时间：2012-05-29T21:53:41.700

这是一个语法问题，WordPress 附带的 jQuery 库以“无冲突”模式加载。这是为了防止与 WordPress 可以加载的其他 javascript 库的兼容性问题。在“无冲突”模式下，$快捷方式不可用，使用较长的jQuery，即

```
jQuery(document).ready(function ($) { 
```

通过在函数调用后的括号中包含 $，您可以在代码块中使用此快捷方式。

有关详细信息，请参阅[WordPress Codex](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-05-29T21:53:01.903

我最喜欢的无冲突友好结构：

```
jQuery(function($) {
  // ...
}); 
```

使用函数指针调用 jQuery 是 $(document).ready(...) 的快捷方式

或者正如我们在咖啡脚本中所说：

```
jQuery ($) ->
  # code here 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-30T06:58:24.383

在 Wordpress 中只需替换

```
$(function(){...}); 
```

和

```
jQuery(function(){...}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-26T10:24:20.460

您可以考虑将默认的 WordPress jQuery 脚本替换为 Google 库，方法是将以下内容添加到主题 functions.php 文件中：

```
function modify_jquery() {
    if (!is_admin()) {
        wp_deregister_script('jquery');
        wp_register_script('jquery', 'http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js', false, '1.10.2');
        wp_enqueue_script('jquery');
    }
}
add_action('init', 'modify_jquery'); 
```

Code taken from here: [http://www.wpbeginner.com/wp-themes/replace-default-wordpress-jquery-script-with-google-library/](http://www.wpbeginner.com/wp-themes/replace-default-wordpress-jquery-script-with-google-library/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-03T23:27:18.147

也许你在 jquery 之前有这样的代码：

```
var $jq=jQuery.noConflict();
$jq('ul.menu').lavaLamp({
    fx: "backout", 
    speed: 700
}); 
```

他们是冲突

您可以将 $ 更改为 (jQuery)

# opencv - opencv更新单应矩阵以适应两倍大小的图像

> ID：10807216
> 
> 赞同：6
> 
> 时间：2012-05-29T21:52:12.953
> 
> 标签：opencv

我正在使用光流进行视频稳定。为了使 calcOpticalFlowPyrLK 工作得更快，我将原始图像缩小 2 倍并在其上运行该函数。

如何修改单应矩阵（通过 findHomography 检索）以能够对原始的、更大的图像进行 warpPerspective。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-23T23:45:00.967

这有点晚了，你的答案很好，但我要补充一件事。我不喜欢将 getPerspectiveTransform 之类的功能视为理所当然。在这种情况下，很容易自己制作矩阵。2 次方的图像缩小很容易。假设您有一个点，并且您想将其移动到分辨率为两倍的图像上。

```
float newx = (oldx+.5)*2 - .5;
float newy = (oldy+.5)*2 - .5; 
```

相反，要转到分辨率一半的图像...

```
float newx = (oldx+.5)/2 - .5;
float newy = (oldy+.5)/2 - .5; 
```

如果需要，请给自己画一个图表并说服自己它有效，记住 0 索引。与其考虑让您的转换在其他分辨率上工作，不如考虑将每个点移动到您的转换的分辨率，然后使用您的转换，然后将其移回。幸运的是，您可以在 1 个矩阵中完成所有这些操作，我们只需要构建该矩阵！首先为三个步骤中的每一个构建一个矩阵

```
//move point to an image of half resolution, note it is equivalent to the above equation
project_down=(.5,0,-.25,
               0,.5,-.25,
               0, 0,  1)

//move point to an image of twice resolution, these are inverses of one another
project_up=(2,0,.5,
            0,2,.5,
            0, 0,1) 
```

要进行最终转换，只需将它们结合起来

```
final_transform = [project_up][your_homography][project_down]; 
```

好消息是对于任何给定的单应性，您只需执行一次此操作。这应该与 getPerspectiveTransform 一样工作（并且可能运行得更快）。希望理解这一点可以帮助您处理可能遇到的有关图像分辨率更改的其他问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T22:07:10.740

假设 B 是您计算的变换，您可以将 B 乘以另一个单应性 A，得到 AB = C，其中 C 是进行两种变换的单应性，这相当于先应用 B，然后应用 A。要找到 A，您可以使用[getPerspectiveTransform](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html?#getperspectivetransform)。

**编辑：** AB 我的意思是矩阵乘法，而不是元素乘法。

**编辑2：**要获得A，您将两个图像的四个角以相同的顺序传递给[getPerspectiveTransform](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html?#getperspectivetransform)，这样下采样图像的角是源点，原始图像的角是目标点。

# rest - 树结构的 REST URI 设计

> ID：10807222
> 
> 赞同：11
> 
> 时间：2012-05-29T21:52:36.050
> 
> 标签：rest, tree, uri

有很多关于 REST URI 设计的讨论，但没有人准确回答我的问题。

假设我有一些包含任务和/或其他列表的列表（列表 = 节点和任务 = 叶）。

我们可以有类似的东西

```
/lists/{id_list1}/lists/{id_list2}/lists/{id_list3}/tasks/{id_task1} 
```

或者更短的版本：

```
/lists/{id_list1}/{id_list2}/{id_list3}/{id_task1} 
```

但是真的很深的树呢？

我也在考虑可以翻译成这样的父/子关系

```
/lists/{id_list_parent}/{id_list_or_task_child} 
```

但我觉得少了点什么……

REST URI 树的智能设计是什么？

编辑

对不起我迟到的答案！

所以我想我混合了两个需求：API URI 和浏览器 URI。

这是我看待事物的方式：

在 API 方面，我将只有那些用于写入和读取方法的 URI（不需要末尾的“/id”，例如创建）：

```
/lists/id
/tasks/id 
```

然而，在我的浏览器上，我会有这样的东西：

```
/lists/id/lists/id/tasks/ 
```

服务器只解释第一部分（/lists/id），我的客户端javascript将使用第二部分（lists/id/tasks/）来查找从服务器接收到的列表的子列表的任务.

您如何看待这种方法，感觉有什么不对吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T22:04:20.320

是否需要通过 URI 表示树？当它们可以简单地引用节点本身并且通过超媒体类型中的链接建模关系时。

除此之外，我认为是这样的：

```
/lists/{nodeId}/children 
```

它可以将直接子代的列表返回给父代。

您还可以执行以下操作：

```
/lists/{nodeId}/children?depth=3 
```

并在结果中返回树的下三个级别。

```
/lists/{nodeId}/children?depth=infinite 
```

可以从该节点返回整个分支。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:04:17.933

使用 URI 来强制执行此约束似乎不正确。我会接受具有某种有效负载（JSON、XML 等）的 PUT 请求。

`PUT /tasklist`

```
lists: [{
   id: 1234,
   id: 12345,
   tasks: [{
      id: foo,
      id: bar,
      id: baz
   }]
}] 
```

该 URL 似乎表明您在这里尝试做的太多（恕我直言）。通常，您将与单个资源进行交互，而您的用例意味着您同时在多个上下文分层资源上进行操作。

# .net - .NET - 会话对象在静态方法中为空

> ID：10807224
> 
> 赞同：1
> 
> 时间：2012-05-29T21:52:47.567
> 
> 标签：.net, session, static

我一直在尝试为我的一些类实现一个静态的“Current”属性，使其表现得像 HttpContext.Current 属性。那些仅依赖于上下文或请求标头的行为正常。但是，那些依赖于当前 Session 对象的失败。在这些情况下，Session 对象似乎为空：

```
// THIS WORKS
private static HttpContext Context { get { return HttpContext.Current; } }

// THIS APPEARS TO YIELD NULL
private static HttpSessionState Session { get { return HttpContext.Current.Session; } }

public static EducationalUnit Current
{
    get
    {
        if (Context.Items["EducationalUnit.Current"] == null)
        {
            SetCurrent();
        }
        return (EducationalUnit)Context.Items["EducationalUnit.Current"];
    }

    set
    {
        Context.Items["EducationalUnit.Current"] = value;
    }
} // Current

// I've tried a few things here, to scope out the status of the Session:
private static void SetCurrent()
{
    // shows "null"
    throw new Exception(Session);

    // shows "null"
    throw new Exception(Session.SessionID);

    // also shows "null"
    throw new Exception(HttpContext.Current.Session);

    // shows "Object reference not set to an instance of an object."
    throw new Exception(HttpContext.Current.Session.SessionID);

    // this, however, properly echos my cookie keys!
    JavaScriptSerializer js = new JavaScriptSerializer();
    throw new Exception(js.Serialize(Context.Request.Cookies.Keys.ToString()));

} // SetCurrent() 
```

在我的一生中，我无法从 SetCurrent() 方法中获取会话。

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T00:26:44.780

非常简单的答案：在 Session 初始化之前，某个地方（不确定是什么）正在访问 EducationalUnit.Current。在添加条件以测试 Session 是否为 null 并且默默地什么都不做时，错误消失了，一切正常。

无论是什么击中 EducationalUnit.Current 可能都不需要，因为它似乎不会影响任何东西......

感谢您的反馈！

附录：当 EducationalUnit.Current 被 Page 属性间接命中时，问题就出现了：

```
public partial class client_configuration : System.Web.UI.Page
{
    //
    // The problem occurs here:
    //

    private Client c = Client.Current;

    //
    // Client objects refer to EducationalUnit.Current, which attempts
    // to use the Session, which doesn't exist at Page instantiation time.
    // 
    // (The assignment can safely be moved to the Page_Load event.)
    //

    protected void Page_Load(object sender, EventArgs e)
    {
        // etc.
    }
} 
```

这是最终的（工作的）EducationalUnit 代码：

```
private static HttpContext Context { get { return HttpContext.Current; } }
private static HttpSessionState Session { get { return HttpContext.Current.Session; } }

public static EducationalUnit Current
{
    get
    {
        if (Context.Items["EducationalUnit.Current"] == null)
        {
            SetCurrent();
        }
        return (EducationalUnit)Context.Items["EducationalUnit.Current"];
    }

    set
    {
        Context.Items["EducationalUnit.Current"] = value;
    }
} // Current

private static void SetCurrent()
{
    if (Session == null)
    {
        throw new Exception("Session is not initialized!");
    }
    else
    {
        try
        {
            Guid EUID = new Guid(Session["classroomID"].ToString());
            Current = new EducationalUnit();
            Current.GetDetails(EUID);
        }
        catch
        {
            Current = new EducationalUnit();
        }
    }
} // SetCurrent() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:57:03.180

尝试`HttpContext.Current.Session`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:08:07.173

您的问题是，虽然 HttpContext.Current 是静态属性，但它返回的对象的属性不是。当您尝试 时`private static HttpSessionState Session { get { return HttpContext.Current.Session; } }`，该值将填充在第一个引用上，此后永远不会更新。因此，您将获得 HttpContext.Current.Session 持有的第一个值。它保持空值，即没有引用，因此它没有对对象的引用，并且您对该属性的调用将始终返回空值。我只能告诉你不要那样做。

此外，根据您的类在链中被调用的位置，它可能无法访问任何有用的值。通常对于静态类，让方法将 HttpContext 作为参数更安全。

好的......让我们看看 Session 的实际工作原理，在幕后你所拥有的是：

```
 SessionStateModule  _sessionStateModule;    // if non-null, it means we have a delayed session state item

    public HttpSessionState Session { 
        get {  
            if (_sessionStateModule != null) { 
                lock (this) {  
                    if (_sessionStateModule != null) {  
                        // If it's not null, it means we have a delayed session state item 
                        _sessionStateModule.InitStateStoreItem(true);  
                        _sessionStateModule = null; 
                    } 
                } 
            }  

            return (HttpSessionState)Items[SessionStateUtility.SESSION_KEY];  
        }  
    }

    public IDictionary Items {  
        get {  
            if (_items == null) 
                _items = new Hashtable();  

            return _items; 
        } 
    } 
```

请注意，它在其链中的任何地方都不是静态的。Web 应用程序遵循特定的生命周期，并且会话可能并不总是存在，具体取决于您在生命周期中的哪个位置......（超时。待续。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-22T09:10:21.483

这可能与所提出的问题无关，但可能对某人有所帮助。

我有一个`Generic Handler (.ashx)`正在发送一些用户控件的输出，而这些用户控件又具有对象数据源，这些对象数据源是静态方法（在静态类中）。这些静态方法利用了会话对象。通过。`HttpContext.Current.Session`.

但是，该`Session`对象为空。

进一步发现，我发现当你使用通用处理程序时，如果你想访问会话对象，你必须`IReadOnlySessionState`在处理程序类上实现一个标记接口。作为

```
 public class AjaxHandler : IHttpHandler, IReadOnlySessionState
        {
         public void ProcessRequest(HttpContext context)
            {
            /* now both context.Session as well as 
    HttpContext.Current.Session will give you session values.
    */
            string str = AjaxHelpers.CustomerInfo();

            }

        }

public static class AjaxHelpers
    {
        public static string CustomerInfo()
        {
           //simplified for brevity.
return HttpContext.Current.Session["test"];

        }
    } 
```

# java - 如果将非法参数传递给 API 方法，何时抛出异常？

> ID：10807229
> 
> 赞同：4
> 
> 时间：2012-05-29T21:53:07.687
> 
> 标签：java, exception-handling

请参阅下面的两个示例。假设这两个类都包含属于广泛使用的 API 库的公共方法。

`AClass.java`更容易编写（可能由于噪音较小而更容易阅读），但是当检测到错误时，堆栈跟踪中的第一个方法是内部方法（`nullCheck(...)`）并且异常消息不是指该方法。这会给用户带来不必要的困惑吗？我的意思是在用户思考的意义上：“这是一个引发异常的内部方法，一定是库中的错误，而不是我的程序中的错误。什么*** * 无用的库......”

`BClass.java`写起来比较麻烦（连同它的所有 if 语句），但是当检测到错误时，堆栈跟踪的第一行会指出第一次检测到错误的 API 方法（由用户调用）。这是否更有可能让用户认为：“我正在从我的代码中调用该方法，一定是我传入的参数有问题”。

在公共 API 中检查参数的有效性时，哪种是引发异常的首选方式？或者这两个例子被认为是相等的？

```
public class AClass {
public void publicApiMethod1(String a){
    nullCheck(a, "a");
    // do something...
}
public void publicApiMethod2(String a, String b, String c){
    nullCheck(a, "a");
    nullCheck(b, "b");
    nullCheck(c, "c");
    // do something...
}

private void nullCheck(Object a, String argName) {
    if(a == null){
        throw new NullPointerException("Null argument: " + argName);
    }
}
}

public class BClass {
public void publicApiMethod1(String a){
    if(a == null){
        throw new NullPointerException("Null argument: 'a'");
    }
    // do something...
}

public void publicApiMethod2(String a, String b, String c){
    if(a == null){
        throw new NullPointerException("Null argument: 'a'");
    }
    if(b == null){
        throw new NullPointerException("Null argument: 'b'");
    }
    if(c == null){
        throw new NullPointerException("Null argument: 'c'");
    }
    // do something...
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T22:00:11.007

如果您的错误消息是描述性的（确实如此），那么没有人会费心查看堆栈跟踪。因此第一种形式更好，因为它封装了验证逻辑。

请注意，各种库中有大量可供使用的断言方法，请参阅：[`Objects.requireNonNull`](http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html#requireNonNull%28T,%20java.lang.String%29)和[`Validate.notNull`](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/Validate.html#notNull%28T,%20java.lang.String,%20java.lang.Object...%29)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:04:03.770

我会这样做，基本上基于你的`AClass`：

```
public void publicApiMethod2(String a, String b, String c){
    try {
        nullCheck(a, "a");
        nullCheck(b, "b");
        nullCheck(c, "c");
    }
    // catch the NullPointerException,
    // and any other Exception explicitly thrown by your validation methods
    catch (NullPointerException e) { 
         throw new IllegalArgumentException(e.getMessage());
    }
    // do something...
} 
```

这样，用户就会得到一个明确的消息**和**一个指向公共方法的堆栈跟踪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T21:57:57.310

在你的 b 课上你为什么不使用

```
if( (c == null)|| (b == null)|| (a == null) ){
 //thrown my red ball
 } 
```

不那么烦人，更易读

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T22:04:24.647

我认为 A 类很好，只要你用`@throws`. 我已经看到很多库会在堆栈中投入更深。重要的是让用户了解为什么会抛出错误以及他们可以做些什么来避免它。

# javascript - 究竟什么是画布路径，ctx.closePath() 有什么用？

> ID：10807230
> 
> 赞同：25
> 
> 时间：2012-05-29T21:53:14.273
> 
> 标签：javascript, html, canvas, drawing, jcanvas

我正在开发一个 HTML5 游戏。我需要在画布中绘制尾线并检查游戏中的交叉点，这是一款 Tron 风格的游戏。

我实际上正在使用JCanvas 中[的`drawLine()`函数](http://calebevans.me/projects/jcanvas/docs.php?p=lines)，但是 JCanvas 没有为我提供检查线交点的方法，我在源代码中挖掘并找到了使用`ctx`对象，并且在我使用的函数结束时，我返回了对象，所以我可以使用该`ctx.isPointInPath()`方法来实现我需要的，但不工作，`false`每次都返回......

我真的不明白什么是路径 - 只会`ctx.isPointInPath()`返回使用after`true`设置的点？或者它会返回使用连接的 2 个连续 s之间的所有点吗？`ctx.moveTo()``ctx.beginPath()``true``ctx.moveTo()``ctx.lineTo()`

有什么用`ctx.closePath()`？

和有什么区别：

```
{
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
} 
```

和：

```
{
    ctx.fill();
    ctx.stroke();
    ctx.closePath();
} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-29T22:22:06.930

## 什么是路径？

它是定义矢量形状边界的一系列路径命令（moveTo、lineTo、arcTo 等）。然后，您可以根据需要填充和/或描边路径。

## 有什么用`closePath()`？

### 演示：http: [//jsfiddle.net/YrQCG/5/](http://jsfiddle.net/YrQCG/5/)

```
// Draw a red path using closePath() in the middle
ctx.beginPath();
ctx.strokeStyle = 'red';
ctx.moveTo(50,100);
ctx.lineTo(100,150);
ctx.lineTo(150,100);
ctx.closePath();
ctx.lineTo(50,50);
ctx.stroke();

// Slide the next path over by 150 pixels    
ctx.translate(150,0);

// Draw a blue path using the exact same commands, but without closePath
ctx.beginPath();
ctx.strokeStyle = 'blue';
ctx.moveTo(50,100);
ctx.lineTo(100,150);
ctx.lineTo(150,100);
//ctx.closePath();
ctx.lineTo(50,50);
ctx.stroke(); 
```

                                          ![在此处输入图像描述](../Images/36005b2c0b69a3dee94123405f4b3e27.png)

Using`closePath()`使笔的点移回当前子路径的起点，从当前点画**一条线回到该起点**；下一个命令从这个新点开始。如果您想在不显式绘制最后一行的情况下绘制完全轮廓的形状，这很有用。

这相当于`lineTo()`使用当前子路径的第一个点的位置调用，然后调用`moveTo()`同一点（以建立新的子路径）。

*   如上所示，我们使用前两个命令和后两个命令绘制`V`符号。当我们调用红色路径时，它会绘制水平条并导致下一行从左上角开始。`moveTo``lineTo``closePath`

*   当我们不调用`closePath`蓝色路径时，下一个`lineTo`命令会从最后绘制的点继续执行。

请注意，大多数情况下*这不是*`closePath()`必需的，与每次要开始绘制新路径时都必须调用不同。（如果你不这样做，所有旧的路径绘图命令都是下一个绘图的一部分。）*`beginPath()`*

 ** * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-19T12:33:39.187

这是封闭路径的基本表示：

```
ctx.beginPath();
ctx.moveTo(0,0);
ctx.lineTo(100,0);
ctx.lineTo(100,100);
ctx.lineTo(0,100);    
ctx.closePath(); // <--the image right side has this line
ctx.stroke(); 
```

结果`closePath()`是起点和终点是有界的。

![封闭路径](../Images/acac4336556225a846f48235ebb32387.png)*

# php - 迁移到新服务器，性能变慢

> ID：10807234
> 
> 赞同：0
> 
> 时间：2012-05-29T21:53:23.297
> 
> 标签：php, mysql, performance, apache, centos

我刚刚将我的网站移动到另一台具有升级规格的服务器，但我遇到了性能缓慢的问题。

它在旧服务器上运行良好，但不知何故在新服务器上，当我进行 php 用户登录时，服务器在**5 分钟内响应我！**是的，php 执行需要**5 分钟**。无需登录（使用 php 会话），它就可以按预期工作。我正在使用 php+mysqli。

这是两个服务器的比较：

**老的**

*   Apache 版本：Apache/2.2.15 (CentOS)
*   PHP版本：5.4.0
*   MySQL 版本：mysqlnd 5.0.10 - 20111026 - $ 修订版：323634 $

**新的**

*   阿帕奇版本：阿帕奇/ 2
*   PHP版本：5.4.3
*   数据库客户端版本：libmysql - 5.1.62

我应该怎么办？我实在想不通是怎么回事。。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-17T19:51:50.607

首先，尝试像其他人已经说过的那样实际测量电话以缩小问题范围。

例如，您连接到数据库引擎的部分。

会不会是 MySQL 服务器在不同的机器上运行？

如果是这样，则可能存在反向 DNS 问题，即 MySQL 服务器无法找到调用客户端的名称。

或者，您可能会遇到 MySQL 客户端在最终决定回退到可信赖的 IPv4 地址之前两次尝试 IPv6 连接的问题。这个过程很容易需要 1 秒或更长时间！

尝试连接到普通的 IPv4 地址，而不是临时使用动态主机名，看看它是否会立即变得更快。

# silverlight-4.0 - 为什么我的 WP 模拟器在闪屏上停止

> ID：10807238
> 
> 赞同：0
> 
> 时间：2012-05-29T21:53:42.987
> 
> 标签：silverlight-4.0, windows-phone-7.1

我创建了一个由这三个类组成的 WP 类库**BusinessLogic项目**

1）**瓶**类

```
namespace BusinessLogic
{
    public class Bottle : INotifyPropertyChanged
    {
        // Due to INotifyPropertyChanged interface
        public event PropertyChangedEventHandler PropertyChanged;

        // Proprietà Title
        private string title;
        public string Title
        {
            set
            {
                if (title != value)
                {
                    title = value;
                    OnPropertyChanged("Title");
                }
            }
            get
            {
                return title;
            }
        }
        // Proprietà PhotoFileName
        private string photoFileName;
        public string PhotoFileName
        {
           set
            {
                if (photoFileName != value)
                {
                    photoFileName = value;
                    OnPropertyChanged("PhotoFileName");
                }
            }
            get
            {
                return photoFileName;
            }
        } 
    protected virtual void OnPropertyChanged(string propChanged)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propChanged));
    }
  }
} 
```

2)**瓶子**类

```
namespace BusinessLogic
{
    public class Bottles : INotifyPropertyChanged
    {
        // Due to INotifyPropertyChanged interface
        public event PropertyChangedEventHandler PropertyChanged;

        // Proprietà MainTitle
        private string mainTitle;
    public string MainTitle
    {
        set
        {
            if (mainTitle != value)
            {
                mainTitle = value;
                OnPropertyChanged("MainTitle");
            }
        }
        get
        {
            return mainTitle;
        }
    }

    // Proprietà bottles
    private ObservableCollection<Bottle> bottleSet = new ObservableCollection<Bottle>();
    public ObservableCollection<Bottle> BottleSet
    {
        set
        {
            if (bottleSet != value)
            {
                bottleSet = value;
                OnPropertyChanged("BottleSet");
            }
        }
        get { return bottleSet; }
    }

    protected virtual void OnPropertyChanged(string propChanged)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propChanged));
    }

}
} 
```

3) **BottlesPresenter**类

```
namespace BusinessLogic
{
    public class BottlesPresenter : INotifyPropertyChanged
    {
    // Due to INotifyPropertyChanged interface
    public event PropertyChangedEventHandler PropertyChanged;

    // Proprietà BottleMatrix
    private Bottles bottlesMatrix;
    public Bottles BottlesMatrix
    {
        protected set
        {
            if (bottlesMatrix != value)
            {
                bottlesMatrix = value;
                OnPropertyChanged("BottlesMatrix");
            }
        }
        get { return bottlesMatrix; }
    }

    public BottlesPresenter()
    {
        XmlSerializer xml = new XmlSerializer(typeof(Bottles));

        using (StreamReader fileReader = new         StreamReader(@"C:\Stuff\WindowsPhone\AppLearningHowTo2\AppLearningHowTo2\DAL\DB.xml"))
        {
            BottlesMatrix = (Bottles)xml.Deserialize(fileReader);
        }
    }

        protected virtual void OnPropertyChanged(string propChanged)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propChanged));
        }
    }
} 
```

BottlePresenter 构造函数应该从位于文件系统中的 xml 文件反序列化。它包含以下标签

```
<?xml version="1.0"?>
<Bottles xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <MainTitle>MainTitle</MainTitle>
  <Bottleset>
    <Bottle>
      <Title>Title1</Title>
      <PhotoFileName>PhotoFileName1</PhotoFileName>
    </Bottle>
    <Bottle>
      <Title>Title2</Title>
      <PhotoFileName>PhotoFileName2</PhotoFileName>
    </Bottle>
  </Bottleset>
</Bottles> 
```

然后我创建了一个 WP 应用程序，并引用了**BusinessLogic.dll**项目库。

在 MainPage.xaml 文件中，我放置了 XML 命名空间声明

```
xmlns:businesslogic="clr-namespace:BusinessLogic;assembly=BusinessLogic" 
```

然后我在 MainPage.xaml Resources 集合中实例化了**BottlesPresenter类**

```
<phone:PhoneApplicationPage.Resources>
    <businesslogic:BottlesPresenter x:Key="bottlesPresenter" />        
</phone:PhoneApplicationPage.Resources> 
```

最后在内容区域中放置一个 TextBlock 并绑定到该资源：

```
 <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <TextBlock HorizontalAlignment="Center"
         VerticalAlignment="Center"
         Text="{Binding Source={StaticResource bottlesPresenter},
                                  Path=Bottles.MainTitle}" /> 
```

不幸的是，我启动了调试器，打开了模拟器，到达了启动画面并且没有继续。

简而言之：我无法创建**BottlesPresenter**类的实例。

我把头撞在墙上好几个星期都没有找到解决办法。

请问有人可以帮我吗？

非常感谢

安东尼奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T13:59:03.893

当 WP7 无法构造 Application 对象时，模拟器的行为类似。从问题来看，我只看到 Application 对您的代码的 1 个引用。它是资源中的 BottlePresenter。XamlLoader 尝试创建此类型的实例。

查看您的 BottlePresenter 构造器中的内容：

```
public BottlesPresenter()
{
    XmlSerializer xml = new XmlSerializer(typeof(Bottles));

    using (StreamReader fileReader = new StreamReader(
    @"C:\Stuff\WindowsPhone\AppLearningHowTo2\AppLearningHowTo2\DAL\DB.xml"))
    {
        BottlesMatrix = (Bottles)xml.Deserialize(fileReader);
    }
} 
```

第一行没问题。第二行没问题。第三行导致异常，因为路径“C:\Stuff\WindowsPhone\AppLearningHowTo2\AppLearningHowTo2\DAL\DB.xml”在 Windows Phone 上是不可接受的。您可以访问的所有文件是 XAP 的内容、程序集中的资源以及独立存储中的文件。

以下文章可能会对您有所帮助[关于 WP7 隔离存储 - 读取和保存文本文件](http://www.windowsphonegeek.com/tips/all-about-wp7-isolated-storage-read-and-save-text-files)

# mysql - MySQL为大表优化变量

> ID：10807242
> 
> 赞同：1
> 
> 时间：2012-05-29T21:53:55.043
> 
> 标签：mysql, optimization

我需要帮助来设置所有 MySQL 变量以及任何人可能有的任何建议。

我们目前有 1 台服务器：

*   4 个双核 2.4 GHz
*   32GB 内存
*   Windows Server 2008 网络版

MySQL设置为：

*   1 台主服务器（端口 3301）
*   4 个从站（端口 3302、3303、3304、3305）

复制是一种享受。从站的想法是处理许多连接

MySQL 配置文件如下所示：

```
[mysqld]  
datadir="E:\MySQL_Rep\data_3302"  
init-file="E:\MySQL_Rep\mysql-init-slave.txt"  
port=3302  
server-id=3302  
default-storage-engine=myisam  
bulk_insert_buffer_size = 512M  
join_buffer_size = 5M  
query_cache_limit = 1M  
max_connections=1510  
tmp_table_size = 18M  
skip-innodb  
low-priority-updates  
delay-key-write=ALL  
innodb_write_io_threads = 5  
innodb_read_io_threads = 10  
skip-ssl  
slave_compressed_protocol  
slave-skip-errors=all  
sync_binlog = 1  
join_buffer_size = 20M  
replicate-wild-ignore-table=db.search_result%  
key_buffer_size=4G  
expire_logs_days=1    
relay-log-space-limit=10G  
myisam-recover=backup,force  
read_rnd_buffer_size=1G  
read_buffer_size=1G 
```

以上 4 个从机中的每一个都是相同的，只是将“3302”更改为 3303、3304 和 3305。

我们有 3 个主表：

```
Name: keyword_index  
Engine: MyISAM  
Rows: 1,521,140  
Avg Row Length: 25  
Data Length: 38150952  
Index Length: 48757760  
Columns: id(INT 11), word(VARCHAR 45, UNIQUE)  

Name: keyword_prodid  
Engine: MyISAM  
Rows: 42,611,210  
Avg Row Length: 17  
Data Length: 724390570  
Index Length: 1796547584  
Columns: id_kw(BIGINT 20, INDEXED), id_prod(BIGINT 20)  

Name: products  
Engine: MyISAM  
Rows: 7,192,937  
Avg Row Length: 1018  
Data Length: 7544910024  
Index Length: 686807040  
Columns: prod_id(BIGINT 20),... ... ... 
```

我运行的查询：

```
SELECT kwi.id FROM keyword_index kwi WHERE kwi.`word` = 'mobile' LIMIT 1 
```

解释：

```
'1', 'SIMPLE', 'kwi', 'const', 'word_UNIQUE', 'word_UNIQUE', '137', 'const', '1', ''` 
```

这显然在不到 0 秒的时间内运行，并返回`5531`;

* * *

使用上述结果

```
SELECT 
    id_prod,count(*) AS count,
    @sID 
FROM keyword_prodid kwp 
WHERE kwp.id_kw = 264012 
    OR kwp.id_kw = 817869 
    OR kwp.id_kw = 5531 
    OR kwp.id_kw = 7167 
    OR kwp.id_kw = 3462 
    OR kwp.id_kw = 811564 
GROUP BY id_prod 
ORDER BY count DESC LIMIT 10 INTO OUTFILE 'THEFILE' 
```

解释：

```
'1', 'SIMPLE', 'kwp', 'range', 'PRIMARY,id_kw', 'PRIMARY', '8', NULL, '55071', 'Using where; Using index; Using temporary; Using filesort'` 
```

这将在**30 到 60 秒内**运行，这就是我遇到问题的地方。该查询返回一个产品 ID 列表，其中包含关键字最多的产品首先出现在列表中。

然后，我使用从上面生成的列表从产品表中获取具有上述 ID 的产品。

我的问题是，有没有办法让这个查询运行得更快，通过优化查询或调整配置文件设置。所有的设置几乎都是猜测的，在这个阶段我们只能在一台物理服务器上运行它。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T07:25:19.813

您需要创建复合索引`id_kw + id_prod`。

**重要提示**：只要`id_kw + id_prod`索引包含`id_kw`在其左侧 - 您不再需要单个`id_kw`索引，所以删除它。

还有这个

```
kwp.id_kw = 264012 
OR kwp.id_kw = 817869 
OR kwp.id_kw = 5531 
OR kwp.id_kw = 7167 
OR kwp.id_kw = 3462 
OR kwp.id_kw = 811564 
```

可以写成`id_kw IN (264012, 817869, ...)`

# iphone - 从另一个类访问数据而不创建新实例

> ID：10807245
> 
> 赞同：0
> 
> 时间：2012-05-29T21:54:20.317
> 
> 标签：iphone, ios, xcode, ipad

我有一个问题，因为两天研究更多我无法解决。

我在一个运行流式音频的类中有一个应用程序。在另一个视图中，我有一个带有播客的表格，它将通过 url 打开。

为了利用第一个类的代码创建了一个委托，因此当用户在任何音频播客中播放时，我占用了主类的方法，只是更改了参数（在本例中为 URL）。

委托工作正常，参数传递也是如此。唯一的问题是委托必须实例化主类。

```
ClassePrincipal *classePrincipal  = [[ClassePrincipal alloc] init];
classePrincipal.delegate = self;

[classePrincipal method]; 
```

如果音频已经在主类中运行，实例化为一个新的对象类，它将开始在已经运行的内容之上播放音频 Podcast。

即使在他继续播放播客之前我有一个重要的停留，例如：

```
- (void) playPodcast {
                  [classePrincipal destroyStreamer];
                  [classePrincipal startStream];

} 
```

destroyStreamer 该方法被正确调用，但由于实例是从头开始创建的 classePrincipal 他没有看到任何正在播放的音频。

有点滚动这个问题，但是有没有办法在不实例化类的情况下调用参数传递 ClassePrincipal 的方法？由于不在内存中分配新对象，我可以查看音频是否正在播放并为他播放。

如果有其他解决方法也谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:58:02.347

据我所知，你可能想把这个类变成一个单例。这样，如果它还没有被实例化，如果它已经被实例化，你可以在你的代码中进行一些检查，以在开始新的音频之前停止当前的音频。我发现的一个随机教程是[在此处输入链接描述](http://iphone.galloway.me.uk/iphone-sdktutorials/singleton-classes/)

# python - 将 pip 与 git repo 一起使用是否安全？

> ID：10807246
> 
> 赞同：6
> 
> 时间：2012-05-29T21:54:23.593
> 
> 标签：python, github, pip

可以使用 pip 从 git repo 使用命令进行安装 `pip install git+https://github.com/...`

但这对生产环境安全吗？有没有办法在不分叉、托管自己和合并任何未来更新的情况下防止它被删除？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T22:04:31.683

不，它不是 100%“安全”的，github 可以在您需要签出源时关闭，作者可以删除存储库（或对其进行一些破坏性更改）ecc。电子抄送

使用 pip 您可以指定修订版或标签以及存储库链接

例如。git+git://github.com/misterx/projectname.git@840d25bb9db9fbc801b9

无论新版本如何，这都会检查修订版 840d25bb9db9fbc801b9，因此您不会以未知的更新（损坏）代码结束。

我通常做的是将项目（除非我想与主干保持同步）克隆到我的 github 帐户或其他地方。

# groovy - 如何在 Griffon 中使用 FlamingoBuilder 创建功能区？

> ID：10807251
> 
> 赞同：1
> 
> 时间：2012-05-29T21:55:04.023
> 
> 标签：groovy, griffon, radiance-flamingo

我目前正在尝试使用 Griffon 0.9.5 和[FlamingoBuilder](http://docs.codehaus.org/display/GRIFFON/FlamingoBuilder)创建一个应用程序。

我已将*Application.groovy*`frameClass`中的值更改为并尝试了一些操作，以便将功能区添加到应用程序窗口。*`'org.jvnet.flamingo.ribbon.JRibbonFrame'`*

 *我的第一次尝试是创建一个`ribbonTask`带有嵌套节点的`ribbonBand`节点。应用程序启动，但未显示按钮。

```
application(title: 'test01',
        preferredSize: [320, 240],
        pack: true,
        locationByPlatform: true,
        iconImage: imageIcon('/griffon-icon-48x48.png').image,
        {
            ribbonTask(title: 'Start') {
                    ribbonBand(id: 'fooBarBand', title: 'FooBar', image: imageIcon('/griffon-icon-48x48.png').image) {
                        commandButton(id: 'fooButton', text: 'Foo', image: imageIcon('/griffon-icon-48x48.png').image)
                        commandButton(id: 'barButton', text: 'Bar', image: imageIcon('/griffon-icon-48x48.png').image)
                    }
            }

            // add content here
            label('Content Goes Here') // delete me
        }
) 
```

![第一次尝试的截图](../Images/494c4810447eecfaf6bfeb9b8a349822.png)

* * *

在我的第二次尝试中，我明确地创建了一个`RibbonTask`并调用了`addTask`. 显示按钮。但是，我不确定这是否真的是 Griffon 的做事方式。 **问题：**有没有更好的方法来创建功能区？

```
application(title: 'test01',
        preferredSize: [320, 240],
        pack: true,
        locationByPlatform: true,
        iconImage: imageIcon('/griffon-icon-48x48.png').image,
        {
            ribbonBand(id: 'fooBarBand', title: 'FooBar', image: imageIcon('/griffon-icon-48x48.png').image) {
                commandButton(id: 'fooButton', text: 'Foo', image: imageIcon('/griffon-icon-48x48.png').image)
                commandButton(id: 'barButton', text: 'Bar', image: imageIcon('/griffon-icon-48x48.png').image)
            }
            current.ribbon.addTask new RibbonTask('Start', fooBarBand)

            // add content here
            label('Content Goes Here') // delete me
        }
) 
```

![第二次尝试截图](../Images/12b68c4b7528d496f7d21220c4424f16.png)

* * *

然后我尝试`ribbonApplicationMenu`使用以下代码片段添加一个：

```
 ribbonApplicationMenu(id: 'appMenu') {
            ribbonApplicationMenuEntryPrimary(id: 'quitMenuEntry', text: 'Quit',
                    entryKind: JCommandButton.CommandButtonKind.ACTION_ONLY,
                    image: imageIcon('/griffon-icon-48x48.png').image)
        } 
```

但是，它不起作用。我得到以下运行时异常：

> java.lang.RuntimeException：无法为“ribbonApplicationMenuEntryPrimary”创建组件原因：groovy.lang.MissingPropertyException：没有这样的属性：类的文本：griffon.builder.flamingo.factory.RibbonApplicationMenuEntryPrimaryFactory

[FlamingoBuilder](http://docs.codehaus.org/display/GRIFFON/FlamingoBuilder)的文档指出有一个`text`属性，当我删除 text 属性时，我得到一个异常，因为`text`必须设置该属性。我有点不知所措。这个代码片段有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T08:48:41.837

恐怕第一个问题与 application() 节点工厂与ribbonFrame() 工厂有关。您会看到，Griffon 假定框架子类的行为与任何其他常规 JFrame 一样，但是 JRibbonFrame 以不同的方式处理其子类。ApplicationFactory 不知道这一点，因此添加功能区任务“失败”，除非您手动添加它们，如第二个片段中所示。

这个问题可以通过将父/子关系代码从ribbonFrame() 移动到ribbonBand/ribbonTask 工厂来解决。这需要新版本的 FlamingoBuilder。

现在关于第二个问题，这似乎是我们这边的一个错误。考虑到 FlamingoBuilder 在任何情况下都应该更新，我们也会解决这个问题。*

# java - 泛型类方法返回自己的类型作为模板参数

> ID：10807252
> 
> 赞同：1
> 
> 时间：2012-05-29T21:55:21.370
> 
> 标签：java, generics, inheritance

我正在设计一组`Document`在对象中保存对象的通用类`Folder`：

```
// Folder, which holds zero or more documents
public interface Folder<DocType extends Document>
{
    // Locate matching documents within the folder
    public ArrayList<DocType> findDocuments(...);
    ...
}

// Document, contained within a folder
public interface Document
{
    // Retrieve the parent folder
    public Folder getFolder();    // Not correct
    ...
} 
```

然后扩展这些类以用于文件夹和文档类型的实际实现。麻烦的是该`Document.getFolder()`方法需要返回一个类型的对象，而实际的实现类型`Folder<DocType>`在哪里。这意味着该方法需要知道它自己的具体类类型是什么。`DocType``Document`

所以我的问题是，是否应该`Document`像这样声明该类：

```
// Document, contained within a Folder
public interface Document<DocType extends Document>
{
    // Retrieve the parent folder
    public Folder<DocType> getFolder();
    ...
} 
```

或者有没有更简单的方法来做到这一点？上面的代码需要具体的实现，如下所示：

```
public class MyFolder
    implements Folder<MyDocument>
{ ... }

public class MyDocument
    implements Document<MyDocument>
{ ... } 
```

这是`Document<MyDocument>`我觉得有点奇怪的部分；真的有必要吗？

*（抱歉，如果这是重复的；我在档案中找不到我正在寻找的确切答案。）*

**附录**

上面使用的原始代码`ArrayList<DocType>`，但就像几位海报指出的那样，我最好返回 a `List`，例如：

```
 public List<DocType> findDocuments(...); 
```

（该方法对我的问题并不重要，并且我的实际 API 返回一个`Iterator`，所以我只是使用想到的第一件事来简化问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:22:27.760

你拥有它的方式对我来说似乎没问题，除了`Document`和`Folder`接口中缺少类型参数以及使用`ArrayList`（实现）而不是`List`（接口）。

```
interface Folder<T extends Document<T>>
{
    public List<T> findDocuments();

}

interface Document<T extends Document<T>>
{
    public Folder<T> getFolder();
} 
```

使用 API 是最好的了解方式，假设我们有一个`Document`被调用的实现`SpreadSheet`：

```
class SpreadSheet implements Document<SpreadSheet> {

    @Override
    public Folder<SpreadSheet> getFolder() {
        return new SpreadSheetFolder();
    }
} 
```

然后你有一个`Folder`名为`SpreadSheetFolder`：

```
class SpreadSheetFolder implements Folder<SpreadSheet>{

    @Override
    public List<SpreadSheet> findDocuments() {
        return asList(new SpreadSheet(), new SpreadSheet());
    }
} 
```

然后，当您使用 API 时，您将执行以下操作：

```
Document<SpreadSheet> d = new SpreadSheet();
Folder<SpreadSheet> folder = d.getFolder(); 
```

它工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:50:20.600

这似乎是满足您的要求的适当方式，不，没有更简单的方式来表达相同的要求（特别是，Java 没有将类型参数限制为的类型的语法`this`）。

但是，由于您同时扩展了 Document 和 Folder，也许您实际上需要一个相互递归的类型绑定。我的意思是在您的解决方案中，表达式

```
new MyFolder().findDocuments().get(0).getFolder() 
```

是类型`Folder<MyDocument>`，不是`MyFolder`。如果它需要是 MyFolder，泛型会变得丑陋：

```
//Folder, which holds zero or more documents
interface Folder<D extends Document<D, F>, F extends Folder<D, F>> {
    ArrayList<D> findDocuments();
}

// Document, contained within a folder
interface Document<D extends Document<D, F>, F extends Folder<D, F>> {
    F getFolder();
} 
```

然后你可以实现：

```
class MyFolder implements Folder<MyDocument, MyFolder> {
    @Override
    public ArrayList<MyDocument> findDocuments() {
        return new ArrayList<>(Collections.singletonList(new MyDocument()));
    }
}

class MyDocument implements Document<MyDocument, MyFolder> {
    @Override
    public MyFolder getFolder() {
        return new MyFolder();
    }
} 
```

现在，

```
MyFolder folder = new MyFolder().findDocuments().get(0).getFolder(); 
```

也编译。

顺便说一句，`ArrayList`在界面中使用是非常有限制的，正如我想使用时的混乱`Collections.singletonList`所示。你也（不经意间？）否认自己`Collections.unmodifiableList`和朋友的服务。通常，因此通过声明将 List 实现留给实现者自行决定

```
List<D> findDocuments(); 
```

反而。

# android - 处理多次按下按钮的最佳实践

> ID：10807254
> 
> 赞同：2
> 
> 时间：2012-05-29T21:55:32.397
> 
> 标签：android, user-interface

在我的任何应用程序中，我发现一个常见问题是用户可能会不小心对同一个按钮执行多次单击，从而导致 onClick 侦听器逻辑的多次执行。通常，我对这些 onClickListeners 的业务逻辑通常包括启动一个执行 HTTP 请求并随后修改 UI 的繁重进程 AsynTask。

我防止异步任务多次执行的方法是在侦听器方法的开头禁用按钮并再次启用它作为 onPostExecute 的第一条语句。这通常对我有用，或者至少我没有收到任何关于这种情况的问题。

最近，一位同事向我指出了这种无法启用按钮方法的潜在问题。如下面的代码所示，由两个按钮“+”和“-”组成，快速和交替按下这些按钮会导致应用程序因 ArrayOutOfIndex 异常而崩溃。

这一事实让我开始思考我管理 onClickListener 事件并发性的方法，以及是否真的有可能在使用上述方法完成第一个 asyntask 之前启动第二个 asyntask 的情况。

您对处理这种情况有什么建议？

对于那些建议应用一些逻辑来拒绝第二次启动 asyntask 直到第一个 asyntask 完成的建议，是否真的值得将该逻辑普遍应用于按钮执行 http 请求的常用应用程序？

*崩溃活动.java*

```
public class CrashActivity extends Activity {

private int mNumbers[] = { 1, 2, 3, 4, 5 };
private int position = 0;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final TextView result = (TextView) findViewById(R.id.resultTextView);

    final Button minusBtn = (Button) findViewById(R.id.minus_button);
    final Button plusBtn = (Button) findViewById(R.id.plus_button);

    minusBtn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            minusBtn.setEnabled(false);
            plusBtn.setEnabled(true);

            result.setText("" + mNumbers[--position]);

            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            minusBtn.setEnabled((position > 0));
        }
    });

    plusBtn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            plusBtn.setEnabled(false);
            minusBtn.setEnabled(true);

            result.setText("" + mNumbers[position++]);

            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            plusBtn.setEnabled((position <= 4));
        }
    });

    minusBtn.setEnabled(false);
}
} 
```

*主要的.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/minus_button"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="-" />

<Button
    android:id="@+id/plus_button"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="+" />   

<TextView
    android:id="@+id/resultTextView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="hello stackoverflow!" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T05:42:24.270

保证两种方法不会同时尝试更新 UI 的解决方案是同步 UI 更新代码。您可以创建一个同步方法或一个`Object`充当代码块的锁的方法。例子：

```
public synchronized void updateUI() {
    // ...
} 
```

或者

```
private Object mLock = new Object();

public void updateUI() {
    // ...
    synchronized (mLock) {
        // Critical code here.
    }
    // ...
} 
```

扩展它以确保任务 1 在任务 2 之前完成，在任务 3 之前完成，等等，您需要以某种方式跟踪哪个先开始。注意：在本例中，同步发生在 UI 线程上。

```
private List<AsyncTask> mRunningTasks = new ArrayList<AsyncTask>();

public void onClick(View v) {
    v.setEnabled(false);
    if (v == task1View) {
        Task1 task = new Task1();
        mRunningTasks.add(task);
        task.execute();
    }
    else if (v == task2View) {
        Task2 task = new Task2();
        mRunningTasks.add(task);
        task.execute();
    }
    // ...
}

// Copy and paste for each necessary task.
private Task1 extends AsyncTask<Void, Void, Void> {
    protected Void doInBackground(Void... v) {
        // Run task 1 code here.
        while (this != mRunningTasks.get(0)) {
            wait(1000);
        }
        return v[0];
    }

    protected void onPostExecute(Void v) {
        updateUI();
        mRunningTasks.remove(0);
        task1View.setEnabled(true);
    }
}

public void updateUI() {
    // UI update code here.
} 
```

# sorting - 使用 XSLT 1.0 的 XSLT 自定义排序

> ID：10807256
> 
> 赞同：1
> 
> 时间：2012-05-29T21:55:38.013
> 
> 标签：sorting, xslt

这是来自 XML 文档的示例。

```
<A>
  <Value>B2.B1-1.C2-0.D20</Value>
</A>
<A>
  <Value>A2.B15-1.C2-0.D20</Value>
</A>
<A>
  <Value>A2.B2-1.C2-0.D20</Value>
</A> 
```

等等。

我需要将其排序为

A2.B2-1.C2-0.D20 A2.B15-1.C2-0.D20 B2.B1-1.C2-0.D20

点分隔组件的数量未知，其中的数字可以是任何格式（1-1、11、11abcd）。正如人们通常期望的那样，排序是直观的。首先它是基于字母和数字捆绑在一起阅读（B2和B15是正确的顺序。词序B15，B2不正确）

这可以用 XSLT 1.0 完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:24:23.547

XSLT 没有精确定义排序应该如何操作；结果是实现定义的。

在最近的 Saxon 版本中，有一个排序规则可以满足您的需求，但它假定 XSLT 2.0；事实上，它假设撒克逊人。

在 XSLT 1.0 中以可移植的方式执行此操作并不容易，尤其是当您无法调用递归模板来计算排序键时。

# php - PHP替换“|” 符号到 html 列表

> ID：10807258
> 
> 赞同：1
> 
> 时间：2012-05-29T21:55:40.910
> 
> 标签：php, html, regex

我有这个值表数据库

**10:00|10:15|10:30**

我需要将此符号替换`|`为 html 列表`<li>`

像这样：

```
<li><input class="left" type="text" value="10:00" /><div class="del right ">x</div></li>
<li><input class="left" type="text" value="10:15" /><div class="del right ">x</div></li>
<li><input class="left" type="text" value="10:30" /><div class="del right ">x</div></li> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:57:35.990

使用`explode()`, 然后从结果数组构建列表：

```
$str = "10:00|10:15|10:30";
$out = "";

foreach ( explode( "|", $str ) as $value ) {
  $out .= "<li>{$value}</li>";
}

echo "<ul>{$out}</ul>"; 
```

结果是：

```
<ul>
    <li>10:00</li>
    <li>10:15</li>
    <li>10:30</li>
</ul> 
```

从这里添加您的输入是一件轻而易举的事：

```
foreach ( explode( "|", $str ) as $value ) {
    $out .= "<li>
                 <input class='left' type='text' value='{$value}' />
                 <div class='del right'>x</div>
             </li>";
} 
```

留给您以下内容：

```
<ul>
    <li>
        <input class='left' type='text' value='10:00' />
        <div class='del right'>x</div>
    </li>
    <li>
        <input class='left' type='text' value='10:15' />
        <div class='del right'>x</div>
    </li>
    <li>
        <input class='left' type='text' value='10:30' />
        <div class='del right'>x</div>
    </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:57:57.300

您可以使用 |[分解](http://php.net/manual/en/function.explode.php)每个结果 作为分隔符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T21:59:05.640

您可以使用将其拆分为数组

```
$input = '10:00|10:15|10:30';
$list = explode('|', $input); 
```

比使用 foreach 遍历数组

```
foreach ($list as $li) {
    echo '<li />' . $li;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T10:16:36.787

尝试使用：

```
<?php
    $result = explode('|','10:00|10:15|10:30');
    foreach($result as $single)
    {
        echo '<li><input class="left" type="text" value="'.$single.'" /><div class="del right ">x</div></li>'."\r\n";
    }
?> 
```

# api - KML 图层的问题

> ID：10807261
> 
> 赞同：0
> 
> 时间：2012-05-29T21:56:01.870
> 
> 标签：api, maps

我的地图有 9 个图层，可以通过复选框打开和关闭。每一层都是由JS加载的。我的问题是，当他们的勾选框处于活动状态时，只有 5 个加载。可以将多少个 kml 层加载到 v3 api 中是否有限制？总共不到 1mb，尽管它们确实有很多自定义标记图标。

谢谢达伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T07:07:54.070

我有一个听起来很熟悉的问题。我正在以类似的方式处理 KML 文件（一系列地图图层作为 KML 文件由 JS 通过一个复选框选择/加载，虽然不大，但有很多自定义标记图标、长描述等）。

我现在才意识到似乎是一个新的限制。希望我能提供更多帮助，但我会分享我所知道的。

就我而言，早在 2011 年 6 月，完全相同的代码就可以正常工作，并且该地图已被 1000 多人查看/使用。这是用于年度活动的自定义 v3 api 地图。“图例”有大约 34 层包含线或标记，按类型分类，其中任何一个都可以在任何给定时间“打开”。默认和最常用的设置有大约 12 个“层”。只有一层（加载时恰好是阵列中的最后一层）每年都会发生显着变化。这也是最重要的一个。如果人们在 2011 年 6 月在某些浏览器/操作系统中遇到重大错误，我会听说的。正是这个文件让我坐下来“快速”编辑并及时重新上传以迎接 2012 年的活动。在我发现有问题之前，我什至没有碰过它。

调查结果/结论/想法？：

*   转储浏览器缓存什么都不做

*   通过反复试验，我发现它实际上会加载多达 6 个“层”，但它似乎取决于大小/类型/juju？逗号分隔列表中的任何给定 kML 文件。但是，像你一样，它通常在 5 或 6 左右。

*   奇怪的是，KML 文件本身似乎就在后台。不可见的标记会影响“悬停”鼠标指针，单击时会显示它们的信息框。奇怪的。

*   这个问题对我来说肯定不到一年。

*   如果不是与谷歌的一些新行动有关（在这种情况下，我怀疑我们会听说它或在 API 论坛中找到一些东西。）也许它与我们的一台服务器设置的一些新限制有关，并且是只是巧合？

---> 嗯。我最近遇到了一个 wordpress 站点的菜单项限制问题，并让我的托管服务提供商更改了一些 suhosin 请求限制（？）我可以尝试将源文件迁移到另一台服务器，看看它是否可以从那里工作。如果是这样，那将是一个重要的线索，我会报告回来。

除此之外，我不知道。只是想我会分享我学到的东西，并希望其他人对正在发生的事情有所了解。

# jquery - JQGrid - OndblClickRow 事件按选定的行选择字段值

> ID：10807263
> 
> 赞同：1
> 
> 时间：2012-05-29T21:57:02.380
> 
> 标签：jquery, jqgrid

我真的在为此苦苦挣扎，似乎无法让它发挥作用。

基本上我有一个预订表，例如

```
id    bookref    account    fare

1     BR1          101      10.00

2     BR2          202      20.00 
```

我的 Jqgrid 显示了所有这些信息，我想要做的是获取选定行的 bookref 值。我目前的功能是：

```
 ondblClickRow: function(rowid)
    {
        var grid = $('#bookings');
        var sel_id = grid.jqGrid('getGridParam', 'selrow');
        var myCellData = grid.jqGrid('getCell', sel_id, 'bookref');

        alert(myCellData);

    }, 
```

当我双击第一行时，我会返回“BR​​1”，这是正确的，如果我双击任何其他行，我仍然会得到“BR1”，而如果单击第二行，我应该得到“BR2”。

有人可以帮我吗？将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T10:11:27.330

如果您在我的代码中看到这里，我也在`ondblClickRow`我的网格中使用。如果您在此处看到，我将获取所有行值并进行自己想要的更改，最后使用`document.location.href`.
我能够对网格中的所有行执行此操作。

```
ondblClickRow: function(rowId) {
    var rowData = jQuery(this).getRowData(rowId); 
    var jobNumber = rowData['jobNumber'];
    var jobName = rowData['description'];
    var jobCustomer = rowData['customerName'];
    var jobStatus = rowData['jobStatus'];
    jobName = jobName.replace(/&/g, "``");
    jobName = jobName.replace(/#/, "__");
    var aQryStr = "jobNumber=" + jobNumber + "&jobName=" + jobName + "&jobCustomer=" + jobCustomer;
    console.log("./jobflow?token=view&" + aQryStr);
    document.location.href = "./jobflow?token=view&" + aQryStr;
}, 
```

如果您想查看我的完整网格代码：

```
$("#jobsGrid").jqGrid({
        url:'../job_controller',
        datatype: 'JSON',
        mtype: 'POST',
        pager: jQuery('#jobsGridPager'),
        colNames:['Job #','Project','City', 'Rep', 'Status', 'Customer', 'Cust PO #', 'Rep. #'],
        colModel :[
            {name:'jobNumber', index:'jobNumber', align:'left', width:50, editable:true,hidden:false, edittype:'text',
                    editoptions:{size:30,readonly:true},editrules:{edithidden:false,required:false}},
            {name:'description', index:'description', align:'left', width:150,hidden:false, editable:true, 
                    editoptions:{size:20,readonly:false, alignText:'right'},editrules:{edithidden:true,required:true}},
            {name:'locationCity', index:'locationCity', align:'', width:90,hidden:false, editable:true,
                    editoptions:{size:20,readonly:false, alignText:'right'},editrules:{edithidden:true,required:true}},
            {name:'initials', index:'initials', align:'center', width:30,hidden:false, editable:true,
                    editoptions:{size:20,readonly:false, alignText:'right'},editrules:{edithidden:true,required:true}},
            {name:'jobStatus', index:'jobStatus', align:'center', width:60,hidden:false, editable:true,
                    editoptions:{size:20,readonly:false, alignText:'right'},editrules:{edithidden:true,required:true}},
            {name:'customerName', index:'customerName', align:'', width:150,hidden:false, editable:true, 
                    editoptions:{size:20,readonly:false, alignText:'right'},editrules:{edithidden:true,required:true}},
            {name:'customerPONumber', index:'customerPONumber', align:'center', width:90, hidden:false, editable:true, 
                    editoptions:{}, editrules:{edithidden:true,required:false}},
            {name:'code', index:'code', align:'center', width:40,hidden:false, editable:true,
                    editoptions:{size:20,readonly:false, alignText:'right'},editrules:{edithidden:true,required:true}}
        ],
        rowNum: 50, pgbuttons: true,    
        recordtext: '',
        rowList: [50, 100, 200, 500, 1000],
        viewrecords: true,
        pager: '#jobsGridPager',
        sortname: 'employeeId', sortorder: "asc", imgpath: 'themes/basic/images',   caption: 'Jobs',
        height:547, width: 1140,/*scrollOffset:0,*/ rownumbers:true, altRows: true, altclass:'myAltRowClass', rownumWidth: 45,
        ondblClickRow: function(rowId) {
            var rowData = jQuery(this).getRowData(rowId); 
            var jobNumber = rowData['jobNumber'];
            var jobName = "" + rowData['description'];
            var jobCustomer = rowData['customerName'];
            var jobStatus = rowData['jobStatus'];
            jobName = jobName.replace(/&/g, "``");
            jobName = jobName.replace(/#/, "__");
            var aQryStr = "jobNumber=" + jobNumber + "&jobName=" + jobName + "&jobCustomer=" + jobCustomer;
            console.log("./jobflow?token=view&" + aQryStr);
            document.location.href = "./jobflow?token=view&" + aQryStr;
        },
        jsonReader : {
            root: "rows",
            page: "page",
            total: "total",
            records: "records",
            repeatitems: false,
            cell: "cell",
            id: "id",
            userdata: "userdata"
        }
    }).navGrid('#jobsGridPager', add:false,edit:false,del:false,refresh:false,search:false}
    ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T03:48:25.550

没有用selrow，但是这不是事件的行，有并发会失败

检查这个：

```
ondblClickRow: function(rowid)
{   
    var grid = $('#bookings');    
    var myCellData = grid.jqGrid('getCell', rowid, 'bookref');
    alert(myCellData);
} 
```

# jquery-ui - 在 jQuery 可排序开始时更改文本

> ID：10807266
> 
> 赞同：0
> 
> 时间：2012-05-29T21:57:08.373
> 
> 标签：jquery-ui

我有一个 jQuery 可排序列表。当我开始拖动一个项目时，我想在拖动时删除一些文本，以便在拖动时只显示第一行。例如，我有一个 ol：

```
<ol>
<li>Here is some text. <span>Here is a bunch of other text</span>
<li>Here is some text also. <span>Here is a bunch of other text as well</span>
</ol> 
```

当我开始拖动第一个 li 时，我希望它在拖动时只显示“这是一些文本”。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:05:44.143

你看过 jQuery UI 的可拖动和可排序吗？这里是[网站](http://jqueryui.com/demos/draggable/#sortable)。希望这可以帮助。

# ubuntu - 使用 ffmpeg 创建定格动画 - 渲染时出错

> ID：10807267
> 
> 赞同：0
> 
> 时间：2012-05-29T21:57:08.307
> 
> 标签：ubuntu, ffmpeg, rendering

我目前正在 ffmpeg 和我制作的一些脚本的帮助下创建一个定格动画视频。尽管在上一个剪辑中我尝试渲染，但我已经编辑了几帧。我使用的方法以前有效，所以我确定它与 GIMP 更改文件有关。我使用 .png 图像。这是我得到的命令和输出：

ffmpeg -sameq -f image2 -r 7 -i "$src_dir/frame-%06d.png" -r 25 "$dest_dir/$file_name.avi"

输出：

```
ffmpeg version 0.8.1-4:0.8.1-0ubuntu1, Copyright (c) 2000-2011 the Libav developers
  built on Mar 22 2012 05:09:06 with gcc 4.6.3
This program is not developed anymore and is only provided for compatibility. Use avconv instead (see Changelog for the list of incompatible changes).
Input #0, image2, from '/mnt/storage/selected_frames/005-Middag-Animation/frame-%06d.png':
  Duration: 00:00:02.85, start: 0.000000, bitrate: N/A
    Stream #0.0: Video: png, bgra, 1280x720, 7 fps, 7 tbr, 7 tbn, 7 tbc
File '/mnt/storage/Videoklipp//005-Middag-Animation.avi' already exists. Overwrite ? [y/N] y
Incompatible pixel format 'bgra' for codec 'mpeg4', auto-selecting format 'yuv420p'
[buffer @ 0x1b88860] w:1280 h:720 pixfmt:bgra
[avsink @ 0x1b8a480] auto-inserting filter 'auto-inserted scaler 0' between the filter 'src' and the filter 'out'
[scale @ 0x1b8ab80] w:1280 h:720 fmt:bgra -> w:1280 h:720 fmt:yuv420p flags:0x4
Output #0, avi, to '/mnt/storage/Videoklipp//005-Middag-Animation.avi':
  Metadata:
    ISFT            : Lavf53.21.0
    Stream #0.0: Video: mpeg4, yuv420p, 1280x720, q=2-31, 2 kb/s, 25 tbn, 25 tbc
Stream mapping:
  Stream #0.0 -> #0.0
Press ctrl-c to stop encoding
[buffer @ 0x1b88860] Changing frame properties on the fly is not supported.
    Last message repeated 6 times
frame=   13 fps=  0 q=0.0 Lsize=     524kB time=2.20 bitrate=1951.2kbits/s    
video:517kB audio:0kB global headers:0kB muxing overhead 1.323318% 
```

“[buffer @ 0x1b88860] 不支持动态更改帧属性”

我能做些什么来解决这个问题？任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:34:33.500

感谢 LordNeckbeard 的评论，我注意到 ffmpeg 已将视频拆分为具有“bgra”色彩空间的 png，而 GIMP 使用“rgb24”保存了 png。我为解决这个问题所做的是从 GIMP（过滤器 -> 批处理 -> 批处理...）运行批处理作业，并在同一个视频（已编辑和未编辑）中加载我想要的所有图像并选择展平图像以便进行更改并保存图像，使它们都使用 rgb24。

然后我可以运行命令以成功制作视频（使用 -qscale 1 而不是 -sameq，如 LordNeckbeard 建议的那样）。

谢谢！

# c# - 缺少 OfficeMergeControlException 的程序集参考

> ID：10807268
> 
> 赞同：0
> 
> 时间：2012-05-29T21:57:15.180
> 
> 标签：c#

当我尝试使用代码组合多个 .docx 文件时（第一个列表位于：[Append multiple DOCX files together](https://stackoverflow.com/questions/247666/how-can-i-programatically-use-c-sharp-to-append-multiple-docx-files-together)），我似乎缺少 OfficeMergeControlException 的程序集引用。

我正在使用 .NET Framework 4。

有任何想法吗？

谢谢，丰富

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T00:12:54.567

在那个场景中抛出自定义异常是没有意义的。只需抛出一个异常

```
catch (Exception e)
{
    throw new Exception(string.Format(CultureInfo.CurrentCulture, "Error while merging files. Document index {0}", pointer), e);
} 
```

或者更好的是根本不捕获异常。通过更改异常类型和格式化消息，您会丢失信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:48:46.067

似乎是一个自定义异常。就像是：

```
public class OfficeMergeControlException : Exception 
{
    public OfficeMergeControlException(string message, System.Exception innerException)  : base(message, innerException) { }
} 
```

# javascript - 构建稀疏数组

> ID：10807272
> 
> 赞同：2
> 
> 时间：2012-05-29T21:57:43.147
> 
> 标签：javascript, highcharts

我有一个大数组（比如 500 个条目），但大多数值都是 Null。我如何代表数组而不是拥有`[null, null ... 3, null, null, ...]`？

数组被传递给 highcharts 进行绘图。Highcharts 为数组中的每个元素绘制一个点，所以我真的不需要那些`null`s。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:15:09.013

如果你设置`array[200]`了一些东西，它不会像 JavaScript 出现在你身后并`array[0]`通过`array[199]`. 数组是自动稀疏的。

那么问题是如果你要求一个未初始化的元素，你会`undefined`返回而不是`null`? 还是有其他问题？

如果它是`undefined`vs`null`的东西，那么只需`null`在初始化它之后添加 s ，使用循环，而不必将它们放在大的文字 blob 中：

```
for (var i=0; i<array.length; ++i) { 
    if (typeof(array[i]) === 'undefined') { 
        array[i] = null; 
    } 
} 
```

如果您想`null`超出初始化的值，请替换`array.length`为您的最大索引需要的任何值（+1，否则将 更改`<`为`<=`）。

# javascript - 在方向更改时刷新 iframe 的内容

> ID：10807273
> 
> 赞同：1
> 
> 时间：2012-05-29T21:57:51.730
> 
> 标签：javascript, html, css, iframe, media-queries

好的，所以我已经设置了这个 html 模板，它允许我们在 ipad 上显示动画 html 广告。本质上，它使用媒体查询来确定设备的宽度，然后（使用 css）显示“纵向”或“横向”div。纵向和横向 div 都包含 iframe，其中包含各自方向的广告。

我遇到的问题是，由于某种原因，使用 Adob​​e Edge 制作的广告在更改设备方向时不会重新激活。我希望完成的是在设备的方向改变时强制整个 html 页面或 iframe 的内容刷新，从而重新激活广告。

我的代码如下：

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="initial-scale=1, minimum-scale=1, maximum-scale=1" />
<link href="http://www.calgaryheralddigital.com/creative/ads/general/reset.css" rel="stylesheet" type="text/css" media="screen">
<link href="http://www.calgaryheralddigital.com/creative/ads/general/clickTags.css" rel="stylesheet" type="text/css" media="screen">

<!-- orientation handler -->
<style type="text/css" media="all and (min-width: 1px) and (max-width: 800px)">
    #portrait{ display:block; }
    #landscape{ display:none; }
</style>
<style type="text/css" media="all and (min-width: 800px) and (max-width: 1500px)">
    #portrait{ display:none; }
    #landscape{ display:block; }
</style>
</head>

<body>
<div id="landscape">
    <div style="z-index:1; position:relative;">
        <iframe src="http://www.calgaryheralddigital.com/creative/ads/client/filename.html" width="1024px" height="90px" frameborder="0">
        <p>Your browser does not support iframes.</p>
        </iframe>
    </div>
    <div id="bannerLand">
        <a href="%cINSERT URL HERE">
            <img src="http://www.calgaryheralddigital.com/creative/ads/general/trans.gif" width="1024" height="90"/>
        </a>
    </div>
</div>
<div id="portrait">
    <div style="z-index:1; position:relative;">
        <iframe src="http://www.calgaryheralddigital.com/creative/ads/client/filename.html" width="768px" height="90px" frameborder="0">
        <p>Your browser does not support iframes.</p>
        </iframe>
    </div>
    <div id="bannerPort">
        <a href="%cINSERT URL HERE">
            <img src="http://www.calgaryheralddigital.com/creative/ads/general/trans.gif" width="768" height="90"/>
        </a>
    </div>
</div>
</body>

</html> 
```

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T15:09:11.853

实际上，我可以使用从另一个堆栈溢出问题中提取的一些代码自行解决此问题： [在方向更改时重新呈现网页的最佳方法是什么？](https://stackoverflow.com/questions/7919172/what-is-the-best-method-of-re-rendering-a-web-page-on-orientation-change)

```
var supportsOrientationChange = "onorientationchange" in window,
    orientationEvent = supportsOrientationChange ? "orientationchange" : "resize";

window.addEventListener(orientationEvent, function() {
    window.location.reload()
}, false); 
```

# windows-7 - Windows 7 和 VB6：事件错误 ID 1000

> ID：10807277
> 
> 赞同：2
> 
> 时间：2012-05-29T21:58:07.723
> 
> 标签：windows-7, crash

我在现场的某个特定软件上弹出了一个完全随机的错误。该应用程序是用 VB6 编写的游戏，在 Windows 7 64 位上运行。每隔一段时间，应用程序就会崩溃，并出现一个通用的“program.exe 已停止响应”消息框。该游戏可以连续几天正常运行，直到出现此消息，或者在几个小时内。没有异常被抛出。

我们以 Windows 2000 兼容模式（这是它的原始操作系统）运行此应用程序，禁用视觉主题，并以管理员身份运行。应用程序本身在使用外部组件和 API 调用方面非常简单。

参考：

Visual Basic for Applications
Visual Basic 运行时对象和过程
Visual Basic 对象和过程
OLE 自动化
Microsoft DAO 3.51 对象库
Microsoft 数据格式化对象库

组件：

Microsoft Comm Control 6.0
Microsoft Windows Common Controls 6.0 (SP6)
Resizer XT

如您所见，这些工具大部分都是非常简单的 Microsoft 标准工具。数据库组件的存在是为了与用于记账的 Access 数据库进行交互，并且插入了[Resizer XT](http://www.resizer.com/download.htm)以更轻松地将这款游戏从原来的 800x600 分辨率移动到 1920x1080。

信息亭没有启用网络；没有网络驱动程序，因此没有与远程数据库的连接。一切都封装在一个盒子里。

在 Windows 应用程序事件日志中，当发生这种情况时，有一个事件 ID 1000 导致看似随机的模块出现故障 - 到目前为止，要么是 ntdll.dll 要么是 lpk.dll。在 API 调用方面，我没有看到任何来自 ntdll.dll 的内容。我们将 kernel32、user32 和 winmm 用于各种文件系统和声音功能。我无法重现，因为它是完全随机的，所以我什至不知道从哪里开始进行故障排除。有任何想法吗？

编辑：更多信息。在其他一些开发人员的建议下，我尝试了几个不同版本的 Dependency Walker，最新版本显示我缺少 IESHIMS.dll 和 GRPSVC.dll（这两个似乎是 Depends.exe 中众所周知的错误） ，并且我在 COMCTRL32.dll 和 IEFRAME.dll 中缺少符号。那里有任何线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T09:26:41.247

来自应用程序事件日志的消息并没有那么有用——您需要的是从您的进程中进行的事后进程转储——这样您就可以看到代码中哪里开始出错了。

每次我看到其中一个问题时，它通常归结为错误的 API 参数，而不是更奇特的东西，这可能是由于传入的错误数据造成的，但通常是一个很好的老式错误导致了问题。

正如您可能已经想到的那样，调试起来并不容易；理想情况下，您将有一个可重复的故障案例进行调试，而不是依赖于从远程机器捕获转储文件，但直到您可以使其可重复远程转储是唯一的前进方式。

沃森博士曾经这样做，但不再发货，因此替代方案是：

*   [如何使用 Userdump.exe 工具创建转储文件](http://support.microsoft.com/kb/241215)
*   [Sysinternals ProcDump](http://technet.microsoft.com/en-us/sysinternals/dd996900.aspx)
*   [收集用户模式转储](http://msdn.microsoft.com/en-us/library/bb787181%28VS.85%29.aspx)

您需要得到一个小型转储，其中包含进程空间的重要部分，不包括标准模块（例如 Kernel32.dll） - 并将转储替换为版本号。

有关于[在进程崩溃时自动捕获转储的](http://blogs.msdn.com/b/dotnet/archive/2009/10/15/automatically-capturing-a-dump-when-a-process-crashes.aspx)说明- 它使用调试工具附带的 cdb.exe，但关键项是注册表项`\\HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\AeDebug`

您可以更改代码以添加更好的错误处理 - 如果您可以将原因缩小到几个过程并使用[使用符号调试信息来定位程序崩溃中描述的技术，则特别有用。](http://web.archive.org/web/20040221122322/http://www.fawcette.com/Archives/premier/mgznarch/vbpj/2001/04apr01/bb0401/bb0401.asp)直接处理地图文件。

一旦你有了一个小型转储和符号文件，WinDbg 是挖掘这些转储的首选工具 - 但是发现原因可能需要一点时间。

我要考虑的唯一另一件事是尝试捕获所有输入事件以进行重播，这取决于您的应用程序结构。

另一种选择是找到具有[重放调试](http://www.replaydebugging.com/)功能的 VMWare 7.1 副本，并将其用作捕获可重现步骤集的第一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-16T15:28:33.027

右键单击您的可执行对象，并在您发现问题根源时让它与 WINXP 兼容待定以最终解决它

# php - 文件未上传 PHP

> ID：10807280
> 
> 赞同：6
> 
> 时间：2012-05-29T21:58:19.480
> 
> 标签：php, file, upload

我试图编写代码以将文件上传到 PHP 中的“媒体”文件夹。由于某种原因，它仍然无法正常工作。

这是执行代码：

```
move_uploaded_file($_FILES["file"]["tmp_name"],"../media/" . $_FILES["file"]["name"]) or die ("Failure to upload content"); 
```

这是我的表单代码：

```
 <input type="file" name="file" id="file" /> 
```

任何想法为什么它可能不起作用？

* * *

编辑：

当我使用命令“print_r($_FILES);”时，它显示：

> Array ( [file] => Array ( [name] => Screen Shot 2012-05-29 at 12.36.11 PM.png [type] => image/png [tmp_name] => /Applications/MAMP/tmp/php/ phpHNj3nW [错误] => 0 [大小] => 71640 ) )

图像未上传到文件夹中。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-29T22:02:41.553

确保在您的表单中..您输入了enctype。
例如：`<form method="post" enctype="multipart/form-data" action="index.php"></form>`;

在提交表单时检查文件是否成功更新。使用 print_r 查看结果。
`print_r($_FILES);`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T22:10:01.970

确保 `media`文件夹有 777 权限并且路径`../media/`正确

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-05T12:14:59.227

将密码放入表格中

```
<form method="post" action="index.php" enctype="multipart/form-data"></form> 
```

签入 php.ini 文件`max_execution_time` ，由于执行时间，重图像未上传..

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-26T05:47:27.240

检查 php.ini 文件 max_execution_time 由于执行时间，重图像未上传..

例如：;

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T22:04:52.713

有加密类型或ajax调用的表单吗？您是否检查文件是否已发送到上传脚本（带有`print_r($_FILES["file"]`）。如果正确，您是否检查相对路径是否正确？您必须从当前脚本开始（如果包含文件，则必须从包含脚本开始）。抱歉，如果答案看起来很简单，但是发布的代码太短而无法评估。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T22:03:16.843

在您的表单标签中，您需要这样的 `<form enctype="multipart/form-data" action="uploader.php" method="POST">` 内容确保文件的 enctype 设置为 multipart/form-data。将 uploader.php 替换为进行处理的 php 文件的名称。还要确保设置了您的权限，以便可以在目录中创建文件。

以下是可能出现的问题列表：http: [//php.net/manual/en/features.file-upload.php](http://php.net/manual/en/features.file-upload.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-29T22:11:44.783

您是否检查过“网络服务器用户”对“../media”有写入权限？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-20T13:53:29.993

我遇到了同样的问题。我正在使用 ubuntu 18.04，当我在终端上使用此权限命令时，它已解决。 ***须藤 chmod -R 777 /var/www/html/target_dir***。-> 我有 apache2 Web 服务器和 target_dir 作为下载，所以根据您的目标目录替换 target_dir。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-19T06:58:54.223

确保在您的表单中..您输入了enctype。

```
move_uploaded_file($file_tmp,"images/".$file_name);
echo "Success 
```

# javascript - 点击时获取标记的ID

> ID：10807289
> 
> 赞同：4
> 
> 时间：2012-05-29T21:58:54.760
> 
> 标签：javascript, ruby-on-rails, gmaps4rails

我正在使用 gmaps4rails 将地图添加到我的 rails 应用程序。我正在尝试通过单击标记来记录用户的年龄。

在我的索引操作中，我有 -

```
 @json = User.all.to_gmaps4rails do |user, marker|
      marker.json({ :id => user.id, :age => user.age })
    end 
```

这是创建地图并添加我所有的标记。

如果我将 Gmaps.map.markers[0] 放在我的 js 控制台中，我可以看到我的对象并且可以看到它具有年龄属性。

我正在尝试通过执行以下操作来通过单击记录该属性-

```
<script type="text/javascript">
  Gmaps.map.callback = function() {
  for (var i = 0; i <  this.markers.length; ++i) {
    google.maps.event.addListener(
     Gmaps.map.markers[i].serviceObject, 'click', function() { console.log(this.age) });
  }
 };        
</script> 
```

this.age 未定义。显然，它记录的是 serviceObject 而不是标记对象。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:27:17.987

您正在使用闭包，并且遇到了一个问题，即“this”并不指代您认为它所指的对象。为了引用 Gmaps.map.markers[*]，首先创建一个立即函数，按值传入 'i'，并返回一个记录 .age 属性的函数：

```
<script type="text/javascript">
  Gmaps.map.callback = function() {
  for (var i = 0; i <  this.markers.length; ++i) {
    google.maps.event.addListener(
     marker.serviceObject, 'click', (function(i) {
        return function() {
            console.log(Gmaps.map.markers[i].age) 
        }
    })(i));
  }
 };        
</script> 
```

在循环中声明函数（闭包）可能很棘手。这是我发现的一个非常有用的演练解释：[http ://www.mennovanslooten.nl/blog/post/62](http://www.mennovanslooten.nl/blog/post/62)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:18:27.960

要正确使用闭包，请执行以下操作：

```
<script type="text/javascript">
  Gmaps.map.callback = function() {
  for (var i = 0; i <  Gmaps.map.markers.length; ++i) {
    marker = Gmaps.map.markers[i];
    google.maps.event.addListener(
     marker.serviceObject, 'click', function() { console.log(marker.age) });
  }
 };        
</script> 
```

# java - eclipse没有对CTRL + Space提供任何帮助

> ID：10807291
> 
> 赞同：0
> 
> 时间：2012-05-29T21:59:03.247
> 
> 标签：java, eclipse, jsp, jsf, facelets

当我在 Eclipse 中使用 .jsp 文件时，我正在为标签提供帮助......

我在哪里添加标签库...

```
<%@ taglib prefix="h" uri="http://java.sun.com/jsf/html" %>
<%@ taglib prefix="f" uri="http://java.sun.com/jsf/core" %> 
```

现在我转换`.jsp`到`.xhtml`其中我不能添加上面的标签库，而是我必须使用

```
<html xmlns="http://www.w3c.org/1999/xhtml"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:p="http://primefaces.prime.com.tr/ui"> 
```

在这种情况下，eclipse 在 CTRL + Space 上没有给我任何帮助。有什么方法可以开始这些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:03:54.193

Eclipse 还没有安装 Facelets 工具。到目前为止，只有[Glassfish Server 插件](http://glassfishplugins.java.net/eclipse36/index.html)和[JBoss Tools 插件](http://www.jboss.org/tools)带有 Facelets 工具。

根据您[之前的问题](https://stackoverflow.com/questions/10806915/jsf-beginning-installation-ui-error)，您使用的是 Tomcat，所以 JBoss Tools 应该这样做（它实际上比 Glassfish Server 插件功能更丰富）。在 Eclipse 中进入*Help > Install New Software*。假设您使用的是当前的 Eclipse Indigo SR2 版本，请在其中输入以下 URL：

> [http://download.jboss.org/jbosstools/updates/indigo/SR2/](http://download.jboss.org/jbosstools/updates/indigo/SR2/)

等到选项列表加载，最后选择并安装“JBoss Web 和 Java EE 开发”选项。

* * *

**与具体问题无关**，根据您之前的问题，您已经安装了 PrimeFaces 3.2。但是您使用的是旧的 PrimeFaces 2.x XML 命名空间 URI。修复它：

```
xmlns:p="http://primefaces.org/ui" 
```

# html - 使用 CSS3 和 HTML5 的垂直文本？

> ID：10807293
> 
> 赞同：3
> 
> 时间：2012-05-29T21:59:18.013
> 
> 标签：html, css, svg

使用静态网页，有没有办法将文本旋转 90 度？如果是这样，这种方法是否有任何可能的陷阱？

我也在考虑使用 SVG。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:11:07.463

```
p{
    transform:rotate(90deg);
    -moz-transform:rotate(90deg);
    -o-transform:rotate(90deg);
    -webkit-transform:rotate(90deg);
    -ms-transform:rotate(90deg);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T00:10:06.590

他所说的还包括：

-webkit-transform-origin：0 0；
-moz 变换原点：0 0；
-ms 转换原点：0 0；
-o-transform-origin: 0 0;

有点像重置默认值。我有一个实时链接，如果需要，我可以发送给您。确保您进行了多次测试，如果我没记错的话，它在 IE8 中不起作用。

# php - MYSQL查询JOIN多个字段到一个字段

> ID：10807297
> 
> 赞同：1
> 
> 时间：2012-05-29T21:59:58.370
> 
> 标签：php, mysql, join, union

我试着四处寻找答案，但没有找到一个似乎能让我进入我想要的地方的答案。我现在有两张桌子，我正在尝试加入。

胶粘剂表

```
id | adhesive_name | adhesive_code
1  | Ivory         | 0090
2  | Jet Black     | 0100
3  | Khaki         | 0110
4  | Natural       | 0120 
```

和一个 match_table

```
id | brand_id | sheet_name | match_1 | match_2
1  | 1        | Wheat      | 0110    | 0120
2  | 1        | Dew        | 0090    | 0110 
```

等等......有成千上万的火柴和数百种粘合剂。我正在尝试获取匹配项并使用 JOIN 返回相应的粘合剂名称。

```
$sql = "SELECT * FROM match_table
JOIN adhesive_table
ON match_table.match_1 = adhesive_table.adhesive_code
WHERE match_table.brand_id
IN ($b)"; 
```

（$b 是通过 $.post 发送的，并且对应于 brand_id）

这对于单个匹配项来说效果很好。但是对于许多人来说，还有一个由 match_2 指示的第二个（替代）匹配。所以我一直在尝试让 JOIN 工作，我可以在其中获取匹配 1、2、3 的名称，但无济于事。我一直在尝试这样的查询：

```
$sql = "SELECT * FROM match_table
LEFT JOIN adhesive_table
ON match_table.match_1 = adhesive_table.adhesive_code
LEFT JOIN adhesive_table
ON match_table.match_2 = adhesive_table.adhesive_code
WHERE match_table.brand_id
IN ($b)"; 
```

或者

```
$sql = "SELECT * FROM match_table
JOIN adhesive_table
ON match_table.match_1 = adhesive_table.adhesive_code
AND match_table.match_2 = adhesive_table.adhesive_code
WHERE match_table.brand_id
IN ($b)"; 
```

但两者都不起作用。我想知道我的表格的格式是否会阻止它工作，或者我是否遗漏了一些明显的东西。这是需要使用 group_concat 的地方吗？

感谢您的任何帮助，您可以提供。

我应该添加我希望得到的表，结果如下：

```
brand_id = 1
sheet_name = Wheat
 match_1 = (adhesive_code & adhesive_name) 0110 Khaki
 match_2 = (adhesive_code & adhesive_name) 0120 Natural 
```

查询后将结果放入数组

```
$arr = array();
$result = mysql_query($sql);
if($result) {
    while($row = mysql_fetch_array($result)){
        $arr[] = $row;
} 
} else {
$arr[] = "";
}
echo json_encode($arr); 
```

这被发送回我的主文件，我在一个看起来像这样的循环中得到结果：

```
$.post("getmatches.php",{checkedBrand:checkedBrand},function(json){
    for(var i=0; i<json.length; i++){
        htmlFormat += 
        " sheet : " + json[i].sheet_name
        + " - " + "match_1 : " + json[i].adc1 
        + " - " + "name : "  + json[i].ad1
        + " - " + "match_2 : " + json[i].adc2
        + " - " + "name : "  + json[i].ad2
        + "<br />";
    } // end for loop
    $(".stuffs").html(htmlFormat)
}) // end post 
```

非常感谢Sebas的耐心和帮助，最终使用的工作方法如下。我添加了选择列 AS 别名，以便我可以在 json 返回后在 javascript 中引用它们。

```
$sql="
SELECT brand_id, sheet_name, a.adhesive_name AS ad1, a.adhesive_code AS adc1, b.adhesive_name ad2, b.adhesive_code adc2
FROM match_table
LEFT JOIN adhesive_table a ON match_table.match_1 = a.adhesive_code
LEFT JOIN adhesive_table b ON match_table.match_2 = b.adhesive_code
WHERE
match_table.brand_id IN ($b)"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:08:46.287

```
$sql="SELECT id, brand_id, sheet_name, a.adhesive_name, a.adhesive_code FROM match_table 
INNER JOIN adhesive_table a
ON match_table.match_1 = a.adhesive_code
WHERE match_table.brand_id
IN ($b)
UNION
SELECT id, brand_id, sheet_name, a.adhesive_name, a.adhesive_code FROM match_table 
INNER JOIN adhesive_table a 
ON match_table.match_2 = a.adhesive_code
WHERE match_table.brand_id
IN ($b)"; 
```

编辑：我编辑了上面的查询，以更清楚地在单独的行中显示两个匹配项。另一方面，如果您希望它们都在同一行，这是另一个不同的：

```
$sql="
SELECT id, brand_id, sheet_name, a.adhesive_name, a.adhesive_code, b.adhesive_name, b.adhesive_code 
FROM match_table 
    LEFT JOIN adhesive_table a ON match_table.match_1 = a.adhesive_code
    LEFT JOIN adhesive_table b ON match_table.match_2 = b.adhesive_code
WHERE 
    match_table.brand_id IN ($b)
AND (a.id IS NOT NULL OR b.id IS NOT NULL)"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:07:20.153

您的第一次尝试很好，除了一个细节：如果您在同一张桌子上加入两次，请使用别名：

```
SELECT * FROM match_table
LEFT JOIN adhesive_table ad1 ON match_table.match_1 = ad1.adhesive_code
LEFT JOIN adhesive_table ad2 ON match_table.match_2 = ad2.adhesive_code
WHERE match_table.brand_id=1; 
```

# c++ - 我什么时候应该使用参考？

> ID：10807299
> 
> 赞同：0
> 
> 时间：2012-05-29T22:00:03.197
> 
> 标签：c++

新手，我正在阅读一些代码，有时我看到作者在函数中使用了引用作为

```
funca (scalar& a)
// Etc 
```

有时他只是使用

```
funcb (scalar a)
// Etc 
```

有什么不同？使用参考是我应该养成的好习惯吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T22:02:03.787

如果您调用，类型`foo(scalar a)`的参数将从调用者那里复制，而 foo 将拥有原始对象的自己的副本。`a``scalar`

如果您调用`foo(scalar &b)`，参数`b`将只是对原始对象的引用，因此您将能够修改它。

使用 &name 语法通过引用传递对象更快，因为它避免了创建给定对象的副本，但它可能存在潜在危险，有时这种行为是不需要的，因为您只想要一个实际的副本。

话虽如此，实际上有一个选项不允许修改被调用函数的原始对象但避免创建副本。它`foo(const scalar &x)`明确指出调用者不希望函数`foo`修改作为参数传递的对象。

**选读**，仔细：

还有一种将参数作为原始指针传递的方法，这在现代 C++ 中非常罕见。谨慎使用：`foo(scalar *a)`. 在这种情况下，调用者必须提供对象的地址而不是对象本身，因此调用者会调用`foo(&a)`. 在这种情况下，为了让被调用函数`foo`能够修改对象本身，它需要*取消引用*指针`a`，就像在`foo`:中一样`*a =`。在这种情况下，变量名前面的星号表示我们不想修改我们收到的地址（作为调用函数提供的直接结果`&a`，即对象a的地址）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T22:01:44.743

通过引用传递参数允许被调用函数以在函数返回后对调用者可见的方式修改其参数，而通过值传递意味着任何更改都将限制在被调用函数的范围内。因此，通过（非常量）引用传递通常表示被调用者打算修改参数，或者不太常见地将其用作附加的“返回值”。

此外，通过引用传递意味着不需要复制参数；按值传递需要这样的副本（这可能不利于应用程序的内存占用或运行时性能）。出于这个原因，您经常会看到类类型的参数作为`const`引用传递：被调用者不打算修改参数，但它也希望避免复制。标量参数的大小非常小，因此它们不会从这种方法中受益。

另请参阅[C++ 中的通过引用/值传递](https://stackoverflow.com/questions/410593/pass-by-reference-value-in-c)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T22:05:03.223

按值调用 ( `funcb (scalar a)`) 将为函数提供参数的副本，因此对参数所做的更改对调用者不可见。

通过引用调用 ( `funcb(scalar& b)`) 意味着函数直接对参数进行操作，因此所做的任何更改对调用者都是直接可见的。

通过引用调用是否是一种好的做法取决于具体情况。如果您需要该函数来修改参数（以及对调用者可见的修改），您显然希望使用引用调用。如果您不想使用非常量引用参数修改参数会产生误导（因为签名表明参数可以更改），因此此处按值调用更合适。当然，对于更复杂的类型，按值调用可能会有不小的开销。在这些情况下，按常量引用调用更可取 ( `funcc(const scalar& c)`)

# css - 在 LESS 中正确使用“混合”

> ID：10807304
> 
> 赞同：0
> 
> 时间：2012-05-29T22:00:08.233
> 
> 标签：css, less, mixins

我正在尝试使用 less 创建简单的“模板”，但我想我可能做错了..

这就是我想要的：

```
<div class='box'>content</div> 
```

和 .less 文件：

```
//this is the mixin

.blueBoxNotificationDiv {
    text-decoration: none !important;
    position: absolute;
    background: #EBEBEB;
    width: 100%;
    border-top: 1px solid #999;
    bottom: 0;
    height: 21px;
} 
```

现在假设我想将此“mixin”应用于 div '.box'。这就是我将它写在.less中的方式：

```
.box {
    .blueBoxNotificationDiv;
} 
```

解决这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:49:18.197

如果没有正确写出 LESS 变量（包括规则），将阻止在您的 less 文件中读取任何其他内容。

问题示例：

```
@color1: #000000;
@color2: #ffffff;
@color3: ##e6e6e6;

.container {
    color:@color1;
}

.....etc 
```

这应该很明显，但是很容易忽略小错误。变量“@color3”有两个散列“##”。如果您不调用该变量并且不会读取以下任何代码（据我所知），这将破坏更少的 EVEN。问题解决了！

# python - 非阻塞和多线程 - Socksipy & Socks

> ID：10807307
> 
> 赞同：4
> 
> 时间：2012-05-29T22:00:13.400
> 
> 标签：python, multithreading, socks

我需要检查我的代理与特定服务器端口。我只是使用 SocksiPy 作为 Socks 的代理包装器。好吧，它有效，但它该死的慢：/

我猜是因为我不使用非阻塞套接字。我尝试了 .setblocking(0) 但我所有的检查都在瞬间“失败”。

```
#! /usr/bin/python
import time, Queue, threading, socks

t = time.time()
queue = Queue.Queue()

class ThreadUrl(threading.Thread):
    def __init__(self, queue):
        threading.Thread.__init__(self)
        self.queue = queue
    def run(self):
        while True:
            host = self.queue.get()
            id = host[0]
            ip = host[1]
            port = host[2]
            type = host[3]
            retry = host[4]

            try:
                s = socks.socksocket()
                s.settimeout(10)
                #s.setblocking(0) <- i tried this but well, when i use this all my proxy checks end up instant with FAIL :/
                if(type == 'HTTP' or type == 'HTTPS'):
                    s.setproxy(socks.PROXY_TYPE_HTTP, ip, int(port))
                else:
                    #because i dont know if the socks i have is for socks 4 or 5 i have to use this
                    if(retry == 1):
                        s.setproxy(socks.PROXY_TYPE_SOCKS5, ip, int(port))
                    else:
                        s.setproxy(socks.PROXY_TYPE_SOCKS4, ip, int(port))
                s.connect(('127.0.0.1', 1337))
                s.send('\r\n')
                data = s.recv(10)
                s.close()
                if( len(data) > 0 ):
                    print "GOOD PROXY: %s TYPE: %s" % (id, type)
            except:
                if(retry == 1):
                    print "SOCKS5 BAD: %s TYPE: %s" % (id, type)
                elif(retry == 0 and type == 'Socks 4/5'):
                    print "SOCKS4 BAD: %s TYPE: %s" % (id, type)
                    #because i dont know if the socks i have is for socks 4 or 5 i have to use this and requeue the proxy with the retry indicator set to 1 (socks5 testing)
                    queue.put([id, ip, port, type, 1])
                else:
                    print "HTTP/S BAD: %s TYPE: %s" % (id, type)

            self.queue.task_done()

def main():

    proxies = ((id,ip,port,type),(...))

    for i in range(4):
        t = ThreadUrl(queue)
        t.setDaemon(True)
        t.start()

    for item in proxies:
        queue.put([item['proxy_id'], item['proxy_ip'], item['proxy_port'], item['proxy_type'], 0])

    queue.join()

main()
print "Established Time: %.2f" % (time.time()-t) 
```

感谢您的帮助，干杯:)

# php - system 和 shell_exec 的区别

> ID：10807309
> 
> 赞同：6
> 
> 时间：2012-05-29T22:00:20.263
> 
> 标签：php, shell

PHP中的方法`shell_exec`和方法有什么区别？`system`

两者都采用单个命令行参数并在 PHP 中运行。使用一个比另一个更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:04:22.770

请参阅此处的说明：

[http://chipmunkninja.com/Program-Execution-in-PHP%3A-exec-m@](http://chipmunkninja.com/Program-Execution-in-PHP%3A-exec-m@)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T22:07:32.887

用系统可以捕获返回码。已经用 shell_exec 是不可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T22:04:49.820

我认为主要的不同是 PHP 在安全模式下运行时。如文档中所述，系统仍将受到一些限制，但是 shell_exec 将被禁用。

# c - 平台与 vsprintf 和 va_list 不一致

> ID：10807310
> 
> 赞同：4
> 
> 时间：2012-05-29T22:00:24.660
> 
> 标签：c, variadic-functions, printf

背景：我目前正在尝试通过支持处理某个结构来“扩展”标准 C 格式，类似于 Objective-C 如何扩展 C 格式以允许使用“%@”序列支持 NSString。

我正在努力解决的一个问题是 vsprintf 在 OS X 和 Linux 上的表现似乎不同（我已经用 Ubuntu 10.10 和 12.04 进行了测试）。在 OS X 上，它的行为是我认为应该的，在调用 vsprintf 之后，调用 va_arg 返回 ms 指针（好像调用 va_arg 的 vsprintf 函数得到 5）。然而，在 Linux 上，va_list 不会从 vsprintf 更改，并且调用 va_arg 返回 5。

我真的很想找到一种实现此功能的方法，以便它在跨平台的行为中保持一致。假设您可以期望 vsprintf 始终更改 va_list 中的指针以便下次调用 va_arg 它返回下一个尚未使用的参数，这是错误的吗？

我已经尽可能简化了我的代码来演示这个问题。在 OS X 上，此代码打印从 malloc 返回的指针的正确地址。在 Linux 上， foo 中 ms 的值变为 5，因此它打印 5。

```
#include <stdlib.h>
#include <stdio.h>
#include <stdarg.h>
#include <string.h>

static void foo(void *, ...);

typedef struct {
    char *value;
} mystruct;

int main(int argc, char *argv[]) {
    mystruct *ms = malloc(sizeof(mystruct));
    foo(NULL, "%d %@", 5, ms);
}

void foo(void *dummy, ...) {
    va_list args;
    va_start(args, dummy);
    char buffer[512];
    int buffer_ptr = 0;
    int i = 0;
    char *format = va_arg(args, char *);

    buffer[0] = '\0';

    for (i = 0; i < strlen(format); i++) {
        if (i <= strlen(format) - 1 && (format[i] == '%' && format[i+1] == '@')) {
            vsprintf(buffer, buffer, args);

            /* can expect the next argument to be a mystruct pointer */
            mystruct *ms = va_arg(args, mystruct *);
            buffer[buffer_ptr+1] = '\0';
            fprintf(stderr, "%p", ms); /* SHOULD NOT PRINT 5 */

            /* concatenate here */  
        } else {
            buffer[buffer_ptr++] = format[i];
            buffer[buffer_ptr] = '\0';
        }
    }

    va_end(args);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T22:06:42.677

[`va_copy`](http://linux.die.net/man/3/va_copy)如果您要多次使用参数列表，则需要使用 - 不这样做是未定义的行为。您的代码应如下所示：

```
va_list args;
va_start(args, dummy);
...
char *format = va_arg(args, char *);
...
va_list argsCopy;
va_copy(argsCopy, args);
vsprintf(..., argsCopy);
va_end(argsCopy);
...
mystruct *ms = va_arg(args, mystruct *);
...
va_end(args); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T00:48:37.023

问题在于，如何实现 a 取决于实现`va_list`——它可能包含用于直接提取参数的所有信息和状态，或者它可能包含指向间接持有状态的指针。因此，将其传递给 vsprintf 可能会复制所有相关状态，也可能不会。

您想要做的是一个类似于 vspintf 的函数，它采用 a`va_list *`而不是 a `va_list`，因此您可以确保在它返回后您具有正确的状态。不幸的是，该标准没有提供任何此类功能。

# android - 放置SharedPreferenceChangeListener 的最佳位置

> ID：10807316
> 
> 赞同：3
> 
> 时间：2012-05-29T22:01:16.190
> 
> 标签：android, sharedpreferences

我正在尝试向我的应用程序添加设置。我已经添加了新设置，但我不知道该放在哪里`OnSharedPreferenceChangeListener`。我把它放在活动中并添加了一个`Log.d()`，但`Log.d()`从未触发过。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-29T12:58:52.063

根据[Android Settings doc](http://developer.android.com/guide/topics/ui/settings.html#Listening) ，最好的地方是：

```
@Override
protected void onResume() {
    super.onResume();
    getPreferenceScreen().getSharedPreferences()
            .registerOnSharedPreferenceChangeListener(this);
}

@Override
protected void onPause() {
    super.onPause();
    getPreferenceScreen().getSharedPreferences()
            .unregisterOnSharedPreferenceChangeListener(this);
} 
```

并且您应该将侦听器存储在字段变量中（或使用 Activity 对象本身 - 如上面的源代码），这样它就不会被垃圾收集。

即匿名类对象不能用作`OnSharedPreferenceChangeListener`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T00:51:55.040

您需要通过调用来注册您的侦听器[`setOnPreferenceChangeListener`](http://developer.android.com/reference/android/preference/Preference.html#setOnPreferenceChangeListener%28android.preference.Preference.OnPreferenceChangeListener%29)。我将假设您有一个扩展[PreferenceActivity](http://developer.android.com/reference/android/preference/PreferenceActivity.html)的 Activity 类。如果是这样，那对你的听众来说是最好的地方。你会写这样的东西：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Load the preferences from an XML resource
    addPreferencesFromResource(R.xml.preferences);

    Preference myPreference = findPreference("my_pref");
    myPreference.setOnPreferenceChangeListener(this);
} 
```

# java - 从控制台运行与作为服务运行时 Java Service Wrapper 出现问题

> ID：10807325
> 
> 赞同：1
> 
> 时间：2012-05-29T22:01:59.000
> 
> 标签：java, windows, registry, 32bit-64bit, java-service-wrapper

我有一个访问注册表项的 Java Service Wrapper 应用程序。（是的，我知道，很奇怪，嗯？如果您想知道，我正在使用 David 对[这个问题](https://stackoverflow.com/questions/62289/read-write-to-windows-registry-using-java)的解决方案来使用 Java 从注册表中读取数据。）

在 32 位版本的 Windows 上一切正常。我可以从控制台（使用 Java Service Wrapper 的 .bat 文件）和从 bat 文件安装的服务运行我的应用程序。我可以从 Windows 注册表中看到我需要的各种东西。

但是，在 64 位 Windows 系统上，当我将应用程序作为服务运行时，我再也看不到我需要的注册表项；这些条目似乎都为空。但是，它仍然可以在控制台中运行！

我的假设是，当从控制台运行时（作为管理用户，如果相关的话）Java Service Wrapper 会启动一个 64 位 JVM 并能够访问常规的 64 位注册表。然后，当作为服务运行（通过 LOCALSYSTEM 用户）时，它会启动一个 32 位 JVM（然后它会尝试访问 Wow6432bit 节点中的 oh-so-special 32 位注册表。我正在寻找的条目是该节点不存在，这将解释为什么在这种情况下我会为它们获取空值。

这引出了我的问题：为什么 Java Service Wrapper 在通过服务列表启动时会启动 32 位 JVM，为什么从控制台启动时会启动 64 位 JVM？

注意：我使用的是 Java Service Wrapper 3.5.14，在我的配置文件中我有

`wrapper.java.additional.auto_bits=TRUE`

理想情况下，我希望自动选择 JVM，这样我就可以使用一个安装程序在 32 位和 64 位系统上部署我的软件。（事实上​​，这是我选择使用 JSW 而不是 Tomcat 的原因之一。）

非常感谢您的阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:41:25.293

事实证明，我的安装程序（我用来安装和启动服务）是一个 32 位应用程序，它会导致 Java Service Wrapper .bat 文件在安装过程中在 32 位环境中运行。由于 64 位系统上没有 32 位 Java，这意味着包装器找不到 Java。

诀窍（我从 Tanuki Software 的支持人员那里学到的）是告诉 .bat 文件运行 64 位包装器，如果知道我们在 64 位系统上的 32 位环境中运行。

Basically, in the .bat file, find these lines and insert the indicated line. If I encounter further problems, I'll update my answer. But for now, this solution seems to work well for me quite nicely.

```
rem
rem Decide on the specific Wrapper binary to use (See delta-pack)
rem
if "%PROCESSOR_ARCHITEW6432%"=="AMD64" goto amd64 (<---- insert this line)
if "%PROCESSOR_ARCHITECTURE%"=="AMD64" goto amd64
if "%PROCESSOR_ARCHITECTURE%"=="IA64" goto ia64 
```

# ruby-on-rails-3 - Rails 一对多关联不返回记录

> ID：10807332
> 
> 赞同：1
> 
> 时间：2012-05-29T22:02:48.757
> 
> 标签：ruby-on-rails-3, rails-models

我是 Rails 新手，和许多人一样，我似乎在弄清楚 ActiveRecord 和关联如何工作时遇到了挑战。

我有三个模型，用户，项目和任务：

```
Class User < ActiveRecord::Base
    has_many :projects
    has_many :tasks
end

Class Project < ActiveRecord::Base
    has_many :tasks
    belongs_to :user
end

Class Task < ActiveRecord::Base
    belongs_to :projects
    belongs_to :user
end 
```

Projects 和 Tasks 都有字段`user_id`。任务有领域`project_id`。

我希望能够通过用户查找所有项目和任务。但是，每次尝试时，即使有项目和任务，我也会得到一个空白数组：

```
usr = User.find(1)
=> [User id: 1, name: "Some Guy"]
usr.projects
=> []
usr.tasks
=> [] 
```

当我通过项目查询任务时，它确实有效：

```
proj = Project.find(1)
=> [#<Project id: 1, user_id: 1, description: "Some Project">]
proj.tasks
=> [#<Task id: 1, user_id: 1, project_id: 1, description: "Do Something">, 
   #<Task id: 2, user_id: 1, project_id: 1, description: "Do another thing">] 
```

我相信`has_many`和`belongs_to`设置是正确的，因为我有其他模型连接到用户并且它们可以正常工作。有什么我想念的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:41:32.953

我通过更改模型关联来解决这个问题。我`belongs_to :user`从 Task 模型中删除了，并添加了`has_many :through`与 User 模型的关系：

```
Class User < ActiveRecord::Base
    has_many :projects
    has_many :tasks, :through => :projects
end

Class Project < ActiveRecord::Base
    has_many :tasks
    belongs_to :user
end

Class Task < ActiveRecord::Base
    belongs_to :projects
end 
```

重新启动控制台后，我现在可以按照我最初尝试的方式提取属于用户的任务：

```
usr = User.find(1)
usr.projects
=>[#<Project id: 1, user_id: 1, description: "Some Project">]
usr.tasks
=>[#<Task id: 1, project_id: 1, description: "Do Another Thing">] 
```

# regex - 创建一个重写规则，接受变量输入并重定向到带有查询字符串的文件

> ID：10807335
> 
> 赞同：1
> 
> 时间：2012-05-29T22:03:06.457
> 
> 标签：regex, apache, mod-rewrite

如何编写重写规则，以便它包含 URL 的一部分并将用户重定向到以 URL 的该部分作为查询字符串的文件。

具体来说，我想从以下重定向用户：

```
http://localhost/SR/XXYYYZZ 
```

到以下：

```
http://localhost/sr.php?sr=XXYYZZ 
```

这是我编写规则的方式：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/SR/(.*)$
RewriteRule ^SR/(.*)$ sr.php?sr=$1 [L] 
```

这显然是行不通的。如果这很明显，我很抱歉。当谈到 Apache 和正则表达式时，我真的是一个初学者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:07:29.897

你在正确的轨道上。试试这个：

```
RewriteEngine on
RewriteBase /dev/m/
RewriteRule ^sr/(.+)$ sr.php?sr=$1 [L,NC,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T13:23:16.090

```
RewriteEngine On
RewriteRule ^/SR/ sr.php [L] 
```

或者

```
RewriteEngine On
RewriteBase /
RewriteRule ^SR/ sr.php [L] 
```

然后在`sr.php`

```
$sr = substr($_SERVER['REQUEST_URI'], 4); 
```

这避免了 mod_rewrite 的参数转义问题。

# objective-c - 如何从 App Delegate 中展示我的主 TabBar 控制器？

> ID：10807336
> 
> 赞同：0
> 
> 时间：2012-05-29T22:03:10.773
> 
> 标签：objective-c, ios, xcode

我真的被这个问题困住了，如果有人能指出我正确的方向，我将不胜感激......

我正在构建一个带有用于主导航的选项卡栏的 iOS 应用程序。

用户需要注册/登录才能看到主屏幕和标签栏。

用户可以使用 Facebook Connect 登录和注册。

该应用程序与我们自己的 API 进行通信。

目前...当 UITabBarController 的初始视图被加载时，它将检查是否存在当前用户，如果没有，将显示登录屏幕。

```
if (sessionID == (id)[NSNull null] || sessionID.length == 0){
    NSLog(@"session ID was null");
    SHOW_SIGN_IN_SCREEN;
}

#define SHOW_SIGN_IN_SCREEN SignInController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"SignInScreen"];\
[self presentViewController:controller animated:NO completion:nil]; 
```

**从登录屏幕...用户可以触摸“使用 Facebook 登录”按钮或创建一个与注册屏幕**相连的新帐户。注册屏幕有一个供用户填写的表格，或者他们可以点击“使用 Facebook 注册”按钮以使用 Facebook 图表提供的他们的 Facebook 详细信息创建一个帐户。

Facebook 回调都由应用程序委托处理，这是我遇到的问题。

API 不关心从应用程序发送的用户凭据是针对新用户还是现有用户。在任何一种情况下，API 都会返回一个有效的会话 ID 以供应用程序继续。

一旦 API 做出响应，应用程序委托应该将用户返回到主标签栏视图控制器，这是我卡住的地方。

目前，我在 AppDelegate 中有这个

```
// app delegate
-(void)segueToMainTabController
{
    NSLog(@"segueToMainTabController");
    SignInController *controller = (SignInController *)[self.window.rootViewController presentedViewController];
    [controller segueToWelcomeScreen];
}

// sign in controller 
-(void)segueToWelcomeScreen
{
    NSLog(@"segueToWelcomeScreen");
    [self performSegueWithIdentifier:@"SignInToMainTabBar" sender:self];
} 
```

哪个*被*调用但没有执行 segue ......

谁能告诉我为什么不执行这个segue？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:35:43.523

我有一个应用程序，我需要在我的 AppDelegate 中劫持初始视图，所以也许你可以做类似的事情。根据您的情况，也许可以尝试在您的`application:didFinishLaunchingWithOptions:`

```
if (sessionID == (id)[NSNull null] || sessionID.length == 0){
    // whatever you need to do to initialize for the login screen
    // you should make the login view the initial view in your storyboard
}
else { // hijack the initial view to show the tab bar   
    UIStoryboard *storyboard = self.window.rootViewController.storyboard;
    MyTabViewController *tabViewController = [storyboard instantiateViewControllerWithIdentifier:@"MyTabViewController"];

    self.window.rootViewController = tabViewController;
    [self.window makeKeyAndVisible];
} 
```

希望有帮助。

# java - Spring Roo update.jspx @Transient 密码字段

> ID：10807337
> 
> 赞同：1
> 
> 时间：2012-05-29T22:03:14.330
> 
> 标签：java, hibernate, model-view-controller, spring-roo

我的 Roo 生成的（Web MVC，Hibernate）Person 类有一个 @PreUpdate @PrePersist 方法，由我添加，用于在将用户数据存储到数据库之前加密密码。此方法比较密码和密码确认 (@Transient) 表单字段，如果它们相等，则加密密码。在 create.jspx 中一切正常。但是update.jspx 不会将passwordConfirmation 表单值传递给Person.passwordConfirmation。我哪里错了？

更新.jspx：

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<div xmlns:field="urn:jsptagdir:/WEB-INF/tags/form/fields" 
xmlns:form="urn:jsptagdir:/WEB-INF/tags/form" 
xmlns:jsp="http://java.sun.com/JSP/Page" 
xmlns:spring="http://www.springframework.org/tags" version="2.0">
    <jsp:directive.page contentType="text/html;charset=UTF-8"/>
    <jsp:output omit-xml-declaration="yes"/>
    <form:update id="fu_ru_dp_person_domain_Person" 
    idField="idperson" modelAttribute="person" 
    path="/persons" 
    versionField="none" z="Qhcf0JCeZUC6aMA3/6/5aDbQ13g=">
...
        <field:input field="password" id="c_ru_dp_person_domain_Person_password" required="true" type="password"  z=""/>
        <field:input field="passwordConfirmation" id="c_ru_dp_person_domain_Person_passwordConfirmation" required="true" type="password" z=""/> 
```

创建.jspx：

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<div xmlns:c="http://java.sun.com/jsp/jstl/core" 
xmlns:field="urn:jsptagdir:/WEB-INF/tags/form/fields" 
xmlns:form="urn:jsptagdir:/WEB-INF/tags/form" 
xmlns:jsp="http://java.sun.com/JSP/Page" 
xmlns:spring="http://www.springframework.org/tags" version="2.0">
    <jsp:directive.page contentType="text/html;charset=UTF-8"/>
    <jsp:output omit-xml-declaration="yes"/>
    <form:create id="fc_ru_dp_person_domain_Person" 
    modelAttribute="person" path="/persons" 
    render="${empty dependencies}" z="+YEbyTqiV2xT0u7rtPVJy3fd4Zw=">
        ...
        <field:input field="password" id="c_ru_dp_person_domain_Persons_password" required="true" type="password" z=""/>
        <field:input field="passwordConfirmation" id="c_ru_dp_person_domain_Person_passwordConfirmation" required="true" type="password" z="user-managed"/> 
```

人.java：

```
 @PrePersist
    @PreUpdate
    protected void encryptPassword() {
        String pwd = this.getPassword(), pwd2 = this.getPasswordConfirmation();
        if (pwd2 != null && pwd.equals(pwd2)) {
            this.setPassword(passwordEncoder.encodePassword(pwd, null));
        }
    } 
```

# virtualenv - Python virtualenvwrapper 初始化错误

> ID：10807339
> 
> 赞同：2
> 
> 时间：2012-05-29T22:03:14.973
> 
> 标签：virtualenv, virtualenvwrapper

重新启动我的机器后，当我的登录脚本调用它时，我可以看到 virtualenv 无法设置。

我的 .bashrc 包含

```
 export WORKON_HOME=~/.virtualenvs
 source /usr/local/bin/virtualenvwrapper.sh 
```

错误看起来像

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Python/2.7/site-packages/virtualenvwrapper/hook_loader.py", line 12, in <module>
    import optparse
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/optparse.py", line 77, in <module>
    import textwrap
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/textwrap.py", line 32, in <module>
    class TextWrapper:
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/textwrap.py", line 74, in TextWrapper
    whitespace_trans = string.maketrans(_whitespace, ' ' * len(_whitespace))
AttributeError: 'module' object has no attribute 'maketrans'
virtualenvwrapper.sh: There was a problem running the initialization hooks. If Python could not import the module virtualenvwrapper.hook_loader, check that virtualenv has been installed for VIRTUALENVWRAPPER_PYTHON=/usr/bin/python and that PATH is set properly. 
```

据我所知，错误消息中提到的项目看起来还不错，

```
ytestpythonapp$ls /Library/Python/2.7/site-packages/
README                                pip-1.1-py2.7.egg                     virtualenv.py                         virtualenv_support                    virtualenvwrapper-3.2-py2.7-nspkg.pth
easy-install.pth                      virtualenv-1.7.1.2-py2.7.egg-info     virtualenv.pyc                        virtualenvwrapper                     virtualenvwrapper-3.2-py2.7.egg-info 
```

和

```
mytestpythonapp$ls /usr/local/bin/ | grep vir
virtualenv
virtualenvwrapper.sh 
```

和

```
mytestpythonapp$echo $PATH
/Users/markdsievers/.virtualenvs/mytestpythonapp/bin:/usr/local/bin:/Users/markdsievers/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/mongodb/bin:/usr/local/cmd:/usr/local/sbin: 
```

我对 Python 还很陌生，但 virualenv 已经工作了几个星期，并且已经重启了很多次，所以我对这一切感到很困惑。任何指针都非常感谢。

OSX 狮子，Python 2.7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T23:16:16.353

您的基本目录中可能有一个与 python 模块名称冲突的文件，即 string.py

# ms-access - MS Access 表单 - 影响数据更新的水平锚点

> ID：10807346
> 
> 赞同：3
> 
> 时间：2012-05-29T22:03:32.960
> 
> 标签：ms-access

使用数据绑定表单运行 Access 2007。

表单Record Source设置为查询，表单中的所有字段都有定义的Control Source；没什么花哨的，只是字段名称。该表单是一个带有记录导航按钮的单一表单，这些按钮执行“下一个记录”和“上一个记录”操作。

当我浏览记录时，标题中的控件会正确更新。但是，如果我将控件水平锚属性更改为“右”，则字段不再在记录导航中更新。这对于文本框和组合框控件都可以观察到。我可以将锚定切换回“左”，并且更新工作正常。

锚定是否有某种原因会影响 Access 表单中的控件更新？或者这是以前观察到的错误？

我能想到的唯一解决方法是在 OnCurrent 事件的表单中分配控件文本/值属性，但这似乎有些草率。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:37:51.177

似乎是一个错误。在 Form_Current 事件上刷​​新表单可以解决问题：

```
Private Sub From_Current()

Me.Refresh

End Sub 
```

# php - 这个代码部分应该去哪里？

> ID：10807347
> 
> 赞同：1
> 
> 时间：2012-05-29T22:03:42.177
> 
> 标签：php, model-view-controller, zend-framework, architecture, frameworks

我有一个简单的网站，用户可以在其中上传图片，并为其命名。

上传表单应该在没有 JavaScript 和 JavaScript 的情况下工作（作为 XHR 层上的表单）。

我有一个：

*   Form_Upload
*   Model_Post（带有网关/映射器）
*   上传控制器
*   SuperDuper - 处理文件上传、生成缩略图、存储图像等的类/资源。

我认为必须在 UploadController::uploadAction 中完成的事情是：

1.  创建新表格
2.  检查它是 POST 请求还是 GET 请求
3.  检查是 XHR 请求还是常规请求
4.  验证表格
5.  从表单下载/接收文件
6.  有效文件的 MIME 类型
7.  使用 SuperDuper 转换文件，并返回附件 ID
8.  如果一切正常，将带有附件 ID 的发布数据保存到数据库
9.  在适当的上下文中返回响应
10.  在适当的上下文中返回错误消息/表单错误

一个动作似乎可以完成很多事情。

并且有很多“ifs”，因为这个动作应该处理不同的上下文：GET、XHR POST、POST。

有没有什么好的 Zend 方法来处理这种情况（我相信它非常流行）。我应该在 Controller 中创建额外的私有函数来处理部分请求，还是根据上下文处理请求？

我的操作现在有 140 行长，而且似乎是错误的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T07:51:51.327

在我看来，您应该为使用 Zend_Form 的表单类提供部分代码。在这个类应该是点1,4,5,6。和 10 你应该更好地显示在 flashmassanger 中。你的其余点必须在行动中，所以你也必须在行动中调用形式。

# javascript - Javascript调用函数表达式

> ID：10807348
> 
> 赞同：7
> 
> 时间：2012-05-29T22:03:50.723
> 
> 标签：javascript

以这种方式调用函数是有意义的：

```
print(square(5));  
function square(n){return n*n} 
```

但是为什么下面的调用不起作用？

```
print(square(5));  
square = function (n) {  
  return n * n;  
} 
```

如果我们坚持使用“square = function (n)”的格式，有什么解决办法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T22:05:33.257

“正常”函数声明被提升到范围的顶部，因此它们始终可用。

变量*声明*也被提升，但直到执行该特定代码行时才会发生*赋值。*

因此，如果您这样做是在范围内`var foo = function() { ... }`创建变量`foo`，并且它最初是`undefined`，并且只有稍后才会为该变量分配匿名函数引用。

如果“稍后”是在您尝试使用它之后，解释器不会抱怨未知变量（毕竟它确实已经存在），但它会抱怨您尝试调用`undefined`函数引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-08T04:53:49.037

```
 var s=function ()
	{
		console.log("hi there");
        document.write("function express called");
		alert("function express called");

	}

	s();
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:07:06.970

您需要更改顺序，在声明和分配变量之前使用它：

```
square = function (n) {//Better use "var" here to avoid polluting the outer scope
  return n * n;  
}  
print(square(5)); 
```

正确的方法`var`：

```
var square = function (n) { // The variable is now internal to the function scope
  return n * n;  
}  
print(square(5)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:07:29.340

在函数表达式中，您像使用任何其他值一样使用函数，您是否期望：

```
print(a);
var a = 5 
```

去工作？（我真的不是在问）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T22:07:54.003

在第二种情况下，`square`是一个需要（重新）赋值的常规变量。考虑：

```
square = function (n) {  
  return "sponge";  
}  
print(square(5));  
square = function (n) {  
  return n * n;  
} 
```

您希望输出在这里是什么？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-01-08T05:04:06.937

```
var s=function ()
	{

		console.log("s");
		alert("function expression with anomious function");

	}

s();

var otherMethod=function ()
	{

		console.log("s");
		alert("function expression with function name");

	}

otherMethod(); 
```

# objective-c - 目标 c - 通过 http POST 发送图像

> ID：10807353
> 
> 赞同：2
> 
> 时间：2012-05-29T22:04:07.067
> 
> 标签：objective-c, ios, http, http-post, nsmutableurlrequest

我试图了解如何使用 http POST 和我当前的客户端-服务器协议设计发送图像。从客户端到服务器的所有消息如下例所示，有一个带有参数的 cmd 字符串`cmd`和一些更相关的命令参数。

例如，这是我向服务器发送短信的方式：

```
- (void)sendMessagesWithText:(NSString *)text fromUser:(NSString *)userId
{
    NSString *url = SERVER_URL;

    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:url]];
    [request setHTTPMethod:@"POST"];

    NSMutableData *body = [NSMutableData data];

    [body appendData:[[NSString stringWithFormat:@"cmd=%@&userid=%@&msgtext=%@", 
                       @"sendmessage", 
                       userId,
                       text] dataUsingEncoding:NSUTF8StringEncoding]];

    [request setHTTPBody:body];

    // send to server
    [[NetworkHelper sharedManager] sendRequest:request]; 
} 
```

现在我想让用户也发送一个图像，但是我如何用我的协议设计发送它？我应该在 cmd 字符串之后将图像附加到正文吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T22:35:27.293

您需要使用 multipart/form-data 发布。

以下是现已失效的 ASI 的示例：[创建和运行请求](http://allseeing-i.com/ASIHTTPRequest/How-to-use)

> 使用 ASIFormDataRequest 发送表单 POST
> 
> 要以与网页表单兼容的方式发送 POST 数据，请使用包含的 ASIFormDataRequest 子类。上传二进制数据或文件时，数据以“application/x-www-form-urlencoded”格式或“multipart/form-data”格式发布。文件中的数据是根据需要从磁盘读取的，所以发布大文件是可以的，只要你的 web 服务器设置为处理它们。

```
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
[request setPostValue:@"Ben" forKey:@"first_name"];
[request setPostValue:@"Copsey" forKey:@"last_name"];
[request setFile:@"/Users/ben/Desktop/ben.jpg" forKey:@"photo"]; 
```

> ASIFormDataRequest 将自动检测通过 setFile:forKey: 添加到 POST 的文件的 mime 类型（在 iOS 3.0 或更高版本的 Mac 上），并将其包含在发送到服务器的 mime 标头中。如果您愿意，可以使用较长的形式来覆盖它：

* * *

[多部分/表单数据](http://www.ietf.org/rfc/rfc2388.txt)很糟糕。相信我，几年前我已经用 C++ 实现了它。让别人做肮脏的工作。

但如果你还想一个人去。我找到[了这个](https://github.com/rentzsch/jrfeedbackprovider/blob/master/lib/NSURLRequest+postForm.m)和[这个](http://www.iphonedevsdk.com/forum/iphone-sdk-development/73857-nsurlconnection-nsmutableurlrequest-https.html)。祝你好运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T22:07:06.080

只需将图像的 NSData 版本附加到 POST 正文。

```
[body appendData:[[NSString stringWithFormat:@"cmd=%@&userid=%@&msgtext=%@", @"sendmessage&image=", userId, text] dataUsingEncoding:NSUTF8StringEncoding]];

[body appendData: UIImagePNGRepresentation((UIImage *) myImage)]; 
```

[但是，查看ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)可能更容易，您可以使用：

```
[request setPostValue:myImageData forKey:@"image"]; 
```

# android - 使用 Ant/Maven 构建 Android 项目

> ID：10807364
> 
> 赞同：1
> 
> 时间：2012-05-29T22:05:09.927
> 
> 标签：android

我们是否需要 Ant/Maven 来构建一个 android 项目？我想要有关使用 ANT/Maven 构建 android 项目的详细信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:29:47.677

您不需要 Maven 来构建 Android 应用程序。您*确实*需要 Ant 或 Eclipse。

[这是创建 Android 项目](http://developer.android.com/training/basics/firstapp/creating-project.html)的基本培训指南。

如果你想使用 Maven，你可以。有一个流行的 Maven 插件，[这里有说明](http://code.google.com/p/maven-android-plugin/wiki/GettingStarted)。

# asp.net - z 索引属性未应用

> ID：10807367
> 
> 赞同：4
> 
> 时间：2012-05-29T22:05:36.297
> 
> 标签：asp.net, html, css

我正在使用以下 html 标记和 css 代码来设计我的登录页面。

HTML

```
<!DOCTYPE html>

<html>
<head runat="server">
    <title></title>
    <link href="Styles/Site.css" rel="stylesheet" type="text/css" />
</head>
<body style="background:transparent;">
<div id="divContainer"></div>
    <form id="form1" runat="server">
    <div id="topDiv"></div>

    <div id="divMain">
    <aside><div id="logo">
    <img id="imgLogo" src="Images/minerva.jpg" />
    </div></aside> 
    <aside>
        <div id="divContact"></div>
    </aside>
    </div>
    <footer>
    </footer>
    </form>
</body>
</html> 
```

CSS

```
#topDiv {
    box-shadow: 0px 10px 20px #888888;
    background-color: #113871;
    width: 100%;
    height: 40px;
}
#logo { }
#imgLogo {
    width: 400px;
    height: 200px;
    margin-top: 20px;
    float: left;
}
#divContact {
    width: 300px;
    height: 400px;
    background-color: White;
    opacity: 0.5em;
    float: right;
    z-index: 9999;
    margin-right: 50px;
    margin-top: 149px;
    border-radius: 5px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    box-shadow: 0 0 .5em .25em Gray;
}
footer {
    width: 100%;
    height: 150px;
    background-color: #113871;
    display: block;
    float: left;
    margin-top: -100px;
    z-index: -1;
} 
```

我`#divContact`为页脚标签提供了 9999 和 -1 的 z 索引值。我的问题是我没有得到想要的东西，那就是把 divContact 放在前面。任何人都可以看看。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-29T22:07:37.187

`z-index`仅适用于*定位*元素：

```
/* This does not work */
.foo {
    z-index: 10;
}

/* This works */
.bar {
    position: relative;
    z-index:  10;
} 
```

来源：[http ://www.w3.org/TR/CSS2/visuren.html#z-index](http://www.w3.org/TR/CSS2/visuren.html#z-index)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-29T22:07:26.717

z-index 仅适用于位置属性已明确设置为绝对、固定或相对的元素。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-29T22:10:55.767

我怎么知道，z-index 仅适用于具有位置 css 属性的元素。所以我尝试在浏览器检查器中设置`position:relative;`为 divContact ，现在它位于第一平面。

# ajax - 如何在 ajax 调用中使用 wordpress 函数

> ID：10807368
> 
> 赞同：11
> 
> 时间：2012-05-29T22:05:36.950
> 
> 标签：ajax, wordpress, function, jquery

我想知道是否有办法在 ajax 调用中使用 query_post() 之类的函数？

假设我正在调用文件 _inc/ajax.php

我想能够使用 wordpress 功能，但我不知道为什么。有人可以帮我吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-29T22:12:47.390

WordPress 提供了一个 Ajax Url，您应该将其与完整的[Ajax API](http://codex.wordpress.org/AJAX_in_Plugins)一起使用。

您需要创建一个 jQuery 函数。

例子：

```
jQuery(document).ready(function($) {

    var data = {
        action: 'my_action',
        whatever: 1234
    };

    jQuery.post(ajaxurl, data, function(response) {
        alert('Got this from the server: ' + response);
    });
}); 
```

ajaxurl var 在管理端始终可用。如果您在前端使用它，则需要定义它。

然后是一个 PHP 函数，您可以在其中运行查询。PHP 函数必须附加到`wp_ajax_your_action`操作。

例子：

```
add_action('wp_ajax_my_action', 'my_action_callback');

function my_action_callback() {
    global $wpdb; // this is how you get access to the database

    $whatever = intval( $_POST['whatever'] );

    $whatever += 10;

        echo $whatever;

    die(); // this is required to return a proper result
} 
```

`wp_ajax_your_action`如果您需要在前端使用该操作，则该操作适用于管理员，该操作将是`wp_ajax_nopriv_your_action`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:12:11.347

我强烈推荐 JSON API 插件：[http](http://wordpress.org/extend/plugins/json-api/) ://wordpress.org/extend/plugins/json-api/ 。它为最常见的 WordPress 功能提供了一个 RESTful 界面，包括`query_post`并允许您添加自己的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-09T11:36:43.073

你必须在你的主题functions.php中创建你的函数这是使用ajax加载流行帖子的示例

```
function getPopularPosts()
{
    $popularpostdata = wpp_get_mostpopular_data();
    foreach($popularpostdata as $populardata)
        {
            $cur_id = $populardata->id;
            $cur_date = $populardata->post_date;
            $cur_date = date("F j, Y", strtotime($cur_date));
    ?>
    <article id="<?php echo $populardata->post_slug.'_mp';?>" data-attr-post-title="<?php echo $populardata->title; ?>" <?php post_class(); ?>>
      <p class="advt_disclosure"><?php echo advtdescloser(); ?></p>
      <?php 
        echo '<h6>'.getCategoryLink().'</h6>';
        $post_mp = get_post($cur_id);
      ?>
      <h1><?php echo $populardata->title;?></h1>
      <div class="entry-content">
        <div class="post-details"> <?php echo getAuthorData($post_mp->post_author,$cur_id,$populardata->title,$cur_date); ?> </div>
        <div class="collapsediv">
          <div class="row">
            <div class="col-sm-9 post_article">
              <?php
                    $content = $populardata->postcontent; //$content_post->post_content;
                    $content = apply_filters('the_content', $content);
                    $content = str_replace(']]>', ']]&gt;', $content);
                    echo $content;
                    wp_link_pages( array(
                        'before'      => '<div class="page-links"><span class="page-links-title">' . __( 'Pages:', 'twentyfifteen' ) . '</span>',
                        'after'       => '</div>',
                        'link_before' => '<span>',
                        'link_after'  => '</span>',
                        'pagelink'    => '<span class="screen-reader-text">' . __( 'Page', 'twentyfifteen' ) . ' </span>%',
                        'separator'   => '<span class="screen-reader-text">, </span>',
                    ) ); 
                ?>
              <p class="tags"> TAGS: <?php echo get_the_tag_list( '', __( ', ', 'twentyfifteen' ) )?></p>
            </div>
            <div class="col-sm-3 hot_deal"> <?php echo getAdvertisements(); ?> </div>
            <div class="col-sm-12 comment_section"> <?php echo getPostCommentsandSocialmediasharing($post_mp->post_author,$cur_id,$populardata->title); ?> </div>
          </div>
        </div>
      </div>
      <footer class="entry-footer">
        <?php //twentyfifteen_entry_meta(); ?>
        <?php //edit_post_link( __( 'Edit', 'twentyfifteen' ), '<span class="edit-link">', '</span>' ); ?>
      </footer>
      <div class="expander">
        <button class="expand" data-text-swap="Close article">expand article</button>
      </div>
    </article>
    <?php }
    exit();
}
add_action('wp_ajax_getPopularPosts', 'getPopularPosts');
add_action('wp_ajax_nopriv_getPopularPosts', 'getPopularPosts');`

And for call ajax you need to put some where in your themes footer.php

`$(".popular_posts").click(function(e) {
                    e.preventDefault();
                    if($('.popularposts').html().length==0)
                    {
                        $('.popularposts').html('<p class="text-center" style="margin-top:40px;"><img src="<?php echo get_home_url(); ?>/wp-content/themes/twentyfifteen/images/ajax-loader.gif"></p>');
                        $.ajax({
                            type: 'POST',
                            url: "<?php echo get_home_url(); ?>/wp-admin/admin-ajax.php",
                            data: {
                                action: 'getPopularPosts'
                            },
                            success: function( data ) {
                                $('.popularposts').html(data);
                            }
                        });
                    }
                }); 
```

# c++ - 库的子进程的进程组

> ID：10807370
> 
> 赞同：4
> 
> 时间：2012-05-29T22:05:46.067
> 
> 标签：c++, c, signals, signal-handling, process-group

我正在开发一个将集成到客户端代码中的库（C++）。该库将产生一些子进程，并且必须监视它们以在它们死后立即重新生成它们（出于任何原因）。我需要使用 vfork 和 exec 来生成这些子进程。

我知道我必须使用信号处理程序来处理 SIGCHLD 并调用 waitpid 来检测哪个孩子已经死了。但是，用户代码可能使用相同的想法来处理自己的子进程。

如果我调用 waitpid，我将检索有关任何可能死亡的子进程的信息（我的或不是我的）。如果死亡过程是我的，没问题……幸福的情况。但是，如果是来自用户，他不会得到任何相关信息，因为我已经调用了 waitpid。

我该如何解决这个问题？

我的第一个想法是使用进程组。第一次分叉时，我会获取子 pid 并将其保存为进程组 ID。我创建的每个孩子，我都会将它的组设置为这个pid。大家觉得这样的选择好不好？（我遇到了麻烦）。

我的第二个想法是将信号处理程序重置为原始处理程序（或直接调用它）。如果我重新发出信号，原始处理程序将能够得到它。之后我必须重新安装我的信号处理程序。会是一个不错的选择吗？

我的第三个选择是使用 INFO（扩展信号处理程序）。我相信消亡过程的pid将在信息结构中可用。如果这是我的一个孩子，我会为此打电话给waitpid，没关系。如果那不是我的，我会调用原始信号处理程序。会是一个不错的选择吗？

最后一个问题。为了能够调用原始信号处理程序，我应该始终恢复它们并重新发出信号还是仅将其作为函数调用来调用就足够了？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:13:47.633

另一种选择可能是首先生成一个子进程，它通过您喜欢的任何 IPC 机制与您的主进程通信。然后，从该新进程中生成多个子进程，这使您可以完全控制子进程终止的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T06:28:50.800

如果它是一个通用库（对于任何第 3 方），您应该尽量避免这种构造。如果无法避免使用它，请非常仔细地记录信号处理。

如果与 lib 链接的程序使用信号，可能会发生许多复杂的情况，并且 lib 没有机会正确处理它们，而不会以意想不到的方式影响程序。考虑程序可能有多个线程或处理您不处理的其他信号：在任何一种情况下，它都可能`SIGCHILD`同时更改信号处理并破坏您的逻辑。

也许在 lib 中提供一个函数可能会更好，当信号（对于您创建的 PID）到来时，您让它由程序负责调用它，`SIGCHILD`这样程序仍然可以自由地按照它的意愿处理其信号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T02:35:57.480

这篇文章只是为了澄清我的解决方案。

我决定不再在主进程中使用信号处理程序。除非必要，否则库不应处理信号。

在主进程中，我创建了一个管道，调用了一个单独的二进制文件，它将自己变成了一个守护进程。这样，由此产生的进程将不是主进程的子进程。

为了把它变成一个守护进程，我只是分叉它。fork 的父进程只打印子进程的 PID，以便主进程可以将其取回（通过管道）。子进程将 umask 设置为零，创建一个新的 SID，将当前目录更改为“/”并重新打开 STDIN、STDOUT 和 STDERR（全部为 /dev/null）。这样，孩子现在是一个恶魔。

这个守护进程负责生成我所有的进程。所有这些（包括守护进程）都使用套接字与主进程通信。

主进程向守护进程发送信号（SIGINT 关闭它及其所有子进程，SIGUSER1 和 2 到预定义的操作）。

感谢所有在这里提供帮助的人。

# mysql - 如何为学习管理系统 (LMS) 设计“分层数据”

> ID：10807371
> 
> 赞同：0
> 
> 时间：2012-05-29T22:05:51.767
> 
> 标签：mysql, django, design-patterns, database-design

我应该从头开始设计一个学习管理系统 (LMS)。关于“课程”实体，我有 3 个级别的信息（课程、主题、子主题）。想象它像一棵树。现在，这些方法中的哪一种（或更好的方法？）更有用？

1-使用“邻接列表模型”（http://www.sqlsummit.com/AdjacencyList.htm）或

2-使用 3 个表，每个表用于这些级别之一，并加入它们以获取记录？

请记住，这些级别中的每一个都有“单独的属性”，并且也与“测验”有联系。因此，这些字段中的每一个与“测验实体”之间也存在一些交互......

PS System 将在 Django 和 MySQL 中实现..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:41:18.740

由于树具有明显分离的级别，每个级别都包含不同*类型*的数据，我会采用“3 个表”的方法。

无论哪种方式，您都需要 JOIN，但这样您可以轻松地强制执行正确的引用完整性（例如，课程可以包含主题，但不能包含相反的方式）。这也自然地避免了循环。

我不确定“测验实体”是如何影响这一切的。愿意提供更多信息吗？

# php - PHP 多个 foreach 循环合二为一？

> ID：10807381
> 
> 赞同：0
> 
> 时间：2012-05-29T22:07:03.380
> 
> 标签：php, loops, foreach

编辑：

该死的对不起，它是正确的，我不得不尝试，但它对我来说听起来不太好，无论如何谢谢xD

我正在尝试创建一个循环并同时从中调用：

```
$xml = simplexml_load_file('xml.xml');
$cats = ('Cat2','Cat2');
foreach($cats as $cat){
 $call1 = $xml->$cat;
  // it supposed to get all cats contents .. now i want to call what is inside the cat
 foreach($call1 as $call2){
  $call = $call2->somethingelse;
 }
} 
```

这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:11:21.667

这只有在 $arr2 是 PHP 可以迭代的东西（例如数组）时才有效。

# php - 如何访问其中包含 URL 的节点？

> ID：10807394
> 
> 赞同：0
> 
> 时间：2012-05-29T22:07:40.253
> 
> 标签：php, xml-parsing, weather-api

我有一些我试图通过 php 循环解析的天气 xml。问题是我能够访问除

```
<aws:weather xmlns:aws="http://www.aws.com/aws> 
```

我无法深入了解此节点。是因为网址吗？我最终需要访问这个节点

```
<aws:station> Salinas Municipal Airport <aws:station> 
```

这是我拥有的 php：

```
<?php
$html = "";
$url = "http://i.wxbug.net/REST/SP/" .
       "getLiveWeatherRSS.aspx?api_key=sdfgdsgd5454&stationid=SLNAS";
$xml = simplexml_load_file($url);
for ($i = 0; $i < 10; $i++) {
$aws:station = $xml->channel->aws:weather->aws:ob[$i]->aws:station;
$html .= "<h3>$aws:station</h3>"; 
}
echo $html;
?> 
```

这是xml

```
<rss xmlns:georss="http://www.georss.org/georss" version="2.0">
<channel>
<title>Observations from Salinas, CA - USA</title>
<link>...</link>
 <description>...</description>
<language>en-us</language>
<lastBuildDate>Tue, 29 May 2012 17:00:00 GMT</lastBuildDate>
<ttl>60</ttl>
 <aws:weather xmlns:aws="http://www.aws.com/aws">
<aws:api version="2.0"/>
<aws:WebURL>...</aws:WebURL>
<aws:InputLocationURL>...</aws:InputLocationURL>
<aws:ob>
<aws:ob-date>...</aws:ob-date>
<aws:requested-station-id>SLNAS</aws:requested-station-id>
<aws:station-id>KSNS</aws:station-id>
<aws:station>Salinas Municipal Airport</aws:station>
<aws:city-state zipcode="93905">Salinas, CA</aws:city-state>
<aws:country>USA</aws:country>
<aws:latitude>36.6633338928223</aws:latitude>
<aws:longitude>-121.608055114746</aws:longitude>
<aws:site-url/>
<aws:aux-temp units="&deg;F">0</aws:aux-temp>
<aws:aux-temp-rate units="&deg;F">-52.9</aws:aux-temp-rate>
<aws:current-condition icon="http://deskwx.weatherbug.com/images/Forecast/icons   
/cond000.gif">Clear</aws:current-condition>
<aws:dew-point units="&deg;F">45</aws:dew-point>
<aws:elevation units="ft">66</aws:elevation>
<aws:feels-like units="&deg;F"/>
<aws:gust-time>...</aws:gust-time>
<aws:gust-direction>WNW</aws:gust-direction>
<aws:gust-direction-degrees>281</aws:gust-direction-degrees>
<aws:gust-speed units="mph">N/A</aws:gust-speed>
<aws:humidity units="%">60</aws:humidity>
<aws:humidity-high units="%">6</aws:humidity-high>
<aws:humidity-low units="%">6</aws:humidity-low>
<aws:humidity-rate>0</aws:humidity-rate>
<aws:indoor-temp units="&deg;F">0</aws:indoor-temp>
<aws:indoor-temp-rate units="&deg;F">0</aws:indoor-temp-rate>
<aws:light>0</aws:light>
<aws:light-rate>0</aws:light-rate>
<aws:moon-phase moon-phase-img="http://api.wxbug.net/images/moonphase   
/mphase09.gif">-61</aws:moon-phase>
<aws:pressure units=""">30.08</aws:pressure>
<aws:pressure-high units=""">30.08</aws:pressure-high>
<aws:pressure-low units=""">30.05</aws:pressure-low>
<aws:pressure-rate units=""/h">0</aws:pressure-rate>
<aws:rain-month units=""">0</aws:rain-month>
<aws:rain-rate units=""/h">0</aws:rain-rate>
<aws:rain-rate-max units=""/h">0</aws:rain-rate-max>
<aws:rain-today units=""">0</aws:rain-today>
<aws:rain-year units=""">0</aws:rain-year>
<aws:temp units="&deg;F">59</aws:temp>
<aws:temp-high units="&deg;F">59</aws:temp-high>
<aws:temp-low units="&deg;F">51</aws:temp-low>
<aws:temp-rate units="&deg;F/h">0</aws:temp-rate>
<aws:sunrise>
<aws:year number="2012"/>
<aws:month number="5" text="May" abbrv="May"/>
<aws:day number="29" text="Tuesday" abbrv="Tue"/>
<aws:hour number="5" hour-24="05"/>
<aws:minute number="50"/>
<aws:second number="01"/>
<aws:am-pm abbrv="AM"/>
<aws:time-zone offset="-7" text="Pacific Daylight Time (USA)" abbrv="PDT"/>
</aws:sunrise>
<aws:sunset>
<aws:year number="2012"/>
<aws:month number="5" text="May" abbrv="May"/>
<aws:day number="29" text="Tuesday" abbrv="Tue"/>
<aws:hour number="8" hour-24="20"/>
<aws:minute number="18"/>
<aws:second number="10"/>
<aws:am-pm abbrv="PM"/>
<aws:time-zone offset="-7" text="Pacific Daylight Time (USA)" abbrv="PDT"/>
</aws:sunset>
<aws:wet-bulb units="&deg;F">51.602</aws:wet-bulb>
<aws:wind-speed units="mph">N/A</aws:wind-speed>
<aws:wind-speed-avg units="mph">N/A</aws:wind-speed-avg>
<aws:wind-direction>WNW</aws:wind-direction>
<aws:wind-direction-degrees>279</aws:wind-direction-degrees>
<aws:wind-direction-avg>WNW</aws:wind-direction-avg>
</aws:ob>
</aws:weather>
<image>...</image>
<item>...</item>
</channel>
</rss> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:19:20.787

该问题是由 XML 文档中的 aws 命名空间引起的。

```
<aws:weather xmlns:aws="http://www.aws.com/aws"> 
```

您可以使用该[`childeren`](http://www.php.net/manual/en/simplexmlelement.children.php)方法获取属于命名空间的所有节点，而不是访问这些节点。

[您可以在http://www.sitepoint.com/simplexml-and-namespaces/](http://www.sitepoint.com/simplexml-and-namespaces/)找到更详细的问题描述

# knockout.js - knockout.js 并禁用自定义绑定

> ID：10807396
> 
> 赞同：0
> 
> 时间：2012-05-29T22:07:42.563
> 
> 标签：knockout.js, ko-custom-binding

我想在自定义绑定中绑定 disabled 和 css，而不是使用 JQuery 来分配一个类并禁用它。您可以在自定义绑定中执行此操作而无需执行`$(element).attr('disabled', true).addClass('disabled');`

```
data_bind="enabled: classroomId(), css: { 'disabled' : !classroomId() }"

data_bind="disable: { !classroomId() }

ko.bindingHandlers.disable = {
        update: function (element, valueAccessor) {
            var disabled = ko.utils.unwrapObservable(valueAccessor());

                 // Disable and Add Class to Button or Anchor Tag

        }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T05:01:20.370

Knockout 现在包含一个`disable`映射启用的绑定，您可以使用 jQuery 或调用现有的 css 和禁用的绑定（[小提琴](http://jsfiddle.net/jgoemat/Yvvm4/1/)）：

```
ko.bindingHandlers.myDisabled = {
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.bindingHandlers.css.update(element, function() {return { disabled: value }; });
        ko.bindingHandlers.disable.update(element, valueAccessor);
    }
}; 
```

html:

```
<input type="text" data-bind="value: name, myDisabled: !enabled()"/> 
```

# java - 将 META-INF/context.xml 重新加载到 ../conf/Catalina/localhost/myapp.xml 不起作用

> ID：10807397
> 
> 赞同：0
> 
> 时间：2012-05-29T22:07:52.013
> 
> 标签：java, tomcat6, catalina, context.xml, contextpath

我正在尝试进行热部署。数据库连接信息存储在我的 META-INF/context.xml 中。

当我将文件夹放到我的 $TOMCAT_HOME/webapps/ 时，它会尝试重新加载然后失败，因为它找不到数据库连接信息。当我在 ../conf/Catalina/localhost/myapp.xml 中查看时，它不在那里。

有人可以给我一些线索，这样我就可以找到可能出了什么问题？

（我认为它不是权限错误，因为 localhost 在 777 - 用于测试）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:18:18.240

我可以让它工作，错误来自两个不同的问题

**首先**： ../conf/Catalina/localhost 应该由 tomcat 用户拥有，而不是 root 或任何东西。默认情况下，根据分布情况可能并非如此。

**第二**：我在 webapps 目录中进行了 git pull，但它没有工作。我现在正在做的是在 /tmp 上进行拉动，然后将目录移动到 webapps。它工作正常，但我不知道为什么 git pull make 操作失败，当直接到这个目录的 scp 工作时。

我希望它可以帮助你们中的一些人

# php - PHP 通过远程调用获取页面内容

> ID：10807398
> 
> 赞同：3
> 
> 时间：2012-05-29T22:07:53.147
> 
> 标签：php, http, url, fsockopen

好的，所以我正在寻找的有点类似于下面的代码，它非常愚蠢并且由于某种我现在完全不关心的原因而无法工作（请阅读代码下的问题！！）：

```
$url = urldecode($_GET["link"]);
$port = (preg_match("/^https\:\/\//", $url) > 0 ? 443 : 80);

$headers  = "GET / HTTP/1.1\r\n";
$headers .= "Host: $url";
$headers .= "Accept-Charset: ISO-8859-2,utf-8;q=0.7,*;q=0.3\r\n";
$headers .= "Accept-Encoding: gzip,deflate,sdch\r\n";
$headers .= "Accept-Language: hu-HU,hu;q=0.8,en-US;q=0.6,en;q=0.4\r\n";
$headers .= "Cache-Control: no-cache\r\n";
$headers .= "Connection: keep-alive\r\n";
$headers .= "User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.52 Safari/536.5\r\n\r\n";
//yea, I'm using Google Chrome's userAgent

$socket = @fsockopen($url, $port) or die("Could not connect to $url");

if ($socket) {

    fwrite($socket, $headers);

    while (!feof($socket)) {
        echo fgets($socket, 128);
    }

    fclose($socket);
} 
```

如您所见，我想要实现的是以某种方式从 GET 全局中的 url 获取 html 或任何其他输出。同样，代码不起作用，我不在乎，我不需要代码更正，我需要信息/指导。

现在。我不是 PHP 大师，所以问题有点复杂：

*   我有什么选择来实现上述需求？
*   在执行该特定方法之前/之后我需要注意什么？
*   任何依赖项（库）？
*   优点/kontras/以前的经验？

如果你只用一堆链接回答，我也非常感谢，我并不是在寻找一个机器人回答，比如“这是你应该做的最神圣和唯一的方法！”，我更多的是收集信息和选项，知识。=)

我不知道这是否重要（例如 MongoDB 的驱动程序）：我目前在 Windows 7 x64 上使用 WAMP 服务器，后来我计划将它移动到我的 CentOS 6.2 网络服务器下，所以也请考虑这些（可能有依赖于 Linux）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:40:00.300

如果您想更改用户代理并获取页面内容，您有几个选项：

首先也是最好的 IMO 是[curl](http://php.net/manual/en/book.curl.php)，99.9% 的主机都启用了这个功能，如果它是你自己的 vps ，那么它很容易设置[http://bit.ly/KUn3AS](http://bit.ly/KUn3AS)：

```
<?php 
function curl_get($url){
    if (!function_exists('curl_init')){
        die('Sorry cURL is not installed!');
    }
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_USERAGENT, "MozillaXYZ/1.0");
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_TIMEOUT, 10);
    $output = curl_exec($ch);
    curl_close($ch);
    return $output;
}
?> 
```

其次是使用带有自定义流上下文的[file_get_contents ：](http://uk.php.net/manual/en/function.file-get-contents.php)

```
<?php
function fgc_get($url) {
    $opts = array(
      'http'=>array(
        'method'=>"GET",
        'header'=>"Accept-language: en\r\n" .
                  "Cookie: foo=bar\r\n" .
                  "User-Agent: MozillaXYZ/1.0\r\n"
      )
    );
    $context = stream_context_create($opts);
    $urlContents = file_get_contents($url, false, $context);
    return file_get_contents($url, false, $context);
}
?> 
```

如果您接受来自用户输入的任意 URL，则选择哪种方法 $_GET 然后在某些情况下您可能会被滥用，如果您希望为您的站点 AJAX 请求创建代理，那么您可以添加一些安全性，例如只允许特定域，或在执行任何外部报废之前检查其是否为 xmlhttprequest/AJAX 请求等，但您可以将其保留为您的选择：

```
<?php 
if(!empty($_GET['url']) && !empty($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest') {

    $allowed = array('somesite.com','someothersite.com');

    $url = parse_url($_GET['url']);

    if(in_array($url['host'],$allowed)){
        echo curl_get($_GET['url']);
    }
    die;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T12:40:33.703

**从 URL 获取内容的简单方法**

1) 第一种方法

在您的主机（php.ini 或其他地方）启用 Allow_url_include

```
<?php
$variablee = readfile("http://example.com/");
echo $variablee;
?> 
```

或者

2）第二种方法

启用 php_curl、php_imap、php_openssl

```
<?php
// you can add anoother curl options too
// see here - http://php.net/manual/en/function.curl-setopt.php
function get_data($url) {
  $ch = curl_init();
  $timeout = 5;
  curl_setopt($ch, CURLOPT_URL, $url);
  curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)");
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_SSL_VERIFYHOST,false);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,false);
  curl_setopt($ch, CURLOPT_MAXREDIRS, 10);
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
  curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
  $data = curl_exec($ch);
  curl_close($ch);
  return $data;
}

$variablee = get_data('http://example.com');
echo $variablee;
?> 
```

# php - php-mysql : 使下拉列表工作

> ID：10807401
> 
> 赞同：1
> 
> 时间：2012-05-29T22:07:58.327
> 
> 标签：php, mysql, phpmyadmin

我想用下拉菜单显示我的数据库中的一些数据。数据（图片、链接、标题、数字）将分别显示在一个小 div 中。

我消除了重复的数据，并制作了下拉列表。下拉列表也有我想要的值。但是我的代码似乎不起作用。我怀疑问题是我无法将我的数据的“回声”与我的休息代码连接起来，所以我可以让我的代码工作。

这是我的代码：

```
$query="SELECT DISTINCT * FROM products GROUP BY category";
$result = mysql_query($query);

echo "<select name=\"category\">";

while ($row = mysql_fetch_array($result)) {
  echo "<option value='" . $row['category'] . "'>" . $row['category'] ."</option>";
}
echo "</select>" . "</br>"; 
```

这是我的其余代码：

```
mysql_select_db("myapp",$con);
$result = mysql_query("SELECT * FROM products WHERE category = " . $row['category'], $con);

while($row = mysql_fetch_array($result))
{
  $mycategory = $row['category'];
  $myimage = '<img src="'.$row['image'].'" />';
  echo  "<div id='appear'>" . $myimage . '<br />' . $row['title'] . "<br  />"  
    . "<p style='color:red;' >" . "price: " . $row['price'] . "€" . "</p>"
    . '<a   href="image.php?id='.$row['id'].'">'
    . "details" . "<a>" . "</div>" ;  
}

mysql_close($con); 
```

假设数据库已连接。我也只能使用 php 和 mysql。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:47:59.227

我假设您想让用户在第一页上选择类别，然后向他展示适合他选择的所有数据。如果您想在同一页面中实时显示数据，当用户选择一个新类别时，一切都会变得更加复杂。

但让我们坚持简单的版本。到目前为止，您的代码未提供的是调用下一个 php 传输类别 ID 的导航。您需要在 html-form 元素中构建第一个 php 代码，其中包含第二个 php 文件作为操作目标。例如：

```
<form action='part2.php' method='POST'>
<?php
  /* ... your first code snippet */
?>
<input type='submit' value='Display category' />
</form> 
```

当用户单击“显示类别”按钮时，将调用您的第二个脚本，您可以通过全局变量 $_POST['category'] 访问选择的类别字符串。

但小心点！在真实场景中，不要简单地将通过 $_POST 或 $_GET 接收到的数据发送到您的数据库，它可能会被潜在的攻击者简单地操纵。Google Cross-Site-Scripting，如果您对该主题感兴趣，但由于这是一个学校项目，我怀疑它对您有什么重要意义，以后不要在网上托管它！

但是回到你的问题。只需替换后，您的第二个代码应该可以工作

```
$result = mysql_query("SELECT * FROM products WHERE category=".$row['category']."",$con); 
```

和

```
$result = mysql_query("SELECT * FROM products WHERE category=".$_POST['category']."",$con); 
```

在您第二次发布的代码中，您的回显语句中有一个小错误，由于stackoverflow代码突出显示，易于跟踪：您在开始标签前面缺少一个简单的引号（'），而您的结束-tag 缺少反斜杠（应该是 ，您肯定知道）。如果您的原始代码中有错误，而不仅仅是复制粘贴错误，那么 php 无论如何都应该提及这一点！

希望对您有所帮助，祝您项目顺利！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:14:53.927

<

```
?php
 $query="SELECT DISTINCT * FROM products GROUP BY category";
 $result = mysql_query($query);

echo "<select name=\"category\" onchange=\"form.submit()\">";

while ($row = mysql_fetch_array($result)) {
    echo "<option value='" . $row['category'] . "'>" . $row['category'] 
 ."</option>";
}
echo "</select>" . "</br>";
?> 
```

当下拉列表的值发生更改时，它将帮助您更改内容。

对于 div 使用下面的代码。

```
<?php
if(isset($_POST['category']) && !empty($_POST['category']))
{
//rest of your div codes lie here
}
?> 
```

# jquery - Ajax 在 drupal 7.x 的自定义主题中不起作用

> ID：10807402
> 
> 赞同：0
> 
> 时间：2012-05-29T22:08:00.423
> 
> 标签：jquery, drupal-7

```
<?php
/** hook_menu **/
function example_contact_form_menu() {
    return array(
    'contact_form_test' => array(
      'page callback' => 'contact_form_test',
      'page arguments' => array(),
      'access arguments' => TRUE,
      'type' => MENU_CALLBACK,
    ),
    'contact_form_test_1' => array(
      'page callback' => 'drupal_get_form',
      'page arguments' => examplexample_contact_form_form'),
      'access arguments' => TRUE,
      'type' => MENU_CALLBACK,
    )
    );
}
function contact_form_test()
{
    drupal_add_css(drupal_get_path('module', 'example_contact_form') . '/example_contact_form.css');
    dpm(drupal_get_form('example_contact_form_form'));
    return render(drupal_get_form('example_contact_form_form'));
}
/**
 * Implementation of hook_form().
 */
function example_contact_form_form($form, &$form_state){
    $form=drupal_build_form('example_form_form',$form_state);
    $form['first_name']['#size']=25;
    $form['last_name']['#size']=25;
    unset($form['submit_form']);
     //adding new fields
     $form['box'] = array(
    '#type' => 'markup',
    '#prefix' => '<div id="box">',
    '#suffix' => '</div>',
    '#markup' => '<h1>Initial markup for box</h1>',
  );
      $form['comment'] = array(
    '#title'=> t('Comments'),
    '#type' => 'textarea',
     '#value'=>'Type Here',
    '#description' => t(''),
    '#default_value' => '',
    '#attributes'=>array(
             'onfocus'=> "if(this.value=='Type Here')this.value='';"
            )
    );
    $form['questions'] = array(
    '#type' => 'select', 
    '#title' => t('Whats in your mind'), 
    '#default_value' => array(), 
    '#options' => array(
      'What\'s in your mind' => 'What\'s in your mind', 
      'Question 1' => 'Question 1', 
    ), 
  );
     $form['sub_form'] = array(
    '#type' => 'button',
    '#ajax' => array(
      'callback' => 'example_contact_form_js',
      'wrapper' => 'box',
      'name' => 'submit1',
    ),
    '#value' => t('Submit'),
  );
     unset($form['#theme']);
     $form['#theme'] = array('example_form_form', 'contact_theme_form');
     $form['#validate'] = array('example_contact_form_form_validate');
     $form['#submit'] = array('example_contact_form_form_submit');
     return $form;
}

function example_contact_form_form_validate($form, &$form_state){
    dpm($form_state,t('Form State Validate'));
}

function example_contact_form_js($form, &$form_state){
      $element = $form['box'];
      $element['#markup'] = "Clicked submit ({$form_state['values']['op']}): " . date('c');
      return $element;
}
function advanced_form_callback($form, &$form_state) {
  $city_name = form_result_helper($form_state);
  $element = $form['status'];
  $element['#markup'] = t('You submitted @city', array('@city' => $city_name));
  print 'BHASKAR';
}

function example_contact_form_form_submit($form, &$form_state){
    dpm($form_state,t('Form State Submit'));
}

// Menu callback
function example_contact_form_theme(){
    return array
    (
        'contact_theme_form' => array
        (
                'render element' => 'form',
                'template' => 'contact-signup',
                'path' => drupal_get_path('module', 'example_contact_form').'/templates',
                'arguments' => array('form' => null),
        ),
    );
}

function template_preprocess_contact_theme_form(&$variables) {
  $form=$variables['form'];
  foreach (element_children($form) as $key) {
              unset($form[$key]['#title']);
              $variables[$key]=render(($form[$key]));
              unset($form[$key]);    
 }
$variables['contact']=drupal_render_children($form);
}
?> 
```

问题是当我试图渲染 template_preprocess_contact_theme_form 中的每个元素时，我删除了这个函数，一切似乎都在工作。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T23:09:30.010

解决这个问题。我的 template_preprocess_contact_theme_form 我正在删除 form_build_id，form_id 这是错误的，而不是隐藏，我正在删除这些值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T08:18:30.423

你的`<form>`标签出现了吗？
在您的表单主题中，您可能必须呈现表单子项，然后使用`theme_form()`.

```
$buildform = '&lt;div&gt;'.drupal_render($form['elem1']).'&lt;/div&gt;';
$buildform .= drupal_render($form['elem2']);
$buildform .= drupal_render($form['form_build_id']);
$buildform .= drupal_render($form['form_id']);
$form['element']['#children'] = $buildform;
$output = theme_form($form); 
```

# rest - 使用委托从 Web 服务通过 CreateProcessAsUser 创建的连续进程无法读取/写入网络共享

> ID：10807408
> 
> 赞同：3
> 
> 时间：2012-05-29T22:08:20.307
> 
> 标签：rest, iis-7, pinvoke, impersonation, createprocessasuser

在尝试访问网络共享时，什么可能导致使用委托从 Web 服务通过 CreateProcessAsUser 创建的连续进程遇到 System.UnauthorizedAccessException 异常？

WCF Rest Web 服务使用带有重复用户令牌的 CreateProcessAsUser 启动一个新进程。该过程开始并报告它由具有共享访问权限的模拟用户所有。

在 Web 服务器干净启动时，该进程可以在网络共享目录 (\\nasshare\test) 上一遍又一遍地调用 System.IO.Directory.Exists 并获得正确的响应。但是，当进程结束并再次调用 Web 服务以再次启动进程时，它将报告该目录不再存在，然后我的程序代码尝试创建据称丢失的目录并失败并出现异常消息：System. UnauthorizedAccessException：对路径“\\nasshare\test”的访问被拒绝。

奇怪的是，如果我重新启动网络服务器，它将再次工作......直到进程结束。Web 服务创建的连续进程将失败。当我从 Web 服务器上的命令提示符运行该进程时，该进程可以看到该文件夹​​并对其进行写入。我可以以这种方式一遍又一遍地运行该过程，即使在使用 Web 服务器中的 CreateProcessAsUser 启动失败后它也会立即正常工作。

*   网络服务器：Windows Server 2008 R2
*   网络共享：Windows Storage Server 2003
*   网络服务托管：IIS7
*   网络服务客户端：IE、Chrome
*   应用程序池标识：NetworkService
*   .Net 框架：v4.0

简化的 Rest Web 服务

```
[Description("Launch a process.")]
[WebGet(UriTemplate = "fragment/launch")]
public void LaunchProcess()
{
    ...
    using (ServiceSecurityContext.Current.WindowsIdentity.Impersonate())
    {
        launchProcessAs(WindowsIdentity.GetCurrent().Token, @"c:\temp\test.exe", "1234"); //In this test the arg "1234" is not used
    }
}//end rest func call

const UInt32 MAXIMUM_ALLOWED = 0x2000000;
const UInt32 GENERIC_ALL_ACCESS = 0x10000000;
const Int32 CREATE_NEW_PROCESS_GROUP = 0x00000200;
const Int32 CREATE_UNICODE_ENVIRONMENT = 0x00000400;
const Int32 IDLE_PRIORITY_CLASS = 0x40;
const Int32 NORMAL_PRIORITY_CLASS = 0x20;
const Int32 HIGH_PRIORITY_CLASS = 0x80;
const Int32 REALTIME_PRIORITY_CLASS = 0x100;
const Int32 CREATE_NEW_CONSOLE = 0x00000010;
const Int32 DETACHED_PROCESS = 0x00000008;

public bool launchProcessAs(IntPtr userToken, string pathToProcess, string processArgs)
{
    bool success = false;
    try
    {
        pathToProcess = System.IO.Path.GetFullPath(pathToProcess);

        IntPtr DupedToken = new IntPtr(0);
        bool duplicatedToken = false;

        SECURITY_ATTRIBUTES sa = new SECURITY_ATTRIBUTES();
        sa.bInheritHandle = false;
        sa.Length = Marshal.SizeOf(sa);
        sa.lpSecurityDescriptor = (IntPtr)0;

        const int SecurityImpersonation = (int)SECURITY_IMPERSONATION_LEVEL.SecurityImpersonation;
        const int TokenType = 1;

        duplicatedToken = DuplicateTokenEx(userToken, GENERIC_ALL_ACCESS, ref sa,                 SecurityImpersonation, TokenType, ref DupedToken);

        STARTUPINFO si = new STARTUPINFO();
        si.cb = Marshal.SizeOf(si);
        si.lpDesktop = "";

        PROCESS_INFORMATION pi = new PROCESS_INFORMATION();

        if (processArgs != null)
        {
            processArgs = " " + processArgs;
        }

        if (duplicatedToken)
        {
            success = CreateProcessAsUser(DupedToken, pathToProcess, processArgs, ref sa, ref sa, false, 0, IntPtr.Zero, null, ref si, out pi);
        }

        if (success)
        {
            CloseHandle(pi.hProcess);
            CloseHandle(pi.hThread);
            CloseHandle(DupedToken);
        }

    }
    catch (Exception e)
    {
        success = false;
    }

    return success;
} 
```

test.exe 程序代码的简化示例

```
static void Main(string[] args)
{
    for (int i = 0; i < 5; i++)
    {
        String tempDir = "\\\\nasshare\\test";
        String tempFile = tempDir + "\\newfile.txt";
        // Create temp dir
        if (!System.IO.Directory.Exists(tempDir)) //This reports erroneously after first run from a reboot from createProcessAsUser within web service but works everytime when run directly from cmd on web server by same user 
        {
            System.IO.Directory.CreateDirectory(tempDir); // This fails with    System.UnauthorizedAccessException after first run from a reboot when launched from createProcessAsUser but works everytime when run directly on web server by same user directly from cmd
        }
        File.WriteAllText(tempFile, "hello world");
    }
} 
```

# php - 如何在我的 PHP 类中使用 TWIG PATH 助手？

> ID：10807412
> 
> 赞同：1
> 
> 时间：2012-05-29T22:08:59.673
> 
> 标签：php, symfony, twig

我有一个像下面这样的类，我想在调用`Display`视图文件时输出一些文本和链接，现在它工作正常。

问题是如何调用 Twig PATH 帮助程序或任何 PHP 等效项以从我的 PHP 类中的任何路由名称获取路由；

```
myClass 
{
    // Other Code

    function Display($depth)
    {
        echo "<div class=\"heirarchy\">";

        for($i = 0; $i < $depth; $i++)
        {
            echo '&nbsp;';
        }

        echo "<a href=\"path('path_name')\" ".$this->description."</a>";

        if($this->isLeaf())
        {
            echo ' (Task)';
        }

        echo "</div>";

        foreach($this->children as $key => $value)
        {
            $value->Display($depth + 2);
        }

    }

} 
```

由于这个函数是递归的，我不知道如何在 twig 函数中实现它。

换句话说，如何从我的类中的路由名称中获取路由路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T23:34:40.713

路由器的`generate()`方法类似于 Twig 的方法`path()`，它从路由名称生成 URL。

只需`$this->get('router')`从您的控制器传递给您的类，然后像这样使用它：

`$router->generate('my_route')`.

另外，我看不出使用这个伪 OO 类（其中包含 HTML）的意义。
您可以为此目的使用模板。

# c# - Roslyn 和调试

> ID：10807413
> 
> 赞同：10
> 
> 时间：2012-05-29T22:09:05.817
> 
> 标签：c#, .net, visual-studio, debugging, roslyn

Roslyn CTP 已经推出一段时间了，我很喜欢玩它，但有一个明显的问题我还没有看到答案。Roslyn 会给调试带来什么好处（如果有的话）？

任何在 Visual Studio 中进行过认真调试的人都知道，在调试期间无法使用 lambda 表达式以及 LINQ 是多么令人沮丧。鉴于 Roslyn 是一种编译器即服务，是否可以让调试（监视窗口/立即窗口）支持这些功能？

感谢任何有见识的人。

编辑：

更具体地说，以下文章详细说明了为什么 lambdas 目前不能在即时/监视窗口中使用。

[调试器窗口中的 LINQ](http://blogs.msdn.com/b/jaredpar/archive/2009/08/26/why-no-linq-in-debugger-windows.aspx)

是否知道 Roslyn 是否专门解决了本文详述的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T22:13:28.663

> 鉴于 Roslyn 是一种编译器即服务，是否可以让调试（监视窗口/立即窗口）支持这些功能？

这必须由 Visual Studio 团队实现 - 并且（理论上）可以使用他们当前的代码库来完成。

我确实怀疑 Roslyn，鉴于它是干净的架构，将大大简化他们在实现这些其他功能方面的工作，这反过来*可能会*导致它们更有可能出现在 Visual Studio 的未来版本中（在 Roslyn 实际在 VS 中使用之后） .

# android - 移动设备移动时推送通知是否比套接字更好

> ID：10807414
> 
> 赞同：3
> 
> 时间：2012-05-29T22:09:09.180
> 
> 标签：android, ios, sockets, push-notification

我需要向我的客户端发送一些数据，并且我想知道使用推送通知是否比使用套接字更好。

我听说有人说套接字不好，因为如果手机更改它的 IP，它们可能会停止工作（无论如何这种情况多久发生一次）。

套接字有多可靠>您何时更愿意使用推送通知？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T22:24:56.880

推送通知适用于：

- 当您想将信息发送到用户没有首先请求的设备时（通常是一个 ping，表明服务器上有用户想要下载的新数据）

- 当无法保证应用程序正在运行时。

套接字用于：

- 当应用程序运行时 - 也就是，用户点击他们想要下载的东西，数据通过套接字发送。

此外，在 Android 上，推送通知的最大数据量为 4K，因为（如前所述）它们仅用于通知，而不是传输大量数据。为此，无论如何您都需要使用套接字。此外，您需要处理套接字*确实*因各种原因停止发送数据的事实 - 用户跳 wifi 网络、穿过隧道、开车穿过接收信号不稳定的区域等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:14:34.037

推送通知可以在应用程序在后台和前台使用时使用，但它们不像套接字那样可靠。

通常，一个好的解决方案是同时使用两者。您可以在应用程序打开时通过刷新套接字或轮询服务器来响应推送通知。不过，我会避免完全依赖推送通知。只需在您的应用关闭时使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T22:11:59.933

推送通知将在您的应用程序未运行时使用，并且 UILocalNotifications 是在应用程序未运行时向应用程序发送信息的唯一方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T22:49:25.597

> 我听说有人说套接字不好，因为如果手机更改它的 IP，它们可能会停止工作（**无论如何这种情况多久发生**一次）。

我可以给你一个公认的不常见的场景......

我当地的酒吧提供免费无线网络。所以我和朋友喝了一杯，我的手机自动连接到酒吧的无线网络。一旦我离开酒吧并且我不在范围内，如果我启用了移动互联网，我的手机将连接到我的提供商的数据网络。

在回家的路上，我在当地的街角商店停下来买些杂货。某个时候，我在商店上方的业主住所设置了 wi-fi，我的手机配置为记住他们的 wi-fi 连接详细信息，以便连接。我离开商店，超出范围，我的手机再次连接到我的提供商的数据网络。

我决定今晚要吃中国菜，然后停在我家附近的外卖店。我还为他们设置了 Wi-Fi 系统，我的手机会自动连接到他们的接入点。我离开商店，我的手机连接到我的提供商的数据网络。

我回到家，然后我的手机连接到我自己的 wi-fi 网络。

因此，在大约 400 码（约 300 米）的距离内，我的手机将改变连接状态 6 次。

抱歉有点冗长，但这是一个真实的场景 - 我的业务是为私人和小型企业用户提供 IT 支持。

换句话说，无论您的应用程序做什么，您都需要满足这样一个事实，即移动技术上的网络可能会多次更改，并且您需要监控状态的变化，并在必要时拆除并重新创建现有连接。

直接套接字连接可能更直接，需要对网络更改进行额外处理。假设推送服务器设置正确，推送通知具有异步的优势。

# android - PlayN 安卓后端的广告

> ID：10807416
> 
> 赞同：1
> 
> 时间：2012-05-29T22:09:26.150
> 
> 标签：android, playn

我一直在尝试在 android 中使用 admob，但是每当我为广告添加 adView 时，应用程序都会在启动时崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T07:31:26.500

好的，所以我终于用 PlayN 在我们的游戏的 android 版本上制作了广告，这个过程有点长，所以我写了[一篇](http://foobraco.nodejitsu.com/working-ads-in-android-backend-of-playn)关于它的博客文章，所以你可以查看它，如果你有任何问题，请告诉我。

# rft - Rational Functional Tester，如何动态识别 HTML 表中的链接？

> ID：10807417
> 
> 赞同：0
> 
> 时间：2012-05-29T22:09:29.433
> 
> 标签：rft

我的 HTML 看起来像这样：

```
<table summary="History of xxxxxx"><thead><tr><th>Date Started</th><th>Date Updated</th><th>Yyyyyyyy</th><th>Summary Report</th>  
<th>Full Report</th></tr></thead><tbody><tr class="odd"><td>05/29/2012</td><td>05/29/2012</td>  
<td><a href="/xxxxx/yyyyy/traversal/e3230f12-dea6-4fd9-b4ed-dd60deb65aa3">Complete  </a>  
<a href="/xxxxx/yyyyy/delete">Delete</a></td><td/><td/></tr><tr class="even"><td>05/29/2012</td>  
<td>05/29/2012</td><td/><td><a href="/xxxxx/summaryreport/view/280e30fe-f7dc-4099-b83e-28e02d64f68f">View</a>  
<a href="/xxxxx/summaryreport/save/280e30fe-f7dc-4099-b83e-28e02d64f68f">Save</a>  
<a href="/xxxxx/summaryreport/print/280e30fe-f7dc-4099-b83e-28e02d64f68f">Print</a></td><td>  
<a href="/xxxxx/fullreport/view/280e30fe-f7dc-4099-b83e-28e02d64f68f">View</a>  
<a href="/xxxxx/fullreport/save/280e30fe-f7dc-4099-b83e-28e02d64f68f">Save</a>  
<a href="/xxxxx/fullreport/print/280e30fe-f7dc-4099-b83e-28e02d64f68f">Print</a></td></tr></tbody></table> 
```

我可以使用以下脚本片段打印表格的内容：

```
ITestDataTable kontents = (ITestDataTable) table_dateStartedDateUpdatedAs().getTestData("contentswithchildren");

System.out.println (table_dateStartedDateUpdatedAs().getTestDataTypes());

System.out.println ("Total Rows in table : " + kontents.getRowCount());
System.out.println ("Total Cols in table : " + kontents.getColumnCount());

for (int row=0; row < kontents.getRowCount();++row)
{
for (int col=0; col < kontents.getColumnCount();++col)
{
    System.out.println("contents("+row+","+col+")=\""+kontents.getCell(row,col)+"\"");
}
} 
```

但是我怎样才能将超链接放入它们自己的变量中呢？三个超链接 View Save Print 都在一个单元格中。

- 谢谢，

——小迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T14:56:51.903

使用该`find()`功能。

查看在线 RFT 帮助中的[搜索测试对象](http://publib.boulder.ibm.com/infocenter/rfthelp/v8r2/index.jsp?topic=/com.ibm.rational.test.ft.doc/topics/SearchingforTestObjects.html "搜索测试对象")文章。

您的表的示例代码如下所示：

```
TestObject[] foundSaveLinks = table_dateStartedDateUpdatedAs().find(atDescendant(".tag", "A", ".text", "Save"));
GuiTestObject saveLink = (GuiTestObject)foundSaveLinks[0];
saveLink.Click(); 
```

您可以使这更复杂，例如，如果您需要将搜索/查找限制为特定的表格单元格。我上面的示例将找到作为表的后代的所有“保存”链接。

# java - 如何获得 JTable 列的标题组件的最小首选宽度，使其不能调整为小于该值？

> ID：10807418
> 
> 赞同：4
> 
> 时间：2012-05-29T22:09:32.680
> 
> 标签：java, swing, header, jtable, tablecolumn

我试图防止我的 JTable 以标题小于它们所包含的文本大小的方式重新调整大小。我遇到的问题是，我为每个标题组件获得的最小首选宽度仅为 10，当每个标题组件中的值为“标题 1”、“标题 2”、“标题 3”等时，这显然太小了上。

我花了很多时间搜索 SO 并尝试实施各种建议，但到目前为止还没有找到解决方案。请查看我在扩展 JTable 中使用的当前代码：

```
public class MyTable extends JTable {

private Map<Integer, Integer> minSizeMap;

public void calculateMinColumnSizes() {

    int width = 0;
    int row = 0;
    minSizeMap = new HashMap<Integer, Integer>();

    for (int column = 0; column < columnModel.getColumnCount(); column++) {
        TableColumn tableColumn = columnModel.getColumn(column);
        TableCellRenderer renderer = tableColumn.getCellRenderer();
        Component comp = this.prepareRenderer(renderer, row, column);
        width = Math.max(comp.getPreferredSize().width, width);
        minSizeMap.put(tableColumn.getModelIndex(), width);
    }
   }
} 
```

原始代码来自 kleopatra 对[How to resize JTable column to string length 的回答？](https://stackoverflow.com/questions/5820238/how-to-resize-jtable-column-to-string-length/5820410#5820410)，但是我已经更改了部分，因为目前我只想获取每个列标题的最小首选宽度，并将其存储起来以供调整大小后进行比较。

在我调用该方法之前，所有模型都已设置好，所以当 TableColumn 的 minWidth 和 preferredWidth 默认值分别为 15 和 75 时，我对组件首选宽度如何获得 10 感到有些困惑。

关于我做错了什么/理解错误的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T22:30:50.653

我在您的代码中看到了几个问题：

1.  您不使用表格标题渲染器，而是使用 TableColumn 单元格渲染器（它们可能不同）
2.  您测试第一行的首选大小，而不是标题
3.  你使用`width = Math.max(comp.getPreferredSize().width, width);`which 根本没有任何意义

这是一个可以帮助您前进的片段：

* * *

```
for (int column = 0; column < columnModel.getColumnCount(); column++) {
    TableColumn tableColumn = columnModel.getColumn(column);
    TableCellRenderer renderer = tableColumn.getHeaderRenderer();
    if (renderer == null) {
        renderer = getTableHeader().getDefaultRenderer();
    }
    Component component = renderer.getTableCellRendererComponent(this, 
             tableColumn.getHeaderValue(), false, false, -1, column);
    minSizeMap.put(tableColumn.getModelIndex(), component.getPreferredSize().width);
} 
```

# dom - 无法操作从 $.ajax 返回的数据

> ID：10807425
> 
> 赞同：1
> 
> 时间：2012-05-29T22:10:14.203
> 
> 标签：dom, jquery

`.connectNow`我需要从使用以下 ajax 调用返回的数据中删除具有该类的元素：

```
$.ajax({
    type: 'get',
    url: pages[i] +'.php',
    data: 'ajax=1',
    success: function(txt) {

        // the following line is not operating as expected
        $(txt).find('.connectNow').remove();
        $('.slide').eq(0).after('<div class="slide">' + txt + '</div>');
        $('.slide').animate({'left':'-=425px'},1500);
    }   
}); 
```

我已经查看（并尝试过）以下内容，除非我执行错误，否则这些内容似乎对我的情况没有帮助。

*   [无法处理从 jQuery 中的 ajax 请求插入的数据](https://stackoverflow.com/q/3486385/362769)
*   [用 jquery 解析部分 html 字符串](https://stackoverflow.com/q/3642203/362769)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:04:42.857

工作版本（使用假输入 xml）：

[http://jsfiddle.net/jMQX5/1](http://jsfiddle.net/jMQX5/1)

一些看似奇怪的选择通过内联注释进行了解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:04:47.160

您应该将返回的 ajax 的数据类型设置为 html（它可能默认为文本，尽管 jQuery 应该猜测它是什么）。

如果这不起作用，虽然这里有一个小技巧可以帮助你

```
txt = $('<div/>').append(txt).find('.connectNow').remove().end().html(); 
```

# python - 如何使用python从bson日期/时间对象或时间戳获取isodate字符串？

> ID：10807426
> 
> 赞同：2
> 
> 时间：2012-05-29T22:10:17.763
> 
> 标签：python, mongodb, pymongo

使用 bson json_util 将 bson 日期/时间对象转换为 json 时，日期时间表示为自纪元以来的毫秒数。

有没有办法将日期/时间转换为 isodate 字符串？还是在使用 json_util 转储 json 之前将日期时间实例转换为字符串的更好方法？

```
raw cursor item: {u'_id': ObjectId('4fc51500381b472cfdfa4eaf'), u'ts': datetime.datetime(2012, 5, 29, 18, 27, 12, 221000)} 
```

json.dumps(obj, default=json_util.default)

```
json: {"_id": {"$oid": "4fc51500381b472cfdfa4eaf"},"ts": {"$date": 1338316032221}} 
```

当使用 python datetime 模块 datetime.fromtimestamp(ts) 我得到 ValueError，我做错了什么吗？：

```
import datetime
datetime.datetime.fromtimestamp(1338316032221)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: year is out of range 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:24:25.010

您为该`fromtimestamp`方法提供自纪元以来的时间（以毫秒为单位），但它期望自纪元以来的时间以*秒*为单位（请参阅[datetime.datetime.fromtimestamp](http://docs.python.org/library/datetime.html#datetime.date.fromtimestamp)和[time.time](http://docs.python.org/library/time.html#time.time)文档）:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-13T18:26:50.460

我自己在使用 Python 和 MongoDB 存储时遇到了这个问题。最简单的答案是：

```
import time
bson_timevalue = 1421147432935
readable_date = time.strftime("%Y-%m-%d", time.localtime(int(bson_timevalue / 1000)))

print readable_date 
```

给你：`2015-01-13`

# multithreading - OCaml 中的线程延迟和键盘事件

> ID：10807428
> 
> 赞同：8
> 
> 时间：2012-05-29T22:10:26.173
> 
> 标签：multithreading, ocaml, delay, sleep, wait

这是 OCaml 中的一个简单的游戏循环。状态被显示，输入被接收，状态被推进。通过在每个循环中将线程延迟 0.025 秒，将每秒帧数限制为 40。

主要.ml：

```
let rec main (* state *) frame_time =
  (* Display state here. *)
  Input.get_input ();
  (* Advance state by one frame here. *)
  (* If less than 25ms have passed, delay until they have. *)
  if((Sys.time ()) < (frame_time +. 0.025)) then
    Thread.delay ((frame_time +. 0.025) -. (Sys.time ()));
  main (* next_state *) (Sys.time ())
;;

let init =
  Graphics.open_graph " 800x500";
  let start_time = (Sys.time ()) in
  main (* start_state *) start_time
;; 
```

对于此示例，该`get_input`函数只是将击键打印到窗口。

输入.ml：

```
let get_input () =
  let s = Graphics.wait_next_event 
    [Graphics.Key_pressed] in
  if s.Graphics.keypressed then
    Graphics.draw_char s.Graphics.key
;; 
```

Makefile 便于测试：

```
main: input.cmo main.cmo
    ocamlfind ocamlc -o $@ unix.cma -thread threads.cma graphics.cma $^ 
main.cmo: main.ml
    ocamlfind ocamlc -c $< -thread
input.cmo: input.ml
    ocamlfind ocamlc -c $< 
```

这在大多数情况下都有效，但是当快速按下键时，程序会因以下错误而崩溃：

`Fatal error: exception Unix.Unix_error(2, "select", "")`

我相信这与`Thread.delay`. 是什么导致了这个问题，实现恒定 FPS 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T01:33:24.247

我不确定发生了什么（这取决于 Thread.delay 的实现，我不知道）。但是，错误 2 是`Unix.EAGAIN`，表示内核资源暂时短缺。顾名思义，您可能应该再次尝试执行 Thread.delay。如果我使用`try`...`with`来捕获 Unix.Unix_error 异常，除了 EAGAIN 被传递之外，我看不到其他错误。如果我只是打印一条消息并继续，该程序似乎可以工作。至少，它会继续向窗口回显字符并且不会崩溃。我正在使用 OS X 10.7 (Lion)。它可能对你有不同的作用。

**编辑**

此代码的另一个可能问题是`Sys.time()`返回*处理器*时间，该时间仅在进程进行实际计算时增加。在进程等待输入时它不会增加。这意味着延迟总是被调用，即使你在按键之间等待很长时间（这让我困惑了一段时间）。使用 可能会更好`Unix.gettimeofday ()`，它返回挂钟时间。

**编辑 2**

经过更多的研究和测试，我相信这个`Unix.EAGAIN`错误告诉你完全延迟被某个事件打断了。在您的情况下，中断事件是角色的到来（我相信）。因此，如果您想等待全部时间，则应将单个调用替换`Thread.delay()`为循环。

这为您的主要代码提供了以下内容：

```
let rec main (* state *) frame_time =
  (* Display state here. *)
  Input.get_input ();
  (* Advance state by one frame here. *)
  (* If less than 25ms have passed, delay until they have. *)
  let rec delay () =
    let duration = frame_time +. 0.025 -. Unix.gettimeofday () in
    if duration > 0.0 then
      try
        Thread.delay duration
      with Unix.Unix_error (Unix.EAGAIN, _, _) -> delay ()
  in
    delay ();
  main (* next_state *) (Unix.gettimeofday  ())
;;

let init =
  Graphics.open_graph " 800x500";
  let start_time = (Unix.gettimeofday  ()) in
  main (* start_state *) start_time
;; 
```

（如果您使用 Unix.select 进行延迟，则可以消除对线程的依赖。但出于其他原因，您可能仍然需要它们。代码看起来相同，除了错误是 EINTR 而不是 EAGAIN。）

# jquery - jQuery Uncaught TypeError：无法读取未定义的属性“fn”（匿名函数）

> ID：10807430
> 
> 赞同：66
> 
> 时间：2012-05-29T22:10:47.307
> 
> 标签：jquery

所有，我从我下载的一些代码中得到一个错误。这是代码：

```
/*----------------------------------------------------------------------*/
/* wl_Alert v 1.1 
/* description: Handles alert boxes
/* dependency: jquery UI Slider, fadeOutSlide plugin
/*----------------------------------------------------------------------*/

$.fn.wl_Alert = function (method) {
var args = arguments;
return this.each(function () {

    var $this = $(this);

    if ($.fn.wl_Alert.methods[method]) {
        return $.fn.wl_Alert.methods[method].apply(this, Array.prototype.slice.call(args, 1));
    } else if (typeof method === 'object' || !method) {
        if ($this.data('wl_Alert')) {
            var opts = $.extend({}, $this.data('wl_Alert'), method);
        } else {

            var opts = $.extend({}, $.fn.wl_Alert.defaults, method, $this.data());
        }
    } else {
        $.error('Method "' + method + '" does not exist');
    }

    if (!$this.data('wl_Alert')) {

        $this.data('wl_Alert', {});

        //bind click events to hide alert box
        $this.bind('click.wl_Alert', function (event) {
            event.preventDefault();

            //Don't hide if it is sticky
            if (!$this.data('wl_Alert').sticky) {
                $.fn.wl_Alert.methods.close.call($this[0]);
            }

            //prevent hiding the box if an inline link is clicked
        }).find('a').bind('click.wl_Alert', function (event) {
            event.stopPropagation();
        });
    } else {

    }
    //show it if it is hidden
    if ($this.is(':hidden')) {
        $this.slideDown(opts.speed / 2);
    }

    if (opts) $.extend($this.data('wl_Alert'), opts);
});

};

$.fn.wl_Alert.defaults = {
speed: 500,
sticky: false,
onBeforeClose: function (element) {},
onClose: function (element) {}
};
$.fn.wl_Alert.version = '1.1';

$.fn.wl_Alert.methods = {
close: function () {
    var $this = $(this),
        opts = $this.data('wl_Alert');
    //call callback and stop if it returns false
    if (opts.onBeforeClose.call(this, $this) === false) {
        return false;
    };
    //fadeout and call an callback
    $this.fadeOutSlide(opts.speed, function () {
        opts.onClose.call($this[0], $this);
    });
},
set: function () {
    var $this = $(this),
        options = {};
    if (typeof arguments[0] === 'object') {
        options = arguments[0];
    } else if (arguments[0] && arguments[1] !== undefined) {
        options[arguments[0]] = arguments[1];
    }
    $.each(options, function (key, value) {
        if ($.fn.wl_Alert.defaults[key] !== undefined || $.fn.wl_Alert.defaults[key] == null) {
            $this.data('wl_Alert')[key] = value;
        } else {
            $.error('Key "' + key + '" is not defined');
        }
    });

}
};

//to create an alert box on the fly
$.wl_Alert = function (text, cssclass, insert, after, options) {
//go thru all
$('div.alert').each(function () {
    var _this = $(this);
    //...and hide if one with the same text is allready set
    if (_this.text() == text) {
        _this.slideUp($.fn.wl_Alert.defaults.speed);
    }
});

//create a new DOM element and inject it
var al = $('<div class="alert ' + cssclass + '">' + text + '</div>').hide();
(after) ? al.appendTo(insert).wl_Alert(options) : al.prependTo(insert).wl_Alert(options);

//return the element
return al;
}; 
```

有没有人见过这种类型的错误？我将如何解决这样的事情？感谢您的任何建议！

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2018-02-20T15:34:02.297

尝试在 bootstrap.js 之前调用 jQuery 库

```
<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/bootstrap.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-05-29T23:01:33.303

尝试这个：

```
(function ( $ ) { 

    // put all that "wl_alert" code here   

}( jQuery )); 
```

因此，该`$`变量显然已损坏，但该`jQuery`变量仍应引用 jQuery 对象。（在正常情况下，`$`和`jQuery`变量都引用（相同的）jQuery 对象。）

不必用整个代码中`$`的名称替换名称`jQuery`，您可以简单地使用[IIFE](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)手动为名称命名。因此，外部变量与函数内部的变量`jQuery`有别名。`$`

这里有一个简单的例子来帮助你理解这个概念：

```
var foo = 'Peter';

(function ( bar ) {

    bar // evaluates to 'Peter'

}( foo )); 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2016-08-11T11:04:26.123

如果您*无法读取 undefined 的属性“fn”*，则问题可能是您以**错误的顺序加载库。**

例如：

您应该先加载**bootstrap.js**，然后再加载*bootstrap.js*库。

```
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.7/js/bootstrap-dialog.min.js"></script> 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-02-22T15:35:11.657

首先导入**jquery CDN**

（例如）

```
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-07-15T07:43:39.487

> 我通过在*jquery.min.js*之后添加*jquery.slim.min.js*作为解决方案序列来修复它。

 ***问题序列**

```
<script src="./vendor/jquery/jquery.min.js"></script>
<script src="./vendor/bootstrap/js/bootstrap.bundle.min.js"></script> 
```

**解决方案序列**

```
<script src="./vendor/jquery/jquery.min.js"></script>
<script src="./vendor/jquery/jquery.slim.min.js"></script>
<script src="./vendor/jquery-easing/jquery.easing.min.js"></script> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-12-22T19:37:31.020

**哈哈哈 有趣的是对我来说这是一个简单的错误**

我得到**`async`**了我的**jquery**库调用。只需删除它，我就得到了解决方案。

```
<script async src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 
```

**至**

```
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 
```

**为什么会出现这种行为：**我在 W3schools [LINK上获得了文档](https://www.w3schools.com/tags/att_script_async.asp)

**定义和使用异步**

async 属性是一个布尔属性。

如果存在，它指定脚本将在可用时立即异步执行。

**注意：** async 属性仅适用于外部脚本（并且仅应在存在 src 属性时使用）。

**注意：**有几种方法可以执行外部脚本：

**1.** **如果存在异步：**脚本与页面的其余部分异步执行（脚本将在页面继续解析的同时执行）

**2.** **如果async不存在而defer存在：**页面解析完成后执行脚本

**3.** **如果 async 或 defer 都不存在：**在浏览器继续解析页面之前，立即获取并执行脚本

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-04-16T17:16:26.527

您可以使用 noConflict 功能：

```
var JJ= jQuery.noConflict(); 
JJ('.back').click(function (){
    window.history.back();
}); 
```

将所有 $ 更改为 JJ。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-01-05T16:07:20.713

当我使用 Electron + Angular 时，这样的顺序帮助我解决了问题

```
 <script src="./assets/js/jquery-3.3.1.min.js"></script>
  <script src="./assets/js/jquery-3.3.1.slim.min.js"></script>
  <script src="./assets/js/popper.min.js"></script>
  <script src="./assets/js/bootstrap.min.js"></script> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-07-06T08:09:29.573

我也有“未捕获的类型错误：无法读取未定义的属性'fn'”：

```
$.fn.circleType = function(options) {

CODE...

}; 
```

但是通过将其包装在文档就绪函数中来修复它：

```
jQuery(document).ready.circleType = function(options) {

CODE...

}; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-02-19T09:15:39.883

如果您实现了 require.js ( [requirejs](http://requirejs.org/) ) 并且您没有包装您正在使用的一些库，也可能会发生此错误

`define(['jquery'], function( jQuery ) { ... lib function ... });`

注意：如果此库支持 AMD，则不必这样做。你可以通过打开这个库来快速检查这个，只需 ctrl+f "amd" :)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-10-31T09:50:31.270

我有同样的问题，我是这样做的

//注意我在上面单独添加了jquery

```
<!--ENJOY HINT PACKAGES --START -->
<link href="path/enjoyhint/jquery.enjoyhint.css" rel="stylesheet">
<script src="path/enjoyhint/jquery.enjoyhint.js"></script>
<script src="path/enjoyhint/kinetic.min.js"></script>
<script src="path/enjoyhint/enjoyhint.js"></script>  
<!--ENJOY HINT PACKAGES --END --> 
```

它有效

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-03T12:06:17.007

我在使用 bootstrap-datewidget 时遇到了同样的问题，我在标题中加载了 jquery，而不是在正文的末尾加载它并且它有效。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-06T10:04:40.927

就我而言，我将 undefine 变量发送到 ajax 数据属性，这就是 ajax 不发送的原因。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-11-03T16:28:55.093

我同意 MarsPeople 关于以错误顺序加载库的观点。我的例子来自使用 owl.carousel。

在 owl.carousel 之后导入 jquery 时出现同样的错误：

```
<script src="owl.carousel.js"></script>
<script src="jquery-3.1.1.min.js"></script> 
```

并通过在 owl.carousel 之前导入 jquery 来修复它：

```
<script src="jquery-3.1.1.min.js"></script>
<script src="owl.carousel.js"></script> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-09-25T06:13:58.320

希望它可以帮助地球上的某个人。在我的情况下，jQuery 和 $ 可用，但在插件引导时不可用，所以我将所有内容都包装在 setTimeout 中。包装内 setTimeout 帮助我修复了错误：

```
setTimeout(() => {
    /** Your code goes here */

    !function(t, e) {

    }(window);

}) 
```*

# dom - 不是 dojo.ready 上的函数（dojo 1.7 相关）

> ID：10807432
> 
> 赞同：2
> 
> 时间：2012-05-29T22:10:56.890
> 
> 标签：dom, dojo

我正在使用 dojo 1.7 进行开发并遇到错误。我的目标是将项目从一个多选框移动到另一个。页面很长，所以我只复制了相关部分。

这是我的头部 js 代码，问题出现在 dojo.ready 之后。变量“newStore”很好用，所以我知道它执行得很好。似乎是 dojo.query("button.switch") 问题。我得到的萤火虫错误是

```
dojo.query("button.switch").connect is not a function 
```

页面加载时会引发此错误。代码是……

```
<script type="text/javascript">
require(["dijit/dijit"]);
require(["dojo/parser"]);
require(["dijit/layout/BorderContainer"]);
require(["dijit/layout/ContentPane"]);
require(["dijit/layout/AccordionContainer"]);
require(["dijit/layout/TabContainer"]);
require(["dijit/form/CheckBox"]);
require(["dijit/form/Button"]);
require(["dijit/form/ComboBox"]);
require(["dijit/form/NumberTextBox"]);
require(["dijit/form/SimpleTextarea"]);
require(["dijit/form/TextBox"]);
require(["dijit/form/Textarea"]);
require(["dijit/form/MultiSelect"]);
require(["clipart/ArrowLeft"]);
require(["clipart/ArrowRight"]);
require(["dijit/form/FilteringSelect"]);
require(["dijit/form/RadioButton"]);
require(["dijit/form/Select"]);
require(["dojox/layout/GridContainer"]);
require(["dojo/data/ItemFileReadStore"]);
require(["dijit/Tree"]);
require(["dojo/ready"]);

dojo.ready(function(){
var newStore = new dojo.data.ItemFileReadStore({
    url: "http://0:3000/sample/sample_name"
   });
   dijit.byId('sc_sample_name').set('store',newStore);

dojo.query("button.switch")
  .connect("onclick",function(e){
    switch(e.target.id.toString()){
      case "left" : dijit.byId("at2").addSelected(dijit.byId("at1")); break;
      case "right" : dijit.byId("at1").addSelected(dijit.byId("at2")); break;
    }
  });
});

</script> 
```

这是一个页面加载问题，这就是为什么我不包括 HTML（这是巨大的）。有没有人见过这种行为？珍妮

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T05:57:40.713

我认为您正在加载[baseless dojo](http://dojotoolkit.org/documentation/tutorials/1.7/hello_dojo/)，即您的`dojoConfig`/`data-dojo-config`有一个选项，它从 1.7 版开始`async:true`将 Dojo 切换到*baseless模式。*

使用`query("button.switch").on("click", function(e) { ...})`代替`connect`：

```
require([
    "dojo/ready",
    "dojo/query"
], function(
    ready,
    query
) {

    ready(function() {

        query("button.switch").on("click", function(e) {
            console.log(e.target.id);            
        }); 
    });  
});​ 
```

或者不要切换到*无基础*模式。

在这个 jsFiddle 上自己尝试一下：http: [//jsfiddle.net/phusick/LMdBd/](http://jsfiddle.net/phusick/LMdBd/)，更改`async: true`为`async: false`或完全删除它并且`connect`将工作：

![在此处输入图像描述](../Images/f89218c1f2354c98b34e47e67b859639.png)

# wordpress - Wordpress 插件从服务器检查更新

> ID：10807435
> 
> 赞同：1
> 
> 时间：2012-05-29T22:11:08.670
> 
> 标签：wordpress

我现在正在为 Wordpress 编写一个插件，并希望它最终能够在 Wordpress 扩展库上将软件更新到最新版本。似乎很少或没有关于如何做到这一点的代码。更重要的是，该插件会在第一次运行后生成一个文本文件以将一些基本的东西保存在内存中，我不想在更新时丢失它。

我如何确保这两件事能够发生？

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T01:58:50.043

为了让用户检测到任何新的插件更新，您需要阅读[Wordpress 插件开发人员中心文档](http://wordpress.org/extend/plugins/about/)。

假设您的插件被接受，它将托管在 Wordpress 的[Subversion 存储库](http://wordpress.org/extend/plugins/about/svn/)中，任何想要下载它的人都可以使用，并且您也可以在闲暇时进行更新。一旦检测到新更新，Wordpress 会在插件菜单中自动通知正在使用您的插件的用户有可用的新更新。

就您的文本文件而言，您还需要阅读[插件指南](http://wordpress.org/extend/plugins/about/guidelines/)以确保您没有违反他们的任何条款。否则，您的插件将被其托管平台拒绝。

如果您的插件已获准用于托管，并且您仍然需要解决 txt 文件问题，那么您有几个选项来存储数据：

1.  您可以将文件存储在插件目录之外（即：Wordpress 安装的根目录，或插件目录本身）。请记住，您可能还需要连接到 Wordpress' deactivate_(plugin file name) 清除用户不再需要/想要的任何文件的操作。

2.  最好将您需要的插件数据存储在一个单独的表中（随后在停用时删除），您可以随时查询。如果您不想使用单独的表格，也可以使用[自定义选项。](http://codex.wordpress.org/Creating_Options_Pages)

希望这些信息足以让您开始使用插件。让我知道这是否有帮助。

# iphone - 在表格左侧垂直移动表格部分

> ID：10807436
> 
> 赞同：1
> 
> 时间：2012-05-29T22:11:12.583
> 
> 标签：iphone, objective-c, ios, xcode

我用一些数据和部分创建了表格。默认情况下，表格（部分）的头部位于表格的顶部。我想知道是否可以将表格左侧的部分垂直移动，如下图链接所示。

[http://i48.tinypic.com/2dcg0fp.png](http://i48.tinypic.com/2dcg0fp.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T05:21:23.760

我认为不可能移动表格视图左侧的部分。但是你可以自定义它。您可以自定义表格视图。假设您要创建section1，然后采取简单的视图并画一条细线或使用1px的图像定期画线。

# performance - 如何预测 HLSL 着色器如何影响性能？

> ID：10807438
> 
> 赞同：0
> 
> 时间：2012-05-29T22:11:17.390
> 
> 标签：performance, directx, shader, direct3d, hlsl

例如，如果我渲染一个平面，我每秒可以得到 1500 帧。使用简单的混合贴图，帧速率下降到 700（双帧速率下降？！）。在 Microsoft DirectX SDK 示例“视差遮挡映射”中模型很小，不超过 200 个顶点圆，但帧率下降到 400。让我感到困惑的是，像孤岛危机这样的游戏结合了所有最新和最重的着色器效果（镶嵌比视差映射重得多），是的，我可以在超设置下输出 50 FPS。这比 SDK 示例少 6 倍，但 Crysis 在屏幕上渲染数十万个顶点 + 效果比 SDK 示例多倍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:51:53.597

在像这样的简单示例中查看帧速率并不是一个非常有意义的性能衡量标准。DirectX 旨在为您以大约 60 fps 的每帧渲染大量几何图形的类似游戏的工作负载提供高效，而不适用于您以 100 或 1000 fps 的速度渲染非常简单的几何图形的合成测试。基于像这样单独测量帧速率，您无法推断出关于渲染特定对象的相对性能的任何非常有用的信息。软件和硬件设计用于 16.6 毫秒帧的最大吞吐量，而不是最小延迟。

在查看 DirectX 性能时，您需要记住很多事情是并行进行的。在典型的游戏中，CPU 将在 GPU 渲染第 n-1 帧时为第 n 帧发出绘制命令。GPU 管道可能会为来自一个绘制调用的三角形着色像素，同时对来自不同调用的三角形进行光栅化，并处理来自另一个调用的顶点，所有这些都在同时工作的不同硬件单元上。孤立地查看渲染简单事物的帧速率，您并没有有效地利用硬件。许多硬件将在相当长的一段时间内处于空闲状态。硬件的设计目的是在一次处理很多事情时实现最大吞吐量，而当你一次只给它一件或几件事情时，它的大部分能量都被浪费了。

正如您所注意到的，像孤岛危机这样的现代游戏设法在高端 GPU 上以 60 fps 的速度渲染非常复杂的场景。如果您有一个特定的场景，您正在尝试渲染或尝试在其中一个 GPU 上创建效果，那么它很可能足够快以满足您的需求，而无需您进行任何优化工作。如果您确实达到了性能成为场景问题的程度，那么可以使用 PIX、nvPerfHUD 等性能工具来跟踪和优化场景中的性能瓶颈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:29:14.463

简单地说——优化的游戏引擎在每帧做尽可能少的工作的同时推送尽可能多的数据。IMO，该示例的帧速率下降并不反映着色器/代码在 GPU/CPU 上工作的难度，而且该示例没有像你比较的引擎。

直接比较tessellation和pixel-push是错误的。现代游戏引擎通常会生成大量可以在 GPU 本身上看到的细节，这对帧速率很有好处。另外——当你在游戏世界中时，你不知道你能看到的那块“高度”镶嵌的岩石是精心制作的错觉，还是它实际上是由许多多边形组成的。

如果您要进行调整，我敢打赌 DX 样本也可以制作得非常快。但它将不再具有可读性——也不再是手头技术的纯粹说明。

另外，请注意，添加任务不会线性增加所花费的时间。尝试渲染两个表面。帧率下降多少？

# c# - 如果以编程方式创建控件，则 Windows Media Player 视频为黑色

> ID：10807441
> 
> 赞同：9
> 
> 时间：2012-05-29T22:11:28.900
> 
> 标签：c#, windows-media-player, axwindowsmediaplayer

我正在尝试以编程方式创建 Windows Media Player 控件，以便捕获任何初始化错误。在我简单地将控件放在表单上之前，一切正常。但是现在我正在尝试以编程方式播放内容，视频没有出现在控件中。我只看到黑色视频，但我听到了音频。

有任何想法吗？

```
 public TrimVideoControl()
    {
        InitializeComponent();

        // Try creating WMP control
        // We do this here so we can gracefully catch errors if the control doesn't load
        try
        {

            wmPlayer = new AxWMPLib.AxWindowsMediaPlayer();
            ((System.ComponentModel.ISupportInitialize)(wmPlayer)).BeginInit();
            //SuspendLayout();
            wmPlayer.CreateControl();
            wmPlayer.Name = "wmPlayer";
            wmPlayer.Ctlenabled = true;
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(TrimVideoControl));
            wmPlayer.OcxState = ((System.Windows.Forms.AxHost.State)(resources.GetObject("wmPlayer.OcxState")));
            wmPlayer.Location = new Point(12, 13);
            wmPlayer.Size = new Size(636, 358);
            wmPlayer.enableContextMenu = true;
            wmPlayer.stretchToFit = true;
            wmPlayer.uiMode = "none";
            wmPlayer.settings.autoStart = false;
            wmPlayer.ErrorEvent += wmPlayer_ErrorEvent;
            wmPlayer.MediaChange += wmPlayer_MediaChange;
            wmPlayer.MediaError += wmPlayer_MediaError;
            wmPlayer.OpenStateChange += wmPlayer_OpenStateChange;
            wmPlayer.PlayStateChange += wmPlayer_PlayStateChange;
            wmPlayer.Warning += wmPlayer_Warning;
            this.Controls.Add(wmPlayer);
            ((System.ComponentModel.ISupportInitialize)(wmPlayer)).EndInit();

            //this.ResumeLayout(false);
            //this.PerformLayout(); 
            //wmPlayer.Show();
            //wmPlayer.BringToFront();
        }
        catch (Exception ex)
        {
            Logger.Error("Error creating WMP control: " + ex);
        }

    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T09:34:54.983

MediaPalyer 运行时创建的确切问题是我们无法在组件完全初始化之前对 MediaPlayer 的状态进行任何更改（任何设置，如 url/uimode 等）。VS-designer 将组件的状态序列化为一个`AxHost.State`对象，并且不影响任何其他设置。在运行时，您可以使用以下方法：

```
void AddMediaPlayer(string url) {
    try {
        var wmPlayer = new AxWMPLib.AxWindowsMediaPlayer();

        ((System.ComponentModel.ISupportInitialize)(wmPlayer)).BeginInit();
        wmPlayer.Name = "wmPlayer";
        wmPlayer.Enabled = true;
        wmPlayer.Dock = System.Windows.Forms.DockStyle.Fill;
        this.Controls.Add(wmPlayer);
        ((System.ComponentModel.ISupportInitialize)(wmPlayer)).EndInit();

        // After initialization you can customize the Media Player
        wmPlayer.uiMode = "none";
        wmPlayer.URL = url;
    }
    catch { }
} 
```

# teamcity - TeamCity 中的 MsTest：找到了针对一种构建配置但没有针对另一种构建配置的测试

> ID：10807448
> 
> 赞同：2
> 
> 时间：2012-05-29T22:12:08.810
> 
> 标签：teamcity, mstest

我有一个使用两个构建配置设置的 TeamCity 项目。每三分钟运行一次，以连续的方式运行。另一个每小时运行一次。这些曾经是一种配置，直到我拆分出连续构建。两种配置都有两个构建步骤：第一个构建解决方案，第二个使用 MsTest 运行单元测试。

在拆分为两个配置之前，MsTest 构建步骤运行所有具有属性 [Category("Unit")] 的测试。MsTest 构建步骤中的“附加命令行参数”值为“/category:unit”。我创建了一个新的测试属性类别——“集成”——以便在两种配置之间拆分两种类型的测试。每小时构建配置旨在使用“/category:integration”的“附加命令行参数”值。

不幸的是，每小时构建配置没有找到任何要运行的测试。命令行参数是否包含“unit”、“integration”或两者都没有关系（“unit|integration”）。另一方面，持续构建查找并运行与命令行参数中包含的类别相对应的测试。每小时构建日志包括以下输出：

```
[14:48:07]Step 2/2: Test Solution Hourly (MSTest) (29s)
[14:48:07][Step 2/2] Starting: C:\TeamCity\buildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.NUnitLauncher.exe #TeamCityImplicit
[14:48:07][Step 2/2] in directory: D:\TeamCity\buildAgent\work\23f125e3a59e551a
[14:48:11][Step 2/2] No assemblies, run configuration and test metadata were found 
```

除了构建触发之外，这两种构建配置在所有方面都是相同的。他们使用默认的 checkout 和 work 目录，以及相同的构建配置参数。为两者创建相同的工作目录。它们之间没有依赖关系。它们在同一个代理上运行。

我的问题是：为什么每小时配置找不到测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T16:16:42.960

我知道您说过您的两个构建步骤之间的测试模式相同，但请仔细检查。这具有搜索模式错误的所有特征。

如果 TeamCity 实际上在日志中回显了您的测试程序集的搜索模式，那就太好了，但由于它没有，因此很容易意外地在路径中遗漏斜杠 - 特别是在您使用参数化路径时。有时很容易丢失百分比符号之间的斜线。

# java - 使用 CXF Rest 客户端解析响应实体

> ID：10807449
> 
> 赞同：1
> 
> 时间：2012-05-29T22:12:09.320
> 
> 标签：java, web-services, rest, cxf

我正在使用 CXF 2.3.2，我制作了这个 REST 服务：

界面：

```
@WebMethod
@GET
@Path("/object/{id}")
@Consumes({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML, MediaType.TEXT_XML})
@Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML, MediaType.TEXT_XML})
public Response object(@PathParam("id") Long id); 
```

实施：

```
@Override
public Response object(Long id) {

    CompanyVO company = new CompanyVO();
    company.setAddress("address");
    company.setFantasyName("fantasy name");
    company.setFiscalId("fiscalid");
    company.setGroups("groups");

    return Response.ok().type(MediaType.APPLICATION_XML).entity(company).build();
} 
```

我需要使用 CXF REST 客户端使用该服务，并将 de Response 中的对象实体作为 Java 对象获取，而不是作为 InputStream。

我做了第一个实现如下，使用一个 ResponseReader 类来包装我的 Java 类：

```
String operation = "/object/{id}";

    ResponseReader reader = new ResponseReader();
    reader.setEntityClass(CompanyVO.class); 

    WebClient client = WebClient.create(PATH,  Collections.singletonList(reader));
    client.path(operation, 12L);
    client.accept(MediaType.APPLICATION_XML);
    client.type(MediaType.APPLICATION_XML);

    //the response's entity object should be this Class.
    CompanyVO company = new CompanyVO();

    Response response = client.get();

    //i get the entity object as a InputStream, but i need a CompanyVO.
    //i made this once, but i can't see the difference.
    Object entity = response.getEntity(); 
```

也许我把服务弄错了，或者客户的配置不好。我需要你的帮助，拜托！

该服务是使用 Spring 3.0.5 配置的：

```
<jaxrs:server id="serviceAdvisorRestServer" address="/rest">

    <jaxrs:serviceBeans>
        <ref bean="fileService"/>
    </jaxrs:serviceBeans>

     <jaxrs:extensionMappings>
        <entry key="json" value="application/json"/>
        <entry key="xml" value="application/xml"/>
        <entry key="html" value="text/html"/>
        <entry key="pdf" value="application/pdf"></entry>
    </jaxrs:extensionMappings> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T17:06:56.363

Instead of getting the Response object by invoking the get method on client try this:

```
CompanyVO company = client.get(CompanyVO.class); 
```

I think this might be able to solve your problem.

Have a look at webclient [api](http://www.jarvana.com/jarvana/view/org/apache/cxf/cxf-bundle-jaxrs/2.3.2/cxf-bundle-jaxrs-2.3.2-javadoc.jar!/org/apache/cxf/jaxrs/client/WebClient.html)

Also i dont think you would need @Consumes annotation on your webservice method for application/json etc... as you are using a Path parameter in the method.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-13T13:11:24.730

对于 CXF 2.3.X，这里没有干净的解决方案，除了切换到使用 JAXRSClientFactory 的代理或使用双重调用 (get() - get(someclass.class)。webclient 不支持阅读器提供程序。

CXF 2.7.X（几乎）实现了 JAX-RS 2.0，从这个版本开始，您可以调用 client.readEntity()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T10:17:38.313

对于**代理 API**，它应该像这样工作：

尝试：

```
ResponseReader reader = new ResponseReader();
reader.setEntityClass(CompanyVO.class); 

InterfaceClass proxy = JAXRSClientFactory.create(PATH, InterfaceClass.class, Collections.singletonList(reader)); 
```

然后：

```
Response res = proxy.get();
CompanyVO company = (CompanyVO) res.getEntity(); 
```

对于**WebClient**，它的工作方式应该完全相同：

尝试：

```
ResponseReader reader = new ResponseReader();
reader.setEntityClass(CompanyVO.class); 

WebClient client = WebClient.create(PATH, Collections.singletonList(reader)); 
```

然后：

```
Response res = client.get();
CompanyVO company = (CompanyVO) res.getEntity(); 
```

# c# - .Net 4.5 中等效的 Microsoft.Windows.Shell 命名空间

> ID：10807451
> 
> 赞同：4
> 
> 时间：2012-05-29T22:12:14.723
> 
> 标签：c#, .net, wpf, ribbon

我正在评估名为[Prism 4 MEF 应用程序](http://www.codeproject.com/Articles/254120/Prism-4-MEF-Application)的代码。它是一个 .Net 4.0 应用程序，并引用了[Microsoft.Windows.Shell 命名空间](http://msdn.microsoft.com/en-us/library/microsoft.windows.shell)，如果您安装[Microsoft Ribbon for WPF 控件](http://msdn.microsoft.com/en-us/library/ff806375)，则该命名空间可用。

但是，我正在开发 .Net 4.5 框架，功能区控件以某种方式添加到框架中，我可以将它与对 DLL 的引用一起使用，并且`System.Windows.Controls.Ribbon`不使用命名空间`Microsoft.Windows.Controls.Ribbon`

.net 4.5 中是否有任何等效控件，我如何引用它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T22:15:50.347

在 .NET 4.5 中，其中许多项位于[System.Windows.Shell](http://msdn.microsoft.com/en-us/library/system.windows.shell%28v=vs.110%29.aspx)命名空间中，但现在直接位于 PresentationFramework.dll 程序集中。例如，这可以在[JumpItem 类](http://msdn.microsoft.com/en-us/library/system.windows.shell.jumpitem%28v=vs.110%29.aspx)文档中看到。

如果您在 .NET 4.5 中使用 WPF，您应该能够使用现有代码*而无需*添加额外的引用。

# sql-server-2008 - 使用 SqlServer 2008 复制linkedin 的数据总线

> ID：10807456
> 
> 赞同：1
> 
> 时间：2012-05-29T22:12:54.187
> 
> 标签：sql-server-2008, scalability, publish-subscribe, change-data-capture

我正在尝试在我的组织中重新创建linkedin 的[数据总线](http://highscalability.com/blog/2012/3/19/linkedin-creating-a-low-latency-change-data-capture-system-w.html)架构，以用于高度有争议的数据库。我最初的想法是使用 SQL Server 的变更数据捕获 (CDC) 功能来捕获所有事件并将它们发布到外部数据存储区，就像 LI 使用其“引导程序”所做的那样。如果我编写一个服务来不断汇集 cdc 表，我可以将它们写入我的引导数据库，然后使用一些 pub/sub 系统发布事件。

我的问题是，是否有人尝试过这样的事情，如果我前面提到的方法似乎是一种好方法，或者是否有更好的方法来捕获这些事件并发布它们？

谢谢。

**编辑：[添加详细信息]**

我还没有完全决定辅助数据存储。至少在短期内，它很可能是另一台服务器上的另一个 SQL Server 2008 实例。此辅助存储的主要目的之一是减轻主服务器的负载。我们的主数据库已经变得非常大（> 2.5TB），增加任何额外的负载都是不受欢迎的。如果我可以实现这个架构，那么额外的收获就是从本质上管理复制，从主服务器中承担大部分复制责任。

理想情况下，我什至不想使用 CDC。我觉得这是一项很棒的技术，但它确实将这些更改存储在本地，并且根据我的阅读，它会导致服务器性能受到影响。但是，就目前而言，这似乎是我最好的选择。

**编辑2：[进一步的过程细节]**

我试图实现的确实与复制非常相似。在这个辅助服务器上，我要做的是从基本数据库的副本和一组用于跟踪更改的表开始。然后，我将有一个服务来监视 CDC 表并将这些事件移动到新数据库，从源中清除它们，并将更改应用到第二个服务器的基本副本。

下一个组件将是一个发布/订阅服务，它将获取所有发布的更改事件，并且任何消费者都可以选择订阅以获取这些更改事件。完整的数据库副本将用于在新消费者上线时“引导”他们，这样他们就可以在开始获取更改事件之前获取完整的、最新的数据库。如果消费者离线并错过事件，跟踪表也将用于获取增量。

客户将能够应用规则来翻译他们认为合适的数据。第一个应用程序将纯粹是创建原始数据库的只读副本。未来的计划包括对数据进行反规范化并转换为其他格式，例如 MongoDb 集合。

如果可以在远程服务器上维护 CDC 表，则可以最简单地实现第一部分。但是，我没有看到任何方法可以做到这一点。

我知道这听起来令人费解，但它会解决一个真正的问题，从linkedin 的解决方案来看，这个问题在当今并不罕见。

希望这会有所帮助。

# asp.net - 顺序数据的最佳缓存设计是什么？

> ID：10807457
> 
> 赞同：0
> 
> 时间：2012-05-29T22:13:01.577
> 
> 标签：asp.net, caching, azure

我在网上卖票，每张票都有票号（32字节随机）和票号（长序列）。我有 2 种类型的小客户，他们要求大约 1-10k 钥匙和批发商要求 50k-1m 门票，整个销售商希望门票 ID 尽可能连续。我不应该向 2 个客户出售同一张门票。门票是生成并放入 sql db，我可以在前端提取/保存（天蓝色实例），这就是我的计划。在前端机器上，我应该使用什么缓存，我既可以按顺序原子方式读取/标记，也可以在 asp.net 请求中使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T06:01:53.730

如果您在 Windows Azure 上开发解决方案，Windows Azure 缓存是您最好的选择。启用“本地缓存”时速度很快，因为延迟几乎为 0 毫秒，但您的数据必须适合内存。[您可以在此处](http://msdn.microsoft.com/en-us/library/windowsazure/gg278356.aspx)找到有关 Windows Azure 缓存的更多信息。

如果您想尝试 Memcached，您当然可以尝试使用 Memcached 和“带有本地缓存​​的 Windows Azure 缓存”，您将看到的差别不大。SMarx 在此处有一篇关于在 Windows Azure 上使用 Memcache 的精彩[文章](http://blog.smarx.com/posts/memcached-in-windows-azure)。

我认为您可以使用[SQLCacheDependency](http://msdn.microsoft.com/en-us/library/ms178604.aspx)类来创建一个缓存项依赖项，该依赖项与数据库中的票据项有关。当一个工单被代理拿走时，工单项目行将发生变化，这将导致依赖无效，工单 ID 将从缓存中。

[这](http://msdn.microsoft.com/en-us/library/ee957907.aspx)是 .NET Framework 应用程序的模式和实践指南，它可以指导您编写更好的方法来缓存内容以进行原子访问。

我建议你也看看这里： [ASP.NET 中缓存的模式和最佳实践是什么？](https://stackoverflow.com/questions/1763694/what-are-the-patterns-and-best-practices-for-caching-in-asp-net)

# php - 在不打开浏览器的情况下不断运行 php 循环

> ID：10807458
> 
> 赞同：0
> 
> 时间：2012-05-29T22:13:18.743
> 
> 标签：php, while-loop, daemon, crontab

我有一个我想不断运行的 php 循环。目前，如果您让 x.php 在浏览器中运行，那么它会永远循环。只要您打开浏览器窗口...并且效果很好。

我如何让它不断运行，而不必坐在上面打开浏览器选项卡？我希望它 24/7 全天候运行，如果它停止运行。它需要重新启动自己。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:17:37.957

你可以从命令行运行它吗？

```
nohup php -f /path/to/x.php & 
```

`nohup`即使用户注销，它也会继续运行。

其他答案中的 cron 解决方案每次运行时都会启动一个新实例 - 不确定您是否想要。但是，如果脚本终止并且您想重新启动它，那么您将必须运行一个单独的守护程序来检查它是否正在运行，如果没有，则启动它。您可以制作一个简单的脚本来执行检查并开始运行它，然后 cron 该脚本每隔 5 分钟运行一次，或者您想要的任何频率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:25:25.350

这取决于您如何触发 PHP。

如果您希望它在浏览器中开始执行，您有多种选择。您可以在后台启动一个新进程（例如，使用 调用 shell 脚本`exec`，这会产生另一个 php 进程），或者您可以尝试提供的`ignore_user_abort()`方法。

`ignore_user_abort(true)`将完全按照它在锡上说的做，如果用户中止页面请求（它将无休止地运行），后端 PHP 进程将不会注意到这一点。请注意，它并非在所有情况下都有效，例如，您不能将任何输出发送回浏览器。显然这是因为管道已关闭，但我的意思是它不是可捕获的错误，脚本将停止执行。

如果您*没有*在浏览器中启动它，我会建议这样做，我会建议使用带有自定义脚本的 cron。我会使用每分钟运行的 cron 脚本来完成。该脚本最初将使用 PID 文件创建 PHP 进程，PHP 将处理您需要它执行的任何操作。脚本的每次后续运行，它都会检查 PID 文件是否存在，如果存在，它会检查进程是否处于活动状态。如果没有，它将按照最初的计划重复创建进程/PID 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:17:45.287

阅读有关[cron 作业](https://www.google.co.uk/search?num=100&hl=en&q=cronjob&oq=cronjob)的信息。在他们的帮助下，您可以执行任何 php 脚本以 24/7 每分钟运行一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:19:07.117

不太确定您要完成什么，但是听起来您要运行的是脚本？如果是这样，您想为它创建一个 cron 选项卡。语法可以在这里找到：

[http://content.hccfl.edu/polllock/unix/crontab.htm](http://content.hccfl.edu/pollock/unix/crontab.htm)

一个例子可能是：

```
5/* * * * 1 /usr/bin/php -q /location/to/your/script/file.php 
```

# javascript - VB.Net 2010 安装程序

> ID：10807460
> 
> 赞同：1
> 
> 时间：2012-05-29T22:13:20.957
> 
> 标签：javascript, vb.net, installation

我目前正在尝试为我最近创建的应用程序创建 Visual Basic 2010 安装程序。Installer 的想法是将必要的 JavaScript 文件推送到指定位置，并创建程序供用户使用。

问题：我正在尝试将 Javascript 文件合并到我的安装程序中，以便可以将其推送到用户的文件中 - 当然，检查该文件结构是否已安装，但我不知道如何安装。任何帮助都是有益的！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:54:22.467

在文件系统中创建一个自定义文件夹，您可以在默认位置使用这些文件夹属性[系统文件夹属性](http://msdn.microsoft.com/en-us/library/aa372057%28v=vs.80%29.aspx)来指定您需要的路径。将所有文件放入该自定义文件夹中，您就完成了。

# c# - 使用 Html Agility Pack 在两个 HTML 标记之间获取内容

> ID：10807461
> 
> 赞同：5
> 
> 时间：2012-05-29T22:13:21.920
> 
> 标签：c#, .net, html-agility-pack

我们在 Word 中创建了一个绝对庞大的帮助文档，它被用来生成一个更大且笨拙的 HTM 文档。使用 C# 和这个库，我只想在我的应用程序的任何位置抓取并显示这个文件的一部分。部分是这样划分的：

```
<!--logical section starts here -->
<div>
<h1><span style='mso-spacerun:yes'></span><a name="_Toc325456104">Section A</a></h1>
</div>
 <div> Lots of unnecessary markup for simple formatting... </div>
 .....
<!--logical section ends here -->

<div>
<h1><span style='mso-spacerun:yes'></span><a name="_Toc325456104">Section B</a></h1>
</div> 
```

从逻辑上讲，标签中有一个`H1`带有部分名称的`a`标签。我想从包含 div 的外部选择所有内容，直到遇到另一个`h1`并排除该 div。

*   每个部分名称都位于一个`<a>`标签下，`h1`其中有多个孩子（每个大约 6 个）
*   逻辑部分标有注释
*   实际文档中不存在这些注释

**我的尝试：**

```
var startNode = helpDocument.DocumentNode.SelectSingleNode("//h1/a[contains(., '"+sectionName+"')]");
//go up one level from the a node to the h1 element
startNode=startNode.ParentNode;

//get the start index as the index of the div containing the h1 element
int startNodeIndex = startNode.ParentNode.ChildNodes.IndexOf(startNode);

//here I am not sure how to get the endNode location. 
var endNode =?;

int endNodeIndex = endNode.ParentNode.ChildNodes.IndexOf(endNode);

//select everything from the start index to the end index
var nodes = startNode.ParentNode.ChildNodes.Where((n, index) => index >= startNodeIndex && index <= endNodeIndex).Select(n => n); 
```

Sine 我无法找到这方面的文档，我不知道如何从我的起始节点到下一个 h1 元素。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T23:19:16.770

我认为这会做到，尽管它假设 H1 标签只出现在部分标题中。如果不是这种情况，您可以在后代上添加 Where 以检查它找到的任何 H1 节点上的其他过滤器。请注意，这将包括它找到的 div 的所有兄弟姐妹，直到找到具有节名称的下一个。

```
private List<HtmlNode> GetSection(HtmlDocument helpDocument, string SectionName)
{
    HtmlNode startNode = helpDocument.DocumentNode.Descendants("div").Where(d => d.InnerText.Equals(SectionName, StringComparison.InvariantCultureIgnoreCase)).FirstOrDefault();
    if (startNode == null)
        return null; // section not found

    List<HtmlNode> section = new List<HtmlNode>();
    HtmlNode sibling = startNode.NextSibling;
    while (sibling != null && sibling.Descendants("h1").Count() <= 0)
    {
        section.Add(sibling);
        sibling = sibling.NextSibling;
    }

    return section;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:33:56.367

那么，您真正想要的是 h1-Tag 周围的 div 吗？如果是，那么这应该有效。

```
helpDocument.DocumentNode.SelectSingleNode("//h1/a[contains(@name, '"+sectionName+"')]/ancestor::div"); 
```

也可以`SelectNodes`根据您的 Html 使用。像这样：

```
helpDocument.DocumentNode.SelectNodes("//h1/a[starts-with(@name,'_Toc')]/ancestor::div"); 
```

哦，在测试这个时，我注意到对我不起作用的是 contains 方法中的点，一旦我将它更改为 name 属性，一切正常。

# php - 在javascript中单击按钮时更改textarea中文本的那些方法是什么？

> ID：10807462
> 
> 赞同：1
> 
> 时间：2012-05-29T22:13:26.933
> 
> 标签：php, javascript, html, smarty

例如现在我有：

```
<textarea style='width:100%;height:300px' id='default_file' readonly="readonly">
{$defaultFileContents[0]|escape}  // smarty code  
</textarea> 
```

但是，我希望它显示等效于（例如单击“下一步”按钮时）：

```
<textarea style='width:100%;height:300px' id='default_file' readonly="readonly">
{$defaultFileContents[1]|escape}  // smarty code
</textarea> 
```

并带有索引 2、3、4 等。

$defaultFileContents 是从 PHP 脚本中检索的字符串数组。

编辑：

```
{literal}
<script language="javascript" type="text/javascript" src="modules/Yastt/views/tpls/editarea/edit_area/edit_area_full.js"></script>
<script language="javascript" type="text/javascript">

editAreaLoader.init({
    id : "default_file"     // textarea id
    ,syntax: "{/literal}{$fileType}{literal}"           // syntax to be uses for highgliting
    ,start_highlight: true      // to display with highlight mode on start-up
    ,allow_toggle: true
    ,is_editable:false

});

editAreaLoader.init({
    id : "translated_file"      // textarea id
    ,syntax: "{/literal}{$fileType}{literal}"           // syntax to be uses for highgliting
    ,start_highlight: true      // to display with highlight mode on start-up
    ,allow_toggle: true

});

{/literal}
</script>
<table><tr><td colspan='2'>
    <div style='font-size:18px;font-weight:bold;'>File Edit ({$defaultLang} To {$translatedLang})

    </div>
</td></tr>

<tr><td>
<div style='font-size:18px;font-weight:bold;'>{$file}</div>
</td></tr></table>

<textarea style='width:100%;height:300px' id='default_file'>
{$defaultFileContents[0]|escape}
</textarea>

<form method='POST' name='FileEdit' action='index.php'>
<input type='hidden' name='module' value='Yastt'>
<input type='hidden' name='action' value='saveraw'>
<input type='hidden' name='lang' value='{$translatedLang}'>
<input type='hidden' name='file' value='{$file}'>
<input type='submit' value='Save'>
<input type='button' value='Cancel' onclick='document.location.href="index.php?module=Yastt&action=overview&lang={$translatedLang}"'>
<input type='button' value='Copy From Above' onclick='document.getElementById("translated_file").value = decodeURIComponent("{$defaultFileContents[0]|escape:'url'}");'>
<textarea style='width:100%;height:500px' name='rawfile' id='translated_file'>
{$translatedFileContents|escape}
</textarea>
</form>
<br>

</form> 
```

您将如何修改此 tpl 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:31:14.290

您需要将消息数组转换为 JavaScript 数组。您可以使用`json_encode`使其变得轻而易举：

```
$message = array( "Message 1", "Message 2", "Message 3" );

// var messages = ["Message 1","Message 2","Message 3"];
printf("var messages = %s;", json_encode( $message )); 
```

接下来准备 HTML：

```
<textarea id="default_file"></textarea><br/>
<button id="advance_text" onclick="advanceMessage()">Next</button> 
```

通常，您会从 JavaScript 方面进行点击绑定，但现在我将保持原样：

```
// Reference to our textarea, build messages array, set message counter:
var textarea = document.getElementById("default_file");
var messages = [ "First Message", "Second Message", "Third Message" ];
var currMesg = 0;

// Advance to the next message
function advanceMessage() {
    textarea.value = messages[ currMesg++ % messages.length ];
}

// Call immediately to load first message
advanceMessage(); 
```

小提琴：http: [//jsfiddle.net/hCMs8/](http://jsfiddle.net/hCMs8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:24:20.623

我会做这样的事情：

我以前没有使用过 smarty，所​​以做任何你需要做的事情来从 smarty 获取你想要的文本到一个数组中。

```
var text_from_smarty = [ "{$defaultFileContents[0]|escape}", "{$defaultFileContents[1]|escape}"]; // etc
var visible_text_index = 0; 
```

现在，当您点击下一步时，调用如下函数：

```
function show_next_text(){
    document.getElementById('default_file').innerHTML = text_from_smarty[ (visible_text_index++)%text_from_smarty.length ];
} 
```

这是一个jsfiddle：http: [//jsfiddle.net/6dmFY/](http://jsfiddle.net/6dmFY/)

# ios5 - 如何通过 iOS App 对微软活动目录进行身份验证？

> ID：10807467
> 
> 赞同：1
> 
> 时间：2012-05-29T22:13:52.767
> 
> 标签：ios5, active-directory, ldap, openldap

我要通过 iOS 应用程序向 Active Directory 验证用户名和密码凭据吗？

我知道[这篇文章](https://stackoverflow.com/questions/7877233/using-ldap-for-authentication-in-ios)指示我们在项目中包含 openldap，但是这里[的这篇文章](https://stackoverflow.com/questions/7651875/how-to-authenticate-to-active-directory-using-ios-app?answertab=oldest#tab-top)表明我可以使用内置的 ldap 协议来使用 PHP 与 Active Directory 连接。

有人可以阐明这两个主题，并选择一个对当前版本的 XCode 有用的主题。

而且，有没有任何用户可以分享的例子？

PS：这是我在stackoverflow中的第一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T13:13:28.593

除非您在 Internet 上公开您的域，否则您将需要某种服务层。如果您了解 php，那可能是一个不错的选择。然后，从 iOS 应用程序中，您只需调用通过您的 php 服务器公开的操作。要创建服务，您可能需要查看[php 的 ldap 库](http://adldap.sourceforge.net/)。

# github - 在 Zend Studio 9 中推送到 github 错误

> ID：10807469
> 
> 赞同：0
> 
> 时间：2012-05-29T22:14:03.157
> 
> 标签：github, push, zend-studio

我正在使用 Zend Studio 9.0.3，我在 github 上有一个存储库。我在本地机器上从 github 创建了一个项目。我可以提交事情，但是一旦我尝试推送到上游，我就会收到以下错误：

无法连接到任何存储库：[https](https://github.com/xxxxx/xxxxx.git) ://github.com/xxxxx/xxxxx.git （推送期间发生内部异常：[https](https://github.com/xxxxx/xxxxx.git) ://github.com/xxxxx/xxxxx.git ：写入的数据不足）

我错过了什么吗？在此先感谢您的任何信息！

（注意：用 xxxx 替换了实际的 url - 不希望任何人在它正在开发时嗅探它 =]）

# 编辑：

我不再收到该错误，但现在 Zend Studio 认为 master/origin 存储库已经是最新的，而有几个提交等待推送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:35:39.747

解决了这个问题。

我为解决此问题而采取的步骤：

1.  打开首选项 -> 常规 -> 网络 -> 生成新的 SSH (RSA) 密钥
2.  转到github，将密钥添加到您的密钥中
3.  删除了 Zend studio 所做的默认转速设置
4.  推送到原点/主控。
5.  成功\o/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:19:14.277

我在创建两个（或更多）代码分支时遇到了类似的错误，然后将它们合并、提交和推送。我猜这是由 git 算法中的一些错误引起的。

# c++ - 如何制作更高级别的并行代码/脚本？

> ID：10807471
> 
> 赞同：0
> 
> 时间：2012-05-29T22:14:06.627
> 
> 标签：c++, shell

新手来了

我有一个 c++ 程序 XX，注意 XX 在这里是一个可执行的二进制文件。现在我想让这个程序 XX 做 N 次类似的工作，但有 N 组不同的输入参数，假设我现在有 N 个处理器，那么我可以让这 N 个工作在这 N 个处理器上同时运行。

是否有可能从脚本级别到 qsub 这类“并行”工作？或者它甚至可以在 C++ 级别上完成？还是有更好的想法？

我问是因为我写的XX代码是基于一个大项目的，修改mpi部分代码对我来说并不容易。:(

或者我是否必须修改 XX 代码和项目以有一个新的算法来满足我的需要。

或任何其他建议，例如使用 python 或什么？可以快速实现我的目标。

非常感谢！

* * *

我想在我的问题中添加更多内容，以使其更清楚。

如果这些 N 的结果是相关的怎么办？不，我的意思是我怎么能这样做，

第一个周期，n 个处理器上的 N 个作业同时运行，并且在一定时间后，它们都结束并给出 N 个结果，**我需要根据这 N 个结果做一个串行作业，这个结果将作为初始条件下一个循环**，然后移动到下一个循环，

第二个循环，

第三个周期，

等等....

shell脚本能够做到这一点吗？还是我最好学习使用python？或者我仍然可以使用c++？？？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:40:06.953

bourne shell 可以满足您的要求：

```
#!/bin/sh
# Run XX 3 times in parallel
XX args&
XX other-args&
XX different-args&
wait  # Wait for all 3 to finish
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:17:33.847

您可以使用[GNU Parallel](http://www.gnu.org/software/parallel/)通过 shell 脚本并行执行作业。

Good old`xargs`接受一个`-P`参数，告诉它同时执行多少个作业。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:33:59.667

[GNU make](http://unixhelp.ed.ac.uk/CGI/man-cgi?make)有“-j”开关，允许你指定你想同时运行多少个作业。因此，如果您可以将整个内容转换为具有适当依赖关系的 gnu Makefile，您可能能够同时运行指定数量的作业。或者，您可以尝试其他一些构建系统/自动化工具。或者您可以在 shell 脚本或类似的东西中从头开始实现它。只要您可以访问某些线程库，纯 C++ 也是可能的。或者您可以使用 python 生成 Makefile（或其他构建脚本）。有很多方法可以解决这个问题。

# c# - 位掩码的最后 5 位

> ID：10807472
> 
> 赞同：1
> 
> 时间：2012-05-29T22:14:11.870
> 
> 标签：c#

我有一个位掩码（存储为短）。出于各种目的，我想将除最后 5 位之外的所有位清零 - 我确信有一种简单的方法可以通过按位运算符来做到这一点，但它让我望而却步。

```
1010 01101 1011 0111 -> 0000 0000 0001 0111 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T22:16:30.987

使用类似的东西：

```
x & 0x1f 
```

在二进制中，您的示例将是：

```
 1010 1101 1011 0111
  & 0000 0000 0001 1111
  ---------------------
    0000 0000 0001 0111 
```

使用`&`运算符时，掩码中的 0 位导致结果中的 0 位。掩码中的 1 位将相应的位复制到结果中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:19:03.307

值 = 原始值 & 0x1F

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T22:17:37.760

像这样的东西：

```
your_variable_name & ((1 << 5) - 1) 
```

(1 << 5) - 1 会给你一个 11111，然后你和它与你的值。

# javascript - jQuery最接近（）或prevAll（）不起作用

> ID：10807474
> 
> 赞同：0
> 
> 时间：2012-05-29T22:14:36.167
> 
> 标签：javascript, jquery

当用户将鼠标悬停在与该类的链接上时，与该类`"thumb"` 最近的链接`"title"`应该`"media-link-hover"`应用该类。如何才能做到这一点？

我也试过`closest()`了，但似乎没有任何效果：

```
$('a.thumb').hover(function() {
    $(this)
        .prevAll('.block')
        .find('a.title')
        .addClass('media-link-hover');
}, function() {
    $(this)
        .prevAll('.block')
        .find('a.title')
        .removeClass('media-link-hover');
}); 
```

HTML：

```
<article class="block">
    <div class="inner-left">
        <a class="thumb" title="" href="">
            <img width="198" height="111" alt="" src="" />
            <span class="media-overlay">video</span>
        </a>
    </div>
    <div class="inner-right">
        <a class="title" title="" href="">Hello</a>
        <div class="description">
            <p>Hi there</p>
            <a class="teaser" href="">Hola</a>
        </div>
        <div class="media-stats">
            <span class="finder">Found by <strong>Me</strong> 1 month ago</span>
        </div>
    </div>
</article> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:22:00.983

适用于`closest('.block')`

[http://jsfiddle.net/yBwSN/](http://jsfiddle.net/yBwSN/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:17:41.097

尝试使用`parents()`，您也可以使用`toggleClass()`.
**演示** [http://jsfiddle.net/elclanrs/Ce8fu/](http://jsfiddle.net/elclanrs/Ce8fu/)

```
$('a.thumb').hover(function() {
    $(this)
        .parents('.block')
        .find('a.title')
        .toggleClass('media-link-hover');
}); 
```

# android - 如何在 Android 的 Image View 或 Button 中设置和存储图像？

> ID：10807475
> 
> 赞同：0
> 
> 时间：2012-05-29T22:14:42.040
> 
> 标签：android, sql, image, store

我已经构建了一个允许用户单击图像按钮的 android 应用程序。单击后，用户可以选择打开图库或相机。

我希望图像（从图库中选择或用相机拍摄）显示在图像按钮中。此外，我希望将图像或其路径存储到 sql 数据库中，以便在再次打开应用程序时，用户会看到他之前设置的图像。

谁能给我一个这样做的代码示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-19T07:09:48.077

单击按钮并在 imageview 中设置存储图像。

> `公共类 MainActivity 扩展 Activity {

```
private static final int CAMERA_PIC_REQUEST = 22;

Uri cameraUri;

Button BtnSelectImage;
private ImageView ImgPhoto;
private String Camerapath ;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ImgPhoto = (ImageView) findViewById(R.id.imageView1);

    BtnSelectImage = (Button) findViewById(R.id.button1);
    BtnSelectImage.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            // TODO Auto-generated method stub
            try {
                   Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
                   startActivityForResult(cameraIntent, CAMERA_PIC_REQUEST);
            } catch (Exception e) {
                Toast.makeText(getApplicationContext(), "Couldn't load photo", Toast.LENGTH_LONG).show();
            }
        }
    });

}

@Override
public void onActivityResult(final int requestCode, int resultCode, Intent data) {
    try {
        switch (requestCode) {
       case CAMERA_PIC_REQUEST:
            if (resultCode == RESULT_OK) {
                try {
                      Bitmap photo = (Bitmap) data.getExtras().get("data"); 

                      ImgPhoto.setImageBitmap(photo);    

                } catch (Exception e) {
                    Toast.makeText(this, "Couldn't load photo", Toast.LENGTH_LONG).show();
                }
            }
            break;
          default:
            break;
        }
    } catch (Exception e) {
    }
} 
```

}`

设置此清单。

> `<uses-permission android:name="android.permission.CAMERA" /> <uses-feature android:name="android.hardware.camera" android:required="false"></uses-feature>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:43:42.140

您的问题没有简短的答案，通过同时发布所有内容会减少您的学习。无论如何，有很多关于如何做到这一点的教程。

我猜你已经完成了图库和相机代码。否则，您可以在下面的链接中找到它。

图库：[以编程方式从 Android 的内置图库应用程序中获取/选择图像](https://stackoverflow.com/questions/2169649/open-an-image-in-androids-built-in-gallery-app-programmatically)

相机：[从相机捕获图像并在活动中显示](https://stackoverflow.com/questions/5991319/capture-image-from-camera-and-display-in-activity)

当您从捕获或选择的图片中获取 Uri 时，您可以从中创建位图：

```
public Bitmap getBitmapFromUri(Uri uri)
{
    return MediaStore.Images.Media.getBitmap(this.getContentResolver(), uri);
} 
```

然后，您可以使用以下方法将位图设置为 imagebutton：

```
((ImageButton) findViewById(R.id.yourImageButton)).setImageBitmap(bitmap); 
```

我粘贴的其中一个链接向您展示了如何获取图像的路径。您可以将此路径保存在数据库中，也可以使用[SharedPreferences](http://developer.android.com/guide/topics/data/data-storage.html)保存。您可以在同一个链接中了解如何使用它。关于数据库，您知道如何从我的答案中获取图像路径。在 google 上搜索数据库教程。但我认为 SharedPreferences 就足够了，具体取决于您的应用程序的规模。

祝你好运！

# c# - asp.net 2.0 - 4.0 中的双重形式身份验证

> ID：10807479
> 
> 赞同：0
> 
> 时间：2012-05-29T22:14:50.497
> 
> 标签：c#, asp.net-mvc, forms-authentication, formsauthenticationticket

**背景**

我在同一个域下有两个网站。一个网站只封装了登录/账户管理功能，另一个网站是真正的网站。

*   **LoginWeb** - 只有登录页面/css/images/javascript 文件夹允许匿名访问
*   **AdminWebsite** - 通过表单身份验证完全锁定。即甚至 javascript/images/css 文件夹都没有`<authorization><allow users=*>`

**我**
想要达到的目标这是我想要达到的工作流程，并且已经完成了 99% 的工作：

1.  **如果用户点击AdminWebsite**上的任何页面，他将通过 FormsAuthentication发送回**LoginWeb**
2.  用户在登录页面中提供凭据，并且**LoginWeb**网站发出表单身份验证票。用户仍未登录到**AdminWebSite**。（这样用户可以去更改密码页面等做账户管理功能）
3.  **用户在LoginWeb**中再执行两个步骤，现在可以为**AdminWebsite**发出 FormsAuth 票证并重定向到它。

**99% 已经正常工作**
这是 LoginWeb 中的代码，它试图为 AdminWeb 发出 FormsAuth 票证，但它不工作。即 AdminWeb 仍在将我重定向回登录。我确定我缺少一些非常微不足道的东西，但我无法弄清楚它到底是什么？？？？？？？？？

```
public void SetAuthenticationTicket(string username)
{
    MachineKeySection sec=(MachineKeySection)WebConfigurationManager.OpenWebConfiguration("").SectionGroups["system.web"].Sections["machineKey"]; 
    FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(1,
        username,
        DateTime.Now,
        DateTime.Now.AddMinutes(30),
        false, //true or false
        sec.DecryptionKey, //Custom data like your webkey can go here
        FormsAuthentication.FormsCookiePath);

    var encryptedTicket = FormsAuthentication.Encrypt(ticket);
    var cookie = new HttpCookie("ADMINWEB", encryptedTicket)
    {
        Path = FormsAuthentication.FormsCookiePath,
        Domain = "xxx.com"
    };
    Response.AppendCookie(cookie);
} 
```

* * *

这些是我的表单身份验证的 web.config 部分：
**LoginWeb**

```
 <machineKey validationKey="XXXXXX" decryptionKey="XXX" validation="SHA1"/>
  <authentication mode="Forms">
    <forms name="LoginWeb"
            domain="xxx.com"
            loginUrl="~/account/Logon"
            timeout="1440"
            cookieless="UseCookies"
            slidingExpiration="false"
            protection="All"
            path="/"/>
  </authentication> 
```

**管理网站**

```
 <machineKey validationKey="XXXXXX" decryptionKey="XXX" validation="SHA1"/>
  <authentication mode="Forms">
    <forms name="ADMINWEB"
            domain="xxx.com"
            loginUrl="http://loginweb/account/Logon"
            timeout="1440"
            cookieless="UseCookies"
            slidingExpiration="false"
            protection="All"
            path="/"/>
</authentication>
<authorization>
    <deny users="?"/>
</authorization> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:07:10.277

这个站点，[Forms Authentication Across Applications](http://msdn.microsoft.com/en-us/library/eb0zx8fc.aspx)，暗示表单属性上的名称应该相同。

# ios - 为 iOS 应用程序存根/模拟 Web 服务

> ID：10807480
> 
> 赞同：33
> 
> 时间：2012-05-29T22:14:52.440
> 
> 标签：ios, web-services, testing, mocking, continuous-integration

我正在开发一个 iOS 应用程序，其主要目的是与一组远程 Web 服务进行通信。对于集成测试，我希望能够针对某种具有可预测结果的虚假 Web 服务运行我的应用程序。

到目前为止，我已经看到了两个建议：

1.  创建一个为客户端提供静态结果的网络服务器（例如[这里](http://darioalessandro.wordpress.com/2012/01/22/mocking-http-ws-using-apache-codeigniter-mac-os-x/)）。
2.  实现不同的 web 服务通信代码，基于编译时间标志将调用 web 服务或将从本地文件（[示例](http://www.touchbee.com/2011/08/apps-and-mock-web-services/)和[另一个](https://stackoverflow.com/questions/3492419/mockup-webservice-for-iphone)文件）加载响应的代码。

我很好奇社区对每种方法的看法，以及是否有任何工具可以支持这种工作流程。

**更新**：让我提供一个具体的例子。我有一个需要用户名和密码的登录表单。我想检查两个条件：

1.  *wronguser@blahblah.com*登录被拒绝和
2.  *rightuser@blahblah.com*登录成功。

所以我需要一些代码来检查*用户名*参数并向我抛出适当的响应。希望这就是我在“假网络服务”中需要的所有逻辑。我如何干净地管理这个？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-28T03:16:07.617

我建议使用[Nocilla](https://github.com/luisobo/Nocilla)。Nocilla 是一个使用简单 DSL 对 HTTP 请求进行存根的库。

假设您想从 google.com 返回 404。你所要做的就是：

```
stubRequest(@"GET", "http://www.google.com").andReturn(404); // Yes, it's ObjC 
```

之后，任何到 google.com 的 HTTP 都将返回 404。

一个更完整的示例，您希望将 POST 与特定正文和标题匹配并返回预设响应：

```
stubRequest(@"POST", @"https://api.example.com/dogs.json").
withHeaders(@{@"Accept": @"application/json", @"X-CUSTOM-HEADER": @"abcf2fbc6abgf"}).
withBody(@"{\"name\":\"foo\"}").
andReturn(201).
withHeaders(@{@"Content-Type": @"application/json"}).
withBody(@"{\"ok\":true}"); 
```

您可以匹配任何请求并伪造任何响应。查看自述文件以获取更多详细信息。

与其他解决方案相比，使用 Nocilla 的好处是：

*   它很快。没有可运行的 HTTP 服务器。您的测试将运行得非常快。
*   无需管理疯狂的依赖项。最重要的是，您可以使用 CocoaPods。
*   它经过了很好的测试。
*   伟大的 DSL 将使您的代码非常易于理解和维护。

主要限制是它仅适用于构建在 NSURLConnection 之上的 HTTP 框架，如 AFNetworking、MKNetworkKit 或普通 NSURLConnection。

希望这可以帮助。如果您需要其他任何东西，我会在这里为您提供帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-04T21:08:20.503

我假设您使用的是 Objective-C。对于 Objective-C ， [OCMock](http://ocmock.org/)广泛用于模拟/单元测试（您的第二个选项）。

一年多前我最后一次使用 OCMock，但据我所知，它是一个成熟的模拟框架，可以完成下面描述的所有事情。

关于 mock 的一件重要事情是，您可以尽可能多地使用对象的实际功能。您可以创建一个“空”模拟（其中所有方法都是您的对象，但不会执行任何操作）并仅覆盖您在测试中需要的方法。这通常在测试依赖于模拟的其他对象时完成。

或者您可以创建一个模拟您的真实对象的行为，并删除一些您不想在该级别测试的方法（例如 - 实际访问数据库的方法，需要网络连接等）。这通常在您测试模拟对象本身时完成。

重要的是要了解您不会一劳永逸地创建模拟。每个测试都可以根据正在测试的内容重新为相同的对象创建模拟。

关于模拟的另一个重要的事情是，您可以“记录”场景（调用序列）和您对它们的“期望”（应该调用幕后的哪些方法，使用哪些参数以及以何种顺序），然​​后“重播”场景 - 如果没有达到预期，测试将失败。这是经典 TDD 和 mockist TDD 之间的主要区别。它有其优点和缺点（参见 Martin Fowler 的文章）。

现在让我们考虑您的具体示例（我将使用看起来更像 C++ 或 Java 而不是 Objective C 的伪语法）：

假设您有一个`LoginForm`表示输入的登录信息的类对象。它有（除其他外）方法`setName(String)`、、、`setPassword(String)`和。`bool authenticateUser()``Authenticator* getAuthenticator()`

您还有一个类对象，`Authenticator`它具有（除其他外）方法`bool isRegistered(String user)`、、`bool authenticate(String user, String password)`和`bool isAuthenticated(String user)`。

以下是测试一些简单场景的方法：

除了上面提到的四个之外，创建`MockLoginForm`所有方法都为空的模拟。前三种方法将使用实际`LoginForm`实现；`getAuthenticator()`将被打掉返回`MockAuthenticator`。

创建`MockAuthenticator`将使用一些假数据库（例如内部数据结构或文件）来实现其三个方法的模拟。数据库将只包含一个元组：`('rightuser','rightpassword')`.

### 测试用户未注册

**回放场景：**

```
MockLoginForm.setName('wronuser');
MockLoginForm.setPassword('foo');
MockLoginForm.authenticate(); 
```

**期望：**

```
getAuthenticator() is called
MockAuthenticator.isRegistered('wrognuser') is called and returns 'false' 
```

### 测试错误密码

**回放场景：**

```
MockLoginForm.setName('rightuser');
MockLoginForm.setPassword('foo');
MockLoginForm.authenticate(); 
```

**期望：**

```
getAuthenticator() is called
MockAuthenticator.isRegistered('rightuser') is called and returns 'true'
MockAuthenticator.authenticate('rightuser','foo') is called and returns 'false' 
```

### 测试登录确定

**回放场景：**

```
MockLoginForm.setName('rightuser');
MockLoginForm.setPassword('rightpassword');
MockLoginForm.authenticate();
result = MockAuthenticator.isAuthenticated('rightuser') 
```

**期望：**

```
getAuthenticator() is called
MockAuthenticator.isRegistered('rightuser') is called and returns 'true'
MockAuthenticator.authenticate('rightuser','rightpassword') is called and returns 'true'
result is 'true' 
```

* * *

我希望这有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-11T12:06:36.307

您可以使用 NSURLProtocol 子类非常有效地制作模拟 Web 服务：

标题：

```
@interface MyMockWebServiceURLProtocol : NSURLProtocol
@end 
```

执行：

```
@implementation MyMockWebServiceURLProtocol

+ (BOOL)canInitWithRequest:(NSURLRequest *)request
{
    return [[[request URL] scheme] isEqualToString:@"mymock"];
}

+ (NSURLRequest *)canonicalRequestForRequest:(NSURLRequest *)request
{
    return request;
}

+ (BOOL)requestIsCacheEquivalent:(NSURLRequest *)a toRequest:(NSURLRequest *)b
{
    return [[a URL] isEqual:[b URL]];
}

- (void)startLoading
{
    NSURLRequest *request = [self request];
    id <NSURLProtocolClient> client = [self client];
    NSURL *url = request.URL;
    NSString *host = url.host;
    NSString *path = url.path;
    NSString *mockResultPath = nil;
    /* set mockResultPath here … */
    NSString *fileURL = [[NSBundle mainBundle] URLForResource:mockResultPath withExtension:nil];
    [client URLProtocol:self
 wasRedirectedToRequest:[NSURLRequest requestWithURL:fileURL]
       redirectResponse:[[NSURLResponse alloc] initWithURL:url
                                                  MIMEType:@"application/json"
                                     expectedContentLength:0
                                          textEncodingName:nil]];
    [client URLProtocolDidFinishLoading:self];
}

- (void)stopLoading
{
}

@end 
```

有趣的例程是 -startLoading，您应该在其中处理请求并在将客户端重定向到该文件 URL 之前，在应用程序包中找到与响应对应的静态文件。

你安装协议

```
[NSURLProtocol registerClass:[MyMockWebServiceURLProtocol class]]; 
```

并使用 URL 引用它，例如

```
mymock://mockhost/mockpath?mockquery 
```

这比在远程机器上或在应用程序本地实现真正的 Web 服务要简单得多；权衡是模拟 HTTP 响应标头要困难得多。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-22T18:24:36.540

[OHTTPStubs](https://github.com/AliSoftware/OHHTTPStubs)是一个非常棒的框架，可以做你想做的事，它获得了很大的吸引力。从他们的 github 自述文件中：

OHTTPStubs 是一个库，旨在非常轻松地存根您的网络请求。它可以帮助您：

*   使用虚假网络数据（从文件中存根）测试您的应用程序并模拟慢速网络，以检查您的应用程序在不良网络条件下的行为
*   编写使用来自您的设备的虚假网络数据的单元测试。

它适用于`NSURLConnection`新的 iOS7/OSX.9 `NSURLSession`（`AFNetworking`1.x 和 2.x）或任何使用 Cocoa 的 URL 加载系统的网络框架。

OHHTTPStubs 头文件在头文件中使用类似 Appledoc / Headerdoc 的注释进行了完整记录。[您还可以在此处阅读在线文档](http://cocoadocs.org/docsets/OHHTTPStubs)。

这是一个例子：

```
[OHHTTPStubs stubRequestsPassingTest:^BOOL(NSURLRequest *request) {
    return [request.URL.host isEqualToString:@"mywebservice.com"];
} withStubResponse:^OHHTTPStubsResponse*(NSURLRequest *request) {
    // Stub it with our "wsresponse.json" stub file
    NSString* fixture = OHPathForFileInBundle(@"wsresponse.json",nil);
    return [OHHTTPStubsResponse responseWithFileAtPath:fixture
              statusCode:200 headers:@{@"Content-Type":@"text/json"}];
}]; 
```

[您可以在 wiki 页面上](https://github.com/AliSoftware/OHHTTPStubs/wiki/Usage-Examples)找到其他使用示例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-08T05:07:05.343

至于选项 1，我过去曾使用 CocoaHTTPServer 完成此操作，并将服务器直接嵌入到 OCUnit 测试中：

[https://github.com/robbiehanson/CocoaHTTPServer](https://github.com/robbiehanson/CocoaHTTPServer)

我在这里提出了在单元测试中使用它的代码： [https ://github.com/quellish/UnitTestHTTPServer](https://github.com/quellish/UnitTestHTTPServer)

毕竟，HTTP 在设计上只是请求/响应。

模拟一个 Web 服务，无论是通过创建一个模拟 HTTP 服务器还是在代码中创建一个模拟 Web 服务，都将是大致相同的工作量。如果您有 X 代码路径要测试，那么您的模拟中至少有 X 代码路径要处理。

对于选项 2，要模拟 Web 服务，您不会与 Web 服务通信，而是使用具有已知响应的模拟对象。 `[MyCoolWebService performLogin:username withPassword:password]`

在你的测试中会变成

`[MyMockWebService performLogin:username withPassword:password]` 关键是 MyCoolWebService 和 MyMockWebService 实现了相同的合约（在 Objective-c 中，这将是一个协议）。OCMock 有大量文档可以帮助您入门。

但是，对于集成测试，您*应该*针对真实的 Web 服务进行测试，例如 QA/staging 环境。您实际描述的内容听起来更像是功能测试而不是集成测试。

# java - 从 Spring 的 applicationContext xml 传递 hibernate.connection.datasource

> ID：10807481
> 
> 赞同：0
> 
> 时间：2012-05-29T22:14:53.263
> 
> 标签：java, spring, hibernate, spring-jdbc

早些时候，我在应用程序服务器本身中配置了数据源，并将其传递给应用程序级别的 hbr.xml 文件

```
<property name="hibernate.connection.datasource">java:comp/env/jdbc/myDataSource</property> 
```

现在我已将 applicationContext.xml 中的数据源配置为

```
<bean id="mydatasource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource">
            <property name="driverClassName" value="com.microsoft.sqlserver.jdbc.SQLServerDriver" />
            <property name="url"
                value="jdbc:sqlserver://localhost:1433;databaseName=mydatasource;maxPoolSize=100" />
            <property name="username" value="sa" />
            <property name="password" value="${database.password}"/>

    </bean> 
```

如何将此传递给 hbr.xml 文件？基于下面给出的我的另一个问题是我的会话工厂应该是什么类？应该是`org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean` OR

```
org.springframework.orm.hibernate3.LocalSessionFactoryBean 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:47:09.367

将数据源与休眠映射一起注入您的 DAO：

```
<bean id="mydatasource" ...>
  ...
</bean>
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
  <property name="dataSource" ref="mydatasource" />
  <property name="mappingResources">
    <list>
      <value>path/to/your/mappings.hbm.xml</value>
    </list>
  </property>
  <property name="hibernateProperties">
    <props><!-- see http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/session-configuration.html -->
      <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
      ....
    </props>
  </property>
  ...
</bean> 
```

使用注解，您可以通过注入的 bean 访问您的数据源

```
@Resource
private SessionFactory sessionFactory;
...
Session session = this.sessionFactory.getCurrentSession(); 
```

# .net - Infopath 2010 将焦点设置在 .NET 代码中的某个字段上？

> ID：10807484
> 
> 赞同：0
> 
> 时间：2012-05-29T22:15:10.567
> 
> 标签：.net, infopath, infopath2010

我正在构建一个带有代码隐藏的桌面（厚）Infopath 2010 表单，需要将表单焦点设置在某些字段上，以便它们位于相关字段上以便于输入。有没有办法在.NET中做到这一点？副手我似乎找不到办法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T12:41:57.460

使用 View 类的 SelectText 方法

脚本链接 [http://msdn.microsoft.com/en-us/library/bb251012(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/bb251012(v=office.12).aspx)

托管代码链接 [http://msdn.microsoft.com/en-us/library/microsoft.office.infopath.view.selecttext.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.infopath.view.selecttext.aspx)

# php - 将带有拉丁字符的php变量插入mysql db

> ID：10807489
> 
> 赞同：-1
> 
> 时间：2012-05-29T22:15:42.470
> 
> 标签：php, mysql, pdo, latin

我很确定，这是一个常见问题，但我正在寻找最佳实践解决方案。

我有一个遗留数据库，为此我编写了一个脚本来迁移数据。

在我的脚本中，我有以下内容：

```
$select = $dbh->query("SELECT CollectionID, CollectionCode, Name FROM $db_local.collection");
  while ($collection_row = $select1->fetch (PDO::FETCH_ASSOC)) {
    $collection_id = $collection_row['CollectionID'];
    $collection_code = !empty($collection_row['CollectionCode']) ? "'{$collection_row['CollectionCode']}'" : "NULL";
    $collection_name = !empty($collection_row['Name']) ? "'{$collection_row['Name']}'" : "NULL";

    $dbh->exec("INSERT INTO $db_remote.cdrs_collectiononline (
        collection_id, 
        collection_code, 
        collection_name
        ) VALUES (
        $collection_id, 
        $collection_code, 
        $collection_name
        )");
} 
```

这一切都很好，直到我遇到这一行：

```
| CollectionID | CollectionCode | Name                                |
+--------------+----------------+-------------------------------------+
|         1032 | MHNG           | Muséum d'Histoire Naturelle, Genève | 
```

如果我直接在 mysql 中执行此操作（注意双引号）：

```
INSERT INTO cdrs_collectiononline (collection_id, collection_code, collection_name) VALUES ('1032', 'MHNG', "Muséum d'Histoire Naturelle, Genève") 
```

有用。使用 mysql pdo 处理这些拉丁字符的可能性的最佳方法是什么？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:21:46.177

尝试 ：

```
$collection_name = addslashes(mysql_escape_string($collection_name)); 
```

或者 ：

```
$dbh->exec("INSERT INTO $db_remote.cdrs_collectiononline (
        collection_id, 
        collection_code, 
        collection_name
        ) VALUES (
        '".$collection_id."', 
        '".$collection_code."', 
        '".$collection_name."'
        )"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-04T14:59:23.267

有点晚了，但它可以帮助别人！

使用 pdo prepare 和 bindParam 会更好：http: [//fr2.php.net/manual/fr/pdostatement.bindparam.php](http://fr2.php.net/manual/fr/pdostatement.bindparam.php)

它会根据您选择的类型转义字符。

# c# - 良好的 UDP 中继服务器设计

> ID：10807490
> 
> 赞同：2
> 
> 时间：2012-05-29T22:15:42.627
> 
> 标签：c#, sockets, udp, rtp

我正在创建一个 UDP 服务器，它需要从各种客户端接收 UDP 数据包，然后将它们转发给其他客户端。我正在使用 C#，所以每个 UDP 套接字对我来说都是一个 UdpClient。我想我想要 2 个 UdpClient 对象，一个用于接收，一个用于发送。接收套接字将绑定到一个已知端口，而发送者根本不会被绑定。

服务器将获取每个数据包，在数据包数据中查找用户名，然后根据服务器维护的路由列表，将数据包转发给 1 个或多个其他客户端。

我开始监听 UdpClient：

```
 UdpClient udpListener = new UdpClient(new IPEndPoint(ListenerIP, UdpListenerPort));
   udpListener.BeginReceive(new AsyncCallback(OnUDPRead), udpListener); 
```

我的回调看起来像：

```
 void OnUDPRead(IAsyncResult ar)
    {
        UdpClient udpListener = (UdpClient)ar.AsyncState;

        try
        {
            IPEndPoint remoteEndPoint = null;
            byte[] packet = udpListener.EndReceive(ar, ref remoteEndPoint);

            // Get connection based on data in packet

            // Get connections routing table (from memory)

            // ***Send to each client in routing table***
        }
        catch (Exception ex)
        {
        }

        udpListener.BeginReceive(new AsyncCallback(OnUDPRead), udpListener);
    } 
```

服务器将需要每秒处理 100 个数据包（这是用于 VOIP）。我不确定的主要部分是在上面的“发送给每个客户”部分要做什么。我应该使用`UdpClient.Send`or`UdpClient.BeginSend`吗？由于这是针对实时协议的，因此为任何给定的客户端设置多个挂起/缓冲的发送是没有意义的。

由于我在任何给定时间只发布了一个 BeginReceive()，我假设我的 OnUDPRead 函数在已经执行时永远不会被调用。除非 UdpClient 在这方面的工作方式与 TcpClient 不同？由于我没有给它一个缓冲区（我没有给它任何缓冲区），我想它可以在只发布一个 BeginReceive 的情况下多次触发 OnUDPRead？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:49:56.460

我看不出有什么理由不能直接使用*一个*套接字。在我看来，异步 I/O 在这种情况下并没有提供任何惊人的好处。只需使用非阻塞模式。收到一个数据包，发送它。如果 send() 导致 EAGAIN 或 EWOULDBLOCK 或任何 C# 表现形式，只需删除它。

在您的计划中，发送套接字将在您第一次调用 send() 时自动绑定。客户端将回复该端口。所以它必须是你正在阅读的端口。而你已经拥有其中之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T23:46:53.527

这在很大程度上取决于规模——即您想要中继多少并发 RTP 流。我已经开发了这个解决方案，作为我们 SIP 交换机的媒体网关的一部分。尽管最初有保留，但我使用 C# 非常有效地工作（单个服务器上 1000 个并发流，每秒 50K 数据报，使用 20ms PTime）。

通过反复试验，我确定了以下内容：

1) 使用 Socket.ReceiveFromAsync 比使用同步方法要好得多，因为您不需要为每个流使用单独的线程。收到数据包后，它们会通过线程池进行调度。

2) 创建/处理 SocketAsyncEventArgs 结构需要时间 - 最好在启动时分配结构池并从池中“借用”它们。

3) 对于处理期间所需的任何其他对象（例如，RTPPacket 类），类似。以如此高的速率动态分配这些会在任何类型的实际负载下很快导致 GC 问题。如果您避免所有动态分配，而是使用您自己管理的对象池，那么这个问题就会消失。

4) 如果您需要做任何时钟来协调输入和输出流、转码、混合或文件播放，请不要尝试使用标准的 .NET 计时器。我从 winmm.dll 包装了 Win32 多媒体计时器——这些计时器要精确得多。

我最终得到了一个架构，其中组件可以公开 IRTPSource 和 IRTPSink 接口，然后可以将它们连接起来以创建所需的图形。我创建了 RTP 输入/输出组件、混音器、播放器、录音机、（简单）转码器、播放缓冲区等 - 然后使用这两个接口将它们连接起来。然后使用 MM 计时器通过图形对 RTP 数据包进行计时。

对于通常使用 C 或 C++ 处理的问题，C# 被证明是一个不错的选择。

麦克风

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T01:15:17.587

EJP 所说的。

大多数关于使用异步 IO 扩展套接字服务器的文献都是在考虑 TCP 场景的情况下编写的。去年我对如何扩展 UDP 套接字服务器进行了大量研究，发现 IOCP/epoll 并不像 TCP 那样适合 UDP。[在这里](https://stackoverflow.com/a/3962681/104458)看到这个答案。

因此，仅使用多个线程来扩展 UDP 套接字服务器实际上比尝试执行任何类型的异步 I/O 事情要简单。很多时候，一个单线程抽出 recvfrom/sendto 调用就足够了。

我建议服务器每个客户端有一个同步套接字。然后让几个线程在客户端套接字的不同子集上执行 Socket.Select 调用。我想您可以为所有客户端使用一个套接字，但是如果您尝试从多个线程处理该套接字上的音频数据包，则会遇到一些乱序问题。

还可以考虑使用 UdpClient 的较低级别的套接字类。

但如果你真的想向外扩展——你可能想在 C/C++ 中完成核心工作。使用 C#，winsock 之上的更多抽象层意味着更多的缓冲区副本和更高的延迟。您可以通过一些技术使用 winsock 将数据包从一个套接字转发到另一个套接字，而不会产生缓冲区副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T20:50:00.090

一个好的设计不是重新发明轮子:)

已经有很多 RTP 媒体代理解决方案：Kamailio、FreeSWITCH、Asterisk 和其他一些开源项目。我在 FreeSWITCH 方面有丰富的经验，强烈推荐它作为 SIP 呼叫的媒体代理。

如果您的信令协议不是 SIP，那么还有一些针对其他协议的解决方案。

# java - 错误：无法为具有多个返回的查询创建 TypedQuery

> ID：10807496
> 
> 赞同：33
> 
> 时间：2012-05-29T22:16:17.950
> 
> 标签：java, sql, postgresql, jpa

我尝试使用 java 和 jpa 执行功能 searchBook。我有 2 个课程，即媒体和书籍。书扩展媒体。我将数据保存在不同的表中。我尝试从下面的查询中选择数据：

```
TypedQuery<Media> query = em.createQuery(
                "SELECT m.title, b.isbn, b.authors"
                        + " FROM Book b, Media m" + " WHERE b.isbn = :isbn"
                        + " OR lower(m.title) LIKE :title"
                        + " OR b.authors LIKE :authors", Media.class);
        query.setParameter("isbn", book.getisbn());
        query.setParameter("title", "%" + book.getTitle().toLowerCase()
                + "%");
        query.setParameter("authors", "%" + book.getAuthors() + "%");
        bookList = query.getResultList(); 
```

但我得到了错误：

> java.lang.IllegalArgumentException：无法为具有多个返回的查询创建 TypedQuery

这是我第一次使用 JPA。我找不到错误。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-05-30T08:14:47.583

作为一种解决方法，要获取由其他实体属性组成的实体，您可以在查询中创建它，并为其提供构造函数。

**询问 ：**

```
TypedQuery<Media> query = em.createQuery("SELECT NEW package_name.Media(m.title, b.isbn, b.authors)"
+ " FROM Book b, Media m" 
+ " WHERE b.isbn = :isbn"                         
+ " OR lower(m.title) LIKE :title"                         
+ " OR b.authors LIKE :authors", Media.class); 
```

**实体 ：**

```
public Media(String title, int isbn, String author){

    //-- Setting appropriate values
} 
```

我提供了示例，相应地更改构造函数的数据类型。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-05-30T07:21:41.033

在不详细说明如何`Media`以及`Book`应该建模的情况下，我至少会解释为什么会出现此异常。

你正在做的：

```
em.createQuery(someJPQL, Media.class); 
```

这意味着：使用 创建一个查询`someJPQL`，该查询将返回`Media`实体的实例。

但你的`JPQL`是：

```
SELECT m.title, b.isbn, b.authors ... 
```

因此查询不会返回 Media 类型的实体。它从两个不同的实体返回三个字段。您的 JPA 引擎无法从这 3 列神奇地创建 Media 实例。如果查询看起来像这样，它将返回 Media 的实例：

```
select m from Media m ... 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-02-10T08:48:46.010

如果您仍想使用`TypedQuery`，您可以将结果类型更改为`Object[]`.

```
List<Object[]> results = entityManager
    .createQuery("SELECT m.title, b.isbn, b.authors ...", Object[].class)
    .getResultList(); 
```

`Object[]`中的每个`List`代表一行数据。它包含该行的选定值，这些值按照它们在查询中的选择顺序排列。元素 0 是标题，元素 1 是 ISBN，元素 2 是作者。如果您想以有意义的方式使用它们，您可能需要转换这些值。由于字段值来自两个不同的表，您可以将它们存储在某种容器对象中。

```
List<MediaContainer> mediaList = new ArrayList<>();

for (Object[] row : results) {
    MediaContainer container = new MediaContainer();
    container.setTitle((String) row[0]);
    container.setIsbn((int) row[1]);
    container.setAuthors((String) row[2]);

    mediaList.add(container);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-18T16:23:12.710

@WebUser 而不是做

```
List<EntityIDKey> companies = 
getEntityManager().createQuery(sql, EntityIDKey.class).getResultList(); 
```

试试这个 ：

```
List<EntityIDKey> companies =
(List<EntityIDKey>)getEntityManager().createQuery(sql).getResultList(); 
```

为我工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-28T16:29:25.107

如果您使用的是 < 4 的 Hibernate 版本，则可以遇到此错误。

我对 v3.5 也有同样的问题。最后我不得不使用简单的查询并手动转换每个参数

在此处查看其他评论：[https ://groups.google.com/forum/#!topic/axonframework/eUd1d4rotMY](https://groups.google.com/forum/#!topic/axonframework/eUd1d4rotMY)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-01T14:18:54.213

我...删除

> 媒体类

的

> 创建查询

因为您在此来源**“SELECT m.title, b.isbn, b.authors”中返回了更多****实体**

 **前任。：

```
TypedQuery<Media> query = em.createQuery(
"SELECT m.title, b.isbn, b.authors"
+ " FROM Book b, Media m" + " WHERE b.isbn = :isbn"
+ " OR lower(m.title) LIKE :title"
+ " OR b.authors LIKE :authors"); 
```**

# jquery - 为什么匿名 jQuery 回调不会触发？

> ID：10807508
> 
> 赞同：0
> 
> 时间：2012-05-29T22:17:51.940
> 
> 标签：jquery, callback, anonymous-function, jquery-events

根据文档，这应该有效：

```
$('#content').on( 'load', function(event){
    alert('ready')
}) 
```

但事实并非如此。[http://jsfiddle.net/SJKqt/](http://jsfiddle.net/SJKqt/)

这确实有效：

```
$('#content').on( 'load', alert('ready') ) 
```

但我根本无法运行匿名函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:27:43.043

以下元素支持 onload 事件：

```
<body>, <frame>, <frameset>, iframe, <img>, 
<input type="image">, <link>, <script>, <style> 
```

所以我猜你没有在其中一个上注册处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:28:12.590

从[jQuery 页面`.load()`](http://api.jquery.com/load-event/)：

> 与图像一起使用时加载事件的注意事项
> 
> 开发人员尝试使用 .load() 快捷方式解决的一个常见挑战是在图像（或图像集合）完全加载时执行一个函数。应该注意几个已知的警告。这些都是：
> 
> *   它不能始终如一地工作，也不能可靠地跨浏览器
> *   如果图像 src 设置为与以前相同的 src，它不会在 WebKit 中正确触发
> *   It doesn't correctly bubble up the DOM tree
> *   Can cease to fire for images that already live in the browser's cache
> 
> Note: The .live() and .delegate() methods cannot be used to detect the load event of an iframe. The load event does not correctly bubble up the parent document and the event.target isn't set by Firefox, IE9 or Chrome, which is required to do event delegation.

Your jsFiddle is running in an iframe, which may be one explanation for why your code isn't working there.

# asp.net - MembershipProvider 无法识别

> ID：10807510
> 
> 赞同：0
> 
> 时间：2012-05-29T22:18:07.497
> 
> 标签：asp.net, asp.net-mvc, membership-provider

我正在编写自己的会员提供程序（实际上只是扩展了内置的）并且**MembershipProvider**保持红色并出现无法解决的错误，即使我添加了**System.Web.Security**：

```
public sealed class MRCMembershipProvider : MembershipProvider
{
       //code here
} 
```

任何人都知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T05:53:01.443

确保您已添加对程序集的引用，该`System.Web.ApplicationServices.dll`程序集是定义此类的位置，如[文档](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)中所述：

> **命名空间**：System.Web.Security
> 
> **程序集**：System.Web.ApplicationServices（在 System.Web.ApplicationServices.dll 中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:34:27.063

它仅在 MVC 应用程序的命名空间存在时才有效。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Security;

namespace MvcApplication6
{
    public sealed class MRCMembershipProvider : MembershipProvider
    {
    }
} 
```

# javascript - 运行多个 ajax 函数实例 - 只有第二个实例更新

> ID：10807511
> 
> 赞同：1
> 
> 时间：2012-05-29T22:18:17.240
> 
> 标签：javascript, ajax, prototypejs

我很难调用同一个 Ajax.Request 函数的多个实例。（我正在使用原型框架）。这是功能：

```
function send_SMS(id)
{
    status_id = 'status_link_' + id;

    new Ajax.Request('sendSMS.php', 
    {
        method:'post',
        parameters: {link_id: id},
        onCreate: function(){
            $(status_id).update("sending...");
        }, 
        onSuccess: function(transport){
            if (transport.responseJSON.success) {
                $(status_id).update("sent");
            } else {
                $(status_id).update("unable to send");
            }
        },
        onFailure: function(){ 
            $(status_id).update("unable to send");
        }       
    });
} 
```

如果我用 2 个不同的 ID 号调用此函数两次，即：

```
send_SMS("1");
send_SMS("2"); 
```

onSuccess 函数仅更新第二个 ID。sendSMS.php 文件成功运行了两次（顾名思义，它发送一条短信，确实成功发送了 2 条短信），但似乎只调用了第二次 onSuccess 函数。

javascript是否混淆了2个实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:02:33.260

我认为这是因为 status_id 是一个全局变量，因此在调用其引用的回调中进入两个调用的上下文：

```
onSuccess: function(transport){
        if (transport.responseJSON.success) {
            $(status_id).update("sent");
        } else {
            $(status_id).update("unable to send");
        }
    } 
```

问题是，onSuccess 回调将在它被调用时**编译，并带有****当时**的上下文。在那一刻，status_id 将等于“status_link_2”，因为您的呼叫最有可能`send_SMS("2");`在第一个 sms_send 呼叫返回之前出现。

一个解决方案是：

*   在 ajax 调用中发送 id，并在响应中检索它以构建您的 status_id 变量，或者
*   使用同步模式，因此 sms1 返回在 sms2 调用之前返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T00:10:27.967

这是工作功能：

```
function send_SMS(id)
{
    new Ajax.Request('sendSMS.php', 
    {
        method:'post',
        parameters: {link_id: id},
        onCreate: function(){
            $('status_link_' + id).update("sending...");
        }, 
        onSuccess: function(transport){
            if (transport.responseJSON.success) {
                $('status_link_' + id).update("sent");
            } else {
                $('status_link_' + id).update("unable to send");
            }
        },
        onFailure: function(){ 
            $('status_link_' + id).update("unable to send");
        }       
    });
} 
```

# android - Android - 过滤列表视图

> ID：10807516
> 
> 赞同：0
> 
> 时间：2012-05-29T22:18:46.473
> 
> 标签：android, filter, android-arrayadapter

我想实现以下内容：

Listview 1 包含带有复选框的项目。如果一个或多个项目被选中，listview 2 应该只显示包含选中项目的项目。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:06:11.510

我有一个关于如何在每个列表视图元素中实现复选框的类似问题。这可能很棘手，因为适配器会在滚动时刷新每个复选框的状态。检查大卫斯科特的答案和我对它的正确使用的评论。之后还要查看乔伊的回答。

[带有许多复选框的 ListView 适配器](https://stackoverflow.com/questions/10298387/listview-adapter-with-many-checkboxes)

关于您的第二个列表视图，您将必须检查您的布尔数组检查了哪些行。然后从您的集合中获取这些索引处的所有元素并保存它们。你要么：

*   使用已检查的所有元素行（在某些容器类中）并将它们设置为您的列表视图适配器编号 1。然后使用 adapter.notifySetDataChanged() 并且这些将出现。

*   如果您想保持列表视图编号为 1，请使用第二个列表视图创建一个新活动，将所选对象传递给它并将它们用作元素。或者简单地在第二个下方放置一个列表视图，并带有选中的行。

不知道您对列表视图了解多少，但这是我关于该主题的 50 美分。

# upload - 上传网站上的 PHPmailer

> ID：10807518
> 
> 赞同：0
> 
> 时间：2012-05-29T22:19:04.040
> 
> 标签：upload, web, phpmailer

有人知道我如何让 phpmailer 在上传的网站上工作。

```
include("class.phpmailer.php");
include("class.smtp.php");

$mail             = new PHPMailer();

$body             = "You have been added to the University of Portsmouth project 
database. Your password is 
'".$_POST['Password']."' 
And your username is 
'".$_POST['Username']."'
please click the link below, login to the website, select account settings and change    
the password to become verified";

$mail->IsSMTP();
$mail->SMTPAuth   = true;                  // enable SMTP authentication
$mail->SMTPSecure = "tsl";                 // sets the prefix to the servier
$mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
$mail->Port       = 25;                   // set the SMTP port

$mail->Username   = "projectnateabiola@gmail.com";  // GMAIL username
$mail->Password   = "";            // GMAIL password

$mail->From       = "projectnateabiola@gmail.com";
$mail->FromName   = "Nathan Abiola";
$mail->Subject    = "You have been added to the project database, this email is important";
$mail->AltBody    = "Please click"; //Text Body
$mail->WordWrap   = 50; // set word wrap

$mail->MsgHTML($body);

$mail->AddReplyTo("projectnateabiola@gmail.com","Webmaster");

$mail->AddAddress($_POST['Email'],"First Last");

$mail->IsHTML(true); // send as HTML

if(!$mail->Send()) {
 echo "Mailer Error: " . $mail->ErrorInfo;
} 

}
 }
} 
```

该代码在离线时有效，但是一旦我上传它，当我提交它时会出现以下错误。我是否错过了一些你不能在线使用 phpmailer 的东西。是否有任何机构有任何潜在的替代方案。感谢您提供任何可能的帮助。

```
SMTP Error: Could not connect to SMTP host. Mailer Error: SMTP Error: Could not connect to SMTP host. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:37:16.860

我将它用于我的网站。它是网页上的一个表单，它调用 php 文件来发送电子邮件。我发现它有时在大学服务器上会出现问题，所以请记住这一点。

创建一个名为 mailto.php 的文件并将其粘贴（请注意，您需要输入正确的电子邮件地址）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Form Submitted!</title>
</head>
<body>

<?php
if (isset($_REQUEST['email']))
//if "email" is filled out, send email
{
//send email
$email = $_REQUEST['email'] ;
$subject = $_REQUEST['subject'] ;
$message = $_REQUEST['message'] ;
mail( "PUT YOUR EMAIL ADDRESS HERE", "Subject: $subject",
$message, "From: $email" );

echo "Your message has been sent successfully!";
}
else
//if "email" is not filled out, display the form
{
echo "<form method='post' action='mailform.php'>
Email: <input name='email' type='text' /><br />
Subject: <input name='subject' type='text' /><br />
Message:<br />
<textarea name='message' rows='15' cols='40'>
</textarea><br />
<input type='submit' />
</form>";
}
?>
</body>
</html> 
```

然后把它放在你的html文件的正文中

```
 <form name="formcheck" onsubmit="return formCheck(this);" action="mailto.php"     method="post">
     <br />
     &nbsp;&nbsp;E-mail:&nbsp;  <input type="text" name="email" id="email" size="42" />
     <br />
     <br />
     <br/>
     &nbsp;&nbsp;Subject: <input type="text" name="subject" id="subject" size="42" />
     <br />
     <br />
     <br />

     &nbsp;&nbsp;Message:

     <br />
     &nbsp;&nbsp;<textarea rows="5" cols="40" name="message" id="message"></textarea>

     <br />
     <br />
     &nbsp;&nbsp;<input type="submit" onClick="return checkmail(this.form.email)" value="Submit" /><input type="reset" />
     </form> 
```

希望这会有所帮助，如果有人对如何使它更好地提出建议，请告诉我:)

# java - Java 将整数输出到文件

> ID：10807523
> 
> 赞同：1
> 
> 时间：2012-05-29T22:19:42.760
> 
> 标签：java, file-io

我试图将一个整数数组输出到一个文件并遇到了障碍。代码正确执行，没有抛出错误，但不是给我一个包含数字 1-30 的文件，而是给我一个充满 [] [] [] [] [] 的文件，我已将问题隔离到包含的代码段。

```
try
       {
       BufferedWriter bw = new BufferedWriter(new FileWriter(filepath));
       int test=0;
       int count=0;
        while(count<temps.length)
        {
          test=temps[count];  
          bw.write(test);
          bw.newLine();
          bw.flush();
          count++;
        }
       }
       catch(IOException e)
       {
           System.out.println("IOException: "+e);
       } 
```

文件路径是指输出文件的位置。temps 是一个包含值 1-30 的数组。如果需要更多信息，我将很乐意提供。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:25:42.517

[BufferedWriter.write(int)](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedWriter.html#write%28int%29)写入 int 的字符值，而不是 int 值。所以输出 65 应该把字母`A`放到文件中，66 会打印 B...等。您需要将`String`值而不是 int 值写入流。

改用BufferedWriter.write [(java.lang.String)](http://docs.oracle.com/javase/6/docs/api/java/io/Writer.html#write%28java.lang.String%29)

```
bw.write(String.valueOf(test)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:29:38.940

我建议使用[`PrintStream`](http://docs.oracle.com/javase/6/docs/api/java/io/PrintStream.html)or[`PrintWriter`](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html)代替：

```
PrintStream ps = new PrintStream(filePath, true); // true for auto-flush
int test = 0;
int count = 0;
while(count < temps.length)
{
    test = temps[count];  
    ps.println(test);
    count++;
}
ps.close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T22:26:41.717

您遇到的问题是您正在使用该[`BufferedWriter.write(int)`](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedWriter.html#write%28int%29)方法。让您感到困惑的是，虽然方法签名表明它正在编写一个`int`，但它实际上期望该 int 表示一个编码字符。换句话说，写作`0`就是写作`NUL`，写作`65`会输出`'A'`。

来自[Writer 的](http://docs.oracle.com/javase/6/docs/api/java/io/Writer.html#write%28int%29)javadoc：

> ```
> public void write(int c) throws IOException 
> ```
> 
> 写入单个字符。要写入的字符包含在给定整数值的低 16 位中；16 个高位被忽略。

纠正问题的一种简单方法是在写入之前将数字转换为字符串。有很多方法可以实现这一点，包括：

```
int test = 42;
bw.write(test+""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:24:23.853

您可以将整数数组转换为字节数组并执行以下操作：

```
public void saveBytes(byte[] bytes) throws FileNotFoundException, IOException {
 try (BufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(new File(filepath))) {
   out.write(bytes);
 }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T22:25:18.910

您将数字作为整数写入文件，但您希望它是一个字符串。更改`bw.write(test);`为`bw.write(Integer.toString(test));`

# android - Android：2个列表视图之间的间隔

> ID：10807527
> 
> 赞同：2
> 
> 时间：2012-05-29T22:20:06.073
> 
> 标签：android, listview, padding

如何在两个列表视图之间添加 20px 空间：

```
 <ListView
        android:minWidth="25px"
        android:minHeight="25px"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@+id/listStations" />
 SPACER???
    <ListView
        android:minWidth="25px"
        android:minHeight="25px"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@+id/listSocial" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T05:47:14.907

对于第一个列表视图，您可以添加

```
 android:layout_marginBottom="20dp" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:21:30.110

在其中一个s 上设置`paddingTop`或设置`paddingBottom`就足够了。或者，您可以创建一个空视图（例如 a没有文本，或者如*@AljoshaBre*提到的只是 a ），并将其设置为.`20px``ListView``TextView`*`View``layout_height``20px`*

# android - ActionBarSherlock 微调器在 ActionBar 中不可选择 - 主题相关

> ID：10807528
> 
> 赞同：8
> 
> 时间：2012-05-29T22:20:10.567
> 
> 标签：android, android-layout, android-actionbar, actionbarsherlock, android-theme

在横向模式下使用我的应用程序时，我的应用程序的一些用户遇到了一个奇怪的问题。我正在使用 actionbarsherlock 并将导航模式设置为选项卡（使用 ActionBar.NAVIGATION_MODE_TABS）。一些用户在纵向启动应用程序然后旋转设备时发现操作栏显示微调器列表而不是选项卡（这显然是预期的行为）。问题是微调器不可选择。

```
 bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    bar.addTab(bar.newTab().setText("Deals").setTabListener(this),false);
    bar.addTab(bar.newTab().setText("Vouchers").setTabListener(this),false);
    bar.addTab(bar.newTab().setText("Freebies").setTabListener(this),false); 
```

**编辑** 刚刚发现它与我的自定义主题有关。将主题更改为默认的 Sherlock.Light 会使微调器可选择。自定义主题如下所示。

```
<!-- Variation on the Holo Light theme that styles the Action Bar -->
<style name="DealPadTheme" parent="Theme.Sherlock.Light.ForceOverflow">
    <item name="android:selectableItemBackground">@drawable/ad_selectable_background</item>
    <item name="actionBarItemBackground">@drawable/ad_selectable_background</item>
    <item name="android:actionBarTabStyle">@style/MyActionBarTabStyle</item>
    <item name="actionBarTabStyle">@style/MyActionBarTabStyle</item>
    <item name="android:actionBarStyle">@style/Widget.ActionBar</item>
    <item name="actionBarStyle">@style/Widget.ActionBar</item>
    <item name="android:dropDownListViewStyle">@style/MyDropDownListView</item>
    <item name="dropDownListViewStyle">@style/MyDropDownListView</item>
    <item name="android:actionDropDownStyle">@style/MySpinner</item>
    <item name="actionDropDownStyle">@style/MySpinner</item>
    <item name="android:activatedBackgroundIndicator">@drawable/selectable_list_item</item>
    <item name="activatedBackgroundIndicator">@drawable/selectable_list_item</item>
    <item name="android:listSelector">@style/MyListView</item>
</style>

<style name="MyListView" parent="@android:style/Widget.ListView">
    <item name="android:listSelector">@drawable/list_arrow_selected_holo</item>
</style>

<!-- style for the tabs -->
<style name="MyActionBarTabStyle">
    <item name="android:background">@drawable/actionbar_tab_bg</item>
    <item name="android:paddingLeft">16dp</item>
    <item name="android:paddingRight">16dp</item>
    <item name="android:gravity">center_horizontal</item>
</style>

<style name="Widget.ActionBar" parent="Widget.Sherlock.Light.ActionBar">
    <item name="android:displayOptions">showHome|useLogo|showCustom</item>
    <!-- removed as not all activites need it    <item name="android:customNavigationLayout">@layout/custom_action_bar</item> -->
    <item name="android:background">@drawable/ad_tab_unselected_holo</item>
    <item name="background">@drawable/ad_tab_unselected_holo</item>
    <item name="android:titleTextStyle">@style/Widget.ActionBar.Title</item>
    <item name="titleTextStyle">@style/Widget.ActionBar.Title</item>
</style>

<style name="Widget.ActionBar.Title" parent="Widget">
    <item name="android:textSize">12sp</item>
    <item name="android:textStyle">bold</item>
    <item name="android:textColor">?android:attr/textColorPrimary</item>
</style>

<!-- style the items within the overflow menu -->
<style name="MyDropDownListView" parent="Widget.Sherlock.Light.ListView.DropDown">
    <item name="android:listSelector">@drawable/ad_selectable_background</item>
</style>

<!-- style the items within the overflow menu -->
<style name="MySpinner">
    <item name="android:background">@drawable/spinner_background</item>
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T16:15:21.750

哇，原来是因为我在主题化 ActionDropDownStyle 时没有说明父级。

只有当我创建一个新项目时，我才发现它与主题有关。我认为这是与代码或错误处理方向更改有关的问题。

执行以下排序：

```
<!-- style the items within the overflow menu -->
<style name="MySpinner" parent="Widget.Sherlock.Light.Spinner.DropDown.ActionBar" >
    <item name="android:background">@drawable/spinner_background</item>
</style> 
```

现在唯一的问题是一些微调项目被切断并替换为......虽然我认为这是一个已知的错误。

# winapi - CryptEncrypt() 是线程安全的吗？

> ID：10807539
> 
> 赞同：0
> 
> 时间：2012-05-29T22:21:15.117
> 
> 标签：winapi, thread-safety, cryptoapi

微软[说](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379924.aspx)：

> 该`CryptEncrypt`函数不能保证是线程安全的，并且如果被多个调用者同时调用，可能会返回不正确的结果。

这是否意味着该函数修改了全局数据？
还是仅仅意味着您不能同时使用相同的哈希/键？

（换句话说，下面的评论是否正确？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:34:53.897

这意味着它的含义：函数*不能保证是线程安全的*。~~它可能具有内部静态（或全局）状态，但这是一个实现细节。~~

~~是否使用相同的哈希或密钥是无关紧要的。~~

* * *

评论后编辑：根据[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/Aa388149.aspx)，由于内部密钥状态，CryptoApi 密钥句柄不是线程安全的：

> 大多数算法和模式都要求数据以与加密相同的顺序进行解密。这在多线程环境中是一项艰巨的任务，因为使用临界区不会解决排序问题。如果您在 ECB 密码模式下使用分组密码（即 RC2、DES 或 3DES），则此问题不是一个因素，因为内部密钥状态不会改变。但是，ECB 不是默认密码模式。CBC 是默认密码模式。使用 CBC 密码模式，内部密钥状态会发生变化。

所以毕竟，如果它们不共享相同的密钥，那么认为您确实可以在多个线程上使用它们似乎是合理*的。*`CryptEncrypt`不过，这只是一个猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:28:40.140

我相信这意味着您不能同时分叉多个进程来使用它，因为该函数使用共享地址空间。它可以访问所有线程的内存，因此会给您带来意想不到的结果。如果您的应用程序正在这样做，这应该只是多线程的问题。

# objective-c - 分组 UIButtons 以限制“选定”状态

> ID：10807540
> 
> 赞同：0
> 
> 时间：2012-05-29T22:21:17.387
> 
> 标签：objective-c, ios, uibutton

我有一排 5 个按钮，其中一次应该“选择”一个按钮。我打电话

```
[button setSelected:YES] 
```

由相应的 IBAction 触发，将触摸按钮的状态设置为“选中”。

是否可以创建某种**按钮组**，其中只有该行的最新触摸按钮显示为选中状态，所有其他按钮切换回其“默认”状态？（有点像单选按钮）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:23:34.087

> 是否可以创建某种按钮组，其中只有该行的最新触摸按钮显示为选中状态，所有其他按钮切换回其“默认”状态？（有点像单选按钮）

那么单选按钮呢？一个名为[MNRadioGroup](http://cocoacontrols.com/platforms/ios/controls/mnmradiogroup)的不错的实现就是这样做的。

然而，iOS 还包括原生[UISegmentedControl](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UISegmentedControl_Class/Reference/UISegmentedControl.html)对象，它一次只允许选择一个部分。

# jquery - 时间戳 AJAX URL

> ID：10807541
> 
> 赞同：2
> 
> 时间：2012-05-29T22:21:18.210
> 
> 标签：jquery, ajax, jquery-bbq

下面是我用于 jQuery BBQ 的代码。

```
$(function(){

var cache = {
    '': $('.content')
};

$(window).bind( 'hashchange', function(e) {
    var url = $.param.fragment();

    $( '.contentarea' ).children( ':visible' ).hide();
    if ( cache[ url ] ) {
        cache[ url ].show();
    } else {
        $( '.content-loading' ).show();
        cache[ url ] = $( '<div class="pageURL"/>' )
        .appendTo( '.contentarea' )
        .load( url, function(){
            $( '.content-loading' ).hide();
        });
    }
    $('#wrapper').scrollTop(0);
})

$(window).trigger( 'hashchange' );

});

</script> 
```

我需要修改代码，以便 URL 带有时间戳。我尝试使用以下代码，但是当我这样做时整个页面停止工作：

```
var url = $.param.fragment()+str;
var date = new Date();
var timestamp = date.getTime();
url=url+'&time='+timestamp; 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:31:12.397

该字符`&`用于*第二个值对*。对于第一个实例，`?`这样使用：

```
url=url+'?time='+timestamp; 
```

此外，如果曾经`&`在 URL 中使用，您可能需要使用转义版本`&amp;`

# c# - mediaelement在锁定后继续播放

> ID：10807545
> 
> 赞同：0
> 
> 时间：2012-05-29T22:21:30.100
> 
> 标签：c#, windows-phone-7, mediaelement, lockscreen

我有一个带有 url-source 的媒体，它可以流式传输广播电台。一切正常，音乐按预期播放！当我按下关机按钮并且手机锁定时，流媒体停止。我该如何解决？即使我按下“标志”按钮，我也会看到我的主屏幕但音乐停止：/提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:35:38.830

您必须使用 BackgroundAudioPlayer 来完成此操作。

有关更多信息，请参阅此[msdn 文章](http://msdn.microsoft.com/en-us/library/hh202978%28v=vs.92%29.aspx)以及解释 BackgroundAudioPlayer 的一些问题的[帖子](https://stackoverflow.com/questions/9702935/audioplayeragent-timer-and-webservice/9710014#9710014)

从 msdn 链接中获取样本。我将 PlayTrack 方法更改为：

```
private void PlayTrack(BackgroundAudioPlayer player)
{
       var track = new AudioTrack(
                    new Uri("http://m1.onweb.gr/1055rock"),
                    "Online",
                    "Music",
                    string.Empty,
                    null,
                    string.Empty,
                    EnabledPlayerControls.Pause);
        if (player != null)
        {
            player.Track = track;
        }
} 
```

我得到下面提到的错误。你是如何尝试启动播放器的？

# network-programming - 如何将轮询与多播一起使用

> ID：10807547
> 
> 赞同：1
> 
> 时间：2012-05-29T22:21:51.953
> 
> 标签：network-programming, multicast

我过去曾使用过轮询，其中服务器具有多个连接的文件描述符，但是在想要监听各种多播组的情况下如何使用轮询？据我了解，这将需要多个 upd 套接字想要在加入一个组后调用 recvfrom 但从不连接这些套接字.. 无论如何都要轮询这些描述符，然后在事件触发时调用 recvfrom？网络上有什么简单的小例子吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:34:37.757

轮询是完全一样的——你等待你的几个套接字中的任何一个变得可读，找出哪个是可读的，然后调用`recv(2)`或诸如此类。与 TCP 的不同之处在于，UDP 套接字上的每次读取都会使一个数据报出队，所以这更容易一些。

您放入 poll set 的套接字通常设置为非阻塞，在这种情况下，您需要处理`EWOULDBLOCK`来自`recv(2)`.

还要记住 UDP 是不可靠的，所以如果你没有足够快地使用这些数据报，它们会填满套接字接收缓冲区并且内核开始丢弃它们。

# c++ - 从 C++ 代码停止外部程序

> ID：10807553
> 
> 赞同：1
> 
> 时间：2012-05-29T22:22:12.720
> 
> 标签：c++, boost, process, external, kill

> **可能重复：**
> [如何有效地杀死 C++ (Win32) 中的进程？](https://stackoverflow.com/questions/1916574/how-to-effectively-kill-a-process-in-c-win32)

我正在创建一个必须执行一项重要任务的程序 - 它可能（很少）与用户可能无意中启动的另一个程序（比如说 a.exe）发生资源冲突。
我想做的是在执行其余工作之前杀死 a.exe（如果它正在运行）。
有什么方法可以阻止另一个程序/进程从 c++（在 Windows 下运行）运行？
我希望在美丽的提升中可能会有一些东西......
谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:25:47.520

如果您确定图像名称是`a.exe`那么它非常简单：

```
system("taskkill /F /IM a.exe >nul 2>&1"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:25:10.110

假设您在 Windows 上工作。

您可以使用 .NET 方法。我会给你链接一个帖子。[https://stackoverflow.com/a/116098/1424790](https://stackoverflow.com/a/116098/1424790)

如果您需要，我可以将帖子翻译成 C++（但我需要一些时间）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T22:31:09.970

这取决于，如果您在谈论 Windows，那么您可以使用`taskkill`已经说明的方法，也可以使用 kernel32.dll 的`TerminateProcess`方法。

更多信息 - [http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714(v=vs.85).aspx)

~~如果你在 *nix 上，它就像`kill`使用`signal.h`.~~

~~有关这方面的更多信息 - [http://linux.die.net/man/2/kill](http://linux.die.net/man/2/kill)~~ *哎呀，只需正确阅读提到 Windows 的问题*

# android - Actionbar Sherlock：设置和隐藏标题栏

> ID：10807561
> 
> 赞同：10
> 
> 时间：2012-05-29T22:23:16.413
> 
> 标签：android, actionbarsherlock, android-actionbar

我是 ActionBarSherlock 的新手，遇到两个问题：

首先，我只是希望能够设置操作栏的标题，但是当我这样调用它时它不起作用：

```
final ActionBar actionBar = (ActionBar) findViewById(R.id.actionBar);
actionBar.setTitle("test title"); 
```

对应的 xml 对象如下所示：

```
<com.myapp.prototype.ActionBar
    android:id="@+id/actionBar2"
    android:layout_width="fill_parent"
    android:layout_height="45dip" 
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true" /> 
```

（这是仿照 github 示例：[https](https://github.com/johannilsson/android-actionbar/blob/master/actionbarexample/src/com/markupartist/android/actionbar/example/HomeActivity.java) ://github.com/johannilsson/android-actionbar/blob/master/actionbarexample/src/com/markupartist/android/actionbar/example/HomeActivity.java ）。在网络上的其他地方，我看到对 getSupportActionBar() 的引用，但我不清楚如何或在哪里调用它。

其次，在另一个地方，我只想能够完全隐藏 Activity 的标题栏。我试图通过调用来做到这一点：

```
 actionBar.setDisplayShowTitleEnabled(false);
    actionBar.setDisplayShowHomeEnabled(false); 
```

但我什至无法编译它。我得到的错误是：

```
"The method setDisplayShowTitleEnabled(boolean) is undefined for the type
 ActionBar." 
```

在这两种情况下，我猜都涉及到 Actionbar Sherlock 覆盖问题。任何建议如何使这项工作？

非常感谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-29T22:43:49.773

### 设置`ActionBar`标题

```
setTitle("Title") 
```

### 隐藏和显示`ActionBar`

```
getSupportActionBar().hide();
getSupportActionBar().show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:36:35.630

您似乎混淆了两种不同的 ActionBar 实现。ActionBarSherlock 是 Google 提供的兼容性库的扩展。ActionBarSherlock 使用的方法几乎与 Android 3.0+ 中的原生 ActionBar 相同[http://actionbarsherlock.com/](http://actionbarsherlock.com/)

提供的 Github 链接（以及您正在使用的代码）是操作栏[https://github.com/johannilsson/android-actionbar](https://github.com/johannilsson/android-actionbar)的自定义实现。

我建议您使用 ActionBar sherlock 并按照此处的使用指南[http://actionbarsherlock.com/usage.html](http://actionbarsherlock.com/usage.html)

这里还有一个 ActionBarSherlock 入门视频[http://www.youtube.com/watch?feature=player_embedded&v=4GJ6yY1lNNY](http://www.youtube.com/watch?feature=player_embedded&v=4GJ6yY1lNNY)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-27T14:39:03.750

您需要导入 com.actionbarsherlock.view.Window 以便它偷偷使用该方法的长版本。

# video-streaming - 在网页中嵌入 H.264 视频的实时 RTSP 流

> ID：10807567
> 
> 赞同：30
> 
> 时间：2012-05-29T22:24:03.823
> 
> 标签：video-streaming, h.264, rtsp, live-streaming, embedded-video

我有一台服务器通过 RTSP (rtsp://...) 通过网络提供实时 H.264 视频，我一直在尝试找到一种方法在浏览器中向用户显示流（至少在 Windows 和OS X - Linux 是一个奖励）。我目前嵌入了 VLC 播放器，并且可以在 IE9 和 Mozilla Firefox 12.0 中运行，但如果用户最多只需要为他们的浏览器或类似的东西安装插件（而不是整个程序），那将是理想的.

我可以使用开源解决方案，但不能使用任何 GPL。Java 小程序或任何类似的东西都是可能的。

**到目前为止考虑的解决方案似乎不起作用**：

*   **HTML5 视频标签**：似乎不支持实时 RTSP 流
*   **GStreamer (Java Bindings) / OSSBuild GStreamer-WinBuilds v0.10.7 Beta 4 LGPL**：RTSP 源和 WinBuild 的插件似乎不稳定（我的流给出了与流 SETUP 请求相关的错误，而其他的则没有）
*   **JavaFX**：似乎在其最新版本中放弃了对实时 RTSP 流的支持
*   **Xuggler**：许可似乎是个问题
*   **JMF**：旧的，没有明显的 H.264 支持
*   **FMJ**：似乎不支持实时 RTSP 流

我应该重新评估这些可能性吗？任何其他建议（例如在 Flash 或 Silverlight 中）将不胜感激。

谢谢！

编辑：在 HTML5 中获得解决方案真的很棒。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-13T11:17:19.823

直播必须由浏览器支持，而不是 HTML5 播放器。您可以在此处参考文档[http://www.bitspace.in/2011/02/html5-live-streaming-media-server.html](http://www.bitspace.in/2011/02/html5-live-streaming-media-server.html)。也`rtsp`无法使用[http://www.jquery4u.com/flowplayer/html5-video-rtsp-live-streams/#.T9hzRjkpK0x](http://www.jquery4u.com/flowplayer/html5-video-rtsp-live-streams/#.T9hzRjkpK0x)`HTML5`中的方式播放。如果您可以对视频进行转码，那么您可以使用. 作为参考，您可以查看[将 rtsp 视频流转换为 http 流](https://stackoverflow.com/questions/2370742/convert-rtsp-video-stream-to-http-stream)的答案或参考 wowza 服务器的文档以转换流[http://www.wowza.com/forums/content.php?39-How-to-re-stream -video-from-an-IP-camera-%28RTSP-RTP-re-streaming](http://www.wowza.com/forums/content.php?39-How-to-re-stream-video-from-an-IP-camera-%28RTSP-RTP-re-streaming)。一般来说`HTML5``rtsp stream`如果您的代码中没有嵌入播放器，但不知道如何向用户发送消息以安装任何插件来播放流以及这将在多远的范围内跨设备和跨浏览器工作，则使用外部播放器打开。`rtsp stream`除了`http`和之外，也不支持任何 Flash 播放器来处理`rtmp`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T13:50:44.897

我公司使用的网络摄像机有一个浏览器界面，可以做到这一点。令人讨厌的是，我们无法访问嵌入式视频播放器的源代码，但以下站点似乎拥有它。

[http://en.pudn.com/downloads357/doc/detail1552764_en.html](http://en.pudn.com/downloads357/doc/detail1552764_en.html)

然而，更令人讨厌的是，该站点要求您先注册，然后提交 5 段代码才能访问下载。我还没有完成这些上传，感觉可能是白兔追逐，我只分享它，因为我可能错了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T14:56:04.173

VLC 插件适用于您询问的所有平台。

# jquery - jQuery - addClass 如果今天是今天

> ID：10807574
> 
> 赞同：2
> 
> 时间：2012-05-29T22:24:54.587
> 
> 标签：jquery, addclass

简单的问题；如果是星期一，我想突出显示一些文本，如果是星期二，我想突出显示其他一些文本等。

```
$('p.day:eq("' + new Date().getDay() + '")').addClass('today'); 
```

我觉得我很接近。

[**js小提琴**](http://jsfiddle.net/keE2f/1/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:28:38.357

你应该做 ：

```
$('p.day').eq(new Date().getDay()-1).addClass('today'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T22:28:53.647

```
$('p.day:eq(' + new Date().getDay() + ')').addClass('today'); 
```

您需要去掉`:eq()`- 中的引号，将值作为整数而不是字符串传递。

此外，使用`.getDay()`, Sunday 是第 0 天，因此您要么需要更改日期的顺序，要么为此创建另一个解决方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T22:28:15.587

```
$('p.day').eq(new Date().getDay()).addClass('today'); 
```

[**固定演示**](http://jsfiddle.net/keE2f/2/)

或者使用`:eq`psudo css 选择器：

```
$('p.day:eq(' + new Date().getDay() + ')').addClass('today'); 
```

数字应该是数字而不是字符串。

# mysql - 字符串到时间戳 mysql 错误 #1411

> ID：10807576
> 
> 赞同：1
> 
> 时间：2012-05-29T22:24:58.487
> 
> 标签：mysql

在将 csv 文件从字符串导入 mysql 到 datetime 数据类型时，我正在尝试即时转换时间戳。但我收到一个`#1411 - Incorrect datetime value: '2007-03-30 16:01:15' for function str_to_date`错误。

SQL：

```
load data infile 'C:/ProgramData/MySQL/MySQL Server 5.5/data/testfile.csv'
into table test
fields terminated by ','
lines terminated by '\n'
(date, col1,col2,col3,col4)
SET
date = str_to_date(date,'%Y.%m.%d %H:%i:%s.%f'); 
```

.csv 中的所有行的格式如下：

```
2007.03.30 16:01:15.901,117.53,117.55,35600000,43700000
```

我已申请

```
SELECT str_to_date(date,'%Y.%m.%d %H:%i:%s.%f') FROM test 
```

对已经存储在 mysql 中的数据进行采样，它确实有效。

目标行`date`设置为`DATETIME`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:27:47.670

您需要通过用户变量。正如[手册](http://dev.mysql.com/doc/en/load-data.html)所说：

> 列列表可以包含列名或用户变量。对于用户变量，该`SET`子句使您能够在将结果分配给列之前对其值执行转换。
> 
> 子句中的用户变量`SET`可以以多种方式使用。以下示例直接将第一个输入列用于 的值`t1.column1`，并将第二个输入列分配给一个用户变量，该用户变量在用于 的值之前要经过除法运算`t1.column2`：
> 
> ```
> 加载数据文件'file.txt'
>   进入表 t1
>   （列 1，@var1）
>   SET column2 = @var1/100;
> ```

在你的情况下：

```
LOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 5.5/data/testfile.csv'
  INTO TABLE test
  FIELDS TERMINATED BY ','
  LINES  TERMINATED BY '\n'
  (@date, col1, col2, col3, col4)
  SET date = STR_TO_DATE(@date, '%Y.%m.%d %H:%i:%s.%f'); 
```

# c# - 在基于 EF 代码的迁移之前运行更新

> ID：10807579
> 
> 赞同：1
> 
> 时间：2012-05-29T22:25:07.893
> 
> 标签：c#, entity-framework, entity-framework-migrations

在尝试多种方案来评估基于代码的迁移时，我注意到如果数据库包含无法自动转换或将被截断的数据（减少长度、字符串->int、字符串->），实体框架不会将迁移应用到数据库datetime ...) 这当然是一件好事。

现在，如果我想在迁移之前运行更新脚本，例如将所有日期字符串更改为相同的格式，我会将该更新直接放入迁移的 Up() 方法中，还是有更好的地方？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T08:24:59.617

是的，您需要使用代码迁移（将所有迁移代码添加到方法中）并在所有生成的迁移代码之前`Up`插入调用。`Sql(...)`

# python-2.7 - while 语句

> ID：10807591
> 
> 赞同：-3
> 
> 时间：2012-05-29T22:26:39.473
> 
> 标签：python-2.7

```
def sequence(n):
    while n != 1:
        print n,
        if n%2 == 0:        # n is even
           n = n/2
      else:               # n is odd
            n = n*3+1

sequence(6)
6 3 10 5 16 8 4 2 
```

为什么这里的输出不包括 1？很多很多thanx！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:31:55.737

尝试使用`<=`或`>=`例如，`while n >= 1`。那应该做你需要的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:34:01.210

您在中断 if 时设置了 while 循环`n == 1`。尝试可能做`n > 0`or `n >= 1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:34:07.297

```
while n != 1:
       print n 
```

一旦 n 的值为 1，它就不会进入循环，因此不允许打印 'n'。

# linux - 如何从linux核心转储文件中获取运行线程的地址？

> ID：10807593
> 
> 赞同：1
> 
> 时间：2012-05-29T22:26:45.680
> 
> 标签：linux, coredump

我有一个来自多线程程序的 Linux Core Dump。
通常，我通过在 GDB 中使用“ ***bt ”来获取******正在运行的线程的堆栈跟踪。***

 *但是当**堆栈损坏**时，我想使用线程结构的**地址访问线程结构**。

在 NetBSD 中，我使用 _thread_now 来获取 gdb 中线程结构的地址。

是否也有一些命令可用于 Linux？*

# php - 数组与键上的值匹配

> ID：10807594
> 
> 赞同：2
> 
> 时间：2012-05-29T22:26:48.193
> 
> 标签：php, arrays, multidimensional-array

在发现数组的最终用途时，我感觉自己有点过头了。

我有两个数组，其中第一个有主键，值是附加到该键的文件数。

目标是将第一个数组的键与第二个数组中的值匹配，但仍然维护（并显示）Array-1 的（值）计数——但仅针对第二个数组中的值。

似乎有些模糊，但这里是数组。第二个具有应该与第一个中的键匹配的值。（我的问题是每次尝试都会丢失数组 1 的值。）

希望你能帮我解决这个问题。

*（工作匹配是键，如：125、2051 和 2214*）

**阵列 1：**

```
Array ( 
    [6960] => 3 
    [2214] => 4 
    [2051] => 4 
    [6944] => 2 
    [6938] => 4 
    [1823] => 1 
    [766] => 6 
    [3993] => 4 
    [5896] => 6 
    [6927] => 2 
    [4220] => 3 
    [77] => 3 
    [83] => 1 
    [125] => 2 
    [6618] => 2 
    [196] => 1
    [4072] => 12
    [3718] => 1
    [5918] => 1
    [3388] => 10
    [4500] => 13
    [5968] => 2
    [3000] => 2
    [942] => 1
    [4246] => 8
    [5868] => 2
    [6394] => 3
    [1168] => 1
    [2163] => 1
    [1827] => 2
    [2071] => 8
    [4597] => 1
    [1702] => 7 
) 
```

**阵列 2：**

```
Array ( 

    [0] => 1024
    [1] => 1076
    [2] => 111
    [3] => 124
    [4] => 125
    [5] => 1301
    [6] => 1409
    [7] => 2051
    [8] => 2214
    [9] => 2636
    [10] => 3246
    [11] => 4838
    [12] => 6946
    [13] => 6955
    [14] => 6961
    [15] => 73
    [16] => 74
    [17] => 8
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:33:15.860

你的问题有点不清楚，但我认为这就是你要找的：

```
foreach( $array2 as $key)
{
    $count = ( isset( $array1[ $key ]) ? $array1[ $key ] : 0);
    echo $key . ' has ' . $count . ' files.';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:36:43.233

这样做怎么办：

```
<?php

$arr1 = array(1 => 1000, 500 => 1111, 1000 => 5000, 5000 => 5555);
$arr2 = array(1, 5000);

print_r(array_intersect_key($arr1, array_flip($arr2))); 
```

输出：

```
(
    [1] => 1000
    [5000] => 5555
) 
```

或者，使用您的数据：

```
<?php

$arr1 = array(6960 => 3, 2214 => 4, 2051 => 4, 6944 => 2, 6938 => 4, 1823 => 1, 766 => 6, 3993 => 4, 5896 => 6, 6927 => 2, 4220 => 3, 77 => 3, 83 => 1, 125 => 2, 6618 => 2, 196 => 1, 4072 => 12, 3718 => 1, 5918 => 1, 3388 => 10, 4500 => 13, 5968 => 2, 3000 => 2, 942 => 1, 4246 => 8, 5868 => 2, 6394 => 3, 1168 => 1, 2163 => 1, 1827 => 2, 2071 => 8, 4597 => 1, 1702 => 7);
$arr2 = array(1024, 1076, 111, 124, 125, 1301, 1409, 2051, 2214, 2636, 3246, 4838, 6946, 6955, 6961, 73, 74, 8);

print_r(array_intersect_key($arr1, array_flip($arr2))); 
```

输出：

```
Array
(
    [2214] => 4
    [2051] => 4
    [125] => 2
) 
```

`array_interset_keys`将通过键而不是值找到数组的交集。由于您的第二个数组是基于索引的数组（不是关联数组），我们需要首先使用 array_flip 翻转键和值。然后键可以相交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:33:33.403

嗯..我似乎无法理解你想要暗示什么..但从我看到的方式来看..如果你想将数组 1 的键作为数组 2 的值.. 只需执行此代码..

```
 foreach($array1 as $key=>$val) {
     $array2[] = $key;
 } 
```

这应该获取array1 的KEYS 并将其插入到您的array2[] 中。

希望这可以帮助你..干杯:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:38:28.607

这应该打印出您需要的内容：

```
foreach($array2 as $key=>$val) {
     echo $val;
     foreach($array1 as $key2 => $val2){
         if($key == $val2){
             echo $val2;
         }
     }
     echo '\n'; // new line
 } 
```

# animation - WPF：扩展器堆叠在一起，一个应该扩展并占用所有剩余空间

> ID：10807596
> 
> 赞同：0
> 
> 时间：2012-05-29T22:26:54.510
> 
> 标签：animation, stackpanel, expander, items, dockpanel

我认为这是众所周知的控件，但我在网络上找不到 WPF 示例/博客。我需要的是像 StackPanel 一样堆叠在彼此之上的 Expander WPF 控件的集合。不同之处在于扩展器默认情况下应该折叠，一旦其中一个展开，它应该占用所有剩余空间。如果扩展扩展器位于堆栈的中间，它应该将其下方的项目一直向下推到父元素的底部边缘。每个展开/折叠动作都应该是动画的。

StackPanel 作为 Expanders 的父面板在这里是不可能的，因为它不能给它的子（ren）“所有剩余空间”。DockPanel 部分执行此操作，但它只能为“最后一个孩子”执行此操作，我需要能够为任何孩子执行此操作。

那么实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T10:42:20.503

为了回答我的问题，我刚刚发现像这样的控件叫做 Accordion。网上有几个实现，但我认为最完整的是 WPF Toolkit [http://wpf.codeplex.com/](http://wpf.codeplex.com/)

# sql-server - 适用于 Linux 与 FreeTDS 的 Microsoft ODBC 驱动程序？

> ID：10807597
> 
> 赞同：7
> 
> 时间：2012-05-29T22:27:07.237
> 
> 标签：sql-server, linux, freetds, unixodbc

我正在研究从 RHEL6 应用程序服务器连接到 MSSQL 数据库的可能性。我找到了两种方法：

*   [免费TDS](http://www.freetds.org)
*   适用于 Linux + [unixODBC](http://www.unixodbc.org/)[的 Microsoft SQL Server ODBC 驱动程序](http://www.microsoft.com/en-us/download/details.aspx?id=28160)

有没有人有使用这些设置的经验？（我对后者特别好奇，因为它是由 MS 官方支持的）。表现？稳定？我可能会错过任何其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T10:42:29.783

作为记录，我当时选择了 FreeTDS。我评估了 unixODBC 和 FreeTDS，发现 FreeTDS 目前更易于使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T23:39:03.350

另一种选择是[用于 SQL Server 的 MS JDBC 驱动程序](http://msdn.microsoft.com/en-us/sqlserver/aa937724.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-07T21:57:15.500

如果您使用的是旧版本的 SQL Server（例如 2000），当前的 Microsoft ODBC 驱动程序可能无法工作。

FreeTDS 声称可以与所有版本的 MS SQL Server 一起使用： [http ://www.freetds.org/faq.html#Does.FreeTDS.support.my.server](http://www.freetds.org/faq.html#Does.FreeTDS.support.my.server)

# c# - 执行时间需要 30 多分钟循环遍历两个字典列表

> ID：10807598
> 
> 赞同：0
> 
> 时间：2012-05-29T22:27:08.943
> 
> 标签：c#, list, sorting, dictionary, compare

目前我的程序是这样工作的：

```
List<Dict<string, double>> GroupA;
List<Dict<string, double>> GroupB;
* All dictionaries have the same keys but with dif values

foreach(string key in GroupA[0])
{
      List<double> GroupA_Values;
      foreach(Dict d in GroupA)
          GroupA_Values.add(d[key]);

      List<double> GroupB_Values;
      foreach(Dict d in GroupB)
          GroupB_Values.add(d[key]);

      CompareValuesFunction(GroupA_Values, GroupB_Values);
} 
```

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T01:43:39.310

与其拥有一个字典列表，不如拥有一个`Dictionary<string, List<string>>`where values 是与特定键关联的所有值的列表。

目前，您正在为每个字典值处理每个字典中的每个值。这根本不能很好地扩展。通过将所有值复制到列表中，所有内容都将线性缩放，而不是多项式。

这种设置也将消耗更少的内存（字典比其他数据结构消耗更多的内存以获得快速的搜索速度）。

正如评论中提到的，如果我们对什么（即查看它的代码）有更多了解，`CompareValuesFunction`我们可能会提出额外的改进建议。

# python - 让 django Url 模板标签返回有用的东西：抛出反向错误

> ID：10807601
> 
> 赞同：0
> 
> 时间：2012-05-29T22:27:16.677
> 
> 标签：python, django, django-templates

尝试使用 Django`{%url %}`模板标签并不断失败。视图在 sitename/transfers/views.py 中定义（其中 transfer 是 django 应用程序名称）：

```
def description_ListView(requesst,**kwargs):

    template_name = 'transfers/description.html'

    o = get_list_or_404(Transfer, description =kwargs['description'])
    #print ('o:',o)
    context_object_name = "transfer_name_list" 
    return render_to_response(template_name,{context_object_name:o,'description':kwargs['description']}) 
```

（是的，我知道这段代码有点奇怪。努力使它更通用，并在这个烦人的问题中陷入困境）

并且 url 映射在 transfer/urls.py

```
url(r'^description/(?P<description>[\w ]+)/$',
                           'transfers.views.description_ListView',
                           name = 'description_url') 
```

并在标签中： {% url "description_url" "blabla" %} 也尝试过： {% url "transfers.views.Description_ListView" description = "blabla" %}

错误信息：

```
Exception Type: NoReverseMatch
Exception Value:    
Reverse for '"description_url"' with arguments '(u'blabla',)' and keyword arguments '{}' not found. 
```

或者当我尝试使用`as somename`语法并像这样调用它时：`{{somename}}。只是默默地失败了，没有产生任何东西。

我还尝试从视图中导入 Description_ListView 并直接使用它，但没有帮助。

此外，根据各种 SO 问题中关于此主题的众多答案的建议，我将视图改为双引号，并恢复为使用 url 名称而不是视图，但都没有帮助。

我很乐意为此提供任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:38:21.410

我认为你不需要引号。尝试：

```
{% url description_url "blabla" %} 
```

请参阅[https://docs.djangoproject.com/en/dev/topics/http/urls/#naming-url-patterns](https://docs.djangoproject.com/en/dev/topics/http/urls/#naming-url-patterns)

# jquery - 如何在 wijmo 菜单上设置权限？

> ID：10807603
> 
> 赞同：0
> 
> 时间：2012-05-29T22:27:19.797
> 
> 标签：jquery, menuitem, wijmo

我刚刚下载了 Wijmo open for Juice UI 并尝试了 wijmenu。它非常易于使用。

问题是我需要在菜单项级别设置权限。我如何动态地做到这一点，或者我可以在哪里设置角色并禁用基于该角色的菜单项。我是 JQuery 的新手，所以请多多包涵。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T20:53:30.523

d_inevitable 有正确的答案——你应该在服务器端执行安全修整。如果您需要更多帮助，我们的支持团队会监控产品论坛；jUCIE UI 论坛位于[http://our.componentone.com/groups/asp-net/wijmo-open-juice-ui/forum/](http://our.componentone.com/groups/asp-net/wijmo-open-juice-ui/forum/)。

# c# - 使用过时版本的 MyAssembley.XmlSerializers.dll

> ID：10807605
> 
> 赞同：2
> 
> 时间：2012-05-29T22:27:47.020
> 
> 标签：c#, .net

我从[这里](https://stackoverflow.com/questions/934411/what-is-myassembly-xmlserializers-dll-generated-for)了解到我的项目创建了 MyAssembley.XmlSerializers.dll 文件，因为我在项目属性中将“生成序列化程序集”设置为自动。

我正在将类库部署到服务器，并且想知道会发生什么：

*   如果我只部署没有 MyAssembley.XmlSerializers.dll 的 MyAssembley.dll（我认为 .NET 运行时只会动态生成它）

如果我已经部署了两个 dll 一次。

*   我对 MyAssembley.dll 进行了更改（我假设 MyAssembley.XmlSerializers.dll 也会更改）但我最终只部署了 MyAssembley.dll。因此最终得到 MyAssembley.dll （最新版本）和 MyAssembley.XmlSerializers.dll （旧版本）[可能带我进入问题 1？]

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:32:52.757

如果要避免错误，只需关闭序列化即可。因此，MyAssembly.XMLSerializers.dll 的汇编版本不会有问题

除非您有一个使用大量内存的大型项目，否则您可以安全地关闭序列化。

# php - 逐步输出 exec() ping 结果

> ID：10807607
> 
> 赞同：1
> 
> 时间：2012-05-29T22:27:50.120
> 
> 标签：php, buffer, exec, ping, flush

我正在尝试编写一个 ping 几百个地址并返回它们的值（毫秒）的函数。到目前为止，我已经实现了 ping 并获得结果的最初想法，但是当对数百个地址使用相同的代码时会出现问题，PHP 页面会停止，直到它超时或到达最后一个 ping 命令。

如果我能得到一些建议来逐步输出结果，我会很高兴，这是我当前的代码：

```
<?php

// "for" loop added according to suggestion for browser compatibility (IE, FF, CHR, OPR, SFR)
for($i = 0; $i < 5000; $i++)
{
    echo ' ';
}

function GetPing($ip = NULL) {
    // Returns the client ping if no address has been passed to the function
    if(empty($ip)) {
        $ip = $_SERVER['REMOTE_ADDR'];
    }

    // Check which OS is being run by the client
    if(getenv('OS') == 'Windows_NT') {
        //echo '<b>Detected local system:</b> Windows NT/2000/XP/2003/2008/Vista/7<p>';
        $exec = exec("ping -n 1 -l 32 -i 128 " . $ip);
        return end(explode(' ', $exec));
    }
    else {
        //echo '<b>Detected local system:</b> Linux/Unix<p>';
        $exec = exec("ping -c 1 -s 32 -t 128 " . $ip);
        $array = explode('/', end(explode('=', $exec )));
        return ceil($array[1]) . 'ms';
    }
    // ob_flush and flush added according to suggestion for buffer output
    ob_flush();
    flush();
}

// Added to test 20 sequential outputs
for($count = 0; $count < 20; $count++)
    echo GetPing('8.8.8.8') . '<div>';

?> 
```

在一些反馈之后，我在脚本中添加了一个*for*循环以及 ob_flush() 和 flush()，并且我还在*php.ini*中将 output_buffering 设置为 0 。它似乎适用于我迄今为止测试过的大多数浏览器（IE8、Firefox 12、Chrome 19、Opera 11、Safari 5）。似乎当前代码现在正在按预期工作，但任何改进它的建议都非常感谢。

感谢您的反馈意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T10:02:43.383

这只是一个猜测；几年前我写了一个非常不稳定的聊天脚本，它也使用了输出缓冲（并在 while(true) 循环中获取新消息）..

在执行此操作时，我遇到了相同的问题，有时脚本会停止（空白屏幕），有时需要一段时间才能出现字符，另外这也是特定于浏览器的。

这是我添加到脚本中的相关代码片段，以使其与 IE6 和 FF2 一起使用（正如我所说，几年前......）

```
<?php
    // End output buffering
    ob_end_flush(); 

    // IE and Safari Workaround
    // They will only display the webpage if it's completely loaded or
    // at least 5000 bytes have been "printed".
    for($i=0;$i<5000;$i++)
    {
        echo ' ';
    }

    while( ... )
    {
        echo 'Message';
        ob_flush();
        flush();
    }
?> 
```

它对我有用，所以也许你也可以尝试一下。（尽管我不知道现代浏览器和服务器基础设施将如何表现）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:57:24.047

我认为您可能正在寻找的是逐步运行和输出脚本，而不是异步函数。

请参阅[有没有办法让 PHP 在脚本执行时逐步输出？](https://stackoverflow.com/q/2513110/738424)

# javascript - Backbone.js - CSS 更改等待 javascript 完成 - 适用于 Firefox，不适用于 Chrome/Safari

> ID：10807609
> 
> 赞同：0
> 
> 时间：2012-05-29T22:27:54.650
> 
> 标签：javascript, html, css, backbone.js

我正在编写一个backbone.js 应用程序。

当用户按下“搜索”按钮时，我会显示一个 loading.gif 图像（通过使其阻塞），同时让 javascript 代码继续。javascript 代码完成后，我取消隐藏加载图像（将显示更改为无）。

我可以看到它在 Firefox 中运行。在 safari/和 chrome 中，直到 javascript 代码完成后才会应用 CSS 的更改，因此用户在执行搜索时看不到加载图像。

有任何解决这个问题的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T04:51:17.180

我在加载图像时遇到了类似的问题，结果证明是因为图像尚未加载到浏览器中，并且无论出于何种原因，它直到其他操作完成才显示。我相信在我的情况下，XHR 以某种方式阻止了图像的加载或显示。从记忆中，这只发生在第一次显示加载图像时，之后就很好了。我最终在页面 html 中添加了一个元素来加载加载图像，然后用 javascript 隐藏它。这解决了问题..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:44:32.610

有几件事让我觉得很奇怪..但首先回答你的问题：

大多数 DOM/css 更改在执行的 Javascript 返回之前不会应用。为了解决这个问题，您可以更改 DOM，然后设置超时以执行其余的 Javascript 代码。

前任：

```
// make your image visible

function continuation() {
   // Put the javascript task that you need to execute here
}

// setTimeout will release execution control back to the browser so your CSS/DOM updates
// can be applied.  Once those updates are applied, continuation will be called
// by the browser and your remaining javascript can run.
setTimeout(continuation, 0); 
```

* * *

现在看起来很奇怪，您将拥有任何需要很长时间才能运行的 javascript，以至于您甚至有时间看到加载的 gif。如果您正在触发 XHR (ajax) 请求，那么查看加载图像是有意义的，但如果您这样做，那么您不应该遇到您所描述的问题。你的这个javascript任务到底是做什么的？

# c++ - 在运行 ubuntu 的服务器中构建 FastCGI 时出错

> ID：10807610
> 
> 赞同：2
> 
> 时间：2012-05-29T22:28:04.363
> 
> 标签：c++, ubuntu, cgi, fastcgi

我想在运行 ubuntu 的服务器中将 FCGI 与我的 C++ 代码接口。我没有在 FCGI 网站的测试平台列表下找到 ubuntu，但我还是尝试构建它。

`./configure`似乎工作正常。但是，当我运行时`make`，我收到 2 个错误，如下所示：

`fcgio.cpp: In destructor 'virtual fcgi_streambuf::~fcgi_streambuf()':
fcgio.cpp:50: error: 'EOF' was not declared in this scope
fcgio.cpp: In member function 'virtual int fcgi_streambuf::overflow(int)':
fcgio.cpp:70: error: 'EOF' was not declared in this scope
fcgio.cpp:75: error: 'EOF' was not declared in this scope
fcgio.cpp: In member function 'virtual int fcgi_streambuf::sync()':
fcgio.cpp:86: error: 'EOF' was not declared in this scope
fcgio.cpp:87: error: 'EOF' was not declared in this scope
fcgio.cpp: In member function 'virtual int fcgi_streambuf::underflow()':
fcgio.cpp:113: error: 'EOF' was not declared in this scope
make[2]: *** [fcgio.lo] Error 1
make[2]: Leaving directory '/home/giridhar/fcgi-2.4.1-SNAP-0910052249/libfcgi'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '/home/giridhar/fcgi-2.4.1-SNAP-0910052249'
make: *** [all] Error 2`

帮助解决此问题将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:53:38.063

我注意到 EOF 是一个 C 宏，它需要`stdio.h`fcgio.cpp 文件中未包含的宏。

在 fcgio.cpp 文件中添加 a`#include <stdio.h>`即可解决问题，现在 FCGI 在 Ubuntu 上构建良好。

# jquery - 在弯曲路径上绘制旋转文本

> ID：10807614
> 
> 赞同：2
> 
> 时间：2012-05-29T22:28:31.807
> 
> 标签：jquery, css, html

我想在曲线上显示文本。文本的每个字母都应该旋转，以便与曲线正交。

我发现的唯一现成的插件是[tympanus](http://tympanus.net/Development/Arctext/)的 Arctext。不幸的是，它仅根据半径呈现文本。

这是我想要实现的示例：

![弯曲图像演示](../Images/b0183c80bb71426203b6212c03f26d0c.png)

我对使用什么没有限制，跨浏览器兼容性也不是问题。唯一需要的是这个“东西”不应该在服务器端制作。它应该直接在客户端上更新（文本更改后）。

**编辑：更多信息**

1.  呈现的文本将由最终用户设置。
2.  将使用自定义字体。可能是库丰。

# opencl - 我可以使用外部 OpenCl 库吗？

> ID：10807625
> 
> 赞同：3
> 
> 时间：2012-05-29T22:29:08.343
> 
> 标签：opencl

我想使用一些外部库（http://trac.osgeo.org/geos/）对几何对象（GIS）执行一些分析任务。我想在 Cuda 上使用 OpenCL 执行这些任务，以便我可以使用 GPU 的并行功能在大量数据上并行执行这些任务。所以我的问题是：

1.  我可以使用这些库编写内核吗？

2.  另外，如何将这些库的复杂数据结构的对象作为参数传递给内核/（具体来说，如何创建这些复杂对象的缓冲区？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T22:39:02.547

一个[OpenCL](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/)程序主要由两部分组成

1.  主机代码 - 这是调用 OpenCL 运行时中的函数的常规 C/C++ 代码，其工作方式与任何其他代码一样。此代码需要与可能为您的程序提供（复杂）数据的任何第三方库交互。它还需要将这些复杂的数据类型转换为一组可以由片段 2 处理的简单数据类型（[标量](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/scalarDataTypes.html)、[向量](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/vectorDataTypes.html)、[其他）。](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/otherDataTypes.html)
2.  内核代码 - 由一个编译器组成，该编译器可以将受限内核语言（基于 C99）的文本/二进制表示转换为可以在目标平台上运行的目标代码。这种语言和编译器有很多[限制](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/restrictions.html)，包括您不能在外部库中包含/链接（*可能使用[可在主机 CPU 上运行的本机内核](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/clEnqueueNativeKernel.html)*）

由您的主机代码来[编译/设置内核](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/clCreateProgramWithSource.html)，从任何库/源中获取/设置数据，将其转换为 OpenCL 内核中允许的适当标量、向量或其他数据类型，运行[内核](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/clEnqueueNDRangeKernel.html)处理数据并将结果从计算设备返回到主机（如有必要），然后将这些简单的数据类型转换回其余代码使用所需的任何形式。

**所以不**- 你不能直接使用**内核内部的**常规 C++ 库。但是您可以在*主机代码*中做任何您想做的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-30T01:29:16.157

不，您不能在 OpenCL 内核中使用外部库。请记住，任何内核都需要在 OpenCl 应用程序运行时进行编译，因为它无法事先知道自己在哪个平台上运行。

# iphone - Audiostreamer iOS 类 - ARC 错误

> ID：10807628
> 
> 赞同：1
> 
> 时间：2012-05-29T22:29:24.337
> 
> 标签：iphone, ios, xcode, audio-streaming, audiostreamer

我正在尝试实现 Matt Gallagher 的[AudioStreamer](https://github.com/mattgallagher/AudioStreamer)类，我在`Audiostream.m`文件中收到 20 多个错误，这些错误基本上是在阅读：

`Cast of C pointer type 'void *' to Objective-C pointer type 'AudioStreamer *' requires a bridged cast`

我是 iOS 新手。我知道 ARC 是什么，但这个错误是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:46:09.767

正如错误表明您需要[桥接演员](https://stackoverflow.com/questions/7036350/arc-and-bridged-cast)表。请阅读该问题以了解可用的桥接演员表之间的差异。如果你有时间观看 WWDC 2011 session 323。

* * *

你可能只需要这样的东西：

```
AudioSessionInitialize (
    NULL,                          // 'NULL' to use the default (main) run loop
    NULL,                          // 'NULL' to use the default run loop mode
    MyAudioSessionInterruptionListener,  // a reference to your interruption callback
    (__bridge void *)(self)                       // data to pass to your interruption listener callback
); 
```

# javascript - 客户端或服务器端（asp.net）图像映射都不会弹出 html 表单

> ID：10807630
> 
> 赞同：1
> 
> 时间：2012-05-29T22:29:43.117
> 
> 标签：javascript, asp.net, html

我有一个精灵，点击它应该打开一个 htm 帮助文件或视频，这取决于点击的位置。
我已经尝试过 asp.net 图像映射和客户端映射，有和没有 window.open 以及发送到 javascript 函数。没有任何效果。我真的不想使用服务器端，但我似乎无法让它工作。

```
<div class="divhelp">
  <br />
  <asp:ImageMap  
         ID="ImageMap1"  
         runat="server"  
         ImageUrl="~/images2020/SpriteVideoandHelp.png" 
         Width="70"  
         Height="32"
         HotSpotMode="NotSet">  
        <asp:RectangleHotSpot Target="_self" Top="0" Bottom="32" Left="0" Right="34" AlternateText="Videos" NavigateUrl="openVideoHelp('1')" />  
        <asp:RectangleHotSpot Target="_blank" Top="0" Bottom="32" Left="35" Right="70" AlternateText="Help" NavigateUrl="javascript:window.open('../HelpFiles/Login.htm', 'Search', 'width=600,height=450,left=150,top=200,scrollbars=1,toolbar=no,menubar=yes,status=1')" />  
    </asp:ImageMap>  
  </div>

<a href="#"><img src="images2020/SpriteVideoandHelp.png" alt="Videos and Help Files" width="70" height="32" border="0" usemap="#mapname"/></a><br />
  <map id="mapname">
    <area shape="rect" onclick="javascript:window.open('../HelpFiles/Login.htm','Search','width=650,height=500,left=150,top=200,scrollbars=1,toolbar=no,menubar=yes,status=1')" alt="Videos" coords="0,32,0,34"/>
    <area shape="rect" onclick="javascript:window.open('../HelpFiles/Login.htm','Search','width=650,height=500,left=150,top=200,scrollbars=1,toolbar=no,menubar=yes,status=1')" alt="Help" coords="0,32,35,70" />
</map>

    function openVideoHelp(imgClicked) {

    if (imgClicked == '1') {
        helpfile = window.open('../HelpFiles/Login.htm', 'Search', 'width=600,height=450,left=150,top=200,scrollbars=1,toolbar=no,menubar=yes,status=1');
        return false;
    }
    else {

        helpfile = window.open('../HelpFiles/Login.htm', 'Search', 'width=600,height=450,left=150,top=200,scrollbars=1,toolbar=no,menubar=yes,status=1');
        return false;
    };

}; 
```

我尝试过的还有其他几种变体，但都没有运气。

我做错了什么或者这是不可能的？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:00:50.430

您可以删除服务器端图像映射。

客户端图像映射的所有问题在于您已切换图像的宽度和高度。应该是`width="32" height="70"`。

此外，视频区域的坐标混淆了：它应该是`<area coords="0,0,32,34"...`.

希望有帮助。

# java - 用布尔值计数

> ID：10807634
> 
> 赞同：3
> 
> 时间：2012-05-29T22:30:05.063
> 
> 标签：java, boolean

我想知道我是否可以像数字一样添加布尔值。我正在制作使用网格的东西，我希望它找到周围的正方形并返回一个数字。编辑：这就是我计算布尔值的方式。

```
 int count = 0;
 for (int x = -1; x<=1;x++){
   for (int y = -1; y <=1;y++){
     if (grid[xPos+x][yPos+y]){
        count++;
     }
   }
 } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T22:31:05.847

```
boolean[] bools = ...
int sum = 0;
for(boolean b : bools) {
    sum += b ? 1 : 0;
} 
```

这假设你想`true`成为`1`和`false`成为`0`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:46:45.147

要添加到杰弗里的答案，请不要忘记：

*   如果您位于嵌套 for 循环的中心单元格，请不要检查网格，也不要添加计数。否则，您将在其邻居计数中计算单元格本身。在你的情况下，它是`(x == 0 && y == 0)`
*   您将需要检查单元格是否位于边缘，如果是，请确保您没有尝试计算网格外的单元格。我已经使用类似这样的方法完成了此操作：`int xMin = Math.max(cellX - 1, 0);`其中 xMin 是 for 循环之一的下限。我对 y 做类似的事情，对网格的最大边也做类似的事情。在您的代码中，这将在`xPos + x < 0`or `xPos + x >= MAX_X`（MAX_X 是网格允许的最大 x 值的常数）时发生，并且对于事物的 y 侧类似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:53:20.997

你的目标是什么？速度？可读性？代码简洁？

如果您正在寻求速度，请考虑尽量减少内存访问次数。如果您可以强制将布尔值存储为位，则可以使用 >> 和 & 仅比较每行中您关心的位。也许是这样的：

```
 byte grid[m][n / 8];

 int neighbor_count = 0;
 for (int row = yPos - 1; row < yPos + 1; row++) {
   // calculate how much to shift the bits over.
   int shift = 5 - (xPos - 1 % 8);
   if (shift > 0) {
     // exercise for the reader - span bytes.
   } else {
     // map value of on-bits to count of on bits
     static byte count[8] = [0, 1, 1, 2, 1, 2, 2, 3];
     // ensure that only the lowest 3 bits are on.
     low3 = (grid[row][xPos / 8] >> shift) & 7;
     // look up value in map
     neighbor_count += count[low3];
   } 
```

*警告编码器*：这是未经测试的，仅用于说明。它也不包含边界检查：一种解决方法是从 1 迭代到 max - 2 并具有未设置单元格的边界。如果正在评估的单元格打开，您也应该减去 1。

这可能最终会比您拥有的要慢。您可以通过将位图存储在 int32s（或任何本机）中来进一步优化它。你也可以使用多线程，或者只实现[Hashlife](http://en.wikipedia.org/wiki/Hashlife) :)

显然，这优化了简洁性*和*可读性。我认为您的代码具有最大的可读性。

正如 Jeffrey 所暗示的，存储一个稀疏的“on”布尔值数组可能比值数组更可取，这取决于你在做什么。

# c# - 代码在本地与服务器上执行不同

> ID：10807635
> 
> 赞同：0
> 
> 时间：2012-05-29T22:30:11.713
> 
> 标签：c#, asp.net, image-processing

我有一些基于色调进行键色替换的 C# 代码。在我的本地机器上，它运行良好。但是，当我将它推送到服务器时，它会替换“一些”但不是所有颜色。这就像它只是决定不运行部分代码。

这些图像是无损 PNG - 它们在服务器上是完整的。这是某种线程问题吗？我的代码在这里没有线程化（超出网络服务器所做的），但有没有人见过类似的事情发生？

如果我提到此代码**在单独的库项目中编译**然后从 MVC3 应用程序中引用，这也可能会有所帮助。

谢谢，这是代码示例：

```
private void _ReplaceImageColor(Image img, Color baseColor, Color newColor)
{
    Bitmap bmp = (Bitmap)img;
    double baseHue = baseColor.GetHue();
    for (int x = 0; x < bmp.Width; x++)
    {
        for (int y = 0; y < bmp.Height; y++)
        {
            double pixelHue, pixelSat, pixelVal;
            ColorProcessor.ColorToHSV(bmp.GetPixel(x, y), out pixelHue, out pixelSat, out pixelVal);
            if (pixelHue == baseHue)
            {
                Color setColor = ColorProcessor.ColorFromHSV(newColor.GetHue(), pixelSat, pixelVal);
                bmp.SetPixel(x, y, setColor);
            }
        }
    }
} 
```

这是`ColorProcessor`自人们问起的方法...

```
public static void ColorToHSV(Color color, out double hue, out double saturation, out double value)
{
    int max = Math.Max(color.R, Math.Max(color.G, color.B));
    int min = Math.Min(color.R, Math.Min(color.G, color.B));

    hue = color.GetHue();
    saturation = (max == 0) ? 0 : 1d - (1d * min / max);
    value = max / 255d;
}

public static Color ColorFromHSV(double hue, double saturation, double value)
{
    int hi = Convert.ToInt32(Math.Floor(hue / 60)) % 6;
    double f = hue / 60 - Math.Floor(hue / 60);

    value = value * 255;
    int v = Convert.ToInt32(Math.Max(value, 0));
    int p = Convert.ToInt32(Math.Max(value * (1 - saturation), 0));
    int q = Convert.ToInt32(Math.Max(value * (1 - f * saturation), 0));
    int t = Convert.ToInt32(Math.Max(value * (1 - (1 - f) * saturation), 0));

    if (hi == 0)
        return Color.FromArgb(255, v, t, p);
    else if (hi == 1)
        return Color.FromArgb(255, q, v, p);
    else if (hi == 2)
        return Color.FromArgb(255, p, v, t);
    else if (hi == 3)
        return Color.FromArgb(255, p, q, v);
    else if (hi == 4)
        return Color.FromArgb(255, t, p, v);
    else
        return Color.FromArgb(255, v, p, q);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:47:27.660

您可能需要非常仔细地检查您的 dll 引用在服务器上与在开发机器上是否相同。Hanselman 最近有一篇关于这件事的文章：[在生产环境中确认您的期望和版本号](http://www.hanselman.com/blog/ASPNETMVCBetaAndRCUpgradesConfirmYourExpectationsAndVersionNumbersInProductionEnvironments.aspx)

此外，由于它在调试与发布模式下的行为不同，请检查它是否在构建中使用相同的位数以消除可能在浮点数上表现出来的潜在变化（例如 x86）。

# java - a4j:commandLink 双击后执行动作

> ID：10807640
> 
> 赞同：2
> 
> 时间：2012-05-29T22:30:58.737
> 
> 标签：java, ajax, jsf, richfaces

我有一个用户表，`a4j:commandLink`其中删除了相应的用户，但问题是我需要单击两次才能执行该操作，我该如何解决，代码如下：

```
 <h:form id="formUsuariosRegistrados">
                <rich:dataScroller for="usersTable" fastControls="hide"
                                   boundaryControls="hide" />
                <rich:dataTable id="usersTable" rows="10" var="user"
                                value="#{administrationBean.tablaUsuarios}">
                    <f:facet name="header">
                        <rich:columnGroup>
                            <rich:column>
                                <h:outputText value="Nombre"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Usuario"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Dependencia"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Email"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Tipo usuario"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Tipo dependencia"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Fecha límite"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value=""/>
                            </rich:column>
                        </rich:columnGroup>
                    </f:facet>
                    <rich:column>
                        <h:outputText value="#{user.nombre}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.usuario}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.dependencia}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.correo}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.tipoUsuario}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.tipoDependencia}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.fechaLimiteCarga}"/>
                    </rich:column>
                    <rich:column>
                        <a4j:commandLink value="Eliminar" immediate="true"
                                         execute="@form"
                                         onclick="return confirm('Esta seguro(a) que deseea continuar?')"
                                         render="@form :formFechaLimite :formModificarContrasena"
                                         action="#{administrationBean.doEliminarUsuario(user.usuario)}"/>
                    </rich:column>
                </rich:dataTable>
            </h:form> 
```

**更新**

这是我添加到同一视图中的另一段代码，但现在发生了两件事：

1.  首次加载 View 时，如果我单击`a4j:commandLink`表格上的 ，则该操作会正常调用。

2.  完成 1 后，当我尝试选中（或取消选中）`<h:sekectBooleanCheckBox>`现在该组件在单击两次后执行 ajax。

3.  我尝试了 BalusC 的回答，但我认为我用这种新形式做得不对。

    请指教，加油

    ```
     <h:form id="formFechaLimite">
            <rich:panel style="width: 400px" id="panelFechaLimite">
                <f:facet name="header">
                    <h:outputText value="Fecha limite de carga"/>
                </f:facet>

                <h:outputLabel for="fechaLimite" value="Fecha Limite"/>
                <br/>
                <rich:calendar id="fechaLimite"
                               value="#{administrationBean.fechaLimite}"
                               datePattern="dd/MM/yyyy">
                    <a4j:ajax event="change" render="usuarios fechaLimiteModificada"
                              listener="#{administrationBean.doHideEtiquetaFechaModificada}"/>
                </rich:calendar>
                <br/>
                <h:outputLabel for="todosUsuarios"
                               value="Aplicar a todos los usuarios? "/>
                <h:selectBooleanCheckbox id="todosUsuarios"
                                         value="#{administrationBean.fechaTodosUsuarios}">
                    <a4j:ajax event="change" render="usuarios fechaLimiteModificada"
                              listener="#{administrationBean.doCheckBoxChanged}"/>
                </h:selectBooleanCheckbox>
                <br/>
                <a4j:outputPanel id="usuarios">
                    <rich:select value="#{administrationBean.selectedUser}"
                                 defaultLabel="Seleccione un usuario..."
                                 rendered="#{not administrationBean.fechaTodosUsuarios}">
                        <f:selectItems value="#{administrationBean.selectUser}"/>
                        <a4j:ajax event="selectitem" render="fechaLimiteModificada"
                                  listener="#{administrationBean.doHideEtiquetaFechaModificada}"/>
                    </rich:select>
                </a4j:outputPanel>
                <br/><br/>
                <a4j:commandButton value=" Aplicar " execute="@form"
                                   render="@form :panelUsuarios :formUsuariosRegistrados :usersTable"
                                   action="#{administrationBean.doCambiarFechaLimite}"/>
                <a4j:outputPanel id="fechaLimiteModificada">
                    <h:outputText value="Fecha límite modificada !"
                                  rendered="#{administrationBean.renderedEtiquetaFechaModicada}"
                                  style="color: #D17100; font-size: 14px;"/>
                </a4j:outputPanel>
            </rich:panel>
            <br/>
        </h:form>

        <br/>

        <rich:panel style="width: 800px" id="panelUsuarios">
            <f:facet name="header">
                <h:outputText value="Administración de usuarios"/>
            </f:facet>
            <h:form id="formUsuariosRegistrados">
                <rich:dataScroller for="usersTable" fastControls="hide"
                                   boundaryControls="hide" />
                <rich:dataTable id="usersTable" rows="10" var="user"
                                value="#{administrationBean.tablaUsuarios}">
                    <f:facet name="header">
                        <rich:columnGroup>
                            <rich:column>
                                <h:outputText value="Nombre"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Usuario"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Dependencia"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Email"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Tipo usuario"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Tipo dependencia"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value="Fecha límite"/>
                            </rich:column>
                            <rich:column>
                                <h:outputText value=""/>
                            </rich:column>
                        </rich:columnGroup>
                    </f:facet>
                    <rich:column>
                        <h:outputText value="#{user.nombre}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.usuario}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.dependencia}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.correo}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.tipoUsuario}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.tipoDependencia}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputText value="#{user.fechaLimiteCarga}"/>
                    </rich:column>
                    <rich:column>
                        <a4j:commandLink value="Eliminar" immediate="true"
                                         execute="@form"
                                         ondblclick="return confirm('Esta seguro(a) que deseea continuar?')"
                                         render="@form :formFechaLimite :formModificarContrasena"
                                         action="#{administrationBean.doEliminarUsuario(user.usuario)}"/>
                    </rich:column>
                </rich:dataTable>
            </h:form>

            <br/>

        </rich:panel> 
    ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T23:06:01.433

在使用表格更新显示的表单的另一种表单中，请确保在 ajax 中包含表单的客户端 ID `render`。否则更新后的表单将失去其视图状态，因此在第一次提交时不会处理任何内容。第一次提交后，表单恢复其视图状态，后续提交将被成功处理。

例如

```
<h:form>
  ...
    <h:commandButton value="Submit" action="#{bean.submit}">
        <f:ajax execute="@form" render=":otherPanel :otherForm" />
    </h:commandButton>
</h:form>

<h:panelGroup id="otherPanel">
    ...
    <h:form id="otherForm">
        ...
    </h:form>
    ...
</h:panelGroup> 
```

此问题与[JSF 规范问题 790](http://java.net/jira/browse/JAVASERVERFACES_SPEC_PUBLIC-790)有关，并且在即将发布的 JSF 2.2 中已修复。PrimeFaces 3.x 没有这个问题，因为其修改后的 JSF ajax 引擎已经考虑到了这一点。

### 也可以看看：

*   [JSF2 中的通信 - 包含另一种形式的内容的 Ajax 呈现](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#AjaxRenderingOfContentWhichContainsAnotherForm.)

# iphone - 为什么我的委托方法没有被调用？

> ID：10807641
> 
> 赞同：1
> 
> 时间：2012-05-29T22:30:59.480
> 
> 标签：iphone, ios, uitableview, delegates

这可能很简单，但我被困住了！

基本上我有一个父子视图控制器，我试图将数据从子节点传递给父节点。

//子VC接口

```
@protocol ANSearchGetawayFilterDelegate
    -(void)selectedCell:(NSString *)cellTitle;
@end

@interface ANSearchGetawayFilterViewController : UIViewController <UITableViewDelegate,     UITableViewDataSource, UISearchBarDelegate>
{
   NSString* cellTitle;
}
@property (nonatomic, assign) id<ANSearchGetawayFilterDelegate> delegate;

@end 
```

//子VC实现

```
@implementation ANSearchGetawayFilterViewController
@synthesize delegate = _delegate;

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *selectedCell = [tableView cellForRowAtIndexPath:indexPath];
    cellTitle = selectedCell.textLabel.text;
    [[self  delegate] selectedCell:cellTitle];

    [self dismissModalViewControllerAnimated:YES];
} 
```

//父VC接口

```
#import "ANSearchGetawayFilterViewController.h"

@interface ANGetawayFilterViewController : UIViewController <ANSearchGetawayFilterDelegate>
{
    NSString* _cellText;
} 
```

//父VC实现

```
 - (id)initWithNibName:(NSString*)nibNameOrNil bundle:(NSBundle*)nibBundleOrNil
    {
        self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
        if (self)
        {
            // Custom initialization
            ANSearchGetawayFilterViewController *search = [[ANSearchGetawayFilterViewController alloc] init];
            search.delegate = self;
        }
        return self;
    }

//delegate method

    -(void)selectedCell:(NSString *)cellTitle
    {
        _cellText = cellTitle;
        NSLog(@"cell text %@", _cellText);
    } 
```

委托方法永远不会被调用，什么时候 NSLog _cellText 其他地方它出现为空......我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:44:14.563

您很可能会创建一个新实例，用于`ANSearchGetawayFilterViewController`演示它而不是在其上配置委托。

当你打电话

```
ANSearchGetawayFilterViewController *search = [[ANSearchGetawayFilterViewController alloc] init];
search.delegate = self; 
```

您创建了一个实例，`ANSearchGetawayFilterViewController`然后正确设置了委托，**但**您从未将这个实例存储在`ANSearchGetawayFilterViewController`任何地方。所以稍后当你来展示它时，你再次打电话

```
ANSearchGetawayFilterViewController *search = [[ANSearchGetawayFilterViewController alloc] init]; 
```

这为您提供了一个完全不同的实例，然后您需要再次配置它。例如

```
ANSearchGetawayFilterViewController *search = [[ANSearchGetawayFilterViewController alloc] init];
ANSearchGetawayFilterViewController *search1 = [[ANSearchGetawayFilterViewController alloc] init];

NSLog(@"%d", search1 == search);

#=> 0 
```

修复更新您的代码

```
- (BOOL)textFieldShouldBeginEditing:(UITextField*)textField;
{
    BOOL shouldBeginEditing = YES; 
    NSLog(@"text field should begin editing"); 

    ANSearchGetawayFilterViewController *myANSearchGetawayFilterViewController = [[[ANSearchGetawayFilterViewController alloc] init] autorelease]; 
    myANSearchGetawayFilterViewController.delegate = self;    // <--- configure the delegate

    [self presentModalViewController:myANSearchGetawayFilterViewController animated:YES];
    [self closeAllPickers]; 
    return shouldBeginEditing; 
} 
```

我不会将其设为 ivar，因为您可能会暂时显示此 viewController 只是为了选择一些数据然后将其删除，因此丢弃它并每次创建一个新数据可能是安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:37:42.850

相反，委托方法正在被调用（因此是`NSLog()`）。但是，_cellText 是 (null)，因为传入的值是 nil，ergo `selectedCell.textLabel.text`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:38:50.777

首先，您确定`-selectedCell`正在调用该方法吗？

`-tableViewDidSelectRow`您可以通过在...之前或之后放置一个 NSLog() 来做到这一点

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    ...
    NSLog(@"TABLEVIEW DID SELECT ROW BEFORE -> %@ <-", cellTitle);
    [[self  delegate] selectedCell:cellTitle];
    NSLog(@"TABLEVIEW DID SELECT ROW DELEGATE CALLED");
    ...
} 
```

此外，您可能想做一些清理工作（可选）

首先，您的初始化方法正在泄漏。使用委托将设置`ANGetawayFilterViewController`为父类的属性，或者在设置委托后释放它。

其次，在 中`-tableViewDidSelectRow`，您的代码假定委托具有`-selectedCell`编码的方法。如果您没有实现该方法，那么应用程序将导致崩溃。您可以通过检查委托是否可以防止这种情况`-respondsToSelector...`：

```
if ([self.delegate respondsToSelector:@selector(selectedCell:)]) {
    [self.delegate selectedCell:cellTitle];
} 
```

第三，委托调用的方法通知 parentViewController 不遵循委托方法使用的一般模式，除了`-numberOfRowsInSection`( `UITableViewDelegate`)。您的方法也应该包含实际`ANFilterGetawayViewController`实例：

```
- (void) filterGetawayViewController:(ANSearchGetawayFilterViewController *) controller didSelectCellWithTitle:(NSString *) title {

    ...

} 
```

它可以这样调用：

```
[self.delegate filterGetawayViewController:self didSelectCellWithTitle:cellTitle]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:49:10.107

你在用ARC吗？因为当 init 函数结束时，你的对象（以及它对委托的引用）被清理了。如果将搜索变量设为全局变量（在标题中定义并在代码中初始化）会发生什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T22:50:40.803

假设您使用的是 ARC：

您需要`@property`为您的`ANSearchGetawayFilterViewController`实例保留一个。ARC 将在调用委托方法时释放它。做这样的事情。

```
@property (strong, nonatomic) ANSearchGetawayFilterViewController *search;
...
@synthesize search = _search;

- (id)initWithNibName:(NSString*)nibNameOrNil bundle:(NSBundle*)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self)
    {
        // Custom initialization
        self.search = [[ANSearchGetawayFilterViewController alloc] init];
        self.search.delegate = self;
    }
    return self;
} 
```

与您的问题无关，但最佳做法是在调用之前检查委托是否实际实现了您期望的方法，如下所示：

```
if ([self.delegate respondsToSelector:@selector(selectedCell:)]) {
    [self.delegate selectedCell:cellTitle];
} 
```

# git - Git：ffwd 合并是否保留所有主题分支提交？

> ID：10807648
> 
> 赞同：1
> 
> 时间：2012-05-29T22:31:26.547
> 
> 标签：git, merge, commit, preserve, fast-forward

假设我们有这种情况：

```
 master
         |
A--B--B--D--E--F--G
                  |
                test 
```

然后我们将 test 合并到 master 中。提交 E 和 F 是否保留在新的 master 分支中？

也就是说，它现在看起来像这样吗（选项 A）：

```
 master
                  |
A--B--B--D--E--F--G
                  |
                test 
```

或像这样（选项B）：

```
 master
            |
A--B--B--D--G
            |
          test 
```

抱歉，如果这已经被问过，我找不到它。此外，ProGit 书中的示例只有一个提交（在我的示例中是 E），它不能解决这样的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:38:27.637

**选项 A**会发生什么：保留提交。在快进合并的情况下，历史根本不会被修改，只有`master`分支指向不同的提交。就这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T23:00:05.293

你得到了一个快进合并（选项 A），开始的原因是因为在合并之前在 master 和 test 之间只有一行提交。如果 master 和 test 之间有一个分支，那将不再是快进合并。

我建议阅读[这篇](http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging)文章，以便对 git 中的分支和合并如何工作有一个很好的概述——你需要非常清楚地了解这些东西在使用 git 时是如何工作的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T23:00:45.400

选项A就是发生的事情。有时人们想要保留分支点，并会强制 git 创建一个新的合并提交。

```
git merge --no-ff test 
```

这取决于您要遵循的开发工作流程。

# python - multiprocessing.Manager().dict().setdefault() 坏了吗？

> ID：10807649
> 
> 赞同：8
> 
> 时间：2012-05-29T22:31:35.890
> 
> 标签：python, multiprocessing

迟到且可能很愚蠢的部门提出：

```
>>> import multiprocessing
>>> mgr = multiprocessing.Manager()
>>> d = mgr.dict()
>>> d.setdefault('foo', []).append({'bar': 'baz'})
>>> print d.items()
[('foo', [])]         <-- Where did the dict go? 
```

然而：

```
>>> e = mgr.dict()
>>> e['foo'] = [{'bar': 'baz'}]
>>> print e.items()
[('foo', [{'bar': 'baz'}])] 
```

版本：

```
>>> sys.version
'2.7.2+ (default, Jan 20 2012, 23:05:38) \n[GCC 4.6.2]' 
```

虫子还是乌戈？

编辑：更多相同，在 python 3.2 上：

```
>>> sys.version
'3.2.2rc1 (default, Aug 14 2011, 21:09:07) \n[GCC 4.6.1]'

>>> e['foo'] = [{'bar': 'baz'}]
>>> print(e.items())
[('foo', [{'bar': 'baz'}])]

>>> id(type(e['foo']))
137341152
>>> id(type([]))
137341152

>>> e['foo'].append({'asdf': 'fdsa'})
>>> print(e.items())
[('foo', [{'bar': 'baz'}])] 
```

dict 代理中的列表如何不包含附加元素？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T23:09:12.147

这是一些非常有趣的行为，我不确定它是如何工作的，但我会解释一下为什么这种行为是这样的。

首先，注意`multiprocessing.Manager().dict()`不是 a `dict`，它是一个`DictProxy`对象：

```
>>> d = multiprocessing.Manager().dict()
>>> d
<DictProxy object, typeid 'dict' at 0x7fa2bbe8ea50> 
```

该类的目的`DictProxy`是为您提供`dict`跨进程共享的安全性，这意味着它必须在正常`dict`功能之上实现一些锁定。

显然，这里实现的一部分是不允许您直接访问嵌套在 a 中的可变对象`DictProxy`，因为如果允许，您将能够以绕过所有可以`DictProxy`安全使用的锁定的方式修改共享对象。

这里有一些证据表明您无法访问可变对象，这与正在发生的事情类似`setdefault()`：

```
>>> d['foo'] = []
>>> foo = d['foo']
>>> id(d['foo'])
140336914055536
>>> id(foo)
140336914056184 
```

使用普通字典，您会期望`d['foo']`并`foo`指向同一个列表对象，而对其中一个对象的修改将修改另一个。`DictProxy`如您所见，由于多处理模块施加了额外的过程安全要求，因此该类并非如此。

**编辑：**[多处理文档](http://docs.python.org/library/multiprocessing.html#multiprocessing.managers.SyncManager.list)中的以下注释阐明了我上面想说的内容：

* * *

> **注意：**对 dict 和 list 代理中的可变值或项的修改不会通过管理器传播，因为代理无法知道其值或项何时被修改。要修改此类项目，您可以将修改后的对象重新分配给容器代理：

```
# create a list proxy and append a mutable object (a dictionary)
lproxy = manager.list()
lproxy.append({})
# now mutate the dictionary
d = lproxy[0]
d['a'] = 1
d['b'] = 2
# at this point, the changes to d are not yet synced, but by
# reassigning the dictionary, the proxy is notified of the change
lproxy[0] = d 
```

* * *

根据上述信息，您可以通过以下方式重写原始代码以使用`DictProxy`：

```
# d.setdefault('foo', []).append({'bar': 'baz'})
d['foo'] = d.get('foo', []) + [{'bar': 'baz'}] 
```

*正如 Edward Loper 在评论中所建议的那样，编辑上面的代码以使用* `get()` *而不是* `setdefault()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T23:01:48.920

Manager().dict() 是一个 DictProxy 对象：

```
>>> mgr.dict()
<DictProxy object, typeid 'dict' at 0x1007bab50>
>>> type(mgr.dict())
<class 'multiprocessing.managers.DictProxy'> 
```

DictProxy 是 BaseProxy 类型的子类，它的行为并不完全像普通的 dict：[http ://docs.python.org/library/multiprocessing.html?highlight=multiprocessing#multiprocessing.managers.BaseProxy](http://docs.python.org/library/multiprocessing.html?highlight=multiprocessing#multiprocessing.managers.BaseProxy)

因此，您似乎必须以不同于基本 dict 的方式处理 mgr.dict() 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T23:00:26.833

items() 返回一个副本。附加到副本不会影响原件。你是这个意思吗？

```
>>> d['foo'] =({'bar': 'baz'})
>>> print d.items()
[('foo', {'bar': 'baz'})] 
```

# .net - 使用内部委托类型编译 lambda 表达式

> ID：10807650
> 
> 赞同：4
> 
> 时间：2012-05-29T22:31:37.130
> 
> 标签：.net, reflection, f#

*如果委托类型是internal*，我在为 F# 中的属性 getter 编译 lambda 表达式时遇到了一些麻烦。这是函数的样子：

```
// if I omit the 'internal' here everything works as expected
module internal ReflectionHelpers =

    open System
    open System.Linq.Expressions
    open System.Reflection

    // it makes no difference if this delegate type is defined outside
    // of the module and marked as 'internal'
    type GetterFunc<'T> = delegate of 'T -> obj

    /// Build a getter expression function for the
    /// specified PropertyInfo
    let getGetter<'a> (p : PropertyInfo) =
        let inst = Expression.Parameter(p.DeclaringType, "i")
        let prop = Expression.Property(inst, p)
        let conv = Expression.Convert(prop, typeof<obj>)
        Expression.Lambda<GetterFunc<'a>>(conv, inst).Compile() 
```

如果我用公共类调用这个方法，我会得到一个像这样的异常（仅当 ReflectionHelpers 模块被定义为“内部”时）：

```
System.ArgumentNullException was unhandled by user code
  Message=Value cannot be null.
Parameter name: key
  Source=mscorlib
  ParamName=key
  StackTrace:
       at System.Collections.Generic.Dictionary`2.FindEntry(TKey key)
       at System.Collections.Generic.Dictionary`2.TryGetValue(TKey key, TValue& value)
       at System.Dynamic.Utils.CacheDict`2.TryGetValue(TKey key, TValue& value)
       at System.Dynamic.Utils.TypeExtensions.GetParametersCached(MethodBase method)
       at System.Linq.Expressions.Expression.ValidateLambdaArgs(Type delegateType, Expression& body, ReadOnlyCollection`1 parameters)
       at System.Linq.Expressions.Expression.Lambda[TDelegate](Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
       at System.Linq.Expressions.Expression.Lambda[TDelegate](Expression body, Boolean tailCall, IEnumerable`1 parameters)
       at System.Linq.Expressions.Expression.Lambda[TDelegate](Expression body, ParameterExpression[] parameters)
       ... 
```

可能我在这里遗漏了一个重要点，但目前我看不出发生这种情况的任何原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T23:11:03.000

F# 和 C# 使用不同的策略来为委托发出 Invoke 方法。如果您尝试在 C# 中定义类似的委托 - 委托类型将是内部的，但具有公共 Invoke 方法。F# 定义了与声明类型具有相同可见性的 Invoke 方法。当 Expression.Lambda 中的代码尝试在给定委托类型中查找 Invoke 方法时，它只查找公共方法，假设所有编译器的行为都类似于 C#

# twisted - 扭曲的服务器-客户端数据共享

> ID：10807656
> 
> 赞同：4
> 
> 时间：2012-05-29T22:31:59.873
> 
> 标签：twisted

我在这个站点上稍微修改了一个 server-client Twisted 程序，它提供了一个可以充当服务器和客户端的程序（[How to write a twisted server that is also a client?](http://stackoverflow.com/questions/3275004/how-to-write-a-twisted-server-that-is-also-a-client)）。我能够将服务器客户端连接到一侧的外部客户端和另一侧的外部服务器。我想通过服务器-客户端程序将数据从外部客户端传输到外部服务器。我遇到的问题是将 ServerProtocol 类（在服务器-客户端程序中）中接收到的行放入 ClientProtocol 类（在服务器-客户端程序中）。我尝试了多种方法，包括尝试使用工厂引用，正如您从 def **init中看到的那样**但我无法让它工作。（目前我只是将文字来回发送到外部服务器和客户端）这是服务器-客户端代码：

```
 from twisted.internet import protocol, reactor
    from twisted.protocols import basic

    class ServerProtocol(basic.LineReceiver):        
        def lineReceived(self, line):
            print "line recveived on server-client",line
            self.sendLine("Back at you from server-client")
            factory = protocol.ClientFactory()
            factory.protocol = ClientProtocol
            reactor.connectTCP('localhost', 1234, factory)

    class ClientProtocol(basic.LineReceiver):
        def __init__(self, factory):
            self.factory = factory

        def connectionMade(self):
            self.sendLine("Hello from server-client!")
            #self.transport.loseConnection()

        def lineReceived(self, line):
            print "line recveived on server-client1.py",line
            #self.transport.loseConnection()

    def main():
        import sys
        from twisted.python import log

        log.startLogging(sys.stdout)
        factory = protocol.ServerFactory()
        factory.protocol = ServerProtocol
        reactor.listenTCP(4321, factory)
        reactor.run()

    if __name__ == '__main__':
        main() 
```

我应该提到，我能够分别在端口 4321 和 1234 上使用外部服务器和外部客户端连接到服务器-客户端程序，它们只是回显。此外，我还没有展示我多次尝试使用 self.factory 参考。任何意见或建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T11:59:23.510

这个问题与 Twisted FAQ 中的一个流行问题非常相似：

[如何使一个连接上的输入导致另一个连接上的输出？](http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#HowdoImakeinputononeconnectionresultinoutputonanother)

与您关于一个传入客户端连接和一个传出客户端连接的问题相反，FAQ 项目谈论到一台服务器的许多客户端连接没有任何显着差异。您在不同连接之间共享数据的方式是相同的。

该 FAQ 项目的基本要点是，基本上您想做的任何事情都涉及某种方法调用，并且 Twisted 中的方法调用与任何其他 Python 程序中的方法调用相同。您所需要的只是引用正确的对象来调用该方法。因此，例如，调整您的代码：

```
from twisted.internet import protocol, reactor
from twisted.protocols import basic

class ServerProtocol(basic.LineReceiver):        
    def lineReceived(self, line):
        self._received = line
        factory = protocol.ClientFactory()
        factory.protocol = ClientProtocol
        factory.originator = self
        reactor.connectTCP('localhost', 1234, factory)

    def forwardLine(self, recipient):
        recipient.sendLine(self._received)

class ClientProtocol(basic.LineReceiver):
    def connectionMade(self):
        self.factory.originator.forwardLine(self)
        self.transport.loseConnection()

def main():
    import sys
    from twisted.python import log

    log.startLogging(sys.stdout)
    factory = protocol.ServerFactory()
    factory.protocol = ServerProtocol
    reactor.listenTCP(4321, factory)
    reactor.run()

if __name__ == '__main__':
    main() 
```

注意如何：

*   我摆脱`__init__`了`ClientProtocol`. `ClientFactory`不带参数调用它的协议。需要参数的 An`__init__`将导致`TypeError`引发 a。此外，`ClientFactory`已经将自己设置为它创建的协议的工厂属性。
*   我通过将实例设置为客户端工厂的属性`ClientProtocol`来引用该实例。由于实例具有对实例的引用，这意味着它具有对实例的引用。`ServerProtocol``ServerProtocol``originator``ClientProtocol``ClientFactory``ServerProtocol`
*   一旦建立连接，我添加了可用于指导执行任何应用程序逻辑的`forwardLine`方法。请注意，由于上一点，调用此方法没有问题。`ClientProtocol``ServerProtocol``ClientProtocol``ClientProtocol`

# entity-framework - Firebird 和实体框架区分大小写的表/列名称

> ID：10807657
> 
> 赞同：5
> 
> 时间：2012-05-29T22:32:23.647
> 
> 标签：entity-framework, ado.net, firebird

使用 Firebird 时，我可以查询表及其列，而无需担心大小写。如果我想要区分大小写，我可以将表/列名放在引号中。

Firebird Entity Framework 连接器在生成查询时会自动在名称周围加上引号，因此它会强制我区分大小写。

这意味着我有一堆 [Table("SOMETABLE")] 和 [Column("DESCRIPTION")] 到处都是，因为我现有的表名都是大写的。

如何告诉 Firebird 的 EF 连接器不区分大小写？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T07:56:08.237

你不能。名称将始终被引用。您必须提供真实姓名，当使用不同的大小写时，ORM 不依赖引擎中的回退逻辑。

OTOH，您可以使用带引号的标识符创建表和列，然后将保留大小写。

# java - Javascript异步返回

> ID：10807661
> 
> 赞同：2
> 
> 时间：2012-05-29T22:33:02.093
> 
> 标签：java, javascript, ajax, jsf, customdialog

我在我的应用程序中使用 JSF ajax（我们不能更改 =\），我们需要等待用户的操作。我的意思是，在调用 ajax 方法之前，我需要询问用户是否要使用自定义对话框恢复页面中的所有更改。如果他想继续并恢复，我将通过 ajax 调用 Java 方法，但如果不是，我们不需要调用 ajax。

让我尝试更具体：

这是我的大页面的还原按钮的代码：

```
<h:commandButton value="#{msg.revertBtn}" accesskey="R" styleClass="actionButton" action="#{styleController.revertChanges}">

    <f:ajax execute="@this" onstart="return method();" render="styleCcFormtyleCcTable">

</h:commandButton> 
```

在调用 ajax 之前，它将运行我的 javascript 函数：`method()`

我需要让用户卡住，`method()`直到他在我的自定义确认对话框中单击`Yes`或`Now`按钮，然后返回 true 或 false。

知道如何解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T23:00:29.563

您需要挂钩按钮的`onclick`处理程序，以便能够通过返回`true`或`false`相应地阻止按钮的默认操作。一旦ajax请求被执行，阻止它已经太迟了。

这是一个使用 JavaScript 内置[`confirm()`](https://developer.mozilla.org/en/DOM/window.confirm)函数的启动示例。

```
<h:commandButton ... onclick="return confirm('Are you sure?')">
    <f:ajax execute="@this" render="styleCcFormtyleCcTable" />
</h:commandButton> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:51:21.073

我知道你们中的一些人不会同意我的观点，因为我做了一个巨大的解决方法来让它工作。

我所做的是：

我创建了一个自定义确认对话框，它有一个存储用户回复的变量。然后，每当用户单击按钮时，它将被存储在那里。

因此，在按钮中，我添加了一个单击函数来检查我的变量，如果它有任何回复，它就会去做一些事情，但我不会调用我的自定义对话框。

在我的自定义对话框中，我正在“单击”按钮，但现在有了回复。之后，您需要确保将擦除该变量。

只是。2 天这样做 oO 如果你们需要代码，请告诉我。

# vb6 - 取消选择 DataGrid 中的选定行

> ID：10807662
> 
> 赞同：0
> 
> 时间：2012-05-29T22:33:06.267
> 
> 标签：vb6

我正在维护一个旧的 VB 窗口应用程序。我有datagrid（不是datagridview），我通过右键单击选择一行，但是当我右键单击其他一些行时，该行也显示为选中状态，我只需要选择一行，而不是两者。我使用 DataGrid1.Select(currentSelectedRow)，它将选择行。还有第二种方法取消选择，但需要行号。当我移动鼠标时，行号会发生变化。是否有任何重置或任何其他方式来重置数据网格行选择。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T12:09:57.577

遍历数据网格中的所有行并取消选择所有接受新选择的行。

# php - PHP：如果语句返回 True 而不是 False

> ID：10807665
> 
> 赞同：0
> 
> 时间：2012-05-29T22:33:17.030
> 
> 标签：php, arrays

我有一个名为 as 的数组`myArr`。它包含字符串和整数，例如

```
0  st ts 0  0
st 0  0  0  0 
```

为了调试 php 脚本，我使用 Zend Studio。调试窗口说 a`cell [0][0]`包含 int 0。但问题是 IF 语句返回 TRUE。

```
 for ($i = 0; $i < $rows; $i++) {
          for ($j = 0; $j < $cols; $j++) {
            if ($myArr[$i][$j] == 'ts' || $myArr[$i][$j] == 'st') {
                $num++;
            }
          }
        } 
```

更新：我在 Zend Studio 的调试模式下运行代码。所以，我可以看到 $num 在每次迭代中都在增加。另外，我可以看到光标进入循环

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-29T22:37:27.417

因为`0 == 'ts'`是`true`。您需要使用相等比较`===`。否则，PHP 的类型杂耍会导致该语句的计算结果为`true`.

请参阅[此演示](http://codepad.viper-7.com/ICEqKZ)以说明 if 语句评估为`true`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T22:39:44.173

当将字符串与整数进行比较时，字符串将自动转换为整数，在您的情况下，字符串没有数字，因此它将被评估为零以满足相等性，您有两个选择：

`if ('0' == 'tr')`

**或者**

`if (0 === 'tr')`

=== 表示检查 value 和**type**。

我还[从 PHP 手册](http://www.php.net/manual/en/language.types.string.php#language.types.string.conversion)中发现这对您很有帮助：

> 该值由字符串的初始部分给出。如果字符串以有效的数字数据开头，这将是使用的值。否则，该值将为 0（零）

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-29T22:39:43.937

任何与 0 相比的字符串都是真的

# ruby-on-rails - Ruby (Rack) 应用程序无法启动错误

> ID：10807666
> 
> 赞同：0
> 
> 时间：2012-05-29T22:33:22.413
> 
> 标签：ruby-on-rails, ruby, apache, passenger, rack

我在 /home/insane-36/.rvm 目录中安装了 ruby​​ 和 gems。我安装了passenger gem，并在apache mod-available 中创建了passenger.load 和passenger.conf 文件，并为apache 启用了mod。这些文件的内容如下；

**载客量**

LoadModule 乘客模块 /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/ext/apache2/mod_passenger.so

**乘客配置文件**

PassengerRoot /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12 PassengerRuby /home/insane-36/.rvm/wrappers/ruby-1.9.3-p194/ruby

然后，我在 /home/insane-36/www/testing 位置为 /var/www/testing 的应用程序创建了一个符号链接。我还创建了一个文件来启用该站点；

```
<VirtualHost *:80>
    ServerAdmin admin@example.com
    ServerName testing
    DocumentRoot /var/www/testing/public/   
    <Directory /var/www/testing/public/>
      Options Indexes +ExecCGI FollowSymLinks 
      Order allow,deny
      Allow from all
    </Directory>
</VirtualHost> 
```

然后启用该站点并重新启动服务器，但它给了我一个错误，说无法启动 ruby​​ (rack) 应用程序。我一直在搜索互联网并找到了一些解决方案，但对我没有任何帮助。我认为这是权限问题。我不知道应该设置什么权限。我想这些文件应该可供 apache 用户使用。并尝试修改权限，但出现相同的错误。详细日志如下；

```
A source file that the application requires, is missing.
It is possible that you didn't upload your application files correctly. Please check whether all your application files are uploaded.
A required library may not installed. Please install all libraries that this application requires.
Further information about the error may have been written to the application's log file. Please check it in order to analyse the problem.
Error message:
cannot load such file -- rubygems/path_support
Exception class:
LoadError
Application root:
/var/www/testing
Backtrace:
#   File    Line    Location
0   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems.rb    395 in `paths'
1   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems.rb    416 in `path'
2   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb  382 in `dirs'
3   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb  267 in `_all'
4   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb  410 in `each'
5   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb  442 in `find'
6   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb  442 in `find_by_path'
7   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems.rb    206 in `try_activate'
8   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb 59  in `rescue in require'
9   /home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb 35  in `require'
10  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/utils.rb  241 in `prepare_app_process'
11  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/rack/application_spawner.rb   156 in `block in initialize_server'
12  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/utils.rb  572 in `report_app_init_status'
13  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/rack/application_spawner.rb   154 in `initialize_server'
14  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb    204 in `start_synchronously'
15  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb    180 in `start'
16  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/rack/application_spawner.rb   129 in `start'
17  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb  253 in `block (2 levels) in spawn_rack_application'
18  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server_collection.rb 132 in `lookup_or_add'
19  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb  246 in `block in spawn_rack_application'
20  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server_collection.rb 82  in `block in synchronize'
21      prelude>    10:in `synchronize'
22  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server_collection.rb 79  in `synchronize'
23  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb  244 in `spawn_rack_application'
24  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb  137 in `spawn_application'
25  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb  275 in `handle_spawn_application'
26  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb    357 in `server_main_loop'
27  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb    206 in `start_synchronously'
28  /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/helper-scripts/passenger-spawn-server   99  in `' 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T01:35:51.453

这就是我在本地部署应用程序的方式。

```
sudo gem install passenger
sudo apt-get install apache2-dev libapr1-dev libaprutil1-dev
sudo passenger-install-apache2-module 
```

**/etc/apache2/mods-available/passenger.load**

```
LoadModule passenger_module /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12/ext/apache2/mod_passenger.so 
```

**/etc/apache2/mods-available/passenger.conf**

```
PassengerRoot /home/insane-36/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.12 
PassengerRuby /home/insane-36/.rvm/wrappers/ruby-1.9.3-p194/ruby 
```

现在，启用 apache 的 mod-passenger 为；

```
> sudo a2enmod passenger 
```

在 /home/insane-36/www/ 中创建了一个 rails 应用程序

**rails new testing -T -D mysql**

在 /var/www/ 文件夹中创建了指向应用程序的符号链接；

> ln -s /home/insane-36/www/testing /var/www/testing

在 /etc/apache2/sites-available/testing 中创建了一个文件

```
<VirtualHost *:80>
        ServerAdmin admin@example.com
        ServerName testing
        DocumentRoot /var/www/testing/public/   
    <Directory /var/www/testing/public/>
     Options Indexes +ExecCGI FollowSymLinks 
         Order allow,deny
         Allow from all
    </Directory>
</VirtualHost> 
```

启用网站使用，

> sudo a2ensite 测试

在 /etc/apache2/sites-available/testingthe 站点中添加了为 /etc/hosts 文件选择的服务器名称并创建了一个文件；

> 测试 127.0.0.1

注意：请务必启用当前用户目录的权限 755。

> chmod 755 /home/insane-36

```
 bundle exec rake assets:precompile to compile your assets periodically. 
```

我这里还是有问题。我已经设法使应用程序工作。但是，每次我对应用程序进行更改时，我都需要重新加载服务器。是否有一些方法可以处理这个问题，以便服务器自动跟踪正在更改的文件，然后重新加载服务器或合并更改。

如果我添加了空文件 tmp/restart.txt ，建议的一些注释应该适用于重新启动应用程序并带来更改，但对我不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:16:59.177

我认为您需要删除与 ruby​​gem 相关的所有内容

```
/home/insane-36/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1 
```

# java - 从现有的 CXF 休息服务生成 wadl

> ID：10807668
> 
> 赞同：4
> 
> 时间：2012-05-29T22:33:44.177
> 
> 标签：java, cxf, jax-rs

我有使用 CXF 实现的工作 JAX-RS 服务。如何生成 wadl？或者已经有类似球衣 [http://path.to.your/restapp/application.wadl](http://path.to.your/restapp/application.wadl)的东西了？是否有一个 maven 插件，就像 wsdl、java 到 wsdl？我已经搜索了无法找到的答案。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-29T23:04:03.497

如果您使用的是最新版本的 CXF，只需使用 ?_wadl 参数访问该服务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-30T09:51:15.970

使用 CXF 生成 WADL 的方法有很多：

1.  您可以将 REST 调用（例如使用[Postman](https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en)）发送到基本 REST URL，它会自动为那里的所有可用服务创建 WADL。它可以帮助构建 REST API。例如：
    *   [http://app.com/purchase/?_wadl](http://app.com/purchase/?_wadl) - 为购买 API 创建 WADL
    *   [http://app.com/profile/?_wadl](http://app.com/profile/?_wadl) - 为用户配置文件 API 创建 WADL
2.  CXF 3.0.0 和 2.7.11 引入了 java2wadl 插件，用于在构建时生成 WADL。详情可在[此处](http://cxf.apache.org/docs/jaxrs-services-description.html#JAXRSServicesDescription-java2wadlMavenplugin)找到。
3.  CXF 有关 WADL 的所有可用功能都位于[CXF 文档](http://cxf.apache.org/docs/jaxrs-services-description.html)中。

生成 WADL 后，最好将 XML 转换为更易读的形式。我发现的解决方案之一是使用 XSL 生成 HTML。我使用了来自[github 项目](https://github.com/ipcsystems/wadl-stylesheet)的 XSL 。将 XSL 链接到 XML 并生成漂亮的 HTML 报告的步骤：

1.  下载wadl.xsl；
2.  将wadl.xsl复制到CXF生成的wadl.xml文件所在的文件夹中；
3.  将所需的 wadl.xml 标头添加到文件的最开头：

    `<?xml version="1.0" encoding="UTF-8"?>`

    `<?xml-stylesheet type="text/xsl" href="wadl.xsl"?>`

4.  使用 wadl.xml 替换生成的`<application ...>`标头 `<wadl:application xmlns:wadl="http://wadl.dev.java.net/2009/02" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://wadl.dev.java.net/2009/02 wadl.xsd ">`

5.  添加到每个标签“wadl”命名空间。例如：

    `<resource>`->`<wadl:resource>`

    `</resource>`->`</wadl:resource>`

6.  使用 IE 打开 wadl.xml

7.  你会得到这样的东西（来自[github 项目](https://github.com/ipcsystems/wadl-stylesheet)的 example_wadl.xml ）： ![从 WADL 文件生成的 HTML 页面](../Images/081a91062f48e31a4e28c44043cc7562.png)

# java - 无法设置 ActionBarSherlock 库

> ID：10807670
> 
> 赞同：2
> 
> 时间：2012-05-29T22:33:55.040
> 
> 标签：java, android, eclipse

我从源代码创建了一个新的 android 项目，当我单击完成时，我最终遇到了 204 个错误，我相信每个错误都在描述方法的问题。

此外，当我尝试将其添加为库时，它不会出现。

那么我做错了什么？

编辑：

* * *

感谢 CommonsWare，我不再收到错误，但我仍然无法添加库。

![问题截图](../Images/4b114b9663d967e1ba1bba26242b50ee.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T22:38:18.973

您的编译器合规性可能设置为 Java 1.5。我强烈建议总体上切换到 Java 1.6，而且 ActionBarSherlock 肯定需要它。在 Java 1.5 中，您不能`@Override`在接口上定义方法——在 Java 1.6 中可以。

对于这个单独的项目，转到 Project > Properties > Java Compiler 并调整“Compiler Compliance Level”。

# c++ - const func (const scalar& a) const 中的三个“const”，为什么？

> ID：10807671
> 
> 赞同：3
> 
> 时间：2012-05-29T22:33:56.097
> 
> 标签：c++

新手来了！

我正在阅读代码，我看到作者经常将成员函数编写为

```
const int func (const scalar& a) const
// etc 
```

你看这里有三个 const，现在我理解了中间的一个，const scalar& a，它的目的是不改变对象 a，但是另外两个 const 呢？

我应该一直这样做，以保护 blahblah 不变，这是一个好习惯吗？

非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T22:48:36.853

您发布的代码无效，无法编译。但是，如果您考虑

```
class MyClass {
  const int& func (const scalar& a) const {
    // ...
  }
}; 
```

第一个`const`将指定返回值是常量（即不可变）。第二个`const`( `const scalar& a`) 指定函数不修改参数值的值`a`。第三个 const 指定它`func`是一个常量成员函数，即它不修改`MyClass`实例本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T06:12:28.427

由于还没有人提到它：两者之间绝对没有区别

```
const int some_function(); 
```

和

```
int some_function(); 
```

on标`const`量返回类型（例如`int`）被忽略；它只对类类型很重要。[有关的](https://stackoverflow.com/questions/2169932/)

# iphone - uibutton不会禁用？

> ID：10807675
> 
> 赞同：1
> 
> 时间：2012-05-29T22:34:02.290
> 
> 标签：iphone, objective-c, xcode, uiscrollview, uibutton

我以编程方式创建了一个 UIButton 并将其添加到 UIScrollView 的子视图中。稍后在代码的不同部分中，我需要禁用该按钮。但是，当我尝试返回该按钮时，它不会禁用。

继承人一些代码：

*标题：*

```
UIButton *button1; 
```

*主要的：*

```
 button1 = [[UIButton buttonWithType:UIButtonTypeCustom] retain];
 [button1 addTarget:self action:@selector(buttonStuff) forControlEvents:UIControlEventTouchUpInside];
 [scrollView addSubview:button1]; 
```

*当我尝试禁用 button1 时：*

```
 NSLog(@"Hidden state: %i", button1.hidden);  //------> returns "0" 
        button1.enabled = NO;
        button1.hidden = YES;
        NSLog(@"Hidden state: %i", button1.hidden);  //------> returns "1", yet is not hidden on screen 
```

有趣的是，在最后一段代码中，在我隐藏按钮之前，我的 NSLog 返回一个 0（未隐藏）。然后，当我试图隐藏它时，NSLog 返回一个 1，表示该按钮已被隐藏——但它仍然在屏幕上完全可见，也没有被禁用。我很困扰。有人可以帮我解决我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:45:32.280

按钮隐藏代码是否被称为后台线程？UIKit 不是线程安全的；在主线程以外的线程上修改 UIKit 对象的属性可能会导致看不到视觉属性的更新，或者在看到更改之前可能会有很长的延迟。

您可以通过 确保方法在主线程上运行`-performSelectorOnMainThread:withObject:waitUntilDone:`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T06:26:39.833

你在滥用方法`tableView:numberOfRowsInSection:`。相反，您应该创建自己的方法并`[self.tableView reloadData];`从那里调用。

# iptables - 是否可以在 iptables 中使用计算机名

> ID：10807676
> 
> 赞同：2
> 
> 时间：2012-05-29T22:34:02.460
> 
> 标签：iptables, computer-name

我想将一些端口从 WAN 重定向到我的笔记本电脑。问题是，笔记本电脑的无线 IP 与有线 LAN 不同。有没有办法在 iptables 中使用计算机名？

iptables 端口转发规则（使用 IP）应该是：

```
iptables -t nat -A PREROUTING -p tcp -d 192.168.102.37 --dport 422 -j DNAT --to 192.168.102.37:22 
```

我可以写类似的东西吗

```
iptables -t nat -A PREROUTING -p tcp -d mycomputername --dport 422 -j DNAT --to mycomputername:22 
```

并且计算机名称将在当前IP中解析？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:41:02.993

否 - 尝试这样做会产生“错误的 IP 地址”（至少在 v 1.4.7 中）

iptables 似乎不喜欢目标地址和端口的组合。（您可以为简单的 IP 指定主机名，但在附加端口时似乎不行）。

IPTables 手册还建议不要指定域名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-16T15:25:58.197

这是一个糟糕的想法（但有一些解决方案（特定于 IP 和特定于 MAC），见下文）。正如其他答案所述，手册页建议不要这样做。但这不仅仅是安全性（DNS 本质上是不安全的） - 这也是性能损失。当然你可以有一个主机映射，但仍然指定 IP 是最好的（但即使这样：你可以覆盖或更确切地说指定哪个是首先使用 - dns 或主机，通常使用名称而不是 IP 是有风险的业务）。

但是，有两种可能的解决方案（IP 相关 - 如果您不能这样做，请参阅第三个）：首先，根据 MA​​C 地址分配 IP（或必要时的 IP）。

或者，您可以有两个不同的规则：毕竟，它是一条链；它会一直持续到得到答案为止。因此，只需指定两个规则，每个规则都有正确的 IP。这可能是理想的解决方案（可以说第一个解决方案大致相同）。啊，我刚才看到有人评论了静态IP。这确实是答案 - 您不会动态分配 IP。但是如果必须要有动态IP，还是有办法的：

如果您不能自己分配 IP（例如不受您的控制），您可以使用 iptables 的 mac 模块。有关更多信息，请参见手册页。

# ruby - 表单错误后如何将部分内容保留在同一页面上？

> ID：10807678
> 
> 赞同：0
> 
> 时间：2012-05-29T22:34:11.617
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.1

在我的`Business`模型中，当我尝试创建业务并发生错误时，我注意到在 POST 之后它摆脱了我的`shared/page_header`部分：

```
def page_title
  "#{@page_title}"
end

<% unless @page_title.blank? %>
<div class="row">
   <div class="page-header span12">
      <h1><%= @page_title %></h1>
   </div>
</div>
<% end %>

def new
  @business = Business.new
  @page_title = "Add Business"
end

def create
  @business = Business.new(params[:business])
  if @business.save
    redirect_to :back, :notice => "This Business was successfully added."
  else
    render :new, :notice => "It seems there was an error. Please try again."
  end
end 
```

现在我注意到我开始`/businesses/new`但在 POST 之后它转到`/businesses`. 有人告诉我这很正常，但直到现在我才看到这种行为。如果有帮助，`new`and操作是我资源`create`中唯一的操作。`Business`我该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T00:38:00.890

只需将 @page_title = "Add Business" 添加到您的创建方法中。“render :new” 渲染新模板但不执行新方法。

> 将 render 与 :action 一起使用是 Rails 新手经常感到困惑的原因。指定的操作用于确定要呈现哪个视图，但 Rails 不会在控制器中运行该操作的任何代码。您在视图中需要的任何实例变量都必须在调用渲染之前在当前操作中设置。来自[http://guides.rubyonrails.org/layouts_and_rendering.html#using-render](http://guides.rubyonrails.org/layouts_and_rendering.html#using-render)

# assembly - NASM 中的斐波那契 - 段错误

> ID：10807680
> 
> 赞同：-1
> 
> 时间：2012-05-29T22:34:32.057
> 
> 标签：assembly, segmentation-fault, nasm, fibonacci

我们必须在汇编中编码，这您可能很难知道。或者教授没有给我们任何关于如何正确编码或链接的信息。我们必须自学。明天我必须交作业。目的是将第 n 个斐波那契数打印到控制台。

```
section .data
    fmt: db "fib=%d",10,0

section .text
extern _printf
global _main, fib

_main:
    mov eax, 10     ; e.g. n=10
    mov ebx, 1      ; we know f_0 and f_1
    sub eax, ebx    ; thats why n--
    push eax        ; push n
    push 0      ; f_0 = 0 
    push 1      ; f_1 = 1

    call fib

    push eax        ; in eax the result is stored
    push fmt
    call _printf

    mov ebx, 0
    mov eax, 1      ; exit(0)
    int 0x80    

fib:
    mov ecx, eax
    pop esi
    calc:
    pop ebx
    pop edx
    add ebx, edx
    mov eax, ebx
    push edx
    push ebx
    sub ecx, 1
    cmp ecx, 0
    jne calc
    push esi
    ret 
```

在与链接器斗争之后，我终于设法组装和链接我的程序。但它不起作用 - 我每次都会遇到分段错误。

**编辑：** 更正的代码 - 我在控制台上得到了一些文本，但遗憾的是没有正确的数字它总是显示“fib = 1”并再次出现段错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:41:14.573

你有

```
push 0      ; f_0 = 0 
push 1      ; f_1 = 1

call fib 
```

然后

```
fib:
    mov ecx, eax
    calc:
    pop ebx
    pop edx 
```

你不能这样做——调用指令会将返回地址压入堆栈，这是你将在 fib 中弹出的第一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T03:12:33.767

我没有发现组装很难，而是我发现它简单直接。如果您的老师没有正确地教您，您最好在互联网上搜索信息。几年前，当我们大多数人开始工作时，没有那么多信息，所以我们通过反复试验来学习。

我建议您从简单开始并了解堆栈。将此用作工作示例：

```
 extern printf
    section .data
    msg:    db "Your sum is %d",10 ,0

    section .text
    global _start

    _start:
        push    20
        push    2
        push    6
        call    AddEm

        push    eax
        push    msg
        call    printf
        add     esp, 4 * 2  ; printf is C calling convention, we have to adjust stack

        mov     ebx, 0
        mov     eax, 1      ; exit(0)
        int     0x80    

    AddEm:
        push    ebp     ; set up a stack frame
        mov     ebp, esp    ; we could just use esp but we won't

        mov     eax, [ebp + 8]  ; 1st param - 6
        add     eax, [ebp + 12] ; 2nd param - 2
        add     eax, [ebp + 16] ; 3rd param - 20

        mov     esp, ebp    ; restore the stack
        pop     ebp
        ret     4 * 3       ; passed 3 params, clean up stack 
```

这就是我组装、链接和输出的方式。

![截屏](../Images/3bc0e7e106902a2a50c3fc95247972b4.png)

# c++ - 每 10 秒循环一次

> ID：10807681
> 
> 赞同：2
> 
> 时间：2012-05-29T22:34:34.343
> 
> 标签：c++

如何每 10 秒加载一个循环并将 +1 添加到计数并打印它？

像：

```
int count;
    while(true)
    {
       count +=1;
       cout << count << endl; // print every 10 second 
    } 
```

打印：

```
1
2
3
4
5
ect... 
```

我不知道怎么做，请帮帮我

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T22:48:07.447

我的尝试。（几乎）完美的 POSIX。也适用于 POSIX 和 MSVC/Win32。

```
#include <stdio.h>
#include <time.h>

const int NUM_SECONDS = 10;

int main()
{
    int count = 1;

    double time_counter = 0;

    clock_t this_time = clock();
    clock_t last_time = this_time;

    printf("Gran = %ld\n", NUM_SECONDS * CLOCKS_PER_SEC);

    while(true)
    {
        this_time = clock();

        time_counter += (double)(this_time - last_time);

        last_time = this_time;

        if(time_counter > (double)(NUM_SECONDS * CLOCKS_PER_SEC))
        {
            time_counter -= (double)(NUM_SECONDS * CLOCKS_PER_SEC);
            printf("%d\n", count);
            count++;
        }

        printf("DebugTime = %f\n", time_counter);
    }

    return 0;
} 
```

这样，您还可以控制每次迭代，这与基于 sleep() 的方法不同。

这种方案（或同样基于高精度定时器）也保证了计时没有误差累积。

编辑：OSX的东西，如果一切都失败了

```
#include <unistd.h>
#include <stdio.h>

const int NUM_SECONDS = 10;

int main()
{
    int i;
    int count = 1;
    for(;;)
    {
        // delay for 10 seconds
        for(i = 0 ; i < NUM_SECONDS ; i++) { usleep(1000 * 1000); }
        // print
        printf("%d\n", count++);
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T22:40:47.633

在 Windows 上，您可以使用`Sleep`from `windows.h`：

```
#include <iostream>
#include <windows.h>

int _tmain(int argc, _TCHAR* argv[])
{
    int count = 0;
    while(true)
    {
        count +=1;
        std::cout << count  << std::endl;
        Sleep(10000);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T22:36:53.113

使用`sleep()`：[http ://www.gnu.org/software/libc/manual/html_node/Sleeping.html](http://www.gnu.org/software/libc/manual/html_node/Sleeping.html)

```
int count = 0;
while(true)
{
    count++;

    cout << count << endl; // print every 10 second 
    sleep(10);

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T08:30:01.013

这是另一个使用 Windows [Waitable Timer](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687012%28v=vs.85%29.aspx)的示例。来自 MSDN 页面的简短引用：

> 可**等待计时器**对象是一个同步对象，其状态设置为在指定的到期时间到达时发出信号。可以创建两种类型的等待计时器：手动重置和同步。任一类型的计时器也可以是**周期性计时器**。

例子：

```
#include <Windows.h>
#include <iostream>

void main(int argc, char** argv)
{
    HANDLE hTimer = NULL;
    LARGE_INTEGER liTimeout;

    // Set timeout to 10 seconds
    liTimeout.QuadPart = -100000000LL;

    // Creating a Waitable Timer
    hTimer = CreateWaitableTimer(NULL, 
                                 TRUE,              // Manual-reset
                                 "Ten-Sec Timer"    // Timer's name
                                );
    if (NULL == hTimer)
    {
        std::cout << "CreateWaitableTimer failed: " << GetLastError() << std::endl;
        return;
    }

    // Initial setting a timer
    if (!SetWaitableTimer(hTimer, &liTimeout, 0, NULL, NULL, 0))
    {
        std::cout << "SetWaitableTimer failed: " << GetLastError() << std::endl;
        return;
    }

    std::cout << "Starting 10 seconds loop" << std::endl;

    INT16 count = 0;
    while (count < SHRT_MAX)
    {
        // Wait for a timer
        if (WaitForSingleObject(hTimer, INFINITE) != WAIT_OBJECT_0)
        {
            std::cout << "WaitForSingleObject failed: " << GetLastError() << std::endl;
            return;
        }
        else 
        {
            // Here your code goes
            std::cout << count++ << std::endl;
        }

        // Set a timer again
        if (!SetWaitableTimer(hTimer, &liTimeout, 0, NULL, NULL, 0))
        {
            std::cout << "SetWaitableTimer failed: " << GetLastError() << std::endl;
            return;
        }
    }
} 
```

此外，您可以将**Waitable Timer**与**异步过程调用**一起使用。请参阅MSDN 上的[此](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686898%28v=vs.85%29.aspx)示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T22:41:43.457

正如其他人所说，您需要一个 sleep() 函数。但是可能会出现跨平台问题。我找到了关于这个问题的[这个帖子](https://stackoverflow.com/questions/6134679/delaying-for-milliseconds-in-c-cross-platform)，你可能想看看。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-07T22:37:20.153

在 C++11（或 14）及更高版本中，您还获得了`chrono`带有标准库的库，因此您可以调用它，这对于多线程也非常有用：

```
#include <chrono>

for (;;)
{
  std::this_thread::sleep_for(std::chrono::milliseconds(1000));
  if (someEndCondition)
    break;
} 
```

# mongodb - MongoDB - 查询日期范围总是返回相同的数字

> ID：10807685
> 
> 赞同：0
> 
> 时间：2012-05-29T22:34:58.233
> 
> 标签：mongodb

我有这个查询：

```
db.users.count(  { confirmed_at : { $gt: start  } } , { confirmed_at : { $lt:  end  } }  ); 
3750 
```

无论我将日期设置为：

```
var end = new Date(2011, 1, 12); 
```

查询返回相同的数字作为结果。

为什么会这样？难道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:41:42.220

我认为你需要连接这两个条件

```
db.users.count({confirmed_at: {$gte: start, $lt: end}}) 
```

获取范围查询。但这是理论上的，目前还没有机会测试！试试看！

# windows-ce - MMF（独占/非共享内存映射文件）

> ID：10807688
> 
> 赞同：1
> 
> 时间：2012-05-29T22:35:26.077
> 
> 标签：windows-ce, win32-process, .net-cf-3.5, windows-nt

我们的应用程序在 WinCE5.0 上运行（用 .net cf 编写）

由于某些原因，我们必须创建 MMF 文件供我们的应用程序使用（MMF 文件只能由我们的应用程序使用）。

现在我们注意到，在随机时间（我们无法准确找到何时以及在何种情况下）MMF 文件被其他进程使用，该进程将数据写入其上。这使我们的 MMF 文件损坏。

请让我们知道如何避免这种情况。

换句话说，我们希望 MMF 专门用于我们的应用程序，而不是共享。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T01:46:11.810

Windows CE 上的内存映射文件总是映射在虚拟地址空间的共享文件映射区域中。所有进程都可以对该区域进行读写访问。您无法保护该区域不被另一个进程覆盖。

.NET Compact Framework 本身使用内存映射来映射该区域中已加载的程序集，以避免将它们加载到进程槽中。我希望您会遇到其他问题，例如获取`TypeLoadException`,`MissingMethodException`或`ExecutionEngineException`当 .NETCF 尝试从已损坏的程序集中 JIT 代码时。

您确定您没有关闭文件映射句柄或底层文件句柄吗？这可能会导致 Windows 认为内存是空闲的，并将其重用于其他目的。

# c# - RC2 加密和数据包分隔符

> ID：10807690
> 
> 赞同：1
> 
> 时间：2012-05-29T22:35:28.747
> 
> 标签：c#, sockets, encryption, rc2-cipher

我正在开发一个客户端/服务器应用程序，并且两者之间的通信是加密的。我正在使用 RC2 加密，因为客户端是嵌入式的并且 CPU 资源是有限的。我正在使用 System.Security.Cryptography.RC2CryptoServiceProvider.CreateDecryptor/CreateEncryptor 方法来创建加密类。

我的问题源于 TCP 倾向于将消息拆分为多个数据包。因为整个消息可能不会在一次 Socket.Receive() 调用中到达，所以我需要在出站数据包的末尾包含一个数据包分隔符，以便接收端可以知道数据包的结束位置（当前使用 0x0D）。但是，RC2 加密最终会在负载中的某处创建 0x0D，导致接收端将数据包解释为已完成。当它试图解密这个被截断的数据包时，它失败了。

关于通常如何处理这类事情的任何建议？或者甚至只是一个已知 RC2 加密不会产生我可以用作分隔符的字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:43:18.683

使用 GregS 的建议在加密数据包前加上长度标头，并将数据包分隔符放在加密数据包之后以进行完整性检查。谢谢！

# python - Python父类访问子私有变量

> ID：10807692
> 
> 赞同：5
> 
> 时间：2012-05-29T22:35:38.010
> 
> 标签：python, oop, class, inheritance

以下代码生成错误：

```
class A(object):
    def say_something(self):
        print(self.foo)
        print(self.__bar)

class B(A):
    def __init__(self):
        self.foo = 'hello'
        self.__bar = 'world'

test = B()
test.say_something() 
```

'hello' 打印成功，但 'world' 生成以下错误：

```
 print(self.__bar) 
```

> AttributeError：“B”对象没有属性“_A__bar”

我对此感到惊讶，我希望我的父类有一个可以访问其子级保证拥有的私有属性的方法。有没有解决这个问题的标准方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-29T22:39:04.817

您可以使用`self._B__something`它来访问它。然而，这不是你应该做的。正确的解决方案是重命名`__bar`为`_bar`.

[双下划线名称修饰](http://docs.python.org/tutorial/classes.html#private-variables-and-class-local-references)背后的想法是避免与子类/超类发生冲突——它并不意味着用于私有变量。如果应将变量视为私有/内部变量，请在其前面加上一个下划线。这不会引起任何特殊处理，但每个 python 开发人员都会知道它不是包含该变量的类/模块的公共 API 的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:40:19.350

就是名字改写。任何以双下划线开头的成员都会在 Python 中被破坏名称。您的代码可以与任何其他成员一起使用，只要它们不以双下划线开头。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T22:39:35.547

我怀疑您的代码中缺少某些内容..我在 A 类或 B 类中都没有看到 __bar ..

# c# - SQlite 更新添加了一些

> ID：10807700
> 
> 赞同：0
> 
> 时间：2012-05-29T22:36:35.883
> 
> 标签：c#, sqlite

我正在尝试向表中添加一些浮点值。使用 Sqlite 更新命令

```
 float Cu= row.Cells["Cu"].Value != null && float.TryParse(row.Cells["Cu"].Value.ToString(), out Cu) ? Cu: 0; 
```

所以在这里我确保行中的值不为空并且也是浮动的。如果为真，则插入该值，否则插入 0。

```
 Sqlite Update command
     insCmdVesselData.Parameters.AddWithValue("@Copper",Cu);
  public string SQL_updateVesselData = @"UPDATE
             [VesselData]
            SET

    [Copper]=@Copper,
    [Nickel]=@Nickel,
    [Phosphorous]=@Phosphorous,
    [Silicon]=@Silicon,
[Manganese]=@Manganese,

where

         [PlantId] = @PlantId and FileId= @FileId

Here Copper,Nickel is a Numeric in the Database. 
Suppose my value of Cu=0.07, during this update, it is adding a number 0.0700000002980232\. it the value is 0.5, it updates with 0.529999971389771\. Not sure y its adding all these garbage at the end 
```

谢谢你孙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:44:22.970

我使用十进制而不是浮点数，它解决了问题

# php - “资源解释为图像但使用 MIME 类型文本/html 传输”的非常奇怪的问题

> ID：10807705
> 
> 赞同：3
> 
> 时间：2012-05-29T22:36:44.083
> 
> 标签：php, image, upload, load, mime

我检查了很多关于这个问题的帖子，但没有与我的匹配。

我正在测试我的项目并收到此警告或错误（我不完全知道）

```
Resource interpreted as Image but transferred with MIME type text/html 
```

来自同一文件夹的一些图像已加载，但有些则没有。

[这是网站](http://web-art.netau.net/)- 一个上传网站

10 分钟前还没有这个问题，但现在它不知从何而来。

即使在我测试这个网站数百次的电脑上。

而且我确定这不是 .htaccess 问题。

我能做些什么呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:47:09.663

您正在构建图像并将其发送到 through `count.php`，但您没有更改标题以反映适当的 mime 类型。您需要更改标头以反映响应本身中的内容类型。

例子：

我想通过 PHP 脚本发送一个 PNG 文件，所以我需要设置 content-type 来反映这一点：

```
$im = imagecreatefrompng("test.png");
header('Content-Type: image/png');
imagepng($im);
imagedestroy($im); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T14:45:07.507

我有同样的问题，但在我在谷歌中进行了深入搜索后，问题得到了解决。这个技巧可能对你们中的一些有同样问题的人有所帮助。我摆弄了 Apache httpd.conf 文件。请转到文件的以下部分：

```
</IfModule> mime_module>
#
# TypesConfig points to the file containing the list of mappings from
# filename extension to MIME-type.
#
TypesConfig conf/mime.types

#
# AddType allows you to add to or override the MIME configuration
# file specified in TypesConfig for specific file types.
#
#AddType application/x-gzip .tgz
#
# AddEncoding allows you to have certain browsers uncompress
# information on the fly. Note: Not all browsers support this.
#
#AddEncoding x-compress .Z
#AddEncoding x-gzip .gz .tgz
#
# If the AddEncoding directives above are commented-out, then you
# probably should define those extensions to indicate media types:
#
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz

#
# AddHandler allows you to map certain file extensions to "handlers":
# actions unrelated to filetype. These can be either built into the server
# or added with the Action directive (see below)
#
# To use CGI scripts outside of ScriptAliased directories:
# (You will also need to add "ExecCGI" to the "Options" directive.)
#
AddHandler cgi-script .cgi

# For type maps (negotiated resources):
#AddHandler type-map var

#
# Filters allow you to process content before it is sent to the client.
#
# To parse .shtml files for server-side includes (SSI):
# (You will also need to add "Includes" to the "Options" directive.)
#
#AddType text/html .shtml
#AddOutputFilter INCLUDES .shtml
AddType application/x-httpd-php .php
AddType application/x-httpd-php .phtml

</IfModule> 
```

确保在没有 POUND(#)KEY 的上述模块中添加以下 AddTypes。当您将它们添加到模块中时，请不要在以下任何 AddTypes 前面使用 # 键，这样 Apache 服务器会读取它们：

```
AddType image/gif .gif

AddType image/jpeg .jpeg .jpg

AddType image/png .png 
```

# php - 在循环中回显会话数组不起作用

> ID：10807708
> 
> 赞同：0
> 
> 时间：2012-05-29T22:37:08.760
> 
> 标签：php, arrays, session

我在回显会话数组时遇到了一个奇怪的问题。我想完成以下任务：

```
for($i=0;$i<sizeof($_SESSION['medication']);$i++){
    echo $_SESSION['medication'][$i];
} 
```

事实上，它会回显数组的所有字段，然后*显示*众所周知的错误消息“可捕获的致命错误：stdClass 类的对象无法转换为字符串”。

但是，当我在循环中一直回显字段 0 而不是字段 $i 时，它可以正常工作而不会出现错误消息。

为什么会触发错误消息？

更新 1

`var_dump($_SESSION['medication'])`回响出一堆东西：

```
array(12) { [0]=> string(1) "1" [1]=> int(10) [2]=> string(2) "14" [3]=> string(2) "17" [4]=> object(stdClass)#1 (7) { ["id"]=> string(1) "1" ["name"]=> string(9) "AUGMENTIN" ["strength"]=> string(6) "875 mg" ["sig"]=> string(29) "1 tablet by mouth twice a day" ["quantity"]=> string(6) "twenty" ["refills"]=> string(4) "zero" ["treatmentfor"]=> string(17) "sinus, bronchitis" } [5]=> object(stdClass)#2 (7) { ["id"]=> string(2) "10" ["name"]=> string(8) "DIFLUCAN" ["strength"]=> string(6) "150 mg" ["sig"]=> string(47) "1 tablet by mouth as needed for yeast infection" ["quantity"]=> string(3) "one" ["refills"]=> string(3) "one" ["treatmentfor"]=> string(27) "yeast, other abx for female" } [6]=> object(stdClass)#3 (7) { ["id"]=> string(2) "14" ["name"]=> string(14) "MEDROL DOSEPAK" ["strength"]=> string(1) "-" ["sig"]=> string(135) "6 PO Qday x 1 day, then 5 PO Qday x 1 day, then 4 PO Qday x 1 day, then 3 PO Qday x1 day, then 2 PO Qday x 1 day then 1 PO Qday x 1 day" ["quantity"]=> string(2) "21" ["refills"]=> string(4) "zero" ["treatmentfor"]=> string(17) "allergic rhinitis" } [7]=> object(stdClass)#4 (7) { ["id"]=> string(2) "17" ["name"]=> string(23) "FLUTICASONE NASAL SPRAY" ["strength"]=> string(6) "0.0005" ["sig"]=> string(91) "1 spray each nostril twice a day, reducing to 1 spray per nostril per day when appropriate." ["quantity"]=> string(10) "one bottle" ["refills"]=> string(3) "one" ["treatmentfor"]=> string(17) "allergic rhinitis" } [8]=> object(stdClass)#5 (7) { ["id"]=> string(1) "1" ["name"]=> string(9) "AUGMENTIN" ["strength"]=> string(6) "875 mg" ["sig"]=> string(29) "1 tablet by mouth twice a day" ["quantity"]=> string(6) "twenty" ["refills"]=> string(4) "zero" ["treatmentfor"]=> string(17) "sinus, bronchitis" } [9]=> object(stdClass)#6 (7) { ["id"]=> string(2) "10" ["name"]=> string(8) "DIFLUCAN" ["strength"]=> string(6) "150 mg" ["sig"]=> string(47) "1 tablet by mouth as needed for yeast infection" ["quantity"]=> string(3) "one" ["refills"]=> string(3) "one" ["treatmentfor"]=> string(27) "yeast, other abx for female" } [10]=> object(stdClass)#7 (7) { ["id"]=> string(2) "14" ["name"]=> string(14) "MEDROL DOSEPAK" ["strength"]=> string(1) "-" ["sig"]=> string(135) "6 PO Qday x 1 day, then 5 PO Qday x 1 day, then 4 PO Qday x 1 day, then 3 PO Qday x1 day, then 2 PO Qday x 1 day then 1 PO Qday x 1 day" ["quantity"]=> string(2) "21" ["refills"]=> string(4) "zero" ["treatmentfor"]=> string(17) "allergic rhinitis" } [11]=> object(stdClass)#8 (7) { ["id"]=> string(2) "17" ["name"]=> string(23) "FLUTICASONE NASAL SPRAY" ["strength"]=> string(6) "0.0005" ["sig"]=> string(91) "1 spray each nostril twice a day, reducing to 1 spray per nostril per day when appropriate." ["quantity"]=> string(10) "one bottle" ["refills"]=> string(3) "one" ["treatmentfor"]=> string(17) "allergic rhinitis" } } 
```

更新 2

我发现了问题：稍后在代码中我使用变量 $medication 似乎是指会话。怎么会？register_globals 开启了吗？

UPDATE 3 - SOLUTION FOUND register_globals 确实打开了（多么尴尬），我把它关掉了。它与另一个变量 $medication 相关。现在它工作正常。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:41:19.363

为什么要尝试使用 a 遍历数组`for`？`foreach`专门设计用于迭代数组。

尝试：

```
foreach($_SESSION['medication'] as $foo){
    echo $foo;
} 
```

您可能会`$_SESSION['medication']`按照其他人的建议存储一个对象。您应该尝试`var_dump($_SESSION['medication']);`查看其中实际存储的内容，如果其中实际上有一个对象 ( `stdClass`)，则您需要在运行循环之前将其删除，因为您无法回显类。

编辑：

`$_SESSION['medication'][4]`并且之后的所有元素都包含一个对象作为值，除了回显它之外，您还必须做一些事情（尝试 print_r 就像其他人建议的那样）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:41:33.753

我的猜测是，除了存储在会话数组的索引中的字符串之外，还有其他内容。在这种情况下，您似乎`stdClass`在数组中有一个对象。

此外，由于您可以使用非数字数组索引，因此使用 foreach 循环将产生更好的结果。

```
foreach($_SESSION['medication'] as $index => $value) {
    if (is_scalar($value)) {
        echo "$index = $value<br />";
    } else {
        echo "<pre>$index = " . print_r($value, true) . "</pre><br />";
    }
} 
```

[is_scalar](http://php.net/is_scalar)将检查变量是否可以回显（字符串、整数、浮点数、布尔值），否则我们将打印_r[值](http://php.net/print_r)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:41:13.647

该会话数组中有一个 StdClass 类型的对象无法回显

另外，使用[foreach](http://php.net/manual/en/control-structures.foreach.php)

# java - Android 初学者：XML 底部的广告

> ID：10807714
> 
> 赞同：0
> 
> 时间：2012-05-29T22:37:58.293
> 
> 标签：java, android, eclipse, android-layout, admob

> **可能重复：**
> [Android初学者：防止admob向上推送内容](https://stackoverflow.com/questions/10808143/android-beginner-prevent-admob-from-pushing-content-up)

我是android新手，所以请多多包涵。我正在创建一个带有一系列按钮的应用程序作为主页。每当广告加载时，它都会在按钮下方笨拙地加载并将广告向上推。如何将 adlayout 推到屏幕底部？

这是代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:orientation="vertical" android:background="@drawable/background_hdpi" android:layout_width="fill_parent" android:layout_height="fill_parent" android:weightSum="7.0"
  xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads">
    <Button android:textSize="16.0sp" android:layout_gravity="center_horizontal" android:id="@+id/basics1" android:layout_width="150.0dip" android:layout_height="0.0dip" android:layout_marginTop="100.0dip" android:layout_marginBottom="2.0dip" android:text="Overview" android:layout_weight="1.0"/>
    <Button android:textSize="16.0sp" android:layout_gravity="center_horizontal" android:id="@+id/basics2" android:layout_width="150.0dip" android:layout_height="0.0dip" android:layout_margin="2.0dip" android:text="Campaign" android:layout_weight="1.0"/>
    <Button android:textSize="16.0sp" android:textColor="#ff000000" android:layout_gravity="center" android:id="@+id/basics3" android:layout_width="150.0dip" android:layout_height="0.0dip" android:layout_margin="2.0dip" android:text="Special Ops" android:layout_weight="1.0"/>
    <Button android:textSize="16.0sp" android:textColor="#ff000000" android:layout_gravity="center_horizontal" android:id="@+id/basics4" android:layout_width="150.0dip" android:layout_height="0.0dip" android:layout_margin="2.0dip" android:text="Zombies" android:layout_weight="1.0"/>
    <Button android:textSize="16.0sp" android:textColor="#ff000000" android:layout_gravity="center_horizontal" android:id="@+id/basics5" android:layout_width="150.0dip" android:layout_height="0.0dip" android:layout_margin="2.0dip" android:text="Modes" android:layout_weight="1.0"/>
    <Button android:textSize="16.0sp" android:textColor="#ff000000" android:layout_gravity="center_horizontal" android:id="@+id/basics6" android:layout_width="150.0dip" android:layout_height="0.0dip" android:layout_margin="2.0dip" android:text="Ranks/Unlocks" android:layout_weight="1.0"/>

    <LinearLayout android:layout_width="fill_parent"
                  android:id="@+id/ad_layout"
                  android:layout_height="wrap_content"
                  android:gravity="bottom"
                  android:layout_alignParentBottom="true">

        <com.google.ads.AdView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            ads:adSize="BANNER"
            ads:adUnitId="id"
            ads:loadAdOnCreate="true" >
        </com.google.ads.AdView>

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:43:31.477

使用相对布局作为主要布局。然后，您可以相对于底部定位广告。然后使用广告上方的线性布局。

像这样的东西

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
     <com.google.ads.AdView
        android:id="@+id/ad"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        ads:adSize="BANNER"
        ads:adUnitId="id"
        ads:loadAdOnCreate="true">
    </com.google.ads.AdView>

    <LinearLayout
            android:id="@android:id/list"
            android:layout_alignParentTop="true"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_above="@id/ad">

     PUT BUTTONS ETC HERE

    </LinearLayout>

</RelativeLayout> 
```

# ios - UIScrollView 灵活高度

> ID：10807716
> 
> 赞同：0
> 
> 时间：2012-05-29T22:38:12.517
> 
> 标签：ios, objective-c, iphone

我有一个 UIScrollView，其中有一个 UIImageView 和一个 UILabel，它们都是 sizeToFit。如何在 UIImageView 和 UILabel 的高度的基础上设置 UIScrollView 自动调整大小的高度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:11:15.817

在 的每个子视图中循环`UIScrollView`，并获取每个项目的高度，然后将其设置为`ScrollView`，如：

```
int height = 0;
for(UIView *subview in [yourScrollView subviews]) {
   height += subview.frame.size.height;
}
yourScrollView.contentSize = CGRectMake(yourScrollView.frame.origin.x, yourScrollView.frame.origin.y, yourScrollView.frame.size.width, height); 
```

我不确定这是否可行，但这是一个解决方案。

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:15:06.790

您可以使用以下代码找到滚动视图高度

```
float height = 0.0;
for(UIView *subview in [yourScrollView subviews]) {
    if(height < (subview.frame.origin.y + subview.frame.size.height))
       height = subview.frame.origin.y + subview.frame.size.height;
}
yourScrollView.contentSize = CGRectMake(yourScrollView.frame.origin.x, yourScrollView.frame.origin.y, yourScrollView.frame.size.width, height); 
```

希望对你有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:55:30.463

```
yourLabel.frame = CGRectMake(0, 200, yourImageView.height, yourLabel.frame.size.height);
float heightOfScrollView = yourLabel.frame.origin.y + yourLabel.frame.size.height + 10;
scrView.contentSize = CGSizeMake(320, heightOfScrollView); 
```

希望这对你有帮助....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T23:02:08.263

您无法在界面生成器中设置此类开关。您必须为您的 UITableView 实现以下委托方法：

– tableView:heightForRowAtIndexPath:

该方法的文档可以在这里找到：

[http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html)

在此方法中，您将必须访问相应行包含的元素的框架。在您的情况下， UILabel 和 UIImageView 并从它们的框架计算它们的组合高度。

希望这可以帮助。

# android - 图形布局中的活动未显示 Android 2.3.3

> ID：10807722
> 
> 赞同：-1
> 
> 时间：2012-05-29T22:38:34.963
> 
> 标签：android, xml, android-layout, android-activity, preview

这是我的问题的图片[http://i49.tinypic.com/f35jds.png](http://i49.tinypic.com/f35jds.png)

因此，就像在图片中存在整个白色空白区域一样，应该是一种设备类型的东西，显示 .xml 但在图形布局中，但事实并非如此。有谁知道如何找回这个？我最近更新了我的 SDK 和 Eclipse，从那以后它就消失了，我真的需要它。谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T03:37:03.787

这是新sdk的问题。您可以通过将目标版本（图片右上角）更改为 android 3.0 或更高版本或重新启动 eclipse 来恢复它。显示布局后，您可以将目标设置为 2.3.3

# windows-phone-7 - 如何在 Windows Phone 7 的滑块中添加圆形端盖

> ID：10807724
> 
> 赞同：0
> 
> 时间：2012-05-29T22:38:43.920
> 
> 标签：windows-phone-7, xaml, slider, app.xaml

这几天一直困扰着我。它给我留下了对 Windows Phone 和 XAML 的一般印象。不应该这么难。我已经在我的 app.xaml 文件中添加了一个控制模板，该模板（大部分情况下）可以工作，除非拇指处于最大位置，这会导致圆形端盖被填充圆形拇指图像周围间隙所需的矩形覆盖我用。试图通过为第 2 列设置最小列宽或添加额外的列来防止这种情况会导致奇怪的恶作剧，例如拇指图像在移动到最大位置时会完全消失。

```
 <ControlTemplate x:Key="PhoneSimpleRepeatButton" TargetType="RepeatButton">
        <Rectangle Fill="Transparent"/>
    </ControlTemplate>
    <Style x:Key="MySlider" TargetType="Slider">
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Maximum" Value="10"/>
        <Setter Property="Minimum" Value="0"/>
        <Setter Property="Value" Value="0"/>
        <Setter Property="Background" Value="{StaticResource PhoneContrastBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource PhoneAccentBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Slider">
                    <Grid Background="Transparent">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="HorizontalTrack"/>
                                        <DoubleAnimation Duration="0" To="0.1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="VerticalTrack"/>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Fill" Storyboard.TargetName="HorizontalFill">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneDisabledBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Fill" Storyboard.TargetName="VerticalFill">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneDisabledBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid x:Name="HorizontalTemplate" Margin="25,0,25,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="23"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Ellipse Grid.Column="0" Width="10"  HorizontalAlignment="Left" Height="10">
                                <Ellipse.Fill>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="Blue" Offset="0" />
                                        <GradientStop Color="LightBlue" Offset="1" />
                                    </LinearGradientBrush>
                                </Ellipse.Fill>
                                <Ellipse.Clip>
                                    <RectangleGeometry Rect="0,0,5,10"/>
                                </Ellipse.Clip>
                            </Ellipse>
                            <Ellipse Grid.Column="2" Width="10" HorizontalAlignment="Right" Height="10">
                                <Ellipse.Fill>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="Black" Offset="0" />
                                        <GradientStop Color="LightGray" Offset="1" />
                                    </LinearGradientBrush>
                                </Ellipse.Fill>
                                <Ellipse.Clip>
                                    <RectangleGeometry Rect="5,0,5,10"/>
                                </Ellipse.Clip>
                            </Ellipse>
                            <Rectangle x:Name="HorizontalFill" Grid.Column="0" Height="10" IsHitTestVisible="False" Margin="5,0,0,0">
                                    <Rectangle.Fill>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="Blue" Offset="0" />
                                        <GradientStop Color="LightBlue" Offset="1" />
                                        </LinearGradientBrush>
                                    </Rectangle.Fill>
                            </Rectangle>
                            <Rectangle x:Name="HorizontalTrack" Grid.Column="2" Height="10" IsHitTestVisible="False" Margin="0,0,5,0">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="Black" Offset="0" />
                                        <GradientStop Color="LightGray" Offset="1" />
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                                <RepeatButton x:Name="HorizontalTrackLargeChangeDecreaseRepeatButton"  Grid.Column="0" IsTabStop="False" Template="{StaticResource PhoneSimpleRepeatButton}"/>
                            <RepeatButton x:Name="HorizontalTrackLargeChangeIncreaseRepeatButton" Grid.Column="2" IsTabStop="False" Template="{StaticResource PhoneSimpleRepeatButton}"/>
                            <Thumb x:Name="HorizontalThumb" Grid.Column="1" Height="23" Width="23">
                                <Thumb.Template>
                                    <ControlTemplate>
                                        <Canvas Background="Transparent" Height="23" Width="23">
                                            <Rectangle Height="10" Width="11" IsHitTestVisible="False" Margin="0,7,0,0">
                                                <Rectangle.Fill>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                        <GradientStop Color="Blue" Offset="0" />
                                                        <GradientStop Color="LightBlue" Offset="1" />
                                                    </LinearGradientBrush>
                                                </Rectangle.Fill>
                                            </Rectangle>
                                            <Rectangle Height="10" Width="11" IsHitTestVisible="False" Margin="12,7,0,0">
                                                <Rectangle.Fill>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                        <GradientStop Color="Black" Offset="0" />
                                                        <GradientStop Color="LightGray" Offset="1" />
                                                    </LinearGradientBrush>
                                                </Rectangle.Fill>
                                            </Rectangle>
                                            <Image Source="Images/thumb.png" Width="23" Height="23"/>
                                        </Canvas>
                                    </ControlTemplate>
                                </Thumb.Template>
                            </Thumb>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T03:50:31.927

我终于让它工作了。关键是要避免弄乱在移动滑块时调整列大小的网格。我将端盖移到网格外，它解决了问题。我还创建了几个渐变画笔来减少要涉水的 xaml 数量。

```
 <ControlTemplate x:Key="PhoneSimpleRepeatButton" TargetType="RepeatButton">
        <Rectangle Fill="Transparent"/>
    </ControlTemplate>
    <LinearGradientBrush x:Key="LowerTrackGradient" StartPoint="0,0" EndPoint="0,1">
        <GradientStop Color="Blue" Offset="0" />
        <GradientStop Color="LightBlue" Offset="1" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="UpperTrackGradient" StartPoint="0,0" EndPoint="0,1">
        <GradientStop Color="Black" Offset="0" />
        <GradientStop Color="LightGray" Offset="1" />
    </LinearGradientBrush>
    <Style x:Key="MySlider" TargetType="Slider">
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Maximum" Value="10"/>
        <Setter Property="Minimum" Value="0"/>
        <Setter Property="Value" Value="0"/>
        <Setter Property="Background" Value="{StaticResource PhoneContrastBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource PhoneAccentBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Slider">
                    <Grid Background="Transparent">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="HorizontalTrack"/>
                                        <DoubleAnimation Duration="0" To="0.1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="VerticalTrack"/>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Fill" Storyboard.TargetName="HorizontalFill">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneDisabledBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Fill" Storyboard.TargetName="VerticalFill">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneDisabledBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Ellipse Fill="{StaticResource LowerTrackGradient}" Width="10" HorizontalAlignment="Left" Height="10" Margin="20,0,0,0">
                            <Ellipse.Clip>
                                <RectangleGeometry Rect="0,0,5,10"/>
                            </Ellipse.Clip>
                        </Ellipse>
                        <Ellipse Fill="{StaticResource UpperTrackGradient}" Width="10" HorizontalAlignment="Right" Height="10" Margin="0,0,20,0">
                            <Ellipse.Clip>
                                <RectangleGeometry Rect="5,0,5,10"/>
                            </Ellipse.Clip>
                        </Ellipse>
                        <Grid x:Name="HorizontalTemplate" Margin="25,0,25,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="23"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Rectangle x:Name="HorizontalFill" Fill="{StaticResource LowerTrackGradient}" Grid.Column="0" Height="10" IsHitTestVisible="False">
                            </Rectangle>
                            <Rectangle Fill="{StaticResource UpperTrackGradient}" x:Name="HorizontalTrack" Grid.Column="2" Height="10" IsHitTestVisible="False">
                            </Rectangle>
                                <RepeatButton x:Name="HorizontalTrackLargeChangeDecreaseRepeatButton"  Grid.Column="0" IsTabStop="False" Template="{StaticResource PhoneSimpleRepeatButton}"/>
                            <RepeatButton x:Name="HorizontalTrackLargeChangeIncreaseRepeatButton" Grid.Column="2" IsTabStop="False" Template="{StaticResource PhoneSimpleRepeatButton}"/>
                            <Thumb x:Name="HorizontalThumb" Grid.Column="1" Height="23" Width="23">
                                <Thumb.Template>
                                    <ControlTemplate>
                                        <Canvas Background="Transparent" Height="23" Width="23">
                                            <Rectangle Fill="{StaticResource LowerTrackGradient}" Height="10" Width="11" IsHitTestVisible="False" Margin="0,7,0,0">
                                            </Rectangle>
                                            <Rectangle Fill="{StaticResource UpperTrackGradient}" Height="10" Width="11" IsHitTestVisible="False" Margin="12,7,0,0">
                                            </Rectangle>
                                            <Image Source="Images/thumb.png" Width="23" Height="23"/>
                                        </Canvas>
                                    </ControlTemplate>
                                </Thumb.Template>
                            </Thumb>
                        </Grid>
                    </Grid>
                </ControlTemplate> 
```

# xml - hibernate - 共享映射 xml 文件

> ID：10807726
> 
> 赞同：-1
> 
> 时间：2012-05-29T22:38:51.087
> 
> 标签：xml, hibernate, hbm

有没有办法为多个表共享映射文件。

每个休眠 pojo 都有一个整数 id 字段，我将其移入超类。我也有多个彼此非常相似的表。所以我也为它们创建了超类。

有没有办法将映射文件相互包含或共享映射文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:06:59.497

您所描述的情况由hibernate很好地处理，您应该阅读[有关继承映射的hibernate文档](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch10.html)（或您使用的任何版本的等效文档）以了解如何映射与继承相关的类。

对其他映射的引用不是通过包含，而是通过类之间的实际关系，基本上是通过引用类本身之间的继承关系，例如（来自文档）：

```
 <hibernate-mapping>
     <subclass name="DomesticCat" extends="Cat" discriminator-value="D">
          <property name="name" type="string"/>
     </subclass>
 </hibernate-mapping> 
```

# driver - WorkItem (IoQueueWorkItem) 给 BSOD 错误“PAGE_FAULT_IN_NONPAGED_AREA”

> ID：10807731
> 
> 赞同：0
> 
> 时间：2012-05-29T22:39:11.890
> 
> 标签：driver, workitem, bsod, page-fault, wdm

我正在使用 Windows 7 64 位。WorkItem（IoQueueWorkItem）给蓝屏错误“PAGE_FAULT_IN_NONPAGED_AREA”我也在释放分配的内存......不知道出了什么问题:(

这是我的驱动程序代码：

```
#ifdef ALLOC_PRAGMA
#pragma alloc_text (INIT, DriverEntry)
#pragma alloc_text (PAGE, DriverCreateClose)
#pragma alloc_text (PAGE, DriverUnload)
#endif

NTSTATUS
DriverEntry(
    _In_ PDRIVER_OBJECT  DriverObject,
    _In_ PUNICODE_STRING RegistryPath
    )

{
    PDEVICE_OBJECT      deviceObject;
    UNICODE_STRING      ntDeviceName;
    NTSTATUS            status;
    UNICODE_STRING      symbolicLinkName;

    UNREFERENCED_PARAMETER(RegistryPath);

    DbgPrint("*** .SYS:  ==>DriverEntry\n");

    //
    // Create the device object
    //
    RtlInitUnicodeString(&ntDeviceName, NTDEVICE_NAME_STRING);

    status = IoCreateDevice(DriverObject,               // DriverObject
                            sizeof(DEVICE_EXTENSION),   // DeviceExtensionSize
                            &ntDeviceName,              // DeviceName
                            FILE_DEVICE_UNKNOWN,        // DeviceType
                            FILE_DEVICE_SECURE_OPEN,    // DeviceCharacteristics
                            FALSE,                      // Not Exclusive
                            &deviceObject               // DeviceObject
                           );

    if (!NT_SUCCESS(status)) {
        DbgPrint("*** .SYS: IoCreateDevice returned 0x%x\n", status);
        return(status);
    }

    //
    // Set up dispatch entry points for the driver.
    //
    DriverObject->MajorFunction[IRP_MJ_CREATE]          = DriverCreateClose;
    DriverObject->MajorFunction[IRP_MJ_CLOSE]           = DriverCreateClose;
    DriverObject->MajorFunction[IRP_MJ_CLEANUP]         = DriverCleanup;
    DriverObject->DriverUnload                          = DriverUnload;

    //Test WorkItem
    test_WorkItem();

    //
    // Create a symbolic link for userapp to interact with the driver.
    //
    RtlInitUnicodeString(&symbolicLinkName, SYMBOLIC_NAME_STRING);
    status = IoCreateSymbolicLink(&symbolicLinkName, &ntDeviceName);

    if (!NT_SUCCESS(status)) {
        IoDeleteDevice(deviceObject);
        DbgPrint("*** .SYS: IoCreateSymbolicLink returned 0x%x\n", status);
        return(status);
    }

    DbgPrint("*** .SYS: DriverEntry<==\n");
    return status;
} 
```

这是我的测试代码：

```
typedef struct _WorkItemStruct {
     PIO_WORKITEM pio;
     VOID (*callback)(PDEVICE_OBJECT DeviceObject, PVOID Context);
} WorkItemStruct;

void WorkItemCallback(PDEVICE_OBJECT DeviceObject, WorkItemStruct *work)
{
    PAGED_CODE();
    DbgPrint("Hello World!\n");

    IoFreeWorkItem( work->pio );
    ExFreePool( work );
}

void test_WorkItem()
{
    WorkItemStruct *work;
    work = (WorkItemStruct *) ExAllocatePool(NonPagedPool, sizeof(WorkItemStruct));

    if( work != NULL )
    {
        work->pio = IoAllocateWorkItem(pDeviceObject);
        IoQueueWorkItem( work->pio, (PIO_WORKITEM_ROUTINE)WorkItemCallback, DelayedWorkQueue, work);
    }
} 
```

此代码使我的笔记本电脑崩溃......我不知道我错在哪里......我也在释放内存。如果我评论它，没有 IoQueueWorkItem 就可以了。

////////////////**编辑1** 解决了！这是因为这里的 DeviceObject，`work->pio = IoAllocateWorkItem(pDeviceObject);`这`pDeviceObject`不是我的驱动程序实例......因此它失败了！

# spring-mvc - 以声明方式在 Tiles 中注入 bean

> ID：10807734
> 
> 赞同：0
> 
> 时间：2012-05-29T22:39:28.883
> 
> 标签：spring-mvc, tiles2

我有一个集成了 Tiles 2.1 和 Spring MVC（在 Spring Roo 的帮助下）的运行系统，并且想通过一个非常简单的 bean 设置菜单项，它返回一个项目列表：

```
public class TestMenu {
 public ArrayList<String> getEntries() {
    ArrayList<String> returner = new ArrayList<String>();

    returner.add("MenuItem 1");
    returner.add("MenuItem 2");

    return returner;
 }
} 
```

我的瓷砖配置如下所示：

```
 <definition name="empty" template="/WEB-INF/layouts/empty.jspx">
  <put-attribute name="footer" value="/WEB-INF/views/empty/footer.jspx" />
  <put-attribute name="menu" value="/WEB-INF/views/empty/menu.jspx" />
  <put-attribute name="menuEntries">
   <bean classtype="com.reservation.ui.TestMenu" />
  </put-attribute>
 </definition> 
```

在我的 menu.jspx 中，我打算使用 menuItems，如下所示：

```
<tiles:useAttribute id="list" name="menuEntries" classname="com.reservation.ui.TestMenu" />
<c:forEach var="item" items="${list.Entries}">
  <div class="item">
    <div class="left">&amp;nbsp;</div>
    <div class="middle">${item}</div>
    <div class="right">&amp;nbsp;</div>
  </div>
</c:forEach> 
```

我还没有找到任何类似的文档或示例，但我认为这应该是一个常见的用例。

有人知道适用的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T07:31:07.157

好的，它是这样的：

TestMenu 类实现了 ViewPreparer，它实现了 execute 方法并将请求的 MenuData 作为 ListAttribute 放入 Tiles 中。

```
public class TestMenu implements ViewPreparer {
 public List<String> getMenuItems() {
    ArrayList<String> returner = new ArrayList<String>();

    returner.add("MenuItem 1");
    returner.add("MenuItem 2");

    return returner;
 }

 public void execute(TilesRequestContext tilesContext, AttributeContext attributeContext) throws PreparerException {
    String selection = attributeContext.getAttribute("selection").getValue().toString();
    ListAttribute listAttribute = new ListAttribute(this.getMenuItems());

    attributeContext.putAttribute("menuItems", listAttribute, true);
 }
} 
```

配置和 jspx-file 保持不变。

# google-apps-script - UrlFetchApp 请求失败 - Google 自定义搜索引擎 API

> ID：10807736
> 
> 赞同：-1
> 
> 时间：2012-05-29T22:39:33.733
> 
> 标签：google-apps-script, google-custom-search

我正在尝试使用 Google Apps Script UrlFetchApp.fetch 方法通过 api 从我的自定义搜索引擎（cse）中获取结果。但是，我发送的网址似乎无效。有人会告诉我我做错了什么，或者这是错误的方法吗？

```
function testGet(){  
  var q = "orell+auto"  
  var engID = "MY_ENGINE_ID"
  var cseAPIkey = "MY-KEY"  
  var response = UrlFetchApp.fetch("https://www.googleapis.com/customsearch/v1?&key="+ cseAPIkey + "&cx="+ engID +"q=" + q +"&fields=items(snippet%2Ctitle)%2Cspelling%2FcorrectedQuery");
  if (response.getResponseCode() == 200) {
    var text = response.getContentText();
    Logger.log(text);
  }
} 
```

我没有使用 UrlFetchApp.fetch 方法的特殊原因，我只是想要最简单的方法来从谷歌应用程序脚本调用我的 cse 并从结果中返回更正的查询、标题和片段（url 的最后一位）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T19:00:31.253

所以我发现 url 中有几个错误 - 一个来自我自己的键输入，一个在 url 中，如图所示。这是固定的代码行：

```
var response = UrlFetchApp.fetch("https://www.googleapis.com/customsearch/v1?&key="+ cseAPIkey + "&cx="+ engID +"&q=" + q +"&fields=items(snippet%2Ctitle)%2Cspelling%2FcorrectedQuery"); 
```

# css - 用 watir 检查标签类？

> ID：10807743
> 
> 赞同：5
> 
> 时间：2012-05-29T22:40:36.967
> 
> 标签：css, ruby, class, watir

我有一个 div 会根据表单是否正确提交而改变。
我想知道是否可以检查某个类的特定元素？

开始元素看起来像这样。

```
<div id="myerrortest" class="input text"></div> 
```

如果输入不正确，请添加错误类。

```
<div id="myerrortest" class="input text error"></div> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-29T22:53:48.057

试试这个：

```
browser.div(:id => "myerrortest").class_name 
```

更多信息：

[http://watir.github.com/watir-webdriver/doc/Watir/HTMLElement.html#class_name-instance_method](http://watir.github.com/watir-webdriver/doc/Watir/HTMLElement.html#class_name-instance_method)

另一种选择是只查看您期望的具有类的 div 是否存在

```
browser.div((:id => "myerrortest", :class => 'input text').exists? 
```

如果使用 rSpec 类型匹配器，它将是

```
browser.div((:id => "myerrortest", :class => 'input text').should exist 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-29T22:54:30.240

您可以使用 jquery 来做到这一点（或者不这样做，jquery sintax 只是更简单，但使用 getelement 你可以做任何事情）。

这是一个通过单击按钮添加类的示例：

```
$(".button").click(function(){  
$("#myerrortest").attr("class",$("#myerrortest").attr("class")+" error");
}); 
```

这项工作也适用于 $(".classname")。希望有帮助

# javascript - 如何改进/缩短这两个类似的 ajax 请求？

> ID：10807744
> 
> 赞同：0
> 
> 时间：2012-05-29T22:40:43.940
> 
> 标签：javascript, jquery

我的问题很简单。这是我的代码，我发现它们是两个相似的我如何改进/缩短这段代码？

我发现它们在很多方面都很相似，这就是我在这里问的原因。

这是我的代码，任何帮助表示赞赏。

```
$(".follow-link").click(function(event) {
    event.preventDefault();
    var therel = $(this).attr('rel');
    var followID = $(this).attr('rel').replace(/[^0-9]/g, '');
    var thisfollow = $(this);
    $.ajax({
        url: '/ajax/follow.php',
        type: 'POST',
        data: {followwho : followID},
        dataType: 'json',
        success: function(data){
            if (data.status) {
                $('a[rel="' + therel + '"]').hide();
                $('a[rel="' + therel + '"]').parent().children('.unfollow-link').fadeIn();
            }
        }
    });
});

$(".unfollow-link").click(function(event) {
    event.preventDefault();
    var therel = $(this).attr('rel');
    var followID = $(this).attr('rel').replace(/[^0-9]/g, '');
    var thisfollow = $(this);
    $.ajax({
        url: '/ajax/unfollow.php',
        type: 'POST',
        data: {followwho : followID},
        dataType: 'json',
        success: function(data){
            if (data.status) {
                $('a[rel="' + therel + '"]').hide();
                $('a[rel="' + therel + '"]').parent().children('.follow-link').fadeIn();
            }
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:46:28.300

创建一个通用函数并在该函数中进行一些简化清理工作：

```
function followAjax(event, sel, phpurl) {
    event.preventDefault();
    var thisfollow = $(this);
    var therel = thisfollow.attr('rel');
    var followID = therel.replace(/[^0-9]/g, '');
    $.ajax({
        url: phpurl,
        type: 'POST',
        data: {followwho : followID},
        dataType: 'json',
        success: function(data){
            if (data.status) {
                $('a[rel="' + therel + '"]').hide().parent().children(sel).fadeIn();
            }
        }
    });
}

$(".unfollow-link").click(function(event) {
    followAjax.call(this, event, ".follow-link", '/ajax/unfollow.php')
});
$(".follow-link").click(function(event) {
    followAjax.call(this, event, ".unfollow-link", '/ajax/follow.php')
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:51:02.953

您可以在两个处理程序中使用相同的函数，查找`this.className`（或使用 jQuery: `$(this).hasClass`）然后执行适当的操作。或者您使用两个函数，在闭包中生成它们：

```
$(".follow-link").click(makeHandler("follow"));
$(".unfollow-link").click(makeHandler("unfollow"));

function makeHandler(action) {
    return function(event) {
        event.preventDefault();
        var therel = $(this).attr('rel');
        var followID = $(this).attr('rel').replace(/[^0-9]/g, '');
        var thisfollow = $(this);
        $.ajax({
            url: '/ajax/'+action+'.php',
            type: 'POST',
            data: {followwho : followID},
            dataType: 'json',
            success: function(data){
                // no need to ask for data.status
                $('a[rel="' + therel + '"]').hide();
                $('a[rel="' + therel + '"]').parent().children(action=="follow"
                    ? '.unfollow-link'
                    : '.follow-link'
                ).fadeIn();
            }
        });
    };
} 
```

# java - BIRT主题未在tomcat上显示

> ID：10807746
> 
> 赞同：1
> 
> 时间：2012-05-29T22:40:53.733
> 
> 标签：java, eclipse, tomcat6, birt

我们在一个库中定义了三个不同的报告主题，它们都包括标题颜色、文本对齐、文本颜色、数据源等。我们将主题应用于报告，并且更改显示在 Eclipse 中的 BIRT Web 查看器中，但是当我们将使用 BIRT 查看器的应用程序部署到 Tomcat 时，不再显示主题。

我们还在库中定义了所有报告使用的四个数据源，这些数据源在部署后保持不变，只是过来的 CSS 被忽略或丢弃。

我已经搜索并搜索了这个，我唯一发现的是 2008ish 的 stackoverflow 上的一个问题。

有什么想法或建议吗？

谢谢，

伊恩

Eclipse Indigo SR2 BIRT 3.7.1 Tomcat v6.0

主题定义为：

```
 ...
 <themes>
    <theme name="defaultTheme" id="2">
        <styles>
            <style name="table-header" id="6">
                <property name="backgroundColor">#660033</property>
                <property name="backgroundPositionX">left</property>
                <property name="fontWeight">bold</property>
                <property name="color">#FFFFFF</property>
            </style>
        </styles>
    </theme>
    <theme name="dccTheme" id="260">
        <styles>
            <style name="table-header" id="261">
                <property name="backgroundColor">#730000</property>
                <property name="backgroundPositionX">left</property>
                <property name="fontWeight">bold</property>
                <property name="color">#FFFFFF</property>
            </style>
        </styles>
    </theme>
    <theme name="mccTheme" id="263">
        <styles>
            <style name="table-header" id="265">
                <property name="backgroundColor">#005281</property>
                <property name="backgroundPositionX">left</property>
                <property name="fontWeight">bold</property>
                <property name="color">#FFFFFF</property>
            </style>
        </styles>
    </theme>
</themes>
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T06:31:18.270

这取决于您如何在库中定义主题，如果您已链接 CSS，那么您甚至必须将 CSS 文件放入您部署的战争中，如果您想避免将 CSS 文件放入战争中，您必须[将 CSS 文件导入库](http://www.packtpub.com/article/creating-themes-report-birt)中。

当您设置包含在库中的主题时，您必须指定完全限定名称：

```
libraryname.dccTheme 
```

# vb.net - 使用 Splashscreen VB.NET 加载另一个表单

> ID：10807753
> 
> 赞同：3
> 
> 时间：2012-05-29T22:41:23.533
> 
> 标签：vb.net, splash-screen

所以我正在开发一个游戏，它在某些系统上有点重，所以这是我在游戏打开时想做的事情（伪代码）：

```
Show Splashscreen
Load GameForm
When GameForm Is Completely Loaded
Splashscreen Close
Show GameForm 
```

这是如何在实际的 VB 代码中完成的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T01:56:50.510

打开 Visual Studio > 新建 VB.Net Winform 项目

右键单击解决方案 > 添加新项目 > SplashScreen

双击 Form1 并在 Form1_Load 事件中：

```
Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

Me.Visible = False

Dim s = New SplashScreen1()
s.Show()
'Do processing here or thread.sleep to illustrate the concept
System.Threading.Thread.Sleep(5000)
s.Close()

Me.Visible = True

End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T04:02:23.040

VB.NET 2010（其他？）具有内置的启动画面分配机制。

将启动画面添加到您的 Winform 项目。项目菜单 -> 添加新项目 -> 选择“启动画面”

在初始屏幕代码窗口中，它会提示您如何操作。

```
'TODO: This form can easily be set as the splash screen for the application by going to the "Application" tab
'  of the Project Designer ("Properties" under the "Project" menu). 
```

基本上，在项目属性中，在底部的应用程序选项卡下，有一个选择启动画面的选项。

通过此更改添加到 Application.Designer.vb 文件中的项目的代码是：

```
 <Global.System.Diagnostics.DebuggerStepThroughAttribute()>  _
    Protected Overrides Sub OnCreateSplashScreen()
        Me.SplashScreen = Global.WindowsApplication1.SplashScreen1
    End Sub 
```

默认情况下，这种分配初始屏幕的方法会显示 2000 毫秒。

您可以阅读文档以了解其他用法[@MSDN](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.minimumsplashscreendisplaytime.aspx#Y0)

# spring - 将服务类标记为事务时，DAO 中出现“未找到当前线程的会话”错误

> ID：10807754
> 
> 赞同：3
> 
> 时间：2012-05-29T22:41:29.457
> 
> 标签：spring, hibernate, transactions, annotations

使用休眠 4 和 Spring 3.1。刚刚启动并运行它，所以这可能是我缺乏理解。我在 Service 类中有一个方法，它调用 DAO 类中的一个方法来使用 Hibernate 检索一些数据。我使用 @Transactional 注释 Service 方法，但在 DAO 方法中调用 getCurrentSession 时出错。如果我也用 @Transactional 注释 DAO 方法，则成功检索数据。我不明白为什么——我会认为 Service 方法上的 @Transactional 注释会创建一个 Hibernate 会话，将其绑定到线程，并且当调用 getCurrentSession 时，该会话将在 DAO 类中返回。谁能解释为什么会这样，或者我做错了什么，谢谢？

根上下文.xml：

```
<tx:annotation-driven transaction-manager="transactionManager"/> 
```

服务等级：

```
public class BlahServiceImpl implements BlahService {

    @Transactional  
    public Blah GetMostRecentBlah() {
        BlahDAO blahDAO = DAOFactory.GetBlahDAO();
        return blahDAO.GetMostRecentBlah();
    }
} 
```

DAO类：

```
private SessionFactory sessionFactory;

public void setSessionFactory(SessionFactory sessionFactory) {
    this.sessionFactory = sessionFactory;
}

public Blah GetMostRecentBlah() {
    return (Blah)sessionFactory.getCurrentSession().createQuery("from Blah where blahID = (select max(blahID) from Blah)").uniqueResult();
} 
```

错误：

```
org.hibernate.HibernateException: No Session found for current thread
org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)
org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:1039)
com.blah.blah.DAO.BlahDAOImpl.GetMostRecentBlah(BlahDAOImpl.java:18) 
```

就像我说的，如果我用 @Transactioanl （以及 Service 方法）注释 DAO 函数，这是可行的，但我不明白为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T03:45:05.523

两个可能的原因表明了自己。

1) 您的服务 bean 在一个单独的 ApplicationContext 中，它没有启用注释驱动的事务。

2) 您正在获取对服务实例的引用，该实例是原始实例，而不是代理实例，因此是事务性实例。

要确定哪个是您的问题，或者确定它是否是其他问题，请显示导致创建服务 bean 的上下文文件，并显示您获取服务实例的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T15:07:51.023

解决方案可能是：

```
<tx:annotation-driven proxy-target-class="true"  transaction-manager="transactionManager" /> 
```

因为类没有代理。

否则，如果您必须将私有方法代理为事务性方法（正如我所面临的），您最终可能会添加 aspectj 而不是 cglib，然后以下配置可能会有所帮助

```
 <!-- switches on the load-time weaving -->
    <context:load-time-weaver />

    <!--  proxies classes with aspectj and you may have @Transaction annotations for managing transactions-->    
    <tx:annotation-driven proxy-target-class="true"   mode="aspectj" transaction-manager="transactionManager" /> 
```

之后使用 jvm 参数启动服务器

```
-javaagent:/path-to/spring-instrument-{spring-version}.jar 
```

# java - 如何使用 FreeMarker 模板嵌套 Pojos？

> ID：10807756
> 
> 赞同：6
> 
> 时间：2012-05-29T22:41:33.300
> 
> 标签：java, freemarker, pojo

我正在研究使用 FreeMarker 编写 EDI 文件。这些基本上是格式化（和验证）的电子发票。我决定从写一个简单的例子开始，并坚持让它成为一个“嵌套 pojo”的模板。我的意思是一个 POJO，它包含 POJO，这两个 POJO 都有我想要的数据在我的输出中。我编写了一个单元测试（自包含），但由于未知原因而失败。当我运行测试时，出现以下异常：

```
Expression user.getSub is undefined on line 1, column 24 in simple.
The problematic instruction:
----------
==> ${user.getSub().user} [on line 1, column 22 in simple]
----------

Java backtrace for programmers:
----------
freemarker.core.InvalidReferenceException: Expression user.getSub is undefined on line 1, column 24 in simple.
    at freemarker.core.TemplateObject.assertNonNull(TemplateObject.java:124)
    at freemarker.core.TemplateObject.invalidTypeException(TemplateObject.java:134)
    <snip>
    example.TestFreeMarkerTemplating.testSimpleTemplate(TestFreeMarkerTemplating.java:23)
    <snip> 
```

我在模板上尝试了很多变体，但都没有成功。这是测试：

```
package example;

import java.io.*;
import org.junit.Test;
import freemarker.cache.StringTemplateLoader;
import freemarker.ext.beans.BeansWrapper;
import freemarker.template.*;

import static org.junit.Assert.*;

public class TestFreeMarkerTemplating {

Configuration cfg = new Configuration();
StringTemplateLoader stringLoader = new StringTemplateLoader();
{ cfg.setTemplateLoader(stringLoader);
cfg.setObjectWrapper(new BeansWrapper()); }

@Test
public void testSimpleTemplate() throws TemplateException, IOException{
    stringLoader.putTemplate("simple", "Welcome ${user}. Sub ${user.getSub().user}");
    Template temp = cfg.getTemplate("simple");
    StringWriter out = new StringWriter();
    temp.process(new TestPojo(), out);

    assertEquals("Welcome Andy. Sub Bill", out.toString());
}

public static class TestPojo {
    private final String user = "Andy";
    private final SubPojo sub = new SubPojo();

    public String getUser() { return user; }
    public SubPojo getSub() { return sub; }
}

public static class SubPojo {
    private final String user = "Bill";

    public String getUser() { return user; }
}

 } 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T23:48:56.773

您已将`TestPojo`实例本身设置为数据模型根，因此`user`in`user.getSub()`是`String`“Andy”，它没有`getSub`方法。正确的模板是`"Welcome ${user}. Sub ${getSub().user}"`. 但最好写成`"Welcome ${user}. Sub ${sub.user}"`.

# plone - 基于 plone.app.testing 的测试无限期挂起并且不会将控制权返回给 shell

> ID：10807761
> 
> 赞同：1
> 
> 时间：2012-05-29T22:42:09.523
> 
> 标签：plone

在我使用 runner 测试运行失败后，`bin/test`当我假设控件应该返回终端时，我得到以下异常：

```
 Traceback (most recent call last):
    File "bin/test", line 374, in <module>
      '--test-path', '/fast/xxx3/src/xxx-eggs/Products.xxxHospital',
    File "/fast/buildout-cache/eggs/zope.testing-3.9.7-py2.6.egg/zope/testing/testrunner/__init__.py", line 35, in run
      failed = run_internal(defaults, args, script_parts=script_parts)
    File "/fast/buildout-cache/eggs/zope.testing-3.9.7-py2.6.egg/zope/testing/testrunner/__init__.py", line 48, in run_internal
      runner.run()
    File "/fast/buildout-cache/eggs/zope.testing-3.9.7-py2.6.egg/zope/testing/testrunner/runner.py", line 138, in run
      self.run_tests()
    File "/fast/buildout-cache/eggs/zope.testing-3.9.7-py2.6.egg/zope/testing/testrunner/runner.py", line 242, in run_tests
      tear_down_unneeded(self.options, (), setup_layers, True)
    File "/fast/buildout-cache/eggs/zope.testing-3.9.7-py2.6.egg/zope/testing/testrunner/runner.py", line 605, in tear_down_unneeded
      l.tearDown()
    File "/fast/buildout-cache/eggs/plone.app.testing-4.0.2-py2.6.egg/plone/app/testing/helpers.py", line 351, in tearDown
      with z2.zopeApp() as app:
    File "/Users/moo/code/python/parts/opt/lib/python2.6/contextlib.py", line 16, in __enter__
      return self.gen.next()
    File "/fast/buildout-cache/eggs/plone.testing-4.0.3-py2.6.egg/plone/testing/z2.py", line 242, in zopeApp
      app = addRequestContainer(Zope2.app(connection), environ=environ)
    File "/fast/buildout-cache/eggs/Zope2-2.13.12-py2.6.egg/Zope2/__init__.py", line 52, in app
      return bobo_application(*args, **kw)
    File "/fast/buildout-cache/eggs/Zope2-2.13.12-py2.6.egg/App/ZApplication.py", line 75, in __call__
      return connection.root()[aname]
    File "/fast/buildout-cache/eggs/ZODB3-3.10.5-py2.6-macosx-10.7-x86_64.egg/ZODB/Connection.py", line 366, in root
      return RootConvenience(self.get(z64))
    File "/fast/buildout-cache/eggs/ZODB3-3.10.5-py2.6-macosx-10.7-x86_64.egg/ZODB/Connection.py", line 248, in get
      p, serial = self._storage.load(oid, '')
  AttributeError: 'NoneType' object has no attribute 'load' 
```

（显然与 ZODB 内部有关？）

然后执行就挂在那里。

CTRL+C 什么都不做。

退出测试过程的唯一方法是 CTRL+Z 退出，然后`kill %1`.

有任何想法吗？操作系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T02:40:12.943

当我未能为我的测试所依赖的某些包正确加载 zcml 时，我看到了类似的回溯。您是否检查过您的设置以确保正确加载/安装所有需要的部件？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-20T08:45:29.977

What I found is two possible reasons:

1.  Problems with the loading of "dependent" ZCML as @Chris Ewing said. I use

    ```
    xmlconfig.string(
        '<configure xmlns="http://namespaces.zope.org/zope">'
        '  <include package="z3c.autoinclude" file="meta.zcml" />'
        '  <includePlugins package="plone" />'
        '  <includePluginsOverrides package="plone" />'
        '</configure>',
        context=configurationContext) 
    ```

    to trigger z3c.autoload.

2.  Problems with the order of testing bases. I had two bases like this:

    ```
     PLONE_FIXTURE     PLONE_FIXTURE
                   \                  / 
    LAYER =      (MY_FIXTURE1,  MY_FIXTURE2, ) 
    ```

    it worked with

    ```
     PLONE_FIXTURE -> MY_FIXTURE1 -> MY_FIXTURE2

     LAYER = (MY_FIXTURE2,) 
    ```

-Tom

# node.js - node.js sequelize：多个“where”查询条件

> ID：10807765
> 
> 赞同：22
> 
> 时间：2012-05-29T22:42:56.430
> 
> 标签：node.js, sequelize.js

如何查询具有多个条件的表？以下是两个都有效的示例：

```
Post.findAll({ where: ['deletedAt IS NULL'] }).success() 
```

和

```
Post.findAll({ where: {topicId: req.params.id} }).success() 
```

然后，如果我需要结合条件，我觉得我需要做类似的事情

```
Post.findAll({ where: [{topicId: req.params.id}, 'deletedAt IS NULL'] }).success() 
```

，但它不起作用。
sequelize 等待的语法是什么？

节点调试 说：

> DEBUG: TypeError: Object # has no method 'replace'

如果重要的话……

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-07-15T11:01:24.687

你可以做：

```
Post.findAll({ where: {deletedAt: null, topicId: req.params.id} }) 
```

哪个会被翻译成`deletedAt IS NULL`

顺便说一句，如果您需要`deletedAt NOT IS NULL`，请使用：

```
Post.findAll({ where: {deletedAt: {$ne: null}, topicId: req.params.id} }) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-31T20:46:22.703

做就是了：

```
Post.findAll(
    { where: ["topicId = ? AND deletedAt IS NULL", req.params.id] }
).success() 
```

或者你需要一个或查询？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-29T18:52:19.960

请注意，截至本帖和 2015 版续集，上述答案已过时。我正在发布我正在努力的解决方案，希望能节省一些时间。

```
filters["State"] = {$and: [filters["State"], {$not: this.filterSBM()}] }; 
```

注意 JSON 对象中的 $ 和数组，并且缺少 ? 代币替换。

或者换一种更一般的方式，因为这可能会帮助人们理解它：

```
{ $and: [{"Key1": "Value1"}, {"Key2": "Value2"}] } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-04-14T21:49:20.857

这给了我 `SELECT `id`, `title`, `description`, `test`, `published`, `createdAt`, `updatedAt` FROM `tests` AS `test` WHERE (`test`.`title` LIKE '%3%' OR `test`.`description` LIKE '%2%');`

```
exports.findAll = (req, res) => {
    const title = req.query.title;
    const description = req.query.description;
    Tutorial.findAll({
            where: {
                [Op.or]: [{
                        title: {
                            [Op.like]: `%${title}%`
                        }
                    },
                    {
                        description: {
                            [Op.like]: `%${description}%`
                        }
                    }
                ]
            }
        })
        .then(data => {
            res.send(data);
        })
        .catch(err => {
            res.status(500).send({
                message: err.message || "Some error occurred while retrieving tutorials."
            });
        });

}; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-01T22:08:20.327

在**新版本中**试试这个

```
Post.findAll({
  where: {
    authorId: 12,
    status: 'active'
  }
}).then(function (data) {
    res.status(200).json(data)
            })
   .catch(function (error) {
                res.status(500).json(error)
   });; 
```

# google-maps - 谷歌地图：KML 图标元素今天没有显示，上周工作

> ID：10807767
> 
> 赞同：1
> 
> 时间：2012-05-29T22:43:20.143
> 
> 标签：google-maps, kml

maps.google.com 上周正确显示的简单 KML 文件不再显示图标元素。细分像以前一样显示，但没有图标。图标显示在详细信息面板中，但未显示在地图上。谷歌会更新他们的 JS 并破坏我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T02:32:44.437

@ManoMarks：事情变得更糟了。再次浏览他的文件，或者例如，我的[http://maps.google.com/maps?q=http:%2F%2Fjidanni.org%2Flocation%2Fzaokeng.kmz](http://maps.google.com/maps?q=http:%2F%2Fjidanni.org%2Flocation%2Fzaokeng.kmz) 取消单击左侧面板中的框不再关闭该层！

他们过去常常打开和关闭他们所指的东西，这就是为什么它们是可点击的复选框。现在他们不能在任何地方的任何 KML 地图上工作！（现在在 Google 地图中已损坏，但在 Google 地球中仍然可以正常工作。）

此外，例如，打开右侧下拉菜单中的 (panoramio) 照片图层，无论如何都会在会话的其余部分丢失左侧面板的菜单。

总之，在 Google 地图中查看 KML 文件现在一直是一个低威胁的错误！

# c# - 使用通用 XML 属性反序列化

> ID：10807770
> 
> 赞同：1
> 
> 时间：2012-05-29T22:43:41.537
> 
> 标签：c#, xml, xml-serialization

我有一些带有通用属性（名称、类型等）的 xml，其中属性的值需要是 xml 被反序列化的属性。

我试图推送到一个类的 xml 类型的示例是：

```
<root>
    <company>
        <location>USA</location>
        <name>TopCars</name>
    </company>
    <CarList name="CarCounts">
        <ModelList name="Models">
            <Column name="Ford">50</Column>
            <Column name="Chevy">65</Column>
            <Column name="Dodge">75</Column>
        </ModelList>
    </CarList>
</root> 
```

我可以提供一些我用过的示例代码，但它不起作用，我想要一些新的前景。我正在使用由一个类反序列化的 xmlReader，该类具有由属性“名称”标识的单个属性，这无论如何都不是我想要的。我最终想要包含福特、雪佛兰和道奇属性的类模型（如果您反对此处的汽车结构，这是一个虚构的示例）。

XSD 会吐出这样的东西，这是我所期望的，但并不是我真正想要的：

```
[...]
<xs:element name="Column" nillable="true" minOccurs="0" maxOccurs="unbounded">
  <xs:complexType>
    <xs:simpleContent msdata:ColumnName="Column_Text" msdata:Ordinal="1">
      <xs:extension base="xs:string">
        <xs:attribute name="name" type="xs:string" />
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:element>
[...] 
```

我不受这种技术的限制。我正在用 C# 开发。

任何帮助表示赞赏。

@RichardTowers：我使用列出的 xml 尝试了以下操作并收到错误“XML 文档 (1、2) 中存在错误”。

```
Base.Root[] cars = null;
XmlSerializer serializer = new XmlSerializer(typeof(Base.Root[]));
XmlReader reader = XmlReader.Create(new StringReader(xml));
cars = (Base.Root[])serializer.Deserialize(reader);
reader.Close(); 
```

我尝试使用 xmlElementAttribute 装饰器更改您建议的类，将“”添加到 xmlString 的开头。我也试过用 StreamReader 切换 StringReader 无济于事。还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T23:10:41.783

你想要做的并不是反序列化是如何工作的。一方面你有一些 XML，另一方面有一个 C# 类。它们需要看起来彼此相似，序列化程序才能完成其工作。

你说你想要一个像这样的课程：

```
class Models
{
    int Chevy { get; set; } //65
    int Dodge { get; set; } //75
} 
```

首先，我认为不可能将您的 XML 序列化成这样的东西。但即使是这样，如果您的 XML`Mercedes`代替了会发生什么？您无法反序列化该位，因为它不在您的班级中。

基本上你的类需要模仿你的 XML。你想要这样的东西：

```
class Root
{
    Company Company { get; set; }
    List<Model> ModelList { get; set; }
}

class Company
{
    string Location { get; set; }
    string Name { get; set; }
}

class Model
{
    string Name { get; set; }
    int Value { get; set; }
} 
```

然后，您可以通过执行以下操作来引用您的模型：

```
// Get the value for Chevy:
root.ModelList.Find(model => model.Name == "Chevy").Value; 
```

**编辑：**这里粘贴了执行此操作所需的所有代码：http: [//pastebin.com/Z3b3558Z](http://pastebin.com/Z3b3558Z)。对缩进感到抱歉，VisualStudio 有点兴奋。

# c# - Nhibernate 映射 - 用户和朋友

> ID：10807776
> 
> 赞同：0
> 
> 时间：2012-05-29T22:44:09.153
> 
> 标签：c#, nhibernate, nhibernate-mapping

我正在尝试使用 Nhibernate 作为我的 ORM 的社交网络类型场景。

我有一个用户表和一个朋友表。

```
User Table
----------
UserID
FirstName
LastName
Email

Friend Table
-------------
UserID
FriendUserID
AddedDateTime 
```

这意味着在朋友表中它可能有很多记录，比如

```
A - B (A initiated a friend request to B, accepted)
A - C (A initiated a friend request to C, accepted)
B - C
D - A (D initiated a friend request to A, accepted)
B - E 
```

我怎样才能拥有一个 Nhibernate 属性，这样如果我为 A 调用 userObject.Friends，我将 B、C 和 D 作为用户对象返回。

为用户对象映射 xml...

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Namespace.Data.Entities.User,Namespace.Data.Entities" table="`User`" lazy="true">
    <id name="UserId" column="`UserId`" type="Guid">
      <generator class="assigned" />
    </id>
    <property type="string" length="150" name="FirstName" column="`FirstName`" />
    <property type="string" length="150" name="LastName" column="`LastName`" />
    <property type="string" not-null="true" length="256" name="Email" column="`Email`" />    
    <bag name="UsersFriends" inverse="true" lazy="true" cascade="all">
      <key column="`UserID`" />
      <one-to-many class="Namespace.Data.Entities.Friend,Namespace.Data.Entities" />
    </bag>
    <bag name="FriendsofUser" inverse="true" lazy="true" cascade="all">
      <key column="`FriendUserID`" />
      <one-to-many class="Namespace.Data.Entities.Friend,Namespace.Data.Entities" />
    </bag>
  </class>
</hibernate-mapping> 
```

和朋友对象...

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Namespace.Data.Entities.Friend,Namespace.Data.Entities" table="`Friend`" lazy="true">
    <id name="Id" column="`ID`" type="int">
      <generator class="native" />
    </id>
    <property type="DateTime" not-null="true" name="AddedDateTime" column="`AddedDateTime`" />
    <many-to-one name="User" cascade="none" column="`UserID`" not-null="true" />
    <many-to-one name="FriendUser" cascade="none" column="`FriendUserID`" not-null="true" />
  </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T13:18:00.283

我会建议

```
public class User
{
    public virtual long Id { get; set; }
    public virtual ICollection<FriendshipRequest> InitiatedRequests { get; private set; }
    public virtual ICollection<FriendshipRequest> ReceivedRequests { get; private set; }
    public virtual IEnumerable<User> Friends
    {
        get {
            return  (from fr in InitiatedRequests
                     where fr.Accepted
                     select fr.Friend)
                    .Concat(
                     from fr in ReceivedRequests
                     where fr.Accepted
                     select fr.Initiator);
        }
    }

    public User()
    {
        InitiatedRequests = new HashSet<FriendshipRequest>();
        ReceivedRequests = new HashSet<FriendshipRequest>();
    }
}

public class FriendshipRequest
{
    public virtual User Initiator { get; set; }
    public virtual User Friend { get; set; }
    public virtual bool Accepted { get { return Added != default(DateTime); } }
    public virtual DateTime Added { get; set; }

    // override Equals
}

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Namespace.Data.Entities.User,Namespace.Data.Entities" table="`User`">
    ...
    <set name="InitiatedRequests" cascade="all" table="FriendshipRequests">
      <key column="`UserID`" />
      <composite-element>
        <property type="DateTime" name="Added" column="`AddedDateTime`" />
        <parent name="Initiator" />
        <many-to-one name="Friend" column="`FriendUserID`" not-null="true" />
      </composite-element>
    </bag>
    <set name="ReceivedRequests" cascade="all" table="FriendshipRequests" inverse="true">
      <key column="`FriendUserID`" />
      <composite-element>
        <property type="DateTime" name="Added" column="`AddedDateTime`" />
        <parent name="Friend" />
        <many-to-one name="Initiator" column="`UserID`" not-null="true" />
      </composite-element>
    </bag>
  </class>
</hibernate-mapping> 
```

*   对于 ReceivedRequests 集合，逆必须设置为 true，以便仅从一侧处理此集合
*   我会设置，所以每个友谊只能添加一次（哪些属性是唯一的取决于相等），这是有道理的，NHibernate 可以优化一些东西
*   为避免选择 n+1，如果您打算使用朋友收藏，请确保您也渴望加载其他收藏

# asp.net - ASP.NET 计时器导致 AJAX 工具包 SliderExtender 发生故障

> ID：10807778
> 
> 赞同：1
> 
> 时间：2012-05-29T22:44:16.807
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit

我有 2 个更新面板，两个更新面板都设置为 UpdateMode="Conditional"。

第一个更新面板包含：

*   2 AJAX 工具包 SliderExtender
*   2 对应的文本框

第一个更新面板将 2 个 SliderExtender 文本框的 TextChanged 事件设置为异步回发触发器。

```
<Triggers>
    <asp:AsyncPostBackTrigger ControlID="tb_Slider1" EventName="TextChanged" />
    <asp:AsyncPostBackTrigger ControlID="tb_Slider2" EventName="TextChanged" />
</Triggers> 
```

第二个更新面板包含：

*   3 个标签
*   间隔为 1 秒的计时器

第二个更新面板通过后面的代码加载标签中的文本。第二个更新面板将 Timer's Tick 事件设置为异步回发触发器。

```
<Triggers>
     <asp:AsyncPostBackTrigger ControlID="tm_Timer1" EventName="Tick" />
</Triggers> 
```

如果我滚动第一个更新面板中的任何一个滑块，因为第二个更新面板中的计时器滴答作响；滑块会自行下降，进而触发 TextChanged 事件。

为什么第二个更新面板中的部分回帖会导致第一个更新面板控件做出反应？

我一直在更新更新面板，看起来部分回帖更像是完整的回帖，因为它们运行所有服务器页面生命周期事件。我不确定这是否会导致滑块出现故障？

有没有办法避免这种情况？还是“按预期工作”？

最终，即使计时器在滴答作响，我也希望能够自由移动滑块。这样定时器更新面板会经常更新，当用户放下滑块控件（即TextChanged）时，第一个更新面板将被更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T14:58:01.333

尽管`tm_Timer1`没有添加到第一个 updatepanel 的触发器集合中，但当它打勾时，提交给服务器的所有表单控件的值（包括文本框值和第一个 UpdatePanel）也会刷新。您可以在 ScriptManager 控件之后添加脚本来解决此问题：

```
<script type="text/javascript">
     Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler);

     var realDoPostback = __doPostBack;
     __doPostBack = function (sender, args) {
          if (sender === "<%= tm_Timer1.UniqueID %>") {
               $get("<%= tb_Slider1.ClientID  %>").removeAttribute("name");
               $get("<%= tb_Slider2.ClientID  %>").removeAttribute("name");
          }
          realDoPostback(sender, args);
     }

     function endRequestHandler(sender, args) {
          $get("<%= tb_Slider1.ClientID  %>").setAttribute("name", "<%= tb_Slider1.UniqueID %>");
          $get("<%= tb_Slider2.ClientID  %>").setAttribute("name", "<%= tb_Slider2.UniqueID %>");
     }
</script> 
```

# javascript - 纯 CSS 的下拉菜单真的可行吗？

> ID：10807783
> 
> 赞同：3
> 
> 时间：2012-05-29T22:45:26.863
> 
> 标签：javascript, html, css, events

因此，我决定开始更深入地学习 CSS，并尝试实现纯 CSS 下拉菜单/选择框。我首先研究了一些[在线教程](http://csswizardry.com/demos/css-dropdown/)中提供的代码。

最终，[我想出了这个](http://jsfiddle.net/FcmtY/)，我认为这是相当不错的。然而，我得出的结论是，在所有情况下，CSS 菜单可能永远都不是 Javascript 菜单的合适替代品，因为当你放弃 Javascript 时会出现一些微妙的问题。

如果下拉菜单中的项目只是`<a href`链接，那么一切都应该没问题。但是，如果您希望每个链接触发 Javascript 事件，则会遇到以下问题：

*   当用户单击下拉框中的某个项目时，您显然希望下拉框*消失。*如果下拉框中的项目是`<a>`元素，则会自动发生这种情况。如果它们不是`<a>`元素，则下拉框不会在单击时消失 - 这给您留下了两个选择：（A）连接一些侦听的 Javascript，`onclick`然后使下拉框消失，或者（B ) 使用 css`:active`选择器将下拉框的 `display`属性设置为`none`. (A) 很愚蠢，因为此时您基本上回到了 Javascript 菜单，并且 (B) 不起作用，因为它阻止了在您单击菜单中的项目时触发 Javascript 事件。

*   所以，你*必须*使用`<a>`标签。这意味着如果要将事件与菜单项选择相关联，则需要`onclick`在`<a>`标签中使用内联。没关系，除非您这样做，否则它会阻止下拉菜单消失（[如我的 jsfiddle 链接中所示](http://jsfiddle.net/FcmtY/)）。`<a>` 所以，真的，只有当用户选择一个菜单项时你想做的只是通过链接导航到另一个页面时，纯 CSS 下拉菜单才似乎可行。我找不到任何方法来触发不附带一些问题的 Javascript 函数。

**问：**那么，我说的准确吗？或者有没有办法创建一个只有 CSS 的下拉菜单，（A）当用户点击它时*消失*，（B）触发一个 Javascript 函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T22:54:44.627

我真的不关注你。为什么您“显然”希望下拉菜单消失？

如果你这样做了，那么你应该让它消失，我不清楚这是你想要发生的“显而易见”的事情。

菜单不会消失，因为鼠标仍在悬停区域上，这正是 css 应该做的。如果您想要其他行为，那么您确实需要使用 javascript。在大多数情况下，这并不重要，因为您要么重定向到另一个页面，要么更改当前状态（例如使用弹出对话框或其他内容。

CSS 菜单适用于我使用它们的大多数用途。我很少使用 css 菜单来做一些既不会重定向也不会导致某种彻底的状态变化而无论如何都会关闭菜单的事情。

所以我想我的答案是，仅仅因为你有一个特定的用例使纯 css 菜单难以使用，并不意味着它们对大多数其他用途没有用。

话虽如此，仅仅因为您正在使用 javascript 并不意味着您也必须恢复到成熟的 javascript 菜单。您可以简单地使用 javascript 来巧妙地更改标准行为，而无需完整 js 菜单的复杂性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T23:21:24.377

我认为你有点困惑。您似乎认为存在一个二进制文件：所有 CSS 或所有 JS。这是一种愚蠢的思考方式。当使用 CSS 并使用 JS 做 CSS 不适合做的事情时，你应该使用 CSS。在大多数情况下，使用 CSS 为您完成繁重的工作（隐藏/显示菜单等），然后使用 CSS 无法提供的附加功能增强所述菜单是大多数专业前端开发人员构建菜单的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T23:09:16.763

您的问题展示了一些研究，并且得到了很好的解释。但是我发现一些困惑：最后你想使用 javascript 因为你想触发一些东西（一个事件，一个函数..）。

所以我的回答是：

css 非常适合下拉菜单，如果您想在用户单击菜单时使用 javascript，只需执行以下操作

```
<a href="javascript:my_function()" >Item 1</a> 
```

然后该`my_function()`函数可以执行您想要的代码，也可能隐藏选定的元素。

我在这个[jfiddle](http://jsfiddle.net/FcmtY/3/)中做了一个例子，只是使用了一个传统的 window.alert 函数，你可以用你喜欢的 javascript 替换它。

关于您对使菜单消失的担忧的最后一句话：您确定您非常需要它吗？执行该功能时，用户的注意力可能会集中在其他事情上，他将从下拉列表中移开……但是我不完全知道，因为您没有解释为什么希望它消失。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-29T23:31:03.730

我觉得在这样的下拉列表中不使用 JS 的目标具有误导性。如果您使用下拉菜单进行导航（无论是外部还是页面上使用`#`引用），手动隐藏菜单就变得不必要了。如果您将它用于任何其他功能，那么期望它必须与 JS 连接是合理的，这意味着“手动”操作呈现的元素并不可耻。

当然，这里还有另一种可能的用途。您的 jsfiddle 示例看起来很像一个时尚`<select>`元素 - 如果这实际上是您的意图，您可以很简单地用类似的东西替换单个链接

```
<label><input type="radio" name="test-select" value="1" />Item 1</label> 
```

然后可以本地提交 - 这种最小的表单功能可能是您在没有 javascript 的情况下可以获得的最大功能

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T00:00:56.613

CSS 菜单不仅仅是“可行的”。我不记得上次我用 JS 做菜单是什么时候了。不要吹嘘，但我只使用 CSS 构建的这个菜单获得了大量访问。它有带有图标的下拉菜单。

[http://www.stpetersburgwebdesigner.com/2011/03/pep-wayfinder-menu-for-modx-evolution/](http://www.stpetersburgwebdesigner.com/2011/03/p-e-p-wayfinder-menu-for-modx-evolution/)

# ios - 在调用 beginBackgroundTaskWithExpirationHandler 并且应用程序在后台之后调用 performSelectorOnMainThread: 是否可以？

> ID：10807784
> 
> 赞同：6
> 
> 时间：2012-05-29T22:45:29.210
> 
> 标签：ios, multithreading, grand-central-dispatch

**我正在启动这样的后台任务**：

```
UIApplication* application = [UIApplication sharedApplication];
_backgroundTask = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^
                           {
                               [application endBackgroundTask:_backgroundTask];
                               _backgroundTask = UIBackgroundTaskInvalid;
                           }]; 
```

**该应用程序被发送到后台**，一切都很好。

一段时间后，满足某些条件，某些对象最终执行以下代码：

```
[self performSelectorOnMainThread:@selector(doSomething) withObject:nil waitUntilDone:YES]; 
```

**那时，应用程序崩溃了！**

请注意，在这种特殊情况下，对象正在主线程中执行。

我用这个替换了上面的代码：

```
 dispatch_async(dispatch_get_main_queue(), ^{
        [self doSomething];
    }); 
```

一切似乎都很好，崩溃消失了。

我可以想象的是 waitUntilDone:YES 可能是这里的区别，但这只是我的直觉。

**我的问题是：**

当应用程序在后台运行时，是否允许使用 performSelectorOnMainThread:withObject:waitUntilDone:YES？

如果是这样，为什么应用程序崩溃以及为什么 dispatch_async 解决了这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-20T11:35:49.617

使用 performSelectorOnMainThread:withObject:waitUntilDone:YES 可能是线程死锁的原因。当前线程停止并等待。如果主线程没有及时完成选择器的执行，iOS 可能会因为占用主线程的时间超过允许的时间（通常为 10 秒，有时更短）而终止您的应用程序。

dispatch_async(dispatch_get_main_queue... 调用不会以这种方式阻塞。它总是将事件放入队列中并等待轮到它，当前线程继续进行而不会停止。

如果没有更多关于坠机性质的信息，很难说发生了什么。

# c# - 使用大型集合反序列化 JSON

> ID：10807786
> 
> 赞同：2
> 
> 时间：2012-05-29T22:45:51.157
> 
> 标签：c#, .net, json

我正在编写一个控制台应用程序来解析来自外部源的 JSON 数据。这是在 C# 中使用 .NET 4.0（完整版，而不是客户端配置文件）。我正在尝试使用 System.Web.Script.Serialization.JavaScriptSerializer 类将 JSON 数据反序列化为对象，如下所示：

```
var targetObject = deserializer.Deserialize<TargetObjectType>(json); 
```

通常这可以正常工作，但是当数据包含非常大的集合时，我会收到此错误：System.InvalidOperationException（“由于对象的当前状态，操作无效。”）我做了一些研究，发现：[http： //support.microsoft.com/kb/2661403](http://support.microsoft.com/kb/2661403)。基本上，微软限制项目数量作为安全预防措施。

覆盖它的方法是向 Web.config 添加一条记录，如支持文章中所述，但在我的情况下它不起作用。我做了一些研究，发现其他人在这里遇到了这个问题：http: [//msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)。

所以我的问题是：有没有办法使用 JavaScriptSerializer 在控制台应用程序中反序列化具有大量集合的 JSON 对象？

请注意：我的团队负责人不希望使用 Microsoft 以外的任何库。这意味着我不能使用 JSON.NET（又名 NEWTONSOFT），所以请不要推荐它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T22:52:32.360

我建议您选择其他一些 Json De/Serializer。例如：http: [//james.newtonking.com/projects/json-net.aspx](http://james.newtonking.com/projects/json-net.aspx)

它几乎可以处理我扔给它的任何东西。甚至来自 Couchbase 服务器的 TB 大小的转储（只要您在要反序列化/序列化的机器中有适当的 RAM）。

/edit：我读到您的领导更愿意坚持使用普通的 Microsoft Webstack。但是，再引用一个程序集会节省大量时间和很多麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T00:01:58.690

这是来自 Microsoft 的 JSON 序列化程序

[http://nuget.org/packages/System.Json](http://nuget.org/packages/System.Json)

我已经多次使用它并且没有任何问题。不像 Newtonsoft 那样功能齐全，但可以处理大多数场景

# java - 检索 JSON 数组并将其放入 java 中的数组？

> ID：10807790
> 
> 赞同：0
> 
> 时间：2012-05-29T22:46:41.923
> 
> 标签：java, php, android, mysql, json

我正在检索 JSON 数据数组并尝试显示和访问它。但是当我尝试显示它时，它只显示 JSON 数据数组中的最后一行。当我尝试执行类似 json1.get(2) 的操作时（这里的 json1 是包含 JSONObject 的 JSONArray）我得到数组越界错误。请告诉我我做错了什么以及如何检索 JSON 下面是这个问题的相关代码。

谢谢你。

我从 Freebies.java 类调用 UserFunctions.java 类的 getAllFreebies 函数

```
UserFunctions uf = new UserFunctions();
JSONObject json = uf.getAllFreebies(); 
```

下面是来自 UserFunctions.java 类的 getAllFreebies() 函数的代码：

```
public JSONObject getAllFreebies(){
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", getAllFreebies_tag));
    JSONObject json  = jsonParser.getJSONFromUrl(getAllFreebiesURL,params);
    JSONArray json1 = new JSONArray();
    json1.put(json);
    try {
        System.out.println(json1.get(2));
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return json;
} 
```

下面是 index.php 类的代码，其中我调用 DB_Functions.php 类的 getFreebies() 函数

```
else if($tag = 'getAllFreebies'){
                $username = "";
                $catagory = "";
                $subcatagory = "";
                $title = "";
                $condition = "";
                $description = "";
                $address = "";
                $city = "";
                $state = "";
                $country = "";
                $zipcode = "";
                $posted_on= "";
                    $getAllFreebies = $db->getFreebies($username,$catagory,$subcatagory,$title,$condition,$description,$address,$city,$state,$country,$zipcode,$posted_on);
            $data = array();
            while($row = mysql_fetch_assoc($getAllFreebies)) {
            $response["success"] = 1;
            $data[] = array(
            $response["getAllFreebies"]["username"] = $row["username"],
            $response["getAllFreebies"]["catagory"] = $row["catagory"],
            $response["getAllFreebies"]["subcatagory"] = $row["subcatagory"],
            $response["getAllFreebies"]["title"] = $row["title"],
            $response["getAllFreebies"]["item_condition"] = $row["item_condition"],
            $response["getAllFreebies"]["description"] = $row["description"],
            $response["getAllFreebies"]["address"] = $row["address"],
            $response["getAllFreebies"]["city"] =  $row["city"],
            $response["getAllFreebies"]["state"] = $row["state"],
            $response["getAllFreebies"]["country"] = $row["country"],
            $response["getAllFreebies"]["zipcode"] = $row["zipcode"],
            $response["getAllFreebies"]["posted_on"] = $row["posted_on"]);}
            echo json_encode($response);
                    }// end of getAllFreebies tag 
```

下面是 DB_Functions.php 的 getFreebies() 函数的代码

```
public function getFreebies(){
$result = mysql_query("SELECT * FROM freebie") or die(mysql_error());
return($result);
} 
```

更新：我在我的 JSONParser 类中添加了以下内容以解析 JSONArray public JSONArray getJSONArrayFromUrl(String url, List params) {

```
 // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));
        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "n");
        }
        is.close();
        json = sb.toString();

        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
        jarray.put(jObj);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jarray;

} 
```

我更改了 getAllFreebie() 以检索 JSONArray

```
public JSONArray getAllFreebies() {
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", getAllFreebies_tag));
    JSONArray json = jsonParser.getJSONArrayFromUrl(getAllFreebiesURL,
            params);
    return json;
} 
```

我仍然只得到单行而不是所有行。谁能告诉我我做错了什么。谢谢:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:48:37.697

检查以下代码：

```
JSONObject json  = jsonParser.getJSONFromUrl(getAllFreebiesURL,params);
JSONArray json1 = new JSONArray();
json1.put(json);
try {
    System.out.println(json1.get(2));
} catch (JSONException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

您创建一个新的*empty* `JSONArray`，向其中添加一个元素，然后尝试访问它的第二个元素。

`getJSONFromUrl`应该解析一个对象还是一个数组？我相信您需要它来返回 a `JSONArray`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:51:30.867

~~将您的代码更新为：~~

```
// Initialize the array with your JSON string.
JSONArray json1 = new JSONArray(json);

// This line adds your String as the first element to
// the JSON array and is incorrect. You can safely remove it.
//json1.put(json); 
```

**编辑：**试试你发布的代码的这个更新版本：

```
// Making HTTP request
try {
    // defaultHttpClient
    DefaultHttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(url);
    httpPost.setEntity(new UrlEncodedFormEntity(params));
    HttpResponse httpResponse = httpClient.execute(httpPost);

    try {
        // Get our response as a String.
        String jsonString = EntityUtils.toString(httpResponse.getEntity());
        Log.d(TAG, "JSON: "+jsonString);

        // Parse the JSON String into a JSONArray object.
        return new JSONArray(jsonString);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }
} catch (UnsupportedEncodingException e) {
    e.printStackTrace();
} catch (ClientProtocolException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
}
return null; 
```

# javascript - 使用 JavaScript 填充 Django 表单

> ID：10807792
> 
> 赞同：1
> 
> 时间：2012-05-29T22:46:50.257
> 
> 标签：javascript, django

我试图通过 lat, long 使用 HTML5 地理定位来使用 JavaScript 自动填充 Django 表单中的两个表单字段。我找到了一个新的解决方案，但是表单是自动生成 html 的 Meta 类表单，并且它似乎无法为这种类型的访问添加“id”标签.

是否有一种正确的方法可以使用 JavaScript 以这种方式访问​​和填充 Meta 类表单中的字段？任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:03:49.213

当您通过 HTML5 地理位置获取位置时，您可以使用 javascript 填充字段。查看生成的表单 HTML 代码并获取字段的 ID。这是一个示例 jQuery 代码：

```
$("#id_latitude").val(latitude);
$("#id_longitude").val(longitude); 
```

# web-services - 一组 Web 服务的运行状况仪表板

> ID：10807795
> 
> 赞同：1
> 
> 时间：2012-05-29T22:47:10.710
> 
> 标签：web-services, health-monitoring

我计划构建一个具有良好感觉 UI 的健康仪表板。运行状况仪表板的基本目的是测试托管在各种服务器上的大约 150 个 Web 服务的运行状况。我知道“健康”是非常抽象的。我计划从测量延迟开始。我只是无法突破我应该如何开始这件事。请帮忙，现在在网上搜索了几个月，STACKOVERFLOW 是我最后的希望！

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T14:02:11.893

查看[op5](http://www.op5.com/op5-features/monitoring-web-services/)，它将监控 Web 服务和其他内容。

# c# - 如何提供默认的公共构造函数并禁止使用外部反射

> ID：10807796
> 
> 赞同：0
> 
> 时间：2012-05-29T22:47:13.750
> 
> 标签：c#, constructor, postsharp

我正在寻找一种方法来创建一个具有默认公共构造函数的类，但这禁止它在反射之外使用。

更详细地说，我正在使用一个对象持久性框架（AWS DynamoDB - 我没有更改的选项），它要求对象实现这样的公共默认构造函数。该框架还要求所有持久化字段和属性也具有公共 get 和 set 访问器，并在创建和初始化新对象实例时使用它们。这会导致问题，因为访问器需要服务于双重目的——它们在被框架使用时需要“裸露”，但在被代码使用时需要强制限制和验证。无论如何，我已经解决了这部分问题，但它依赖于永远不允许代码使用默认构造函数（持久性框架使用的构造函数）构造持久化对象。

回到最初的问题 - 为了使这一切正常工作，我需要禁止代码使用默认构造函数，同时仍使其可供持久性框架使用（仅搜索空的公共构造函数）。我开始使用静态标志并在任何潜在的对象持久性使用之前和之后设置它，如果未设置，则在默认构造函数中抛出异常，但这开始在多线程环境（Web服务器）中引起问题）。一个线程会将它设置为供持久性框架使用，这将打开构造函数供其他线程使用。我还尝试了一个 ThreadStatic 标志，但它有阻止框架构建的相反问题，因为它有时会产生工作线程。

现在我想知道是否真的有办法做到这一点。在这一点上，它变得更像是一种好奇心而不是一种要求。我总是可以按照“不要使用这个构造器”的方式写一个评论，但是直接执行规则会让我感觉更好。我以前使用过 PostSharp，也许有一种方法可以使用方面进行编译时验证，以防止使用基于代码的默认构造函数？还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:59:53.950

我不会在这上面花太多时间。不会有一种“干净”的方式来做到这一点，而且你会浪费大量的周期来尝试。让调用者负责使用，只需明智地注释您的代码。

WinForms 中也会出现同样的问题，即要求 Forms 中的无参数构造函数来支持 VS 设计器，而在正常使用 Form 时，调用者必须提供某些参数（例如，要显示的输入数据集）。

如果你真的想要，一种方法可能是在默认构造函数中使用反射来确定调用者，如果调用者程序集不是 DynamoDB，则抛出异常；

```
if (!Assembly.GetCallingAssembly().FullName.Contains("DynamoDB"))
    throw new InvalidOperationException("BEGONE!"); 
```

另外，作为旁注，我通常将这些类型的“开发人员”检查实现为 Debug.Asserts，而不是 Exceptions。通过这种方式，您在开发期间引入了您所追求的保护，但是在生产中（假设是 Release 构建），断言没有被编译，并且每次进行此调用时都不会导致（轻微）性能损失；

```
Debug.Assert(Assembly.GetCallingAssembly().FullName.Contains("DynamoDB"), "Invalid constructor usage"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T08:56:10.683

使用 PostSharp，您可以使用[架构约束](http://doc.sharpcrafters.com/postsharp-2.1/Content.aspx/PostSharp-2.1.chm/html/4762340d-c9e1-4c02-94af-d65b0b1f4038.htm)来验证未从用户代码调用某些构造函数（执行 ReferentialConstraint 并将约束附加到类，可能使用多播和继承）。基本上，如果从反射中唯一合法地使用此代码，则如果您发现对构造函数的任何引用，则可能会发出错误，期望来自其他构造函数的链接。

请注意，这不会阻止从构造调用`new T()`构造函数，其中 T 是泛型类型参数。所以只禁止新的运算符：从您的引用方面，使用 ReflectionSearch.GetMethodsUsingDeclaration 并过滤`(Instructions & MethodUsageInstructions.NewObject) != 0`.

编辑：添加了有关 ReflectionSearch.GetMethodsUsingDeclaration 和 MethodUsageInstructions 的详细信息。

# php - 如何编写巨大的PDF文件

> ID：10807798
> 
> 赞同：0
> 
> 时间：2012-05-29T22:47:25.683
> 
> 标签：php, fpdf, huge-pages

我正在使用 FPDF。
我需要每 10 页左右写入磁盘，否则内存会耗尽。
我该怎么做？
我尝试调用输出方法（'filename.pdf'，'F'）；在一个循环中，这不起作用。
知道它应该是什么样子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:59:27.517

您需要查看 FPDF 的来源。我正在使用我认为是 FPDF 的衍生作品的 TFPDF，但功能应该是相同的。

特别有一个功能 _out($s)

```
function _out($s)
{
        // Add a line to the document
        if($this->state==2)
                $this->pages[$this->page] .= $s."\n";
        else
                $this->buffer .= $s."\n";
} 
```

而不是像在这两种情况下那样附加到缓冲区......只需 fwrite 到您选择的打开文件描述符。

# android - FrameLayout 图像缩小

> ID：10807803
> 
> 赞同：0
> 
> 时间：2012-05-29T22:47:33.200
> 
> 标签：android, compression, size, android-framelayout

我正在开发一个应用程序，它从图库中加载照片（照片是从设备相机拍摄的），并执行其他应用程序相关功能并保存，我面临的问题是加载的图像垂直和水平压缩这会使图像缩小，这不是必需的我正在使用以下代码来处理 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="bottom"
    android:orientation="vertical" >

    <FrameLayout
        android:id="@+id/frame"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/previous_btn"
        android:layout_weight="0.88" >

        <ImageView
            android:id="@+id/imageView"
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:scaleType="matrix" />
    </FrameLayout>

    <Button
        android:id="@+id/previous_btn"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:text="Previous" />

    <Button
        android:id="@+id/next_btn"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/previous_btn"
        android:text="Next" />

    <Button
        android:id="@+id/button"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_toRightOf="@+id/next_btn"
        android:text="Save Picture" />

</RelativeLayout> 
```

请帮我解决这个问题！！！最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:51:02.640

好吧，您的 FrameLayout 设置为 wrap_content 的高度，而 ImageView 设置为 match_parent 的高度。所以这有点矛盾。哈哈。而且我不确定您如何在相对布局中使用权重。除非那是您使用 LinearLayout 时剩下的。并且您的 previous_btn 在 relativelayout 集中没有位置。

# r - 离线安装 R 包和依赖项

> ID：10807804
> 
> 赞同：60
> 
> 时间：2012-05-29T22:47:33.223
> 
> 标签：r, cran

假设我需要在没有互联网连接的（Linux）机器上安装一些包。假设我下载了一份 cran 并将其刻录到我带到离线位置的 DVD 上：

```
wget ftp://cran.r-project.org/pub/R/src/contrib/*.tar.gz 
```

我什至可以添加一个 PACKAGES 文件，其中包含所有源包及其依赖项的概述：

```
library(tools)
write_PACKAGES() 
```

我怎么能离线使用它来安装源包，以便从本地文件中解析和安装依赖项？例如，有人想要安装包 ggplot2，它具有相当深的依赖结构。假设 ggplot2 的源包及其所有依赖项都可以作为源包在当前工作目录中使用。如果我做：

```
install.packages("ggplot2_0.9.1.tar.gz", repos=NULL) 
```

这会导致错误，因为根本没有解决依赖关系。或者：

```
install.packages(list.files(pattern="*.tar.gz"), repos=NULL) 
```

但是，这也忽略了依赖结构，并尝试按字母顺序安装包，这也会失败。

我查看了`available.packages`，`contrib.url`但我找不到从本地文件安装源包的示例，包括它的依赖项。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-05-31T21:35:54.883

Joshua Ulrich 在对该问题的评论中给出了正确答案：

关键是将参数添加到`repos`or 或`contriburl`with前面`file://`。所以在 Unixy 系统中可以这样做：

```
install.packages("ggplot2", contriburl="file:///path/to/packages/") 
```

这假定所有必需的源包以及 PACKAGES 索引文件都在`/path/to/packages`. 如果不存在 PACKAGES 文件，则应首先使用以下方法生成：

```
library(tools)
write_PACKAGES("/path/to/packages/") 
```

这将生成在此目录中找到的所有源包的索引。`file:`请注意，在示例中，前缀后面有 3 个斜杠。第三个斜杠表示相对于文件系统根目录的路径。

`repos`和`contriburl`参数之间的区别在于，`repos`它将附加另一个`/src/contrib`到指定的路径，因为这通常是源包位于官方 CRAN 存储库镜像的位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-06T09:38:23.220

参考上面的答案，如果安装是在 Windows 中，那么 write_PACKAGES() 会在 '/path/to/packages/' 目录下生成两个文件：PACKAGES 和 PACKAGES.gz，所有 zip 文件都存放在该目录下。在 install.packages() 函数能够正确读取单独的 PACKAGES 文件之前，应删除文件 PACKAGES.gz ，否则会出现“无法打开压缩文件”错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-22T12:30:07.570

我在离线安装时遇到了同样的问题。不知何故，它不能通过命令行工作。

我下载，提取所有依赖项（保持检查所需的最低版本）并将文件夹粘贴到库文件夹中。这样只有我的问题得到了解决。

# c - 在 C 中显示最大值和最小值

> ID：10807807
> 
> 赞同：2
> 
> 时间：2012-05-29T22:47:42.283
> 
> 标签：c

我在显示最低平均值时遇到问题。我已经设定了结束考试分数输入的终止值。当我触发 -999 并显示最低考试分数时，我收到 -999 的值而不是实际的最低分数。我如何排除这个值？

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int main()
{
    int menuChoice, scoreCount = 0;
    float examScore = 0.0, 
          maxScore = 0.0,
          minScore = 0.0, 
          avgScore = 0.0, 
          sumScore = 0.0;

    printf("************************************\n");
    printf("1-> Enter an Exam Score\n");
    printf("2-> Display the highest exam score\n");
    printf("3-> Display the lowest exam score\n");
    printf("4-> Display the average exam score\n");
    printf("5-> Quit the program\n");
    printf("************************************\n\n");

    printf("Select a number that corresponds to the menu :\n");
    scanf("%d", &menuChoice);

    while(menuChoice != 5) 
    {
        switch(menuChoice)
        {
        case 1:
            while(examScore != -999)
            {
                printf("Enter an exam score (enter -999 to quit score input):\n");
                scanf("%f", &examScore);
                printf("The score you've entered equates to : %.2f\n\n", examScore);
                scoreCount++;

                if(maxScore < examScore)
                {
                    maxScore = examScore;
                }
                if(minScore > examScore)
                {
                    minScore = examScore;
                }
                else if(examScore < 0 || examScore > 100)
                {
                  printf("Exam Scores range from 0.0 - 100.0\n");
                }
                sumScore += examScore;
                avgScore = sumScore / scoreCount;
            }
            break;

        case 2:
            printf("The highest exam score is : %.2f\n", maxScore);
            break;

        case 3:
            printf("The lowest exam score is : %.2f\n", minScore);
            break;

        case 4:
            printf("The average exam score is : %.2f", avgScore);              
            break;

        default:
            printf("You've entered an invalid menu choice, review more carefully!");
            break;
        }

        printf("Select a number that corresponds to the menu :\n");
        scanf("%d", &menuChoice);
    } 

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:49:52.437

修复 while 循环的逻辑。`minScore`您在检查是否为 -999 之前更新`examScore`，所以这不好。

此外，您应该在使用它们之前初始化变量`examScore`，并且不应该像`examScore != -999`使用浮点数那样进行精确比较。要么更改为 ints，要么进行更宽容的比较，例如`examScore < -998`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:52:40.587

考虑以下程序。会`do_stuff`叫吗？

```
int foo;
while (foo != 5) {
   foo = 5;
   do_stuff();
} 
```

实际上，行为是未定义的，因为`foo`在初始化之前已经过测试。您的代码有同样的问题，使用`examScore`. 由于这是家庭作业，这只是一个提示——你将如何修复上面的简单程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T22:52:29.780

该代码的问题在于，当用户输入 -999 时，它会将其处理为测试分数。循环需要重组，以便在用户输入后立即中断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T22:54:51.443

就像其他人说的那样，您`-999`在处理该分数后进行检查。另外我假设你应该只`minScore`在当前考试较低的时候更新，所以你应该有类似的东西：

```
if(maxScore < examScore)
{
    maxScore = examScore;
}

if(minScore > examScore)
{
   minScore = examScore;
} 
```

最后，您应该在使用它们之前初始化所有变量。

编辑：

```
while(...) 
   printf("Enter an exam score (enter -999 to quit score input):\n");
   scanf("%f", &examScore);
   printf("The score you've entered equates to : %.2f\n\n", examScore);

   if(examScore < 0 || examScore > 100)
   {
       printf("Exam Scores range from 0.0 - 100.0\n");
       continue; //goes back to the top of the loop skipping everything else
   } 
   //At this point you know the score is valid so you can process it
   scoreCount++;

   if(maxScore < examScore)
   {
       maxScore = examScore;
   }
   if(minScore > examScore)
   {
      minScore = examScore;
   }
   sumScore += examScore;
   avgScore = sumScore / scoreCount;
} 
```

如果它不在循环中或者您不想使用，则可以在有效性检查后`continue`简单地将其他所有内容（所有处理内容）放在一个块中。`else`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T02:44:05.413

除了没有`init`直接比较两个浮点问题的值之外，还有一个逻辑错误。在您的情况 1 while 循环中，您需要先确定用户输入是否满足终止条件，然后再对其进行处理。还`minScore`需要在分配之前进行比较，就像 twain249 所说的那样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-02T03:10:14.003

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int main()
{
    int scoreCount = 0;
    float maxScore = -1000.0,
          minScore = 1000.0,
          sumScore = 0.0;

    printf("************************************\n");
    printf("1-> Enter Exam Scores\n");
    printf("2-> Display the highest exam score\n");
    printf("3-> Display the lowest exam score\n");
    printf("4-> Display the average exam score\n");
    printf("5-> Quit the program\n");
    printf("************************************\n\n");

    for(;;)
    {
        int menuChoice;
        printf("Select a number that corresponds to the menu:\n");
        scanf("%d", &menuChoice);

        if(scoreCount == 0 && menuChoice >= 2 && menuChoice <= 4)
        {
            printf("Please enter some scores by choosing menu item 1\n");
            continue;
        }

        switch(menuChoice)
        {
        case 1:
            for(;;)
            {
                float examScore;
                printf("Enter an exam score (enter -999 to quit score input):\n");
                scanf("%f", &examScore);
                if (examScore == -999)
                    break;
                printf("The score you've entered equates to : %.2f\n\n", examScore);
                if(examScore < 0 || examScore > 100)
                {
                    printf("Exam scores range from 0.0 - 100.0\n");
                    continue;
                }

                sumScore += examScore;
                ++scoreCount;

                if(maxScore < examScore)
                {
                    maxScore = examScore;
                }
                if(minScore > examScore)
                {
                    minScore = examScore;
                }
            }
            break;

        case 2:
            printf("The highest exam score is : %.2f\n", maxScore);
            break;

        case 3:
            printf("The lowest exam score is : %.2f\n", minScore);
            break;

        case 4:
        {
            float avgScore = sumScore / scoreCount;
            printf("The average exam score is : %.2f\n", avgScore);
            break;
        }

        default:
            printf("You've entered an invalid menu choice, review more carefully!");
            break;
        }
    }

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-24T08:26:23.027

有两个问题：负分数存储为最小值，但当固定时，最小值分数的初始值将为 0，因此您无法获得更高的值。如果 min-check 的输入不超过 100（代码注释中的 initA）或使用第一个值初始化（基于分数计数 - initB），则将 min score 初始化为 100。只需提供超出范围的值，也可以退出输入考试分数：

```
float minScore = 100.0; /* initA */
/* .. */
    case 1 :
    {
        printf("Enter an exam score (0..100): "); scanf("%f", &examScore);
        while( ( 0.0 <= examScore ) && ( examScore <= 100.0 ) )
        {
            if( 0 == scoreCount ) { minScore = examScore; } /* initB */
            ++scoreCount;
            if( maxScore < examScore ) { maxScore = examScore; }
            if( minScore < examScore ) { minScore = examScore; }
            sumScore += examScore;
            avgScore = sumScore / scoreCount;
            printf("Enter an exam score (0..100): "); scanf("%f", &examScore);
        }
        break;
    } 
```

并非所有 printf 都以`\n`.

# php - 来自查询的 PHP/MYSQL 回显总数

> ID：10807810
> 
> 赞同：0
> 
> 时间：2012-05-29T22:48:04.533
> 
> 标签：php, mysql, count, echo

我已经使用 COUNT(id) 运行了一个查询，以此来总结具有给定 id 的行数。我现在想打印那个号码。由于id很多，所以需要打印很多次。我认为每个 pageid/count(id) 都是表格中自己的行，但也许我错了。这是代码的要点（对于使用 mysql_query 表示歉意）：

```
$sql = "SELECT pageid, COUNT(id) FROM views 
GROUP BY pageid 
ORDER BY COUNT(id)"

$res = mysql_query($sql);
while($row = mysql_fetch_array($res)) {
  echo $row['pageid'];
  echo $row['count(id)'];
} 
```

除了最后一行不起作用。

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T22:50:52.923

数组索引区分大小写。由于您正在选择`COUNT(id)`，因此您应该使用`$row['COUNT(id)']`而不是`$row['count(id)']`.

或者，您可以为计数指定别名。

```
$sql = "SELECT pageid, COUNT(id) pagecount FROM views 
GROUP BY pageid 
ORDER BY COUNT(id)" 
```

有了以上内容，您可以使用`$row['pagecount']`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T22:51:09.283

```
$sql = "SELECT pageid, COUNT(id) as tot_id FROM views 
GROUP BY pageid 
ORDER BY id"
...
echo $row['tot_id']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T22:51:44.987

您必须将 count 大写，因为它在 sql 调用中设置为 COUNT。

# c# - 传递带有未知参数列表的委托

> ID：10807819
> 
> 赞同：1
> 
> 时间：2012-05-29T22:48:45.203
> 
> 标签：c#, parameters, delegates, func

我需要一个验证器类来运行一系列验证方法，每个验证方法都返回一个错误代码。根据错误的严重程度，我可能想中止其余的验证。我可以在每次调用后检查返回的错误代码，而不执行剩余的验证，但这会给主要的“驾驶”例程增加很多重复的混乱。

所以，我编写了以下帮助程序来为我处理这个......

```
public IList<Error> ValidateSet(InputType input,
    params Func<InputType, IList<Error>>[] validations)
{
    var errors = new List<Error>();

    foreach (var validation in validations)
    {
        errors.AddRange(validation(input));

        if (AbortValidations(errors))
            break;
    }

    return errors;
} 
```

这按以下方式调用，效果很好......

```
var errors = new List<Error>();

errors.AddRange(
    ValidateSet(input,
        ValidateX,
        ValidateY,
        ValidateZ)
); 
```

我现在遇到的问题是，某些验证需要除 InputType 的一个参数之外的其他参数。

有什么办法可以保持同样有用的结构吗？请注意，我不能简单地传递每个验证的结果，因为如果较早的验证返回“中止”错误代码（验证加载数据，因此这是性能要求），我不想运行剩余的验证。

谢谢，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:57:28.430

如果您在调用时知道附加参数，`ValidateSet()`那么您可以执行以下操作

```
ValidateSet(
    input,
    input_type => ValidateX(input_type, additional_param1),
    input_type => ValidateY(input_type, something2),
    ValidateZ
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:04:36.923

取决于这些其他参数是什么，但可能是一个结构

```
struct
{
  public InputType  Input {get;set;}
  public int OtherArgument {get;set;}
} 
```

所以你的一个参数输入变成了一桶参数，其中一个是输入

# android - Android 上的 PhoneGap Build 应用程序挂起（Phonegap Build .apk Samsung Note）

> ID：10807821
> 
> 赞同：0
> 
> 时间：2012-05-29T22:48:53.110
> 
> 标签：android, cordova, ripple

嘿，我已经从 Phonegap Build 下载了我的 apk 文件，我的应用程序在安装后启动它时就挂在那里（通过 qrcode 下载）。有一个白色的屏幕和一个不停的加载圆圈动画。我正在从我的公共 git 存储库中提取代码。我不知道如何调试这个。当应用程序非常基本时，一切都很好，但是在我的设备上添加 gps 功能后失败了。应用程序在本地计算机上的浏览器中运行良好，在 Ripple 中也可以正常运行。仅在 Android 设备上测试。谢谢！

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T01:30:18.417

我使用[adb logcat](http://developer.android.com/guide/developing/tools/logcat.html)从电话中获取堆栈跟踪。如果幸运的话，堆栈跟踪将提供明确的答案。

当您将 GPS 添加到应用程序时，您是否将 GeoLocation 权限添加到清单？你需要得到`http://api.phonegap.com/1.0/geolocation`许可`config.xml`吗？ [https://build.phonegap.com/docs/config-xml](https://build.phonegap.com/docs/config-xml)

# javascript - JavaScript 可以在重新加载后保持任何状态吗？

> ID：10807822
> 
> 赞同：4
> 
> 时间：2012-05-29T22:49:00.113
> 
> 标签：javascript

有没有办法让 JavaScript 通过重新加载来保存任何变量？

如果用户点击重新加载按钮，一旦页面重新加载，JavaScript 是否会保留任何状态？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T22:53:36.180

建议

*   曲奇饼
*   HTML 5 网络存储[https://www.w3schools.com/html/html5_webstorage.asp](https://www.w3schools.com/html/html5_webstorage.asp)

无论哪种方式，您都需要编写自己的读/写方法来存储您的状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T22:52:37.293

您将不得不使用 cookie 来维持您的状态。如果您使用的是 jQuery，我建议您查看 jQuery Cookie：

[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

希望这对你有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-02T07:51:09.320

URL后缀可以存储小数据（2KByte）

片段编号：`//host/path#fragment-id`

请求参数：`//host/path?query-string`

fragment-id-method 在这里使用：http:
[//xkcd-map.rent-a-geek.de/](http://xkcd-map.rent-a-geek.de/)
在每个 dragend-event 上，URL 都会更改
以反映地图上的当前位置

特殊字符必须是 urlencode-d

相关：[热重载](https://github.com/hasura/awesome-live-reloading)、[可重载代码](https://figwheel.org/docs/reloadable_code)、[figwheel.clj](https://www.youtube.com/watch?v=j-kj2qwJa_E)、[react.js 热加载器](https://github.com/gaearon/react-hot-loader)

# haskell - wai 的意外管道行为

> ID：10807824
> 
> 赞同：3
> 
> 时间：2012-05-29T22:49:09.227
> 
> 标签：haskell, conduit, haskell-wai

我正在尝试使用 wai 编写一个非常微不足道的“回声”网络应用程序；我想要它做的就是回复发布给它的数据（我真的不关心该方法，但我正在使用 curl 并且 curl 正在使用 POST，所以这就是我想要的）。我的微不足道的网络服务器是这样的：

```
import Network.Wai
import Network.HTTP.Types (status200)
import Network.Wai.Handler.Warp (run)
import Control.Monad.Trans ( liftIO )
import Blaze.ByteString.Builder.ByteString (fromByteString)
import qualified Data.Conduit.List as CondList
import Data.Conduit ( ($$), ($=), Flush(Chunk) )

application req = do
  let src = requestBody req $= CondList.map (Chunk ∘ fromByteString)
  return $ ResponseSource status200 [("Content-Type", "text/plain")] src

main = run 3000 application 
```

我期望这样做基本上是将请求正文与响应正文联系起来，这样当我运行`curl --data @/usr/share/dict/words localhost:3000`; 它会向我吐出我的话。相反，它给出了一个空的身体。使用“-v”运行 curl 表明我的应用正在回复“200 OK”并且没有数据。我不确定我在这里做错了什么。

如果我用这个替换应用程序功能：

```
_ ← requestBody req $$ CondList.mapM_ (liftIO ∘ print)
return $ responseLBS status200 [("Content-Type", "text/plain")] "Hello world\n" 
```

并添加一个 OverloadedStrings 杂注以允许“Hello World”部分工作，然后我确实看到我的应用程序将整个请求正文打印到标准输出，所以我知道 curl 正在正确提交数据。我还将“Hello World”打印到 curl 标准输出，所以我知道 curl 按我的预期工作。在将 requestBody 绑定到 ResponseSource 的地方，我一定做错了，但我没有看到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T01:28:12.847

您正确使用`conduit`，问题是您尝试获得的流式传输行为无法在 HTTP 上下文中可靠地工作。本质上，您希望在客户端发送请求正文时开始发送响应正文。这可能导致死锁，因为客户端和服务器都可能卡在发送模式。为了避免这种情况，Warp 在发送响应之前刷新请求正文，这就是为什么在发送响应正文时请求正文显示为空的原因。

为了使回显行为正确，您需要严格使用请求正文，然后将其发回。显然，如果请求体很大，从内存使用的角度来看，这可能会出现问题，但这是 HTTP 的固有方面。如果您想要持续的内存回显，我的建议是将请求正文流式传输到文件，然后`ResponseFile`用于响应正文。

# iphone - 索引路径是什么意思？

> ID：10807827
> 
> 赞同：2
> 
> 时间：2012-05-29T22:49:24.047
> 
> 标签：iphone

我是 iPhone 开发的新手。我尝试操作tableview。所以我看到了一些示例代码和书籍。但我不明白 是什么意思`indexPath`。

这是一行代码。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath ; 
```

请为我解释一下他的`indexPath`参数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T22:52:10.227

它包含相关单元格的节号和行号。你可以写`indexPath.section`和`indexPath.row`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T22:55:13.013

> NSIndexPath 类表示嵌套数组集合树中特定节点的路径。

一个表有部分和行，要知道行在哪里，您需要知道它在哪个部分的索引以及它在该部分中的索引位置。

`UIKit`添加一个类别以使其更易于使用`UITableView`'s.

```
@interface NSIndexPath (UITableView)

+ (NSIndexPath *)indexPathForRow:(NSInteger)row inSection:(NSInteger)section;

@property(nonatomic,readonly) NSInteger section;
@property(nonatomic,readonly) NSInteger row;

@end 
```

# jquery - 将 pdf 封面捕获为照片

> ID：10807837
> 
> 赞同：0
> 
> 时间：2012-05-29T22:50:09.137
> 
> 标签：jquery, pdf, plugins, web, image

我是 Web 应用程序的新开发人员。

现在我正在向我的服务器上传文件 (PDF)，我需要一张用户上传的 PDF 封面的图片。

我尝试为此找到 jquery 插件。

您知道任何相关的 JQuery 插件或技术吗？

看待，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T22:52:59.727

您将需要使用 PHP 之类的东西来执行此服务器端。PHP 有 PDF 和图像库，可以让你做到这一点。我会改为搜索那个而不是 jQuery

# openldap - 当节点脱机时，OpenLdap Master / Master 复制停止

> ID：10807840
> 
> 赞同：0
> 
> 时间：2012-05-29T22:50:44.780
> 
> 标签：openldap

我目前正在使用 Ubuntu 10.04（我已经在 RHEL 5.x 上进行了设置，但 Ubuntu 中的配置方式不同）。

无论如何，起初我认为我一切正常。当我对 ldap01 进行更新时，我立即看到了 ldap02 的变化。但是，如果我在 ldap02（或 01）上删除 slapd 并将 LDAP 条目添加到 ldap01 中，然后将 ldap02 的 slapd 进程重新联机，我将永远看不到在 slapd 在 ldap02 上关闭时创建的条目。新条目继续在 ldap01 和 ldap02 之间传播，只要两个服务器都运行 slapd 进程，但是当 slapd 在 ldap02 上关闭时创建的条目永远不会传播到 02。

这是我的配置和 ldap 版本：

ii slapd 2.4.21-0ubuntu5.7 OpenLDAP 服务器 (slapd)

---- /etc/ldap/slapd.d/cn=config/olcDatabase={0}config.ldif -----

```
# AUTO-GENERATED FILE - DO NOT EDIT!! Use ldapmodify.
# CRC32 deacdc79
dn: olcDatabase={0}config
objectClass: olcDatabaseConfig
olcDatabase: {0}config
olcAccess: {0}to * by dn.exact=gidNumber=0+uidNumber=0,cn=peercred,cn=external
 ,cn=auth manage by * break
olcAccess: {1}to attrs=userPassword,shadowLastChange by self write by anonymou
 s auth by dn="cn=admin,dc=example,dc=net" write by * none
olcAccess: {2}to * by self write by dn="cn=admin,dc=example,dc=net" write b
 y * read
structuralObjectClass: olcDatabaseConfig
entryUUID: 19eb3cc6-3898-1031-954c-351a2fbb42e9
creatorsName: cn=config
createTimestamp: 20120522202605Z
olcSyncrepl: {0}rid=001 provider="ldap://ldap-01:389" type=refreshAndPer
 sist retry="5 5 300 +" searchbase="cn=config" attrs="*,+" bindmethod=simple b
 inddn="cn=admin,dc=example,dc=net" credentials="secret"
olcSyncrepl: {1}rid=002 provider="ldap://ldap-02:389" type=refreshAndPer
 sist retry="5 5 300 +" searchbase="cn=config" attrs="*,+" bindmethod=simple b
 inddn="cn=admin,dc=example,dc=net" credentials="secret"
olcMirrorMode: TRUE
entryCSN: 20120528195647.027315Z#000000#000#000000
modifiersName: cn=admin,dc=example,dc=net
modifyTimestamp: 20120528195647Z 
```

---- /etc/ldap/slapd.d/cn=config/olcDatabase={0}config/olcOverlay={0}syncprov.ldif ----

```
# AUTO-GENERATED FILE - DO NOT EDIT!! Use ldapmodify.
# CRC32 807029fa
dn: olcOverlay={0}syncprov
objectClass: olcOverlayConfig
objectClass: olcSyncProvConfig
olcOverlay: {0}syncprov
olcSpNoPresent: TRUE
structuralObjectClass: olcSyncProvConfig
entryUUID: 3be00cb6-3dee-1031-8f60-519aa1b6f74f
creatorsName: cn=admin,dc=example,dc=net
createTimestamp: 20120529152514Z
entryCSN: 20120529152514.987191Z#000000#000#000000
modifiersName: cn=admin,dc=example,dc=net
modifyTimestamp: 20120529152514Z 
```

---- /etc/ldap/slapd.d/cn=config/olcDatabase={1}hdb.ldif ----

```
# AUTO-GENERATED FILE - DO NOT EDIT!! Use ldapmodify.
# CRC32 1b0a3130
dn: olcDatabase={1}hdb
objectClass: olcDatabaseConfig
objectClass: olcHdbConfig
olcDatabase: {1}hdb
olcDbDirectory: /var/lib/ldap
olcSuffix: dc=example,dc=net
olcAccess: {0}to attrs=userPassword,shadowLastChange by self write by anonymou
 s auth by dn="cn=admin,dc=example,dc=net" write by * none
olcAccess: {1}to dn.base="" by * read
olcAccess: {2}to * by self write by dn="cn=admin,dc=example,dc=net" write b
 y * read
olcLastMod: TRUE
olcRootDN: cn=admin,dc=example,dc=net
olcRootPW:: e1NTSEF9Ni9IZWJCczRTbmJQYlc4NHFOMWxHWUI5NVNoVUl4U20=
olcDbCheckpoint: 512 30
olcDbConfig: {0}set_cachesize 0 2097152 0
olcDbConfig: {1}set_lk_max_objects 1500
olcDbConfig: {2}set_lk_max_locks 1500
olcDbConfig: {3}set_lk_max_lockers 1500
olcDbIndex: objectClass eq
structuralObjectClass: olcHdbConfig
entryUUID: 19ebfdc8-3898-1031-9554-351a2fbb42e9
creatorsName: cn=config
createTimestamp: 20120522202605Z
olcSyncrepl: {0}rid=001 provider="ldap://ldap-01:389" type=refreshAndPer
 sist retry="5 5 300 +" searchbase="dc=example,dc=net" attrs="*,+" bindmeth
 od=simple binddn="cn=admin,dc=example,dc=net" credentials="secret"
olcSyncrepl: {1}rid=002 provider="ldap://ldap-02:389" type=refreshAndPer
 sist retry="5 5 300 +" searchbase="dc=example,dc=net" attrs="*,+" bindmeth
 od=simple binddn="cn=admin,dc=example,dc=net" credentials="secret"
olcMirrorMode: TRUE
entryCSN: 20120528195647.026244Z#000000#000#000000
modifiersName:  cn=admin,dc=example,dc=net
modifyTimestamp: 20120528195647Z 
```

----- /etc/ldap/slapd.d/cn=config/olcDatabase={1}hdb/olcOverlay={0}syncprov.ldif ----

```
# AUTO-GENERATED FILE - DO NOT EDIT!! Use ldapmodify.
# CRC32 807029fa
dn: olcOverlay={0}syncprov
objectClass: olcOverlayConfig
objectClass: olcSyncProvConfig
olcOverlay: {0}syncprov
olcSpNoPresent: TRUE
structuralObjectClass: olcSyncProvConfig
entryUUID: 3be00cb6-3dee-1031-8f60-519aa1b6f74f
creatorsName: cn=admin,dc=example,dc=net
createTimestamp: 20120529152514Z
entryCSN: 20120529152514.987191Z#000000#000#000000
modifiersName: cn=admin,dc=example,dc=net
modifyTimestamp: 20120529152514Z 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:53:10.597

升级了我的 OpenLDAP 版本，我的问题消失了

# jquery - 追加后动态图像加载？

> ID：10807842
> 
> 赞同：3
> 
> 时间：2012-05-29T22:50:58.117
> 
> 标签：jquery

我面临的问题是，在将 div 中的一堆图像（每个 div 一个）附加到容器（div）之后，我没有得到 onload 函数。

这是在一个循环中，包括一堆变量

```
$('#container').append('<div class="tile" style="position:absolute; top:'+(i*size)+'px; left:'+(j*size)+'px; width:'+size+'px; height:'+size+'px; overflow:hidden;" ><img src="'+map[i][j]+'"/></div>'); 
```

所有变量都很好，所有图像都正确加载，但这永远不会起作用

```
$('.tile img').live('load', function(){
console.log("loaded");
}); 
```

或者

```
$('.tile img').on('load', function(event){
console.log("loaded");
}); 
```

我已经尝试过使用较新的 .on jQuery 函数，但不行..

编辑：[+]添加了 .on 代码（两个函数都放在文档准备好后的右上角）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-29T23:09:25.240

更新：我玩了一下，以下策略也适用于新创建的图像上的加载事件。首先，我创建图像，然后将其附加到 div 中，然后再将其附加到文档中。

[http://jsfiddle.net/lucuma/sHGm9/1/](http://jsfiddle.net/lucuma/sHGm9/1/)

```
$('.slideshow').each(function(i) {

    var $img = $('<img src="..." />').on('load', function(){
        alert('loaded');
    });

    $(this).append( $('<div class="tile" style="" ></div>').append($img) );               
    // you'd need to just use your div example here

}); 
```

原答案：

我可以想到两件事。在附加之前添加 on/live 或将其更改为以下内容：

```
var $img = $('<img src="..." />');

$img.on('load', function() {
    alert('loaded');
});

$('#slideshow').append($img);  // adapted for my example 
```

[http://jsfiddle.net/lucuma/sHGm9/](http://jsfiddle.net/lucuma/sHGm9/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-19T06:34:57.187

我知道这是一篇旧帖子，但我最近不得不处理这个确切的问题，并找到了一个稍微简单的解决方案：

```
$(".container").append(yourImageOrImages);
setImages();

function setImages() {
    $(".container img").each(function() {
        $(this).on('load', function(){
            // Your code to run when done loading
        });
    });
} 
```

# c# - 带有 mvc 3 sql 成员资格提供程序的 elmah

> ID：10807843
> 
> 赞同：0
> 
> 时间：2012-05-29T22:51:01.627
> 
> 标签：c#, asp.net-mvc-3, configuration, elmah

使用 nuget 安装 elmah 并立即运行非常容易。

尝试使用密码保护页面时遇到了挑战。

在我拥有的项目中，有一个`Admin controller`我使用 mvc 3 sql 会员提供程序，当您启动 mvc 3 应用程序时，它会开箱即用。默认 impl 不使用任何角色。它只是验证用户，并且只有授权用户才能使用管理员。

在 elmah 日志中：

```
<authorization>  
    <allow roles="admin" />  
    <allow roles="dev" />  
    <deny users="*" />  
</authorization> 
```

这是如何运作的？我如何定义和传递这些角色，以便 elmah 理解这一点？

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T00:05:24.303

你看起来是在正确的轨道上。由于您信任任何登录用户，因此您首先拒绝匿名用户访问，然后允许授权用户访问，如下所示：

```
<authorization>
  <deny users="?"/>
  <allow users="*"/>
</authorization> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T00:29:30.513

Alexander Beletsky 有一个 Nuget 包，可以很容易地将 Elmah 与 MVC 和基于角色的安全性集成：[Elmah.MVC](http://nuget.org/packages/Elmah.MVC)。它工作得很好，并创建了一个可以通过角色保护的控制器，并且还允许良好的路由。

这是[项目页面](https://github.com/alexanderbeletsky/elmah.mvc.controller)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T01:47:30.997

对于 MVC3 应用程序，您可能需要考虑[Elfar](http://sourceforge.net/p/elfar/wiki/Home/)而不是 Elmah。Elfar 受到 Elmah 的“启发”，但更简单且易于正确配置。有几个具有多种数据库类型的 nuget 包。

我发现 Elmah 比复杂异常处理所需的要重得多。Elfar 要简单得多。

# android - 布局土地不起作用？

> ID：10807846
> 
> 赞同：1
> 
> 时间：2012-05-29T22:51:05.573
> 
> 标签：android, xml, layout, orientation, onconfigurationchanged

我对这个问题做了一些研究，但我找不到我的答案。所以，是的，我确实在 res 下创建了一个名为“layout-land”的文件夹，并在其中放置了一个单独的 main.xml。我故意删除了layout-land的main.xml中的一些图像，当我将android手机旋转到水平位置时，我注意到这些图像仍然存在。

许多与我类似的问题都是由于在清单中添加 onConfigurationChanged 引起的。但是我没有添加任何东西来显示这个链接解释的

[layout-land xml 文件不适用于 onConfigurationChanged 回调](https://stackoverflow.com/questions/5336614/layout-land-xml-files-does-not-work-with-onconfigurationchanged-call-back)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T22:57:47.973

您必须检查的第一件事是您是否已经拥有`Manifest.xml` `android:configChanges="orientation"`这意味着您希望在方向改变时控制活动的状态。当方向发生变化时，Android 将破坏您的活动并重新创建新活动，因此任何数据都将丢失。

所以你应该使用`onConfigurationChanged()`方法或`onRetainNonConfigurationInstance()`方法。

我建议你阅读一些教程。

# javascript - KendoUI line Graph，如何防止标签被绘制到图形之外？

> ID：10807849
> 
> 赞同：6
> 
> 时间：2012-05-29T22:51:17.433
> 
> 标签：javascript, jquery, asp.net, telerik, kendo-ui

我正在使用 KendoUI 折线图。我在折线图上有标签，标签在顶部被切断。有没有办法防止这种情况？

![KendoUI 折线图](../Images/64ff1e18168a9fb909cebbdc25674f1f.png)

这是一个可以玩的 jsFiddle 项目：http: [//jsfiddle.net/rodneyhickman/2eWYg/1/](http://jsfiddle.net/rodneyhickman/2eWYg/1/)

这是我的标记：

```
<div style="padding:20px;" >
   <div id="divChart"></div>
</div> 
```

这是我的脚本：

```
jQuery('#divChart').kendoChart({
seriesDefaults: {
    type: "line",
    missingValues: "interpolate"
},
legend: {
    position: "bottom"
},
tooltip: {
    visible: true,
    format: "{0}%"
},
valueAxis: {
    min: 70,
    max: 90,
    plotBands: [{
        from: 70,
        to: 75,
        color: "#f5f5f5"},
    {
        from: 80,
        to: 85,
        color: "#f5f5f5"},
    {
        from: 90,
        to: 95,
        color: "#f5f5f5"}]
},
series: [{
    type: "line",
    name: "Product 1",
    color: "#004990",
    width: 1,
    markers: {
        background: "#004990"
    },
    tooltip: {
        visible: true,
        template: "<b>Product 1</b><br/>Current Score: #= value #<br/>#= category # "
    },
    labels: {
        visible: true
    },
    data: [88.71, 88.87, 88.91, 89.39, 89.44, 89.47, 89.39, 89.38, 89.25, 88.81, 88.9, 88.84, 88.79]},
{
    type: "line",
    name: "Market Segment",
    color: "#da7633",
    width: 1,
    markers: {
        background: "#da7633"
    },
    tooltip: {
        visible: true,
        template: "<b>Market Segment</b><br/>Current Score: #= value #<br/>#= category # "
    },
    data: [75.9, 75.58, 75.54, 75.19, 74.9, 74.42, 74.51, 74.72, 74.55, 74.44, 74.15, 73.86, 73.79]}],
categoryAxis: {
    labels: {
        rotation: -45,
        step: 1,
        skip: 0
    },
    categories: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "Jan - 2012", "Feb", "Mar", "Apr"]
}
});​ 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-30T15:17:59.607

通过向 plotArea 添加边距，它为标签腾出空间。

plotArea：{边距：{上：20，左：5，右：5，下：5}}，

这是解决方案：

[http://jsfiddle.net/rodneyhickman/2eWYg/2/](http://jsfiddle.net/rodneyhickman/2eWYg/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-02T00:54:39.090

您可以配置系列以在点下方添加标签 - 根据[文档](http://docs.telerik.com/kendo-ui/api/javascript/dataviz/ui/chart#configuration-series.notes.position)；

```
notes: {
  position: "bottom"
}, 
```

# macos - 使用 Cocoa 识别地址簿记录的类型 [内部或 LDAP]

> ID：10807853
> 
> 赞同：2
> 
> 时间：2012-05-29T22:52:06.680
> 
> 标签：macos, cocoa, abaddressbook

MacOS X 地址簿允许使用 LDAP 订阅电子名片/记录。

**我需要知道，是否存在有据可查的基于 Cocoa 的识别方式，记录是否来自 LDAP 或地址簿自己的/本地 SQLite DB。**

如果没有官方方法存在，我可能会尝试修改记录。如果失败，我怀疑记录来自 LDAP 服务器。

# visual-c++ - 编译器在不设置变量的情况下省略常量的赋值

> ID：10807856
> 
> 赞同：0
> 
> 时间：2012-05-29T22:52:20.937
> 
> 标签：visual-c++

我正在使用 VC++ 2010 Express。我写了以下例程：

```
HRESULT DLTimeStampNow::Receive(IMediaSample *pSample)
{
    long long fnum, fnum2;
    REFERENCE_TIME timeStart=0, timeEnd=10000;

    // make this sample available for the next worker-thread call to Transform()

    pSample->AddRef();

    CRefTime rtStream;

    timeStart = 0;
    timeEnd = 10000;

    pSample->SetTime(&timeStart, &timeEnd);

    EnterCriticalSection(&cs);

    if (pSampleWaiting != NULL)
        ((IMediaSample*)pSampleWaiting)->Release();

    pSampleWaiting = pSample;

    SetEvent(hSampleIsReady);

    LeaveCriticalSection(&cs);

    return S_OK;
} 
```

这是正在进行的工作的一部分，这就是为什么 fnum 和 rtStream 等变量存在但未使用的原因。

在运行时，VC++ 调试器拒绝在`timeStart = 0`or处放置断点`timeEnd = 10000`，这很好，只是它也*无法初始化它们*。调试器显示它们在执行到达时包含垃圾`pSample->SetTime(&timeStart, &timeEnd);`。为了解决这个问题，我在变量声明中添加了`=0`和。`=10000`这行得通，但为什么有必要呢？我猜编译器正在做某种优化，它避免了代码中的常量赋值，但它也忘记了（？）实际上为`timeStart`and赋值`timeEnd`（除非我在他们的声明语句中初始化它们，如上所述）。

是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T02:42:09.767

编译器优化可以做各种事情来导致这种行为，例如将局部变量存储在寄存器中或将一次性变量转换为常量。如果您想了解发生了什么，一种方法是在调试器中使用程序集视图/模式来查看函数调用之前和之后发生的情况`SetTime`。

# ios5 - setCompletionBlock：仅在模拟器中导致 EXC_BAD_ACCESS ..它在设备上工作正常

> ID：10807870
> 
> 赞同：0
> 
> 时间：2012-05-29T22:53:39.007
> 
> 标签：ios5, asihttprequest, exc-bad-access, asiformdatarequest

在模拟器中，使用 ASIHTTPRequest 的 setCompletionBlock: 消息总是会导致 EXC_BAD_ACCESS 错误。即使将 NSZombieEnabled 设置为 YES 也无法说明情况。

```
__weak ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

[request setCompletionBlock:^{
        int statusCode = [request responseStatusCode];
        NSLog(@"%d",statusCode);
          }];

 [request setFailedBlock:^{  
        // send statuscode error back
        int statusCode = [request responseStatusCode];
        NSLog(@"%d",statusCode);
    }];

    [request startAsynchronous]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:32:54.663

好的，所以花了 2 天后，我终于找到了解决方案：修复我的链接器标志

本质上，您必须将 -weak_library /usr/lib/libSystem.B.dylib 更改为 -weak-lSystem。

我最初添加这个是因为 Urban Airship 需要它。

非常感谢以下参考：

[复制或保留块时的 EXC_BAD_ACCESS](https://stackoverflow.com/questions/7111541/exc-bad-access-when-copying-or-retaining-block/7115171#7115171)

[iPhone模拟器在应用程序启动时崩溃](https://stackoverflow.com/questions/6790848/iphone-simulators-crash-on-app-launch)

# wpf - 如何重新设置 XamNumericGrid 向上/向下按钮的样式？

> ID：10807872
> 
> 赞同：1
> 
> 时间：2012-05-29T22:53:54.993
> 
> 标签：wpf, styles, infragistics

在 Infragistics NetAdvantage 中，如何重新设置 XamNumericEditor 上/下按钮的样式？

我查看了 DefaultStyles，这有点难以理解。

1.  XamNumericEditor 样式为空；它只是 XamMaskedEditor 的别名。
2.  但是，XamMaskedEditor 似乎没有在其中定义任何向上/向下按钮。这是如何运作的？

如果我能找到一个可靠的不太复杂的例子，那就太好了。

感谢任何能提供帮助的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:30:53.620

这是来自 DefaultStyle EditorsGeneric.xaml 的片段：

```
<Grid x:Name="PART_SpinButtons" DockPanel.Dock="Right" Visibility="{TemplateBinding SpinButtonVisibilityResolved}" Margin="0,1">
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="1"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <!-- AS 2/25/11 TFS67071 -->
    <RepeatButton x:Name="spinUp" Style="{TemplateBinding SpinButtonStyle}" Focusable="false" ContentTemplate="{DynamicResource {x:Static igEditors:EditorsBrushKeys.IncreaseGlyphKey}}"/>
    <RepeatButton x:Name="spinDown" Style="{TemplateBinding SpinButtonStyle}" Focusable="false" Grid.Row="2" ContentTemplate="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DecreaseGlyphKey}}"/>
</Grid> 
```

如您所见，您可以设置 SpinButtonStyle 以更改应用程序中 spinButton 的外观。如果您也想更改内容（按钮中的向上/向下箭头），您可以覆盖 EditorBrushKeys 资源。

以下是有关如何更改样式的示例：

```
<Grid>
  <Grid.Resources>
    <!-- Change Content of the Repeat Buttons -->
    <DataTemplate x:Key="{x:Static igEditors:EditorsBrushKeys.IncreaseGlyphKey}">
      <Path
        Width="7"
        Height="4"
        Data="M 0 4 L 8 4 L 4 0 Z"
        Fill="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnGlyphNormalForegroundFillKey}}"/>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static igEditors:EditorsBrushKeys.DecreaseGlyphKey}">
      <Path
        Width="7"
        Height="4"
        Data="M 0 0 L 4 4 L 8 0 Z"
        Fill="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnGlyphNormalForegroundFillKey}}"/>
    </DataTemplate>

    <!-- Change properties on the button -->
    <Style x:Key="mySpinButtonStyle" TargetType="{x:Type RepeatButton}">
      <Setter Property="Background" Value="Green"/>
    </Style>
  </Grid.Resources>

  <igEditors:XamNumericEditor SpinButtonDisplayMode="Always" x:Name="myEditor" Value="10" Width="120" Height="40" SpinButtonStyle="{StaticResource mySpinButtonStyle}"/>
</Grid> 
```

# matlab - matlab：评估向量时的错误/精度

> ID：10807874
> 
> 赞同：4
> 
> 时间：2012-05-29T22:54:07.303
> 
> 标签：matlab

我注意到在评估向量时对我来说是一种无法预料的行为。直接执行它似乎与在循环中建立索引确实不同。谁能给我一些帮助？我知道可能解释了它是如何进行每个操作的，所以我需要一些关于如何查找它的键

感谢您的建议提前感谢

例子：

```
x=[0.05:.01:3];
n=size(x,2);
y1 = (8*x-1)/(x)-(exp(x));

for i=1:n
    y2(i)=(8*x(i)-1)/(x(i))-(exp(x(i)));
end

a1=[x;y1];
a2=[x;y2];

plot(x,y1, 'red')
hold on
plot(x,y2, 'blue') 
```

这里的情节：http: [//i.stack.imgur.com/qAHD6.jpg](http://i.stack.imgur.com/qAHD6.jpg)

结果：

```
a2:
0.05   -13.0513
0.06   -9.7285
0.07   -7.3582
0.08   -5.5833
0.09   -4.2053
0.10   -3.1052
0.11   -2.2072
0.12   -1.4608
0.13   -0.8311
0.14   -0.2931
0.15   0.1715
0.16   0.5765

a1:
0.05   6.4497
0.06   6.4391
0.07   6.4284
0.08   6.4177
0.09   6.4068
0.10   6.3958
0.11   6.3847
0.12   6.3734
0.13   6.3621
0.14   6.3507
0.15   6.3391
0.16   6.3274 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T23:05:37.593

你想要的是：

```
 y1 = (8*x-1)./(x)-(exp(x));   % note the ./ 
```

代替：

```
 y1 = (8*x-1)/(x)-(exp(x)); 
```

作为旁注，您可以键入`help /`以查看您最初的第一个语句实际上在做什么。它正在有效地做`(x'\(8*x-1)')'`（注意反斜杠）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T23:05:36.753

错误出现在您对 y1 的第一次向量计算中。问题出在除以 x 的部分。向量/矩阵除法不同于单元素除法，将返回向量/矩阵结果。

解决方案是对这些向量进行逐个元素的划分。用于此的矢量符号快捷方式是使用 ./（点分隔）：

```
y3 = (8*x-1)./(x)-(exp(x)); 
```

现在您应该发现 y2 和 y3 是相同的。

# subprocess - python子进程通信挂起调用shell脚本

> ID：10807875
> 
> 赞同：3
> 
> 时间：2012-05-29T22:54:12.497
> 
> 标签：subprocess, python-3.2

使用 python 3.2 和以下代码片段：

```
p = subprocess.Popen(['../start_server.sh'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
out,err = p.communicate()

if out != None :
   out = out.decode('utf-8')
if err != None :
   err = err.decode('utf-8')

print('out ',out)
print('err ',err) 
```

在一些 shell 脚本上，它工作得很好，我得到了我的输出。在其他人它只是挂起。但在每种情况下，shell 脚本都从命令行运行而没有错误。我能看到的唯一共同点是（通常）挂起的那些输出为零。当事情失败时，我检查正在运行的进程，我看到我的 shell 脚本没有列出，python 脚本仍在运行

调用 shell 脚本并**始终**将控制权返回给我的 python 程序的可靠方法是什么？

* * *

**编辑：**

使用管道 Popen 等不是必需的，唯一的要求是当 shell 脚本退出时控制权返回给我的 python 脚本。如果 shell 脚本永远不会返回到命令提示符，那么我的 python 脚本也永远不会返回。

因此，假设我调用的 shell 脚本总是返回到命令提示符，我怎样才能将控制权返回给我的 python 程序？
如果有比上面列出的更好的方法-请赐教

我发现的另外一点是“挂起”的 shell 脚本似乎以调用“nohup”结束，他们毫无问题地返回命令提示符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T20:15:57.183

> 调用 shell 脚本并始终将控制权返回给我的 python 程序的可靠方法是什么？

如果您使用管道，这将取决于您的脚本；一个更一般的答案本质上是[停止问题](http://en.wikipedia.org/wiki/Halting_problem)，即使是强大的 StackOverflow 也无法帮助您解决这个问题。

我鼓励您深入挖掘并尝试创建一个可重现的案例，以便我们可以帮助您解决您遇到的特定问题。

**编辑**

如果您不需要管道，则只需省略 stdout 和 stderr 参数（或将它们设置为 以外的其他值`PIPE`）。请参阅[python 子进程管理](http://docs.python.org/library/subprocess.html)。

# javascript - 有没有办法在每次单击鼠标左键时模拟 Ctrl 按下？

> ID：10807880
> 
> 赞同：0
> 
> 时间：2012-05-29T22:55:04.480
> 
> 标签：javascript, jquery, internet-explorer

我遇到了 Internet Explorer 问题。
您可能知道 FireFox 和 Google Chrome 在新选项卡中打开链接，如果链接`target="_blank"`.
但这在 Internet Explorer 中不起作用。

由于 InternetExplorers 标准选项，它会在新的弹出窗口中打开每个链接。如果您想在新选项卡中打开链接，则必须更改选项中的设置或每次单击链接时按“ctrl”。

所以现在我的问题是：有没有办法在每次单击鼠标左键时模拟 Ctrl 键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T23:21:40.687

此行为由 Internet Explorer 以自己的方式管理。

如果用户想要不同的东西，他可以将浏览器配置为按照您的建议行事。所以我的直接回答是“这不是你关心的”，而是 IE 或用户关心的问题。

我可以建议您的唯一解决方法是在同一页面中打开链接，并根据用户的智能右键单击/在 nw 选项卡操作中打开。

# php - PHP 编辑帖子

> ID：10807889
> 
> 赞同：0
> 
> 时间：2012-05-29T22:56:42.470
> 
> 标签：php, mysql, sql, pdo

我有一个非常烦人的问题。每当我编辑帖子时，**第**一次编辑时，它会丢失所有信息。搞不明白，搞了2天。

下面是表单代码：

```
<?php 
$post = htmlspecialchars($_GET["id"]);

$name = $_SESSION['Username'];
if (in_array($name, $allowedposters)) {
$results = mysql_query("SELECT * FROM tool WHERE id = $post");
    while($row = mysql_fetch_array($results)){

$title= $row['title'];
$details= $row['details'];
$date= $row['date'];
$author= $row['author'];
$id= $row['id'];

echo "<a href=story.php?id=";
echo $post;
echo ">Cancel edit</a> <br><br><b>";
echo $title;
echo "</b> <br><br>";
echo '
<form action="edit-new.php?story=';
echo $id;
echo '" method="post" enctype="multipart/form-data">
<textarea rows="1" cols="60" name="title" wrap="physical" maxlength="100">';
echo $title;
echo '</textarea><br>';
?>

<textarea rows="30" cols="60" name="details" wrap="physical" maxlength="10000">
<?php 
echo $details;
echo '</textarea><br>';

echo '<label for="file">Upload featured image:</label><br>
      <input type="file" name="file" id="file" />';
echo'<br><input type="submit" />';
}

} else {
  echo "Not enough permissions.";
}
?> 
```

. .

这是实际的 php 代码，将信息插入数据库：

. .

```
<?php
   $post = $_GET['story'];
   $title = $_POST['title'];
   $details = $_POST['details'];
         echo 'Updated.';
    $dbtype     = "mysql";
    $dbhost     = "localhost";
    $dbname     = "x";
    $dbuser     = "xx";
    $dbpass     = "xxx";
    $conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);
    $sql = "UPDATE  tool SET title=:title, details=:details WHERE id = '$post'";
        $q = $conn->prepare($sql);
        $q->execute(array(
        ':details'=>$details,
        ':title'=>$title,
         ));
?> 
```

再次，我想提一下，唯一的问题是，我**第**一次编辑帖子时，它会丢失它的信息。在那之后，它永远不会发生在那个特定的帖子上。

在那之后，编辑工作完美无缺。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:24:39.827

这并不能直接回答您的问题 - 了解您实际获取的`$_GET['id']`内容、数据库上运行的实际 SQL 以及表单生成的内容是什么样的会很有用。

然而：

```
$post = htmlspecialchars($_GET["id"]); 
```

是错的。`htmlspecialchars`转义数据以*输出*到客户端。为 SQL 编码特殊字符并不能保护您免受 SQL 注入攻击。

由于`$post`预计是一个整数（大概），这就足够了：

```
$post = (int)$_GET['id']; 
```

但一定要检查是否返回了一个有效的整数，如果不是，则抛出一个适当的错误。

不要忘记再次执行此操作`edit-new.php`- 更好的是，使用参数化值，就像您为`title`and所做的那样`details`。

最后，您*应该*使用`htmlspecialchars`转义`$details`和`$title`形式。否则内容 like`</textarea>`将无法正确显示，并且您容易受到 XSS 漏洞的攻击（例如，后跟`<script>alert("I'm going to do bad things now");</script>`

# mysql - 如何在像 MySQL 这样的 RDBMS 中存储双向关系？

> ID：10807900
> 
> 赞同：19
> 
> 时间：2012-05-29T22:58:02.813
> 
> 标签：mysql, database-design, relational-database, relationship

假设我想存储我的应用程序的用户之间的关系，类似于 Facebook，本身。

这意味着如果*A是**B*的朋友（或某种关系），那么*B*也是*A*的朋友。为了存储这种关系，我目前计划将它们存储在关系表中，如下所示

 **```
 UID      FriendID
 ------    --------
 user1      user2
 user1      user3
 user2      user1 
```

但是我在这里面临两个选择：

1.  典型情况下，我将同时存储`user1 -> user2`和`user2->user1`。这将占用更多空间，但（至少在我的脑海中）只需要一次通过行来显示特定用户的朋友。
2.  另一种选择是存储`user1->user2`OR`user2->user1`并且每当我想查找 的所有朋友时`user1`，我都会查询表的两列以查找用户的朋友。它将占用一半的空间，但（至少在我的脑海中）两倍的时间。

首先，我的推理是否恰当？如果是，那么我是否忘记了任何瓶颈（在扩展/吞吐量或其他方面）？

基本上，除了这里列出的之外，两者之间是否有任何权衡。另外，在工业中，一个比另一个更受欢迎吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-30T11:46:41.550

以下是这两种方法在数据库中的物理表示方式：

![在此处输入图像描述](../Images/699d6a818e48708ae0cbe9aa9cb8e9a2.png)

让我们分析这两种方法......

方法1（两个方向都存储在表中）：

*   PRO：更简单的查询。
*   *CON：仅*插入/更新/删除一个方向可能会损坏数据。
*   MINOR PRO：不需要额外的限制来确保友谊不能被复制。
*   需要进一步分析：
    1.  TIE：一个索引[涵盖](http://use-the-index-luke.com/sql/glossary/covering-index)两个方向，因此您不需要二级索引。
    2.  TIE：存储要求。
    3.  领带：性能。

方法2（表中只存储一个方向）：

*   CON：更复杂的查询。
*   PRO：不会因为忘记处理相反的方向而损坏数据，因为*没有相反的方向*。
*   MINOR CON: 需要`CHECK(UID < FriendID)`，所以相同的友谊永远不能用两种不同的方式来表示，而钥匙`(UID, FriendID)`可以完成它的工作。
*   需要进一步分析：
    1.  TIE：需要两个索引来[覆盖](http://use-the-index-luke.com/sql/glossary/covering-index)查询的两个方向（复合索引 on`{UID, FriendID}`和复合索引 on `{FriendID, UID}`）。
    2.  TIE：存储要求。
    3.  领带：性能。

第**1 点**特别有趣。MySQL/InnoDB*总是对数据进行* [集群](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)，而在集群表中二级索引可能很昂贵（请参阅[本文](http://www.ovaistariq.net/521/understanding-innodb-clustered-indexes/)中的“集群的缺点” ），因此方法 2 中的二级索引似乎会吃掉更少行的所有优势. **然而**，二级索引包含与主索引完全相同的字段（仅以相反的顺序），因此在这种特殊情况下没有存储开销。也没有指向表堆的指针（因为没有表堆），所以它可能比普通的基于堆的索引更便宜。并且假设查询被索引覆盖，通常也不会有与聚集表中的二级索引相关联的双重查找。因此，这基本上是平局（方法 1 和方法 2 都没有显着优势）。

第**2 点**与第 1 点相关：无论我们是拥有 N 个值的 B-Tree 还是拥有 N/2 个值的两个 B-Tree，都无关紧要。所以这也是一个平局：两种方法都将使用大约相同数量的存储空间。

同样的推理也适用于**第 3 点**：无论我们搜索一个较大的 B-Tree 还是搜索两个较小的 B-Tree，都没有太大区别，所以这也是平局。

因此，为了稳健性，尽管查询有些丑陋并且需要额外的`CHECK`，我还是采用方法 2。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T23:25:00.053

这些天存储相对便宜，所以我不会因此而担心。

我担心的是你现在必须清理，因为你存储了两次信息。因此，如果您“取消好友”某人，则必须删除 2 条记录，而不仅仅是一条。

其他考虑因素是搜索和索引。如果您遵循一致的约定（例如始终在散列之前将较高的 id 附加到较低的 id），则对 2 个用户 id 的组合进行散列以检查是否存在可能会有优势。

所以现在你有了其他的可能性。您是否有兴趣查询这 2 个用户之间的关系？还是看一个用户的属性更重要？

这些是对系统将做什么的担忧。查看 DDD（领域驱动设计）和 CQRS（命令查询职责分离）等主题，了解如何划分您的应用程序，以便以最简单的方式实现每个区域。这将为您提供稍后微调和优化的途径，而不会遇到复杂性问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-18T11:32:09.010

在[Branko Dimitrijevic](https://stackoverflow.com/users/533120/branko-dimitrijevic)的选项中选择选项 1 和选项 2 时，您应该考虑这一点：

您尝试设计的关系是对称的还是不对称的？

例如（不好的例子，但仍然说明了我的观点）如果您只是想知道两个用户是家人还是朋友，那么链接是对称的。如果一个用户是另一个家庭的成员，则反之亦然。可以考虑方法 2。

但是，如果您想要更具体的信息，例如一个人对另一个人是什么类型的家庭（是他们的父亲、儿子、叔叔吗？），那么它就变得不对称了。如果 A 是 B 的父亲，那么 B 是 A 的儿子/女儿。方法 1 可能成为必要。**

# java - 使用 Spring 配置 apache dbcp PoolingDataSource

> ID：10807902
> 
> 赞同：1
> 
> 时间：2012-05-29T22:58:04.163
> 
> 标签：java, spring, apache-commons-dbcp

尝试遵循 apache dbcp 示例中的模式，我了解所有内容，除了数据库属性的来源和来源以及它们必须放置在应用程序上下文中的 bean 中。

我改用了 Spring Data Source，但我记得我很匆忙地配置了它，而且我记得在配置 apache dbcp 本身提供的原始数据源时遇到了困难。所以正好有时间去面对问题，实现使用PoolingDataSource的初衷。

我使用 Spring 实现的原因是因为它提供了设置参数以连接到数据库的方法。

[http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/jdbc/datasource/DriverManagerDataSource.html](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/jdbc/datasource/DriverManagerDataSource.html)

根据[http://commons.apache.org/dbcp/apidocs/org/apache/commons/dbcp/PoolingDataSource.html](http://commons.apache.org/dbcp/apidocs/org/apache/commons/dbcp/PoolingDataSource.html)

没有方法可以填充配置，如 url 或加载驱动程序。

我试图通过对象池等来跟踪它，但真的迷路了。

预先回复：是的，我不想使用 apache basicDataSource。

所以现在我又回到了问题上，无法真正理解在哪里获取参数？司机？网址？似乎在连接工厂中设置了 url、pw 和用户名。但是在哪里获取要加载的 postgresql 驱动程序呢？

请帮助完成配置。

（使用弹簧进行配置）

```
<!-- the one I want to use now -->
  <bean id="dataSource" class="org.apache.commons.dbcp.PoolingDataSource">
     <constructor-arg><ref bean="pool"/></constructor-arg>
  </bean>

<!-- the one I used before as a workaround

<bean id="ds" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
   <property name="driverClassName" value="org.postgresql.Driver"/>
   <property name="url" value="jdbc:postgresql:postgres"/>
   <property name="username" value="magicUserName"/>
   <property name="password" value="magicPassword"/>
</bean>  -->

<bean id="pool" class="org.apache.commons.pool.impl.GenericObjectPool">
   <property name="minEvictableIdleTimeMillis"><value>300000</value </property>
   <property name="timeBetweenEvictionRunsMillis"><value>60000</value </property>
</bean>

<bean id="dsConnectionFactory" class="org.apache.commons.dbcp.DataSourceConnectionFactory">
   <constructor-arg><ref bean="dataSource"/></constructor-arg>
</bean>

<bean id="poolableConnectionFactory" class="org.apache.commons.dbcp.PoolableConnectionFactory">
    <constructor-arg index="0"><ref bean="dsConnectionFactory"/ </constructor-arg>
    <constructor-arg index="1"><ref bean="pool"/></constructor-arg>
    <constructor-arg index="2"><null/></constructor-arg>
    <constructor-arg index="3"><null/></constructor-arg>
    <constructor-arg index="4"><value>false</value></constructor-arg>
    <constructor-arg index="5"><value>true</value></constructor-arg>
</bean>

 <bean id="txManager"
        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>

 <tx:annotation-driven transaction-manager="txManager" />

</beans> 
```

我相信我们只对前两个感兴趣，但我包括了所有内容以防万一。

似乎有很多人使用解决方法：http: [//forum.springsource.org/showthread.php?10772 -How-do-I-create-a-org-apache-commons-dbcp-PoolableConnection](http://forum.springsource.org/showthread.php?10772-How-do-I-create-a-org-apache-commons-dbcp-PoolableConnection)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-15T18:35:56.433

您可以配置如下：

```
 <bean id="dataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="url" value="<put database connection url here>" />
    <property name="username" value="XXXXXX" />
    <property name="password" value="XXXXXXXX" />
    <property name="driverClassName" value="<database driver here>" />
</bean>

<bean id="pool" class="org.apache.commons.pool.impl.GenericObjectPool">
    <property name="minEvictableIdleTimeMillis"><value>300000</value></property>
    <property name="timeBetweenEvictionRunsMillis"><value>60000</value></property>
</bean>

<bean id="dsConnectionFactory" class="org.apache.commons.dbcp.DataSourceConnectionFactory">
    <constructor-arg><ref bean="dataSource"/></constructor-arg>
</bean>

<bean id="poolableConnectionFactory" class="org.apache.commons.dbcp.PoolableConnectionFactory">
    <constructor-arg index="0"><ref bean="dsConnectionFactory"/></constructor-arg>
    <constructor-arg index="1"><ref bean="pool"/></constructor-arg>
    <constructor-arg index="2"><null/></constructor-arg>
    <constructor-arg index="3"><null/></constructor-arg>
    <constructor-arg index="4"><value>false</value></constructor-arg>
    <constructor-arg index="5"><value>true</value></constructor-arg>
</bean>

<bean id="pooledDS" class="org.apache.commons.dbcp.PoolingDataSource" 
                                               depends-on="poolableConnectionFactory">
    <constructor-arg><ref bean="pool"/></constructor-arg>
</bean> 
```

并且你可以使用“pooledDS”(PoolingDataSource) 一样的任何orther DataSource。

否则，我认为您应该简单地使用 BacsicDataSource，您仍然可以通过“initialSize”和“maxActive”配置池中的连接数：

```
<bean id="basicDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${jdbc.driverClassName}"/>
        <property name="url" value="${jdbc.url}"/>
        <property name="username" value="${jdbc.username}"/>
        <property name="password" value="${jdbc.password}"/>
        <property name="removeAbandoned" value="true"/>
        <property name="initialSize" value="10" />
        <property name="maxActive" value="50" />
    </bean> 
```

# c# - 是否可以对有效的 mp3 字节数据进行单元测试？

> ID：10807915
> 
> 赞同：2
> 
> 时间：2012-05-29T23:00:34.377
> 
> 标签：c#, unit-testing, mp3, mime-types

我们正在使用 c# 返回 mp3 的字节数据，但 mp3 尚未正确编码，因此我们需要一种方法对其进行测试。

目前我们已经在我们的 mvc 中构建了一个使用该函数的页面，我们只需运行 url 以尝试将其加载到 mp3 播放器中。我敢肯定，这是一种笨拙的方法。我们应该如何*真正*测试有效的 mp3 字节数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:18:31.880

将系统拆分为多个部分并分别测试：

*   MP3 创建本身（作为字节数组/文件） - 可以通过使用一些命令行“MP3 to something”转换器或可以播放 MP3 的库进行测试。
*   为客户端生成 url
*   将给定文件流式传输到客户端（如果您需要在播放器中进行测试，则使用恒定的 MP3，否则任何字节数组都可以执行，只要它正确返回并带有正确的标头）。

# psexec - PSEXEC - 当两个帐户不同时更新 HKEY_CURRENT_USER

> ID：10807923
> 
> 赞同：1
> 
> 时间：2012-05-29T23:01:43.183
> 
> 标签：psexec

我从 Windows SysInternals 论坛上的帖子中读到了这篇文章。

HKCU - 配置单元密钥当前用户 - 将指向在 psexec 的帮助下在远程计算机上进行身份验证的用户的配置单元密钥。它不会指向以交互方式登录到计算机桌面的用户的配置单元密钥，除非两个帐户碰巧相同。

我在尝试将与自签名证书关联的签名者和证书推送到 Windows 注册表中的 HKEY_CURRENT_USER/Software/Microsoft/SystemCertificates/Root/Certificates 文件夹以供登录到远程计算机上的用户时遇到同样的问题。

如果 PsExec 使用的用户 ID 和密码与当前登录远程计算机的用户相同，则一切正常。PKCU 注册表项按预期添加。

由于我们无法向每个最终用户询问他们的 AD 密码，因此我试图弄清楚当两个帐户不相同时如何使该密码正常工作。我有一个 Windows 服务帐户，该帐户在我尝试将证书和签名者推送到的域中的所有 PC 上都具有管理员权限。如果我将该帐户与 psexec 一起使用，则不会为登录到远程 PC 的用户添加注册表项。

当两个帐户不相同时，有什么方法可以使用 psexec 写入 HKEY_CURRENT_USER 吗？也就是说，当与 psexec 命令一起使用的帐户不是当前登录到远程 PC 上的帐户时。

例子：

用户 remoteuser 登录到我们想要将证书条目安装到 HKCU 配置单元的远程 PC，但我们使用不同的用户/帐户和 psexec。我们这样做是因为我们不知道要为其更新 HKCU 配置单元的所有远程用户的 AD 密码。那将是一个严重的安全问题。

在此示例中，我们使用 psexecuser 帐户在 AD 用户 remoteuser 登录的远程 PC 上启动 psexec 服务。

C:\psexec @C:\remoteUserPCList.txt -u ourdomain\psexecuser -p psececuserpassword -d -c -f C:\InstallSSLCertinHKCU.bat

不会为远程 PC 上的 remoteuser 帐户添加 HKCU 注册表项。

任何适用于 psexec 的修复程序都会有很大帮助。我怀疑我们可以使用 AD GPO，但我希望有一些技巧可以与 PsExec 一起使用。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:51:13.173

`psexec`无法模拟登录用户。但是您不需要将自签名证书推送到远程计算机上的用户配置文件中，您可以将其推送到计算机帐户，甚至可以使用[组策略](http://technet.microsoft.com/en-us/library/cc770315.aspx)来做到这一点。

# matlab - 退出\返回主函数 - Matlab

> ID：10807924
> 
> 赞同：2
> 
> 时间：2012-05-29T23:01:45.693
> 
> 标签：matlab

我正在 matlab 中编写代码，在这段代码中，我有一个函数`f()`调用调用函数`g()`的函数`h()`。

函数在循环中`f()`调用101 次，然后调用. 每次迭代，显示一个图像，用户对图像进行一些更改，直到他按下或键：`g()``for``g()``h()`
`h()``Enter``O`

*   如果他按下`Enter` `h()`返回他所做更改的文件，并继续下一个图像。

*   如果他按下`O`然后`h()`返回更改的文件。但不会继续到下一个图像，而是返回到`Main`.

就像`exit(1)`在 C 中一样。

有什么想法我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T23:08:26.593

我想你正在寻找[`return`](http://www.mathworks.nl/help/techdoc/ref/return.html). 尽管它不会立即将您返回到 h，但您也必须`return`在某个地方输入 g。

只要在[函数声明](http://www.mathworks.nl/help/techdoc/ref/function.html)中至少命名一个输出变量，不管你是否使用，都会返回输出`return`。

例如：

```
function out = f()
    % do stuff
    x = g();
    % do stuff with x
end

function out = g()
    % do other stuff
    out = h();
    if strcmp(out, 'O') % check whether user entered 'O' in h()
        return;
    else
        % do different stuff
    end
end

function out = h()
    out = input();
end 
```

# javascript - 无需点击的自动链接

> ID：10807930
> 
> 赞同：0
> 
> 时间：2012-05-29T23:02:36.083
> 
> 标签：javascript, hyperlink, href, innerhtml

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:09:43.710

事件中的任何内容都已`onclick`被解释为 javascript，无需指定。

```
document.getElementById('printableArea').innerHTML = "<a href='javascript:void(0);' onClick='changePage(\"" + catagor + "\")'> CLICK HERE</a>"; 
```

`void(0)`在属性中使用`href`以防止浏览器尝试打开链接。
该`onclick`事件将被触发。

我将`catagor`var 括在双引号中，它位于`onclick`事件的单引号内。
只需确保您的 var 在此范围内可访问。

另外，我不知道“自动”是什么意思，您显然可以设置一个以毫秒为单位的计时器，`setTimeout()`或者放入`body`'s `onload`：

```
window.location=catagor; //the "window" reference is usually unnecessary 
```

**编辑：**

将此添加到您的函数中：

```
changePage(catagor); 
```

这将`changePage`按照您在评论中的要求调用传递参数的函数。

这是修改后的链接示例：[JSFiddle](http://jsfiddle.net/ult_combo/zscpC/1/)

# xml - XSL：向坐标数据添加一个额外的数字

> ID：10807931
> 
> 赞同：1
> 
> 时间：2012-05-29T23:02:36.583
> 
> 标签：xml, xslt

我在 XML 文件中接收坐标数据，格式为 Latitude: 3876570 Longitude:-9013376

我正在使用 XSL 将 Lon/lat 转换为 8 位而不是 7 位（如上所述），因此我需要在上述坐标的末尾附加一个零。即我需要纬度：38765700 经度：-90133760

我正在尝试使用 format-number() 函数，但不确定我是否正确使用它。我试过

```
<xsl:value-of select='format-number(longitude, "########")'/> 
```

和

```
 <xsl:value-of select='format-number(longitude, "#######0")'/> 
```

我最终得到了 7 位数字本身。请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:41:45.560

你的调用`format-number`不能给你你想要的结果，因为它不能改变它所代表的数字的值。

您可以将该值乘以十（`format-number`只要您使用 XSLT 1.0，就不需要调用）

```
<xsl:value-of select="longitude * 10" /> 
```

或附加一个零

```
<xsl:value-of select="concat(longitude, '0')" /> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-30T02:47:32.847

显而易见的答案——乘以 10 或与 a 连接`'0'`已经提出。

**这是一个更通用的解决方案**：

此转换在末尾添加了必要零的确切数量，`latitude`并且`longitude`对于`string-length()`小于 8 的任何值：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="
 *[self::latitude or self::longitude
 and
   not(string-length() >= 8)
 or
  (starts-with(., '-') and not(string-length() >= 9))
  ]">

  <xsl:copy>
   <xsl:value-of select=
    "concat(.,
            substring('00000000',
                      1,
                      8 + starts-with(., '-') - string-length())
           )
    "/>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时**：

```
<coordinates>
 <latitude>3876570</latitude>
 <longitude>-9013376</longitude>
</coordinates> 
```

**产生了想要的正确结果：**

```
<coordinates>
   <latitude>38765700</latitude>
   <longitude>-90133760</longitude>
</coordinates> 
```

**应用于此 XML 文档时**：

```
<coordinates>
 <latitude>123</latitude>
 <longitude>-99</longitude>
</coordinates> 
```

**再次产生所需的正确结果：**

```
<coordinates>
   <latitude>12300000</latitude>
   <longitude>-99000000</longitude>
</coordinates> 
```

**请注意**：

在表达式中：

```
substring('00000000',
          1,
          8 + starts-with(., '-') - string-length()) 
```

我们使用的事实是，只要布尔值是算术运算符的参数，它就会使用以下规则转换为数字：

```
 number(true()) = 1 
```

和

```
 number(false()) = 0 
```

因此，如果当前节点的值为负数，则上面的表达式再提取一个零 - 以考虑减号并获得我们必须附加到数字的确切数量的零。

# php - 正则表达式匹配一个 'word' 1 个字符长

> ID：10807932
> 
> 赞同：4
> 
> 时间：2012-05-29T23:02:36.940
> 
> 标签：php, regex

我正在尝试解析具有多个尺寸缩写的产品名称。例如，介质可以是

```
m, medium, med 
```

我尝试了一个简单的

```
preg_match('/m|medium|med/i',$prod_name,$matches); 
```

这适用于“产品 m xyz”。但是，当我尝试“product s/m abc”时，我得到了一个误报匹配。我也试过

```
preg_match('/\bm\b|\bmedium\b|\bmed\b/i',$prod_name,$matches); 
```

强制在一个单词中找到它，但 s/m 中的 m 仍在匹配中。我假设这是由于引擎将名称中的“/”视为单词分隔符？

总而言之，我需要匹配字符串中的“m”，而不是匹配“s/m”或“small”等。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T23:11:12.307

```
%\b(?<![/-])(m|med|medium)(?![/-])\b% 
```

您可以使用否定的lookbehind 或lookahead 来排除有问题的分隔符。这意味着`"m"/"med"/"medium"`which 是它自己的单词，但不能在斜线或破折号之前或之后。它也适用于字符串的开头和结尾，因为负前瞻/后瞻不会强制匹配字符出现。

如果您只想分隔空格，则可以使用正版：

```
%\b(?<=\s|^)(m|med|medium)(?=\s|$)\b% 
```

（`"m"/"med"/"medium"`前面是空格或字符串的开头，后面是空格或字符串的结尾）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T01:40:39.633

我总是首先想到 ERE 中的这些东西。并根据[re_format(7)](http://www.FreeBSD.org/cgi/man.cgi?query=re_format) ERE的词边界，分别匹配词首`[[:<:]]`和词尾`[[:>:]]`的空字符串。所以......因为 preg 应该理解 ERE 表示法，我可能会选择：

```
/[[:<:]](m(ed(ium)?)?)[[:>:]]/ 
```

或者为了更容易阅读，也许：

```
/[[:<:]](m|med|medium)[[:>:]]/ 
```

但是在 PHP 中，您可以使用 PREG 代替 ERE。在 PREG 中，`\b`表示一个字边界，因此：

```
preg_match('/\b(m(ed(ium)?)?)\b/', $prod_name, $matches); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T23:09:03.190

试试这个，它应该匹配`medium`,`med`和`m`.

```
medium|med|^m$ 
```

# entity-framework - 如何在 oracle 11g 中将表名和列设置为区分大小写？

> ID：10807935
> 
> 赞同：0
> 
> 时间：2012-05-29T23:03:03.573
> 
> 标签：entity-framework, oracle11g, case-sensitive, database-migration

我有一个 .NET 4.0 应用程序，它使用连接到 MS SQL 2008 数据库的 Entity Framework 4。使用的命名约定例如表“Clients”、字段：“Id”、“Id_Order”。现在我需要从SQL Server切换到Oracle Server，所以我将MS SQL数据库迁移到oracle数据库，但是问题是所有的表名和列名都是大写的，所以通过为oracle生成edmx（使用ODAC），我将不得不将代码从“Clients”更改为“CLIENTS”，将“Id”更改为“ID”，将“Id_Client”更改为“ID_CLIENT”，而且要更改的地方很多。迁移是使用 Oracle SQL Developer 3.1.07 中的内置迁移工具完成的。

生成脚本的片段：CREATE TABLE Clients (

我已经读过，为了创建区分大小写的标识符，您必须使用双引号。所以我认为脚本应该是这样的： CREATE TABLE "Clients" (

有谁知道可以保留名称大小写的迁移工具，或者至少是我可以在脚本中打开的一般选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:13:33.533

为什么需要更改代码？Oracle 不区分大小写的全部意义在于您可以将表称为`clients`、`Clients`、`CLIENTS`或什`clIeNtS`至 ，它会起作用。

如果出于某种原因需要区分大小写，则仅使用双引号，但除非您的表名与大小写 ( *shudder* ) 相同，否则您不需要它。

# search - 如何搜索 Google 电子表格？

> ID：10807936
> 
> 赞同：7
> 
> 时间：2012-05-29T23:03:04.820
> 
> 标签：search, spreadsheet, google-apps-script

我正在做一些详尽的搜索，需要确定新域 (URL) 是否已经在电子表格中。但是，没有一个 Spreadsheet 对象具有搜索功能，即在大多数 Document 对象中都可以找到 findText()。我觉得我错过了一些重要的东西。我错过了什么？

findText 函数：[https ://developers.google.com/apps-script/class_table#findText](https://developers.google.com/apps-script/class_table#findText)

SearchResult 对象：[https ://developers.google.com/apps-script/class_searchresult](https://developers.google.com/apps-script/class_searchresult)

电子表格对象：[https ://developers.google.com/apps-script/class_sheet](https://developers.google.com/apps-script/class_sheet)

我最好的猜测是尝试转换文档表中的特定电子表格范围，然后执行搜索。面德斋

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T20:11:10.793

不幸的是，电子表格服务中没有搜索功能。您可以获取您正在搜索的范围的数据，然后对其进行迭代以寻找匹配项。这是一个简单的函数：

```
/**
 * Finds a value within a given range. 
 * @param value The value to find.
 * @param range The range to search in.
 * @return A range pointing to the first cell containing the value, 
 *     or null if not found.
 */
function find(value, range) {
  var data = range.getValues();
  for (var i = 0; i < data.length; i++) {
    for (var j = 0; j < data[i].length; j++) {
      if (data[i][j] == value) {
        return range.getCell(i + 1, j + 1);
      }
    }
  }
  return null;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T05:49:09.103

我编写了一个带有图形用户界面的搜索工具，它在单张纸的 3 列中执行全局搜索。它可以很容易地修改以满足您的需要。我想在 UI 中添加一个锚点以让您打开刚刚找到的 url 是个好主意。这是代码，希望它可以帮助您设计自己的版本。

编辑：我在下面的代码中添加了锚小部件（在 E 列中获取它的引用）

```
// G. Variables
var sh = SpreadsheetApp.getActiveSheet();
var ss = SpreadsheetApp.getActiveSpreadsheet();
var lastrow = ss.getLastRow();
//
function onOpen() {
  var menuEntries = [ {name: "Search GUI", functionName: "searchUI"},
                     ];
  ss.addMenu("Search Utilities",menuEntries);// custom menu
}
// Build a simple UI to enter search item and show results + activate result's row
function searchUI() {
  var app = UiApp.createApplication().setHeight(130).setWidth(400);
  app.setTitle("Search by name / lastname / adress");
  var panel = app.createVerticalPanel();
  var txtBox = app.createTextBox().setFocus(true);
  var label=app.createLabel(" Item to search for :")
  panel.add(label);
  txtBox.setId("item").setName("item");
  var label0=app.createLabel("Row").setWidth("40");
  var label1=app.createLabel("Name").setWidth("120");
  var label2=app.createLabel("Lastname").setWidth("120");
  var label3=app.createLabel("Street").setWidth("120");
  var hpanel = app.createHorizontalPanel();
  hpanel.add(label0).add(label1).add(label2).add(label3)
//
  var txt0=app.createTextBox().setId("lab0").setName("0").setWidth("40");
  var txt1=app.createTextBox().setId("lab1").setName("txt1").setWidth("120");
  var txt2=app.createTextBox().setId("lab2").setName("txt2").setWidth("120");
  var txt3=app.createTextBox().setId("lab3").setName("txt3").setWidth("120");
  var hpanel2 = app.createHorizontalPanel();
  hpanel2.add(txt0).add(txt1).add(txt2).add(txt3)
  var hidden = app.createHidden().setName("hidden").setId("hidden");
  var subbtn = app.createButton("next ?").setId("next").setWidth("250");
  var link = app.createAnchor('', '').setId('link');
  panel.add(txtBox);
  panel.add(subbtn);
  panel.add(hidden);
  panel.add(hpanel);
  panel.add(hpanel2);
  panel.add(link);
  var keyHandler = app.createServerHandler("click");
  txtBox.addKeyUpHandler(keyHandler)
  keyHandler.addCallbackElement(panel);
//
  var submitHandler = app.createServerHandler("next");
  subbtn.addClickHandler(submitHandler);
  submitHandler.addCallbackElement(panel);
//
  app.add(panel);  
  ss.show(app);
  }
//
function click(e){
   var row=ss.getActiveRange().getRowIndex();              
   var app = UiApp.getActiveApplication();
   var txtBox = app.getElementById("item");
   var subbtn = app.getElementById("next").setText("next ?")      
   var txt0=app.getElementById("lab0").setText('--');
   var txt1=app.getElementById("lab1").setText('no match').setStyleAttribute("background", "white");// default value to start with
   var txt2=app.getElementById("lab2").setText('');
   var txt3=app.getElementById("lab3").setText('');
   var link=app.getElementById('link').setText('').setHref('')
   var item=e.parameter.item.toLowerCase(); // item to search for
   var hidden=app.getElementById("hidden")                  
   var data = sh.getRange(2,2,lastrow,4).getValues();// get the 4 columns of data
       for(nn=0;nn<data.length;++nn){ ;// iterate trough
         if(data[nn].toString().toLowerCase().match(item.toString())==item.toString()&&item!=''){;// if a match is found in one of the 4 fields, break the loop and show results
          txt0.setText(nn+2);
          txt1.setText(data[nn][0]).setStyleAttribute("background", "cyan");
          txt2.setText(data[nn][1]);
          txt3.setText(data[nn][2]);
          link.setText(data[nn][3]).setHref(data[nn][3]);
          sh.getRange(nn+2,2).activate();
          subbtn.setText("found '"+item+"' in row "+Number(nn+2)+", next ?");
          hidden.setValue(nn.toString())                                                                                  
          break
          }
      }
return app    ;// update UI
}
function next(e){
   var row=ss.getActiveRange().getRowIndex();              
   var app = UiApp.getActiveApplication();
   var txtBox = app.getElementById("item");
   var subbtn = app.getElementById("next").setText("no other match")      
   var hidden=app.getElementById("hidden");                  
   var start=Number(e.parameter.hidden)+1;//returns the last search index stored in the UI
   var item=e.parameter.item.toLowerCase(); // item to search for
   var txt0=app.getElementById("lab0");
   var txt1=app.getElementById("lab1").setStyleAttribute("background", "yellow");
   var txt2=app.getElementById("lab2");
   var txt3=app.getElementById("lab3");
   var link=app.getElementById('link').setText('').setHref('')
   var data = sh.getRange(2,2,lastrow,4).getValues();// get the 4 columns of data
       for(nn=start;nn<data.length;++nn){ ;// iterate trough
         if(data[nn].toString().toLowerCase().match(item.toString())==item.toString()&&item!=''){;// if a match is found in one of the 4 fields, break the loop and show results
          txt0.setText(nn+2);
          txt1.setText(data[nn][0]).setStyleAttribute("background", "cyan");
          txt2.setText(data[nn][1]);
          txt3.setText(data[nn][2]);
          link.setText(data[nn][3]).setHref(data[nn][3])
          sh.getRange(nn+2,2).activate();
          subbtn.setText("found '"+item+"' in row "+Number(nn+2)+", next ?");                                                                                               
          hidden.setValue(nn.toString())                                                                                  
          break
          }
      }
return app    ;// update UI
}// eof 05-12 Serge insas 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-15T21:24:19.637

我最终改用电子表格公式来解决我的问题。具体来说，我使用了[**MATCH** ()](https://support.google.com/drive/table/25273?hl=en)函数，它可以在数组中查找字符串（在本例中为同一文档中另一张表中的列）。

这比遍历数组要简单得多，尽管效率较低并且不允许完全自动化。事实上，当该列达到 2,000 个条目时，Google Drive 经常冻结，我不得​​不开始使用 Excel。尽管如此， Match() 解决方案更适合我正在寻找的东西。

不过，感谢所有其他回应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T12:47:23.093

您可以使用 SpreadsheetAPI List Feed 查询参数“搜索”。这将返回使用全字匹配匹配的任何行。在参数周围加上一些星号（当然是 URL 编码的），它就变成了通配符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-04T01:56:39.717

I have not tried it, but it appears that the [Google Visualization API Query Language](https://developers.google.com/chart/interactive/docs/querylanguage) will allow you to execute SQL queries against Google sheets.

# orchardcms - 错误 - 没有找到带有“Orchard.Environment.AutofacUtil.DynamicProxy2.ConstructorFinderWrapper”的构造函数

> ID：10807938
> 
> 赞同：8
> 
> 时间：2012-05-29T23:03:31.320
> 
> 标签：orchardcms

我有一个自定义模块 Module1。在这个模块中，我引用了另一个自定义模块 Module2。上周一切正常。

今天早上我重新安装了 Orchard。从那时起，我一直收到此错误。

无法使用可用的服务和参数调用类型为“Module1”的“Orchard.Environment.AutofacUtil.DynamicProxy2.ConstructorFinderWrapper”的构造函数：无法解析构造函数“Void .ctor(...)”的参数“Module2” .

知道如何解决此错误吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T23:51:45.313

这意味着找不到某个接口的实现。可能发生了几件事：模块可能无法编译，或者您忘记了从 IDependency 派生接口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-11T21:54:20.247

如果您手动启用了模块，您可能会收到此错误。

如果是这样，请通过删除 App_Data\cache.dat 来修复它，然后回收应用程序池。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-29T11:47:25.840

我知道这篇文章现在已经很老了，但只是为了链接可能导致所描述问题的任何可能的错误......这是我的错误。

我只是忘记从仪表板启用引用的模块。当然，这并没有阻止我添加项目引用和模块依赖项，让代码完美编译。

关键是，我引用的模块不包含任何内容类型定义。它只是一个旨在收集一些功能和常用实用程序的模块。这就是为什么我忘了启用它。

干杯。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-16T13:34:35.727

我遇到过同样的问题。似乎我在构造函数中引用了具体类而不是接口。

```
 public OrderService(
            IRepository<Order> orderRepository,
            ProductService productService,
            ProductCategoryService productCategoryService
        ) 
```

代替

```
 public OrderService(
            IRepository<Order> orderRepository,
            IProductService productService,
            IProductCategoryService productCategoryService
        ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-02T13:00:16.097

清单是：

1.  接口派生自 IDependency
2.  实现派生自接口
3.  构造函数引用接口
4.  Build All 并检查所有引用的模块是否编译
5.  在管理面板中启用模块

例子：

```
 public class myController : Controller{
        private readonly IMyService _myService;

        public myController(
            IMyService myService
        ) {
        _myService = myService;
        }
    } 
```

```
 public interface IMyService : IDependency
    {
        int GetOne();
    } 
```

```
 public class MyService: IMyService 
    {
        public MyService()
        { // init code }

        public int GetOne()
        { return 1; }
    } 
```

# java - 沿路径为 SVG 元素设置动画时出现蜡染错误

> ID：10807939
> 
> 赞同：1
> 
> 时间：2012-05-29T23:03:52.930
> 
> 标签：java, animation, svg, batik

我得到一个 NullPointerException （被 Batik 捕获并吐出为“错误：n 尝试沿路径为元素设置动画。我已将其追踪到未创建的 Point2D，因为它位于 -0.3 * 路径长度。那是由于负时间步长而发生。

我想知道这是否在我的控制范围内？有人可以看看 XML 看看我是否搞砸了？

我简化了一些路径，但我试图沿路径动画到一定百分比，然后让它冻结：

```
<path fill="#ffffff" d="M14.25,-2.5 A2.5,2.5 0 1,1 14.25,2.5 L5.75,2.5 z" stroke-width="1.0" opacity="0.0" transform="translate(0.0,0.0) rotate(0.0,0,0) scale(1.0)" stroke="#000000">

<animateMotion dur="1.0" rotate="auto-reverse" fill="freeze" repeatCount="indefinite" begin="0.0" path="M1212.3,273.5 C1001.2,509.3 452.1,480.7 266.7,224.3 " min="0.0" calcMode="paced" max="0.47916282407407407"/>
</path>

<text x="14.0" y="20.0" style="font-family:Droid Sans Mono; font-size:12.0; color:#000000; font-weight:bold; " opacity="0.0" transform="rotate(0.0,14.0,20.0) ">
A6EMF
<animateMotion dur="1.0" rotate="0" fill="freeze" repeatCount="indefinite" begin="0.0" path="M1212.3,273.5 C1001.2,509.3 452.1,480.7 266.7,224.3 " min="0.0" calcMode="paced" max="0.47"/>
</text> 
```

# ssl - vsftpd：确保数据传输是加密的？

> ID：10807945
> 
> 赞同：5
> 
> 时间：2012-05-29T23:04:55.237
> 
> 标签：ssl, ftp, wireshark, filezilla, vsftpd

所以这是我的“问题”，感谢**vsftpd** ，我设置了一个 FTP 服务器，以便对登录和数据传输都进行加密。

这是我的*vsftpd.conf*文件中有趣的部分。

```
ssl_enable=YES
allow_anon_ssl=NO
require_ssl_reuse=NO
force_local_data_ssl=YES
force_local_logins_ssl=YES

ssl_tlsv1=YES
ssl_sslv2=YES
ssl_sslv3=YES

rsa_cert_file=/etc/vsftpd/vsftpd.pem
rsa_private_key_file=/etc/vsftpd/vsftpd.pem
ssl_ciphers=HIGH 
```

我使用**Filezilla**作为 FTP 客户端，连接配置如下：

```
Protocol : FTP - File Transfer Protocol
Encryption : Require explicit FTP over TLS
Logon type: Normal 
```

需要注意的一些事项：

*   *加密：普通 FTP*：不起作用，我对此很满意。（响应：530 非匿名会话必须使用加密。）

*   *加密：需要基于 TLS 的隐式 FTP*：也不起作用，服务器拒绝连接。我想这是因为我强制 SSL 连接。

现在，一旦建立（显式）连接，Filezilla 会在窗口底部显示一个小锁图标，表示***连接已加密。点击图标了解详情***。

我想确保数据传输确实是加密的而不是明文的，所以我在我的 eth 上捕获了所有内容。将文件从我的服务器下载到我的计算机时使用**Wireshark**卡。

除了我找不到 SSL 协议的单个数据包外，一切都是 TCP。

我不知道如何确保传输的数据是加密的，即使 filezilla 这么说，每次我用谷歌搜索“vsftpd 如何确保数据传输是加密的”时，我得到的唯一答案是“ssl_enable=YES”或“勾选使用 SSL”...

预先感谢您帮助我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T19:34:41.787

经过更多的研究，尤其是在[http://wiki.wireshark.org/SSL上的](http://wiki.wireshark.org/SSL)**完整演练**之后，我对整个事情有了更好的理解。

我正在回答我自己的问题，希望有一天这会对某人有所帮助，只要以下内容是正确的......

我认为，写下来对我来说也是一个好方法，看看是否清楚地理解了我的问题。写这个答案的任何困难都将证明我错了。

第一的 ：

> 通常，SSL 使用 TCP 作为其传输协议。

SSL 封装在 TCP 中，这就是为什么我在捕获数据包时无法明确观察 SSL 协议的原因。

在分析 TCP 数据包时，我只能“*跟随 TCP 流*”而不能“*跟随 SSL 流*”，这误导我认为数据包没有包含加密数据。这很有趣，因为可观察的数据不是人类可读的……如此加密。

为了能够解密它，我必须提供wireshark加密密钥：

> **RSA 密钥列表**
> 
> 此选项指定 IP 地址、端口、协议和解密密钥之间的绑定。

然后，我可以观察到加密/未加密的数据。

此外，在[http://wiki.filezilla-project.org/](http://wiki.filezilla-project.org/)上阅读此内容后：

> 当您对 FTP 服务器应用加密时，CPU 将不得不进行许多计算来加密发送的数据并解密接收的数据。

I simply decided to run the UNIX **top** command while downloading a file. I was able to observe a high CPU usage of the filezilla client process, contrary to a unencrypted data transfer. This was a second argument that confirmed the data transfered were indeed encrypted, and thus needed to be decrypted.

# mysql - MySQL查询，处理活动和非活动产品

> ID：10807946
> 
> 赞同：0
> 
> 时间：2012-05-29T23:05:02.853
> 
> 标签：mysql

面对一个问题，几个小时都没有得到提示。也许有人可以帮助我。

有以下显示畅销商品的查询。因此产品的状态（活跃与否）保存在 b.Article_Status 中（0=不活跃，1=活跃）。

我如何获取结果列表中目前在 productfamily 中没有活动产品的产品。但是，如果订购的旧产品（表 order_items 中也是如此）现在处于非活动状态且尚未订购活动的产品，则仍应显示该产品。

实际查询如下所示。已经资助了一个解决方案，该解决方案在订购了一次实际有效产品时有效，但上述案例仍然存在问题。

```
SELECT count( a.order_itemid ) AS numOrders, c.Product_ID, c.Product_Name, d.producer_name
FROM order_items a
LEFT OUTER JOIN product_article b ON b.Article_ID = a.order_itemid
LEFT OUTER JOIN product c ON b.Article_Productid = c.Product_ID
LEFT OUTER JOIN producer d ON c.Product_Producer = d.producer_id
GROUP BY c.Product_ID
ORDER BY `numOrders` DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T13:05:29.867

解决方案是 WHERE EXISTS 子查询

```
SELECT count( a.order_itemid ) AS numOrders, c.Product_ID, c.Product_Name, d.producer_name
FROM order_items a
LEFT OUTER JOIN product_article b ON b.Article_ID = a.order_itemid
LEFT OUTER JOIN product c ON b.Article_Productid = c.Product_ID
LEFT OUTER JOIN producer d ON c.Product_Producer = d.producer_id
WHERE EXISTS (SELECT * FROM product_article x WHERE c.Product_ID = x.Article_Productid AND x.Article_Status = 1)
GROUP BY c.Product_ID
ORDER BY `numOrders` DESC
LIMIT 5 
```

# php - 使用 PHP 回显值时，vcalendar 文件中没有换行符

> ID：10807952
> 
> 赞同：0
> 
> 时间：2012-05-29T23:06:00.920
> 
> 标签：php, icalendar, vcalendar, vcal

我有一个 vcalendar 文件。如果我在这样的 php 标签之间键入它，它就完美了

```
?>

BEGIN:VEVENT
DTSTART;VALUE=DATE:20110422
DTEND;VALUE=DATE:20120529
DTSTAMP:20120529T124028Z
UID:7a6db67f3edff4729956c47ec@calendarlabs.com
CREATED:20111213T123901Z
DESCRIPTION:Visit http://www.calendarlabs.com/holidays/ to know more about New Year's Day and for any other calendar needs.
LAST-MODIFIED:20111213T123901Z
LOCATION:
SEQUENCE:0
STATUS:CONFIRMED
SUMMARY:New Year's Day
TRANSP:TRANSPARENT
END:VEVENT

 <?php

 echo : 
```

但是，一旦我把它放在 echo 语句中，就像这样：

```
 echo "BEGIN:VEVENT"; 
```

然后它不起作用。我试过添加\n，
一切。

如果我做类似的事情也不起作用：

```
 DTSTART;VALUE=DATE:<?php echo $date; ?> 
```

其他人可以在这里看到解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:36:02.717

[PHP 的结束标签会吃掉它后面的空格。](http://brian.moonspot.net/php-history-newline-closing-tag) 如果您想在使用 PHP 输出时保留换行符，您需要执行以下操作之一：

*   显式输出换行符：

    ```
    DTSTART;VALUE=DATE:<?php echo $date, PHP_EOL; ?> 
    ```

*   使用[heredoc 语法](http://php.net/heredoc)：

    ```
    echo <<<END
    BEGIN:VEVENT
    ...
    DTSTART;VALUE=DATE:$date
    END; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:29:55.057

您的 Web 服务器可能无法将 .ics 文件识别为脚本，因此它不会将文件发送到超文本处理器 (php) 以处理 php 标记内的指令。您需要告诉您的 Web 服务器将其视为 php 文件。添加自定义扩展的教程可以在这里找到：[http](http://creativebriefing.com/custom-file-extensions/) ://creativebriefing.com/custom-file-extensions/ 。

# javascript - 获取选择框值以用作变量

> ID：10807957
> 
> 赞同：0
> 
> 时间：2012-05-29T23:06:39.860
> 
> 标签：javascript, jquery, xml, drop-down-menu

我希望有人可以提供帮助，我是 javascript 的相对新手并且有以下问题。我有一个 ID 为“mySelect”的选择框

填充有以下代码 -

```
$(document).ready(function(artists){
        $.ajax({
            type: "GET",
            url: "bookinglist.xml",
            dataType: "xml",
            success: function(artists_list) {
                var select = $('#mySelect');
                var artistsArr = [];
                $(artists_list).find('vw_ADM_BookingListNull[strArtistName]').each(function(){
                    var artists = $(this).attr('strArtistName');
                    if ($.inArray(artists, artistsArr) == -1) {
                        select.append('<option value="'+artists+'">'+artists+'</option>');
                        artistsArr.push(artists);
                        }
                    });
                select.children(":first").text("please make a selection").attr("selected",true);
            }
        });
    }); 
```

我需要使用选定的值作为变量插入另一段代码。如何从中创建变量？

该变量将用于代替

```
'vw_ADM_BookingListNull[strArtistName="James Zabiela"]' 
```

在以下代码中，它从 xml 列表中填充表。

```
$(document).ready(function(unavailable){
        $.ajax({
            type: "GET",
            url: "bookinglist.xml",
            dataType: "xml",
            success:(function(unavail){
                    $(unavail).find('vw_ADM_BookingListNull[strArtistName="James Zabiela"]').each(function() {
                    var venue = $(this).attr('strVenueName');
                    var artist = $(this).attr('strArtistName');
                    var booking_date = $(this).attr('dteEventDate').substr(0,10); //subtr strips date down              
                    if(!(booking_date >= $nowformat && booking_date <= $advformat)){
                        $('<tr style="display:none;"></tr>')
                        }
                    else {
                        $('<tr></tr>').html('<th>'+booking_date+'</th><td>'+artist+'</td>').appendTo('#unavail');
                    }
                    });
                })
            });
        }); 
```

我需要处理一个值未被选中的可能事件，因此选择框的值将是“请进行选择”，它被设置为默认值。

所以我想我需要在创建表的代码周围包装某种 if 语句，以便在尚未选择任何内容时不显示任何内容。

由于截止日期迫在眉睫，任何帮助将不胜感激。

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T23:15:11.860

您似乎正在使用 jQuery，所以来自[jQuery 文档](http://api.jquery.com/val/)

`var dropdownValue = $('#mySelect').val();`

# c# - GetHashCode 使用哪个哈希函数？

> ID：10807964
> 
> 赞同：1
> 
> 时间：2012-05-29T23:07:24.657
> 
> 标签：c#, hashtable, hash

我假设 .NET 中的（通用）Dictionary 类在其键上使用 GetHashCode() 方法来生成哈希。我有两个问题由此引出：

1.  Object 有一个可覆盖的 GetHashCode() 方法。对于用户定义的引用类型对象，此方法是否会根据引用的数据生成哈希？例如，如果我有一个仅包含一个 String 实例变量的类 OneString - 具有匹配字符串的此类的两个单独实例是否总是产生相同的哈希码？或者是否需要重写 OneString 的 GetHashCode() 方法才能实现此功能？

2.  推测在 String 类中实现的散列函数与在不同的引用类型（例如 BitmapImage）中实现的散列函数不同。在最常见的类中实现的哈希函数是否公开可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:10:04.783

不。

`object.GetHashCode()`仅基于该对象的标识返回一个值。
它不会为两个等效对象返回相同的值；它完全不知道对象的类型或含义。

表示值的类（例如`String`）会覆盖`GetHashCode()`以根据表示的值返回散列。
使用的算法取决于类设计者；`GetHashCode()`像任何其他方法一样编写。
但是，只要返回 true ，`GetHashCode()`就应该返回相等的值；`Equals()`如果你的班级不这样做，那就错了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-29T23:18:27.840

> Object 有一个可覆盖的 GetHashCode() 方法。对于用户定义的引用类型对象，此方法是否会根据引用的数据生成哈希？

不，默认`GetHashCode`方法不会尝试使用类中的数据，它仅基于引用。具有相同内容的两个独立实例将具有不同的哈希码。

> 如果我有一个仅包含一个 String 实例变量的类 OneString - 具有匹配字符串的此类的两个单独实例是否总是产生相同的哈希码？或者是否需要重写 OneString 的 GetHashCode() 方法才能实现此功能？

你必须覆盖它。

> 推测在String类中实现的散列函数与在不同的引用类型（例如SqlCommand）中实现的散列函数是不同的。在最常见的类中实现的哈希函数是否公开可用？

是的，实现了`GetHashCode`for 字符串和通用值类型以从值中生成有效的哈希码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T23:11:22.600

1）具有相同内容的不同字符串实例总是会产生相同的哈希码。（见：http: [//msdn.microsoft.com/en-us/library/system.string.gethashcode.aspx](http://msdn.microsoft.com/en-us/library/system.string.gethashcode.aspx)）

2) GetHashCode() 是 Object 基类的一个方法，所有类型都从该方法派生。因此，对于任何类型，总是有此方法的实现。

# c# - C# 为什么 SelectedNode.Tag 为空？

> ID：10807966
> 
> 赞同：0
> 
> 时间：2012-05-29T23:08:17.343
> 
> 标签：c#, null, treeview, selecteditem

我在我的 C# 项目（Windows 窗体）中使用 TreeView，但我遇到了问题（显然：P）。我像这样填充我的 TreeView：

```
void RefreshTreeView()
{
    treeView1.Nodes.Clear();
    for (int i = 0 ; i < categories.Count ; ++i)
    {
        treeView1.Nodes.Add(categories[i].name);
        for (int j = 0 ; j < categories[i].questions.Count ; ++j)
        {
            treeView1.Nodes[i].Nodes.Add("Pytanie nr " + categories[i].questions[j].number.ToString()
                + " za " + categories[i].questions[j].points.ToString() + " pkt. ["
                + (categories[i].questions[j].used ? "Przeczytane" : "Nieprzeczytane") + "]");
            treeView1.Nodes[i].Tag = categories[i].questions[j];   // A
        }
    }
} 
```

在上面标记为“A”的行中，我将一个 Question 对象附加到 Node 的标签上。它似乎在程序中稍后起作用，我可以像这样检索我的 Question 对象：

```
((Question)treeView1.Nodes[0].Tag).number 
```

但我想获取当前选择的节点标签。我尝试这样做： `((Question)treeView1.SelectedNode.Tag).number` 但它不起作用（标签为空）。我究竟做错了什么？以及如何获取当前选中的Node的Tag？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:12:22.223

`treeView1.Nodes[i].Tag`是父节点的标签。

您可能想要设置子节点的标签，即`treeView1.Nodes[i].Node[j].Tag`

# php - Mysql为每个用户选择最旧的记录

> ID：10807967
> 
> 赞同：0
> 
> 时间：2012-05-29T23:08:19.540
> 
> 标签：php, mysql

我正在尝试在 PHP 中为数据库中的每个用户创建一个最旧条目的列表。

```
SELECT *, 
MIN(`entries`.`entry_date`) 
AS entry_date 
FROM (`entries`) 
JOIN `user_profiles` 
ON `user_profiles`.`user_id` = `entries`.`user_id` 
WHERE `status` = 1 
GROUP BY `entries`.`user_id` 
```

我正在使用查询从`entries`表中检索最旧的日期条目，该条目使用`MIN()`并与表连接以`user_profiles`获取其他数据。查询应该为每个用户选择最旧的条目。它似乎有效，但是`entry_date`当我回显某些条目时，它会在某些条目上检索错误的字段。请帮忙，我无法发现我做错了什么..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:09:43.190

您需要使用子查询来获取`(user_id, entry_date)`每个用户的配对，然后将其与选择感兴趣记录的查询连接：

```
SELECT *
FROM   entries
  NATURAL JOIN (
    SELECT   user_id, MIN(entry_date) AS entry_date
    FROM     entries
    GROUP BY user_id
  ) AS tmin
  JOIN user_profiles USING (user_id)
WHERE  status = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:40:26.060

您是否尝试过从 user_profiles 表而不是 entries 表来解决问题？如果用户没有条目，他们将不会出现在上述查询中。

这可能会有所帮助，但我不确定这是否是完整的解决方案：

```
SELECT *, MIN(entries.entry_date) as entry_date
FROM user_profiles LEFT JOIN entries USING (user_id)
WHERE status = 1
GROUP BY user_profiles.user_id 
```

此外，您将 MIN(entires.entry_date) 重命名为 entry_date...但您已经有一个名为 entry_date 的列。尝试将派生列重命名为“min_entry_date”之类的独特名称？

# node.js - 嵌套模型猫鼬与 nodejs 生成重复

> ID：10807968
> 
> 赞同：0
> 
> 时间：2012-05-29T23:08:20.233
> 
> 标签：node.js, mongoose

这是我保存模型的 models.js 的代码

```
var mongoose = require('mongoose')
, Schema = mongoose.Schema;
var GroupSchema = new Schema({
    title      : String
    , elements   : [ElementSchema]
    , author     : String 
});
var ElementSchema = new Schema({
    date_added : Date
    , text       : String
    , author     : String 
});
mongoose.model('Group', GroupSchema);
exports.Group = function(db) {return db.model('Group');};

mongoose.model('Element', ElementSchema);
exports.Element = function(db) { return db.model('Element');
}; 
```

对我来说它看起来很清楚，但是当我这样做时

```
function post_element(req, res, next) {
Group.findOne({_id: req.body.group}, function(err, group) {
    new_element = new Element({author: req.body.author,
        date_added: new Date()});
        new_element.save();
        group.elements.push(new_element);
        group.save();
    res.send(new_element);
    return next();
})
} 
```

我不明白为什么当我进入 Mongo 时，我有两个集合，一个称为带有嵌套组的 Groups（所以看起来不错），另一个集合称为 E​​lements。

为什么？它不应该被称为 Group 吗？没看懂，哪位大侠给我解释一下？

谢谢，克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:18:26.990

当您执行此行时：

```
new_element.save(); 
```

您正在将新创建的元素保存到 Elements 集合中。不要在元素上调用 save ，我认为你会得到你正在寻找的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T13:58:17.713

这是因为以下行：

```
mongoose.model('Element', ElementSchema); 
```

这会在 mongoose 中注册一个模型，当您注册一个模型时，它将在 mongo 中创建自己的集合。你所要做的就是摆脱这条线，你会看到它消失了。

另一方面，使用以下方法导出模型，将文件设置为每个文件仅导出一个模型更加简洁和容易：

```
module.exports = mongoose.model('Group', GroupSchema); 
```

希望这可以帮助！

# entity-framework - 实体框架和子对象的存储库模式

> ID：10807970
> 
> 赞同：3
> 
> 时间：2012-05-29T23:08:26.020
> 
> 标签：entity-framework, asp.net-mvc-4

我有一个包含以下层的应用程序：

特定 WebAPI 控制器 -> 通用 WebAPI 控制器父类 -> 通用存储库类 -> 实体框架 -> 数据库

我遇到的问题是，当我尝试检索具有相关对象的对象时，例如，BlogPost，具有 Category 和 User，后两者返回 null。我在模型中定义了正确的关系（EF 可以从中推断）以及数据库中的外键关系。

我认为这是因为我的通用存储库只为主类执行 Get，而不包括其他类。

我知道如果我输入“包含”我可以得到其他人，但我怎样才能用通用图层做到这一点？如果我重写我的方法，那可能意味着我不会在我的大部分实现中使用泛型方法。

是否有另一种方法可以告诉 EF 检索子对象而不必诉诸 Get 覆盖？

# python - 多线程时队列冲突？

> ID：10807972
> 
> 赞同：1
> 
> 时间：2012-05-29T23:08:30.120
> 
> 标签：python, python-2.7

我试图组合一个非常简单的多线程模型，到目前为止它似乎工作。我的问题是我如何确定两个线程不会同时从队列中获取相同的值并给我重复？是否有一些内置方法可以防止这种情况？我添加了一个延迟来尝试在每个线程从队列中获取值之间放置时间，这是必要的吗？

```
from Queue import Queue
from threading import Thread
import time

class myThread(Thread):
    def __init__(self,queue):
        Thread.__init__(self)
        self.queue = queue
    def run(self):       
        while True:                      
            time.sleep(0.0001)   #not sure if this is good enough to compensate for overlap in pulling the same value out of a queue         
            task = self.queue.get() #pull a number from the queue,
            if task != None:          
                out.append(task) #This will be where you        
            else:               
                break

queue = Queue()
out = []

for i in range(10):
    t = myThread(queue)
    t.start()
for i in range(100):
    queue.put(i)
print out 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T23:12:39.353

Queue 类实现了锁定以防止这种情况发生，请参阅[http://docs.python.org/library/queue.html](http://docs.python.org/library/queue.html)，特别是：

> 当必须在多个线程之间安全地交换信息时，它在线程编程中特别有用。该模块中的 Queue 类实现了所有必需的锁定语义。

所以你不需要任何延迟，队列应该完全按照你的意愿工作。这就是它的目的（基本上）:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T23:37:00.643

你的代码是正确的。睡眠没有必要。队列是[同步](http://en.wikipedia.org/wiki/Synchronization_%28computer_science%29)的。存在避免线程拉同一任务的锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T23:14:08.103

queue.Queue 的全部意义在于它为您保证了此属性。不需要睡眠（睡眠从来都不是解决并发故障的好方法）。

# asp.net - 如何从类库设置对 SQL Server 成员资格和角色提供程序的访问？

> ID：10807986
> 
> 赞同：0
> 
> 时间：2012-05-29T23:09:58.000
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-membership, membership-provider, roleprovider

我有一个客户端想要使用中间件库包装提供程序模型，从而将所有 Security.Web 命名空间和 API 调用完全排除在前端之外。

设置对 API 的调用很容易。但是配置 app.config 文件并不那么直观。我一直无法找到一个很好的例子。

从 Web 项目外部为 ASP.NET 提供程序模型使用设置 app.config 文件的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T00:07:03.320

我错过了`<system.web>`要包裹在提供者信息周围的标签。哦！

现在一切都像魅力一样。对不起，狙击狩猎。;)

# c++ - 从容器类调用正确的重载函数

> ID：10807988
> 
> 赞同：0
> 
> 时间：2012-05-29T23:10:24.163
> 
> 标签：c++, vector, templating, derived-class

这是困扰我一段时间的事情。

所以假设你有你的基类和派生类。您还有一个 baseClass 指针的容器对象，其中包含指向您正在管理的所有对象的指针。

当有一个带有派生类参数的重载函数时，问题就来了。

例子：

```
function foo(baseClass, baseClass);
function foo(baseClass, derivedClass);
function foo(derivedClass, derivedClass);

vector<baseClass*> objectList;

objectList.push_back(new derivedClass());
objectList.push_back(new derivedClass());

foo(objectList[0], objectList[1]); // <-- Here's the problem. 
```

到目前为止，我一直在做一些骇人听闻的事情，那就是基于我定义的“getType()”枚举成员变量的“正确”类型的静态转换。这真的很难看，我想知道将这些参数作为派生类传递的正确方法。

或者这只是一个糟糕的整体设计？

不，容器类不能是derivedClass 类型... baseClass 是几个不同类的基础。虽然它在向量中，但我不在乎它是什么对象类型。当我将它传递给一个参数时，我想让编译器知道它是什么类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:25:25.603

您正在尝试进行[多次调度](http://en.wikipedia.org/wiki/Multiple_dispatch)。

# c++ - 如何创建需要上下文的对象的全局实例？

> ID：10807989
> 
> 赞同：1
> 
> 时间：2012-05-29T23:10:32.120
> 
> 标签：c++, opengl, openvg

我正在尝试编写 OpenVG 的 C++ 包装器，它的设计非常类似于 Open-GL。这是一个简单的路径句柄包装器：

```
class Path {
        VGPath handle;

    public:
        Path() :
        handle(vgCreatePath(VG_PATH_FORMAT_STANDARD, VG_PATH_DATATYPE_F,
            1,0,0,0, VG_PATH_CAPABILITY_ALL)) 
        { 
        std::cout << "Path Handle created : " << (void*)handle << '\n';
        }

        ~Path() {
            std::cout << "Path destroyed  : " << (void*)handle << '\n';
            vgDestroyPath(handle);
        }

    }; 
```

不幸的是，openVG 需要一个上下文才能运行，如果`vgCreatePath`在没有 openVG 上下文的情况下调用它，它将中止。这使我无法在我的代码中创建（出于测试目的）全局 Path 对象对象，因为它是在我创建 openVG 上下文之前构建的（我主要这样做）。有什么办法可以防止这种情况发生吗？

我认为在对象构造时将句柄统一化是一个非常糟糕的主意......如果没有上下文，我应该在创建 Path 对象时强制创建全局上下文吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T23:53:50.800

> 有什么办法可以防止这种情况发生吗？

是的，使用智能指针，使用某种“工厂”函数按需创建它，只要需要它就将其存储在任何变量中。

在 C++03 中：

```
typedef boost::weak_ptr<Path> PathWeakPtr;
typedef boost::shared_ptr<Path> PathPtr;

PathPtr createPath(){
    static PathWeakPtr lastPath;
    PathPtr result = lastPath.lock();
    if (!result){
        result.reset(new Path());
        lastPath = result;
    }
    return result;
} 
```

...

```
void doSomething(){
    PathPtr path = createPath();//points to same path as in main*()
    ...
}

int main(int argc, char** argv){
    PathPtr path = createPath();//initialization
    doSomething();
    return 0;
} 
```

在 C++11 中使用：

```
typedef std::weak_ptr<Path> PathWeakPtr;
typedef std::shared_ptr<Path> PathPtr; 
```

代替

```
typedef boost::weak_ptr<Path> PathWeakPtr;
typedef boost::shared_ptr<Path> PathPtr; 
```

# google-chrome - 如何让谷歌浏览器将此扩展识别为新扩展

> ID：10807994
> 
> 赞同：0
> 
> 时间：2012-05-29T23:11:20.420
> 
> 标签：google-chrome, google-chrome-extension

我为我构建了一个 chrome 扩展，它可以帮助我轻松地发布到我的 wordpress。问题是我有几个网站我想使用相同的扩展程序，这些网站只涉及更改扩展程序设置中的 URL。

**真正的问题**

假设我制作了同一个扩展的 3 个副本，必须在每个副本中实施哪些更改才能使 Google Chrome 将其识别为不同的扩展？现在，如果我更改清单中的某些属性，Chrome 仍会将其识别为原始扩展，并希望替换我已经安装的扩展。

我希望这是有道理的。显然*有人*不明白我在说什么，所以我打破了它。希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T04:38:14.127

我只是猜测，但我认为这将是`name`在文件中找到的字段`manifest.json`。理论上，如果您正在管理自己的`.crx`文件（用于打包扩展），我猜 Chrome 也可以使用该文件的名称。最后，如果您正在签署您的扩展并使其通过市场可用，则也可以使用加密签名（`.pem`在您打包扩展时创建）。

所以没有真正的答案，但我相信它一定是这三个之一（清单中的名称、crx 文件的名称或加密签名）。如果您测试并弄清楚，请务必分享！