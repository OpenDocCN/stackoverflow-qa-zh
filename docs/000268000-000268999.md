# StackOverflow 问答 000268000-000268999

# java - 2D overlap line chart

> ID：268002
> 
> 赞同：0
> 
> 时间：2008-11-06T09:03:00.780
> 
> 标签：java, drawing, charts

Does any one know of an API that would allow me to draw something like this. It would need some interactivity to it

*   zooming
*   change second dimension axis angle

I was looking at [JFreeChart](http://www.jfree.org/jfreechart/) but I don't see any example of doing 2D overlap chart.

Thanks

[![alt text](https://i.stack.imgur.com/Jb0V3.png)](https://i.stack.imgur.com/Jb0V3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-06T00:28:31.083

我最近这样做了。很简单，真的。我可以将绘制基础网格的代码发送给您，其余的只是一系列直方图（多边形），每层之间都有偏移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T09:22:42.770

可能是[Chart3D](http://www.tan.co.jp/JClass/Chart3D)可能是你所追求的（虽然不是免费的）

![http://www.tan.co.jp/images/jclass/chart3d/3d_4e.gif?width=260&height=173&quality=95&sharpen=0.15&format=jpeg](https://i.stack.imgur.com/429al.jpg)

一个更简单和免费的解决方案可能是[SpiceChart 3D 线](http://www.reconn.us/content/view/19/38/)。

# java - java webstart 反编译器

> ID：268010
> 
> 赞同：0
> 
> 时间：2008-11-06T09:08:45.513
> 
> 标签：java, decompiling

反正有反编译java webstart应用程序吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T09:24:05.870

启动应用程序，然后从 webstart 缓存中获取 JAR。像使用任何其他 Java 应用程序一样进行反编译。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T09:24:58.257

就在这里。Java Webstart 应用程序只是一种部署形式。结果是一堆 jar 复制到用户主目录。这些当然可以反编译，例如使用[jad](http://www.kpdus.com/jad.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-28T21:50:05.680

只需使用 .jar 扩展名重命名文件即可：)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-30T13:38:49.537

JNLP 只是由 J2Plauncher 解释的常规文本文件。您可以在您最喜欢的文本编辑器中打开它并查找两件事：`codebase`和`resources`.

代码库是从中`resources`下载所有内容的基本 URL。同时在资源中，每个 jar 字段都有一个`href`. 您可以将其附加到基本 URL 以下载您需要的特定 jar 资源。之后，进行常规的 jar 反编译过程。

# c++ - 关于 QCoreApplication 和 QProcess

> ID：268011
> 
> 赞同：0
> 
> 时间：2008-11-06T09:09:03.093
> 
> 标签：c++, linux, qt

我正在编写应该通过 Qprocess 创建外部进程的 QCoreApplication。

我刚刚注意到，即使`waitForStarted()`调用了并且进程状态是`Running`在事件处理程序执行之前，外部进程*也不会启动*，直到`exec()`在 QCoreApplication 上调用该方法。

也就是说，是否可以将例程的执行推迟到事件处理开始（在其中实例化 QProcess），或者唯一可行的方法是创建一次性 QTimer？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T13:31:56.777

经过短暂的调查，它出现了方法**QCoreApplication::processEvents()**处理调用线程的所有未决事件。在下面的代码中

```
int main(int argc, char *argv[])
{
    QCoreApplication app(argc, argv);

    QProcess abc(....);
    abc.start(...);

    app.processEvents();

    //////////////////////////////////////////////////////
    // is the process really running ? //
    //////////////////////////////////////////////////////

    return  app.exec();
} 
```

该部分需要这种方法**`is-the-process-really-running`**才能让它找到启动并运行的*abc*进程。否则*abc*将在事件循环处理启动事件时启动。

# c# - 如何将位图转换为字节 []？

> ID：268013
> 
> 赞同：15
> 
> 时间：2008-11-06T09:09:50.283
> 
> 标签：c#, linq, asp.net-3.5, byte, image-uploading

基本上，我使用 listviews 插入事件插入图像，尝试从 fileupload 控件调整图像大小，然后使用 LINQ 将其保存在 SQL 数据库中。

我在fileupload控件中找到了一些代码来创建内容的新位图，但这是将其存储在服务器上的文件中，来自[this source](http://forums.asp.net/t/1208353.aspx)，但我需要将位图保存回SQL数据库，我认为我需要转换回 byte[] 格式。

那么如何将位图转换为 byte[] 格式呢？

如果我以错误的方式解决这个问题，我将不胜感激，您能纠正我。

这是我的代码：

```
 // Find the fileUpload control
            string filename = uplImage.FileName;

            // Create a bitmap in memory of the content of the fileUpload control
            Bitmap originalBMP = new Bitmap(uplImage.FileContent);

            // Calculate the new image dimensions
            int origWidth = originalBMP.Width;
            int origHeight = originalBMP.Height;
            int sngRatio = origWidth / origHeight;
            int newWidth = 100;
            int newHeight = sngRatio * newWidth;

            // Create a new bitmap which will hold the previous resized bitmap
            Bitmap newBMP = new Bitmap(originalBMP, newWidth, newHeight);

            // Create a graphic based on the new bitmap
            Graphics oGraphics = Graphics.FromImage(newBMP);

            // Set the properties for the new graphic file
            oGraphics.SmoothingMode = SmoothingMode.AntiAlias;
            oGraphics.InterpolationMode = InterpolationMode.HighQualityBicubic;

            // Draw the new graphic based on the resized bitmap
            oGraphics.DrawImage(originalBMP, 0, 0, newWidth, newHeight);

            PHJamesDataContext db = new PHJamesDataContext();

            System.IO.MemoryStream stream = new System.IO.MemoryStream();
            newBMP.Save(stream, System.Drawing.Imaging.ImageFormat.Bmp);
            stream.Position = 0;
            byte[] data = new byte[stream.Length];

            PHJProjectPhoto myPhoto =
                new PHJProjectPhoto
                {
                    ProjectPhoto = data,
                    OrderDate = DateTime.Now,
                    ProjectPhotoCaption = ProjectPhotoCaptionTextBox.Text,
                    ProjectId = selectedProjectId
                };

            db.PHJProjectPhotos.InsertOnSubmit(myPhoto);
            db.SubmitChanges(); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-06T09:18:03.717

您应该能够将此块更改为

```
 System.IO.MemoryStream stream = new System.IO.MemoryStream();
        newBMP.Save(stream, System.Drawing.Imaging.ImageFormat.Bmp);

        PHJProjectPhoto myPhoto =
            new PHJProjectPhoto
            {
                ProjectPhoto = stream.ToArray(), // <<--- This will convert your stream to a byte[]
                OrderDate = DateTime.Now,
                ProjectPhotoCaption = ProjectPhotoCaptionTextBox.Text,
                ProjectId = selectedProjectId
            }; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-06T09:16:02.050

如果您已经有了`MemoryStream`，只需调用[`MemoryStream.ToArray`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx)即可获取数据。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T09:15:27.387

假设您的位图是 bmp

```
byte[] data;
using(System.IO.MemoryStream stream = new System.IO.MemoryStream()) {
   bmp.Save(stream, System.Drawing.Imaging.ImageFormat.Bmp);
   stream.Position = 0;
   data = new byte[stream.Length];
   stream.Read(data, 0, stream.Length);
   stream.Close();
} 
```

# python - apache user can not write to .python-eggs

> ID：268015
> 
> 赞同：3
> 
> 时间：2008-11-06T09:11:07.677
> 
> 标签：python, apache, egg, python-egg-cache

I have read that I need to set the `PYTHON_EGG_CACHE` environment variable, or install the python library as an uncompressed .egg

Which do you suggest?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T09:38:47.307

这完全取决于您是想让鸡蛋作为一个普遍可用的库还是仅用于单个（或少数几个应用程序）。您是在谈论 Trac 安装吗？如果是这样，还有一些替代方案可以使鸡蛋在每个实例中可用：

[http://trac.edgewall.org/wiki/TracPlugins](http://trac.edgewall.org/wiki/TracPlugins)

# version-control - Is there anything like a small version of TFS?

> ID：268018
> 
> 赞同：4
> 
> 时间：2008-11-06T09:12:40.747
> 
> 标签：version-control, testing, tfs, debugging

Is there anything that has features of TFS(Like Source Control, Debug, Testing,...) that we can use in a workgroup with a small team(say 1-6 persons)?

BTW: we are using VS 2008 Team Suit

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T09:15:00.740

Do you particularly need it all in one package? Various open source projects only do one thing, but integrate nicely with others. For instance:

*   [Subversion](http://subversion.tigris.org) for source control
*   [Trac](http://trac.edgewall.org/) for bug tracking
*   [Cruise Control .NET](http://confluence.public.thoughtworks.org/display/CCNET) for continuous builds
*   [NAnt](http://nant.sourceforge.net/) for build management

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T09:17:52.013

Use the Team foundation **workgroup** edition but be [warned](http://notgartner.wordpress.com/2006/03/28/dont-install-team-foundation-server-workgroup-edition/). Under no circumstances think of source safe.

There are many other very good alternatives for all you seek. To many to mention, so will leave particular recommendations to others.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T09:21:11.073

SourceGear 堡垒？包含 SourceGear Vault、工作项/错误跟踪以及与 CruiseControl 的集成以进行构建。

你有什么特别不喜欢 TFS 的地方吗？是否有您认为缺少的特定功能？如果您使用的是 Team Suite，为什么不使用 TFS（甚至是工作组版）？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T09:22:32.940

如果您想使用 OpenSource，请使用[CodePlex](http://codeplex.com)。因此，您将免费获得具有所有功能的 TFS :) 如果没有，请查看[TFS Wiki 页面](http://en.wikipedia.org/wiki/Team_Foundation_Server)以获取替代方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-20T20:08:48.963

如果您拥有 MSDN 许可证，Team Foundation Server 是免费的。即使您不这样做，允许 5 个用户的零售许可证也只需 500 美元。

如果您已经为 Team Suit（现在的 Visual Studio Ultimate）付费，那么如果您不使用 TFS，您将失去很多功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T15:53:22.120

我和你在同一条船上。我什[至在 SO 上问了一个关于它](https://stackoverflow.com/questions/291145/is-the-subversion-stack-a-realistic-alternative-to-team-foundation-server)的问题。我们有 TFS 的预算，甚至是安装它的硬件，但我们的团队只有 5 人，通过工作来启动和运行 TFS 似乎并不值得。TFS 管理员还需要高昂的培训成本来处理这一切。不要误会我的意思：我**喜欢**TFS，但对于这个团队来说，这就像使用航天飞机过马路一样。

正如我的问题所说，我查看了 Subversion 堆栈。我很喜欢。但归根结底，我的客户想要的是供应商支持的东西。

我们选择了[SourceGear Fortress](http://www.sourcegear.com)。它与 SourceSafe 相似，但具有 SVN 和 TFS 中的重型 SCM 功能。它也比 TFS 便宜得多。最后，堡垒是我的团队需要的平衡。

我将 Fortress 设置为使用 CruiseControl.NET 进行集成构建，使用导入工具移动了我们的 VSS 存储库，并在大约一天内启动并运行。

我承认我想念 TFS 并希望我拥有它的一些功能，例如与 Visual Studio 的紧密集成（Fortress 具有 VSS 风格的集成；错误和问题跟踪是基于 Web 的）。

# c++ - 检查文件是否存在于 C++ 中的最佳方法是什么？（跨平台）

> ID：268023
> 
> 赞同：100
> 
> 时间：2008-11-06T09:14:51.630
> 
> 标签：c++, file, file-io

我已经阅读了[检查 C 中是否存在文件的最佳方法是什么的答案？（跨平台）](https://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c-cross-platform)，但我想知道是否有更好的方法使用标准 C++ 库来做到这一点？最好根本不尝试打开文件。

两者`stat`都`access`几乎无法搜索。我应该怎么`#include`用这些？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-11-06T09:24:21.707

使用[boost::filesystem](http://www.boost.org/doc/libs/1_37_0/libs/filesystem/doc/index.htm)：

```
#include <boost/filesystem.hpp>

if ( !boost::filesystem::exists( "myfile.txt" ) )
{
  std::cout << "Can't find my file!" << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-11-06T12:58:08.247

注意竞争条件：如果文件在“存在”检查和您打开它之间消失，您的程序将意外失败。

最好去打开文件，检查失败，如果一切都好，然后对文件做一些事情。对于安全关键代码而言，这一点更为重要。

有关安全性和竞争条件的详细信息：http: [//www.ibm.com/developerworks/library/l-sprace.html](http://www.ibm.com/developerworks/library/l-sprace.html)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-11-06T12:36:07.450

我是一个快乐的 boost 用户，肯定会使用 Andreas 的解决方案。但是，如果您无权访问 boost 库，则可以使用流库：

```
ifstream file(argv[1]);
if (!file)
{
    // Can't open file
} 
```

它不如 boost::filesystem::exists 好，因为文件实际上会被打开……但那通常是你接下来想做的事情。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-06T09:16:18.697

如果它是跨平台的，足以满足您的需求，请使用 stat()。它不是 C++ 标准，而是 POSIX。

在 MS Windows 上有 _stat、_stat64、_stati64、_wstat、_wstat64、_wstati64。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2019-03-04T23:02:58.183

如果你的编译器支持 C++17，你不需要 boost，你可以简单地使用[`std::filesystem::exists`](https://en.cppreference.com/w/cpp/filesystem/exists)

```
#include <iostream> // only for std::cout
#include <filesystem>

if (!std::filesystem::exists("myfile.txt"))
{
    std::cout << "File not found!" << std::endl;
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-11-06T09:59:48.810

怎么样`access`？

```
#include <io.h>

if (_access(filename, 0) == -1)
{
    // File does not exist
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-06-19T15:54:29.847

另一种可能性在于在`good()`流中使用该函数：

```
#include <fstream>     
bool checkExistence(const char* filename)
{
     ifstream Infield(filename);
     return Infield.good();
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-06T12:05:48.930

我会重新考虑尝试找出文件是否存在。相反，您应该尝试以您打算使用它的相同模式打开它（在标准 C 或 C++ 中）。知道文件存在有什么用，比如说，当你需要使用它时它是不可写的？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-07-28T06:41:58.753

**NO [boost](/questions/tagged/boost "显示标记为“提升”的问题") REQUIRED**，这将是一个*矫枉过正*。

* * *

使用[stat()](http://man7.org/linux/man-pages/man2/stat.2.html)（虽然如 pavon 所述，但不是跨平台），如下所示：

```
#include <sys/stat.h>
#include <iostream>

// true if file exists
bool fileExists(const std::string& file) {
    struct stat buf;
    return (stat(file.c_str(), &buf) == 0);
}

int main() {
    if(!fileExists("test.txt")) {
        std::cerr << "test.txt doesn't exist, exiting...\n";
        return -1;
    }
    return 0;
} 
```

输出：

```
C02QT2UBFVH6-lm:~ gsamaras$ ls test.txt
ls: test.txt: No such file or directory
C02QT2UBFVH6-lm:~ gsamaras$ g++ -Wall main.cpp
C02QT2UBFVH6-lm:~ gsamaras$ ./a.out
test.txt doesn't exist, exiting... 
```

另一个版本（和那个）可以在[这里](https://techoverflow.net/blog/2013/08/21/how-to-check-if-file-exists-using-stat/)找到。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-27T00:54:48.460

如果您已经在使用输入文件流类 ( `ifstream`)，则可以使用它的函数`fail()`。

**例子：**

```
ifstream myFile;

myFile.open("file.txt");

// Check for errors
if (myFile.fail()) {
    cerr << "Error: File could not be found";
    exit(1);
} 
```

# python - 将 MySQLdb (for python) 安装为非压缩的 egg

> ID：268025
> 
> 赞同：4
> 
> 时间：2008-11-06T09:15:21.177
> 
> 标签：python, installation, mysql, egg

安装说明如下：

```
$ python setup.py build
$ sudo python setup.py install # or su first 
```

这给了我一个 .egg 文件。如何告诉安装将文件转储为普通的未压缩库？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T09:44:54.817

好的，我不想回答我自己的问题，但是：

找到你的 python 站点包（我的是 /usr/local/lib/python2.5/site-packages ）

然后：

```
$ unzip MySQL_python-1.2.2-py2.5-linux-i686.egg 
```

这对我来说很好

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-22T14:57:28.920

I'm a little late to this party, but here's a way to do it that seems to work great:

```
sudo python setup.py install --single-version-externally-managed --root=/ 
```

And then you don't use a .python-egg, any *.pth files etc.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T09:26:17.537

从 [EasyInstall](http://peak.telecommunity.com/DevCenter/EasyInstall#command-line-options)文档，命令行选项：

> --总是解压缩，-Z
> 
> 不要将任何包安装为 zip 文件，即使这些包被标记为可以安全地作为 zip 文件运行。

您可以使用*easyinstall*而不是调用 setup.py 吗？

从命令提示符调用 `easy_install -Z mysql_python`，在网上找到鸡蛋并安装它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T09:47:56.587

这将告诉 setuptools 不要压缩它：

```
sudo python setup.py install --single-version-externally-managed 
```

# opengl-es - 在 OpenGL ES 1.x 中使用顶点缓冲区对象时可以使用索引图元吗？

> ID：268035
> 
> 赞同：1
> 
> 时间：2008-11-06T09:18:27.507
> 
> 标签：opengl-es, vbo

我有一个包含顶点列表的数组，我使用顶点缓冲区对象将其复制到 GPU。然而，顶点坐标本身是没有意义的，因为我还有一个整数数组，其中包含顶点数组的索引列表。

在这种情况下，可以创建另一个缓冲区对象来存储索引，然后在渲染函数中绑定顶点数组和索引数组以进行绘图：

```
//vertex coordinates
glBindBuffer(GL_ARRAY_BUFFER, bufferId1);         
//index coordinates
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, bufferId2); 

glVertexPointer(3, GL_FLOAT, 0, 0);
//Not sure if this should be Unsigned BYTE or Unsigned SHORT
glDrawElements(GL_POINTS, 6, GL_UNSIGNED_BYTE, 0); 
```

我已经阅读了 api 并且以下内容使我感到困惑：
“虽然非零缓冲区对象绑定到 GL_ELEMENT_ARRAY_BUFFER 目标，但 glDrawElements 的索引参数传统上被解释为指向客户端内存的指针，而被解释为内部的偏移量以基本机器单位测量的缓冲对象。”

我对图形编程很陌生，所以如果其中任何一个没有意义，我深表歉意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T09:26:05.650

是的，这是可能的。[官方教程](http://www.opengl.org/wiki/GL_ARB_vertex_buffer_object)应该可以帮助你。他们建议不要使用无符号字节，坚持使用 16 或 32 位索引以提高速度。

# visual-studio-2008 - Exported Project Template from VS2008 but it is corrupted?

> ID：268037
> 
> 赞同：3
> 
> 时间：2008-11-06T09:19:51.963
> 
> 标签：visual-studio-2008

I am working on creating a custom project template with Visual Studio 2008 Team System edition. I have also created a custom wizard for the custom template.

So I have to update the vstemplate file to tell the template to use my custom wizard. But the archive is corrupted!

7zip thinks folders within the archive are using non-standard zip compression. The latest winzip thinks the CRC header on the folders doesn't match the main CRC header.

What am I doing wrong?

If I don't change the template zip file created by VS2008, it works just fine. But I need to be able to update the zip file. If I do, 7zip/winzip fixes the zip file structure and then VS2008 doesn't like the template anymore. Files that are in folders within the zip file are inaccessible.

I do notice that the standard templates seem to keep a flat file structure. That is no nested folders or anything. But the vstemplate file has targetfilename attributes that recreate the original folder structure.

For example instead of...

```
<Folder Name="My Project" TargetFolderName="My Project">
    <ProjectItem ReplaceParameters="true" TargetFileName="AssemblyInfo.vb">AssemblyInfo.vb</ProjectItem>
</Folder> 
```

the standard vstemplate defines the following...

```
<ProjectItem ReplaceParameters="true" TargetFileName="My Project\AssemblyInfo.vb">AssemblyInfo.vb</ProjectItem> 
```

I've just had a little think about the above. Are they actually the same thing?

Is the problem with the creation of the original zip file?

Is the folder structure within the zip file tripping everything up?

Should it have added all the files to the zip archive in as flat folder structure? If so is there a fix for VS2008 so that I do not have to manually fix the template archives?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-26T17:56:13.127

您无需将存档的内容修改为平面。

诀窍是在编辑存档的解压缩内容之后，而不是选择文件夹并压缩它，打开文件夹并选择所有文件（和文件夹，如果存在），然后压缩它们。

这就是阻止 Visual Studio 将存档识别为模板的原因。这应该适用于 7-Zip、WinRAR 或任何您碰巧喜欢 WinZip 的英国媒体报道软件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T15:03:58.980

看起来 Visual Studio 创建了非标准的 ZIP 文件。我的解决方案是解压VS生成的模板zip文件，然后用WinZip重新压缩文件。

您说 VS2008 在执行此操作时无法访问模板中的所有文件，但这里至少生成的 zip 文件不会对 VS2008 造成任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:32:28.353

这里同样的问题。我通过使用`<ProjectItem>MyFolder\MyFile.cs</ProjectItem>`而不是解决了它`<Folder>...<Folder>`。

PS：TargetFileName 在 VS2008 + Windows7 中对我不起作用。

# ruby-on-rails - ActionController::InvalidAuthenticityToken: verified with authentication token on the form

> ID：268038
> 
> 赞同：0
> 
> 时间：2008-11-06T09:20:02.213
> 
> 标签：ruby-on-rails, authenticity-token

I don't know why it happens but my form for some reason does not post properly. I am very sure the form contains the required authentication token:

```
<form action="/account/complete_verify_email/4df78710-e27b-4527-bd2d-71cd2e9a1271" method="post"
    <div style="margin:0;padding:0">
        <input name="authenticity_token" type="hidden" value="341b07dfa682ed11a045e19956e2e3f5f499e8cb">
    </div>
    <input id="password" name="password" type="password">
    <input name="commit" type="submit" value="Continue">
</form> 
```

Note the authenticity_token is there. What happened?

**Update:** And YOU KNOW WHAT? Quitting Safari and restart again solved the issue... but I can't think of what kind of intermittent behaviour could cause such problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T12:05:01.373

这是你的红宝石代码的输出，是吗？如果您添加了生成此表单的代码，则可能更容易找出问题所在。

InvalidAuthenticityToken 可能（或应该？）意味着令牌存在但不正确，如果重新启动 Safari 有帮助，则可能是一些超时问题。也许会话 cookie 过期太快了？

# trac - 您如何处理 trac 中的多个（重叠）项目？

> ID：268039
> 
> 赞同：11
> 
> 时间：2008-11-06T09:20:44.957
> 
> 标签：trac, multi-project

我们正在使用 trac 并且对它非常满意。但是，开箱即用的 trac 仅适用于单项目环境。我很想听听人们为使其与多个项目一起工作而采取的各种方法以及他们在这些项目中的经验。有什么插件可以推荐吗？有任何补丁、调整或诸如此类的东西吗？您是否甚至可能使用完全不同的错误跟踪系统，该系统提供了 trac 的所有功能以及多项目支持？

我们最近开始自己管理第二个项目，它通常可以正常工作，但也有一些缺点，特别是在两个项目重叠的情况下，因为我们编写的通用库代码在两个项目中都使用。你怎么处理这个？

（我将附上我们自己当前的方法作为对这篇文章的回答。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T09:33:57.240

我们采取的方法是为每个新项目创建另一个 trac 环境，并设置[InterTrac](http://trac.edgewall.org/wiki/InterTrac)链接，以便在两者之间进行更简单的交叉引用。我们还通过 [inherit] 指令使用公共基础[Trac.ini文件。](http://trac.edgewall.org/wiki/TracIni)

除了问题中提到的共享代码的歧义问题之外，这还有一些可能会或可能不会影响您的缺点，具体取决于您的项目和工作流程的性质：

*   创建新项目并非易事；无法通过浏览器界面完成
*   票号不统一：每个新项目环境都从 #1 重新开始 - 至少使用 InterTrac 别名，您可以轻松消除它们的歧义
*   安装和配置插件时必须格外小心，以便为所有环境安装和配置它们

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T12:48:24.553

我们遵循的另一种方法是将不同的项目配置为组件。

我们共享 SVN 存储库和主页 wiki 页面，但我们没有使用里程碑功能。如果项目足够大，可以有不同的模块（在我们的例子中只是其中一个），我们将每个模块配置为一个组件而不是项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-28T20:52:15.620

大约一年前[SimpleMultiProjectPlugin](http://trac-hacks.org/wiki/SimpleMultiProjectPlugin)（在一个 Trac 实例中支持多个项目）被实施。它以 >= Trac 0.12 运行。它添加了一个新的工单字段“项目”，使用多个项目的过滤器扩展时间线和路线图页面，并将其映射到项目的版本、组件和里程碑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-24T19:52:02.980

同样的感觉，一旦正确配置，Trac 真的很棒。而且无需接触任何代码即可轻松破解。我只希望 wiki 语法更常见，比如 markdown。

我们采用了使用一个 Trac 实例的方法。我们不需要/不想使用严格的 ACL，它的好处是可以将开发人员的所有活动集中在一个地方。

对于分离项目，我们本质上是将错误分配给各种里程碑。每个项目都有一个短期和长期的里程碑。短期用于修复实际错误，长期用于主要版本。

大多数其他“新票证”字段已被修剪，保留“类型”和“严重性”字段，这在每个项目上都是相同的。

报告基本上仅限于“我的票”，并且“显示报告”按钮已经过调整以直接访问您的票。

工作流程也经过调整以添加中间“测试”状态，以便 QA 可以保证修复。

电子邮件配置已调整为不会淹没邮箱，以便开发人员实际阅读他们的作业。

有了这些，我们就有了一个非常有效的工具。花了一些时间才把它弄好，但如果你知道如何破解并在谷歌上查找东西，就很容易改变。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-30T16:53:48.783

[Apache Bloodhound 项目](http://bloodhound.apache.org/)是专门启动的，目的是为 Trac 提供对多个项目的支持（除其他外）。它本质上是 Trac 之上的插件集合。

Bloodhound remains compatible with most popular [Trac-Hacks](http://trac-hacks.org/) and follows any changes to Trac itself. You can try [the demo instance](https://bh-demo2.apache.org/) too.

# search - 多行搜索和替换工具

> ID：268045
> 
> 赞同：22
> 
> 时间：2008-11-06T09:23:50.863
> 
> 标签：search

我正在寻找一种在整个项目中替换多行的工具。例如：

```
#include "../DiscreteIO/Discrete.h"
#include "../PCI/pci.h"
#include "../Arinc429/ARINC429.h" 
```

和

```
#include "../PCI/pci.h"
#include "../DiscreteIO/DiscreteHW.h"
#include "../DiscreteIO/Discrete.h" 
```

我尝试了两种适用于此类搜索和替换的工具。[Wildedit](http://www.textpad.com/products/wildedit/index.html)和[Actual search and replace](http://www.divlocsoft.com/)两者似乎都是出色的工具，但都是共享软件。有人知道类似的工具吗？有什么免费的，还是该花点钱了？

**澄清：**

**在这种情况下，通过一个项目**意味着一千多个 c 文件。文本编辑器一次只能执行一个文件（Textpad、Programmers notepad）或所有打开的文件（nodepad++）。我没有尝试过任何其他编辑器，但我认为他们会遇到类似的问题。如果我错了，请纠正我。

sed 和 awk 之类的工具是一种解决方案，但会出现问题，因为我不经常使用它们，并且由于我不是这些工具方面的专家，因此需要花一些时间才能开始工作。

**答案是：**全部...

Ultra 编辑可以工作，但我已经有一个编辑器，如果我只是将它用作搜索和替换工具，价格会很高。

基于 Sed、AWK 和正则表达式的工具可以工作，但在某些情况下可能会很痛苦。

Wild Edit 可以工作，而且价格也不贵。

我最终的决定是运用我的正则表达式技能。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T18:22:53.800

JetBrains 系列 IDE：[IntelliJ](http://www.jetbrains.com/idea/)、[RubyMine](http://www.jetbrains.com/ruby/)、[PHPStorm](http://www.jetbrains.com/phpstorm/)等将进行多行搜索和替换。

选择有问题的文本并按`ctrl-shift-F`- 这将打开替换对话框，其中所选文本作为查找表达式（使用正则表达式，换行符转义为`\n`）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T09:39:42.907

sed 会做你想做的事。

请参阅此处的常见问题解答条目[http://sed.sourceforge.net/sedfaq4.html#s4.23.3](http://sed.sourceforge.net/sedfaq4.html#s4.23.3)

> 如果您需要匹配一个静态文本块（可能在整个文件中出现任意多次），其中块的内容是预先知道的，那么这个脚本很容易使用

Sed 可用于 Windows。见[http://gnuwin32.sourceforge.net/packages/sed.htm](http://gnuwin32.sourceforge.net/packages/sed.htm)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T21:40:41.823

```
cd $PROJECTDIR && find . -iname '*.*' -exec vim -c 's:^first line of text\nsecond line of text\n3rd line of text:new 1st line\rnew 2nd\rnew 3rd:' -c 'w!' -c 'q' {} \; 
```

高温高压

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-06-11T01:41:24.610

[Visual Studio Code](https://code.visualstudio.com/)具有非常出色的“全局”搜索和替换功能。我只是将它用于许多文件的多个多行更改，包括一些带有捕获和替换的正则表达式搜索。

*   打开 VS 代码
*   文件→打开文件夹，打开文件所在的文件夹
*   打开文件并选择要替换的文本
*   CTRL + SHIFT + H 打开搜索和替换
*   如果您选择了一个文本，它将自动填充，甚至是多行。否则输入文本，使用 SHIFT + Enter 插入换行符，并可选择启用 Regexp。
*   输入替换文本
*   按 Enter 开始搜索
*   单击更改项以并排预览更改
*   使用全部替换按钮 (CTRL + ALT + Enter) 应用并保存更改

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-17T10:02:26.257

唯一可以一次性完成交钥匙的东西是dreamweaver....[![在此处输入图像描述](https://i.stack.imgur.com/wxLca.png)](https://i.stack.imgur.com/wxLca.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-26T07:46:05.393

我成功使用了 Multiple Find And Replace 1.10，这是一个免费软件程序，它可以做到这一点：在 TXT 或 TXT 列表中搜索多行，并根据需要将它们替换为其他文本或删除它们。我在这里找到它供下载： http: [//www.softpedia.com/get/System/File-Management/Multiple-Find-And-Replace.shtml](http://www.softpedia.com/get/System/File-Management/Multiple-Find-And-Replace.shtml)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-09-01T20:11:58.433

我不允许发表评论，但接受的解决方案引用了一个似乎被打破的例子。第 18 行应该是：

```
s,[/\.*[],\\&,g 
```

不是

```
s,[/\[.*],\\&,g 
```

后者将在第 18 行向现代 sed（如果您在 *BSD 中，则为“gsed”）抱怨未终止的表达式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T12:22:16.853

[RegexSearch](http://regexsearch.sourceforge.net/)有点难看，但对于这类事情来说是一个非常有用的工具。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T10:39:25.150

我发现的最好的工具是一款名为[BK ReplaceEm](http://www.snapfiles.com/get/bkreplace.html)的免费软件。该界面需要一些时间来适应，但值得学习如何使用它。该工具非常强大，允许您使用或不使用正则表达式进行多行替换。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T09:33:34.900

[Ultraedit](http://www.ultraedit.com/)可以做到这一点。我为此付出了金钱。

有[一个关于多行查找和替换的教程](http://www.ultraedit.com/support/tutorials_power_tips/ultraedit/multiline_find_replace.html)，您可以将其与“[替换文件](http://www.ultraedit.com/support/tutorials_power_tips/ultraedit/find_replace.html)”一起使用以应用于多个文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T09:35:40.310

我很确定 sed、awk 和/或 grep 的组合可以完成这项工作。它们是免费的，并且随任何 Linux 发行版一起提供，但也存在 Windows 版本。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T11:57:10.710

当人们要求工具而不告诉他们需要哪些平台时，我总是感到困惑......在这些情况下，我想默认情况下它适用于 Windows......

有许多可用于 Windows 的搜索/替换工具，或多或少功能强大，其中很多是免费的。
目前，我使用[FileMenu Tools](http://www.lopesoft.com/en/fmtools/info.html "文件菜单工具 5.4.1")的 Search/Replace 模块，功能非常强大（您可以使用正则表达式），并附带许多其他好东西。
我还有 RJL Soft 的[Simple Search-Replace](http://www.rjlsoftware.com/software/utility/search/ "简单的搜索替换")（无 RE），TortoiseSVN 作者的[grepWin](http://tools.tortoisesvn.net/ "grepWin")，支持正则表达式和大量选项，还有一些我过去使用过的选项。

PS.：我忘记了。Simple Search-Replace 不会进行多行替换。显然，两者都不是 FileMenu 工具。grepWin 可以（例如使用 \r\n ）。我确实记得这些带有多行搜索/替换字段的免费工具，但我手头没有它们的名字。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-27T21:29:11.617

```
#see docs at the bottom 
use strict;
use warnings;
use Cwd;

use File::Find;

my $search_patternFilePath=$ARGV[0] ;
my $replace_patternFilePath =$ARGV[1];
my $file_pattern = $ARGV[2];

# Usage

(@ARGV == 3 ) || die ("Usage: FindAndReplace.pl pathToFileContaingTheMultiLineSearchText FullPathToFileContainingMultiLineReplaceText FilePattern . Example: perl MultiLineFindAndReplace.pl \"D:\Opera\New Folder\search.txt\" \"D:\Opera\replace.txt\" bak");

find(\&d, cwd);

sub d {
my $file = $File::Find::name;
$file =~ s,/,\\,g;

return unless -f $file;
return unless $file =~ /$file_pattern/;

my $searchPatternString = &slurpFile ( $search_patternFilePath ) ; 
my $replacePatternString = &slurpFile ( $replace_patternFilePath ) ; 
my $fileStr = &slurpFile ( $file ) ; 

$fileStr =~ s/$searchPatternString/$replacePatternString/igo ; 
open(FILEHANDLE,">$file") || die "cannot open output file";
print (FILEHANDLE "$fileStr");
close FILEHANDLE ;

}

sub slurpFile 
{
my $file = shift ;
print "\$file is $file" ;
local( $/, *FILE ) ; 
open (FILE , $file) or 
die "Cannot find $file !!! " ; 
my $fileString = <FILE>; #slurp the whole file into one string !!! 
close FILE ;
return $fileString ;
}
#Purpose : performs recursive find and replace based on pеrl regexes from the current directory
#the search and replace is case insensitive
#Usage
#perl MultiLineFindAndReplace.pl "D:\Opera\New Folder\search.txt" "D:\Opera\replace.txt" bak 
```

# c# - 在 Visual Studio 中调试时，我可以在返回之前找出返回值吗？

> ID：268048
> 
> 赞同：426
> 
> 时间：2008-11-06T09:24:43.360
> 
> 标签：c#, visual-studio, visual-studio-debugging

采取以下功能：

```
DataTable go() {
    return someTableAdapter.getSomeData();
} 
```

当我在这个函数中设置断点时，是否有可能检查返回值？`go()`直接耦合到`.aspx`页面中的数据网格。

检查返回的数据表的唯一方法是使用临时变量。但是，这有点不方便。难道没有别的办法了吗？

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2008-11-06T09:26:00.050

从来没听说过。请注意，如果您*确实*添加了一个变量，无论如何它都会在发布版本中被编译器删除......

**更新：** [此功能已添加到 VS2013](https://devblogs.microsoft.com/devops/seeing-function-return-values-in-the-visual-studio-2013-debugger/)中。您可以在自动窗口中查看返回值或`$ReturnValue`在监视/立即窗口中使用。

该值只能在从函数返回后直接看到，因此访问它的最简单方法是在函数调用上放置一个断点并跳过 (F10) 调用。

* * *

VS2015 更新：嘘！不幸的是，它似乎不在 VS2015 (devenv v14)
VS2017 更新中：它回来了。(devenv v15)

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2010-09-15T05:25:26.390

这可以[根据客户反馈站点在](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2206747-function-return-value-in-debugger)带有 CLR 4.5.1 的 Visual Studio 2013 中完成。它在 C# 的早期版本中不可用。

（Visual Studio 2008 和更早的版本支持 VB.NET。它一直可供 C/C++ 开发人员使用。）

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2011-11-18T09:49:26.257

我同意这是一件非常有用的事情：不仅可以在退出之前查看方法的返回值，还可以查看我刚刚跨过的方法的返回值。我将它作为 Visual Studio 商业扩展的一部分实现，称为“ [OzCode](http://www.oz-code.com) ”。

有了它，您可以直接在代码编辑器上查看方法返回值，就像 HUD 显示一样：

![报表可视化](https://i.stack.imgur.com/Kw7mp.gif)

欲了解更多信息，请观看[此视频](http://www.youtube.com/embed/u_1Lgzf3Y00?autoplay=1&rel=0)。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-06-17T14:33:15.523

根据微软的说法，没有办法通过托管代码可靠地实现这一点。这是他们意识到并正在解决的问题：

> 对于那些有调试本机 C++ 或 VB6 代码经验的人，您可能已经使用了在“自动”窗口中为您提供函数返回值的功能。不幸的是，托管代码不存在此功能。虽然您可以通过将返回值分配给局部变量来解决此问题，但这并不方便，因为它需要修改您的代码。在托管代码中，确定您已跨过的函数的返回值要复杂得多。我们意识到我们无法在这里始终如一地做正确的事情，因此我们删除了该功能，而不是在调试器中为您提供不正确的结果。但是，我们希望为您带来这一点，我们的 CLR 和调试器团队正在寻找一些潜在的解决方案来解决这个问题。不幸的是，这不是 Visual Studio 11 的一部分。

[https://connect.microsoft.com/VisualStudio/feedback/details/597933/add-a-return-pseudo-variable-to-the-visual-studio-debugger-for-net-code](https://connect.microsoft.com/VisualStudio/feedback/details/597933/add-a-return-pseudo-variable-to-the-visual-studio-debugger-for-net-code)

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2016-03-18T10:01:58.750

*关于 Visual Studio 2015：*

根据 Marc Gravell 目前接受的答案：

> 此[功能已添加到 Visual Studio 2013](http://blogs.msdn.com/b/visualstudioalm/archive/2013/06/27/seeing-function-return-values-in-the-debugger-in-visual-studio-2013.aspx)中。您可以在自动窗口中查看返回值或在监视/立即窗口中使用 $ReturnValue

该答案还表明此功能在 Visual Studio 2015 中不起作用。这不是（完全）正确的。在*[检查方法调用的返回值时，](https://msdn.microsoft.com/en-us/library/dn323257.aspx)*有以下注释：

> 您必须打开旧版表达式求值器才能识别**$ReturnValue** **（工具/选项/调试/使用旧版 C# 和 VB 表达式求值器**）。否则，您可以使用**$ReturnValue1**。

我在 Visual Studio 2015 Enterprise 中对此进行了测试：

*   关闭旧式表达式评估器：*只有* **$ReturnValue1**有效
*   打开旧式表达式求值器：**$ReturnValue***和***$ReturnValue1***都* 有效

 ****** * *

## 回答 #6

> 赞同：13
> 
> 时间：2011-03-29T13:18:58.680

如果您转到菜单*工具*→*选项*，IntelliTrace，并更改设置以收集事件和呼叫信息。

您可以返回到上一个调用事件 ( `Ctrl`++ `Shift`) `F11`，并在 autos 窗口中查看从方法调用返回的临时值作为方法名称的子项。

这不会向您显示您所在方法的返回值。它只是向您显示当前方法中调用的最后一个方法的返回值。

所以，这很好

```
DataTable go(){return someTableAdapter.getSomeData();} 
```

因为它向您显示了`someTableAdapter.getSomeData()`.

但不适用于：

```
int go(){return 100 * 99;} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-10-30T04:06:04.877

.NET 之前的老技巧：打开 Registers 窗口并查看 EAX 寄存器的值。这包含最后调用的函数的返回值。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-11-06T09:53:04.457

使用 Shift-F11 退出 go() 方法，然后在“Autos”调试窗口中，它将显示刚刚从堆栈中弹出的方法调用的返回值（在这种情况下，go() 方法是你想要什么）。这是 Visual Studio 2005 中的行为；我没有使用过 Visual Studio 2008，所以我不知道这在那个版本中的行为是否相同。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-09-03T12:29:53.267

是的，有一个非常好的方法。一个显着的缺点是您必须等待 5 年，甚至 6 年。既然我看到你在 2008 年 11 月发帖，我建议你 waaaaaa...

……啊啊啊。瞧！只是为了您，MS 发布了最新的**Visual Studio 2013 ，它是在调试模式下****运行**时可从菜单访问的默认功能（菜单*Debug* → *Windows* → *Autos*）。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-09T08:17:42.857

有很多解决方法，但似乎没有一个令人满意。

引用下面的 John Skeet（评论现已删除的答案）：

> 对我来说仍然看起来很不方便 - 特别是如果您在开始调试之前不知道需要哪个返回值。我真的不想每次我返回任何东西时都需要一个临时变量来弄乱我的代码。t

理论上，调试器可以有一个 -`return`变量。毕竟：它只是堆栈上的一个变量：

```
unsafe {
  int * sp = stackalloc int[1];
  try {
    return a+b;
  }
  finally {
    Trace.WriteLine("return is " + *(sp+3));
  }
} 
```

因此，请将此视为 Visual Studio 的功能请求。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-05-31T22:21:05.870

我想扩展[PascalK 的答案](https://stackoverflow.com/questions/268048/can-i-find-out-the-return-value-before-returning-while-debugging-in-visual-studi/36081401#36081401)，以使其在 Visual Studio 2015 中工作，因为有一个隐藏功能未在*[检查方法调用的返回值中](https://msdn.microsoft.com/en-us/library/dn323257.aspx)*记录。

如果您有嵌套函数调用，则会自动创建伪变量`$ResultValueX`，其中 X 指的是函数调用顺序。因此，如果您有诸如 的调用`Multiply(Five(), Six())`，则会创建以下伪变量：

```
Five()     | $ResultValue1 = 5
Six()      | $ResultValue2 = 6
Multiply() | $ResultValue3 = 30 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-19T06:00:28.160

我知道的唯一方法是在返回行上放置一个断点，然后调用*Quick Watch*窗口并输入返回的表达式：

```
someTableAdapter.getSomeData(); 
```

但这仅在调用不更改任何对象的状态时才有效（因为当您恢复执行时，将对同一方法进行第二次调用）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-06-16T10:52:41.840

Microsoft Visual C++ 曾经这样做，但 Visual Studio 没有 AFAIK.. :(

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-06T09:42:39.547

您也可以要求评估中间窗口中的值，如果它没有设置标志或其他变量，而只是返回一些东西。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-06T09:58:01.763

打开 Debug → Autos 窗口会让你关闭。它不会显示实际的返回值，但会显示在 return 语句中评估的内容。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-07-11T20:48:28.173

我认为您可以通过查看 Registers 窗口（Debug / Windows / Registers）中的 RAX 寄存器来确定这一点。退出函数（SHIFT + F11）后，检查RAX寄存器。我不知道事实，但有一次你可以检查一个寄存器（.NET 之前的日子）并在那里查看返回值。它甚至可能是 RAX 和 RBX 等的组合。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-07-19T00:56:48.330

是的，通过切换到 VB.NET。;P（你刚才说的是“Visual Studio”。;）

只要我记得（从 Visual Basic 到 VB.NET 的所有版本），您就可以简单地查询函数名称。`Exit Function`它像在函数开始时隐式声明的局部变量一样“起作用”，并且每当函数通过非返回语句退出时（即或只是失败），它的当前值也用作返回值，当然，当使用 return 语句。

它也被设置为 return 语句的表达式。就像局部变量一样，它的值可以在函数内部的任何执行点检查（包括在执行 return 语句之后）。C# 没有这个并且应该。

这个小小的 VB.NET 特性（加上`Exit Function`它启用的语句 - C# 没有并且应该的另一个特性）在我练习的一种[防御性编程](https://en.wikipedia.org/wiki/Defensive_programming)形式中非常有用，我总是将函数名称初始化为失败/默认值作为第一个声明。然后，在任何失败点（通常比成功点更频繁地发生），我可以简单地调用该`Exit Function`语句（即不必复制失败/默认表达式甚至常量/变量名称）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-07-19T12:21:44.630

[接受的答案](https://stackoverflow.com/questions/268048/can-i-find-out-the-return-value-before-returning-while-debugging-in-visual-studi/268052#268052)不适用于 Visual Studio 2015，但通过在方法的最后一行放置一个断点并按`F10`，它会将返回值的所有表达式放入本地窗口。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-11-06T09:27:47.813

您可以尝试选择`"someTableAdapter.getSomeData();"`，右键单击它，然后选择*Quick Watch*。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-09T01:18:22.973

将返回表达式拖放到监视窗口中。

例如，在声明中

```
return someTableAdapter.getSomeData(); 
```

拖放

```
someTableAdapter.getSomeData() 
```

进入监视窗口，您将看到该值。

您可以对任何表达式执行此操作。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-12-29T12:14:53.070

在 VS2019 中，只需转到 Debug->Windows->Autos 窗口。在那里，您会看到 concat 返回值，如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/ENccs.png)](https://i.stack.imgur.com/ENccs.png)

# delphi - Delphi 2009“将警告视为错误”选项在哪里？

> ID：268062
> 
> 赞同：16
> 
> 时间：2008-11-06T09:29:10.667
> 
> 标签：delphi, compiler-construction, delphi-2009

在 Delphi 2009 中，您在哪里打开将警告视为错误的选项？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-06T09:31:13.580

我发布此消息后不久就找到了答案！可能对其他人有用。

导航到 ' `Project -> Options - > Delphi Compiler -> Hints and Warnings`' 并将 ' ' 的值更改`Output Warnings`为 ' `as errors`'

我正在寻找类似于 Visual Studio 的选项

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-11T21:11:39.463

在相关说明中，如果您使用的是命令行编译器 (DCC32.exe)，则开关为 -W^ 以将警告视为错误。如果您正在使用它，请务必注意 Windows 中的默认命令 shell (cmd.exe) 将插入符号 (^) 视为转义字符，因此如果您直接执行编译器，则必须使用 -W^^来自命令行、批处理文件，甚至来自 IDE 中的 Pre-Build 或 Post-Build 事件。

还值得一提的是，您只能将某些警告视为错误。在命令行上执行此操作的开关如下所示：-W^^WARNING-NAME。您将替换与您希望视为错误的警告相关联的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T03:17:24.357

关于 -W^ 在 BAT 文件中存在问题的观点很好。如果您直接修改编译行，则使用 -W^^ 有效。否则，我发现使用双引号“-W^”可以工作，例如在构建一个包含所有编译器参数的环境变量时，该环境变量随后被传递给 dcc32.exe。用 XE、XE2、XE3、XE4 测试。

```
SET CompilerParams=-B -M "-W^" -U"..\Source;%dcuoutdir%;%DUnitPath%" -I"..\Source\inc" "-N0%dcuoutdir%" -DDebugMode
"%dcc%bin\dcc32.exe" %FuTFolder%ADDTests.dpr %CompilerParams% -U"%FuTSource%" %ExtraPath32%>%DCCLogFilename%
if errorlevel 1 %Alerter% %DCCLogFilename% 
```

# c# - C#：如何使用字典 实施 ICollection > 没有 Add(KeyValuePair )?

> ID：268064
> 
> 赞同：11
> 
> 时间：2008-11-06T09:29:22.583
> 
> 标签：c#, .net, dictionary, interface

看起来`System.Collections.Generic.Dictionary<TKey, TValue>`，它显然实现`ICollection<KeyValuePair<TKey, TValue>>`了，但没有所需的“ `void Add(KeyValuePair<TKey, TValue> item)`”功能。

这也可以在尝试`Dictionary`像这样初始化时看到：

```
private const Dictionary<string, int> PropertyIDs = new Dictionary<string, int>()
{
    new KeyValuePair<string,int>("muh", 2)
}; 
```

失败了

> 方法'Add'没有重载需要'1'参数

为什么呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T09:38:01.617

预期的 API 是通过两个参数`Add(key,value)`方法（或`this[key]`索引器）添加的；因此，它使用显式接口实现来提供`Add(KeyValuePair<,>)`方法。

如果您改用`IDictionary<string, int>`界面，您将可以访问缺少的方法（因为您无法在界面上隐藏任何内容）。

此外，对于集合初始化器，请注意您可以使用替代语法：

```
Dictionary<string, int> PropertyIDs = new Dictionary<string, int> {
  {"abc",1}, {"def",2}, {"ghi",3}
} 
```

它使用该`Add(key,value)`方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T09:41:28.677

一些接口方法是[显式](http://msdn.microsoft.com/en-us/library/aa664591(VS.71).aspx)实现的。如果你使用反射器，你可以看到显式实现的方法，它们是：

```
void ICollection<KeyValuePair<TKey, TValue>>.Add(KeyValuePair<TKey, TValue> keyValuePair);
bool ICollection<KeyValuePair<TKey, TValue>>.Contains(KeyValuePair<TKey, TValue> keyValuePair);
void ICollection<KeyValuePair<TKey, TValue>>.CopyTo(KeyValuePair<TKey, TValue>[] array, int index);
bool ICollection<KeyValuePair<TKey, TValue>>.Remove(KeyValuePair<TKey, TValue> keyValuePair);
IEnumerator<KeyValuePair<TKey, TValue>> IEnumerable<KeyValuePair<TKey, TValue>>.GetEnumerator();
void ICollection.CopyTo(Array array, int index);
void IDictionary.Add(object key, object value);
bool IDictionary.Contains(object key);
IDictionaryEnumerator IDictionary.GetEnumerator();
void IDictionary.Remove(object key);
IEnumerator IEnumerable.GetEnumerator(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:48:03.733

它不`ICollection<KeyValuePair<K,V>>`直接实现。它实现`IDictionary<K,V>`.

`IDictionary<K,V>`源自`ICollection<KeyValuePair<K,V>>`。

# c++ - 包含包含文件的文件时出现问题

> ID：268069
> 
> 赞同：0
> 
> 时间：2008-11-06T09:31:39.833
> 
> 标签：c++

我一直在尝试在包含的文件中包含一个文件，例如

**main.cpp 文件**

```
#include <includedfile.cpp>
int main(){
     cout<<name<<endl;
} 
```

**包含文件.cpp**

```
#include <iostream>
using namespace std;
string name;
name = "jim"; 
```

此代码不起作用，调试器说未定义名称。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T09:38:31.770

您不能在方法之外存在语句！

```
name = "jim"; // This is outside of any method, so it is an error. 
```

你可以重构你的代码，所以变量声明也是一个初始赋值，它应该是有效的（我的 C++ 有点生疏，所以我在这一点上可能是错误的）。

```
string name = "jim"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T11:22:16.290

更改**includedfile.cpp**说

```
string name = "jim"; 
```

应该可以工作（由 Comeau 在线确认）。你真的也应该明确地做

```
#include <string> 
```

否则，您依赖的是由 iostream 完成的事实。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:44:55.453

但是，您必须有充分的理由来包含 .cpp 文件。它会发生，但很少见！你到底想达到什么目的？或者你只是在做实验？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-04T07:26:32.633

好吧，当然它不起作用，因为定义的命名空间只在included.cpp 中起作用。这里的简单解决方案是在 main.xml 中再次编写“使用”。C\C++ 中的许多东西是在“文件范围”中定义的，当您在另一个文件中插入一个时，如何定义这样的范围并不完全清楚。

此外，包含 cpps 确实不是一个好习惯。您应该包含 h\hpp 文件（头文件），因为它会在项目增长（内聚力）中造成麻烦，并且会产生此处讨论的问题。

```
#include <includedfile.h>
#include <iostream>
int main()
{     
    std::cout << name << endl;
}

//includedfile.cpp
void DoSomething()
{
  std::string name;
  name = "jim";
}

//includedfile.h
void DoSomething(); 
```

# sql - 在多个列表中搜索缺失的条目

> ID：268079
> 
> 赞同：3
> 
> 时间：2008-11-06T09:36:48.280
> 
> 标签：sql, delphi, comparison, list

我有 3 个列表，我将在这里简化它们。

字母
A
B
C 列表

数字列表
1
2
3

混合
A,1
A,2
B,2
B,3
C,1
C,3

我需要知道缺少什么：
A,3
B,1
C,2

字母列表有大约 85 个条目
，数字列表有大约 500 个条目。

混合列表有大约 75,000 个条目。

我可以使用数据库查询（mysql 5.0）或 Turbo Delphi 2006 来处理文本文件。找到丢失的东西的最佳方法是什么？

谢谢，
戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T09:44:16.877

假设您在 SQL 表中都有两个列表，则交叉连接将产生所有组合：

```
SELECT
  Letter + ',' + Number AS Combination
FROM
  NumberList,
  LetterList 
```

使用组合结果（可能将其保存到临时表中），您可以使用 NOT EXISTS 查询来查找缺少的内容：

```
SELECT
  Combination
FROM
  AllCombinations AS a
WHERE
  NOT EXISTS 
  (SELECT 1 FROM MyCombitations AS m WHERE m.Combination = a.Combination) 
```

这将需要一个 table `MyCombitations`，其中列出了您实际拥有的所有组合并希望对照完整列表进行检查。

如果你想加快速度，你应该使用永久的组合表和`MyCombitations.Combination`字段索引。对于重复查询，这绝对是可取的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T18:21:06.287

无需创建额外的表。以下查询也可以正常工作：

```
SELECT c.chr, n.num
FROM chars c, nums n
 WHERE NOT EXISTS (SELECT 1
                     FROM mix m
                    WHERE m.chr = c.chr AND m.num = n.num) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T09:53:43.910

75.000 并不多。将字母列表和数字列表加载到两个单独的 TStringList 中。创建具有适当维度的动态数组（索引将是这两个字符串列表的索引）。填补;填写（表格，资料。加载数据并标记数组中的每一行。输出所有未标记的元素。

在伪代码（未经测试）中：

```
var
  i1, i2: integer;
  sl1, sl2: TStringList;
  cross: array of array of boolean;
begin
  // load data into sl1, sl2
  SetLength(cross, sl1.Count, sl2.Count);
  for i1 := 0 to sl1.Count - 1 do
    for i2 := 0 to sl2.Count - 1 do
      cross[i1, i2] := false;
  // for each element in 'combined' list
    // split it into elements s1, s2
    i1 := sl1.IndexOf(s1);
    i2 := sl2.IndexOf(s2);
    if (i1 < 0) or (i2 < 0) then
      // report error
    else
      cross[i1, i2] := true;
  for i1 := 0 to sl1.Count - 1 do
    for i2 := 0 to sl2.Count - 1 do
      if not cross[i1, i2] then
        // output sl1[i1], sl2[i2]
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T10:10:35.373

```
SELECT letter,number FROM lettersTable l , numbersTable n WHERE
(
    SELECT count(*) 
    FROM 
        (
            SELECT * 
            FROM combinationsTable 
            WHERE l.letter=combinationsTable.letter AND n.number = combinationsTable .number
        ) AS temp
) = 0; 
```

这依赖于 SELECT * FROM A,B 测试所有组合（隐式交叉连接）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T15:56:53.597

如果您可以对数据进行排序（[Turbo powers SysTools](http://sourceforge.net/projects/tpsystools)有一个运行良好的排序例程），那么您可以使用两个输入列表和一个输出列表在代码中相当快地完成此操作。这背后的概念很简单：

1.  取两个列表，以相同的方式排序
2.  如果左侧小于右侧，则右侧缺少该值，因此将其添加到“缺失列表”并增加左侧的光标。
3.  如果它们相等，则增加两者，
4.  如果右侧小于左侧，则仅增加右侧（可选添加到“必须删除”列表）。

这个过程有时被称为“老主人/新主人”过程，而且速度非常快，因为您只需走一遍这两个列表。

简单的例子：

```
var
  ListL : tStringList; // the left list
  ListR : tSTringList; // the right list
  ListA : tSTringList; // the Add List (should start empty)
  ListD : tStringList; // the Delete list (should start empty)
  iCurL : integer;     // Left Cursor
  iCurR : integer;     // Right Cursor
  iRes  : integer;     // result of compare
begin
  iCurL := 0;
  iCurR := 0;
  ListL := tStringList.create;
  ListR := tSTringList.create;
  ListA := tSTringList.create;
  ListD := tStringList.create;
  InitAndLoadLists(ListL,ListR,ListA,ListD);
  while (iCurL <= ListL.Count-1) and (iCurR <= ListR.Count-1) do
    begin
      iRes := CompareStr(ListL.Strings[iCurL],ListR.Strings[iCurR]);
      if iRes = 0 then
        begin
          inc(iCurL);
          inc(iCurR);
        end;
      if iRes < 0 then
        begin
          ListA.Add(ListL.Strings[iCurL]);
          inc(iCurL);
        end;
      if iRes > 0 then
        begin
          listD.Add(ListR.Strings[iCurR]);
          inc(iCurR);
        end;
    end;
  while (iCurL <= ListL.Count-1) do
    begin
      listA.Add(ListL.Strings[iCurL]);
      inc(iCurL);
    end;
  while (iCurR <= ListR.Count-1) do
    begin
      listD.Add(ListR.Strings[iCurR]);
      inc(iCurR);
    end;
  ShowMessage( 'ADDS' + ^M+^J + ListA.Text);
  ShowMessage( 'DELS' + ^M+^J + ListD.Text);
end; 
```

以下代码是我用于测试的代码。这只是一个例子，但在现实世界的情况下，我会构建我的密钥，以便它们能够正确排序、正确的填充数字，并在适当的情况下强制大小写。如果您使用 turbo power 排序例程，您可以使用两个排序而不是两个列表，但最终效果是相同的。

```
procedure InitAndLoadLists(ListL, ListR, ListA, ListD: TStringList);
begin
  ListL.Add('A,1');
  ListL.Add('B,3');
  ListL.Add('C,2');
  ListR.Add('A,2');
  ListR.Add('B,3');
  ListR.Add('C,4');
end; 
```

**编辑：**代码在 Delphi 2009 中测试并且表现正常。

# c# - 在 C# 中创建常量字典

> ID：268084
> 
> 赞同：148
> 
> 时间：2008-11-06T09:38:22.613
> 
> 标签：c#, .net, collections, dictionary, constants

创建s 到s 的**常量**（在运行时从不更改）映射的最有效方法是什么？`string``int`

我试过使用[const Dictionary](https://stackoverflow.com/questions/268064/c-how-can-dictionarykv-implement-icollectionkeyvaluepairkv-without-having-addke)，但没有成功。

我可以用适当的语义实现一个[不可变的包装器](https://stackoverflow.com/questions/35002/does-c-have-a-way-of-giving-me-an-immutable-dictionary)，但这似乎仍然不完全正确。

* * *

对于那些问过的人，我正在生成的类中实现[IDataErrorInfo](https://msdn.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo(v=vs.110).aspx)并且正在寻找一种方法来将 columnName 查找到我的描述符数组中。

我不知道（测试时打错字！d'oh！）那个开关接受字符串，所以这就是我要使用的。谢谢！

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2008-11-06T10:26:21.503

在 C# 中创建真正的编译时生成的常量字典并不是一项简单的任务。实际上，这里的答案都没有真正实现这一点。

有一种解决方案可以满足您的要求，尽管不一定是好的解决方案；请记住，根据 C# 规范，switch-case 表被编译为常量散列跳转表。也就是说，它们是常量字典，而不是一系列 if-else 语句。所以考虑这样的 switch-case 语句：

```
switch (myString)
{
   case "cat": return 0;
   case "dog": return 1;
   case "elephant": return 3;
} 
```

这正是你想要的。是的，我知道，这很丑。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-11-06T09:45:26.297

当前框架中的不可变集合很少。我可以想到 .NET 3.5 中一种相对无痛的选择：

使用`Enumerable.ToLookup()`-[`Lookup<,>`](http://msdn.microsoft.com/en-us/library/bb460184.aspx)类是不可变的（但在 rhs 上是多值的）；你可以`Dictionary<,>`很容易地做到这一点：

```
 Dictionary<string, int> ids = new Dictionary<string, int> {
      {"abc",1}, {"def",2}, {"ghi",3}
    };
    ILookup<string, int> lookup = ids.ToLookup(x => x.Key, x => x.Value);
    int i = lookup["def"].Single(); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-06T09:57:52.293

```
enum Constants
{
    Abc = 1,
    Def = 2,
    Ghi = 3
}

...

int i = (int)Enum.Parse(typeof(Constants), "Def"); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-06T10:39:12.023

这是您可以得到的最接近“CONST Dictionary”的东西：

```
public static int GetValueByName(string name)
{
    switch (name)
    {
        case "bob": return 1;
        case "billy": return 2;
        default: return -1;
    }
} 
```

编译器将足够聪明，以尽可能干净地构建代码。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-10-30T20:20:55.883

如果使用 4.5+ 框架，我将使用 ReadOnlyDictionary（也是列表的 ReadOnly Collection）来执行只读映射/常量。它是通过以下方式实现的。

```
static class SomeClass
{
    static readonly ReadOnlyDictionary<string,int> SOME_MAPPING 
        = new ReadOnlyDictionary<string,int>(
            new Dictionary<string,int>()
            {
                { "One", 1 },
                { "Two", 2 }
            }
        )
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-08-08T14:29:34.693

我不确定为什么没有人提到这一点，但在 C# 中对于我无法分配 const 的东西，我使用静态只读属性。

例子：

```
public static readonly Dictionary<string, string[]> NewDictionary = new Dictionary<string, string[]>()
        {
            { "Reference1", Array1 },
            { "Reference2", Array2 },
            { "Reference3", Array3 },
            { "Reference4", Array4 },
            { "Reference5", Array5 }
        }; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-04-10T17:01:05.907

为什么不使用命名空间或类来嵌套你的值呢？它可能不完美，但它非常干净。

```
public static class ParentClass
{
    // here is the "dictionary" class
    public static class FooDictionary
    {
        public const string Key1 = "somevalue";
        public const string Foobar = "fubar";
    }
} 
```

现在您可以访问 .ParentClass.FooDictionary.Key1 等。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-10-24T18:39:20.603

只是另一个想法，因为我绑定到一个 winforms 组合框：

```
public enum DateRange {
    [Display(Name = "None")]
    None = 0,
    [Display(Name = "Today")]
    Today = 1,
    [Display(Name = "Tomorrow")]
    Tomorrow = 2,
    [Display(Name = "Yesterday")]
    Yesterday = 3,
    [Display(Name = "Last 7 Days")]
    LastSeven = 4,
    [Display(Name = "Custom")]
    Custom = 99
    };

int something = (int)DateRange.None; 
```

从显示名称中获取 int[值](https://stackoverflow.com/questions/33225729/enum-value-from-display-name)：

```
public static class EnumHelper<T>
{
    public static T GetValueFromName(string name)
    {
        var type = typeof(T);
        if (!type.IsEnum) throw new InvalidOperationException();

        foreach (var field in type.GetFields())
        {
            var attribute = Attribute.GetCustomAttribute(field,
                typeof(DisplayAttribute)) as DisplayAttribute;
            if (attribute != null)
            {
                if (attribute.Name == name)
                {
                    return (T)field.GetValue(null);
                }
            }
            else
            {
                if (field.Name == name)
                    return (T)field.GetValue(null);
            }
        }

        throw new ArgumentOutOfRangeException("name");
    }
} 
```

用法：

```
var z = (int)EnumHelper<DateRange>.GetValueFromName("Last 7 Days"); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T09:43:14.773

字典似乎没有任何标准的不可变接口，因此不幸的是，创建包装器似乎是唯一合理的选择。

**编辑**：Marc Gravell 找到了我错过的 ILookup - 这将允许您至少避免创建新的包装器，尽管您仍然需要使用 .ToLookup() 转换字典。

如果这是一个受限于特定场景的需求，那么使用更面向业务逻辑的接口可能会更好：

```
interface IActiveUserCountProvider
{
    int GetMaxForServer(string serverName);
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-09-14T09:42:42.543

从 C# 8 开始，[新的 switch 表达式](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/switch-expression)是实现结果的最简洁方式：

```
int value = inputString switch {
    "one" => 1,
    "two" => 2,
    _ => -1
}; 
```

或作为一个函数

```
int GetValue(string inputString) => inputString switch {
    "one" => 1,
    "two" => 2,
    _ => -1
}; 
```

“旧”的更简洁：

```
int value = -1;
switch (inputString){
    case "one": value=1; break;
    case "two": value=2; break;
} 
```

新旧版本的性能差异可能因不同的编译器而异

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2010-07-27T12:48:25.027

为什么不：

```
public class MyClass
{
    private Dictionary<string, int> _myCollection = new Dictionary<string, int>() { { "A", 1 }, { "B", 2 }, { "C", 3 } };

    public IEnumerable<KeyValuePair<string,int>> MyCollection
    {
        get { return _myCollection.AsEnumerable<KeyValuePair<string, int>>(); }
    }
}
```

# emacs - 如何去除杀掉emacsclient缓冲区的提示？

> ID：268088
> 
> 赞同：24
> 
> 时间：2008-11-06T09:39:15.730
> 
> 标签：emacs, emacsclient

在我用 emacsclient 打开某些东西后，当我杀死那个缓冲区（Cx k）时，我得到一个确认对话框：

```
Buffer `blah' still has clients; kill it? (yes or no) 
```

但是当我杀死直接从 Emacs 打开的缓冲区时，我没有。有没有办法在 emacsclient 打开它们时不获取它们？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-06T14:26:20.630

另一个选项是使用`-n`选项 with`emacsclient`以便它在退出之前不等待文件被编辑。

例如：

```
emacsclient -n myfile.txt 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-06T10:19:14.870

这对我有用：

```
(remove-hook 'kill-buffer-query-functions 'server-kill-buffer-query-function) 
```

有关[使用 Emacsclient 博客条目](http://shreevatsa.wordpress.com/2007/01/06/using-emacsclient)的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-17T18:14:45.337

您可以设置键盘命令**Cx k**以便它将*客户端缓冲区*标记为已完成并终止*正常缓冲区*。

我无耻地从Emacs Wiki 中的[Emacs Client](http://www.emacswiki.org/emacs/EmacsClient#toc36)条目中窃取了这段代码片段：

```
(add-hook 'server-switch-hook
      (lambda ()
        (when (current-local-map)
          (use-local-map (copy-keymap (current-local-map))))
        (when server-buffer-clients
          (local-set-key (kbd "C-x k") 'server-edit)))) 
```

虽然这对其他杀死缓冲区的方式（例如`M-x list-buffers`）没有帮助，但通过尊重某些 shell 脚本所期望的 Emacs 客户端行为，它应该是安全的。

*这是 Emacs 发行版中文件server.el*的摘录，它可能会稍微说明我的意思：

```
;; When you finish editing a Server buffer, again call server-edit
;; to mark that buffer as done for the client and switch to the next
;; Server buffer.  When all the buffers for a client have been edited
;; and exited with server-edit, the client "editor" will return
;; to the program that invoked it. 
```

后来，有一个明确的警告，一个缓冲区不应该被杀死，而是被释放（至少我是这样解释的）：

```
;; Ask before killing a server buffer.
;; It was suggested to release its client instead,
;; but I think that is dangerous--the client would proceed
;; using whatever is on disk in that file. -- rms. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-28T00:47:16.080

无论出于何种原因，我必须在 emacs23 上手动启动 remove-hook 解决方案，可能是因为在加载 .emacs 之后加载了服务器的某些部分。在 (remove-hook ...) 之前向我的 .emacs 添加一个虚拟 (server-start) 行没有帮助。所以我选择了以下原则性较低的解决方案：

```
(defalias 'server-kill-buffer-query-function '(lambda () t)) 
```

# python - django 中的多数据库支持

> ID：268089
> 
> 赞同：10
> 
> 时间：2008-11-06T09:39:20.723
> 
> 标签：python, django, database-connection

从某个论坛我了解到，在 Django 中在较低级别添加了多数据库支持，但尚未添加更高级别的 api。

谁能告诉我如何在 Django 中实现多个数据库连接。

有没有人知道 Django 何时完全/正式支持多个数据库连接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-02T21:49:37.590

如果您只需要多个连接，则可以执行以下操作：

```
from django.db import load_backend
myBackend = load_backend('postgresql_psycopg2') # or 'mysql', 'sqlite3', 'oracle'
myConnection = myBackend.DatabaseWrapper({
    'DATABASE_HOST': '192.168.1.1',
    'DATABASE_NAME': 'my_database',
    'DATABASE_OPTIONS': {},
    'DATABASE_PASSWORD': "",
    'DATABASE_PORT': "",
    'DATABASE_USER': "my_user",
    'TIME_ZONE': "America/New_York",})
# Now we can do all the standard raw sql stuff with myConnection.
myCursor = myConnection.cursor()
myCursor.execute("SELECT COUNT(1) FROM my_table;")
myCursor.fetchone() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-17T00:52:00.120

这将在 Django 1.2 中。

请参阅[http://docs.djangoproject.com/en/dev/topics/db/multi-db/](http://docs.djangoproject.com/en/dev/topics/db/multi-db/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T11:35:55.997

The most recent discussion I've seen on it was in the [Proposal: user-friendly API for multi-database support](http://groups.google.com/group/django-developers/browse_thread/thread/9f0353fe0682b73) django-developers thread, which also has an example of one way to use multiple databases using Managers in the original message.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-07T15:54:37.987

如果您在 django-dev 中阅读了有关此主题的许多（*许多*）线程中的一些，您会发现*看起来很*简单，但实际上并非如此。如果你选择一个用例，那么它看起来很容易，但是一旦你开始以任何方式进行概括，你就会开始遇到麻烦。

以上面引用的线程为例，当您说“多个数据库”时，您指的是以下哪个？

*   同一引擎下同一台机器上的所有数据库。
*   同一台机器上的所有数据库，不同的引擎（例如 MySQL + PostgreSQL）
*   一个主数据库，在不同的机器上具有 N 个只读从属。
*   跨多个数据库服务器的表分片。

您是否需要：

*   跨数据库的外键
*   跨机器和/或引擎的 JOIN
*   等等等等

像 Django 那样光滑的 ORM 的一个问题是，它把所有这些杂乱的细节隐藏在了漂亮的油漆工作之下。继续这样做，但随后添加任何上述内容，并不容易（tm）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-15T16:46:56.760

Eric Florenzano 写了一篇非常好的博客文章，允许您在以下位置提供一些多数据库支持：[Easy MultipleDatabase Support for Django](http://www.eflorenzano.com/blog/post/easy-multi-database-support-django/)。

它首先创建一个允许您指定数据库设置的新自定义管理器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-16T19:33:51.857

有一个用于查询、保存和删除的“使用”指令

[https://docs.djangoproject.com/en/dev/topics/db/multi-db/#manually-selecting-a-database](https://docs.djangoproject.com/en/dev/topics/db/multi-db/#manually-selecting-a-database)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-30T12:49:34.340

多个数据库可供选择

我们总是需要一个命名的默认值，其余的名称由您决定。

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'mupltiple_datab_app1',                     
        'USER': 'root',                     
        'PASSWORD': 'admin',                  
        'HOST': "",                      
        'PORT': "",                     
    },
    'user1':{
        'ENGINE': 'django.db.backends.mysql', 
        'NAME': 'mupltiple_datab_app2',                      
        'USER': 'root',                     
        'PASSWORD': 'admin',                  
        'HOST': "",                        
        'PORT': "",  

    },
    'user2':{
        'ENGINE': 'django.db.backends.mysql', 
        'NAME': 'mupltiple_datab_app3',                      
        'USER': 'root',                     
        'PASSWORD': 'admin',                  
        'HOST':"" ,                     
        'PORT': "" ,  

    }
} 
```

同步到一个特定的数据库

```
manage.py syncdb --database=user1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T04:08:19.143

我认为您将不得不求助于“原始 sql”.. 有点东西..
看这里：[http ://docs.djangoproject.com/en/dev/topics/db/sql/](http://docs.djangoproject.com/en/dev/topics/db/sql/)

`django/db/__init__.py`如果您查看第 39 行左右（在我的版本中 ..），您需要与其他数据库的“连接”

`connection = backend.DatabaseWrapper(**settings.DATABASE_OPTIONS)`

尝试从那里拿走它..
PS我还没有真正尝试过这个或任何东西..只是试图指出我认为可以解决您问题的大方向。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-06T10:00:48.647

从 Django 1.2 开始，它将支持多个数据库。请参阅：[http](http://docs.djangoproject.com/en/dev/topics/db/multi-db/) ://docs.djangoproject.com/en/dev/topics/db/multi-db/ 版本 1.2 现在处于测试阶段

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-17T12:37:13.890

如果您的所有数据库都使用相同的引擎，那么 Eric Florenzano 的方法效果很好。如果您有不同的引擎（在我的例子中是 Postgres 和 MSSQL），您将在 ORM 代码深处遇到许多问题（例如使用默认连接的 SQL 语法的模型/sql/where.py）。

如果你需要这个工作，你应该等待 Alex Gaynor 为[Django 1.2计划的 MultiDB 项目](http://code.djangoproject.com/wiki/Version1.2Features)

# html - 主要内容流动的右浮动侧边栏 - 如何？

> ID：268093
> 
> 赞同：5
> 
> 时间：2008-11-06T09:41:35.960
> 
> 标签：html, css, web

我想创建一个网页布局，侧边栏位于右侧，主要内容围绕侧边栏流动。

要求：

1.  侧边栏下方的内容应占据所有可用宽度
2.  侧边栏下方的内容在碰到侧边栏左侧时不应换行
3.  主要内容应在标记中的侧边栏*之前*
4.  侧边栏具有固定宽度但未知/可变高度
5.  CSS-only - 没有 JavaScript 解决方案

这可以在没有第三个要求的情况下实现：如果侧边栏在标记中的主要内容之前并且在同一个包含元素内，那么一个简单的右浮动就可以完成这项工作。标记中主要内容之前的侧边栏不是这里的选项。侧边栏将包含补充信息和广告。如果这是在标记中的主要内容之前，那么对于无 CSS 浏览器和屏幕阅读器用户（即使使用“跳到...”链接）来说，这将会很烦人。

这可以在没有第四个要求的情况下实现。如果侧边栏有一个固定的高度，我可以在主要内容之前放置一个包含元素，将其浮动并给它一个合适的宽度和高度，然后使用绝对定位将侧边栏放在预制空间的顶部。

示例标记（没有 CSS，仅相关位）：

```
<body>
  <div id="content">
    <p>
      Lorem ipsum ....
    </p>
    <p>
      Pellentesque ....
    </p>
    <div id="sidebar">
      /* has some form of fixed width */
    </div>
  </div>
</body> 
```

示例布局：

[替代文字 http://webignition.net/images/layoutexample.png](http://webignition.net/images/layoutexample.png)

我不确定这是否可能。我很高兴接受权威的回答，说明这是无法实现的。如果这不能实现，我会很感激解释——知道为什么不能实现比仅仅被告知不能实现更有价值。

**更新**：我很高兴看到不满足所有五个要求的答案，只要答案说明忽略了哪个要求以及忽略该要求的后果（利弊）。然后我可以做出明智的妥协。

**更新 2**：我不能忽略要求 3 - 侧边栏不能位于内容之前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T14:17:17.667

无法完成带有相反源顺序的简单浮动（没有 CSS3 草案规范）。务实的方法是首先构建一个支持您所需的源顺序的好布局。HTML：

```
<div id="content" class="noJs">
  <div id="floatSpace"></div>
  <p>Lorem ipsum ....</p>
  <p>Pellentesque ....</p>
  <div id="sidebar">content</div>
</div> 
```

CSS：

```
#content {position:relative;}
#sidebar {width:150px; position:absolute; top:0; right:0;}
.noJs {padding-right:150px;}
.noJs #floatSpace {display:none;}
.js #floatSpace {float:right; width:150px;} 
```

这满足了除了 1 和 2 之外的所有问题。现在，我们添加 JS：

```
$(function () {
  // make floatSpace the same height as sidebar
  $('#floatSpace').height($('#sidebar').height());
  // trigger alternate layout
  $('#content')[0].className = 'js';
}); 
```

这将使内容在#floatSpace 周围浮动，而#sidebar 将保持在其顶部。这比移动#sidebar 更好，因为源顺序保持不变（对于支持 Javascript 的屏幕阅读器等）。

这是一个[JSFiddle 的实际应用](http://jsfiddle.net/wh6oLjy0/)。这种布局确实带来了保持浮动空间高度与侧边栏高度同步的不幸要求。如果侧边栏是动态的或具有延迟加载内容，则必须重新同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T09:57:30.953

我相信您将不得不为此更改顺序，将侧边栏放在首位。然后，使用 CSS 的`float`属性（不改变顺序，`div#sidebar`最终会在段落下方而不是在它们旁边）。`div#sidebar`应根据高度需要拉伸。

CSS：

```
#sidebar {
    float: right;
    width: 50px;
} 
```

HTML：

```
<body>
  <div id="content">
    <div id="sidebar">
      /* has some form of fixed width */
    </div>

    <!-- paragraphs -->
  </div>
</body> 
```

* * *

@乔恩克拉姆 [评论]

好的...非易失性。你说出了自己的答案，同时又拒绝了。

您不能将元素浮动在它之前定义的其他元素周围。浏览器必须能够回答“围绕什么浮动？” 它会从下一个元素开始，并尽可能继续。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T10:10:03.580

好的，那么这是另一个答案，因为我们可以忽略其中一个要求，所以跳过内容包含在侧边栏下方的第一个要求。

```
#sidebar {
  float: left;
  width: 100px;
}
#actualContent {
  width: 700px;
  float: left;
} 
```

对代码的唯一更改是您必须将*实际内容*放在另一个包装器中。

```
<div id="content">
    <div id="actualContent">
        <p>...</p>
        <p>...</p>
    </div>
    <div id="sidebar">
        <p>...</p>
    </div>
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T10:01:22.940

如果您可以重新排列您的 HTML，使侧边栏位于内容之前，那么这很容易：

```
#sidebar { float: right; width: 150px; } 
```

.. 然后确保之后清除它（在`#content`div 的末尾）。

我知道您的意图在正确的位置，以正确的顺序提供内容，但除非您期望来自视障用户的大量流量，否则我认为您可能需要重新考虑您的优先事项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T10:10:18.930

据我所知，获得所需侧边栏的唯一方法（没有明显的标记重新排序）是设置`#content { position: relative; }`和`#sidebar { position: absolute; right: 0; top: 0; }`

不幸的是，绝对定位将使侧边栏脱离流畅的布局，并且内容`#content`不会`#sidebar`如您所愿避免。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T10:47:32.553

我现在没有任何地方可以测试它，我不确定它是否会起作用，但是您是否尝试过将侧边栏 div 显示为**内联**并从那里开始？

# c# - 设计问题

> ID：268096
> 
> 赞同：0
> 
> 时间：2008-11-06T09:43:11.963
> 
> 标签：c#, object

我在 C# 中构建一个 Windows 应用程序，我有以下设计问题：

我有以下对象结构：父->子集合->子->孙子集合->孙子。

用例要求我分阶段使用我的 Parent 对象。例如。创建一个新的父实例。填充父级并保存。在稍后阶段，我将获取父级并填充子级并保存。在最后阶段，我将再次获取父对象并为特定子对象填充孙子对象并保存。

这是一个糟糕的对象模型吗？如果是这样，如何将这个巨大的对象模型拆分为更小的模型？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T10:12:43.213

我认为只有知道问题的领域才能回答这个问题。一个设计（大部分）是对还是错，取决于它如何适应情况。

# sql - 更新 SQL Server 中不同表中的数据

> ID：268105
> 
> 赞同：1
> 
> 时间：2008-11-06T09:45:49.447
> 
> 标签：sql, sql-server

在一张表中，我有以下架构

```
table1:
playerID int primary key,
nationalities nvarchar

table2:
playerID int,
pubVisited nvarchar 
```

现在，我想将所有玩家的playVisited设置为null，对于国籍为“英格兰”的玩家，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T09:57:35.600

在 SQL Server 2005 上测试

```
update table2 set pubVisited = NULL 
from 
    table1 t1 
        inner join 
    table2 t2 
    on (t1.playerID = t2.playerID and t1.nationalities = 'England') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T09:54:10.537

从*nvarchar*类型来看，您使用的是 MSSQL。现在，在 MySQL 中，您可以在 update .. where 子句中使用子选择，但 MSSQL 有自己的 update .. from 子句：

```
UPDATE table2
SET
    table2.pubVisited = null
FROM table1
WHERE
    table2.playerID = table1.playerID and table1.nationalities = 'England' 
```

不过还没有测试过，所以它可能不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:54:20.180

Oracle 中的语法为：

```
update table2
set playedvisited = NULL
where playerID in (select playerID 
                   from table1 
                   where nationalities = 'England') 
```

# sql - MySQL 跨表计数（*）查询帮助

> ID：268107
> 
> 赞同：2
> 
> 时间：2008-11-06T09:46:28.527
> 
> 标签：sql, mysql

```
SELECT `name` , COUNT(*) AS `count`
从`t1`，`t2`
WHERE `t2`.`id` = `t1`.`id`
GROUP BY `t2`.`id`

```

我想从 t1 获取名称以及 t2 中 id 与 t1 相同的行数。

到目前为止，我已经获得了上述内容，但是如果 t2 中没有匹配的行，它将不会返回任何数据。`count`如果没有行，我希望为 0（或 NULL），并且名称仍然返回。

*编辑：*我希望能够按`count`降序排序。（或`name`ASC）这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T10:02:28.587

这应该适合你：

```
SELECT `t1`.`id` , COUNT(`t2`.`id`) AS `count`
FROM `t1` LEFT JOIN `t2` ON `t1`.`id` = `t2`.`id`
GROUP BY `t1`.`id` 
```

左连接确保您拥有来自 t1 的所有行，并且 COUNT( `t2`. `id`) 使其仅计算 t2.id 不为空的记录（即 - 那些真正存在于 t2 中的记录）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T10:18:41.440

这按 COUNT 降序排序，在相同的计数中按`name`. 没有行的名称`t2`将返回计数为 0。

```
SELECT 
  `t1`.`name`, 
  COUNT(`t2`.`id`) AS `count`
FROM 
  `t1` 
  LEFT JOIN `t2` ON`t2`.`id` = `t1`.`id`
GROUP BY
  `t1`.`name`
ORDER BY
  COUNT(`t2`.`id`) DESC,
  `t1`.`name` 
```

根据您的需要修改 ORDER BY。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:51:32.010

做一个联合以获得另一组

```
SELECT `name` , COUNT(*) AS `count`
FROM `t1`, `t2`
WHERE `t2`.`id` = `t1`.`id`
GROUP BY `t2`.`id`
UNION
Select name, 0 as count
from t1
where NOT EXISTS (select 1 from t2 where `t2`.`id` = `t1`.`id`) 
```

# iphone - 全屏摄像头

> ID：268108
> 
> 赞同：1
> 
> 时间：2008-11-06T09:46:32.317
> 
> 标签：iphone, cocoa-touch

如何通过删除覆盖使 iPhone 相机全屏显示？

我可以更改相机工具栏样式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:41:27.720

I ran into a blog on this last night, that discussed how to stripp out the overlay view.

[http://blogs.oreilly.com/iphone/2008/10/creating-a-full-screen-camera.html](http://blogs.oreilly.com/iphone/2008/10/creating-a-full-screen-camera.html)

It's not clear whether this would pass testing, though Phanfare do customize their view.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T12:22:14.123

There is no reliable way to do this using the current iPhone SDK. You should file a [bug](http://bugreporter.apple.com) with Apple to try to get them to add more control over the camera.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T20:07:29.150

很长一段时间以来，我一直在尝试这样做。

以及我上面帖子中的链接。我偶然发现了这个页面 - [http://blog.airsource.co.uk/index.php/2008/11/11/views-of-uiimagepickercontroller/](http://blog.airsource.co.uk/index.php/2008/11/11/views-of-uiimagepickercontroller/)

虽然文章本身并不引人注目，但评论提供了一些很好的见解和建议。此外，一些用户提供了一些外部网站的链接。如果你碰巧让它工作，请给我发电子邮件。

# visual-studio-2008 - 将文件系统中的图片动态加载到Crystal Report中（VS 2008版）

> ID：268109
> 
> 赞同：0
> 
> 时间：2008-11-06T09:47:07.150
> 
> 标签：visual-studio-2008, crystal-reports

我有一个需要生成包含可选图像的报告（发票）的 VB.NET 应用程序。图像将被加载到报告中 6 个位置中的 1 个，但将驻留在客户端 PC（与应用程序一起部署）上。我一直在尝试访问放置在报告上的 ICROleObject 对象，但我什至无法在对象浏览器中找到此接口。由于这是对象的接口，我认为只要我可以转换它，它就会让我访问它：    

```
 CType（r.ReportDefinition.ReportObjects（“picTL”），ICROleObject）
```

我会在哪里找到这个的任何想法，或者我是否正确地接近这个？
我已经尝试按照以下说明进行操作[http://www.idautomation.com/crystal/streaming_crystal.html](http://www.idautomation.com/crystal/streaming_crystal.html)，这不适用于嵌入在 .NET 2008 中的 Crystal 版本。[http://www.a1vbcode.com/a1vbcode/vbforums/Topic25620-3-1.aspx#bm25974](http://www.a1vbcode.com/a1vbcode/vbforums/Topic25620-3-1.aspx#bm25974)，虽然那个看起来更有希望，并且是我试图模仿的那个。
如果我必须使用数据集和一系列子报告，我想可以……但这种方法似乎不像这个方法那么简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-22T19:21:00.880

您应该将其转换为 PictureObject。“PictureObject”类型位于**CrystalDecisions.CrystalReports.Engine**命名空间中。

前任：

Dim pic = CType(rapportCourant.ReportDefinition.ReportObjects("Picture1"), **PictureObject** ) pic.ObjectFormat.EnableSuppress = True

然后，您可以根据需要禁止启用图片对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-17T13:40:34.223

我的方法是设置一个 Crystal Reports**参数**来定义哪个图像应该是可见的，然后使用这个参数自定义**Suppress 公式。**我在导出报表时遇到了水晶报表异常，这是由于从报表外部操作报表对象引起的，即使打印预览工作正常。

# xslt - 如何在 XSLT 中进行字符串操作？

> ID：268116
> 
> 赞同：5
> 
> 时间：2008-11-06T09:50:49.313
> 
> 标签：xslt, string, xpath

我的 xslt 中有以下代码块；

```
 <xsl:when test="StatusData/Status/Temperature > 27">
        <td bgcolor="#ffaaaa">              
          <xsl:value-of select="StatusData/Status/Temperature" />              
        </td>
      </xsl:when> 
```

但是您可能会猜到，当值是 34,5 而不是 34.5 时，它被识别为字符串，这使得整数比较变得不可能。我想用 . 将是需要 char 替换的解决方案。我的问题是我怎么能做到这一点，或者了解更多关于 XSLT 中的字符串操作的信息会很棒......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T09:58:31.933

`translate()`XPath 中有一个函数：

```
test="translate(StatusData/Status/Temperature, ",", ".") > 27" 
```

此外，您应该使用 number 函数，它将其参数转换为数字（或 NaN，如果失败）：

```
test="number(translate(StatusData/Status/Temperature, ",", ".")) > 27.0" 
```

请参阅w3.org的[文档`translate()`](http://www.w3.org/TR/xpath#function-translate)和[文档。`number()`](http://www.w3.org/TR/xpath#function-number)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T10:07:35.177

非常感谢。

它可以工作，但只需进行一个简单的修改：

```
test="number(translate(StatusData/Status/Temperature, ',', '.')) > 27.0" 
```

顺便说一句，这与 XSLT 无关，而是关于 XPath :) 很好学...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T17:16:45.347

`replace()`在 XSL 2 中，您还可以使用甚至支持正则表达式模式的成熟版本。

# asp.net - 在C#中检查字符串值是否具有数值

> ID：268120
> 
> 赞同：11
> 
> 时间：2008-11-06T09:52:23.240
> 
> 标签：asp.net, c#-2.0

我有这样的字符串

字符串 str = "dfdsfdsf8fdfdfd9dfdfd4"

我需要通过遍历数组来检查字符串是否包含数字。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-06T10:00:07.560

那么正则表达式呢：

```
bool val = System.Text.RegularExpressions.Regex.IsMatch(str, @"\d"); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T10:00:43.787

如果您正在寻找一个整数值，您可以使用**[int.TryParse](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)**：

```
int result;
if (int.TryParse("123", out result))
{
    Debug.WriteLine("Valid integer: " + result);
}
else
{
    Debug.WriteLine("Not a valid integer");
} 
```

要检查十进制数，请将 int.TryParse 替换为[**Decimal.TryParse**](http://msdn.microsoft.com/en-us/library/ew0seb73.aspx)。查看这篇博文和评论[“为什么你应该在 C# 中使用 TryParse()”](http://fatagnus.com/why-you-should-use-tryparse-in-c/)以了解详细信息。

如果你需要十进制数，你也可以使用这个正则表达式：

```
return System.Text.RegularExpressions.Regex.IsMatch(
   TextValue, @"^-?\d+([\.]{1}\d*)?$"); 
```

最后是另一种选择（如果您不虔诚地*反对 VB.NET*），您可以使用 Microsoft.VisualBasic 命名空间中的方法：

```
Microsoft.VisualBasic.Information.IsNumeric("abc"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T10:30:55.567

如果您要遍历字符串，请不要使用 int.TryParse ... 这太重了。相反，使用 char.IsNumber();

例子：

```
foreach (char c in myString)
    if (char.IsNumber(c))
        return true; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-21T19:51:23.017

```
str.ToCharArray().Any(x => char.IsNumber(x)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-04T12:07:33.537

结合 Kamals 答案和 Tristars 答案的部分内容给出...

```
str.Any(char.IsNumber) 
```

我认为这是最简洁易读的方式，而不是正则表达式

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T10:06:26.800

如果你像我一样是 linq 瘾君子，你会这样做

```
string s = "abc1def2ghi";
bool HasNumber = (from a in s.ToCharArray() where a >= '0' && a <= '9' select a).Count() > 0; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T10:11:02.813

在 C# 2.0 中，试试这个：

```
 string str = "dfdsfdsf8fdfdfd9dfdfd4";

        for (int i = 0; i < str.Length; i++)
        {
            int result;
            if (int.TryParse(str[i].ToString(), out result))
            {
                //element is a number            
            }
            else
            {
                // not a number
            }
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-18T01:56:25.707

```
str.ToCharArray().Any(char.IsNumber) 
```

# c++ - 何时为 I/O (C++) 构建自己的缓冲系统？

> ID：268121
> 
> 赞同：6
> 
> 时间：2008-11-06T09:52:45.533
> 
> 标签：c++, linux, performance, io, buffer

我必须处理非常大的文本文件（2 GB），必须逐行读取/写入它们。使用 ofstream 写入 2300 万行真的很慢，所以一开始，我尝试加快在内存缓冲区（例如 256 MB 或 512 MB）中写入大块行的过程，然后将缓冲区写入文件. 这不起作用，性能或多或少相同。我在读取文件时遇到了同样的问题。我知道 I/O 操作由 STL I/O 系统缓冲，这也取决于磁盘调度程序策略（由操作系统管理，在我的情况下是 Linux）。

关于如何提高性能的任何想法？

PS：我一直在考虑在程序处理数据时使用后台子进程（或线程）来读取/写入数据块，但我不知道（主要是在子进程的情况下）这是否值得。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T11:19:29.820

2GB 的文件非常大，您需要了解所有可能成为瓶颈的区域：

*   硬盘本身
*   硬盘接口（IDE/SATA/RAID/USB？）
*   操作系统/文件系统
*   C/C++ 库
*   你的代码

我会先做一些测量：

*   您的代码读取/写入 2GB 文件需要多长时间，
*   [' dd](http://en.wikipedia.org/wiki/Dd_%28Unix%29#Benchmarking_drive_performance) ' 命令读写磁盘的速度有多快？例子...

    `dd if=/dev/zero bs=1024 count=2000000 of=file_2GB`

*   仅使用大 fwrite()/fread() 调用写入/读取需要多长时间

假设您的磁盘能够以大约 40Mb/s 的速度读取/写入（这可能是一个现实的数字），那么您的 2GB 文件的运行速度不会超过大约 50 秒。

实际需要多长时间？

> 嗨 Roddy，使用 fstream 读取 1.1 GB 文件和大缓冲区（128,255 或 512 MB）的方法大约需要 43-48 秒，使用 fstream getline（逐行）也是如此。cp 需要将近 2 分钟来复制文件。

在这种情况下，你是硬件绑定的。*cp*必须读取和写入，并且在执行此操作时会像发疯一样在磁盘表面来回寻找。所以它（如你所见）比简单的“读取”情况要糟糕两倍多。

为了提高速度，我首先尝试的是更快的硬盘驱动器或 SSD。

你还没说磁盘接口是什么？SATA 几乎是最简单/最快的选择。另外（很明显，这...）确保磁盘物理上位于您的代码正在运行的同一台机器上，否则您是网络绑定的...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T10:09:53.563

我还建议使用内存映射文件，但如果您要使用 boost，我认为[boost::iostreams::mapped_file](http://www.boost.org/doc/libs/1_36_0/libs/iostreams/doc/classes/mapped_file.html#mapped_file)比 boost::interprocess 更好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T09:58:35.270

也许您应该查看内存映射文件。

在这个库中检查它们：[Boost.Interprocess](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T12:07:30.987

只是一个想法，但避免使用 std::endl ，因为这将在缓冲区满之前强制刷新。使用 '\n' 代替换行符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T12:42:56.267

不要使用 new 来分配这样的缓冲区：

试试：std::vector<>

```
unsigned int      buffer_size = 64 * 1024 * 1024; // 64 MB for instance.
std::vector<char> data_buffer(buffer_size);
_file->read(&data_buffer[0], buffer_size); 
```

另请阅读有关[在标识符名称中使用下划线的文章：](https://stackoverflow.com/questions/228783/what-are-the-rules-about-using-an-underscore-in-a-c-identifier) . 请注意，您的代码可以，但是。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T13:04:58.593

使用 getline() 可能效率低下，因为字符串缓冲区可能需要多次调整大小，因为数据从流缓冲区附加到它。您可以通过预先调整字符串的大小来提高效率：

您还可以将 iostreams 缓冲区的大小设置为非常大或 NULL（对于无缓冲）

```
// Unbuffered Accesses:
fstream file;
file.rdbuf()->pubsetbuf(NULL,0);
file.open("PLOP");

// Larger Buffer
std::vector<char>  buffer(64 * 1024 * 1024);
fstream            file;
file.rdbuf()->pubsetbuf(&buffer[0],buffer.size());
file.open("PLOP");

std::string   line;
line.reserve(64 * 1024 * 1024);

while(getline(file,line))
{
    // Do Stuff.
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T11:30:11.123

如果您要自己缓冲文件，那么我建议您使用非缓冲 I/O 进行一些测试（在您打开的文件上设置 vbuf 可以关闭库缓冲）。

基本上，如果你要自己缓冲，你想禁用库的缓冲，因为它只会给你带来痛苦。我不知道是否有任何方法可以为 STL I/O 做到这一点，所以我建议深入到 C 级 I/O。

# vim - Vim - 如何一步开始在文件末尾插入

> ID：268123
> 
> 赞同：57
> 
> 时间：2008-11-06T09:53:26.797
> 
> 标签：vim

是否有一个快捷方式可以开始在文件末尾的新行中插入？

我知道`G`+`o`组合。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-12-18T19:53:19.543

还有命令行选项“+”：

```
vim + myfile.txt

```

将打开 myfile.txt 并为您自动执行 G。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-06T09:56:45.057

并不是我所知道的 - `G`+`o`也是我所建议的，但那是两个步骤:)

您始终可以创建一个执行`G`+的宏`o`，然后您可以调用将是 1 步的宏。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-06T09:59:11.213

将以下内容添加到 ~/.vimrc 将为您创建一个：

```
:nmap ^A Go 
```

要键入“^A”，请先按 Ctrl-V，然后按 Ctrl-A。然后，您可以在不处于插入或可视模式时使用 Ctrl-A 在文件末尾追加。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-11-29T21:40:02.083

```
echo >> myfile.txt && vim -c 'startinsert' + myfile.txt 
```

您还可以将上述命令保存在脚本中，然后使用 $1 代替 myfile.txt，将您的脚本命名为 myvim（或任何您喜欢的名称）并始终打开文件并立即开始写入。

```
myvim myfile.txt 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T10:01:47.573

您可以将地图定义粘贴在 .vimrc 中，然后在打开文件时调用它。

或者，如果您只想对特定文件执行此操作，您可以为该文件类型创建一个自动执行此操作的 autocmd。请参阅vim 文档中的[自动命令。](http://vimdoc.sourceforge.net/htmldoc/autocmd.html#autocommand)

# java - 使用 JBoss 和 Spring 在 Java Web 应用程序之间共享业务对象实例的最佳方式是什么？

> ID：268129
> 
> 赞同：15
> 
> 时间：2008-11-06T09:54:26.887
> 
> 标签：java, hibernate, spring, jboss, ejb-3.0

我们目前有一个 Web 应用程序加载一个 Spring 应用程序上下文，它实例化一堆业务对象、DAO 对象和 Hibernate。我们希望与另一个 Web 应用程序共享此堆栈，以避免具有相同对象的多个实例。

我们研究了几种方法；使用 JMX 或 JNDI 或使用 EJB3 公开对象。

不同的方法都有自己的问题，我们正在寻找一种轻量级的方法。

关于如何解决这个问题的任何建议？

编辑：我收到了要求我详细说明的评论，所以这里是：

我们要解决的主要问题是我们只想拥有一个 Hibernate 实例。这是由于在运行多个使用相同数据源的客户端应用程序时，Hibernate 的二级缓存失效的问题。此外，业务/DAO/Hibernate 堆栈越来越大，因此不复制它更有意义。

首先，我们试图研究如何单独将业务层暴露给其他 Web 应用程序，Spring 以少量 XML 的价格提供了 JMX 包装。但是，我们无法将 JMX 实体绑定到 JNDI 树，因此我们无法从 Web 应用程序中查找对象。

然后我们尝试将业务层直接绑定到 JNDI。尽管 Spring 没有为此提供任何方法，但使用 JNDITemplate 绑定它们也很简单。但这导致了几个新问题： 1) 安全管理器拒绝访问 RMI 类加载器，因此一旦我们尝试调用 JNDI 资源上的方法，客户端就会失败。2) 一旦安全问题得到解决，JBoss 抛出 IllegalArgumentException: object is not an instance of declaring class。稍微阅读一下就会发现我们需要 JNDI 资源的存根实现，但这似乎很麻烦（也许 Spring 可以帮助我们？）

我们还没有过多地研究 EJB，但是在前两次尝试之后，我想知道我们想要实现的目标是否完全可能。

总结一下我们想要实现的目标：一个 JBoss 实例，几个 Web 应用程序利用 DAO 层和 Hibernate 之上的一组业务对象。

最好的祝福，

尼尔斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T15:40:38.013

Web 应用程序是否部署在同一台服务器上？

我不能代表 Spring，但使用 Session Bean 将业务逻辑移入 EJB 层很简单。

应用程序组织是直截了当的。逻辑进入会话 Bean，这些会话 Bean 捆绑在单个 jar 中，作为带有 ejb-jar.xml 文件的 Java EE 工件（在 EJB3 中，这可能实际上是空的）。

然后将您的实体类捆绑到一个单独的 jar 文件中。

接下来，您会将每个 Web 应用程序构建到它们自己的 WAR 文件中。

最后，所有的 jars 和 war 都捆绑到一个 Java EE EAR 中，并带有关联的 application.xml 文件（同样，这可能非常小，只需枚举 EAR 中的 jars）。

此 EAR 被批量部署到应用服务器。

每个 WAR 实际上都是独立的——它们自己的会话、上下文路径等。但它们共享公共 EJB 后端，因此您只有一个二级缓存。

您还可以使用本地引用和调用语义来与 EJB 对话，因为它们位于同一服务器中。这里不需要远程调用。

我认为这很好地解决了您遇到的问题，并且在带有 EJB 3 的 Java EE 5 中非常简单。

此外，据我了解，您仍然可以在大部分工作中使用 Spring，但我不是 Spring 人，所以我不能谈论细节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T16:07:59.397

春天的父母上下文呢？看看这篇文章：

[http://springtips.blogspot.com/2007/06/using-shared-parent-application-context.html](http://springtips.blogspot.com/2007/06/using-shared-parent-application-context.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T16:44:38.040

[Terracotta](http://www.terracotta.org/)可能很适合这里（披露：我是 Terracotta 的开发人员）。Terracotta 在 JVM 级别透明地集群 Java 对象，并与 Spring 和 Hibernate 集成。它是免费和开源的。

正如您所说，使用 L2 缓存的多个客户端 Web 应用程序的问题是使这些缓存保持同步。使用 Terracotta，您可以集群单个 Hibernate L2 缓存。每个客户端节点都使用它的集群缓存副本，并且 Terracotta 保持同步。 [这个链接](http://www.terracotta.org/web/display/orgsite/Hibernate+Integration#HibernateIntegration-UsingSecondLevelCacheorDetachedInstancesMode)解释更多。

至于您的业务对象，您可以使用 Terracotta 的[Spring 集成](http://www.terracotta.org/web/display/orgsite/Spring+Integration)来集群您的 bean - 每个 Web 应用程序可以共享集群 bean 实例，并且 Terracotta 透明地保持集群状态同步。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T21:02:14.967

实际上，如果您想要一个轻量级解决方案并且不需要事务或集群，只需使用 Spring 对 RMI 的支持。它允许使用最新版本中的简单注释远程公开 Spring bean。请参阅[http://static.springframework.org/spring/docs/2.0.x/reference/remoting.html](http://static.springframework.org/spring/docs/2.0.x/reference/remoting.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T21:11:23.340

你应该看看 Terracotta Reference Web Application - Examinator。它拥有您正在寻找的大部分组件——它有 Hibernate、JPA 和 Spring 以及 MySQL 后端。

它已预先调整为最多可扩展到 16 个节点、20k 个并发用户。

在这里查看：[http ://reference.terracotta.org/examinator](http://reference.terracotta.org/examinator)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-11T07:50:47.633

到目前为止，感谢您的回答。我们还没有完全做到这一点，但我们现在已经尝试了一些事情，并且更清楚地看到了事情。这是一个简短的更新：

似乎最可行的解决方案是 EJB。但是，这将需要对我们的代码进行一些更改，因此我们现在不会完全实现该解决方案。我几乎很惊讶我们还没有找到一些 Spring 特性来帮助我们。

我们还尝试了 JNDI 路由，它以所有共享接口都需要存根结束。考虑到一切都在同一台服务器上，这感觉很麻烦。

昨天，我们在 JMX 方面取得了小小的突破。尽管 JMX 绝对不适合这种用途，但我们已经证明它可以做到——无需更改代码和最少的 XML（非常感谢 Spring 提供的 MBeanExporter 和 MBeanProxyFactoryBean）。这种方法的主要缺点是性能和我们的域类必须通过 JBoss 的 server/lib 文件夹共享的事实。即，我们必须从我们的 WAR 中删除一些依赖项并将它们移动到 server/lib，否则当业务层从我们自己的域模型返回对象时，我们会得到 ClassCastException。我完全理解为什么会发生这种情况，但这对于我们想要实现的目标并不理想。

我认为是时候进行一些更新了，因为看起来最好的解决方案需要一些时间来实施。完成这项工作后，我将在这里发布我们的发现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T16:13:56.283

Spring 确实有一个您可能感兴趣的集成点： [EJB 3 injection 拦截器](http://static.springframework.org/spring/docs/2.5.x/reference/ejb.html)。这使您能够从 EJB 访问 spring bean。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T18:44:00.390

我不确定您要解决什么问题；在一天结束时，每个 jvm 要么具有对象的复制实例，要么具有表示存在于另一个（逻辑）服务器上的对象的存根。

您可以设置第三个“业务逻辑”服务器，该服务器具有您的两个 Web 应用程序可以调用的远程 API。典型的解决方案是使用 EJB，但我认为 spring 在其堆栈中内置了远程处理选项。

另一种选择是使用某种形式的共享缓存架构......它将在服务器之间同步对象更改，但您仍然有两组实例。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-06T15:29:11.203

看看[JBossCache](http://www.jboss.org/jbosscache/)。它允许您在多个 JVM 实例（相同或不同）之间轻松共享/复制数据映射。它易于使用，并且有很多线级协议选项（TCP、UDP 多播等）。

# c# - 反转“if”语句以减少嵌套

> ID：268132
> 
> 赞同：302
> 
> 时间：2008-11-06T09:55:26.683
> 
> 标签：c#, resharper

当我在我的代码上运行[ReSharper](http://en.wikipedia.org/wiki/ReSharper)时，例如：

```
 if (some condition)
    {
        Some code...            
    } 
```

ReSharper 给了我上述警告（反转“if”语句以减少嵌套），并建议进行以下更正：

```
 if (!some condition) return;
   Some code... 
```

我想了解为什么这样更好。我一直认为在方法中间使用“return”是有问题的，有点像“goto”。

* * *

## 回答 #1

> 赞同：349
> 
> 时间：2011-12-08T20:34:26.280

**它不仅美观**，而且还降低了方法内部的[最大嵌套级别](http://codebetter.com/patricksmacchia/2008/03/07/a-simple-trick-to-code-better-and-to-increase-testability/)。这通常被认为是一个优点，因为它使方法更容易理解（事实上，[许多](http://www.ndepend.com/Metrics.aspx#ILNestingDepth) [静态](http://www.scitools.com/documents/metricsList.php?metricGroup=complex#MaxNesting) [分析](http://www.aivosto.com/project/help/pm-complexity.html) [工具](http://www.semdesigns.com/products/metrics/CSharpMetrics.html)提供了一个衡量这一点的方法，作为代码质量的指标之一）。

另一方面，它也让你的方法有多个退出点，而另一群人认为这是一个禁忌。

就个人而言，我同意 ReSharper 和第一组（在有例外的语言中，我觉得讨论“多个退出点”很愚蠢；几乎任何事情都可以抛出，因此所有方法中都有许多潜在的退出点）。

**关于性能**：每种语言的两个版本*都应该*是等效的（如果不是在 IL 级别，那么肯定是在代码抖动结束之后）。理论上这取决于编译器，但实际上当今任何广泛使用的编译器都能够处理比这更高级的代码优化案例。

* * *

## 回答 #2

> 赞同：321
> 
> 时间：2008-11-06T10:11:23.747

方法中间的返回不一定是坏的。如果它使代码的意图更清晰，最好立即返回。例如：

```
double getPayAmount() {
    double result;
    if (_isDead) result = deadAmount();
    else {
        if (_isSeparated) result = separatedAmount();
        else {
            if (_isRetired) result = retiredAmount();
            else result = normalPayAmount();
        };
    }
     return result;
}; 
```

在这种情况下，如果`_isDead`为真，我们可以立即退出该方法。以这种方式构造它可能会更好：

```
double getPayAmount() {
    if (_isDead)      return deadAmount();
    if (_isSeparated) return separatedAmount();
    if (_isRetired)   return retiredAmount();

    return normalPayAmount();
}; 
```

我从[重构目录](http://www.refactoring.com/catalog/replaceNestedConditionalWithGuardClauses.html)中挑选了这段代码。这种特定的重构称为：用保护子句替换嵌套条件。

* * *

## 回答 #3

> 赞同：104
> 
> 时间：2008-11-06T10:01:21.960

这有点宗教争论，但我同意 ReSharper 的观点，即您应该更喜欢少嵌套。我相信这胜过从一个函数中拥有多个返回路径的负面影响。

减少嵌套的关键原因是提高**代码的可读性和可维护性**。请记住，将来许多其他开发人员将需要阅读您的代码，而缩进较少的代码通常更容易阅读。

**前置条件**是一个很好的例子，说明可以在函数开始时提前返回。为什么函数其余部分的可读性会受到前置条件检查的影响？

至于从一个方法多次返回的负面影响 - 调试器现在非常强大，而且很容易准确地找出特定函数返回的位置和时间。

*在一个函数中有多个返回不会影响维护程序员的工作。*

*代码可读性差会。*

* * *

## 回答 #4

> 赞同：70
> 
> 时间：2011-12-08T21:52:54.150

正如其他人所提到的，不应该对性能造成影响，但还有其他考虑因素。除了那些有效的担忧之外，在某些情况下，这也可能会让你陷入困境。假设您正在处理的是`double`：

```
public void myfunction(double exampleParam){
    if(exampleParam > 0){
        //Body will *not* be executed if Double.IsNan(exampleParam)
    }
} 
```

*将其与看似*等效的反转进行对比：

```
public void myfunction(double exampleParam){
    if(exampleParam <= 0)
        return;
    //Body *will* be executed if Double.IsNan(exampleParam)
} 
```

因此，在某些情况下，看起来正确反转的 aa`if`可能不是。

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2008-11-06T10:16:43.457

仅在函数结束时返回的想法来自于语言支持异常之前的日子。它使程序能够依赖于能够将清理代码放在方法的末尾，然后确保它会被调用并且其他一些程序员不会在导致清理代码被跳过的方法中隐藏返回. 跳过的清理代码可能会导致内存或资源泄漏。

但是，在支持异常的语言中，它不提供这样的保证。在支持异常的语言中，任何语句或表达式的执行都可能导致导致方法结束的控制流。这意味着清理必须通过使用 finally 或使用关键字来完成。

无论如何，我的意思是我认为很多人引用了“仅在方法结束时返回”指南，却不理解为什么这是一件好事，并且减少嵌套以提高可读性可能是一个更好的目标。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2011-12-13T17:12:41.393

我想补充一点，那些倒置的 if 有一个名字 - 保护条款。我尽可能使用它。

我讨厌阅读开头有 if 的代码，两个屏幕的代码，没有别的。只需反转 if 并返回。这样没有人会浪费时间滚动。

[http://c2.com/cgi/wiki?GuardClause](http://c2.com/cgi/wiki?GuardClause)

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2011-12-08T20:36:05.670

它不仅影响美观，而且还防止代码嵌套。

它实际上可以作为一个前提条件来确保您的数据也是有效的。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-11-06T10:05:38.080

这当然是主观的，但我认为它在两点上有很大的改进：

*   `condition`现在很明显，如果成立，您的函数将无事可做。
*   它使嵌套级别降低。嵌套对可读性的伤害比你想象的要大。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2008-11-06T10:23:13.943

多个返回点在 C（以及在较小程度上 C++）中是一个问题，因为它们迫使您在每个返回点之前复制清理代码。通过垃圾收集，`try`| `finally`构造和`using`块，你真的没有理由害怕它们。

最终归结为您和您的同事认为更容易阅读的内容。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2008-11-06T10:07:18.390

保护子句或前置条件（如您可能看到的）检查是否满足某个条件，然后中断程序的流程。它们非常适合您真正只对`if`陈述的一个结果感兴趣的地方。所以与其说：

```
if (something) {
    // a lot of indented code
} 
```

如果满足反转条件，则反转条件并中断

```
if (!something) return false; // or another value to show your other code the function did not execute

// all the code from before, save a lot of tabs 
```

`return`远不如`goto`. 它允许您传递一个值以显示该函数无法运行的其余代码。

您将看到可以在嵌套条件中应用的最佳示例：

```
if (something) {
    do-something();
    if (something-else) {
        do-another-thing();
    } else {
        do-something-else();
    }
} 
```

与：

```
if (!something) return;
do-something();

if (!something-else) return do-something-else();
do-another-thing(); 
```

你会发现很少有人认为第一个更干净，但当然，这完全是主观的。一些程序员喜欢通过缩进来知道某些东西在什么条件下运行，而我更愿意保持方法流是线性的。

我暂时不会建议 precons 会改变你的生活或让你安顿下来，但你可能会发现你的代码更容易阅读。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2011-12-08T20:54:24.147

在性能方面，这两种方法之间不会有明显的区别。

但编码不仅仅是性能。清晰度和可维护性也非常重要。而且，在这种不影响性能的情况下，这是唯一重要的事情。

关于哪种方法更可取，存在相互竞争的思想流派。

一种观点是其他人提到的观点：第二种方法降低了嵌套级别，从而提高了代码清晰度。这在命令式风格中很自然：当你无事可做时，你不妨早点回来。

从更实用的风格的角度来看，另一种观点是方法应该只有一个退出点。函数式语言中的一切都是表达式。所以 if 语句必须总是有一个 else 子句。否则 if 表达式不会总是有值。所以在功能风格上，第一种做法更自然。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2008-11-06T10:27:57.083

这里有几个优点，但如果方法很长，多个返回点*也可能不可读。*话虽如此，如果您要使用多个返回点，只需确保您的方法简短，否则可能会失去多个返回点的可读性奖励。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2011-12-08T21:29:15.103

性能分为两部分。当软件在生产中时你有性能，但你也希望在开发和调试时也有性能。开发人员想要的最后一件事是“等待”一些琐碎的事情。最后，在启用优化的情况下编译它会产生类似的代码。所以很高兴知道这些在这两种情况下都能奏效的小技巧。

问题中的情况很清楚，ReSharper 是正确的。您不是在代码中嵌套`if`语句和创建新范围，而是在方法的开头设置一个明确的规则。它增加了可读性，更容易维护，并且减少了人们必须筛选以找到他们想要去的地方的规则数量。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2008-11-07T07:43:25.123

我个人更喜欢只有 1 个出口点。如果你的方法简明扼要，这很容易完成，并且它为下一个处理你的代码的人提供了一个可预测的模式。

例如。

```
 bool PerformDefaultOperation()
 {
      bool succeeded = false;

      DataStructure defaultParameters;
      if ((defaultParameters = this.GetApplicationDefaults()) != null)
      {
           succeeded = this.DoSomething(defaultParameters);
      }

      return succeeded;
 } 
```

如果您只想在函数退出之前检查函数中某些局部变量的值，这也非常有用。您需要做的就是在最终返回上放置一个断点，并且保证您会命中它（除非抛出异常）。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2008-11-06T11:11:38.057

*关于代码外观的*许多充分理由。但是*结果*呢？

让我们看一下一些 C# 代码及其 IL 编译形式：

```
using System;

public class Test {
    public static void Main(string[] args) {
        if (args.Length == 0) return;
        if ((args.Length+2)/3 == 5) return;
        Console.WriteLine("hey!!!");
    }
} 
```

这个简单的片段可以编译。您可以打开生成的`.exe`文件`ildasm`并检查结果。我不会发布所有的汇编程序，但我会描述结果。

生成的 IL 代码执行以下操作：

1.  如果第一个条件是`false`，则跳转到第二个条件所在的代码。
2.  如果它`true`跳转到最后一条指令。（注意：最后一条指令是返回）。
3.  在第二种情况下，计算结果后也会发生同样的情况。比较和：到达`Console.WriteLine`if`false`或到 end if this is `true`。
4.  打印消息并返回。

所以看起来代码会跳到最后。如果我们用嵌套代码做一个普通的 if 怎么办？

```
using System;

public class Test {
    public static void Main(string[] args) {
        if (args.Length != 0 && (args.Length+2)/3 != 5) 
        {
            Console.WriteLine("hey!!!");
        }
    }
} 
```

IL 指令中的结果非常相似。不同的是之前每个条件有两次跳转：如果`false`转到下一段代码，如果`true`转到最后。现在 IL 代码更好地流动并且有 3 次跳转（编译器对此做了一点优化）：

1.  第一次跳转：当Length为0时，代码再次跳转（第三次跳转）到最后的部分。
2.  第二：在第二个条件中间避免一条指令。
3.  第三：如果第二个条件是`false`，跳到最后。

无论如何，程序计数器会一直跳。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2011-12-14T17:33:13.287

避免多个退出点**可以**带来性能提升。我不确定 C#，但在 C++ 中，命名返回值优化（复制省略，ISO C++ '03 12.8/15）取决于有一个退出点。这种优化避免了复制构造您的返回值（在您的具体示例中无关紧要）。这可能会在紧密循环中显着提高性能，因为每次调用函数时都会保存构造函数和析构函数。

但是对于 99% 的情况，保存额外的构造函数和析构函数调用不值得损失嵌套`if`块的可读性（正如其他人指出的那样）。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2011-12-24T12:39:35.773

`if`从理论上讲，如果提高分支预测命中率，反转可能会带来更好的性能。在实践中，我认为很难准确地知道分支预测的行为，尤其是在编译之后，所以我不会在日常开发中这样做，除非我正在编写汇编代码。

更多关于分支预测[的信息](http://en.wikipedia.org/wiki/Branch_predictor)。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-11-06T09:59:27.143

这简直是​​有争议的。在提前返回的问题上，没有“程序员之间的共识”。据我所知，这总是主观的。

可以进行性能论证，因为最好将条件写成这样，以便它们通常是正确的；也可以说它更清楚。另一方面，它确实创建了嵌套测试。

我不认为你会得到这个问题的决定性答案。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2011-06-14T11:41:48.900

那里已经有很多有见地的答案，但是，我仍然会针对稍微不同的情况：而不是先决条件，它应该放在函数之上，考虑一步一步的初始化，在那里你必须检查每个步骤是否成功，然后继续下一步。在这种情况下，您无法检查顶部的所有内容。

当我使用 Steinberg 的 ASIOSDK 编写 ASIO 主机应用程序时，我发现我的代码真的不可读，因为我遵循了嵌套范例。正如上面 Andrew Bullock 所提到的，它有八层深，我看不出那里有设计缺陷。当然，我可以将一些内部代码打包到另一个函数中，然后将剩余的级别嵌套在那里以使其更具可读性，但这对我来说似乎相当随机。

通过用保护子句替换嵌套，我什至发现了我对清理代码的一部分的误解，该部分应该在函数中更早发生而不是在末尾发生。使用嵌套分支，我永远不会看到，你甚至可以说它们导致了我的误解。

所以这可能是另一种情况，倒置的 if 可以有助于更清晰的代码。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-11-06T10:00:17.453

这是一个见仁见智的问题。

我的正常方法是避免单行 ifs，并在方法中间返回。

您不希望在您的方法中随处可见这样的行，但是要检查方法顶部的一堆假设，并且只有在它们都通过时才进行实际工作。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-11-06T11:05:49.753

在我看来，如果你只是返回 void （或者一些你永远不会检查的无用返回代码），那么提前返回是好的，它可能会提高可读性，因为你避免了嵌套，同时你明确表示你的函数已经完成。

如果您实际上正在返回 returnValue - 嵌套通常是一种更好的方法，因为您只在一个地方（最后 - duh）返回您的 returnValue，并且它可能使您的代码在很多情况下更易于维护。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-05-21T19:20:47.550

我不确定，但我认为，R# 试图避免跳远。当您有 IF-ELSE 时，编译器会执行以下操作：

条件为假 -> 远跳转到 false_condition_label

true_condition_label：指令1 ...指令n

false_condition_label：指令1 ...指令n

结束块

如果条件为真，则没有跳转，也没有转出 L1 缓存，但跳转到 false_condition_label 可能很远，处理器必须转出自己的缓存。同步缓存是昂贵的。R# 尝试将远跳转替换为短跳转，在这种情况下，所有指令都已在缓存中的可能性更大。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-11-06T10:03:22.907

我认为这取决于您喜欢什么，如前所述，没有普遍的协议 afaik。为了减少烦恼，您可以将这种警告减少为“提示”

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-11-06T10:09:52.377

我的想法是“在函数中间”的返回不应该那么“主观”。原因很简单，拿这段代码：

```
    函数do_something（数据）{

      如果（！is_valid_data（数据））
            返回假；

       do_something_that_take_an_hour（数据）；

       istance = new object_with_very_painful_constructor(data);

          if ( istance 无效) {
               错误信息（ ）;
                返回 ;

          }
       连接到数据库（）；
       get_some_other_data();
       返回;
    }

```

也许第一次“回归”它不是那么直观，但这真的很省钱。关于干净代码的“想法”太多了，只是需要更多的练习才能摆脱他们“主观”的坏想法。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-11-06T10:41:21.723

这种编码有几个优点，但对我来说最大的胜利是，如果你能快速返回，你可以提高应用程序的速度。IE 我知道，由于前提条件 X，我可以快速返回错误。这首先消除了错误情况并降低了代码的复杂性。在很多情况下，因为 cpu 管道现在可以更干净，它可以阻止管道崩溃或切换。其次，如果您处于循环中，快速中断或返回可以为您节省大量 cpu。一些程序员使用循环不变量来执行这种快速退出，但在这种情况下，您可能会破坏您的 cpu 管道，甚至会产生内存查找问题，这意味着 cpu 需要从外部缓存加载。但基本上我认为你应该做你想做的，也就是说，结束循环或函数不会创建复杂的代码路径，只是为了实现一些正确代码的抽象概念。如果您拥有的唯一工具是锤子，那么一切看起来都像钉子。

# asp.net-mvc - IIS 中使用 WIX 的通配符应用程序映射

> ID：268146
> 
> 赞同：9
> 
> 时间：2008-11-06T09:59:29.077
> 
> 标签：asp.net-mvc, iis, wix

是否可以从 wix 安装程序包中在 IIS6 中添加通配符应用程序映射？我知道如何添加[应用程序扩展](https://stackoverflow.com/questions/163531/set-aspnet-version-using-wix)，但是看不到任何添加通配符的方法。

这是 ASP.Net MVC 正常运行所必需的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-20T18:25:05.097

找到了答案。您使用**WebApplicationExtension**（在 WixIisExtension 中找到），而不指定 Extension 属性。这是 ASP.NET 2.0 的通配符映射：

```
<iis:WebApplicationExtension CheckPath="no"
         Script="yes"
         Executable="[FRAMEWORKROOT]v2.0.50727\aspnet_isapi.dll"
         Verbs="GET,HEAD,POST"/> 
```

# exchange-server - 访问资源日历中的原始会议主题

> ID：268152
> 
> 赞同：2
> 
> 时间：2008-11-06T10:00:48.590
> 
> 标签：exchange-server, exchangewebservices

我正在尝试设置一个系统，该系统使用 Exchange 2007 和 EWS（Exchange Web 服务）在网页上显示资源日历中的日历项目。

我已经设法访问资源的日历，但是在获取日历中的项目时，每个日历项目的主题不是有人创建会议请求并邀请资源时使用的原始主题，而是用户名在创建会议请求的帐户上，例如。如果我做类似的事情：

```
List<CalendarItemType> items = 
    Calendar.GetCalendarItems("mr1@litwareinc.com", 
                              Calendar.GetNextWeekView(), 
                              binding);
if (items.Count > 0)
{
    Console.WriteLine(string.Format("Calendar opened - fetched {0} items",
                                    items.Count));
    Console.WriteLine("===================================");
    foreach (var item in items)
    {
        Console.WriteLine();
        Console.WriteLine(item.Subject);
        Console.WriteLine("----------------------------------------");
        Console.WriteLine("\tOrganizer: " + item.Organizer.Item.Name);
        Console.WriteLine();
        Console.WriteLine("\tStart:     " + item.Start.ToString("dd-MM-yyyy HH:mm"));
        Console.WriteLine("\tSlut:      " + item.Start.ToString("dd-MM-yyyy HH:mm"));
    }
} 
```

其中 Calendar.GetCalendarItems 是一个获取第一个参数表示的资源的日历项的方法，Calendar.GetNextWeekView() 是一个静态方法，它创建一个从今天开始跨越下一周的 CalendarView，并设置了绑定使用对资源邮箱具有委托访问权限的帐户。

如果使用`item.Subject`管理员帐户预订资源，则显示为管理员。

有谁知道如何解决这个问题 - 我是否需要进行某种特殊的财产访问，或者获取另一种类型的物品或什么？

问候杰斯珀豪格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T11:06:45.617

想通了这个 - 当我开始在代码之外寻找时。

答案在于资源配置而不是访问代码。

如果您想让会议的主题反映原始主题。确保资源已将设置属性设置`DeleteSubject`为`AddOrganizerToSubject`false。可以使用以下 shell 命令来实现：

```
Set-MailboxCalendarSettings resourcename -DeleteSubject 0 -AddOrganizerToSubject 0 
```

问候杰斯珀豪格

# multithreading - 多线程读写一个 ::stl::vector，vector 资源难以释放

> ID：268153
> 
> 赞同：3
> 
> 时间：2008-11-06T10:00:55.890
> 
> 标签：multithreading, stl

我正在使用它的 STL 在 VS2005 中编写代码。我有一个 UI 线程来读取向量，还有一个工作线程来写入向量。我使用 ::boost::shared_ptr 作为向量元素。

```
vector<shared_ptr<Class>> vec; 
```

但我发现，如果我同时在两个线程中操作 vec（我可以保证它们不会访问同一个区域，UI 线程总是读取有信息的区域）

vec.clear() 似乎无法释放资源。shared_ptr 中发生问题，它无法释放其资源。

问题是什么？这样做是因为当向量达到其订单容量时，它会在内存中重新分配，然后原始部分无效。

据我所知，在重新分配时，迭代器将无效，为什么我在使用 vec[i] 时也会出现一些问题。//------------------------------------------------

需要什么样的锁？我的意思是：如果向量的元素是shared_ptr，当一个线程A得到smart_p点时，另一个线程B会等到A完成smart_p上的操作，对吧？或者只是简单地在线程试图读取该点时添加锁，当读取操作完成时，线程B可以继续做一些事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T10:10:02.970

当您从多个线程访问同一资源时，锁定是必要的。如果你不这样做，你就会有各种奇怪的行为，就像你看到的那样。

由于您使用的是 Boost，因此使用锁定的一种简单方法是使用 Boost.Thread 库。在这种情况下，您可以使用的最好的锁是读/写锁；它们[`shared_mutex`](http://www.boost.org/doc/libs/1_37_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.shared_mutex)在 Boost.Thread 中被调用。

但是，是的，由于线程之间缺乏同步，您所看到的本质上是未定义的行为。希望这可以帮助！

编辑以回答 OP 的第二个问题：从向量中读取智能指针时应使用读取器锁，在向向量写入或添加项目时应使用写入器锁（因此，互斥锁仅用于向量）。如果多个线程将访问*指向的*对象（即智能指针指向的对象），那么应该为它们设置单独的锁。在这种情况下，最好将互斥对象也放入对象类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T19:34:23.643

另一种选择是通过确保仅在一个线程中访问向量来完全消除锁定。例如，通过让工作线程向主线程发送一条消息，其中包含要添加到向量的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T22:26:43.153

可以同时访问这样的列表或数组。但是， std::vector 不是一个好的选择，因为它具有调整大小的行为。要做到这一点，需要一个固定大小的数组，或者调整大小时的特殊锁定或复制更新行为。它还需要具有锁定或原子更新的独立前后指针。

另一个答案提到了消息队列。正如我所描述的，共享数组是实现这些的一种常见且有效的方法。

# c# - 如何在 .NET 中从 Excel 创建 XML 文件？

> ID：268164
> 
> 赞同：3
> 
> 时间：2008-11-06T10:04:44.293
> 
> 标签：c#

我想通过 .NET (c#) 从我的 Excel 文件创建 XML 文件。我的数据在 Excel 中，它将被添加到 XML 文件中。

谢谢。马诺伊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T10:14:05.880

[CodeProject 中](http://www.codeproject.com/KB/office/excel2xml.aspx)有一篇关于它的好文章。通常答案是，Excel 可以用作数据提供者。稍后，当你把数据取出来时，你可以使用 XMLDom 生成 XML 文件

# asp.net - ASP.NET 用户控件 - 无法将客户端 (JavaScript) 更改的值重新控制

> ID：268180
> 
> 赞同：1
> 
> 时间：2008-11-06T10:10:10.693
> 
> 标签：asp.net, user-controls, postback

好的，伙计们，这是我的问题：

我构建了一个自定义控件，它使用文本框向用户呈现数据。

当用户与控件交互时，**该文本框的值会使用客户端 javascript 进行更改**。

我的页面上也有一个按钮。当用户单击按钮时，我想从自定义控件（又名文本框）中获取值并在其他地方使用它。

因此，在按钮的 onClick 事件中，我执行以下操作：

```
this.myLabel.Text = this.customControl.Value; 
```

问题是自定义控件没有可用的新文本框值。在自定义控件中，文本框为空。但是，我可以在 Request.Form 集合中看到正确的值。

我在这里做错了吗？还是我应该从 Request.Form 中阅读？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T22:56:45.997

有趣的是，我没有意识到只读 TextBox 不会从视图状态更新。

当我在我的网站中使用类似的特技时，我通常会设置 asp:HiddenFields，我使用 javascript 将数据转储到其中（一定要喜欢 jQuery），并且我从回发中读取值。

让我发现的东西更干净。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T11:02:11.883

啊哈！我已经解决了我自己的问题！

因为我在文本框控件上设置了 Readonly="True"，所以 ASP.NET 没有从回发中获取它的值。

相反，我应该在我的用户控件构造过程中手动将 readonly 属性添加到文本框。

例如。

```
this.textBox.Attributes.Add("readonly", "readonly"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T15:12:08.140

奇怪你自己回答了！事实上，我以前也遇到过这种麻烦，并且花了我一些时间，直到我在 Visual Studio 文档中找到了一个说明原因的注释，你可以在这里阅读它[http://msdn.microsoft.com/en-us/library /system.web.ui.webcontrols.textbox.readonly.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.readonly.aspx)在“重要说明”部分。

# sql-server - 动态 SQL 有哪些危险，可以避免吗？

> ID：268182
> 
> 赞同：4
> 
> 时间：2008-11-06T10:10:26.713
> 
> 标签：sql-server, sql-injection, dynamic-sql

我们刚刚获得了以下代码，作为离岸开发人员提供的新应用程序中复杂搜索查询的解决方案。我对动态 SQL 的使用持怀疑态度，因为我可以使用 '; 关闭 SQL 语句。然后执行一个将在数据库上执行的讨厌的操作！

关于如何修复注入攻击的任何想法？

```
ALTER procedure [dbo].[SearchVenues] --'','',10,1,1,''
@selectedFeature as varchar(MAX),
@searchStr as varchar(100),
@pageCount as int,
@startIndex as int,
@searchId as int,
@venueName as varchar(100),
@range int,
@latitude varchar(100),
@longitude varchar(100),
@showAll int,
@OrderBy varchar(50),
@SearchOrder varchar(10)

AS
DECLARE @sqlRowNum as varchar(max)
DECLARE @sqlRowNumWhere as varchar(max) 
DECLARE @withFunction as varchar(max)
DECLARE @withFunction1 as varchar(max)
DECLARE @endIndex as int
SET  @endIndex = @startIndex + @pageCount -1

SET @sqlRowNum = ' SELECT Row_Number() OVER (ORDER BY '

IF @OrderBy = 'Distance'
    SET @sqlRowNum =  @sqlRowNum  + 'dbo.GeocodeDistanceMiles(Latitude,Longitude,' + @latitude + ',' + @longitude + ') ' +@SearchOrder
ELSE
    SET @sqlRowNum =  @sqlRowNum + @OrderBy + ' '+ @SearchOrder

SET @sqlRowNum = @sqlRowNum + ' ) AS RowNumber,ID,RecordId,EliteStatus,Name,Description,
Address,TotalReviews,AverageFacilityRating,AverageServiceRating,Address1,Address2,Address3,Address4,Address5,Address6,PhoneNumber,
visitCount,referalCount,requestCount,imgUrl,Latitude,Longitude,
Convert(decimal(10,2),dbo.GeocodeDistanceMiles(Latitude,Longitude,' + @latitude + ',' + @longitude + ')) as distance
FROM VenueAllData '

SET @sqlRowNumWhere = 'where Enabled=1 and EliteStatus <> 3 ' 

--PRINT('@sqlRowNum ='+@sqlRowNum)
IF  @searchStr <> ''
BEGIN

    IF (@searchId = 1)    -- county search
    BEGIN
       SET @sqlRowNumWhere  = @sqlRowNumWhere +  ' and Address5 like ''' + @searchStr + '%'''
    END
    ELSE IF(@searchId = 2  ) -- Town search
    BEGIN
       SET @sqlRowNumWhere  = @sqlRowNumWhere +  ' and Address4 like ''' + @searchStr + '%'''
    END  
    ELSE IF(@searchId = 3  ) -- postcode search
    BEGIN
       SET @sqlRowNumWhere  = @sqlRowNumWhere +  ' and Address6 like ''' + @searchStr + '%'''
    END    

    IF (@searchId = 4)   -- Search By Name
    BEGIN
        IF @venueName <> ''
            SET @sqlRowNumWhere  = @sqlRowNumWhere +  ' and ( Name like ''%' + @venueName + '%'' OR Address like ''%'+ @venueName+'%'' ) '
        ELSE
            SET @sqlRowNumWhere  = @sqlRowNumWhere +  ' and  ( Name like ''%' + @searchStr + '%'' OR Address like ''%'+ @searchStr+'%'' ) '
    END
END

IF @venueName <> '' AND @searchId <> 4
    SET @sqlRowNumWhere  = @sqlRowNumWhere +  ' and ( Name like ''%' + @venueName + '%'' OR  Address like ''%'+ @venueName+'%'' ) '

set @sqlRowNum = @sqlRowNum +  ' '   + @sqlRowNumWhere 

--PRINT(@sqlRowNum)

IF @selectedFeature <> ''
    BEGIN
        DECLARE @val1 varchar (255)
        Declare @SQLAttributes varchar(max)
        Set @SQLAttributes = ''
        Declare @tempAttribute varchar(max)
        Declare @AttrId int
        while (@selectedFeature <> '')
            BEGIN
                SET @AttrId = CAST(SUBSTRING(@selectedFeature,1,CHARINDEX(',',@selectedFeature)-1) AS Int)
                Select @tempAttribute = ColumnName from Attribute where id = @AttrId
                SET @selectedFeature = SUBSTRING(@selectedFeature,len(@AttrId)+2,len(@selectedFeature))
                SET @SQLAttributes = @SQLAttributes + ' ' + @tempAttribute + ' = 1 And '
            END
        Set @SQLAttributes = SUBSTRING(@SQLAttributes,0,LEN(@SQLAttributes)-3)
        set @sqlRowNum = @sqlRowNum +  ' and ID in  (Select VenueId from '
        set @sqlRowNum = @sqlRowNum +  ' CachedVenueAttributes WHERE ' + @SQLAttributes + ')  '

    END

IF @showAll <> 1
    set @sqlRowNum = @sqlRowNum +  ' and  dbo.GeocodeDistanceMiles(Latitude,Longitude,' + @latitude + ',' + @longitude + ')   <=  ' +  convert(varchar,@range )

set @withFunction = 'WITH LogEntries AS (' + @sqlRowNum +  ')

SELECT * FROM  LogEntries WHERE RowNumber between '+ Convert(varchar,@startIndex) + 
' and ' + Convert(varchar,@endIndex) + ' ORDER BY ' + @OrderBy + ' ' + @SearchOrder

print(@withFunction)
exec(@withFunction) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T10:16:29.400

顺便说一句，我不会使用`EXEC`; 而是我会使用`sp_executesql`. 有关使用动态 sql 的原因和其他信息，请参阅这篇精彩的文章，[动态 SQL 的诅咒和祝福。](http://www.sommarskog.se/dynamic_sql.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T10:12:19.847

看到这个[答案](https://stackoverflow.com/questions/1973/what-is-the-best-way-to-avoid-sql-injection-attacks)。

此外，这些：

[如果我使用存储过程，我对 SQL 注入免疫吗？](https://stackoverflow.com/questions/239905/am-i-immune-to-sql-injections-if-i-use-stored-procedures)

[使用参数使用 Like 运算符避免 SQL 查询中的 SQL 注入？](https://stackoverflow.com/questions/228476/avoiding-sql-injection-in-sql-query-with-like-operator-using-parameters)

[我可以通过转义单引号和用单引号包围用户输入来防止 SQL 注入吗？](https://stackoverflow.com/questions/139199/can-i-protect-against-sql-injection-by-escaping-single-quote-and-surrounding-us)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T11:39:29.967

这是上面查询的优化版本，不使用动态 SQL...

```
Declare @selectedFeature as varchar(MAX),
@searchStr as varchar(100),
@pageCount as int,
@startIndex as int,
@searchId as int,
@venueName as varchar(100),
@range int,
@latitude varchar(100),
@longitude varchar(100),
@showAll int,
@OrderBy varchar(50),
@SearchOrder varchar(10)

Set @startIndex = 1
Set @pageCount = 50

Set @searchStr = 'e'
Set @searchId = 4
Set @OrderBy = 'Address1'
Set @showAll = 1
--Select dbo.GeocodeDistanceMiles(Latitude,Longitude,@latitude,@longitude)

DECLARE @endIndex int
SET  @endIndex = @startIndex + @pageCount -1
;

WITH LogEntries as (
SELECT 
    Row_Number() 
        OVER (ORDER BY 
            CASE @OrderBy
               WHEN 'Distance' THEN Cast(dbo.GeocodeDistanceMiles(Latitude,Longitude,@latitude,@longitude) as varchar(10))
               WHEN 'Name' THEN Name
               WHEN 'Address1' THEN Address1
               WHEN 'RecordId' THEN Cast(RecordId as varchar(10))
               WHEN 'EliteStatus' THEN Cast(EliteStatus as varchar(10))
            END) AS RowNumber,
RecordId,EliteStatus,Name,Description,
Address,TotalReviews,AverageFacilityRating,AverageServiceRating,Address1,Address2,Address3,Address4,Address5,Address6,PhoneNumber,
visitCount,referalCount,requestCount,imgUrl,Latitude,Longitude,
Convert(decimal(10,2),dbo.GeocodeDistanceMiles(Latitude,Longitude,@latitude,@longitude)) as distance
FROM VenueAllData 
where Enabled=1 and EliteStatus <> 3
And 
    (
        (Address5 like @searchStr + '%' And @searchId = 1) OR
        (Address4 like @searchStr + '%' And @searchId = 2) OR
        (Address6 like @searchStr + '%' And @searchId = 3) OR
        (
            (
                @searchId = 4 And 
                    (Name like '%' + @venueName + '%' OR Address like '%'+ @searchStr+'%')
            )
        )
    )
And
    ID in (
        Select VenueID 
        From CachedVenueAttributes 
        --Extra Where Clause for the processing of VenueAttributes using @selectedFeature
    )
And
    (   
        (@showAll = 1) Or
        (@showAll <> 1 and dbo.GeocodeDistanceMiles(Latitude,Longitude,@latitude,@longitude) <= convert(varchar,@range )) 
    )
)

SELECT * FROM  LogEntries 
WHERE RowNumber between @startIndex and @endIndex 
ORDER BY CASE @OrderBy
               WHEN 'Distance' THEN Cast(Distance as varchar(10))
               WHEN 'Name' THEN Name
               WHEN 'Address1' THEN Address1
               WHEN 'RecordId' THEN Cast(RecordId as varchar(10))
               WHEN 'EliteStatus' THEN Cast(EliteStatus as varchar(10))
            END 
```

我唯一没有修复的是来自 CachedVenueAttributes 的选择，它似乎在循环中建立了 where 语句。我想我可以把它放在一个表值函数中，并将它独立地重构到过程的其余部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T12:16:18.113

我喜欢用于搜索的动态 SQL。

在我过去使用它的地方，我使用了 .Net 准备好的语句，其中任何用户生成的字符串作为参数传入，而不是作为文本包含在 SQL 中。

要使用现有解决方案运行，您可以做很多事情来降低风险。

1.  白名单输入，验证输入，使其只能包含 a-zA-Z0-9\w （字母数字和空格）（如果您需要支持 unicode 字符则不好）
2.  以受限用户身份执行任何动态 sql。将存储过程的所有者设置为仅对相关表具有读取权限的用户。拒绝写入所有表等。此外，在调用此存储过程时，您可能需要对他们可以执行的操作具有类似限制的用户执行此操作，因为它看起来 MS-SQL 在存储过程中执行动态 sql 作为调用用户而不是存储过程的所有者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-19T19:46:27.520

我意识到这是一个非常古老的帖子，但是在执行以下操作时：

```
 AND
    (   
        (@showAll = 1) 
        OR (@showAll <> 1 
            AND dbo.GeocodeDistanceMiles(Latitude,Longitude,@latitude,@longitude) <= convert(varchar,@range)) 
    ) 
```

... an`OPTION(RECOMPILE)`通常会帮助选择一个更简洁的计划，只要它不会每秒执行一千次或其他任何东西。

# vb.net - 奇怪的 nUnit 单元测试失败

> ID：268184
> 
> 赞同：0
> 
> 时间：2008-11-06T10:10:38.600
> 
> 标签：vb.net, unit-testing, nunit

我有classX：

Sub New(ByVal item_line_no As String, ByVal item_text As String)

```
 ' check to ensure that the parameters do not exceed the file template limits
    Select Case item_line_no.Length
        Case Is > m_item_line_no_capacity
            Throw New ArgumentOutOfRangeException(item_line_no, "Line No exceeds 4 characters")
        Case Else
            Me.m_item_line_no = item_line_no
    End Select

    Select Case item_text.Length
        Case Is > m_item_free_text_capacity
            Throw New ArgumentOutOfRangeException("Free Text Exceeds 130 characters")
        Case Else
            Me.m_item_free_text = item_text
    End Select

End Sub 
```

和下面的unti来测试一个故障点

```
<ExpectedException(GetType(ArgumentOutOfRangeException), "Line No exceeds 4 characters")> _
<Test()> _
Sub testLineNoExceedsMaxLength()
    Dim it As New X("aaaaa", "Test")

End Sub 
```

当我运行测试时，我希望收到异常“行号超过 4 个字符”中引发的消息

但是单元测试失败并显示以下消息

```
RecordTests.testLineNoExceedsMaxLength : FailedExpected exception message: Line No exceeds 4 characters
                       got: Line No exceeds 4 characters
Parameter name: aaaaa 
```

我认为这很简单，但它让我发疯。

注意：在 ExpectedException 的声明中，我收到一个过时的警告，指出而不是

```
<ExpectedException(GetType(ArgumentOutOfRangeException), "Line No exceeds 4 characters")> 
```

它应该是

```
<ExpectedException(GetType(ArgumentOutOfRangeException), ExpectedException="Line No exceeds 4 characters")> 
```

但是，这会引发 ExpectedException is not declared 错误！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T11:09:49.323

行。运行这个。

异常的消息是：

> **行号超过 4 个字符**
> 
> **参数名称：aaaa**

（包括换行符）

您需要将所有这些指定为预期的消息：

```
<ExpectedException(GetType(ArgumentOutOfRangeException), ExpectedMessage="Line No exceeds 4 characters" & VbCrLf & "Parameter name: aaaaa")> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T10:51:48.160

~~已`ExpectedExceptionAttribute`弃用 - 即您根本不应该使用它。我能很快找到的最好的参考是这篇文章（原始文章在这里）。~~

如果重新编写，您的单元测试会更加清晰：

```
<Test()> _
Sub testLineNoExceedsMaxLength()
    Try

        Dim it As New X("aaaaa", "Test")

    Catch ex as ArgumentOutOfRangeExcpetion

        Assert.That ( ex.Message, Is.Equal("Line No exceeds 4 characters") )

    End Try

End Sub 
```

另见这些文章

*   [这个](http://steve.emxsoftware.com/TDD/NUnit+and+the+ExpectedExceptionAttribute)，和
*   [这个](http://web.archive.org/web/20040228223704/http://cgi.skizz.plus.com/blog/dev/archives/000075.html "为返航机赞美上帝")。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T11:01:59.807

我不确定我是否同意您对不推荐使用 ExpectedException 属性的评论。

它在 2.4（我正在使用的版本）中仍然得到很好的支持，在这种情况下是 ExpectedMessage 导致了弃用问题

[uUnit 异常指南](http://www.nunit.org/index.php?p=exception&r=2.4)

# c# - 如何在 Silverlight 中创建数字文本框？

> ID：268207
> 
> 赞同：12
> 
> 时间：2008-11-06T10:19:39.630
> 
> 标签：c#, .net, silverlight, textbox, silverlight-2.0

正如标题所说的那样。我看过从 TextBox 继承，但唯一合理的覆盖是“OnKeyDown”，但这只是给了我来自 Key 枚举的键（无法使用 Char.IsNumeric()）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-11-04T15:25:00.433

我接受了 Nidhal 建议的答案并对其进行了一些编辑，以处理数字上方字符的移位情况（即！@#$%^&*()），因为该解决方案仍将允许文本框中的这些字符。

```
private void NumClient_KeyDown(object sender, KeyEventArgs e)
{       
    // Handle Shift case
    if (Keyboard.Modifiers == ModifierKeys.Shift)
    {
       e.Handled = true;
    }

    // Handle all other cases
    if (!e.Handled && (e.Key < Key.D0 || e.Key > Key.D9))
    {
        if (e.Key < Key.NumPad0 || e.Key > Key.NumPad9)
        {
            if (e.Key != Key.Back)
            {
                e.Handled = true;
            }
        }
    }           
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-12-05T13:03:28.973

访问[http://www.dataartist.net/blog/post/Silverlight-Behavior-Modifications-13-NumericOnlyBehavior.aspx](http://www.dataartist.net/blog/post/Silverlight-Behavior-Modifications-13-NumericOnlyBehavior.aspx)或使用 TextBox 行为如下

```
 using System;
  using System.Windows;
  using System.Windows.Controls;
  using System.Windows.Input;
  using System.Windows.Interactivity;

  namespace DataArtist
  {
public class NumericOnly : Behavior<TextBox>
{
    private string Text { get; set; }
    private bool shiftKey;
    public bool StripOnExit { get; set; }

    public NumericOnly()
    {
        StripOnExit = false;
    }

    protected override void OnAttached()
    {
        base.OnAttached();
        AssociatedObject.KeyDown += KeyDown;
        AssociatedObject.KeyUp += KeyUp;
        AssociatedObject.GotFocus += GotFocus;
        AssociatedObject.LostFocus += LostFocus;
    }

    void KeyUp(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Shift)
        {
            shiftKey = false;
        }
    }

    void KeyDown(object sender, KeyEventArgs e)
    {
        if (StripOnExit != false || e.Key == Key.Tab || e.Key == Key.Enter)
        {
            return;
        }

        if (e.Key == Key.Shift)
        {
            shiftKey = true;
        }
        else
        {
            if (IsNumericKey(e.Key) == false)
            {
                e.Handled = true;
            }
        }
    }

    void GotFocus(object sender, RoutedEventArgs e)
    {
        Text = AssociatedObject.Text;
    }

    private void LostFocus(object sender, RoutedEventArgs e)
    {
        if (AssociatedObject.Text == Text)
        {
            return;
        }

        string content = string.Empty;

        foreach (var c in AssociatedObject.Text)
        {
            if (Char.IsNumber(c) == true)
            {
                content += c;
            }
        }

        AssociatedObject.Text = content;
    }

    public bool IsNumericKey(Key key)
    {
        if (shiftKey == true)
        {
            return false;
        }

        string code = key.ToString().Replace("NumPad", "D");

        if (code[0] == 'D' && code.Length > 1)
        {
            return (Char.IsNumber(code[1]));
        }

        return false;
    }

    protected override void OnDetaching()
    {
        base.OnDetaching();
        AssociatedObject.KeyDown -= KeyDown;
        AssociatedObject.LostFocus -= LostFocus;
        AssociatedObject.GotFocus -= GotFocus;
    }
}   
    } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-28T09:07:43.477

```
private void Numclient_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key < Key.D0 || e.Key > Key.D9)
    {
        if (e.Key < Key.NumPad0 || e.Key > Key.NumPad9)
        {
            if (e.Key != Key.Back && e.Key != Key.Shift)
            {
                e.Handled = true;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-06T13:36:00.370

[查看工具包http://codeplex.com/Silverlight](http://codeplex.com/Silverlight)中的 NumericUpDown，也许您可​​以使用它或查看源代码来实现您自己的数字文本框。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-23T23:38:31.353

看看这个，它在文本框上使用了一个附加属性。我正在使用它，它确实有效。 [http://weblogs.asp.net/manishdalal/archive/2008/09/24/prevention-the-first-line-of-defense-with-attach-property-pixie-dust.aspx](http://weblogs.asp.net/manishdalal/archive/2008/09/24/prevention-the-first-line-of-defense-with-attach-property-pixie-dust.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-11T08:30:13.703

```
 private void TextBox_KeyDown(object sender, KeyEventArgs e)
    {
        bool isDigit = e.Key >= Key.D0 && e.Key < Key.D9 || e.Key == Key.NumPad0 || e.Key == Key.NumPad1 || e.Key == Key.NumPad2 || e.Key == Key.NumPad3 || e.Key == Key.NumPad4 || e.Key == Key.NumPad5 || e.Key == Key.NumPad6 ||
        e.Key == Key.NumPad7 || e.Key == Key.NumPad8 || e.Key == Key.NumPad9 ||e.Key == Key.Back || e.Key == Key.Delete || e.Key == Key.Left || e.Key == Key.Right;

        if (isDigit) { }
        else
            e.Handled = true; 
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-21T09:03:54.737

有用：

```
static bool AltGrIsPressed;

void Numclient_KeyUp(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Alt)
    {
        AltGrIsPressed = false;
    }
}

void Numclient_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Alt)
    {
        AltGrIsPressed = true;
    }

    if (Keyboard.Modifiers == ModifierKeys.Shift || AltGrIsPressed == true)
    {
        e.Handled = true;
    }

    if (e.Handled == false && (e.Key < Key.D0 || e.Key > Key.D9))
    {
        if (e.Key < Key.NumPad0 || e.Key > Key.NumPad9)
        {
            if (e.Key != Key.Back)
            {
                e.Handled = true;
            }
        }
    }       
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-31T11:43:57.050

```
private void txtbox_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.D0 || e.Key == Key.D1 || e.Key == Key.D2 || e.Key == Key.D3 || e.Key == Key.D4 || e.Key == Key.D5 || e.Key == Key.D6 || e.Key == Key.D7 || e.Key == Key.D8 || e.Key == Key.D9 || e.Key == Key.NumPad0 || e.Key == Key.NumPad1 || e.Key == Key.NumPad2 || e.Key == Key.NumPad3 || e.Key == Key.NumPad4 || e.Key == Key.NumPad5 || e.Key == Key.NumPad6 || e.Key == Key.NumPad7 || e.Key == Key.NumPad8 || e.Key == Key.NumPad9)
        e.Handled = false;
    else
        e.Handled = true;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-06T11:00:19.343

我知道它已被回答，但我发现没有合适的解决方案来处理所有特殊情况，这里的大多数答案都会吞下一些重要的键，比如 Home、End、Tab、Shift+ 任何东西，..等等。

因此，我开发了自己的实现，因为它可能对某人有所帮助！

```
public class IntegerTextBox : TextBox
    {
        /// <summary>
        /// To be raised whenever integer value changed
        /// </summary>
        public event EventHandler ValueChanged;

        /// <summary>
        /// To restore if the user entered invalid characters
        /// </summary>
        private int lastSavedValue = 0;

        private int lastSelectionStart = 0;
        private int lastSelectionLength = 0;

        public int IntegerValue
        {
            get
            {
                //the default value is 0 if there is no text in the textbox
                int value = 0;
                int.TryParse(Text, out value);
                return value;
            }
            set
            {
                if (this.Text.Trim() != value.ToString())
                {
                    Text = value.ToString();
                }
            }
        }

        public IntegerTextBox()
            : base()
        {
            this.LostFocus += (sender, e) =>
                {
                    //if the user clears the text the text box and leaves it, set it to default value
                    if (string.IsNullOrWhiteSpace(this.Text))
                        IntegerValue = 0;
                };
            this.Loaded += (sender, e) =>
                {
                    //populate the textbox with Initial IntegerValue (default = 0)
                    this.Text = this.IntegerValue.ToString();
                };

            this.TextChanged += (sender, e) =>
                {
                    int newValue = 0;
                    if (int.TryParse(this.Text, out newValue)) //this will handle most cases like number exceeds the int max limits, negative numbers, ...etc.
                    {
                        if (string.IsNullOrWhiteSpace(Text) || lastSavedValue != newValue)
                        {
                            lastSavedValue = newValue;
                            //raise the event
                            EventHandler handler = ValueChanged;
                            if (handler != null)
                                handler(this, EventArgs.Empty);

                        }
                    }
                    else 
                    {
                        //restore previous number
                        this.Text = lastSavedValue.ToString();
                        //restore selected text
                        this.SelectionStart = lastSelectionStart;
                        this.SelectionLength = lastSelectionLength;
                    }
                };

            this.KeyDown += (sender, e) =>
                {
                    //before every key press, save selection start and length to handle overwriting selected numbers
                    lastSelectionStart = this.SelectionStart;
                    lastSelectionLength = this.SelectionLength;
                };
        }
    } 
```

上面的代码有一个缺点，TextChanged 事件会频繁引发，但是既然我们需要一个`integer`文本框，那我们就可以依赖了`ValueChanged`！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-01T02:54:36.627

扩展普通 Silverlight 文本框控件。在扩展的 TextBox 类中添加以下代码：

```
string nums = "1234567890";
string lastText = "";
int lastSelStart = 0;

protected override void TextChanged(object sender, TextChangedEventArgs e)
{
    if(!nums.Contains(this.Text.Substring(this.Text.Length -1)))
    {
         this.Text = lastText;
         this.SelectionStart = lastSelStart;
         return;
    }

    lastText = this.Text;
    lastSelStart = this.SelectionStart;

} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2011-11-23T04:21:16.640

为什么每个人都不努力处理所有问题？

这里（这是完美的）：

```
<TextBox KeyDown="TextBox_KeyDown" />

private void TextBox_KeyDown(object sender, KeyEventArgs e)
{
    var _Letter = string.Empty;
    switch (e.Key)
    {
        case Key.A: _Letter = "A"; break;
        case Key.Add: _Letter = "+"; break;
        case Key.Alt: break;
        case Key.B: _Letter = "B"; break;
        case Key.Back: break;
        case Key.C: _Letter = "C"; break;
        case Key.CapsLock: break;
        case Key.Ctrl: break;
        case Key.D: _Letter = "D"; break;
        case Key.D0: _Letter = "0"; break;
        case Key.D1: _Letter = "1"; break;
        case Key.D2: _Letter = "2"; break;
        case Key.D3: _Letter = "3"; break;
        case Key.D4: _Letter = "4"; break;
        case Key.D5: _Letter = "5"; break;
        case Key.D6: _Letter = "6"; break;
        case Key.D7: _Letter = "7"; break;
        case Key.D8: _Letter = "8"; break;
        case Key.D9: _Letter = "9"; break;
        case Key.Decimal: _Letter = "."; break;
        case Key.Delete: break;
        case Key.Divide: _Letter = "/"; break;
        case Key.Down: break;
        case Key.E: _Letter = "E"; break;
        case Key.End: break;
        case Key.Enter: break;
        case Key.Escape: break;
        case Key.F: _Letter = "F"; break;
        case Key.F1: break;
        case Key.F10: break;
        case Key.F11: break;
        case Key.F12: break;
        case Key.F2: break;
        case Key.F3: break;
        case Key.F4: break;
        case Key.F5: break;
        case Key.F6: break;
        case Key.F7: break;
        case Key.F8: break;
        case Key.F9: break;
        case Key.G: _Letter = "G"; break;
        case Key.H: _Letter = "H"; break;
        case Key.Home: break;
        case Key.I: _Letter = "I"; break;
        case Key.Insert: break;
        case Key.J: _Letter = "J"; break;
        case Key.K: _Letter = "K"; break;
        case Key.L: _Letter = "L"; break;
        case Key.Left: break;
        case Key.M: _Letter = "M"; break;
        case Key.Multiply: _Letter = "*"; break;
        case Key.N: _Letter = "N"; break;
        case Key.None: break;
        case Key.NumPad0: _Letter = "0"; break;
        case Key.NumPad1: _Letter = "1"; break;
        case Key.NumPad2: _Letter = "2"; break;
        case Key.NumPad3: _Letter = "3"; break;
        case Key.NumPad4: _Letter = "4"; break;
        case Key.NumPad5: _Letter = "5"; break;
        case Key.NumPad6: _Letter = "6"; break;
        case Key.NumPad7: _Letter = "7"; break;
        case Key.NumPad8: _Letter = "8"; break;
        case Key.NumPad9: _Letter = "9"; break;
        case Key.O: _Letter = "O"; break;
        case Key.P: _Letter = "P"; break;
        case Key.PageDown: break;
        case Key.PageUp: break;
        case Key.Q: _Letter = "Q"; break;
        case Key.R: _Letter = "R"; break;
        case Key.Right: break;
        case Key.S: _Letter = "S"; break;
        case Key.Shift: break;
        case Key.Space: _Letter = " "; break;
        case Key.Subtract: _Letter = "-"; break;
        case Key.T: _Letter = "T"; break;
        case Key.Tab: break;
        case Key.U: _Letter = "U"; break;
        case Key.Unknown: break;
        case Key.Up: break;
        case Key.V: _Letter = "V"; break;
        case Key.W: _Letter = "W"; break;
        case Key.X: _Letter = "X"; break;
        case Key.Y: _Letter = "Y"; break;
        case Key.Z: _Letter = "Z"; break;
        default: break;
    }
    var _Text = (sender as TextBox).Text + _Letter;
    double _Double;
    e.Handled = !double.TryParse(_Text, out _Double);
} 
```

}

# delphi - Delphi - 优雅地关闭服务中创建的进程。（使用 tprocess / createProcess）

> ID：268208
> 
> 赞同：1
> 
> 时间：2008-11-06T10:19:53.340
> 
> 标签：delphi, windows-services, createprocess

我有一个用 Delphi 编写的 Windows 服务，它运行许多程序。

在停止服务时，我还想关闭这些程序。最初编写服务时，它工作得很好，但我想我已经更新了 tProcess 组件，现在 - 下级程序没有被关闭。

在 tProcess - 这是启动新进程的代码。

```
 if CreateProcess( nil , PChar( FProcess.Command ) , nil , nil , False ,
    NORMAL_PRIORITY_CLASS , nil , Directory ,
    StartupInfo , ProcessInfo ) then
    begin
      if FProcess.Wait then
        begin
          WaitForSingleObject( ProcessInfo.hProcess , Infinite );
          GetExitCodeProcess( ProcessInfo.hProcess , ExitCode );
          if Assigned( FProcess.FOnFinished ) then
            FProcess.FOnFinished( FProcess , ExitCode );
        end;
      CloseHandle( ProcessInfo.hProcess );
      CloseHandle( ProcessInfo.hThread );
    end; 
```

此调用的每个可执行文件都是 Windows GUI 程序（顶部有一个关闭按钮）。

当我停止服务时，我还想停止（而不是杀死）我通过 createProcess 过程启动的程序。

你会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T11:10:40.680

我会使用[JVCL的](http://jvcl.sourceforge.net/)**TJvCreateProcess**组件，它以优雅的方式包装了 win32 的任何与进程相关的功能。这个答案来自 Dont-touch-winapi-unless-really-required 部门:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T04:08:55.570

停止进程的唯一通用方法是使用[TerminateProcess](http://msdn.microsoft.com/en-us/library/ms686714.aspx)。但这远非你所能得到的优雅。要优雅地关闭一个进程，您需要告诉该进程您希望它停止，然后希望它服从。不过，一般来说没有办法做到这一点。

对于 GUI 程序，告诉它您希望它停止运行的常用方法是关闭其主窗口。但是，没有“主窗口”的正式概念。一个程序可以有零个或多个窗口，并且无法从外部知道您应该关闭哪个窗口以使程序停止工作。

您可以使用[EnumWindows](http://msdn.microsoft.com/en-us/library/ms633497.aspx)循环浏览所有窗口并选择属于您的进程的窗口。（[GetWindowThreadProcessId](http://msdn.microsoft.com/en-us/library/ms633522.aspx)提供的进程 ID 与 CreateProcess 提供的进程 ID 相同。）

关闭一个窗口可能还不够。该程序可能会显示一个对话框（提示确认，或要求保存更改等）。您需要提前知道如何关闭该对话框。

非 GUI 程序可能有类似的问题。模拟 Ctrl+C 击键可能就足够了。不过，它可能会以不同的方式捕捉和处理该击键。它可能有一个菜单系统，希望您键入“Q”来退出程序。

简而言之，除非您事先知道该程序期望如何关闭，否则您无法优雅地关闭程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T05:00:02.940

您想枚举与您启动的 ProcessId 匹配的打开窗口并告诉这些窗口关闭。这是一些示例代码：

```
uses Windows;

interface   

function MyTerminateAppEnum(hHwnd:HWND; dwData:LPARAM):Boolean; stdcall;

implementation

function MyTerminateAppEnum(hHwnd:HWND; dwData:LPARAM):Boolean; 
var   
  vID:DWORD; 
begin   
  GetWindowThreadProcessID(hHwnd, @vID);   
  if vID = dwData then   
  begin
    PostMessage(hHwnd, WM_CLOSE, 0, 0); //tell window to close gracefully
    Result := False;  //can stop enumerating    
  end   
  else   
  begin
    Result := TRUE;  //keep enumerating until you find your id   
  end; 
end; 
```

然后，当您想关闭已启动的应用程序时，您需要在代码中使用它：

```
Procedure TerminateMe(YourSavedProcessInfo:TProcessInformation);
var
  vExitCode:UINT;
begin
  GetExitCodeProcess(YourSavedProcessInfo.hProcess, vExitCode);
  if (vExitCode = STILL_ACTIVE) then  //launched app still running..
  begin
    //tell it to close
    EnumWindows(@MyTerminateAppEnum, YourSavedProcessInfo.dwProcessId);

    if WaitForSingleObject(YourSavedProcessInfo.hProcess, TIMEOUT_VAL) <> WAIT_OBJECT_0 then
    begin
      if not TerminateProcess(YourSavedProcessInfo.hProcess, 0) then  //didn't close, try to terminate
      begin
         //uh-oh   Didn't close, didn't terminate..
      end;
    end;
  end;
  CloseHandle(YourSavedProcessInfo.hProcess);
  CloseHandle(YourSavedProcessInfo.hThread);
end; 
```

# windows - 如何在 Windows Server 2003 上检测数据包丢失？

> ID：268209
> 
> 赞同：5
> 
> 时间：2008-11-06T10:20:03.183
> 
> 标签：windows, networking

有没有办法在性能计数器的帮助下检测数据包丢失，还是我最好使用 3rd-party 工具？你会推荐什么工具？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-02T13:37:27.380

netstat -s 将显示重传的总数。Wireshark 可以捕获流量并获得“专家信息”（在分析下），它将告诉您有关明显的网络相关错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T00:26:54.723

我们总是发现基于 PCAP 库的工具很有用。特别是 Wireshark ( [www.wireshark.org](http://www.wireshark.org) ) 非常适合获取网络流量跟踪，它会突出显示输出中的数据包丢失等问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T01:51:50.450

您是否正在尝试跟踪由于数据包丢失而重试的 TCP 总次数？如果是这样，那么是的，性能计数器将正常工作。

# .net - 依赖项和引用 - 我到底应该引用什么？

> ID：268214
> 
> 赞同：5
> 
> 时间：2008-11-06T10:21:56.410
> 
> 标签：.net, build, reference

我想知道在构建我的项目时要包括什么。我有一个库需要为我的项目构建参考，但该库本身有 10 个依赖项。我应该也引用这些依赖项，还是应该使用构建后事件将它们复制到输出目录？

最佳做法是什么？

我发现包含所有这些依赖项是令人困惑的，因为项目在没有它们的情况下编译得很好——它们是否被称为运行时依赖项？我的引用变得杂乱无章，与我的项目无关，即使它们在我包含的某些库中使用。

我正在使用 Visual Studio。

有人可以给我一些有关如何正确执行此操作的见解。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T10:27:09.630

这只是意见。无论哪种方式都会奏效。

我个人讨厌构建后的 BAT 文件，因此我会包含依赖项以将它们复制到输出目录。

另一种选择是在您的项目中放置指向它们的链接 - 就像在资源目录中一样。将此设置为 BuildAction=None 和 CopyToOutputDirectory=CopyIfNewer

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T10:28:03.387

我想你在 Visual Studio 中工作。

简短的回答是只包含项目编译所需的程序集。

引用更多的程序集应该不会导致任何问题，因为您的应用程序将在运行时需要时加载程序集，但是拥有一长串引用可能会变得混乱和混乱。

您的参考列表应该说明您的程序做了什么以及它使用了哪些功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-08T04:58:48.723

您只需添加项目直接使用的引用。

对于私有程序集（那些不在 GAC 中的程序集），默认情况下，Visual Studio 会将引用的程序集（及其依赖项）复制到项目的输出目录中。

对于 GAC Visual Studio 中的程序集，默认情况下不会将引用的程序集复制到项目的输出目录中。

在这两种情况下，您都可以通过更改“复制本地”引用属性来更改行为。

恕我直言，这是构建环境的一个绝妙功能。在非托管世界中，您可以跟踪依赖项的依赖项（通常通过构建前或构建后事件）。

# custom-error-pages - 什么是 404;1、404;2 等 HTTP 错误代码？

> ID：268244
> 
> 赞同：16
> 
> 时间：2008-11-06T10:35:35.417
> 
> 标签：custom-error-pages, http-error

在 IIS 中，我可以配置我的自定义错误页面。
对于每个 HTTP 错误代码，我可以说去哪里。几个代码有许多可用的“子”代码。例如 404 有一个常规的 404, 404;1, 404;2 等等..

它们是干什么用的？他们什么时候回来？我应该为这些错误制作自定义页面吗？我可以以某种方式轻松配置所有代码“系列”以访问同一页面吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-06T10:38:49.653

401 - 访问被拒绝。IIS 定义了几个不同的 401 错误，这些错误表明错误**的更具体原因**。这些特定的错误代码会显示在浏览器中，但不会显示在 IIS 日志中：

*   401.1 - 登录失败。
*   401.2 - 由于服务器配置，登录失败。
*   401.3 - 由于 ACL 资源未授权。
*   401.4 - 过滤器授权失败。
*   401.5 - ISAPI/CGI 应用程序授权失败。
*   401.7 – Web 服务器上的 URL 授权策略拒绝访问（此错误代码特定于 IIS 6.0。）

这是[IIS 5.0 和 6.0](http://support.microsoft.com/kb/318380)以及[IIS 7.0、7.5 和 8.0](http://support.microsoft.com/kb/943891)的 MSDN 文档中的**完整列表**。

如果您想根据这些子代码向访问者或用户显示一个很好的自定义消息，您可以这样做。但你不需要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T10:45:57.780

“子状态”错误代码特定于 IIS。它们用于“内部”日志记录目的 - 无论子状态代码是什么，它都是返回给客户端的父错误（404.2 作为 404 被发送回）

它们专门用于减少 IIS 的攻击表面积，同时仍为系统管理员提供大量数据。**因此，您不应该**主动发回特定的子状态错误消息，因为您将打开您的 IIS 安装以受到可能的攻击。

[参考](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/ad20e45c-7771-4039-b6f0-30544474f0da.mspx?mfr=true)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T10:40:24.970

[这篇博客文章](http://blog.crowe.co.nz/archive/2005/08/26/231.aspx)似乎解释了很多。也许它会有所帮助？至少，它解释了“子代码”的含义。

# .net - 为什么要封类？

> ID：268251
> 
> 赞同：105
> 
> 时间：2008-11-06T10:40:48.183
> 
> 标签：.net, performance

我想听听 .Net 框架中大量密封类背后的动机是什么。密封类有什么好处？我无法理解不允许继承是如何有用的，而且很可能不是唯一一个与这些类作斗争的人。

那么，为什么框架会以这种方式设计，而解封所有内容难道不是一项不可改变的改变吗？除了邪恶之外，肯定还有别的原因吗？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-11-06T11:00:03.667

类应该设计为继承或禁止继承。设计继承是有代价的：

*   它可以确定您的实现（您必须声明哪些方法将调用哪些其他方法，以防用户覆​​盖其中一个而不是另一个）
*   它揭示了您的实现，而不仅仅是效果
*   这意味着你在设计时必须考虑更多的可能性
*   像 Equals 这样的东西很难在继承树中设计
*   它需要更多文档
*   子类化的不可变类型可能变为可变（ick）

Effective Java 的第 17 条对此进行了更详细的介绍——不管它是在 Java 的上下文中编写的，该建议也适用于 .NET。

就我个人而言，我希望类在 .NET 中默认是密封的。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-11-06T10:46:32.570

*   有时类太珍贵了，不能被继承。
*   在查找类型时，运行时/反射可以对密封类进行继承假设。一个很好的例子是 - 建议密封属性以提高查找运行时的速度。如果 MyAttribute 被密封，type.GetCustomAttributes(typeof(MyAttribute)) 将执行得更快。

此主题的 MSDN 文章是[通过密封类限制可扩展性](http://msdn.microsoft.com/en-us/library/ms229023(VS.80).aspx)。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-07-02T15:10:25.350

自从大约 9 年前提出这个问题以来，[微软关于密封的官方指南](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/sealing)似乎已经发生了变化，他们从选择加入哲学（默认密封）转变为选择退出（默认不密封）：

> **X 不要**在没有充分理由的情况下密封课程。
> 
> 因为你想不出可扩展性场景而封闭一个类并不是一个好的理由。出于各种不明显的原因，框架用户喜欢从类继承，例如添加便利成员。有关用户希望从类型继承的非显而易见原因的示例，请参阅未密封类。
> 
> 密封类的充分理由包括以下内容：
> 
> *   该类是一个静态类。请参阅静态类设计。
> *   该类将安全敏感的机密存储在继承的受保护成员中。
> *   该类继承了许多虚拟成员，单独密封它们的成本将超过使类不密封的好处。
> *   该类是一个需要非常快速的运行时查找的属性。密封属性的性能水平略高于未密封属性。请参阅属性。
> 
> **X 不要**在密封类型上声明受保护或虚拟成员。
> 
> 根据定义，密封类型不能被继承。这意味着不能调用密封类型上的受保护成员，并且不能覆盖密封类型上的虚拟方法。
> 
> **✓ 考虑**您覆盖的密封构件。引入虚拟成员（在虚拟成员中讨论）可能导致的问题也适用于覆盖，尽管程度略低。从继承层次结构中的那个点开始，密封覆盖可以保护您免受这些问题的影响。

事实上，如果你[搜索 ASP.Net Core 代码库](https://github.com/aspnet/Mvc/search?utf8=%E2%9C%93&q=%22sealed%20class%22&type=)，你只会发现大约 30 个出现的`sealed class`，其中大部分是属性和测试类。

我确实认为不变性守恒是支持密封的一个很好的论据。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T10:47:08.513

我在 msdn 文档中找到了这句话：“密封类主要用于防止派生。因为它们永远不能用作基类，所以一些运行时优化可以使调用密封类成员的速度稍快一些。”

我不知道性能是否是密封类的唯一优势，我个人也想知道任何其他原因......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T11:07:20.373

性能是一个重要因素，例如，java 中的字符串类是 final(<-sealed)，其原因仅仅是性能。我认为另一个重点是避免此处详细描述的脆弱基类问题：http: [//blogs.msdn.com/ericlippert/archive/2004/01/07/virtual-methods-and-brittle-base-classes。 aspx](http://blogs.msdn.com/ericlippert/archive/2004/01/07/virtual-methods-and-brittle-base-classes.aspx)

如果您提供一个框架，那么对于遗留项目的可维护性和升级您的框架以避免脆弱的基类问题很重要

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-10T00:13:51.317

Sealed 用于防止“脆弱的基类问题”。我在 MSDN 中找到了[一篇很好的文章](http://blogs.msdn.com/b/ericlippert/archive/2004/01/07/virtual-methods-and-brittle-base-classes.aspx)来解释这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T15:31:08.360

密封允许您实现一些较小的性能提升。这在 JIT 和惰性悲观化的世界中不如在 C++ 的世界中那么正确，但由于 .NET 不如 Java 编译器的悲观化那么好，主要是因为不同的设计理念，它仍然有用。它告诉编译器它可以直接调用任何虚方法，而不是通过 vtable 间接调用它们。

当您想要一个“封闭世界”来进行平等比较等事情时，这一点也很重要。通常，一旦我定义了一个虚拟方法，我就会非常想定义一个真正实现这个想法的相等比较的概念。另一方面，我也许可以使用虚拟方法为类的特定子类定义它。密封该类可确保平等确实成立。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-04T05:00:59.350

封闭类使管理一次性资源更容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-02-01T10:44:37.853

判断是否封装一个类、方法或属性，一般要考虑以下两点：

• 派生类可能通过自定义类的能力获得的潜在好处。

• 派生类可能会修改您的类，使它们不再正常工作或无法按预期工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-18T09:20:20.550

进一步的考虑是密封类不能在你的单元测试中存根。来自[微软的文档](https://docs.microsoft.com/en-us/visualstudio/test/using-stubs-to-isolate-parts-of-your-application-from-each-other-for-unit-testing#stub-limitations)：

> 密封类或静态方法不能被存根，因为存根类型依赖于虚拟方法分派。对于这种情况，请使用 shim 类型，如使用 shims 将您的应用程序与其他程序集隔离以进行单元测试

# code-reuse - 如何使代码可重用？

> ID：268258
> 
> 赞同：46
> 
> 时间：2008-11-06T10:44:21.560
> 
> 标签：code-reuse

任何代码都可以以某种方式重用，至少在您修改代码时是这样。随机代码本身不是很可重用。当我读一些书时，他们通常说你应该通过考虑其他代码使用情况来明确地使代码可重用。但是某些代码也不应该是一个无所不能的全能类。

我想拥有以后不必更改的可重用代码。如何使代码可重用？代码可重用的要求是什么？可重用代码绝对应该具备哪些东西，哪些东西是可选的？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-06T10:47:46.547

请参阅[编写可重用代码的 10 个技巧以](http://hoskinator.blogspot.com/2006/06/10-tips-on-writing-reusable-code.html)获取帮助。

1.  保持代码干燥。Dry的意思是“不要重复自己”。
2.  让一个类/方法只做一件事。
3.  为您的课程编写单元测试并简化测试课程。
4.  从任何框架代码中删除业务逻辑或主要代码
5.  尝试更抽象地思考并使用接口和抽象类。
6.  扩展代码。编写将来可以轻松扩展的代码。
7.  不要编写不需要的代码。
8.  尽量减少耦合。
9.  更加模块化
10.  编写代码，就像您的代码是外部 API

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-06T10:51:18.630

如果您采用测试驱动开发方法，那么您的代码只能根据即将到来的场景作为重构来重用。

就我个人而言，我发现不断重构会产生更简洁的代码，而不是试图事后猜测我需要为特定类编写代码的场景。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-06T11:30:50.653

最重要的是，可维护性使代码可重用。

可重用性本身很少是一个有价值的目标。相反，它是编写结构良好、易于维护和有用的代码的副产品。

如果您着手编写可重用代码，您经常会发现自己试图考虑未来项目中可能需要的行为要求。无论您在这方面做得多么出色，您都会发现这些面向未来的要求是错误的。

另一方面，如果你从当前项目的裸需求开始，你会发现你的代码可以干净、紧凑、优雅。当您在另一个需要类似功能的项目上工作时，您自然会调整您的原始代码。

我建议查看您选择的编程语言/范式的最佳实践（例如，Java / C# 类型的模式和 SOLID）、精益 / 敏捷编程文献，以及（当然）“代码完整”一书。了解这些方法的优缺点将无休止地改进您的编码实践。然后，您的所有代码都将变得可重用 - 但“偶然”，而不是设计。

另外，请参见此处：[编写可维护的代码](https://stackoverflow.com/questions/162805/writing-maintainable-code)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-06T10:57:23.220

在编写相对较大的项目时，您将编写各种模块（部分）。在实践中可重用代码意味着您将创建需要相同功能的其他项目可以使用的库。

因此，您必须确定可以重用的模块，为此

1.  确定每个模块的核心竞争力。例如，如果您的项目必须压缩文件，您将拥有一个处理文件压缩的​​模块。不要**让它**做超过**一**件事。只有一件事。

2.  编写一个库（或类）来处理文件压缩，除了要压缩的文件、输出和压缩格式之外，不需要任何其他东西。这将使模块与项目的其余部分分离，使其能够在不同的设置中（重新）使用。

3.  您不必在第一次就将其完美，当您实际重用该库时，您可能会发现设计中的缺陷（例如，您没有将其模块化到能够轻松添加新压缩格式的程度）并且您可以第二次修复它们并提高模块的可重用性。您重复使用它（并修复缺陷）的次数越多，它就越容易重复使用。

最要考虑的就是解耦，如果写紧耦合的代码，重用性是第一个牺牲品。

将所有需要的状态或上下文留在库之外。添加方法以指定库的状态。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-06T12:35:11.663

对于“重用”的大多数定义，代码的重用是一个神话，至少在我的经验中是这样。你能说我有一些伤疤吗？:-)

通过重用，我并不是指获取现有的源文件并将它们击败提交，直到新的组件或服务失效。我的意思是采用特定的组件或服务并在不改变的情况下重复使用它。

我认为第一步是让自己进入一种心态，即至少需要 3 次迭代才能创建一个可重用的组件。为什么是3？因为当你第一次尝试重用一个组件时，你总是会发现一些它无法处理的东西。所以你必须改变它。这种情况发生了几次，直到最终您拥有一个至少看起来可重用的组件。

另一种方法是进行昂贵的前瞻性设计。但是成本都是前期的，收益（可能）会在一段时间后出现。如果你的老板坚持当前的项目进度总是占主导地位，那么这种方法就行不通了。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-06T11:54:30.217

面向对象允许您将代码重构为超类。这可能是最简单、最便宜和最有效的重用类型。普通的类继承不需要过多考虑“其他情况”；您不必构建“全能”代码。

除了简单的继承之外，重用是你发现的比你发明的更多的东西。当您想重用自己的一个包来解决稍微不同的问题时，您会发现重用情况。当你想重用一个不完全适合新情况的包时，你有两个选择。

1.  复制它并修复它。您现在必须使用几乎相似的软件包——这是一个代价高昂的错误。

2.  使原始包在两种情况下可重复使用。

这样做是为了重用。而已。过多地考虑“潜在的”重用和未定义的“其他情况”可能会浪费时间。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-06T13:01:33.310

其他人已经提到了这些策略，但在这里它们是正式的。这三个会让你走得很远：

*   坚持[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)——它确保你的类只“做一件事”，这意味着它更有可能被另一个包含同样事情的应用程序重用。
*   遵守[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)——它可以确保你的代码“毫无意外地完成它应该做的事情”，这意味着它更有可能被另一个需要完成相同事情的应用程序重用。
*   坚持[开放/封闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)- 它确保您的代码可以在不修改其源代码的情况下表现出不同的行为，这意味着它更有可能在不直接修改的情况下被重用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T11:08:55.317

要添加到上述项目，我会说：

*   使您需要重用的那些功能通用
*   使用配置文件并使代码使用 files/db 中定义的属性
*   清楚地将您的代码分解为提供独立功能并且可以在不同场景中使用的函数/类，并使用配置文件定义这些场景

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T11:26:36.513

我将添加“类组合优于类继承”的概念（源自此处的其他答案）。这样，“组合”对象不关心它所依赖的对象的内部结构——只关心它的行为，这会导致更好的封装和更容易的可维护性（测试，需要关心的细节更少）。在 C# 和 Java 等语言中，这通常很重要，因为没有多重继承，因此它有助于避免您可能遇到的继承图地狱。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-06T11:48:18.607

如前所述，模块化代码比非模块化代码更可重用。

帮助模块化代码的一种方法是使用封装，请参阅此处的封装理论： [http ://www.edmundkirwan.com/](http://www.edmundkirwan.com/)

埃德。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-01T23:07:03.670

避免重新发明轮子。就是这样。这本身就有很多上面提到的好处。如果您确实需要更改某些内容，那么您只需创建另一段代码、另一个类、另一个常量、库等……它可以帮助您和其他开发人员在同一个应用程序中工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-06-13T07:43:26.807

**详细**评论，当你下次回到代码时，所有看起来可能会令人困惑的东西。过于冗长的评论可能会有点烦人，但它们比稀疏的评论要好得多，并且可以节省数小时试图弄清楚你上次在做什么的 WTF。

# c++ - 如何在 Windows 中编写一个可以最小化到系统托盘的控制台应用程序？

> ID：268260
> 
> 赞同：4
> 
> 时间：2008-11-06T10:45:27.923
> 
> 标签：c++, c, windows, visual-c++

我编写了一个 Visual C++ 控制台应用程序（即子系统：控制台），它可以将有用的诊断消息打印到控制台。

但是，我想在大多数情况下保持应用程序最小化，而不是最小化到任务栏，而是在系统托盘上显示为一个漂亮的图标。单击系统托盘图标时，我还想恢复控制台。

我应该如何改变我的程序来做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-06T11:00:02.590

这将是一个丑陋的黑客。

首先，您必须检索控制台应用程序的`hWnd`/ `hInstance`。目前，我只能想出一种方法：

*   创建一个指南`CoCreateGuid()`
*   将其转换为字符串
*   将控制台窗口的标题设置为此 guid`SetConsoleTitle()`
*   `hWnd`使用 Guid 作为平铺找到您的窗口的`FindWindow()`
*   从这一点开始，您可以按照通常的方式进行操作。[有关详细信息，请参阅 http://www.gidforums.com/t-9218.html。](http://www.gidforums.com/t-9218.html)
*   完成后不要忘记将控制台窗口重命名为原始标题。

如您所见，即使可以这样做，这也是一个可怕而痛苦的解决方案。请不要这样做。请不要将控制台应用程序最小化到系统托盘。**这不是您应该能够在 Windows API 中执行的操作。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T11:43:55.870

您可能想要编写一个单独的 gui 来充当日志阅读器。然后，您会发现将其最小化到托盘要容易得多。它还可以让您做一些您可能会觉得有用的其他事情，例如更改动态可见的日志消息级别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T23:16:21.797

要了解控制台的 hWnd，您有两种选择：

*   在 Windows 2000 或更高版本上，您可以使用 GetConsoleWindow() 函数。不要忘记在包含 windows.h 之前将 _WIN32_WINNT 定义为 0x0500 或更大以访问此功能。
*   如果您还想在早期的 Windows 版本上运行您的程序，那么您必须使用类似于上述 GUID 技巧的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T12:52:43.237

可能您最好的选择是创建一个[“仅消息窗口”](http://msdn.microsoft.com/en-us/library/ms632599.aspx#message_only)（没有可见窗口的消息队列）来接收通知区域消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T14:23:20.853

带有 GUID 的答案是完全荒谬的（根本没有意义）控制台 hWnd 当然是由 GetConsoleWindow() 给出的（！）

# graphics - C# 2.0 教程中的真正基本图形

> ID：268270
> 
> 赞同：1
> 
> 时间：2008-11-06T10:48:26.480
> 
> 标签：graphics, c#-2.0

我在一家票务代理公司工作，我们在自己的票务打印机上打印票。我一直在直接对票的设计进行编码并将模板存储在数据库中。如果我们需要将新字段添加到工单中，我会手动添加它并使用神秘的坐标系统来估计字段应该去哪里以及其他字段需要移动多少才能容纳新信息。

我们一直计划用一个简单的（我强调简单这个词）图形编辑器使这个系统自动化。基本上我们不会很快预见到门票的形状会发生根本性的变化，我们有一种尺寸的门票，而且门票打印机固件非常简单，因为它更像是一台工业机器，它有大约 10 种字体和一些非常基本的尺寸交互。

我需要让这个编辑器按票的像素显示一个尺寸的矩形（甚至可以是实际大小），并有一个可调整大小的网格，可以在票矩形顶部的叠加和不可见性之间切换，并用点而不是线表示。

然后我希望能够通过绘制填充有显示字段最大大小的字母“x”的矩形来表示字段（以防止重叠）。这些字段应该是可选择的、可拖动的和可拖放的，以网格的方式进行。

我已经计算出了它的数学，但我不知道如何绘制矩形，然后在图层中绘制网格，然后在上面放置更多充满“x”的矩形。我也不太了解根据鼠标事件更改绘制位置。这根本不是我必须做的事情。

到目前为止，我看到的所有教程都假定您已经对使用绘图对象有很多了解，并且正在寻求扩展这些东西的基本知识。我只需要首先指出在图片框中操作浮动对象的好教程的方向。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T16:52:40.600

对于那些需要这个不寻常领域指南的人（至少我们这些具有 BIS 背景的人），我衷心赞同：

[https://web.archive.org/web/20141230145656/http://bobpowell.net/faqmain.aspx](https://web.archive.org/web/20141230145656/http://bobpowell.net/faqmain.aspx)

我现在很高兴地绘制图形界面并让它们轻松响应控制输入。

# python - 在字典中获取最大值的键？

> ID：268272
> 
> 赞同：1183
> 
> 时间：2008-11-06T10:49:58.757
> 
> 标签：python, dictionary, max

我有一个`dictionary`：键是字符串，值是整数。

例子：

```
stats = {'a':1000, 'b':3000, 'c': 100} 
```

我想得到`'b'`一个答案，因为它是具有更高价值的关键。

我使用带有反向键值元组的中间列表执行了以下操作：

```
inverse = [(value, key) for key, value in stats.items()]
print max(inverse)[1] 
```

那是更好（或更优雅）的方法吗？

* * *

## 回答 #1

> 赞同：1640
> 
> 时间：2008-11-11T06:24:30.820

```
max(stats, key=stats.get) 
```

* * *

## 回答 #2

> 赞同：743
> 
> 时间：2008-11-06T10:58:45.977

您可以`operator.itemgetter`为此使用：

```
import operator
stats = {'a':1000, 'b':3000, 'c': 100}
max(stats.iteritems(), key=operator.itemgetter(1))[0] 
```

而不是在内存使用中建立一个新列表`stats.iteritems()`。该函数的`key`参数`max()`是计算用于确定如何对项目进行排名的键的函数。

请注意，如果您有另一个键值对 'd': 3000 ，即使它们都具有最大值，此方法也只会返回两者**之一****。**

 **```
>>> import operator
>>> stats = {'a':1000, 'b':3000, 'c': 100, 'd':3000}
>>> max(stats.iteritems(), key=operator.itemgetter(1))[0]
'b' 
```

如果使用 Python3：

```
>>> max(stats.items(), key=operator.itemgetter(1))[0]
'b' 
```

* * *

## 回答 #3

> 赞同：245
> 
> 时间：2012-09-09T23:30:37.307

我已经测试了许多变体，这是返回具有最大值的 dict 键的最快方法：

```
def keywithmaxval(d):
     """ a) create a list of the dict's keys and values; 
         b) return the key with the max value"""  
     v=list(d.values())
     k=list(d.keys())
     return k[v.index(max(v))] 
```

为了给你一个想法，这里有一些候选方法：

```
def f1():  
     v=list(d1.values())
     k=list(d1.keys())
     return k[v.index(max(v))]

def f2():
    d3={v:k for k,v in d1.items()}
    return d3[max(d3)]

def f3():
    return list(filter(lambda t: t[1]==max(d1.values()), d1.items()))[0][0]    

def f3b():
    # same as f3 but remove the call to max from the lambda
    m=max(d1.values())
    return list(filter(lambda t: t[1]==m, d1.items()))[0][0]        

def f4():
    return [k for k,v in d1.items() if v==max(d1.values())][0]    

def f4b():
    # same as f4 but remove the max from the comprehension
    m=max(d1.values())
    return [k for k,v in d1.items() if v==m][0]        

def f5():
    return max(d1.items(), key=operator.itemgetter(1))[0]    

def f6():
    return max(d1,key=d1.get)     

def f7():
     """ a) create a list of the dict's keys and values; 
         b) return the key with the max value"""    
     v=list(d1.values())
     return list(d1.keys())[v.index(max(v))]    

def f8():
     return max(d1, key=lambda k: d1[k])     

tl=[f1,f2, f3b, f4b, f5, f6, f7, f8, f4,f3]     
cmpthese.cmpthese(tl,c=100) 
```

测试词典：

```
d1={1: 1, 2: 2, 3: 8, 4: 3, 5: 6, 6: 9, 7: 17, 8: 4, 9: 20, 10: 7, 11: 15, 
    12: 10, 13: 10, 14: 18, 15: 18, 16: 5, 17: 13, 18: 21, 19: 21, 20: 8, 
    21: 8, 22: 16, 23: 16, 24: 11, 25: 24, 26: 11, 27: 112, 28: 19, 29: 19, 
    30: 19, 3077: 36, 32: 6, 33: 27, 34: 14, 35: 14, 36: 22, 4102: 39, 38: 22, 
    39: 35, 40: 9, 41: 110, 42: 9, 43: 30, 44: 17, 45: 17, 46: 17, 47: 105, 48: 12, 
    49: 25, 50: 25, 51: 25, 52: 12, 53: 12, 54: 113, 1079: 50, 56: 20, 57: 33, 
    58: 20, 59: 33, 60: 20, 61: 20, 62: 108, 63: 108, 64: 7, 65: 28, 66: 28, 67: 28, 
    68: 15, 69: 15, 70: 15, 71: 103, 72: 23, 73: 116, 74: 23, 75: 15, 76: 23, 77: 23, 
    78: 36, 79: 36, 80: 10, 81: 23, 82: 111, 83: 111, 84: 10, 85: 10, 86: 31, 87: 31, 
    88: 18, 89: 31, 90: 18, 91: 93, 92: 18, 93: 18, 94: 106, 95: 106, 96: 13, 9232: 35, 
    98: 26, 99: 26, 100: 26, 101: 26, 103: 88, 104: 13, 106: 13, 107: 101, 1132: 63, 
    2158: 51, 112: 21, 113: 13, 116: 21, 118: 34, 119: 34, 7288: 45, 121: 96, 122: 21, 
    124: 109, 125: 109, 128: 8, 1154: 32, 131: 29, 134: 29, 136: 16, 137: 91, 140: 16, 
    142: 104, 143: 104, 146: 117, 148: 24, 149: 24, 152: 24, 154: 24, 155: 86, 160: 11, 
    161: 99, 1186: 76, 3238: 49, 167: 68, 170: 11, 172: 32, 175: 81, 178: 32, 179: 32, 
    182: 94, 184: 19, 31: 107, 188: 107, 190: 107, 196: 27, 197: 27, 202: 27, 206: 89, 
    208: 14, 214: 102, 215: 102, 220: 115, 37: 22, 224: 22, 226: 14, 232: 22, 233: 84, 
    238: 35, 242: 97, 244: 22, 250: 110, 251: 66, 1276: 58, 256: 9, 2308: 33, 262: 30, 
    263: 79, 268: 30, 269: 30, 274: 92, 1300: 27, 280: 17, 283: 61, 286: 105, 292: 118, 
    296: 25, 298: 25, 304: 25, 310: 87, 1336: 71, 319: 56, 322: 100, 323: 100, 325: 25, 
    55: 113, 334: 69, 340: 12, 1367: 40, 350: 82, 358: 33, 364: 95, 376: 108, 
    377: 64, 2429: 46, 394: 28, 395: 77, 404: 28, 412: 90, 1438: 53, 425: 59, 430: 103, 
    1456: 97, 433: 28, 445: 72, 448: 23, 466: 85, 479: 54, 484: 98, 485: 98, 488: 23, 
    6154: 37, 502: 67, 4616: 34, 526: 80, 538: 31, 566: 62, 3644: 44, 577: 31, 97: 119, 
    592: 26, 593: 75, 1619: 48, 638: 57, 646: 101, 650: 26, 110: 114, 668: 70, 2734: 41, 
    700: 83, 1732: 30, 719: 52, 728: 96, 754: 65, 1780: 74, 4858: 47, 130: 29, 790: 78, 
    1822: 43, 2051: 38, 808: 29, 850: 60, 866: 29, 890: 73, 911: 42, 958: 55, 970: 99, 
    976: 24, 166: 112} 
```

以及Python 3.2下的测试结果：

```
 rate/sec       f4      f3    f3b     f8     f5     f2    f4b     f6     f7     f1
f4       454       --   -2.5% -96.9% -97.5% -98.6% -98.6% -98.7% -98.7% -98.9% -99.0%
f3       466     2.6%      -- -96.8% -97.4% -98.6% -98.6% -98.6% -98.7% -98.9% -99.0%
f3b   14,715  3138.9% 3057.4%     -- -18.6% -55.5% -56.0% -56.4% -58.3% -63.8% -68.4%
f8    18,070  3877.3% 3777.3%  22.8%     -- -45.4% -45.9% -46.5% -48.8% -55.5% -61.2%
f5    33,091  7183.7% 7000.5% 124.9%  83.1%     --  -1.0%  -2.0%  -6.3% -18.6% -29.0%
f2    33,423  7256.8% 7071.8% 127.1%  85.0%   1.0%     --  -1.0%  -5.3% -17.7% -28.3%
f4b   33,762  7331.4% 7144.6% 129.4%  86.8%   2.0%   1.0%     --  -4.4% -16.9% -27.5%
f6    35,300  7669.8% 7474.4% 139.9%  95.4%   6.7%   5.6%   4.6%     -- -13.1% -24.2%
f7    40,631  8843.2% 8618.3% 176.1% 124.9%  22.8%  21.6%  20.3%  15.1%     -- -12.8%
f1    46,598 10156.7% 9898.8% 216.7% 157.9%  40.8%  39.4%  38.0%  32.0%  14.7%     -- 
```

在 Python 2.7 下：

```
 rate/sec       f3       f4     f8    f3b     f6     f5     f2    f4b     f7     f1
f3       384       --    -2.6% -97.1% -97.2% -97.9% -97.9% -98.0% -98.2% -98.5% -99.2%
f4       394     2.6%       -- -97.0% -97.2% -97.8% -97.9% -98.0% -98.1% -98.5% -99.1%
f8    13,079  3303.3%  3216.1%     --  -5.6% -28.6% -29.9% -32.8% -38.3% -49.7% -71.2%
f3b   13,852  3504.5%  3412.1%   5.9%     -- -24.4% -25.8% -28.9% -34.6% -46.7% -69.5%
f6    18,325  4668.4%  4546.2%  40.1%  32.3%     --  -1.8%  -5.9% -13.5% -29.5% -59.6%
f5    18,664  4756.5%  4632.0%  42.7%  34.7%   1.8%     --  -4.1% -11.9% -28.2% -58.8%
f2    19,470  4966.4%  4836.5%  48.9%  40.6%   6.2%   4.3%     --  -8.1% -25.1% -57.1%
f4b   21,187  5413.0%  5271.7%  62.0%  52.9%  15.6%  13.5%   8.8%     -- -18.5% -53.3%
f7    26,002  6665.8%  6492.4%  98.8%  87.7%  41.9%  39.3%  33.5%  22.7%     -- -42.7%
f1    45,354 11701.5% 11399.0% 246.8% 227.4% 147.5% 143.0% 132.9% 114.1%  74.4%     -- 
```

你可以看到这`f1`是 Python 3.2 和 2.7 下最快的（或者更完整的，`keywithmaxval`在这篇文章的顶部）

* * *

## 回答 #4

> 赞同：95
> 
> 时间：2020-02-14T17:22:07.707

您可以使用：

```
max(d, key = d.get) 
# which is equivalent to 
max(d, key = lambda k : d.get(k)) 
```

要返回键值对，请使用：

```
max(d.items(), key = lambda k : k[1]) 
```

* * *

## 回答 #5

> 赞同：79
> 
> 时间：2016-02-07T17:31:32.890

如果您只需要知道一个具有最大值的键，您可以不这样做，`iterkeys`或者`iteritems`因为在 Python 中通过字典进行迭代就是通过它的键进行迭代。

```
max_key = max(stats, key=lambda k: stats[k]) 
```

**编辑：**

*来自评论，@ user1274878：*

> 我是 python 新手。你能分步解释你的答案吗？

是的...

### 最大限度

> 最大值（可迭代 [，键]）
> 
> 最大值（arg1，arg2，*args[，键]）
> 
> 返回可迭代的最大项或两个或多个参数中的最大项。

可选`key`参数描述了如何比较元素以获得它们之间的最大值：

```
lambda <item>: return <a result of operation with item> 
```

将比较返回的值。

### 字典

Python dict 是一个哈希表。dict 的键是声明为键的对象的哈希。由于性能原因，迭代虽然 dict 通过它的键实现为迭代。

因此我们可以使用它来摆脱获取键列表的操作。

### 关闭

> 在另一个函数中定义的函数称为嵌套函数。嵌套函数可以访问封闭范围的变量。

`stats`可通过函数的`__closure__`属性获得的变量`lambda`，作为指向父作用域中定义的变量值的指针。

* * *

## 回答 #6

> 赞同：72
> 
> 时间：2018-08-23T04:08:56.097

例子：

```
stats = {'a':1000, 'b':3000, 'c': 100} 
```

如果你想用它的键找到最大值，也许以下可能很简单，没有任何相关的功能。

```
max(stats, key=stats.get) 
```

输出是具有最大值的键。

* * *

## 回答 #7

> 赞同：50
> 
> 时间：2008-11-06T11:28:56.167

这是另一个：

```
stats = {'a':1000, 'b':3000, 'c': 100}
max(stats.iterkeys(), key=lambda k: stats[k]) 
```

该函数`key`只返回应该用于排名的值并`max()`立即返回所需的元素。

* * *

## 回答 #8

> 赞同：42
> 
> 时间：2008-11-07T14:41:33.203

```
key, value = max(stats.iteritems(), key=lambda x:x[1]) 
```

如果您不关心价值（我会感到惊讶，但是），您可以这样做：

```
key, _ = max(stats.iteritems(), key=lambda x:x[1]) 
```

与表达式末尾的 [0] 下标相比，我更喜欢元组解包。我从不太喜欢 lambda 表达式的可读性，但发现它比 operator.itemgetter(1) 恕我直言。

* * *

## 回答 #9

> 赞同：33
> 
> 时间：2014-05-02T13:07:23.677

鉴于不止一个条目我有最大值。我会列出以最大值为值的键。

```
>>> stats = {'a':1000, 'b':3000, 'c': 100, 'd':3000}
>>> [key for m in [max(stats.values())] for key,val in stats.iteritems() if val == m]
['b', 'd'] 
```

这将为您提供“b”和任何其他最大键。

注意：对于 python 3 使用`stats.items()`而不是`stats.iteritems()`

* * *

## 回答 #10

> 赞同：23
> 
> 时间：2017-12-17T11:28:09.197

获取字典的最大键/值`stats`：

```
stats = {'a':1000, 'b':3000, 'c': 100} 
```

*   基于**键**

`>>> max(stats.items(), key = lambda x: x[0]) ('c', 100)`

*   基于**价值观**

`>>> max(stats.items(), key = lambda x: x[1]) ('b', 3000)`

当然，如果只想从结果中获取键或值，可以使用元组索引。例如获取最大值对应的key：

`>>> max(stats.items(), key = lambda x: x[1])[0] 'b'`

**解释**

[`items()`](https://docs.python.org/3/library/stdtypes.html#dict.items)Python 3 中的 dictionary 方法返回字典的[视图对象](https://docs.python.org/3/library/stdtypes.html#dictionary-view-objects)。当这个视图对象被`max`函数迭代时，它会产生字典项作为表单的元组`(key, value)`。

`>>> list(stats.items()) [('c', 100), ('b', 3000), ('a', 1000)]`

当您使用[`lambda`](https://docs.python.org/3/reference/expressions.html#lambda)表达式`lambda x: x[1]`时，在每次迭代中，`x` 是这些元组之一`(key, value)`。因此，通过选择正确的索引，您可以选择是按键还是按值进行比较。

**蟒蛇2**

对于 Python 2.2+ 版本，相同的代码也可以使用。但是，最好使用[`iteritems()`](https://docs.python.org/2/library/stdtypes.html#dict.iteritems)字典方法而不是[`items()`](https://docs.python.org/2/library/stdtypes.html#dict.items)性能。

**笔记**

*   此答案基于对[Climbs_lika_Spyder 答案](https://stackoverflow.com/a/268285/1802750)的评论。

*   使用的代码在 Python 3.5.2 和 Python 2.7.10 上进行了测试。

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2020-09-04T16:36:56.500

```
max(stats, key=stats.get) if stats else None 
```

`stats`可能是一个空字典，所以 using only`max(stats, key=stats.get)`会在这种情况下中断。

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2018-05-04T06:50:19.257

```
d = {'A': 4,'B':10}

min_v = min(zip(d.values(), d.keys()))
# min_v is (4,'A')

max_v = max(zip(d.values(), d.keys()))
# max_v is (10,'B') 
```

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2019-08-19T15:35:27.057

我对这些答案中的任何一个都不满意。`max`总是选择具有最大值的第一个键。字典可以有多个具有该值的键。

```
def keys_with_top_values(my_dict):
    return [key  for (key, value) in my_dict.items() if value == max(my_dict.values())] 
```

发布此答案以防万一它可以帮助某人。请参阅下面的 SO 帖子

[在平局的情况下，Python 选择哪个最大值？](https://stackoverflow.com/questions/6783000/which-maximum-does-python-pick-in-the-case-of-a-tie)

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2015-05-05T02:03:11.953

通过所选答案中的评论根据迭代解决方案...

在 Python 3 中：

```
max(stats.keys(), key=(lambda k: stats[k])) 
```

在 Python 2 中：

```
max(stats.iterkeys(), key=(lambda k: stats[k])) 
```

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2018-09-12T09:43:56.203

我来到这里寻找如何`mydict.keys()`根据`mydict.values()`. 我希望返回前*x*个值，而不是只返回一个键。

此解决方案比使用`max()`函数更简单，您可以轻松更改返回值的数量：

```
stats = {'a':1000, 'b':3000, 'c': 100}

x = sorted(stats, key=(lambda key:stats[key]), reverse=True)
['b', 'a', 'c'] 
```

如果您想要单个排名最高的键，只需使用索引：

```
x[0]
['b'] 
```

如果你想要前两个排名最高的键，只需使用列表切片：

```
x[:2]
['b', 'a'] 
```

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2020-06-02T13:00:23.643

更容易理解的方法：

```
mydict = { 'a':302, 'e':53, 'g':302, 'h':100 }
max_value_keys = [key for key in mydict.keys() if mydict[key] == max(mydict.values())]
print(max_value_keys) # prints a list of keys with max value 
```

**输出：** ['a', 'g']

现在您只能选择一个键：

```
maximum = mydict[max_value_keys[0]] 
```

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2016-02-23T18:58:38.883

和`collections.Counter`你一起做

```
>>> import collections
>>> stats = {'a':1000, 'b':3000, 'c': 100}
>>> stats = collections.Counter(stats)
>>> stats.most_common(1)
[('b', 3000)] 
```

如果合适，您可以简单地从一个空开始`collections.Counter`并添加到它

```
>>> stats = collections.Counter()
>>> stats['a'] += 1
:
etc. 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2018-11-01T11:05:26.370

堆队列是一种**通用**解决方案，它允许您提取按值排序的前*n 个*键：

```
from heapq import nlargest

stats = {'a':1000, 'b':3000, 'c': 100}

res1 = nlargest(1, stats, key=stats.__getitem__)  # ['b']
res2 = nlargest(2, stats, key=stats.__getitem__)  # ['b', 'a']

res1_val = next(iter(res1))                       # 'b' 
```

注意`dict.__getitem__`是语法糖调用的方法`dict[]`。与 相反，如果找不到密钥`dict.get`，它将返回，这在此处不会发生。`KeyError`

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2018-01-10T05:32:18.810

`max((value, key) for key, value in stats.items())[1]`

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2021-09-18T19:21:54.100

以下是从给定字典中提取具有最大值的键的两种简单方法

```
import time
stats = {
   "a" : 1000,
   "b" : 3000,
   "c" : 90,
   "d" : 74,
   "e" : 72,
 }

start_time = time.time_ns()
max_key = max(stats, key = stats.get)
print("Max Key [", max_key, "]Time taken (ns)", time.time_ns() - start_time)

start_time = time.time_ns()
max_key = max(stats, key=lambda key: stats[key])
print("Max Key with Lambda[", max_key, "]Time taken (ns)", time.time_ns() - start_time) 
```

> 输出

```
Max Key [ b ] Time taken (ns) 3100
Max Key with Lambda [ b ] Time taken (ns) 1782 
```

对于较小的输入，使用 Lambda 表达式的解决方案似乎表现更好。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2017-05-20T17:11:08.693

+1 [@Aric Coady](https://stackoverflow.com/questions/268272/getting-key-with-maximum-value-in-dictionary#comment73465439_280156)最简单的解决方案。
还有一种随机选择字典中具有最大值的键之一的方法：

```
stats = {'a':1000, 'b':3000, 'c': 100, 'd':3000}

import random
maxV = max(stats.values())
# Choice is one of the keys with max value
choice = random.choice([key for key, value in stats.items() if value == maxV]) 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2013-06-20T15:32:51.863

```
Counter = 0
for word in stats.keys():
    if stats[word]> counter:
        Counter = stats [word]
print Counter 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-09-04T20:34:57.647

怎么样：

```
 max(zip(stats.keys(), stats.values()), key=lambda t : t[1])[0] 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-02-14T04:00:14.737

对于科学 python 用户，这里是一个使用 Pandas 的简单解决方案：

```
import pandas as pd
stats = {'a': 1000, 'b': 3000, 'c': 100}
series = pd.Series(stats)
series.idxmax()

>>> b 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2021-04-02T20:10:47.237

如果 stats 为空，可以在找到有价值的键之前检查条件，例如，

```
stats = {'a':1000, 'b':3000, 'c': 100}
max_key = None
if bool(stats):
   max_key = max(stats, key=stats.get)
print(max_key) 
```

这可以先检查字典是否为空，然后处理。

```
>>> b 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2021-09-18T18:37:08.530

试试这个：

```
sorted(dict_name, key=dict_name.__getitem__, reverse=True)[0] 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2017-07-11T12:50:02.500

我针对一个非常基本的循环测试了接受的答案和@thewolf最快的解决方案，并且循环比两者都快：

```
import time
import operator

d = {"a"+str(i): i for i in range(1000000)}

def t1(dct):
    mx = float("-inf")
    key = None
    for k,v in dct.items():
        if v > mx:
            mx = v
            key = k
    return key

def t2(dct):
    v=list(dct.values())
    k=list(dct.keys())
    return k[v.index(max(v))]

def t3(dct):
    return max(dct.items(),key=operator.itemgetter(1))[0]

start = time.time()
for i in range(25):
    m = t1(d)
end = time.time()
print ("Iterating: "+str(end-start))

start = time.time()
for i in range(25):
    m = t2(d)
end = time.time()
print ("List creating: "+str(end-start))

start = time.time()
for i in range(25):
    m = t3(d)
end = time.time()
print ("Accepted answer: "+str(end-start)) 
```

结果：

```
Iterating: 3.8201940059661865
List creating: 6.928712844848633
Accepted answer: 5.464320182800293 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2020-02-13T13:58:14.960

如果您有多个具有相同值的键，例如：

```
stats = {'a':1000, 'b':3000, 'c': 100, 'd':3000, 'e':3000} 
```

您可以获得一个包含所有最大值的键的集合，如下所示：

```
from collections import defaultdict
from collections import OrderedDict

groupedByValue = defaultdict(list)
for key, value in sorted(stats.items()):
    groupedByValue[value].append(key)

# {1000: ['a'], 3000: ['b', 'd', 'e'], 100: ['c']}

groupedByValue[max(groupedByValue)]
# ['b', 'd', 'e'] 
```

# c# - 我可以检查 Linq 2 SQL 的 DataContext 是否在跟踪实体吗？

> ID：268277
> 
> 赞同：0
> 
> 时间：2008-11-06T10:52:35.617
> 
> 标签：c#, linq-to-sql

如果用户调用 DataContext.SubmitChanges() 并且 DataContext 没有跟踪任何内容，我们想要抛出异常。

也就是说...如果没有插入、更新或删除，则可以调用 SubmitChanges。但我们要确保开发人员不会忘记将实体附加到 DataContext。

更好的是......是否可以获得 DataContext 正在跟踪的所有实体的集合（包括那些未更改的实体）？

PS：[我问的最后一个问题](https://stackoverflow.com/questions/259219/how-can-i-reject-all-changes-in-a-linq-to-sqls-datacontext)被回答为：“这样做”......请不要:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T12:18:44.520

我认为没有任何公共/受保护的方法可以让您直接了解这一点。您可能必须使用反射，就像我在[这里](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/1ad473b24976235e/345083e2f19884b1)做了大约 3 条消息一样，查看`ChangeTracker`. `Services`太丑了，我害怕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T11:14:14.993

查看 ObjectTracker 或挂在 DataContext 之外的东西。它存储了更改列表。

另外，我相信 SubmitChanges 是虚拟的，因此您可以拦截 SubmitChanges 调用并在那里进行一些检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T06:22:07.343

如果我正确理解了这个问题...

这些向您展示了 DataContext 正在跟踪的内容

```
DataContext.GetChangeSet().Inserts;
DataContext.GetChangeSet().Deletes;
DataContext.GetChangeSet().Updates; 
```

这是你的想法吗？

```
if (DataContext.GetChageSet().Inserts.Count = 0
        && DataContext.GetChageSet().Deletes.Count
        && DataContext.GetChageSet().Updates.Count)
{
    throw new Exception("You forgot to do something with your DataContext...");
}
else
{
    DataContext.SubmitChanges();
} 
```

# version-control - 如何将内部版本号从 Nant 传递回 Cruise Control

> ID：268289
> 
> 赞同：6
> 
> 时间：2008-11-06T11:00:57.813
> 
> 标签：version-control, build-process, cruisecontrol.net, nant

我有一个 Nant 构建脚本，CruiseControl 使用它来按需构建解决方案。

但是，我们最近才获得 CruiseControl，因此我们的官方内部版本号与 CruiseControl 中列出的不同。

我知道 CruiseControl 将一些属性注入到构建脚本中，以便我可以在脚本 (CCNetLabel) 中访问 CC 内部版本号，但是如何将值传递回 CC 以用作 UI 屏幕上的内部版本号？

例如，CC 表示内部版本号 2

nAnt 脚本每次构建都会增加一个 buildnumber.xml 值，官方的构建号是 123。

我希望 CC UI 显示最后一个成功的内部版本号：123，而不是 2，那么我如何将该值传递回来？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T16:00:52.590

为此需要自定义构建标签。Perforce 是我们的源代码控制提供商，我们从中获得了我们的版本号。代码如下：

```
/// <summary>
/// Gets the latest change list number from perforce, for ccnet to consume as a build label.
/// </summary>
[ReflectorType( "p4labeller" )]
public class PerforceLabeller : ILabeller
{
    //  perforce executable (optional)
    [ReflectorProperty("executable", Required = false)]
    public string P4Executable = "p4.exe";

    // perforce port (i.e. myserver:1234)
    [ReflectorProperty("port", Required = false)]
    public string P4Port = String.Empty;

    // perforce user
    [ReflectorProperty("user", Required = false)]
    public string P4User = String.Empty;

    //  perforce client
    [ReflectorProperty("client", Required = false)]
    public string P4Client = String.Empty;

    // perforce view (i.e. //Dev/Code1/...)
    [ReflectorProperty("view", Required = false)]
    public string P4View = String.Empty;

    // Returns latest change list
    public string Generate( IIntegrationResult previousLabel )
    {
        return GetLatestChangelist(); 
    }

    // Stores latest change list into a label
    public void Run( IIntegrationResult result )
    {
        result.Label = GetLatestChangelist();
    }

    // Gets the latest change list
    public string GetLatestChangelist()
    {
        // Build the arguments to pass to p4 to get the latest changelist
        string theArgs = "-p " + P4Port + " -u " + P4User + " -c " + P4Client + " changes -m 1 -s submitted " + P4View;
        Log.Info( string.Format( "Getting latest change from Perforce using --> " + theArgs ) );

        // Execute p4
        ProcessResult theProcessResult = new ProcessExecutor().Execute( new ProcessInfo( P4Executable, theArgs ) );

        // Extract the changelist # from the result
        Regex theRegex = new Regex( @"\s[0-9]+\s", RegexOptions.IgnoreCase );
        Match theMatch = theRegex.Match( theProcessResult.StandardOutput );
        return theMatch.Value.Trim();
    }
} 
```

**GetLatestChangelist**方法是您可能插入自己的逻辑以与版本控制系统对话的地方。在 Perforce 中，最后一个变更列表的想法是独一无二的。我们的内部版本号以及最终的版本号都基于此。

一旦你构建了它（到一个程序集 dll 中），你就必须把它挂到 ccnet 中。您可以将程序集放入服务器目录（ccnet.exe 旁边）。

接下来，您修改您的 ccnet 项目文件以使用此贴标机。我们使用[默认的 labeller 块](http://confluence.public.thoughtworks.org/display/CCNET/Default+Labeller)来做到这一点。类似于以下内容：

```
<project>
<labeller type="p4labeller">
    <client>myclient</client>
    <executable>p4.exe</executable>
    <port>myserver:1234</port>
    <user>myuser</user>
    <view>//Code1/...</view>
</labeller>
<!-- Other project configuration to go here -->
</project> 
```

如果您只是想让内部版本号显示在 ccnet 中，那么您就完成了，不需要做任何其他事情。但是，如果您愿意，可以使用已经提供的**CCNetLabel**属性访问 NAnt 脚本中的标签。

希望这会有所帮助。如果您有任何问题，请通过评论告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T11:11:53.843

您是否尝试使用一些环境变量？我相信CCNet可以处理这些。

我会对此进行一些研究。

好吧，我看到了一个解决方案，很脏，但无论如何：

1-在您的 CCNET 项目定义中添加一个 defaultlabeller 部分[。](http://confluence.public.thoughtworks.org/display/CCNET/Default+Labeller)它将包含您要显示的内部版本号的模式。

2- 在 NAnt 中，有一个脚本来更新您的配置文件，插入您想要查看的内部版本号。

3-触摸（在 Unix 意义上）ccnet.exe.config 文件，以使其重新加载项目配置文件。

等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T13:21:22.007

我们也遇到了这个问题。我最终写了一个特殊的 CC 标签插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:05:53.953

如果您的内部版本号是连续的，您只需破解巡航控制状态文件即可为其提供正确的内部版本号。您正在寻找一个名为 [projectName].state 的文件。

我将**Label**元素更改为正确的数字，并将**LastSuccessfulIntegrationLabel**更改为新数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T16:32:24.493

> 但是，我们最近才获得 CruiseControl，因此我们的官方内部版本号与 CruiseControl 中列出的不同。

有点像 gbanfill 所说的那样，你可以告诉 CC 从什么内部版本开始，但没有必要破解 .ser 文件。您可以使用 JMX 接口设置当前的内部版本号，以使其与您的 NAnt 内部版本号同步。

您还可以将[默认标签](http://cruisecontrol.sourceforge.net/main/configxml.html#labelincrementer)值设置为您当前的内部版本号，删除 .ser 文件并重新启动 CC。

但也许最简单的方法是将内部版本号从 NAnt 写入属性文件，然后使用[属性文件标签增量](http://cruisecontrol.sourceforge.net/main/configxml.html#propertyfilelabelincrementer)器来读取该文件。（一定要设置 setPreBuildIncrementer="true"）

# architecture - 表示软件系统的最佳建模方法是什么？

> ID：268291
> 
> 赞同：0
> 
> 时间：2008-11-06T11:01:38.403
> 
> 标签：architecture, modeling, representation

表示软件系统的最佳建模方法是什么。我的意思是像 UML 等等。UML 更好还是有比它更好的东西？我需要以图形方式表示我的 Web 应用程序，这是一个 3 层架构。我需要像 UML 这样的工程模型方法来描述从前端门户到中间件 EAI 再到数据库的整个软件系统。

这样的事情有什么用？请不要关闭这个问题，与编程无关，而是与软件有关。所以向 SO 社区提出请求。不要关闭这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T11:17:39.480

你可能想看看 ArchiMate - [http://www.archimate.org/](http://www.archimate.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T11:52:17.163

UML should work. MS Visio is a decent tool to create the models. You can write descriptions on the Visio UML diagrams as well.

A tool or modeling language can never compensate for a bad design! Simpler and elegant the design, lesser the dependency on tool or language.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T11:07:25.850

我根本不使用任何正式的建模语言，而是将来自 UML、流程图和涂鸦的部分与正在发生的事情的简要描述合并在一起。

尽管 UML 的理想是对正在发生的事情提供一种通用的、明确的解释，但我发现在实践中需要同时提供描述——无论是口头还是其他方式。

我的两分钱...

# sql - 让 mysql select 语句返回完全限定的列名，如 table.field

> ID：268296
> 
> 赞同：4
> 
> 时间：2008-11-06T11:02:08.777
> 
> 标签：sql, mysql

有没有办法让 mysql select 语句返回完全限定的列名，如“table.field”，而不对每个字段使用 AS？

像这样：

```
SELECT * 
FROM  table1  
LEFT JOIN table2 on table1.f_ID = table2.ID 
```

结果将是：“table1.ID”，“table1.name”，“table2.ID”，“table2.name”，...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-12-22T18:41:24.590

如果您使用的是 PHP，您可以使用 PDO 来获得此结果。

`$PDO->setAttribute(PDO::ATTR_FETCH_TABLE_NAMES, true);`

有关详细信息，请参阅[SQL Select * from multiple tables](https://stackoverflow.com/questions/2523631/sql-select-from-multiple-tables)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T14:55:20.930

并不真地。您可以编写一些动态 SQL 来完成此操作，但这并不简单。如果您真的想要动态 SQL，请告诉我，我可以尝试制作一些东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-22T07:24:11.507

在语句中使用完全限定的字段名称将在结果集中产生完全限定的字段名称。

```
SELECT table1.ID, table1.name, table2.ID, table2.name
FROM table1 
LEFT JOIN table2 on table1.f_ID = table2.ID 
```

我意识到您希望摆脱的负担是手动执行此操作。但是，如果您的应用程序对数据库的布局有任何了解，则可以在应用程序内动态生成它。

只是我的 2 美分

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-20T12:40:47.450

你也可以这样写：

```
 SELECT table1.*, table2.*
     FROM table1 
LEFT JOIN table2 on table1.f_ID = table2.ID 
```

如果您想要全部，则无需指定每一列

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-27T14:09:50.467

```
select  table1.* , table1='<======'

        table2.* , table2='<======'

from  table1  

    left join table2 on table1.f_ID = table2.ID 
```

# objective-c - 用于 Mac 编程的 Objective-C 的替代品有哪些？

> ID：268301
> 
> 赞同：10
> 
> 时间：2008-11-06T11:04:03.580
> 
> 标签：objective-c, cocoa, macos

我已经在无指针、垃圾收集的编程语言的世界中变得非常自在。现在我必须编写一个小的 Mac 组件。我一直在学习Objective-C，但是当我面临悬空指针的可能性和管理保留计数的需要时，我感到很沮丧。

我知道 Objective-C 现在有垃圾收集，但这仅适用于 Leopard。我的组件也必须与 Tiger 一起使用。

我需要访问一些 Java 不可用的 Cocoa 库，这样就排除了我通常选择的武器。

我的替代方案是什么？特别是没有显式指针和自动垃圾收集。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-06T12:45:32.203

“组件”是什么意思？您是指要交给其他人以链接到他们的应用程序的代码块或库吗？如果是这样，那么此时使用任何桥接语言都是不现实的。虽然很多桥接器都非常好，但它们几乎总是存在大多数应用程序开发人员不愿意使用单个组件来处理的复杂性和问题，尤其是在涉及大量运行时的情况下。

这些桥梁对于将其他语言库连接到您的 Objective C 应用程序中是最有价值的。虽然您可以使用它们编写相当完整的应用程序，但这样做通常需要更好地理解 Objective C 而不是简单地编写 Objective C 应用程序，因为您需要理解和处理语言、对象模型、线程和内存分配阻抗不匹配的问题发生。

这也是为什么很多人争辩说，即使你对一门语言非常熟悉，尝试通过桥梁使用该语言学习 Cocoa 通常比使用 Objective C 学习它更难。

最后，最近对桥接语言的支持大部分归功于 Leopard 中添加的“BridgeSupport”功能。即使是早于已经迁移的桥，有时在 Tiger 和 Leopard 上使用桥接语言也会有很大的不同。此外，目前没有对 iPhone 的桥接支持，如果这是一个问题，大多数桥接语言将无法在其上运行。

最后，如果您正在编写一个将链接到其他应用程序的库，您需要在 Tiger 和 Leopard 上运行，并且您需要访问仅 Cocoa 的 API，我认为您会发现使用任何非 Objective C 解决方案都非常困难。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-06T11:18:39.993

如果您对 Ruby 感兴趣，您可以尝试[PyObjC](http://developer.apple.com/cocoa/pyobjc.html)用 python 或[MacRuby编写 Cocoa 应用程序。](http://www.macruby.org/trac/wiki/MacRuby)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-07T01:46:03.953

您不应该被 Cocoa 的保留/释放引用计数吓倒。在实践中，它比 GC 粉丝让你相信的要容易得多。[Cocoa 内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/index.html)非常简单，它们只会影响您的一小部分代码，甚至可以自动生成*这些代码。*

这是诀窍。您将 MM 代码封装在访问器方法中，并**始终**使用访问器。Xcode 有内置脚本来生成适当的访问器，或者如果您需要更大的灵活性，还有像[Accessorizer](http://www.kevincallahan.org/software/accessorizer.html)这样的第 3 部分应用程序。

这不是一种侵入性方法 - 如果您需要保留一个对象以供以后使用，您只需要担心保留它，如果您要这样做，您将需要一个实例变量来无论如何都要保留它。而且，如果您使用 KVO 和绑定，则需要使用访问器来确保触发适当的观察者通知。基本上，如果您使用良好的 OOP 和 Cocoa 实践，则几乎不需要额外的想法或精力来管理内存。

大多数对 Cocoa 的“手动”内存管理有困难的人都是因为误用了它。最常见的错误是将相关代码分散在各处。这意味着很难找到缺少的保留、额外的释放等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T11:19:00.773

尝试此处列出的任何 Cocoa 桥[http://www.cocoadev.com/index.pl?CocoaBridges](http://www.cocoadev.com/index.pl?CocoaBridges)

您还可以尝试[F-Script](http://www.fscript.org/) - 一种专门为 MacOSX/Cocoa 编写的 smalltalk 方言。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T11:21:14.357

[RubyCocoa](http://rubycocoa.sourceforge.net/HomePage)越来越令人印象深刻，我已经看到很多使用它的成功实现。那就是，当然，如果 Ruby 是你的一杯茶……

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T09:46:17.667

您可以随时使用 REALbasic (www.realsoftware.com)。真正简单有趣的使用，虽然不是免费的。您不能使用它制作 dylib（或 dll），但您可以在代码中使用 dylib 和 dll。你也可以使用可可库

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T18:31:25.597

不要忘记你也可以使用 java，我不是指 java-cocoa 桥，我指的是实际的 java。

还有一个来自苹果的软件包，它也为您提供了对几个 osx 功能的访问。

还要评论一下 Shem 的观点，如果您的目标是 osx 10.5 及更高版本，您可以利用垃圾收集。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T04:19:16.763

[如果你想要 lisp 语法，那么 Nu 是在 Objective-C http://www.programming.nu/](http://www.programming.nu/)之上实现的 lisp

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-09T21:46:36.033

此外，FreePascal 可以生成本机 Carbon 应用程序（正在为 Cocoa 工作）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T11:11:02.787

查看[Python](http://www.python.org)和[wxPython](http://wxpython.org/)（Python 中的 wxWidgets）。

wxWidgets 有一个非常优雅的 App-Doc-View 应用程序设计模式，非常非常好。用得还不够，IMO。我还没有找到这个 App-Doc-View 示例的任何 wxPython 示例，因此您必须使用 C 示例来推断它在 Python 中的工作方式。

我会发布示例，但我还没有完成所有工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T11:59:57.633

.NET 通过 Mono mono-project.com

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-14T16:38:31.260

请参阅 NObjective ( [http://code.google.com/p/objcmapper/](http://code.google.com/p/objcmapper/) ) 桥接到 Cocoa。它提供了比其他功能更多的功能，而且开销更少。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-30T04:30:27.180

我也在研究单声道。在这一点上，Objective-C 对我来说有点太奇怪了。做 C/C++、Java、C#、Perl 等太多年了。我想。所有这些似乎都很容易在两者之间浮动。对于 Objective-C 来说并非如此。喜欢我的 Mac，但担心掌握这门语言会花费太多宝贵的时间。

# c# - 开始学习 ASP.NET 的好地方

> ID：268302
> 
> 赞同：3
> 
> 时间：2008-11-06T11:04:05.560
> 
> 标签：c#, asp.net

我有两年的 Visual C# 和 Visual C++ 编程经验。我想知道一些好的在线资源来开始学习 ASP.NET 或在深入 ASP.NET 之前我应该​​/需要学习的任何其他内容。我发现了一些被证明非常有用的在线视频。也许我想了解一些可以直接查看 ASP.NET 代码的开源项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T11:09:10.323

抱歉，但我将不得不首先提出显而易见的建议：

[微软 ASP .Net 官方网站](http://www.asp.net)

“开始”和“学习”的顶部都有一个链接，我发现这个网站在过去一年左右的时间里非常有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T11:15:11.187

作为从 WinForms 到 Web 的转换者，我提供以下提示

*   了解 ASP.NET 生命周期
*   掌握客户端与服务器端代码的概念；知道如何提供页面等
*   不要太早咬牙切齿，有很多新东西要学，而且变化很快。但是您不需要立即编写一个成熟的 AJAX Web 应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T12:22:59.893

我喜欢[http://www.asp.net/learn/](http://www.asp.net/learn/)它有一些很棒的 tuts 和一些很酷的视频，可以引导你完成整个过程。

祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T11:15:32.853

恕我直言，CodeProject (www.codeproject.com) 有很多与 ASP.NET 相关的优秀文章。关于项目，CodePlex (www.codeplex.com) 或 SourceForge 中有大量的 ASP.NET 应用程序。关于特定的 ASP.NET 应用程序，[http://www.cuyahoga-project.org/](http://www.cuyahoga-project.org/)这是一个很好的应用程序。

最好的祝福。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T11:39:20.043

[http://www.4guysfromrolla.com/](http://www.4guysfromrolla.com/)

大量不同级别的 ASP.NET 文章/教程。我发现了解一些概念非常有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T11:14:00.877

补充一点，另一个很棒的资源是[www.learnvisualstudio.net](http://www.learnvisualstudio.net)

它不是免费的，但它有大量的视频，涵盖从 1.1 到 3.5、AJAX、Web 服务的所有方面的 asp.net。

程序员到程序员风格的视频，带有很好的示例和可下载的源代码。

祝你好运 ：）

# c# - 在 C# 应用程序中执行 JavaScript 函数

> ID：268320
> 
> 赞同：5
> 
> 时间：2008-11-06T11:12:23.173
> 
> 标签：c#, javascript, scripting

如果不使用 WebBrowser 控件，我如何在 C# 应用程序中执行与任何浏览器 DOM 依赖项分离的 JavaScript 函数？我正在研究只为服务器和客户端验证实施一次验证规则。如果您愿意，请参阅[此问题以供参考。](https://stackoverflow.com/questions/265343/automatically-duplicating-business-logic-on-web-client)我可以使用任何 JS 解释器库吗？

*附录：* 我的目标是在客户端和服务器上自动部署和调用完全相同的验证逻辑，而在实际验证期间两者之间没有通信。所以，理想情况下，我会在 JavaScript 中编写我的验证逻辑，并将其呈现到页面上。或者，我可以用 C# 编写我的逻辑，使用[Script#](http://projects.nikhilk.net/ScriptSharp/)将其转换为 JavaScript ，然后将其呈现到页面。

我不希望在客户端和服务器端维护单独的验证函数，也不希望 AJAX 调用服务器验证函数，也不希望仅客户端或仅服务器验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T11:34:08.043

你可以使用[JScript.Net](http://en.wikipedia.org/wiki/JScript_.NET)

要么，要么调查[脚本#](http://projects.nikhilk.net/ScriptSharp/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T12:04:54.003

这可能有助于[C#/VB.NET/JScript.NET 的脚本宿主，](http://www.codeproject.com/KB/dotnet/nscript.aspx)它使用框架内的内置类来执行 VB、C# 或 JavaScript 中的脚本。

它使用[CodeDomProvider](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.codedomprovider.aspx)来执行脚本，也可以查看[这篇](http://www.developerfusion.com/article/4529/using-net-to-make-your-application-scriptable/3/)文章以获得更复杂的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T11:34:35.077

[Windows Script Host](http://msdn.microsoft.com/en-us/library/9bbdkx3k.aspx) (WSH) 是一个 Windows 管理工具。您可以使用*PInvoke*从*C#*激活它。识别 MS 特定（和旧）版本的 JavaScript。

WSH 为托管脚本创建环境。也就是说，当脚本到达您的计算机时，WSH 扮演主机的角色——它为脚本提供对象和服务，并提供一组执行脚本的指导方针。除其他外，Windows Script Host 管理安全并调用适当的脚本引擎。

# c# - C#中的双向1对1字典

> ID：268321
> 
> 赞同：105
> 
> 时间：2008-11-06T11:13:30.567
> 
> 标签：c#, .net, collections

我正在寻找 C# (2) 中的通用双向 1 对 1 字典类，即。a`BiDictionaryOneToOne<T, S>`保证只包含每个值和键之一（最多 RefEquals 无论如何），并且可以使用键或值进行搜索。任何人都知道，还是我应该自己实现它？我不敢相信我是第一个需要这个的人...

[这个问题](https://stackoverflow.com/questions/255341/getting-key-of-value-of-a-generic-dictionary)的答案中有一个 BiDictionary ，但它不适用于唯一元素（也没有实现 RemoveByFirst(T t) 或 RemoveBySecond(S s)）。

谢谢！

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-11-06T12:43:36.967

好的，这是我的尝试（建立在乔恩的基础上 - 谢谢），存档在这里并开放改进：

```
/// <summary>
/// This is a dictionary guaranteed to have only one of each value and key. 
/// It may be searched either by TFirst or by TSecond, giving a unique answer because it is 1 to 1.
/// </summary>
/// <typeparam name="TFirst">The type of the "key"</typeparam>
/// <typeparam name="TSecond">The type of the "value"</typeparam>
public class BiDictionaryOneToOne<TFirst, TSecond>
{
    IDictionary<TFirst, TSecond> firstToSecond = new Dictionary<TFirst, TSecond>();
    IDictionary<TSecond, TFirst> secondToFirst = new Dictionary<TSecond, TFirst>();

    #region Exception throwing methods

    /// <summary>
    /// Tries to add the pair to the dictionary.
    /// Throws an exception if either element is already in the dictionary
    /// </summary>
    /// <param name="first"></param>
    /// <param name="second"></param>
    public void Add(TFirst first, TSecond second)
    {
        if (firstToSecond.ContainsKey(first) || secondToFirst.ContainsKey(second))
            throw new ArgumentException("Duplicate first or second");

        firstToSecond.Add(first, second);
        secondToFirst.Add(second, first);
    }

    /// <summary>
    /// Find the TSecond corresponding to the TFirst first
    /// Throws an exception if first is not in the dictionary.
    /// </summary>
    /// <param name="first">the key to search for</param>
    /// <returns>the value corresponding to first</returns>
    public TSecond GetByFirst(TFirst first)
    {
        TSecond second;
        if (!firstToSecond.TryGetValue(first, out second))
            throw new ArgumentException("first");

        return second; 
    }

    /// <summary>
    /// Find the TFirst corresponing to the Second second.
    /// Throws an exception if second is not in the dictionary.
    /// </summary>
    /// <param name="second">the key to search for</param>
    /// <returns>the value corresponding to second</returns>
    public TFirst GetBySecond(TSecond second)
    {
        TFirst first;
        if (!secondToFirst.TryGetValue(second, out first))
            throw new ArgumentException("second");

        return first; 
    }

    /// <summary>
    /// Remove the record containing first.
    /// If first is not in the dictionary, throws an Exception.
    /// </summary>
    /// <param name="first">the key of the record to delete</param>
    public void RemoveByFirst(TFirst first)
    {
        TSecond second;
        if (!firstToSecond.TryGetValue(first, out second))
            throw new ArgumentException("first");

        firstToSecond.Remove(first);
        secondToFirst.Remove(second);
    }

    /// <summary>
    /// Remove the record containing second.
    /// If second is not in the dictionary, throws an Exception.
    /// </summary>
    /// <param name="second">the key of the record to delete</param>
    public void RemoveBySecond(TSecond second)
    {
        TFirst first;
        if (!secondToFirst.TryGetValue(second, out first))
            throw new ArgumentException("second");

        secondToFirst.Remove(second);
        firstToSecond.Remove(first);
    }

    #endregion

    #region Try methods

    /// <summary>
    /// Tries to add the pair to the dictionary.
    /// Returns false if either element is already in the dictionary        
    /// </summary>
    /// <param name="first"></param>
    /// <param name="second"></param>
    /// <returns>true if successfully added, false if either element are already in the dictionary</returns>
    public Boolean TryAdd(TFirst first, TSecond second)
    {
        if (firstToSecond.ContainsKey(first) || secondToFirst.ContainsKey(second))
            return false;

        firstToSecond.Add(first, second);
        secondToFirst.Add(second, first);
        return true;
    }

    /// <summary>
    /// Find the TSecond corresponding to the TFirst first.
    /// Returns false if first is not in the dictionary.
    /// </summary>
    /// <param name="first">the key to search for</param>
    /// <param name="second">the corresponding value</param>
    /// <returns>true if first is in the dictionary, false otherwise</returns>
    public Boolean TryGetByFirst(TFirst first, out TSecond second)
    {
        return firstToSecond.TryGetValue(first, out second);
    }

    /// <summary>
    /// Find the TFirst corresponding to the TSecond second.
    /// Returns false if second is not in the dictionary.
    /// </summary>
    /// <param name="second">the key to search for</param>
    /// <param name="first">the corresponding value</param>
    /// <returns>true if second is in the dictionary, false otherwise</returns>
    public Boolean TryGetBySecond(TSecond second, out TFirst first)
    {
        return secondToFirst.TryGetValue(second, out first);
    }

    /// <summary>
    /// Remove the record containing first, if there is one.
    /// </summary>
    /// <param name="first"></param>
    /// <returns> If first is not in the dictionary, returns false, otherwise true</returns>
    public Boolean TryRemoveByFirst(TFirst first)
    {
        TSecond second;
        if (!firstToSecond.TryGetValue(first, out second))
            return false;

        firstToSecond.Remove(first);
        secondToFirst.Remove(second);
        return true;
    }

    /// <summary>
    /// Remove the record containing second, if there is one.
    /// </summary>
    /// <param name="second"></param>
    /// <returns> If second is not in the dictionary, returns false, otherwise true</returns>
    public Boolean TryRemoveBySecond(TSecond second)
    {
        TFirst first;
        if (!secondToFirst.TryGetValue(second, out first))
            return false;

        secondToFirst.Remove(second);
        firstToSecond.Remove(first);
        return true;
    }

    #endregion        

    /// <summary>
    /// The number of pairs stored in the dictionary
    /// </summary>
    public Int32 Count
    {
        get { return firstToSecond.Count; }
    }

    /// <summary>
    /// Removes all items from the dictionary.
    /// </summary>
    public void Clear()
    {
        firstToSecond.Clear();
        secondToFirst.Clear();
    }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-10T13:56:34.753

一个更完整的双向字典实现：

*   **支持几乎所有**原始接口`Dictionary<TKey,TValue>`（基础设施接口除外）：
    *   `IDictionary<TKey, TValue>`
    *   `IReadOnlyDictionary<TKey, TValue>`
    *   `IDictionary`
    *   `ICollection<KeyValuePair<TKey, TValue>>`（这个和下面是上面那个的基础接口）
    *   `ICollection`
    *   `IReadOnlyCollection<KeyValuePair<TKey, TValue>>`
    *   `IEnumerable<KeyValuePair<TKey, TValue>>`
    *   `IEnumerable`
*   **序列化**使用`SerializableAttribute`.
*   **使用`DebuggerDisplayAttribute`（带有计数信息）和`DebuggerTypeProxyAttribute`（用于在手表中显示键值对）**调试视图。****
***   反向字典可作为`IDictionary<TValue, TKey> Reverse`属性使用，并且还实现了上面提到的所有接口。任一字典上的所有操作都会修改两者。**

 **用法：

```
var dic = new BiDictionary<int, string>();
dic.Add(1, "1");
dic[2] = "2";
dic.Reverse.Add("3", 3);
dic.Reverse["4"] = 4;
dic.Clear(); 
```

我在 GitHub 上的私有框架中提供了代码：[BiDictionary(TFirst,TSecond).cs](https://github.com/Athari/Alba.Framework/blob/master/Alba.Framework/Collections/Collections/BiDictionary(TFirst%2CTSecond).cs)（[永久链接](https://github.com/Athari/Alba.Framework/blob/33cdaf77872d33608edc6b9a0f84f757a6bbcce2/Alba.Framework/Collections/Collections/BiDictionary(TFirst%2CTSecond).cs)、[搜索](https://github.com/Athari/Alba.Framework/search?q=bidictionary&ref=cmdform)）。

复制：

```
[Serializable]
[DebuggerDisplay ("Count = {Count}"), DebuggerTypeProxy (typeof(DictionaryDebugView<,>))]
public class BiDictionary<TFirst, TSecond> : IDictionary<TFirst, TSecond>, IReadOnlyDictionary<TFirst, TSecond>, IDictionary
{
    private readonly IDictionary<TFirst, TSecond> _firstToSecond = new Dictionary<TFirst, TSecond>();
    [NonSerialized]
    private readonly IDictionary<TSecond, TFirst> _secondToFirst = new Dictionary<TSecond, TFirst>();
    [NonSerialized]
    private readonly ReverseDictionary _reverseDictionary;

    public BiDictionary ()
    {
        _reverseDictionary = new ReverseDictionary(this);
    }

    public IDictionary<TSecond, TFirst> Reverse
    {
        get { return _reverseDictionary; }
    }

    public int Count
    {
        get { return _firstToSecond.Count; }
    }

    object ICollection.SyncRoot
    {
        get { return ((ICollection)_firstToSecond).SyncRoot; }
    }

    bool ICollection.IsSynchronized
    {
        get { return ((ICollection)_firstToSecond).IsSynchronized; }
    }

    bool IDictionary.IsFixedSize
    {
        get { return ((IDictionary)_firstToSecond).IsFixedSize; }
    }

    public bool IsReadOnly
    {
        get { return _firstToSecond.IsReadOnly || _secondToFirst.IsReadOnly; }
    }

    public TSecond this [TFirst key]
    {
        get { return _firstToSecond[key]; }
        set
        {
            _firstToSecond[key] = value;
            _secondToFirst[value] = key;
        }
    }

    object IDictionary.this [object key]
    {
        get { return ((IDictionary)_firstToSecond)[key]; }
        set
        {
            ((IDictionary)_firstToSecond)[key] = value;
            ((IDictionary)_secondToFirst)[value] = key;
        }
    }

    public ICollection<TFirst> Keys
    {
        get { return _firstToSecond.Keys; }
    }

    ICollection IDictionary.Keys
    {
        get { return ((IDictionary)_firstToSecond).Keys; }
    }

    IEnumerable<TFirst> IReadOnlyDictionary<TFirst, TSecond>.Keys
    {
        get { return ((IReadOnlyDictionary<TFirst, TSecond>)_firstToSecond).Keys; }
    }

    public ICollection<TSecond> Values
    {
        get { return _firstToSecond.Values; }
    }

    ICollection IDictionary.Values
    {
        get { return ((IDictionary)_firstToSecond).Values; }
    }

    IEnumerable<TSecond> IReadOnlyDictionary<TFirst, TSecond>.Values
    {
        get { return ((IReadOnlyDictionary<TFirst, TSecond>)_firstToSecond).Values; }
    }

    public IEnumerator<KeyValuePair<TFirst, TSecond>> GetEnumerator ()
    {
        return _firstToSecond.GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator ()
    {
        return GetEnumerator();
    }

    IDictionaryEnumerator IDictionary.GetEnumerator ()
    {
        return ((IDictionary)_firstToSecond).GetEnumerator();
    }

    public void Add (TFirst key, TSecond value)
    {
        _firstToSecond.Add(key, value);
        _secondToFirst.Add(value, key);
    }

    void IDictionary.Add (object key, object value)
    {
        ((IDictionary)_firstToSecond).Add(key, value);
        ((IDictionary)_secondToFirst).Add(value, key);
    }

    public void Add (KeyValuePair<TFirst, TSecond> item)
    {
        _firstToSecond.Add(item);
        _secondToFirst.Add(item.Reverse());
    }

    public bool ContainsKey (TFirst key)
    {
        return _firstToSecond.ContainsKey(key);
    }

    public bool Contains (KeyValuePair<TFirst, TSecond> item)
    {
        return _firstToSecond.Contains(item);
    }

    public bool TryGetValue (TFirst key, out TSecond value)
    {
        return _firstToSecond.TryGetValue(key, out value);
    }

    public bool Remove (TFirst key)
    {
        TSecond value;
        if (_firstToSecond.TryGetValue(key, out value)) {
            _firstToSecond.Remove(key);
            _secondToFirst.Remove(value);
            return true;
        }
        else
            return false;
    }

    void IDictionary.Remove (object key)
    {
        var firstToSecond = (IDictionary)_firstToSecond;
        if (!firstToSecond.Contains(key))
            return;
        var value = firstToSecond[key];
        firstToSecond.Remove(key);
        ((IDictionary)_secondToFirst).Remove(value);
    }

    public bool Remove (KeyValuePair<TFirst, TSecond> item)
    {
        return _firstToSecond.Remove(item);
    }

    public bool Contains (object key)
    {
        return ((IDictionary)_firstToSecond).Contains(key);
    }

    public void Clear ()
    {
        _firstToSecond.Clear();
        _secondToFirst.Clear();
    }

    public void CopyTo (KeyValuePair<TFirst, TSecond>[] array, int arrayIndex)
    {
        _firstToSecond.CopyTo(array, arrayIndex);
    }

    void ICollection.CopyTo (Array array, int index)
    {
        ((IDictionary)_firstToSecond).CopyTo(array, index);
    }

    [OnDeserialized]
    internal void OnDeserialized (StreamingContext context)
    {
        _secondToFirst.Clear();
        foreach (var item in _firstToSecond)
            _secondToFirst.Add(item.Value, item.Key);
    }

    private class ReverseDictionary : IDictionary<TSecond, TFirst>, IReadOnlyDictionary<TSecond, TFirst>, IDictionary
    {
        private readonly BiDictionary<TFirst, TSecond> _owner;

        public ReverseDictionary (BiDictionary<TFirst, TSecond> owner)
        {
            _owner = owner;
        }

        public int Count
        {
            get { return _owner._secondToFirst.Count; }
        }

        object ICollection.SyncRoot
        {
            get { return ((ICollection)_owner._secondToFirst).SyncRoot; }
        }

        bool ICollection.IsSynchronized
        {
            get { return ((ICollection)_owner._secondToFirst).IsSynchronized; }
        }

        bool IDictionary.IsFixedSize
        {
            get { return ((IDictionary)_owner._secondToFirst).IsFixedSize; }
        }

        public bool IsReadOnly
        {
            get { return _owner._secondToFirst.IsReadOnly || _owner._firstToSecond.IsReadOnly; }
        }

        public TFirst this [TSecond key]
        {
            get { return _owner._secondToFirst[key]; }
            set
            {
                _owner._secondToFirst[key] = value;
                _owner._firstToSecond[value] = key;
            }
        }

        object IDictionary.this [object key]
        {
            get { return ((IDictionary)_owner._secondToFirst)[key]; }
            set
            {
                ((IDictionary)_owner._secondToFirst)[key] = value;
                ((IDictionary)_owner._firstToSecond)[value] = key;
            }
        }

        public ICollection<TSecond> Keys
        {
            get { return _owner._secondToFirst.Keys; }
        }

        ICollection IDictionary.Keys
        {
            get { return ((IDictionary)_owner._secondToFirst).Keys; }
        }

        IEnumerable<TSecond> IReadOnlyDictionary<TSecond, TFirst>.Keys
        {
            get { return ((IReadOnlyDictionary<TSecond, TFirst>)_owner._secondToFirst).Keys; }
        }

        public ICollection<TFirst> Values
        {
            get { return _owner._secondToFirst.Values; }
        }

        ICollection IDictionary.Values
        {
            get { return ((IDictionary)_owner._secondToFirst).Values; }
        }

        IEnumerable<TFirst> IReadOnlyDictionary<TSecond, TFirst>.Values
        {
            get { return ((IReadOnlyDictionary<TSecond, TFirst>)_owner._secondToFirst).Values; }
        }

        public IEnumerator<KeyValuePair<TSecond, TFirst>> GetEnumerator ()
        {
            return _owner._secondToFirst.GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator ()
        {
            return GetEnumerator();
        }

        IDictionaryEnumerator IDictionary.GetEnumerator ()
        {
            return ((IDictionary)_owner._secondToFirst).GetEnumerator();
        }

        public void Add (TSecond key, TFirst value)
        {
            _owner._secondToFirst.Add(key, value);
            _owner._firstToSecond.Add(value, key);
        }

        void IDictionary.Add (object key, object value)
        {
            ((IDictionary)_owner._secondToFirst).Add(key, value);
            ((IDictionary)_owner._firstToSecond).Add(value, key);
        }

        public void Add (KeyValuePair<TSecond, TFirst> item)
        {
            _owner._secondToFirst.Add(item);
            _owner._firstToSecond.Add(item.Reverse());
        }

        public bool ContainsKey (TSecond key)
        {
            return _owner._secondToFirst.ContainsKey(key);
        }

        public bool Contains (KeyValuePair<TSecond, TFirst> item)
        {
            return _owner._secondToFirst.Contains(item);
        }

        public bool TryGetValue (TSecond key, out TFirst value)
        {
            return _owner._secondToFirst.TryGetValue(key, out value);
        }

        public bool Remove (TSecond key)
        {
            TFirst value;
            if (_owner._secondToFirst.TryGetValue(key, out value)) {
                _owner._secondToFirst.Remove(key);
                _owner._firstToSecond.Remove(value);
                return true;
            }
            else
                return false;
        }

        void IDictionary.Remove (object key)
        {
            var firstToSecond = (IDictionary)_owner._secondToFirst;
            if (!firstToSecond.Contains(key))
                return;
            var value = firstToSecond[key];
            firstToSecond.Remove(key);
            ((IDictionary)_owner._firstToSecond).Remove(value);
        }

        public bool Remove (KeyValuePair<TSecond, TFirst> item)
        {
            return _owner._secondToFirst.Remove(item);
        }

        public bool Contains (object key)
        {
            return ((IDictionary)_owner._secondToFirst).Contains(key);
        }

        public void Clear ()
        {
            _owner._secondToFirst.Clear();
            _owner._firstToSecond.Clear();
        }

        public void CopyTo (KeyValuePair<TSecond, TFirst>[] array, int arrayIndex)
        {
            _owner._secondToFirst.CopyTo(array, arrayIndex);
        }

        void ICollection.CopyTo (Array array, int index)
        {
            ((IDictionary)_owner._secondToFirst).CopyTo(array, index);
        }
    }
}

internal class DictionaryDebugView<TKey, TValue>
{
    private readonly IDictionary<TKey, TValue> _dictionary;

    [DebuggerBrowsable (DebuggerBrowsableState.RootHidden)]
    public KeyValuePair<TKey, TValue>[] Items
    {
        get
        {
            var array = new KeyValuePair<TKey, TValue>[_dictionary.Count];
            _dictionary.CopyTo(array, 0);
            return array;
        }
    }

    public DictionaryDebugView (IDictionary<TKey, TValue> dictionary)
    {
        if (dictionary == null)
            throw new ArgumentNullException("dictionary");
        _dictionary = dictionary;
    }
}

public static class KeyValuePairExts
{
    public static KeyValuePair<TValue, TKey> Reverse<TKey, TValue> (this KeyValuePair<TKey, TValue> @this)
    {
        return new KeyValuePair<TValue, TKey>(@this.Value, @this.Key);
    }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-06T11:18:27.483

[您提到的问题还显示了此答案](https://stackoverflow.com/questions/255341/getting-key-of-value-of-a-generic-dictionary#255630)中的一对一实现。添加 RemoveByFirst 和 RemoveBySecond 将是微不足道的 - 就像实现额外的接口等一样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-06T15:53:32.503

这与公认的答案相同，但我也提供了`Update`方法，并且总体上更加充实：

```
public class BiDictionary<TKey1, TKey2> : IEnumerable<Tuple<TKey1, TKey2>>
{
    Dictionary<TKey1, TKey2> _forwards;
    Dictionary<TKey2, TKey1> _reverses;

    public int Count
    {
        get
        {
            if (_forwards.Count != _reverses.Count)
                throw new Exception("somewhere logic went wrong and your data got corrupt");

            return _forwards.Count;
        }
    }

    public ICollection<TKey1> Key1s
    {
        get { return _forwards.Keys; }
    }

    public ICollection<TKey2> Key2s
    {
        get { return _reverses.Keys; }
    }

    public BiDictionary(IEqualityComparer<TKey1> comparer1 = null, IEqualityComparer<TKey2> comparer2 = null)
    {
        _forwards = new Dictionary<TKey1, TKey2>(comparer1);
        _reverses = new Dictionary<TKey2, TKey1>(comparer2);
    }

    public bool ContainsKey1(TKey1 key)
    {
        return ContainsKey(key, _forwards);
    }

    private static bool ContainsKey<S, T>(S key, Dictionary<S, T> dict)
    {
        return dict.ContainsKey(key);
    }

    public bool ContainsKey2(TKey2 key)
    {
        return ContainsKey(key, _reverses);
    }

    public TKey2 GetValueByKey1(TKey1 key)
    {
        return GetValueByKey(key, _forwards);
    }

    private static T GetValueByKey<S, T>(S key, Dictionary<S, T> dict)
    {
        return dict[key];
    }

    public TKey1 GetValueByKey2(TKey2 key)
    {
        return GetValueByKey(key, _reverses);
    }

    public bool TryGetValueByKey1(TKey1 key, out TKey2 value)
    {
        return TryGetValue(key, _forwards, out value);
    }

    private static bool TryGetValue<S, T>(S key, Dictionary<S, T> dict, out T value)
    {
        return dict.TryGetValue(key, out value);
    }

    public bool TryGetValueByKey2(TKey2 key, out TKey1 value)
    {
        return TryGetValue(key, _reverses, out value);
    }

    public bool Add(TKey1 key1, TKey2 key2)
    {
        if (ContainsKey1(key1) || ContainsKey2(key2))   // very important
            return false;

        AddOrUpdate(key1, key2);
        return true;
    }

    public void AddOrUpdateByKey1(TKey1 key1, TKey2 key2)
    {
        if (!UpdateByKey1(key1, key2))
            AddOrUpdate(key1, key2);
    }

    // dont make this public; a dangerous method used cautiously in this class
    private void AddOrUpdate(TKey1 key1, TKey2 key2)
    {
        _forwards[key1] = key2;
        _reverses[key2] = key1;
    }

    public void AddOrUpdateKeyByKey2(TKey2 key2, TKey1 key1)
    {
        if (!UpdateByKey2(key2, key1))
            AddOrUpdate(key1, key2);
    }

    public bool UpdateKey1(TKey1 oldKey, TKey1 newKey)
    {
        return UpdateKey(oldKey, _forwards, newKey, (key1, key2) => AddOrUpdate(key1, key2));
    }

    private static bool UpdateKey<S, T>(S oldKey, Dictionary<S, T> dict, S newKey, Action<S, T> updater)
    {
        T otherKey;
        if (!TryGetValue(oldKey, dict, out otherKey) || ContainsKey(newKey, dict))
            return false;

        Remove(oldKey, dict);
        updater(newKey, otherKey);
        return true;
    }

    public bool UpdateKey2(TKey2 oldKey, TKey2 newKey)
    {
        return UpdateKey(oldKey, _reverses, newKey, (key1, key2) => AddOrUpdate(key2, key1));
    }

    public bool UpdateByKey1(TKey1 key1, TKey2 key2)
    {
        return UpdateByKey(key1, _forwards, _reverses, key2, (k1, k2) => AddOrUpdate(k1, k2));
    }

    private static bool UpdateByKey<S, T>(S key1, Dictionary<S, T> forwards, Dictionary<T, S> reverses, T key2,
                                          Action<S, T> updater)
    {
        T otherKey;
        if (!TryGetValue(key1, forwards, out otherKey) || ContainsKey(key2, reverses))
            return false;

        if (!Remove(otherKey, reverses))
            throw new Exception("somewhere logic went wrong and your data got corrupt");

        updater(key1, key2);
        return true;
    }

    public bool UpdateByKey2(TKey2 key2, TKey1 key1)
    {
        return UpdateByKey(key2, _reverses, _forwards, key1, (k1, k2) => AddOrUpdate(k2, k1));
    }

    public bool RemoveByKey1(TKey1 key)
    {
        return RemoveByKey(key, _forwards, _reverses);
    }

    private static bool RemoveByKey<S, T>(S key, Dictionary<S, T> keyDict, Dictionary<T, S> valueDict)
    {
        T otherKey;
        if (!TryGetValue(key, keyDict, out otherKey))
            return false;

        if (!Remove(key, keyDict) || !Remove(otherKey, valueDict))
            throw new Exception("somewhere logic went wrong and your data got corrupt");

        return true;
    }

    private static bool Remove<S, T>(S key, Dictionary<S, T> dict)
    {
        return dict.Remove(key);
    }

    public bool RemoveByKey2(TKey2 key)
    {
        return RemoveByKey(key, _reverses, _forwards);
    }

    public void Clear()
    {
        _forwards.Clear();
        _reverses.Clear();
    }

    public IEnumerator<Tuple<TKey1, TKey2>> GetEnumerator()
    {
        if (_forwards.Count != _reverses.Count)
            throw new Exception("somewhere logic went wrong and your data got corrupt");

        foreach (var item in _forwards)
            yield return Tuple.Create(item.Key, item.Value);
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
} 
```

类似于我[在这里的回答](https://stackoverflow.com/a/15852665/661933)

有几点需要注意：

1.  我只实施了`IEnumerable<>`. 我认为`ICollection<>`这里没有意义，因为对于这种特殊的集合结构，方法名称可能都不同。由你决定里面应该放什么`IEnumerable<>`。所以现在你也有了集合初始化语法，比如

    ```
    var p = new BiDictionary<int, string> { 1, "a" }, { 2, "b" } }; 
    ```

2.  我试图在这里和那里抛出一些奇怪的异常 - 只是为了数据完整性。只是为了更安全，以便您知道我的代码是否有错误。

3.  性能：您可以`Value`使用其中任何一个进行查找`Keys`，这意味着`Get`和`Contains`方法只需要 1 次查找 (O(1))。`Add`需要 2 次查找和 2 次添加。`Update`需要 1 次查找和 2 次添加。`Remove`需要 3 次查找。都类似于接受的答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T11:41:51.617

我创建了这样一个类，使用 C5 集合类。

```
public class Mapper<K,T> : IEnumerable<T>

{
    C5.TreeDictionary<K,T> KToTMap = new TreeDictionary<K,T>();
    C5.HashDictionary<T,K> TToKMap = new HashDictionary<T,K>();

    /// <summary>
    /// Initializes a new instance of the Mapper class.
    /// </summary>
    public Mapper()
    {
        KToTMap = new TreeDictionary<K,T>();
        TToKMap = new HashDictionary<T,K>();
    }

    public void Add(K key, T value)
    {
        KToTMap.Add(key, value);
        TToKMap.Add(value, key);
    }

    public bool ContainsKey(K key)
    {
        return KToTMap.Contains(key);
    }

    public int Count
    {
        get { return KToTMap.Count; }
    }

    public K this[T obj]
    {
        get
        {
            return TToKMap[obj];
        }
    }

    public T this[K obj]
    {
        get
        {
            return KToTMap[obj];
        }
    }

    public IEnumerator<T> GetEnumerator()
    {
        return KToTMap.Values.GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return KToTMap.Values.GetEnumerator();
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-03-11T20:28:08.190

已接受答案的另一个扩展。它实现了 IEnumerable，因此可以使用 foreach 。我意识到 IEnumerable 实现有更多答案，但这个使用结构，所以它是**垃圾收集器友好的**。**这在Unity**引擎中特别有用（使用分析器检查）。

```
/// <summary>
/// This is a dictionary guaranteed to have only one of each value and key. 
/// It may be searched either by TFirst or by TSecond, giving a unique answer because it is 1 to 1.
/// It implements garbage-collector-friendly IEnumerable.
/// </summary>
/// <typeparam name="TFirst">The type of the "key"</typeparam>
/// <typeparam name="TSecond">The type of the "value"</typeparam>
public class BiDictionary<TFirst, TSecond> : IEnumerable<BiDictionary<TFirst, TSecond>.Pair>
{

    public struct Pair
    {
        public TFirst  First;
        public TSecond Second;
    }

    public struct Enumerator : IEnumerator<Pair>, IEnumerator
    {

        public Enumerator(Dictionary<TFirst, TSecond>.Enumerator dictEnumerator)
        {
            _dictEnumerator = dictEnumerator;
        }

        public Pair Current
        {
            get
            {
                Pair pair;
                pair.First = _dictEnumerator.Current.Key;
                pair.Second = _dictEnumerator.Current.Value;
                return pair;
            }
        }

        object IEnumerator.Current
        {
            get
            {
                return Current;
            }
        }

        public void Dispose()
        {
            _dictEnumerator.Dispose();
        }

        public bool MoveNext()
        {
            return _dictEnumerator.MoveNext();
        }

        public void Reset()
        {
            throw new NotSupportedException();
        }

        private Dictionary<TFirst, TSecond>.Enumerator _dictEnumerator;

    }

    #region Exception throwing methods

    /// <summary>
    /// Tries to add the pair to the dictionary.
    /// Throws an exception if either element is already in the dictionary
    /// </summary>
    /// <param name="first"></param>
    /// <param name="second"></param>
    public void Add(TFirst first, TSecond second)
    {
        if (_firstToSecond.ContainsKey(first) || _secondToFirst.ContainsKey(second))
            throw new ArgumentException("Duplicate first or second");

        _firstToSecond.Add(first, second);
        _secondToFirst.Add(second, first);
    }

    /// <summary>
    /// Find the TSecond corresponding to the TFirst first
    /// Throws an exception if first is not in the dictionary.
    /// </summary>
    /// <param name="first">the key to search for</param>
    /// <returns>the value corresponding to first</returns>
    public TSecond GetByFirst(TFirst first)
    {
        TSecond second;
        if (!_firstToSecond.TryGetValue(first, out second))
            throw new ArgumentException("first");

        return second;
    }

    /// <summary>
    /// Find the TFirst corresponing to the Second second.
    /// Throws an exception if second is not in the dictionary.
    /// </summary>
    /// <param name="second">the key to search for</param>
    /// <returns>the value corresponding to second</returns>
    public TFirst GetBySecond(TSecond second)
    {
        TFirst first;
        if (!_secondToFirst.TryGetValue(second, out first))
            throw new ArgumentException("second");

        return first;
    }

    /// <summary>
    /// Remove the record containing first.
    /// If first is not in the dictionary, throws an Exception.
    /// </summary>
    /// <param name="first">the key of the record to delete</param>
    public void RemoveByFirst(TFirst first)
    {
        TSecond second;
        if (!_firstToSecond.TryGetValue(first, out second))
            throw new ArgumentException("first");

        _firstToSecond.Remove(first);
        _secondToFirst.Remove(second);
    }

    /// <summary>
    /// Remove the record containing second.
    /// If second is not in the dictionary, throws an Exception.
    /// </summary>
    /// <param name="second">the key of the record to delete</param>
    public void RemoveBySecond(TSecond second)
    {
        TFirst first;
        if (!_secondToFirst.TryGetValue(second, out first))
            throw new ArgumentException("second");

        _secondToFirst.Remove(second);
        _firstToSecond.Remove(first);
    }

    #endregion

    #region Try methods

    /// <summary>
    /// Tries to add the pair to the dictionary.
    /// Returns false if either element is already in the dictionary        
    /// </summary>
    /// <param name="first"></param>
    /// <param name="second"></param>
    /// <returns>true if successfully added, false if either element are already in the dictionary</returns>
    public bool TryAdd(TFirst first, TSecond second)
    {
        if (_firstToSecond.ContainsKey(first) || _secondToFirst.ContainsKey(second))
            return false;

        _firstToSecond.Add(first, second);
        _secondToFirst.Add(second, first);
        return true;
    }

    /// <summary>
    /// Find the TSecond corresponding to the TFirst first.
    /// Returns false if first is not in the dictionary.
    /// </summary>
    /// <param name="first">the key to search for</param>
    /// <param name="second">the corresponding value</param>
    /// <returns>true if first is in the dictionary, false otherwise</returns>
    public bool TryGetByFirst(TFirst first, out TSecond second)
    {
        return _firstToSecond.TryGetValue(first, out second);
    }

    /// <summary>
    /// Find the TFirst corresponding to the TSecond second.
    /// Returns false if second is not in the dictionary.
    /// </summary>
    /// <param name="second">the key to search for</param>
    /// <param name="first">the corresponding value</param>
    /// <returns>true if second is in the dictionary, false otherwise</returns>
    public bool TryGetBySecond(TSecond second, out TFirst first)
    {
        return _secondToFirst.TryGetValue(second, out first);
    }

    /// <summary>
    /// Remove the record containing first, if there is one.
    /// </summary>
    /// <param name="first"></param>
    /// <returns> If first is not in the dictionary, returns false, otherwise true</returns>
    public bool TryRemoveByFirst(TFirst first)
    {
        TSecond second;
        if (!_firstToSecond.TryGetValue(first, out second))
            return false;

        _firstToSecond.Remove(first);
        _secondToFirst.Remove(second);
        return true;
    }

    /// <summary>
    /// Remove the record containing second, if there is one.
    /// </summary>
    /// <param name="second"></param>
    /// <returns> If second is not in the dictionary, returns false, otherwise true</returns>
    public bool TryRemoveBySecond(TSecond second)
    {
        TFirst first;
        if (!_secondToFirst.TryGetValue(second, out first))
            return false;

        _secondToFirst.Remove(second);
        _firstToSecond.Remove(first);
        return true;
    }

    #endregion        

    /// <summary>
    /// The number of pairs stored in the dictionary
    /// </summary>
    public Int32 Count
    {
        get { return _firstToSecond.Count; }
    }

    /// <summary>
    /// Removes all items from the dictionary.
    /// </summary>
    public void Clear()
    {
        _firstToSecond.Clear();
        _secondToFirst.Clear();
    }

    public Enumerator GetEnumerator()
    {
        //enumerator.Reset(firstToSecond.GetEnumerator());
        return new Enumerator(_firstToSecond.GetEnumerator());
    }

    IEnumerator<Pair> IEnumerable<Pair>.GetEnumerator()
    {
        return GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    private Dictionary<TFirst, TSecond> _firstToSecond  = new Dictionary<TFirst, TSecond>();
    private Dictionary<TSecond, TFirst> _secondToFirst  = new Dictionary<TSecond, TFirst>();

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-12T15:17:53.507

有点晚了，但这是我不久前写的一个实现。它处理一些有趣的边缘情况，例如当键覆盖相等检查以执行部分​​相等时。这导致主字典存储`A => 1`但反向存储`1 => A'`。

`Inverse`您可以通过属性访问逆字典。

```
var map = new BidirectionalDictionary<int, int>();
map.Add(1, 2);
var result = map.Inverse[2]; // result is 1 
```

* * *

```
//
// BidirectionalDictionary.cs
//
// Author:
//   Chris Chilvers <chilversc@googlemail.com>
//
// Copyright (c) 2009 Chris Chilvers
//
// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:
//
// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
//

using System;
using System.Collections;
using System.Collections.Generic;

namespace Cadenza.Collections
{
    public class BidirectionalDictionary<TKey, TValue> : IDictionary<TKey, TValue>
    {
        private readonly IEqualityComparer<TKey> keyComparer;
        private readonly IEqualityComparer<TValue> valueComparer;
        private readonly Dictionary<TKey, TValue> keysToValues;
        private readonly Dictionary<TValue, TKey> valuesToKeys;
        private readonly BidirectionalDictionary<TValue, TKey> inverse;

        public BidirectionalDictionary () : this (10, null, null) {}

        public BidirectionalDictionary (int capacity) : this (capacity, null, null) {}

        public BidirectionalDictionary (IEqualityComparer<TKey> keyComparer, IEqualityComparer<TValue> valueComparer)
            : this (10, keyComparer, valueComparer)
        {
        }

        public BidirectionalDictionary (int capacity, IEqualityComparer<TKey> keyComparer, IEqualityComparer<TValue> valueComparer)
        {
            if (capacity < 0)
                throw new ArgumentOutOfRangeException ("capacity", capacity, "capacity cannot be less than 0");

            this.keyComparer = keyComparer ?? EqualityComparer<TKey>.Default;
            this.valueComparer = valueComparer ?? EqualityComparer<TValue>.Default;

            keysToValues = new Dictionary<TKey, TValue> (capacity, this.keyComparer);
            valuesToKeys = new Dictionary<TValue, TKey> (capacity, this.valueComparer);

            inverse = new BidirectionalDictionary<TValue, TKey> (this);
        }

        private BidirectionalDictionary (BidirectionalDictionary<TValue, TKey> inverse)
        {
            this.inverse = inverse;
            keyComparer = inverse.valueComparer;
            valueComparer = inverse.keyComparer;
            valuesToKeys = inverse.keysToValues;
            keysToValues = inverse.valuesToKeys;
        }

        public BidirectionalDictionary<TValue, TKey> Inverse {
            get { return inverse; }
        }

        public ICollection<TKey> Keys {
            get { return keysToValues.Keys; }
        }

        public ICollection<TValue> Values {
            get { return keysToValues.Values; }
        }

        public IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator ()
        {
            return keysToValues.GetEnumerator ();
        }

        IEnumerator IEnumerable.GetEnumerator ()
        {
            return GetEnumerator ();
        }

        void ICollection<KeyValuePair<TKey, TValue>>.CopyTo (KeyValuePair<TKey, TValue>[] array, int arrayIndex)
        {
            ((ICollection<KeyValuePair<TKey, TValue>>) keysToValues).CopyTo (array, arrayIndex);
        }

        public bool ContainsKey (TKey key)
        {
            if (key == null)
                throw new ArgumentNullException ("key");
            return keysToValues.ContainsKey (key);
        }

        public bool ContainsValue (TValue value)
        {
            if (value == null)
                throw new ArgumentNullException ("value");
            return valuesToKeys.ContainsKey (value);
        }

        bool ICollection<KeyValuePair<TKey, TValue>>.Contains (KeyValuePair<TKey, TValue> item)
        {
            return ((ICollection<KeyValuePair<TKey, TValue>>) keysToValues).Contains (item);
        }

        public bool TryGetKey (TValue value, out TKey key)
        {
            if (value == null)
                throw new ArgumentNullException ("value");
            return valuesToKeys.TryGetValue (value, out key);
        }

        public bool TryGetValue (TKey key, out TValue value)
        {
            if (key == null)
                throw new ArgumentNullException ("key");
            return keysToValues.TryGetValue (key, out value);
        }

        public TValue this[TKey key] {
            get { return keysToValues [key]; }
            set {
                if (key == null)
                    throw new ArgumentNullException ("key");
                if (value == null)
                    throw new ArgumentNullException ("value");

                //foo[5] = "bar"; foo[6] = "bar"; should not be valid
                //as it would have to remove foo[5], which is unexpected.
                if (ValueBelongsToOtherKey (key, value))
                    throw new ArgumentException ("Value already exists", "value");

                TValue oldValue;
                if (keysToValues.TryGetValue (key, out oldValue)) {
                    // Use the current key for this value to stay consistent
                    // with Dictionary<TKey, TValue> which does not alter
                    // the key if it exists.
                    TKey oldKey = valuesToKeys [oldValue];

                    keysToValues [oldKey] = value;
                    valuesToKeys.Remove (oldValue);
                    valuesToKeys [value] = oldKey;
                } else {
                    keysToValues [key] = value;
                    valuesToKeys [value] = key;
                }
            }
        }

        public int Count {
            get { return keysToValues.Count; }
        }

        bool ICollection<KeyValuePair<TKey, TValue>>.IsReadOnly {
            get { return false; }
        }

        public void Add (TKey key, TValue value)
        {
            if (key == null)
                throw new ArgumentNullException ("key");
            if (value == null)
                throw new ArgumentNullException ("value");

            if (keysToValues.ContainsKey (key))
                throw new ArgumentException ("Key already exists", "key");
            if (valuesToKeys.ContainsKey (value))
                throw new ArgumentException ("Value already exists", "value");

            keysToValues.Add (key, value);
            valuesToKeys.Add (value, key);
        }

        public void Replace (TKey key, TValue value)
        {
            if (key == null)
                throw new ArgumentNullException ("key");
            if (value == null)
                throw new ArgumentNullException ("value");

            // replaces a key value pair, if the key or value already exists those mappings will be replaced.
            // e.g. you have; a -> b, b -> a; c -> d, d -> c
            // you add the mapping; a -> d, d -> a
            // this will remove both of the original mappings
            Remove (key);
            inverse.Remove (value);
            Add (key, value);
        }

        void ICollection<KeyValuePair<TKey, TValue>>.Add (KeyValuePair<TKey, TValue> item)
        {
            Add (item.Key, item.Value);
        }

        public bool Remove (TKey key)
        {
            if (key == null)
                throw new ArgumentNullException ("key");

            TValue value;
            if (keysToValues.TryGetValue (key, out value)) {
                keysToValues.Remove (key);
                valuesToKeys.Remove (value);
                return true;
            }
            else {
                return false;
            }
        }

        bool ICollection<KeyValuePair<TKey, TValue>>.Remove (KeyValuePair<TKey, TValue> item)
        {
            bool removed = ((ICollection<KeyValuePair<TKey, TValue>>) keysToValues).Remove (item);
            if (removed)
                valuesToKeys.Remove (item.Value);
            return removed;
        }

        public void Clear ()
        {
            keysToValues.Clear ();
            valuesToKeys.Clear ();
        }

        private bool ValueBelongsToOtherKey (TKey key, TValue value)
        {
            TKey otherKey;
            if (valuesToKeys.TryGetValue (value, out otherKey))
                // if the keys are not equal the value belongs to another key
                return !keyComparer.Equals (key, otherKey);
            else
                // value doesn't exist in map, thus it cannot belong to another key
                return false;
        }
    }
} 
```

github上的[原始源](https://github.com/cadenza/cadenza/blob/master/src/Cadenza/Cadenza.Collections/BidirectionalDictionary.cs)和[测试。](https://github.com/cadenza/cadenza/blob/master/src/Cadenza/Test/Cadenza.Collections/BidirectionalDictionaryTest.cs)

# sql-server - SQL Rownumber() Order By 子句中的 Case 语句不适用于 varchar 和 int 值

> ID：268322
> 
> 赞同：0
> 
> 时间：2008-11-06T11:13:37.040
> 
> 标签：sql-server, sql-order-by, row-number

为什么这不起作用？

```
DECLARE @temp table
(ShipNo int,
 Supplier varchar(10)
)

INSERT INTO @temp VALUES (1,'CFA')
INSERT INTO @temp VALUES (1, 'TFA')
INSERT INTO @temp VALUES (2, 'LRA')
INSERT INTO @temp VALUES (2, 'LRB')
INSERT INTO @temp VALUES (3, 'ABC')
INSERT INTO @temp VALUES (4, 'TFA')

Declare @OrderBy varchar(255)
sET @OrderBy = 'Supplier'

SELECT ROW_NUMBER() OVER (ORDER BY 
CASE @OrderBy
 WHEN 'Supplier' THEN Supplier
 WHEN 'ShipNo' THEN ShipNo
END
) AS RowNo,
ShipNo,
Supplier
FROM @temp 
```

但是，如果您在 Case 语句中将 ShipNo 转换为 varchar，它会起作用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-04-30T14:46:54.090

我知道这是旧帖子，但这适用于任何遇到此问题并正在寻找解决方案的人：

```
SELECT ROW_NUMBER() OVER (ORDER BY  
CASE @OrderBy 
 WHEN 'Supplier' THEN Supplier
END
CASE @OrderBy
 WHEN 'ShipNo' THEN ShipNo 
END 
) 
```

基本上，您将每个字段放在自己的情况下。仅当它们的数据类型或字段内的值对于两列都不同或出现错误时才执行此操作，例如

尝试将 int 转换为 varchar 或将 varchar 转换为 int 时转换失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T11:34:44.047

来自在线书籍：

```
CASE
WHEN Boolean_expression THEN result_expression 
    [ ...n ] 
[ 
    ELSE else_result_expression 
] 
END 
```

“else_result_expression 和任何 result_expression 的数据类型必须相同或者必须是隐式转换。”

所以 Supplier 和 ShipNo 必须是相同的数据类型。

# regex - 正则表达式仅返回“链接”标签的“href”属性？

> ID：268338
> 
> 赞同：3
> 
> 时间：2008-11-06T11:21:22.577
> 
> 标签：regex, href, link-tag

我试图制作一个只返回`<link>`标签hrefs的正则表达式

为什么这个正则表达式会返回包括 <a hrefs 在内的所有 hrefs？

```
    (?<=<链接\s+.*?)href\s*=\s*[\'\"][^\'\"]+

```

```
    <link rel="stylesheet" rev="stylesheet"
    href="idlecore-tided.css?T_2_5_0_228" media="screen">
    <a href="anotherurl">斜线框</a>

```

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T11:54:36.427

任何一个

```
/(?<=<link\b[^<>]*?)\bhref=\s*=\s*(?:"[^"]*"|'[^']'|\S+)/ 
```

或者

```
/<link\b[^<>]*?\b(href=\s*=\s*(?:"[^"]*"|'[^']'|\S+))/ 
```

主要区别在于`[^<>]*?`而不是`.*?`. 这是因为您不希望它继续搜索其他标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T12:44:01.413

避免对这种简单的情况进行后视，只需匹配您需要的内容，然后捕获您想要获得的内容。

我`<link\s+[^>]*(href\s*=\s*(['"]).*?\2)`在带有 s 和 g 选项的 Regex Coach 中取得了不错的成绩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T11:30:09.610

```
/(?<=<link\s+.*?)href\s*=\s*[\'\"][^\'\"]+[^>]*>/ 
```

我自己对反向引用有点不稳定，所以我把它留在那里。这个正则表达式虽然：

```
/(<link\s+.*?)href\s*=\s*[\'\"][^\'\"]+[^>]*>/ 
```

...适用于我的 Javascript 测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T11:37:43.590

您使用的是什么正则表达式风格？一方面，Perl 不支持可变长度的lookbehind。如果这是一个选项，我会选择（编辑以实现 MizardX 的非常好的想法）：

```
(?<=<link\b[^<>]*?)href\s*=\s*(['"])(?:(?!\1).)+\1 
```

作为第一近似值。这样，引号字符（'或“）的选择将被匹配。对于不支持（可变长度）lookbehind的语言也是如此：

```
(?:<link\b[^<>]*?)(href\s*=\s*(['"])(?:(?!\2).)+\2) 
```

\1 将包含您的匹配项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T11:38:11.763

```
(?<=<link\s+.*?)href\s*=\s*[\'\"][^\'\"]+ 
```

与[Expresso](http://www.ultrapico.com/Expresso.htm)一起使用（我认为 Expresso 在 .NET 正则表达式引擎上运行）。您甚至可以进一步改进它以匹配关闭`'`或 `"`：

```
(?<=<link\s+.*?)href\s*=\s*([\'\"])[^\'\"]+(\1) 
```

也许您的正则表达式引擎不适用于后向断言。一种解决方法是

```
(?:<link\s+.*?)(href\s*=\s*([\'\"])[^\'\"]+(\2)) 
```

然后，您的比赛将在捕获的第 1 组中。

# c# - C#：谁能给我一个很好的例子来说明如何在运行时锚定控件？

> ID：268344
> 
> 赞同：1
> 
> 时间：2008-11-06T11:24:57.157
> 
> 标签：c#

C#：谁能给我一个很好的例子来说明如何在运行时锚定控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T11:30:09.080

```
 textBox1.Multiline = true;
        textBox1.Anchor = AnchorStyles.Top | AnchorStyles.Right | AnchorStyles.Left | AnchorStyles.Bottom; 
```

然后调整您的表单大小，文本框应该在与表单边缘保持相同距离的同时扩大和缩小

# sql-server - SQL Server 服务在本地计算机上不断停止

> ID：268347
> 
> 赞同：1
> 
> 时间：2008-11-06T11:28:12.953
> 
> 标签：sql-server, windows

我有一些更新或尝试每晚运行的东西，最终导致 SQL Server 服务停止。机器重启后，服务正常重启。如何诊断和修复破坏我的 SQL Server 服务的原因？我在 Vista Business 上运行 SQL 2005。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T11:50:09.460

我们的开发服务器上的 SQL Server 2005 遇到了这个问题。在我们的场景中发生的情况是，运行自动更新的用户帐户不是本地计算机管理员。自动更新在队列中，机器尝试将它们应用到 SQL 2005，能够关闭服务，但在应用补丁失败后从未重新启动它。

这可能不是您的情况，但症状听起来很相似。事件日志条目？（它们是我们的线索；我们用谷歌搜索了这条消息，发现了自动更新。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T11:29:34.510

首先在事件查看器中查看是否有更多关于服务未启动原因的信息，或者查看它何时停止的确切信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T11:55:17.033

检查事件日志和 sql server 错误日志。他们应该为您提供提示或实际错误，以便您修复它。

# asp.net - 如何将 Ajax 添加到我的 ASPnet 页面，以便下拉更改可以立即影响后端数据库

> ID：268357
> 
> 赞同：0
> 
> 时间：2008-11-06T11:30:20.453
> 
> 标签：asp.net, ajax

我在一个普通的 ASP.Net 页面上有几个下拉框。

我希望用户能够更改这些并将页面伪发布回服务器并存储这些更改，而无需用户点击保存按钮。

我真的不需要显示任何其他内容，因为下拉列表本身将反映新值，但我想发布此更改，而不会因回发而使整个页面闪烁

我听说这可以使用 AJAX.Net...

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T13:26:04.900

向您的网站添加对 System.Web.Extensions 和 System.Web.Extensions.Design 的引用。然后在您的页面上放置一个脚本管理器并将您的 ddl 包装在更新面板中。在后端做任何你想做的事。例如...

```
<asp:ScriptManager ID="ScriptManager1" runat="server" />
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
  <ContentTemplate>

<asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="true" OnSelectedIndexChanged="yourDDL_SelectedIndexChanged">
</asp:DropDownList>

  </ContentTemplate>
</asp:UpdatePanel>

protected void yourDDL_SelectedIndexChanged(object sender, EventArgs e)
{
// do whatever you want
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T08:52:01.773

取决于您的 Ajax 框架，Ra-Ajax 在[这里](http://ra-ajax.org/samples/Ajax-DropDownList.aspx)有一个示例......

# svn - AuthzSVNAccessFile 的编码

> ID：268366
> 
> 赞同：3
> 
> 时间：2008-11-06T11:34:39.900
> 
> 标签：svn, apache

我有一个包含非 ASCII 字符路径的存储库（latin1）

我在使用包含这些路径的授权文件时遇到问题。

你知道哪个编码应该是 AuthzSVNAccessFile 吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T13:51:54.303

查看颠覆源代码，您似乎应该使用 utf-8 作为 authz 文件的编码。

# java - JBI 和 SCA 之间有什么区别/相似之处

> ID：268370
> 
> 赞同：0
> 
> 时间：2008-11-06T11:36:45.603
> 
> 标签：java, soa, jbi, sca

能否指出一些好的链接，或分享 JBI 和 SCA 规范之间的差异/相似之处的经验？

非常感谢 ：-）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T11:42:41.550

这篇文章可以提供一个答案的开头（尽管它没有详细说明规格）

[OSOA 文章](http://www.osoa.org/display/Main/Relationship+of+SCA+and+JBI)

> SCA 允许使用多种技术来实现服务（例如Java、BPEL、C++）和用于与服务通信的多种绑定（例如Web 服务或JMS）。但是，SCA 没有描述如何将新的实现类型或新的绑定引入运行时。这正是 JBI 的目标所在。
> 
> JBI 是一个 Java 平台集成“微内核”标准，它提供了一个开放的架构来支持多供应商 Java 复合应用平台工具和基础设施。它定义了一组服务提供者接口，供中间件提供者在他们想要将新的服务引擎（对应于 SCA 的实现类型）或绑定组件（对应于 SCA 的绑定）安装到符合 JBI 的运行时中时实现。

您可以在本文中找到快速反馈和一些反应： [SCA 和 JBI，两全其美？](http://www.infoq.com/news/2008/05/sca-jbi-together).

# java - JPA - map entity to sql query?

> ID：268375
> 
> 赞同：0
> 
> 时间：2008-11-06T11:38:53.463
> 
> 标签：java, jpa

I'm writing a JPA connector to a legacy sistem. The problem is, DB design in the system is.. well.. horrible.

I need to implement an entity that maps to three tables. I can do it using named sql queries, but the probem is, I have to use this entity in a OneToMany relation (this entity is on the many side). So how do I tell JPA it needs to use a specific named query with specific parameter?

And a subquestion: does any1 have any good on-line JPA documentation? I can't find anything decent :-/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T19:35:11.677

我实际上还没有找到用 JPA 做到这一点的方法。为了解决这样的问题，我最终使用了命名查询。

就文档而言，我一直在使用[TopLink](http://www.oracle.com/technology/products/ias/toplink/jpa/resources/toplink-jpa-annotations.html)和[Hibernate 的](http://www.hibernate.org/hib_docs/annotations/reference/en/html_single/#entity-mapping "休眠 JPA 文档").

如果您找到更好的方法，请在此处发布！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-12T18:28:41.343

看看@SecondaryTable(s)。[Pro EJB 3 Java Peristance API](http://books.google.com/books?id=fVCuB_Xq3pAC&printsec=frontcover#v=onepage&q=&f=false) book, page 237中有一些例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T20:17:23.823

您能否制作一个数据库视图，然后创建一个映射到该视图的实体？我不知道这是否可能，只是一个想法。

# c# - 使用 SMO 复制数据库和数据

> ID：268381
> 
> 赞同：22
> 
> 时间：2008-11-06T11:42:12.783
> 
> 标签：c#, .net, sql-server-2008, smo

我正在尝试将数据库复制到同一服务器上的新数据库中。服务器是我在 Windows XP 下运行 SQL 2008 Express 的本地计算机。使用 SMO.Transfer 类应该很容易做到这一点，而且它几乎可以工作！

我的代码如下（有些简化）：

```
Server server = new Server("server");
Database sourceDatabase = server.Databases["source database"];

Database newDatbase = new Database(server, "new name");
newDatbase.Create();

Transfer transfer = new Transfer(sourceDatabase);
transfer.CopyAllObjects = true;
transfer.Options.WithDependencies = true;
transfer.DestinationDatabase = newDatbase.Name;
transfer.CopySchema = true;
transfer.CopyData = true;
StringCollection transferScript = transfer.ScriptTransfer();

using (SqlConnection conn = new SqlConnection(connectionString))
{
    conn.Open();
    using (SqlCommand switchDatabase = new SqlCommand("USE " + newDatbase.Name, conn))
    {
        switchDatabase.ExecuteNonQuery();
    }

    foreach (string scriptLine in transferScript)
    {
        using (SqlCommand scriptCmd = new SqlCommand(scriptLine, conn, transaction))
        {
            int res = scriptCmd.ExecuteNonQuery();
        }
    }
} 
```

我在这里所做的是首先创建一个新数据库，然后使用`Transfer`该类生成一个复制脚本，最后在新数据库中运行该脚本。

这适用于复制结构，但该`CopyData`选项不起作用！

该选项是否有任何未记录的限制`CopyData`？文档只说该选项指定是否复制数据。

我尝试使用该`TransferData()`方法在不使用脚本的情况下复制数据库，但随后出现“无法连接到服务器”的异常，内部异常显示“在建立与SQL Server。未找到或无法访问服务器。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供程序：命名管道提供程序，错误：40 - 无法打开与 SQL Server 的连接)"

我还尝试在服务器上启用命名管道，但这没有帮助。

编辑：我找到了一个解决方案，可以通过备份然后将其恢复到新数据库来工作。虽然它很笨拙，而且比它应该的要慢，所以我仍在寻找更好的解决方案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-26T14:28:42.577

好吧，在联系了 Microsft 支持后，我得到了它的正常工作，但它很慢而且或多或少没用。进行备份然后恢复要快得多，只要新副本与原始副本位于同一服务器上，我就会使用它。

工作代码如下：

```
ServerConnection conn = new ServerConnection("rune\\sql2008");
Server server = new Server(conn);

Database newdb = new Database(server, "new database");
newdb.Create();

Transfer transfer = new Transfer(server.Databases["source database"]);
transfer.CopyAllObjects = true;
transfer.CopyAllUsers = true;
transfer.Options.WithDependencies = true;
transfer.DestinationDatabase = newdb.Name;
transfer.DestinationServer = server.Name;
transfer.DestinationLoginSecure = true;
transfer.CopySchema = true;
transfer.CopyData = true;
transfer.Options.ContinueScriptingOnError = true;
transfer.TransferData(); 
```

诀窍是设置 DestinationDatabase 属性。即使目标与源相同，也必须设置此项。此外，我必须作为命名实例连接到服务器，而不是使用其他连接选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-18T13:25:35.397

我试着让这个工作，并想出了一个不使用 Transfer 类的答案。这是我使用的方法：

```
 public bool CreateScript(string oldDatabase, string newDatabase)
   {
       SqlConnection conn = new SqlConnection("Data Source=.;Initial Catalog=" + newDatabase + ";User Id=sa;Password=sa;");
       try
       {
           Server sv = new Server();
           Database db = sv.Databases[oldDatabase];

           Database newDatbase = new Database(sv, newDatabase);
           newDatbase.Create(); 

           ScriptingOptions options = new ScriptingOptions();
           StringBuilder sb = new StringBuilder();
           options.ScriptData = true;
           options.ScriptDrops = false;
           options.ScriptSchema = true;
           options.EnforceScriptingOptions = true;
           options.Indexes = true;
           options.IncludeHeaders = true;
           options.WithDependencies = true;

           TableCollection tables = db.Tables;

           conn.Open();
           foreach (Table mytable in tables)
           {
               foreach (string line in db.Tables[mytable.Name].EnumScript(options))
               {
                   sb.Append(line + "\r\n");
               }
           }
           string[] splitter = new string[] { "\r\nGO\r\n" };
           string[] commandTexts = sb.ToString().Split(splitter, StringSplitOptions.RemoveEmptyEntries);
           foreach (string command in commandTexts)
           {
               SqlCommand comm = new SqlCommand(command, conn);
               comm.ExecuteNonQuery();
           }
           return true;
       }
       catch (Exception e)
       {
           System.Diagnostics.Debug.WriteLine("PROGRAM FAILED: " + e.Message);
           return false;
       }
       finally
       {
           conn.Close();
       }
   } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-23T06:07:04.387

尝试在**Server**对象上将[**SetDefaultInitFields**](http://msdn.microsoft.com/en-us/library/ms210363.aspx)设置为 true 。

 **SMO 数据库对象运行缓慢时遇到了同样的问题。我猜这是因为 sql server 不喜欢一次检索整个对象和集合，而是延迟加载所有内容，导致每个字段往返，这对于整个数据库来说效率很低。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-08T14:22:52.303

这是我的解决方案：

1.  我有一个名为 Olddatabase 的数据库
2.  我将它备份到 E:\databackup\Old.bak

3.  如果您想在同一服务器中创建一个名为 NewDatabase 的 Olddatabase 重复数据库

3.1 可以在查询工具中使用命令：EXEC OldDatabase.dbo.sp_helpfile；如果您想将 NewDatabase 保存在同一文件夹中，则确定 OldDatabase 的路径。

或者您可以将 NewDatabase 保存在您想要的新路径中

1.  在查询工具中使用此命令

    RESTORE DATABASE NewDatabase FROM DISK = 'E:\databackup\Old.bak' WITH MOVE 'OldDatabase' TO 'E:\New path (or the same path)\NewDatabase_Data.mdf', MOVE 'OldDatabase_log' TO 'E:\New路径（或相同路径）\NewDatabase_Log.ldf';

注意：您可以在 c# 中使用这些命令：在 sql 中创建一个包含上述命令的存储过程。您可以在 C# 中调用存储过程

# sql-server - T-SQL 中的 PRINT 语句

> ID：268384
> 
> 赞同：79
> 
> 时间：2008-11-06T11:43:09.227
> 
> 标签：sql-server, tsql

为什么 T-SQL 中的 PRINT 语句似乎只在某些时候起作用？使用它有什么限制？有时，如果生成一个结果集，它似乎会变成一个空函数，我假设是为了防止损坏结果集，但它的输出是否可以不在另一个结果集中输出，例如行数？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2008-11-06T11:58:47.027

所以，如果你有类似下面的声明，你是说你没有得到“打印”结果？

```
从系统对象中选择 *
PRINT '刚刚从 sysobjects 中选择 *'
```

如果您使用 SQL 查询分析器，您会看到底部有两个选项卡，其中之一是“消息”，这就是“打印”语句将显示的位置。
如果您担心看到打印语句的*时间*，您可能想尝试使用类似的东西

```
raiserror ('My Print Statement', 10,1) with nowait
```

这将在到达语句时立即为您提供消息，而不是像查询分析器在大多数情况下所做的那样缓冲输出。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-11-06T19:40:20.870

TSQL 中的 Print 语句是一个被误解的生物，可能是因为它的名字。它实际上将消息发送到错误/消息处理机制，然后将其传输到调用应用程序。打印非常愚蠢。您只能发送 8000 个字符（4000 个 unicode 字符）。您可以发送文字字符串、字符串变量（varchar 或 char）或字符串表达式。如果您使用 RAISERROR，那么您只能使用 2,044 个字符的字符串。但是，使用它向调用应用程序发送信息要容易得多，因为它调用了一个类似于标准 C 库中旧 printf 的格式化函数。除了文本消息之外，RAISERROR 还可以指定错误号、严重性和状态代码，还可以用于返回使用 sp_addmessage 系统存储过程创建的用户定义消息。

尽管消息和错误非常相似，但您的错误处理例程对于接收消息没有任何好处。当然，该技术会根据您连接到数据库的实际方式（OLBC、OLEDB 等）而有所不同。为了接收和处理来自 SQL Server 数据库引擎的消息，当您使用 System.Data.SQLClient 时，您需要创建一个 SqlInfoMessageEventHandler 委托，标识处理事件的方法，以侦听 InfoMessage 事件在 SqlConnection 类上。您会发现诸如严重性和状态之类的消息上下文信息作为参数传递给回调，因为从系统的角度来看，这些消息就像错误一样。

即使您只是假脱机到一个文件，在您的应用程序中获取这些消息总是一个好主意，因为当您试图解决一个非常模糊的问题时，它们总是有用的。但是，我不希望最终用户看到它们，除非您可以保留在应用程序中显示内容的信息级别。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2010-05-28T12:39:31.220

查询分析器缓冲消息。PRINT 和 RAISERROR 语句都使用此缓冲区，但 RAISERROR 语句具有 WITH NOWAIT 选项。要立即打印消息，请使用以下命令：

```
RAISERROR ('Your message', 0, 1) WITH NOWAIT 
```

RAISERROR 将只显示 400 个字符的消息，并使用类似于 C printf 函数的语法来格式化文本。

请注意，使用带有 WITH NOWAIT 选项的 RAISERROR 将刷新消息缓冲区，因此也将输出所有先前缓冲的信息。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-06-22T19:24:30.827

我最近遇到了这个问题，最终是因为我在一个空变量上有一个转换语句。由于这会导致错误，因此整个 print 语句都呈现为 null，并且根本不打印。

示例 - 这将失败：

```
declare @myID int=null
print 'First Statement: ' + convert(varchar(4), @myID) 
```

示例 - 这将打印：

```
declare @myID int=null
print 'Second Statement: ' +  coalesce(Convert(varchar(4), @myID),'@myID is null') 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-03-30T20:51:22.483

为了其他阅读这个问题的人的利益，他们的输出中确实缺少打印语句，实际上存在打印执行但未返回给客户端的情况。我不能具体告诉你它们是什么。我可以告诉你，如果你在任何 print 语句之前和之后放置一个 go 语句，你会看到它是否被执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-19T19:51:12.657

您是否输出了与这些打印语句相关的变量？如果是这样，我发现如果变量没有值，则不会输出打印语句。

# .net - Can I use Visual Studio Snippets to generate SQL code

> ID：268391
> 
> 赞同：2
> 
> 时间：2008-11-06T11:46:53.540
> 
> 标签：.net, visual-studio

I want to use Visual Studio snippets to generate SQL code, for example we have standard naming conventions for foreign keys etc and it would be great if I could just expand a snippet in my SQL script file.

However as far as I can tell the only languages that are supported by the Snippet manager are C#, VB J# and XML

[http://msdn.microsoft.com/en-gb/library/ms171421(VS.80).aspx](http://msdn.microsoft.com/en-gb/library/ms171421(VS.80).aspx)

Does anyone know of a way to have a snippet expand to SQL?

Derek

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T12:02:46.207

I would recommend you consider using [T4](http://blog.wekeroad.com/blog/make-visual-studio-generate-your-repository/), which is built into Visual Studio.

Oleg has great examples, including one for [stored procedures](http://www.olegsych.com/2008/01/how-to-use-t4-to-generate-crud-stored-procedures/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-23T07:27:28.953

Visual Studio 2010 增加了对 SQL 片段的支持。

[您可以在此 MSDN 页面上](http://msdn.microsoft.com/en-us/library/ee362022.aspx)阅读有关它们的更多信息

# c# - 默认值初始化字段是多余的

> ID：268393
> 
> 赞同：13
> 
> 时间：2008-11-06T11:47:28.577
> 
> 标签：c#

我可以真正信任 .NET 来初始化字段（如整数、结构等）吗？如果我仍然想初始化这些字段怎么办 - 可能会产生什么影响？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T11:58:00.867

[C# 规范](http://www.ecma-international.org/publications/standards/Ecma-334.htm)在p.305 (17.4.4)

> 字段的初始值，无论是静态字段还是实例字段，都是字段类型的默认值（第 12.2 节）。在默认初始化发生之前不可能观察到字段的值，因此字段永远不会“未初始化”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-06T11:49:28.900

是的，您可以真正信任 .NET 将字段初始化为其默认值。明确地这样做基本上没有任何影响。（这里有一个小警告：如果您显式初始化静态字段，那么通过反射再次运行类型初始化程序的任何人最终都会重新初始化这些字段。不过，这是一个真正的极端情况！）

在你的特定代码库中做任何能提高可读性的事情。

# asp.net - ASP Tabpanel 仅在一个选项卡上回发

> ID：268414
> 
> 赞同：0
> 
> 时间：2008-11-06T11:57:05.000
> 
> 标签：asp.net, calendar, tabpage

我在第 4 个选项卡上有一个带有日历控件的选项卡，但是当我选择一个日期时，回发会导致选项卡面板返回到第一个选项卡，而不是它来自的第 4 个选项卡。有没有办法让它返回到日历控件所在的选项卡而不是恢复到第一个选项卡？

我知道在 TabContainer 上将 autoPostback 设置为 true 会执行此操作，但这意味着它会在每个选项卡更改时重新加载，而不仅仅是我想要的。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T12:09:08.660

将第四个选项卡的内容包装在 UpdatePanel 控件中应该可以解决问题。

```
<ajaxToolkit:TabPanel runat="server" ID="tabCS" HeaderText="Country Settings">
  <ContentTemplate>
    <asp:UpdatePanel runat="server" ID="upCountry" UpdateMode="Conditional">
      <ContentTemplate>

          ... content and calendar

       </ContentTemplate>
    </asp:UpdatePanel>
  </ContentTemplate>
</ajaxToolkit:TabPanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T01:16:45.590

这是我发现的最佳实践。

除非选项卡面板中的其他选项卡需要更新，否则只需将每个面板的内容放在更新面板中。如果您需要更新其他面板，您可以以编程方式调用该方法来更新它们。

这有两个很好的理由： 1.) 通过将更新面板放在选项卡中，您将从服务器返回的位更少。2.) 以编程方式调用更新方法使您更加了解您为最终用户提供的是什么，并且您不会忘记更新数据。

请记住，如果您使用多个面板将更新模式从始终更改为有条件的，那么只有相关信息会在客户端上更新。

此外，如果您想将整个选项卡面板控件放入更新面板中，您可能需要添加对 CSS 文件执行的任何格式设置，因为我的经验是它无法在更新时保留默认格式设置。

如果您需要更多信息或代码示例，请给我发消息。

安德鲁

# .net - 如何将文本值标签更改为 cdata 部分

> ID：268418
> 
> 赞同：0
> 
> 时间：2008-11-06T11:58:05.203
> 
> 标签：.net, xml

我通过将数据集绑定到 XMLDocument 对象来生成基于数据集的 XMLDocument，然后在 vb.net 中将其显示给用户。我有一个要求，其中某些标签包含 cdata 部分而不是文本值。生成 XMLDocument 后，如何仅将某些标记更改为 cdata 部分并保持其他所有内容不变？或者有没有办法在绑定自身时进行修改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T00:00:46.500

您可以使用“XmlDocument.CreateCDataSection(string)”方法。首先在每个文本字符串中搜索“<”或“>”字符——或完整标签“”（如果已知）——然后使用适当的方法输出数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T12:09:42.510

文本部分和 CDATA 之间没有区别，除了在其中引用字符的方式。使用数据的解析器不会看到差异。您确定需要创建 CDATA 部分吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T12:25:35.833

实际上，我们使用 CDATA 部分的原因是输出文本中包含某些 HTML 格式字符串。当它被当作纯文本时，解析器将把它当作 XMl 元素。例如。

我需要显示为

```
"<tag><![CDATA[Sample HTML tag <head> ]]> </tag>" 
```

# asp.net - asp.net IFrame 滚动条推到顶部。.

> ID：268421
> 
> 赞同：2
> 
> 时间：2008-11-06T12:00:12.093
> 
> 标签：asp.net, javascript, html, iframe, scroll

这是一个棘手的问题。.

我有一个网页（称为 PageA），它有一个标题，然后只包含一个 iframe。让我们在 iframe PageB 中调用页面。PageB 只是有一堆缩略图，但有很多，所以你必须在 PageA 上向下滚动才能查看它们。

当我向下滚动到 pageB 的底部并单击缩略图时，它看起来像是将我带到了一个空白页面。实际发生的情况是它会显示图像，但由于只是图像的页面高度要短得多，因此滚动条会停留在同一位置并且不会针对它进行调整。我必须向上滚动到页面顶部才能查看图片。

无论如何，当我单击 iframe 内页面上的链接时，外部页面滚动条会回到顶部

谢谢，阿克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-08T19:00:21.930

@mek 在尝试了各种方法后，我找到的最佳解决方案是：

在外页中，定义一个滚动条函数：

```
<script type="text/javascript">
  function gotop() {
    scroll(0,0);
  } 
</script> 
```

然后，当您定义 iframe 时，设置一个 onload 处理程序（每次加载 iframe 源时触发，即每当您导航到 iframe 中的新页面时）

```
<iframe id="myframe" 
    onload="try { gotop() } catch (e) {}" 
    src="http://yourframesource"
    width="100%" height="999"
    scrolling="auto" marginwidth="0" marginheight="0" 
    frameborder="0" vspace="0" hspace="0" >
</iframe> 
```

这种方法的好处是它意味着您不需要对 iframe 中包含的页面进行任何更改（并且 iframe 内容可以很高兴地位于另一个域中 - 没有跨站点脚本问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:55:58.377

Javascript 是你最好的选择。您可以使用[scroll() 方法](http://www.java2s.com/Code/JavaScriptReference/Javascript-Methods/scrollSyntaxParametersandNote.htm)向上滚动到 IFRAME 的顶部。在正文加载中添加一个 javascript 处理程序，以便每次单击缩略图时，调用一个调用 scroll() 的函数来向上滚动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-14T05:34:29.523

我花了相当多的时间试图弄清楚如何从我正在调用的 PHP 代码中（从父 ASP.NET 页面中）滚动到 iframe 的顶部。我从来没有想过我可以使用相同的 javascript 滚动到顶部，但在 iframe 的 onload 事件中。谢谢！

# asp.net - ASP.Net 验证

> ID：268422
> 
> 赞同：0
> 
> 时间：2008-11-06T12:01:04.930
> 
> 标签：asp.net, types, validation

我想验证用户在文本框中输入的值，以便它只输入浮点数。我对范围不感兴趣。我怎么能做到这一点，同时考虑文化本地化信息（例如“。”或“，”作为分隔符）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T12:17:16.507

我常用的方法是使用带有验证表达式的 RegexValidator `^(\d+(\.\d*)?)|(\d*(\.\d+))$`。您可以修改它以启用“。” 或“，” `^(\d+([\.,]\d*)?)|(\d*([\.,]\d+))$`：。

如果您想严格正确，您将为每种文化启用正确的验证表达式。

另请注意，如果该值是强制性的，您仍然需要一个 RequiredFieldValidator。

# windows - 何时以及为什么应该将数据存储在 Windows 注册表中？

> ID：268424
> 
> 赞同：133
> 
> 时间：2008-11-06T12:03:06.487
> 
> 标签：windows, registry

作为开发人员，在注册表中存储配置/选项的工具是我生活的祸根。我无法轻松跟踪对这些选项的更改，无法轻松地将它们从一台机器移植到另一台机器，这一切都让我非常渴望 .INI 文件的美好时光......

在编写我自己的应用程序时，我应该选择将什么（如果有的话）放入注册表而不是老式的配置文件，为什么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-11-06T12:33:30.013

*   最初（WIN3）的配置存储在windows目录下的WIN.INI文件中。
*   问题：WIN.INI 变得太大。
*   解决方案（Win31）：与程序在同一目录中的单个 INI 文件。
*   问题：该程序可能安装在网络上并由许多人共享。
*   解决方案(Win311)：用户Window目录下的个别INI文件。
*   问题：很多人可能共享一个windows文件夹，无论如何它应该是只读的。
*   解决方案 (Win95)：每个用户都有单独的部分的注册表。
*   问题：注册表变得太大。
*   解决方案 (WinXP)：将大块的单个数据移动到用户自己的应用程序数据文件夹中。
*   问题：适用于大量数据，但对于少量数据则相当复杂。
*   解决方案 (.NET)：将少量固定的只读数据存储在与应用程序相同的文件夹中的 .config (Xml) 文件中，并使用 API 来读取它。（读/写或用户特定数据保留在注册表中）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-06T12:17:39.453

从用户的角度和程序员的角度来看，我不得不说将某些内容放入注册表中确实没有一个好的借口，除非它是文件关联或机器特定设置之类的东西。

我来自一个思想流派，它说一个程序应该可以从安装它的任何地方运行，安装应该在一台机器内完全移动，甚至可以移动到另一台机器而不影响它的运行。

任何可配置的选项或所需的 dll 等，如果它们不共享，则应位于安装目录的子目录中，以便轻松移动整个安装。

我使用了很多较小的实用程序，例如程序，所以如果它不能安装在 USB 记忆棒上并插入另一台机器并运行，那么它不适合我。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-26T04:48:00.673

**什么时候**- 由于遗留集成或者因为您的客户的系统管理员说“应该这样”或者因为您正在使用更旧的语言进行开发，这使得使用 XML 变得更加困难，您被迫这样做。

**为什么**- 主要是因为注册表不像复制位于应用程序旁边的配置文件那样可移植（并且调用几乎相同）。

如果您使用的是 .Net2+，则您有 App.Config 和 User.Config 文件，并且您不需要在注册表中注册 DLL，因此请远离它。

配置文件有其自身的问题（见下文），但可以围绕这些问题进行编码，并且您可以更改您的架构。

*   问题：应用程序需要可配置的设置。
*   解决方案：将设置存储在 Windows 文件夹中的文件 (WIN.INI) 中 - 使用节标题对数据进行分组 (Win3.0)。
*   问题：WIN.INI 文件变得太大（并且变得凌乱）。
*   解决方案：将设置存储在与应用程序相同的文件夹中的 INI 文件中（Win3.1）。
*   问题：需要用户特定的设置。
*   解决方案：将用户设置存储在用户Window 目录(Win3.11) 中用户特定INI 文件中或应用程序INI 文件中用户特定部分中。
*   问题：安全性 - 一些应用程序设置需要是只读的。
*   解决方案：具有安全性的注册表以及用户特定和机器范围的部分（Win95）。
*   问题：注册表变得太大。
*   解决方案：用户特定的注册表移动到用户自己的“应用程序数据”文件夹中的 user.dat，并且仅在登录时加载 (WinNT)。
*   问题：在大型企业环境中，您登录多台机器并且必须设置每台机器。
*   解决方案：区分本地（本地设置）和漫游（应用程序数据）配置文件 (WinXP)。
*   问题：无法像 .Net 的其他部分一样 xcopy 部署或移动应用程序。
*   解决方案：APP.CONFIG XML文件在与应用程序相同的文件夹中 - 易于阅读，易于操作，易于移动，如果更改可以跟踪（.Net1）。
*   问题：仍然需要以类似（即xcopy deploy）的方式存储用户特定的数据。
*   解决方案：用户本地或漫游文件夹中的 USER.CONFIG XML 文件和强类型 (.Net2)。
*   问题：CONFIG 文件区分大小写（对人类来说不直观），需要非常具体的打开/关闭“标签”，无法在运行时设置连接字符串，安装项目无法写入设置（像注册表一样容易），无法轻松确定user.config 文件和用户设置随着每个新版本的安装而被破坏。
*   解决方案：使用 ITEM 成员在运行时设置连接字符串，在 Installer 类中编写代码以在安装期间更改 App.Config，如果未找到用户设置，则使用应用程序设置作为默认设置。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-06T12:10:48.983

微软政策：

*   在 Windows 95 之前，我们使用 ini 文件存储应用程序数据。
*   在windows 95 - XP 时代，我们使用了注册表。
*   从 Windows Vista 开始，我们使用 ini 文件，尽管它们现在是基于 xml 的。

注册表依赖于机器。我从来不喜欢它，因为它变慢了，几乎不可能找到你需要的东西。这就是为什么我喜欢简单的 ini 或其他设置文件。您知道它们在哪里（应用程序文件夹或用户文件夹），因此它们易于携带且易于阅读。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-06T13:28:20.277

如果您在 Windows 注册表中存储一些窗口位置和最近使用的项目列表，世界会结束吗？到目前为止，它对我来说还不错。

HKEY-CURRENT-USER 是存储少量用户数据的好地方。这就是它的用途。仅仅因为其他人滥用了它而不将其用于预期目的似乎很愚蠢。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-06T12:48:22.760

注册表读取和写入是线程安全的，但文件不是。所以这取决于你的程序是否是单线程的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-06T12:04:43.723

您希望在用户的漫游配置文件中可用的设置可能应该放在注册表中，除非您真的想要手动查找用户的应用程序数据文件夹。:-)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-06T12:16:37.677

如果您正在开发一个新应用程序并且您关心可移植性，那么您不应该**将**数据存储在 Windows 注册表中，因为其他操作系统没有（Windows）注册表（duh note - 这可能很明显，但经常被忽视）。

如果你只是为 Win 平台开发......尽量避免它。配置文件（可能加密）是一种更好的解决方案。将数据存储到注册表中没有任何好处 - （例如，如果您使用的是 .NET，隔离存储是一个更好的解决方案）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-06T12:48:43.027

有点跑题了，但是因为我看到人们关心可移植性，所以我用过的最好的方法是 Qt 的 QSettings 类。它抽象了设置的存储（Windows 上的注册表、Mac OS 上的 XML 首选项文件和 Unix 上的 Ini 文件）。作为该课程的客户，我不必花费脑力思考注册表或其他任何事情，它就可以正常工作（tm）。

[http://doc.trolltech.com/4.4/qsettings.html#details](http://doc.trolltech.com/4.4/qsettings.html#details)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T12:12:04.690

通常，如果您不将设置放入注册表，则主要使用它来获取当前的 Windows 设置、更改文件关联等。
现在，如果您需要检测您的软件是否已安装，您可以在注册表中进行最少的条目，这是您可以在任何配置中找到的位置。或在应用程序数据中搜索给定名称的文件夹。

如果我查看我的 Document and Settings 文件夹，我会看到很多使用 Unix 点符号来设置文件夹的软件： .p4qt .sqlworkbench .squirrel-sql .SunDownloadManager .xngr .antexplorer .assistant .CodeBlocks .dbvis .gimp-2.4 .jdictionary .jindent .jogl_ext （等）

在应用程序数据中，具有编辑器名称或软件名称的各种文件夹。看起来像是当前的趋势，至少在便携式应用程序中...
WinMerge 使用稍微不同的方法，将数据存储在注册表中，但在配置对话框中提供导入和导出选项。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T12:55:10.157

我相信 Windows 注册表是一个好主意，但是由于应用程序开发人员的大量滥用以及 Microsoft 不鼓励/强制执行的标准策略，它变成了一个无法管理的野兽。由于您提到的原因，我讨厌使用它，但是在某些情况下使用它是有意义的：

*   卸载应用程序后留下应用程序的痕迹（例如，记住用户的偏好，以防再次安装应用程序）
*   在不同的应用程序之间共享配置设置 - 组件

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T13:51:32.977

我个人使用注册表来存储安装路径以供（卸载）安装脚本使用。我不确定这是否是唯一可能的选择，但似乎是一个明智的解决方案。当然，这是针对仅在 Windows 上使用的应用程序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-29T20:00:21.937

在 .NET 中确实不需要。

下面是 2 个示例，展示了如何使用 Project 属性来执行此操作。

这些示例通过 Windows 用户项目属性执行此操作，但应用程序也可以/可以执行相同操作。

更多在这里：

[http://code.msdn.microsoft.com/TheNotifyIconExample](http://code.msdn.microsoft.com/TheNotifyIconExample)

[http://code.msdn.microsoft.com/SEHE](http://code.msdn.microsoft.com/SEHE)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-25T15:31:44.337

（讨论晚了，但是）简短的回答：组策略。

如果您客户的 IT 部门想要强制执行与 Windows 或您正在编写或捆绑的组件相关的设置，例如链接速度、自定义错误消息或要连接的数据库服务器，这通常仍然是通过组策略完成，这使其最终表现为存储在注册表中的设置。从 Windows 启动或用户登录时开始执行此类策略。

有一些工具可以创建自定义 ADMX 模板，这些模板可以将您的组件设置映射到注册表位置，并为管理员提供一个通用界面来执行他需要执行的策略，同时仅向他们显示那些对以这种方式执行有意义的设置。

# eclipse - How can I reference ANT HOME from the libraries in the properties of a project when using eclipse?

> ID：268425
> 
> 赞同：3
> 
> 时间：2008-11-06T12:03:34.630
> 
> 标签：eclipse, eclipse-3.4

In our code base we have a dependency on the ant version used in eclipse.

In the the ant.jar has been set up as a library which the project uses

This is a pain when moving versions of eclipse as the Ant plugin folder name changes (although I see it is now just called Ant1.7)

Is there a way to access eclipses reference to ANT Home which appears in the workspace preferences so that I don't have to explicitly set a variable that has the hard coded path to the ant plugins folder

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T00:37:19.790

首先，您的项目不应该依赖于 eclipse 的 Ant 版本，您应该保留自己的版本，以便将您的项目与 eclipse 解耦。如果开发人员或您自己决定使用 IntelliJ 怎么办？

虽然我不知道你的项目的性质是什么，但我认为所有依赖项都应该添加到你的项目 lib 目录或类似的东西中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-26T22:49:23.580

~~您的蚂蚁之家位于 ${ant.home} 属性中~~

例如：

```
<echo> ${ant.home} </echo> 
```

在我的机器上提供以下内容：

```
 [echo]  D:\java\eclipse_3.4_jee\plugins\org.apache.ant_1.7.0.v200803061910 
```

 ~~* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T12:27:27.343

One possible suggestion would be to :

*   transform your project into a plugin project (properties on your project / PDE tools / convert Project to Plug-in Projects...) and
*   add to its dependencies the 'ant' required plugin.

That would be easier to manage when you change the version of eclipse.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T04:46:00.973

您是否考虑过单独安装 Ant，创建环境变量，然后通过 Ant build.xml 中的 ANT_HOME 环境变量引用该位置？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-26T08:56:08.817

在 Eclipse 中，在包资源管理器视图中，右键单击特定项目并构建路径。

移动到库选项卡并选择“添加变量...”按钮。从这里你会看到 JDK 系统库路径，maven（如果你正在使用它，tomcat，eetc...） 如果 ANT_HOME 没有出现，你可以通过单击配置变量来添加它...按钮。从这一刻起，ANT_HOME 路径将被考虑在项目的构建路径中。

希望能帮助到你。

卡洛斯

# c# - 如何在运行时向方法添加属性？

> ID：268426
> 
> 赞同：14
> 
> 时间：2008-11-06T12:03:36.720
> 
> 标签：c#, reflection, attributes, reflection.emit

我们使用 Microsoft.Practices.CompositeUI.EventBroker 在我们的应用程序中处理事件订阅和发布。可行的方法是向事件添加一个属性，指定一个主题名称，如下所示：

```
[EventPublication("example", PublicationScope.Global)]
public event EventHandler Example; 
```

然后向处理程序添加另一个属性，具有相同的主题名称，如下所示：

```
[EventSubscription("example", ThreadOption.Publisher)]
public void OnExample(object sender, EventArgs e)
{
    ...
} 
```

然后你将你的对象传递给一个匹配所有东西的 EventInspector。

我们需要对此进行调试，因此我们正在尝试创建一个订阅*所有*事件的调试类。我可以获得所有主题名称的列表......但仅限于运行时。因此，在将调试对象传递给 EventInspector 之前，我需要能够在运行时向方法添加属性。

如何在运行时向方法添加属性？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T12:52:30.617

您要实现的目标非常复杂，因此我将尝试提供一些东西来帮助您入门。这就是我认为你需要结合起来才能实现的目标：

1.  定义一个抽象类`AbstractEventDebugger`，使用`Search`搜索所有`event`成员的方法，并将它们注册到 EventInspector。此外，定义一个方法`IdentifyEvent`，允许您识别调用它的事件（这取决于您 - 将具有哪些参数等）。
2.  定义一个继承自您的类的`dynamic type`using `TypeBuilder`（如此[处所述）。](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.aspx)此类将是您的`debugger`对象的类。
3.  `Reflection.Emit.MethodBuilder`使用（参见[此处](http://msdn.microsoft.com/en-us/library/system.reflection.emit.methodbuilder.aspx)）将处理程序附加到您的类，这将从`IdentifyEvent`父类调用方法，并且，
4.  `Reflection.Emit`使用`CustomAttributeBuilder`类的处理程序上的属性（请参见[此处](http://msdn.microsoft.com/en-us/library/system.reflection.emit.customattributebuilder.aspx)）。
5.  创建您的`dynamic`类的实例并将其发送到 EventInspector。
6.  燃烧起来;动起来`:)`

[这](http://blogs.msdn.com/joelpob/archive/2004/03/31/105282.aspx)是一个关于如何创建调用某物的方法的示例（实际上它是经典的“Hello world”）。

你需要做很多调整才能把它做好，但你会学到很多关于反射的知识。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T12:21:59.507

属性是一个编译时特性（除非您正在处理 ComponentModel - 但我怀疑它正在使用反射）。因此，您不能在运行时添加属性。这将是一个类似于“如何在运行时向类型添加额外的方法？”的问题。在常规 C#/.NET（DLR 之前）中，您不能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T12:24:46.613

您需要深入了解[`DynamicMethod`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.dynamicmethod.aspx). 但是，由于您需要了解 MSIL，我真的建议您认真考虑您的架构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T13:43:35.940

EventInspector 使用 EventTopics（存储在 WorkItem 中）来完成所有繁重的工作。每个 EventTopic 对象都可以访问一个名为

Microsoft.Practices.CompositeUI.EventBroker.EventTopic

您可以在 app.config 文件中启用，如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.diagnostics>
        <switches>
            <add name="Microsoft.Practices.CompositeUI.EventBroker.EventTopic" value="All" />
        </switches>
    </system.diagnostics>
</configuration> 
```

这应该会使大量有用的消息路由到 Visual Studio 中的调试窗口。如果你想超越 VS 调试窗口，你有很多选择。我建议查看以下文章：

[使用 TraceSource 进行代码检测 My Persoanl Vade Mecum](http://weblogs.asp.net/ralfw/archive/2007/10/31/code-instrumentation-with-tracesource-my-personal-vade-mecum.aspx)

# graphics - Direct3D：没有对角线的线框

> ID：268428
> 
> 赞同：1
> 
> 时间：2008-11-06T12:03:56.033
> 
> 标签：graphics, directx, direct3d, wireframe

在 Direct3D 中使用线框填充模式时，所有矩形面都会显示一条对角线，因为该面被分成两个三角形。如何消除这条线？我还想删除隐藏的表面。线框模式不这样做。

我需要在等距线框视图中显示 Direct3D 模型。渲染的场景必须显示模型面的边界，但必须排除对角线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T12:13:11.350

摆脱对角线很棘手，因为硬件可能只绘制三角形，并且很难确定哪条边是对角线。或者，您可以应用线框纹理（或生成合适纹理的着色器）。这将解决隐藏线问题，但看起来很奇怪，因为线的粗细取决于 z 距离。

使用线图元并非易事，尽管可以轻松移除背对相机的表面，但部分遮挡的表面需要手动裁剪。作为最后的想法，做一个两遍的方法——第一遍绘制填充的多边形，但只绘制到 z 缓冲区，然后用合适的 z 偏差在顶部绘制线条。这将处理部分模糊的表面问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:02:13.783

内置线框模式渲染图元的边缘。与在 D3D 中一样，图元是三角形（或线，或点 - 但不是任意多边形），这意味着内置方式不会切割它。

我想你必须查找某种“边缘检测”算法。这些可以在图像空间中运行，您将模型渲染为纹理，为每个逻辑多边形分配唯一的颜色，然后使用像素着色器进行后处理并检测颜色的任何变化（颜色变化 = 输出黑色，否则输出其他内容）。

或者，您可以构建一个仅包含您需要的边缘的行列表并仅渲染它们。

另一种选择是在 Direct3D 10 中使用几何着色器。不知何故，这里有很多不同的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T20:30:40.363

我认为你需要手动绘制这些线，因为线框模式是一种内置模式，所以我认为你不能修改它。您可以获取网格中的顶点列表，并将它们处理成您需要绘制的线列表。

# sql - 按别名分组 (Oracle)

> ID：268429
> 
> 赞同：37
> 
> 时间：2008-11-06T12:04:11.133
> 
> 标签：sql, oracle

如何使用别名对查询进行“分组”，例如：

```
select count(*), (select * from....) as alias_column 
from table 
group by alias_column 
```

我收到 'alias_column' : INVALID_IDENTIFIER 错误消息。为什么？如何对这个查询进行分组？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-06T12:11:04.257

```
select
  count(count_col),
  alias_column
from
  (
  select 
    count_col, 
    (select value from....) as alias_column 
  from 
    table
  ) as inline
group by 
  alias_column 
```

如果您在 GROUP BY 子句中重复相应的表达式，分组通常会起作用。只提及别名是不可能的，因为 SELECT 步骤是执行查询的最后一步，分组发生在更早的时候，当时还没有定义别名。

要对子查询的结果进行 GROUP BY，您将不得不绕道而行并使用嵌套查询，如上所示。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T12:20:39.977

使用别名列嵌套查询：

```
select count(*), alias_column
from
( select empno, (select deptno from emp where emp.empno = e.empno) as alias_column
  from emp e
)
group by alias_column; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T12:27:18.857

```
select count(*), (select * from....) as alias_column 
from table 
group by (select * from....) 
```

在 Oracle 中，您不能在 group by 子句中使用别名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-19T18:12:09.833

要在 Oracle 中使用别名，您需要确保在使用别名时您的查询已经定义了别名。

最直接的方法是简单地将原始查询视为子查询——在这种情况下，

```
select count(*), (select * from....) as alias_column 
from table 
group by (select * from....) 
```

变成

```
select count, alias_column 
from
  (select count(*) as count, (select * from....) as alias_column 
  from table)
group by alias_column 
```

我无法谈论性能影响，但是如果您尝试在查询中重新使用别名，那么编写起来非常快 - 将所有内容放在括号中并提升一个级别......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-05-09T18:57:14.800

如果您不必使用别名，您可以这样做：

```
select  
EXTRACT(year from CURRENT_DATE), count(*) from something
group by EXTRACT(year from CURRENT_DATE)
order by EXTRACT(year from CURRENT_DATE) 
```

而不是使用别名和子查询。

# asp.net - 通过母版页上的 ScriptManager 使用 ScriptCombining

> ID：268432
> 
> 赞同：1
> 
> 时间：2008-11-06T12:05:21.117
> 
> 标签：asp.net, .net-3.5, asp.net-ajax, scriptmanager

ASP.NET 3.5 SP1 向 ScriptManager 对象添加了一个很棒的新 ScriptCombining 功能，如[本视频所示](http://www.asp.net/learn/3.5-SP1/video-296.aspx?wwwaspnetrdirset=1)。但是，他仅在同一页面上演示了如何将该功能与 ScriptManager 一起使用。我想在脚本管理器位于母版页上的站点上使用此功能，但不知道如何以编程方式将每个页面所需的脚本添加到管理器中。我发现[这篇文章](http://seejoelprogram.wordpress.com/2008/08/19/net-35-sp1-doesnt-provide-composite-script-registration-from-an-iscriptcontrol-out-of-the-box/)可以作为起点，但我并没有真正走得太远。谁能帮帮我？

谢谢，丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:33:16.963

试一试：

```
 ScriptReference SRef = new ScriptReference();
    SRef.Path = "~/Scripts/Script.js";

    ScriptManager.GetCurrent(Page).CompositeScript.Scripts.Add(SRef); 
```

这将获取当前的脚本管理器（即使它位于母版页上）并添加对 CompositeScript 属性的脚本引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-07T04:50:07.083

您也可以使用[ScriptManagerProxy](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanagerproxy.aspx)在标记中执行此操作。

您可以将 ScriptManager 添加到母版页，例如

```
<asp:ScriptManager ID="ScriptManager" runat="server">
    <CompositeScript>
    <Scripts>
        <asp:ScriptReference name="WebForms.js" assembly="System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        <asp:ScriptReference name="MicrosoftAjax.js" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <asp:ScriptReference name="MicrosoftAjaxWebForms.js" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    </Scripts>
    </CompositeScript>
</asp:ScriptManager> 
```

然后将 ScriptManagerProxy 添加到内容页面，例如

```
<asp:Content ID="HomeContent" ContentPlaceHolderID="PlaceHolder" runat="Server">
    <asp:ScriptManagerProxy runat="server">
        <CompositeScript>
        <Scripts>
            <asp:ScriptReference Path="~/yourscript.js" />
        </Scripts>
        </CompositeScript>
    </asp:ScriptManagerProxy> 
```

# c# - 在 C# 中漂亮地打印 DateTime 值

> ID：268444
> 
> 赞同：5
> 
> 时间：2008-11-06T12:09:57.957
> 
> 标签：c#, datetime, pretty-print

我希望有人已经找到了这样做的方法，或者已经存在一个库。这是一件很好的事情，但暂时没有必要。

我正在寻找的功能类似于[datejs](http://www.datejs.com/)的反向功能。

谢谢，

西蒙。

* * *

谢谢，使用类似 dddd 示例可能是提高可用性的良好开端。我对这个问题思考得越多，它就越依赖于所使用的值。我专门处理文档的一系列带时间戳的版本，因此它们很有可能会被聚集在一起。如果您在过去五分钟内保存了 3 次，今天就不会那么热了。

如果我想出一些东西，我会与社区分享。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T12:37:47.057

实际上，您真正想要的是自定义日期时间格式字符串：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4(VS.71).aspx)

```
DateTime.Now.ToString("ggyyyy$dd-MMM (dddd)") 
```

如果这是您想要的，将返回“AD2008$06-Nov (Thursday)”。

为了获得更接近 datejs 的内容（“in forward”），您可以在`DateTime.ParseExact()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T12:14:13.860

[http://msdn.microsoft.com/en-us/library/az4se3k1(VS.71).aspx](http://msdn.microsoft.com/en-us/library/az4se3k1(VS.71).aspx)应该让你上路，

# build-process - 我的构建过程中的自动 BizTalk 版本控制

> ID：268450
> 
> 赞同：2
> 
> 时间：2008-11-06T12:12:35.033
> 
> 标签：build-process, biztalk

在我的所有其他 .net 应用程序中，我的构建过程（nant 和自定义任务的混合）在调用 msbuild 之前使用当前构建号自动更新 [AssemblyVersionAttribute] AssemblyInfo.cs，并在版本号中标记构建号。

我现在正在处理我的第一个 BizTalk 项目，我想对 BizTalk 程序集的版本号做同样的事情，但我遇到了麻烦！

首先，aseembly 版本号存储在 btproj 文件中，所以我进行了一些谷歌搜索，发现 www.codeplex.com/biztalk 看起来像是我的问题的答案，但还有一个更深层次的问题！

我有一个用于我的模式的项目和另一个用于我的管道的项目，管道项目引用我的模式项目，因为我有一个平面文件 dis/assemblers。当我更新版本号时出现问题，因为即使从 Visual Studio 中更新它们也不会更新对架构的管道组件引用。

因此，如果我在 VS IDE 中手动将所有版本号从 1.0.0.0 更新到 1.1.0.0，构建将失败，因为管道组件平面文件 dis/assemblers 仍然引用旧的 1.0.0.0 版本的模式！他们不会自动更新！

这真的是在属性页中更新 BizTalk 项目的版本号，然后构建项目并在引用它们的所有管道组件的属性中手动更新对它们的引用的手动过程吗？

这意味着我不能让我的构建过程控制我的版本号的构建号部分！

或者是否有更好的方法来管理 BizTalk 程序集的版本号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:11:11.580

很抱歉让你失望了，但我一直在走我不得不放弃的那条路。我想有可能实现它，但它需要对绑定文件和其他 XML 文件进行大量更改（如您所提到的，如果您已经发布了服务等，甚至更多）。

也许可以将所有这些必要的更改包装在构建步骤（MSBuild 步骤或其他构建框架中的类似步骤）中 - 这将***很有用！***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-26T14:07:47.127

开发人员-:)

我们遇到了类似的问题，我们最终开发了一个小实用程序，它可以相应地更改所有项目中的版本号，即 *.csproj (asssemblyinfo.cs)、*.btproj。除此之外，它将使用新版本的模式打开和修改 *.btp 文件。简而言之，您所要做的就是在 VS.net 工具菜单中配置此实用程序并执行它。

我想在任何.net 语言中开发这样的实用程序都不是很困难。

警告：不要忘记在更新后使用与最初相同的编码保存文件。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T15:04:33.453

心灰意冷，觉得可能是这样。在更改版本号时更新引用时，BizTalk 2009 项目可能会更好地发挥作用。

我开始手动完成并自动化它，当我意识到需要做什么时，当我意识到我必须修改多少地方才能让它工作时，我退后了一步。感谢上帝撤消结帐。

我的项目中确实包含一个标准 C# 类库（各种辅助函数），我可以在构建过程中更新它的版本号，所以我基本上使用那个程序集来对整个应用程序进行版本控制。如果有人想知道任何环境中的版本，请查看该程序集的版本号。

不理想，但它正在工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T13:30:58.090

我们已经在我们的项目上成功地做到了这一点——我会看看我是否可以让工具的开发人员发布详细信息......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-24T15:34:18.683

当您将依赖组件的最新版本作为文件引用（此处为架构）执行集成构建时，就会出现此问题。

请记住，升级程序集版本必须始终手动执行，这样您始终负责对程序集版本的更改。

解决 buildbreaks 问题的一种可能的解决方案是对依赖组件构建的特定版本而不是最新版本的文件引用，并使用 subst 驱动器和复制脚本来获取最新的组件构建。

例如：

SchemaA，程序集版本 1.0.0.0 PipelineA（以 pipelinecomponent XMLValidator 为例），程序集版本 1.0.0.0

PipelineA 有一个对子驱动器（比如 R 驱动器，映射到工作区 D:\MyComponents）和 SchemaA 版本 1.0.0.0 的文件引用，如下所示：

R:\SchemaA\1.0.0.0\SchemaA.dll。

复制脚本将 SchemaA 的构建输出本地复制到您的 R 驱动器。

当架构 A 更新到版本 1.1.0.0 时，您没有任何问题，因为您仍然使用版本 1.0.0.0 并且您可以选择使用架构的 1.1.0.0 版本。当您想要升级时，您必须更改您的复制脚本并将文件引用替换为 R:\SchemaA\1.1.0.0\SchemaA.dll。

# requirements - Good tool to collect issues, improvements, ideas

> ID：268458
> 
> 赞同：6
> 
> 时间：2008-11-06T12:14:39.490
> 
> 标签：requirements

I need a tool for collecting feedback and new ideas inside our company regarding our internal IS product. The problem is the acceptance level for such a tool.
Most of our colleagues are not IT oriented, so a solution like BugZilla or Jira is way to complicated for them to use. You need to create an account, take care of a lot of parameters before submission, new ideas about new software doesn't really fit well in these tools, etc...

So, here are my requirements:

*   No login need, or optional.
*   Few fields to enter.
*   If possible a WYSIWYG editor for the main description field.
*   Web based or E-mail based (we use outlook internaly).
*   Free (as a beer).
*   Not too chaotic (a Wiki is not an option)

I've take a look at uservoice (of course), it's really a nice tool for experienced people, but too complex for my target users.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T17:51:46.367

您正在寻求的反馈是否可以通过问卷收集？有许多免费的解决方案可以为您提供非常易于使用的调查表，如果没有应用，它也相对容易实施。

我也不明白为什么 wiki 不是一个好的解决方案，但关于 Outlook，您可以进行简单的投票（批准/拒绝）（是/否）：

请参阅：http: [//www.microsoft.com/atwork/worktogether/forms.mspx](http://www.microsoft.com/atwork/worktogether/forms.mspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T12:37:12.877

如果实际使用该工具的障碍应该是最小的，那么*收集*反馈的最佳方式可能是使用电子邮件地址。每个人都知道如何使用该系统，因此几乎没有障碍。*无论如何*，提供的反馈必须由开发人员/管理层处理，以便决定将采取哪些具体行动。然后，开发人员可以使用最适合他们的任何系统来跟踪错误、立即需要的功能、可以稍后实现的不错的功能等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T12:27:09.293

Microsoft's Exchange server has support for Public Folders, email lists/groups. This may be an easy introduction to collaboration for your environment, using tools that are familiar. From the Microsoft Help on Public Folders:

> Public folders are an easy and effective way to collect, organize, and share information with other people in your workgroup or organization. You can use public folders to share files or post information on an electronic bulletin board.

I'm not sure how effective the tools for managing those "lists" are - I'm not sure if you can mark responses such that all users see the mark, for example.

But it is probably a good start. As people start to see the value of collaboration, something along the lines of a Wiki becomes more appealing.

I've got to say that [Confluence](http://www.atlassian.com/software/confluence/), especially now that editing with Open Office or Microsoft Office tools is possible really deserves a look. Not free (as in beer).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T18:51:18.783

一些“缺陷跟踪工具”可以处理这个问题。

不要因为“缺陷跟踪”而投反对票。其中一些工具是企业级的，用于处理事件、请求、需求等。而且，您可以将错误和增强请求集中到一个地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T15:23:29.327

Uservoice 有什么太复杂的地方？主 UI 是一个问题（“我建议你……”）。您的用户可以是匿名的，一个字段可以输入，基于网络，对小用户免费。似乎勾选了除可视编辑器之外的所有框。即使管理它也不是很棘手。（我将它用于我的 iPhone 应用程序。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T12:16:49.223

我认为本地托管的 php-bb（或其他...）论坛将是一个不错的选择，因为您可以对其进行审核，并拥有人们可以在复制建议之前检查的常见问题解答和历史记录。所以，这是一个简单的电子邮件地址的优势，它有一个简单的、已知的界面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T15:28:11.250

看起来您正面临一个非常标准的权衡 - 您希望您的反馈是结构化的，但您不希望对您的用户施加任何影响。

你不能一边吃蛋糕一边吃。为什么 wiki 不在桌面上？Wiki 旨在平衡这种权衡。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-06T14:13:03.200

嗯，我发现我们也将 InfoPath 作为我们工具集的一部分。我从来没有使用过它，但也许它可以完成这项工作。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-06T12:17:56.487

How about using for example Google groups? I've found a mailing list works quite well for this kind of purpose.

Edit: or how about [http://getsatisfaction.com/](http://getsatisfaction.com/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-06T12:35:30.697

您可以使用 Google Documents 创建共享电子表格。您的使用将需要 Google 帐户，但他们只需要登录一次，cookie 会记住它们以供下次使用。

# javascript - 如何打开新标签并更改当前页面

> ID：268464
> 
> 赞同：2
> 
> 时间：2008-11-06T12:17:02.263
> 
> 标签：javascript

```
<form id="frm_1" name="frm_1" target="_self" method="GET" action="local_page.php" >
</form>
<form id="tgt_1" name="tgt_1" target="_blank" method="POST" action="http://stackoverflow.com/" >
</form>
<a onclick="test(event, '1'); " href="#" >Click Here</a>
<script>
    function test(event, id){
        document.getElementById("frm_"+id).submit;
        document.getElementById("tgt_"+id).submit;
    }
</script> 
```

是否可以打开一个新选项卡/窗口并更改当前页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T12:21:24.453

据我所知，一次提交两份表格是不可能的。但是，既然您使用的是 PHP，为什么不看看[cURL](http://au2.php.net/manual/en/book.curl.php)库呢？它允许您发送 POST 和 GET 请求并在 PHP 中解析结果。

要回答标题中的问题，如果您只是想一键打开两个页面，您可以这样做（请原谅内联javascript）：

```
<a
    href="http://www.google.com"
    target="_blank"
    onclick="document.location.href='http://www.yahoo.com'"
>Click here to open Google in a new window and yahoo in this window</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:17:37.837

```
<form id="frm_1" name="frm_1" target="_self" method="POST" action="local_page.php" >
<input type="hidden" name="vital_param" value="<?= $something ?>">
</form>

<form id="tgt_1" name="tgt_1" target="_blank" method="POST" action="http://stackoverflow.com/" >
</form>

<button type="submit" onclick="test(event, '1'); " >Click Here</button>

<script>
    function test(event, id){
    window.open( document.getElementById("tgt_"+id).action, "_blank");
    setTimeout('document.getElementById("frm_'+id+'").submit();', 1000);

    return true;
    }
</script> 
```

tgt 作为目标 url 的来源，可以是数组或属性。没有 setyTimeout() 浏览器停留在当前页面 (FF/IE)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T12:30:10.643

您应该使用 window.open 打开新页面，然后提交 tabchange 例如

```
<form id="frm_1" name="frm_1" target="_self" method="GET" action="local_page.php" >
</form>
<a onclick="test(event, '1'); " href="#" >Click Here</a>
<script>
    function test(event, id){
        window.open("http://stackoverflow.com/", "_blank");
        document.getElementById("tgt_"+id).submit();
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T12:50:26.580

使用表单元素上的“目标”属性使它们提交给例如。新窗口或 iframe，无需重新加载当前页面（破坏任何其他表单提交）。

您的 a.onclick 还应该返回 false 以停止跟踪 href 链接。真的，这应该是一个按钮而不是一个链接。

除非您有特定的充分理由，否则请避免此类事情。根据您实际尝试做的事情，通常会有更好的方法。

# asp.net - 更改 ASP.NET 缓存项过期的频率？

> ID：268468
> 
> 赞同：13
> 
> 时间：2008-11-06T12:18:04.537
> 
> 标签：asp.net, caching

我注意到 ASP.NET 缓存项每 20 秒检查一次（并且可能会被删除）（奇怪的是，每次在 HH:MM:00、HH:MM:20 和 HH:MM:40 时都足够奇怪）。我花了大约 15 分钟寻找如何更改此参数，但没有成功。我还尝试在 web.config 中设置以下内容，但没有帮助：

```
<cache privateBytesPollTime="00:00:05" /> 
```

我不想做任何疯狂的事情，但如果它是 5 秒而不是 20 秒，或者对于我的应用程序来说至少 10 秒，那就太好了。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-06T21:32:32.360

用反射器四处寻找表明间隔是硬编码的。到期由内部`CacheExpires`类处理，其静态构造函数包含

```
_tsPerBucket = new TimeSpan(0, 0, 20); 
```

`_tsPerBucket`是`readonly`，因此以后不能有任何配置设置对其进行修改。

`CacheExpires.EnableExpirationTimer()`然后在...中设置将触发检查过期项目的计时器

```
DateTime utcNow = DateTime.UtcNow;
TimeSpan span = _tsPerBucket - new TimeSpan(utcNow.Ticks % _tsPerBucket.Ticks);
this._timer = new Timer(new TimerCallback(this.TimerCallback), null,
    span.Ticks / 0x2710L, _tsPerBucket.Ticks / 0x2710L); 
```

的计算`span`确保计时器在 :00, :20, :40 秒时准确触发，尽管我看不出有任何打扰的理由。计时器调用的方法是`internal`，所以我认为没有任何方法可以设置自己的计时器来更频繁地调用它（忽略反射）。

然而，好消息是你不应该真的有任何理由关心间隔。`Cache.Get()`检查该项目是否未过期，如果已过期，则立即从缓存中删除该项目并返回`null`. 因此，您永远不会从缓存中获取过期项目，即使过期项目可能会在缓存中停留长达 20 秒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T16:40:41.233

根据[文档](http://msdn.microsoft.com/en-us/library/system.web.configuration.cachesection.privatebytespolltime.aspx)，privateBytesPollTime 用于“工作进程内存使用”，默认为 1 秒。我不认为这与缓存项删除有关。

我确实使用项目删除回调确认了您的结果 - 看起来项目在分钟的底部被删除，:20 和:40 秒。这表明项目可能会在缓存中保留长达 20 秒，超过对它们设置的 AbsoluteExpiration。我找不到任何说明是否可以更改 20 秒轮询间隔的文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-01T15:27:45.747

疯狂但有效的解决方案（需要所有步骤）：

```
// New value for cache expiration cycle
// System.Web.Caching.CacheExpires._tsPerBucket;
// Set 1 seconds instead of 20sec
const string assembly = "System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a";
var type = Type.GetType("System.Web.Caching.CacheExpires, " + assembly, true, true);
var field = type.GetField("_tsPerBucket", BindingFlags.Static | BindingFlags.NonPublic);
field.SetValue(null, TimeSpan.FromSeconds(1));

// Recreate cache
// HttpRuntime._theRuntime._cacheInternal = null;
// HttpRuntime._theRuntime._cachePublic = null;
type = typeof (HttpRuntime);
field = type.GetField("_theRuntime", BindingFlags.Static | BindingFlags.NonPublic);
var runtime = field.GetValue(null);
field = type.GetField("_cachePublic", BindingFlags.NonPublic | BindingFlags.Instance);
field.SetValue(runtime, null);
field = type.GetField("_cacheInternal", BindingFlags.NonPublic | BindingFlags.Instance);
field.SetValue(runtime, null); 
```

# html - 文章页面中的 H1 - 网站标题或文章标题？

> ID：268475
> 
> 赞同：58
> 
> 时间：2008-11-06T12:20:44.720
> 
> 标签：html, usability, accessibility, semantics

在面向文章的页面（例如博客文章）中，`<h1>`元素（1 级标题）通常用于标记：

*   博客标题（即页面顶部的通常较大的站点标题，而*不是*`<title>`元素），或者
*   文章标题

什么是最好的选择，为什么？

对于可能想向全世界喊出他们的网站/博客名称的网站所有者来说，在网站标题周围使用 1 级标题似乎是有意义的。

从您尝试向用户传达的内容的角度来看，网站标题的相关性较低 - 文章内容是您尝试传达的内容，所有其他网站内容都是次要的。因此使用`<h1>`文章标题似乎最好。

我觉得`<h1>`元素应该关注文章标题，而不是网站标题或其他内容。无论如何，这似乎不是一个流行的约定。

例子：

*   [Joel Spolsky](http://joelonsoftware.com/)用于`<h1>`文章标题，以及网站标题的锚点
*   [Jeff Atwood](http://codinghorror.com/)*根本*不使用*no`<h1>`*，`<h2>`作为文章标题和锚点作为站点标题
*   [37 Signals 的 SVN](http://37signals.com/svn/)用于`<h1>`网站标题和文章标题的锚点

这是跨三个站点的三种不同方法，您可能期望在这些站点中强烈考虑正确的语义标记。

我认为乔尔和杰夫紧随其后。我对 37Signals 人员的标记选择感到非常惊讶。

对我来说，这似乎是一个非常简单的决定：与文章的消费者最相关的是什么？文章标题。因此将文章标题包装在一个`<h1>`元素中。完毕。

我错了吗？我还缺少进一步的考虑吗？我对吗？如果是这样，为什么' `<h1>`for article title'方法不更常用？

`<h1>`是否像我所说的那样决定在哪里使用元素？或者是否还有一些主观考虑？

**更新**：感谢到目前为止的所有答案。我真的很感激使用`<h1>`文章标题而不是网站标题如何提高可用性和可访问性（或没有，视情况而定）。基于事实而非个人假设的答案将获得许多奖励积分！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-06T12:30:34.153

有一个关于这个主题的[W3C 质量保证提示：](http://www-mit.w3.org/QA/Tips/Use_h1_for_Title)

> `<h1>`是文档第一级标题的 HTML 元素：
> 
> *   如果文档基本上是独立的，例如日内瓦的景点和活动，则顶级标题可能与标题相同。
>     
>     
> *   如果它是集合的一部分，例如关于宠物的页面集合中关于狗的部分，那么顶级标题应该假设一定量的上下文；只要`<h1>Dogs</h1>` 标题在任何情况下都可以使用：Dogs - Your Guide to Pets。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-08T17:05:33.647

作为屏幕阅读器用户，标题级别并不重要，只要它是一致的。不同的博客使用不同的约定，因此没有标准的方法可以使其更易于访问。确保标题与内容级别匹配比使用什么级别的标题更重要。例如，如果显示一系列带有评论的博客文章，所有博客文章都可以有第 2 级标题，而在评论开始时，您可以有第 3 级标题。有关易于导航标题的示例，请查找任何具有多个部分的 Wikipedia 文章和小节。我可以使用屏幕阅读器通过标题导航功能轻松跳过主要部分，以跳转到任何 2 级标题，如果我想移动到给定部分的子部分，我将导航到下一个标题。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-06T12:29:48.803

在您博客的主页上，我将使用 H1 表示网站标题，使用 H2 表示在首页上发布的各个博客文章的标题。

但是，在输入特定文章时，我会使用 H1 作为文章标题，并使用锚点作为网站标题。

这是一个很好的语义设置，Google 在抓取您的网站时也会受到赞赏。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T12:33:10.420

在 Wikipedia 上，h1-Tag 包含以 h2 开头的文档中的文章名称和标题。名称 Wikipedia 是 html-header 中标题标签的一部分。我也认为这是要走的路。所以对于博客，我会在你给出的例子中像 Joel Spolsky 一样。

而且我总是从最高级别开始，所以让 h1 在我看来是一个糟糕的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T12:34:39.327

HTML 页面的`<head>`一部分有一个名为 的元素`<title>`。顾名思义，这是针对网站标题的。

HTML 用于将页面构造成机器可解析的形式，而不是用于布局。如果它只是关于布局，您只能使用`<div>`和`<span>`具有不同类/ID 的块并将 CSS 应用于它们。代替

```
<h2>Sub Header</h2> 
```

我可以使用

```
<div class="header2>Sub Header</div> 
```

并且在某处有一些 CSS 代码会使它`<div>`看起来像 h2（字体大小、粗体字体等）。不同之处在于计算机无法知道 my`<div>`实际上是第一个示例中的二级标题（它怎么知道？我可能将其命名为不同于“header2”），但是在第一种情况下，它知道它是二级标题，因为它是一个`<h2>`元素，如果它想向用户显示页面标题的结构化列表，它可以这样做

*   顶级标题
    *   子标题
        *   子子标题
    *   子标题
    *   子标题
*   顶级标题
    *   子标题
        *   子子标题
        *   子子标题
    *   子标题
        ：

通过搜索 H1/H2/H3/... 元素并按上述方式构建它们。因此，如果计算机试图找出页面的标题，它会去哪里寻找呢？在一个名为的元素`<title>`中或在一个名为`<h1>`? 想一想，你就有了答案。

当然，您可能会说“但页面上看不到标题”。好吧，它通常在浏览器窗口的某处可见（窗口标题或至少选项卡标题）-但是，您可能希望它在页面上也可见-我可以理解。但是，这样做有什么意义呢？谁说你不能重复？但我想知道您是否应该为此使用 h1 元素。

```
<html>
<head>
<title>SOME TITLE</title>
</head>
:
<body>
<div id="title">SOME TITLE</div>
:
</body>
</html> 
```

使用 CSS 以`#title`您喜欢的方式设置样式。如果你愿意，让它变得超级大、超级大胆，并有一个引人注目的颜色，没有什么可以反对它。自动页面解析器通常会在某种程度上忽略 div 和 span，因为它什么也没告诉他们（这些是用于为读者布局页面的元素，但他们对页面的结构**只字不提。LAYOUT 不是 STRUCTURE**，你只能申请为某些结构元素设置样式以生成布局，但不应与另一种混淆）。计算机仍然会知道页面的标题是什么，这要归功于 title 元素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-22T01:06:07.287

对于典型的网站，例如博客，`h1`应该包含网站标题。是的，在网站的*每个*页面上。

为什么？在一个网站中，它的所有网页都有不同的部分。我们以导航为例：

```
<ul id="site-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about">About me</a></li>
  <li><a href="/contact">Contact</a></li>
</ul> 
```

这`#site-navigation`在网站的每个页面上都会重复。它代表站点导航，而不是页面导航。区别很重要！{页面导航可以是目录（如在维基百科文章中）或长文章的分页。}

如果您将文章标题用作`h1`，则站点导航将在此标题的范围内。

```
<body>
  <div>John’s blog</div> <!-- the site title -->
  <h1>My first blog post</h1> <!-- the article title -->
  <p>…&lt;/p>
  <h2>Navigation</h2>
  <ul id="site-navigation">…&lt;/ul> <!-- the site-wide navigation -->
</body> 
```

所以这个标记传达了：导航（→ 由 开始`h2`）是文章的一部分（→ 由 开始`h1`）。但这不是真的，这个导航不是文章的导航。链接实际上是整个站点的一部分，站点由站点标题表示。

当文章也包含副标题时，问题变得更加清晰：

```
<body>
  <div>John’s blog</div> <!-- the site title -->
  <h1>My first blog post</h1> <!-- the article title -->
  <p>…&lt;/p>
  <h2>Why I’m blogging</h2>
  <p>…&lt;/p>
  <h2>Why you should read my blog</h2>
  <p>…&lt;/p>
  <h2>Navigation</h2>
  <ul id="site-navigation">…&lt;/ul> <!-- the site-wide navigation -->
</body> 
```

如您所见，没有办法将文章子标题与导航区分开来。看起来这篇文章有三个子标题：“我为什么要写博客”、“你为什么要阅读我的博客”和“导航”。

因此，如果我们改为使用`h1`站点标题和`h2`文章标题，导航也可以在站点标题范围内，也可以使用`h2`：

```
<body>
  <h1>John’s blog</h1> <!-- the site title -->
  <h2>My first blog post</h2> <!-- the article title -->
  <p>…&lt;/p>
  <h2>Navigation</h2>
  <ul id="site-navigation">…&lt;/ul> <!-- the site-wide navigation -->
</body> 
```

现在这个标记传达了：有一个名为“John's blog”的站点（→ 由 开始`h1`），它包含一篇文章（→ 由第一个开始`h2`）和一个站点导航（→ 由第二个开始`h2`）。文章的小标题`h3`当然是现在。

* * *

使用`h1`文章标题的另一个问题是，通常在第一个标题*之前*有内容，例如包含网站标题和其他内容的网站标题。对于通过标题导航的用户，第一个内容将是“不可见的”。因此，给每个单独的块一个自己的标题是一个很好的做法。

HTML5 使用[分段/大纲算法](http://www.w3.org/TR/html5/sections.html#headings-and-sections)将其形式化。它解决了您在使用 HTML 4.01 时可能遇到的许多大纲问题，因为内容顺序现在（大部分）是免费的，而且如果您不想这样做，您不必“发明”实际标题，这要感谢`section`/ `article`/ `nav`/ `aside`。但在 HTML5 中，站点标题也应该是任何分段元素/根的子元素`h1`，`body`但不是子元素。所有其他部分都在本网站标题的范围内。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-25T05:48:15.837

> 文章页面中的 H1 - 网站标题或文章标题？

两个都。这篇文章内容丰富：[HTML5 时代多个 H1 标签的真相](http://webdesign.tutsplus.com/articles/the-truth-about-multiple-h1-tags-in-the-html5-era--webdesign-16824)。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-11-06T12:28:48.777

应该只有一个，而且必须只有一个

```
h1
```

; 通常这是页面标题。然后它应该遵循 h2，h3 等。

所以你的页面可以看起来像这样（没有所有其他 html 标签）

```
h1
  h2
  h2
    h3
..ETC

```

# http - 网址重定向；对于一般用途，哪个更好：服务器端还是客户端？

> ID：268476
> 
> 赞同：3
> 
> 时间：2008-11-06T12:21:24.203
> 
> 标签：http, url, redirect, seo, webserver

以一个非常简单的案例为例，假设我有这个 URL：

```
http://www.example.com/65167.html 
```

我希望通过以下方式提供该内容：

```
http://www.example.com/about 
```

**更新**：请注意，“坏”网址是规范网址（它是由内部使用它进行链接的 CMS 生成的），因此`"/about"`只是一种修饰它的方法。

我有两个广泛的选择：服务器端重定向或客户端重定向。我一直认为服务器端会更可取，因为它更有效，即 HTTP 流量大约减半。然而，搜索引擎优化技术倾向于支持资源的单个 URL，因此客户端是首选。

你如何解决这个冲突，还有其他我忽略的因素吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T12:25:03.917

Apache HTTPD 的 mod_rewrite 可以让浏览器在其位置栏中显示对 SEO 友好的 URL，同时重定向到服务器上的数字 URL：

```
RewriteEngine on
RewriteRule ^/about$ /65167.html [L] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T20:30:36.903

如果您从 /about 重定向到 /65167.html，则 301 是解决此问题的错误方法。您的 CMS 只会理解 65167.html 请求，但 301 基本上是在告诉 Google /about 不再存在并索引 65167.html 页面。

伊格纳西奥是正确的。您需要根据您的平台实现 mod_rewrite 或类似的东西，并隐藏 CMS，假设您实际上可以将所有 CMS 生成的链接重新编写为更友好的东西。

客户端重定向可能太复杂而无法实现，服务器端重定向将导致对服务器的两个请求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T13:30:18.497

我很确定 Google 理解[301 Moved Permanently](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.2)。

# c# - Calling a control's Validate() method using Reflection

> ID：268483
> 
> 赞同：2
> 
> 时间：2008-11-06T12:22:55.013
> 
> 标签：c#, winforms, reflection, validation

I'm currently in the process of writing a wizard and want to make each page validate before moving onto the next page.

I want to prevent the user from progressing by calling the Validate() method on every child control on the page and and stopping navigation if any of them fail.

The problem is that the Validate() method on every child control is a private method so I can't access it directly. Can anyone give me some advice on how to get a result from the Validate() method on a TextBox (For example) using Reflection?

Many thanks!

**Edit: Sorry - should have specified, this is Windows Forms, .Net 2.0**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-26T00:48:02.827

如果页面恰好是 ContainerControl 实例，则只需调用 ValidateChildren。如果没有，这似乎适用于单个控件：

```
private void ValidateControl(Control control)
{
  Type type = control.GetType();
  type.InvokeMember("PerformControlValidation", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.InvokeMethod, null, control, new object[] { true });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T12:33:26.690

如果您正在谈论 asp.net，您可以在控件上设置 ValidationGroup 属性，然后`this.Validate("GroupName")`在页面上调用您需要验证的组。

`Validate()`如果您需要验证整个页面，请忘记该组并调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-17T11:52:56.453

无需反思-您想要的是[ContainerControl.ValidateChildren()](http://msdn.microsoft.com/en-us/library/system.windows.forms.containercontrol.validatechildren.aspx)（在您的表单/对话框中调用它）

请注意，[ContainerControl.Validate()](http://msdn.microsoft.com/en-us/library/system.windows.forms.containercontrol.validate.aspx)只会验证最后一个控件是否具有焦点及其祖先：

> Validate 方法验证最后一个未验证的子控件及其祖先，但不包括当前容器控件

但是，如果您的父控件不是 ContainerControl（例如，面板），则确实需要反思 - 请参阅 NoBugz 的答案[here](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/1cef306e-6d39-432b-b479-29140fd11766/)

# unicode - InstallShield2009 Unicode 支持

> ID：268488
> 
> 赞同：1
> 
> 时间：2008-11-06T12:25:33.027
> 
> 标签：unicode, installation, installshield

我们的安装程序是使用 InstallShield2009 编写的，作为认证要求的一部分，我们必须始终支持 Unicode。

该应用程序本身是 .NET，因此本机支持 Unicode，但是在使用中文字符集测试我们的安装时，我们可以看到 InstallShield 对话框引发的问题。

快速谷歌后，我发现了一篇相关[的帖子](http://community.installshield.com/showthread.php?p=401900)，有人认为 IS2008 中没有 unicode 支持。

我也直接向 Acresso 发送了电子邮件，但作为一个有爱心的开发人员，我想我会在这里发布问题以供将来参考，以防其他人有同样的问题。

如果有人过去遇到过这个问题，我们将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T17:55:51.413

事实证明，IS2009 并不完全支持 Unicode，因为它无法处理包含（以及其他）日文字符的路径。

# javascript - jQuery document.createElement 等效？

> ID：268490
> 
> 赞同：1319
> 
> 时间：2008-11-06T12:26:31.993
> 
> 标签：javascript, jquery, html, dom, dhtml

我正在重构一些旧的 JavaScript 代码，并且正在进行大量的 DOM 操作。

```
var d = document;
var odv = d.createElement("div");
odv.style.display = "none";
this.OuterDiv = odv;

var t = d.createElement("table");
t.cellSpacing = 0;
t.className = "text";
odv.appendChild(t); 
```

我想知道是否有更好的方法来使用 jQuery 来做到这一点。我一直在尝试：

```
var odv = $.create("div");
$.append(odv);
// And many more 
```

但我不确定这是否更好。

* * *

## 回答 #1

> 赞同：1346
> 
> 时间：2008-11-06T12:34:58.217

这是您在“一”行中的示例。

```
this.$OuterDiv = $('<div></div>')
    .hide()
    .append($('<table></table>')
        .attr({ cellSpacing : 0 })
        .addClass("text")
    )
; 
```

* * *

*更新*：我想我会更新这篇文章，因为它仍然有相当多的流量。在下面的评论中，有一些关于`$("<div>")`vs `$("<div></div>")`vs`$(document.createElement('div'))`作为创建新元素的方式的讨论，这是“最好的”。

我整理了[一个小基准](http://jsbin.com/elula3)，这里大致是重复上述选项 100,000 次的结果：

**jQuery 1.4、1.5、1.6**

```
 Chrome 11  Firefox 4   IE9
<div>            440ms      640ms    460ms
<div></div>      420ms      650ms    480ms
createElement    100ms      180ms    300ms 
```

**jQuery 1.3**

```
 Chrome 11
<div>             770ms
<div></div>      3800ms
createElement     100ms 
```

**jQuery 1.2**

```
 Chrome 11
<div>            3500ms
<div></div>      3500ms
createElement     100ms 
```

我认为这不足为奇，但这`document.createElement`是最快的方法。当然，在你开始重构整个代码库之前，请记住我们在这里讨论的差异（除了 jQuery 的古老版本之外）相当于*每千个元素*额外增加 3 毫秒。

* * *

**更新 2**

**针对jQuery 1.7.2**进行了更新，并设置了`JSBen.ch`可能比我的原始基准更科学的基准，而且它现在可以众包了！

[http://jsben.ch/#/ARUtz](http://jsben.ch/#/ARUtz)

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2008-11-06T12:30:58.710

简单地提供要添加到 jQuery 构造函数的元素的 HTML`$()`将从新建的 HTML 返回一个 jQuery 对象，适合使用 jQuery 的`append()`方法附加到 DOM 中。

例如：

```
var t = $("<table cellspacing='0' class='text'></table>");
$.append(t); 
```

然后，您可以根据需要以编程方式填充此表。

这使您能够指定任何您喜欢的任意 HTML，包括类名或其他属性，您可能会发现这比使用和通过 JS `createElement`等设置属性更简洁。`cellSpacing``className`

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2010-07-15T07:14:03.380

创建新的 DOM 元素是该`jQuery()`方法的核心功能，请参阅：

*   [http://api.jquery.com/jQuery/#creating-new-elements](http://api.jquery.com/jQuery/#creating-new-elements)
*   特别是[http://api.jquery.com/jQuery/#example-1-1](http://api.jquery.com/jQuery/#example-1-1)

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2012-11-24T18:07:02.370

我正在这样做：

```
$('<div/>',{
    text: 'Div text',
    class: 'className'
}).appendTo('#parentDiv'); 
```

* * *

## 回答 #5

> 赞同：45
> 
> 时间：2013-01-24T03:01:28.973

因为`jQuery1.8`，使用[`$.parseHTML()`](http://api.jquery.com/jQuery.parseHTML/)来创建元素是更好的选择。

有两个好处：

1.如果您使用旧方式，可能类似于`$(string)`，jQuery 将检查字符串以确保您要选择一个 html 标记或创建一个新元素。通过使用`$.parseHTML()`，您告诉 jQuery 您要显式创建一个新元素，因此性能可能会好一些。

2.更重要的是，如果您使用旧方式，您可能会遭受跨站攻击（[更多信息）。](http://blog.jquery.com/2012/06/22/jquery-1-8-beta-1-see-whats-coming-and-going/#xss-protection)如果你有类似的东西：

```
 var userInput = window.prompt("please enter selector");
    $(userInput).hide(); 
```

一个坏人可以输入`<script src="xss-attach.js"></script>`来逗你。幸运的是，`$.parseHTML()`为您避免了这种尴尬：

```
var a = $('<div>')
// a is [<div>​&lt;/div>​]
var b = $.parseHTML('<div>')
// b is [<div>​&lt;/div>​]
$('<script src="xss-attach.js"></script>')
// jQuery returns [<script src=​"xss-attach.js">​&lt;/script>​]
$.parseHTML('<script src="xss-attach.js"></script>')
// jQuery returns [] 
```

但是，请注意它`a`是一个 jQuery 对象，而`b`它是一个 html 元素：

```
a.html('123')
// [<div>​123​&lt;/div>​]
b.html('123')
// TypeError: Object [object HTMLDivElement] has no method 'html'
$(b).html('123')
// [<div>​123​&lt;/div>​] 
```

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2013-06-18T05:53:20.620

**更新**

在 jQuery 的最新版本中，以下方法不会分配在第二个 Object 中传递的属性

**上一个答案**

我觉得`document.createElement('div')`与一起使用`jQuery`更快：

```
$(document.createElement('div'), {
    text: 'Div text',
    'class': 'className'
}).appendTo('#parentDiv'); 
```

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2013-09-29T19:01:11.003

虽然这是一个非常古老的问题，但我认为用最近的信息更新它会很好；

从 jQuery 1.8 开始，有一个[jQuery.parseHTML()](http://api.jquery.com/jQuery.parseHTML/)函数，它现在是创建元素的首选方式。此外，通过解析 HTML 存在一些问题`$('(html code goes here)')`，例如官方 jQuery 网站在[其发行说明之一中](http://blog.jquery.com/2013/05/24/jquery-1-10-0-and-2-0-1-released/)提到以下内容：

> 轻松的 HTML 解析：您可以再次在 $(htmlString) 中的标记之前使用前导空格或换行符。我们仍然强烈建议您在解析从外部来源获得的 HTML 时使用 $.parseHTML()，并且将来可能会对 HTML 解析进行进一步的更改。

为了与实际问题相关，提供的示例可以翻译为：

```
this.$OuterDiv = $($.parseHTML('<div></div>'))
    .hide()
    .append($($.parseHTML('<table></table>'))
        .attr({ cellSpacing : 0 })
        .addClass("text")
    )
; 
```

不幸的是，这不如使用 just 方便`$()`，但它为您提供了更多控制权，例如您可以选择排除脚本标签（`onclick`尽管它会留下内联脚本）：

```
> $.parseHTML('<div onclick="a"></div><script></script>')
[<div onclick=​"a">​&lt;/div>​]

> $.parseHTML('<div onclick="a"></div><script></script>', document, true)
[<div onclick=​"a">​&lt;/div>​, <script>​&lt;/script>​] 
```

此外，这是根据新现实调整的最佳答案的基准：

[JSbin 链接](http://jsbin.com/eZiZAZ)

**jQuery 1.9.1**

```
  $.parseHTML：88 毫秒
  $($.parseHTML)：240 毫秒
  <div></div>：138ms
  <div>: 143 毫秒
  创建元素：64 毫秒

```

看起来比`parseHTML`更接近，但是在将结果包装在一个新的 jQuery 对象中之后，所有的提升都消失了`createElement``$()`

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2010-11-17T17:03:38.113

```
var mydiv = $('<div />') // also works 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-12-22T22:43:07.963

```
var div = $('<div/>');
div.append('Hello World!'); 
```

是在 jQuery 中创建 DIV 元素的最短/最简单的方法。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-08-15T14:49:30.017

我刚刚为此制作了一个小型 jQuery 插件：[https ://github.com/ern0/jquery.create](https://github.com/ern0/jquery.create)

它遵循您的语法：

```
var myDiv = $.create("div"); 
```

DOM 节点 ID 可以指定为第二个参数：

```
var secondItem = $.create("div","item2"); 
```

严重吗？不，但是这种语法比*$("<div></div>")*更好，而且物有所值。

我是一个新的 jQuery 用户，从具有类似功能的 DOMAssistant 切换：http: [//www.domassistant.com/documentation/DOMAssistantContent-module.php](http://www.domassistant.com/documentation/DOMAssistantContent-module.php)

我的插件更简单，我认为 attrs 和 content 最好通过链接方法添加：

```
$("#container").append( $.create("div").addClass("box").html("Hello, world!") ); 
```

此外，它是一个简单的 jQuery 插件（第 100 个）的一个很好的例子。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-05-25T17:17:22.823

这一切都很简单！这里有几个简单的例子......

* * *

```
var $example = $( XMLDocRoot ); 
```

* * *

```
var $element = $( $example[0].createElement('tag') );
// Note the [0], which is the root

$element.attr({
id: '1',
hello: 'world'
}); 
```

* * *

```
var $example.find('parent > child').append( $element ); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-05-24T17:47:33.870

以前的答案中没有提到，所以我添加了如何使用最新的 jQuery 创建元素元素的工作示例，以及内容、类或 onclick 回调等附加属性：

```
const mountpoint = 'https://jsonplaceholder.typicode.com/users'

const $button = $('button')
const $tbody = $('tbody')

const loadAndRender = () => {
  $.getJSON(mountpoint).then(data => {

    $.each(data, (index, { id, username, name, email }) => {
      let row = $('<tr>')
        .append($('<td>', { text: id }))
        .append($('<td>', {
          text: username,
          class: 'click-me',
          on: {
            click: _ => {
              console.log(name)
            }
          }
        }))
        .append($('<td>', { text: email }))

      $tbody.append(row)
    })

  })
}

$button.on('click', loadAndRender)
```

```
.click-me {
  background-color: lightgrey
}
```

```
<table style="width: 100%">
  <thead>
    <tr>
      <th>ID</th>
      <th>Username</th>
      <th>Email</th>
    </tr>
  </thead>
  <tbody>

  </tbody>
</table>

<button>Load and render</button>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-09-25T15:46:43.753

这个怎么样，例如当你想`<option>`在一个`<select>`

```
$('<option/>')
  .val(optionVal)
  .text('some option')
  .appendTo('#mySelect') 
```

您显然可以应用于任何元素

```
$('<div/>')
  .css('border-color', red)
  .text('some text')
  .appendTo('#parentDiv') 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-11-06T12:35:57.077

开箱即用的 jQuery 没有 createElement 等效项。事实上，jQuery 的大部分工作都是在内部使用 innerHTML 而不是纯 DOM 操作完成的。正如亚当上面提到的，这就是你可以达到类似结果的方法。

还有一些插件可以通过 innerHTML 使用 DOM，例如[appendDOM](http://plugins.jquery.com/project/appendDom)、[DOMEC](http://plugins.jquery.com/project/DOMEC)和[FlyDOM](http://plugins.jquery.com/project/FlyDOM)，仅举几例。性能方面，原生 jquery 仍然是性能最高的（主要是因为它使用了 innerHTML）

# php - 如何在 Drupal 中为表单 API 按钮设置主题？

> ID：268496
> 
> 赞同：2
> 
> 时间：2008-11-06T12:27:54.753
> 
> 标签：php, drupal, drupal-fapi, drupal-theming

Drupal 的 Form API 的默认输出是：

```
<input id="edit-submit" class="form-submit" type="submit" value="Save" name="op"/> 
```

我如何主题，所以我得到：

```
<button id="edit-submit" class="form-submit" type="submit">
  <span>Save</span>
</button> 
```

我需要内部跨度标签，所以我可以使用滑动门 CSS 技术。

我想我需要从 form.inc 覆盖 theme_button($element) 但到目前为止我的尝试没有成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T07:49:47.230

如果您使用的是普通的 PHP 主题（如 Chameleon），主题化 form_foo 的基本思想是编写一个名为 theme_form_foo() 的函数。

您还可以专门为一个元素（如此按钮）指定主题，方法是为它声明一个主题函数。见[https://api.drupal.org/api/drupal/developer%21topics%21forms_api_reference.html/7](http://api.drupal.org/api/file/developer/topics/forms_api_reference.html#theme)

请注意，对于 D6，在这两种情况下，您都需要在主题注册表中声明该函数，否则 Drupal 不会注意到此覆盖。这在 D5 中不是必需的。如果您使用的是 phptemplate，那么您也将需要它，尽管 PHPtemplate 会处理表单案例之外的注册表：http: [//drupal.org/node/132442#theme-registry](http://drupal.org/node/132442#theme-registry)

ado 上提供了这方面的文档：http: [//api.drupal.org/api/file/developer/topics/forms_api.html](http://drupal.org/node/132442#theme-registry)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T09:42:47.080

我现在有一个功能

```
function mytheme_button($element) {
  return "<button><span></span></button>"; # lots of code missing here for clarity
} 
```

为了让它工作，我简单地清除了缓存，Drupal 注意到并自动使用它。

# architecture - 你在哪里划定设计和建筑之间的界限？

> ID：268497
> 
> 赞同：1
> 
> 时间：2008-11-06T12:28:40.680
> 
> 标签：architecture

[敏捷架构问题](https://stackoverflow.com/questions/19235/agile-architectures)让我想知道这一点。

这是否取决于正在构建的内容？应用程序（我在这里指的是单个计算程序）是否具有架构？

更新：为了澄清这个问题，我将就这个问题发表我的看法：我将架构定义为组件中系统的切割，以及组件之间的关系；而设计是关于组件的实习生。这个观点是共享的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T12:33:20.123

[这个Joel 的主题论坛](http://discuss.joelonsoftware.com/default.asp?design.4.491003.9)中的有趣答案

最有趣的之一：

```
In my experience, about $30k. 
```

最短的之一：

```
I would say that "design" is what is done to achieve an architecture 
```

> 架构可以涵盖设计范围之外的问题，例如整个产品系列或单个产品的一系列版本。架构还处理著名的“ *ilities* ”，例如可测试性、可升级性、可靠性、可用性等。

您将在 SEI 中找到提到设计[的软件架构的进一步定义。](http://www.sei.cmu.edu/architecture/published_definitions.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T14:15:02.757

这真的很简单：架构是关于您为满足“非功能性”需求而做出的设计决策：成本、可维护性、性能、可靠性、可用性和安全性等需求。这是关于 Web 应用程序的：您可以用无数种方式构建它，从作为 CGI 运行的大型 C 程序（实际上，我们曾经这样做过）、Python webapp、到 J2EE 应用程序，再到 LAMP 应用程序。它们中的任何一个都将具有相同的功能行为，它们都会发布相同的页面；当您尝试更改 C 程序的数据库或对大型 LAMP 应用程序进行负载平衡时，差异就会出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T12:30:21.160

这纯粹是主观的。无论开发主管或架构师说什么都是事实。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-20T23:44:00.047

架构可以定义为关于系统的主要设计决策的集合。设计决策，如与系统行为、系统结构、系统交互和设计相关的决策，是一个可以执行的计划或方案。

# mfc - 在 MFC CMenu 中绘制图标而不是位图？

> ID：268499
> 
> 赞同：2
> 
> 时间：2008-11-06T12:29:20.350
> 
> 标签：mfc

我可以在菜单中使用位图

```
CMenu men;
CBitmap b;
b.LoadBitmap(IDB_0); 
men.AppendMenu( MF_ENABLED,1,&b); 
```

我可以在 DC 中画一个图标

```
 CImageList IL;
  IL.Create(70, 14, ILC_COLOR16 | ILC_MASK, 1, 0);
  IL.Add(AfxGetApp()->LoadIcon(IDI_0));
  IL.Draw ( pDC,  0,  rcIcon.TopLeft(),  ILD_BLEND50 ); 
```

但我找不到在菜单中显示图标的简单方法。我想这样做

```
CMenu men;
CBitmap b;
// here the miracle happens, load the icon into the bitmap
men.AppendMenu( MF_ENABLED,1,&b); 
```

似乎这应该是可能的。

* * *

[这是与此](https://stackoverflow.com/questions/70386/icons-on-menus-of-mfc-feature-pack-classes)相同的问题。然而，这个问题提到了 MFC 功能包，没有得到回答，并且一个月没有任何活动，所以我认为参考基本 MFC 再次询问它是值得的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T13:35:56.253

我问了你提到的问题。

将（正常，16 位颜色）图标添加到菜单的方法是制作一个工具栏，其资源 ID 与您想要在其中包含图标的菜单相同。然后将 ID 分配给每个工具栏按钮，与相同的 ID菜单项。制作一个由向导生成的新 MFC 应用程序，您将看到它是如何工作的。

我发布的问题的答案表明，对于具有透明功能的功能包工具栏的 32 位图像，它应该同样适用；不过，我还没来得及测试它。

如果您的具体问题是如何制作动态生成的菜单，我认为您应该在工具栏中传递现有条目的 id，然后将使用该图像。

不是您问题的真正答案，但也许它会为您指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-07T01:24:32.867

在 Windows Vista/Windows7 上你不能这样做，它要么是 32 BGRA 图像，要么是菜单不是以新的 UI 样式绘制的。没有解决方法，也许是 ownerdrawing，但我读到 style API 无法与菜单一起正常工作，所以我从未尝试过深入了解它。

无论如何，您都应该使用 32 位 BGRA 图标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T07:07:45.593

好代码。请注意，这会显示位图图像，但如果您正在显示图像，最好删除字符串（用于检查/取消检查）留下的空格。我确实喜欢这个。

```
 MENUINFO mi;
        mi.cbSize = sizeof(mi);
        mi.fMask = MIM_STYLE;
        mi.dwStyle = MNS_NOCHECK;
        pcSubMenu->SetMenuInfo(&mi);

        MENUITEMINFO mii;
        mii.cbSize = sizeof mii;
        mii.fMask = MIIM_BITMAP;

        mii.hbmpItem = (HBITMAP)::LoadImage(AfxGetInstanceHandle(),MAKEINTRESOURCE(IDB_16_HELP),IMAGE_BITMAP,0,0,LR_SHARED |LR_VGACOLOR |LR_LOADTRANSPARENT);
        pcSubMenu->SetMenuItemInfo(ID_CONTENTS,&mii,FALSE); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-25T19:05:49.950

我认为您要查找的内容与此处描述的内容非常相似... www.codeguru.com/cpp/controls/menu/bitmappedmenus/article.php/c165/

与 www.codeproject.com/KB/shell/DynIcon.aspx 中描述的内容混合

还是得看看能不能用。

驯兽师

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-06T15:10:48.043

为了为菜单设置位图，您需要为每个项目调用 CMenu::SetMenuItemInfo()，如下所示：

```
MENUITEMINFO mii;
mii.cbSize = sizeof mii;
mii.fMask = MIIM_BITMAP;
mii.hbmpItem = bitmapHandle;
menu.SetMenuItemInfo(menuItem,&mii,TRUE); 
```

这样做的另一个复杂之处在于，这适用于 256 色位图，但不适用于全色 32 位 RGBA 位图 - 这些将起作用，但仅适用于 Vista，并且仅当您将位图呈现为预先计算的 RGBA 时。

在实践中，在我的代码中，我通过使用菜单图标的另一个功能来解决这个问题，即将 hbmpItem 设置为 HBMMENU_CALLBACK，它允许回调来绘制位图：我在 Windows XP 和之前的版本中这样做。代码有点太复杂，无法在此处发布。例如，您可以查看我的代码

[http://www.ifarchive.org/if-archive/infocom/interpreters/frotz/WindowsFrozSrc.zip](http://www.ifarchive.org/if-archive/infocom/interpreters/frotz/WindowsFrotzSrc.zip)

查看“MenuBar.h”和“MenuBar.cpp”，尤其是 MenuBar::SetBitmaps() 周围的代码。

# c# - 如何调试消失的应用程序

> ID：268501
> 
> 赞同：4
> 
> 时间：2008-11-06T12:29:49.740
> 
> 标签：c#, debugging, sockets, crash

在 Windows 2003 服务器上，我有一个纯 .NET 3.5`C#`应用程序（没有非托管代码）。它通过套接字连接到各种其他远程系统，并充当数据中心。它可以正常运行 10-15 小时，没有问题，但有时它会消失。如果我使用任务管理器观看应用程序，内存使用量保持不变。

在该`Main()`函数中，我将应用程序其余部分的调用包装在一个`try .. catch`块中，它刚刚完全过去 - 将异常记录到文件的 catch 块被忽略。如果我手动引发测试异常，则会调用 catch 块。

在进入之前`try .. catch`我做：

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.ThrowException); 
```

`DRWTSN32.EXE`系统上有 Watson 博士，但在指向的目录中没有写入任何内容。

我怎样才能捕捉到导致这种情况的任何异常？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T12:36:00.307

尝试使用微软的调试工具。[您可以从这里](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)下载它们。

使用 adplus 捕获崩溃，然后使用 windbg 对其进行分析。

adplus -crash -pn your.exe -quiet

[这个博客](http://blogs.msdn.com/tess/)上有很多关于在 Windows 上调试的重要信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T13:05:57.890

如果这是一个 Windows 窗体应用程序，那么窗口消息泵很可能正在捕获未处理的异常，这就是您永远看不到它的原因。要解决这个问题，请[在此处查看我的答案](https://stackoverflow.com/questions/233255/how-does-setunhandledexceptionfilter-work-in-net-winforms-applications#238357)。

如果它是 Windows 服务，则异常可能出现在后台线程上，而不是编组回主线程。为了解决这个问题，您需要将任何后台线程编组回您的主线程，并且异常将在那里重新抛出，以便您可以捕获它。

如果它是一个控制台应用程序，那么我有点困惑。

**编辑**：您的评论说这是一个 Windows 窗体应用程序。在这种情况下，您可能看不到异常，因为它是由内置的 Windows 窗体异常处理程序处理的，默认情况下执行以下操作：

*   在以下情况下捕获未处理的托管异常：
    *   没有附加调试器，并且
    *   窗口消息处理期间发生异常，并且
    *   App.Config 中的 jitDebugging = false。
*   向用户显示对话框并防止应用程序终止。

您可以通过在 App.Config 中设置 jitDebugging = true 来禁用此行为。然后您应该能够通过注册事件 Application.ThreadException 来查看未处理的异常，例如在 C# 中：

```
Application.ThreadException += new Threading.ThreadExceptionHandler(CatchExceptions); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:43:41.460

You could also [attach WinDBG at startup](http://www.cornetdesign.com/2008/06/debugging-net-windows-service-that-is.html) and enable breakpoints on .NET exceptions. You can then do a `!printexception` to see what is going on.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T11:27:34.903

EventLog 中可能有应用程序的踪迹。

我有一个 .Net 应用程序消失了，但无法捕获异常。每次发生这种情况时，EventLog 中都会有一个条目。

要查看事件日志，只需在命令提示符或运行框中键入 EventVwr。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T12:33:14.303

如果是 Windows 窗体应用程序，您可以尝试[`Application.ThreadException`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx).

# c# - 有效获取数组子集

> ID：268513
> 
> 赞同：5
> 
> 时间：2008-11-06T12:33:22.480
> 
> 标签：c#, arrays, cuda, cuda.net

有没有一种有效的方法来获取 C# 数组的子集并将其传递给另一段代码（不修改原始数组）？我使用 CUDA.net，它具有将数组复制到 GPU 的功能。例如，我想将函数传递给数组的十分之一，从而将数组的每十分之一分别复制到 GPU（出于流水线目的）。

以这种方式复制数组应该与一次性复制它一样有效。可以使用不安全的代码并仅引用正确的内存位置来完成，但除此之外我不确定。CopyTo 函数将整个数组复制到另一个数组，因此这看起来没有用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-06T12:59:50.193

好吧，我之前误解了这个问题。

你想要的是[System.Buffer.BlockCopy](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)或[System.Array.Copy](http://msdn.microsoft.com/en-us/library/z50k9bft.aspx)。

LINQ 方法的效率会非常低。如果您能够重用要复制到的缓冲区，那也将有助于提高效率，避免每次都创建一个新数组 - 只需复制顶部即可。除非你可以将你的“大”数组平分，否则你需要一个新的来处理最后一种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T12:46:28.833

我不确定这有多有效，但是...

```
int[] myInts = new int[100];

//Code to populate original arrray

for (int i = 0; i < myInts.Length; i += 10)
{
    int[] newarray = myInts.Skip(i).Take(10).ToArray();
    //Do stuff with new array
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T13:43:28.453

如果您需要从字节数组转到非托管指针，您可以尝试 Marshal.Copy。这样可以避免自己创建不安全的代码。

编辑：这显然只有在您重新实现他们的 API 时才有效。抱歉——误会了。您需要一种有效的子数组方法。

令我震惊的是，您真正想要的是表单原始类中的 api

```
void CopyToGpu(byte[] source, int start, int length); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T12:46:53.467

您可以使用扩展方法和收益回报：

```
public static IEnumerable Part<T>(this T[] array, int startIndex, int endIndex )
{
    for ( var currentIndex = startIndex; currentIndex < endIndex; ++currentIndex )
        yield return array[currentIndex];
} 
```

# php - IE6中的空白页

> ID：268526
> 
> 赞同：2
> 
> 时间：2008-11-06T12:36:23.143
> 
> 标签：php, internet-explorer, http, internet-explorer-6, http-headers

我正在使用 PHP 构建的网站有时会显示一个完全空白的页面。客户端或服务器上没有错误消息。有时可能会显示同一页面，但有时不会显示。所有页面在 IE7、Firefox 3、Safari 和 Opera 中运行良好。所有页面都是带有此元元素的 XHTML：

```
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" /> 
```

看来我已经通过添加这个 PHP 代码解决了这个问题*：*

```
header('Content-type: text/html; charset=utf-8'); 
```

我读过这个问题可能是由 XHTML、编码、gzip 压缩或缓存引起的，但没有人能够备份这些猜测。

由于问题是间歇性的，我不确定我的解决方案是否真的解决了问题。

我的问题是，当其他浏览器显示内容时，是否有*可重现*的方式让 IE6 显示空白页面？如果是这样，是什么原因造成的，什么解决了它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T12:52:38.930

这是来自 IE 的内容类型问题。它不知道如何处理 application/xhtml+xml。

虽然你写的是xhtml+xml，但是IE只知道text+html。在所有代理都知道 xhtml+xml 之前将是未来

将内容类型的元标记更改为 content="text/html;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T13:30:08.557

听起来像是IE 中的[bug #153“自关闭脚本标记”错误，](http://webbugtrack.blogspot.com/2007/08/bug-153-self-closing-script-tag-issues.html)**众所周知，它会导致空白页**。

由于 IE 的错误，您**永远**不能编写以下代码并期望它在 IE 中工作。

```
<script src="...." /> 
```

（如果标签是自动关闭的，您将进入一个痛苦的世界）

相反，始终编码为；

```
<script src="...."></script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-07T10:10:40.113

我有一个类似的特定于语言的问题——只有多字节字符的页面没有在 IE6 和 IE7 中显示。结果在这两个浏览器中，Content-Type 元标记和标题标记的顺序很重要。因此，将标签（包含日文字符）放在元标签之后可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T12:50:16.580

不确定这是否完全符合您的经验。这取决于正在使用哪个特定版本的 IE（包括服务包）。

IE6 SP2 和 IE7（都使用相同的渲染引擎）的一个已知渲染问题是 HTML 中存在孤立标记。这可能是一个孤立的 div 或脚本标签。

```
<script language="javascript">    // no closing tag
alert('hello world');
<body>
hello world
</body> 
```

以上在 IE6 SP1 和 Firefox 中渲染得很好，但在 IE6 SP2 和 IE7 中您只会看到一个空白页面。

某些其他标签必须有单独的结束标签。检查任何`<div>`and`<script>`标记是否有结尾`</script>`或`<div>`标记，而不仅仅是开始标记末尾的右斜杠。另一个是`<textarea>`. 你必须有两个标签。

**如果您可以查看空白页面的源代码并获取源 html，即使您的页面是空白的，您也可以测试您的网站是否发生这种情况。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T22:57:05.513

您应该将带有 Content-Type 标头的页面作为 text/html 提供给 IE 用户。您不需要更改元标记，只需将其保留为 application/xhtml+xml（IE 将忽略它）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-13T13:59:55.370

由于打字错误，我得到了这个错误。

我写了元标记：

```
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15" /> 
```

感谢您，我将其更正为：

```
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
```

我现在没有问题。

# c# - 以编程方式启动 UserControlTestContainer.exe

> ID：268528
> 
> 赞同：0
> 
> 时间：2008-11-06T12:37:34.297
> 
> 标签：c#

我实现了一个 C# 用户控件，并通过手动交互成功地使用 UserControlTestContainer.exe 对其进行了测试。现在我想通过我的单元测试以编程方式而不是手动将数据输入控件，然后自动显示填充了该数据的控件。我想我需要创建一个控件实例，填充它，然后以控件作为参数以编程方式启动容器，不是吗？如何成功显示填充控件？当然，该解决方案不必涉及上述容器，任何其他完成工作的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-21T10:50:38.367

我刚刚创建了另一个“单元测试”项目来完成所有 UserControlTestContainer 工作。UserControlTestContainer 通过项目属性上的外部应用程序选项启动。

# .net - 从 .NET 函数返回 KeyValuePair 是否可以？

> ID：268530
> 
> 赞同：4
> 
> 时间：2008-11-06T12:38:34.590
> 
> 标签：.net

我只是在处理一个需要返回两个值的函数，一个是列名，一个是当前行的该列的值。我正在返回 KeyValuePair（字符串，对象）。我想知道这是一个好主意还是让它难以阅读/使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T12:40:49.563

如果它真的是一个键值对，那么这似乎是一件非常合理的事情。.NET 4.0 将包含一个适当的`Tuple`类，用于不存在键值关系的情况。

另一种方法是使用 out/ref 参数，让调用者决定是否将这些值保持在一起 - 但我更喜欢这种`KeyValuePair`方法，当存在明显的关系并且调用者可能希望将它们组合在一起时。

# .net - 在确定菜单项的放置位置时是否有任何标准可以遵循？

> ID：268532
> 
> 赞同：5
> 
> 时间：2008-11-06T12:39:00.253
> 
> 标签：.net, windows, winforms, user-interface

在开发基于 Windows 窗体的应用程序时，在设计窗体的主菜单系统时应遵循哪些标准？

大多数带有菜单系统的 Windows 应用程序都会有您的标准文件 | 编辑 | 查看 | 工具 | 帮助菜单。您如何确定任何其他顶级菜单项的位置？

此外，您如何确定子菜单项的位置？例如，您将遵循哪些规则或原则来确定是否应将项目放置在“编辑”、“工具”或您自己的非标准顶级菜单中？

我在这里寻找两件事：

1.  详细说明此内容的已发布资源（网络或印刷品）（尤其是来自 Microsoft 时），或来自 UX 或 UI 专业人士的其他材料。
2.  你自己的意见。

根据 Gamecat 提到功能区的回复，我也将其扩展到功能区。您如何确定出现在哪些选项卡按钮上？寻找与上述相同的。

**相关问题：** [https ://stackoverflow.com/questions/126797/is-there-a-style-guide-for-guis-somewhere](https://stackoverflow.com/questions/126797/is-there-a-style-guide-for-guis-somewhere)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T14:03:30.393

Microsoft 的 Vista 用户体验指南位于：http: [//msdn.microsoft.com/en-us/library/aa511258.aspx](http://msdn.microsoft.com/en-us/library/aa511258.aspx)

特定于菜单的内容（包括标准菜单）位于：http: [//msdn.microsoft.com/en-us/library/aa511502.aspx](http://msdn.microsoft.com/en-us/library/aa511502.aspx)

这包括菜单和菜单项的标准顺序、它们的名称和它们的加速键。

一些一般准则：

文件用于影响用户正在处理的整个内容（通常是文件）或整个应用程序（例如，退出）的命令。这也是用户选择他们想要处理的表单的好地方。

编辑用于选择内容片段（例如，查找、全选）并作用于这些片段（复制、删除）。不要将其用作一般的“更改”菜单（例如，“编辑”首选项或宏）。

View 会改变内容的外观或呈现，而不改变底层内容本身（例如，用户在表单中输入的内容）。考虑*不*包括在查看菜单项中以控制工具栏的存在（工具栏不是内容）。那真的应该与选项/首选项一起使用。

尽管它被列为标准，但我会避免使用“工具”菜单。名字没有意义，内容也经常是乱七八糟的。考虑 Office 功能区使用的名称和组织（例如，选项位于文件的等效项下）。请参阅[http://blogs.msdn.com/jensenh/archive/2006/01/31/520061.aspx](http://blogs.msdn.com/jensenh/archive/2006/01/31/520061.aspx)。

通常将应用程序特定的菜单项放在标准菜单中的标准菜单项下方，这样用户的肌肉记忆就不会因标准菜单项而中断。但是，如果特定于应用程序的菜单项是标准菜单项的变体，则将其放置在标准菜单项的正下方（例如，查找下方的查找下一个或粘贴下方的选择性粘贴）

不要害怕为不符合上述条件的项目创建自己的菜单。菜单栏通常宽度不足，产生微弱的信息气味，尤其是对于非标准菜单项。八到十个菜单是完全可以接受的。只有三个菜单项的菜单是完全可以接受的；一个有两个菜单项不是不可能的。

级联或子菜单难以使用。改为按分隔符对菜单项进行分组。在需要考虑级联菜单之前，一个菜单可能有大约 15 个项目。如果您有这么多菜单项，首先考虑将一些菜单项拆分为单独的菜单，而不是菜单中的级联菜单。

将您的应用程序特定菜单放置在菜单栏上的 View 之后但 Window 或 Help 之前。我强烈建议进行用户研究（例如卡片分类）来组织和命名非标准菜单。

仔细观察功能区，您会发现它的组织方式与菜单栏几乎相同，具有文件（徽标菜单）、编辑（“主页”选项卡，其中包括格式）和视图的等价物，因此从从组织的角度来看，无论您使用的是功能区还是菜单栏都没有什么区别。

菜单栏仍然是大多数应用程序的最佳选择。功能区并不意味着比传统的菜单栏/工具栏组合更少的点击次数。不要仅仅因为 MS 正在推动它而跳到功能区。我在[http://www.zuschlogin.com/?p=36](http://www.zuschlogin.com/?p=36)有详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T13:41:12.170

Microsoft 菜单文档：

*   [Windows 用户体验指南：菜单](http://msdn.microsoft.com/en-us/library/dn742392.aspx)
*   [Windows 用户体验指南：菜单设计概念](http://msdn.microsoft.com/en-us/library/dn742392.aspx#design_concepts)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T12:42:52.367

不是标准，但您可以使用办公产品作为指导。

顺便说一句，菜单是过去的，现在都是 Ribbon。起初我对丝带持怀疑态度，但现在我认为这是一个非常好的主意。（尽量减少鼠标点击总是一个好主意）。

不错的链接：http: [//blogs.msdn.com/jeffdav/archive/2004/12/07/278012.aspx](http://blogs.msdn.com/jeffdav/archive/2004/12/07/278012.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T13:45:44.453

有几个标准可用：

*   微软标准指南：[http ://www.amazon.com/review/product/1556156790?pageNumber=2](http://www.amazon.com/review/product/1556156790?pageNumber=2)
*   [http://msdn.microsoft.com/en-us/library/ms997532.aspx](http://msdn.microsoft.com/en-us/library/ms997532.aspx)
*   [http://www.otal.umd.edu/guse/standards.html](http://www.otal.umd.edu/guse/standards.html)

苹果在他们的平台上有一个很长的指南：

*   [接口指南](http://developer.apple.com/documentation/UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T13:49:08.987

微软功能区文档：

*   [Windows 用户体验指南：功能区](http://msdn.microsoft.com/en-us/library/cc872782.aspx)

此外，对于不同类型的应用程序应使用哪种类型的界面（菜单栏、功能区、工具栏、直接命令等）的文档：

*   [Windows 用户体验指南：程序命令模式](http://msdn.microsoft.com/en-us/library/cc872780.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T22:11:38.927

有些事情要记住。

这两种标准化方法都是在网络出现之前在桌面软件中开发和实施的。这意味着这两个模型的设计都没有考虑到 Web 上下文。传统的桌面环境和基于 Web 的环境之间有一个很大的区别——浏览器的“返回”按钮。

o “取消”也是“返回”的方式，“确定”是“前进”的方式。这种“前进/后退”隐喻是大多数形式的“取消”和“确定”功能的基础。

以下是这个比喻的一些其他扩展：

*   我们使用可视化来传达复杂的想法。图形用户界面是一种可视化形式。我们在西方（尤其是美国文化）的可视化标准方面有着悠久的历史

o 时间：在我们的标准可视化中，“旧”通常描绘在左侧，“新”描绘在右侧（大多数时间的图形描绘都使用这种从左到右的比喻）

o 过程：我们在可视化渐进步骤时使用从左到右的比喻：“第一”在左边，“第二”通常显示在右边。

o 写作和阅读：在写作和阅读中，我们从左到右“继续”或“前进”（当然，除非我们在亚洲）

o 在电影中：电影是另一种可视化形式。在电影中，运动的标准是：如果一个人“要去某个地方”，她就会从屏幕的左侧移动到右侧。如果她要“返回”，她会从右向左移动

o 取消/确定模型可能有助于提高有意识的决策：此模型假设您想在决定要采取的行动之前阅读选项（建议在需要用户全神贯注并有更多注意力的重要交互上）比他们可用的几个操作。）取消/确定模型首先呈现“替代”操作（在左侧）......所以您可以在确定“确定”是您真正想要采取的操作之前阅读它们。OK/Cancel 模型可能会让用户养成点击他们遇到的第一个选项的习惯。同时，接受过使用取消/确定模型培训的用户只要确定这是他们想要做出的选择，就可以直接点击“确定”按钮。

o 操作系统适应：Mozilla 的 Firefox 与显示“确定”和“取消”按钮的顺序时使用的操作系统相匹配。换句话说，按钮的显示会适应您的操作系统训练您使用的内容。

这是一个有趣的调查，解决了这个按钮应该按哪个顺序的非常具体的问题：http: [//measuringuserexperience.com/SubmitCancel/index.htm](http://measuringuserexperience.com/SubmitCancel/index.htm)

*   DM

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-31T06:16:37.913

是的...菜单的逻辑分组可以帮助您的用户轻松记住事物。我也不喜欢有一个“工具”菜单并将不属于其他地方的所有内容都倾倒在这里......应该有一个像 Mac 或 Office 按钮（2010 年的 Outspace UI）这样的“应用程序菜单”，你可以有那些“工具”或偏好。

关于按钮排序，请尝试遵循平台约定... [http://blog.mugunthkumar.com/tech/elements-of-usability-design-okcancel-vs-cancelok-is-it-just-a-matter-of-品尝/](http://blog.mugunthkumar.com/tech/elements-of-usability-design-okcancel-vs-cancelok-is-it-just-a-matter-of-taste/)

# delphi - 如何获得在单个表单中使用多个 TActionMainMenuBar 对象的快捷方式？

> ID：268543
> 
> 赞同：6
> 
> 时间：2008-11-06T12:43:21.680
> 
> 标签：delphi, c++builder

我有一个带有主表单的应用程序。在这个表单中，我放置了三个 TActionMainMenuBar，因为应用程序本质上以三种不同的模式运行。

菜单栏都是由存储（代理）在主窗体上的 TActionManager 中的操作构成的。ActionManager 实际上引用了各种其他表单上的操作列表。

然后显示+启用和隐藏+禁用菜单栏，这样一次只有一个可见。这很好用，如果单击或使用 ALT 导航，然后使用箭头键或标题中带下划线的字符，则操作会运行。

然而问题是这些动作似乎没有响应任何快捷键的按下。

有谁知道是什么导致动作不触发？

如果需要，我很乐意提供更多信息，我正在使用 WinXP SP3 中的 C++Builder 2007 RAD Studio 进行编程。

感谢任何阅读此内容，甚至阅读此内容并提出解决方案的人！

彼得MJ

**更新：**我没有说明不同菜单中的快捷方式重叠，因为相同的快捷方式在不同的菜单中用于不同的操作，但所有快捷方式在自己的菜单中都是唯一的。

此后，我还简化了测试应用程序中的问题，使用两个 TActionMainMenuBar，所有操作共享一个操作管理器。在这种情况下，我有两个具有相同快捷方式的操作。它们被放置在不同的菜单上。然后一次启用一个菜单。在这种情况下，快捷方式确实有效，但是当使用通用快捷方式时，*即使*禁用了保持菜单，也只会触发第一个菜单中的操作。

这比我的实际问题略好，因为某些动作确实会触发，但突出显示这些动作没有被正确触发。有没有人没有解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T20:13:14.790

ActioneMenuBar 的启用/禁用或显示/隐藏对菜单栏上的操作没有任何影响。如果要使某些操作在特定上下文/情况下不可用，则需要实现操作本身或其所属的操作列表或操作管理器的“OnUpdate”事件。

例如，使用操作管理器的以下 OnUpdate 事件，您可以使用 TCheckBox 来决定当前激活了两个操作中的哪一个。

```
 if CheckBox1.Checked then
  begin
    Action1.Enabled:= False;
    Action2.Enabled:= True;
  end
  else
  begin
    Action1.Enabled:= True;
    Action2.Enabled:= False;
  end; 
```

想象一下，两个动作都分配了快捷键“Ctrl+A”，这意味着按下 Ctrl+A 只会在未选中 CheckBox1 时激活 Action1。

但是，仍然存在一个问题。一旦在当前表单的动作管理器或动作列表中找到具有快捷方式的动作，VCL 将停止查找具有特定快捷方式的动作，即使找到的动作未启用。

要解决此问题，您可以使用 OnUpdate 事件动态设置和重置操作的 ShortCut 属性，如下所示：

```
 if CheckBox1.Checked then
  begin
    Action1.Enabled:= False;
    Action1.ShortCut:= scNone;

    Action2.Enabled:= True;
    Action2.ShortCut:= ShortCut(ord('A'), [ssCtrl]);
  end
  else
  begin
    Action2.Enabled:= False;
    Action2.ShortCut:= scNone;

    Action1.Enabled:= True;
    Action1.ShortCut:= ShortCut(ord('A'), [ssCtrl]);
  end; 
```

使用此代码，如果选中 CheckBox1，则按 Ctrl+A 将激活 Action2，如果未选中 CheckBox1，则将激活 Action1。您不需要显式调用操作列表或操作管理器的 OnUpdate 事件。当应用程序空闲并等待用户输入时，会定期触发该事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T22:20:03.917

确保您要使用的操作已实际启用。
如果在禁用栏时禁用 ActionMainMenuBar 中的每个操作，那么您就有问题了。
还要确保使用可用的快捷方式，而不是与 Windows 全局快捷方式冲突。
除此之外，我不明白为什么它不起作用。我在 Delphi 中尝试了 2 个 ActionMainMenuBars 并且快捷方式有效。

# continuous-integration - 如何创建 Cruise Control 版本的 ZIP 文件？

> ID：268548
> 
> 赞同：2
> 
> 时间：2008-11-06T12:44:23.097
> 
> 标签：continuous-integration, cruisecontrol.net, zip

我使用 CruiseControl.NET 来自动构建我的 .NET 3.5 Web 应用程序，这是一种享受。但是，有没有办法自动创建这些构建的 ZIP 文件，并将 ZIP 放入单独的目录中？

我已经看到使用 NAnt 可以做到这一点，但找不到如何使其工作的示例。

任何人都可以提供帮助/示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:53:13.213

我刚刚在我们的 CC 机器上添加了这样一个 Nant 任务。

见[http://nant.sourceforge.net/release/latest/help/tasks/zip.html](http://nant.sourceforge.net/release/latest/help/tasks/zip.html)

请注意，最初查看 zip 存档时，可能看起来好像所有文件都在同一级别，即没有文件夹，但实际上它们的文件夹被保留了。

请注意如何排除文件类型或文件夹。

您可以采取只包括您想要的文件类型并排除其余文件类型的方法。

首先定义源文件是 allcode.dir 的属性以及 zip 文件 sourcebackup.zip 的名称和位置

现在这是 nant 任务

```
 <zip zipfile="${sourcebackup.zip}" includeemptydirs="true" verbose="true"> 
 <fileset basedir="${allcode.dir}"> 
      <include name="**/*" /> 
      <exclude name="**/_resharper*/**" /> 
      <exclude name="**/build/**" /> 
      <exclude name="**/obj/**" /> 
      <exclude name="**/bin/**" /> 
      <exclude name="**/*.dll" /> 
      <exclude name="**/*.scc" /> 
      <exclude name="**/*.log" /> 
      <exclude name="**/*.vssscc" /> 
      <exclude name="**/*.suo" /> 
      <exclude name="**/*.user" /> 
      <exclude name="**/*.pdb" /> 
      <exclude name="**/*.cache" /> 
      <exclude name="**/*.vspscc" /> 
      <exclude name="**/*.msi" /> 
      <exclude name="**/*.irs" /> 
      <exclude name="**/*.exe" /> 
 </fileset> 
```

```
<echo message="########## Zipped##########" /> 
```

像任何其他 nant 任务一样，从您的 cc 构建中调用它。我们发现如果可能的话，每个 CC 项目都调用一个任务是最好的，那么您只需更改 nant 脚本，您就可以在本地机器上运行 nant 脚本。

例如，在项目块中，我们有单个目标“build”，作为其工作的一部分，它调用 ZipSource

```
<targetList>
          <target>Build</target>
        </targetList> 
```

我们将上述内容用于 BizTalk 项目。

享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T13:08:27.480

如果您使用的是 Nant，那么[Zip 任务](http://nant.sourceforge.net/release/latest/help/tasks/zip.html)不适合您吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T13:11:58.080

我们正在压缩 CruiseControl.NET 项目的源代码

但我们正在使用蚂蚁

```
<target name="zipProject">
   <mkdir dir="output"/>
   <zip destfile="output\sources.zip" basedir="C:\project\src" />
</target> 
```

我不知道南特，但我希望它是相似的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T14:44:26.053

@David：NAnt Zip 任务是我所追求的，是的，但我问的是如何将它集成为自动 CruiseControl.NET 构建的一部分。如果您查看[巡航控制配置的 NAnt 文档，](http://cruisecontrol.sourceforge.net/main/configxml.html#nant "南安特")它并不清楚我是否可以从`<tasks>`CruiseControl 配置中的 XML 节点内部运行 NAnt 任务 - 它只是说它可以是`<schedule>`.

我找到了一些设置 CruiseControl 配置的示例和一些 NAnt 任务的示例，但没有任何东西可以集成这两者：特别是压缩 CruiseControl 构建。

如果有人有他们的 CruiseControl 配置的一些示例 XML，连接到 NAnt zip 任务，请在此处发布示例。

干杯。

# c# - 异常与验证

> ID：268553
> 
> 赞同：7
> 
> 时间：2008-11-06T12:46:49.580
> 
> 标签：c#, .net

我刚刚遇到了一个捕获异常的属性设置器（所有异常；我知道这很糟糕，但在这里不相关），并且*只*记录它们。首先，我认为它也应该再次通过它们；当您可以立即知道有什么问题时，为什么还要等待崩溃和日志研究呢？

但是，我的主要问题是，我是否针对无效的日期值进行验证，将 RuleViolation 对象添加到文档上的 ValidationRules 对象，或者抛出 InvalidDate 异常，或者只是让 CLR 为我抛出异常（无效日期只不过是无效的日期，不检查范围等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T12:53:31.690

这取决于手头的具体任务。如果您正在编写一个将用作其他程序中的组件的库类，并且该类的方法的合同规定它应该只接受有效日期，那么抛出异常就可以了。

如果您接受用户输入然后等待异常是一种不好的做法。在这种情况下，您应该自己验证日期。

例外是针对特殊情况的，不应成为您逻辑的一部分。这通常意味着程序员违反了合同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T12:55:23.870

这实际上取决于您的应用程序的逻辑。只有在异常的情况下才应该真正抛出*异常*。对于像验证这样的事情，它取决于对无效数据的容忍度。

当您构建交互式应用程序并且用户可以输入任何内容时，文档进入无效状态可能是可以的，您应该通过文档类的属性公开验证信息。

如果您正在处理来自数据库或日志文件的预先准备好的文档，那么文档无效并继续操作可能会损坏系统中的数据，这可能是不合适的。发生这种情况时，您应该扔。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T12:57:56.890

我认为这取决于日期值的来源。如果它来自用户输入或其他很可能输入“无效”日期的来源，那么验证将是可行的方法。另一方面，如果没有可预见的原因导致数据值可能无效，则抛出异常是合适的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T14:42:38.287

每当方法或类成员无法完成其设计要完成的任何任务时，都应该抛出异常。

所以对于属性设置器，如果设置器无法设置属性，那么它应该抛出异常。

至于你是否应该抓住它并重新抛出它，答案是肯定的，但前提是你需要在设置器中立即处理异常，然后再将它传递到堆栈......但记录它不是这样做的理由。通常，您应该在更高级别实现异常的横切日志记录，其中不会重新抛出异常......如果您正在处理堆栈中更高位置的那些横切关注点，那么没有，绝对不要捕获并重新抛出相同的异常。

但是，如果您正在编写一个工具或框架库，您希望组件的客户端具有明确定义的一组预期异常，并且您已经定义了您自己的自定义异常，您的组件将向客户端代码抛出这些异常，以及哪个客户端组件会期望看到，那么您可能希望捕获 CLR 生成的异常并重新抛出您自己的自定义异常。在将实际基础异常传递到堆栈之前，始终将其包含在自定义异常“InnerException”属性中，以便数据在它可供最终使用它的任何系统使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T12:50:33.363

抓再扔是最糟糕的事情。尝试它的成本很高，如果你只是要重新抛出什么意思？例如，如果您需要记录它们，您可以[使用 global.asax 捕获未处理的异常。](http://www.west-wind.com/WebLog/posts/1393.aspx)

在验证方面，从网络的角度来看，我总是使用正则表达式验证器作为日期，这些触发客户端和服务器端，所以我知道我什么时候在

```
if(Page.IsValid) 
```

阻止我的 txtDate.Text 是有效日期，所以我不费心检查，因为它只是浪费。

# ruby - 好的红宝石来源？

> ID：268574
> 
> 赞同：24
> 
> 时间：2008-11-06T12:51:52.160
> 
> 标签：ruby, rubygems

[除了http://gems.rubyforge.org/](http://gems.rubyforge.org/)和[http://gems.github.com/](http://gems.github.com/)之外，您还会推荐哪些好的 ruby​​ gem 资源？RubyForge 似乎缺少我这些天寻找的大部分宝石......

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-09-06T11:55:01.077

这现在是官方的 RubyGems 源：

```
https://rubygems.org/ 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-06T13:53:26.403

据我所知，这两个是它，主要是 ruby​​forge，因为这是库存 RubyGems 安装将搜索的唯一来源？随着 github 越来越流行，gem 开发人员仍然不能假设 github 已作为 gem 源添加，并且通常会提供特定的说明，例如

```
gem sources -a http://gems.github.com
gem install person-gemname 
```

或者

```
gem install person-gemname --source http://gems.github.com 
```

**更新**：gems.rubyforge.org、gems.github.com 和 gemcutter.org 都被替换为 `rubygems.org`

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-02-21T14:03:54.943

这是一个来自中国的：[http ://ruby.taobao.org/](http://ruby.taobao.org/)

我们中国用户喜欢它，因为它比默认的两个（从中国访问）快得多。

**更新（2015-09-24）：**

现在需要https，请使用[https://ruby.taobao.org/](https://ruby.taobao.org/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-09T04:03:56.843

基本上我同意，即使您在 github 或其他地方托管项目，所有稳定版本都应该在 RubyForge 上。主要原因是对宝石的所有依赖，当它们都在一个地方时，我很高兴。

Magnus Holm 写了关于这个 [http://judofyr.net/posts/dont-forget-about-rubyforge.html](http://judofyr.net/posts/dont-forget-about-rubyforge.html)

它也被其他人捡起 [http://www.infoq.com/news/2008/08/gems-from-rubyforge-and-github](http://www.infoq.com/news/2008/08/gems-from-rubyforge-and-github)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-11-28T07:40:09.707

非洲（特别是南非）的替代方案：

[http://gems.cloudafrica.net/](http://gems.cloudafrica.net/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-10T11:41:25.723

最好添加一个 RubyForge 镜像 - 但是我找不到一个启动的镜像，而 RubyForge 现在（2009 年 6 月 10 日）已关闭...

# delphi - 尝试在 Delphi 2009 中编译项目时，使用不同版本的 SysConst.SMonitorLockException 编译 Unit SysUtils

> ID：268583
> 
> 赞同：0
> 
> 时间：2008-11-06T12:53:49.787
> 
> 标签：delphi, delphi-2009

我正在尝试编译一个项目，但出现此错误。

该错误发生在 RemObjects 源文件中，但我认为它与 RemObjects 没有任何关系。

无论如何，这个错误太笼统了，我不太明白为什么会发生，那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T13:31:16.637

问题是我们翻译了单位 SysConsts 并且界面发生了变化，删除该单位解决了问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T12:56:06.067

如果您混合库，则会发生此错误。您可能正在使用使用不同版本编译的（第三方）库。尝试获取最新版本，或者如果您有源代码，请重新编译。

如果问题仍然存在，请尝试获取项目的最小子集以找到有问题的单元/dcu 文件。

# linux - 在 Linux 上从用户空间挂钩 sycall

> ID：268584
> 
> 赞同：2
> 
> 时间：2008-11-06T12:54:37.163
> 
> 标签：linux, hook, system-calls, code-injection, patch

有什么方法可以捕获 Linux 上的所有系统调用？我知道的唯一解决方案是使用 LD_PRELOAD à la [fakeroot](http://packages.qa.debian.org/f/fakeroot.html)，但这仅适用于动态链接的应用程序。此外，这种方法需要枚举所有系统调用，这是我想避免的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T13:11:58.983

我想你正在寻找[`ptrace(2)`](http://www.linuxjournal.com/article/6100).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T13:03:57.207

您可以跟踪程序。想想如何`strace`运作。提示：它不使用`LD_PRELOAD`技巧。

# c++ - 我可以为字段和构造函数参数使用相同的名称吗？

> ID：268587
> 
> 赞同：74
> 
> 时间：2008-11-06T12:55:40.327
> 
> 标签：c++, parameters, constructor

```
 class C {
  T a;
public:
  C(T a): a(a) {;}
}; 
```

合法吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-11-06T12:56:12.090

是的，它是合法的，适用于所有平台。它将正确地将您的成员变量 a 初始化为传入的值 a。

一些更干净的人认为它们会以不同的方式命名，但不是全部。我个人实际上经常使用它:)

具有相同变量名的初始化列表有效，因为初始化列表中的初始化项的语法如下：

<成员>(<值>)

您可以通过创建一个执行此操作的简单程序来验证我上面写的内容：（它不会编译）

```
class  A
{

   A(int a)
   : a(5)//<--- try to initialize a non member variable to 5
   {
   }
}; 
```

您将收到类似的编译错误：A 没有名为“a”的字段。

* * *

附带说明：

**您可能不想**使用与参数名称相同的成员名称的一个原因是您更容易出现以下情况：

```
class  A
{

   A(int myVarriable)
   : myVariable(myVariable)//<--- Bug, there was a typo in the parameter name, myVariable will never be initialized properly
   {
   }
   int myVariable;
}; 
```

* * *

附注（2）：

**您可能希望**使用与参数名称相同的成员名称的一个原因是您不太容易出现以下情况：

```
class  A
{

   A(int myVariable_)
   {
     //<-- do something with _myVariable, oops _myVariable wasn't initialized yet
     ...
     _myVariable = myVariable_;
   }
   int _myVariable;
}; 
```

这也可能发生在大型初始化列表中，并且您在初始化列表中初始化它之前使用 _myVariable。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2011-10-12T13:37:53.970

可能导致有关此主题的混淆的一件事是编译器如何确定变量的优先级。例如，如果构造函数参数之一与类成员同名，则可以在初始化列表中编写以下内容：

```
MyClass(int a) : a(a)
{
} 
```

但是上面的代码和这个有同样的效果吗？

```
MyClass(int a)
{
    a=a;
} 
```

答案是不。每当您在构造函数的主体中键入“a”时，编译器将首先查找名为“a”的局部变量或构造函数参数，只有当它没有找到时，它才会开始寻找名为“a”的类成员（如果没有可用的，那么它将寻找一个名为“a”的全局变量，顺便说一句）。结果是上述语句“a=a”会将存储在参数“a”中的值分配给参数“a”，使其成为无用的语句。

为了将参数的值分配给类成员“a”，您需要通知编译器您正在引用**此类**实例中的值：

```
MyClass(int a)
{
    this->a=a;
} 
```

很好，但是如果你做了这样的事情（注意没有一个叫做“a”的参数）：

```
MyClass() : a(a)
{
} 
```

好吧，在这种情况下，编译器会首先查找一个名为“a”的参数，当它发现没有任何参数时，它会将类成员“a”的值分配给类成员“a”，这实际上什么都不做.

最后，您应该知道您只能为初始化列表中的类成员赋值，因此以下将产生错误：

```
MyClass(int x) : x(100) // error: the class doesn't have a member called "x"
{
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-07T14:12:48.317

如果形参和成员的名称相同，请注意在构造函数中使用此指针来使用成员变量

```
class C {
  T a;
public:
  C(T a): a(a) {
this->a.sort ;//correct
a.sort();//will not affect the actual member variable
}
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T13:15:43.127

法律：是的，正如 Brian 所解释的，编译器知道在初始化列表中期望的名称必须是成员（或基类），而不是其他任何东西。

好的风格：很可能不是——对于很多程序员（包括你，似乎）结果并不明显。为参数使用不同的名称将保持代码合法并同时使其成为良好的样式。

我宁愿写一些：

```
class C {
  T a_;
public:
  C(T a): a_(a) {}
};

class C {
 T a;
 public:
 C(T value): a(value) {}
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-18T22:28:25.930

这种做法的问题，虽然它可能是合法的，但编译器会在使用 -Wshadow 时考虑隐藏的变量，它会在其他代码中混淆这些警告。

此外，在非平凡的构造函数中，您会犯错误，忘记将 this-> 放在成员名称前面。

Java 甚至不允许这样做。这是不好的做法，应该避免。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-24T14:37:28.403

嘿，伙计们，这是一个很好的问题。如果您想要字段和构造函数参数/方法参数的名称相同，则必须使用范围解析（`::`）运算符，或者您可以使用 this（`this->`）将参数值与成员映射，这样请仔细检查代码片段，您可以轻松理解。

```
class Student{
    private :
        string name;
        int rollNumber;

    public:
        Student()
        {
           // default constructor
        }

        // parameterized constructor
        Student(string name, int rollNumber)
        {
            this->name = name;
            Student::rollNumber = rollNumber;
        }

        void display()
        {
            cout<<"Name: "<<name <<endl;
            cout<<"Roll Number: "<<rollNumber<<endl;
        }

        void setName(string name)
        {
            this->name = name;
        }

        void setrollNumber(int rollNumber)
        {
            Student::rollNumber = rollNumber;
        }

}; 
```

# c# - 按下回车键时调用特定按钮的onClick事件C#

> ID：268588
> 
> 赞同：5
> 
> 时间：2008-11-06T12:55:44.727
> 
> 标签：c#, onclick, keypress, enter

当我在特定的 asp:textbox 控件中按下回车键时，我试图让特定的 asp:button onclick 事件触发。

要考虑的另一个因素是该按钮位于 asp:Login 控件模板中。

我不知道如何做到这一点，请在明信片上提出建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T13:04:23.273

您可以查看[`DefaultButton`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.defaultbutton.aspx)面板控件的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T13:09:21.597

您可以在表单上设置 DefaultButton 属性。作为标记 DefaultButton = "btnSubmit" 中表单标记的属性或在代码隐藏中使用类似的内容：

```
Page.Form.DefaultButton = "btnSubmit" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T13:07:25.687

它的[HtmlForm.DefaultButton](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmlform.defaultbutton(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T13:04:07.813

你需要用javascript来做。[使用jQuery](http://jquery.com/)真的很容易。

您可以执行以下操作（在我的脑海中，未经测试）：

```
$('#myTextBox').keypress(function(e){
    if(e.which == 13)
        $('#myBtn').click();
}); 
```

[编辑：请注意，尽管 jQuery 可以跨浏览器运行，但这里](http://docs.jquery.com/Events/keypress)描述的按键有一些怪癖。

哎呀，我没看到你说“输入键”，我以为你说的是​​“任何键”，是的，在这种情况下，在 asp:panel 上使用 DefaultButton

# asp.net - 在 IIS 中为代码 400（错误请求）配置的自定义错误页面被忽略

> ID：268592
> 
> 赞同：8
> 
> 时间：2008-11-06T12:56:15.163
> 
> 标签：asp.net, asp.net-mvc, iis, custom-error-pages

对于我的网站，我配置了一些自定义错误页面。如果我生成 404，则重定向工作正常。当达到 400 时，会显示“错误请求”文本而不是配置的 URl。

作为测试，我将 URL 从 404 复制到 400。没有变化。然后我将重定向更改为文件。不用找了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-24T08:06:41.300

我遇到了同样的问题，并在 msdn [http://msdn.microsoft.com/en-us/library/ms690497.aspx上找到了这个](http://msdn.microsoft.com/en-us/library/ms690497.aspx)

我不确定这是否适用于 IIS6，但它肯定适用于 IIS7。您需要配置**httpErrors**，而不是自定义错误

```
<system.webServer>
      <httpErrors errorMode="Custom">
            <error statusCode="400" subStatusCode="-1" path="_path" responseMode="Redirect" />
      </httpErrors>
</system.webServer> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T13:54:38.710

也许[这](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753103(v=ws.10))就是你的答案：这个微软网站说在 IIS6 中重新配置自定义错误

> 以下错误不可自定义：400、403.9、411、414、500、500.11、500.14、500.15、501、503 和 505。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-02T08:55:07.453

尝试

```
Response.TrySkipIisCustomErrors = true; 
```

或者

```
<configuration>
  <system.webServer>
    <httpErrors existingResponse="PassThrough" />
  </system.webServer>
</configuration> 
```

[原帖](https://stackoverflow.com/questions/9985327/asp-net-web-api-httpresponseexception-400-bad-request-hijacked-by-iis)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T13:31:56.247

检查该部分的 web.config 文件中的`customErrors`内容。它有一个`defaultRedirect`属性，以及一个`error`带有`redirect`属性的子标签。这些可能与您在 IIS 中的其他配置设置冲突。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-19T16:01:18.637

在 2020 年，它将像这样工作`web.config`：

```
<system.webServer>
    <httpErrors errorMode="Custom" existingResponse="Replace">
      <remove statusCode="400" subStatusCode="-1" />
      ...
      <error statusCode="400" prefixLanguageFilePath="YOUR_PATH" path="YOUR_HTML_FILE" responseMode="File" />
    ... 
```

> 状态码
> 
> 必需的整数属性。
> 
> 指定要为其创建自定义错误消息的 HTTP 状态代码的编号。可接受的值是从 400 到 999。

[https://docs.microsoft.com/en-us/previous-versions/iis/settings-schema/ms689487(v=vs.90)](https://docs.microsoft.com/en-us/previous-versions/iis/settings-schema/ms689487(v=vs.90))

请注意，像[https://stackoverflow.com/%](https://stackoverflow.com/%)这样的错误 URL仍然无法自定义，并且会收到来自 IIS 内核的简单**错误请求消息（错误代码 400）。**

更多关于这里 [https://serverfault.com/questions/257680/properly-handle-iis-request-with-percent-sign-in-url](https://serverfault.com/questions/257680/properly-handle-iis-request-with-percent-sign-in-url)

# c# - 如何从 C# 以编程方式获取最新的 clearcase 标签？

> ID：268595
> 
> 赞同：3
> 
> 时间：2008-11-06T12:57:47.890
> 
> 标签：c#, clearcase

我正在尝试将版本信息放入从最新 ClearCase 标签中检索到的 C# GUI 框架中。这最初是从 Visual Soursafe 完成的，如下所示。

```
vssDB = new VSSDatabaseClass();
vssDB.Open( databaseName, "vssadmin", "vssadmin" );
VSSItem item = vssDB.get_VSSItem( @"$\BuildDCP.bat", false );
foreach(VSSVersion vssVersion in item.get_Versions(0))
{
  // Pull the first non-blank label and use that
  if ( vssVersion.Label != "" )
  {
    labelID = vssVersion.Label.ToString();
    break;
  }
} 
```

我正在尝试使用 ClearCase 做类似的事情，因为我们将源代码控制从 VSS 更改为 CC。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:54:46.370

我相信这可以通过脚本更好地实现，该脚本将从您的 C# 程序中调用。

但是您可以通过ClearCase 提供的[CAL 接口直接调用一些 COM 对象。](http://www.ibm.com/developerworks/rational/library/06/0207_joshi/index.html)

可以通过 ClearCase 帮助（开始>程序>Rational ClearCase>ClearCase 帮助）访问该界面的文档，其中有一个“ClearCase 自动化库 (CAL)”条目。另一种方法是在 ClearCase/bin 目录中查找“ **cc_cal.chm** ”。

在 VB 中，使用 CAL API，这将提供如下内容：

```
Dim CC As New ClearCase.Application 
Dim labelID As String
Set aVersion = CC.Version("[Path-To]\BuildDCP.bat");
Set someLabels = Ver.Labels;
If (someLabels.Count > 0) Then 
    ' the first label listed is the most recently applied
    labelID = someLabels.Item(1).Type.Name
EndIf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:50:29.173

我真的希望 COM 接口有更好的文档，或者更明显。或者 ClearCase Explorer 或 Project Explorer 的代码是开源的。

我做了一些很酷的事情，但我基本上是从向我的 C# 项目添加 COM 引用开始的，然后开始使用我找到的接口。

祝你好运！

# java - JCanvas3D 与 Canvas3D

> ID：268603
> 
> 赞同：1
> 
> 时间：2008-11-06T13:01:16.823
> 
> 标签：java, macos, 3d, canvas, jcanvas

谁能告诉我在使用 JCanvas3D 而不是 Canvas3D 时我们面临的问题？

如何使用 JCanvas3D 实现透明度？

问候，哈里帕萨德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-20T20:06:49.403

我现在能找到的对 JCanvas3D 的唯一引用是在 com.sun.j3d.exp.swing 包中。该软件包的 API 实际上有一个*实验性*警告。话虽如此，论坛中仍然有相当多的活动，听起来人们仍在积极研究代码。

这两者之间的区别似乎是 Canvas3D 是标准的“AWT”式重量级组件，而 JCanvas3D 是其 Swing 对应物。

在搜索了更多之后：我发现[这个花絮是从](http://forums.java.net/jive/thread.jspa?messageID=347056&#347056)[交互式网格](http://forums.java.net/jive/profile.jspa?userID=247454)的答案中引用的，听起来它会回答你更具体的问题。

> 透明场景背景适用于所有轻量级 3D 画布（JCanvas3Dxyz、FxCanvas3Dxyz）。将 Java 3D 系统属性“transparentOffScreen”设置为 true（-Dj3d.transparentOffScreen=true 或 System.setProperty("j3d.transparentOffScreen", "true")）会导致场景背景中所有像素的 alpha 值为 '0'区域，以便显示面板自己的背景颜色。当将其 opaque 属性切换为 false 时，父面板将呈现在场景背景区域中。
> 
> 这允许 - 创建精美的背景或 - 在 JFrame 内的所有面板上移动 3D 场景内容或 - 创建分层的 3D 场景。
> 
> Canvas3D 中的场景背景区域始终是不透明的。
> 
> -八月

# c++ - 如何为 ostream 设置指数字段的宽度？

> ID：268604
> 
> 赞同：7
> 
> 时间：2008-11-06T13:01:31.017
> 
> 标签：c++

这段代码：

```
#include <iostream>
int main( int, char **argv )
{
std::cout << 1.23e45 << std::endl;
} 
```

印刷

> 1.23e+045

使用 MS Visual Studio 2003 编译时，以及

> 1.23e+45

在我的 Linux 机器上。

如何指定指数字段的宽度（以及为什么首先存在差异）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T13:32:58.990

我认为这对于标准机械手是不可能的。（如果是的话，我很想得到纠正并学习如何）

您唯一剩下的选择是自己创建一个流缓冲区，并截取所有进入流的指数数字，手动重新格式化它们，然后将它们传递给底层流。

似乎有很多工作，虽然不是火箭科学，但也不是微不足道的任务。

关于“为什么”的问题：我知道 linux 将指数定义为最少两位数，我想 Windows 将其指定为最少三位？

```
// on linux
std::cout << std::scientific << 1.23e4 << std::endl 
```

还添加一个前导零：

```
1.230000e+04 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:47:16.030

作为@Pieter 回答的后续，我一直在查看运算符<< (ostream&, double)。实际上，没有字段可以指定指数的重要性或宽度。在 Windows 上，运算符<< 转发到 sprintf，它也没有指数大小。

反过来，sprintf 函数（在 Windows 上）调用 _cfltcvt_l，我们没有源代码，但其签名不提供指数精度。

我对 Linux 上的实现一无所知。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-06T13:17:01.503

查看 iomanip 标头。它有很多宽度精度等......功能。

# javascript - 用于构建类桌面 Web 应用程序的 Javascript 库：ExtJS、jQuery、YahooUI、Mocha、SproutCore、Cappuccino 等？

> ID：268625
> 
> 赞同：22
> 
> 时间：2008-11-06T13:09:20.550
> 
> 标签：javascript, jquery, extjs, yui, mootools

我正在评估几个 Javascript UI 工具包，用于构建具有桌面感觉的 Web 应用程序，主要是因为对话框和窗口管理。

我查看了几个选项 - 这是我到目前为止的评估：

*   [ExtJS](http://extjs.com/) - 很棒的小部件库，很棒的文档！没有那么大的许可证。
*   [jQuery UI](http://ui.jquery.com/) - 缺乏现成的窗口和对话框容器。不过我喜欢 jQuery。
*   [雅虎！UI](http://developer.yahoo.com/yui/) - 与上述相同的问题。真正成熟（但不幸的[是，不再积极维护](https://yahooeng.tumblr.com/post/96098168666/important-announcement-regarding-yui)）并且有据可查。
*   [Mocha](http://mochaui.com/demo/)（基于 Mootools）- 不如其他成熟。缺乏好的文档。
*   [SproutCore](http://www.sproutcore.com/) - 同上。也没有窗口和对话框小部件。
*   [卡布奇诺](http://cappuccino.org/)——太奇怪了，太革命了。

你对这些有什么看法？我的评价正确吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T13:55:25.497

就桌面外观/感觉而言，最好的必须是 ExtJS。就 UI 而言，它确实领先于其他产品。当然存在许可问题，但它们有 FLOSS 例外，如果您打算从该项目中赚钱，那么商业许可并不完全会破坏银行。

其他非常丰富的框架值得一看（各有优劣），

*   [绑定](http://www.bindows.net/)
*   [Tibco 通用接口](http://www.tibco.com/devnet/gi/)
*   [图形用户界面](http://www.vegui.org/)
*   [回声](http://echo.nextapp.com/site/echo3)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T13:18:12.793

您是否考虑过 GWT（Google Web Toolkit [http://code.google.com/webtoolkit/](http://code.google.com/webtoolkit/)）？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T13:11:20.733

我喜欢 jQuery，加上它被 M$ 用于 MVC。我不会称缺乏现成的东西令人沮丧。是的，如果有的话那就太好了，但是对于这样的事情，我总是发现您最终会根据自己的需求来满足他们的需求，只需编写您自己的，这很容易！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T07:27:08.510

YUI 在 UI 方面非常出色，只是语法有点冗长，但是嘿，yahoo 上有足够的文档！正确完成工作的网站！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-22T08:26:35.827

你可以试试[jQuery Desktop](http://desktop.sonspring.com/)或[ExtJS](http://dev.sencha.com/deploy/ext-4.0.0/examples/desktop/desktop.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T13:24:06.853

*如果您希望它看起来像桌面应用程序一样工作*，我会选择[Yahoo! UI](http://developer.yahoo.com/yui/)或[Ext.JS](http://extjs.com/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T13:41:41.700

我最近在一些项目中使用 ExtJS。它的学习曲线有点陡峭，因为你必须掌握他们的布局概念，但除此之外你会没事的。

只需确保在开始使用之前阅读许可协议即可。哦，ExtJS 使用 jQuery、Prototype 等也能正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T13:50:34.710

ExtJS 可能是最好的选择。它很快，很瘦，而且非常漂亮。他们的支持也很出色。

# .net - DLLImport 在哪里查找非托管 DLL？

> ID：268627
> 
> 赞同：10
> 
> 时间：2008-11-06T13:09:24.653
> 
> 标签：.net, unmanaged, dllimport

一个简单的问题：当在 .Net 中声明 DLLImport 属性时，运行时会在哪里解决该 DLL 依赖关系？我是否必须将 DLL 及其所有依赖项转储到*bin*文件夹中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T13:13:29.310

我认为它像 LoadLibrary 一样工作。

也许[使用清单在 LoadLibrary 中搜索 Windows 路径](https://stackoverflow.com/questions/154281/windows-path-searching-in-loadlibrary-with-manifest)会有所帮助。

**编辑** [动态链接库搜索顺序](http://msdn.microsoft.com/en-us/library/ms682586(VS.85).aspx)可能是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T13:11:15.117

通常，您希望它查看用户路径中定义的任何内容。

要找出其中包含的内容，请在命令提示符下键入`echo %PATH%`[Enter]

# python - 如何在 BaseHTTPRequestHandler 子类中停止 BaseHTTPServer.serve_forever()？

> ID：268629
> 
> 赞同：57
> 
> 时间：2008-11-06T13:10:54.260
> 
> 标签：python, http, basehttpserver

我`HTTPServer`在一个单独的线程中运行我的（使用无法停止线程的线程模块......）并且希望在主线程也关闭时停止服务请求。

Python 文档指出它`BaseHTTPServer.HTTPServer`是 的子类`SocketServer.TCPServer`，它支持一种`shutdown`方法，但在`HTTPServer`.

整个`BaseHTTPServer`模块的文档很少:(

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-06T13:21:35.237

我应该首先说“我自己可能不会这样做，但我过去曾这样做过”。serve_forever（来自 SocketServer.py）方法如下所示：

```
def serve_forever(self):
    """Handle one request at a time until doomsday."""
    while 1:
        self.handle_request() 
```

您可以用 替换（在子类中）`while 1`，`while self.should_be_running`并从不同的线程修改该值。就像是：

```
def stop_serving_forever(self):
    """Stop handling requests"""
    self.should_be_running = 0
    # Make a fake request to the server, to really force it to stop.
    # Otherwise it will just stop on the next request.
    # (Exercise for the reader.)
    self.make_a_fake_request_to_myself() 
```

编辑：我挖出了我当时使用的实际代码：

```
class StoppableRPCServer(SimpleXMLRPCServer.SimpleXMLRPCServer):

    stopped = False
    allow_reuse_address = True

    def __init__(self, *args, **kw):
        SimpleXMLRPCServer.SimpleXMLRPCServer.__init__(self, *args, **kw)
        self.register_function(lambda: 'OK', 'ping')

    def serve_forever(self):
        while not self.stopped:
            self.handle_request()

    def force_stop(self):
        self.server_close()
        self.stopped = True
        self.create_dummy_request()

    def create_dummy_request(self):
        server = xmlrpclib.Server('http://%s:%s' % self.server_address)
        server.ping() 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-10-06T17:32:17.843

另一种基于[http://docs.python.org/2/library/basehttpserver.html#more-examples](http://docs.python.org/2/library/basehttpserver.html#more-examples)的方法是：代替 serve_forever()，只要满足条件就继续服务，使用服务器在每个请求之前和之后检查条件。例如：

```
import CGIHTTPServer
import BaseHTTPServer

KEEP_RUNNING = True

def keep_running():
    return KEEP_RUNNING

class Handler(CGIHTTPServer.CGIHTTPRequestHandler):
    cgi_directories = ["/cgi-bin"]

httpd = BaseHTTPServer.HTTPServer(("", 8000), Handler)

while keep_running():
    httpd.handle_request() 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2016-02-23T11:18:35.847

事件循环在 SIGTERM、`Ctrl`+`C`或何时`shutdown()`被调用时结束。

`server_close()`必须在`server_forever()`关闭侦听套接字之后调用。

```
import http.server

class StoppableHTTPServer(http.server.HTTPServer):
    def run(self):
        try:
            self.serve_forever()
        except KeyboardInterrupt:
            pass
        finally:
            # Clean-up server (close socket, etc.)
            self.server_close() 
```

可通过用户操作（SIGTERM、`Ctrl`+ `C`、...）停止的简单服务器：

```
server = StoppableHTTPServer(("127.0.0.1", 8080),
                             http.server.BaseHTTPRequestHandler)
server.run() 
```

服务器在一个线程中运行：

```
import threading

server = StoppableHTTPServer(("127.0.0.1", 8080),
                             http.server.BaseHTTPRequestHandler)

# Start processing requests
thread = threading.Thread(None, server.run)
thread.start()

# ... do things ...

# Shutdown server
server.shutdown()
thread.join() 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-11-06T13:30:25.033

在我的 python 2.6 安装中，我可以在底层 TCPServer 上调用它——它仍然在你的内部`HTTPServer`：

```
TCPServer.shutdown

>>> import BaseHTTPServer
>>> h=BaseHTTPServer.HTTPServer(('',5555), BaseHTTPServer.BaseHTTPRequestHandler)
>>> h.shutdown
<bound method HTTPServer.shutdown of <BaseHTTPServer.HTTPServer instance at 0x0100D800>>
>>> 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-10-26T01:38:35.223

我认为你可以使用`[serverName].socket.close()`

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-03-18T23:38:21.927

在 python 2.7 中，调用 shutdown() 有效，但前提是您通过 serve_forever 提供服务，因为它使用异步选择和轮询循环。具有讽刺意味的是，使用 handle_request() 运行您自己的循环会排除此功能，因为它意味着一个愚蠢的阻塞调用。

来自 SocketServer.py 的 BaseServer：

```
def serve_forever(self, poll_interval=0.5):
    """Handle one request at a time until shutdown.

    Polls for shutdown every poll_interval seconds. Ignores
    self.timeout. If you need to do periodic tasks, do them in
    another thread.
    """
    self.__is_shut_down.clear()
    try:
        while not self.__shutdown_request:
            # XXX: Consider using another file descriptor or
            # connecting to the socket to wake this up instead of
            # polling. Polling reduces our responsiveness to a
            # shutdown request and wastes cpu at all other times.
            r, w, e = select.select([self], [], [], poll_interval)
            if self in r:
                self._handle_request_noblock()
    finally:
        self.__shutdown_request = False
        self.__is_shut_down.set() 
```

这是我的代码的一部分，用于从另一个线程执行阻塞关闭，使用事件等待完成：

```
class MockWebServerFixture(object):
    def start_webserver(self):
        """
        start the web server on a new thread
        """
        self._webserver_died = threading.Event()
        self._webserver_thread = threading.Thread(
                target=self._run_webserver_thread)
        self._webserver_thread.start()

    def _run_webserver_thread(self):
        self.webserver.serve_forever()
        self._webserver_died.set()

    def _kill_webserver(self):
        if not self._webserver_thread:
            return

        self.webserver.shutdown()

        # wait for thread to die for a bit, then give up raising an exception.
        if not self._webserver_died.wait(5):
            raise ValueError("couldn't kill webserver") 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-06-07T20:23:46.437

我成功使用此方法（Python 3）从 Web 应用程序本身（网页）停止服务器：

```
import http.server
import os
import re

class PatientHTTPRequestHandler(http.server.SimpleHTTPRequestHandler):
    stop_server = False
    base_directory = "/static/"
    # A file to use as an "server stopped user information" page.
    stop_command = "/control/stop.html"
    def send_head(self):
        self.path = os.path.normpath(self.path)
        if self.path == PatientHTTPRequestHandler.stop_command and self.address_string() == "127.0.0.1":
            # I wanted that only the local machine could stop the server.
            PatientHTTPRequestHandler.stop_server = True
            # Allow the stop page to be displayed.
            return http.server.SimpleHTTPRequestHandler.send_head(self)
        if self.path.startswith(PatientHTTPRequestHandler.base_directory):
            return http.server.SimpleHTTPRequestHandler.send_head(self)
        else:
            return self.send_error(404, "Not allowed", "The path you requested is forbidden.")

if __name__ == "__main__":
    httpd = http.server.HTTPServer(("127.0.0.1", 8080), PatientHTTPRequestHandler)
    # A timeout is needed for server to check periodically for KeyboardInterrupt
    httpd.timeout = 1
    while not PatientHTTPRequestHandler.stop_server:
        httpd.handle_request() 
```

这样，通过基地址`http://localhost:8080/static/`（example `http://localhost:8080/static/styles/common.css`）提供的页面将由默认处理程序提供，`http://localhost:8080/control/stop.html`从服务器计算机访问将显示`stop.html`然后停止服务器，任何其他选项都将被禁止。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-10-20T03:42:11.087

这是[Helgi](https://stackoverflow.com/a/62087704/9762732)对 python 3.7 的回答的简化版本：

```
import threading
import time
from http.server import ThreadingHTTPServer, SimpleHTTPRequestHandler

class MyServer(threading.Thread):
    def run(self):
        self.server = ThreadingHTTPServer(('localhost', 8000), SimpleHTTPRequestHandler)
        self.server.serve_forever()
    def stop(self):
        self.server.shutdown()

if __name__ == '__main__':
    s = MyServer()
    s.start()
    print('thread alive:', s.is_alive())  # True
    time.sleep(2)
    s.stop()
    print('thread alive:', s.is_alive())  # False 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-12T08:41:21.557

我尝试了上述所有可能的解决方案，最终遇到了“有时”的问题——不知何故，它并没有真正做到——所以我最终制定了一个对我来说一直有效的肮脏解决方案：

如果以上所有方法都失败了，那么使用以下方法蛮力杀死你的线程：

```
import subprocess
cmdkill = "kill $(ps aux|grep '<name of your thread> true'|grep -v 'grep'|awk '{print $2}') 2> /dev/null"
subprocess.Popen(cmdkill, stdout=subprocess.PIPE, shell=True) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-05-29T14:00:41.340

```
import http.server
import socketserver
import socket as sck
import os
import threading

class myserver:
    def __init__(self, PORT, LOCATION):
        self.thrd = threading.Thread(None, self.run)
        self.Directory = LOCATION
        self.Port = PORT
        hostname = sck.gethostname()
        ip_address = sck.gethostbyname(hostname)
        self.url = 'http://' + ip_address + ':' + str(self.Port)
        Handler = http.server.SimpleHTTPRequestHandler
        self.httpd = socketserver.TCPServer(("", PORT), Handler)
        print('Object created, use the start() method to launch the server')
    def run(self):
        print('listening on: ' + self.url )
        os.chdir(self.Directory)
        print('myserver object started')        
        print('Use the objects stop() method to stop the server')
        self.httpd.serve_forever()
        print('Quit handling')

        print('Sever stopped')
        print('Port ' + str(self.Port) + ' should be available again.')

    def stop(self):
        print('Stopping server')
        self.httpd.shutdown()
        self.httpd.server_close()
        print('Need just one more request before shutting down'

    def start(self):
        self.thrd.start()

def help():
    helpmsg = '''Create a new server-object by initialising
NewServer = webserver3.myserver(Port_number, Directory_String)
Then start it using NewServer.start() function
Stop it using NewServer.stop()'''
    print(helpmsg) 
```

不是有经验的python程序员，只是想分享一下我的综合解决方案。主要基于这里和那里的片段。我通常在我的控制台中导入这个脚本，它允许我使用它们的特定端口为不同的位置设置多个服务器，与网络上的其他设备共享我的内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-05-06T06:47:13.187

这是 Python 3.7+ 的上下文风格版本，我更喜欢它，因为它会自动清理*，*您可以指定要服务的目录：

```
from contextlib import contextmanager
from functools import partial
from http.server import SimpleHTTPRequestHandler, ThreadingHTTPServer
from threading import Thread

@contextmanager
def http_server(host: str, port: int, directory: str):
    server = ThreadingHTTPServer(
        (host, port), partial(SimpleHTTPRequestHandler, directory=directory)
    )
    server_thread = Thread(target=server.serve_forever, name="http_server")
    server_thread.start()

    try:
        yield
    finally:
        server.shutdown()
        server_thread.join()

def usage_example():
    import time

    with http_server("127.0.0.1", 8087, "."):
        # now you can use the web server
        time.sleep(100) 
```

# vbscript - 如何使用 vbscript 对数组进行排序？

> ID：268648
> 
> 赞同：33
> 
> 时间：2008-11-06T13:16:41.940
> 
> 标签：vbscript, sorting

我正在扫描一个文件以查找与某个正则表达式模式匹配的行，然后我想打印出匹配但按字母顺序排列的行。我确定这是微不足道的，但 vbscript 不是我的背景

我的数组定义为

```
Dim lines(10000) 
```

如果这有什么不同，我正在尝试从正常的 cmd 提示符执行我的脚本

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-06T13:21:22.070

来自[微软](http://www.microsoft.com/technet/scriptcenter/funzone/games/tips08/gtip1130.mspx#E4C)

在 VBScript 中对数组进行排序从未如此简单。那是因为 VBScript 没有任何类型的排序命令。反过来，这总是意味着 VBScript 脚本编写者被迫编写自己的排序例程，无论是冒泡排序例程、堆排序、快速排序还是某种其他类型的排序算法。

所以（使用.Net，因为它安装在我的电脑上）：

```
Set outputLines = CreateObject("System.Collections.ArrayList")

'add lines
outputLines.Add output
outputLines.Add output

outputLines.Sort()
For Each outputLine in outputLines
    stdout.WriteLine outputLine
Next 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-03-06T07:18:32.573

我知道这是一个相当古老的话题，但它可能对将来的任何人都派上用场。下面的脚本完成了这个家伙试图纯粹使用 vbscript 实现的目标。当以大写字母开头的排序术语将具有优先权。

```
for a = UBound(ArrayOfTerms) - 1 To 0 Step -1
    for j= 0 to a
        if ArrayOfTerms(j)>ArrayOfTerms(j+1) then
            temp=ArrayOfTerms(j+1)
            ArrayOfTerms(j+1)=ArrayOfTerms(j)
            ArrayOfTerms(j)=temp
        end if
    next
next 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-21T13:22:54.100

断开连接的记录集可能很有​​用。

```
Const adVarChar = 200  'the SQL datatype is varchar

'Create a disconnected recordset
Set rs = CreateObject("ADODB.RECORDSET")
rs.Fields.append "SortField", adVarChar, 25

rs.CursorType = adOpenStatic
rs.Open
rs.AddNew "SortField", "Some data"
rs.Update
rs.AddNew "SortField", "All data"
rs.Update

rs.Sort = "SortField"

rs.MoveFirst

Do Until rs.EOF
    strList=strList & vbCrLf & rs.Fields("SortField")        
    rs.MoveNext
Loop 

MsgBox strList 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T14:04:38.427

这是我为从 ADODB.Recordset 的 GetRows 方法返回的数组编写的快速排序。

```
'Author:        Eric Weilnau
'Date Written:  7/16/2003
'Description:   QuickSortDataArray sorts a data array using the QuickSort algorithm.
'               Its arguments are the data array to be sorted, the low and high
'               bound of the data array, the integer index of the column by which the
'               data array should be sorted, and the string "asc" or "desc" for the
'               sort order.
'
Sub QuickSortDataArray(dataArray, loBound, hiBound, sortField, sortOrder)
    Dim pivot(), loSwap, hiSwap, count
    ReDim pivot(UBound(dataArray))

    If hiBound - loBound = 1 Then
        If (sortOrder = "asc" and dataArray(sortField,loBound) > dataArray(sortField,hiBound)) or (sortOrder = "desc" and dataArray(sortField,loBound) < dataArray(sortField,hiBound)) Then
            Call SwapDataRows(dataArray, hiBound, loBound)
        End If
    End If

    For count = 0 to UBound(dataArray)
        pivot(count) = dataArray(count,int((loBound + hiBound) / 2))
        dataArray(count,int((loBound + hiBound) / 2)) = dataArray(count,loBound)
        dataArray(count,loBound) = pivot(count)
    Next

    loSwap = loBound + 1
    hiSwap = hiBound

    Do
        Do While (sortOrder = "asc" and dataArray(sortField,loSwap) <= pivot(sortField)) or sortOrder = "desc" and (dataArray(sortField,loSwap) >= pivot(sortField))
            loSwap = loSwap + 1

            If loSwap > hiSwap Then
                Exit Do
            End If
        Loop

        Do While (sortOrder = "asc" and dataArray(sortField,hiSwap) > pivot(sortField)) or (sortOrder = "desc" and dataArray(sortField,hiSwap) < pivot(sortField))
            hiSwap = hiSwap - 1
        Loop

        If loSwap < hiSwap Then
            Call SwapDataRows(dataArray,loSwap,hiSwap)
        End If
    Loop While loSwap < hiSwap

    For count = 0 to Ubound(dataArray)
        dataArray(count,loBound) = dataArray(count,hiSwap)
        dataArray(count,hiSwap) = pivot(count)
    Next

    If loBound < (hiSwap - 1) Then
        Call QuickSortDataArray(dataArray, loBound, hiSwap-1, sortField, sortOrder)
    End If

    If (hiSwap + 1) < hiBound Then
        Call QuickSortDataArray(dataArray, hiSwap+1, hiBound, sortField, sortOrder)
    End If
End Sub 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-22T21:33:33.127

如果您要输出这些行，您可以通过 sort 命令运行输出。不优雅，但不需要太多工作：

```
cscript.exe //nologo YOUR-SCRIPT | Sort 
```

注意**//nologo**省略了出现在排序输出中间的徽标行（*Microsoft (R) Windows Script Host Version ... blah blah blah）。*（我猜 MS 不知道 stderr 是干什么用的。）

有关排序的详细信息，请参见[http://ss64.com/nt/sort.html](http://ss64.com/nt/sort.html)。

**如果您的排序键不是从第一列开始，**/+n是最有用的选项。****

 **比较总是**不区分大小写**，这是蹩脚的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-12T05:08:45.577

一些老式的数组排序。当然，这只对一维数组进行排序。

'C:\DropBox\Automation\Libraries\Array.vbs

```
Option Explicit

Public Function Array_AdvancedBubbleSort(ByRef rarr_ArrayToSort(), ByVal rstr_SortOrder)
'   ==================================================================================
'   Date            : 12/09/1999
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Creates a sorted Array from a one dimensional array
'                       in Ascending (default) or Descending order based on the rstr_SortOrder.
'   Variables       :
'                   rarr_ArrayToSort()     The array to sort and return.
'                   rstr_SortOrder   The order to sort in, default ascending or D for descending.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_AdvancedBubbleSort"
    Dim bln_Sorted
    Dim lng_Loop_01
    Dim str_SortOrder
    Dim str_Temp

    bln_Sorted = False
    str_SortOrder = Left(UCase(rstr_SortOrder), 1) 'We only need to know if the sort order is A(SENC) or D(ESEND)...and for that matter we really only need to know if it's D because we are defaulting to Ascending.
    Do While (bln_Sorted = False)
       bln_Sorted = True
        str_Temp = ""
        If (str_SortOrder = "D") Then
            'Sort in descending order.
            For lng_Loop_01 = LBound(rarr_ArrayToSort) To (UBound(rarr_ArrayToSort) - 1)
                If (rarr_ArrayToSort(lng_Loop_01) < rarr_ArrayToSort(lng_Loop_01 + 1)) Then
                    bln_Sorted = False
                    str_Temp = rarr_ArrayToSort(lng_Loop_01)
                    rarr_ArrayToSort(lng_Loop_01) = rarr_ArrayToSort(lng_Loop_01 + 1)
                    rarr_ArrayToSort(lng_Loop_01 + 1) = str_Temp
                End If
                If (rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - (lng_Loop_01 - 1)) > rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - lng_Loop_01)) Then
                    bln_Sorted = False
                    str_Temp = rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - (lng_Loop_01 - 1))
                    rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - (lng_Loop_01 - 1)) = rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - lng_Loop_01)
                    rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - lng_Loop_01) = str_Temp
                End If
            Next
        Else
            'Default to Ascending.
            For lng_Loop_01 = LBound(rarr_ArrayToSort) To (UBound(rarr_ArrayToSort) - 1)
                If (rarr_ArrayToSort(lng_Loop_01) > rarr_ArrayToSort(lng_Loop_01 + 1)) Then
                    bln_Sorted = False
                    str_Temp = rarr_ArrayToSort(lng_Loop_01)
                    rarr_ArrayToSort(lng_Loop_01) = rarr_ArrayToSort(lng_Loop_01 + 1)
                    rarr_ArrayToSort(lng_Loop_01 + 1) = str_Temp
                End If
                If (rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - (lng_Loop_01 - 1)) < rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - lng_Loop_01)) Then
                    bln_Sorted = False
                    str_Temp = rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - (lng_Loop_01 - 1))
                    rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - (lng_Loop_01 - 1)) = rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - lng_Loop_01)
                    rarr_ArrayToSort((UBound(rarr_ArrayToSort) - 1) - lng_Loop_01) = str_Temp
                End If
            Next
        End If
    Loop
End Function

Public Function Array_BubbleSort(ByRef rarr_ArrayToSort())
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_BubbleSort"
    Dim lng_Loop_01
    Dim lng_Loop_02
    Dim var_Temp

    For lng_Loop_01 = (UBound(rarr_ArrayToSort) - 1) To 0 Step -1
        For lng_Loop_02 = 0 To lng_Loop_01
            If rarr_ArrayToSort(lng_Loop_02) > rarr_ArrayToSort(lng_Loop_02 + 1) Then
                var_Temp = rarr_ArrayToSort(lng_Loop_02 + 1)
                rarr_ArrayToSort(lng_Loop_02 + 1) = rarr_ArrayToSort(lng_Loop_02)
                rarr_ArrayToSort(lng_Loop_02) = var_Temp
            End If
        Next
    Next
End Function

Public Function Array_GetDimensions(ByVal rarr_Array)
    Const const_FUNCTION_NAME = "Array_GetDimensions"
    Dim int_Dimensions
    Dim int_Result
    Dim str_Dimensions

    int_Result = 0
    If IsArray(rarr_Array) Then
        On Error Resume Next
        Do
            int_Dimensions = -2
            int_Dimensions = UBound(rarr_Array, int_Result + 1)
            If int_Dimensions > -2 Then
                int_Result = int_Result + 1
                If int_Result = 1 Then
                    str_Dimensions = str_Dimensions & int_Dimensions
                Else
                    str_Dimensions = str_Dimensions & ":" & int_Dimensions
                End If
            End If
        Loop Until int_Dimensions = -2
        On Error GoTo 0
    End If
    Array_GetDimensions = int_Result ' & ";" & str_Dimensions
End Function

Public Function Array_GetUniqueCombinations(ByVal rarr_Fields, ByRef robj_Combinations)
    Const const_FUNCTION_NAME = "Array_GetUniqueCombinations"
    Dim int_Element
    Dim str_Combination

    On Error Resume Next

    Array_GetUniqueCombinations = CBool(False)
    For int_Element = LBound(rarr_Fields) To UBound(rarr_Fields)
        str_Combination = rarr_Fields(int_Element)
        Call robj_Combinations.Add(robj_Combinations.Count & ":" & str_Combination, 0)
'        Call Array_GetUniqueCombinationsSub(rarr_Fields, robj_Combinations, int_Element)
    Next 'int_Element
    For int_Element = LBound(rarr_Fields) To UBound(rarr_Fields)
        Call Array_GetUniqueCombinationsSub(rarr_Fields, robj_Combinations, int_Element)
    Next 'int_Element
    Array_GetUniqueCombinations = CBool(True)
End Function 'Array_GetUniqueCombinations

Public Function Array_GetUniqueCombinationsSub(ByVal rarr_Fields, ByRef robj_Combinations, ByRef rint_LBound)
    Const const_FUNCTION_NAME = "Array_GetUniqueCombinationsSub"
    Dim int_Element
    Dim str_Combination

    On Error Resume Next

    Array_GetUniqueCombinationsSub = CBool(False)
    str_Combination = rarr_Fields(rint_LBound)
    For int_Element = (rint_LBound + 1) To UBound(rarr_Fields)
        str_Combination = str_Combination & "," & rarr_Fields(int_Element)
        Call robj_Combinations.Add(robj_Combinations.Count & ":" & str_Combination, str_Combination)
    Next 'int_Element
    Array_GetUniqueCombinationsSub = CBool(True)
End Function 'Array_GetUniqueCombinationsSub

Public Function Array_HeapSort(ByRef rarr_ArrayToSort())
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_HeapSort"
    Dim lng_Loop_01
    Dim var_Temp
    Dim arr_Size

    arr_Size = UBound(rarr_ArrayToSort) + 1
    For lng_Loop_01 = ((arr_Size / 2) - 1) To 0 Step -1
        Call Array_SiftDown(rarr_ArrayToSort, lng_Loop_01, arr_Size)
    Next
    For lng_Loop_01 = (arr_Size - 1) To 1 Step -1
        var_Temp = rarr_ArrayToSort(0)
        rarr_ArrayToSort(0) = rarr_ArrayToSort(lng_Loop_01)
        rarr_ArrayToSort(lng_Loop_01) = var_Temp
        Call Array_SiftDown(rarr_ArrayToSort, 0, (lng_Loop_01 - 1))
    Next
End Function

Public Function Array_InsertionSort(ByRef rarr_ArrayToSort())
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_InsertionSort"
    Dim lng_ElementCount
    Dim lng_Loop_01
    Dim lng_Loop_02
    Dim lng_Index

    lng_ElementCount = UBound(rarr_ArrayToSort) + 1
    For lng_Loop_01 = 1 To (lng_ElementCount - 1)
        lng_Index = rarr_ArrayToSort(lng_Loop_01)
        lng_Loop_02 = lng_Loop_01
        Do While lng_Loop_02 > 0
            If rarr_ArrayToSort(lng_Loop_02 - 1) > lng_Index Then
                rarr_ArrayToSort(lng_Loop_02) = rarr_ArrayToSort(lng_Loop_02 - 1)
                lng_Loop_02 = (lng_Loop_02 - 1)
            End If
        Loop
        rarr_ArrayToSort(lng_Loop_02) = lng_Index
    Next
End Function

Private Function Array_Merge(ByRef rarr_ArrayToSort(), ByRef rarr_ArrayTemp(), ByVal rlng_Left, ByVal rlng_MiddleIndex, ByVal rlng_Right)
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Merges an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_Merge"
    Dim lng_Loop_01
    Dim lng_LeftEnd
    Dim lng_ElementCount
    Dim lng_TempPos

    lng_LeftEnd = (rlng_MiddleIndex - 1)
    lng_TempPos = rlng_Left
    lng_ElementCount = (rlng_Right - rlng_Left + 1)
    Do While (rlng_Left <= lng_LeftEnd) _
    And (rlng_MiddleIndex <= rlng_Right)
        If rarr_ArrayToSort(rlng_Left) <= rarr_ArrayToSort(rlng_MiddleIndex) Then
            rarr_ArrayTemp(lng_TempPos) = rarr_ArrayToSort(rlng_Left)
            lng_TempPos = (lng_TempPos + 1)
            rlng_Left = (rlng_Left + 1)
        Else
            rarr_ArrayTemp(lng_TempPos) = rarr_ArrayToSort(rlng_MiddleIndex)
            lng_TempPos = (lng_TempPos + 1)
            rlng_MiddleIndex = (rlng_MiddleIndex + 1)
        End If
    Loop
    Do While rlng_Left <= lng_LeftEnd
        rarr_ArrayTemp(lng_TempPos) = rarr_ArrayToSort(rlng_Left)
        rlng_Left = (rlng_Left + 1)
        lng_TempPos = (lng_TempPos + 1)
    Loop
    Do While rlng_MiddleIndex <= rlng_Right
        rarr_ArrayTemp(lng_TempPos) = rarr_ArrayToSort(rlng_MiddleIndex)
        rlng_MiddleIndex = (rlng_MiddleIndex + 1)
        lng_TempPos = (lng_TempPos + 1)
    Loop
    For lng_Loop_01 = 0 To (lng_ElementCount - 1)
        rarr_ArrayToSort(rlng_Right) = rarr_ArrayTemp(rlng_Right)
        rlng_Right = (rlng_Right - 1)
    Next
End Function

Public Function Array_MergeSort(ByRef rarr_ArrayToSort(), ByRef rarr_ArrayTemp(), ByVal rlng_FirstIndex, ByVal rlng_LastIndex)
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   Note            :The rarr_ArrayTemp array that is passed in has to be dimensionalized to the same size
'                           as the rarr_ArrayToSort array that is passed in prior to calling the function.
'                           Also the rlng_FirstIndex variable should be the value of the LBound(rarr_ArrayToSort)
'                           and the rlng_LastIndex variable should be the value of the UBound(rarr_ArrayToSort)
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_MergeSort"
    Dim lng_MiddleIndex

    If rlng_LastIndex > rlng_FirstIndex Then
        ' Recursively sort the two halves of the list.
        lng_MiddleIndex = ((rlng_FirstIndex + rlng_LastIndex) / 2)
        Call Array_MergeSort(rarr_ArrayToSort, rarr_ArrayTemp, rlng_FirstIndex, lng_MiddleIndex)
        Call Array_MergeSort(rarr_ArrayToSort, rarr_ArrayTemp, lng_MiddleIndex + 1, rlng_LastIndex)
        '  Merge the results.
        Call Array_Merge(rarr_ArrayToSort, rarr_ArrayTemp, rlng_FirstIndex, lng_MiddleIndex + 1, rlng_LastIndex)
    End If
End Function

Public Function Array_Push(ByRef rarr_Array, ByVal rstr_Value, ByVal rstr_Delimiter)
    Const const_FUNCTION_NAME = "Array_Push"
    Dim int_Loop
    Dim str_Array_01
    Dim str_Array_02

    'If there is no delimiter passed in then set the default delimiter equal to a comma.
    If rstr_Delimiter = "" Then
        rstr_Delimiter = ","
    End If

    'Check to see if the rarr_Array is actually an Array.
    If IsArray(rarr_Array) = True Then
        'Verify that the rarr_Array variable is only a one dimensional array.
        If Array_GetDimensions(rarr_Array) <> 1 Then
            Array_Push = "ERR, the rarr_Array variable passed in was not a one dimensional array."
            Exit Function
        End If
        If IsArray(rstr_Value) = True Then
            'Verify that the rstr_Value variable is is only a one dimensional array.
            If Array_GetDimensions(rstr_Value) <> 1 Then
                Array_Push = "ERR, the rstr_Value variable passed in was not a one dimensional array."
                Exit Function
            End If
            str_Array_01 = Split(rarr_Array, rstr_Delimiter)
            str_Array_02 = Split(rstr_Value, rstr_Delimiter)
            rarr_Array = Join(str_Array_01 & rstr_Delimiter & str_Array_02)
        Else
            On Error Resume Next
            ReDim Preserve rarr_Array(UBound(rarr_Array) + 1)
            If Err.Number <> 0 Then ' "Subscript out of range"  An array that was passed in must have been Erased to re-create it with new elements (possibly when passing an array to be populated into a recursive function)
                ReDim rarr_Array(0)
                Err.Clear
            End If
            If IsObject(rstr_Value) = True Then
                Set rarr_Array(UBound(rarr_Array)) = rstr_Value
            Else
                rarr_Array(UBound(rarr_Array)) = rstr_Value
            End If
        End If
    Else
        'Check to see if the rstr_Value is an Array.
        If IsArray(rstr_Value) = True Then
            'Verify that the rstr_Value variable is is only a one dimensional array.
            If Array_GetDimensions(rstr_Value) <> 1 Then
                Array_Push = "ERR, the rstr_Value variable passed in was not a one dimensional array."
                Exit Function
            End If
            rarr_Array = rstr_Value
        Else
            rarr_Array = Split(rstr_Value, rstr_Delimiter)
        End If
    End If
    Array_Push = UBound(rarr_Array)
End Function

Public Function Array_QuickSort(ByRef rarr_ArrayToSort(), ByVal rlng_Low, ByVal rlng_High)
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   Note            :The rlng_Low variable should be the value of the LBound(rarr_ArrayToSort)
'                           and the rlng_High variable should be the value of the UBound(rarr_ArrayToSort)
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_QuickSort"
    Dim var_Pivot
    Dim lng_Swap
    Dim lng_Low
    Dim lng_High

    lng_Low = rlng_Low
    lng_High = rlng_High
    var_Pivot = rarr_ArrayToSort((rlng_Low + rlng_High) / 2)
    Do While lng_Low <= lng_High
        Do While (rarr_ArrayToSort(lng_Low) < var_Pivot _
        And lng_Low < rlng_High)
            lng_Low = lng_Low + 1
        Loop
        Do While (var_Pivot < rarr_ArrayToSort(lng_High) _
        And lng_High > rlng_Low)
            lng_High = (lng_High - 1)
        Loop
        If lng_Low <= lng_High Then
            lng_Swap = rarr_ArrayToSort(lng_Low)
            rarr_ArrayToSort(lng_Low) = rarr_ArrayToSort(lng_High)
            rarr_ArrayToSort(lng_High) = lng_Swap
            lng_Low = (lng_Low + 1)
            lng_High = (lng_High - 1)
        End If
    Loop
    If rlng_Low < lng_High Then
        Call Array_QuickSort(rarr_ArrayToSort, rlng_Low, lng_High)
    End If
    If lng_Low < rlng_High Then
        Call Array_QuickSort(rarr_ArrayToSort, lng_Low, rlng_High)
    End If
End Function

Public Function Array_SelectionSort(ByRef rarr_ArrayToSort())
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_SelectionSort"
    Dim lng_ElementCount
    Dim lng_Loop_01
    Dim lng_Loop_02
    Dim lng_Min
    Dim var_Temp

    lng_ElementCount = UBound(rarr_ArrayToSort) + 1
    For lng_Loop_01 = 0 To (lng_ElementCount - 2)
        lng_Min = lng_Loop_01
        For lng_Loop_02 = (lng_Loop_01 + 1) To lng_ElementCount - 1
            If rarr_ArrayToSort(lng_Loop_02) < rarr_ArrayToSort(lng_Min) Then
            lng_Min = lng_Loop_02
            End If
        Next
        var_Temp = rarr_ArrayToSort(lng_Loop_01)
        rarr_ArrayToSort(lng_Loop_01) = rarr_ArrayToSort(lng_Min)
        rarr_ArrayToSort(lng_Min) = var_Temp
    Next
End Function

Public Function Array_ShellSort(ByRef rarr_ArrayToSort())
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sorts an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_ShellSort"
    Dim lng_Loop_01
    Dim var_Temp
    Dim lng_Hold
    Dim lng_HValue

    lng_HValue = LBound(rarr_ArrayToSort)
    Do
        lng_HValue = (3 * lng_HValue + 1)
    Loop Until lng_HValue > UBound(rarr_ArrayToSort)
    Do
        lng_HValue = (lng_HValue / 3)
        For lng_Loop_01 = (lng_HValue + LBound(rarr_ArrayToSort)) To UBound(rarr_ArrayToSort)
            var_Temp = rarr_ArrayToSort(lng_Loop_01)
            lng_Hold = lng_Loop_01
            Do While rarr_ArrayToSort(lng_Hold - lng_HValue) > var_Temp
                rarr_ArrayToSort(lng_Hold) = rarr_ArrayToSort(lng_Hold - lng_HValue)
                lng_Hold = (lng_Hold - lng_HValue)
                If lng_Hold < lng_HValue Then
                    Exit Do
                End If
            Loop
            rarr_ArrayToSort(lng_Hold) = var_Temp
        Next
    Loop Until lng_HValue = LBound(rarr_ArrayToSort)
End Function

Private Function Array_SiftDown(ByRef rarr_ArrayToSort(), ByVal rlng_Root, ByVal rlng_Bottom)
'   ==================================================================================
'   Date            : 03/18/2008
'   Author          : Christopher J. Scharer (CJS)
'   Description     : Sifts the elements down in an array.
'   ==================================================================================
    Const const_FUNCTION_NAME = "Array_SiftDown"
    Dim bln_Done
    Dim max_Child
    Dim var_Temp

    bln_Done = False
    Do While ((rlng_Root * 2) <= rlng_Bottom) _
    And bln_Done = False
        If rlng_Root * 2 = rlng_Bottom Then
            max_Child = (rlng_Root * 2)
        ElseIf rarr_ArrayToSort(rlng_Root * 2) > rarr_ArrayToSort(rlng_Root * 2 + 1) Then
            max_Child = (rlng_Root * 2)
        Else
            max_Child = (rlng_Root * 2 + 1)
        End If
        If rarr_ArrayToSort(rlng_Root) < rarr_ArrayToSort(max_Child) Then
            var_Temp = rarr_ArrayToSort(rlng_Root)
            rarr_ArrayToSort(rlng_Root) = rarr_ArrayToSort(max_Child)
            rarr_ArrayToSort(max_Child) = var_Temp
            rlng_Root = max_Child
        Else
            bln_Done = True
        End If
    Loop
End Function 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-25T15:27:51.117

这是快速排序的另一个 vbscript 实现。这是维基百科中定义的就地、不稳定的方法（参见此处：[http](http://en.wikipedia.org/wiki/Quicksort) ://en.wikipedia.org/wiki/Quicksort ）。使用更少的内存（原始实现需要在每次迭代时创建上下临时存储数组，在最坏的情况下可以将内存大小增加 n 项）。

对于升序，切换符号。

如果要对字符进行排序，请使用 Asc(ch) 函数。

```
'-------------------------------------
 '  quicksort
 '    Carlos Nunez, created: 25 April, 2010.
 '
 '  NOTE:   partition function also
 '          required
 '-------------------------------------
function qsort(list, first, last)
    Dim i, j
    if (typeName(list) <> "Variant()" or ubound(list) = 0) then exit function       'list passed must be a collection or array.

    'if the set size is less than 3, we can do a simple comparison sort.
    if (last-first) < 3 then
        for i = first to last
            for j = first to last
                if list(i) < list(j) then
                    swap list,i,j
                end if
            next
        next
    else
        dim p_idx

        'we need to set the pivot relative to the position of the subset currently being sorted.
        'if the starting position of the subset is the first element of the whole set, then the pivot is the median of the subset.
        'otherwise, the median is offset by the first position of the subset.
        '-------------------------------------------------------------------------------------------------------------------------
        if first-1 < 0 then
            p_idx   = round((last-first)/2,0)
        else
            p_idx   = round(((first-1)+((last-first)/2)),0)
        end if

        dim p_nidx:     p_nidx  = partition(list, first, last, p_idx)
        if p_nidx = -1 then exit function

        qsort list, first, p_nidx-1
        qsort list, p_nidx+1, last
    end if
end function

function partition(list, first, last, idx)
    Dim i
    partition = -1

    dim p_val:      p_val = list(idx)
    swap list,idx,last
    dim swap_pos:   swap_pos = first
    for i = first to last-1 
        if list(i) <= p_val then
            swap list,i,swap_pos
            swap_pos = swap_pos + 1
        end if
    next
    swap list,swap_pos,last

    partition = swap_pos
end function

function swap(list,a_pos,b_pos)
    dim tmp
    tmp = list(a_pos)
    list(a_pos) = list(b_pos)
    list(b_pos) = tmp   
end function 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-27T12:59:02.433

这是合并排序的 vbscript 实现。

```
'@Function Name: Sort
'@Author: Lewis Gordon
'@Creation Date: 4/26/12
'@Description: Sorts a given array either in ascending or descending order, as specified by the
'                order parameter.  This array is then returned at the end of the function.
'@Prerequisites:  An array must be allocated and have all its values inputted.
'@Parameters:
'    $ArrayToSort:  This is the array that is being sorted.
'    $Order:  This is the sorting order that the array will be sorted in.  This parameter 
'                can either    be "ASC" or "DESC" or ascending and descending, respectively.
'@Notes:  This uses merge sort under the hood.  Also, this function has only been tested for
'            integers and strings in the array.  However, this should work for any data type that
'            implements the greater than and less than comparators.  This function also requires
'            that the merge function is also present, as it is needed to complete the sort.
'@Examples:
'    Dim i
'    Dim TestArray(50)
'    Randomize
'    For i=0 to UBound(TestArray)
'        TestArray(i) = Int((100 - 0 + 1) * Rnd + 0)
'    Next
'    MsgBox Join(Sort(TestArray, "DESC"))
'
'@Return value:  This function returns a sorted array in the specified order.
'@Change History: None

'The merge function.
Public Function Merge(LeftArray, RightArray, Order)
    'Declared variables
    Dim FinalArray
    Dim FinalArraySize
    Dim i
    Dim LArrayPosition
    Dim RArrayPosition

    'Variable initialization
    LArrayPosition = 0
    RArrayPosition = 0

    'Calculate the expected size of the array based on the two smaller arrays.
    FinalArraySize = UBound(LeftArray) + UBound(RightArray) + 1
    ReDim FinalArray(FinalArraySize)

    'This should go until we need to exit the function.
    While True

        'If we are done with all the values in the left array.  Add the rest of the right array
        'to the final array.
        If LArrayPosition >= UBound(LeftArray)+1 Then
            For i=RArrayPosition To UBound(RightArray)
                FinalArray(LArrayPosition+i) = RightArray(i)
            Next
            Merge = FinalArray
            Exit Function

        'If we are done with all the values in the right array.  Add the rest of the left array
        'to the final array.
        ElseIf RArrayPosition >= UBound(RightArray)+1 Then
            For i=LArrayPosition To UBound(LeftArray)
                FinalArray(i+RArrayPosition) = LeftArray(i)
            Next
            Merge = FinalArray
            Exit Function

        'For descending, if the current value of the left array is greater than the right array 
        'then add it to the final array.  The position of the left array will then be incremented
        'by one.
        ElseIf LeftArray(LArrayPosition) > RightArray(RArrayPosition) And UCase(Order) = "DESC" Then
            FinalArray(LArrayPosition+RArrayPosition) = LeftArray(LArrayPosition)
            LArrayPosition = LArrayPosition + 1

        'For ascending, if the current value of the left array is less than the right array 
        'then add it to the final array.  The position of the left array will then be incremented
        'by one.
        ElseIf LeftArray(LArrayPosition) < RightArray(RArrayPosition) And UCase(Order) = "ASC" Then
            FinalArray(LArrayPosition+RArrayPosition) = LeftArray(LArrayPosition)
            LArrayPosition = LArrayPosition + 1

        'For anything else that wasn't covered, add the current value of the right array to the
        'final array.
        Else
            FinalArray(LArrayPosition+RArrayPosition) = RightArray(RArrayPosition)
            RArrayPosition = RArrayPosition + 1
        End If
    Wend
End Function

'The main sort function.
Public Function Sort(ArrayToSort, Order)
    'Variable declaration.
    Dim i
    Dim LeftArray
    Dim Modifier
    Dim RightArray

    'Check to make sure the order parameter is okay.
    If Not UCase(Order)="ASC" And Not UCase(Order)="DESC" Then
        Exit Function
    End If
    'If the array is a singleton or 0 then it is sorted.
    If UBound(ArrayToSort) <= 0 Then
        Sort = ArrayToSort
        Exit Function
    End If

    'Setting up the modifier to help us split the array effectively since the round
    'functions aren't helpful in VBScript.
    If UBound(ArrayToSort) Mod 2 = 0 Then
        Modifier = 1
    Else
        Modifier = 0
    End If

    'Setup the arrays to about half the size of the main array.
    ReDim LeftArray(Fix(UBound(ArrayToSort)/2))
    ReDim RightArray(Fix(UBound(ArrayToSort)/2)-Modifier)

    'Add the first half of the values to one array.
    For i=0 To UBound(LeftArray)
        LeftArray(i) = ArrayToSort(i)
    Next

    'Add the other half of the values to the other array.
    For i=0 To UBound(RightArray)
        RightArray(i) = ArrayToSort(i+Fix(UBound(ArrayToSort)/2)+1)
    Next

    'Merge the sorted arrays.
    Sort = Merge(Sort(LeftArray, Order), Sort(RightArray, Order), Order)
End Function 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T13:21:36.530

您要么必须手动编写自己的排序，要么尝试这种技术：

[http://www.aspfaqs.com/aspfaqs/ShowFAQ.asp?FAQID=83](http://www.aspfaqs.com/aspfaqs/ShowFAQ.asp?FAQID=83)

您可以自由地将服务器端 javascript 与 VBScript 混合使用，因此只要 VBScript 不足，就切换到 javascript。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T13:24:45.620

VBScript 没有对数组进行排序的方法，因此您有两种选择：

*   从头开始编写像mergesort这样的排序函数。
*   使用[本文中的 JScript 技巧](http://www.aspfaqs.com/aspfaqs/ShowFAQ.asp?FAQID=83)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-28T07:41:16.813

当有大（“宽”）数组时，不要移动一长行数据的每个元素，而是使用带有数组索引的一维数组。

用 0,1,2,3,..uBound(arr) 初始化 ptr_arr 然后用

```
arr(field_index,ptr_arr(row_index)) 
```

代替

```
arr(field_index,row_index) 
```

并且只是交换 ptr_arr 的元素而不是交换行。

如果您正在逐行处理数组，例如将其显示为 a ，则可以从内部循环中查看：

```
max_col=uBound(arr,1)
response.write "<table>"
for n = 0 to uBound(arr,2)
  response.write "<tr>"
  row=ptr_arr(n)
  for i=0 to max_col
    response.write "<td>"&arr(i,row)&"</td>"
  next
  response.write "</tr>
next
response.write "</table>" 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-11-29T09:16:31.493

一个古老但仍然被问到的问题。人们发布了指向该解决方案的链接，但现在已损坏，因此我发布了一个示例： 您可以使用 ScriptControl 访问 JScript 的数组排序 您可以提供自己的 jscript 排序功能。不幸的是，它仅适用于 32 位版本的 wsh...

```
a=split("this is a javascript array sort demo"," ")

wscript.echo vbcrlf & "alphabeticaly"&vbcrlf
a=sort(a)
for each i in a
  wscript.echo i
next
wscript.echo vbcrlf & "by length"&vbcrlf
a=sortbylength(a)
for each i in a
  wscript.echo i
next

function sort(a)
with createobject("ScriptControl")
    .Language = "JScript"
    .AddCode "function sortvbs(a) {return a.toArray().sort().join('\b')}"
     sort= split(.Run("sortvbs",a),chr(8))
 End With
end function

function sortbylength(a)
with createobject("ScriptControl")
    .Language = "JScript"
    .AddCode "function lensort(a,b){return((('' + a).length > ('' + b).length) ? 1 : ((('' + a).length < ('' + b).length) ? -1 : 0))}" 
    .Addcode "function sortvbs(a) {return a.toArray().sort(lensort).join('\b')}"
     sortbylength= split(.Run("sortvbs",a),chr(8))
 End With
end function 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-11-06T13:55:18.897

实际上，我昨天只需要做一些类似的事情，但使用的是 2D 数组。我对 vbscript 的速度并没有那么快，这个过程真的让我陷入了困境。我发现[这里](http://www.4guysfromrolla.com/webtech/011001-1.shtml)的文章写得很好，让我走上了用 vbscript 排序的道路。

# java - 在 Swing 应用程序中使用 Hibernate 进行会话管理

> ID：268651
> 
> 赞同：7
> 
> 时间：2008-11-06T13:17:58.927
> 
> 标签：java, database, hibernate, swing, session

您如何在 Java Desktop Swing 应用程序中进行 Hibernate 会话管理？您使用单个会话吗？多个会话？

以下是有关该主题的一些参考资料：

*   [http://www.hibernate.org/333.html](http://www.hibernate.org/333.html)
*   [http://blog.schauderhaft.de/2008/09/28/hibernate-sessions-in-two-tier-rich-client-applications/](http://blog.schauderhaft.de/2008/09/28/hibernate-sessions-in-two-tier-rich-client-applications/)
*   [http://in.relation.to/Bloggers/HibernateAndSwingDemoApp](http://in.relation.to/Bloggers/HibernateAndSwingDemoApp)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T14:02:45.810

单次会议。当你需要做一组操作时开始事务（比如对话框确定按钮后更新数据），最后提交 tx。虽然连接是不断打开的（因为它是同一个会话），因此 Hib 和 RDBMS 都可以使用所有缓存机会。

实现透明会话重新打开以防连接失效也是一个好主意——用户倾向于让应用程序长时间保持打开状态，即使数据库服务器在周末重新启动，它也应该在周一继续工作.

**更新**

Jens Schauder 提供了使用多个会话的理由：对会话进行部分（不需要的）更新。好吧，这取决于您使用 Hibernate 的方式。

假设我们打开了两个对话框（如 Jens 的博客示例中所示）。如果用户单击一个单选框，我们立即更新与此单选框关联的 Hibernate 实体，那么，当用户单击“取消”时，我们就有麻烦了——会话已经更新。

如我所见，正确的方法是仅更新对话框变量（非休眠对象）。然后，当用户单击确定时，我们开始一个事务，合并更新的对象，提交事务。没有垃圾被保存到会话中。

```
MyHibernateUtils.begin();
Settings settings = DaoSettings.load();
// update setttings here
DaoSettings.save(settings);
MyHibernateUtils.commit(); 
```

如果我们实现了如此清晰的关注点分离，我们稍后可以通过简单更改 MyHibernateUtils.begin() 实现来切换到多个会话。

至于可能的内存泄漏，嗯...... Transaction.commit() 调用 Session.flush()，AFAIK 也会清理缓存。此外，可以通过调用 Session.setCacheMode() 手动控制缓存策略。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T21:58:32.107

不要使用单个会话。对于除了最小的应用程序之外的所有应用程序，它都会增长，收集过时的数据并且变得越来越慢，因为脏检查需要检查会话中的每个实体。

如果您不需要/不希望 Hibernate 延迟加载和跟踪更改，您可以使用短期会话。

但是，如果您想从 Hibernate 的强大功能中受益，请使用我在博客中描述的方法：http: [//blog.schauderhaft.de/2008/09/28/hibernate-sessions-in-two-tier-rich-client-应用/](http://blog.schauderhaft.de/2008/09/28/hibernate-sessions-in-two-tier-rich-client-applications/)

或在德语版本中：

[http://blog.schauderhaft.de/2007/12/17/hibernate-sessions-in-fat-client-anwendungen/](http://blog.schauderhaft.de/2007/12/17/hibernate-sessions-in-fat-client-anwendungen/)

AFAIK 它实际上与[http://in.relation.to/Bloggers/HibernateAndSwingDemoApp](http://in.relation.to/Bloggers/HibernateAndSwingDemoApp)中描述的方法相同，但建议如何实际确定会话范围：每帧会话，但使用会话的模态帧除外父框架。

只要确保永远不要组合来自不同会话的对象。会带来很多麻烦。

回复弗拉基米尔更新：

*   取消实际上对我的方法非常有效：丢弃会话。
*   当您为应用程序使用单个会话时，session.flush 不能解决不断增长的会话问题。当然，通过这种方法，您描述您可以使用应该可以正常工作的短期会话。但
*   你会损失很多：延迟加载仅适用于附加对象，自动检测脏对象。如果您使用分离的对象（或根本不是实体的对象），您必须自己执行此操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T19:40:48.863

“''每线程会话''”的问题是好的 Swing 应用程序在 EDT 之外进行数据库访问，通常在新创建的 SwingWorker 线程中。这样，“''session per thread''”很快就变成了“''session per click''”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T21:14:13.287

每个线程使用一个会话 ( [doc](http://www.hibernate.org/42.html#A6) ) 和一个版本或时间戳列来允许乐观并发，从而避免会话到实例的冲突。除非您需要长时间运行的事务或限制性隔离级别，否则在需要时将实例附加到会话。

# floating-point - 浮点舍入检测

> ID：268652
> 
> 赞同：2
> 
> 时间：2008-11-06T13:18:11.610
> 
> 标签：floating-point, rounding

我正在使用 java 并指的是“双”数据类型。为了简短起见，我正在从标准输入中读取一些值，这些值在我的代码中作为双精度值读取（我更愿意使用 BigInteger 之类的东西，但现在不可能）。

我希望从用户那里获得双精度值，但有时他们可能会输入以下内容：999999999999999999999999999.9999999999 我认为这超出了双精度的准确表示，并且四舍五入到 1.0E27（可能）。

我想获得一些关于如何检测特定值是否无法以双精度表示并需要四舍五入的指示（以便我可以拒绝该值或其他此类操作）。

非常感谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T13:21:42.523

人类输入的大多数值都不能用双精度表示。

例如，您是否要阻止用户输入 0.1？这不能完全表示为双精度数。

要查找错误的规模，您可以执行以下操作：

```
BigDecimal userAsDecimal = new BigDecimal(userInput);
double userAsDouble = double.parseDouble(userInput);
BigDecimal doubleToDecimal = new BigDecimal(userAsDouble);
BigDecimal error = userAsDecimal.subtract(userAsDouble).abs(); 
```

然后检查“错误”是否小到可以接受的程度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T13:22:58.743

```
double orig = GetSomeDouble();
double test1 = orig - 1;
if ( orig == test1 )
   SomethingIsWrong();
double test2 = test1 + 1;
if ( orig != test2 )
   SomethingIsWrong(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T13:40:52.313

您不能使用双精度来精确地按照您要求的方式存储某些内容，用户很少会输入双精度可以完美表示的数字，但这只是巧合。如果您需要存储确切的数字，只要您不需要进行任何操作，您就可以使用字符串。如果您需要更多，那么可能有一些库是为这种精确的数学而设计的。

# flash - 在 Actionscript 3.0 中访问父属性/方法

> ID：268656
> 
> 赞同：2
> 
> 时间：2008-11-06T13:20:47.983
> 
> 标签：flash, actionscript-3, cs3

我正在尝试从作为主舞台子级的 MovieClip 控制我的 Flash 应用程序的主时间线。显然，在 ActionScript 2 中，您可以使用 _root 执行此操作，但使用 root（因为 _root 不再存在）现在会出现错误：

```
root.play(); 
```

“1061：通过静态类型 flash.display:DisplayObjectContainer 的引用调用可能未定义的方法播放。”

使用 Stage 类也不起作用：

```
stage.play(); 
```

“1061：通过静态类型 flash.display:Stage 的引用调用可能未定义的方法播放。”

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T14:29:50.403

您需要将其投射到 MovieClip

```
(root as MovieClip).play() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T14:00:07.780

根据[http://www.adobe.com/cfusion/webforums/forum/messageview.cfm?forumid=15&catid=665&threadid=1387264&enterthread=y](http://www.adobe.com/cfusion/webforums/forum/messageview.cfm?forumid=15&catid=665&threadid=1387264&enterthread=y)，

尝试类似
    MovieClip(root).gotoAndPlay("menu");

祝你好运，
兰迪·施泰格鲍尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-22T05:04:15.547

另一种方法是将您的movieclip 代码分成单独的类，同时为您的主fla 设置文档类。

假设你的main fla的文档类是Main.as，你的movieclip的类文件是Movie.as，你可以在Movie类构造函数中添加Main类指针作为参数

在 Main.as

`public class Main() { var m = new Movie(this); }`

在电影.as

```
public class Movie(m:Main) { m.gotoAndPlay("somewhere"); } 
```

# ntp - NTP 客户端会针对 SNTP 服务器工作吗？

> ID：268664
> 
> 赞同：5
> 
> 时间：2008-11-06T13:22:53.190
> 
> 标签：ntp

SNTP 是完整 NTP 规范的简化版。

我想针对 Windows XP 中包含的内部 SNTP 服务器使用完整的 NTP 客户端。这会起作用还是 NTP 客户端需要完整的 NTP 服务器才能工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-07T11:44:49.020

我在 SNTP RFC 2030 中找到了答案：

> SNTP 版本 4 旨在与现有的 NTP 和 SNTP 版本 3 客户端和服务器以及提议的版本 4 客户端和服务器共存。当使用当前和以前版本的 NTP 和 SNTP 运行时，SNTP 版本 4 不需要更改协议或现在正在运行或可能专门为 NTP 或 SNTP 版本 4 实现的实现。对于 NTP 或 SNTP 服务器，**NTP 和 SNTP 客户端是无法区分；对于 NTP 或 SNTP 客户端，NTP 和 SNTP 服务器无法区分。**

所以，是的，它会起作用。 

# c# - 将 IList 或 IEnumerable 转换为数组的最佳方法

> ID：268671
> 
> 赞同：106
> 
> 时间：2008-11-06T13:25:12.763
> 
> 标签：c#, nhibernate

我有一个 HQL 查询，可以生成 IList 结果或 IEnumerable 结果。

但是，我希望它返回我正在选择的实体数组，实现这一目标的最佳方法是什么？我可以枚举它并构建数组，或者使用 CopyTo() 定义的数组。

有没有更好的办法？我采用了 CopyTo 方法。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-11-06T13:34:58.627

您使用的是哪个版本的 .NET？如果它是 .NET 3.5，我会打电话`ToArray()`并完成它。

如果您只有一个非泛型 IEnumerable，请执行以下操作：

```
IEnumerable query = ...;
MyEntityType[] array = query.Cast<MyEntityType>().ToArray(); 
```

如果您不知道该方法中的类型但该方法的调用者知道它，请将该方法设为通用并尝试以下操作：

```
public static void T[] PerformQuery<T>()
{
    IEnumerable query = ...;
    T[] array = query.Cast<T>().ToArray();
    return array;
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2011-04-18T12:41:52.207

将以下内容放入您的 .cs 文件中：

```
using System.Linq; 
```

然后，您将能够使用 System.Linq.Enumerable 中的以下扩展方法：

```
public static TSource[] ToArray<TSource>(this System.Collections.Generic.IEnumerable<TSource> source) 
```

IE

```
IEnumerable<object> query = ...;
object[] bob = query.ToArray(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-06T19:43:39.810

我想重新发明轮子...

```
public static T[] ConvertToArray<T>(this IEnumerable<T> enumerable)
{
    if (enumerable == null)
        throw new ArgumentNullException("enumerable");

    return enumerable as T[] ?? enumerable.ToArray();
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-01-26T16:38:30.530

如果您没有 Linq，我通过以下方式解决了它：

```
 private T[] GetArray<T>(IList<T> iList) where T: new()
    {
        var result = new T[iList.Count];

        iList.CopyTo(result, 0);

        return result;
    } 
```

希望能帮助到你

# java - 那里有没有重复的 List 实现吗？

> ID：268672
> 
> 赞同：92
> 
> 时间：2008-11-06T13:25:41.313
> 
> 标签：java, list, collections, duplicates

我知道[`SortedSet`](https://docs.oracle.com/javase/9/docs/api/java/util/SortedSet.html)，但在我的情况下，我需要实现的东西`List`，而不是`Set`。那么在 API 或其他地方有实现吗？

自己实现应该不难，但我想为什么不先问这里的人呢？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-11-06T13:38:42.440

标准库中没有用于执行此操作的 Java 集合。[`LinkedHashSet<E>`](https://docs.oracle.com/javase/9/docs/api/java/util/LinkedHashSet.html)但是，保留与 a 类似的顺序`List`，因此，如果您将集合包装在 a 中`List`，当您想将其用作 a 时，`List`您将获得所需的语义。

或者，[Commons Collections](https://commons.apache.org/proper/commons-collections/)（或者`commons-collections4`，对于通用版本）有一个`List`你想要的东西：[`SetUniqueList`](https://commons.apache.org/proper/commons-collections/javadocs/api-3.2.2/index.html?org/apache/commons/collections/list/SetUniqueList.html)/ [`SetUniqueList<E>`](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/list/SetUniqueList.html)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-04-24T17:36:24.533

这是我所做的并且它有效。

假设我有一个`ArrayList`工作，我做的第一件事就是创建一个新的`LinkedHashMap`.

```
LinkedHashSet<E> hashSet = new LinkedHashSet<E>() 
```

然后我尝试将我的新元素添加到`LinkedHashSet`. `LinkedHasSet`如果新元素是重复的，add 方法不会改变并返回 false。所以这成为我可以在添加到`ArrayList`.

```
if (hashSet.add(E)) arrayList.add(E); 
```

这是防止将重复项添加到数组列表中的一种简单而优雅的方法。如果您愿意，可以将其封装在扩展`ArrayList`. 只需记住`addAll`通过循环遍历元素并调用 add 方法来处理。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-06T14:15:51.553

所以这就是我最终所做的。我希望这对其他人有帮助。

```
class NoDuplicatesList<E> extends LinkedList<E> {
    @Override
    public boolean add(E e) {
        if (this.contains(e)) {
            return false;
        }
        else {
            return super.add(e);
        }
    }

    @Override
    public boolean addAll(Collection<? extends E> collection) {
        Collection<E> copy = new LinkedList<E>(collection);
        copy.removeAll(this);
        return super.addAll(copy);
    }

    @Override
    public boolean addAll(int index, Collection<? extends E> collection) {
        Collection<E> copy = new LinkedList<E>(collection);
        copy.removeAll(this);
        return super.addAll(index, copy);
    }

    @Override
    public void add(int index, E element) {
        if (this.contains(element)) {
            return;
        }
        else {
            super.add(index, element);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-06T13:32:55.743

为什么不用列表封装一个集合，排序如下：

```
new ArrayList( new LinkedHashSet() ) 
```

这为真正的收藏大师留下了另一个实现;-)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-06T16:28:24.360

您应该认真考虑 dhiller 的回答：

1.  不必担心将对象添加到无重复列表中，而是将它们添加到集合（任何实现）中，这将本质上过滤掉重复项。
2.  当您需要调用需要 List 的方法时，请将其包装在 a `new ArrayList(set)`（或 a`new LinkedList(set)`等）中。

我认为您发布的解决方案`NoDuplicatesList`存在一些问题，主要与`contains()`方法有关，而且您的类不处理检查传递给您的`addAll()`方法的 Collection 中的重复项。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-21T20:50:41.167

我需要类似的东西，所以我去了*commons 集合*并使用了`SetUniqueList`，但是当我进行一些性能测试时，我发现如果我想使用 a并使用该方法`Set`获得a ，它似乎没有优化。`Array``Set.toArray()`

与其他实现相比，填充然后遍历100,000*个字符串*`SetUniqueTest`需要*20:1 的时间*，这是一个很大的区别。

 *因此，如果您担心性能，我建议您使用**Set and Get an Array**而不是使用`SetUniqueList`，除非您确实需要 的逻辑，否则您`SetUniqueList`需要检查其他解决方案...

**测试代码主要方法**：

```
public static void main(String[] args) {

SetUniqueList pq = SetUniqueList.decorate(new ArrayList());
Set s = new TreeSet();

long t1 = 0L;
long t2 = 0L;
String t;

t1 = System.nanoTime();
for (int i = 0; i < 200000; i++) {
    pq.add("a" + Math.random());
}
while (!pq.isEmpty()) {
    t = (String) pq.remove(0);
}
t1 = System.nanoTime() - t1;

t2 = System.nanoTime();
for (int i = 0; i < 200000; i++) {
    s.add("a" + Math.random());
}

s.clear();
String[] d = (String[]) s.toArray(new String[0]);
s.clear();
for (int i = 0; i < d.length; i++) {
    t = d[i];

}
t2 = System.nanoTime() - t2;

System.out.println((double)t1/1000/1000/1000); //seconds
System.out.println((double)t2/1000/1000/1000); //seconds
System.out.println(((double) t1) / t2);        //comparing results 
```

}

问候， [穆罕默德·斯莱姆](http://abusleem.net/blog)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-04T05:32:04.060

注意：它不考虑**subList**实现。

```
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashSet;
import java.util.Set;

public class UniqueList<T> extends ArrayList<T> {

    private static final long serialVersionUID = 1L;

    /** Unique elements SET */
    private final Set<T> set=new HashSet();

    /** Used by addAll methods */
    private Collection<T> addUnique(Collection<? extends T> col) {
        Collection<T> unique=new ArrayList();
        for(T e: col){
            if (set.add(e)) unique.add(e);
        }
        return unique;
    }

    @Override
    public boolean add(T e) {
        return set.add(e) ? super.add(e) : false;
    }

    @Override
    public boolean addAll(Collection<? extends T> col) {
        return super.addAll(addUnique(col));
    }

    @Override
    public void add(int index, T e) {
        if (set.add(e)) super.add(index, e);
    }

    @Override
    public boolean addAll(int index, Collection<? extends T> col) {
        return super.addAll(index, addUnique(col));
    }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T13:35:48.343

[收集接口](http://docs.oracle.com/javase/tutorial/collections/interfaces/index.html)的文档说：

> Set — 一个不能包含重复元素的集合。
> List — 有序集合（有时称为序列）。列表可以包含重复的元素。

所以如果你不想重复，你可能不应该使用列表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T13:40:51.640

在我的脑海中，列表允许重复。在调用继承的方法之前，您可以快速实现 a`UniqueArrayList`并覆盖所有要检查的`add`/函数。对于个人使用，您只能实现您使用的方法，并覆盖其他方法以引发异常，以防将来的程序员尝试以不同的方式使用列表。`insert``contains()``add`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-02T11:00:55.607

那这个呢？只需检查列表，然后再添加包含现有对象的内容

```
while (searchResult != null && searchResult.hasMore()) {
    SearchResult nextElement = searchResult.nextElement();
    Attributes attributes = nextElement.getAttributes();

    String stringName = getAttributeStringValue(attributes, SearchAttribute.*attributeName*);

   if(!List.contains(stringName)){
    List.add(stringName);
   }
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-01-13T13:07:43.753

在`add`方法中，为什么不使用`HashSet.add()`检查重复项而不是`HashSet.consist()`. 如果没有重复`HashSet.add()`则返回，否则返回。`true``false`

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2011-10-06T19:22:16.710

我刚刚在自己的小库中创建了自己的 UniqueList，如下所示：

```
package com.bprog.collections;//my own little set of useful utilities and classes

import java.util.HashSet;
import java.util.ArrayList;
import java.util.List;
/**
*
* @author Jonathan
*/
public class UniqueList {

private HashSet masterSet = new HashSet();
private ArrayList growableUniques;
private Object[] returnable;

public UniqueList() {
    growableUniques = new ArrayList();
}

public UniqueList(int size) {
    growableUniques = new ArrayList(size);
}

public void add(Object thing) {
    if (!masterSet.contains(thing)) {
        masterSet.add(thing);
        growableUniques.add(thing);
    }
}

/**
 * Casts to an ArrayList of unique values
 * @return 
 */
public List getList(){
    return growableUniques;
}

public Object get(int index) {
    return growableUniques.get(index);
}

public Object[] toObjectArray() {
    int size = growableUniques.size();
    returnable = new Object[size];
    for (int i = 0; i < size; i++) {
        returnable[i] = growableUniques.get(i);
    }
    return returnable;
    }
} 
```

我有一个看起来像这样的 TestCollections 类：

```
package com.bprog.collections;
import com.bprog.out.Out;
/**
*
* @author Jonathan
*/
public class TestCollections {
    public static void main(String[] args){
        UniqueList ul = new UniqueList();
        ul.add("Test");
        ul.add("Test");
        ul.add("Not a copy");
        ul.add("Test"); 
        //should only contain two things
        Object[] content = ul.toObjectArray();
        Out.pl("Array Content",content);
    }
} 
```

工作正常。它所做的只是将它添加到一个集合中，如果它还没有它并且有一个可返回的 Arraylist 以及一个对象数组。

# c# - 如何同步 ListBox 的 SelectedItem？

> ID：268674
> 
> 赞同：2
> 
> 时间：2008-11-06T13:26:29.783
> 
> 标签：c#, wpf, listbox

我有这个绑定到 ObservableCollection 的 ListBox。列表中的每个对象都实现了一个名为 ISelectable 的接口

```
public interface ISelectable : INotifyPropertyChanged
{
    event EventHandler IsSelected;
    bool Selected { get; set; }
    string DisplayText { get; }
} 
```

我想跟踪选择了哪个对象，无论它是如何选择的。用户可以单击 ListBox 中对象的表示，但也可能是通过代码选择对象。如果用户通过 ListBox 选择一个对象，我将所选项目转换为 ISelectable 并将 Selected 属性设置为 true。

```
ISelectable selectable = (ISelectable)e.AddedItems[0];
selectable.Selected = true; 
```

我的问题是，当我使用代码选择对象时，我无法让 ListBox 更改所选项目。我正在使用 DataTemplate 以不同的颜色显示所选对象，这意味着一切都正确显示。但是 ListBox 将用户单击的最后一个对象作为 SelectedItem，这意味着如果不先选择列表中的另一个对象，就无法单击该项目。

有人知道如何解决这个问题吗？我很确定我可以通过编写一些自定义代码来处理鼠标和键盘事件来完成我想要的，但我宁愿不这样做。我尝试将 SelectedItem 属性添加到集合中并将其绑定到 ListBox 的 SelectItemProperty 但没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T21:04:51.603

您还可以通过将 ListBoxItem.IsSelected 数据绑定到您的 Selected 属性来完成此操作。这个想法是在创建每个 ListBoxItem 时为其设置绑定。这可以使用针对为 ListBox 生成的每个 ListBoxItems 的样式来完成。

这样，当列表框中的项目被选中/取消选中时，相应的 Selected 属性将被更新。同样在代码中设置 Selected 属性将反映在 ListBox

为此，Selected 属性必须引发 PropertyChanged 事件。

```
<List.Resources>
    <Style TargetType="ListBoxItem">
        <Setter 
            Property="IsSelected" 
            Value="{Binding 
                        Path=DataContext.Selected, 
                        RelativeSource={RelativeSource Self}}" 
            />
    </Style>
</List.Resources> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T13:32:58.117

您是否查看过列表框的 SelectedItemChanged 和 SelectedIndexChanged 事件？

每当更改选择时，都应该触发这些，无论它是如何选择的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T15:24:03.647

我认为您应该在选择更改时触发 propertyChanged 事件。将此代码添加到实现 ISelectable 的对象中。你最终会得到类似的东西：

```
private bool _Selected;
        public bool Selected
        {
            get
            {
                return _Selected;
            }
            set
            {
                if (PropertyChanged != null)                
                    PropertyChanged(this, new PropertyChangedEventArgs("Selected"));

                _Selected = value;
            }
        } 
```

我试过以下代码：

```
public ObservableCollection<testClass> tests = new ObservableCollection<testClass>();

        public Window1()
        {
            InitializeComponent();
            tests.Add(new testClass("Row 1"));
            tests.Add(new testClass("Row 2"));
            tests.Add(new testClass("Row 3"));
            tests.Add(new testClass("Row 4"));
            tests.Add(new testClass("Row 5"));
            tests.Add(new testClass("Row 6"));
            TheList.ItemsSource = tests;
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            tests[3].Selected = true;
            TheList.SelectedItem = tests[3];
        } 
```

其中 testClass 实现 ISelectable。

这是一段 xaml，没什么特别的：

```
<ListBox Grid.Row="0" x:Name="TheList"></ListBox>        
<Button Grid.Row="1" Click="Button_Click">Select 4th</Button> 
```

我希望这有帮助。

# linux - 如何在 linux 上监控进程的线程数？

> ID：268680
> 
> 赞同：172
> 
> 时间：2008-11-06T13:29:29.870
> 
> 标签：linux, multithreading, monitor

我想监视 Linux 上特定进程使用的线程数。有没有一种简单的方法可以在不影响流程性能的情况下获取这些信息？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2008-11-07T16:56:09.097

尝试

```
ps huH p <PID_OF_U_PROCESS> | wc -l 
```

或[htop](http://htop.sourceforge.net/)

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2016-06-08T21:28:46.560

要获取给定 pid 的线程数：

```
$ ps -o nlwp <pid> 
```

其中`nlwp`代表*轻量级进程（线程）的数量*。因此`ps`别名`nlwp`为`thcount`，这意味着

```
$ ps -o thcount <pid> 
```

也可以。

如果要监视线程数，只需使用`watch`：

```
$ watch ps -o thcount <pid> 
```

要获取系统中运行的所有线程的总和：

```
$ ps -eo nlwp | tail -n +2 | awk '{ num_threads += $1 } END { print num_threads }' 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2011-08-27T19:07:03.727

进程中的每个线程都会在`/proc/<pid>/task`. 计算目录的数量，你就有了线程的数量。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2015-04-21T12:51:13.610

```
cat /proc/<PROCESS_PID>/status | grep Threads 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2014-08-23T07:39:05.003

`ps -eLf`在 shell 上会给你一个当前在系统上运行的所有线程和进程的列表。或者，您可以运行`top`命令然后按“H”来切换线程列表。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-08-27T18:24:15.970

如果您使用：

```
ps uH p <PID_OF_U_PROCESS> | wc -l 
```

您必须将结果减去 1，因为“wc”正在计数的行之一是“ps”命令的标题。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-02-16T01:03:49.953

`$ ps H p pid-id`

H - 列出进程中的所有单独线程

或者

`$cat /proc/pid-id/status`

pid-id 是进程 ID

例如..（截断下面的输出）

```
root@abc:~# cat /proc/8443/status
Name:   abcdd
State:  S (sleeping)
Tgid:   8443
VmSwap:        0 kB
Threads:    4
SigQ:   0/256556
SigPnd: 0000000000000000 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-06T13:36:37.703

JStack 相当便宜——一种选择是通过 grep 管道输出以查找活动线程，然后通过 wc -l 管道。

JConsole 更加图形化，它显示给定进程的线程数。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-01-20T21:31:41.310

这是一个显示给定进程的线程数的命令：

```
ps -L -o pid= -p <pid> | wc -l 
```

与其他`ps`基于答案的答案不同，这里不需要`1`从其输出中减去，因为`ps`由于该`-o pid=`选项没有标题行。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-09-12T04:13:35.143

我的答案是更多的gui，但仍在终端内。Htop 可以通过一些设置来使用。

1.  启动 htop。
2.  按 F2 进入设置菜单。
3.  从最左边的列中选择“列”
4.  从最右边的列中选择要添加到主监控输出的列，“NLWP”就是您要查找的内容。
5.  按 F10。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-06T13:39:56.697

较新的 JDK 发行版附带 JConsole 和 VisualVM。两者都是从正在运行的 Java 进程中获取脏细节的绝佳工具。如果您必须以编程方式执行此操作，请研究 JMX。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-03-14T10:33:50.450

[jvmtop](http://code.google.com/p/jvmtop/)可以在其他指标旁边显示当前的 jvm 线程数。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-10-23T08:45:43.853

最简单的方法是使用“htop”。您可以安装“htop”（top 的更高级版本），它将显示您所有的内核、进程和内存使用情况。

按“Shift+H”显示所有进程或再次按隐藏它。按“F4”键搜索您的进程名称。

在 Ubuntu 或 Debian 上安装：

```
sudo apt-get install htop 
```

在 Redhat 或 CentOS 上安装：

```
yum install htop
dnf install htop      [On Fedora 22+ releases] 
```

如果你想从源代码编译“htop”，你会在[这里](https://www.tecmint.com/install-htop-linux-process-monitoring-for-rhel-centos-fedora/)找到它。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-02-10T09:47:19.720

如果您正在寻找多个进程的线程数，那么其他答案对您来说效果不佳，因为您不会看到进程名称或 PID，这使得它们相当无用。改用这个：

```
ps -o pid,nlwp,args -p <pid_1> <pid_2> ... <pid_N> 
```

为了实时观看更改，只需添加`watch`：

```
watch ps -o pid,nlwp,args -p <pid_1> <pid_2> ... <pid_N> 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-07-27T15:09:36.050

如果你想在 linux 系统中每个用户的线程数，那么你应该使用：

```
ps -eLf | grep <USER> | awk '{ num += $6 } END { print num }' 
```

在哪里`<USER>`使用所需的用户名。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-02-16T14:49:45.627

如果您试图找出给定 pid 使用 cpu 的线程数，我会使用：

```
top -bc -H -n2 -p <pid> | awk '{if ($9 != "0.0" && $1 ~ /^[0-9]+$/) print $1 }' | sort -u | wc -l 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-10-27T13:03:11.137

如果你对那些真正*活跃*的线程感兴趣——比如在做某事（不阻塞、不定时等待、不报告“线程正在运行”但真正等待流提供数据）而不是闲置但活着 - - 那么你可能对[jstack-active](https://gist.github.com/ahgittin/3734619)感兴趣。

这个简单的 bash 脚本运行`jstack`然后过滤掉所有通过启发式方法似乎处于空闲状态的线程，向您显示那些实际消耗 CPU 周期的线程的堆栈跟踪。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2015-12-22T09:41:45.343

VisualVM 可以显示给定 JVM 进程的线程的清晰状态

[![在此处输入图像描述](https://i.stack.imgur.com/kbLlz.png)](https://i.stack.imgur.com/kbLlz.png)

# algorithm - 什么是最好的低技术协议来模拟从帽子里抽出名字并确保保密？

> ID：268682
> 
> 赞同：6
> 
> 时间：2008-11-06T13:30:06.890
> 
> 标签：algorithm, cryptography, protocols

每年感恩节，我的家人都会从帽子中抽出名字来确定他们将成为圣诞礼物交换的“秘密圣诞老人”。对我们的家庭文化来说，重要的是家庭中没有其他人知道彼此是谁，以保持有趣。选择的唯一规则是你不能选择你的配偶。如果发生这种情况，您将再次抽奖并将您配偶的名字放回帽子中。

由于今年的物流和旅行计划，我们提前庆祝圣诞节（感恩节后仅两周）。

为了有足够的时间寻找礼物，我们现在想选择名字。我们的家庭分布在美国各地。有些成员可以访问互联网，有些则不能（例如我亲爱的奶奶）。

我想做的是有一个公平的协议来模拟从帽子中抽出名字，并确保一定程度的保密性而不会过于复杂。一些网站，如以前的[drawnames.com](http://www.drawnames.com/ "绘制名称")或其他类似网站，通常要求人们输入他们的电子邮件地址。我想绝对确保我家人的电子邮件地址不会被滥用，因此我不想将它们信任到另一个站点。

我能想到的最好的协议是：

1.  编写一个随机挑选人员并确保人们不会得到配偶的程序。
2.  该程序将向我显示列表的一半，但不会显示谁得到了我的名字，但会显示我有谁的名字以及得到我妻子名字的人。
3.  然后，我将离开房间，程序将向我的妻子显示另一半的人员列表（其中将包括谁有我的名字）。
4.  然后我和妻子会联系每个人，告诉他们他们有谁。

我错过了更好的协议吗？更好，我的意思是允许更多保密的东西。再次，由于物流和保持简单，我不想建立一个网站。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-06T14:41:33.593

拿一些纸和一些信封。每个信封的两个编号和每个纸张的两个编号，这样您就有 2 个“1”信封和 2 个“1”纸、2 个“2”信封和 2 个“2”纸，等等。

让您或您的妻子在匹配的纸上写下每对夫妇的名字，例如：您可以将您的名字写在“1”纸上，而您的妻子必须在另一张“1”纸上。适当地处理匹配的信封（您的地址将在示例中的两个“1”信封上）。

把所有的文件和信封翻过来，这样就看不到姓名或地址了（你*确实*记得在纸和信封的背面写下数字，对吗？）交换位置，以便没有*这样*做的人写信封。请务必将每张编号的纸张放入具有不同编号的信封中（例如：切勿将“1”纸张放入“1”信封中）。这样，你就会知道 A) 没有人得到自己，B) 没有人得到他们的重要人物。

并非每个答案都需要涉及计算机！只需询问离您最近的 D&D 玩家即可。:-P

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T21:26:35.023

这是一个真正的低技术解决方案。将姓名和电子邮件地址列表提供给您的朋友，让他们画出姓名并通过电子邮件发送给每个人。见鬼，如果你没有人，我会做的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T15:50:39.087

这是一个软件解决方案。

1.  将每个人的姓名和地址放在一个列表中。
2.  复制列表，然后随机播放。
3.  如果原始列表中的任何地址在混洗后的列表中有匹配的地址，则要么再次混洗，要么进行随机交换，直到两个列表中没有插槽具有相同的地址。（在软件中执行此操作，这样您就不会偷看。）
4.  按第一个列表的顺序打印信封。
5.  按打乱列表的顺序打印字母。
6.  不偷看就塞进信封。

这假设您家中的每个人都与他们的配偶住在同一个地址。它还假设您可以相信自己不会偷看。

节日快乐。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T14:09:24.547

好吧，必须要有信任元素，因为你很容易作弊，但如果你只是想避免意外看到礼物分配，给每个人分配一个大的随机数怎么样，为每个人和他们的代码创建一个列表数字，并为每个人打印单独的表格，其中包含他们“绘制”的人的代码。这样，无需记住数字并在列表中查找，您可能会将“Bob 分配给 0785286741234”解释为“Bob 分配给 Kelly”。我可能会让每个人的第一个和最后几个数字都相同，所以你不能简单地记得 Bob 得到了 7 个数字，并且只有一个以 7 开头的随机条目。将差异更深地埋在数字字符串中。看看他们是如何在视觉上“迷失”的：

0785253451234 鲍勃

0785286741234 凯利

0785238761234 赫尔曼

0785200281234 莉迪亚

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T13:41:25.977

为什么不自动向每个人发送电子邮件？您可以将名称放在文件中并将其压缩为附件，以避免偷窥。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T13:43:25.410

在 OS X 上，利用文本转语音引擎非常容易，只需调用“say”命令行实用程序即可。在 Windows 中也有一些方法可以做到这一点。

所以你可以给你名单上的任何人打电话，告诉他们应该为谁买礼物，然后把耳机从电脑上接到电话，当你告诉你的程序说出与你相关的人的名字时正在打电话。然后，他们可以告诉您他们是否听得很清楚，并且这不是他们的配偶。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T15:38:34.400

您可以让您的计算机通过调制解调器拨打每个人的电话，并在应答后使用文字转语音在线路上宣布他们的姓名。这有点像政治候选人和广告商用来向您播放信息的自动拨号程序。或者，您可以设置它，以便您的家人拨打您的号码并且计算机接听。然后他们按下电话按钮拼出他们的名字，然后计算机告诉他们他们画的是谁。

这样，名称可以由一个简单的程序随机选择，您不必看到/听到谁得到什么名字。

有可以在 linux 上运行的开源软件来做到这一点，虽然我从来没有使用过。我假设有一个开源的 windows 等价物。

我假设您的整个家庭都可以使用电话，即使他们没有电子邮件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T15:47:57.843

使用你的邻居：

准备 N 个写有名字的信封。

准备 N 张姓名表，其中包括配偶姓名，例如

> “鲍勃（莫尔瓦的配偶）”

比离开房间，让你的邻居做随机匹配。快速。亲自或通过美国邮件将信封交给这些人

圣诞快乐

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T21:18:49.283

一个简单的解决方案：

*   将每个名字写在卡片上并合上。
*   对于每一对，将一个放在堆栈 A 上，另一个放在堆栈 B 上。
*   将单打分为 A 和 B。（您必须知道谁在哪个堆栈上）。
*   将堆栈 B 上的笔记分配给堆栈 A 上的某人，反之亦然。
*   如果有奇数，请将其中一个（盲人）分开并将其分配给另一个。（这个人有很小的机会得到自己）但你可以通过自己拿卡并与另一张交换它来对抗它，如果是你的话。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-28T16:13:17.547

我不知道这对你来说是否为时已晚。我刚刚创建了一个 Web 应用程序，它会做一些与此非常相似的事情 - [http://www.secretsantaswap.com/](http://www.secretsantaswap.com/)

您可以从 Gmail/Hotmail/Outlook 中导入联系人，并且可以指定不会相互匹配的子组（例如，bill 和 lisa 永远不想得到彼此的姓名）。我通过电子邮件向每个参与者发送他们的目标。参与者可以拥有相同的电子邮件地址（例如，父母可以收到他们孩子的所有电子邮件）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-19T20:42:14.213

今年我们交换礼物的时候，我建议[http://www.secretsanta.com](http://www.secretsanta.com)。我姐姐负责，她当时没有互联网连接，所以没有使用。

如果我没记错的话，它可以记录前几年的情况，并且可以进行排除，这样来自同一个家庭的人就不会互相了解。

# oop - 继承和接口

> ID：268698
> 
> 赞同：2
> 
> 时间：2008-11-06T13:34:29.830
> 
> 标签：oop, inheritance, interface, ooad

这在某种程度上是这个问题的后续[问题](https://stackoverflow.com/questions/267045/is-there-a-benefit-to-having-both-an-abstract-class-and-an-interface)。

假设我有一个继承树如下：

```
Car -> Ford -> Mustang -> MustangGT 
```

为这些类中的*每*一个定义接口是否有好处？例子：

```
ICar -> IFord -> IMustang -> IMustangGT 
```

我可以看到也许其他类（如`Chevy`）想要实现`Icar`or`IFord`甚至`IMustang`可能，但可能不是`IMustangGT`因为它是如此具体。在这种情况下，接口是多余的吗？

另外，我认为任何想要实现的类`IFord`都肯定希望通过继承来使用它的一个继承，`Ford`以免重复代码。如果这是给定的，那么实施的好处是什么`IFord`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-06T13:40:55.043

根据我的经验，当您有多个类，每个类都需要响应相同的方法或方法时，最好使用接口，以便它们可以被其他代码互换使用，这些代码将针对这些类的公共接口编写。接口的最佳用途是当协议很重要但每个类的底层逻辑可能不同时。如果您要复制逻辑，请考虑使用抽象类或标准类继承。

针对您问题的第一部分，我建议您不要为每个类创建接口。这会不必要地使您的班级结构混乱。如果你发现你需要一个接口，你可以随时添加它。希望这可以帮助！

亚当

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T14:24:53.237

我也同意[adamalex 的响应](https://stackoverflow.com/questions/268698/inheritance-and-interfaces#268721)，即接口应该由应该响应某些方法的类共享。

如果类具有相似的功能，但在祖先关系中彼此不直接相关，那么接口将是将该功能添加到类而不在两者之间复制功能的好方法。（或者有多个实现，只有细微的差别。）

当我们使用汽车类比时，一个具体的例子。假设我们有以下类：

```
Car -> Ford   -> Escape  -> EscapeHybrid
Car -> Toyota -> Corolla -> CorollaHybrid 
```

汽车有`wheels`和可以`Drive()`和`Steer()`。所以这些方法应该存在于`Car`类中。（可能`Car`该类将是一个抽象类。）

`Ford`往下走，我们得到了和之间的区别`Toyota`（可能实现为汽车上标志类型的差异，同样可能是一个抽象类。）

然后，最后我们有一个`Escape`和`Corolla`类，它们是完全实现为汽车的类。

**现在，我们如何制造*混合动力*汽车？**

我们可以有一个`Escape`that is的子类，`EscapeHybrid`它添加一个`FordsHybridDrive()`方法，而它的一个子类`Corolla`是`CorollaHybrid`with`ToyotasHybridDrive()`方法。这些方法基本上都在做同样的事情，但是我们有不同的方法。**呸。**似乎我们可以做得更好。

假设一个混合有一个`HybridDrive()`方法。由于我们不想最终拥有两种不同类型的混合体（在一个完美的世界中），所以我们可以制作一个`IHybrid`具有`HybridDrive()`方法的接口。

所以，**如果我们想创建一个`EscapeHybrid`或`CorollaHybrid`类**，我们所要做的就是**实现`IHybrid`接口**。

对于一个真实世界的例子，让我们看一下 Java。可以将一个对象与另一个对象进行比较的类实现了该`Comparable`接口。顾名思义，接口应该用于可*比较*的类，因此名称为“Comparable”。

有趣的是， [Java 教程的](http://java.sun.com/docs/books/tutorial/java/TOC.html)[接口](http://java.sun.com/docs/books/tutorial/java/IandI/createinterface.html)课程中使用了一个[汽车示例](http://java.sun.com/docs/books/tutorial/java/IandI/createinterface.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T20:58:52.697

[您根本不应该实现任何这些接口。](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx)

类继承描述**了一个对象*是***什么（例如：它的身份）。这很好，但是大多数时候，对象*是什么，远没有对象**做*什么重要。这就是接口的用武之地。

一个接口应该描述**一个对象做什么*）*，**或者它的行为。我的意思是它的行为，以及给定该行为有意义的一组操作。

因此，好的接口名称通常应采用 ,`IDriveable`等形式`IHasWheels`。有时描述这种行为的最好方法是引用一个众所周知的其他对象，所以你可以说“行为就像其中之一”（例如`IList`：）但恕我直言，这种命名形式是少数。

鉴于这种逻辑，*接口继承有意义的场景与**对象继承*有意义的场景完全不同——通常这些场景根本不相关。

希望这可以帮助您思考您实际需要的接口:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T13:40:56.803

我想说只为您需要参考的东西制作一个界面。您可能有一些其他类或功能需要了解汽车，但多久会有一些关于福特的信息需要了解？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T13:41:59.393

不要建造你不需要的东西。如果事实证明您需要这些接口，那么返回并构建它们是一个小的努力。

此外，在迂腐方面，我希望您实际上并没有构建看起来像这种层次结构的东西。这不是继承的用途。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T13:48:39.253

仅在需要该级别的功能时才创建它。

重构代码始终是一个持续的过程。

有一些可用的工具可以让您在必要时提取到接口。例如[http://geekswithblogs.net/JaySmith/archive/2008/02/27/refactor-visual-studio-extract-interface.aspx](http://geekswithblogs.net/JaySmith/archive/2008/02/27/refactor-visual-studio-extract-interface.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T13:50:46.643

将 ICar 和所有其余部分（Make=Ford、Model=Mustang 等）作为实现接口的类的成员。

如果您不想走检查路线，您可能想要拥有 Ford 类和例如 GM 类，并且两者都实现 ICar 以便使用多态性`Make == Whatever`，这取决于您的风格。

无论如何-在我看来，这些是汽车的属性，而不是相反-您只需要一个界面，因为方法很常见：制动，加速等。

福特能做其他汽车做不到的事情吗？我不这么认为。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T13:39:24.890

我将创建前两个级别，ICar 和 IFord，然后不理会第二个级别，直到我需要第二个级别的接口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T13:57:43.790

仔细考虑您的对象需要如何在您的问题域中相互交互，并考虑您是否需要对特定抽象概念进行多个实现。使用接口来围绕与其他对象交互的概念提供契约。

在您的示例中，我建议福特可能是制造商，而 Mustang 是制造商福特使用的 ModelName 值，因此您可能会有更多类似的东西：

IVehichle -> CarImpl, MotorbikeImpl - has-a Manufacturer has-many ModelNames

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T14:05:02.420

在这个关于[interface 和 class 之间区别](https://stackoverflow.com/questions/258285/is-a-java-interface-an-abstract-class#258294)的答案中，我解释说：

*   接口暴露了一个概念*是*什么（在编译时“什么*是*有效的”），并用于***值***（MyInterface x = ...）
*   类公开概念的*作用*（实际上在运行时执行），并用于值或对象（MyClass x 或 aMyClass.method() ）

因此，如果您需要将不同的福特子类存储到“福特”变量（“价值”的概念）中，请创建一个 IFord。否则，在你真正需要它之前不要打扰。

这是一个标准：如果不满足，福特可能就没用了。
如果满足，则适用前面答案中公开的其他标准：如果 Ford 具有比 Car 更丰富的 API，则 IFord 可用于多态性目的。如果没有，ICar 就足够了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T14:25:03.313

在我看来，接口是一种强制要求类实现某个签名或（如我所想的那样）某种“行为”的工具对我来说，我认为如果我的接口开头的 Capital I 名称为一个人称代词，我尝试命名我的接口，以便可以这样阅读它们...... ICanFly、IKnowHowToPersistMyself IAmDisplayable 等......所以在你的例子中，我不会创建一个接口来镜像任何特定的完整公共签名班级。我会分析公共签名（行为），然后将成员分成更小的逻辑组（越小越好），例如（使用您的示例）IMove、IUseFuel、ICarryPassengers、ISteerable、IAccelerate、IDepreciate 等......然后应用这些接口到我系统中任何其他类需要它们

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T14:28:32.777

一般来说，考虑这一点（以及 OO 中的许多问题）的最佳方式是考虑合同的概念。

合同被定义为两方（或多方）之间的协议，其中规定了每一方必须履行的具体义务；在一个程序中，这是一个类将提供的服务，以及您必须为类提供什么才能获得服务。接口声明了实现该接口的任何类都必须满足的契约。

但是，考虑到这一点，您的问题在某种程度上取决于您使用的语言以及您想要做什么。

在从事 OO 多年（比如，天哪，30 年）之后，我通常会为每个合约编写一个接口，尤其是在 Java 中，因为它使测试变得非常容易：如果我有一个类的接口，我可以构建轻松地模拟对象，几乎是微不足道的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-06T14:33:08.867

接口旨在成为通用公共 API，用户将被限制使用此公共 API。除非您打算让用户使用 的特定于类型的方法`IMustangGT`，否则您可能希望将接口层次结构限制为`ICar`和`IExpensiveCar`。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-11-06T13:49:57.863

仅从接口和抽象类继承。

如果您有几个几乎相同的类，并且您需要实现大多数方法，请结合购买其他对象使用和接口。
如果 Mustang 类如此不同，那么不仅要创建接口 ICar，还要创建 IMustang。
所以 Ford 和 Mustang 类可以从 ICar 继承，而 Mustang 和 MustangGT 可以从 ICar**和**IMustang 继承。

如果你实现了 Ford 类并且方法与 Mustang 相同，请从 Mustang 购买：

```
class Ford{
  public function Foo(){
    ...
    Mustang mustang  = new Mustang();
    return mustang.Foo();
} 
```

# facebook - 如何删除 Facebook 应用程序中的“盒子头”？

> ID：268706
> 
> 赞同：2
> 
> 时间：2008-11-06T13:37:02.023
> 
> 标签：facebook

我目前正在开发一个 Facebook 应用程序，该应用程序最终会出现在 Facebook 页面上。问题是我不知道如何删除带有应用程序名称和关闭按钮的框标题（句柄？）。

我已经看到 Pages 上的其他应用程序能够删除标题。在这里查看苹果页面：http: [//www.facebook.com/home.php#/pages/Apple-Students/11147074409](http://www.facebook.com/home.php#/pages/Apple-Students/11147074409)

是因为他们使用 IFrame 吗？我也试过了，但我仍然需要调用 setFBML 并在其中嵌入一个 IFrame。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T15:46:13.167

我认为您对 Apple 页面中的 IFrame 是正确的。看起来整个左列是一个 IFrame。不过，尚不清楚他们是如何摆脱车把的。现在我也很好奇...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T17:29:54.880

Apple 是否有可能支付 facebook 以删除您正在谈论的标题？

也许这是一个特殊情况，他们为愿意给他们现金的人提供了一个特殊的 API/UI？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T05:50:33.390

不久前我写了一个 Facebook 应用程序，但我不相信它上面有你所说的框标题： [http](http://apps.facebook.com/photoisland/ "摄影岛") ://apps.facebook.com/photoisland/ 。该应用程序被配置为完全在 IFrame 中运行，而我根本没有使用 FBML。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T10:22:42.837

我终于找到了如何像 Apple 一样获得没有标题的 IFrame。

您必须与 Facebook 签署一项特殊协议才能获得它......但是这笔交易并不便宜，因此对于大多数公司来说这是毫无疑问的。:(

# asp.net - 如何在不使用密码的情况下检查 ASP.NET Membership 中的 Question 和 Password 是否正确

> ID：268714
> 
> 赞同：1
> 
> 时间：2008-11-06T13:38:50.257
> 
> 标签：asp.net

我拥有 ASP.net 会员资格，我需要验证用户问题和答案。

我不需要使用密码，因为它是散列的，我们无法验证它

MembershipUser msUser = Membership.GetUser("Rasel");

谢谢， Lalithambigai

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:28:22.670

问用户一个问题并将他们的答案与他们之前提供的答案进行比较？

但是，散列密码不会阻止您对其进行验证。只需散列用户的响应并将散列与存储的密码散列进行比较。请注意，散列方案可能包含盐或初始化字符以防止字典攻击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:13:15.520

如果您将问题/答案存储在成员资格提供程序中（听起来像您），那么您将答案传递给 msUser.ResetPassword 方法。如果答案不正确，它将抛出 MembershipPasswordException。

# git - git-svn：什么相当于`svn switch --relocate`？

> ID：268736
> 
> 赞同：90
> 
> 时间：2008-11-06T13:44:19.043
> 
> 标签：git, version-control, git-svn

我通过 git-svn 镜像的 svn 存储库已更改 URL。

在香草 svn 中，您只需要做`svn switch --relocate old_url_base new_url_base`.

如何使用 git-svn 做到这一点？

简单地更改配置文件中的 svn url 会失败。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-06T13:55:09.443

这很好地处理了我的情况：

[https://git.wiki.kernel.org/index.php/GitSvnSwitch](https://git.wiki.kernel.org/index.php/GitSvnSwitch)

我使用协议克隆`file://`，并想切换到`http://`协议。

编辑部分中的`url`设置很诱人，但它本身不起作用。一般来说，您需要遵循以下程序：`[svn-remote "svn"]``.git/config`

1.  将 svn-remote`url`设置切换为新名称。
2.  运行`git svn fetch`。这需要从 svn 中获取至少一个新版本！
3.  将 svn-remote`url`设置改回原来的 URL。
4.  运行`git svn rebase -l`以执行本地 rebase（使用最后一次 fetch 操作中的更改）。
5.  将 svn-remote`url`设置改回新的 URL。
6.  现在，`git svn rebase`应该再次工作。

喜欢冒险的人不妨一试[`--rewrite-root`](https://git.wiki.kernel.org/index.php/GitSvnSwitch#Using_--rewrite-root)。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2010-10-31T01:45:16.273

您可以查看以下是否正常：

1.  如果`svn-remote.svn.rewriteRoot`配置文件 ( ) 中不存在`.git/config`：

    ```
    git config svn-remote.svn.rewriteRoot <currentRepositoryURL> 
    ```

2.  如果`svn-remote.svn.rewriteUUID`配置文件中不存在：

    ```
    git config svn-remote.svn.rewriteUUID <currentRepositoryUUID> 
    ```

    `currentRepositoryUUID`可以从 中获得`.git/svn/.metadata`。

3.  `git config svn-remote.svn.url <newRepositoryURL>`

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-11-15T12:28:26.493

不幸的是，这些答案中的大多数链接都不起作用，所以我将从[git wiki](https://git.wiki.kernel.org/)复制一些信息以供将来参考。

这个解决方案对我有用：

*   编辑`svn-remote` `url`（或`fetch`路径）`.git/config`以指向新的域/url/路径

*   运行 git `git svn fetch`。*这需要从 svn 中获取至少一个新版本！*

*   如果您`git svn rebase`现在尝试，您将收到如下错误消息：

    ```
    Unable to determine upstream SVN information from working tree history 
    ```

    我认为这是因为您在获取之前的最新提交将指向旧路径`git svn`这一事实感到困惑，该路径与.`git-svn-id``.git/config`

*   作为一种解决方法，将`svn-remote` `url`（或`fetch`路径）更改回原始域/url/路径

*   现在`git svn rebase -l`再次运行以使用最后一次 fetch 操作中的更改进行本地 rebase。这一次它*会*起作用，显然是因为`git svn`不会被`git-svn-id`新头的 与 中找到的不匹配的事实混淆`.git/config`。

*   最后，将`svn-remote` `url`（或`fetch`路径）更改回新的域/url/路径

*   此时`git svn rebase`应该再次工作！

原始信息可在[此处](https://git.wiki.kernel.org/articles/g/i/t/GitSvnSwitch_8828.html)找到。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T13:46:03.377

Git svn 严重依赖 svn URL。从 svn 导入的每个提交都有一个`git-svn-id`包含 svn URL。

一个有效的重定位策略是调用`git-svn clone`新的存储库并将更改合并到新的关闭上。有关更详细的过程，请参阅这篇文章：

[http://www.sanityinc.com/articles/relocating-git-svn-repositories](http://www.sanityinc.com/articles/relocating-git-svn-repositories)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-22T13:22:51.553

## `git filter-branch`

[该脚本](https://gist.github.com/krlmlr/6307013)取自[博客条目](http://therightstuff.de/2009/06/25/Rewriting-Git-History-Relocating-Subversion-URLs.aspx)，对我有用。提供新旧 repo URL 作为参数，就像 for 一样`svn switch --relocate`。

该脚本调用`git filter-branch`以替换`git-svn-id`提交消息中的 Subversion URL，更新`.git/config`，并`git-svn`通过使用重新创建元数据来更新元数据`git svn rebase`。虽然`git svn clone`可能是更强大的解决方案，但该`filter-branch`方法对于大型存储库（数小时与数天）的运行速度要快得多。

```
#!/bin/sh

# Must be called with two command-line args.
# Example: git-svn-relocate.sh http://old.server https://new.server
if [ $# -ne 2 ]
then
  echo "Please invoke this script with two command-line arguments (old and new SVN URLs)."
  exit $E_NO_ARGS
fi

# Prepare URLs for regex search and replace.
oldUrl=`echo $1 | awk '{gsub("[\\\.]", "\\\\\\\&");print}'`
newUrl=`echo $2 | awk '{gsub("[\\\&]", "\\\\\\\&");print}'`

filter="sed \"s|^git-svn-id: $oldUrl|git-svn-id: $newUrl|g\""
git filter-branch --msg-filter "$filter" -- --all

sed -i.backup -e "s|$oldUrl|$newUrl|g" .git/config

rm -rf .git/svn
git svn rebase 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-22T16:00:22.937

## `git_fast_filter`

然而比[`git-filter-branch`](https://stackoverflow.com/a/18381709/946850)（即，分钟而不是小时）更快，但在精神上相似，是使用[`git_fast_filter`](http://gitorious.org/git_fast_filter). 但是，这需要更多的编码，并且不存在整洁的现成解决方案。相比之下，这将从*旧*`git-filter-branch`的 repo创建一个*新*的repo 。假设指向最后的 SVN 提交。*`master`*

 *1.  `git_fast_filter`从 Gitorious 仓库克隆。
2.  `git_fast_filter`根据[此 Gist](https://gist.github.com/6308961)在克隆的同一目录中创建一个 Python 脚本，使用`chmod +x`. 调整新旧存储库路径。（脚本的内容也粘贴在下面。）
3.  使用 初始化一个新的目标存储库`git init`，将工作目录更改为这个新的存储库。
4.  执行以下管道：

    ```
    (cd path/to/old/repo && git-fast-export --branches --tags --progress=100) | \
        path/to/git_fast_filter/commit_filter.py | git-fast-import 
    ```

5.  复制`.git/config`，也许还有其他相关文件`.git/info`从旧仓库复制到新仓库。

6.  删除`.git/svn`.
7.  了解`git-svn`新的修订号映射

    1.  执行`git branch refs/remotes/git-svn master`

        *   您的 git-svn 遥控器的名称可能不同于`refs/remotes/git-svn`、 咨询`.git/config`、`svn-remote`部分
    2.  执行`git svn info`。如果此命令冻结，则说明有问题。它应该重建修订号映射。

    3.  删除假分支`refs/remotes/git-svn`，它将被重新创建`git-svn`

8.  通过调用同步`git svn rebase`。

以下是 的内容，酌情替换和`commit_filter.py`的值：`IN_REPO``OUT_REPO`

```
#!/usr/bin/python

from git_fast_filter import Commit, FastExportFilter
import re
import sys

IN_REPO = "https://svn.code.sf.net/p/matsim/code"
OUT_REPO = "https://svn.code.sf.net/p/matsim/source"

IN_REPO_RE = re.compile("^git-svn-id: %s" % re.escape(IN_REPO), re.M)
OUT_REPO_RE = "git-svn-id: %s" % OUT_REPO

def my_commit_callback(commit):
  commit.message = IN_REPO_RE.sub(OUT_REPO_RE, commit.message)
  sys.stderr.write(".")

filter = FastExportFilter(commit_callback = my_commit_callback)
filter.run() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-02T09:42:16.627

上述`git svn rebase -l`解决方案对我不起作用。我决定换一种方式：

1.  将旧的 SVN 存储库克隆到 git 存储库中`old`，将新的 SVN 克隆到 git 存储库中`new`
2.  进入`old`_`new`
    *   `cd new`
    *   `git fetch ../old`
    *   `git tag old FETCH_HEAD`
3.  Rebase`new`在顶部`old`（应该成功，因为根部`new`和尖端的树`old`是相同的）
    *   `git checkout master`（假设`master`分支指向 SVN 头部。干净的克隆就是这种情况；否则在开始之前 dcommit。）
    *   `git rebase --root --onto old`
4.  重建 git-svn 元数据`new`以考虑变基
    *   `git update-ref --no-deref refs/remotes/git-svn master`（根据您的克隆方式调整远程参考，例如可以`refs/remotes/svn/trunk`）
    *   `rm -r .git/svn`
    *   `git svn info`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-26T17:03:51.637

基于对这个问题的其他一些回答，我想出了一个处理 git-svn 重定位的 Ruby 脚本。你可以在[https://gist.github.com/henderea/6e779b66be3580c9a584](https://gist.github.com/henderea/6e779b66be3580c9a584)找到它。

它在不检查另一个副本的情况下处理重定位，甚至可以处理一个或多个分支中存在未推送更改的情况（因为这破坏了常规逻辑）。它使用来自 git filter-branch 答案（用于主要逻辑）和关于将分支从一个 repo 实例复制到另一个实例的答案（用于复制具有未推送更改的分支）中的内容。

我一直在使用它来重新定位我工作的一堆 git-svn 存储库，而这个版本的脚本（我已经经历了无数次迭代）似乎对我有用。它不是超快的，但它似乎可以处理我遇到的所有情况并导致完全重新定位的存储库。

该脚本为您提供了在进行任何更改之前创建存储库副本的选项，因此您可以使用此选项创建备份。如果您在任何分支中有未推送的更改，则需要创建副本。

该脚本不使用正常 MRI Ruby 安装中未包含的任何 gem 或其他库。它确实使用了 MRI 中包含的 readline 和 fileutils 库。

希望我的脚本对其他人有用。随意更改脚本。

**注意：**我只在 OS X 10.10 Yosemite 上使用 git 2.3.0/2.3.1 和 Ruby 2.2.0 测试了这个脚本（因为这是我使用的环境），但我希望它也能在其他环境中工作。但是，不能保证关于 Windows。

# java - Swing：画布重叠菜单

> ID：268750
> 
> 赞同：3
> 
> 时间：2008-11-06T13:50:29.233
> 
> 标签：java, swing

我有一个带有菜单栏的 JFrame 和一个覆盖所有剩余表面的画布。当我单击菜单栏时，菜单在画布**后面**打开，我看不到它。有没有人经历过这个？除了调整 Canvas 的大小（我不愿意这样做）之外，还有什么解决方案吗？

谢谢，
弗拉德

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T14:14:25.817

您正在遇到重量级与轻量级的问题。

快速修复：

```
// Call this sometime before you use your menus 
JPopupMenu.setDefaultLightWeightPopupEnabled(false) 
```

[重量级与轻量级](http://java.sun.com/products/jfc/tsc/articles/mixing/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-29T19:16:08.370

当我调整 JFrame 上的 Canvas 的大小时，这发生在我身上。我只需要打电话

> 调整大小后的 JFrame 上的 validate()。

祝你好运！

# eclipse - 向 Eclipse 添加上下文操作的简单方法

> ID：268770
> 
> 赞同：5
> 
> 时间：2008-11-06T13:55:54.793
> 
> 标签：eclipse, eclipse-plugin, eclipse-pde

我正在尝试向 Eclipse 的上下文菜单添加一个非常简单的操作：在文件夹对象上单击右键，此操作应使用文件夹的路径调用外部工具（在“外部工具”中配置）作为唯一的参数。

我找到了一个[关于如何添加上下文菜单的教程](http://www.eclipse.org/articles/article.php?file=Article-action-contribution/index.html)，但它比我需要的更复杂——我真的不想创建插件，我什至不想创建类来做我想做的事。我唯一的目的是调用外部工具。

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T14:14:04.227

如果您想使用编辑上下文菜单等功能来扩展 Eclipse，唯一的方法是编写一个插件。但是，这可以非常轻量级并且针对您的需求，因此您找到的教程可能是一个很好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:25:42.743

查看[StartExplorer](http://basti1302.github.com/startexplorer/)。它非常方便。它相当于 IntelliJ “Neighborhood”插件。

它带有用于 Windows、Mac 和 Linux 的探索、命令 shell、打开和复制路径的基础知识。它还支持[自定义命令](http://basti1302.github.com/startexplorer/help/05_custom_commands.html)。并且可以通过普通的 Eclipse 存储库安装。

# regex - 我可以优化这个电话正则表达式吗？

> ID：268771
> 
> 赞同：9
> 
> 时间：2008-11-06T13:56:56.320
> 
> 标签：regex

好的，所以我有这个正则表达式：

```
( |^|>)(((((((\+|00)(31|32)( )?(\(0\))?)|0)([0-9]{2})(-)?( )?)?)([0-9]{7}))|((((((\+|00)(31|32)( )?(\(0\))?)|0)([0-9]{3})(-)?( )?)?)([0-9]{6}))|((((((\+|00)(31|32)( )?(\(0\))?)|0)([0-9]{1})(-)?( )?)?)([0-9]{8})))( |$|<) 
```

它格式化荷兰和比利时的电话号码（我只想要那些因此 31 和 32 作为国家代码）。

破译它并不是很有趣，但正如你所看到的，它也有很多重复。但现在它确实可以非常准确地处理它

接受以下所有欧洲格式的电话号码

```
0031201234567
0031223234567
0031612345678
+31(0)20-1234567
+31(0)223-234567
+31(0)6-12345678
020-1234567
0223-234567
06-12345678
0201234567
0223234567
0612345678 
```

并且以下错误格式的不是

```
06-1234567 (mobile phone number in the Netherlands should have 8 numbers after 06 )
0223-1234567 (area code with home phone) 
```

与此相反，这是好的。

```
020-1234567 (area code with 3 numbers has 7 numbers for the phone as opposed to a 4 number area code which can only have 6 numbers for phone number) 
```

正如您所看到的，它是'-' 字符使它有点困难，但我需要它，因为它是人们通常使用的格式的一部分，我希望能够解析它们。

现在是我的问题...您是否看到了一种简化此正则表达式的方法（如果您发现其中有错误，甚至可以改进它），同时保持相同的规则？

您可以在[regextester.com上对其进行测试](http://regextester.com/)

（'(|^|>)' 是为了检查它是否在一个单词的开头，它前面有可能是一个新行或一个'>'。我在 HTML 页面中搜索电话号码。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T15:36:54.527

第一个观察：阅读正则表达式是一场噩梦。它呼唤 Perl 的 /x 模式。

第二个观察：表达式中有很多，很多，很多括号（如果我数正确的话，42；当然，42是“生命、宇宙和一切的答案”——见道格拉斯·亚当斯“ Hitchiker's Guide to the Galaxy”，如果你需要解释的话）。

Bill the Lizard 指出您`(-)?( )?`多次使用 ' '。`-? ?`与 ' ' 或可能的 ' '相比，它没有明显的优势`[- ]?`，除非您真的打算单独捕获实际的标点符号（但是有很多捕获括号来确定要使用哪些 '$ *n* ' 项目会很困难）。

因此，让我们尝试编辑您的单行代码的副本：

```
( |^|>)
(
    ((((((\+|00)(31|32)( )?(\(0\))?)|0)([0-9]{2})(-)?( )?)?)([0-9]{7})) |
    ((((((\+|00)(31|32)( )?(\(0\))?)|0)([0-9]{3})(-)?( )?)?)([0-9]{6})) |
    ((((((\+|00)(31|32)( )?(\(0\))?)|0)([0-9]{1})(-)?( )?)?)([0-9]{8}))
)
( |$|<) 
```

好的 - 现在我们可以看到您的正则表达式的正则结构。

从这里可以进行更多分析。是的，正则表达式可以有很大的改进。第一个，很明显，一个是提取国际前缀部分，并应用一次（可选，或要求前导零），然后应用国家规则。

```
( |^|>)
(
    (((\+|00)(31|32)( )?(\(0\))?)|0)
    (((([0-9]{2})(-)?( )?)?)([0-9]{7})) |
    (((([0-9]{3})(-)?( )?)?)([0-9]{6})) |
    (((([0-9]{1})(-)?( )?)?)([0-9]{8}))
)
( |$|<) 
```

然后我们可以像前面提到的那样简化标点符号，并删除一些看似多余的括号，并改进国家代码识别器：

```
( |^|>)
(
    (((\+|00)3[12] ?(\(0\))?)|0)
    (((([0-9]{2})-? ?)?)[0-9]{7}) |
    (((([0-9]{3})-? ?)?)[0-9]{6}) |
    (((([0-9]{1})-? ?)?)[0-9]{8})
)
( |$|<) 
```

我们可以观察到，正则表达式不会强制执行手机代码规则（例如，它不会坚持 '06' 后跟 8 位数字）。它似乎还允许 1、2 或 3 位数的“交换”代码是可选的，即使带有国际前缀 - 可能不是您的想法，并且修复它会删除更多的括号。之后我们可以删除更多的括号，导致：

```
( |^|>)
(
    (((\+|00)3[12] ?(\(0\))?)|0)    # International prefix or leading zero
    ([0-9]{2}-? ?[0-9]{7}) |        # xx-xxxxxxx
    ([0-9]{3}-? ?[0-9]{6}) |        # xxx-xxxxxx
    ([0-9]{1}-? ?[0-9]{8})          # x-xxxxxxxx
)
( |$|<) 
```

我希望你可以从这里进行进一步的优化。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T14:13:20.453

万能的大神，真是一团糟！:) 如果您有高级语义或业务规则（例如您所描述的谈论欧洲数字、荷兰数字等的规则），您最好将单个正则表达式测试分解为几个单独的正则表达式测试，一个用于您的每个高级规则。

```
if number =~ /...../  # Dutch mobiles
  # ...
elsif number =~ /..../  # Belgian landlines
  # ...
# etc.
end 
```

以这种方式阅读、维护和更改会容易得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T14:25:03.597

将其拆分为多个表达式。例如（伪代码）...

```
phone_no_patterns = [
    /[0-9]{13}/, # 0031201234567
    /+(31|32)\(0\)\d{2}-\d{7}/ # +31(0)20-1234567
    # ..etc..
]
def check_number(num):
    for pattern in phone_no_patterns:
        if num matches pattern:
            return match.groups 
```

然后你只需遍历每个模式，检查每个模式是否匹配..

拆分模式可以很容易地修复导致问题的特定数字（这对于单个整体正则表达式来说会很可怕）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T15:33:12.163

(31|32) 看起来很糟糕。匹配 32 时，正则表达式引擎将首先尝试匹配 31（2 个字符），失败，然后回溯两个字符以匹配 31。首先匹配 3（一个字符），尝试 1（失败），回溯一个字符和匹配2。

当然，您的正则表达式在 0800- 数字上失败；它们不是 10 位数字。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T14:25:57.103

这不是优化，但你使用

```
(-)?( )? 
```

在你的正则表达式中三次。这将导致您匹配这些电话号码

```
+31(0)6-12345678
+31(0)6 12345678 
```

但也会匹配包含破折号后跟空格的数字，例如

```
+31(0)6- 12345678 
```

你可以更换

```
(-)?( )? 
```

和

```
(-| )? 
```

匹配破折号**或**空格。

# c++ - 运行时检查失败 #2 - 变量“x”周围的堆栈已损坏

> ID：268772
> 
> 赞同：3
> 
> 时间：2008-11-06T13:57:18.707
> 
> 标签：c++, stack

在以下代码中返回时，我收到此运行时检查失败。我相信类似的代码在程序的其他地方运行良好。有任何想法吗？

```
String GetVariableName(CString symbol, CString filepath)
{
    char acLine[512];
    char acPreviousLine[512];
    CString csFile;
    FILE *fp;   

    csFile.Format("%svariables.txt", filepath);

    fp = fopen(csFile, "r");

    if (! fp)
        return("");

    for (;;)
    {
        strcpy(acPreviousLine, acLine);

        // NULL means we are out of lines in the file.
        if (myfgets(acLine, 511, fp) == NULL)
            break;

        // "END" indicates end of file
        if (! strcmp(acLine, "END"))
            break;

        if (! strcmp(acLine, csVarSymbol))
        {
            // Previous line should be variable name
            fclose(fp);

            // Following line results in Check Failure while in Debug mode
            return(acPreviousLine);
        }
    }   
    fclose(fp);
    return("");
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T14:01:23.067

上面的示例中没有变量“x”，但我假设您编辑了错误消息！

acLine 没有初始化，所以当你第一次将它复制到 acPreviousLine 时，你正在复制堆栈中发生的任何内容。这可能会给您带来缓冲区溢出，因此在某些情况下会导致堆栈损坏 - 并非全部，因为您可能很幸运并且在达到 512 字节之前在 acLine 中找到了一个空值。

返回时检查堆栈是否损坏，因为在所有堆栈变量周围插入了警戒词（在此平台和构建配置上-我假设在Windows上，在调试模式下在VS上编译）以检查该问题。

将 acLine[0] 初始化为 0。

# c# - 调用基类的事件处理程序的 MSIL 是什么？

> ID：268778
> 
> 赞同：4
> 
> 时间：2008-11-06T14:00:57.093
> 
> 标签：c#, cil, reflection.emit

我有一个名为 EventConsumer 的类，它定义了一个事件 EventConsumed 和一个方法 OnEventConsumed，如下所示：

```
public event EventHandler EventConsumed;

public virtual void OnEventConsumed(object sender, EventArgs e)
{
    if (EventConsumed != null)
        EventConsumed(this, e);
} 
```

我需要在 OnEventConsumed 运行时添加属性，所以我使用 System.Reflection.Emit 生成一个子类。我想要的是与此等效的 MSIL：

```
public override void OnEventConsumed(object sender, EventArgs e)
{
    base.OnEventConsumed(sender, e);
} 
```

我到目前为止是这样的：

```
...

MethodInfo baseMethod = typeof(EventConsumer).GetMethod("OnEventConsumed");
MethodBuilder methodBuilder = typeBuilder.DefineMethod("OnEventConsumed",
                                                       baseMethod.Attributes,
                                                       baseMethod.CallingConvention,
                                                       typeof(void),
                                                       new Type[] {typeof(object),
                                                                   typeof(EventArgs)});

ILGenerator ilGenerator = methodBuilder.GetILGenerator();

// load the first two args onto the stack
ilGenerator.Emit(OpCodes.Ldarg_1);
ilGenerator.Emit(OpCodes.Ldarg_2);

// call the base method
ilGenerator.EmitCall(OpCodes.Callvirt, baseMethod, new Type[0] );

// return
ilGenerator.Emit(OpCodes.Ret);

... 
```

我创建类型，创建类型的实例，并调用它的 OnEventConsumed 函数，然后我得到：

```
Common Language Runtime detected an invalid program. 
```

...这并不完全有帮助。我究竟做错了什么？调用基类的事件处理程序的正确 MSIL 是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T14:17:23.190

这是来自示例应用程序的 IL：

```
 .method public hidebysig virtual instance void OnEventConsumed(object sender, class [mscorlib]System.EventArgs e) cil managed
    {
        .maxstack 8
        L_0000: nop 
        L_0001: ldarg.0 
        L_0002: ldarg.1 
        L_0003: ldarg.2 
        L_0004: call instance void SubclassSpike.BaseClass::OnEventConsumed(object, class [mscorlib]System.EventArgs)
        L_0009: nop 
        L_000a: ret 
    } 
```

所以我认为你没有加载实例，因为你没有做 ldarg.0

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:16:26.827

我实际上非常接近 - 问题是我没有加载“this”参数，并且 Callvirt 调用了我真正想要调用的子类方法。因此该部分变为：

```
// load 'this' and the first two args onto the stack
ilGenerator.Emit(OpCodes.Ldarg_0);
ilGenerator.Emit(OpCodes.Ldarg_1);
ilGenerator.Emit(OpCodes.Ldarg_2);

// call the base method
ilGenerator.EmitCall(OpCodes.Call, baseMethod, new Type[0] );

// return
ilGenerator.Emit(OpCodes.Ret); 
```

现在它工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T14:11:09.067

使用

```
public virtual void OnEventConsumed(object sender, EventArgs e)
{
    if (EventConsumed != null)
        EventConsumed(this, e);
} 
```

应该

```
public virtual void OnEventConsumed(EventArgs e)
{
    EventHandler handler = this.EventConsumed;
    if ( null != handler ) handler( this, e );
} 
```

.

我认为，您应该使用[ILGenerator.EmitCalli](http://msdn.microsoft.com/en-us/library/d81ee808.aspx)并且您应该传递一种返回值类型（在这种情况下我认为 null ）并传递参数类型 - 我认为“new Type[]{ typeof(EventArgs)}

# wcf - 如何使用 WCF 实现 WS 寻址？

> ID：268782
> 
> 赞同：3
> 
> 时间：2008-11-06T14:02:21.677
> 
> 标签：wcf, ws-addressing

如何使用 WCF 实现 WS 寻址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T14:41:48.633

WCF 自动将适当的 WS-Addressing 标头插入到使用 wsHttpBinding 创建的消息中，并且可能还会使用其他一些绑定。

你的意思是你想对这些标题施加一些控制吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-19T06:46:14.833

您可以尝试在绑定中添加以下说明

```
<textMessageEncoding messageVersion="Soap11WSAddressing10"/> 
```

# sql-server - 外键引用复合表

> ID：268783
> 
> 赞同：2
> 
> 时间：2008-11-06T14:02:41.580
> 
> 标签：sql-server, triggers, views, foreign-keys

我有一个表结构，我不确定如何创建最好的方法。

基本上我有两个表，tblSystemItems 和 tblClientItems。我有第三个表，其中有一列引用“项目”。问题是，此列需要引用系统项或客户端项——哪个都没有关系。系统项目的键在 1..2^31 范围内，而客户端项目的键在 -1..-2^31 范围内，因此永远不会有任何冲突。

每当我查询这些项目时，我都是通过在两个表的内容之间执行 UNION ALL 的视图来完成的。

因此，最佳情况下，我希望将外键引用作为视图的结果，因为视图将始终是两个表的联合 - 同时仍保持 ID 唯一。但我不能这样做，因为我无法引用视图。

现在，我可以删除外键，一切都很好。但是，我真的很想有一些参考检查和级联删除/设置 null 功能。除了触发器，还有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T20:45:41.470

对于迟到的答案，我感到很抱歉，我遇到了严重的周末炎病例。

至于使用第三个表来包含来自客户端和系统表的 PK - 我不喜欢这样，因为这会使同步过于复杂，并且仍然需要我的应用程序知道第三个表。

出现的另一个问题是我有第三个表需要引用一个项目——无论是系统还是客户端，都没有关系。将表分开基本上意味着我需要有两列，一个 ClientItemID 和一个 SystemItemID，每个列都有一个可以为空的表的约束 - 相当难看。

我最终选择了不同的解决方案。整个问题在于轻松地将新系统项同步到表中，而不会弄乱客户端项，避免冲突等。

我最终只创建了一个表，Items。Items 有一个名为“SystemItem”的位列，它定义了显而易见的内容。在我的开发/系统数据库中，我将 PK 作为一个 int 身份（1,1）。在客户端数据库中创建表后，标识键更改为 (-1,-1)。这意味着客户项目是消极的，而系统项目是积极的。

对于同步，我基本上忽略 (SystemItem = 1) 的任何内容，同时使用 IDENTITY INSERT ON 同步其余内容。因此，我能够在完全忽略客户端项目并避免冲突的同时进行同步。我还可以仅引用一个涵盖客户端和系统项目的“项目”表。唯一要记住的是修复标准集群键，使其下降以避免客户端插入新项目时的各种页面重组（客户端更新与系统更新的比例为 99%/1%）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T14:13:28.253

您可能需要一个表，例如 tblItems，它只存储两个表的所有主键。插入项目需要两个步骤来确保当项目被输入到 tblSystemItems 表中时，PK 被输入到 tblItems 表中。

然后第三个表有一个到 tblItems 的 FK。在某种程度上 tblItems 是其他两个项目表的父项。要查询一个项目，有必要在 tblItems、tblSystemItems 和 tblClientItems 之间创建一个 JOIN。

[EDIT-for comment below] 如果 tblSystemItems 和 tblClientItems 控制他们自己的 PK，那么你仍然可以让他们。您可能会先插入 tblSystemItems，然后再插入 tblItems。当您使用 Hibernate 之类的工具实现继承结构时，您最终会得到类似的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T14:20:28.520

您可以为引用项目的表创建一个唯一 id（db 生成 - 序列、autoinc 等），并创建两个额外的列（**tblSystemItemsFK**和**tblClientItemsFk**）分别引用系统项目和客户端项目 -*一些*数据库允许您拥有可以为*空*的外键。

如果您使用的是 ORM，您甚至可以仅根据列信息轻松区分客户端项目和系统项目（这样您就不需要负标识符来防止 ID 重叠）。

使用更多的 bakcground/context 可能更容易确定最佳解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T14:51:00.393

添加一个名为 Items 的表，其 PK ItemId 和一个名为 ItemType = "System" 或 "Client" 的单列，然后 ClientItems 表 PK（名为 ClientItemId）和 SystemItems PK（名为 SystemItemId）也都是 Items.ItemId 的 FK，（这些关系是零对一的关系 (0-1)

然后在引用项目的第三个表中，只需让它的 FK 约束引用这个额外（项目）表中的 itemId ......

如果您使用存储过程来实现插入，只需让插入项目的存储过程首先将新记录插入 Items 表，然后使用该表中自动生成的 PK 值将实际数据记录插入 SystemItems 或ClientItems（取决于它是）作为同一个存储过程调用的一部分，使用系统插入到 Items 表 ItemId 列中的自动生成（身份）值。

这称为“子类化”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T19:53:41.590

我一直对你的桌子设计感到困惑。我不确定它是否正确。我意识到第三个表可能只是提供详细信息，但我不禁认为主键实际上是您的 ITEM 表中的一个，而 FOREIGN 键是您的系统和客户端项目表中的键。然后，您只需要从 Item 到系统和客户端项目表进行正确的外部连接，所有约束都可以正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T04:50:59.963

我正在使用的数据库中有类似的情况。我在每个称为 EntityID 的表上都有一个“候选键”。然后，如果有一个表需要引用多个其他表中的项目，我使用 EntityID 来引用该行。我确实有一个 Entity 表来交叉引用所有内容（因此 EntityID 是 Entity 表的主键，而所有其他 EntityID 都是 FK），但我发现自己并不经常使用 Entity 表。

# cookies - 无法关闭 CFMX 8 中的持久跟踪 cookie

> ID：268786
> 
> 赞同：2
> 
> 时间：2008-11-06T14:03:54.323
> 
> 标签：cookies, coldfusion, administration, application.cfc

**CFMX 8 企业版**

我已经打开了内存变量下的“使用 J2EE 会话变量”设置，因为安全要求规定不能使用持久性 cookie。

我知道打开此设置将告诉 CF 仅创建和使用“JSESSIONID”会话 cookie。

但是，我的服务器似乎仍在创建和使用旧式的“CFID”和“CFTOKEN”cookie，有效期为 30 年后。

现在，显然，我可以在我的 Application.cfc 中使用 CFCOOKIE 操作 CFID 和 CFTOKEN 来删除过期日期，但这是我需要添加到所有应用程序中的东西。

是不是像重启 ColdFusion 服务一样简单？一个错误？还是我只是误解了设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T15:00:11.857

来自在线知识库数据库：

> 除了传统的 ColdFusion 会话管理之外，ColdFusion MX (CFMX) 还引入了 J2EE servlet 会话管理。J2EE 会话管理允许在单个应用程序内的 ColdFusion 页面和 JSP 页面或 servlet 之间共享会话信息。通过 J2EE 会话管理，ColdFusion 使用新变量 JSESSIONID 来跟踪用户的浏览器会话，而不是 CFID/CFTOKEN。**但是，ColdFusion MX 仍会创建 CFID 和 CFTOKEN 值，但这些值不再用于唯一标识浏览器会话。**J2EE 会话管理不需要应用程序名称，因此 SESSION.SESSIONID 值变为 JSESSIONID。因为 JSESSIONID 总是作为每个会话的值写入，所以当浏览器关闭时它会被销毁，并且每个新的浏览器会话都会创建一个新的。

因此生成了 CFID 和 CFTOKEN，但被忽略了。

# asp.net - 跨站点 ASP.NET 共享变量

> ID：268792
> 
> 赞同：2
> 
> 时间：2008-11-06T14:07:09.077
> 
> 标签：asp.net, variables

`isSearching`我的 web 应用程序的“函数”文件中有一个具有单个布尔属性的类。在我的搜索页面上，我有一个变量`oSearchHandler`声明为`Public Shared`变量。如何访问`oSearchHandler`我的 web 应用程序中其他页面上的内容？

带有会话的代码......

```
'search.aspx
Public Function oSearchString(ByVal oTextBoxName As String) As String
    For Each oKey As String In Request.Form.AllKeys
        If oKey.Contains(oTextBoxName) Then
            Session.Add("searching", True)
            Session.Add("search-term", Request.Form(oKey))
            Return Request.Form(oKey)
        End If
    Next
    Return ""
End Function

'theMaster.master
<%
If Session("searching") Then
%><ul style="float: right;">
    <li>
        <div class="gsSearch">
            <asp:TextBox ID="searchbox" runat="server"></asp:TextBox>
        </div>
    </li>
    <li>
        <div class="gsSearch">
            <asp:Button ID="searchbutton" runat="server" Text="search" UseSubmitBehavior="true" PostBackUrl="search.aspx" CssClass="searchBtn" />
        </div>
    </li>
</ul>
<%
End If
%> 
```

我认为该会话将正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:09:15.437

如果您谈论的是在页面交互之间访问这些变量，您需要记住状态在页面之间被丢弃。

相反，您需要将此数据存储在 Session State 中。

如果不是跨页面交互，而只是从代码的其他部分访问数据，那么关键是 ASP.NET 页面变成了一个类，而您的公共共享变量是该类的静态属性。

因此，您可以使用 PageName.oSearchHandler 从其他地方访问它

[编辑] 你能给我们更多关于 oSearchHandler 是什么以及你打算如何使用它的信息吗？那么，我们可能可以提供更深思熟虑的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T14:11:52.997

如果您希望从多个页面访问它，您应该将其从单个页面类中拉出，并将其放在更全局可访问的位置，例如 Application 集合。给定变量的命名，0SearchHandler 是委托吗？我不太熟悉 VB.NET 或术语。

更新：Steve Morgan 提到使用 Session 集合，当提到“静态”或“共享”时，我的想法更加全球化。根据您使用变量的方式，如果它将在用户和会话之间共享，则可以使用“应用程序”，或者如果它将由一个用户在一个会话中使用，则可以使用“会话”。在 VB.NET 中，它们都易于使用：

```
Session("yourKey") = YourObjectYouWantToSave
Application("yourKey") = YourObjectYouWantToSave 
```

很简单的东西。

```
'search.aspx
Public Function oSearchString(ByVal oTextBoxName As String) As String
    For Each oKey As String In Request.Form.AllKeys
        If oKey.Contains(oTextBoxName) Then
            Session("searching") = True
            Session("search-term") =  Request.Form(oKey)
            Return Request.Form(oKey)
        End If
    Next
    Return ""
End Function
' theMaster.master.vb
In PageLoad Method:
...
Dim bSearching as Boolean
bSearching = IIf(Session("searching") is Nothing, False, Session("searching") )

ulSearch.visible = bSearching
...

'theMaster.master
<ul style="float: right;" runat="server" id="ulSearch">
    <li>
        <div class="gsSearch">
            <asp:TextBox ID="searchbox" runat="server"></asp:TextBox>
        </div>
    </li>
    <li>
        <div class="gsSearch">
            <asp:Button ID="searchbutton" runat="server" Text="search" UseSubmitBehavior="true" PostBackUrl="search.aspx" CssClass="searchBtn" />
        </div>
    </li>
</ul> 
```

好的，这是一些额外的代码，但我认为你会遇到更少的问题。另外我的VB有点生疏。实际上，如果母版页是您将在其上使用它的页面，我会将变量作为该母版页上的公共属性。您可以使用 this.Master 访问页面母版页（至少在 C# 中，我认为它是 VB.NET 中的 Me.Master）。

# c# - 控制键加鼠标滚轮

> ID：268796
> 
> 赞同：9
> 
> 时间：2008-11-06T14:08:57.217
> 
> 标签：c#, events, mousewheel, keydown

在 C# 中处理 ctrl + 鼠标滚轮的更好方法是什么？我已经想出了如何处理 MouseWheel 事件，但是如何知道 ctrl 键也被按下了？

提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-06T14:17:58.820

使用静态属性，如：

```
System.Windows.Forms.Control.ModifierKeys 
```

# .net - 如何计算 Silverlight 中自动扩展文本框的正确高度？

> ID：268802
> 
> 赞同：0
> 
> 时间：2008-11-06T14:10:49.427
> 
> 标签：.net, wpf, silverlight

在我的 Silverlight 应用程序中，我希望每次用户按 Enter 时都会展开一个多行文本框。

困难的部分是如何根据文本行数计算出正确的高度。

我尝试了以下方法，但文本框变得太小：

```
box.Height = box.FontSize*lineCount + box.Padding.Top + box.Padding.Bottom + box.BorderThickness.Top + box.BorderThickness.Bottom; 
```

我在这里想念什么？或者也许它可以以某种方式自动完成？

谢谢，雅各布

**编辑：**我怀疑问题出在 FontSize 属性中（它是否使用另一个大小单位？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-10T23:56:16.297

这似乎是文本框开箱即用的方式。只需确保在文本框中设置[AcceptsReturn](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.acceptsreturn(VS.95).aspx) ="True" 即可。还要确保您没有设置文本框的高度，以便为您计算它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-21T14:16:35.887

将`TextBox`触发一个`SizeChanged`事件，它还将设置`ActualHeight`属性。

我认为 Silverlight 2 中的情况并非如此，当时我必须使用`TextBlock`具有相同字体的 a，将填充设置为 4，并设置相同的文本，然后将其`ActualHeight`关闭。

# reporting-services - 如何从 SSRS 报告中确定当前用户所在的 AD 安全组？

> ID：268808
> 
> 赞同：4
> 
> 时间：2008-11-06T14:12:56.460
> 
> 标签：reporting-services

我需要从 SQL Server Reporting Services 报告中确定用户属于哪个安全组。对报告的访问将由以下两个组之一的成员身份驱动：“report_name_summary”和“report_name_detail”。一旦用户执行报告，我们希望能够使用他们在“report_name_detail”组中的成员身份（或缺少成员身份）来确定是否应该允许“向下钻取”。

我不知道有任何开箱即用的方法来访问当前用户的 AD 安全组成员身份，但我愿意接受任何能够从报告中访问此信息的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T22:22:00.510

您可以将自定义代码添加到报告中。 [这个链接](http://msdn.microsoft.com/en-us/library/ms155798.aspx)有一些例子。

从理论上讲，您应该能够编写一些这样的代码，然后使用返回值来显示/隐藏您想要的内容。但是，您可能会遇到此方法的权限问题。

```
Public Function ShouldReportBeHidden() As Boolean
Dim Principal As New System.Security.Principal.WindowsPrincipal(System.Security.Principal.WindowsIdentity.GetCurrent())
If (Principal.IsInRole("MyADGroup")) Then
    Return False
Else
    Return True
End If
End Function 
```

**或者**，您可以将详细报告添加为摘要报告的子报告。然后，您可以使用 SSRS 内置的安全功能来限制对子报告的访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-08T18:50:48.730

在 Reporting Services 中，只需使用：

```
Public Function IsMemberOfGroup() As Boolean

If System.Threading.Thread.CurrentPrincipal.IsInRole("MyADGroup") Then
    Return True
Else
    Return False
End If

End Function 
```

如[本帖所示](https://stackoverflow.com/questions/3095449/ssrs-windowsidentity-getcurrent-giving-me-nt-authority-network-service)

*注意：一旦将报告部署到服务器但不在 IDE 中，这将起作用。*

# java - Java中未初始化的变量和成员

> ID：268814
> 
> 赞同：32
> 
> 时间：2008-11-06T14:14:09.297
> 
> 标签：java, oop, variables

考虑一下：

```
public class TestClass {

    private String a;
    private String b;

    public TestClass()
    {
    a = "initialized";
    }

    public void doSomething()
    {
    String c;

        a.notify(); // This is fine
    b.notify(); // This is fine - but will end in an exception
    c.notify(); // "Local variable c may not have been initialised"
    }

} 
```

我不明白。“b”从未初始化，但会给出与“c”相同的运行时错误，这是一个编译时错误。为什么局部变量和成员之间有区别？

**编辑**：将成员设为私有是我的初衷，但问题仍然存在......

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-11-06T14:23:40.027

语言以这种方式定义它。

对象类型的实例变量默认初始化为 null。默认情况下不初始化对象类型的局部变量，访问未定义的变量是编译时错误。

请参阅 SE7 的第 4.12.5 节（与 SE14 相同的部分） [http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-06T14:41:21.253

这是交易。你打电话时

```
TestClass tc = new TestClass(); 
```

该`new`命令执行四项重要任务：

1.  在堆上为新对象分配内存。
2.  将类字段初始化为其默认值（数字为 0，布尔值为`false`，对象为`null`）。
3.  调用构造函数（可能会重新启动字段，也可能不会）。
4.  返回对新对象的引用。

因此，您的字段 'a' 和 'b' 都被初始化为`null`，并且 'a' 在构造函数中被重新初始化。此过程与方法调用无关，因此*永远不会*初始化局部变量“c”。

高温高压

PS：对于严重失眠的人，请阅读[此](http://java.sun.com/docs/books/jls/second_edition/html/execution.doc.html#44670)内容。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-06T15:59:18.367

明确分配的规则非常困难（请阅读 JLS 第 3 版的第 16 章）。在字段上强制执行明确的分配是不切实际的。就目前而言，甚至可以在初始化之前观察最终字段。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T14:16:52.113

编译器可以确定 c 永远不会被设置。b 变量可以由其他人在调用构造函数之后设置，但在 doSomething() 之前。将 b 设为私有，编译器可能会提供帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T14:18:19.053

编译器可以从 doSomething() 的代码中看出 c 在那里声明并且从未初始化。因为是本地的，所以不可能在别处初始化。

它无法告诉您何时何地调用 doSomething()。b 是公共成员。在调用该方法之前，您完全有可能在其他代码中对其进行初始化。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-14T06:59:25.967

成员变量初始化为 null 或它们的默认原始值（如果它们是原始值）。

局部变量未定义且未初始化，您负责设置初始值。编译器会阻止您使用它们。

因此，当类 TestClass 被实例化而 c 未定义时，b 被初始化。

注意：null 与 undefined 不同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-26T19:21:20.293

您实际上已经确定了 Java 系统中较大的漏洞之一，即通常尝试在编辑/编译时而不是运行时查找错误，因为 - 正如公认的答案所说 - 很难判断 b 是否已初始化。

有几种模式可以解决这个缺陷。首先是“默认情况下最终”。如果您的成员是最终成员，则必须使用构造函数填充它们-并且它将使用路径分析来确保每个可能的路径都填充在决赛中（您仍然可以将其分配为“空”，这会破坏目的，但是至少你会被迫承认你是故意这样做的）。

第二种方法是严格的空值检查。您可以通过项目或默认属性在 Eclipse 设置中打开它。我相信它会迫使你在调用它之前对你的 b.notify() 进行空检查。这很快就会失控，因此它倾向于使用一组注释来使事情变得更简单：

注释可能有不同的名称，但在概念上，一旦您打开严格的空检查，并且注释的变量类型为“可空”和“非空”。如果您尝试将 Nullable 放入非空变量中，则必须首先检查它是否为空。参数和返回类型也进行了注释，因此您不必每次分配给非空变量时都检查空值。

还有一个“NotNullByDefault”包级别注释，它将使编辑器假定没有变量可以具有空值，除非您将其标记为 Nullable。

这些注释主要应用于编辑器级别——您可以在 eclipse 和可能的其他编辑器中打开它们——这就是为什么它们不一定是标准化的。（至少上次我检查时，Java 8 可能有一些我还没有找到的注释）

# php - AJAX 应用程序中的代码分离

> ID：268816
> 
> 赞同：5
> 
> 时间：2008-11-06T14:14:48.267
> 
> 标签：php, jquery, ajax

在 AJAX 应用程序中实现代码分离有哪些策略？

我正在构建一个 PHP 应用程序，我希望在该应用程序上有一个不错的 AJAX 前端。我早就学会了在我的 PHP 代码中使用某种模板来确保我的逻辑和显示代码之间保持良好的分离，但是我很难找到用前端的 JavaScript 代码执行此操作的好方法。我正在使用 jQuery 来轻松获取 XML 数据和 DOM 操作，但我发现逻辑和布局代码开始混杂在一起。

真正的问题是我从后端获取 XML 数据，然后必须对其进行重新格式化，并且必须将有用的文本包裹起来（方向等）。我考虑过发送已经格式化的 HTML，但这需要对后端进行大量修改，而且肯定有比我自己想出的更好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T14:32:26.357

*   在 HTML 页面中编写模板，可能在隐藏元素中。
*   通过 AJAX 调用获取数据，我发现使用 JSON 更容易，因此您不必“重新格式化”XML，它只是数据。
*   将模板应用于数据以生成 HTML 并插入到显示的页面中。

检查一些 jQuery 模板插件：[jsRepeater](http://plugins.jquery.com/project/jsrepeater) , [jTemplates](http://plugins.jquery.com/project/jTemplates) , [noTemplate](http://plugins.jquery.com/project/noTemplate) , [Template](http://plugins.jquery.com/project/Template)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T15:20:07.400

我最近一直在问类似的问题（[这里](https://stackoverflow.com/questions/251814/jquery-and-organized-code)和[这里](https://stackoverflow.com/questions/247209/javascript-how-do-you-organize-this-mess)），我发现了一些可以提供帮助的东西。我理解您在将 UI 交互强制写入代码时发现的相同问题。

**1：**为功能编写“类”并在构造函数中传入要修改的元素，无论是元素的ID还是元素本身，由您决定。

**2：**为可能因页面或控件而异的部分编写“事件”。所谓事件，我的意思是你可以用实际函数覆盖的占位符方法。所以举个例子...

```
var FilterControl = function() {

    //the "event"
    var self = this;
    this.onLoadComplete = function() { };

    //This is the command that calls the event
    this.load = function() {
        //do some work
        ...

        //Call the event
        self.onLoadComplete();
    };
};

//somewhere else in the code
var filter = new FilterControl();
filter.onLoadComplete = function() {
    //unique calls just for this control
}; 
```

**3：**获得一个对 Javascript 更友好的 IDE。我**喜欢**我的 Visual Studio，但是[Apanta](http://apanta.com)制作了一个出色的 IDE，它拥有一个非常强大的 Javascript IDE（它允许您将 .JS 文件拖到*文件引用*对话框中，这样您就可以对所有这些 Javascript 文档进行智能感知，从而解决它的主要原因之一很难拆分Javascript！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T14:23:26.827

我不是 100% 确定我明白你的问题，但你能做什么，特别是如果我们谈论的是单页样式的 AJAX 应用程序是使用面向特定任务的 Singletons 类。

```
var XMLFormatter = function(){
    /* PRIVATE AREA */

    /* PUBLIC API */
    return {
        formatXML : function(xml){
            /* DO SOMETHING RETURN SOMETHING */
        }
    }
}(); 
```

您剩下的是一个静态 XMLFormatter 类，可以像这样在页面上的任何位置调用它......

```
function useClass(){
    $('#test').update(XMLFormatter.formatXML(someXML))
} 
```

此函数可用作 AJAX 请求的回调。我通过创建一个 Page 类将这个方法用于页面逻辑，它返回一个带有 init 方法的对象，该方法在页面加载时被调用。然后 init 方法将各种事件和内容附加到我的页面及其元素。[如果您有时间和金钱，那么在Pro JavaScript Design Patterns](http://apress.com/book/view/159059908x)中谈到了这种方法， 非常值得一读。

同样值得记住的是，与其他语言相比，Javascript 有很大的不同，通常人们的最佳实践方法通常只是从 Java 改编而来的。虽然这没关系，但它并没有充分发挥 Javascript 的潜力。记住 Javascript 是相当事件驱动的，因为它与 UI 交互很接近，你会发现一些事件代码与其他代码混合在一起。Crockfords 网站 ( [http://javascript.crockford.com/](http://javascript.crockford.com/) ) 有一些最佳实践文章以及许多其他有用的提示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T15:42:20.537

如果我正确理解了这个问题，那么您在同一个代码块中有很多 HTML/javascript，并且您想将它们分开。

我会使用几个技巧来进行干净的分离：

*   每个操作组包含一个 JS 文件，其中包含脚本/函数。
*   一个包含所有常用功能（XML 解析器、实用程序...）的 JS 文件
*   一个 JS 文件，它（惰性）加载特定脚本（此处为项目 #1）并将任何事件附加到文档加载时的 currents 元素。

主要问题是将动态函数/事件附加到生成的代码。IIRC，JQuery 可以处理这个但不确定。

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T09:26:37.473

我不喜欢在客户端进行格式化，所以我总是尝试从 AJAX 回调中返回 HTML，除非我真的需要选择列表的数据，例如。

这样做的原因是我在服务器 (ASP) 上有一个丰富的工具集来创建 HTML，而在客户端上什么都没有。我在服务器上使用了一个自定义的“动态页面”，其中包含一个“动态控件”，其中包含我要格式化的数据的模板。只有该控件的内容从页面发出。

AJAX 调用的 Web 服务只做：返回 Execute(some-dynamic-page)。Web 服务的参数通过 HttpContext 包或查询字符串传递给动态页面。

我发现使用拖放控件在服务器上创建新的动态页面模板比使用客户端模板或 xml 转换器更容易。不过，我没有使用任何或 Jxxxx 模板工​​具 - 也许它们可以减轻痛苦。

使用该方法，您可以使用与通常相同的分离方式（MVP/MVC，或简单的代码隐藏）。

# java - 从 Java 代码访问 ColdFusion 数据源

> ID：268820
> 
> 赞同：1
> 
> 时间：2008-11-06T14:16:17.437
> 
> 标签：java, servlets, jdbc, coldfusion

我有一个 servlet，我想在 ColdFusion MX 7 中运行。如果可能，我想利用现有的 ColdFusion DSN 作为 javax.sql.DataSource。

我想像

```
coldfusion.server.ServiceFactory.getDataSourceService().getDatasource(dsname); 
```

会工作，但不幸的是servlet返回

```
java.lang.NoClassDefFoundError: coldfusion/server/ServiceFactory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T14:41:46.230

该代码可以正常工作，只是您的类路径中没有 ServiceFactory 。即，Java 不能加载该类。尝试在 C:\CFusionMX7\lib 中包含对 cfusion.jar 的依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T13:37:20.620

似乎最简单的方法是在 jrun-resources.xml 中添加一个额外的 JNDI 数据源。然后可以通过传统方式访问它：

```
Context context = new InitialContext();
DataSource ds = (DataSource)context.lookup("mydatasource"); 
```

这确实意味着复制数据库连接配置，但我宁愿这样做，也不愿使用大部分未记录的 Coldfusion.server.* 类。

# web-services - 在 WS 中使用带有“通用”XML 的字符串——好还是坏？

> ID：268824
> 
> 赞同：1
> 
> 时间：2008-11-06T14:16:44.720
> 
> 标签：web-services

我们现在正在为我们的产品设计一个新的 API，它将通过 Web 服务公开。我们是否应该使用具有明确定义的类型（我的意见）的严格参数或将在任何所需结构中包含 XML 的字符串存在争议。很明显，理想情况下使用严格的签名更安全，它将允许我们的用户使用像 wsdl2java 这样的工具。OTOH，我们的产品正在快速发展，如果服务的参数必须改变，使用 XML（作为字符串或 anyType 传递 - 不是复杂类型，这是定义良好的类型）将不需要更改接口。

所以，我所要求的基本上是经验法则建议——您更喜欢使用严格类型还是灵活的 XML？您在使用这两种方式时遇到过任何重大问题吗？

谢谢，伊兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T14:22:27.843

我更喜欢使用严格类型。这使您可以访问客户端工具，从而更轻松地完成工作。您还声明，如果消息传递发生更改，字符串方法将不需要更改接口。就个人而言，我认为这是一个劣势，而不是优势。如果界面发生变化，您将很快知道哪些客户端需要更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T17:20:10.233

包含 XML 的字符串是一个非常糟糕的主意并且会自找麻烦。使用具有已定义架构的消息。我不得不重写应用程序的重要部分，该应用程序在内部使用大量 XML 而不是类型。它非常缓慢，无法弄清楚发生了什么。

# java - 休眠事务管理器问题

> ID：268835
> 
> 赞同：4
> 
> 时间：2008-11-06T14:18:54.357
> 
> 标签：java, hibernate

我是 Hibernate 的新手，并试图运行一个从 MS SqlServer 中的表中检索数据的 java/spring 示例。每次我尝试运行程序时，数据源都可以正常加载。但是当 spring 尝试加载 session facotry 时，会出现以下错误：

```
Exception in thread "main" org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'sessionFactory' 
        defined in class path resource [ml/spring/src/applicationContext.xml]: 
Instantiation of bean failed; nested exception is
    java.lang.NoClassDefFoundError: javax/transaction/TransactionManager
    Caused by: java.lang.NoClassDefFoundError: javax/transaction/TransactionManager 
```

下面是我正在使用的应用程序上下文文件：

```
<!-- Data source bean -->
<bean id="dataSource" 
    class="org.springframework.jdbc.datasource.DriverManagerDataSource"  >
    <property name="driverClassName">
        <value>com.microsoft.jdbc.sqlserver.SQLServerDriver</value></property>
    <property name="url">
        <value>jdbc:microsoft:sqlserver://machine:port</value></property>
    <property name="username"><value>user</value></property>
    <property name="password"><value>password</value></property>
</bean>

<!--  Session Factory Bean -->
<bean id="sessionFactory" 
    class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource"><ref local="dataSource"/></property>
    <property name="mappingResources">
    <list>
        <value>authors.hbm.xml</value>
    </list>
    </property>
    <property name="hibernateProperties">
        <value>
            hibernate.dialect=net.sf.hibernate.dialect.SQLServerDialect
        </value>
    </property> 
</bean>

<bean id="txManager"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-06T14:32:32.363

您缺少包含 JTA API 类的 JAR 文件。当您下载 Hibernate 时，您可能已经拥有一个。它应该被称为：

```
jta-1.1.jar 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-09T14:23:43.033

如果您使用的是 maven，请使用[this](https://mvnrepository.com/artifact/javax.transaction/jta/1.1)，

```
<dependency>
    <groupId>javax.transaction</groupId>
    <artifactId>jta</artifactId>
    <version>1.1</version>
</dependency> 
```

# c# - 为什么我们需要 C# 中协变和逆变的新关键字？

> ID：268836
> 
> 赞同：17
> 
> 时间：2008-11-06T14:20:19.657
> 
> 标签：c#, c#-4.0, covariance, contravariance

有人可以解释为什么需要添加 out 或 in 参数来指示泛型类型是 C# 4.0 中的 Co 或 Contra 变体吗？

我一直在试图理解为什么这很重要以及为什么编译器不能弄清楚..

谢谢，

乔什

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T14:29:49.640

从事语言工作的 Eric Lippert 在 msdn 上有一系列帖子，应该有助于澄清所涉及的问题：http:
[//blogs.msdn.com/ericlippert/archive/tags/Covariance+and+Contravariance/default.aspx](http://blogs.msdn.com/ericlippert/archive/tags/Covariance+and+Contravariance/default.aspx)

阅读该链接上显示的文章时，请从底部开始并逐步进行。

最终你会得到[#7（为什么我们需要语法？）](http://blogs.msdn.com/ericlippert/archive/2007/10/29/covariance-and-contravariance-in-c-part-seven-why-do-we-need-a-syntax-at-all.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T14:39:42.880

我们实际上并不*需要*它们，不再需要`abstract`类或两者`out`兼而有之`ref`。它们的存在只是为了让我们作为程序员可以清楚地表达我们的意图，以便维护程序员知道我们在做什么，并且编译器可以验证我们是否做对了。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T14:48:25.890

好吧，主要问题是，如果您有一个类层次结构，例如：

```
 class Foo { .. } 

   class Bar : Foo { .. } 
```

而且你有一个`IEnumerator<Bar>`，你不能把它用作一个，`IEnumerator<Foo>`即使那是非常安全的。在 3.5 中，这会导致大量痛苦的旋转。这个操作总是安全的，但被类型系统拒绝，因为它不知道泛型类型参数的协变使用。`IEnumerator<Bar>`只能返回 a`Bar`并且every`Bar`是 a `Foo`。

同样，如果您有 an`IEqualityComparer<Foo>`它可以用于比较任何类型的对象，`Foo`即使其中一个或两个都是 a `Bar`，但它不能转换为 an`IEqualityComparer<Bar>`因为它不知道泛型类型参数的逆变使用。`IEqualityComparer<Foo>`仅消耗类型的对象，`Foo`并且每个`Bar`都是`Foo`.

如果没有这些关键字，我们就不得不假设泛型参数既可以作为方法的参数出现，也可以作为方法的结果类型出现，因此我们不能安全地允许上述任何一种转换。

有了它们，类型系统就可以自由地允许我们在这些接口之间按照关键字指示的方向安全地向上转换和向下转换，并且我们会得到错误，表明我们何时会违反确保安全所需的规则。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T14:29:33.307

`in`and关键字自 C# 1.0 以来一直是关键字，`out`并且已在方法的`in`- 和`out`- 参数的上下文中使用。

协变和逆变是对如何实现接口的约束。没有很好的方法来推断它们——我认为唯一的方法是从使用中，这会很混乱，最终它不会起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T14:54:39.713

Jon 和 Joel 都对此提供了非常完整的答案，但最重要的是编译器并不**需要**它们，而是通过显式指示参数的变化来帮助保证实现的安全性。这与在调用站点和声明站点都需要`out`or关键字的模式非常相似。`ref`

# c# - 是否可以在 C# 中编写 Quake 的快速 InvSqrt() 函数？

> ID：268853
> 
> 赞同：32
> 
> 时间：2008-11-06T14:25:12.113
> 
> 标签：c#

这只是为了满足我自己的好奇心。

有没有这样的实现：

```
float InvSqrt (float x)
{
   float xhalf = 0.5f*x;
   int i = *(int*)&x;
   i = 0x5f3759df - (i>>1);
   x = *(float*)&i;
   x = x*(1.5f - xhalf*x*x);
   return x;
} 
```

在 C# 中？如果存在，请发布代码。

我想我应该提到我正在寻找一个“安全”的实现......无论哪种方式，BitConverter 代码都可以解决问题。联合的想法很有趣。我会测试它并发布我的结果。

编辑：正如预期的那样，不安全的方法是最快的，其次是使用联合（在函数内部），然后是 BitConverter。这些函数执行了 10000000 次，我使用 System.Diagnostics.Stopwatch 类进行计时。计算结果显示在括号中。

```
Input: 79.67
BitConverter Method: 00:00:01.2809018 (0.1120187)
Union Method: 00:00:00.6838758 (0.1120187)
Unsafe Method: 00:00:00.3376401 (0.1120187) 
```

为了完整起见，我测试了内置的 Math.Pow 方法和“朴素”方法 (1/Sqrt(x))。

```
Math.Pow(x, -0.5): 00:00:01.7133228 (0.112034710535584)
1 / Math.Sqrt(x): 00:00:00.3757084 (0.1120347) 
```

1 / Math.Sqrt() 之间的差异是如此之小，以至于我认为不需要求助于 C# 中的 Unsafe Fast InvSqrt() 方法（或任何其他不安全的方法）。除非*真的*需要从 CPU 中挤出最后一点汁液...... 1/Math.Sqrt() 也更准确。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T14:40:59.367

您应该能够使用 StructLayout 和 FieldOffset 属性来伪造普通旧数据（如浮点数和整数）的联合。

```
[StructLayout(LayoutKind.Explicit, Size=4)]
private struct IntFloat {
    [FieldOffset(0)]
    public float floatValue;

    [FieldOffset(0)]
    public int intValue;

    // redundant assignment to avoid any complaints about uninitialized members
    IntFloat(int x) {
        floatValue = 0;
        intValue = x;
    }

    IntFloat(float x) { 
        intValue = 0;
        floatValue = x;
    }

    public static explicit operator float (IntFloat x) {
        return x.floatValue;
    }

    public static explicit operator int (IntFloat x) { 
        return x.intValue;
    }

    public static explicit operator IntFloat (int i) {
        return new IntFloat(i);
    }
    public static explicit operator IntFloat (float f) { 
        return new IntFloat(f);
    }
} 
```

然后翻译 InvSqrt 很容易。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-06T14:39:46.717

如果您想避免不安全的代码，请使用[BitConverter 。](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)

```
float InvSqrt(float x)
{
    float xhalf = 0.5f * x;
    int i = BitConverter.SingleToInt32Bits(x);
    i = 0x5f3759df - (i >> 1);
    x = BitConverter.Int32BitsToSingle(i);
    x = x * (1.5f - xhalf * x * x);
    return x;
} 
```

上面的代码使用了 .NET Core 2.0 中引入的新方法。对于 .NET Framework，您必须回退到以下内容（执行分配）：

```
float InvSqrt(float x)
{
    float xhalf = 0.5f * x;
    int i = BitConverter.ToInt32(BitConverter.GetBytes(x), 0);
    i = 0x5f3759df - (i >> 1);
    x = BitConverter.ToSingle(BitConverter.GetBytes(i), 0);
    x = x * (1.5f - xhalf * x * x);
    return x;
} 
```

否则，C# 代码与您提供的 C 代码完全相同，只是该方法需要标记为不安全：

```
unsafe float InvSqrt(float x) { ... } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-06T14:45:55.037

在不安全模式下绝对可能。请注意，尽管在 Quake 3 源代码`0x5f3759df`中使用了该常数，但[数值研究表明](http://www.lomont.org/Math/Papers/2003/InvSqrt.pdf)该常数`0x5f375a86`实际上为牛顿近似产生了更好的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T14:28:01.047

我不明白为什么不能使用**unsafe 编译器选项**。

# url - 在 C#.Net2 中调试 Web 应用程序时 localhost 上的奇怪 url

> ID：268854
> 
> 赞同：0
> 
> 时间：2008-11-06T14:25:21.753
> 
> 标签：url, asp.net-2.0

[http://localhost/XYZ/Client/(S(enlodz55ov4ncafza0gpp045))/Info/Rates.aspx](http://localhost/XYZ/Client/(S(enlodz55ov4ncafza0gpp045))/Info/Rates.aspx)

反正知道**/(S(enlodz55ov4ncafza0gpp045))/**是什么意思吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:28:46.303

如果您使用的是无 cookie 会话状态，则它是会话标识符。

请参阅此 MSDN 文章：http: [//msdn.microsoft.com/en-us/library/aa479314.aspx](http://msdn.microsoft.com/en-us/library/aa479314.aspx)

# mysql - MySQL 字符集

> ID：268855
> 
> 赞同：2
> 
> 时间：2008-11-06T14:25:27.993
> 
> 标签：mysql

例如，如果我需要一个 varchar(30) 字段，它需要包含几个不同的外来字符集，那么我可以在 MySQL 中使用一种特定的语言类型吗？例如，我有一个字段包含中文、俄语、英语、西班牙语和葡萄牙语的名称，将来可能还会更多。如何为 varchar() 字段启用此功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:27:07.007

Unicode 可以包含全世界使用的每个字符。

请务必使用 UTF-8 作为字段。（更好的是，对于整个数据库）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T14:27:19.020

**utf-8**是你的朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-11T08:57:25.177

**utf8mb4**应该是那里的答案。

# .net - 如何使用反射器将整个程序集转储到源文件？

> ID：268858
> 
> 赞同：2
> 
> 时间：2008-11-06T14:26:19.803
> 
> 标签：.net, reflector, disassembly

有没有办法使用反射器将整个程序集源转储到文件中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T14:30:58.827

[FileDisassembler](http://www.denisbauer.com/NETTools/FileDisassembler.aspx)插件让我很幸运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T14:29:05.960

是的，右键单击程序集并选择导出...

# version-control - 如果 TFS 中的文件被其他人锁定了怎么办？

> ID：268865
> 
> 赞同：62
> 
> 时间：2008-11-06T14:28:17.630
> 
> 标签：version-control, command-line, tfs, administration

有人离开了组织，但在离开之前，他以未知原因锁定了所有文件。

您如何将它们全部解锁，以便其他开发人员可以工作？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-11-06T14:28:57.003

对于以下操作，您需要是您想要撤消签入的项目的项目管理员，或者如果您想在所有项目中执行此操作，您需要是 Team Foundation 管理员。

如果您仍然拥有此人的用户名，您可以简单地执行以下操作：

*   打开 Visual Studio 命令提示符（开始 -> 程序 -> Microsoft Visual Studio 200X -> Visual Studio 工具 -> Visual Studio 200X 命令提示符）
*   运行以下命令：

> tf lock /lock:none /workspace:WorkspaceName;USERNAME /recursive $/

要获取用户的工作区列表，只需在同一提示符下运行以下命令：

> tf 工作区/所有者：用户名

有关更多命令，请查看**tf /?**

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-06T14:48:22.660

如果开发人员已经离开了组织，那么最好的办法就是删除他们的工作区。这将为您解锁文件，但也会释放服务器上的一些资源。

请参阅几年前发生在我身上的有关该主题的以下博客文章。

[http://www.woodwardweb.com/vsts/unlocking_files.html](http://www.woodwardweb.com/vsts/unlocking_files.html)

您可以使用命令行 (tf.exe) 删除工作区，也可以使用 Atrice 的出色[TFS Sidekicks](http://www.attrice.info/cm/tfs/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-29T22:23:53.270

这是我解决此问题的唯一方法，其中涉及删除用户的工作区。

如果错误消息显示“项目 $/... 已被工作空间 someMachine123 中的 someUser:1 锁定以供签出。” 然后我使用命令：

```
tf workspace /delete /server:http://machinename:8080/tfs/DefaultCollection someMachine123;someUser:1 
```

集合 URL 和`someMachine123;someUser:1`.

请注意，我注意到错误消息将用户称为`someUser:1`，因此我在命令中模仿了这一事实。仅运行命令是不够的`someUser`。我不确定 :1 是什么意思，但重点是模仿错误消息。

请注意，服务器必须是完全限定的集合路径，您可以通过转到 Team Foundation Server 管理控制台->应用程序层->团队项目集合来找到它，底部窗格将显示在上部选择的集合的 URL窗格。

我也遇到了一个问题，因为我不小心尝试使用复数`workspaces`而不是仅仅`workspace`因为有一个类似的命令是复数。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-06T14:31:59.433

首先，您需要有权这样做。如果你有最简单的方法是使用 attrice [http://www.attrice.info/cm/tfs/的 TFS 助手](http://www.attrice.info/cm/tfs/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T14:31:59.823

[这](http://blogs.microsoft.co.il/blogs/srlteam/archive/2007/03/14/Undo_2F00_Unlock-for-others-in-TFS.aspx)是使用 TFS 权限的说明。

> 需要将“解锁其他用户的更改”权限设置为允许才能删除其他用户持有的锁。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-17T13:49:54.040

我需要添加 /collection:collectionURL 否则找不到工作区：

*   项目清单

tf loc /lock:none /workspace:WorkspaceName;用户名 /collection:collectionURL

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T15:03:11.490

让系统管理员重置该用户密码，以该用户身份登录，解锁所有文件...

我认为这是几乎所有“不再在该组织工作的人”问题的解决方案......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-22T20:12:21.280

**最好从服务器中删除该用户的工作区。例子**

tf 工作区 /delete /server:your_tfs_server 工作区；用户名

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-20T23:44:52.830

有时这掩盖了一个完全不同的应用程序被另一个用户锁定的不同问题，但您甚至无法为您希望合并到的新项目创建一个新文件夹（目标不允许创建并错误地指出某人有一个文件以他们的名义锁定），但随后您深入挖掘，另一个项目是罪魁祸首。

**因此，一个完全不同的项目可能会出现文件被其他人锁定的问题。**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-05T11:09:38.280

对我有用的方法，我的帐户对**TFS**和项目具有管理员权限：

在 Visual Studio 2015 中：

1.  转到**团队资源管理器**
2.  在您的解决方案上单击鼠标右键，然后选择**在源代码管理资源管理器中打开**
3.  在左侧单击您的解决方案
4.  选择**高级**
5.  选择**锁定...**
6.  在左侧单击您的解决方案
7.  选择**高级**
8.  选择**解锁**（现在您可以选择解锁）

现在，每个开发人员都可以轻松提交他的更改 :)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-27T13:18:43.537

通过使用 TFS 权限，打开 Visual Studio 命令提示符，运行以下命令：

```
tf undo /workspace:workspaceName;DomainName\UserName  $/file path in your solution 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2016-04-20T23:21:25.337

**将此解决方案用作最后的手段**。

我正在使用 TFS 2012。我去了 TFS 数据库并运行了以下查询。它奏效了！**当然，在弄乱数据库、进行备份等时要非常小心。**

该数据库称为*Tfs_<<your_TFS_collection_name>>*。忽略*Tfs_Configuration* MSSQL 数据库。我不确定，但如果您没有*Tfs_<<your_TFS_collection_name>>*数据库，则设置可能在*Tfs_DefaultCollection*数据库中。锁存储在*tbl_PendingChange.LockStatus*中。

```
/*Find correct row*/
SELECT LockStatus, PendingChangeId, *
FROM tbl_PendingChange
WHERE TargetServerItem like '%<<fileName>>%'

/*Set lock status to NULL (mine was set to 2 initially)*/
UPDATE tbl_PendingChange SET LockStatus = NULL WHERE
TargetServerItem like '%<fileName>>%'
AND PendingChangeId = <<PendingChangeId from above>> 
```

# mysql - 将访问日期时间类型转换为 mysql 类型

> ID：268884
> 
> 赞同：0
> 
> 时间：2008-11-06T14:32:35.110
> 
> 标签：mysql, ms-access, csv

我正在尝试使用以下字符串将访问日期时间字段转换为 mysdl 格式：

```
select str_to_date('04/03/1974 12:21:22', '%Y %m %d %T'); 
```

虽然我没有收到错误，但我没有得到预期的结果，而是得到了这个：

```
+---------------------------------------------------+
| str_to_date('04/03/1974 12:21:22', '%Y %m %d %T') |
+---------------------------------------------------+
| NULL                                              |
+---------------------------------------------------+
1 row in set, 1 warning (0.01 sec) 
```

访问日期采用以下格式：

```
06.10.2008 14:19:08 
```

我不确定我错过了什么。

作为一个附带问题，我想知道在导入 csv 文件之前是否可以更改列中的数据？我想用我自己的日期替换 insert_date 和 update_date 字段，我不确定在导入之前还是之后这样做会更容易。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T14:46:45.330

您的函数语法已关闭。

尝试：

```
select str_to_date('04/03/1974 12:21:22', '%m/%d/%Y %T'); 
```

第二个参数告诉函数日期部分在字符串中的位置。

对于您的访问问题：

```
select str_to_date('06.10.2008 14:19:08', '%m.%d.%Y %T'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:45:48.950

首先，显示的 str_to_date 不起作用，因为格式与字符串不匹配。如果日期类似于“1974 04 03 12:21:22”，“%Y %m %d %T”将起作用

正确的格式应该是 '%m/%d/%Y %T'（月/日/年时间）。或“%d/%m/%Y %T”（日/月/年时间）。

至于访问，看起来像是将上面的内容更改为使用 . / 应该在哪里工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T03:31:03.480

我不清楚您使用的是哪一端，Access 端还是 MySQL 端，尽管看起来您正在尝试使用 MySQL 的函数来解决它。如果您的问题是您已从 Access/Jet 导出 CSV 并且它不是预期的格式，那么您可能需要修复从 Access 导出的 CSV 以使用 MySQL 理解的格式。

如果您有能力使用 Access/Jet 数据库，为 MySQL 数据库设置 ODBC DSN，然后在 Access 中创建链接表，您可以直接将 Access 表中的数据附加到链接表中你的 MySQL 表。然后 MyODBC 驱动程序将为您处理数据转换。

# c# - 如何使用 LINQ 和 C# 插入记录并返回该记录的主键

> ID：268885
> 
> 赞同：19
> 
> 时间：2008-11-06T14:32:41.583
> 
> 标签：c#, linq

编写插入记录然后使用 C# 返回新插入记录的主键的 LINQ 查询的最佳方法是什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-06T14:33:47.977

主键值将在 SubmitChanges() 之后的该属性中。

```
MyTable record = new MyTable();
record.Name = "James Curran";
db.MyTable.InsertOnSubmit(record);
db.SubmitChanges();
Console.WriteLine("record inserted as ID : {0}", record.Id); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-28T09:26:31.787

```
// Create a new Order object.
Order ord = new Order
{
    OrderID = 12000,
    ShipCity = "Seattle",
    OrderDate = DateTime.Now
    // …
};

// Add the new object to the Orders collection.
db.Orders.InsertOnSubmit(ord);

// Submit the change to the database.
try
{
    db.SubmitChanges();
}
catch (Exception e)
{
    Console.WriteLine(e);
    // Make some adjustments.
    // ...
    // Try again.
    db.SubmitChanges();
}
return ord.OrderID; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T14:52:51.027

dc.SubmitChanges() 将该记录提交到数据库后，将填写 AutoGeneratedValue=true 的任何字段

# firefox - 检索使用 Firefox 上传的文件的完整路径（服务器端）？

> ID：268889
> 
> 赞同：4
> 
> 时间：2008-11-06T14:34:27.930
> 
> 标签：firefox, file-upload

当我使用包含`<input id="myFile" type="file" runat="server" />`上传文件的表单时，我的服务器端代码在使用 Firefox 时只能看到没有完整路径的文件名，而它在 IE 中工作得很好。

在这种情况下是否可以在服务器端检索完整的文件路径？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T15:07:12.247

你不能。实际上，在大多数情况下，只有 IE 提供了对服务器并不重要的信息。至少 FF 和 Opera 都没有提供这些信息。
[更新] 还尝试使用 Safari，仍然没有路径...有人报告说 Chrome 可能会提供信息，虽然是测试版，但可能会改变...

在某些 Intranet 案例中，您可能需要它们。在这种情况下，您可能会要求用户将路径粘贴到辅助输入字段中......不是很友好，但至少他们会知道他们提供了信息。

实际上，我知道有些人出于某些原因需要此信息，所以他们使用 JavaScript 从文件输入字段中获取路径并将其放入隐藏字段中。FF 开发人员发现它不安全（你可以从简单的路径中学到很多东西……比如用户的登录名！）所以在 FF3 中禁止这样的使用，这让一些人对这个版本感到愤怒……

参考： Firefox 3 的烦恼中提到的[Firefox 3 的文件上传框](http://codangaems.blogspot.com/2008/06/firefox-3s-file-upload-box.html "Firefox 3 的文件上传框")[：Keying-in disabled in file upload control ...](http://www.donationcoder.com/Forums/bb/index.php?topic=13929.msg119729 "Firefox 3 的烦恼：在文件上传控制中禁用键入...")；禁用文件输入框也会[导致很大的可用性问题](http://forums.mozillazine.org/viewtopic.php?f=23&t=667085&start=0&st=0&sk=t&sd=a&sid=6a938f60dbb02ebad928f88bf60662fc "禁用文件输入框会导致很大的可用性问题")，等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T14:38:45.127

您永远无法确保获得完整的文件路径，甚至无法确定在文件上传文件中提交的可靠文件名或内容类型。即使您获得完整的文件路径，您也不知道客户端操作系统上的路径分隔符是什么，或者文件扩展名（如果存在）是否表示任何内容。

如果您的应用程序需要提交文件的文件路径/文件名/内容类型，而不是为用户提供上传项目的默认标题，那么它做错了，需要修复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T15:36:34.903

我已经在评论中说明了这一点，但我认为它值得重复。

Microsoft 选择让文件控件提供文件的完整路径，以便在 Intranet 应用程序中使用。

HTML 规范仅在一处[提到](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.4.1)了值应包含的内容：

> 用户代理可以使用 value 属性的值作为初始文件名。

但是，他们也有 multipart/form-data 编码[应该](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.13.4.2)是什么样子的示例，并且它不包含文件路径。

换句话说，IE 正在打破标准，你不能依赖其他浏览器，甚至是更高版本的 IE 来支持它。

# release-management - 除了版本控制系统，有没有支持发布管理的工具？

> ID：268890
> 
> 赞同：1
> 
> 时间：2008-11-06T14:34:49.053
> 
> 标签：release-management

大多数时候，我看到发布管理作为一个已定义的过程处理，支持工具作为版本控制系统（通常通过分支和标记）。但是，有没有专门用于发布管理的工具？我正在寻找开源和闭源工具，如果有的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:43:16.227

您可以使用[ant](http://ant.apache.org/)或[maven](http://maven.apache.org/)自动执行任务，例如生成包和部署到远程服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:44:57.707

发布管理超越了工具，但这并不意味着您不能建立一个环境来支持您的 RM 流程和策略。我们的 RM 方法严重依赖 Visual Studio TFS，因为它支持构建自动化、SCM、QA（测试），并与 SharePoint 2007 集成以用于文档目的。

我们的 RM 工作流也托管在 SharePoint 中。显然，这一切都非常依赖于 Microsoft 堆栈，但也有等效的 OSS 工具。

ETA：我们的 RM 方法在很大程度上基于 ITIL v2，因此它可能比您要求的更严格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T08:04:14.443

根据定义，发布管理是一个托管过程。我已经看到大型组织使用 HP Service Manager 进行该领域的流程管理。他们有一个与变更管理模块一起使用的发布控制模块。

在房子的更多 java 开发方面，我看到了与 Jenkins 一起使用的 Artifactory 插件。 [http://blogs.jfrog.org/2011/06/jenkins-new-maven-and-gradle-release.html](http://blogs.jfrog.org/2011/06/jenkins-new-maven-and-gradle-release.html)

# python - 替换嵌套数组中的多次出现

> ID：268891
> 
> 赞同：3
> 
> 时间：2008-11-06T14:36:01.263
> 
> 标签：python, arrays, dictionary, replace

我有这个 python 字典“mydict”，包含数组，它看起来像这样：

```
mydict = dict(
    one=['foo', 'bar', 'foobar', 'barfoo', 'example'], 
    two=['bar', 'example', 'foobar'], 
    three=['foo', 'example']) 
```

我想用“someotherword”替换所有出现的“example”。

虽然我已经可以想到几种方法来做到这一点，但是否有一种最“pythonic”的方法来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T15:13:48.007

```
for arr in mydict.values():
    for i, s in enumerate(arr):
        if s == 'example':
            arr[i] = 'someotherword' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T22:15:59.557

如果您想保持原始状态不变，只返回一个应用了修改的新字典，您可以使用：

```
replacements = {'example' : 'someotherword'}

newdict = dict((k, [replacements.get(x,x) for x in v]) 
                for (k,v) in mydict.iteritems()) 
```

这也有一个优点，即只需将新单词添加到替换字典即可轻松扩展它们。如果你想改变一个现有的字典，你可以使用相同的方法：

```
for l in mydict.values():
    l[:]=[replacements.get(x,x) for x in l] 
```

然而，它可能会比[JF Sebastian 的](https://stackoverflow.com/questions/268891/replacing-multiple-occurrences-in-nested-arrays#269043)解决方案慢，因为它会重建整个列表，而不是仅仅修改已更改的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T05:18:17.457

这是另一种看法：

```
for key, val in mydict.items():
    mydict[key] = ["someotherword" if x == "example" else x for x in val] 
```

我发现构建列表的速度**非常**快，但如果性能很重要，当然会配置文件。

# c++ - 删除地图中的特定条目，但迭代器必须指向删除后的下一个元素

> ID：268898
> 
> 赞同：2
> 
> 时间：2008-11-06T14:39:24.860
> 
> 标签：c++, stl, map

### 复制：

> [如果在从头到尾迭代时在地图元素上调用擦除会发生什么](https://stackoverflow.com/questions/263945/what-happens-if-you-call-erase-on-a-map-element-while-iterating-from-begin-to-e)
> 
> [如何从标准映射中过滤项目](https://stackoverflow.com/questions/180516/how-to-filter-items-from-a-stdmap)

我有一张地图`map1<string,vector<string>>`我有这个地图“itr”的迭代器。我想从这个地图中删除“itr”指向的条目。我可以使用函数 map1.erase(itr); 在这一行之后，迭代器“itr”变得无效。根据我在项目中的要求，迭代器必须指向下一个元素。任何人都可以帮我提前注册这个：) santhosh

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T15:18:29.073

您可以在将迭代器作为参数传递给擦除时对迭代器进行后增量：

```
myMap.erase(itr++) 
```

这样，`itr`在擦除之前指向的元素被删除，并且迭代器递增以指向映射中的下一个元素。如果您在循环中执行此操作，请注意不要将迭代器增加两次。

另请参阅类似问题的[此答案，或](https://stackoverflow.com/questions/180516/how-to-filter-items-from-a-stdmap#180772)[对此问题](https://stackoverflow.com/questions/263945/what-happens-if-you-call-erase-on-a-map-element-while-iterating-from-begin-to-e)的回应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T14:51:10.063

```
map<...>::iterator tmp(iter++);
map1.erase(tmp); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T18:15:37.890

简单的答案：

```
map.erase(iter++);  // Post increment. Increments iterator,
                    // returns previous value for use in erase method 
```

之前问过并回答过：
[如果在从头到尾迭代时在地图元素上调用擦除会发生什么](https://stackoverflow.com/questions/263945/what-happens-if-you-call-erase-on-a-map-element-while-iterating-from-begin-to-e)
[如何从标准映射中过滤项目](https://stackoverflow.com/questions/180516/how-to-filter-items-from-a-stdmap)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T14:56:43.453

```
#include <boost/next_prior.hpp>

map<string,vector<string> >::iterator next = boost::next(itr);
map1.erase(iter);
iter = next; 
```

# c# - 如何将多字符串转换为 C# 字符串集合/从 C# 字符串集合转换？

> ID：268899
> 
> 赞同：7
> 
> 时间：2008-11-06T14:39:26.517
> 
> 标签：c#, winapi, string

多字符串（空分隔字符串的双空终止字符串）在 Windows API 中很常见。将从 API 返回的多字符串转换为 C# 字符串集合的好方法是什么，反之亦然？

我对正确处理字符编码（Windows XP 和更高版本）特别感兴趣。

以下方法似乎可以用于创建多字符串，但我没有解码多字符串的示例。

```
static string StringArrayToMultiString(
    ICollection<string> stringArray
    )
{
    StringBuilder multiString = new StringBuilder();

    if (stringArray != null)
    {
        foreach (string s in stringArray)
        {
            multiString.Append(s);
            multiString.Append('\0');
        }
    }

    return multiString.ToString();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T14:47:05.703

这可能是幼稚的，但是如何：

```
static string[] MultiStringToArray(string multiString)
{
    return multiString.TrimEnd('\0').Split('\0');
} 
```

~~另外 - 你是不是错过了最后的`\0`（你说双空终止）`StringArrayToMultiString`？~~如果数组是一个`params string[]`数组，调用起来可能会更容易——比如：

```
 static string StringArrayToMultiString(params string[] values)
{
    if (values == null) throw new ArgumentNullException("values");
    StringBuilder multiString = new StringBuilder();

    foreach (string s in values)
    {
        multiString.Append(s);
        multiString.Append('\0');
    }
    return multiString.ToString();
} 
```

[在澄清最终 \0 后编辑]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T16:59:11.523

I've tested the StringArrayToMultiString method, using the ChangeServiceConfig() function to change the dependencies of a Windows service, and it works nicely for zero, one and many strings.

In the meantime, I've worked out a solution for decoding a multistring received from an API call. For example, the SCardListReaders() function returns a multistring of PC/SC reader names. I declared this as:

```
[DllImport("winscard.dll", CharSet = CharSet.Auto)]
static extern int SCardListReaders(
    IntPtr context,
    string groups,
    char[] readers,
    ref uint readersLen
    ); 
```

Note that the readers parameter, which returns the multistring, is declared as char[]. The return value is easily parsed and converted into a collection of strings:

```
static string[] MultiStringToArray(
    char[] multistring
    )
{
    List<string> stringList = new List<string>();
    int i = 0;
    while (i < multistring.Length)
    {
        int j = i;
        if (multistring[j++] == '\0') break;
        while (j < multistring.Length)
        {
            if (multistring[j++] == '\0')
            {
                stringList.Add(new string(multistring, i, j - i - 1));
                i = j;
                break;
            }
        }
    }

    return stringList.ToArray();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-21T21:47:59.040

在 RegistryKey.SetValue() 和 RegistryKey.GetValue() 的 MSDN 文档中，示例只是分别传入或转换为 string[]。这有什么问题吗？

# javascript - Firefox 中的 Javascript window.open 奇怪行为

> ID：268902
> 
> 赞同：3
> 
> 时间：2008-11-06T14:40:16.217
> 
> 标签：javascript, firefox

我有几个链接都应该在同一个窗口或选项卡中打开。为了做到这一点，我给窗口起了一个名字，就像这个示例代码一样：

```
<a href="#" onClick='window.open("http://somesite.com", "mywindow", "");'>link 1</a>
<a href="#" onClick='window.open("http://someothersite.com", "mywindow", "");'>link 2</a> 
```

这在 Internet Explorer 中工作正常，但 Firefox 总是打开一个新的选项卡/窗口。有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-06T18:20:51.437

实际上，由[gabriel1836](https://stackoverflow.com/questions/268902/javascript-windowopen-strange-behavior-in-firefox#268951)链接到的 W3Schools 文档只是一个非常简短的功能摘要。

而且奇怪的是，mozilla 自己的开发者引用了*CONTRADITCS*这个逻辑。

[MDC / DOM / Window.open](https://developer.mozilla.org/En/DOM/Window.open)

> ```
> var WindowObjectReference = window.open(strUrl, 
>               strWindowName [, strWindowFeatures]); 
> ```
> 
> 如果名称为 **strWindowName**的窗口已存在，则不会打开新窗口，而是将 **strUrl**加载到现有窗口中。在这种情况下，该方法的返回值是现有窗口并且**strWindowFeatures**被忽略。为**strUrl**提供一个空字符串 是一种通过名称获取对打开窗口的引用而不更改窗口位置的方法。如果你想在每次调用 **window.open()**时打开一个新窗口，你应该使用 strWindowName 的特殊 **值****_blank**。

 **但是，该页面还指出，可以安装许多扩展来改变这种行为。

因此，要么 mozilla 为针对他们自己浏览器的人们提供的文档是**错误**的，要么你的测试系统有些奇怪:)

此外，您当前的 A-Href 符号对网络不利，并且会激怒用户。

```
 <a href="http://google.com"  
     onclick="window.open( this.href, 'windowName' ); return false" >
     Text
  </a> 
```

是一种更好的方法。

许多人会本能地“中键单击”他们想要在新标签中手动打开的链接，并且将唯一的href 设为“#”会激怒他们以堕落。

"#" 技巧是一种多余且有些糟糕的技巧，可以阻止页面进入意外的地方，但这只是因为缺乏对如何使用的理解`onclick`

如果您`**FALSE**`从单击事件返回，它将取消链接默认操作（默认操作正在导航**当前**页面）

比这种表示法更好的是使用非侵入式 javascript，如下所示：

```
 <a href="google.com" rel="external" >Text</a> 
```

然后

```
 <script type="text/javascript">
 jQuery(function($){ 
        $("a[rel*=external]").click(function(){ 
            window.open(this.href, 'newWindowName' ); 
            return false; 
        });
 }); 
 </script> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T14:48:19.320

Javascript 中的 window.open() 函数专门用于打开新窗口，请参阅：[w3schools 文档](http://www.w3schools.com/HTMLDOM/met_win_open.asp)。实际上听起来 IE 正在以非标准的方式处理事情（这不足为奇）。

如果您想使用 Javascript 将现有位置重新定位到新页面，您应该查看[location.replace()](http://www.w3schools.com/HTMLDOM/met_loc_replace.asp)函数。

一般来说，我会建议你为 Firefox 开发，然后为 IE 修复。Firefox 不仅提供了更好的开发工具，而且它对 W3C 标准的实现也更加正确。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T15:12:37.960

默认情况下，如果在 window.open 参数上省略尺寸，FF 将使用新选项卡。您需要为新的浏览器窗口添加尺寸。

试试这个：

```
<a href="#" onClick='window.open("http://somesite.com", "mywindow", "width=700", "height=500");'>link 1</a> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-03T19:04:46.010

你为什么不直接使用纯 HTML

`<a href="http://www.google.com" target="my_window_tab_frame_or_iframe">Link</a>`

而不是使用JavaScript？

# .net - 可视化操作中涉及的代码？

> ID：268906
> 
> 赞同：2
> 
> 时间：2008-11-06T14:41:09.007
> 
> 标签：.net, debugging

我试图弄清楚库是如何工作的，并且我希望能够可视化响应用户输入（例如按键或鼠标单击）执行哪些方法和代码行。有没有办法在.NET中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T14:52:49.843

微软有一个很棒的免费工具，叫做[Pex](http://research.microsoft.com/Pex/)。安装后，您可以右键单击一个方法并选择“运行 Pex 探索”。它将分析代码并向您显示输入以触及方法的每个部分。

有关详细信息，请参阅[Pex CodeDigger](http://blogs.msdn.com/nikolait/archive/2008/10/21/sneak-preview-code-digger-the-new-pex-experience.aspx)。这是它的屏幕截图：

[![替代文字](https://i.stack.imgur.com/FIsHp.png)](https://i.stack.imgur.com/FIsHp.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T16:37:32.690

You could use a code coverage tool like [NCover](http://www.ncover.com/) even without any unit testing frameworks. Just run the application through NCover, and check the results.

Edit: you might also want to check out [PartCover](http://sourceforge.net/projects/partcover/), an open source alternative.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T14:47:54.297

如果您能够在 NUnit 测试中执行要分析的操作，则可以使用 NCover 实用程序来可视化代码的哪些部分已执行，哪些未执行。

[http://www.ncover.com/](http://www.ncover.com/)

希望这可以帮助！

亚当

# search - 存储和搜索对象事务的最佳方式是什么？

> ID：268920
> 
> 赞同：3
> 
> 时间：2008-11-06T14:43:12.280
> 
> 标签：search, transactions, oop, storage

我们有一个体面的面向对象的应用程序。每当应用程序中的对象发生更改时，对象更改都会保存回数据库。然而，这已经变得不太理想了。

目前，交易被存储为一个交易和一组交易LI。

事务表具有 who、what、when、why、foreignKey 和 foreignTable 字段。前四个是不言自明的。ForeignKey 和 foreignTable 用于确定哪个对象发生了变化。

TransactionLI 具有时间戳、密钥、val、oldVal 和 transactionID。这基本上是一个键/值/旧值存储系统。

问题是这两个表用于应用程序中的每个对象，所以它们现在是相当大的表。将它们用于任何事情都很慢。索引只有这么多帮助。

所以我们正在考虑其他方法来做这样的事情。到目前为止我们已经考虑过的事情： - 按时间戳之类的方式对这些表进行分片。- 对两张表进行非规范化并将它们合并为一张。- 以上两者的结合。- 在更改后序列化每个对象并将其存储在颠覆中。- 可能是别的什么，但我现在想不起来。

整个问题是我们希望有一些机制来正确存储和搜索事务数据。是的，您可以强制将其输入关系数据库，但实际上，它是事务数据，应该相应地存储。

其他人都在做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T19:13:23.140

我们采取了以下方法：-

1.  所有对象都被序列化（使用标准的 XMLSeriliser），但我们用序列化属性修饰了我们的类，这样生成的 XML 就会小得多（例如，将元素存储为属性并在字段名称上删除元音）。如有必要，可以通过压缩 XML 来更进一步。

2.  通过 SQL 视图访问对象存储库。该视图前面有许多结构相同但表名附加了 GUID 的表。当前一个表达到临界质量（预定的行数）时，将生成一个新表

3.  我们每晚运行一个归档例程，生成新表并相应地修改视图，以便调用应用程序看不到任何差异。

4.  最后，作为通宵例行程序的一部分，我们将不再需要的任何旧对象实例归档到磁盘（然后是磁带）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:04:54.343

我从来没有为这类问题找到一个很好的解决方案。您可以尝试的一些事情是您的数据库是否支持分区（或者即使它不支持您自己也可以实现相同的概念），但是按对象类型对此日志表进行分区，然后您可以按日期/时间或您的进一步分区对象 ID（如果您的 ID 是数字，则可以很好地工作，不确定 guid 将如何分区）。

这将有助于保持表的大小，并将所有相关事务保留到对象的单个实例本身。

您可以探索的一个想法是，您可以将数据存储为 blob（文本或二进制），而不是将每个字段存储在名称值对表中。例如，将对象序列化为 Xml 并将其存储在字段中。

这样做的缺点是，当您的对象发生变化时，您必须考虑如果您使用 Xml，这将如何影响所有历史数据，那么有更新历史 xml 结构的简单方法，如果您使用二进制有一些方法，但您必须更加清醒的努力。

我在存储一个相当复杂的对象模型方面取得了巨大的成功，该模型具有大量的相互关系作为 blob（.net 中的 xml 序列化程序没有处理对象之间的关系）。我可以很容易地看到自己存储二进制数据。将其存储为二进制数据的一个巨大缺点是，如果您使用现代数据库（如 MSSQL）可以访问数据，则必须使用 Xml 将其从数据库中取出。

最后一种方法是拆分这两种模式，您可以定义一个差异模式（我假设一次更改一个以上的属性），例如想象存储这个 xml：

```
<objectDiff>
<field name="firstName" newValue="Josh" oldValue="joshua"/>
<field name="lastName" newValue="Box" oldValue="boxer"/>
</objectDiff> 
```

这将有助于减少行数，如果您使用 MSSQL，您可以定义 XML 模式并获得一些围绕对象的丰富查询能力。您仍然可以对表进行分区。

乔什

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T15:47:12.493

根据您的特定应用程序的特性，另一种方法是将实体本身的*修订*保留在各自的表中，以及每个修订的人员、内容、原因和时间。who、what 和 when 仍然可以是外键。

尽管我会非常小心地使用这种方法，因为这仅适用于每个实体/实体类型的更改量相对较小的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T10:37:29.907

如果查询数据很重要，如果您拥有 SQL Server 企业版，我将在 SQL Server 2005 及更高版本中使用真正的分区。我们有数百万行按年分区到当月的每一天 - 您可以根据应用程序的需求进行细化，最多可使用 1000 个分区。

或者，如果您使用的是 SQL 2008，您可以查看过滤索引。

这些解决方案使您能够保留您拥有的简化结构，同时提供查询该数据所需的性能。

显然应该考虑拆分/归档旧的更改。

# repeater - 模型视图演示器和中继器

> ID：268923
> 
> 赞同：1
> 
> 时间：2008-11-06T14:43:47.210
> 
> 标签：repeater, mvp, supervisingcontroller

我正在使用监督控制器模式（模型视图演示器）构建一个应用程序，但我遇到了困难。在我的页面中，我有一个转发器控件，它将显示我传递给它的集合的每个项目。中继器项目包含 2 个下拉列表，允许用户选择特定值。当我单击下一个按钮时，我希望控制器检索这些值。

我怎么能以干净的方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-20T09:04:58.197

您还可以为下拉菜单制作一个“小部件”界面。我将为您提供一个 TextBox 小部件的一些工作代码的简单示例，以便您了解。

```
public interface ITextWidget
{
    event EventHandler TextChanged;
    string Text { get; set; }
}

public abstract class TextWidget<T> : ITextWidget
{

    protected T _wrappedWidget { get; set; }
    public event EventHandler TextChanged;

    protected void InvokeTextChanged(object sender, EventArgs e)
    {
        var textChanged = TextChanged;
        if (textChanged != null) textChanged(this, e);
    }

    public abstract string Text { get; set; }
} 
```

请注意，到目前为止，一切都与技术无关。现在这是一个 Win Forms TextBox 的实现：

```
public class TextBoxWidget : TextWidget<TextBox>
{

    public TextBoxWidget(TextBox textBox)
    {
        textBox.TextChanged += InvokeTextChanged;
        _wrappedWidget = textBox;
    }

    public override string Text
    {
        get { return _wrappedWidget.Text; }
        set { _wrappedWidget.Text = value; }
    }
} 
```

这在 Form 本身中被实例化，返回到 MVP 也是 IViewWhatever：

```
public partial class ProjectPickerForm : Form, IProjectPickerView
{

    private IProjectPickerPresenter _presenter;
    public void InitializePresenter(IProjectPickerPresenter presenter) {
        _presenter = presenter;
        _presenter.InitializeWidgets(
            ...
            new TextBoxWidget(txtDescription));
    }
            ...
} 
```

在演示者中：

```
public class ProjectPickerPresenter : IProjectPickerPresenter
{
    ...
    public void InitializeWidgets(ITextWidget descriptionFilter) {

        Check.RequireNotNull<ITextWidget>(descriptionFilter, "descriptionFilter");
        DescriptionFilter = descriptionFilter;
        DescriptionFilter.Text = string.Empty;
        DescriptionFilter.TextChanged += OnDescriptionTextChanged;

    }
    ...

    public void OnDescriptionTextChanged(object sender, EventArgs e) {
        FilterService.DescriptionFilterValue = DescriptionFilter.Text;
    } 
```

它看起来比设置时更糟糕，因为一旦你有了这个想法，大部分工作都是相当机械的。干净的部分是演示者可以获取（和设置）它在小部件上需要的任何信息，而无需知道或关心实际实现的小部件是什么。它还可以根据需要与其他相同类型的小部件（您最终构建它们的库）和其他 UI 技术（一旦您拥有接口/基类，另一种技术中的实现）重用琐碎的）。由于您拥有接口，因此使用模拟对象进行测试也很容易。而且您的 UI 现在几乎对所有与 UI 相关的任务一无所知。缺点是每个小部件都有一堆类，并且需要一点学习曲线才能适应它。

对于您的下拉菜单，您可能只需要 SelectedIndexChanged 类型的事件，您可以用它来替换这个示例 TextChanged 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:13:30.363

当控制器视图交互变得过于复杂时，我通常将它们分成子控制器和子视图。

您可以让转发器中的项目成为具有自己的视图和控制器的用户控件。然后，您的主视图可以有一个子视图（用户控件）列表，这些子视图（用户控件）具有由主控制器维护的自己的控制器。

当用户单击下一步时，您的主控制器可以向所有子控制器发出信号，以从他们的视图中刷新他们的项目。

# java - 在 Java 中，如何从派生类中的覆盖方法调用基类的方法？

> ID：268929
> 
> 赞同：146
> 
> 时间：2008-11-06T14:45:08.593
> 
> 标签：java, inheritance, methods, polymorphism

我有两个Java类：B，它扩展了另一个类A，如下：

```
class A {
    public void myMethod() { /* ... */ }
}

class B extends A {
    public void myMethod() { /* Another code */ }
} 
```

我想调用`A.myMethod()`from `B.myMethod()`。我来自[C++ 世界](https://stackoverflow.com/questions/357307/how-to-call-a-parent-class-function-from-derived-class-function)，我不知道如何用 Java 做这个基本的事情。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2008-11-06T14:46:28.950

您要查找的关键字是`super`. 例如，请参阅[本指南](http://java.sun.com/docs/books/tutorial/java/IandI/super.html)。

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2008-11-06T14:46:42.227

只需使用 super 调用它。

```
public void myMethod()
{
    // B stuff
    super.myMethod();
    // B stuff
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-11-06T14:47:14.517

`super.MyMethod()`应该`MyMethod()`在`class B`. 所以应该如下

```
class A {
    public void myMethod() { /* ... */ }
}

class B extends A {
    public void myMethod() { 
        super.MyMethod();
        /* Another code */ 
    }
} 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-11-15T10:23:32.453

答案如下：

```
super.Mymethod();
super();                // calls base class Superclass constructor.
super(parameter list);          // calls base class parameterized constructor.
super.method();         // calls base class method. 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-06T14:46:07.703

调用 super.myMethod();

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-04-16T14:31:06.453

我很确定您可以使用 Java 反射机制来做到这一点。它不像使用 super 那样简单，但它给你更多的力量。

```
class A
{
    public void myMethod()
    { /* ... */ }
}

class B extends A
{
    public void myMethod()
    {
        super.myMethod(); // calling parent method
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-06T14:46:44.970

使用[super](http://java.sun.com/docs/books/tutorial/java/IandI/super.html)关键字。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-09-15T08:32:04.963

```
super.baseMethod(params); 
```

**使用super**关键字调用基本方法并传递相应的参数。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-12-21T10:10:28.413

```
class test
{
    void message()
    {
        System.out.println("super class");
    }
}

class demo extends test
{
    int z;
    demo(int y)
    {
        super.message();
        z=y;
        System.out.println("re:"+z);
    }
}
class free{
    public static void main(String ar[]){
        demo d=new demo(6);
    }
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-05-17T15:16:29.467

看，这里你覆盖了基类的方法之一，因此如果你想从继承类调用基类方法，那么你必须在继承类的同一方法中使用***super***关键字。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-12-21T10:01:51.917

```
// Using super keyword access parent class variable
class test {
    int is,xs;

    test(int i,int x) {
        is=i;
        xs=x;
        System.out.println("super class:");
    }
}

class demo extends test {
    int z;

    demo(int i,int x,int y) {
        super(i,x);
        z=y;
        System.out.println("re:"+is);
        System.out.println("re:"+xs);
        System.out.println("re:"+z);
    }
}

class free{
    public static void main(String ar[]){
        demo d=new demo(4,5,6);
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-04-27T10:33:43.387

如果您使用这些方法进行初始化，则使用 A 类的构造函数并在 B 类的构造函数中传递 super 关键字。

或者，如果您想从子类方法调用超类的方法，则必须在子类方法中使用 super 关键字，例如： super.myMethod();

# python - 如何在 Django 中模拟邮件列表？

> ID：268930
> 
> 赞同：3
> 
> 时间：2008-11-06T14:45:37.127
> 
> 标签：python, django, mailing-list

我正在进行一个项目，该项目试图在 Django 中编写相当于邮件列表应用程序的内容，我们遇到了几个问题/问题。

到目前为止，我们的代码没有设置各种 List 标头，并将 To 标头重新设置为我们将其发送给的人，而不是列表地址。

现在，我们可以解决所有这些繁琐的小细节，但我想知道是否有人有任何代码已经完成了我们可以借鉴的这种事情，这样我们就不必经历所有的试验——和错误我们自己。向我们展示我们应该发送什么的 RFC 的特定部分也很有用。

谢谢，
布莱克。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-08-08T16:47:09.823

怎么样[http://labs.freehackers.org/projects/colibri/wiki](http://labs.freehackers.org/projects/colibri/wiki) 它似乎做你想做的事：一个带有 django 前端的邮件列表管理器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:42:00.823

你看过[majordomo](http://www.greatcircle.com/majordomo/)或[mailman](http://www.gnu.org/software/mailman/index.html)吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:42:10.060

[RFC 2919](http://www.apps.ietf.org/rfc/rfc2919.html)对此有一些信息和更多参考。

# xaml - Windows 工作流 Xaml 词汇规范在哪里？

> ID：268955
> 
> 赞同：0
> 
> 时间：2008-11-06T14:48:47.730
> 
> 标签：xaml, workflow

我已经能够在线找到*Xaml 对象映射规范*、*WPF Xaml 词汇规范*和*Silverlight Xaml 词汇规范*文档，但没有适用于 Windows 工作流的*WF Xaml 词汇规范*文档。我希望能够在不使用 Visual Studio IDE 的情况下指定工作流。

有谁知道这个规范是否存在，如果存在，在哪里可以找到它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T08:43:37.453

WF 词汇规范尚未发布。

所有其他与 Xaml 相关的规范都可以在这里找到：

[http://www.microsoft.com/en-us/download/details.aspx?id=19600](http://www.microsoft.com/en-us/download/details.aspx?id=19600)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-01T07:18:35.843

[xps 规格](http://www.microsoft.com/whdc/xps/xpsspec.mspx)

可能会或可能不会与 ecma 工作保持同步

[XAML 对象规范](http://download.microsoft.com/download/0/A/6/0A6F7755-9AF5-448B-907D-13985ACCF53E/[MS-XAML].pdf)

[WPF XAML 规范 2006](http://download.microsoft.com/download/0/A/6/0A6F7755-9AF5-448B-907D-13985ACCF53E/[MS-WPFXV].pdf)

[Silverlight xaml 规范](http://download.microsoft.com/download/0/A/6/0A6F7755-9AF5-448B-907D-13985ACCF53E/[MS-SLXV].pdf)

到目前为止，还没有 WF 规范。

道格拉斯

# c# - 如何在 ComboBox 中使用包含 Path 标签的自定义项模板（不会导致超出范围异常）

> ID：268957
> 
> 赞同：0
> 
> 时间：2008-11-06T14:49:37.557
> 
> 标签：c#, .net, silverlight, data-binding, silverlight-2.0

我有一个包含以下 DataTemplate 的组合框：

```
<DataTemplate x:Key="ComboBoxDataTemplate">
            <StackPanel>
                <TextBlock Text="{Binding Path='Name'}"/>
                <Path Data="{Binding Path='PathGeometry'}" Width="64" Height="64" Stroke="Black" Stretch="Fill" StrokeThickness="1"/>
            </StackPanel>
        </DataTemplate> 
```

PathGeometry 很简单`0,1 0,0.5 0.5,0 0,1`（一条简单的曲线）。当我在组合框中选择项目时，整个 silverlight 应用程序变为白色。抛出一个异常“值超出范围”，我处理它，但之后它变成白色。

为什么会抛出异常？如果我从 Path 标签中删除 {Binding} 并定义我自己的，它工作正常。出于某种原因，这只是数据绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T15:29:55.900

我还没有完全找到“答案”，但我找到了解决方法。如果您将属性更改为使用同样有效的字符串（使用路径标记语法），而不是构建 PathGeometry 类型的属性。

# asp.net - 将 VB.NET 中的数据绑定从 Winforms 迁移到 ASP.NET 2.0 时出现问题

> ID：268961
> 
> 赞同：3
> 
> 时间：2008-11-06T14:50:53.747
> 
> 标签：asp.net, data-binding

而这本该如此简单……

我有现有的业务和数据访问层来处理相关数据的检索和更新。这些适用于现有`Winforms`应用程序 ( `.Net V2.0`)

现在，在尝试编写一个`web-based UI`新`asp.net`的`1.1`. 具体来说，我无法将文本框数据绑定到业务对象。哦，当然有，`ObjectDataSource`但是想知道如何对`CRUD`数据进行操作。

我正在寻找的是类似于`classic`绑定对象的东西，因此在我的代码中，它就像检索对象并进行刷新一样简单。数据组件看起来`FormView`很`DetailsView`一般，看起来很荒谬。现有应用程序将具有选项卡式对话框、按面板分组的文本框等。

最重要的是，我有一个使用母版页的指令，除非一个控件导致它，否则我似乎无法扩展内容部分。我不能只`below`在底部放置一个文本框`Content1`并让它重新调整内容部分的大小 - 这给我的结果与我之前在没有页脚时发布的问题相同`pushed down`- 相对位置解决了这个问题，但没有似乎通过在该区域放置小文本框来解决它。

我想要的很简单。就像是：

```
bindingobject.datasource = businessdataobject
bindingobject.refresh 
```

...并使用新值刷新文本框。同样，`businessdataobject`在用户输入新数据时更新属性。

通过在. _ `GridView`_ _`grdRequests.DataSource = lstRequests``asp:BoundField``<Columns>``GridView`

我在这里向风车倾斜吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T23:54:08.160

为什么不试试模式与实践（1） [ObjectContainerDataSource ？](http://www.codeplex.com/websf/Wiki/View.aspx?title=Object%20Container%20DataSource)它是 Web 客户端软件工厂的一部分，可[在此处](http://www.codeplex.com/websf)获得 (2) 。

我已经使用了几次，它为您提供了 ODS 风格的设计体验（设计时绑定），但可以完全控制您提供数据源的方式。您只需实现您感兴趣的事件（例如选择事件）。它还具有服务器端分页和排序支持，因此对 GridViews 非常有用。

对于您想要实现的目标，它可能不够灵活，但如果只是作为 PoC，它可能值得一试。

[ (1) [http://www.codeplex.com/websf/Wiki/View.aspx?title=Object%20Container%20DataSource](http://www.codeplex.com/websf/Wiki/View.aspx?title=Object%20Container%20DataSource) ] [ (2) [http://www.codeplex.com/websf](http://www.codeplex.com/websf) ]

# .net - 客户端使用 WCF 将数据上传到中央服务器，如何验证数据是否已上传？

> ID：268968
> 
> 赞同：0
> 
> 时间：2008-11-06T14:52:56.083
> 
> 标签：.net, wcf, client-server, checksum, verification

少于 10 台客户端计算机，每台都有自己的安装程序，必须将数据上传到中央服务器。

客户端数据库如下所示：

tblSales - rowGuid - randomNumber

中央服务器数据库：

*   行指南
*   随机数
*   插入日期

我计划使用 WCF 将文件发送到中央服务器。

**如何验证行已插入服务器？我有哪些验证选项？**

我可以返回插入的行数并将其与发送的行数进行比较，但是还有其他更强大的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T18:47:01.320

如果使用 WsHttpBinding 之类的绑定，您还可以启用可靠消息传递，这将确保消息本身的可靠性（如果这是一个问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:06:50.843

使用 WCF，您将基本上通过代理调用函数。只需让该函数返回一个 bool true 表示成功或 false 表示失败。

```
bool Success;
Success = MyWCFService.InsertRecord(MyNewRecord); 
```

# flash - 使用 Flash 获取目录列表

> ID：268970
> 
> 赞同：0
> 
> 时间：2008-11-06T14:53:57.437
> 
> 标签：flash, actionscript-3

在 Flash 中，您可以打开用户计算机上的文件。在 flash 9 中，您可以上传和下载文件，在 flash 10 中，您可以访问文件的内容。

这是安全的，因为用户必须从文件对话框中选择文件以允许对其进行闪存访问。

我想在我的应用程序中做的是获取目录中文件/子目录的目录列表。这与上传用户选择的文件以列出用户选择的目录的内容并没有什么不同，所以我看不到任何安全隐患。我不需要访问文件，只需列出它们，

但是flash中似乎没有办法做到这一点？我是对的还是我错过了什么？

如有必要，我总是可以使用签名的 java 小程序，但 flash 似乎更适合我的特定应用程序，所以我认为值得提出这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T15:00:08.580

这是不安全的，除非你要求用户使用文件夹浏览对话框指向想要的目录，如果我们保持上述逻辑......
即使是他们，用户也可能无意中提供比他们应该使用的更多信息。
就像他们将所有 Documents and Settings 文件夹打开到 P2P 网络时一样...... :-)

不安全，因为这样人们可以获得有趣的文件名，也许会探索浏览器缓存等。

# wpf - 如果使用 MVC 架构，可以将 winform 应用程序切换到 WPF 应用程序吗？

> ID：268976
> 
> 赞同：0
> 
> 时间：2008-11-06T14:55:42.287
> 
> 标签：wpf, asp.net-mvc, winforms

如果我们使用 MVC 架构开发 winform 应用程序，那么以后切换到 WPF 应该不会太难，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T18:43:28.583

设计良好的 WPF 应用程序大量利用数据绑定。因此，您可以考虑使用 ObservableCollection 等类，并在设计模型时实现 IPropertyNotify。

查看 Microsoft 产品组（例如 Blend）提倡的 MV-VM 模式的一些参考资料以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T08:01:51.120

似乎在 Codeplex 中有一个用于开发 winforms 应用程序的 MVC winform open souce fmwk 该框架是 koossery.MVCwin，位于[http://koosserymvcwin.codeplex.com上的 Codeplex](http://koosserymvcwin.codeplex.com)

# c# - .net SqlConnection 即使在使用 {} 中也不会关闭

> ID：268982
> 
> 赞同：16
> 
> 时间：2008-11-06T14:57:32.813
> 
> 标签：c#, .net, linq-to-sql, sqlconnection

请帮忙！

*背景资料*

我有一个访问 SQL Server 2005 数据库的 WPF 应用程序。数据库在运行应用程序的机器上本地运行。

在我使用 Linq DataContext 的任何地方，我都使用 using { } 语句，并传入一个函数的结果，该函数返回一个已打开的 SqlConnection 对象，并在返回 DataContext 构造函数之前使用它执行了一个 SqlCommand。即

```
// In the application code
using (DataContext db = new DataContext(GetConnection()))
{
    ... Code 
} 
```

getConnection 看起来像这样（我已经从函数中删除了“绒毛”以使其更具可读性，但没有缺少其他功能）。

```
// Function which gets an opened connection which is given back to the DataContext constructor
public static System.Data.SqlClient.SqlConnection GetConnection()
{
   System.Data.SqlClient.SqlConnection Conn = new System.Data.SqlClient.SqlConnection(/* The connection string */);

    if ( Conn != null )
    {
        try
        {
            Conn.Open();
        }
        catch (System.Data.SqlClient.SqlException SDSCSEx)
        {
             /* Error Handling */
        }

        using (System.Data.SqlClient.SqlCommand SetCmd = new System.Data.SqlClient.SqlCommand())
        {
            SetCmd.Connection = Conn;
            SetCmd.CommandType = System.Data.CommandType.Text;

            string CurrentUserID = System.String.Empty;
            SetCmd.CommandText = "DECLARE @B VARBINARY(36); SET @B = CAST('" + CurrentUserID + "' AS VARBINARY(36)); SET CONTEXT_INFO @B";

            try
            {
                SetCmd.ExecuteNonQuery();
            }
            catch (System.Exception)
            {
                /* Error Handling */
            }
        }

        return Conn;
    } 
```

**我认为作为 WPF 的应用程序与我遇到的问题没有任何关系。**

*我遇到的问题*

尽管 SqlConnection 与 Sql Server Management Studio 中的 DataContext 一起被处理，但我仍然可以看到大量打开的连接：

```
status : 'Sleeping' 
command : 'AWAITING COMMAND' 
last SQL Transact Command Batch : DECLARE @B VARBINARY(36); SET @B = CAST('GUID' AS VARBINARY(36)); SET CONTEXT_INFO @B 
```

最终连接池被用完，应用程序无法继续。

所以我只能得出结论，以某种方式运行 SQLCommand 来设置 Context_Info 意味着当 DataContext 被释放时连接不会被释放。

当他们使用的 DataContext 被处置时，任何人都可以发现任何明显的东西会阻止连接被关闭和处置吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-06T15:01:45.020

来自[MSDN](http://msdn.microsoft.com/en-us/library/bb292288.aspx) ( `DataContext Constructor (IDbConnection)`)：

> 如果您提供打开的连接，DataContext 将不会关闭它。因此，除非您有充分的理由这样做，否则不要使用打开的连接实例化 DataContext。

所以基本上，看起来你的连接正在等待 GC 在它们被释放之前完成它们。如果您有很多执行此操作的代码，一种方法可能是覆盖`Dispose()`数据上下文的部分类，并关闭连接 - 只需确保记录数据上下文假定连接的所有权！

```
 protected override void Dispose(bool disposing)
    {
        if(disposing && this.Connection != null && this.Connection.State == ConnectionState.Open)
        {
            this.Connection.Close();
            this.Connection.Dispose();
        }
        base.Dispose(disposing);
    } 
```

就个人而言，只要我“使用”连接（允许我执行多个操作），我很乐意给它（常规数据上下文，没有上面的 hack）一个开放的连接 - 即

```
using(var conn = GetConnection())
{
   // snip: some stuff involving conn

   using(var ctx = new FooContext(conn))
   {
       // snip: some stuff involving ctx
   }

   // snip: some more stuff involving conn
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T15:02:17.047

`SqlProvider`LINQ 使用的仅`DataContext`关闭 SQL 连接（通过`SqlConnectionManager.DisposeConnection`）如果它是打开它的连接。如果你给构造函数一个已经打开的`SqlConnection`对象`DataContext`，它不会为你关闭它。因此，你应该写：

```
using (SqlConnection conn = GetConnection())
using (DataContext db = new DataContext(conn))
{
    ... Code 
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T06:45:26.200

我使用实体框架遇到了同样的问题。我的`ObjectContext`被​​包裹在一个`using`街区。

调用时建立了连接`SaveChanges()`，但在`using`语句超出范围后，我注意到 SQL Management Studio 仍然有一个`"AWAITING COMMAND"`用于 .NET SQL 客户端的连接。看起来这与默认打开连接池的 ADO.NET 提供程序的行为有关。

来自[MSDN上的“](http://msdn.microsoft.com/en-us/library/8xx3tyca(VS.80).aspx)*使用 SQL Server 连接池*” （强调我的）：

> 连接池减少了需要打开新连接的次数。pooler 维护物理连接的所有权。它通过为每个给定的连接配置保持一组活动连接来管理连接。每当用户调用`Open`连接时，池化器都会查看池中是否有可用的连接。如果池连接可用，则将其返回给调用者，而不是打开新连接。**当应用程序调用`Close`连接时，池化程序将其返回到池中的活动连接集，而不是实际关闭它。一旦连接返回到池中，就可以在下一次`Open`调用时重用它。**

[`ClearAllPools`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearallpools(VS.80).aspx)如果需要，[`ClearPool`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearpool(VS.80).aspx)显式关闭所有池连接似乎也很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T15:02:41.133

我认为该连接虽然不再被引用，但正在等待 GC 完全处理它。

解决方案：

创建您自己的 DataContext 类，该类派生自自动生成的类。（重命名基本代码，这样您就不必更改任何其他代码）。

在您派生的 DataContext - 添加一个 Dispose() 函数。在那 - 处理内部连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T15:34:26.390

嗯，谢谢大佬的帮助，现在已经解决了。。

本质上，我采用了上面大多数答案的元素并如上所述实现了 DataContext 构造函数（我已经重载了构造函数，所以这不是一个大的变化）。

```
// Variable for storing the connection passed to the constructor
private System.Data.SqlClient.SqlConnection _Connection;

public DataContext(System.Data.SqlClient.SqlConnection Connection) : base(Connection)
{
    // Only set the reference if the connection is Valid and Open during construction
    if (Connection != null)
    {
        if (Connection.State == System.Data.ConnectionState.Open)
        {
            _Connection = Connection;                    
        }
    }           
}

protected override void Dispose(bool disposing)
{        
    // Only try closing the connection if it was opened during construction    
    if (_Connection!= null)
    {
        _Connection.Close();
        _Connection.Dispose();
    }

    base.Dispose(disposing);
} 
```

这样做而不是上面的一些建议的原因是`this.Connection`在 dispose 方法中访问会引发**ObjectDisposedException**。

上面的工作和我希望的一样好！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T15:02:03.490

[正如MSDN](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.close.aspx)指出的那样`Dispose`，应该关闭连接：

> 如果 SqlConnection 超出范围，它不会被关闭。因此，您必须通过调用 Close 或 Dispose 显式关闭连接。Close 和 Dispose 在功能上是等效的。如果连接池值 Pooling 设置为 true 或 yes，则将底层连接返回到连接池。另一方面，如果 Pooling 设置为 false 或 no，则与服务器的底层连接将关闭。

我的猜测是您的问题与`GetContext()`.

# process - 工程师问责制和代码审查流程

> ID：268990
> 
> 赞同：3
> 
> 时间：2008-11-06T15:01:01.480
> 
> 标签：process, tdd, agile, scrum

在您的“企业”工作环境中，工程师如何对执行代码检查和单元测试负责？您遵循哪些流程（正式方法或自定义流程）来确保软件质量？您是否尝试过为可交付成果实施开发人员“签收”表？

提前致谢！

更新：我忘了提到我们正在使用 Code Collaborator 来执行我们的检查。问题是让人们“得到它”并接受在核心人群之外做这些事情。正如 stalbot 在下面指出的那样，这是一种文化变革，但问题变成了，您如何改变您的文化以促进质量计划，例如审查/单元测试？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T16:15:32.950

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T21:31:41.300

**如果您想确保在签入*之前***检查每个更改列表，那么您可以让您的源代码控制工具拒绝未经审查的签入。例如，触发器可以拒绝签入注释中没有“CodeReview：”的签入。尽管人们仍然可以撒谎，但他们也可以被追究责任。

**如果您想确保在签入*后***对每个更改列表进行审查，那么您可以查看 Code Collaborator 是否可以很好地与您的源代码控制系统配合使用，并在每次签入后自动执行审查任务（推送或拉取；任何工作）。之后，使用 Code Collaborator 拥有的任何“礼貌的烦恼”功能，以确保真正*完成*审查。

**如果您希望人们*只查看一些*签到，而不是*所有*签到，**那么祝您好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T15:08:16.160

我们有一个非常酷的设置。编码人员应该在签入之前测试他们的代码，以确保它不会破坏构建，并在有意义但不需要高覆盖率的地方编写测试。

复杂的方法预计会被评论。

在阶段结束时，整个团队都会审查代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T00:30:57.467

结对编程。工作项的必填字段是合作者，即您与工作配对的人

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T15:07:08.660

我们严重依赖 ITIL 概念。虽然我们不需要 ITIL 提供的全面 ITSM，但我们已经实施了借鉴 ITIL 中一些最佳实践的流程，特别是在变更管理和发布管理领域。

代码审查是我们 RM 策略的一部分。当更改或新代码通过我们的 RM 流程时，很多人都会关注它。最终，发布经理发出批准或返工的呼吁，所有这些都记录在案（我们使用 TFS 和 SharePoint）。正式的代码审查由发布经理和他选择的技术团队进行。发布候选的主要开发人员负责遵守标准、功能和验证已完成的测试计划。如果未达到质量标准，则拒绝交付成果并更新项目进度表以反映返工。

是的，这一切都很沉重。我在政府工作，我们有复杂的法律要遵守，特别是在税收、ADA 合规等领域。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T21:11:48.890

我们使用三个基本规则

1）当单元测试不存在时，开发人员负责修复代码中的错误。在有测试的情况下，打破测试的人负责修复它。

2) 代码审查。有一些代码审查气味是一个很好的警告信号，过度防御和责备重定向是最常见的两种。

3) 没有电子邮件代码、JAR 或配置文件。一切都在 scm 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-16T10:44:58.917

创造文化首先尝试定义你的标准和价值观，最重要的是让他们知道。

然后雇用相信他们或能够适应他们的人。不要雇用与您的公司价值观完全没有任何联系的人。

确保那些尊重这些价值观并表现出改进的人得到“奖励”和“适当”的认可并被视为榜样。不要忘记，对许多人来说，钱并不全是。

不要犹豫，对那些不履行职责但确保他们了解他们的人采取适当的措施。并让他们为自己的行为负责。让人们习惯于承担任何新的责任。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-22T07:16:02.857

改变文化是一件大事。仍然有一些方法可以改变。

1.  提高对代码审查和代码审查工具重要性的认识。可以使用培训课程来完成。

2.  激励人们：对代码审查给予一些奖励。

3.  过程中的变化：确保应该正确地进行代码审查。它可以使用清单和发布过程的一部分来完成。

4.  不要试图完全改变。慢慢引入更新的变化。创建小组来观察和讨论代码审查过程中的变化。

5.  提供解决方案而不是制造问题。过程不应该是开销。它会自动出现。为人们与流程相关的问题提供解决方案。******~~***********