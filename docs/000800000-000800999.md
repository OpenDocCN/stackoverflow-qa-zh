# StackOverflow 问答 000800000-000800999

# qt - 用于 GUI 的分析工具

> ID：800001
> 
> 赞同：2
> 
> 时间：2009-04-28T21:56:15.137
> 
> 标签：qt, profiling

我正在尝试分析使用大量动画的 Qt 应用程序。平台是XP。

我对比较运行之间的 CPU 利用率非常感兴趣，以便从高级别的角度了解应用程序的变化如何影响 CPU 使用率。

我尝试过 VTune 和 Quantify。

我似乎无法配置 VTune 来做我想做的事。我能够生成的百分比与总 CPU 使用率不对应。

当我使用 quantify 时，它会生成一个调用图，但它从不显示应用程序，所以我不确定我是否正确设置它。

有人有建议吗？欢迎使用其他工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T14:41:15.137

你用的是什么版本的Qt？如果是 4.5，您是否考虑过新的分析能力`QUnitTest`？将它用于整个应用程序会有点麻烦，但你也许可以让它工作。

# c# - 为什么要列出 .Sort 方法重新排序等于 IComparable 元素？

> ID：800007
> 
> 赞同：28
> 
> 时间：2009-04-28T21:57:21.237
> 
> 标签：c#, .net, sorting, quicksort

我对 List Sort 方法如何处理排序有疑问。给定以下元素：

```
class Element : IComparable<Element>
{
    public int Priority { get; set; }
    public string Description { get; set; }

    public int CompareTo(Element other)
    {
        return Priority.CompareTo(other.Priority);
    }
} 
```

如果我尝试这样排序：

```
List<Element> elements = new List<Element>()
                             {
                                 new Element()
                                     {
                                         Priority = 1,
                                         Description = "First"
                                     },
                                 new Element()
                                     {
                                         Priority = 1,
                                         Description = "Second"
                                     },
                                 new Element()
                                     {
                                         Priority = 2,
                                         Description = "Third"
                                     }
                             };
elements.Sort(); 
```

那么第一个元素就是之前的第二个元素“Second”。或者，换句话说，这个断言失败了：

```
Assert.AreEqual("First", elements[0].Description); 
```

当元素基本相同时，为什么 .NET 会重新排序我的列表？如果比较返回非零值，我希望它只对列表重新排序。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-28T22:03:13.157

从 MSDN 的 List.Sort() 方法的文档中：

> 此方法使用 Array.Sort，它使用 QuickSort 算法。此实现执行不稳定的排序；也就是说，如果两个元素相等，则可能不会保留它们的顺序。相反，稳定排序保留了相等元素的顺序。

这是链接：http: [//msdn.microsoft.com/en-us/library/b0zbh7b6.aspx](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)

从本质上讲，排序按照设计和记录的方式执行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-04T13:31:14.423

这是一个扩展方法 SortStable() `List<T> where T : IComparable<T>`：

```
public static void SortStable<T>(this List<T> list) where T : IComparable<T>
{
    var listStableOrdered = list.OrderBy(x => x, new ComparableComparer<T>()).ToList();
    list.Clear();
    list.AddRange(listStableOrdered);
}

private class ComparableComparer<T> : IComparer<T> where T : IComparable<T>
{
    public int Compare(T x, T y)
    {
        return x.CompareTo(y);
    }
} 
```

测试：

```
[Test]
public void SortStable()
{
    var list = new List<SortItem>
                    {
                        new SortItem{ SortOrder = 1, Name = "Name1"},
                        new SortItem{ SortOrder = 2, Name = "Name2"},
                        new SortItem{ SortOrder = 2, Name = "Name3"},
                    };

    list.SortStable();

    Assert.That(list.ElementAt(0).SortOrder, Is.EqualTo(1));
    Assert.That(list.ElementAt(0).Name, Is.EqualTo("Name1"));
    Assert.That(list.ElementAt(1).SortOrder, Is.EqualTo(2));
    Assert.That(list.ElementAt(1).Name, Is.EqualTo("Name2"));
    Assert.That(list.ElementAt(2).SortOrder, Is.EqualTo(2));
    Assert.That(list.ElementAt(2).Name, Is.EqualTo("Name3"));
}

private class SortItem : IComparable<SortItem>
{
    public int SortOrder { get; set; }
    public string Name { get; set; }

    public int CompareTo(SortItem other)
    {
        return SortOrder.CompareTo(other.SortOrder);
    }
} 
```

在测试方法中，如果你调用 Sort() 方法而不是 SortStable()，你可以看到测试会失败。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T22:02:02.130

你告诉它如何比较事物，它做到了。您不应依赖应用程序中 Sort 的内部实现。这就是为什么它让你覆盖 CompareTo。如果您想要一个辅助排序参数（在本例中为“描述”），请将其编码到您的 CompareTo 中。依靠 Sort 恰好是如何工作的，是在很难找到的 bug 中编写代码的好方法。

您可以为 .NET 找到一个稳定的快速排序或使用[合并排序](http://www.cs.nyu.edu/~vs667/articles/mergesort/)（这已经很稳定）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T22:15:28.057

有关 List.Sort() 不稳定的原因，请参阅其他回复。如果您需要稳定的排序并使用 .NET 3.5，请尝试[Enumerable.OrderBy()](http://msdn.microsoft.com/en-us/library/bb534966.aspx) (LINQ)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T22:13:51.757

您可以通过在结构中添加“索引值”来解决此问题，并在 Priority.CompareTo 返回 0 时将其包含在 CompareTo 方法中。然后您需要在进行排序之前初始化“索引”值。

CompareTo 方法如下所示：

```
public int CompareTo(Element other)
{
    var ret = Priority.CompareTo(other.Priority);
    if (ret == 0)
    {
        ret = Comparer<int>.Default.Compare(Index, other.Index);
    }
    return ret;
} 
```

然后，而不是做`elements.Sort()`，你会做：

```
for(int i = 0; i < elements.Count; ++i)
{
    elements[i].Index = i;
}
elements.Sort(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-04T15:55:51.603

在某些应用程序中，当根据某些标准对项目列表进行排序时，保留比较相等的项目的原始顺序是不必要的。在其他应用中，这是必要的。保留具有匹配键的项目排列的排序方法（称为“稳定排序”通常比不匹配的那些（“不稳定排序”）慢得多，或者它们需要大量的临时存储（并且仍然有点慢). 第一个普及的“标准库”排序例程可能是`qsort()`标准 C 库中包含的函数。该库经常用于对相对于可用内存总量较大的列表进行排序。如果该库需要与要排序的数组中的项目数成正比的临时存储量，则该库的用处将大大降低。

将在 Java 或 .net 等框架下使用的排序方法实际上可以使用比 C qsort() 例程中可接受的更多的临时存储空间。在大多数情况下，与要排序的数组大小相等的临时内存需求不会造成任何特殊问题。尽管如此，由于库提供快速排序实现是传统的，这似乎是 .net 遵循的模式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T22:24:40.857

如果您想基于两个字段而不是一个字段进行排序，您可以这样做：

```
class Element : IComparable<Element>
{
    public int Priority { get; set; }
    public string Description { get; set; }

    public int CompareTo(Element other)
    {
        if (Priority.CompareTo(other.Priority) == 0)
        {
            return Description.CompareTo(other.Description);
        } else {
            return Priority.CompareTo(other.Priority);
        }
    }
} 
```

显然，这不能满足稳定搜索算法的要求；但是，它确实满足您的断言，并允许在相等的情况下控制您的元素顺序。

# .net - 使用 log4net 以及在哪里实现它并与 elmah 一起使用？

> ID：800009
> 
> 赞同：14
> 
> 时间：2009-04-28T21:58:11.700
> 
> 标签：.net, asp.net, logging, log4net, elmah

有没有人有使用 log4net 的经验，我一直在看很棒的 elmah。但我想要更多的控制，即不仅在 asp.net 中而且在 wpf 中使用日志记录。

Anway 我决定看看 log4net。

我有 2 个客户端（wpf 和 asp.net），它们都共享业务逻辑。

我应该在业务逻辑和客户端中引发事件吗？

我假设业务逻辑将使用 app.config / web.config （业务逻辑在另一层 - 一个类项目）

有没有人将 log4net 和 elmah 一起使用，无论如何你可以让他们共享同一个数据库表吗？

log4net 在我看来是终极的日志框架，但 elmah 具有提交所有 SERVER 变量和堆栈跟踪等的优势

或者也许有可能让 log4net 也保存 Stacktrace 并完全替换 elmah？

任何评论都非常感谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-28T22:09:53.420

它们用于两种不同的目的。

Elmah 用于捕获和存储您*没有预料*到的异常。它还提供了一些前端（网页、RSS、电子邮件警报器）来传递异常。

另一方面，Log4net 用于记录您知道可能发生的事件（*包括*由异常引起的错误）（否则您将没有 try / catch 块）。

因此，您应该同时使用两者，而不是其中之一。

要回答您的具体问题，您*可以*让 log4net 记录异常的堆栈跟踪，但通常不应为您记录的每条调试消息记录堆栈跟踪。记录服务器变量和其他特定于 Web 的内容也是可能的，但需要一些您不想做的自定义编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T22:06:18.187

我已经使用 log4net 一段时间了，我主要让我的数据层和业务层完成所有的错误日志记录。但是，如果您的表示层对对象进行了大量的“计算”，那么在此处记录适当的信息也是值得的。

您可以将 log4net 配置为将其设置存储在 .config 文件中，或者存储在其自己的单独配置文件中。单独文件的优点是，如果您需要动态切换日志记录模式，您可以在单独的 .config 文件中进行操作，并且不会让 IIS 触发站点的应用程序刷新。

我还没有使用过 ELMAH，但它看起来确实很不错。我认为更重要的是，它提供了一种轻松插入现有应用程序的方法。但是，log4net 确实提供了一种更简单的方法来获取更详细和更广泛的日志信息，因为您有很多配置选项可供使用。

如果您的应用程序不需要细粒度级别的日志记录，我会选择 ELMAH。如果您想采用更详细的方法，请花时间将 log4net 用于您的应用程序。

那是我的 10 位。

# python - 保持浮点值的相同格式

> ID：800015
> 
> 赞同：1
> 
> 时间：2009-04-28T22:01:29.807
> 
> 标签：python, formatting, floating-point

我有一个使用以下正则表达式读取浮点值的 python 程序

```
 (-?\d+\.\d+) 
```

一旦我使用 float(match.group(1)) 提取值，我就会得到实际的浮点数。但是，我无法区分该数字是 1.2345678 还是 1.234 还是 1.2340000。

我面临的问题是再次打印出浮点值，格式完全相同。一个简单的解决方案是在仍然是字符串时“拆分并计算”浮点值，*例如*在小数点拆分，并计算整数部分长度和小数部分长度，然后将格式化程序创建为

```
print "%"+str(total_len)+"."+str(fractional_len)+"f" % value 
```

但也许您知道达到相同结果的标准方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T22:07:44.080

如果要保持固定精度，请避免使用`float`s 并`Decimal`改用：

```
>>> from decimal import Decimal
>>> d = Decimal('-1.2345')
>>> str(d)
'-1.2345'
>>> float(d)
-1.2344999999999999 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T23:54:10.580

你的方法基本正确。字符串格式化有一个不太常用的`*`运算符，您可以将其用于格式化大小，这里有一些代码：

```
import re

def parse_float(str):
  re_float = re.compile(r'(-?)(\d+)\.(\d+)')
  grps = re_float.search(str)
  sign, decimal, fraction = grps.groups()
  float_val = float('%s%s.%s' % (sign, decimal, fraction))
  total_len = len(grps.group(0))
  print '%*.*f'  % (total_len, len(fraction), float_val)

parse_float('1.2345678')
parse_float('1.234')
parse_float('1.2340000') 
```

它输出

```
1.2345678
1.234
1.2340000 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T22:09:09.333

```
>>> from decimal import Decimal as d
>>> d('1.13200000')
Decimal('1.13200000')
>>> print d('1.13200000')
1.13200000 
```

# sql - 为什么 SQL Server 标量值函数变慢？

> ID：800017
> 
> 赞同：17
> 
> 时间：2009-04-28T22:01:43.377
> 
> 标签：sql, sql-server, tsql, sql-server-2005, sql-function

为什么标量值函数似乎会导致查询在连续使用的次数越多时累积地运行得越慢？

我有这张表是用从第 3 方购买的数据构建的。

我已经删减了一些内容以使这篇文章更短……但只是为了让您了解事物的设置方式。

```
CREATE TABLE [dbo].[GIS_Location](
        [ID] [int] IDENTITY(1,1) NOT NULL, --PK
        [Lat] [int] NOT NULL,
        [Lon] [int] NOT NULL,
        [Postal_Code] [varchar](7) NOT NULL,
        [State] [char](2) NOT NULL,
        [City] [varchar](30) NOT NULL,
        [Country] [char](3) NOT NULL,

CREATE TABLE [dbo].[Address_Location](
    [ID] [int] IDENTITY(1,1) NOT NULL, --PK
    [Address_Type_ID] [int] NULL,
    [Location] [varchar](100) NOT NULL,
    [State] [char](2) NOT NULL,
    [City] [varchar](30) NOT NULL,
    [Postal_Code] [varchar](10) NOT NULL,
    [Postal_Extension] [varchar](10) NULL,
    [Country_Code] [varchar](10) NULL, 
```

然后我有两个查找 LAT 和 LON 的函数。

```
CREATE FUNCTION [dbo].[usf_GIS_GET_LAT]
(
    @City VARCHAR(30),
    @State CHAR(2)
)
RETURNS INT 
WITH EXECUTE AS CALLER
AS
BEGIN
    DECLARE @LAT INT

    SET @LAT = (SELECT TOP 1 LAT FROM GIS_Location WITH(NOLOCK) WHERE [State] = @State AND [City] = @City)

RETURN @LAT
END

CREATE FUNCTION [dbo].[usf_GIS_GET_LON]
(
    @City VARCHAR(30),
    @State CHAR(2)
)
RETURNS INT 
WITH EXECUTE AS CALLER
AS
BEGIN
    DECLARE @LON INT

    SET @LON = (SELECT TOP 1 LON FROM GIS_Location WITH(NOLOCK) WHERE [State] = @State AND [City] = @City)

RETURN @LON
END 
```

当我运行以下...

```
SET STATISTICS TIME ON

SELECT
    dbo.usf_GIS_GET_LAT(City,[State]) AS Lat,
    dbo.usf_GIS_GET_LON(City,[State]) AS Lon
FROM
    Address_Location WITH(NOLOCK)
WHERE
    ID IN (SELECT TOP 100 ID FROM Address_Location WITH(NOLOCK) ORDER BY ID DESC)

SET STATISTICS TIME OFF 
```

100 ~= 8 毫秒，200 ~= 32 毫秒，400 ~= 876 毫秒

--编辑对不起，我应该更清楚。我不想调整上面列出的查询。这只是一个示例，显示执行时间越慢，它处理的记录越多。在现实世界的应用程序中，这些函数用作 where 子句的一部分，以在城市和州周围建立一个半径，以包括该地区的所有记录。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-01T00:53:29.920

在大多数情况下，最好避免引用表的标量值函数，因为（正如其他人所说）它们基本上是每行都需要运行一次的黑盒，并且无法通过查询计划引擎进行优化。因此，即使关联的表有索引，它们也倾向于线性扩展。

您可能需要考虑使用内联表值函数，因为它们是与查询内联评估的，并且可以进行优化。你得到了你想要的封装，但是在选择语句中粘贴表达式的性能。

作为内联的副作用，它们不能包含任何程序代码（没有声明@variable；设置@variable = ..；返回）。但是，它们可以返回多行和多列。

你可以像这样重写你的函数：

```
create function usf_GIS_GET_LAT(
    @City varchar (30),
    @State char (2)
)
returns table
as return (
  select top 1 lat
  from GIS_Location with (nolock) 
  where [State] = @State
    and [City] = @City
);

GO

create function usf_GIS_GET_LON (
    @City varchar (30),
    @State char (2)
)
returns table
as return (
  select top 1 LON
  from GIS_Location with (nolock)
  where [State] = @State
    and [City] = @City
); 
```

使用它们的语法也有些不同：

```
select
    Lat.Lat,
    Lon.Lon
from
    Address_Location with (nolock)
    cross apply dbo.usf_GIS_GET_LAT(City,[State]) AS Lat
    cross apply dbo.usf_GIS_GET_LON(City,[State]) AS Lon
WHERE
    ID IN (SELECT TOP 100 ID FROM Address_Location WITH(NOLOCK) ORDER BY ID DESC) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-29T02:00:38.967

**他们不。**

标量函数中没有错误会导致其性能根据执行标量函数中的行数而呈指数级下降。再次尝试您的测试并查看 SQL 分析器，查看 CPU 和 READS 和 DURATION 列。增加你的测试规模，以包括超过一秒、两秒、五秒的测试。

```
CREATE FUNCTION dbo.slow
(
    @ignore int
)
RETURNS INT 
AS
BEGIN
    DECLARE @slow INT
    SET @slow = (select count(*) from sysobjects a 
        cross join sysobjects b 
        cross join sysobjects c 
        cross join sysobjects d 
        cross join sysobjects e 
        cross join sysobjects f
    where a.id = @ignore) 

    RETURN @slow
END
go
SET STATISTICS TIME ON

select top 1 dbo.slow(id)
from sysobjects
go
select top 5 dbo.slow(id)
from sysobjects
go
select top 10 dbo.slow(id)
from sysobjects
go
select top 20 dbo.slow(id)
from sysobjects
go
select top 40 dbo.slow(id)
from sysobjects

SET STATISTICS TIME OFF 
```

输出

```
SQL Server Execution Times:
   CPU time = 203 ms,  elapsed time = 202 ms.

SQL Server Execution Times:
   CPU time = 889 ms,  elapsed time = 939 ms.

SQL Server Execution Times:
   CPU time = 1748 ms,  elapsed time = 1855 ms.

SQL Server Execution Times:
   CPU time = 3541 ms,  elapsed time = 3696 ms.

SQL Server Execution Times:
   CPU time = 7207 ms,  elapsed time = 7392 ms. 
```

请记住，如果您对结果集中的行运行标量函数，则标量函数将按行执行，而不进行全局优化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T15:26:31.407

您可以将您的功能包装在一个内联 TVF 中，这会更快：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/23/reuse-your-code-with-cross-apply.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/23/reuse-your-code-with-cross-apply.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T22:11:28.987

您为结果集中的每一行调用该函数两次（对 DB 的两次选择命中）。

使您的查询更快地加入 GIS_Location 并跳过以下功能：

```
SELECT
    g.Lat,
    g.Lon
FROM
    Address_Location        l WITH(NOLOCK)
    INNER JOIN GIS_Location g WITH(NOLOCK) WHERE l.State = g.State AND l.City = g.City
WHERE
    ID IN (SELECT TOP 100 ID FROM Address_Location WITH(NOLOCK) ORDER BY ID DESC) 
```

我不确定为什么我只是从问题中复制了 NOLOCK 或疯狂的 where 子句...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T22:18:56.283

简单地说，因为带有用户定义函数的 SQL 表达式比没有它们的 SQL 表达式效率低。执行逻辑无法优化；并且必须为每一行产生函数开销（包括调用协议）。

KMike 的建议很好。WHERE .. IN (SELECT something) 不太可能是一种有效的模式，在这种情况下可以很容易地用 JOIN 代替。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T22:25:30.887

看看这是否效果更好......或者也许是一个独特的内部连接？

```
select a.*,
(select top 1 g.Lat from GIS_Location g where g.City = a.City and g.State = a.State) as Lat,
(select top 1 g.Lon from GIS_Location g where g.City = a.City and g.State = a.State) as Lon
from Address_Location a
where a.ID in (select top 100 ID from Address_Location order by ID desc) 
```

至于标量函数的性能，我不确定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-07T15:36:08.317

通常标量函数比内联 TVF 函数慢得多。幸运的是，在许多情况下它会改变。

SQL Server 2019 将引入 **[标量 UDF 内联](https://docs.microsoft.com/en-us/sql/relational-databases/user-defined-functions/scalar-udf-inlining?view=sqlallproducts-allversions)**：

> 智能查询处理套件功能下的一个功能。**此功能提高了在 SQL Server 中调用标量 UDF 的查询的性能（从 SQL Server 2019 预览版开始）**
> 
> ## T-SQL 标量用户定义函数
> 
> 在 Transact-SQL 中实现并返回单个数据值的用户定义函数称为 T-SQL 标量用户定义函数。**T-SQL UDF 是一种跨 SQL 查询实现代码重用和模块化的优雅方式。一些计算（例如复杂的业务规则）更容易以命令式 UDF 形式表达。UDF 有助于构建复杂的逻辑，而不需要编写复杂的 SQL 查询的专业知识。**
> 
> 由于以下原因，标量 UDF 通常最终表现不佳。
> 
> *   迭代调用
> *   缺乏成本核算
> *   解释执行
> *   串行执行
> 
> * * *
> 
> ## 标量 UDF 的自动内联
> 
> 标量 UDF 内联功能的目标是提高调用 T-SQL 标量 UDF 的查询的性能，其中 UDF 执行是主要瓶颈。
> 
> 使用此新功能，标量 UDF 会自动转换为标量表达式或标量子查询，在调用查询中替换 UDF 运算符。然后优化这些表达式和子查询。**因此，查询计划将不再具有用户定义的函数运算符，但其效果将在计划中观察到，例如视图或内联 TVF。**
> 
> * * *
> 
> ## 可内联标量 UDF 要求
> 
> 如果以下所有条件都为真，则标量 T-SQL UDF 可以是内联的：
> 
> *   UDF 使用以下结构编写：
>     
>     
>     1.  DECLARE, SET：变量声明和赋值。
>     2.  SELECT：带有单/多变量赋值的 SQL 查询1。
>     3.  IF/ELSE：具有任意嵌套级别的分支。
>     4.  RETURN：单个或多个返回语句。
>     5.  UDF：嵌套/递归函数调用2。
>     6.  其他：关系运算，如EXISTS、ISNULL。
> *   UDF 不会调用任何与时间相关的内部函数（例如 GETDATE()）或具有副作用3（例如 NEWSEQUENTIALID()）。
>     
>     
> *   UDF 使用 EXECUTE AS CALLER 子句（如果未指定 EXECUTE AS 子句，则为默认行为）。
> *   UDF 不引用表变量或表值参数。
> *   调用标量 UDF 的查询不会在其 GROUP BY 子句中引用标量 UDF 调用。
> *   UDF 不是本机编译的（支持互操作）。
> *   UDF 不用于计算列或检查约束定义。
> *   UDF 不引用用户定义的类型。
> *   没有签名添加到 UDF。
> *   UDF 不是分区函数。

检查函数是否可内联：

```
SELECT OBJECT_NAME([object_id]) AS name, is_inlineable
FROM sys.sql_modules
WHERE [object_id] = OBJECT_ID('schema.function_name') 
```

在数据库级别启用/禁用功能：

```
ALTER DATABASE SCOPED CONFIGURATION SET TSQL_SCALAR_UDF_INLINING = ON/OFF; 
```

* * *

# 附录

**[微软研究院——Froid 项目](https://www.microsoft.com/en-us/research/project/froid/)**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-28T20:37:04.263

很抱歉我迟到了这个聚会，但我想为未来的 Profiler 受害者分享我的答案。几天前，一台生产服务器（sql server 2012 sp4 enterprise）中的所有标量函数变慢了，一些通常需要几秒钟才能完成的存储过程，它们开始在几分钟内运行，在一种情况下是几小时。

最后，使用分析器创建的跟踪是造成这种情况的根本原因。跟踪已启动，但运行此跟踪的笔记本电脑已关闭，而之前没有停止跟踪。就像奇迹一样，用户 sa 自动停止了跟踪（为了记录，sa 帐户被禁用并重命名）--“SQL 跟踪已停止。跟踪 ID = '3'。登录名 = 'sa'。” 这会自动解决性能问题。

因此，检查在慢速服务器上运行的分析器跟踪或扩展事件

希望这对将来的某个人有所帮助。

# c# - 如何将泛型集合与 LINQ-to-entities 一起使用

> ID：800022
> 
> 赞同：0
> 
> 时间：2009-04-28T22:02:36.230
> 
> 标签：c#, linq, linq-to-entities

我无法将以下 SQL 语句转换为 LINQ-to-entities：

```
SELECT l.*
FROM locations l
WHERE l.id NOT IN (/* array of ids */) 
```

在 LINQ 中，我希望看到类似的内容（其中 myCollection 是要排除的项目的通用列表）：

```
IQueryable<Location> locationQuery = from l in DataContext.Location
                                     where !myCollection.Contains(l)
                                     select l; 
```

但这不起作用，因为 Contains 在 LINQ-to-entities 中不可用（如我所见）。在我最好/最接近的 LINQ 尝试中，我有我的位置集合（一个列表），我有一个 DataContext，它从数据库中检索所有现有的位置：

```
List<Location> Route = new List<Location>();

// Some code to add Location entities from the DB to the Route collection

var innerQuery = from p in Route
                 select p.ID;

IQueryable<Location> locationQuery = from l in DataContext.Location
                                     where !((innerQuery).Any(k => k == l.ID))
                                     select l; 
```

显然，我想从数据库中获取不在我本地集合中的所有位置。但是，代码将引发 NotSupportedException 说明：

*无法创建“闭包类型”类型的常量值。此上下文仅支持原始类型（“例如 Int32、String 和 Guid”）。*

我一直在摆弄它，使用不同的方法，但我就是无法让它工作。现在我已经读到 LINQ-to-entities 无法进行高级比较（对象级别），这可能解释了上述错误。

我的实际问题是，我如何在 LINQ 中做我可以在 SQL 中如此轻松地做的事情？我只想从数据库中选择一堆实体，不包括本地（非数据库）集合中存在的实体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T22:15:42.970

试试这个帖子： [LINQ to Entities 中的“NOT IN”子句](https://stackoverflow.com/questions/432954/not-in-clause-in-linq-to-entities)

# unix - 在 Unix 中删除回车

> ID：800030
> 
> 赞同：243
> 
> 时间：2009-04-28T22:05:57.393
> 
> 标签：unix, carriage-return

`\r`从 Unix 文件中删除所有回车的最简单方法是什么？

* * *

## 回答 #1

> 赞同：285
> 
> 时间：2009-04-29T02:25:10.420

我将假设您的意思是在行尾的回车（*,*`CR` , `"\r"`）`0x0d`，而不是盲目地在文件中（据我所知，您可能将它们放在字符串的中间）。仅在第一行末尾使用此测试文件：*`CR`*

 *```
$ cat infile
hello
goodbye

$ cat infile | od -c
0000000   h   e   l   l   o  \r  \n   g   o   o   d   b   y   e  \n
0000017 
```

`dos2unix`如果它已安装在您的系统上，这是要走的路：

```
$ cat infile | dos2unix -U | od -c
0000000   h   e   l   l   o  \n   g   o   o   d   b   y   e  \n
0000016 
```

如果由于某种原因`dos2unix`您无法使用，那么`sed`将这样做：

```
$ cat infile | sed 's/\r$//' | od -c
0000000   h   e   l   l   o  \n   g   o   o   d   b   y   e  \n
0000016 
```

如果由于某种原因`sed`您无法使用，那么`ed`将以一种复杂的方式进行操作：

```
$ echo ',s/\r\n/\n/
> w !cat
> Q' | ed infile 2>/dev/null | od -c
0000000   h   e   l   l   o  \n   g   o   o   d   b   y   e  \n
0000016 
```

如果您的盒子上没有安装*任何*这些工具，那么您遇到的问题比尝试转换文件要大:-)

* * *

## 回答 #2

> 赞同：259
> 
> 时间：2009-04-29T13:48:10.200

```
tr -d '\r' < infile > outfile 
```

见[tr(1)](http://www.opengroup.org/onlinepubs/009695399/utilities/tr.html)

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2017-01-04T10:47:21.560

在我看来，Linux 上最简单的方法是，

```
sed -i.bak 's/\r$//g' <filename> 
```

**-i**将就地编辑文件，而**.bak**将通过制作文件副本并在末尾添加扩展名**.bak**来创建原始文件的备份。（您可以在 之后指定您想要的任何内容`-i`，或仅指定`-i`不创建备份。）

替换运算符周围的强**引号**`'s/\r//'`是**必不可少**的。没有它们，shell 将解释`\r`为 escape+r 并将其简化为 plain `r`，并删除所有小写字母`r`。这就是[Rob](https://stackoverflow.com/users/3542/rob)在 2009 年上面给出的答案不起作用的原因。

添加`/g`修饰符可确保`\r`删除多个，而不仅仅是第一个。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-04-29T13:50:27.030

老套：

```
tr -d '\r' < filewithcarriagereturns > filewithoutcarriagereturns 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-04-28T22:10:32.950

许多系统上都有一个名为[dos2unix](http://www.linuxcommand.org/man_pages/dos2unix1.html)的实用程序，并且可以在大多数系统上轻松安装。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-28T22:12:37.813

`sed -i s/\r// <filename>`或类似的东西；请参阅`man sed`或在网络上提供有关使用`sed`.

需要指出的一点是上面“回车”的确切含义；如果您真正的意思是单个控制字符“回车”，那么上面的模式是正确的。如果您的意思是，更一般地说，CRLF（回车和换行，这是在 Windows 下实现换行的方式），那么您可能想要替换`\r\n`。Linux/Unix 中的裸换行符（换行符）是`\n`.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-09-05T11:13:53.417

如果您是 Vi 用户，您可以使用以下命令打开文件并删除回车：

```
:%s/\r//g 
```

或与

```
:1,$ s/^M// 
```

请注意，您应该通过按 ctrl-v 然后按 ctrl-m 来输入 ^M。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-01-28T15:09:42.847

又是一个解决方案……因为总会有一个解决方案：

```
perl -i -pe 's/\r//' filename 
```

这很好，因为它已经到位并且适用于我使用过的各种 unix/linux。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-07-23T15:25:03.203

其他人推荐`dos2unix`，我也强烈推荐。我只是提供更多细节。

如果已安装，请跳至下一步。如果尚未安装，我建议通过以下方式安装它`yum`：

```
yum install dos2unix 
```

然后你可以像这样使用它：

```
dos2unix fileIWantToRemoveWindowsReturnsFrom.txt 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-08-23T22:36:03.810

# `\r`在任何 UNIX® 系统上删除：

这个问题中的大多数现有解决方案都是特定于 GNU 的，并且不适用于 OS X 或 BSD；下面的解决方案应该可以在更多的 UNIX 系统上工作，并且在任何 shell 中，从`tcsh`to `sh`，但即使在 GNU/Linux 上也仍然可以工作。

在 OS X、OpenBSD 和 NetBSD 上测试[`tcsh`](http://ports.su/shells/tcsh)，在 Debian GNU/Linux 上测试[`bash`](http://ports.su/shells/bash)。

* * *

## 与`sed`：

在`tcsh`OS X 上，以下[`sed`](http://mdoc.su/f/sed.1)代码段可以与 一起使用[`printf`](http://mdoc.su/f/printf.1)，因为它既不`sed`也不会像 GNU 那样以特殊方式[`echo`](http://bxr.su/f/bin/echo/)处理：`\r`

```
sed `printf 's/\r$//g'` input > output 
```

* * *

## 与`tr`：

另一种选择是[`tr`](http://mdoc.su/f/tr.1)：

```
tr -d '\r' < input > output 
```

* * *

## `sed`和之间的区别`tr`：

似乎`tr`保留了输入文件中缺少尾随换行符的情况，而`sed`在 OS X 和 NetBSD（但不是在 OpenBSD 或 GNU/Linux 上）即使输入缺少任何内容，也会在文件的最后插入尾随换行符在文件的末尾`\r`或`\n`末尾。

* * *

## 测试：

以下是一些示例测试，可用于确保它在您的系统上运行，使用`printf`and [`hexdump -C`](http://mdoc.su/f/hexdump.1); 或者，[`od -c`](http://mdoc.su/-/od.1)如果您的系统丢失，也可以使用`hexdump`：

```
% printf 'a\r\nb\r\nc' | hexdump -C
00000000  61 0d 0a 62 0d 0a 63                              |a..b..c|
00000007
% printf 'a\r\nb\r\nc' | ( sed `printf 's/\r$//g'` /dev/stdin > /dev/stdout ) | hexdump -C
00000000  61 0a 62 0a 63 0a                                 |a.b.c.|
00000006
% printf 'a\r\nb\r\nc' | ( tr -d '\r' < /dev/stdin > /dev/stdout ) | hexdump -C
00000000  61 0a 62 0a 63                                    |a.b.c|
00000005
% 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-11-28T18:16:43.983

如果您使用的操作系统（如 OS X）没有该`dos2unix`命令但有 Python 解释器（版本 2.5+），则此命令等效于以下`dos2unix`命令：

```
python -c "import sys; import fileinput; sys.stdout.writelines(line.replace('\r', '\n') for line in fileinput.input(mode='rU'))" 
```

这处理命令行上的命名文件以及管道和重定向，就像`dos2unix`. 如果将此行添加到 ~/.bashrc 文件（或其他 shell 的等效配置文件）：

```
alias dos2unix="python -c \"import sys; import fileinput; sys.stdout.writelines(line.replace('\r', '\n') for line in fileinput.input(mode='rU'))\"" 
```

...下次您登录（或`source ~/.bashrc`在当前会话中运行）时，您将能够以`dos2unix`与其他示例相同的方式在命令行上使用该名称。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-04-21T12:58:51.383

你可以简单地这样做：

```
$ echo $(cat input) > output 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-12-17T20:18:41.210

事情是这样的，

`%0d`是回车符。使其与 Unix 兼容。我们需要使用下面的命令。

`dos2unix fileName.extension fileName.extension`

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-07-20T09:50:41.280

试试这个将dos文件转换成unix文件：

> 从dos文件

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-06-29T20:24:53.053

对于 UNIX... 我注意到 dos2unix 从我的 UTF-8 文件中删除了 Unicode 标头。在 git bash (Windows) 下，以下脚本似乎运行良好。它使用 sed。请注意，它仅删除行尾的回车符，并保留 Unicode 标头。

```
#!/bin/bash

inOutFile="$1"
backupFile="${inOutFile}~"
mv --verbose "$inOutFile" "$backupFile"
sed -e 's/\015$//g' <"$backupFile" >"$inOutFile" 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-08-18T09:00:54.847

如果您正在运行 X 环境并拥有适当的编辑器（Visual Studio 代码），那么我将遵循建议：

[Visual Studio Code：如何显示行尾](https://stackoverflow.com/questions/39525417/visual-studio-code-how-to-show-line-endings)

只需转到屏幕的右下角，Visual Studio 代码就会向您显示文件编码和文件后跟的行尾约定，只需单击一下即可切换。

只需在 linux 环境中使用可视代码作为 notepad++ 的替代品，您就可以开始使用了。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-09-24T15:38:16.127

`cat input.csv | sed 's/\r/\n/g' > output.csv`

为我工作

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-10-27T15:47:45.820

使用`sed`

```
sed $'s/\r//' infile > outfile 
```

`sed`在 Windows 版 Git Bash 上使用

```
sed '' infile > outfile 
```

第一个版本使用*ANSI-C 引用*`\`，如果命令从脚本运行，可能需要转义。第二个版本利用了通过删除和字符`sed`逐行读取输入文件的事实。但是，在将行写入输出文件时，它只附加一个字符。只需修改即可设计出更通用和跨平台的解决方案`\r``\n``\n``IFS`

```
IFS=$'\r\n' # or IFS+=$'\r' if the lines do not contain whitespace
printf "%s\n" $(cat infile) > outfile
IFS=$' \t\n' # not necessary if IFS+=$'\r' is used 
```

**警告：**此解决方案执行文件名扩展（如果设置了`*`,`?`和`[...]`更多）。`extglob`仅当您确定文件不包含特殊字符或您想要扩展时才使用它。
**警告：**没有一个解决方案可以`\`在输入文件中处理。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-03-10T01:15:28.743

我用过python，这里是我的代码；

```
end1='/home/.../file1.txt'
end2='/home/.../file2.txt'
with open(end1, "rb") as inf:
     with open(end2, "w") as fixed:
        for line in inf:
            line = line.replace("\n", "")
            line = line.replace("\r", "")
            fixed.write(line) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-02-18T14:49:47.717

虽然这是一个较旧的帖子，但最近我遇到了同样的问题。由于我在 /tmp/blah_dir/ 中要重命名所有文件，因为该目录中的每个文件都有“/r”尾随字符（在文件末尾显示“？”），所以只有我能想到的脚本方式。

我想用相同的名称保存最终文件（不带任何字符）。使用 sed，问题是输出文件名，我需要提及其他内容（我不想要）。

我尝试了这里建议的其他选项（由于某些限制，不考虑 dos2unix）但没有奏效。

**我最终尝试了“awk”，它在我使用“\r”作为分隔符并采用第一部分的情况下工作**：

诀窍是：

```
echo ${filename}|awk -F"\r" '{print $1}' 
```

下面我使用的脚本片段（我所有文件在路径/tmp/blah_dir/处都有“\r”作为尾随字符）来解决我的问题：

```
cd /tmp/blah_dir/
for i in `ls`
  do
    mv   $i     $(echo $i | awk -F"\r" '{print $1}')
done 
```

**注意：**这个例子虽然与我的工作很接近，但并不是很准确（在这里提及只是为了更好地了解我所做的事情）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-11-27T15:00:02.570

我制作了这个 shell 脚本来删除 \r 字符。它适用于 solaris 和 red-hat：

```
#!/bin/ksh

LOCALPATH=/Any_PATH

for File in `ls ${LOCALPATH}`
do
   ARCACT=${LOCALPATH}/${File}
   od -bc ${ARCACT}|sed -n 'p;n'|sed 's/015/012/g'|awk '{$1=""; print $0}'|sed 's/ /\\/g'|awk '{printf $0;}'>${ARCACT}.TMP
   printf "`cat ${ARCACT}.TMP`"|sed '/^$/d'>${ARCACT}
   rm ${ARCACT}.TMP
done

exit 0 
```

# c# - 缓存对象的高效克隆

> ID：800031
> 
> 赞同：3
> 
> 时间：2009-04-28T22:06:02.540
> 
> 标签：c#, performance, clone, deep-copy

我们有一个应用程序对数据对象执行比较以确定对象的一个​​版本是否不同于另一个版本。我们的应用程序还对这些对象进行了一些广泛的缓存，在进行这些比较时我们遇到了一些性能问题。

这是工作流程：

1.  数据项 1 是内存中的当前项。该项目最初是从缓存中检索并深度克隆的（所有子对象，例如字典等）。然后编辑数据项 1，并修改其属性。
2.  然后，我们将此对象与存储在缓存中的原始版本进行比较。由于数据项 1 已被克隆并且其属性已更改，因此这些对象应该是不同的。

这里有几个问题。

主要问题是我们的深度克隆方法非常昂贵。我们针对浅克隆对其进行了分析，它的速度慢了 10 倍。那是废话。这是我们深度克隆的方法：

```
 public object Clone()    
    {
        using (var memStream = new MemoryStream())
        {
            var binaryFormatter = new BinaryFormatter(null, new StreamingContext(StreamingContextStates.Clone));
            binaryFormatter.Serialize(memStream, this); 
            memStream.Seek(0, SeekOrigin.Begin);
            return binaryFormatter.Deserialize(memStream);
        }
    } 
```

我们最初使用以下内容进行克隆：

```
public object Clone()
{
    return this.MemberwiseClone();
} 
```

这是更高的性能，但是因为它做了一个浅层克隆，所以作为该对象属性的所有复杂对象，例如字典等，都没有被克隆。该对象仍将包含与缓存中的对象相同的引用，因此在比较时属性将相同。

那么，有没有人有一种有效的方法对 C# 对象进行深度克隆，包括克隆整个对象图？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T22:29:23.157

如果不对所有需要克隆的数据对象显式实现 ICloneable，您将无法获得比通用二进制序列化更好的结果。另一种可能的途径是反射，但如果您正在寻找性能，您也不会对此感到满意。

我会考虑使用 ICloneable 进行深层复制和/或 IComparable 来比较对象是否不同……如果性能对您来说是个大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T22:20:20.213

也许你不应该深度克隆呢？

其他选项：

1）让你的“缓存”对象记住它的原始状态，并让它*在*每次发生任何变化时更新“已更改”标志。

2）不要记住原始状态，一旦发生任何变化就将对象标记为脏。然后从原始源重新加载对象进行比较。我敢打赌，您的对象更改的频率低于不更改的频率，甚至更不频繁地更改回相同的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T22:29:29.800

我的回答可能不适用于您的情况，因为我不知道您的限制和要求是什么，但我觉得通用克隆可能有问题。正如您已经遇到的那样，性能可能是一个问题。某些东西需要识别对象图中的唯一实例，然后创建一个精确的副本。这就是二进制序列化程序为您所做的事情，但它还可以做更多事情（序列化本身）。看到它比您预期的要慢，我并不感到惊讶。我有类似的经历（顺便也与缓存有关）。我的方法是自己实现克隆；即为实际需要克隆的类实现IClonnable。您正在缓存的应用程序中有多少类？如果有太多（手动编码克隆），

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-09T13:15:43.063

您可以通过两种方式进行深度克隆：通过实现 ICloneable（并调用 Object.MemberwiseClone 方法），或通过二进制序列化。

**第一种方式**

第一种（可能更快，但并不总是最好的）方法是在每种类型中实现 ICloneable 接口。下面的示例说明了这一点。C类实现了ICloneable，由于这个类引用了其他的D类和E类，那么后者也实现了这个接口。在 C 的 Clone 方法中，我们调用其他类型的 Clone 方法。

```
Public Class C
Implements ICloneable

    Dim a As Integer
    ' Reference-type fields:
    Dim d As D
    Dim e As E

    Private Function Clone() As Object Implements System.ICloneable.Clone
        ' Shallow copy:
        Dim copy As C = CType(Me.MemberwiseClone, C)
        ' Deep copy: Copy the reference types of this object:
        If copy.d IsNot Nothing Then copy.d = CType(d.Clone, D)
        If copy.e IsNot Nothing Then copy.e = CType(e.Clone, E)
        Return copy
    End Function
End Class

Public Class D
Implements ICloneable

    Public Function Clone() As Object Implements System.ICloneable.Clone
        Return Me.MemberwiseClone()
    End Function
End Class

Public Class E
Implements ICloneable

    Public Function Clone() As Object Implements System.ICloneable.Clone
        Return Me.MemberwiseClone()
    End Function
End Class 
```

现在，当您为 C 的实例调用 Clone 方法时，您将获得该实例的深度克隆：

```
Dim c1 As New C
Dim c2 As C = CType(c1.Clone, C)   ' Deep cloning.  c1 and c2 point to two different 
                                   ' locations in memory, while their values are the 
                                   ' same at the moment.  Changing a value of one of
                                   ' these objects will NOT affect the other. 
```

注意：如果 D 类和 E 类具有引用类型，则必须像我们对 C 类所做的那样实现它们的 Clone 方法。依此类推。

警告：1-只要没有循环引用，上面的示例就有效。例如，如果 C 类有一个自引用（例如，C 类型的字段），实现 ICloneable 接口并不容易，因为 C 中的 Clone 方法可能会进入无限循环。

2-另外需要注意的是，MemberwiseClone 方法是 Object 类的受保护方法。这意味着您只能在类的代码中使用此方法，如上所示。这意味着您不能将它用于外部类。

因此，实现 ICloneable 只有在上述两个警告不存在时才有效。否则，您应该使用二进制序列化技术。

**第二种方式**

二进制序列化可用于深度克隆而不会出现上述问题（尤其是循环引用）。这是一个使用二进制序列化执行深度克隆的通用方法：

```
Public Class Cloning
    Public Shared Function DeepClone(Of T)(ByVal obj As T) As T
        Using MStrm As New MemoryStream(100)    ' Create a memory stream.
            ' Create a binary formatter:
            Dim BF As New BinaryFormatter(Nothing, New StreamingContext(StreamingContextStates.Clone))

            BF.Serialize(MStrm, obj)    ' Serialize the object into MStrm.
            ' Seek the beginning of the stream, and then deserialize MStrm:
            MStrm.Seek(0, SeekOrigin.Begin)
            Return CType(BF.Deserialize(MStrm), T)
        End Using
    End Function
End Class 
```

以下是如何使用此方法：

```
Dim c1 As New C
Dim c2 As C = Cloning.DeepClone(Of C)(c1)   ' Deep cloning of c1 into c2\.  No need to 
                                            ' worry about circular references! 
```

# wpf - 如何传递以下参数？VisualTreeHelper.HitTest(,,,) 中的 HitTestParameters3D？

> ID：800040
> 
> 赞同：0
> 
> 时间：2009-04-28T22:08:56.607
> 
> 标签：wpf, hittest

我正在尝试将 HitTestParameters3D 参数传递给 VisualTreeHelper.HitTest(,,,) 但我没有找到任何关于如何做到这一点的示例，而且关于 HitTestParameters3D 的信息很少。

帮助表示赞赏。

谢谢

问

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-31T16:28:44.540

使用[RayHitTestParameters 类作为参数](http://msdn.microsoft.com/en-us/library/system.windows.media.media3d.hittestparameters3d.aspx)。

```
RayHitTestParameters hitParams = 
        new RayHitTestParameters(
            new Point3D(0, 0, 0),
            new Vector3D(1, 0, 0)
            );
    VisualTreeHelper.HitTest(visual3d, null, ResultCallback, hitParams); 
```

确保将 Visual3D（例如 ModelVisual3D）而[不是您的 Viewport3D](https://social.msdn.microsoft.com/Forums/vstudio/en-US/b6d35249-353a-4a14-a8a7-1b9dba9b6fca/how-to-do-hit-test-in-wpf-3d?forum=wpf)作为第一个参数传递给 HitTest。否则，您将收到“无法从 RayHitTestParameters 转换为 HitTestParameters”错误。

# outlook - OL 插件和 VMWare

> ID：800052
> 
> 赞同：0
> 
> 时间：2009-04-28T22:12:27.330
> 
> 标签：outlook

我们有一个用于 Outlook 的托管 COM 插件，现在使用 VMWare 6.05 在真机上完美运行加载 COM 组件时发生运行时错误 事件查看器上没有任何内容

我们在 Office 2003 和 2007 的图像上看到了这一点

任何人都曾遇到过这样的情况，其中 VMWare 映像会导致 OL 插件出现问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T12:36:44.353

您可以访问插件的源代码吗？如果是这样，您可以调试或跟踪启动。你能加载任何其他插件吗？添加有什么作用？76梅尔

# javascript - 与 Flash 一起使用的最佳 jQuery 下拉导航 Suckerfish 替代方案？

> ID：800056
> 
> 赞同：0
> 
> 时间：2009-04-28T22:12:48.983
> 
> 标签：javascript, jquery, flash, drop-down-menu, navigation

我认为我的 Suckerfish 下拉导航不能很好地与 flash 配合使用。我已经完成了我能想到的一切，但我的下拉导航一直显示在我的 Flash 电影下方。如果我用图像替换电影，它显示得很好。只有当我使用 Flash 电影时，Flash 电影下方才会显示导航。我已经添加了`wmode`它仍然无法正常工作：

```
<param name="wmode" value="transparent" /> 
```

所以我认为我唯一的解决方案是尝试更换导航。所以我正在寻找一个 jQuery 插件来替代我当前的导航。我当前的导航是这样工作的：

1.  这是一个水平下拉菜单
2.  当您将鼠标悬停在菜单上时，会出现第一级下拉菜单
3.  当您单击第一级下拉菜单中的链接时，第二级会显示在单击的链接下方（不像大多数导航菜单那样位于右侧）。有点像垂直手风琴菜单。

目前有这样的东西吗？我想不出任何其他方法可以让导航出现在 Flash 电影的顶部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T22:58:57.903

呸！我忘记了一件事。**您必须在两个**地方设置窗口模式！我正在使用[SWFObject javascript 插件](http://code.google.com/p/swfobject/)，所以我的 HTML 如下所示。

为了让您的导航出现在 Flash 电影的顶部，您一定不要忘记在**第二个对象标签**`wmode="opaque"`中指定（或透明）

 **```
<object id="homepage_slideshow" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="530" height="397">
    <param name="movie" value="flash/homepage_slideshow.swf" />
    <param name="wmode" value="opaque" />
    <!--[if !IE]>-->
    <object type="application/x-shockwave-flash" data="flash/homepage_slideshow.swf" width="530" height="397" wmode="opaque">
    <!--<![endif]-->
    <!-- begin alternative content -->
    <img src="images/photos/homepage-placeholder-photo.jpg" width="530" height="397" alt="Get Moving Again!" />
    <!-- end alternative content -->
    <!--[if !IE]>-->
    </object>
    <!--<![endif]-->
</object> 
```

# html-parsing - 使用 nutch 1.0 和自定义插件解析 html 数据

> ID：800059
> 
> 赞同：3
> 
> 时间：2009-04-28T22:13:25.597
> 
> 标签：html-parsing, nutch

我目前正在尝试为 nutch 1.0 编写一个自定义插件。这个插件应该解析 html 数据并从文档中过滤掉相关信息。我有一个基本插件工作，它扩展了 HtmlParserResult 对象，并且每次我进行解析时都会执行。

我目前面临两个问题：

1.  我不太了解 nutch 解析的工作流程/管道。我在 nutch 网站上找不到有关此的信息。

2.  我不明白 DOM 解析是如何完成的，我看到 Nutch 有一组 DOM 对象，并且 HtmlParser 插件进行了一些 DOM 解析，但我仍然没有弄清楚如何最好地完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-26T17:05:54.810

我记得为过去的工作制作了一个 nutch HTML 解析插件。我无法了解我是如何做到的，但这里是基本点。我们想做以下事情：

1.  解析 HTML 页面，但有条件地使用 H1 标签或具有特定类的标签作为页面标题，而不是实际的 //html/head/title
2.  有时页面上有一些特殊的数据（即选择了哪个选项卡，这将告诉我们这是零售客户、银行客户还是公司客户）。
3.  等等

我所做的只是找到 html-parse 插件类（我很难找到实际的类名），然后扩展它。然后重写解析函数。新函数应该调用该`super`函数，然后可以遍历 DOM 树以查找您要查找的特殊数据。在我的情况下，我会寻找一个更好的标题，然后覆盖该`super`函数提出的值。

对于你的第二个问题，我不清楚你在问什么。我想您是在问当 DOM 格式不正确时会发生什么？我只是挖掘 nutch 代码（http://grepcode.com/snapshot/repo1.maven.org/maven2/org.apache.nutch/nutch/1.3/）并找出解析是如何完成的（我是确保他们使用图书馆来做到这一点）。这应该告诉你更多关于事情是否贪婪，或者什么。

如果您有任何问题，请大声喊叫。

# asp.net - 母版页下拉列表未保留选定索引

> ID：800065
> 
> 赞同：0
> 
> 时间：2009-04-28T22:14:39.760
> 
> 标签：asp.net, session, drop-down-menu, master-pages, viewstate

好的，我的母版页有一个下拉菜单，它控制影响很多事情的大小。我需要从内容页面访问下拉索引，因此我使用此代码进行操作。

```
public partial class MasterPage : System.Web.UI.MasterPage
{
public DropDownList MySize { get { return _ddlSize; } }
} 
```

我正在使用 Ajax，当大小更改时，Masterpage 上的菜单更改得很好。

但是，当我单击更新后的菜单时，它会使用我的内容页面上下拉列表的零索引，即使在视觉上它也会显示我选择的大小。

```
 int size = Convert.ToInt32(Master.MySize.SelectedItem.Text); //Uses 0 index :( 
```

我不想使用 Session，我只是不明白为什么这不能 100% 工作。有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T23:31:52.583

我想到了！

我将下拉列表设置为公共静态对象

```
public static DropDownList MySize; 
```

然后我只是将它设置为等于每次加载母版页时的页面实例。

```
protected void Page_Load(object sender, EventArgs e)
{
    MySize = _ddlSize;
} 
```

调用 DropDownList 有点不同，因为它是一个静态对象。

```
MasterPage.MySize.SelectedItem.Text 
```

但它适用于从 Masterpage 派生的所有内容页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T23:38:24.520

您是否在多用户场景中检查过此解决方案，因为该值是静态的，它将反映在不同的用户中

母版页中设置的视图状态应保留下拉列表值或尝试使用隐藏控件来保留该值

# xml - 如何允许用户定义 XML 文件格式？

> ID：800074
> 
> 赞同：0
> 
> 时间：2009-04-28T22:18:44.523
> 
> 标签：xml, user-interface, xslt

我想允许用户将带有交易信息的文件上传到我的应用程序。我希望用户在这样做时能够使用自己的文件格式（XML 或 CSV）。

因此，在进行进一步处理之前，我需要将它们的格式转换为我的格式。我不想每次用户有新的文件格式时都手动创建这个 XSLT，所以我想创建一个 UI 来构建这个 XSLT 文档。

这对于 CSV 文件格式来说相对容易。用户说第一个元素映射到我这边的 x 字段，第二个元素映射到 7 字段等。

当文件格式是带有嵌套元素的 XML 等时，这会变得更加复杂。有谁知道这样做的良好 UI 范例？我可以在网络或其他地方查看任何示例吗？我想用户必须将完整的 xpath 描述为映射的一部分，或者可能首先上传 XSD 并使用它来选择映射元素（之后我需要生成 XSLT）。

我很欣赏任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T00:48:46.707

如果输入 XML 可以直接映射到您的 XML 格式，那么用户将需要一组 XPath 表达式。

我所说的“直截了​​当的方式”是指一种非常基本的`<xsl:apply-templates>`方法。输入 XML 必须具有可以明确处理的单独记录，其中包含正确格式的所有数据。没有任何数据需要计算或其他特殊处理，比通过评估单个 XPath 表达式所能实现的更复杂。

如果输入是：

```
<root>
  <entry id="1" name"foo">
    <data1>somevalue
      <data2>othervalue</data2>
    </data1>
  </entry>
</root> 
```

你想要的输出是：

```
<records>
  <record>
    <id>1</id>
    <name>foo</name>
    <data1>somevalue</data1>
    <data2>othervalue</data2>
  </record>
</records> 
```

那么用户必须提供以下映射：

*   根元素：“根”
*   记录元素：“条目”
*   id：“@id”
*   名称：“@名称”
*   数据1：“数据1”
*   数据2：“数据1/数据2”

并且 XSLT 将是这样的（“%”中的值将被上述映射配置中的实际 XPath 表达式替换）：

```
<xsl:template match="/">
  <records>
    <xsl:apply-templates select="%root element%/%record element%" />
  </records>
</xsl:template>

<xsl:template match="%root element%/%record element%">
  <record>
    <id>
      <xsl:value-of select="%id-xpath%[1]" />
    </id>
    <name>
      <xsl:value-of select="%name-xpath%[1]" />
    </name>
    <!-- and so on -->
  </record>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T06:11:52.730

如果我理解正确，您正在考虑创建所需的 xslt 所需的 UI。我假设这是一个基于 Web 的应用程序。一种方法是使用将输入 xml 呈现为 html 的 xslt（我倾向于使用的是[xmlverbatim](http://www2.informatik.hu-berlin.de/~obecker/XSLT/)）。您可以修改此 xslt 以创建到节点的链接。此外，您可以使用一些 xslt 为该元素生成 xpath 并使这部分成为链接。我使用这个（多年前由 Jeni Tennison 发布到 XSL 列表）

```
 <xsl:for-each select="ancestor-or-self::*">
    <xsl:text />/<xsl:value-of select="name()" />
    <xsl:text />[<xsl:number />]<xsl:text />
  </xsl:for-each> 
```

完成此操作后，您将获得 xml 的可视化呈现（类似于 MSIE 和 Firefox 提供的视图），但带有返回应用程序的附加链接。然后，您的用户可以选择感兴趣的节点。然后，他们为您提供了所需的 xpath，而无需自己实际编写。

如果您有 xpath，则生成 xslt 会容易得多。Tomalek 上面的建议似乎是一种有效的方法。如果您实际上并不需要 xml 作为最终输出，则最好使用 xml 解析器，该解析器允许您选择给定 xpath 的节点。

如果您收到的信息当然包含任意数量的记录，这将变得更加复杂。如果是这种情况，您可以使用多阶段方法并使用我在上面粗略介绍的技术从输入中提取记录，然后使用该方法来识别记录中的各个字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T18:11:40.660

[Altova MapForce](http://www.altova.com/products/mapforce/data_mapping.html)是一种商业产品，用于将一个 XML 模式映射到另一个并生成 XSL 转换。

您可能想看看他们的试用版，看看他们是如何解决这个相当复杂的问题的。

# linux - 在 64 位操作系统上开发有什么优势吗？

> ID：800076
> 
> 赞同：6
> 
> 时间：2009-04-28T22:19:19.497
> 
> 标签：linux, ubuntu, 64-bit, compatibility, x86-64

我不确定我是否理解正确：在同一系统上，64 位操作系统运行/编译代码是否比 32 位操作系统快？

我们使用的是 64 位操作系统，它似乎只会导致与旧版和专有软件的兼容性问题。（我们正在运行 Ubuntu 9.04 Jaunty amd64）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-28T22:27:12.630

我会将这个答案限制为 x86-32 (IA-32) 与 x86-64 (AMD64)，因为我相信这就是您实际要问的问题。

在处理器级别，有一些优势。首先也是最明显的是将每个进程的虚拟内存扩展到更广泛的 48 位范围。（架构中允许使用 64，但不是必需的，如果内存可用。）这使应用程序能够使用更多可用的系统内存，并为运行的内存映射文件之类的东西打开大量空间没有链接到真实内存的虚拟内存。它还为相关操作系统的工作开辟了很多空间，因为它不必共享其数据的 4 GB 限制。简而言之，应用程序和操作系统可以更好地利用您机器的资源。

此外，AMD64 架构解决了 IA-32 的最大问题之一，即完全没有寄存器。事实上，它使可用寄存器翻了一番，这对于某些类型的代码来说是一个巨大的胜利。（实际上，对于几乎任何代码来说，这都是一个胜利，但有些应用程序会因 64 位内存成本的增加而受到影响，而且结果会趋于平衡。）

在 Windows 方面，微软以此为契机，打破了一大堆历史上的兼容性问题。这不是与旧世界彻底决裂，但它是一个开始。我不相信 Linux 从一开始就遇到同样的问题，而且我对它们的 64 位优势没有太多看法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-28T22:32:51.180

As a general rule, developing--or using--a 64-bit operating system, in any context, will be *slower* than the same 32-bit operating system. Because all pointers are suddenly twice as large, you are far more likely to blow the cache, and can fit less data in RAM. That slows down your application considerably. You normally would only use 64-bit systems when your applications need to address more than 2 to 3 GB of data simultaneously--something very common in scientific computing and some database situations, but otherwise extremely rare. This is why Apple does not advocate unconditionally compiling PowerPC applications in 64-bit mode, for example: the cost due to cache-misses and lack of memory are high enough that going 64-bit only makes sense when you truly can take advantage of the 64-bit space.

But x86 v. AMD64, which is what you're really asking about (since you're discussing Ubuntu), is a very special beast. AMD64 not only extends all pointers to 64-bit; it fixes many, many deficiencies in the x86 architecture, doubling the number of GPRs, simplifying the instructions to be more friendly to modern CPU designs, and more. Because of this, *on AMD64 platforms only*, you will frequently see a substantial performance boost by going to 64-bit.

There is one other area where, in software development, it makes sense to go to 64-bit: you need to run lots of VMs. Running a couple of VMs can easily blow you past the 3 GB memory barrier of the operating system, making using them very painful. (It will work due to a technology called PAE, or Paged Addressing Extensions, that Intel invented to bridge the gap between 32-bit systems and 64-bit systems, but the result is slow, painful to work with as a developer, and not very well supported on Windows.) Going to a 64-bit OS can provide tremendous benefits.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-28T22:29:49.923

（正如评论员所指出的，这个答案有点笼统，其中一些观点不适用于英特尔/AMD 芯片。）

答案是：它会有所不同，原因如下：

*   使用更宽的指令，您将获得更多的表现力（更多种类的指令或将数据直接编码到这些指令中的更大容量），这可能意味着流经机器的指令数量减少，这通常是一场胜利：这里是 ++64 位。

*   但有时较大的指令*可能*需要更多的周期来解码和执行，因为它们可能更复杂。所以这里可能是--64bit。

*   此外，您需要将这些指令传入和传出 CPU：64 位指令是 32 位指令的两倍，这意味着进出内存和缓存的流量更多。CPU 的结构可以大大改善这种成本，但这里的成本略低--64 位。

*   More registers are usually available in wider instruction sets, which causes less data traffic to and from the stack and or memory. So ++64bit here.

*   And as everyone's no doubt going to mention, you have the ability to address more memory.

*   (Nearly forgot this one) the native "long" or "int" size may go up, depending on architecture, meaning data structures based on these get larger. Larger = more memory to move around, which means more possible waiting on data moving: --64bit if you're not careful.

Depending on your architecture, a lot of other concerns may apply too. You can rest assured that the processor and compiler vendors are working their butts off to reduce the "--"s above and increase the "++"s.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T23:10:41.853

I have this 5GByte database that needs converting. On a 64-bit system, I just put all data in collections. In the 32-bit system, I had to think about the order in which to load and convert. The problem is not run-time, it is engineering time. Switching to 64 bit saves weeks of development time.

The compatability issues: that's no bug, that's a feature. It shows you who has written clean software.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T00:15:59.123

There are also some security advantages to using 64-bit operating systems. There have been some buffer overflow exploits that circumvent address space layout randomization by brute force. On a 64-bit OS, there are simply too many addresses for this kind of attack to be successful.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T22:26:11.587

如果您的编译过程受内存限制并且您使用 64 位操作系统来增加系统可用的内存量，它将加快编译速度。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T22:08:24.163

I expect it to be slightly slower, I had that experience with FC10\. I don't have real reasons, but it is definitely not the sizeof(pointer) issue. (*)

My own hunch is that it simply is a matter of less optimized drivers or tweaked chipsets.

Also NTFS-3g was funny under 64-bit, while it worked under 32-bit (same distro, same kernel same partition, it just "hung" in some circumstances)

(*) most compiling is disk bound, not CPU bound. Moreover there are other improvements in the x86_64 architecture that cancel out that fact (better PIC, more regs, SSE2 default on, 686 cmov default on) . Unless your app does nothing than randomly moving small blocks around.

# mysql - MySQL 数据库已启动，但某些表未更新

> ID：800077
> 
> 赞同：1
> 
> 时间：2009-04-28T22:19:21.587
> 
> 标签：mysql, database

我有一个有 10 个表的 mysql 数据库。每个表驱动一个网站，用户可以在其中查看或向该表提交数据。

现在更流行的表已停止显示新数据（通过 phpmyadmin 检查）。较小的桌子仍然可以正常工作。

提交时我没有收到任何错误。数据只是没有显示在数据库中。

这一切都在一台共享托管服务器上。怎么可能只有数据库中的某些表有问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T22:42:05.917

这种问题时不时会出现。每次我看到这类问题时，都会发现显示数据的应用程序连接到的数据库与您通过 phpMyAdmin 更新的数据库不同。

所以我的建议是**什么都不**做，并仔细检查您的应用程序和 phpMyAdmin 会话中的每个数据库连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T22:48:08.057

如果您遇到问题，请尝试在这些表中使用 phpmyadmin 插入数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T22:58:27.687

如果我有多个使用相同数据文件运行的服务器进程，我偶尔会遇到 MySQL 不更新表的问题。

我在 MySQL 4.1 中遇到了这些问题，其中一台服务器独立运行，另一台运行嵌入式。MySQL 在启动时没有生成任何错误消息。我没有尝试用新版本的 MySQL 重现我的问题。

# ruby-on-rails - 我是否需要恢复到旧版本的 Rails 才能运行单个遗留应用程序（以及其他问题）？

> ID：800089
> 
> 赞同：2
> 
> 时间：2009-04-28T22:26:33.770
> 
> 标签：ruby-on-rails, ruby, installation, rubygems

我有一个需要运行的旧 Rails 应用程序。但我有最新版本的 Rails。

当我尝试运行这个较旧的应用程序时，它说：

> 缺少 Rails 1.99.0 gem。请 `gem install -v=1.99.0 rails`

但是当我运行命令时：*gem install -v=1.99.0 rails*

> 错误：在本地或存储库中找不到 gem rails

不知道下一步该怎么做。有人可以帮我理解这里发生了什么吗？

我的第二个问题与这个问题有关：我需要恢复到旧版本的 Rails 只是为了运行这个遗留应用程序，这似乎很愚蠢 - 必须有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T23:12:19.307

AFAIK，`v1.99.0`是一种`v2.0`预发布，所以你可以尝试安装`v2.0.x`，更改`RAILS_GEM_VERSION`和`config/environment.rb`运行`rake rails:update`。

如果你仔细想想，它并不像起初看起来那样愚蠢。您使用快速发展的 Web 框架作为 RoR 来制作应用程序。您的选择是：继续以与框架发展速度大致相同的速度开发您的应用程序，或者将 rails gem（以及您的应用程序所依赖的所有其他东西，如 gems、插件）冻结到您的应用程序中，以使其不那么脆弱，无法期待 gem更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T08:14:46.133

关于第二个问题：是的，这很愚蠢。幸运的是，Rails 团队发现了这种愚蠢，并在某些时候让我们能够将应用程序所需的 Rails 库版本（以及特定的 gem 版本）“冻结”到`vendor`目录中。

冻结你的 Rails 版本：

```
rake rails:freeze:gems 
```

不久前有一篇[很好的博客文章](http://www.softiesonrails.com/2008/1/3/freezing-your-rails-application)描述了这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T18:07:51.047

除非您安装和部署 RVM，否则您的安装将回滚您的系统 rails 安装，这将影响您的其他项目。如果您想以这种方式手动管理您的开发环境，您可以先卸载 rails，然后为当前项目安装所需版本的 rails。

但是尝试使用以下语法安装您的 rails gem：

```
sudo gem install rails -v 1.99.0 
```

# c# - 如何更新 ObservableCollection 的现有元素？

> ID：800091
> 
> 赞同：5
> 
> 时间：2009-04-28T22:27:18.900
> 
> 标签：c#, wpf, datatemplate, observablecollection

我有一个绑定到 WPF 列表框的 ObservableCollection 实例，该列表框具有两个单独的数据模板（一个用于显示，一个用于编辑）。用于编辑的数据模板在文本框上有一个单向绑定和一个保存按钮。

我需要进行哪些更改，以便当我按下保存按钮时（将列表项置于编辑模式后），我更改文本框的值以替换 ObservableCollection（和显示）中的值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T05:44:58.273

集合中的项目应该是实现 INotifyPropertyChanged 接口的类型。这样，您的列表框将被通知您的单个项目对象中的属性值已更改。ObservableCollection 仅在集合更改（添加、删除项目等）时引发 CollectionChanged 事件

引自关于 ObservableCollection 的 MSDN 库文章

> 要完全支持将数据值从绑定源对象传输到绑定目标，集合中支持可绑定属性的每个对象都必须实现适当的属性更改通知机制，例如 INotifyPropertyChanged 接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:00:47.527

要在绑定客户端和数据源之间的绑定中发生更改通知，您的绑定类型应该：

*   实现 INotifyPropertyChanged 接口（首选）。
*   为绑定类型的每个属性提供一个更改事件。

不要两者都做。

来源：[MSDN：INotifyPropertyChanged 接口](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-27T11:54:58.720

我已经使用 BindingList<T> 类解决了类似的问题。

它在集合和单个项目更改时都触发了 ListChanged 事件。

*在 .Net 3.5 中引入*

# artificial-intelligence - prolog sum & sub 使用后继者？

> ID：800101
> 
> 赞同：0
> 
> 时间：2009-04-28T22:31:19.203
> 
> 标签：artificial-intelligence, prolog

什么是使用后继的减法和求和，任何人都可以向我展示一个我知道如何以正常方式进行的示例。

/* sub(X, Y, Z) ---减法 */

子（X，Y，Z）：-添加（Y，Z，X）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:34:25.317

首先，您需要有一个谓词`succ`。SWI-Prolog 是这样定义的：

```
succ(?Int1, ?Int2)
    True  if  Int2 = Int1+ 1  and  Int1>=0\.     At  least  one  of  the
    arguments must be  instantiated to a natural number.  This predicate
    raises the domain-error not_less_than_zero if called with a negative
    integer.   E.g. succ(X, 0)  fails silently and succ(X, -1) raises  a
    domain-error. 
```

鉴于此，我们可以`add`这样定义：

```
add(0, Y, Y).
add(X, Y, Z) :-
  succ(PredX, X),
  add(PredX, Y, PredZ),
  succ(PredZ, Z). 
```

像这样`subtract`：

```
subtract(X, 0, X).
subtract(X, Y, Z) :-
  succ(PredY, Y),
  succ(PredX, X),
  subtract(PredX, PredY, Z). 
```

请注意，这些都不会处理负数（因为`succ`没有），因此我没有费心在`Y > X`.

* * *

## 编辑：

这是适用于任何实例化模式的`add`and的版本。`subtract`我仍然没有打扰类型检查（正如 Kaarel 在评论中提到的那样）或负数。

```
add(0, 0, 0).
add(0, Y, Y).
add(X, 0, X).
add(X, Y, Z) :-
  nonvar(X),
  succ(PredX, X),
  (nonvar(Z) -> 
    succ(PredZ, Z), add(PredX, Y, PredZ) 
  ; 
    add(PredX, Y, PredZ), succ(PredZ, Z)
  ).
add(X, Y, Z) :-
  nonvar(Y),
  add(Y, X, Z).

subtract(0, 0, 0).
subtract(X, 0, X).
subtract(X, X, 0).
subtract(X, Y, Z) :-
  add(Y, Z, X). 
```

# jquery - Submit a form using jquery without navigating to another screen

> ID：800108
> 
> 赞同：6
> 
> 时间：2009-04-28T22:33:16.437
> 
> 标签：jquery, forms

I'm trying to make it so that a form submit doesn't cause the page to navigate and use ajaxSubmit to submit the content. however when I click the submit button, it still navigates to the page in the action attribute of the form. Heres the javascript:

```
var options = {
    success: processLogin
};
$('#loginform').submit(function() {
    $(this).ajaxSubmit(options);
    return false;
}); 
```

and heres the form:

```
<form id='loginform' action='login.php' method='post'>
    <table id='logintable'>
        <tr>
            <td>Room:</td>
            <td><input id='roomname' type='text' name='roomname' /></td>
        </tr>
        <tr>
            <td>Nickname:</td>
            <td><input id='nickname' type='text' name='nickname' /></td>
        </tr>
        <tr>
            <td colspan='2' class='center'><input type='submit' value='Submit' /></td>
    </table>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T22:36:19.677

Use [event.preventDefault()](http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29)

```
$('#loginform').submit(function(e) {
    e.preventDefault();
    $(this).ajaxSubmit(options);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T04:55:56.380

Another option is to change the input html tag to `<input id="save" type="Button" value="submit" />` which gives you a button that does nothing except provide a javascript hook.

Use the following javascript to ajax submit your form

```
$("#save").click(function() {
    $("#loginform").ajaxSubmit();
} 
```

In doing this you lose the ability to submit the form by pressing enter. You can overcome this with the following piece of jquery:

```
$("input").keypress(function(e) {
    if (e.which == 13) {
        $("#save").click();
    }
}); 
```

# c - 在 C 的垃圾收集上标记阶段错误检测

> ID：800112
> 
> 赞同：2
> 
> 时间：2009-04-28T22:34:36.513
> 
> 标签：c, memory-management, garbage-collection

我看过[Conservative GC Algorithmic Overview](http://www.hpl.hp.com/personal/Hans_Boehm/gc/gcdescr.html)

“标记”部分会发生误检测吗？如果存储了一些数据并且碰巧与分配的内存的地址相同，那么收集器会保留内存吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-28T22:42:40.830

是的，这就是为什么它被称为保守派。每个看起来像它指向堆内的整数都会使该区域成为非垃圾。因此，可能会发生内存泄漏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T22:45:48.483

是的。

这就是为什么它被称为“保守”，我想。

# tomcat - 如何强制 IIS7 返回 Tomcat 错误响应

> ID：800113
> 
> 赞同：1
> 
> 时间：2009-04-28T22:34:53.703
> 
> 标签：tomcat, iis-7, windows-server-2008, isapi-redirect, magnolia

我有以下设置：

*   应用程序 - 在 Tomcat 6.0.16 下运行的 Magnolia 站点
*   ISAPI - Tomcat 连接器 isapi_redirect-1.2.28
*   网络服务器 - IIS 7
*   主机操作系统 - Windows 2008

一切正常，直到我尝试访问受保护的 Magnolia 管理部分。Tomcat 返回 HTTP 401 状态代码，身份验证表单作为响应正文，并且在从实际设置所在的本地计算机访问时可以正常工作。

但是，一旦我从另一台主机向管理部分发出请求，我就会收到 IIS 7 提供的本机 401 响应页面。IIS 抑制 Magnolia 登录页面响应，而是提供其静态 401 文件。

404 响应也是如此。我在本地收到 tomcat 404 响应页面，但远程客户端收到 IIS 7 404 页面。

任何想法为什么 IIS 7 在这两种情况下表现不同？

我检查了 isapi 重定向器，无论请求主机地址如何，它都会返回相同的响应。因此，我认为问题出在 IIS 7 上，但不知道应该在哪里查看。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T22:45:59.760

也许您的 web.config 中需要 custom_errors=false。

# iphone - iPhone 3G 连接启用

> ID：800116
> 
> 赞同：2
> 
> 时间：2009-04-28T22:35:43.653
> 
> 标签：iphone

我的应用程序需要 Internet 连接。好像如果我让我的 iPhone 闲置一段时间，它会关闭它的 3G 连接。一旦我唤醒它（滑动解锁）并运行我的应用程序，它就无法连接到互联网。我必须先运行 Youtube 或 Safari，然后它才能连接到 Internet，然后我必须关闭 Youtube/Safari，然后我才能使用我的应用程序登录到我的服务。

您能否让我知道如何从我的应用程序中激活 3G 连接（这样我可以在应用程序从空闲状态唤醒后直接使用我的应用程序，而不必运行其他应用程序，如 Youtube/Safari？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T23:01:38.383

显然还有另一种更好的解决方案，但您可以加载一个空白页面：

```
[NSString stringWithContentsOfUrl ... ] 
```

如有必要，将建立连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T23:16:15.710

要禁用空闲计时器，请查看 UIApplication 类的[idleTimerDisabled 属性](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/UIApplication/idleTimerDisabled)。

来自苹果：

> 此属性的默认值为 NO。当大多数应用程序在短时间内没有用户输入时，系统会将设备置于屏幕变暗的“睡眠”状态。这样做是为了节省电力。但是，除了加速度计之外没有用户输入的应用程序（例如游戏）可以通过将此属性设置为 YES 来禁用“空闲计时器”来避免系统休眠。
> 
> 重要提示：您应该仅在必要时设置此属性，并且应确保在不再需要时将其重置为 NO。大多数应用程序应该让系统在空闲计时器结束时关闭屏幕。这包括音频应用程序。通过适当使用音频会话服务，当屏幕关闭时，播放和录制不会中断。唯一应该禁用空闲计时器的应用程序是映射应用程序、游戏或具有零星用户交互的类似程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T18:25:01.253

只有`NSURLConnection`（以及任何在其之上分层的 API）在从睡眠中唤醒后重新初始化数据连接。`NSURLConnection`要重新初始化数据连接，请创建一个非本地地址的虚拟地址并立即取消它；然后`socket`API 将按预期工作。

开发者论坛上有一个帖子，Apple 开发人员详细解释了这一点（但我目前找不到）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T11:31:16.660

你确定你正确地建立了连接吗？我的应用程序使用套接字执行相同的操作，并且在设备休眠后重新建立连接没有问题。使用 SystemConfiguration 框架中的可达性 API 在覆盖范围可用时获得通知，然后尝试连接。请注意，设备唤醒后必须经过一段时间（从几秒到几分钟）才能获得 Internet 连接，因此请耐心等待。

Apple 提供了 Reachability 示例，还可以在 stackoverflow 中搜索可达性，您会发现更多关于如何实现它的提示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-31T10:21:47.817

实际上，当您在应用程序启动之间更改手机上的网络设置时，您会遇到同样的问题。例如，假设您在启动应用程序时使用 WIFI 连接。然后关闭应用程序并关闭 WIFI，以便设备使用运营商的网络。当您重新启动应用程序时，套接字将无法连接，除非您使用虚拟 NSURLConnection 进行操作（或者您在启动应用程序之前启动浏览器）。

此外，在初始化后立即取消 NSURLConnection（使用 connectionWithRequest 或 initWithRequest）对我不起作用。要么不取消请求，要么在取消之前等待一段时间（例如使用 performSelector:withObject:afterDelay:）。

# ruby-on-rails - Ruby Time.parse 给了我超出范围的错误

> ID：800118
> 
> 赞同：20
> 
> 时间：2009-04-28T22:36:10.893
> 
> 标签：ruby-on-rails, ruby, datetime, time

我正在使用 Time.parse 从字符串创建一个 Time 对象。

由于某些原因

```
Time.parse("05-14-2009 19:00") 
```

导致我们的范围错误的争论，而

```
Time.parse("05-07-2009 19:00") 
```

才不是

有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-28T22:46:39.340

如果您知道字符串的格式，请使用：

```
Time.strptime(date, format, now=self.now) {|year| ...} 
```

[http://www.ruby-doc.org/core-1.9/classes/Time.html#M000266](http://www.ruby-doc.org/core-1.9/classes/Time.html#M000266)

它将解决您的问题，并且可能会比`Time.parse`.

编辑：

看起来他们是`strptime`从 Time 课上学来的，但它还是调用`Date.strptime`了。如果你在 Rails 上，你可以这样做：

```
Date.strptime("05-14-2009 19:00","%m-%d-%Y %H:%M").to_time 
```

如果你使用纯红宝石，那么你需要：

```
require 'date'
d=Date._strptime("05-14-2009 19:00","%m-%d-%Y %H:%M")

Time.utc(d[:year], d[:mon], d[:mday], d[:hour], d[:min], 
         d[:sec], d[:sec_fraction], d[:zone]) 
```

另请参阅：[Ruby on Rails 中的日期和时间格式问题](http://blog.nominet.org.uk/tech/2007/06/14/date-and-time-formating-issues-in-ruby-on-rails/)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-29T11:15:02.317

这是因为`Time#parse`.

这是由于英美格式。

使用破折号“-”它需要 mm-dd-yyyy，使用斜线“/”它需要 dd/mm/yyyy。

此行为在 1.9 中有意*更改。*完成 eur、iso 和 jp 日期标准。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-28T22:39:48.013

我的猜测是它期望字符串的第二部分（14）是月份。

[此链接可以帮助您解析它。](http://www.ruby-forum.com/topic/184961)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T11:32:21.290

你可能不需要它来解决这个问题，但我仍然建议查看自然语言日期/时间解析器[Chronic](http://chronic.rubyforge.org/)，它为我节省了很多工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T22:41:44.810

它可能需要日-月-年格式，因此您的第一个值是尝试指定第 14 个月的第 5 天。

# javascript - 根据另一个数组的内容过滤数组的最有效方法是什么？

> ID：800121
> 
> 赞同：1
> 
> 时间：2009-04-28T22:36:52.013
> 
> 标签：javascript, arrays, filtering

假设我有两个数组，items 和 removeItems，我希望从 item 中删除 removeItems 中找到的任何值。

蛮力机制可能是：

```
var animals = ["cow","dog","frog","cat","whale","salmon","zebra","tuna"];
var nonMammals = ["salmon","frog","tuna","spider"];
var mammals = [];
var isMammal;

for(var i=0;i<animals.length;i++){
   isMammal = true;
   for(var j=0;j<nonMammals;j++){
     if(nonMammals[j] === animals[i]){
       isMammal = false;
       break;
     }
   }
   if(isMammal){
     mammals.push(animals[i]);
   }
} 
```

这是什么？O(N^2)? 有没有更有效的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T22:56:35.023

基本上你想要做的是有效地计算集合差 S \ T。我知道的（渐近）最快的方法是将 T 放入一个哈希图中（这使得 |T| 步骤）并遍历 S 中的每个 s（这使得 | S| 步骤）检查 s 是否在 T 中（即 O(1)）。所以你得到了 O(|T| + |S|) 步骤。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T22:43:28.690

原来如此`O(M * N)`。

可能您可以先对数组进行更好的排序`animals`，然后再进行二进制搜索。你将能够减少到`O(N * log N)`- 好吧，`log N < M`无论如何。

无论如何，如果您正在使用 JS 并且在客户端运行，那么只需尝试将数据量保持在最低限度，否则他们的浏览器会在每次请求时对您大喊大叫。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T22:47:56.900

使用 jQuery 非常简单：

```
function is_mammal(animal)
{
    return $.inArray(animal, nonMammals) == -1;
}

mammals = $.grep(animals, is_mammal); 
```

请参阅[`$.grep`](http://docs.jquery.com/Utilities/jQuery.grep#arraycallbackinvert)和的文档[`$.inArray`](http://docs.jquery.com/Utilities/jQuery.inArray#valuearray)。

# ruby - 将字符串转换为哈希符号的最佳方法

> ID：800122
> 
> 赞同：273
> 
> 时间：2009-04-28T22:37:10.330
> 
> 标签：ruby, hashmap

将哈希中的所有键从字符串转换为 Ruby 中的符号的（最快/最干净/直接）方法是什么？

这在解析 YAML 时会很方便。

```
my_hash = YAML.load_file('yml') 
```

我希望能够使用：

```
my_hash[:key] 
```

而不是：

```
my_hash['key'] 
```

* * *

## 回答 #1

> 赞同：316
> 
> 时间：2009-05-21T00:14:58.493

如果您使用的是 Rails，这是一个更好的方法：

参数。[符号化键](http://api.rubyonrails.org/classes/Hash.html#method-i-symbolize_keys)

结束。

如果你不是，只需撕掉他们的代码（它也在链接中）：

```
myhash.keys.each do |key|
  myhash[(key.to_sym rescue key) || key] = myhash.delete(key)
end 
```

* * *

## 回答 #2

> 赞同：305
> 
> 时间：2009-04-29T01:17:06.357

在**Ruby >= 2.5** ( [docs](https://ruby-doc.org/core-2.5.0/Hash.html#method-i-transform_keys) ) 中，您可以使用：

```
my_hash.transform_keys(&:to_sym) 
```

使用较旧的 Ruby 版本？这是一个单行代码，它将哈希复制到一个带有符号化键的新行中：

```
my_hash = my_hash.inject({}){|memo,(k,v)| memo[k.to_sym] = v; memo} 
```

使用**Rails**，您可以使用：

```
my_hash.symbolize_keys
my_hash.deep_symbolize_keys 
```

* * *

## 回答 #3

> 赞同：115
> 
> 时间：2009-12-18T07:48:41.520

对于 Ruby 中 YAML 的特定情况，如果键以 ' ' 开头`:`，它们将被自动作为符号进行实习。

```
需要'yaml'
需要'pp'
yaml_str = "
连接：
  - 主机：host1.example.com
    端口：10000
  - 主机：host2.example.com
    端口：20000
"
yaml_sym = "
：连接：
  - ：主机：host1.example.com
    ：端口：10000
  - ：主机：host2.example.com
    ：端口：20000
"
pp yaml_str = YAML.load(yaml_str)
把 yaml_str.keys.first.class
pp yaml_sym = YAML.load(yaml_sym)
把 yaml_sym.keys.first.class

```

输出：

```
# /opt/ruby-1.8.6-p287/bin/ruby ~/test.rb
{“连接”=>
  [{"port"=>10000, "host"=>"host1.example.com"},
   {"port"=>20000, "host"=>"host2.example.com"}]}
细绳
{:连接=>
  [{:port=>10000, :host=>"host1.example.com"},
   {:port=>20000, :host=>"host2.example.com"}]}
象征

```

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2011-08-27T06:02:35.843

如果您使用的是 Rails，它会简单得多 - 您可以使用 HashWithIndifferentAccess 并以字符串和符号的形式访问键：

```
my_hash.with_indifferent_access 
```

也可以看看：

[http://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html](http://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html)

* * *

或者，您可以使用很棒的“Ruby Facets”Gem，它包含许多对 Ruby 核心和标准库类的扩展。

```
 require 'facets'
  > {'some' => 'thing', 'foo' => 'bar'}.symbolize_keys
    =>  {:some=>"thing", :foo=>"bar} 
```

另见： [http ://rubyworks.github.io/rubyfaux/?doc=http://rubyworks.github.io/facets/docs/facets-2.9.3/core.json#api-class-Hash](http://rubyworks.github.io/rubyfaux/?doc=http://rubyworks.github.io/facets/docs/facets-2.9.3/core.json#api-class-Hash)

* * *

## 回答 #5

> 赞同：64
> 
> 时间：2012-04-10T14:20:00.793

更简洁：

```
Hash[my_hash.map{|(k,v)| [k.to_sym,v]}] 
```

* * *

## 回答 #6

> 赞同：58
> 
> 时间：2018-01-22T00:15:30.137

因为`Ruby 2.5.0`你可以使用[`Hash#transform_keys`](http://ruby-doc.org/core-2.5.0/Hash.html#method-i-transform_keys)or [`Hash#transform_keys!`](http://ruby-doc.org/core-2.5.0/Hash.html#method-i-transform_keys-21)。

```
{'a' => 1, 'b' => 2}.transform_keys(&:to_sym) #=> {:a => 1, :b => 2} 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2014-04-23T12:06:41.120

[http://api.rubyonrails.org/classes/Hash.html#method-i-symbolize_keys](http://api.rubyonrails.org/classes/Hash.html#method-i-symbolize_keys)

```
hash = { 'name' => 'Rob', 'age' => '28' }
hash.symbolize_keys
# => { name: "Rob", age: "28" } 
```

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2012-08-03T01:30:28.997

这是一种深度符号化对象的方法

```
def symbolize(obj)
    return obj.inject({}){|memo,(k,v)| memo[k.to_sym] =  symbolize(v); memo} if obj.is_a? Hash
    return obj.inject([]){|memo,v    | memo           << symbolize(v); memo} if obj.is_a? Array
    return obj
end 
```

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2018-05-04T11:19:05.663

如果您使用的是 json，并且想将其用作哈希，那么在核心 Ruby 中您可以这样做：

```
json_obj = JSON.parse(json_str, symbolize_names: true) 
```

**symbolize_names**：如果设置为 true，则返回 JSON 对象中名称（键）的符号。否则返回字符串。字符串是默认值。

文档：[Json#parse symbolize_names](http://ruby-doc.org/stdlib-2.0.0/libdoc/json/rdoc/JSON.html#method-i-parse)

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2009-05-21T00:27:46.923

我真的很喜欢[Mash](http://www.intridea.com/2008/4/12/mash-mocking-hash-for-total-poser-objects?blog=company)宝石。

你可以做`mash['key']`, 或`mash[:key]`, 或`mash.key`

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2010-12-31T05:43:06.440

`params.symbolize_keys`也将工作。此方法将散列键转换为符号并返回一个新的散列。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2013-04-04T15:32:18.213

对@igorsales 答案的修改

```
class Object
  def deep_symbolize_keys
    return self.inject({}){|memo,(k,v)| memo[k.to_sym] = v.deep_symbolize_keys; memo} if self.is_a? Hash
    return self.inject([]){|memo,v    | memo           << v.deep_symbolize_keys; memo} if self.is_a? Array
    return self
  end
end 
```

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2017-10-31T10:40:18.357

在 Rails 中，您可以使用：

```
{'g'=> 'a', 2 => {'v' => 'b', 'x' => { 'z' => 'c'}}}.deep_symbolize_keys! 
```

转换为：

```
{:g=>"a", 2=>{:v=>"b", :x=>{:z=>"c"}}} 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2016-05-19T22:30:02.190

这里有很多答案，但一种方法 rails 功能是`hash.symbolize_keys`

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2016-08-19T17:05:51.057

这是我的嵌套哈希的一个衬里

```
def symbolize_keys(hash)
  hash.each_with_object({}) { |(k, v), h| h[k.to_sym] = v.is_a?(Hash) ? symbolize_keys(v) : v }
end 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2017-07-16T22:55:07.770

如果您需要这样做的**原因**是因为您的数据最初来自 JSON，您可以通过在`:symbolize_names`摄取 JSON 时传入选项来跳过任何此解析。

不需要 Rails 并且适用于 Ruby >1.9

```
JSON.parse(my_json, :symbolize_names => true) 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2009-04-28T23:20:14.843

您可能很懒惰，并将其包装在`lambda`：

```
my_hash = YAML.load_file('yml')
my_lamb = lambda { |key| my_hash[key.to_s] }

my_lamb[:a] == my_hash['a'] #=> true 
```

但这仅适用于从哈希中读取 - 而不是写入。

为此，您可以使用`Hash#merge`

```
my_hash = Hash.new { |h,k| h[k] = h[k.to_s] }.merge(YAML.load_file('yml')) 
```

init 块将按需转换一次键，但如果您在访问符号版本后更新键的字符串版本的值，则不会更新符号版本。

```
irb> x = { 'a' => 1, 'b' => 2 }
#=> {"a"=>1, "b"=>2}
irb> y = Hash.new { |h,k| h[k] = h[k.to_s] }.merge(x)
#=> {"a"=>1, "b"=>2}
irb> y[:a]  # the key :a doesn't exist for y, so the init block is called
#=> 1
irb> y
#=> {"a"=>1, :a=>1, "b"=>2}
irb> y[:a]  # the key :a now exists for y, so the init block is isn't called
#=> 1
irb> y['a'] = 3
#=> 3
irb> y
#=> {"a"=>3, :a=>1, "b"=>2} 
```

您也可以让 init 块不更新哈希，这样可以保护您免受此类错误的影响，但您仍然容易受到相反的影响 - 更新符号版本不会更新字符串版本：

```
irb> q = { 'c' => 4, 'd' => 5 }
#=> {"c"=>4, "d"=>5}
irb> r = Hash.new { |h,k| h[k.to_s] }.merge(q)
#=> {"c"=>4, "d"=>5}
irb> r[:c] # init block is called
#=> 4
irb> r
#=> {"c"=>4, "d"=>5}
irb> r[:c] # init block is called again, since this key still isn't in r
#=> 4
irb> r[:c] = 7
#=> 7
irb> r
#=> {:c=>7, "c"=>4, "d"=>5} 
```

所以要注意这些是在两种关键形式之间切换。坚持一个。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-04-28T22:49:35.133

会像以下工作吗？

```
new_hash = Hash.new
my_hash.each { |k, v| new_hash[k.to_sym] = v } 
```

它会复制哈希，但大多数时候你不会关心它。可能有一种方法可以在不复制所有数据的情况下做到这一点。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2014-01-16T15:34:00.977

更短的单线 fwiw：

```
my_hash.inject({}){|h,(k,v)| h.merge({ k.to_sym => v}) } 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2010-12-17T13:57:05.233

这个怎么样：

```
my_hash = HashWithIndifferentAccess.new(YAML.load_file('yml'))

# my_hash['key'] => "val"
# my_hash[:key]  => "val" 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2015-10-24T13:23:02.730

这适用于使用`mruby`但未定义任何`symbolize_keys`方法的人：

```
class Hash
  def symbolize_keys!
    self.keys.each do |k|
      if self[k].is_a? Hash
        self[k].symbolize_keys!
      end
      if k.is_a? String
        raise RuntimeError, "Symbolizing key '#{k}' means overwrite some data (key :#{k} exists)" if self[k.to_sym]
        self[k.to_sym] = self[k]
        self.delete(k)
      end
    end
    return self
  end
end 
```

方法：

*   仅表示键`String`
*   如果符号化一个字符串意味着丢失一些信息（覆盖哈希的一部分）引发一个`RuntimeError`
*   symbolize 也递归包含哈希
*   返回符号化的哈希
*   **工作到位！**

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2015-07-05T08:20:01.107

# 我们要更改的数组。

字符串 = [“HTML”、“CSS”、“JavaScript”、“Python”、“Ruby”]

# 创建一个新变量作为空数组，以便我们可以“.push”其中的符号。

符号 = [ ]

# 这是我们用块定义方法的地方。

字符串。每个 {|x| 符号.push(x.intern)}

# 代码结束。

所以这可能是在 Ruby 中将字符串转换为数组中符号的最直接的方法。创建一个字符串数组，然后创建一个新变量并将该变量设置为一个空数组。然后选择您使用“.each”方法创建的第一个数组中的每个元素。然后使用块代码“.push”新数组中的所有元素，并使用“.intern 或 .to_sym”将所有元素转换为符号。

符号更快，因为它们在您的代码中节省了更多内存，并且您只能使用它们一次。符号最常用于哈希中的键，这很棒。我不是最好的 ruby​​ 程序员，但这种形式的代码对我帮助很大。如果有人知道更好的方法，请分享，你也可以使用这种方法进行哈希！

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2015-11-27T09:26:19.963

如果您想要香草红宝石解决方案并且因为我无法访问`ActiveSupport`这里是深度符号解决方案（与以前的非常相似）

```
 def deep_convert(element)
      return element.collect { |e| deep_convert(e) } if element.is_a?(Array)
      return element.inject({}) { |sh,(k,v)| sh[k.to_sym] = deep_convert(v); sh } if element.is_a?(Hash)
      element
    end 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-11-22T00:57:04.650

从**Psych** 3.0 开始，您可以添加[symbolize_names:](https://github.com/ruby/psych/commit/88ad4d50169306f4120ed41a1de9f081255c50fa)选项

`Psych.load("---\n foo: bar") # => {"foo"=>"bar"}`

`Psych.load("---\n foo: bar", symbolize_names: true) # => {:foo=>"bar"}`

注意：如果您的 Psych 版本低于 3.0 `symbolize_names:`，则会被忽略。

我的 Ubuntu 18.04 包含开箱即用的 ruby​​ 2.5.1p57

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-07-24T09:41:00.193

```
ruby-1.9.2-p180 :001 > h = {'aaa' => 1, 'bbb' => 2}
 => {"aaa"=>1, "bbb"=>2} 
ruby-1.9.2-p180 :002 > Hash[h.map{|a| [a.first.to_sym, a.last]}]
 => {:aaa=>1, :bbb=>2} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-06-03T06:02:09.290

这不完全是单行的，但它将所有字符串键转换为符号，也是嵌套的：

```
def recursive_symbolize_keys(my_hash)
  case my_hash
  when Hash
    Hash[
      my_hash.map do |key, value|
        [ key.respond_to?(:to_sym) ? key.to_sym : key, recursive_symbolize_keys(value) ]
      end
    ]
  when Enumerable
    my_hash.map { |value| recursive_symbolize_keys(value) }
  else
    my_hash
  end
end 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-07-02T16:05:49.213

当我不使用 Rails 时，我喜欢这种单线，因为这样我就不必在处理它时进行第二次散列并保存两组数据：

```
my_hash = { "a" => 1, "b" => "string", "c" => true }

my_hash.keys.each { |key| my_hash[key.to_sym] = my_hash.delete(key) }

my_hash
=> {:a=>1, :b=>"string", :c=>true} 
```

Hash#delete 返回被删除键的值

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-11-02T07:12:01.357

[Facets 的 Hash#deep_rekey](http://www.rubydoc.info/github/rubyworks/facets/Hash#deep_rekey-instance_method)也是一个不错的选择，尤其是：

*   如果您发现项目中的其他糖分方面有用，
*   如果您更喜欢代码可读性而不是神秘的单行代码。

样本：

```
require 'facets/hash/deep_rekey'
my_hash = YAML.load_file('yml').deep_rekey 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-08-02T04:02:51.197

在 ruby​​ 中，我发现这是将哈希中的字符串键转换为符号的最简单易懂的方法：

```
my_hash.keys.each { |key| my_hash[key.to_sym] = my_hash.delete(key)} 
```

对于散列中的每个键，我们在其上调用 delete 将其从散列中删除（也 delete**返回与已删除键关联的值**），我们立即将其设置为等于符号化键。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2018-10-17T01:29:58.377

与以前的解决方案类似，但编写方式略有不同。

*   这允许嵌套和/或具有数组的哈希。
*   将键转换为字符串作为奖励。
*   代码不会改变传入的哈希值。

    ```
    module HashUtils
      def symbolize_keys(hash)
        transformer_function = ->(key) { key.to_sym }
        transform_keys(hash, transformer_function)
      end

      def stringify_keys(hash)
        transformer_function = ->(key) { key.to_s }
        transform_keys(hash, transformer_function)
      end

      def transform_keys(obj, transformer_function)
        case obj
        when Array
          obj.map{|value| transform_keys(value, transformer_function)}
        when Hash
          obj.each_with_object({}) do |(key, value), hash|
            hash[transformer_function.call(key)] = transform_keys(value, transformer_function)
          end
        else
          obj
        end
      end
    end 
    ```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2016-02-16T14:11:53.520

symbolize_keys 递归地用于任何哈希：

```
class Hash
  def symbolize_keys
    self.is_a?(Hash) ? Hash[ self.map { |k,v| [k.respond_to?(:to_sym) ? k.to_sym : k, v.is_a?(Hash) ? v.symbolize_keys : v] } ] : self
  end
end 
```

# cocoa-touch - 在 iOS 2.0 上验证电子邮件地址的最佳做法是什么

> ID：800123
> 
> 赞同：168
> 
> 时间：2009-04-28T22:37:24.807
> 
> 标签：cocoa-touch, email-validation, iphone-sdk-2

验证用户在 iOS 2.0 上输入的电子邮件地址的最简洁方法是什么？

**注意**：这是一个特定于 iOS 2.0 的历史问题，并且由于它的年龄以及与之相关的其他问题的数量，它不能被淘汰，并且不得更改为“现代”问题。

* * *

## 回答 #1

> 赞同：354
> 
> 时间：2009-07-19T13:24:03.577

[使用正则表达式验证电子邮件地址](https://stackoverflow.com/a/201378/23028)的答案非常详细地解释了 RFC 5322 中指定的语法对于原始正则表达式来说太复杂了。

**我推荐一种真正的解析器方法，例如[MKEmailAddress](https://github.com/smorr/MKEmailAddress/tree/master/Source/MKEMailAddress)。**

作为快速正则表达式解决方案，请参阅 [DHValidation](http://github.com/benofsky/DHValidation)的此修改：

```
- (BOOL) validateEmail: (NSString *) candidate {
    NSString *emailRegex =
@"(?:[a-z0-9!#$%\\&'*+/=?\\^_`{|}~-]+(?:\\.[a-z0-9!#$%\\&'*+/=?\\^_`{|}"
@"~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\"
@"x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-"
@"z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5"
@"]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-"
@"9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21"
@"-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])"; 
    NSPredicate *emailTest = [NSPredicate predicateWithFormat:@"SELF MATCHES[c] %@", emailRegex]; 

    return [emailTest evaluateWithObject:candidate];
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-28T22:58:13.617

阅读 RFC。几乎所有认为自己知道如何解析/清理/验证电子邮件地址的人都是错误的。

[https://www.rfc-editor.org/rfc/rfc2822](https://www.rfc-editor.org/rfc/rfc2822) 第 3.4.1 节非常有用。注意

```
dtext = NO-WS-CTL / ; 非空白控件

                        %d33-90 / ; US-ASCII 的其余部分
                        %d94-126 ; 不包括“[”的字符，
                                        ; “]“， 或者 ”\”

```

是的，这意味着 +、' 等都是合法的。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-29T14:33:47.393

到目前为止，我找到的最好的解决方案（也是我最终选择的解决方案）是将[RegexKitLite](http://regexkit.sourceforge.net/RegexKitLite "正则表达式工具包")添加到项目中，该项目可以通过 NSString 类别访问正则表达式。

添加到项目中非常轻松，一旦到位，任何正则表达式电子邮件验证逻辑都将起作用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-28T23:04:40.433

一个好的开始是决定你想接受什么，不想接受什么作为电子邮件地址？

99% 的电子邮件地址如下所示：bob.smith@foo.com 或 fred@bla.edu

但是，拥有这样的电子邮件地址在技术上是合法的：f `!#$%&'*+-/=?^_`{|}~"ha!"@com

对于顶级域，世界上可能只有少数有效的电子邮件，而且几乎没有人使用大多数其他字符（尤其是引号和反引号），因此您可能想假设这些都是无效的事情。但你应该这样做是有意识的决定。

除此之外，按照 Paul 所说的去做，并尝试将输入匹配到这样的正则表达式：^[A-Z0-9._%+-]+@[A-Z0-9.-]+.[AZ]{ 2,}$

那一个几乎可以匹配每个人的电子邮件地址。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-28T23:09:26.320

虽然专注于正则表达式是好的，但这只是第一步，也是必要的一步。还有其他步骤也需要考虑一个好的验证策略。

我头上的两件事是：

1.  DNS 验证以确保域确实存在。

2.  在 dns 验证后，您还可以选择进行 smtp 验证。向 smtp 服务器发送调用以查看用户是否实际存在。

通过这种方式，您可以捕获各种用户错误并确保它是有效的电子邮件。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-15T00:09:40.237

此功能很简单，但更彻底地检查电子邮件地址。例如，根据 RFC2822，电子邮件地址不得连续包含两个句点，例如 firstname..lastname@domain..com

如本函数所示，在正则表达式中使用锚点也很重要。没有锚，以下电子邮件地址被认为是有效的：*first;name)lastname@domain.com(blah*因为*lastname@domain.com*部分是有效的，忽略*first;name)*在开头和*(blah*在结尾。锚强制正则表达式引擎来验证整个电子邮件。

此函数使用 iOS 2 中不存在的 NSPredicate。不幸的是，它可能无法帮助提问者，但希望能帮助其他人使用更新版本的 iOS。不过，这个函数中的正则表达式仍然可以应用于 iOS 2 中的 RegExKitLite。而对于那些使用 iOS 4 或更高版本的用户，这些正则表达式可以使用 NSRegularExpression 来实现。

```
- (BOOL)isValidEmail:(NSString *)email
{
    NSString *regex1 = @"\\A[a-z0-9]+([-._][a-z0-9]+)*@([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,4}\\z";
    NSString *regex2 = @"^(?=.{1,64}@.{4,64}$)(?=.{6,100}$).*";
    NSPredicate *test1 = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", regex1];
    NSPredicate *test2 = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", regex2];
    return [test1 evaluateWithObject:email] && [test2 evaluateWithObject:email];
} 
```

请参阅[在 Objective-C 中使用正则表达式验证电子邮件地址](http://seaf-email.blogspot.com/p/code.html#objectivec)。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-12-30T11:44:56.057

```
NSString *emailString = textField.text; **// storing the entered email in a string.** 
**// Regular expression to checl the email format.** 
NSString *emailReg = @"[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}"; 
NSPredicate *emailTest = [NSPredicate predicateWithFormat:@"SELF MATCHES %@",emailReg]; 
if (([emailTest evaluateWithObject:emailString] != YES) || [emailStringisEqualToString:@""]) 
{ 
UIAlertView *loginalert = [[UIAlertView alloc] initWithTitle:@" Enter Email in" message:@"abc@example.com format" delegate:self 
cancelButtonTitle:@"OK" otherButtonTitles:nil]; 

enter code here

[loginalert show]; 
[loginalert release]; 
} 
If email is invalid, it will remind the user with an alert box. 
Hope this might be helpful for you all. 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-28T22:42:20.393

我发现使用正则表达式可以很好地验证电子邮件地址。

正则表达式的主要缺点当然是可维护性，所以要像以前从未评论过的那样评论。我向你保证，如果你不这样做，你会希望你在几周后回到这个表情时做到这一点。

这是一个很好的来源的链接，[http://www.regular-expressions.info/email.html](http://www.regular-expressions.info/email.html)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-11-15T15:11:22.723

挖掘污垢，但我只是偶然发现了[SHEmailValidator](https://github.com/spothero/SHEmailValidator)，它做得非常好，界面也很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-03-12T10:36:17.767

许多网站都提供正则表达式，但您最好学习和理解它们，并在官方 RFC 中验证您希望它做的事情是否满足您对电子邮件地址格式的需求。

对于学习 RegEx，解释语言可以是一个很好的简化器和测试平台。Rubular 是基于 Ruby 构建的，但它是一种很好的快速测试和验证方法： [http ://www.rubular.com/](http://www.rubular.com/)

除此之外，还可以购买最新版的 O'Reilly 书籍 Mastering Regular Expressions。您需要花时间理解前 3 或 4 章。之后的一切都将建立高度优化的 RegEx 使用方面的专业知识。

通常，一系列更小、更易于管理的 RegEx 更易于维护和调试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-16T19:39:12.477

这是在 Swift 中验证电子邮件的 String 的扩展。

```
extension String {

    func isValidEmail() -> Bool {
        let stricterFilter = false
        let stricterFilterString = "^[A-Z0-9a-z\\._%+-]+@([A-Za-z0-9-]+\\.)+[A-Za-z]{2,4}$"
        let laxString = "^.+@([A-Za-z0-9-]+\\.)+[A-Za-z]{2}[A-Za-z]*$"
        let emailRegex = stricterFilter ? stricterFilterString : laxString
        let emailTest = NSPredicate(format: "SELF MATCHES %@", emailRegex)
        return emailTest.evaluate(with: self)
    }
} 
```

从答案复制到：[检查电子邮件地址在 iOS 上是否有效](https://stackoverflow.com/questions/3139619/check-that-an-email-address-is-valid-on-ios)

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-09-05T21:12:07.400

您不应该尝试使用正则表达式来验证电子邮件。随着 TLD 不断变化，您的验证器要么不完整，要么不准确。相反，您应该利用 Apple 的`NSDataDetector`库来获取字符串并尝试查看是否有任何已知的数据字段（电子邮件、地址、日期等）。Apple 的 SDK 将承担与 TLD 保持同步的繁重工作，您可以借助他们的努力！！:)

另外，如果 iMessage（或任何其他文本字段）认为它不是电子邮件，您是否应该考虑电子邮件？

我将此函数放在一个`NSString`类别中，因此您要测试的字符串是`self`.

```
- (BOOL)isValidEmail {
    // Trim whitespace first
    NSString *trimmedText = [self stringByTrimmingCharactersInSet:NSCharacterSet.whitespaceAndNewlineCharacterSet];
    if (self && self.length > 0) return NO;

    NSError *error = nil;
    NSDataDetector *dataDetector = [[NSDataDetector alloc] initWithTypes:NSTextCheckingTypeLink error:&error];
    if (!dataDetector) return NO;

    // This string is a valid email only if iOS detects a mailto link out of the full string
    NSArray<NSTextCheckingResult *> *allMatches = [dataDetector matchesInString:trimmedText options:kNilOptions range:NSMakeRange(0, trimmedText.length)];
    if (error) return NO;
    return (allMatches.count == 1 && [[[allMatches.firstObject URL] absoluteString] isEqual:[NSString stringWithFormat:@"mailto:%@", self]]);
} 
```

或作为快速`String`扩展

```
extension String {
    func isValidEmail() -> Bool {
        let trimmed = self.trimmingCharacters(in: .whitespacesAndNewlines)
        guard !trimmed.isEmpty, let dataDetector = try? NSDataDetector(types: NSTextCheckingResult.CheckingType.link.rawValue) else {
            return false
        }
        let allMatches = dataDetector.matches(in: trimmed, options: [], range: NSMakeRange(0, trimmed.characters.count))

        return allMatches.count == 1 && allMatches.first?.url?.absoluteString == "mailto:\(trimmed)"
    }
} 
```

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2014-05-19T14:49:14.607

```
// Method Call
NSString *email = @"Your Email string..";

BOOL temp = [self validateEmail:email];

if(temp)
{
// Valid
}
else
{
// Not Valid
}
// Method description

- (BOOL) validateEmail: (NSString *) email {
    NSString *emailRegex = @"[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}";
    NSPredicate *emailTest = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", emailRegex];
    BOOL isValid = [emailTest evaluateWithObject:email];
    return isValid;
} 
```

# sql-server - 指定 HASH JOIN 比仅执行 JOIN 的优势？

> ID：800124
> 
> 赞同：15
> 
> 时间：2009-04-28T22:37:57.580
> 
> 标签：sql-server, tsql, join, sql-server-2005, join-hints

与常规 JOIN（其中 SQL Server 将决定最佳 JOIN 策略）相比，显式执行 HASH JOIN 有哪些优点（如果有）？例如：

```
select pd.*
from profiledata pd
inner hash join profiledatavalue val on val.profiledataid=pd.id 
```

在上面的简单示例代码中，我指定了 JOIN 策略，而如果我不使用“hash”关键字，SQL Server 将在后台执行 MERGE JOIN（根据“实际执行计划”）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T04:08:59.173

优化器在日常使用中做得足够好。但是，理论上，极端情况下可能需要 3 周的时间才能找到完美的计划，因此生成的计划有可能并不理想。

除非您有一个非常复杂的查询或大量数据，而它根本无法产生一个好的计划，否则我会不理会它。那我会考虑的。

但是随着时间的推移，随着数据的变化/增长或索引的变化等，您的 JOIN 提示将变得过时并阻止最佳计划。JOIN 提示只能在开发时使用您拥有的那组数据针对该单个查询进行优化。

就个人而言，我从未在任何生产代码中指定 JOIN 提示。

我通常通过更改查询、添加/更改索引或分解它（例如先加载临时表）来解决错误的连接。或者我的查询是错误的，或者我有一个隐式的数据类型转换，或者它突出了我的架构中的一个缺陷等。

我见过其他开发人员使用它们，但仅在复杂视图嵌套在复杂视图上的情况下使用它们，并且在重构时会导致以后出现问题。

编辑：

我今天进行了一次转换，一些同事将使用它们来强制执行错误的查询计划（使用 NOLOCK 和 MAXDOP 1），以“鼓励”从其下游系统之一直接调用的遗留复杂嵌套视图迁移。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T19:36:57.680

何时尝试哈希提示，如何：

*   在检查至少一个表上存在足够的索引之后。
*   在尝试重新安排查询之后。诸如将连接转换为“in”或“exists”、更改连接顺序（无论如何这只是一个提示）、将逻辑从 where 子句移动到连接条件等。

关于哈希连接何时有效的一些基本规则是连接条件不作为表索引存在以及表大小不同时。如果您正在寻找技术描述，那么有一些关于哈希连接如何工作的很好的描述。

为什么要使用任何连接提示（具有强制顺序副作用的哈希/合并/循环）？

*   为了避免极端情况的执行速度极慢（.5 -> 10.0s）。
*   当优化器始终选择一个平庸的计划时。

提供的提示在某些情况下可能并不理想，但提供了更一致的可预测运行时。使用提示时，应预先测试预期的最坏情况和最佳情况。可预测的运行时间对于 Web 服务至关重要，例如，严格优化的标称 [.3s, .6s] 查询优于范围 [.25, 10.0s] 的查询。随着统计数据的最新更新和最佳实践的遵循，可能会发生较大的运行时差异。

在开发环境中进行测试时，还应关闭“作弊”以避免热/冷运行时差异。从另一个[帖子](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/cd966057-269b-4ca1-b6db-a74edf849330/)...

```
CHECKPOINT -- flushes dirty pages to disk
DBCC DROPCLEANBUFFERS -- clears data cache
DBCC FREEPROCCACHE -- clears execution plan cache 
```

最后一个选项可能与 option(recompile) 提示相同。

机器的 MAXDOP 和加载也会在运行时产生巨大的差异。将 CTE 物化到临时表中也是一种很好的锁定机制，需要考虑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T23:04:13.290

哈希联接比任何其他联接都具有更好的并行性和可扩展性，并且非常适合最大化数据仓库中的吞吐量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T16:57:39.153

我在运输代码中看到的唯一提示是 OPTION（强制订购）。SQL 查询优化器中的愚蠢错误会生成一个尝试加入未过滤的 varchar 和唯一标识符的计划。添加 FORCE ORDER 导致它首先运行过滤器。

我知道，重载列是不好的。有时，你必须忍受它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T23:03:54.540

逻辑计划优化器并不能保证它会找到最佳解决方案：精确算法太慢而无法在生产服务器中使用；取而代之的是一些贪心算法。

因此，这些命令背后的基本原理是让用户指定最佳连接策略，以防优化器无法找出真正最好采用的策略。

# asp-classic - 如何阻止 Chrome 在我的文本区域中添加额外的换行符？

> ID：800127
> 
> 赞同：4
> 
> 时间：2009-04-28T22:40:19.260
> 
> 标签：asp-classic, textarea, line-breaks

我在 asp 中有一个表单，它会在用户将表单信息提交到我们的数据库之前对其进行一些 javascript 错误检查，从而显示表单信息的预览。为了在提交之前启用轻格式，我们用标签替换所有换行符。

```
<textarea name="DATA_Description" ROWS=30 wrap=on cols="30"><%=DATA_Description%></textarea> 
```

将换行符替换为

```
<%=replace(DATA_Description,vbcr,"<BR>")%> 
```

这适用于除 Chrome 之外的所有浏览器。Chrome 在文本区域的每一行末尾插入一个额外的换行符。我们在具有多种字体样式的多个宽度区域中使用文本，因此我需要仅在用户实际输入硬回车时才出现换行符...

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T22:45:00.230

您只替换回车而不是换行，它们显示在文本区域中。如果 Windows 上的 Chrome 使用 CRLF 而不是简单的 LF，我不会感到惊讶，而且我不希望只使用 CR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T18:13:52.590

当我从存储在数据库中的文本区域获取数据并希望将其显示为 html 而不是返回文本区域时（就像你一样使用替换），我总是使用 vbcrlf 而不是 vbcr。

我从未测试过如果我使用的操作系统是 Linux 或 Mac 会发生什么，它们都只使用 LF 而不是 CRLF（当时不必担心 Mac 和 Linux 支持）。现在我想起来了，我想知道使用 CRLF 或 LF 是否属于 HTML 规范的一部分，并且在任何 textarea 的所有操作系统中都是相同的？嗯。

# c# - WPF中字典的双向数据绑定

> ID：800130
> 
> 赞同：26
> 
> 时间：2009-04-28T22:41:10.117
> 
> 标签：c#, wpf, data-binding, xaml, dictionary

我想将 a 绑定`Dictionary<string, int>`到`ListView`WPF 中的 a 。我想通过数据绑定机制获取更新`Values`的方式来执行此操作。`Dictionary`我不想改变`Keys`只是`Values`. 我也不关心向`Dictionary`. 我只想更新现有的。

将 Dictionary 设置为`ItemsSource`of`ListView`并不能做到这一点。它不起作用，因为`ListView`使用枚举器访问的内容`Dictionary`和该枚举的元素是不可变的`KeyValuePair`对象。

我目前的调查线试图使用该`Keys`物业。我将此分配给`ItemsSource`我的`ListView`. 这确实允许我显示，`Keys`但我对 WPF 的数据绑定机制了解不足，无法访问`Values`.`Dictionary`

我发现了这个问题：[Access codebehind variable in XAML](https://stackoverflow.com/questions/666856/access-codebehind-variable-in-xaml)但似乎仍然无法弥合差距。

你们中有人知道如何使这种方法起作用吗？有没有人有更好的方法？

看起来，作为最后的手段，我可​​以构建一个自定义对象并将其粘贴在`List`我从中重新创建/更新我的对象中，`Dictionary`但这似乎是一种绕过内置数据绑定功能而不是有效利用它的方法。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-28T23:04:59.387

我不认为你能用字典做你想做的事。

1.  因为 Dictionary 没有实现 INotifyPropertyChanged 或 INotifyCollectionChanged
2.  因为它不会像你想要的那样允许双向绑定。

我不确定它是否完全符合您的要求，但我会使用`ObservableCollection`, 和自定义类。

我正在使用 DataTemplate 来展示如何以两种方式对值进行绑定。

当然在这个实现中没有使用 Key，所以你可以只使用`ObservableCollection<int>`

自定义类

```
public class MyCustomClass
{
    public string Key { get; set; }
    public int Value { get; set; }
} 
```

设置 ItemsSource

```
ObservableCollection<MyCustomClass> dict = new ObservableCollection<MyCustomClass>();
dict.Add(new MyCustomClass{Key = "test", Value = 1});
dict.Add(new MyCustomClass{ Key = "test2", Value = 2 });
listView.ItemsSource = dict; 
```

XAML

```
<Window.Resources>
    <DataTemplate x:Key="ValueTemplate">
        <TextBox Text="{Binding Value}" />
    </DataTemplate>
</Window.Resources>
<ListView Name="listView">
    <ListView.View>
        <GridView>
            <GridViewColumn CellTemplate="{StaticResource ValueTemplate}"/>
        </GridView>
    </ListView.View>
</ListView> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T19:38:24.617

这有点 hacky，但我让它工作（假设我明白你想要什么）。

我首先创建了一个视图模型类：

```
class ViewModel : INotifyPropertyChanged
{
    public ViewModel()
    {
        this.data.Add(1, "One");
        this.data.Add(2, "Two");
        this.data.Add(3, "Three");
    }

    Dictionary<int, string> data = new Dictionary<int, string>();
    public IDictionary<int, string> Data
    {
        get { return this.data; }
    }

    private KeyValuePair<int, string>? selectedKey = null;
    public KeyValuePair<int, string>? SelectedKey
    {
        get { return this.selectedKey; }
        set
        {
            this.selectedKey = value;
            this.OnPropertyChanged("SelectedKey");
            this.OnPropertyChanged("SelectedValue");
        }
    }

    public string SelectedValue
    {
        get
        {
            if(null == this.SelectedKey)
            {
                return string.Empty;
            }

            return this.data[this.SelectedKey.Value.Key];
        }
        set
        {
            this.data[this.SelectedKey.Value.Key] = value;
            this.OnPropertyChanged("SelectedValue");
        }
    }

    public event PropertyChangedEventHandler  PropertyChanged;
    private void OnPropertyChanged(string propName)
    {
        var eh = this.PropertyChanged;
        if(null != eh)
        {
            eh(this, new PropertyChangedEventArgs(propName));
        }
    }
} 
```

然后在 XAML 中：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <ListBox x:Name="ItemsListBox" Grid.Row="0"
            ItemsSource="{Binding Path=Data}"
            DisplayMemberPath="Key"
            SelectedItem="{Binding Path=SelectedKey}">
        </ListBox>
        <TextBox Grid.Row="1"
            Text="{Binding Path=SelectedValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    </Grid>
</Window> 
```

属性的值`Data`绑定到`ItemsSource`的`ListBox`。正如您在问题中所述，这导致使用实例`KeyValuePair<int, string>`作为`ListBox`. 我将 设置`DisplayMemberPath`为`Key`以便键的值将用作 中每个项目的显示值`ListBox`。

正如您所发现的，您不能只将`Value`的`KeyValuePair`用作 的数据`TextBox`，因为它是只读的。相反，`TextBox`绑定到视图模型上的属性，该属性可以获取和设置当前选定键的值（通过将 的`SelectedItem`属性绑定`ListBox`到视图模型上的另一个属性来更新）。我必须使这个属性可以为空（因为`KeyValuePair`是一个结构），以便代码可以检测到何时没有选择。

在我的测试应用程序中，这似乎会导致对在视图模型中的`TextBox`传播进行编辑。`Dictionary`

这或多或少是你想要的吗？看起来它应该更干净一些，但我不确定是否有任何方法可以这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-10T16:51:22.823

只是发布我从上面得出的内容。您可以将以下内容放在`ObservableCollection<ObservableKvp<MyKeyObject, MyValueObject>>`

将密钥设为只读，因为它们的密钥可能不应更改。这需要 Prism 才能工作 - 或者您可以实现自己的`INotifyPropertyChanged`版本

```
public class ObservableKvp<K, V> : BindableBase
{
    public K Key { get; }

    private V _value;
    public V Value
    {
        get { return _value; }
        set { SetProperty(ref _value, value); }
    }

    public ObservableKvp(K key, V value)
    {
        Key = key;
        Value = value;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T17:40:40.100

代替

```
Dictionary<string, int> 
```

, 你能有一个

```
Dictionary<string, IntWrapperClass>? 
```

让 IntWrapperClass 实现 INotifyPropertyCHanged。然后，您可以将 Listview/Listbox 双向绑定到字典中的项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-15T13:36:05.857

我设法在我的项目中使用由 dr.wpf[在这里](http://drwpf.com/blog/2007/09/16/can-i-bind-my-itemscontrol-to-a-dictionary/)实现的可观察字典并使用值不是字符串而是对象 [] 来做到这一点。在 xaml 我得到了类似的东西：

```
<ListView ItemsSource="{Binding myObservableDictionary}" >
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn DisplayMemberBinding="{Binding Key}"/>
                                    <GridViewColumn>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Value[0], Mode=TwoWay}" AllowDrop="True" Drop="TextBox_Drop"></TextBox>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView> 
```

# c++ - 初学者for循环问题

> ID：800137
> 
> 赞同：0
> 
> 时间：2009-04-28T22:43:15.260
> 
> 标签：c++, for-loop

[编辑]哎呀，代码中有一个错误，现在对这个问题的所有回答似乎都很奇怪，但基本上 for 循环曾经是 for(i=0; i<15; i++)。我还进行了编辑以使问题更清楚。[/EDIT]

我正在尝试创建一个 for 循环，它检查一个 16 元素数组，因此它从 0 循环到 15。然后我稍后使用 i 变量，但有时 i == 16，这会导致超出范围的问题。

我有一个解决方案，但它看起来并不优雅，这让我觉得我错过了一些东西。我试过 while 循环，但我永远无法让任何循环从 0 变为 15，并且永远不会以大于 15 的值结束。

有没有办法让一个循环去检查数组的所有 16 个元素，同时在循环结束时永远不会大于 15？

```
int i;

for(i=0; i<16; i++)
{
    someClass.someMethod(i);

    if(someClass.Test())
    {
        break;
    }
}

if (i == 16)
{
    i = 15;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T22:51:52.743

`i`我建议在循环完成后使用其他变量。使用 for 循环而不是 while 循环的标准是您事先知道 for 循环将执行多少次。如果您已经知道这一点，只需将一些其他变量设置为循环的结束值并使用它而不是提供`i`双重目的。

```
int j = 15;

for(int i=0; i <= j; i++)
{
    someClass.array[i];
}

// continue on using j, which value hasn't changed 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T22:49:18.427

对于初学者来说，您的示例代码从 0 循环到 14。但是如果您从 0 循环到 15，自然 i 必须是 16*才能*结束循环。发生的事情是它变成了 16，然后你的循环注意到它超出了界限并爆发了。如果您希望它在 15 处结束，老实说，最简单的方法就是在循环结束后递减。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-28T22:50:26.130

i 在最后一次检查时递增为 16，不小于 15，因此循环退出时 i 为 16。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T22:58:55.300

也许知道这一点很有用：

```
for (before; check; after) { body } 
```

它与以下内容相同：

```
before 
while(check) { 
  body 
  after 
} 
```

如果你在那个术语中思考你的 for 循环，也许你会很容易地找出为什么 i 在出口处是 16。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T03:22:04.247

您的方法似乎存在一些基本缺陷。

1.  您不应该真正在循环范围之外使用索引变量。
2.  您应该使用变量或函数来确定循环的限制。
3.  最好使用迭代器而不是数字索引。
4.  通用算法可以消除循环的需要。

只是我的 0.02 美元。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T22:53:11.007

所以 - 如果你正在检查一个 16 元素数组，通常你会这样做：

```
for(i=0; i<16; i++) 
```

如何工作，是从三个中的第一个语句开始：

```
i=0 
```

然后它会在第二个语句中进行检查：

```
i < 16 // True here, since 0 < 16 
```

这发生在你的循环之前。然后它使用该集合运行循环块：

```
someClass.array[i]; //0 
```

最后，它做了最后的声明：

```
i++ 
```

然后它按顺序重复第二个和第三个语句。

在最后一次运行之前，i == 14，然后它执行 i++，将 i 设置为 15，并执行该块。最后，它执行 i++，设置：

```
i==16 
```

此时，条件不再成立：

```
i < 16 // False, since i==16 
```

此时，您的块没有执行，但 i 仍设置为 16。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T22:50:03.043

你一定错过了什么。

在这个循环中，它甚至不会达到 15，你需要说 i <= 15，只要 i = 14 它就会运行一次并保释。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T22:57:39.560

该`for`循环等效于以下`while`循环：

```
i = 0;
while(i < 16) {
    someClass.array[i];

    i++;
} // while 
```

`i`需要达到 16 才能正确退出循环。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-28T23:10:54.960

从技术上讲，有一些方法可以编写循环，例如`i`退出循环时为 15，但您不应该这样做：

```
int i = 0;
while (1) {
    someclass.someMethod(i);
    if (i < 15) {
        i++;
    } else {
        break;
    }
} 
```

是的，它可以满足您的要求。但是流量很可怕。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-28T23:16:32.263

您无法使用内置循环结构来完成此操作，正如 Bill The Lizard 所说，您可能真的不想重用 for 循环变量。

但是，如果你真的想要，这里有一种方法。诀窍是将循环条件放在循环的中间：

```
int i = 0;
while (true)
{
    someclass.array[i];
    if (i == 15)
        break;
    ++i;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-29T00:52:14.810

这里要理解的关键问题是“i 的什么值导致测试成功？”这个问题有 17 个不同的答案。i 可以在 {0, 1, ..., 15} 中，或者没有 i 的值会导致测试成功，在这种情况下用 i == 16 表示。因此，如果 i 仅限于 16 个值，则无法回答该问题。

在某些合法情况下，您不想超过最后一个有效值。例如，如果您有 256 个值并且由于某种原因您只有一个字节可以计算。或者，就像我最近发生的那样，您只想检查数组的每个第 i 个元素，并且迭代器的最后一个添加使您远远超出数组的末尾。在这些情况下，*循环展开*是必要的。

但是，对于这个问题，使用标志会更干净：

```
bool flag = false;
for (int i = 0; i < 15; ++i) 
{
    someClass.someMethod(i);

    if (someClass.Test())
    {
        flag = true;
        break;
    }
} 
```

然后很清楚测试是否成功。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-29T01:49:02.740

如果您的循环自然终止，而不是中断，`i` *将*是 16。没有办法避免这种情况。如果您想要 i 最终为 15 或更少，您的代码是完全可以接受的：

```
int i;
for (i=0; i<16; i++) {
    someClass.someMethod(i);
    if (someClass.Test())
        break;
}
if (i == 16)
    i = 15; 
```

`i`在循环体之后从 16更改为 15 的任何内容都可以：

```
if (i == 16) i = 15;
i = (i == 16) ? 15 : i;
i = MAX (15,i); /* where MAX is defined :-) */ 
```

等等。

但是，这假设它将`i`用于有意义的事情，作为关于该循环的后置条件。我发现这种情况很少见，人们倾向于在重新使用之前重新初始化它（例如另一个 for 循环）。

此外，您正在做的事情使得很难（甚至不可能）确定作为后置条件，您的循环是正常终止还是由于`someClass.Test()`返回 true 而提前终止`i == 15`。这意味着使用 i 做出进一步的决定充满了危险。

我的问题是：*你为什么*认为你需要在`i`15 岁或以下离开？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-29T02:23:38.460

> 我正在尝试创建一个 for 循环，它检查一个 16 元素数组，因此它从 0 循环到 15。然后我稍后使用 i 变量，但有时 i == 16，这会导致超出范围的问题。

您需要检查您的 for 循环没有中断的情况，因为此信息确定您想要对 i 执行的任何操作是否有效。

有几种方法可以做到这一点。一种是在 bool 中跟踪它，例如“foundClass”或“testSucceeded”。将其默认为 false，然后在休息时将其设置为 true。稍后在“if (foundClass) { }”块中的函数中包含对 i 的任何使用。

另一种是只做你已经做过的事情。尽管您的后备看起来根本不正确。如果您将 i 设置为 15，那么您就是在对您的代码撒谎并告诉它 someClass.Test() 对于 i == 15 成功，这是不正确的。避免将值设置为错误的值，这样您的代码以后就不会出错。稍后在代码中围绕 i 的实际使用进行边界检查要好得多。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-01T08:18:51.990

```
for(int i=0; i<17; i++)
{    
  if(i<16)
  {
     someClass.someMethod(i); 
     if(someClass.Test())   
     {        
       break;    
     }
  }
  else if(i==16)
  {
     i=15;
  }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-11-16T09:37:27.107

如果您说您有一个包含 16 个元素的数组，则不必定义它，使用该数组来获取该信息（请勿重复信息）

之后，如果您想再次获取最后一个索引，请使用数组来获取该信息。

```
for(int i = 0; i < myArray.length; ++i){
       myArray[i].somemethod();
}
// lastindex = myArray.length-1; 
```

# c# - 为什么 .ForEach() 在 IList 而不是 IEnumerable ?

> ID：800151
> 
> 赞同：55
> 
> 时间：2009-04-28T22:47:57.573
> 
> 标签：c#, list, linq, c#-3.0, ienumerable

> **可能重复：**
> [为什么 IEnumerable 接口上没有 ForEach 扩展方法？](https://stackoverflow.com/questions/101265/why-is-there-not-a-foreach-extension-method-on-the-ienumerable-interface)

我在编写 LINQ-y 代码时注意到这`.ForEach()`是一个很好的习惯用法。例如，这是一段代码，它接受以下输入，并产生这些输出：

```
{ "One" } => "One"
{ "One", "Two" } => "One, Two"
{ "One", "Two", "Three", "Four" } => "One, Two, Three and Four"; 
```

和代码：

```
private string InsertCommasAttempt(IEnumerable<string> words)
{
    List<string> wordList = words.ToList();
    StringBuilder sb = new StringBuilder();
    var wordsAndSeparators = wordList.Select((string word, int pos) =>
        {
            if (pos == 0) return new { Word = word, Leading = string.Empty };
            if (pos == wordList.Count - 1) return new { Word = word, Leading = " and " };
            return new { Word = word, Leading = ", " };
        });

    wordsAndSeparators.ToList().ForEach(v => sb.Append(v.Leading).Append(v.Word));
    return sb.ToString();
} 
```

注意倒数第二行`.ToList()`之前的插入。`.ForEach()`

为什么它`.ForEach()`不能作为扩展方法使用`IEnumerable<T>`？像这样的例子，它看起来很奇怪。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-28T22:54:04.483

因为[`ForEach(Action)`](http://msdn.microsoft.com/en-us/library/bwabdf9z(VS.80).aspx)以前`IEnumerable<T>`存在过。

由于它没有与其他扩展方法一起添加，因此可以假设 C# 设计人员认为这是一个糟糕的设计，并且更喜欢该`foreach`构造。

* * *

### 编辑：

如果您愿意，您可以创建自己的扩展方法，它不会覆盖 a 的方法，`List<T>`但它适用于任何其他实现`IEnumerable<T>`.

```
public static class IEnumerableExtensions
{
  public static void ForEach<T>(this IEnumerable<T> source, Action<T> action)
  {
    foreach (T item in source)
      action(item);
  }
} 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-08-18T21:55:52.547

根据 Eric Lippert 的说法，这[主要是出于哲学原因](https://ericlippert.com/2009/05/18/foreach-vs-foreach/)。您应该阅读整篇文章，但就我而言，这是要点：

> 我在哲学上反对提供这种方法，原因有两个。
> 
> 第一个原因是这样做违反了所有其他序列运算符所基于的函数式编程原则。显然，调用此方法的唯一目的是引起副作用。
> 
> 表达式的目的是计算一个值，而不是产生副作用。声明的目的是产生副作用。这个东西的调用点看起来很像一个表达式（虽然，不可否认，由于该方法是返回无效的，所以该表达式只能在“语句表达式”上下文中使用。）
> 
> 制作一个唯一的仅对其副作用有用的序列运算符并不适合我。
> 
> 第二个原因是这样做会给语言增加零新的表示能力。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-28T22:50:54.117

因为`ForEach()`在 IEnumerable 上对于每个循环来说都是正常的，如下所示：

```
for each T item in MyEnumerable
{
    // Action<T> goes here
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T22:56:14.183

ForEach 不在 IList 上，它在 List 上。您在示例中使用了具体的列表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-28T23:10:24.447

我只是在这里猜测，但将 foreach 放在 IEnumerable 上会使操作对它产生副作用。“可用”的扩展方法都不会引起副作用，我猜想在那里放置像 foreach 这样的命令式方法会使 api 变得混乱。此外， foreach 将初始化惰性集合。

就个人而言，我一直在抵制只添加我自己的诱惑，只是为了将无副作用的功能与有副作用的功能分开。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T23:17:18.657

LINQ 遵循拉模型，它的所有（扩展）方法都应该返回`IEnumerable<T>`，除了`ToList()`. 那里是为了`ToList()`结束拉链。

`ForEach()`来自推模型世界。

正如 Samuel 所指出的，您仍然可以编写自己的扩展方法来执行此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T22:51:30.747

ForEach 在具体类中实现`List<T>`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T22:58:04.803

只是一个猜测，但 List 可以在不创建枚举器的情况下迭代其项目：

```
public void ForEach(Action<T> action)
{
    if (action == null)
    {
        ThrowHelper.ThrowArgumentNullException(ExceptionArgument.match);
    }
    for (int i = 0; i < this._size; i++)
    {
        action(this._items[i]);
    }
} 
```

这可以带来更好的性能。使用 IEnumerable，您无法选择使用普通的 for 循环。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-19T18:59:10.753

老实说，我不确定为什么 .ForEach(Action) 不包含在 IEnumerable 中，但是，正确、错误或无关紧要，就是这样......

但是，我确实想强调其他评论中提到的性能问题。根据您对集合的循环方式，性能会受到影响。它相对较小，但它确实存在。这是一个非常快速和草率的代码片段来显示关系......只需要一分钟左右即可完成。

```
class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Start Loop timing test: loading collection...");
        List<int> l = new List<int>();

        for (long i = 0; i < 60000000; i++)
        {
            l.Add(Convert.ToInt32(i));
        }

        Console.WriteLine("Collection loaded with {0} elements: start timings",l.Count());
        Console.WriteLine("\n<===============================================>\n");
        Console.WriteLine("foreach loop test starting...");

        DateTime start = DateTime.Now;

        //l.ForEach(x => l[x].ToString());

        foreach (int x in l)
            l[x].ToString();

        Console.WriteLine("foreach Loop Time for {0} elements = {1}", l.Count(), DateTime.Now - start);
        Console.WriteLine("\n<===============================================>\n");
        Console.WriteLine("List.ForEach(x => x.action) loop test starting...");

        start = DateTime.Now;

        l.ForEach(x => l[x].ToString());

        Console.WriteLine("List.ForEach(x => x.action) Loop Time for {0} elements = {1}", l.Count(), DateTime.Now - start);
        Console.WriteLine("\n<===============================================>\n");

        Console.WriteLine("for loop test starting...");

        start = DateTime.Now;
        int count = l.Count();
        for (int i = 0; i < count; i++)
        {
            l[i].ToString();
        }

        Console.WriteLine("for Loop Time for {0} elements = {1}", l.Count(), DateTime.Now - start);
        Console.WriteLine("\n<===============================================>\n");

        Console.WriteLine("\n\nPress Enter to continue...");
        Console.ReadLine();
    } 
```

不过不要太挂断这个。性能是应用程序设计的货币，但除非您的应用程序正在经历导致可用性问题的实际性能冲击，否则请专注于可维护性和重用编码，因为时间是现实生活中业务项目的货币......

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-28T22:52:12.430

~~它被称为“选择”`IEnumerable<T>`~~ 我很开明，谢谢。

# cloud - 云计算：谁使用它

> ID：800152
> 
> 赞同：3
> 
> 时间：2009-04-28T22:48:07.057
> 
> 标签：cloud

谁在使用像 Windows Azure、Google Apps Engine、Amazone S3 这样的云计算……你用它做什么？

为什么不使用专用服务器或公司内部基础设施？

您知道使用 CC 的公司吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-23T19:00:32.583

我们使用 S3 在线存储我们的文档。便宜又容易。使用[S3fm](http://s3.amazonaws.com/s3fm/index.html)，您可以随时随地在线获取文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T22:51:22.463

我曾经工作的公司正在对一个大型内部网格进行精算计算。在内部电网无法处理短期问题的高峰时期，他们用云计算来美化这一点。支付足够的虚拟机，启动它们，执行计算，销毁虚拟机。这是一种处理需求高峰的方法，而无需支付全年的硬件开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T22:53:34.423

我认为谷歌应用引擎的大部分内容是把你的工作放在那里的速度。如果您是一家刚起步但没有必要基础设施的两人公司，那么应用引擎是一个不错的选择。[也可以在此处](http://googleenterprise.blogspot.com/2009/04/what-we-talk-about-when-we-talk-about.html)查看 google 的声明。

即使对于中型公司，它也可以帮助在高峰日处理额外的负载。我们使用 ec2 向数以千计的销售团队发布我们的产品。内部基础设施只会阻塞数千个并行下载，而且成本很低。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T22:54:20.973

我们使用 Amazon EC2 进行开发和质量检查。由于负载相对较低，为我们节省了大量资金。我们目前正在评估是否也应该移动 prod 环境。

# winforms - 在 BLL 中处理异常并返回给客户端（winforms 或 webforms）？

> ID：800161
> 
> 赞同：1
> 
> 时间：2009-04-28T22:50:31.170
> 
> 标签：winforms, exception, exception-handling, try-catch

我正在寻找进行异常处理的最佳方法，例如..当业务逻辑层发生错误时，使用 catch 停止 METHOD 并将 EVENT 返回到表示层的最佳方法是什么？

这个事件应该包含什么？

或者我应该总是冒泡异常并在表示层中处理它们？

关于处理异常的最佳方式以及如何在客户端处理它们，任何人都有一些很好的链接和需要阅读的内容......

例如，如果我在 BLL 中得到一个 NullException，那么我可以捕捉到这个......但是最好的方法是返回到 presentaiton 层并通知它这个问题......

事件？还是演示文稿中的另一个尝试/捕获？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T22:58:57.593

你可以做几件事；

1.  当出现意外错误时，专注于改善用户体验。

2.  始终在事件日志或数据库中记录错误。

3.  实施足够的基础设施以不让异常发生，除非它们是系统异常。

4.  使用 throw 异常的 throw instread

*一些可以帮助您的链接*：

1.  [http://today.java.net/pub/a/today/2003/12/04/exceptions.html](http://today.java.net/pub/a/today/2003/12/04/exceptions.html)

2.  [http://www.onjava.com/pub/a/onjava/2003/11/19/exceptions.html](http://www.onjava.com/pub/a/onjava/2003/11/19/exceptions.html)

3.  [http://www.codeproject.com/KB/architecture/exceptionbestpractices.aspx](http://www.codeproject.com/KB/architecture/exceptionbestpractices.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T23:02:41.140

有几种方法可以做到：

1) 抛出带有内部描述消息的异常。

2) 触发事件

3）使用特殊的界面与用户进行交互。
例如，您可以实现类似 IUiCallbacks 接口的东西，并将实现此接口的对象发送到 BLL 类或方法。之后，BLL 中的方法可以调用 IUiCallbacks.SendMessage() 或 IUiCallbacks.SendError() 来通知演示。你可以有不同的类，例如 WinFormsUiCallbacks、WebFormsUiCallbacks 和 SilentUiCallbacks，来实现这个接口。

我通常使用 1) 和 3)

3）的示例根据要求：

```
public interface IUiCallbacks
{
  void SendMessage(string message);
  void SendException(string message, Exception ex);
}

public class WinFormsUiCallbacks : IUiCallbacks
{
  public void SendMessage(string message)
  {
    MessageBox.Show(message);
  }

  public void SendException(string message, Exception ex)
  {
    MessageBox.Show(string.Format("Unfortunately, the following errror has occurred:{0}{1}", Environment.NewLine, ex.Message));
  }
}

public class OrderService
{
  private IUiCallbacks _iUiCallbacks;
  ...
  public OrderService() { ... }
  public OrderService(IUiCallbacks iUiCallbacks)
  {
    _iUiCallbacks = iUiCallbacks;
  }
  ...
  public void AddOrder(Order order)
  {
    ...
    if(OrderAlreadyExists(order))
    {
      if(_iUiCallbacks != null)
        _iUiCallbacks.SendMessage("The order can not be added, because it is already accepted.");
      return;
    }
    ...
  }
  ...
}
```

所以它可以像这样使用：

```
public partial class OrderForm : Form
{
  ...
  public void btnAddOrderFromExcel_Click(...)
  {
    Order order = LoadOrderFromExcel(...);
    OrderService orderService = new OrderService(new WinFormsUiCallbacks());
    orderService.AddOrder(order);
  }
  ...
} 
```

# java - 尽管有混淆，但真正的运行时方法名称？

> ID：800172
> 
> 赞同：2
> 
> 时间：2009-04-28T22:52:24.457
> 
> 标签：java, runtime, obfuscation

如果您混淆了代码，有什么方法可以查询当前方法的名称？我之所以这样问，是因为有时我想以执行方法作为前缀来记录一条消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T22:54:56.683

只需将方法名称直接添加到您输出的字符串中即可。如果您通过反射获得当前方法的名称，它将是混淆后的名称。如果不是这种方式，任何人都可以找出原始方法，打败混淆（或极大地阻碍它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T08:31:55.687

或者，混淆工具应该能够输出他们自己的混淆日志，这样您就可以编写一个工具来将应用程序的混淆日志翻译成人类可读的东西。

当然，一旦你到达那里，你的应用程序的开发版本可能包括访问他们自己的混淆日志并在输出日志之前翻译反射结果的能力。

您可以在文件系统上拥有混淆日志，作为 jar 文件中的应用程序资源或从远程服务器下载它们。

如果您只在应用程序内存中保留解密的混淆日志，则虚拟机沙箱应该保证它们相当安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-29T12:50:36.523

请重新考虑为什么要混淆。混淆器混淆的东西通常对调试有用。

# c# - 如何使用 ASF Writer 更快地进行 WMV 压缩？有什么提示吗？

> ID：800179
> 
> 赞同：2
> 
> 时间：2009-04-28T22:54:17.540
> 
> 标签：c#, delphi, visual-c++, directshow, wmv

我正在使用 ASF Writer 将原始 AVI 文件压缩为 WMV。我非常需要加快压缩速度。关于如何实现这一点有任何提示和最佳实践吗？降低/降低索引器的影响 ? 任何*隐藏的*压缩参数？

这些文件仅包含 RGB/24 位格式的视频，视频流的压缩级别介于 200kbps 和 2000kbps 之间。

任何配置提示（使用 C++、C#、Delphi 等）

这是配置 WMV 编写器的代码部分（使用 DSPack）。

```
function CreateWMVWriter(VideoQuality, AudioQuality: Cardinal; videoInfo: PVideoInfoHeader; audioInfo: PWaveFormatEx; hasAudio: Boolean): IBaseFilter;
const
  PROFILE_NAME = 'WMV AutoProfile';
  // BUFFER_WINDOW = $FFFFFFFF;  // auto buffer
  BUFFER_WINDOW = 1000;  // 1 second
  MAX_KEY_FRAME_SPACING = 10000000; // 1 seconds
var
  configWriter : IConfigAsfWriter;
  profileManager : IWMProfileManager;
  profile : IWMProfile;
  stream : IWMStreamConfig;
  mediaProps : IWMMediaProps;
  vmediaProps : IWMVideoMediaProps;
  pmt : PWMMediaType;
  msize : Cardinal;
  vih : PVideoInfoHeader;
  wfe: PWaveFormatEx;
  hr : HRESULT;
  videoBitRate, audioBitRate: Cardinal;
  width, height: Integer;
begin
  videoBitRate := VideoQuality * 1000; // kbits
  // create the profile
  CheckDSError(WMCreateProfileManager(profileManager));
  CheckDSError(profileManager.CreateEmptyProfile(WMT_VER_9_0, profile));
  CheckDSError(profile.SetName(StringToOleStr(PROFILE_NAME)));
  CheckDSError(profile.SetDescription(StringToOleStr(PROFILE_NAME)));
  CheckDSError(profile.CreateNewStream(WMMEDIATYPE_Video, stream));
  CheckDSError(stream.SetStreamName(StringToOleStr('Video')));
  CheckDSError(stream.SetBitrate(videoBitRate));
  CheckDSError(stream.SetBufferWindow(BUFFER_WINDOW));
  // config video media type
  stream.QueryInterface(IID_IWMMediaProps, mediaProps);
  CheckDSError(mediaProps.GetMediaType(nil, msize));
  GetMem(pmt, msize);
  CheckDSError(mediaProps.GetMediaType(pmt, msize));
  with pmt^ do
  begin
    majortype := WMMEDIATYPE_Video;
    subtype := WMMEDIASUBTYPE_WMV3;
    bFixedSizeSamples := True;
    bTemporalCompression := True;
    pUnk := nil;
    vih := PVideoInfoHeader(pbFormat);
    // copy video info header (the same as with the original - copy: rcSource, rcTarget, AvgTimePerFrame, biWidth, biHeight)
    CopyMemory(vih, videoInfo, SizeOf(TVideoInfoHeader));
    // set bit rate at the same value
    vih.dwBitRate := videoBitRate;
    // set new compression ('WMV3')
    vih.bmiHeader.biCompression := MAKEFOURCC('W', 'M', 'V', '3');
  end;
  CheckDSError(mediaProps.SetMediaType(pmt));
  FreeMem(pmt, msize);
  // set media props
  stream.QueryInterface(IID_IWMVideoMediaProps, vmediaProps);
  CheckDSError(vmediaProps.SetQuality(100));
  CheckDSError(vmediaProps.SetMaxKeyFrameSpacing(0));
  // CheckDSError(vmediaProps.SetMaxKeyFrameSpacing(MAX_KEY_FRAME_SPACING));
  // add video stream
  CheckDSError(profile.AddStream(stream));
  // add audio stream (if needed)
  if hasAudio then
  begin
    CheckDSError(profile.CreateNewStream(WMMEDIATYPE_Audio, stream));
    CheckDSError(stream.SetStreamName(StringToOleStr('Audio')));
    audioBitRate := audioInfo.nSamplesPerSec * audioInfo.nChannels * audioInfo.wBitsPerSample;
    CheckDSError(stream.SetBitrate(audioBitRate));
    CheckDSError(stream.SetBufferWindow(BUFFER_WINDOW)); // auto
    // config video media type
    stream.QueryInterface(IID_IWMMediaProps, mediaProps);
    CheckDSError(mediaProps.GetMediaType(nil, msize));
    GetMem(pmt, msize);
    hr := mediaProps.GetMediaType(pmt, msize);
    with pmt^ do
    begin
      // uncompressed audio
      majortype := WMMEDIATYPE_Audio;
      subtype := WMMEDIASUBTYPE_PCM;
      formattype := WMFORMAT_WaveFormatEx;
      cbFormat := sizeof(TWaveFormatEx);
      bFixedSizeSamples := True;
      bTemporalCompression := False;
      lSampleSize := audioInfo.nChannels * audioInfo.wBitsPerSample div 8;
      pUnk := nil;
      wfe := PWaveFormatEx(pbFormat);
      // copy video info header (the same as with the original)
      CopyMemory(wfe, audioInfo, SizeOf(TWaveFormatEx));
    end;
    CheckDSError(mediaProps.SetMediaType(pmt));
    FreeMem(pmt, msize);
    // add video stream
    CheckDSError(profile.AddStream(stream));
  end;

  // create the writer
  Result := AddFilterGUID(CLSID_WMAsfWriter, 'WmvWriter');

  // config the writer
  configWriter := Result as IConfigAsfWriter;
  CheckDSError(configWriter.SetIndexMode(True));
  CheckDSError(configWriter.ConfigureFilterUsingProfile(profile));
end; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T01:31:19.147

我真的没有很多经验，但是从其他地方发布的内容来看，尝试设置`WMMEDIASUBTYPE_WVC1`而不是`WMMEDIASUBTYPE_WVC3`. [信息是从这里](http://www.eggheadcafe.com/conversation.aspx?messageid=30397128&threadid=30397128)收集的。

其他一些可能有用的链接：[这里](http://groups.google.com/group/microsoft.public.win32.programmer.directx.video/browse_thread/thread/8657e3135529af18?pli=1)和[这里](http://www.tech-archive.net/Archive/Media/microsoft.public.windowsmedia.encoder/2006-11/msg00049.html)

# zsh - [nyae] 在 Zsh 中是什么意思？

> ID：800182
> 
> 赞同：220
> 
> 时间：2009-04-28T22:54:28.023
> 
> 标签：zsh

我运行以下命令失败

```
dir 
```

我得到

```
zsh: correct 'dir' to 'gdir' [nyae]? 
```

**[nyae] 在 Zsh 中是什么意思？**

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2009-04-28T22:59:09.840

`zsh`具有强大的纠偏机制。如果您以错误的方式键入命令，它会建议更正。这里发生的`dir`是一个未知的命令和`zsh`建议`gdir`，而可能`ls`是你想要的。

1.  如果你想执行`gdir`命中`y`（是）
2.  如果您想尝试执行`dir`无论如何命中`n`（否）
3.  如果您想执行完全不同的拼写命令，例如`ls`命中`a`（中止）并输入您的命令
4.  如果您想执行类似的拼写命令，例如`udir`hit `e`(edit) 并编辑您的命令。

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2012-09-07T21:14:17.063

快速参考：

```
$ dir
zsh: correct 'dir' to 'gdir' [nyae]? 
```

*   `n`: **n** o – 不正确；运行`dir`，就像你输入的那样
*   `y`: **y** es – 做正确；`gdir`按照 Zsh 的建议运行
*   `a`: **a** bort - 不要运行任何东西，并得到一个新的提示（输入一个完全不同的命令）
*   `e`: **e** dit – 以交互方式编辑您输入的内容 – 例如，您可以更改`dir`为`udir`

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-04-28T23:04:38.810

从[*Z Shell 简介*](http://zsh.sourceforge.net/Intro/intro_16.html#IDX210)：

> 如果`y`在 shell 询问您是否要更正某个单词时按下，它将被更正。如果您按`n`，它将保持不变。按下会`a`中止命令，按下`e`会再次编辑该行，以防您同意单词拼写错误但您不喜欢更正。

# ruby - 获取 ruby 中的直接子目录

> ID：800189
> 
> 赞同：20
> 
> 时间：2009-04-28T22:58:08.453
> 
> 标签：ruby, file

我正在尝试编写一个简单的 ruby​​ 脚本，它将文件复制到目录的直接子目录。我将如何仅获取直接子目录？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-07-20T17:59:54.230

假设您只想要*直接*子目录，您可以使用`Dir['*/']`（它结合了 Micheal Sepcot 和 glenra 的答案）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-28T23:40:45.947

`Dir.glob("**/")`将返回当前目录下所有路径的数组。从那里您可以过滤列表并复制文件`File.copy(from, to)`

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-30T18:04:21.620

如果您要查找所有*直接*子目录（仅比您所在的位置低一级），请尝试以下操作：

```
Dir.chdir("/some/path/you/want/to/check/below")
subdir_list=Dir["*"].reject{|o| not File.directory?(o)} 
```

也就是说：在某个地方更改目录，构造在那里找到的文件数组，拒绝那些不是目录的数组元素，并返回生成的剔除数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-07-06T17:33:41.170

在 Ruby 中处理文件的最佳方式可能是[`Pathname`](https://ruby-doc.org/stdlib-2.3.0/libdoc/pathname/rdoc/Pathname.html). 它将来自几个基于文件的模块的类方法组合成一个易于使用的 OOP 类。因此，您不需要像使用`Dir`or那样将值传递给方法`File`，您只需在对象本身上调用该方法即可。

以下是打印直接子目录的方法：

```
require 'pathname'

puts Pathname('some/directory').children.select(&:directory?) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-09T12:24:05.143

基于@glenra 的回答，但没有永久更改目录（这可能会导致问题`pry`）：

```
def folders
  Dir.chdir("/some/path/you/want/to/check/below") {
    Dir["*"].reject{|o| not File.directory?(o)}
  }
end

puts folders   # ["all", "the", "folders"]
binding.pry    # yay, works 
```

# python - 如何在 Python 中获取所有直接子目录

> ID：800197
> 
> 赞同：190
> 
> 时间：2009-04-28T22:59:11.553
> 
> 标签：python, file

我正在尝试编写一个简单的 Python 脚本，它将 index.tpl 复制到所有子目录中的 index.html （有一些例外）。

我试图获取子目录列表而陷入困境。

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2009-04-28T23:02:06.103

```
import os
def get_immediate_subdirectories(a_dir):
    return [name for name in os.listdir(a_dir)
            if os.path.isdir(os.path.join(a_dir, name))] 
```

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2020-01-27T21:11:03.447

我对各种功能进行了一些**速度测试**，以返回所有当前子目录的*完整路径。*

tl;博士： **始终使用`scandir`：**

`list_subfolders_with_paths = [f.path for f in os.scandir(path) if f.is_dir()]`

奖励：`scandir`你也可以简单地通过使用`f.name`而不是获取文件夹名称`f.path`。

这（以及下面的所有其他功能）将不使用*自然排序*。这意味着结果将按如下方式排序：1、10、2。要获得自然排序（1、2、10），请查看[https://stackoverflow.com/a/48030307/2441026](https://stackoverflow.com/a/48030307/2441026)

* * *

**结果**： `scandir`是：比`walk`快 3 倍，比`listdir`（使用过滤器）快 32 倍，比 快 35 倍，比 快`Pathlib`36 倍，比 快`listdir`37 倍（！）`glob`。

```
Scandir:           0.977
Walk:              3.011
Listdir (filter): 31.288
Pathlib:          34.075
Listdir:          35.501
Glob:             36.277 
```

使用 W7x64、Python 3.8.1 测试。包含 440 个子文件夹的文件夹。
如果您想知道是否`listdir`可以通过不执行两次 os.path.join() 来加快速度，是的，但是基本上不存在差异。

代码：

```
import os
import pathlib
import timeit
import glob

path = r"<example_path>"

def a():
    list_subfolders_with_paths = [f.path for f in os.scandir(path) if f.is_dir()]
    # print(len(list_subfolders_with_paths))

def b():
    list_subfolders_with_paths = [os.path.join(path, f) for f in os.listdir(path) if os.path.isdir(os.path.join(path, f))]
    # print(len(list_subfolders_with_paths))

def c():
    list_subfolders_with_paths = []
    for root, dirs, files in os.walk(path):
        for dir in dirs:
            list_subfolders_with_paths.append( os.path.join(root, dir) )
        break
    # print(len(list_subfolders_with_paths))

def d():
    list_subfolders_with_paths = glob.glob(path + '/*/')
    # print(len(list_subfolders_with_paths))

def e():
    list_subfolders_with_paths = list(filter(os.path.isdir, [os.path.join(path, f) for f in os.listdir(path)]))
    # print(len(list(list_subfolders_with_paths)))

def f():
    p = pathlib.Path(path)
    list_subfolders_with_paths = [x for x in p.iterdir() if x.is_dir()]
    # print(len(list_subfolders_with_paths))

print(f"Scandir:          {timeit.timeit(a, number=1000):.3f}")
print(f"Listdir:          {timeit.timeit(b, number=1000):.3f}")
print(f"Walk:             {timeit.timeit(c, number=1000):.3f}")
print(f"Glob:             {timeit.timeit(d, number=1000):.3f}")
print(f"Listdir (filter): {timeit.timeit(e, number=1000):.3f}")
print(f"Pathlib:          {timeit.timeit(f, number=1000):.3f}") 
```

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2013-08-16T16:41:50.487

为什么没有人提到[`glob`](https://docs.python.org/2/library/glob.html)？`glob`允许您使用 Unix 样式的路径名扩展，并且对于需要查找多个路径名的几乎所有事情来说，它都是我的首选。这很容易：

```
from glob import glob
paths = glob('*/') 
```

请注意，这`glob`将返回带有最后一个斜杠的目录（就像 unix 那样），而大多数`path`基于解决方案的解决方案将省略最后一个斜杠。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2014-09-06T21:50:37.233

选中“[获取当前目录中所有子目录的列表](https://stackoverflow.com/questions/973473/getting-a-list-of-all-subdirectories-in-the-current-directory/973488#973488)”。

这是一个 Python 3 版本：

```
import os

dir_list = next(os.walk('.'))[1]

print(dir_list) 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2013-07-04T00:47:48.093

```
import os 
```

**要获取目录中的（完整路径）直接子目录：**

```
def SubDirPath (d):
    return filter(os.path.isdir, [os.path.join(d,f) for f in os.listdir(d)]) 
```

**要获取最新的（最新的）子目录：**

```
def LatestDirectory (d):
    return max(SubDirPath(d), key=os.path.getmtime) 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-04-28T23:02:46.757

[`os.walk`](http://www.python.org/doc/2.5.4/lib/os-file-dir.html)在这种情况下是你的朋友。

直接来自文档：

> walk() 通过自上而下或自下而上遍历树来在目录树中生成文件名。对于以目录 top 为根的树中的每个目录（包括 top 本身），它会产生一个 3 元组（dirpath、dirnames、filenames）。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2016-10-20T20:37:30.570

这种方法很好地一口气完成了所有工作。

```
from glob import glob
subd = [s.rstrip("/") for s in glob(parent_dir+"*/")] 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-04-28T23:03:54.243

使用 Twisted 的 FilePath 模块：

```
from twisted.python.filepath import FilePath

def subdirs(pathObj):
    for subpath in pathObj.walk():
        if subpath.isdir():
            yield subpath

if __name__ == '__main__':
    for subdir in subdirs(FilePath(".")):
        print "Subdirectory:", subdir 
```

由于一些评论者询问使用 Twisted 的库的优势是什么，我将在这里超越原来的问题。

* * *

分支中有[一些改进的文档](http://twistedmatrix.com/trac/browser/branches/filepath-setcontent-2931-3/twisted/python/filepath.py#L6)解释了 FilePath 的优点；你可能想读一下。

在这个例子中更具体地说：与标准库版本不同，这个函数可以在*没有导入*的情况下实现。“subdirs”函数是完全通用的，因为它只对它的参数进行操作。为了使用标准库复制和移动文件，您需要依赖“ `open`”内置函数，“ `listdir`”，也许是“ `isdir`”或“ `os.walk`”或“ `shutil.copy`”。也许“ `os.path.join`”也是。更不用说您需要一个字符串传递一个参数来识别实际文件。让我们看一下将每个目录的“index.tpl”复制到“index.html”的完整实现：

```
def copyTemplates(topdir):
    for subdir in subdirs(topdir):
        tpl = subdir.child("index.tpl")
        if tpl.exists():
            tpl.copyTo(subdir.child("index.html")) 
```

上面的“subdirs”函数可以作用于任何类似`FilePath`的对象。这意味着，除其他外，`ZipPath`对象。不幸`ZipPath`的是现在是只读的，但它可以扩展以支持写入。

您还可以传递您自己的对象用于测试目的。为了测试此处建议的使用 os.path 的 API，您必须使用导入的名称和隐式依赖项进行监控，并且通常会执行黑魔法以使您的测试正常工作。使用 FilePath，您可以执行以下操作：

```
class MyFakePath:
    def child(self, name):
        "Return an appropriate child object"

    def walk(self):
        "Return an iterable of MyFakePath objects"

    def exists(self):
        "Return true or false, as appropriate to the test"

    def isdir(self):
        "Return true or false, as appropriate to the test"
...
subdirs(MyFakePath(...)) 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-29T01:38:14.807

我只是写了一些代码来移动 vmware 虚拟机，最后使用`os.path`and`shutil`来完成子目录之间的文件复制。

```
def copy_client_files (file_src, file_dst):
    for file in os.listdir(file_src):
            print "Copying file: %s" % file
            shutil.copy(os.path.join(file_src, file), os.path.join(file_dst, file)) 
```

它不是非常优雅，但它确实有效。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-28T23:42:09.563

这是一种方法：

```
import os
import shutil

def copy_over(path, from_name, to_name):
  for path, dirname, fnames in os.walk(path):
    for fname in fnames:
      if fname == from_name:
        shutil.copy(os.path.join(path, from_name), os.path.join(path, to_name))

copy_over('.', 'index.tpl', 'index.html') 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-08-14T04:32:56.930

```
def get_folders_in_directories_recursively(directory, index=0):
    folder_list = list()
    parent_directory = directory

    for path, subdirs, _ in os.walk(directory):
        if not index:
            for sdirs in subdirs:
                folder_path = "{}/{}".format(path, sdirs)
                folder_list.append(folder_path)
        elif path[len(parent_directory):].count('/') + 1 == index:
            for sdirs in subdirs:
                folder_path = "{}/{}".format(path, sdirs)
                folder_list.append(folder_path)

    return folder_list 
```

可以调用以下函数：

get_folders_in_directories_recursively(directory, index=1) -> 给出第一级的文件夹列表

get_folders_in_directories_recursively(directory) -> 给出所有子文件夹

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-01-22T19:05:50.637

不得不提一下我经常使用的[path.py](https://pathpy.readthedocs.io/en/stable/api.html)库。

获取直接子目录变得如此简单：

`my_dir.dirs()`

完整的工作示例是：

```
from path import Path

my_directory = Path("path/to/my/directory")

subdirs = my_directory.dirs() 
```

> 注意：my_directory 仍然可以作为字符串进行操作，因为 Path 是字符串的子类，但提供了许多有用的方法来操作路径

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-22T18:52:03.330

```
import glob
import os

def child_dirs(path):
     cd = os.getcwd()        # save the current working directory
     os.chdir(path)          # change directory 
     dirs = glob.glob("*/")  # get all the subdirectories
     os.chdir(cd)            # change directory to the script original location
     return dirs 
```

该`child_dirs`函数接受一个目录路径并返回其中的*直接子目录*的列表。

```
dir
 |
  -- dir_1
  -- dir_2

child_dirs('dir') -> ['dir_1', 'dir_2'] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-05-06T00:26:22.213

```
import pathlib

def list_dir(dir):
    path = pathlib.Path(dir)
    dir = []
    try:
        for item in path.iterdir():
            if item.is_dir():
                dir.append(item)
        return dir
    except FileNotFoundError:
        print('Invalid directory') 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-01T16:07:53.143

一个使用 pathlib 的班轮：

```
list_subfolders_with_paths = [p for p in pathlib.Path(path).iterdir() if p.is_dir()] 
```

# apache-flex - Flex：如何在图表中添加水平轴？

> ID：800200
> 
> 赞同：2
> 
> 时间：2009-04-28T23:01:46.807
> 
> 标签：apache-flex, charts, actionscript

我有一个动态创建的图表，我需要在脚本中添加水平轴和垂直轴。我无法将图表放入 MXML，因为我正在动态更改图表类型、删除和创建新图表。因此，我用来创建图表的变量（chartBase 的一个实例）既没有水平轴也没有垂直轴。如果它们不存在，我如何分配给它们？我应该使用不同的类型吗？我要使用的图表是线、条形和 HLOC 和/或烛台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:39:00.300

我认为通过将图表实例化为适当的类型，您将获得更好的结果。

例如，在一个组件中，我在 mxml 中有一个骨架 lineChart 设置...

```
<mx:LineChart id="lineChart" dataProvider="{chartData}" dataTipFunction="dataTipFunction"
    width="100%"
    height="100%"
    showDataTips="true"
    /> 
```

...但您可以将其创建为变量并将其添加到容器中。然后对于轴，我确定我想要的类型并创建并应用它们，这是我用于水平轴的一些代码......

```
// Setup new horizontal axis.
switch (hAxisFieldsComboBox.selectedItem.dataType)
{
    case "Date":
        var hDtAxis:DateTimeAxis = new DateTimeAxis();
        hDtAxis.title = hAxisFieldsComboBox.selectedItem.label;
        hDtAxis.dataUnits = "days";
        hDtAxis.dataInterval = 1;
        hDtAxis.parseFunction = dateParser;
        lineChart.horizontalAxis = hDtAxis;
        break;
    case "Time":
        var hTAxis:DateTimeAxis = new DateTimeAxis();
        hTAxis.title = hAxisFieldsComboBox.selectedItem.label;
        hTAxis.dataInterval = 1;
        hTAxis.parseFunction = timeParser;
        lineChart.horizontalAxis = hTAxis;
        break;
    case "Number":
        var hLAxis:LinearAxis = new LinearAxis();
        hLAxis.title = hAxisFieldsComboBox.selectedItem.label;
        hLAxis.interval = 1;
        hLAxis.minimum = 0;
        lineChart.horizontalAxis = hLAxis;
        break;
    default:
        var hCatAxis:CategoryAxis = new CategoryAxis();
        hCatAxis.title = hAxisFieldsComboBox.selectedItem.label;
        hCatAxis.dataProvider = schemaUtil.aggregateAndSortCasesAC(chartData, vAxisFieldsComboBox.selectedItem.data, [hAxisFieldsComboBox.selectedItem.data]);
        hCatAxis.categoryField = hAxisFieldsComboBox.selectedItem.data;
        lineChart.horizontalAxis = hCatAxis;
} 
```

希望有帮助。

# macos - Mac OS X 中 Ctrl-Alt F1 和 Alt-F1...F6 的 TTY 开关

> ID：800210
> 
> 赞同：20
> 
> 时间：2009-04-28T23:04:23.040
> 
> 标签：macos, tty

**是否可以...**

1.  为键绑定设置终端模式`Ctrl`+ `Alt`+`F1`
2.  在 TTY 之间切换`Alt`+ `F1`...`F6`

Ubuntu 有上述命令可以在不同的 TTY 之间移动。

Mac似乎没有激活它们。

**如何在 Mac 中激活上述功能？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-05T17:21:16.353

OSX 中只有一个 TTY (TTY1) 可用。要启用 tty，请使用`fn`+ `ctrl`+ `alt`+ `F1`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-28T23:14:18.990

我不确定你在问什么。您是在询问有关在 Mac OS X 中访问 TTY 的问题吗？这是不可能的。使用终端，/Applications/Utilities/Terminal.app

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-27T09:37:34.270

对于 Mac/apple 键盘，在 Linux 系统上，先按住`fn`，然后再按`ctrl+opt+f2`例如。

@mandolo 走在正确的轨道上。

# user-interface - os x gui api 说明

> ID：800212
> 
> 赞同：0
> 
> 时间：2009-04-28T23:04:29.547
> 
> 标签：user-interface, macos, window-managers

如果我想为 OS X 编写自己的窗口管理器（请不要回答“有什么意义”？？），我应该查看哪些 API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T19:06:17.380

OS X 中没有“窗口管理器”之类的东西，也没有公共接口来实现它。X11 窗口管理器将执行的功能分为 GUI 工具包（Carbon/Cocoa）、Dock 应用程序和窗口服务器。

如果您想更改 OS X 的窗口行为，您唯一真正的选择是修补单个应用程序、Dock（与窗口服务器具有特权连接）和/或窗口服务器。这将涉及大量的逆向工程，几乎可以肯定会在 10.6 中中断，但这肯定是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T23:15:51.657

在硬件级别，编写您自己的 API。

否则，有多种[图形架构](http://developer.apple.com/macosx/architecture/index.html)可以插入您的窗口管理器：

*   [OpenGL](http://developer.apple.com/graphicsimaging/opengl/)
*   [石英](http://developer.apple.com/graphicsimaging/quartz/)
*   [快速时间](http://developer.apple.com/quicktime/)
*   [X11](http://developer.apple.com/opensource/tools/X11.html)

# php - PHP SoapClient 超时

> ID：800215
> 
> 赞同：2
> 
> 时间：2009-04-28T23:04:43.913
> 
> 标签：php, api, soap

我正在尝试从运行服务的同一台服务器调用 Soap 客户端进行测试。我的 WSDL 位于：[http](http://www.installittoday.com/api/server.php?wsdl) ://www.installittoday.com/api/server.php?wsdl 我试图简单地加载它：

```
 $client = new SoapClient('http://www.installittoday.com/api/server.php?wsdl'); 
```

但我得到了错误：

```
 Warning: SoapClient::SoapClient(http://www.installittoday.com/api/server.php?wsdl) [soapclient.soapclient]: failed to open stream: Connection timed out in /home/installi/public_html/api/client.php on line 4  

Warning: SoapClient::SoapClient() [soapclient.soapclient]: I/O warning : failed to load external entity "http://www.installittoday.com/api/server.php?wsdl" in /home/installi/public_html/api/client.php on line 4  

Fatal error: Uncaught SoapFault exception: [WSDL] SOAP-ERROR: Parsing WSDL: Couldn't load from 'http://www.installittoday.com/api/server.php?wsdl' : failed to load external entity "http://www.installittoday.com/api/server.php?wsdl" in /home/installi/public_html/api/client.php:4 Stack trace: #0 /home/installi/public_html/api/client.php(4): SoapClient->SoapClient('http://www.inst...') #1 {main} thrown in /home/installi/public_html/api/client.php on line 4 

```

然而，我可以从我的另一个站点很好地设置客户端。这是防火墙问题还是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T07:03:48.977

**确保在您的php.ini**中启用了这些扩展

 **```
extension=php_curl.dll 
extension=php_openssl.dll 
extension=php_soap.dll 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T23:33:54.747

也可以从这里加载。

尝试使用 Web 浏览器从您希望客户端连接的站点连接到它，或者如果它是没有设置代理的远程计算机，请使用 curl：

```
curl http://www.installittoday.com/api/server.php?wsdl 
```

这将告诉您是否可以通过机器连接到该站点。

如果您的机器连接速度有限/拥塞，您也可以尝试多个连接，或者增加 default_socket_timeout。

您要连接哪些端口？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-08T13:56:54.653

对于遇到此错误的任何人。尝试从 php.ini 或 SOAP 调用中的参数禁用 WSDL 缓存。

问题是，PHP 默认将 WSDL 文件缓存在 temp 文件夹中。文件第一次缓存后，PHP 会继续使用该文件。它仅在 24 小时后刷新（缓存的默认 ttl）。

因此，如果您更改 WSDL 文件，PHP 将拾取旧文件，从而导致类似 OP 的错误。马特，您的问题已通过使用从不缓存的文件得到解决。

默认情况下它被缓存的原因是因为您的服务器必须请求文件然后解析它，这需要一些获取和处理。

您有两个选择，要么修改 php.ini 中的相关变量，要么随 SOAP 调用一起发送参数。

例如：

```
$client = new SoapClient($webservice, array('classmap' => $soap_class_map, 'cache_wsdl' => WSDL_CACHE_NONE)); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T05:05:25.980

在这里再次OP。

更多背景信息：我在 installittoday.com 上托管服务（显然）。我也试图从同一个地方运行一个客户端只是为了测试目的。我几乎可以从我尝试过的所有其他站点连接到该服务，并且我已经成功地打开了一些 WSDL，客户端托管在 installittoday 上。由于某种原因，该站点似乎无法连接到自身。

我真诚地怀疑这是一个拥挤的线路问题。

既然我已经走到了这一步，我意识到这个问题可能已经超出了 SOAP 的范围，而是扩展到了某种 Apache 配置问题，除非我缺少一个端口。我没有设置任何不同的端口，是否有一个我应该确保我为 SOAP 开放？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T14:25:23.450

我通过将动态生成的 nusoap WSDL 保存为独立文件解决了这个问题，一切似乎都运行良好。我不知道为什么会这样。

无论如何，我打算将其移至 PHP5，我只是使用 nuSoap 来生成 WSDL。

# php - php字符串解析与前瞻

> ID：800220
> 
> 赞同：2
> 
> 时间：2009-04-28T23:06:01.040
> 
> 标签：php, string

我在 PHP 中有这个字符串：

```
$string = "name=Shake & Bake&difficulty=easy"; 
```

我想解析成数组：

```
Array
(
    [name] => Shake & Bake 
    [difficulty] => easy
) 
```

不是：

```
Array
(
    [name] => Shake
    [difficulty] => easy
) 
```

最有效的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T23:17:07.050

可能有一种更有效的方法可以做到这一点，但请尝试

```
$foo = 'name=Shake & Bake&difficulty=easy';
$pairs = preg_split('{&(?=[^\s])}',$foo);
//$pairs = preg_split('/&(?=[^\s])/',$foo); //equivalent, using different delimiters.
//$pairs = preg_split('%&(?=[^\s])%',$foo); //equivalent, using different delimiters.
$done = Array();
foreach($pairs as $keyvalue){
    $parts = preg_split('{=}',$keyvalue);
    $done[$parts[0]] = $parts[1];
}
print_r($done); 
```

PHP 的正则表达式引擎是 PCRE，它支持前瞻断言。谷歌搜索 PCRE、PHP、RegEx、前瞻断言和零宽度断言应该给你比你想知道的更多的主题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T23:09:28.037

正则表达式似乎是最好的方法。

```
<html>
<head>
  <title>Test params</title>
</head>
<body>
<?php
test_build('a=b');
test_build('blah=foo&foo=foo2');
test_build('blah=foo&foo&foo2=foo3&foo');

function test_build($string) {
  echo "<p>Testing: $string</p>\n";
  $params = build_params($string);
  if ($params) {
    echo "<ul>\n";
    foreach ($params as $k => $v) {
      echo "<li>'$k' => '$v'</li>\n";
    }
    echo "</ul>\n";
  } else {
    echo "<p>Found no parameters.</p>\n";
  }
}

function build_params($string) {
  preg_match_all('!([^=&]+)=([^=]*)(?=(&|$))!', $string, $matches);
  $ret = array();
  for ($i=0; $i<sizeof($matches[1]); $i++) {
    $ret[$matches[1][$i]] = $matches[2][$i];
  }
  return $ret;
}
?>
</body>
</html> 
```

输出：

```
Testing: a=b

    * 'a' => 'b'

Testing: blah=foo&foo=foo2

    * 'blah' => 'foo'
    * 'foo' => 'foo2'

Testing: blah=foo&foo&foo2=foo3&foo

    * 'blah' => 'foo&foo'
    * 'foo2' => 'foo3&foo' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T23:59:42.440

```
<?php
$pattern ='/([^&]+)=([^=]+)(?=$|&[^=]+=)/';

$测试 = 数组（
  'name=Shake & Bake&难度=简单',
  'name=Shake&Bake&难度=简单',
  '难度=容易&名称=摇 & 烘烤',
  '难度=容易&名称=摇&烘焙',
  'name=Shake&Bake',
  '难度=容易',
  'name=Shake&Bake&foo&difficulty=easy',
  'name=Shake&Bake&难度=简单&',
  'name=Shake&Bake&难度='
);
foreach($test as $foo) {
  preg_match_all($pattern, $foo, $m);
  回声 $foo, "\n";
  for($i=0; $i<count($m[0]); $i++) {
    回声''，$m[1][$i]，'=$gt; "', $m[2][$i], "\"\n";
  }
  回声“\n”；
}
?>
```

生产

```
名称=摇和烘烤&难度=容易
  名称=>“摇和烘烤”
  难度=>“容易”

名称=摇&烘焙&难度=容易
  名称=>“摇和烘烤”
  难度=>“容易”

难度=简单&名称=摇和烘烤
  难度=>“容易”
  名称=>“摇和烘烤”

难度=容易&name=摇&烘焙
  难度=>“容易”
  名称=>“摇和烘烤”

名称=摇和烘烤
  名称=>“摇和烘烤”

难度=容易
  难度=>“容易”

name=Shake&Bake&foo&难度=容易
  名称=>“摇&烘焙&foo”
  难度=>“容易”

名称=摇&烘焙&难度=容易&
  名称=>“摇和烘烤”
  难度=>“容易&”

名称=摇&烘焙&难度=
  名称=>“摇和烘烤”
```

这似乎有效（除了上一个示例中的难度=不匹配）。
我不确定一次性子模式匹配是否会提高速度。你可能想看看这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T23:28:44.247

函数[parse_str()](http://us.php.net/manual/en/function.parse-str.php)完全符合您的需要 - 只需确保您出于明显的安全原因传递了第二个参数。但是，您需要翻译输入字符串：

```
$string = "name=Shake & Bake&difficulty=easy";
parse_str(str_replace(' & ', '+%26+', $string), $array); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-29T03:45:20.430

urlencode() “Shake & Bake”中的 & 并使用 parse_str()

# javascript - 为什么 Flash 的 ExternalInterface *有时* 不起作用？

> ID：800228
> 
> 赞同：2
> 
> 时间：2009-04-28T23:12:22.583
> 
> 标签：javascript, flash, externalinterface, intermittent

我有一个 Flash 电影，它有许多通过 ExternalInterface 暴露给 Javascript 的 actionscript 2 函数。通常这部电影可以正常工作，并且 Javascript 可以与之通信。但有时，在没有解释的情况下，Javascript 中的 flash 对象将*不*具有 ExternalInterface 函数。当我在页面上多次安装这个单一的 flash 文件时会发生这种情况，并且经常发生一两个 flash 实例*具有*这些功能，而一两个实例*没有*。相同的闪存源，嵌入页面 3 或 4 次。很奇怪。关于可能出了什么问题，甚至我应该从哪里开始寻找的任何想法？我很茫然。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T07:01:55.233

也许你的问题是当你打电话时 Flash 应用程序还没有准备好。

每当我不得不进行通信 JS > Flash 时，我总是让 Flash “说话”。基本上，启用 Flash 电影在准备好并完全加载时调用的 JS 函数。然后只有这样才能让 JS 端调用 Flash。

！

胡安

# c# - Windows 窗体 TreeView 始终选择焦点上的节点

> ID：800230
> 
> 赞同：5
> 
> 时间：2009-04-28T23:13:31.303
> 
> 标签：c#, winforms, treeview

Windows 窗体中的 TreeView 似乎总是希望在重新获得焦点时选择一个节点。如果我没有选择节点，并且该树视图获得焦点，我将获得一个`AfterSelect`选择第一个节点的事件，即使我没有使用键盘、鼠标或以编程方式选择它。我能找到的唯一解决方法是检查是否`TreeViewCancelEventArgs.Action`相等`TreeViewAction.Unknown`，然后取消选择。这似乎真的很hacky，所以我想知道是否有另一种方法来解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T02:35:30.973

我同意`TreeViewAction.Unknown`在这种情况下使用不太理想。考虑使用`BeforeSelect`事件，它提供了阻止`AfterSelect`事件的机会。

创建一个`GotFocus`设置标志的事件处理程序。然后，创建一个`BeforeSelect`事件处理程序，如果设置了标志，则取消事件并清除标志。例如：

```
private bool treeViewWasNewlyFocused = false;

private void TreeView1_BeforeSelect(object sender, TreeViewCancelEventArgs e)
{
    if(treeViewWasNewlyFocused)
    {
        e.Cancel = true;
        treeViewWasNewlyFocused = false;
    }
}

private void TreeView1_GotFocus(object sender, EventArgs e)
{
    treeViewWasNewlyFocused = true;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-06T14:53:58.513

我通过关闭树视图的 TabStop 解决了这个问题的版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-10T22:50:13.893

我不得不克服未公开 BeforeSelect 事件的同样的问题（但在紧凑的框架上）（我很沮丧）。

但是认为有一个相当优雅的解决方案，希望可以帮助其他人！

我制作了一个派生的 TreeView 控件（因此可以一次选择多个项目），但也会更正获取 FOCUS 时第一个节点的“自动”选择。

*   公共类 TreeView_MultSel : System.Windows.Forms.TreeView

然后我像这样覆盖事件处理程序：

```
/// <summary>
/// //This actually occurs AFTER actual Treeview control:
///   -  Got Focus in reality
///   -  Executed the "innate" behaviour (like a button showing "depressed")
///   -  The "innate and UNWANTED behaviour of the Treeview is to selected the first Node 
///          when gets the focus.
///The key here is the Treeview executes in this order (when Tree Selected and didn't have focus):
///   -  First the Node is selected (before OnGotFocus is executed)
///         Since when LostFocus "treeHasFocus" = false the OnAfterSelect handler isn't called!!
///
///   -  Then the OnGotFocus is called:
///         This will set treeHasFocus to True and will not react to selections
/// </summary>
/// <param name="e"></param>
protected override void OnGotFocus(EventArgs e)
{
    treeHasFocus = true;
    //base.OnGotFocus(e);
}

/// <summary>
/// Alot easier to handle here (in Derived TreeView control then using all kinds of 
///     -= events to try to prevent.
/// 
/// This was the cleanest way I could find (prevent firing of AfterSelect)
/// </summary>
/// <param name="e"></param>
protected override void OnLostFocus(EventArgs e)                
{                                                               
    treeHasFocus = false;                                       
    //base.OnLostFocus(e);
}

/// <summary>
/// -  Treeview Control defaults to selecting the first node (when gets focus)
/// -  We do NOT want this - since would automatically Highlight the first node (select)
/// -  treeHasFocus is NOT true for the first unwanted "automatic" selection of the first item
/// -  Upon loosing Focus, the AfterSelect handler is never called.
/// </summary>
/// <param name="e"></param>
protected override void OnAfterSelect(TreeViewEventArgs e)      
{                                                               
    if (treeHasFocus)                                           
        base.OnAfterSelect(e);                                   
    this.SelectedNode = null;                                   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T09:25:16.390

使用以下代码修复了我的相同问题的版本。

```
private TreeNode _selectedNode;

public FormMain()
{
    InitializeComponent();
    myTreeView.LostFocus += (sender, args) => _selectedNode = myTreeView.SelectedNode;
    myTreeView.GotFocus += (sender, args) => myTreeView.SelectedNode = _selectedNode;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-16T03:27:24.770

`TVM_SELECTITEM`通过发送0 的 lparam解决了这个问题。

# bash - 无法将 Bash 脚本转换为 Zsh 脚本

> ID：800235
> 
> 赞同：5
> 
> 时间：2009-04-28T23:15:53.900
> 
> 标签：bash, zsh

我需要将以下 Bash 代码更改为 Zsh

```
TODO_OPTIONS="--timeout --summary"
         cd ()
         {   
             builtin cd "$@"
             RV=$?
             [ $RV = 0 -a -r .todo ] && devtodo ${TODO_OPTIONS}
             return $RV 
         }   

         pushd ()
         {   
             builtin pushd "$@"
             RV=$?
             [ $RV = 0 -a -r .todo ] && devtodo ${TODO_OPTIONS}
             return $RV 
         }   

         popd ()
         {   
             builtin popd "$@"
             RV=$?   
             [ $RV = 0 -a -r .todo ] && devtodo ${TODO_OPTIONS}
             return $RV 
         }   

         # Run todo initially upon login
         devtodo ${TODO_OPTIONS} 
```

使用代码启动 Zsh 时出现以下错误

```
todo: error, unknown argument '--timeout --summary', try --help 
```

感觉zsh看不懂下面这行

```
[ $RV = 0 -a -r .todo ] && devtodo ${TODO_OPTIONS} 
```

第一个代码中的其他命令似乎适用于 Zsh。

**如何将代码转换为 Zsh？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T23:33:57.073

您将文本保存为一个字符串/对象，而不是简单的“要替换的东西”。您可以正确保存字符串：

```
TODO_OPTIONS=(--timeout --summary)
....
devtodo ${TODO_OPTIONS} 
```

或对您的变量运行分词：

```
TODO_OPTIONS="--timeout --summary"
....
devtodo ${=TODO_OPTIONS} 
```

# security - 在 cmd.exe 中锁定特定命令

> ID：800244
> 
> 赞同：0
> 
> 时间：2009-04-28T23:19:58.277
> 
> 标签：security, windows-xp, sysadmin

任何人都可以推荐一种在 Windows XP 或更高版本中使用户可以访问 cmd.exe 同时锁定使用能力的方法`type`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T23:21:53.187

我相信这种类型是内置在 shell 的命令解析器本身中的，所以我不认为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T23:28:21.237

您总是可以制作 type.bat （什么都不做），甚至可以编译 type.exe 并将其放在路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T23:29:55.833

即使您可以阻止使用`type`，以下命令也会做同样的事情：

```
copy file.txt con 
```

可能有其他方法可以在不使用`type`内置命令的情况下显示文件的内容。记事本（或任何其他文本编辑器）会让人想起。

# python - 如何将变量初始化为无/未定义并与 Python 中的其他变量进行比较？

> ID：800248
> 
> 赞同：8
> 
> 时间：2009-04-28T23:22:37.787
> 
> 标签：python

基本上我有一些我不想预初始化的变量：

```
originalTime = None
recentTime = None
postTime = None

def DoSomething ( ) :
    if originalTime == None or (postTime - recentTime).seconds > 5 :
        ... 
```

我在 if 上得到编译错误：

```
UnboundLocalError: local variable 'originalTime' referenced before assignment 
```

如您所见，所有变量都有不同的关系，要么必须正确设置（时间、时间 + 5 等），要么根本没有，但我不想将它们设置为预先计算的值，而只是将它们声明为 None 是更轻松。

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-29T13:50:16.997

我需要纠正 Jarret Hardie，因为我没有足够的代表发表评论。

全局范围不是问题。Python 将自动在封闭范围内查找变量名。唯一的问题是当您想要更改值时。如果你只是简单地重新定义变量，Python 会创建一个新的局部变量，除非你使用 global 关键字。所以

```
originalTime = None

def doSomething():
  if originalTime:
    print "originalTime is not None and does not evaluate to False"
  else:
    print "originalTime is None or evaluates to False"

def doSomethingElse():
  originalTime = True

def doSomethingCompletelyDifferent()
  global originalTime
  originalTime = True

doSomething()
doSomethingElse()
doSomething()
doSomethingCompletelyDifferent()
doSomething() 
```

应该输出：

```
originalTime is None or evaluates to False
originalTime is None or evaluates to False
originalTime is not None and does not evaluate to False 
```

我赞同他的警告，即这是一个糟糕的设计。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-28T23:34:18.397

您的代码应该可以工作，我猜它在函数内部，但 originalTime 是在其他地方定义的。`originalTime is None`此外，如果这就是你真正想要的，或者更好的说法，那就更好了`not originalTime`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T23:54:33.387

如果`if`语句在函数内部，但`= None`声明在模块级别，则变量超出函数范围。最简单的解决方法是明确指出要在全局范围内找到变量标识符：

```
def doSomething():
    global originalTime
    if originalTime:
        print "originalTime exists and does not evaluate to False" 
```

许多人认为这是糟糕的 Python 设计，顺便说一句。如果您同意该评估，并且您的架构允许，您可能希望重构您的函数，以便它接收外部依赖项作为函数参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-01T19:00:52.857

==> 如果初始值为无

```
>>>toto = None

>>>toto = toto if toto is not None else "default Value"

>>>toto

'default value' 
```

==> 在变量不存在的情况下

```
>>>del toto

>>>toto = toto if locals().get('toto') else "default Value"

>>> toto

'default value' 
```

==> 如果设置了值，则使用相同的命令

```
>>>toto = 1

>>>toto

1

>>>toto = toto if locals().get('toto') else "default Value"

1 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-29T00:24:53.923

没有任何“漂亮”的方式来解决这个问题。仅基于您提供的变量名称，我的第一反应是创建一个对象：

```
class SomeTimeClass(object):
    def __init__(self, recentTime=None, originalTime=None, postTime=None):
        self.recentTime = recentTime
        self.originalTime = originalTime
        self.postTime = postTime

time = SomeTimeClass()
if not time.recentTime::
    ... 
```

这可能会起作用，因为听起来变量是相关的。其他几个选项：

将过程包装在一个函数中：

```
def SomeFunc(recentTime=None, originalTime=None, postTime=None):
    if not recentTime:
        ... 
```

使用字典：

```
some_dict = {}

if not some_dict.get('originalTime', None): #return None if key doesn't exist
    ... 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-04-28T23:30:25.677

我刚刚在 shell 中尝试了您的代码，但没有收到错误消息。它应该工作。也许发布整个代码？你也可以使用 try/catch。

或者也许是 locals().has_key('originalTime') ？

# .net - NHibernate 和多个数据库后端 - 架构

> ID：800249
> 
> 赞同：4
> 
> 时间：2009-04-28T23:23:10.717
> 
> 标签：.net, asp.net, nhibernate

我有一个项目应该在不同的（至少 2 个）数据库后端上运行，因此用户可以选择（目前在 MSSQL 和 SQLite 之间）。我刚刚开始学习 NHibernate，遵循[nhibernate.info 上的教程](http://nhibernate.info/doc/tutorials/first-nh-app/your-first-nhibernate-based-application)。

现在，我当前的架构如下所示：

### 我的项目.DAL

包含**NewsItem**和**INewsItemRepository**。NewsItem 是一个 POCO，本质上只是一个 int Id 和字符串 Title。

INewsItemRepository 是包含 CRUD 功能的接口。

### MyProject.Plugins.DAL.MSSQL

此类实现后端。它包括**hibernate.cfg.xml**、**NewsItem.hbm.xml**和**NewsItemRepository**。

cfg 保存 Driver 和 ConnectionString，hbm 是 SQL-Server 特定的 Mapping，NewsItemRepository 实现 INewsItemRepository。

如果我想添加 MyProject.Plugins.DAL.SQLite，我将不得不复制所有这些，这是合乎逻辑的。但是，我想知道这是否是正确的方法？我觉得我在不必要地重复一些东西。我的意思是：我需要确保映射是特定于数据库的，并且如果数据库发生更改，我会更新我的所有插件。但这种架构似乎仍然以某种方式......臃肿。

我在这里做正确的事吗？或者对于一般业务组合中的内容以及每个数据库需要单独保存的内容是否有共同的模式？

**编辑：**这里的挑战之一是处理 sql 类型。例如，字符串默认映射为 nvarchar(255)，如果我在 MSSQL 中需要 ntext，我将不得不使用 <column sql-type="NTEXT" 语法，对吗？我猜想指定 sql-type 是依赖于数据库的，所以我需要每个数据库分开我的映射？或者是否有一种内置机制可以让映射相互“继承”？（即在一般 DAL 项目中有一个带有所有 <property> 标签的 .hbm.xml，然后在每个包含列的后端程序集中有一个 .hbm？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T02:44:08.130

好吧，我还没有看到您的项目或数据模型，因此您必须将其解释为最适合您的情况。但是，是的，我的反应是，这比必要的代码更多。

使用像 NHibernate 这样的 ORM 的主要好处之一是它们将您的代码与您的持久性架构分开。在我看来，多次映射 NewsItem（例如）是不必要的，例如。无论后端如何，数据模型是否都可能相同？也许你可以举一个他们可能不同的例子。

其次，我可能不会重新实现 NewsItemRepository。无论数据库后端如何，存储库都使用 NHibernate，其主要目的是抽象数据库。存储库处理的所有 CRUD 功能在 MSSQL 上与 SQLite 相同（除非数据模型实际上存在差异）。

如果您的数据库模型在两个后端都相同，理论上您应该只需要更改连接字符串即可更改正在使用的数据库。我之前实现 DAL 的方式是像您一样提供接口，然后为实现提供一个子命名空间，一个（嗯，目前唯一的一个；）是 NHibernate。存储库等。是通过依赖注入获得的。DI 内核也处理会话工厂，因此很容易为不同的代码部分定位不同的数据库。

当然，所有这些都假设您的数据模型在两个数据库引擎上都是相同的。如果不是，我的回答可能不是很有帮助。如果是这样的话，知道有什么不同可能会让我或其他人得到更好的答案。

编辑：

我明白你对 sql 类型的意思。但是，如果您是从 NHibernate 为您的数据库生成模式，那么这只是一个问题。映射属性时，您*不需要*使用`<column>`并且您指定的类型`<property>`是 NHibernate 类型。StringClob 类型将正确处理 NTEXT 字段。

如果您*是*从 NHibernate 映射生成架构*并且*NHibernate 不够聪明，无法为 SQLite 去除 sql-type="NTEXT" （我希望是这样，但我从未使用过架构生成工具），我想我会添加一个构建步骤来清理 SQLite 模式。当然，现在您正在增加流程的复杂性，所以这取决于您。但是，我宁愿让我的代码和映射尽可能简单和干净，只在需要的地方保持复杂性（数据库引擎的挑剔细节）。在我看来，保留两个单独的映射文件是缺少属性映射的秘诀，用户对为什么在使用 SQLite 时不能放入 DOB 感到摸不着头脑；）

EDIT2（关于 DI 与 NH 一起使用）：

这有点主观，因为我确信有很多方法可以将 DI 与 NHibernate 一起使用。我在[Fluent NHibernate](http://fluentnhibernate.org/)和[Ninject](http://ninject.org)中使用 DI 取得了巨大成功，这是一个也使用“流利”DSL 的 DI 框架。Fluent NHibernate (FNH) 提供了一个`IPersistenceConfigurer`用于创建数据库连接字符串的接口（它还提供了许多方言可供选择）。因此，很容易`IPersistenceConfigurer`通过 DI 框架将该服务绑定到提供者。您可以为`ISessionFactory`拥有一个完全注入 D 的工厂做同样的事情。由于 Ninject 使用属性，我的存储库构造函数可能如下所示：

```
[Inject, CRM]
public MyRepository(ISessionFactory sessionFactory) 
```

这将为 CRM 数据库注入一个工厂。我喜欢。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:48:17.540

我通过从配置文件中的连接字符串在代码中配置会话工厂来处理动态切换数据库。我通过询问用户或阅读应用程序设置来决定使用哪个连接字符串。我使用依赖注入将 ISessionFactory 或 ISession 传递给您的存储库，通常是通过将其传递给构造函数。

我没有针对多个数据库提供商执行此操作的任何经验，因此我不知道您会因此遇到什么问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T15:17:38.800

NHibernate 使用的数据类型取决于配置文件中使用的方言。当它处理 xml 时，它会根据每个字段的该方言查找正确的数据类型。您将为每个数据库使用不同的方言，因此可以为整个项目使用相同的 hbm.xml。

# c# - 为什么 LINQ-to-Entities 生成的 SQL 效率这么低？

> ID：800255
> 
> 赞同：0
> 
> 时间：2009-04-28T23:27:48.973
> 
> 标签：c#, linq-to-entities

以下（缩减）代码摘录是一个 Linq-To-Entities 查询，它产生的 SQL（通过 ToTraceString）比手工查询慢得多*。*我做了什么愚蠢的事情，还是 Linq-to-Entities 只是不擅长优化查询？

我在查询的末尾有一个 ToList()，因为我需要在使用它来构建 XML 数据结构之前执行它（这完全是另一种痛苦）。

```
var result = (from mainEntity in entities.Main
              where (mainEntity.Date >= today) && (mainEntity.Date <= tomorrow) && (!mainEntity.IsEnabled)
              select new
              {
                  Id = mainEntity.Id,
                  Sub =
                      from subEntity in mainEntity.Sub
                      select
                      {
                          Id = subEntity.Id,
                          FirstResults =
                              from firstResultEntity in subEntity.FirstResult
                              select new
                              {
                                  Value = firstResultEntity.Value,
                              },
                          SecondResults =
                              from secondResultEntity in subEntity.SecondResult
                              select
                              {
                                  Value = secondResultEntity.Value,
                              },
                          SubSub =
                              from subSubEntity in entities.SubSub
                              where (subEntity.Id == subSubEntity.MainId) && (subEntity.Id == subSubEntity.SubId)
                              select
                                  new
                                  {
                                      Name = (from name in entities.Name
                                              where subSubEntity.NameId == name.Id
                                              select name.Name).FirstOrDefault()
                                  }
                          }
              }).ToList(); 
```

在处理这个问题时，我在 Dates 方面也遇到了一些实际问题。当我试图在我的数据结构中包含返回的日期时，我收到了内部错误“1005”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T05:20:50.060

只是作为一般性观察，而不是基于 Linq-To-Entities 的任何实际经验（尚未）：在单个查询中包含四个嵌套子查询看起来并不是非常高效和快速。

我认为您关于 Linq-to-Entities 生成的 SQL 的（缺乏）质量的非常广泛的陈述是没有根据的——而且您也没有真正通过大量证据来支持它。

[包括Rico Mariani](http://blogs.msdn.com/ricom/archive/2007/06/22/dlinq-linq-to-sql-performance-part-1.aspx)（MS 性能专家）和[Julie Lerman](http://www.thedatafarm.com/blog/2009/03/31/UsingPreCompiledLINQToEntitiesQueriesInWebAppsAndServices.aspx) （“Programming EF”的作者）在内的几位受人尊敬的人在各种测试中表明，总的来说，Linq-to-SQL 和 Linq-to-Entities“引擎”并不是真的那么糟糕——它们总体上至少达到了可能的峰值性能的 80-95%。并非每个 .NET 应用程序开发人员都能做到这一点 :-)

有什么方法可以让您重写该查询或更改检索构成其内容的点点滴滴的方式吗？

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T05:43:52.893

您是否尝试过不通过调用 .ToList() 立即实现结果？我不确定它是否会有所作为，但如果您迭代结果而不是调用 .ToList() ...

```
foreach( var r in result )
{
  // build your XML
} 
```

此外，您可以尝试将一个巨大的查询分解为单独的查询，然后迭代结果。一口气发送所有内容可能是个问题。

# algorithm - 关于在代码中实现算法的一些指示

> ID：800261
> 
> 赞同：2
> 
> 时间：2009-04-28T23:28:33.857
> 
> 标签：algorithm

前几天我想尝试在我的代码中创建斐波那契算法，但我从来不擅长数学。

我最终用循环编写了自己的方法，但它似乎效率低下或不是“正确的方法”。

有没有人有任何关于在代码中实现算法的建议/阅读材料？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T23:31:39.793

我发现[Project Euler](http://projecteuler.net/)对这种事情很有用。它迫使您考虑一种算法，然后实施它。然后，许多问题就如何解决问题进行了广泛的讨论（从幼稚的解决方案到一些非常巧妙的解决方案），您可以使用这些解决方案来查看您做的对与错。

在讨论线程中，您还会发现其他人用许多不同语言提供的各种实现。自己提出解决方案，然后将其与其他人的解决方案进行比较是（恕我直言）学习的好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T23:32:45.670

这两本介绍性书籍都对这类事情有很好的了解： [如何设计程序](http://www.htdp.org/)以及 [计算机程序的结构和解释](http://mitpress.mit.edu/sicp/)

两者都以功能（和方案）为导向，但这很适合这类问题。

最重要的是，你可能会从[Project Euler中得到很多](http://projecteuler.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T23:33:56.293

在 youtube 上查看一些关于算法介绍的讲座。有一些非常非常好的讲座分解了一些最常见的算法，例如斐波那契数列以及如何优化它们。

开始阅读 O 表示法，这样您就可以了解您的算法如何随着可变大小的输入而增长，以及如何对您拥有的算法的运行时间进行分类。

从这个视频系列开始，我发现了关于这个主题的优秀材料：

[算法讲座](http://www.youtube.com/view_play_list?p=BF3763AF2E1C572F)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T23:38:49.197

推导出您的算法测试驱动。通过使用 TDD，我能够正确地编写比以前更复杂的算法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T00:55:08.593

如果您无法将斐波那契函数的伪代码翻译成您的语言，那么您应该去寻找您的语言的基本教程，因为您似乎还没有掌握它的基本习语。

如果您有一个可行的解决方案，但对它感到不安全，请将其展示给其他人以供审查。

# javascript - jQuery 字符串包含操作？

> ID：800265
> 
> 赞同：35
> 
> 时间：2009-04-28T23:29:55.520
> 
> 标签：javascript, jquery, string

在大多数语言（例如 C#）中，例如给定一个字符串，您可以测试（布尔）该字符串是否包含另一个字符串，基本上是该字符串的一个子集。

```
string x = test2;

if(x.contains("test"))
    // do something 
```

如何使用 Javascript/Jquery 以简单的方式做到这一点？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-04-28T23:31:20.590

这是通过[indexOf](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/String/indexOf)完成的，但是如果没有找到它会返回 -1 而不是 False。

*句法*
`string.indexOf(searchValue[, fromIndex])`

*参数*
`searchValue`- 表示要搜索的值的字符串。
`fromIndex`-`string`开始搜索的位置。它可以是 0 到 的长度之间的任何整数`string`。默认值为 0。

*返回* 可以找到子字符串开头的
第一个索引，如果不包含子字符串的任何实例，则返回 -1。`string``string`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-29T00:35:48.123

正如 Paolo 和 cletus 所说，您可以使用 indexOf() 来完成。

值得一提的是它是一个 javascript 函数，而不是 jQuery 函数。

如果你想要一个 jQuery 函数来做到这一点，你可以使用它：

```
jQuery.fn.contains = function(txt) { return jQuery(this).indexOf(txt) >= 0; } 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-28T23:35:03.980

indexOf 运算符适用于简单的字符串。如果你需要更复杂的东西，值得指出的是[Javascript 支持正则表达式](http://www.devarticles.com/c/a/JavaScript/Regular-expressions-in-JavaScript/6/)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-05-18T14:20:20.540

一个简单的包含也很有用，例如：

```
<div class="test">Handyman</div>

$(".test:contains('Handyman')").html("A Bussy man"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-20T22:49:18.233

一个工作示例，仅使用 indexOf 和 jQuery

```
// Add span tag, if not set
$(document).ready(function(c) {
  $('div#content ul.tabs li a').each(function(c){
    // Add span wrapper if not there already
    if( $(this).html().indexOf('span') == -1){
      $(this).html('<span class="tab">' + $(this).html() + '</span>');
    }
  });
}); 
```

DT

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-01T12:16:45.250

尝试实现这一点

```
function function1() {
    var m = document.all.myDiv.contains(myB);
    if (m == true){ 
        m = "YES"
    } else {
        m = "NO"
    }
    alert(m)
} 
```

# c# - Bundle enterprise library instead of installing

> ID：800275
> 
> 赞同：1
> 
> 时间：2009-04-28T23:32:39.760
> 
> 标签：c#, enterprise, enterprise-library

does anybody know if it's possible (or have experience doing so) to simply bundle the microsoft enterprise library components in a .net solution instead of performing the installation? I'm trying to avoid putting a customer through the installation step. Thanks for your response!! :-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T23:47:02.533

Yes, it's possible. If you look at [SCSF](http://msdn.microsoft.com/en-us/library/aa480482.aspx) you will see that SCSF wizards creates a */Lib* directory full of entlib dlls and all of the project of this solution references they.

There is the list of */Lib* (of course you should exclude *SmartClient* assemblies):

```
Microsoft.Practices.CompositeUI.dll
Microsoft.Practices.CompositeUI.WinForms.dll
Microsoft.Practices.CompositeUI.WPF.dll
Microsoft.Practices.EnterpriseLibrary.Common.dll
Microsoft.Practices.EnterpriseLibrary.Data.dll
Microsoft.Practices.EnterpriseLibrary.Data.SqlCe.dll
Microsoft.Practices.EnterpriseLibrary.ExceptionHandling.dll
Microsoft.Practices.EnterpriseLibrary.ExceptionHandling.Logging.dll
Microsoft.Practices.EnterpriseLibrary.Logging.dll
Microsoft.Practices.ObjectBuilder.dll
Microsoft.Practices.SmartClient.ConnectionMonitor.dll
Microsoft.Practices.SmartClient.DisconnectedAgent.dll
Microsoft.Practices.SmartClient.EndpointCatalog.dll
Microsoft.Practices.SmartClient.EnterpriseLibrary.dll 
```

# git - 在 git 中跟踪 remotes/p4/master 分支

> ID：800281
> 
> 赞同：3
> 
> 时间：2009-04-28T23:34:37.053
> 
> 标签：git, perforce, git-p4

我正在克隆一个首先由 git-p4 生成的存储库。git-p4 使用我想跟踪的“remotes/p4/master”分支。我如何告诉正在克隆该 repo 的 git 也跟踪 remotes/p4/master？这样我就可以查看“origin/remotes/p4/master”之类的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T12:58:30.447

您也可以调整获取属性以镜像这些引用，尽管不是标准克隆的一部分。

所以一个像这样的序列：

```
git clone ~/p4/git/services/info-service.git
cd info-service
git config --add remote.origin.fetch +refs/remotes/p4/*:refs/remotes/origin/p4/*
git fetch origin 
```

`refs/remotes/p4/release/1.1`例如，这将获取`info-service.git`到`refs/remotes/origin/p4/release/1.1`您的克隆中，您可以基于它创建一个分支`git checkout -b r1.1-fixes origin/p4/release/1.1`

说了这么多，在我的 Perforce 副本存储库中，我创建了实际的分支来镜像所有 p4 远程分支，主要是为了避免必须经历上述所有事情。它还让我有机会修复从 p4 路径前缀到 git 分支名称的命名（so `p4/main`become `master`、`p4/release/1.1`become`r1.1`等）。我使用我自己的 p4 到 git 复制，但是您可以通过循环使用 p4 远程引用`git for-each-ref`并使用`git update-ref`.

# php - 如何开始从 subversion 存储库部署 PHP 应用程序？

> ID：800294
> 
> 赞同：24
> 
> 时间：2009-04-28T23:40:59.490
> 
> 标签：php, svn, zend-framework, deployment, setup-deployment

我听说过“部署应用程序”这个短语，这听起来比将单个更改的文件上传到服务器要好/更容易/更可靠，但我不知道从哪里开始。

我有一个受版本控制的 Zend Framework 应用程序（在 Subversion 存储库中）。如何“部署”我的应用程序？如果我有一个不想覆盖的“上传”目录，我该怎么办？

我通过第三方托管我的应用程序，所以除了 FTP 之外我知道的不多。如果其中任何一项涉及登录我的服务器，请解释该过程。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-29T08:21:30.347

自动部署 + 运行测试到登台服务器被称为持续集成。这个想法是，如果您签入破坏测试的内容，您会立即收到通知。对于 PHP，您可能需要查看[Xinc](http://code.google.com/p/xinc/)或[phpUnderControl](http://www.phpundercontrol.org/)

不过，您通常*不*希望自动部署到生产环境。正常的做法是编写一些脚本来自动执行任务，但您仍然需要手动启动。[您可以为此使用Phing](http://phing.info/)等框架或其他构建工具（一个流行的选择是[Capistrano](http://www.capify.org/)），但您也可以将几个 shell 脚本放在一起。我个人更喜欢后者。

脚本本身可以做不同的事情，具体取决于您的应用程序和设置，但典型的过程是：

*   ssh 到生产服务器。其余命令通过 ssh 在生产服务器上运行。
*   跑`svn export svn://path/to/repository/tags/RELEASE_VERSION /usr/local/application/releases/TIMESTAMP`
*   停止服务（Apache、守护进程）
*   跑`unlink /usr/local/application/current && ln -s /usr/local/application/releases/TIMESTAMP /usr/local/application/current`
*   跑`ln -s /usr/local/application/var /usr/local/application/releases/TIMESTAMP/var`
*   跑`/usr/local/application/current/scripts/migrate.php`
*   启动服务

（假设你有你的应用程序`/usr/local/application/current`）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T00:18:36.903

不建议自动更新。仅仅因为您的单元测试通过并不意味着您的应用程序是 100% 工作的。如果有人在没有任何新单元测试的情况下签入一个随机的新功能，并且该功能不起作用怎么办？您现有的单元测试可能会通过，但无论如何该功能可能会被破坏。您的用户可能会看到完成了一半的事情。通过签入自动部署，您可能在几个小时内都不会注意到是否有一些不应该有的东西让它生效。

无论如何，如果您真的想要，进行自动部署并不难。您需要一个签入后挂钩，实际上步骤是：

1) 从最新签入中导出 2) 将导出上传到生产服务器 3) 解压/配置新上传的导出

我总是手动执行最后一步。通常它就像 SVN 导出、压缩、上传、解压缩、配置一样简单，最后两个步骤我只是将几个 bash 命令别名在一起来执行。然后我将根应用程序目录换成新的，确保我保留旧的作为备份，这很好。

如果您对在错误自动上线之前捕获错误的能力充满信心，那么您可以考虑使该过程自动化。不过，它给了我摇摆不定的感觉。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-09T21:37:50.953

在我的 webdev 公司，我们最近开始使用[Webistrano](http://labs.peritor.com/webistrano)，它是流行的 Capistrano 工具的 Web GUI。

我们想要一个易于使用、快速部署的工具，具有集中式界面、问责制（谁部署了哪个版本）、回滚到以前的版本，最好是免费的。Capistrano 是众所周知的 Ruby on Rails 应用程序的部署工具，但不是集中式的，主要针对 Rails 应用程序。Webistrano 通过 GUI、问责制对其进行了增强，并添加了对 PHP 部署的基本支持（使用“纯文件”项目类型）。

Webistrano 本身就是一个 Ruby on Rails 应用程序，您可以将其安装在开发或登台服务器上。您为每个网站添加一个项目。向每个项目添加阶段，例如 Prod 和 Dev。

每个阶段可以有不同的服务器来部署，以及不同的设置。编写（或修改）一个“食谱”，这是一个告诉 capistrano 要做什么的 ruby​​ 脚本。在我们的例子中，我只是使用了提供的配方并添加了一个命令来创建指向共享上传目录的符号链接，就像你提到的那样。

当您单击 Deploy 时，Webistrano SSH 进入您的远程服务器，对代码进行 svn 检出，以及您需要的任何其他任务，例如数据库迁移、符号链接或清理以前的版本。当然，所有这些都可以调整，毕竟它只是脚本。

我们对此非常满意，但我花了几天时间来学习和设置，尤其是因为我不熟悉 Ruby 和 Rails。尽管如此，我还是强烈推荐它用于中小型公司的生产用途，因为它被证明非常可靠、灵活，并且为我们节省了很多倍的初始投资。不仅可以加快部署速度，还可以减少错误/事故。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T00:27:56.130

这种事情就是你所说的“持续集成”。Atlassian Bamboo（成本）、Sun Hudson（免费）和 Cruise Control（免费）都是流行的选项（按我的喜好排序）并且支持处理 PHPUnit 输出（因为 PHPUnit 支持 JUnit 输出）。

部署工作可以通过构建后触发器来完成。像这个线程上的其他人一样，在签入（和测试通过）进行自动部署之前，我会非常谨慎。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T15:44:03.563

为了处理上传，经典的解决方案是将实际目录移出主网络空间，只留下一个新版本进行签出（就像我在下面的脚本中所做的那样），然后使用 Apache 将其“别名”回作为网站的一部分放置。

```
Alias /uploads /home/user/uploads/ 
```

但是，如果您对服务器没有太多的控制权，那么您的选择就更少了。

我有一个脚本，用于将给定脚本部署到开发/实时站点（它们都在同一台服务器上运行）。

```
#!/bin/sh

REV=2410
REVDIR=$REV.20090602-1027

REPOSITORY=svn+ssh://topbit@svn.example.com/var/svn/website.com/trunk
IMAGES=$REVDIR/php/i
STATIC1=$REVDIR/anothersite.co.uk

svn export --revision $REV  $REPOSITORY $REVDIR

mkdir -p $REVDIR/tmp/templates_c
chown -R username: $REVDIR
chmod -R 777       $REVDIR/tmp $REVDIR/php/cache/
chown -R nobody:   $REVDIR/tmp $REVDIR/php/cache/ $IMAGES
dos2unix $REVDIR/bin/*sh  $REVDIR/bin/*php
chmod 755 $REVDIR/bin/*sh $REVDIR/bin/*php

# chmod -x all the non-directories in images
find $IMAGES -type f -perm -a+x | xargs -r chmod --quiet -x
find $STATIC1 -type f -perm -a+x | xargs -r chmod --quiet -x

ls -l $IMAGES/* | grep -- "-x"

rm dev && ln -s $REVDIR dev 
```

我输入了用于签出目录名称的修订号和日期/时间。中间的 chmod 也使图像的权限正常，因为它们也符号链接到我们的专用图像服务器。

最后发生的事情是旧的符号链接 .../website/dev/ 重新链接到新签出的目录。Apache 配置的文档根目录为 .../website/dev/htdocs/

还有一个匹配的 .../website/live/htdocs/docroot，同样，“live”是另一个符号链接。这是我的另一个脚本，它将删除实时符号链接，并将其替换为 dev 指向的任何内容。

```
#!/bin/sh
# remove live, and copy the dir pointed to by dev, to be the live symlink
rm live && cp -d dev live 
```

我只是每隔几个 dts 推送一个新版本的网站，所以你可能不想每天多次使用这个（我的 APC 缓存不会喜欢这个网站的几个版本），但对我来说，我发现这对于我自己的部署来说非常没有问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T16:26:20.950

检查 fredistrano，这是一个 capistrano 克隆，效果很好（安装有点混乱，但毕竟运行良好）

[http://code.google.com/p/fredistrano/](http://code.google.com/p/fredistrano/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-17T22:00:13.780

3 年后，我对部署最佳实践有了一些了解。我目前使用一个名为 Capistrano 的工具，因为它易于设置和使用，并且可以很好地处理许多默认设置。

自动化部署过程的基础是这样的：

1.  您的代码已准备好用于生产，因此它带有发布版本的标记：v1.0.0
2.  假设您已经配置了部署脚本，您可以运行脚本，指定您刚刚创建的标签。
3.  脚本 SSH 连接到具有以下目录结构的生产服务器：

    ```
    /your-application
        /shared/
            /logs
            /uploads
        /releases/
            /20120917120000
            /20120918120000  <-- latest release of your app
                /app
                /config
                /public
                ...etc
        /current --> symlink to latest release

    Your Apache document root should be set to /your-application/current/public 
    ```

4.  该脚本使用当前日期时间在发布目录中创建一个新目录。在该目录中，您的代码将更新为您指定的标记。

5.  然后删除原始符号链接并创建一个新符号链接，指向最新版本。

需要在版本之间保留的东西放在共享目录中，并为这些共享目录创建符号链接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T23:46:02.753

这取决于您的应用程序以及测试的可靠性。

在我工作的地方，所有东西都会被检查到存储库中进行审查，然后发布。

从存储库中自动更新对我们来说并不明智，因为有时我们只是签入以便其他开发人员可以拉出更高版本并合并其中的更改。

要执行您所说的操作，需要某种辅助签入和签出，以允许主要签入区域的开发人员之间进行协作。虽然我对此一无所知，或者它是否可能。

还有需要处理的分支和其他类似功能的问题。

# linux - UDP广播和单播通过同一个套接字？

> ID：800302
> 
> 赞同：2
> 
> 时间：2009-04-28T23:44:55.890
> 
> 标签：linux, sockets, udp, broadcast

我有一个 Linux 应用程序，它打开一个 UDP 套接字并将其绑定到一个端口。我通过套接字发送单播数据包没有任何问题。我有机会发送一个广播数据包，所以我启用了 SO_BROADCAST，它允许广播数据包通过，但随后我注意到单播数据包也在广播。这是 UDP 套接字的预期行为，还是我配置错误的可能性更大？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T01:33:38.203

据我了解[SO_BROADCAST](http://linux.die.net/man/7/ip)是一个套接字选项。所以如果你在你的套接字上启用它，这个套接字就会广播。我想如果您想从相同的代码进行单播和广播，您将需要打开不同的套接字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T00:58:52.063

我在这里没有做太多编程，但您可能需要提供有关库、操作系统版本、代码等的更多信息。也许是代码示例？

如果我记得我读过的书，如果你在套接字上设置标志，那将影响从套接字发送的所有数据报，因为套接字基本上是一个网络标志+文件描述符的数据结构。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-07-22T13:56:06.453

我在 Linux 上发现了关于让套接字同时获得单播和广播的相同问题。我解决了以下问题（伪代码）：

1.  `sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)`
    *   打开插座
2.  `setsockopt(sock, SOL_SOCKET, SO_BROADCAST, &1)`
    *   允许从此套接字传入和传出广播
3.  `bind(sock, bindaddr, sizeof(struct sockaddr)`和

> > > `bindaddr.sin_family = AF_INET`
> > > 
> > > `bindaddr.sin_port = <YourPort>`
> > > 
> > > `bindaddr.sin_addr.s_addr = INADDR_ANY`

*   获取任何卡上的所有传入消息`<YourPort>`

需要注意的是没有过滤（请参阅 3\. 中的警告）。因此，您将收到所有消息。发送的消息要么是单播的，要么是广播的，取决于`sendto()`.

# css - 有没有办法从 CSS 类中排除标签

> ID：800304
> 
> 赞同：28
> 
> 时间：2009-04-28T23:45:35.483
> 
> 标签：css

我有适用于表的所有 tr 标签的 css。

所以在我的 html 中，我没有 tr 标签的样式。但是，对于我表中的一个 TR 标签，我不想将通用的 TR 应用于所有表。有没有办法排除这个TR？

```
.statisticsTable {
    border:2px solid #990000;
    width:100%;
}
.statisticsTable tr {
    font-weight : bold;
    font-size : 9pt;
    font-family : Arial,Helvetica,sans-serif,Verdana,Geneva;
    color: #ffffff;
    background-color:#990000;

}

<table class="statisticsTable">
   <tr><td colspan="7" class="tableHeaderText">HUB Statistics</td></tr>
   <tr>
      <th colspan="2">HUB</th>
      <th >House Houlds Evaluated</th>
      <th >Total Debt Owed</th>
   </tr>

       <tr  class="<s:if test="#status.even">even</s:if><s:else>odd</s:else>">
           <td  rowspan=3 valign=top>213-65-6425</td>
           <td >All</td>
           <td >t1</td>
           <td >t2</td> 
```

在上面`<tr>`具有“偶数”或“奇数”类的我不希望它`<tr>`具有 .statisticsTable tr 属性。这可能吗？

我想避免的主要是 background-color: #990000; 和颜色：#ffffff；

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-28T23:52:14.453

CSS 级联，意味着您可以覆盖先前定义的属性的值。

你会这样做：

```
.statisticsTable tr.even, .statisticsTable tr.odd {
    font-weight: normal;
    font-size: DEFAULT; /* what ever your default is */
    font-family: DEFAULT; /* what ever your default is */
    /* I would use the font shorthand property */
    color: DEFAULT;
    background: DEFAULT;
} 
```

如果你想使用 CSS3，你可以使用[:not](http://www.w3.org/TR/css3-selectors/#negation)仅将以下样式应用于不具有偶数或奇数类的 TR 元素：

```
.statisticsTable tr:not(.even):not(.odd) {
    font: bold 9pt Arial,Helvetica,sans-serif,Verdana,Geneva;
    color: #fff;
    background:#990000;
} 
```

**编辑：** ~~not(.even,.odd)~~不是有效的语法，因此不起作用（至少在 Chrome 中不起作用）正确的语法是 :not(selector) ，但是你可以做 :not(selector1):not(selector2) 这些不是() 处于同一级别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T23:55:13.463

在支持 CSS3 伪选择器的浏览器（这包括大多数浏览器，尤其是 IE7 和 IE88 而不是 IE6）中，第二个规则分组的选择器如 .statisticsTable tr:not(.even):not(.odd) 可以你想要什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T23:49:23.057

你有几个选择，在你的情况下我能看到的最简单的方法是在“偶数”和“奇数”类中用进一步的 CSS 覆盖你想要的样式的统计表中的 CSS。

# javascript - jQuery 和 MSXML

> ID：800308
> 
> 赞同：2
> 
> 时间：2009-04-28T23:47:07.400
> 
> 标签：javascript, jquery, internet-explorer, msxml

MSXML6 应该具有最好的安全性、性能、可靠性和 W3C 一致性（[在 Internet Explorer 中使用正确版本的 MSXML](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)）。

**问题：**

1.  为什么 jQuery 不使用 MSXML6？
2.  jQuery 是否使用 MSXML3？（我认为答案是肯定的，请参阅下面的更新...）
3.  我可以从[`IXMLDOMDocument`](http://msdn.microsoft.com/en-us/library/ms759148(VS.85).aspx)实例中获取 MSXML 的版本吗？如果是这样，怎么做？

**更新：**

我根据 Deviant 的回答做了一些研究：

[jQuery](http://jquery.com/)创建[`IXMLHTTPRequest`](http://msdn.microsoft.com/en-us/library/ms759148(VS.85).aspx)对象，该对象最初是与[MSXML 2.0](http://msdn.microsoft.com/en-us/library/ms762314(VS.85).aspx)一起发布的，如下所示：

```
new ActiveXObject("Microsoft.XMLHTTP");
```

`Microsoft.XMLHTTP`是一个[ProgID](http://msdn.microsoft.com/en-us/library/ms757837(VS.85).aspx)，它[仅在 MSXML3 中实现以提供旧版支持](http://msdn.microsoft.com/en-us/library/ms766426(VS.85).aspx)，不推荐使用。如果我正确理解[引用](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)，这将创建一个版本 2.x`IXMLHTTPRequest`对象，在这些版本被[“扼杀”之前。</a>。现在我很确定这个 ProgID 创建了一个 MSXML 3.0`IXMLHTTPRequest`对象。这可能会回答我的第二个问题。](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)

 [以下示例代码展示了如何创建`IXMLHTTPRequest`对象的两个推荐版本：

```
new ActiveXObject("MSXML2.XMLHTTP.3.0"); // MSXML 3.0 ProgID...
new ActiveXObject("MSXML2.XMLHTTP.6.0"); // MSXML 6.0 ProgID... 
```

我已经在 MSXML3 和 MSXML6 中测试了 XSLT 的性能。MSXML6 用不到 1/10 的时间来对一个相当大的 XML 文件进行与 MSXML3 相同的转换！

**参考资料：**](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx) 

[](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)
2.  [jQuery：少写多做的 JavaScript 库](http://jquery.com/)
3.  [`IXMLHTTPRequest`](http://msdn.microsoft.com/en-us/library/ms759148(VS.85).aspx)
4.  [MSXML API 历史](http://msdn.microsoft.com/en-us/library/ms762314(VS.85).aspx)
5.  [GUID 和 ProgID 信息](http://msdn.microsoft.com/en-us/library/ms757837(VS.85).aspx)
6.  [在 Internet Explorer 中使用正确版本的 MSXML](http://blogs.msdn.com/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)
7.  [MSXML 3.0 GUID 和 ProgID](http://msdn.microsoft.com/en-us/library/ms766426(VS.85).aspx)
8.  [MSXML 6.0 GUID 和 ProgID](http://msdn.microsoft.com/en-us/library/ms764622(VS.85).aspx)
9.  [为什么删除了与版本无关的 GUID 和 ProgID](http://msdn.microsoft.com/en-us/library/ms761415(VS.85).aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T00:11:00.133

jQuery 可以。资源：

```
// Create the request object; Microsoft failed to properly
// implement the XMLHttpRequest in IE7, so we use the ActiveXObject when it is available
// This function can be overriden by calling jQuery.ajaxSetup
xhr:function(){
     return window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();
}, 
```

但它显然不能在 Firefox/chrome/safari/opera 等中使用 MSXML。因此，如果您尝试在 html 中使用 MSXML，您的网站将只能在 IE 中运行。所以我不建议你这样做。

jQuery 仅使用 MSXML 作为备份来解决 MS 的 XmlHttpRequest 实现中的错误。

我不会说 MSXML 最符合 XMLHttpRequest 标准。MSXML 早在 XMLHttpRequest 出现之前就存在了，所以这是一个奇怪的比较。[http://www.w3.org/TR/XMLHttpRequest/](http://www.w3.org/TR/XMLHttpRequest/)

jQuery 曾经支持 XML 和 XPath 选择器，但已被弃用。有 jQuery 和 XML 的插件[http://plugins.jquery.com/search/node/xml+type:project_project](http://plugins.jquery.com/search/node/xml+type:project_project)

JSON 通常比 XML 更受欢迎。[http://json.org](http://json.org)

# .net - .Net 3.5 数据库访问

> ID：800311
> 
> 赞同：2
> 
> 时间：2009-04-28T23:47:34.667
> 
> 标签：.net, linq, linq-to-sql, .net-3.5

我想我是老派，当我构建一个项目时，我仍然会考虑编写一个数据库层，其中包括使用数据读取器和数据集等对象......但在我看来，微软自从我上一次以来必须想出更好的工具2.0 中的项目，这将隐藏所有的工作，让开发人员专注于编写逻辑，或者至少减少管道代码。

3.5 是怎么做到的？

谢谢，扬

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T23:50:31.040

在 DataReader/DataSets 之后 - 我认为 - 最好的选择是*Linq2SQL*。Scott Gu 的良好开端：[使用 Linq To SQL](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

当然还有其他选择：

**甲骨文**

*   实体框架：听起来不错，但还不稳定。
*   Telerik Open Access：在直接 SQL 之后可能太陌生了，但我喜欢它
*   [NHibernate](http://sourceforge.net/projects/nhibernate/)或 Fluent NHibernate：**小心**- 很棒的工具，但与普通 ADO.NET 的方法截然不同。
*   仅用于列表：[.NET ORM 工具列表](http://geekswithblogs.net/iupdateable/archive/2009/02/12/whatever-happened-to-.net-orm-tool-x.aspx)

**数据访问工具**（抱歉不知道更好的标题）

*   [Subsonic](http://subsonicproject.com/)：在直接 SQL 操作之后，这可能是 Nr2。（或 Nr1.？）在 Linq To SQL 之后。干净、有据可查的 object2table 透视工具。我个人喜欢它。
*   [企业库数据访问块](http://aspalliance.com/688)：也许第一次并不容易，但使用DataReader。

所以在我看来，你也应该试试*Subsonic*（[这里是快速入门](http://www.tonytestasworld.com/post/HowTo-SubSonic-Introduction.aspx)）和*Linq2SQL*。也许 1-2 个概念验证演示会为您指明方向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T23:52:11.957

好吧...不要打折您对数据集和读者的体验;-)

您可能想查看 Linq to Entities 或 NHibernate 和其他 ORM 之类的东西。但是不要让炒作把你带走，根据你的要求评估它们，你可能会发现在某些情况下你仍然会回到数据集和阅读器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T23:50:56.360

你可以使用像 NHibernate 或 Subsonic 这样的 ORM 工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T23:51:54.143

一种替代方法是使用 ORM 工具，例如 NHibernate 或[Entity Framework](http://msdn.microsoft.com/en-us/library/bb386876(loband).aspx)或 Linq2SQL。如果您喜欢 REST，[ADO.Net 数据服务](http://msdn.microsoft.com/en-us/library/cc956153.aspx)可能是一个不错的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T23:51:11.070

您应该考虑使用诸如 nHibernate 之类的 ORM 框架。有许多可用的框架，它们大大减少了编写“管道”代码的需要。

# java - 使用具有泛型参数的类定义 spring bean

> ID：800313
> 
> 赞同：33
> 
> 时间：2009-04-28T23:49:31.230
> 
> 标签：java, generics, spring

如果我有一个看起来像这样的类：

```
public class MyClass<T extends Enum<T>> {
  public void setFoo(T[] foos) {
    ....
  }
} 
```

我将如何在我的上下文 xml 中将其声明为 bean，以便我可以设置 Foo 数组，假设我知道 T 将是什么（在我的示例中，假设 T 是一个值为 ONE 和 TWO 的枚举）？

目前，只有这样的东西不足以告诉 spring 类型 T 是什么：

```
<bean id="myClass" class="example.MyClass">
  <property name="foo">
    <list>
      <value>ONE</value>
      <value>TWO</value>
    </list>
  </property>
</bean> 
```

编辑：忘记列表标签。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-29T07:53:13.470

Spring 没有对这种情况的通用支持，但编译器只是在这种情况下创建一个类转换。所以正确的解决方案是：

```
<bean id="myClass" class="example.MyClass">
  <property name="foo">
    <list value-type="example.MyEnumType">
      <value>ONE</value>
      <value>TWO</value>
    </list>
  </property>
</bean> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-05-28T16:02:16.980

考虑工作示例。

```
<bean id="simpleInt" 
      class="org.nipr.gateway.service.transaction_assistant.GenericSimple">
    <constructor-arg>
        <!-- this can be any full path to a class -->
        <value>java.lang.Integer</value> 
    </constructor-arg>
</bean> 
```

和

```
<bean id="simpleString"  
      class="org.nipr.gateway.service.transaction_assistant.GenericSimple">
    <constructor-arg>
        <value>java.lang.String</value>
    </constructor-arg>
</bean> 
```

简单的泛型类：

```
public class GenericSimple<T> {
    private Class<T> type;
    public GenericSimple(Class<T> type) {
        this.type = type;
    }
    public T get( T t) {
        return t;
    }
} 
```

最后，测试方法（使用工厂）：

```
public void testGeneric(){
    Factory factory = new Factory(new String[]{"config/beanForGenericTest.xml"});

    GenericSimple<Integer> simpleInt 
        = (GenericSimple<Integer>)factory.getClass("simpleInt");
    System.out.println(simpleInt.get(Integer.valueOf(100)));
    Assert.assertTrue(simpleInt.get(Integer.valueOf(100)).equals(100));

    GenericSimple<String> simpleString = 
        (GenericSimple<String>)factory.getClass("simpleString");
    System.out.println(simpleString.get(new String("Rockets go fast.")));
    Assert.assertTrue(simpleString.get("Rockets go fast.")
        .equals("Rockets go fast."));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T23:59:31.097

```
<bean id="myClass" class="example.MyClass">
  <property name="foo">
    <list>
      <value>ONE</value>
      <value>TWO</value>
    </list>
  </property>
</bean> 
```

或者，您可以定义[自定义编辑器](http://www.stehno.com/node/21)。

# .net - WPF 中的 NameScope 是如何工作的？

> ID：800317
> 
> 赞同：3
> 
> 时间：2009-04-28T23:50:29.153
> 
> 标签：.net, wpf

我在 WPF 中对 NameScopes 有一个奇怪的行为，我创建了一个名为 FadingPopup 的 CustomControl，它是 Window 的一个子类，里面没有什么特别的。

```
<Window.Resources>
    <local:FadingPopup>
        <Button Name="prec" Content="ahah"></Button>
        <Button Content="{Binding ElementName=prec, Path=Content}"></Button>
    </local:FadingPopup>
</Window.Resources> 
```

在此代码段中，绑定不起作用（始终为空）。如果我将这些按钮从资源移动到窗口的内容，如下所示：

```
<Window ...>
    <Button Name="prec" Content="ahah"></Button>
    <Button Content="{Binding ElementName=prec, Path=Content}"></Button>
</Window> 
```

绑定按预期工作。

现在，我尝试了这两个片段之间的混合：

```
<Window...>
    <Window.Resources>
        <local:FadingPopup>
            <Button Name="prec" Content="Haha"></Button>
        </local:FadingPopup>
    </Window.Resources>
    <Button Content="{Binding ElementName=prec, Path=Content}"></Button>
</Window> 
```

它也有效。

显然，如果按钮 prec 在资源中，它会在窗口的 NameScope 中注册自己。但是，似乎 Binding 尝试使用 FadingPopup 的 NameScope （为空）解析 ElementName，因此绑定不起作用......

如果我在我的类 FadingPopup 中指定一个 NameScope，我的第一个片段效果很好：

```
static FadingPopup()
{
    NameScope.NameScopeProperty.OverrideMetadata(typeof(FadingPopup), new PropertyMetadata(new NameScope()));
} 
```

但我不喜欢这个解决方案，因为我不明白为什么，在第一个片段中，prec 是在 Window 的 NameScope 中注册的，但 ElementName 是用 FadingGroup 的 NameScope 解析的（默认情况下为 null）...

有人可以向我解释发生了什么吗？如果我没有为 FadingGroup 指定默认的 NameScope，为什么我的第一个片段不起作用？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2009-04-28T23:58:20.320

你应该检查你的控件上的 DataContext，做这样的事情，你应该没问题。您可能必须添加路径，但可能不需要。

```
<Window.Resources>
    <local:FadingPopup DataContext="{Binding}">
        <Button Name="prec" Content="ahah"></Button>
        <Button Content="{Binding ElementName=prec, Path=Content}"></Button>
    </local:FadingPopup>
</Window.Resources> 
```

# java - Eclipse RCP、SWT、JFace：如何创建仅对视图（而不是整个 shell）具有模式的对话框？

> ID：800321
> 
> 赞同：3
> 
> 时间：2009-04-28T23:51:08.840
> 
> 标签：java, dialog, swt, eclipse-rcp, jface

无论如何要创建一个对视图而不是整个外壳（应用程序）模态的对话框？因此，如果说，我有一个名为 A 的视图覆盖了另一个名为 B 的视图，我想打开一个仅对视图 A 模态的对话框，因此当我切换到视图 B 时，对话框和视图 A 将被覆盖观点 B. 有没有我可以做到这一点，即使这不是正常的做法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T05:05:01.877

我认为实施起来不会那么容易。一种可能性是，您使用 TabFolder，而不是在视图 A 中使用模式对话框。然后，您可以在新选项卡中打开对话框的内容，并强制此选项卡保持在顶部，直到您将其关闭。这是与您需要的行为类似的行为。

这也将允许您将某些内容从视图 B 拖放到视图 A 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T04:25:45.993

工作台恢复的整个想法是将工作台恢复到之前的状态。它不必恢复每个小细节，但如果您不想将视图留空，那么您应该将其恢复到原始状态。这意味着视图 B 应该使用与关闭工作台时相同的输入来恢复。如果在视图 A 关闭后视图 B 及其输入继续存在，则无论视图 A 是否存在，视图 B 及其输入都可以恢复。您当然不应该在工作台还原期间打开对话框。那不会是好的 UI 设计。Eclipse 提供了一个非常易于使用的 memento 框架，可以保存视图的输入。用它。

如果您不熟悉纪念品，请参阅例如[http://wiki.eclipse.org/FAQ_How_does_a_view_persist_its_state_between_sessions%3F](http://wiki.eclipse.org/FAQ_How_does_a_view_persist_its_state_between_sessions%3F)。

# database - 为什么我们需要时态数据库？

> ID：800331
> 
> 赞同：54
> 
> 时间：2009-04-28T23:54:40.143
> 
> 标签：database, temporal-database

我正在阅读有关时间数据库的信息，似乎它们已经建立在时间方面。我想知道为什么我们需要这样的模型？

它与普通的 RDBMS 有何不同？难道我们不能有一个普通的数据库，即 RDBMS，并说有一个触发器，它将时间戳与发生的每个事务相关联吗？可能会对性能造成影响。但我仍然对在市场上有强大案例的时间数据库持怀疑态度。

目前的任何数据库都支持这样的功能吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2010-07-10T10:57:06.813

考虑您的约会/日记 - 它从 1 月 1 日到 12 月 31 日。现在我们可以在日记中查询任何一天的约会/日记条目。这种排序称为**有效时间**。但是，约会/条目通常不按顺序插入。

假设我想知道 4 月 4 日我的日记中有哪些约会/条目。也就是4月4日我日记中存在的所有记录。这是**交易时间**。

假设可以创建和删除约会/条目等。典型的记录具有覆盖条目期间的开始和结束有效时间以及指示条目出现在日记中的期间的开始和结束事务时间。

当日记可能进行**历史修订**时，这种安排是必要的。假设在 4 月 5 日，我意识到我在 2 月 14 日的约会实际上发生在 2 月 12 日，即我在日记中发现了一个错误 - 我可以更正错误以便更正有效时间图片，但现在，我对什么是在 4 月 4 日的日记中是错误的，除非约会/条目的交易时间也被存储。在这种情况下，如果我在 4 月 4 日查询我的日记，它将显示 2 月 14 日存在约会，但如果我在 4 月 6 日查询，它将显示 2 月 12 日的约会。

时态数据库的这种时间旅行特性使得记录有关如何在数据库中纠正错误的信息成为可能。这对于记录修订时间的真实审计数据是必要的，并允许查询与数据如何随着时间的推移进行修订有关。

大多数业务信息应该存储在这种双时间方案中，以便提供真实的审计记录并最大限度地提高商业智能——因此需要在关系数据库中提供支持。请注意，每个数据项在二维时间模型中占据一个（可能是无界的）正方形，这就是人们经常使用 GIST 索引来实现双时态索引的原因。这里的问题是 GIST 索引实际上是为地理数据设计的，并且对时间数据的要求有些不同。

PostgreSQL 9.0 排除约束应该提供组织时间数据的新方法，例如事务和有效时间 PERIOD 不应该为同一个元组重叠。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-29T00:08:12.700

时态数据库有效地存储数据的时间序列，通常具有一些固定的时间尺度（例如秒甚至毫秒），然后仅存储测量数据中的变化。RDBMS 中的时间戳是每次测量的离散存储值，效率非常低。时态数据库通常用于 SCADA 等实时监控应用程序中。一个完善的系统是 OSISoft ( [http://www.osisoft.com/](http://www.osisoft.com/) ) 的 PI 数据库。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-29T01:28:13.180

据我了解（并且过度简化），时间数据库记录有关数据何时有效以及数据本身的事实，并允许您查询时间方面。您最终会处理“有效时间”和“交易时间”表，或涉及“有效时间”和“交易时间”方面的“双时态表”。您应该考虑阅读以下两本书中的任何一本：

*   Darwen、Date 和 Lorentzos “[时间数据和关系模型](https://rads.stackoverflow.com/amzn/click/com/B001E4587Q)”（绝版），
*   和（在一个完全不同的极端）“[在 SQL 中开发面向时间的数据库应用程序](https://rads.stackoverflow.com/amzn/click/com/1558604367)”，Richard T. Snodgrass，Morgan Kaufmann Publishers, Inc.，旧金山，1999 年 7 月，504+xxiii 页，ISBN 1-55860-436- 7\. 那是绝版的，但可以在他的网站[cs.arizona.edu](http://www.cs.arizona.edu/~rts/publications.html)上以 PDF 的形式获得（所以谷歌搜索很容易找到）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-13T13:21:32.593

时态数据库通常用于金融服务行业。一个原因是您很少（如果曾经）被允许删除任何数据，因此记录上的 ValidFrom - ValidTo 类型字段用于提供记录何时正确的指示。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-11-02T15:58:51.677

除了“我可以用它做什么新东西”之外，考虑“它统一了哪些旧东西？”可能会很有用。时态数据库代表“普通”SQL 数据库的一种特殊概括。因此，它可能会为您提供一个统一的解决方案来解决以前看起来不相关的问题。例如：

*   **Web 并发**当您的数据库具有允许多个用户执行标准创建/更新/删除 (CRUD) 修改的 Web UI 时，您必须面对[并发 Web 更改问题](https://stackoverflow.com/questions/7223864/how-do-i-deal-with-concurrent-changes-in-a-web-application)。基本上，您需要检查传入的数据修改是否不会影响自该用户上次看到这些记录以来已更改的任何记录。但是，如果您有一个时间数据库，它很可能已经将诸如“修订 ID”之类的东西与每条记录相关联（由于难以使时间戳唯一且单调递增）。如果是这样，那么这将成为一种自然的“内置”机制，用于防止在数据库更新期间破坏其他用户的数据。
*   **法律/税务记录**法律系统（包括税收）比大多数程序员更重视历史数据。因此，您经常会找到有关发票模式的[建议](https://stackoverflow.com/a/25154387/212264)，并警告您要小心删除记录或以自然方式规范化——这可能导致无法回答基本的法律问题，例如“忘记他们当前的地址，地址是什么？你把这张发票寄到 2001 年？” 有了时间框架基础，这些问题的所有阴谋（它们通常是拥有时间数据库的中途步骤）都消失了。您只需使用最自然的模式，并在有意义时删除，知道您始终可以返回并准确回答历史问题。

另一方面，时间模型本身是完成版本控制的一半，这可能会激发进一步的应用。例如，假设您在 SQL 之上滚动您自己的时间工具并允许分支，就像在修订控制系统中一样。即使是有限的分支也可以很容易地提供“沙盒”——一种随意使用和修改数据库而不会对其他用户造成任何可见更改的能力。这使得在复杂数据库上提供高度逼真的用户培训变得容易。

使用简单合并工具的简单分支也可以简化一些常见的工作流问题。例如，非营利组织可能有志愿者或低薪工人进行数据输入。为每个工作人员提供自己的分支可以让主管在将其合并到“普通”用户可以看到的主分支之前轻松地审查他们的工作或对其进行增强（例如，去重）。分支机构还可以简化权限。如果用户只被授予使用/查看其独特分支的权限，您不必担心防止所有可能的不必要修改；无论如何，您只会合并有意义的更改。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T00:24:59.930

除了阅读[维基百科的文章](http://en.wikipedia.org/wiki/Temporal_database "时态数据库")？维护“审计日志”或类似事务日志的数据库将具有一些“临时”属性。如果您需要回答有关**谁对谁做了什么以及何时做**的问题，那么您就有了一个很好的时态数据库候选人。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-29T00:34:15.367

您可以想象一个简单的时态数据库，它每隔几秒就记录一次您的 GPS 位置。压缩这些数据的机会很大，一个普通的数据库你需要为每一行存储一个时间戳。如果您需要大量的吞吐量，知道数据是临时的并且永远不需要更新和删除一行，那么程序就可以减少典型 RDBMS 中继承的大量复杂性。

尽管如此，时态数据通常只存储在普通的 RDBMS 中。例如，PostgreSQL 有一些[时间扩展](http://wiki.postgresql.org/wiki/Temporal_Extensions)，这使得这更容易一些。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-29T01:50:02.160

想到两个原因：

1.  有些针对插入和只读进行了优化，可以提供显着的性能改进
2.  有些人比传统 SQL 对时间有更好的理解——允许按秒、分钟、小时等对操作进行分组

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-06-12T17:23:25.910

只是一个更新，时态数据库即将进入 SQL Server 2016。

要清除您的所有疑问，为什么需要一个时态数据库，而不是使用自定义方法进行配置，以及 SQL Server 为您配置它的效率和无缝程度，请在此处查看 Channel9.msdn 上的深入视频和演示：[https://channel9 .msdn.com/Shows/Data-Exposed/Temporal-in-SQL-Server-2016](https://channel9.msdn.com/Shows/Data-Exposed/Temporal-in-SQL-Server-2016)

MSDN 链接：[https ://msdn.microsoft.com/en-us/library/dn935015(v=sql.130).aspx](https://msdn.microsoft.com/en-us/library/dn935015(v=sql.130).aspx)

目前使用 SQL Server 2016 的 CTP2（beta 2）版本，您可以使用它。

查看[此视频](http://www.youtube.com/watch?v=t2baJaomY4o)，了解如何在 SQL Server 2016 中使用临时表。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-29T00:07:50.517

我对时间数据库的理解是用于存储某些类型的时间信息。您可以使用标准 RDBMS 进行模拟，但是通过使用支持它的数据库，您可以为许多概念提供内置的惯用语，并且查询语言可能会针对此类查询进行优化。

对我来说，这有点像使用特定于 GIS 的数据库而不是 RDBMS。虽然您可以在普通的 RDBMS 中推送坐标，但拥有适当的表示（例如，通过网格文件）可能会更快，并且拥有诸如拓扑之类的 SQL 原语很有用。

有学术数据库和一些商业数据库。Timecenter 有一些链接。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-29T01:32:30.173

时态数据库有用的另一个例子是数据随时间变化的地方。我在一家电力零售商工作了几年，我们在那里存储了 30 分钟的电表读数。这些仪表读数可以随时修改，但我们仍然需要能够回顾读数的变化历史。

因此，我们有最新的读数（我们对 30 分钟消耗的“当前理解”），但可以回顾我们对消耗的历史理解。当您拥有可以以这种方式调整的数据时，时态数据库可以正常工作。

（话虽如此，我们用 SQL 手工雕刻了它，但那是很久以前的事了。这些天不会做出那个决定。）

# wxpython - wxWidgets：如何在 StyledTextCtrl 中更改插入符号样式（向 scintilla 发送命令）

> ID：800332
> 
> 赞同：1
> 
> 时间：2009-04-28T23:54:57.303
> 
> 标签：wxpython, wxwidgets, caret, scintilla

wxWidgets 有 wxStyledTextCtrl （据我所知）在幕后使用 Scintilla

我对 Scintilla API 了解不多，但我有点想你向它发出命令。

特别是，我想让光标具有块样式，我在 Notepad++ 中找到了以下代码段：

```
execute(SCI_SETCARETSTYLE, CARETSTYLE_BLOCK) 
```

我想在 StyledTextCtrl 中做同样的事情，但我不知道如何进入幕后的 scinitilla 控件。

我该怎么做呢？

PS 我在 wxPython 中工作，但我想这并没有什么不同。

### 更新：

在对 wxWidgets 的 c++ 源代码进行了一些挖掘之后，我发现大多数函数只是调用`SendMsg`，例如：

```
// Get the time in milliseconds that the caret is on and off. 0 = steady on.
void wxStyledTextCtrl::SetCaretPeriod(int periodMilliseconds)
{
    SendMsg(2076, periodMilliseconds, 0);
} 
```

所以我认为这就是向底层闪烁组件发送命令的方式。

所以，我得到了我需要的值

```
#define CARETSTYLE_INVISIBLE 0
#define CARETSTYLE_LINE 1
#define CARETSTYLE_BLOCK 2
#define SCI_SETCARETSTYLE 2512
#define SCI_GETCARETSTYLE 2513

```

2512也是如此`SCI_SETCARETSTYLE`，块样式为2。

所以我`SengMsg`用这些参数调用：

```
self.SendMsg(2512, 2) 
```

但是好像没什么效果！

可能是什么原因？我该如何调试呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T19:16:28.087

你不写你正在使用哪个版本的 wxPython / wxWidgets，但我假设它是 2.8.x 版本。这包含 Scintilla 版本 1.70，而 SVN 主干（即将作为 wxWidgets 版本 2.9 发布）具有 Scintilla 版本 1.75。对 Scintilla 头文件的*grep*显示*SCI_GETCARETSTYLE*和*SCI_SETCARETSTYLE*仅在 wxWidgets 主干中，因此在 wxWidgets 2.8 中根本不会处理这些消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T13:06:32.733

尝试

```
self.SendMsg(msg=2512, lp=2) 
```

# asp.net - 如何在语言更改后翻译母版页中的内容页面（ASP.NET）

> ID：800336
> 
> 赞同：0
> 
> 时间：2009-04-28T23:55:39.453
> 
> 标签：asp.net, master-pages, translation

我在 ASP.NET 的母版页中有一个内容页。发生的事情是用户单击母版页右上角的按钮并更改当前语言。什么按钮正在更改新选择的语言的会话。

发生的情况是，当您单击一个按钮时，在调用母版页和内容页的 Page_Load 之后执行代码。但是在我的按钮中，我调用了一个函数“翻译”来翻译母版页。

不幸的是，我不知道如何处理内容页面。我试图手动重新加载它，但我不知道如何。

这里有人可以帮助我吗？我认为这里不需要该代码，但如果它可以帮助您，只需问我您需要什么，我会更新。

谢谢

贾夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T04:17:11.260

更改用户语言设置后（无论是在线程上还是在您保存该信息的位置）执行 Response.Redirect 到他们已经在的页面。这允许干净的页面加载并减少其他文化特定设置导致问题的可能性（例如日期和时间选择。）

# ms-access-2007 - 我可以在 Asp.net 网页中查看 Access 2007 中开发的报告吗？

> ID：800339
> 
> 赞同：1
> 
> 时间：2009-04-28T23:58:29.463
> 
> 标签：ms-access-2007

我在 Access 2007 中开发了一个报告，我想知道是否有任何方法可以让我在 Asp.net 网页中查看此报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T00:38:39.180

您应该能够像任何其他 DB 一样连接到 Access，并使用 ASP.Net DataGrid 显示数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-06T22:17:10.237

不是 ASP.Net 页面，但一种可能的选择是将报告导出为快照 (*.snp) 文件。然后，您可以将文件嵌入到 HTML 网页中。

但是，您每次都必须重新导出报告才能更新它。用户还必须在他们的 PC[下载链接上安装快照查看器](http://www.microsoft.com/downloads/details.aspx?FamilyID=b73df33f-6d74-423d-8274-8b7e6313edfb&DisplayLang=en&displaylang=en)

我认为它仍然适用于 Access 2007，请参阅[MS kb 文章](http://support.microsoft.com/kb/928357/)

HTML 代码类似于：

[![HTML 示例代码](https://i.stack.imgur.com/5CH0u.jpg)](https://i.stack.imgur.com/5CH0u.jpg)

有关详细信息，请参阅[自动将报表快照发布到 Web](http://office.microsoft.com/en-us/access/HP052612171033.aspx)

# architecture - 识别“表单优于数据”应用程序与 DDD 应用程序

> ID：800346
> 
> 赞同：2
> 
> 时间：2009-04-29T00:03:14.973
> 
> 标签：architecture

我经常看到诸如“App x 没有足够复杂的域来证明多层架构的开销是合理的。它更适合于表单优于数据的方法”这样的陈述。我想知道一个域的哪些特征会迫使人们采用特定的方法。也就是说，你怎么知道什么时候做一些简单的事情，比如数据上的表单，或者什么时候应该在多层、域、DTO 等中构建。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T03:09:17.570

这绝不是确定性的，但我会说数据上的表单主要指的是业务规则纤细且轻量级的领域。也就是说，如果您只是将数据从屏幕输入到或多或少直接进入持久性的平面数据结构中，我认为 DDD 架构并不那么重要。但是，如果您的域由多个聚合组成，并且/或者业务规则非常繁重，那么您可能应该考虑 DDD。

当然，就像我们世界上的所有事物一样，中间有很多灰色区域，您必须做出最好的判断。

[您可以尝试在DDD 留言板上](http://tech.groups.yahoo.com/group/domaindrivendesign/)提出这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T00:09:07.190

这两个选项似乎都描述了软件帮助编写软件的更重量级的鼠标驱动框架。（这些是通常的嫌疑人 - 您直接或间接支付的框架。）

我认为有可能存在位于中间某处的模式和实践。您编写软件的地方，但大多数情况下适合您已经习惯的东西。（我认为关键词是与“模式”紧密结合的关系。）

一个很好的具体例子是新近流行的 MVC 概念框架（及其同类）。这些可以很笼统地对待；您可能会也可能不会根据您的平台、环境和/或个人偏好选择为工具付费。但我认为在很多情况下 MVC 等会不知所措或不知所措（但问题中提供的两个选项之一将是决定性的更合适的选择。）

至少我会非常努力地找到一条中间道路，如果没有其他原因不这样做往往会导致短生命周期模式和工具，以及可伸缩性问题（问题直接提到）。

# sql - SQL AVG（计数（*））？

> ID：800347
> 
> 赞同：8
> 
> 时间：2009-04-29T00:05:05.080
> 
> 标签：sql, oracle, aggregate-functions

我试图找出一个值在一列中出现的平均次数，根据另一列对其进行分组，然后对其进行计算。

我有 3 张桌子有点像这样

```
DVD

ID | NAME
1  | 1       
2  | 1     
3  | 2      
4  | 3

COPY 

ID | DVDID   
1  | 1  
2  | 1  
3  | 2  
4  | 3  
5  | 1

LOAN

ID | DVDID | COPYID  
1  | 1     |  1  
2  | 1     |  2  
3  | 2     |  3    
4  | 3     |  4  
5  | 1     |  5
6  | 1     |  5
7  | 1     |  5
8  | 1     |  2 
```

ETC

基本上，我试图找到出现在贷款表中的所有副本 id 的次数少于该 DVD 所有副本的平均次数。

所以在上面的例子中，dvd 1 的副本 5 出现 3 次，复制 2 两次，然后复制 1 一次，所以该 DVD 的平均值是 2。我想列出出现少于贷款表中的那个数字。

我希望这更有意义...

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T15:10:06.487

Similar to dotjoe's solution, but using an analytic function to avoid the extra join. May be more or less efficient.

```
with 
loan_copy_total as 
(
    select dvdid, copyid, count(*) as cnt
    from loan
    group by dvdid, copyid
),
loan_copy_avg as
(
    select dvdid, copyid, cnt, avg(cnt) over (partition by dvdid) as copy_avg
    from loan_copy_total
)
select *
from loan_copy_avg lca
where cnt <= copy_avg; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T00:14:14.260

这应该在 Oracle 中工作：

```
create view dvd_count_view
select dvdid, count(1) as howmanytimes
  from loans
 group by dvdid;

select avg(howmanytimes) from dvd_count_view; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T03:40:25.653

未经测试...

```
with 
loan_copy_total as 
(
    select dvdid, copyid, count(*) as cnt
    from loan
    group by dvdid, copyid
),
loan_copy_avg as
(
    select dvdid, avg(cnt) as copy_avg
    from loan_copy_total
    group by dvdid
)

select lct.*, lca.copy_avg
from loan_copy_avg lca
inner join loan_copy_total lct on lca.dvdid = lct.dvdid
    and lct.cnt <= lca.copy_avg; 
```

# wcf - 为什么我会收到此 WCF 错误消息？

> ID：800358
> 
> 赞同：8
> 
> 时间：2009-04-29T00:12:52.300
> 
> 标签：wcf, web-services

当我调用我的 WCF 服务时，我收到以下错误。我在这里想念什么？

```
'System.String[]' with data contract name
'ArrayOfstring:http://schemas.microsoft.com/2003/10/Serialization/Arrays'
is not expected. Add any types not known statically to the list of known
types - for example, by using the KnownTypeAttribute attribute or by adding
them to the list of known types passed to DataContractSerializer.'.  Please
see InnerException for more details.

{"There was an error while trying to serialize parameter
http://tempuri.org/:myEntity. The InnerException message was
'Type 'System.String[]' with data contract name
'ArrayOfstring:http://schemas.microsoft.com/2003/10/Serialization/Arrays'
is not expected. Add any types not known statically to the list of known
types - for example, by using the KnownTypeAttribute attribute or by adding
them to the list of known types passed to DataContractSerializer.'.  

Please see InnerException for more details."} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T13:52:53.513

据我所知，您有一个 WCF 函数，它有一个名为“myEntity”的参数。我假设 myEntity 的类型是一个用户定义的类，并用 DataContract 属性装饰，因为它应该是。我还假设 myEntity 的类型有一个成员字段，它是一个字符串数组。让我们假设所有这些都是真的（同样，如果您可以发布您的代码，这将非常有帮助）。

通常，字符串数组，即 string[]，可以很好地序列化。但是，在某些情况下（参见[此处](http://msdn.microsoft.com/en-us/library/aa347850.aspx)和[此处](http://blogs.msdn.com/sowmy/archive/2006/06/06/all-about-knowntypes.aspx)），您可能必须将其添加到已知类型列表中，以便 WCF 正确序列化所有内容。

为此，请添加以下内容：

```
[DataContract]
[KnownType(typeof(string[]))]
public class YourClassNameHere
{
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T05:07:41.670

你还没有发布代码，所以我的回答是基于你有一个你试图序列化的类 myEntity 的假设。尝试对类使用 KnownTypeAttribute

例如

```
[KnownType(typeof(myEntity))] 
```

可以参考以下 MSDN 链接： [KnownTypeAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.knowntypeattribute.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-13T08:59:06.173

是的。如上一篇文章所述，如果您传递类型数组（定义为 DataContract]），则会出现此问题。您需要将此类的数组定义为单独的类型并将其标记为数据协定。

不会工作`

```
[DataContract]
Public class ABC{
}

...

SendData(ABC[]) 
```

`

什么会起作用：

```
Public class Data{ public ABC[] prop{get;set;}}
...
SendData(Data); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-04T11:55:41.563

就我而言，在将 [Serializable] 属性添加到 MyEntity 类之后。然后问题是角色字符串数组的序列化。

```
 [Serializable]
    [KnownType(typeof(string[]))]
    public class MyEntity
    {
       .........
       public string roles[]
       ......... 
    } 
```

[KnownType(typeof(string[]))] 像魔术一样工作！

# c# - 如何将列表框的项目复制到组合框的项目？

> ID：800364
> 
> 赞同：0
> 
> 时间：2009-04-29T00:14:36.897
> 
> 标签：c#, winforms

我想在运行时将列表框中的所有项目复制到组合框的项目中，所以需要帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T00:30:05.550

```
for (int i = 0; i < listBox1.Items.Count; i++)
{
     comboBox1.Items.Add(listBox1.Items[i]);
} 
```

**编辑：**

如果您通过“DataSource”属性填充列表控件，请记住设置源列表框“DisplayMember”和“ValueMember”属性：

```
listBox1.DisplayMember = "DisplayMember";
listBox1.ValueMember = "ValueMember"; 
```

以及相同值的目标组合框属性：

```
comboBox1.DisplayMember = "DisplayValue";
comboBox1.ValueMember = "ValueMember"; 
```

当一个对象被添加到列表中时，列表框会检查“DisplayMember”属性。如果 'DisplayMember' 的值不存在或将其值设置为空字符串，则对列表项中包含的对象调用 ToString() 方法以获取要在列表中显示的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T00:17:50.837

您不能将组合框的数据源设置为与列表框使用的相同吗？

# mercurial - StatHG 不存在

> ID：800367
> 
> 赞同：8
> 
> 时间：2009-04-29T00:16:32.227
> 
> 标签：mercurial, metrics

在 CVS/SVN 世界中，有各种统计/度量工具。例如，[StatCVS](http://statcvs.sourceforge.net/)，[StatSVN](http://www.statsvn.org/)。我还见过其他人。

但是，我还没有看到 Mercurial（又名 hg）的类似统计数据和可视化。

(1) 外面有吗？

(2) 如果有，它们是什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-03-15T18:32:27.183

我们刚刚公开了[StatHG](https://bitbucket.org/fundacion_jala/stathg)项目。该项目的目标是开发一种工具，以从 Mercurial 存储库中提取统计信息，并以与 StatCVS 类似的精神构建关于一组开发人员所做工作的报告。请看一下，看看它是否符合您的需求。如果它没有让我们知道，那么我们可以在 TODO 列表中列出需求。感谢我们能得到的任何反馈！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T21:48:07.600

作为一个初始工具，churn 扩展可以为您提供一些关于存储库的基本统计信息。有关如何激活和使用它的详细信息，请参阅mercurial wiki 上的[ChurnExtension](http://www.selenic.com/mercurial/wiki/index.cgi/ChurnExtension)。

如果您对特定（一组）变更集以及更改的文件感兴趣，那么 diffstat 也是一个很好的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T01:21:54.037

不确定，但最好的办法是在[Mercurial 邮件列表](http://www.selenic.com/mercurial/wiki/index.cgi/MailingLists)上询问。

Hg 仍然相对较新，因此在工具方面它“落后”于 SVN。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-13T11:55:09.327

分布式版本控制系统（例如 Mercurial）通常以产生具有大量合并的复杂历史的方式使用。这使得 StatCVS 生成的一些图（例如代码行与时间的关系）更难阅读。

# c++ - 在 C++ 中初始化对象之前声明一个对象

> ID：800368
> 
> 赞同：76
> 
> 时间：2009-04-29T00:16:51.633
> 
> 标签：c++, scope, declaration, instantiation

是否可以在不实例化的情况下在 C++ 中声明一个变量？我想做这样的事情：

```
Animal a;
if( happyDay() ) 
    a( "puppies" ); //constructor call
else
    a( "toads" ); 
```

基本上，我只想在条件之外声明 a ，以便获得正确的范围。

有没有办法在不使用指针和`a`在堆上分配的情况下做到这一点？也许有一些聪明的参考？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-29T00:21:16.443

不调用构造函数就不能声明变量。但是，在您的示例中，您可以执行以下操作：

```
Animal a(happyDay() ? "puppies" : "toads"); 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-04-29T00:27:42.310

你不能在这里使用引用，因为一旦你离开范围，引用就会指向一个将被删除的对象。

真的，你有两个选择：

1-使用指针：

```
Animal* a;
if( happyDay() ) 
    a = new Animal( "puppies" ); //constructor call
else
    a = new Animal( "toads" );

// ...
delete a; 
```

或使用智能指针

```
#include <memory>

std::unique_ptr<Animal> a;
if( happyDay() ) 
    a = std::make_unique<Animal>( "puppies" );
else
    a = std::make_unique<Animal>( "toads" ); 
```

2-添加一个初始化方法`Animal`：

```
class Animal 
{
public:
    Animal(){}
    void Init( const std::string& type )
    {
        m_type = type;
    }
private:
    std:string m_type;
};

Animal a;
if( happyDay() ) 
    a.Init( "puppies" );
else
    a.Init( "toads" ); 
```

我个人会选择选项2。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-04-29T00:23:36.813

您不能直接在 C++ 中执行此操作，因为该对象是在您使用默认构造函数定义它时构造的。

但是，您可以运行参数化构造函数以开始：

```
Animal a(getAppropriateString()); 
```

或者您实际上可以使用类似的东西`?: operator`来确定正确的字符串。（更新：@Greg 给出了这个语法。见那个答案）

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-04-29T00:35:50.607

我更喜欢格雷格的回答，但你也可以这样做：

```
char *AnimalType;
if( happyDay() ) 
    AnimalType = "puppies";
else
    AnimalType = "toads";
Animal a(AnimalType); 
```

我建议这样做是因为我曾在禁止条件运算符的地方工作过。（叹气！）此外，这可以很容易地扩展到两个替代方案之外。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-29T01:05:58.973

如果您想避免垃圾收集 - 您可以使用智能指针。

```
auto_ptr<Animal> p_a;
if ( happyDay() )
    p_a.reset(new Animal( "puppies" ) );
else
    p_a.reset(new Animal( "toads" ) );

// do stuff with p_a-> whatever.  When p_a goes out of scope, it's deleted. 
```

如果您仍然想使用 . 语法而不是 ->，您可以在上面的代码之后执行此操作：

```
Animal& a = *p_a;

// do stuff with a. whatever 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-29T00:41:09.813

除了 Greg Hewgill 的回答之外，还有其他一些选择：

将代码主体提炼成一个函数：

```
void body(Animal & a) {
    ...
}

if( happyDay() ) {
  Animal a("puppies");
  body( a );
} else {
  Animal a("toad");
  body( a );
} 
```

(Ab) 使用新的展示位置：

```
struct AnimalDtor {
   void *m_a;
   AnimalDtor(void *a) : m_a(a) {}
   ~AnimalDtor() { static_cast<Animal*>(m_a)->~Animal(); }
};

char animal_buf[sizeof(Animal)]; // still stack allocated

if( happyDay() )
  new (animal_buf) Animal("puppies");
else
  new (animal_buf) Animal("toad");

AnimalDtor dtor(animal_buf); // make sure the dtor still gets called

Animal & a(*static_cast<Animal*>(static_cast<void*>(animal_buf));
... // carry on 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-04-18T10:34:34.087

最好的解决方法是使用指针。

```
Animal a*;
if( happyDay() ) 
    a = new Animal( "puppies" ); //constructor call
else
    a = new Animal( "toads" ); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-06-07T15:00:07.497

从 c++17 开始，现在有一种无开销的方法可以做到这一点：[`std::optional`](https://en.cppreference.com/w/cpp/utility/optional). 这种情况下的代码是：

```
#include <optional>

std::optional<Animal> a;
if(happyDay()) 
    a.emplace("puppies");
else
    a.emplace("toads"); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-03-21T09:02:37.017

您还可以使用 std::move：

```
class Ball {
private:
        // This is initialized, but not as needed
        sf::Sprite ball;
public:
        Ball() {
                texture.loadFromFile("ball.png");
                // This is a local object, not the same as the class member.
                sf::Sprite ball2(texture);
                // move it
                this->ball=std::move(ball2);
        }
... 
```

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2009-04-29T00:21:08.957

是的，您可以执行以下操作：

```
Animal a;
if( happyDay() )
    a = Animal( "puppies" );
else
    a = Animal( "toads" ); 
```

这将正确调用构造函数。

编辑：忘记一件事......在声明a时，您仍然必须调用构造函数，无论它是什么都不做的构造函数，还是仍然将值初始化为任何值。因此，此方法创建了两个对象，一个在初始化时创建，一个在 if 语句中。

更好的方法是创建类的 init() 函数，例如：

```
Animal a;
if( happyDay() )
    a.init( "puppies" );
else
    a.init( "toads" ); 
```

这种方式会更有效率。

# c# - 有没有办法让现有类型实现接口？

> ID：800376
> 
> 赞同：3
> 
> 时间：2009-04-29T00:20:39.503
> 
> 标签：c#, interface

假设我编写了一个非常出色的界面。所以，事实上，我想要一些我用来实现它们的内置类型，这样我编写的任何使用这个接口的代码也可以使用内置类型。

```
public interface IKickAss
{
    int Yeahhhhhhh() { get; }
}

public static class Woot
{
    public int Bar(IKickAss a, IKickAss b)
    {
        return a.Yeahhhhhhh - b.Yeahhhhhhh;
    }
}

// What I'd like to do, sort of.
public partial struct Int32 : IKickAss
{
    public int Yeahhhhhhh
    {
        get
        {
            return this;
        }
    }
} 
```

由于很多原因，我多次想要这个。最近的是，我为“uint”实现了基数排序，但还创建了一个简单的“IRadixSortable”接口，它需要属性“uint RadixKey { get }”。这意味着我基本上复制了排序代码：一次用于 uint 数组，另一个用于 IRadixSortable 数组。我宁愿通过使 uint 类型实现 IRadixSortable 来编写一个。有没有办法做到这一点......也许使用反射？

Haskell 可以做到这一点（即可以随时在任何数据类型上实例化类型类），我认为这是它如此强大的一个非常重要的原因。C# 真的可以使用这个特性。也许称它为“扩展接口”:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T00:38:51.317

不使用接口，但您可以使用扩展方法做类似的事情。你只是不会得到“合同”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T00:24:59.367

是和不是。

您可能正在寻找[Duck Typing](http://en.wikipedia.org/wiki/Duck_typing)，请参阅[以下文章](http://www.codeproject.com/KB/cs/nduck.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T03:14:52.017

我看不到内在类型的解决方案，但对于其他类型（即由您或其他人创建的类型），您可以将其子类化并实现您选择的接口。

```
public interface ISortable
{
    // ... whatever you need to make a class sortable
}

public class ExistingType
{
    // whatever
}

public class NewType : ExistingType, ISortable
{
    // ...
} 
```

当然，除非您可以访问现有类型...然后让它实现您的接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T00:29:11.557

泛型呢？基本数值类型都实现了 ICopmarable，因此您可以编写一个 IComparer 实现来传递给数组的 Sort 方法。

或者也许是一种扩展方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T01:05:09.223

如果您控制实例的创建，您可以从类继承并在新的继承者类中实现接口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T01:33:05.240

其他人已经回答了主要问题，但是关于您的特定基数排序方案，您还可以查看 .NET Framework 中用于比较、散列等的模式类型：允许您的基数排序方法的用户传入一个控制排序顺序的对象。例如，使用 RadixKey 属性创建一个 IRadixKeyProvider 接口（类似于 IHashCodeProvider 或 IComparer）。

这并不理想，因为用户每次对集合进行基数排序时都必须传入 IRadixKeyProvider，而不是在集合类型上一劳永逸地定义基数键。（尽管您可以通过为预定义类型创建排序方法的重载来缓解这种情况，该类型在内部创建相关的 IRadixKeyProvider 然后转发到更通用的方法。）当然它并没有解决更通用的场景（是的，我也想要类型类！）。但至少它使您免于重复基数排序代码。

# windows - 互斥锁和临界区有什么区别？

> ID：800383
> 
> 赞同：142
> 
> 时间：2009-04-29T00:23:32.680
> 
> 标签：windows, linux, multithreading, programming-languages

请从Linux、Windows的角度解释一下？

我正在用 C# 编程，这两个术语会有所不同吗？请尽可能多地发布，并附上示例等......

谢谢

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-04-29T00:38:46.933

对于 Windows，临界区比互斥体轻。

互斥体可以在进程之间共享，但总是会导致对内核的系统调用有一些开销。

临界区只能在一个进程中使用，但其优点是它们仅在发生争用时才切换到内核模式 - 非竞争获取，这应该是常见的情况，速度非常快。在争用的情况下，它们进入内核等待某个同步原语（如事件或信号量）。

我编写了一个快速示例应用程序来比较两者之间的时间。在我的系统上进行 1,000,000 次无竞争的获取和释放，互斥量需要一秒钟。对于 1,000,000 次获取，关键部分大约需要 50 毫秒。

这是测试代码，如果 mutex 是第一个或第二个，我运行它并得到类似的结果，所以我们没有看到任何其他效果。

```
HANDLE mutex = CreateMutex(NULL, FALSE, NULL);
CRITICAL_SECTION critSec;
InitializeCriticalSection(&critSec);

LARGE_INTEGER freq;
QueryPerformanceFrequency(&freq);
LARGE_INTEGER start, end;

// Force code into memory, so we don't see any effects of paging.
EnterCriticalSection(&critSec);
LeaveCriticalSection(&critSec);
QueryPerformanceCounter(&start);
for (int i = 0; i < 1000000; i++)
{
    EnterCriticalSection(&critSec);
    LeaveCriticalSection(&critSec);
}

QueryPerformanceCounter(&end);

int totalTimeCS = (int)((end.QuadPart - start.QuadPart) * 1000 / freq.QuadPart);

// Force code into memory, so we don't see any effects of paging.
WaitForSingleObject(mutex, INFINITE);
ReleaseMutex(mutex);

QueryPerformanceCounter(&start);
for (int i = 0; i < 1000000; i++)
{
    WaitForSingleObject(mutex, INFINITE);
    ReleaseMutex(mutex);
}

QueryPerformanceCounter(&end);

int totalTime = (int)((end.QuadPart - start.QuadPart) * 1000 / freq.QuadPart);

printf("Mutex: %d CritSec: %d\n", totalTime, totalTimeCS); 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-04-29T01:14:25.600

从理论上讲，[临界区](http://en.wikipedia.org/wiki/Critical_section)是一段不能由多个线程同时运行的代码，因为代码访问共享资源。

[互斥锁](http://en.wikipedia.org/wiki/Mutual_exclusion)是一种用于保护临界区的算法（有时是数据结构的名称）。

[信号量](http://en.wikipedia.org/wiki/Semaphore_(programming))和[监视器](http://en.wikipedia.org/wiki/Monitor_(synchronization))是互斥体的常见实现。

在实践中，Windows 中有许多互斥锁实现可用。它们的主要区别在于它们的锁定级别、范围、成本以及在不同争用级别下的性能。有关不同互斥体实现成本的图表，请参阅[CLR Inside Out - 使用并发性实现可伸缩性](http://msdn.microsoft.com/en-us/magazine/cc163552.aspx#S7)。

可用的同步原语。

*   [监视器](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)
*   [互斥体](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)
*   [信号](http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx)
*   [ReaderWriterLock](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)
*   [ReaderWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)
*   [联锁](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.aspx)

该`lock(object)`语句是使用实现的[`Monitor`](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)- 请参阅[MSDN](http://msdn.microsoft.com/en-us/library/aa664735(VS.71).aspx)以供参考。

[在过去的几年中，对非阻塞同步](http://en.wikipedia.org/wiki/Non-blocking_synchronization)进行了很多研究。目标是以无锁或无等待的方式实现算法。在这样的算法中，一个进程帮助其他进程完成它们的工作，以便该进程最终可以完成它的工作。因此，即使尝试执行某些工作的其他进程挂起，进程也可以完成其工作。使用锁，他们不会释放他们的锁并阻止其他进程继续。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-29T01:03:14.643

除了其他答案之外，以下详细信息特定于 windows 上的关键部分：

*   在没有争用的情况下，获取临界区就像一个`InterlockedCompareExchange`操作一样简单
*   临界区结构为互斥体留有空间。它最初是未分配的
*   如果临界区的线程之间存在争用，则将分配和使用互斥锁。临界区的性能将下降到互斥锁的性能
*   如果您预计会出现高争用，您可以分配指定旋转计数的临界区。
*   如果临界区与自旋计数发生争用，则试图获取该临界区的线程将自旋（忙-等待）那么多处理器周期。这可以比休眠带来更好的性能，因为执行上下文切换到另一个线程的周期数可能远高于拥有线程释放互斥锁所花费的周期数
*   如果自旋计数到期，将分配互斥锁
*   当所属线程释放临界区时，需要检查是否分配了互斥锁，如果是则设置互斥锁释放等待线程

在 linux 中，我认为它们有一个“自旋锁”，其目的与具有自旋计数的临界区类似。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-04-29T00:31:45.357

关键部分和互斥锁不是操作系统特定的，它们是多线程/多处理的概念。

**关键部分** 是一段只能在任何给定时间由它自己运行的代码（例如，有 5 个线程同时运行，一个名为“critical_section_function”的函数会更新一个数组......你不希望所有 5 个线程立即更新数组。因此，当程序运行critical_section_function() 时，其他线程都必须运行它们的critical_section_function。

**mutex*** Mutex 是一种实现临界区代码的方式（把它想象成一个令牌......线程必须拥有它才能运行临界区代码）

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-04-29T00:28:57.017

互斥锁是一个线程可以获取的对象，防止其他线程获取它。这是建议性的，不是强制性的；线程可以使用互斥锁所代表的资源而不需要获取它。

临界区是操作系统保证不会被中断的一段代码。在伪代码中，它会像：

```
StartCriticalSection();
    DoSomethingImportant();
    DoSomeOtherImportantThing();
EndCriticalSection(); 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-04-29T01:38:11.173

Linux 中与关键选择相同的“快速”Windows 将是[futex](http://linux.die.net/man/2/futex)，它代表快速用户空间互斥锁。futex 和 mutex 之间的区别在于，使用 futex，内核仅在需要仲裁时才涉及，因此您可以节省每次修改原子计数器时与内核对话的开销。那 .. 可以在某些应用程序中节省*大量*协商锁的时间。

futex 也可以在进程之间共享，使用共享互斥锁的方法。

不幸的是，futexes 实现[起来非常棘手](http://people.redhat.com/drepper/futex.pdf)（PDF）。（2018 年更新，它们并不像 2009 年那样可怕）。

除此之外，它在两个平台上几乎相同。您正在以一种（希望）不会导致饥饿的方式对共享结构进行原子的、令牌驱动的更新。剩下的只是实现它的方法。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-29T00:25:45.763

在 Windows 中，关键部分是您的进程的本地部分。可以跨进程共享/访问互斥锁。基本上，关键部分要便宜得多。无法具体评论 Linux，但在某些系统上，它们只是同一事物的别名。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-04-29T01:34:45.783

只是为了增加我的 2 美分，关键部分被定义为一个结构，并且对它们的操作是在用户模式上下文中执行的。

```
ntdll!_RTL_CRITICAL_SECTION
   +0x000 调试信息：Ptr32 _RTL_CRITICAL_SECTION_DEBUG
   +0x004 LockCount : Int4B
   +0x008 递归计数：Int4B
   +0x00c OwningThread : Ptr32 无效
   +0x010 LockSemaphore : Ptr32 无效
   +0x014 旋转计数：Uint4B

```

而互斥体是在 Windows 对象目录中创建的内核对象 (ExMutantObjectType)。互斥操作主要在内核模式下实现。例如，在创建 Mutex 时，您最终会在内核中调用 nt!NtCreateMutant。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-08-15T18:31:20.930

迈克尔的回答很好。我为 C++11 中引入的互斥类添加了第三个测试。结果有点有趣，并且仍然支持他最初对单个进程的 CRITICAL_SECTION 对象的认可。

```
mutex m;
HANDLE mutex = CreateMutex(NULL, FALSE, NULL);
CRITICAL_SECTION critSec;
InitializeCriticalSection(&critSec);

LARGE_INTEGER freq;
QueryPerformanceFrequency(&freq);
LARGE_INTEGER start, end;

// Force code into memory, so we don't see any effects of paging.
EnterCriticalSection(&critSec);
LeaveCriticalSection(&critSec);
QueryPerformanceCounter(&start);
for (int i = 0; i < 1000000; i++)
{
    EnterCriticalSection(&critSec);
    LeaveCriticalSection(&critSec);
}

QueryPerformanceCounter(&end);

int totalTimeCS = (int)((end.QuadPart - start.QuadPart) * 1000 / freq.QuadPart);

// Force code into memory, so we don't see any effects of paging.
WaitForSingleObject(mutex, INFINITE);
ReleaseMutex(mutex);

QueryPerformanceCounter(&start);
for (int i = 0; i < 1000000; i++)
{
    WaitForSingleObject(mutex, INFINITE);
    ReleaseMutex(mutex);
}

QueryPerformanceCounter(&end);

int totalTime = (int)((end.QuadPart - start.QuadPart) * 1000 / freq.QuadPart);

// Force code into memory, so we don't see any effects of paging.
m.lock();
m.unlock();

QueryPerformanceCounter(&start);
for (int i = 0; i < 1000000; i++)
{
    m.lock();
    m.unlock();
}

QueryPerformanceCounter(&end);

int totalTimeM = (int)((end.QuadPart - start.QuadPart) * 1000 / freq.QuadPart);

printf("C++ Mutex: %d Mutex: %d CritSec: %d\n", totalTimeM, totalTime, totalTimeCS); 
```

我的结果是 217、473 和 19（请注意，我最后两次的时间比率与迈克尔的大致相当，但我的机器比他的机器至少年轻 4 岁，因此您可以看到 2009 年到 2013 年间速度增加的证据，当 XPS-8700 出来时）。新的互斥锁类的速度是 Windows 互斥锁的两倍，但仍不到 Windows CRITICAL_SECTION 对象速度的十分之一。请注意，我只测试了非递归互斥锁。CRITICAL_SECTION 对象是递归的（一个线程可以重复进入它们，只要它离开的次数相同）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-03-27T06:55:09.360

如果 AC 函数仅使用其实际参数，则称为可重入函数。

可重入函数可以被多个线程同时调用。

可重入函数示例：

```
int reentrant_function (int a, int b)
{
   int c;

   c = a + b;

   return c;
} 
```

不可重入函数示例：

```
int result;

void non_reentrant_function (int a, int b)
{
   int c;

   c = a + b;

   result = c;

} 
```

C 标准库`strtok()`是不可重入的，不能同时被 2 个或更多线程使用。

一些平台的 SDK 带有被`strtok()`调用的可重入版本`strtok_r()`；

# javascript - 使用 javascript/ajax 将密码值传递给 php 页面

> ID：800393
> 
> 赞同：0
> 
> 时间：2009-04-29T00:26:46.493
> 
> 标签：javascript

iam 使用简单的插入脚本函数将值从注册 html 页面传递到注册 php 页面。这是我的脚本：

```
function insert() {
// Optional: Show a waiting message in the layer with ID login_response
document.getElementById('insert_response').innerHTML = "Just a second..."
// Required: verify that all fileds is not empty. Use encodeURI() to solve some issues about character encoding.
var dispname= encodeURI(document.getElementById('disp_name').value);
var firstname= (document.getElementById('first_name').value);
var lastname= (document.getElementById('last_name').value);
var gender= (document.getElementById('genderreg').value);
var day= (document.getElementById('day').value);
var month= (document.getElementById('month').value);
var year= (document.getElementById('year').value);
var country= (document.getElementById('countryreg').value);
var city= (document.getElementById('cityreg').value);
var suburb= (document.getElementById('suburbreg').value);
var email= (document.getElementById('emailreg').value);
var password= (document.getElementById('regpassword').value);
var code= (document.getElementById('code').value);
var service= (document.getElementById('termservice').value);

// Set te random number to add to URL request
nocache = Math.random();
// Pass the login variables like URL variable
http.open('get', 'register_insert.php?site_url='+dispname+'&fname= '+firstname+'&lname= '+lastname+'&gender= '+gender
          +'&day= '+day+'&month= '+month+'&year= '+year+'&country= '+country+'&city= '+city+'&suburb= '+suburb
          +'&email= '+email+'&password= '+password+'&code= '+code+'&service= '+service+'&nocache= '+nocache);
http.onreadystatechange = insertReply;
http.send(null);
} 
```

我只是有一个小问题，将这样的密码值从 html 传递到 php 页面是一种很好的做法。如果这不是一个好主意，那么最好的做法是什么。

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T00:45:45.463

是的，通常我不会立即建议某人去 javascript 库，但我对 AJAX 例外。让这种东西跨浏览器工作是完全不值得的。选择 jQuery 并为自己节省一大堆压力。

还请查看 jQuery Form Plugin - 它会以一种非常简单的方式为您完成所有这些工作。该站点位于[http://malsup.com/jquery/form/](http://malsup.com/jquery/form/)。

但要回答你的问题，我会使用 POST 数据。一般的经验法则是，如果您要检索某些内容，请使用 GET，但如果您要发送或更改某些内容，请使用 POST。

另一个快速提示是，通过执行以下操作可以使代码更加清晰：

```
var fields = {'disp_name', 'first_name', 'last_name', 'genderreg' /* etc ... */ ];
var values = {};
for (var i = 0, l = fields.length; i < l; ++i) {
    values[fields[i]] = document.getElementById(fields[i]).value;
}

http.open(
    'get',
    'register_insert.php'
    + '?site_url=' + values.dispname
    + '&fname=' + values.first_name
    + '&lname=' + values.last_name /* etc */
); 
```

...但我想这并不是那么重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T00:33:58.487

以这种方式发送密码与通过 GET 的常规 From Submission 没有什么不同。但是，通常您会使用 POST。使用 get 的缺点是密码会出现在 URL 中。如果您关心安全性，您应该使用 SSL。

考虑使用像 jQuery 这样的 JS 库......它会让你在上面做的事情......非常容易。

# vb.net - 使用 vb 2008 (vb.net) 剪切字符串中的第一个 3 字符

> ID：800405
> 
> 赞同：0
> 
> 时间：2009-04-29T00:30:36.063
> 
> 标签：vb.net, visual-studio-2008

有谁知道如何在 vb 2008 中剪切字符串中的第一个 3 个字符？

例如： Dim i As String = "ABCDEF";

我只想剪切第一个 3 个字符，系统只会在“剪切”操作完成后显示“ABC”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T00:35:01.107

那将是

```
i.Substring(0, 3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T00:32:29.740

[你想要 Substring](http://msdn.microsoft.com/en-us/library/aka44szs(VS.85).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T00:36:17.860

对于这种类型的事情，您应该考虑使用“左”功能。“中”也可以。

# macos - 在 Mac 的 Zsh 中找不到文件夹中一分钟的文件

> ID：800409
> 
> 赞同：1
> 
> 时间：2009-04-29T00:32:37.307
> 
> 标签：macos, find, zsh, rm

我需要找到正好一分钟在废纸篓文件夹中的文件。这些文件已在我的计算机上移动到该文件夹​​中。

我运行以下失败

```
find -atime n1m . 
```

我通过命令将所有文件都放在目录中，即使是我刚刚创建的文件。似乎 -atime 选项不正确。

**如何找到访问时间为一分钟的文件？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T00:45:09.803

放下`n`. 手册页中的`n`代表一个数字。

```
find -atime 1m . 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T00:48:45.643

既然您提到您正在使用 zsh，我不妨建议一个特定于 zsh 的答案。要查找访问时间为分钟或更短的所有文件，可以使用以下命令：

```
$> ls *(.am-1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T00:48:47.143

我想你正在寻找

`find -amin 1`

`n`只是一个用数字替换的变量。

`+n`eg`+1`表示大于
`n`eg`1`完全表示
`-n`eg`-1`表示小于

# sharepoint - 在没有 Active Directory 的情况下设置面向 Internet 的 WSS 3.0 站点的提示

> ID：800420
> 
> 赞同：1
> 
> 时间：2009-04-29T00:37:29.900
> 
> 标签：sharepoint, wss

我们正在尝试在没有 Active Directory 的情况下设置面向 Internet 的 WSS 3.0 站点。我们有一个 WFE 和一个 SQL Server (2005)。WFE 将在我们的 DMZ 之外。

我们已经成功地使用 WFE 上的本地管理员帐户和用于数据库的 SQL 服务器上的单独帐户创建了 Central Admin 站点，但我们仍坚持设置 WSS 搜索功能。

使用 Central Admin 启动 WSS 搜索服务时，我似乎无法正常工作。我想我需要使用 stsadm -spsearch 手动设置 WSS 搜索，而不是使用 Central Admin 中的菜单。

有没有人推荐任何提示和/或资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T15:49:45.780

在尝试类似的事情时，我遵循了本指南。这解释了如何在同一站点上允许基于表单和 AD 身份验证，但您可以按照说明如何设置基于表单的部分进行操作。

这还包括更改用于中央管理的 web.config 文件，以便它可以访问用于存储用户以进行基于表单的身份验证的 SQL 数据库。

[这很容易理解。](http://www.andrewconnell.com/blog/articles/HowToConfigPublishingSiteWithDualAuthProvidersAndAnonAccess.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T17:53:43.523

您希望使用基于表单的身份验证、ASP.Net SQL 成员资格提供程序和后端数据库来设置您的 WSS3 站点。

[Microsoft 在 MSDN 上有一个非常好的指南](http://msdn.microsoft.com/en-us/library/bb975136.aspx?ppud=4)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T17:49:48.757

我们正在寻找相同的...而不是我们有一个单独的 AD 用于我们的 DMZ，但是，对于外联网，希望在没有 AD 帐户的情况下使用它。请问到目前为止你有什么想法吗？

看过有关本地计算机帐户的帖子，但我们确实有 2 个应用程序服务器，并且如果我们使用本地计算机帐户，则需要进行维护以使它们保持同步。发誓我看到了一个 3rd 方工具，它允许将用户添加到他们自己的数据库中并通过他们的 web-part/portal 进行管理，但现在似乎找不到它。

# xaml - XAML 用于旋转、圆形图像，具有透明中心

> ID：800423
> 
> 赞同：1
> 
> 时间：2009-04-29T00:38:48.383
> 
> 标签：xaml

我正在寻找可以代表加载图标的 xaml，就像 vista 一样。

视觉说明：

*   圆形（约 1/3 英寸宽）
*   浅蓝色
*   透明中心
*   凝胶按钮外观（圆形边缘带有一点阴影）
*   边缘周围的白色微调器，以提供运动

浅（呃）天蓝色/凝胶包看起来

我发现了旋转的矩形，我们可以创建 XAML 来产生旋转的错觉，但我们只是绘制了时钟的 12 个部分，并分别为每个部分设置动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T06:19:21.403

它绝对必须是完整的 XAML 吗？对于这种效果，透明的 PNG 效果很好。只需将 PNG 堆叠在一个网格中，并使用 RotateTransform 和 DoubleAnimation 为其中一些设置动画。

如果您的应用程序不必放大太多，那将是最简单的方法。

问候，劳伦特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T16:36:47.067

这是我在 SL 中创建的一个超级简单的微调器，您可以将其转换为 WPF。

```
<UserControl x:Class="Spinner.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <UserControl.Resources>
        <Storyboard x:Name="Animiation" RepeatBehavior="Forever">
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0"  Duration="0:0:.25" Storyboard.TargetName="e1" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.125"  Duration="0:0:.25" Storyboard.TargetName="e2" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.25"  Duration="0:0:.25" Storyboard.TargetName="e3" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.375"  Duration="0:0:.25" Storyboard.TargetName="e4" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.5"  Duration="0:0:.25" Storyboard.TargetName="e5" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.625"  Duration="0:0:.25" Storyboard.TargetName="e6" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.75"  Duration="0:0:.25" Storyboard.TargetName="e7" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.825"  Duration="0:0:.25" Storyboard.TargetName="e8" Storyboard.TargetProperty="Opacity"/>
        </Storyboard>
    </UserControl.Resources>
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid Width="100" Height="100" x:Name="gridSpinner">
            <Ellipse x:Name="e1" Margin="40,80,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e2" Margin="12,68,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e3" Margin="0,40,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e4" Margin="12,12,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e5" Margin="40,0,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e6" Margin="68,12,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e7" Margin="80,40,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e8" Margin="68,68,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
      </Grid>
    </Grid>
</UserControl> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T20:52:37.910

@Joeln，谢谢，我能够将其转换为 WPF，并得到我需要的东西，谢谢。

```
<Page   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Page.Triggers>
<EventTrigger RoutedEvent="Page.Loaded">
    <BeginStoryboard Name="beginThis">
        <Storyboard x:Name="Animiation" RepeatBehavior="Forever">
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0"  Duration="0:0:.25" Storyboard.TargetName="e1" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.125"  Duration="0:0:.25" Storyboard.TargetName="e2" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.25"  Duration="0:0:.25" Storyboard.TargetName="e3" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.375"  Duration="0:0:.25" Storyboard.TargetName="e4" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.5"  Duration="0:0:.25" Storyboard.TargetName="e5" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.625"  Duration="0:0:.25" Storyboard.TargetName="e6" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.75"  Duration="0:0:.25" Storyboard.TargetName="e7" Storyboard.TargetProperty="Opacity"/>
            <DoubleAnimation To=".5" AutoReverse="True" BeginTime="0:0:0.825"  Duration="0:0:.25" Storyboard.TargetName="e8" Storyboard.TargetProperty="Opacity"/>
        </Storyboard>
    </BeginStoryboard>
</EventTrigger>
</Page.Triggers>
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid Width="100" Height="100" x:Name="gridSpinner">
            <Ellipse x:Name="e1" Margin="40,80,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e2" Margin="12,68,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e3" Margin="0,40,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e4" Margin="12,12,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e5" Margin="40,0,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e6" Margin="68,12,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e7" Margin="80,40,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            <Ellipse x:Name="e8" Margin="68,68,0,0" Height="20" Width="20" Fill="Gray" Stretch="Fill" VerticalAlignment="Top" HorizontalAlignment="Left"/>
      </Grid>
    </Grid>

</Page> 
```

# iis - 在同一站点上运行 asp.net 2.0 和 1.1...在一个区域工作但在另一个区域崩溃

> ID：800426
> 
> 赞同：0
> 
> 时间：2009-04-29T00:39:16.727
> 
> 标签：iis, asp.net-2.0

我们的站点正在运行 ASP.NET 1.1，我需要让 ASP.NET 2.0 在同一站点的单独部分中运行，直到我们完全转换它。我创建了新文件夹，在 IIS 中，我在文件夹上“创建应用程序”进程。然后，我转到 ASP.NET 选项卡并将我的新应用程序的版本更改为 2.0。这在我的本地计算机上运行良好，并且对于完成同事创建的相同任务的管理文件夹也运行良好，但对于此文件夹，它使站点的 .NET 1.1 部分崩溃并给出以下错误消息（下） . 我在我的新文件夹中“删除了应用程序”，它修复了错误。

```
=====================================
Server Application Unavailable 
The web application you are attempting to access on this web server is
currently unavailable.  Please hit the "Refresh" button in your web
browser to retry your request. 
===================================== 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T00:43:24.580

不能在同一个应用程序池中运行两个不同版本的 ASP.NET。您将需要两个单独的应用程序池和两个单独的网站来从同一个 IIS 安装中提供 ASP.NET 1.1 和 ASP.NET 2.0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T00:44:10.600

您的问题在于您将应用程序添加到的应用程序池。.NET 1.1 和 .NET 2.0 不能在同一个 AppPool 中并行运行。（它们当然不能在同一个文件夹或虚拟目录中运行）。

处理此问题的最简单方法是创建一个名为 .NET 1.1 的 AppPool 和一个名为 .NET 2.0 的 AppPool。

当您运行“创建应用程序”时，请确保为应用程序使用的 .NET 版本选择正确的 AppPool。

这应该会在您运行应用程序时处理任何错误。

# ruby - 猜一个数字 - Ruby Online

> ID：800431
> 
> 赞同：0
> 
> 时间：2009-04-29T00:44:00.837
> 
> 标签：ruby

我一直在尝试创建一个 Ruby 程序，该程序将在线运行，用户可以猜测一个数字，它会说更高或更低。我知道它将在变量中存储一个随机数，然后运行一个循环？有条件检查？

我不要求完整的代码，我可以使用它的基本结构来让我继续前进。

知道我会怎么做吗？我找到了创建这样一个随机数的信息：

```
x = rand(20) 
```

更新：我要使用的代码是这样的：http: [//pastie.org/461976](http://pastie.org/461976)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T00:59:39.970

我会说做这样的事情：

```
x = rand(20)

loop {
  # get the number from the user somehow, store it in num
  if num == x
    # they got it right
    break
  elsif num > x
    # the guess was too high
  else
    # the guess was too low
  end
} 
```

如果您在线运行它，这种结构可能不可行。您可能需要将猜测存储在用户的会话中并有一个用于猜测的文本框，并将其提交给一个控制器，该控制器将具有上述代码而没有循环构造，如果它们没有，只需将它们重定向到带有消息的同一页面做对了。

# perl - 如何创建在不同标量上下文中返回不同值的对象？

> ID：800436
> 
> 赞同：4
> 
> 时间：2009-04-29T00:45:13.500
> 
> 标签：perl, scalar

我想在字符串上下文和数字上下文中返回一个不同的值[`$!`](http://perldoc.perl.org/perlvar.html#%24%21)。我知道我可以通过 wantarray 找出我是在列表还是标量上下文中，但是在纯 Perl 中有什么方法可以确定我在哪个标量上下文中？我假设 XS 中也有答案，如果在纯 Perl 中无法做到，我愿意接受这个答案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-29T00:49:17.173

查看`Scalar::Util`模块，特别是`dualvar()`功能：

```
use Scalar::Util qw(dualvar);

my $scalar = dualvar 10, "Hello";
my $twelve = $scalar + 2;          # $twelve = 12
my $greeting = $scalar . " world"; # $greeting = "Hello world" 
```

`Scalar::Util`是核心发行版的一部分，应该可以在任何你有 Perl 的地方使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T00:39:39.243

虽然我可以提出有用的情况（可能是罗马数字），但最好创建一个具有整数和字符串属性的对象。在适当的上下文中使用适当的属性。

这为您提供了额外的灵活性，可以使用“使用重载”来重载操作。在罗马数字示例中，dualvar 将一直有效，直到您想将 2 个罗马数字相加。

# powershell - 通过 WebDAV 编写文件操作脚本的推荐解决方案？

> ID：800440
> 
> 赞同：2
> 
> 时间：2009-04-29T00:46:12.657
> 
> 标签：powershell, webdav

我有一个任务：必须检查远程服务器上通过 WebDAV 可用的文件（需要 SSL），以确定它们最近是否已更新，如果已更新，则将其复制到本地文件夹。在它们到达后还需要执行许多其他操作（复制到其他文件夹、处理等）。我使用的操作系统是 Windows 2003 Server。我希望能够使用 PowerShell 来完成这项任务。

自然，我需要浏览文件。我已经初步研究了几种解决方案：

*   尝试使用“net use”映射驱动器（到目前为止，我收到系统 67 错误）
*   使用像 WebDrive 这样的产品来映射驱动器（碰巧，WebDrive 和服务器上的另一个实用程序似乎出于神秘的原因相互冲突）
*   通过 PowerShell 使用 .NET HTTPWebRequest 对象层次结构发出 http 请求来浏览和操作文件（有效，但似乎有点复杂）
*   购买可简化 WebDAV 使用的商业 .NET 程序集（我见过的那些看起来很贵）

你需要做类似的事情吗？哪种方法最好？我错过了什么？TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T20:01:43.990

它将在 powershell 中工作。注意这个例子：

[http://thepowershellguy.com/blogs/posh/archive/2008/05/31/cd-into-sysinternals-tools-from-powershell.aspx](http://thepowershellguy.com/blogs/posh/archive/2008/05/31/cd-into-sysinternals-tools-from-powershell.aspx)

问题是“Web 客户端服务”没有在 Windows 2003 服务器上运行（默认情况下它被禁用）。

线索是[“系统 67 错误”](http://www.tech-archive.net/Archive/SharePoint/microsoft.public.sharepoint.portalserver.development/2005-07/msg00294.html)

我从 win2k3 服务器确认了这一点，启动“网络客户端服务”将使 WebDAV 工作（可能还有 powershell）。它可以在 XP 客户端上开箱即用（服务默认运行）。

如果这不能为您解决问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-29T01:37:10.437

作为 PowerShell 的替代方案，您始终可以通过 WSH 脚本执行此操作。例子：

```
<job>
  <reference object="ADODB.Connection"/>
  <object id="cnIPP" progId="ADODB.Connection"/>
  <object id="recDir" progId="ADODB.Record"/>
  <script language="VBScript">
  Option Explicit

  Private waArgs
  Private strSubDir
  Private rsItems
  Private strLine

  Set waArgs = WScript.Arguments

  If waArgs.Count < 3 Then
    WScript.Echo "Parameters: FolderURL User PW [SubDir]"
    WScript.Quit
  End If

  cnIPP.Open "Provider=MSDAIPP.DSO;Prompt=NoPrompt;" _
           & "Connect Timeout=10;" _
           & "Data Source=" & waArgs(0), _
             waArgs(1), waArgs(2), adConnectUnspecified

  If waArgs.Count = 4 Then
    strSubDir = waArgs(3)
  Else
    strSubDir = vbNullString
  End If
  Set waArgs = Nothing

  recDir.Open strSubDir, cnIPP, adModeRead, adFailIfNotExists, _
              adDelayFetchFields Or adDelayFetchStream
  Set rsItems = recDir.GetChildren()
  With rsItems
    WScript.Echo .Fields("RESOURCE_PARENTNAME").Value
    Do Until .EOF
      If .Fields("RESOURCE_ISCOLLECTION").Value Then
        strLine = "  [DIR] " & .Fields("RESOURCE_PARSENAME").Value
      Else
        strLine = "       " _
                & " " & .Fields("RESOURCE_PARSENAME").Value _
                & " " & CStr(.Fields("RESOURCE_LASTWRITETIME").Value)

      End If
      WScript.Echo strLine
      .MoveNext
    Loop
    .Close
  End With
  Set rsItems = Nothing
  recDir.Close

  cnIPP.Close
  </script>
</job> 
```

示例运行：

```
D:\Scripts>cscript WebDAV.wsf https://my.dav.com/~fred fred fredPW
Microsoft (R) Windows Script Host Version 5.7
Copyright (C) Microsoft Corporation. All rights reserved.

https://my.dav.com/~fred
        junk.htm 2/26/2008 4:28:44 AM
        test.log 3/30/2009 12:30:45 PM
  [DIR] _private
  [DIR] stuff

D:\Scripts> 
```

这种方法无需更改即可与启用 WebDAV 和 FrontPage 的服务器一起使用。该示例默认为协议自动协商。

要实际检索数据，您需要在非目录项上打开的 ADODB.Record 上打开 ADODB.Stream。

# linq - 如何阻止 linq 设计器覆盖我的手动更改？

> ID：800441
> 
> 赞同：0
> 
> 时间：2009-04-29T00:46:13.780
> 
> 标签：linq

我喜欢 Linq，但发现一旦设计师创建了我的类，我就必须修改它们。然后，当我更改我的数据库并在设计器中重新创建我的类时，我的更改会被清除。

例如，假设我有一个名为 Person 的类。我创建了这个类，向它添加了一些与数据库无关的方法（在 Linq 之外），然后创建一个具有相似名称的数据库表。当我将其拖入时，Linq 将在 Designer.cs 文件中复制该类。

因此，我将 partial 关键字添加到该文件中的类，甚至更改 Linq 创建的类名。随着开发的进行，毫无疑问数据库表会发生变化，我必须将我的表重新拖入设计器中。瞧，我的手动更改被擦除了。

这是最烦人的！事实上，继续修改我已经修改过的代码是行不通的。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T00:48:22.040

为您的上下文创建一个部分类并在那里进行更改，每次单击保存时都会重新创建设计器生成的 .cs 文件。

# cocoa - 摆脱 NSCell 上的焦点矩形。仅在右键单击时显示

> ID：800448
> 
> 赞同：0
> 
> 时间：2009-04-29T00:50:29.667
> 
> 标签：cocoa, macos

我有一个 NSCell 子类，我可以在其中进行各种自定义绘图。唯一似乎完全不受我控制的事情是右键单击单元格以显示关联的上下文菜单。在显示它的上下文菜单时，表格（或单元格 - 不确定究竟是哪个在执行此操作）绘制一个焦点矩形。我想摆脱这个，或者至少找到一种方法来绘制我自己的版本，以便更适合我的界面。

我已经尝试了大约 15 种不同的方法，它们似乎*可以*让我控制这个焦点矩形绘图本身（各种急救方法、各种绘图方法、各种突出显示颜色方法等），但我还没有找到可以改变任何东西的方法关于它。

问题截图： http: [//twitpic.com/3zx2t](http://twitpic.com/3zx2t)

我几乎厌倦了对 AppKit 进行类转储并尝试找到它用来绘制这个烦人的焦点矩形的任何私有方法。我做的任何其他事情都不会对它产生任何影响。这里的任何帮助都会真正拯救我的理智和许多未来的头发拉扯。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T14:06:51.893

在不完全覆盖您的表格视图的`-drawRect:`情况下，这是我知道摆脱上下文菜单突出显示矩形的唯一其他方法。

```
- (void)_drawContextMenuHighlightForIndexes:(NSIndexSet *)rowIndexes clipRect:(NSRect)rect {
    return;
} 
```

这是至少在 Leopard 中使用的方法，用于在将由上下文菜单激活的单元格周围绘制突出显示。不幸的是，它是由`NSTableView`'s`-drawRect:`方法直接调用的，据我所知，没有其他方法可以表明您对绘制这些高光不感兴趣。

当然这是私有 API，它可能在 Snow Leopard 或其他版本中停止工作。但在最坏的情况下，这意味着上下文菜单突出显示可能会在您的程序中的较新版本中再次启动，或者使用此方法的某些其他功能可能在以后无法工作。*你被警告了。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T13:28:57.307

在 10.5 及更高版本上，NSTableView 允许您在表格中的任何项目上调出上下文菜单（也就是说，不会产生更改选择的副作用。）

它绘制“焦点矩形”以指示上下文菜单正在对哪些项目进行操作。

# http - 准系统最小示例：使用 XUL 进行 http POST

> ID：800449
> 
> 赞同：2
> 
> 时间：2009-04-29T00:50:35.827
> 
> 标签：http, post, xul, intranet

我试图弄清楚 XUL 是否是 Intranet 应用程序中 GUI 表单的良好候选者。

但是很难找到真正*使用*它的人。因此，我想我会要求一个 hello world 风格的例子。

假设我有一个 php 页面，它只显示通过 HTTP POST 发送给它的任何内容。（例如， http: [//mysite.com/postdumper.php](http://mysite.com/postdumper.php)）

谁能告诉我创建一个收集名字、姓氏和年龄并允许我将其发布到上面的 URL 的 XUL 表单所需的最少代码？

任何提供此类示例的链接或精美手册或参考资料都非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T06:58:51.683

我将它用于 Intranet 应用程序，并且已经这样做了几年。开始可能很难，但是一旦你了解了一些事情，就很容易让它为你工作。

1.  几乎忘记了您对 HTML 的所有了解。它不是 HTML，有很多事情你不能用旧的方式做，但是你可以做很多其他事情。

2.  一切明智的通信都是用 javascript 完成的，而不是表单。

3.  覆盖与 div 无关。但它对于拆分大型项目的设计非常有用。

4.  如果 XUL 页面的所有标签格式不正确，则该页面甚至不会显示。

有一个谷歌群组，主要目的是讨论远程 XUL： [http ://groups.google.com/group/remotexul](http://groups.google.com/group/remotexul)

它还不是很活跃，但是欢迎更多的成员:)

这是一个最小的例子：

```
<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<window id="yourwindow" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
<script language="javascript">
    function send()
    {
        var firstName = document.getElementById('firstName').value;
        var lastName = document.getElementById('lastName').value;
        var age = document.getElementById('age').value;
        var postData = "firstName="+firstName;
        postData += "&amp;lastName="+lastName;
        postData += "&amp;age="+age;

        var req = new XMLHttpRequest();
        req.open("POST", "/test.php", false);
        req.setRequestHeader("Content-Type","application/x-www-form-urlencoded");

        req.send(postData);
        alert(req.responseText);

    }
</script>
<hbox>
    <vbox>
        <hbox>
            <label value="First Name" control="firstName"/>
            <textbox id="firstName"/>
        </hbox>
        <hbox>
            <label value="Last Name" control="lastName"/>
            <textbox id="lastName"/>
        </hbox>
        <hbox>
            <label value="Age" control="age"/>
            <textbox id="age" value="30" type="number"/>
        </hbox>
        <button onclick="send()" label="Send"/>
    </vbox>
</hbox>
</window> 
```

我还想强调，您应该考虑使用 XMLRPC 或 JSON 框架在 XUL 和 PHP 之间来回发送数据。JSON 支持将在 Firefox 3.5 中内置。

另一件事是，在 Firefox 3.5 到来之前，除非您在 about:config 中进行一些配置，否则您无法进行跨站点 XMLHttpRequest。这意味着只有 mysite.com 上的 xul 可以向 mysite.com/postdump.php 发送请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:23:03.393

创建一系列 <textbox>，添加一个提交 <button>，从文本框中读取数据后，使用[xmlhttprequest](https://developer.mozilla.org/En/Using_XMLHttpRequest#Receiving_binary_data)发送。您可以使用 GET 或 POST。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T01:31:50.597

您可以使用普通的旧 xhtml 表单，前提是您在 XUL 中使用它的命名空间，因为它是 XML。

# java - SQL2005的方言

> ID：800457
> 
> 赞同：1
> 
> 时间：2009-04-29T00:55:12.120
> 
> 标签：java, sql-server-2005, hibernate

我是休眠的新手。

我们正在将使用 Hibernate 3 和 SQL 2000 服务器的现有 Web 应用程序之一迁移到 SQL 2005 服务器。

由于在 Hibernate 3.0.5 中找不到 SQL 2005 的任何方言，我能否获得有关与 SQL 2005 一起使用哪个版本的 Hibernate 的帮助？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T01:03:25.233

我不相信方言能识别 SQL Server 年份之间的差异；这一切都只是 Microsoft SQL Server。

您使用的是哪个 JDBC 驱动程序？微软的还是 jTDS？您只能获得驱动程序支持的功能。

而且您不应该使用数据库特定的功能。您的代码不能以这种方式移植。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:03:48.290

我正在为 SQLServer 2005 使用标准 SQLServer 方言 (org.hibernate.dialect.SQLServerDialect)，到目前为止我没有遇到任何问题。我正在使用 JTDS JDBC 驱动程序。

我也在使用模式生成器，到目前为止没有问题。

# apache-flex - 为什么这个 Flex “Hello World” 应用程序没有接收到我的远程 HTTPService 调用的结果？

> ID：800459
> 
> 赞同：0
> 
> 时间：2009-04-29T00:56:28.917
> 
> 标签：apache-flex, web-services, httpservice

当我访问[http://localhost:3000/hello/sayhello](http://localhost:3000/hello/sayhello)时，Rails 输出：

```
hello world! 
```

作为 HTML。

但是，当我运行这个 Flex 远程“Hello World”应用程序时，我看到了一个按钮和一个文本框，但它没有接收到我的 Rails url 的 HTTPService 调用的输出。任何想法为什么？

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application
    xmlns:mx="http://www.adobe.com/2006/mxml"
    layout="vertical"
    backgroundGradientColors="[#ffffff, #c0c0c0]"
    width="100%"
    height="100%">
    <mx:HTTPService
        id="helloSvc"
        url="http://localhost:3000/hello/sayhello"
        method="POST" resultFormat="text"/>
    <mx:Button label="call hello service"
        click="helloSvc.send()"/>
    <mx:TextInput text="{helloSvc.lastResult}"/>
</mx:Application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T01:15:47.640

我不肯定，因为我看不到您的服务会回复的 XML，但我认为这可能是两件事之一：

1）您没有元素来格式化对您的服务的请求。查看此模板以获取模板... [Flex 3 帮助](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_2.html)

这可能会导致请求永远无法正确发出，或者您的服务会阻塞请求并且永远不会返回结果。您必须调试服务以查看它如何处理请求。

2) 您的服务正在返回带有命名空间的 XML 结果。在这种情况下，您将需要查看有关如何处理 e4x 格式的 XML 结果的[另一个 Flex 3 帮助。](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_6.html#194236)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:29:23.427

我将您的代码复制并粘贴到了一个新的 Flex 应用程序中，修改了 URL 以指向一个我*知道*适用于 Flex 应用程序的脚本，它工作得很好。

我还更改了我的服务器端脚本以使用换行符打印“hello world”，并且效果也很好。

您的 Flex 代码似乎可以正常使用纯文本，但数据显示和数据本身之间显然没有连接。我没有使用 Rails 的经验，但我想知道您的服务器是否正在输出无法解析的数据，并且任何异常都被吞没了。

这是我的建议：更改您的“sayhello”脚本，使其简单地打印内容标题和“hello world”——所有内容均为纯文本。确保它在浏览器中输出，然后查看它是否也适用于 Flex 应用程序。如果是这样，您的 Rails 应用程序可能正在输出需要解析的内容，而不是简单地设置为文本输入。如果没有，您将需要进行更多调试。

顺便说一句，我尝试了纯文本输出和 XML 输出。在这两次尝试中，我都能够查看文本输入字段中的内容。

# c# - C# 为字节数组或图像创建哈希

> ID：800463
> 
> 赞同：40
> 
> 时间：2009-04-29T00:59:07.150
> 
> 标签：c#, .net, image, hash

> **可能重复：**
> [如何从 C# 中的字节数组生成哈希码](https://stackoverflow.com/questions/16340/how-do-i-generate-a-hashcode-from-a-byte-array-in-c-sharp)

在 C# 中，我需要创建图像的 Hash 以确保它在存储中是唯一的。

我可以轻松地将其转换为字节数组，但不确定如何从那里开始。

.NET 框架中是否有任何类可以帮助我，或者是否有人知道一些*有效*的算法来创建这样一个独特的哈希？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-04-29T01:01:15.193

.NET 中有很多哈希和提供程序可以创建加密哈希 - 这满足您的条件，即它们是唯一的（对于大多数目的来说是防冲突的）。它们都*非常*快，除非你做一万亿次，否则散列绝对不会成为你应用程序的瓶颈。

我个人喜欢SHA1：

```
public static string GetHashSHA1(this byte[] data)
{
    using (var sha1 = new System.Security.Cryptography.SHA1CryptoServiceProvider())
    {
        return string.Concat(sha1.ComputeHash(data).Select(x => x.ToString("X2")));
    }
} 
```

即使人们说一种方法可能比另一种慢，这都是相对而言的。处理图像的程序绝对不会注意到生成哈希和的微秒过程。

关于碰撞，对于大多数目的来说，这也是无关紧要的。即使是像 MD5 这样的“过时”方法在大多数情况下仍然非常有用。*仅当系统的安全性依赖*于防止冲突时，才建议不要使用它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-29T02:44:18.410

[Rex M](https://stackoverflow.com/a/800469/50776)关于使用 SHA1 生成哈希的部分答案是一个很好的答案（MD5 也是一个流行的选项）。zvolkov 关于不要不断创建新的加密提供商的建议也是一个很好的建议（如果速度比虚拟保证的唯一性更重要，那么使用 CRC 的建议也是如此。

但是，不要*使用*Encoding.UTF8.GetString [()](http://msdn.microsoft.com/en-us/library/744y86tc.aspx)将 byte[] 转换为字符串（当然，除非您从上下文中知道它是有效的 UTF8）。一方面，它将[拒绝无效的代理](http://blogs.msdn.com/oldnewthing/archive/2004/09/07/226306.aspx)。[Convert.ToBase64String()](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx)是一种保证始终为您提供来自 byte[] 的有效字符串的方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-29T01:27:21.933

每次需要计算哈希时创建 SHA1CryptoServiceProvider 的新实例一点也不快。使用相同的实例非常快。

仍然我宁愿做许多 CRC 算法中的一种而不是加密哈希，因为为加密设计的哈希函数对于非常小的哈希大小（32 位）不能很好地工作，而这正是您想要的 GetHash() 覆盖（假设这就是你想要的）。

查看此链接以获取在 C# 中计算 CRC 的一个示例：http: [//sanity-free.org/134/standard_crc_16_in_csharp.html](http://sanity-free.org/134/standard_crc_16_in_csharp.html)

PS 你希望你的散列很小（16 位或 32 位）的原因是你可以快速比较它们（这就是散列的全部意义，记得吗？）。将哈希值表示为编码为字符串的 256 位长值在性能方面非常疯狂。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T01:03:14.393

您可以使用任何标准散列算法，但散列在技术上不能保证唯一性。散列被设计为一种相对快速和/或较小的令牌，以便能够查看一个数据是否可能与另一个相同。完全不同的数据集完全有可能产生相同的散列，尽管能够通过算法产生这些是非常困难的。

除此之外，为了检查可能的身份，MD5 相当快。SHA 更可靠（MD5 已被黑客入侵，因此不应用于安全性），但速度也较慢。

# mysql - MySQL - 优化查询并根据列 Sum 查找排名

> ID：800467
> 
> 赞同：1
> 
> 时间：2009-04-29T01:00:21.950
> 
> 标签：mysql, optimization, group-by

我有一个游戏的高分数据库，可以跟踪不同世界的每场比赛。我想做的是找出一些关于戏剧的统计数据，然后找到每个世界根据彼此的世界“排名”的位置（按播放次数排序）。

到目前为止，我的所有统计数据都运行良好，但是在查找每个世界的排名时遇到了问题。

我也很确定在三个单独的查询中执行此操作可能是一种非常缓慢的方法，并且可能会得到改进。

我有一个时间戳列（此处未使用）和数据库模式中索引的“世界”列。这是我的来源的选择：

```
function getStast($worldName) {
  // ## First find the number of wins and some other data:
  $query = "SELECT COUNT(*) AS total, 
            AVG(score) AS avgScore, 
            SUM(score) AS totalScore
            FROM highscores 
            WHERE world = '$worldName'
            AND victory = 1";
  $win = $row['total'];

  // ## Then find the number of losses:
  $query = "SELECT COUNT(*) AS total 
            FROM highscores 
            WHERE world = '$worldName'
            AND victory = 0";
  $loss = $row['total'];

  $total = $win + $loss;

  // ## Then find the rank (this is the broken bit):
  $query="SELECT world, count(*) AS total 
          FROM highscores 
          WHERE total > $total
          GROUP BY world
          ORDER BY total DESC";

  $rank = $row['total']+1;
  // ## ... Then output things.
} 
```

我相信让我失败的特定代码行在 RANK 查询中，

```
 WHERE total > $total 
```

它是否不起作用，因为它不能接受计算的总数作为 WHERE 子句中的参数？

最后，有没有更有效的方法在单个 SQL 查询中计算所有这些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T01:17:19.507

我想您可能想使用“总金额 > $ 总金额”？

```
SELECT world, count(*) AS total 
FROM highscores 
GROUP BY world
having total > $total
ORDER BY total DESC 
```

# c# - 用于计算代码块的代码复杂度的现有库

> ID：800473
> 
> 赞同：1
> 
> 时间：2009-04-29T01:02:59.167
> 
> 标签：c#, asp.net, static-analysis, cyclomatic-complexity

我得到一个包含任意数量代码的字符串。我想计算一个代表该字符串的代码复杂度的数字。就像是：

```
int complexity = Lib.FindComplexity(someString); 
```

我意识到有很多工具可以为你做到这一点。 **这些工具对我不起作用，因为我想以编程方式进行。** 我希望该库位于 C# 中，但此时可以使用任何东西。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T03:34:51.907

您还可以使用反射器和可用的代码指标插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:33:18.110

您是否考虑过使用其中一种现有工具并将其包装在库中？例如，您可以使用 NDepend.Console.exe，方法是使用所需参数从代码中调用它，然后解析结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T02:08:09.557

NDepend 是一个很棒的工具，虽然在我看到它的时候并不便宜。如果钱不是一种选择，我会考虑使用反射和[http://en.wikipedia.org/wiki/Cyclomatic_complexity](http://en.wikipedia.org/wiki/Cyclomatic_complexity)。它不满足您对任何字符串的要求，但您绝对可以测试您创建的程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-10T09:35:03.773

像这样的库必须能够*解析任意语言片段*，然后计算解析片段的复杂度度量。大多数度量工具充其量只有一个针对整个语言的解析器，而不仅仅是一个片段，因此您可能很难找到许多解决方案。

有一个系统可以满足您的需求：我们的 DMS 软件再造工具包。它为许多语言（例如 Java 和 C#；不清楚您要分析的语言）提供解析器。DMS 已被用于为多种语言（Java、C#、JavaScript、COBOL）实现这些类型的指标，并且执行此操作的过程非常简单。而且*DMS 确实解析了语言片段*，令人惊讶的是，指标实现实际上是在这些片段上运行的。您可以自定义 DMS 以实现您想要的。请参阅[http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html) 和衍生度量工具， [http://www.semdesigns.com/Products/Metrics/index.html](http://www.semdesigns.com/Products/Metrics/index.html)

# log4net - 在 Log4net 发布期间关闭调试日志记录

> ID：800483
> 
> 赞同：4
> 
> 时间：2009-04-29T01:06:15.587
> 
> 标签：log4net

当我在发布模式下编译我的应用程序时，我发现 Log4Net 仍然记录调试信息；知道如何解决这个问题吗？

这是我的 App.Config 文件：

```
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,Log4net"/>
  </configSections>

  <log4net>
    <root>
      <level value="DEBUG" />
      <appender-ref ref="LogFileAppender" />
    </root>
    <appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender" >
      <param name="File" value="C:\Documents and Settings\test\Application Data\Log.txt" />
      <param name="AppendToFile" value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="10" />
      <maximumFileSize value="10MB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%-5p%d{yyyy-MM-dd hh:mm:ss} - %m%n" />
      </layout>
    </appender>
  </log4net> 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T01:14:07.220

您的 App.Config 文件中没有任何内容可以告诉 log4net 在发布或调试模式下做不同的事情。如果您希望两个构建之间的日志记录不同，则必须在两个构建之间更改配置文件。

您最好的选择可能是为发布创建一个 App.Config，为调试创建一个，然后按照 StackOverflow 问题中的建议进行操作：

*   [根据构建配置部署 app.config](https://stackoverflow.com/questions/350377/)

注意：您的发布和调试 App.Config 之间的区别将是调试版本中的以下行

```
<level value="DEBUG" /> 
```

与发布版本中的以下行相比（当然，如果需要，您可以选择 ERROR 或 FATAL）：

```
<level value="INFO" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T01:21:38.263

也许尝试这样的事情？设置为您想要接收的任何最低级别。

```
<level value="WARN" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-25T02:56:38.433

如果您的 App.Config 如下所示：

```
 <root>
      <level value="Info" />
      <appender-ref ref="ConsoleAppender" />
      <appender-ref ref="RollingFileAppender" />
    </root> 
```

您可以通过代码修改日志级别（将代码放在Program.cs中）：

```
 #if DEBUG
            log4net.Repository.ILoggerRepository RootRep;
            RootRep = LogManager.GetRepository(Assembly.GetCallingAssembly());

            XmlElement section = ConfigurationManager.GetSection("log4net") as XmlElement;

            XPathNavigator navigator = section.CreateNavigator();

            XPathNodeIterator nodes = navigator.Select("root/level");
            foreach (XPathNavigator appender in nodes)
            {
                appender.MoveToAttribute("value", string.Empty);
                appender.SetValue("Debug");
            }

            IXmlRepositoryConfigurator xmlCon = RootRep as IXmlRepositoryConfigurator;
            xmlCon.Configure(section);
#endif 
```

# zsh - 无法撤消 Zsh 中的删除

> ID：800487
> 
> 赞同：0
> 
> 时间：2009-04-29T01:11:33.890
> 
> 标签：zsh, undo, rm

我在路径/测试处运行

```
rm -r * 
```

该[教程](http://www.ee.ryerson.ca/guides/zsh-intro.pdf)说我可以撤消更改

> 如果其中一个花哨的编辑器命令以您不希望的方式更改了您的命令行，您可以使用 ^_ 撤消更改，如果您可以将其从键盘中取出，或者 ^X^U，否则。

但是，我没有按 Ctrl-x Ctrl-u 或 Ctrl-xu 取回文件。我还按 Shift-6 Shift-- 或 Shift-6-- 尝试了 ^_，但未成功。

**如何撤消 Zsh 中的删除？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T01:19:22.653

*撤消*功能是 Z 行编辑器的一项功能，该编辑器是您在命令行键入时使用的编辑器。它可以让您撤消在命令行上键入的内容，就像任何好的文本编辑器一样。但它不会让您撤消您执行的命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T01:16:26.763

你误会了。他们谈论的是在您按下回车之前撤消对命令行的更改，而不是撤消命令的结果。

# asp.net - Asp.Net 2.0 文件上传

> ID：800493
> 
> 赞同：1
> 
> 时间：2009-04-29T01:14:43.757
> 
> 标签：asp.net, file-upload

我知道我使用 asp FileUpload 控件来上传文件，但我需要将控件的设计更改为图像按钮。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T01:35:04.800

我认为您指的是“浏览...”按钮的样式。它的样式不能很容易地修改，因为它的外观是由浏览器设置的。这是涉及 HTML、CSS 和 JavaScript 的解决方法：

文章：[样式化输入 type="file"](http://www.quirksmode.org/dom/inputfile.html)

# asp.net - 具有管道模式的 IIS 7.0 = 集成不会在 ASP .NET 中加载任何图像/css

> ID：800500
> 
> 赞同：7
> 
> 时间：2009-04-29T01:19:04.153
> 
> 标签：asp.net, iis-7

我有一个在 IIS 5.1 中工作的完整系统......我迁移到 IIS 7.0，管道模式经典一切正常，但管道集成我的图像/css 没有加载......

我正在将 ASP.NET 3.5 与 Web 应用程序一起使用...

有什么帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T20:15:34.483

在 IIS 7 中安装 ASP.NET 模块时，默认情况下不安装静态内容。您将需要进入程序和功能，然后“打开或关闭 Windows 功能”。

在 IIS 部分下，深入了解 WWW 服务、通用 Http 功能，并选中“静态内容”。

没有那个 css，图像、html 和其他非动态内容将不会显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-03T17:39:09.533

我遇到了同样的问题，我的静态内容没有安装。要更改服务器 2008 下的设置，请进入服务器管理器，打开角色并单击 Web 服务器 (IIS)。一旦填充找到角色服务部分，然后添加角色服务以安装静态内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T19:41:10.993

您可以使用一些 HTTP 嗅探工具（Firebug 或 Fiddler）并检查失败的请求。如果您发现此类请求，您可以检查服务器返回的错误消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-13T21:58:52.367

我还发现这是默认文档继承损坏的副作用。我们通常将“login.aspx”添加到父（默认网站）配置中的默认文档列表的顶部。当这以某种方式损坏时，显示出同样的症状。解决方法是删除继承的值并重新添加它。然后，我可以使用 .NET 4.0 集成应用程序池再次查看静态内容。

# vb.net - 在 VS 中更改 VB.net 的类型颜色

> ID：800502
> 
> 赞同：0
> 
> 时间：2009-04-29T01:19:26.727
> 
> 标签：vb.net, visual-studio-2008

我目前正在做一个 VB.NET 项目，我遇到的最困难的事情是一切都是黑色和蓝色的。

在使用 C# 进行了大量工作后，我真的很喜欢不同颜色的类型。

我试过进去看看“ ”，“ ”下`Tools > Options > Fonts and Colors`的各种“ ”被设置为不同的颜色，但它没有在文本编辑器中反映该颜色。`User Types``Display Items`

任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T01:49:56.980

您可以更改“关键字”颜色，但这也会更改，所有关键字（例如`Class`和`Function`），而不仅仅是类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T10:38:43.030

我想知道VS2010如何处理它？随着 VB 和 C# 团队现在更紧密地合作，这个问题可能已经得到解决。

[http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en)

——祝你好运——编辑怪癖可能是最糟糕的！（当然，当你的绿屏死机时......）:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T01:54:36.920

列表下方是用户类型以及委托、枚举、接口和值类型的用户类型。

# sql - SQL - 将数据转换为日期/源/值“网格”

> ID：800503
> 
> 赞同：0
> 
> 时间：2009-04-29T01:20:07.877
> 
> 标签：sql, mysql

我在 MYSQL 数据库中有如下所示的数据：

```
Project    Date         Time
A          2009-01-01   15
A          2009-01-02   10
B          2009-01-02   30
A          2009-01-09   15
C          2009-01-07   5 
```

我想从这些数据中生成输出，如下所示：

```
Date         Project A Time     Project B Time    Project C Time
2009-01-01   15                 0                 0
2009-01-02   10                 30                0
2009-01-07   15                 0                 5 
```

这可以通过 SQL 查询来完成，还是我需要编写一个外部脚本来遍历数据库并组织输出？

（另外，如果有人对主题行有更好的建议，请告诉我，我会编辑问题；我不确定描述当前和所需格式的正确术语，这使得搜索此信息变得困难）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T04:12:20.363

我一直在寻找这样的东西，并找到了一个完美运行的 MySQL 存储过程：

[http://forums.mysql.com/read.php?98,7000,250306#msg-250306](http://forums.mysql.com/read.php?98,7000,250306#msg-250306)

您正在寻找的结果可以从以下简单的调用中获得：

调用 pivotwizard('date','project','time','from_table','where_clause')

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T01:22:08.920

您正在寻找枢轴/交叉表支持。这是一个很好的链接。

[http://en.wikibooks.org/wiki/MySQL/Pivot_table](http://en.wikibooks.org/wiki/MySQL/Pivot_table)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T01:22:44.033

我相信这被称为数据透视表。只是谷歌它。

# delphi - 德尔福EXE压缩器？

> ID：800505
> 
> 赞同：5
> 
> 时间：2009-04-29T01:21:51.807
> 
> 标签：delphi, compression, exe

有一次，我有一个不错的小压缩实用程序，它可以将我的 Delphi 编译的 EXE 压缩到更小的下载大小，但现在我找不到它。有什么建议吗？

此外，使用这些实用程序有什么缺点吗？（我主要用它们来缩短农村/拨号用户的下载时间）。

* * *

相关问题：[使用 UPX 压缩 Windows 可执行文件有什么缺点吗？](https://stackoverflow.com/questions/353634)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-29T01:48:26.267

几年前，我研究了压缩我的可执行文件以使下载更小。

我最终做的，以及我向你推荐的，是改用像[Inno Setup](http://www.jrsoftware.org/isinfo.php)这样的安装程序。它不仅会创建一个单独的 EXE 来安装/卸载您的程序，而且它还可以压缩该 EXE，就像单独的压缩器对您的可执行文件所做的一样。

安装程序后，它会被解压缩，因此它永远不会是病毒，也不会增加加载时间。

因此，我获得了较小的下载大小以及同时具有专业外观的安装脚本的好处。

ps Inno Setup 是免费的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-29T01:25:51.513

建议您不要：

*   EXE 压缩器可以使您的应用程序看起来像病毒（自我修改）
*   gzip/zip 在压缩方面同样有效，并且不会修改您的应用程序
*   EXE 压缩器使您的应用程序的加载时间增加（除非您只是在谈论安装程序，这是另一回事

这个看起来很疯狂的网站提出了我在遥远的过去听到的一个论点（今天是否正确，我不确定，现代包装器今天可能有不同的策略）*这篇文章引用了 Win32！*:)

[http://topic.csdn.net/t/20000408/08/6785.html](http://topic.csdn.net/t/20000408/08/6785.html)

> 现代多任务操作系统，如 Windows 95/98 和 NT，使用所谓的“虚拟内存”系统。当程序启动时，它们的所有代码不会在启动时立即加载到内存中，就像 DOS 程序一样。相反，只有部分正在执行的代码被存储到内存中。例如，假设您的程序在其菜单上有一个打印选项，并在其后面处理打印的代码。只有在用户首次选择打印功能后，此代码才会加载到内存中。如果代码加载到内存后，打印功能有一段时间没有使用，系统将“丢弃”代码，释放它占用的内存，如果另一个应用程序迫切需要内存。这是称为“分页”的过程的一部分
> 
> 在 Win32 下分页节省内存的另一种方法是它导致程序（或 DLL）的多个实例共享相同的内存用于代码。换句话说，在正常情况下，启动 100 个程序实例和启动一个实例之间为代码分配的物理内存量没有真正的差异。
> 
> 如果所有 Win32 程序的行为都像 DOS 程序一样，将所有内容加载到内存中并一直保存到程序终止，并且在多个实例之间也不共享任何内存，那么您可能可以想象在数量有限的系统上物理内存会以多快的速度耗尽，导致磁盘交换开始。
> 
> 然而，这正是当前 Win32 EXE 压缩器对您的 EXE/DLL 所做的！它们通过将所有代码解压缩到内存中并将其保留在那里直到终止，从而完全违背了操作系统的分页系统。而且由于代码不是以“原始”格式存储在 EXE 文件中（即与存储在内存中的方式相同），因此操作系统无法在多个实例之间共享代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T01:24:58.473

我不知道有什么专门针对 Delphi 的，但[UPX](http://upx.sourceforge.net/)在这类事情上非常受欢迎。唯一的缺点是可执行文件在启动时必须解压缩，这可能会耗费一些时间。不过，对于大小合理的可执行文件来说，它似乎非常快。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T04:00:46.870

您可能想到的是[ASPack——](http://www.aspack.com/)它是一个用 Delphi 编写的 EXE 压缩器，但可以压缩任何 EXE。不过，它可能在 Delphi EXE 上做得更好。我同意其他答案，即您不应该仅仅为了节省下载时间而使用 EXE 压缩器。在某些特定情况下，EXE 压缩是个好主意，但通常不是。

而是使用一个好的安装构建器，特别是如果您能找到使用 7zip 压缩的安装构建器。我知道[InstallAware](http://www.installaware.com/)在内部使用 7zip 来实现最大压缩。根据您拥有的 Delphi 版本，您也可能拥有 InstallAware 许可证。

[如果不出意外，您可以免费使用7zip](http://www.7-zip.org/download.html)构建具有基本安装行为的自解压存档。它是用于安装程序的 SFX 的单独下载。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T05:32:29.200

使用带有 lzma 选项的[UPX](http://upx.sourceforge.net/)进行最大压缩。

```
upx --lzma yourfile.exe 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T09:25:36.423

压缩 EXE 或 DLL 的主要不便之处在于操作系统无法在多个实例之间共享代码。
所以你在浪费内存，每次启动实例时都必须解压缩，表现出类似病毒的行为，甚至没有压缩安装的下载优势。
唯一正面的情况是直接从网络驱动器启动时。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T06:51:52.870

我相信终端服务器（如 Citrix）如果未压缩，将为您的应用程序二进制文件使用相同的内存。这意味着压缩的 exe 文件在 Citrix 环境中可能会产生小灾难。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T14:19:20.563

不久前，我在 SO 上问了一个关于在 Delphi 可执行文件上使用 UPX 的弊端的问题，我得到了一些很好的回应。

[使用 UPX 压缩 Windows 可执行文件有什么缺点吗？](https://stackoverflow.com/questions/353634/are-there-any-downsides-to-using-upx-to-compress-a-windows-executable)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T01:25:11.313

[UPX](http://upx.sourceforge.net/)应该可以工作，尽管它不是 Delphi 特有的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T10:16:32.050

我使用 PEtite：[http ://un4seen.com/petite/](http://un4seen.com/petite/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-29T13:53:57.240

我也会投票给upx。除了提到的缺点之外，它还可以防止基本的逆向工程和那些蹩脚的“资源黑客”工具。顺便说一句，它们中的大多数都无法打开压缩的可执行文件。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-04-29T09:01:25.477

您可以使用[PECompact](http://www.bitsum.com/pecompact.shtml)，因为人们无法轻松解密它，并且正如测试所示（显示在主页上，只需向下滚动一点）它比 ASPack 或 UPX 更好，我在以前的 Delphi 项目中使用过它

# php - 如何在 PHP 中更轻松地将整数值映射到字符串？

> ID：800518
> 
> 赞同：3
> 
> 时间：2009-04-29T01:29:50.943
> 
> 标签：php

如何重构以下代码以使其更简洁、更易于维护？

```
if ($row['vocation'] == 1) $vocation = "sorcerer";
if ($row['vocation'] == 2) $vocation = "druid";
if ($row['vocation'] == 3) $vocation = "paladin";
if ($row['vocation'] == 4) $vocation = "knight";

if ($row['vocation'] == 5) $vocation = "master sorcerer";
if ($row['vocation'] == 6) $vocation = "elder druid";
if ($row['vocation'] == 7) $vocation = "royal paladin";
if ($row['vocation'] == 8) $vocation = "elite knight";
else $vocation = "none"; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-29T01:33:21.917

我建议使用数组，如下所示：

```
static $vocations = array(
  1 => 'sorceror',
  2 => 'druid',
  3 => 'paladin',
  4 => 'knight',
  5 => 'master sorceror',
  6 => 'elder druid',
  7 => 'royal paladin',
  8 => 'elite knight',
  );

$vocation = 
  isset($vocations[$row['vocation']]) ? $vocations[$row['vocation']] : 'none'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T01:33:35.413

这是使用开关执行此操作的示例：

```
switch ($row['vocation']) {
    case 1:
        $vocation = "sorcerer";
        break;
    case 2: 
        $vocation = etc..
    default:
        $vocation = "none";
} 
```

这对于许多语言（如 C、Java 和 C# 以及许多其他语言）来说都是常见的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T02:28:10.430

我将建议与数组一起使用，并使用常量来表示整数值，如下所示：

```
define('VOCATION_SORCEROR', 1);
define('VOCATION_DRUID',    2);
define('VOCATION_PALADIN',  3);

$vocations = array(
  VOCATION_SORCEROR => 'sorceror',
  VOCATION_DRUID =>    'druid',
  VOCATION_PALADIN =>  'paladin'
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T01:36:31.740

下面的部分可能会好一些。8 个元素都可以，但是如果列表包含 1000 个呢？

```
$list = array("sorcerer", "druid", ...);

$vocation = "none";

if($row['vocation'] <= count($list)){
    $vocation = $list[$row['vocation'] - 1];
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-27T22:28:37.540

这是另一个建议：

```
<?php

class Action
{
    const TYPE__ADD = 0;
    const TYPE__VIEW = 1;
    const TYPE__EDIT = 2;
    const TYPE__PATCH = 3;
    const TYPE__DELETE = 4;
    const TYPE__MAP = [
        self::TYPE__ADD => 'add',
        self::TYPE__VIEW => 'access',
        self::TYPE__EDIT => 'edit',
        self::TYPE__PATCH => 'patch',
        self::TYPE__DELETE => 'delete'
    ];

    protected $type;

    public function setType(int $type)
    {
        if (!isset(self::TYPE__MAP[$this->type])) throw new \Exception(sprintf('Invalid type. Possible options are: %s.', implode(',', self::TYPE__MAP)));

        $this->type = $type;
    }

    public function getType(): int
    {
        return $this->type;
    }

    public function getTypeStr(): string
    {
        return self::TYPE__MAP[$this->type];
    }
}

// Test
$action = new Action();
$action->setType(Action::TYPE__PATCH);
echo 'Action type is: '.$action->getTypeStr().', and its representative int value is: '.$action->getType(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T01:33:22.027

正确开始您的项目，现在使用 const 来表示这些数字常量，并为自己省去一些麻烦。（除了像其他人建议的那样使用开关/案例）

# windows - Windows cmd 行的 Linuxlike Ctrl-C (KeyboardInterrupt)？

> ID：800521
> 
> 赞同：25
> 
> 时间：2009-04-29T01:31:28.257
> 
> 标签：windows, terminal

我被迫在 Windows 中使用命令行，想知道是否有类似 Linux 的键盘快捷键？我用谷歌搜索并没有找到我要找的东西。

像^C，^Z之类的东西？谢谢大家！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-29T01:51:37.960

尝试`Ctrl`+ `Break`：某些程序会响应它而不是`Ctrl`+ `C`。在某些键盘上`Ctrl`+`Break`转换为`Ctrl`+ `Fn`+ `Pause`。

另请注意，在 Vista 之前的 Windows 上，没有任何东西可以取消同步网络 I/O（例如`net view \\invalid`）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-29T01:36:01.413

您可以使用 SIGINT 在 Windows 上捕获 ^C，就像 Linux 一样。Windows shell 不支持 Unix 风格的作业控制（至少不类似于 Unix shell），而 ^Z 实际上是 Windows 的 ^D 模拟。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-11T11:26:11.667

有两种键盘组合可用于在 Windows 命令行中停止进程。

*   `Ctrl`+`C`是“更好”的方法。程序员可以在软件中处理这个问题。可以编写完全忽略`Ctrl`+`C`作为`SIGINT`信号的程序，或者像常规键盘组合一样处理`Ctrl`+ 。`C`

*   `Ctrl`+`break`是“更难”的方法，总是发送`SIGBREAK`信号并且不能在软件中被覆盖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T01:33:12.247

Ctrl-C 在 Windows 中的作用与在 linux 中的作用相似。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-01T20:15:12.927

你可以使用这个命令吗？`Ctrl`+ `Fn`+`S`

# authentication - 迁移密码加密架构

> ID：800543
> 
> 赞同：1
> 
> 时间：2009-04-29T01:40:43.257
> 
> 标签：authentication, encryption, passwords, migration

我可能正在接管一个应用程序，该应用程序实际上只是通过执行 md5(password) 来加密用户密码

迄今为止，他们拥有约 2000 名用户。如何将这些密码迁移到更强的加密模式（例如，涉及盐、用户特定哈希和他们的密码，所有这些都使用 sha1、bcrypt 等加密）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T01:47:37.453

MD5 是一种[加密散列函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)，不一定是加密方法。哈希被设计为仅在一个方向上执行，并且除了通过字典攻击之外无法反转。举个例子，如果你感觉很活泼，你可以试试这个[哈希数据库查找。](http://gdataonline.com/seekhash.php)

您可能希望将这些旧密码保存在单独的列中，然后当用户登录“新”系统时，将该密码的 MD5 版本与旧密码进行比较，如果摘要匹配，则执行 SHA1对该密码加盐并将其存储在单独的列中。

或者，可能是更好的方法，是强制用户更改密码......当他们输入新密码时，使用新的哈希算法代替。

# mysql - SQL Server 2005 到 MySQL 的连接

> ID：800544
> 
> 赞同：1
> 
> 时间：2009-04-29T01:41:03.180
> 
> 标签：mysql, sql-server, sql-server-2005

我希望能够每天从 MySQL 中的 glpi 数据库通过电子邮件发送报告。我想创建一个 SSIS 作业来从 MySQL 中提取数据。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T04:27:22.653

从 SQL Server 2005 创建到 mySQL 的链接服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T02:49:34.310

我建议使用[ODBC](http://dev.mysql.com/doc/refman/5.1/en/connector-odbc.html)或 MySQL [.NET 适配器](http://dev.mysql.com/downloads/connector/net/5.2.html)。SSIS 可以轻松使用这些连接

# css - CSS 背景图像加载行为

> ID：800546
> 
> 赞同：2
> 
> 时间：2009-04-29T01:43:01.020
> 
> 标签：css

假设有一个已设置的元素`display:none`（未显示在屏幕上）的 css 样式声明，并且它还设置了背景图像。

假设此元素显示在诸如鼠标单击之类的事件上。浏览器会在元素显示之前加载这些图像吗？这种加载行为在浏览器之间是否一致？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T10:03:44.650

关于这个主题没有很多好的信息，所以我使用[Steve Souders 的 testpage](http://stevesouders.com/tests/hidden-bgimages.php)在webpagetest.org 上做了一些测试。

事实证明，在所有测试的浏览器中，**只有 Firefox 不加载带有 display:none 的背景图像**。你可以[在我的博客上看到测试结果](http://blog.futtta.be/2012/12/10/do-background-images-lazy-load-with-displaynone/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T01:54:51.837

不，我之前测试过的浏览器没有。

如果您确实想加载图像，请尝试使用`background-position: -1000px -1000px`which 确实有效。它不会显示图像，但会预加载。但是，该元素将处于正常流程中，即不隐藏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T01:53:54.723

它不会自动加载，但您可以使用 Javascript 技巧来预加载图像。

```
pic = new Image(); 
pic.src="http://url/imagetoload.png"; 
```

作为更好的解决方案，您可以创建一个具有负定位值的 div（例如 left: -1000px）并将 imagetoload.png 分配给其背景以加载图像。

# silverlight - 在 Silverlight 中反向播放 mp3

> ID：800547
> 
> 赞同：0
> 
> 时间：2009-04-29T01:43:14.763
> 
> 标签：silverlight, audio, reverse

所以考虑到 Silverlight 有一个很好的 .net 框架子集，你会认为反向播放音频不会很困难，对吧？好吧，没有。我什至找不到一个好的开始。MediaElement 似乎没有反向播放音频的能力。

有没有人知道如何做到这一点？这在 .net winforms 应用程序中会更容易吗？

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T03:06:49.027

mp3 格式不可逆

将mp3解码为wav，颠倒样本顺序，重新编码为mp3，然后播放

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-03T16:52:13.923

应该可以反向播放 MP3。音频数据存储在块中。这些块需要以相反的顺序读取、解码并以相反的 PCM 采样顺序传递给 MediaStreamSource。

唯一的问题是必须先完全读入流，然后才能向后读取它。

我在[这里](http://prefix.teddywino.com/post/SilverlightMediaKitLiveDemo.aspx)为 Silverlight 编写了一个 MP3 解码器（源代码将很快上传）。我认为你应该很容易重写它以反向播放 MP3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T03:26:50.443

MP3 格式未编码为反向播放。它需要您解码、反转，然后重新编码，这将花费一些时间和 CPU。

如果我是你，我会在音频编辑器程序中反转 MP3，保存它，然后在你的应用程序中播放它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T01:45:09.613

DirectX 具有相当多的音频功能。我会检查那个或新的 XNA 框架。

# svn - Ankhsvn 错误：客户端太旧，无法使用工作副本

> ID：800548
> 
> 赞同：5
> 
> 时间：2009-04-29T01:44:28.817
> 
> 标签：svn, visual-studio-2005, ankhsvn

我在 Visual Studio 2005 中使用 Ankhsvn 2.0.6347.433，它报告说 Ankhsvn 的颠覆客户端对于工作副本来说太旧了。给定的错误链接到[http://subversion.tigris.org/faq.html#working-copy-format-change](http://subversion.tigris.org/faq.html#working-copy-format-change)，它讨论了在 subversion 1.5 格式的结帐上使用 1.4.4 subversion 客户端。

Ankhsvn 的[主页](http://ankhsvn.open.collab.net/servlets/ProjectProcess?pageID=3794)说 Ankhsvn 2.0 及更高版本在内部使用 subversion 1.5。该链接没有提到任何关于 1.5 客户有问题的信息。

我自己有限的故障排除没有发现任何我可以直接指出的东西，但我确实安装了 TortoiseSVN 1.6.1，它在内部使用了 Subversion 1.6.1。我有使用 TortoiseSVN 在我的项目文件夹中提交内容的习惯，这会绕过 Ankhsvn 所做的任何事情。这会导致尝试使用 1.4.4 和 1.5 客户端会导致的类似问题，还是发生其他事情？

**编辑：好的，我不应该混合 1.6 和 1.5 客户端。**

我该如何解决？如果可能的话，我想使用 AnkhSVN。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T01:57:01.253

如果您查看 subversion 1.6 的[发行说明](http://subversion.tigris.org/svn_1.6_releasenotes.html)，您将看到以下内容

> 工作副本格式已升级。这意味着 1.5 和更早的 Subversion 客户端将无法使用 Subversion 1.6 生成的工作副本。工作副本会自动升级。

因此，如果您使用基于 1.6 的客户端，则以前的版本都无法使用。在进一步阅读发行说明时，如果需要，您应该能够降级您的工作副本......

> 警告：如果 Subversion 1.6 客户端遇到 1.6 之前的工作副本，它会在碰到它时自动升级工作副本格式，使其无法被旧的 Subversion 客户端读取。如果您在您的机器上使用多个版本的 Subversion，请注意您在哪个工作副本中使用哪个版本，以避免意外升级工作副本。（但请注意，存储库不会发生这种“自动升级”行为，只会发生工作副本。）
> 
> 如果您不小心将 1.5 工作副本升级到 1.6，并希望降级回 1.5，请使用 change-svn-wc-format.py 脚本。有关详细信息，请参阅此 FAQ 条目，并使用 --help 选项运行脚本以获取使用说明。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T02:37:02.577

Brett 得到了我的 +1，对于 Ankh 中的 svn 1.6 支持，请使用[每日](http://ankhsvn.open.collab.net/daily/)构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T02:48:23.563

为 Ankh 使用每日构建的另一种选择（参见 Si 的回答！）是恢复到使用 SVN 1.5 的 TortoiseSVN 1.5.9。这将迫使您将工作副本降级到 1.5（请参阅 Brett 的回答！）。

[这里](http://sourceforge.net/project/showfiles.php?group_id=138498&package_id=151948)有一个下载 1.5.9 版本的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-01T03:34:59.107

我遇到了这个问题。也许它不适用于您的情况，但也许会对其他人有所帮助。

我有双启动窗口和 ubuntu。在 ubuntu 的终端中，我在尝试更新时遇到了该错误，但在阅读了有关格式更改的评论后，我确认我已经拥有最新版本。

然后我突然意识到我试图更新的文件夹是由 Windows 中的 Tortoise / Ankh 创建的；我刚刚为 linux 版本的代码创建了一个单独的文件夹，这无论如何都是有意义的，因为构建文件是不同的。

# language-agnostic - 深蓝色造型

> ID：800560
> 
> 赞同：1
> 
> 时间：2009-04-29T01:52:57.283
> 
> 标签：language-agnostic

这不是一个编程问题，所以如果它不适合这个网站，我深表歉意。

我想创建一个 3 栏网站，其中主导背景颜色为深蓝色，次要侧栏比第三栏更引人注目，主要内容区域为白色。

我正在考虑这个，我想不出任何方法或颜色选择来让它看起来不错。

任何灵感来源或只是颜色建议或整体风格建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T01:54:38.887

在这被击倒之前：

使用[http://colorschemedesigner.com/](http://colorschemedesigner.com/)

它将为您提供网站在配色方案中的外观示例，它还将为您生成模板，这很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T03:10:39.127

我发现[http://www.colourloves.com/](http://www.colourlovers.com/)是最好的配色方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T01:55:06.610

[该站点](http://kuler.adobe.com/)对于帮助选择颜色很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T01:56:49.367

不要错过[http://www.templatemonster.com/](http://www.templatemonster.com/)。

# project - Glut glLoadMatrixf 相机等效

> ID：800562
> 
> 赞同：1
> 
> 时间：2009-04-29T01:53:55.253
> 
> 标签：project, glut, 3dcamera

在我的过剩应用程序中，我正在用相机模拟飞机。当飞机速度较低时，我打算让机头在相机下降时开始指向地面。我的第一个直觉是改变**音高**，直到它向下指向 -90 度。但是我不能只改变俯仰角，因为如果飞机侧面倾斜或倒置，那么它会注意到改变朝向地面的方向。

现在我试图通过向下移动'lookAt.y'来粗略模拟这个。为此，我试图获取用于设置相机的所有当前相机坐标（eye.x、eye.y、eye.z、look.x、look.y、look.z、up.x、up .y，向上.z）。然后用新的修改值调用集合。

我一直在使用 Camera.cpp 和 Camera.h 来控制我的相机功能。他们可以在[这里找到](http://www.ecs.umass.edu/ece/hill/2003/project_files/)

在添加了获取所有值的方法之后，当进行各种相机运动时，实际上只更新了眼睛的值。我想我的问题是如何检索这些值。

glLoadMaxtrix 调用在这个函数中

```
void Camera :: setModelViewMatrix(void)

{ // load model view matrix with existing camera values

    float m[16];

    Vector3 eVec(eye.x, eye.y, eye.z);

    m[0] =  u.x; m[4] =  u.y; m[8]  =  u.z;  m[12] = -eVec.dot(u);

    m[1] =  v.x; m[5] =  v.y; m[9]  =  v.z;  m[13] = -eVec.dot(v);

    m[2] =  n.x; m[6] =  n.y; m[10] =  n.z;  m[14] = -eVec.dot(n);

    m[3] =  0;   m[7] =  0;   m[11] =  0;    m[15] = 1.0;

look.x = u.y; look.y = v.y; look.z = n.y; 

    glMatrixMode(GL_MODELVIEW);

    glLoadMatrixf(m);

} 
```

**有没有办法从这里的矩阵中获取 'eye'、'lookAt' 和 'up' 值？还是我应该做其他事情来获得这些值？**

-在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T02:01:57.247

您链接到的相机类不是实际的 OpenGL 类，但它应该足够简单以便使用。

引用的函数只是获取相机对象的当前值并将它们发送到 OpenGL。如果您查看相机的 set 函数，您可以看到程序如何计算它实际存储的值。

眼睛值直接存储。通过矢量数学，lookAt 值就是 (eye - n) 的值。up 值是最难的，但如果我没记错我的向量数学，我相信 up = (n cross u)。

# iphone - 我需要明确分配我的 NSNumber 吗？

> ID：800570
> 
> 赞同：9
> 
> 时间：2009-04-29T01:55:57.213
> 
> 标签：iphone, objective-c, memory-management

我正在定义一个数字，如下所示：

```
NSNumber *nn0 = [NSNumber numberWithInt:0]; 
```

没有任何分配它工作正常。我的理解是，如果我使用 numberWithInt，alloc 和 init 会自动调用。

如果我尝试在函数结束时释放，我会遇到问题：

```
[nn0 release]; 
```

我收到运行时错误。

我的问题是：如果我使用 numberWithInt 来初始化 NSNumber，我是否必须对其进行任何内存管理？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T02:06:26.160

许多类型的“便利构造函数”会产生一个自动“自动释放”的对象——即新对象将被当前的 NSAutoreleasePool 保留。你不需要手动释放这些对象——它们会在当前 NSAutoreleasePool 被释放/耗尽时被释放。

有关便利构造函数的描述，以及如何管理这些构造函数的内存，请参阅此页面。

[http://www.macdevcenter.com/pub/a/mac/2001/07/27/cocoa.html?page=3](http://www.macdevcenter.com/pub/a/mac/2001/07/27/cocoa.html?page=3)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T02:05:14.977

只需遵循核心内存管理规则：如果您“拥有”变量，则最终必须放弃所有权。您通过以下方式取得所有权：创建对象（alloc/new/copy）或特别取得所有权（保留）。在所有这些情况下，您都需要释放它。

如果您需要对象留下来，您需要获得它的所有权。因此，如果您知道您只需要此方法的数字（例如将其传递到数组或其他任何内容），请使用便捷方法并将其保留。如果您出于某种原因想要保留该数字（例如实例变量），那么您可以安全地分配/初始化它。

如果你发布了你不拥有的东西，你会得到一个运行时错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T05:30:56.027

规则很简单，只有极少数例外：

> 如果返回对象的选择器中包含单词“new”、“alloc”、“retain”或“copy”，那么您拥有返回的对象并负责在完成时释放它。

否则**你不拥有它**，也不应该释放它。如果要保留对非拥有对象的引用，则应调用`-[NSObject retain]`该实例。`-[NSObject release]`您现在“拥有”该实例，因此当您完成该实例时必须调用该实例。因此，您不拥有由返回的实例，`-[NSNumber numberWithInt:]`并且在完成后不应调用`-release`它。如果你想让返回的实例超出当前范围（真的超出当前`NSAutoreleasePool`实例的生命周期），你应该`-retain`这样做。

[在 RegEx 术语中，Peter Hosey 在他的博客](http://boredzo.org/blog/archives/2007-01-11/the-cocoa-memory-management-regular-expression)中很好地阐述了这一点。如果方法选择器与此正则表达式匹配，则您拥有返回的对象实例：

```
/^retain$|^(alloc|new)|[cC]opy/ 
```

当然，权威参考是[Cocoa 的内存管理编程指南](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。

# c# - 学习 C# 以过渡到 C/C++？

> ID：800576
> 
> 赞同：2
> 
> 时间：2009-04-29T01:58:00.017
> 
> 标签：c#, java, c++, programming-languages

好的，所以我刚上了计算机科学的入门课，学校的语言选择是 Java（我对多态、封装等概念有基本的了解）。我想先学习 C++，然后再学习 C（我听说应该先学习 C++，然后再学习 C），并且想知道由于 Java 和 C# 之间的语言相似性，C# 是否是一种很好的过渡语言。那么先学习 C# 会帮助我以后更好地理解 C++ 吗？

我很感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T02:02:02.817

疑。C# 并不比 Java 更像 C++。它确实支持`unsafe`代码中的指针，但除此之外，我想不出任何理由它会成为从 Java 到 C++ 的特别好的桥梁。这也是我怀疑来自另一个方向的开发人员更有可能使用的功能。如果你有其他学习 C# 的原因，我说去吧，但为了更容易地过渡到 C++，我会说跳过它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T02:05:04.370

我觉得从 Java 到 C 和 C++ 最简单的过渡是首先从 C 开始。

感受一下指针而不是托管内存。

然后，一旦您对 C 和 C++ 中的难点有所了解，就可以使用 C++ 来研究对象和 STL。

我就是这样学习的，这对我来说是一个非常容易的过渡。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T05:22:41.743

如果您主要对学习 C++ 感兴趣，请不要学习 C#，因为表面上它们看起来非常相似，但实际上它们完全不同。

我强烈建议学习一种不使用托管内存系统的编程语言。原因是当你处理这样一种语言时，你不得不自己学习内存管理的复杂性。您不能真正依赖垃圾收集器来处理任何事情，因为对象/结构的生存或死亡取决于您。

C 是一种非常小的语言，学习起来可能比 C++ 更快，但如果你最终想使用和学习现代面向对象的语言，你可能会从 C 中养成坏习惯。首先学习 C 不是必需的。

我的最终建议是直接使用 C++ 并感受一下。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T02:00:34.317

如果您已经了解 Java，那么 C# 不会教您比您已经了解的更多的 C++ 知识。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T02:22:44.233

首先学习 C 以获得处理非托管内存的感觉。然后将您学到的有关面向对象概念的知识应用到使用 C++ 的非托管世界。介绍 C++ 的不同之处，如虚方法、多重继承等。

阅读有关最佳实践的书籍。单独学习 C++ 并不能使您立即成为 C++ 开发人员。它是一个语言联盟，您最好知道如何使用该语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T02:24:36.927

只需学习 C。不要为“过渡”而烦恼；如果你的目标是学习 C，直接跳到它。Java 与 C 共享足够多的语法，足以让您不必担心 C++；你只会被 C++ 的东西分心。C 足够重要，可以自己学习，而不是试图“减轻打击”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T02:15:59.507

Java 是面向对象的，C++ 可以是面向对象的，而 C# 主要是 OOP，但这是主要的相似之处。

C# 与 Java 相比发生了很大的变化，因此除非您将 C# 用于 .NET 1.1，否则您将学习一种与 Java 非常不同的语言，如果您的目标是 C，那么您将远离它。

C 是一种结构化语言，因此思维方式与其他三种不同，因为您不再拥有对象，并且您必须自己担心内存收集，没有垃圾收集。

一旦我了解 C 很容易，指针是我学习 C 中最难的部分。

一旦您了解了 C，并且您已经了解了 Java，那么 C++ 将无需学习。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-05T13:01:59.757

我认为没有任何语言可以*平滑*过渡到 C++，除了 D。

几乎是 C++ 和 D 独有的概念：

*   **RAII** -> 确定性资源管理，很难用错，用对微不足道。你不会在 C# 或 C 中学习，你只会在那里学习手动资源管理。
*   **模板元编程**-> 编译时的图灵完整性。尽管大多数程序员不需要这个，而且这种情况不太常见；通常你会以库的形式找到它（最突出的例子：表达式模板）
*   **编译时，duck 类型泛型编程**-> C++ 带有许多与类型无关的算法和容器。C# 泛型是严格类型化的，并且对客户端施加了更多限制。
*   **不同的范式：**过程式、面向对象、泛型和一些函数式编程。C#、Java 和 C 只教授其中的一部分。在 C++ 中，您有机会了解什么时候最合适。
*   **const 正确性**和一个 const 正确的库。

我不喜欢很多程序员将 C++ 或 C 与 C# 的比较简化为*“你也可以在 C# 中拥有指针”*，因为这并没有真正重视真正的差异。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-29T02:07:20.667

总是按照发明的顺序学习，而不是相反。

编辑：建议先学习 C++ 然后 C 是相当疯狂的......我的意思是 C++ 是 C 的超集，一旦你学会了 C++，除了与 C++ 相比它缺乏的东西外，在 C 中没有什么可学的。更容易理解为什么随着语言的发展而添加东西，而不是猜测为什么 C++ 特性没有在 C 中实现。

# telerik - 如何使用 Telerik OpenAccess 的接口

> ID：800583
> 
> 赞同：1
> 
> 时间：2009-04-29T02:01:15.953
> 
> 标签：telerik, openaccess

我正在尝试使用接口实现我的持久类。我创建了以下

```
public interface IFoo
{
    int Id {get;set;}
}

public class Foo : IFoo
{
    private int _id;

    public int Id {get{return _id;} set{_id = value;}}
}

public interface IBar
{
    int Id {get;set;}
    IFoo Foo {get;set;}
}

public class Bar : IBar
{
    private int _id;
    private IFoo _foo;

    public int Id {get{return _id;} set{_id = value;}}
    public IFoo Foo {get{return _foo;} set{_foo = value;}}
} 
```

是否可以表明 Foo 是一个有效的类并默认使用它，我不想使用数据库来存储类类型。

谢谢

罗汉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:09:16.897

描述符列始终是必需的，因为 OpenAccess 不知道以后是否可能有更多有效的实现。您可以做的是使用直接 Foo 引用作为私有字段并将其公开为 Interface 属性。setter 中的类转换异常可能会帮助您找到设置错误对象的位置。

希望有帮助，

简

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T08:53:26.640

查看这些链接：

[http://www.telerik.com/help/openaccess-orm/classes-persistent-interfaces.html](http://www.telerik.com/help/openaccess-orm/classes-persistent-interfaces.html)

[http://www.telerik.com/help/openaccess-orm/the-.net-data-model-user-defined-interfaces.html](http://www.telerik.com/help/openaccess-orm/the-.net-data-model-user-defined-interfaces.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T21:24:02.833

在阅读完 Telerik 指南后，我在他们的论坛上发布了一个问题......

[使用接口而不将类类型存储在数据库中](http://www.telerik.com/community/forums/orm/general-discussions/using-interfaces.aspx)

看起来不可能。

# django - 尝试运行 Django 应用程序时出现 WSGIServer 错误

> ID：800584
> 
> 赞同：8
> 
> 时间：2009-04-29T02:01:30.073
> 
> 标签：django, fastcgi, wsgiserver

首先，这是我的脚本：

```
#!/usr/bin/python
import sys, os

sys.path.append('/home/username/python')
sys.path.append("/home/username/python/flup")
sys.path.append("/home/username/python/django")
# more path stuff

os.environ['DJANGO_SETTINGS_MODULE'] = "project.settings"

from django.core.servers.fastcgi import runfastcgi
runfastcgi(method="threaded", daemonize="false") 
```

正如[这里](http://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/#running-django-on-a-shared-hosting-provider-with-apache)所描述的。

这是我尝试从 shell 运行它时遇到的错误：

```
WSGIServer: missing FastCGI param REQUEST_METHOD required by WSGI!
WSGIServer: missing FastCGI param SERVER_NAME required by WSGI!
WSGIServer: missing FastCGI param SERVER_PORT required by WSGI!
WSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI!
Status: 404 NOT FOUND
Content-Type: text/html

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<!-- more html which looks to be the correct output --> 
```

我的问题是，为什么这些参数不是由 FastCGI 自动传递的？我究竟做错了什么？从我的 Web 服务器运行脚本只会给我一个内部服务器错误。

* * *

而不是我脚本的最后两行，我可以使用

```
from flup.server.fcgi import WSGIServer
from django.core.handlers.wsgi import WSGIHandler
WSGIServer(WSGIHandler()).run() 
```

但我仍然得到完全相同的错误......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T06:22:16.000

解决了。无论出于何种原因，这个 .htaccess 文件都成功了。我发誓我以前试过这一切...

```
AddHandler fcgid-script .fcgi
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteRule ^(media/.*)$ - [L]
RewriteRule ^(adminmedia/.*)$ - [L]
RewriteCond %{REQUEST_URI} !(cgi-bin/myproject.fcgi)
RewriteRule ^(.*)$ cgi-bin/myproject.fcgi/$1 [L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T02:06:27.923

该脚本期望这些参数作为环境变量传递。由于它们不存在于您的 shell 环境中，并且脚本未在 apache fastcgi 环境（提供它们）中运行，因此它会抱怨。

您可以访问 apache 错误日志吗？他们说什么？

您的主机是否支持 mod_wsgi？如果是这样，您可以使用 Django 的 wsgi 处理程序：

```
import sys
import os

base = os.path.dirname(os.path.abspath(__file__)) + '/..'
sys.path.append(base)

os.environ['DJANGO_SETTINGS_MODULE'] = 'yourproject.settings'

import django.core.handlers.wsgi

application = django.core.handlers.wsgi.WSGIHandler() 
```

更多说明可以在[modwsgi wiki](http://code.google.com/p/modwsgi/wiki/IntegrationWithDjango)和[Django 文档](http://docs.djangoproject.com/en/dev/howto/deployment/modwsgi/)中找到。

# .net - 如何在 C# 2.0 中执行异步文件读取？

> ID：800591
> 
> 赞同：4
> 
> 时间：2009-04-29T02:04:07.180
> 
> 标签：.net, multithreading, file-io, c#-2.0

我有一个应用程序需要遍历文本文件中的所有行，大小超过千兆字节。其中一些文件有 10 或 100 的数百万行。

我当前（和同步）阅读的一个例子，看起来像......

```
 using (FileStream stream = new FileStream(args[0], FileMode.Open, FileAccess.Read, FileShare.Read)) {
    using (StreamReader streamReader = new StreamReader(stream)) {
      string line;
      while (!string.IsNullOrEmpty(line = streamReader.ReadLine())) {           
        //do stuff with the line string...
      }
    }
  } 
```

我已经阅读了一些有关 .Net 异步 IO 流式传输方法的内容，并且我正在寻求有关此问题的 2 个具体问题的帮助。

首先，如果我需要每一行的整体性，我会通过异步读取这些文件来提高性能，这些文件通常很短，但长度不同（文件中的每一行之间没有关系）？

其次，如何将上面的代码转换为异步读取，这样我就可以像现在一样逐行处理每一行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T06:42:50.100

您可以尝试使文件读取异步，而不是使该行读取异步。那就是将您问题中的所有代码都包含在一个工作人员代表中。

```
 static void Main(string[] args)
    {
        WorkerDelegate worker = new WorkerDelegate(Worker);
        // Used for thread and result management.
        List<IAsyncResult> results = new List<IAsyncResult>();
        List<WaitHandle> waitHandles = new List<WaitHandle>();

        foreach (string file in Directory.GetFiles(args[0], "*.txt"))
        {
            // Start a new thread.
            IAsyncResult res = worker.BeginInvoke(file, null, null);
            // Store the IAsyncResult for that thread.
            results.Add(res);
            // Store the wait handle.
            waitHandles.Add(res.AsyncWaitHandle);
        }

        // Wait for all the threads to complete.
        WaitHandle.WaitAll(waitHandles.ToArray(), -1, false); // for < .Net 2.0 SP1 Compatibility

        // Gather all the results.
        foreach (IAsyncResult res in results)
        {
            try
            {
                worker.EndInvoke(res);
                // object result = worker.EndInvoke(res); // For a worker with a result.
            }
            catch (Exception ex)
            {
                // Something happened in the thread.
            }
        }
    }

    delegate void WorkerDelegate(string fileName);
    static void Worker(string fileName)
    {
        // Your code.
        using (FileStream stream = new FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.Read))
        {
            using (StreamReader streamReader = new StreamReader(stream))
            {
                string line;
                while (!string.IsNullOrEmpty(line = streamReader.ReadLine()))
                {
                    //do stuff with the line string...
                }
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T02:08:44.297

异步模式是 BeginRead()/EndRead()。

你是否得到提升在很大程度上取决于你在阅读时发生的其他事情。在等待读取时，您的应用程序还能做些什么吗？如果没有，那么异步将无济于事......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T02:13:48.950

异步读取最终只会使 head 为每个块寻找更多。通过对文件系统上的文件进行良好的碎片整理和使用同步读取，您将获得更好的性能提升。

正如已经指出的那样，将行处理分派给其他线程应该会有所提升（尤其是在多核 CPU 上）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T03:30:19.173

如果性能非常关键，我建议调查互操作以`FILE_FLAG_SEQUENTIAL_SCAN`查看[详细信息here](http://support.microsoft.com/default.aspx?scid=kb;EN-US;9875)

最好还是编写一个小型 C++ 应用程序，在打开该标志的情况下扫描文件，看看它是否提高了性能。

# javascript - 循环遍历 JSON 对象列表

> ID：800593
> 
> 赞同：67
> 
> 时间：2009-04-29T02:04:14.153
> 
> 标签：javascript, jquery, web-services, json

我从 Web 服务返回 List<> 作为 JSON 对象列表。我正在尝试使用 for 循环遍历列表并从属性中获取值。这是返回 JSON 的示例：

```
{"d":[{"__type":"FluentWeb.DTO.EmployeeOrder",
 "EmployeeName":"Janet Leverling",
 "EmployeeTitle":"Sales Representative",
 "RequiredDate":"\/Date(839224800000)\/",
 "OrderedProducts":null}]} 
```

所以我试图使用这样的东西来提取内容：

```
function PrintResults(result) {

for (var i = 0; i < result.length; i++) { 
    alert(result.employeename);
} 
```

这应该怎么做？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-04-29T02:06:48.437

小心，`d`是清单。

```
for (var i = 0; i < result.d.length; i++) { 
    alert(result.d[i].employeename);
} 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-08T17:40:25.677

had same problem today, Your topic helped me so here goes solution ;)

```
 alert(result.d[0].EmployeeTitle); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-29T02:07:40.480

很近！试试这个：

```
for (var prop in result) {
    if (result.hasOwnProperty(prop)) {
        alert(result[prop]);
    }
} 
```

更新：

如果您的结果确实是一个对象的数组，那么您可能必须这样做：

```
for (var prop in result[0]) {
    if (result[0].hasOwnProperty(prop)) {
        alert(result[0][prop]);
    }
} 
```

或者，如果您想遍历数组中的每个结果（如果有更多结果），请尝试：

```
for (var i = 0; i < results.length; i++) {
    for (var prop in result[i]) {
        if (result[i].hasOwnProperty(prop)) {
            alert(result[i][prop]);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-11-18T09:56:31.127

Here it is:

```
success: 
    function(data) {
        $.each(data, function(i, item){
            alert("Mine is " + i + "|" + item.title + "|" + item.key);
        });
    } 
```

Sample JSON text:

```
{"title": "camp crowhouse", 
"key": "agtnZW90YWdkZXYyMXIKCxIEUG9zdBgUDA"} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-29T14:53:49.793

由于您使用的是 jQuery，因此您不妨使用 each 方法……此外，似乎一切都是此 JS 对象 [Notation] 中属性“d”的值。

```
$.each(result.d,function(i) {
    // In case there are several values in the array 'd'
    $.each(this,function(j) {
        // Apparently doesn't work...
        alert(this.EmployeeName);
        // What about this?
        alert(result.d[i][j]['EmployeeName']);
        // Or this?
        alert(result.d[i][j].EmployeeName);
    });
}); 
```

That should work. if not, then maybe you can give us a longer example of the JSON.

**Edit:** If none of this stuff works then I'm starting to think there might be something wrong with the syntax of your JSON.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-09-20T07:07:58.027

```
var d = $.parseJSON(result.d);
for(var i =0;i<d.length;i++){
    alert(d[i].EmployeeName);
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-05-13T22:16:04.750

This will work!

```
$(document).ready(function ()
    {
        $.ajax(
            {
            type: 'POST',
            url: "/Home/MethodName",
            success: function (data) {
                //data is the string that the method returns in a json format, but in string
                var jsonData = JSON.parse(data); //This converts the string to json

                for (var i = 0; i < jsonData.length; i++) //The json object has lenght
                {
                    var object = jsonData[i]; //You are in the current object
                    $('#olListId').append('<li class="someclass>' + object.Atributte  + '</li>'); //now you access the property.

                }

                /* JSON EXAMPLE
                [{ "Atributte": "value" }, 
                { "Atributte": "value" }, 
                { "Atributte": "value" }]
                */
            }
        });
    }); 
```

The main thing about this is using the property exactly the same as the attribute of the JSON key-value pair.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-23T10:21:27.677

I have the following call:

```
$('#select_box_id').change(function() {
        var action = $('#my_form').attr('action');
    $.get(action,{},function(response){
        $.each(response.result,function(i) {

            alert("key is: " + i + ", val is: " + response.result[i]);

        });
    }, 'json');
    }); 
```

The structure coming back from the server look like:

```
{"result":{"1":"waterskiing","2":"canoeing","18":"windsurfing"}} 
```

# syntax - What does the period do in this line of Fortran?

> ID：800610
> 
> 赞同：3
> 
> 时间：2009-04-29T02:14:18.810
> 
> 标签：syntax, fortran

I am not sure what version of Fortran this is, but the line is:

`Term = F*F - 4.*E*G`

I know that it multiplies F by F and then subtracts something, but I don't know what the period after the 4 is doing there.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T02:16:17.713

I'm going to venture a guess based on every other programming language I've ever seen, and say that it's making the constant "4" of type Real, rather than Integer. In other words, it's making sure the types in the expression all match up. "4.0" would be equivalent; whoever wrote this code was just feeling extra concise that day.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T02:16:24.373

It makes it a real number instead of an integer.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T07:16:50.340

If you're new to Fortran, a "REAL" number is what is called in C-like languages a "float".

But only Fortran programmers can say the GOD is REAL, by default.

# c# - C#从异常句柄返回一些东西

> ID：800612
> 
> 赞同：1
> 
> 时间：2009-04-29T02:15:54.313
> 
> 标签：c#, exception-handling

我的一类中有以下代码。此类的目的是从 Web 服务器获取余额。以防万一在取得平衡时出现问题。我会处理一个异常。然而，这一切都很容易做到。但是我想知道我在 catch 语句中返回了什么。

我查看的大多数示例只是使用以下命令写入控制台：

```
Console.WriteLine(ex.Message); 
```

这一切都很好。但在实际应用程序中，大多数开发人员会做什么？

```
 //Download only when the webclient is not busy.
        if (!wc.IsBusy)
        { 
            // Sleep for 1/2 second to give the server time to update the balance.
            System.Threading.Thread.Sleep(500);

            try
            {
                // Download the current balance.
                wc.DownloadStringAsync(new Uri(strURL));
            }
            catch (WebException ex)
            {
                Console.Write("GetBalance(): " + ex.Message);
            }
        }
        else
        {
            Console.Write("Busy please try again");
        } 
```

我现在的函数返回无效。我只是想知道如果网络客户端很忙，我还会返回什么？

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T02:22:30.787

**如果您无法处理异常，请不要捕获它。**如果只返回一些值，调用方法必须检查该值是真实结果还是只是异常的指示符。现在这个方法必须决定做什么并返回。以及调用此方法的方法。而且方法...

因此，只需让异常在堆栈中冒泡并在可以处理的地方捕获它。也许直接在用户界面下方，然后显示一个消息框，询问用户是否要重试或显示如何解决问题的信息。如果您没有用户界面，请在可以解决问题的地方找到它并重试。如果是临时问题，请在合理的级别重试整个任务，直到调用成功。

如果要记录某些内容，请使用以下模式记录异常并重新抛出它。

```
try
{
   DoStuff();
}
catch (Exception exception)
{
   Log(exception.ToString());

   throw;
} 
```

请注意，它是`throw;`而不是`throw exception;`。如果您稍后执行，您将丢失原始堆栈跟踪。如果您可以推断出有关异常原因的更多详细信息，则应将捕获的异常包装为具有附加信息的更有意义的异常。

```
try
{
   DoStuff();
}
catch (SpecificMeaninglessException exception)
{
   Log(exception.ToString());

   throw new MeaningfulException("Details about the error.", exception);
}
catch (Exception exception)
{
   Log(exception.ToString());

   throw;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T02:21:14.690

你应该使用 ex.ToString() 方法

> Exception.Message 包含对异常的简单描述（例如“未设置对象引用...”）。
> 
> Exception.ToString() 包含异常的描述以及完整的堆栈跟踪。

[.NET 中的异常处理最佳实践](http://www.codeproject.com/KB/architecture/exceptionbestpractices.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T02:19:00.187

如果客户端很忙但在重试之前等待一段时间，您可以重新运行该方法吗？重试 x 次后可能会失败。

相反，如果您希望继续并简单地记录问题，您的 catch 语句可以将异常记录到基于文件的日志、事件查看器、提交到数据库、在必要时发出警报（电子邮件、短信等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T02:24:18.690

取决于异常的严重程度。

我建议[从 Patterns & Practices 中查看 The Exception Block](http://msdn.microsoft.com/en-us/library/cc309505.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T02:27:30.087

如果您只对查看异常感兴趣，您应该重新抛出异常，以便计划处理它的人仍然会得到它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T02:55:17.277

您当然不想掩盖未处理的异常。让它通过堆栈冒泡。但是，如果您要询问如果 Web 客户端正忙时要返回什么，那么返回一个随机间隔或某个有意义的间隔，函数调用者在尝试再次下载余额之前应该等待该间隔如何？随机数可以分配负载或以其他方式缓解碰撞问题。可以根据服务器的当前状态发回更有意义的间隔。

# .net - 透明键和 Vista

> ID：800614
> 
> 赞同：0
> 
> 时间：2009-04-29T02:16:11.393
> 
> 标签：.net, .net-3.5, windows-vista

我正在尝试使用透明度键。根据文档，您应该能够使用它在应用程序中放置“孔”，您应该能够单击应用程序中的透明区域并工作（例如“单击”事物后面）。但是，在 Vista Ultimate 64bit 中，我不能。以下代码在 Vista 中不起作用，但在 XP Pro 中可以。

```
`Public Class Form1
    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Me.BackColor = Color.Red
        Me.TransparencyKey = Me.BackColor
    End Sub
End Class` 
```

`有没有人知道为什么 Win XP 可以使用此代码，而 Win Vista 不允许单击窗口中的孔？`

 `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-10T16:02:48.853

我知道这没有任何意义。但它对我有用。我所做的不是使用 Mr.BackColor 引用颜色，而是再次使用颜色，如下所示：

```
Public Class Form1
    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Me.BackColor = Color.Red
        Me.TransparencyKey = Color.Red
    End Sub
End Class 
```

这对你有用吗？

# visual-studio - msbuild 无法注册输出

> ID：800618
> 
> 赞同：5
> 
> 时间：2009-04-29T02:17:56.943
> 
> 标签：visual-studio, visual-studio-2008, msbuild, regsvr32

我试图让我们的构建脚本（使用 MSBuild）在 Vista 上正常工作，并且发现将注册输出（在链接器选项中）选项设置为 True 的项目无法从命令行构建，如下所示：

项目：错误 PRJ0050：无法注册输出。请尝试启用每用户重定向或使用提升的权限从命令提示符注册组件。

虽然我可以很容易地为一台机器解决这个问题，但通过以管理员身份运行或任何我希望构建脚本对任何开发机器“正常工作”的方式运行。

即使只是注册失败但继续构建也是令人满意的。有什么建议么？

布拉德

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-17T20:31:28.180

您可以创建包含以下文本的 cmd 文件：

```
@echo 关闭
调用 regsvr32.exe /s %1
if %errorlevel% EQU 0 goto ok
echo 注册 %1 失败
转到退出
：行
echo 注册成功 %1
：出口

```

之后，您应该关闭注册输出，并且应该使用命令添加自定义构建步骤`<pathtocmdscript> $(TargetPath)`。对于自定义构建步骤，输出一应设置为 $(TargetPath)。

最后，您将收到有关注册进度的消息，但编译不会在该步骤停止。

# sql - 是否可以维护 43 页查询？

> ID：800620
> 
> 赞同：0
> 
> 时间：2009-04-29T02:18:36.410
> 
> 标签：sql, maintainability

我一直认为 SQL 编译器会崩溃，但显然嵌套几乎是无限的。这段代码是要立即丢弃还是有一线希望这样的东西可以运行？

这个查询并不真正属于我，所以我不能发布它......但是让我们假装它是[这个](http://forums.oracle.com/forums/message.jspa?messageID=1326516#1326516)：

```
[SELECT /*+ NOPARALLEL bypass_recursive_check */ 
SP_ALIAS_190, 
((CASE SP_ALIAS_191
WHEN 1
THEN 'PROVIDER::ALL_PROV::'
WHEN 0] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T02:20:44.050

显然，您从未见过从 Sharepoint DAL 产生的 SQL。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T02:30:16.010

如果查询是由工具（或代码）生成的，那么维护起来可能相对简单（从某种意义上说，查询生成代码实际上可能编写得很好并且可维护）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T02:24:48.503

我最近遇到了类似的问题，我通过考虑几件事做出了决定：

*   维护与重写需要多长时间？
*   这有多重要？可能有很多逻辑可能难以解开，并且“它有效”这一事实的价值超过了立即重写的价值。

当然，管理层必须做出有关冒险解释为什么必须重写最近创建的东西的政治决策。

最后（对我来说），find + replace 是我的朋友。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T02:32:46.707

[使用WITH](https://stackoverflow.com/questions/488020/what-is-your-most-useful-sql-trick-to-avoid-writing-more-code/488313#488313)语句重构它。添加很多很多很多评论。

如果你把它分解成可以管理的部分，你就有更好的机会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T02:47:42.800

如果它包含嵌套分配，我会说不。

就像任何代码一样，无论是什么语言，你都应该只考虑重写它，因为你可以让它更高效或更容易理解。

根据我的经验，我已经能够将编写不好的 SQL 减少 4 到 5 倍的大小和许多倍的性能，因为原始作者真的不知道。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T02:48:19.117

如果您认为这很糟糕，您应该观看 Industrial Logic 关于代码异味的示例视频：[技术债务](https://elearning.industriallogic.com/gh/submit?Action=PageAction&album=recognizingSmells&path=recognizingSmells/technicalDebt/technicalDebtMismanagement&devLanguage=CSharp)。绝对不是自动生成的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T02:25:02.760

是否可以在 C# 中维护 43 页功能？答案很明显;)。我只是无法想象这一点。如果我是你，我会把它分成更小的部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T04:41:34.213

两件事情：

*   只有机器需要读取这个 SQL 吗？
*   您是否坚持底层架构？

如果您有一个 43 页的查询并且您对前两个问题的回答是肯定的，欢迎来到 SharePoint 开发

# php - 从 wordpress 插件输出内容并重写规则

> ID：800653
> 
> 赞同：0
> 
> 时间：2009-04-29T02:29:00.130
> 
> 标签：php, wordpress, plugins, url-rewriting

我创建了一个带有过滤器的 wordpress 插件`the_content`，查找特定标签，然后输出插件内容代替该标签。

我现在想使用重写规则来调用插件并在模板中输出数据，但我没有找到太多帮助。

有人可以提供一个示例或一些关于如何使用内置 wp 方法添加重写规则并在输出一些内容的插件中调用我的方法的指导。

理想情况下，我希望`shop/`匹配，然后在 shop 之后将所有内容传递给我插件上的 dispatch 方法，以便我可以拥有`shop/category/shirts`或`shop/product/the-cool-shirt`. 我的调度方法将处理拆分 URL 的其余部分并相应地调用方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T05:36:07.233

这会变得相当有趣。我不得不为一个插件做这个，我面前没有它，所以它内存不足，但总体思路应该是正确的。

```
<?php

add_action('init', 'rewrite_rules');        

function rewrite_rules() {
    global $wp, $wp_rewrite;
    $wp_rewrite->add_rule('(widget1|widget2|widget3)/([a-zA-Z0-9_-]{3,50})$', 'index.php?pagename=listing&category=$matches[1]&subcategory=$matches[2]', 'top' );
    $wp->add_query_var( 'category' );
    $wp->add_query_var( 'subcategory' );
    $wp_rewrite->flush_rules();
}

?> 
```

使用正则表达式本身就是一项艰巨的任务，我相信我使用了这个站点：[http](http://tools.netshiftmedia.com/regexlibrary/) ://tools.netshiftmedia.com/regexlibrary/寻求帮助。

我还使用 FakePage 插件来实际显示我的自定义“动态”页面，正如我所说的那样，但我认为 WP 中的所有内容在技术上都是动态的。

[http://scott.sherrillmix.com/blog/blogger/creating-a-better-fake-post-with-a-wordpress-plugin/](http://scott.sherrillmix.com/blog/blogger/creating-a-better-fake-post-with-a-wordpress-plugin/)

如果您需要更多帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T12:04:28.093

不久前我做了一件非常相似的事情，我是通过作弊来做到的。

如果您发现内置的重写规则过于复杂或无法完成工作，您可能会发现更容易捕获请求并过滤结果。简化版：

```
add_action('parse_request', 'my_parse_request');

function my_parse_request (&$wp) {
  $path = $wp->request;

  $groups = array();
  if (preg_match("%shop/product/([a-zA-Z0-9-]+)%", $path, $groups)) {
    $code = $groups[1];
    $product = get_product($code); // your own code here
    if (isset($product)) {
      add_filter('the_posts', 'my_product_filter_posts');
    }
  }
}

function my_product_filter_posts ($posts) {
  ob_start();
  echo "stuff goes here";  //  your body here
  $content = ob_get_contents();
  ob_end_clean();

  return array(new DummyResult(0, "Product name", $content));
} 
```

解释：

1.  `parse_request`在数据库查找之前调用操作。根据 URL，它会安装其他操作和过滤器。

2.  帖子上的过滤器将数据库查找的结果替换为虚假结果。

DummyResult 是一个简单的类，它具有与帖子相同的字段，或者只是足以摆脱它：

```
class DummyResult {
  public $ID;
  public $post_title;
  public $post_content;

  public $post_author;
  public $comment_status = "closed";
  public $post_status = "publish";
  public $ping_status = "closed";
  public $post_type = "page";
  public $post_date = "";

  function __construct ($ID, $title, $content) {
    $this->ID = $ID;
    $this->post_title = $title;
    $this->post_content = $content;

    $this->post_author = get_default_author(); // implement this function
  }
} 
```

上面有很多作业留给读者，但这是一种丑陋的工作方法。您可能需要为 , 添加一个过滤器`template_redirect`，以用特定于产品的页面模板替换普通页面模板。如果您想要漂亮的永久链接，您可能需要调整 URL 正则表达式。

# zsh - 无法取消 rm 的别名并让它成为 Zsh 中的一个函数

> ID：800657
> 
> 赞同：1
> 
> 时间：2009-04-29T02:29:44.153
> 
> 标签：zsh

我在 .zshrc 中运行失败

```
unalias rm  
rm() { mv $* /tmp/wastebasket } 
```

我在启动时

```
/Users/Masi/.zshrc:unalias:34: no such hash table element: rm 
```

我注意到哈希表问题一直是[Ubuntu](http://qa.ubuntu.com/reports/launchpad-database/unfixed-bugs-with-patches.html)中用于运行帮助的一个未解决的错误。我不确定该错误是否也适用于 Mac 和`rm`-command。

**如何在启动时关闭通知？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-29T02:40:37.340

其他人都是对的，您根本没有别名。更重要的是：

**不**要这样做。有一天，您将在另一台遵循 POSIX 标准的 POSIX 机器上（删除而不“回收”），您会随意删除某些内容并且无法撤消它。现在学习 rm 纪律。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-14T08:16:11.643

您应该只尝试删除存在的别名。创建一个没有别名的别名让我觉得很难看。我的建议是测试 rm 是否是别名，如果是，则取消别名。

```
 case $(type rm) in
     (*alias*) unalias rm;;
 esac 
```

或使用蛮力并忽略 stderr

```
 unalias rm 2>/dev/null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T02:35:00.570

该错误消息是因为您尝试取消`rm`别名并且没有这样的别名。

由于您可以多次使用别名而不会出现错误，因此我会将您的代码更改为：

```
alias rm=x
unalias rm  
rm() { mv $* /tmp/wastebasket } 
```

这保证`rm`在您尝试取消别名之前作为别名存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T02:35:44.920

我对 zsh 不是很熟悉，但可能是因为 rm 不是别名，而实际上是驻留在 /bin 中的标准实用程序。

您可以直接给它取别名，而不必先尝试取消它的别名，从而覆盖任何以前的别名。

# asp.net - 新的 ASP.NET 图表控件在已部署的网站上不起作用

> ID：800662
> 
> 赞同：0
> 
> 时间：2009-04-29T02:32:49.980
> 
> 标签：asp.net, controls, charts

我已将我的网站部署到 .net 2.0.50727 主机，但带有[图表控件](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)的页面无法正常工作。

我想可能是因为这个.net版本不支持图表控件或者我忘记上传一些必需的程序集。

有人知道需要哪些组件吗？图表控件是否适用于 .net 2？我已经上传了 System.Web.DataVisualization.dll 和 System.Drawing.dll。我的机器上有 .net 3.5，图表可以正常工作。

我也在使用 ASP.NET MVC RC，没有任何问题。我猜它需要asp.net 3.5，因为我不明白为什么图表控件不起作用。

拜托，有人可以给我任何线索吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T02:38:12.823

您的托管服务器需要具有 .Net Framework 3.5 SP1 才能使**[图表控件](http://msdn.microsoft.com/en-us/magazine/dd453008.aspx)**正常工作，并且您需要将`System.Web.DataVisualization.dll`引用“复制本地”属性设置为 true。

# blogs - 您会向 .NET 开发人员推荐哪个免费博客提供商？

> ID：800672
> 
> 赞同：2
> 
> 时间：2009-04-29T02:38:23.197
> 
> 标签：blogs

我是一名 .NET 开发人员，我有兴趣撰写有关 Silverlight、.NET 和其他内容的文章……

您会向我推荐哪个免费博客提供商？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T02:40:50.023

[http://www.dotnetblogengine.net/](http://www.dotnetblogengine.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T03:12:04.317

dasBlog 因为开发人员不可避免地会涉及到博客引擎的内部。并且因为[Computer Zen](http://www.hanselman.com/blog/)在其上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T02:48:14.030

[Umbraco](http://umbraco.org) + [Umbraco 博客包](http://www.nibble.be/?p=57)

一流的 CMS 和一个非常易于安装和使用的博客包

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T03:10:49.547

我同意 mP 的评论，即为博客内部提供支持的技术并不重要，但我猜你想要一个运行 .NET 的博客。

检查我发布的类似问题的答案，[https://stackoverflow.com/questions/646538/cms-for-a-personal-website-asp-net-c/649073#649073](https://stackoverflow.com/questions/646538/cms-for-a-personal-website-asp-net-c/649073#649073)。它是集成到您自己的 ASP.NET 网站中的 blogger.com 服务。

干杯，

尼克特

# c# - 我应该选择哪种加密哈希函数？

> ID：800685
> 
> 赞同：146
> 
> 时间：2009-04-29T02:47:23.253
> 
> 标签：c#, .net, hash, cryptography, cryptographic-hash-function

.NET 框架附带 6 种不同的散列算法：

*   MD5：16 字节（哈希 500MB 的时间：1462 毫秒）
*   SHA-1：20 字节（1644 毫秒）
*   SHA256：32 字节（5618 毫秒）
*   SHA3​​84：48 字节（3839 毫秒）
*   SHA512：64 字节（3820 毫秒）
*   RIPEMD：20 字节（7066 毫秒）

这些功能中的每一个都执行不同的操作；MD5 是最快的，RIPEMD 是最慢的。

MD5的优点是适合内置Guid类型；[它是类型 3 UUID 的基础](https://www.rfc-editor.org/rfc/rfc4122#section-4.3)。[SHA-1 哈希是类型 5 UUID 的基础。](https://www.rfc-editor.org/rfc/rfc4122#section-4.3)这使得它们非常容易用于识别。

然而，MD5 容易受到[碰撞攻击](http://en.wikipedia.org/wiki/Cryptographic_hash_function)，SHA-1 也容易受到攻击，但程度较轻。

### 在什么情况下我应该使用哪种哈希算法？

我真的很想看到答案的具体问题是：

*   MD5不可信吗？在正常情况下，当您使用没有恶意的 MD5 算法并且没有第三方有任何恶意时，您会期望任何冲突（意味着两个任意字节 [] 产生相同的哈希）

*   RIPEMD 比 SHA1 好多少？（如果它更好的话）它的计算速度慢了 5 倍，但哈希大小与 SHA1 相同。

*   散列文件名（或其他短字符串）时发生非恶意冲突的几率是多少？（例如 2 个具有相同 MD5 哈希的随机文件名）（使用 MD5 / SHA1 / SHA2xx） 一般来说，非恶意冲突的几率是多少？

这是我使用的基准：

```
 static void TimeAction(string description, int iterations, Action func) {
        var watch = new Stopwatch();
        watch.Start();
        for (int i = 0; i < iterations; i++) {
            func();
        }
        watch.Stop();
        Console.Write(description);
        Console.WriteLine(" Time Elapsed {0} ms", watch.ElapsedMilliseconds);
    }

    static byte[] GetRandomBytes(int count) {
        var bytes = new byte[count];
        (new Random()).NextBytes(bytes);
        return bytes;
    }

    static void Main(string[] args) {

        var md5 = new MD5CryptoServiceProvider();
        var sha1 = new SHA1CryptoServiceProvider();
        var sha256 = new SHA256CryptoServiceProvider();
        var sha384 = new SHA384CryptoServiceProvider();
        var sha512 = new SHA512CryptoServiceProvider();
        var ripemd160 = new RIPEMD160Managed();

        var source = GetRandomBytes(1000 * 1024);

        var algorithms = new Dictionary<string,HashAlgorithm>();
        algorithms["md5"] = md5;
        algorithms["sha1"] = sha1;
        algorithms["sha256"] = sha256;
        algorithms["sha384"] = sha384;
        algorithms["sha512"] = sha512;
        algorithms["ripemd160"] = ripemd160;

        foreach (var pair in algorithms) {
            Console.WriteLine("Hash Length for {0} is {1}", 
                pair.Key, 
                pair.Value.ComputeHash(source).Length);
        }

        foreach (var pair in algorithms) {
            TimeAction(pair.Key + " calculation", 500, () =>
            {
                pair.Value.ComputeHash(source);
            });
        }

        Console.ReadKey();
    } 
```

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-04-29T06:30:15.247

在密码学中，散列函数提供三个独立的函数。

1.  **碰撞阻力**：某人找到两条哈希相同的消息（*任意两条消息）有多难。*
2.  **原像阻力**：给定一个哈希值，找到另一个哈希值相同的消息有多难？也称为*单向哈希函数*。
3.  **第二个原像阻力**：给定一条消息，找到另一条哈希相同的消息。

这些属性是相关但独立的。例如，碰撞阻力意味着第二原像阻力，但反之则不然。对于任何给定的应用程序，您将有不同的要求，需要这些属性中的一个或多个。用于保护服务器密码的散列函数通常只需要原像抗性，而消息摘要需要这三个功能。

已经证明 MD5 不耐碰撞，然而，这并不排除它在不需要耐碰撞的应用中的使用。事实上，MD5 仍然经常用于较小的密钥大小和速度有好处的应用程序中。也就是说，由于其缺陷，研究人员建议在新场景中使用其他哈希函数。

SHA1 有一个缺陷，理论上它允许在远少于其长度的安全散列函数所需的 2^80 步中发现冲突。攻击不断被修改，目前可以在 ~2^63 步内完成 - 仅在当前的可计算性范围内。出于这个原因，NIST 正在逐步淘汰 SHA1 的使用，并指出 SHA2 系列应该在 2010 年之后使用。

SHA2 是在 SHA1 之后创建的一个新的哈希函数系列。目前没有针对 SHA2 函数的已知攻击。SHA256、384 和 512 都是 SHA2 系列的一部分，只是使用了不同的密钥长度。

RIPEMD 我不能过多评论，只是要注意它不像 SHA 系列那样常用，因此没有受到密码学研究人员的仔细审查。仅出于这个原因，我建议使用 SHA 函数。在您使用的实现中，它似乎也很慢，这使得它不太有用。

总之，没有一个最好的功能——这完全取决于你需要它做什么。请注意每个缺陷，您将能够最好地为*您的*场景选择正确的哈希函数。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2009-05-03T13:59:15.243

## 所有哈希函数都“损坏”

[鸽笼原则](http://en.wikipedia.org/wiki/Pigeonhole_principle)说，尽你所能，你不能在 2 个洞里放超过 2 只鸽子（除非你把鸽子剪掉）。同样，您不能在 2^128 个插槽中放置 2^128 + 1 个数字。所有哈希函数都会产生有限大小的哈希，这意味着如果您搜索“有限大小”+ 1 个序列，您总能找到冲突。这样做是不可行的。不适用于 MD5 和[Skein](http://www.schneier.com/skein.html)。

## MD5/SHA1/Sha2xx 没有机会碰撞

所有的散列函数都有冲突，这是不争的事实。偶然遇到这些碰撞相当于**赢得了星际彩票**。也就是说，[没有人中了星际彩票](https://stackoverflow.com/questions/201705/how-many-random-elements-before-md5-produces-collisions/288519#288519)，这只是彩票的运作方式。您永远不会遇到意外的 MD5/SHA1/SHA2XXX 哈希。每个字典中的每个单词，每种语言中的每个单词，都会散列到不同的值。整个星球上每台机器上的每个路径名都有不同的 MD5/SHA1/SHA2XXX 哈希值。我怎么知道的，你可能会问。好吧，正如我之前所说，从来没有人中过星际彩票。

## 但是……MD5坏了

**有时，它坏掉的事实并不重要**。

就目前而言，没有已知的对 MD5[的原像或第二原像攻击。](http://en.wikipedia.org/wiki/Preimage_attack)

那么，您可能会问，MD5 有什么问题？第三方有可能生成 2 条消息，其中一条是 EVIL，另一条是 GOOD，它们的哈希值相同。（[碰撞攻击](http://en.wikipedia.org/wiki/Birthday_attack)）

尽管如此，如果您需要抗原像性，当前的 RSA 建议是不要使用 MD5。在涉及安全算法时，人们倾向于谨慎行事。

## 那么我应该在 .NET 中使用什么哈希函数呢？

*   如果您需要速度/大小并且不关心生日攻击或原像攻击，请使用 MD5。

在我之后重复这个，**没有机会 MD5 碰撞**，可以精心设计恶意碰撞。尽管迄今为止在 MD5 上没有已知的前映像攻击，但安全专家的说法是，不应在需要防御前映像攻击的地方使用 MD5。**SHA1 也一样**。

请记住，并非所有算法都需要防御原像或碰撞攻击。以第一次搜索 HD 上的重复文件为例。

*   如果您想要加密安全的散列函数，请使用基于 SHA2XX 的函数。

没有人发现任何 SHA512 冲突。曾经。他们真的很努力。就此而言，没有人发现任何 SHA256 或 384 冲突。.

*   不要使用 SHA1 或 RIPEMD，除非它用于互操作性场景。

RIPMED 没有受到与 SHAX 和 MD5 一样多的审查。SHA1 和 RIPEMD 都容易受到生日攻击。它们都比 .NET 上的 MD5 慢，并且只有 20 字节大小。使用这些功能毫无意义，忘记它们。

SHA1 碰撞攻击下降到 2^52，在 SHA1 碰撞在野外出现之前不会太久。

有关各种散列函数的最新信息，请查看[散列函数 zoo](http://ehash.iaik.tugraz.at/wiki/The_Hash_Function_Zoo)。

## 但是等等还有更多

拥有一个**快速**的散列函数可能是一个诅咒。例如：哈希函数的一个非常常见的用法是密码存储。本质上，您计算密码的哈希值和已知的随机字符串（以阻止彩虹攻击）并将该哈希值存储在数据库中。

问题是，如果攻击者得到数据库的转储，他可以非常有效地使用暴力破解密码。他尝试的每个组合只需要几分之一毫秒，他每秒可以尝试数十万个密码。

为了解决这个问题，可以使用[bcrypt](https://stackoverflow.com/questions/873403/net-impl-of-bcrypt)算法，它的设计速度很慢，因此如果使用 bcrypt 攻击系统，攻击者的速度将大大减慢。最近[scrypt](http://www.daemonology.net/blog/2009-05-09-scrypt-key-derivation.html)出现了一些头条新闻，并且被一些人认为比 bcrypt 更有效，但我不知道 .Net 实现。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-05-01T01:45:15.337

# 更新：

时代变了，我们有了 SHA3 赢家。我建议使用[SHA3 竞赛的 keccak](http://keccak.noekeon.org/)（又名[SHA3](http://en.wikipedia.org/wiki/SHA-3)）获胜者。

# 原答案：

按照从弱到强的顺序，我会说：

1.  RIPEMD BROKEN，不应该使用[，如本 pdf 所示](http://eprint.iacr.org/2004/199.pdf)
2.  MD-5 BROKEN，永远不要使用，[可以用笔记本电脑在 2 分钟内打破](http://eprint.iacr.org/2005/075)
3.  SHA-1 BROKEN，永远不应该使用，[原则上被破坏，攻击每周都在变好](http://www.h-online.com/security/Hash-cracked--/features/75686)
4.  SHA-2 WEAK，未来几年可能会被打破。[发现了一些弱点。](http://portal.acm.org/citation.cfm?id=1427257)请注意，通常密钥大小越大，哈希函数越难破解。虽然密钥大小 = 强度并不总是正确的，但大多数情况下都是正确的。所以 SHA-256 可能比 SHA-512 弱。
5.  Skein NO KNOWN WEAKNESSES，[是 SHA-3 的候选者](http://en.wikipedia.org/wiki/SHA-3)。它是相当新的，因此未经测试。[它已经以多种语言实现。](http://www.skein-hash.info/)
6.  MD6 NO KNOWN WEAKNESSES，是 SHA-3 的另一个候选者。可能比 Skien 强，但在单核机器上速度较慢。像 Skien 一样，它未经测试。一些具有安全意识的开发人员正在以[任务关键型角色](http://mtc.sri.com/Conficker/addendumC/)使用它。

我个人会使用 MD6，因为人们永远不会太偏执。如果速度是一个真正的问题，我会考虑 Skein 或 SHA-256。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T05:10:05.780

在 MD5 的辩护中，没有已知的方法可以生成具有任意 MD5 散列的文件。原作者必须提前计划进行工作冲突。因此，如果接收方信任发送方，MD5 就可以了。如果签名者是恶意的，MD5 就会被破坏，但不知道它是否容易受到中间人攻击。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-21T21:33:58.300

看看[BLAKE2](https://blake2.net/)算法是个好主意。

如前所述，它比 MD5 更快，并且至少与 SHA-3 一样安全。它也由[几个软件应用程序](https://blake2.net/#us)实现，包括 WinRar。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T02:53:04.643

您使用哪一个实际上取决于您使用它的目的。如果您只是想确保文件在传输过程中不会损坏并且不太担心安全性，请选择快速和小型。如果您需要数十亿美元的联邦救助协议的数字签名，并且需要确保它们不是伪造的，那么请努力欺骗和放慢速度。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-29T02:53:54.253

我想插话（在 md5 被撕裂之前）我仍然广泛使用 md5，尽管它对于很多加密货币来说是压倒性的破坏。

只要您不关心防止碰撞（您仍然可以安全地在 hmac 中使用 md5）并且您确实想要速度（有时您想要更慢的哈希），那么您仍然可以自信地使用 md5。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T02:54:47.713

我不是这类事情的专家，但我跟上安全社区的步伐，那里的很多人认为 md5 哈希已损坏。我会说使用哪一个取决于数据的敏感程度和特定的应用程序。只要密钥良好且强大，您就可以摆脱安全性稍差的哈希值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T02:57:41.013

以下是我给你的建议：

1.  如果您预期攻击，您可能应该忘记 MD5。网上有很多[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)，众所周知，像 RIAA 这样的公司能够生成具有等效哈希的序列。
2.  如果可以，请使用[盐。](http://en.wikipedia.org/wiki/Salt_(cryptography))在消息中包含消息长度会使产生有用的哈希冲突变得非常困难。
3.  作为一般经验法则，更多位意味着更少的冲突（根据鸽巢原理）并且更慢，并且可能更安全（除非您是可以发现漏洞的数学天才）。

请参阅此处查看论文，该论文详细介绍了使用台式 Intel P4 计算机在 31 秒内创建 md5 冲突的算法。

[http://eprint.iacr.org/2006/105](http://eprint.iacr.org/2006/105)

# .net - 从 VB.NET 文本中的数字中删除空格

> ID：800692
> 
> 赞同：1
> 
> 时间：2009-04-29T02:50:48.767
> 
> 标签：.net, vb.net

我有这种格式的文字

> "term: 156^^^:^^59 datainput" 或 "term: 156^^^:59 datainput" 或 "term: 156:^^^59"

“^”代表空白。注意两个数字和冒号之间的空格。两个数字之间有 2、3、4 甚至 7 个空格。我想删除这些空白，以便文本可以采用这种格式：

> > “术语：156:59 数据输入”

这两个数字之间不再有空格-> 156:56。我只想删除数字和冒号之间的空格。

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T03:12:34.190

尝试以下

```
Dim result = Regex.Replace(input, "(\d)\s*:\s*(\d)", "$1:$2") 
```

这使用正则表达式来匹配数字和冒号之间的空格。像这样的任何模式都将被最后一个参数替换。$1 和 $2 是转义序列，表示“用第一个和第二个括号匹配的文本替换”。在这种情况下，它将是一个数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T03:16:09.847

我认为正则表达式将有助于处理不同数量的空白字符。

```
 Dim text As String = "term: 156      :     59 datainput "
    text = Regex.Replace(text, "([0-9])\s*:\s*([0-9])", "$1:$2", RegexOptions.Singleline) 
```

# javascript - IE8 中的 clientWidth 性能

> ID：800693
> 
> 赞同：6
> 
> 时间：2009-04-29T02:51:26.147
> 
> 标签：javascript, internet-explorer-8

我有一些遗留的 javascript 可以冻结表格的 tfoot/thead 并让正文滚动，它工作正常，除了在 IE8 中它非常慢。

我将问题追溯到读取tfoot / thead中单元格的clientWidth属性......在ie6 / 7和FireFox 1.5-3中读取clientWidth属性大约需要3ms......在IE8中它需要超过200ms和更长的时间表格中的单元格数量增加了。

这是一个已知的错误 ？有什么解决方法或解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-23T20:25:36.540

如果您仍然感兴趣，我已经解决了这个问题。解决方案相当复杂。基本上，您需要将一个简单的 HTC 附加到元素并缓存其 clientWidth/Height。

简单的 HTC 看起来像这样：

```
<component lightweight="true">
<script>
window.clientWidth2[uniqueID]=clientWidth;
window.clientHeight2[uniqueID]=clientHeight;
</script>
</component> 
```

您需要使用 CSS 附加 HTC：

```
.my-table td {behavior: url(simple.htc);} 
```

请记住，您只需要附加 IE8 的行为！

然后，您使用一些 JavaScript 为缓存的值创建 getter：

```
var WIDTH = "clientWidth",
    HEIGHT = "clientHeight";

if (8 == document.documentMode) {

  window.clientWidth2 = {};
  Object.defineProperty(Element.prototype, "clientWidth2", {
    get: function() {
      return window.clientWidth2[this.uniqueID] || this.clientWidth;
    }
  });

  window.clientHeight2 = {};
  Object.defineProperty(Element.prototype, "clientHeight2", {
    get: function() {
      return window.clientHeight2[this.uniqueID] || this.clientHeight;
    }
  });

  WIDTH = "clientWidth2";
  HEIGHT = "clientHeight2";
} 
```

请注意，我创建了常量 WIDTH/HEIGHT。您应该使用这些来获取元素的宽度/高度：

```
var width = element[WIDTH]; 
```

这很复杂，但它有效。我和你有同样的问题，访问 clientWidth 非常慢。这很好地解决了这个问题。它仍然没有IE7那么快，但它又恢复了可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T22:58:45.057

我找不到任何文档证明这是一个已知错误。为了提高性能，为什么不缓存 clientWidth 属性并定期更新缓存呢？IE 如果你的代码是：

```
var someValue = someElement.clientWidth + somethingElse; 
```

将其更改为：

```
// Note the following 3 lines use prototype
// To do this without prototype, create the function,
// create a closure out of it, and have the function
// repeatedly call itself using setTimeout() with a timeout of 1000
// milliseconds (or more/less depending on performance you need)
var updateCache = function() {
   this. clientWidthCache = $('someElement').clientWidth;
};
new PeriodicalExecuter(updateCache.bind(this),1);

var someValue = this.clientWidthCache + somethingElse 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T15:33:25.983

IE 8 具有在 IE 版本之间切换的能力，并且还有一个兼容模式。您是否尝试过切换到兼容模式？这有什么区别吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-20T15:51:40.777

您的问题可能与其他问题有关（不仅是 clientwidth 调用）：在调用此函数时，您是否在 DOM 中更新/调整大小？

您的浏览器可能正[忙于](http://code.google.com/intl/fr/speed/articles/reflow.html)在 IE8 上进行重排，从而使客户端宽度变慢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-08T00:33:45.580

我虽然在读取宽度属性时也注意到性能很慢。很可能会有。

然而，我发现对我们应用程序性能的主要影响是附加到窗口的 on resize 事件的函数本身以某种方式导致了另一个导致级联效应的调整大小，尽管不是无限循环。当我看到函数的调用计数在 IE8 中比在 IE7 中大几个数量级时，我意识到了这一点（喜欢 IE 开发工具）。我认为原因是元素上的某些活动，比如设置元素宽度，现在会导致 IE8 中的重排，而在 IE7 中没有这样做。

我通过将窗口的调整大小事件设置为：resize="return myfunction();" 来修复它 而不仅仅是 resize="myfunction();" 并确保 myfunction 返回 false；

我意识到最初的问题已经存在几个月了，但我想我会发布我的发现，以防其他人受益。

# java - 如何在 Eclipse 中重新启动 Google App Engine Java 服务器？

> ID：800701
> 
> 赞同：25
> 
> 时间：2009-04-29T02:55:59.067
> 
> 标签：java, eclipse, google-app-engine

好的，也许我是哑巴/盲人，但在文档中它说“重建并重新启动服务器”。但是我在任何地方都看不到执行此操作的按钮。或从任何上下文菜单。而且我在他们的文档中找不到任何解释如何做的东西。如果我只是尝试再次启动应用程序，它会生气，因为我已经在所需的端口上运行了 App Engine。

我发现的唯一解决方案是重新启动 Eclipse ......还有其他想法吗？如果可能，按钮的屏幕截图会有所帮助。:)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-29T03:00:13.380

在 Eclipse 中，有一个包含您的控制台的视图。如果单击它，您将看到正在运行的应用程序的 STDOUT 和 STDERR 输出。在右上角，应该有一个红色框，它将终止当前正在运行的程序。

![alt t3xt](https://i.stack.imgur.com/NsRpq.png)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-09-04T11:03:46.697

我有一个不同的，可能更有效的解决方案给你。与大多数 Web 开发环境一样，您可能希望更改源代码并让 Google Appengine 服务器为您重新加载新代码。

您需要一些传统的“触摸”unix 命令版本（如果您在 Windows 上工作，您可以从[这里](http://unxutils.sourceforge.net/)下载一个版本）。

然后转到您的项目属性，构建器并添加一个新的构建步骤作为“程序”。在“位置”下输入“触摸”命令的路径（例如“D:\bin\UnxUtils\usr\local\wbin\touch.exe” - 在 Posix 系统上，只需“触摸”就足够了，因为它已经在你的PATH）并在“参数”中输入“${project_loc}/war/WEB-INF/appengine-web.xml”之类的内容。还可以转到“构建选项”选项卡并选中“在自动构建期间”。

“触摸”将更新您 appengine-web.xml 中的时间戳。当 App Engine 服务器检测到您对 appengine-web.xml 的更改时，它将自动重新加载应用程序。加载过程非常快，因此可以在您更改项目中的任何文件时完成（这通常会触发 Eclipse 中的自动构建） - 您可以调整构建器以仅在您更改某些类型的文件时运行。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-30T02:32:20.270

我可能会补充一点，“小红框”并不总是可见的。它让我疯狂地阅读相同的指令，但没有看到终止按钮，直到我发现控制台窗口具有“层”，您可以使用控制台视图控件最右侧的下拉按钮进行选择。您只需要“返回”到显示服务器正在运行的控制台屏幕，您就会看到红色的小终止按钮。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-07-07T07:21:26.807

之前的答案不是为我切奶酪。首次启动 App Engine 时，文本输入区域上方会出现红色方块。如果我然后再次单击运行按钮，则红色方块将消失，并且先前启动的控制台将被新启动的控制台替换。要手动停止 App Engine 服务器，您可以从终端终止它：http: [//geekbrigade.wordpress.com/2009/02/26/how-to-find-and-kill-a-process-that-is- using-a-particular-port-in-ubuntu/](http://geekbrigade.wordpress.com/2009/02/26/how-to-find-and-kill-a-process-that-is-using-a-particular-port-in-ubuntu/) 简而言之，“sudo netstat -lpn |grep :8888”并通过进程 ID 终止服务。

奇怪的是，将 Google Web Toolkit 添加到项目中后，我的 App Engine 启动显示在 Development Mode 窗格中，很容易被杀死或重新启动。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-12T09:40:14.927

只需点击 Debug 透视图（应该在右上角），在 Debug 面板上选择 Web 应用程序的实例（如果你不显示它，你可以通过菜单 Window->show view->Debug 启用）并点击红色视图菜单框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-06T05:34:04.687

我发现最好的方法是为控制台的终止按钮和运行/调试启动/重新启动命令设置键盘快捷键。默认情况下，您可以启用 Command-F2 终止，并启用 Command-F11 重新启动，它相当轻松。确保启用完整的调试菜单组（单击主工具栏 -> 自定义等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-28T21:56:35.940

如果您在项目中包含 gwt SDK，则 gwt 开发模式框包含一个重新加载服务器按钮，该按钮可以正常工作。

# html - 如何让选择/下拉列表中的外来字符在 IE 7 中正确显示？

> ID：800707
> 
> 赞同：2
> 
> 时间：2009-04-29T02:58:19.360
> 
> 标签：html, internet-explorer-7, character-encoding

我已经在 IE6、Firefox 3.0.5 和 Chrome 中进行了测试，它们都可以正常工作。在 IE7 中，它显示为框。

例如：

```
<select name="selectact" id="selectact">
<option value="page" selected="selected">网 页&lt;/option> 
<option value="news">新 闻&lt;/option> 
<option value="trade">行 业&lt;/option> 
<option value="area">区 域&lt;/option> 
<option value="web">网 站&lt;/option> 
<option value="image">图 片&lt;/option> 
<option value="mp3">MP3</option> 
<option value="flash">Flash</option> 
<option value="bbs">论坛</option> 
</select> 
```

**注意：字符在页面上显示正常，只是在下拉菜单中没有**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T03:04:49.937

您是否尝试[验证](http://validator.w3.org/)页面？除其他外，这将验证您是否指定了字符编码以及仅在该编码中有效的字节序列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T03:10:44.070

您需要指定正确的[字符编码](http://www.w3.org/TR/html4/charset.html#spec-char-encoding)。假设这是中文文本，您将在文档的头部插入以下元标记：

```
<META http-equiv="Content-Type" content="text/html; charset=iso-2022-cn"> 
```

可在[此处](http://www.iana.org/assignments/character-sets)找到完整的字符集列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-20T10:54:36.140

这将起作用：

```
<select name="selectact" id="selectact" style="font-family: Arial Unicode MS;">
    <option value="page" selected="selected">网 页&lt;/option>
    <option value="news">新 闻&lt;/option>
    <option value="trade">行 业&lt;/option>
    <option value="area">区 域&lt;/option>
    <option value="web">网 站&lt;/option>
    <option value="image">图 片&lt;/option>
    <option value="mp3">MP3</option>
    <option value="flash">Flash</option>
    <option value="bbs">论坛</option> 
</select> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-24T15:01:29.103

这是 IE7 版本 v7.0.5730.13 和更高版本的 IE7 中的错误。IE6和8都可以。据报道，即使是 IE7 版本 7.0.5730.11 也可以。浏览器不会为某些日语字符范围选择 Unicode 字体。我发现的唯一解决方法是强制下拉到支持 Unicode 的字体：

字体系列：Arial Unicode MS、Arial

# c - 使用 execl 执行守护进程

> ID：800712
> 
> 赞同：2
> 
> 时间：2009-04-29T03:00:18.603
> 
> 标签：c, linux, daemon

我正在 Linux 上用 C 语言编写一个程序，其中包括一个允许在远程机器上执行 shell 命令的模块。实际执行命令的最简单方法当然是简单地使用 system() 函数，或者使用 popen 然后获取输出。但是，由于与当前问题无关的其他设计要求，我选择使用更底层的方法。

所以基本上，我建立了一个管道和分叉，然后调用 execl。这一切都很完美，除了一个恼人的例外。如果要执行的 shell 命令是一个守护进程，它就不能正常工作。在这种情况下，它只是挂起。我不知道为什么。我的理解是，当守护进程启动时，它通常会分叉，然后父进程退出。由于我的应用程序有一个到父级的开放管道，因此当父级退出时，对 read() 的调用应该会失败。但相反，应用程序只是挂起。

这是一些重现问题的基本代码：

```
 int main(int argc, char** argv)
{
        // Create a pipe and fork
        //
        int fd[2];
        int p = pipe(fd);
        pid_t pid = fork();

```
 if (pid > 0)
    {
            // Read from the pipe and output the result
            //
            close(fd[1]);
            char buf[1024] = { 0 };
            read(fd[0], buf, sizeof(buf));
            printf("%s\n", buf);

            // Wait for child to terminate
            int status;
            wait(&status);
    }
    else if (pid == 0)
    {
            // Redirect stdout and stderr to the pipe and execute the shell
            // command
            //
            dup2(fd[1], STDOUT_FILENO);
            dup2(fd[1], STDERR_FILENO);
            close(fd[0]);
            execl("/bin/sh", "sh", "-c", argv[1], 0);
    } 
```

} 
```

如果您将其与普通的 shell 命令一起使用，则该代码可以正常工作。但是，如果您尝试运行守护程序，它只会挂起，而不是按应有的方式返回到提示符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T23:45:37.137

最可能的解决方案是`close(fd[1]);`在 execl() 之上添加。

您的程序挂起的原因是 read() 函数等待守护进程向其 stdout/stderr 写入内容。如果守护进程（包括您的程序的子进程，以及保留其 stdout/stderr 的子进程的分叉子进程）没有写入任何内容，并且至少有一个进程保持管道的可写端处于打开状态，则读取（ ) 永远不会回来。但是哪个进程使管道的可写端保持打开状态？它很可能是您的程序子进程的子进程，即长期运行的守护进程。虽然它可能已经调用了`close(0);`并且`close(1);`在守护自己时，很可能它还没有调用`close(fd[1]);`，所以管道的可写端仍然是打开的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T06:49:37.460

我认为您应该在等待读取完成时收到 SIGPIPE 信号，因为管道的另一端已关闭。你对信号做了什么不寻常的事情吗？我建议您使用 strace 命令运行您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T03:42:51.123

您的问题可能在这里：-

// 等待子进程终止 int 状态；等待（&状态）；

由于子进程是一个守护进程，它不会很快终止。

此外，您的“read()”可能会挂起。在放弃任何显示输出的尝试之前，您将不得不决定等待多长时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T03:52:20.430

> > 由于子进程是一个守护进程，它不会很快终止。

你确定吗？当然，我同意守护进程不会很快终止——但是当守护进程启动时，它会分叉，这样子进程就可以将自己与终端分离，然后父进程退出。由于 wait() 系统调用正在等待父守护进程，它应该退出。

无论如何，如果没有调用 wait()，也会出现同样的问题。

另外，为什么 read() 没有得到 EOF？read() 正在从与父守护进程连接的开放管道中读取。因此，当父守护进程退出时，read() 应该立即返回一个 EOF。

# windows - 在 Windows XP 中使用批处理文件修改电源方案

> ID：800713
> 
> 赞同：0
> 
> 时间：2009-04-29T03:01:38.617
> 
> 标签：windows, batch-file, controlpanel

我正在尝试编写两个批处理文件，它们允许我将电源方案（控制面板-> 电源选项-> 电源方案选项卡）从家庭/办公桌切换到便携式/笔记本电脑并返回。我的操作系统是 Windows XP SP3。

我这样做的原因是因为我想在我的笔记本电脑上玩游戏时禁用 SpeedStep（即把它放在家庭/办公桌方案上），否则启用 SpeedStep（回到便携式/笔记本电脑）。Windows XP在家庭/办公桌模式下[关闭动态切换。](http://en.wikipedia.org/wiki/SpeedStep#Operating_system_support)我希望能够以编程方式执行此操作，以在每次我想玩游戏时为自己节省一些时间。

关于如何使用简单的批处理文件修改电源设置的任何想法？Python 和 Ruby 脚本也是一种选择，但不是首选。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T03:13:33.470

C:>%windir%\system32\powercfg.exe /?

```
 /SETACTIVE, /S  Makes the power scheme with the specified name active.
Examples:
    POWERCFG /SETACTIVE scheme 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-12T17:28:09.607

```
@echo off
setlocal EnableDelayedExpansion

echo Available power schemes:
echo/

set i=0
set "options="
for /F "tokens=2,3 delims=:()" %%a in ('powercfg /L') do if "%%b" neq "" (
   set /A i+=1
   set "options=!options!!i!"
   echo !i!. %%b
   set "scheme[!i!]=%%a"
)

echo/
choice /C %options% /N /M "Select desired scheme: "
powercfg /S !scheme[%errorlevel%]!
echo/
echo Power scheme set 
```

也许您需要调整`"tokens=2,3 delims=:()"`FOR 选项；此代码是为 Windows 8.1 西班牙语版本编写的。

# excel - 如何对 Excel 进行编程以使用 Outlook？

> ID：800714
> 
> 赞同：1
> 
> 时间：2009-04-29T03:02:01.767
> 
> 标签：excel, api, outlook

我有一个相当大的 Excel 文件。在这个文件中有一个日期列。我想知道是否/如何制作一个能够读取日期并提前 30 天向 Outlook 日历发布通知或通过我办公室的 Outlook 发送电子邮件的程序。有没有我可以用来做这个的像样的 API？如果是这样，我在哪里可以找到一个？或者，是否有任何现有的程序能够实现此功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T04:31:34.970

您应该能够编写与 Outlook 交互的 Excel VBA 脚本。请参阅[http://www.dicks-clicks.com/excel/olAutomating.htm](http://www.dicks-clicks.com/excel/olAutomating.htm)以获得这方面的良好指南。具体[http://www.dicks-clicks.com/excel/olCalendar.htm#Creating_an_Appointment](http://www.dicks-clicks.com/excel/olCalendar.htm#Creating_an_Appointment)提到了如何创建日历项目。请注意，大多数示例适用于 Outlook/Excel 2000，我想大多数示例仍应适用于较新版本，但某些对象可能会被重命名。

[Outlook Code](http://outlookcode.com/)是另一个很好的站点，其中包含一般用于 Outlook 集成的代码示例。例如。[http://outlookcode.com/article.aspx?id=49](http://outlookcode.com/article.aspx?id=49)

当然，您不必在 Excel 中编写所有代码，您应该能够轻松地在自定义应用程序（例如 .NET 应用程序）中执行相同的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T04:30:59.260

您可以在打开 Excel 工作表时运行宏来检查和更新日历并发送电子邮件。

这是一个关于如何通过 Outlook frommexcel 发送电子邮件的[示例。](http://www.tek-tips.com/faqs.cfm?fid=3564)但问题是 Outlook 会向我们显示一个安全弹出窗口，说明 Excel 正在尝试使用 Outlook 发送电子邮件以及您是否要允许它。

这是另一个[示例](http://www.everythingaccess.com/tutorials.asp?ID=Outlook-Send-E-mail-Without-Security-Warning)，它显示了如何覆盖此安全警告。

如果您有兴趣，这个 thred 有一个关于如何使用邮件服务器发送电子邮件的[示例（没有尝试过）。](http://www.astahost.com/info.php/how-send-email-using-vb-using-smtp_t5431.html)

这是一个关于如何将事件添加到 Outlook 日历的[示例。](http://www.outlookcode.com/codedetail.aspx?id=1436)希望这可以帮助。

# javascript - 在 JavaScript 中重新排列表格

> ID：800715
> 
> 赞同：8
> 
> 时间：2009-04-29T03:03:42.433
> 
> 标签：javascript

我想使用 JavaScript 重新排序表行。

例如下面的虚拟表：

```
<table>
  <tr>
    <td>1</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
  </tr>
  <tr>
    <td>A</td>
    <td>B</td>
    <td>C</td>
    <td>D</td>
  </tr>
  <tr>
    <td>A1</td>
    <td>B1</td>
    <td>C1</td>
    <td>D1</td>
  </tr>
</table> 
```

我想在不使用 jQuery 的情况下在 JavaScript 中执行此操作。我想显示 A1,B1,C1,D1.. 行作为第一行，然后是 1,2,3,4 行，然后是 A,B,C,D 行。

我知道客户端会有一些等待时间，但我需要在客户端进行。对于任意数量的行，是否有一些通用的解决方案可以做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-29T03:09:49.237

如果我理解正确，您是在问如何占据最后一排并使其成为第一排，然后将其余部分向下推。这应该这样做：

```
<table id="mytable">
...
</table>

<script type="text/javascript">
    var tbl = document.getElementById('mytable');
    var rows = tbl.getElementsByTagName('tr');
    var firstRow = rows[0];
    var lastRow = rows[rows.length];
    firstRow.parentNode.insertBefore(lastRow.parentNode.removeChild(lastRow), firstRow);
</script> 
```

假设您的表没有嵌套表。在这一点上，这需要更聪明一点。这也假设您没有使用 TBODY 和 THEAD 节点。但我相信你可以从那里得到这个想法并加强它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T04:13:35.963

做：

```
var table = ...; // Get reference to table (by ID or other means)
var lastRow = table.rows[table.rows.length - 1];
lastRow.parent.insertBefore(table.rows[0], lastRow); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T16:13:23.947

在 Javascript 中解决此问题的最佳方法是：

给 Tr.. 一个唯一的名称。例如：X_Y,X_Z,A_Y,A_Z

现在添加一个隐藏的标签或文本框，它给出了服务器的排序顺序，即当页面呈现时，我想对其进行排序，ID 以 A 开头的所有 Tr 应该排在第一位，所有 Z 应该排在第二位。

```
<asp:label id="lblFirstSortOrder" runat="server" style="display:none;">A,X</label>
<asp:label id="lblSecondSortOrder" runat="server" style="display:none;">Z,Y</label> 
```

当页面呈现时..顺序应该是 A_Z,A_Y,X_Z,X_Y

在渲染之前，这是来自 aspx 文件的表：

```
<table>
<tr id='Tr_Heading'>
  <td>A</td>
  <td>B</td>
</tr>
<tr id="Tr_X_Y">
  <td>GH</td>
  <td>GH1</td>
</tr>
<tr id="tr_X_Z">
  <td>HU</td>
  <td>HU1</td>
</tr>
<tr id="tr_A_Z">
  <td>JI</td>
  <td>JI1</td>
</tr>
<tr id="tr_A_Y">
  <td>JI</td>
  <td>JI1</td>
</tr> 
```

脚本：

```
function SortAndArrange()
{
var firstList = document.getElementById('lblFirstSortOrder').value;
var secondList = document.getElementById('lblSecondSortOrder').value;
var firstTypes = new Array();
firstTypes = firstList.split(',');
var secondLists = new Array();
secondLists = secondList.split(',');
var refNode = document.getElementById('Tbl_' + firstTypes[0] + "_" + secondTypes[0]);
for (var i = 0; i<firstTypes.length; i++)
{
  for (var j = 0; j< secondTypes.length;j++)
  {
     var TrName = 'Tbl_'+firstTypes[i]+'_'+secondTypes[j];
     var FirstSecondTrs = document.getElementById(TrName);
     if (FirstSecondTrs)
     {
       FirstSecondTrs.parentNode.removeChild(FirstSecondTrs);        
       insertAfter(refNode,FirstSecondTrs);
       refNode = FirstSecondTrs;
     }
  }
 }
}
function insertAfter( referenceNode, newNode )
{   
 referenceNode.parentNode.insertBefore( newNode, referenceNode.nextSibling );
} 
```

我希望你们明白……对我来说，排序顺序总是来自服务器，而不是来自页面的用户……

非常感谢所有的答案.. 欣赏它。帮助我找到了这个解决方案。

谢谢，本

# c# - 动态选择 Asp.Net MVC 用户控件

> ID：800718
> 
> 赞同：1
> 
> 时间：2009-04-29T03:05:28.420
> 
> 标签：c#, asp.net-mvc, asmx

我目前正在处理的 ASP.net 页面有一个下拉列表，旨在包含一个过滤器列表。当用户选择过滤器时，我想显示一个具有适合过滤器属性的用户控件。

这是有问题的控制器操作：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(FormCollection collection)
{
  var filterType =  Request.Form["FilterSelect"];
  ViewData["FilterChosen"] = filterType;
  PopulateSelectionFiltersData();//This method fills up the drop down list
  //Here is where I would like to switch based on the filterType variable
  return View();
} 
```

过滤器类型变量具有正确的值，但我不确定如何做下一部分。

此外，作为一个必然的问题，在调用之间保持所选下拉值的最佳方法是什么？

非常感谢，

凯夫狗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T03:14:52.250

存储要在 ViewData 中显示的正确控件。至于持久化菜单，您可以选择 Cache（由许多会话使用）、Session（仅由本会话使用）或 TempData（仅用于本会话中的下一个方法）。或者，您可以将其缓存在 DataLayer 中。通常，我只是重新获取数据，直到它成为性能问题——它通常不会。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(FormCollection collection)
{
  var filterType =  Request.Form["FilterSelect"];
  ViewData["FilterChosen"] = filterType;
  PopulateSelectionFiltersData();//This method fills up the drop down list

  string userControl = "DefaultControl";
  switch (filterType)
  {
      case "TypeA":
         userControl = "TypeAControl";
         break;
      ...
  }

  ViewData["SelectedControl"] = userControl; 
  return View();
}

 <% Html.RenderPartial( ViewData["SelectedControl"], Model, ViewData ); %> 
```

# latex - 同上。在 LaTeX 引用中

> ID：800722
> 
> 赞同：13
> 
> 时间：2009-04-29T03:07:35.687
> 
> 标签：latex

如何让 LaTeX 自动使用“同上”。当对同一来源进行两次引用时？

```
Here is a sentence with a citation.\footnote{\cite[p.~5]{Smith:1999}}
This sentence also has a citation.\footnote{\cite[p.~10]{Smith:1999}} 
```

期望：
这是一个带有引用的句子。[1] 这句话也有引用。[2]
...
1\. 史密斯 (1999), p。5
2\. 同上，p. 10

实际：
这是一个带有引用的句子。[1] 这句话也有引用。[2]
...
1\. 史密斯 (1999), p。5
2\. 史密斯 (1999), p。10

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T04:13:36.027

你可以看看 biblatex，它似乎比 bibtex 更倾向于人文风格的引文。我很确定我“同上”在其中工作没有任何问题。

[http://www.ctan.org/pkg/biblatex](http://www.ctan.org/pkg/biblatex)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-22T07:00:08.517

对我有用的一种解决方案是使用以下内容：

```
\usepackage{csquotes}
\usepackage[backend=biber, style=verbose-ibid]{biblatex} 
```

我的示例中的样式会让第一次引用非常冗长，然后只引用作者、标题和页码。

同上还有更多款式，可以在[这个网站](http://www.sharelatex.com/learn/Biblatex_citation_styles)上找到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T07:57:24.770

另一种可能性是[inlinebib](https://www.ctan.org/pkg/inlinebib)。

# java - 为一个 servlet 配置 web.xml (Tomcat 5) 以处理所有传入请求？

> ID：800725
> 
> 赞同：5
> 
> 时间：2009-04-29T03:09:20.830
> 
> 标签：java, tomcat, servlets, web.xml

基本上我想要一个 servlet 来处理所有传入的请求，而不管路径如何。我在共享托管环境中，可以配置我自己的 web.xml 文件。

我在 web.xml 中配置了以下内容，但它不适用于 Tomcat 5：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.4" 
    xmlns="http://java.sun.com/xml/ns/j2ee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation=
        "http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">  
    <display-name>Redirect</display-name>
    <servlet>
         <display-name>Redirect</display-name>
         <servlet-name>Redirect</servlet-name>
         <servlet-class>com.Redirect</servlet-class>
         <init-param>
            <param-name>host</param-name>
            <param-value>www.myredirectdomain.com</param-value>
        </init-param>
        <init-param>
            <param-name>redirect-type</param-name>
            <param-value>301</param-value>
        </init-param>
    </servlet>
    <servlet-mapping>
        <servlet-name>Redirect</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
</web-app> 
```

以上适用于以路径中的目录开头的任何内容，例如：

```
www.mydomain.com/anypath1/anypath2...
www.mydomain.com/anypath1 
```

但是，不适用于：

```
www.mydomain.com/ or
www.mydomain.com 
```

我还尝试了以下 servlet 映射：

```
<servlet-mapping>
    <servlet-name>Redirect</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

结果相同。都没有工作......有人有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T20:52:08.287

Tomcat 5 实现了 Servlet 2.4 规范。可以在这里下载： [JCP Servlet 2.4 Spec](http://jcp.org/aboutJava/communityprocess/final/jsr154/index.html)

在第 页。86 - SRV.11.2 它描述了如何指定 Servlet 映射。如果我理解您正在尝试正确执行的操作，那么您正在尝试使用单个 Servlet 拦截到您的服务器的每个请求（无论路径如何）。为此，您的 webapp 需要在 Tomcat 的情况下安装在默认上下文（“ROOT”）中，并且您的 Servlet 需要映射到 web.xml 中的默认 servlet。您在 web.xml 中的映射是正确的。

```
<servlet-mapping>
    <servlet-name>Redirect</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

我认为您遇到的问题与 ROOT 上下文有关。访问 www.mydomain.com/ 和 www.mydomain.com 会显示什么？你没有提到你的共享主机环境是否让你可以完全访问你自己的 Tomcat 配置，但是如果你可以访问和修改你的 $TOMCAT5_HOME/conf 目录，那么有几种方法可以为你工作。

可能最干净的方法是添加以下内容：

```
< Context path="" debug="0" docBase="your-app"> 
```

到 $TOMCAT5_HOME/conf/server.xml。这假设您的应用程序名为“your-app.war”。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T16:43:10.837

`<url-pattern>/*</url-pattern>`应该管用。您的 webapp 需要部署在根上下文中。默认情况下，tomcat 使用名为 ROOT 的 webapp；但是，您可以将其更改为在 server.xml 中查找另一个 webapp。

另一种方法是创建一个 ServletFilter 来完成这项工作并以相同的方式映射它。每种方法（servlet 和 servlet 过滤器）各有利弊。但是，从您的示例来看，您似乎只想将所有内容发送到另一个站点，因此任何一个都应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T04:15:13.463

Pattern /* 将明确调用您的 Redirect servlet。您是否调试过您的 servlet 以查看它是否收到了对该 url 的请求？你的意思是没有工作？你有没有得到任何错误或发生了什么？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-29T04:09:36.583

你试过了吗

```
<url-pattern>*</url-pattern> 
```

?

# c++ - C/C++ 如何判断一个程序是否已经在运行？

> ID：800730
> 
> 赞同：5
> 
> 时间：2009-04-29T03:10:53.383
> 
> 标签：c++, c, windows, systems-programming

在 Windows 环境中，我不希望我的程序的两个实例同时运行。

> ### 有关的
> 
> [是否使用互斥锁来防止同一程序的多个实例安全运行？](https://stackoverflow.com/questions/646480/is-using-a-mutex-to-prevent-multipule-instances-of-the-same-program-from-running)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-05T21:28:04.620

如果是你的程序，那么在 windows 下可能的最短版本：

```
int main(int argc, char** argv)
{
    CreateMutexA(0, FALSE, "Local\\$myprogram$"); // try to create a named mutex
    if(GetLastError() == ERROR_ALREADY_EXISTS) // did the mutex already exist?
        return -1; // quit; mutex is released automatically

    // ... program code ...
} 
```

无需变得疯狂复杂，如果您只需要一个简单的检查...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T03:24:31.260

我认为您需要在继续之前考虑一下您的情况。不止一次“运行同一个程序”有很多不同的解释。比如你

1.  每台机器一次
2.  每个登录会话一次
3.  每个用户一次

所有这些都有不同但相似的解决方案。

最容易描述的是每台机器。在这种情况下，您要创建一个命名的 Mutex。每次启动时，每个程序都必须获得此互斥锁，如果它们成功，它们会在进程生命周期内运行并持有互斥锁。否则，其他一些程序正在运行，它们会立即退出。

不幸的是，这种方法也有其缺点。如果我想弄乱你的程序，我可以创建一个同名的互斥锁。这将阻止您的程序运行任何实例，因为它们无法分辨谁持有互斥锁，只是有东西持有互斥锁。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-29T03:18:03.447

您可以在应用程序的第一个实例启动时创建互斥锁。为了防止第二个实例，您需要做的就是检查是否正在使用互斥锁。

[实际上，这里](https://stackoverflow.com/questions/646480/is-using-a-mutex-to-prevent-multipule-instances-of-the-same-program-from-running)有一个关于为此目的使用互斥锁的问题，请查看 JaredPar 的答案。

注意：如果您希望“一个实例”仅应用于用户会话（而不是所有用户），则可以使用本地互斥锁

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T03:18:46.470

最好的方法是使用互斥锁。请参阅[使用互斥对象](http://msdn.microsoft.com/en-us/library/ms686927(VS.85).aspx)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T07:36:33.417

另一种简单的解决方案是创建一个适当唯一的全局命名事件（可能是 GUID 字符串），然后在启动时检查它是否存在。如果它存在，那么您的应用程序的一个实例已经启动。如果没有，您已经自动创建了事件并可以继续运行，例如：

```
// for brevity, a complete set of error handling has been omitted

m_hEvent = CreateEvent(NULL, TRUE, FALSE, szMyUniqueNamedEvent);

switch (GetLastError)
{
    // app is already running
    case ERROR_ALREADY_EXISTS:
    {
        CloseHandle(m_hEvent);

        // now exit
        break;
    }

    // this is the first instance of the app
    case ERROR_SUCCESS:
    {
        // global event created and new instance of app is running,
        // continue on, don't forget to clean up m_hEvent on exit
        break;
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T04:39:05.357

这是我使用[boost.interrprocess](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess.html)编写的一个类，我用它在 GUI 和 CLI 版本之间同步。

您可能会发现它很有用：

```
#pragma once

#include <boost/interprocess/windows_shared_memory.hpp>
#include <boost/interprocess/mapped_region.hpp>

#ifndef max
#define max(a,b)            (((a) > (b)) ? (a) : (b))
#endif

using boost::interprocess::windows_shared_memory;
using boost::interprocess::mapped_region;
using boost::interprocess::open_or_create;
using boost::interprocess::read_write;
using boost::interprocess::interprocess_exception;

class CProcessMutex
{

public:
    CProcessMutex()
        : m_region()
        , m_status(false)
    {
        initSharedMemory();
        Increment();
    }

    ~CProcessMutex()
    {
        Decrease();
    }

public:
    int GetCount()
    {
        return m_status ? *(static_cast<unsigned char*>(m_region.get_address())) : 0;
    }

private:
    void initSharedMemory()
    {
        try
        {
            //Create a native windows shared memory object.
            windows_shared_memory shm (open_or_create, "shared_memory", read_write, 1);
            //Map the whole shared memory in this process
            m_region.swap(mapped_region(shm, read_write));
            m_status = true;
        }
        catch(interprocess_exception &ex)
        {
            ex.what();
            m_status = false;
        }
    }

    void Increment()
    {
        if(m_status) (*(static_cast<unsigned char*>(m_region.get_address())))++;
    }
    void Decrease()
    {
        if(m_status) (*(static_cast<unsigned char*>(m_region.get_address())))--;
    }
private:
    mapped_region m_region;
    bool m_status;
}; 
```

用法很简单：

```
CProcessMutex pm;
size_t current_process_count = pm.GetCount();
if(current_process_count > 1)
{
 ...
} 
```

因此您可以轻松限制并行进程的数量。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-29T11:47:19.603

当您使用 Qt 时，您可以下载[QtSingleApplication](http://www.qtsoftware.com/products/appdev/add-on-products/catalog/4/Utilities/qtsingleapplication/)组件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-29T03:45:03.630

正如其他人所建议的那样，使用互斥锁。

MS 的CreateMutex [() 文档](http://msdn.microsoft.com/en-us/library/ms682411(VS.85).aspx)有很多有用的信息，并专门解决了使用互斥锁来防止多个程序实例运行的情况。尤其是：

*   调用`CreateMutex()`，`bInitialOwner = FALSE`然后调用等待函数（例如`WaitForSingleObject()`）以确保只有一个实例获取互斥锁。
*   如果您担心拒绝服务攻击，请考虑使用锁定文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T03:52:06.657

在你的程序启动时，你可以[枚举你机器上运行的进程](http://msdn.microsoft.com/en-us/library/ms682629.aspx)

然后如果你看到你已经在运行，退出

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-29T03:15:29.643

您可以检查窗口类是否已注册。看看[这个](http://msdn.microsoft.com/en-us/library/ms633587(VS.85).aspx)MSDN 条目。

# java - Java 通用问题：有更好的方法吗？

> ID：800731
> 
> 赞同：1
> 
> 时间：2009-04-29T03:11:58.217
> 
> 标签：java, generics

[更新]：我最初的例子没有反映我的问题。更新了示例，希望现在更好。

Java 泛型和重载不能很好地结合在一起。

```
public interface Request<E> {
  E getValue();
} 
```

如上所述，我有一个通用的参数化请求接口，我想编写一个 DataStore 类来保存有效负载请求携带。不同有效载荷类型的保存逻辑不同。

我真正想要的是

```
public interface DataStore {
  void save(Request<E1> r);
  void save(Request<E2> r);
} 
```

但这当然是非法的。

如果我想保持类型安全，DataStore 必须为我要处理的每种类型声明不同的方法，例如

```
public interface DataStore {
  // here E1 is the actual type I want to handle, not a generic parameter
  public void saveE1(Request<E1> e); 

  public void saveE2(Request<E2> e);
} 
```

或者牺牲类型安全

```
public class DataStore {
  public void save(Request e) {
    Object value = e.getValue();
    if (value instanceof ReqE1Impl) {
      // do something
    } else if (value instanceof ReqE2Impl) {
      // do something else
    }
  }
} 
```

两种方式都很烂！有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T04:23:49.090

更好的方法是让对象知道如何自救。如果您仍想使用 DataStore，您可以执行以下操作：

```
interface YourInterface {
  void save();
}

interface Request<E extends YourInterface> { 
  E getValue(); 
} 

class DataStore<E extends YourInterface> {
  public void save(Request<E> r) {
    r.getValue().save();
  }
} 
```

你只需要确保你的对象每个都实现它`interface`，中提琴，你有泛型和多态性相互配合。

注意：您（修订后的）问题的编写方式，您没有使用多态性。您正在使用重载。方法重载是在编译时决定的，而方法多态性是在运行时决定的。这就是您遇到这些困难的部分原因。

如果你真的不想要上面那种让对象自己做所有工作的设计，那么也许你可以做这样的事情（作为一个非常弱的例子）：

```
interface YourInterface {
  String serialize();
}

interface Request<E extends YourInterface> { 
  E getValue(); 
} 

class DataStore<E extends YourInterface> {
  public void save(Request<E> r) {
    String value = r.getValue().serialize();
    // Now do something with value to save to a datastore
  }
} 
```

上面是一个弱示例，但主要思想是对象知道如何执行对象之间不同的序列化部分，然后 DataStore 可以执行所有对象共有的工作。

是的，你是对的（使用错误的术语）——泛型不能很好地处理重载。但是它们确实很好地处理了多态性。无论如何，多态性通常是比重载更好的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T03:28:41.547

也许我误解了这个问题，但泛型似乎可以解决这个问题：

```
public interface Handler<E> {
    void save (E obj, DataStore<E> store);
}

public interface DataStore<E> {
    public void save (E obj);
}

public class AHandler implements Handler<String> {
    public void save (String obj, DataStore<String> obj2) {

    }
}

public class BHandler implements Handler<Boolean> {
    public void save (Boolean b1, DataStore<Boolean> obj3) {

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T03:24:50.713

我认为没有其他方法可以实现您尝试使用该设计进行的操作。

在不了解具体`E`类型的情况下，我只能提出以下一般性建议：

*   可能`DataStore`应该只处理特定的子类型`E`？您可以参数化`DataStore`接口以确保类型安全，即每个都`Handler<E>`接受一个`DataStore<E>`.

*   或者，考虑将保存功能移动到您的`E`类型的实现中——这样，`DataStore`就不需要关心`E`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T03:39:22.537

我认为问题不在于泛型，而在于设计。

您所说的是您正在传递 E 的子类的实例，并且本质上需要运行与该特定类对应的特殊处理程序。所以你基本上有两个并行的层次结构。这是一个相当普遍的设计问题。

如果您使用工厂方法创建 Es，那么您应该有一个工厂方法，该方法基于 E 获取适当的 SaveToDatastoreHandler。您将该保护程序传递给该函数，然后它以多态方式调用。

您可能仍然有一个开关，但至少现在您将其隔离为工厂方法。

# c++ - 我的 MFC 套接字代码中的 CAsyncSocket 断言问题和“不正确的参数”错误背后的原因是什么？

> ID：800734
> 
> 赞同：5
> 
> 时间：2009-04-29T03:12:55.890
> 
> 标签：c++, sockets, mfc, casyncsocket

我被要求为朋友查看一些代码。（由于 MFC 和很多糟糕的代码，我犹豫了一下，但他赢了……）

这是一个基于对话框的应用程序，它使用`CAsyncSocket`.

问题体现在一些不间断的调试中断和其他类似的事情上——MFC 宏也存在问题`ENSURE()`——检查套接字是否为空。所有的问题都发生在 MFC 的深处。

如果在 Vista/XP 中使用主题，一些谷歌搜索显示可能存在资源泄漏，但我认为这不是问题所在。

根据我几个小时的调试，代码非常糟糕，但基本上它正在执行以下操作：

（建立连接时没有问题 - 只有没有连接时才会出现这种情况）

*   调用 Connect(server, socket) （在派生`CAsyncSocket`对象上）
*   在`OnConnect()`我们被通知连接不起作用/未连接。
*   在主对话框/应用程序的窗口计时器内有一个计时器。当定时器事件/处理程序被调用时，我们检查是否连接。
*   如果我们检测到我们没有连接（`OnConnect()`不好）然后我们调用`CAsyncSocket::Close()`，然后调用`CAsyncSocket::Create()`（没有参数）然后调用`CAsyncSocket::Connect(server, port)`

请注意，初始调用`Connect()`之前没有调用`Create()`.

### 我的第一个真正的问题：

*   两者有什么区别，为什么`Create()`需要？（如果我删除它，那么它不再崩溃，但是当我重新建立连接时我也没有连接）

### 一般问题：

*   上面的代码设计到底有什么问题？
*   一般来说，这应该如何工作？

### 编辑：

我修复了代码，以便所有路径都通过调用`Create()`then `Connect()`。

我的断言仍然有问题`CAsyncSocket::DoCallBack()`- 下面代码的最后一行是断言：

```
void PASCAL CAsyncSocket::DoCallBack(WPARAM wParam, LPARAM lParam)
{
    if (wParam == 0 && lParam == 0)
        return;

    // Has the socket be closed - lookup in dead handle list
    CAsyncSocket* pSocket = CAsyncSocket::LookupHandle((SOCKET)wParam, TRUE);

    // If yes ignore message
    if (pSocket != NULL)
        return;

    pSocket = CAsyncSocket::LookupHandle((SOCKET)wParam, FALSE);
    if (pSocket == NULL)
    {
        // Must be in the middle of an Accept call
        pSocket = CAsyncSocket::LookupHandle(INVALID_SOCKET, FALSE);
        ENSURE(pSocket != NULL); 
```

如果我逐步完成，那么我会收到消息框：“遇到不正确的论点”

我认为（但不确定）MFC 在我关闭它之后试图回调套接字。它在一个回调方法（`DoCallback()`）中，但我已经调用`Close()`了套接字。

所以它看起来确实像一个 MFC 问题，除非我应该先取消订阅。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T03:32:53.753

你的选择真的。如果您认为使用另一个套接字实现会更幸运，那就去做吧。

但是，微软有很多开发人员（我相信其中一些甚至可能是优秀的）。您可能，只是*可能*，想考虑故障并非全部归咎于他们的可能性。

在我看来，你可以从他们的 API 和产品中获得的帮助也很好。

也许如果您花时间了解 MFC 模型，您会得到那个“AHA”时刻并更好地理解它。我不是 Winsock 的粉丝——我更习惯于 UNIX 世界，其中同步是要走的路，如果你想要异步类型的行为，你只需运行单独的进程/线程。

我怀疑，CAsyncSocket 仍然受到 MFC 是单线程模型（就 GUI 而言）这一事实的阻碍，尽管 Windows 已经拥有真正的抢先线程很长一段时间了。[我可能对那个断断续续的评论有误，我已经有一段时间没有直接使用Win32了]。

* * *

*更新：*

根据您说明您在做什么的更新，我相当肯定您在创建之前不允许连接。引用[http://msdn.microsoft.com/en-us/library/3d46645f(VS.80).aspx](http://msdn.microsoft.com/en-us/library/3d46645f(VS.80).aspx)，

> 要使用 CAsyncSocket 对象，请调用其构造函数，然后调用 Create 函数以创建底层套接字句柄 ... 并为客户端套接字调用 Connect 成员函数。

至于为什么，我认为这是一个额外的复杂性，因为 Windows 需要在事件泵环境中执行异步套接字，因为它们不能阻塞主 GUI 线程。

在 UNIXy 环境中，要么没有事件线程（正常进程），要么网络操作只是手动转移到另一个线程（在 GUI 应用程序中）。

这很可能是很久以前在 WinSock 中做出的设计决定（可能是在 Windows 3.11 中，这是一个执行异步操作的限制性更强的环境）并通过 [虽然这是我的猜测，UNIX 套接字 API 从来没有这个一种异步行为，其中消息被泵送，它总是倾向于使用`select()`或线程/进程]。

* * *

*进一步更新：*

如果您关闭和/或删除了套接字对象，而其上有一个挂起的操作，则通常会发生该断言（不是例外）。在您的情况下，我建议您关闭它时它仍在尝试进行连接。

然后当连接成功或失败时，回调被调用，它在表中找不到你的套接字。

这不是 MFC 问题，而是您朋友的代码违反了合同。如果您执行连接（或任何异步操作），则必须*等待*成功或失败才能关闭套接字（或进一步处理它） - 在这种情况下，这意味着等待调用 OnConnect() 函数。

从内存中，您`create()`在创建异步套接字时调用 ，然后响应到达消息队列的消息（即调用您的`OnXXX()`函数），其他一切都会发生。像所有 Win32 GUI 的东西一样，消息应该驱动程序（代码运行以响应消息）。这段代码看起来越来越像程序驱动一切的经典编码——这种方式很疯狂，因为你会让你的程序和异步套接字“线程”争夺控制权。

我已经有一段时间没有看它了，但是您应该能够掌握 CHATSRVR 示例程序，它将向您展示如何操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T03:25:32.833

这个问题很可能是代码写得不好，而且很有可能它与 MFC 几乎没有关系或根本没有关系。但是很难从您的描述中确定，归结为“我有一个 MFC 应用程序，它会抛出各种调试断言。我该怎么办？”。

可能需要重写，但如果不了解应用程序的更多信息，没有人可以真正说出来。我认为您（或您的朋友）需要下定决心。

# ruby-on-rails - 简单的 RoR 论坛可以集成到我的应用程序中吗？

> ID：800746
> 
> 赞同：1
> 
> 时间：2009-04-29T03:19:19.760
> 
> 标签：ruby-on-rails, forum

想知道是否有人对代码有建议，或者是否有一个插件（！）允许我可以将非常基本的论坛功能集成到我的应用程序中，以便它是单点登录？

否则......也许是一个关于如何从头开始构建的教程，我只是利用我们现有的身份验证？

谢谢！

我查看了以下线程，但没有选择答案，所以只是检查：

[https://stackoverflow.com/questions/2549/what-is-good-forum-software-to-add-to-an-existing-rails-application](https://stackoverflow.com/questions/2549/what-is-good-forum-software-to-add-to-an-existing-rails-application)

嗨，做了更多的研究，这似乎是迄今为止最好的，有人有经验和我可以查看的示例网站吗？

[http://github.com/radar/rboard/tree/master](http://github.com/radar/rboard/tree/master)

有人用过这个插件吗？ [http://github.com/bscofield/bagpipes/tree/master](http://github.com/bscofield/bagpipes/tree/master)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T15:06:56.690

我在您描述的方式中使用的另一种可能性是野兽。它很简单，但又很好用而且很实用。它没有作为插件集成，但在您的站点中使用它并将您的用户会话传递给它并不难。

（使用名为 AlteredBeast 的较新版本：http: [//github.com/courtenay/altered_beast/tree/master](http://github.com/courtenay/altered_beast/tree/master)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T03:36:54.740

那可能是最好的，肯定是用 Rails 编写的最活跃和最新的论坛。我相信 Radar 在他的[博客](http://forum.frozenplague.net)上有一个例子，你可以看看。如果您使用的是 Rails 2.3，它可以使用 Rails 引擎集成到您的站点中，因为这允许您将其他 Rails 应用程序嵌入到您自己的站点中。

# java - Java中的事件监听器没有应用程序有焦点？（全局按键检测）

> ID：800747
> 
> 赞同：19
> 
> 时间：2009-04-29T03:20:16.747
> 
> 标签：java, java-native-interface, listener, keylistener

我一直在寻找一段时间，每个人似乎都认为仅使用 Java 是不可能的，所以我会试一试；）

有没有办法让我的 Java 应用程序监听事件（特别是关键事件），而另一个不相关的应用程序具有窗口焦点？在我的情况下，我希望检测用户何时按下键盘上的“暂停”键，即使我的 Java 应用程序没有焦点。

我听说有人提到唯一的方法是编写一些 C 代码并使用 JNI。只是好奇是否有人知道避免这种情况的方法？或者，如果没有，至少是一个关于 c/JNI 东西的非常好的教程？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-05-30T08:05:36.697

这是我找到的最佳答案：

“有一个库来处理本机键盘和鼠标控制： [https](https://github.com/kwhat/jnativehook) ://github.com/kwhat/jnativehook ）”

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-29T04:42:27.517

这是我的理解，这是做不到的。从根本上说，JVM 只为它接收到的 O/S 事件生成事件，并且它只有在获得焦点时才接收 O/S 输入事件。

我相信您*可以*使用 JNI 触发 O/S 为所有输入生成事件，但这将非常依赖于 O/S。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T14:24:02.190

我也不知道有什么方法可以解决这个问题。我确实[在 Java 论坛上找到了这个链接，](http://forums.sun.com/thread.jspa?threadID=632369)其中有一个很好的例子，说明了如何设置 JNI 的东西并制作一个全局键盘处理程序（这里添加的太多了）。它有点过时（2005 年），但该示例看起来足够全面，可以让您入门。

# winapi - 如何弹出提示和弹出任何其他打开的窗口

> ID：800755
> 
> 赞同：0
> 
> 时间：2009-04-29T03:25:40.620
> 
> 标签：winapi, tooltip, system-tray

有没有办法弹出提示和弹出任何其他打开的窗口？我没有找到在 NOTIFYICONDATA 结构中设置它的标志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T16:47:58.530

NOTIFYICONDATA 与[Shell_NotifyIcon()](http://msdn.microsoft.com/en-us/library/bb762159(VS.85).aspx)一起用于在任务栏的通知区域中放置和控制图标。如果您尝试从通知图标显示工具提示或气球消息，它们通常会在出现时位于窗口顺序的顶部。您无需采取任何特殊措施。

通常，要使您直接控制的窗口出现在所有其他窗口之上，您可以在使用[CreateWindowEx()](http://msdn.microsoft.com/en-us/library/ms632680(VS.85).aspx)或稍后使用[SetWindowPos()](http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx)创建窗口时应用 WS_EX_TOPMOST 样式。

# c++ - 何时在 C++ 类中使用关键字“static”？

> ID：800761
> 
> 赞同：0
> 
> 时间：2009-04-29T03:33:10.930
> 
> 标签：c++, multithreading, static

代码

```
 static void MyClass::ThreadEntryStatic()
 {
    //...
 }

 void MyClass::Begin()
 {
         CreateThread(..,ThreadEntryStatic,..);
 } 
```

在什么情况下我们应该在类中使用静态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T03:51:39.357

关键字 static 可以在三个地方使用。一种是在结构/类的声明中，当上下文意味着该方法是类方法而不是实例方法时。这意味着直接调用此方法，您不需要实例。从此静态方法中，您无法访问实例变量。

在 MyClass.h 中

```
struct MyClass
{
  static void ThreadEntryStatic();

  void Begin();
}; 
```

在 MyClass.cpp 中

```
void MyClass::ThreadEntryStatic()
{
}

void MyClass::Begin()
{
  CreateThread(.., MyClass::ThreadEntryStatic, ...);
} 
```

使用 static 关键字的第二种情况是在文件范围内，您不希望声明的变量的可见性在文件外可见。您也可以为此使用匿名命名空间。

使用 static 关键字的第三种情况是在方法的范围内，并且该值在函数的执行之间保留（并在第一次使用赋值时进行初始化）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T03:47:42.377

如果您在多个线程上运行静态方法，则需要非常注意同步您的代码。在我看来，在进行多线程编程时，我会尝试在每个线程中使用我的对象或工作项的单独实例，并完全避免任何类型的静态或共享数据。当然这并不总是可行的，因此线程仍然是最棘手的编程领域之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T04:21:11.110

作为一个具体的例子，

```
class Test{
      static void foo();      
};

static void Test::foo(){
    // code here
} 
```

不会编译，您无法在类声明之外使用 static 关键字声明函数。在实现该功能时，您只需删除 static 关键字。

```
class Test{
      static void foo();      
};

void Test::foo(){
    // code here
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T05:01:22.260

一些人已经谈到了这一点，但`static`不应该使用用于内部链接，而应该使用匿名命名空间：

```
namespace
{

void myInternallyLinkedFunction()
{
    // do something
}

int myInternallyLinkedInteger;

class myInternallyLinkedClass
{
public:
    void doSomething();
};

} // anon namespace

void myExternallyLinkedFunction()
{

    ++myInternallyLinkedInteger;
    myInternallyLinkedFunction();
    myInternallyLinkedClass x;
    x.doSomething();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T03:52:29.370

静态变量的值在函数调用之间保留。检查[此](http://msdn.microsoft.com/en-us/library/s1sb61xd(VS.80).aspx)MSDN 条目以获取示例。chrish 的回答中概述了定义和使用“静态”方法

在实现只需要一个类实例的单例类时，可以使用静态。它的用法取决于上下文。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T08:03:01.123

您的示例显示的是“静态成员函数线程回调”模式。由于线程函数必须有WINAPI签名，所以不能是普通的成员函数，只能是静态成员。通常你把它作为一个线程参数传递给这个回调，然后调用一个真正的成员来执行线程工作。

静态成员只有一种用途，而且有很多不同的用途。真的很难猜出你的问题的目的是什么。您是在解决某个特定问题，还是只是对静态成员或静态成员函数的所有可能用途感兴趣？

更完整的“静态成员函数线程回调”示例：

```
class MyClass
{

  /// background rendering thread
  int ThreadEntry()
  {
     // do the work here
  }

  /// static member callback "proxy"
  static DWORD WINAPI ThreadEntryStatic(void *param)
  {
    return ((EngineDD9 *)param)->ThreadEntry();
  }

  void SpawnThread()
  {
    CreateThread(.., ThreadEntryStatic, ...);
  }

}; 
```

# asp.net - Gridview：验证 SelectedIndex > -1

> ID：800762
> 
> 赞同：0
> 
> 时间：2009-04-29T03:33:49.273
> 
> 标签：asp.net, validation, gridview

我目前有一个`Gridview`，并且我想使用客户端验证来确保选择了一行（即：）`SelectedIndex > -1`。

目前我正在使用`<asp:CustomValidator>`但想远离服务器端验证。这是我目前正在做的事情：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False">
    <Columns>
        <asp:BoundField HeaderText="MSN" DataField="MSN" />
        <asp:CommandField ShowSelectButton="True" />
    </Columns>
</asp:GridView>
<asp:CustomValidator ID="cvSelected" runat="server" ErrorMessage="Please select!" /> 
```

然后在后面的代码中（`.cs`）：

```
Private Sub cvSelected_ServerValidate(ByVal source As Object, ByVal args As _
System.Web.UI.WebControls.ServerValidateEventArgs) Handles cvSelected.ServerValidate
    args.IsValid = (GridView1.SelectedIndex > -1)
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T03:44:28.263

这对我来说似乎没问题。在这种特定情况下，客户端验证听起来有点模糊，比如可能检查您希望拥有服务器生成 ID 的一部分的某些元素。非常脆弱。

通常我会多走一步，实际创建我自己的继承自[BaseValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.aspx)的验证器控件。使封装和 SoC 更清洁，并且验证逻辑也可移植。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-06T02:53:16.527

在页面后面代码的 GridView_RowCreated() 事件中，您可以将属性添加到行标记，如下所示：

```
e.Row.Attributes.Add("onclick", "SetRowSelected();"); 
```

然后您需要在您的页面中包含 javascript 函数“SetRowSelected()”，并让它设置一个隐藏字段（例如，名为 IsRowSelected）的值，例如“true”。

然后，您可以将另一个 javascript 函数添加到用于提交页面的控件的“onclick”事件中 - 并让它检查隐藏控件的值。如果不是这样，只需向用户显示一个 alert() - 否则提交页面。

这听起来会奏效吗？

# c# - 如何彻底“杀死”后台工作人员？

> ID：800767
> 
> 赞同：58
> 
> 时间：2009-04-29T03:37:19.547
> 
> 标签：c#, backgroundworker

我正在编写一个重复运行一系列数字 IO 操作的 Windows 应用程序。

当用户单击“开始”按钮时，这一系列动作开始，并由 backgroundWorker1_DoWork() 中的后台工作人员完成。

但是，有时我会收到“此后台工作人员当前正忙.......”错误消息。

我正在考虑在代码中实现以下内容，方法是在开始另一个操作序列之前使用 while 循环“杀死”后台工作人员：

```
if (backgroundWorker1.IsBusy == true)
{

    backgroundWorker1.CancelAsync();
    while (backgroundWorker1.IsBusy == true)
    {
        backgroundWorker1.CancelAsync();
    }

    backgroundWorker1.Dispose();

}

backgroundWorker1.RunWorkerAsync(); 
```

我想我主要担心的是， backgroundWorker1 最终会被“杀死”吗？如果会，完成它需要很长时间吗？

这种编码会让我陷入无限循环吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2010-01-20T20:22:44.407

您可以使用这样的东西（有关中止托管线程和 ThreadAbortException 的更多信息，请参阅Chris Sells 的“[使用转子（Web 存档）探测 ThreadAbortException 的深度”）：](https://web.archive.org/web/20101228064513/http://ondotnet.com/pub/a/dotnet/2003/02/18/threadabort.html)

```
public class AbortableBackgroundWorker : BackgroundWorker
{

    private Thread workerThread;

    protected override void OnDoWork(DoWorkEventArgs e)
    {
        workerThread = Thread.CurrentThread;
        try
        {
            base.OnDoWork(e);
        }
        catch (ThreadAbortException)
        {
            e.Cancel = true; //We must set Cancel property to true!
            Thread.ResetAbort(); //Prevents ThreadAbortException propagation
        }
    }

    public void Abort()
    {
        if (workerThread != null)
        {
            workerThread.Abort();
            workerThread = null;
        }
    }
} 
```

用法：

```
backgroundWorker1 = new AbortableBackgroundWorker();
//...
backgroundWorker1.RunWorkerAsync();

if (backgroundWorker1.IsBusy == true)
{
    backgroundWorker1.Abort();
    backgroundWorker1.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-29T03:41:10.643

我认为线程应该尽可能地对自己的资源负责*，*包括*他们自己的生命周期。*

从其范围之外杀死线程通常是一个坏主意。旨在将消息传递给线程以*自行*关闭的应用程序往往与多线程行为相关的问题要少得多。

一个线程应该监视所述消息，该消息可以像另一个线程设置的布尔值一样简单，并由该监视线程及时读取，并尽快*干净地关闭自己。*

这意味着它是否应该查找消息：

*   在它的主循环中，如果有的话。
*   定期在任何长时间运行的循环中。

使用消息关闭它的线程应该等待（但当然不要停止 GUI）。

请注意，具有特定功能的线程环境还有其他可能性，例如线程可以随意将自己标记为可取消的情况，以允许外部杀死更安全。

但是通常更容易构建您的应用程序，让线程掌握自己的命运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-12T11:43:18.317

我遇到了同样的问题，我不确定这是否会有所帮助，但我猜你的后台工作人员内部有一个循环，否则它会退出。你需要做的就是把你的循环放在里面。

放入您的后台工作人员：

```
while (backgroundworker1.CancellationPending == false)
{
    //Put your code in here
} 
```

要杀死这个后台工作者，你可以输入你的按钮：

```
BackgroundWorker1.CancelAsync() 
```

我希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-07T03:04:40.313

我把一个（我认为）放在一起可以完成这项工作。请让我知道我是否离开了。这是一个简单的例子，说明它是如何工作的。

```
var backgroundWorker = new BackgroundWorker(){WorkerSupportsCancellation = true};

backgroundWorker.DoWork += (sender, args) =>
         {                 
                 var thisWorker = sender as BackgroundWorker;
                 var _child = new Thread(() =>
                                               {
                                                   //..Do Some Code

                                               });
                 _child .Start();
                 while (_child.IsAlive)
                 {
                     if (thisWorker.CancellationPending)
                     {
                         _child.Abort();
                         args.Cancel = true;
                     }
                     Thread.SpinWait(1);
                 }                 
         };

 backgroundWorker.RunWorkerAsync(parameter);
 //..Do Something...
backgroundWorker.CancelAsync(); 
```

由于后台工作者是线程池的一部分，我们不想中止它。但是我们可以在内部运行一个线程，我们可以允许中止发生。然后 backgroundWorker 基本上会一直运行，直到子线程完成或者我们向它发出信号以终止进程。然后后台工作线程可以返回读池。通常，我会将其包装在一个辅助类中，并通过我希望后台线程运行的委托方法作为参数传入并在子线程中运行。

请有人让我知道我是否将我的头撞在墙上，但它似乎工作正常..但这不是线程的问题..当你在不同的时间运行它时你可以获得不同的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-09T11:44:50.613

我只是使用'return'转到线程末尾：

```
private void myWorker_DoWork(object sender, DoWorkEventArgs e)
{
   // some variables 

   while(true)
   {
      // do something ...
      if(need_cancel) return;
      else doSomeThingElse();
   }

   // may be more code here (ignored if 'return' is executed) ...
   // .........
   // .........
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-09-04T05:54:55.500

```
public class abortableBackgroundworker: BackgroundWorker
{
    public bool Kill = false;

    protected override void OnDoWork(DoWorkEventArgs e)
    {

        var _child = new Thread(() =>
        {
            while (!Kill)
            {

            }
            e.Cancel = true;//..Do Some Code

        });
        _child.Start();
        base.OnDoWork(e);

    }

} 
```

您将 kill 设置为 true 以杀死线程并且没有中止问题:)

# python - 关于与 Python 3.0 兼容的 GUI 编辑器

> ID：800769
> 
> 赞同：3
> 
> 时间：2009-04-29T03:37:44.660
> 
> 标签：python, user-interface, python-3.x

我想开始学习 Python（零经验）。我有点倾向于从 Python 3.0 开始。但是，我不确定此时是否存在与 Python 3.0 兼容的 GUI 编辑器。我试过安装 Glade，但我得到的那个只适用于 Python 2.5。我可以在 Python 3.0 中使用什么？欢迎任何建议。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T06:31:22.187

如果您正在寻找 GUI 编辑器，请查看以下内容：

*   [wxFormBuilder](http://wxformbuilder.org)可以为 wxpython 生成 .XRC 文件。
*   XRCed 随 wxpython 一起提供，也可以做到这一点。

.XRC 文件是描述您的 GUI 的 xml 文件，不是特定于语言的。您可以从 Python 2.6 和 Python 3.0 加载这些文件而无需任何更改。

WxPython 目前仅适用于 Python 2.6。我不会太担心将 python 2.6 转换为 3.0。这是几行改变的事情。

.XRC 方法的问题在于，您仍然需要将这些 xml 文件与 Python 代码粘合在一起。如果您是初学者，这可能与手动编写 GUI 一样棘手。无论如何，这就是 WxPython 的问题：我不知道任何真正好的编辑器，看看这个[讨论](https://stackoverflow.com/questions/800849/nice-ide-for-wxpython-or-tkinter-gui-development)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T04:03:50.510

有许多有用的库（更不用说教育材料、食谱片段等）尚未移植到 Python 3.0，所以我建议现在使用 Python 2.x（目前，5 <= x <= 6 ）。如果你是 Python 的初学者，那就更是如此。如果你真的计划发布一些软件，那么三重——许多系统不附带 Python 3.0。

Python 3.0 与 Python 2.x 系列并没有根本的不同；你在 Python 2 中学到的东西在很大程度上仍然适用于 Python 3。在 SO 上搜索 Python 3.0 会发现许多线程，其中大多数人声明他们不会很快迁移到 Python 3.0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T03:49:55.443

只需使用您最熟悉的编辑器即可。

“作为逻辑的前导空间”和鸭子类型意味着编辑器可以合理地（或需要！）使用 python 源代码进行的语法检查和重构是有限的。

如果您没有最喜欢的编辑器，那么只需使用大多数 python 发行版附带的“空闲”编辑器。

如果您谈论的是 GUI 设计工具，那么在选择您的设计工具之前，您需要在几个受支持的 GUI（Tk、WxWindows 等）中进行选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T04:47:19.237

目前 Python3.0 中唯一可用的 GUI 工具包是 Tkinter，我认为目前还没有任何 Python3.0 GUI-builders 可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T05:00:23.387

WING 3.2 beta 在 python 3 中工作。

里克纳尔

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-09T22:34:28.780

[PyQt 4.5](http://www.riverbankcomputing.co.uk/software/pyqt/download)（几天前发布）增加了对 Python 3 的支持

这当然不会贬低 gotgenes 的答案：大多数第 3 方库还没有为 Python 3 做好准备。

# javascript - 通过 Javascript 在 ActiveX 上使用参考参数

> ID：800773
> 
> 赞同：2
> 
> 时间：2009-04-29T03:40:41.190
> 
> 标签：javascript, com, vbscript, activex

我有一个 ActiveX（第 3 方，无源），其方法具有如下引用参数：

```
HRESULT GetSomething(
[in] short param1,
[out] BSTR* someString); 
```

在 C++ 中，你会像这样执行它：

```
BSTR someString = NULL
m_activeX.GetSomething(0, &someString); 
```

我将如何通过 Javascript 执行此操作？ActiveX 中的所有其他功能都可以正常工作，但这个看起来不可能？如果在 Javascript 中不可能，是在 VBScript 中吗？我也没有运气。

顺便说一句，这必须在 Internet Explorer 中完成

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:12:39.983

我不能给你一个肯定的答案，但我不相信它可以做到。我希望有人会证明我错了，但这就是为什么我认为它行不通...

在 Javascript 中，所有变量都是按值传递的。在 IE 中，您将创建一个 ActiveXObject javascript 类的实例来包装您的 COM 对象。即使该包装器对象可以从您的 COM 对象中获取值，在 Javascript 中也无法将该值传回给您。

如果您知道您将在 Windows 上的 IE 中运行，您可以尝试使用 vbscript 而不是 javascript。Vbscript*确实*支持按引用传递，因此您可能会更幸运。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-02T13:48:39.947

```
// Using javascript
var someString = activeXObj.GetSomething(0); 
```

# php - 如何扩展 Zend View 以实现具体功能？

> ID：800775
> 
> 赞同：6
> 
> 时间：2009-04-29T03:41:27.977
> 
> 标签：php, zend-framework, localization

我想让我们的设计师尽可能轻松地在视图中本地化字符串，这意味着我想这样做：

```
...
<p><?php echo $this->_("Hello, world!"); ?></p>
... 
```

这里的下划线符号是必要的，以允许 Poedit 自动提取所有字符串以进行本地化。实现很简单：

```
public function _($string)
{
    return Zend_Registry::get('Zend_Translate')->_($string);
} 
```

目前，我已经将它直接放入`Zend_View_Abstract`，这很糟糕（我不想通过修改任何 Zend 库来做到这一点）。理想情况下，我会扩展`Zend_View_Abstract`以允许我实现我们需要的其他具体功能，但我不知道如何设置它。另一种方法可能是实现 View Helper，但我知道如何做到这一点的唯一方法会使视图中的代码更加冗长。任何指针（不，不是那种）将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T08:51:56.200

显然忽略我自己的路径......

1.  延长`Zend_View`
2.  将您的方法放在这个扩展类中
3.  实例化类（例如在您的引导程序中）
4.  将其分配给 ViewRenderer
5.  将该 viewrenderer 传递给`Zend_Controller_Action_HelperBroker's`addHelper 方法
6.  在您的视图中使用它

在 /library/MegaHAL/Zend/ 创建 View.php：

```
class MegaHAL_Zend_View extends Zend_View
{
    public function _($string)
    {
    return Zend_Registry::get('translate')->_($string);
    }
} 
```

在您的引导程序中：

```
require_once APPLICATION_PATH.'../library/MegaHAL/Zend/View.php';

$view = new MegaHAL_Zend_View();

$viewRenderer = new Zend_Controller_Action_Helper_ViewRenderer();
$viewRenderer->setView($view);
Zend_Controller_Action_HelperBroker::addHelper($viewRenderer); 
```

在您看来：

```
<p><?php echo $this->_("Hello");?></p> 
```

我相信这会做你想要的，是吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T03:46:45.467

我认为您正在寻找一种创建[自定义视图助手](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.custom)的方法。

例子：

```
class My_View_Helper extends Zend_View_Helper_Abstract
{
    public function translate($string)
    {
        //...
    }
} 
```

...

```
$view->setHelperPath('/path/to/helpers', 'My_View_Helper'); 
```

...

然后在您的视图中您可以使用它：

```
echo $this->translate("Hello, World!"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T08:41:32.280

虽然我认为使用视图助手将是正确的“Zend-Framework”方式，但您可以扩展`Zend_View`和实现您想要拥有的所有其他方法 - 这样您就不会失去`Zend_View`.

```
class My_View extends Zend_View
{
    public function _($string)
    {
        return Zend_Registry::get('Zend_Translate')->_($string);
    }
} 
```

然后，您只需确保您的新视图类已实例化并注册为[控制器](http://framework.zend.com/manual/en/zend.controller.action.html#zend.controller.action.viewintegration)中的默认视图（将`Zend_Controller_Action::$view`实例变量设置为您的类的实例）和您的[`Zend_Layout`](http://framework.zend.com/manual/en/zend.layout.options.html)（使用布局时；将您的视图作为配置选项传递） with key `view`) 不使用时`ViewRenderer`或[`ViewRenderer`](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.viewrenderer)使用时在`ViewRenderer`using 中`Zend_Controller_Action_Helper_ViewRenderer::setView()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:30:19.427

如果配置正确，Poedit 可以自动从 _() 以外的函数中提取字符串。

# css - 为什么不能在 CSS 选择器中对后代进行分组？

> ID：800779
> 
> 赞同：5
> 
> 时间：2009-04-29T03:43:08.253
> 
> 标签：css, css-selectors

如果您想为一组后代分配相同的样式，为什么没有一种简单的方法可以使用 CSS 来做到这一点？

假设您有一个 HTML 表格，如下所示：

```
<table id='myTable'>
  <tr>
    <th></th>
    <th></th>
    <th></th>
  </tr>
  .
  .
  .
  <tr>
    <td></td>
    <td></td>
    <td></td>
  </tr>
</table> 
```

为什么必须使用以下选择器设置所有列标题和单元格的样式？

```
#myTable th, #myTable td {} 
```

为什么没有类似于以下的语法？

```
#myTable (th,td) {} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-02T21:31:20.113

> 为什么没有类似于以下的语法？
> 
> ```
> #myTable (th,td) {} 
> ```

很简单，因为没有人费心提出有用的语法......直到最近（相对于你发布这个的时间）作为 2008 年，作为一个[`:any()`伪类](http://lists.w3.org/Archives/Public/www-style/2008Oct/0066.html)。[稍后](http://lists.w3.org/Archives/Public/www-style/2010Jan/0209.html)对此进行了更深入的讨论。

第一个实现从 Mozilla 浮出水面，尽管迟到 2010 年，伪装成[`:-moz-any()`](https://hacks.mozilla.org/2010/05/moz-any-selector-grouping)：

```
#myTable :-moz-any(th, td) {} 
```

第二年，建议[WebKit 效仿](https://bugs.webkit.org/show_bug.cgi?id=38095)：[`:-webkit-any()`](http://trac.webkit.org/changeset/81742)

```
#myTable :-webkit-any(th, td) {} 
```

但是，如果您现在尝试同时使用这两个前缀，那么[由于选择器解析规则](https://stackoverflow.com/questions/8317954/ignoring-webkit-specific-css-selector-in-firefox/8318202#8318202)，您将不得不*复制规则集*，使您的代码*更长*并且违背了伪类的预期目的：

```
#myTable :-moz-any(th, td) {}
#myTable :-webkit-any(th, td) {} 
```

这使得在面向公众的代码中使用前缀选择器几乎毫无意义。除了特定于供应商的代码之外，我看不到它们在任何地方的合法用途，这意味着您可能不会在同一个样式表中一起使用它们。

新的 Selectors 4 级工作草案有一个[`:matches()`伪类](http://www.w3.org/TR/selectors4/#matches)提案，它基于原始`:any()`提案，但随着草案的修订可能会看到某些增强：

```
#myTable :matches(th, td) {} 
```

当然，由于它是一个新草案，所以不要指望很久以后才能支持浏览器。

在对`th`和`td`元素进行样式设置的非常特殊的情况下，您可以`*`改用假设`tr`此表中的任何元素都不会包含单元格元素以外的子元素，例如`script`or `template`：

```
#myTable tr > * {} 
```

但是，如果您是性能迷并且讨厌`*`选择器，那么您将不得不长期坚持下去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-18T17:30:36.383

您可以使用供应商特定的`-moz-any()`和`-webkit-any()`.

请参阅[MDN 参考资料](https://developer.mozilla.org/en/CSS/%3A-moz-any)，以及[W3C](http://dev.w3.org/csswg/selectors4/#matches)对`:matches()`伪属性的推荐。

干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-02T21:47:48.687

您可能想查看 SASS - [http://sass-lang.com](http://sass-lang.com)

它允许您以更明智的方式编写 CSS（类似于您建议的方式），但 ti 仍然可以编译为普通的旧 CSS。

例如：

```
#myTable{
    background: #CCC;

    tr{
      border: 1px solid #EEE;
    }

    td{
      background: blue;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T03:48:50.517

如果不使用 W3C，您可以将 jQuery 用于类似的事情

```
$('#myTable').find('tr, td'); 
```

当然，JS 并不总是启用的，依赖它也不是一个好主意。你只需要列出你所有的选择器！

# java - 将 xml 转换为在文本周围有 CDATA 的最佳方法（在 java 中）

> ID：800786
> 
> 赞同：2
> 
> 时间：2009-04-29T03:46:22.097
> 
> 标签：java, xml

我有一个奇怪的要求，我需要获取一些 xml 并重新编写它，以便将文本节点包装在 CDATA 中（这是用于不允许正常转义的客户端）。

似乎任何普通的 XML 库 dom4j、jdom、java xml 都没有对此的内置支持。有任何想法吗？我可以为此使用 XSLT 吗？

我不是很清楚。下面是我要开始的内容：

```
<foo>This has an &amp; escaped value</foo> 
```

我需要做的是将其转换为：

```
<foo><![CDATA[This has an & escaped value]]></foo> 
```

-戴夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T18:08:46.363

您可以使用 XSLT 来完成此操作，只要 a) 您需要输出的所有文本都在元素中，b) 您只关心文本节点，c) 您知道包含文本的所有元素的名称，并且 d ) 可以将所有这些输出元素中的任何文本作为 CDATA 发出。如果所有这些情况都成立，那么您可以编写一个恒等变换并将这个元素添加到其中：

```
<xsl:output method="xml" cdata-section-elements="elm1 elm2 elm3..."/> 
```

请参阅有关此主题[的 W3C XSLT 建议。](http://www.w3.org/TR/xslt#section-XML-Output-Method)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T18:48:22.617

感谢您的所有回答。我找到了一种使用 dom4j 的方法。如果元素具有“混合”子元素（即文本元素），我的实现将不起作用，但在我的情况下，这不是问题。它之所以有效，是因为如果添加 CDATA 节点，dom4j 将输出 CDATA：

```
 public void replaceTextWithCdataNoMixedText(Document doc) {
        if( doc == null )
            return;
        replaceTextWithCdata(doc.content());
    }

    private void replaceTextWithCdata(List content) {
        if (content == null)
            return;
        for (Object o : content) {
            if (o instanceof Element) {
                Element e = (Element) o;
                String t = e.getTextTrim();
                if (textNeedsEscaping(t)) {
                    e.clearContent();
                    e.addCDATA(t);
                } else {
                    List childContent = e.content();
                    replaceTextWithCdata(childContent);
                }
            }
        }
    }

    private boolean textNeedsEscaping(String t) {
        if (t == null)
            return false;
        for (int i = 0; i < t.length(); i++) {
            char c = t.charAt(i);
            if (c == '<' || c == '>' || c == '&') {
                return true;
            }
        }
        return false;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T10:10:42.750

我认为它可以与 XSLT 转换一起使用，但我不确定转换的性能。看看[CDATA Sections 和 XSLT](http://www.dpawson.co.uk/xsl/sect2/cdata.html)，它可能会对你有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T04:08:04.230

采用预制的 xml 并解析（使用 xml 解析器）只会使解析器阻塞未转义的字符。我能想到的唯一解决方案是制作自己的标签汤解析器来解析、修改并将其转储回 xml。

# mysql - 将 Zope 数据转换为 Mysql

> ID：800787
> 
> 赞同：0
> 
> 时间：2009-04-29T03:46:24.127
> 
> 标签：mysql, zope

如何将 Zope 2.1 数据转换为 Mysql 数据库。有什么方法可以转换吗？我要银色。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-17T21:04:31.580

您很可能必须手动编写转换脚本。遍历您感兴趣的 Zope 对象并为它们创建表格行。Zope 的 Python 脚本和 SQL 方法可能会派上用场。

# zsh - 在 Screen 启动时无法将 Zsh 作为登录 shell

> ID：800790
> 
> 赞同：1
> 
> 时间：2009-04-29T03:47:50.440
> 
> 标签：zsh, gnu-screen

我将以下内容放入我的 .zshrc

```
if [[ $STY = '' ]] then screen -xR; fi 
```

我现在启动终端时得到 Bash，尽管我在 Mac 的终端 > 设置中有 /bin/zsh。

**我需要更改哪个变量才能使 Zsh 在 Screen 中成为我的登录 shell？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T17:37:21.777

更改 shell（例如更改为 Zsh）的一种快速方法是运行以下代码

```
chsh -s /bin/zsh 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T04:03:39.623

*   打开您的**系统偏好设置**。
*   单击**帐户**。
*   单击显示“单击锁定进行更改”的**锁定图标。**
*   **按住 Control 单击**或右键单击左侧帐户列表中的**帐户名称**。
*   选择**高级选项...**菜单项。
*   **将您的登录外壳**更改为`/bin/zsh`.
*   关闭并重新打开**Terminal.app**中的所有 shell 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-18T22:14:23.853

如果环境和其他东西不起作用，那么您可以简单地将它作为参数提供给 screen:`screen -xR zsh`并且 screen 将运行 zsh 而不是其他东西（bash）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T18:32:08.900

```
SHELL=/bin/zsh screen 
```

应该工作，即设置环境变量`$SHELL`

# c# - c#, 如何解决 *.lnk 文件标题？

> ID：800791
> 
> 赞同：3
> 
> 时间：2009-04-29T03:48:44.823
> 
> 标签：c#, shortcut

我想获得快捷方式的标题，而不是文件名，不是描述，而是标题。如何得到它？

我已经学会从这里解析它的目标路径，[如何在 c# 中解析 .lnk](https://stackoverflow.com/questions/139010/how-to-resolve-a-lnk-in-c)

但我没有找到任何方法来获得它的标题。

[![](https://i.stack.imgur.com/qzpvM.jpg)](https://i.stack.imgur.com/qzpvM.jpg)
[（来源：[ggpht.com](http://lh4.ggpht.com/_2HeweEMiLbg/SfkeMXlpbmI/AAAAAAAAIDE/eucex2mloOo/s912/vista-lnk.jpg)）]

[![](https://i.stack.imgur.com/CbQfo.jpg)](https://i.stack.imgur.com/CbQfo.jpg)
[（来源：[ggpht.com](http://lh6.ggpht.com/_2HeweEMiLbg/Sfkf5eerapI/AAAAAAAAIDM/u5GqEWvgc74/lnk-properties-dlg.jpg)）]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T04:40:01.023

正如 JRL 建议的那样，听起来您可能正在尝试获取链接指向的文件的标题。

如果您*不想*这样做，我建议您在[XVI32](http://www.chmaas.handshake.de/delphi/freeware/xvi32/xvi32.htm)等十六进制编辑器中打开这些 .lnk 文件之一。您大概可以从那里判断显示的中文名称是嵌入在 .lnk 文件中还是在其他地方。

如果它在其他地方，它可能是扩展文件属性。有一些源代码可能有助于检索该信息：[扩展文件属性](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=683&lngWId=10)

如果碰巧它*位于*.lnk 文件中，我建议查看[Windows 快捷方式规范](http://mediasrv.ns.ac.yu/extra/fileformat/windows/lnk/shortcut.pdf)以获取偏移信息等关于该数据位置的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-01T23:25:57.450

您可以使用最新版本的代码包中的属性系统 API：

（系统中的所有 670 多个属性都可以使用简单的属性访问器访问）

[http://code.msdn.microsoft.com/WindowsAPICodePack](http://code.msdn.microsoft.com/WindowsAPICodePack)

我知道您当前需要的只是有限的 lnk 文件标题。使用上面的库，示例代码可能如下所示：

ShellLink myLink = ShellObject.FromParsingName("c:\somepath\myLink.lnk");

字符串标题 = myLink.Properties.System.Title.Value；

// 这就是它的指向... string target = myLink.Properties.System.TargetParsingPath.Value;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T07:58:13.093

在快捷方式目录中有一个Desktop.ini隐藏文件，Desktop.ini文件记录了快捷方式的字符串信息。

Desktop.ini 文件示例：

```
[本地化文件名]
Windows Update.lnk=@%SystemRoot%\system32\wucltux.dll,-1
默认程序.lnk=@%SystemRoot%\system32\sud.dll,-1

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T04:24:31.367

请定义“标题”。唯一听起来相关的属性是快捷方式的文件名、目标的文件名和 .lnk 文件的描述数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T05:00:40.033

假设您指的是链接指向的文件的标题，而不是链接本身，并且您正在谈论 Windows，那么它是通过 NTFS 中的一个功能（替代流）完成的。[您可以使用本文](http://www.codeproject.com/KB/cs/ntfsstreams.aspx?df=100&forumid=4446&exp=0&select=890716)中的代码访问这些流。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-29T04:02:35.740

环顾四周创建快捷方式，看起来有很多与脚本对象跳过箍。但我错过了什么吗？如果您有快捷方式的路径，则名称应该与您在路径中找到的完全相同，而不是您必须查找的某些属性。

```
 Dim f As FileInfo = New FileInfo("C:\Name of shortcut.lnk")
    Dim title As String = f.Name.Replace(".lnk", String.Empty) 
```

# language-agnostic - StackOverflow 验证码触发器

> ID：800797
> 
> 赞同：3
> 
> 时间：2009-04-29T03:51:11.820
> 
> 标签：language-agnostic, captcha

通常，每当可能需要验证码时，我总是先将其呈现给用户，但 StackOverflow 方法要好得多，它只会在它认为我可能是机器人时才向我显示验证码。

我对学习需求以及如何在我的项目中实施类似的系统很感兴趣。是什么让 SO 相信我是机器人？是否有执行此类行动的时间框架？这样的系统是否需要任何特定的数据库设计？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T04:01:26.507

我会记录操作之间的时间，如果在（例如）10 秒以下，则需要验证码才能继续。

# project-management - 项目太难？你做什么工作？

> ID：800804
> 
> 赞同：33
> 
> 时间：2009-04-29T03:53:44.920
> 
> 标签：project-management

当你被分配一个太难做的项目时，你会怎么做：

*   说这是一个庞大的项目，而你的老板认为你一个人可以处理它
*   你有知识做某事，但其他一些事情在这个时间点上有点超出你的专业知识
*   你的老板可能认为这是一个人可能在一个月内完成的事情

SO用户，我希望在这里得到现实的答案。这是一个现实世界的情况，我正在努力弄清楚明天我对老板的回应，关于如何巧妙地接近他。

* * *

我只是想在这里为我的笔记添加更新。我的老板所针对的应用程序是一个“类似 NING”的网络应用程序。我的犹豫主要是在这么短的时间内成为唯一一个被分配到如此复杂的应用程序的人。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-29T04:03:01.573

由于工作性质，每个人都必须定期处理这种情况。（通常，如果您知道完成一项工作所需的一切，那么您已经完成了这项工作，不需要再做一次。:)）

1.  对你的老板诚实地谈论你的焦虑。您的经理需要了解您对项目风险状况的评估。无论如何你都会这样做的可能性很大。没关系！**_** 这是你大放异彩的机会！:)

2.  将问题分解为您理解的任务和您不理解的任务，然后开始一次解决一个问题。我个人喜欢在简单任务和困难任务之间交替。完成简单的任务让我感觉自己在直觉层面上取得了真正的进步，这对我的个人动力很重要。完成艰巨的任务可以在计划的早期解决潜在的问题区域。这通过更早地评估未知数来减轻项目的尾端风险，而不是在您还剩 2 天且没有更多计划/回旋余地时让它们溃烂和爆炸。它还可以帮助您降低压力水平，因为您知道您已经掌握了项目的可怕部分。记住——你的未知领域是你不了解问题域的地方，所以' s 进度/预算失误的真正风险所在。您需要尽早并经常降低这些风险。与您可以咨询的同事一起学习如何做这些事情。

3.  一个月的目标大概是一个**目标**。我认为在一般情况下期望 A 人实际估计 B 人计划完成的任务是不合理的。要根据目标跟踪您的进度，请设置不超过 16 小时/2 天的里程碑，并根据它们跟踪您的完成率。这与您的简单/困难任务列表密切相关。

4.  一个简单的事实是，有时，你只会被甩在头上。在这种情况下，您可能必须充分利用压倒性的情况。我大学毕业后的第一份工作的第一个任务是为大容量、高速率的数据设计一个可靠的、面向事务的、点对点的 n 路服务器同步系统。我事先告诉我的老板，我没有这方面的专业知识，当时我没有足够的经验来理解我需要推迟要求。（回想起来，鉴于政治环境，我不知道推迟要求是否真的会有所帮助）。这只是一个管理不善的项目的一个案例，该项目花了大约 18 个月的时间最终在自身的重量下崩溃。不过，我仍然利用这个机会学到了很多东西，并对我所在组织的工作方式有所了解，无论如何这都是非常有价值的。:)

祝你好运！:)

**问题更新后编辑**

好的，如果我正确理解您的更新，我们肯定在#4 领域。在一个人月内为宁创造一个竞争对手是不现实的。我在之前的回答中假设您正在与对软件开发有基本了解的人打交道。基于此：

1.  要求你的老板进一步澄清要求。也许（*交叉手指！*）你只是误解了你被要求做的事情，或者项目的范围。始终假设有能力，直到出于社会原因完全证明并非如此。也许您只是被要求提出一个整体设计和一些非常简单的概念证明？

2.  如果你的老板真的与现实脱节，请在白板或共享的纸上与他/她一起做出明智的 15 分钟粗略估计。在这一个月的时间里，把各种坑都炸完，应该一点都不难。也许你的老板认为你可以重用一些你不知道的内部代码？这将带来您的经理所做的任何错误假设：项目范围。

3.  如果你的老板绝对不讲道理（这种情况并不经常发生，但偶尔会发生——也许公司需要在月底前推出一款杀手级应用来避免倒闭），准备好你的简历，以备不时之需- 组织变动（取决于你工作的地方有多大）。对该订单的不切实际的期望可能是组织绝望或故障的迹象，而您的职位可能在 3 个月后根本不存在。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T05:05:48.430

1.  不要恐慌。你可能误解了老板的目标。如果只说“宁样”，他好像也不是很清楚。

2.  研究宁。宁能做*什么*？在 Ning 的[资源](http://help.ning.com/cgi-bin/ning.cfg/php/enduser/home.php?p_sid=sLZEqwwj)链接上，他们列出了至少 21 个主要的社交网络功能。

3.  为这个项目写一份高层次的目标陈述。包括 Ning 列出的所有功能。还包括这个应用程序应该服务多少用户的目标。不要试图去想如何解决这些目标目标，或者需要多少程序员或者需要多长时间。只需列出它们。把这篇文章写到一两页。

4.  向你的老板展示这份清单。问他，“这听起来像你的想法吗？” 问几个直接的问题，以确保他看过你的文章：

    *   “这个应用程序的目标用户是谁？”
    *   “您希望每月有多少新用户注册？”
    *   “我们需要支持什么水平的正常运行时间？”
    *   “我们托管这项服务的预算是多少？”
    *   “你需要这个应用程序来支持国际用户吗？”
    *   “此应用程序的最终用户许可协议 (EULA) 是什么？”
5.  此时可能会很清楚，你的老板的目标比你想象的要温和。或许他并不打算*复制*宁的所有能力和规模。所以接下来的任务就是让你的老板更清楚地表达他需要 Ning 的哪些*特征*或能力。

6.  安装[Drupal](http://drupal.org/)、[Joomla](http://www.joomla.org/)或[Wordpress](http://wordpress.org/)，下载一些插件，并为你的老板设计一个自定义网站。这可能会给他 99% 的他想要的东西，而且这是你在一个月内能够做到的唯一方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-29T04:09:13.370

不要一开始就说“不”或“不能完成”或“太难了”或您在帖子中所说的任何其他内容。公司中的大多数经理甚至还没有开始了解编程项目所涉及的工作量，并且需要对他们的软件规划估算进行一些教育。

我建议进行一次对话，其中包括以下步骤。

*   估计：审查您认为该项目成功所需的努力程度。确保您已经对任务进行了足够详细的思考，以便您可以回答问题。
*   教育：如果你的老板不明白为什么某事需要花费一定的时间，请尽可能清楚地解释（好的类比往往有帮助，坏的类比可能是毁灭性的）。
*   替代方案：如果您认为有一些中间立场或某些子功能可以满足项目需求，请讨论这些替代方案。 **经理讨厌员工说某事很难或困难，他们想要可行的选择。**
*   对齐：你确定你和你的老板在这个项目上意见一致吗？也许您将其视为一个关键任务软件，而您的老板将其视为对您现有工具的小幅增强。确保你们都有相同的期望；否则，您可能正在计划比所要求的更复杂的软件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T06:39:09.967

我在软件中学到的最重要的事情是如何“推回”。

这并不总是意味着说不。这意味着提供您对新工作的影响的最佳估计。无论你说“是”还是“否”，你都会说，“我们可以做到，但需要 (x, y 和 z 资源)。我认为这需要 (n 天对我来说，n*a 对人 b) 理解问题 b)，但我知道如何处理 (c, d 和 e)。我以前从未解决过问题 b，所以我不知道我对此的估计是否现实。”

“是”和“否”的区别在于成本方程是否可以接受。

任何优秀的经理都会尊重你的分析，质疑你的一些假设，期待一轮重新思考，然后要么接受风险，寻找额外的资源，要么放弃项目。

如果他们说“我明白你在说什么，但无论如何你都必须完成不可能的事情”，开始寻找另一份工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T04:00:09.303

你的老板会不明白真相吗？就跟他聊项目的需求，提什么能做什么不能做什么。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T17:00:21.457

以下是我的计划：

1.  不要惊慌并做出反应 - 告诉您的老板您想审查该请求，并会尽快回复他的问题和疑虑
2.  通过规范（或者如果没有规范，电子邮件或在某处写下请求）并为每次交付创建工作分解结构。这应该做到每个项目都可以理解的程度（用户登录、消息输入等）
3.  对于每个项目，估计工作量和 +/- % amt。基于您的知识、问题、风险等。
4.  在处理任何主要/重要问题的规范时创建一个列表（这针对多少人？这是否包括用户使用 IM 的能力等）

您现在有了一个粗略的时间表、风险评估和问题清单，可以与您的老板一起审查。他会看到你付出了一些努力，可能会让他对复杂性睁开眼睛，并让他相信你不会下意识地做出反应。无论如何，他可能会要求您在他提供的时间范围内完成工作……寻找另一份工作，您至少有一个月的时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T10:10:13.157

你所说的是，你对任务范围和复杂性的看法与你的老板的看法有很大不同。伟大的。

很可能你们都错了：你误解了要求，而老板低估了任务或落入了一厢情愿的陷阱。

**最好**再次与您的老板一起检查要求，共同确定需要交付的内容，并尝试估计交付这些所需的时间和资源。如果在实施中存在盲点，您觉得自己缺乏技能或经验，请明确这一点，并假设您将花费现金从外部采购这些盲点（这至少会让您了解市场价格） .

我敢肯定，你和你的老板花在讨论和研究项目上的时间越长，讨论就会越详细，对可行的想法就越有把握。

**你能做**的最糟糕的事情就是保持安静。**任何优秀的老板都依赖开发人员对项目进行一些评估：要么是肯定的，要么听到更多的问题。**

 **你不必说“不”，决定是否继续前进不是你的工作，但你必须提出好的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T04:03:20.950

这实际上取决于您与老板的关系。如果可以的话，我会对他们开诚布公。告诉他们一些事情超出了您的专业水平，您将不得不做一些研究，从而延长项目时间。并强调一点，你不相信你可以在一个月内完成它，并且你正在请求一个团队来提供帮助。

您的老板可能并不真正了解项目的全部范围。如果您可以将其分解为任务列表或部分以显示真正需要投入多少工作，他们可能会看到您来自哪里。

最后，如果你的老板仍然希望你完成它，只需不断强调你会尽力而为，但你不能对截止日期做出任何承诺。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T04:03:31.153

你需要对你的老板现实一点。在项目上过度交付而不是在激进的时间表上交付不足，你会表现得更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T04:08:37.490

你必须诚实地告诉老板有问题。但是，您需要表明问题的严重程度，这样您就不会听起来像一个无能的人在等待粉单。

你需要仔细分析要做什么，把它分解成小部分，看看哪些你能做，哪些你不能。项目中有一些看起来可行但很难做到的部分是很正常的——每个正常的老板都明白这一点。

通过这种方式，您可以表明问题不是虚构的，也不是您希望为微不足道的工作获得丰厚的薪水。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-29T04:10:17.970

事实当然总是正确的答案，你的老板最终会发现的，最好早点失败。

但是话虽如此，这是你不想参与的事情吗？确保你向你的老板解释你不想承诺你肯定会失败的事情，但让他知道它可能是一种学习体验，至少在某种程度上参与其中，即使是在完成后查看解决方案。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-29T04:13:22.970

创建一个现实的时间表并将其呈现给你的老板。向你的老板询问他对日程安排的意见。保持积极的态度，让他知道你们都在朝着同一个最终目标努力。告诉他，这是您对满足所有要求所需工作量的最佳专业估计。如果遇到挑战，请指出复杂性在哪里。要坚定和清晰，最重要的是让他有机会说出他的担忧。表现出良好的听力技巧，并以他感觉舒适的语言解决他提出的每一个问题。祝大家在项目中取得成功。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-29T04:21:02.530

如果还没有估算，那么您的首要任务是进行现实的项目估算。第二个任务是检查项目需要哪些技术，并检查知识是否已经可用。如果没有，那么估计培训并获得知识。我知道老板就是老板，但你尽自己的一份力，休息由他决定。如果老板欣赏别人的意见，他会理解，但如果他喜欢“我永远是对的”，那么你就尽你所能（尽你所能，同时寻找新工作）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-08T17:50:21.487

它与我在这里看到的所有好建议有点不同，但我还是要说：大多数经理实际上都很聪明。我遇到的高级管理人员都非常聪明。问题在于，正如 Eric Raymond 所说，它们是“[不同优化](http://linuxmafia.com/faq/Linux_PR/effective-advocacy.html)的”。所以他们可能需要一些教育。如果您认为一旦他们知道所有事实后他们会是合理的，那么您几乎总是正确的。

当然，你偶尔会遇到行为不合理的人，或者认为像皮卡德船长那样说“让它如此”是领导力。但它们很少见，而且不会持续很长时间。

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2009-04-29T13:07:41.733

去搏击俱乐部对付他？获得免费资金和机票！

# curl - 如何让 curl 忽略代理？

> ID：800805
> 
> 赞同：146
> 
> 时间：2009-04-29T03:56:07.753
> 
> 标签：curl

如何让 curl 忽略代理？设置 $NO_PROXY 似乎对我不起作用。

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2012-05-21T17:35:44.637

如果您`curl`至少是 version [`7.19.4`](http://curl.haxx.se/changes.html#7_19_4)，则可以只使用该`--noproxy`标志。

```
curl --noproxy '*' http://www.stackoverflow.com 
```

从[手册](http://curl.haxx.se/docs/manual.html)。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2013-07-17T21:45:54.743

我遇到了同样的问题，因为我设置了 http_proxy 和 https_proxy 环境变量。但有时，我连接到不同的网络，需要暂时绕过代理。最简单的方法（不更改环境变量）是：

```
curl --noproxy '*' stackoverflow.com 
```

来自手册：*“唯一的通配符是单个 * 字符，它匹配所有主机，并有效地禁用代理。”*

* 字符被引用，这样它就不会被 shell 错误地扩展。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2009-04-29T04:54:14.353

我假设 curl 正在从环境变量中读取代理地址，`http_proxy`并且该变量应保持其值。然后在像 bash 这样的 shell 中，`export http_proxy='';`在命令（或在 shell 脚本中）临时更改其值之前。

（有关它查看的所有变量，请参阅 curl 的手册，在`ENVIRONMENT`标题下。）

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2018-08-30T10:47:40.413

这很好用，将代理字符串设置为“”

```
curl -x "" http://www.stackoverflow.com 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2017-10-20T12:17:19.280

将您的代理首选项添加到[.curlrc 或 _curlrc (windows)](https://curl.se/docs/manual.html#config-file)

```
proxy = 1.2.3.4
noproxy = .dev,localhost,127.0.0.1 
```

这使得所有开发域和本地机器请求都忽略代理。

请参阅同一页面上的手册页[代理](https://curl.se/docs/manpage.html#-x)和 noproxy。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-04-29T04:17:41.523

远射，但尝试将代理设置为“”（空字符串），这应该根据手册页覆盖任何代理设置。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-05-12T16:05:46.753

您应该使用`$no_proxy`env 变量（小写）。有关示例，请参阅[https://wiki.archlinux.org/index.php/proxy_settings](https://wiki.archlinux.org/index.php/proxy_settings)。

另外，很久以前 curl 有一个错误[http://sourceforge.net/p/curl/bugs/185/](http://sourceforge.net/p/curl/bugs/185/)，也许您正在使用包含此错误的古老 curl 版本。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-03-13T12:46:29.877

首先，我列出了当前的代理设置

```
env | sort | less 
```

（应该是这样的`http_proxy=http://wpad.local.machine.location:port number`）

然后我尝试设置

```
export http_proxy=";" 
```

这给出了这个错误信息：

```
curl: (5) Couldn't resolve proxy ';' 
```

试过了

```
export http_proxy="" && curl http://servername:portnumber/destinationpath/ -d 55 
```

它奏效了！

PS！请记住将 http-proxy 设置回其原始设置

```
export http_proxy=http://wpad.local.machine.location:port number 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-09-28T20:58:27.753

我有`http_proxy`并且`https_proxy`被定义了。我不想重新设置并重新设置这些环境**，但** `--noproxy '*'`对我来说非常适合。

```
curl --noproxy '*' -XGET 172.17.0.2:9200
{
  "status" : 200,
  "name" : "Medusa",
  "cluster_name" : "elasticsearch",
  "version" : {
    "number" : "1.5.0",
    "build_hash" : "544816042d40151d3ce4ba4f95399d7860dc2e92",
    "build_timestamp" : "2015-03-23T14:30:58Z",
    "build_snapshot" : false,
    "lucene_version" : "4.10.4"
  },
  "tagline" : "You Know, for Search"
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-02-17T15:31:33.063

如果是窗户：使用`curl --proxy "" ...`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-03-06T02:50:05.357

在我的情况下（macos，`curl 7.54.0`），我设置了以下代理`~/.bash_profile`

```
$ env |grep -i proxy |cut -d = -f1|sort
FTP_PROXY
HTTPS_PROXY
HTTP_PROXY
NO_PROXY
PROXY
ftp_proxy
http_proxy
https_proxy
no_proxy 
```

由于未知原因，此版本`curl`无法正常使用环境变量`NO_PRXY`，`no_proxy`然后我一个一个取消设置代理环境变量，直到两者都`HTTPS_PROXY`和`https_proxy`.

```
unset HTTPS_PROXY
unset https_proxy 
```

它开始工作并可以连接到内部 url

因此，如果您的环境中有临时解决方案，我建议您取消设置所有代理变量。

```
unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-08-14T12:02:45.577

蹩脚的答案但是：请记住确保`~/.curlrc`文件中没有设置代理（...）。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-08-06T16:30:52.163

在我设置“no_proxy”（小写）环境变量之前，我的 curl 没有忽略 Ubuntu 12.04 上的代理。--noproxy 选项不可用。

# shell - 屏幕打开时无法重置我的终端

> ID：800806
> 
> 赞同：0
> 
> 时间：2009-04-29T03:56:12.293
> 
> 标签：shell

我的 .zshrc 中有以下内容

```
if [[ $STY = '' ]] then screen -xR; fi 
```

我对我的 .zshrc 做了一些更改。

我运行失败以查看更改

```
reset 
```

我还没有成功地重新启动我的 shell 以查看更改。这表明我需要以某种方式重新启动屏幕。

**如何重新启动屏幕**以便我看到 .zshrc 中的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T03:58:42.130

*源〜/ .zshrc*

也可能是*killall screen*，然后重新启动 screen ？

# c# - 使用 C# 的 PDF 和图形

> ID：800808
> 
> 赞同：5
> 
> 时间：2009-04-29T03:58:16.750
> 
> 标签：c#, .net, pdf

我正在使用 c# 语言在 .net 中开发 Windows 服务。该服务必须生成 PDF 格式的报告。报告中应该有图表。我想知道我们如何创建 PDF 文件并在其中添加图形。

谢谢，P.Gopalakrishnan

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T10:46:45.747

如果您愿意花一些钱，我建议您从[websupergoo 访问 ABCPDF.Net](http://www.websupergoo.com/products.htm#pd)。包含大量示例，API 易于使用。

对于图表，如果您愿意使用 .Net 3.5，请查看[System.Web.DataVisualization](http://www.microsoft.com/downloads/details.aspx?FamilyID=130f7986-bf49-4fe5-9ca8-910ae6ea442c&displaylang=en)命名空间。它提供了 Dundas Charts Professional 版的所有功能。您可能还想看看[zedgraph](http://zedgraph.org/wiki/index.php?title=Main_Page)

问候，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-07T10:39:13.047

我正在使用[PDFsharp](http://www.pdfsharp.com/PDFsharp/) .，这是一个开源项目。它支持图表，也许它还支持您需要的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:12:47.383

最好是您可以使用水晶报表，在水晶报表上创建图表，然后将其导出为 pdf

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T04:39:13.640

我已经使用这个商业的[websupergoo](http://websupergoo.com/) API 来生成 PDF，而且操作起来非常简单。值得花的每一分钱。

对于图表，您可以实现以下任何控件：

*   [免费和开源](http://www.codeproject.com/KB/custom-controls/webchart.aspx)
*   [点网图](http://www.dotnetcharting.com/)
*   [邓达斯](http://www.dundas.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-07T10:35:38.670

我很高兴使用 Stimulsoft 报告引擎。支持图表和PDF输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T05:25:59.130

出于图表的目的，本周我遇到了[FF Chartwell 字体](https://www.fontfont.com/how-to-use-ff-chartwell)，这似乎是个好主意。从图表的角度来看，可能会做你想做的事，虽然我还没有尝试过。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-20T20:11:45.883

我认为最快的方法是在 html 中创建报告，然后将其转换为 pdf。您可以使用[phantomjs](http://phantomjs.org)或[jsreport](http://jsreport.net)将 html 转换为 pdf，包括所有图表。例如，可以使用[jquery flot](http://www.flotcharts.org/)来完成图表。这是可能的，因为提到的两种技术也都在解释 javascript。

查看我[在 c# 中发布的 pdf 报告，](http://jsreport.net/blog/pdf-reports-in-csharp)或者更具体地说，查看 pdf 报告中的发布[图表](http://jsreport.net/blog/charts-in-pdf-reports)。

免责声明：我是jsreport的作者

# twitter - Twitter oAuth callbackUrl - 本地主机开发

> ID：800827
> 
> 赞同：112
> 
> 时间：2009-04-29T04:04:28.560
> 
> 标签：twitter, oauth

是否有其他人很难让 Twitters oAuth 的回调 URL 访问他们的 localhost 开发环境。显然它最近已被禁用。[http://code.google.com/p/twitter-api/issues/detail?id=534#c1](http://code.google.com/p/twitter-api/issues/detail?id=534#c1)

有没有人有解决方法。我真的不想停止我的发展

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-08-17T18:45:01.580

**备选方案 1。**

设置您的 .hosts (Windows) 或 etc/hosts 文件以将活动域指向您的本地主机 IP。如：

> 127.0.0.1 xyz.com

其中 xyz.com 是您的真实域。

**备选方案 2。**

此外，文章还提供了使用 URL 缩短服务的提示。缩短您的本地 URL 并将结果作为回调提供。

**备选方案 3。**

此外，它似乎可以提供例如`http://127.0.0.1:8080`对 Twitter 的回调，而不是`http://localhost:8080`.

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-01-04T23:55:08.227

我上周不得不这样做。显然`localhost`不起作用，但`127.0.0.1`Go 数字。

这当然假设您在 Twitter 上注册了两个应用程序，一个用于直播`www.mysite.com`，另一个用于`127.0.0.1`.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-02-25T13:43:53.367

只需将[http://127.0.0.1:xxxx/](http://127.0.0.1:xxxx/)作为回调 url，其中 xxxx 是您的框架的端口

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-03T16:30:49.263

是的，由于最近在 OAuth 中发现的安全问题，它已被禁用。目前唯一的解决方案是创建两个 OAuth 应用程序 - 一个用于生产，一个用于开发。在开发应用程序中，您设置 localhost 回调 URL 而不是实时的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-12-29T14:19:56.047

回调 URL 已修改

```
http://localhost:8585/logintwitter.aspx 
```

转换成

```
http://127.0.0.1:8585/logintwitter.aspx 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-09-20T19:27:19.497

使用[http://smackaho.st](http://smackaho.st)

它所做的是与 127.0.0.1 的简​​单 DNS 关联，它允许您绕过 localhost 或 127.0.0.1 上的过滤器：

> smackaho.st. 28800 在 127.0.0.1

因此，如果您单击该链接，它将显示您在本地网络服务器上拥有的内容（如果您没有，则会收到 404）。您当然可以将其设置为您想要的任何页面/端口：

[http://smackaho.st:54878/twitter/callback](http://smackaho.st:54878/twitter/callback)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-05-09T12:54:30.107

我就是这样做的：

注册回调地址：http: [//127.0.0.1/Callback.aspx](http://127.0.0.1/Callback.aspx)

```
 OAuthTokenResponse authorizationTokens = 
        OAuthUtility.GetRequestToken(ConfigSettings.getConsumerKey(), 
                                     ConfigSettings.getConsumerSecret(), 
                                     "http://127.0.0.1:1066/Twitter/Callback.aspx"); 
```

配置设置：

```
public static class ConfigSettings
{
    public static String getConsumerKey()
    {
        return System.Configuration.ConfigurationManager.AppSettings["ConsumerKey"].ToString();
    }

    public static String getConsumerSecret()
    {
        return System.Configuration.ConfigurationManager.AppSettings["ConsumerSecret"].ToString();
    }

} 
```

网络配置：

```
<appSettings>

    <add key="ConsumerKey" value="xxxxxxxxxxxxxxxxxxxx"/>
    <add key="ConsumerSecret" value="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"/>

</appSettings> 
```

确保将项目的“使用动态端口”属性设置为“假”并输入静态端口号。（我用的是 1066）。

我希望这有帮助！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-01-17T10:04:16.670

我在本地主机上使用 Twitter 回调 url。如果您不确定如何创建虚拟主机（这很重要），请使用 Ampps。他真的很酷很容易。只需几个步骤，您就拥有了自己的虚拟主机，然后每个 url 都可以在上面运行。例如：

1.  下载并安装amps

2.  添加新域。（在这里您可以设置例如 twitter.local），这意味着您的虚拟主机将是[http://twitter.local](http://twitter.local)，它将在第 3 步之后工作。

3.  我正在开发 Win，所以转到您的主机文件 -> C:\Windows\System32\Drivers\etc\hosts 并添加行：127.0.0.1 twitter.local

重新启动您的 Ampps，您就可以使用您的回调了。你可以指定任何 url，即使你正在使用一些框架 MVC 或者你有 htaccess url 重写。

希望这有帮助！干杯。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-05-22T22:03:16.717

当我在本地开发时，我总是设置一个本地托管的开发名称来反映我正在从事的项目。我通过 xampp\apache\conf\extra\httpd-vhosts.conf 在 xampp 中设置它，然后在 \Windows\System32\drivers\etc\hosts 中进行设置。

因此，如果我正在为 example.com 设置本地开发站点，我会在这两个文件中将其设置为 example.dev。

**简短回答：**一旦正确设置，您可以在设置 Twitter 应用程序时简单地将此 url ( [http://example.dev](http://example.dev) ) 视为实时（而不是本地）。

这里给出了类似的答案：[https ://dev.twitter.com/discussions/5749](https://dev.twitter.com/discussions/5749)

直接报价（强调）：

> 您可以在应用程序详细信息页面上提供具有我们识别的域名的任何有效 URL。OAuth 1.0a 要求您在流程的请求令牌步骤中发送 oauth_callback 值，*我们将在该步骤中接受基于**动态 locahost 的回调***。

这对我来说就像一个魅力。希望这可以帮助。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-08-12T21:34:41.870

[使用Fiddler](http://www.telerik.com/download/fiddler)可以非常方便地完成它：

*   打开菜单**工具 > 主机...**
*   插入一行`127.0.0.1 your-production-domain.com`，确保选中“启用请求重新映射...”。别忘了按`**Save**`。
*   如果需要访问您的真实生产服务器，只需退出 Fiddler 或禁用重新映射。
*   再次启动 Fiddler 将打开重新映射（如果已选中）。

一个令人愉快的好处是您可以指定一个自定义端口，如下所示：（ `127.0.0.1:3000 your-production-domain.com`通过主机文件实现这一点是不可能的）。此外，您可以使用任何域名（例如`localhost`）代替 IP。

这样，可以（但不是必须）只注册一次 Twitter 应用程序（前提是您不介意在本地开发和生产中使用相同的密钥）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-09-11T06:56:13.700

**在TwitterAPIExchange.php上的****第 180**行编辑此函数

 **```
public function performRequest($return = true)
{
    if (!is_bool($return)) 
    { 
        throw new Exception('performRequest parameter must be true or false'); 
    }

    $header = array($this->buildAuthorizationHeader($this->oauth), 'Expect:');

    $getfield = $this->getGetfield();
    $postfields = $this->getPostfields();

    $options = array( 
        CURLOPT_HTTPHEADER => $header,
        CURLOPT_HEADER => false,
        CURLOPT_URL => $this->url,
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_SSL_VERIFYPEER => false,
        CURLOPT_SSL_VERIFYHOST => false
    );

    if (!is_null($postfields))
    {
        $options[CURLOPT_POSTFIELDS] = $postfields;
    }
    else
    {
        if ($getfield !== '')
        {
            $options[CURLOPT_URL] .= $getfield;
        }
    }

    $feed = curl_init();
    curl_setopt_array($feed, $options);
    $json = curl_exec($feed);
    curl_close($feed);

    if ($return) { return $json; }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-12-01T15:41:41.360

我遇到了同样的挑战，我无法将 localhost 作为有效的回调 URL。所以我创建了一个简单的域来帮助我们开发人员： [https ://tolocalhost.com](https://tolocalhost.com)

它会将任何路径重定向到您需要的本地主机域和端口。希望对其他开发者有用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-07-27T17:09:36.367

似乎现在`http://127.0.0.1`也停止了工作。一个简单的解决方案是使用它`http://localtest.me`而不是`http://localhost`它总是指向`127.0.0.1`你甚至可以向它添加任意子域，它仍然会指向`127.0.0.1`

见[网站](http://readme.localtest.me/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-01-15T18:26:12.853

在 twitter 应用程序中设置 callbackurl：127.0.0.1:3000 并将 WEBrick 设置为绑定 127.0.0.1 而不是 0.0.0.0

命令：rails s -b 127.0.0.1

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-11-21T07:07:56.853

看起来 Twitter 现在允许`localhost`与`Callback URL`设置中的任何内容一起使用，只要那里有一个值。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-08-14T09:14:48.383

我为此苦苦挣扎并遵循了十几个解决方案，最后我所要做的就是使用本地主机上的任何 ssl api：

去下载：[cacert.pem 文件](https://codeload.github.com/VersatilityWerks/5719158/zip/master)

在`php.ini`* 中取消注释并更改： `curl.cainfo = "c:/wamp/bin/php/php5.5.12/cacert.pem"`

*   您可以通过在 CLI 中运行来找到`php.ini`文件在计算机上的位置`php --ini`
*   为方便起见，我将 cacert.pem 放在与 php.ini 相同的目录中。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-09-13T20:39:56.140

这些是让 Facebook 在我的笔记本电脑上使用本地应用程序工作的步骤：

*   转到apps.twitter.com
*   输入名称、应用程序描述和您的站点 URL 注意：对于 localhost:8000，请使用 127.0.0.1:8000，因为前者不起作用
*   输入与您的应用程序 TWITTER_REDIRECT_URI 中定义的回调 URL 匹配的回调 URL 注意：例如：http: [//127.0.0.1/login/twitter/callback](http://127.0.0.1/login/twitter/callback)（localhost 将不起作用）。
*   *如果您希望请求用户的电子邮件地址，请*务必输入“隐私政策”和“使用条款”网址**
**   选中同意条款复选框*   单击 [创建您的 Twitter 应用程序]*   切换到顶部的 [Keys and Access Tokens] 选项卡*   将“Consumer Key（API Key）”和“Consumer Secret（API Secret）”复制到您的应用程序中的TWITTER_KEY和TWITTER_SECRET*   单击“权限”选项卡并适当设置为“只读”、“读写”或“读、写和直接消息”（使用您的应用程序所需的侵入性最小的选项，因为 OAuth 登录“只读”是充足的*   如果您希望将用户的电子邮件地址返回到 OAuth 登录数据中，请在“附加权限”下选中“向用户请求电子邮件地址”复选框（在大多数情况下选中是）*

 *# c# - 当 Windows XP 使屏幕变灰时如何通知我？

> ID：800831
> 
> 赞同：2
> 
> 时间：2009-04-29T04:07:16.650
> 
> 标签：c#, wpf

我们有一个用 C# 和 WPF (.NET Framework 3.0) 开发的应用程序

主窗口有一个玻璃边框，一个包含 WebBrowser 的子窗口居中：

```
WPF main window 
  -> Child window - frame control 
    -> Page 
      -> WindowsFormsHost
        -> WebBrowser 
```

因为我们使用的是.NET 3.0，所以我们必须把WebBrowser放在WindowsFormsHost中，如果我们将窗口属性AllowTransparency设置为true，它就无法显示。

现在，在 Windows XP 上，当用户单击“开始”菜单上的“关闭”按钮时，会显示一个对话框，其中包含各种选项（关闭、重新启动等），而在它后面，整个桌面似乎从颜色变为灰色阴影。发生这种情况时，我们的主窗口将被隐藏，而页面窗口仍显示在屏幕上。

我们已经将页面窗口的所有者设置为主窗口，但这并没有帮助。因此，我得出的结论是，我必须拦截“变灰”事件并……做一些事情来减轻这种丑陋。那么：有谁知道我如何允许我的程序在变灰之前得到通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T10:51:43.947

据我所知，当 Windows 将屏幕变为灰色时，无法收到通知。System.SystemEvents 类也没有这样的事件。

# python - 带有用于 wxPython 或 Tkinter 的 GUI 设计器的漂亮 IDE

> ID：800849
> 
> 赞同：42
> 
> 时间：2009-04-29T04:17:25.923
> 
> 标签：python, user-interface, ide, wxpython, tkinter

我有一点用 Python 开发小型命令行应用程序的经验。我想继续使用 Python 开发 GUI。在 Python 可用的 GUI 工具包中，我觉得最倾向于*wxPython*和*Tkinter*的工具包；但我不想一直自己编写所有的 GUI。

这些工具包中是否有任何好的 GUI IDE？它不需要是免费的或开源的。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-29T06:48:04.347

我将只讨论 WxPython，因为它是我使用过的唯一工具包。TkInter 很适合编写小程序（然后它不需要 GUI 设计器），但并不适合大型应用程序开发。

*   [wxFormBuilder](http://wxformbuilder.org)真的很不错：它会生成`.XRC`你需要加载到你的程序中的文件，并且它可以`.py`在你使用的时候通过子类化来生成文件。

*   [DialogBlocks](http://www.dialogblocks.com)和[wxDesigner](https://wiki.python.org/moin/WxDesigner)是两个可以直接生成 Python 代码的**商业软件。**由于它们的价格，我没有对它们进行太多测试。

*   [wxGlade](http://wxglade.sourceforge.net)（我认为）对于大型程序来说还不够成熟，但值得一试。

在尝试了所有这些之后，我意识到它们都有*缺陷*，没有什么比在编辑器中编写 GUI 更好的了。问题在于扩展的学习曲线。但是，与使用 GUI 设计器相比，您的速度会更快，代码也会更灵活。

看看这个用 wxPython 编写[的主要应用程序列表。](http://wiki.wxpython.org/wxPythonPit%20Apps)您可能会看到这些都没有使用 GUI 设计器，这一定是有原因的。

然后你就会明白，当你说你切换到 PyQt 或者你手动编写你的应用程序时，**gs是正确的。**我过去看过 Qt Designer 并认为这是我需要的。不幸的是，PyQt 有一些许可限制。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-29T06:51:27.830

这可能无法直接回答您的问题，但我选择[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro)是因为 wxPython 没有优秀的 UI 设计师。

显然，您要么手动编写 GUI，要么切换到 PyQt。

由于诺基亚和 Riverbankcomputing 无法就 LGPL 解决方案达成一致，诺基亚决定构建自己的绑定：[PySide](https://wiki.qt.io/Category:LanguageBindings::PySide)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-29T19:48:34.110

[Boa Constructor](http://boa-constructor.sourceforge.net/)有一个 WxPython GUI 构建器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T06:52:14.803

我使用 xrced（带有 wxPython）。GUI 是在 xml 文件中定义的，您有一个自动生成的 python 文件，该文件可以自动进行一些初始化，然后您将这些自动生成的类子类化并手动完成其余的初始化。我发现这是将手写 GUI 代码的优雅与 GUI 代码生成的简易性结合起来的好方法。

对于我使用[WingIDE](http://www.wingware.com/)的代码，在处理像 wxPython 这样的大型库（或框架，如果你愿意的话）时，拥有一个好的调试器和好的源代码完成是很有帮助的。

如果您想要更多的自动化（因此，更丑陋的代码）尝试最新版本的[Boa ，在](http://boa-constructor.sourceforge.net/)[ShowMeDo.com](http://showmedo.com/videos/series?name=wKQrywla5)上有一些不错的介绍性截屏视频

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-19T07:27:39.393

我使用 Eclipse 和 PyDev 作为我的 Python IDE（这可能不是最好的解决方案，但它相当不错）

对于 GUI 开发，我在一个中型项目中使用了 wxGlade，发现它非常容易使用，您已经掌握了 WxPython 的概念。XML 生成对于将实际的 GUI 设计与程序逻辑分开非常有用。

所有这些都是免费的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T19:39:42.400

试试[VisualWx](http://visualwx.altervista.org/)。我觉得 GUI 设计师很好；但是 IDE 相当简陋（没有代码完成、调试等）。我的工作模式是拥有 VisualWx 和像 Komodo Edit/Netbeans/etc 这样的优秀编辑器。同时打开并根据需要在它们之间切换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T06:51:16.990

我已经将 wxGlade 用于一些关键任务应用程序。如果你在 wx 方面有点薄弱，它可能会很粗糙，但是一旦你习惯了它，它就是一个很棒的工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-27T12:19:52.117

不是真正的 GUI IDE，但它引导您在 JSON 文件中定义 Tkinter GUI：[https ://github.com/tmetsch/pytkgen](https://github.com/tmetsch/pytkgen)

# javascript - 面向对象的Javascript

> ID：800856
> 
> 赞同：5
> 
> 时间：2009-04-29T04:22:35.710
> 
> 标签：javascript

在编程过程中，我们会遇到大型 javascript 文件，这些文件是开源的并以面向对象的方式（如 JQuery）编写。

如果我们需要修改这些文件，我们必须对成员和流程有基本的了解。如果我们有多个文件，那么任务就困难得多。

我从哪里开始得到这个流程？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T04:43:02.243

首先我认为你必须了解 JavaScript 面向对象是如何工作的，JavaScript OO 是[基于原型的](http://en.wikipedia.org/wiki/Prototype-based_programming)，其中不存在*类*，行为重用是通过原型实现的。

我已经看到，对于那些一直在使用传统的基于类的面向对象语言（如 C++、C#、Java 等）的程序员来说，一开始很难理解这一点。

推荐文章：

*   [面向对象 JavaScript 简介](https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript)
*   [JavaScript：世界上最容易被误解的编程语言](http://javascript.crockford.com/javascript.html)
*   [JavaScript 中的经典继承](http://javascript.crockford.com/inheritance.html)
*   [JavaScript 中的私有成员](http://www.crockford.com/javascript/private.html)
*   [基于类与基于原型的语言](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide:Class-Based_vs._Prototype-Based_Languages)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T04:36:01.167

我会做两件事：

1.  读。如果有文档文件，请阅读它们。如果有评论，请阅读。如果这些都对您没有帮助，请转到源代码并阅读。

2.  当您谈论开源 Javascript 时，我假设您的意思是这个 JS 被收集到某种项目中；所有客户端 JS 都是开源的：P。在这种情况下，作者可能愿意告诉你他们的代码。在项目页面上找到他们的电子邮件，并要求他们为您提供代码的高级概述，以便您可以开始阅读并自己理解它。他们可能不愿意在整个过程中牵着你的手，但以此为起点可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T07:45:40.307

我有一份

*   [Javascript：好的部分](http://oreilly.com/catalog/9780596517748/)

和

*   [Javascript：权威指南](http://oreilly.com/catalog/9780596000486/)

现在坐在我的桌子上。顺便说一句，这是 Douglas Crockford 认为好的仅有的两本 Javascript 书籍；）

他们将教你 Javascript 是如何工作的，特别是它的对象模型与大多数（但不是全部）其他面向对象的语言有何不同。

除此之外，请查看[Crockford 网站上的所有文章](http://javascript.crockford.com/)，正如其他答案中已经提到的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T04:40:58.393

我同意 allyourcode 没有魔术。您必须阅读代码并阅读文档。如果文档不好，也许你应该考虑使用不同的框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T04:43:22.413

一个好的开始是了解传统 OO 和 Javascript 的原型模型之间的区别。（Crockford 有一些[文章](http://javascript.crockford.com/)为 Javascript 实现了传统的 OO 以对比行为。）

# directory - 文件夹隐藏软件如何工作？

> ID：800857
> 
> 赞同：1
> 
> 时间：2009-04-29T04:22:47.783
> 
> 标签：directory, hide

最近几天我一直在构建一个隐藏文件夹的应用程序（感谢此类软件的付费版本）。经过大量的谷歌搜索后，我找到了一些 shell 脚本，该脚本首先创建一个文件夹，然后将该文件夹重命名为“控制面板。{21EC2020-3AEA-1069-A2DD-08002B30309D}”。然后它会使用命令 attrib -s -h Control Panel.{21EC2020-3AEA-1069-A2DD-08002B30309D} 隐藏此文件夹。这背后的基础是使其成为系统文件夹并将其隐藏。但是，如果您取消选中在文件夹中隐藏系统文件夹选项，控制面板将变为可见。我想让这个文件夹完全不可见，就像其他文件夹保护软件一样。

有人可以对此有所了解吗？

万分感谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T04:30:20.510

您要求的是 rootkit，在某些国家/地区被认为是不道德的，甚至是非法的。虽然我目前缺乏对你投反对票的声誉，但我希望有人能结束这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T04:33:27.477

大多数文件夹隐藏软件通过实现 Windows 资源管理器的扩展或文件系统过滤器驱动程序来工作。

第一种方法意味着在通过 UI 浏览 Windows 中的文件夹时某些项目将不可见，但其他软件和命令提示符仍然可以看到某些项目。例如，回收站和 Internet 临时文件文件夹就是这样工作的。

文件系统过滤驱动方法代理 Windows 和底层文件系统之间的调用，只允许某些请求通过。这类似于病毒扫描程序阻止访问受感染文件的方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T04:36:37.657

一般的想法是你挂钩文件系统 API 并过滤掉你想要隐藏的文件系统条目。

但是 JelloMonkey 是对的 - 这是 Rootkit 行为，您将被这种行为的 rootkit 检测器标记为恶意。这可能会使您的整个目录被隔离或删除。

# qt - 垂直滚动条向上滚动-向下滚动图像在 Qtopia 机器上看起来参差不齐

> ID：800866
> 
> 赞同：0
> 
> 时间：2009-04-29T04:25:24.797
> 
> 标签：qt

我正在尝试在我的 Qt 项目中使用垂直滚动条。问题是当垂直滚动条使用 Cleanlooks 小部件样式时，它在运行 Qt-4.3.3 的 Linux Ubuntu 机器上看起来没问题。但是，当我在 Qtopia-4.3.3 Linux(ARM) 机器上运行相同的项目时，向下滚动和向上滚动的图像看起来完全是锯齿状的。他们，看起来很糟糕。我尝试使用样式表，但没有运气。任何有关使用样式表的建议都非常受欢迎。有什么办法可以克服这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T14:49:46.723

在我对嵌入式平台样式的相对较少的经验中，一些样式的设计使它们将图像用于某些事物，并根据需要对其进行缩放。如果源很小而目标很大，这会产生非常参差不齐的图形。一种可能性是`QStyle`从 Cleanlooks 样式继承您自己的样式，并使用您自己的绘图代码覆盖箭头图像的绘制。在代码中绘制正确的箭头应该不会太难，而不是使用图像。

# c# - 托管 CLR 与使用 ClrCreateManagedInstance - 有什么好处？

> ID：800867
> 
> 赞同：2
> 
> 时间：2009-04-29T04:25:29.727
> 
> 标签：c#, .net, delphi, interop

我已经成功地实现了 Win32 应用程序和托管 .Net dll 之间的互操作，如此处[所述](https://stackoverflow.com/questions/787303/how-to-use-net-assembly-from-win32-without-registration)。[但我也在这里](https://stackoverflow.com/questions/258875/hosting-the-net-runtime-in-a-delphi-program)读到，可以将整个 CLR 托管在非托管进程中。

所以我的问题是：你为什么要这样做？它比仅仅使用一个对象要复杂一些——以这种增加复杂性的代价，您可以获得什么好处？

编辑：我从 2 个第一个答案中了解到，您可以根据需要自定义 CLR - 这意味着如果您正在编写一个简单的商业应用程序，您将永远不需要托管。托管适用于系统重的东西，例如浏览器或 SQL Server。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T00:14:07.847

托管 CLR 通常不是您在托管代码和 Win32 之间进行互操作的事情。互操作一般有3种方法：

*   运行时可调用包装器 (RCW) - 从 .NET 调用 COM 对象
*   COM Callable Wrapper (CCW) - 使 .NET 对象显示为 COM 对象
*   P/调用

从 .NET 的第一个版本开始就支持这些。托管 CLR 的全部意义在于允许您将 .NET 代码深度嵌入到非托管应用程序中。例如，有一个模块可以在 Win32 上的 Apache 中托管 .NET，从而允许它运行 .aspx 页面。

同样，SQL Server 想要一种方法让人们使用托管代码编写扩展的存储过程和函数。过去你可以用 C/C++ 编写这些，但如果他们托管 CLR，他们实际上可以允许人们用 C# 编写这些。让 CLR 进入一个可以安全嵌入的状态的工作确实推迟了时间线，因此诞生了诸如对内存和安全性的控制之类的东西。SQL Server 有一些严格的稳定性要求，您不能让 .NET 摇摆不定。

托管 API 从 .NET 1.x 到 2.x 发生了显着变化，但由于 2.0 CLR 经历了 .NET 3.0、3.5 等，因此更加稳定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T08:32:44.360

您可能有一个遗留应用程序，并希望允许第 3 方从您的应用程序中使用 .net 的设施，但特别是以一种受控方式***，例如***控制从何处加载程序集。[这](http://msdn.microsoft.com/en-us/magazine/cc163567.aspx)是一个例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T11:00:31.120

Microsoft SQL Server 广泛使用它来代替安全性、程序集加载、内存管理、线程管理等等。关于这个主题的一本好书是“Customizing the Microsoft .NET Framework Common Language Runtime”。

# zsh - 无法从 Zsh 获取 Google 搜索工作

> ID：800872
> 
> 赞同：0
> 
> 时间：2009-04-29T04:26:37.180
> 
> 标签：zsh

我的.Zshrc 中有以下[代码](https://stackoverflow.com/questions/171563/whats-in-your-zshrc/187853#187853)

```
function google; {
             $VIEW "http://www.google.com/search?q='url-encode "${(j: :)@}"'"
     } 
```

我明白了

```
google masi                                         
google:1: no such file or directory: http://www.google.com/search?q='url-encode masi' 
```

**如何让 Google 搜索在 Zsh 中运行？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T04:38:36.420

以下解决了Mac中的问题

```
function google; {
             open "http://www.google.com/search?q='url-encode "${(j: :)@}"'"
     } 
```

在 Ubuntu 中

```
function google; {
             gnome-open "http://www.google.com/search?q='url-encode "${(j: :)@}"'"
     } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T04:32:38.850

对 zsh 一无所知，但看起来您的报价有问题。

看起来它评估 url 为

```
http://www.google.com/search?q='url-encode masi' 
```

这可能不是你所追求的。（“masi”的 url 编码版本）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T04:29:23.930

$VIEW 的价值是多少？

将其设置为 Web 浏览器或下载器的路径。

# java - DecimalFormat 和双精度数

> ID：800878
> 
> 赞同：0
> 
> 时间：2009-04-29T04:30:20.883
> 
> 标签：java, formatting, double

[DecimalFormat](http://java.sun.com/javase/6/docs/api/java/text/DecimalFormat.html)解析[Double.toString()](http://java.sun.com/javase/6/docs/api/java/lang/Double.html#toString(double))表示（可以是科学和金融格式）。

为什么 Sun 选择了这种方法，而不是直接将 double 转换为 String？

PS：更具体一点。为什么 DecimalFormat 在内部使用 Double.toString() 来格式化 Double，而不是格式化 Double 本身的内部表示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T04:34:32.090

DecimalFormat 通过允许您为其提供格式模式，使您可以更好地控制格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T23:11:08.007

也许 Sun 正在遵循[DRY](http://en.wikipedia.org/wiki/Don't_repeat_yourself)原则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T04:54:26.023

可能他会问像“Double.toString(withSomeParameters)”这样的工作，而不是使用 DecimalFormat。

我认为原因可能是 i18n。在某些地方您可以输入 1,800.39 .. 而在其他地方您可以输入 1.800,39

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T07:49:38.940

我不确定您所说的“直接转换”是什么意思，但`toString()`始终只是调试信息！您不应该使用它在前端显示值。用于`DecimalFormat`解析和格式化！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-29T09:04:01.117

对于*金融*应用程序，请改用 BigDecimal，它可以让您控制舍入模式和精度。

# regex - 正则表达式对 Web 设计师 (XHTML/CSS) 有用吗？

> ID：800881
> 
> 赞同：1
> 
> 时间：2009-04-29T04:31:47.120
> 
> 标签：regex

正则表达式对 Web 设计师 (XHTML/CSS) 有用吗？如果网页设计师学习正则表达式，他们可以获得任何帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T04:36:52.133

任何定期使用文本文件的人（包括所有程序员）都可以从学习正则表达式中受益。它们使查找和替换任务变得更加容易，并为您节省大量手动编辑。几乎所有的文本编辑程序都支持正则表达式搜索。

如果您所做的只是 HTML 和 CSS，您将无法在代码中使用它们。但是如果您开始使用 JavaScript，您会发现它们对于测试输入字段的值等事情很有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T04:32:22.737

是的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T04:32:40.397

除其他外，它非常适合**验证输入**和**清理 html**

即使您不直接使用它们，RegExes 也是一种思考操作文本的方式，这些年来证明对我来说非常有价值，从我第一个有钱用 PERL 编写的项目到我今天在 .NET 中做的事情

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T04:40:38.333

正则表达式不是 (X)HTML 或 CSS 的一部分，但它们是您可能会与它们一起使用的工具的一部分：Javascript、XSLT 和任何服务器脚本。

关键是要记住，由于在解析带引号的字符串和 SGML 样式标签的语言时存在困难，因此除非万不得已，否则不应使用正则表达式来解析 (X)HTML。存在标记器，因此您不必做那些特别辛苦的工作。您会发现大多数正则表达式都用于检查和清理输入。

简而言之：是的，但始终使用最好的工具来完成这项工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T08:57:21.350

> 如果网页设计师学习正则表达式，他们可以获得任何帮助吗？

如果您需要一些资源来帮助您使用正则表达式，我发现[MDC 页面上的正则表达式](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide/Regular_Expressions)和[正则表达式备忘单](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)非常有用，并且[正则表达式测试](http://www.regular-expressions.info/javascriptexample.html)器可以方便地测试正则表达式。

史蒂夫

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T04:37:41.443

CSS 对正则表达式有部分支持，因此它们可能在该领域有一些用处。

除此之外，仅当您编写 Javascript 代码时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T04:59:27.303

您在创建 Web 工件（页面、脚本、样式等）时使用了一些语言和协议，并且您可以使用一些工具来操作这些工件（编辑器、实用程序、解释器等）。

正则表达式属于后者，它们属于更高级的幽灵（基于普通网页设计师可能不知道的事实）。但是任何有计算机知识的人都会从学习和使用正则表达式中受益——不仅仅是网页设计师。

任何让你在人群中脱颖而出的东西（当然是积极的）都会让你受益——所以继续学习正则表达式——你不会后悔的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-29T04:33:26.947

不。        

# java - java模拟使用windows身份验证连接到sql server

> ID：800904
> 
> 赞同：0
> 
> 时间：2009-04-29T04:40:19.380
> 
> 标签：java, sql-server, windows, configuration, integrated-security

现在我用经典的asp和visual basic 6构建了以下架构

我有一个用 VB6 开发的 COM+ 组件，它连接到数据库。我通过一个配置了集成安全性的 .udl 文件来设置 DB conf。

在 Web 服务器 (IIS) 上，我使用 com+ 管理器注册组件，并将其配置为在帐户名下运行，例如 mydomain\appAccount...

在 sql 2005 中，我给 mydomain\appAccount 适当的权限

从asp，我只是使用带有server.createobject的组件...

我想用java开发一个类似的解决方案，问题如下：

可能吗？

如何配置域帐户以连接到 sql server 2005 db？

我应该在哪里存储 db conf？我应该在哪里配置域帐户？在 tomcat / jetty 配置中？

我希望解决方案尽可能简单直接（我试图避免使用 glassfish 或 jboss 之类的东西）

嗯，非常感谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-04T12:35:49.423

所以这是一个真正棘手的问题，我现在正在经历同样的问题。我还没有解决应用服务器中的模拟问题，但我的团队正在接近。

到目前为止，我们已经成功地使用 Kerberos 针对域控制器对用户进行身份验证。SourceForge SPNEGO 和 Spring Security Kerberos Extension 在这方面都非常有帮助。在连接到 SQL Server 时，我们还能够成功模拟运行 Java 应用程序的进程。真正的问题是通过委托进行模拟，因为它要求您获得可以委托给另一个服务的 Kerberos 票证。这是我们目前正在处理的问题。

如果要在 SQL Server 中模拟用户，则必须使用 NTLM 或 Kerberos。Kerberos 提供了最好的安全性，老实说，我们甚至都懒得尝试使用 NTLM。有两个 JDBC 驱动程序（我知道）允许您使用域帐户连接到 SQL Server：jTDS 和 DataDirect JDBC。jTDS 是一个 Type-2 JDBC 驱动程序，这意味着它依赖于本地库来为用户获取凭据。jTDS 只会模拟运行该进程的用户，并且不允许您模拟其他帐户（此外，它只能在 Windows 上执行此操作）。DataDirect 驱动程序（商业）是一个 Type-4 驱动程序，这意味着它是一个纯 Java 实现（并且将在 *nix 上工作）。这是我们正在使用的驱动程序，它工作得很好。

如果我得到一个有效的解决方案，我会发布它，因为我认为社区中的很多人都在这个问题上受到伤害。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-18T00:24:18.813

您需要做的是确保 Tomcat JVM 进程正在由具有与数据库的受信任连接的用户执行。

[然后根据Bhushan 的回答](http://#800931)，您需要在 Tomcat 中配置数据源。

以下 MSDN 文章详细介绍了如何设置数据源以使用集成安全性：

*   [http://msdn.microsoft.com/en-us/library/ms378428.aspx](http://msdn.microsoft.com/en-us/library/ms378428.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T04:54:54.553

查看此 tomcat 文档以了解如何配置数据源。 [http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html](http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html)

# blackberry - 黑莓构建配置的默认值应该是什么？[调试、私有或发布]

> ID：800908
> 
> 赞同：1
> 
> 时间：2009-04-29T04:42:01.480
> 
> 标签：blackberry, build

我想知道构建配置的默认值应该是什么？[调试、私有或发布] 1) 在模拟器上本地运行应用程序 2) 在设备/手机上实际部署时生成 cod 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T18:30:43.393

配置不会影响为 BlackBerry 项目生成的代码 - 它只会影响激活的项目（即在您重建工作区时构建的项目）。所以随心所欲 - 我通常选择一种配置并在整个调试和发布过程中坚持使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T05:26:42.933

我会在开发过程中以调试模式构建，以便您可以单步执行代码。当您进行更正式的测试时，在发布模式下构建可能是有意义的，这样您就可以测试更真实的代码构建。当您部署到设备时，通常最好在发布模式下构建，以确保您的代码经过优化以在设备上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T21:44:21.970

> ## 使用构建配置
> 
> 您可以为您的项目指定多个构建配置。在每个构建配置中，您可以选择处于活动状态的项目。您可以使用此功能创建一组活动项目，以使用 BlackBerry Application 进行构建。

资料来源：
[BlackBerry JDE Plug-in for Eclipse 1.0 版在线帮助](http://na.blackberry.com/eng/deliverables/4240/BlackBerry_JDE_Plug-in_for_Eclipse_Help.pdf)，第 1 章。“构建 BlackBerry 应用程序”

# sql - SQL 按所有列分组

> ID：800910
> 
> 赞同：82
> 
> 时间：2009-04-29T04:42:31.917
> 
> 标签：sql

有没有办法在不指定列名的情况下按表的所有列分组？喜欢：

```
select * from table group by * 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-04-29T05:31:04.250

## DISTINCT 关键字

我相信你想要做的是：

```
SELECT DISTINCT * FROM MyFooTable; 
```

如果您按所有列分组，您只是要求删除重复数据。

例如具有以下数据的表：

```
 id |     value      
----+----------------
  1 | foo
  2 | bar
  1 | foo
  3 | something else 
```

`SELECT * FROM MyFooTable GROUP BY *`如果您执行以下查询，这与假设 * 表示所有列基本相同：

`SELECT * FROM MyFooTable GROUP BY id, value;`

```
 id |     value      
----+----------------
  1 | foo
  3 | something else
  2 | bar 
```

它删除了所有重复值，这在语义上与使用 DISTINCT 关键字基本相同，但结果的排序除外。例如：

`SELECT DISTINCT * FROM MyFooTable;`

```
 id |     value      
----+----------------
  1 | foo
  2 | bar
  3 | something else 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-12T02:26:49.603

他正在尝试在表格中查找并显示重复的行。

```
SELECT *, COUNT(*) AS NoOfOccurrences
FROM TableName GROUP BY *
HAVING COUNT(*) > 1 
```

我们有一个简单的方法来完成这个吗？

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-29T04:58:40.753

如果您使用的是 SqlServer，则 distinct 关键字应该适合您。（不确定其他数据库）

```
declare @t table (a int , b int)

insert into @t (a,b) select 1, 1
insert into @t (a,b) select 1, 2
insert into @t (a,b) select 1, 1

select distinct * from @t 
```

结果是

```
a b
1 1
1 2 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-08-28T07:12:43.363

我想对整个结果集进行计数和求和。我用`GROUP BY 1=1`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-29T18:09:56.313

不。你想进行一些聚合吗？如果是这样，你可以做这样的事情来获得你需要的东西

```
;with a as
(
     select sum(IntField) as Total
     from Table
     group by CharField
)
select *, a.Total
from Table t
inner join a
on t.Field=a.Field 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-29T04:49:13.663

简短的回答：没有。GROUP BY 子句本质上要求它们排列结果的方式。不同的字段分组顺序会导致不同的结果。

指定通配符将使语句易于解释和不可预测的行为。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-29T04:46:21.830

不，因为这从根本上意味着你不会对任何东西进行分组。如果您按所有列分组（并且有一个正确定义的带有唯一索引的表），那么`SELECT * FROM table`本质上与`SELECT * FROM table GROUP BY *`.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-08-12T14:04:34.753

这是我的建议：

```
DECLARE @FIELDS VARCHAR(MAX), @NUM INT

--DROP TABLE #FIELD_LIST

SET @NUM = 1
SET @FIELDS = ''

SELECT 
'SEQ' = IDENTITY(int,1,1) ,
COLUMN_NAME
INTO #FIELD_LIST
FROM Req.INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = N'new340B'

WHILE @NUM <= (SELECT COUNT(*) FROM #FIELD_LIST)
BEGIN
SET @FIELDS = @FIELDS + ',' + (SELECT COLUMN_NAME FROM #FIELD_LIST WHERE SEQ = @NUM)
SET @NUM = @NUM + 1
END

SET @FIELDS = RIGHT(@FIELDS,LEN(@FIELDS)-1)

EXEC('SELECT ' + @FIELDS + ', COUNT(*) AS QTY FROM [Req].[dbo].[new340B] GROUP BY ' + @FIELDS + ' HAVING COUNT(*) > 1  ') 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-07-31T12:45:41.767

您可以使用 Group by All 但要小心，因为 Group by All 将从 SQL Server 的未来版本中删除。

# java - 我应该查看 java 编译器生成的字节码吗？

> ID：800916
> 
> 赞同：6
> 
> 时间：2009-04-29T04:46:34.713
> 
> 标签：java, compiler-construction, jvm, bytecode, jit

`No`

*   无论如何，JIT 编译器可能会将字节码“转换”成完全不同的东西。
*   它将导致您进行过早的优化。

`Yes`

*   您不知道 JIT 将编译哪种方法，因此最好将它们全部优化。
*   它会让你成为一个更好的Java程序员。

我是在不知道（显然）的情况下问的，所以请随意重定向到 JIT 超链接。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-29T04:52:50.347

是的，但在一定程度上——这是一个很好的教育机会，可以了解幕后发生的事情，但可能应该适度进行。

这可能是一件好事，因为查看字节码可能有助于理解如何将 Java 源代码编译成 Java 字节码。此外，它可能会给出一些关于编译器将执行哪种优化的想法，并且可能对编译器可以执行的优化量有一些限制。

例如，如果执行字符串连接，`javac`将优化连接以使用 a`StringBuilder`和执行`append`方法连接`String`s。

但是，如果在循环中执行字符串连接，则可能会在每次迭代时实例化一个 new ，与手动在循环外实例化 a 并仅在循环内执行 s`StringBuilder`相比，可能会导致性能下降。`StringBuilder``append`

关于 JIT 的问题。即时编译将是特定于 JVM 实现的，因此当字节码转换为本机代码时，要找出字节码实际发生了什么并不容易，而且我们无法分辨哪些部分正在被 JIT 化（至少没有一些特定于 JVM 的工具来查看正在执行哪种 JIT 编译——我不知道这方面的任何细节，所以我只是推测。）

也就是说，JVM 无论如何都会执行字节码，它的执行方式对开发人员来说或多或少是不透明的，而且还是特定于 JVM 的。可能有一些性能技巧，一个 JVM 执行而另一个不执行。

当涉及查看生成的字节码的问题时，归结为了解源代码在编译为字节码时实际发生了什么。能够看到编译器执行的优化类型，同时也了解编译器执行优化的方式是有限的。

综上所述，我不认为沉迷于字节码生成并尝试编写能够发出最优化字节码的程序并不是一个好主意。更重要的是编写可供他人阅读和维护的 Java 源代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T04:50:01.070

这完全取决于你想要做什么。如果您正在尝试优化方法/模块，那么查看字节码将浪费您的时间。始终首先分析以找到瓶颈所在，然后优化瓶颈。如果你的瓶颈看起来很紧，并且你需要让它更快，你可能别无选择，只能用本机代码重写它并与 JNI 接口。

尝试优化生成的字节码将无济于事，因为 JIT 编译器会做很多工作，而且你不会知道它到底在做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T05:01:20.060

我不会这么认为。由于不必调试 javac 编译器或想知道感兴趣的问题，我想不出一个很好的理由为什么有人会关心生成什么字节码。

了解字节码不会让你成为更好的 Java 程序员，就像了解内燃机的工作原理会让你成为更好的司机一样。

从抽象的角度思考。当你试图计算行星的轨道时，你不需要知道夸克或原子的作用。要成为一名优秀的 Java 程序员，您可能应该学习……嗯……Java。是的，Java，就是这样 :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:41:16.797

除非您正在开发某种高容量服务器，否则您可能永远不需要检查字节码，除非出于好奇。遵循组织中可接受的编码实践的源代码将为大多数应用程序提供充足的性能。

在对应用程序进行负载测试后发现问题之前，不要担心性能问题（或者整个客户服务团队会为那个需要“永远”加载的屏幕私刑）。然后，消除瓶颈，不理会其余代码。

字节码需要适度的学习曲线才能理解。当然，了解更多信息永远不会有坏处，但实用主义建议将其推迟到有必要的时候。（如果那一刻到来，我建议找人指导你。）

# php - 如何在 php 中加密没有 mcrypt 库的字符串

> ID：800922
> 
> 赞同：5
> 
> 时间：2009-04-29T04:50:26.907
> 
> 标签：php, encryption

在函数中需要密钥来加密字符串而无需在 php 中使用 mcrypt libraly

```
function encrypt($str, $pass){
        $str_arr = str_split($str);
        $pass_arr = str_split($pass);
        $add = 0;
        $div = strlen($str) / strlen($pass);
        while ($add <= $div) {
             $newpass .= $pass;
             $add++;
        }
        $pass_arr = str_split($newpass);
        foreach($str_arr as $key =>$asc) {
            $pass_int = ord($pass_arr[$key]);
            $str_int = ord($asc);
            $int_add = $str_int + $pass_int;
            $ascii .= chr($int_add);
        }
        return $ascii;
    }

    function decrypt($enc, $pass){
        $enc_arr = str_split($enc);
        $pass_arr = str_split($pass);
        $add = 0;
        $div = strlen($enc) / strlen($pass);
        while ($add <= $div) {
            $newpass .= $pass;
            $add++;
        }
        $pass_arr = str_split($newpass);
        foreach($enc_arr as $key =>$asc) {
            $pass_int = ord($pass_arr[$key]);
            $enc_int = ord($asc);
            $str_int = $enc_int - $pass_int;
            $ascii .= chr($str_int);
        }
        return $ascii;
    } 
```

在这不适用于我的角色我测试它

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T15:40:09.963

这是另一种方法：

```
$key = 'the quick brown fox jumps over the lazy ';
$string = 'Hey we are testing encryption';

echo enc_encrypt($string, $key)."\n";
echo enc_decrypt(enc_encrypt($string, $key), $key)."\n";

function enc_encrypt($string, $key) {
    $result = '';
    for($i = 0; $i < strlen($string); $i++) {
        $char = substr($string, $i, 1);
        $keychar = substr($key, ($i % strlen($key))-1, 1);
        $char = chr(ord($char) + ord($keychar));
        $result .= $char;
    }

    return base64_encode($result);
}

function enc_decrypt($string, $key) {
    $result = '';
    $string = base64_decode($string);

    for($i = 0; $i < strlen($string); $i++) {
        $char = substr($string, $i, 1);
        $keychar = substr($key, ($i % strlen($key))-1, 1);
        $char = chr(ord($char) - ord($keychar));
        $result .= $char;
    }

    return $result;
} 
```

同样，不要指望这是非常安全的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T05:34:05.223

这段代码效率很低，我并不惊讶它没有给出预期的结果。

```
echo RotEncrypt('cheese', 'pie') . "\n<br>\n"
    .RotDecrypt(RotEncrypt('cheese', 'pie'), 'pie');
// ÓÑÊÕÜÊ
// cheese

function RotEncrypt($str, $pass){
   $pass = str_split(str_pad('', strlen($str), $pass, STR_PAD_RIGHT));
   $stra = str_split($str);
   foreach($stra as $k=>$v){
     $tmp = ord($v)+ord($pass[$k]);
     $stra[$k] = chr( $tmp > 255 ?($tmp-256):$tmp);
   }
   return join('', $stra);
}
function RotDecrypt($str, $pass){
   $pass = str_split(str_pad('', strlen($str), $pass, STR_PAD_RIGHT));
   $stra = str_split($str);
   foreach($stra as $k=>$v){
     $tmp = ord($v)-ord($pass[$k]);
     $stra[$k] = chr( $tmp < 0 ?($tmp+256):$tmp);
   }
   return join('', $stra);
} 
```

经过测试，它似乎对我来说很好。

无论哪种方式，我都觉得我应该警告您，这是一种非常不安全的加密形式，大多数密码使用相同的字符集和相当小的长度范围，这使得该系统非常容易受到能够使用相当良好的密码准确性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-01T17:15:39.403

你也可以试试这个：

*   [http://phpseclib.sourceforge.net/](http://phpseclib.sourceforge.net/)

或这个：

*   [http://www.phpclasses.org/package/1610-PHP-Symetric-encryption-of-data-using-only-PHP-code.html](http://www.phpclasses.org/package/1610-PHP-Symetric-encryption-of-data-using-only-PHP-code.html)

甚至这个：

*   [http://px.sklar.com/code.html/id=1287](http://px.sklar.com/code.html/id=1287)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-13T09:49:07.653

我使用 jlogsdon`enc_encrypt`和`enc_decrypt`prestashop 1.4.4.1 来包装Rijndael 类中`encrypt`的`decrypt`方法，女巫正在使用 mcrypt。我没有检查 if`enc_encrypt`并给出与and`enc_decrypt`完全相同的结果，但它们似乎在 prestashop 1.4.4.1 中工作。非常感谢。`mcrypt_encrypt``mcrypt_decrypt`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-04T12:35:46.437

这个问题很老，但是由于 PHP 7 没有 mcrypt，我遇到了同样的问题。我发现的最佳解决方案是使用 OpenSSL。它内置于 PHP 中，您不需要任何外部库。

加密：

```
function encrypt($key, $payload) {
  $iv = openssl_random_pseudo_bytes(openssl_cipher_iv_length('aes-256-cbc'));
  $encrypted = openssl_encrypt($payload, 'aes-256-cbc', $key, 0, $iv);
  return base64_encode($encrypted . '::' . $iv);
} 
```

解密：

```
function decrypt($key, $garble) {
    list($encrypted_data, $iv) = explode('::', base64_decode($garble), 2);
    return openssl_decrypt($encrypted_data, 'aes-256-cbc', $key, 0, $iv);
} 
```

参考链接：[https ://www.shift8web.ca/2017/04/how-to-encrypt-and-execute-your-php-code-with-mcrypt/](https://www.shift8web.ca/2017/04/how-to-encrypt-and-execute-your-php-code-with-mcrypt/)

# iphone - UIImage 的 jpg 或 png - 哪个更有效？

> ID：800926
> 
> 赞同：10
> 
> 时间：2009-04-29T04:53:39.800
> 
> 标签：iphone, objective-c, cocoa-touch, uiimage

我正在从相机胶卷中抓取一张图像，然后使用它一段时间，并将其作为 iPhone 上的 PNG 保存到磁盘。我遇到了奇怪的崩溃，大概是由于内存不足。

如果我将其保存为 PNG 或 JPG（假设我选择 note 以降低 JPG 情况下的质量），会有什么不同吗？具体来说：

*   如果我将其保存为 PNG，则在我将其从磁盘重新加载后 UIImage 会使用更多内存吗？
*   是否有可能在保存过程中保存为 PNG 暂时占用更多内存？

我一直假设 UIImage 是一种格式中性的表示形式，这无关紧要，但我认为我应该验证一下。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-29T17:18:01.710

* * *

> ***我遇到了奇怪的崩溃，大概是由于内存不足***

* * *

然后**停止你现在**正在做的事情，首先弄清楚这是否真的是导致崩溃的原因。否则很有可能你在这里追错了问题，修复了一个不存在的内存问题，而忽略了崩溃的真正原因。如果您想修复崩溃，*首先要找出导致崩溃的原因*。跟进“可能”的问题是浪费时间和精力的秘诀。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T19:19:51.700

我在商店中有一个应用程序，需要在编辑图像时保存图像的中间版本。在原始版本中，我使用 PNG 格式进行保存，以避免多次加载和保存 JPEG 导致质量损失。

在 2.2 版软件发布前后的某个时候，Apple 对 PNG 编写代码进行了更改，使得从某些图像中保存 PNG 数据的时间要长很多倍。我最终不得不更改为以 JPEG 格式保存，因为我的应用程序在尝试在退出时保存图像时超时。

此外，您会遇到问题，因为以 PNG 格式保存不会保留 UIImage 中的“方向”信息，因此使用内置相机以人像方向拍摄的照片在保存并重新加载后会出现旋转。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-29T05:19:41.483

这取决于您要处理的图像类型。如果您处理的是摄影图像，JPEG 几乎总是比 PNG 小，不会像人眼所见的那样明显丢失细节。

相反，如果您正在处理高度非摄影图像，例如 GUI 元素或具有大块纯色的图像，那么 PNG 和 JPEG 的大小将相当，但 PNG 将无损保存，而 JPEG 将有损且具有非常明显的文物。如果您有一个*非常*简单的图像（例如非常大的恒定颜色块），那么 PNG 很可能比 JPEG 小得多，并且不会有任何压缩伪影。

将图像保存为 PNG 或 JPEG 的行为不应占用太多的临时内存。当图像在内存中时，它通常以未压缩的形式存储在内存中，以便可以非常快速地将其绘制到屏幕上，而不是每次要渲染时都必须对其进行解压缩。与未压缩图像的大小相比，压缩它所需的额外临时存储量非常小。如果您可以将未压缩的图像放入内存中，则不必担心压缩时使用的内存。

当然，一旦您将映像写入非易失性存储中的文件系统并释放内存中的映像，压缩映像的大小实际上并不重要，因为它不再占用主内存. 压缩图像的大小仅影响它使用的闪存存储量，这可能是一个问题，但它不会影响您的应用程序很有可能耗尽内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-25T23:38:08.637

您的崩溃可能来自 UIImagePickerController 中的已知内存泄漏。

[这应该可以帮助您解决这个问题。](http://www.iphonedevsdk.com/forum/iphone-sdk-development/3816-uiimagepickercontroller-memory-issues.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T05:06:11.907

我没有任何确凿的数据，但我认为 PNG 更可取，因为 Apple 似乎在 iPhone OS 中几乎所有地方都使用 PNG。

但是，如果您已经设置了用于编写 PNG 的代码，那么将其更改为编写 JPEG 应该不会太难，不是吗？只需尝试这两种方法，看看哪种方法效果更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T18:51:07.697

尽可能使用 PNG。作为编译的一部分，XCode 通过实用程序 (pngcrush) 运行所有 PNG 文件以压缩和优化它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-20T05:01:30.680

1.  如果我将其保存为 PNG，则在我将其从磁盘重新加载后 UIImage 会使用更多内存吗？=> 不，如果您从 2 个具有相同分辨率和相同通道数的图像导入，则内存大小相同。（如RGBA）
2.  是否有可能在保存过程中保存为 PNG 暂时占用更多内存？=> 不，它只会影响您的磁盘内存。

# php - PHP检索数据问题

> ID：800935
> 
> 赞同：0
> 
> 时间：2009-04-29T04:56:30.963
> 
> 标签：php, mysql

我有一个奇怪的问题，PHP5 没有从 MySql 数据库中检索整数。这是我的代码：

```
$db = mysql_connect('XX.XX.XX.XX', 'DBName', 'DBPwd');
$query = 'Select * FROM Users WHERE UserName = \'Carlo\'';
$result = mysql_query($query);

if(!$result)
{
   echo 'Could not successfuly run query: '.mysql_error();
   exit;
} 

if(mysql_num_rows($result) == 0)
{
   echo '0 results';
}

$row = mysql_fetch_assoc($result);

echo 'UserId: '.$row['UserId']; // THIS IS THE INT VALUE FROM THE DATABASE

echo 'UserName: '.$row['UserName']; // THIS IS A STRING VALUE FROM THE DATABASE

mysql_close($db); 
```

代码打印：

用户身份：

用户名：卡罗

非常感谢任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T04:59:41.657

看看这个数组——你可能在某个地方有一个拼写错误或大写错误的单词：

```
print_r($row); 
```

这将向您显示所有键和值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T05:01:45.070

尝试这样做：

```
var_dump(array_key_exists('UserId', $row)); 
```

和

```
var_dump($row['UserId']); 
```

并将输出粘贴到此处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T05:03:34.253

你的连接字符串是错误的，你还需要一个 select db 命令：

```
$db = mysql_connect('XX.XX.XX.XX', 'user', 'DBPwd');
if ($db === false) {
    trigger_error('Failed to connect to database', E_USER_ERROR);
    echo 'Unable to connect to database. Please come again later.';
    exit;
}

if (!mysql_select_db('db_name', $db)) {
    trigger_error('Failed to selected database', E_USER_ERROR);
    echo 'Unable to connect to database. Please come again later.';
    exit;
} 
```

另外，请检查以确保您将 table 作为 column `UserId`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T05:06:05.167

完美的！那行得通，我确实有一个大写错误的单词，它是 UserID 而不是 UserId。我通常将数据库中的 ID 字段命名为“SomethingId”，这就是我没有这样做的原因！

非常感谢！

# .net - 如何在 .net windows 应用程序中实现“撤消”操作？

> ID：800940
> 
> 赞同：12
> 
> 时间：2009-04-29T05:00:10.750
> 
> 标签：.net, winforms, undo-redo

假设一个 win 表单具有某些输入字段并且用户输入/重新输入一些数据。

如何保留以前通过“撤消”操作输入的数据？

只是我想知道实现它的最佳方法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-29T11:46:55.640

有几个选项。重要的是你在项目的早期就开始设计它。如果在设计时没有考虑到这种功能，那么尝试将其添加到现有项目中可能会*非常*昂贵。

您需要利用一些基本模式：

1.  [MVC](http://en.wikipedia.org/wiki/Model-view-controller)或[观察者](http://en.wikipedia.org/wiki/Observer_pattern)模式。第一个关键不是你的高级架构的宗教或模式狂热者实现。重要的*是*您的软件能够识别其当前状态和显示状态之间的差异，并适当地解耦。您的视觉状态和应用程序状态之间需要有一个共同的、明确定义的耦合。这为您提供了创建命令所需的通用架构（请参阅#2）。

2.  [命令](http://en.wikipedia.org/wiki/Command_pattern)模式。您可以通过命令模式获得很多质量（尽管它可能会以一些看起来应该由向导生成的代码为代价）。您对命令模式采取的具体方法可能会有所不同（每个命令一个类，通过覆盖实现，而每个命令一个类，通过事件处理程序实现，例如），但命令是@Ralph 建议构建堆栈的“动作”类大约。

    这可能有点棘手，但一般方法是侦听将数据从视觉状态“提交”到应用程序状态的事件。该[`Validated`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validated.aspx)事件可能是一个很好的钩子`Textbox`。该[`Click`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.click.aspx)事件对于`Button`. 当该提交发生时，您创建与该控件关联的命令，尝试执行该命令，如果该命令成功完成，则将该命令添加到您的撤消堆栈。现在，您正在准确跟踪正在发生的事情以及正在发生的数据。

3.  [备忘录](http://en.wikipedia.org/wiki/Memento_pattern)模式。@JP 解开了最后一块拼图。您可以在保存的命令上使用备忘录来存储受影响控件在执行命令之前的状态。这与`UnExecute()`命令界面上的成员相结合，应该是执行任务所需的最后一个核心设计。

像这样的结构化方法的好处是，您现在有了一个自然扩展点，用于需要在命令基础上发生的其他行为。例如，交易是自然而然的选择。在我当前的项目中，我正在使用 WPF[`ICommand`](http://msdn.microsoft.com/en-us/library/system.windows.input.icommand.aspx)接口（在我的 winforms 项目中）来提供有关是否[`CanExecute()`](http://msdn.microsoft.com/en-us/library/system.windows.input.icommand.canexecute.aspx)在任何给定时间给定命令的反馈。这让我能够以纯命令驱动的方式适当地启用和禁用 UI 小部件。:)

不幸的是，Winforms 内置的这种结构并没有很多支持（据我所知），所以你需要从头开始构建它的大部分。没有一个部分是特别复杂的，但是您会发现自己为每个命令生成了大量的大部分样板代码。这也是一种普遍的设计技术。为了使其有效，它必须在应用程序的适当部分中始终如一地使用。这使得改造功能变得相当昂贵，尤其是在原始代码紧密耦合且没有内聚的情况下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T05:08:36.987

我不确定 WinForms/.Net 是否具有某种类型的内置撤消功能，您可以利用这些功能。但是您真正需要的是一个 Stack 数据结构来帮助您管理操作列表。您需要创建某种类型的“操作”对象来表示用户可以执行的操作，并且随着他们在应用程序中的进展，您需要将这些操作推送到堆栈上。当他们点击撤消按钮，或 Ctrl-Z 或任何启动撤消操作的方法时，您将弹出当前操作并将应用程序状态恢复到前一个操作。

这是对其工作原理的非常基本和高级别的概述，但我想实现这样的功能可能会变得相当复杂。想象一下它需要如何为像 Adob​​e Photoshop 这样的程序工作。:O

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T15:34:57.887

这可能不是最好的方法，具体取决于您要完成的工作，但您可以使用富文本框并调用该控件中内置的撤消方法。

例如：

```
richTextBox1.Undo(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T05:13:40.110

[这](http://www.codeproject.com/KB/cs/generic_undo_redo.aspx)和[这](http://www.dofactory.com/Patterns/PatternMemento.aspx)可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T11:16:32.547

CTRL + Z 适用于单个控件。

如果您使用数据和 BindingSource，您可以通过调用[CancelEdit](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.canceledit.aspx)函数“撤消”对记录的未持久更改，或者您可以重新加载数据库的数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T16:52:17.997

我的建议是在开始设计和实施之前确定具体的撤消要求及其实际好处。我继承了一个 WinForms 应用程序，该应用程序通过内部的一组通用“动作”对象使用了多个操作顺序撤消。然而，事实证明，我与之交谈的应用程序的用户都没有使用或请求该功能！这个特定应用程序的工作方式，如果我是该应用程序的用户，我也不会看到自己使用该功能。

如果是“选择性”撤消，则撤消功能在这种情况下可能会更有用；用户可以在数据提交之前选择之前所做的几个编辑的任何单个操作/编辑，并将该单个编辑恢复到其原始状态，而不是只能先撤消最后一个操作，然后是倒数第二个操作等，这就是它的实现方式。

在任何情况下，该应用程序因此包含不必要的复杂性和间接性，这使得“深入了解”并对现有功能进行更改和增强变得更加困难和缓慢，在这种情况下，对现实世界的好处很少或没有。自从我继承了这个项目，我已经实现了没有撤消的新功能，没有人有任何抱怨。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T20:06:24.047

您可能还发现 Reversi 库很有用，就像其他几个似乎一样。请参阅 [ [http://www.codeproject.com/KB/dotnet/reversibleundoredo.aspx][1]](http://www.codeproject.com/KB/dotnet/reversibleundoredo.aspx][1])或 [this][2]

[1]： http: [//www.codeproject.com/KB/dotnet/reversibleundoredo.aspx](http://www.codeproject.com/KB/dotnet/reversibleundoredo.aspx)使您的应用程序可逆以支持撤消和重做

[2]：[http](http://www.codeproject.com/script/Articles/Article.aspx?aid=22502) ://www.codeproject.com/script/Articles/Article.aspx?aid= 22502 撤消重做

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-30T06:08:16.183

[http://blogs.msdn.com/kirillosenkov/archive/2009/06/29/new-codeplex-project-a-simple-undo-redo-framework.aspx](http://blogs.msdn.com/kirillosenkov/archive/2009/06/29/new-codeplex-project-a-simple-undo-redo-framework.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-29T05:07:58.750

取决于您希望有多少级别的撤消。

您可以在某种意义上将值“提交”到每个控件的表单级别集合中，您可以在单击按钮时“恢复”以供用户返回。

# c# - 表示层、业务层和数据层

> ID：800946
> 
> 赞同：7
> 
> 时间：2009-04-29T05:01:24.367
> 
> 标签：c#, data-access-layer, layer, presentation

我刚开始用 C# 编程，并且正在阅读关于将您的应用程序/网站分为三个不同层的最佳实践，但我很难准确理解如何。我正在从事一个宠物项目，以更多地了解 C#，但我不想从任何坏习惯开始。你能看看我有什么，看看我做得对吗？提供一些关于如何将所有内容分解为不同层的提示建议？

**表示层**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
  <title>Project: Ruth</title>
  <link href="CSS/StyleSheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <form id="form1" runat="server">
    <div class="Body">
      <div class="Header">
        <div class="Nav">
          <img src="images/Header_Main.gif" alt="" width="217" height="101" />
          <div class="Menu">
            <a href="Default.aspx">
              <img src="images/Header_Home-Off.gif" alt="" /></a>
            <a href="Default.aspx">
              <img src="images/Header_About-Off.gif" alt="" /></a>
            <a href="Register.aspx">
              <img src="images/Header_Register-Off.gif" alt="" /></a>
            <a href="Default.aspx">
              <img src="images/Header_Credits-Off.gif" alt="" /></a>
          </div>
        </div>
      </div>
      <div class="Content">
        <div class="CurrentlyListening">
          <asp:Label ID="lblCurrentListen" runat="server" Text="(Nothing Now)" CssClass="Txt"></asp:Label>
        </div>
        <asp:GridView ID="gvLibrary" runat="server" AutoGenerateColumns="False" DataKeyNames="lib_id" DataSourceID="sdsLibrary" EmptyDataText="There are no data records to display." Width="760" GridLines="None">
          <RowStyle CssClass="RowStyle" />
          <AlternatingRowStyle CssClass="AltRowStyle" />
          <HeaderStyle CssClass="HeaderStyle" />
          <Columns>
            <asp:BoundField DataField="artist_name" HeaderText="Artist" SortExpression="artist_name" HeaderStyle-Width="200" />
            <asp:BoundField DataField="album_title" HeaderText="Album" SortExpression="album_title" HeaderStyle-Width="200" />
            <asp:BoundField DataField="song_title" HeaderText="Track" SortExpression="song_title" HeaderStyle-Width="200" />
            <asp:TemplateField HeaderText="DL">
              <ItemTemplate>
                <a href="http://####/Proj_Ruth/Data/<%# Eval("file_path") %>" class="lnk">Link</a>
              </ItemTemplate>
            </asp:TemplateField>
          </Columns>
        </asp:GridView>
        <asp:SqlDataSource ID="sdsLibrary" runat="server" ConnectionString="<%$ ConnectionStrings:MusicLibraryConnectionString %>" DeleteCommand="DELETE FROM [Library] WHERE [lib_id] = @lib_id" InsertCommand="INSERT INTO [Library] ([artist_name], [album_title], [song_title], [file_path]) VALUES (@artist_name, @album_title, @song_title, @file_path)" ProviderName="<%$ ConnectionStrings:MusicLibraryConnectionString.ProviderName %>" SelectCommand="SELECT [lib_id], [artist_name], [album_title], [song_title], [file_path] FROM [Library] ORDER BY [artist_name], [album_title]" UpdateCommand="UPDATE [Library] SET [artist_name] = @artist_name, [album_title] = @album_title, [song_title] = @song_title, [file_path] = @file_path WHERE [lib_id] = @lib_id">
          <DeleteParameters>
            <asp:Parameter Name="lib_id" Type="Int32" />
          </DeleteParameters>
          <InsertParameters>
            <asp:Parameter Name="artist_name" Type="String" />
            <asp:Parameter Name="album_title" Type="String" />
            <asp:Parameter Name="song_title" Type="String" />
            <asp:Parameter Name="file_path" Type="String" />
          </InsertParameters>
          <UpdateParameters>
            <asp:Parameter Name="artist_name" Type="String" />
            <asp:Parameter Name="album_title" Type="String" />
            <asp:Parameter Name="song_title" Type="String" />
            <asp:Parameter Name="file_path" Type="String" />
            <asp:Parameter Name="lib_id" Type="Int32" />
          </UpdateParameters>
        </asp:SqlDataSource>
      </div>
    </div>
  </form>
</body>
</html> 
```

**业务层**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

public class User
{
  DA da = new DA();

  public string FirstName { get; set; }
  public string LastName { get; set; }
  public string EmailAddress { get; set; }
  public string Password { get; set; }
  public string AccessCode { get; set; }

  public User(string firstName, string lastName, string emailAddress, string password, string accessCode)
  {
    FirstName = firstName;
    LastName = lastName;
    EmailAddress = emailAddress;
    Password = password;
    AccessCode = accessCode;
  }

  public void CreateUser(User newUser)
  {
    if (da.IsValidAccessCode(newUser.AccessCode))
    {
      da.CreateUser(newUser);
    }
  }
} 
```

**数据访问层 (DAL)**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Data.SqlTypes;
using System.Data.SqlClient;
using System.Configuration;

public class DA
{
  public DA()
  {
  }

  public bool IsValidAccessCode(string accessCode)
  {
    bool isValid = false;
    int count = 0;

    using (SqlConnection sqlCnn = new SqlConnection(ConfigurationManager.ConnectionStrings["MusicLibraryConnectionString"].ConnectionString))
    {
      sqlCnn.Open();
      using (SqlCommand sqlCmd = new SqlCommand(String.Format("SELECT COUNT(*) FROM [AccessCodes] WHERE [accessCode_accessCode] = '{0}';", accessCode), sqlCnn))
      {
        count = (int)sqlCmd.ExecuteScalar();
        if (count == 1)
        {
          isValid = true;
        }
      }
    }
    return isValid;
  }

  public void CreateUser(User newUser)
  {
    using (SqlConnection sqlCnn = new SqlConnection(ConfigurationManager.ConnectionStrings["MusicLibraryConnectionString"].ConnectionString))
    {
      sqlCnn.Open();
      using (SqlCommand sqlCmd = new SqlCommand(String.Format("INSERT INTO [Users] (user_firstName, user_lastName, user_emailAddress, user_password, user_accessCode) VALUES ('{0}', '{1}', '{2}', '{3}', '{4}');", newUser.FirstName, newUser.LastName, newUser.EmailAddress, newUser.Password, newUser.AccessCode), sqlCnn))
      {
        sqlCmd.ExecuteNonQuery();
      }
    }
    DeleteAccessCode(newUser.AccessCode);
  }

  public void DeleteAccessCode(string accessCode)
  {
    using (SqlConnection sqlCnn = new SqlConnection(ConfigurationManager.ConnectionStrings["MusicLibraryConnectionString"].ConnectionString))
    {
      sqlCnn.Open();
      using (SqlCommand sqlCmd = new SqlCommand(String.Format("DELETE FROM [AccessCodes] WHERE [accessCode_accessCode] = '{0}';", accessCode), sqlCnn))
      {
        sqlCmd.ExecuteNonQuery();
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T06:18:16.023

乔恩，

首先要理解的是，如果您打算构建基于层的应用程序，那么您不应该将 SQL 语句直接存储在 ASPX 页面中（根据`SqlDataSource`需要）。该`SqlDataSource`控件旨在演示使用数据库数据绑定和更新应用程序是多么容易，并且不打算在现实世界的应用程序中使用，因为如果您要存储，它有点违背了拥有 BL 层和 Datalayer 的目的在 ASPX 页面中选择/更新/删除/插入语句。

基于层的应用程序设计的全部目的是封装每一层，使之没有交叉。每一层都与其他层的公共接口交互，对它们的内部实现一无所知。

因此，可行的替代方法是使用`ObjectDataSource`控件。此控件允许您直接绑定到 DataLayer 或 Biz 逻辑层，后者又可以调用 Datalayer。直接绑定到 Datalayer 的缺点是您将返回暴露数据库表模式的数据结构（例如，DataTables 或 DataViews）。

因此，推荐的逻辑流程如下：

ASPX 页面使用 DataSource 控件绑定到 BL 类。这个 BL 类提供了适当的函数，例如（带有任何必需的重载），这些函数返回可以使用和显示`GetData, UpdateData, DeleteData and InsertData`的强类型对象或集合。`ObjectDataSource`BL 类中的每个公共函数在内部调用 DataLayer 以从数据库中选择/更新/删除/插入数据。

[快速入门](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/data/objects.aspx)中提供了对 ASP.NET 中基于层的设计的精彩介绍

**PS**：@Andy 提到了适用于所有场景的通用数据层。有关它的外观示例，请参阅[此问题。](https://stackoverflow.com/questions/619855/code-review-ado-net-data-access-utility-class-vb/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T08:11:16.627

对 ASP.NET 应用程序中逻辑层的最佳解释来自两个来源。第一个是由 Scott Mitchell 编写的微软自己的 ASP.NET 网站，它很好地介绍了逻辑分离。教程很冗长，但我发现它们非常有用。URL 是[http://www.asp.net/learn/data-access/](http://www.asp.net/learn/data-access/)。

我发现第二个资源非常有用，它由 Imar Spaanjaars 编写，可[在此处](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)获得。这是一篇技术性更强的文章，但提供了一种将结构添加到应用程序的好方法。

我希望这会有所帮助。

伊恩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T05:07:39.843

如果您编写的代码最终是可移植的，您会发现您的应用程序中有 3 个（或更多！）层。

例如 - 不要让您的数据访问层专门为这个应用程序工作，而是编写它，这样您就不必再编写它了。确保您的所有函数都可以传递变量，并且您不依赖全局变量（或尽可能少）。当你的下一个项目到了 - 复制并粘贴你的 DAL 之后，你突然又重新启动并运行了。

它并没有就此结束——您可能想为您的 DAL 编写一个子层，在 MySQL 和 MSSQL 之间进行解释（仅作为示例）。或者你可能有一个你执行的常用函数库，比如文本清理或 CSS 生成等等。

如果你写你的代码，有一天，你坐下来写一个应用程序——它主要涉及剪切和粘贴以前的代码——你已经达到了程序员的必杀技。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:14:31.803

分层应用程序背后的整个想法是，每一层都不依赖于下面各层的实现细节。例如，在您的代码中，您的表示层中有一条 T-SQL 语句。这意味着您的表示层直接依赖于数据库（底层）。如果您在数据库中进行更改，您还必须在表示层中进行更改。理想情况下，这不是您想要的。表示层应该只关心数据的呈现，而不是如何检索它。假设您将整个数据库移动到 CSV 文件中（我知道，疯狂的想法），那么您的表示层根本不应该意识到这一点。

所以理想情况下，你有一个业务层方法，它只返回你想向用户显示的数据。你应该看看[`ObjectDataSource`](http://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx)而不是`SqlDataSource`. `SqlDataSource`非常适合小型原型项目，但您不应该将它用于任何更严肃的项目。

在业务层和数据层之间，您应该有类似的分离。数据层负责从某个存储位置（数据库、CSV 文件、Web 服务……）获取您想要的数据。同样，理想情况下，业务层不应依赖于数据层的实现细节。例如，如果您正在与 SQL Server 交谈，则不应将[`SqlDataReader`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)实例返回到您的业务层。通过这样做，您创建了业务层对数据层实现细节的依赖关系：它从中检索数据的实际数据库。

在实践中，您会看到业务层确实以某种方式依赖于数据层的实现细节，这通常不是一件坏事。您最后一次决定切换数据库是什么时候？但是尽可能地消除依赖关系和隔离实现细节几乎总是会导致应用程序更易于维护和理解。

[您可以在此处](https://stackoverflow.com/questions/661530/layering-a-wcf-service-the-right-way/662527#662527)找到类似的解释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-01T14:52:19.483

除了他问题的主要内容之外，我建议您查看 ASPNET_REGSQL 来配置您的 SQL 数据库以处理 .Net 的内置成员/配置文件/角色功能。它将消除创建/更新用户等的大量麻烦和麻烦。我没有使用过很多配置文件，但它允许您为您的用户“附加”额外的属性，例如 AccessCode。

如果您正在处理已经进行用户身份验证等的现有数据库结构，您可以创建一个自定义成员资格提供程序，该提供程序将利用现有的数据库表和存储过程。

# .net - 我想弹出我自己的对话框（将文件保存在服务器上而不询问目标路径位置）而不是 adobe 的另存为对话框

> ID：800952
> 
> 赞同：1
> 
> 时间：2009-04-29T05:04:52.487
> 
> 标签：.net, c++, c, visual-c++

我们可以覆盖`Save As`Adob​​e Photoshop 的对话框吗？我们如何覆盖？你的方法是什么？

实际上我想弹出我自己的对话框（将文件保存在服务器上而不询问目标路径位置）而不是 Adob​​e 的`Save As`对话框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T09:13:54.997

@Nick Whaley 是对的。我不认为@UselessAdmin 的方式有效，因为要求弹出另一个“另存为”对话框，只有在用户选择一个文件夹并在文件夹对话框中单击“确定”后才会调用 CreateFile，显然挂钩 CreateFile 为时已晚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T05:28:02.667

不，你不能那样做。你为什么需要这个？如果您使用的是 SDK，那么您应该能够使用“操作”对象将文件保存到您想要的任何位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T05:34:03.010

除非有用于 Photoshop 的插件 API 允许这样做，否则您将不得不在 Photoshop 进程中注入一些代码并挂钩另存为功能。并不是一件容易的事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T20:42:48.950

正如@Nick Whaley 建议的那样，您可以挂钩该过程，但您不必疯狂地寻找特定的窗口。你根本不必这样做。您可以挂钩 CreateFile API，而不是使用 Windows 路由，在某处创建一个自定义操作，该操作将尝试将文件保存在预定义（可能不存在）的位置。在您的钩子函数中，使用该文件的特殊路径/名称查找 CreateFile 调用，并显示您自己的保存对话框。调用具有所需路径的实际打开文件，并将句柄返回给 PS。

您将需要： - MS Detours Express - 大约 2 小时的时间

PS。为自定义 PS 动作分配热键，并使用它来保存文件。

# c++ - 等效于 std::map 的 remove_if

> ID：800955
> 
> 赞同：137
> 
> 时间：2009-04-29T05:05:30.707
> 
> 标签：c++, stl, map

我试图根据特定条件从地图中删除一系列元素。我如何使用 STL 算法来做到这一点？

最初我想使用`remove_if`但这是不可能的，因为 remove_if 不适用于关联容器。

是否有任何适用于 map 的“remove_if”等效算法？

作为一个简单的选择，我想循环遍历地图并擦除。但是循环遍历地图并擦除安全选项吗？（因为迭代器在擦除后变得无效）

我使用了以下示例：

```
bool predicate(const std::pair<int,std::string>& x)
{
    return x.first > 2;
}

int main(void) 
{

    std::map<int, std::string> aMap;

    aMap[2] = "two";
    aMap[3] = "three";
    aMap[4] = "four";
    aMap[5] = "five";
    aMap[6] = "six";

//      does not work, an error
//  std::remove_if(aMap.begin(), aMap.end(), predicate);

    std::map<int, std::string>::iterator iter = aMap.begin();
    std::map<int, std::string>::iterator endIter = aMap.end();

    for(; iter != endIter; ++iter)
    {
            if(Some Condition)
            {
                            // is it safe ?
                aMap.erase(iter++);
            }
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-04-29T05:20:47.317

几乎。

```
for(; iter != endIter; ) {
     if (Some Condition) {
          iter = aMap.erase(iter);
     } else {
          ++iter;
     }
} 
```

如果您确实从中删除了一个元素，那么您最初的操作会使迭代器增加*两次；*您可能会跳过需要删除的元素。

这是我在许多地方看到使用和记录的常用算法。

[编辑]您是正确的，迭代器在擦除后无效，但只有引用被擦除元素的迭代器，其他迭代器仍然有效。因此`iter++`在`erase()`通话中使用。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2013-05-16T20:39:23.073

## 用于 std::map （和其他容器）的 erase_if

我为此使用以下模板。

```
namespace stuff {
  template< typename ContainerT, typename PredicateT >
  void erase_if( ContainerT& items, const PredicateT& predicate ) {
    for( auto it = items.begin(); it != items.end(); ) {
      if( predicate(*it) ) it = items.erase(it);
      else ++it;
    }
  }
} 
```

这不会返回任何内容，但会从 std::map 中删除项目。

使用示例：

```
// 'container' could be a std::map
// 'item_type' is what you might store in your container
using stuff::erase_if;
erase_if(container, []( item_type& item ) {
  return /* insert appropriate test */;
}); 
```

第二个示例（允许您传入测试值）：

```
// 'test_value' is value that you might inject into your predicate.
// 'property' is just used to provide a stand-in test
using stuff::erase_if;
int test_value = 4;  // or use whatever appropriate type and value
erase_if(container, [&test_value]( item_type& item ) {
  return item.property < test_value;  // or whatever appropriate test
}); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-04-07T15:41:21.303

现在，`std::experimental::erase_if`在 header 中可用`<experimental/map>`。

请参阅：[http ://en.cppreference.com/w/cpp/experimental/map/erase_if](http://en.cppreference.com/w/cpp/experimental/map/erase_if)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T05:22:03.303

我从[优秀的 SGI STL 参考](http://www.sgi.com/tech/stl/Map.html)中获得了这份文档：

> Map 有一个重要的属性，即在 map 中插入一个新元素不会使指向现有元素的迭代器失效。从映射中擦除元素也不会使任何迭代器无效，当然，除了实际指向正在被擦除的元素的迭代器。

因此，您拥有的指向要擦除的元素的迭代器当然会失效。做这样的事情：

```
if (some condition)
{
  iterator here=iter++;
  aMap.erase(here)
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-11-06T13:23:58.867

这是一些优雅的解决方案。

```
for (auto it = map.begin(); it != map.end();)
{   
    (SomeCondition) ? map.erase(it++) : (++it);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-16T18:14:38.340

原始代码只有一个问题：

```
for(; iter != endIter; ++iter)
{
    if(Some Condition)
    {
        // is it safe ?
        aMap.erase(iter++);
    }
} 
```

在这里，`iter`在 for 循环中增加一次，在擦除中增加一次，这可能会以无限循环结束。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-11-04T14:59:07.097

对于**C++20上的那些，有用于**[**map**](https://en.cppreference.com/w/cpp/container/map/erase_if)和[**unordered_map**](https://en.cppreference.com/w/cpp/container/unordered_map/erase_if)的内置**std::erase_if**函数：[](https://en.cppreference.com/w/cpp/container/map/erase_if)**[](https://en.cppreference.com/w/cpp/container/unordered_map/erase_if)**

 ****```
std::unordered_map<int, char> data {{1, 'a'},{2, 'b'},{3, 'c'},{4, 'd'},
                                    {5, 'e'},{4, 'f'},{5, 'g'},{5, 'g'}};

const auto count = std::erase_if(data, [](const auto& item) {
    auto const& [key, value] = item;
    return (key & 1) == 1;
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-29T08:59:08.757

从底部注释：

[http://www.sgi.com/tech/stl/PairAssociativeContainer.html](http://www.sgi.com/tech/stl/PairAssociativeContainer.html)

Pair Associative Container 不能提供可变迭代器（如 Trivial Iterator 要求中所定义），因为可变迭代器的值类型必须是可赋值的，而对是不可赋值的。但是，Pair Associative Container 可以提供不完全恒定的迭代器：使得表达式 (*i).second = d 有效的迭代器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-19T09:28:45.980

恕我直言，没有`remove_if()`等价物。
您无法重新排序地图。
所以`remove_if()`不能把你对的兴趣放在你可以跟注的末尾`erase()`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-08-25T13:54:35.653

第一的

> Map 有一个重要的属性，即在 map 中插入一个新元素不会使指向现有元素的迭代器失效。从映射中擦除元素也不会使任何迭代器无效，当然，除了实际指向正在被擦除的元素的迭代器。

二、下面的代码不错

```
for(; iter != endIter; )
{
    if(Some Condition)
    {
        aMap.erase(iter++);
    }
    else
    {
        ++iter;
    }
} 
```

调用函数时，参数会在调用该函数之前进行评估。

所以在调用erase之前计算iter++时，迭代器的++操作符将返回当前项，并在调用后指向下一项。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-06-01T22:52:17.020

基于[Iron Savior 的回答](https://stackoverflow.com/a/16597048/37558)对于那些希望提供更多符合 std 函数式迭代器的范围的人。

```
template< typename ContainerT, class FwdIt, class Pr >
void erase_if(ContainerT& items, FwdIt it, FwdIt Last, Pr Pred) {
    for (; it != Last; ) {
        if (Pred(*it)) it = items.erase(it);
        else ++it;
    }
} 
```

好奇是否有某种方法可以丢失`ContainerT`项目并从迭代器中获取。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-25T18:13:36.040

[史蒂夫愚蠢的回答](https://stackoverflow.com/questions/800955/removeif-equivalent-for-stdmap/800984#800984)我觉得更有效率。

这是另一个**简单但效率较低的解决方案**：

该解决方案用于`remove_copy_if`将我们想要的值复制到一个新容器中，然后将原始容器的内容与新容器的内容交换：

```
std::map<int, std::string> aMap;

...
//Temporary map to hold the unremoved elements
std::map<int, std::string> aTempMap;

//copy unremoved values from aMap to aTempMap
std::remove_copy_if(aMap.begin(), aMap.end(), 
                    inserter(aTempMap, aTempMap.end()),
                    predicate);

//Swap the contents of aMap and aTempMap
aMap.swap(aTempMap); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-10T09:33:17.310

如果要擦除所有 key 大于 2 的元素，那么最好的方法是

```
map.erase(map.upper_bound(2), map.end()); 
```

但仅适用于范围，不适用于任何谓词。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-11-27T08:13:51.283

我这样用

```
 std::map<int, std::string> users;    
 for(auto it = users.begin(); it <= users.end()) {
    if(<condition>){
      it = users.erase(it);
    } else {
    ++it;
    }
 } 
```

# fluent-nhibernate - Fluent nhibernate table-per-hierarchy 映射

> ID：800956
> 
> 赞同：2
> 
> 时间：2009-04-29T05:05:35.120
> 
> 标签：fluent-nhibernate, nhibernate-mapping

我有一个简单的场景，其中我有一个具有 DueDate 计算属性的实体操作（这是一个工作流样式应用程序）。

现在 id 想引入一个 SlidingAction，它的唯一区别（在这个阶段）是覆盖 DueDate 计算，因为它没有自己的映射。

我很难映射这种情况，因为 Fluent Nhibernate 似乎迫使我在子类上映射“某些东西”。

有人可以解释一下吗？

干杯，拜伦

```
public class ActionMap : ClassMap<Action>
{
    public ActionMap()
    {
        WithTable("Actions");
        Id(x => x.ID);
        Map(x => x.Description);
        Map(x => x.TimeLine);
        Map(x => x.Template);
        Map(x => x.StageOrder);
        Map(x => x.CorrespondenceType).CustomTypeIs(typeof (ActionCorrespondenceTypeEnumType));
        References(x => x.Matter).FetchType.Join();
        HasMany(x => x.FileNotes).Cascade.SaveUpdate();

        DiscriminateSubClassesOnColumn("Type")
            .SubClass<SlidingAction>(/*its forcing me to map something here*/);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T21:12:19.350

只需将一个空的 lambda 放入 , `c => {}`。

```
.SubClass<SlidingAction>(c => {}); 
```

# c# - 实施源代码控制

> ID：800967
> 
> 赞同：2
> 
> 时间：2009-04-29T05:09:27.420
> 
> 标签：c#, svn, version-control, visualsvn-server, ankhsvn

如何设置一些组策略规则或机制以确保每个开发人员都将他们的代码提交到源代码控制？

我将visualsvn服务器与Ankhsvn客户端btw一起使用。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T05:45:18.567

我们的基本政策是“**如果它不在源代码存储库中，它就不存在。** ”

*   开发人员只有在签入代码时才能将任务标记为“开发完成”。
*   仅从一组标记的源代码（而不是一些小丑的工作站副本）构建您的可交付成果。
*   **不在**源代码控制中的任何内容都不会进入 QA 或生产。

签入损坏的代码被认为是不好的形式，但不会受到惩罚（除了那些不便的人的一点点嘲讽。）

我想使用持续集成并配置损坏的构建以自动退出损坏的更改，但我不希望能够在我所处的位置很快实现。

编辑：我们还要求每次签入的评论中都有工件编号。这可以防止与需求无关的无故更改。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T05:17:41.067

这类政策最好通过同侪压力来执行。创建一个环境，在该环境中提交代码是公认的做法。否则，它将成为一种苦差事，开发人员会想方设法解决它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-29T05:22:09.997

我认为实施源代码控制的最佳方式是在您的团队中建立良好的“软件开发文化”。

深知源代码控制的好处的开发人员会毫不犹豫地使用它。

推荐文章：

*   [早点入住，经常入住](http://www.codinghorror.com/blog/archives/001165.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T05:22:15.860

持续集成服务器可能有助于鼓励人们签入他们的代码。如果每个人都参与检查代码以进行夜间构建/单元测试运行，我想每个人都会开始看到好处。我同意以前的答案，即强迫人们登记入住可能不是最好的方法——最好是使用有益于团体的东西来鼓励这种行为。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T05:22:44.783

给每个人发电子邮件，告诉他们使用源代码控制或被解雇！我不是告诉人们发出威胁甚至制定许多政策的人，但使用源代码控制只是人们应该毫无疑问地接受的事情之一。

如果人们对源头控制不认真，那么有两种可能。1）设置太难了，你应该简化流程，让它成为一个一步登入的过程。 2）他们是糟糕的开发人员，需要去。时期！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T05:18:43.593

这似乎真的是个坏主意。你能解释一下为什么要强制签到吗？

强制签入将导致构建损坏和错误代码的传播。仅当代码处于运行状态并且用户有时间查看所有更改时才应进行签入。开发人员应该可以自由地检查、试验并放弃他们的更改。当我检查旧版本时，我总是这样做。

如果您正在寻找的是强制备份，我会考虑除源代码控制之外的其他解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T05:49:25.297

如果您定期与团队会面（例如每日 SCRUM）并使用某种工具，例如[Jira](http://www.atlassian.com/software/jira/)、Mantis 或[Rally](http://www.rallydev.com/)，并且您在 SVN 系统中设置了一个触发器以将每个提交链接到一个任务（或者更好的是，一个分支有一个任务，但不幸的是，这对 SVN 来说不是很好），您可以轻松检查开发人员是否已将代码签入此任务。大多数与问题/错误跟踪系统的集成都会创建一个附件，其中包含在提交中修改的文件，因此非常容易检查。

这不是强制，但它会帮助您强制所有团队都遵循前面提到的规则：早点签到，经常签到。

# asp.net - Htm 页面到 Aspx 页面

> ID：800972
> 
> 赞同：-1
> 
> 时间：2009-04-29T05:15:14.710
> 
> 标签：asp.net

我有一个 htm 页面。我有一个链接 Moreinfo。当我们单击该链接时，它将转到 aspx 页面。这里表示链接 Moreinfo[更多信息...](http://localhost/akki/akki/b/reg.aspx)当我们单击该链接时，它必须转到 reg.aspx。但它不去，错误是找不到shopwing页面

意味着在我的项目中，我有 index.htm。当我点击更多信息链接时，从这个页面，它必须去 reg.aspx ..我怎么能去..我从我的同事那里复制了这个项目

没有任何工作。index.htm 和 reg.aspx 都在同一个站点“b”中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T05:19:59.673

你确定链接的路径是正确的吗？您在此处的链接显示[http://localhost/akki/akki/b/reg.aspx](http://localhost/akki/akki/b/reg.aspx) - 您确定路径中应该有两个“akki”吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T05:19:18.863

该错误意味着您指向的链接中不存在 aspx 页面。要么您提供了错误的链接，要么您的 aspx 页面在您想要的路径上不存在。

# jquery-validate - 如何在条件下禁用自定义验证方法

> ID：800983
> 
> 赞同：1
> 
> 时间：2009-04-29T05:20:42.887
> 
> 标签：jquery-validate, dependencies

我使用 jQuery [Validation 插件](http://docs.jquery.com/Plugins/Validation)来确保用户在第一个文本字段中输入了正的*cost_of_car ，在第二个文本字段中输入了正的**payment_amount*，例如 *cost_of_car * 0.4 <= payment_amount <= cost_of_car*：

```
$.validator.addMethod("testMaxAmount", function()
{
    return $("#cost_of_car").val() - 0 >= $("#payment_amount").val() - 0;
}, "Can't be more than cost_of_car");

$.validator.addMethod("testMinAmount", function()
{
    return $("#cost_of_car").val() * 0.4 <= $("#payment_amount").val() - 0;
}, "Can't be less than cost_of_car * 0.4");

$("#calc_form").validate(
{
    rules: 
    {
        cost_of_car: 
        {
            required: true,
            number: true,
            min: 1,
            max: 10000000
        },
        payment_amount: 
        {
            required: true,
            number: true,
            testMaxAmount: true,
            testMinAmount: true 
        }
    }
}); 
```

现在我想跳过 testMaxAmount 和 testMinAmount 检查，直到*cost_of_car*有效。测试

```
$("#calc_form").validate().element("#cost_of_car") 
```

甚至

```
$("#calc_form").validate({ignore: "#payment_amount"}).element("#cost_of_car") 
```

在这些方法内部导致递归并挂起浏览器。

请您提出一些其他方法来禁用*payment_amount*的验证，直到*cost_of_car*有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T05:36:00.663

**更新：**更改必须在`validator.addMethod()`调用中：

```
$.validator.addMethod("testMaxAmount", function()
{
    if($("#cost_of_car").valid())
      return $("#cost_of_car").val() - 0 >= $("#payment_amount").val() - 0;
    else
      return true;
}, "Can't be more than cost_of_car");

$.validator.addMethod("testMinAmount", function()
{
    if($("#cost_of_car").valid())
      return $("#cost_of_car").val() * 0.4 <= $("#payment_amount").val() - 0;
    else
      return true;
}, "Can't be less than cost_of_car * 0.4"); 
```

# iphone - 如何处理 iPhone 中的网络切换？

> ID：800992
> 
> 赞同：0
> 
> 时间：2009-04-29T05:25:06.900
> 
> 标签：iphone

我刚刚开发了一个 iPhone 音频流应用程序......现在它可以毫无问题地播放音频文件......当 iPhone 网络从 3G 切换到 WiFi 时出现问题，反之亦然......我需要在网络切换时暂停流，但我网络到来时无法恢复播放..有人可以指出如何用代码处理这种情况吗？

问候， 赛姆 S

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T05:35:40.680

您可以将您的应用程序设置为[检查`Reachability`状态](http://developer.apple.com/iphone/library/samplecode/Reachability/index.html)，然后在网络状态更改且网络无法访问时发送“暂停” `NSNotification`（同样，`NSNotification`当网络状态更改并且网络现在再次可以访问时发送“播放”）：

```
[[Reachability sharedReachability] setNetworkStatusNotificationsEnabled:YES];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(reachabilityChanged:) name:@"kNetworkReachabilityChangedNotification" object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(pauseStreaming:) name:@"kPauseAudioStreamingIfPlaying" object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(pauseStreaming:) name:@"kPlayAudioStreamingIfPaused" object:nil];

- (void) reachabilityChanged:(id)sender {
  NetworkStatus reachabilityStatus = [[Reachability sharedReachability] internetConnectionStatus];
  if (reachabilityStatus == NotReachable)
     [[NSNotificationCenter defaultCenter] postNotificationName:@"kPauseAudioStreamingIfPlaying" object:nil];
  else 
     [[NSNotificationCenter defaultCenter] postNotificationName:@"kPlayAudioStreamingIfPaused" object:nil];
} 
```

# php - AJAX (prototype/php) 在脚本执行期间获取部分状态更新

> ID：800997
> 
> 赞同：4
> 
> 时间：2009-04-29T05:28:10.433
> 
> 标签：php, javascript, ajax, prototypejs

我有一个想在页面后台运行的进程。该过程将需要一段时间才能运行，比如说几分钟。

我已经设置好了，这样我就可以从页面上单击一个按钮来启动该过程，稍等片刻，然后它就会完成，我可以让页面更新通知我该过程已成功运行。我正在使用原型和 php 执行此操作。

我想要做的是在进程运行时进行状态更新。所以它可以更新一个页面，让我知道到目前为止已经处理了多少条记录，或者更新一个状态栏或类似的东西。

这可能吗？我只是不是一个巨大的 JS 专家，我可以做我已经描述过的基本功能，但我想知道是否可以扩展它来做这个额外的一点，因为我没有任何运气谷歌搜索或浏览文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T05:36:07.967

仅使用 PHP，您几乎最终都会进行轮询。您需要在后台生成长时间运行的进程，例如将其进度写入文件数据库。

然后，浏览器可以每隔 x 秒调用一个不同的 php 脚本，该脚本会报告此状态。

轮询虽然很糟糕，但这就是你所坚持的，使用 PHP。

# java - 在 Java 中删除文件的内容

> ID：800998
> 
> 赞同：3
> 
> 时间：2009-04-29T05:28:47.640
> 
> 标签：java, io

我正在将字节写入 temp.fls 文件。完成操作后，我想从 temp.fls 文件中删除最后 256 个字节。我怎样才能做到这一点？请帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T05:31:38.647

[`RandomAccessFile.setLength()`](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html#setLength(long))像这样使用：

```
RandomAccessFile f = new RandomAccessFile(yourFile,"rw");
f.setLength(f.length()-256); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-16T10:16:10.970

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.RandomAccessFile;

public class RandomAccessFileDemo {

    public static void main(String ... args) throws FileNotFoundException, IOException
    {
        File file = new File(<FILE_PATH>);
         System.err.println("MSR:: RandomAccessFileDemo :: the target length is"+file.length());
        RandomAccessFile raf = new RandomAccessFile(file,"rwd");
        raf.seek(file.length()-1); // Set the pointer to the end of the file
        System.err.println("MSR:: RandomAccessFileDemo :: the file pointer is"+raf.getFilePointer());

        raf.setLength(raf.length()-raf.length());

    }
} 
```

# c# - 在 Linux 中运行 .NET exe

> ID：800999
> 
> 赞同：22
> 
> 时间：2009-04-29T05:30:50.757
> 
> 标签：c#, .net, linux

有没有办法在 Linux 中运行 .NET exe（winform 应用程序）**而不在 linux 中构建代码？**事实上，我没有我之前开发的一些实用程序的代码，我想在 linux 中运行它们。

相关：[使用 Mono 进行 C# 开发的可行性](https://stackoverflow.com/questions/797093/feasibility-of-c-development-with-mono)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-29T05:32:29.830

单核细胞增多症 ！[http://mono-project.com/Main_Page](http://mono-project.com/Main_Page)

效果也很好。在不断发展的社区中有越来越多的工具支持、C# 编译器等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T05:38:17.837

您可以使用 Mono Migration Analyzer 进行测试，也可以使用 Mono 命令提示符对其进行实际测试...在[本文中介绍](http://mono-project.com/Guide:_Porting_Winforms_Applications)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T05:34:02.510

葡萄酒 + .NET*********`*****