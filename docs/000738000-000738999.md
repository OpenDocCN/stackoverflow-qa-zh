# StackOverflow 问答 000738000-000738999

# apache-flex - Flex & WCF - 枚举错误

> ID：738004
> 
> 赞同：0
> 
> 时间：2009-04-10T15:33:17.830
> 
> 标签：apache-flex, wcf, enums

我有一个 WCF 服务操作，它接受自定义类型 MyQuery -- 的数据协定参数`function Search(q as MyQuery)`。MyQuery 对象包含 2 个属性：

```
MyQuery.SearchPhrase (string)  
MyQuery.SearchType (custom enum SearchTypeEnum) 
```

我还有一个使用此服务的 Flex 客户端应用程序。但是当 Flex 调用 Search() 操作时，我收到以下关于枚举属性的错误：

> “找不到类型‘ [http://mydomain/2009/04/SearchTypeEnum::SearchTypeEnum](http://mydomain/2009/04/SearchTypeEnum::SearchTypeEnum) ’的定义”

Flex 在构建对服务的请求时会引发错误。

所以我的问题是......有没有办法在 Flex 中解决这个问题？还是我唯一的选择是在没有枚举的情况下重新设计服务？

这是在服务层定义枚举数据契约的方式：

```
<Da​​taContract(Namespace:="http://mydomain/2009/04/SearchTypeEnum")> _
公共枚举 SearchTypeEnum
    <EnumMember()> [布尔] = 0
    <EnumMember()> [NaturalLanguage] = 1
结束枚举
```

据我所知，这是枚举数据合约的正确定义。我还尝试在服务和 MyQuery 类上使用 ServiceKnownType 和 KnownType 属性，但无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T16:18:53.367

我建议您尝试使用一个简单的 .NET 客户端 - 甚至可能是一个控制台应用程序。这个想法是看看您是否可以让*任何*应用程序与该服务一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T14:09:28.800

我找不到让它工作的方法。相反，我用字符串常量替换了枚举。不那么优雅，但它有效。

# c# - 用户键/鼠标输入跟踪。C＃

> ID：738005
> 
> 赞同：1
> 
> 时间：2009-04-10T15:33:35.957
> 
> 标签：c#, user-input

我想跟踪我离开键盘的时间/休息了多长时间。我认为跟踪我的键盘和鼠标是查看我何时离开和到达的好方法。跟踪这个的最好方法是什么？我看到的一些选项

*   每次按下鼠标和键盘时都有一个系统范围的回调。
*   休眠 100 毫秒，看看是否有 keydown 或 mousemove
*   使用一个系统调用，它实际上告诉我最后一个用户输入是什么时候，并有效地使用上述组合。（睡眠直到用户离开，然后使用回调来跟踪到达）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T15:38:11.610

试试看[这个](http://www.codeproject.com/KB/cs/GetIdleTimeWithCS.aspx)。

您不需要自己进行跟踪，看起来您可以进行系统调用来获得空闲时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-24T06:29:42.747

[http://www.geekpedia.com/tutorial210_Retrieving-the-Operating-System-Idle-Time-Uptime-and-Last-Input-Time.html](http://www.geekpedia.com/tutorial210_Retrieving-the-Operating-System-Idle-Time-Uptime-and-Last-Input-Time.html)也可能对您有所帮助

有点晚了:P:P

# c# - Bloch 的 Effective Java for C# 等价物

> ID：738006
> 
> 赞同：31
> 
> 时间：2009-04-10T15:34:08.250
> 
> 标签：c#

我加入了 C# 的潮流，想知道是否有相当于 Joshua Bloch 的适用于 C# 世界的[Effective Java](http://java.sun.com/docs/books/effective/)。

鉴于它们的相似性，我已经能够将一些 Java 知识应用于 C#，但我对最有效地利用 C# 特定功能的知识感兴趣。例如，泛型在 Java 和 C# 中的实现并不相同，因此我不清楚 Java 泛型“技术”是否也适用于 C#。

我最感兴趣的是 C# 3.0。那是（当然），除非你们认为我会受益于研究版本 1 和 2 的功能。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-11-25T04:22:31.237

[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)的[C# In Depth](https://rads.stackoverflow.com/amzn/click/com/1933988363)是 StackOverflow 用户的最爱。

[![C# 深入了解](https://i.stack.imgur.com/K0wu9.jpg)](https://rads.stackoverflow.com/amzn/click/com/1933988363)
[（来源：[askjonskeet.com](http://askjonskeet.com/content/csharpindepth.jpg)）]

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-10T15:37:02.703

Bill Wagner的两本书**[Effective C#](https://rads.stackoverflow.com/amzn/click/com/0321658701)**和**[More Effective C#与 Effective Java 类似。](https://rads.stackoverflow.com/amzn/click/com/0321485890)**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-11-25T04:24:12.293

*由于您希望在Effective Java*的同一行中有一些东西，因此以下两本书非常相似：

[有效的 C#](https://rads.stackoverflow.com/amzn/click/com/0321245660)

[](https://rads.stackoverflow.com/amzn/click/com/0321245660)

[http://img253.imageshack.us/img253/8619/0321245660aa6.jpg](https://rads.stackoverflow.com/amzn/click/com/0321245660)

[更有效的 C#](https://rads.stackoverflow.com/amzn/click/com/0321485890)

[](https://rads.stackoverflow.com/amzn/click/com/0321485890)

[http://images.amazon.com/images/P/0321485890.MZZZZZZZ.jpg](https://rads.stackoverflow.com/amzn/click/com/0321485890)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-05-12T11:00:04.273

我发现Jeffery Richter 的[CLR Via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)非常好。它深入讨论了 CLR 和框架，让您更好地了解如何使用各种功能以及潜在的陷阱。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-05-12T10:46:49.583

我认为[框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321545613)是最接近的。虽然我认为它在深度方面无法与 Effective Java 相提并论，但我还没有找到任何同类书籍中更好的书。

C# in Depth 很棒，但它更多地关注语言而不是 .NET 中的设计问题。因此，我不会将它与 Effective Java 归为一类。

[![替代文字](https://i.stack.imgur.com/MdVax.jpg)](https://i.stack.imgur.com/MdVax.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-10T15:39:13.307

**Bill Wagner 的**Effective C#**和**更有效的 C#。**第二本书涉及 C# 2 和 3。**

 **Amazon.com上的[此处](https://rads.stackoverflow.com/amzn/click/com/0321245660)和[此处](https://rads.stackoverflow.com/amzn/click/com/0321485890)

或[在这里](http://www.amazon.co.uk/Effective-C-Specific-Ways-Improve/dp/0321245660/ref=sr_1_2?ie=UTF8&s=books&qid=1239377821&sr=8-2)和[这里](http://www.amazon.co.uk/More-Effective-Specific-Software-Development/dp/0321485890/ref=sr_1_1?ie=UTF8&s=books&qid=1239377821&sr=8-1)在 Amazon.co.uk

有一个涵盖 C# 4.0[的 Effective C# (Amazon UK) 新版本。](http://www.amazon.co.uk/Effective-covers-4-0-Specific-Development/dp/0321658701/)

*被安迪打败了，但我正在查找链接。*

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-25T04:25:02.667

[有效的 C#](https://rads.stackoverflow.com/amzn/click/com/0321245660)怎么样？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-25T11:00:42.980

看到有多少人写出与 Scott Meyers 的“Effective C++”和“More Effective C++”相同的书，真是令人惊讶。这是成为已发表作者的算法：

1.  学习新语言 X。
2.  发布“有效X”和“更有效X”。
3.  滚滚而来的银行海啸。

“有效的 Haskell”，有人吗？

我并不是要贬低任何这样做的人。这更像是对 Scott Meyers 的一种敬意——他是一位出色的计算机科学家和作家。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-11-25T14:26:52.607

Jon Skeet 的 C# In Depth 也值得一提。

[![](https://i.stack.imgur.com/k913x.jpg)](https://rads.stackoverflow.com/amzn/click/com/1933988363)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-05-12T08:52:17.693

值得注意的是，最近（2010 年 3 月 18 日在英国）出版了 Bill Wagner 的 Effective C# 第二版。第二版对其进行了更新以涵盖 C# 4.0。

就个人而言，我对 Effective C# 的原版完全不感兴趣，然而，几天前买了第二版，它看起来好多了。它没有受到同样程度的印刷错误和重复的困扰，最重要的是，它与我认为的最佳实践相关性更好，而不仅仅是详细说明许多任意的个人选择。

它更新为涵盖 C# 4.0 的事实也很重要！

说了这么多，这些只是我的早期观察，因为我还没有读过很多！

# android - 如何使我的图像可滚动？【安卓平台】

> ID：738018
> 
> 赞同：2
> 
> 时间：2009-04-10T15:37:51.033
> 
> 标签：android, image, scroll

我有一个比安卓屏幕占用更多空间的图像。我希望图像以全尺寸呈现，并且用户可以向任何方向移动。像地图一样。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T17:57:40.163

您可以使用免费提供给您的网络视图。我不知道为什么，但是当我尝试使用 loadData 方法时它不起作用，但是使用带有空 URL 的 loadDataWithBaseURL 确实有效。

使用 webview，您的图像甚至可以嵌入 HTML。在下面的示例中`yourContent`只是一个字符串。

例如

```
yourView.loadDataWithBaseURL(null, yourContent, "text/html", "UTF-8", null); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T01:02:04.810

这是我看到的一个教程，它做了你所描述的 [http://www.anddev.org/scrolling_a_picture_horizo ​​ntally_and_vertically-t3245.html](http://www.anddev.org/scrolling_a_picture_horizontally_and_vertically-t3245.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-23T11:55:44.650

您可以将图像放入**ImageView**并使用**ScrollView**和**Horizo** ​​ntalScrollView 将其包装，如下所示。

```
<HorizontalScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/yourImage"/>

    </ScrollView>

</HorizontalScrollView> 
```

因此，您可以像地图一样水平和垂直滚动它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-20T08:08:48.103

尝试使用您的图像将滚动放入 xml 布局

# visual-studio - 如何从 Outlook 中的 Office Orb 菜单中删除项目

> ID：738020
> 
> 赞同：0
> 
> 时间：2009-04-10T15:38:08.410
> 
> 标签：visual-studio, visual-studio-2008, outlook, outlook-2007

伙计们，

我一直致力于 Office 2007 中的功能区开发，但我遇到了一个让我有点抓狂的问题。我想从 Outlook 2007 中新邮件的 Orb 菜单中删除“权限”选项。我没有运气。我正在使用 VS2008 和 VSTO 3。有什么建议吗？

提前致谢，

雷克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-07T05:19:31.533

为了向其他读者澄清，您实际上不能将此功能作为菜单选项删除，根据上面的 xml，您可以将可见设置为 false，并隐藏命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T20:03:19.427

啊，原来我在模式的错误部分修改了 XML。正确的修改看起来像：

```
<officeMenu>
    <splitButton idMso="PermissionRestrictMenu" visible="false"/>
  </officeMenu>
  <tabs> 
```

# sharepoint - SharePoint 博客模板母版页品牌

> ID：738029
> 
> 赞同：2
> 
> 时间：2009-04-10T15:40:05.893
> 
> 标签：sharepoint, moss, sharepoint-2007, sharepoint-designer

这可能是一个简单的问题，但我遇到了问题。

我有多个具有自定义母版页的发布 SharePoint 网站和子网站。我现在有一个基于博客站点模板的子站点。自定义母版页未应用到它。我检查以确保站点的母版页将其设置为指向自定义母版页。

博客网站模板处理母版页的方式不同吗？如果是这样，我如何标记这些博客页面？我必须单独处理它们吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T19:51:50.500

是的，博客网站使用不同的母版页。您必须使用 SharePoint 设计器进入博客网站并在库中创建自定义母版页。

如果您要在 SharePoint 上使用博客，我**衷心**建议您使用[CKS:EBE 。](http://cks.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=5134)它对开箱即用的博客模板进行了大量改进，包括主题、引用、垃圾邮件保护等。试一试！

# language-agnostic - 你最重用的课程是什么？

> ID：738039
> 
> 赞同：18
> 
> 时间：2009-04-10T15:43:27.960
> 
> 标签：language-agnostic, oop

一段时间后，每个程序员都会得到一组实用程序类。其中一些是真正的编程珍珠，它们在您的几个项目中被重用。例如，在 java 中：

```
 class Separator {

        private String separator;
        private boolean called;

        public Separator(String aSeparator) {
            separator = aSeparator;
            called = false;
        }

        @Override
        public String toString() {
            if (!called) {
                called = true;
                return "";
            } else {
                return separator;
            }
        }
    } 
```

和：

```
public class JoinHelper {

    public static <T> String join(T... elements) {
        return joinArray(" ", elements);
    }

    public static <T> String join(String separator, T... elements) {
        return joinArray(separator, elements);
    }

    private static <T> String joinArray(String sep, T[] elements) {
        StringBuilder stringBuilder = new StringBuilder();
        Separator separator = new Separator(sep);

        for (T element : elements) {
           stringBuilder.append(separator).append(element);
        }

        return stringBuilder.toString();
    }
} 
```

你最重用的课程 **是什么？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T15:45:43.540

[`System.Object`](http://msdn.microsoft.com/en-us/library/system.object.aspx)- 几乎我所有的类型都扩展了它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T16:02:56.277

具有日志记录和电子邮件功能的实用程序类。包含扩展方法的扩展类。一个基本上利用报告服务 Web 服务的报告类，可以轻松地将报告流式传输为 excel、pdf 等。

**示例...**
1.) 实用程序类（静态）

```
 public static void LogError(Exception ex)
    {
        EventLog log = new EventLog();
        if (ex != null)
        {
            log.Source = ConfigurationManager.AppSettings["EventLog"].ToString();
            StringBuilder sErrorMessage = new StringBuilder();
            if (HttpContext.Current.Request != null && HttpContext.Current.Request.Url != null)
            {
                sErrorMessage.Append(HttpContext.Current.Request.Url.ToString() + System.Environment.NewLine);
            }
            sErrorMessage.Append(ex.ToString());
            log.WriteEntry(sErrorMessage.ToString(), EventLogEntryType.Error);
        }
    } 
```

2.) 扩展类

```
 public static IEnumerable<TSource> WhereIf<TSource>(this IEnumerable<TSource> source, bool condition, Func<TSource, bool> predicate)
    {
        if (condition)
            return source.Where(predicate);
        else
            return source;
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-22T00:19:46.600

```
public static short getLastDayOfMonth(short givenMonth, short givenYear)
{
    short lastDay = 31;
    switch (givenMonth)
    {
        case 4:
        case 6:
        case 9:
        case 11:
            lastDay = 30;
            break;
        case 2:
            if ((int)givenYear % 4 == 0)
            {
                lastDay = 29;
            }
            else
            {
                lastDay = 28;
            }
            break;    
    }
    return lastDay;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T16:20:21.507

重复使用最多但很无聊：

```
public static void handleException(Exception e) throws RuntimeException {
    if (e instanceof RuntimeException) {
        throw (RuntimeException) e;
    }

    throw new RuntimeException(e); //NOPMD
} 
```

不那么无聊（也是构建列表和集合的方法）：

```
/**
   * Builds a Map that is based on the Bean List.
   * 
   * @param items Bean List items
   * @param keyField Bean Field that will be key of Map elements (not null)
   * @return a Map that is based on the Bean List
   */
  @SuppressWarnings("unchecked")
  public static <T, K> Map<K, T> buildMapFromCollection(final Collection<T> items,
                                                        boolean linkedMap,
                                                        final String keyField,
                                                        final Class<K> keyType) {
    if (items == null) {
      return Collections.emptyMap();
    }

    if (keyField == null) {
      throw new IllegalArgumentException("KeyField is null");
    }

    final Map<K, T> result;

    if (linkedMap) {
      result = new LinkedHashMap<K, T>();
    } else {
      result = new HashMap<K, T>();
    }

    BeanMapper mapper = null;
    for (final T item : items) {
      if (mapper == null) {
        mapper = new BeanMapper(item.getClass());
      }
      final K key = (K) mapper.getFieldValue(item, keyField);
      result.put(key, item);
    }
    return result;
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T15:45:02.577

Logger 类：在日志文件中记录控制流。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T15:47:03.927

配置读取器/设置器：从 ini/xml 文件中读取配置并设置应用程序的环境

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T15:48:59.697

重复使用最多？嗯……

boost::shared_ptr<> 与 boost::weak_ptr<>

可能是最重用的（也可能是最物超所值的比率）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-10T15:49:17.090

全局变量

只是一个带有静态 DBConnString 的简单类，以及一些其他应用程序范围的设置。

自从使用 .Net 以来，已经在大约 2 打项目中重用了这个简单文件

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-21T23:44:22.350

我写的一个 ConcurrentDictionary，现在我似乎到处都在使用它（我写了很多并行程序）

# c# - 哪个免费的 C# 单元测试框架？

> ID：738041
> 
> 赞同：7
> 
> 时间：2009-04-10T15:44:31.220
> 
> 标签：c#, .net, unit-testing, frameworks

我是 C# 世界（以及 .Net）的初学者，所以我决定从更有经验的开发人员那里获得一些建议。你会推荐哪个免费的 C# 单元测试框架？我遇到了 NUnit，它看起来很有趣，但在它的文档中我发现有 .Net 1.1 和 .Net 2.0 的版本。我需要在针对.Net 3.0 的项目中使用它。

所以，请让我知道是否：

*   我可以将 NUnit 用于 .Net 3.0 项目吗？

或者：

*   有什么比 NUnit 更好的吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-10T15:45:33.120

是的。NUnit 也适用于 .NET 3.0 和 3.5。

你的第二个问题很主观。NUnit 是一个广泛使用的 .NET 单元测试框架。MSTest 是 Visual Studio 附带的另一个。xUnit 是另一个。

xUnit 项目有一个比较： [xUnit - Comparing xUnit.net to other frameworks](http://xunit.github.io/docs/comparisons.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T15:52:45.020

[xUnit和](https://xunit.github.io/)[MbUnit](http://www.mbunit.com/)一样值得一看（也是我用得最多的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T15:53:47.187

好吧，这取决于您的 IDE。如果您已购买或您的雇主购买了 MSTest 附带的 Visual Studio 版本，那么我会使用它，只需较少的安装和配置。否则，请使用 NUnit，它简单、易于使用并被 .NET 开发人员广泛使用和接受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T16:14:14.940

我会说坚持使用 NUnit。这是一个很好的测试框架，并且可以与 3.0 一起使用（这是我目前使用的，也是我们在上一个雇主使用的）

# ide - Netbeans 中的取消缩进

> ID：738052
> 
> 赞同：9
> 
> 时间：2009-04-10T15:46:33.803
> 
> 标签：ide, netbeans

在 netbeans 中，如果我选择一些文本并按`Tab`，它可以正常工作，并且文本按预期缩进到右侧。

但是，如果我尝试在文本后面退格，它一次只会删除一个空格。很烦人。

有什么方法可以更改此设置，因此在选项卡行后面退格会导致整个选项卡被删除，而不仅仅是 1 个空格？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T15:57:17.727

我不再使用 Netbeans，但通常快捷键是 Shift+Tab。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-27T11:50:17.547

值得一提的是**ALT+SHIFT+UP/DOWN/LEFT/RIGHT**将向左或向右缩进，还允许您向上或向下移动行。它是一个非常方便的功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-23T03:58:14.903

`Alt-Shift-F`（格式化代码）也很有帮助。选择需要重新缩进的代码块并执行`Alt-Shift-F`.

# c++ - 哈希函数为一对long long？

> ID：738054
> 
> 赞同：19
> 
> 时间：2009-04-10T15:47:22.773
> 
> 标签：c++, hash, tr1, unordered-map, hash-function

我需要将一对映射`long long`到 a `double`，但我不确定要使用什么哈希函数。每对可能由任意两个数字组成，尽管在实践中它们通常是介于`0`和之间的数字`100`（但同样，这并不能保证）。

[这](http://msdn.microsoft.com/en-us/library/bb982522.aspx)是`tr1::unordered_map`文档。我是这样开始的：

```
typedef long long Int;
typedef std::pair<Int, Int> IntPair;

struct IntPairHash {
  size_t operator(const IntPair& p) const {
    return ...; // how to hash the pair?
  }
};

struct IntPairEqual {
  bool operator(const IntPair& a, const IntPair& b) const {
    return a.first == b.first 
      && a.second == b.second;
  }
};

tr1::unordered_map<IntPair, double, IntPairHash, IntPairEqual> myMap; 
```

一般来说，我永远不确定要使用什么散列函数。什么是好的通用哈希函数？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T17:00:57.480

散列一对的自然方法是以某种方式组合其组件的散列。最简单的方法就是使用 xor：

```
namespace std {
namespace tr1 {

template<typename a, typename b>
struct hash< std::pair<a, b> > {
private:
   const hash<a> ah;
   const hash<b> bh;
public:
   hash() : ah(), bh() {}
   size_t operator()(const std::pair<a, b> &p) const {
      return ah(p.first) ^ bh(p.second);
   }
};

}} // namespaces 
```

请注意，这会将 (1,1) 或 (2,2) 之类的散列对全部归零，因此您可能需要使用一些更复杂的方法来组合部分的散列，具体取决于您的数据。Boost 做了这样的事情：

```
size_t seed = ah(p.first);
return bh(p.second) + 0x9e3779b9 + (seed<<6) + (seed>>2); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-10T15:58:52.153

[boost::hash](http://www.boost.org/doc/libs/1_37_0/doc/html/hash.html)形式的函数库。

或者自己写。最简单的版本 = pair.first * max_second_value + pair.second

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T15:58:32.683

一个建议：看看这个 SO 帖子：[“我不明白`std::tr1::unordered_map`”](https://stackoverflow.com/questions/35950/i-dont-understand-stdtr1unorderedmap)。

[此外，关于Equality Predicates 和 Hash Predicates](http://www.boost.org/doc/libs/1_36_0/doc/html/unordered/hash_equality.html)的 Boost Documentation也是一个好地方（以及这个[例子](http://www.boost.org/doc/libs/1_36_0/libs/unordered/examples/fnv1.hpp)）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T15:51:36.380

你真的需要一个基于哈希的地图吗？只要复杂性保证它可以解决您正在解决的问题，基于二叉树的通用映射就可以正常工作。

# javascript - Javascript弹出窗口，我可以像往常一样引用父页面上的所有js吗？

> ID：738055
> 
> 赞同：0
> 
> 时间：2009-04-10T15:48:03.770
> 
> 标签：javascript, popup

在引用父页面 js 变量/方法等时，所有弹出窗口都相同吗？

弹出窗口内容中的 ajax 请求怎么样？

据我了解，弹出窗口只是在玩 Z 顺序，所以它基本上仍在父页面上，只是看起来“更高”对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T15:53:07.250

很可能您正在谈论一个弹出窗口，即当动作发生时显示的 div（或其他元素）。这是通过在页面上放置某种隐藏元素来完成的，这些元素刚刚显示并可能居中，然后被带到前面（使用 z-index）。

如果这是您将弹出窗口与 javascript 一起使用的方式，那么是的，弹出窗口可以访问页面上的所有 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T15:53:07.767

您必须了解跨域脚本。但是，对于最简单的情况，您应该能够通过以下方式在父页面上引用 javascript：

```
if (window.parent)
{
    window.parent.SomeFunctionOnParent();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T15:53:52.397

Javascript 弹出窗口是独立的窗口，但它们可以通过以下方式引用其所有者：`window.owner`

# sharepoint - sharepoint WSS 工作流 - “启动失败”错误

> ID：738056
> 
> 赞同：0
> 
> 时间：2009-04-10T15:48:12.693
> 
> 标签：sharepoint, workflow, wss, sharepoint-designer

我有一个 WSS 3.0“项目”站点，我的所有工作流程都正常工作。我想要一种简单的方法来克隆这个站点，每个项目都有一个，所以它必须是授权的最终用户可以做的事情（stsadm 导出对他不起作用）。

我将包含内容的站点保存为模板，然后从模板创建一个新站点。这个新站点具有所有工作流程，但是当我尝试运行它们时，我得到“无法启动”，这是来自错误日志。我怀疑这是日志中的关键消息...“找不到条件“__Rule_ID21”

2009 年 4 月 10 日 10:06:03.00 w3wp.exe (0x13A4) 0x150C Windows SharePoint Services 工作流基础结构 72fs 意外的 RunWorkflow: Microsoft.SharePoint.SPException: Error>CompilerError Line="0" Column="0" Text="Activity ' ID13' 验证失败：找不到条件“__Rule_ID13”。CompilerError Line="0" Column="0" Text="Activity 'ID21' 验证失败：找不到条件“__Rule_ID21”。/> 错误> 在 Microsoft.SharePoint.Workflow.SPWinOeHostServices.CreateInstance(Guid trackingId, SPWorkflow workflow) 在 Microsoft.SharePoint.Workflow.SPWinOeEngine.RunWorkflow(Guid) 的 Microsoft.SharePoint.Workflow.SPNoCodeXomlCompiler.LoadXomlAssembly(String assmNameIn, SPWeb web)跟踪号码，

2009 年 4 月 10 日 10:06:03.00* w3wp.exe (0x13A4) 0x150C Windows SharePoint Services 工作流基础结构 72fs 意外 ...rkflow、SPWorkflow 工作流、Collection`1 事件、SPRunWorkflowOptions runOptions)

2009 年 4 月 10 日 10:06:03.00 w3wp.exe (0x13A4) 0x150C Windows SharePoint Services 工作流基础结构 98d7 意外 Microsoft.SharePoint.SPException：在 Microsoft.SharePoint.Workflow.SPNoCodeXomlCompiler.LoadXomlAssembly(String assmNameIn, SPWeb web) 在 Microsoft。 Microsoft.SharePoint.Workflow.SPWinOeEngine.RunWorkflow 上的 SharePoint.Workflow.SPWinOeHostServices.CreateInstance（Guid trackingId，SPWorkflow 工作流）（Guid trackingId，SPWorkflowHostService 主机，SPWorkflow 工作流，集合`1 事件，TimeSpan 超时）在 Microsoft.SharePoint.Workflow.SPWorkflowManager .RunWorkflowElev(SPWorkflow originalWorkflow, SPWor...

2009 年 4 月 10 日 10:06:03.00* w3wp.exe (0x13A4) 0x150C Windows SharePoint Services 工作流基础结构 98d7 意外 ...kflow 工作流，集合`1 事件，SPRunWorkflowOptions runOptions)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-26T21:26:51.360

工作流调用应该是你的 workflow.cs 文件中的第一个活动，然后还有其他代码片段。构建将编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T15:02:00.103

棘手。在这一点上，我的猜测是您最好的选择是打开您可以从 SharePoint Designer 访问的工作流文件（在其中打开您的原始/根/模板网站）。

找到工作流文件后，不要在可视化设计器中打开它们，而是尝试在记事本中打开它们，以便查看 XML 源代码。现在不要乱用它，但是这样您应该能够找到在模板导出的网络中失败的规则和活动“13”和“21”。查找 ID13、__Rule_ID13、ID21 和 __Rule_ID21。这里的想法是找出哪两个活动/条件对失败。一旦你知道它们是什么，你就可以：

*   让我们知道
*   尝试在没有这些活动/条件对的情况下导出网络（或暂时将它们替换为不会失败的虚拟对象）
*   仔细看看他们：他们有什么理由不在原来的网络上工作吗？

不要以为有一个简单的答案。一般来说，SharePoint Designer 工作流，特别是在仅 WSS 的环境中，肯定有其局限性和故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T09:58:10.987

我认为这与您在工作流程中使用的条件规则有关，但我不记得有关 WF 如何存储和访问它们的具体信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T10:16:14.443

这是 Simon Fox 所说的 GUID 问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-04T02:58:11.340

*警告！！*在生产环境中打开诊断日志可能会导致服务器崩溃。

在 Central Admin > Operations > Diagnostic Logging > Event Throttling 中：

类别 = 全部

事件日志 = 信息

tracelog = 冗长*！！危险！！*

在 C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\LOGS 中查看最近的日志（复制并粘贴到 excel 中）

为“工作流基础设施”过滤“类别”。这应该开始引导您走上正确的道路。希望它有帮助，祝你好运

伊恩·菲尔波特

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-04T03:35:56.037

问题是 SharePoint 设计器工作流与使用该列表的 GUID 的特定列表实例相关联。当您将站点另存为模板并使用该模板重新创建新站点时，创建的列表将使用与该模板所基于的列表相同的列表模板，但它将具有不同的标识 GUID。重复使用使用 SharePoint 设计器创建的工作流是一个常见问题。

这是一种可能的解决方案，尽管每次从模板创建新站点时都需要一些繁重的工作：http: [//nickgrattan.wordpress.com/2007/10/17/applying-a-sharepoint-designer-workflow-to-多个列表/](http://nickgrattan.wordpress.com/2007/10/17/applying-a-sharepoint-designer-workflow-to-multiple-lists/)

您可能最好做的是创建一个站点定义（请注意，因为您必须遵循公认的做法，这是一个开始[http://www.sharepointjoel.com/Lists/Posts/Post.aspx?ID= 117](http://www.sharepointjoel.com/Lists/Posts/Post.aspx?ID=117) )，其中包含一个带有附加工作流的列表实例，该工作流已使用 Visual Studio 作为功能创建。

# linux - 在 KDE 中，如何自动判断 Konsole 终端位于哪个“桌面”？

> ID：738059
> 
> 赞同：5
> 
> 时间：2009-04-10T15:49:02.627
> 
> 标签：linux, kde

我有多个“桌面”，可以在我的 KDE Linux 环境中为不同的任务切换。如何自动确定我的 Konsole（kde 控制台）窗口显示在哪个桌面？

编辑：我在企业环境中使用 KDE 3.4

这与编程有关。我需要以编程方式（也称为自动）确定用户在哪个桌面上，然后通过 python 脚本与该桌面中的 X 窗口进行交互。

我应该四处解决所有与编程无关的 Microsoft IDE 问题吗？Win32“编程”问题怎么样？我也应该尝试关闭它们吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T16:59:31.467

实际上， **EWMH** `_NET_CURRENT_DESKTOP`为您提供了 X 的当前桌面，而不是相对于应用程序。这是获取`_WM_DESKTOP`应用程序的 C 代码段。如果从有问题的 KDE Konsole 运行，它会告诉你它所在的桌面，即使它不是活动桌面或没有焦点。

```
#include <X11/Xlib.h>
#include <X11/Shell.h>
...

Atom net_wm_desktop = 0;
long desktop;
Status ret;

/* see if we've got a desktop atom */
Atom net_wm_desktop = XInternAtom( display, "_NET_WM_DESKTOP", False);
if( net_wm_desktop == None ) {
    return;
}

/* find out what desktop we're currently on */
if ( XGetWindowProperty(display, window, net_wm_desktop, 0, 1, 
            False, XA_CARDINAL, (Atom *) &type_ret, &fmt_ret, 
            &nitems_ret, &bytes_after_ret, 
            (unsigned char**)&data) != Success || data == NULL
) {
fprintf(stderr, "XGetWindowProperty() failed");
    if ( data == NULL ) {
        fprintf(stderr, "No data returned from XGetWindowProperty()" );
    }
    return;
}
desktop = *data;
XFree(data); 
```

并且`desktop`应该是Konsole当前所在的虚拟桌面的索引。这与多头显示器的哪个头不同。如果要确定哪个头，则需要使用`XineramaQueryScreens`（Xinerama 扩展，不确定是否有等效的 XRandR。不适用于 nVidia 的 TwinView。

这是我编写的一些代码的摘录，给定 ax 和 y，计算屏幕边界（sx、sy 和 sw 与屏幕宽度和 sh 为屏幕高度）。您可以轻松地调整它以简单地返回哪个“屏幕”或头部 x 和 y 处于打开状态。（屏幕在X11中有特殊含义）。

```
#include <X11/X.h>
#include <X11/extensions/Xinerama.h>
#include <stdio.h>
#include <stdlib.h>
#include <assert.h>

Bool xy2bounds(Display* d,int x, int y, int* sx, int* sy, int* sw, int* sh) {
   *sx = *sy = *sw = *sh = -1;   /* Set to invalid, for error condition */
   XineramaScreenInfo *XinInfo;
   int xin_screens = -1;
    int i;
   int x_origin, y_origin, width, height;
   Bool found = False;

   if ( d == NULL )
      return False;
   if ( (x < 0) || (y < 0) )
      return False;

   if ( True == XineramaIsActive(d) ) {
      XinInfo = XineramaQueryScreens( d, &xin_screens );
      if ( (NULL == XinInfo) || (0 == xin_screens) ) {
         return False;
      }
   } else {
      /* Xinerama is not active, so return usual width/height values */
      *sx = 0;
      *sy = 0;
      *sw = DisplayWidth( d, XDefaultScreen(d) );
      *sh = DisplayHeight( d, XDefaultScreen(d) );
      return True;
   }

   for ( i = 0; i < xin_screens; i++ ) {
      x_origin = XinInfo[i].x_org;
      y_origin = XinInfo[i].y_org;
      width = XinInfo[i].width;
      height = XinInfo[i].height;
      printf("Screens: (%d) %dx%d - %dx%d\n", i,
            x_origin, y_origin, width, height );

      if ( (x >= x_origin) && (y >= y_origin) ) {
         if ( (x <= x_origin+width) && (y <= y_origin+height) ) {
            printf("Found Screen[%d] %dx%d - %dx%d\n",
               i, x_origin, y_origin, width, height );

            *sx = x_origin;
            *sy = y_origin;
            *sw = width;
            *sh = height;
            found = True;
            break;
         }
      }
   }

   assert( found == True );

   return found;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-10T18:32:52.477

参考接受的答案.... dcop 现在已过时；您可能想要使用 dbus 而不是 dcop（qdbus 是 dbus 的命令行工具）。

```
qdbus org.kde.kwin /KWin currentDesktop 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T17:54:52.483

KDE 窗口管理器以及 GNOME 和所有遵循[freedesktop](http://www.freedesktop.org/wiki/)标准的 WM 都支持[扩展窗口管理器提示](http://standards.freedesktop.org/wm-spec/wm-spec-latest.html#id2505544)(EWMH)。

这些提示允许开发人员以编程方式访问多个窗口管理器功能，如最大化、最小化、设置窗口标题、虚拟桌面等

我从未使用过 KDE，但 Gnome 提供了这样的功能，所以我认为 KDE 也有。

也可以使用纯[Xlib](http://tonyobryan.com/index.php?article=9)函数访问这些提示的子集。该子集是[ICCCM](http://tronche.com/gui/x/icccm/)提示。如果记忆对我有用，那么正确的虚拟桌面访问仅在 EWMH 中。

更新：[找到](http://standards.freedesktop.org/wm-spec/1.3/ar01s03.html)了！( `_NET_CURRENT_DESKTOP`)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T20:24:53.250

使用 dcop，kde 桌面通信协议，您可以轻松地执行当前桌面

```
 dcop kwin KWinInterface currentDesktop 
```

命令。如果您正在使用新的 kde 4.x dcop，则不再使用，您可以将命令转换为 DBUS 调用。使用 python api 发送/获取 dbous 消息应该非常简单。

对不起我的英语不好，埃米利奥

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-07T13:09:59.563

一个新的答案，因为这里的大多数答案都是当前桌面，而不是终端所在的桌面（如果用户在脚本运行时更改桌面，则会中断）。

`xprop -id $WINDOWID | sed -rn -e 's/_NET_WM_DESKTOP\(CARDINAL\) = ([^)]+)/\1/pg'`

我在更改桌面时循环测试了它，它工作正常（测试脚本如下，您必须在运行后手动检查输出）。

```
while true
do
  xprop -id $WINDOWID | sed -rn -e  's/_NET_WM_DESKTOP\(CARDINAL\) = ([^)]+)/\1/pg'
  sleep 1
done 
```

感谢其他答案和评论，让我走到了一半。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-08T07:31:09.630

我一直在寻找同样的东西，但还有一个限制，我不想运行 shell 命令来实现结果。从 Kimball Robinson 的回答开始，这就是我得到的。

测试在 Python3.7、Debian 10.3、KDE ​​Plasma 5.14.5 中工作。

```
import dbus 

bus = dbus.SessionBus()
proxy = bus.get_object("org.kde.KWin", "/KWin")
int( proxy.currentDesktop(dbus_interface="org.kde.KWin") ) 
```

# java - Java 注释

> ID：738065
> 
> 赞同：15
> 
> 时间：2009-04-10T15:51:28.877
> 
> 标签：java, annotations

我在 Java 中创建了简单的注释

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
public @interface Column {
    String columnName();
} 
```

和班级

```
public class Table {

    @Column(columnName = "id")
    private int colId;

    @Column(columnName = "name")
    private String colName;

    private int noAnnotationHere;

    public Table(int colId, String colName, int noAnnotationHere) {
       this.colId = colId;
       this.colName = colName;
       this.noAnnotationHere = noAnnotationHere;
    }  
} 
```

我需要遍历所有带有注释的字段，`Column`并获取字段和注释的**名称**和**值**。但是我在获取每个字段的**值**时遇到了问题，因为它们都是不同的**数据类型**。

**有什么可以返回具有特定注释**的字段集合吗？我设法用这段代码做到了，但我不认为反射是解决它的好方法。

```
Table table = new Table(1, "test", 2);

for (Field field : table.getClass().getDeclaredFields()) {
    Column col;
    // check if field has annotation
    if ((col = field.getAnnotation(Column.class)) != null) {
        String log = "colname: " + col.columnName() + "\n";
        log += "field name: " + field.getName() + "\n\n";

        // here i don't know how to get value of field, since all get methods
        // are type specific

        System.out.println(log);
    }
} 
```

我是否必须将每个字段包装在对象中，这将实现类似的方法`getValue()`，还是有更好的方法来解决这个问题？基本上我所需要的只是每个被注释的字段的字符串表示。

编辑：是的`field.get(table)`，但仅适用于`public`字段，即使对于字段，有什么方法可以做到这一点`private`吗？还是我必须制作吸气剂并*以某种方式*调用它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T15:58:52.683

每个对象都应该定义 toString()。（并且您可以为每个类覆盖它以获得更有意义的表示）。

所以你的“//这里我不知道”评论在哪里，你可以有：

```
Object value = field.get(table);
// gets the value of this field for the instance 'table'

log += "value: " + value + "\n";
// implicitly uses toString for you
// or will put 'null' if the object is null 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-10T15:59:05.677

反射*正是*解决它的方法。在执行时找出有关类型及其成员的信息几乎就是反射的定义！你做的方式在我看来很好。

要查找字段的值，请使用[`field.get(table)`](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Field.html#get())

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-10T16:00:39.603

反射正是查看注释的方式。它们是附加到类或方法的一种“元数据”形式，Java 注释被设计为以这种方式进行检查。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T16:19:55.753

反射是处理对象的一种方法（如果字段是私有的并且没有任何类型的访问器方法，可能是唯一的方法）。您需要查看[Field.setAccessible](http://java.sun.com/javase/6/docs/api/java/lang/reflect/AccessibleObject.html#setAccessible(boolean))，也许还有[Field.getType](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Field.html#getType())。

另一种方法是使用[编译时注释处理器](http://java.sun.com/j2se/1.5.0/docs/guide/apt/GettingStarted.html)生成另一个用于枚举带注释字段的类。这需要 Java 5 中的*com.sun* API，但 Java 6 JDK 的支持更好（Eclipse 等 IDE 可能需要特殊的项目配置）。

# agile - 在敏捷中还清技术债务

> ID：738067
> 
> 赞同：9
> 
> 时间：2009-04-10T15:51:50.360
> 
> 标签：agile

如果您正在使用敏捷，则其想法是始终进行增量重构，并且永远不会积累大量技术债务。话虽如此，如果您有一个敏捷团队正在接管具有大量技术债务的软件，那么您必须将其安装在某个地方。

你去创建开发者用户故事。。例如 。

*   作为开发人员，我对业务逻辑模块有 50% 的测试覆盖率，因此我对交付充满信心
*   作为开发人员，该应用程序支持依赖注入，因此我们可以换掉混凝土，并在未来变得更加敏捷。

还是有另一种清理此代码技术债务的最佳实践

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T16:08:44.047

您的应用程序是内部应用还是有外部客户？如果客户为您在应用程序上的工作和支持付费，可能很难让他们在您建议的卡片上签字。

此外，根据您的第二张卡片创意，可能很难说出“完成”是什么。

解决您的问题的一种特定方法可能是缺陷驱动测试——这个想法是，当您收到错误报告并估计说要修复它的卡时，看看您可以同时添加哪些类似但增加覆盖率。

而且您不会专门询问有关如何让您的项目接受测试的技术细节，但是一旦您开始实际操作，这本书就会非常有帮助：[有效地使用遗留代码](http://www.google.com/search?&q=working+effectively+with+legacy+code)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T17:17:12.193

应该区分工程实践和技术债务。我将测试驱动开发和自动化测试视为实践。

采用瀑布团队构建的代码资产后，这些资产没有自动化的单元、功能或性能测试。当我们承担软件资产的责任时，我们对产品负责人进行了敏捷培训，并告诉他们我们将使用的实践。

一旦我们开始使用这些实践，我们就开始识别技术债务。随着技术债务的确定，产品所有者将编写技术故事卡并将其放在产品待办事项列表中。开发人员和测试人员使用 XP 工程实践（TDD、自动化测试、结对编程等）估计所有工作。这些实践通过 TDD、自动化功能和性能测试确定了代码中的脆弱性。特别是，通过自动化性能测试和分析发现了一个重要的性能问题。债务如此之大，我们估计修复需要 6 次迭代。我们通知产品负责人，如果开发了新功能，由于应用程序性能不佳，用户群将无法使用它们。鉴于我们必须将应用程序从几百个用户扩展到成千上万个用户，

注意：可以在故事卡的估计范围内通过重构来修复的技术债务不需要技术故事卡。更大的技术债务将。对于需要技术卡的技术债务，确定业务影响并要求产品所有者优先考虑技术卡。然后办卡。不要为工程实践创造技术债务。做所有的估计都知道工程实践将成为估计的一部分。不要创建卡片来通过自动化单元、功能和性能测试来改造应用程序。相反，仅将工作包含在您正在估算的卡片中，并将自动化测试添加到您通过正在工作的卡片触摸的代码中。这将使应用程序能够随着时间的推移而改进，而不会停止进展。

假设您继承了没有自动化单元、功能和性能测试的代码库，请告知业务合作伙伴这种可悲的情况。让他们知道您将如何估算工作。创造技术债务，因为它是通过工程实践发现的。最后，通知产品负责人，随着越来越多的代码库被自动化单元、功能和性能测试所触及，团队的速度将会提高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T14:20:55.617

我在敏捷环境中工作，但是在采用敏捷技术之前，当前的代码库已经存在了几年。这导致不得不尝试以敏捷的方式工作，围绕着没有考虑自动回归测试编写的代码。

由于技术债务会影响我们交付新功能的速度，因此我们会记录由于使用遗留代码而增加了多少时间。这些数据使我们能够为专门用于偿还技术债务的时间提供理由。因此，当客户（无论是经理、CTO 或其他任何人）认为估算值太高时，您拥有的数据可以巩固您的地位。

当然，有时你会发现你的估计因为遗留代码的意外怪癖而**不得不**偿还技术债务。我们发现，只要可以解释和解释额外时间，并且可以为额外时间所花的好处提出案例，它就被普遍接受了。

当然，YMMV 取决于客户或其他因素，但拥有代表未来技术债务影响的统计数据非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T15:21:31.773

我认为询问客户希望使用该应用程序的时间是一个好主意。如果应用程序的生命周期有限（例如，三年或更短），那么在重构上投入大量精力可能没有意义。如果预期（或希望）寿命更长，那么重构的回报就会变得更具吸引力。

您可能还想尝试为重构投资创建业务案例。展示您想要进行的改进类型的具体示例。对成本、风险和预期回报进行诚实的评估。尝试找到可以独立于其他人实施的特定重构，并游说批准将更改作为重构过程的测试运行。

请注意，当您谈论回报时，您可能需要提供具体数字。仅仅说“修复错误会容易得多”是不够的。相反，您应该准备好说“我们将看到错误修复的周转时间至少提高 30%”或“我们将减少 40% 的回归”。您还应该准备好与管理层和/或客户进行谈判，以便您都同意您拥有对他们有意义的度量，并提供重构前后的度量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-17T15:15:54.217

每次我们提交代码时，减少技术债务是每个人都应该做的事情。

当你编辑代码时，你会稍微整理一下，就像离开露营地之前的侦察员一样。

这样，经常更改的代码将处于更好的状态，这对业务有好处。

永不改变的代码不会改进，但是如果它有效，为什么还要它呢？

不要为此安排任务，尽管长期计划是有帮助的，就像讨论问题的论坛一样。

非常大的项目将受益于某种锁定方案，这样两个编码人员就不会在不同步的情况下同时重构同一段代码。

/罗杰

# php - 在文档根目录中拥有最新的 SVN 文件副本

> ID：738068
> 
> 赞同：0
> 
> 时间：2009-04-10T15:51:55.787
> 
> 标签：php, svn, apache

不久前我问了[链接文本](https://stackoverflow.com/questions/567971/how-to-set-up-svn-with-files-that-are-in-an-htdocs-directory-structure "这个问题")，我得到了一些很好的答案。我想知道是否有办法将文件保存在我的 Web 应用程序文档根目录下，并且当我进行更改时，将它们提交回存储库。

据我了解，为了处理文件，它们不能位于网络根目录中。不得不将它们移到其他地方只是为了处理它们对我来说似乎违反直觉。我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T16:00:00.620

只需将 svn repo 检出到一个目录并将该目录设置为 Web 根目录。您将希望有一个不会为 .svn 目录提供服务的 apache 策略，但除此之外没有问题。

这是我在 httpd.conf 中保护 svn 目录的内容：

`#Protect svn directories
`<DirectoryMatch "^/.*/(\.svn|CVS)/">`
Order deny,allow
Deny from all
`</DirectoryMatch>`` 

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T17:24:36.313

> 为了处理文件，它们不能位于网络根目录中

这是没有道理的。也许您正在考虑这样一个事实，即可以*由 Web 服务器*修改/编辑的文件不应位于文档根目录下。但是，只要您不使用服务器本身进行编辑（例如，如果您创建了某种文本编辑器 Web 应用程序，就会出现这种情况），在文档根目录。

您可能对我的设置感兴趣：我有一个存储库，它将我的网站保存在与我的 Web 服务器相同的物理机器上。一个工作副本被签出到该机器上的 Web 根目录中，我在笔记本电脑上签出了另一个工作副本，我在那里进行开发和测试。现在有趣的部分是：我在 SVN 存储库中添加了一个钩子，以便每次将任何内容提交到存储库时，它都会自动更新 Web 根目录中的工作副本。这样，Web 根目录始终拥有网站代码的最新版本，但我仍然可以在网站上工作而无需访问服务器。

*编辑*：这[是脚本](http://www.ellipsix.net/ext-tmp/autoupdatehook.sh)

# ruby-on-rails - 按列对 ActiveRecord 对象数组进行排序

> ID：738069
> 
> 赞同：0
> 
> 时间：2009-04-10T15:52:14.710
> 
> 标签：ruby-on-rails, activerecord

我需要按其中一列中的值对 ActiveRecord 对象数组进行排序，但不确定如何执行此操作。

例如，我有一个具有 Duration 列的 Schedule 模型。然后，我有两个 Schedule 对象 OriginalList 和 NewList 数组。我想按持续时间对每个列表进行排序。我想我正在寻找类似的东西： -

```
Schedule.find(:all, 
              :conditions => "schedule_id IN (select schedule_id from 
                                              #{array.each.schedule_id}",
              :order => 'duration') 
```

然而，这看起来根本不对！甚至在 SQL 中也没有！

任何有关如何执行此操作的提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T15:58:28.067

哎呀。忽略那个！通过写下来，我想出了我真正想做的事情。

```
Schedule.find(:all, :conditions => "schedule_id in ("1", "2", "3"), :order => "duration") 
```

其中 1、2、3 可以在调用之前从数组中生成。

周五下午就怪它了！:D

# java - 如何为使用 X.509 保护的 WCF 服务制作 Java 客户端？

> ID：738071
> 
> 赞同：2
> 
> 时间：2009-04-10T15:52:31.277
> 
> 标签：java, wcf, web-services, security, interop

我有一个使用 X.509 证书进行身份验证的 WCF 服务。创建可以使用该服务的 Java 客户端的最佳方法是什么？我听说过 Axis、CXF、Tango 和 WSS4J，但我不确定哪个支持 X.509，哪个是使用 WCF 的好方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T00:12:57.960

我猜想[Apache Axis2](http://ws.apache.org/axis2/)或[Sun 的 Metro](https://metro.dev.java.net/)。两者都支持开箱即用的 WS-Security。不过，您可能需要调整一些细节才能让他们说话。请参阅[Yaron Naveh 的 Web 服务 2.0 博客](http://webservices20.blogspot.com/search/label/Web%20Services%20Interoperability)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T05:38:15.617

是否需要在信封中支持 ws-security 标记？还是 ssl 连接本身依赖于客户端证书身份验证？（我会将此添加为评论而不是答案，但我没有必要的 50 声望。）

# visual-c++ - 如何在 MFC 中将字符串放入字符串表中？

> ID：738081
> 
> 赞同：2
> 
> 时间：2009-04-10T15:54:46.700
> 
> 标签：visual-c++, mfc, localization

我正在尝试本地化一个大型 MFC 项目，其中所有字符串都被硬编码到源代码中。（这是当时最容易做的事情，在我们还没有想到要扩展到其他市场之前。）我看过本地化工具，他们总是说首先将所有字符串放入 .rc 文件中，或者只是假设它已经完成。在我检查过的那些中，appTranslator 是唯一一个甚至暗示它可能是一个问题，并提供了几个方便的功能来减少生成的源代码的冗长。

有没有人比手动浏览数百个文件并在此过程中偶尔犯错误有更好的主意？

是否有某种产品可以提供帮助？

有没有人有这样做的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T16:16:38.473

可以肯定的是，这是一个乏味的过程。很多年前我就参与了这样的努力。我们是手动完成的。您可能可以编写一些通用代码，使加载、检查等工作都非常干净，而且膨胀最小。

我不知道有什么产品可以为您做到这一点。

CStrings 可能是你的朋友——使用 LoadString() 成员。

我要么从 CString 派生，要么编写一些其他代码来封装默认值（可能是它们当前的硬编码值）和其他错误条件，然后使用它来代替硬编码字符串。

如果您不想使用 CString，那么从 std::string 派生并使用全局 LoadString() 也可以。

至于工具：不确定它们是否适合您的情况： [http ://www.modelmakertools.com/articles/hard-coded-strings.html](http://www.modelmakertools.com/articles/hard-coded-strings.html)

显然这个工具可以在你的 exe 文件中找到所有的字符串： [http](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx) ://technet.microsoft.com/en-us/sysinternals/bb896653.aspx 然后你可以搜索并替换它们。

我认为编写一个工具会相当简单 - 查找 " 字符，然后在 rc 文件中创建一个与它来自的 .cpp 或 .h 文件相对应的条目。你将有很多剔除要做，但它是一个开始。您可以替换文本，或插入注释等。您可以在#include 中使用资源ID/名称的行号和文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-06T19:51:53.527

我知道为时已晚，但对于搜索引擎而言。
CString 有一个特性可以从资源 ID 初始化它。

```
CString((LPCTSTR)IDS_RESOURCE_ID) 
```

# php - 如何使用 php 将从下拉列表中选择的日期插入到 mySQL 表中？

> ID：738083
> 
> 赞同：0
> 
> 时间：2009-04-10T15:55:53.657
> 
> 标签：php, mysql, date, insert, drop-down-menu

当您有 5 个日期选择下拉菜单（Y、m、d、H、i）时，如何使用 PHP5 将选定的日期和时间作为日期时间插入到 mySQL 表的单个列中？

我知道它们需要组合成一个字符串，例如：

```
$DateTime="$Year-$Month-$Day $Hour:$Minute:00"; 
```

然后也许使用strtotime：

```
$Date=date('Y-m-d H:i:s', strtotime($DateTime)) ; 
```

但是我在哪里声明变量以及如何将其构建到查询中，例如：

```
if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "details")) {

$insertSQL = sprintf("INSERT INTO sessions (Location1, Location2, Date)
 VALUES (%s, %s, $s)",

                       GetSQLValueString($_POST['Location1'], "text"),
                       GetSQLValueString($_POST['Location2'], "text"),
                       GetSQLValueString($_POST[' ???? '], "date")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T16:04:57.643

您还可以查看 mktime() 函数：[http ://ca.php.net/mktime](http://ca.php.net/mktime)

然后，您只需要声明您的日期变量，例如：

```
$date = mktime($_POST['H'],$_POST['i'],0,$_POST['m'],$_POST['d'],$_POST['Y']);

$location1 = mysql_real_escape_string( $_POST['Location1'];
$location2 = mysql_real_escape_string( $_POST['Location2'];

$insertSQL = "INSERT INTO sessions (Location1, Location2, Date) VALUES ('$location1', '$location2', $date)";

mysql_query( $insertSQL ); 
```

**编辑：**

或者，使用您正在使用的 sprintf 格式：

```
$date = mktime($_POST['H'],$_POST['i'],0,$_POST['m'],$_POST['d'],$_POST['Y']);  

$insertSQL = sprintf("INSERT INTO sessions (Location1, Location2, Date)
     VALUES (%s, %s, $s)",

                           GetSQLValueString($_POST['Location1'], "text"),
                           GetSQLValueString($_POST['Location2'], "text"),
                           GetSQLValueString($date, "date")); 
```

不过，我以前从未使用过 GetSQLValueString 函数，所以我只能假设这是使用它的正确方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T21:27:05.170

创建一个在“显示模式”和 MySQL 模式之间转换的实用程序函数，将来会在其他几个项目中派上用场。

[Date](http://uk3.php.net/date) - 返回一个字符串，根据给定的格式字符串格式化

[MkTime](http://uk3.php.net/manual/en/function.mktime.php) - 获取日期的 Unix 时间戳

[Strtotime](http://uk3.php.net/manual/en/function.strtotime.php) - 将英文文本日期时间描述解析为 Unix 时间戳

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T11:01:20.503

MySQL 提供了一个函数来使您轻松完成此操作。 `FROM_UNIXTIME()`. 我会使用`mktime()`将您的日期设置为时间戳，因为它的开销远小于 strtodate，因为您知道日期部分，因此无需将其解析为字符串。

以下是我能想到的最直接的方法：

```
$date = mktime($_POST['H'], $_POST['i'], 0, $_POST['m'], $_POST['d'], $_POST['Y']);

$location1 = mysql_real_escape_string( $_POST['Location1'];
$location2 = mysql_real_escape_string( $_POST['Location2'];

$insertSQL = "INSERT INTO sessions (Location1, Location2, Date) VALUES ('$location1', '$location2', FROM_UNIXTIME($date))"; 
```

我假设那`GetSQLValueString`是 Dreamweaver 自定义功能（我只听说过）。不过，我相信您可以将其应用到您的实现中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T17:12:06.507

感谢所有试图提供帮助的人 - 答案要简单得多（我猜是金发时刻！哈哈）只需将 post 变量声明为：

$_POST['startDate'] ="$Year-$Month-$Day $Hour:$Minute:00";

无需时间转换，因为它已经是 Mysql 格式（是的！）

# .net - .NET 文件系统包装库

> ID：738084
> 
> 赞同：9
> 
> 时间：2009-04-10T15:56:02.893
> 
> 标签：.net, mocking

出于某种原因，我找不到，但肯定有人已经创建了一个 .NET IO 库包装器。我希望能够模拟对 File.Exists 等的调用，而内置的静态方法对此并不适用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T04:00:36.717

我比你早几分钟找到了[SystemWrapper ，但你的更适合我的目的。](http://systemwrapper.codeplex.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T16:01:17.200

还有一个[FileInfo 类](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)，它的作用与静态方法相同。

另一方面，您可能不想模拟整个 FileInfo 类。相反，您希望将所有文件操作放入一个类中，然后从该类中提取一个接口（描述公共方法），并使用该接口来模拟*您*执行的文件操作，而不是模拟整个操作集微软认为应该在 FileInfo 类中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T15:57:02.830

所有好的答案，但他们都离开了我开始的地方——为我最终从事的每个项目重新创建某种 IFileSystem。我最终围绕 .NET 库创建了一个通用[IFileSystem](http://code.google.com/p/sneal/source/browse/trunk/Core/Sneal.Core/IO/IFileSystem.cs)库，我可以在所有项目之间重用它。不是很好，但它现在有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-07T06:38:15.450

我在 CodePlex 上维护[Jolt.NET](http://jolt.codeplex.com)项目，其中包含一个库，可以为您生成此类接口及其实现。有关更多信息，请参阅[Jolt.Testing](http://jolt.codeplex.com/Wiki/View.aspx?title=Jolt.Testing)库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-04T15:11:08.647

[https://github.com/tathamoddie/System.IO.Abstractions](https://github.com/tathamoddie/System.IO.Abstractions)允许您执行此操作（来自 github 的示例）

```
public class MyComponent
{
readonly IFileSystem fileSystem;

// <summary>Create MyComponent with the given fileSystem implementation</summary>
public MyComponent(IFileSystem fileSystem)
{
    this.fileSystem = fileSystem;
}
/// <summary>Create MyComponent</summary>
public MyComponent() : this( 
    fileSystem: new FileSystem() //use default implementation which calls System.IO
) 
{
}

public void Validate()
{
    foreach (var textFile in fileSystem.Directory.GetFiles(@"c:\", "*.txt", SearchOption.TopDirectoryOnly))
    {
        var text = fileSystem.File.ReadAllText(textFile);
        if (text != "Testing is awesome.")
            throw new NotSupportedException("We can't go on together. It's not me, it's you.");
    }
}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T16:07:19.620

而不是寻找包装整个文件系统的库。为什么不创建一个简单的 IFileSystem 接口并开始添加您需要的方法。

你的应用程序的其余部分应该依赖于 IFileSystem ，这将允许模拟

您可以拥有一个简单地调用 .Net 提供给您的静态方法的实现，然后您的代码可以依赖于接口。

# ruby - 将鞋子集成到 Aptana Studio RadRails

> ID：738092
> 
> 赞同：2
> 
> 时间：2009-04-10T15:58:42.853
> 
> 标签：ruby, ide, aptana, shoes

如何使用 RadRails 直接从 Aptana Studio运行我的[Carpet应用程序？](http://shoooes.net)将 shoes.exe 设置为 VM/Interpreter 将不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T12:12:17.997

如果您在 Ruby 项目中有该文件，则可以执行以下操作：

1.  转到运行 -> 外部工具 -> 外部工具...
2.  创建一个新工具，给它命名（比如，“鞋子”）
3.  将 Location 设置为 Shoes 二进制文件，例如，在我的系统上它是`C:\Program Files\Common Files\Shoes\0.r1134\shoes.exe`
4.  将工作目录设置为`${workspace_loc}${project_loc}` （您可以更改它以满足您的需要，但我假设项目的基本目录与设置工作目录一样好）
5.  将参数设置为**应该**`"${workspace_loc}${resource_path}"`包含 双引号，否则路径中的任何空格都会搞砸。

 **就是这样。现在您可以通过运行 -> 外部工具 -> 鞋子，或使用工具栏上的外部工具图标来运行它。

# rss - 在线收集 RSS 源？

> ID：738118
> 
> 赞同：1
> 
> 时间：2009-04-10T16:08:21.163
> 
> 标签：rss, feed

我希望能够在线收集 RSS 提要，以替代使用定期运行的进程在台式计算机上收集它们。

理想情况下，它要么收集所有提要，并在找到新提要后立即将它们通过电子邮件发送到一个地址（甚至不检查新提要），或者汇总所有较小的提要并将它们作为批量较大的提要发送出去，而不是定期发送.

它必须不断地在 Web 服务器上运行，但是能够收集所有的提要会很好，而不仅仅是当提要阅读器在我的机器上运行时我碰巧捡到的提要。有这样的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T01:56:19.347

只需使用谷歌阅读器。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T08:41:36.467

[谷歌阅读器](https://www.google.com/reader)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T02:05:33.287

也许[雅虎的管道](http://pipes.yahoo.com/pipes/)可以帮助你。这是一种组合和操作提要的有趣方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T04:42:44.723

我不确定您是否曾经使用过它，但 iGoogle 允许您自定义 google 主页以显示来自网络的信息。您可以向页面添加选项卡以允许您拆分信息。它非常有用，因为您可以从任何计算机/浏览器登录它，您可以在任何地方访问您的提要。

如果您有很多一种类型的提要或不经常更新的提要，那么 iGoogle 也可以与谷歌阅读器结合使用。

它也非常适合添加其他插件，如 gmail、游戏、Dilbert :) 等等。

要创建 iGoogle 页面，请转到 google 主页并单击右上角的 iGoogle 链接。然后，iGoogle 将为您提供一个起始页和一些您可以添加或忽略的建议内容。如果您单击“添加资料”链接，然后单击“添加提要或小工具”，您可以手动添加所有 RSS 提要。但是，您也可以将 Firefox 配置为在您单击导航栏中的 RSS 提要图标时自动选择 google 作为您的 RSS 阅读器。您可以在工具 -> 选项 -> 应用程序 -> Web Feed 下选择/更改它。

为了在多个浏览器/计算机上使用您的 iGoogle，您需要一个 gmail / google 帐户，但它是免费且易于创建的。

吨

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T05:15:41.087

如果您安装了 PHP，[simplepie非常棒。](http://simplepie.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T05:18:40.067

如果您使用 python 编程，[Universal Feed Parser可能会有所帮助](http://www.feedparser.org/)

# sql-server-2005 - SQL Server 2005：复制，varbinary

> ID：738121
> 
> 赞同：3
> 
> 时间：2009-04-10T16:09:12.253
> 
> 标签：sql-server-2005, replication, varbinary

# 设想

在我们的复制方案中，我们复制了许多表，包括一个`photos`包含二进制图像数据的表。所有其他表都按预期复制，但照片表没有。我怀疑这是因为照片表中的数据量较大，或者可能是因为图像数据是一个`varbinary`字段。但是，使用较小的`varbinary`字段并没有帮助。

# 配置信息

这是一些配置信息：

*   每个图像可以是 65-120 Kb 的任何地方
*   修订和批准的副本与缩略图一起存储，因此单行可能接近约 800Kb
*   我曾经遇到过“ ”配置字段的问题，但我已使用and`max text repl size`将其设置为最大值`sp_configure``reconfigure with override`
*   照片是根据“已发布”字段过滤的，但其他工作表也是如此
*   数据库使用相同的本地数据库服务器（在开发环境中）并配置为事务复制
*   复制的数据库使用“推送”订阅

此外，我注意到有时重新生成快照并重新初始化订阅会导致图像复制。考虑到这一点，我将快照代理配置为每分钟左右重新生成一次快照以用于调试目的（显然这对于​​生产环境来说太过分了）。然而，这并没有帮助。

# 问题

是什么导致`photos`表不复制而所有其他表都没有问题？有没有解决的办法？如果没有，我将如何进一步调试？

# 笔记

我使用 SQL Server Profiler 和复制监视器来查找错误。不存在错误。据我所知，该操作只是默默地失败了。

我在 Windows Server 2003 Service Pack 2 上使用 SQL Server 2005 和 Service Pack 3。

# [更新]

我发现[Philippe Grondier](https://stackoverflow.com/users/11436/philippe-grondier)在下面的回答中绝对正确。图像、视频和其他二进制文件不应存储在数据库中。IIS 处理这些文件的效率比我高得多**。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T22:03:50.133

对于您的问题，我没有直接的答案，因为我们的标准政策一直是“永远不要在（数据库）字段中存储（图片）文件”。我们的解决方案不仅适用于图片，而且适用于任何类型的文件或文档，现在已成为标准：

*   我们的数据库中有一个“文档”表，其中存储了文档/文件名和相关文件夹（为了获得唯一的文档/文件名，我们从“文档”表的主键/唯一标识符值生成它们）。

这个“文档”表在我们的不同订阅者之间复制，就像所有其他表一样

*   我们在每个数据库服务器上都有一个“文档”文件夹和子文件夹。
*   然后使用一些文件和文件夹复制软件独立于数据库复制文档文件夹（allwaysynch 是一个选项）
*   主要发布者的文件夹可通过 ftp 完全访问，其中将建议尝试读取本地服务器上不可用的文档（仍然）的用户通过 ftp 客户端软件（例如 coreFTP 及其命令行选项）从主服务器下载它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T19:17:31.940

对于这样的图像表，您是否考虑过将该文章移至单向（或双向，如果您愿意）合并出版物？这可能会缓解您的一些问题。

# mysql - 名称是MySQL中的保留字吗？

> ID：738124
> 
> 赞同：6
> 
> 时间：2009-04-10T16:12:27.283
> 
> 标签：mysql

`name`我可以在我的 mysql 表中命名一个列吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-10T16:15:20.693

为什么不试试呢？

```
mysql> select name from name;
+------+
| name |
+------+
|    1 |
+------+ 
```

您也可以用 `` 引用任何名称。

```
mysql> select `from` from `from`;
+------+
| from |
+------+
|    1 |
+------+ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T16:14:46.857

您应该可以调用列“名称”。查看[http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html)以获取有关如何处理保留字的更多详细信息。

用 (`) 字符包裹列名可确保即使保留字也不会被误解。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-10T16:15:06.717

**是**的，即使它是一个人名，我也会推荐*FirstName*或*FullName*作为列名，以便更具体[MYSQL 保留字](http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-10T16:17:57.690

无论您是否*可以*，您可能首先要考虑*为什么*要这样做。什么名字？什么样的名字？几年后，如果你再看看数据库模式，你还会记得这些细节吗？

我建议将列名与对待任何变量名一样对待，并给它一个描述性的名称，这将符合你的最大利益。多年后，您（或维护您的代码的任何人）将感谢您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-15T11:53:57.347

这里只提一句。由于字段名称`name`很好。

然而，在存储过程中，名称作为**变量**会做其他事情。

考虑以下过程。当我调用这个过程时，它总是会改变我的配置数据库中的第一条记录。一旦我将名为 name 的变量重命名为其他名称，一切正常。

```
PROCEDURE `updateConfig`(IN name VARCHAR(255), IN val VARCHAR(255))
BEGIN
UPDATE LOW_PRIORITY `config`
  SET `value`=val
  WHERE `name` = name
  LIMIT 1;
END 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T16:15:07.323

```
CREATE TABLE mytest (name INT);

SELECT  *
FROM    mytest;

name
-------- 
```

在可疑的情况下，您可以将名称包含在重音中：

```
CREATE TABLE `CREATE TABLE` (name INT);

SELECT  *
FROM    `CREATE TABLE`;

name
-------- 
```

# .net - 动态重新配置 Log4Net

> ID：738126
> 
> 赞同：17
> 
> 时间：2009-04-10T16:14:29.540
> 
> 标签：.net, configuration, log4net

我正在寻找有关在我的 ASP.NET 应用程序中动态重新配置 Log4Net 日志记录级别的最佳方法的提示。我通常使用一个简单的配置，根记录器定义默认的日志记录级别，例如

```
<log4net>
    <root>
    <level value="INFO" />
    <appender-ref ref="..." />
    <appender-ref ref="..." />
    ... etc ...     
    </root>
    ... etc 
```

并且可能有几个附加程序，每个附加程序都有过滤器来定义它们使用的日志记录级别。

1.  我想做的第一件事是允许管理员连接到管理页面，使他们能够 (a) 查看根记录器的当前级别并 (b) 动态更改它。我不想使用“ConfigureAndWatch”并写入磁盘上的配置文件，因为我不希望这些更改在应用程序被回收时持续存在。

2.  接下来我想更进一步，在管理页面上能够显示一个 TreeView，其中包含应用程序中存在的所有当前记录器，以及它们当前的日志记录级别。并允许管理员能够在层次结构的任何级别有选择地更改日志记录级别。

这个想法是创建一个通用的管理页面，我可以将它放入我的所有应用程序中，允许管理员有选择地动态启用调试级别的日志记录以进行故障排除。

我发现 Log4Net API 有点令人困惑，任何人都可以指出示例或展示实现此目的的最佳方法。

**更新：**

两个答案都一样好，所以我接受了第一个 - 谢谢。重复一下，我可以得到所有当前的记录器，如下所示：

```
foreach (log4net.ILog log in log4net.LogManager.GetCurrentLoggers())
{
    log4net.Repository.Hierarchy.Logger logger = 
         (log4net.Repository.Hierarchy.Logger)log.Logger;
    Debug.WriteLine(
        String.Format("{0} Parent {1} Level {2} EffectiveLevel {3}<br>",
        logger.Name,
        logger.Parent.Name,
        logger.Level == null ? "<null>" : logger.Level.Name,
        logger.EffectiveLevel
        )
        );
} 
```

*   EffectiveLevel 是有效级别 - 如果后者不为 null，则与 Level 相同，否则从父级继承。

*   上面返回的至少一个记录器将根记录器作为父记录器，这使我能够获得对根记录器的引用。

有了上述内容，应该可以重建记录器层次结构。

**更新 2**

再次感谢。我已经实现了一个 ASP.NET 服务器控件，它在带有复选框的 TreeView 中显示记录器层次结构，并允许用户在层次结构中的任何节点上动态更改日志记录级别。效果很好，我将把它放在我所有 ASP.NET Web 和 Web 服务应用程序的管理页面上！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-10T17:04:09.857

您是否正在寻找这样的东西（未经测试的代码）：

```
foreach (ILog logger in log4net.LogManager.GetCurrentLoggers())
{
  ((log4net.Repository.Hierarchy.Logger)logger).Level = 
      log4net.Core.Level.Error;
} 
```

您显然可以以相同的方式提取记录器名称等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T17:06:06.297

我已经成功地以编程方式更改了 log4net 记录器的日志记录级别，但如何从公共 API 中执行此操作并不明显。鉴于此记录器：

```
private readonly log4net.ILog mylogger; 
```

您必须执行以下花哨的步骤才能将其设置为 Debug：

```
((log4net.Repository.Hierarchy.Logger)mylogger.Logger).Level =
 log4net.Core.Level.Debug; 
```

对于某些情况——我不知道是什么导致了这个更复杂的要求——您可能需要按照文章[log4net 中显示的额外步骤并更改记录器级别](http://geekswithblogs.net/rakker/archive/2007/08/22/114900.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T11:42:37.350

可能不是您想要的，但是：

```
using System;
using System.Collections.Generic;
using System.Text;
using log4net;
using log4net.Config;
using NUnit.Framework;

namespace ExampleConsoleApplication
{
  enum DebugLevel : int
  { 
    Fatal_Msgs = 0 , 
    Fatal_Error_Msgs = 1 , 
    Fatal_Error_Warn_Msgs = 2 , 
    Fatal_Error_Warn_Info_Msgs = 3 ,
    Fatal_Error_Warn_Info_Debug_Msgs = 4 
  }

    class TestClass
    {

        private static readonly ILog logger =
                 LogManager.GetLogger ( typeof ( TestClass ) );

        static void Main ( string[] args )
        {
      TestClass objTestClass = new TestClass ();

            Console.WriteLine ( " START " );

      int shouldLog = 4; //CHANGE THIS FROM 0 TO 4 integer to check the functionality of the example
      //0 -- prints only FATAL messages 
      //1 -- prints FATAL and ERROR messages 
      //2 -- prints FATAL , ERROR and WARN messages 
      //3 -- prints FATAL  , ERROR , WARN and INFO messages 
      //4 -- prints FATAL  , ERROR , WARN , INFO and DEBUG messages 

      string srtLogLevel = String.Empty ; 
      switch (shouldLog)
      {
        case (int)DebugLevel.Fatal_Msgs :
          srtLogLevel = "FATAL";
          break;
        case (int)DebugLevel.Fatal_Error_Msgs:
          srtLogLevel = "ERROR";
          break;
        case (int)DebugLevel.Fatal_Error_Warn_Msgs :
          srtLogLevel = "WARN";
          break;
        case (int)DebugLevel.Fatal_Error_Warn_Info_Msgs :
          srtLogLevel = "INFO"; 
          break;
        case (int)DebugLevel.Fatal_Error_Warn_Info_Debug_Msgs :
          srtLogLevel = "DEBUG" ;
          break ;
        default:
          srtLogLevel = "FATAL";
          break;
      }

        objTestClass.SetLogingLevel ( srtLogLevel );

      objTestClass.LogSomething ();

            Console.WriteLine ( " END HIT A KEY TO EXIT " );
            Console.ReadLine ();
            } //eof method 

    /// <summary>
    /// Activates debug level 
    /// </summary>
    /// <sourceurl>http://geekswithblogs.net/rakker/archive/2007/08/22/114900.aspx</sourceurl>
    private void SetLogingLevel ( string strLogLevel )
    {
     string strChecker = "WARN_INFO_DEBUG_ERROR_FATAL" ;

      if (String.IsNullOrEmpty ( strLogLevel ) == true || strChecker.Contains ( strLogLevel ) == false)
        throw new Exception ( " The strLogLevel should be set to WARN , INFO , DEBUG ," );

      log4net.Repository.ILoggerRepository[] repositories = log4net.LogManager.GetAllRepositories ();

      //Configure all loggers to be at the debug level.
      foreach (log4net.Repository.ILoggerRepository repository in repositories)
      {
        repository.Threshold = repository.LevelMap[ strLogLevel ];
        log4net.Repository.Hierarchy.Hierarchy hier = (log4net.Repository.Hierarchy.Hierarchy)repository;
        log4net.Core.ILogger[] loggers = hier.GetCurrentLoggers ();
        foreach (log4net.Core.ILogger logger in loggers)
        {
          ( (log4net.Repository.Hierarchy.Logger)logger ).Level = hier.LevelMap[ strLogLevel ];
        }
      }

      //Configure the root logger.
      log4net.Repository.Hierarchy.Hierarchy h = (log4net.Repository.Hierarchy.Hierarchy)log4net.LogManager.GetRepository ();
      log4net.Repository.Hierarchy.Logger rootLogger = h.Root;
      rootLogger.Level = h.LevelMap[ strLogLevel ];
    }

    private void LogSomething ()
    {
      #region LoggerUsage
      DOMConfigurator.Configure (); //tis configures the logger 
      logger.Debug ( "Here is a debug log." );
      logger.Info ( "... and an Info log." );
      logger.Warn ( "... and a warning." );
      logger.Error ( "... and an error." );
      logger.Fatal ( "... and a fatal error." );
      #endregion LoggerUsage

    }
    } //eof class 

} //eof namespace 

#region TheAppConfig
/*
 <?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <section name="log4net"
                 type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
    </configSections>
    <log4net>
        <appender name="LogFileAppender" type="log4net.Appender.FileAppender">
            <param name="File" value="LogTest2.txt" />
            <param name="AppendToFile" value="true" />
            <layout type="log4net.Layout.PatternLayout">
                <param name="Header" value="[Header] \r\n" />
                <param name="Footer" value="[Footer] \r\n" />
                <param name="ConversionPattern" value="%d [%t] %-5p %c %m%n" />
            </layout>
        </appender>

        <appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender">
            <mapping>
                <level value="ERROR" />
                <foreColor value="White" />
                <backColor value="Red, HighIntensity" />
            </mapping>
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
            </layout>
        </appender>

        <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
            <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.2.10.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
            <connectionString value="data source=ysg;initial catalog=DBGA_DEV;integrated security=true;persist security info=True;" />
            <commandText value="INSERT INTO [DBGA_DEV].[ga].[tb_Data_Log] ([Date],[Thread],[Level],[Logger],[Message]) VALUES (@log_date, @thread, @log_level, @logger, @message)" />

            <parameter>
                <parameterName value="@log_date" />
                <dbType value="DateTime" />
                <layout type="log4net.Layout.PatternLayout" value="%date{yyyy'-'MM'-'dd HH':'mm':'ss'.'fff}" />
            </parameter>
            <parameter>
                <parameterName value="@thread" />
                <dbType value="String" />
                <size value="255" />
                <layout type="log4net.Layout.PatternLayout" value="%thread" />
            </parameter>
            <parameter>
                <parameterName value="@log_level" />
                <dbType value="String" />
                <size value="50" />
                <layout type="log4net.Layout.PatternLayout" value="%level" />
            </parameter>
            <parameter>
                <parameterName value="@logger" />
                <dbType value="String" />
                <size value="255" />
                <layout type="log4net.Layout.PatternLayout" value="%logger" />
            </parameter>
            <parameter>
                <parameterName value="@message" />
                <dbType value="String" />
                <size value="4000" />
                <layout type="log4net.Layout.PatternLayout" value="%messag2e" />
            </parameter>
        </appender>
        <root>
            <level value="INFO" />
            <appender-ref ref="LogFileAppender" />
            <appender-ref ref="AdoNetAppender" />
            <appender-ref ref="ColoredConsoleAppender" />
        </root>
    </log4net>
</configuration>
 */
#endregion TheAppconfig

//this is the xml added replace here your log4net and Nunit paths
//<Reference Include="log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821, processorArchitecture=MSIL">
        //  <SpecificVersion>False</SpecificVersion>
        //  <HintPath>..\..\..\Log4Net\log4net-1.2.10\bin\net\2.0\release\log4net.dll</HintPath>
        //</Reference>
        //<Reference Include="nunit.framework, Version=2.4.8.0, Culture=neutral, PublicKeyToken=96d09a1eb7f44a77, processorArchitecture=MSIL" /> 
```

# sql - 数据库字段中的逗号分隔值

> ID：738133
> 
> 赞同：6
> 
> 时间：2009-04-10T16:15:50.677
> 
> 标签：sql, database, tsql, stored-procedures

我有一张产品表。该表中的每一行对应一个产品，并由唯一的 Id 标识。现在每个产品都可以有多个与该产品关联的“代码”。例如：

```
身份证 | 代码
----------------------
0001 | 在，在，我，哦
0002 | ON,VI,AC,ZO
0003 | 质量保证，PS，OO，我

```

我要做的是创建一个存储过程，这样我就可以传入像“ON，ME”这样的代码，并让它返回每个包含“ON”或“ME”代码的产品。由于代码是逗号分隔的，我不知道如何拆分并搜索它们。这可能只使用 TSQL 吗？

编辑：这是一个关键任务表。我没有权力改变它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T16:22:41.470

您应该将代码存储在单独的表中，因为您具有多对多关系。如果将它们分开，那么您将很容易进行检查。

可以在您现在拥有的系统类型中执行此操作，但需要对列进行文本搜索，每行进行多次搜索才能工作，随着数据的增长，这将产生巨大的性能问题。

如果您尝试沿着当前路径前进：您将不得不拆分输入字符串，因为没有任何东西可以保证每条记录上的代码与输入参数的顺序相同（或连续）。然后你必须做一个

```
Code LIKE '%IN%'
AND Code Like '%QA%' 
```

使用附加语句查询您要检查的每个代码。非常低效。

下面的UDF思路也是一个不错的思路。但是，根据数据的大小以及查询和更新的频率，您也可能会遇到问题。

是否可以创建一个按计划（或基于触发器）同步的标准化附加表以供您查询？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-10T17:05:08.343

首先，让我们把原来的表格变成这样：

```
 Id   | Value
-----+------
0001 | IN
0001 | ME
0001 | OH
0001 | ON
0002 | AC
0002 | ON
0002 | VI
0002 | ZO
0003 | ME
0003 | OO
0003 | PS
0003 | QA 
```

它是通过将逗号分隔的值解析为行来完成的。然后使用强大的 CROSS APPLY 关键字与原始表连接以检索其 Id。下一步就是简单地查询这个 CTE。

```
 create function FnSplitToTable
(
    @param nvarchar(4000)
)
returns table as
return
    with
    Num(Pos) as -- list of positions, numbered from 1 to 4000, largest nvarchar
    (
        select cast(1 as int)
        union all 
        select cast(Pos + 1 as int) from Num where Pos < 4000
    )
    select substring(@Param, Pos, 
        charindex(',', @Param + ',', Pos) - Pos) as Value
        from Num where Pos <= convert(int, len(@Param)) 
        and substring(',' + @Param, Pos, 1) = ','
go

create proc ProcGetProductId
(
    @Codes nvarchar(4000)
)
as
with
Src
(
    Id,
    Code
)
as
(
    select '0001', 'IN,ON,ME,OH'
    union all
    select '0002', 'ON,VI,AC,ZO'
    union all
    select '0003', 'QA,PS,OO,ME'
),
Parse as
(
    select 
        s.Id, 
        f.Value
    from 
        Src as s
    cross apply
        FnSplitToTable(s.Code) as f 
)
select distinct 
    p.Id
from 
    Parse as p
join
    FnSplitToTable(@Codes) as f
on
    p.Value = f.Value
option (maxrecursion 4000)
go

exec ProcGetProductId 'IN,ME' -- returns 0001 & 0003 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-10T16:35:00.943

其他人似乎都非常渴望告诉你你不应该这样做，尽管我没有看到任何明确的解释为什么不这样做。

除了打破规范化规则之外，原因是您将对所有行进行表扫描，因为您不能对该列中的各个“值”建立索引。

简而言之，数据库引擎无法保留包含代码“AC”的行的某种快速列表，除非您将其分解为单独的表，或将其单独放入列中。

现在，如果您的 SELECT 语句中有其他条件将行数限制为某个可管理的数量，那么也许这没问题，但如果可以的话，我会尽量避免这个解决方案并做其他人有的已经告诉过你，把它分成一个单独的表。

现在，如果您坚持使用这种设计，您可以使用以下类型的查询进行搜索：

```
...
WHERE ',' + Code + ',' LIKE '%,AC,%' 
```

这将：

*   匹配'ON，VI，AC，ZO'
*   不匹配 'ON,VI,TAC,ZO'

我不知道最后一个在您的情况下是否可行，如果您只有 2 个字母的代码，那么您可以使用以下代码：

```
...
WHERE Code LIKE '%AC%' 
```

但同样，除非您使用其他标准限制行数，否则这将执行得非常糟糕。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-10T16:25:26.783

尽管所有以前的海报都对您的数据库模式的规范化是正确的，但您可以使用“表值 UDF”来做您想做的事情，该 UDF 采用分隔字符串并返回一个表，字符串中每个值一行...您可以像使用存储过程中的任何其他表一样使用此表，加入它等等...这将解决您的直接问题...

这是此类 UDF 的链接： [FN_Split UDF](http://msdn.microsoft.com/en-us/library/aa496058.aspx)

尽管本文讨论了使用它来将数据值的分隔列表传递到存储过程中，但您可以使用相同的 UDF 对存储在现有表的列中的分隔字符串进行操作....

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-10T16:19:51.180

您存储数据的方式打破了规范化规则。每个字段中只能存储一个原子值。您应该将每个项目存储在一行中。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-05-22T10:16:00.687

超过 1 年的问题，但仍然认为它会很有用。您可以使用 MySql 的 FIND_IN_SET 函数。我不确定其他 DBMS 是否支持它。

您可以按如下方式使用此功能：

```
SELECT * FROM `table_name` WHERE FIND_IN_SET('AC', `Code`) > 0 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T10:38:26.743

我同意这里的其他海报，您应该仔细研究模式规范化，但我也知道捷径是生活的一部分。

这是一个用 Sybase 方言编写的示例函数，可以执行您的操作：

```
ALTER FUNCTION "DBA"."f_IsInStringList"( IN @thisItem char(2), IN @thisList varchar(4000) )
RETURNS INTEGER
DETERMINISTIC
BEGIN

DECLARE is_member bit;
DECLARE LOCAL TEMPORARY TABLE tmp (thisItem  char(2)) ;
DECLARE @tempstring varchar(10);
DECLARE @count integer;

IF LENGTH(TRIM(@thisList)) > 0 THEN

    WHILE LENGTH(TRIM(@thisList)) > 0  LOOP
       -- loop over comma-separated list and stuff members into temp table
       IF LOCATE ( @thisList, ',' , 1) > 0 THEN

           SET @count = LOCATE ( @thisList, ',' , 1);
           SET @tempstring = SUBSTRING ( @thisList, 1,@count-1 );

           INSERT INTO tmp ( thisItem  ) VALUES (  @tempstring );
           SET @thisList = STUFF ( @thisList, 1, @count, '' )

        ELSE

            INSERT INTO tmp ( thisItem  ) VALUES ( @thisList );
            SET @thisList = NULL;

        END IF;

    END LOOP ;

END IF;

IF EXISTS (SELECT * FROM tmp WHERE thisItem   = @thisItem ) THEN
    SET is_member = 1;
ELSE
    SET is_member = 0 ;
END IF ;

    RETURN is_member;
END 
```

然后，您可以构建一个简单的查询来检查逗号分隔字符串中是否出现值：

```
select * from some_table t 
         WHERE f_IsInStringList('OR', t.your_comma_separated_column) = 1 OR
               f_IsInStringList('ME', t.your_comma_separated_column) = 1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T16:19:52.927

如果您坚持使用该数据库设计，这可能是不可能的，但是将代码放入另一个表中的单独记录中会容易得多：

```
ProductCode
-----------
ProductID (FK to Product.ID)
Code (varchar) 
```

该表可能如下所示：

```
ProductID    Code
-----------------
0001         IN
0001         ON
0001         ME
... 
```

查询看起来像这样（您必须以某种方式传入代码 - 作为单独的变量，或者可能是您在 proc 中拆分的逗号分隔字符串）：

```
select ProductID
from ProductCode
where Code in ('ON', 'ME') 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-26T13:34:25.113

**第一步：创建函数的代码**

```
<font face="Courier New" size="2">
<font color = "blue">CREATE</font>&nbsp;<font color = "blue">FUNCTION</font>&nbsp;<font color = "maroon">[dbo]</font><font color = "silver">.</font><font color = "#FF0080"><b>[Udflistofids]</b></font>&nbsp;<font color = "maroon">(</font>
<br/><font color = "green"><i>&#45;&#45;&nbsp;Add&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;function&nbsp;here</i></font>
<br/><font color = "#8000FF">@ListOfIDs</font>&nbsp;<font color = "blue">AS</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "maroon">max</font><font color = "maroon">)</font>
<br/><font color = "green"><i>&#45;&#45;,&nbsp;@IDsSeperationChar&nbsp;as&nbsp;varchar(5)&nbsp;=&nbsp;','</i></font>
<br/><font color = "silver">,</font>
<br/><font color = "#8000FF">@UniqueID1</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/><font color = "#8000FF">@UniqueID2</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/><font color = "#8000FF">@UniqueID3</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/><font color = "#8000FF">@UniqueID4</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/><font color = "#8000FF">@UniqueID5</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "maroon">)</font>
<br/><font color = "maroon">returns</font>&nbsp;<font color = "#8000FF">@TabListOfIDs</font>&nbsp;<font color = "blue">TABLE</font>&nbsp;<font color = "maroon">(</font>
<br/>&nbsp;&nbsp;<font color = "green"><i>&#45;&#45;&nbsp;Add&nbsp;the&nbsp;column&nbsp;definitions&nbsp;for&nbsp;the&nbsp;TABLE&nbsp;variable&nbsp;here</i></font>
<br/>&nbsp;&nbsp;<font color = "maroon">id</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">50</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;<font color = "maroon">uniqueid1</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;<font color = "maroon">uniqueid2</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;<font color = "maroon">uniqueid3</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;<font color = "maroon">uniqueid4</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;<font color = "maroon">uniqueid5</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">250</font><font color = "maroon">)</font><font color = "maroon">)</font>
<br/><font color = "blue">AS</font>
<br/>&nbsp;&nbsp;<font color = "blue">BEGIN</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "green"><i>&#45;&#45;&nbsp;Fill&nbsp;the&nbsp;table&nbsp;variable&nbsp;with&nbsp;the&nbsp;rows&nbsp;for&nbsp;your&nbsp;result&nbsp;set</i></font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">DECLARE</font>&nbsp;<font color = "#8000FF">@Pos</font>&nbsp;<font color = "blue">AS</font>&nbsp;<font color = "black"><i>INT</i></font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">DECLARE</font>&nbsp;<font color = "#8000FF">@ID</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">AS</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">50</font><font color = "maroon">)</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "#8000FF">@IDsSeperationChar</font>&nbsp;<font color = "blue">AS</font>&nbsp;<font color = "black"><i>VARCHAR</i></font><font color = "maroon">(</font><font color = "black">5</font><font color = "maroon">)</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "red">','</font>
<br/>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "green"><i>&#45;&#45;SET&nbsp;@ListOfIDs&nbsp;=&nbsp;REPLACE(&nbsp;@ListOfIDs,&nbsp;&nbsp;@IDsSeperationChar,&nbsp;',')</i></font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">SET</font>&nbsp;<font color = "#8000FF">@ListOfIDs</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "fuchsia"><i>Ltrim</i></font><font color = "maroon">(</font><font color = "fuchsia"><i>Rtrim</i></font><font color = "maroon">(</font><font color = "#8000FF">@ListOfIDs</font><font color = "maroon">)</font><font color = "maroon">)</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "silver">+</font>&nbsp;<font color = "#8000FF">@IDsSeperationChar</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">SET</font>&nbsp;<font color = "#8000FF">@Pos</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "fuchsia"><i>Patindex</i></font><font color = "maroon">(</font><font color = "red">'%'</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "#8000FF">@IDsSeperationChar</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "red">'%'</font><font color = "silver">,</font>&nbsp;<font color = "#8000FF">@ListOfIDs</font><font color = "maroon">)</font>
<br/>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "green"><i>&#45;&#45;SET&nbsp;@Pos&nbsp;=&nbsp;CHARINDEX(@IDsSeperationChar,&nbsp;@ListOfIDs,&nbsp;1)</i></font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">IF</font>&nbsp;<font color = "fuchsia"><i>Replace</i></font><font color = "maroon">(</font><font color = "#8000FF">@ListOfIDs</font><font color = "silver">,</font>&nbsp;<font color = "#8000FF">@IDsSeperationChar</font><font color = "silver">,</font>&nbsp;<font color = "red">''</font><font color = "maroon">)</font>&nbsp;<font color = "silver">&lt;&gt;</font>&nbsp;<font color = "red">''</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">BEGIN</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">WHILE</font>&nbsp;<font color = "#8000FF">@Pos</font>&nbsp;<font color = "silver">&gt;</font>&nbsp;<font color = "black">0</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">BEGIN</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">SET</font>&nbsp;<font color = "#8000FF">@ID</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "fuchsia"><i>Ltrim</i></font><font color = "maroon">(</font><font color = "fuchsia"><i>Rtrim</i></font><font color = "maroon">(</font><font color = "fuchsia"><i>LEFT</i></font><font color = "maroon">(</font><font color = "#8000FF">@ListOfIDs</font><font color = "silver">,</font>&nbsp;<font color = "#8000FF">@Pos</font>&nbsp;<font color = "silver">-</font>&nbsp;<font color = "black">1</font><font color = "maroon">)</font><font color = "maroon">)</font><font color = "maroon">)</font>
<br/>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">IF</font>&nbsp;<font color = "#8000FF">@ID</font>&nbsp;<font color = "silver">&lt;&gt;</font>&nbsp;<font color = "red">''</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">BEGIN</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">INSERT</font>&nbsp;<font color = "blue">INTO</font>&nbsp;<font color = "#8000FF">@TabListOfIDs</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">(</font><font color = "maroon">id</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">uniqueid1</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">uniqueid2</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">uniqueid3</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">uniqueid4</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">uniqueid5</font><font color = "maroon">)</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">VALUES</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">(</font><font color = "#8000FF">@ID</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "#8000FF">@UniqueID1</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "#8000FF">@UniqueID2</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "#8000FF">@UniqueID3</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "#8000FF">@UniqueID4</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "#8000FF">@UniqueID5</font><font color = "maroon">)</font>&nbsp;<font color = "green"><i>&#45;&#45;Use&nbsp;Appropriate&nbsp;conversion</i></font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">END</font>
<br/>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">SET</font>&nbsp;<font color = "#8000FF">@ListOfIDs</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "fuchsia"><i>RIGHT</i></font><font color = "maroon">(</font><font color = "#8000FF">@ListOfIDs</font><font color = "silver">,</font>&nbsp;<font color = "fuchsia"><i>Len</i></font><font color = "maroon">(</font><font color = "#8000FF">@ListOfIDs</font><font color = "maroon">)</font>&nbsp;<font color = "silver">-</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "fuchsia"><i>Len</i></font><font color = "maroon">(</font><font color = "#8000FF">@ID</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "#8000FF">@IDsSeperationChar</font><font color = "maroon">)</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">)</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">SET</font>&nbsp;<font color = "#8000FF">@Pos</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "fuchsia"><i>Patindex</i></font><font color = "maroon">(</font><font color = "red">'%'</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "#8000FF">@IDsSeperationChar</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "red">'%'</font><font color = "silver">,</font>&nbsp;<font color = "#8000FF">@ListOfIDs</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">)</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "green"><i>&#45;&#45;SET&nbsp;@Pos&nbsp;=&nbsp;CHARINDEX(@IDsSeperationChar,&nbsp;@ListOfIDs,&nbsp;1)</i></font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">END</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">END</font>
<br/>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "blue">RETURN</font>
<br/>&nbsp;&nbsp;<font color = "blue">END</font>
<br/>
<br/><font color = "maroon">go</font>&nbsp;
</font>

**2nd Step : Code to get the result**

<font face="Courier New" size="2">
<font color = "blue">DECLARE</font>&nbsp;<font color = "#8000FF">@udvMax</font>&nbsp;<font color = "black"><i>NVARCHAR</i></font><font color = "maroon">(</font><font color = "maroon">max</font><font color = "maroon">)</font>
<br/>
<br/><font color = "blue">SELECT</font>&nbsp;<font color = "#8000FF">@udvMax</font>&nbsp;<font color = "silver">=</font>&nbsp;<font color = "red">''</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "fuchsia"><i>Substring</i></font><font color = "maroon">(</font>&nbsp;<font color = "maroon">(</font>&nbsp;<font color = "blue">SELECT</font>&nbsp;<font color = "red">'&nbsp;Union&nbsp;'</font>&nbsp;<font color = "silver">+</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "red">'Select&nbsp;*&nbsp;from&nbsp;dbo.udfListOfIDs('''</font>&nbsp;<font color = "silver">+</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "maroon">tmpu</font><font color = "silver">.</font><font color = "maroon">code</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "red">''',&nbsp;'''</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "maroon">tmpu</font><font color = "silver">.</font><font color = "maroon">id</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "red">''',&nbsp;'''</font>&nbsp;<font color = "silver">+</font>&nbsp;<font color = "maroon">tmpu</font><font color = "silver">.</font><font color = "maroon">code</font>&nbsp;<font color = "silver">+</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "red">''',&nbsp;null,null,null&nbsp;)'</font>&nbsp;<font color = "blue">FROM</font>&nbsp;<font color = "maroon">tmpu</font>&nbsp;<font color = "blue">FOR</font>&nbsp;<font color = "maroon">xml</font>&nbsp;<font color = "maroon">path</font><font color = "maroon">(</font><font color = "red">''</font><font color = "maroon">)</font><font color = "maroon">)</font><font color = "silver">,</font>&nbsp;<font color = "black">7</font><font color = "silver">,</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "black">200000</font><font color = "maroon">)</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "silver">+</font>
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color = "red">'&nbsp;Order&nbsp;by&nbsp;UniqueID1,&nbsp;UniqueID2,&nbsp;UniqueID3,&nbsp;UniqueID4,&nbsp;UniqueID5,&nbsp;ID'</font>
<br/>
<br/><font color = "green"><i>&#45;&#45;Select&nbsp;@udvMax</i></font>
<br/><font color = "blue">EXECUTE</font>&nbsp;<font color = "#FF0080"><b>Sp_executesql</b></font>
<br/>&nbsp;&nbsp;<font color = "#8000FF">@udvMax</font>&nbsp;
</font> 
```

****可能您可能需要在第二步的选择语句中添加您的标准。**

希望这会帮助你。

J.P

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-23T09:04:27.183

如果你想用 php 和 mysql 来做，它可以是任意数量的关键字，没有限制

```
$var = explode(',',"ahmad,sayeed,asmal,babu");
$query = "SELECT * FROM post WHERE post_tags LIKE '%a%' "; 
$query1=NULL;
foreach($var as  $value)
{   
    $query1.= " OR post_tags LIKE '%$value%' ";
}

echo "$query  $query1"; 
```

输出：

> SELECT * FROM post WHERE post_tags LIKE '%a%' OR post_tags LIKE '%ahmad%' OR post_tags LIKE '%sayeed%' OR post_tags LIKE '%asmal%' OR post_tags LIKE '%babu%'

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-12T18:16:39.403

尽管在您的情况下很简单`LIKE`，但这里是如何解析逗号分隔的字符串[表规范化（将逗号分隔的字段解析为单个记录）](https://stackoverflow.com/questions/6418214/table-normalization-parse-comma-separated-fields-into-individual-records)的解决方案。

# c# - 带有 lambda 表达式和匿名方法的 ThreadPool.QueueUserWorkItem

> ID：738139
> 
> 赞同：26
> 
> 时间：2009-04-10T16:18:25.163
> 
> 标签：c#, multithreading, lambda, anonymous-methods, threadpool

将两个参数传递给线程池上的新线程有时会很复杂，但似乎使用 lambda 表达式和匿名方法，我可以做到这一点：

```
public class TestClass
{
    public void DoWork(string s1, string s2)
    {
        Console.WriteLine(s1);
        Console.WriteLine(s2);
    }
}

try
{
    TestClass test = new TestClass();
    string s1 = "Hello";
    string s2 = "World";
    ThreadPool.QueueUserWorkItem(
        o => test.DoWork(s1, s2)
        );
}
catch (Exception ex)
{
    //exception logic
} 
```

现在，我当然简化了这个例子，但以下几点很关键：

*   传递的字符串对象是不可变的，因此是线程安全的
*   s1 和 s2 变量在 try 块的范围内声明，我在将工作排队到线程池后立即退出，因此 s1 和 s2 变量在此之后永远不会修改。

这有什么问题吗？

另一种方法是创建一个新类，该类实现具有 3 个成员的不可变类型：test、s1 和 s2。在这一点上，这似乎是额外的工作，没有任何好处。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T16:24:39.860

这并没有错。编译器本质上是自动执行您所描述的替代方案。它创建一个类来保存捕获的变量（test、s1 和 s2），并将一个委托实例传递给 lambda，该 lambda 被转换为匿名类的方法。换句话说，如果你继续你的替代方案，你最终会得到与编译器刚刚为你生成的非常相似的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T16:22:42.250

对于这个特定的示例，这里没有任何问题。您传递给另一个线程的状态是完全包含的，并且所涉及的类型都没有任何线程关联性问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T16:21:43.377

这是一个很好的方法。我没有看到使用 lambda 的任何缺点。它简单而干净。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T16:27:27.857

您正在查看的内容称为闭包。正如[chuckj 所说](https://stackoverflow.com/questions/738139/threadpool-queueuserworkitem-with-a-lambda-expression-and-anonymous-method/738152#738152)，编译器在编译时生成一个类，该类对应于在闭包之外访问的成员。

您唯一需要担心的是您是否有 ref 或 out 参数。虽然字符串是不可变的，但对它们（或任何变量）的引用却不是。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-10T16:28:52.703

该模式的一个潜在问题是，*很*容易将其扩展为更通用但更不安全的东西（暂存代码——不要指望它能工作）：

```
public static void QueueTwoParameterWorkItem<T1, T2>(T1 value1, T2 value2, workDelegate<T1,T2> work)
{
    try
    {
        T1 param1 = value1;
        T2 param2 = value2;
        ThreadPool.QueueUserWorkItem(
            (o) =>
            {
                work(param1, param2);
            });
    }
    catch (Exception ex)
    {
        //exception logic
    }
} 
```

# javascript - 使用 Javascript/Jquery 重写超链接

> ID：738145
> 
> 赞同：1
> 
> 时间：2009-04-10T16:20:08.153
> 
> 标签：javascript, jquery, asp.net-mvc

这是我正在尝试做的事情。我的页面上有这样的超链接：

```
<a href="http://www.wikipedia.com/wiki/Whatever_Page_Here">Whatever Page Here</a> 
```

当用户单击链接时，我想抓住该单击。如果它是一个链接，我不想让他们点击（比如与[http://www.wikipedia.com/wiki/xxxxx](http://www.wikipedia.com/wiki/xxxxx)格式不匹配的东西），我想弹出一个消息框。否则，我想通过我的 Mvc 控制器将它们集中起来。像这样：

```
//Category is the "Whatever_Page_Here" portion of the Url that was clicked.
public ActionResult ContinuePuzzle(string category)
{

} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T16:33:57.230

首先拦截所有的点击事件：

```
$(function() {
    $("a").click(ClickInterceptor);
});

function ClickInterceptor(e)
{
    // code to display popup or direct to a different page
    if (redirect)
    {
        var href = $(this).attr("href").split("/");
        location.href = "http://mydomain.com/controller/" + href[href.length - 1];
    }

    return false;
} 
```

“返回错误；” 告诉锚不要触发导航。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T20:13:39.763

如果要选择所有不以“ [http://http://www.wikipedia.com/wiki/](http://http://www.wikipedia.com/wiki/) ”开头的 a 标签，您可以使用：

```
$("a").not("a[href^='http://http://www.wikipedia.com/wiki/']") 
```

# git - git“更新当前签出的分支”警告是什么意思？

> ID：738154
> 
> 赞同：32
> 
> 时间：2009-04-10T16:25:07.440
> 
> 标签：git

当我执行 git push 时，我看到以下内容：

```
warning: updating the currently checked out branch; this may cause confusion,
as the index and working tree do not reflect changes that are now in HEAD. 
```

我用谷歌搜索了这条消息，我只能找到一个[git 邮件列表讨论](http://article.gmane.org/gmane.comp.version-control.git/107814)，作者试图准确地决定如何让这条消息更好地向我传达真正的问题是什么。

我是如何造成这种情况的，我该如何解决？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-10T17:09:25.040

当您推送到非裸仓库时会发生这种情况。裸仓库是仅由`.git`目录组成的仓库；非裸回购还包括结帐。一般来说，你不应该推送到非裸仓库；事实上，在未来版本的 git 中，这将被禁止。如果您推送到非裸仓库，则该仓库的 HEAD 将与索引和工作副本不同步。

如果您正在创建人们想要推送到的存储库，那么您应该使用`git init --bare`（并且`git init --bare --shared`如果多个用户帐户需要访问它）`git clone --bare`创建它，或者如果您通过克隆现有存储库来创建它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-10T17:06:37.077

简而言之，您的远程存储库不再是一个光秃秃的存储库，并且您正在推动远程结帐分支。

请参阅“[如何发布 Git 存储库](http://www.bluishcoder.co.nz/2007/09/how-to-publish-git-repository.html)”：

> 裸存储库是没有检出代码工作副本的存储库。它只包含 git 数据库。
> 作为一般规则，您永远不应该将工作副本中的更改推送到包含更改的存储库中。
> 为确保不会发生这种情况，我们将服务器存储库设为裸存储库 - 它没有工作副本

从[这里](http://lists.zerezo.com/git/msg554329.html)：

请注意，“推送”的目标通常是一个**裸**存储库（即，没有自己的工作树）。
您还可以推送到具有签出工作树的存储库，但推送不会更新工作树。
如果您推送到的分支是当前签出的分支，这可能会导致意外结果。

如果定义了分离的工作树（例如可以对应于 Web 服务器的 DocumentRoot），您需要：

*   `post-receive`在您的远程存储库上有一个钩子（[就像这里描述的那样](http://toroid.org/ams/git-website-howto)），运行“ `git checkout -f`”和
*   [忽略警告信息](http://www.mail-archive.com/frugalware-devel@frugalware.org/msg04465.html)( `git config receive.denycurrentbranch ignore`)

在您的远程存储库上检查`git config core.worktree`和`git config core.bare`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T18:50:13.623

我通过从我的混乱存储库中克隆一个新的、裸露的存储库来使我的存储库裸露，保存混乱的存储库以防万一，然后用我克隆的裸存储库替换它。

我是 git 新手，在设置存储库时，我忘记使用 --bare 选项。感谢你的帮助！

从那以后，我已经阅读了 O'Reilly 的 git 书，现在完全是 git convert 了。

# c++ - 从 C++ dll 中创建绘图画布的最简单方法是什么？

> ID：738156
> 
> 赞同：1
> 
> 时间：2009-04-10T16:25:53.350
> 
> 标签：c++, user-interface, dll

场景是这样的：有一个程序加载我的 .dll/.so 并从其中调用一个函数，可能多次调用，每次都期待一个不同的指向状态的指针。它稍后在对 dll 的其他调用中使用不同的状态。（这是一个游戏 AI，如果你需要上下文；每个状态都是一个 AI 玩家。）

我想要的是一种跨平台的方式来为这些状态中的每一个（用于可视化、调试等）创建画布窗口。​​我尝试了 wx，但把它搁置了，因为它看起来一点也不容易。是否有任何简洁的小型库可以做到这一点，或者我应该只使用 WinAPI/X ...？

编辑：假设我无法修改主机程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T20:33:59.010

[根据我的经验， Qt](http://qt.nokia.com/)的设置和驱动比 Wx 更简单。它也是非常跨平台的。

如果你想从你的 DLL 函数内部渲染一些图形而不传递任何指向 QImage 或 QWidget 类型的东西，可能要做的事情是使用 OpenGL。您的 DLL 应该只渲染到当前的 OpenGL 上下文，这是全局状态，并且可以在 DLL 之外设置（可能使用 QGLWidget）。

更新：啊，我刚刚注意到您的编辑无法修改主机代码。这是一个问题：您创建的任何窗口确实需要插入主机应用程序的事件循环才能正常工作（例如，在暴露/调整大小时接收 WM_PAINT）。在 win32 中，任何旧代码（例如您的库）当然有可能只要有机会就只使用 CreateWindow 并使用 GDI 绘制其内容，但是一般窗口行为可能会被严重破坏（它可能根本不适用于 Vista 的双缓冲；我没试过）。在这种情况下，我通常发现最简单的方法就是转储图像文件，然后使用选择的图像查看器进行查看。恕我直言，这实际上比“实时”窗口对调试更有用，因为您可以前后移动、放大、

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T21:31:38.280

如果您只想要简单的图形，没有小部件，SDL 非常易于使用。如果您确实需要复杂的控件，请使用 Qt，正如 timday 所说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T08:25:24.963

您可以查看[IUP](http://www.tecgraf.puc-rio.br/iup/)。它与 Lua 的接口非常好，并且可以完全从那里的扩展 DLL 中使用，因此它的 C API 似乎可以从插入到其他东西的 DLL 中使用。

IUP 将为您提供一个框架，用于打开包含通常可疑控件类型的窗口，包括画布。其相关的库[CD](http://www.tecgraf.puc-rio.br/cd)将为您提供该画布中的常用绘图操作。

当前版本可在 Windows 和 *nix 之间移植。下一个主要版本也将支持 MacOSX。

# c# - 大规模重构后 ASP.NET MVC 视图看不到任何类

> ID：738160
> 
> 赞同：0
> 
> 时间：2009-04-10T16:28:03.767
> 
> 标签：c#, asp.net-mvc, refactoring, namespaces

我的项目经历了名称更改，这导致使用 ReSharper 在整个解决方案中更改命名空间的名称。一切都编译得很好，但是我的 ASP.NET MVC 视图不再看到任何继承的类。我已经更改了 web.config 和所有内容中的命名空间导入，并且我确定这些类存在。如果我引用完全限定的类名 (Name.Space.ClassName)，它们就会起作用。

为什么会发生这种情况，我该如何解决？

编辑：更多细节：

在重构之前，我有自定义视图页、母版页和用户控件类：

> SalesWeb.Mvc.Views.SalesWebViewPage
> SalesWeb.Mvc.Views.SalesWebMasterPage
> SalesWeb.Mvc.Views.SalesWebUserControl

重构后：

> Wasabi.SalesPortal.Mvc.Views.SalesPortalViewPage
> Wasabi.SalesPortal.Mvc.Views.SalesPortalMasterPage
> Wasabi.SalesPortal.Mvc.Views.SalesPortalUserControl

在 web.config 中，重构前：

```
<configuration>
    <system.web>
        ...
        <pages ...>
            ...
            <namespaces>
                ...
                <add namespace="SalesWeb.Mvc.Views" />
            </namespaces>
        </pages>
    </system.web>
</configuration> 
```

后：

```
<configuration>
    <system.web>
        ...
        <pages ...>
            ...
            <namespaces>
                ...
                <add namespace="Wasabi.SalesPortal.Mvc.Views" />
            </namespaces>
        </pages>
    </system.web>
</configuration> 
```

我还更改了我的每个视图、母版页和用户控件的 Inherits 属性。但是，当尝试访问 MVC 应用程序时，它抱怨**找不到 SalesPortalMasterPage ，尽管我绝对确定它存在，因为在将其称为****Wasabi.SalesPortal.Mvc.Views.SalesPortalMasterPage**时我没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:34:55.143

尝试清理您的 bin 目录并进行重建。有时较旧的 dll 会在 bin 文件夹中徘徊，并弄乱您的引用/命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T17:01:00.707

当命名空间与保存视图的命名空间不同时，我会遇到类似的问题。我的问题是，当我使用引用不在网站命名空间中的类的强类型视图时，如果在视图本身中定义它，它就无法识别它。我的解决方案是为每个视图创建一个代码隐藏文件并在那里定义类（以便它位于同一个命名空间中）并让视图从代码隐藏类继承。我意识到这是旧方法（不推荐），但这是我发现的唯一有效的方法。我偶然发现了它，因为我在默认情况下停止创建代码隐藏之前使用版本创建的视图仍然有效，而在没有代码隐藏的情况下创建的视图无法编译。你可能想试试这个，看看它是否能解决你的问题。

我已经在 Codeplex 上报告了这个问题，顺便说一句。

**编辑**：根据您的评论，您可能没有看到与我相同的问题。您可能想检查项目中的程序集名称（和默认命名空间）是否已更新。也许问题是程序集名称与您的命名空间不匹配。

# subsonic - SubSonic 和多个提供商的问题

> ID：738166
> 
> 赞同：1
> 
> 时间：2009-04-10T16:29:56.040
> 
> 标签：subsonic

我有两个 Subsonic 生成的数据访问层，用于我在一个项目中使用的 2 个不同的数据库，因此我的 web.config 中有以下内容：

```
<SubSonicService>
    <providers>
      <add name="BLLDB" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="BLLDB" generatedNamespace="BLLDB" useSPs="true" />
      <add name="BLLDB2" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="BLLDB2" generatedNamespace="BLLDB2" useSPs="true" />
    </providers>
  </SubSonicService> 
```

然而，每当我调用任一 DAL 的代码时，它总是最终使用列出的第二个数据提供程序（“BLLDB2”），因此当它应该从“BLLDB "（尽管我在 Select() 中明确指定了“BLLDB”）

例如，检查“B​​LLDB”DAL 的以下代码：

```
Dim mySelect As New
SubSonic.Select(Databases.BLLDB)
mySelect.From(Of User)() 
```

“mySelect.ProviderName”返回一个字符串值：“BLLDB2”

而“Databases.BLLDB”返回一个字符串值：“BLLDB”

是什么赋予了？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T16:36:20.597

您的供应商之一失败了。亚音速不善于告诉你它失败的原因和位置。

我通常通过几种方式进行调试。

1.  一次只使用一个提供者并评论另一个。检查您是否能够看到命名空间。如果它们都加载正常，那么您至少知道它不是数据库。

2.  检查是否有任何表格以 -、_ 或数字开头。这也可能导致它失败。

让我知道事情的后续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T18:38:05.780

您可以使用以下方法指定默认提供程序：

< SubSonicService defaultProvider="BLLDB" >

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T19:29:56.267

我是 Subsonic 的新手（使用带有 C# 的 2.2 版）。我花了很多时间试图获得与 Stimpy 相同的配置。我想我想通了-我的解决方案如下。如果这是正确的，最好将此信息添加到 Select Queries 文档中。所以其他人可以更早地解决这个多数据提供者问题。这是web.config

```
<SubSonicService enableTrace="false" templateDirectory="">
<providers>
  <clear/>
  <add name="DB1" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="DB1" excludeProcedureList="*" generatedNamespace="DB1" includeTableList="TableA" tableBaseClass="RepositoryRecord"/>
  <add name="DB2" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="DB2" excludeProcedureList="*" generatedNamespace="DB2" includeTableList="TableB,TableC" tableBaseClass="RepositoryRecord"/>
</providers> 
```

这是不起作用的语句（取自 Select Queries 文档示例）。SQL Server 找不到“TableA”，因为它在 DB2 而不是 DB1 中寻找它：

```
DB1.TableA doesntWork = new Select().From<DB1.TableA>().                                  
            Where("idCol").IsEqualTo(1).ExecuteSingle<DB1.TableA>(); 
```

（我的假设是每个表的 dataProvider 将作为表类的属性生成）。

这是使这项工作起作用的修改：

```
 Select mySelect = DB1.DB.Select();
 DB1.TableA works = mySelect.From<DB1.TableA>().
            Where("idCol").IsEqualTo(1).ExecuteSingle<DB1.TableA>(); 
```

或者，这也有效：

```
DB1.TableA worksAlso = new Select(DataService.GetInstance(Databases.DB1)).From<DB1.TableA>().                                  
            Where("idCol").IsEqualTo(1).ExecuteSingle<DB1.TableA>(); 
```

似乎如果您有一个 dataProvider 或者您在 SubSonicService 配置中指定。默认 dataProvider 是您尝试使用的，一切正常：

```
<SubSonicService enableTrace="false" defaultProvider="DB1" templateDirectory=""> 
```

但是，如果您省略“defaultProvider”，它默认为提供者列表中的最后一个（在本例中为 DB2）

多 DAL 案例的另一条重要信息 - 如果您将代码生成到每个提供程序的不同文件夹中，请确保在您的项目中仅“包含”一个自动生成到每个文件夹中的“AllStructs.cs”文件（否则，编译错误）。

仅供参考：向 Codesmith 的这种开源替代方案的开发人员表示敬意。到目前为止（除了这个问题），很容易上手并使其工作（尤其是使用 SubStage）。此外，我认为它最终会成为我的客户更轻、更经济的解决方案。谢谢！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-09T19:13:19.677

我正在使用亚音速 2.2 子级。您需要尊重地更改多个提供者的名称空间。

一件重要的事情。它将生成多个“AllStructs.vb”文件。它将由代码自动重复。但是你需要添加一个 allstructs.vb 另一个只是删除它会工作 1000%。

这将是 web 配置文件中的配置设置。

```
 <connectionStrings>
    <add name="aspnetdb" connectionString="Data Source=(local); Database=aspnetdb; Integrated Security=true;"/>
    <add name="office" connectionString="Data Source=(local); Database=office; Integrated Security=true;"/>
</connectionStrings>
<SubSonicService defaultProvider="aspnetdb" enableTrace="false" templateDirectory="">
    <providers>
        <clear/>
        <add name="aspnetdb" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="aspnetdb"/>
        <add name="office" type="SubSonic.SqlDataProvider, SubSonic" connectionStringName="office"/>
    </providers>
</SubSonicService> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T12:34:09.990

只是在这里回答我自己的问题.. 在通过 VB.NET 工作时似乎确实*不可能*使用多个提供程序。

这可能只适用于 C#（正如 CodeToGlory 提到的），因为我已经从头开始测试了几种不同的场景，并且无法让 2 个 Subsonic 生成的 DAL 并排工作

将不得不为其中一个破解我自己的，所以.. 为建议干杯！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T13:26:09.483

大家好，感谢您的回复... Rob，如果我指定“BLLDB”的默认提供程序，这最终会做同样的事情，但是对于 BLLDB 而不是 BLLDB2

即它只读取 BLLDB 而不是 BLLDB2

CodeToGlory，我使用的是最新的 dll，并且在遇到这个问题之前，运行 SubSonic 通常没有问题。

您是否可以张贴您用于亚音速的 web.config 条目，您有两个提供商都在工作？

太感谢了！

PS 当我在我的 Select() 函数中直接指定要使用哪个数据提供者时，这也很奇怪：

例如

```
Dim mySelect As New SubSonic.Select(Databases.BLLDB)
mySelect.From(Of User)() 
```

然后我做：

“mySelect.ProviderName”，这将返回一个字符串值：“BLLDB2” *（不正确）*

而当我输出“Databases.BLLDB”的值时，这将返回一个字符串值：“BLLDB” *（正确）*

这实际上可能是问题的关键......

# php - 过滤器数组 - 奇偶

> ID：738168
> 
> 赞同：8
> 
> 时间：2009-04-10T16:31:42.777
> 
> 标签：php, arrays

如何过滤掉具有奇数或偶数索引号的数组条目？

```
Array
(
    [0] => string1
    [1] => string2
    [2] => string3
    [3] => string4
) 
```

就像，我希望它从数组中删除 [0] 和 [2] 条目。或者说我有 0,1,2,3,4,5,6,7,8,9 - 我需要删除 0,2,4,6,8。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-10T16:36:46.757

`foreach($arr as $key => $value) if($key&1) unset($arr[$key]);`

以上从数组中删除奇数位置，要删除偶数位置，请使用以下命令：

相反`if($key&1)`，您可以使用`if(!($key&1))`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T16:39:30.043

这是一个“hax”解决方案：

将 array_filter 与“isodd”函数结合使用。

array_filter 似乎只对值起作用，所以你可以先 array_flip 然后使用 array_filter。

```
array_flip(array_filter(array_flip($data), create_function('$a','return $a%2;'))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-09T18:40:51.070

您也可以像这样使用 SPL FilterIterator：

```
class IndexFilter extends FilterIterator {
    public function __construct (array $data) {
        parent::__construct(new ArrayIterator($data));
    }   

    public function accept () {
        # return even keys only
        return !($this->key() % 2);
    }     
}

$arr      = array('string1', 'string2', 'string3', 'string4');
$filtered = array();

foreach (new IndexFilter($arr) as $key => $value) {
    $filtered[$key] = $value;
}

print_r($filtered); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-01T14:07:31.577

```
<?php
function odd($var)
{
    // returns whether the input integer is odd
    return($var & 1);
}

function even($var)
{
    // returns whether the input integer is even
    return(!($var & 1));
}

$array1 = array("a"=>1, "b"=>2, "c"=>3, "d"=>4, "e"=>5);
$array2 = array(6, 7, 8, 9, 10, 11, 12);

echo "Odd :\n";
print_r(array_filter($array1, "odd"));
echo "Even:\n";
print_r(array_filter($array2, "even"));
?>

Odd :
Array
(
    [a] => 1
    [c] => 3
    [e] => 5
)
Even:
Array
(
    [0] => 6
    [2] => 8
    [4] => 10
    [6] => 12
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T21:09:53.823

我会这样做...

```
for($i = 0; $i < count($array); $i++)
{
    if($i % 2) // OR if(!($i % 2))
    {
        unset($array[$i]);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-11T22:33:05.367

```
<?php 
$array = array(0, 3, 5, 7, 20, 10, 99,21, 14, 23, 46); 
for ($i = 0; $i < count($array); $i++) 

{ 
        if ($array[$i]%2 !=0)
        echo $array[$i]."<br>";
}
?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-29T00:04:00.710

```
$array = array(0 => 'string1', 1 => 'string2', 2 => 'string3', 3 => 'string4');

// Removes elements of even-numbered keys
$test1 = array_filter($array, function($key) {
    return ($key & 1);
}, ARRAY_FILTER_USE_KEY);

// Removes elements of odd-numbered-keys
$test2 = array_filter($array, function($key) {
    return !($key & 1);
}, ARRAY_FILTER_USE_KEY); 
```

[这个答案比这个](https://stackoverflow.com/a/738191/2518200)答案有一点改进。您可以使用匿名函数代替`create_function`. 此外，`array_filter`接受一个可选的标志参数，允许您指定回调函数将键作为其唯一参数。所以你不需要使用`array_flip`来获取一个键数组。

# powershell - Powershell v1：是否可以将 switch 语句的结果分配给变量？

> ID：738172
> 
> 赞同：5
> 
> 时间：2009-04-10T16:32:52.553
> 
> 标签：powershell, switch-statement

是否可以将 switch 语句的结果分配给变量。

例如，而不是：

```
switch ($Extension) 
    { 
        doc {$Location = "C:\Users\username\Documents\"; break} 
        exe {$Location = "C:\Users\username\Downloads\"; break}
        default {$Location = "C:\Users\username\Desktop\"}
    } 
```

是否可以做类似的事情：

```
$Location = 
{
    switch ($Extension) 
    { 
        doc {"C:\Users\username\Documents\"; break} 
        exe {"C:\Users\username\Downloads\"; break}
        default {"C:\Users\username\Desktop\"}
    }
} 
```

尝试上述结果会导致 $location 包含整个代码块作为字符串。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T17:39:00.540

对于 V1，我会将 switch 语句包装在一个函数中。

```
function Get-DocumentLocation($Extension)
{
    switch ($Extension) 
    { 
        doc {"C:\Users\username\Documents\"; break} 
        exe {"C:\Users\username\Downloads\"; break}
        default {"C:\Users\username\Desktop\"}
    }
}

$Location = Get-DocumentLocation $extension 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T17:40:11.283

下面的工作吗？

```
$Location = (switch ($Extension) {
               doc {"C:\Users\username\Documents\"; break}
               exe {"C:\Users\username\Downloads\"; break}
               default {"C:\Users\username\Desktop\"}
             }) 
```

或许

```
$Location = $(switch ($Extension) {
               doc {"C:\Users\username\Documents\"; break}
               exe {"C:\Users\username\Downloads\"; break}
               default {"C:\Users\username\Desktop\"}
             }) 
```

现在这里没有要测试的 v1，但我认为这可能有效。

# java - 从网站启动桌面应用程序

> ID：738175
> 
> 赞同：7
> 
> 时间：2009-04-10T16:33:21.883
> 
> 标签：java, javascript, url, deployment, java-web-start

通过浏览器/ URL 启动应用程序是否可行？这样做有哪些选择？

我知道使用 IE 和 Windows 的方法（通常不起作用）。理想情况下，我希望它独立于浏览器。

我们的应用程序是 RCP，所以理论上 Java Web Start 可以工作，我们只需要对我们向用户交付应用程序的方式进行一些重大更改，我想避免这种情况。我们的 Web 服务器代码目前都是 Java，如果这有所作为的话。

我几乎放弃了这一点，直到我点击了苹果网站上的一个网址，然后又启动了 iTunes。

苹果是如何做到这一点的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-10T16:44:25.957

iTunes将自己注册为自定义和协议[的协议处理程序](http://discussions.apple.com/ann.jspa?annID=152)。当您使用该协议访问 URL 时（在这种情况下，在 Apple 的 Web 服务器上执行间接步骤之后），iTunes 会启动来处理它，就像您的浏览器启动来处理URL 或您的电子邮件程序启动来处理URL。`itms://``itmss://``http://``mailto:`

这本身不是“跨平台”，但它确实适用于所有平台，因为 URL 处理程序存在并且在任何地方都做同样的事情。

它的缺点是只有在应用程序已经安装时才​​能工作，这就是为什么您可能希望有一个启动页面来指导人们在必要时安装应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T16:45:13.383

Silverlight 3 和 Adob​​e Air 将允许您在浏览器之外启动应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T16:37:30.500

如果这是独立于操作系统的，那么您不能依赖任何可用的特定程序。无论如何，您想启动什么样的程序？

# php - 我可以通过链接登录到受保护的目录吗？

> ID：738188
> 
> 赞同：0
> 
> 时间：2009-04-10T16:37:38.440
> 
> 标签：php, php4

我想创建指向受保护目录中的页面和内容的链接。我没有对从主机管理页面设置的受保护目录进行编程。

我希望能够为用户提供链接，这些链接也会将他们带到页面和登录。

此外，如果有一种方法我希望能够在其他地方嵌入受保护目录中的内容，而不是为了显示内容而购买密码框。

我正在使用 PHP4

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T16:43:13.607

根据身份验证，您可以使用如下 URL：

```
http://username:password@yoursite.com/protected_dir 
```

我知道这适用于通过`.htaccess`. 但是，请记住，您将以明文形式发送带有密码的链接，并且可能会被错误的人无意中看到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T01:45:47.000

> 此外，如果有一种方法我希望能够在其他地方嵌入受保护目录中的内容，而不是为了显示内容而购买密码框。

用 fsockopen 阅读它。这是一个带有基本身份验证的示例 od fsockopen [http://pl.php.net/manual/en/function.fsockopen.php#32830](http://pl.php.net/manual/en/function.fsockopen.php#32830)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-11T10:24:28.410

> ...我希望能够在其他地方嵌入受保护目录中的内容，而不是为了显示内容而购买密码框。

作为直接链接，此

```
http://username:password@yoursite.com/protected_dir/file.html 
```

不起作用，但只有在尝试使用 IE 浏览器查看它时，我认为如果你想通过 PHP 嵌入内容，你可以使用这个：

```
file_get_contents("http://username:password@yoursite.com/protected_dir/file.html") 
```

如果你试试这个，请告诉我，我也很感兴趣。

# .net - CLR 异常系统中的故障子句是什么？

> ID：738189
> 
> 赞同：3
> 
> 时间：2009-04-10T16:37:50.763
> 
> 标签：.net, exception, clr

我正在阅读[这篇](http://msdn.microsoft.com/en-us/magazine/dd419661.aspx)关于处理损坏状态异常的文章，我遇到了一些让我感到困惑的事情。

**什么是过错条款？**

请参阅下面文章的引用：

> 错误条件只能从包含意外条件的函数传递给该函数的调用者。异常有能力将函数执行的结果从当前函数的范围传递到堆栈中的每一帧，直到它到达知道如何处理意外情况的帧。CLR 的异常系统（称为两遍异常系统）将异常传递给线程调用堆栈上的每个前任，从调用者开始，一直持续到某个函数说它将处理异常（这称为第一遍）。
> 
> 然后，异常系统将展开调用堆栈上每个帧的状态，从引发异常的位置到处理异常的位置（称为第二遍）。随着堆栈展开，CLR 将在展开的每一帧中同时运行 finally 子句和**故障子句**。然后，执行处理帧中的catch 子句。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T16:41:56.340

根据[这篇文章](http://dotnet.org.za/armand/archive/2005/11/09/48087.aspx)：

> 在 C# 语言中不可用的 SEH 子句的另一个示例是 fault 子句。它类似于 finally 子句，只是它仅在受保护块中引发异常时调用。

[另一篇文章](http://weblogs.asp.net/kennykerr/archive/2004/09/15/introduction-to-msil-part-5-exception-handling.aspx)证实：

> 错误异常处理程序类似于 finally 块，不同之处在于它仅在其关联的 try 块因异常而离开时才被调用。在错误处理程序有机会执行后，异常继续在搜索或愿意捕获它的处理程序中进行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T16:42:56.633

该`fault`子句是 CLI 的一部分，但在 C# 中不可用。它与子句非常相似，`finally`只是它仅在块中引发异常时调用`try`（而`finally`无论是否引发异常，块都会执行）。

# .net - 我应该在“关于”框中显示什么？

> ID：738192
> 
> 赞同：5
> 
> 时间：2009-04-10T16:39:59.247
> 
> 标签：.net, diagnostics, about-box

我已经构建了一个小型 .NET winforms 实用程序供公司内部使用，并且由于主要界面是选项卡控件，因此我决定为“关于框”添加一个选项卡，而不是单独的表单。所以，我有一些空间可以填写我的关于框。

到目前为止，我有：

*   程序的图标和名称
*   版本
*   作者姓名（我）
*   创世年（2009 年）。

剩下相当多的空白空间，我想我可能会尝试添加一些有用的东西……但也许没有必要？这是我到目前为止添加的其他内容：

*   操作系统版本
*   .NET 框架版本
*   当前目录
*   计算机名称
*   用户名

我认为如果出现一些奇怪的行为，这可能很有用。

你怎么看？您是否希望在“关于”框中显示一些有用的信息，或者我应该让它保持简洁？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T16:48:20.457

我总是建议输入别人的电子邮件地址。

说真的 - 你觉得任何东西都有助于向用户和提供技术支持的人提供有价值的信息。例如，我们可能会识别应用程序正在运行的环境，例如 TEST、CERT 或 PROD。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T16:43:03.887

保持美观和简单。用户可能会担心为什么需要知道计算机名和用户名（例如）。

如果您预计会出现问题，那么可以通过另一种方式收集这些信息并告诉您的用户使用它——它甚至可以自动向您发送一封包含该信息的电子邮件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T16:41:17.043

我不会开始试图用一个关于框的爬行来越过顶部，毕竟它只是一个关于框。根据我的经验，没有很多人阅读它。但是，如果信息与程序相关，添加它不会有什么坏处。

使用软件时，我唯一一次进入帮助菜单（通常位于关于按钮的位置）是当我完全不知道如何完成某项任务时。如果您的程序布局良好并且基本上是自记录的，那么没有多少人会冒险进入帮助菜单。

话虽如此，当我使用来自个人开发人员的软件时，我通常对谁在开发它感兴趣，如果它是一个好的软件。因此，如果您的软件适合开发人员（以及像我这样好奇的人），请随意在其中放一些漂亮的信息，因为我喜欢阅读它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T16:51:44.333

你给出的第一个清单似乎很可靠。我肯定会包括该列表中的所有内容。

至于第二个列表：我认为 .NET 框架版本和可能的操作系统版本很有用。不要打扰包括计算机名称、目录和用户名；它们似乎没有任何目的，因此可能只会引起混乱。

您可能还想包括程序上次更新的日期。我意识到这些信息是在版本号中捕获的，但是同时拥有这两种信息会让用户知道这个工具多久更改一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T16:52:38.467

如果您的应用程序有一个网站，我建议您将其放入。这样，那些对更多细节感兴趣或可能想要提交错误请求的人可以快速访问您的网站。

我不是电子邮件地址的最大粉丝，因为它可以为那些不光彩的人打开大门。您可以轻松地在网站上放置联系表格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T16:42:44.263

将更多内容放入“关于”框中的唯一原因是，如果您打算在用户寻求支持时将其用于诊断。

# c# - 如何在不断变化的背景上画一个圆圈

> ID：738193
> 
> 赞同：0
> 
> 时间：2009-04-10T16:40:11.757
> 
> 标签：c#, .net, winforms, graphics, timer

表单上有一个计时器，在它的 Tick 事件中我有：

```
 this.BackColor = ColorTranslator.FromHtml("#" + ColorCodesBack[_index]);

        CurrentColor = ColorTranslator.FromHtml("#" + ColorCodesFore[_index]);
        SolidBrush sb = new SolidBrush(CurrentColor);

        g.FillEllipse(sb, this.Width/2 -200, this.Height/2 - 200, 200, 200);
        g.DrawImage(b, 150, 150); 
```

问题只是每个刻度的背景变化，我没有在表单上看到一个圆圈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T20:34:00.987

您应该做的是将您的代码放入表单 Paint 事件中。这将导致您的代码在表单必须重新绘制时重新绘制。就像在表单上运行鼠标或移动表单一样。另外你在哪里声明你的图形对象？因为它将在您的表单上绘制的唯一方法是：

```
Graphics g = this.CreateGraphics(); 
```

如果您使用绘画事件，您甚至不需要计时器对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T16:42:40.423

您应该将此代码与更改背景的相同滴答事件结合起来。否则，您实际上有一个竞争条件，即首先触发哪个“tick”。将它们结合起来就可以解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T16:45:08.873

同时更新背景和前景的建议是可靠的。

如果您无法控制这一点，也许您可​​以在背景顶部的窗口中添加一个透明控件，然后在透明控件上绘制？这样，您将始终在 Z-Order 之上。这也将减少您定期重绘的需要。

# c++ - 为什么我的虚函数调用会失败？

> ID：738204
> 
> 赞同：1
> 
> 时间：2009-04-10T16:44:23.353
> 
> 标签：c++, virtual-functions

> **更新：**此问题是由于内存使用不当引起的，请参阅底部的**解决方案。**

这是一些半伪代码：

```
class ClassA
{
public:
    virtual void VirtualFunction();
    void SomeFunction();
}

class ClassB : public ClassA
{
public:
    void VirtualFunction();
}

void ClassA::VirtualFunction()
{
    // Intentionally empty (code smell?).
}

void ClassA::SomeFunction()
{
    VirtualFunction();
}

void ClassB::VirtualFunction()
{
    // I'd like this to be called from ClassA::SomeFunction()
    std::cout << "Hello world!" << endl;
} 
```

~~等效的 C# 如下：~~删除了 C# 示例，因为它与实际问题无关。

为什么`ClassB::VirtualFunction`调用 from 时不调用函数`ClassA::SomeFunction`？而是`ClassA::VirtualFunction`被称为...

当我[强制实现虚函数](https://stackoverflow.com/questions/738204/why-might-my-virtual-function-call-be-failing/738223#738223)ClassA::VirtualFunction 时，如下所示：

```
class ClassA
{
public:
    virtual void VirtualFunction() = 0;
    void SomeFunction();
}

class ClassB : public ClassA
{
public:
    void VirtualFunction();
}

void ClassA::SomeFunction()
{
    VirtualFunction();
}

void ClassB::VirtualFunction()
{
    // I'd like this to be called from ClassA::SomeFunction()
    std::cout << "Hello world!" << endl;
} 
```

尽管已明确声明和定义了派生函数，但在运行时仍会发生以下错误。

```
pure virtual method called
terminate called without an active exception 
```

*注意：*似乎错误可能是由于内存使用不当引起的。有关详细信息，请参阅自我回答。

### 更新 1 - 4：

*已删除评论（不相关）。*

### 解决方案：

[发布为答案。](https://stackoverflow.com/questions/738204/why-might-my-virtual-function-call-be-failing/738566#738566)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T16:49:24.340

```
class Base {
public:
   virtual void f() { std::cout << "Base" << std::endl; }
   void call() { f(); }
};
class Derived : public Base {
public:
   virtual void f() { std::cout << "Derived" << std::endl; }
};
int main()
{
   Derived d;
   Base& b = d;
   b.call(); // prints Derived
} 
```

如果在 Base 类中您不想实现必须声明的函数：

```
class Base {
public:
   virtual void f() = 0; // pure virtual method
   void call() { f(); }
}; 
```

并且编译器不允许您实例化该类：

```
int main() {
   //Base b; // error b has a pure virtual method
   Derived d; // derive provides the implementation: ok
   Base & b=d; // ok, the object is Derived, the reference is Base
   b.call();
} 
```

作为旁注，请**注意不要从构造函数**或析构函数调用虚函数，因为您可能会得到意想不到的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T17:57:35.050

如果您收到“纯虚方法调用终止调用没有活动异常”错误消息，这意味着您正在从 classA（基类）的构造函数或析构函数调用虚函数，您不应该这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T18:15:49.110

关于称为错误的纯虚方法：

您应该创建一个不同的问题，因为它实际上与另一个不同。这个问题的答案在我之前对您最初问题的回答的最后一段：

**不要从构造函数或析构函数调用虚函数**

```
class Base
{
public:
   Base() { f(); }
   virtual void f() = 0;
};
class Derived : public Base
{
public:
   virtual void f() {}
};
int main()
{
   Derived d; // crashes with pure virtual method called
} 
```

上面代码中的问题是编译器将允许您实例化 Derived 类型的对象（因为它不是抽象的：所有虚拟方法都已实现）。类的构建始于所有基的构建，在本例中为 Base。编译器将为类型 Base 生成虚方法表，其中*f()*的条目为0（未在 base 中实现）。然后编译器将执行构造函数中的代码。在基础部分完全构建后，派生元素部分的构建开始。编译器将更改虚拟表，以便*f()*的条目指向*Derived::f()*。

如果您尝试在仍在构造 Base 的同时调用方法*f()*，则虚拟方法表中的条目仍然为空，并且应用程序崩溃。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T16:47:13.330

当 A 调用 VirtualFunction() 时，它会自动调用 B 上的版本。这就是虚函数的意义所在。

我对 C++ 语法不太熟悉。您是否必须在正文和标头中将函数声明为虚拟函数？

另外，在 B 类中，您可能需要将其标记为覆盖

在 C# 中很容易。我只是不知道 c++ 语法。

```
public class ClassA
{
    public **virtual** void VirtualFunction(){}

    public void FooBar()
    {
        // Will call ClassB.VirtualFunction()
        VirtualFunction();
    } 

}

public class ClassB
{
    public **overide** void VirtualFunction()
    {
        // hello world
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T16:51:06.957

您没有正确定义 ClassB 中的函数，它应该是：

```
public class ClassB
{
    public void override AbstractFunction()
    {
        // hello world
    }
} 
```

然后，从基类到虚拟/抽象方法的任何调用都将调用派生实例上的实现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T16:54:03.643

如果要强制派生类实现`VirtualFunction`：

```
class ClassA
{
public:
    virtual void VirtualFunction()=0;
    void SomeFunction();
} 
```

这是 C++。默认将调用派生函数。

如果要调用基类函数，请执行以下操作：

```
void ClassA::SomeFunction()
{
    // ... various lines of code ...

     ClassA::VirtualFunction();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T17:41:59.550

您的代码没有问题，但您的示例不完整。您没有说明您从哪里调用 SomeFunction 。

正如 dribeas 已经指出的那样，您必须小心地从构造函数中调用虚函数，因为只有在层次结构中的每个类完成构造时才会构建虚表。

编辑：我的回复的以下段落不正确。道歉。可以从 ClassB 的构造函数调用 SomeFunction，因为 vtable 在初始化程序列表的末尾（至少）就位，即一旦您在构造函数的主体中。当然不能从 ClassA 的构造函数中调用它。

原文段落：

*我怀疑您必须从 ClassB 的构造函数调用 SomeFunction，此时只有达到 ClassA 类型的 vtable 才能完成，即您的类仍然是 ClassA 类型的虚拟调度机制。只有在构造函数完成时，它才会成为 ClassB 类型的对象。*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T20:05:04.230

要调用虚拟函数函数，您需要通过指针或引用调用。

```
void ClassA::SomeFunction()
{
    VirtualFunction();       // Call ClassA::VirtualFunction

    this->VirtualFunction(); // Call Via the virtual dispatch mechanism
                             // So in this case call ClassB::VirtualFunction
} 
```

您需要能够区分两种不同类型的调用，否则 classA::VirtualFunction() 在被覆盖时变得不可访问。

正如其他人指出的那样，如果您想使基类版本抽象，则使用 = 0 而不是 {}

```
class A
{
    virtual void VirtualFunction() =0;
.... 
```

但有时有一个空的定义是合法的。这将取决于您的确切用法。

# iphone - iPhone SDK - NSStreamEventHasBytesAvailable / appendBytes：崩溃

> ID：738213
> 
> 赞同：3
> 
> 时间：2009-04-10T16:49:01.937
> 
> 标签：iphone, cocoa-touch, xcode

免责声明：我是 Xcode / iPhone SDK Noob。

我正在尝试与现有服务器建立客户端 TCP/IP 连接。连接后，我希望收到有关服务器的一些数据（版本等）。

当我建立连接时，`NSStreamEventOpenCompleted`事件会触发，所以我知道连接已经建立。接下来`NSStreamEventHasBytesAvailable`事件触发，我正在执行以下代码。值 71 (int) 存储在 len 中，我认为这是正确的。然而，线

```
[data appendBytes:&buffer length:len]; 
```

正在崩溃（我认为）。没有抛出实际错误，但我确实看到 **`__TERMINATING_DUE_TO_UNCAUGHT_EXCEPTION__`**了，即使我明确添加了错误捕获：

```
case NSStreamEventHasBytesAvailable:
    {
        NSMutableData *data=[[NSMutableData alloc] init];

        uint8_t *buffer[1024];
        unsigned int len=0;

        len=[(NSInputStream *)stream  read:buffer maxLength:1024];
        if(len>0){  
            @try{
                [data appendBytes:&buffer length:len];
            }
            @catch(NSException *ex){
                NSLog(@"Fail: %@", ex); 
            }
            [statusLabel setText:[data stringValue]];
            //[bytesRead setIntValue:[bytesRead intValue]+len];
        }else{
            NSLog(@"No Buffer");
        }
        break ;
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T16:59:09.917

这是 C 级别的问题：您对缓冲区和指针感到困惑。

这段代码：

```
uint8_t *buffer[1024]; 
```

为您提供一个包含 1024 个指向`uint8_t`s 的指针的堆栈缓冲区，这几乎肯定不是您想要的。反而：

```
uint8_t buffer[1024]; 
```

稍后，您将堆栈上指针的地址传递给 -[NSMutableData appendBytes:length:]，这又不是您想要[的：如文档](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsmutabledata_Class/Reference/NSMutableData.html#//apple_ref/occ/instm/NSMutableData/appendBytes:length:)中所示，传递第一个元素：

```
[data appendBytes:buffer length:len]; 
```

有一个[非常详尽的编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/Streams/Articles/ReadingInputStreams.html#//apple_ref/doc/uid/20002273-1001882)，其中包含您正在尝试做的完整代码，您可能需要参考它。

至于`__TERMINATING_DUE_TO_UNCAUGHT_EXCEPTION__`，内存损坏和错误的指针取消引用不是您可以用 Objective-C `@try`/捕获的`@catch`；它的级别要低得多。另一方面，如果您打开调试，您仍然可以在调试器中捕捉到这一点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-10T16:54:51.127

将您的缓冲区声明为：

```
uint8_t buffer[1024]; 
```

并将追加为：

```
[data appendBytes:buffer length:len]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-19T02:35:25.647

为了完整性`read:maxLength:`返回一个 NSInteger 并且如果有错误将是负数。将其分配给 unsigned int 会丢弃它并可能导致崩溃。

# iphone - iPhone横向应用程序视图轴混乱

> ID：738216
> 
> 赞同：6
> 
> 时间：2009-04-10T16:51:13.710
> 
> 标签：iphone, uiviewcontroller, landscape

使用此处的信息：[iPhone Landscape-Only Utility-Template Application](https://stackoverflow.com/questions/525737/iphone-landscape-only-utility-template-application)我能够启动、使用和维护我的视图仅作为横向。但是，我对轴感到困惑。

绝对轴的行为符合预期，意味着 (0,0) 是左上角，(240,0) 是顶部中心，(0,320) 是左下角，等等。但是，当我尝试进行与我正在绘制的视图我发现 x,y 的方向就像左上角的肖像是原点一样。所以要在我的视图控制器的中心点绘制一些东西，我需要做：

```
CGPoint center = CGPointMake(self.view.center.y, self.view.center.x); 
```

我假设这是因为我的控制器 self.view 引用的 UIView 给出了相对于它的封闭框架的值，这意味着在纵向模式下其轴原点位于左上角的窗口。

有没有一些简单的方法来解释我错过的这一点？

文档表明 transform 属性正是我正在寻找的，但是，我在这里遇到了进一步的困惑。涉及3个基本属性：

*   框架
*   界限
*   中央

如果我在 viewDidLoad 中这样做：

```
// calculate new center point
CGFloat x = self.view.bounds.size.width / 2.0;
CGFloat y = self.view.bounds.size.height / 2.0;
CGPoint center = CGPointMake(y, x);

// set the new center point
self.view.center = center;

// Rotate the view 90 degrees counter clockwise around the new center point.
CGAffineTransform transform = self.view.transform;
transform = CGAffineTransformRotate(transform, -(M_PI / 2.0));
self.view.transform = transform; 
```

现在根据参考文档，如果未将变换设置为身份变换 self.view.frame 未定义。所以我应该使用边界和中心。

self.view.center 现在是正确的，因为我将它设置为我想要的。self.view.bounds 看起来没有改变。self.view.frame 似乎正是我想要的，但如上所述，参考声称它是无效的。

因此，虽然我可以得到我认为正确的数字，但我担心我忽略了一些关键的东西，以后会变得麻烦。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-18T15:38:54.830

使用 Quartz 2D，坐标系的原点 (0,0) 位于图形的左下角，而不是左上角。也许这就是你所缺少的。

请参阅：http: [//developer.apple.com/documentation/graphicsimaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC](http://developer.apple.com/documentation/graphicsimaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC)

# visual-studio - Visual Studio 中的嘘声？

> ID：738222
> 
> 赞同：7
> 
> 时间：2009-04-10T16:53:30.680
> 
> 标签：visual-studio, boo

有没有办法在我的 msvs 中使用 boo？我希望我的表单调用一些 boo 代码而不是 C#。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T17:04:47.877

我正在使用 Boo 来替换旧的数据库驱动的笨重规则引擎，它运行良好。

从这里开始：[Boo 交互式口译员](http://boo.codehaus.org/Interactive+Interpreter)

```
// One-line Boo interpreter in C#
InteractiveInterpreter2 interpreter = new InteractiveInterpreter2(); 
```

如果您的意思是在 VS .NET 中定义表单并实际编写 Boo，请查看[BooLangStudio](http://www.codinginstinct.com/2008/05/boo-in-visual-studio.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-21T22:34:36.307

我们一直在开发一个插件，它有点工作，但此时您应该真正使用 SharpDevelop 或 MonoDevelop。VS 插件可能会重新焕发活力，因为 VS2010 的新 VS 插件架构要好得多，但工作量确实很大，而且我们都很忙。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-27T03:48:48.263

[Visual Boo](http://visualstudiogallery.msdn.microsoft.com/8d15c62f-de0d-42f0-863a-daa8330d977a)（[源代码](https://github.com/mfeingold/Boo-Plugin)）是一个更新的项目，在 VS2010 中添加了对 Boo 的支持。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-11T10:02:54.113

你可以让你的 Boo 脚本弹出一个源代码可读的 VS 调试器，方法是插入：

```
System.Diagnostics.Debugger.Launch() 
```

或者

```
System.Diagnostics.Debugger.Break() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T16:59:58.183

如果 msvs 是指 Visual Studio，则必须使用 Visual Studio 可扩展性框架为 boo 编写一个语言插件（假设不存在）。

这是这样一个插件：

[http://www.codinginstinct.com/2008/05/boo-in-visual-studio.html](http://www.codinginstinct.com/2008/05/boo-in-visual-studio.html)

# c# - C# 找不到在客户站点运行的 System.Exception 错误

> ID：738225
> 
> 赞同：0
> 
> 时间：2009-04-10T16:56:02.887
> 
> 标签：c#, exception

我有一个客户无法运行我们的程序而不会崩溃并在事件日志中创建以下错误。与往常一样，它在我们的计算机上运行良好（尝试 6+），但客户说，只要单击程序中的任何内容，他们就会收到以下错误。

> EventType clr20r3, P1 datamonitor.exe, P2 1.0.0.3, P3 49dbd380, P4 datamonitor, P5 1.0.0.3, P6 49dbd380, P7 e9, P8 e5, P9 system.exception, P10 NIL

有关如何定位此类问题的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T17:44:59.387

我怀疑您客户的机器上缺少一些必需的 dll。他们要么使用不同的 .Net 版本，要么您在构建项目的同时引用了您已安装但他们没有安装的东西。我会仔细检查您是否包含了所有依赖项，并尝试设置一台机器来复制您的客户端的配置，即相同的操作系统、相同的 .Net 版本等。这应该可以帮助您诊断问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T17:45:20.633

如果您无法隔离您抛出的异常，请查看客户是否允许您复制[Runtime Debugger](http://msdn.microsoft.com/en-us/library/a6zb7c8d(VS.80).aspx)。它体积小、重量轻，可以让您捕获异常并找出异常的来源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:27:10.427

您可以通过向 AppDomain.UnhandledExceptionEventHandler 添加方法来添加代码以捕获代码中未处理的异常。

看这个例子：

[http://shiman.wordpress.com/2008/11/18/c-net-exception-appdomainunhandledexception/](http://shiman.wordpress.com/2008/11/18/c-net-exception-appdomainunhandledexception/)

有了这个，您可能能够捕获此异常，并注销更多详细信息，因此您还有更多工作要做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T17:29:25.320

您在应用程序中有任何类型的登录吗？那将是我开始的地方，捕获异常并记录它。

此外，在任何地方抛出 System.Exception 似乎是不寻常的，也许搜索你的代码库（因为据我所知，框架中的任何东西都应该抛出更具体的异常）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-15T20:18:31.430

我只是在这种场景中挣扎并写了一篇博客文章来谈论它。但基本上在您的情况下，datamonitor.exe 由于 system.exception 而崩溃。如果您使用 IL Dissassembler，您可以查看失败的类和方法。上述错误（e9）中的 p7 是您需要查找的功能。这可以通过使用 IL Dissassembler 在 dll 中搜索 06000e9 来找到。

[http://corymathews.com/eventtype-clr20r3-p1-w3wp-exe-system-nullreferenceexception/](http://corymathews.com/eventtype-clr20r3-p1-w3wp-exe-system-nullreferenceexception/)

# apache-flex - 在 Flex 中，如何在运行时获取无子画布组件的尺寸？

> ID：738231
> 
> 赞同：0
> 
> 时间：2009-04-10T16:59:27.623
> 
> 标签：apache-flex, layout, canvas

我的一个组件如下所示：

```
<mx:Canvas id="grid" width="100%" height="100%"></mx:Canvas> 
```

在creationComplete上，我加载了一些我想根据画布尺寸缩放和定位的精灵以创建自定义网格布局，但是当我访问“网格”的尺寸时，我得到0和0。有什么办法可以得到没有分配绝对值的尺寸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T21:44:17.860

我的理解是，除非 Canvas 包含一个或多个 DisplayObject 子项，否则它将始终将其宽度和高度属性报告为 0，而不管您可能对其应用的百分比大小。

您始终可以向 Canvas 添加一个空的虚拟 DisplayObject，但这不会很优雅。根据您计划实施自定义网格的方式，您可能需要重新考虑设计......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T04:54:04.520

您是否尝试将 Canvas 的宽度和高度绑定到其父级？如果它是 100%，那么它将具有与其父级相同的大小，并且您可以根据 Canvas 的父级容器绑定或调整 Sprite（UIComponent）的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:48:15.960

我目前无法检查，但您可以访问测量高度和测量宽度吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T22:20:33.717

它是否可能已创建但尚未显示（例如可见）？由于最终的大小和形状是派生的，直到实际需要绘制的东西才会发生。宽度和高度被记录为实际使用的值 - 当它们改变时甚至有事件。

最坏的情况，尝试在画布 Resize 事件中捕获它。

# .net - 使用 WebBrowser .NET 控件放大网页

> ID：738232
> 
> 赞同：20
> 
> 时间：2009-04-10T16:59:48.620
> 
> 标签：.net, winforms, webbrowser-control

在 IE7 中内置了“缩放”功能（显示在状态栏中），允许您放大 400%。我在演示/模拟应用程序中使用 WebBrowser .NET 控件，并且需要放大网页。这是可能吗？

（我不想简单地给页面拍照并放大，因为我需要使用页面上的链接和按钮）。

如果重要的话，我正在使用 .NET 2.0。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-10T17:08:45.680

[**IE Zoom**](http://slingkid.blogsome.com/2007/04/13/ie-zoom/)似乎有一个解决方案，涉及覆盖`AttachInterfaces`并`DetachInterfaces`在`WebBrowser`中获取`IWebBrowser2`接口，然后`ExecWB`使用`OLECMDID_OPTICAL_ZOOM`.

我试过他的[示例代码](http://teleios.bz/download/ZoomBrowser.zip)，它似乎工作；（删节的）相关类如下所示：

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace ZoomBrowser
{
    public partial class MyBrowser : WebBrowser
    {
        #region enums
        public enum OLECMDID
        {
            // ...
            OLECMDID_OPTICAL_ZOOM = 63,
            OLECMDID_OPTICAL_GETZOOMRANGE = 64,
            // ...
        }

        public enum OLECMDEXECOPT
        {
            // ...
            OLECMDEXECOPT_DONTPROMPTUSER,
            // ...
        }

        public enum OLECMDF
        {
            // ...
            OLECMDF_SUPPORTED = 1
        }
        #endregion

        #region IWebBrowser2
        [ComImport, /*SuppressUnmanagedCodeSecurity,*/
         TypeLibType(TypeLibTypeFlags.FOleAutomation | 
                     TypeLibTypeFlags.FDual |       
                     TypeLibTypeFlags.FHidden), 
         Guid("D30C1661-CDAF-11d0-8A3E-00C04FC9E26E")]
        public interface IWebBrowser2
        {
            [DispId(100)]  void GoBack();
            [DispId(0x65)] void GoForward();
            [DispId(0x66)] void GoHome();
            [DispId(0x67)] void GoSearch();
            [DispId(0x68)] void Navigate([In] string Url, 
                                         [In] ref object flags, 
                                         [In] ref object targetFrameName, 
                                         [In] ref object postData, 
                                         [In] ref object headers);
            [DispId(-550)] void Refresh();
            [DispId(0x69)] void Refresh2([In] ref object level);
            [DispId(0x6a)] void Stop();
            [DispId(200)]  object Application 
                           { [return: 
                              MarshalAs(UnmanagedType.IDispatch)] get; }
            [DispId(0xc9)] object Parent 
                           { [return: 
                              MarshalAs(UnmanagedType.IDispatch)] get; }
            [DispId(0xca)] object Container 
                           { [return: 
                              MarshalAs(UnmanagedType.IDispatch)] get; }
            [DispId(0xcb)] object Document 
                           { [return: 
                              MarshalAs(UnmanagedType.IDispatch)] get; }
            [DispId(0xcc)] bool TopLevelContainer { get; }
            [DispId(0xcd)] string Type { get; }
            [DispId(0xce)] int Left { get; set; }
            [DispId(0xcf)] int Top { get; set; }
            [DispId(0xd0)] int Width { get; set; }
            [DispId(0xd1)] int Height { get; set; }
            [DispId(210)]  string LocationName { get; }
            [DispId(0xd3)] string LocationURL { get; }
            [DispId(0xd4)] bool Busy { get; }
            [DispId(300)]  void Quit();
            [DispId(0x12d)] void ClientToWindow(out int pcx, out int pcy);
            [DispId(0x12e)] void PutProperty([In] string property, 
                                             [In] object vtValue);
            [DispId(0x12f)] object GetProperty([In] string property);
            [DispId(0)] string Name { get; }
            [DispId(-515)] int HWND { get; }
            [DispId(400)] string FullName { get; }
            [DispId(0x191)] string Path { get; }
            [DispId(0x192)] bool Visible { get; set; }
            [DispId(0x193)] bool StatusBar { get; set; }
            [DispId(0x194)] string StatusText { get; set; }
            [DispId(0x195)] int ToolBar { get; set; }
            [DispId(0x196)] bool MenuBar { get; set; }
            [DispId(0x197)] bool FullScreen { get; set; }
            [DispId(500)] void Navigate2([In] ref object URL, 
                                         [In] ref object flags, 
                                         [In] ref object targetFrameName, 
                                         [In] ref object postData, 
                                         [In] ref object headers);
            [DispId(0x1f5)] OLECMDF QueryStatusWB([In] OLECMDID cmdID);
            [DispId(0x1f6)] void ExecWB([In] OLECMDID cmdID, 
                                        [In] OLECMDEXECOPT cmdexecopt, 
                                        ref object pvaIn, IntPtr pvaOut);
            [DispId(0x1f7)] void ShowBrowserBar([In] ref object pvaClsid, 
                                                [In] ref object pvarShow, 
                                                [In] ref object pvarSize);
            [DispId(-525)] WebBrowserReadyState ReadyState { get; }
            [DispId(550)] bool Offline { get; set; }
            [DispId(0x227)] bool Silent { get; set; }
            [DispId(0x228)] bool RegisterAsBrowser { get; set; }
            [DispId(0x229)] bool RegisterAsDropTarget { get; set; }
            [DispId(0x22a)] bool TheaterMode { get; set; }
            [DispId(0x22b)] bool AddressBar { get; set; }
            [DispId(0x22c)] bool Resizable { get; set; }
        }
        #endregion

        private IWebBrowser2 axIWebBrowser2;

        public MyBrowser()
        {           
        }

        protected override void AttachInterfaces(
            object nativeActiveXObject)
        {
            base.AttachInterfaces(nativeActiveXObject);
            this.axIWebBrowser2 = (IWebBrowser2)nativeActiveXObject;
        }

        protected override void DetachInterfaces()
        {
            base.DetachInterfaces();
            this.axIWebBrowser2 = null;
        }

        public void Zoom(int factor)
        {
            object pvaIn = factor;
            try
            {
                this.axIWebBrowser2.ExecWB(OLECMDID.OLECMDID_OPTICAL_ZOOM,
                   OLECMDEXECOPT.OLECMDEXECOPT_DONTPROMPTUSER, 
                   ref pvaIn, IntPtr.Zero);
            }
            catch (Exception)
            {
                throw;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-09T17:24:42.123

简单提示：

```
//Zoom IN
webBrowser1.Focus();
SendKeys.Send("^{+}"); // [CTRL]+[+]

//Zoom OUT
webBrowser1.Focus();
SendKeys.Send("^-"); // [CTRL]+[-]

//Zoom 100%
webBrowser1.Focus();
SendKeys.Send("^0"); // [CTRL]+[0] 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-10-16T08:08:10.170

这对我有用：

```
int zoomFactor = 300;
((SHDocVw.WebBrowser)webBrowser1.ActiveXInstance).ExecWB(SHDocVw.OLECMDID.OLECMDID_OPTICAL_ZOOM,
    SHDocVw.OLECMDEXECOPT.OLECMDEXECOPT_DONTPROMPTUSER, zoomFactor, IntPtr.Zero);
```

似乎只有在加载文档后才能做到这一点。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-04-21T06:53:16.730

您可以使用 CSS：

```
private void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
        webBrowser1.Document.Body.Style = "zoom:50%";
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-08T21:26:09.523

请注意，您传递给 Zoom 函数的因子值假定值 100 对应于网页的“正常”大小。更高的因子值意味着您正在“放大”，因此页面看起来更大。较小的因子值意味着您正在“缩小”，因此页面看起来更小。我发现因子之间的合理增量是 10。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-30T10:06:31.430

对于遇到与我相同的问题的任何人，这是对 Gloupi 答案的修改，它应该适用于更多国际系统，其中加号和减号键位于不同位置，使用数字键盘符号键。这也修复了 dvorak 布局的放大和缩小。

```
// zoom in
webBrowser1.Focus();
SendKeys.Send("^{ADD}");

// zoom out
webBrowser1.Focus();
SendKeys.Send("^{SUBTRACT}");

// zoom reset
webBrowser1.Focus();
SendKeys.Send("^0"); 
```

# hardware - 无法在动态链接库 CRYPT32.dll 中找到过程入口点 CryptStringToBinaryW

> ID：738237
> 
> 赞同：0
> 
> 时间：2009-04-10T17:02:01.923
> 
> 标签：hardware, dvd

无法安装 DVD-RW 驱动器。发生错误：

> 无法在动态链接库 CRYPT32.dll 中找到过程入口点 CryptStringToBinaryW"

如何在 Windows 2000 SP4 上管理它？

网上冲浪发现只有这个
[http://www.daniweb.com/forums/thread146113.html](http://www.daniweb.com/forums/thread146113.html)
和这个
[http://www.derkeiler.com/Newsgroups/microsoft.public.platformsdk.security/2003-11/0556.html](http://www.derkeiler.com/Newsgroups/microsoft.public.platformsdk.security/2003-11/0556.html)
安装 kiwee_toolbar_installer.exe 确实会产生这个错误。也使用新的 USB 设备导致它发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T17:11:54.817

根据 Microsoft 的[CryptStringToBinary()](http://msdn.microsoft.com/en-us/library/aa380285(VS.85).aspx)文档，最低操作系统要求是：

```
Client: Windows XP
Server: Windows Server 2003 
```

所以，基本上你不能在 Win2K SP4 上使用这些驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T11:06:52.063

最后，我设法摆脱了这个错误消息，之后我的 DVD-RW 安装完美无瑕:) 一步一步：

1) sfc /scannow 恢复了一些文件，但这没有帮助

2）Mark Russinovich 在“设备管理器”窗口“进程监视器”中查找设备时揭示了这一点：

2130 14:00:47,6636859 系统 8 RegQueryKey HKLM\System\CurrentControlSet\Services\ElbyDelay 缓冲区太小查询：基本，长度：0

2131 14:00:47,6638242 系统 8 RegQueryKey HKLM\System\CurrentControlSet\Services\ElbyDelay 缓冲区太小查询：基本，长度：0

2132 14:00:47,7063290 系统 8 IRP_MJ_CREATE C:\WINNT\system32\drivers\ElbyDelay.sys 名称未找到所需访问：执行/遍历，处置：打开，选项：，属性：n/a，ShareMode：读取，删除，分配大小：不适用

2133 14:00:47,7067271 系统 8 IRP_MJ_CREATE C:\WINNT\system32\drivers\ElbyDelay.sys 名称未找到所需访问：同步，处置：打开，选项：同步 IO 非警报，属性：n/a，ShareMode ：读取、写入、删除、分配大小：不适用

我记得前段时间虚拟克隆驱动器的测试版被卸载了。

3）最后我使用设备管理器（显示隐藏的设备）和注册表删除了“ElBy”的出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T21:45:29.137

是的，谢谢。升级到较新 Windows 版本的另一个原因 :) 或者可能只是做 sfc /scannow 并超越这个 DLL-hell？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T17:10:02.263

CryptStringToBinary 在 Windows XP 上受支持，而不是 Windows 2000。需要此功能的软件将无法在 Windows 2000 SP4 上运行。没有解决方法。您需要联系应用程序的创建者以请求 Windows 2000 支持。

# javascript - Reddit 风格的“加入”弹出窗口

> ID：738238
> 
> 赞同：1
> 
> 时间：2009-04-10T17:03:06.367
> 
> 标签：javascript, ajax, popup

reddit的加入弹出窗口是隐藏在页面上还是通过ajax注入？

他们是怎么做到的呢？（如果有人知道一般术语，我会自己挖掘源代码，但需要一些大师指点）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T17:08:29.643

对于 reddit，它是一个隐藏元素。您可以使用[Shadowbox](http://www.shadowbox-js.com/)或[nyroModal之](http://nyromodal.nyrodev.com/)类的工具来实现这种效果（因为您可以调整动画）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T17:09:15.057

与其说是 AJAX 不如说是 javascript，它通常被称为[Lightbox](http://www.google.com/search?q=lightbox)或[Dialog](http://www.google.com/search?q=dialog+jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:09:52.620

它在那里，但用 CSS 隐藏，并用 Javascript 显示。使用jquery，您可以通过触发来达到类似的效果：

```
$('#join_div').show(); 
```

尝试查看禁用 CSS 的页面，您会看到它位于页面底部。（或者，您可以尝试查看源代码。）

# sql-server-2000 - sql server 2000 中的安全性

> ID：738247
> 
> 赞同：0
> 
> 时间：2009-04-10T17:06:18.963
> 
> 标签：sql-server-2000, windows-installer

如何在 sql server 2000 中创建用户和连接用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T17:11:52.133

在 SQL Server 2000 中，如果您以具有 ALTER ANY LOGIN 权限的用户身份连接，则可以运行此命令来创建登录作为设置默认数据库。

```
EXEC sp_addlogin 'MyName', 'MyPwd', 'MyDB';
GO 
```

在 2005 年，以管理员或具有 ALTER ANY USER 权限的用户身份连接，您可以执行此操作以创建用户

```
CREATE LOGIN MyName
    WITH PASSWORD = 'MyPwd';
USE MyDBName;
CREATE USER MyName FOR LOGIN MyName;
GO 
```

如果您尝试在安装集中包含 SQL Server Express / MSDE，则需要查看无人参与安装。查看MSDN 上[的手动创建安装文件。](http://msdn.microsoft.com/en-us/library/aa176598(SQL.80).aspx)

# firefox - Firefox 的 CSS3 “nth-child” 支持？

> ID：738266
> 
> 赞同：0
> 
> 时间：2009-04-10T17:14:05.793
> 
> 标签：firefox, css-selectors, css

根据 css3.info 的[selector test](http://www.css3.info/selectors-test/)，Firefox 3.0 支持 nth-child 选择器的一些排列。但是，[此处](http://www.css3.info/selectors-test/test-nthchild.html)显示的代码(#30) 对我不起作用。

它应该选择空段落，所以我将代码编辑为以下内容，但它没有在 Firefox 中显示（它在 Opera 中有效）。

```
<style type="text/css">
div :nth-child(even) {
    background-color: yellow;
    height: 30px;
}
</style>

<div>
    <div>Does this element match?</div>
    <div></div>
    <div>Does this element match?</div>
    <div></div>
</div> 
```

这是测试中的错误，还是我在某处犯了错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T17:19:14.300

嗯...根据[此页面](http://kimblim.dk/css-tests/selectors/)Firefox 3.0 不支持`:nth-child`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T17:29:12.467

如果您使用 jquery [，这](http://docs.jquery.com/Selectors/nthChild#index)可能会对您有所帮助（jquery 不在乎您的用户使用的是什么浏览器:)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-04T23:41:39.237

在 Firefox 3.5 中，您的测试用例现在可以按预期工作。

# c# - 异步 I/O 会抛出无法捕获的异常吗？

> ID：738276
> 
> 赞同：0
> 
> 时间：2009-04-10T17:19:29.680
> 
> 标签：c#, .net, exception, asynchronous

我有一个使用异步 I/O 和 AsyncCallbacks 来处理 I/O 完成的多线程 .NET 应用程序。很少，应用程序会失败，并出现以下异常：

```
Arithmetic operation resulted in an overflow.
   at MyApp.ReadComplete(IAsyncResult ar) in c:\MyApp.cs:line 123
   at System.Net.LazyAsyncResult.Complete(IntPtr userToken)
   at System.Net.ContextAwareResult.CompleteCallback(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Net.ContextAwareResult.Complete(IntPtr userToken)
   at System.Net.LazyAsyncResult.ProtectedInvokeCallback(Object result, IntPtr userToken)
   at System.Net.Sockets.BaseOverlappedAsyncResult.CompletionPortCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
   at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP) 
```

MyApp.cs 中的第 123 行是 AsyncCallback 的第一个可执行行，它位于 try/catch （异常 ex）内，但未执行 catch。

.NET Framework 是否对我说异常发生的位置？异常是否真的发生在我无法捕捉到的异步地狱中？为什么我不能捕捉到这个异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T00:58:50.787

尝试使用 catch 而不是 catch(Exception ex)。这可以捕获所有内容，包括。COM 异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-03T20:44:47.803

实际的答案是肯定的，.NET Framework 关于异常发生的位置是错误的，但不是因为异常发生在异步地狱中。异常实际上发生在回调方法中，在堆栈跟踪中指示的行之后的许多行。实际发生异常的行不在 try/catch 块内，因此预期会出现未处理的异常。

我向 Microsoft 报告了错误的堆栈跟踪，但不知道它是否被视为错误。

我认为可以肯定地说，如果您的堆栈跟踪指向异步回调方法的第一个可执行行，您应该怀疑它可能是错误的。

# c# - .NET 反射 - 如何从 ParameterInfo 中获取“真实”类型

> ID：738277
> 
> 赞同：19
> 
> 时间：2009-04-10T17:19:53.923
> 
> 标签：c#, .net, reflection

我试图验证一个参数既是一个输出参数又是一个接口（ICollection）。反射 api 似乎不想给我参数的“真实”类型，只有最后一个带有“&”的参数，它不会在 IsAssignableFrom 语句中正确评估。我已经编写了一些有效的 c# 代码，但似乎应该有更好的方法来做到这一点。

```
bool isCachedArg(ParameterInfo pInfo)
{    
    if (!pInfo.IsOut)
        return false;

    string typeName = pInfo.ParameterType.FullName;
    string nameNoAmpersand = typeName.Substring(0, typeName.Length - 1);
    Type realType = Type.GetType(nameNoAmpersand);

    if (!typeof(ICollection).IsAssignableFrom(realType))
        return false;

    return true;
} 
```

有没有办法在不从字符串名称重新加载 Type 的情况下获取 realType？我仍在使用 .NET 2.1。

谢谢，兰迪

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-10T17:28:42.653

一个`out`参数是“by ref”——所以你会发现`pInfo.ParameterType.IsByRef`返回 true。要获取底层的非引用类型，请调用`GetElementType()`：

```
Type realType = pInfo.ParameterType.GetElementType(); 
```

（当然，你应该只在引用时这样做*。*这也适用于`ref`参数。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T17:23:20.670

pInfo.ParameterType 不是您要查找的类型吗？

根据文档，PropertyInfo 类的 ParamterType 属性是： [“*表示此参数类型的 Type 对象。* ”](http://msdn.microsoft.com/en-us/library/system.reflection.parameterinfo.parametertype.aspx)

此外，以下代码给出了预期的输出：

```
 Type t = typeof (X);
    var mi = t.GetMethod("Method");
    var parameters = mi.GetParameters();
    foreach(Type parameterType in parameters.Select(pi => pi.ParameterType))
            Console.WriteLine(parameterType.IsByRef ? parameterType.GetElementType() : parameterType); 
```

**编辑：**正如 John Skeet 指出的，如果参数是 ref; 您应该使用 GetElementType 来获取正确的类型。我更新了代码示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-29T02:44:46.957

看到这个：

```
var parameters = methodinfo.GetParameters();
foreach (var parameter in parameters)
{
    var HasValue = "";
    Type ParameterType = (parameter.IsOut || parameter.ParameterType.IsByRef) ? parameter.ParameterType.GetElementType() : parameter.ParameterType;
    if (ParameterType.GetProperties().Count() == 2 && ParameterType.GetProperties()[0].Name.Equals("HasValue"))
    {
        HasValue = "?";
        ParameterType = ParameterType.GetProperties()[1].PropertyType;
    } 
    StringBuilder sb = new StringBuilder();
    using (StringWriter sw = new StringWriter(sb))
    {
        var expr = new CodeTypeReferenceExpression(ParameterType);
        var prov = new CSharpCodeProvider();
        prov.GenerateCodeFromExpression(expr, sw, new CodeGeneratorOptions());
    }
    var result = string.Concat(sb.ToString(), HasValue, " ", parameter.Name);
    Console.WriteLine(result);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-01T07:13:37.223

你也可以使用

```
Type type = Type.GetType("System."+ pInfo.ParameterType.Name); 
```

如果`ParameterType.GetElementType()`不起作用

# iphone - 如何将文字文本绑定到 SQLite 查询？

> ID：738279
> 
> 赞同：4
> 
> 时间：2009-04-10T17:22:19.550
> 
> 标签：iphone, sql, objective-c, sqlite

我正在尝试在我的 iPhone 应用程序中使用 SQLite C API。我正在尝试在 SQLite 数据库中查询在某个日期之后已完成的记录数。数据库将完成日期保存为文本

```
YYYY-MM-dd
```

格式。例如文本

```
2009-04-10
```

可能显示为完成日期。

当我从命令行查询数据库时，我的查询有效，但从应用程序运行时，查询无效。这就是我正在做的事情：

从命令行，我运行这个查询：

```
sqlite> SELECT COUNT(*) FROM tasks WHERE completed > '2009-04-09'
...> go
1 
```

如您所见，如我所料，找到了一条记录。

在我的应用程序中，我执行了这段代码（显然是用 Objective-C 编写的）：

```
static sqlite3_stmt *count_tasks_statement = nil;
if(count_tasks_statement == nil) {
    const char *sql = "SELECT COUNT(*) FROM tasks WHERE completed > '?'";

    if (sqlite3_prepare_v2(database, sql, -1, &count_tasks_statement, NULL) != SQLITE_OK) {
        NSAssert1(0, @"Error: failed to prepare statement with message '%s'.", sqlite3_errmsg(database));
    }
}

NSString *today = @"2009-04-09";
sqlite3_bind_text(count_tasks_statement, 1, [today UTF8String], -1, SQLITE_TRANSIENT);

// Get the row count from the query
NSInteger taskCount = 0;
if(sqlite3_step(count_tasks_statement) == SQLITE_ROW) {

    // The second parameter indicates the column index into the result set.
    taskCount = sqlite3_column_int(count_tasks_statement, 0);
}

// Reset the statement for future reuse.
sqlite3_reset(count_tasks_statement); 
```

当我在此代码上使用调试器并检查 taskCount 变量时，它设置为 0，表示未找到任何记录。（如果我更改代码以返回找到的行的主键，它仍然不返回任何内容。）

由于它在命令行中工作，但在我的代码中没有，我假设我在我的 SQL 中引用问号或将文字文本日期绑定到查询时做错了。但是，我已经尝试了很多不同的方法，但没有运气。帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-10T17:42:46.490

不要将参数占位符放在引号内，即使值是字符串或日期文字。

```
const char *sql = "SELECT COUNT(*) FROM tasks WHERE completed > ?"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T17:43:05.303

我认为你不需要问号周围的额外引号。

尝试

```
const char *sql = "SELECT COUNT(*) FROM tasks WHERE completed > ?"; 
```

它应该可以工作。

# sql-server - 如何计算 SQL varchar 中某个子字符串的出现次数？

> ID：738282
> 
> 赞同：164
> 
> 时间：2009-04-10T17:23:36.817
> 
> 标签：sql-server, tsql

我有一列，其值的格式类似于 a、b、c、d。有没有办法计算 T-SQL 中该值中逗号的数量？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2009-04-10T17:31:49.697

想到的第一种方法是通过用空字符串替换逗号并比较长度来间接地做到这一点

```
Declare @string varchar(1000)
Set @string = 'a,b,c,d'
select len(@string) - len(replace(@string, ',', '')) 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2010-05-25T15:57:16.353

cmsjr 的答案的快速扩展，适用于具有多个字符的字符串。

```
CREATE FUNCTION dbo.CountOccurrencesOfString
(
    @searchString nvarchar(max),
    @searchTerm nvarchar(max)
)
RETURNS INT
AS
BEGIN
    return (LEN(@searchString)-LEN(REPLACE(@searchString,@searchTerm,'')))/LEN(@searchTerm)
END 
```

用法：

```
SELECT * FROM MyTable
where dbo.CountOccurrencesOfString(MyColumn, 'MyString') = 1 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-04-10T17:33:00.193

您可以将字符串的长度与删除逗号的长度进行比较：

```
len(value) - len(replace(value,',','')) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-04-30T16:06:07.003

@csmjr 的回答在某些情况下存在问题。

他的回答是这样做：

```
Declare @string varchar(1000)
Set @string = 'a,b,c,d'
select len(@string) - len(replace(@string, ',', '')) 
```

这在大多数情况下都有效，但是，请尝试运行：

```
DECLARE @string VARCHAR(1000)
SET @string = 'a,b,c,d ,'
SELECT LEN(@string) - LEN(REPLACE(@string, ',', '')) 
```

出于某种原因，REPLACE 去掉了最后的逗号，但也去掉了它之前的空格（不知道为什么）。当您期望 4 时，这会导致返回值为 5。这是执行此操作的另一种方法，即使在这种特殊情况下也可以使用：

```
DECLARE @string VARCHAR(1000)
SET @string = 'a,b,c,d ,'
SELECT LEN(REPLACE(@string, ',', '**')) - LEN(@string) 
```

请注意，您不需要使用星号。任何两个字符的替换都可以。这个想法是，对于要计算的字符的每个实例，将字符串加长一个字符，然后减去原始字符串的长度。它基本上是原始答案的相反方法，它没有奇怪的修剪副作用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-02-03T23:35:10.300

在@Andrew 的解决方案的基础上，您将使用非过程表值函数和 CROSS APPLY 获得更好的性能：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*  Usage:
    SELECT t.[YourColumn], c.StringCount
    FROM YourDatabase.dbo.YourTable t
        CROSS APPLY dbo.CountOccurrencesOfString('your search string',     t.[YourColumn]) c
*/
CREATE FUNCTION [dbo].[CountOccurrencesOfString]
(
    @searchTerm nvarchar(max),
    @searchString nvarchar(max)

)
RETURNS TABLE
AS
    RETURN 
    SELECT (DATALENGTH(@searchString)-DATALENGTH(REPLACE(@searchString,@searchTerm,'')))/NULLIF(DATALENGTH(@searchTerm), 0) AS StringCount 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-04T12:39:38.547

```
Declare @string varchar(1000)

DECLARE @SearchString varchar(100)

Set @string = 'as as df df as as as'

SET @SearchString = 'as'

select ((len(@string) - len(replace(@string, @SearchString, ''))) -(len(@string) - 
        len(replace(@string, @SearchString, ''))) % 2)  / len(@SearchString) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-11-23T10:06:15.820

接受的答案是正确的，将其扩展为在子字符串中使用 2 个或更多字符：

```
Declare @string varchar(1000)
Set @string = 'aa,bb,cc,dd'
Set @substring = 'aa'
select (len(@string) - len(replace(@string, @substring, '')))/len(@substring) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-26T07:37:56.867

如果我们知道 LEN 和空间有限制，为什么不能先替换空间呢？然后我们知道没有空间可以混淆LEN。

```
len(replace(@string, ' ', '-')) - len(replace(replace(@string, ' ', '-'), ',', '')) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2022-01-14T04:45:29.730

基于最佳答案和其他答案的改进版本：

用分隔符包裹字符串可确保 LEN 正常工作。使替换字符串比匹配字符串长一个字符就不需要除法了。

```
CREATE FUNCTION dbo.MatchCount(@value nvarchar(max), @match  nvarchar(max))
RETURNS int
BEGIN
    RETURN LEN('[' + REPLACE(@value,@match,REPLICATE('*', LEN('[' + @match + ']') - 1)) + ']') - LEN('['+@value+']')
END 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-11T21:08:59.510

```
DECLARE @records varchar(400)
SELECT @records = 'a,b,c,d'
select  LEN(@records) as 'Before removing Commas' , LEN(@records) - LEN(REPLACE(@records, ',', '')) 'After Removing Commans' 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-16T18:06:17.200

我认为 Darrel Lee 有一个很好的答案。替换`CHARINDEX()`为`PATINDEX()`，您也可以`regex`沿着字符串进行一些弱搜索...

就像，假设您将其用于`@pattern`：

```
set @pattern='%[-.|!,'+char(9)+']%' 
```

为什么你可能想做这样疯狂的事情？

假设您正在将分隔的文本字符串加载到临时表中，其中保存数据的字段类似于 varchar(8000) 或 nvarchar(max)...

有时使用数据而不是 ETL（提取-转换-加载）进行 ELT（提取-加载-转换）更容易/更快，一种方法是将分隔记录按原样加载到临时表中，特别是如果您可能想要一种更简单的方法来查看异常记录，而不是将它们作为 SSIS 包的一部分来处理……但这对于不同的线程来说是一场圣战。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-03-02T17:25:30.957

以下应该对单字符和多字符搜索都有效：

```
CREATE FUNCTION dbo.CountOccurrences
(
   @SearchString VARCHAR(1000),
   @SearchFor    VARCHAR(1000)
)
RETURNS TABLE
AS
   RETURN (
             SELECT COUNT(*) AS Occurrences
             FROM   (
                       SELECT ROW_NUMBER() OVER (ORDER BY O.object_id) AS n
                       FROM   sys.objects AS O
                    ) AS N
                    JOIN (
                            VALUES (@SearchString)
                         ) AS S (SearchString)
                         ON
                         SUBSTRING(S.SearchString, N.n, LEN(@SearchFor)) = @SearchFor
          );
GO

---------------------------------------------------------------------------------------
-- Test the function for single and multiple character searches
---------------------------------------------------------------------------------------
DECLARE @SearchForComma      VARCHAR(10) = ',',
        @SearchForCharacters VARCHAR(10) = 'de';

DECLARE @TestTable TABLE
(
   TestData VARCHAR(30) NOT NULL
);

INSERT INTO @TestTable
     (
        TestData
     )
VALUES
     ('a,b,c,de,de ,d e'),
     ('abc,de,hijk,,'),
     (',,a,b,cde,,');

SELECT TT.TestData,
       CO.Occurrences AS CommaOccurrences,
       CO2.Occurrences AS CharacterOccurrences
FROM   @TestTable AS TT
       OUTER APPLY dbo.CountOccurrences(TT.TestData, @SearchForComma) AS CO
       OUTER APPLY dbo.CountOccurrences(TT.TestData, @SearchForCharacters) AS CO2; 
```

可以使用数字表 (dbo.Nums) 稍微简化该函数：

```
 RETURN (
             SELECT COUNT(*) AS Occurrences
             FROM   dbo.Nums AS N
                    JOIN (
                            VALUES (@SearchString)
                         ) AS S (SearchString)
                         ON
                         SUBSTRING(S.SearchString, N.n, LEN(@SearchFor)) = @SearchFor
          ); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-07T10:56:15.810

使用此代码，它运行良好。我创建了一个接受两个参数的 sql 函数，第一个参数是我们要在其中搜索的长字符串，它可以接受最长为 1500 个字符的字符串（当然您可以扩展它甚至将其更改为文本数据类型）。第二个参数是我们要计算其出现次数的子字符串（长度最多为200个字符，当然你可以根据需要更改）。并且输出是一个整数，代表频率的个数……好好享受吧。

* * *

```
CREATE FUNCTION [dbo].[GetSubstringCount]
(
  @InputString nvarchar(1500),
  @SubString NVARCHAR(200)
)
RETURNS int
AS
BEGIN 
        declare @K int , @StrLen int , @Count int , @SubStrLen int 
        set @SubStrLen = (select len(@SubString))
        set @Count = 0
        Set @k = 1
        set @StrLen =(select len(@InputString))
    While @K <= @StrLen
        Begin
            if ((select substring(@InputString, @K, @SubStrLen)) = @SubString)
                begin
                    if ((select CHARINDEX(@SubString ,@InputString)) > 0)
                        begin
                        set @Count = @Count +1
                        end
                end
                                Set @K=@k+1
        end
        return @Count
end 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-09-26T08:51:32.697

我终于写了这个应该涵盖所有可能情况的函数，在输入中添加一个 char 前缀和后缀。此 char 被评估为与搜索参数中包含的任何 char 不同，因此它不会影响结果。

```
CREATE FUNCTION [dbo].[CountOccurrency]
(
@Input nvarchar(max),
@Search nvarchar(max)
)
RETURNS int AS
BEGIN
    declare @SearhLength as int = len('-' + @Search + '-') -2;
    declare @conteinerIndex as int = 255;
    declare @conteiner as char(1) = char(@conteinerIndex);
    WHILE ((CHARINDEX(@conteiner, @Search)>0) and (@conteinerIndex>0))
    BEGIN
        set @conteinerIndex = @conteinerIndex-1;
        set @conteiner = char(@conteinerIndex);
    END;
    set @Input = @conteiner + @Input + @conteiner
    RETURN (len(@Input) - len(replace(@Input, @Search, ''))) / @SearhLength
END 
```

用法

```
select dbo.CountOccurrency('a,b,c,d ,', ',') 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-03-08T10:11:50.873

```
Declare @MainStr nvarchar(200)
Declare @SubStr nvarchar(10)
Set @MainStr = 'nikhildfdfdfuzxsznikhilweszxnikhil'
Set @SubStr = 'nikhil'
Select (Len(@MainStr) - Len(REPLACE(@MainStr,@SubStr,'')))/Len(@SubStr) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-03-19T15:35:43.690

在 SQL 2017 或更高版本中，您可以使用：

```
declare @hits int = 0
set @hits = (select value from STRING_SPLIT('F609,4DFA,8499',','));
select count(@hits) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-03-27T14:02:20.333

此 T-SQL 代码查找并打印句子 @s 中所有出现的模式 @p。之后可以对句子进行任何处理。

```
declare @old_hit int = 0
declare @hit int = 0
declare @i int = 0
declare @s varchar(max)='alibcalirezaalivisualization'
declare @p varchar(max)='ali'
 while @i<len(@s)
  begin
   set @hit=charindex(@p,@s,@i)
   if @hit>@old_hit 
    begin
    set @old_hit =@hit
    set @i=@hit+1
    print @hit
   end
  else
    break
 end 
```

结果是：1 6 13 20

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-09-01T14:40:03.593

我最终为此使用了 CTE 表，

```
CREATE TABLE #test (
 [id] int,
 [field] nvarchar(500)
)

INSERT INTO #test ([id], [field])
VALUES (1, 'this is a test string http://url, and https://google.com'),
       (2, 'another string, hello world http://example.com'),
       (3, 'a string with no url')

SELECT *
FROM #test

;WITH URL_count_cte ([id], [url_index], [field])
AS
(
    SELECT [id], CHARINDEX('http', [field], 0)+1 AS [url_index], [field]
    FROM #test AS [t]
    WHERE CHARINDEX('http', [field], 0) != 0
    UNION ALL
    SELECT [id], CHARINDEX('http', [field], [url_index])+1 AS [url_index], [field]
    FROM URL_count_cte
    WHERE CHARINDEX('http', [field], [url_index]) > 0
)

-- total urls
SELECT COUNT(1)
FROM URL_count_cte

-- urls per row
SELECT [id], COUNT(1) AS [url_count]
FROM URL_count_cte
GROUP BY [id] 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-22T18:38:08.870

使用此函数，您可以获得文本中单词的重复次数。

```
/****** Object:  UserDefinedFunction [dbo].[fn_getCountKeywords]    Script Date: 22/11/2021 17:52:00 ******/
DROP FUNCTION IF EXISTS [dbo].[fn_getCountKeywords]
GO
/****** Object:  UserDefinedFunction [dbo].[fn_getCountKeywords]    Script Date: 2211/2021 17:52:00 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      m_Khezrian
-- Create date: 2021/11/22-17:52
-- Description: Return Count Keywords In Input Text
-- =============================================

Create OR Alter Function [dbo].[fn_getCountKeywords]
    (@Text      nvarchar(max)
    ,@Keywords  nvarchar(max)
    )
RETURNS @Result TABLE
(    
   [ID]         int Not Null IDENTITY PRIMARY KEY
  ,[Keyword]    nvarchar(max) Not Null
  ,[Cnt]        int Not Null Default(0)

)
/*With ENCRYPTION*/ As 
Begin
    Declare @Key    nvarchar(max);
    Declare @Cnt    int;
    Declare @I      int;

    Set @I = 0 ;
    --Set @Text = QUOTENAME(@Text);

    Insert Into @Result
        ([Keyword])
    Select Trim([value])
    From String_Split(@Keywords,N',')
    Group By [value]
    Order By Len([value]) Desc;

    Declare CntKey_Cursor Insensitive Cursor For
    Select [Keyword]
    From @Result
    Order By [ID];

    Open CntKey_Cursor;
    Fetch Next From CntKey_Cursor Into @Key;
    While (@@Fetch_STATUS = 0) Begin
        Set @Cnt = 0;

        While (PatIndex(N'%'+@Key+'%',@Text) > 0) Begin
            Set @Cnt += 1;
            Set @I += 1 ;
            Set @Text = Stuff(@Text,PatIndex(N'%'+@Key+'%',@Text),len(@Key),N'{'+Convert(nvarchar,@I)+'}');
            --Set @Text = Replace(@Text,@Key,N'{'+Convert(nvarchar,@I)+'}');
        End--While

        Update @Result
            Set [Cnt] = @Cnt
        Where ([Keyword] = @Key);

        Fetch Next From CntKey_Cursor Into @Key;
    End--While
    Close CntKey_Cursor;
    Deallocate CntKey_Cursor;
    Return
 End
GO

--Test
Select *
From dbo.fn_getCountKeywords(
        N'<U+0001F4E3> MARKET IMPACT Euro area Euro CPIarea annual inflation up to 3.0% MaCPIRKET forex'
        ,N'CPI ,core,MaRKET , Euro area'
        )       

Go 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2012-06-08T14:39:53.407

您可以使用以下存储过程来获取值。

```
IF  EXISTS (SELECT * FROM sys.objects 
WHERE object_id = OBJECT_ID(N'[dbo].[sp_parsedata]') AND type in (N'P', N'PC'))
    DROP PROCEDURE [dbo].[sp_parsedata]
GO
create procedure sp_parsedata
(@cid integer,@st varchar(1000))
as
  declare @coid integer
  declare @c integer
  declare @c1 integer
  select @c1=len(@st) - len(replace(@st, ',', ''))
  set @c=0
  delete from table1 where complainid=@cid;
  while (@c<=@c1)
    begin
      if (@c<@c1) 
        begin
          select @coid=cast(replace(left(@st,CHARINDEX(',',@st,1)),',','') as integer)
          select @st=SUBSTRING(@st,CHARINDEX(',',@st,1)+1,LEN(@st))
        end
      else
        begin
          select @coid=cast(@st as integer)
        end
      insert into table1(complainid,courtid) values(@cid,@coid)
      set @c=@c+1
    end 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-02-11T19:37:19.120

Replace/Len 测试很可爱，但可能效率很低（尤其是在内存方面）。一个带有循环的简单函数就可以完成这项工作。

```
CREATE FUNCTION [dbo].[fn_Occurences] 
(
    @pattern varchar(255),
    @expression varchar(max)
)
RETURNS int
AS
BEGIN

    DECLARE @Result int = 0;

    DECLARE @index BigInt = 0
    DECLARE @patLen int = len(@pattern)

    SET @index = CHARINDEX(@pattern, @expression, @index)
    While @index > 0
    BEGIN
        SET @Result = @Result + 1;
        SET @index = CHARINDEX(@pattern, @expression, @index + @patLen)
    END

    RETURN @Result

END 
```

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2009-04-10T18:16:53.927

也许您不应该那样存储数据。在字段中存储逗号分隔列表是一种不好的做法。IT 的查询效率非常低。这应该是一个相关的表。

# iphone - 多个 AVAudioPlayers：我只能让第一个初始化播放

> ID：738294
> 
> 赞同：0
> 
> 时间：2009-04-10T17:30:45.177
> 
> 标签：iphone, objective-c

我有一堆声音片段，命名为 sound1.mp3 到 soundN.mp3。我想在触摸时随机播放它们，所以我为每个存储在播放器（AVAudioPlayer**）中的剪辑设置了一个 AVAudioPlayer。初始化所有内容后，我可以播放的唯一声音是 sound1.mp3。我究竟做错了什么？

感谢您的帮助，初始化代码如下。

```
players = (AVAudioPlayer**) malloc ( sizeof (AVAudioPlayer*) * NUM_CLIPS);
NSString* path;
NSString* name;
for(uint i = 0; i < NUM_CLIPS; i++){
    name = [NSString stringWithFormat: @"sound%d", i+1];
    path = [[NSBundle mainBundle] pathForResource:name ofType:@"mp3"];
    players[i] = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];
    [players[i] setMeteringEnabled:YES];
    [players[i] prepareToPlay];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T18:02:17.370

这样做的原因是 mp3/aac 文件是硬件解码的，并且一次只能解码一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T12:34:03.973

James Brooks (jamesbrooks dot net) 说，将 *.mp3 文件更改为 *.caf 允许他使用 AVAudioPlayer 播放多种声音。但是，我个人无法同时播放 *.caf 文件，但*可以*同时播放 *.aiff 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:47:19.740

没关系，似乎prepareToPlay的工作方式有问题

# python - 如何修改 ModelMultipleChoiceField 的选择

> ID：738301
> 
> 赞同：6
> 
> 时间：2009-04-10T17:34:26.650
> 
> 标签：python, django, django-forms

假设我有一些人为的模型：

```
class Author(Model):
   name = CharField()

class Book(Model):
   title = CharField()
   author = ForeignKey(Author) 
```

假设我想为 Book 使用 ModelForm：

```
 class BookForm(ModelForm):
      class Meta:
         model = Book 
```

到目前为止很简单。但是我们也假设我的数据库中有大量的作者，我不希望有这么长的多项选择字段。所以，我想限制 BookForm 的 ModelMultipleChoiceField 作者字段上的查询集。假设我想要的查询集在 之前无法选择`__init__`，因为它依赖于要传递的参数。

这似乎可以解决问题：

```
class BookForm(ModelForm):
   class Meta:
      model = Book

   def __init__(self, letter):
      # returns the queryset based on the letter
      choices = getChoices(letter)
      self.author.queryset = choices 
```

当然，如果这行得通，我就不会在这里。这给了我一个AttributeError。“BookForm”对象没有“作者”属性。所以，我也尝试过这样的事情，我尝试覆盖 ModelForm 的默认字段，然后再设置它：

```
class BookForm(ModelForm):
   author = ModelMultipleChoiceField(queryset=Author.objects.all())

   class Meta:
      model = Book

   def __init__(self, letter):
      choices = getChoices(letter)
      self.author.queryset = choices 
```

产生相同的结果。

有人知道这是怎么做的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-10T18:36:19.747

尽管卡尔对这些领域的看法是正确的，但您也错过了一个超级类的电话。我就是这样做的：

```
class BookForm(ModelForm):
    author = ModelMultipleChoiceField(queryset=Author.objects.all())

    class Meta:
        model = Book

    def __init__(self, *args, **kwargs):
        letter = kwargs.pop('letter')
        super(BookForm, self).__init__(*args, **kwargs)
        choices = getChoices(letter)
        self.fields['author'].queryset = choices 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-10T18:30:45.530

表单对象没有字段作为属性，您需要查看“字段”属性，这是一个字典：

```
self.fields['author'].queryset = choices 
```

如果您想完全了解这里发生了什么，您可能会对[这个答案](https://stackoverflow.com/questions/500650/django-model-question-newbie/501362#501362)感兴趣- 它是关于模型的，但表单的工作方式类似。

# vb.net - 如何将两个字符串转换为 DateTimes 并在 VB.NET 中进行比较？

> ID：738307
> 
> 赞同：0
> 
> 时间：2009-04-10T17:36:05.087
> 
> 标签：vb.net, datetime

字符串以格式从数据库返回：'00/00/0000' 然后我需要将其与用户以相同格式输入的日期进行比较。如何进行转换并比较两个日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T17:40:30.940

使用 DateTime 结构上的静态 ParseExact 方法来转换字符串。您还将传递您想要的格式，dd/MM/yyyy 或 MM/dd/yyyy，具体取决于您想要的格式（00/00/0000 的示例没有说明适用于您的格式）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T17:39:50.460

您可以使用

```
 Dim dateA = DateTime.ParseExact(firstDateString, @"dd\/MM\/yyyy", Null)
Dim dateB = DateTime.ParseExact(secondDateString, @"dd\/MM\/yyyy", Null)
Dim areEqual = (dateA = dateB); 
```

假设您的日期格式是日/月/年。如果是月/日/年，只需交换 dd 和 MM

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:39:40.507

尝试这样的事情：

```
String.Compare("00/00/0000", dateTime.ToString("MM/dd/yyyy")) 
```

但也许更好的方法是这样做：

```
DateTime.Equals(yourDateTime, DateTime.Parse(databaseDateTime)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T18:05:47.587

尝试以下

```
Dim date1 = CDate(firstDateString)
Dim date2 = CDate(secondDateString)
Dim comp = date1 = date2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T18:50:08.370

当您说比较时，您是在尝试分析日期是否相同（到当天）还是在几天内？如果要比较日期是否相同，那么您可以只比较字符串或使用 date.equals （如本文之前的帖子中所述），如果您试图确定一个范围，则必须使用日期比较

```
 Dim lDate1 As String = "29/03/2009"
    Dim lDate2 As String = "30/03/2009"
    Dim lPeriod As Int16 = 7

    If lDate1 = lDate2 Then
        '** Dates the same
    End If

    If Date.Equals(Date.ParseExact(lDate1, "dd/MM/yyyy", Nothing), Date.ParseExact(lDate2, "dd/MM/yyyy", Nothing)) Then
        '** The same
    End If

    If Date.Compare(Date.ParseExact(lDate1, "dd/MM/yyyy", Nothing), Date.ParseExact(lDate2, "dd/MM/yyyy", Nothing)) > (lPeriod * -1) And Date.Compare(Date.ParseExact(lDate1, "dd/MM/yyyy", Nothing), Date.ParseExact(lDate2, "dd/MM/yyyy", Nothing)) < lPeriod Then
        '** Within the period
    End If 
```

# java - 请帮助解决我的 JSP 国际化问题

> ID：738309
> 
> 赞同：3
> 
> 时间：2009-04-10T17:38:11.587
> 
> 标签：java, forms, jsp, internationalization

我对 JSP 中的 I18N 有问题，特别是表单。

当我在我的第一个表单中输入一些捷克字符（例如，“ěščřžýá...”）时，进入字段“ `fieldOne`”，然后在第二页显示该字段中的文本，而不是捷克字符，我将其视为“ÄÄ” . （注意，第二页获取带有“ `request.getProperty("fieldOne")`”的捷克语字符）

这是源代码：

**第一页：**

```
<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>

<%@ taglib uri="http://jakarta.apache.org/struts/tags-bean" prefix="bean" %>
<%@ taglib uri="http://jakarta.apache.org/struts/tags-html" prefix="html" %>
<%@ taglib uri="http://jakarta.apache.org/struts/tags-logic" prefix="logic" %>

<html>
 <head></head>
 <body>
    <form action="druha.jsp" method="post">
       <input type="textarea" name="fieldOne">
       <input type="submit">
    </form>
 </body>
</html> 
```

**第二页：**

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>

<%@ taglib uri="http://jakarta.apache.org/struts/tags-bean" prefix="bean" %>
<%@ taglib uri="http://jakarta.apache.org/struts/tags-html" prefix="html" %>
<%@ taglib uri="http://jakarta.apache.org/struts/tags-logic" prefix="logic" %>

<html>
 <head></head>
 <body>
    <h1>The text: </h1> <%=request.getProperty("fieldOne")%>
 </body>
</html> 
```

感谢帮助...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T17:54:02.780

你用的是哪个容器？此信息对于此类问题很重要。

不管怎样，试着打电话

```
request.setCharacterEncoding("UTF-8"); 
```

在读取参数之前。有时在 header 指令中设置页面编码是不够的。您肯定需要在 Tomcat 和 servlet 中执行此操作，我认为 JSP 也可能是这种情况。

# html - 当我点击一个链接时，大多数浏览器都会在它周围画一个虚线框。我怎样才能防止这种情况？

> ID：738319
> 
> 赞同：6
> 
> 时间：2009-04-10T17:41:33.793
> 
> 标签：html, css

当我点击一个链接时，大多数浏览器都会在它周围画一个虚线框。最容易查看链接是否在新窗口中打开，因为原始页面仍然存在。

这可以停止吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T17:44:59.057

把它放在你的 CSS 中

```
-moz-outline: none;
outline: none; 
```

这是[更详细的细分](http://sonspring.com/journal/removing-dotted-links)和[相关问题](https://stackoverflow.com/questions/71074/how-to-remove-firefoxs-dotted-outline-on-buttons-as-well-as-links)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T18:13:36.523

[http://css-tricks.com/removing-the-dotted-outline/](http://css-tricks.com/removing-the-dotted-outline/)

更好的使用：

```
a:active {   
    outline: none;
} 
```

或者

```
a { 
    outline: none;
} 
```

它更具体。否则你可能一次压制太多东西。如果您关心可访问性，请确保为无法使用鼠标的用户提供其他方式来了解哪个链接处于活动状态或已聚焦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T17:43:26.130

一种选择是`blur`在链接被点击后使用 javascript 函数。该`blur`函数将焦点从链接上移开，因此它不会被围绕它的虚线框绘制。

如果您使用的是 jQuery，那么您可以实现这样的解决方案：

```
$(function() {
    $('a').click(function() {
        $(this).blur();
    });
}); 
```

# php - PHP 项目的 /var/www/ 文件夹结构

> ID：738322
> 
> 赞同：9
> 
> 时间：2009-04-10T17:42:32.997
> 
> 标签：php, mamp

我只是将 MAMP 用于我的开发环境，并且还没有真正理解 /var/www/project-name/ 在 Web 服务器上的文件夹结构。我想知道您是打算将 Web 服务器指向 htdocs 文件夹还是应该指向项目文件夹的根目录？

我问的原因是因为出于安全目的，库应该存在于 htdocs 文件夹之外，但是如何从 Web 应用程序本身指向它们？如果 Web 服务器指向 Web 应用程序的 htdocs 文件夹，Web 应用程序肯定不能访问 htdocs 文件夹之外的文件夹吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T18:24:57.760

一个简单的解决方案是具有这样的文件夹结构：

```
/var/www/project-name/
    + webroot/
    + libraries/ 
```

将您的 apache2`DocumentRoot`指向该`webroot`目录。将您不想从 Web 访问的所有库保存在`libraries`目录中。在您的 php 代码中，使用 include 指令访问库代码。

诀窍是要了解 php 可以包含系统上它具有读取权限的任何文件。浏览您网站的人只能访问您的 webroot 目录中的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T18:21:53.277

如果您在同一台服务器上有多个虚拟主机，通常会将每个站点都`/var/www`放在`htdocs`. 然后，您可以在 Web 根目录上方的文件夹中拥有日志和特定于应用程序的库。例如。：

```
/var/www/lolcats.com
/var/www/lolcats.com/htdocs
/var/www/lolcats.com/htdocs/index.php
/var/www/lolcats.com/lib
/var/www/lolcats.com/log 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T17:48:11.623

PHP 可以访问文件系统中 apache 服务器用户具有正确权限的任何文件。在没有虚拟主机的运行 apache 的 linux 机器上，/var/www 是您的 htdocs 目录的常用位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T17:48:02.747

您将库放在[`include_path`](http://us.php.net/manual/en/ini.core.php#ini.include-path)普通用户无法访问的 PHP 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T21:23:13.823

以与您的域工作相同的方式将您的本地网站映射到目录中是一个很好的主意。

通常您在一个虚拟主机帐户上有多个网站，因此设置虚拟主机以镜像设置。

如果您的共享主机是：

```
/var/www/root
 /var/www/root/website1
 /var/www/root/website2
 /var/www/root/website3 
```

在本地 PC 上创建 3 个虚拟主机，但保持相同的文件结构。

此外，使用配置文件中的条件根据服务器文件结构不同地设置站点，以确保相同的配置文件适用于两种设置。这意味着您可以保持一步构建过程。

# communication - 优先用于开发人员通信的即时消息

> ID：738323
> 
> 赞同：4
> 
> 时间：2009-04-10T17:42:41.903
> 
> 标签：communication, instant-messaging

我的团队经常使用 IM 进行交流。我们有时会使用 IM 来向隔壁房间的人提问。这样做的原因是，我们都发现回复 IM 的干扰比说话要少得多。

尽管如此，我发现当我低头编码时，闪烁的消息窗口可能会中断。我忍不住看看人们写的东西，它经常让我无法完成我的想法。这种类型的多任务处理是生产力杀手。因此，我关闭了警报功能（我正在使用 Pidgin）。我的 Windows 任务栏是隐藏的，所以我需要将光标拖到屏幕底部，让任务栏弹出，然后查看 pidgin 托盘图标是否闪烁橙色以了解新消息。

这很好用，只是有时人们有一个快速的问题要问，他们需要一个快速的答案。

能够发送消息的优先级会很棒：

**优先级3：**有空的时候看看
**优先级2：**正常聊天
**优先级1：**请尽快回复

然后将使用优先级来确定警报方法。例如（1）聚焦窗口，（2）在任务栏中闪烁，（3）在托盘中闪烁。

关于实现这一目标的简单方法的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T17:45:40.100

我认为，一旦您引入“优先消息”功能，所有消息都将开始具有高优先级。人性。我只是将我的状态设置为“忙碌”并且不回复当我“忙碌”时收到的消息，除非它很重要。人们很快就明白了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T18:07:40.127

我们为您的优先级 3 使用电子邮件或内部 Twitter。

我们将 IM 用于优先级 2。

对于优先级 1，我们使用走到某人的办公桌前。

**编辑：**对不起，我没有意识到你在问一个实施问题。如果您不想为联系方式制定新的政策/标准（例如引入内部 twitter 等），您需要将办公室中的每个人都标准化为相同的 IM 应用程序/协议。然后你需要修改一个。试图在 jabber 规范中添加一些东西（如果没有，我不知道）将是乏味的，不值得努力。

如果你真的想走这条路，你可能会更好地转移到 IRC 并使用脚本来提醒你，如果人们在他们的消息之前用英镑来提醒你！或类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:50:15.177

虽然我同意[能够使某些消息具有更高优先级将导致所有消息成为高优先级](https://stackoverflow.com/questions/738323/instant-messaging-with-priority-for-developer-communication/738332#738332)的说法，但您始终可以关闭 IM，然后人们将不得不实际与您交谈。如果他们在您的团队中，他们应该知道您何时低头，并在做出破坏您的决定时承担一些个人责任。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T17:50:45.800

我做的事情与 Codingscape 大致相同——我将我的状态设置为离开。当您的状态发生变化时，许多客户会显示“离开短信”消息，所以我只使用“我很忙”或类似的消息。

# c# - C# 应用程序在调试的情况下运行，但并非没有

> ID：738327
> 
> 赞同：13
> 
> 时间：2009-04-10T17:44:07.593
> 
> 标签：c#, .net, winforms, debugging

我正在运行一个（主要是）单线程程序（有一个主线程可以完成所有工作，其他线程只读取内容）。稍作更改（我更改了表单的文本和另一个表单的 tab 顺序）后，我可以让应用程序在 VS2008 中正常运行，但我无法再让它在调试器之外工作。有谁知道这会导致什么？

**澄清：**发布模式，使用调试器（F5）启动。调试模式，使用调试器 (F5) 启动。调试可执行文件或发布在 VS 外部启动或使用 Ctrl+F5 的可执行文件失败。

它使用微软的Virtual Earth 3D，它似乎在“希望之环”（加载环）即将完成时崩溃。

**事件日志**显示：“.NET 运行时版本 2.0.50727.3053 - 致命执行引擎错误 (000006427F44AA6E) (80131506)”

**罪魁祸首：**这一行：

```
 this.loader = PlugInLoader.CreateLoader(this.globeControl.Host); 
```

导致它失败。但是，正在工作的表单使用完全相同的行没有问题。这条线是程序运行所必需的。我不知道它在做什么。

**另一个导致**错误似乎在 .NET 框架内。应用程序在另一台机器上工作，正在尝试重新安装。**更新：**没有什么不同，虽然当我修复 VS 时它一直告诉我 Visual Studio 崩溃了，即使我没有运行它。

* * *

**错误** 当我在几分钟后启动程序时，我得到：应用程序生成了一个无法处理的异常。

进程 ID=0x9CC (2508)，线程 ID =0xF0C(3852)。

单击确定以终止应用程序。
单击取消以调试应用程序。

* * *

拆解很奇怪：

```
0000000077EF2A90  int         3    
0000000077EF2A91  int         3    
0000000077EF2A92  int         3    
0000000077EF2A93  int         3    
0000000077EF2A94  int         3    
0000000077EF2A95  int         3    
0000000077EF2A96  xchg        ax,ax 
0000000077EF2A9A  xchg        ax,ax 
0000000077EF2A9E  xchg        ax,ax 
0000000077EF2AA0  int         3        <-- Crashes here
0000000077EF2AA1  ret 
```

它多次重复相同的代码块（减去与自身交换的斧头）

* * *

**除了我的电脑，它在我测试过的每台机器上都可以工作，除了我机器上的一个虚拟机，它不会安装 .NET 框架，因为安装程序会下载框架的 0 个字节中的 0 个字节）......可爱视窗。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T18:04:51.630

我遇到过类似的问题，时间冲突导致失败，我的调试（断点和单步执行代码）强制代码以正确的顺序运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T18:24:25.080

尝试从 Release 构建（在项目设置中）进行优化，看看是否有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-11T17:13:12.730

我修复了它，.NET 2.0 框架已损坏，当我重新安装它时，一切都神奇地重新开始工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-10T19:01:01.730

我不能告诉你到底是什么问题，但你可以做些什么来了解到底发生了什么。我假设您使用的是 VS2008 或 2005。

1.  切换到释放模式
2.  转到 Debug\Exceptions，并标记所有“抛出”异常，如下所示：http: [//vvcap.net/db/JbWS_tzy2IpBoI7R7amm.htp](http://vvcap.net/db/JbWS_tzy2IpBoI7R7amm.htp)
3.  在调试器中运行可执行文件，忽略来自 VS 的警告，即没有调试信息

似乎在执行过程中的某个时间抛出了一个 win32 异常，但是这样或那样，你会从调试器中得到一条或多条消息，解释发生了什么样的异常以及发生在哪里。在大多数情况下，这些消息很清楚到底出了什么问题

编辑：我忘了提到的一件事是非托管调试也必须打开，比如[这里（当你直接从 IDE 启动程序时）](http://vvcap.net/db/v8CJ-IruecPraqRdxnbj.htp)或[这里（当你附加到正在运行的进程时）](http://vvcap.net/db/EMs-yVUsDszMmjgLpX_J.htp)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-10T18:03:23.583

[这](http://support.microsoft.com/kb/913384)是包含该错误的支持文章。这适用吗？

也许调试器正在吃掉 VE3D API 抛出的异常。在 VS 中，执行 ctrl+alt+e 并将其更改为在抛出任何异常时中断。这可能是乏味的 b/c，它会在你所有的 try catch 块上中断，但它可能会给你一些信息。

[这](http://blogs.msdn.com/coding4fun/Default.aspx?p=3)是一些信息。关于那个 PlugInLoader。这似乎暗示它必须从 FirstFrameRendered 事件处理程序中调用。也许您的一种形式正在这样做，而另一种没有？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T17:46:56.743

搜索#if(DEBUG) 指令？搜索 Debug.Assert(?

你用谷歌搜索过错误吗？我发现[了这个](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/40e8e7e7-d051-49b7-ba2c-509b210a9736)线程（诚然不是非常有帮助）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-19T12:20:11.723

我们在 MSFT 中发现并解决了这个问题，我们在 VSTO 开发中遇到了这个问题。从 MSFT 应用以下补丁。

[http://support.microsoft.com/kb/975954](http://support.microsoft.com/kb/975954)

[http://support.microsoft.com/kb/974372](http://support.microsoft.com/kb/974372)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-16T16:18:40.840

我曾经遇到过类似的问题，使用插件系统的**行为完全相同。**从 -object 加载插件时`MarshalByRef`（参见下面的示例代码），似乎 .NET 为加载的程序集创建了一个新的 AppDomain 或 Context。（谁能证实这一点？我还没有找到任何有关此的消息来源。）

```
public class ProxyAssemblyLoader : MarshalByRefObject {
    public Assembly GetAssembly(string path) {
        return Assembly.LoadFrom(path);
    }
} 
```

此外，在我的情况下，插件会加载不同版本的`mscorlib`. （我的应用程序是 CLR2，加载的是 CLR4） 之后我通过反射使用插件并尝试访问从其他应用程序域加载的新 mscorlib 的值。通常两者都应该可用，因为 mscorlib 是一个常用的程序集并且只加载一次（请参阅[全局程序集缓存](http://msdn.microsoft.com/en-us/library/yf1d93sz%28v=vs.71%29.aspx)）。但*似乎*情况并非如此。但总的来说，微软[建议避免](http://msdn.microsoft.com/en-us/library/dd153782.aspx#avoid_loading_multiple_versions)这种情况。

我还没有完全弄清楚问题出在哪里，但我发现了导致应用程序崩溃而没有任何提示的调用。**为什么没有任何提示？**它在没有任何提示的情况下崩溃，因为抛出的异常仅在“另一个”应用程序域中可用，而对主/默认应用程序域不可用。

所采取的操作只是将另一个 appdomains 程序集的值隐式复制到`object`默认 appdomain 中的本地无类型值 ( )。由于程序集的不同版本，这足以导致类型标识不匹配错误。似乎 Visual Studio 可以处理它，但如果应用程序独立运行，它会崩溃。

这也可以解释为什么您需要重新安装 .NET。也许您安装的 .NET-Framework 是 beta 或类似的，其中包含细微差别。

总之，该问题的一些一般解决方案可能是：

*   避免将不同版本的程序集与相同类型的不同版本一起使用。
*   在其他情况下，可能会尝试将两个程序集加载到同一个 appdomain 中。（尽可能关于探测上下文。）
*   跨应用程序域通信的解决方案[可能是](http://www.microsoft.com/india/msdn/events/Understanding%20Remoting%20Better.ppt_)值的序列化。
*   （确保安装了正确的 .NET-Framework Non-Beta 版本。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-11T07:21:59.843

我认为剩下的一件事是使用 WinDbg 来尝试调试它。以下是有关如何使用它的一些链接：

1.  [http://www.codeproject.com/KB/debug/windbg_part1.aspx](http://www.codeproject.com/KB/debug/windbg_part1.aspx)
2.  [http://blogs.msdn.com/johan/archive/2007/11/13/getting-started-with-windbg-part-i.aspx](http://blogs.msdn.com/johan/archive/2007/11/13/getting-started-with-windbg-part-i.aspx)
3.  [http://blogs.msdn.com/tess/](http://blogs.msdn.com/tess/)（关于windbg中一般调试的好博客）

考虑一下，它也可能是一些服务或冲突的东西。尝试停止所有不需要的服务并关闭不需要的程序（包括启动程序），然后看看会发生什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-04T21:06:52.763

我的一个控制台应用程序遇到了完全相同的问题。我确定是我的防病毒软件 (Avast) 导致了这个问题。

将文件夹添加`BIN`到排除列表并禁用“DeepScreen”。然后重建项目并重试！

# scrum - Scrum 流程是否最终会剥夺团队成员各自的技能？

> ID：738331
> 
> 赞同：23
> 
> 时间：2009-04-10T17:45:30.430
> 
> 标签：scrum

我的组织一直在尝试引入更多“敏捷”方法。我们已经尝试了一段时间的 Scrum 方法，并且团队中的大多数人或多或少地适应了它。我喜欢它作为一个整体，但我担心该方法的一个潜在的严重影响：由于团队始终专注于功能和积压项目，并且测试人员与整个开发过程更加集成，似乎技能组合正在成为模糊，人们对个人能力的尊重越来越少。

我们的一些开发人员在服务器端技术和重量级数据供应的优化方面表现出色。其他人则投入了大量的职业来学习 GUI 技术，并对用户和应用程序的可用性有了基本的了解。两种技能都不比另一种好，但它们肯定是不同的。

这是 Scrum 过程的必然结果吗？由于团队中的每个人（据我所知）都为满足手头的下一个功能/要求、待办事项或测试目标做出了贡献，因此基本理念似乎是“任何人都可以做到”。根据我的经验，这根本不是真的。大多数工程师（开发人员、测试人员等）都有他们多年来磨练出来的特定技能，而在我看来，Scrum 方法往往会贬低他们以前受到尊重的那些能力。

这是一个澄清的例子：

如果服务器端数据配置发生技术突然变化，并且冲刺的待办事项列表中的每一项都基于这种新变化，那么 GUI 开发人员（他们可能还没有时间适应新技术）可能无法为冲刺做出贡献。至少，他们需要投入时间来提升，然后他们的代码会因为缺乏经验而受到怀疑。

我理解快速发展的必要性以阻止“角色孤岛”，但这并没有贬低一个基本现实：人们根据需要、他们的兴趣或他们的经验发展*技能。*当人们认为他们的位置是一种“插入能力”（例如，我们可以“插入”任何人来完成这项特定任务）时，他们似乎就没有那么积极了。Scrum 如何解决这个问题？如果没有，是否有人在采用 Scrum 方法时解决了这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-12T19:22:40.647

简短的回答是强调“**不**”！Scrum 不会*模糊*或贬低专业化所需的技能。Scrum 不提倡泛化。

长答案是，在 Scrum 中，最重要的是让工作“完成”。团队作为一个团队（而不是单个“明星”的集合）根据需要进行协作，以完成工作。不管需要什么——不管他们想要什么（Scrum 是关于自我管理、自我激励的团队，对吧？）。

这意味着一个 Scrum 团队可能由几位专家组成，他们主要从事他们擅长的工作（DBA、平面设计，甚至技术作家）。作为一个整体，团队应该具备满足要求所需的所有技能。这与说每个团队**成员**都必须具备上述所有技能不同。

话虽这么说，但通常是成员自己通常希望除专家之外的成员至少*具备*与其专长不同的技能。另一张海报已经提到斯科特安布勒的“普通专家”。当某类工作太多、专家缺席时，这对团队有帮助，当成员真正想获得专业以外的经验时，这对团队有帮助。

鉴于团队是自组织的，如果由于某种原因专家发现自己处于 sprint 的中间，在他的专业领域没有任何工作要做，最好的处理方法就是简单地询问专家他想做什么做。让团队决定。专家可以决定在他的其他*适当领域提供帮助，为下一个冲刺做 POC，通过修复一些长期被遗忘的技术债务来“支撑”防御，或者擦亮**正在*工作的成员的鞋子。

是的。我不知道这是不是**很**长的答案。但这绝对是**一个**很长的答案。:-)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-10T18:18:05.967

Scrum 的重点是让开发人员自组织。我们在我所在的地方使用 scrum，并且工作会根据一个人的关注点被动排序。我们不是故意用图表和列表来做的，它只是发生了。我们都知道谁最擅长什么，或者他们的主要/次要重点是什么。如果“主要”人需要帮助，他们就会让具有次要关注点的人/人提供帮助。我们确实有很多任务不一定符合我们特别关注的重点，但你总是知道该向谁寻求帮助。

对于您的示例-我不知道如果您说有 3 个服务器人员和 5 个 gui 人员，您是否希望在该 sprint 中完成所有工作（如果服务器人员 + 其他人的一些帮助不是足够）。sprint 的工作方式应该是，从优先列表中，开发人员选择他们认为在 30 天的时间内可以完成的工作。如果这意味着 GUI 人员需要 2 天的服务器端培训才能提供帮助，那就是它的意思。除非他们可以做的事情也排在首位。冲刺任务不应该由管理层规定为伪截止日期。

如果您有一个 Safari 帐户，那么其中一个发明 scrum 的人会写一本有趣的案例研究书。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T06:30:39.390

我作为 ScrumMaster 工作了大约 18 个月，并与两个不同的团队一起工作。我最初预计会遇到您提出的潜在问题，但事实并非如此。我通常观察到的是，当人们找到适合自己的角色时，团队会演变成专家和通才的混合体——他们可以享受并获得成功。这是工作中的自组织。我从来没有遇到过我们的专家无所事事的情况。

如果确实发生了这种情况，我希望它会在 Sprint Retrospective 中作为一个问题提出，并且团队将讨论如何改善这种情况。最明显（也是最残酷）的结论是改变团队组成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T18:41:23.073

我不确定为什么技能组合会变得模糊。在敏捷世界中存在相当多的混乱。Scrum 是一个项目管理过程，而不是软件开发过程，不应被视为一个过程。工程师必须遵循他们自己的方法，如 TDD 或极限编程，以增加他们自己的敏捷性。

在 scrum 中什么都不会消失。

PM 仍然是文档，架构师仍然在构建他们的组件。唯一的问题是他们只是将一些重大决定推迟到更负责任的时间点。开发人员仍应遵循[SOLID 原则](http://www.codetoglory.com/?p=40)等最佳实践，以便在功能更改时以一致的方式进行重构。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-21T11:23:45.587

[我认为 Scott Ambler 在http://www.agilemodeling.com/essays/generalizingSpecialists.htm](http://www.agilemodeling.com/essays/generalizingSpecialists.htm)中非常彻底地解决了这个问题......

他的泛化专家概念正是集体所有权/Scrum 团队所要求的，对我来说完全有意义。

但在现实生活中很难实现；-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T18:18:52.753

如果您出于任何原因（“技术的突然变化”与否）发现系统在 sprint 中所需的工作量大于可用的工作量，那么您的调度就有问题。

一种解决方法是，正如您所建议的，您将其他领域的程序员加入其中。这工作的好坏取决于那个人的技能以及问题域的不同程度，但是将程序员视为可以根据需要外包出去的通用单元通常不是开发软件的成功策略。

但这仍然是一个调度问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-21T06:24:57.647

Scrum 最好的地方就是技能确实有点模糊！关键是通过在团队中传播专业知识并让人们在他们的舒适区之外工作，不惜一切代价避免孤岛。

显然，这并不适合所有人。一些开发人员在他们自己狭窄的专业领域中很开心，这些人在 Scrum 过程中更多的是障碍而不是资产，而决心完成工作的全面和多才多艺的人通常非常适应它而且效率更高。

Scrum 的主要好处之一是让整个团队真正参与并投入到项目中，而不是解决他们自己的特殊任务，然后骑马奔向地平线。我声称对于大多数人来说，这是一种比传送带式瀑布流程更有价值的工作方式。

所以我建议大胆地接受技能的混合，让人们团结起来解决棘手的问题，而不是依赖专家的孤岛。由积极进取的人组成的团队的结果可能令人惊讶。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T18:03:03.350

听起来这将导致更全面的开发人员，并允许那些在某些领域的专家继续贡献他们的专业知识。

我自己（还）没有太多使用 Scrum，但是根据你的描述，这些类型的团队会导致一个整体上更加全面的团队/组织——这不应该是任何团队的目标?

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T23:45:12.247

处理突然的变化是敏捷的一部分，这可能意味着有些人必须离开并学习新技能。当然，这更多地属于一般的敏捷哲学，而不是任何特定于 Scrum 的东西。可能存在一些极端情况，客户或企业决定通过引入新事物来改变世界，因此必须处理这些人的后续痛苦，但如果这是他们想要的并且开发人员被否决，那么就有只有几个选择：（坚持到底并尝试处理重大变化）或（退出并离开那里）。

虽然在某些情况下，专门从事某事的人可能能够更快地完成工作，但这并不一定意味着团队中只有一个专家是专家并且在该领域有足够的工作整个冲刺10人。那些不是专家的人是否应该根本不做这项工作，让那个人尽可能多地尝试通过？我不这么认为，但对于那些在某事上仍不擅长但仍在努力完成他们可以完成的事情的人来说，应该有话要说。

# database - 推荐的全球化参考

> ID：738336
> 
> 赞同：4
> 
> 时间：2009-04-10T17:47:55.603
> 
> 标签：database, validation, schema, globalization, street-address

我正在开发一个全球化的网络应用程序。开发过程是敏捷的，已经完成了几个冲刺。我们的全球化框架是好的，本地化的努力到目前为止是成功的。但是，我们在需求开发过程中继续遇到问题，特别是在数据存储和验证需求方面。我敢肯定，我们正在努力解决的问题已经被研究和解决了很多次，而且答案很可能是众所周知的，并且记录在某处。到目前为止，我一直无法找到我正在寻找的信息纲要。

以下是一些我想找到答案的示例问题：

1.  为全球应用程序输入、验证、存储和显示地址信息的最佳实践是什么？
    *   地址字段要存储的字符数（您知道有一个包含 163 个字符的城市名称吗？）
    *   地址数据的验证
2.  为全球应用程序输入、验证、存储和显示电话号码的最佳实践是什么？
3.  一个人的名字也有同样的问题？

到目前为止，我们解决这些问题的方法是为各种字段提供充足的存储空间，并执行最少的输入验证，依靠用户来正确处理。这种方法在项目的这个阶段运行良好，但各种项目利益相关者对长期使用这种方法并不满意。对所有语言环境的干净数据、高效存储和有吸引力的数据呈现方式有着强烈的需求。

对于对这些和相关主题有相当完整处理的书籍、论文或网站有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T01:15:39.950

[这里](http://www.i18nguy.com/guidelines.html)有很多很好的信息。

# .net - 如何使用 linq 在有序表的子集中获取下一项？

> ID：738340
> 
> 赞同：0
> 
> 时间：2009-04-10T17:48:47.333
> 
> 标签：.net, sql, linq, linq-to-sql

我有两张桌子：

```
Topic (
  TopicID: int, (primary key)
  TopicName: varchar
);

Example (
  ExampleID: int, (primary key)
  TopicID: int, (foreign key to Topic table)
  ExampleOrder: int,
  ExampleName: varchar
); 
```

使用 Linq，给定一个 ExampleID，我想在同一主题中获取下一个示例（具有相同的 TopicID）。以下是它在 sql 中的实现方式：

```
DECLARE @ExampleOrder int;
DECLARE @TopicID int;
SELECT @ExampleOrder=ExampleOrder, @TopicID=TopicID FROM Example WHERE ExampleID=@ExampleID;
SELECT TOP 1 ExampleID FROM Example WHERE TopicID=@TopicID AND ExampleOrder>@ExampleOrder ORDER BY ExampleOrder 
```

在 Linq 中是否有一种简单的方法可以做到这一点？我知道我可以用两个 Linq 查询来做到这一点，但我试图在没有额外往返数据库的情况下完成它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T18:13:17.757

```
int exampleID = 5;
  //now to write a query
var query =
  from ex in db.Examples
  let prior = db.Examples.Where(ex2 => ex2.ExampleID == exampleID).First()
  where ex.TopicID == prior.TopicID
     && ex.ExampleOrder > prior.ExampleOrder
  order ex by ex.ExampleOrder descending
  select ex
    //ok, let's run the query - result will have 0 or 1 item in it.
List<Example> result = query.Take(1).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T16:36:08.090

```
public Example GetNextExample(IEnumerable<Example> examples, Int32 exampleID)
{
   Example example = examples.Single(e => e.ExampleId == exampleID);

   return examples.
      Where(e => e.TopicID == 
         examples.Single(e => e.ExampleId == exampleID).TopicID).
      OrderBy(e => e.ExampleOrder).
      FirstOrDefault(e => e.ExampleOrder > 
         examples.Single(e => e.ExampleId == exampleID).ExampleOrder);
} 
```

# java - 小服务程序 + JAX-WS

> ID：738341
> 
> 赞同：5
> 
> 时间：2009-04-10T17:48:52.887
> 
> 标签：java, servlets, jax-ws

我正在尝试通过 JAX-WS 注释公开 Web 服务方法。我见过的许多示例都引用了 EndPoint.publish() 方法来在独立应用程序中快速建立服务（例如来自 Java Web Services：Up and Running, 1st Edition）：

```
public class TimeServerPublisher {
public static void main(String[ ] args) {
  // 1st argument is the publication URL
  // 2nd argument is an SIB instance
  Endpoint.publish("http://127.0.0.1:9876/ts", new TimeServerImpl());
} 
```

}

我缺少的一件事是如何在现有应用程序中完成基本相同的事情。我会做一个servlet来处理这个吗？在现有 WAR 文件中发布此服务的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T18:18:05.140

在容器中，您不必像这样发布。容器将进行发布。如果您打算在 JBoss 服务器中使用它，请尝试 JBossWS，否则对于 Tomcat 或任何其他服务器 Axis2 可能是更好的选择。

从以下链接了解更多信息。

[http://jbossws.jboss.org/mediawiki/index.php?title=JBossWS](http://jbossws.jboss.org/mediawiki/index.php?title=JBossWS)

[http://ws.apache.org/axis2/](http://ws.apache.org/axis2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T18:35:02.900

这取决于您使用的 WS 堆栈。

如果您使用的是包含[JAX-WS 参考实现](http://jax-ws.dev.java.net)的 Java 6 ，那么您可以查阅[有关 JAX-WS RI WAR 内容的文档](https://jax-ws.dev.java.net/nonav/2.1.5/docs/jaxws-war.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-12T23:34:00.510

正如@Jerrish 和@andri 评论的那样，有不同的方法和解决方案，具体取决于您的关注点。

背后的想法是您不需要设置配置（端口等）何时发布您的 Web 服务。最好的方法是通过配置文件（XML、属性等）或使用@Annotations 来设置它。

例如，如果您习惯使用 Guice 或 Spring 之类的框架，您就会知道/建议启动应用程序的上下文发布或初始化一些对象、工厂、数据源等，而发布 Web 服务是另一项任务在这段时间内完成，因为当您启动应用程序时将可用，不是吗？

顺便说一句，我在 CXF 方面有很好的经验，另一个解决方案可能是[Spring Web Services](http://static.springsource.org/spring-ws/sites/2.0/ "春季网络服务")，另一个强大的创建 Web 服务的解决方案。

# c# - 为什么必须链接引用程序集？

> ID：738349
> 
> 赞同：3
> 
> 时间：2009-04-10T17:51:46.343
> 
> 标签：c#, visual-studio-2008, .net-assembly

我的项目引用了一个引用另一个程序集（称为 Y）的程序集（称为 X）。

当我尝试编译我的项目时，它要求它应该引用程序集 Y。这是为什么呢？我在引用程序集 X 的行上收到以下错误：

> “DevExpress.XtraEditors.XtraForm”类型在未引用的程序集中定义。您必须添加对程序集“DevExpress.Utils.v9.1, Version=9.1.2.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a”的引用。

`DevExpress.XtraEditors.XtraForm`是装配 Y。

为什么是这样？我以前没有见过这种行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T17:54:48.380

这一直存在。如果您使用从程序集 Y 获取方法/属性/成员等的对象，您只会在编译时获得这些。

原因是.NET 不能依赖程序集 X 来确保它能够获得正确的符号和元数据信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T17:53:25.573

这一直是行为，如果编译器没有对所有依赖项的引用，编译器将如何构建您的项目？

项目引用的程序集是应用程序工作所必需的。您正在使用这些程序集中的类型，如果没有这些类型，您的应用程序将无法构建。更重要的是，如果没有这些类型，您的应用程序将无法运行。

现在考虑您引用的每个程序集都以与您的程序集相同的方式构建，并且要求其所有*引用的*程序集都存在并说明。这确实会产生可能令人讨厌的连锁反应，但最终结果是，一旦您执行应用程序，CLR 就会拥有运行应用程序所需的所有程序集。

# asp.net-mvc - 我需要为 ASP.NET mvc 部署哪些文件？

> ID：738364
> 
> 赞同：21
> 
> 时间：2009-04-10T17:56:25.427
> 
> 标签：asp.net-mvc, deployment

我知道我可以将我的所有文件从我的开发环境复制到我的实时网站目录中，但是我知道我正在复制几个不必要的文件（例如 .sln 文件和 .csproj 文件）。

要运行 ASP.NET MVC Web 应用程序，实际上必须复制哪些文件？（例如，我需要复制所有 .CS 文件吗？）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-10T18:00:25.107

如果您在 Microsoft Visual Studio 中开发，您可以使用 Build > Publish 选项（当您处于 ASP.NET MVC 项目的上下文中时）并直接发布它。

如果您不能使用它并且必须进行复制，那么您只需要任何不是 .cs 文件（视图、.config 文件等）和您编译的 ASP.NET MVC 站点的 .dll（例如 MvcApplication1.dll）。如果您想了解需要什么，请使用 Build > Publish 工具到本地目录并查看其中的内容。

您不需要解决方案或项目文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T22:29:59.387

使用构建/发布方法是确保您拥有所需文件的最佳方式。但是，在构建之前，如果您的服务器上没有安装 ASP.NET 3.5 SP1，请确保您进入项目中对以下程序集的引用，并在它们各自的属性页中将其设置为“复制本地”。

System.Web.MVC System.Web.Routing System.Web.Abstractions

这将确保将这些程序集中的每一个都复制到已发布站点上的“bin”文件夹中。

布赖恩

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T18:14:59.190

编译项目后，不应复制所有 .cs 文件。

看看这个[链接](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T21:30:43.400

基本上除了视图之外的所有东西都被编译成一个dll。您可以使用 deploy 选项来查看需要部署的内容；）。

# wcf - 使用 BasicHttpSecurityMode.Transport 自定义 X509CertificateValidator？

> ID：738365
> 
> 赞同：1
> 
> 时间：2009-04-10T17:56:49.047
> 
> 标签：wcf, wcf-security

是否有一种简单的方法可以将自定义 X509 证书验证与 BasicHttpBinding（或 CustomHttpBinding 用于同一问题，这将实现仅传输安全性）联系起来？

**EDIT1：**我在代码中添加了一个 ServerCertificateValidationCallback 以显示它也不会启动

这是我正在尝试做的事情：

1）编写自定义 X509CertificateValidator：

```
public class MyX509Validator : X509CertificateValidator
{
    public override void Validate(X509Certificate2 certificate)
    {
        Console.WriteLine("Incoming validation: subj={0}, thumb={1}",
                certificate.Subject, certificate.Thumbprint);
    }
} 
```

2）创建主机：

```
var soapBinding = new BasicHttpBinding() { Namespace = "http://test.com" };
soapBinding.Security.Mode = BasicHttpSecurityMode.Transport;
soapBinding.Security.Transport.ClientCredentialType =
            HttpClientCredentialType.Certificate;

var sh = new ServiceHost(typeof(Service1), uri);
sh.AddServiceEndpoint(typeof(IService1), soapBinding, "");
sh.Credentials.ServiceCertificate.SetCertificate(StoreLocation.LocalMachine,
           StoreName.My, X509FindType.FindBySubjectName, "localhost");
sh.Credentials.ClientCertificate.Authentication.CertificateValidationMode =
           System.ServiceModel.Security.X509CertificateValidationMode.Custom;
sh.Credentials.ClientCertificate.Authentication.CustomCertificateValidator = 
           new MyX509Validator();
System.Net.ServicePointManager.ServerCertificateValidationCallback += 
           delegate(object sender, X509Certificate certificate, 
                    X509Chain chain, SslPolicyErrors sslPolicyErrors)
           {
                Console.WriteLine("Incoming validation: subj={0}, thumb={1}",
                    certificate.Subject, certificate.GetIssuerName());
                return true;
           };
sh.Open(); 
```

3）创建WCF客户端：

```
var binding = new BasicHttpBinding();
binding.Security.Mode = BasicHttpSecurityMode.Transport;
binding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
var cli = new ServiceReference2.Service1Client(binding, 
           new EndpointAddress("https://localhost:801/Service1"));
cli.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.LocalMachine, 
           StoreName.My, X509FindType.FindBySubjectName, "localhost");
cli.HelloWorld(); 
```

身份验证工作正常，但`MyX509Validator.Validate()`永远不会被调用。我怀疑`X509CertificateValidator`这只适用于消息安全，而不适用于传输。那正确吗？我可以做些什么来覆盖传输级证书验证吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T06:46:46.977

我假设您正在谈论与 HTTPS 相关的证书...

如果是这样，答案如下： X509CertificateValidationMode 用于您正在交换以提供身份验证的文档的标题中。它对底层传输本身没有任何作用，在本例中是 HTTPS 及其关联的 x.509 证书。所以，你的假设是正确的。

如果要提供传输的自定义证书验证，请`System.Net.ServicePointManager.ServerCertificateValidationCallback`改用。不过要小心，这是一个应用程序范围的设置。如果您在多个端点之间循环并且不将其设置为 null，它将保持活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T14:35:10.830

我正在使用以下设置执行此操作，并且我的自定义验证器肯定会受到影响：

```
serviceHost.Credentials.ClientCertificate.Authentication.CertificateValidationMode =
    X509CertificateValidationMode.Custom;

serviceHost.Credentials.ClientCertificate.Authentication.CustomCertificateValidator =
    new CertificateValidator(ConfigurationManager.AppSettings["Cerficate"]); 
```

我的行为是：

```
 <behavior name="CustomCertificateBehavior">
      <serviceCredentials>
        <clientCertificate>
          <authentication certificateValidationMode="Custom" />
        </clientCertificate>
      </serviceCredentials>
    </behavior>
  </serviceBehaviors> 
```

我的绑定：

```
 <basicHttpBinding>
    <binding name="SecureBinding" maxReceivedMessageSize="5242880">
      <security mode="Transport">
        <transport clientCredentialType="Certificate"></transport>
      </security>
    </binding>
  </basicHttpBinding> 
```

# svn - 为什么我在 Subversion 中遇到树冲突？

> ID：738367
> 
> 赞同：359
> 
> 时间：2009-04-10T17:57:06.347
> 
> 标签：svn, merge, tree-conflict

我的主干有一个功能分支，并且定期将主干中的更改合并到我的分支中，一切正常。今天我将分支合并回主干，在创建分支后添加到我的主干的任何文件都被标记为“树冲突”。将来有没有办法避免这种情况？

我认为这些都没有被正确标记。

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2010-09-16T16:31:53.340

我找到了阅读 Gary 给出的链接的解决方案（我建议按照这种方式进行操作）。

总结以解决使用 SVN 客户端 1.6.x**提交工作目录**的树冲突，您可以使用：

```
svn resolve --accept working -R . 
```

`.`冲突的目录在哪里。

**警告**：*“提交您的工作目录”意味着您的沙箱结构将是您提交的那个，因此，例如，如果您从沙箱中删除了一些文件，它们也会从存储库中删除。这仅适用于冲突目录。*

通过这种方式，我们建议 SVN 解决冲突（`--resolve`），接受沙箱中的工作副本（`--accept working`），递归地（`-R`），从当前目录（`.`）开始。

在 TortoiseSVN 中，右键单击选择“已解决”，实际上解决了这个问题。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-04-10T18:08:51.327

Subversion 1.6 添加了树冲突来覆盖目录级别的冲突。一个很好的例子是，当您在本地删除文件时，更新会尝试对该文件进行文本更改。另一个是当您对正在编辑的文件进行颠覆重命名时，因为这是一个添加/删除操作。

CollabNet 的 Subversion 博客有一篇关于[树冲突](http://blogs.collab.net/subversion/2009/03/subversion-160-and-tree-conflicts/)的精彩文章。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2010-08-05T16:58:10.903

以我的经验，当我删除文件夹时，SVN 会产生树冲突。似乎没有任何理由。

我是唯一一个处理我的代码的人 -> 删除目录 -> 提交 -> 冲突！

我迫不及待地想切换到[Git](http://en.wikipedia.org/wiki/Git_%28software%29)。

我应该澄清一下 - 我使用[Subclipse](http://marketplace.eclipse.org/content/subclipse)。这大概就是问题所在！再一次，我迫不及待地想换...

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2010-04-14T17:38:48.830

我不知道这是否发生在你身上，但有时我选择了错误的目录来合并，即使所有文件看起来都很好，我也会收到这个错误。

例子：

合并 /svn/Project/branches/some-branch/Sources 到 /svn/Project/trunk ---> 树冲突

合并 /svn/Project/branches/some-branch 到 /svn/Project/trunk ---> OK

这可能是一个愚蠢的错误，但它并不总是很明显，因为你认为它更复杂。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-01-16T13:36:33.980

这里发生的情况如下：您在主干上创建一个新文件，然后将其合并到您的分支中。在合并提交中，该文件也将在您的分支中创建。

当您将分支合并回主干时，SVN 会再次尝试做同样的事情：它看到在您的分支中创建了一个文件，并尝试在合并提交中在您的主干中创建它，但它已经存在！这会产生树冲突。

避免这种情况的方法是进行特殊的合并，**重新集成**。您可以通过`--reintegrate`开关实现此目的。

您可以在文档中阅读此内容：http: [//svnbook.red-bean.com/en/1.7/svn.branchmerge.basicmerging.html#svn.branchemerge.basicmerging.reintegrate](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.basicmerging.html#svn.branchemerge.basicmerging.reintegrate)

> 然而，当将你的分支合并回主干时，基础数学是完全不同的。您的功能分支现在是重复的主干更改和私有分支更改的混合体，因此没有简单的连续修订范围可供复制。通过指定 --reintegrate 选项，您要求 Subversion 只仔细复制那些对您的分支唯一的更改。（事实上​​，它通过比较最新的主干树和最新的分支树来做到这一点：由此产生的差异正是您的分支更改！）

重新集成分支后，强烈建议将其删除，否则无论何时在另一个方向合并时都会不断发生树冲突：从主干到分支。（出于与前面描述的完全相同的原因。）

也有办法解决这个问题，但我从未尝试过。你可以在这篇文章中阅读它：*[Subversion branch reintegration in v1.6](https://stackoverflow.com/questions/3309602/subversion-branch-reintegration-in-v1-6)*

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-04-02T10:58:36.670

这可能是由于没有完全使用相同版本的客户端造成的。

对同一存储库使用 1.5 版客户端和 1.6 版客户端可能会产生此类问题。（我自己也被咬了。）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-05-22T04:21:57.083

直到今天，至少从 3 个月前开始，我在尝试将分支合并回树干时经常遇到数百个树冲突（使用**TortoiseSVN 1.11**）。顺便说一句，无论是否重新定位。从 2004 年的 v1 开始，我一直在使用 TortoiseSVN，而且我一直在重新集成分支。我想最近一定发生了什么事吧？

所以今天我做了这个简单的实验，我发现是什么造成了这些疯狂的冲突：

1.  我从树干上分叉了@393；
2.  我随机修改了数十个文件，以及创建了新文件；
3.  我答应了。现在@395（一位同事在 394 分叉去做他自己的事情）。
4.  然后我尝试将分支重新集成回主干，仅测试；遵循 TortoiseSVN 在向导中的建议：“要合并所有修订（重新集成），请将该框留空”。为此，我右键单击主干文件夹，然后选择“TortoiseSVN > Merge, from /path/to/branch”，然后按照对话框中的建议**将转速范围留空。**

**讨论：（**见附件）

*所有的修订*......什么？*我几乎不知道*客户端一定是指“**目标的所有修订版！**（主干）”，因为在重新集成该分支的过程中，我看到了“合并修订版 1-HEAD”！我的天啊。可怜的恶魔，你在这里摔死了。那个分支诞生于@393，看在上帝的份上，你看不到它的出生证明吗？[![这就是为什么会发生这么多冲突的原因：SVN-cli 从修订版 1 开始疯狂疯狂](https://i.stack.imgur.com/CuJQu.png)](https://i.stack.imgur.com/CuJQu.png)

**解析度：**

1.  与向导的建议相反，请指定一个范围，涵盖...分支生命的所有修订！因此，**394-HEAD**；
2.  现在再次运行该合并测试，并获得一支雪茄。( [![见第二个附件](https://i.stack.imgur.com/3JDpQ.png)](https://i.stack.imgur.com/3JDpQ.png))。

**道德：** 我无法理解为什么他们仍然没有修复那个错误，因为它是一个，我很抱歉。我应该花时间向他们报告这件事。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-08-20T06:55:07.303

如果您遇到没有意义的树冲突，因为您没有编辑/删除/来到文件附近的任何地方，那么合并命令中也很有可能出现错误。

可能发生的情况是，您之前已经合并了您当前合并中包含的一堆更改。例如，在主干中，有人编辑了一个文件，然后重命名了它。如果在第一次合并中包含编辑，然后在第二次合并中包含编辑和重命名（本质上是删除），它也会给你一个树冲突。这样做的原因是先前合并的编辑会显示为您自己的，因此不会自动执行删除。

这至少可以在 1.4 存储库中发生，我不确定 1.5 中引入的合并跟踪是否有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-03T16:02:26.667

我今天也遇到了这个问题，尽管我的特定问题可能与您的问题无关。检查文件列表后，我意识到我做了什么——我暂时在一个程序集中使用另一个程序集中的文件。我对其进行了很多更改，并且不想孤立 SVN 历史记录，因此在我的分支中，我将文件从另一个程序集的文件夹中移了过来。这不是 SVN 跟踪的，所以看起来文件被删除然后重新添加。这最终导致了树冲突。

我通过将文件移回，提交，*然后*合并我的分支来解决问题。然后我把文件移回来了。:) 这似乎奏效了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-20T15:38:13.453

我有一个类似的问题。唯一对我有用的是删除冲突的子目录：

```
svn delete --force ./SUB_DIR_NAME 
```

然后再次从包含它们的工作副本中的另一个根目录中复制它们：

```
svn copy ROOT_DIR_NAME/SUB_DIR_NAME 
```

然后做

```
svn cleanup 
```

和

```
svn add * 
```

您可能会收到最后一个警告，但请忽略它们，最后

```
svn ci . 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-04T20:14:30.120

[我遇到了同样的问题，并通过使用这些说明](https://stackoverflow.com/a/1008805/88198)重新进行合并来解决它。基本上，它使用 SVN 的“2-URL 合并”来更新`trunk`您分支的当前状态，而无需过多关注历史记录和树冲突。使我免于手动修复 114 个树冲突。

我不确定它是否像人们想要的那样保留了历史，但就我而言，这是值得的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-01T12:42:58.650

我有时会遇到的一个场景：

假设您有一个主干，您从中创建了一个发布分支。在对主干进行一些更改（特别是创建“some-dir”目录）之后，您创建了一个功能/修复分支，您稍后也希望将其合并到发布分支中（因为更改足够小并且功能/修复对于发布很重要） .

```
trunk -- ... -- create "some-dir" -- ...
     \                                  \-feature/fix branch
      \- release branch 
```

如果您随后尝试将功能/修复分支直接合并到发布分支中，您将遇到树冲突（即使功能/修复分支中甚至不存在该目录）：

```
svn status
!     C some-dir
      >   local missing or deleted or moved away, incoming file edit upon merge 
```

因此，您需要在创建功能/修复分支之前明确合并在主干上完成的提交，该分支在合并功能/修复分支之前创建了“some-dir”目录。

我经常忘记这一点，因为这在 git 中是不必要的。

# statistics - 有视力障碍者的浏览器使用统计数据吗？

> ID：738372
> 
> 赞同：6
> 
> 时间：2009-04-10T17:58:49.837
> 
> 标签：statistics

我为 IE 6 高对比度模式和增加的字体大小做了很多优化网站的工作，目的是改善视障人士的体验。但是，在我看来，由于高级浏览器提供了改进的缩放功能，任何视力受损的人都会在升级时更加警惕。是否有**专门针对视障用户的浏览器统计信息？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T18:36:11.837

并非*专门*针对视障用户，但[WebAIM 屏幕阅读器用户偏好调查](http://www.webaim.org/projects/screenreadersurvey/)是基于**主要**视障用户的数据。

请参阅关于残疾报告的图表。它指出，80% 的受访者是盲人，另有 16% 有低视力/视力障碍。

# c# - Paint() 方法与 Win 表单中的 _Paint() 事件的目的是什么？

> ID：738373
> 
> 赞同：0
> 
> 时间：2009-04-10T17:58:51.397
> 
> 标签：c#, .net, winforms, performance

我正在使用由以前的、现在无法访问的开发人员设计的 WinForm 应用程序。在这个应用程序中，农场通过一些自定义代码嵌入到 TabControls 中。我的问题是，任何人都可以帮助尝试解释为什么每个表单中都有一个自定义 _Paint() 函数，该函数是从该表单的 Load 事件调用的。

这个 Paint() 方法实际上并没有绑定到前面提到的菊花链之外的表单。这能起到什么作用？在下面的代码中，您会注意到我创建了一个 Paint() 事件并将部分代码移到那里，一切看起来仍然“桃色”。

谁能帮我理解这一点？仅仅是因为自定义的公共声明吗？

```
 private void frmWWCModuleHost_Load(object sender, EventArgs e)
    {
        FormPaint();
    }

    public void FormPaint()
    {
        WinFormCustomHandling.ShowFormInContainerControl(tpgCaseNotes, new FrmCaseNotes());
        WinFormCustomHandling.ShowFormInContainerControl(tpgMCP, _frmWWCMCPHost);
        WinFormCustomHandling.ShowFormInContainerControl(tpgMember, _frmWWCMemberHost);
        WinFormCustomHandling.ShowFormInContainerControl(tpgEnrollment, _frmWWCEnrollmentHost);
        WinFormCustomHandling.ShowFormInContainerControl(tpgWWCSearch,_frmWWCSearch);
        WinFormCustomHandling.ShowFormInContainerControl(tpgAudit, FrmAudit);

        // Call each top-Level (visible) tabpage's form FormPaint()
        _frmWWCMCPHost.FormPaint();
    }

    private void FrmModuleHost_Paint(object sender, PaintEventArgs e)
    {
        new psTabRenderer(tclWWCModuleHost, Color.LightSteelBlue, Color.Tomato, Color.Black, Color.Black);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T18:11:54.017

我不确定您是否发布了足够的代码以使其易于理解。但总的来说，如果您觉得代码不自然，请继续重构它……一次一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T18:13:52.093

当然，代码看起来很奇怪，但我认为您对“FormPaint”方法的名称的阅读比您应该阅读的要多。对我来说，它似乎只是一个“初始化”例程，与 Paint 事件（名称除外）基本上没有任何关系。

此外，FormPaint 中的任何代码似乎每个表单都被调用一次，而 Paint 事件处理程序中的任何代码都被调用......很多。

# sql-server - SQL Server 订阅初始化无休止地重新启动，永远不会完成

> ID：738385
> 
> 赞同：1
> 
> 时间：2009-04-10T18:05:59.147
> 
> 标签：sql-server, sql-server-2005, replication

我正在尝试通过第三个作为分销商在 2 个 SQL Server 2005 实例上设置事务拉取复制。初始化订阅时，它会正确批量插入，并显示快照已成功加载的消息。然后它像往常一样制作主键索引。

此时作业重新开始，删除所有表并再次批量插入。它无休止地循环并且永远不会结束，直到快照过期并且必须制作一个新的。我需要帮助诊断这个问题，因为我检查了我知道的所有错误日志，但没有看到任何可能相关的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T21:04:10.503

检查发布中是否有任何主键损坏的表。我已经看到导致 SQL Server 事务复制以奇怪的方式运行的实例。

# java - 如何使用 URLClassLoader 加载 *.class 文件？

> ID：738393
> 
> 赞同：33
> 
> 时间：2009-04-10T18:10:32.867
> 
> 标签：java, reflection

我正在玩反射，我想我会做一些东西来加载一个类并打印类中所有字段的名称。我制作了一个小型的 hello world 类来检查一些东西：

```
kent@rat:~/eclipsews/SmallExample/bin$ ls
IndependentClass.class
kent@rat:~/eclipsews/SmallExample/bin$ java IndependentClass 
Hello! Goodbye!
kent@rat:~/eclipsews/SmallExample/bin$ pwd
/home/kent/eclipsews/SmallExample/bin
kent@rat:~/eclipsews/SmallExample/bin$ 
```

基于以上，我得出两个结论：

*   它存在于 /home/kent/eclipsews/SmallExample/bin/IndependentClass.class
*   有用！（所以它必须是一个可以被类加载器加载的正确的 .class 文件）

然后是使用反射的代码：（标记导致异常的行）

```
import java.lang.reflect.Field;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;

public class InspectClass {
    @SuppressWarnings("unchecked")
    public static void main(String[] args) throws ClassNotFoundException, MalformedURLException {
        URL classUrl;
        classUrl = new URL("file:///home/kent/eclipsews/SmallExample/bin/IndependentClass.class");
        URL[] classUrls = { classUrl };
        URLClassLoader ucl = new URLClassLoader(classUrls);
        Class c = ucl.loadClass("IndependentClass"); // LINE 14
        for(Field f: c.getDeclaredFields()) {
            System.out.println("Field name" + f.getName());
        }
    }
} 
```

但是当我运行它时，我得到：

```
Exception in thread "main" java.lang.ClassNotFoundException: IndependentClass
    at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:251)
    at InspectClass.main(InspectClass.java:14) 
```

我的问题：

1.  我在上面做错了什么？我如何解决它？
2.  有没有办法加载几个类文件并迭代它们？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-10T18:19:45.370

来自[构造函数的](http://docs.oracle.com/javase/6/docs/api/java/net/URLClassLoader.html#URLClassLoader%28java.net.URL%5B%5D%29)[Javadocs`URLClassLoader(URL[])`](http://docs.oracle.com/javase/6/docs/api/java/net/URLClassLoader.html#URLClassLoader%28java.net.URL%5B%5D%29)：

> 使用默认委托父 ClassLoader 为指定的 URL 构造一个新的 URLClassLoader。在第一次在父类加载器中搜索之后，将按照为类和资源指定的顺序搜索 URL。**假设任何以“/”结尾的 URL 都指向一个目录。否则，假定 URL 指向将根据需要下载和打开的 JAR 文件。**

所以你有两个选择：

1.  参考.class文件所在的目录
2.  将 .class 文件放入 JAR 并参考

在这种情况下，(1) 更容易，但如果您使用网络资源，则 (2) 会很方便。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-10T18:17:08.513

您必须向 URLClassLoader 提供包含 .class 文件的目录或 jar 文件：

```
classUrl = new URL("file:///home/kent/eclipsews/SmallExample/bin/"); 
```

是的，您可以加载任意数量的类

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-08T03:43:52.273

您必须通过提供完全限定的类名来加载该类，该类名是类名，其包路径为，

```
Class c = ucl.loadClass("com.mypackage.IndependentClass"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-19T10:27:23.837

我遇到了类似的问题，但我的类文件位于名为“customElements”的包中。在这种情况下，URL 需要构建到根包上方的文件夹，并且在 load 方法中应该传递包含包的类的完整名称。例如，就我而言；网址就像：

```
File customElementsDir = new File("D:/My Space");
//File customElementsDir = new File("D:\\customElements");
URL[] urls = null;
try {
    URL url = customElementsDir.toURI().toURL();
    urls = new URL[] { url };
} catch (MalformedURLException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

实际加载是这样的：

```
clazz = childFirstClassLoader
            .loadClass("customElements.CustomLoadableClass"); 
```

childFirstClassLoader 是我的类加载器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-12T07:17:52.777

我有同样的问题，但我发现这是一个解决方案：

```
System.getProperty("java.class.path") 
```

这为您提供了 jar 和类路径。从这里您可以管理您的流程。

# php - 有条件地触发触发器（MySQL / PHP）

> ID：738394
> 
> 赞同：0
> 
> 时间：2009-04-10T18:10:52.240
> 
> 标签：php, mysql, triggers

我希望触发器仅在用户启动更新时触发（不是我从 MySQL 命令行运行更新）。

实现这一目标的“行业标准”是什么？我一直在尝试检测通过查询传入的变量（即@user_update=true），但没有成功。我的一位同事建议一种方法是在包含触发器的表中添加一个新列：例如，'fire_trigger'。并在从代码运行 SQL 时将其填充为“true”，并确保它存在以便触发触发器。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T18:22:08.203

在进行命令行更新之前禁用触发器并在之后重新启用它。

但是从概念上讲，您这样做是错误的。

为什么使用命令行时触发器不应该运行？我假设这是某种审计触发器，它捕获谁更新了一行。你在命令行也是一个“谁”。

来自OP的评论：

> 是的 - 好点！:) 这是一个“dd/mm/yyyy hh:mm - 用户 A 将名字从“Jane”更改为“Joan””类型的东西。当我可能“手动”更新行时，我只是不希望它在测试阶段填充历史记录表。

然后要么禁用触发器，要么在之后删除添加的历史记录行。更好的是，在单独的数据库上进行测试，根本不用担心这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T21:35:13.170

创建 2 个 mysql 用户：一个由应用程序使用（因此它将识别您的用户），另一个在通过 mysql 客户端连接时使用。

在更新触发器中，使用 CURRENT_USER() 检查用户并仅在它是应用程序用户时采取行动。

希望能帮助到你！

# database - 使代码和数据库引用表中的命名常量保持同步的最佳实践？

> ID：738401
> 
> 赞同：4
> 
> 时间：2009-04-10T18:13:34.700
> 
> 标签：database

使用命名常量代替幻数通常是最佳实践，但保持数据库引用表和命名常量文件同步确实很乏味且容易出错。是否有一些简单的方法可以使这两个信息源保持同步，或者我是否忽略了明显的设计增强？

如果我的问题不清楚，这里有一个例子。我有一个包含 2 列的参考表：

```
UserStatus
----------
UserStatusID
UserStatus 
```

因此，此表将 UsersStatusID 1 与 UserStatus 'Active' 相关联。User 表依赖于该表来规范化 UserStatuses。

因此，当从代码中查询用户的状态时，我有两个选择：

```
SELECT UserStatusID FROM Users WHERE UserStatus = 1 
```

或者

```
SELECT UserStatusID FROM Users WHERE UserStatus = ACTIVE_USER_STATUS_ID 
```

最佳做法是使用后者，这样数字 1 的含义就很清楚了。但这意味着我必须在我的 UserStatus 表和我的代码中维护一个完整的有效 UserStatusID 列表。如何避免同时更新数据库引用表和常量文件？我正在使用一个集中的常量文件，所以我只有一个地方需要更新我的代码，但是有没有办法避免在引入新状态时完全更新常量文件？

我有一个想法：安排一个脚本每天运行一次，通过查询数据库中的引用表来填充常量文件。这是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T18:24:51.210

将常量保存在数据库中。根据需要查询它们。

如果性能有问题，则将应用程序启动时的*所有*常量加载到内部数据结构中，然后在整个应用程序中使用它。

所以你的代码示例将是：

```
SELECT UserStatusID
FROM Users 
WHERE UserStatus = (
                   SELECT INTEGER_VALUE
                   from DB_CONSTANTS
                   WHERE CONSTANT_ID = 'ACTIVE_USER_STATUS_ID'
                   ) 
```

或者，如果您使用内部结构，它会更像这样：

```
SELECT UserStatusID
FROM Users 
WHERE UserStatus = g_Constants.ActiveUserStatusID; 
```

# powershell - 在 Sharepoint 中使用 PowerShell 将“超链接”项类型添加到列表

> ID：738405
> 
> 赞同：2
> 
> 时间：2009-04-10T18:14:52.417
> 
> 标签：powershell, sharepoint-2007, scripting, listitem

我担任 SharePoint 管理员已经有一段时间了，现在我承担了更多开发人员角色的任务 - 我仍在不断学习。大多数事情我都能够自己或通过谷歌弄清楚，但这一点让我很难过。

对于一项特定任务，我需要使用 PowerShell 编写脚本将项目添加到列表中。通常 - 不是一项艰巨的任务。这些步骤遍布网络。但是，我还没有找到可以告诉您如何将“超链接”类型的项目添加到列表的任何地方。

我可以使用以下代码添加一个：

```
$NewItem = $MyList.Items.Add()  
$NewItem["My Hyperlink Column"] = $($url.url)  
$NewItem.Update() 
```

但我也想设置链接的名称/标题，这让我很困惑。我不想在列表中创建一个单独的列并使用链接名称填充它，并使用类似于上面的代码来填充 url/链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T21:54:31.843

这对你有用吗？我没有可用于测试的 Sharepoint 安装，这是来自内存：

```
$NewItem = $MyList.Items.Add()  
$NewItem["My Hyperlink Column"] = "$($url.url), <Title>"
$NewItem.Update() 
```

詹姆士

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T15:56:31.447

谢谢詹姆斯！那非常接近，我想如果我指定一个项目会起作用吗？

这是我的完整解决方案（有一些额外的位）：

```
$enumsite       = new-object microsoft.sharepoint.spsite($SubWebUrl)

foreach ($url in $enumsite.allwebs) 
{
    $NewItem = $MyList.Items.Add()  
    $NewItem["My Hyperlink Column"] = "$($url.url), $(url.title)"
    $NewItem.Update()
    }
$enumsite.Dispose() 
```

也许这会在未来帮助其他人。

# vba - 获取 Collection 对象上项目的键

> ID：738412
> 
> 赞同：5
> 
> 时间：2009-04-10T18:16:05.317
> 
> 标签：vba, collections, vb6, excel

环境是我推入 Collection 的成员是无名的，无法识别的（为了避免糟糕的抽象，请不要惊慌：成员实际上是其他 Collection 实例）。为了能够进行快速搜索，我正在为每个新成员创建一个有意义的哈希名称，并将其作为密钥字符串提供给“最顶层”集合的 Add 方法。

当我有一个密钥可以搜索时，一切都是花花公子......问题是我想迭代集合的成员并获取添加时提供的密钥（生成的哈希，不幸的是不可能反向哈希）。

我继续定义插入的子集合实例的第一个成员是一个字符串，包含提到的哈希，但如果有人破解这个，我将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T18:31:51.847

简单的方法是使用[字典](http://msdn.microsoft.com/en-us/library/aa242687(VS.60).aspx)而不是集合。字典本质上是键、项目对的关联数组，并支持将其键作为数组检索。要使用字典，您需要添加对 Microsoft 脚本运行时的引用。使用字典的缺点是它不能以与集合相同的方式进行枚举。一个更复杂的解决方案是包装集合和字典以创建一个可枚举的字典，如下所述。

**注意**要让 NewEnum 在 VBA 中正常工作，必须按如下方式导出和手动编辑类模块，然后重新导入。

```
Public Property Get NewEnum() As IUnknown
Attribute NewEnum.VB_UserMemId = -4
   Set NewEnum = someKeys.[_NewEnum]
End Property 
```

例子

```
Option Explicit
Private someKeys As Dictionary
Private someCols As Collection
Public Function Add(o As Object, Key As String) As Object
    someKeys.Add Key, o
    someCols.Add o, Key
End Function
Public Property Get Count() As Long
    Count = someCols.Count
End Property
Public Property Get Item(vKey As Variant) As Object
    Set Item = someCols.Item(vKey)
End Property
Public Sub Remove(vKey As Variant)
    someKeys.Remove vKey
    someCols.Remove vKey
End Sub
Public Property Get NewEnum() As IUnknown
   Set NewEnum = someCols.[_NewEnum]
End Property
Public Property Get Keys() As Variant
    Keys = someKeys.Keys
End Property
Private Sub Class_Initialize()
    Set someKeys = New Dictionary
    Set someCols = New Collection
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T01:43:57.193

您可以将您的成员集合包装在您自己的集合调用中，该集合调用存储密钥和集合。这只是迭代抛出集合并询问元素的键（即你散列）的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T08:49:41.667

尝试替代

```
Public Function NewEnum() As IUnknown
        Set NewEnum = m_ObjectCollection.[_NewEnum]
End Function 
```

和

```
Public Function NewEnum() As Collection
        Set NewEnum = m_ObjectCollection
End Function 
```

它对我有用。

# tsql - 从 CLR 存储过程访问 TSQL 创建的 #temp 表。可能吗？

> ID：738421
> 
> 赞同：5
> 
> 时间：2009-04-10T18:19:07.963
> 
> 标签：tsql, sqlclr, temp-tables

1.  我有一个 TSQL 存储过程**tsql__sp__A**它做两件事：

(a) 创建一个临时表**#tempTable**，其中包含来自复杂 SELECT 查询的 SELECT 数据。

(b) 为对行参数进行计算的每一行调用 CLR 管理的存储过程**clr__sp__B**。

问题：是否可以使用相同的连接上下文从 CLR 过程**clr__sp__B**访问**#tempTable ？**（不，我不想在托管过程中移动或创建另一个**#tempTable ）**

 ****谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T00:13:47.533

谢谢博杰。

但是我发现，当您使用“上下文连接 = true”时，它会打开所有 SET

[阅读波尔文章](http://msdn.microsoft.com/en-us/library/ms345135(SQL.90).aspx#mandataac_topic5 "在此处阅读 BOL 文章")

//上下文连接允许您在最初调用代码的相同上下文中执行 SQL 语句//

```
using (SqlConnection connection = new SqlConnection("context connection=true"))
{
    connection.Open();
    // access #temp table
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T18:26:54.107

我们可以在 SQL 中定义两种类型的临时表。

*   当地的
*   全球的

关于本地临时表：

> 当表前面有一个“#”号时，它被定义为本地临时表，其范围仅限于创建它的会话。

关于全局临时表：

> 与本地临时表相比，全局临时表在整个实例中都是可见的。

所以你应该尝试使用“##”来创建一个全局临时表。（*如果*“连接上下文”和“会话”有区别）

# .net-3.5 - ReportViewer：将多个报告合并为一个报告

> ID：738425
> 
> 赞同：0
> 
> 时间：2009-04-10T18:20:28.287
> 
> 标签：.net-3.5, reportviewer, rdlc, localreport

我有一份需要多次运行的报告，每次都输入不同的数据。每个报告都有一个唯一标识它的页眉、实际的数据主体，以及一个包含 [x of y pages] 格式的页数的页脚。显然我可以单独运行每个报告，但我需要页码跨越所有报告。因此，如果我运行它两次，第一次它有 3 页，第二次它有两页，页脚会在每个报告的底部显示 [x of 5 pages]。

我尝试创建一个主报告并只嵌入报告，但它没有显示页眉，我也考虑过单独运行它们，并传入一个参数来调整页码，但我显然需要渲染每个报告，找出总页数，然后重新渲染每个报告以在页脚处有正确的总页数。

有什么建议么？有什么我明显遗漏的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T21:30:20.093

如果有人最终遇到类似的情况，这是我的解决方案：

首先解释我的数据集：

```
public Foo
{
  string a;
  List<Bar> subInfo;
}

public Bar
{
  string b;
  string c;
}

List<Foo> allFoos; 
```

基本上，我没有将 allFoos 对象传递给主报表，然后尝试将相应的 Bar 对象传递给 subReport，而是创建了一个新对象：

```
Public FooBar
{
  string a;
  string b;
  string c;
}

List<FooBar> allFooBars; 
```

所以基本上我扁平化了数据。从那里我创建了一个报告。我添加了一个将“FooBar”作为数据集的表，并传入了“allFooBars”的集合。我还在报告上创建了一个页脚，这样我就可以在所有页面上进行一致的分页。然后我使用分组将“Foo”对象保持在一起。在组上，我将“开始时的分页符”和“包括组标题”和“重复组标题”选项设置为 true。然后我只是设置了组标题来伪装成我的页面标题和组标题（基本上只有 5 行组标题，其中一个是空白的以提供一些空间）。

基本上就是这样。

# ruby - 通过命名管道（而不是 STDIN/STDOUT）控制 IRB

> ID：738426
> 
> 赞同：2
> 
> 时间：2009-04-10T18:20:37.617
> 
> 标签：ruby, irb

是否可以在命名管道上运行 Ruby IRB，以便我可以远程发送命令并获取结果？

一般来说，我想使用 IRB 引擎，同时拥有不同的 UI（可能是用 .Net 编写的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T18:34:30.233

我相信是这样 - 这对我有用（mac os x）：

在 1 号航站楼：

```
mkfifo rpipe 
```

在 2 号航站楼：

```
tail -f rpipe | irb 
```

在 1 号航站楼：

```
echo "puts 'hi'" > rpipe 
```

在终端 2（输出）中：

```
puts 'hi'
hi
nil 
```

有点烦人的是原始命令也被输出，但关闭......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T18:36:08.497

好像是（我刚试过）；只需通过您命名的 ppipe 管道 I/O 就可以了。

但我要问，为什么？

具体来说，你为什么不把它作为一个子进程运行呢？

# sql - 在 SQL Server 上重放负载的工具

> ID：738428
> 
> 赞同：9
> 
> 时间：2009-04-10T18:21:08.427
> 
> 标签：sql, sql-server, stress-testing

有没有人遇到任何可以读取 SQL Server (2005/2008) 跟踪文件并对另一个数据库执行命令的好工具（最好但不一定是 FOSS）。我们正在尝试在我们的 SQL 服务器上执行一些性能测试，并希望复制实际负载。

我遇到过但还没用过：

*   JMeter
*   重播机器学习

最好，应用程序能够使用线程来模拟 SQL Server 上的用户连接和查询执行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-10T18:25:27.777

您可以使用 SQL Server Profiler 本身对另一台服务器重放 SQL Server Profiler 跟踪。

请参阅以下 Microsoft 参考作为起点。

[http://msdn.microsoft.com/en-us/library/ms189604.aspx](http://msdn.microsoft.com/en-us/library/ms189604.aspx)

Quest Software 还有一个名为 Benchmark Factory 的工具，可用于执行 SQL Server 负载测试。

[http://www.quest.com/benchmark-factory/](http://www.quest.com/benchmark-factory/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-29T13:07:15.987

最好的工具之一实际上可以从 Microsoft 免费获得。RML Utilities 面向 SQL2005 和 SQL2008，专为此类测试而设计。

[您可以从http://www.microsoft.com/downloads/details.aspx?FamilyId=7EDFA95A-A32F-440F-A3A8-5160C8DBE926&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=7EDFA95A-A32F-440F-A3A8-5160C8DBE926&displaylang=en)下载工具

我们已经使用它们解决了几个性能和锁定问题。

注意：由于 GUI 和 Trace 后端的交互方式，使用 SQL Profiler GUI 捕获跟踪文件可能会增加性能问题。RML Utilites 包含一个脚本，该脚本可以直接从 SQL Server 捕获跟踪，而无需使用 GUI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T18:23:54.347

您可以直接在 SQL Profiler 中重放跟踪文件，尽管我只为此使用过几次，所以我不知道它有哪些限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T18:26:25.433

团队系统有一个附加组件，您可以在 codeplex 上找到它：它被称为 ->

[sql负载测试](http://sqlloadtest.codeplex.com/)

让我知道这是否适合您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-13T02:29:02.807

我知道这是一个非常古老的问题，但在搜索了一段时间后，我发现了一个新的开源工具。 [https://github.com/spaghettidba/WorkloadTools](https://github.com/spaghettidba/WorkloadTools)效果很好

# python - Django 入门-Instant Django

> ID：738433
> 
> 赞同：0
> 
> 时间：2009-04-10T18:22:34.803
> 
> 标签：python, django

我一直在尝试让 Django 运行，并且在浏览项目介绍时，当我进入“同步数据库”部分时，我似乎一直遇到麻烦。使用 InstantDjango 时，这似乎不是什么大问题。我的问题是，可以只使用 InstantDjango 程序进行 Django 开发，还是真的需要以正常方式运行它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-16T14:16:27.197

InstantDjango 默认使用 sqlite。你设置你的普通 django 使用什么数据库？你在运行syncdb之前创建了那个数据库吗？

InstantDjango 对所有 django 所需的库（便携式版本）使用不同的包装，这些库可能不太稳定，但它们应该可以满足您的开发需求。

# arrays - 如何有效地从（非稀疏）矩阵中删除零？

> ID：738438
> 
> 赞同：11
> 
> 时间：2009-04-10T18:23:59.120
> 
> 标签：arrays, matlab, performance, matrix, matrix-indexing

我有一个矩阵：

```
x = [0 0 0 1 1 0 5 0 7 0]; 
```

我需要删除所有的零，如下所示：

```
x = [1 1 5 7]; 
```

我使用的矩阵很大（1x15000），我需要多次（5000+），所以效率是关键！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T18:26:30.830

单程：

```
x(x == 0) = []; 
```

**关于时间的说明：**

正如 woodchips 所提到的[，与 KitsuneYMG](https://stackoverflow.com/questions/738438/removing-zeros-from-a-matrix-not-sparse/738484#738484)[使用](https://stackoverflow.com/questions/738438/removing-zeros-from-a-matrix-not-sparse/738861#738861)的方法相比，这种方法似乎很慢。[Loren 在她的一篇 MathWorks 博客文章](http://blogs.mathworks.com/loren/2008/09/25/timing-extraction-of-parts-of-an-array/)中也注意到了这一点。由于您提到必须这样做数千次，您可能会注意到不同之处，在这种情况下，我会先尝试。`x = x(x~=0);`

**警告：**如果您使用的是非整数，请当心。例如，如果您有一个非常小的数字，您希望将其考虑为足够接近零以便将其删除，则上述代码不会删除它。仅删除*精确的零。*以下内容将帮助您将“足够接近”的数字删除为零：

```
tolerance = 0.0001;  % Choose a threshold for "close enough to zero"
x(abs(x) <= tolerance) = []; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-10T18:36:58.857

只是要与众不同：

```
x=x(x~=0); 
```

或者

```
x=x(abs(x)>threshold); 
```

这也有处理复数的好处

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-10T21:03:10.640

这是三种常见的解决方案。它有助于看到差异。

```
x = round(rand(1,15000));

y = x;

tic,y(y==0) = [];toc

Elapsed time is 0.004398 seconds.

y = x;

tic,y = y(y~=0);toc

Elapsed time is 0.001759 seconds.

y = x;

tic,y = y(find(y));toc

Elapsed time is 0.003579 seconds. 
```

如您所见，最便宜的方法是直接逻辑索引，选择要保留的元素。查找更昂贵，因为 matlab 找到这些元素，返回它们的列表，然后索引到向量中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T18:37:35.297

这是另一种方式

y = x(查找(x))

我会留给你来弄清楚你尝试的各种方法的相对效率——写下来让我们都知道。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-23T11:48:07.303

虽然我的计时结果不能确定它是否明显更快，但这似乎是最快和最简单的方法：

```
y = nonzeros(y) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-09T03:01:58.537

```
x = [0 0 0 1 1 0 5 0 7 0]
y = [0 2 0 1 1 2 5 2 7 0] 
```

那么 x2 和 y2 可以得到：

```
x2=x(~(x==0 & y==0))
y2=y(~(x==0 & y==0))

x2 = [0     1     1     0     5     0     7]
y2 = [2     1     1     2     5     2     7] 
```

希望这可以帮助！

# asp.net - 如何在我的新 ASP.NET 网站中使用 OpenID？

> ID：738439
> 
> 赞同：5
> 
> 时间：2009-04-10T18:24:05.173
> 
> 标签：asp.net, openid

我一定是愚蠢的，因为我在 ASP.NET 中看到的关于 OpenID 的所有文章都让我在这个问题上感到困惑。我很确定我理解这里涉及的概念，我只是对事物后端的外观有点模糊。

所以一个新用户来到我的网站并想创建一个帐户。随之而来的问题如潮水般涌来：

*   第一步是让他选择他将使用哪个 openID 提供商登录吗？
*   我是否提示他输入我系统上的用户名？
*   我是否需要在他每次返回时将他绑定到同一个 openID 提供者，还是他每次都可以选择一个新的提供者？
*   这里的数据库是什么样的？我是否在表格中有他的用户名并且链接到 openID 提供程序？
*   如果用户没有 OpenID 帐户怎么办？我是否应该允许他在我这边创建一个传统帐户，然后将自己暴露为 OpenID 提供者？

我在这里想念什么？我通常很聪明，但对于我的开发人员智慧来说，这个领域就像超人的氪石一样。提前致谢！

亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T18:44:50.863

伙计，你并不孤单。OpenID 让除了设计它的人之外的所有人都感到困惑，即便如此，我也不确定它是否不会让他们感到困惑，因为有多个 OpenID 提供程序并且它们之间存在轻微的不兼容性，具体取决于您使用的库。

假设用户自己是一个 sql“表”（该表包含他的“凭据”），并且您有一个特定于您拥有的网站的配置文件数据表。OpenID url 是用于“加入”这两个表的“外键”。您必须先向*自己*证明他确实拥有该 OpenID 网址，然后才能接受（或将其与您的私人资料数据相关联）。您实际上是在“外包”您网站的身份验证部分。

所以最终，你会使用一个 openid 客户端库来为你在你的网站上工作。他们注册为正常填写“全名”，“年龄”等（无论*您*想要什么），但他们提供一个 openid url 而不是用户名/密码。该库会在验证他们真正拥有它之后进行查找。您必须信任这个库才能做到然后，您使用该 openid 存储您的所有个人资料数据。完成。

虽然您可以提供自己的 openid 提供程序，但此时不值得。那里已经有很多了。但是，您可以做的是提供传统的用户名/密码而不是 openid。openid 的想法是您向提供商注册一次，然后只需证明您拥有该 URL 到任何想要使用它来识别您的站点（而不是用户名/密码）。

有道理？

-Oisin

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T18:50:19.963

本页是关于在网站上实现 OpenId 的分步教程。我相信它会回答你所有关于添加它的机制的问题。

[OpenID 启用您的网站的秘诀](http://www.plaxo.com/api/openid_recipe)

如果用户没有 OpenId，我只会允许他们“正常”注册，存储他们的凭据以供本地使用。没有必要增加成为 OpenID 提供者的额外复杂性，除非您有商业案例。

# c# - 是列表 .Contains() 线程安全调用 - C#

> ID：738444
> 
> 赞同：11
> 
> 时间：2009-04-10T18:25:25.637
> 
> 标签：c#, thread-safety

我的理解是，如果你在 C# 中使用通用列表（List），它可以支持多个并发读取器，但只能支持一个写入器。而且，当您将编写器引入组合时，您还必须提供同步构造以使操作线程安全。

List.Contains 是否被视为读取操作？换句话说，如果我调用这个方法，我是否需要担心作者可能会同时写入这个列表？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-10T18:30:16.687

是的你应该。基本上，如果列表可能同时用于写入，我会同步*任何操作。*

一般来说，我发现集合分为两类——一类是被创建、初始化然后再也不会改变的（线程安全的），另一类是随时间变化的（不是线程安全的，锁定所有访问）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T18:38:57.010

如果你使用 Reflector 来检查代码，你会得到这样的结果：

```
public bool Contains(T item)
    {
        if (item == null)
        {
            for (int j = 0; j < this._size; j++)
            {
                if (this._items[j] == null)
                {
                    return true;
                }
            }
            return false;
        }
        EqualityComparer<T> comparer = EqualityComparer<T>.Default;
        for (int i = 0; i < this._size; i++)
        {
            if (comparer.Equals(this._items[i], item))
            {
                return true;
            }
        }
        return false;
    } 
```

如您所见，这是对项目的简单迭代，这绝对是“读取”操作。如果您仅将它用于读取（并且没有改变项目），则无需锁定。如果您开始在单独的线程中修改列表，那么您肯定需要同步访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T18:29:41.713

`List<T>.Contains`肯定是读操作。在您阅读该集合时，可能有其他线程正在写入该集合。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T18:30:28.403

是的，您确实需要担心！List.Contains 只是获取一个 EqualityComparer 然后循环遍历列表包含的所有项目，将作为参数传递的项目与当前迭代索引处的项目进行比较，因此如果列表在迭代时被修改，结果可能是不可预测的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T18:29:49.793

根据[医生](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)...

*通过集合进行枚举本质上不是线程安全的过程。*

所以，我会说不，它不是线程安全的。你应该把它锁起来。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T18:30:36.140

可以安全地假设这不是线程安全操作。[MSDN 描述](http://msdn.microsoft.com/en-us/library/system.collections.ilist.contains.aspx)总结了它：

> ...此方法使用集合对象的 Equals 和 CompareTo 方法来确定 item 是否存在。

所以，读操作之后是比较操作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T18:32:41.300

在多线程环境中，您确实需要确保没有同时写入集合。这是来自反射器的代码，集合本身并没有为您提供任何锁定，所以它是您的赢家。

```
public bool Contains(T item)
{
    if (item == null)
    {
        for (int j = 0; j < this._size; j++)
        {
            if (this._items[j] == null)
            {
                return true;
            }
        }
        return false;
    }
    EqualityComparer<T> comparer = EqualityComparer<T>.Default;
    for (int i = 0; i < this._size; i++)
    {
        if (comparer.Equals(this._items[i], item))
        {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T18:30:06.907

如果一个作家可能同时在写作，那么 List.Contains 绝对不是线程安全的。您需要用锁包装它和任何其他读写操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T18:32:44.763

它被认为是读取操作。您不会遇到任何竞争条件，但如果您担心获得最新的，您可以制作`List` `volatile`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-10T18:32:55.057

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)：

> 此类型的公共静态（在 Visual Basic 中为 Shared）成员是线程安全的。不保证任何实例成员都是线程安全的。

ReaderWriterLock类似乎是为您正在寻找的同步而构建的[。](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)

# content-management-system - PTA网站的软件[CMS]？

> ID：738445
> 
> 赞同：0
> 
> 时间：2009-04-10T18:25:26.900
> 
> 标签：content-management-system

我正在寻找旨在支持家长教师协会网站的 [最好是免费的] 软件。CMS 似乎是正确的起点。我敢肯定它们中的许多都可以定制以支持我们的需求（会员注册、论坛、文档共享、照片、批量电子邮件、在线支付处理），但我想知道是否已经有任何专门的 PTA 软件包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T18:31:41.643

[Drupal](http://drupal.org/)始终是一个不错的选择，它为您刚刚描述的所有内容提供了模块。你也可以看看[Joomla](http://www.joomla.org/)。有人说他们发现 Joomla 更易于管理。

Drupal 很常见，并且有[很多托管选项](http://drupal.org/hosting)。根据您想要获得的详细程度，也很容易聘请[某人为您进行设置](http://drupal.org/drupal-services)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T18:29:41.103

你有几个选择：

德鲁巴

Joomla

网络核弹

# tinymce - tinymce 在 IE7 中为一个用户显示原始 html 代码并且没有按钮，其他 4 个用户没有问题。如果该用户使用 Foxfire，它可以完美运行

> ID：738454
> 
> 赞同：0
> 
> 时间：2009-04-10T18:27:51.390
> 
> 标签：tinymce

我有 5 个用户（3 个位置）使用具有 Tiny_MCE 文本区域的页面。

我没有收到任何错误，它在其他 4 台运行 IE7 的机器上完美运行这表明没有 JavaScript 错误。

一位用户只看到原始 html 代码，根本看不到任何按钮。

我怀疑它一定是一些错误的IE设置。似乎没有禁用 Javascript，因为其他 Javascript 功能在 IE 的同一台机器上的同一站点上工作。此用户正在运行 XP Pro 和 IE 7。

*当我在他的机器上安装 FireFox 时，Tiny_MCE 运行良好。这也表明没有 JavaScript 错误。*

我不知所措。任何想法，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T18:51:30.223

一旦我遇到同样的问题，解决方法是删除脚本末尾的逗号。因此，请检查您的代码中是否存在错误模式。

例如，下面的代码包含一个会阻止它在 IE7 中运行的错误。

```
tinyMCE.init({
    // General options
    mode: "textareas",
    theme: "advanced",
    ...
    template_replace_values: {
        username: "Some User",
        staffid: "991234"
    }, // <<< BUG - Additional comma here
}); 
```

如果您可以在 IE7 中启用 javascript 调试，请在此处发布 js 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T20:05:30.993

有趣的事情。这个问题在没有人工帮助的情况下自行解决。没有重启，什么都没有。成为AFU 2周后，它又开始工作了。

**一定要爱 Windows！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-03T01:08:13.730

我以前遇到过这个问题，它一直是一个缓存问题。在 IE 中使用 Ctrl-F5 强制完全刷新浏览器和浏览器缓存中的页面及其所有文件（*.css、*.js）。我的猜测是坏的 IE 7 计算机有 14 天的设置来检查文件是否是最新的。

有时情况会更糟——Web 服务器（tomcat 5.5）也会缓存文件，而不会注意到文件已更新。重新启动网络服务器解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-11T22:55:57.517

过去几个月，我们的软件遇到了同样的问题。

我在开发者的网站上找到了这个论坛主题： [http ://tinymce.moxiecode.com/punbb/viewtopic.php?pid=66594](http://tinymce.moxiecode.com/punbb/viewtopic.php?pid=66594)

简而言之，他建议在初始化 tinymce 时将 strict_loading_mode 设置为 true。我已经这样做了，从那以后我就没有问题了。

# asp.net - 带有下拉列表的树视图

> ID：738464
> 
> 赞同：0
> 
> 时间：2009-04-10T18:31:18.493
> 
> 标签：asp.net, treeview, web-controls

System.Web.UI.WebControls.TreeView 在可展开的树视图中显示分层数据，并且每个节点旁边都有一个复选框。

我想要类似的东西，但我需要在每个节点上呈现一个 DropDownList，所以我可以有两个以上的选择（选中或未选中）。

有没有办法用 TreeView 做到这一点？

还是有另一个免费控件可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T00:32:12.107

我不知道其他免费控件，但是使用 TreeView，如果不创建自己的版本或接管渲染，您就无法做到这一点。TreeView 不使用 Controls 集合，也不提供注入任何内容或更改其渲染输出的方法。

# python - 在 Python 中，我如何以静态方式一般地引用一个类，比如 PHP 的“self”关键字？

> ID：738467
> 
> 赞同：26
> 
> 时间：2009-04-10T18:31:50.193
> 
> 标签：python, class

PHP 类可以在静态上下文中使用关键字“self”，如下所示：

```
<?php
class Test {
  public static $myvar = 'a';
  public static function t() {
     echo self::$myvar; // Generically reference the current class.
     echo Test::$myvar; // Same thing, but not generic.
  }
}
?> 
```

显然，我不能在 Python 中以这种方式使用“self”，因为“self”指的不是类而是实例。那么有没有一种方法可以在 Python 的静态上下文中引用当前类，类似于 PHP 的“self”？

我想我想要做的是相当不符合pythonic的。不过不确定，我是 Python 新手。这是我的代码（使用 Django 框架）：

```
class Friendship(models.Model):
  def addfriend(self, friend):
    """does some stuff"""

  @staticmethod # declared "staticmethod", not "classmethod"
  def user_addfriend(user, friend): # static version of above method
    userf = Friendship(user=user) # creating instance of the current class
    userf.addfriend(friend) # calls above method

# later ....
Friendship.user_addfriend(u, f) # works 
```

我的代码按预期工作。我只是想知道：我可以在静态方法的第一行使用关键字而不是“友谊”吗？

这样，如果类名发生更改，则不必编辑静态方法。就目前而言，如果类名更改，则必须编辑静态方法。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-10T19:04:47.370

这应该可以解决问题：

```
class C(object):
    my_var = 'a'

    @classmethod
    def t(cls):
        print cls.my_var

C.t() 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-04-10T18:35:45.130

在所有情况下，`self.__class__`都是对象的类。

[http://docs.python.org/library/stdtypes.html#special-attributes](http://docs.python.org/library/stdtypes.html#special-attributes)

在（非常）罕见的情况下，您试图弄乱静态方法，您实际上需要[classmethod](http://docs.python.org/library/functions.html#classmethod)。

```
class AllStatic( object ):
    @classmethod
    def aMethod( cls, arg ):
        # cls is the owning class for this method 

x = AllStatic()
x.aMethod( 3.14 ) 
```

# c# - C# - 在二进制文件中搜索模式

> ID：738475
> 
> 赞同：5
> 
> 时间：2009-04-10T18:33:56.133
> 
> 标签：c#, file, binary, find, substring

在 C# 中搜索大型二进制文件以查找某个子字符串的最佳方法是什么？

为了提供一些细节，我试图从可执行文件中提取 DWARF 信息，所以我只关心二进制文件的某些部分（即以字符串开头的部分`.debug_info`，`.debug_abbrev`等等）

我在 , 或 中看不到任何明显的东西`Stream`，`FileStream`所以`BinaryReader`看起来我必须自己读取数据块并在数据中搜索字符串。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T04:42:48.500

.NET 中没有任何内置功能可以为您进行搜索，因此您需要逐块读取文件并扫描您想要查找的内容。

您可以通过两种方式加快搜索速度。

首先，使用缓冲 IO 并一次传输大块 - 不要逐字节读取，读取 64KB、256KB 或 1MB 块。

其次，不要对您想要的部分进行线性扫描 - 查看[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm)（维基百科链接）算法进行字符串搜索 - 您可以将其应用于搜索您想要的 DWARF 信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T18:42:07.533

我认为你必须自己做，BinaryReader 不是为在二进制文件中搜索文本而设计的。但是，您应该注意搜索时使用的文本编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:25:43.147

必须有一个可以编译和使用互操作的 DWARF C 库吗？我做了一些搜索，发现[了这个](http://reality.sgiweb.org/davea/dwarf.html)。如果可以将那里的库编译成 Windows 上的 DLL（我假设您使用的是 Windows），那么您可以使用 System.Runtime.InteropServices 与 DLL 交互并从那里提取信息。

也许？

# php - .hgignore 用于 CakePHP 应用程序？

> ID：738487
> 
> 赞同：3
> 
> 时间：2009-04-10T18:37:49.180
> 
> 标签：php, cakephp, mercurial, hgignore

我们将 CakePHP 用于一个新的应用程序，并且我们使用 Mercurial 作为源代码控制工具。（Mercurial`.hgignore`在根目录中使用一个文件，不像（例如）`.cvsignore`在任何目录中使用的 CVS。）

我想`app/tmp/`从源代码管理中排除目录的内容（因为它们一直在变化，并且可以重新生成），但我不能添加`app/tmp/*`到`.hgignore`，从那时起`tmp`（`cache`，`logs`，`sessions`，`tests`，以及`cache/models`, `cache/persistent`, ...) 将在由 制作的新克隆中丢失`hg clone`，从而导致错误。

目前我在我的`hgignore`：

```
app/tmp/logs/*.log
app/tmp/cache/persistent/cake_*
app/tmp/cache/models/cake_* 
```

最好有一个可以在所有项目中使用的“标准”。有人可以提出一个完整的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T08:55:34.090

你可以加

```
syntax: glob
app/tmp/** 
```

到您的`.hgignore`文件，Mercurial 将从那时起忽略所有文件`app/tmp/`，但 Mercurial 跟踪的文件**除外**。`hg help patterns`有关文件名模式的更多信息，请参阅。

所以如果你这样做

```
% touch app/tmp/cache/.empty
% touch app/tmp/logs/.empty
% hg add app/tmp/cache/.empty
% hg add app/tmp/logs/.empty 
```

并进行克隆，然后*将*`app/tmp/cache`创建和`app/tmp/logs`目录，并且这些目录中的新文件将被忽略。我想这就是你想要的？

 *这对于跟踪类似的东西也很有用，`$HOME`因为您希望默认忽略大多数文件，只跟踪显式添加的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:13:40.473

在我自己的结帐（来自 SVN）中，部署站点时，./tmp/ 目录需要具有一些特定权限。

我将它完全从版本控制中删除，我的部署脚本根据需要创建了目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T18:29:52.560

如果我正确理解了这个问题，您想忽略 tmp 中的文件，而不是 tmp 中某些目录中的文件。如果那是正确的，那么我认为您可以使用以下方法这样做：

```
syntax: regexp
^tmp/(?!(cache|logs|sessions|test)) 
```

也就是说，忽略以 tmp 开头的任何内容，除非下一部分是缓存、日志、会话、测试。对于这些文件：

```
.
`-- tmp
    |-- cache
    |   `-- afile
    `-- tmpfile 
```

结果`hg stat`如下：

```
$ hg stat
? .hgignore
? tmp/cache/afile 
```

不过，我会注意到，Cake 可能会告诉您不要将这些文件放入源代码管理中，因为它们位于 tmp 目录中。您确定它们不是您的构建系统应该创建的东西吗？特别是会话听起来很短暂。

# php - 突出显示搜索词

> ID：738498
> 
> 赞同：0
> 
> 时间：2009-04-10T18:45:00.317
> 
> 标签：php, php4

我有一个案例，我正在返回数据库结果并根据搜索词在页面上显示它们。这部分工作正常，但我想通过将它们包装在 span 标签中来突出显示这些搜索词。我开始编写一个函数，我在使用 str_replace 函数的每个结果上调用它，但后来我意识到这也会影响 HTML 标记中的任何文本。有没有人有他们用来有效地做到这一点的功能？我正在使用 PHP 4。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T03:55:07.187

我会用javascript突出显示

[http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)

```
$(document).ready(function(){
$('#your_results_list').removeHighlight().highlight('search_word');
} 
```

这样你就不会弄乱源，用户可以根据需要转高亮，等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T19:06:46.273

我曾经用 Perl 写过一个搜索，是这样的（对 PHP 做了一点翻译）：

```
// Split up the full page content in pieces without `<` and `>`
preg_match_all("/([^<>]+)/", $pageContent, $matches);
foreach ($matches as $val) {
    // Just print the $val if it was between < and >
    if (preg_match("/<$val>/", $pageContent) { print "<$val>"; }
    else {
       // Do the replace
       print str_replace( "$searchString", "<span>$searchString</span>", $val);
   }
} 
```

如果出现以下情况，您可以避免使用正则表达式：

```
 // Split up the full page content in pieces with `<`
 $matches = split("<", $pageContent);
 foreach ($matches as $val) {
    // Just print the $val if it was between < and >
    if (stristr($pageContent, "<$val")) { print "<$val"; }
    else {
       // Do the replace
       print str_replace( "$searchString", "<span>$searchString</span>", $val);
   }
} 
```

没有测试，但应该是这样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T19:07:31.200

如果您要返回结果*并*显示它们，那么您不应该在原始数据在 html 中生成之前访问它吗？如果是这样，那么通过在其中添加跨度标签来修改原始数据。

如果您说您的原始数据中可能*已经*包含 html，您可以使用正则表达式来检测您是否在 html 标记内，并使用 preg_replace 而不是 str_replace。

其他选项：

--将结果加载到dom解析器中，并且只对叶子文本节点进行替换操作

-- 编写你自己的解析器来跟踪你是否在一个 html 标签内

-- 从结果中抽出所有 HTML 标签，放入占位符，如“[[[tag1]]] balha blah blah [[[tag2]]]”，然后替换剩余的文本，然后将标签替换回

# svn - Svn Post Commit Hook 将提交的文件复制到另一个存储库的工作副本？

> ID：738499
> 
> 赞同：0
> 
> 时间：2009-04-10T18:46:41.220
> 
> 标签：svn, shell

目的是维护 2 个未严格镜像的独立存储库。两个存储库都由不同的开发人员更新，所以 svnsynch 是不可能的。

挂钩脚本可能不是正确的解决方案，因为我更喜欢随意运行脚本而不是每次提交。也许是一个比较时间戳并复制最年轻的脚本？请不要建议我们更改为 git。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T19:04:35.590

I'm linking to a [hook script](http://static.ellipsix.net/ext-tmp/autoupdatehook.sh) I use to check out a part of a repository every time it's committed to. You could probably modify it to suit your needs; I imagine you'd want to change the `svn checkout` to `svn export`.

For posterity I'll copy the text of the script here:

```
#!/bin/bash

# POST-COMMIT HOOK
#
# This is an SVN post-commit hook to automatically update a directory with the contents
# of some part of the SVN repository every time that part of the repository is changed.

fail() {
    echo "$@" 1>&2
    exit 1
}

# USER and PASS are the username and password of an SVN user with read access to the 
# relevant part of the repository
USER=""
PASS=""
# The root of the SVN repository
SVNROOT=""
# The path within the SVN repository to export whenever it's committed
SVNPATH=""
# The directory to hold the checked-out copy
WORKING=""

# Since environment variables are unset
export PATH="/bin:/usr/bin:/usr/local/bin"

getopt=$(which getopt)

TEMP=`$getopt -o u:p:U:P:d: --long user:,pass:,password:,svn-root:,svn-path:,working-dir: -n $0 -- "$@"`

if [ $? != 0 ]; then
    fail "Terminating...getopt failed"
fi

# Note the quotes around `$TEMP': they are essential!
eval set -- "$TEMP"

while true; do
    case "$1" in
        -u|--user)
            USER=$2
            shift 2;;
        -p|--pass|--password)
            PASS=$2
            shift 2;;
        -U|--svn-root)
            SVNROOT=$2
            shift 2;;
        -P|--svn-path)
            SVNPATH=$2
            shift 2;;
        -d|--working-dir)
            WORKING=$2
            shift 2;;
        --)
            shift
            break ;;
        *)
            fail "Option error!";;
    esac
done

test -n $SVNROOT || fail "Missing option --svn-root"
test -n $SVNPATH || fail "Missing option --svn-path"
test -n $WORKING || fail "Missing option --working-dir"

REPOS="$1"
REV="$2"

# The path to SVN executables
svnbin=$(which svn)
svnlook=$(which svnlook)
# The path to grep
grep=$(which egrep)

if test -n "$USER"; then
    AUTHSTR="--username $USER --password $PASS"
else
    AUTHSTR=""
fi
svnexport="$svnbin export --revision $REV $AUTHSTR"
svnupdate="$svnbin update --revision $REV $AUTHSTR"
svncheckout="$svnbin checkout --revision $REV $AUTHSTR"
svnchanged="$svnlook changed $REPOS --revision $REV"
grepq="$grep -q"

# If anything in the desired path has been changed
if $svnchanged | $grepq "^[A-Z]+[[:space:]]+$SVNPATH"; then
    # Check it out to the web root
    if test -d $WORKING/.svn; then
        $svnupdate $WORKING || fail "svnupdate failed"
    else
        $svncheckout file://$SVNROOT/$SVNPATH $WORKING || fail "svncheckout failed"
    fi
fi 
```

# php - 限制授权php用户访问文件

> ID：738500
> 
> 赞同：6
> 
> 时间：2009-04-10T18:48:08.360
> 
> 标签：php, security, session, .htaccess, file

我继承了一个存在明显安全漏洞的应用程序。

它具有基于会话的安全性，但文件上传（特定于用户）不受任何保护，它们存储在公共文件树中。

文件名不遵循任何约定，因此很难猜测，但数据是敏感的，因此我需要实施安全措施来防止未经授权的文件访问。

移动文件的位置并不是一个真正的选择，所以我正在寻找一个 htaccess 解决方案来将请求转发到 php 处理程序脚本。

有没有人有实施这类事情或任何好的替代解决方案的经验？非常感谢 .htaccess 语法的具体示例，因为我在这方面苦苦挣扎。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T18:53:29.907

不太明白为什么不能移动它们，因为将它们的请求推送到处理程序意味着它们的存储位置不再重要。但你是现场的那个人。

.htaccess 看起来像：

```
RewriteEngine on
RewriteRule path/to/where/these/files/live/(.*) /handlerscript.php/$1 
```

然后你从`$_SERVER['PATH_INFO']`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T19:03:02.583

好吧，您可以让 apache 为某个文件夹解析 .jpg 文件，并将以下内容添加到您的 .htaccess

```
AddHandler php5-cgi .jpg 
```

然后您可以设置一个 php 文件来解析请求，就像混乱向您推荐并进行一定的验证一样，然后只返回 jpeg 标头以及您想要显示的正确图片

这是一个例子

```
<?php
if($validUser)
    {
    header("Cache-control: No-cache");
    header("Pragma: No-cache");
    header("Content-Type: image/jpeg");
    //correct picture address
    $img = imagecreatefromjpeg("2326_b_lil.jpg");
    imagejpeg($img);
    }
    else
    {
    //code for error image
    }
?> 
```

如果您想要更广泛的示例，请告诉我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T18:52:42.657

我认为您可能需要编写一个脚本来提供图像，然后使用 htaccess 完全限制从浏览器访问实际图像。

该脚本可以获取图像的网络路径，决定用户是否有权访问，然后使用 fpassthru 之类的东西将实际图像提供给浏览器。

然而，所有对图像的引用都需要修改，以引用服务脚本。

因此，不是使用 /images/123/5423453245.jpg 访问图像，而是 /image.php?images/123/5423453245.jpg

或者类似的东西。

# sharepoint - 在 SPWeb 上捕获标题更改事件

> ID：738508
> 
> 赞同：2
> 
> 时间：2009-04-10T18:50:20.257
> 
> 标签：sharepoint, events, moss, spweb

我正在使用在**WebMoved** 事件上**成功** 触发的SPWebEventReceiver 监听特定的 SPWeb。当网络移动时，我用新的位置/标题更新列表。

 **我希望能够做的是监听 Web 何时**重命名**。我是否通过附加项目侦听器并等待 ItemUpdated 事件来做到这一点？如果是这样，我将不胜感激一小段代码！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T14:31:54.910

看起来这是 SharePoint OM 的一个错误。[事件接收器显然应该在网络名称更改时触发，但事实并非如此。](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spwebeventreceiver.webmoving.aspx?ppud=4)它仅在 Web 的 URL 更改时触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T20:11:29.220

史蒂夫，据我所知，SPWebEventReceiver 仅在 SPWeb 上公开以下事件（[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spwebeventreceiver_members.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spwebeventreceiver_members.aspx)）

*   网站已删除
*   网站删除
*   网页已删除
*   星期三删除
*   网络移动
*   网络移动

ItemAdded 在适用于 SPListItem 对象的 SPItemEventReceiver 中定义。

SPWeb 的 Title 属性存储在属性包 ( [http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.properties.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.properties.aspx) ) 中。

当在属性包上调用 .Update() 时，例如在更新 Title 时，您似乎无法访问任何事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T20:47:24.710

1.  我会说重命名 Web 名称应该触发 WebMoved。
2.  站点标题重命名不会触发任何操作。

问题：您希望利用哪些变化？因为例如任何元数据都可以存储在里面的列表中，这支持很多事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-30T20:28:28.660

我不相信这是一个错误，我相信这只是对文档的误解。正如您所说，文档表明 WebMoving 和 WebMoved 事件是由修改或重命名站点的 url 触发的：

来自[MSDN Doc](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spwebeventreceiver.webmoving(v=office.15).aspx)：“在现有网站被重命名或移动到不同的父对象之前发生的同步之前事件。”

然而，在 UI 中改变的不是站点的“名称”，而是站点的标题。SPWeb 对象确实具有可通过对象模型访问的“名称”属性，更新该名称属性并调用 SPWeb.Update() 实际上会触发 WebMoved 事件。麻烦的是，这个属性没有通过网站的基于Web的设置页面暴露出来，只有“标题”字段被暴露出来，而且这个字段变化不会触发事件。虽然这似乎有点违反直觉，甚至具有误导性，但如果您从字面上阅读文档，它的行为与文档中的完全一样。

# c# - 最大化时的 WinForms (.NET) 按钮锚定

> ID：738509
> 
> 赞同：0
> 
> 时间：2009-04-10T18:50:53.940
> 
> 标签：c#, winforms, anchor, button

好的，我已经用谷歌搜索了，但也许我奇怪地搜索了。：/

我有一个 VB.NET WinForms 应用程序。我为所有控件设置了锚属性，以便在窗体最大化时调整所有控件的大小以使其看起来*不错。*（但是还没有手动调整大小）。

无论如何，问题是：

我会在主 GUI 表单/图片上为按钮设置相同的属性（现在使用单个按钮进行测试）。当我通过 F5 运行程序时，它看起来不错。但是当我最大化表单时，整个按钮的覆盖范围超出了应有的范围。

我已经截取了表格的屏幕截图，因此您可以直观地看到我在说什么。：/

之前：http: [//zack.scudstorm.com/before.png](http://zack.scudstorm.com/before.png)
之后：http: [//zack.scudstorm.com/after.png](http://zack.scudstorm.com/after.png)

我需要设置哪些其他属性（y|ies）才能正确显示按钮？：/（按钮越过显示“1-1”、“2-3”等的框。

谢谢，
-扎克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T18:55:23.880

当您想要的只是左上角时，似乎您已经锚定了左上角和右下角。

编辑：如果它只是一个在winform更改时不会改变的图像，那么根本不要锚定你的按钮。把它们放在他们去的地方。如果您正在缩放图像，那么我要么检测图像上的点击并进行缩放数学运算，要么进行缩放数学运算并在 Form.OnResize 事件的代码中设置我的按钮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T18:58:34.123

看来您的目标只是能够处理“计算机”上的点击......

对此类任务有用的一个选项是创建一个“覆盖”位图（不显示，但与源位图的大小完全相同），它使用不同的颜色来表示所有可点击区域。（例如`(R=0,G=0,B=0)`对于计算机 0、`(0,0,1)`对于计算机 1 等）

您甚至可以自动生成此位图而无需太多麻烦（如果您有一种模式，您可以单击图像的左上角然后右下角来定义新区域）

单击鼠标时，您可以检查叠加层中鼠标位置的缩放坐标处的像素，并确定它们的单击对应于什么。这比创建大量控件要容易得多，并且可以更容易地创建非矩形的可点击区域。

# asp.net - 在这种情况下哪种重用方法更好 - ascx 或其他

> ID：738512
> 
> 赞同：0
> 
> 时间：2009-04-10T18:52:04.967
> 
> 标签：asp.net, user-controls, code-reuse

我有一个 ASP.NET 应用程序，可以显示不同类型学生的成绩。一些学生有自定进度的课程，不包括迟到的处罚和测验，而另一些学生有标准的课堂课程。

因此，在显示学生的成绩时，我会确定该学生属于哪个类别，然后适当地呈现成绩。

现在我使用条件语句来执行此操作，但我考虑将每个案例制作成一个 ascx 文件（即一个带有用于自定进度的 gridView 的 ascx，一个带有用于教室的 gridView 的 ascx，每个案例都在我的数据中调用数据填充方法访问类）。

我可能需要在应用程序的其他地方重新使用此功能，以在不同页面上显示成绩，因此某种自定义控件似乎是必要的。

这种方法可行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T19:04:31.347

Make sure you are adequately separating your calculation logic from the display. I would use a class to actually determine the grades (perhaps multiple classes with a nice inheritance tree) to actually do the match, and the just render appropriately in your user control.

If you have multiple classes (or some property for determining what type a particular isntance is) you could also then easily create a factory to instantiate user controls for you where you will get the correct user control type, based on the calculation passed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T18:55:27.343

这种方法对我来说听起来不错 - 控件旨在帮助您重用代码。我认为一组用户控件在这里可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T18:56:57.730

这种方法绝对是可行的，而且如果你以后想修改 HTML 的显示方式（新样式等），它也很容易改变。我会说 ASCX 是一个很好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T19:52:23.587

以下是我对您的应用的理解：

1.  您有已注册课程的学生。
2.  学生可以是标准的或自定进度的。
3.  对于不同类型的学生，每门课程的评分方法是不同的。
4.  您需要一种根据学生类型显示正确成绩的方法。

我认为您可以通过一个控件来显示成绩，但肯定会确保将您的逻辑分开。也许是这样的：

```
public class Student{
   public GradingType Type {get;set;}
   public List<Course> RegisteredCourses{get;set;}
   //etc...
}

public class Course{
   //etc...
}

public static class GradeCalculator{
   public static CalculateStudentGrade(Student student, Course course){
      //grade logic...
   }

} 
```

# java - 如何在 Java EE 中实现通用队列监控组件？

> ID：738519
> 
> 赞同：2
> 
> 时间：2009-04-10T18:54:15.380
> 
> 标签：java, jakarta-ee, ejb-3.0

我想在 Java EE 5 应用程序中创建一个队列监控容器管理组件。该队列是一个数据库表，每隔 5 分钟左右，监视器会在该表中查找与特定条件匹配的记录。如果有任何匹配的记录，监视器就会在新线程中开始某种处理。只要应用程序启动并独立于任何客户端会话发生，这种睡眠检查工作循环就应该继续。

我应该看什么 EJB、Servlet 等来实现这种东西？我正在使用 Websphere 7，但理想情况下，该解决方案不会绑定到任何一个应用服务器。此外，JMS 不是一个选项。如果用 Java EE 容器管理的组件实现这一点并不简单，那么还有什么其他方法有意义？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T18:56:20.993

带有定时器服务的 EJB3。像这样的东西：

```
@Stateless
class MyBeanImpl implements MyBean {

    @Timeout
    public void myTimedOutMethod(Timer timer){

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:00:53.633

在 Java EE 容器中启动自己的线程并不是一个好主意。在 Websphere 中，您可以使用[Java EE Timers](http://www.onjava.com/pub/a/onjava/2004/10/13/j2ee-timers.html)。例如，如果您想要一个也适用于 Tomcat 的解决方案，您可以使用[Quartz](http://www.quartz-scheduler.org/)。

# objective-c - 布尔到 NSString

> ID：738524
> 
> 赞同：60
> 
> 时间：2009-04-10T18:56:31.117
> 
> 标签：objective-c, nsstring, boolean

如果我有一个返回 a 的方法`BOOL`，如何将其转换为 an`NSString`以便可以在控制台中打印出来？

例如，我尝试这样做，但它不起作用：

```
NSLog(@"Is Kind of NSString:", ([thing isKindOfClass:[NSString class]]) ? @"YES" : @"NO"); 
```

但我真的很想把返回值变成一个 NSString。我知道它是一种原始数据类型，所以我不能在它上面调用方法。我是否必须单独创建一个字符串，然后在 NSString 的方法中使用 Bool 作为参数？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-10T19:08:00.450

使用[三元运算符](http://en.wikipedia.org/wiki/?:#C)：

```
BOOl isKind= [thing isKindOfClass:[NSString class]];

NSLog(@"Is Kind of NSString: %d", isKind);
NSLog(@"Is Kind of NSString: %@", isKind ? @"YES" : @"NO"); 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-04-10T19:03:56.107

您的格式字符串中需要一个格式说明符：

```
NSLog(@"Is Kind of NSString: %@", ([thing isKindOfClass:[NSString class]]) ? @"YES" : @"NO"); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-02-23T02:09:14.717

在后台 BOOL 的行为类似于 int 类型，因此您可以使用 %i 在 NSLog 中测试 BOOL 类型的值：

```
BOOL a = YES;
BOOL b = NO;
NSLog(@"a is %i and b is %i", a, b);

// Output: a is 1 and b is 0 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2011-12-13T20:49:30.297

所以，我知道这真的很老了，但我想我不妨把我的解决方案扔进戒指。我愿意：

```
#define NSStringFromBOOL(aBOOL)    ((aBOOL) ? @"YES" : @"NO")
NSLog(@"Is Kind of NSString: %@", NSStringFromBOOL([thing isKindOfClass: [NSString class]]); 
```

我觉得这更符合 Apple 的一些 to-string 宏（`NSStringFromClass`、`NSStringFromRect`、`NSStringFromSelector`等），并且通常非常简单易用。只要确保将该宏放在全局可访问或经常导入的地方！

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-09-11T00:23:59.277

你像这样打印一个 BOOL：

```
NSLog(@"The BOOL value is %s", theBoolValue ? "YES" : "NO"); 
```

或者，使用新的`@`符号，可以这样做：

```
NSLog(@"The BOOL value is %@", @(theBoolValue)); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-10T19:06:11.530

NSLog 使用简单的 printf 样式调用格式化其文本，并且您的代码示例缺少嵌入对象所需的字符序列。

这应该有效：

```
NSLog(@"Is Kind of NSString: %@", ([thing isKindOfClass:[NSString class]]) ? @"YES" : @"NO"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-16T07:54:52.250

首先，您应该添加一个格式说明符`%@`。它应该如下所示：

```
NSLog(@"Is Kind of NSString: %@", ([thing isKindOfClass:[NSString class]]) ? @"YES" : @"NO"); 
```

您还可以像 Apple 使用 extern 函数一样提取从`BOOL`to的转换，等等。`NSString``NSStringFromCGRect``NSStringFromClass`

创建 utils 文件或将以下代码添加到现有文件头中：

```
//NSString+TypeConversion.h

extern NSString *NSStringFromBOOL(BOOL aBool); 
```

并将以下代码添加到实现中：

```
//NSString+TypeConversion.m

NSString *NSStringFromBOOL(BOOL aBool)
{
    return aBool ? @"YES" : @"NO";
} 
```

所以现在你可以在其他地方使用这个函数，你的代码变得更加清晰和可重用：

```
#import "NSString+TypesConversion.h"

NSLog(@"Is Kind of NSString: %@", NSStringFromBOOL([thing isKindOfClass:[NSString class]])); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-08-02T20:28:17.883

这对我有用：

```
NSLog(@"The BOOL value is %@", theBoolValue ? "YES" : "NO"); 
```

# c# - 通过代码将新项目添加到 WPF 功能区

> ID：738527
> 
> 赞同：4
> 
> 时间：2009-04-10T18:57:21.053
> 
> 标签：c#, wpf

我正在使用 WPF Office 功能区，并且我有一个内容视图，当该视图变为活动状态时，我希望将新项目添加到功能区。我有向我想要的组添加一个新的 RibbonCommand 和一个新的 RibbonButton 的代码，但是当我添加它时没有任何反应。但是，如果我使用按钮添加一个新组，它会很好并且正确绑定。有什么方法可以让它更新我失踪的吗？我已经尝试过 UpdateLayout() 并且它也不起作用。我真的很想尝试避免在每次视图更改时重建所有组。

作品：

```
public void InjectItems(IView view)
{
var ribbonCommands = ProcessRibbonCommands(view.GetViewModel().Tasks, view.GetType());
var group = new RibbonGroup();
group.Command = new RibbonCommand() { LabelTitle = "Group Test" };            

foreach (RibbonCommand command in ribbonCommands)
{
    shell.MainRibbon.Resources.Add(command.Name, command);
    group.Controls.Add(new RibbonButton { Command = command });
}

shell.MainRibbon.SelectedTab.Groups.Add(group);
} 
```

不工作：

```
public void InjectItems(IView view)
{
var ribbonCommands = ProcessRibbonCommands(view.GetViewModel().Tasks, view.GetType());
var group = shell.MainRibbon.SelectedTab.Groups[0]; //I have a default group, will fix later

foreach (RibbonCommand command in ribbonCommands)
{
    shell.MainRibbon.Resources.Add(command.Name, command);
    group.Controls.Add(new RibbonButton { Command = command });
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-25T02:42:53.970

我假设您使用的是 OfficeUI 站点中的 Microsoft Ribbon CTP。

作为许可协议的一部分，您应该遵循一些风格指南。其中之一是您不会根据当前视图添加/删除功能区的内容。

来自文档：

> 组中显示的控件不得因选择而改变。如果控件未处于活动状态，则该控件必须显示为灰色，而不是从组中删除。这提供了更可预测的体验，并防止功能区上的控件布局改变和分散用户的注意力。

话虽如此，听起来上下文选项卡正是您正在寻找的。这些可以禁用和启用，但选项卡的实际内容不会改变。

这是在 XAML 中创建上下文选项卡的代码：

```
<!--Context Groups-->
        <r:Ribbon.ContextualTabGroups>
            <!--Piece Contextual Group-->
            <r:RibbonContextualTabGroup x:Name="grpPieceContext" Label="Piece Tools">
                <r:RibbonTab Label="Piece Information" Name="tabPieceContextInfo">
                    <r:RibbonGroup Name="grpPieceDetails" Command="{StaticResource PieceInformationGrpCommand}">
                        <r:RibbonLabel x:Name="lblPieceTag"/>
                        <r:RibbonTextBox Name="txtPieceDescription" Command="{StaticResource PieceNameTextboxCommand}" 
                                         TextChanged="txtPieceDescription_TextChanged" MaxLength="32"/>
                        <r:RibbonLabel x:Name="lblPieceLocation"/>
                    </r:RibbonGroup>
                </r:RibbonTab>
            </r:RibbonContextualTabGroup>
        </r:Ribbon.ContextualTabGroups> 
```

然后，您可以通过以下代码激活和停用选项卡：

```
 if (!this.grpPieceContext.IsActive)
        {
            this.grpPieceContext.IsActive = true;
            this.grpPieceContext.Color = Colors.Orange;
        } 
```

其中橙色是位于上下文组后面的颜色。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-06T20:44:59.023

如有必要，我最终只是删除并重新创建了组和整个选项卡。

# javascript - 有人使用过 Django 和 JQuery 自动完成功能吗？

> ID：738529
> 
> 赞同：7
> 
> 时间：2009-04-10T18:57:46.370
> 
> 标签：javascript, jquery, django, autocomplete

有没有人使用过 Django 和 JQuery 自动完成功能？我坚持这一点，我将非常感谢看到其他人是如何做到这一点的！特别是不使用 AutocompleteWidget！

加思

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-22T13:01:51.080

[在这个django-autocomplete](http://github.com/henriquebastos/django-autocomplete)的 GitHub 镜像中有一些易于理解的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-04T21:19:38.537

前段时间我整理了一个关于这个的小教程，你可能会发现它很有用......它在[这里](http://www.michelepasin.org/techblog/?p=359)

# php - symfony中单个字段的多个条件？

> ID：738530
> 
> 赞同：2
> 
> 时间：2009-04-10T18:57:56.323
> 
> 标签：php, symfony1, propel

我正在尝试为 symfony 中的单个字段定义多个标准，但每次我定义第二个标准时，它都会覆盖前一个。这是我的代码示例：

```
 # build query to fetch search results
  $c = new Criteria();

  # set minimum price
  if($request->getPostParameter('price_from') > 0)
  {
    $c->add(HomeModelPeer::PRICE,
            $request->getPostParameter('price_from'),
            Criteria::GREATER_EQUAL);
  }

  # set maximum price
  if($request->getPostParameter('price_to') > 0)
  {
    $c->add(HomeModelPeer::PRICE,
            $request->getPostParameter('price_to'),
            Criteria::LESS_EQUAL);
  } 
```

有没有办法为每个字段定义多个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T19:12:36.977

对于同时有两个限制的情况，您需要执行以下操作：

```
$c = new Criteria();
$c2 = $c->getNewCriterion(HomeModelPeer::PRICE,
    $request->getPostParameter('price_from'),
    Criteria::GREATER_EQUAL);
$c2->addAnd($c->getNewCriterion(HomeModelPeer::PRICE,
    $request->getPostParameter('price_to'),
    Criteria::LESS_EQUAL)
    );
$c->add($c2); 
```

# ruby-on-rails - 我应该从 MVC 应用程序的视图中迭代业务对象吗？

> ID：738534
> 
> 赞同：0
> 
> 时间：2009-04-10T18:59:48.643
> 
> 标签：ruby-on-rails, ruby, model-view-controller

我想知道在使用 MVC 框架时我应该在视图中进行多少数据访问。例如：在我的应用程序中，有一个页面显示了我最喜欢的所有艺术家的列表，以及每个艺术家的所有歌曲列表。问题是：我应该只将艺术家列表传递给视图，还是应该同时传递所有数据（艺术家 + 歌曲）？

Ps：我正在使用 Ruby On Rails 和 ActiveRecord。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T23:59:14.277

不要在视图中提取数据库数据——这是控制器的工作。在您的视图中，您应该只引用控制器方法加载的数据。

在您的情况下，这意味着创建艺术家列表，使用`:include`这样的歌曲预加载。

```
# In your controller
@artists = Artist.find(:all, :include => :songs) 
```

**编辑**响应方法的评论，从视图中提取数据有两个问题：

*   关注点分离。当我说你“应该”只在控制器中提取数据时，这就是我所说的 - 在 MVC 中，控制器处理数据访问，理论上，视图不包含逻辑。有时将一些数据检索放在您的视图中当然更容易，但它很快就会变得丑陋。
*   效率，无论是查询数量还是查询结果大小，我认为这就是我们所说的方法。如果您在单个页面中加载了足够的数据，这会成为一个问题，我想知道这是否不建议进行一些重构（或至少是分页）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T19:16:44.237

假设 Artist 的模型类具有提供歌曲集合的方法，我认为没有理由要求控制器将两者都显式传递给视图。

# tdd - TDD ...如何？

> ID：738539
> 
> 赞同：9
> 
> 时间：2009-04-10T19:01:56.720
> 
> 标签：tdd

我即将开始我的第一个 TDD（测试驱动开发）程序，我（自然）有一个 TDD 心理障碍..所以我想知道是否有人可以帮助指导我应该从哪里开始。

我正在创建一个函数，该函数将从套接字读取二进制数据并将其数据解析为类对象。

据我所知，有3个部分：

1) 解析数据的逻辑 2) 套接字类 3) 类对象

我应该采取哪些步骤才能逐步进行 TDD？我绝对计划在实现功能之前先编写测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T20:16:09.583

TDD 中的问题是“为可测试性而设计”

首先，您必须有一个接口来编写测试。

要到达那里，您必须大致了解您的可测试单元是什么。

1.  某个类，由函数构建。

2.  某个函数，它从套接字读取并发出一个类。

其次，给定这个粗略的接口，您可以将其形式化为实际的非工作类和函数定义。

第三，您开始编写测试——知道它们会编译但会失败。

在此过程中，您可能会开始对您的功能感到头疼。你如何为你的函数设置一个套接字？那是脖子疼。

但是，您在上面粗略的界面不是法律，这只是一个好主意。如果你的函数接受一个字节数组并创建一个类对象怎么办？这很容易测试。

因此，重新审视这些步骤，更改接口，编写非工作类和函数，现在编写测试。

现在您可以填写类和函数，直到所有测试都通过。

当您完成这一点测试后，您所要做的就是挂上一个真正的套接字。你相信套接字库吗？（提示：你应该）这里没有太多要测试的。如果您不信任套接字库，那么现在您必须提供可以以受控方式运行的数据源。这是一个很大的痛苦。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T19:06:46.163

你的分裂听起来很合理。我认为这两个依赖项是输入和输出。你能让它们减少对具体生产代码的依赖吗？例如，你可以让它从一般的数据流而不是套接字中读取吗？这将使传递测试数据更容易。

返回值的创建可能更难模拟，并且无论如何可能都不是问题 - 用于结果对象的实际填充的逻辑是否相当简单（在解析之后）？例如，它基本上只是设置琐碎的属性吗？如果是这样，我不会费心尝试在那里介绍工​​厂等 - 只需输入一些测试数据并检查结果即可。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-11T08:24:28.257

首先，开始思考“the testS”，复数，而不是“the test”，单数。你应该期望写不止一个。

其次，如果您有心理障碍，请考虑从更简单的挑战开始。降低难度，直到它真的很容易做到，然后继续进行更实质性的工作。

例如，假设您已经有一个包含二进制数据的字节数组，所以您甚至不需要考虑套接字。您需要编写的只是接受 byte[] 并返回对象实例的内容。你能为此写一个测试吗？

如果您仍然有精神障碍，请再降低一个档次。假设您的字节数组无论如何都只会包含默认值。因此，您甚至不必担心解析，只需能够返回所有值都设置为默认值的对象实例。你能为此写一个测试吗？

我想像：

```
公共无效 testFooReaderCanParseDefaultFoo() {
  FooReader fr = new FooReader();
  Foo myFoo = fr.buildFoo();
  assertEquals(0, myFoo.bar());
}

```

那是谷底，对吧？您只是在测试 Foo 构造函数。但是您可以升级到下一个级别：

```
公共无效 testFooReaderGivenBytesBuildsFoo() {
  FooReader fr = new FooReader();
  字节[] fooData = {1};
  fr.consumeBytes(fooData);
  Foo myFoo = fr.buildFoo();
  assertEquals(1, myFoo.bar());
}

```

等等...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-31T01:15:35.693

“最好的测试框架是应用程序本身”

我相信开发人员之间的一个常见误解是，他们错误地在测试框架和 TDD 原则之间建立了紧密的联系。我建议重新阅读有关 TDD 的官方文档；请记住，测试框架和 TDD 之间没有真正的关系。毕竟，TDD 是一个范式而不是一个框架。

在阅读有关 TDD 的 wiki ( [https://en.wikipedia.org/wiki/Test-driven_development](https://en.wikipedia.org/wiki/Test-driven_development) ) 后，我开始意识到，在某种程度上，事情有点容易解释。

TDD 有多种个人风格，主要是因为 TDD 原则是可以解释的。

我不是在这里说任何人是错的，但我想与您分享我的技术并解释它们如何为我服务。请记住，我已经编程了 36 年；使我的编程习惯得到了很好的发展。

1.  代码重用被高估了。过多地重用代码，你最终会得到糟糕的抽象，并且在不影响其他内容的情况下修复或更改某些内容将变得非常困难。明显的优势是管理的代码更少。

2.  重复过多的代码会导致代码管理问题和过大的代码库。然而，它确实具有良好分离关注点的优势（能够在不影响应用程序其他部分的情况下调整、更改和修复事物）。

3.  不要重复/重构太多，不要重复使用太多。代码需要可维护。理解和尊重代码重用和关注点的抽象/分离之间的平衡很重要。

在决定是否重用代码时，我的决定基于： .... 此代码的性质是否会在整个应用程序代码库的上下文中发生变化？如果答案是否定的，那么我会重复使用它。如果答案是肯定的或者我不确定，我会重复/重构它。但是，我会不时修改我的代码库，看看是否可以合并我的任何重复代码，而不会影响关注点/抽象的分离。

就我的基本编程习惯而言，我喜欢先写条件（if then else switch case等）；测试它们，然后用代码填充条件并再次测试。请记住，没有规定您必须在单元测试中执行此操作。我把它称为低级的东西。一旦我的低级工作完成，我将重用代码或将其重构到应用程序的另一部分，但不是在非常彻底地测试之后。重复/重构经过严格测试的代码的问题在于，如果它被破坏了，你必须在多个地方修复它。

BDD 对我来说是 TDD 的自然后续。一旦我的代码库经过良好测试，我可以通过移动整个代码块来轻松调整行为。很酷的一点是我的编程习惯是有时我会移动代码并发现我什至不想要的有用行为。有时它甚至可以用于将东西重新命名为看起来像一个完全不同的代码库。

为此，我的代码库在开始时往往会有点慢，但随着开发接近尾声，我有越来越多的代码需要重构或重用。

我编码的方式对我来说的好处是，我能够承担非常高的复杂性，因为这是通过良好的关注点分离来促进的。编写高度优化的代码也很棒。然而，优化良好的代码往往有点臃肿，但据我所知，没有办法编写优化的代码而不会有点臃肿。如果应用程序不需要高处理器效率，那么没有什么能阻止我消除代码膨胀。我认为应该优化服务器端代码，而大多数客户端代码通常不需要它。

回到测试框架的话题，我使用它们只是为了节省一点编译时间。

就以下故事板而言，这对我来说很自然，没有真正考虑过。我注意到大多数开发人员都是按照故事板的自然顺序开发的，即使它们不可用。

作为一般的关注点分离策略，在大多数应用程序中，我根据 UI 表单分离关注点。例如，我将在表单中重用代码并跨表单重复/重构。这只是一般规则。有时我必须跳出框框思考。有时重复代码可以很好地提高代码处理器的效率。

作为我 TDD 习惯的一个小补充；我最后做优化和容错。我将尽量避免使用 try catch 块，并以不需要它们的方式编写我的代码。例如，我不会捕获空值，而是检查空值，或者不是捕获越界的索引，而是仔细检查我的代码，使其永远不会发生。我发现在应用程序开发中过早捕获错误会导致语义错误（不会导致应用程序崩溃的行为错误）。语义错误很难追踪甚至注意到。那是我的 10 美分。希望能帮助到你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T19:07:38.017

测试驱动开发？所以，这意味着你应该先写一个测试。

编写一个测试，其中包含“你想如何使用你的课程”之类的代码。您将要使用此测试进行测试的此类或方法甚至还不存在。

例如，您可以先编写一个测试，如下所示：

```
[Test]
public void CanReadDataFromSocket()
{
     SocketReader r = new SocketReader( ... ); // create a socketreader instance which takes a socket or a mock-socket in its constructor

     byte[] data = r.Read();

     Assert.IsTrue (data.Length > 0);
} 
```

例如; 我这里只是举个例子。接下来，一旦您能够从套接字读取数据，您就可以开始考虑如何解析它，并在使用“解析器”类的地方编写一个测试，该类获取您已读取的数据，并且输出数据类的实例。ETC...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-24T12:17:45.647

在使用 TDD 时，知道从哪里开始编写测试以及何时停止编写测试是刚开始时的一个常见问题。

我发现有时先编写**集成测试**会有所帮助。这样做将有助于创建您将使用的一些常见对象。它还可以让您专注于您的想法和测试，因为您需要开始编写测试以使集成测试通过。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-31T10:18:04.883

当我开始使用 TDD 时，我阅读了 Bob 叔叔的这 3 条规则，这对我很有帮助：

> 1.  除非是为了通过失败的单元测试，否则您不得编写任何生产代码。
> 2.  不允许您编写任何足以导致失败的单元测试；编译失败就是失败。
> 3.  不允许您编写任何超过足以通过一个失败的单元测试的生产代码。

在较短的版本中，它将是：

> 1.  只写足够的单元测试以使其失败。
> 2.  只编写足够的生产代码以使失败的单元测试通过。

如您所见，这非常简单。

# .net - 如何在 .Net/Mono 中解码 wav、mp3 和/或 ogg？

> ID：738541
> 
> 赞同：5
> 
> 时间：2009-04-10T19:02:57.170
> 
> 标签：.net, mono, mp3, wav, oggvorbis

我正在寻找一种跨平台（Windows、MacOSX 和 Linux 上的 .Net 和 Mono）方法来解码 wav、mp3 或 ogg 文件，以便我可以根据需要通过 DirectSound 或 OpenAL 播放解码的流。

可以解码 mp3 或 ogg 的解决方案就足够了 - 无需同时解码两者。如果它（或其他解决方案）也可以解码 wav，那将是理想的，但不是绝对必要的，因为我可能会将我的 wav 文件转换为 mp3 或 ogg。

只能解码wav文件的解决方案只是部分解决方案，但我会尽我所能。;-)

这是我已经看过的内容：

*   DirectSound 和 Alut 都支持 WAV 解码，但 Alut 已被弃用。
*   ffmpeg 几乎可以解码任何东西，但它似乎没有跨平台的通用稳定版本？
*   我还没有尝试过 csvorbis，但它已经很老了，我不确定它的当前状态是什么。

非常欢迎您尝试说服我上述解决方案之一实际上是最佳选择。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-18T22:25:56.247

你没有提到你正在寻找的那种许可。我使用[FMOD](http://www.fmod.org/index.php/download)取得了出色的成绩，它可免费用于非商业项目。它播放多种格式，包括 ogg 和 mp3，并具有用于控制播放方式的广泛 API。它是跨平台的，就像您需要的那样。

FMOD很大程度上针对游戏；如果它已经具有出色的 3D 功能，我不会感到惊讶（尽管我不确定）。

如您所知，我非常喜欢，这主要是因为让一个空白的 C# 项目第一次播放 OGG 文件非常轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:21:42.647

您应该能够使用 System.Media.SoundPlayer 直接播放 .wav 文件。不确定这是否有助于您的用例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T07:52:30.533

对于 WAV 文件的简单支持，您可以在 mcs/class/System/System.Media/AudioData.cs 中查看单声道的实现（[http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/System/System .媒体/](http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/System/System.Media/)）。

要解码 ogg 音频文件，您可以查看 mono 的 sn 服务器中的 csvorbis 模块：http: [//anonsvn.mono-project.com/viewvc/trunk/csvorbis/](http://anonsvn.mono-project.com/viewvc/trunk/csvorbis/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T19:20:05.850

我与 ffmpeg 一起工作，到目前为止我喜欢它。是的，跨版本几乎没有问题，但它是最有效的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T12:58:49.253

为了部分回答我自己的问题，事实证明编写自己的 WAV 加载器非常容易。我使用了这篇描述 wav 文件格式的文章：

[http://www.sonicspot.com/guide/wavefiles.html](http://www.sonicspot.com/guide/wavefiles.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-19T01:50:54.513

与往常一样，fmod 是您的答案...请随时在[http://www.fmod.org/index.php/download#FMODExProgrammersAPI上解决您的所有问题](http://www.fmod.org/index.php/download#FMODExProgrammersAPI)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-25T15:00:01.850

wav 文件具有结构 44 字节的起始音频信号。如果读取 44-to end 文件音频数据（wav 文件）你已经在 .NET（opeanl）中播放你的音乐 `https://dpaste.com/8VNKMAUU5`

```
public static void playwav()
    {
        Console.WriteLine("Hello World!");

        OpenTK.Audio.OpenAL.ALDevice device = OpenTK.Audio.OpenAL.ALDevice.Null;
        OpenTK.Audio.OpenAL.ALContext ctx = OpenTK.Audio.OpenAL.ALContext.Null;

        string defname = OpenTK.Audio.OpenAL.ALC.GetString(device, OpenTK.Audio.OpenAL.AlcGetString.DefaultDeviceSpecifier);
        Console.WriteLine(defname);
        device = OpenTK.Audio.OpenAL.ALC.OpenDevice(defname);

        if (!OpenTK.Audio.OpenAL.ALC.IsExtensionPresent(device, "ALC_EXT_EFX"))
            return;
        int[] atrributes = { 0, 0, 0, 0 };
        int[] iSends = { 0 };
        atrributes[0] = ((int)OpenTK.Audio.OpenAL.AlcContextAttributes.EfxMaxAuxiliarySends);
        atrributes[1] = 4;

        Console.WriteLine("EFX Extension found!\n");

        ctx = OpenTK.Audio.OpenAL.ALC.CreateContext(device, atrributes);

        OpenTK.Audio.OpenAL.ALC.MakeContextCurrent(ctx);
        OpenTK.Audio.OpenAL.ALC.ProcessContext(ctx);

        OpenTK.Audio.OpenAL.ALC.GetInteger(device, OpenTK.Audio.OpenAL.AlcGetInteger.EfxMaxAuxiliarySends, 1, iSends);

        //OpenTK.Audio.OpenAL.AL.GetProcAddress("LPALGENEFFECTS"); 

        int buffer;

        string str = @"C:\WorkC#\ConsoleApp3\ConsoleApp3\20211222-204048_.wav";
        //Microsoft.Win32.SafeHandles.SafeFileHandle safeFileHandle = new Microsoft.Win32.SafeHandles.SafeFileHandle("20211222-204048_.wav",true);
        FileStream fileStream = File.OpenRead(str);

        byte[] bufdata = new byte[fileStream.Length];
        //bufdata[0] = 0;
        byte[] RIFF = new byte[4];
        byte[] sizeRid = new byte[4];
        byte[] WAVE = new byte[4];
        byte[] FMT = new byte[4];
        fileStream.Read(RIFF, 0, 4);
        fileStream.Read(sizeRid, 0, 4);
        fileStream.Read(WAVE, 0, 4);
        fileStream.Read(FMT, 0, 4);

        fileStream.Read(bufdata, 44, (int)(fileStream.Length - 45));

        OpenTK.Audio.OpenAL.AL.GenBuffer(out buffer);

        UInt16 value = BitConverter.ToUInt16(RIFF, 0);

        Console.WriteLine(((char)value));
        Console.WriteLine(sizeRid.Length);
        Console.WriteLine(WAVE.Length);
        OpenTK.Audio.OpenAL.AL.BufferData(buffer, OpenTK.Audio.OpenAL.ALFormat.Stereo16, bufdata, 44100);

        Console.WriteLine((bufdata));

        int src;
        OpenTK.Audio.OpenAL.AL.GenSource(out src);
        OpenTK.Audio.OpenAL.AL.Source(src, OpenTK.Audio.OpenAL.ALSourcei.Buffer, buffer);
        OpenTK.Audio.OpenAL.AL.SourcePlay(src);
        int state = 4114;

        while (state == (int)OpenTK.Audio.OpenAL.ALSourceState.Playing)
        {
            OpenTK.Audio.OpenAL.AL.GetSource(src, OpenTK.Audio.OpenAL.ALGetSourcei.SourceState, out state);
            Console.Write(state + "\r");
            //int state = (int)OpenTK.Audio.OpenAL.ALSourceState.Playing;
            //OpenTK.Audio.OpenAL.AL.SourcePlay(src);
        }

        OpenTK.Audio.OpenAL.ALC.DestroyContext(ctx);
        OpenTK.Audio.OpenAL.ALC.CloseDevice(device);

        //OpenTK.Audio.OpenAL.ALC.GetContextsDevice();
    } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-05-29T02:23:46.220

[https://sites.google.com/site/cobnut3d/](https://sites.google.com/site/cobnut3d/)

SlimDX.DirectSound - 是 C# 的代码示例。

# c# - 如何从 .NET RegEx 中提取子字符串？

> ID：738543
> 
> 赞同：50
> 
> 时间：2009-04-10T19:03:27.420
> 
> 标签：c#, .net, regex

我有一个包含一个（或多个）键/值对的 XML 文件。对于这些对中的每一对，我想提取一个两字节十六进制值的值。

所以 XML 包含这个片段：

```
<key>LibID</key><val>A67A</val> 
```

我可以使用以下表达式进行匹配，括号中为 ID。

```
Match match = Regex.Match(content, @"<key>LibID</key><val>([a-fA-F0-9]{4})</val>");

if (match.Success)
{
  Console.WriteLine("Found Match for {0}\n", match.Value);
  Console.WriteLine("ID was {0}\n", "Help me SO!");
} 
```

如何更改最后一部分，使其返回匹配的 ID？

干杯!

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-10T19:08:16.330

我想你想要

```
match.Groups[1].Value 
```

（正如 Dillie-O 在评论中指出的那样，这是第 1 组，因为第 0 组始终是整场比赛。）

简短但完整的测试程序：

```
using System;
using System.Text.RegularExpressions;

class Program
{
  static void Main()
  {
    Regex regex = new Regex("<key>LibID</key><val>([a-fA-F0-9]{4})</val>");
    Match match = regex.Match("Before<key>LibID</key><val>A67A</val>After");

    if (match.Success)
    {
      Console.WriteLine("Found Match for {0}", match.Value);
      Console.WriteLine("ID was {0}", match.Groups[1].Value);
    }      
  }
} 
```

输出：

```
Found Match for <key>LibID</key><val>A67A</val>
ID was A67A 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T19:12:42.280

将[分组构造](http://msdn.microsoft.com/en-us/library/bs2twtah(VS.71).aspx)添加到您的表达式中...

```
<key>(?<id>LibID)</key><val>([a-fA-F0-9]{4})</val> 
```

这将捕获ID。但是，您需要在实际 ID 的表达式中输入正确的格式，因为您的正则表达式只会逐字捕获“LibID”。

# javascript - Javascript：onrefresh 还是 onreload？

> ID：738546
> 
> 赞同：6
> 
> 时间：2009-04-10T19:03:56.200
> 
> 标签：javascript

我想要一个在用户点击重新加载时触发的事件处理程序。onrefresh 或 onreload 是要添加的正确处理程序吗？此外，这甚至会在 onunload 之前或之后触发吗？是否存在浏览器不一致？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T19:10:45.200

我认为没有称为 onrefresh 或 onreload 的事件。您可以知道页面何时卸载，但知道原因（即用户接下来要去哪里）超出了 JavaScript 的安全沙箱。知道页面是否已经重新加载的唯一方法是知道用户在最后一个页面请求上的位置，这也超出了 JavaScript 的范围。您有时可以通过 获取该`document.referrer`信息，但它依赖于浏览器的安全设置来允许访问该信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-04T12:41:54.317

WindowEventHandlers.onbeforeunload 事件处理程序属性包含在发送 beforeunload 时执行的代码。此事件在窗口即将卸载其资源时触发。

```
window.onbeforeunload = function () {
   return 'Are you sure you want to leave?';
} 
```

这将向用户显示一个确认对话框，其中包含您在函数中返回的消息。它会给用户一个离开这个页面或取消的选项。

没有办法绕过确认，因为它可能被用于恶意原因。

[https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload](https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T19:17:53.953

如果您将设置 cookie 与特定页面的 cookie 结合起来，并检查 onload 事件，您可以模拟您寻找的不存在的事件。您可以调整 cookie 过期时间，以便仅当初始加载是某个时间间隔之前才计算重新加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T19:13:47.957

我知道没有 onreload 或 onrefresh 事件。当然，对于在浏览器中运行的 javascript，这没什么意义。现有窗口及其所有内容被有效地丢弃。因此，您需要使用现有上下文的 onunload 或作为重新加载结果创建的新上下文的加载事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T21:12:17.467

我确实相信 artlung 可能确实找到了一种方法，实际上……然而，他的版本依赖于 cookie，而这些可以通过多种方式停止使用；那么，解决方案是使用您选择的服务器端语言来保存`unload`通过 JavaScript 编辑页面时的时间戳（仍然是一个漏洞，是的，但为什么不在那里提出另一个想法，嗯？）然后测试每次页面加载时再次执行；如果您检测不到几秒钟的差异，则用户可能只是重新加载了您的页面。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-10T12:53:51.777

可以使用会话。比 cookie 更容易，并且不必担心过期或数据库。这将涵盖除第一个页面之外的任何页面。我认为会话超全局直到第二页才可用。如果这是一个问题，您可以启动会话并在没有活动会话时立即重新加载页面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-09T08:42:56.073

它的 onunload 因为当您点击刷新时浏览器“卸载”然后再次加载

# iphone - What are the best tools for unit testing iphone applications?

> ID：738547
> 
> 赞同：6
> 
> 时间：2009-04-10T19:04:04.017
> 
> 标签：iphone, objective-c, unit-testing

Wondering which tool is considered the best/standard and what the pros/cons are for the various unit testing tools that are available. The tools I'm aware of so far are:

*   [Google Toolbox for Mac](http://code.google.com/p/google-toolbox-for-mac/)
*   [OCUnit](http://www.sente.ch/software/ocunit/) which seems to be the [winner for objective-c](https://stackoverflow.com/questions/33207/what-is-the-best-way-to-unit-test-objective-c-code), but some folks have had [trouble](https://stackoverflow.com/questions/159280/do-ocunit-and-ocmock-work-on-the-iphone-sdk) with on the iphone
*   [rbiphonetest](http://github.com/drnic/rbiphonetest/tree/master) which Dr Nic comments on [here](https://stackoverflow.com/questions/195820/test-driven-design-for-iphone-native-apps/277777#277777)

Of course I'd love to learn about any I've missed.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T21:16:51.047

Google toolbox for Mac(GTM) 是 OCUnit 的超集。它添加了更多的断言宏，并且还支持 UI 测试。OCMock 是您可以将模拟对象合并到单元测试环境中的方法。

我最近刚刚创建了一个用于创建静态库的项目和文件模板，该静态库还内置了对单元测试的支持。你可以阅读它：

[http://www.codingventures.com/2009/04/xcode-templates-for-iphone-static-libraries-with-unit-testing/](http://www.codingventures.com/2009/04/xcode-templates-for-iphone-static-libraries-with-unit-testing/)

模板位于：

[http://github.com/keremk/iphone-static-library-project-template/tree/master](http://github.com/keremk/iphone-static-library-project-template/tree/master)

文件模板为您提供了一种简单的方法来添加具有所有必要 OCMock 和 GTM/OCUnit 标头的单元测试类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:53:41.417

您可能对以下问题的答案感兴趣：[OCUnit 和 OCMock 是否适用于 iPhone SDK？](https://stackoverflow.com/questions/159280/do-ocunit-and-ocmock-work-on-the-iphone-sdk). 一些简短的链接：

*   [OCMock 和 iPhone](http://iamthewalr.us/blog/2008/11/10/ocmock-and-the-iphone/)
*   [iPhone单元测试](http://code.google.com/p/google-toolbox-for-mac/wiki/iPhoneUnitTesting)
*   [斯坦福 iPhone 应用程序编程 CS193P](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)
*   [在 Leopard 中使用 OCMock 和 Xcode 3](http://mitchellhashimoto.com/using-ocmock-with-xcode-3-in-leopard/)
*   [iPhone 单元测试 | 森：特](http://www.sente.ch/s/?p=535&lang=en)

# c# - Call function from DLL with non-static path

> ID：738555
> 
> 赞同：1
> 
> 时间：2009-04-10T19:06:13.403
> 
> 标签：c#, .net, dll, interop, runtime

I have a DLL that I need to access methods from.

In most cases like this I just use [DllImport] to access methods from unmanaged assemblies, but the problem with that in this situation is that it requires the path to the DLL at instantiation time, so a constant string.

This particular DLL is one that gets installed with my application and I can't guarantee where it will be after the program is installed (I'd rather not put it somewhere static like %SystemRoot%).

So is there a way in C# that I can declare and use a method from a DLL at runtime with a variable path?

Any ideas or suggestions would be greatly appreciated!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T19:22:56.233

根本不要使用路径。Windows 在尝试从动态或静态加载函数时使用搜索 DLL 的默认方法。

确切的搜索逻辑记录在 MSDN 的[LoadLibrary](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)文档中- 基本上，如果 DLL 仅由您的应用程序使用，则在安装期间将其放在与您的应用程序相同的文件夹中，不用担心。如果是常用的 DLL，把它放在 LoadLibrary() 搜索到的文件夹结构中的某个位置，它就会被找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T20:00:30.450

这有点hack，但是既然你说你可以在运行时找到dll的路径，为什么不在你使用任何函数之前将它复制到你当前的工作目录呢？这样，dll 将存在于您的 exe 旁边，并且会被 LoadLibrary 找到。在您的 DllImport 中不需要任何其他路径。

使用动态路径中的方法的唯一其他方法是执行以下操作： 1) 为[LoadLibrary](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)和[GetProcAddress](http://msdn.microsoft.com/en-us/library/ms683212(VS.85).aspx)
执行必要的 P/Invoke 签名 2) 从所需路径加载库 (LoadLibrary) 3) 找到所需的函数 (GetProcAddress ) 4) 将指针投射到委托[Marshal.GetDelegateForFunctionPointer](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getdelegateforfunctionpointer(vs.80).aspx) 5) 调用它。

当然，您需要以这种方式为要“导入”的每个函数声明一个委托，因为您必须将指针转换为委托。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-14T13:43:05.770

我也有类似的情况。我使用安装在机器上的 SDK 中的 DLL。我从该 SDK 注册表项中获取 DLL 的目录位置。我在执行用户的 PATH 变量上设置了 DLL 位置（仅临时修改）。基本上，它允许您为要调用的 DLL 设置动态路径，因此不必来自注册表。请注意 PATH 变量是 Windows 查找 DLL 的最后一个位置。但另一方面，它不会改变 Windows 查找 DLL 的其他位置。

例子：

我想在 DLL 上调用的 API：

```
[DllImport("My.DLL")]
private static extern IntPtr ApiCall(int param); 
```

获取注册表项（您需要*使用 Microsoft.Win32;*）：

```
private static string GetRegistryKeyPath() {
        string environmentPath = null;

        using (var rk = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\SOMENNAME"))
        {
            if (rk != null)
            {
                environmentPath = rk.GetValue("Path(or whatever your key is)").ToString();
            }
            if (string.IsNullOrEmpty(environmentPath))
            {
                Log.Warn(
                    string.Format("Path not found in Windows registry, using key: {0}. Will default to {1}",
                         @"SOFTWARE\SOMETHING", @"C:\DefaultPath"));
                environmentPath = @"C:\DefaultPath";
            }
        }
        return environmentPath;
     } 
```

在 PATH var 上添加 DLL 的路径（Concat() 在 Linq 中找到）：

```
void UpdatePath(IEnumerable<string> paths){
    var path = new[] { Environment.GetEnvironmentVariable("PATH") ?? "" };
    path = path.Concat(paths);
    string modified = string.Join(Path.PathSeparator.ToString(), path);
    Environment.SetEnvironmentVariable("PATH", modified);
} 
```

开始使用 API 调用：

```
var sdkPathToAdd = GetRegistryKeyPath();
IList<string> paths = new List<string>
        {
            Path.Combine(sdkPathToAdd),
            Path.Combine("c:\anotherPath")
        };
UpdatePath(paths);

//Start using
ApiCall(int numberOfEyes); 
```

# c++ - Handling Interrupt in C++

> ID：738564
> 
> 赞同：2
> 
> 时间：2009-04-10T19:09:03.240
> 
> 标签：c++, synchronization, interrupt

I am writing a framework for an embedded device which has the ability to run multiple applications. When switching between apps how can I ensure that the state of my current application is cleaned up correctly? For example, say I am running through an intensive loop in one application and a request is made to run a second app while that loop has not yet finished. I cannot delete the object containing the loop until the loop has finished, yet I am unsure how to ensure the looping object is in a state ready to be deleted. Do I need some kind of polling mechanism or event callback which notifies me when it has completed?

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T19:33:00.593

通常，如果您需要执行此类操作，您将拥有一个可以处理多个任务的 OS/RTOS（即使操作系统是简单的自制类型的东西）。

如果您还没有 RTOS，您可能想研究一个（有数百个可用）或考虑合并一些简单的东西，如 protothreads：[http ://www.sics.se/~adam/pt/](http://www.sics.se/~adam/pt/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:36:20.973

所以你有两个线程：一个运行内核，一个运行应用程序？您需要在内核中创建一个函数，说 ReadyToYield()，应用程序可以在您愿意关闭它时调用它。ReadyToYield() 将标记内核线程以向其提供好消息，然后坐下来等待内核线程决定要做什么。它可能看起来像这样：

```
volatile bool appWaitingOnKernel = false;
volatile bool continueWaitingForKernel; 
```

在应用程序线程调用上：

```
void ReadyToYield(void)
{
    continueWaitingForKernel = true;
    appWaitingOnKernel = true;
    while(continueWaitingForKernel == true);
} 
```

在内核线程调用上：

```
void CheckForWaitingApp(void)
{
    if(appWaitingOnKernel == true)
    {
        appWaitingOnKernel = false;

        if(needToDeleteApp)
            DeleteApp();
        else
            continueWaitingForKernel = false;
    }
} 
```

显然，这里的实际实现取决于底层的 O/S，但这是要点。

约翰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T19:49:38.820

(1) 你需要编写线程安全的代码。这并不特定于嵌入式系统。

(2) 进行上下文切换时需要将状态保存起来。

# .net - Asp.net, Linq Error: 'int' is a 'type' but is used like a 'variable'

> ID：738567
> 
> 赞同：0
> 
> 时间：2009-04-10T19:10:21.020
> 
> 标签：.net, asp.net, linq, ado.net

i am using asp.net and link to display a set of books from the db. n it gives me an error

```
Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately.

Compiler Error Message: CS0118: 'int' is a 'type' but is used like a 'variable'

Source Error:

Line 48:         using(MobileBooksDataContext categoryList = new MobileBooksDataContext())
Line 49:         {
Line 50:             int catID = Int32(CategoryName.SelectedItem); 
Line 51:             var newBookList = from b in categoryList.team5_bookmobiles
Line 52:                               where(b.ca_id == catID)

protected void getBookList()
    {

        using(MobileBooksDataContext categoryList = new MobileBooksDataContext())
        {
            int catID = Int32(CategoryName.SelectedItem); 
            var newBookList = from b in categoryList.team5_bookmobiles
                              where(b.ca_id == catID)
                            select new
                            {
                                lblBook_name = b.book_name,
                                lblBook_author = b.book_author,
                                lblBook_shortdesc = b.book_short_desc
                            };

            lv_Books.DataSource = newBookList;
            lv_Books.DataBind();
        }
    }

    protected void btn_Select_Click(object sender, EventArgs e)
    {
        getBookList();
    } 
```

i take the category id from a drop down list and match it against the category id of books that is in a different table.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T20:10:21.080

我认为应该是：

```
int catID = Int32.Parse(CategoryName.SelectedValue.ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:11:50.877

What if you changed

```
int catID = Int32(CategoryName.SelectedItem); 
```

to

```
int catID = Int32.Parse(CategoryName.SelectedItem); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T19:11:56.773

Line 50 is using the Int32 constructor like a function. Change `Int32(CategoryName.SelectedItem)` to `new Int32(CategoryName.SelectedItem)`, or just cast to int using `(Int32)(CategoryName.SelectedItem)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T19:27:01.293

只是为了安全起见：

```
int catID = Int32.Parse(CategoryName.SelectedItem.ToString()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T20:13:35.347

如果您使用 DataBinding，SelectedItem 很可能是被数据绑定的对象。你可以使用它，但你必须先施放它。这在性能方面可能会更好，因为您不必执行字符串解析来获取您的类别 ID。

或者，您可以使用您可能已使用数据绑定向导配置的属性 DropDownList.SelectedValue 或控件声明上的属性 DataValueField。

无论哪种方式，您都不能使用类似 C++ 或 VB 的语法使用 C# 执行转换为 Int32。

如果您使用 SelectedValue 属性，您将拥有一个字符串并将其转换为 Int32，您必须编写如下内容：

```
var value = Int32.Parse(CategoryName.SelectedValue, CultureInfo.InvariantCulture); 
```

# css - SIFR'ing parents only

> ID：738568
> 
> 赞同：0
> 
> 时间：2009-04-10T19:10:32.130
> 
> 标签：css, css-selectors, sifr

I'm using SIFR 3.0 in combination with suckerfish popup menus. I only want to SIFR the top level li's and not apply the effect to the nested ones. I'm also using WordPress, so restructuring the menu, like wrapping the parent in a <div> or other object is too hard (I'm still figuring out the basics of WordPress).

Is there a way to turn SIFR ON for ul#menu li but OFF for ul#menu li li ?

Other things I've tried that haven't worked is applying a class or id to the parent <li class="top-level"> or <li id="top-level">--that didn't stop the SIFR, it still grabbed the children.

Thanks so much for the help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T15:23:03.423

我将假设您的 HTML 结构是这样的：

```
<ul id="menu">
  <li>
    <a href="/">My link</a>
    <ul>
      <li>My submenu item</li>
    </ul>
  </li>
</ul> 
```

当您替换时`ul#menu li`，您将替换元素的全部内容`<li>`。不幸的是，这也包括子菜单。解决方案是仅替换链接，但请注意不能直接替换`<a>`元素。

所以：

```
<ul id="menu">
  <li>
    <span><a href="/">My link</a></span>
    <ul>
      <li>My submenu item</li>
    </ul>
  </li>
</ul> 
```

并更换`ul#menu > li span`.

最后还有一个问题，如果事件必须通过 sIFR，Suckerfish 菜单是否真的有效。我怀疑它不会，这意味着你最好不要在这里使用 sIFR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T19:41:48.170

这可以通过 CSS 子选择器来完成：

```
ul#menu > li 
```

这只会选择.`li`的直接子元素`ul#menu`。这应该适用于所有符合标准的浏览器和 IE7+。

对于 IE6，你可以做一些 hack 来伪造它，虽然我更喜欢使用 jQuery 来弥补它不支持的选择器：

```
$('ul#menu > li').css({ ... }); 
```

您可以将其放在条件注释中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-11T09:32:52.960

如果您下载未压缩的 sifr 源代码，并且还拥有 jQuery 或擅长使用 javascript，您可能可以在 sifr 代码的第 491 行附近添加一个条件

```
if ($(node).parent().parent().parent().attr('id', 'menu')) {continue;} 
```

我不擅长 jQuery，我也不确定 sifr 运行的节点是什么类型的对象，但理论上类似上面的东西应该让你想要的东西成为可能。

# c# - Visual Studio 2005：列表 .First() 列表 C# 中的 .Last() 方法？

> ID：738569
> 
> 赞同：4
> 
> 时间：2009-04-10T19:10:39.523
> 
> 标签：c#, .net, visual-studio-2005

我在我的 VS 2008 C# 项目中`List<T>.First()`也使用过`List<T>.Last()`，但是当我降级到 2005 时，我遇到了这样的错误：

“System.Collections.Generic.List”不包含“First”的定义

据我了解，如果仍然有**Find()**和**FindLast()**方法，那么必须有一种非常简单的方法来获取第一个和最后一个值的迭代器，对吗？但我坚持这一点，找不到任何有用的东西:(

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T19:12:48.783

`First()`并且`Last()`是 LINQ 的一部分，这就是为什么在您的 VS 2005 项目中找不到它们的原因。

如果您使用的是 a`List<T>`它真的*非常*容易找到第一个和最后一个值，假设列表是非空的：

```
T first = list[0];
T last = list[list.Count-1]; 
```

如果你真的需要使用迭代器，你可以很容易地实现 LINQ 方法：

```
public static T First<T>(IEnumerable<T> source)
{
    foreach (T element in source)
    {
        return element;
    }
    throw new InvalidOperationException("Empty list");
}

public static T Last<T>(IEnumerable<T> source)
{
    T last = default(T);
    bool gotAny = false;
    foreach (T element in source)
    {
        last = element;
        gotAny = true;
    }
    if (!gotAny)
    {
        throw new InvalidOperationException("Empty list");
    }
    return last;
} 
```

`Last`（我怀疑检查是否`source`是 a的真正实现，如果是则`IList<T>`返回`list[list.Count-1]`，以避免遍历整个集合。）

正如评论中所指出的，这些不是扩展方法——你会写：

```
// Assuming the method is in a CollectionHelpers class.
Foo first = CollectionHelpers.First(list); 
```

代替

```
Foo first = list.First(); 
```

但效果是一样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T19:13:20.890

这里有2个问题

1.  First 和 Last 都是扩展方法。VS2005 中包含的编译器不支持扩展方法，因此无法绑定到它们
2.  First 和 Last 方法包含在 VS2005 中无法使用的 3.5 框架中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T19:16:20.353

`First`不是一种方法`List<T>`。 [首先](http://msdn.microsoft.com/en-us/library/bb291976.aspx)`System.Linq.Enumerable`是.net 3.5 中的静态方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T19:18:01.657

这些是扩展方法。您提出了一个针对扩展方法的典型案例，而它们可能会令人困惑，因为它们似乎属于该类，但实际上完全是在其他地方定义的。对于列表的第一个/最后一个，您仍然可以使用 list[0] 和 list[list.Count-1] （当然，添加了错误处理）。

# php - Is Superclass's constructor run inside child constructor in PHP?

> ID：738571
> 
> 赞同：0
> 
> 时间：2009-04-10T19:11:00.507
> 
> 标签：php, oop

If I have this class:

```
<?php
class Model
{
    var $db;

    function Model()
    {
        $this->db=new Db_Class();
    }
}
?> 
```

and a second class that extended the parent class:

```
<?php
class LessonModel extends Model
{

    public function LessonModel()
    {
        //code here
    }

    public function getTitle($id)
    {
       $this->db->setTable('myTable');
       return $this->db->get('title',$id);
    }
}
?> 
```

Is it safe to assume that the `$LessonModel->db` field would have been instantiated by the parent `Model` class's constructor, or do I need to run it manually using something like `parent::Model();`?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T19:41:59.573

您不能假定已调用父构造函数，因为您已在子类中覆盖了它。你需要`parent::Model()`按照你的建议打电话。如果你改变你继承的类，你显然需要改变它。

如果您使用的是 PHP5，那么您可以命名您的构造函数`__construct()`。这样做的好处是让您可以在任何派生类中轻松调用父构造函数，`parent::__construct()`而无需指定父类名称。然后，您可以重新安排类的继承，减少引入模糊错误的麻烦和危险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T19:15:53.770

In the given example, you can assume that.

However, if your child class defines a constructor, PHP will not implicitly call it's parent constructor.

In order to do that, call:

```
parent::__construct(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T19:20:05.663

There's a cheap way to get around having to call the parent constructor.

Create an empty init() method in the base class. Call $this->init() in the base class constructor.

All sub-classes can implement init() if they want to run code when the class is created.

# sql - SQL Server index question - address lookup

> ID：738575
> 
> 赞同：0
> 
> 时间：2009-04-10T19:11:57.540
> 
> 标签：sql, sql-server

I have a table which may have anywhere from 10,000 to 10 million rows during the life of the application. This table contains NACSZ info, among other things, and I need to write a query that checks for matching NACSZ like so:

```
select 
    * 
from 
    Profiles 
where 
    FirstName = 'chris' and
    LastName = 'test' and
    Address1 = '123 main st' and
    City = 'chicago' and
    State = 'il' and
    Zip = '11111' 
```

I'm trying to optimize the table for this query which will be run inside an "if exists()" construct, and not having much luck. With no index, and ~110,000 rows of test data, I get:

> Table 'Profiles'. Scan count 1, logical reads 2021, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
> 
> (1 row(s) affected)
> 
> SQL Server Execution Times: CPU time = 16 ms, elapsed time = 70 ms.
> 
> SQL Server Execution Times: CPU time = 0 ms, elapsed time = 1 ms.

The execution plan indicates a clustered index scan on the primary key. I thought about adding an index for all the values, but that would create a rather large key and I'd like to try to avoid that if possible. My next thought was to index something that would be reasonably different between rows, so I tried indexing on first name (though I could use address line 1, or zip, for example), so I created the index:

```
create index ix_profiles_firstName on profiles(FirstName) 
```

Now, when I run the same query, I get

> Table 'Profiles'. Scan count 1, logical reads 171, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
> 
> (1 row(s) affected)
> 
> SQL Server Execution Times: CPU time = 0 ms, elapsed time = 52 ms.
> 
> SQL Server Execution Times: CPU time = 0 ms, elapsed time = 1 ms.

Obviously, indexing first name made a HUGE difference. My question is, how do I decide whether I should index first name vs last name vs address vs. zip code? Is there a command I can run over my sample data that will tell me uniqueness of values in each field? My understanding is that I should try to index the column with the most uniqueness to make the index work best, correct?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T19:20:27.517

For your query, you should create a composite index on all columns: `(FirstName, LastName, address1, city, state, zip)`

If you want a certain index to be used in `SQL Server`, issue:

```
SELECT  *
FROM    Profiles WITH (INDEX (index_name))
WHERE 
        FirstName = 'chris' and
        LastName = 'test' and
        Address1 = '123 main st' and
        City = 'chicago' and
        State = 'il' and
        Zip = '11111' 
```

> My question is, how do I decide whether I should index first name vs last name vs address vs. zip code?

Index all these values you are filtering on.

Note that you can efficiently filter on the first columns from the index, like:

```
SELECT  *
FROM    Profiles
WHERE   FirstName = 'chris' 
```

will use the index to search on `FirstName`,

```
SELECT  *
FROM    Profiles
WHERE   FirstName = 'chris'
        AND LastName = 'test' 
```

will use the index to search on both `FirstName` and `LastName`,

```
SELECT  *
FROM    Profiles
WHERE   FirstName = 'chris'
        AND City = 'chicago' 
```

will use the index to search only on `FirstName` (you don't filter on `LastName`, there is a gap, and the index cannot be used to search on other columns)

> Is there a command I can run over my sample data that will tell me uniqueness of values in each field?

```
SELECT   COUNT(DISTINCT FirstName) / COUNT(*)
FROM     Profiles 
```

will show you `FirstName` reciprocal selectivity.

The more this value is, the less efficient is the index.

> My understanding is that I should try to index the column with the most uniqueness to make the index work best, correct?

Yes.

Again, in your case you should index all columns. Most uniqueness is for sure on all columns taken together.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:24:49.957

> 我的问题是，我如何决定是否应该索引名字、姓氏、地址和邮政编码？

收集您打算使用的所有查询（如果这是唯一的，那么您就完成了）。然后将查询作为工作负载移交给 Index Tuning Wizard，并查看建议。

> 我的理解是我应该尝试索引具有最大唯一性的列，以使索引工作得最好，对吗？

索引越独特，从实际表中查找的结果就越少。索引越窄，读取速度越快。（这条规则说明了为什么所有标准列上的复合索引都不好）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T19:27:38.907

如果此查询与看起来一样重要，那么我建议您在连接的字段上创建一个派生列；然后在您的查询中明确创建密钥。当然它是多余的，但如果你不需要的话，它最终可能比把它弄乱更简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T19:29:17.933

你有几个选择。正如 Quassnoi 指出的那样，您可以创建一个复合索引。我在稍微不同的场景中使用的另一个选项是根据数据生成唯一密钥。在我的情况下，我正在比较地址并试图防止重复（因为我们将对任何新地址进行地理编码并且每个地理编码成本 $$）。

无论如何，基本上我们获取了地址的关键部分并创建了一个新密钥（地址、州和邮编）。你可以做同样的事情，然后只比较一列。

一个问题是确保在记录更改时同步此列。您可以查看使用计算列并对可能有助于实现该效果的列进行索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T19:27:31.620

除了其他答案...

您将运行哪种过滤器组合？尝试涵盖最流行的组合。

# c# - 部分方法 C# 3.0 的问题

> ID：738580
> 
> 赞同：2
> 
> 时间：2009-04-10T19:13:24.027
> 
> 标签：c#, .net, c#-3.0

你知道以下问题的答案吗？

> 让我们说，它 MyMethod() 在 MyPartialClass.cs 中的 MyPartialClass 中被声明为部分方法。我还在 MyPartialClass2.cs 中的 MyPartialClass 中提供了 MyMethod() 的主体。我使用了一个没有答案的问题“Magic”代码生成器，它实际上生成了 MyPartialClass.cs，让我们说基于一些 DB 模式。一些无辜的人永远改变了架构，然后运行“魔术”。MyPartialClass.cs 被重新生成，但使用 MyMethod2() 而不是 MyMethod() 声明。想起我。我在想我已经实现了“Magic”使用的 MyMethod()，但实际上，“Magic”正在使用 MyMethod2()。C# 编译器并没有告诉我我实现了没有任何声明的部分方法，而且我的实现根本没有使用！
> 
> 有什么解决办法吗？

我认为这是一个没有答案的问题。

**编辑**我得到了答案:-)。我的代码中有错字，这就是编译器没有标记错误的原因。乔恩已经指出了这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T19:17:41.457

您应该收到错误 CS0759。测试用例：

```
partial class MyClass
{
    partial void MyMethod()
    {
        Console.WriteLine("Ow");
    }
}

partial class MyClass
{
    partial void MyMethod2();
} 
```

编译结果：

```
Test.cs(6,18): error CS0759: No defining declaration found for implementing 
declaration of partial method 'MyClass.MyMethod()' 
```

这不符合您的要求吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T19:19:45.070

简而言之，不；这就是部分方法的重点——声明代码**不需要**知道是否提供了实现。

当然——你不能声明部分方法：*假设*它存在就使用它；如果你不提供它，编译器会抱怨缺少方法。

有一种在运行时检查（使用方法）的*hacky*`partial`方法，即让另一半更新一个`ref`变量：

```
partial void Foo(ref chk);

partial void Foo(ref chk) { chk++;} 
```

（并验证它的变化） - 但一般来说，部分方法被设计为不知道它们是否被调用。

另一种方法是带有方法的基类`abstract`- 然后由编译器强制实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T19:21:13.053

这是部分方法的全部目的。如果该方法未实现，则将其删除而不会留下痕迹，也不会发出警告。

此类问题的一种解决方案是在代码生成中使用双重派生模式。这被 DSLTools 广泛使用并且非常强大。

手写以下代码：

```
public class MyClassBase
{
    public abstract void MyMethod();
    //Put all other methods required by the class here.
}

public partial class MyClass : MyClassBase
{
   //This class is entirely empty! 
} 
```

用魔法生成以下代码。

```
public partial class MyClass
{
    public void MyMethod(){}
} 
```

如果有人未能在生成的代码中实现 MyMythod()，您将收到编译器错误。

# asp.net - ChangePassword on a user object does not lock account if not successful

> ID：738587
> 
> 赞同：1
> 
> 时间：2009-04-10T19:16:16.513
> 
> 标签：asp.net, active-directory, adsi

I have an ASP.Net application (on Win2K) that is using Windows authentication and impersonation. We are using the following code to change password:

```
Dim objDE As DirectoryEntry
'... 
objDE.Invoke("ChangePassword", txtOldPassword, txtNewPassword) 
```

This code works great, except it does not lock the account if there were multiple unsuccessful attempts. Is there any way to make this code to lock the account if incorrect passwords was provided multiple times (as specified in a policy). I can't elevating user privileges, because this potentially makes the system less secure.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T01:55:19.713

我不确定普通用户是否有权直接锁定自己的帐户。但是，这样做的一种方法是：

```
objDE.InvokeSet("IsAccountLocked", true) 
```

有关 Active Directory 上 .NET 的重要资源，请参阅[这篇文章](http://www.codeproject.com/KB/system/everythingInAD.aspx "Howto：（几乎）通过 C# 在 Active Directory 中的所有内容")。

我在 C# 中对上述链接的应用，如果您需要一个好的转换器，请尝试[这个](http://labs.developerfusion.co.uk/convert/csharp-to-vb.aspx)。

# delphi - Obfuscating images

> ID：738597
> 
> 赞同：6
> 
> 时间：2009-04-10T19:19:52.607
> 
> 标签：delphi, image, jpeg

I want to distribute a few images and not allow others to see them unless they are using my program. My intention will be to use JPG files in which I will alter the header so other image viewers cannot read them anymore. For example I can delete the bytes 7-10 which are the magic signature for JPG. Later, my program will reconstruct the header and show the JPG file.

Question: how do I do this on the fly, without reading the “broken” JPG file, restoring the header, saving the good file to disk and then re-loading it as a “good” JPG file?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T19:24:46.667

将“损坏的”文件加载到*TMemoryStream*中，修补内存中的字节，然后使用*TGraphic.LoadFromStream()*加载固定的 JPG 文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T21:16:54.960

加密它们。加载加密图像，在内存中解密，然后像 mghie 建议的那样执行 loadfromstream。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-10T22:15:06.380

为什么不使用私钥加密图像并将您的公钥分发给您想要查看图像的人？分发公钥比编写一些自定义软件并分发它要容易得多。不要忘记；屏幕上显示的任何内容都可以被屏幕捕获。自定义损坏的 JPEG 只能与您的应用一起显示这一事实是没有保护作用的。也不要忘记；人们可以简单地使用损坏的图像分发您的软件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T20:05:42.840

Mghie 的答案与您发现的一样好，但不太可能太有效。如果有人想查看您的图像并且他们对图像格式一无所知，他们会在十六进制编辑器中打开它，并且很可能会识别出他们看到的内容是去掉了魔术头的 JPEG。

如果您真的想阻止别人查看您的图像，请构建您自己的图像格式（实际上并不像听起来那么难）并尽可能少地放入元数据，然后希望它有效。或加密它们，或将它们放入存档中（构建您自己的存档格式以获得最佳效果）并希望*它*有效。

归根结底，任何被编码的东西都必须在显示之前被解码，任何有足够才华的黑客都可以通过你的解码程序追踪他们的方式并弄清楚它是如何工作的。你为什么要对你的用户隐藏一些东西？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T20:12:02.230

您可以通过将图像字节打包为加密资源来使它们变得更加困难。但就像其他任何事情一样，如果他们可以访问可以获取图像的文件。这仅取决于愿意使用多少努力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-12T18:28:49.700

根据您需要它的安全程度，您可以做一些简单的事情，例如将文件扩展名混淆为仅由您的应用程序打开的扩展名。这仅在您更改的不是超级秘密图像时才有效。

# c++ - 用 VS2008 编译的 C++ 应用程序不能在其他计算机上运行

> ID：738606
> 
> 赞同：3
> 
> 时间：2009-04-10T19:22:09.370
> 
> 标签：c++, visual-studio, visual-studio-2008, winapi, visual-c++

我用**Visual Studio 2008**和**Visual C++**语言创建了一个 wn32 项目，它使用 ws2_32.lib 库，然后我在**Release 模式下**编译。

它在同一台计算机上运行得很好，但是当我将 exe 文件复制到另一台计算机（没有安装 Visual Studio）时，它没有运行。

我看到的消息是：

*此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。*

但是，如果我使用**DEV C++**编译我的应用程序，与 Visual Studio 2008 可执行文件 (9.5 KB) 相比，它会生成更大的可执行文件 (738KB)。但是，DEV C++ 可执行文件在另一台计算机上运行。

**我已在附加依赖**项字段中将库 ws2_32.lib 添加到我的项目的链接器属性中。

如何修复它以使用 Visual Studio 2008？

我的代码如下： http: [//www.stan.com.mx/yupi/udpserver.cpp](http://www.stan.com.mx/yupi/udpserver.cpp)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T19:25:06.633

问题几乎可以肯定是另一台计算机没有安装第 9 版的 C++ CRT。

在 VS2008 中针对 CRT 进行编译的默认设置是动态链接与静态链接。如果你想用一个真正的安装项目来部署你的程序，你需要包含 CRT 可再发行组件。

但是，如果您想进行 XCOPY 部署，请按照下一页上的步骤操作。

[http://msdn.microsoft.com/en-us/library/ms235291.aspx](http://msdn.microsoft.com/en-us/library/ms235291.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T19:28:02.023

尝试安装[Visual C++ redistributables](http://www.microsoft.com/downloads/details.aspx?familyid=A5C84275-3B97-4AB7-A40D-3802B2AF5FC2&displaylang=en)。如果这不起作用，请使用[DependencyWalker](http://www.dependencywalker.com/)找出缺少的 DLL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T20:30:33.387

我同意 JaredPar。您使用 VS2008 构建的应用程序使用动态链接，而 DEV C++ 使用静态链接，因此更大的大小以及为什么一个工作而不另一个工作。

但是，如果它是您拥有的普通 win32 应用程序项目（并且您不想/不需要通过设置分发它），您*可以*通过获取 VS2008 来使其在另一台机器上运行而无需重新分发 CRT为您静态链接（如果它只是您缺少的标准库）。我手头没有 VS2008 的副本，所以我将描述如何在 VS2005 中进行操作，并希望它能够翻译。

1.  调出项目的配置属性（右键单击项目名称，然后从菜单中选择“属性”）
2.  展开“配置属性”，然后是“C/C++”，然后点击“代码生成”
3.  在“运行时库”项下，为您的特定配置选择库的**非 DLL**版本，即您想要“多线程调试 (/MTd) 的调试版本和想要“多线程 (/MT) 的发布版本” "

试试看是否有效。现在库是静态链接的，你显然会得到一个更大的最终二进制文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T19:26:10.890

您可能缺少程序所需的外部依赖项。例如，检查项目设置以查看您是否正在动态链接 MFC。您还可以运行 Depends 实用程序来检查缺少的依赖项。

# iis - 确保在 Windows Server 2003 64 位上安装了 ASP.NET 3.5 Framework

> ID：738607
> 
> 赞同：1
> 
> 时间：2009-04-10T19:22:40.960
> 
> 标签：iis, windows-server-2003, 32bit-64bit

我在 32 位 XP 中开发并部署到设置为在 32 位模式下运行的 Win2k3 64 位服务器。

在这种情况下，如何在 Win2k3 服务器上安装 3.5 框架组件？我看到有新的图表控件和 ASP.NET 3.5 的 SP1

如何在 IIS 中以 32 位模式运行的服务器上获取这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T18:06:53.303

为 .Net 3.5 安装 x64 包将安装**同时**安装64 位和 32 位框架。

使用 ASP.Net，您需要执行以下操作：

1.  将 IIS 设置为在 32 位模式下运行：

    cscript %SYSTEMDRIVE%\inetpub\adminscripts\adsutil.vbs SET W3SVC/AppPools/Enable32bitAppOnWin64 1

2.  为您的应用程序设置适当的 .Net 版本/位数：

    %SYSTEMROOT%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -i

此[知识库文章 (KB894435)](http://support.microsoft.com/KB/894435)包含您需要的所有详细信息。

# .net - 什么是 Windows 窗体等效于 WPF 的键盘类？

> ID：738610
> 
> 赞同：0
> 
> 时间：2009-04-10T19:24:41.783
> 
> 标签：.net, wpf, winforms, keyboard

问题说明了一切 - Windows 窗体中的某处是否有与 WPF 具有相同功能的类[`System.Windows.Input.Keyboard`](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.aspx)？还是我总是不得不处理键盘事件并保持自己的状态？（我对类似于 的表单特别感兴趣[`IsKeyDown`](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.iskeydown.aspx)）。

或者，是否有在我的 Forms 项目中使用此 WPF 功能的**简单**方法（我对 WPF 不是很熟悉，但这[**看起来**](http://msdn.microsoft.com/en-us/library/ms742474(VS.85).aspx)很麻烦）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T19:39:57.270

我不相信 WinForms 有等价物。我所知道的最好的是 Control 上的静态 ModifierKeys 属性，但这几乎肯定不是您想要的。

我相信你被困在处理事件和保持自己的状态:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T09:18:22.590

如果您不反对 P/Invoke，您可能需要查看 Windows API [GetKeyState](http://msdn.microsoft.com/en-us/library/ms646301(VS.85).aspx)函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T09:09:12.223

你为什么需要它？为什么不能在 WinForms 应用程序中简单地使用 Windows.Input.Keyboard？它们不是不兼容的，可以一起使用。我能想到的唯一原因是您需要以 .NET 2.x 平台为目标，而客户端计算机没有安装 .NET 3.x。

# windows-mobile - 在 .NET CF 上设置设备时间

> ID：738615
> 
> 赞同：1
> 
> 时间：2009-04-10T19:26:09.580
> 
> 标签：windows-mobile, compact-framework

寻找采用 .NET CF DateTime 对象并将设备的日期和时间设置为该日期（和/或时区）的代码示例。这样做的目的是通过 Web 服务从服务器获取当前的“实时”时间，并正确设置设备的时间。

以前有人做过吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T19:35:06.283

您可以使用[Opennetcf](http://www.opennetcf.com/library/sdf/)的 DateTimeHelper 类。

或者，您可以 p/调用[SetLocalTime](http://www.eggheadcafe.com/conversation.aspx?messageid=31527644&threadid=31527642)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T13:09:14.220

关于[kgiannakakis](https://stackoverflow.com/questions/738615/set-device-time-on-net-cf/738643#738643)的回答：绝对是要走的路，但是如果您不想只需要整个 OpenNETCF 运行时 DLL 来设置时间，请将源代码下载到 1.4 版本的库中（有较新的，但源在 v1.4 以上不是免费可用的），只需提取 DateTimeHelper 类（您可能还需要提取一些依赖项）。然后将其直接编译到您的代码中...它将使您免于不必要的外部文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T15:19:52.603

P/Invoking SetSystemTime() 是一个更好的选择，尤其是当设备与服务器处于不同的时区时。但是，Windows Mobile 5 中似乎存在一个错误，它无法正确处理夏令时，因此有时使用 SetSystemTime 在设备上设置的时间会延迟一个小时。

# javascript - ASP 经典的 JScript 'import' 语法

> ID：738619
> 
> 赞同：0
> 
> 时间：2009-04-10T19:27:12.307
> 
> 标签：javascript, asp-classic, import

我正在使用 ASP“经典”服务器，使用 JavaScript 作为语言引擎，由指令指定：

```
<%@LANGUAGE='JAVASCRIPT'%> 
```

我注意到“import”似乎是一个关键字。

```
Technical Information (for support personnel)

    * Error Type:
      Microsoft JScript compilation (0x800A03F2)
      Expected identifier
      /Default.asp, line 4, column 4
      var import = 'whut'
      ---^ 
```

'import' 关键字是如何使用的，如果有的话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T19:32:00.017

从[这里](http://www.devguru.com/Technologies/Ecmascript/Quickref/import.html)：

> **import**语句允许脚本导入由签名脚本导出的属性、函数和对象。以下代码导入对象 'drinks' 的 'wine' 和 'beer' 属性，前提是它们已通过导出脚本可用（比较 export 语句）：
> 
> **代码**：我`mport drinks.beer, drinks.wine;`
> 
> 注意：任何导出的脚本必须先加载到窗口、框架或图层中，然后才能导入和使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T19:56:02.317

与大多数编程语言一样，某些关键字是保留的。Javascript 有点特殊，因为它保留的关键字比语言中实现的要多。进口就是其中之一。其他示例是“私有”和“无效”，尽管它们未在当前版本中实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-05T02:17:10.463

import 是 js 中的保留字，但我认为它实际上只在 JScript.NET 和 ActionScript 中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T16:26:11.140

JScript 的保留字的完整列表（尽管许多未在该语言中使用）是：

```
abstract, boolean, break, byte, case, catch, char, class, const, continue, debugger,
default, delete, do, double, else, enum, export, extends, false, final, finally,
float, for, function, goto, if, implements, import, in, instanceof, int, interface,
long, native, new, null, package, private, protected, public, return, short, static,
super, switch, synchronized, this, throw, throws, transient, true, try, typeof, var,
volatile, void, while, with 
```

希望这可以帮助。

# objective-c - Objective-C 中的选择器？

> ID：738622
> 
> 赞同：124
> 
> 时间：2009-04-10T19:27:40.747
> 
> 标签：objective-c, selector

首先，我不确定我是否真的理解选择器是什么。根据我的理解，它是一个方法的名称，你可以将它分配给一个'SEL'类型的类，然后运行诸如respondToSelector之类的方法来查看接收者是否实现了该方法。有人可以提供更好的解释吗？

其次，到目前为止，我有以下代码：

```
NSString *thing = @"Hello, this is Craig";

SEL sel = @selector(lowercaseString:);
NSString *lower = (([thing respondsToSelector:sel]) ? @"YES" : @"NO");
NSLog (@"Responds to lowercaseString: %@", lower);
if ([thing respondsToSelector:sel]) //(lower == @"YES")
    NSLog(@"lowercaseString is: %@", [thing lowercaseString]); 
```

但是，即使`thing`显然是一种 NSString，并且应该响应小写字符串，我也无法让“respondsToSelector”有条件地返回“YES”......

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-04-10T19:42:32.397

您必须非常小心方法名称。在这种情况下，方法名称只是“ `lowercaseString`”，而不是“ `lowercaseString:`”（注意没有冒号）。这就是你被`NO`退回的原因，因为`NSString`对象响应`lowercaseString`消息而不是`lowercaseString:`消息。

你怎么知道什么时候加冒号？如果您在调用它时添加一个冒号，则在消息名称中添加一个冒号，如果它接受一个参数就会发生这种情况。如果它需要零个参数（如 的情况`lowercaseString`），则没有冒号。如果它需要多个参数，则必须添加额外的参数名称及其冒号，如`compare:options:range:locale:`.

您还可以查看[文档](https://developer.apple.com/documentation/foundation/nsstring/1408467-lowercasestring?language=objc)并注意是否存在尾随冒号。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-10T19:50:20.770

[选择器](https://developer.apple.com/library/mac/documentation/General/Conceptual/DevPedia-CocoaCore/Selector.html)是直接在已编译代码中引用方法的有效方式 - 编译器实际上将值分配给 SEL。

其他人已经涵盖了您的 q 的第二部分，末尾的“：”匹配的签名与您要查找的签名不同（在这种情况下，该签名不存在）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-10T19:44:13.077

那是因为你想要`@selector(lowercaseString)`，而不是`@selector(lowercaseString:)`。有一个微妙的区别：第二个暗示一个参数（注意最后的冒号），但`- [NSString lowercaseString]`不带参数。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-10T19:41:58.590

在这种情况下，选择器的名称是错误的。这里的冒号是方法签名的一部分；这意味着该方法采用一个参数。我相信你想要

```
SEL sel = @selector(lowercaseString); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-10T19:42:42.097

NSString 的方法是`lowercaseString`（0 个参数），而不是`lowercaseString:`（1 个参数）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T12:05:47.133

不要将冒号视为函数名称的一部分，将其视为分隔符，如果您没有任何要分隔的内容（函数没有任何价值），那么您就不需要它。

我不知道为什么，但所有这些面向对象的东西对于 Apple 开发人员来说似乎都是陌生的。我强烈建议使用 Visual Studio Express 并使用它。不是因为一个比另一个更好，只是它是看待设计问题和思维方式的好方法。

像

```
introspection = reflection
+ before functions/properties = static
- = instance level 
```

以不同的方式看待问题总是好的，而编程是终极难题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-16T23:30:27.250

根据我对 Apple 文档的理解，选择器代表您要调用的方法的名称。选择器的好处是您可以在要调用的确切方法不同的情况下使用它们。作为一个简单的示例，您可以执行以下操作：

```
SEL selec;
if (a == b) {
selec = @selector(method1)
}
else
{
selec = @selector(method2)
};
[self performSelector:selec]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-10T10:30:12.143

根据苹果文档： [https ://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/Selector.html](https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/Selector.html)

> 选择器是用于选择要为对象执行的方法的名称，或者是在编译源代码时替换名称的唯一标识符。选择器本身不做任何事情。它只是标识一种方法。使选择器方法名称与纯字符串不同的唯一原因是编译器确保选择器是唯一的。使选择器有用的是（与运行时一起）它就像一个动态函数指针，对于给定的名称，它会自动指向适用于与它一起使用的任何类的方法的实现。假设您有一个用于方法 run 的选择器，以及 Dog、Athlete 和 ComputerSimulation 类（每个都实现了一个方法 run）。

Example: (lldb) breakpoint --set selector viewDidLoad

This will set a breakpoint on all viewDidLoad implementations in your app. So selector is kind of a global identifier for a method.

# asp.net - 将 JSON 对象传递给 Web 方法

> ID：738623
> 
> 赞同：5
> 
> 时间：2009-04-10T19:27:49.747
> 
> 标签：asp.net, javascript, ajax, json, asp.net-ajax

我想和大家分享我今天学到的一些东西。我的问题是：

您可以将 JSON 对象从 JavaScript 代码传递到 .NET 页面方法吗？例如：

```
 var task = { 
    Title: $("#titlenew input", $(newTaskRow)).val(), 
    StartDate: $("#startnew input", $(newTaskRow)).val(), 
    EndDate: $("#endnew input", $(newTaskRow)).val(), 
    EstimatedHours: $("#esthrsnew input", $(newTaskRow)).val(),
    PredecessorsOutlineNumbers: $("#depnew input", $(newTaskRow)).val(),
    OutlineNumber: $("#ordernew", $(newTaskRow)).text()
  };
  PageMethods.AddTask(task, saveNewTaskCompleted, saveNewTaskFailed); 
```

如果可以，我的 Web 方法应该接受什么类型的 .NET 对象？

我发现是的，您可以将 JSON 对象传递给 Page Method，它会以 Dictionary(Of String, String) 的形式出现。所以我的 Web 方法签名如下所示：

```
<System.Web.Services.WebMethod()> _
Public Shared Sub AddTask(ByVal taskJson As Dictionary(Of String, String))

  Dim oTask As New Task()
  oTask.Title = taskJson("Title")
  ' all other accesses to the JSON object here

End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T12:19:25.743

查看这篇文章： [http ://dotnetslackers.com/columns/ajax/ASPNETAjaxWebService.aspx](http://dotnetslackers.com/columns/ajax/ASPNETAjaxWebService.aspx)

使用 [GenerateScriptType(typeof(Task))] 装饰您的 WebMethod，然后在客户端您将能够创建任务。然后将其作为常规对象传递给您的服务器端方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T07:50:51.517

类似问题的详细答案指出，结合 JQuery 和 Json2.stringfy() 可用于将复杂类型发送到服务器端方法。

而在服务器端，您只需将所需的类型放入方法签名中

（例如 foo(MyType obj) { ... } ）

[如何将 JSON 对象发送到 asp.net Web 服务并在那里处理数据？](https://stackoverflow.com/questions/4039634/how-to-send-json-object-to-asp-net-web-service-and-process-the-data-there)

# objective-c - 为什么没有调用“复制”？

> ID：738626
> 
> 赞同：1
> 
> 时间：2009-04-10T19:28:35.067
> 
> 标签：objective-c

我有以下对象：

```
@interface SomeObject : NSObject
{
    NSString *title;
}

@property (copy) NSString *title;

@end 
```

我还有另一个对象：

```
 @interface AnotherObject : NSObject{
        NSString *title;
    }

    @property (copy) NSString *title;

    - (AnotherObject*)init;
    - (void)dealloc;
    - (void) initWithSomeObject: (SomeObject*) pSomeObject;
    + (AnotherObject*) AnotherObjectWithSomeObject (SomeObject*) pSomeObject;

    @end

@implementation AnotherObject
@synthesize title

    - (AnotherObject*)init {
        if (self = [super init]) {
            title = nil;
        }
        return self;
    }

    - (void)dealloc {
        if (title) [title release];
        [super dealloc];
    }

    -(void) initWithSomeObject: (SomeObject*) pSomeObject
    {
        title = [pSomeObject title]; //Here copy is not being invoked, have to use [ [pSomeObject title] copy]
    }

    + (AnotherObject*) AnotherObjectWithSomeObject (SomeObject*) pSomeObject;
    {
        [pSomeObject retain];
        AnotherObject *tempAnotherObject = [ [AnotherObject alloc] init];
        [tempAnotherObject initWithSomeObject: pSomeObject];
        [pSomeObject release];
        return tempAnotherObject;
    }

@end 
```

我不明白，为什么在分配“title = [pSomeObject title]”时没有调用副本。我一直认为如果我在属性中设置“复制”，它总是会被调用。我的代码有错误或者我不明白什么？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T22:46:59.550

要调用 setter，您需要使用*点*表示法。

```
self.title = [pSomeObject title]; 
```

或者...也对 pSomeObject使用*点表示法*

```
self.title = pSomeObject.title; 
```

# erlang - 使用关联列表而不是记录是个好主意吗？

> ID：738627
> 
> 赞同：5
> 
> 时间：2009-04-10T19:28:37.843
> 
> 标签：erlang

那里有经验丰富的 Erlang 程序员会推荐[关联列表](https://en.wikipedia.org/wiki/Association_list)而不是记录吗？

一种情况可能是不同机器上的两个（或更多）节点正在交换消息。我们希望能够独立升级每台机器上的软件。一些升级可能涉及向一个（或多个）正在发送的消息添加一个字段。似乎使用记录作为消息意味着您必须始终在锁定步骤中对两台机器进行升级，以便额外的字段不会导致接收器忽略记录。然而，如果您使用关联列表之类的东西（它仍然有一个“类似记录”的 API），尚未升级的接收器仍然会成功接收消息并忽略新字段。我意识到这并不*总是*理想的行为，但*通常*是。还，

假设上述内容有些道理，我还有以下其他问题：

*   是否有用于 alist 的标准（或广泛使用的）库？一些微不足道的谷歌搜索没有发现任何东西。
*   在其他情况下您会使用关联列表（或类似的东西）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T20:49:32.233

对于少量的键，您可以使用列表，也就是[proplists](http://www.erlang.org/doc/man/proplists.html)，对于更大的键，您应该使用[dict](http://www.erlang.org/doc/man/dict.html)。在这两种情况下，最大的缺点是您不能以用于记录的方式使用模式匹配。还有速度惩罚，但在大多数情况下是无关紧要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T01:10:55.633

你基本上有三个选择：

1.  使用记录
2.  使用关联列表（proplists）
3.  使用组合

我使用更改可能性非常低的记录。这样我就得到了模式匹配并加快了我想要的速度。

我在需要类似哈希表的功能时使用 proplist。我以牺牲模式匹配和速度为代价获得了灵活性。

有时我两者都用。具有一个字段的记录是 proplist。这样我就可以对其中的一部分进行模式匹配，并且在需要的地方具有灵活性。

这三种选择都有不同的权衡取舍，因此您基本上只需要评估您的特定需求并做出选择。可能需要进行一些原型设计和尝试才能确定哪些权衡是有意义的，以及您绝对必须具备哪些功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T20:17:07.600

请注意，lists:keysearch/3 几乎是“assq”。

# perl - 如何为 Perl 中的所有致命错误强制执行堆栈回溯？

> ID：738628
> 
> 赞同：25
> 
> 时间：2009-04-10T19:28:41.227
> 
> 标签：perl

在 Perl 中，有没有办法强制所有致命错误显示堆栈回溯，如`Carp::confess`产生？

我知道你可以`use warnings FATAL => 'all';`在当前的词法范围内使警告变得致命。

此外，可以使用`$SIG{__WARN__} = sub { CORE::die(@_) };`使所有警告在任何地方都是致命的（尚未本地化 SIGWARN 处理程序）。

有没有一种干净的方法可以做到这一点，还是我需要调整 SIGDIE？如果我确实编写了一个 SIGDIE 处理程序，那么获取跟踪的最佳方法是什么？

一个理想的解决方案将与标准测试库`Test::More`和朋友一起使用。

**更新：** Mark Johnson 建议使用 SIGDIE 处理程序来调用`Carp::confess`. 它工作得很好。这是代码：

```
use Carp;
$SIG{ __DIE__ } = \&Carp::confess; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-10T19:55:08.947

安装一个调用 Carp::confess 的 SIGDIE 处理程序？或者只是将 Carp::confess 设置为 DIE 的处理程序？

当心与 eval 相关的[标准陷阱。](http://www.perlmonks.org/?node=SIGDIE)关于 BEGIN 块还有一个更[奇怪的问题。](http://www.perlmonks.org/?node_id=315182)还要注意[perlvar 中的不祥警告](http://www.perlmonks.org/?node_id=747179)。

有关生成堆栈跟踪的更多信息，请参阅[此问题](https://stackoverflow.com/questions/229009/how-can-i-get-a-call-stack-listing-in-perl)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-11T08:44:36.680

另请参阅模块“ [Carp::Always](http://search.cpan.org/dist/Carp-Always) ”，它将代码中的所有死亡和警告转换为堆栈跟踪。

# java - Math.random() 与 Random.nextInt(int)

> ID：738629
> 
> 赞同：143
> 
> 时间：2009-04-10T19:29:09.633
> 
> 标签：java, random

整数`Math.random() * n`和`Random.nextInt(n)`在哪里有什么区别？`n`

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2009-04-10T19:37:09.443

以下是Gili 链接到的 Sun 论坛帖子中为什么“比”更有效且更少偏见[的详细解释：](https://community.oracle.com/message/6596485#thread-message-6596485)`Random.nextInt(n)``Math.random() * n`

> Math.random() 在内部使用 Random.nextDouble()。
> 
> Random.nextDouble() 两次使用 Random.next() 生成一个 double，其尾数中的位大致均匀分布，因此它均匀分布在 0 到 1-(2^-53) 的范围内。
> 
> Random.nextInt(n) 使用 Random.next() 的次数平均不到两次——它使用一次，如果获得的值高于 MAX_INT 下 n 的最高倍数，它会再次尝试，否则返回模 n 的值（这防止高于 MAX_INT 的 n 的最高倍数之上的值扭曲分布），因此返回一个在 0 到 n-1 范围内均匀分布的值。
> 
> 在缩放 6 之前，Math.random() 的输出是从均匀分布中提取的 2^53 个可能值之一。
> 
> 按 6 缩放不会改变可能值的数量，并且强制转换为 int 然后将这些值强制放入六个“桶”（0、1、2、3、4、5）之一，每个桶对应于包含任一1501199875790165 或 1501199875790166 的可能值（因为 6 不是 2^53 的除数）。这意味着对于足够数量的骰子掷骰（或具有足够多边数的骰子），骰子将显示自己偏向较大的桶。
> 
> 您将等待很长时间滚动骰子才能显示此效果。
> 
> Math.random() 也需要大约两倍的处理，并且需要同步。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-10T19:45:12.247

另一个重要的一点是 Random.nextInt(n) 是可重复的，因为您可以创建两个具有**相同**种子的 Random 对象。这对于 Math.random() 是不可能的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-10T19:30:11.893

根据[https://forums.oracle.com/forums/thread.jspa?messageID=6594485龵](https://forums.oracle.com/forums/thread.jspa?messageID=6594485&#6594485) `Random.nextInt(n)`比`Math.random() * n`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-06T10:55:11.630

根据这个例子`Random.nextInt(n)`，输出的可预测性低于 Math.random() * n。根据[排序数组比未排序数组快][1]，我认为我们可以说 Random.nextInt(n)**很难预测**。

usingRandomClass：时间：**328**英里秒。

usingMathsRandom：时间：**187**英里秒。

```
package javaFuction;
import java.util.Random;
public class RandomFuction 
{
    static int array[] = new int[9999];
    static long sum = 0;
    public static void usingMathsRandom() {
        for (int i = 0; i < 9999; i++) {
         array[i] = (int) (Math.random() * 256);
       }

        for (int i = 0; i < 9999; i++) {
            for (int j = 0; j < 9999; j++) {
                if (array[j] >= 128) {
                    sum += array[j];
                }
            }
        }
    }

    public static void usingRandomClass() {
        Random random = new Random();
        for (int i = 0; i < 9999; i++) {
            array[i] = random.nextInt(256);
        }

        for (int i = 0; i < 9999; i++) {
            for (int j = 0; j < 9999; j++) {
                if (array[j] >= 128) {
                    sum += array[j];
                }
            }

        }

    }

    public static void main(String[] args) {
        long start = System.currentTimeMillis();
        usingRandomClass();
        long end = System.currentTimeMillis();
        System.out.println("usingRandomClass " + (end - start));
        start = System.currentTimeMillis();
        usingMathsRandom();
        end = System.currentTimeMillis();
        System.out.println("usingMathsRandom " + (end - start));

    }

} 
```

# sql - 使用 select 将行添加到查询结果

> ID：738631
> 
> 赞同：77
> 
> 时间：2009-04-10T19:29:29.213
> 
> 标签：sql, sql-server, tsql, select, insert

是否可以使用这样的文字扩展查询结果？

```
select name from users
union
select name from ('JASON'); 
```

或者

```
select age, name from users
union
select age, name from (25,'Betty'); 
```

所以它返回表中的所有名字加上'JASON'，或（25，'Betty'）。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-04-10T19:36:41.940

你像这样使用它：

```
SELECT  age, name
FROM    users
UNION
SELECT  25 AS age, 'Betty' AS name 
```

用于`UNION ALL`允许重复：如果您的用户中有一个 25 岁的 Betty，第二个查询将不会再次选择她`UNION`。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-10T19:37:48.677

在 SQL Server 中，您会说：

```
Select name from users
UNION [ALL]
SELECT 'JASON' 
```

在 Oracle 中，你会说

```
Select name from user
UNION [ALL]
Select 'JASON' from DUAL 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-10T19:33:23.883

> 是否可以使用这样的文字扩展查询结果？

是的。

```
Select Name
From Customers
UNION ALL
Select 'Jason' 
```

*   `UNION`如果 Jason 尚未在结果集中，则用于添加它。
*   用于`UNION ALL`添加 Jason，无论他是否已经在结果集中。

# javascript - 使用 ID 或“相对路径”连接到 JS 函数的链接更好吗？

> ID：738633
> 
> 赞同：1
> 
> 时间：2009-04-10T19:30:31.863
> 
> 标签：javascript, html, dom

你知道演习......说你有一个链接列表和相应的div。您希望在单击链接时显示 div - 因此您希望获得对 div 的引用，以便您可以在链接上挂钩事件。

当你设置你的事件时，最好使用唯一的 id 来连接，比如：

```
<a href="#" id="link123">Foo</a>
...
<div style="display: none;" id="div123"/> 
```

或者，使用某种 parent.childnodes “相对路径”来遍历 DOM 并从 a? 中获取对 div 的正确引用？

假设，出于本示例的目的，目标 div 是在 DOM 中从链接中删除的几个级别。Javascript 库在这方面完全符合要求，尤其是 YUI（但都欢迎）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T19:47:53.833

您的第一个建议似乎是最简单的。如果您正在动态生成页面，那么您可以轻松确保所有配对都匹配。

为什么不做这样的事情：

```
<a href="#div123">Foo</a>
...
<div style="display: none;" id="div123"/> 
```

这样它会更优雅地退化？

如果您需要对原始问题更有说服力，DOM 遍历操作往往比简单的 getElementById() 更昂贵（计算上）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T20:35:52.673

如果您的链接和选项卡窗格的顺序相同，则一种简单的方法是查找其索引与已激活链接的索引匹配的窗格，相对于元素的父节点。这可以通过一些 jQuery 轻松完成：

```
<div id='nav'>
  <a href='#'>Tab 1</a>
  <a href='#'>Tab 2</a>
  <a href='#'>Tab 3</a>
</div>

...

<div id='tabs'>
  <div>Contents of tab 1</div>
  <div>Contents of tab 2</div>
  <div>Contents of tab 3</div>
</div>

...

<script type='text/javascript'>
  $(function() {
    var $nav = $('#nav a'), $tabs = $('#tabs > div');
    $tabs.gt(0).hide();
    $nav.click(function() {
      $tabs.hide().eq($nav.index(this)).show();
      return false;
    });
  });
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:50:48.657

我喜欢为此使用内嵌锚标记，如果关闭 JavaScript 和 CSS，它还有一个额外的好处，那就是运行良好。

```
<a href="#div-123">Foo</a>
<a href="#div-124">Bar</a>
<a href="#div-125">Baz</a>

<style type="text/css">
#hiddenDivs div {
    display: none;
}
</style>

<div id="hiddenDivs">
    <div>
        <a name="div-123"></a>
        Some stuff in here for Foo
    </div>

    <div>
        <a name="div-124"></a>
        Some stuff in here for Bar
    </div>
    <div>
        <a name="div-125"></a>
        Some stuff in here for Baz
    </div>
</div>

<script type="text/javascript">
jQuery("a[href~='#div-']").click(function(){
    // extract the name of the anchor
    var id = $(this).attr('href').split('#')[1];
    jQuery('#hiddenDivs div').hide();
    jQuery('div:has(a[name='+id+'])').show();
    return false;
})
</script> 
```

# asp.net - 使用 EC2 和 Asp.Net 关键字搜索 Amazon SimpleDB 的最佳方式？

> ID：738634
> 
> 赞同：5
> 
> 时间：2009-04-10T19:30:52.347
> 
> 标签：asp.net, amazon-ec2, amazon-simpledb

我想知道是否有人对从 EC2 Asp.Net 应用程序在 Amazon SimpleDB 上执行关键字搜索的最佳方式有任何想法。

我正在考虑的几个选择是：

1）将关键字添加到多值属性并使用以下查询进行搜索： select id from keywordTable where keyword ='firstword' intersection keyword='secondword' intersection keyword = 'thirdword'

[亚马逊查询示例](http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/index.html?MultipleAttributeQueries.html)

2) 为 Katta 创建一个 Web 服务前端：

[EC2 上的 Katta](http://katta.sourceforge.net/documentation/running-katta-on-ec2)

3) 一个排队的 Lucene.Net 更新服务，定期将 Lucene 索引推送到云端。（解决“锁定”问题）

[负载平衡 Lucene（StackOverflow 帖子）](https://stackoverflow.com/questions/304934/how-do-i-load-balance-lucene-net)

[S3 上的 Lucene（博客文章）](http://www.kimchy.org/lucene-and-amazon-s3/comment-page-1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T15:33:11.560

如果您正在寻找严格的 SimpleDB 解决方案（根据所述问题），Katta 和 Lucene 不会帮助您。如果您只是在寻找基于“亚马逊基础设施”的解决方案，那么任何选择都可以。

这三个选项在您必须进行多少设置和管理方面有所不同，决定哪个最好取决于您的实际要求。

如果您需要简单性和最少的管理，具有名为 Keyword 的多值属性的 SimpleDB 是您的最佳选择。如果您不需要按相关性排序。无需设置或管理任何内容，您只需为实际的 CPU 和带宽付费。

如果您需要的不仅仅是关键字搜索，Lucene 是一个不错的选择，但您需要自己管理索引的更新。您还必须管理使用 SimpleDB 获得的负载平衡、备份和故障转移。如果您不关心故障转移，并且可以在 EC2 崩溃的情况下进行恢复时容忍停机时间，那么就少了一件需要担心的事情，也少了一个选择 SimpleDB 的理由。

使用 EC2 上的 Katta，您将自己管理一切。您将拥有最大的灵活性和最多的工作要做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-13T15:20:50.547

Simple Savant 是一个用于 SimpleDB 的开源 .NET 持久性库，其中包括对使用 Lucene.NET 的全文搜索的集成支持（我是 Simple Savant 的创建者）。

全文索引方法在[此处](http://simplesavant.codeplex.com/wikipage?title=Full-Text%20Indexing&referringTitle=Documentation)描述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-28T17:42:05.050

只是为了整理这个问题......我们通过为 Lightspeed 编写自定义搜索提供程序来使用 Lightspeed 的 SimpleDB 提供程序、Solr 和 SolrNet。

为 Lightspeed 实现 ISearchEngine 接口的信息：http: [//www.mindscape.co.nz/blog/index.php/2009/02/25/lightspeed-writing-a-custom-search-engine/](http://www.mindscape.co.nz/blog/index.php/2009/02/25/lightspeed-writing-a-custom-search-engine/)

这是我们正在使用的 Solr 库： [http ://code.google.com/p/solrnet/](http://code.google.com/p/solrnet/)

由于 Solr 可以使用 EC2 机器轻松扩展，这对我们来说是最有意义的。

# perl - 如何检测 Perl 中的递归包调用？

> ID：738636
> 
> 赞同：6
> 
> 时间：2009-04-10T19:31:08.583
> 
> 标签：perl, recursion, object, packages, callstack

我有一个 Perl 项目，如果我只是通过循环包调用遇到问题。下面的代码演示了这个问题。

执行此操作时，每个包将调用另一个包，直到耗尽计算机的所有内存并锁定。我同意这是一个糟糕的设计，并且不应在设计中进行这样的循环调用，但我的项目足够大，我想在运行时检测到这一点。

我已经阅读了有关弱化函数和 Data::Structure::Util 的信息，但我还没有想出一种方法来检测是否存在循环包加载（我假设，因为每次迭代都会制作一个新副本并存储在 $this 哈希的每个副本中）。有任何想法吗？

```
use system::one;

my $one = new system::one(); 

package system::one;

use strict;

use system::two;

sub new {
  my ($class) = @_; 
  my $this = {};  
  bless($this,$class); 
  # attributes
  $this->{two} = new system::two();
  return $this; 
} 

package system::two;

use strict;

use system::one;

sub new {
  my ($class) = @_; 
  my $this = {};  
  bless($this,$class); 
  # attributes
  $this->{one} = new system::one();
  return $this; 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T19:46:43.790

这些在单独的包中的事实与它无限运行并消耗所有可用资源的事实完全没有关系。您从彼此内部调用两种方法。这不是循环引用，而是**递归**，这不是一回事。特别是，`weaken`根本不会帮助你。你会得到完全相同的效果：

```
sub a {
    b();
}

sub b {
    a();
}

a(); 
```

避免这种情况的最好方法是**不要那样做**。更有用的是，如果您必须编写递归函数，请尽量不要在递归链中使用多个函数，而只使用一个函数，这样您就可以更轻松地在心理上跟踪调用应该终止的位置。

至于如何检测是否发生了这样的事情，你必须做一些简单的事情，比如用你的递归深度增加一个变量，如果你的深度超过某个值，就终止（或返回）。但是你真的不应该依赖它，它类似于编写一个`while`循环并在那里使用增量来确保你的函数不会失控。除非您知道它如何以及何时终止，否则不要在集合上递归。

另一个相关的问题是您首先要完成什么？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T20:26:32.010

在这里，也有一些代码。:)

```
sub break_recursion(;$) {
    my $allowed = @_ ? shift : 1;
    my @caller = caller(1);
    my $call = $caller[3];
    my $count = 1;
    for(my $ix = 2; @caller = caller($ix); $ix++) {
        croak "found $count levels of recursion into $call"
            if $caller[3] eq $call && ++$count > $allowed;
    }
}

sub check_recursion(;$) {
    my $allowed = @_ ? shift : 1;
    my @caller = caller(1);
    my $call = $caller[3];
    my $count = 1;
    for(my $ix = 2; @caller = caller($ix); $ix++) {
        return 1
            if $caller[3] eq $call && ++$count > $allowed;
    }
    return 0;
} 
```

这些被称为：

```
break_recursion(); # to die on any recursion
break_recursion(5); # to allow up to 5 levels of recursion
my $recursing = check_recursion(); # to check for any recursion
my $recursing = check_recursion(10); # to check to see if we have more than 10 levels of recursion. 
```

我想可能会 CPAN 这些。如果有人对此有任何想法，请分享。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T19:48:35.750

我建议创建一个名为 break_constructor_recursion() 的例程，它使用 caller() 来检查调用堆栈，如下所示：

找出刚才调用我的包中的什么方法。

查看调用堆栈的其余部分，看看同一个包中的同一个方法是否在更远的地方。

如果是这样， die() 用适当的东西。

然后在构造函数中添加对 break_constructor_recursion() 的调用。如果从内部调用构造函数，它会被炸毁。

现在，这可能会引发误报；构造函数在其内部被合法调用并非不可能。如果您对此有疑问，我想说让它在识别错误​​之前查找构造函数的一些额外出现。如果堆栈上有 20 次 system::two::new() 调用，那么您不递归的可能性非常低。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T20:14:53.410

双递归的经典中断是使用状态变量来确定您是否已经在函数中：

```
{
    my $in_a;
    sub a {
        return if $in_a; #do nothing if b(), or someone b() calls, calls a()
        $in_a = 1;
        b();
        $in_a = 0;
    }
} 
```

如果`$in_a`是真的，你可以做任何你想做的事情，但是`die`ing 或 return 是常见的。如果您使用的是 Perl 5.10 或更高版本，您可以使用该`state`函数而不是将函数嵌套在其自己的范围内：

```
sub a {
    state $in_a;
    return if $in_a; #do nothing if b(), or someone b() calls, calls a()
    $in_a = 1;
    b();
    $in_a = 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T19:13:25.507

## `use warnings;`

没有警告：

```
#!/usr/bin/perl 

use strict;

sub foo {
    foo(); 
}

foo(); 
```

-

```
$ perl script.pl
^C# 死后

```

带有警告：

```
#!/usr/bin/perl 

use strict;
use warnings;

sub foo {
    foo(); 
}

foo(); 
```

-

```
$ perl script.pl
在 script.pl 第 7 行对子例程“main::foo”进行深度递归。
^C# 死后

```

始终始终使用警告。

## `use warnings FATAL => qw( recursion );`

```
#!/usr/bin/perl 

use strict;
use warnings FATAL => qw( recursion );

sub foo {
    foo(); 
}

foo(); 
```

-

```
$ perl script.pl
在 script.pl 第 7 行对子例程“main::foo”进行深度递归。
$

```

# java - ICEFaces 会话自动扩展

> ID：738642
> 
> 赞同：1
> 
> 时间：2009-04-10T19:34:13.383
> 
> 标签：java, tomcat, jsf, icefaces, java-ee-5

我有一个应用程序，其中用户经常让页面整天在浏览器中运行。该页面有一个间隔渲染，每 30 秒更新一次数据。

但是，如果用户有一段时间没有与页面交互，它仍然会过期。只要浏览器打开并发出预定的请求，我希望它自动扩展。

每次为这些页面之一触发预定的渲染器时，是否有一种方法可以自动扩展会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T16:54:22.713

当我的代码已经被 ICEFaces 每 30 秒调用一次时，我真的不想做 Javascript 黑客来单击按钮。ICEFaces 内部计时器的以下黑客解决方法似乎有效：

```
 private void updateSessionExpiration () {
      HttpSession sess = getSession();
      if (sess != null) {
        try {
            Field fld = SessionDispatcher.class.getDeclaredField("SessionMonitors");
            fld.setAccessible(true);
            Map map = (Map)fld.get(null);
            String sessID = sess.getId();
            if (map.containsKey(sessID)) {
                log.info("About to touch session...");
                SessionDispatcher.Monitor mon = 
                     (SessionDispatcher.Monitor)map.get(sessID);
                mon.touchSession();
            }
        } catch (Exception e) {
            log.error("Failed to touch session");
        }
      }
  } 
```

此外，对于[ICEFaces 1.8.2RC1](http://www.icefaces.org/releasenotes/icefaces-1.8.2-RC1-RN.html)（可能最终也会使用 ICEFaces 1.8.2 的发布版本），有两种新的解决方法可用：

```
HttpServletRequest request = (HttpServletRequest) servletRequest; 
HttpSession session = request.getSession(); 
if (session != null) { 
    SessionDispatcher.Monitor.lookupSessionMonitor(session).touchSession(); 
} 
```

或者，将其放在 web.xml 中以更新对特定模式中 URL 的任何命中：

```
<filter> 
    <filter-name>Touch Session</filter-name> 
    <filter-class>com.icesoft.faces.webapp.http.servlet.TouchSessionFilter</filter-class> 
</filter> 
<filter-mapping> 
    <filter-name>Touch Session</filter-name> 
    <url-pattern>/seam/remoting/*</url-pattern> 
</filter-mapping> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:03:49.530

ICEfaces 有一个保持会话活动的内部机制（该机制有时被称为“心跳”）。您可以查看相关[文档并在](http://www.icefaces.org/docs/v1_8_0/htmlguide/devguide/AdvancedTopics6.html)*web.xml*中配置提到的参数（尤其是**heartbeatInterval**和**heartbeatTimeout**）。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T18:15:42.760

Iceface's Ajax bridge has callback APIs, for example `Ice.onSessionExpired()` which you may be able to use.

```
<body id="document:body">
    <script type="text/javascript">
        Ice.onSessionExpired('document:body', function() {
            <!-- Do something here -->
        });
    </script> 
```

See [http://www.icefaces.org/docs/v1_8_0/htmlguide/devguide/references4.html#1094786](http://www.icefaces.org/docs/v1_8_0/htmlguide/devguide/references4.html#1094786) for more details.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T11:01:02.090

如果我不明白您的真正目的是什么，那么您需要一种计时器，它会自动扩展每个用户会话客户端，从而覆盖服务器端默认页面会话到期时间（通常为 30 分钟，仅用于详细说明，因为我了解脚本如果用户在页面上处于活动状态，则每 30 秒“呈现”一次）。

如果这么好，在 JSF 之前，我总是通过地下 Javascript 扩展非活动用户会话，所以我也会在你的情况下使用它。实际上，您可以从以下开始在 Javascript 中构建一个简单的页面侦听器：

```
window.setInterval( expression , msecIntervalTiming ); 
```

“表达式”可以是一个被调用的函数，您可以在其中调用一些虚拟 JSF 来保持会话处于活动状态而无需重新加载用户访问的当前页面，过去我使用标准框架或 iframe 进行 http 调用，现在使用 XHR / Ajax 也更简单。

Javascript 示例：

```
var timerID = null;
function simplePageListener() { // invoked by some user event denoting his absence status
    // here goes all events and logic you need and know for firing the poller...
    if (timerID == null) // avoid  duplicates
        timerID = window.setInterval( "window.startPoller()", msecIntervalTiming );
}
//...
function pollerStart() {
  // make iframe or ajax/xhr requests
}
function pollerStop() {
  // make action like page reloading or other needings
}
//...
function triggeredCleanTimer(timer) { // invoked by some user event denoting his active status
  clearTimeout(timer); // it can be also the global variable "timerID"
  timerID = null;
} 
```

基本上，您使用“timerID”作为全局参考来跟踪侦听器状态，因此当您需要激活“自动扩展”时，您可以为其分配一个 setInterval。相反，当用户返回页面（由您知道的某个事件触发）时，您清除停止侦听器轮询的超时。**上面的例子显然暗示了用户回来后必须手动重新加载页面**。

*但是，在您的特定情况下，我将避免干扰 Icefaces 框架自动生成的 javascript。即使对于 ipothesys，您可以定期在不可见的输入元素上模拟一些用户事件（样式设置在 "visibility: hidden" 上，**绝对不在 "display: none" 上**），这也会导致 Icefaces 事件不会停止它并使自己工作不断地*

<input type="button" name="invisivleButton" value="..." style="visibility: hidden, z-index: 0;" 等元素 /> 您可以在其上定期调用单击事件

```
 document.forms["YourDummyForm"]["invisivleButton"].click(); 
```

有关用法，请参阅 Devedge Online 的旧 JS 文档 :-)

[http://devedge-temp.mozilla.org/library/manuals/2000/javascript/1.3/reference/window.html#1203669](http://devedge-temp.mozilla.org/library/manuals/2000/javascript/1.3/reference/window.html#1203669)

# .net - 使用反射创建 MustOverride 属性？

> ID：738644
> 
> 赞同：1
> 
> 时间：2009-04-10T19:35:17.577
> 
> 标签：.net, reflection

谁能告诉我如何`MustOverride`使用反射创建属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T19:45:48.503

你的意思是与`Reflection.Emit`？如果是这样，请使用`TypeBuilder.DefineMethod`, 和`MethodAttributes.Abstract`。

这是一个例子；在`Bar.Method`是`abstract`；`Bar2.Method`覆盖它。

```
 AssemblyName an = new AssemblyName("Foo");
    var asm = AppDomain.CurrentDomain.DefineDynamicAssembly(an, AssemblyBuilderAccess.Run);
    var module = asm.DefineDynamicModule("Foo");
    var type = module.DefineType("Bar", TypeAttributes.Abstract | TypeAttributes.Class | TypeAttributes.AnsiClass);
    var method = type.DefineMethod("Method", MethodAttributes.Abstract | MethodAttributes.Public | MethodAttributes.Virtual,
        CallingConventions.HasThis, typeof(int), Type.EmptyTypes);

    var final = type.CreateType();

    type = module.DefineType("Bar2", TypeAttributes.Sealed | TypeAttributes.Class | TypeAttributes.AnsiClass, final);
    var method2 = type.DefineMethod("Bar", MethodAttributes.Public | MethodAttributes.Virtual,
        CallingConventions.HasThis, typeof(int), Type.EmptyTypes);
    var il = method2.GetILGenerator();
    il.Emit(OpCodes.Ldc_I4_4);
    il.Emit(OpCodes.Ret);
    type.DefineMethodOverride(method2, method);

    var concrete = type.CreateType();
    object obj = Activator.CreateInstance(concrete);
    int result = (int) concrete.GetMethod("Bar").Invoke(obj, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T19:42:19.260

你是说 CodeDOM 吗？反射用于*读取*现有代码，而不是*创建*新代码。

如果您*的*意思是 CodeDOM，我相信您只需要创建`CodeMemberProperty`并将其`Attributes`属性设置为 include `MemberAttributes.Abstract`。

# database - 核心数据同步

> ID：738645
> 
> 赞同：6
> 
> 时间：2009-04-10T19:35:19.853
> 
> 标签：database, cocoa, macos, core-data, synchronization

有没有办法自动将我的核心数据模型与服务器（最好是 REST）同步？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T03:05:56.463

Apple 分享了他们的同步服务框架，记录在这里：

[http://developer.apple.com/documentation/Cocoa/Conceptual/SyncServices/SyncServices.html](http://developer.apple.com/documentation/Cocoa/Conceptual/SyncServices/SyncServices.html)

本节专门与同步托管对象相关：

[http://developer.apple.com/documentation/Cocoa/Conceptual/SyncServices/Articles/UsingCoreData.html#//apple_ref/doc/uid/TP40005232](http://developer.apple.com/documentation/Cocoa/Conceptual/SyncServices/Articles/UsingCoreData.html#//apple_ref/doc/uid/TP40005232)

至于使用哪种数据传输方式，我不确定它是否使用 REST，我并没有立即看出这一点。

通常，传入和传出 REST 服务的数据不包括大型二进制对象或复杂的数据结构。如果 REST 是一项要求，您可能需要做一些自定义的事情，但是通过搜索可用的文档，您可能会找到您正在寻找的一切。

# math - 交互式数学证明系统

> ID：738652
> 
> 赞同：9
> 
> 时间：2009-04-10T19:37:31.127
> 
> 标签：math, coq, theorem-proving, isabelle, proof-system

我正在寻找一种工具（首选 GUI，但 CLI 可以），它允许我输入数学表达式，然后对它们执行操作，但将我限制为仅在数学上有效的操作。此外，该工具必须能够保存会话并稍后证明给定的一组已保存操作是有效的。

*注意：我**不是**在寻找*生成*证明的系统，只是检查我手动指定的步骤是否有效。*

我已经将[ACL2](http://en.wikipedia.org/wiki/ACL2)用于类似的操作，并且在某些情况下效果很好，但在其他所有情况下都很难使用。

[这个小项目是我的动力。](http://www.dsource.org/projects/scrapple/browser/trunk/backmath)它是一种 D 模板类型，允许求解方程。给定这个等式：

```
(A * B) = C + D / F; 
```

任何一个符号都可以设置为未知，并且评估该表达式将导致对该变量的赋值。它的工作原理是将表达式树构建到类型中，然后使用重写规则将其转换为可以为未知类型触发的东西。

我需要的是某种方法来验证重写规则。它们可以通过测试一个断言来验证，即给定一些关系是真的，另一个也是真的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T22:41:27.127

已经提到了几个美国的证明助手（通常使用 LISP 语法），所以这里有一个以欧洲为中心的列表来补充它：

*   [考克](http://coq.inria.fr/)

*   [伊莎贝尔](http://isabelle.in.tum.de)

*   [HOL4](http://hol.sourceforge.net/)

*   [HOL-光](http://www.cl.cam.ac.uk/~jrh13/hol-light/)

*   [开泽](http://www.mizar.org/)

它们都因 TTY 接口而臭名昭著，但 Coq 和 Isabelle 为 Proof General / Emacs 接口提供了良好的支持。此外，Coq 附带 CoqIDE，它基于 OCaml/GTK 和板载文本小部件。最近的 Isabelle 包括 Isabelle/jEdit Prover IDE，它基于 jEdit，并在用户键入时由 Prover 实时提供的语义标记增强。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T19:46:05.773

ACL2 是臭名昭著的——我们曾经说它是一个专家系统，因此只能由专家使用，他们必须向 Warren Hunt、J Moore 或 Bob Boyer 学习。在 ACL2 中你需要做的是真正了解证明系统本身是如何工作的；然后你可以在减少搜索空间的方向上“提示”它。

但是，根据您要执行的操作，还有其他几个系统可以帮助解决此类问题。

如果您想使用连续数学或数论，理想的是[Mathematica](http://www.wolfram.com/)。问题是你可以用同样的钱买一辆二手车（除非你有资格获得学术执照，这是一个更好的交易。）

类似的，免费的，是[Open Maxima](http://maxima.sourceforge.net/compalg.html)，它是 Macsyma 的扩展。该页面还指向其他几个，例如 Axiom，我没有经验。

对于数学逻辑运算，有来自 SRI的[PVS 。](http://pvs.csl.sri.com/)他们还有一些其他很酷的东西，比如在同一框架中进行模型检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T07:06:29.850

该领域正在进行研究，称为“计算机代数中的定理证明”。

人们正试图将 Mathematica、Maple 等计算机代数系统的易用性和强大功能与证明系统的逻辑严谨性结合起来。问题是：

*   计算机代数系统并不严谨。他们往往会忘记诸如除数不能为 0 之类的附带条件。

*   证明系统使用起来既困难又乏味（正如您所发现的那样）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T20:00:21.090

除了 Charlie Martin 的链接之外，您可能还想查看[Maple](http://www.maplesoft.com/Products/Maple/)。我使用此类软件的经验大约有 5 年，但我记得当时发现 Maple 比 Mathematica 更直观。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-19T04:07:24.657

[精益证明器](https://leanprover.github.io/)是通过 JS gui 进行交互的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-11T17:53:03.523

一个古老且无人维护的系统是“Ontic”：

[http://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/areas/kr/systems/ontic/0.html](http://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/areas/kr/systems/ontic/0.html)

# visual-studio - 是否可以自定义 RockScroll 的变量语法高亮的颜色？

> ID：738654
> 
> 赞同：7
> 
> 时间：2009-04-10T19:38:59.970
> 
> 标签：visual-studio, syntax-highlighting

正如你们中的一些人所知，RockScroll Visual Studio 插件非常棒。它将滚动条变成代码的迷你预览，并提供类似于 Eclipse 的功能，可以突出显示您在代码中双击的任何单词。

问题是 RockScroll 的作者选择了一种很难看到的颜色，几乎违背了这样一个很酷且非常有用的功能的目的。

所以我的问题是。是否可以自定义颜色或以某种方式指定自己的颜色？

请继续关注，因为我回答了我自己的问题并找到了方法！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-16T20:52:50.757

你可以通过去设置它

工具 > 选项 > 环境 > 字体和颜色 > rockcroll

Rockscroll.dll 是版本 2.1.0.0 (05/09/2008)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T19:44:14.153

我想出了一种方法来通过十六进制编辑 Rockscroll .dll 来实现这一点

默认情况下，RockScroll 使用非常浅的紫色蓝色：F5E7FE。

1.  打开你最喜欢的 HexEditor。
2.  在 Program Files\RockScroll 目录中打开 RockScroll.dll（先备份它！）
3.  搜索上面指定的颜色并记住使用正确的字节顺序进行搜索。
4.  我碰巧在网上找到了那个颜色序列：00006FDC
5.  输入一个新的颜色选择...我选择了一个更突出的黄色/金色：E8E8FF
6.  保存文件并关闭它，然后重新启动 Visual Studio，如果您设法正确执行此操作，Visual Studio 将毫无怨言地启动。
7.  打开一些代码并双击一个单词...您应该立即可以使用新颜色。

干杯!

免责声明：这被认为是黑客行为，因此请自担风险！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-01T10:29:47.850

请改用[MetalScroll](http://code.google.com/p/metalscroll/)！

它完成了 RockScroll 所做的一切以及更多工作，并且易于配置。

# windows - 检查用户名是否在管理员组中

> ID：738658
> 
> 赞同：2
> 
> 时间：2009-04-10T19:41:21.180
> 
> 标签：windows, installation, installshield, admin

在[InstallShield](http://en.wikipedia.org/wiki/InstallShield)基本[MSI](http://en.wikipedia.org/wiki/Windows_Installer)项目中：如何检查用户名是否在管理员组中？

（不是我知道可以这样做的当前用户。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T20:14:09.357

您可以运行“net localgroup administrators”并解析输出。我怀疑有更好的方法，但如果没有......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T20:39:20.700

用户可以属于本地服务器上的“管理员”组，也可以是 AD 中定义的“域管理员”或“企业管理员”组的一部分。理想的解决方案是使用名为 IsUserAdmin(user_name) 的方法创建一个 DLL，该方法接受用户名参数并返回 true 或 false。

在内部，该方法将调用 IADsUser::Groups 方法来确定提供的用户所属的组，如果枚举的组属于上述管理员组之一，则返回 true。如果不是，它将返回 false。您可以在您的 InstallShield 项目中调用此 DLL。警惕嵌套组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-04T14:52:32.147

我可以想到两种方法，但是每种方法都涉及在安装脚本之上编写代码，我不再熟悉 Installshield，但大概就像 Visual Studio 安装项目一样，您有自定义操作的概念。我怀疑这就是你需要的。

我只会概述第一个，因为第二个非常复杂（即比第一个更复杂！）。显而易见的方法是 AD。以下代码片段将告诉您是否存在用户名/密码组合。获得用户后，我相信您可以确定他们所在的组。

```
if (true == String.IsNullOrEmpty(userName)) throw new Exception("userName not set");

DirectoryEntry entry = new DirectoryEntry();
entry.Username = userName;  // Use the fully qualified name here
entry.Password = password;

string DomainlessUsername = userName.Substring(userName.LastIndexOf('\\') + 1, userName.Length - userName.LastIndexOf('\\') - 1);

// We know straight away that if this is empty, we've drawn a blank!
if (true == String.IsNullOrEmpty(DomainlessUsername)) throw new Exception("userName not set");

DirectorySearcher search = new DirectorySearcher(entry);
search.Filter = "(SAMAccountName=" + DomainlessUsername + ")";
search.PropertiesToLoad.Add("cn");

SearchResult result = search.FindOne();

if (null == result)
{
    throw new Exception("FindOne executed without exception, but result was null");
}
else
{
    // some logging here
}
return true; 
```

现在，如果运行此代码的帐户没有访问 AD 的权限，这里就有一个潜在的问题。我不会在这篇文章中详细介绍，因为希望上面的代码足以对您有所帮助，但替代方法的基本原理是直接将 advapi32.dll 封装到 LogonUser 之类的函数中。（请记住，我的问题是验证凭据而不是检查管理员权限，但如果您准备挖掘，那里可能有一个链接）。

希望有些帮助！

# c# - 绑定、线程和winforms

> ID：738671
> 
> 赞同：4
> 
> 时间：2009-04-10T19:45:58.813
> 
> 标签：c#, winforms, multithreading

如何将 ProgressBar 绑定到在另一个线程中更新的类的属性？

下面的代码示例展示了我的第一次天真的尝试。它不起作用，因为我收到有关跨线程通信的运行时错误。我想我需要以某种方式使用 Invoke，但我不确定如何使用 Binding 类。

```
using System;
using System.Drawing;
using System.Windows.Forms;
using System.ComponentModel;
using System.Threading;

class ProgressForm : Form
{
    private ProgressBar pbProgress;

    public ProgressForm(ref LongOp lo)
    {
        Binding b = new Binding("Value", lo, "Progress");
        pbProgress = new ProgressBar();
        pbProgress.DataBindings.Add(b);
        this.Controls.Add(pbProgress);
    }
}

class Program : Form
{
    private Button btnStart;
    private LongOp lo;

    public Program()
    {
        lo = new LongOp();
        btnStart = new Button();

        btnStart.Text = "Start long operation";
        btnStart.Click += new EventHandler(btnStart_Click);

        this.Controls.Add(btnStart);
    }

    private void btnStart_Click(object sender, EventArgs e)
    {
        ProgressForm pf = new ProgressForm(ref lo);
        lo.DoLongOp();
        pf.ShowDialog();
    }

    [STAThread]
    public static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Program());
    }
}

class LongOp : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    private int progress;

    public void DoLongOp()
    {
        Thread thread = new Thread(new ThreadStart(this.run));
        thread.Start();
    }

    public void run()
    {
        for (int i = 0; i < 10; ++i)
        {
            Thread.Sleep(1000);
            Progress++;
        }
    }

    public int Progress
    {
        get
        {
            return progress;
        }

        set
        {
            progress = value;
            NotifyPropertyChanged("Progress");
        }
    }

    private void NotifyPropertyChanged(String field)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(field));
        }
    }
} 
```

那么如何将 ProgressBar 绑定到另一个线程中更新的值呢？

提前致谢

**编辑：** ~~我已经切换到使用 Gravell 先生编写并链接到的 ThreadedBinding 实现。~~不过，我仍然遇到跨线程异常。在异常对话框中按“中断”会突出显示该`PropertyChanged(this, new PropertyChangedEventArgs(field));`行作为导致异常的行。

我还需要改变什么？

**编辑：**看起来 Gravell 先生的帖子已被删除。我提到的 ThreadedBinding 实现可以在这个线程的末尾找到：[http ://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/69d671cd57a2c7ab/2f078656d6f1ee1f?pli=1](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/69d671cd57a2c7ab/2f078656d6f1ee1f?pli=1)

为了便于其他人编译，我在示例中切换回了普通的旧 Binding。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T21:41:33.357

不幸的是，我认为跨线程问题会使数据绑定在此处使用起来有点笨拙，并且可能比您在任何情况下都需要更复杂——数据只需要以一种方式进行探测。

您可以用这样的事件处理程序替换绑定：

```
private void ProgressPropertyChangedHandler(object sender,
                                            PropertyChangedEventArgs args)
{
    // fetch property on event handler thread, stash copy in lambda closure
    var progress = LongOp.Progress;

    // now update the UI
    pbProgress.Invoke(new Action(() => pbProgress.Value = progress));
} 
```

# iphone - How to convert byte array to NSString

> ID：738674
> 
> 赞同：8
> 
> 时间：2009-04-10T19:46:53.383
> 
> 标签：iphone, cocoa-touch, xcode, nsstring

I am reading data from a TCP/IP stream and am successfully receiving a byte array from the pre-existing server. I am now trying to find a way to convert that array to an `NSString`. I have found several examples, but am having a hard time getting my desired results.

```
NSData *data=[[NSMutableData alloc] init];

uint8_t buffer[1024];
unsigned int len=0;

len=[(NSInputStream *)stream read:buffer maxLength:1024];
if(len>0){  

    [data appendBytes:&buffer length:len];
    //BYTE ARRAY OBTAINED OK!!
    ///////////////////////////////////////////////////////

    //METHOD #1 - Yields 'nil'
    NSString *string = [[NSString alloc] initWithData:data
                                             encoding:NSUTF8StringEncoding];

    ///////////////////////////////////////////////////////
    //METHOD #2 - Log prints OK, but messageString says
    //'invalid' in debugger, and get warnings all over the 
    //place. I know this is wrong, but it semi-works :)

    size_t length=[data length];
    unsigned char aBuffer[length];
    [data getBytes:aBuffer length:length];
    aBuffer[length - 1]=0;

    NSString *messageString =aBuffer; 
    NSLog (@"%s",messageString);

    ///////////////////////////////////////////////////////

}else{
    NSLog(@"No Buffer");
} 
```

Please help! Any assistance provided is GREATLY appreciated.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-10T20:51:53.930

I got the answer.

I had to change this:

```
NSString *string = [[NSString alloc] initWithData:data
                                         encoding:NSUTF8StringEncoding]; 
```

To this:

```
NSString *string = [[NSString alloc] initWithData:data
                                         encoding:NSASCIIStringEncoding]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T20:44:32.760

This is wrong:

```
[data appendBytes:&buffer length:len]; 
```

It should be:

```
[data appendBytes:buffer length:len]; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-10T20:43:12.047

```
NSString* string = [NSString stringWithUTF8String: data]; 
```

Make sure your data is null-terminated, obviously.

# delphi - 如何在 Delphi 7 应用程序中启用 OLEDB 资源池

> ID：738677
> 
> 赞同：1
> 
> 时间：2009-04-10T19:48:13.647
> 
> 标签：delphi, oledb, connection-pooling

在 Delphi 7 应用程序中启用池需要做什么？我的连接字符串是：

提供程序=SQLOLEDB.1；初始目录=%s；数据源=%s；密码=%s；用户 ID=%s；OLE Db 服务=-1

我可以通过查看 SQLServer:GeneralStatistics UserConnections 性能计数器来判断连接池没有实现——当我的应用程序运行时它会剧烈波动。通过连接池，我希望它能够达到稳定状态。此外，我看到 Logins/sec 和 Logouts/sec 计数器都非常高 - 如果使用连接池，Logouts/sec 将为零或接近零。

在搜索中，我发现了这篇关于资源池的文章：

[http://www.ddj.com/database/184416942](http://www.ddj.com/database/184416942)

它建议“如果您使用 ATL 在 OLEDB SDK（或 COM）级别工作，则必须编写更多代码”（除了将 OLE Db Services=-1 添加到连接字符串）以获得连接池：

CDataSource 数据库；CDBPropSet dbinit(DBPROPSET_DBINIT);

dbinit.AddProperty(DBPROP_AUTH_USERID, "MyName); dbinit.AddProperty(DBPROP_INIT_DATASOURCE, "MyServer); dbinit.AddProperty(DBPROP_INIT_CATALOG, "MyDb); dbinit.AddProperty(DBPROP_INIT_PROMPT, (short)4); dbinit.AddProperty(DBPROP_INIT_LCID, (long)1033); dbinit.AddProperty(DBPROP_INIT_OLEDBSERVICES, (long)DBPROPVAL_OS_ENABLEALL); HRESULT hr = db .OpenWithServiceComponents(_T("sqloledb"), &dbinit);

不幸的是，该代码对我来说是希腊语，我不确定如何将其翻译为 Delphi（或者是否有必要）。

我也小心不要更改连接字符串。关于我可能需要做些什么来启用资源池的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T23:24:46.323

您需要始终保持一个连接实例处于打开状态...如果它降至零，则 ADO 将重新建立连接以对用户进行身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T20:33:35.407

您没有提到它，但是您是否使用 Delphi 的 ADO 实现（dbGo for Delphi 7，IIRC）进行数据访问？如果是这样，您是否通过同一个 TADOConnection 连接所有内容？如果是这样，它应该为您的应用程序进行池化（这意味着您的应用程序的一个运行副本正在使用与数据库服务器的一个连接）。

# c# - 在 wpf 中显示继承对象的最佳方法是什么？

> ID：738678
> 
> 赞同：0
> 
> 时间：2009-04-10T19:48:20.370
> 
> 标签：c#, wpf

可以说我有这个：

```
public class Result 
{
   public bool Success { get; set; }
   public string Description { get; set; }
} 
```

然后我想添加另一个级别，如下所示：

```
public class AssertionFailedResult : Result
{
  public string Expected { get; set; }
  public string Actual { get; set; }
} 
```

在 WPF 中，我将如何以一种方式显示简单的结果，而以另一种方式显示断言失败的结果？我想基本上根据类型制作一个模板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T20:09:59.833

如果您在资源字典中创建 DataTemplate 并设置 DataType 属性，但未设置 x:Key 属性，则框架将根据对象的运行时类型将 DataTemplate 关联到对象。无论好坏，继承都没有效果。换句话说，即使您*没有*DataType 为“AssertionFailedResult”的模板，框架也不会将*“* AssertionFailedResult”类型的对象绑定到 DataType 为“Result”的模板。

**编辑：**对不起，我把它弄反了。DataTemplates*确实*具有“多态”行为。样式没有。在任何情况下，框架都应该使用更具体的 DataType 绑定到 DataTemplate。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T18:59:44.190

我接受了丹尼尔的回答，并从中举了一个例子。我认为发布代码可能会有所帮助：

```
<Window x:Class="SampleWpfApplication.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:SampleWpfApplication="clr-namespace:SampleWpfApplication">
    <Window.Resources>
        <DataTemplate DataType="{x:Type SampleWpfApplication:Result}">
            <Label>Simple Result</Label>            
        </DataTemplate>
        <DataTemplate DataType="{x:Type SampleWpfApplication:AssertionFailedResult}">
            <Label>Assertion Failed!</Label>
        </DataTemplate>
    </Window.Resources>
    <ContentControl x:Name="contentControl" Content="{Binding Path=Result}" />
</Window> 
```

接下来，一个模型类，它是窗口的数据上下文：

```
public class Model
{
    public Result Result { get; set; }
} 
```

在 MainWindow 中，我将 DataContext 设置如下：

```
DataContext = new Model()
                  {
                      Result = new AssertionFailedResult()
                                   {
                                       Success = false,
                                       Description = "Assertion failed",
                                       Expected = "1",
                                       Actual = "1"
                                   }
                  }; 
```

因此，使用 DataTemplate，wpf 知道如何在我没有任何额外指导的情况下呈现控件。再次感谢，丹尼尔。

# sql-server - 在 Microsoft SQL Server 中查找完全匹配的函数

> ID：738684
> 
> 赞同：1
> 
> 时间：2009-04-10T19:51:56.460
> 
> 标签：sql-server

在 Microsoft SQL Server 的给定字符串中找到完全匹配的子字符串的方法是什么？

例如，在字符串'0000020354'中，我想找到'20354'。当然，它必须是完全匹配的。我尝试使用 CHARINDEX(@providerId, external_prv_id) > -1，但 CHARINDEX 的问题是它在找到第一个匹配项后立即给我索引。

基本上我在 Microsoft SQL SERVER 中寻找类似 indexOf("") 的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T19:58:36.663

假设`@ProviderId`是一个`VARCHAR`

你可以使用`LIKE`：

```
SELECT Id FROM TableName WHERE Column LIKE '%' + @ProviderId + '%' 
```

这将返回`Column`包含 2034 的行。

如果你不想使用`LIKE`，你可以使用`PATINDEX`：

```
SELECT Id FROM TableName WHERE PATINDEX('%' + @ProviderId + '%', Column) > 0 
```

它返回它找到的任何匹配的起始位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T16:02:24.473

LIKE %VAL% 内容将过于宽泛，例如数据库包含 00000012345 并且您搜索 1234 您将拉出这一行，这是 OP 不打算的（如果我正确理解“EXACT”部分）。

您想要的是一个正则表达式，它执行以下操作：任意数量的零后跟匹配和行尾。

从这个问题我们知道如何修剪前导零： [在 SQL Server 中修剪前导零的更好技术？](https://stackoverflow.com/questions/662383/better-techniques-for-trimming-leading-zeros-in-sql-server)

```
SUBSTRING(str_col, PATINDEX('%[^0]%', str_col+'.'), LEN(str_col)) 
```

因此，将其与您的查询结合起来，您可以执行以下操作：

```
WHERE SUBSTRING(external_prv_id, PATINDEX('%[^0]%', external_prv_id+'.'), LEN(external_prv_id)) = '12345' 
```

当然，更好的（最好的？）解决方案是将它们存储为 INTEGERS，这样您就可以获得完全的可索引性，而不必为所有这些废话而烦恼。如果您真的需要存储确切的字符串，那么您有几个选择：

*   将标准化整数结果存储在另一列中，并将其用于所有内部查询
*   总是存储一个整数，然后在查询时用零填充（我的投票）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T20:01:09.387

你存储的数据是什么？听起来另一种存储类型（例如单独的表）可能更合适。

* * *

啊，2034 是一个错字。我从你的问题中不明白的是你说你需要完全匹配。如果 CHARINDEX 为“20354”返回非零值，则您知道它匹配“20354”。如果您不知道是什么`@providerId`，请在查询中将其与 CHARINDEX 的结果一起返回。同样，如果你想`external_prv_id`，包括，例如：

```
SELECT external_prv_id, CHARINDEX(@providerId, external_prv_id)
       WHERE CHARINDEX(@providerId, external_prv_id) > 0 
```

（请注意，CHARINDEX 返回 0 表示*未*找到。）

如果您实际上的意思是“20354”可以包含通配符，则需要 PATINDEX。

# c# - 什么时候可以使用结构而不是类

> ID：738685
> 
> 赞同：3
> 
> 时间：2009-04-10T19:52:06.287
> 
> 标签：c#, .net, vb.net

在我最近的一个项目中，我在课堂上创建了一个结构来解决我遇到的一个问题，当一位同事看着我的肩膀时，他嘲笑地看着这个结构并说“把它移到课堂上”。

我没有任何理由不将它移动到一个类中，除了我**只**在这个类中需要它但是这种跌倒是因为我不能让它成为一个嵌套类吗？

什么时候可以使用结构？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-10T19:56:38.367

您应该查看值类型使用指南： http: [//msdn.microsoft.com/en-us/library/y23b5415 (vs.71).aspx](http://msdn.microsoft.com/en-us/library/y23b5415(vs.71).aspx)

文章列出了几个重点，但我觉得最有价值的几点如下

*   价值是不变的吗？
*   您希望该类型具有值语义吗？

如果这两个问题的答案都是肯定的，那么您几乎肯定想要使用结构。否则我会建议去上课。

使用具有大量成员的结构存在问题。但我发现，如果我考虑以上两点，我的值类型中很少有超过推荐的成员数/大小。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-10T19:57:10.957

MSDN 有一个很好的[指南文档](http://msdn.microsoft.com/en-us/library/y23b5415(vs.71).aspx)来涵盖结构的使用。总结一下：

*   像原始类型一样工作。
*   实例大小小于 16 字节。
*   是不可变的。
*   值语义是可取的。

否则，使用一个类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T23:46:31.060

您应该始终使用 a`Class`作为您的首选，`Structure`仅出于非常具体的原因更改为（正如其他人已经概述的那样）。

根据您“仅在此类中需要它”的程度，您可以通过使用[匿名类型来完全避免嵌套类型](http://msdn.microsoft.com/en-us/library/bb384767.aspx)；这仅适用于**单一**方法：

```
Public Class Foo
    Public Sub Bar
        Dim baz = New With { .Str = "String", .I = 314 }
    End Sub
End Class 
```

你不能（很容易——你可以用泛型做一些事情）以类型安全的方式将实例移到`baz`外部。`Sub`当然 an`Object`可以保存任何东西，甚至是匿名类型的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T10:19:16.670

如果您需要复制对象或不希望它被传递的函数修改，我认为结构很棒。由于传递的函数不能修改最初传递的结构，而是获得它的新副本，这可以挽救生命。（除非它们显然是作为 ByRef 传递的）并且可以为您省去 .NET 中深度复制疯狂的麻烦或实现 ICloneSomething 实现的痛苦。

但总体思路是以更语义化的方式定义自定义数据结构。

关于移动到一个类，如果你要移动到一个类，它将成为一个类的一部分，通常这是一个很好的做法，因为你的结构有 99% 的时间与你的一个类相关，而这些类与命名空间无关。

如果要将其转换为类，那么您需要考虑“它是否定义了数据结构”和“它是否昂贵？” 因为它会被到处复制，“你想受到路人修改的影响吗？”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T08:08:24.200

Marc 和 Rex 引用的使用指南非常出色，很好地涵盖了您不确定自己想要哪一个的情况。*我将列出一些需要*使用结构的用例。

*   当你需要在内存中设置字段的布局时
    *   与非托管代码互操作。
    *   当你想制作[Unions](http://msdn.microsoft.com/en-us/library/acxa5b99.aspx)时。
*   您需要内联[固定大小的缓冲区](http://msdn.microsoft.com/en-us/library/zycewsya.aspx)。
*   您希望能够以*相对*安全的方式执行 reinterpret_cast 的等效操作（只要该结构不包含任何本身就是引用类型的字段。

这些通常是边缘情况，并且（互操作除外）不推荐实践，除非它们的使用对于项目/计划的成功是*必要的。*

# c# - .NET 中的标志枚举

> ID：738687
> 
> 赞同：4
> 
> 时间：2009-04-10T19:52:25.850
> 
> 标签：c#, .net, enums, enum-flags

我正在尝试使用一组条件语句来设置一个带有 [Flags] 属性的枚举。但是，编译器抱怨 'm' 未分配。如何重写以下内容以实现我的预期功能？

```
Media m;
if (filterOptions.ShowAudioFiles)
    m = m | Media.Audio;
if (filterOptions.ShowDocumentFiles)
    m = m | Media.Document;
if (filterOptions.ShowImageFiles)
    m = m | Media.Image;
if (filterOptions.ShowVideoFiles)
    m = m | Media.Video; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-10T19:54:08.123

您需要初始化 m。创建一个值为 0 的“无”标志，然后：

```
Media m = Media.None; 
```

然后是其余的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T20:15:03.813

你也可以写：

```
Media m = default(Media) 
```

在您不知道枚举、类或它是否是值/引用类型的情况下很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T19:54:00.230

如果没有一个条件为真，m 将是未定义的。将其设置为初始值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T19:54:49.667

你有像 filterOptions.ShowNone 这样的“默认”吗？如果是这样，从设置 m 开始。编译器抱怨是因为在所有 if 的末尾，m 可能没有设置为任何值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T20:06:44.333

除了上述答案之外，除了这段代码看起来相当多余的事实之外，我还建议您使用 Select Case 而不是所有那些丑陋的 If。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-04-10T20:04:09.177

你真的不需要创建一个`Media.None`. 您可以将任何值强制转换为 Flag 枚举，即使它不等于标志的值。

```
Media m = (Media)0;

if (filterOptions.ShowAudioFiles)     m |= Media.Audio; 

if (filterOptions.ShowDocumentFiles)  m |= Media.Document; 

if (filterOptions.ShowImageFiles)     m |= Media.Image; 

if (filterOptions.ShowVideoFiles)     m |= Media.Video; 
```

# java - 具有子图同构问题支持的 Java 库？

> ID：738688
> 
> 赞同：3
> 
> 时间：2009-04-10T19:52:51.170
> 
> 标签：java

我正在尝试分析 C 文件中“#include”的用法（首先包含什么，依赖项......）。

为此，我从 C 文件中提取“#include”并构建图表。我想确定此图中的常见模式...

到目前为止，我使用 JGraphT 作为图形引擎（不确定这是不是正确的表达式）和 JGraph 进行渲染（但是使用 jgraph 有点问题，因为免费版本中不再包含布局）。

我一直无法在 jgrapht 中找到任何同构支持。您知道提供这种支持的任何解决方案（类似于 igraph，但用于 java）..？

我正在使用 java 1.5，建议的解决方案必须是免费的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T14:10:44.720

不确定其中一个可以做同构，但我在我的博客中收集了几个指向图形布局引擎的链接：http: [//blog.pdark.de/2009/02/11/graph-layout-in-java/](http://blog.pdark.de/2009/02/11/graph-layout-in-java/)

您可能还想查看[graphviz](http://www.graphviz.org/)。它不是 Java，但有一个非常强大的布局引擎。

至于同构：您可能只需要检查级别 0 的模式（即直接包含），因为根据定义，低于该级别的任何内容都必须是同构的（某些包含文件包含的所有文件将始终相同，除非有人使用了很多 #如果包含部分中有魔法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-25T16:43:20.303

你看过[Parsemis](https://github.com/timtadh/parsemis)吗？

它是一个 Java 图挖掘库，并且（子）图同构是这个过程的基础，所以我猜他们正在以某种方式解决这个问题。

虽然不确定许可证，但我相信它是开源的，因为它是出于学术原因而开发的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T23:21:55.440

我当然不知道具有子图同构代码的特定图形库——因为它是已知的 NP 完全的，所以除了搜索之外你不能做很多事情。它在图形重写方案中出现了很多，因此[AGG](http://www.user.tu-berlin.de/o.runge/agg/agg-docu.html)可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T15:33:21.020

看起来几个月前在 JGraphT 的“实验”包中[提到了同构，但显然没有文档。](http://jgrapht.wikispaces.com/message/view/home/8762478)

同构比较是化学信息学软件的基本要求（从技术上讲，它使用的是[单态](https://stackoverflow.com/questions/459799/whats-the-difference-between-subgraph-isomorphism-and-subgraph-monomorphism)）。原子是“节点”，键是“边”。分子图是无向的，可以是循环的。一些用 Java 编写的开源化学信息学库是可用的。通过查看这些库，您也许可以找到一些解决问题的线索。

例如，我编写了一个 BSD 许可的化学信息学库，名为[MX](http://code.google.com/p/mx-java/)，它实现了基于[VF](http://amalfi.dis.unina.it/graph/db/vflib-2.0/doc/vflib.html)的单态算法。我写了关于算法是如何实现[的高级概述](http://depth-first.com/articles/2008/11/17/substructure-search-from-scratch-in-java-part-1-the-atom-mapping-problem)，您可以在我的 GitHub 存储库中[浏览映射包的源代码。](http://github.com/rapodaca/mx/tree/039a8cd74ca4fc6cf9bedec01325cbd11c110720/src/com/metamolecular/mx/map)大部分工作在[DefaultState](http://github.com/rapodaca/mx/blob/039a8cd74ca4fc6cf9bedec01325cbd11c110720/src/com/metamolecular/mx/map/DefaultState.java)类中完成。

MX 还包括一个快速[详尽的环形检测器](http://depth-first.com/articles/2008/12/16/exhaustive-ring-perception)和其他可能适用于您的问题的图形操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T20:09:21.973

我最近一直在思考这个问题（在我的例子中，我正在寻找将 JSP 分解为标签的通用标记结构）。

一个图书馆会很棒。我还没有找到一个。同时，这里有几个问题可能与您的问题有关（同构？）。

*   我正计划研究数学软件用于分析评估微积分问题中的积分的技术。在这种情况下，有一堆已知的结构模式，并且所讨论的问题必须与其中一个已知模式相匹配。做到这一点的最佳方法并不总是显而易见的，因为它取决于将哪些术语组合在一起等。

*   生物学中用于在两个复杂分子中找到相应结构的算法也可能适用于这个问题。

# c# - 覆盖 OnPaint

> ID：738694
> 
> 赞同：3
> 
> 时间：2009-04-10T19:54:57.857
> 
> 标签：c#, winforms, designer, windows-forms-designer

如果我重写 OnPaint 并在控件上绘制一个正方形，当我在设计器中预览它时，如何让 e.graphics.draw... 显示出来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T19:56:33.033

[http://msdn.microsoft.com/en-us/magazine/cc164048.aspx](http://msdn.microsoft.com/en-us/magazine/cc164048.aspx)

[http://msdn.microsoft.com/en-us/magazine/cc164145.aspx](http://msdn.microsoft.com/en-us/magazine/cc164145.aspx)

> 虽然您可以手动注册 Control.OnPaint 以添加设计时 UI，但您会发现覆盖 OnPaintAdornments 是一个更好的选择，因为它仅在绘制控件的设计时/运行时 UI 后调用，让您将锦上添花（见图 20）。只需将 DesignerAttribute 添加到 ClockControl 类即可完成关联：复制代码
> 
> [设计师（typeof（ClockControlDesigner））]类时钟控制：控制{...}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T19:57:44.247

如果您尝试为控件绘制焦点矩形，并且在将控件添加到表单后对其进行操作时使其可见，那么[Gaijin42 的方法](https://stackoverflow.com/questions/738694/override-onpaint/738700#738700)应该可以工作。

如果您想查看自定义绘制控件的外观...

*   如果您已经重写了控件中的方法，那么在将控件添加到表单（或另一个控件）后查看控件时`OnPaint`，您应该会看到该方法的结果。`OnPaint`

*   如果您在查看`Paint`控件本身的设计器时试图查看结果，[我认为这是不可能的](http://www.dotnetmonster.com/Uwe/Forum.aspx/winform-controls/4329/UserControl-Painting-in-Control-Designer)（至少它不是 VS2005）：

    > 不幸的是，这是不可能的。当您编写用户控件的行为时，不会编译代码，设计器实际上使用普通用户控件来承载子控件。覆盖等将`OnPaint` 不会运行。
    > 
    > 要调试控件中的覆盖，您需要在某种主机中运行它。VS2005为此提供了一个新的控制主机，但我发现有时这还不够。

# java - 如何有效地从 Android 上的资源中获取短数组？

> ID：738708
> 
> 赞同：7
> 
> 时间：2009-04-10T19:59:12.853
> 
> 标签：java, android, arrays, resources

我有一个 XML 文件，在我的资源中存储了一组短裤。我需要分配这个数组，但 Android API 只提供了一种获取整数数组（`getResources.getIntArray()`）的方法。我最终得到了一个整数数组并稍后将其转换为短裤数组，但这并不理想。

有没有办法从 Android 资源中获取一系列短裤？如果没有，是否有更有效/更清洁的方式将 int 数组转换为短数组？我的代码目前如下所示：

```
int indicesInt[] = context.getResources().getIntArray(R.array.indices);
short indices[] = new short[indicesInt.length];
for (int i = 0; i < indicesInt.length; i++) {
    indices[i] = (short)indicesInt[i];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T19:23:19.920

无法直接检索一系列短裤 AFAIK。看看你是否可以只使用`int[]`代替你的`short[]`. 如果您正在使用库或其他东西并且无法更改要求，那么您的示例几乎是最好的方法。警惕可能的溢出。

# restful-authentication - 如何使用 Restful 身份验证识别 @user.id？

> ID：738717
> 
> 赞同：1
> 
> 时间：2009-04-10T20:03:21.097
> 
> 标签：restful-authentication

我刚刚安装了 Restful 身份验证。

有人成功登录后，他们会撰写评论——就像您对博客发表评论一样。

我如何知道身份验证用户的 user_id 列的值，以便我可以将其放入评论表中以匹配用户进行评论？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T01:00:45.663

我不是 100% 确定这一点，但在你的控制器中尝试 @current_user.id

# asp.net-mvc - 为什么 ASP.NET MVC 路径出现变量？

> ID：738718
> 
> 赞同：2
> 
> 时间：2009-04-10T20:03:29.897
> 
> 标签：asp.net-mvc, model-view-controller

在我的 MVC 应用程序中，为什么

```
Return RedirectToAction("Edit", "Forms", New With {.member = "123"}) 
```

返回

```
http://localhost:13/Forms/Edit?member=123 
```

安装的

```
http://localhost:13/Forms/Edit/123 
```

?

为什么

```
<%=Html.ActionLink("MyLink", "Edit", "Forms", New With {.member = "123"}, Nothing)%> 
```

做同样的事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T20:19:54.020

正如 tvanfosson 所说，“id”是默认路由引擎设置要查找的内容。作为第三个参数的任何其他内容都将作为查询字符串进行处理。

为什么？由于 Global.asax 中的这种方法：

```
routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = "" }
); 
```

您可以通过添加额外的 routes.MapRoute() 行来更改此设置，如下所示：

```
routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = "" }
);

routes.MapRoute(
    "Default2",
    "{controller}/{action}/{member}",
    new { controller = "Home", action = "Index", member = "" }
); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T20:09:20.317

标准路由设置为使用 id 作为第三个参数。将“member”更改为“id”，您将获得您期望的路线。

```
Return RedirectToAction("Edit", "Forms", New With { .id = "123"}) 
```

# .net - 从 .NET 程序集获取 ProgID

> ID：738720
> 
> 赞同：4
> 
> 时间：2009-04-10T20:04:39.550
> 
> 标签：.net, reflection, com, .net-2.0

我想编写一个程序来从 .NET 程序集中查找所有 com 可见的 .NET 类及其 ProgID。最好的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T20:54:33.173

这将获得 ProgId 而不是 ClassId，如果整个程序集标记为可见，也可以工作：

```
 Assembly assembly = Assembly.LoadFile("someassembly.dll");

        bool defaultVisibility;
        object[] assemblyAttributes = assembly.GetCustomAttributes(typeof(ComVisibleAttribute),false);
        if (assemblyAttributes.Length == 0)
            defaultVisibility = false;
        else
            defaultVisibility = (assemblyAttributes[0] as ComVisibleAttribute).Value;

        foreach(Type type in assembly.GetTypes())
        {
            bool isComVisible = defaultVisibility;
            object []attributes = type.GetCustomAttributes(typeof(ComVisibleAttribute),true);
            if (attributes.Length > 0)
                isComVisible = (attributes[0] as ComVisibleAttribute).Value;
            if (isComVisible)
            {
                attributes = type.GetCustomAttributes(typeof(ProgIdAttribute),true);
                if (attributes.Length >0)
                {
                    Console.WriteLine(String.Format("Type {0} has ProgID {1}",type.Name,(attributes[0] as ProgIdAttribute).Value));
                }
            }
        } 
```

# iphone - 如何直接从 UITableView 中删除单元格？

> ID：738727
> 
> 赞同：5
> 
> 时间：2009-04-10T20:07:10.900
> 
> 标签：iphone, cocoa-touch

是否可以通过动画直接从 UITableView 中删除单元格？不更改数据源然后重新加载表数据？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T22:23:17.330

在 UITableView 你有方法：

```
 (void)deleteRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation; 
```

有一个类似的方法来删除一个部分。

但是，您最好在调用之前更新您的数据模型，否则滚动表格可能会产生奇怪的结果！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T20:22:14.110

不确定“更改数据源”是什么意思，因为删除一行就像从填充表的数组（您的数据源正在使用的数组）中删除一个对象一样简单，然后重新加载表。

没有动画，没有数据源交换。

# gwt - 当用户离开 GXT 网格时，我可以捕捉到哪些事件？

> ID：738738
> 
> 赞同：0
> 
> 时间：2009-04-10T20:12:44.507
> 
> 标签：gwt, gxt

我有一个广泛使用 GXT（1.2.2 版）网格的网络应用程序。如果他们进行了更改但不保存，我想警告用户。

当我在弹出对话框中使用网格时，用户离开的唯一方法是通过按钮（关闭或确定）。如果我将 SelectionListener 添加到关闭按钮，我可以进行“isDirty()”检查并警告用户。

如果我不使用对话框，则不存在离开页面的限制。用户可以点击侧边菜单，选择不同的选项卡，点击我们在每个页面上的刷新或下一页按钮。我可以监听每个人的事件，但有没有更简单的方法？类似于“卸载前”事件被触发？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T20:14:43.863

[Window.addCloseListener](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/user/client/Window.html#addWindowCloseListener(com.google.gwt.user.client.WindowCloseListener))

或者在 GWT 1.6 中：

[Window.addCloseHandler](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/Window.html#addCloseHandler(com.google.gwt.event.logical.shared.CloseHandler))

您无法阻止窗口关闭，但您可以提示用户单击取消，这将使页面保持打开状态。您还可以在用户选择确认窗口关闭之后但在您的页面卸载之前执行最后一次保存操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-09T23:32:56.253

尝试这个：

```
Window.addListener(Events.Close,
     new Listener<ComponentEvent>() {
          public void handleEvent(ComponentEvent be) {
                //Do something
          }
}); 
```

***或者***

```
Window.addListener(Events.Detach,
         new Listener<ComponentEvent>() {
              public void handleEvent(ComponentEvent be) {
                    //Do something
              }
    }); 
```

# events - 从包含页面中的请求变量填充的用户控件

> ID：738739
> 
> 赞同：0
> 
> 时间：2009-04-10T20:12:50.870
> 
> 标签：events, user-controls, load, ascx

我有一个用户控件，可以在 gridview 中显示来自数据库的结果。包含页面接收查询字符串值并将它们传递给用户控件以进行加载。

从包含页面，加载和显示用户控件的最佳方式是什么？目前，我执行以下操作：

1.  包含 Page_Load：获取查询字符串值
2.  包含Page_Load：实例化用户控件
3.  包含Page_Load：设置用户控件的属性
4.  包含 Page_Load：将用户控件添加到页面

我不确定用户控件中使用什么事件来访问数据库并填充控件；我应该在用户控件上创建一个“填充此控件”方法并从包含页面调用它吗？或者在用户控件中使用 Page_Load 例程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T20:36:58.847

如果您的页面没有做任何事情来清理或处理变量，那么用户控件是否有任何理由不能只获取值本身？

如果您确实有理由清理数据，则可以在控件的 Load 事件中加载，但在这种情况下，由于页面似乎正在驱动用户控件的功能，您可能会从“SetupControl”或其他一些方法中受益您可以在配置后调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T22:36:52.443

覆盖`OnDataBinding`用户控件中的方法以访问数据库并根据结果填充控件。您也可以让控件处理 DataBinding 事件。

换句话说，像对待任何其他控件一样对待用户控件。

# java - 查询 DNS 服务记录以查找主机名和 TCP/IP

> ID：738750
> 
> 赞同：7
> 
> 时间：2009-04-10T20:17:33.153
> 
> 标签：java, dns, host, bioinformatics

Roderic DM Page 博士在一篇关于**生命科学标识符**的论文（参见[LSID Tester，一种用于测试生命科学标识符解析服务的工具）中写道：](http://www.scfbm.org/content/3/1/2)

给定 LSID urn:lsid**:ubio.org**:namebank:11815，在 DNS 中查询 _lsid._tcp 的 SRV*记录*。**ubio.org**返回 animalia.ubio.org:80 作为 ubio.org LSID 服务的位置。

我了解到我可以使用 unix 上的**host**命令将 _lsid._tcp.ubio.org 链接到 animalia.ubio.org:80：

```
host -t srv _lsid._tcp.ubio.org
_lsid._tcp.ubio.org has SRV record 1 0 80 ANIMALIA.ubio.org 
```

我如何使用 Java J2SE API 来做这个“DNS”事情（没有任何外部 Java 库，我想要一个轻量级的解决方案）？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-25T05:35:53.577

JNDI DNS 提供者可以查找 SRV 记录。您需要执行以下操作：

```
Hashtable env = new Hashtable();
env.put("java.naming.factory.initial", "com.sun.jndi.dns.DnsContextFactory");
env.put("java.naming.provider.url", "dns:");
DirContext ctx = new InitialDirContext(env);
Attributes attrs = ctx.getAttributes("_lsid._tcp.ubio.org", new String[] { "SRV" }); 
```

返回的属性是看起来像“1 0 80 ANIMALIA.ubio.org”的字符串枚举。空格分隔的字段按顺序排列：

1.  优先事项
2.  重量
3.  港口
4.  服务器

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-11T14:49:44.587

使用标准 Java 库无法做到这一点。该类`InetAddress`只能查找 DNS`A`记录。

要查找`SRV`记录（实际上是除记录之外的任何其他 DNS 资源记录类型`A`），您需要第三方库。 [`dnsjava`](http://www.dnsjava.org/)是通常的选择。

我个人在 Google Android 上使用过 1.6 版本，效果很好。2.0 及更高版本使用 Java`nio`层，因此与早期的 JVM 不兼容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T20:26:27.330

我认为如果不使用一些外部库，您将无法做到这一点。[java.util.InetAddress](http://java.sun.com/javase/6/docs/api/java/net/InetAddress.html)有一些通过 DNS 解析名称的方法，但它仅可用于将名称解析为 IP 地址，而不能用于通用 DNS 查询。

为此，您需要一些外部库，例如[DNSJava](http://www.dnsjava.org/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-25T19:03:58.090

如果有人正在寻找非 Java 解决方案（他们可能会认为问题的标题不是特定于语言的），当我实现 LSID 时（参见[doi:10.1186/1751-0473-3-2](http://dx.doi.org/10.1186/1751-0473-3-2 "doi:10.1186/1751-0473-3-2")）我使用PEAR 包[Net_DNS](http://pear.php.net/package/Net_DNS "Net_DNS")，可以查找 SRV 记录。

# objective-c - json-framework 不适用于 iPhone SDK 3.0

> ID：738752
> 
> 赞同：0
> 
> 时间：2009-04-10T20:19:01.433
> 
> 标签：objective-c, iphone, json

[将 JSON 框架http://code.google.com/p/json-framework/](http://code.google.com/p/json-framework/)与 iPhone SDK 3.0 一起使用时，我似乎无法编译我的应用程序。

我的应用程序在模拟器上编译得很好，但是当我为我的设备编译时，我得到一个“代码设计错误”代码 1。我正确地遵循了所有的安装说明，当我删除了“附加 SDK”参考和“其他链接器标志：-Obj-C -ljson' 它编译得很好......但显然我不能在我的应用程序中使用 JSON。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T22:45:37.877

您可能只想切换到代码版本而不是在静态库中链接。

它应该在 3.0 上编译并正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-25T01:56:48.503

在我自己的项目中，我也遇到了这个问题。我无法使用 iPhone 3.0 SDK 为 iPhone OS 2.x 构建我的应用程序。

解决方法是在项目级别设置以下内容（获取信息）：

*   BaseSDK 到 iPhone 设备 3.0
*   iPhone 部署目标到 iPhone OS 2.x
*   代码签名资源规则 相同 2.x plist 的路径（例如 /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS2.0.sdk/ResourceRules.plist）

最后一位允许分发（应用商店）构建以正确进行代码签名...否则您将遇到错误“目标文件格式无效或不合适”，因为默认情况下代码签名者将使用与 BaseSDK 相同的资源规则（即3.0)，这不适合 2.x 应用程序。

此外，请务必在*目标*级别清除上述任何设置（同样，通过获取信息）。

呸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T22:25:45.943

协同设计错误意味着您没有使用当前构建设置尝试编译到的设备的有效配置文件。

您可以构建示例应用程序并将其部署到您的手机吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-07T12:13:43.860

我开始为 iPhone 使用可爱的 json 框架，但突然发现，如果我为设备编译大于 2.1 的任何东西，它会弹出：代码设计错误：“目标文件格式无效或不合适”很长时间才弄清楚发生了什么，但感谢一篇博客文章，修复是这样的：在项目设置的构建选项卡上，搜索“代码签名资源规则路径”并设置“$(SDKROOT)/ResourceRules .plist”作为它的值。我不确定它是如何工作的，因为它看起来就像它已经拥有的路径，但是嘿，它似乎有效！

这解决了我遇到的代码设计错误，但现在由于某些其他原因我无法在 3.0 上编译。我将尝试链接到代码而不是库。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-10T21:15:15.887

听起来像是您想与开发人员讨论的问题，请参阅[支持小组](http://groups.google.com/group/json-framework)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-12T21:28:24.307

似乎代码签名没有扩展到框架。您是否尝试过以不同方式链接框架？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-01-04T20:51:33.727

对于法国人，这里也有一个教程[（en Français）](http://www.geckogeek.fr/json-sur-iphone-installation-et-exemple.html)

但是对于您的问题，我认为这与 JSON 无关，而与您的主要开发人员有关。

# jquery - 使用 JQuery 对模型绑定操作方法的异步请求

> ID：738753
> 
> 赞同：1
> 
> 时间：2009-04-10T20:19:07.907
> 
> 标签：jquery, asp.net-mvc, ajax

我有一个 ASP.NET MVC 操作方法，它使用模型绑定来接受强类型模型对象作为其输入，即：

```
public PartialViewResult SaveUser([Bind(Prefix = "User")]User NewUser)
{
} 
```

使用 JQuery 异步请求此方法时如何指定参数？我以前使用 load() 或 post() 方法来发出异步请求，但这只有一两个命名参数。如何将带有异步请求的整个表单数据传递给此方法？

这是我尝试过的一种方法：

```
$.post('/Users/SaveUser/', { NewUser: $('#theForm') }, function(responseText, status) {
    $('#mainContent').text(responseText);
}, 'html'); 
```

我在action方法中加了一个断点，NewUser参数为null。

我完全不接受这种方法吗？任何帮助深表感谢。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T20:27:36.703

您需要在输入名称及其值之间创建映射。模型绑定器将期望看到：

```
User.Name=username
User.FirstName=Bill
User.LastName=Gates
... 
```

作为请求的表单参数。尝试使用[序列化](http://docs.jquery.com/Ajax/serialize)方法。

```
$('form').serialize() 
```

为 AJAX 调用构造参数。

# latex - 不要让我在出现错误时手动中止 LaTeX 编译

> ID：738755
> 
> 赞同：71
> 
> 时间：2009-04-10T20:20:39.527
> 
> 标签：latex, automation, prompt, expect, latexmk

正如[这里](https://stackoverflow.com/questions/311118/real-time-latex/398322#398322)所建议的，这`latexmk`是一种在源代码更改时不断编译文档的便捷方法。但是，当您处理文档时，通常会遇到错误，然后`latex`会惊慌失措并等待用户输入，然后再继续。这会变得非常烦人，尤其是最近当我破解了一些东西以`latex`直接从[etherpad](http://etherpad.com)文档编译时，它会在您键入时不断保存。

如果无法编译，是否有设置`latex`或`latexmk`使其只是中止并显示错误消息？或者，如果有必要，我将如何设置某种 Expect 脚本来自动消除 LaTeX 的投诉？

（我曾认为`pdflatex`'s 选项`-halt-on-error`可以解决问题，但显然不是。）

额外的问题：Mac OSX 上的 Skim 是一个不错的 pdf 查看器，它会在 pdf 更改时自动刷新（与预览不同），*除了*每当出现乳胶错误时，它会让您重新确认您想要自动刷新。Texniscope 没有这个问题，但由于[其他原因](https://stackoverflow.com/questions/382608/fonts-in-pdf-documents-screwed)我不得不放弃 Texniscope 。有没有办法让 Skim 总是自动刷新，或者是否有其他查看器可以做到这一点？

* * *

### `latexmk`添加：基于此问题的答案的迷你教程：

1.  `latexmk`到这里： [http](http://www.phys.psu.edu/~collins/software/latexmk-jcc/) : //www.phys.psu.edu/~collins/software/latexmk-jcc/

2.  将以下内容添加到您的`~/.latexmkrc`文件中：

    ```
    $pdflatex = 'pdflatex -interaction=nonstopmode'; 
    ```

    （对于带有脱脂的 OS X）

    ```
    $pdf_previewer = "open -a /Applications/Skim.app"; 
    ```

3.  在编辑源文件时`foo.tex`，在终端中运行以下命令：

    ```
    latexmk -pvc -pdf foo.tex 
    ```

4.  使用[Skim](http://skim-app.sourceforge.net/)或其他实时 pdf 查看器查看 foo.pdf。对于 Skim，只需查看 Skim 首选项中的“同步”选项卡并为您的编辑器进行设置。

瞧！现在点击保存`foo.tex`将导致`foo.pdf`刷新而不接触任何东西。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-10T20:28:20.553

使用 MikTeX，`pdflatex`有这个命令行选项：

```
 -interaction=MODE               Set the interaction mode; MODE must be one
                                  of: batchmode, nonstopmode, scrollmode,
                                  errorstopmode. 
```

* * *

@9999years 建议的编辑：

这些值相当于一组`\commands`提供相同功能的 LaTeX。

来自[TeX 使用提示](http://www.volkerschatz.com/tex/ttips.html)：

> 这些模式使 TeX 以下列方式运行：
> 
> *   `errorstopmode`停止所有错误，无论它们是关于源代码中的错误还是不存在的文件。
>     
>     
> *   `scrollmode`不会因源中的错误而停止，而是会在发生更严重的错误（例如丢失文件）时请求输入。
>     
>     
> *   在有点名不副实的情况`nonstopmode`下，TeX 在严重错误后不会请求输入，而是完全停止。
>     
>     
> *   `batchmode`阻止除此之外的所有输出（用于自动脚本）。在所有情况下，所有错误都会写入日志文件 (yourtexfile.log)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-10-20T13:14:42.143

您也可以将`\nonstopmode`或`\batchmode`放在 tex 文件的开头；那么它将适用于任何 TeX 版本，而不仅仅是`pdflatex`. 有关这些和相关命令的更多信息，请参阅[David Bausum 对（原始）TeX 命令的非常好的参考](http://www.tug.org/utilities/plain/cseq.html)。特别是来自[调试系列](http://www.tug.org/utilities/plain/cseq.html#Debugging-fam)的命令在这里可能很有趣。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-07-21T11:30:20.147

另一种可能的破解方法是简单地使用：

```
yes x | latexmk source.tex 
```

你总是可以为 'yes x | 创建一个别名。latexmk' 如果你要使用这个选项很多。我可以在其他建议上方看到的主要优点是，当您偶尔希望latexmk 表现得像这样时，它非常快。

穆罕默德

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-21T11:38:08.667

还有一个 `\batchmode` 命令可以做这项工作。

# gxt - 如何判断 GXT 触发了哪些事件？

> ID：738757
> 
> 赞同：11
> 
> 时间：2009-04-10T20:22:41.753
> 
> 标签：gxt

我似乎找不到任何关于在 GXT 中触发什么事件以及何时触发的文档。

API 文档列出了所有可能触发的事件（在 中`Events`）。它描述了如何处理您捕获的事件。但我对另一面感兴趣，即当我采取某种行动时会触发哪些事件。

我可以为各种不同的组件设置一些侦听器，或者我可以使用`addListener`特定的事件代码来捕获单个事件。那是参差不齐的，我似乎正在使用反复试验来猜测我可能想要捕捉的内容。

有没有办法记录所有正在触发的事件？或者捕获所有这些，以便我可以在调试器中查看它们？

或者是否有一些我缺少的包含信息的文档？类似于“当您单击小部件时，`ButtonEvent`会触发 a。`Events.x`在悬停时触发，`Events.y`点击时触发。”

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-05-23T12:40:50.867

也许有人会发现这很有用，我创建了实用程序类来查看发生了哪些类型的事件。当然，这个想法是在接受的答案中提出的。

```
import java.util.HashMap;
import java.util.Map;

import com.extjs.gxt.ui.client.event.BaseEvent;
import com.extjs.gxt.ui.client.event.EventType;
import com.extjs.gxt.ui.client.event.Events;
import com.extjs.gxt.ui.client.event.Listener;
import com.extjs.gxt.ui.client.widget.Component;

/**
 * Class for debugging purposes. Sometimes it is hard to tell what type of event
 * is invoked and when. During debug process you can just do:
 * 
 * EventUtils.attachDebugListeners(c);
 * EventUtils.attachDebugListeners(c, "NAME");
 * 
 * You'll then get information about events as they are invoked.
 * 
 * List of events copied from {@link Events} class.
 * 
 */
public class EventUtils {

    public static void attachDebugListeners(final Component c) {
        attachDebugListeners(c, null);
    }

    public static void attachDebugListeners(final Component c, final String msg) {
        for (final EventType type : eventTypeNames.keySet()) {
            c.addListener(type, new Listener<BaseEvent>() {
                @Override
                public void handleEvent(BaseEvent be) {
                    String typeName = eventTypeNames.get(type);
                    if (msg != null)
                        System.out.print(msg + " -> ");
                    System.out.println(typeName);
                }
            });
        }
    }

    final static Map<EventType, String> eventTypeNames = new HashMap<EventType, String>();
    static {
        eventTypeNames.put(Events.Activate, "Events.Activate");
        eventTypeNames.put(Events.Add, "Events.Add");
        eventTypeNames.put(Events.Adopt, "Events.Adopt");
        eventTypeNames.put(Events.AfterEdit, "Events.AfterEdit");
        eventTypeNames.put(Events.AfterLayout, "Events.AfterLayout");
        eventTypeNames.put(Events.ArrowClick, "Events.ArrowClick");
        eventTypeNames.put(Events.Attach, "Events.Attach");
        eventTypeNames.put(Events.AutoHide, "Events.AutoHide");
        eventTypeNames.put(Events.BeforeAdd, "Events.BeforeAdd");
        eventTypeNames.put(Events.BeforeAdopt, "Events.BeforeAdopt");
        eventTypeNames.put(Events.BeforeBind, "Events.BeforeBind");
        eventTypeNames.put(Events.BeforeCancelEdit, "Events.BeforeCancelEdit");
        eventTypeNames.put(Events.BeforeChange, "Events.BeforeChange");
        eventTypeNames
                .put(Events.BeforeCheckChange, "Events.BeforeCheckChange");
        eventTypeNames.put(Events.BeforeClose, "Events.BeforeClose");
        eventTypeNames.put(Events.BeforeCollapse, "Events.BeforeCollapse");
        eventTypeNames.put(Events.BeforeComplete, "Events.BeforeComplete");
        eventTypeNames.put(Events.BeforeEdit, "Events.BeforeEdit");
        eventTypeNames.put(Events.BeforeExpand, "Events.BeforeExpand");
        eventTypeNames.put(Events.BeforeHide, "Events.BeforeHide");
        eventTypeNames.put(Events.BeforeLayout, "Events.BeforeLayout");
        eventTypeNames.put(Events.BeforeOpen, "Events.BeforeOpen");
        eventTypeNames.put(Events.BeforeOrphan, "Events.BeforeOrphan");
        eventTypeNames.put(Events.BeforeQuery, "Events.BeforeQuery");
        eventTypeNames.put(Events.BeforeRemove, "Events.BeforeRemove");
        eventTypeNames.put(Events.BeforeRender, "Events.BeforeRender");
        eventTypeNames.put(Events.BeforeSelect, "Events.BeforeSelect");
        eventTypeNames.put(Events.BeforeShow, "Events.BeforeShow");
        eventTypeNames.put(Events.BeforeStartEdit, "Events.BeforeStartEdit");
        eventTypeNames.put(Events.BeforeStateRestore,
                "Events.BeforeStateRestore");
        eventTypeNames.put(Events.BeforeStateSave, "Events.BeforeStateSave");
        eventTypeNames.put(Events.BeforeSubmit, "Events.BeforeSubmit");
        eventTypeNames.put(Events.Bind, "Events.Bind");
        eventTypeNames.put(Events.Blur, "Events.Blur");
        eventTypeNames.put(Events.BodyScroll, "Events.BodyScroll");
        eventTypeNames.put(Events.BrowserEvent, "Events.BrowserEvent");
        eventTypeNames.put(Events.CancelEdit, "Events.CancelEdit");
        eventTypeNames.put(Events.CellClick, "Events.CellClick");
        eventTypeNames.put(Events.CellDoubleClick, "Events.CellDoubleClick");
        eventTypeNames.put(Events.CellMouseDown, "Events.CellMouseDown");
        eventTypeNames.put(Events.CellMouseUp, "Events.CellMouseUp");
        eventTypeNames.put(Events.Change, "Events.Change");
        eventTypeNames.put(Events.CheckChange, "Events.CheckChange");
        eventTypeNames.put(Events.CheckChanged, "Events.CheckChanged");
        eventTypeNames.put(Events.Clear, "Events.Clear");
        eventTypeNames.put(Events.Close, "Events.Close");
        eventTypeNames.put(Events.Collapse, "Events.Collapse");
        eventTypeNames.put(Events.ColumnClick, "Events.ColumnClick");
        eventTypeNames.put(Events.ColumnResize, "Events.ColumnResize");
        eventTypeNames.put(Events.Complete, "Events.Complete");
        eventTypeNames.put(Events.ContextMenu, "Events.ContextMenu");
        eventTypeNames.put(Events.Deactivate, "Events.Deactivate");
        eventTypeNames.put(Events.Detach, "Events.Detach");
        eventTypeNames.put(Events.Disable, "Events.Disable");
        eventTypeNames.put(Events.DoubleClick, "Events.DoubleClick");
        eventTypeNames.put(Events.DragCancel, "Events.DragCancel");
        eventTypeNames.put(Events.DragEnd, "Events.DragEnd");
        eventTypeNames.put(Events.DragEnter, "Events.DragEnter");
        eventTypeNames.put(Events.DragFail, "Events.DragFail");
        eventTypeNames.put(Events.DragLeave, "Events.DragLeave");
        eventTypeNames.put(Events.DragMove, "Events.DragMove");
        eventTypeNames.put(Events.DragStart, "Events.DragStart");
        eventTypeNames.put(Events.Drop, "Events.Drop");
        eventTypeNames.put(Events.EffectCancel, "Events.EffectCancel");
        eventTypeNames.put(Events.EffectComplete, "Events.EffectComplete");
        eventTypeNames.put(Events.EffectStart, "Events.EffectStart");
        eventTypeNames.put(Events.Enable, "Events.Enable");
        eventTypeNames.put(Events.Exception, "Events.Exception");
        eventTypeNames.put(Events.Expand, "Events.Expand");
        eventTypeNames.put(Events.Focus, "Events.Focus");
        eventTypeNames.put(Events.HeaderChange, "Events.HeaderChange");
        eventTypeNames.put(Events.HeaderClick, "Events.HeaderClick");
        eventTypeNames
                .put(Events.HeaderContextMenu, "Events.HeaderContextMenu");
        eventTypeNames
                .put(Events.HeaderDoubleClick, "Events.HeaderDoubleClick");
        eventTypeNames.put(Events.HeaderMouseDown, "Events.HeaderMouseDown");
        eventTypeNames.put(Events.HiddenChange, "Events.HiddenChange");
        eventTypeNames.put(Events.Hide, "Events.Hide");
        eventTypeNames.put(Events.Invalid, "Events.Invalid");
        eventTypeNames.put(Events.KeyDown, "Events.KeyDown");
        eventTypeNames.put(Events.KeyPress, "Events.KeyPress");
        eventTypeNames.put(Events.KeyUp, "Events.KeyUp");
        eventTypeNames.put(Events.LiveGridViewUpdate,
                "Events.LiveGridViewUpdate");
        eventTypeNames.put(Events.Maximize, "Events.Maximize");
        eventTypeNames.put(Events.MenuHide, "Events.MenuHide");
        eventTypeNames.put(Events.MenuShow, "Events.MenuShow");
        eventTypeNames.put(Events.Minimize, "Events.Minimize");
        eventTypeNames.put(Events.Move, "Events.Move");
        eventTypeNames.put(Events.OnBlur, "Events.OnBlur");
        eventTypeNames.put(Events.OnChange, "Events.OnChange");
        eventTypeNames.put(Events.OnClick, "Events.OnClick");
        eventTypeNames.put(Events.OnContextMenu, "Events.OnContextMenu");
        eventTypeNames.put(Events.OnDoubleClick, "Events.OnDoubleClick");
        eventTypeNames.put(Events.OnError, "Events.OnError");
        eventTypeNames.put(Events.OnFocus, "Events.OnFocus");
        eventTypeNames.put(Events.OnKeyDown, "Events.OnKeyDown");
        eventTypeNames.put(Events.OnKeyPress, "Events.OnKeyPress");
        eventTypeNames.put(Events.OnKeyUp, "Events.OnKeyUp");
        eventTypeNames.put(Events.OnLoad, "Events.OnLoad");
        eventTypeNames.put(Events.OnLoseCapture, "Events.OnLoseCapture");
        eventTypeNames.put(Events.OnMouseDown, "Events.OnMouseDown");
        eventTypeNames.put(Events.OnMouseMove, "Events.OnMouseMove");
        eventTypeNames.put(Events.OnMouseOut, "Events.OnMouseOut");
        eventTypeNames.put(Events.OnMouseOver, "Events.OnMouseOver");
        eventTypeNames.put(Events.OnMouseUp, "Events.OnMouseUp");
        eventTypeNames.put(Events.OnMouseWheel, "Events.OnMouseWheel");
        eventTypeNames.put(Events.OnScroll, "Events.OnScroll");
        eventTypeNames.put(Events.Open, "Events.Open");
        eventTypeNames.put(Events.Orphan, "Events.Orphan");
        eventTypeNames.put(Events.Ready, "Events.Ready");
        eventTypeNames.put(Events.Refresh, "Events.Refresh");
        eventTypeNames.put(Events.Register, "Events.Register");
        eventTypeNames.put(Events.Remove, "Events.Remove");
        eventTypeNames.put(Events.Render, "Events.Render");
        eventTypeNames.put(Events.Resize, "Events.Resize");
        eventTypeNames.put(Events.ResizeEnd, "Events.ResizeEnd");
        eventTypeNames.put(Events.ResizeStart, "Events.ResizeStart");
        eventTypeNames.put(Events.Restore, "Events.Restore");
        eventTypeNames.put(Events.RowClick, "Events.RowClick");
        eventTypeNames.put(Events.RowDoubleClick, "Events.RowDoubleClick");
        eventTypeNames.put(Events.RowMouseDown, "Events.RowMouseDown");
        eventTypeNames.put(Events.RowMouseUp, "Events.RowMouseUp");
        eventTypeNames.put(Events.RowUpdated, "Events.RowUpdated");
        eventTypeNames.put(Events.Scroll, "Events.Scroll");
        eventTypeNames.put(Events.Select, "Events.Select");
        eventTypeNames.put(Events.SelectionChange, "Events.SelectionChange");
        eventTypeNames.put(Events.Show, "Events.Show");
        eventTypeNames.put(Events.SortChange, "Events.SortChange");
        eventTypeNames.put(Events.SpecialKey, "Events.SpecialKey");
        eventTypeNames.put(Events.StartEdit, "Events.StartEdit");
        eventTypeNames.put(Events.StateChange, "Events.StateChange");
        eventTypeNames.put(Events.StateRestore, "Events.StateRestore");
        eventTypeNames.put(Events.StateSave, "Events.StateSave");
        eventTypeNames.put(Events.Submit, "Events.Submit");
        eventTypeNames.put(Events.Toggle, "Events.Toggle");
        eventTypeNames.put(Events.TriggerClick, "Events.TriggerClick");
        eventTypeNames.put(Events.TwinTriggerClick, "Events.TwinTriggerClick");
        eventTypeNames.put(Events.UnBind, "Events.UnBind");
        eventTypeNames.put(Events.Unregister, "Events.Unregister");
        eventTypeNames.put(Events.Update, "Events.Update");
        eventTypeNames.put(Events.Valid, "Events.Valid");
        eventTypeNames.put(Events.ValidateDrop, "Events.ValidateDrop");
        eventTypeNames.put(Events.ValidateEdit, "Events.ValidateEdit");
        eventTypeNames.put(Events.ViewReady, "Events.ViewReady");
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T13:29:07.063

我最终使用了蛮力：创建了一个 EventType 和名称的 Map，然后为组件可以接收的每种类型的事件附加一个 Listener。然后我只是在 Listener 中设置了一个断点，我可以看到发生任何事情时收到了哪些事件。

如果它不是一次性代码，我会将其清理为实用程序类，而不是使用匿名侦听器类等。

```
 final Map<EventType, String> eventTypeNames = new HashMap<EventType, String>();
    eventTypeNames.put(Events.BeforeExpand, "BeforeExpand");
    eventTypeNames.put(Events.Expand, "Expand");
    ...
    eventTypeNames.put(Events.BeforeStateSave, "BeforeStateSave");
    eventTypeNames.put(Events.StateSave, "StateSave");

    for (EventType eventType : Arrays.asList(
            Events.BeforeExpand,
            Events.Expand,
            ...
            Events.BeforeStateSave,
            Events.StateSave
    )) {
        this.addListener(eventType, new Listener<BaseEvent>() {
            public void handleEvent(final BaseEvent be) {
                String type = eventTypeNames.get(be.getType());
                String ev = be.toString();
            }
        });
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-16T22:31:03.513

各种小部件的 API 文档描述了哪些事件将触发以及它们何时触发。举个例子，假设我们想在用户选择一个新`TabItem`的`TabPanel`.

`TabPanel`的 API 文档（位于[http://extjs.com/deploy/gxtdocs/com/extjs/gxt/ui/client/widget/TabPanel.html](http://extjs.com/deploy/gxtdocs/com/extjs/gxt/ui/client/widget/TabPanel.html)）显示了几个事件；我们感兴趣`Select`：

> 选择：TabPanelEvent（容器，项目）
> 
> 在选择项目后触发。
> 
> *   容器：这个
> *   item : 被选中的项目

因此，要捕获事件（您似乎理解，但为了完整起见我将包括在内），该过程是向 中添加一个侦听器`TabPanel`，专门监视该`Events.Select`事件：

```
tp.addListener(Events.Select, new Listener<TabPanelEvent>(){
  public void handleEvent(TabPanelEvent be)
  {
    MessageBox.alert("Test", be.item.getText(), null);
  }
}); 
```

请注意，许多事件都有一个名为的属性`doit`，您可以将其设置为 false 以取消事件。

完整的代码清单：

```
package edu.fresno.client;

import com.extjs.gxt.ui.client.Events;
import com.extjs.gxt.ui.client.event.Listener;
import com.extjs.gxt.ui.client.event.TabPanelEvent;
import com.extjs.gxt.ui.client.widget.ContentPanel;
import com.extjs.gxt.ui.client.widget.MessageBox;
import com.extjs.gxt.ui.client.widget.TabItem;
import com.extjs.gxt.ui.client.widget.TabPanel;
import com.extjs.gxt.ui.client.widget.layout.FitLayout;
import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.user.client.ui.RootPanel;

public class GWTSandbox implements EntryPoint {
  public void onModuleLoad() {

      TabPanel tp = new TabPanel();

      TabItem ti1 = new TabItem("TabItem1");
      TabItem ti2 = new TabItem("TabItem2");

      tp.add(ti1);
      tp.add(ti2);

      tp.addListener(Events.Select, new Listener<TabPanelEvent>(){
            public void handleEvent(TabPanelEvent be)
            {
                MessageBox.alert("Test", be.item.getText(), null);
            }
      });

      ContentPanel panel = new ContentPanel();
      panel.setLayout(new FitLayout());
      panel.add(tp);
      RootPanel.get().add(panel);

  }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-08T21:15:00.513

您可以为构造函数添加以下代码：

```
 ContentPanel  panel =new ContentPanel(){
      public boolean fireEvent(EventType type) {
          System.out.println(type.getEventCode());
          return super.fireEvent(type);
      }
      public boolean fireEvent(EventType eventType, BaseEvent be) {
          System.out.println(eventType.getEventCode());
          return super.fireEvent(eventType, be);
      }
      public boolean fireEvent(EventType type, ComponentEvent ce) {
          System.out.println(type.getEventCode());
          return super.fireEvent(type, ce);
      }
    }; 
```

然后它将打印该组件可以接收的任何事件。

# multithreading - 操作系统了解线程如何使用的特性是否有优势？

> ID：738760
> 
> 赞同：2
> 
> 时间：2009-04-10T20:24:51.687
> 
> 标签：multithreading, scheduling, kernel, bsd

操作系统了解线程如何使用的特性是否有优势？例如，如果在 Java 中有一种方法可以在创建新线程时指示它将用于密集的 CPU 计算而不是阻塞 I/O。如果这是一种能力，线程调度不会改进吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T20:31:42.807

这就是操作系统进程所做的。操作系统对进程有复杂的调度。操作系统跟踪 I/O 使用和 CPU 使用并动态调整优先级，以便 CPU 密集型处理不会干扰 I/O。

如果您想要这些功能，请使用适当的操作系统进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T21:09:49.940

我不确定您实际上希望操作系统如何处理线程是 I/O 或计算的信息。API 已经公开了对线程调度方式产生最大影响的因素（即线程优先级和线程 CPU 亲和性）（并且对 NUMA 方面的支持也开始出现在主流 OS API 中）。

如果通过“计算线程”你的意思是它是在做后台处理并且不如 GUI 线程重要（从维护应用程序响应性的角度来看），你可以做的最有用的事情可能是稍微降低计算线程的优先级.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T20:32:06.427

这甚至有必要吗？I/O 上的线程阻塞将导致 CPU 密集型线程运行。操作系统决定如何调度线程。AFAIK 没有办法用 Java 给出任何提示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T21:13:47.917

是的，如果您是喜欢打开大量线程的架构师之一，特别是在 Windows 上，那么特别了解它们非常重要。

Wintellect 的 Jeff Richter 有一个名为[PowerThreading](http://www.wintellect.com/PowerThreading.aspx)的库。如果您在 .NET 上开发应用程序，这非常有用，但由于您在谈论 JAVA，因此最好了解操作系统线程、内核模型以及中断的工作原理。

# asp.net - 共享 .NET 应用程序池

> ID：738761
> 
> 赞同：7
> 
> 时间：2009-04-10T20:25:14.837
> 
> 标签：asp.net

在运行多个 ASP.NET 站点的服务器上，每个站点使用一个应用程序池还是让站点共享一个应用程序池更好？每种设置固有的优点或缺点是什么？还是这里有一个硬性规定？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T20:29:08.710

这实际上取决于站点的要求以及您对风险的担忧。

当两个应用程序在同一个应用程序池中运行时，它们具有相同的安全级别，因此这里存在一些安全问题，因为理论上每个应用程序都可以访问另一个应用程序的文件。此外，如果一个站点开始出现问题并使用内存，则可能会导致回收或冻结，从而影响两者。

尽管对此没有“硬性规定”，但我考虑的一些事情以及对我来说导致“自动”决定的事情如下。

*   应用程序任务是否关键？（如果是这样，单独的应用程序池）
*   这是第三方应用程序吗？（如果是这样，并且不确定它的作用，单独的应用程序池）
*   这个应用程序会看到活动的主要峰值吗？（如果是这样，最好隔离）

那里有很多，但关键是隔离和对单个应用程序进行故障排除的能力。这是一篇[Microsoft 文章](http://technet.microsoft.com/en-us/library/cc783655.aspx)，其中也涉及到了一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T20:29:06.510

单独的 AppPool 的优点之一是，如果您需要回收 AppPool，您可以为一个站点执行此操作，而不会影响其他站点的性能（或缓存）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T20:34:25.110

要记住的一条重要规则：

**不要**将 .Net 1.1 和 .Net 2.0 应用程序放在同一个应用程序池中。它会很快把事情搞砸。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T20:28:12.520

这在很大程度上取决于某些站点是否需要比其他站点更高的可靠性，每个站点的预期负载是多少等。

一般来说，共享一个池会更有效，但一个行为不端的应用程序可能会更快地给其他站点带来问题。此外，您可以单独回收或更新单独的应用程序池，这可能会使维护计划更容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-10T20:28:48.540

没有硬性规定。我倾向于每个站点使用一个应用程序池（IIS7 甚至默认为每个站点创建一个），因为我喜欢安全地使用它，以防我在一个站点/池中发生内存泄漏，我不希望它影响和删除其他网站。但我也有一些服务器，其中 100 个站点共享一个池而不会出现问题。所以，一如既往，这取决于。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T20:34:04.860

除非您有性能问题，否则我会更喜欢单个应用程序 - 单个应用程序池。后台线程中的异常（一旦有人开始异步播放）可能会导致整个应用程序池崩溃。除非您启用了自动回收，否则这可能会造成很多麻烦。

# php - 防止 iPhone 应用程序中使用的 PHP 脚本通过 Web 浏览器访问

> ID：738776
> 
> 赞同：0
> 
> 时间：2009-04-10T20:29:14.437
> 
> 标签：php, iphone, mysql, security

我正在尝试获取有关我在另一个[线程上提出的问题的更多信息](https://stackoverflow.com/questions/666534/calling-remote-php-functions-from-an-iphone-app)

基本上，我使用这种方法将参数传递给从服务器返回值的 php 脚本：

```
NSString *urlstr = [[NSString alloc] initWithFormat:@"http://www.yourserver.com/yourphp.php?param=%d", paramVal];
NSURL *url = [[NSURL alloc] initWithString:urlstr];
NSString *ans = [NSString stringWithContentsOfURL:url];
// here in ans you'll have what the PHP side returned. Do whatever you want
[urlstr release];
[url release]; 
```

然后我提出这个问题。你如何保护' [http://www.yourserver.com/yourphp.php](http://www.yourserver.com/yourphp.php) '？您可以轻松导航到相同的脚本（如果您知道路径）并传入您想要的任何参数。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T20:44:55.850

```
$_SERVER['HTTP_USER_AGENT']; 
```

将向您展示访问者用户代理，但用户代理肯定是可欺骗的，您唯一的其他选择是通过检查您知道永远不会通过它的某些字符来锁定参数，也许只是添加另一个（虚拟）peram增加一点安全性。除此之外，真的没有其他方法可以保护它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T21:09:49.113

您可以使用传出数据的 MAC 进行发送。

这避免了使用完整的 Auth 框架（以及与此相关的会话）。

然而，这很容易受到重复攻击，但肯定会验证消息来自您的应用程序。

[http://en.wikipedia.org/wiki/Message_authentication_code](http://en.wikipedia.org/wiki/Message_authentication_code)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T20:44:35.803

不，你没有错过任何东西。好吧，除了身份验证框架。:)

PHP 不是保护 Web 应用程序的最佳平台，但您可以使用[Pear 的 Auth 库](http://pear.php.net/package/Auth)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T12:25:36.320

在 PHP 端验证您的输入；如果任何输入有效，则生成密码并将其与要验证的参数一起传递，然后再采取任何操作。

他们的密码应该尽可能是临时的，理想情况下基于来自服务器的随机数，其中包含应用程序生成的一些数据（即它没有被存储）并且服务器事先知道。

# asp.net - 基本页面或基本母版页或嵌套母版？

> ID：738777
> 
> 赞同：2
> 
> 时间：2009-04-10T20:29:30.987
> 
> 标签：asp.net, master-pages, code-behind

我有一个有两个母版页的站点：一个用于一列布局，一个用于两列布局。它们嵌套在提供通用页眉和页脚的母版页中。

我有我希望每个内容页面都有的功能；我是不是该：

*   创建一个页面基类并在我的内容页面中继承它，或者
*   创建一个母版页基类并在我的嵌套母版页级别之一中继承它？

最终，我希望内容页面能够访问连接对象和我希望在每个页面加载时实例化的配置对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T20:33:32.117

在我看来，母版页应该只用于布局。

如果您想做诸如创建连接之类的工作，请在基类中进行。

但是，重要的是不要在页面开头创建数据库连接，并在最后关闭它。您应该在运行单个查询时打开和关闭连接。这允许连接池有效地工作。

此外，我不会在页面本身中放置任何类型的连接，因为您希望尽可能地将功能与布局分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T20:32:04.820

> 最终，我希望内容页面能够访问连接对象和我希望在每个页面加载时实例化的配置对象。

基本页面是此的主要目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T20:37:24.883

我通常使用包含许多简化内容页面创建功能的基本页面。有关有用的 BasePage 功能的一些示例，请参阅[http://dotnetslackers.com/articles/aspnet/Four-Helpful-Features-to-Add-to-Your-Base-Page-Class.aspx](http://dotnetslackers.com/articles/aspnet/Four-Helpful-Features-to-Add-to-Your-Base-Page-Class.aspx)。

# java - java.net.ConnectException：连接超时：发生连接异常

> ID：738778
> 
> 赞同：-1
> 
> 时间：2009-04-10T20:30:31.377
> 
> 标签：java, networking, sockets

我有这个代码，你能帮我解决这个问题吗？
我写了这段代码：

```
out = new DataOutputStream(urlConnection.getOutputStream());//exception occur

String content = (String) remoteUrlList.get(urlID + ".params");
content = (content == null ? "" : content + "&") + "content=" +   URLEncoder.encode(textArea.getText());
if (debug > 0) System.err.println("Capture: " + content);
out.writeBytes(content);
out.flush();
out.close();

// retrieve response from the remote host and display it.
if (debug > 0) System.err.println("Capture: reading response");
in = new BufferedReader(new InputStreamReader(urlConnection.getInputStream()));
String str;
while (null != ((str = in.readLine()))) {
  System.out.println("Capture: " + str);
}
in.close();

doneDialog.pack();
doneDialog.setVisible(true); 
```

错误列表是：

```
   在 java.net.PlainSocketImpl.socketConnect（本机方法）
        在 java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
        在 java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
        在 java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
        在 java.net.Socket.connect(Socket.java:519)
        在 java.net.Socket.connect(Socket.java:469)
        在 sun.net.NetworkClient.doConnect(NetworkClient.java:157)
        在 sun.net.www.http.HttpClient.openServer(HttpClient.java:394)
        在 sun.net.www.http.HttpClient.openServer(HttpClient.java:529)
        在 sun.net.www.http.HttpClient.(HttpClient.java:233)
        在 sun.net.www.http.HttpClient.New(HttpClient.java:306)
        在 sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:795)
        在 sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:743)
        在 sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:654)
        在 sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:832)
        在 de.mud.jta.plugin.Capture.saveFile(Capture.java:339)
        在 de.mud.jta.plugin.Capture.access $200(Capture.java:83)
        在 de.mud.jta.plugin.Capture$4.actionPerformed(Capture.java:173)
        在 de.mud.jta.plugin.Capture$10$1.actionPerformed(Capture.java:266)

```

我正在我的本地网络上尝试这个，所以没有防火墙问题..
有人可以帮忙吗？

克鲁纳尔帕特尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T07:26:33.193

我得到了一些东西，如何添加代理，当我尝试这个时，我没有在项目中设置，配置所以..所以请让我知道如何做到这一点..请参阅下文了解如何做到这一点..

在项目设置中配置它，选项卡配置，编辑当前默认配置文件，选项卡服务器，将代理设置添加到“额外 JVM 参数”，例如添加：

-Dhttp.proxyHost=myproxyserver.com -Dhttp.proxyPort=80

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T20:46:53.100

您要连接的地址应该存在。例如，如果您在端口 8080 上打开到 localhost 的连接，那么应该有一个服务器正在侦听该端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T12:18:01.560

也许是防火墙问题？使用以下命令检查您是否可以通过 telnet 访问该 url：telnet url 80

# multithreading - 1024 个 CPU 的内核调度

> ID：738786
> 
> 赞同：13
> 
> 时间：2009-04-10T20:34:10.993
> 
> 标签：multithreading, linux-kernel, kernel, bsd

Azul Systems 的设备支持数千个缓存一致的 CPU。我很想深入了解操作系统需要发生哪些更改才能安排数千个同时运行的线程。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-10T20:55:19.757

调度数千个线程并不是什么大问题，但在数百个 CPU 上调度它们却是。您首先需要的是非常细粒度的锁定，或者更好的是无锁数据结构和算法。你不能让 200 个 CPU 在一个 CPU 执行临界区时等待。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T19:02:49.297

使 Linux 规模化是一个长期且持续的项目。第一个支持多处理器的 Linux 内核有一个保护整个内核的锁（Big Kernel Lock，BKL），这很简单，但可扩展性有限。

随后，锁定变得更加细粒度，即有许多锁（数千？），每个只覆盖一小部分数据。但是，这可以走多远是有限制的，因为细粒度锁定往往很复杂，并且锁定开销开始消耗性能优势，特别是考虑到大多数多 CPU Linux 系统的 CPU 相对较少。

另一件事是，内核尽可能使用 per-cpu 数据结构。这非常重要，因为它避免了共享数据的缓存一致性性能问题，当然也没有锁定开销。例如，每个 CPU 都运行自己的进程调度程序，只需要偶尔进行全局同步。

此外，一些算法的选择考虑了可扩展性。例如，一些以读取为主的数据受 Read-Copy-Update (RCU) 保护，而不是传统的互斥锁；这允许读者在并发更新期间继续。

至于内存，Linux 会努力从进程运行所在的同一个 NUMA 节点分配内存。这为应用程序提供了更好的内存带宽和延迟。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-18T03:43:32.567

您要求对操作系统进行可能的更改，因此我认为这项工作背后有一个重要的工程团队。

还有一些有助于定义问题参数的澄清信息：

你需要多少 IPC（进程间通信）？
它们真的必须是线程，还是可以是进程？
如果它们是进程，是否必须通过套接字而不是使用共享内存相互通信？
什么是内存架构？您是具有 1024 个内核的直接 SMP，还是这里有其他一些 NUMA（非统一内存架构）或 MMP？你的页表是什么样的？

仅了解有关 Azul 系统的最少量信息，我猜想您的 IPC 很少，而且简单的“每个内核运行一个内核”模型实际上可能效果很好。如果进程需要相互通信，那么它们可以创建套接字并以这种方式传输数据。你的硬件支持这个模型吗？（您可能最终每个内核也需要一个 IP 地址，并且在 1024 个 IP 地址处，这可能会很麻烦，尽管它们都可以进行 NAT，也许这没什么大不了的）。当然，如果这种模型会导致一些效率低下，例如额外的页表和相当多的 RAM 开销，甚至可能不被您的硬件系统支持。

即使“每个内核 1 个内核”不起作用，您也可能会运行 1024/8 个内核，并且很好，让每个内核控制 8 个物理 CPU。

也就是说，如果您想在具有 1024 个内核（并且只有几个物理 CPU）的传统 SMP 机器中每个内核运行 1 个线程，那么我希望老式的 O(1) 调度程序是您想要的。您的 CPU[0] 很可能会在内核中接近 100% 并进行中断处理，但这对于这个用例来说很好，除非您需要超过 1 个内核来处理您的工作负载。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-11T02:29:50.950

我未受过教育的猜测是，每个处理器都有一个运行队列，并且当处理器空闲时有一个工作窃取算法。我可以看到这在 M:N 模型中工作，其中每个 cpu 有一个进程，轻量级进程作为工作项。这会让人感觉类似于窃取工作的线程池，例如 Java-7 的 fork-join 库中的线程池。

如果您真的想知道，请去学习 Solaris Internals 或深入研究 Solaris 内核代码。我仍在阅读 FreeBSD 的 Design & Impl，其中 Solaris Internals 是我列表中的下一个，所以我所能做的就是对 atm 进行疯狂的猜测。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T11:20:19.887

我很确定我们工作中的 SGI Altix（它执行 ccNUMA）使用特殊硬件来实现缓存一致性。

有一个巨大的开销连接到每个核心保持 4mb 的缓存一致。仅在软件中不太可能发生。

在 256 cpu 的数组中，您需要 768mb 内存来保存缓存无效位。12mb 高速缓存 / 每个高速缓存行 128 字节 * 256² 个内核。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T12:10:31.467

修改操作系统是一回事，但使用未更改的应用程序代码是对硬件的浪费。当超过一些限制（取决于硬件）时，为了执行通用代码而保持一致性和同步的努力实在是太多了。你可以这样做，但它会非常昂贵。从操作系统方面，您将需要复杂的关联模型，即不要仅仅因为您的 CPU 很忙而跳过 CPU。基于硬件拓扑调度线程——在“关闭”的 CPU 上协作线程以最大程度地减少惩罚。简单的工作窃取不是一个好的解决方案，您必须考虑拓扑。一种解决方案是分层工作窃取 - 按距离窃取工作，将拓扑划分为扇区并尝试从最近的位置首先窃取。稍微接触一下锁的问题；您仍然会使用自旋锁，但使用完全不同的实现。这可能是当今 CS 中获得专利最多的领域。但是，同样，您需要专门针对如此大规模的程序进行编程。或者你会简单地使用它。没有自动“并行器”会为你做这件事。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-16T14:01:35.510

最简单的方法是将每个进程/线程绑定到几个 CPU，然后只有这些 CPU 必须竞争该线程上的锁。显然，需要某种方式来移动线程以平衡负载，但在 NUMA 架构上，您必须尽可能减少这种情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T04:46:37.400

即使在双核英特尔系统上，我很确定 Linux 已经可以使用本地 posix 线程处理“数千个”线程。

（但是，Glibc 和内核都需要配置为支持这一点，但我相信现在大多数系统现在都默认支持）。

# c# - 我们可以为 GridView 实现 Row Lost Focus 事件吗

> ID：738790
> 
> 赞同：2
> 
> 时间：2009-04-10T20:35:58.787
> 
> 标签：c#, .net, asp.net, gridview

我有一个分层网格视图，我需要在子网格视图中实现以下功能：

1.  以可编辑模式显示所有行（可以这样做）
2.  将每行的所有数据保存在失去焦点上

我们可以捕获鼠标事件，但我们如何跟踪由键盘触发的行丢失焦点。例如：当一行获得焦点时，按 f6 将直接转到浏览器地址栏，从而导致行失去焦点事件。

鼠标在行上移动将触发所有行的所有验证和保存逻辑，此屏幕具有分层控制，子网格视图至少有 200 行。

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T20:50:44.180

当模糊事件为客户端的行触发时，您可能需要实现回发/回调。我不确定每个浏览器中哪些 DOM 元素支持 blur 事件，但你可以做到。

Janus Systems 的 GridEX 控件可以做到这一点，但老实说，我真的不会做像 Janus Systems 那样的事情，所以最好你应该找到自己的方式。

**编辑：**试试[这个](http://javascript.about.com/library/bltut29.htm)。

# java - Java 字符串：如何从字符串“vt X,Y,Z”中获取 X、Y 和 Z 的值

> ID：738791
> 
> 赞同：2
> 
> 时间：2009-04-10T20:36:54.900
> 
> 标签：java, string

如何从字符串“vt X,Y,Z”中获取 X、Y 和 Z 的值

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T20:38:54.227

只要格式保持这样简单，我会使用

```
String s = "vt X, Y, Z";
String[] values = s.split("[ ,]+");
String x = values[1];
String y = values[2];
String z = values[3]; 
```

如果格式具有更大的灵活性，您将需要考虑使用正则表达式（Pattern 类）或使用 ANTLR 之类的东西为其创建解析器

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T20:42:23.483

我可能会选择正则表达式（假设 X、Y 和 Z 是`ints`）：

```
Pattern p = Pattern.compile("vt ([0-9]+),\\s*([0-9]+),\\s*([0-9]+)");
Matcher m = p.match(line);
if (!m.matches())
  throw new IllegalArgumentException("Invalid input: " + line);
int x = Integer.parseInt(m.group(1));
int y = Integer.parseInt(m.group(2));
int z = Integer.parseInt(m.group(3)); 
```

与逗号分隔符上的简单拆分相比，这使您可以更好地处理无效输入。

# sql-server - 使用用户定义的约束创建列

> ID：738795
> 
> 赞同：0
> 
> 时间：2009-04-10T20:38:37.877
> 
> 标签：sql-server

我想将我的 varchar 列限制为只有指定范围内的 ascii 字符，例如 0-9 或 AF（对于十六进制字符） 我的约束是什么样的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T20:41:48.180

您可以轻松地将正则表达式应用于检查约束来执行此操作。

```
CREATE TABLE [Account]
(
    [AccountNumber] nvarchar(20) CHECK (dbo.RegexMatch( 
        [AccountNumber], '^[A-Z]{3,5}\d{5}-\d{3}$' ) = 1),
    [PhoneNumber] nchar(13) CHECK (dbo.RegexMatch( 
        [PhoneNumber], '^\(\d{3}\)\d{3}-\d{4}$' ) = 1),
    [ZipCode] nvarchar(10) CHECK (dbo.RegexMatch( 
        [ZipCode], '^\d{5}(\-\d{4})?$' ) = 1)
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-05T16:57:27.027

这是应该起作用的东西：

```
CREATE TABLE #TMP
(
    TEST nvarchar(20) CHECK ( TEST NOT LIKE '%[^A-F0-9]%' )  
)

INSERT INTO #TMP values('A1') -- WORKS
INSERT INTO #TMP values('G1') -- FAILS 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T23:13:45.663

您正在存储一个*数字*。因此，您的列类型应该是一个数字，一个 int。

在显示时，将该数字转换为十六进制表示，或者在前端，或者在服务器上使用用户定义的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-18T05:03:58.447

Etny 展示了一个使用双重否定的优雅技巧！否则要验证十六进制数字，我必须做类似的事情，`(Mac LIKE '[a-f0-9][a-f0-9][a-f0-9]'..12 times)`因为我正在验证 MAC 地址，而且令人讨厌的是，你不能像`\d{12}`在正则表达式中那样指定重复。另外我需要它有一个固定的大小，所以这是我的改编：

```
CREATE TABLE #HexTest
(
    Mac varchar(12)
        CONSTRAINT CK_Mac_12Hex_Only --names make error msgs useful!
        CHECK (Mac NOT LIKE '%[^a-f0-9]%' AND LEN(Mac) = 12)  
)

INSERT INTO #HexTest values('5ca1ab1eD00d')     -- good
INSERT INTO #HexTest values('DeadDa7aba5e')     -- good
INSERT INTO #HexTest values('Dad`sDebac1e')     -- bad chars
INSERT INTO #HexTest values('Ca5cadab1e')       -- too short
INSERT INTO #HexTest values('Deba7ab1eDeal')    -- too long, fails for size    
DROP TABLE #HexTest 
```

我试图做这样的事情：

```
CHECK (len(CONVERT(binary(6), Mac, 2)) = 6) 
```

（在 Oracle 中与 一起使用`hextoraw`），但它会在此处引发无效值错误。所以它没有用。我希望有一个函数可以尝试解析并在出现错误时返回 null。也许像[Parse 与 TryParse 之](https://stackoverflow.com/questions/467613/parse-v-tryparse)类的东西，或者如果`IsNumeric`为 Hex 工作......

# c# - 如何处理启动/停止可能需要很长时间才能启动的 API 接口

> ID：738798
> 
> 赞同：2
> 
> 时间：2009-04-10T20:39:26.813
> 
> 标签：c#, .net, multithreading, dispose

我有一个应用程序需要使用供应商提供的 API 来在呼叫路由到用户的分机时执行屏幕弹出。另一位开发人员致力于让 API 正常工作，并提供了一个不太正确的原型包装类，我正在努力让它正确。

因为这个 API 在返回之前可能会阻塞几分钟，所以开发者在一个单独的线程中启动了 API 接口代码，如下所示：

```
// constructor
public ScreenPop( ...params... )
{
  ...
t = new Thread( StartInBackground );
t.Start();
)

private void StartInBackground()
{
  _listener = new ScreenPopTelephoneListener();
  _bAllocated = true;
  _listener.Initialize( _address );
  _bInitialized = true;
  _listener.StartListening( _extension );
  _bListening = true;
} 
```

如果电话服务器无响应，则对 Initialize 的调用可能会挂起。

我不认为这样做的开发人员是故意的，但是当 API 以这种方式初始化时，线程会继续运行，所以现在我必须先停止线程，然后才能在我想要清理的时候进行清理. 我还必须使用 Invoke 从线程中获取事件，正如其他人在我之前的问题中如此友好地指出的那样，但现在正在工作。

无论如何，这里是用来关闭一切和清理的逻辑：

```
public void ShutdownFunc()
{
  try
  {
    if ( _bListening )
    {
      _listener.StopListening();
      _bListening = false;
    }
    if ( _bInitialized )
    {
      _listener.Shutdown();
      _bInitialized = false;
    }
    if ( _bAllocated )
    {
      _listener = null;
      _bAllocated = false;
    }
  }
} 
```

当然，整个混乱中有一个 try/catch 来防止未处理的异常。

我最大的问题是，当 API 接口代码在单独的线程中运行时，如何调用关闭代码？我需要清理以防用户注销然后重新登录，因为如果我不这样做，API 就会混淆。Thread.Abort 不起作用，因为它无法捕获异常，并且“volatile bool”方法也不起作用，原因很明显（大多数时候，API 线程不活动）。

因此，如果 API 接口代码在单独的线程上运行，似乎没有办法调用关闭逻辑。Thread.Abort() 绕过所有逻辑并在不清理的情况下杀死线程。调用 Shutdown 方法时，从 GUI 线程调用关闭逻辑会挂起。那么，我能做些什么呢？

IDispose 接口只是在 GUI 线程中增加了另一层抽象，并没有解决这里的问题。

现在，为了开发其余的代码，我将完全消除线程。但是，在我发布应用程序之前，我需要弄清楚这一点。

有人吗？

谢谢，
戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T20:54:29.867

您可以进一步封装初始化逻辑并在主初始化线程中检查 ManualResetEvent，同时生成一个工作线程来进行实际初始化。如果在您仍在初始化时从主线程设置了 ManualResetEvent，您可以中止执行实际初始化的线程并进行清理，否则如果工作线程完成，您只需停止等待 ManualResetEvent。这有点肮脏和棘手，但应该做它应该做的;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T21:05:37.017

首先，如果您需要关闭您的应用程序并且`Initialize`() 仍在运行，您只有两种选择：

1.  等待“初始化”完成
2.  中止正在运行“初始化”的线程。

中止线程应该始终是最后一个选项，但如果您确实需要停止应用程序并且`Initialize`没有超时参数，则没有其他方法。

另外，我建议将第 3 方 API 包装在您自己的类中，`IDisposable`在其上实现并使用一些枚举而不是像您在`ShutdownFunc`. 在其中添加一些简单的自动化机器逻辑来处理每个状态。并将可能的状态计数保持在所需的最小值。

或者也许把那个供应商的图书馆扔进垃圾桶；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T17:06:04.577

我重新设计了关闭函数的逻辑，以摆脱少数浮动的布尔值。新代码如下所示：

```
private enum ApiState { Unallocated, Allocated, Initialized, Listening };
private ApiState _apiState = ApiState.Unallocated;

private void StartInBackground()
{
  _listener = new ScreenPopTelephoneListener();
  _apiState = ApiState.Allocated;
  _phoneListener.Initialize( _strAddress );
  _apiState = ApiState.Initialized;
  _phoneListener.StartListening( _intExtension.ToString() );
  _apiState = ApiState.Listening;
}

public void ShutdownFunc
{
  try
  {
    if ( ApiState.Listening == _apiState )
    {
      _listener.StopListening();
      _listener.Shutdown();
    }
    if ( ApiState.Initialized == _apiState )
    {
      _listener.Shutdown();
    }
  }
  catch {}
  finally
  {
    _listener = null;
    _apiState = ApiState.Unallocated;
  }
} 
```

但是，问题仍然存在，我无法在不挂起 GUI 线程的情况下调用 Shutdown 逻辑。有没有办法使用来自 GUI 线程的调用来中断工作线程，除了 Abort 吗？我可以设置一个事件处理程序并使用 GUI 线程中手动生成的事件来停止工作线程吗？有没有人试过这个？

我没有尝试过有关为初始化调用启动新线程的建议，因为这只能解决部分问题，一旦我解决了真正的问题，可能就没有必要了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T16:42:20.250

好的，再来一次尝试。我试图声明一个事件并在线程上引发该事件，以从运行 API 的线程运行关闭逻辑。不走运，它仍然尝试在 GUI 线程上运行关闭逻辑并挂起应用程序。

这是适用的代码：

```
public delegate void HiPathScreenPop_ShutdownEventHandler( object parent );

class HiPathScreenPop
{
    // Shutdown event, raised to terminate API running in separate thread
    public event HiPathScreenPop_ShutdownEventHandler Shutdown;
    private Thread _th;

    //ctor
    public HiPathScreenPop()
    {
        ...
        _th = new Thread( StartInBackground );
        _th.Start();
    }

    private void StartInBackground()
    {
        _phoneListener = new ScreenPopTelephoneListener();
        _apiState = ApiState.Allocated;

        _phoneListener.StatusChanged += new _IScreenPopTelephoneListenerEvents_StatusChangedEventHandler( StatusChangedEvent );
        _phoneListener.ScreenPop += new _IScreenPopTelephoneListenerEvents_ScreenPopEventHandler( ScreenPopEvent );
        this.Shutdown += new HiPathScreenPop_ShutdownEventHandler( HiPathScreenPop_Shutdown );

        _phoneListener.Initialize( _strAddress );
        _apiState = ApiState.Initialized;

        _phoneListener.StartListening( _intExtension.ToString() );
        _apiState = ApiState.Listening;
    }

    public void KillListener()
    {
        OnShutdown();
    }

    private void OnShutdown()
    {
        if ( this.Shutdown != null )
        {
            this.Shutdown( this );
        }
    }

    void HiPathScreenPop_Shutdown( object parent )
    {
        // code from previous posts
    }
} 
```

当我调用 KillListener 时似乎发生了这样的事情：

1) OnShutdown() 在 UI 线程上被调用（OK）

2） Shutdown( this ) 被调用（这是我希望在后台线程上引发事件的地方

3) HiPathScreenPop_Shutdown() 在 UI 线程上被调用，并在 _phoneListener.ShutDown() 调用上挂起，就像我没有使用事件机制一样。

好的，那么我错过了什么魔法，或者完全误解了？似乎我创建的所有管道都没有做任何事情，只是弄乱了代码......

感谢您的任何回复，戴夫

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T17:18:40.927

当您直接从线程 A 调用事件处理程序时，该事件的所有处理程序也会在线程 A 上执行。无法将该处理程序注入到您的其他线程中。您*可以*生成另一个线程来运行 Shutdown，但这仍然不能解决 Initialize 尚未完成的问题 - 它只是再次解决了问题。它确实允许您为用户显示一个等待对话框。

最终如果这行代码挂了一段时间：

```
_phoneListener.Initialize( _strAddress ); 
```

那么除了等待它完成（在UI线程上或在具有某种等待UI的另一个线程中）并在该调用后进行检查以导致处理程序线程退出之外，您实际上无能为力。

```
_phoneListener.Initialize( _strAddress );
if (_exit.WaitOne(0))
{
    return;
} 
```

在您的主要关闭例程中，您需要以下内容：

```
_exit.Set();
_th.Join();

// Rest of cleanup code 
```

然后这将等待线程退出。我不建议在线程上调用 Abort，因为您不知道线程引用的任何状态会发生什么。如果您必须中止线程，则计划重新启动整个应用程序以确保安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T21:39:14.903

在这里的一位开发人员的帮助下，我能够让代码按预期工作。我需要做的是从线程中取出所有内容，除了对 Initialize() 的调用，这样 API 实例就不会在单独的线程上运行。然后我遇到了一个不同的问题，因为状态是从 2 个不同的线程设置的，而不是我去清理时所期望的状态。

这是最终的解决方案：

```
// declare a background worker to init the API
private BackgroundWorker _bgWorker;

// ctor
public HiPathScreenPop( ... )
{
    ...

    _phoneListener = new ScreenPopTelephoneListener();
    _apiState = ApiState.Allocated;

    _phoneListener.StatusChanged += new _IScreenPopTelephoneListenerEvents_StatusChangedEventHandler( StatusChangedEvent );
    _phoneListener.ScreenPop += new _IScreenPopTelephoneListenerEvents_ScreenPopEventHandler( ScreenPopEvent );

    _bgWorker = new BackgroundWorker();
    _bgWorker.DoWork += new DoWorkEventHandler(StartInBackground);
    _bgWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler( bgWorker_RunWorkerCompleted );

    _bgWorker.RunWorkerAsync();
}

 void _bgWorker_DoWork( object sender, DoWorkEventArgs e )
{
    _phoneListener.Initialize( _strAddress );
}

void bgWorker_RunWorkerCompleted( object sender, RunWorkerCompletedEventArgs e )
{
    _apiState = ApiState.Initialized;  // probably not necessary...

    _phoneListener.StartListening( _intExtension.ToString() );
    _apiState = ApiState.Listening;
} 
```

现在，API 实例与 UI 在同一个线程中运行，每个人都很高兴。对 Shutdwn() 的调用不再挂起，我不需要 Invoke() 进行回调，并且长时间运行的代码在后台工作线程中执行。

这段代码没有显示的是前面提出的关于如何处理用户在调用 Initialize() 返回之前关闭的情况的好主意。最终的代码将是这些解决方案的综合。

感谢大家的好评！

戴夫

# sql-server - sql server 2008 newsequentialid() 问题

> ID：738801
> 
> 赞同：4
> 
> 时间：2009-04-10T20:40:56.077
> 
> 标签：sql-server

我在 sql server management studio 中遇到 newsequentialid() 学习问题。创建一个具有唯一标识符列“UniqueID”的表，并将默认值设置为 newsequentialid()。

步骤 1\. 保存设计：

“Table_1”表 - 验证“UniqueID”列的默认值时出错。

无论如何保存它。

第二步，查看sql：

```
CREATE TABLE [dbo].[Table_1](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](50) NOT NULL,
    [UniqueID] [uniqueidentifier] NOT NULL
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[Table_1] ADD  CONSTRAINT [DF_Table_1_UniqueID]  DEFAULT (newsequentialid()) FOR [UniqueID]
GO 
```

看起来有道理。

步骤 3\. 添加一些行：

```
1    test    72b48f77-0e26-de11-acd4-001bfc39ff92
2    test2    92f0fc8f-0e26-de11-acd4-001bfc39ff92
3    test3    122aa19b-0e26-de11-acd4-001bfc39ff92 
```

它们看起来不是很连续。??

编辑：如果插入全部一次完成，我已经让它工作了一些，那么唯一的 id 是连续的。在以后的插入中，sql server 似乎忘记了最后一个顺序 id，并开始一个新的序列。

在 ssms 中运行它会产生 squential guid：

```
insert into Table_1 (Name) values('test13a');
insert into Table_1 (Name) values('test14a');
insert into Table_1 (Name) values('test15a');
insert into Table_1 (Name) values('test16a');
insert into Table_1 (Name) values('test17a'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T20:58:29.467

newsequentialid 主要是为了解决当你的表被一个uniqueidentifier聚集时的页面碎片问题。您的表由整数列聚集。我设置了两个测试表，一个是 newsequentialid 列是主键，另一个不是（像你的那样），并且在主键中 GUID 总是顺序的。另一方面，他们不是。

我不知道它*为什么*会这样运行的内部/技术原因，但很明显 newsequentialid() 只有当你的表被它聚集时才是真正的顺序。否则，它的行为似乎类似于 newid() / RowGuid。

另外，我很好奇为什么您在不需要时要使用 newsequentialid()。它有许多 newid() 没有的缺点，也没有任何好处 - 最大的是 newid() 实际上不可预测，而 newsequentialid() 是。如果你不担心碎片化，那有什么意义呢？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T12:20:14.860

根据 NEWSEQUENTIALID()[的定义](http://msdn.microsoft.com/en-us/library/ms189786.aspx)，这些值实际上是“连续的” ：

> 创建一个 GUID，该 GUID 大于自 Windows 启动以来此函数先前在指定计算机上生成的任何 GUID。

这并不是说 GUID 中不能有任何间隙，只是任何新的 GUID 都应该大于前一个。

试试这个：

```
create table #test(id int, txt varchar(50), gid uniqueidentifier)

insert into #test
select 1    ,'test','72b48f77-0e26-de11-acd4-001bfc39ff92'
union select 2,    'test2', '92f0fc8f-0e26-de11-acd4-001bfc39ff92'
union select 3,    'test3', '122aa19b-0e26-de11-acd4-001bfc39ff92'

select * from #test
order by gid asc 
```

如您所见，记录按预期顺序排列为 1、2、3。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-20T17:12:27.993

它们是连续的！

```
1    test     72b48f77-0e26-de11-acd4-001bfc39ff92
2    test2    92f0fc8f-0e26-de11-acd4-001bfc39ff92
3    test3    122aa19b-0e26-de11-acd4-001bfc39ff92 
```

77 < 8f < 9b !!! 您必须查看最高值字节，而不是最低值（从右到左）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T20:54:38.323

我不熟悉 newsequentialid()，对于 uniqueidentifier 类型我称之为 newid()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T05:32:28.257

序列中肯定存在间隙`NewSequentialId()`- 我发现以下导致间隙的原因：

1.  一旦另一个需要 NewSequentialId() 的表进行另一个调用
2.  插入失败
3.  回滚

（2和3在这方面类似于identity()）

例如，给定 2 个表，使用`NewSequentialId()`

```
create table XXX(someGuid uniqueidentifier DEFAULT NEWSEQUENTIALID(), x INT)
create table YYY(someGuid uniqueidentifier DEFAULT NEWSEQUENTIALID(), y DateTime)
GO

insert into XXX(x) values(1)
insert into XXX(x) values(2)
insert into XXX(x) values(3)
GO
insert into YYY(y) values(current_timestamp)
insert into YYY(y) values(current_timestamp)
insert into YYY(y) values(current_timestamp)
GO
insert into XXX(x) values(4)
insert into XXX(x) values(5)
insert into XXX(x) values(6)
GO

SELECT * FROM XXX
6A6E85CB-CCA3-E111-9E8E-005056C00008    1
6B6E85CB-CCA3-E111-9E8E-005056C00008    2
6C6E85CB-CCA3-E111-9E8E-005056C00008    3
**CCEA7AF2-CCA3-E111-9E8E-005056C00008  4** Gap here because we 'switched' to y
CDEA7AF2-CCA3-E111-9E8E-005056C00008    5
CEEA7AF2-CCA3-E111-9E8E-005056C00008    6

SELECT * FROM YYY
8F9438E1-CCA3-E111-9E8E-005056C00008    2012-05-22 07:13:35.503
909438E1-CCA3-E111-9E8E-005056C00008    2012-05-22 07:13:41.210
919438E1-CCA3-E111-9E8E-005056C00008    2012-05-22 07:13:41.220 
```

此外，在插入失败的情况下，NewSequentialId() 不会返回到序列中，例如

```
insert into XXX(x) values(1)
insert into XXX(x) values(2)
BEGIN TRAN
insert into XXX(x) values(3)
insert into XXX(x) values(4)
ROLLBACK TRAN
insert into XXX(x) values(5)
insert into XXX(x) values(6)
GO

686EFE5B-CDA3-E111-9E8E-005056C00008
696EFE5B-CDA3-E111-9E8E-005056C00008
6C6EFE5B-CDA3-E111-9E8E-005056C00008
6D6EFE5B-CDA3-E111-9E8E-005056C00008

i.e. a Gap of 2 Guids rolled back

and

insert into XXX(x) values(1)
insert into XXX(x) values(2)
insert into XXX(x) values(3)
GO
insert into XXX(x) values(99999999999999) -- overflow
GO
insert into XXX(x) values(4)
insert into XXX(x) values(5)
insert into XXX(x) values(6)
go

select * from xxx
AC613611-CFA3-E111-9E8E-005056C00008    1
AD613611-CFA3-E111-9E8E-005056C00008    2
AE613611-CFA3-E111-9E8E-005056C00008    3
**B0613611-CFA3-E111-9E8E-005056C00008  4** Gap of 1 - overflow failure
B1613611-CFA3-E111-9E8E-005056C00008    5
B2613611-CFA3-E111-9E8E-005056C00008    6 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-19T13:15:24.493

NEWSEQUENTIALGUID（以保证其顺序的方式生成的每个 guid）包括通过时间戳计算的 Guid 的一部分。因此，如果您在不同时间运行插入，您会看到一些间隙。

但重要的部分是 Guid 以不会导致页面拆分的方式“排序”（如果在索引中使用 Guid），这就是使用新的顺序 guid 时发生的情况。

# php - i_tmp2 用作变量时代表什么？

> ID：738811
> 
> 赞同：0
> 
> 时间：2009-04-10T20:46:09.980
> 
> 标签：php

很抱歉提出一个愚蠢的问题，但我偶然发现了其他人的代码，他正在循环`i_tmp2`内部使用。`for`什么时候使用`i_tmp2`符号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T20:59:24.630

i_tmp2 中的 i 可能代表“整数”，即告诉您它是用于存储整数的变量。

i_tmp2 中的 tmp2 可能只是意味着它是创建的第二个临时变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T20:52:09.887

询问实际编写代码的人。每个程序员都有自己的理由为特定类型的代码选择他们的符号样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T20:58:35.880

当程序员不是很好时使用它。

哦，来吧，这是个笑话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T08:11:49.660

有一个稍微过时的变量命名约定，称为*Hungarian notation*，主要归功于为 Microsoft 工作的匈牙利程序员 Charles Simonyi。对于 HN，变量名的第一个字符是 i 表示整数，l 表示 long，w 表示单词等。对于强类型语言，它（曾经）很有用，可以让所有程序员记住使用/预期的变量的类型职能。

现在它大多已经过时了:)

# java - 用java加载最简单的静态模型格式？

> ID：738812
> 
> 赞同：0
> 
> 时间：2009-04-10T20:46:19.043
> 
> 标签：java, model, 3d, loader

用 Java 加载最简单的静态（非动画）3d 模型格式是什么？我在 C++ 中使用了 .obj，但在 java 中这样做很痛苦。有更好的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T22:12:46.247

这取决于您用于显示该模型的引擎，而不是用于读取文件的语言。Java 可以像 C++ 一样轻松地读取 .obj 文件。

[jMonkeyEngine](http://www.jmonkeyengine.com)等引擎可以加载[3DS、MD2、MD3、MS3D、OBJ 和 X3D](http://www.jmonkeyengine.com/wiki/doku.php?id=model_loading)。多种格式，您无需为其编写代码。

还有许多其他引擎，googletrons 将提供帮助。

# java - 在 Android 的 GridView 中创建可点击的图像

> ID：738817
> 
> 赞同：11
> 
> 时间：2009-04-10T20:50:19.737
> 
> 标签：java, android, android-gridview, clickable-image

我在[本教程](http://developer.android.com/guide/tutorials/views/hello-gridview.html)中的 GridView 中显示了图像。我希望能够单击单个图像并执行其他事件，并且我需要知道单击了哪个图像。

我必须在 ImageAdapter 类中添加 imageView.onKeyDown(keyCode, event) 吗？这是当前存在的代码：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
  ImageView imageView;
  if (convertView == null) {  
    // if it's not recycled, initialize some attributes
    imageView = new ImageView(mContext);
    imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
    imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
    imageView.setPadding(8, 8, 8, 8);
    //does this need imageView.onKeyDown(keyCode, event)?
  } 
  else {
    imageView = (ImageView) convertView;
  }

  imageView.setImageResource(mThumbIds[position]);
  return imageView;
} 
```

它将如何指示单击了哪个图像？如何创建正确的处理程序？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-17T08:25:58.403

对于 GridView，您可以使用 setOnItemClickListener 方法来拥有 OnItemClickListener 侦听器。该侦听器将为您提供一个必须用签名覆盖的方法

```
onItemClick(AdapterView<?> parent, View v, int position, long id) 
```

您可以在其中获得项目在被单击的网格中的位置以及位于网格单元格内的视图。那是你需要的吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-11T15:55:19.657

通过将位置设为最终位置并将 onClick 侦听器添加到 imageView，我能够获得单击图像的位置。这会记录被点击的图像的位置。

```
@Override
public View getView(final int position, View convertView, ViewGroup parent) {
  ImageView imageView;
  if (convertView == null) {  
    // if it's not recycled, initialize some attributes
    imageView = new ImageView(mContext);
    imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
    imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
    imageView.setPadding(8, 8, 8, 8);

    imageView.setOnClickListener(new View.OnClickListener() {

      @Override
      public void onClick(View view) {
        Log.d("onClick","position ["+position+"]");
      }

    });

  } 
  else {
    imageView = (ImageView) convertView;
  }

  imageView.setImageResource(mThumbIds[position]);
  return imageView;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-04-26T10:44:39.850

我尝试了上述方法 getView(final int position . . .) 意识到位置在 28 个项目后“重置”，并且在 gridview 中的第 28 个项目后回到 0 时的位置。

我怀疑 final 关键字正在造成问题，在删除它后，我能够按预期获得位置。

下面是在展示 gridview 的活动中调用 click 事件的示例代码。

```
public class MainActivity extends Activity {

ArrayList<Integer> item_ids = new ArrayList<Integer>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    item_ids = //get your item ids method

    GridView gridview = (GridView) findViewById(R.id.grid_featured);
    gridview.setAdapter(new ImageAdapter(this));
    gridview.setOnItemClickListener(itemClickListener);

    footer = (Footer)findViewById(R.id.layoutFooter);
    footer.setActivity(this);
}

private OnItemClickListener itemClickListener = new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
    Log.d(TAG,"Position Clicked ["+position+"] with item id ["+item_ids.get(position)+"]");
    }
}; 
```

}

# sql-server - 如何选择数据库中具有特定名称的所有表

> ID：738818
> 
> 赞同：5
> 
> 时间：2009-04-10T20:50:32.967
> 
> 标签：sql-server

如何选择数据库中具有特定名称的所有表名称？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T20:53:54.050

（）或（更正确的）信息模式`sysobjects`：`where type='u'`

```
SELECT *
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE '%CUSTOMER%' -- or "='CUSTOMER'" for exact 
```

如果您的意思不同，请澄清。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T21:10:36.210

```
DECLARE @name nvarchar(100)
-- for SQL Server 2008
SELECT * FROM sys.all_objects WHERE name LIKE @name AND type IN ('U', 'S')

-- for others versions
SELECT * FROM dbo.sysobjects WHERE type IN ('U', 'S') AND name LIKE @name 
```

这两个脚本都包含在 Microsoft 的脚本中。

# java - 需要一些帮助来使用 NetBeans 创建 .jar 文件

> ID：738822
> 
> 赞同：1
> 
> 时间：2009-04-10T20:51:14.930
> 
> 标签：java, netbeans, java-me

我下载了带有 Java ME 的 NetBeans 6.5 完整包。然后我也下载并安装了 Sun Java Wireless Toolkit。而且我已经尝试过各种方式去新项目 - >并在Java ME下 - >移动应用程序

然后我输入名称和位置。

然后什么时候选择模拟器平台，“Sun Java Wireless Toolkit 2.5.2 for CLDC”就在那里。

但是当我按下 NEXT 时，什么也没有发生。一个红色的标志只是在背景上闪烁！

我想创建一个在索尼爱立信手机上运行的 jar 文件！

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T15:29:56.237

几件事要尝试：

*   选中/取消选中“创建 Hello MIDlet”选项
*   选中/取消选中“设置为主项目”选项
*   更改项目名称，以防它与同一位置的另一个项目冲突
*   仅在项目名称中使用基本字符：[A..Z][a..z][0..9]
*   确保您使用的项目位置对于您的操作系统是正确的。

# php - 可能的值：PHP_OS

> ID：738823
> 
> 赞同：58
> 
> 时间：2009-04-10T20:51:29.967
> 
> 标签：php, superglobals

有没有地方可以找到 PHP 预定义常量的可能值列表`PHP_OS`？我想将此值用于系统要求检查，但需要知道如何在此变量中命名不同的操作系统。

通过一些搜索，到目前为止，我已经编译了以下列表：

*   CYGWIN_NT-5.1
*   达尔文
*   自由BSD
*   惠普-UX
*   IRIX64
*   Linux
*   NetBSD
*   OpenBSD
*   太阳操作系统
*   Unix
*   WIN32
*   WINNT
*   视窗

如果有人有更完整的列表，或者知道任何其他值，我很想听听！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-10T21:14:33.017

PHP[通过 uname](https://github.com/php/php-src/blob/0d51ebd1a54af59d915c551a240b56bb3f0e26a6/configure.in#L1300)，[除了在 Windows( `WINNT`)](https://github.com/php/php-src/blob/0d51ebd1a54af59d915c551a240b56bb3f0e26a6/main/main.c#L2022)和[Netware( `Netware`)](https://github.com/php/php-src/blob/0d51ebd1a54af59d915c551a240b56bb3f0e26a6/configure.in#L1292)上。有关您的问题中未提及的值的非详尽列表，请参阅[Wikipedia ：](http://en.wikipedia.org/wiki/Uname#Table_of_standard_uname_output)

*   CYGWIN_NT-5.1
*   IRIX64
*   太阳操作系统
*   惠普-UX
*   OpenBSD（不在维基百科中）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T21:15:30.377

我认为进行“需求检查”的更好解决方案是实际使用您需要知道的东西才能正常工作并看看会发生什么。

例如，有目录分隔符的常量、realpath() 等函数来处理不同操作系统上的目录。

具体来说，你想做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-21T00:58:07.897

似乎`php_uname("s")`非 Unix 操作系统将是一个好的开始，因为在我看来，它在 Unix 系统`uname("s")`和`php_uname("s")`posix 子系统上是相同的，例如 Cygwin、Mingw、UWin、EMX+GCC 和 MKS。以下是开箱即用不符合 Posix 且运行 PHP 的操作系统列表。

## 操作系统

*   OS/2 扭曲
*   电子通讯站
*   RISC 操作系统
*   Windows XP 64 位

请记住，这根本不是浏览器检测，而是根路径检测、可能是也可能不是`\`and的目录分隔符`/`、EOL 和其他一些东西。

## 根路径示例

*   Unix\linux\Mac OS X：`/`
*   操作系统/2：`C:\`
*   阿米加：`dh0:`

# visual-studio - Visual Studio 2008 异常窗口替换为弹出窗口

> ID：738826
> 
> 赞同：2
> 
> 时间：2009-04-10T20:52:00.030
> 
> 标签：visual-studio, visual-studio-2008, exception

问候，

我有一个烦人的问题，我在 Visual Studio 2008 中的异常窗口被 Windows 弹出对话框替换（见下图）。异常详细信息可能非常有用，因此将不胜感激。

[Visual Studio 2008 - 异常窗口 #1 http://img219.imageshack.us/img219/692/window.png](http://img219.imageshack.us/img219/692/window.png)

[Windows 对话框 - 异常窗口 #2 http://img27.imageshack.us/img27/8379/window2.png](http://img27.imageshack.us/img27/8379/window2.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T20:55:39.520

确保异常助手仍处于启用状态。

*   转到：工具 -> 选项 -> 调试
*   确保选中“启用异常助手”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-25T13:44:29.237

当我在项目属性中启用非托管代码调试时，我注意到发生了这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-23T13:11:15.940

问题[#239206](https://stackoverflow.com/questions/239206/datatable-visualizer-disappeared-from-my-visual-studio)确实帮助了我。
跑步

```
"%ProgramFiles(x86)%\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe" /resetskippkgs 
```

在命令行上（作为管理员）为我做了诀窍

# asp.net-mvc - 如何在动作过滤器上使用 Unity 和 asp.net mvc 执行属性注入？

> ID：738828
> 
> 赞同：4
> 
> 时间：2009-04-10T20:52:11.823
> 
> 标签：asp.net-mvc, inversion-of-control, unity-container

我正在尝试使用属性注入在我的操作过滤器上进行依赖注入。我不知道如何自动设置过滤器的依赖关系。这是我到目前为止的代码。

```
public class UnityActionInvoker : ControllerActionInvoker
{
    IUnityContainer container;

    public UnityActionInvoker(IUnityContainer container) {
        this.container = container;
    }

    protected override ActionExecutedContext InvokeActionMethodWithFilters(ControllerContext controllerContext, IList<IActionFilter> filters, ActionDescriptor actionDescriptor, IDictionary<string, object> parameters) {
        foreach (var filter in filters) {
            // HELP: dependency injection on all marked filter properties
        }

        return base.InvokeActionMethodWithFilters(controllerContext, filters, actionDescriptor, parameters);
    }
}

public class UnityControllerFactory : DefaultControllerFactory
{
    IUnityContainer container;

    public UnityControllerFactory(IUnityContainer container) {
        this.container = container;
    }

    protected override IController GetControllerInstance(Type controllerType) {
        Controller controller = null;

        if (controllerType != null) {
            if (!typeof(IController).IsAssignableFrom(controllerType)) {
                throw new ArgumentException(string.Format("Type requested is not a controller: {0}", controllerType.Name), "controllerType");
            }

            controller = container.Resolve(controllerType) as Controller;
            controller.ActionInvoker = new UnityActionInvoker(container);
        }

        return controller;
    }
}

public class AccessFilterAttribute : FilterAttribute, IActionFilter
{
    [Dependency]
    public IUserRepository UserRepository { get; set; }

    public void OnActionExecuting(ActionExecutingContext filterContext) {
        throw new NotImplementedException();
    }

    public void OnActionExecuted(ActionExecutedContext filterContext) {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-11T00:17:52.390

答案是：

```
public class UnityActionInvoker : ControllerActionInvoker
{
    IUnityContainer container;

    public UnityActionInvoker(IUnityContainer container) {
        this.container = container;
    }

    protected override ActionExecutedContext InvokeActionMethodWithFilters(ControllerContext controllerContext, IList<IActionFilter> filters, ActionDescriptor actionDescriptor, IDictionary<string, object> parameters) {
        foreach (var filter in filters) {
            container.BuildUp(filter.GetType(), filter);
        }

        return base.InvokeActionMethodWithFilters(controllerContext, filters, actionDescriptor, parameters);
    }
} 
```

# excel - 通过 API 将文件另存为 PDF 所需的 Excel 2007 中 PDF 的 FileType 编号是多少？

> ID：738829
> 
> 赞同：2
> 
> 时间：2009-04-10T20:52:30.777
> 
> 标签：excel, pdf-generation, excel-2007, office-automation, excel-automation

我需要调用一个函数来保存 Excel 工作簿。我为 Excel 2007 安装了 PDF 保存插件，但现在我需要知道保存 excel 文件时文件格式的数字代码是什么。

可以在此处找到 excel 文件格式编号的示例。

[http://www.dailydoseofexcel.com/archives/2006/10/29/saveas-in-excel-2007/](http://www.dailydoseofexcel.com/archives/2006/10/29/saveas-in-excel-2007/)

```
FileExtStr = ".xlsb": FileFormatNum = 50
FileExtStr = ".xlsx": FileFormatNum = 51
FileExtStr = ".xlsm": FileFormatNum = 52
FileExtStr = ".xls": FileFormatNum = 56
FileExtStr = ".csv": FileFormatNum = 6
FileExtStr = ".txt": FileFormatNum = -4158
FileExtStr = ".prn": FileFormatNum = 36 
```

我需要 .pdf 结尾的那个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T22:01:38.537

看看[`Workbook.ExportAsFixedFormat`](http://msdn.microsoft.com/en-us/library/bb238907.aspx)方法：

```
ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF 
    FileName:=“sales.pdf” 
    Quality:=xlQualityStandard 
    DisplayFileAfterPublish:=True 
```

应该优先使用此方法，`SaveAs`因为它还允许指定所有 PDF / XPS 选项。

注意：此方法已通过 Excel 2007 添加到 Excel 对象模型中，并且需要安装[Save as PDF or XPS Add-in](http://www.microsoft.com/downloads/details.aspx?FamilyID=4d951911-3e7e-4ae6-b059-a2e79ed87041) for 2007 Microsoft Office 程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T22:10:09.653

我是在Word里做的，格式号是17。

# javascript - 如何显示浏览器特定的 HTML？

> ID：738831
> 
> 赞同：12
> 
> 时间：2009-04-10T20:54:21.067
> 
> 标签：javascript, html, conditional, browser-detection

我正在尝试找到一种方法来显示一个指向 IE 用户的链接和另一个使用 javascript 或条件注释（或其他任何方法）的所有其他浏览器的链接。

基本上...

```
//pseudo code
<!--[if IE]>
    <a href"ie-only.html">click here!</a>
<!--[else]>
    <a href"all-other-browsers.html">click here!</a>
<![endif]--> 
```

我认为条件注释标签（仅适用于 Internet Explorer）不可能做到这一点。另外，我认为没有“其他”声明。

有没有办法用javascript做到这一点？请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-11T00:03:34.280

> 我认为条件注释标签不可能做到这一点（仅适用于 Internet Explorer）

是的。您只需将非 IE 浏览器的内容保留在某个位置，使其成为条件注释子句的一部分，但实际上不在 <!-- 注释 --> 内。然后不知道条件注释的浏览器会很好地看到内容。这被称为[下层显示的](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx#dlrevealed)条件注释。

不幸的是，微软给你的标记是无效的 HTML（甚至不是格式良好的 XML）。要使其通过集合，您只需要一些额外的“--”：

```
<!--[if IE]> This is IE! <![endif]-->
<!--[if !IE]><!--> This ain't IE! <!--<![endif]--> 
```

尽管我不得不回应 AnonJr 的未回答，但与其他浏览器相比，您很少需要为 IE 提供完全独立的链接/页面。如果你正在做一些棘手的事情，比如复杂的 VML 和 ActiveX 在 IE 中使用 Flash 在其他浏览器上工作，我想这可能是有原因的，但通常在同一个基本页面上进行一些 CSS 和脚本黑客攻击就足够了。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-10T21:35:48.583

这不会是流行的答案，但是该死的时候有人开始发布它了-停止使用特定于浏览器的垃圾。当新版本出来时，你只会让未来的问题永久存在。

如果开发人员花费了额外的时间（是的，这需要时间和艰苦的工作。如果你不能说服你的客户你还不够努力），那么我们就不会看到 IE7 “破坏网络”并且会有IE8 的喧闹声更甚。

是的，IE 的标准不符合其他标准。但是，Fx 也缺少标准中的某些内容。当谈到“标准”时，他们都很糟糕。但他们都在变得更好。（以不同的速度，但它们都在变得更好。）

首先想想你为什么要这样做，并问自己是否真的想在下一个浏览器版本出现时处理这个问题，你必须重新调整浏览器检测以及如何处理浏览器 Y 的版本 X。

[/咆哮]

**编辑：**要回答一些指出我没有真正回答问题的明显事实的评论，没有更多信息，这个问题让我想知道我们是否不是在试图帮助一个人决定[用钉子钉钉子玻璃瓶或鞋子……](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-10T20:58:39.327

这是 Microsoft 认可的方式：

```
<!--[if IE]>
    <a href="ie-only.html">click here!</a>
<![endif]-->
<![if !IE]>
    <a href="all-other-browsers.html">click here!</a>
<![endif]> 
```

更多信息，请访问[http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx)。

## 编辑

从 IE 5 开始，此代码隐含地保证在所有当前和未来版本的 IE 中工作。对于非 IE 浏览器，代码通过依赖那些忽略“无意义”`<![if !IE]>`标签的浏览器工作，它们都这样做，我已经从未见过它失败。对于只使用良好的 ol' HTML 注释的版本，请参阅[bobince 的答案](https://stackoverflow.com/questions/738831/how-to-display-browser-specific-html/739207#739207)，我实际上更喜欢 Microsoft 提供的解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T21:14:25.060

我想出如何做到这一点的一种方法：

[从http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)获取 javascript 代码并将其放入`<head>`标记中。

然后在您的`<body>`标签中使用：

```
<script type="text/javascript">
<!--
if (BrowserDetect.browser == 'Explorer') {
    document.write('<a href="#">Explorer</a>');
} else {
    document.write('<a href="#">Other Browsers</a>');
}
// -->
</script> 
```

不确定这是否是最简单的方法，但它完成了工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-10T21:04:23.523

也许是在黑暗中开枪，但这行得通吗？

```
<style>

    a.forIeOnly {display: none; }
    a.notForIe  {display: block; }

</style>

<!--[if ie]>

<style>
    a.forIeOnly {display: block;}
    a.notForIe  {display: none; }
</style>

<![endif]-->

<a href="#" class="forIeOnly">Link One</a>
<a href="#" class="notForIe">Link Two</a> 
```

它远不像 if/else 语句那样干净/有吸引力，但是……这是我能想到的实现解决方案的最简单方法。尽管它本身可能充满了问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-01T19:14:11.007

将此添加到您的标题中：

```
<script src="http://github.com/rafaelp/css_browser_selector/raw/master/css_browser_selector.js" type="text/javascript"></script> 
```

然后你想要你的 .css 页面：

```
/* Chrome Only */
.chrome embed {
    display: none;
}

/* Firefox Only */
.gecko video {
    display: none;
} 
```

来源：[http ://rafael.adm.br/css_browser_selector/](http://rafael.adm.br/css_browser_selector/)

可用的浏览器代码 [浏览器]：

```
ie - Internet Explorer (All versions)
ie8 - Internet Explorer 8.x
ie7 - Internet Explorer 7.x
ie6 - Internet Explorer 6.x
ie5 - Internet Explorer 5.x
gecko - Mozilla, Firefox (all versions), Camino
ff2 - Firefox 2
ff3 - Firefox 3
ff3_5 - Firefox 3.5
ff3_6 - Firefox 3.6 new
opera - Opera (All versions)
opera8 - Opera 8.x
opera9 - Opera 9.x
opera10 - Opera 10.x
konqueror - Konqueror
webkit or safari - Safari, NetNewsWire, OmniWeb, Shiira, Google Chrome
safari3 - Safari 3.x
chrome - Google Chrome
iron - SRWare Iron 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T21:01:14.967

我没有尝试，但也许你可以在 CSS 上使用 IE 缺陷。Eric Meyer 写了这篇关于这个主题的文章：[Tricking Browsers and Hiding Styles](http://www.ericmeyeroncss.com/bonus/trick-hide.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T21:05:38.123

你总是可以使用 CSS 来隐藏特定浏览器的代码。例如，考虑以下代码：

```
<a href"ie-only.html" id="ie-only">click here!</a>
<a href"all-other-browsers.html" id="other-browsers">click here!</a> 
```

您可以应用以下 CSS hack，相应的链接将显示到相应的浏览器。

```
/* Display settings for most browsers */
#ie-only {display: none;}
#other-browsers {display: block;}

/* Display settings for IE <= 6 */
* html #ie-only {display: block;}
* html #other-browsers {display: none;} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T21:54:01.440

IE 支持[条件编译](http://javascriptkit.com/javatutors/conditionalcompile.shtml)，您可以使用它轻松交付仅限 IE 的代码，而无需执行用户代理嗅探或功能检测。

```
/*@cc_on
   /*@if (@_jscript)
      alert("IE.");
   @else @*/
      alert("Not IE.");
   /*@end
@*/ 
```

# css - CSS - 圆角选择、复选框和单选按钮

> ID：738836
> 
> 赞同：3
> 
> 时间：2009-04-10T20:54:55.653
> 
> 标签：css

有什么办法，如何在`<select>`不使用任何 javascript 的情况下制作圆角 HTML ？我有这个疯狂的设计，我完全不知道如何只使用**CSS**来做到这一点。

`checkbox`和也有同样的问题`radiobutton`。有人知道如何使它们变圆吗？

我需要适用于 IE6+、Firefox 2+、Opera 9+ 的解决方案...

[替代文字 http://uploader.chytry.cz/select-checkbox.png](http://uploader.chytry.cz/select-checkbox.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T21:08:59.817

不。

现在长答案：Internet Explorer 不适合被样式化。您将能够为具有圆角的左侧（文本内容）设置背景图像，但下拉箭头将被固定为默认浏览器。您还会发现控件的 mousedown 和 mouseover 状态将被固定为默认样式。

我认为在许多情况下，理想的首选设计需要对浏览器标准支持的限制有点务实。具体来说，IE6 不支持公平数字的问题，IE7 只是稍微兼容一些。

关于这些坏消息我很遗憾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T21:26:32.583

不。表单样式非常有问题，不能保证任何样式都可以工作。简单的边框和背景颜色/图像通常在大多数浏览器中都可以正常工作。我相信 Safari 会让你的风格很少。[查看此页面](http://www.456bereastreet.com/archive/200410/styling_even_more_form_controls/)以获取更多详细信息。

老实说，最好的解决方案是使用 javascript。[jQuery Click菜单](http://p.sohei.org/jquery-plugins/clickmenu/)是我最近使用的一个很好的解决方案，以模仿选定框（在选择菜单中的元素时，使用js在隐藏字段上设置值）。

如果您搜索，我相信还有其他解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-24T07:27:01.397

不，请参阅此站点以获取单选按钮和复选框 [http://www.maratz.com/blog/archives/2006/06/11/fancy-checkboxes-and-radio-buttons/](http://www.maratz.com/blog/archives/2006/06/11/fancy-checkboxes-and-radio-buttons/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-18T09:32:27.937

不，没有 javascript 或 jQuery 你不能这样做。但是如果你需要 jQuery 试试这个链接。它包含 jQuery 的圆角 HTML 选择框。

[http://webworld-develop.blogspot.com/2011/11/cool-html-5-select-with-jquery-and-css.html](http://webworld-develop.blogspot.com/2011/11/cool-html-5-select-with-jquery-and-css.html)

# perl - 如何编写看起来不像 C 的 Perl？

> ID：738840
> 
> 赞同：5
> 
> 时间：2009-04-10T20:56:54.387
> 
> 标签：perl, coding-style

我的同事抱怨我的 Perl 看起来太像 C，这是很自然的，因为我大部分时间都用 C 编程，而 Perl 只是一点点。这是我最近的努力。我对易于理解的 Perl 很感兴趣。我是一个 Perl 批评家，对神秘的 Perl 几乎没有容忍度。但是考虑到可读性，下面的代码怎么可能更 Perlish？

它的目标是进行流量分析并找出哪些 IP 地址在文件“ips”中给出的范围内。这是我的努力：

```
#!/usr/bin/perl -w

# Process the files named in the arguments, which will contain lists of IP addresses, and see if 
# any of them are in the ranges spelled out in the local file "ip", which has contents of the
# form start-dotted-quad-ip-address,end-dotted-quad-ip_address,stuff_to_be_ignored
use English;

open(IPS,"ips") or die "Can't open 'ips' $OS_ERROR";

# Increment a dotted-quad ip address
# Ignore the fact that part1 could get erroneously large.
sub increment {
    $ip = shift;

    my ($part_1, $part_2, $part_3, $part_4) = split (/\./, $ip);
    $part_4++;
    if ( $part_4 > 255 ) {
        $part_4 = 0;
        ($part_3++);
        if ( $part_3 > 255 ) {
            $part_3 = 0;
            ($part_2++);
            if ( $part_2 > 255 ) {
                $part_2 = 0;
                ($part_1++);
            }
        }
   }   
    return ("$part_1.$part_2.$part_3.$part_4");
}

# Compare two dotted-quad ip addresses.
sub is_less_than {
    $left = shift;
    $right = shift;

    my ($left_part_1, $left_part_2, $left_part_3, $left_part_4)     = split (/\./, $left);
    my ($right_part_1, $right_part_2, $right_part_3, $right_part_4) = split (/\./, $right);

    if  ($left_part_1 != $right_part_1 ) { 
        return ($left_part_1 < $right_part_1);
    }   
    if  ($left_part_2 != $right_part_2 ) { 
        return ($left_part_2 < $right_part_2);
    }   
    if  ($left_part_3 != $right_part_3 ) { 
        return ($left_part_3 < $right_part_3);
    }
    if  ($left_part_4 != $right_part_4 ) {
        return ($left_part_4 < $right_part_4);
    }
    return (false);  # They're equal
}

my %addresses;
# Parse all the ip addresses and record them in a hash.   
while (<IPS>) {
    my ($ip, $end_ip, $junk) = split /,/;
    while (is_less_than($ip, $end_ip) ) {
        $addresses{$ip}=1;
        $ip = increment($ip);
    }
}

# print IP addresses in any of the found ranges

foreach (@ARGV) {
    open(TRAFFIC, $_) or die "Can't open $_ $OS_ERROR";
    while (<TRAFFIC> ) {
        chomp;
        if (defined $addresses{$_}) {
            print "$_\n";
        }
    }
    close (TRAFFIC);

} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-11T16:54:13.993

从多年看到 C 程序员编写的 Perl 代码来看，这里有一些通用的建议：

使用哈希。使用列表。使用哈希！使用清单！使用列表操作（map、grep、split、join），尤其是对于小循环。不要使用花哨的列表算法；pop、splice、push、shift 和 unshift 更便宜。不要使用树木；哈希更便宜。哈希很便宜，制作它们，使用它们并扔掉它们！使用迭代器 for 循环，而不是 3-arg 循环。不要将事物称为 $var1、$var2、$var3；改用列表。不要将事物称为 $var_foo、$var_bar、$var_baz；改用哈希。使用`$foo ||= "default"`. `$_`如果必须输入，请勿使用。

不要使用原型，这是一个陷阱！！

使用正则表达式，而不是`substr()`or `index()`。爱正则表达式。使用`/x`修饰符使它们可读。

`statement if $foo`当你想要一个无块的条件时写。编写嵌套条件几乎总是有更好的方法：尝试递归、尝试循环、尝试哈希。

在需要时声明变量，而不是在子例程的顶部。使用严格。使用警告，并修复它们。使用诊断。编写测试。写 POD。

使用 CPAN。使用 CPAN！使用 CPAN！有人可能已经这样做了，更好。

运行[perlcritic](http://search.cpan.org/dist/Perl-Critic/)。运行它`--brutal`只是为了踢。运行[perltidy](http://search.cpan.org/dist/Perl-Tidy)。想想你为什么要做每一件事。改变你的风格。

利用没有花在语言和调试内存分配上的时间来改进你的代码。

问问题。优雅地对您的代码进行风格评论。参加 Perl Mongers 会议。访问 perlmonks.org。转到 YAPC 或 Perl 研讨会。您的 Perl 知识将突飞猛进。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-10T21:30:25.973

大多数编写“Perlish”的代码都将利用 Perl 中的内置函数。

例如，这个：

```
my ($part_1, $part_2, $part_3, $part_4) = split (/\./, $ip);
$part_4++;
if ( $part_4 > 255 ) {
    $part_4 = 0;
    ($part_3++);
    if ( $part_3 > 255 ) {
        $part_3 = 0;
        ($part_2++);
        if ( $part_2 > 255 ) {
            $part_2 = 0;
            ($part_1++);
        }
    }
} 
```

我会重写类似的东西：

```
my @parts = split (/\./, $ip);

foreach my $part(reverse @parts){
  $part++;
  last unless ($part > 255 && !($part = 0));
} 
```

这与您在上面发布的代码一样，但更简洁一些。

你确定代码做你想要的吗？对我来说，如果 IP 之后的“部分”> 255，您只移动到 IP 的前一个“部分”，这看起来有点奇怪。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-10T21:50:49.607

有时最糟糕的事情是转向 CPAN，而不是编写任何代码。

[这是一个使用Net::CIDR::Lite](http://search.cpan.org/perldoc?Net::CIDR::Lite)和[Net::IP::Match::Regexp](http://search.cpan.org/perldoc?Net::IP::Match::Regexp)的快速而肮脏的示例：

```
#!/path/to/perl

use strict;
use warnings;

use English;
use IO::File;
use Net::CIDR::Lite;
use Net::IP::Match::Regexp qw(create_iprange_regexp match_ip);

my $cidr = Net::CIDR::Lite->new();

my $ips_fh = IO::File->new();

$ips_fh->open("ips") or die "Can't open 'ips': $OS_ERROR";

while (my $line = <$ips_fh>) {

    chomp $line;

    my ($start, $end) = split /,/, $line;

    my $range = join('-', $start, $end);

    $cidr->add_range($range);

}

$ips_fh->close();

my $regexp = create_iprange_regexp($cidr->list());

foreach my $traffic_fn (@ARGV) {

    my $traffic_fh = IO::File->new();

    $traffic_fh->open($traffic_fn) or die "Can't open '$traffic_fh': $OS_ERROR";

    while (my $ip_address = <$traffic_fh>) {

        chomp $ip_address;

        if (match_ip($ip_address, $regexp)) {
            print $ip_address, "\n";
        }     

    }

    $traffic_fh->close();

} 
```

免责声明：我只是把它敲了出来，它的测试很少，也没有基准测试。完整性检查、错误处理和注释被省略以减少行数。不过，我没有吝啬空白。

至于您的代码：在使用它们之前无需定义您的函数。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-04-10T22:22:32.260

另一个例子重写：

```
sub is_less_than {
    my $left = shift; # I'm sure you just "forgot" to put the my() here...
    my $right = shift;

    my ($left_part_1, $left_part_2, $left_part_3, $left_part_4)     = split (/\./, $left);
    my ($right_part_1, $right_part_2, $right_part_3, $right_part_4) = split (/\./, $right);

    if  ($left_part_1 != $right_part_1 ) { 
        return ($left_part_1 < $right_part_1);
    }   
    if  ($left_part_2 != $right_part_2 ) { 
        return ($left_part_2 < $right_part_2);
    }   
    if  ($left_part_3 != $right_part_3 ) { 
        return ($left_part_3 < $right_part_3);
    }
    if  ($left_part_4 != $right_part_4 ) {
        return ($left_part_4 < $right_part_4);
    }
    return (false);  # They're equal
} 
```

对此：

```
sub is_less_than {
    my @left = split(/\./, shift);
    my @right = split(/\./, shift);

    # one way to do it...
    for(0 .. 3) {
        if($left[$_] != $right[$_]) {
            return $left[$_] < $right[$_];
        }
    }

    # another way to do it - let's avoid so much indentation...
    for(0 .. 3) {
        return $left[$_] < $right[$_] if $left[$_] != $right[$_];
    }

    # yet another way to do it - classic Perl unreadable one-liner...
    $left[$_] == $right[$_] or return $left[$_] < $right[$_] for 0 .. 3;

    # just a note - that last one uses the short-circuit logic to condense
    # the if() statement to one line, so the for() can be added on the end.
    # Perl doesn't allow things like do_this() if(cond) for(0 .. 3); You
    # can only postfix one conditional. This is a workaround. Always use
    # 'and' or 'or' in these spots, because they have the lowest precedence.

    return 0 == 1; # false is not a keyword, or a boolean value.
    # though honestly, it wouldn't hurt to just return 0 or "" or undef()
} 
```

也在这里：

```
my ($ip, $end_ip, $junk) = split /,/; 
```

`$junk`可能需要`@junk`捕获*所有*垃圾，**或者**您可以将其关闭 - 如果您将未知大小的数组分配给两个元素的“数组”，它将默默地丢弃所有额外的东西。所以

```
my($ip, $end_ip) = split /,/; 
```

和这里：

```
foreach (@ARGV) {
    open(TRAFFIC, $_) or die "Can't open $_ $OS_ERROR";
    while (<TRAFFIC> ) {
        chomp;
        if (defined $addresses{$_}) {
            print "$_\n";
        }
    }
    close (TRAFFIC);
} 
```

而不是`TRAFFIC`，使用变量来存储文件句柄。此外，一般来说，您应该使用`exists()`来检查哈希元素是否存在，而不是`defined()`- 它可能存在但被设置为`undef`（这不应该在您的程序中发生，但是当您的程序变得更复杂时，这是一个好习惯）：

```
foreach (@ARGV) {
    open(my $traffic, $_) or die "Can't open $_ $OS_ERROR";
    while (<$traffic> ) {
        chomp;
        print "$_\n" if exists $addresses{$_};
    }
    # $traffic goes out of scope, and implicitly closes
} 
```

当然，您也可以使用 Perl 的出色`<>`运算符，它打开 @ARGV 的每个元素以供读取，并充当遍历它们的文件句柄：

```
while(<>) {
    chomp;
    print "$_\n" if exists $addresses{$_};
} 
```

如前所述，尽量避免`use`ing `English`，除非你`use English qw( -no_match_vars );`避免那些邪恶的东西对性能造成重大影响`match_vars`。还没有注意到，但应该是......

**ALWAYS** *ALWAYS* ALWAYS `use strict;`，`use warnings;`否则 Larry Wall 会从天而降，破坏你的密码。我看到你有`-w`- 这已经足够了，因为即使在 Unix 之外，Perl 也会解析 shebang 行，并且会找到你的`-w`并且会`use warnings;`喜欢它。但是，您**需要**. `use strict;`这将在您的代码中捕获许多严重错误，例如未使用`my`或`false`用作语言关键字声明变量。

使您的代码能够正常工作，`strict`这`warnings`将导致更干净的代码永远不会因为您无法弄清楚的原因而中断。您将在调试器上花费数小时进行调试，并且您可能最终会使用`strict`并且`warnings`无论如何只是为了弄清楚错误是什么。**仅**当（且仅当）您的代码已**完成**并且您正在发布它并且它**永远不会**产生任何错误时才删除它们。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-11T04:10:14.313

虽然这样做肯定是在 Perl 中这样做的一种方法。

```
use strict;
use warnings;

my $new_ip;
{
  my @parts = split ('\.', $ip);

  foreach my $part(reverse @parts){
    $part++;

    if( $part > 255 ){
      $part = 0;
      next;
    }else{
      last;
    }
  }
  $new_ip = join '.', reverse @parts;
} 
```

这就是我实际实现它的方式。

```
use NetAddr::IP;

my $new_ip = ''.(NetAddr::IP->new($ip,0) + 1) or die; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-10T22:33:17.413

我不能说这个解决方案会让你的程序更像 Perl，但它可能会简化你的算法。

与其将 IP 地址视为需要嵌套 if 结构来实现增量功能的点分四元组、base-256 数字，不如将 IP 地址视为 32 位整数。将 abcd 形式的 IP 转换为整数（未测试）：

```
sub ip2int {
    my $ip = shift;
    if ($ip =~ /(\d+)\.(\d+)\.(\d+)\.(\d+)/) {
        return ($1 << 24) + ($2 << 16) + ($3 << 8) + $4;
    } else {
        return undef;
    }
} 
```

现在很容易确定一个 IP 是否位于两个端点 IP 之间。只需做简单的整数算术和比较。

```
$begin = "192.168.5.0";
$end = "192.168.10.255";
$target = "192.168.6.2";
if (ip2int($target) >= ip2int($begin) && ip2int($target) <= ip2int($end)) {
    print "$target is between $begin and $end\n";
} else {
    print "$target is not in range\n";
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-10T21:37:53.617

告诉你的同事他们的 perl 看起来太像线路噪音了。请不要仅仅为了混淆而混淆您的代码 - 正是这种愚蠢的开发目标使 perl 因不可读而声名狼藉，而真正糟糕的程序员（显然，就像您的同事一样）编写了草率的代码。结构良好、缩进且符合逻辑的代码是一件好事。C是个好东西。

不过，说真的 - 弄清楚如何编写 perl 的最佳位置是在 Damian Conway 的 O'Reilly “Perl Best Practices”中。它告诉你他认为你应该如何做事，他总是为他的立场给出充分的理由，偶尔也会给出不同意的充分理由。在某些方面我确实不同意他的观点，但他的推理是合理的。与比 Conway 先生更了解 perl 的人合作的可能性非常小，并且拥有一本印刷书籍（或至少订阅 Safari）可以为您的论点提供更坚实的支持。阅读 Perl Cookbook 时，请拿起一份副本，因为查看解决常见问题的代码示例应该会让您走上正轨。我讨厌说“买书”，

 *关于您的特定代码，您正在使用 foreach, `$_`, split with no parens, shift 等。在我看来，它看起来很像 perl-ish - 已经使用 perl 开发了很长一段时间。不过，请注意 - 我讨厌英语模块。如果您必须使用它，请像`use English qw( -no_match_vars );`. match_vars 选项显着降低了正则表达式的解析速度，并且它提供的`$PREMATCH`/`$POSTMATCH`变量通常没有用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-10T22:53:04.183

只有 1 条建议：使用严格。其余的几乎无关紧要。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-11T07:58:12.207

我十分明白你的感受。我的第一语言是 FORTRAN，就像一个优秀的 FORTRAN 程序员一样，我从 :) 开始用每种语言编写 FORTRAN。

我有这本非常棒的书《[Effective Perl Programming](https://rads.stackoverflow.com/amzn/click/com/0201419750 "有效的 Perl 编程")》，我会时不时地重读。特别是一章叫做“Idiomatic Perl”。下面是一些我用来让我的 Perl 看起来像 Perl 的东西： List Operators like for map and grep, slices and hash slices, the quote operator。

让我的 Perl 看起来不像 FORTRAN/C 的另一件事是定期阅读模块源代码，尤其是那些大师的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-10T22:19:02.020

您可以使用[Acme::Bleach](http://search.cpan.org/~dconway/Acme-Bleach-1.12/)或[Acme::Morse](http://search.cpan.org/~dconway/Acme-Bleach-1.12/lib/Acme/Morse.pm)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-13T22:16:24.870

虽然这会起作用：

```
use strict;
use warnings;
use 5.010;

use NetAddr::IP;

my %addresses;
# Parse all the ip addresses and record them in a hash.
{
  open( my $ips_file, '<', 'ips') or die;

  local $_; # or my $_ on Perl 5.10 or later
  while( my $line = <$ips_file> ){
    my ($ip, $end_ip) = split ',', $line;
    next unless $ip and $end_ip;

    $ip     = NetAddr::IP->new( $ip, 0 ) or die;
    $end_ip = NetAddr::IP->new( $end_ip ) or die;
    while( $ip <= $end_ip ){
      $addresses{$ip->addr} = 1;
      $ip++;
    }
  }
  close $ips_file
}

# print IP addresses in any of the found ranges
use English;

for my $arg (@ARGV) {
  open(my $traffic, '<',$arg) or die "Can't open $arg $OS_ERROR";
  while( my $ip = <$traffic> ){
    chomp $ip;
    if( $addresses{$ip} ){
      say $ip
    }
  }
  close ($traffic);
} 
```

如果可能的话，我会使用网络掩码，因为它变得更加简单：

```
use Modern::Perl;
use NetAddr::IP;

my @addresses;
{
  open( my $file, '<', 'ips') or die;

  while( (my $ip = <$file>) =~ s(,.*){} ){
    next unless $ip;
    $ip = NetAddr::IP->new( $ip ) or die;
    push @addresses, $ip
  }

  close $file
}

for my $filename (@ARGV) {
  open( my $traffic, '<', $filename )
    or die "Can't open $filename";

  while( my $ip = <$traffic> ) {
    chomp $ip;
    next unless $ip;

    $ip = NetAddr::IP->new($ip) or next; # skip line on error
    my @match;
    for my $cmp ( @addresses ){
      if( $ip->within($cmp) ){
        push @match, $cmp;
        #last;
      }
    }

    say "$ip => @match" if @match;

    say "# no match for $ip" unless @match;
  }
  close ($traffic);
} 
```

测试`ips`文件：

```
192.168.0.1/24
192.168.0.0
0:0:0:0:0:0:C0A8:0/128 
```

测试`traffic`文件：

```
192.168.1.0
192.168.0.0
192.168.0.5 
```

输出：

```
# no match for 192.168.1.0/32
192.168.0.0/32 => 192.168.0.1/24 192.168.0.0/32 0:0:0:0:0:0:C0A8:0/128
192.168.0.5/32 => 192.168.0.1/24 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-10T21:03:47.100

而不是这样做：

```
 if  ($left_part_1 != $right_part_1 ) { 
    return ($left_part_1 < $right_part_1);
} 
```

你可以这样做：

```
 return $left_part_1 < $right_part_1 if($left_part_1 != $right_part_1); 
```

此外，您可以使用[Fatal](http://search.cpan.org/~pjf/autodie-1.999/lib/Fatal.pm)模块，以避免检查错误。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-11T00:07:31.883

我用于“我的代码看起来如何”的唯一标准是阅读和理解代码**用途**的难易程度（尤其是不熟悉 Perl 的程序员），而不是它是否遵循特定的风格。

如果 Perl 语言特性使某些逻辑更容易理解，那么我会使用它，如果不是，我不会——即使它可以用更少的代码来完成。

您的同事可能会认为我的代码非常“un perl-ish”，但我敢打赌他们完全理解代码在做什么，并且可以修改它以修复/扩展它而不会遇到任何麻烦：

我的版本：

```
#******************************************************************************
# Load the allowable ranges into a hash
#******************************************************************************
my %ipRanges = loadIPAddressFile("../conf/ip.cfg");

#*****************************************************************************
# Get the IP to check on the command line
#*****************************************************************************
my ( $in_ip_address ) = @ARGV;

# Convert it to number for comparison
my $ipToCheckNum = 1 * sprintf("%03d%03d%03d%03d", split(/\./, $in_ip_address));

#*****************************************************************************
# Loop through the ranges and see if the number is in any of them
#*****************************************************************************
my $startIp;
my $endIp;
my $msg = "IP [$in_ip_address] is not in range.\n";

foreach $startIp (keys(%ipRanges))
   {
   $endIp = $ipRanges{$startIp};

   if ( $startIp <= $ipToCheckNum and $endIp >= $ipToCheckNum ) 
      {
      $msg = "IP [$in_ip_address] is in range [$startIp] to [$endIp]\n";
      }
   }

print $msg;

#******************************************************************************
# Function: loadIPAddressFile()
#   Author: Ron Savage
#     Date: 04/10/2009
# 
# Description:
# loads the allowable IP address ranges into a hash from the specified file.
# Hash key is the starting value of the range, value is the end of the range.
#******************************************************************************
sub loadIPAddressFile
   {
   my $ipFileHandle;
   my $startIP;
   my $endIP;
   my $startIPnum;
   my $endIPnum;
   my %rangeList;

   #***************************************************************************
   # Get the arguments sent
   #***************************************************************************
   my ( $ipFile ) = @_;

   if ( open($ipFileHandle, "< $ipFile") )
      {
      while (<$ipFileHandle>)
         {
         ( $startIP, $endIP ) = split(/\,/, $_ );

         # Convert them to numbers for comparison
         $startIPnum = 1 * sprintf("%03d%03d%03d%03d", split(/\./, $startIP));
         $endIPnum   = 1 * sprintf("%03d%03d%03d%03d", split(/\./, $endIP));

         $rangeList{$startIPnum} = $endIPnum;
         }

      close($ipFileHandle);
      }
   else
      {
      print "Couldn't open [$ipFile].\n";
      }

   return(%rangeList);
   } 
```

（注意：额外的“#”行是为了保留我的怪异间距，在这里发布代码时总是会被破坏）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-11T20:50:52.580

我错过了什么......上述任何阵列版本都可以工作吗？mods 是在 for 循环的本地变量上执行的。我认为 Brad Gilbert 的 Net::IP 解决方案是我的选择。Chris Lutz 几乎按照我的方式清理了其余部分。

顺便说一句 - 一些关于可读性的评论让我感到好奇。关于 Erlang/Lisp 语法的可读性的抱怨是否更少，因为只有一种方法可以在其中编写代码？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-13T16:31:46.447

这可能更像 C，但也更简单：

```
use Socket qw(inet_aton inet_ntoa);

my $ip = ("192.156.255.255");

my $ip_1 = inet_ntoa(pack("N", unpack("N", inet_aton($ip))+1));
print "$ip $ip_1\n"; 
```

更新：我在阅读问题中的所有代码之前发布了这个。这里的代码只是增加ip地址。

# java - 未检测到 Java 套接字关闭

> ID：738842
> 
> 赞同：1
> 
> 时间：2009-04-10T20:57:56.317
> 
> 标签：java, sockets, connection

我正在编写一个快速服务器来测试应用程序。如果我关闭客户端上的套接字，它不会抛出套接字关闭的异常。我一直在写 100mb 的随机数据（它应该做什么）。如何检测客户端是否关闭连接？

```
import java.io.PrintWriter;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.Socket;
import java.net.ServerSocket;
import java.util.Random;

public class server {

public static void main(String [ ] args){

int size = 1048576 * 100;

String response ="HTTP/1.0 200 OK\n" +
    "Server: server\n" +
    // "Date: Sun, 05 Apr 2009 04:40:08 GMT\n" +
    // "Last-Modified: Tue, 23 May 2006 22:18:19 GMT\n" +
    "Content-Type: application/zip\n" +
    "Content-Length: " + size + " \n" +
    "Connection: keep-alive\n";

try{
    ServerSocket serverSocket = new ServerSocket(4444);

    while(true){

    System.out.println( "Listenning..." );
    Socket clientSocket = serverSocket.accept();

    PrintWriter out = 
        new PrintWriter(clientSocket.getOutputStream(), true);
    BufferedReader in = new BufferedReader
        (new InputStreamReader( clientSocket.getInputStream()));
    String inputLine, outputLine;

    System.out.println("-----------Request-----------" );
    while ((inputLine = in.readLine()) != null) {   
        if (inputLine.equals("") == true )
        break;
        System.out.println( inputLine );
    }

    System.out.println("-----------Response-----------" );
    System.out.println( response );
    out.print(response);
    out.print("\r\n");

     //waits for the whole for to finish no exceptions are thrown
    Random rand = new Random();
    for( int i=0 ; i< size ;i++){
        int randnum = rand.nextInt(9);
        out.print( randnum );
    }

    //out.println("test");

    out.close();
    in.close();
    }

}catch( Exception e ) { 
    System.out.println( e.toString() );
}           
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T21:04:45.600

该类`PrintWriter`忽略底层输出流引发的异常。如文档中所述，您需要主动[检查它是否有错误](http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html#checkError())。

您可能会考虑使用[`Formatter`](http://java.sun.com/javase/6/docs/api/java/util/Formatter.html#Formatter(java.lang.Appendable))该类而不是`PrintWriter`. 它将帮助您格式化文本喜欢`PrintStream`和`PrintWriter`做（以及更多），并且还将传递来自底层的异常`Appendable`（在这种情况下应该是`OutputStreamWriter`）。

# c - 如果不使用 malloc 的块会怎样？

> ID：738846
> 
> 赞同：2
> 
> 时间：2009-04-10T20:58:45.630
> 
> 标签：c, memory-leaks, free, malloc

考虑以下 C 代码：

```
int main(){  
    int* c;  
    c = (int*)malloc(sizeof(int));  
    c = 0xdeadbeef;  
    free(c);  
    return 0;  
} 
```

这将出现段错误，因为您正在尝试释放 c，这不是以前 malloc'ed 的东西。我的问题是我刚刚分配的块会发生什么？显然 c 不再指向它，所以它不能被使用，但它仍然被认为是“空闲”列表的一部分，或者这是一个显式的内存泄漏？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T21:00:07.200

这是一个泄漏。当您的程序终止时，它会被操作系统回收。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-10T21:02:50.627

内存仍然被分配，导致内存泄漏。你想要其他方式吗？机器/编译器确实没有办法知道您分配的内存应该被回收。如果这不是正确的行为，您的代码将按概率运行：您永远无法真正信任该代码。

您可以在将来的某个时间重新指向该内存块，因此自动释放它会将地毯从您身下拉出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:01:59.193

`c = 7;`假设您更改为，该代码不会出现段错误`*c = 7;`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T09:23:13.623

好吧，imo，此时出现的段错误不是因为您尝试释放以前未分配的内存，而是因为您尝试引用操作系统未授予您权限的内存地址而发生段错误（这是分段错误的定义）。

一些实验，比如你会在 valgrind 中运行你的示例代码，你会得到这个作为输出：

```
    ==6945== 无效的 free() / delete / delete[]
    ==6945== 在 0x402265C: 空闲 (vg_replace_malloc.c:323)
    ==6945== by 0x80483D5: main (bla.c:6)
    ==6945== 地址 0x7 没有被堆栈、malloc 或（最近）释放
    ==6945==
    ==6945== 错误摘要：来自 1 个上下文的 1 个错误（抑制：来自 1 个的 11 个）
    ==6945== malloc/free：退出时使用：1 个块中的 4 个字节。
    ==6945== malloc/free：1 个分配，1 个释放，4 个字节分配。

```

所以这是一个内存泄漏'pur sang'。现在假设您将更改代码，以便您尝试释放的指针“靠近”您分配的指针（因此操作系统仍然知道您可以访问它，操作系统不会授予字节边界上的内存访问权限）。假设我们像这样修改代码：

```
int main(){  
    int* c;  
    c = (int*)malloc(sizeof(int));  
    c++;
    free(c);  
    return 0;  
} 
```

运行此应用程序时，您不会再收到分段错误（由内核发出），而是来自 glibc（ malloc() 和 free() 的所有者）的警告

```
    edb@Flying-Spaghetti-Monster:/tmp$ ./a.out
    *** 检测到 glibc *** ./a.out: free(): 无效指针：0x0804a00c ***
    ...接着是一个痕迹

```

所以你试图释放一些内核知道它属于你但glibc不记得把它交给你的内存。如果您在 valgrind 中运行它（通过替换 libc 中的 free()、malloc()、realloc()、... 函数并自行执行记帐），您将得到以下输出：

```
    ==6955== 无效的 free() / delete / delete[]
    ==6955== 在 0x402265C: 空闲 (vg_replace_malloc.c:323)
    ==6955== by 0x80483D2: main (bla.c:5)
    ==6955== 地址 0x418a02c 在大小为 4 的块分配后为 0 字节
    ==6955== 在 0x4022AB8: malloc (vg_replace_malloc.c:207)
    ==6955== by 0x80483C0: main (bla.c:3)
    ==6955==
    ==6955== 错误摘要：来自 1 个上下文的 1 个错误（抑制：来自 1 个的 11 个）
    ==6955== malloc/free：退出时使用：1 个块中的 4 个字节。
    ==6955== malloc/free：1 个分配，1 个释放，4 个字节分配。

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T21:17:22.743

在 malloc() 之后，`c`是一个保存内存地址的变量。在这种情况下，`c`具有您分配的第一个字节的内存地址的值。

当您说时`c = 7`，您是在说“`c`现在指向内存地址 '7'”。因为，在这种情况下，内存地址“7”没有分配给你的进程，你不能 free() 它。从理论上讲，内存地址“7”（或 0xa73c930bf，或您设置的任何内容）确实可能已分配给您的进程，在这种情况下 free() 将成功。

但是，在更改 c 的值之后，内存仍然被分配。您的进程仍然拥有内存及其数据 - 您刚刚丢失了指针。你不知道那段记忆从哪里开始。

这是一个好的情况。在 C 中，您可能有不同的变量指向该内存地址。您甚至可能有一个“int”，而不是一个“int*”来存储该内存地址。C 不会尝试跟踪您是否存储了那个特定的内存地址——这实际上只是一个数字。这样做将是一项不可能完成的任务，因为任何保持跟踪的尝试都需要失去 C 指针提供的一些灵活性。

因此，回答您的问题：由于您无法跟踪 c 的值，因此该程序存在内存泄漏。我的意思是你的内存不可能被你的程序使用，因此浪费了资源。

但是，当程序退出时，分配给您的进程的所有内存都将被释放并可供其他程序使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T21:28:19.787

请不要喷我，但我不清楚你的问题的重点是什么。很明显，你正在做的事情与语言打算让你做的事情直接冲突。这相当于说“如果我用灭火器液填充汽车的油箱会发生什么，只是因为灭火器的喷嘴恰好适合油箱孔”。
我不是想成为一个混蛋，我只是不清楚为什么这个特殊问题？我可以想出无穷无尽的问题，这些问题利用了指针的力量，想知道有多少种方法会错误地使用它们，从而导致应用程序失败。如果您能找到正确的方法，您是否正在尝试完成您的代码*会做的事情？或者您想知道是否有某种内部机制可以跟踪您的指针并在您不小心丢失该内存时帮助您回收该内存？（如果是这样，上面已经回答了这个问题）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T21:08:29.100

请注意，返回的值`malloc()`不需要强制转换，因为转换`void*`->`int*`是自动的。

您还可以像这样重写调用：

```
c = malloc(sizeof *c); 
```

所以现在如果你改变`c`'s 的类型，你根本不需要重写分配。

[编辑]

检查分配是否成功（即`c != NULL`）也是一个好主意。

# javascript - 如何使用 AS3 运行 jQuery 函数

> ID：738849
> 
> 赞同：7
> 
> 时间：2009-04-10T21:00:05.797
> 
> 标签：javascript, jquery, actionscript-3

我正在尝试从 AS3 在我的 HTML 页面上运行 jQuery 函数。

这是我的 jQuery 函数：

```
function loadImage(imageNumber)
  {
    imageURL = '<img src="images/image' + imageNumber + '.jpg">';
    $("#imageBox").html(imageURL);
  } 
```

这是我在 HTML 页面中的 flash 文件的设置：

```
<param name="allowScriptAccess" value="always" />
<param name="bgcolor" value="#ffffff" />    
<embed src="links.swf" quality="high" bgcolor="#ffffff" width="320" height="242" name="links" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer" /> 
```

最后......这是我的 .swf 文件中的 AS3 脚本：

```
function gotoImage1(e:MouseEvent):void {
    var jscommand:String = "loadImage(1);"
    var link:URLRequest = new URLRequest("javascript:" + jscommand + "");
    navigateToURL(link, '_self');
} 
```

提前感谢您抽出宝贵时间查看，非常感谢您提供任何帮助。

最诚挚的问候。汤姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T21:05:30.073

您可以`ExternalInterface`改用：

```
if (ExternalInterface.available) {
    ExternalInterface.call('function(){ alert("test"); }');
} 
```

文档： http: [//livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html](http://livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T21:26:43.173

最终的解决方案是：

```
function gotoImage2(e:MouseEvent):void 
{
    if(ExternalInterface.available)
    {
        ExternalInterface.call('function(){ loadImage(2); }');
    }
} 
```

以防万一有人想看看它是如何结束的……

# delphi - 测试磁盘是否有写权限

> ID：738856
> 
> 赞同：1
> 
> 时间：2009-04-10T21:01:33.437
> 
> 标签：delphi, disk

我需要知道我的程序是否可以从它运行的位置将文件写入磁盘（HDD、软盘、闪存、CD）。我试过类似的东西：

```
 {$I-}
     Rewrite(myFile);                                       
     {$I+}
  Result:= (IOResult = 0); 
```

问题是，如果磁盘是只读的，Windows 会给我一条错误消息，告诉我

> “appName.exe - 写保护错误磁盘无法写入，因为它被写保护。请从驱动器 D: 中的卷 USB_BOOT 中删除写保护。取消 TryAgain Continue”

如何在不引发任何错误/警告消息的情况下测试写访问？谢谢。

* * *

编辑：

行。“错误”与上述代码无关。我只以为它出现在那里。我将代码移动到只读磁盘并从那里运行它。该错误出现在名为“CreateShortcutEx”的函数中，在这一行：

```
 MyPFile.Save(PWChar(WFileName),False); 
```

MyPFile 声明如下：

```
var
 MyObject  : IUnknown;
 MySLink   : IShellLink;
 MyPFile   : IPersistFile;
 Directory : String;
 WFileName : WideString;
 MyReg     : TRegIniFile;
begin
 MyObject := CreateComObject(CLSID_ShellLink);
 MySLink  := MyObject as IShellLink;
 MyPFile  := MyObject as IPersistFile;
 .....
end; 
```

那么，如果 WFileName 参数是 "C:\documents and settings\bla bla" ，为什么 MyPFile 会尝试写入应用程序的驱动器（只读的驱动器）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T21:08:52.530

调用 Windows API [*SetErrorMode()*](http://msdn.microsoft.com/en-us/library/ms680621(VS.85).aspx)函数以禁用错误消息框。

**编辑：**

我刚试过，这个：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  Str: TStream;
  OldMode: Cardinal;
begin
  OldMode := SetErrorMode(SEM_FAILCRITICALERRORS);

  try
    try
      Str := TFileStream.Create('z:\foo.txt', fmOpenReadWrite);
      try

      finally
        Str.Free;
      end;
    except end;
  finally
    SetErrorMode(OldMode);
  end;
end; 
```

按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-24T15:12:20.297

不是很漂亮，但这似乎对我有用。

* * *

```
 function CanWrite(drive: string): boolean;
    var
        OldMode: Cardinal;
    begin
        OldMode := SetErrorMode(SEM_FAILCRITICALERRORS);
        try
            with TStringList.Create do
                try
                    SaveToFile(drive + ':\file.txt');
                    result := true;

                    try
                        deletefile(drive + ':\file.txt');
                    except
                    end;
                except
                    result := false;
                end;
        finally
            SetErrorMode(OldMode);
        end;
end; 
```

* * *

打电话给它

* * *

```
 if CanWrite('g') = true then
    begin
        showmessage('Can Write');
    end
    else
    begin
        showmessage('Can not write');
end; 
```

* * *

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T21:22:46.693

当您将代码放入 try/except 时会发生什么？

此外，您可以尝试（类似）这样：

```
function CanWrite: boolean;
begin
  result := true;
  with TStringList.Create do
  try
    SaveToFile('file.txt');
  except
    result := false;
  finally
    Free;
  end;
end; 
```

抱歉，我不再使用 Delphi 编写代码，也没有在任何地方安装 Delphi。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T22:29:04.117

有一个小的免费软件“驱动器准备好了吗？” 由 Horst Schaeffer 编写的实用程序 ( [dready.com )，它也可以检查写访问。](http://home.mnet-online.de/horst.muc/horst.htm)我尚未对其进行测试，但据我所知，这可以用作解决方案；例如将其称为“DREADY C: /W”并检查返回值。

# mysql - MySQL 50% 自然搜索阈值的解决方法

> ID：738859
> 
> 赞同：0
> 
> 时间：2009-04-10T21:02:17.913
> 
> 标签：mysql, search, full-text-search

我有一个表格，我在其中插入例如图像和在所述图像中找到的颜色名称。颜色字符串看起来像：

> *白色, 黄色, 橙色, 黑色*

因为我有很多这些，50% 的阈值开始减少一些颜色，因为它们出现在大多数行上。

该表的重点是能够按颜色进行搜索。有没有人有解决方法，还是我应该放弃并选择 Sphinx 或类似的东西？重新编译 MySQL 可能不是一种选择。

我听说有些人只是在表中添加虚拟行以绕过 50%，但这听起来很绝望。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T21:15:39.957

这不是全文搜索要解决的问题。

相反，您需要一个子表，每个图像每种颜色一行。

颜色应该是颜色表的外键，因此您的子表实际上成为图像和颜色之间的多对多关系。

```
create table color ( 
 id int not null primary key auto_increment,
 name varchar64)
); 

create table image_color (
  image_id int references image(id), 
  color_id int reference color(id),
  unique constraint (image_id, color_id) 
) ; 
```

然后索引关系（并在元组（image_id，color_id）上给它一个唯一的约束。

然后查找具有特定颜色的所有图像：

```
select a.* from image a 
join image_color b on (a.id = b.image_id) 
join color c on (b.color_id = c.id)
where c.name = 'yellow'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T01:15:35.137

> 该表的重点是能够按颜色进行搜索。有没有人有解决方法

是的，使用[BOOLEAN MODE](http://dev.mysql.com/doc/refman/5.1/en/fulltext-boolean.html)搜索，它不受 50% 阈值的影响，并且更不可预测。

但是，对 tpdi 的回答 +1，我无法想象您为什么使用全文搜索而不是列出颜色的简单连接表。这是一个简单的是/否逻辑存储问题，无需拖入全文复杂的分词、词序、停用词、太短的词（默认情况下不会索引“红色”）以及最重要的事实您必须使用令人讨厌的旧 MyISAM 表才能获得该功能！

全文搜索通常很难，并且在 MySQL 中实现得不是特别好。当您确实需要在大量文本中搜索单词时，它应该是您最后的手段，而不是作为选择的功能。

# c++ - C函数将原始图像转换为png

> ID：738863
> 
> 赞同：3
> 
> 时间：2009-04-10T21:04:02.900
> 
> 标签：c++, c

是否有任何 c 函数可以让我将原始图像转换为 PNG 文件？最好，我不需要为此拉一个大图书馆。

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-10T21:06:41.647

我不相信。另一方面，[libpng](http://www.libpng.org/pub/png/libpng.html)并不是一个庞大的库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T21:07:49.087

您是否尝试过 libpng 库？

[http://www.libpng.org/pub/png/libpng.html](http://www.libpng.org/pub/png/libpng.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:09:38.880

我不确定您所说的“原始图像”是什么意思，但我发现 LodePNG 易于使用。[http://members.gamedev.net/lode/projects/LodePNG/](http://members.gamedev.net/lode/projects/LodePNG/)有一个示例向您展示如何将一些原始数据编码为 png

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T21:29:12.153

请参阅相关问题：[Convert bitmap to PNG in-memory in C++ (win32)](https://stackoverflow.com/questions/366768/convert-bitmap-to-png-in-memory-in-c-win32)

简短的回答是 GDI+ 可以将位图图像转换为 PNG（有一些限制），所以如果你在 Windows 上，它是一个比 libPNG 更小的选项。

# php - PHP中的非ASCII字符？

> ID：738886
> 
> 赞同：2
> 
> 时间：2009-04-10T21:12:43.270
> 
> 标签：php, serial-port, char, ascii

我正在尝试使用 PHP 向串行端口（r232）发送一些东西。我正在使用这个类：[http ://www.phpclasses.org/browse/package/3679.html](http://www.phpclasses.org/browse/package/3679.html)

问题是我只能发送 1 个字节。但如果我发送类似“1”的内容，我实际上发送的是 49（ASCII 表示 1）。我尝试使用 send(1) 而不是 send("1")，但这并不好，因为这是具有 2 个字节的整数。那么有没有办法发送一个“真正的”字符，而不是 ASCII 等价物？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T21:16:01.187

[chr()](http://us3.php.net/chr)函数返回由对应的 ascii 字符的整数给出的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T21:19:14.377

看起来图书馆期待字符作为输入。如果您需要发送编码为 的字符`0x01`，您只需发送“\001”。函数 chr() 会将字符转换为整数值，在这里没有用。

还有一件事：整数的字节大小取决于底层系统，主要是 4 个字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T21:22:23.327

我不确定您要完成什么。您是否尝试发送整数 1？不熟悉该类，您是否尝试仅给出值 1 作为参数？如果这不起作用，请尝试用[`chr()`](http://php.net/chr)函数包装它。

# c# - 在 Visual Studio 2008 C# 代码中看不到方法等

> ID：738888
> 
> 赞同：0
> 
> 时间：2009-04-10T21:12:59.760
> 
> 标签：c#, .net, visual-studio, visual-studio-2008

我通常在 VB.NET 中编写代码，但我现在正在学习 C# .NET 教程。我希望在代码文件的顶部看到一个用于选择方法和属性的下拉列表，就在我打开的代码文件的选项卡下方。但是，我没有看到这些。如果我打开 VB 代码，它工作得很好。我试图在 Visual Studio 中寻找一个我没有打开的选项，但我找不到我缺少的东西。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T21:16:12.373

转到工具->选项->文本编辑器->C#->常规并检查“导航栏”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T21:16:25.820

如果要访问事件，可以在属性框上边框的设计模式下进行，有一个“雷”可以访问它们，这部分与VBasic不同

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:18:31.807

工具菜单 --> 选项

文本编辑器 ---> C# ----> 常规 ----> 导航栏（选中此框）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T21:24:22.463

重置整个环境。工具--> 导入和导出设置... 在此对话框中，您可以重置 IDE 设置，选择将所有环境设置重置为默认设置集合之一。（VB 开发人员、C# 开发人员、Web 开发人员、项目经理……）

# ruby-on-rails - Rails :dependent 和 :delete

> ID：738906
> 
> 赞同：2
> 
> 时间：2009-04-10T21:19:43.083
> 
> 标签：ruby-on-rails, activerecord, dependencies

我正在运行 Rails 2.0.2，无法在我的 AR 关联中使用 :dependent => :delete

```
 has_many :items, :dependent => :delete 
```

我收到了这个错误。

```
 The :dependent option expects either :destroy, :delete_all, or :nullify (:delete) 
```

我无法找到 :delete_all 的文档以查看它是否符合我的要求。它与删除基本相同吗？:delete 最近是否添加到 Rails 中，但不在我使用的版本中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T21:44:08.687

这是[Rails 2.0.2 的相关文档](http://www.railsbrain.com/api/rails-2.0.2/doc/index.html?a=M001413&name=has_many)：

> 如果设置为 :destroy，则所有关联的对象都会通过调用其destroy 方法与该对象一起被销毁。如果设置为 :delete_all 所有关联对象都将被删除而不调用它们的destroy方法。如果设置为 :nullify 所有关联对象的外键设置为 NULL 而不调用它们的保存回调。

railsbrain.com 是查找特定 Rails 版本的文档的好地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-04T21:41:31.223

默认操作是“什么都不做”。对象保持孤立状态，没有任何内容被删除、销毁或取消。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T21:39:27.717

当前稳定版 2.3.2 的文档中没有提到 :delete ：

> 如果对象与 :dependent => :destroy 相关联，则对象将被另外销毁，如果与 :dependent => :delete_all 相关联，则对象将被删除。

[http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many](http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many)

# css - 消除文本行之间的间隙

> ID：738907
> 
> 赞同：6
> 
> 时间：2009-04-10T21:21:00.130
> 
> 标签：css, text

当您增加元素的行高时，您会开始在每行文本之间出现间隙。大多数时候这很好，因为你看不到具体的差距。

但是当你有一个狭窄的列，一个跨越多行的链接时，这是有问题的。如果将鼠标移到链接上，则行之间会有一个小间隙，这会使链接悬停效果闪烁。

从设计/可用性的角度来看，我觉得这会导致糟糕的用户体验（没有人喜欢随机闪烁）。试试这个：

> [Lorem ipsum dolor sit amet, consectetur adipiscing elit。In est. Nunc aliquam, eros a aliquam consequat, ante diam rutrum risus, et dignissim ligula turpis et ante。Maecenas leo neque, euismod in, aliquam et, molestie ac, ligula。整数 venenatis。Pellentesque enim。Maecenas aliquet，molestie sodales 的侵权者，urna velit pulvinar lorem，ac malesuada nibh turpis eu 侵权者。](http://stackoverflow.com)

我可以在链接中添加一些填充以防止在某些情况下发生这种情况，但是当文本较大时它不起作用；我需要更多的填充。有人有解决方案的想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T21:27:18.913

`<a>`尝试通过为该窄列中的元素设置 display:block 来解决闪烁问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T00:22:40.117

如果您知道每条线的起点和终点，您可以在每条线周围放置一个跨度，并将其变成一个内联块

```
#wrap {font-size:14px; line-height:16px;}
a span{display:-moz-inline-block; display:inline-block;line-height:14px;padding:1px 0;}
a:hover {background:red;}

<div id="wrap">
dsvlaksvh; asvj asdfh;dhldv hd d dl h dfhd d dfh; daljfda k;d <a href="#" >
<span>hdv </span><span>dvh ldvhldf dhk </span><span>;dhkdf hdl hdfk 
</span><span>dfhkldf h vkhg j</span></a> glj gj f gjl fjl fj f
    </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T12:00:02.287

使用相对单位来设置填充。

无论字体大小如何（通过 CSS 设置或放大），将`padding: 0.2ex 0; background: red;`使用 Firebug/Dragonfly 添加到问题中的示例链接对我来说都很好。

在 Firefox 中更改字体大小的唯一问题是背景开始与前一行重叠；但这是个`line-height`问题。

# asp.net - 在 ASP.NET 中进行线程处理时应该注意什么？

> ID：738909
> 
> 赞同：3
> 
> 时间：2009-04-10T21:22:20.487
> 
> 标签：asp.net

最近，关于 Winforms 应用程序线程的书（Joe Duffy 在 Windows 上的并发编程）出版了。这本书专注于winforms，有1000页。

ASP.NET 线程中有哪些陷阱？我确信在 ASP.NET 中实现线程时需要注意很多问题。我应该注意什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T21:35:13.607

由于 IIS 接收到的每个 http 请求都是单独处理的，无论如何都是在它自己的线程上处理的，所以您应该遇到的唯一问题是，如果您在单个 http 请求的范围内启动了一些长时间运行的进程。在这种情况下，我会将此类代码放入一个单独的引用依赖程序集中，像中间层组件一样编码，完全不依赖或耦合到 ASP.Net 模型，并单独处理该程序集中出现的任何并发问题，无需完全担心 ASP.Net 模型......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T21:24:29.047

Wintellect 的 Jeff Richter 有一个名为 PowerThreading 的库。如果您在 .NET 上开发应用程序，这将非常有用。=>[电源线程库](http://www.wintellect.com/PowerThreading.aspx)

在各种活动中在线查看他的演示文稿。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T22:50:23.707

通常鼓励您在 .Net 中使用线程池，因为它有很多好处，代表您管理事物......但**不是**在 ASP.net 中。

由于 ASP.net 已经是多线程的，它使用线程池来处理映射到 ASP.net ISAPI 过滤器的请求，并且由于线程池的大小是固定的，通过使用它，您基本上可以带走线程留出处理请求的工作。

在小型、低流量的网站中，这不是问题，但在大型、高流量的网站中，您最终会竞争和消耗 ASP.net 进程所依赖的线程。

如果你想使用线程，可以做类似的事情......

```
 Thread thread = new Thread(threadStarter);
   thread.IsBackground = true;
   thread.Start(); 
```

**但有一个警告：** 确保`IsBackground`设置为，`true`因为如果不是，线程存在于前台，并且可能会阻止 IIS 工作进程回收或重新启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T21:30:04.587

立即想到的是，为什么要在 ASP.NET 中“实现线程”。

您确实需要始终意识到 ASP.NET**是**多线程的，因为许多请求可以在其自己的线程中同时处理。因此，例如使用静态字段需要考虑线程。

但是，您很少会想自己在代码中启动一个新线程。

就 UI 中线程的常见 Winforms 问题而言，这些问题在 ASP.NET 中不存在。无需担心基于窗口的消息泵。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T21:43:35.660

可以在 ASP.NET 中创建异步页面。这些将执行所有步骤直到某一点。例如，这些步骤将包括异步获取数据。当所有异步任务都完成后，页面生命周期的剩余部分将执行。同时，工作线程没有被占用等待数据库 I/O 完成。

在此模型中，所有额外线程都在执行，而请求、页面实例和所有控件仍然存在。启动自己的线程时必须小心，在线程执行时，请求、页面实例和控件可能已被释放。

此外，像往常一样，请确保多线程实际上会提高性能。通常，额外的线程会使事情变得更糟。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T21:43:54.757

首先，您是在谈论异步 ASP.NET 吗？或者使用 ThreadPool/启动你自己的线程？

如果您**不是**在谈论异步 ASP.NET，那么要回答的主要问题是：您将在其他线程中做什么工作以及该工作是否特定于请求/响应周期，或者更多的是关于处理全局任务在后台？

**编辑**

如果您需要为给定的请求/响应周期处理*并发操作*（比*多线程*IMO 更好的术语），请使用 ASP.NET 的异步功能。这些提供了 IIS 对并发支持的抽象，允许服务器在当前请求等待工作完成时处理其他请求。

对于全局任务的后台处理，我根本不会使用 ASP.NET。您应该假设 IIS 将在随机时间点回收您的 AppPool。您也不应该假设 IIS 会按任何计划运行您的 AppPool。任何重要的后台处理都应该在 IIS 之外完成，无论是作为计划任务还是 Windows 服务。我通常采用的方法是拥有一个 Windows 服务和一个共享工作队列，网站可以在其中发布工作项。队列可以是数据库表、可靠的基于消息的队列（MSMQ 等）、文件系统上的文件等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T22:02:25.977

陷阱与任何多线程应用程序中的问题几乎相同。

处理请求所涉及的类（Page、Controls、HttpContext.Current、...）是特定于该请求的，因此不需要任何特殊处理。

类似地，对于您在这些类中实例化为局部变量或字段的任何类，以及对 Session 的访问。

但是，像往常一样，您需要同步对共享资源的访问，例如：

*   静态（C#）/共享（VB.NET）引用。
*   单身人士
*   外部资源，如文件系统……等等……

我在 ASP.NET 应用程序中经常看到线程错误，例如，多个并发请求在没有同步的情况下使用单例，导致用户 A 看到用户 B 的数据。

# .net - 如何解决通用异常处理程序中的 __Canon 类型问题？

> ID：738911
> 
> 赞同：1
> 
> 时间：2009-04-10T21:22:29.223
> 
> 标签：.net, vb.net, generics, exception

给定这样的扩展方法：

```
Public Sub RehydrateTo(Of T As New)(ByVal input As String, ByRef output As T)

   Dim ms As MemoryStream = MsFromString(input)
   Dim f As New DataContractSerializer(GetType(T))

   Try
      output = CType(f.ReadObject(ms), T)
   Catch ex As SerializationException
      output = New T
      Dim ild As ILegacyDeserializer = TryCast(output, ILegacyDeserializer)
      If Not ild Is Nothing Then
         ' ... you get the idea
      End If
   End Try

End Sub 
```

以及从 ObservableCollection(Of V) 继承的 MyCollection 类型，我们发现在异常处理程序中调用 someString.RehydraTo(instanceOfMyCollection) 可能会失败。问题是 GetType(T) 并不总是评估为“MyCollection”——而在异常处理程序中，它评估为“__Canon”。

（ System.__Canon 是某种 CLR 魔法，意味着泛型的规范实例化）

我们如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T21:24:21.510

T 的奇怪行为只存在于异常处理程序中，因此您可以将代码移出处理程序，如下所示：

```
Dim exceptionCaught As Boolean
Try
   output = CType(f.ReadObject(ms), T)
Catch ex As SerializationException
   exceptionCaught = True
End Try

If Not exceptionCaught Then
   Exit Sub
End If

'here we put the code that we want to handle the exception 
```

问题是异常处理程序是跨多种类型的“代码共享”。当我们在异常处理程序中时，我们不是在特定于我们编写的任何类的代码中，我们在一个泛型的规范实例中——这就是为什么 T = System.__Canon。

解决方法是在代码共享块中不评估 T 。

# sql-server - sp_MSforeachdb MS SQL 错误

> ID：738914
> 
> 赞同：0
> 
> 时间：2009-04-10T21:23:17.613
> 
> 标签：sql-server, sp-msforeachdb

这适用于 MS SQL 2005：任何人都知道为什么第一个成功，然后连续创建两个相同的语句失败？所有的陈述都是完全一样的。将双引号更改为两个单引号具有相同的效果。

> sp `_`MSforeachdb @command1 = 'if (left("?", 2) = "p `_`") 开始；打印 ”？”; 结尾;';
> 
> 生产
> 
> p `_`NationalBrands
> p `_`NonBrand
> p以P下划线开头的`_`数据库`_`名称`_``_``_``_``_`

但

> sp `_`MSforeachdb @command1 = 'if (left("?", 2) = "p `_`") 开始；打印 ”？”; 结尾;';
> sp `_`MSforeachdb @command1 = 'if (left("?", 2) = "p `_`") 开始；打印 ”？”; 结尾;';
> 
> 生产
> 
> 消息 102，级别 15，状态 1，第 2 行“sp_MSforeachdb”附近的语法不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T08:50:15.637

同一批次中的多个存储过程调用，每个都需要 EXEC(UTE)

```
EXEC sp_MSforeachdb @command1 = 'if (left(''?'', 2) = ''p_'') begin; print ''?''; end;';
EXEC sp_MSforeachdb @command1 = 'if (left(''?'', 2) = ''p_'') begin; print ''?''; end;'; 
```

我总是使用 2 x 单引号而不是双引号来避免 QUOTED_IDENTIFERS 环境设置出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T22:30:58.730

当您以这种方式调用多个 proc 时，您需要显式使用 Exec，尝试

```
sp_MSforeachdb @command1 = 'if (left("?", 2) = "p_") begin; print "?"; end;';
exec sp_MSforeachdb @command1 ='if(left("?", 2) = "p_") begin; print "?"; end;'; 
```

[来自Execute](http://msdn.microsoft.com/en-us/library/ms188332.aspx)的文档

> 将 EXECUTE 与存储过程一起使用
> 
> 如果语句是批处理中的第一个语句，则在执行存储过程时不必指定 EXECUTE 关键字。

# c++ - 如何在 ATL 项目中保持全局变量值不变？

> ID：738929
> 
> 赞同：0
> 
> 时间：2009-04-10T21:29:52.370
> 
> 标签：c++, activex, global-variables, atl

我需要有关 ActiveX(ATL) 项目中全局变量使用的帮助。基本上，ActiveX 组件功能是导航到复合控件中的指定 URL（嵌入 Web 浏览器）。URL 字符串在开始时被初始化并保存在全局变量中。这是我的 ActiveX 项目的源代码文件。

（不要关心语法，我只是想展示代码流程）。

```
 MyComponentInit.cpp

    // MyComponentInit.cpp : Implementation of MyComponentInit.cpp

    #include "stdafx.h"
    #include <ios> 

    char szURL[1024] = "\0";   // global variable holding URL string

    STDMETHODIMP CMyComponentInit::InitPlugin(BSTR url)
    {
       // convert BSTR to string
         ...... 

           memcpy(szURL, szUrl, len);
    }

    MyComponentCtrl.cpp 

    // MyComponentCtrl.cpp : Implementation of  MyComponentCtrl.cpp

    #include "stdafx.h"

    extern char  szURL[1024]

    LRESULT CMyComponentCtrl::OnInitDialog(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL& bHandled)
    {
       ......

        m_spWebbrowser->Navigate(szURL, &v, &v, &v, &v);
     } 
```

mycomponent ActiveX 的使用是在 MFC SDI(Single Doc/View) 测试应用程序中。流程是这样的：

1.  在 App Initinstance 中，我调用了 activeX InitPlugin 来初始化 URL 字符串。
2.  在 Information 对话框窗口中，插入 MyComponentCtrl ActiveX，通过单击 Mainframe Information 菜单项弹出 Information 对话框。目标是当信息对话框窗口弹出时，它总是可以转到指定的url。

在我的 MFC 测试应用程序启动后，我单击信息对话框菜单，信息对话框窗口可以打开并正确导航到 url。

但问题是，如果我关闭信息对话框，稍等片刻（大约 2~3 分钟），我试图再次打开信息对话框，它无法导航到 URL。我调试它，发现 MyComponenet 项目中的全局变量 szURL 失去了它的价值。

你能告诉我我应该怎么做才能解决这个问题吗？

提前非常感谢！

仿生编码器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T23:40:01.700

看起来应用程序和 COM 可能会在初始化调用和正在显示的控件之间释放和重新加载您的 DLL。如果主应用程序没有任何 DLL 的 COM 组件的活动实例并随后调用 CoFreeUnusedLibraries()，则可能会发生这种情况。

您可以通过从 DllMain 为 fdwReason == DLL_PROCESS_DETACH 放置断点或跟踪来测试它。如果这是问题所在，断点将在初始化调用之后但在 OnInitDialog() 之前触发。

如果这是问题，您可以通过直接使用 URL 初始化控件实例来解决它，使用实例状态而不是使用全局变量。

您可以在应用程序的生命周期内交替保留对初始化接口的引用。

# c++ - 多个单例实例

> ID：738933
> 
> 赞同：3
> 
> 时间：2009-04-10T21:30:32.683
> 
> 标签：c++, singleton, code-separation

我正在编写一个实用程序类库，其中许多是单例。我已经使用继承实现了它们：

```
template <class T>
class Singleton {
    public:
        T& getInstance() {
            if(m_instance == 0) {
                 m_instance = new T;
            }

            return m_instance;
        }
    private:
        static T* m_instance;
};

class SomeClass : public Singleton<SomeClass> {
    public:
        SomeClass() {}
        virtual ~SomeClass() {}

        void doSomething() {;}
}; 
```

显然这是一个简单的例子，而不是一个实际的类。无论如何，我发现使用以下代码：

```
SomeClass::getInstance().doSomething(); 
```

将创建多个 SomeClass 的实例。我认为这可能是因为它在我的库（.a）文件之外以及在内部使用。例如，我正在使用一个不是我自己编写的 UI 库，它是单独编译的，我正在对其进行添加。其中一些添加使用了我的 .a 库中也使用的单例。

单独编译会导致这种情况吗？还有什么？

我设法解决这个问题的唯一方法是在我的 main.cpp 文件中创建一个全局对象，我用我需要的任何单例初始化它。然后所有代码通过如下调用访问这个通用全局对象：

```
GlobalObject::getSomeClass().doSomething() 
```

我讨厌每次创建另一个单例时都必须向这个对象添加一个额外的方法。另外，使用第一种访问方法，语法似乎更清晰、更熟悉：

```
SomeClass::getInstance().doSomething(); 
```

如果您有任何想法，意见等，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T23:02:58.217

您的问题是您的模板将在多个编译单元中实例化，因为它是完全内联的。因此，在每个使用模板的编译单元中，您最终都会创建一个单例（每个编译单元）。您需要的是强制全局链接，以便所有编译单元引用相同的模板实例化。即将到来的 C++ 标准将通过[extern template](http://en.wikipedia.org/wiki/C++0x#Extern_template)支持这一点。您现在可以做的是在您的项目中禁用自动实例化并手动实例化您明确使用的模板。这样，当您在任何编译单元中使用模板时，您将生成对实现的未知引用，然后链接器可以从您进行显式实例化的（一个）编译单元中满足该引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T21:37:22.137

是否有多个线程同时访问 getInstance？这可能会导致创建多个实例。考虑：

1.  线程1执行“ `if (m_instance==0)`”并发现它是真的
2.  线程2执行“ `if (m_instance==0)`”并发现它是真的
3.  线程 1 分配一个新的 T
4.  线程 2 分配一个新的 T

然后其中一个覆盖另一个，并返回一个实例或另一个（取决于编译器优化等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:43:53.697

您从 Singleton 创建的每个模板类都将有它自己的静态`m_instance`成员......这些不会在不同的类之间共享，因为当模板被实例化时，它实际上会为每组模板参数生成不同的类。从您进行继承的方式来看，这可能意味着您最终会为从它派生的每个类获得一个 Singleton 实例。也许这是您的问题的原因？

# sql-server - 具有自动生成数据的 Sql Server 列

> ID：738935
> 
> 赞同：0
> 
> 时间：2009-04-10T21:31:14.833
> 
> 标签：sql-server, auto-generate

我有一个客户表，我的要求是添加一个新的 varchar 列，该列在每次创建新客户时自动获取一个随机唯一值。

我想写一个随机化字符串的SP，然后检查并重新生成字符串是否已经存在。但是要将 SP 集成到客户记录创建过程中，需要在代码级别使用事务性 SQL 内容，我想避免这种情况。

请帮忙？

编辑：我应该强调，varchar 必须是 5 个字符长，数值在 1000 到 99999 之间，如果数字小于 10000，则在左侧填充 0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T21:33:37.137

如果它必须是 varchar，您可以将 uniqueidentifier 强制转换为 varchar。

得到一个随机的唯一标识符做[NewId()](http://msdn.microsoft.com/en-us/library/ms190348.aspx)

这是你的投射方式：

```
CAST(NewId() as varchar(36)) 
```

### 编辑

根据您对@Brannon 的评论：

你是说你永远不会在表中拥有超过 99k 条记录吗？如果是这样，只需将您的 PK 设置为标识列，使用 1000 为其播种，并在您的业务逻辑中处理“0”左填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T21:34:19.287

随机字符串数据是否需要某种格式？如果不是，为什么不使用唯一标识符？

```
insert into Customer ([Name], [UniqueValue]) values (@Name, NEWID()) 
```

或`NEWID()`用作列的默认值。

**编辑：** 我同意@rm，在您的数据库中使用数值，并在代码中处理转换为字符串（使用填充等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T22:06:20.583

当用户不告诉我他们想要做什么，或者为什么，他们只想告诉我怎么做时，这个问题给了我同样的感觉。

“随机”和“唯一”是相互冲突的要求，除非您创建一个序列列表，然后从中随机选择，删除选择的值。

但这要解决的问题是什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T22:19:18.820

通过您的编辑/更新，听起来您需要的是自动增量和一些填充。

下面是一种使用假表的方法，然后添加一个从 1000 开始的 IDENTITY 列（假设您没有），然后使用计算列为您提供一些填充，以使一切按照您的要求进行.

```
CREATE TABLE Customers (
    CustomerName varchar(20) NOT NULL
)
GO

INSERT INTO Customers 
SELECT 'Bob Thomas' UNION
SELECT 'Dave Winchel' UNION
SELECT 'Nancy Davolio' UNION
SELECT 'Saded Khan'
GO

ALTER TABLE Customers
    ADD CustomerId int IDENTITY(1000,1) NOT NULL
GO 

ALTER TABLE Customers
    ADD SuperId AS right(replicate('0',5)+ CAST(CustomerId as varchar(5)),5) 
GO

SELECT * FROM Customers
GO

DROP TABLE Customers
GO 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-11T07:19:45.013

我认为迈克尔对自动增量的回答应该很好——你的客户会得到“01000”，然后是“01001”，然后是“01002”等等。

If you want to or have to make it more random, in this case, I'd suggest you create a table that contains all possible values, from "01000" through "99999". When you insert a new customer, use a technique (e.g. randomization) to pick one of the existing rows from that table (your pool of still available customer ID's), and use it, and remove it from the table.

Anything else will become really bad over time. Imagine you've used up 90% or 95% of your available customer ID's - trying to randomly find one of the few remaining possibility could lead to an almost endless retry of "is this one taken? Yes -> try a next one".

Marc

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T21:41:00.037

试试这个：

```
ALTER TABLE Customer ADD AVarcharColumn varchar(50) 
CONSTRAINT DF_Customer_AVarcharColumn DEFAULT CONVERT(varchar(50), GETDATE(), 109) 
```

它返回一个最多毫秒的日期和时间，这在大多数情况下就足够了。

你**真的**需要一个独特的价值吗？

# c++ - 如何在 C++ 中搜索维基百科并获取输入或信息？

> ID：738941
> 
> 赞同：-1
> 
> 时间：2009-04-10T21:33:42.597
> 
> 标签：c++

我希望我的程序搜索维基百科并获取它搜索的信息并将其放入一个大字符串中并输出到一个文件中。我怎样才能在 C++ 中做到这一点？请问有什么资料吗？请需要更多的回答者

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T21:45:25.687

将[wget](http://en.wikipedia.org/wiki/Wget)与查询 URL 一起使用

```
wget --output-document=result.html http://en.wikipedia.org/wiki/Special:Search?search=jon+skeet&go=Go 
```

这将搜索**jon skeet**并将结果存储在**result.html**

要从 C++ 中使用它，您可以例如使用 system() 调用在单独的进程中执行 wget。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T22:06:32.970

[libcURL](http://curl.haxx.se/)非常流行。我不知道该接口是特别面向对象的，但它肯定可以从 C++ 中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T21:58:43.567

MediaWiki（支持 Wikipedia 的 wiki 引擎）有许多客户端 API。[这](http://www.mediawiki.org/wiki/API:Client_Code)是一个清单。它们提供创建/删除/编辑/搜索文章的能力。纯 C++ 中没有任何内容，但它仍然可能有用。

[DotNetWikiBot](http://dotnetwikibot.sourceforge.net/)在我的一个项目中非常有用......

# vb.net - Irda + vb.net 快递

> ID：738945
> 
> 赞同：2
> 
> 时间：2009-04-10T21:34:51.547
> 
> 标签：vb.net, sockets

不确定这是一个有效的编程问题...但是是否可以使用 vb.net express (iRDA) 编程 infa red

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T21:39:51.787

这是一个有效的问题，但需要更具体一些。VB.Net 当然可以用于针对 IRDA 进行编程。没有什么可以阻止您将 IrDAClient 与 VB.Net 一起使用。

我们确实需要知道您遇到了什么问题？您能否发布给您带来麻烦的示例或告诉我们您看到了什么错误？

**编辑**评论更新

没有什么可以阻止您从 VB Express 编写针对 IRDA 的程序。您似乎缺少的是对包含 IrDA 库的 DLL 的引用。您需要添加对 System.Net.Irda.dll 的引用。它将位于以下目录中（假设您对 Windows CE 进行编程）

> C:\Program Files\Microsoft.NET\SDK\CompactFramework\v2.0\WindowsCE

**编辑2**

我对 VB express 对设备项目进行编程的能力可能是错误的。我的机器上现在没有任何 2008 express 版本需要验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T21:51:11.180

IrDAClient 类是 .Net Compact 框架的一部分。我不确定是否可以在台式机上使用它。

您至少可以通过搜索文件 System.Net.IrDA.dll 添加引用。在我的系统上，它位于：Program Files\Microsoft Visual Studio .NET 2003\CompactFrameworkSDK\v1.0.5000\Windows CE

如果它不存在，您可以在这里下载它：http: [//msdn.microsoft.com/en-us/netframework/aa497280.aspx](http://msdn.microsoft.com/en-us/netframework/aa497280.aspx)

# c# - 我们如何在 StringBuilder 中添加字符串？

> ID：738950
> 
> 赞同：136
> 
> 时间：2009-04-10T21:36:57.660
> 
> 标签：c#, java, stringbuilder

我知道我们可以使用`StringBuilder`. 有没有一种方法可以预先添加字符串（即在字符串前面添加字符串），`StringBuilder`这样我们就可以保持`StringBuilder`提供的性能优势？

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2009-04-10T21:39:16.843

使用位置参数设置为 0 的插入方法与前置（即在开头插入）相同。

C# 示例：`varStringBuilder.Insert(0, "someThing");`

Java 示例：`varStringBuilder.insert(0, "someThing");`

它适用于[C#](http://msdn.microsoft.com/en-us/library/0xzfkkwa.aspx)和[Java](https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html#insert-int-java.lang.CharSequence-)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-10T21:41:13.030

前置字符串通常需要将插入点之后的所有内容复制回支持数组中的某个位置，因此它不会像追加到末尾那样快。

但是你可以在 Java 中这样做（在 C# 中是一样的，但是方法被调用`Insert`）：

```
aStringBuilder.insert(0, "newText"); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-10T22:10:34.537

如果您需要具有大量前置功能的高性能，则需要编写自己的版本`StringBuilder`（或使用其他人的版本）。使用标准`StringBuilder`（尽管从技术上讲，它可以以不同的方式实现）插入需要在插入点之后复制数据。插入 n 段文本可能需要 O(n^2) 时间。

一种天真的方法是在后备`char[]`缓冲区中添加偏移量以及长度。当没有足够的空间进行前置时，将数据向上移动超过绝对必要的量。这可以将性能降低到 O(n log n) （我认为）。一种更精细的方法是使缓冲区循环。这样，阵列两端的空闲空间就变得连续。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-10T21:39:51.693

如果您想使用 Java 的 StringBuilder 类预先设置，您可以执行以下操作：

```
StringBuilder str = new StringBuilder();
str.Insert(0, "text"); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-10T21:57:08.030

您可以尝试扩展方法：

```
/// <summary>
/// kind of a dopey little one-off for StringBuffer, but 
/// an example where you can get crazy with extension methods
/// </summary>
public static void Prepend(this StringBuilder sb, string s)
{
    sb.Insert(0, s);
}

StringBuilder sb = new StringBuilder("World!");
sb.Prepend("Hello "); // Hello World! 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-13T16:11:16.480

您可以反向构建字符串，然后反转结果。您会产生 O(n) 成本，而不是 O(n^2) 最坏情况成本。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-10T21:41:47.227

如果我理解正确，[插入方法](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/StringBuilder.html#insert(int,%20java.lang.String))看起来会做你想做的事。只需在偏移量 0 处插入字符串。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-12T00:04:14.847

我没有用过它，但[Ropes For Java](http://ahmadsoft.org/ropes/)听起来很有趣。项目名称是文字游戏，认真工作时使用*绳索*而不是*字符串*。绕过前置操作和其他操作的性能损失。值得一看，如果你要做很多这样的事情。

> 绳索是弦乐的高性能替代品。在“Ropes: an Alternative to Strings”中详细描述的数据结构，对于常见的字符串修改（如 prepend、append、delete 和 insert）提供了比 String 和 StringBuffer 更好的性能。与字符串一样，绳索是不可变的，因此非常适合用于多线程编程。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-10T21:40:05.217

尝试使用[插入（）](http://msdn.microsoft.com/en-us/library/0xzfkkwa.aspx)

```
StringBuilder MyStringBuilder = new StringBuilder("World!");
MyStringBuilder.Insert(0,"Hello "); // Hello World! 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-08-17T02:34:46.513

从其他评论来看，没有标准的快速方法可以做到这一点。使用 StringBuilder 的`.Insert(0, "text")`速度大约只有使用非常慢的字符串连接（基于 >10000 个连接）的 1-3 倍，所以下面是一个类，它的前置速度可能会快数千倍！

我已经包含了一些其他基本功能，例如`append()`,`subString()`等等`length()`。追加和前置的速度从 StringBuilder 追加的两倍到慢三倍不等。与 StringBuilder 一样，当文本溢出旧的缓冲区大小时，此类中的缓冲区会自动增加。

该代码已经过大量测试，但我不能保证它没有错误。

```
class Prepender
{
    private char[] c;
    private int growMultiplier;
    public int bufferSize;      // Make public for bug testing
    public int left;            // Make public for bug testing
    public int right;           // Make public for bug testing
    public Prepender(int initialBuffer = 1000, int growMultiplier = 10)
    {
        c = new char[initialBuffer];
        //for (int n = 0; n < initialBuffer; n++) cc[n] = '.';  // For debugging purposes (used fixed width font for testing)
        left = initialBuffer / 2;
        right = initialBuffer / 2;
        bufferSize = initialBuffer;
        this.growMultiplier = growMultiplier;
    }
    public void clear()
    {
        left = bufferSize / 2;
        right = bufferSize / 2;
    }
    public int length()
    {
        return right - left;
    }

    private void increaseBuffer()
    {
        int nudge = -bufferSize / 2;
        bufferSize *= growMultiplier;
        nudge += bufferSize / 2;
        char[] tmp = new char[bufferSize];
        for (int n = left; n < right; n++) tmp[n + nudge] = c[n];
        left += nudge;
        right += nudge;
        c = new char[bufferSize];
        //for (int n = 0; n < buffer; n++) cc[n]='.';   // For debugging purposes (used fixed width font for testing)
        for (int n = left; n < right; n++) c[n] = tmp[n];
    }

    public void append(string s)
    {
        // If necessary, increase buffer size by growMultiplier
        while (right + s.Length > bufferSize) increaseBuffer();

        // Append user input to buffer
        int len = s.Length;
        for (int n = 0; n < len; n++)
        {
            c[right] = s[n];
            right++;
        }
    }
    public void prepend(string s)
    {
        // If necessary, increase buffer size by growMultiplier
        while (left - s.Length < 0) increaseBuffer();               

        // Prepend user input to buffer
        int len = s.Length - 1;
        for (int n = len; n > -1; n--)
        {
            left--;
            c[left] = s[n];
        }
    }
    public void truncate(int start, int finish)
    {
        if (start < 0) throw new Exception("Truncation error: Start < 0");
        if (left + finish > right) throw new Exception("Truncation error: Finish > string length");
        if (finish < start) throw new Exception("Truncation error: Finish < start");

        //MessageBox.Show(left + " " + right);

        right = left + finish;
        left = left + start;
    }
    public string subString(int start, int finish)
    {
        if (start < 0) throw new Exception("Substring error: Start < 0");
        if (left + finish > right) throw new Exception("Substring error: Finish > string length");
        if (finish < start) throw new Exception("Substring error: Finish < start");
        return toString(start,finish);
    }

    public override string ToString()
    {
        return new string(c, left, right - left);
        //return new string(cc, 0, buffer);     // For debugging purposes (used fixed width font for testing)
    }
    private string toString(int start, int finish)
    {
        return new string(c, left+start, finish-start );
        //return new string(cc, 0, buffer);     // For debugging purposes (used fixed width font for testing)
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-06-21T19:04:08.273

您可以使用一个简单的类自己为 StringBuilder 创建一个扩展：

```
namespace Application.Code.Helpers
{
    public static class StringBuilderExtensions
    {
        #region Methods

        public static void Prepend(this StringBuilder sb, string value)
        {
            sb.Insert(0, value);
        }

        public static void PrependLine(this StringBuilder sb, string value)
        {
            sb.Insert(0, value + Environment.NewLine);
        }

        #endregion
    }
} 
```

然后，只需添加：

```
using Application.Code.Helpers; 
```

在您想在其中使用 StringBuilder 的任何类的顶部，以及任何时候将智能感知与 StringBuilder 变量一起使用时，都会显示 Prepend 和 PrependLine 方法。请记住，当您使用 Prepend 时，您需要以与 Appending 相反的顺序进行 Prepend。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-08-17T15:52:22.713

这应该有效：

```
aStringBuilder = "newText" + aStringBuilder; 
```

# c++ - const float & x = 某物；// 被认为是有害的？

> ID：738952
> 
> 赞同：4
> 
> 时间：2009-04-10T21:37:40.497
> 
> 标签：c++, reference

有一些这样的代码：

```
// Convenience to make things more legible in the following code
const float & x = some.buried.variable.elsewhere;

// Go on to use x in calculations... 
```

我被告知“const float &”是“坏的”，应该只是一个普通的 float 或 const float。

然而，除了“你不必输入'&'”之外，我想不出一个令人信服的理由。

事实上，在我看来，在某些情况下，原来的可能会更好，因为编译器可能不会为变量分配额外的堆栈空间。

换句话说，最初我可以有效地说：

```
assert(&x == &some.buried.variable.elsewhere) 
```

而在第二种情况下，我不能。

此外，在我看来，原件似乎更好地传达了意图，因为引用的全部目的是为另一个值创建别名。

谁能给我举个例子，说明“const float &”版本在什么地方比普通的“float”或“const float”更糟糕？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T21:42:54.383

我想不出`const float &`比 更好的理由`const float`。

如果您担心制作副本（这与原始类型无关，`float`例如`const`

最重要的是，在初始化时，成员中的引用是一个巨大的痛苦*，因此它们必须提供替代方案的显着优势才能有用，而 . 显然不是这种情况`const float`。

* * *

`*`参考文献的[FQA](http://yosefk.com/c++fqa/ref.html#fqa-8.6)总是很有趣和发人深省

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T22:08:36.913

你应该只在以下情况下使用引用：（如果我没有忘记的话）

1.  被引用的类型并不小，并且会导致性能问题。
2.  您希望在更新所引用的值时更新本地别名。
    或者：您不想复制。
3.  您希望能够更新其他值。（如果不是恒定的）

因此，在这种情况下，浮点数足够小，您可能不希望它在引用的值更新时更新（导致计算出现问题），并且由于您使用的是常量，因此您不希望它更新。

所以，你会想要：

```
const float x = some.buried.variable.elsewhere; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T21:44:54.503

a 的地址`float`可能比它`float`本身大（例如，在 64 位 PC 上）。此外，使用 a直接
计算某些东西比使用 a 的地址更快（您不必取消引用它），但也许编译器可以优化它。`float``float`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T22:25:25.950

没有理由说明该引用是错误的或不好的。如果您想要的是本地快捷名称（“别名”），则参考是要走*的路。*如果您将浮点数复制到一个新变量中，那么您将获得一个新对象，正如您所指出的，您当然还会获得一个新地址：这根本不是您想要的。因此，请参考：

```
float &x = some.buried.variable.elsewhere; 
```

它将表现为表达式中的原始变量。

但是，与所有事情一样，硬编码规则不会这样做。这取决于具体情况。如果您不关心*对象*，而关心对象的*值*，则创建一个副本。当您感兴趣的只是轻松访问某物 的*值*时，最好直接使用浮点数而不是通过引用进行可能的间接访问。

不好的是在存储计算结果时使用引用——因为显然感兴趣的只是值。无论如何，您对临时浮动标识没有任何兴趣，因为它首先不存在：临时浮动不是对象。甚至不需要任何地址（如果编译器将浮点数保存在寄存器中，就会发生这种情况）：

```
float const &x = 3.0; // non-sense. don't use reference here 
```

当然与函数调用的结果相同

```
float const &x = get_some_float(); // non-sense too. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T22:35:03.417

您不需要太担心堆栈的使用，尤其是对于单个浮点数。

如果您在堆栈上声明一个变量，则没有任何内容表明编译器必须为它实际创建空间，除非您获取它的地址。即使这样，如果编译器可以显示变量的地址没有被使用，或者如果编译器可以看到该地址的所有使用（如果传递该地址的函数调用都是可见的），那么它仍然没有实际为变量创造空间。

我可以看到使用引用而不是副本的一种情况是，如果通过另一个名称更改值，也许在函数调用中，那么引用值也会改变。有了副本就不行了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T22:35:14.727

您提到您认为编译器可能会避免为引用分配堆栈空间。如果您启用了优化，这可能是正确的，但编译器也可以`const float x`通过将值保存在 FP 寄存器而不是堆栈中来优化“”。例如，这就是 GCC 在 x86 上所做的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T22:45:44.123

简短的回答：这段代码是正确的，保持这种方式！

长答案：

将函数的返回值存储在引用中的问题在于，您没有分配空间来实际存储返回值，因此您通常会得到一个指向临时值的引用，或者函数的临时返回值（由编译器自动创建）或在函数期间分配的局部变量（并在其结束时释放）。

确实不能返回对局部变量的引用，因为该变量将在函数结束时被释放。

但是 C++ 标准规定，如果函数被“const 引用”，则编译器不得释放函数的临时返回值。因此，如果您的函数按值返回浮点数，您可以将此值存储在浮点引用中，编译器会确保函数返回的实际临时值在您完成引用之前不会被释放。

请注意，此行为仅对“const”引用有效。

查看[Herb Sutter 的这篇文章](http://herbsutter.wordpress.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)以获得更多解释。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-10T23:41:49.107

为清晰起见重写：

引用是伪装成添加了一些语法糖的指针。指针有许多性能和效率问题。别名是一个值得注意的例子。编译器不能保证指针或引用下面的内存与上次读取时相同，因为任何旧指针都可以通过并修改它。编译器被迫在每次使用时从内存中重新读取值，而不是将其缓存在内存中。

在大多数处理器上，寄存器很快，内存访问却不是。因此，如果我们可以避免它，我们永远不想访问内存。原始类型（int、float 等）通常进入寄存器。编译器可以完全控制每个寄存器中驻留的数据，并且可以保证不会覆盖该值，因此原始类型的变量可能会在寄存器中保留很长时间，直到编译器需要将任何更改写回内存。

因此，在处理原始类型时，使用引用通常效率较低。它不允许编译器将值缓存在寄存器中，插入隐藏的取消引用，并且可能会使您面临由别名引起的性能问题。

在这种情况下，也许效率对您来说并不重要，但您说除了节省打字之外，您想不出不使用引用的充分理由。我提出有一个很好的理由。

在我看来，考虑到这一点的最佳实践是主要将引用用于聚合类型。编译器不能在单个寄存器中传递这些，因此使用引用的相对成本将大大降低。如果所讨论的类型是原始类型，我总是更喜欢使用值的副本而不是引用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T21:42:09.673

每当您处理推荐人时，您都是在冒险，这可能就是为什么您被告知要避免这种情况的原因。

目前尚不清楚“隐藏变量”是什么意思。如果您指的是对象的成员（甚至可以通过序列访问），则存在更大的风险，因为该对象可能会被删除，从而为您留下无效的引用。由于您不能稍后将引用指向其他内容，因此您无法表明它是无效的，因此指针可能会更好。

const 没有问题。

您能解释一下您正在尝试做什么或提供更多背景信息吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-10T22:50:13.597

需要记住的一点：对 const 的引用并不一定意味着您所引用的东西在某些时候不会改变。这只是意味着您不会通过该引用更改引用的数据。

因此，理论上有人可以更改 x 的值，`some.buried.variable.elsewhere`然后读取 x 将反映更新后的值。（受制于通常的别名规则等。本质上，它将在下次读取 x 的值时更新。）

（如果我有任何错误，请随时发表评论，在这里，我会更新或删除答案。）

# iphone - iPhone emoji 应用程序是如何制作的？

> ID：738954
> 
> 赞同：9
> 
> 时间：2009-04-10T21:37:59.637
> 
> 标签：iphone

有谁知道它是怎么做的？

他们似乎启用了日语设置.. 但是如何？

由于应用商店中对表情符号应用程序的所有愤怒，无法搜索它。

非常感谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-11T05:38:09.903

语言设置存储在`/User/Library/Preferences/com.apple.Preferences.plist`用户分区上，并且不会从第三方应用程序中分离出来。随处启用表情符号很简单，只需将`KeyboardEmojiEverywhere`密钥添加到此文件并为其赋予`true`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T22:19:29.757

与应用程序专门启用它相比，用户更倾向于破解手机以启用日文字符。

我忘记了如何，但它确实涉及几个步骤。

# ruby-on-rails - 如何在 Rails 中自动对 has_many 关系进行排序？

> ID：738971
> 
> 赞同：105
> 
> 时间：2009-04-10T21:42:47.503
> 
> 标签：ruby-on-rails

这似乎是一个非常简单的问题，但我还没有看到它在任何地方得到回答。

在 Rails 中，如果您有：

```
class Article < ActiveRecord::Base 
  has_many :comments 
end 
class Comments < ActiveRecord::Base 
  belongs_to :article 
end 
```

为什么你不能用这样的东西来订购评论：

```
@article.comments(:order=>"created_at DESC") 
```

如果您需要大量引用命名范围，甚至人们会做这样的事情，命名范围就可以工作：

```
@article.comments.sort { |x,y| x.created_at <=> y.created_at } 
```

但有件事告诉我它应该更简单。我错过了什么？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-04-10T21:54:48.303

`has_many`您可以使用本身的选项指定裸集合的排序顺序：

```
class Article < ActiveRecord::Base 
  has_many :comments, :order => 'created_at DESC'
end 
class Comment < ActiveRecord::Base 
  belongs_to :article 
end 
```

或者，如果您想要一种简单的、非数据库的排序方法，请使用[sort_by](http://www.ruby-doc.org/core/classes/Enumerable.html#M003151)：

```
article.comments.sort_by &:created_at 
```

使用添加了 ActiveRecord 的排序方法收集此内容：

```
article.comments.find(:all, :order => 'created_at DESC')
article.comments.all(:order => 'created_at DESC') 
```

您的里程可能会有所不同：上述解决方案的性能特征将根据您首先获取数据的方式以及您正在使用哪个 Ruby 运行您的应用程序而发生巨大变化。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2016-03-04T07:01:39.893

从 Rails 4 开始，你会这样做：

```
class Article < ActiveRecord::Base 
  has_many :comments, -> { order(created_at: :desc) }
end 
class Comment < ActiveRecord::Base 
  belongs_to :article 
end 
```

对于`has_many :through`关系，参数顺序很重要（必须是第二个）：

```
class Article
  has_many :comments, -> { order('postables.sort' :desc) }, 
           :through => :postable
end 
```

如果无论上下文如何，您总是希望以相同的顺序访问评论，您也可以通过以下方式执行此`default_scope`操作`Comment`：

```
class Comment < ActiveRecord::Base 
  belongs_to :article 
  default_scope { order(created_at: :desc) }
end 
```

然而，由于这个问题中[讨论的原因，这可能是有问题](https://stackoverflow.com/questions/25087336/why-is-using-the-rails-default-scope-often-recommend-against)的。

在 Rails 4 之前，您可以`order`将关系指定为键，例如：

```
class Article < ActiveRecord::Base 
  has_many :comments, :order => 'created_at DESC'
end 
```

正如 Jim 提到的，您也可以`sort_by`在获取结果后使用，尽管在任何大小的结果集中，这将比通过 SQL/ActiveRecord 进行排序要慢得多（并且使用更多的内存）。

如果您正在做的事情由于某种原因添加默认顺序很麻烦，或者您想在某些情况下覆盖您的默认值，那么在获取操作本身中指定它是微不足道的：

```
sorted = article.comments.order('created_at').all 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-11T03:51:32.110

如果您使用的是 Rails 2.3 并希望对该对象的所有集合使用相同的默认排序，则可以使用 default_scope 对集合进行排序。

```
class Student < ActiveRecord::Base
  belongs_to :class

  default_scope :order => 'name'

end 
```

然后如果你打电话

```
@students = @class.students 
```

它们将根据您的 default_scope 进行排序。TBH 在一般意义上的排序是默认范围的唯一真正好的用途。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-10T21:53:00.867

您可以使用 ActiveRecord 的 find 方法来获取您的对象并对其进行排序。

```
 @article.comments.find(:all, :order => "created_at DESC") 
```

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-18T10:01:53.437

如果你需要传递一些额外的参数，比如`dependent: :destroy`或其他什么，你应该在 lambda 之后附加这些参数，如下所示：

```
class Article < ActiveRecord::Base 
  has_many :comments, -> { order(created_at: :desc) }, dependent: :destroy
end 
```

# msmq - MSMQ 毒物消息处理

> ID：738992
> 
> 赞同：4
> 
> 时间：2009-04-10T21:54:34.480
> 
> 标签：msmq

不使用 WCF 时如何处理有害消息？下面的代码创建了一个循环，我很好奇 MSMQ 是否提供了一个系统来自动处理毒消息。

```
MessageQueue mq = new MessageQueue(@".\Private$\My/Queue");

while (true)
{
    using (MessageQueueTransaction _transaction = 
            new MessageQueueTransaction())
    {
        _transaction.Begin();

        try
        {
            Message msg = mq.Receive(_transaction);

            //HandleMessage(msg);
            throw new Exception("Kaboom!");            

            _transaction.Commit();
        }
        catch (Exception ex)
        {
            _transaction.Abort();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T22:19:40.037

我不相信有一种简单的方法可以使用原始 System.Messaging 类来处理有害消息。我认为最简单的解决方案是在消息上设置“TimeToBeReceived”属性，但这并不完美，因为如果接收者离线，您最终可能会丢失有效消息。我在某处读到，您可以使用 PInvoke 在 MSMQ 中处理真正的有毒消息，但无法找到任何相关资源。

我发现这篇文章有一些关于如何手动处理毒消息的想法。它可能会提供一些想法：

[http://www.cogin.com/articles/Sur​​vivingPoisonMessages.php](http://www.cogin.com/articles/SurvivingPoisonMessages.php)

# c# - C#：Webservice 更改预期的参数类型（从普通 POCO 到自动生成的类）

> ID：738994
> 
> 赞同：2
> 
> 时间：2009-04-10T21:55:46.177
> 
> 标签：c#, web-services, poco, auto-generate

我在类库中有以下类：`Artist`，这是一个 POCO

现在我在 Web 服务中有一个方法（它引用了上述库），其签名如下：

```
[WebMethod]
public int Artist_AddArtist(Artist a) {
 //
} 
```

当我尝试从应用程序（也有对上述类库的引用）使用此服务时，该`Artist_AddArtist`方法的预期参数不是，而是正在生成的`Artist`一种新类型，其中是一个部分类是自动生成的。`Artist``Reference.cs`

因此，由于在我的应用程序中我使用`Artist`了库中的同一个类，而现在 Web 服务方法需要这种新的自动生成类型，因此我无法将它的实例传递给 Web 服务。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T22:06:49.303

也许切换到 WCF 服务是您的一个选择。据我记得，使用 WCF 服务，您可以在服务器端和客户端重用相同的类型。

[本文](http://msdn.microsoft.com/en-us/library/ms730214.aspx)介绍如何将 ASMX Web 服务迁移到 WCF 服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T22:03:36.690

您不能也不应该解决问题。

其他一些人会告诉您编辑生成的文件之类的操作，但这不是一个好的做法（因为一旦 Web 参考更新，更改就会消失）。

您所看到的是设计使然。请参阅[基础知识：Web 服务如何工作](http://johnwsaundersiii.spaces.live.com/blog/cns!600A2BE4A82EA0A6!523.entry)。

简而言之，当您使用“添加 Web 引用”时，Visual Studio 会从服务中下载 WSDL 文件，并使用 WSDL 中的 XML Schemas 创建一些代理类来表示模式描述的 XML。它还为服务本身创建一个代理类，为服务中的每个操作提供方法。

代理数据类可以序列化为服务期望接收的 XML，并且可以从服务器作为回复发送的 XML 反序列化回。

一种思考方式是您只有这个问题，因为客户端和服务都是.NET。如果您的客户端是用 Java 编写的，那么您就不会考虑共享类。

* * *

请注意，如有必要，WCF 可以执行此操作。它在客户端和服务之间引入了依赖关系（它们都必须使用包含类的程序集的兼容版本），但是当您需要这样做时，可以选择。当这些类中存在必须由客户端和服务使用的行为时，它很有用。

# sharepoint - 临时 Internet 文件（通过 IE 从 SharePoint 读取）。如何找到网址？

> ID：738996
> 
> 赞同：1
> 
> 时间：2009-04-10T21:56:54.240
> 
> 标签：sharepoint, internet-explorer, ole

当 IE 用户单击驻留在 SharePoint 中的文件的链接（并且用户选择“只读”访问权限）时，该文件被复制到 Internet 临时文件，我的应用程序被打开并将该文件名作为参数传递。我正在尝试在我的应用程序中实现“签出”按钮，以便用户可以从只读模式切换到签出和编辑模式。我无法找到一种方法来了解文件的 SharePoint URL。在签出和编辑时，没问题：有一个注册表项将我系统上的文件映射到 SharePoint 中的 URL；对于只读文件，我还没有找到类似的东西。

编辑：Windows 资源管理器中有一个可用的 URL 列，但是当我显示该列（在资源管理器中）时，所有值都是空白的。此外，我找不到任何会为我返回此值的文件信息 api 调用。

更新：我在 wininet.lib 中发现了一些有希望的调用：FindFirstUrlCacheEntryEx（和“下一个”）以及 FindFirstUrlCacheGroup（和下一个）。他们似乎没有返回任何数据，从我读到的，这些只返回*我*的应用程序对 wininet api 调用缓存的使用——而不是 IE。

我还尝试在打开文件时运行 IE 对我的应用程序进行的 COM 调用列表，以查看如果我支持它所看到的接口。一个看起来很有希望的是 IMonikerProp 接口，当我实现它时，它确实被调用了……但是它只为我提供了 mime 类型属性、我的应用程序的 classid 和 TrustedDownload 标志。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T16:20:47.433

也许这个网站有答案：[SharePoint 如何通过 ActiveX 与 Word 通信](http://www.wssdemo.com/Blog/archive/2008/05/10/sharepoint-document-libraries-and-users.aspx)

另一种选择可能是挂钩到 SharePoint ItemCheckingOut 事件。[示例 1](http://www.sharepointblogs.com/roni/archive/2007/09/06/canceling-check-out-event-in-lists-and-document-libraries-returns-an-error-message.aspx) [示例 2](http://msdn.microsoft.com/en-us/library/cc664707.aspx)。如果您可以获取 URL 信息并使用该信息创建一些临时文件或将信息传递给您的程序。

[链接到 ActiveX 控件信息](http://www.eggheadcafe.com/conversation.aspx?messageid=28381567&threadid=28381601)- 也许这个控件是在所有东西上启动的？你也许可以利用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T17:40:22.990

创建的临时文件是否有一个好名字（它是否与文件的实际名称匹配或者是乱码）。如果它是一个好名字，你可能可以搜索它。否则，在不知道站点、文件夹、文件名的情况下，您可能无法知道，除非某处有一些关于该文件的附加数据。

# email - 如何在从我的 .forward 文件运行的脚本中获取电子邮件？

> ID：738998
> 
> 赞同：1
> 
> 时间：2009-04-10T21:57:11.493
> 
> 标签：email, postfix-mta

我正在编写一个脚本来处理自动电子邮件收件箱。我以前从未真正处理过邮件服务器，但已经到了这样的地步，即发送的每封电子邮件都在执行我的脚本。我在收件人用户的主目录中使用 .forward 文件，如下所示：

```
"|exec /home/[MY USER]/magic || exit 75 #[MY USER]" 
```

该脚本只是将其输入并在此时将其写入文件。问题是，我不知道如何找到正在发送的电子邮件，而且我似乎找不到任何关于 .forward 文件如何详细工作的文档。我如何访问电子邮件？

任何帮助都非常受欢迎:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T22:53:32.203

[这里](http://www.softpanorama.org/Mail/pipes_in_dot_forward_file.shtml)描述了一些关于*~/.forward*文件和与邮件服务器交互的一般信息，[过滤邮件常见问题解答](http://www.faqs.org/faqs/mail/filtering-faq/)也包含一些信息。

虽然仅使用点转发文件可能就足够了，但您通常希望使用[procmail](ftp://ftp.informatik.rwth-aachen.de/pub/packages/procmail/index.html)来进行更强大的邮件处理。

# asp.net-mvc - ASP.net MVC RTM - “不支持项目类型”

> ID：738999
> 
> 赞同：7
> 
> 时间：2009-04-10T21:58:05.503
> 
> 标签：asp.net-mvc, visual-studio

安装 ASP.net MVC 后，当我尝试加载现有或新的 MVC 应用程序（直接来自新项目 - 使用 ASP.NET MVC 框架 (1.0) (.NET Framework 3.5) 创建应用程序的项目）时，我得到以下错误：

* * *

## 微软视觉工作室

无法打开项目文件“路径”。

## 此安装不支持项目类型。

## 确定 帮助

尝试重新安装，但没有帮助。试过 devenv /setup 也没有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T13:49:39.527

原因是我没有安装 VS 的 Visual Web Development 部分。我只有 C# 语言。因此，MVC 没有检查并成功安装，但无法使用底层部分。

安装 Web Dev 位后，一切都按预期工作......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T07:41:31.633

您也可以尝试运行以下命令：

```
devenv /ResetSkipPkgs 
```

这将尝试加载之前在某个时间点失败的任何 Visual Studio 包，例如 WPF 项目风味包，这将导致您看到的错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T22:25:41.253

不确定这是否是同一个问题，但要卸载并重新安装 beta 和 RC 版本，最后是 RTW，我最终在“文件/新建/项目”对话框中看到了两个 ASP.NET MVC Web 应用程序图标。

如果我单击第一个链接，我的项目将无法正确加载。但是，如果我单击第二个，一切都很好。

我还没有深入到模板文件夹中查看是否有以前版本的残留物或什么。

布赖恩

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T18:16:01.050

您是否为 .Net 和 VS2008 安装了 SP1？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-10T19:45:44.140

当我使用 VS 2008 时，我纠正这个无法为自己打开 ASP.NET MVC 1.0 的问题的方式是这样的

*   为 VS 2008 安装 SP1
*   安装 MVC 2.0 框架
*   我意识到我有一个 MVC 1.0 项目，我使用这个[工具](http://weblogs.asp.net/leftslipper/archive/2009/10/19/migrating-asp-net-mvc-1-0-applications-to-asp-net-mvc-2.aspx)将项目更改为 MVC 2.0。

该工具效果很好，Eilon Lipton 的道具从未见过这个人，但我对任何能让我的生活更轻松的人感到失望。

[http://weblogs.asp.net/leftslipper/archive/2009/10/19/migrating-asp-net-mvc-1-0-applications-to-asp-net-mvc-2.aspx](http://weblogs.asp.net/leftslipper/archive/2009/10/19/migrating-asp-net-mvc-1-0-applications-to-asp-net-mvc-2.aspx)*************