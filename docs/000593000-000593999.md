# StackOverflow 问答 000593000-000593999

# .net - @“数据源=（本地）\SIRSYSTEM\嘿；” – 如果字符串包含 SIRSYSTEM，则无法连接

> ID：593010
> 
> 赞同：0
> 
> 时间：2009-02-26T23:48:16.547
> 
> 标签：.net, asp.net, sql-server

我的 MS Sql server 实例的名称是 HEY，但是当尝试通过 Microsoft Sql management studio 登录 Sql server 时，登录窗口显示为服务器名称“SIRSYSTEM\HEY”。

什么是 SIRSYSTEM？默认服务器实例的名称？如果是这样，那么为什么我不能使用以下连接字符串（在 Ado.net 中）连接到 HEY：

@"数据源=(本地)\SIRSYSTEM\HEY；初始目录=FilmClub；"+"集成安全=true"；

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T23:53:08.097

SIRSYSTEM 是托管实例的服务器或工作站名称；要连接到它，数据源将是 .\HEY 或 SIRSYSTEM\HEY，去掉（本地）\

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T23:52:28.940

SIRSYSTEM 不是系统名称，但可能是您或某人在某些时候键入的默认名称，或者它是服务器本身的名称？

Data Source=(local)\SIRSYSTEM\HEY 根本无效。试试（本地）\嘿。

您可能必须取消注册，然后在 Management Studio 中重新注册服务器实例才能更改此设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T23:52:50.327

您需要做的就是使用“嘿”，SIRSYSTEM 是计算机的名称。

或者：`localhost\HEY`

# nhibernate - 是否可以使用 NHibernate 在属性上设置默认值

> ID：593012
> 
> 赞同：1
> 
> 时间：2009-02-26T23:48:50.713
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我使用 Fluent NHibernate 进行映射，并将 SchemaExport 类用于数据库模式。

NHibernate 是否可以在生成的数据库模式中为属性/列设置默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T00:07:27.063

据我所知，不 - 不在生成的模式中。

不过，您可以在构造函数中设置属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-21T15:17:22.693

在 XML 映射和 Fluent NHibernate 中都绝对支持它。

*   对于 XML 映射，请使用此处[记录](https://nhibernate.info/doc/nhibernate-reference/mapping.html#mapping-column)`<column>`的 的子元素。`<property>`
*   对于 Fluent NHibernate，有一种用于流畅映射的方法，[如此 SO answer 中所述](https://stackoverflow.com/a/1568843/639520)。

# c# - 如何在 asp.net mvc 中制作结构图驱动的视图引擎

> ID：593025
> 
> 赞同：0
> 
> 时间：2009-02-26T23:53:15.973
> 
> 标签：c#, model-view-controller, structuremap, viewengine

我的视图扩展了我制作的基本视图类：

```
public class BaseView : ViewPage 
```

目前我在这个类的构造函数中调用 ObjectFactory.GetInstance 来获取一些接口实现，但我喜欢使用结构映射将它们作为构造函数参数注入。

我使用结构映射控制器工厂来创建我的控制器，但我怎样才能为视图做同样的事情？

我知道我可以实现自定义 ViewEngine，但是使用反射器查看 mvc 默认视图引擎及其依赖项，它似乎一直在继续，我宁愿不必重新实现已经存在的东西。有没有人有一个狡猾的想法如何解决这个问题？

我知道我可以使用 setter 而不是构造函数注入使事情变得更容易，但如果可能的话，我宁愿避免这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-30T14:56:42.477

是的，如果您谈论的是 WebForms ViewEngine，那么您的评估是正确的，即它的设计并未考虑到控制反转。您可以游说 Microsoft 更改它，也可以使用 setter 注入。在 FubuMVC 中，我们使用 setter 注入和 StructureMap 的 BuildUp 方法：

*   [WebFormsControlBuilder](http://github.com/DarthFubuMVC/fubumvc/blob/6fdb2eeb200b79a1325333b7217def28a3261c0c/src/FubuMVC.Core/View/WebForms/IWebFormsControlBuilder.cs)创建视图的实例
*   [StructureMapWebFormsControlBuilder](http://github.com/DarthFubuMVC/fubumvc/blob/3a054f198ee8cdab301370aec2a7a1a0eb9add2f/src/FubuMVC.StructureMap/StructureMapWebFormsControlBuilder.cs) 派生自 WebFormsControlBuilder - 调用基础来创建实例，然后调用 BuildUp 对所有适用的属性执行 setter 注入。

# .net - .NET 3.5 中有内置的 zip 库吗？

> ID：593026
> 
> 赞同：32
> 
> 时间：2009-02-26T23:53:24.837
> 
> 标签：.net, compression, zip

.NET 3.5 中有内置的 zip 库吗？

如果没有，什么是流行的开源 .net zip 库。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-26T23:55:30.510

编辑：请参阅注释中的注释 - SharpZipLib 现在未维护，您可能希望避免它。

开源：[#ZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)

我相信`System.IO.Compression`命名空间中的类可以很好地压缩/解压缩单个数据流，但是框架中没有内置任何东西来处理实际的 zip 文件。

编辑：正如 Ants 的回答中所指出的，有[System.IO.Packaging.ZipPackage](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage.aspx)但它*看起来*确实是为 WPF 设计的，并且用于一般的 zip 文件处理并不是非常方便。值得研究。不过我之前并不知道……绝对值得研究。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-02T22:11:29.773

没有内置库。有开源选项。

[DotNetZip](http://DotNetZip.codeplex.com)就是其中之一。简单，易于使用。它具有良好的功能：AES 加密、常规加密、流、ZIP64、文件注释、Unicode、进度事件等。它是免费和开源的。

这是一些示例代码。

```
 // extract all Photoshop files larger than 100mb
    using (ZipFile zip1 = ZipFile.Read(ZipFileName))
    {
        var LargePhotoShopFiles = zip1.SelectEntries("name = *.psd  and size > 100mb");
        foreach (ZipEntry e in LargePhotoShopFiles)
        {
            if (e.UsesEncryption)
                e.ExtractWithPassword("unpackDirectory", "VerySecret!");
            else 
                e.Extract("unpackDirectory");
        }
    } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-27T05:02:10.100

查看 System.IO.Packaging.ZipPackage 类。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-27T00:00:06.113

[7Zip](http://www.7-zip.org/sdk.html)将提供帮助，并提供多种语言版本

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-26T23:57:42.530

[http://www.icsharpcode.net/OpenSource/SharpZipLib/](http://www.icsharpcode.net/OpenSource/SharpZipLib/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T23:55:01.447

试试`System.IO.Compression.DeflateStream`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T08:17:58.490

我将第二次推荐[http://www.7-zip.org/sdk.html](http://www.7-zip.org/sdk.html) LZMA SDK，但它不是 ZIP。

1.  它在公共领域
2.  减压速度很快
3.  它具有完全托管的实施
4.  压缩比 ZIP/RAR 好很多
5.  它的占地面积非常小
6.  它可以作为流工作

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-04-29T12:17:49.910

System.IO.Compression 从 .Net 4.5 开始具有[ZipArchive](http://msdn.microsoft.com/en-us/library/system.io.compression.ziparchive%28v=vs.110%29.aspx)类。

# c++ - 如何使用自动化在 C++ 中迭代 Excel 列的集合？

> ID：593037
> 
> 赞同：0
> 
> 时间：2009-02-26T23:57:51.220
> 
> 标签：c++, excel, automation

我想做以下 VBA 代码的道德等价物：

```
For Each col In Worksheets("Sheet1").Columns
    # do stuff
Next col 
```

我已经为 Excel 类型库生成了 MFC 包装器，让我走到了这一步（生成的类型都来自`COleDispatchDriver`：

```
CApplication app;
app.CreateDispatch( clsid, e );

CWorkbooks  wbks( app.get_Workbooks() );
CWorkbook   book( wbks.Open( filename, /* optional args */ ) );
CRange      cols( app.get_Columns() );
long        numCols = cols.get_Count(); 
```

从那里我被困住了。看起来我可以使用 迭代单元格`Range::get_Item( rowid, colid )`，然后从单元格中获取列，但我正在寻找上述循环的更直接翻译。

（编辑）澄清：我实际上并不关心单个细胞。我的目标是确定哪些列的宽度为 0（隐藏）并将它们从工作表中删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T00:49:27.900

我假设您正在尝试遍历电子表格中的所有单元格。您可以获得活动工作表的“所有单元格”范围，并遍历其行和列：

```
CSheets sheets = book.get_WorkSheets();
CWorkSheet sheet = sheets.get_ActiveSheet();
Range cells = sheet.get_Cells();

int nRows = cells.get_Rows().get_Count();
int nCols = cells.get_Columns().get_Count();

for (int i = 0; i <= nRows; i++)
    {
    for (int j = 0; j <= nCols; j++)
        {
        Range cell = cells.get_Item(i+1,j+1);
        //Do stuff with individual cell
        }
     } 
```

编辑：响应 OP 澄清：

这可能会做你正在寻找的东西：

```
CSheets sheets = book.get_WorkSheets();
CWorkSheet sheet = sheets.get_ActiveSheet();
Range cols= sheet.get_Columns();
int nCols = cols.get_Count();

for (int i = nCols; i > 0; i--)
    {         
    Range topCellOfCol = cells.get_Item(1, i);
    Range entireCol = topCellOfCol.get_EntireColumn();
    if (entireCol.get_Hidden())
         entireCol.Delete( xlShiftToLeft );        
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T22:16:20.910

多亏了[史蒂夫](https://stackoverflow.com/users/22472/steve)，我才走了大部分路。事实证明，尽管有 Excel VBA 文档，但 Range::Item 具有不同的行为，具体取决于创建范围的方式；因此：

```
COleVariant OPTIONAL( (long)DISP_E_PARAMNOTFOUND, VT_ERROR );

Range cols = sheet.get_Columns();
for ( long i = cols.get_Count(); i > 0; --i )
{
    Range col = cols.get_Item( COleVariant( i ), OPTIONAL ) ;
    // ...
} 
```

将遍历代表列的范围，并且

```
Range rows = sheet.get_Rows();
for ( long i = rows.get_Count(); i > 0; --i )
{
    Range row = cols.get_Item( COleVariant( i ),  OPTIONAL );
    // ...
} 
```

将遍历表示行的范围。这在 VBA 示例中是隐含的，但实际上并未在文档中说明。

# asp.net - 有没有办法在 javascript 中设置 asp.net 按钮的 CommandArgument？

> ID：593039
> 
> 赞同：12
> 
> 时间：2009-02-26T23:59:04.337
> 
> 标签：asp.net, javascript

我有一个列出一堆项目的 GridView，其中一个列有一个显示模式的链接（AjaxToolkit ModalPopupExtender）。我们称该链接为“显示”。在该模态中，我有一个 asp:button 用于保存在该模态中输入的数据。让我们将该按钮称为“保存”

因此，当用户单击某一行中的“显示”链接时，我想编写一些在“保存”按钮中设置某些内容的 javascript，以便在我的代码隐藏中，我可以处理“保存”。命令和使用 CommandEventArgs 参数获取值。

这可能吗，还是我只需要使用隐藏的输入标签并设置它的值？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-27T00:17:03.220

不是直接回答您的问题，而是解决问题的另一种可能方法：

在页面上放置一个`HiddenField`控件。在您的代码隐藏中，在显示模式弹出窗口之前，将该控件的值设置为被单击的行的 ID（或行号，或某个标识值）。然后在保存按钮的代码隐藏中，您可以读取`HiddenField`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-27T00:24:34.137

好吧，继续研究之后，似乎无法做到。CommandArgument 属性可能驻留在 ViewState 中，但在这种情况下，它完全是服务器端的，不能使用 javascript 进行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-04T04:04:12.437

如果您使用的是 Updatepanel，则需要将**Hiddenfield 放置在 Updatepanel 中**。否则您将无法获取/设置隐藏字段中存储的值。

# iphone - 如何在没有模板缓冲区的情况下在 iPhone 上的 OpenGL ES 中渲染反射？

> ID：593045
> 
> 赞同：5
> 
> 时间：2009-02-27T00:04:01.503
> 
> 标签：iphone, reflection, graphics, opengl-es

我正在寻找一种替代技术，用于在 iPhone 上的 OpenGL ES 中渲染反射。通常我会通过使用模板缓冲区来标记可以看到反射的位置（反射表面），然后仅在这些像素中渲染反转图像。因此，当反射物体离开表面时，它的反射不再可见。但是，由于 iPhone 的实现不支持模板缓冲区，我无法确定如何隐藏落在表面之外的反射部分。

澄清一下，问题不在于渲染反射本身，而是在它们不可见时隐藏它们。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T00:26:00.810

先渲染反射场景；`glCopyTexImage2D`使用;复制到纹理 清除帧缓冲区；正确绘制场景，将复制的纹理应用到反射表面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T00:17:43.247

我没有反射的答案，但这是我在没有模板缓冲区的情况下做阴影的方法，也许它会给你一个想法：

从光源的角度进行网格的基本正面/背面确定。然后我得到一个将前三角形连接到后三角形的所有边的列表。我将此边缘列表视为线“循环”。我沿着物体光线投射这个循环的顶点，直到它与地面相交。然后使用这些交点计算与地面相同的平面上的 2D 多边形。然后我使用镶嵌算法将多边形变成三角形。（只要您的光源或物体不经常移动，此方法就可以正常工作。）

一旦我有了三角形，我用轻微的偏移来渲染它们，这样深度缓冲区就会允许阴影通过。或者，您可以使用[贴花算法，例如 Red Book 中的算法](http://www.glprogramming.com/red/chapter14.html)。

# sql-server-2005 - MSSQL Server Management Studio (SSMS) 2005 新查询模板

> ID：593047
> 
> 赞同：5
> 
> 时间：2009-02-27T00:04:29.270
> 
> 标签：sql-server-2005, templates, ssms

如何更改 SSMS 2005 中的默认“新查询”模板？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-27T00:05:55.990

发布此问题作为参考，我进行了一些谷歌搜索，并找到了一种[简单](http://weblogs.asp.net/cabhilash/archive/2008/11/23/sql-server-management-studio-query-template.aspx)的方法。

您需要做的就是编辑位于此处的 SQLFile.sql：<%= your SQL install dir %>\90\Tools\Binn\VSShell\Common7\IDE\SqlWorkbenchProjectItems\SQL\SQLFile.sql

此外，Ctrl+Alt+T 将显示 SSMS 中的所有其他模板；并在使用时查看[免费的 SQL Server 工具](http://weblogs.sqlteam.com/mladenp/archive/2007/11/20/Free-SQL-Server-tools-that-might-make-your-life-a.aspx)。

# c# - 是什么导致在 VS2005 中调试时在 Page.Flush 上出现错误代码为 0x80070057 的 System.Web.HttpException？

> ID：593048
> 
> 赞同：2
> 
> 时间：2009-02-27T00:04:30.160
> 
> 标签：c#, asp.net, debugging, exception

这是完整的错误消息：

> System.Web.dll 中出现“System.Web.HttpException”类型的异常，但未在用户代码中处理
> 
> 附加信息：远程主机关闭了连接。错误代码为 0x80070057。

和有问题的代码：

```
 char[] buffer = oPage.HTML.HTML.ToCharArray();
 Page.Response.Write(buffer, 0, buffer.Length);
 Page.Response.Flush();
 Page.Response.End(); 
```

oPage.HTML.HTML 是我们的应用程序使用的自定义页面对象中的字符串。异常在 Page.Flush() 上触发并且似乎是良性的——我只是点击“继续”，一切顺利。这永远不会出现在运行时。

我追了很多很多谷歌打了很多兔子洞，但一无所获。Visual Studio 2005、Vista Ultimate (IIS7)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-10-12T20:09:48.400

我一直在处理同样的错误有一段时间了，我的理解是，当调用 Flush 时，另一端必须有连接，否则会抛出此错误。编写网页时很容易陷入“即发即弃”的模型，但是当客户端断开连接时（在此调试案例中，您是客户端），无处可刷新*到*.

我找到了两种解决方案：

1.  包装 Response.Flush 并捕获异常。
2.  在调用 flush 之前检查 Response.IsClientConnected。

我不是 100% 确定第二个...我仍在检查那个。

祝你好运！

# vb.net - Visual Basic 中类的动态属性

> ID：593049
> 
> 赞同：2
> 
> 时间：2009-02-27T00:05:55.367
> 
> 标签：vb.net, visual-studio-2005, metaprogramming

我是 vb.net 新手，所以请多多包涵。是否可以在 Visual Basic 中为类创建属性（或属性）（我使用的是 Visual Basic 2005）？所有关于元编程的网络搜索都让我无处可去。这是一个例子来澄清我的意思。

```
public class GenericProps
    public sub new()
       ' ???
    end sub

    public sub addProp(byval propname as string)
       ' ???
    end sub
end class

sub main()
  dim gp as GenericProps = New GenericProps()
  gp.addProp("foo")
  gp.foo = "Bar" ' we can assume the type of the property as string for now
  console.writeln("New property = " & gp.foo)
end sub 
```

那么是否可以定义函数 addProp ？

谢谢！阿米特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T03:55:48.310

无法在运行时使用新属性¹修改类。VB.Net 是一种静态语言，因为它不能在运行时修改其定义的类。您可以使用属性包模拟您正在寻找的内容。

```
Class Foo
  Private _map as New Dictionary(Of String, Object) 
  Public Sub AddProperty(name as String, value as Object)
    _map(name) = value
  End Sub
  Public Function GetProperty(name as String) as Object
    return _map(name)
  End Function
End Class 
```

它不允许以 myFoo.Bar 的形式直接访问，但您可以调用 myFoo.GetProperty("Bar")。

¹我相信使用分析 API 可能是可行的，但它可能不是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-27T18:28:41.383

在 Visual Basic 2008 中遇到了同样的问题。

在我可以迁移到 Visual Basic 2010 之前，属性包将暂时满足我的需求：

[http://blogs.msdn.com/vbteam/archive/2010/01/20/fun-with-dynamic-objects-doug-rothaus.aspx](http://blogs.msdn.com/vbteam/archive/2010/01/20/fun-with-dynamic-objects-doug-rothaus.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T00:45:15.163

不——那是不可能的。您需要像“method_missing”这样的 Ruby 来处理未知的 .Foo 调用。我相信 C# 4 承诺会在这些方面提供一些东西。

# c# - 移动设备休眠时如何继续执行？

> ID：593054
> 
> 赞同：1
> 
> 时间：2009-02-27T00:08:45.780
> 
> 标签：c#, windows-mobile

我正在开发一个需要执行直到倒计时的应用程序。当手柄关闭屏幕时，倒计时停止。发生这种情况时如何继续执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T14:57:01.247

我假设您的意思是您希望您的代码在设备挂起后继续执行？首先，你不能。当设备挂起时，处理器停止运行。不过，您有几个选择。您可以定期调用[SystemIdleTimerReset](http://SystemIdleTimerReset)以防止设备挂起，在“[无人值守模式](http://blogs.msdn.com/windowsmobile/archive/2004/11/29/271991.aspx)”下运行它，这样背光会关闭但设备不会挂起，或者使用像[CeRunAppAtTime](http://msdn.microsoft.com/en-us/library/aa931253.aspx)这样的 API来定期唤醒处理器以运行您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T04:45:28.200

请注意，CodeProject.com 上有一篇文章，其中包含使用 Windows Mobile 电源管理功能的托管 (C#) 代码示例。

[http://www.codeproject.com/KB/mobile/WiMoPower1.aspx](http://www.codeproject.com/KB/mobile/WiMoPower1.aspx)

此外，有关由于托管代码的各种条件而启动应用程序的信息，也可以在 CodeProject.com 文章中找到。

[http://www.codeproject.com/KB/mobile/WiMoAutostart.aspx](http://www.codeproject.com/KB/mobile/WiMoAutostart.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-06T10:43:47.953

还有另一种方法 - 一些“作弊方法”：**[在 Windows Mobile 6 中禁用睡眠模式](https://stackoverflow.com/questions/246407/disable-sleep-mode-in-windows-mobile-6)**。它使用**SystemIdleTimerReset**并另外模拟按键触摸。

# objective-c - Objective-C 消息传递，巧妙处理未知消息

> ID：593058
> 
> 赞同：1
> 
> 时间：2009-02-27T00:11:18.287
> 
> 标签：objective-c, runtime, messaging, conceptual

有没有办法做类似于 KVC 的事情，但使用消息名称作为密钥本身？例如，`valueForKey:`有没有办法让对象响应所有消息？

例如，假设您有一个 XML 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ...>
<employees>
  <employee>
    <name>Bill</name>
    <department>Accounting</department>
  </employee>
  <employee>
    <name>John</name>
    <department>Human Resources</department>
  </employee>
</employees> 
```

除了使用已经可用的 NSXMLDocument 和 co. 之外，是否还有一种方法可以实现某种抽象，以便您可以这样做：

```
MyXML *xmlDoc = [[MyXML alloc] initWithContentsOfFile:@"test.xml"];

NSLog (@"%@", [[[xmlDoc employees] first] department]);

[[[xmlDoc employees] first] setDepartment:@"Management"]; 
```

我选择 XML 只是作为示例，但我想知道这是否可能，以及它是否涉及过于接近 Objective-C 运行时或者它是否被运行时本身支持，以及我将如何进行关于实施这样的事情。这纯粹是出于实验目的，我知道可能会有很大的性能成本。

**编辑：**
如果可能的话，我想避免使用现有的框架，如 Cocoa 并使用基本的 Objective-C object `Object`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T00:22:22.097

您需要实现`forwardInvocation:`和`methodSignatureForSelector:`处理无法识别的消息。它在参考文献中有[描述。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/forwardInvocation:)`NSObject`

编辑：维基百科有一个如何为对象完成转发的[例子](http://en.wikipedia.org/wiki/Objective-C#Forwarding)`forward:`，基本上是通过实现and `performv:`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T01:39:12.430

感谢 codelogic，我发现你需要为 GCC 的 Objective-C 运行时做的就是：

```
#import <obc/Object.h>
#import <stdio.h>

@interface RespondsToEverything : Object {}
@end

@implementation RespondsToEverything
- (retval_t) forward:(SEL) sel :(arglist_t) argFrame
{
    fprintf (stderr, "Received: %s\n", get_sel_name (sel));
}
@end

int main (int argc, char *argv[])
{
    id test = [RespondsToEverything new];
    [test asdfasdfasdfasdf];
    [test zxcvzxcvzxcvzxcv];

    return 0;
} 
```

输出是：

```
Received: asdfasdfasdfasdf
Received: zxcvzxcvzxcvzxcv 
```

但当然，GCC 抱怨它找不到`asdfasdfasdfasdf`和的方法签名`zxcvzxcvzxcvzxcv`。没什么大不了的，它仍然表明这个概念是可行的。在 Apple 的运行时中，您可以`sel_getName(sel)`使用`get_sel_name(sel)`.

# windows-services - Windows 服务与 Windows 工作流基础？

> ID：593063
> 
> 赞同：2
> 
> 时间：2009-02-27T00:12:54.273
> 
> 标签：windows-services, workflow-foundation

我需要在后台运行并进入我的数据库并根据某些逻辑扫描和更新某些行的东西。我需要它像每小时一样运行，我的环境是 Windows Server 2003、SqlServer 2005。

WWF 对这个目的有好处吗？或者我应该创建一个 Windows 服务？而且，WWF 和 Windows 服务之间有什么区别，或者仅仅是做到这一点的最佳方式是什么？

谢谢，雷。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T00:17:53.730

我会说使用 Windows 服务而不是工作流。使用工作流程适用于涉及流程的情况。因为您只是在更新表中的记录，所以我会说服务和任何东西一样好..

实际上，既然我再次阅读了您的问题，您可能需要考虑 SQL Server 作业，并且可以安排它们以您喜欢的任何时间间隔运行。

Windows 服务是在 Windows 后台运行的长时间运行的进程。Windows Workflow Foundation 工作流用于为业务流程（或其他东西）布置工作流。您需要在某些东西（控制台应用程序、ASP.Net、Windows 服务等）中托管工作流运行时

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T00:34:15.237

如果我是你，我会使用 Windows 服务。我在 WF 中做了很多工作，我想说不在 WF 中做的主要原因是，MS 基本上按照 MS 在 10 月 PDC 上所说的完全重写了 WF 的下一个版本。会有一种方法在 4.0 中运行遗留的 3.0/3.5 活动，但我的印象是会有重大变化。

此外，听起来您不需要 WF 提供的模块化活动功能。WF 将添加另一层抽象，听起来您似乎不需要，而且您仍然需要编写一个 Windows 服务来运行您创建的工作流。如果您的业务人员需要不断改变正在发生的逻辑，并且您想在您想要创建的流程的管理上进行大量投资，那么 WF 将是一个不错的选择。

我也同意，根据你所说的，你应该考虑在 SQL Server 中创建一个 SSIS 包，除非你没有直接访问数据库的权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T00:38:05.023

Windows 服务过去曾为我工作，工作流的主要功能不是调度，当 Windows 服务基础结构已经包含所有这些并且它也有据可查时，您将需要为其提供主机。

# c# - 有关压缩/解压缩技术的文档

> ID：593064
> 
> 赞同：5
> 
> 时间：2009-02-27T00:13:31.510
> 
> 标签：c#, documentation, compression

我已经完成了我目前的“兼职”项目，并且正在寻找新的东西。

我决定尝试编写自己的压缩/解压缩实用程序。我不打算卖掉它或任何东西——这更多是为了我自己的利益。

最好使用 C#，但 Java 或 C 也可以。

任何人都可以建议一些我可以研究的压缩/解压缩技术的好资源。希望有一些不涉及博士学位的数学！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T00:19:42.290

关于这个主题的一本好书是[The Data Compression Book](https://rads.stackoverflow.com/amzn/click/com/1558514341)。它从基础开始，到 JPEG 和分形图像压缩算法结束。

几年前我读完了整本书（我想是第一版），我仍然记得它是一次非常有益的经历。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T00:42:40.473

本[次比赛](http://prize.hutter1.net/)很好地了解了文本压缩的当前状态，以及如果您想出一些好的东西可以瞄准的目标！

我发现这是对无损图像压缩的[有用调查](http://datacompression.dogma.net/index.php?title=FAQ:What_is_the_state_of_the_art_in_lossless_image_compression%3F)。

如果您只阅读一篇关于该主题的学术论文，请将其设为 CE Shannon 的[“A Mathematical Theory of Communication”](http://cm.bell-labs.com/cm/ms/what/shannonday/shannon1948.pdf)。那里的想法绝对是压缩的基础。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T00:49:16.603

我发现维基百科在这方面是一个很好的来源。例如，请参阅[Huffman 编码](http://en.wikipedia.org/wiki/Huffman_coding)、[LZW](http://en.wikipedia.org/wiki/LZW)和[Deflate](http://en.wikipedia.org/wiki/Deflate)，了解一些常见的无损通用数据压缩算法。

如果你想做一些更具体的事情，关于[JPEG](http://en.wikipedia.org/wiki/JPEG)的文章也很不错。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-27T00:55:47.820

这完全不是一个答案，但是....压缩和减压，对我来说，从来没有真正引起过高度关注。System.IO.Compression 中有压缩类，这些东西会替我处理。我还需要知道什么？如果内置类不够用，还有第三方类库。

（实际上，.NET 中的 DeflateStream 和 GZipStream 类对先前压缩的数据表现出异常行为：它们实际上可以增加他们被要求压缩的数据的大小。哎呀！据报道这是一个问题，但镜头偏离了博格的盾牌：[连接](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=93930)。

感谢 Microsoft 征求公共错误报告；在 Microsoft 上的 Bados，用于简单地关闭他们不想修复的错误。)

# perl - 如何在 emacs cperl 模式下停止自动格式化？

> ID：593073
> 
> 赞同：1
> 
> 时间：2009-02-27T00:17:54.090
> 
> 标签：perl, emacs, cperl-mode

当我在 cperl 模式下缩进区域时

```
如果 ($x) { 下一个; }

```

Emacs 将其重新格式化为：

```
如果（$x）{
  下一个;
}

```

我怎样才能让它停止这样做？

注意：问题最初是说这种重新格式化是在拉动时发生的。我也设置了缩进区域。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T18:10:45.930

```
(setq cperl-break-one-line-blocks-when-indent nil) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T00:42:16.777

假设您也不希望它在键入那种代码时自动格式化，只需将绑定更改为`{}`to`self-insert-command`而不是`perl-electric-terminator`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T12:47:25.053

我在 cperl 模式下找不到任何可以做到这一点的东西。尝试在没有自定义的情况下启动 emacs：

```
$ emacs -q 
```

然后在*暂存*缓冲区中打开 cperl-mode：

```
M-x cperl-mode 
```

粘贴您的文字；它应该看起来像原来的（即全部在一条线上）。然后开始自定义 cperl-mode：

```
M-x customize-group<RET>cperl<RET> 
```

仅为当前会话单独设置每个变量，并尝试在每个设置之间粘贴。如果你突然发现你所看到的行为，你就有了一个进一步观察的起点（它可能是选项的组合）。

如果您获得了完全定制的 cperl 并且它的行为仍然没有“错误”，那么您需要开始查看可能导致它的其他软件包。可能需要一段时间......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T00:39:50.543

它对我不起作用，我只是在 Perl 菜单下的 Toggle... 子菜单中尝试了各种设置。除了 Cperl 模式之外，还有其他的东西可以实现吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T18:18:27.720

听起来好像我在给出一个逃避的答案，为什么不这样做呢？

```
next if $x; 
```

相同的代码，相同的效果，同样可读（至少对我而言），但我敢打赌 emacs 不会尝试重新格式化它。

# c++ - Boost RegEx中的等号

> ID：593078
> 
> 赞同：1
> 
> 时间：2009-02-27T00:20:57.750
> 
> 标签：c++, regex, boost

我对以下 Boost 正则表达式有疑问，

```
boost::regex e("=");
if(regex_search("=", e)) cout << "yeah"; 
```

谁能告诉我为什么我没有得到“是的”？这是带有 Visual Studio 2008 的 Boost 1.37。提前非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T08:37:40.050

我刚刚在 Visual Studio 2008 上使用 Boost 1.37 尝试了您提供的代码，它编译、运行并输出“是的”。您确定正确设置了 Boost 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T00:36:56.243

使用相同的代码，我*确实*在这里得到了“是的”。

请注意，我必须添加`boost::`到 的开头`regex_search`，并且我在 Linux 下的 GCC 上运行。我还没有在 Windows 下设置 Boost 1.37，所以我不能在那里轻松地测试它。

# ruby-on-rails - Vbulletin 和 rails 应用程序之间的单点登录

> ID：593081
> 
> 赞同：7
> 
> 时间：2009-02-27T00:22:12.393
> 
> 标签：ruby-on-rails, session, single-sign-on, vbulletin

我们在 VBulletin 论坛上有很多用户。现在我想为同一个用户群在 Rails 上编写更多应用程序。到目前为止，所有身份验证和会话管理都由 VBulletin 负责。在VBulletin 和我正在编写的rails 应用程序上为我的用户提供SSO 的最佳方式是什么

* * *

我正在使用 v Bulletin 和定制应用程序进行单点登录过程。我可以使用 cookie 在 Vb 登录。我可以访问所有。但是当访问发送“私人消息”。它说

" 您已关闭私人消息。在您通过编辑选项将其打开之前，您可能无法发送私人消息。"

是否在“数据源”表中设置了所有权限？..

谢谢大师

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T03:22:02.570

理想情况下，您的两个站点是公共域的子域（例如`forum.example.com`和`rails.example.com`），或者共享同一个域（`www.example.com`。）其中一个站点将是主要身份验证器，并设置一个 cookie（对于`.example.com`公共父域的情况[注意`.`before `example.com`] 或`www.example.com`在共享域的情况下，以便两个应用程序都可以访问它），其中 cookie 包含：

*   这`user ID`
*   a `salt`（登录时计算的随机值），和
*   a`SHA-2 signature`在三元组 ( `user ID`+ `salt`+ a `shared secret key`) 上计算，其中共享密钥是两个站点都知道的秘密字符串。

每个站点都能够从 cookie 中检索`user ID`和`salt`，然后使用`shared secret key`（只有两个应用程序知道）来计算`SHA-2 signature`必须匹配`SHA-2 signature`存储在 cookie 中的 a。

如果`SHA-2 signatures`匹配，则可以假设用户已通过身份验证，否则强制用户再次登录。

注销时必须销毁 cookie。

**小字**

为防止会话劫持，通过两个站点发出的所有请求都应通过 SSL 加密（使用 https。）如果不可能，则应基于客户端的 IP 地址以及浏览器类型和版本（用户代理）的哈希值可能在登录时计算并存储在 cookie 中。在处理每个请求之前，应根据客户端的 IP 地址和用户代理重新检查它。基于散列的方法是通过默默无闻的安全性，并且可以被愚弄；此外，每次不同的代理或退出节点（具有不同的 IP 地址）转发请求时，从代理池后面访问 Internet 或使用[TOR的用户可能会被您的系统踢出。](https://www.torproject.org/)

# asp.net - ASP.NET FileUpload Control - 缓冲到磁盘时的安全问题

> ID：593086
> 
> 赞同：3
> 
> 时间：2009-02-27T00:24:11.237
> 
> 标签：asp.net, security, file-upload

MSDN 指出，当使用 ASP.NET (v.2.0) Fileupload 控件或底层 HttpPostedFile*上传文件时，“文件以 MIME multipart/form-data 格式上传。默认情况下，所有请求，包括表单字段和上传大于 256 KB 的文件被缓冲到磁盘，而不是保存在服务器内存中。”* [MSDN 链接](http://msdn.microsoft.com/en-us/library/system.web.httppostedfile.aspx)

有谁知道它缓冲到磁盘上的哪个位置以及何时清除/删除该缓冲区，即请求结束的时间以及在请求未正常结束的错误或意外情况下会发生什么？

我担心的是，如果应用程序能够上传敏感信息（CC 数据、个人数据等），该文件将被缓冲在磁盘上，并且在请求结束时可能不会被删除。这会是共享主机上的问题，即可以从应用程序外部访问此缓冲区吗？

也许我误解了一些东西，但任何建议/见解/帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T04:26:10.000

OK 已经设法找到了上面提出的问题的一些答案，所以只要把它们贴在这里，以防它帮助其他人。

默认情况下（在 machine.config 中）文件上传/请求的设置通常是

请求的最大大小为 4mb，在请求缓冲到磁盘之前，内存中存储了 256 字节。这些设置可以在 httpRuntime 部分的 web.config 中被覆盖。

```
<httpRuntime maxRequestLength="8192" requestLengthDiskThreshold="512" /> 
```

上面的示例将允许最大 8mb 的请求大小，并在 512 字节后开始在磁盘上缓冲。该文件被缓冲到

> C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\ [APP_NAME] \ [SOME_HEX_NAME_DIR] \ [SOME_HEX_NAME_DIR] \uploads\

在此路径上，将使用 [unique_name]_post.tmp 创建一个文件，该文件在请求期间存在，但由于请求已锁定而无法访问。

我尝试以几种方式中断请求（停止 IIS、终止进程、在上传时关闭页面），并且在所有情况下都删除了 tmp 文件。

因此，从这一点看来，缓冲的敏感数据似乎不是一个很大的问题，因为缓冲的文件不会长时间停留。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-15T00:52:53.270

如果对任何人有帮助，请提供更多信息：

[来自 MSDN](http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.requestlengthdiskthreshold(VS.80).aspx)：“RequestLengthDiskThreshold 属性以字节数为单位指定输入流缓冲阈值限制。其值不应超过 MaxRequestLength 属性值。请求实体超过此阈值后，它会透明地缓冲到磁盘上。”

我相信如果将 maxRequestLength 设置为与 requestLengthDiskThreshold 相同的级别（注意前者以 kB 为单位，后者以字节为单位），那么上传的内容将永远不会写入磁盘。

当然，缺点是您将使用更多内存来服务文件上传。

例如。

```
<httpRuntime maxRequestLength="256" requestLengthDiskThreshold="262144"></httpRuntime> 
```

# asp.net - 在 asp .net 应用程序中添加新列

> ID：593088
> 
> 赞同：0
> 
> 时间：2009-02-27T00:25:21.153
> 
> 标签：asp.net, database

我在一个新的小项目中面临这个问题：要构建的系统将允许用户向系统中的表添加新列，然后用户将能够维护数据，我认为有两种方法可以实现这：1）创建一些表，包括“columns”表，带有“columnName”“columnValue”“datatype”等来存储列定义，另一个表“XXCoumn”来存储列的值（由用户输入），以及用户用于查询/更新列数据的存储过程。2）当用户输入新列时，在表模式中创建列，然后表数据的维护就像平常一样

你们怎么看？或任何新的建议？

一些附加信息：数据量很小，我需要创建报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T01:30:38.767

任何好的建议都需要更好地了解您的要求，但这里有一些关于您提到的选项的评论，以及一些额外的想法。

1)**实体-属性-值 (EAV) 设计**：这是您描述的选项，您在哪里有一个包含 ColumnName、Type 和 Value 列的表。此选项的优点是能够轻松容纳无限的新列，但我发现在检索有意义的数据时会很痛苦。例如，假设您在此 EAV 表中有 {Color, varchar}{Red, Green, Blue} 和 {Size, varchar}{Small, Medium, Large} 的行。如果你想找到所有的绿色小项目，你需要这样的东西（当然是未经测试的 SQL）：

```
SELECT * 
FROM ITEMS 
WHERE ITEMID IN (SELECT ITEMID 
                 FROM ITEM_ATTRIBUTES ATT INNER JOIN ITEM_VALUES VLS
                     ON ATT.AttributeID = VLS.AttributeID
                 WHERE ATT.ColumnName = 'Color' AND VLS.Value = 'Green')
  AND ITEMID IN (SELECT ITEMID 
                 FROM ITEM_ATTRIBUTES ATT INNER JOIN ITEM_VALUES VLS
                     ON ATT.AttributeID = VLS.AttributeID
                 WHERE ATT.ColumnName = 'Size' AND VLS.Value = 'Small') 
```

将此与在项目表上具有颜色和大小的实际列进行对比：

```
SELECT *
FROM ITEMS
WHERE COLOR = 'Green' AND SIZE = 'Small' 
```

此外，您将很难维护数据完整性，如果这对这个应用程序很重要（而且它几乎总是很重要，即使您被告知其他情况）。在上面的示例中，如果“颜色”应限制为蓝色、绿色和红色，您将需要实现额外的逻辑。此外，如果某些颜色仅具有某些尺寸，您将需要实现更多逻辑（例如 - 蓝色项目仅适用于中小型）

2)**用户定义的列**：只是让用户能够向表中添加额外的列具有使数据检索更简单的优点，但所有数据完整性问题仍然存在。此外，您的应用程序通常需要额外的逻辑来处理未知列。

3)**预先存在的自定义列**：我使用过一些应用程序，例如 CRM，它们提供了十几个或更多列用于用户定义。基本上，设计人员会放入“Text1”、“Text2”、“Text3”、“Number1”、“Number2”等列。然后用户为这些列提供标题和描述信息，这就是应用程序的用途显示目的。该模型具有易于数据检索的优点，以及应简化应用程序逻辑的预定义数据库模式。然而，数据完整性问题仍然存在。另一个明显的缺点是您将用完预定义的列，这是您通常试图通过这种类型的解决方案避免的。

与大多数设计问题一样，每种解决方案都需要权衡取舍。我的经验是，虽然许多用户/客户说他们想要这样的解决方案，但实际上他们只是想确保他们不会被无法满足他们需求的应用程序所困。我发现实际上很少有地方需要这样的设计。我几乎总是可以创建一个满足客户扩展需求的设计，而无需让他们扮演数据库设计师的角色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T00:42:34.280

> “要构建的系统将允许用户向系统中的表添加新列......”

真的 - 这就是用户故事？对我来说，听起来你已经决定了解决方案。

允许用户扩展模式是否是一个好主意取决于上下文。在类似管理员的有限使用方式中，我几乎没有问题。但在 MySpace 类型的方式中，这将是一个非常糟糕的主意。我怀疑你的情况介于这两个极端之间。

扩展模式将导致更高效的查询 - 因为您可以添加索引等 - 但它确实会为您的用户公开一些关系规则。此外，扩展将（可能）锁定整个表，并且需要处理并发编辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T00:30:00.130

如果这由您集中托管，我建议不要允许用户输入数据来更改数据库的架构（即驱动新表的创建）。

相反，您可能想研究在 SQL 中使用 XML 字段来存储数据的可变字段名称，或者更通用的表结构......如果我们不是在谈论疯狂的数据量，这种技术非常有效......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T00:32:20.623

您是否有可能从侧面看待您的解决方案？听起来你需要一个映射表（有点像你的#1）。您有一个表，例如“对象”，一个名为“属性”的表，其中包含您要调用的列，然后是一个包含值的表，因此它只有 object_id、property_id、值。

为了比我说的更聪明，请看一下[Entity-attribute-value](http://en.wikipedia.org/wiki/Entity-attribute-value_model)模型。

# security - 如何保护我网页上某些数据的抓取？

> ID：593092
> 
> 赞同：1
> 
> 时间：2009-02-27T00:26:40.887
> 
> 标签：security, screen-scraping

我只想保护每次请求后显示的某些数字。这样的数字大约有30个。我本来打算生成图像来代替这些数字，但是如果图像没有像验证码那样扭曲，脚本就不能破译这些数字吗？此外，加载图像对文本的性能影响有多大？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T00:39:32.727

确保坏人无法获取您的数据的唯一方法是不与任何人共享。任何其他解决方案本质上都是与屏幕刮板进行军备竞赛。在某一时刻，你们中的一个人会发现军备竞赛的成本太高而无法继续。如果您共享的数据具有任何可感知的价值，那么屏幕抓取器可能会非常确定。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T03:02:15.957

这是不可能的。

*   您使用 javascript 并加密页面，在解密后使用 document.write() 调用。我要么从浏览器的显示中抓取，要么通过 JS 引擎提供页面以获取输出。
*   你使用闪存。我可以戳入闪存文件并获取值。你在闪存中加密它们，我可以运行它，然后从解释器的显示器中获取输出作为图像序列。
*   你使用图像，我可以通过 OCR 提供它们。

你在军备竞赛中。你需要做的是让你的信息如此有用，你的页面如此易于使用，以至于你成为权威来源。定期更改输出格式以跟上进度也很方便，但屏幕抓取工具可以处理这种情况，除非您做出相当彻底的更改。激进的变化将用户赶走，因为页面对他们来说一直是陌生的。

您的图像解决方案不会有太大帮助，而且图像的效率要低得多。在 HTML 编码中，数字通常只有几个字节长。图像从几百字节开始，根据您想要的大小扩展到 1k 或更多。图像也不会以用户为其浏览器窗口选择的字体呈现，并且对使用辅助计算设备的人（视障人士）毫无用处。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T00:33:26.703

除了图像，您还可以使用 JavaScript 或 Flash 显示数字。

您还可以使用 CSS 使用绝对或相对位置的各种组合来定位单个数字。您还可以使用 JavaScript 来帮助您创建这些 DIV。关键是要混淆得足够多，以至于变得非常困难。

另一种解决方案是使用分段或单个点的图像，并使用 CSS 重新构建数字的图像，有点像点阵显示。您可以使用这些绝对定位的 DIV 乱扔页面的源代码，并再次通过动态创建它们来使重构变得更加困难。

无论如何，您无法阻止确定的**抓取**工具获取数据：自动化 Web 浏览器并截取可提供给 OCR 的屏幕截图并不需要太多时间。无论如何，没有人愿意花一分钱手动获取数据。

关键是：你的对手（用户？）有多坚定。
这有点像软件保护业务：让事情变得足够困难以阻止偶然的“盗版者”并不是太难，而且总的来说这是一个相当不错的方法。

但是，如果您提供的数据有很大价值，那么您实际上无法采取任何措施来保护它。
你所能做的就是让它变得足够困难，以至于随便的“小偷”宁愿继续为你的服务付费，而不是规避它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T00:38:58.860

Javascript 可能是最容易实现的，但是您可以通过在无效数字上放置图层、将错误的数字混合到背景中或通过 css 使它们不可见来获得真正的创意并拥有大量数字，其中某些数字是可见的和半随机生成的类名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T00:28:23.830

生成包含这些数字的图像并显示图像。:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T00:31:59.500

我不敢相信我正在推广一种常见的恶意软件脚本策略，但是......

您可以将数字编码为在运行时呈现的编码 Javascript。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-12T01:25:03.013

我认为你们对这些解决方案过于敏感。Javascript、Capcha，甚至诉讼和 DMCA 流程都不能解决网络抓取和数据盗窃的复杂适应性问题。您不认为防止恶意机器人和网站抓取的“理想”解决方案将在实时主动缓解策略中发挥作用吗？非常类似于内容保护网络。就说吧。

例子：

IBM - [IBM ISS 数据安全服务](http://www-01.ibm.com/common/ssi/cgi-bin/ssialias?subtype=ca&infotype=an&appname=iSource&supplier=897&letternum=ENUS610-003&open&cm_mmc=6210-_-n-_-vrm_newsletter-_-10207_145074&cmibm_em=dm:0:16661896)

蒸馏 - [www.distil.it](http://www.distil.it)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T00:35:20.087

你能提供更多关于你在做什么的细节吗？当然，创建图像而不是转储数字文本会降低性能，但是您每天这样做的频率如何？

使用 JavaScript 与使用文本相同。逆向工程很简单。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T00:40:22.803

使用 Flash 使用动画数字。它可能不是万无一失的，但它会使其更难破解。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T00:45:53.790

发布大量虚拟数字并使用外部 CSS 显示正确的数字怎么样？只要刮板不开始解析外部CSS。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T00:50:59.987

不要输出数字，即前缀

```
echo $secretNumber; 
```

与`//`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-27T02:28:48.253

对于所有建议使用 Javascript 或 CSS 来混淆数字的人来说，可能有一种解决方法。Firefox 有一个名为 abduction 的插件。基本上它所做的是将页面作为图像保存到文件中。您可能可以修改此插件以保存图像，然后分析图像以找出试图隐藏的密码。

基本上，如果从页面上抓取这些数字有足够的动机，那么它就会完成。否则，只需发布​​一个常规号码，让您的用户更容易使用，这样他们就不必担心无法复制和粘贴号码，或者这种诡计导致的其他此类问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-27T03:10:12.677

只需使用 CSS 盒子模型做一些意想不到和奇怪的事情（每次都不同）。强制他们实际使用浏览器支持的屏幕截图。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-27T03:33:38.613

我认为这是不可能的，你可以让他们的工作更难（使用这里建议的图像）但这是你能做的，你不能阻止一个有决心的人获取数据，如果你不想要他们抓取你的数据，不要发布它，就这么简单......

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-27T06:28:36.087

假设这些数字经常更新（如果它们不更新，那么保护它们完全没有意义，因为人类可以手动转录它们），您可以通过限制来限制自动抓取。如果您可以限制您赢得的这些检查，而无需使用混淆，自动化脚本将不得不经常访问您的站点以检查更新。

有关节流的指示，请参阅[此问题](https://stackoverflow.com/questions/450835/how-do-you-stop-scripters-from-slamming-your-website-hundreds-of-times-a-second)。

# sql - 存储过程更容易维护吗？

> ID：593107
> 
> 赞同：14
> 
> 时间：2009-02-27T00:33:29.310
> 
> 标签：sql, stored-procedures, maintenance

为了使代码更易于维护（即更容易在不重新编译代码的情况下更改业务规则），将代码放入存储过程中的论据是什么？

在其他条件相同的情况下，是什么使存储过程更好/更差于维护？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-27T01:23:04.993

出于多种原因，存储过程是一种不好的做法。

其中最重要的一项是关注点分离。使用存储过程，您在数据层中拥有业务逻辑，而不是在它所属的服务层中。这样做的一个结果是，您现在拥有一种语言，而且只有一种语言可以用来实现您的业务逻辑。随着新技术的出现，您没有好的迁移路径。

避免存储过程的另一个充分理由是存储过程在您和数据库供应商之间建立了牢固的联系。更改为不同的数据库供应商将非常困难，而在服务层中拥有您的业务逻辑将允许您非常轻松地换出数据库。因此，存储过程为 DB 供应商提供了很大的好处，而对您来说却没有那么多好处。

其次，可扩展性。在中间层创建服务并将它们分布在集群中非常简单。你将如何使用存储过程来做到这一点？我认为将存储过程集群到甚至八台机器上是非常困难的。

其次，与其他系统的集成。如果您的系统从您的数据库中提取数据，依赖于存储过程，以及来自其他系统的其他数据，那么该逻辑几乎肯定必须在服务层中。如果你的一些业务逻辑在服务层，而一些在业务层，你就会遇到一些维护麻烦。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-27T00:37:30.127

这可能取决于您的系统。对我们来说，几乎只使用存储过程。我们只有一个网站，因此将 SQL 语句保存在存储过程中可以让我们的 DBA 更轻松地调整查询并重新创建导致问题的性能。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-27T02:02:45.990

想想替代方案...

*   将查询硬编码到您的系统中
*   根据用户输入构建查询字符串
*   让您的代码根据您的业务实体和数据库命名约定（通过 ORM、LINQ、CodeDom 等）动态生成查询
*   ETC...

然后考虑您的要求和环境...

*   您的开发人员是否熟悉您的数据库管理工具，或者您是否有更多的数据库程序员和管理员处理然后围栏的数据库端？

*   您是否需要频繁更改数据库架构？

*   安全性如何？您是否需要一直到数据库用户级别的安全性？在代码或数据库中管理安全性会更容易吗？

*   您的开发人员是否会使用 ORM 提高工作效率，而不必为自己编写 DAL，或者是否会增加复杂性，您希望以自定义方式将 ORM 无法提供的 DAL 添加到您的 DAL 中？

*   ETC...

人们会对 procs 是否更容易维护有不同的看法，这取决于他们所工作的系统和环境可能与你自己的相差甚远。您可能应该做的不仅仅是想知道它们是否更易于维护，而是弄清楚它们是否适合您的需求。这是一个非常好的问题，但也许编辑您的帖子并解释更多关于您的环境的信息。你可能会得到一些更有针对性的建议。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-27T02:28:58.987

与在应用程序中保留查询相比，存储过程提供了许多优势，并且已经提到了很多。

存储过程充当应用程序和数据之间的抽象层，抽象层很少是坏事。

如果您有级联数据库操作，您可以实现一定程度的重用。`Delete_Employee`例如，该过程可以在事务中调用该过程`Delete_Address`，并通过来自应用程序的单个数据库请求执行许多其他操作。

存储过程下方的视图层可用于将应用程序与架构更改和查询/连接性能调整隔离开来。

存储过程层是可靠的企业架构和框架的重要组成部分。这些存储过程不应该包​​含任何业务逻辑，当然，它们应该只传递数据而不是操作它。

为了实现这些好处，良好的纪律是为了在应用程序的所有过程中保持一致性和相同的粒度。我处理过包含 100 多个程序的应用程序。如果所有这些查询都在代码中，那么实现数据级安全性会更加困难，如果不是不可能的话。可以轻松生成存储过程。我觉得使用存储过程的整体生产力比没有的要高。当然，存储过程应该在源代码控制中，就像所有其他数据库对象一样。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-27T00:49:01.190

如果您的基础软件部署在多个不同的客户站点，则每个客户所需的大部分定制都可以通过数据库（视图和存储过程）来完成。您几乎可以将 SP 视为一个 INTERFACE，来回传递标准数据，而不用关心里面发生了什么。

当然，这也可以通过其他方式进行处理，例如每次安装的自定义 .dll 数据层。

但在某些情况下，SP 中的定制而不是 .dll 允许更快的定制，并允许 DBA 或数据专家接管，让程序员继续编码。

请记住，与编译后的代码相比，SP 中的代码可供更多人（在本例中为客户）使用。这可能是好是坏，取决于您的情况。

在某些企业中，更改存储过程在政治上比重新安装软件更容易（这更多地取决于谁有更严格的规则、开发人员和项目经理、DBA 或 IT/帮助台）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-27T01:31:34.553

我的经验是，很少像维护应用程序代码那样勤奋地使用源代码控制来维护数据库。当然，情况可能并非总是如此，但 15 年来我从未见过。这意味着您更有可能让人们在开发中进行更改，并且天堂禁止实时数据库存储过程，而没有真正考虑到易于维护，因为它太容易了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-27T00:36:45.887

我并不是反对存储过程，但我建议它们更难维护，因为它们必须独立于应用程序的更新进行更新（它们必须存储在 sql server 中）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-27T00:50:24.807

平等，这是一种不好的即时改变习惯，你还记得吗？
说真的，**在存储过程中编写代码可以确保您的 SQL 交互更快**。
但是**您的更改与 source-control 相去甚远**。（据我所知，对于源代码控制，您需要导出）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T01:20:36.077

根据我的经验，我认为主要的缺点是很少有与我共事过的开发人员对 SQL 感到非常满意（首先编写它，调试它）所以你必须确保你将拥有正确的技能团队要能够维护很多SQL。

如果您有多个平台（例如 Windows 和 Web 应用程序）或者将旧应用程序移植到新技术，则可以重用数据库过程，这是一个很大的优势。

我正在使用的应用程序在存储过程中有很多业务功能，我们修复的错误可能有一半是在 SQL 代码中，如果关键可以通过替换存储过程来快速修复，而不是在必须等待下一个版本的应用程序代码。（但另一方面是，如果我们没有编写这么多 SQL 代码，我们可能一开始就有更少的错误，谁知道呢！）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-27T02:19:27.900

我在商业界从事 CRUD 编程已经 10 多年了。我可以告诉你，我在存储过程和视图中加入了尽可能多的业务逻辑（并且是有道理的）。每当风吹草动时，需求往往会发生变化，并且数据库中的逻辑使其易于更改并且（带有体面的评论）它是自我记录的。加上 sprocs 可提供良好的安全性并易于代码重用。

FWIW 我对所有存储过程都使用源代码控制和严格测试。否则只是懒惰。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-27T02:26:12.363

出于多种原因，存储过程是一个好主意：

通过使业务逻辑更接近数据，您可以拥有任意数量的数据客户端接口。您可能最初为网站设计前端，但现在他们需要报告。没问题，业务逻辑在数据旁边。打开 API，在程序前面放置一个 Web 服务。您想使用最热门的新语言，请继续。业务逻辑在数据旁边。

使用存储过程的另一个原因是它在您和所选数据库之间建立了牢固的联系。通过这种方式，您可以利用您支付的数据库的内置功能（或在开源的情况下使用）。猜猜看，如果您尝试使您的应用程序数据库独立，您可能会遇到许多难以追踪的错误。 [读取一致性在每个供应商的数据库上的工作方式不同。](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1886476148373)

您可以利用数据库内置的可伸缩性（集群、RAC——不管它们如何实现）。无需自己编写。

编写不使用绑定变量的代码更难（如果您需要更多信息，谷歌软解析与硬解析）。

版本控制——我一直对存储过程使用版本控制的公司。您通常在某个编辑器中编写存储过程。现在大多数编辑器都内置了对至少一种主要版本控制系统的支持。

外部代码必须通过网络提取数据，然后使用它。

最后，并非所有的程序语言都是平等创建的。MySQL 刚刚发布了使用存储过程的功能，它们为您提供了多种可以使用的语言，包括它们自己的语言。我怀疑他们是否经得起 Oracle 或 SQl Server 的考验。我不打算讨论谁是最好的，因为我不是甲骨文的专家。Oracle 的 PL/SQL 有很多在 DB 内核中优化的功能。我相信 MS SQL 也能做到这一点。

希望这会有所帮助（并且有意义 - 漫长的一天）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-27T00:42:56.323

在我工作的项目中，大部分的维护都可以通过改变sql程序来完成。所以是的，存储过程在我的情况下更易于维护，而且它们比从代码中执行 sql 语句具有更好的性能。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-27T00:58:17.550

通常，提出该论点是因为您正在对存储的过程进行临时更改，而不是通过编译代码将通过的版本控制、测试等。

我对此没有立即的下意识反应（与这里的大多数人不同），但我会说在那种牛仔环境中编译和部署 DLL 并没有那么难。或者，您可以使用 CS-Script 之类的东西，它允许您保留按需编译的原始 .cs 文件。

我一直发现很难对存储过程进行版本控制和测试，而大多数代码都很容易完成。此外，大多数 RDBMS 过程语言都非常原始 - 所以你没有当代语言给你的表现力或抽象性。

当然，版本控制是一件好事——而且，对于大多数地方来说，开发人员和生产之间的一些过程检查也是如此。;)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-01-20T02:08:20.757

有些人会争辩说，业务逻辑在存储过程中没有位置，并导致系统无法维护。我要指出，这些论点主要来自 DDD 和 N-Tier 的观点，他们寻求将所有业务逻辑放在应用程序层的特定区域中。虽然这是一个有价值的目标，但还有其他观点值得考虑。SP 还可以做的不仅仅是内部业务逻辑。

顺便说一句，Oracle 世界认为其最佳实践是将所有业务逻辑都放在数据库上的 PL/SQL 代码中，而且他们对关系数据库略知一二！

考虑 SP 的这些用途：

**表现。**在一个 SP 中运行多个 SQL 语句通常很有用，从而避免您的应用程序多次往返于数据库，从而有时会显着提高性能。

**更换管理层。**只要您对版本控制和部署过程有纪律，SP 就易于维护和修改。

SP 可以在*不中断的情况下*发布到实时生产系统，这在 24/7 运营中可能是一个相当大的优势。当然，您仍然需要严格控制发布过程。

**抽象层。**SP 可以从应用程序中抽象出 DB 模式的详细信息，前提是所有 app/db 交互都通过 SP。这可能是一个非常强大的概念。考虑到数据库的生命周期通常会比应用程序寿命更长 - 应用程序来来去去，并且经常使用最新的技术和架构模式重新编写，但有价值的数据会在同一个旧的关系数据库中保存很长时间。通常，多个应用程序是在同一个数据库上开发的，即使这从来都不是最初的意图。这些场景中的 SP 用于在应用程序和数据库之间提供一个紧密、定义良好的 API，可以对其进行仔细控制，以确保与多个应用程序甚至同一应用程序的多个版本进行一致的交互。

db schema 和 app 之间的关注点分离使应用程序程序员可以自由地做他们最擅长的事情，同时让 DBA 可以自由地随着时间的推移改进 schema 而不会破坏应用程序。

无论您采用何种架构模式，SP 都可以发挥重要作用。不要排除任何设计，就像任何工具一样，在有意义的地方使用它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-27T02:37:50.383

我再谈一件事关于版本控制。在我的上一份工作中，我添加了一个每天运行的第 3 方打包，并存储每个对象的 DDL 或代码的副本（如果它从上次备份时发生更改）。它本身是存储过程，因此可以手动或通过触发器运行，无论您希望它如何运行。它本身就是一个版本控制系统。

这是一个相当不错的工具，只需大约 200 美元。它甚至带有一个差异工具来向您展示发生了什么变化。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-27T03:35:23.240

我们已经从使用存储过程转换为基于代码的业务逻辑生成的 DAL，原因有很多：

1.  独立于数据库 - 通过使用内联 SQL 或生成 DAL（均符合 ANSI），更容易从 Oracle 切换到 Postgres 再到 SQL Server 等。
2.  强制源代码控制（我承认这在任何一种情况下都可以使用，但对我们来说帮助很大）
3.  无论如何，我们升级 GUI 比数据库更频繁，所以这降低了我们的升级复杂性
4.  开发人员更容易调试客户端问题

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-27T03:42:49.120

这真的取决于存储过程的编写情况，不是吗？如果从业者编码时没有经过深思熟虑，T-SQL 和 PL-SQL 可能会变得像 C# 或 COBOL 一样粗糙且难以维护。

我最近进行的一项改进是，我故意将功能放在存储过程中，主要是因为我希望该功能更易于引用，更少维护（存储过程可以从数据库级别和客户端级别调用; 如果我将逻辑放在不同的层，那将是不正确的）。我认为我在使 PL-SQL 相当模块化方面做得很好，但是当 TOAD 分析它时，4 个部分中有 3 个得到了很好的分数，最后一个因高圈复杂度而受到重创。呵呵，我想我已经证明了自己的观点！

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-02-27T01:05:17.330

# 存储过程的两个优点

我认为影响这一点的一个因素是客户端的数量，因为它可以在无需重新部署应用程序的情况下进行架构更改。例如，作为一个 DBA，我发现在调整 SQL、解决错误等时访问一个存储过程而不是 X 客户端来更改 SQL 语句要容易得多，当 X 是一个很大的数字并且“访问”它们意味着部署新版本的应用到多个工作站。

正确完成还意味着应用程序使用的模式可能与数据存储模式不同。例如，我喜欢高度规范化数据模式并提供一组视图和应用程序使用的存储过程。应用程序架构会随着应用程序代码的更改而及时更改，并且独立于数据架构。这是多应用系统的真正优势（例如，一个读写应用程序和一个使用相同数据的网站应用程序。）

# 存储过程的缺点之一

通常有一组不同的工具和不同的语言用于编写存储过程。这可能会阻碍需要培训、技能发展等的吸收。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-02-27T01:53:02.053

我更喜欢不使用存储过程，因为我喜欢保持相对数据库不可知论。如果出现更好的关系数据库，我希望可以选择迁移到它。存储过程会锁定你。也就是说，我偶尔会使用它们，它们可能非常强大。

# excel - 如何以编程方式将工具栏按钮（和 OnClick 处理程序）添加到 Excel

> ID：593117
> 
> 赞同：3
> 
> 时间：2009-02-27T00:39:25.457
> 
> 标签：excel, vba, button, toolbar

如何以编程方式将工具栏（带有按钮）添加到 Excel（2002 或更高版本）？

单击按钮时，我想要一个处理程序来创建我的 COM 对象并在其上调用方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T13:02:28.137

这是应该在 Excel 2007 之前的版本上工作的基础，***但不包括***Excel 2007，它具有完全不同的界面。

这在您的 ThisWorkbook 模块中：

```
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    DeleteCommandBar
End Sub
Private Sub Workbook_Open()
    ShowToolbar
End Sub 
```

这可以放在同一个模块中，也可以放在一个单独的模块中，你可以选择，尽管我更喜欢将它放在它自己的模块中，这样它可以更明显。你不应该需要 OnClick，当你创建按钮时，按钮会被告知要调用什么例程。

```
Private Const TOOLBARNAME = "MyFunkyNewToolbar"

Public Sub ShowToolbar()
' Assumes toolbar not already loaded '
    Application.CommandBars.Add TOOLBARNAME
    AddButton "Button caption", "This is a tooltip", 526, "NameOfASubInYourVBACode"
    ' call AddButton more times for more buttons '
    With Application.CommandBars(TOOLBARNAME)
        .Visible = True
        .Position = msoBarTop
    End With
End Sub

Private Sub AddButton(caption As String, tooltip As String, faceId as Long, methodName As String)
Dim Btn As CommandBarButton
    Set Btn = Application.CommandBars(TOOLBARNAME).Controls.Add
    With Btn
        .Style = msoButtonIcon
        .FaceId = faceId ' choose from a world of possible images in Excel: see http://www.ozgrid.com/forum/showthread.php?t=39992 '
        .OnAction = methodName
        .TooltipText = tooltip
    End With        
End Sub

Public Sub DeleteCommandBar()
    Application.CommandBars(TOOLBARNAME).Delete
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T02:38:46.000

您可以[编写一个 Excel 插件，使用您的按钮和 COM 调用代码创建一个工具栏](http://www.contextures.com/xlToolbar02.html)，然后将您创建的 .xla 文件放到用户的[XLStart 文件夹](http://support.microsoft.com/kb/291218)中。

# regex - 非字符串的正则表达式

> ID：593140
> 
> 赞同：2
> 
> 时间：2009-02-27T00:49:29.850
> 
> 标签：regex

我想知道是否存在非字符串的顺序数据的正则表达式之类的东西。

我知道正则表达式本质上归结为 DFA，但我对指定这些 DFA 的高级语言更感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T01:39:39.947

您可以争辩说，语法是一种正则表达式，用于处理比字符串更复杂的事物。原则上，您可以在其他标记上设计正则表达式，而不仅仅是字符。作为一种选择，您可以争辩说 Unicode 的正则表达式就是这样一种生物——它肯定不像经典的正则表达式那样匹配简单的字节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T01:40:47.447

即使“原子”不是字符，您也可以使用普通的无上下文解析器生成器（例如 Yacc / Bison）来生成常规语言解析器。通过挂钩扫描仪功能，您可以使语法解析“任何内容”，无论它是否是字符串。

另一件事是，在逻辑领域，有LTL和CTL等“时间逻辑”，它们基本上是“事件”的正则表达式的子集。LTL 中的逻辑公式通常被转换为有限状态自动机。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T17:57:58.783

在正则表达式的理论中，绝对没有任何东西可以阻止它们被应用于其他东西，而不仅仅是字符串。只是大多数正则表达式引擎实现都不允许这样做。

但是，如果您有一个正则表达式引擎允许您将字符串视为未编码的 8 位数据（有时称为或） `BINARY`，那么您可以使用该引擎来解析面向字节的二进制数据。`8BIT``ASCII-8BIT`

[Ragel](http://CompLang.Org/ragel/)是一种状态机编译器，专为解析二进制协议而设计。你用高级（类似正则表达式的）DSL 编写你的状态机，然后 Ragel 将它编译成你的目标语言——Ragel 目前支持 C、C++、Objective-C、D、Java 和 Ruby。

大多数函数式编程语言都具有强大的模式匹配功能，这些功能直接嵌入到语言本身中。这些工具可用于模式匹配二进制数据。其中一个例子是 Erlang 对[构建和模式匹配二进制数据结构](http://Erlang.Se/euc/00/bit_syntax.html)的支持。

[OMeta](http://TinLizzie.Org/ometa/)是一种模式匹配和模式转换语言，基本上是正则表达式的超集。它不仅支持字符串的匹配，还支持整数和任意对象的数组和列表的匹配。

# javascript - 有没有办法在没有 onsubmit() 的情况下在提交时触发 javascript 函数

> ID：593141
> 
> 赞同：1
> 
> 时间：2009-02-27T00:49:59.253
> 
> 标签：javascript, detect, onsubmit

我希望编写一个 javascript 函数，当用户提交表单时将触发该函数，但是我没有对提交按钮的编辑访问权限，因此我可以添加 onsubmit 函数。我可以添加一个`<script>`标签，所以如果我可以检测到提​​交，那么我可以执行我的代码。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T00:57:27.927

您可以通过 DOM（`getElementByID()`或`document.formname`想到）找到提交按钮，然后将提交按钮的`onsubmit`值设置为您选择的函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T00:53:45.690

> 但是我没有对提交按钮的编程访问权限，因此我可以添加 onsubmit 函数

这怎么可能？如果您在页面上执行 JavaScript，则可以访问整个 DOM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T01:13:09.463

您可以使用 attachEvent 或 addEventListener 为 DOM 对象附加事件。

例如 element = document.getElementById('submitButtonId'); element.addEventListener('click',doSomething,false);

而“doSomething”是函数名。

# iphone - 如何在 iPhone 上显示进度指示器覆盖/HUD？

> ID：593147
> 
> 赞同：23
> 
> 时间：2009-02-27T00:51:43.900
> 
> 标签：iphone, cocoa-touch, core-animation

我想在浮动在表格视图上的半透明框中显示进度指示器。换句话说，当下载表格内容时，我希望在它上面出现一个“更新”标签。

我已经在商店的几个应用程序中看到了这一点，特别是 Facebook（当你摇动重新加载时）和 Darkslide。

我的第一个冲动是创建一个半透明的 UIView，在其中放置一个 UILabel 和一个 UIProgressIndicatorView，并将其添加到视图层次结构中......但是在哪里？ ~~UIView 可能不会与它的兄弟姐妹重叠，所以我不能让它成为窗口的子视图。~~ 我也不能让它成为表格的子视图，因为它会随着表格内容上下滚动。

我想过创建一个新的 UIWindow，但文档基本上说*不要*。

我知道 CALayer 可以相互重叠，所以这是一个选择，但我不能在 CALayer 中放置进度指示器，可以吗？我应该滚动自己的进度指示器来动画 CALayer 而不是 UIView？

我对了解[私有 API](https://stackoverflow.com/questions/416015/iphone-development-non-documented-uiprogresshud-class)不感兴趣。

**编辑：**这个问题是基于一个错误的假设。NSViews（在 Mac OS X 上）可能不会重叠，但 iPhone 上的 UIViews 可能。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-09-16T08:36:50.170

我刚刚发布了我的 HUD 版本： [https ://github.com/y0n3l/LGViewHUD](https://github.com/y0n3l/LGViewHUD)

你可以很容易地得到这个结果：

```
#import "LGViewHUD.h"
.... 
LGViewHUD* hud = [LGViewHUD defaultHUD];
hud.activityIndicatorOn=YES;
hud.topText=@"The longer....";
hud.bottomText=@"The better !";
[hud showInView:self.view]; 
```

![在此处输入图像描述](https://i.stack.imgur.com/tZ9VN.png)

一旦任务结束，只需调用

```
[[LGViewHUD defaultHUD] hideWithAnimation:HUDAnimationHideFadeOut]; 
```

就是这样！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-27T01:25:44.147

您绝对可以重叠视图。只需将透明覆盖添加为 tableView 中的子视图。

来自 UIView 的文档：

> UIView 对象排列在 UIWindow 对象中，在子视图的嵌套层次结构中。视图层次结构中的父对象称为超级视图，子视图称为子视图。视图对象声称其封闭父视图的矩形区域，负责该区域内的所有绘图，并且有资格接收发生在其中的事件。同级视图能够毫无问题地重叠，从而允许复杂的视图放置。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-22T13:24:25.563

还有比较有名的[MBProgressHUD](https://github.com/jdg/MBProgressHUD)和[SVProgressHUD](https://github.com/samvermette/SVProgressHUD)
它们和@yonel 的HUD 是同一种

例子

```
[SVProgressHUD show];
[SVProgressHUD dismiss]; 
```

![SVProgressHUD 示例](https://i.stack.imgur.com/5KiQv.jpg) [MBProgressHUD](https://github.com/jdg/MBProgressHUD)现在似乎更受欢迎（如果我们基于 github 星）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T00:37:18.060

MainWindow.xib 中的任何对象都可以通过插座访问应用程序窗口。标准项目中的应用程序委托已经拥有它，但您可能希望将插座添加到需要显示进度覆盖的视图控制器。

由于在 UIKit 中 UIWindow 是一个 UIView（与 Cocoa 中的 NSWindow 与 NSView 不同），您可以简单地将进度视图添加为窗口的子视图：

`[window addSubview:progressView];`

progressView 将覆盖整个应用程序 UI。

此示例使用该技术淡出 Default.png 初始图像：

[http://michael.burford.net/2008/11/fading-defaultpng-when-iphone-app.html](http://michael.burford.net/2008/11/fading-defaultpng-when-iphone-app.html)

关于最近的编辑，从 MacOS X 10.5 Leopard NSView 开始，重叠是确定性的（它们总是可能重叠，你只是得到未确定的结果），尽管它具有不同的从前到后的顺序，具体取决于包含的视图是否支持图层或不。这很可能是将 CALayers 集成到 OS X 视图系统的副作用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-11-13T04:54:08.673

答：Apple 的文档非常棒。 [http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html)

目前我正在过度铺设透明视图（至少此时在餐巾纸的背面）。您可以使用它们来按住菜单按钮，在 3D 空间中移动它们，简直是疯了。

我的意思是这是一本宗教小册子还是什么？来自 NEXT 的家伙的惊人的东西：

> UIView 对象排列在 UIWindow 对象中，在子视图的嵌套层次结构中。视图层次结构中的父对象称为超级视图，子视图称为子视图。视图对象声称其封闭父视图的矩形区域，负责该区域内的所有绘图，并且有资格接收发生在其中的事件。同级视图能够毫无问题地重叠，从而允许复杂的视图放置。

# c# - 为什么在关闭 SqlDataReader 之前我不能使用 SqlConnection 实例？

> ID：593160
> 
> 赞同：1
> 
> 时间：2009-02-27T00:56:08.227
> 
> 标签：c#, .net, asp.net, ado.net

来自 MSDN：

> 在使用 SqlDataReader 时，关联的 SqlConnection 正忙于为 SqlDataReader 提供服务，除了关闭 SqlConnection 之外，无法对 SqlConnection 执行其他操作。在调用 SqlDataReader 的 Close 方法之前就是这种情况。例如，在调用 Close 之前，您无法检索输出参数。

a) 为什么不能将 SqlConnection 用于其他任何事情？毕竟，当`ExecuteQuery()`返回 SqlDataReader 对象时，数据库中的数据已经被检索并填充了 SqlDatareader 对象。因此，我不明白 SqlConnection 应该如何或为什么仍然服务 SqlDataReader 对象？！

`Close()`b) 更重要的是，出于什么原因在调用SqlDataReader之前检索输出参数是个坏主意？

c) 当上面的引用提到不能对 SqlConnection 执行其他操作时，它想到了什么操作？只是那些需要连接到远程 sql server，或者我们不能使用 SqlConnection 实例的任何成员？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T01:08:41.177

a）`ExecuteReader`返回时，数据尚未全部检索并填充到阅读器中，它可能仍在从数据库中流回。这就是全部的重点，`SqlDataReader`因为这样做比预先加载它更有效。

b) 由于表格数据流 (TDS) 协议的结构方式，您在阅读器完成之前无法检索输出参数。直到结果集数据之后，输出参数才会物理发送到流中。

c) 这意味着除了`Close`被记录为保证工作之外，没有任何操作。他们是否真的工作无关紧要，因为这是一个实现细节而不是合同，而针对实现细节进行编程是灾难的根源。

你为什么要重新使用连接呢？使用的连接`SqlConnection`在幕后池化，所以当你处理一个它并没有真正摆脱所有资源时，它只是将连接返回到池中。这意味着您可以在尽可能短的时间内使用连接，最好是在一个`using`块内，而不必担心这种类型的事情。只需在需要时创建一个新连接，不要费心尝试重复使用它们，因为它已经在幕后发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T01:14:38.587

嗯...您可以在 SQL Server 2005 中。请阅读此页面：

[http://msdn.microsoft.com/en-us/library/ms345109.aspx](http://msdn.microsoft.com/en-us/library/ms345109.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T01:21:52.830

SqlDataReader 不会一次性返回整个表，就像 StreamReader 不会返回整个文件一样。显然实际上它适用于小桌子，但只提供一个连接。不过，这是对网络访问使用阻塞 - 如果您需要异步执行其他操作，只需打开第二个连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-29T05:07:21.827

您发布的代码实际上是为与 jQuery 库一起运行而设计的。[您可以在http://jquery.com/](http://jquery.com/)找到有关 jQuery 的更多信息。[Mootools，虽然也是一个 javascript 库，却是另一回事，您发布的代码将无法正常工作（您可以在http://mootools.net/](http://mootools.net/)了解有关 mootools 的更多信息）。

通过在您的页面/网站上包含此代码，您究竟想达到什么目的？

# .net - 哪里可以获得用于 Visual Studio 2008 的 Visual J# 合并模块？

> ID：593161
> 
> 赞同：1
> 
> 时间：2009-02-27T00:56:22.563
> 
> 标签：.net, visual-studio, j#, visualj#

我继承了一个依赖于第三方库的应用程序，而后者又依赖于 Visual J#.NET。

该应用程序以前是在 Visual Studio 2005 上开发的，我已经在 VS2008 上成功构建了它。

在其他组件中，它包括一个部署项目，该项目将几个可执行文件（加上依赖项，包括此库）构建到 Windows 安装程序 MSI 中。

由于 VJ# 依赖性，部署项目（显然）使用了 VJSharpRedist_x86.msm 合并模块。此合并模块似乎检测 VJ# 包的存在，如果未安装，则提示用户从 Web 下载它。

但是，目前我找不到任何包包含 VJ# 的合并模块。尽管项目构建没有错误，但生成的 MSI 无法安装。它启动，无法检测到机器上正确安装的 VJ#，然后显示一个对话框，其中只有文本“1：”和两个按钮“是”和“否”。单击“是”打开部署项目中指定的 url，单击“否”取消安装。

（打包到 MSI 中的可执行文件可以正常工作，如果它们被手动复制到机器上，但 MSI 拒绝安装它们。）

到目前为止，我已经安装了：

*   Visual Studio 2008 及其所有相关位。
*   .NET 3.5 SP1
*   .NET 1.1
*   .NET 1.1 SDK
*   [来自http://msdn.microsoft.com/en-au/vjsharp/bb188598.aspx](http://msdn.microsoft.com/en-au/vjsharp/bb188598.aspx)的 Visual J# 2.0
*   [来自http://msdn.microsoft.com/en-au/vjsharp/bb188598.aspx](http://msdn.microsoft.com/en-au/vjsharp/bb188598.aspx)的 Visual J# 1.1

有谁知道合并模块在哪里？或者如何在 VS2008 中正确处理这种启动条件？

编辑：澄清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-07T10:09:56.640

要添加`Visual J# .NET Redistributable Package 2.0`到项目先决条件，请复制：

> `C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages\VJSharpRDP`

到

> `C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages`

然后你需要进入你的部署项目，打开`Launch Conditions Editor`并删除条件`Visual J# .NET`（这就是删除可怕的空白对话框的原因）。

此时 setup.exe 确保`J#`在您的项目 msi 启动之前安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T01:02:37.290

这可能不是您想听到的答案，但 VJSharpRedist_x86.msm[不应该用于重新分发](http://msdn.microsoft.com/en-us/library/8f5w2e95(VS.80).aspx)：

> VJSharpRedist_x86.msm 不得用于重新分发 Microsoft Visual J# Redistributable Package
> 
> Visual J# Redistributable Package 的合并模块不是可再发行合并模块。它作为检查依赖项的机制添加到项目中，默认情况下被排除在外。
> 
> [http://msdn.microsoft.com/en-us/library/8f5w2e95(VS.80).aspx](http://msdn.microsoft.com/en-us/library/8f5w2e95(VS.80).aspx)

看起来 MSM 只是一个包装器，用于检查目标机器上是否预安装了适当的 J# 运行时。您可能会发现已经下载的 Visual J# Redist 就足够了。

# grails - 在 Grails 应用程序中实现“记住我”

> ID：593165
> 
> 赞同：5
> 
> 时间：2009-02-27T01:00:01.663
> 
> 标签：grails, cookies, jsecurity

我如何在 Grails 中实现“记住我”功能，以便用户可以检查它并且他不必在 2 周内再次登录？

我正在使用 jSecurity 插件并希望在浏览器会话之外更改 cookie 的生命周期。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T02:42:04.603

JSecurity 已经支持 RememberMe 功能。看一下AuthorizationController，你会发现它支持参数“rememberMe”。

为了实现两周的超时，我将添加另一个 cookie 并修改 AuthorizationController 以相应地运行。JSecurity 中可能有该功能，对此不确定 - 控制器似乎不尊重它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T09:52:10.293

[Spring security（以前的 acegi security）](http://www.grails.org/AcegiSecurity+Plugin)有这个内置的，如果你可以使用那个插件的话。

否则，其他发布的解决方案效果很好。

# c# - NHibernate 2.0.1 中的可空日期时间

> ID：593166
> 
> 赞同：0
> 
> 时间：2009-02-27T01:00:21.523
> 
> 标签：c#, nhibernate, datetime, nullable

两个问题可能会立即显而易见，但我已经花了太长时间追踪它们：

1.  我已经设置了一个 AuditInterceptor 以便对实现我的 IAuditable 接口的实体进行自动审计，该接口的使用如下：

    公共类 AuditInterceptor : EmptyInterceptor { public override bool OnSave(object entity, object id, object[] state, string[] propertyNames, IType[] types) { var auditable = entity as IAuditable;

    ```
     if (auditable == null)
            return false;

        var now = DateTime.Now;
        auditable.CreateDate = now;
        auditable.ModifiedDate = now;

        return true;
    }

    public override bool OnFlushDirty(object entity, object id, object[] currentState,
        object[] previousState, string[] propertyNames, IType[] types)
    {
        var auditable = entity as IAuditable;

        if (auditable == null)
            return false;

        auditable.ModifiedDate = DateTime.Now;

        return true;
    } 
    ```

    }

这两个字段在数据库、POCO 和映射文件中都不能为空。但是，在保存时，在调用拦截器时（可以单步执行并查看设置为 DateTime.Now 的适用字段），仍然会引发 SqlDateTime 异常：

SqlDateTime 溢出。必须在 1753 年 1 月 1 日上午 12:00:00 到 9999 年 12 月 31 日晚上 11:59:59 之间

我之前在某个地方（映射文件、数据库、POCO）存在不匹配的地方看到过这种情况，其中 DateTime 在某些地方指定为空，而在其他地方不指定。但是，我已经检查过了，在这方面一切都很好。我可以在 SaveOrUpdate(entity) 之前手动设置值，它可以毫无问题地插入/保存。如果不手动设置它们，它就好像完全错过了拦截器（即使我知道不是），并且两个 DateTime 属性从未设置（因此被视为 DateTime.MinValue: 01/01/0001 ...）因此超出范围。但是在单步执行时，这些值已正确设置为 DateTime.Now。

怎么了？对于它的价值，我实际上之前也设置了一个事件监听器，它导致了同样的问题。

2.  现在对于一个必须在某个地方回答的愚蠢问题，但我找不到它：作为处理上述问题的一部分，我迅速检查是否使 DateTime 始终可以为空，但我知道其中一个重大变化NHibernate 2.* 是不再支持 NHibernate.Nullables。因此，您在映射文件中使用什么来映射可为空的 DateTime？类型？对于即：

可以理解的是不起作用：

```
<property name="CreateDate" column="CreateDate" type="DateTime?" not-null="false" /> 
```

并且不再支持：

```
<property name="ModifiedDate" column="ModifiedDate" type="Nullables.NHibernate.NullableDateTimeType, Nullables.NHibernate" not-null="false"/> 
```

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T01:41:28.303

这解释了它：

```
if (!(entity is IAuditable))
    return false;

DateTime now = DateTime.Now;
state[Array.IndexOf(propertyNames, "CreateDate")] = now;
state[Array.IndexOf(propertyNames, "ModifiedDate")] = now;

return true; 
```

但仍然想知道声明 DateTime 的 2.* 方式？在 NHibernate 映射文件中。

[更新] 在另一个问题中问它并得到了答案：[https](https://stackoverflow.com/questions/593236/nhibernate-2-mapping-files-how-to-define-nullable-datetime-type-datetime) ://stackoverflow.com/questions/593236/nhibernate-2-mapping-files-how-to-define-nullable-datetime-type-datetime e

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T01:16:03.880

你的第二个问题的答案：

[NHibernate 2.* 映射文件：如何定义可为空的 DateTime 类型（DateTime？）？](https://stackoverflow.com/questions/593236/nhibernate-2-mapping-files-how-to-define-nullable-datetime-type-datetime)

# c# - TableAdapter - 无密钥更新

> ID：593170
> 
> 赞同：0
> 
> 时间：2009-02-27T01:03:06.697
> 
> 标签：c#, .net, tableadapter

我是 .net c# 业务的新手，上周我创建了一个表单应用程序来对 SSIS 配置的数据进行洗牌。MS 的天才们决定不对我正在使用的表应用一个键——并且生成两个候选字段的复合键将不起作用，因为它们的组合长度太长。我不想通过添加自动增量字段来弄乱 [ssis 配置] 表模式。

因此，我在从 DataGridView 控件获取更新以使用 TableAdapter 时遇到了很多麻烦。

我需要更新语句来更新表集 a = x 其中 b = y 和 c = z。

我可以设置 TableAdapter 的更新方法吗，如果可以，如何设置。如果没有，该怎么办？

我看到这个自动生成的代码：

```
this._adapter.InsertCommand = new global::System.Data.SqlClient.SqlCommand();
            this._adapter.InsertCommand.Connection = this.Connection;
            this._adapter.InsertCommand.CommandText = "INSERT INTO [dbo].[SSIS Configurations Staging] ([ConfigurationFilter], [Configur" +
                "edValue], [PackagePath], [ConfiguredValueType]) VALUES (@ConfigurationFilter, @C" +
                "onfiguredValue, @PackagePath, @ConfiguredValueType)"; 
```

但在我的表单代码中，UpdateCommand 不可用。我假设这是因为上面的代码是一个类定义，在创建对象后我无法更改。我看到此代码建议不要更改，因为它是由 VS 自动生成的。

感谢您最出色的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T09:10:09.130

从您的代码中，我假设您正在使用设计器的类型化数据集。

没有主键是设计人员不会生成插入、更新或删除命令的众多原因之一。这是 CommandBuilder 的限制。

您可以使用属性窗口向 Apadapter 添加更新命令，但我建议您不要这样做，如果您稍后再次配置主查询，它会很高兴地放弃您的所有工作。相同的论点反对修改任何 *.Designer.cs 文件中的代码。

相反，双击带有适配器名称的标题。设计者将创建（如有必要）随附的非设计者源文件并将部分类的外部放入其中。不幸的是，这就是设计器在 C# 中的代码生成有多远，你必须从那里开始。（旁白：VB 设计者知道更多技巧）。

编辑：

您必须提供自己的 Update(...) 方法并设置 UpdateCommand 等。

```
 var updateCommand = new SqlCommand();
  ... 
```

# c# - 我如何确保列表 .Contains(T) 适用于我的自定义类？

> ID：593171
> 
> 赞同：2
> 
> 时间：2009-02-27T01:05:00.263
> 
> 标签：c#, .net-2.0

我使用 .net 2.0 (C#)

我有一个 Person 类，我从数据库中 pupulate List< Person> p 。

我知道我的列表有重复项，但是当我尝试[删除重复项](https://stackoverflow.com/questions/47752/remove-duplicates-from-a-listt-in-c/48275#48275)时，它们不会被删除。

我的 Person 类是否需要为 List< T>.Contains(T) 实现任何接口才能正常工作？

还有其他想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T01:13:02.617

你的 Person 类应该实现[IEquatable](http://msdn.microsoft.com/en-us/library/ms131187(VS.80).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T01:12:17.173

您应该重写**Equals**和**GetHashCode**方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T01:11:05.617

您引用的示例不是从列表中删除重复项的解决方案，它是一个接受列表并产生将排除重复项的迭代器的函数。如果您需要一次性删除整个列表的重复数据，则需要`IEnumerable<T>`从函数中获取返回的数据并将其传递给新的`List<T>`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T01:11:52.260

你需要在你的类中重载 Object.Equals(Object obj) 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T01:10:51.187

[文档](http://msdn.microsoft.com/en-us/library/bhkz42b3.aspx)说“此方法使用默认相等比较器确定相等`EqualityComparer(T).Default`”。

# c++ - 打破 ReadFile() 阻塞 - 命名管道 (Windows API)

> ID：593175
> 
> 赞同：24
> 
> 时间：2009-02-27T01:07:01.507
> 
> 标签：c++, c, winapi, named-pipes

为简化起见，这是 NamedPipe SERVER 正在等待 NamedPipe CLIENT 写入管道的情况（使用 WriteFile()）

阻塞的 Windows API 是 ReadFile()

服务器已创建启用阻塞的同步管道（无重叠 I/O）

客户端已连接，现在服务器正在等待一些数据。

在正常的事情流程中，客户端发送一些数据，服务器处理它，然后返回到 ReadFile() 以等待下一个数据块。

同时发生了一个事件（例如用户输入），NamedPipe SERVER 现在必须执行一些其他代码，而在 ReadFile() 阻塞时它不能执行这些代码。

此时我需要提一下，NamedPipe Client 不是我的应用程序，所以我无法控制它。我不能让它发送几个字节来解除对服务器的阻塞。它只是坐在那里不发送任何数据。由于我无法控制客户端实现，因此我无法对此进行任何更改。

一种解决方案是创建一个单独的线程，在其中执行所有 ReadFile() 操作。这样当事件发生时，我就可以处理代码。问题在于该事件还需要一个单独的线程，所以现在我为该服务器的每个实例添加了两个额外的线程。由于这需要可扩展，因此这是不可取的。

从另一个线程我尝试过调用

```
 DisconnectNamedPipe() 
```

和

```
 CloseHandle() 
```

它们都不会返回（直到客户端写入管道。）

我无法连接到同一个管道并写入几个字节，因为：

“命名管道的所有实例共享相同的管道名称，但每个实例都有自己的缓冲区和句柄，并为客户端/服务器通信提供单独的管道。”

[http://msdn.microsoft.com/en-us/library/aa365590.aspx](http://msdn.microsoft.com/en-us/library/aa365590.aspx)

我需要一种方法来伪造它，所以 64,000 美元的问题是：

如何打破 ReadFile() 的阻塞？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-08-04T12:51:05.873

在 ReadFile 之前试试这个：

```
BOOL WINAPI PeekNamedPipe(
  __in       HANDLE hNamedPipe,
  __out_opt  LPVOID lpBuffer,
  __in       DWORD nBufferSize,
  __out_opt  LPDWORD lpBytesRead,
  __out_opt  LPDWORD lpTotalBytesAvail,
  __out_opt  LPDWORD lpBytesLeftThisMessage
);

if(TotalBytesAvail > 0)
  ReadFile(....); 
```

-AV-

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T03:01:42.433

看看 CancelSynchronousIo

> 将由指定线程发出的挂起的同步 I/O 操作标记为已取消。

和 CancelIo/CancelIoEx：

> 要取消所有挂起的异步 I/O 操作，请使用：
> 
> CancelIo — 此函数仅取消调用线程为指定文件句柄发出的操作。
> 
> CancelIoEx — 此函数取消线程为指定文件句柄发出的所有操作。

*   [http://msdn.microsoft.com/en-us/library/aa363794(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363794(VS.85).aspx)
*   [http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T01:46:31.647

麦克风，

您无法取消同步 ReadFile。但是您可以切换到异步（重叠）操作。通过这样做，您可以实现一个非常可扩展的架构。

可能的算法（只是一个想法）：

*   对于每个新客户端调用 ReadFile
*   句柄重叠的WaitForMultipleObjects.hEvent +您的自定义事件
*   迭代信号事件，并安排它们由线程池中的线程执行。

这样你就可以只有很少的线程来接收连接和读取数据，而实际的数据处理可以由线程池完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T01:14:31.380

> 问题在于该事件还需要一个单独的线程，所以现在我为该服务器的每个实例添加了两个额外的线程。由于这需要可扩展，因此这是不可取的。

在我的职业生涯中，我从未发现“更多线程”==“可扩展性更低”。你有多少这样的“服务器”实例？

通常，如果该操作将被阻塞并且系统需要在操作被阻塞时响应，则需要在单独的线程中执行该操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T03:26:16.153

如果异步 I/O 操作使用 I/O 完成端口，则它们不必阻塞任何线程。请参阅：http: [//msdn.microsoft.com/en-us/library/aa365198 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-23T18:57:29.460

发生的情况是，当您的客户端尝试连接到服务器入站管道（不再存在）时，服务器出站管道处于打开状态等待连接......您需要做的是清除出站管道以便循环回到您的入站。您可以通过读取文件在客户端刷新（记住循环连接建立，因为那里有一个“握手”，它永远不会第一次工作）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-05T05:54:48.017

只需使用`SetNamedPipeHandleState`函数 [https://docs.microsoft.com/en-us/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate](https://docs.microsoft.com/en-us/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate)

调用此函数时使用`PIPE_NOWAIT`标志。

`hNamedPipe`应该是从`CreateFile`函数返回的句柄。

之后，`ReadFile`当没有可用数据时，调用不会阻塞线程。

# css - PDF 上的图层

> ID：593176
> 
> 赞同：22
> 
> 时间：2009-02-27T01:07:22.490
> 
> 标签：css, pdf, html, always-on-top

所以，我面临的问题是这样的：我有一个图层，它将被放置在页面上的 pdf 之上。PDF 要么用于嵌入，要么用于 iframe 以包含它。但是，CSS 样式不适用于 PDF（因为它是一个插件？）。因此，即使我将 z-index:1000 放在 ，该层仍然位于 PDF 后面。知道如何解决吗？

这是代码：

```
<style type="text/css">
<!--#apDiv1 {
    position:absolute;
    left:543px;
    top:16px;
    width:206px;
    height:223px;
    z-index:1000;
    background-color:#999999;
}
</style>
<body>
  <!-- embed the pdf  -->
<object data="test.pdf" type="application/pdf" width="600" height="500" style="z-index:1" wmode="opaque">
  alt : <a href="test.pdf">test.pdf</a>
</object>

  <!-- layer -->

<div id="apDiv1" >Whatever text or object here.</div>
</body> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-02T22:33:40.330

在阅读了一些论坛之后......（这里有一些评论）

PDF 由 Acrobat Reader 插件加载。它有点做它自己的事情，与任何 HTML 甚至浏览器无关（除了由浏览器加载）。人们对 Flash 插件也有同样的问题，并且没有解决方案。所以我想也没有解决方案。你最好的办法是重新设计你的菜单，这样它们就不会进入 pdf 占据的空间。

如果它是一个插件，那么您不能可靠地将其他元素放在它的顶部。当涉及插件时，浏览器通常会放弃大部分“分层”元素的能力。

没有直接支持在 Api 或 Dom 中覆盖“z-indexing”一个 div。插件加载一个可执行文件，简单来说，就是在浏览器窗口上打了一个洞。使用“iframe shim”技术是标准的解决方法，尽管透明度可能很棘手。

我的解决方案：两个 iframe，每个都在一个具有不同 z-index 的 div 中，当您单击黄色 div 时，会显示空 iframe（在 pdf iframe 前面），因此您可以在 pdf 文档中看到绿色 div。

```
<html>
<head>
     <script type="text/javascript">
        function showHideElement(element){
            var elem = document.getElementById(element);

            if (elem.style.display=="none"){
                elem.style.display="block"
            }
            else{
                elem.style.display="none"
            }
        }
    </script>
</head>
<body>
    <div style="position:absolute;height:100px;width:100px;background-color:Yellow;" onclick="showHideElement('Iframe1');">click me</div>
    <div style="position:absolute;z-index:100;background-color:Green;height:100px;width:100px;margin-left:200px;"></div>

    <div style="position:absolute;z-index:20;margin-left:200px;">
    <iframe visible="true"  id="Iframe1" height="100" width="100" runat="server" frameborder="0" scrolling="auto" >

     </iframe>
     </div>

    <div style="position:absolute;z-index:10;margin-left:100px;">
    <iframe visible="true" id="ipdf" src="http://www.irs.gov/pub/irs-pdf/fw4.pdf" height="1000" width="1000" runat="server" frameborder="0" scrolling="auto" >

     </iframe>
     </div>

</body>
</html> 
```

费尔南多·罗德里格斯 frodale@gmail.com

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T01:24:30.810

有一个 jquery 插件[bgiframe](http://plugins.jquery.com/bgiframe/)，它使实现这个修复相当简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T01:21:24.267

通常，您可以通过将 iframe shim 直接放在 div 下方来解决这些 z-index 问题。也就是说，它具有相同的大小和位置（但没有实际内容）。我不是 100% 确定这适用于 PDF，但我知道这修复了一些其他 z-index 问题（例如 IE6 上的选择框）。

如果您动态放置 div，iframe 垫片可能会很痛苦，因为您必须使用它来移动 iframe 垫片。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-20T20:32:02.733

我刚刚找到了解决方案。使用 iframe 中的 google pdf 查看器在页面上显示您的 pdf，然后它就像任何其他 div 一样工作。

例子：

> <iframe id="ifr" src="http://docs.google.com/gview?url=http://www.mysite.com/test.pdf&embedded=true" style="width:718px; height:700px ;" frameborder="0">

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T01:17:10.733

如果您的测试是 IE，那么它可能与 ComboBox 的问题相同。尝试将 iframe 插入 div。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-29T18:07:39.993

某些情况下的解决方案是用 div 包装 iframe，并在 div 或 iframe 父级上使用样式属性“clip”。

```
<!DOCTYPE html>
<html>
<head>
    <title>Test Page - IFramed PDF Document Clipping</title>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type='text/javascript'></script>

        <style type='text/css'>
            body {padding:0em;margin:0em;font-size:16px;position:relative;}
            body * {line-height:1em;}
            #TOPNAV {list-style:none;display:block;}
            #TOPNAV li {display:inline;}
            #IFRAMEWRAPPER 
            {
                display:block;margin:0em;padding:0em;
                position:fixed;width:auto;left:0.125em;right:0.125em;top:4.125em;bottom:0.125em;
            }
            #docFrame {width:100%;height:100%;position:relative;margin:0em;padding:0em;}
            input.ACTIVE {background-color:Gray;outline:0.125em solid silver;}
            .clearfix {zoom:1;}
        </style>

        <script type='text/javascript'>
            $(document).ready(function () {

                $('#TOPNAV input').click(function () {
                    $("#TOPNAV input.ACTIVE").toggleClass('ACTIVE');
                    $(this).toggleClass('ACTIVE');
                    $("#IFRAMEWRAPPER").css("padding", "1em");
                    $("#IFRAMEWRAPPER").css("padding", "0em");

                    $("#IFRAMEWRAPPER iframe").toggleClass("clearfix");
                    $("#IFRAMEWRAPPER").toggleClass("clearfix");
                    $("#IFRAMEWRAPPER").hide();
                    $("#IFRAMEWRAPPER").slideDown(2);
                });

                $('#btnCLICK1').click(function () {
                    $("#IFRAMEWRAPPER").css("clip", "rect(auto, auto, auto, 5em)");
                });
                $('#btnCLICK2').click(function () {
                    $("#IFRAMEWRAPPER").css("clip", "rect(auto, 5em, auto, auto)");
                });
                $('#btnCLICK3').click(function () {
                    $("#IFRAMEWRAPPER").css("clip", "rect(5em, auto, auto, auto)");
                });
                $('#btnCLICK4').click(function () {
                    $("#IFRAMEWRAPPER").css("clip", "rect(auto, auto, 5em, auto)");
                });
            });
        </script>
</head>
<body>
<div class='TOPNAVWRAPPER'>
    <ul id='TOPNAV'>
        <li><input type='button' id='btnCLICK1' value='RIGHT' /></li>
        <li><input type='button' id='btnCLICK2' value='LEFT' /></li>
        <li><input type='button' id='btnCLICK3' value='BOTTOM' /></li>
        <li><input type='button' id='btnCLICK4' value='TOP' /></li>
    </ul>
</div>
<div id="IFRAMEWRAPPER">
    <iframe id='docFrame' name='TargetFrame' src="YOUR-PDF-DOCUMENT.pdf" onloadeddata='' seamless='seamless' ></iframe>
</div>

</body>
</html> 
```

# wpf - 为什么 e.Source 依赖于 TreeView 填充方法？

> ID：593194
> 
> 赞同：3
> 
> 时间：2009-02-27T01:21:06.730
> 
> 标签：wpf, treeview, event-handling

我有两棵树：

1.  fooTree - 由元素组成，
2.  barTree - 由

两棵树都有 MouseRightButtonDown 事件，但 e.Source 类型不同：

1.  fooTree - System.Windows.Controls.TreeViewItem
2.  barTree - System.Windows.Controls.TreeView

为什么 e.Source 不同？另外，我怎样才能获得 barTree 的点击项？

标记：

```
 <TreeView Name="fooTree" MouseRightButtonDown="fooTree_MouseDown">
        <TreeViewItem Header="foo"></TreeViewItem>
        <TreeViewItem Header="foo"></TreeViewItem>
    </TreeView>

    <TreeView Name="barTree" MouseRightButtonDown="barTree_MouseDown" ItemsSource="{Binding BarItems}">
        <TreeView.ItemTemplate>
            <HierarchicalDataTemplate>
                <TextBlock Text="{Binding}" />
            </HierarchicalDataTemplate>
        </TreeView.ItemTemplate>
    </TreeView> 
```

代码：

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
        this.DataContext = this;
    }

    public string[] BarItems
    {
        get { return new string[] { "bar", "bar" }; }
    }

    private void barTree_MouseDown(object sender, MouseButtonEventArgs e) 
    {
    }

    private void fooTree_MouseDown(object sender, MouseButtonEventArgs e) 
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T13:13:01.513

不知道为什么会这样，但至少我找到了解决方案：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f0d3af69-6ecc-4ddb-9526-588b72d5196b/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f0d3af69-6ecc-4ddb-9526-588b72d5196b/)

> 1.  如果您的处理程序位于 TreeView 上，请在事件参数中使用 OriginalSource 属性并沿着可视父链向上走，直到找到 TreeViewItem。然后，选择它。您可以使用 System.Windows.Media.VisualTreeHelper.GetParent 遍历可视父链。
>     
>     
> 2.  您可以尝试为 TreeViewItem 类型和鼠标按下事件注册一个类处理程序。然后，仅当鼠标事件通过 TreeViewItem 元素时才应调用您的处理程序。
>     
>     
> 3.  您可以为 TreeViewItem 类型和上下文菜单打开事件注册一个类处理程序。

所以我的代码是：

```
private void OnMouseRightButtonDown(object sender, MouseButtonEventArgs e)
{
    TreeViewItem treeViewItem = VisualUpwardSearch<TreeViewItem>(e.OriginalSource as DependencyObject) as TreeViewItem;
}

static DependencyObject VisualUpwardSearch<T>(DependencyObject source)
{
    while (source != null && source.GetType() != typeof(T))
        source = VisualTreeHelper.GetParent(source);

    return source;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T11:28:33.243

您可以使用以下命令在 bartree 中获取单击的项目：

```
((e.Source) as TreeView).SelectedValue 
```

但请注意，必须首先实际选择该项目（使用 leftMouse）。使用鼠标右键不会立即选择该项目...

# database - Oracle 中数字的默认精度和小数位数是多少？

> ID：593197
> 
> 赞同：79
> 
> 时间：2009-02-27T01:22:51.313
> 
> 标签：database, oracle, number-formatting

在 Oracle 中创建 NUMBER 类型的列时，您可以选择不指定精度或小数位数。如果您不指定它们，这些默认值会做什么？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-27T02:18:42.427

NUMBER（精度、比例）

如果未指定精度，则列存储给定值。如果未指定比例，则比例为零。

更多信息请访问：

[http://download.oracle.com/docs/cd/B28359_01/server.111/b28318/datatype.htm#CNCPT1832](http://download.oracle.com/docs/cd/B28359_01/server.111/b28318/datatype.htm#CNCPT1832)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-04-23T21:49:26.450

`NUMBER`可以用[不同的样式](http://docs.oracle.com/cd/E11882_01/server.112/e41084/sql_elements001.htm#sthref119)指定类型：

```
                结果 结果精度
规格 精度 刻度 检查 备注
―――――――――――――――――――――――――――――――――――――――――――――――― ――――――――――――――――――――――――――――――
NUMBER NULL NULL NO          '最大范围和精度' ,
                                                 值“按给定”存储
NUMBER(P, S) PS YES 错误代码：ORA-01438
NUMBER(P) P 0 是 错误代码：ORA-01438
号码(*, S) 38 S 否

```

其中精度是总位数，比例是小数点右侧或左侧（负比例）的位数。

Oracle 将 ORA-01438 指定为

> 此列允许的值大于指定精度

如表中所述，此完整性检查仅在明确指定精度时才有效。否则，Oracle 会使用某种未指定的方法默默地舍入插入或更新的值。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-27T01:37:02.463

我相信默认精度为 38，默认比例为零。但是，此列实例的实际大小是动态的。存储该值将占用尽可能多的空间，或最多 21 个字节。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-02T17:34:53.400

`Oracle`以以下方式存储数字：`1 byte`对于幂，`1 byte`对于第一个有效数字（即分隔符之前的一个），其余的用于其他数字。

这里`digits`的`Oracle`意思是`centesimal digits`（即`base 100`）

```
SQL> INSERT INTO t_numtest VALUES (LPAD('9', 125, '9'))
  2  /

1 row inserted

SQL> INSERT INTO t_numtest VALUES (LPAD('7', 125, '7'))
  2  /

1 row inserted

SQL> INSERT INTO t_numtest VALUES (LPAD('9', 126, '9'))
  2  /

INSERT INTO t_numtest VALUES (LPAD('9', 126, '9'))

ORA-01426: numeric overflow

SQL> SELECT DUMP(num) FROM t_numtest;

DUMP(NUM)
--------------------------------------------------------------------------------
Typ=2 Len=2: 255,11
Typ=2 Len=21: 255,8,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79 
```

正如我们所看到的，这里的最大数是`7.(7) * 10^124`，并且他有`19`百分位表示精度，或`38`小数位。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-07T09:01:20.617

实际上，您可以随时自行测试。

`CREATE TABLE CUSTOMERS ( CUSTOMER_ID NUMBER NOT NULL, JOIN_DATE DATE NOT NULL, CUSTOMER_STATUS VARCHAR2(8) NOT NULL, CUSTOMER_NAME VARCHAR2(20) NOT NULL, CREDITRATING VARCHAR2(10) ) ;`

`select column_name, data_type, nullable, data_length, data_precision, data_scale from user_tab_columns where table_name ='CUSTOMERS';`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-12-18T09:50:04.093

我扩展了光谱的答案，因此人们不必自己尝试。

这是在 Oracle Database 11g Express Edition Release 11.2.0.2.0 - Production 上完成的。

```
CREATE TABLE CUSTOMERS
(
  CUSTOMER_ID NUMBER NOT NULL,
  FOO FLOAT NOT NULL,
  JOIN_DATE DATE NOT NULL,
  CUSTOMER_STATUS VARCHAR2(8) NOT NULL,
  CUSTOMER_NAME VARCHAR2(20) NOT NULL,
  CREDITRATING VARCHAR2(10)
);

select column_name, data_type, nullable, data_length, data_precision, data_scale
from user_tab_columns where table_name ='CUSTOMERS'; 
```

哪个产量

```
COLUMN_NAME      DATA_TYPE  NULLABLE DATA_LENGTH DATA_PRECISION DATA_SCALE
CUSTOMER_ID      NUMBER     N        22        
FOO              FLOAT      N        22          126    
JOIN_DATE        DATE       N        7        
CUSTOMER_STATUS  VARCHAR2   N        8        
CUSTOMER_NAME    VARCHAR2   N        20        
CREDITRATING     VARCHAR2   Y        10 
```

# c# - 零参数的动作委托

> ID：593205
> 
> 赞同：25
> 
> 时间：2009-02-27T01:30:27.723
> 
> 标签：c#, delegates, action

我在许多使用 Action 委托的在线示例中看到了这一行：

```
public event Action MyEvent; 
```

但是当我在自己的代码中尝试时，我得到了这个错误

> 使用泛型“System.Action”需要“1”类型参数

该文档当然描述了一种没有任何类型参数的 Action 形式。我错过了什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-27T03:51:18.103

扩展安德鲁斯的答案。

在非 3.5 场景中使用 Action 是完全合法的。只需自己定义即可。

```
public delegate void Action(); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-27T01:40:05.203

确保您的应用程序正在引用`System.Core`.

编辑 - 还要确保您的目标是 .NET 3.5，因为 System.Core.dll 是该版本的一部分。

# html - 如何设置 HTML Frame 的背景颜色？

> ID：593212
> 
> 赞同：5
> 
> 时间：2009-02-27T01:33:31.227
> 
> 标签：html, frames

我有一个使用框架的旧网站。框架内的页面不使用白色背景，因此，当框架中的页面转换时，我会得到一个恼人的“白色闪光”。我认为这可以通过更改背景颜色来解决`<frame>`，但无论输入什么，Internet Explorer 除了白色之外什么都看不到。Firefox 似乎接受背景颜色，但 IE 不接受。

注意：请不要在使用框架时激怒我——我知道；哎呀，我想我什至已经讲过一段时间了……哈哈……

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T01:38:06.957

我发现了这条相当晦涩的信息；

注意这个`**AllowTransparency**`属性——这就是诀窍——现在，RightBackground 类可以按预期设置颜色。如果没有该属性，颜色将保持白色 (#ffffff)，无论如何。

可以在这里找到参考：http: [//www.blooberry.com/indexdot/html/tagpages/f/frame.htm](http://www.blooberry.com/indexdot/html/tagpages/f/frame.htm)

```
<frame  allowTransparency="true" class="RightBackground" src="BottomRight.asp" marginheight="0" marginwidth="10px" name="BottomRight" /> 
```

仅供参考， RightBackground 的内容只是设置背景颜色：

```
 <style type="text/css">
  .RightBackground
  {
     background-color: #EAF4D9;
  }
 </style> 
```

# intellij-idea - 如何关闭 IntelliJ 编辑器中的无限空白？

> ID：593214
> 
> 赞同：547
> 
> 时间：2009-02-27T01:35:12.627
> 
> 标签：intellij-idea, editor, text-cursor

如何在 IntelliJ 中删除行尾后移动光标的功能？

* * *

## 回答 #1

> 赞同：787
> 
> 时间：2009-02-27T01:51:06.363

文件菜单 -> 设置 -> 编辑器 -> 常规 -> 虚拟空间并取消选中“允许在行尾放置插入符”。您也可以取消选中“虚拟空间”面板中的其他选项。

* * *

## 回答 #2

> 赞同：232
> 
> 时间：2014-05-06T07:59:28.460

如果其他答案似乎不起作用，您可能已`Column Selection Mode`启用。在我的 Mac 上，它映射到`Cmd`++ `Shift`。`8`它位于**编辑**菜单下。启用该模式时，该菜单项将显示一个小复选标记。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-04-07T07:56:58.307

要在单击一行时获得尊重**缩进的预期行为：**

在*首选项 > 编辑器 > 虚拟空间*

*检查*：

> 允许在选项卡内放置插入符号。

*取消选中*：

> 允许在行尾后放置插入符号。

这对我来说真的很烦人，并且作为默认行为对我来说毫无意义。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-06-30T10:47:55.160

请注意，对于 Intellij IDEA 11 for mac，设置位于 IntelliJ IDEA 菜单下并称为首选项。（也许某种mac默认值？）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-08-04T15:34:43.897

Matt_Bro 所说的（第一个答案），但如果您已经在首选项中取消选中该框，请尝试重新检查它（我检查了所有虚拟空间框）并重新启动。然后取消选中并点击应用——此时我已禁用无限空间。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-12-06T21:02:45.130

### IntelliJ IDEA 2016

默认情况下，它是**关闭的**（未选中）。

如果已打开，您可以使用以下**两种方法**之一：

1.  **文件**>**设置...**（或`Ctrl`++ `Alt`）`S`>**编辑器**>**常规**>虚拟空间部分>取消选中**允许在行尾放置插入符号**

    [![文件 > 设置](https://i.stack.imgur.com/3WyUQ.png)](https://i.stack.imgur.com/3WyUQ.png)

    [![编辑器一般允许放置](https://i.stack.imgur.com/bv7oG.png)](https://i.stack.imgur.com/bv7oG.png)

2.  **帮助**>**查找操作...**（或`Ctrl`++ `Shift`）`A`> 键入“**虚拟空间：允许结束**”>`Enter`或左键单击（在打开和关闭之间切换）>`Esc`

    [![帮助 > 查找操作](https://i.stack.imgur.com/WKciK.png)](https://i.stack.imgur.com/WKciK.png)

    [![允许插入符号打开关闭](https://i.stack.imgur.com/Nf72S.png)](https://i.stack.imgur.com/Nf72S.png)

# asp.net - 何时最好使用新类而不是添加到现有类

> ID：593220
> 
> 赞同：0
> 
> 时间：2009-02-27T01:38:48.887
> 
> 标签：asp.net, sql, vb.net, class, class-design

我的 Web 应用程序的业务层中有一个名为 Player 的类。

Player 类具有 PlayerID、CategoryID 和 CountryID 字段

Player 类中的一个函数调用数据访问层中 PlayerDB 类中的一个函数，该函数又调用一个存储的过程，该过程从 Player 表中返回 PlayerID、CategoryID（Category 表的外键）和 CountryID（Country 表的外键）的数据.

我现在有一种情况，我想将 Country Name 和 Country Image（url 路径）添加到上述调用中，从 Country 表中返回每个 CountryID 的新字段。

我的问题是，我是否将国家名称和国家形象作为附加字段添加到 Player 类，或者我是否有名为 Country(BLL) 和 CountryDB(DAL) 的新类和一个新的存储过程？

我想做最好的做法，而不是最简单的方法。

如果它是相关的，我正在使用 ASP.NET、VB.NET 和 SQL2005。

正如您可能会告诉我的那样，我是一个新手，如果我没有在我的问题中使用正确的术语，请原谅我。我希望你能明白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T01:47:07.777

创建一个新类。如果它作为一个单独的逻辑实体有意义，那么它应该是它自己的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T01:54:34.637

听起来您可能应该创建一个新课程。

它确实取决于“播放器”类的用途。如果它是在应用程序的多个部分中使用的泛型类型（听起来确实如此），那么将应用程序的单个部分的自定义添加到 Player 类中可能是一件坏事。

但是，如果（例如）Player 类仅在您的应用程序的单个用户界面中使用，并且其目的是仅代表应用程序的该部分的 Player，那么添加这些字段可能是合理的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T03:35:59.543

您可以创建一个国家类，并使用对象组合，使国家类成为玩家类的属性。

```
Public Property Country() as BLL.Country
' etc 
```

然后你会调用这样的方法：

```
Dim p as BLL.Player
a = p.Country.ID
b = p.Country.Name
c = p.Country.Image
d = p.ID
e = p.CategoryID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T01:55:21.843

我发现每当我不得不问这个问题时，答案总是创建一个新课程。我认为我从未见过有太多类的系统，或者有两个本应是一个的系统。

曾经。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T06:00:28.510

你将如何使用国家数据？你会一直在写作`player.getCountry().getName()`吗？如果是这样，您可以编写一个内部`player.getCountryName()`调用的函数`country.getName()`。

[研究得墨忒耳法则](http://en.wikipedia.org/wiki/Law_Of_Demeter)，它说你应该限制你的来电者对你内部的了解程度。

# c# - 使用 LINQ 检索节点的描述和类别

> ID：593227
> 
> 赞同：0
> 
> 时间：2009-02-27T01:42:16.070
> 
> 标签：c#, linq

我有以下标签

```
<NodeA desc="Household">
    <NodeA desc="Cheap"> 
       <NodeA desc="Cheap Item 1" category="Cooking" />   
       <NodeA desc="Cheap Item 2" category="Gardening" />
    </NodeA>
 </NodeA>
 <NodeA> ...and so on 
```

在一个乐于助人的人的帮助下，我必须使用以下方法检索类别列表：

```
.Where(attr => attr.Name == "category")
.Select(attr => attr.Value); 
```

现在我想同时检索“desc”和“category”。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T01:48:09.863

像这样的东西......（未经测试）

```
from c in context
where c.Attribute("category") == "category name"
select new
{
  Description = c.Attribute("desc"),
  Category =  c.Attribute("category")
} 
```

完全未经测试，但这些方面的东西应该可以工作。

# ruby - 多次执行 ruby 块的剩余部分

> ID：593228
> 
> 赞同：1
> 
> 时间：2009-02-27T01:43:22.637
> 
> 标签：ruby, continuations

我正在制定一个框架来指定可能涉及选择的流程。我让它在每个选择都是一个岛屿的地方工作。我更喜欢子选择“分叉”父选择，以便正确考虑所有选项。

```
choose :one => lambda {
    choose [a, b]
    if a
      raise "Illegal"
    end
  },
  :two => .... 
```

目前，它总是会选择“a”（它本身看起来更好）但会导致问题进一步下降。Action :one 永远不会考虑选项'b'。

我遇到过 callcc （根据我所读到的内容，不能移植到所有 Ruby 实现）和纤维（1.9 中的新功能，不能假定可用）作为可能被说服工作的东西，但我对有两个实现或者其中任何一个的黑魔法并不疯狂，真的。

* * *

我最终采取了简单的方法并将剩余的计算作为一个块传递。当我看到与现有结构的相似性时，这变得不那么痛苦了。我只是希望缩进不会脱节。

实际情况要复杂得多——有副作用，但它们包含在版本化的键值存储中。我也在列举所有可能性并选择最好的一个，所以它不能仅仅停留在成功上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T01:56:19.393

您可能需要查看 [this quiz][1] 的解决方案以获取想法。

——马库斯

[1]：[http](http://www.rubyquiz.com/quiz70.html) ://www.rubyquiz.com/quiz70.html “这个测验”

PS 我正在去演示文稿的路上，但如果没有其他人上台，我会回来查看并提供更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:29:47.900

回来，如约而至。

这里还有一些想法：

*   您可以将选择与 yield 链接在一起，以按顺序遍历排列。换句话说，choose 可以从传递给它的选项中构建一组嵌套迭代器，它们只会让步给链中的下一个迭代器。退出封闭块会让您在收益后立即返回；如果您需要更多（例如失败原因），您可以提出和救援。
*   三个 'r's（rescue、raise 和 retry）的时髦安排可能会做到这一点，同样的想法是，选择是嵌套选项主体或将它们嵌入到嵌套结构中。
*   如果选项便宜且无副作用，您可能希望只考虑生成所有排列并迭代它们。
*   如果它们不是无副作用的，您可能想尝试某种伪单子解决方案，您可以在其中懒惰地为每个排列生成 lambda。
*   或多或少等效（但与您最初的问题相去甚远）您可能可以为它们分配一个索引（如果您可以确定每个选择的基数，则最简单，但在任何情况下都可以使用分段索引）并遍历索引.
*   [光纤已向后移植到 1.8.x](http://timetobleed.com/fibers-implemented-for-ruby-1867/)

但考虑到所有因素，我认为你最好的答案是将你想要的功能包装在一个类或函数中，用 实现它[`callcc`](http://www.rubycentral.com/book/ref_m_kernel.html#Kernel.callcc)，然后根据需要在 this 的定义中或周围进行版本检测，以便在正确版本的红宝石。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T22:58:06.483

根据要求，这是我将选择与收益链接在一起的意思的示例。一个简单的实现可能看起来像这样：

```
def choose_one_of_each(choices,results,&block)
    if choices.empty?
        yield results
      else
        c = choices.dup
        var,val = c.shift
        choose(val) { |v|
            choose_one_of_each(c,results.update(var => v),&block)
            }
      end
    end

def choose(options,&block)
    case options
      when Hash  then choose_one_of_each options,{},&block
      when Range then options.each { |item| yield item rescue nil }
      else            options.each { |item| yield item rescue nil }
      end
    end 
```

你会像这样使用它（从你的例子中有所扩展，以显示部件如何交互）：

```
a = 7
b = 'frog'
choose(
    :one => [a,b], 
    :two => ['stay','go','punt'], 
    :three => {:how => ['in the car','in a boat','by magic'],:how_fast => 0..2 }
  ) do |choices|
     raise "illegal" if choices[:one] == a
     raise "You can't stay fast!" if choices[:two] == 'stay' and choices[:three][:how_fast] > 0
     raise "You go that slow!"    if choices[:two] == 'go'   and choices[:three][:how_fast] < 1
     print choices.inspect,"\n"
     end 
```

这会产生这样的东西（因为打印）：

```
{:three=>{:how=>"in the car", :how_fast=>0}, :one=>"frog", :two=>"stay"}
{:three=>{:how=>"in the car", :how_fast=>0}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"in the car", :how_fast=>1}, :one=>"frog", :two=>"go"}
{:three=>{:how=>"in the car", :how_fast=>1}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"in the car", :how_fast=>2}, :one=>"frog", :two=>"go"}
{:three=>{:how=>"in the car", :how_fast=>2}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"in a boat", :how_fast=>0}, :one=>"frog", :two=>"stay"}
{:three=>{:how=>"in a boat", :how_fast=>0}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"in a boat", :how_fast=>1}, :one=>"frog", :two=>"go"}
{:three=>{:how=>"in a boat", :how_fast=>1}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"in a boat", :how_fast=>2}, :one=>"frog", :two=>"go"}
{:three=>{:how=>"in a boat", :how_fast=>2}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"by magic", :how_fast=>0}, :one=>"frog", :two=>"stay"}
{:three=>{:how=>"by magic", :how_fast=>0}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"by magic", :how_fast=>1}, :one=>"frog", :two=>"go"}
{:three=>{:how=>"by magic", :how_fast=>1}, :one=>"frog", :two=>"punt"}
{:three=>{:how=>"by magic", :how_fast=>2}, :one=>"frog", :two=>"go"}
{:three=>{:how=>"by magic", :how_fast=>2}, :one=>"frog", :two=>"punt"} 
```

# cocoa - 在 Cocoa 中与货币作斗争

> ID：593230
> 
> 赞同：6
> 
> 时间：2009-02-27T01:45:22.787
> 
> 标签：cocoa, cocoa-touch, uitextfield, currency

我正在尝试做一些我认为相当简单的事情：让用户输入一个美元金额，将该金额存储在一个 NSNumber（NSDecimalNumber？）中，然后在稍后再次显示该金额格式化为货币。

我的麻烦不在于 setNumberStyle:NSNumberFormatterCurrencyStyle 并将浮点数显示为货币。问题更多在于所说的 numberFormatter 如何与这个 UITextField 一起工作。我可以找到几个例子。[11 月的这个帖子](https://stackoverflow.com/questions/276382/best-way-to-enter-numeric-values-with-decimal-points)和[这个](https://stackoverflow.com/questions/317311/obtaining-an-nsdecimalnumber-from-a-locale-specific-string)帖子给了我一些想法，但给我留下了更多问题。

我正在使用 UIKeyboardTypeNumberPad 键盘并了解我可能应该在显示时在字段中显示 $0.00（或任何本地货币格式），然后当用户输入数字以移动小数位时：

*   从显示 $0.00 开始
*   点击 2 键：显示 $0.02
*   点击 5 键：显示 $0.25
*   点击 4 键：显示 $2.54
*   点击 3 键：显示 $25.43

然后 [numberFormatter numberFromString:textField.text] 应该给我一个可以存储在我的 NSNumber 变量中的值。

可悲的是我仍在挣扎：这*真的*是最好/最简单的方法吗？如果是这样，那么也许有人可以帮助我实施？我觉得 UITextField 可能需要一个代表来响应每个按键，但不确定是什么，在哪里以及如何实现它？！任何示例代码？我将不胜感激！我从高处和低处搜索...

**Edit1：**所以我正在研究 NSFormatter 的**stringForObjectValue:**以及我能找到的最接近 benzado 推荐的东西：**UITextViewTextDidChangeNotification**。很难在其中任何一个上找到示例代码......所以如果你知道在哪里看，请告诉我？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-05-29T15:57:34.477

我的解决方案：

```
 - (BOOL)textField:(UITextField *)textField
    shouldChangeCharactersInRange:(NSRange)range 
    replacementString:(NSString *)string
{
  // Clear all characters that are not numbers
  // (like currency symbols or dividers)
  NSString *cleanCentString = [[textField.text
    componentsSeparatedByCharactersInSet:
    [[NSCharacterSet decimalDigitCharacterSet] invertedSet]]
      componentsJoinedByString:@""];
  // Parse final integer value
  NSInteger centAmount = cleanCentString.integerValue;
  // Check the user input
  if (string.length > 0)
  {
    // Digit added
    centAmount = centAmount * 10 + string.integerValue;
  }
  else
  {
    // Digit deleted
    centAmount = centAmount / 10;
  }
  // Update call amount value
  [_amount release];
  _amount = [[NSNumber alloc] initWithFloat:(float)centAmount / 100.0f];
  // Write amount with currency symbols to the textfield
  NSNumberFormatter *_currencyFormatter = [[NSNumberFormatter alloc] init];
  [_currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
  [_currencyFormatter setCurrencyCode:@"USD"];
  [_currencyFormatter setNegativeFormat:@"-¤#,##0.00"];
  textField.text = [_currencyFormatter stringFromNumber:_amount];
  [_currencyFormatter release]
  // Since we already wrote our changes to the textfield
  // we don't want to change the textfield again
  return NO;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T06:03:22.887

如果我现在必须写，这是我会使用的粗略攻击计划。诀窍是在隐藏的 UITextField 中键入内容，并在用户键入时使用格式化值更新 UILabel。

1.  创建一个 UITextField，将其隐藏，为其分配一个委托，然后使其成为召唤键盘的第一响应者。
2.  在您的委托中，通过获取文本字段的新值并将其转换为数字来响应 textDidChange: 消息（懒得查找确切名称）。确保空字符串转换为零。
3.  通过您的格式化程序运行该数字，并使用该格式化货币值更新 UILabel。

每次按键时，标签都会更新，因此用户会感觉好像她正在编辑格式化的值，而*实际上*她正在编辑隐藏的文本字段。多么狡猾！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-21T16:17:36.607

好吧，我认为这更好：

```
- (void)viewWillDisappear:(BOOL)animated{ [[NSNotificationCenter defaultCenter] removeObserver:self  name:UITextFieldTextDidChangeNotification object:nil]; }

-(void)viewDidAppear:(BOOL)animated{
 [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(textDidChanged:) name:UITextFieldTextDidChangeNotification object:nil];
}

-(void)textDidChanged:(NSNotification *)notification{
 [[NSNotificationCenter defaultCenter] removeObserver:self  name:UITextFieldTextDidChangeNotification object:nil];
 UITextField * textField= [notification object];
 NSString * sinPesos= [textField.text stringByReplacingOccurrencesOfString:@"$" withString:@""];
 NSString * sinPuntos= [sinPesos stringByReplacingOccurrencesOfString:@"." withString:@""];

 float monto = [sinPuntos floatValue]; 

 monto= monto/100;

 NSString * cardText= [[self montoFormatter] stringFromNumber:[NSNumber numberWithDouble:monto]]; 

 textField.text = ([cardText isEqualToString: @"0"] ? @"":cardText);
 [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(textDidChanged:) name:UITextFieldTextDidChangeNotification object:nil];
} 

-(NSNumberFormatter *)montoFormatter{
 NSNumberFormatter* numberFormatter = [[NSNumberFormatter alloc] init];
 [numberFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
 [numberFormatter setMaximumFractionDigits:2];
 return [numberFormatter autorelease];
} 
```

试试看 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-08T14:00:19.417

由于我很懒惰，而且我不能忍受即时重新格式化我的输入“以帮助我”，我说：

让他们输入一个十进制数。当他们离开现场时，重新格式化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-19T18:27:08.943

好吧，这有点晚了，但我想我还是会试一试。这可能更像是一种解决方法，并且可能是混乱的代码，但它对我有用。我在 IB 中连接了一个标签和一个隐藏的文本字段，并使用 UITextFieldDelegate 委托编写了这段代码。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    if (textField == fineHiddenTextField) {
        NSString *fineText = [textField.text stringByReplacingCharactersInRange:range withString:string];
        if ([fineText length] == 0) {
            NSString *emptyFine = @"0.00";
            float fineValue = [emptyFine floatValue];
            fineEntryLabel.text = [NSString stringWithFormat:@"%.2f", fineValue];
        } else if ([fineText length] == 1) {
            NSString *firstDec = [NSString stringWithFormat:@"0.0%@", fineText];
            float fineValue = [firstDec floatValue];
            fineEntryLabel.text = [NSString stringWithFormat:@"%.2f", fineValue];
        } else if ([fineText length] == 2) {
            NSString *secondDec = [NSString stringWithFormat:@"0.%@", fineText];
            float fineValue = [secondDec floatValue];
            fineEntryLabel.text = [NSString stringWithFormat:@"%.2f", fineValue];
        } else {
            int decimalPlace = [fineText length] - 2;
            NSString *fineDollarAmt = [fineText substringToIndex:decimalPlace];
            NSString *fineCentsAmt = [fineText substringFromIndex:decimalPlace];
            NSString *finalFineValue = [NSString stringWithFormat:@"%@.%@", fineDollarAmt, fineCentsAmt];
            float fineValue = [finalFineValue floatValue];
            fineEntryLabel.text = [NSString stringWithFormat:@"%.2f", fineValue];
        }

        //fineEntryLabel.text = [NSString stringWithFormat:@"%.2f", fineValue];
        return YES;
    }
} 
```

不完全是最整洁的，但它确实完成了工作。最初的 if 语句只是为了确保这只发生在这个特定的 textField 上（因为在同一页面中有多个。）这段代码用于输入钱（支付的罚款金额），我想要它简单易用。只需将您的标签设置为从右侧对齐，它应该。

我现在对咖啡有点迷恋，但我会回答你可能有的任何问题。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-18T03:21:41.120

这是我的解决方案！

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{
    float valorUnit = [textField.text floatValue];

    if( string.length > 0)
    {
        float incremento = [string floatValue];

        valorUnit = valorUnit * 10.f + (incremento/100.f);
        NSString* strVal = [NSString stringWithFormat:@"%f", valorUnit];

        if (valorUnit > 0.f && valorUnit < 10.f) {
            textField.text  = [strVal substringToIndex:3];
        }
        else if (valorUnit < 100.f && valorUnit >= 10.f)
        {
            textField.text  = [strVal substringToIndex:4];
        }
        else if (valorUnit >=100.f && valorUnit <1000.f)
        {
            textField.text  = [strVal substringToIndex:5];
        }
        else {
            return NO;
        }

    }
    else {
        valorUnit = (valorUnit/10.f);
        NSString* strVal = [NSString stringWithFormat:@"%f", valorUnit];
        if (valorUnit > 0.f && valorUnit < 10.f) {
            textField.text  = [strVal substringToIndex:5];
        }
        else if (valorUnit < 100.f && valorUnit >= 10.f)
        {
            textField.text  = [strVal substringToIndex:6];
        }
        else if (valorUnit >=100.f && valorUnit <1000.f)
        {
            textField.text  = [strVal substringToIndex:7];
        }
        else {
            return NO;
        }
    }

return YES; 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-31T17:31:29.403

我写了一个开源`UITextField`子类来处理这个问题，可以在这里找到：

[https://github.com/TomSwift/TSCurrencyTextField](https://github.com/TomSwift/TSCurrencyTextField)

我采用的方法类似于 Lars Schneider 在他的流行回答中建议的方法。但是我的版本完全封装在一个可以在任何地方使用的可重用组件中，就像 UITextField 一样。如果您选择实现任何 UITextFieldDelegate 方法，则可以，但这不是必需的。

# iphone - 如何在 iPhone 上使用活动指示器视图？

> ID：593234
> 
> 赞同：65
> 
> 时间：2009-02-27T01:46:31.570
> 
> 标签：iphone, android-activity, indicator

活动指示器视图在许多应用程序中都很有用。关于如何在 iPhone 上添加、激活和关闭活动指示器视图的任何想法？

这里欢迎所有方法。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-03-02T18:35:17.810

创造：

```
spinner = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
[spinner setCenter:CGPointMake(kScreenWidth/2.0, kScreenHeight/2.0)]; // I do this because I'm in landscape mode
[self.view addSubview:spinner]; // spinner is not visible until started 
```

开始：

```
[spinner startAnimating]; 
```

停止：

```
 [spinner stopAnimating]; 
```

最终完成后，从视图中移除微调器并释放。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-27T05:46:13.333

看看开源的 WordPress 应用程序。他们创建了一个非常可重用的窗口，用于在您的应用程序当前显示的任何视图之上显示“正在进行的活动”类型的显示。

[http://iphone.trac.wordpress.org/browser/trunk](http://iphone.trac.wordpress.org/browser/trunk)

你想要的文件是：

*   WPActivityIndi​​cator.xib
*   圆角矩形黑色.png
*   WPActivityIndi​​cator.h
*   WPActivityIndi​​cator.m

然后显示它使用类似的东西：

```
[[WPActivityIndicator sharedActivityIndicator] show]; 
```

并隐藏：

```
[[WPActivityIndicator sharedActivityIndicator] hide]; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-04-18T18:06:34.927

关于：

> 看看开源的 WordPress 应用程序。他们创建了一个非常可重用的窗口，用于在您的应用程序当前显示的任何视图之上显示“正在进行的活动”类型的显示。

请注意，如果您确实使用此代码，则必须将您自己的应用程序的所有源代码提供给任何请求它的用户。您需要注意，他们可能会决定重新打包您的代码并自己在商店中出售。这一切都是根据 GNU 通用公共许可证 (GPL) 的条款提供的。

如果您不想被迫打开源代码，那么您不能使用 wordpress iphone 应用程序中的任何内容，包括引用的活动进度窗口，而不强制 GPL 应用于您自己的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-27T01:50:02.387

这方面的文档非常清楚。它是一个 UIView 子类，因此您可以像使用任何其他视图一样使用它。开始/停止您使用的动画

```
[activityIndicator startAnimating];
[activityIndicator stopAnimating]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-22T08:57:24.363

***使用情节提要-***

**创造-**

*   转到 main.storyboard（可以在 Xcode 左侧的 Project Navigator 中找到）并从对象库中拖放“活动指示器视图”。

![对象库中的活动指示器视图](https://i.stack.imgur.com/jr6UE.png)

*   转到头文件并为 UIActivityIndi​​catorView 创建一个 IBOutlet-

    ```
     @interface ViewController : UIViewController

         @property (nonatomic,strong) IBOutlet UIActivityIndicatorView *activityIndicatorView;

     @end 
    ```

*   建立从 Outlets 到 UIActivityIndi​​catorView 的连接。

**开始：**

当您需要在实现文件 (.m) 中使用以下代码启动活动指示器时，请使用以下代码 -

```
 [self.activityIndicatorView startAnimating]; 
```

**停止：**

当您需要在实现文件 (.m) 中使用以下代码停止活动指示器时，请使用以下代码 -

```
 [self.activityIndicatorView stopAnimating]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-10T11:30:19.287

我认为你应该更好地使用隐藏。

```
activityIndicator.hidden = YES 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-19T10:59:26.117

活动指示器 2 秒显示并转到下一页

```
@property(strong,nonatomic)IBOutlet UIActivityIndicator *activityindctr;

-(void)viewDidload { [super viewDidload];[activityindctr startanimating]; [self performSelector:@selector(nextpage) withObject:nil afterDelay:2];}

-(void)nextpage{ [activityindctr stopAnimating]; [self performSegueWithIdentifier:@"nextviewcintroller" sender:self];} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-08T11:06:33.410

```
- (IBAction)toggleSpinner:(id)sender
{
    if (self.spinner.isAnimating)
    {
        [self.spinner stopAnimating];
        ((UIButton *)sender).titleLabel.text = @"Start spinning";
        [self.controlState setValue:[NSNumber numberWithBool:NO] forKey:@"SpinnerAnimatingState"];
    }
    else
    {
        [self.spinner startAnimating];
        ((UIButton *)sender).titleLabel.text = @"Stop spinning";
        [self.controlState setValue:[NSNumber numberWithBool:YES] forKey:@"SpinnerAnimatingState"];
    }
} 
```

# nhibernate - NHibernate 2.* 映射文件：如何定义可为空的 DateTime 类型（DateTime？）？

> ID：593236
> 
> 赞同：16
> 
> 时间：2009-02-27T01:46:59.977
> 
> 标签：nhibernate, datetime, nhibernate-mapping, nullable

我知道 NHibernate 2.* 的重大变化之一是不再支持 NHibernate.Nullables。因此，您在映射文件中使用什么来映射可为空的 DateTime？类型？对于即：

可以理解的是不起作用：

```
<property name="CreateDate" column="CreateDate" type="DateTime?" not-null="false" /> 
```

并且不再支持：

```
<property name="ModifiedDate" column="ModifiedDate" type="Nullables.NHibernate.NullableDateTimeType, Nullables.NHibernate" not-null="false"/> 
```

我知道它一定很明显，但我没有找到它！

答案很简单：NHibernate 将在有问题的类上进行反射，并发现属性的反射类型是 DateTime？全部靠自己。

谢谢@正义！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-27T01:49:22.967

```
<property name="CreatedDate" /> 
```

*   NHibernate 将在有问题的类上进行反射，并发现属性的反射类型是`DateTime?`完全独立的。
*   NHibernate 将默认列名与属性名相同，除非您另有说明。
*   NHibernate 将假定任何属性都可以为空 ( `not-null="false"`)，除非您另有说明。

如果你真的想要，它应该是......

```
<property name="CreatedDate" type="System.Nullable`1[[System.DateTime, mscorlib]], mscorlib" /> 
```

# php - 在将数据输出回文本区域时，如何正确清理从文本区域接收的数据？

> ID：593238
> 
> 赞同：7
> 
> 时间：2009-02-27T01:47:41.753
> 
> 标签：php, mysql, html, forms, sanitization

用户将在文本区域中输入文本。然后将其直接插入到 mySQL 数据库中。我在上面使用了 trim、htmlentities、mysql_real_escape_string 并且我启用了魔术引号。将该数据输出回文本区域时，我应该如何对其进行清理？

谢谢你的帮助。我从来没有太确定这样做的正确方法......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-27T01:51:13.647

`htmlentities`保存时不应使用。您应该`htmlentities`在显示它时使用。经验法则是在需要之前不要对数据进行编码/清理。如果您在保存时对它进行操作，那么当用户想要编辑输入时`htmlentities`您必须对文本进行操作。`html_entity_decode`因此，您可以根据需要进行消毒，仅此而已。保存时，您需要对 SQL 注入进行清理，这样就可以`mysql_real_escape_string`了。显示时，您需要对 XSS 进行清理，因此您可以这样`htmlentities`做。

另外，我不确定您是否看到了 Darryl Hein 的评论，但您确实不想启用 magic_quotes。[它们很糟糕，很糟糕，](http://en.wikipedia.org/wiki/Magic_quotes#Criticism)从 PHP 5.3 开始已被弃用，并且将在 PHP 6 中完全消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T02:00:59.443

除了 Paolo 关于何时使用的回答之外`htmlentities()`，除非您使用的是旧版本的 PHP，否则清理以插入 mysql DB 的正确方法是使用[准备好的语句](http://php.net/manual/en/mysqli.prepare.php)，它是[mysqli 扩展](http://php.net/mysqli)的一部分。这取代了任何需要使用`mysql_real_escape_string()`的 .

除此之外，我认为你已经涵盖了一些事情。

# cocoa - 你有没有使用过 NSZoneMalloc() 而不是 malloc()？

> ID：593241
> 
> 赞同：3
> 
> 时间：2009-02-27T01:49:20.517
> 
> 标签：cocoa, memory-management, history, next

Cocoa 提供了它称为[Memory Zones](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmZones.html)的页面对齐的内存区域，并提供了一些将区域作为参数的内存管理函数。

假设您需要分配一块内存（不是为对象，而是为任意数据）。如果您调用`malloc(size)`，缓冲区将始终分配在默认区域中。但是，有人可能习惯于`allocWithZone:`将您的对象分配到默认区域之外的另一个区域。在这种情况下，使用 似乎会更好`NSZoneMalloc([self zone], size)`，它将缓冲区和拥有对象保持在同一内存区域中。

你遵循这种做法吗？你有没有使用过内存区域？

更新：我认为 Stack Overflow 倾向于通过关于过早优化的讲座来回答有关低级主题的问题。我知道 1993 年 NeXT 硬件上的区域可能比现在更重要，而且谷歌搜索清楚地表明几乎没有人关心它们。无论如何，我都在问，看看是否有人可以描述一个他们使用内存区域的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T07:54:08.800

我为 NeXTStep、Linux 上的 GNUstep 和 Mac OS X 上的 Cocoa 编写了软件，并且从来不需要使用自定义内存区域。表明它是对软件的良好改进的条件要么从未出现，要么从未被检测为重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T02:33:48.477

您在整个问题中都是绝对正确的，但实际上，没有人真正使用区域。正如您链接到的页面所说：

> 在大多数情况下，使用默认区域比创建单独的区域更快、更有效。

建立自己的区域的好处是：

> 如果在尝试访问其中一个对象时发生页面错误，则加载页面会引入所有相关对象，这可以显着减少未来页面错误的数量。

如果发生页面错误，则意味着系统最近正在分页，因此无论如何都很慢，并且要么您的应用程序不负责，要么解决方案在您的应用程序的一部分中，该部分首先分配了过多的内存地方。

所以，基本上，问题是“你能否证明你确实需要创建自己的区域来解决性能问题或让你的应用程序变快”，答案是否定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T02:11:16.283

如果你发现自己在这样做，那么你的操作水平可能比你真正应该的水平低。子系统几乎忽略了它们；任何对等的调用`+alloc`都会让您在默认区域中获得对象。`malloc`并且`NSAllocateCollectable`是您需要知道的所有内容。

# c++ - 将 C++ 结构转储到文本文件

> ID：593244
> 
> 赞同：7
> 
> 时间：2009-02-27T01:50:17.223
> 
> 标签：c++, logging, file-io

如何将 C++ 中结构的内容写入文本文件？我想要做的是，假设我有一个名为 A 的结构，具有数据成员 A.one、A.two 等，我想将它们逐行写到文本文件中，就像这样

结构 A
A.one = 值
A.two = 值 ...

结构 B
B.one = 值
B.two = 值

基本上我想转储..有没有简单的方法可以做到这一点？最好的 I/O 方法是什么？文件？iostream？谢谢.. 有没有更简单的方法来转储一个类的成员数据的所有值？

* * *

编辑：废话，谢谢大家..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T01:58:11.027

在 C++ 中没有反射，因此您必须手动进行，例如（使用 iostream，为简单起见）：

```
dump_A(std::cout, "A", a);

void dump_A(std::iostream& os, const char* name, A const& a)
{
    os << "Structure " << name << '\n'
       << name << ".one = " << a.one << '\n'
       << name << ".two = " << a.two << '\n';
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T01:55:37.647

C++ 不是内省的。也就是说，它对其结构的内容一无所知。您必须使用某种手动注释或反射系统来执行此操作。

当然，如果您对有关结构的硬编码信息感到满意，您可以使用任何 I/O 方法转储信息。

例如：

```
struct A
{
  int member1;
  char member2;
};

void PrintA (const A& a)
{
  std::printf ("member1: %d\n", a.member1);
  std::printf ("member2: %c\n", b.member2);
} 
```

如您所见，这很乏味，因为它需要对结构有深入的了解，并且如果结构发生更改，也不会自动更新。但是反射系统“正确”执行此操作的开销可能是一个缺点，尤其是在您正在学习的情况下。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T02:44:10.510

我在 boost 序列化库方面取得了成功。它易于使用，是 C++ 数据结构序列化和反序列化的自然选择。

这是教程的链接：http: [//www.boost.org/doc/libs/1_38_0/libs/serialization/doc/index.html](http://www.boost.org/doc/libs/1_38_0/libs/serialization/doc/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T02:10:48.610

这更适用于 C 而不是 C++，但请记住，如果您确实将结构直接写入文件（或网络缓冲区），那么结果将取决于机器和编译器。整数将按主机字节顺序写入，结构的编译器填充字节也将包括在内。尝试在具有不同字节顺序或不同编译器指令的机器上读取缓冲区将不起作用

这会发生在类似的事情（请原谅语法）： write(f, &A, sizeof(A));

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T09:35:37.993

**如果**这只是一个*struct*，一个普通的旧 C 兼容数据类型，**没有虚拟方法**和**没有指针**，那么**作为一个短期的组合，**你可以使用：

```
struct Foo {  int a, b;  char c, d, e[50]; }  f;
write( fd, & f, sizeof(f) ); 
```

但是，不要期望这是跨平台的，甚至是同一平台上的跨编译器版本。

[我想我以前讨论过这个...](https://stackoverflow.com/questions/523872/how-do-you-serialize-an-object-in-c/523933#523933)

# iphone - iPhone Web 应用程序和特定输入类型

> ID：593245
> 
> 赞同：30
> 
> 时间：2009-02-27T01:50:30.140
> 
> 标签：iphone, safari, mobile-safari

我记得不久前看到过一个关于这个的教程，但我无法重新谷歌它。

据说有一种方法可以让 iPhone 上的 Safari 提供默认键盘以外的键盘。它是这样的，输入名称属性中的某些关键字触发了它......

这将给出默认键盘：

```
<input type="text" name="normal_text" /> 
```

这将给出数字输入键盘：

```
<input type="text" name="blah_blah_zip" /> 
```

这将给出数字输入键盘：

```
<input type="text" name="blah_blah_email" /> 
```

有谁知道这是否仍然是一个可用的功能，如果是，触发它的关键字是什么？谢谢！

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-11-05T00:00:54.667

[iPhone 版 Safari How-To](https://developer.apple.com/library/archive/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)表明这仍然可以使用不同的语法。

```
Text: <input type="text" /> <!-- display a standard keyboard -->
Telephone: <input type="tel" /> <!-- display a telephone keypad -->
URL: <input type="url" /> <!-- display a URL keyboard -->
Email: <input type="email" /> <!-- display an email keyboard -->
Zip Code: <input type="text" pattern="[0-9]*" /> <!-- display a numeric keyboard --> 
```

笔记：

> 要显示数字键盘，请将模式属性的值设置为“ `[0-9]*`”或“ `\d*`”。

# .net - Castle.ActiveRecord 中的大型 OR 表达式

> ID：593247
> 
> 赞同：2
> 
> 时间：2009-02-27T01:50:59.937
> 
> 标签：.net, castle-activerecord

我正在尝试在活动记录中进行伪模糊逻辑查询。

我该如何表达：

> field1 像'A' 或 field2 像'A' 或 field3 像'A' 或 field1 像'B' 或 field2 像'B' 或 field3 像'B'

使用 ICriteria 对象......“喜欢”需要是 InsensitiveLikeExpressions 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-28T03:55:43.043

这个怎么样：

```
 public T[] FuzzyFind<T>(string[] fields, string[] values) where T: class {
        var dis = new Disjunction();
        foreach (var f in fields)
            foreach (var v in values)
                dis.Add(new InsensitiveLikeExpression(f, v, MatchMode.Anywhere));
        return ActiveRecordMediator<T>.FindAll(dis);
    } 
```

然后你这样称呼它：

```
var locations = FuzzyFind<ARAddressableLocation>(new[] { "field1", "field2", "field3 }, new[] { "a", "b" }); 
```

它产生（字段，值）的所有组合

根据需要调整 MatchMode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T05:01:53.207

它不是 ICriteria 对象，但在 HQL 中，答案是这样的：

> ```
> string hql = "FROM ARAddressableLocation as al WHERE (LOWER(al.SubNumber) = '{0}' OR LOWER(al.Number) = '{0}' OR...";
> ARAddressableLocation[] obj = (ARAddressableLocation[])Execute(
>     delegate(ISession session, object instance) {
>       IQuery query = session.CreateQuery(hql);
>       IList results = query.List();
> 
>       ARAddressableLocation[] list = new ARAddressableLocation[results.Count];
>       results.CopyTo(list, 0);
> 
>       return list;
>     }, null); 
> ```

我的字段总是字符串，所以我选择将它们放入自己而不是使用 NHibernate 的参数。

（为答案投票将不胜感激）

# mysql - DRY 和类似的查询

> ID：593249
> 
> 赞同：3
> 
> 时间：2009-02-27T01:51:10.730
> 
> 标签：mysql, dry

在一个特定的应用程序上工作，我一次又一次地编写非常相似的查询。它们并不完全相同，但形式非常相似，并且嵌入在几乎相同的代码块中，*例如*，

```
$Mysqli = new mysqli;
if ($Stmt = $Mysqli->prepare("SELECT foo 
                              FROM tblFoo 
                              WHERE something = ?")) {
    $Stmt->bind_param('s', $this->_something);
    $Stmt->execute();
    if (0 != $Stmt->errno)
        throw new Exception("blah, blah, blah");
    $Stmt->bind_result($foo);
    while ($Stmt->fetch()){
        $this->_foos[] = new Foo($foo);
    }
    $Stmt->close();
    } else {
        throw new Exception("blah, blah, blah"););
    }
} 
```

后来，在其他地方......

```
$Mysqli = new mysqli;
if ($Stmt = $Mysqli->prepare("SELECT bar, baz 
                              FROM tblBar 
                              WHERE somethingElse = ?")) {
    $Stmt->bind_param('s', $this->_somethingElse);
    $Stmt->execute();
    if (0 != $Stmt->errno)
        throw new Exception("blah, blah, blah");
    $Stmt->bind_result($bar, $baz);
    while ($Stmt->fetch()){
        // do something else with $bar and $baz
    }
    $Stmt->close();
    } else {
        throw new Exception("blah, blah, blah"););
    }
} 
```

...然后另一个，在其他地方另一个...等等。

这真的违反了 DRY 吗？编写一个类来执行这种查询（使用构造函数参数或表、列、绑定变量等的设置器）然后在我的整个应用程序中重用它似乎没有意义。但与此同时，我无法摆脱这种我在重复自己的唠叨感。

也许只是写一个简单的查询的方法只有这么多，并且像这样的一定数量的重复是可以预料的。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T01:59:05.657

很多人正是这样做的。创建一个代表每个表的类，它们都继承自同一个类。基类可以处理加载和保存数据。因此，如果要加载数据，只需调用 load 方法即可。您可以通过对象的属性设置和访问字段值。

还有像[hibernate](http://www.hibernate.org/)这样的库可以为你处理很多脏活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T02:02:46.100

我会说这是违规行为。看一眼您的代码（除非我遗漏了什么），除了字符串“foo”和“bar”（重复几次）和您的实际业务逻辑之外，这两个语句是相同的。

至少你可以提取它。更重要的是，应该提取所有 SQL 字符串。对我来说，它们似乎更像是数据而不是代码。如果你有一个 SQL 字符串、表等数组——那会使重构更加明显吗？

（从代码中提取字符串和其他数据是开始重构的好方法）

一种可能性是，如果您有一个具有表名的对象和一个包含您的业务逻辑的方法，您可以将它传递给一个带有所有样板的“处理器”（这是您在那里拥有的所有其余代码）。

我认为这可能会使它变干。

（PS。总是更喜欢组合而不是继承。在可以“运行”您的对象的类上使用继承没有任何优势）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T03:43:38.463

您遇到了模块化的第一个愿望。:-)

有两种通用解决方案。第一个是抽象对所有（或大部分）类似查询的调用。然后再进行另一组查询。然后到另一个。等等。不幸的是，这导致许多块做同样的事情：调用查询，检查问题，组装结果集，将其传回。这是一个 DAL，但只是一种。它也无法扩展。

第二种解决方案是抽象进行查询并返回结果的过程，然后在此之上抽象数据访问（这基本上意味着您构建了一些组装 SQL 的东西）。这更有可能成为一个合适的 ORM 而不是一个简单的 DAL。扩展它要容易得多。

# asp.net - 如何使用 asp.net 页面实现一个简单的 AJAX 调用？

> ID：593254
> 
> 赞同：0
> 
> 时间：2009-02-27T01:54:17.057
> 
> 标签：asp.net, ajax

我正在尝试使用 asp.net 页面而不是 asp 页面来实现[这个特定的示例。](http://www.w3schools.com/AJAX/ajax_database.asp)如果您查看示例，您可以看到页面有 2 个部分：

1.  邮件asp页面。这个页面有 JS 代码调用其他 asp 文件供 AJAX 使用。
2.  另一个包含 JS 代码的 asp 页面。

调用的 responseText 是客户端代码，所以，当我写这样的东西时：

```
<html><head><title>test</title><script language="javascript" runat="server"
type="text/javascript">function test(){Response.Write("This is a Test!");
</script><body onload="test()"></body></html> 
```

该页面忽略我的服务器端代码并​​返回：

```
<html><head><title>test</title><body onload="test()"></body></html> 
```

我应该怎么做才能让他处理我的 JS 代码并返回它的输出？

在此先感谢，Oz Radiano。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T01:57:59.543

asp.net 不处理 javascript 服务器端，因此将脚本标记 runat=server 设置为 language="javascript" 将大部分被忽略。

我认为如果您将其更改为“JScript”，它将起作用，但是，这与 ajax 无关。

“runat = server”说，在服务器上对其进行预处理，不要将其发送给客户端。如果该语言是一种可处理的语言，它也会被评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T02:03:09.843

在观看来自[http://www.asp.net/learn/ajax-videos/](http://www.asp.net/learn/ajax-videos/)和[http://www.asp.net/learn/ajax/的一些视频后尝试实施该示例](http://www.asp.net/learn/ajax/)

在 asp.net 和 ASP 中实现 AJAX 非常容易。我可以清楚地给你正确的源代码。:) 但你似乎在尝试新事物。让我们知道怎么回事！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T01:57:21.603

感谢您的回复，他们让我明白我不确定我的问题是什么。

在实现[这个确切的例子](http://www.w3schools.com/AJAX/ajax%5Fdatabase.asp)失败后，我用谷歌搜索了“如何使用 ajax 运行 asp 代码”

[这个结果](http://www.codeproject.com/KB/webforms/UsingAJAXinASP.aspx)返回并说得很清楚。

再次感谢。

# .net - 即使将 Linq to SQL 纳入实体框架，我是否应该学习它？

> ID：593258
> 
> 赞同：5
> 
> 时间：2009-02-27T01:56:15.040
> 
> 标签：.net, entity-framework, linq-to-sql, devforce, object-relational-model

我正在寻找学习 Linq 来查询 MS SQL 数据库，但不确定要走哪条路。我最近读到，Linq to SQL 正在被整合到实体框架中，并且开发可能已经停滞不前。

还值得学习 Linq to SQL 吗？还是我应该专注于实体框架或其他对象关系模型，例如 Ideablade 的 Devforce，它正在转移到 Linq 作为查询语言？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T01:59:53.923

Linq to SQL 正在被整合到实体框架中，而这正是该团队投入精力的地方。因此，了解 Entity Framework 的发展可能是您的首要任务（我会把它当作我的。）

但是，如果您有循环，那么了解 Linq to SQL 并不会浪费时间。关于 Linq、表达式、延迟加载、延迟执行等还有很多可以借鉴的地方，并且在融合到 Entity Framework 之后很长时间仍然适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T02:43:01.823

我怀疑 LINQtoSQL 提供程序是否会消失，不过，扩展 LINQ 的重点似乎是实体框架。问题是实体框架目前真的很糟糕，IMO。我正在着手开发使用 LINQtoSQL 作为 ORM 的应用程序。我完全希望将来会提供语言支持。当 LINQtoEntities 赶上来时，我可能会研究它，尽管 LINQtoSQL 目前的化身似乎足以满足我的需求（我自己添加了一些调整）。[使用动态 LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)尤其如此，我用它来解决一些我无法解决的棘手问题（使用动态 LINQ，按属性排序要简单得多）。

您可能需要考虑为 nHibernate 使用[nHibernate](http://www.hibernate.org/343.html)和[LINQ](http://ayende.com/Blog/archive/2007/03/16/Linq-for-NHibernate.aspx)。

# delphi - 为什么有些数组可以发布而其他数组不能发布？

> ID：593260
> 
> 赞同：6
> 
> 时间：2009-02-27T01:57:49.543
> 
> 标签：delphi, arrays, properties, delphi-2009

```
type
   TStaticArray = array[1..10] of integer;
   TDynamicArray = array of integer;

   TMyClass = class(TObject)
   private
      FStaticArray: TStaticArray;
      FDynamicArray: TDynamicArray;
   published
      property staticArray: TStaticArray read FStaticArray write FStaticArray; //compiler chokes on this
      property dynamicArray: TDynamicArray read FDynamicArray write FDynamicArray; //compiler accepts this one just fine
   end; 
```

这里发生了什么？静态数组给出错误，“发布的属性'staticArray'不能是数组类型”但动态数组就可以了吗？我很困惑。任何人都知道这背后的原因，以及我该如何解决它？（不，我不想将我所有的静态数组重新声明为动态数组。它们的大小是有原因的。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T08:25:05.090

Published 声明告诉编译器将信息存储在虚拟方法表中。只能存储某些类型的信息。
已发布属性的类型不能是指针、记录或数组。如果是集合类型，它必须足够小才能存储为整数。
（奥莱利，简而言之，德尔菲）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T23:00:02.560

你必须有getter和setter。在 D2009 下（没有检查其他版本），getter/setter 的参数由于某种原因不能是 const。?

这在 D2009 下工作正常：

```
type
  TMyArray = array[0..20] of string;

type
  TMyClass=class(TObject)
  private
    FMyArray: TMyArray;
    function GetItem(Index: Integer): String;
    procedure SetItem(Index: Integer; Value: string);
  public
    property Items[Index: Integer]: string read GetItem write SetItem;
  end;

implementation

function TMyClass.GetItem(Index: Integer): string;
begin
  Result := '';
  if (Index > -1) and (Index < Length(FMyArray)) then
    Result := FMyArray[Index];
end;

procedure TMyClass.SetItem(Index: Integer; Value: string);
begin
  if (Index > -1) and (Index < Length(FMyArray)) then
    FMyArray[Index] := Value;
end; 
```

注意：显然，我通常不会忽略超出范围的索引值。这是一个如何在类定义中创建静态数组属性的快速示例；IOW，这只是一个可编译的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T06:59:41.160

您可以发布动态数组属性的原因是动态数组被实现为引用或“隐式指针”。它们的工作更像是弦乐，真的。

不能发布静态数组的原因，我不知道。这只是它的制作方式，我猜..

有关动态数组如何工作的更多详细信息，请查看[DrBobs 网站](http://www.drbob42.com/delphi4/dynarray.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-18T15:39:32.040

```
 TMyClass = class(TObject)
   private
     FStaticArray: TStaticArray;
     FIdx: Integer;
     function  GetFoo(Index: Integer): Integer;
     procedure SetFoo(Index: Integer; Value: Integer);
   public
     property Foo[Index: Integer] : Integer read GetFoo write SetFoo;
   published
     property Idx: Integer read fidx write fidx;
     property AFoo: Integer read GetAFoo writte SetAFoo;
   end;
implementation
function TMyClass.GetAFoo: Integer;
begin
  result := FStaticArray[FIdx];
end;
procedure TMyClass.SetAFoo(Value: Integer);
begin
  FStaticArray[FIdx] := Value;
end; 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-27T02:17:26.907

无法发布数组属性。所以下面的代码不起作用。解决方法可能是成功`public`。

```
 TMyClass = class(TObject)
   private
     FStaticArray: TStaticArray;

     function  GetFoo(Index: Integer): Integer;
     procedure SetFoo(Index: Integer; Value: Integer);
   public
     property Foo[Index: Integer] : Integer read GetFoo write SetFoo;
   end; 
```

# c# - 匹配整数列表的算法

> ID：593265
> 
> 赞同：4
> 
> 时间：2009-02-27T01:58:51.197
> 
> 标签：c#, .net, algorithm, matching

每天我们有大约 50,000 个数据结构实例（最终可能会变得更大），这些实例封装了以下内容：

```
DateTime AsOfDate;
int key;
List<int> values; // list of distinct integers 
```

这可能无关紧要，但该列表`values`是不同整数的列表，其属性对于给定的 值，所有值的`AsOfDate`联合产生不同整数的列表。也就是说，同一天没有整数出现在两个不同的列表中。`values``key``values`

列表通常包含很少的元素（1 到 5 个），但有时长达 50 个元素。

给定相邻的日子，我们试图找到这些对象的实例，它们的值`key`在两天内不同，但列表`values`包含相同的整数。

我们正在使用以下算法。通过将列表转换`values`为字符串

```
string signature = String.Join("|", values.OrderBy(n => n).ToArray()); 
```

然后散列`signature`到一个整数，对得到的散列码列表进行排序（每天一个列表），遍历两个列表以查找匹配项，然后检查关联的键是否不同。（还要检查相关列表以确保我们没有哈希冲突。）

有没有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T02:04:06.223

您可能只是散列列表本身，而不是通过字符串。

除此之外，我认为您的算法几乎是最佳的。假设没有哈希冲突，它是 O(n log n + m log m) 其中 n 和 m 是您正在比较的每一天的条目数。（排序是瓶颈。）

如果您使用插入哈希的存储桶数组（本质上是：哈希表），则可以在 O(n + m) 中执行此操作。您可以在 O(max(n, m)) 中比较两个存储桶数组，假设长度取决于条目的数量（以获得合理的负载因子）。

通过使用 HashSet.IntersectWith() 并编写合适的比较函数，应该可以让库为您执行此操作（看起来您正在使用.NET）。

你不能做得比 O(n + m) 更好，因为每个条目都需要至少访问一次。

编辑：误读，已修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T03:08:04.320

On top of the other answers you could make the process faster by creating a low-cost hash simply constructed of a XOR amongst all the elements of each List. You wouldn't have to order your list and all you would get is an `int` which is easier and faster to store than strings.

Then you only need to use the resulting XORed number as a key to a Hashtable and check for the existence of the key before inserting it. If there is already an existing key, only then do you sort the corresponding Lists and compare them.

You still need to compare them if you find a match because there may be some collisions using a simple XOR.
I think thought that the result would be much faster and have a much lower memory footprint than re-ordering arrays and converting them to strings.

If you were to have your own implementation of the `List<>`, then you could build the generation of the XOR key within it so it would be recalculated at each operation on the List.
This would make the process of checking duplicate lists even faster.

**Code**

Below is a first-attempt at implementing this.

```
Dictionary<int, List<List<int>>> checkHash = new Dictionary<int, List<List<int>>>();

public bool CheckDuplicate(List<int> theList) {
    bool isIdentical = false;
    int xorkey = 0;
    foreach (int v in theList) xorkey ^= v;

    List<List<int>> existingLists;
    checkHash.TryGetValue(xorkey, out existingLists);
    if (existingLists != null) {
        // Already in the dictionary. Check each stored list
        foreach (List<int> li in existingLists) {
            isIdentical = (theList.Count == li.Count);
            if (isIdentical) {
                // Check all elements
                foreach (int v in theList) {
                    if (!li.Contains(v)) {
                        isIdentical = false;
                        break;
                    }
                }
            }
            if (isIdentical) break;
        }
    }
    if (existingLists == null || !isIdentical) {
        // never seen this before, add it
        List<List<int>> newList = new List<List<int>>();
        newList.Add(theList);
        checkHash.Add(xorkey, newList);
    }
    return isIdentical;
} 
```

Not the most elegant or easiest to read at first sight, it's rather 'hackey' and I'm not even sure it performs better than the more elegant version from Guffa.
What it does though is take care of collision in the XOR key by storing Lists of `List<int>` in the Dictionary.

If a duplicate key is found, we loop through each previously stored List until we found a mismatch.

The good point about the code is that it should be probably as fast as you could get in most cases and still faster than compiling strings when there is a collision.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T03:10:12.443

Implement an IEqualityComparer for List, then you can use the list as a key in a dictionary.

If the lists are sorted, it could be as simple as this:

```
IntListEqualityComparer : IEqualityComparer<List<int>> {

   public int GetHashCode(List<int> list) {
      int code = 0;
      foreach (int value in list) code ^=value;
      return code;
   }

   public bool Equals(List<int> list1, List<int> list2) {
      if (list1.Count != list2.Coount) return false;
      for (int i = 0; i < list1.Count; i++) {
        if (list1[i] != list2[i]) return false;
      }
      return true;
   }

} 
```

Now you can create a dictionary that uses the IEqualityComparer:

```
Dictionary<List<int>, YourClass> day1 = new Dictionary<List<int>, YourClass>(new IntListEqualityComparer()); 
```

Add all the items from the first day in the dictionary, then loop through the items from the second day and check if the key exists in the dictionary. As the IEqualityComprarer both handles the hash code and the comparison, you will not get any false matches.

You may want to test some different methods of calculating the hash code. The one in the example works, but may not give the best efficiency for your specific data. The only requirement on the hash code for the dictionary to work is that the same list always gets the same hash code, so you can do pretty much what ever you want to calculate it. The goal is to get as many different hash codes as possible for the keys in your dictionary, so that there are as few items as possible in each bucket (with the same hash code).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T02:36:45.987

排序重要吗？即第 1 天的 [1,2] 和第 2 天的 [2,1]，它们是否相等？如果是这样，那么散列可能无法很好地工作。您可以改用排序数组/向量来帮助进行比较。

另外，它是什么样的钥匙？它是否有明确的范围（例如 0-63）？您可能能够将它们连接成大整数（可能需要超过 64 位的精度）和散列，而不是转换为字符串，因为这可能需要一段时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T04:02:00.090

将它放在 SQL 数据库中可能是值得的。如果您不想拥有完整的 DBMS，则可以使用 sqlite。

这将使唯一性检查和联合以及这些类型的操作非常简单的查询并且非常有效。如果再次需要它，它还可以让您轻松存储信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T04:02:48.667

您是否考虑对值列表求和以获得一个整数，该整数可用作不同列表是否包含相同值集的预检查？

虽然会有更多的冲突（相同的总和并不一定意味着相同的值集），但我认为它可以首先减少大部分所需的比较集。

# c - 连续运行应用程序

> ID：593273
> 
> 赞同：3
> 
> 时间：2009-02-27T02:02:27.600
> 
> 标签：c, performance

连续运行应用程序以使其在触底后不会退出的最聪明的方法是什么？相反，它从 main 的顶部重新开始，并且仅在收到命令时退出。（这是在 C 中）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T02:06:57.603

你应该总是有一些干净的退出方式。我建议将代码移到另一个函数，该函数返回一个标志来说明是否退出。

```
int main(int argc, char*argv[])
{

     // param parsing, init code

     while (DoStuff());

    // cleanup code
    return 0;
 }

 int DoStuff(void)
 {
     // code that you would have had in main

     if (we_should_exit)
         return 0;

     return 1;
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T02:33:49.693

大多数没有通过的应用程序进入某种事件处理循环，允许事件驱动编程。

例如，在 Win32 开发中，您将编写[WinMain](http://msdn.microsoft.com/en-us/library/ms633559(VS.85).aspx)函数来不断处理新消息，直到它收到告诉应用程序完成的 WM_QUIT 消息。此代码通常采用以下形式：

```
// ...meanwhile, somewhere inside WinMain()
MSG msg;
while (GetMessage(&msg, NULL, 0, 0))
{
     TranslateMessage(&msg);
     DispatchMessage(&msg);
} 
```

[如果您正在使用SDL](http://www.libsdl.org/)编写游戏，您将循环 SDL 事件直到决定退出，例如当您检测到用户按下 Esc 键时。执行此操作的一些代码可能类似于以下内容：

```
bool done = false;
while (!done)
{
    SDL_Event event;
    while (SDL_PollEvent(&event))
    {
        switch (event.type)
        {
            case SDL_QUIT:
                done = true;
                break;
            case SDL_KEYDOWN:
                if (event.key.keysym.sym == SDLK_ESCAPE)
                {
                    done = true;
                }
                break;
        }
    }
} 
```

您可能还想了解[Unix Daemons](http://en.wikipedia.org/wiki/Daemon_(computer_software))和[Windows 服务](http://en.wikipedia.org/wiki/Windows_service)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T02:04:20.183

```
while (true)
{
....
} 
```

更详细地说，您希望在该循环中放入一些东西，允许您让用户执行重复操作。无论是读取击键并根据按下的键执行操作，还是从套接字读取数据并发送回响应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T03:45:20.457

有多种方法可以“命令”您的应用程序退出（例如全局退出标志或返回码）。有些人已经谈到使用退出代码，所以我将提出一个简单的修改，以使用退出标志对现有程序进行修改。

假设您的程序执行系统调用以输出目录列表（完整目录或单个文件）：

```
int main (int argCount, char *argValue[]) {
    char *cmdLine;
    if (argCount < 2) {
        system ("ls");
    } else {
        cmdLine = malloc (strlen (argValue[1]) + 4);
        sprintf (cmdLine, "ls %s", argValue[1]);
        system (cmdLine);
    }
} 
```

在退出条件之前，我们如何进行该循环。采取以下步骤：

*   更改`main()`为`oldMain()`。
*   添加新的`exitFlag`.
*   添加新`main()`的以连续调用`oldMain()`，直到退出标记。
*   `oldMain()`在某个时候更改为信号退出。

这给出了以下代码：

```
static int exitFlag = 0;

int main (int argCount, char *argValue[]) {
    int retVal = 0;

    while (!exitFlag) {
        retVal = oldMain (argCount, argValue);
    }

    return retVal;
}

static int oldMain (int argCount, char *argValue[]) {
    char *cmdLine;
    if (argCount < 2) {
        system ("ls");
    } else {
        cmdLine = malloc (strlen (argValue[1]) + 4);
        sprintf (cmdLine, "ls %s", argValue[1]);
        system (cmdLine);
    }

    if (someCondition)
        exitFlag = 1;
} 
```

# .net - 如何以编程方式检查 Web 服务器是否启用了 http 压缩？

> ID：593285
> 
> 赞同：7
> 
> 时间：2009-02-27T02:10:48.937
> 
> 标签：.net, http, compression

我想检查 Web 服务器是否启用了 http 压缩，是否启用了特定的压缩（即 Gzip、Deflate、Compress）？

或者，如果我通过将 Accept-Encoding 设置为“gzip，deflate”通过 .net 中的 WebClient 对象请求数据，我如何知道检索到的数据在处理之前是否已压缩？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T02:16:48.157

要检查响应正文的编码是什么，您应该检查 HTTP 响应标头：Content-Encoding。

服务器只允许使用请求标头接受编码指定的编码。如果服务器无法使用指定的接受编码之一给出响应，则它必须以 406（不可接受）响应。

**示例请求：**

```
GET / HTTP/1.1
Host: www.brianbondy.com
Accept-Encoding: gzip,deflate 
```

**示例响应：**

```
HTTP/1.1 200 OK
Date: Thu, 04 Dec 2003 16:15:12 GMT
Server: Apache/2.0
Content-Encoding: gzip
Content-Length: 1533 
```

**接受编码的其他示例：**

```
 Accept-Encoding: compress, gzip
 Accept-Encoding:
 Accept-Encoding: *
 Accept-Encoding: compress;q=0.5, gzip;q=1.0
 Accept-Encoding: gzip;q=1.0, identity; q=0.5, *;q=0 
```

**如何确切地知道服务器上可用的编码：**

无法确切知道服务器级别可用的编码，因为某些服务器可能仅支持某些文件类型的某些编码。

这意味着你能做的最好的就是回答这个问题：对于请求第一行中指定的文件，该文件的特定编码是否可用？您可以通过明确拒绝身份内容编码并指定您想知道的编码来回答这个问题。

```
Accept-Encoding: gzip, identity;q=0 
```

[示例来源，HTTP RFC](http://www.w3.org/Protocols/rfc2616/rfc2616.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T02:17:41.837

从[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)：

> `4`. “身份”内容编码始终是可接受的，除非因为接受编码字段包含“身份；q=0”或因为该字段包含“*；q=0”且未明确包含“身份”而被明确拒绝内容编码。如果 Accept-Encoding 字段值是空的，那么只有“身份”编码是可接受的。

因此，如果您设置`Accept-Encoding: identity;q=0, gzip, deflate`强制服务器对其进行压缩，或者返回 406（不可接受）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-24T21:03:42.837

它可能会有所帮助。

[http://www.whatsmyip.org/http_compression/](http://www.whatsmyip.org/http_compression/)

# javascript - $(document).ready(function() 和 $(function() 有什么区别？

> ID：593292
> 
> 赞同：7
> 
> 时间：2009-02-27T02:15:57.550
> 
> 标签：javascript, jquery

所以我知道这是做什么的：

```
$(document).ready(function(){
    // Your code here...
}); 
```

现在我看到人们最近这样做：

```
<script type="text/javascript">     
$(function(){
    // Your code here...
});
</script> 
```

这两种方式做同样的事情吗？

我在这里看到在 jquery 选择器中声明了一个匿名函数，但实际上从未被调用过，但从页面运行的方式来看，这似乎只是在页面加载时运行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T02:18:05.347

是的，他们在做同样的事情。当调用的参数是单个函数对象时，函数会`$()`换行。`$(document).ready()`

（编辑以反映评论中的问题）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T02:21:09.550

是的，他们正在做同样的事情。

```
$(function(){
    // Your code here...
}); 
```

是一个捷径

```
$(document).ready(function(){
    // Your code here...
}); 
```

# iphone - Linux、Windows 上的 iPhone 开发

> ID：593304
> 
> 赞同：2
> 
> 时间：2009-02-27T02:22:32.013
> 
> 标签：iphone

我将在一个月左右的时间内购买一台 Mac，但我想在我真正拿到我的 Mac 之前开始使用 Iphone 应用程序。这在 xp 或 ubuntu 上可行吗？我知道我将无法为 iPhone 编译或测试它以获取我的 mac，但也许我可以完成很多前期工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T02:24:58.810

如果你足够勇敢，你可以将你的 PC 变成一个 hackintosh 并双启动进入 Leopard。在获得 Mac 之前，我做了几个月的 iPhone 开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T02:37:18.887

是的，您可以使用 VMWare 来运行 MacOS X。我不会链接到任何站点，但有许多下载可用于 VMWare 的被黑 OSX 映像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T02:38:06.640

你可以做一个 Hackintosh 但要注意：

1.  Apple 可以并且确实会强制 iPhone 开发人员更新到最新的操作系统以处理最新的 iPhone SDK。您的 hackintosh 将比官方操作系统更新滞后几周或几个月，直到 Kalyway 团队（或任何人）让它工作并稳定。因此，当这种情况发生时，您实际上会被锁定在较旧的固件开发中。

2.  Hackintoshes 因突然无法工作而臭名昭著，而且由于您在安装某些东西时进行了一些内部调整而根本无法启动。当然不是你的，你很棒，当然会随时保留整个操作系统分区的完整备份来处理这个问题。这是一个皮塔饼。

3.  在商用硬件上安装 Mac OS X 需要做一些事情。这是一个痛苦的屁股，我花了大约 20 次安装操作系统才能正确。你当然很棒，而且会做得更快，而且头痛更少。

4.  Hackintoshes（和一般的个人电脑）很吵。与我的 Mac Pro 相比，Gamer-spec 粉丝等声音很大，Mac Pro 像坟墓一样安静地坐在这里。这没什么大不了的，但我的机器声音有多大确实让我很紧张。

简而言之，您可以做到，但几乎不值得付出努力。不过，当你第一次将它引导到 OS X 时，你确实会得到一笔费用，这很整洁。但对于严肃的生产用途？花 500 美元买一台 Mac Mini，然后开始工作。如果您像我一样，您的时间比您为一台真正的 Mac 支付的少量费用更有价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T02:24:44.237

不要这么想。也许你可以建立一个hackintosh。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T02:28:53.590

我从我们 cocoaheads 的某个人那里听说他们设法找到了适用于 OS X 的 VMWare 映像

# silverlight - 计算属性的 PropertyChanged 通知

> ID：593306
> 
> 赞同：8
> 
> 时间：2009-02-27T02:24:27.937
> 
> 标签：silverlight, properties, inotifypropertychanged

我正在 Silverlight2 中开发应用程序并尝试遵循 Model-View-ViewModel 模式。我将某些控件上的 IsEnabled 属性绑定到 ViewModel 上的布尔属性。

当这些属性派生自其他属性时，我遇到了问题。假设我有一个保存按钮，我只想在可以保存时启用它（数据已加载，我们目前不忙于在数据库中做事）。

所以我有几个这样的属性：

```
 private bool m_DatabaseBusy;
    public bool DatabaseBusy
    {
        get { return m_DatabaseBusy; }
        set
        {
            if (m_DatabaseBusy != value)
            {
                m_DatabaseBusy = value;
                OnPropertyChanged("DatabaseBusy");
            }
        }
    }

    private bool m_IsLoaded;
    public bool IsLoaded
    {
        get { return m_IsLoaded; }
        set
        {
            if (m_IsLoaded != value)
            {
                m_IsLoaded = value;
                OnPropertyChanged("IsLoaded");
            }
        }
    } 
```

现在我想做的是：

```
public bool CanSave
{
     get { return this.IsLoaded && !this.DatabaseBusy; }
} 
```

但请注意缺少属性更改通知。

所以问题是：什么是公开我可以绑定到的单个布尔属性的干净方法，但是计算而不是显式设置并提供通知以便 UI 可以正确更新？

**编辑：** *感谢大家的帮助 - 我开始着手制作自定义属性。我在这里发布源代码以防有人感兴趣。我确信它可以以更清洁的方式完成，所以如果您发现任何缺陷，请添加评论或答案。*

基本上我所做的是创建一个接口，它定义了一个键值对列表来保存哪些属性取决于其他属性：

```
public interface INotifyDependentPropertyChanged
{
    // key,value = parent_property_name, child_property_name, where child depends on parent.
    List<KeyValuePair<string, string>> DependentPropertyList{get;}
} 
```

然后我在每个属性上都设置了属性：

```
[AttributeUsage(AttributeTargets.Property, AllowMultiple = true, Inherited = false)]
public class NotifyDependsOnAttribute : Attribute
{
    public string DependsOn { get; set; }
    public NotifyDependsOnAttribute(string dependsOn)
    {
        this.DependsOn = dependsOn;
    }

    public static void BuildDependentPropertyList(object obj)
    {
        if (obj == null)
        {
            throw new ArgumentNullException("obj");
        }

        var obj_interface = (obj as INotifyDependentPropertyChanged);

        if (obj_interface == null)
        {
            throw new Exception(string.Format("Type {0} does not implement INotifyDependentPropertyChanged.",obj.GetType().Name));
        }

        obj_interface.DependentPropertyList.Clear();

        // Build the list of dependent properties.
        foreach (var property in obj.GetType().GetProperties())
        {
            // Find all of our attributes (may be multiple).
            var attributeArray = (NotifyDependsOnAttribute[])property.GetCustomAttributes(typeof(NotifyDependsOnAttribute), false);

            foreach (var attribute in attributeArray)
            {
                obj_interface.DependentPropertyList.Add(new KeyValuePair<string, string>(attribute.DependsOn, property.Name));
            }
        }
    }
} 
```

属性本身只存储一个字符串。您可以为每个属性定义多个依赖项。该属性的核心在 BuildDependentPropertyList 静态函数中。您必须在类的构造函数中调用它。（有人知道是否有办法通过类/构造函数属性来做到这一点？）在我的情况下，所有这些都隐藏在基类中，所以在子类中你只需将属性放在属性上。然后修改您的 OnPropertyChanged 等效项以查找任何依赖项。下面以我的 ViewModel 基类为例：

```
public class ViewModel : INotifyPropertyChanged, INotifyDependentPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    protected virtual void OnPropertyChanged(string propertyname)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyname));

            // fire for dependent properties
            foreach (var p in this.DependentPropertyList.Where((x) => x.Key.Equals(propertyname)))
            {
                PropertyChanged(this, new PropertyChangedEventArgs(p.Value));
            }
        }
    }

    private List<KeyValuePair<string, string>> m_DependentPropertyList = new List<KeyValuePair<string, string>>();
    public List<KeyValuePair<string, string>> DependentPropertyList
    {
        get { return m_DependentPropertyList; }
    }

    public ViewModel()
    {
        NotifyDependsOnAttribute.BuildDependentPropertyList(this);
    }
 } 
```

最后，在受影响的属性上设置属性。我喜欢这种方式，因为派生属性包含它所依赖的属性，而不是相反。

```
 [NotifyDependsOn("Session")]
    [NotifyDependsOn("DatabaseBusy")]
    public bool SaveEnabled
    {
        get { return !this.Session.IsLocked && !this.DatabaseBusy; }
    } 
```

这里最大的警告是，它仅在其他属性是当前类的成员时才有效。在上面的示例中，如果 this.Session.IsLocked 发生更改，则通知不会通过。我解决这个问题的方法是订阅 this.Session.NotifyPropertyChanged 并为“Session”触发 PropertyChanged。（是的，这会导致事件在他们不需要的地方触发）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T02:33:01.380

执行此操作的传统方法是将 OnPropertyChanged 调用添加到可能影响您计算的每个属性的调用，如下所示：

```
public bool IsLoaded
{
    get { return m_IsLoaded; }
    set
    {
        if (m_IsLoaded != value)
        {
            m_IsLoaded = value;
            OnPropertyChanged("IsLoaded");
            OnPropertyChanged("CanSave");
        }
    }
} 
```

这可能会有点混乱（例如，如果您在 CanSave 中的计算发生了变化）。

解决此问题的一种（更清洁？我不知道）方法是覆盖 OnPropertyChanged 并在那里拨打电话：

```
protected override void OnPropertyChanged(string propertyName)
{
    base.OnPropertyChanged(propertyName);
    if (propertyName == "IsLoaded" /* || propertyName == etc */)
    {
        base.OnPropertyChanged("CanSave");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T02:31:58.497

您需要为 CanSave 属性更改的任何地方添加通知，它所依赖的属性之一发生更改：

```
OnPropertyChanged("DatabaseBusy");
OnPropertyChanged("CanSave"); 
```

和

```
OnPropertyChanged("IsEnabled");
OnPropertyChanged("CanSave"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T02:32:15.047

这个解决方案怎么样？

```
private bool _previousCanSave;
private void UpdateCanSave()
{
    if (CanSave != _previousCanSave)
    {
        _previousCanSave = CanSave;
        OnPropertyChanged("CanSave");
    }
} 
```

然后在 IsLoaded 和 DatabaseBusy 的 setter 中调用 UpdateCanSave()？

如果您无法修改 IsLoaded 和 DatabaseBusy 的设置器，因为它们位于不同的类中，您可以尝试在 PropertyChanged 事件处理程序中为定义 IsLoaded 和 DatabaseBusy 的对象调用 UpdateCanSave()。

# ocr - XSL-FO 的确切位置

> ID：593307
> 
> 赞同：1
> 
> 时间：2009-02-27T02:24:38.107
> 
> 标签：ocr, xsl-fo, apache-fop, xml-formatting

当需要 OCR 的精确放置时，我在 XML-FO 页面（通过 FOP 运行）中有一个项目。每当编辑页面（或包含的页面）时，都很难将 OCR 线恢复到位。

FOP 是否可以指定确切的位置。而不是让页面上的先前项目推动项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T19:16:03.050

所有这些建议都在 XSL-FO 级别，FOP 只处理该级别。

我不知道确切的位置，但[这个常见问题解答条目](http://xmlgraphics.apache.org/fop/faq.html#indent-inheritance)可能是相关的。基本上缩进是继承的，所以你可能需要重置它。

还; [此链接](http://xmlgraphics.apache.org/fop/fo.html#fo-preformat)讨论了启用/禁用空格折叠等的方法。

[另一个链接](http://www.w3.org/TR/2001/REC-xsl-20011015/slice7.html#common-absolute-position-properties)描述了使用绝对定位属性（来自 CSS）来定位`fo:block-containers`

# windows - Autorun.inf 无法处理文件夹名称中有空格的子文件夹？

> ID：593311
> 
> 赞同：7
> 
> 时间：2009-02-27T02:26:36.650
> 
> 标签：windows, installation, autorun, dvd

我正在尝试使用 autorun.inf 在其文件夹名称中有空格的子文件夹下运行我的可执行文件。像这样：

```
H:\
    autorun.inf
    FOLDER NAME 1
        file.exe
    FOLDER NAME 2
        some other stuffs 
```

如果文件夹名称中没有空格，则效果很好。但如果有一些，它不适合我。

这是限制吗？还是我做错了什么？

我的自动运行.inf：

```
[autorun]
open=FOLDER NAME 1\Setup.exe
icon=FOLDER NAME 1\Setup.exe 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-07-29T12:23:57.743

通过一些试验，我发现需要成对的双引号。不过听起来很奇怪。

open=""文件夹名称 1\Setup.exe""

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-26T15:16:36.863

从 Sanjay 使用两组引号的答案扩展，例如

```
open=""FOLDER NAME 1\Setup.exe"" 
```

如果您想要文件夹中的图标，则需要在整行周围加上一组引号。例如

```
icon="FOLDER NAME 1\Setup.exe,0" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T02:27:35.073

我不知情的猜测：使用引号。

```
[autorun]
open="FOLDER NAME 1\Setup.exe"
icon="FOLDER NAME 1\Setup.exe" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T02:31:35.703

除了按照 Thomas 的建议进行操作并使用引号外，您还可以使用短/“DOS”样式名称。这是名称的前 6 个字母，后跟波浪号 (~)，然后是数字。所以“FOLDER NAME 1”通常会变成“FOLDER~1”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-05T01:21:56.237

这也有效：

```
open=.\FOLDER NAME 1\Setup.exe 
```

编辑：适用于图标，不适用于打开命令......有点奇怪！

# amazon-web-services - 如何从命令行使用多个 AWS 账户？

> ID：593334
> 
> 赞同：175
> 
> 时间：2009-02-27T02:50:38.560
> 
> 标签：amazon-web-services, amazon-ec2, aws-cli

我在 Amazon EC2 上托管了两个不同的应用程序（第二个即将上线）。

如何在命令行 (Mac OS X) 上使用两个帐户，但将 EC2 密钥和证书分开？我需要在每个 ec2-* 命令之前更改我的环境变量吗？

是否会使用别名并将其用于在线环境的设置？就像是：

```
alias ec2-describe-instances1 = export EC2_PRIVATE_KEY=/path; ec2-describe-instances 
```

* * *

## 回答 #1

> 赞同：423
> 
> 时间：2015-12-12T23:06:21.353

您可以通过在 aws 命令行上创建两个[配置文件来使用两个帐户。](http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-multiple-profiles)它会提示您输入您的[AWS 访问密钥 ID、AWS 秘密访问密钥](http://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html)和所需区域，因此请准备好它们。

例子：

```
$ aws configure --profile account1
$ aws configure --profile account2 
```

然后，您可以通过在命令中传递配置文件来在帐户之间切换。

```
$ aws dynamodb list-tables --profile account1
$ aws s3 ls --profile account2 
```

笔记：

如果您将配置文件命名为`default`，它将成为**默认配置文件**，即当`--profile`命令中没有参数时。

* * *

### 更多关于默认配置文件

如果您花费更多时间使用*account1*，则可以通过设置 AWS_DEFAULT_PROFILE 环境变量将其设为默认值。设置默认环境变量后，您无需在每个命令上指定配置文件。

Linux、OS X 示例：

```
$ export AWS_DEFAULT_PROFILE=account1
$ aws dynamodb list-tables 
```

窗口示例：

```
$ set AWS_DEFAULT_PROFILE=account1
$ aws s3 ls 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2015-11-28T00:39:20.703

# 如何“手动”设置多个 AWS 账户？

**1) 获取访问密钥**

[AWS 控制台 > 身份和访问管理 (IAM) > 您的安全凭证 > 访问密钥](https://console.aws.amazon.com/iam/home#security_credential)

**2）在文件中设置访问权限**

`~/.aws/credentials`

```
[default]
aws_access_key_id={{aws_access_key_id}}
aws_secret_access_key={{aws_secret_access_key}}

[{{profile_name}}]
aws_access_key_id={{aws_access_key_id}}
aws_secret_access_key={{aws_secret_access_key}} 
```

**3）在文件中设置配置文件**

`~/.aws/config`

```
[default]
region={{region}}
output={{output:"json||text"}}

[profile {{profile_name}}]
region={{region}}
output={{output:"json||text"}} 
```

**4）测试它**

安装命令行应用程序[AWS Command Line](https://aws.amazon.com/cli/)并使用命令 - 例如产品 EC2

`aws ec2 describe-instances --profile {{profile_name}}`

* * *

参考

*   [http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-multiple-profiles](http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-multiple-profiles)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-02-27T03:05:12.190

您应该能够使用以下命令选项代替`EC2_PRIVATE_KEY`（甚至`EC2_CERT`）环境变量：

*   `-K <private key>`
*   `-C <certificate>`

您可以将这些放在别名中，例如

```
alias ec2-describe-instances1 ec2-describe-instances -K /path/to/key.pem 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2021-03-28T17:35:47.643

恕我直言，**最简单的方法**是手动编辑`.aws/credentials`和文件。`.aws/config`

它很简单，适用于 Linux、Mac 和 Windows。只需[阅读此内容](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html)以了解更多详细信息**（1 分钟阅读）**。

`.aws/credentials`文件：

```
[default]
aws_access_key_id=AKIAIOSFODNN7EXAMPLE
aws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

[user1]
aws_access_key_id=AKIAI44QH8DHBEXAMPLE
aws_secret_access_key=je7MtGbClwBF/2Zp9Utk/h3yCo8nvbEXAMPLEKEY 
```

`.aws/config`文件：

```
[default]
region=us-west-2
output=json

[profile user1]    <-- 'profile' in front of 'profile_name' (not for default)!!
region=us-east-1
output=text 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-12-15T13:54:31.217

新的 aws 工具现在支持多个配置文件。

如果您使用工具配置访问权限，它会自动在 ~/.aws/config 中创建一个默认值。

然后，您可以添加其他配置文件 - 更多详细信息，请访问：

[http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-multiple-profiles](http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-multiple-profiles)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-12-12T01:11:11.947

创建或编辑此文件：

```
% vim ~/.aws/credentials 
```

列出任意数量的密钥对：

```
[default]
aws_access_key_id=AKIAIOSFODNN7EXAMPLE
aws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

[user1]
aws_access_key_id=AKIAI44QH8DHBEXAMPLE
aws_secret_access_key=je7MtGbClwBF/2Zp9Utk/h3yCo8nvbEXAMPLEKEY 
```

设置一个局部变量以选择您要使用的键对：

```
% export AWS_PROFILE=user1 
```

你喜欢什么：

```
aws s3api list-buckets  # any aws cli command now using user1 pair of keys 
```

如果您希望包含`--profile user1`每个命令，也可以逐个命令执行它：

```
aws s3api list-buckets --profile user1
# any aws cli command now using user1 pair of keys 
```

更多详细信息： [https ://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-02-13T19:48:23.480

我创建了一个简单的工具[aaws](https://github.com/luk3thomas/aaws)来在 AWS 账户之间切换。

它通过`AWS_DEFAULT_PROFILE`在你的shell中设置来工作。只需确保您的`~/.aws/credentials`文件中有一些条目，它就会在多个帐户之间轻松切换。

```
/tmp
$ aws s3 ls
Unable to locate credentials. You can configure credentials by running "aws configure". 
```

```
/tmp
$ aaws luk3

[luk3]  /tmp
$ aws s3 ls
2013-11-05 21:40:04 luk3thomas.com 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-17T01:25:15.233

您可以编写shell脚本根据用户输入为每个帐户设置相应的环境变量值。这样做，您不需要创建任何别名，此外，ELB 工具、Auto Scaling 命令行工具等工具也可以在多个帐户下工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-21T05:53:21.973

要使用 IAM 角色，您必须对 STS:AssumeRole 进行 API 调用，这将返回一个临时访问密钥 ID、秘密密钥和安全令牌，然后可用于签署未来的 API 调用。以前，为了从 AWS 命令​​行界面 (CLI) 实现安全的跨账户、基于角色的访问，需要显式调用 STS:AssumeRole，并使用您的长期凭证。生成的临时凭证被捕获并存储在您的配置文件中，并且该配置文件用于后续的 AWS API 调用。当临时凭证过期时（默认为 1 小时后），必须重复此过程。

[https://aws.amazon.com/blogs/security/how-to-use-a-single-iam-user-to-easily-access-all-your-accounts-by-using-the-aws-cli/](https://aws.amazon.com/blogs/security/how-to-use-a-single-iam-user-to-easily-access-all-your-accounts-by-using-the-aws-cli/)

# c# - “语音气泡”通知

> ID：593341
> 
> 赞同：4
> 
> 时间：2009-02-27T02:55:30.373
> 
> 标签：c#, .net, c++, mfc, notifications

**我正在尝试获取通知以在MFC 应用程序**中弹出类似这些气泡的内容：

![未使用的图标气泡图像](https://girtby.net/images/unused-icons.png)

[![大写锁定仍然在图像上](https://i.stack.imgur.com/ZCjXX.png)](https://i.stack.imgur.com/ZCjXX.png)
[（来源：[humanized.com](http://www.humanized.com/weblog/images/caps_lock_indication.png)）]

我目前正在用 C# 制作一个界面模型，以向一些利益相关者展示，所以如果能把它也放在那里就好了。

它不一定必须是气泡式的：它可能是类似于工具提示的东西 - 但它必须在没有鼠标悬停的情况下出现

干杯!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T03:16:54.410

Just found [this](http://www.codeproject.com/KB/shell/balloonshow.aspx?display=PrintAll) on CodeProject. Downloaded the sample and it works well actually. I'm going to add this to my own code repository; never know when I may need this!

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T03:03:17.030

看看[CodeProject](http://www.codeproject.com/KB/miscctrl/RobMisNotifyWindow.aspx) (C#) :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T08:06:05.837

这是一个标准的 Windows 机制（自 XP 起），它们被称为**Balloon Tooltips**。根据您想要显示气球的位置，您可以使用`CEdit`'s[`ShowBalloonTip`](http://msdn.microsoft.com/en-us/library/bb398687.aspx)方法或[`Shell_NotifyIcon`](http://msdn.microsoft.com/en-us/library/bb762159.aspx)API。

Windows 窗体中有[NotifyIcon](http://msdn.microsoft.com/en-us/library/system.windows.forms.notifyicon.aspx)类，但我不知道 TextBox，您可能必须使用互操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T14:27:53.547

您可以只使用 System.Windows.Forms.ToolTip。

```
using System.Windows.Forms;

...

ToolTip myTip = new ToolTip; // create tooltip
myTip.IsBaloon = true; // give it a round shape
myTip.SetToolTip( myTool, "You're hovering above myTool." ); // register popup message for 'myTool'
...
myTip.Show(myTool, "Forced modal pop-up.", 1000 ); // display pop up message for 1 sec at 'myTool' 
```

# optimization - 你最喜欢的低级代码优化技巧是什么？

> ID：593343
> 
> 赞同：11
> 
> 时间：2009-02-27T02:56:07.533
> 
> 标签：optimization

我知道你应该只在认为有必要时才优化。但是，如果认为有必要，您最喜欢的低级（相对于算法级）优化技巧是什么。

例如：[循环展开](http://en.wikipedia.org/wiki/Loop_unwinding)。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-27T02:58:42.130

```
gcc -O2 
```

编译器比你做得更好。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-27T03:01:15.977

为过滤器、循环缓冲区等选择 2 的幂。

所以非常非常方便。

-亚当

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-27T03:08:55.113

Why, [bit twiddling hacks](http://graphics.stanford.edu/~seander/bithacks.html), of course!

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-27T03:25:59.753

One of the most useful in scientific code is to replace `pow(x,4)` with `x*x*x*x`. Pow is almost always more expensive than multiplication. This is followed by

```
 for(int i = 0; i < N; i++)
  {
    z += x/y;
  } 
```

to

```
 double denom = 1/y;
  for(int i = 0; i < N; i++) 
  {
    z += x*denom;
  } 
```

But my favorite low level optimization is to figure out which calculations can be removed from a loop. Its always faster to do the calculation once rather than N times. Depending on your compiler, some of these may be automatically done for you.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-27T03:08:40.217

Inspect the compiler's output, then try to coerce it to do something faster.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-27T04:41:00.290

我不一定将其称为低级优化，但通过明智地应用缓存，我节省的周期比通过所有低级技巧的应用加起来要多几个数量级。其中许多方法是特定于应用程序的。

*   拥有数据库查询（或任何其他基于 IPC 的请求）的 LRU 缓存。
*   记住上次失败的数据库查询，如果在特定时间范围内重新请求，则返回失败。
*   在大型数据结构中记住您的位置，以确保如果下一个请求是针对同一节点的，则搜索是免费的。
*   缓存计算结果以防止重复工作。除了更复杂的场景之外，这经常出现在`if`or`for`语句中。

CPU 和编译器在不断变化。无论在 3 CPU 芯片之前使用不同的编译器有意义的低级代码技巧在当前架构上实际上可能会更慢，并且这个技巧很可能会混淆将来维护此代码的人。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-27T02:59:44.857

`++i`可以比 快`i++`，因为它避免了创建一个临时的。

这是否仍然适用于现代 C/C++/Java/C# 编译器，我不知道。对于具有重载运算符的用户定义类型可能会有所不同，而在简单整数的情况下可能无关紧要。

但我开始喜欢这种语法......它读起来像“increment i”，这是一个明智的顺序。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-02-27T03:23:46.373

Using template metaprogramming to calculate things at compile time instead of at run-time.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-27T03:52:01.767

几年前，使用一个不太聪明的编译器，我从函数内联、遍历指针而不是索引数组以及迭代到零而不是最大迭代中获得了很大的成就。

如有疑问，一点汇编知识将使您了解编译器正在生成什么并攻击低效部分（在您的源语言中，使用对您的编译器更友好的结构。）

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-27T05:05:59.110

预先计算的值。

例如，如果您的应用程序不需要非常精确的角度，而不是 sin(a) 或 cos(a)，也许您可​​以表示 1/256 圆的角度，并创建浮点数组 sine[] 和cosine[] 预先计算这些角度的 sin 和 cos。

而且，如果您经常需要一个给定长度的某个角度的向量，您可能会预先计算所有已经乘以该长度的正弦和余弦。

或者，更一般地说，用内存换取速度。

或者，更一般地说，“所有编程都是缓存练习”——Terje Mathisen

有些事情不太明显。例如遍历一个二维数组，你可能会做类似的事情

```
    对于 (x=0;x<maxx;x++)
       对于 (y=0;y<maxy;y++)
          do_something(a[x,y]);

```

如果您这样做，您可能会发现处理器缓存更喜欢它：

```
   对于 (y=0;y<maxy;y++)
       对于 (x=0;x<maxx;x++)
           do_something(a[x,y]);

```

或相反亦然。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-27T06:13:38.463

不要循环展开。不要做达夫的装置。让你的循环尽可能小，其他任何东西都会抑制 x86 性能和 gcc 优化器性能。

不过，摆脱分支可能很有用 - 所以完全摆脱循环是好的，而且那些无分支的数学技巧确实有效。除此之外，尽量不要超出二级缓存——这意味着如果浪费缓存空间，也应该避免大量的预计算/缓存。

而且，特别是对于 x86，尽量减少任何时候使用的变量数量。很难说编译器会用这种东西做什么，但通常循环迭代变量/数组索引越少，asm 输出就会越好。

当然，这是针对台式机 CPU 的；具有快速内存访问的慢速 CPU 可以预先计算更多，但在这些日子里，这可能是一个总内存很少的嵌入式系统......</p>

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-27T13:42:49.663

优化缓存局部性 - 例如，将两个不适合缓存的矩阵相乘。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-27T03:05:55.420

Counting down a loop. It's cheaper to compare against 0 than N:

```
for (i = N; --i >= 0; ) ... 
```

Shifting and masking by powers of two is cheaper than division and remainder, / and %

```
#define WORD_LOG 5
#define SIZE (1 << WORD_LOG)
#define MASK (SIZE - 1)

uint32_t bits[K]

void set_bit(unsigned i)
{
    bits[i >> WORD_LOG] |= (1 << (i & MASK))
} 
```

**Edit**

```
(i >> WORD_LOG) == (i / SIZE) and
(i & MASK) == (i % SIZE) 
```

because SIZE is 32 or 2^5\.

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-27T03:15:44.100

Allocating with new on a pre-allocated buffer using C++'s placement new.

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-27T03:40:12.527

I've found that changing from a pointer to indexed access may make a difference; the compiler has different instruction forms and register usages to choose from. Vice versa, too. This is extremely low-level and compiler dependent, though, and only good when you need that last few percent.

E.g.

```
for (i = 0;  i < n;  ++i)
    *p++ = ...; // some complicated expression 
```

vs.

```
for (i = 0;  i < n;  ++i)
    p[i] = ...; // some complicated expression 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-02-27T08:37:41.283

使用布尔数学消除分支（if/elses）：

```
if(x == 0)
    x = 5;

// becomes:

x += (x == 0) * 5;
// if '5' was a base 2 number, let's say 4:
x += (x == 0) << 2;

// divide by 2 if flag is set
sum >>= (blendMode == BLEND); 
```

这真的可以加快速度，尤其是当那些 if 处于循环中或被调用很多的地方时。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-02-27T08:05:35.417

Jon Bentley 的[Writing Efficient Programs](http://www.crowl.org/Lawrence/programming/Bentley82.html)是低级和高级技术的重要来源——如果你能找到一份副本的话。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-02-27T09:26:44.443

来自汇编程序的一个：

```
xor ax, ax 
```

代替：

```
mov ax, 0 
```

针对程序大小和性能的经典优化。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-02-27T03:07:45.850

*   Recycling the frame-pointer all of a sudden
*   Pascal calling-convention
*   Rewrite stack-frame tail call optimizarion (although it sometimes messes with the above)
*   Using `vfork()` instead of `fork()` before `exec()`
*   And one I am still looking for, an excuse to use: data driven code-generation at runtime

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-27T03:39:52.543

In SQL, if you only need to know whether any data exists or not, don't bother with `COUNT(*)`:

```
SELECT 1 FROM table WHERE some_primary_key = some_value 
```

If your `WHERE` clause is likely return multiple rows, add a `LIMIT 1` too.

(Remember that databases can't see what your code's doing with their results, so they can't optimise these things away on their own!)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-03-10T12:42:15.237

除了 Joshua 关于代码生成的评论（一个巨大的胜利）和其他好的建议，......

我不确定您是否会称其为“低级”，但是（这是投反对票的诱饵）1）远离使用比绝对必要更多的抽象级别，2）远离事件驱动的通知- 风格的编程，如果可能的话。

1.  如果说执行程序的计算机就像赛车一样，那么方法调用就像绕道而行。这并不一定是坏事，除非很想嵌套这些东西，因为一旦编写了方法调用，您往往会忘记该调用可能会花费您什么。

2.  如果您依赖事件和通知，那是因为您有多个需要保持一致的数据结构。这是昂贵的，只有当你无法避免时才应该这样做。

以我的经验，最大的性能杀手是太多的数据结构和太多的抽象。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-27T16:45:34.620

卷起循环。

说真的，我最后一次需要做这样的事情是在一个占用 80% 运行时间的函数中，所以如果我能获得显着的性能提升，那么尝试微优化是值得的。

我做的第一件事就是卷起循环。这给了我一个非常显着的速度提升。我相信这是缓存位置的问题。

我做的下一件事是添加一个间接层，并在循环中加入更多逻辑，这样我就可以只循环我需要的东西。这并没有提高速度，但值得这样做。

如果你要进行微优化，你需要对两件事有一个合理的想法：你实际使用的架构（这与我长大的系统大不相同，至少出于微优化目的），以及编译器将为您做什么。

许多传统的微优化以空间换时间。如今，使用更多空间会增加缓存未命中的机会，而您的性能也会随之提高。此外，其中很多现在是由现代编译器完成的，而且通常比你可能做的要好。

目前，您应该 (a) 配置文件以查看是否需要进行微优化，然后 (b) 尝试用计算换取空间，希望尽可能多地保留在缓存中。最后，运行一些测试，这样你就知道你是改进了还是搞砸了。现代编译器和芯片太复杂了，您无法保持良好的心理模型，并且您知道某些优化是否有效的唯一方法是进行测试。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-03-25T18:48:39.597

通过替换 for 循环在结构中将数字加在一起，我得到了加速，这让我感到惊讶：

```
const unsigned long SIZE = 100000000;

typedef struct {
    int a;
    int b;
    int result;
} addition;

addition *sum;

void start() {
    unsigned int byte_count = SIZE * sizeof(addition);

    sum = malloc(byte_count);
    unsigned int i = 0;

    if (i < SIZE) {
        do {
            sum[i].a = i;
            sum[i].b = i;
            i++;
        } while (i < SIZE);
    }    
}

void test_func() {
    unsigned int i = 0;

    if (i < SIZE) { // this is about 30% faster than the more obvious for loop, even with O3
        do {
            addition *s1 = &sum[i];
            s1->result = s1->b + s1->a;
            i++;
        } while ( i<SIZE );
    }
}

void finish() {
    free(sum);
} 
```

为什么 gcc 不对循环进行优化？还是我错过了什么？一些缓存效果？

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-27T09:05:26.303

自由使用 __restrict 来消除 load-hit-store 停顿。

# asp.net - asp.net sqldatasource detailview：如何设置正确的选择语句

> ID：593344
> 
> 赞同：0
> 
> 时间：2009-02-27T02:57:57.340
> 
> 标签：asp.net, sqldatasource, detailsview

我的页面加载事件看起来像这样......

```
 SqlDataSource1.ConnectionString = Connection.ConnectionStr;

    SqlDataSource1.SelectCommand = "select firstname,lastname from customer";

    SqlDataSource1.InsertCommand = "CustRec_iu";
    SqlDataSource1.InsertCommandType = SqlDataSourceCommandType.StoredProcedure; 

    SqlDataSource1.InsertParameters.Clear();

    SqlDataSource1.InsertParameters.Add(new Parameter("firstname", DbType.String));
    SqlDataSource1.InsertParameters.Add(new Parameter("LastName", DbType.String));
    SqlDataSource1.InsertParameters.Add(new Parameter("Active",DbType.Int16,"1")); 
```

detailview 控件设置如下所示....

```
 <asp:DetailsView ID="dvCustDetails1" runat="server" AutoGenerateRows="False" 
            DataSourceID="SqlDataSource1" Height="149px" Width="469px"
            OnItemInserted=dvCustDetails1_ItemInserted

            >
            <Fields>
                <asp:BoundField DataField="FirstName" HeaderText="First Name" 
                    SortExpression="FirstName" />
                <asp:BoundField DataField="LastName" HeaderText="Last Name" 
                    SortExpression="LastName" />
                <asp:CommandField ButtonType="Button" ShowInsertButton="True" />
            </Fields>
        </asp:DetailsView> 
```

插入功能完成后，我想从作为标识列的客户表中捕获 custid，一些如何提取它并选择具有该记录的表，例如

select * from customer where custid = @custid。

然后在插入后控件呈现后，我希望它根据上面的选择语句显示新插入的记录。

另外，我希望 detailsview 显示更新按钮，以便我可以更新记录。

我将如何做到这一点？

我在谷歌搜索甚至印刷书籍中发现的文档很少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T03:04:52.177

You want to use the sqldatasource's OnSelected event with a return parameter from the SQL call.

Add this to the sqldatasource

```
OnSelected ="sqlds_Selected" 
```

and implement it something like:

```
protected void sqlds_Selected(object sender, SqlDataSourceStatusEventArgs e)
{
    //get the command object from the arg and
    //then you can get to the parameter value

    e.Command.Parameters["@CustomerID"].Value

   //then set this to your detailsview key

} 
```

# mysql - 有人可以解释为什么 MySQL 在 name = 'test': "test" 和 "test" 时返回两个值

> ID：593350
> 
> 赞同：0
> 
> 时间：2009-02-27T03:01:01.997
> 
> 标签：mysql

我有下表和数据：

```
CREATE TABLE `test` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(8) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;

INSERT INTO `test` (`id`, `name`) VALUES (1, 'test');
INSERT INTO `test` (`id`, `name`) VALUES (2, 'test    '); 
```

当我执行以下任一查询时，它返回 2 行（两行）：

```
SELECT * FROM test WHERE name = 'test';
SELECT * FROM test WHERE name IN ('test'); 
```

谁能向我解释这个和/或如何解决它？

我正在运行 MySQL 5.0.27。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T03:07:42.653

从mysql手册：

> 请注意，所有 MySQL 排序规则都是 PADSPACE 类型。这意味着比较 MySQL 中的所有 CHAR 和 VARCHAR 值，而不考虑任何尾随空格。

请注意，MySQL 不会**删除**5.0.3 或更高版本中的尾随空格，它们被存储，但在比较期间不使用：

> VARCHAR 值在存储时不会被填充。尾随空格的处理取决于版本。从 MySQL 5.0.3 开始，按照标准 SQL，在存储和检索值时保留尾随空格。在 MySQL 5.0.3 之前，当值存储到 VARCHAR 列中时，它们会从值中删除尾随空格；这意味着检索到的值中也没有空格。

这两个引用都来自手册的这个页面：[10.4.1。CHAR 和 VARCHAR 类型](http://dev.mysql.com/doc/refman/5.0/en/char.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T03:07:05.213

MySQL 从 varchar 列的末尾删除空格 - 不完全确定为什么在 MySQL 中以这种方式实现 - 显然不是 ANSI 标准。

如果您想保留尾随空格，您可以选择使用字符或文本字段。

编辑：我相信这在[5.0.3 版中已更改](http://dev.mysql.com/doc/refman/5.0/en/char.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T03:36:54.347

使用 BINARY 关键字：

SELECT * FROM test WHERE BINARY name = 'test';

# visual-studio-2008 - LNK2005 - Visual Studio - 之前编译好，没有变化，现在不编译

> ID：593354
> 
> 赞同：1
> 
> 时间：2009-02-27T03:01:45.723
> 
> 标签：visual-studio-2008

我正在为学校开发一个使用 Visual C++ 数据结构的项目。今天早些时候我的代码编译得很好，然后把它带回家，它不再工作了。我一直在使用的两台机器都使用 Visual Studio 2008。这是错误的文本。

我不确定这是否与它有关，但我的程序有 3 个主要类：AVL，它继承自 BST，它继承自 SearchableADT。这些是模板类。

BST.obj : 错误 LNK2005: "public: __thiscall BST,class std::allocator > >::BST,class std::allocator > >(void)" (??0?$BST@V?$basic_string@DU? $char_traits@D@std@@V?$allocator@D@2@@std@@@@QAE@XZ) 已经在 AVL.obj 中定义

我完全不知道该怎么做。我在几个论坛上闲逛，查看了 MSDN 页面，但没有任何东西能够修复它。

我注意到在我忘记的网站上提到的一件事是为我的 AVL 设置#ifndef/#define。我创建了一个新项目并复制并粘贴了我的所有代码，但我仍然遇到同样的错误。我查看了我的代码以验证我没有做多个包含库。不过，我不知道从这里做什么。

感谢您提供的任何帮助，如果我遗漏了一些重要的事情，请提前道歉。

编辑：我不确定你对内联的意思是 100%，现在尝试做一些查看。我确实有一个单独的 cpp，我在其中定义了实际功能。格雷格答案中的内联内容是否仍然适用？

MSN，恐怕我没听懂你的回答。至于默认构造函数的多个副本，我确实有

```
BST<int>::BST()
{
    root = new Node<int>;
}

BST<string>::BST()
{
root = new Node<string>;
} 
```

我不确定这是否是您所说的，或者这可能是问题所在。我的头文件只有 BST();，没有 int 或 string 模板。我的 cpp 中有这些定义，因为我的导师说它们对于模板类是必需的。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T03:10:04.783

It sounds like you might have defined a method in a header file in a non-inline way. For example, having the following in a header file might cause such a problem:

```
template <class T> class Foo {
    void bar();
};

template <class T> void Foo<T>::bar()
{
    // ...
} 
```

With that in the header file, then including it into two different modules will provide two different definitions of the same `Foo<T>::bar()` function, with the resulting error that you got. One solution is to declare the function inline:

```
template <class T> class Foo {
    void bar() {
        // ...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T04:02:07.623

您没有为模板的每个实例化类型定义单独的构造函数。对于 BST，您只需要一个构造函数。您可以使用模板参数创建节点类的实例：

```
root = new Node<T>(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T03:07:26.257

Declare BST::BST(void) inline and make sure you didn't violate the One Definition Rule and have different implementations of BST::BST(void) depending on some other preprocessor fun.

# compiler-construction - 堆栈机器码的 SSA

> ID：593358
> 
> 赞同：9
> 
> 时间：2009-02-27T03:03:54.520
> 
> 标签：compiler-construction, ssa, stack-machine

我正在为堆栈机器（特别是[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)）开发编译器，并且我已将代码解析为基本块图。从这里开始，我希望将[SSA](http://en.wikipedia.org/wiki/Static_single_assignment_form)应用于这些方法，但进展并不顺利。我的第一次尝试（在使用平面列表而不是图表时）是迭代代码并保留一堆 SSA id（即，用于分配目标），当我产生分配时推送它们，当我弹出它们时他们被使用了。这适用于单个基本块，但我根本无法弄清楚如何处理生成 Φ 函数。

我一直在折腾的想法是将堆栈位置附加到 SSA id，然后查看代码路径收敛时堆栈上仍然存在的内容，但这似乎不是做事的正确方式 (TM)。

是否有一种简单的算法来跟踪跨多个代码路径的堆栈操作并确定它们收敛时的冲突？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T13:04:16.947

您需要查看汇聚在一个节点（基本块）上的多**组 SSA id 。**保留中间基本块结构，这样您就可以轻松地使用（例如查询）块中的所有标识符。

我不确定你对碰撞的意思，但我假设你想解决类似的问题

```
 if (bExp)                  if (bExp)
   x := 1                    x1 := 1
 else            SSA:       else
   x := 2                    x2 := 2
 y := x;                    y := Phi(x1,x2) 
```

也就是说，你想要这个地方的 Phi。意识到可执行代码中没有 Phi！使用 y 依赖于 x1 或 x2 的信息，您可以在下一步中重写它。例如，在以内存为中心的表示中，Phi(x1,x2) 告诉您 x1 和 x2 应该是同一内存位置的两个别名，即 y 的别名。Phi 只是将信息联系在一起。

```
if (bExp)
  stackframe[y_index] = 1     (y_index being some offset)
else
  stackframe[y_index] = 2
nop 
```

希望这个对你有帮助！

# c# - 使用 LINQ 在节点中选择两个属性

> ID：593359
> 
> 赞同：0
> 
> 时间：2009-02-27T03:04:15.453
> 
> 标签：c#, .net, linq, linq-to-xml

我有以下节点：

```
<NodeA desc="Cheap Item 1" category="Cooking" /> 
```

我使用以下内容选择了“类别”属性：

```
.Where(attr => attr.Name == "category")
.Select(attr => attr.Value); 
```

我现在如何同时选择“desc”和“category”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T03:14:17.597

**编辑**我想我实际上误解了你原来的问题。下面的代码应该在节点列表中找到合适的节点并选择它的`desc`和`category`属性。

```
var contents = nodes.Where( n => n.Name == "NodeA")
                    .Select( node => new { desc = node.Attribute("desc")
                                                      .Value,
                                          category = node.Attribute("category")
                                                          .Value
                                         }
                     );

var desc = contents.desc;
var category = contents.category; 
```

# iphone - 如何在 iPhone 上将 NSMutableData 转换为 NSString？

> ID：593362
> 
> 赞同：51
> 
> 时间：2009-02-27T03:05:23.313
> 
> 标签：iphone, string, typeconverter

我从服务器收到了 NSMutableData，现在我想将其转换为 NSString。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-02-27T03:22:05.300

您可以使用`initWithData:`初始化程序：

```
[[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding]; 
```

将编码更改为源数据的编码。

# database-design - varchar 字段 - 两个的幂次更有效吗？

> ID：593364
> 
> 赞同：61
> 
> 时间：2009-02-27T03:06:33.577
> 
> 标签：database-design, varchar

`varchar`使用大小为 2 的幂的字段与另一个数字相比是否更有效？我想不，因为对于 SQL Server，默认值为 50。

但是，我听说（但从未证实）将字段大小设置为 2 的幂更有效，因为它们等同于偶数字节，并且计算机以位和字节进行处理。

那么，一个字段声明为`varchar(32)`或`varchar(64)`有任何真正的好处`varchar(50)`吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-02-27T03:37:39.350

**不。**

在其他一些用途中，使用具有 2 次方大小的结构有一些优势，主要是因为您可以在另一个 2 次方大小的结构中安装一个很好的（2 的幂）数量的结构。但这不适用于数据库字段大小。

与 VARCHAR 相关的唯一大小的二次幂是关于 varchar（或某些 SQL 方言中的 TEXT/BLOB）的确切类型：如果它小于 256，它可以使用单个字节来指示长度。如果小于 65536（64KB），两个字节就够了，三个字节到 16777216（16MB），四个字节到 4294967296（4GB）。

此外，可以说它`VARCHAR(50)`和 一样昂贵`VARCHAR(255)`，因为两者都需要 n+1 字节的存储空间。

当然，这是在考虑 Unicode 之前......

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-27T03:09:23.430

我一直认为人们为 varchar 字段选择 2 的幂是因为我们是极客，这就是我们所做的。至少我一直都是这样做的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T03:13:50.703

对于一般的 SQL？不，对于特定的实现，也许。

什么更高效不是由规范决定的（SQL只是一个规范），而是在某个DBMS中是如何实现的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T03:12:36.057

使用某些最大长度您将看到的唯一切实好处是`VARCHAR`. 超过 255 的最大长度将需要一个额外的字节来存储每行中值的长度（对于 256^2 或更大的长度，还需要额外的 2 个字节，依此类推）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T03:12:14.170

这取决于具体的数据库实现，但我不希望它。通常，它不会对字符数进行任何计算，因此它不应该影响性能 - 只有空间。

# emacs - 如何在 Emacs Lisp 中进行闭包？

> ID：593383
> 
> 赞同：30
> 
> 时间：2009-02-27T03:14:16.677
> 
> 标签：emacs, closures, elisp

我正在尝试动态创建一个返回一个常量值的函数。

在 JavaScript 和其他现代命令式语言中，我会使用闭包：

```
function id(a) {
    return function() {return a;};
} 
```

但是 Emacs lisp 不支持这些。

我可以创建身份功能和部分功能应用程序的组合，但也不支持。

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-27T04:06:12.513

用 lexical-let 找到了另一个解决方案

```
(defun foo (n) 
    (lexical-let ((n n)) #'(lambda() n)))

(funcall (foo 10)) ;; => 10 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-30T03:38:56.640

**Emacs 24 中的真实（非假）闭包。**

尽管 Emacs 24 在变量**lexical-binding**的值为**t**时具有词法提取功能，但**defunc**特殊形式在词法绑定的上下文中无法正常工作（至少在 Emacs 24.2.1 中没有。）这使得难以但*并非*不可能定义真正的（不是假的）闭包。例如：

```
(let ((counter 0))
   (defun counting ()
    (setq counter (1+ counter)))) 
```

将无法按预期工作，因为**defun**中的符号**计数器**将绑定到该名称的全局变量（如果有的话），而不是**let**中的词法变量定义。当调用函数**counting**时，如果全局变量不存在，那么它显然会失败。但是，如果有这样一个全局变量，它会被更新，这可能不是预期的，并且可能是一个难以追踪的错误，因为该函数可能看起来工作正常。

 ********如果您以这种方式使用defun** ，字节编译器确实会发出警告，并且该问题可能会在 Emacs 的某些未来版本中得到解决，但在此之前可以使用以下宏：

```
(defmacro defun** (name args &rest body)
  "Define NAME as a function in a lexically bound context.

Like normal `defun', except that it works correctly in lexically
bound contexts.

\(fn NAME ARGLIST [DOCSTRING] BODY...)"
  (let ((bound-as-var (boundp  `,name)))
    (when (fboundp `,name)
      (message "Redefining function/macro: %s" `,name))
    (append
     `(progn
        (defvar ,name nil)
        (fset (quote ,name) (lambda (,@args) ,@body)))
     (if bound-as-var
         'nil
         `((makunbound `,name)))))) 
```

如果您将**计数**定义如下：

```
(let ((counter 0))
  (defun** counting ()
    (setq counter (1+ counter)))) 
```

它将按预期工作并在每次调用时更新词法绑定变量**计数，同时返回新值。**

**警告：**如果您尝试**解解****与词法绑定变量之一同名的函数，该宏将无法正常工作。即，如果您执行以下操作：

```
(let ((dont-do-this 10))
  (defun** dont-do-this ()
    .........
    .........)) 
```

我无法想象有人真的这样做，但值得一提。

注意：我已将宏命名为**defun**** *，以便它不会与*****cl**包中的宏***defun*** *****发生冲突，但它不以任何方式依赖于该包。**

 ***** * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-27T03:47:19.470

愚蠢的想法：怎么样：

```
(defun foo (x)
  `(lambda () ,x))

(funcall (foo 10))  ;; => 10 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-27T05:14:10.243

Emacs lisp 只有动态作用域。有一个`lexical-let`宏通过一个相当可怕的 hack 来近似词法范围。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-04T03:11:09.187

Emacs 24 具有词法绑定。

[http://www.emacswiki.org/emacs/LexicalBinding](http://www.emacswiki.org/emacs/LexicalBinding)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-11T07:46:14.287

```
;; -*- lexical-binding:t -*-

(defun create-counter ()
  (let ((c 0))
    (lambda ()
      (setq c (+ c 1))
      c)))

(setq counter (create-counter))

(funcall counter) ; => 1
(funcall counter) ; => 2
(funcall counter) ; => 3 ... 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-09-05T05:43:04.763

[http://www.emacswiki.org/emacs/FakeClosures](http://www.emacswiki.org/emacs/FakeClosures)

# c# - 如何在 WPF 中读取 base64 图像？

> ID：593388
> 
> 赞同：25
> 
> 时间：2009-02-27T03:17:12.177
> 
> 标签：c#, .net, wpf

我知道如何在 WinForms 中做到这一点

```
byte[] binaryData = Convert.FromBase64String(bgImage64);
image = Image.FromStream(new MemoryStream(binaryData)); 
```

但是我如何在 WPF 中做同样的事情呢？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-27T03:29:56.797

```
byte[] binaryData = Convert.FromBase64String(bgImage64);

BitmapImage bi = new BitmapImage();
bi.BeginInit();
bi.StreamSource = new MemoryStream(binaryData);
bi.EndInit();

Image img = new Image();
img.Source = bi; 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-27T04:08:05.800

扩展上面 Josh 的答案 - 这是一个使用 ValueConverter 的答案，因此您可以使用绑定而不是在代码隐藏中设置图像源。

Base64ImageConverter.cs

```
public class Base64ImageConverter:IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        string s = value as string;

        if (s == null)
            return null;

        BitmapImage bi = new BitmapImage();

        bi.BeginInit();
        bi.StreamSource = new MemoryStream(System.Convert.FromBase64String(s));
        bi.EndInit();

        return bi;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

ImageData.cs（用作数据源）

```
public class ImageData
{
    public string Base64ImageData { get; set; }

    public ImageData()
    {
        this.Base64ImageData = "iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAgMSURBVHja7Jl7jFXFHcc/55y5j32C+wCVXV6KwAIrbUBQeUhiixQEiYrUGNC0Bq2CFqsNjSYUrQg+Uk1JbW0VW0I3BCGgFSlYQKBSqKK8W6lCgQ0s7sKye++eOefMTP+4d+/ee3eRpa3ipvySyZnc+5s5v+/vOb85ljGGjkw2HZwuArgI4P8dgAU4QCT57EikACmAwv3ff6SuqF8vSh74HiYa5Y1lf2PJkr+QSLECCFjxq6kcve9RLMcG4VD2y4VMvqcqbT+X0u7duH9yBb22vIX7+Sm6zJzB1DnrvzQEK1feXySATge/dRtjwiepX7qc/BvHMGXKEIYN682GDfupqTkNOFiRMHkjh2M5FpZtQyjMyJF9AA3AgME9uO5SG7H9fczQoZSMHYMWghEjDn0pwm/e/AlAJwFEFr22DR4eyw39YjS8vgRn4EB6TB7PtLuvZ+2a3WzctAd8D/V5LZZwwHHQQUBt7WlyCgu4bXwFvf++g9j2Q+TeMZlInys4cbKRqqXvU1sbwxiwrDSnNalHBhkDxhhs2zqr4MZA5845aG0AIiLxo2Hn9gPszS/kO2MmUr5nGydfWESnSeMZN24Q5eVFOI6NURqMBq0RwqH/oJ58u3eY3HdX4XbpQvHMGejCAtat28f69fvwA0lI5LQOPItMUIDWBqU0va7sypHDtRitsZIMzfzNc6V0MwAEgFYenqc5+Vk1r3xWzbR7x1FxfD+n3lhJ54kTGDiwD6amBuP7GMfCMgn13TkgQsOfNxIePYrcId/AB1at2Ml7G/dkxppprf2URpPPvLwwoZBgQr9cltfHqI9J4vEA08yRZi7PUzQfgSygb3Cy9gA5UfA8tDZorQmFRMtLtMH2JcfmPp8IYsfhsp8+hvF8CIdBOOD7ba6d9fjb5/RnrQ2DKssYd6mkYPM63KEjWC9L+ev2Q7TlTZ065fDBB/9i7dqH+gmAw9MeIGdQBepMwxe/yRiMH4AfUD3nKTJ12Tb5urJdQblj+yH6XFvCqO7dOSQdNm35FGGZDDdrywKJGHAlJt6EiTedo2pYLTLr9p1iPVudk8cYgxAOp6KdePJId64uKSI30kBDQxO2bbcBIEApnRYDnoeKxVHnAmAnUyhgAtUuAK7w28Xn+5oVbx/A930++ccJhHCSQibeo5TCcRK1NhRyMgF0f/VFrHAYKxxGK4WtAoRoKcyBsTC+z7GHHwfHBiEoe/k5TEMjRic2sqLRNtfKWW+ed473PIXnqaR1NEoZ+leWc/BANSrQSQBpLnT9na9TXl5EY6ME4JEf38JNN/YF4PTy1QS7dlI4fXrC1YQDgcYKCUTP8gTPstXEd2yjcPp0Fu+Msep361LChMO5rQQMAo3j2K3926SFVXKenx8lEg0xfXAev6jJpbbexXX9lAXsRBZwaGpqIhrNYdZD4xh7Y1+8Tw9T/cOfoDZu4J/9R2BFImjpoV2JlhLjuix49h3q6mJ0vn08OYMqqX1iHpPqP+bmW65B+gIpPVw3SI2mJp/GRkmf/t3w/IB43M/435WZ88aYR+8ruzDnughFi19idn+Pq68uozGWBSAIPCorr2RJ1f3cPKGSM6vXcGLGTHLLLuOd677Lg4u2o4IA7boYKcGV6ECzfNk27rrrFT7ceYxLpk2l20sLMFs2M23vKn7+2ChKepQhpY+UPq70iURCFBXnM2NoLpeX5hGNCqQMUjzSTfK6CX7lK9b/aT+7qj06X3UVR1zByrf2IV0PnQ5g5qybWLjwdgoaT3H0B7MJllZx+r7ZPHq4Kwvmr0aeiWN7XsKFmiTGkyilcKXNkaN13D39N8yf/0dk18voXvUqQcUAurwwjxevdVIajcU8+vTtypOjcyh++VkeH+gxZEgPYnGPpqZMC0gZIN2AJtdHCIuavBLuPt6PvaGuFOY4xOOSID0GJk0cTOO7mzg+byEF13yT9cMm88xzW4nXnUqetANCwsZID4QNRhMOCzwZpBx28eINbN16kKd+diuDH7yX+PChnHjiaaQcmHLxtWv2MmRiGVMqKtjjhli2YjchW39hNVHK8Ovff4jn+ezedZRwyCEIdOq8ZAF9KyrmHgjamRb/UzLGEAqHuOeOSt7bUc0NQ8uoenMvdXUxHOf8+yohHPbtm5uoxEppamtjrTqd//rCJWsTx7F55sUtSOmxdetBQklttnef9ENdSXF+WiHTmuz7of/JbZHJTp8qmVpFsnip89onXURt0gqZUq0BfO37yfRKHAQK27baZ86vAQlhp6wp0tF0JCtkWKAFAB0XgDGk2rQLSYEf4AjRZh+Q3X6mnYUSQdwyOMsze95eXs4yb+HTSiOlz/DR/bBsiyCp1NZrE6c8rdMAKKVSDXRz3jIZedC0kdOyc2X2muz8l75Xq/sILinKo0evUuaPK6b/FUUUF+UmrWBayZFo7FWmBcBkaAVjsrSUNWj9G+fB2zx8X+H5AUOG9+IPtxZy+dM/4rcjA8aOrcDzFVq38R5MpgUSvm9lmeyrGY5jIxyH1Ss+5v1jitLhwzno5fLakg+xk16RvSbhQiYTgGVduMA1xlBQGKGmuIzRNcP4KL8nl5fmpLTcVmuecS9kzIUtYJZloZXm+Ze34boeuz46QjjstNnQt4BOS6PNm3wd8no0Gkq1nWcTKV1Wu9mEFxrAeVtM63QXSvhTQUG0w33gEM0XL2fO1HfEDzTKAroCg4DSDib8SWC3lWx6C5LPjkQSaLAufqm/COAigIsALij9ewBzvhamSg2pRgAAAABJRU5ErkJggg==";
    }
} 
```

Window1.xaml

```
<Window x:Class="ImageFromData.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ImageFromData"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <local:Base64ImageConverter x:Key="Base64ImageConverter"/>
        <local:ImageData x:Key="ImageData"/>
    </Window.Resources>
    <Grid DataContext="{StaticResource ImageData}">
        <Image Source="{Binding Base64ImageData, Converter={StaticResource Base64ImageConverter}}"/>
    </Grid>
</Window> 
```

（项目的根命名空间是 ImageFromData）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-25T19:51:34.097

在我遇到的一种情况下，我创建了一个转换器来处理 Base64 字符串到 WPF 图像的转换。因此，您可以将其绑定到您的 base64 字符串属性，并让转换器处理其余部分。

```
 public class ByteToImageConverter : IValueConverter
        {
            public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
            {
                if(string.IsNullOrEmpty(value.ToString())return;
                var imgBytes = Convert.FromBase64String(value.ToString());
                if (imgBytes == null)
                    return null;
                using (var stream = new MemoryStream(imgBytes))
                {
                    return BitmapFrame.Create(stream,
                        BitmapCreateOptions.None, BitmapCacheOption.OnLoad);
                }
            }

            public object ConvertBack(object value, Type targetType, object parameter,
                System.Globalization.CultureInfo culture)
            {
                throw new NotImplementedException();
            }
        } 
```

# asp.net - IIS - Different processing of default document in Integrated Pipeline mode?

> ID：593390
> 
> 赞同：2
> 
> 时间：2009-02-27T03:20:20.487
> 
> 标签：asp.net, iis, iis-7, httpmodule

I have an HTTP Module to handle authentication from Facebook, which works fine in classic pipeline mode.

In integrated pipeline mode, however, I'm seeing an additional request pass through for the default document, which is causing the module to fail. We look at the request (from Facebook) to retrieve and validate the user accessing our app. The initial request authenticates fine, but then I see a *second* request, which lacks the posted form variables, and thus causes authentication to fail.

In integrated pipeline mode, an http request for "/" yields 2 AuthenticateRequests in a row:

1.  A request where AppRelativeCurrentExecutionFilePath = "~/"
2.  A request where AppRelativeCurrentExecutionFilePath = "~/default.aspx"

That second request loses all of the form values, so it fails to authenticate. In classic mode, that second request is the only one that happens, and it preserves the form values.

Any ideas what's going on here?

UPDATE: Here is an image of the trace from module notifications in IIS. Note that my module, FBAuth, is seeing AUTHENTICATE_REQUEST multiple times (I'd expect 2 - one for authenticate and one for postauthenticate, but I get 4).

[![Events raised multiple times](https://farm4.static.flickr.com/3389/3314934429_d1bd35ced0_m.jpg)](http://www.flickr.com/photos/lianza/3314934429/ "Events raised multiple times by tlianza, on Flickr")

I'm starting to believe this has something to do with module/filter configuration because I've found a (Vista) box running the same code that doesn't fire these events repeatedly - it behaves as expected. I'm working through trying to figure out what the difference could be...

Thanks! Tom

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-26T01:02:02.807

我的解决方案是在 Application_BeginRequest 的末尾添加以下代码：

```
if (Request.RawUrl.TrimEnd('/') == HostingEnvironment.ApplicationVirtualPath.TrimEnd('/'))
    Server.Transfer(Request.RawUrl+"Default.aspx", true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T20:27:51.717

> 不支持 DefaultHttpHandler，因此依赖 DefaultHttpHandler 子类的应用程序将无法处理请求 如果您的应用程序使用 DefaultHttpHandler 或派生自 DefaultHttpHandler 的处理程序，它将无法正常运行。在集成模式下，从 DefaultHttpHandler 派生的处理程序将无法将请求传递回 IIS 进行处理，而是将请求的资源作为静态文件提供服务。集成模式允许 ASP.NET 模块针对所有请求运行，而无需使用 DefaultHttpHandler。
> 
> **解决方法**
> 
> 更改您的应用程序以使用模块对所有请求执行请求处理，而不是使用通配符映射将 ASP.NET 映射到所有请求，然后使用 DefaultHttpHandler 派生处理程序将请求传递回 IIS。
> 
> 嗯，或者这可能是问题所在。
> 
> 处于早期请求处理阶段的 ASP.NET 模块将看到以前可能在进入 ASP.NET 之前被 IIS 拒绝的请求，其中包括在 BeginRequest 中运行的模块，看到对需要身份验证的资源的匿名请求 ASP.NET 模块可以在任何管道中运行可用于本机 IIS 模块的阶段。因此，以前可能在身份验证阶段被拒绝的请求（例如对需要身份验证的资源的匿名请求）或进入 ASP.NET 之前的其他阶段可能会运行 ASP.NET 模块。此行为是设计使然，以使 ASP.NET 模块能够在所有请求处理阶段扩展 IIS。
> 
> **解决方法**
> 
> 更改应用程序代码以避免在请求处理期间看到稍后可能被拒绝的请求而引起的任何特定于应用程序的问题。这可能涉及更改模块以订阅稍后在请求处理期间引发的管道事件。 [http://learn.iis.net/page.aspx/381/aspnet-20-break-changes-on-iis-70/](http://learn.iis.net/page.aspx/381/aspnet-20-breaking-changes-on-iis-70/)

# wpf - WPF UIElements 内嵌文本“装饰”

> ID：593391
> 
> 赞同：7
> 
> 时间：2009-02-27T03:20:40.517
> 
> 标签：wpf, text, uielement, adornment

在 WPF 中，如何将常规`UIElement`s 与文本内联？例如，某种文本分类将用包含特定选项的下拉列表替换一段文本。

我使用过像 Span、Bold、Hyperlink 这样的对象，它们对内联文本进行了一些轻微的修改，但我希望能够做一些更激烈和自定义的事情。我可以实现一个类似的内联对象来完成这个吗？

我正在做一个需要一些高级文本视觉效果的项目。具体来说，我想做一些类似于基于 Visual Studio 2010 WPF 的源代码编辑器。

我将有一段文本，各种组件将查看该文本以搜索具有特殊含义的片段。当它找到一段文本时，它将记录/标记该跨度。然后另一组组件将遍历分类文本并根据它们的分类添加装饰。

你可以把它想象成 WPF 的智能标签。

我真的不知道从哪里开始，WPF 中有关高级文本的所有文档都是关于动画、自定义画笔、转换为几何图形等...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-27T05:27:58.383

看看[`InlineUIContainer`](http://msdn.microsoft.com/en-us/library/system.windows.documents.inlineuicontainer.aspx)和[`BlockUIContainer`](http://msdn.microsoft.com/en-us/library/system.windows.documents.blockuicontainer.aspx)类。它们允许将`UIElement`s 嵌入到流内容中，例如`FlowDocument`或`TextBlock`。

这是一个内联在 a 中的 Button 示例`TextBlock`：

```
<TextBlock>
    Some inline
    <InlineUIContainer>
        <Button Content="Hi" Click="Button_Click" />
    </InlineUIContainer>
    inside the text.
</TextBlock> 
```

# php - Maxmind 地理定位 API：Apache 与 PHP

> ID：593401
> 
> 赞同：2
> 
> 时间：2009-02-27T03:28:03.710
> 
> 标签：php, performance, apache2, geolocation

我希望基于[Maxmind geoip 数据库](http://www.maxmind.com/app/geolitecountry)（免费版）在我的网站上实施一个非常基本的国家限制。基本上，我只想将网站的所有用户限制在一个国家/地区。我想知道的是：与[PHP API相比，使用](http://www.maxmind.com/app/php)[Apache API](http://www.maxmind.com/app/mod_geoip)是否有任何性能提升？

我希望能够将国家代码用于不仅仅是简单的重定向（以不同的语言显示消息等），这就是我倾向于 PHP 的原因，但我的首要问题是对性能的影响。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T03:33:16.117

apache API 的主要优点是永远不会调用 PHP（除非您随后重定向到 PHP 页面）。

因此，决策会更快做出，并且您可以更好地控制它是否会影响您的表现。

除此之外，没有太大的区别。

-亚当

# c++ - 始终在前的对话框

> ID：593403
> 
> 赞同：12
> 
> 时间：2009-02-27T03:28:41.730
> 
> 标签：c++, mfc, dialog, modeless, always-on-top

有没有办法在 C++ MFC 中创建一个始终位于应用程序中其他窗口之上的*无模式对话框？*我想的有点像 Visual Studio 2005 中的“查找”对话框——它位于顶部，但您仍然可以编辑底层文本。

（如果有什么不同，那不是 MDI；它是一个基于对话框的应用程序）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-27T03:37:42.410

*注意：这在 Windows 10 下不起作用，并且可能在 Windows 7 和 8 下不起作用（报告各不相同）。*

从[尼什](http://www.voidnish.com/Articles/ShowArticle.aspx?code=dlgboxtricks)：

> ###让你的对话框保持在最前面
> 
> 您没有看过具有“始终保持领先”选项的程序吗？令人难以置信的是，您只需一行代码就可以使您的对话框保持在最前面。只需将以下行放在对话框类的 OnInitDialog() 函数中。
> 
> ```
> SetWindowPos(&this->wndTopMost,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE); 
> ```
> 
> 基本上我们正在做的是使用 SetWindowPos 函数来改变我们的对话窗口的 Z 顺序。我们通过将对话框移动到 Z 顺序的顶部，使我们的对话框保持在所有其他窗口的顶部。现在，即使您激活了其他窗口，我们的窗口也将保持在顶部。但是我建议您确保在执行此操作时确切地知道自己在做什么，因为如果他们在想要这样做时无法将您的窗户移开，可能会惹恼他们。

正如您在评论中提到的，上面的行使窗口位于每个应用程序的顶部。你需要做

```
SetWindowPos(&this->wndTop,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE); 
```

使窗口仅位于您的应用程序之上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-19T18:54:37.907

对于 Windows 7 或更高版本，接受的答案失败。（或者也许是我）但是将无模式对话框设置为弹出窗口而不是子窗口可以解决它。它现在位于主对话框窗口中，但您可以编写代码以在任何地方进行约束。使用无边框或顶栏使其成为一个简单的窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-03T16:38:10.870

它在 Microsoft Windows 版本中对我有用`10.0.18362.476`。必须放入并将对话框制作`SetWindowPos(&this->wndTopMost,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE);`为.`OnInitDialog``PopUp`

# deployment - 在诺基亚手机上部署 midlet

> ID：593404
> 
> 赞同：1
> 
> 时间：2009-02-27T03:28:42.837
> 
> 标签：deployment, java-me, nokia, midlet

我编写了一个 midlet，它询问用户名和密码并连接到运行在 tomcat 上的 servlet 进行验证。当我在 sun toolkit 提供的模拟器上运行 midlet 时，它第一次询问“此 midlet 想要连接到 http://... 使用通话时间”并询问用户许可。我想知道有没有办法摆脱这个？一旦这个应用程序安装在真正的手机上，它会在每次应用程序启动时询问用户许可，还是可以在安装时设置？

其次，如何在诺基亚 E65 上部署我的 midlet jar？

* * *

我使用手机附带的诺基亚软件在手机上部署我的应用程序。每当我启动应用程序时，它第一次问我“这个 midlet 想要连接到 http://... 使用通话时间”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T08:07:49.407

首先是广告：您需要为您的 midlet 设置适当的安全权限，其次您需要使用设备信任的某种证书对其进行签名。这对于模拟器来说很容易，您可以在其中创建自签名 CA 并导入到模拟器密钥库中。对于真实设备，您可能需要一些商业（付费）证书。

第二个广告：您可能需要通过 HTTP 使 midlet JaD/Jar 可用。您是否尝试将 jar/jad 上传到手机并在那里“启动”它。诺基亚 PC 套件附带的诺基亚应用程序管理器可能也是一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T12:06:58.450

如果您想摆脱（扩展）这些类型的权限问题，您需要签署应用程序。签名的应用程序可以更多地访问设备的资源，例如相机、网络。用户还可以设置应用程序的权限，如“第一次询问”、“每次询问”、“不允许”等...如果应用程序被签名，您将获得更多这些选项。

要部署您可以使用诺基亚提供的软件，PC 套装。或者您可以使用 OTA 方法将已签名（或未签名）的 jar 和 jad 文件上传到网络服务器，然后使用移动浏览器从那里下载。只需从您的移动浏览器打开 jad 文件，它将验证证书并下载并安装 jar 文件。

在您准备好应用程序之前，第一种方法就足够了。

# java-me - 通过宽带或 GPRS 连接 Midlet

> ID：593408
> 
> 赞同：1
> 
> 时间：2009-02-27T03:32:36.290
> 
> 标签：java-me, midp, midlet, gprs

Midlet 使用 HttpConnection 连接一个 webservice 应用程序。

移动设备可以使用无线宽带连接到互联网，也可以使用网络提供商提供的互联网设施，即沃达丰或维珍，我认为这被称为 GPRS。如果我的理解有误，请纠正我。

现在我的问题是 midlet 何时运行它将使用哪个连接？其次，我是否需要为 midlet 编写不同的代码才能使用 GPRS 或者没关系？

* * *

我在诺基亚 E65 上部署了我的应用程序，它询问我要使用哪个连接。手机同时启用了无线局域网和提供商 GPRS。

在 iPhone 上，首选是无线局域网。（与 J2me 无关）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T11:17:26.560

J2ME 中没有标准的接入点选择 APi。

这意味着 MIDlet 本身无法决定是使用 Wi-Fi 还是 GPRS。

一些手机将允许用户更改应用程序设置，以强制 MIDlet 在可用时使用特定网络（并可能在首选网络不可用时提示用户选择替代网络）。

这主要是因为没有标准的方式来描述包含足够信息的无线网络：QoS、下载和上传的每字节成本、平均比特率、ping 时间......

在大多数情况下，在没有这些信息的情况下自动选择网络的逻辑太复杂且不够可靠。

迄今为止，手动选择接入点是让用户负责数据传输成本的唯一方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T09:14:04.167

这取决于客户的手机。在某些型号上，所有应用程序（包括 midlets）只使用一种 GPRS 配置，在其他一些型号上，用于浏览的配置可能与 midlets 使用的配置不同。

# wpf - WPF Label FontSize and FontFamily correct in designer, but wrong at runtime

> ID：593411
> 
> 赞同：1
> 
> 时间：2009-02-27T03:33:27.350
> 
> 标签：wpf, rendering, label, styles

I have created a WPF application and set style of the controls using styles. I have a problem on some controls such as Label where I have set `FontSize`, `FontWeight`, `FontFamily` etc. All values are working as expected, except `FontSize` and `FontFamily` don't seem to be working correctly at runtime. (At design time `FontSize` and `FontFamily` seem to change to the value I have set.)

I have tried to capture the Style of each control at runtime and I found that the values of `FontSize` and `FontFamily` are correct (same value as I have set).

Anyone have an idea about or experience with this kind of problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T11:08:03.763

Is it possible that you specified these values some place else that has a higher priority then your style? (eg local property values or triggers)

a code example could clear things up...

# c - 如何测试静态函数

> ID：593414
> 
> 赞同：51
> 
> 时间：2009-02-27T03:33:43.603
> 
> 标签：c, unit-testing

在对一些 C 代码进行单元测试时，我们遇到了一个问题，即在不修改源代码的情况下，无法在测试文件中调用某些静态函数。有没有简单或合理的方法来克服这个问题？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-02-27T03:38:11.613

我有一个测试工具。在可怕的情况下——比如尝试测试静态函数，我使用：

```
#include "code_under_test.c"
...test framework... 
```

也就是说，我在测试工具中包含了包含被测函数的整个文件。这是最后的手段——但它确实有效。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-27T03:46:11.390

你能提供更多关于为什么你不能调用这个函数的信息吗？

它是否不可用，因为它对 .c 文件是私有的？如果是这样，最好的办法是使用允许访问该函数的条件编译，以允许其他编译单元访问它。例如

SomeHeaderSomewher.h

```
#if UNIT_TEST
#define unit_static 
#else
#define unit_static static
#endif 
```

Foo.h

```
#if UNIT_TEST
void some_method
#endif 
```

Foo.cpp

```
unit_static void some_method() ... 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-27T03:49:36.733

对于单元测试，我们实际上在源文件本身中有测试代码，我们在测试时有条件地编译它。这使单元测试可以完全访问所有函数和文件级变量（静态或其他）。

单元测试本身不是静态的——这允许我们从单个超级测试程序调用单元测试，该程序对所有编译单元进行单元测试。

当我们发布代码时，我们有条件地编译出单元测试，但这实际上并不是必需的（如果您想确定您发布的代码与您测试的代码**完全相同）。**

我们一直发现将单元测试与您正在测试的代码放在同一个地方是非常宝贵的，因为它使您在代码更改时需要更新测试变得更加明显。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-27T03:39:55.540

不 - 你不能直接测试静态函数而不修改源代码（这是 C 中静态的定义 - 不能从不同文件中的函数调用它）。

您可以在仅调用静态函数的测试文件中创建一个单独的函数吗？

例如：

```
//Your fn to test
static int foo(int bar)
{
  int retVal;
  //do something
  return retVal;
}

//Wrapper fn
int test_foo(int bar)
{
  return foo(bar);
} 
```

我们通常不直接测试我们的静态函数，而是确保它们执行的逻辑通过调用函数的不同测试得到充分测试。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-27T06:02:19.817

静态函数本质上是公共（即公开）函数的辅助函数。因此，IMO，您的单元测试应该调用公共接口，并使用在静态函数中执行所有路径的输入。

应该使用公共函数的输出（返回值/副作用）来测试静态的效果。

这意味着您需要有适当的存根来“捕捉”这些副作用。（例如，如果一个函数调用文件 IO，您需要提供存根来覆盖这些文件 IO 库函数）。通过使每个测试套件成为单独的项目/可执行文件并避免链接到任何外部库函数来做到这一点的最佳方法。您甚至可以模拟 C 函数，但这不值得。

无论如何，这是我迄今为止使用的方法，它对我有用。祝你好运

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-10-07T14:13:22.747

```
#define static 
```

这是一个非常糟糕的主意。如果您将变量声明为函数的局部变量，它会更改函数的行为。例子：

```
static int func(int data)
{
   static int count = 0;

   count += data;
   return count;
} 
```

您可以从单元测试中调用该函数，因为 func() 将被导出，但是代码的基本功能将被修改。

--库尔特

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-01-28T08:13:52.597

如果您在 Unix 环境下，您可以在测试文件中包含带有静态函数声明的附加标头，`yourheader_static.h`并将 obj 文件转换为全球化本地符号。它们将是可见的，就好像它们是非静态函数一样。`code_under_test.o``objdump --globalize-symbols=syms_name_file`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-01-18T21:53:02.187

只是为了补充 Jonathan Leffler 接受的答案，并详细说明其他人提到的包装函数：

1.  创建一个测试源文件，如 test_wrapper_foo.c，其中 foo.c 是原始文件。
2.  在 test_wrapper_foo.c 中：

> ```
> #include "foo.c"   
> 
> // Prototype
> int test_wrapper_foo();
> 
> // wrapper function
> int test_wrapper_foo() {
>     // static function to test
>     return foo();
> } 
> ```

假设 foo.c 中的静态函数 foo 有原型： int foo(void);

3.  通过您的 makefile 而不是 foo.c 构建 test_wrapper_foo.c （请注意，这不会破坏其他外部函数对 foo.c 中函数的任何依赖）

4.  在您的单元测试脚本中，调用 test_wrapper_foo() 而不是 foo()。

这种方法使原始源保持不变，同时让您可以从测试框架访问该函数。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T03:37:52.080

您可以添加一个非静态函数来调用静态函数，然后调用非静态函数。

```
static int foo ()
{
   return 3;
}

#ifdef UNIT_TEST
int test_foo ()
{
  if (foo () == 3)
    return 0;

  return 1;
}
#endif 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-13T23:12:26.173

如果您正在使用 Ceedling 并尝试使用 #include "code_under_test.c" 方法，则测试构建将失败，因为它会在 #included 时自动尝试构建一次 "code_under_test.c" 并且因为它是测试的目标.

我已经能够通过对 code_under_test.c 代码的轻微修改和其他一些更改来解决它。用这个检查包装整个 code_under_test.c 文件：

```
#if defined(BUILD)
...
#endif // defined(BUILD) 
```

将此添加到您的测试工具中：

```
#define BUILD
#include "code_under_test.c" 
```

将`BUILD`定义添加到您的 Makefile 或项目配置文件中：

```
# Makefile example
..
CFLAGS += -DBUILD
.. 
```

您的文件现在将从您的环境构建，并包含在您的测试工具中。Ceedling 现在将无法再次构建文件（确保您的 project.yml 文件未定义 BUILD）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-14T03:03:09.800

以上所有建议的答案（少数除外）都建议进行条件编译，需要修改源代码。因此这不应该是一个问题，它只会增加混乱（仅用于测试）。相反，你可以做这样的事情。

假设您要测试的功能是

```
static int foo(int); 
```

您制作了另一个名为 testing_headers.h 的头文件，其中包含以下内容 -

```
static int foo(int);
int foo_wrapper(int a) {
    return foo(a);
} 
```

现在，在编译 c 文件进行测试时，您可以强制从编译器选项中包含此标头。

对于 clang 和 gcc，标志是`--include`. 对于 Microsoft C 编译器，它是`/FI`.

这将需要对您的 c 文件进行绝对 0 更改，并且您将能够为您的函数编写一个非静态包装器。

如果您不想要一个非静态包装器，您还可以创建一个初始化为 foo 的非静态全局函数指针。

然后，您可以使用此全局函数指针调用该函数。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-08-16T09:49:54.273

有两种方法可以做到这一点。

1.  将c源文件包含到单元测试源文件中，因此静态方法现在在单元测试源文件的范围内并且可以调用。

2.  做一个技巧：

`#define static`

在单元测试源文件的头部。

它会将关键字转换`static`为“无”，或者我可以说，它会`static`从您的 c 源代码中删除。

在一些单元测试工具中，我们可以使用配置选项“预处理器”来做这个技巧，只需放入配置：

`static=`

该工具会将所有`static`关键字转换为“无”

但我必须说，使用这些方式会使`static`方法（或变量）失去它的特定含义。

# javascript - 您如何从不同的域动态加载 javascript 文件？

> ID：593419
> 
> 赞同：5
> 
> 时间：2009-02-27T03:36:55.937
> 
> 标签：javascript

我发现这个优秀的代码，由[aemkei](https://stackoverflow.com/users/28150/aemkei)发布，作为这些问题的答案：

1.  [你如何动态加载一个javascript文件？（想想 C 的#include）](https://stackoverflow.com/questions/21294/how-do-you-dynamically-load-a-javascript-file-think-cs-include)
2.  [根据需要使用 javascript 注入脚本引用？](https://stackoverflow.com/questions/203113/use-javascript-to-inject-script-references-as-needed)

> 您可以编写动态脚本标签（使用 Prototype）：
> 
> ```
> new Element("script", {src: "myBigCodeLibrary.js", type: "text/javascript"}); 
> ```
> 
> 这里的问题是我们不知道外部脚本文件何时完全加载。
> 
> 我们经常希望我们的依赖代码在下一行，并且喜欢编写如下内容：
> 
> ```
> if (iNeedSomeMore){
>   Script.load("myBigCodeLibrary.js");  // includes code for myFancyMethod();
>   myFancyMethod();                     // cool, no need for callbacks!
> } 
> ```
> 
> 有一种无需回调即可注入脚本依赖项的聪明方法。您只需通过同步 AJAX 请求提取脚本并在全局级别评估脚本。
> 
> 如果您使用 Prototype，则 Script.load 方法如下所示：
> 
> ```
> var Script = {
>   _loadedScripts: [],
>   include: function(script){
>     // include script only once
>     if (this._loadedScripts.include(script)){
>       return false;
>     }
>     // request file synchronous
>     var code = new Ajax.Request(script, {
>       asynchronous: false, method: "GET",
>       evalJS: false, evalJSON: false
>     }).transport.responseText;
>     // eval code on global level
>     if (Prototype.Browser.IE) {
>       window.execScript(code);
>     } else if (Prototype.Browser.WebKit){
>       $$("head").first().insert(Object.extend(
>         new Element("script", {type: "text/javascript"}), {text: code}
>       ));
>     } else {
>       window.eval(code);
>     }
>     // remember included script
>     this._loadedScripts.push(script);
>   }
> }; 
> ```

我发现，如果所有代码都在 'file://' 协议中执行，则代码在 IE 上不起作用，但是，这不是问题，因为它的用例涉及真正的 Web 应用程序。

我曾经尝试过一次，通过谷歌包含**[http://www.google-analytics.com/urchin.js](http://www.google-analytics.com/urchin.js)**，但是来自网页之一，但看起来它无法从不同的域请求 javascript 文件。

我们如何动态添加 javascript，就像上面的脚本一样，但是来自另一个域？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T04:05:24.853

您可以使用`onload`and`onreadystatechange`事件来了解`<script>`标签的加载时间。

```
var script = new Element("script", {src: "myBigCodeLibrary.js", type: "text/javascript"});

script.onload = script.onreadystatechange = function(){
    if (!this.readyState ||
        this.readyState == "loaded" || this.readyState == "complete") {
        //script is loaded
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T03:45:21.797

现代浏览器中的安全模型阻止 JavaScript 发出跨域请求。这有漏洞（查看自互联网开始以来的每个网站漏洞），但使用它们不仅仅是有点阴暗，修补它们只是时间问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T03:58:17.460

Rex 说的是对的，虽然 HTML5 添加了跨域消息传递和 xhr，这需要你做一些工作，但应该可以用来实现这一点。唉，它们还没有出现在所有已发布的浏览器中（我认为 safari、firefox 和 IE 的最新测试版支持其中一些功能，但我不确定哪些浏览器支持哪些 api）

# php - 在 PHP 中存储配置变量的最佳方法是什么？

> ID：593440
> 
> 赞同：25
> 
> 时间：2009-02-27T03:47:58.437
> 
> 标签：php, configuration-files

我需要在 PHP 中存储一堆配置信息。

我考虑了以下......

```
// Doesn't seem right.
$mysqlPass = 'password'; 

// Seems slightly better.
$config = array(
     'mysql_pass' => 'password'
);

// Seems dangerous having this data accessible by anything. but it can't be
// changed via this method.
define('MYSQL_PASSWORD', 'password'); 

// Don't know if this is such a good idea.
class Config
{
    const static MYSQL_PASSWORD = 'password';
} 
```

这就是我到目前为止所想到的。我打算将此配置信息导入到我的应用程序中`require /config.inc.php`。

在存储配置数据方面什么对您有用，什么是最佳实践？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T03:57:32.627

我一直选择选项＃2，只是确保除了所有者之外没有人可以访问它。它是 Joomla、vBulletin、Gallery 等 PHP 应用程序中最流行的方法。

第一种方法对我来说太乱了（可读性），第三种方法太危险了。我从来没有想过 Class 方法，所以其他人可以提供他们的输入。但我想只要在课堂上使用正确的访问权限就可以了。

* * *

例子..

```
define('EXAMPLE1', "test1"); // scenario 1
$example2 = "test2"; // scenario 2

function DealWithUserInput($input)
{
   return eval($input);
} 
```

现在这个代码示例真的很愚蠢，但只是一个示例。根据用户可以尝试在输入中使用的场景，考虑函数可能返回的内容。

方案 2 仅在您将其设为函数内的全局时才会导致问题。否则，它超出范围且无法访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T18:43:01.670

我想说这也取决于用户群。如果配置必须非常用户友好，或者用户必须能够通过 Web 等更改配置。

我为此使用[Zend Config Ini](http://framework.zend.com/manual/en/zend.config.adapters.ini.html)，其他设置存储在 SQL DB 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T04:58:54.897

我一般使用第二种方法...处理数据库连接时，我一般在请求开始时打开一个连接，然后在结束时关闭它。我有一个建立连接的函数，然后从全局数组中删除用户名/密码（使用 unset() 函数），这可以防止系统的其他部分访问“敏感”mysql连接数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T05:21:11.927

对于大多数配置值，我也使用选项 2。如果您要实现该类*，*那么我会将特定值与它影响的类联系起来，而不是一般的配置类。

在您的示例中，您的类将用于数据库连接，并且一个实例将保存密码、db_name 等。这将正确封装数据，并提供一种简单的方法来创建多个连接（如果需要）。

# javascript - Ajax 回调函数作用域和链接 Ajax 请求与回调

> ID：593441
> 
> 赞同：0
> 
> 时间：2009-02-27T03:49:10.353
> 
> 标签：javascript, object, scope

好的。这是场景：

```
function DataFeed(){

  function PopulateData()
  {
    $('div#example').load('http://www.example.com', fxnCallBack);
  };

  function fxnCallBack()
  {
    PopulateData();
  }

  this.activator = function() {
    PopulateData();
  }

};

var example_obj = new DataFeed;
example_obj.activator(); 
```

在上面的代码中，ajax .load 被执行一次，然后回调执行。但是回调不会再次启动ajax函数？

提前致谢。

编辑-为什么它不能正确显示新行-.-

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T03:58:03.560

```
InternalError: too much recursion 
```

JavaScript 引擎通常对递归次数或递归执行可能花费的时间有一个最大限制。请改用**setInterval**：

```
function DataFeed() {
    var interval;
    function PopulateData() { 
        $('div#example').load('http://www.example.com', function(data) {
            if(data == "clear_interval")
                interval = clearInterval(interval); // clear the interval
        }); 
    }

    this.activator = function() { 
        interval = setInterval(PopulateData, 1000); // run every second
    };
}
var example_obj = new DataFeed();
example_obj.activator(); 
```

# asp.net - 使用 jQuery 抓取图像尺寸时遇到问题

> ID：593449
> 
> 赞同：1
> 
> 时间：2009-02-27T03:52:54.243
> 
> 标签：asp.net, javascript, jquery, css

我很难学会如何使用 jQuery 获取元素的尺寸。这是我的示例代码：

```
$(document).ready(function() {
        var width = $("#image_1").width();
        var height = $("#image_1").height();
        document.write(width);
        document.write(height);
    }); 
```

现在当然我有一个ID为#image_1的图像。当我尝试运行它时会发生什么，它输出两个零。两次不为空，或两次未定义。

感谢 javascript 新手的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T04:40:54.613

即使您已经选择了一个答案，我仍在输入这个答案，以便您了解为什么您之前的代码不起作用。

jQuery 的 document.ready 函数在图像加载之前触发。改用 window.load ...

```
$(window).load(function() {
  var width = $("#image_1").width();
  var height = $("#image_1").height();
  document.write(width);
  document.write(height);
}); 
```

对于它的价值，我认为最好使用 jQuery 来完成这项任务，因为它具有固有的跨浏览器功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T04:06:48.720

`0`如果图像不可见，您可能会得到宽度和高度。（这就是我刚刚发生的事情。）

**更新**：您可以通过检查 jQuery 对象的长度属性来确认图像已添加到 DOM：

```
var inDOM = ($('#image_1').length > 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T05:40:27.280

也许这是您问题中的一个错字，但是您的图像 ID 真的是“#image_1”吗？为了使您的代码正常工作，它应该只是“image_1”。"#" 仅在 jquery 选择器中用于指定它后面的文本是一个 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T04:18:33.543

这对我有用：

```
<head>
    <script type="text/javascript">
        function foo() {
            var image = document.getElementById("the_image");
            alert(image.offsetWidth);
            alert(image.offsetHeight);
        }
    </script>
</head>
<body onload="foo();">
    <img src="img.png" id="the_image">
</body> 
```

只要图像未设置为`display: none;`Using`offsetWidth`并且`offsetHeight`还具有根本不需要 jQuery 的优点，它就可以工作。

# vb.net - 基于 Web 的还是通过 VPN 的胖客户端？

> ID：593452
> 
> 赞同：0
> 
> 时间：2009-02-27T03:55:38.870
> 
> 标签：vb.net, vpn

在我临时聘用的一家电力公司，我们必须对计费和支付系统进行升级（当前系统是dbaseIII系统）。该公司的程序员和我决定使用 VB.Net 和 MySQL。

该公司为多个城镇提供服务，并在选定的城镇设有计费和支付中心。每个计费周期，抄表员都会读取每个电表的读数，然后将读数写入表中。每下午 5 点，中心的一名员工会收集表格，然后前往主要中心，在那里对读数进行编码。

账单在主中心打印，然后分发到分支机构。

在与总经理和公司负责人的讨论中，我们两个人的任务是利用互联网，因为中心所在的城镇有互联网连接，对于那些没有的城镇，我们可以使用移动互联网。

新系统将允许用户输入读数，然后将数据发送到主分支中的主服务器。他们还可以下载和打印账单。

我们现在的问题是我们必须实施什么类型的系统。它应该是基于 Web 的应用程序还是将通过 vpn 连接到我们的数据库服务器的桌面应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T04:14:17.610

如果这是一个固定价格项目，并且客户端将接受 Web 或桌面，请使用桌面 VPN。您将节省大量时间，并拥有更具响应性的东西（从用户的角度来看）。

但是，如果您认为客户端最终需要在移动设备或 Web 上使用该产品，那么您使用 winforms 是在自取其辱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T12:47:18.033

在通过 VPN 使用胖客户端有一些经验后，我会说使用某种网络应用程序。如果做错了，由于数据搅动，通过 VPN 使用胖客户端会变得非常痛苦。Web 应用程序将所有这些都集中在服务器上，从这个角度来看，这使它变得更好。

其他福利：

*   没有部署麻烦

*   不能从用户机器直接访问数据库。

显然，这也取决于你的技能，以及你有多少时间/预算......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T04:26:41.950

我认为答案取决于您需要进行的数据库查询的类型/频率。通过 VPN 从胖客户端查询数据库可能是 SLOOOOOWWWWWW。在 Web 应用程序中，应用程序逻辑运行在靠近数据库的位置，甚至可能在同一台机器上，因此数据库查询速度很快。缺点是 UI 可能会更慢。但是设计一个响应式的基于 Web 的 UI 可能比快速 VPN 更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T05:18:04.070

我不知道客户的情况……但是让他们两全其美呢？考虑到您将在基于 Windows 的系统上进行编程，并且可以部署基于 Windows 服务器的硬件，为什么不构建 Silverlight 应用程序，或者构建一个托管在 IE 窗口中的 WPF 应用程序呢？这可以给你两全其美？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T11:45:39.990

您的收款人将使用什么工具？1>带移动 InetConnection 的笔记本电脑 2>或专门的手持工具读取账单并发送到服务中心？

1> 如果是笔记本电脑，那么您可以创建只有授权人才能登录的网站，然后他可以插入数据库。您可以使用 HTTP 来获得更好的安全性。

# windows-services - 创建 Windows 服务的最简单语言

> ID：593454
> 
> 赞同：55
> 
> 时间：2009-02-27T03:56:13.970
> 
> 标签：windows-services

构建 Windows 服务最简单的语言是什么？

在这种情况下，最简单的定义是代码量最少，并且进入语言的最低点。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2009-02-27T07:08:45.193

冒着明显的风险，如果你有任何 C/C++/Java 背景，我认为 C# 为你提供了最低的入门点。

假设您使用的是 Visual Studio 2008，您可以按照以下步骤操作：

1.  打开 Visual Studio 2008，然后选择 File|New|Project 菜单选项。
2.  在“新建项目”对话框中...
    *   在项目类型中选择 Visual C#|Windows 节点
    *   选择 Windows 服务模板
    *   输入项目的名称和位置
    *   按确定
3.  至此，您已经掌握了 Windows 服务的所有基础知识。Program.cs 文件包含您的服务的 Main() 方法，Service1.cs 定义 System.ServiceProcess.ServiceBase 组件，它是您的新 Windows 服务。
4.  在 Service1 组件的属性网格中，考虑至少设置以下属性：
    *   (Name) - 给你的对象一个直观的名字，例如，ServiceExample
    *   AutoLog - 设置为`false`默认防止事件写入应用程序事件日志（注意：我并不是说您不应该记录服务事件；我只是更喜欢写入我自己的事件日志而不是应用程序日志 - 见下文)
    *   CanShutdown -`true`如果要处理系统关闭，请设置为
    *   ServiceName - 定义服务控制管理器 (SCM) 知道您的服务的名称
5.  在 ServiceExample 的代码中，OnStart() 和 OnStop() 虚函数被删除。您需要用您的服务显然需要做的任何事情来填写这些内容。如果您将 CanShutdown 属性更改为`true`，您还需要覆盖 OnShutdown 方法。我在下面创建了一个示例来说明这些函数的使用。
6.  至此，ServiceExample 服务基本完成，但您仍然需要一种方法来安装它。为此，请在设计器中打开 ServiceExample 组件。右键单击设计器面板中的任意位置，然后选择“添加安装程序”菜单选项。这会在您的项目中添加一个 ProjectInstaller 组件，其中包含两个附加组件 - serviceProcessInstaller1 和 serviceInstaller1。
7.  在设计器中选择 serviceProcessInstaller1 组件。在属性网格中，考虑设置以下属性：
    *   (Name) - 给你的对象一个直观的名字，例如 serviceProcessInstaller
    *   帐户 - 至少选择 LocalService 帐户，但如果您的服务需要更多权限，您可能必须使用 NetworkService 或 LocalSystem 帐户
8.  在设计器中选择 serviceInstaller1 组件。在属性网格中，考虑设置以下属性：
    *   (Name) - 给对象一个直观的名称，例如 serviceInstaller
    *   描述 - 将显示在您的服务的 SCM 中的服务描述
    *   DisplayName - 您的服务的友好名称，它将显示在您的服务的 SCM 中
    *   ServiceName - 确保这与您为 ServiceExample 组件的 ServiceName 属性选择的名称相同（请参阅步骤 4）
    *   StartType - 指明您希望服务自动启动还是手动启动
9.  请记住，我说过我更喜欢将事件写入我自己的事件日志而不是应用程序事件日志。为此，您需要将 ProjectInstaller 中的默认 EventLogInstaller 替换为自定义的。使 ProjectInstaller 的代码如下所示：

* * *

```
using System.Diagnostics;
[RunInstaller(true)]
public partial class ProjectInstaller : Installer
{
    public ProjectInstaller()
    {
        InitializeComponent();

        EventLogInstaller installer = FindInstaller(this.Installers);
        if (installer != null)
        {
            installer.Log = "ServiceExample"; // enter your event log name here
        }
    }

    private EventLogInstaller FindInstaller(InstallerCollection installers)
    {
        foreach (Installer installer in installers)
        {
            if (installer is EventLogInstaller)
            {
                return (EventLogInstaller)installer;
            }

            EventLogInstaller eventLogInstaller = FindInstaller(installer.Installers);
            if (eventLogInstaller != null)
            {
                return eventLogInstaller;
            }
        }
        return null;
    }
} 
```

此时，您可以构建您的项目以获取您的 Windows 服务可执行文件。要安装您的服务，请打开 Visual Studio 2008 命令提示符，然后导航到可执行文件所在的 Debug 或 Release 目录。在命令提示符处，键入以下内容： **InstallUtil ServiceExample.exe**。这将在本地机器上安装您的服务。要卸载它，请在命令提示符处键入以下内容： **InstallUtil /u ServiceExample.exe**

只要您的服务没有运行，您就可以对您的服务进行更改并重新构建，也就是说，您不必卸载您的服务来对其进行更改。但是，只要它正在运行，您就无法用您的修复和增强功能覆盖可执行文件。

要查看您的服务，请打开 ServiceExample.cs 文件并进行以下更改：

```
using System.Diagnostics;
public partial class ServiceExample : ServiceBase
{
    public ServiceExample()
    {
        // Uncomment this line to debug the service.
        //Debugger.Break();

        InitializeComponent();

        // Ties the EventLog member of the ServiceBase base class to the
        // ServiceExample event log created when the service was installed.
        EventLog.Log = "ServiceExample";
    }

    protected override void OnStart(string[] args)
    {
        EventLog.WriteEntry("The service was started successfully.", EventLogEntryType.Information);
    }

    protected override void OnStop()
    {
        EventLog.WriteEntry("The service was stopped successfully.", EventLogEntryType.Information);
    }

    protected override void OnShutdown()
    {
        EventLog.WriteEntry("The service was shutdown successfully", EventLogEntryType.Information);
    }
} 
```

使用这些更改运行服务后，您可以查看事件查看器中的 ServiceExample 事件日志并查看记录在那里的消息。

希望这可以帮助。

编辑：如果您更喜欢使用应用程序事件日志而不是自定义事件日志记录，只需不更改 ProjectInstaller.cs 文件。此外，省略在 ServiceExample 构造函数中设置 EventLog 的 Log 属性的行。当您运行服务时，您的日志消息将出现在应用程序事件日志中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T05:10:25.480

我同意在其他地方做出回应的每个人的观点，但我想说不要过多关注实际语言，只要您在 .NET 框架中工作，并且有一个适合您的入门项目，您就可以去。我过去做过几个“Windows 服务”，并用 VB.NET 和 C# 用最少的代码开发它们。

我建议 OP 做的是学习如何为其构建安装程序包。安装该服务就像执行“installutil.exe {drive}\path\to\file.exe”一样简单，但是当您必须做比部署“hello world”Windows 服务更大的事情时，最好了解并了解如何以有意义的方式部署服务。

不是要引发一场激烈的战争，但我已经“标准化”了在我所有的部署包中使用[WiX](http://en.wikipedia.org/wiki/WiX)，除了做老式的 COM 互操作类型的东西，因为这是正确安装的首当其冲的工作。我渴望 WiX 团队开发引导程序，允许您将先决条件和主 msi 放入可以下载的 EXE 文件中。他们将它定为 3.5，所以我会耐心等待，现在使用 WinZip 自解压可执行文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T03:57:45.373

对我来说，我只尝试了几种方法，Visual Studio 和 C# 是最简单的。

Visual Studio 为框架完成了所有必要的服务管道设置，我发现 C# 非常容易学习，从 VB6、VB.NET 和 C 迁移而来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T04:01:13.693

使用 Visual C#，您将在网上找到最多的代码示例。与 Visual Studio 结合使用，只需在公园中散步即可启动并运行基本的 Windows 服务。Visual Studio 还可以轻松创建 MSI 安装程序包。

那将是我的选择

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T04:02:22.880

使用 Visual Studio 服务类型项目，使用 C# 或 VB.NET。

我个人更喜欢 C#，但总的来说很容易理解生命周期并在所需阶段编写逻辑代码。

构建安装程序也很容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T04:10:52.250

C# 中的 Windows 服务项目将通过单击按钮为您提供来自 Visual Studio 模板的完全可部署的服务。你只需要添加你的有效载荷代码。

# java - 哪些 OSS .net/java 项目最正确地利用了 SOLID 原则？

> ID：593455
> 
> 赞同：0
> 
> 时间：2009-02-27T03:56:52.520
> 
> 标签：java, .net, open-source, solid-principles

我想看看/了解如何在实际项目中以正确的方式使用可靠的原则。

还是没有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T04:14:23.663

我对一个开源游戏的工作印象深刻：星际迷航霸权 ( [http://supremacy.codeplex.com/](http://supremacy.codeplex.com/) )。除了作者尝试学习新技术之外，他还应用了一些良好的编程实践——而且他的代码读起来很愉快（例如，抓取最喜欢的饮料和令人愉快的打印输出）。

作者在网站上说：

> 我开始这个项目主要是为了获得学习经验，因此它已成为我尝试几种基于 Microsoft .NET 的新技术的测试平台，包括：
> 
> ```
> * WPF
> * WCF
> * LINQ (in-memory, DLINQ, and XLINQ)
> * Parallel Extensions
> * XNA (for 3D combat system) 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:18:04.570

<无耻插件>

你可以看看[我的项目](http://dimdwarf.sourceforge.net/)的[源代码](http://github.com/orfjackal/dimdwarf)。我尝试遵循 SOLID 原则和[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882) book 的建议。例如，遵循[SRP](http://www.objectmentor.com/resources/articles/srp.pdf)导致类非常小且集中 - 最大的类只有大约 200 LOC（计算空白、版权声明和评论时）。这一切都在 Java 中，但它与 C# 足够接近，而且原理无论如何都是相同的。

</无耻插件>

# c# - 对象引用未设置为对象错误的实例

> ID：593462
> 
> 赞同：2
> 
> 时间：2009-02-27T03:58:38.397
> 
> 标签：c#, linq

当我执行这段代码时，我收到此错误“对象引用未设置为对象错误的实例”

```
xe.Element("Product") // Select the Product desc="household" element  
.Elements() 
.Select(element => 
new { Name=(string) element.Attribute("desc"),                           
Count=element.Elements().Count() }); 
```

可能是什么原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T04:03:05.610

试着把它拆开。

```
var e = xe.Element("Product");
var elements = e.Elements();
elelements.Select(element =>... 
```

等等。找到导致错误的最小代码单元。这将有助于隔离事物。此外，使用调试器监视窗口。寻找空值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T04:05:01.003

您使用的引用之一为空。验证它`xe`是非空的，并且有一个`Product`标签，它有元素。此外，如果所选标签没有任何子元素，那么`Count`匿名类型上的属性设置也可能会生成此错误。

如果不出意外，您可以尝试将其拆分为多行，以查看哪一行引发了异常。这应该可以帮助您缩小问题的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T04:10:02.800

您是否检查过以确认 xe 不是“空”。这是您的问题的最可能原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T04:03:51.910

所有这些都可能返回 null：

```
xe.Element("Product") 

xe.Element("Product") 
.Elements() 
```

# mp3 - 从 MP3 中提取原始音频/波形

> ID：593463
> 
> 赞同：1
> 
> 时间：2009-02-27T03:58:38.770
> 
> 标签：mp3, decode, pcm, waveform

这个问题已经在我脑海中萦绕了几年，但我从未真正找到答案。

我想做的是提取 MP3 文件的实际波形/PCM，这样我就可以使用声卡播放它（当然）。

理想情况下，我会尝试一些 DSP 效果。

我的第一步是研究 LAME，但我没有发现任何与程序中的 MP3 解码相关的内容或类似的东西。

所以我问我在哪里可以找到这样的东西。

我应该使用什么语言？我在想 C，但也许有一些编程语言可以更有效地完成这项工作。

谢谢！

纪尧姆。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T05:22:53.157

问题归结为：你想要完成什么？

从您对 MP3 解码并在声卡上播放的问题的描述中，听起来好像您正在尝试制作媒体播放器。

但是，如果您的意图是玩弄 DSP 效果，那么听起来问题更多是关于处理声音而不是解码 MP3。[如果是这种情况，可能会考虑为现有媒体播放器（例如Windows Media Player](http://msdn.microsoft.com/en-us/library/aa393415.aspx)和[Winamp](http://dev.winamp.com/plugin-developers) ）编写插件，这将是您想要完成的最简单的途径。

坦率地说，从头开始学习编写自己的解码器不仅仅是一个编程问题，而是一个数学问题，因此使用现有的库是可行的方法。如果有的话，与操作系统或 DirectSound 等库对话以输出音频似乎是不必要的工作。我觉得为现有播放器开发插件是可行的方法，除非您的目标是制作自己的媒体播放器。

如果您真正想要完成的是播放音频数据，那么可能使用任何 MP3 解码器将 MP3 解码为未压缩的 PCM，然后以您选择的语言对其进行操作将实现您处理声音效果的目标。

语言选择将取决于您是否要直接与 MP3 解码库交互，或者您是否可以只使用原始音频输入，这将允许您使用几乎任何您选择的语言。

前段时间有一个类似的问题，[程序化音频入门](https://stackoverflow.com/questions/366187/getting-started-with-programmatic-audio)，我在其中发布了有关操作音频的一些基本方法的答案，例如放大、更改播放速度以及使用 FFT 进行一些工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T04:04:39.600

[libmpg123](http://www.mpg123.de/)应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T04:05:59.813

我一直在使用 Windows Media SDK，不是为了这个目的，但我很确定有钩子可以让你截取音频流，或将 MP4 转换为未压缩的 WAV。我使用了 C++。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T04:08:25.470

很多：

[http://www.mp3-tech.org/programmer/decoding.html](http://www.mp3-tech.org/programmer/decoding.html)

选择你的毒药...

此外，LAME 会解码 MP3（查看 --decode 选项），因此您可能会在该源中发现一些有趣的东西。

-亚当

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T04:45:58.283

这真的取决于你在什么平台上编程以及你想用代码做什么。如果您在 Windows 上，您应该查看[windows 媒体格式 sdk](http://msdn.microsoft.com/en-us/library/aa387410.aspx)或[DirectShow](http://msdn.microsoft.com/en-us/library/aa930379.aspx)。它们都应该能够将 mp3 文件解码为原始波形。在 Mac 上，我希望 Quicktime 也有同样的能力。其他人已经建议了 Linux/开源代码的源代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-23T17:51:12.853

我建议您查看 Cubase 和 Wavelab，因为它们都可以将 MP3 转换为 WAV 等，并允许您播放波形

# sql-server - SQL 2005 安装时出现 WMI 配置错误

> ID：593464
> 
> 赞同：0
> 
> 时间：2009-02-27T04:00:21.030
> 
> 标签：sql-server, windows, installation

SQL Server 2005 在初始安装的“系统检查”部分出现以下错误：“由于计算机上的 WMI 配置错误，无法执行 SQL Server 配置检查器：2147749907 (0x80041013)。”

机器是运行 XP SP2 的戴尔 D620。

我在网上找到了一个应该可以解决问题的批处理命令，但是没有用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T03:46:25.810

我团队的 Manju Madhavan 终于找到了答案：

```
rundll32.exe setupapi,InstallHinfSection WBEM 132 %windir%\inf\wbemoc.inf 
```

该设置要求我提供一长串文件，我必须四处搜索才能找到。有些在 XP SP3 磁盘上的 i386 文件夹中，有些在 %windir%/system32 中。由于安装程序会停下来并要求提供文件，因此我会四处搜索，直到找到副本。

Manju 在网上找到了答案，并将其记录在她的[博客上](http://manjumadhavan.blogspot.com/2009/04/wmi-failed-to-connect.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T08:21:57.903

您是否在服务器上运行 Microsoft Operations Manager？

我是否可以建议禁用任何使用 WMI 接口的服务，以便在安装 SQL Server 时禁用您正在使用的任何性能监控软件。

干杯，约翰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T15:11:32.543

1.  跑
2.  输入或复制粘贴`rundll32.exe setupapi,InstallHinfSection WBEM 132 %windir%\inf\wbemoc.inf`
3.  连接您的 Windows XP SP3 CD
4.  找到“i386”文件夹并点击回车，它会从那里复制一些文件并要求一个`.mof`文件。
5.  `.mof`在您安装 Windows 的位置搜索文件
6.  复制该文件的位置，然后单击“确定”。

开始安装 SQL Server 2005，我相信您不会再遇到任何问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T14:56:09.127

> 我不知道你找到了什么脚本，但我运行的那个脚本就像一个魅力。我在这里为那些像我一样在这篇文章中寻找错误消息的人提供这个答案。

只需执行[这个](http://www.pinaldave.com/bimg/WMIFIX.zip) *.bat*文件。

**资料来源：** [Pinal Dave 的 SQL 权威博客](http://blog.sqlauthority.com/2009/04/12/sql-server-fix-error-the-sql-server-system-configuration-checker-cannot-be-executed-due-to-wmi-configuration-on-the-machine-error2147749896-0%C3%9780041008/)

# iphone - 如何在 iPhone 上接收来自 URL 的数据？

> ID：593474
> 
> 赞同：3
> 
> 时间：2009-02-27T04:03:38.197
> 
> 标签：iphone, http, connection, nsurlconnection, communication

我正在使用 Apple 文档中的代码进行一些 HTTP 通信。我可以成功连接到 URL，但我无法从我的服务器接收数据。

```
// create the request
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://..."]
                        cachePolicy:NSURLRequestUseProtocolCachePolicy
                        timeoutInterval:60.0];
// create the connection with the request
// and start loading the data
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {
    // Create the NSMutableData that will hold
    // the received data
    // receivedData is declared as a method instance elsewhere
    NSMutableData *receivedData=[[NSMutableData data] retain];
} else {
    // inform the user that the download could not be made
} 
```

原因可能是：

1.  我`receivedData`在 Action 本身中声明。注释说我应该在别处声明它。我应该在哪里申报？我应该将其声明为控制器的财产吗？

2.  如何`[[NSMutableData data] retain]`找到 URL 之外的 URL `if{}`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T04:48:21.367

当你使用 NSURLConnection 的 initWithRequest:delegate: 方法时，数据（连同其他东西）在一系列方法调用中被发送到委托对象。这些方法都是可选的，所以如果你的委托对象没有实现它们，连接对象就会跳过它们。

方法有很多，这里就不一一列举了，但是在 NSURLConnection 文档中都有详细的描述。要获取接收到的数据，您需要在委托对象上实现 -connection:didReceiveData:。这个方法会被调用，可能不止一次，一个 NSData 对象代表新接收到的数据。然后，您可以将其附加到您现有的 NSMutableData 对象，或者用它做任何其他有意义的事情。当在委托对象上调用 -connectionDidFinishLoading: 时，您将知道您已收到所有数据。

要回答您的两个具体问题：

1.  是的，您应该将其声明为控制器对象的属性。您还应该确保在调用 NSURLConnection 的 initWithRequest:delegate: 之前分配对象，因为一旦创建连接对象，连接就会开始异步加载数据。或者，您可以在委托上实现 -connection:didReceiveResponse:，检查 HTTP 状态，然后创建数据对象。

2.  可变数据对象无法找到您设置的 URL、连接或其数据，但如果您按照我描述的步骤操作，则可以在数据进入时向其添加数据，并使用当连接完成时。

# java - 使用泛型时使用哪些规则进行类型推断

> ID：593478
> 
> 赞同：3
> 
> 时间：2009-02-27T04:04:10.677
> 
> 标签：java, generics, type-inference

有谁知道我在哪里可以找到关于在 Java 中使用泛型时类型推断如何工作的讨论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T04:36:26.043

[作为Java Specification Requests #14](http://jcp.org/en/jsr/detail?id=14)的结果，这最初在[Java Language Specification 的第 15.12.2.7 节中](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#341287)指定。

您还可以找到有关该主题的各种讨论，例如[泛型 - 从上下文中推断](http://forums.sun.com/thread.jspa?threadID=428361&forumID=316)类型或[泛型常见问题解答中的类型参数推断](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html#Type+Argument+Inference)等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T04:44:00.423

我推荐[Angelika Langer 的站点](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)以获取有关 Java 泛型的更多信息。她确实讨论过[类型推断](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#Type%20Argument%20Inference)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T04:58:01.983

我不得不读这本书：[https ://java-generics-book.dev.java.net/](https://java-generics-book.dev.java.net/)

# c++ - 在我的代码中除以零

> ID：593486
> 
> 赞同：1
> 
> 时间：2009-02-27T04:06:37.160
> 
> 标签：c++, divide-by-zero

他是我的代码，我不知道我在哪里得到除以零的问题。

**mreviewApp.cpp**

```
const int SIZE = 80;
const char DELIMIT = '|';

void parseLine(const char line[], string& title, int& rating);
void stringTrim(char st[]);
void printMrList(std::vector <Mreview> mrList);
Mreview searchTitle(std::vector <Mreview> &mrList, string title);

int main()
 {
  ifstream fin;

  fin.open("rating_list.txt");
  if (fin.fail()) {
    cerr << "Input file opening error.\n";
    exit(1);
  }

  char line[SIZE];
  string title;
  int rating;
  int lineCount = 0;

  std::vector <Mreview> mrList;

  /* Process one line at a time */
  // Read the first line
  fin.getline(line, SIZE);
  stringTrim(line);

  // Process loop
  while (strlen(line) != 0) { 
    parseLine(line, title, rating);
    lineCount++;

    Mreview review = searchTitle(mrList, title);
    review.addScore(rating);

    // Read the next line
    fin.getline(line, SIZE);
    stringTrim(line);
  }

  cout << "** PROCESS DONE. There were " << mrList.size() << " movie titles. **\n\n";

  printMrList(mrList);
  // Close the input file before exit.
  fin.close();

  system("Pause");
  return 0;
}

void parseLine(const char line[], string& title, int& rating)
{
  char s[SIZE], r[SIZE];
  const char *ptr, *temp1;
  char *temp2;

  ptr = strchr(line, DELIMIT);

  if (ptr != NULL) {
    // First grab the title string (until '|').
    temp1 = line;
    temp2 = s;
    while (temp1 != ptr)
      *temp2++ = *temp1++;

    *temp2 = '\0';

    stringTrim(s);
    title = s;

    // Second grab the rating number
    temp1 = ptr+1;
    temp2 = r;
    while (*temp1 != '\0')
      *temp2++ = *temp1++;

    *temp2 = '\0';

    stringTrim(r);
    rating = atoi(r);
  }
  else {
    title = "";
    rating = 0;
  }
}

void stringTrim(char st[])
{
  char* ptr;

  for (ptr = st; *ptr; ptr++) ;
  for (ptr--; *ptr == ' ' && ptr >= st; ptr--) ;
  ptr++;
  *ptr = '\0';

  for (ptr = st; *ptr && *ptr == ' '; ptr++) ;

  if (*ptr && ptr != st) {
    char* ptr2;
    for (ptr2 = st; *ptr; *ptr2++ = *ptr++) ;
    *ptr2 = '\0';
  }
}

void printMrList(std::vector <Mreview> mrList)
{
    std::vector<Mreview>::iterator itr;
    for(itr = mrList.begin(); itr != mrList.end(); itr++) {
        Mreview review = *(itr);
        cout << review.getTitle() << "\t\t" << review.getTotalScore() << "\t\t" << review.aveRating() << endl;
    }
}

Mreview searchTitle(std::vector <Mreview> &mrList, string title)
{
    Mreview review (title); 
    std::vector<Mreview>::iterator itr;
    for(itr = mrList.begin(); itr != mrList.end(); itr++) {
        Mreview r2d2 = *(itr);
        if(review.getTitle() == r2d2.getTitle())
            return r2d2;
    }
    mrList.push_back(review);
    return review;
} 
```

**mreview.cpp**

```
Mreview::Mreview(string ttl)
  : title(ttl), totalScore(0), numRatings(0) {}

Mreview::Mreview(string ttl, int score)
  : title(ttl), totalScore(score), numRatings(1) {}
void Mreview::addScore(int score)
{
    this->totalScore += score;
    this->numRatings += 1;
}

double Mreview::aveRating() const
{
    double rating = totalScore/numRatings;
    return rating;
} 
```

**mreview.h**

```
#ifndef MREVIEW_H
#define MREVIEW_H

#include <string>
using namespace std;

class Mreview
{
public:
  Mreview(string ttl = "N/A");
  Mreview(string ttl, int firstScore);

  string getTitle() const { return title; }
  int getTotalScore() const { return totalScore; }
  int getNumRatings() const { return numRatings; }

  void addScore(int score);
  double aveRating() const;

private:
  string title;
  int totalScore;
  int numRatings;
};

#endif 
```

我的问题是我无法弄清楚我必须做些什么来解决这个问题。我已经阅读了评论，但我仍然感到困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T04:19:20.140

您正在分配（并复制！）一个`Mreview`对象向量，**所有这些对象都是使用默认 ctor 构造的**，因此`numRatings`默认为 0，并且您没有做任何事情来确保`aveRating()`永远不会在未修改的对象上调用它或至少保护自身从`numRatings`0。

编辑：最简单的修复：

```
double Mreview::aveRating() const { 
    if (numRatings == 0)
        return 0.;
    else 
        return static_cast<double>(totalScore)/numRatings;
} 
```

IMO 的进一步解决方法是将`Mreview` *指针*（理想情况下为 shared_ptr）存储在向量中，并*在添加第一个分数*时而不是更早地添加`new`它们。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T04:09:33.003

我只看到一个实际的除法操作......

```
double Mreview::aveRating() const { 
   double rating = totalScore/numRatings; 
   return rating; 
} 
```

……那里有吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T04:11:25.823

在寻找除以零问题时，寻找 / 和 % 运算符。我在您的代码中只看到一个 / 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T04:16:00.837

不是除以零错误，而是...

```
double Mreview::aveRating() const
{
    double rating = totalScore/numRatings;
    return rating;
} 
```

您正在获取两个整数值并将其存储在一个 double 中而不进行类型转换......您必须将 totalScore 或 numRatings 转换为一个 double，例如：

```
double Mreview::aveRating() const
{
    double rating = (double)totalScore/numRatings;
    return rating;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T04:13:36.440

你能在调试器中运行它并让它告诉你陷阱发生在哪里吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T04:23:24.703

看起来如果修剪后线的长度为0，则`printMrList()`可以在不`review.addScore()`先调用的情况下调用。在这种情况下，尝试除以的`printMrList()`调用。这两个值都是 0，因此会发生除以零错误。`review.aveRating()``totalScore``numRatings`

# objective-c - 在目标 c 中声明全局变量的问题

> ID：593498
> 
> 赞同：0
> 
> 时间：2009-02-27T04:11:25.183
> 
> 标签：objective-c

我在类的 1 中有一个全局变量，比如 classA.h

```
const NSString *global; 
```

班A.m

```
global=[array objectAtIndex:0];//a array store sort of string 
```

在另一个类中我想调用这个全局变量

B类.m

```
import "class.h"

NSLog(@"%@",global); 
```

但它不起作用，我知道当我直接为我的全局变量而不是从另一个变量赋值时它会起作用，但有人可以告诉我如何让它从数组中实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T04:23:12.613

在标题中，使用：

```
extern const NSString *global; 
```

并在实施（.m）中：

```
const NSString *global; 
```

“extern”引用告诉所有包含文件该变量存在，但它在别处声明。最后，在您的实现文件中，放置实际的声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-28T11:24:51.490

你不能那样做。

```
const NSString *global;
NSString const *global; 
```

`NSString`两者都表示指向常量对象的指针（可以更改） 。在 Objective-C 中，常量对象没有意义。编译器不能强制对象的常量。它无法知道方法是否改变了对象的内部状态。此外，库中的所有类总是将指向非常量对象的指针作为其方法的参数，因此拥有任何 const 对象指针都会引起很多警告。

另一方面，有指向像这样声明的对象的常量指针：

```
NSString * const global; 
```

这意味着指针指向一个常规的 NSString 对象，但它的值不能改变。这意味着您还必须初始化指针的值（以后不能更改）。这用于定义常量。但这仅适用于`NSStrings`字符串文字。对于所有其他类，无法指定初始化所需的编译时常量对象。在这种情况下，它是一个真正的常量——字符串文字根据定义是不可变的。

但是在您的情况下，您可以取消`const`. 您想稍后更改指针，使其不能是`NSString * const`. 如果您坚持使用 global ，则只需将其设为常规`NSString *`. 另一方面 - 全局变量是邪恶的。你应该改变你的设计，这样你就不需要它了。

# javascript - javascript语法：函数调用和使用括号

> ID：593509
> 
> 赞同：7
> 
> 时间：2009-02-27T04:16:18.120
> 
> 标签：javascript, syntax

为什么这行得通..

```
<script type="text/javascript">
<!-- 

function myAlert(){
    alert('magic!!!');
}

if(document.addEventListener){   
    myForm.addEventListener('submit',myAlert,false); 
}else{   
    myForm.attachEvent('onsubmit',myAlert); 
}
// -->
</script> 
```

但不是这个？？？

```
<script type="text/javascript">
<!-- 

function myAlert(){
    alert('magic!!!');
}

if(document.addEventListener){   
    myForm.addEventListener('submit',myAlert(),false); 
}else{   
    myForm.attachEvent('onsubmit',myAlert()); 
}
// -->
</script> 
```

`myAlert`不同之处在于调用函数时使用括号。

我得到的错误..

> “htmlfile：类型不匹配。” 通过 VS2008 编译时。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-27T04:20:53.600

函数后面的**()**表示*执行*函数本身并返回它的值。没有它，您只需拥有该函数，该函数可用于作为回调传递。

```
var f1 = function() { return 1; }; // 'f1' holds the function itself, not the value '1'
var f2 = function() { return 1; }(); // 'f2' holds the value '1' because we're executing it with the parenthesis after the function definition

var a = f1(); // we are now executing the function 'f1' which return value will be assigned to 'a'
var b = f2(); // we are executing 'f2' which is the value 1\. We can only execute functions so this won't work 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T04:20:50.277

[addEventListener](https://developer.mozilla.org/En/DOM/Element.addEventListener)函数需要一个函数或一个对象作为第二个参数实现，而`EventListener`不是函数调用。

当`()`添加到函数名称时，它是函数调用而不是函数本身。

**编辑：**如其他回复和评论中所示，可以在 Javascript 中返回函数。

因此，对于一些有趣的事情，我们可以尝试以下方法。从原来的`myAlert`，我们可以根据参数稍微改变它以返回不同的消息：

```
function myAlert(msg)
{
    return function()
    {
        alert("Message: " + msg);
    }
} 
```

在这里，请注意该函数实际上返回了一个函数。因此，为了调用该函数，`()`将需要额外的。

我写了一点 HTML 和 Javascript 来使用上面的函数。（请原谅我不干净的 HTML 和 Javascript，因为它不是我的域）：

```
<script type="text/javascript">

function myAlert(msg)
{
    return function()
    {
        alert("Message: " + msg);
    }
}

</script>

<html>
<body>

<form>
<input type="button" value="Button1" onclick="myAlert('Clicked Button1')()">
<input type="button" value="Button2" onclick="myAlert('Clicked Button2')()">
</form>

</body>
</html> 
```

显示了两个按钮，每个按钮都将`myAlert`使用不同的参数调用该函数。一旦`myAlert`函数被调用，它本身将返回另一个`function`，因此必须使用一组额外的括号来调用它。

最终结果是，点击`Button1`会显示一个带有消息的消息框`Message: Clicked Button1`，而点击`Button2`会显示一个消息框，上面写着`Message: Clicked Button2`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T04:22:21.617

当您使用括号时，您实际上是在调用函数并将函数结果（在这种情况下未定义，因为 myAlert 没有返回值）作为参数发送。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T04:24:42.827

还值得注意的是，函数是一流的对象。你可以像任何其他物体一样把它们扔来扔去。这是一个很好的简洁示例，说明为什么这很酷，来自[Wikipedia](http://en.wikipedia.org/wiki/First-class_function#Javascript)：

```
function makeDerivative( f, deltaX ) {
    var deriv = function(x) { 
       return ( f(x + deltaX) - f(x) )/ deltaX;
    }

    return deriv;
}

var cos = makeDerivative( Math.sin, 0.000001); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T05:21:41.253

```
if(document.addEventListener){   
    myForm.addEventListener('submit',myAlert(),false); 
}else{   
    myForm.attachEvent('onsubmit',myAlert()); 
} 
```

using `myAlert()`here 是给出函数的返回值，而不是函数本身。

考虑一下：

```
function bob() {
    return "hello world";
}

alert(bob()); 
```

警报将使用函数返回的值`bob`。

如果您想在 addEventListener 中传递其他参数，请尝试以下操作：

```
if(document.addEventListener){   
    myForm.addEventListener('submit',function(event) {
        myAlert(event,myOtherParamater); 
    },false); 
}else{   
    myForm.attachEvent('onsubmit',function () {
        myAlert(window.event,myOtherParameter); 
    }); 
} 
```

javascript 使用一流的函数，因此可以作为参数传递给函数，这是 addEventListener 和 attachEvent 方法所期望的。希望有帮助。

# linux-kernel - Netfiler 钩子没有被调用

> ID：593510
> 
> 赞同：1
> 
> 时间：2009-02-27T04:16:40.273
> 
> 标签：linux-kernel, netfilter

我正在编写一个内核模块，它使用 netfilter 注册一个钩子。如果我 ssh/telnet 进入加载模块的机器，则不会调用处理程序。

```
struct nf_hook_ops my_hook_ops;
my_hook_ops.hook = hook_handler;
my_hook_ops.pf = PF_INET;
my_hook_ops.hooknum = NF_INET_PRE_ROUTING;
my_hook_ops.priority =  NF_IP_PRI_FIRST;
nf_register_hook(&my_hook_ops); 
```

处理函数：

```
unsigned int hook_handler(unsigned int hooknum,
                   struct sk_buff *skb,
                   const struct net_device *in,
                   const struct net_device *out,
                   int (*okfn)(struct sk_buff *))
{

    if(!skb)
        return NF_ACCEPT;

    struct iphdr* ip_header;
    struct tcphdr* tcp_header;
    union  ip_address ipaddr;

    printk(KERN_INFO "Entered handler\n");

    if(skb->protocol == 8)
        return NF_ACCEPT;

    // Log the received packet
    ip_header  = ip_hdr(skb);
    tcp_header = tcp_hdr(skb);
    ipaddr.saddr = ip_header->saddr;
    printk(KERN_INFO "Received packet:\nIP Address: %u.%u.%u.%u\nProtocol: %d\nSource port: %d\nDestination port: %d\n",
            ipaddr.a[0],ipaddr.a[1],ipaddr.a[2],ipaddr.a[3],
            skb->protocol,
            tcp_header->source,
            tcp_header->dest);

    return NF_ACCEPT;
} 
```

正在为协议 8（外部网关协议）调用钩子。第二个 printk 永远不会被打印。我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-06T12:20:44.767

这里使用的协议与 IANA 分配的 IP 协议号不同，其中 8 用于 EGP，EGP 已过时。

sk_buff 的协议字段在 中定义，其中 8 用于 ETH_P_IP。由于您的数据始终是 IP 流量，因此第一个条件检查始终为真。所以代码的第二部分永远不会被执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T04:59:53.710

几个想法：

*   钩子处理程序采用 (struct skbuff **)，而不是 (struct skbuff *)
*   从上面继续，`skb->protocol`不存在。您想要`(*skb)->protocol`或想要以下成语：

```
struct sk_buff *sock_buf =  *skb;
if(sock_buff->protocol) 
```

*   如果数据包是 EGP 数据包，您不应该期待第二个 printk 的输出，因为您在它之前返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T18:04:28.963

您需要研究如何`sk_buff`工作，由函数 `eth_type_trans' 初始化的协议字段，该函数采用 ETH_P_* 值。所有 ETH_P_* 值都在[if_ether](http://lxr.free-electrons.com/source/include/uapi/linux/if_ether.h#L45)中定义。以下是其中一些值。

```
#define ETH_P_LOOP      0x0060          /* Ethernet Loopback packet     */
#define ETH_P_PUP       0x0200          /* Xerox PUP packet             */
#define ETH_P_PUPAT     0x0201          /* Xerox PUP Addr Trans packet  */
#define ETH_P_IP        0x0800          /* Internet Protocol packet     */ 
```

您清楚地看到 0x08 是为`Internet Protocol packet`. 并且您的代码在 8 的情况下清楚地返回（这是`IP`数据包）

```
 if(skb->protocol == 8)
    return NF_ACCEPT; 
```

您的`ssh/telnet`明确 IP 数据包并被上述代码拒绝。[请使用if_ethr](http://lxr.free-electrons.com/source/include/uapi/linux/if_ether.h#L45)中定义的正确协议定义值

# return-value - 我可以从 LotusScript 函数返回列表吗？

> ID：593533
> 
> 赞同：5
> 
> 时间：2009-02-27T04:33:30.340
> 
> 标签：return-value, lotus-notes, lotusscript

我想从 LotusScript 中的函数返回一个列表。

例如。

```
Function myfunc() List As Variant
    Dim mylist List As Variant
    mylist("one") = 1
    mylist("two") = "2"
    myfunc = mylist
End Function

Dim mylist List As Variant
mylist = myfunc() 
```

这可能吗？

如果是这样，正确的语法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T05:16:21.160

似乎您无法从函数返回列表。

您可以轻松地将其包装在一个类中并返回该类。

例如。

```
Class WrappedList
    Public list List As Variant
End Class

Function myfunc() As WrappedList
    Dim mylist As New WrappedList
    mylist.list("one") = 1
    mylist.list("two") = "2"
    Set myfunc = mylist
End Function 
```

在这里找到了答案：[LotusScript 的列表错误再次来袭](http://dominounlimited.blogspot.com/2008/06/lotusscripts-list-bug-strikes-again.html?showComment=1212495540000#c8995286986513838505)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T04:50:11.970

这对我来说很好。我已将一个值设置为字符串，将另一个值设置为整数，这样您就可以看到变体的行为本身。

```
Sub Initialize
    Dim mylist List As Variant
    Call myfunc(mylist)
    Msgbox "un  = " + mylist("one")
    Msgbox "deux = " + cstr(mylist("two"))
End Sub

Sub myfunc(mylist List As Variant)
    mylist("one") = "1"
    mylist("two") = 2
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T07:23:55.643

您可以获得一个返回列表的函数，只需删除函数中的“列表”位，而不是

```
Function myfunc() List As Variant
   ...
End Function 
```

...做：

```
Function myfunc() As Variant 
```

然后你可以像你已经做的那样调用你的函数。

```
Dim mylist List As Variant
mylist = myfunc() 
```

列表很棒，我一直在使用它们，但我发现列表有一个限制......

如果如果有这样的功能：

```
Public Function returnMyList() as Variant

   Dim myList List as Variant
   Dim s_test as String
   Dim i as Integer
   Dim doc as NotesDocuemnt
   Dim anotherList List as String

   '// ...set your variables however you like

   myList( "Some Text" ) = s_text
   myList( "Some Integer" ) = i
   myList( "Some Doc" ) = doc

   '// If you returned the list here, you're fine, but if you add
   '// another list...
   anotherList( "one" ) = ""
   anotherList( "two" ) = ""
   myList( "Another List" ) = anotherList

   '//  This will cause an error
   returnMyList = myList

   '// I bodge around this by writting directly to a List 
   '// that is set as global variable.

End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-30T11:38:28.630

简单地说，你必须有一个返回变体的函数。我可以看到您喜欢以面向对象的方式进行操作，但是如果您只想通过程序“完成”是最简单的。

虽然有几种方法可以做到这一点，但这是我的首选方式。请注意，您可以创建任何原始数据类型的列表（即字符串、变体、整数、长整数等）。

```
Function myfunc as variant
    dim mylist list as variant
    mylist("somename") = "the value you want to store"
    mylist("someothername") = "another value"
    myfunc = mylist

End Function 
```

使用 myfunc ..

```
sub initialise
    dim anotherlist list as variant
    anotherlist = myfunc
end sub 
```

如果需要，您可以通过简单地以这种方式定义 myfunc 来向 myfunc 添加参数

```
function myfunc(val1 as variant, val2 as variant) as variant 
```

你用像这样的参数以同样的方式调用它

```
anotherlist = myfunc("a value", "another value") 
```

请注意，“变体”是您的通用数据类型。重要的是 myfunc 作为变体是您可以从函数返回列表和变体的唯一方法。

# c# - 将数据网格导出到 xml

> ID：593537
> 
> 赞同：2
> 
> 时间：2009-02-27T04:38:04.010
> 
> 标签：c#

请帮我将 DataGrid 导出为 XML。我尝试了两种方法，但都导致抛出异常。

```
DataTable dt = (DataTable)dataGrid2.DataSource;
dt.WriteXml("t.xml", XmlWriteMode.IgnoreSchema); 
```

这会引发 InvalidOperationException，并显示消息“无法序列化 DataTable。未设置 DataTable 名称。”

请推荐一种将数据网格导出为 XML 的合适方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T04:40:43.490

鉴于该错误；只需设置 DataTable 的名称？

```
dt.TableName = "Fred";
... 
```

就个人而言，我会使用对象序列化（也许`XmlSerializer`over `List<T>`），但`DataTable`应该没问题......

* * *

更新; 例如使用`DataTable.WriteXml`/ `ReadXml`; 注意“这条线使它一切正常”评论；这是必要的：a：能够写入，b：正确读取行。

```
using System;
using System.Data;
static class Program
{
    static void Main()
    {
        DataTable table = CreateEmptyTable();
        table.Rows.Add(1, "abc");
        table.Rows.Add(2, "def");
        WriteTable(table);
        table.WriteXml("t.xml", XmlWriteMode.IgnoreSchema);

        DataTable clone = CreateEmptyTable();        
        clone.ReadXml("t.xml");
        WriteTable(clone);
    }
    static DataTable CreateEmptyTable()
    {
        DataTable table = new DataTable();
        table.Columns.Add("Foo", typeof(int));
        table.Columns.Add("Bar", typeof(string));
        table.TableName = "MyTable"; // THIS LINE MAKES IT ALL WORK
        return table;
    }
    static void WriteTable(DataTable table) {
        foreach (DataColumn col in table.Columns)
        {
            Console.Write(col.ColumnName);
            Console.Write('\t');
        }
        Console.WriteLine();
        foreach (DataRow row in table.Rows)
        {
            foreach (DataColumn col in table.Columns)
            {
                Console.Write(row[col]);
                Console.Write('\t');
            }
            Console.WriteLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-19T21:31:54.773

此答案特定于 C# 中的 winforms，但应普遍适用于 ASP.NET 编程。下面，_dtResults 是一个全局 DataTable。早些时候，当您将数据网格 (dg) 源绑定到 DataTable 时，只需将副本复制到全局变量 _dtResults 中。然后调用`ExportXMLFromDG()`。

```
 // user clicks on button, which binds the dg to the datatable,
    // prompts the user to save the XML, serializes it and saves the file.
    private void toolStripButton4_Click(object sender, EventArgs e)
    {
        dg.DataSource = dtResults; // this actually happens earlier.
        _dtResults = dtResults; // this actually happens earlier.

        if (dg.Columns.Count > 0)
        {
            SaveFileDialog saveFileDialog1 = new SaveFileDialog();

            saveFileDialog1.Filter = "xml files (*.xml)|*.xml|All files (*.*)|*.*";
            saveFileDialog1.FilterIndex = 1;
            saveFileDialog1.RestoreDirectory = true;

            if (saveFileDialog1.ShowDialog() == DialogResult.OK)
            {
                ExportXMLFromDG(saveFileDialog1.FileName);
            }
        }
    }

    private void ExportXMLFromDG(string xml_file)
    {
        XmlSerializer serializer = new XmlSerializer(typeof(DataTable));
        TextWriter textWriter = new StreamWriter(xml_file);
        serializer.Serialize(textWriter, _dtResults);
        textWriter.Close();

    } 
```

# php - PHP/MySQL 简单连接不起作用

> ID：593549
> 
> 赞同：1
> 
> 时间：2009-02-27T04:44:50.110
> 
> 标签：php, mysql, hosting

我正在使用 MySQL 的 Zymic（免费主机）上托管一个网站。我开了一个帐户，并编写了 SIMPLEST 函数来连接数据库。它看起来像这样：

```
<?php
    $conn = mysql_connect("uuuq.com","paulasplace_sudo","mypassword");
    if(!$con)
    {
        die("Could not connect: " . mysql_error());
    }
    else
    {
        echo("mysql connected successfully!");
    }
?> 
```

但它抛出了这个错误：

警告：mysql_connect() [function.mysql-connect]：在“读取初始通信数据包”时丢失与 MySQL 服务器的连接，系统错误：/www/uuuq.com/p/a/u/paulasplace/htdocs/index 中的 111。第 9 行的 php 无法连接：在“读取初始通信数据包”时丢失与 MySQL 服务器的连接，系统错误：111

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T04:53:35.503

这可能只是从您将代码复制到帖子中时开始的，但是您将 mysql_connect() 的结果存储到 $conn 中，但是 if 语句检查了不同的变量 $con...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:45:37.380

对于像我这样在虚拟机上遇到同样问题的人，或者您拥有创建用户的所有权利（在 phpmyadmin 中读取的权限），对我来说问题是我的数据库用户创建不正确。在创建我的数据库用户时，我错误地设置了名称后面的参数之一，有一个选择器，您可以在其中选择服务器：选择为默认值是我的错误，上面写着“任何服务器”并设置为 % ，我不得不更改它，事实上，我必须创建一个具有相同名称和不同服务器的新用户，我将其设置为 localhost。我的问题得到了解决，我删除了我的其他用户，重新启动了服务器，它工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T04:51:52.123

我怀疑主机名是“localhost”而不是 uuuq.com。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T04:56:48.117

通常，这些免费主机的 MySQL 服务器完全位于不同的地址，而不是简单的 localhost 或站点地址本身。

如果主机提供对 phpMyAdmin 的访问，打开它然后查看页面顶部，您应该会看到类似以下内容的内容

服务器：s1.mysqlserver.com

那就是你想要的地址。

# cocoa - Cocoa - 带有动画 NSOpenGLView 的模态窗口

> ID：593550
> 
> 赞同：0
> 
> 时间：2009-02-27T04:45:46.177
> 
> 标签：cocoa, opengl, animation, modal-dialog

我有一个包含 NSOpenGLView 子类 (GameView) 的 NSWindow 子类 (GameWindow)。

该应用程序是窗口化的（不会全屏显示）。

GameView 中的 OpenGL 动画由计时器每秒触发约 30 次。

出于演示的原因，无论应用程序中发生什么其他情况，GameView 动画都必须继续。它应该停止的唯一时间是在发生致命错误的情况下。

当 GameWindow 中的动画继续播放时，我需要呈现各种“模态”Cocoa 窗口（例如选择新游戏、确认退出等）。其中一些可能是工作表，但主要的需要显示为独立窗口（带有 WebViews）。

我的问题：如何显示这些“对话框”窗口，以便我的应用程序计时器继续触发，我的动画继续，但用户在 GameWindow 中对 GameView 的输入被阻止，直到用户关闭“对话框”窗口？

（这个时候需要支持虎+豹）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T04:50:35.307

您是否尝试过常规的工作表/对话技巧？他们应该在这种情况下工作得很好。定时器被安排为运行循环的一部分，当你有一个模态表或窗口时它不会停止，因此它应该能够在事件被阻止时继续在后台渲染。

```
[NSApp beginSheet:sheetWindow modalForWindow:mainWindow modalDelegate:nil didEndSelector:NULL contextInfo:nil]; 
```

（如果需要，请填写您自己的委托和结束选择器。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T03:01:54.107

如果您想保留当前的模态窗口（不移动到工作表），您可以尝试在默认运行循环模式 (NSDefaultRunLoopMode) 之外的其他方式中自行安排 NSTimer，一旦运行循环停止运行，该模式就会挂起。

# c# - C#：与空值比较

> ID：593560
> 
> 赞同：16
> 
> 时间：2009-02-27T04:51:39.453
> 
> 标签：c#, null

这些是否等效：

```
if (null==myobject)
{
//do something 
} 
```

和

```
if (myobject==null)
{
//do something 
} 
```

还是他们会产生不同的代码？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-27T05:02:23.830

在 99% 的情况下，此代码是等效的。

一个例外是当相关对象的类型覆盖 == 运算符时。== 中可能会引入一个错误，当一个参数为空时会导致问题。

我以前见过的一个特定示例如下

```
public static bool operator==(Student left, Student right) {
  return left.Equals(right);
} 
```

当 null 在左侧时，这将失败，但在右侧为 null 时可能不会。

不过，这是一个非常遥远的角落案例。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-27T05:22:19.990

`if`将常量放在左侧的“”语句的形式是 C/C++ 的保留，您可以在 if 语句中使用任意表达式。

C# 的 if 语句语法要求表达式计算为 bool，这意味着`if (foo = 0)`不会编译。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-08-20T10:02:47.893

这

```
if (null==myobject) { 
```

是编写 if 语句的安全方法。它来自 C/C++，其中条件是评估为`int`. 如果结果为零，则意味着`false`其他任何内容都是`true`。你可以写类似

```
if (variable == 1) { 
```

但如果你不小心你也可以写

```
if (variable = 1) { 
```

在这种情况下，您的赋值始终为 1，因此始终为真。

你可以编译它并运行它没有问题，但结果不会是你所期望的。所以 C/C++ 程序员开始写类似的东西

```
if (1 == variable) { 
```

如果你拼错了它就不会编译，所以你总是必须按照你的意思写它。这后来成为一个（好的）习惯，你可以在你编程的所有语言中使用它，例如 C#。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-26T04:18:37.940

对于那些错过它的人，如果您希望减少混乱，也可以为您的类启用`C-language`-style 空值检查：`C#`

```
class MyObj
{
    public void implicit_null_comparison_demo()
    {
        MyObj mo = null;
        // ...

        if (mo)         //  <-- like so (can also use !mo)
        {
            // it's not null...
        }
        else
        {
            // it's null...
        }
    }

    public static implicit operator bool(MyObj mo)
    {
        return (Object)mo != null;
    }
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T19:47:24.040

正如其他人指出的那样，它们大多是等价的。

您还应该看看： [http ://en.wikipedia.org/wiki/Null_Object_pattern](http://en.wikipedia.org/wiki/Null_Object_pattern)

它是简单检查空引用的非常有用的替代方法。

# c# - CastException 试图调用 Action > 异步委托

> ID：593573
> 
> 赞同：1
> 
> 时间：2009-02-27T05:01:55.937
> 
> 标签：c#, begininvoke

我似乎无法弄清楚为什么我会收到运行以下代码的 InvalidCastException：

```
var item = new KeyValuePair<string, string>("key", "value");

Action<KeyValuePair<string, string>> kvrAction = 
    kvr =>Console.WriteLine(kvr.Value);

var result = kvrAction.BeginInvoke(item, null, null);
kvrAction.EndInvoke(result); 
```

异常信息：

```
Test method Utilities.Tests.IEnumerableExtensionTests.ProveDelegateAsyncInvokeFailsForKeyValuePair threw exception:  System.Runtime.Remoting.RemotingException: The argument type '[key, value]' cannot be converted into parameter type 'System.Collections.Generic.KeyValuePair`2[System.String,System.String]'.
--->  System.InvalidCastException: Object must implement IConvertible.. 
```

任何帮助将不胜感激 =) 这段代码似乎适用于我扔给它的任何东西，除了 KeyValuePair<>。

更新：似乎任何结构都存在这种情况。我没有注意到 KeyValuePair<> 是一个结构，因此仅使用类进行测试。我仍然不明白为什么会这样。

更新 2：西蒙的回答帮助确认了这种行为是意外的，但是实现自定义类型不适用于我想要做的事情。我正在尝试在 IEnumerable<> 上实现一个扩展方法，以便为每个项目异步执行委托。我注意到针对通用 Dictionary 对象运行测试时出错。

```
 public static IEnumerable<T> ForEachAsync<T>(this IEnumerable<T> input, Action<T> act)
    {
        foreach (var item in input)
        {
            act.BeginInvoke(item, new AsyncCallback(EndAsyncCall<T>), null);
        }

        return input;
    }

    private static void EndAsyncCall<T>(IAsyncResult result)
    {
        AsyncResult r = (AsyncResult)result;
        if (!r.EndInvokeCalled)
        {
            var d = (Action<T>)((r).AsyncDelegate);
            d.EndInvoke(result);
        }
    } 
```

我宁愿不使用对 T 的约束来限制该方法以确保仅使用类，因此我已按如下方式重构该方法以解决 BeginInvoke 的问题，但我之前没有直接使用 TreadPool 并希望确保我我没有错过任何重要的东西。

```
 public static IEnumerable<T> ForEachAsync<T>(this IEnumerable<T> input, Action<T> act)
    {
        foreach (var item in input)
            ThreadPool.QueueUserWorkItem(obj => act((T)obj), item);

        return input;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T06:27:29.740

奇怪，似乎是.NET（C#？）中的某种错误，将参数编组到工作线程。

如果在传递的结构上实现 IConvertable：

```
struct MyPair<TKey, TValue> : IConvertable
{
    public readonly TKey Key;
    public readonly TValue Value;

    public MyPair(TKey key, TValue value)
    {
        Key = key;
        Value = value;
    }

    // I just used the smart-tag on IConvertable to get all these...
    // public X ToX(IFormatProvider provider) { throw new InvalidCastException(); }

    ...

    public object ToType(Type conversionType, IFormatProvider provider)
    {
        if (typeof(MyPair<TKey, TValue>).GUID == conversionType.GUID)
            return this;
        throw new InvalidCastException();
    }
} 
```

它运行良好。传递的conversionType 没有通过.Equal()、IsAssignableFrom() 或除GUID 比较之外的任何其他我尝试过的方法，这可能与它首先要求IConvertable 的原因有关。

编辑：一个简单的解决方法是使用闭包来传递参数：

```
var data = new Dictionary<string, string> {
    { "Hello", "World" },
    { "How are", "You?" },
    { "Goodbye", "World!" }
};
foreach (var pair in data)
{
    var copy = pair; // define a different variable for each worker
    Action worker = () => Console.WriteLine("Item {0}, {1}", copy.Key, copy.Value);
    worker.BeginInvoke(null, null);
} 
```

当然，如果您需要结果，则需要将 IAsyncResults 存储在另一个方向上，这可能与参数有相同的问题。作为替代方案，您可以在它们完成后将它们添加到集合中，但是锁定有点奇怪：

```
var data = new Dictionary<string, string> {
    { "Hello", "World" },
    { "How are", "You?" },
    { "Goodbye", "World!" }
};

var results = new List<KeyValuePair<string, string>>();
var pending = 0;
var done = new ManualResetEvent(false);

var workers = new List<Action>();
foreach (var pair in data)
{
    ++pending;
    var copy = pair; // define a different variable for each worker
    workers.Add(delegate()
    {
        Console.WriteLine("Item {0}, {1}", copy.Key, copy.Value);
        lock (results)
            results.Add(new KeyValuePair<string, string>("New " + copy.Key, "New " + copy.Value));
        if (0 == Interlocked.Decrement(ref pending))
            done.Set();
    });
}

foreach (var worker in workers)
    worker.BeginInvoke(null, null);

done.WaitOne();

foreach (var pair in results)
    Console.WriteLine("Result {0}, {1}", pair.Key, pair.Value); 
```

# windows - 哪种屏幕尺寸更适合最终用户

> ID：593579
> 
> 赞同：1
> 
> 时间：2009-02-27T05:07:09.167
> 
> 标签：windows, resize, screen

我有一个软件，最小屏幕尺寸要求是 1024x768，800x600 可能太小，1024x768 会太大？也许介于两者之间？什么屏幕尺寸更好或最好？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T05:11:28.410

你是在问你应该为什么尺寸设计你的应用程序？如果是这样，最好的“尺寸”将是一个流畅的布局，允许用户设置适合他们和他们的显示器的任何尺寸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T05:12:06.643

如今，1024x768 是标准和首选的屏幕尺寸。大多数基于 Web 的应用程序、网站按照 1024x768 标准设计其站点。但是，如果您是桌面设备，您可以选择较小的初始尺寸。但是，当您将应用程序最大化到更高分辨率时，您必须确保 UI 不会变坏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T05:12:30.280

您可以将**最小**尺寸设置为您想要的任何尺寸，只要您的软件在大于该尺寸的所有尺寸上看起来都不错。

如果很多人仍然运行 800x600 但他们可能会运行，我会感到惊讶，并且您将通过不处理它来限制您的市场。就个人而言，我认为这不会有太大的限制。

此外，800x600 和 1024x768 之间并没有太多区别，它们是紧挨着的两个“标准”分辨率。因此，如果您认为 1024x768 太大（事实并非如此），那么 800x600 是下一个选项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T05:31:21.950

只有对话框应该是固定大小的，而不是所有的。所有其他 UI 窗口应使用基于流的布局，以适应可用窗口。在 WinForms 中对动态布局的管理有广泛的支持，在 XAML 中的支持甚至更好。

您可能已经看过为固定宽度设计的网站，但恕我直言，这是无能或懒惰的标志。或者可能是形式对功能的胜利。

这些都不是一个好的借口。在我的 3840x1200 显示器（两个连接的 1920x1200 显示器）上，它们看起来都很荒谬，革命来了，固定布局 UI 的设计师将是第一个面对墙屏的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T05:11:40.077

查看 w3schools 的[浏览器显示统计信息](http://www.w3schools.com/browsers/browsers_display.asp)，这可能是一个好的开始。但请注意，正如他们所说：

> W3Schools 是一个面向对网络技术感兴趣的人的网站。这一事实表明，下面的数字可能不是 100% 现实的。普通用户可能拥有分辨率较低的显示屏。

这完全取决于您确定用户细分的能力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T06:28:23.060

我很惊讶没有人提到上网本。如果您的应用程序可以在上网本上运行，您可能需要考虑低于 1024x768 的分辨率。例如，7" Asus EeePC 的分辨率为 800x480，而 9" 到 10" 型号的分辨率通常为 1024x600。

编辑：同意无论如何都应该使用流动的布局，但我说的是应该工作的最小尺寸。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T06:35:45.117

对于 Windows 应用程序，将其设计为 800x600。这样，拥有 1024x768 屏幕的用户无需最大化窗口即可查看所有内容（少数拥有 800x600 屏幕的用户仍然可以查看）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T05:13:40.337

[我假设您指的是桌面应用程序]

虽然 1024x768 是一个合理的屏幕分辨率，所有最近的显示器（我猜是最近 4 年购买的）都支持，但我大多数软件仍然使用 800x600。

是什么让您的软件需要这种分辨率？我希望你没有那么大的对话。如果有一些，请考虑将它们拆分为选项卡表或向导。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T06:12:55.623

这些天您是否找不到 1024x768 或更低的显示器也没关系。即使每个人都有 1920x1200，为什么您的应用程序应该是屏幕上唯一的应用程序？窗口 GUI 的想法是同时使用*多个*窗口。

我，首先，永远不要使用“最大化”按钮。即使是真正身临其境的应用程序（想想 CAD）也应该为其他工具留出一些空间。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T06:33:23.890

如今，~960px 宽是一个相当普遍的标准。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T06:46:11.240

您需要做的最终事情是找出您的**目标受众**正在运行或可能运行的内容。也就是说，您的应用程序应该能够处理几乎任何合理的屏幕分辨率。它不必在过低的分辨率下看起来*很漂亮*，但它必须在过低的分辨率下才能*正常工作。*我知道一些缺少低分辨率功能部分的应用程序，它们相当烦人。

如果您的应用程序比平常更重要，您将需要更加确定它可以在分辨率受限的环境中工作。对于 Windows 和 Linux 系统，默认的故障安全分辨率（取决于系统）是 640x480 或 800x600。如果您希望您的应用程序被认为是关键的，那么它应该能够在这样的限制条件下工作。

# design-patterns - n层架构是否打破了封装的OO概念

> ID：593590
> 
> 赞同：2
> 
> 时间：2009-02-27T05:15:33.080
> 
> 标签：design-patterns, oop, architecture, n-tier-architecture

我有一个带有表示层、业务层、DAL 和业务对象层的 n 层应用程序。分离对象和写在对象上的操作打破了面向对象的封装概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T08:35:02.320

不。考虑一下“封装”的含义：类的实现细节隐藏在类的接口（消息或方法）后面。

事实上，您可以直接从 OO 原则和帕纳斯定律推导出 n 层架构：模块应该封装可能发生变化的内容。表示层封装了创建“可见”界面的细节；中间层是业务本身的模型；以及后端访问持久数据存储的详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T11:18:10.790

举个例子，取自[这篇文章](http://www.javaworld.com/javaworld/jw-05-2001/jw-0518-encapsulation.html)：

```
public class Position
{
  public double distance( Position position )
  {
    // calculate and return distance...
  }

  public double heading( Position position )
  {
    // calculate and return heading...
  }

  public double latitude;
  public double longitude;
} 
```

根据同一篇文章，这是一个很好的封装示例，因为数据和对该数据执行的操作是捆绑在一起的。请注意，此处的封装不保证数据隐藏或保护。

相反，Steve McConnell 在 Code Complete（第 2 版，第 6.2 节，良好封装）中认为封装被破坏，因为成员数据被暴露。

在您的情况下，如果您的数据对象和操作它们的对象是分开的但没有公共字段，则根据第一个定义，封装被破坏，但不一定在第二种情况下。所以我们有两种截然不同的观点。一个人说数据隐藏不是封装的一部分，另一个消息来源说数据隐藏是封装的重要组成部分。

数据隐藏可以看作是信息隐藏的一部分，这是规定您应该隐藏复杂的设计决策和变更来源的原则。普遍的共识似乎是，封装被视为信息隐藏的一种表现形式，包括数据隐藏。

或者，正如[维基百科](http://en.wikipedia.org/wiki/Information_hiding)所说：

> 封装一词通常与信息隐藏互换使用。不过，并非所有人都同意两者之间的区别。可以将信息隐藏视为原理，将封装视为技术。软件模块通过将信息封装到提供接口的模块或其他结构中来隐藏信息。

但是...本段后面的参考文献与我从第一个示例中提取的文章相同，所以即使是维基百科也在这里混淆了东西。此外，这里使用“区别”一词似乎是错误的。

最后不得不说这个有点蹩脚，但是封装和信息隐藏的术语已经超载，所以这一切都取决于来源。在您的情况下，我会坚持将封装定义为“将实现细节隐藏在抽象后面”。因此，您不一定要破坏封装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T06:02:51.547

这是一个非常棒的点AP！

在某些情况下，我同意将单个操作分解为多个对象确实会对封装产生不利影响。事实上，我认为这是我在许多 Web 架构中看到的一个大问题。

另一方面，某些东西对分解很有用，例如向数据库发送查询的对象等。

我认为在许多情况下，有一个论据可以更好地“封装”网页，以便更多的功能包含在单个对象或更少的对象中。因此，一种更“以页面为中心”的方法，而不是将逻辑分散到大量类中。

我认为这是我们在设计每个系统时总是要问自己的一个重要问题——要抽象多少？具体要多少？如何*有效地*将系统分解为类。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-27T05:19:44.863

两者不一样。架构更多地是指模块（类组）。封装是指隐藏类的内部工作。如果您的系统设计得足够好，您可以同时拥有两者。

您可能需要注意的是明确定义责任分离。只要你清楚每个模块/层的用途，并具体了解每个类的作用（以及类的每个方法的作用），那么你应该能够有一个好的设计。

我在这里只是推测，但在设计模块接口时，您可能对[外观设计模式感兴趣。](http://en.wikipedia.org/wiki/Facade_pattern)

关于您下面的评论，逻辑绝对应该在员工类本身中。我会质疑为业务对象设置单独层的逻辑。定义像“Employee”这样的类通常是一种诱惑，因为它们对现实世界的对象或概念进行建模。但是，您定义类的动机不应该是“为真实世界对象建模”。

你应该定义你的模块的目的（为什么你有一个业务逻辑层？包含所有的业务逻辑。）然后把你需要的东西放在那里。如果“Employee”类是需要计算业务逻辑的类，那么它应该进入业务逻辑类。如果不是，那么它应该放在您的业务对象类中（无论是什么）。如果它需要做两件不同的事情，因此可以放在两层中，那么考虑将它分成两个类 - 请记住，您的对象不需要对现实世界的事物进行建模。Robert C Martin 建议定义你的类，这样类的边界就是目的的边界。

# javascript - 使用带有 ajax 的 reCAPTCHA ....javascript 加载问题

> ID：593593
> 
> 赞同：11
> 
> 时间：2009-02-27T05:17:27.130
> 
> 标签：javascript, ajax, prototypejs, recaptcha

我试图在我的一种形式中实现 reCAPTCHA，但我使用 ajax 作为提交。（更具体地说，原型 ajax.updater）

一旦我提交并错误检查我的表单，我会尝试加载 reCAPCHTA 小部件（在我更新的 div 元素中），它基本上只是调用一个 javascript 文件，如下所示：

```
<script type="text/javascript" src="http://api.recaptcha.net/challenge?k=6Le6SwUAAAAAAIWm8wCRFd8SrI-H0R1Yx4Tkw2Ks"></script> 
```

但是没有读取 JS 文件？...我已经在 ajax.updater 中尝试了 evalScripts:true 和 evalJS:'force' 等的所有组合.....但是我认为我没有很好理解为什么 js 文件没有处理:(

如果有人能对这个问题有所了解，我将不胜感激。

谢谢，安德鲁

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-11-05T14:00:19.510

This doesn't address your exact problem, but '[Dark Side of the Carton](http://www.darksideofthecarton.com/2008/12/15/validating-recaptcha-with-jquery-and-ajax/comment-page-1/)' has some excellent code for validating reCAPTCHA via jQuery AJAX which might help.

In summary:

Add the following Javascript:

```
$(function() {
    function validateCaptcha() {
        var challengeField = $('input#recaptcha_challenge_field').val(),
            responseField  = $('input#recaptcha_response_field').val();

        // alert(challengeField);
        // alert(responseField);
        // return false;

        var html = $.ajax({
            type: 'POST',
            url: 'ajax.recaptcha.php',
            data: "recaptcha_challenge_field=" + challengeField + "&amp;recaptcha_response_field=" + responseField,
            async: false
        }).responseText;

        if (html.replace(/^\s+|\s+$/, '') == "success") {
            $('#captchaStatus').html(' ');
            // Uncomment the following line in your application
            return true;
        } else {
            $('#captchaStatus').html(
                'Your captcha is incorrect. Please try again'
            );
            Recaptcha.reload();
            return false;
        }
    }

    // Modified as per comments in site to handle event unobtrusively
    $('#signup').submit(function() {
        return validateCaptcha();
    });
}); 
```

Then add the ajax.recaptcha.php file which: "outputs only the word “success” if the captcha matches and a message and the response from reCaptchta if it fails. This is important because we are looking for the word success in our validateCaptcha() function."

```
require_once('/inc/recaptchalib.php');
$publickey  = 'XXXXXXXXXXXXXXXXXXXXXXXXXXXX'; // you got this from the signup page
$privatekey = 'XXXXXXXXXXXXXXXXXXXXXXXXXXXX';

$resp = recaptcha_check_answer(
    $privatekey,
    $_SERVER['REMOTE_ADDR'],
    $_POST['recaptcha_challenge_field'],
    $_POST['recaptcha_response_field']
);

if ($resp->is_valid) {
    ?>success< ?
} else {
    die(
        "The reCAPTCHA wasn't entered correctly. Go back and try it again." .
        "(reCAPTCHA said: " . $resp->error . ")"
    );
} 
```

The example is in PHP, but I adapted it easily to work with Zope/Python

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-10T06:04:51.940

小心使用任何类型的客户端脚本，例如 JavaScript，进行验证。您无法控制最终用户的浏览器。验证码的目的是防止自动提交表单。任何足够复杂的人都可以设置它，在覆盖您的 JavaScript 验证和 CAPTCHA 检查时不会有问题。例如，他们可以将 validateCaptcha() 设置为始终返回 true，从而绕过您的仔细检查 - 或者只是禁用 JavaScript。

话虽如此，使用 ajax 执行整个表单提交并使用 CAPTCHA 检查的结果来确定表单是否得到处理并没有错。

重要的一点是，是否处理表单的决定必须在服务器端做出，而不是在客户端。

[为什么客户端验证还不够](https://stackoverflow.com/questions/3483514/why-is-client-side-validation-not-enough)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T18:09:39.037

回答我自己的问题...

有一个 reCAPTCHA AJAX api....这是解决这个问题的简单方法：

[链接文本](http://recaptcha.net/apidocs/captcha/client.html)

此外，.. [http://www.prototypejs.org/api/ajax/updater](http://www.prototypejs.org/api/ajax/updater)网站上的文档......讨论了 evalscript 选项以及如何仅通过本机 eval() 函数放置任何 javascript.. ..哪种让我对尝试使用 WMD 实施错误检查感到困惑...但那是另一回事了。

安德鲁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T19:06:50.003

调用 Recaptcha.reload(); 在你的 Ajax 代码中的回调事件上，它会在每次提交 Ajax 时重新加载新的 Recapcha

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T05:20:50.617

如果那是您正在使用的文字代码片段，那么您还没有关闭标签......所以它不会被评估。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-28T07:11:23.273

嗨朋友我找到了答案

[https://developers.google.com/recaptcha/docs/display?hl=es#AJAX](https://developers.google.com/recaptcha/docs/display?hl=es#AJAX)

在这如何验证

[http://blog.reaccionestudio.com/comprobar-recaptcha-con-ajax-usando-jquery/](http://blog.reaccionestudio.com/comprobar-recaptcha-con-ajax-usando-jquery/)

为你成功

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-28T15:56:17.100

使用 reCaptcha 保护 AJAX 调用

```
function performAJAX() {
    let captcha = $('[name=g-recaptcha-response]');
    $.ajax({
         url: 'ajaxHandler.html',
         data: {
            captcha: (captcha.length?captcha[0].value:''),
            // other data fields
         },
    });
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-01-31T17:30:18.263

`reCaptcha`当使用 jQuery 的`.load()`方法加载到页面中时，我遇到了类似的问题。这是一个具有新颖解决方案的页面：http: [//www.maweki.de/wp/2011/08/recaptcha-inside-a-with-jquery-ajax-or-load-dynamically-loaded-object/](http://www.maweki.de/wp/2011/08/recaptcha-inside-a-with-jquery-ajax-or-load-dynamically-loaded-object/)

基本上 reCaptcha API 使用 document.write 方法来显示 reCaptcha。当您使用 jQuery 时，这将不起作用。使用此 PHP 代码代替加载`recaptcha.js`

```
<?php
$api = file_get_contents('http://www.google.com/recaptcha/api/js/recaptcha_ajax.js');
$api = str_replace('document.write','$("body").append',$api);
echo $api;
?> 
```

它只是查找 document.write 并将其替换为`$(selector).append`.

使我的实施工作。

# javascript - 使用 jQuery 的键盘快捷键

> ID：593602
> 
> 赞同：190
> 
> 时间：2009-02-27T05:22:10.053
> 
> 标签：javascript, jquery, keyboard-shortcuts

如果有人按下字母，我如何连接一个事件来触发`g`？

（顺便说一句，所有字母的字符映射在哪里？）

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2010-06-22T16:45:35.483

自从最初提出这个问题以来，John Resig（jQuery 的主要作者）已经分叉并改进了 js-hotkeys 项目。他的版本可在：

[http://github.com/jeresig/jquery.hotkeys](http://github.com/jeresig/jquery.hotkeys)

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-02-27T16:35:46.813

[jQuery 热键](https://github.com/jeresig/jquery.hotkeys)呢？

> jQuery Hotkeys 让您可以在代码中的任何位置监视键盘事件，支持几乎任何组合键。

`Ctrl`要将+绑定`c`到函数 ( `f`)，例如：

```
$(document).bind('keydown', 'ctrl+c', f); 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2012-07-11T15:54:30.310

我最近为此编写了一个独立的库。它不需要 jQuery，但你可以将它与 jQuery 一起使用没有问题。它叫捕鼠器。

您可以在[http://craig.is/killing/mice查看](http://craig.is/killing/mice)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-02-27T06:36:00.280

那么有很多方法。但我猜你对高级实现感兴趣。几天前我也在同样的搜索中，我找到了一个。

[这里。](http://www.openjs.com/scripts/events/keyboard_shortcuts/)

它非常适合从键盘捕获事件，您也会找到字符映射。好消息是……它是 jQuery。检查同一页面上的演示并决定。

另一个库在[这里](http://www.west-wind.com/WestwindWebToolkit/samples/Ajax/html5andCss3/keycodechecker.aspx)。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2011-10-04T08:34:17.240

如果您只想要简单的快捷方式（例如 1 个字母，例如 just `g`），您无需额外插件即可轻松完成：

```
$(document).keypress(function(e) {
  if(e.charCode == 103) {
    // Your Code
  }
}); 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-02-27T15:59:39.163

```
 <script type="text/javascript">
        $(document).ready(function(){
            $("#test").keypress(function(e){
                if (e.which == 103) 
                {
                    alert('g'); 
                };
            });
        });
    </script>

    <input type="text" id="test" /> 
```

[这个网站说 71 = g 但上面的 jQuery 代码不这么认为](http://www.webonweboff.com/tips/js/event_key_codes.aspx)

*大写 G = 71*，小写为 103

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-07-21T15:56:25.860

你也可以试试[shortKeys](https://github.com/riklomas/shortkeys) jQuery 插件。使用示例：

```
$(document).shortkeys({
  'g': function () { alert('g'); }
}); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-08-23T08:37:15.917

在 Codeacademy 学习了一些 jQuery 之后，我找到了将键与 animate 属性绑定的解决方案。整个想法是在不滚动的情况下制作动画以从一个部分跳到另一个部分。Codeacademy 的示例是通过 DOM 移动马里奥，但我将其应用于我的网站部分（具有 100% 高度的 CSS）。这是代码的一部分：

```
$(document).keydown(function(key) {
    switch(parseInt(key.which, 10)) {
        case 39:
            $('section').animate({top: "-=100%"}, 2000);
            break;
        case 37:
            $('section').animate({top: "+=100%"}, 2000);
            break;
        default:
            break;
    }
}); 
```

我认为您可以将其用于任何信件和财产。

来源： http: [//www.codecademy.com/forum_questions/50e85b2714bd580ab300527e](http://www.codecademy.com/forum_questions/50e85b2714bd580ab300527e)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-29T19:05:58.930

与@craig 类似，我最近构建了一个快捷方式库。

[https://github.com/blainekasten/shortcut.js](https://github.com/blainekasten/shortcut.js)

支持绑定到一个快捷方式的多个函数的可链接 API。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-07T16:04:24.133

有一个新版本的 hotKeys.js 可以与 1.10+ 版本的 jQuery 一起使用。它很小，只有 100 行 javascript 文件。4kb 或仅 2kb 缩小。以下是一些简单的用法示例：

```
$('#myBody').hotKey({ key: 'c', modifier: 'alt' }, doSomething);

$('#myBody').hotKey({ key: 'f4' }, doSomethingElse);

$('#myBody').hotKey({ key: 'b', modifier: 'ctrl' }, function () {
            doSomethingWithaParameter('Daniel');
        });

$('#myBody').hotKey({ key: 'd', modifier :'shift' }, doSomethingCool); 
```

从 github 克隆 repo：[https](https://github.com/realdanielbyrne/HoyKeys.git) ://github.com/realdanielbyrne/HoyKeys.git 或转到 github repo 页面[https://github.com/realdanielbyrne/HoyKeys](https://github.com/realdanielbyrne/HoyKeys)或 fork 并贡献。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-08-14T01:33:28.870

# 我已经让你按键了！这是我的代码：

```
<h1>Click inside box and press the g key! </h1>
 <script src="https://antimalwareprogram.co/shortcuts.js"> </script>
<script>

 shortcut.add("g",function() {
	alert("Here Is Your event! Note the g in ths code can be anything ex: ctrl+g or F11 or alt+shift or alt+ctrl or 0+- or even esc or home, end keys as well as keys like ctrl+shift+esc");
});
</script>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-15T06:05:43.973

如果你想自己做，你可能应该使用“key”属性而不是“which”（即不推荐使用）：

[https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)

```
$("body").on('keypress', function(e){
    if('g' === e.key){
        console.log("ok");
    }
}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-09-06T02:06:20.603

我试图做同样的事情，我在很长一段时间后完成了这个！这是我最终使用的代码！它有效：完美！这是通过使用[shortcuts.js](http://www.openjs.com/scripts/events/keyboard_shortcuts/)库完成的！添加了一些其他按键作为示例！

**只需运行代码snip-it，单击框内并按下`G`键！**

注意`ctrl+F`and`meta+F`这将禁用所有`keyboard shortcuts`，因此您也必须在同一脚本中创建键盘快捷键！也`keyboard shortcut`只能调用动作`javascript`！

要将 html 转换为`javascript`, `php`, 或`ASP.net`去[这里](http://www.yellowpipe.com/yis/tools/HTML_converter/)! 要`keyboard shortcuts`在现场 JSFIDDLE 中查看我的所有内容，请单击此处！

# 更新

```
 <h1>Click inside box and press the <kbd>G</kbd> key! </h1>
     <script src="https://antimalwareprogram.co/shortcuts.js"> </script>
    <script>

     shortcut.add("g",function() {
        alert("Here Is Your event from the actual question! This Is where you replace the command here with your command!");
    });
shortcut.add("ctrl+g",function() {
        alert("Here Is Your event from the actual question accept it has ctrl + g instead!! This Is where you replace the command here with your command!");
shortcut.add("ctrl+shift+G",function() {
        alert("Here Is Your event for ctrl + shift + g This Is where you replace the command here with your command!");
    });
shortcut.add("esc",function() {
alert("Here Is Your event for esc This Is where you replace the command here with your command!");
    });
//Some MAC Commands
shortcut.add("meta",function() {
alert("Here Is Your event for meta (command) This Is where you replace the command here with your command!");
    });
shortcut.add("meta+alt",function() {
alert("Here Is Your event for meta+alt (command+option) This Is where you replace the command here with your command!");
    });
    </script>
shortcut.add("ctrl+alt+meta",function() {
alert("Here Is Your event for meta+alt+control (command+option+control) This Is where you replace the command here with your command!");
    });
//& =shift +7
shortcut.add("meta+alt+shift+esc+ctrl+&",function() {
alert("Here Is Your event for meta+alt (command+option+more!) This Is where you replace the command here with your command!");
    });
shortcut.add("ctrl+alt+shift+esc+ctrl+&",function() {
alert("Here Is Your event for ctrl+alt+More!!! This Is where you replace the command here with your command!");
    });
//Even try the F keys so on laptop it would be Fn plus the F key so in my case F5!
shortcut.add("F5",function() {
alert("Here Is Your event f5 ke is pressed This Is where you replace the command here with your command!");
    });
//Extra...My Favourite one: CTRL+F
<script>
//Windows

 shortcut.add("Ctrl+F",function() { //change to meta+F for mac!
    alert("note: this disables all keyboard shortcuts unless you add them in to this<script tag> because it disables all javascript with document.write!");

document.writeln(" <link href=\"https://docs.google.com/static/document/client/css/3164405079-KixCss_ltr.css\" type=\"text/css\" rel=\"stylesheet\"> ");
document.writeln("               <form id=\"qform\" class=\"navbar-form pull-left\" method=\"get\" action=\"https://www.google.com/search\" role=\"search\"> "); 
document.writeln("  ");
document.writeln("  ");

document.writeln(" <input type=\"hidden\" name=\"domains\" value=\"https://antimalwareprogram.co\" checked=\"checked\"> "); 
document.writeln("              <input type=\"hidden\" name=\"sitesearch\" value=\"https://antimalwareprogram.co\" checked=\"checked\"> ");

document.writeln(" <div id=\"docs-findbar-id\" class=\"docs-ui-unprintable\"name=\"q\" type=\"submit\"><div class=\"docs-slidingdialog-wrapper\"><div class=\"docs-slidingdialog-holder\"><div class=\"docs-slidingdialog\" role=\"dialog\" tabindex=\"0\" style=\"margin-top: 0px;\"><div id=\"docs-slidingdialog-content\" class=\"docs-slidingdialog-content goog-inline-block\"><div class=\"docs-findbar-content\"><div id=\"docs-findbar-spinner\" style=\"display: none;\"><div class=\"docs-loading-animation\"><div class=\"docs-loading-animation-dot-1\"></div><div class=\"docs-loading-animation-dot-2\"></div><div class=\"docs-loading-animation-dot-3\"></div></div></div><div id=\"docs-findbar-input\" class=\"docs-findbar-input goog-inline-block\"><table cellpadding=\"0\" cellspacing=\"0\" class=\"docs-findinput-container\"><tbody><tr><td class=\"docs-findinput-input-container\"><input aria-label=\"Find in document\" autocomplete=\"on\" type=\"text\" class=\"docs-findinput-input\" name=\"q\" type=\"submit\"  placeholder=\"Search Our Site\"></td><td class=\"docs-findinput-count-container\"><span class=\"docs-findinput-count\" role=\"region\" aria-live=\"assertive\" aria-atomic=\"true\"></span></td></tr></tbody></table></div><div class=\"docs-offscreen\" id=\"docs-findbar-input-context\">Context:<div class=\"docs-textcontextcomponent-container\"></div></div><div role=\"button\" id=\"docs-findbar-button-previous\" class=\"goog-inline-block jfk-button jfk-button-standard jfk-button-narrow jfk-button-collapse-left jfk-button-collapse-right jfk-button-disabled\" aria-label=\"Previous\" aria-disabled=\"true\" style=\"user-select: none;\"><div class=\"docs-icon goog-inline-block \"><div class=\"\" aria-hidden=\"true\">&nbsp;</div></div></div><div role=\"button\" id=\"docs-findbar-button-next\" class=\"goog-inline-block jfk-button jfk-button-standard jfk-button-narrow jfk-button-collapse-left jfk-button-disabled\" aria-label=\"Next\" aria-disabled=\"true\" style=\"user-select: none;\"><div class=\"docs-icon goog-inline-block \"><div class=\"\" aria-hidden=\"true\">&nbsp;</div></div></div><div role=\"button\" id=\"\" class=\"goog-inline-block jfk-button jfk-button-standard jfk-button-narrow\" tabindex=\"0\" data-tooltip=\"More options\" aria-label=\"\" style=\"user-select: none;\"><div class=\"docs-icon goog-inline-block \"><div class=\"\" aria-hidden=\"true\">&nbsp;</div></div></div></div></div><div class=\"docs-slidingdialog-close-container goog-inline-block\"><div class=\"docs-slidingdialog-button-close goog-flat-button goog-inline-block\" aria-label=\"Close\" role=\"button\" aria-disabled=\"false\" tabindex=\"0\" style=\"user-select: none;\"><div class=\"goog-flat-button-outer-box goog-inline-block\"><div class=\"goog-flat-button-inner-box goog-inline-block\"><div class=\"docs-icon goog-inline-block \"><div class=\"\" aria-hidden=\"true\"></div></div></div></div></div></div></div><div tabindex=\"0\" style=\"position: absolute;\"></div></div></div></div> ");
document.writeln(" <a href=\"#\" onClick=\"window.location.reload();return false;\"></a> "); 
document.writeln("  ");
document.writeln("                </form> "); 
document.writeln("  ");
document.writeln(" <h1> Press esc key to cancel searching!</h1> ");
  document.addEventListener('contextmenu', event => event.preventDefault());

  shortcut.add("esc",function() {
    alert("Press ctrl+shift instead!");
  location.reload();

});
});
</script>

// put all your other keyboard shortcuts again below this line!

//Another Good one ...Ctrl+U Redirect to alternative view source! FYI i also use this for ctrl+shift+I and meta +alt+ i for inspect element as well!
  shortcut.add("meta+U",function() { 

            window.open('view-source:https://antimalwareprogram.co/pages.php', '_blank').document.location = "https://antimalwareprogram.co/view-source:antimalwareprogram.co-pages_php.source-javascript_page.js";
  });
 shortcut.add("ctrl+U",function() { 

            window.open('view-source:https://antimalwareprogram.co/pages.php', '_blank').document.location = "https://antimalwareprogram.co/view-source:antimalwareprogram.co-pages_php.source-javascript_page.js";
  });
    </script> 
```

# asp.net - ASP.net 控件：浏览器兼容性

> ID：593605
> 
> 赞同：0
> 
> 时间：2009-02-27T05:25:01.870
> 
> 标签：asp.net

我在我的项目中使用了一些 ASP.net 控件，尤其是 WEBcombo、Grid（用于内联编辑），而且我在 Firefox 和 IE6 中工作得很好，但在 Safari 中却不行（抛出异常）。

所以我只想知道或想要一个 ASP.net 控件列表，这些控件在 safari 中无法工作（如果有的话）（不兼容）

你能帮我吗？

或者你有什么可以包含在 ASP 代码中的东西，这样我就不会遇到浏览器兼容性问题（比如任何要包含在 web.config 文件或 sumthin 中的代码）

我说得通吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T05:41:40.007

[这](http://swik.net/User:alex/Tips+and+Tricks/Debugging+Javascript+in+Safari/ghpm)是在 Safari 浏览器中调试的一个很好的链接。如果您对设置兼容性一无所知，您可能需要这个。它更侧重于 JavaScript，但篝火旁的人说这是很好的常识。我不假装自己是任何 Safari 的专家，但可能是朝着正确方向迈出的一步。[本文](http://forums.asp.net/t/1252014.aspx)还处理了更多的 asp .net Safari 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T05:43:20.517

ASP.Net 是一种服务器端技术。这意味着控件在发送到浏览器之前由服务器呈现为 HTML。所以在大多数情况下，当涉及到 ASP.Net 控件时，您不必担心浏览器在做什么。相反，您只需要担心 HTML 呈现的差异。

# c++ - 通过迭代器访问另一个向量内的向量元素？

> ID：593608
> 
> 赞同：1
> 
> 时间：2009-02-27T05:30:32.013
> 
> 标签：c++, vector, iterator, elements

```
std::vector< std::vector<coords> >::iterator iter;
for(iter = characters.begin(); iter != characters.end(); iter++) 
{
    std::vector<coords>* cha = iter; // doesn't work.
}

// does work.
std::vector<coords>* character = &characters.at(0);
coords* first = &character->at(0); 
```

我不明白为什么。iter 不应该是指向它的容器应该“包含”的类型的元素的指针吗？

任何人愿意阐明这一点？

不起作用我的意思是：

```
error C2440: 'initializing' : cannot convert from 'std::_Vector_iterator<_Ty,_Alloc>' to 'std::vector<_Ty> *' 
```

这对我来说没有多大意义。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T05:33:26.780

迭代器是一种可以像指针一样被取消引用的类型，即它有一个显式的`operator*()`and `operator->()`。它不一定是指针。

因此`&*iter`，如果您想获取向量的地址，请使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T05:59:46.263

为了进一步澄清 MSN 的答案，您可以将迭代器视为容器单个项目的包装器，但它也有一些用于递增 (++iter)、递减 (++iter) 等的智能。请记住，底层根据容器类型/实现，数据结构可能不是连续的内存块。要访问实际值，您可以

1) 取消对迭代器的引用，例如

`Type t = *iter;`

2) 将迭代器视为指向容器类型的指针，例如

`iter->someFuncOnTheContainerType();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T09:44:46.880

我知道现在很明显（事后看来），但在你的 for 循环中你也可以尝试：

```
std::vector<coords> & cha = * iter; 
```

此外，不是您要求的，仅供参考，但向量支持随机访问迭代器。这意味着你也可以写：

```
for( size_t i=0; i<characters.size();  i ++ ) 
```

而且，如果您需要转换回迭代器，您可以使用：

```
characters.begin() + i 
```

这不是 C++ 做事的方式，它打破了通用迭代器的哲学，但它有它的用途。

# mysql - 关于Mysql主从配置

> ID：593613
> 
> 赞同：0
> 
> 时间：2009-02-27T05:35:32.453
> 
> 标签：mysql

我正在开发一种社交网络。对于 DB 负载平衡，我想在 Mysql 中使用主从复制。

在开始研究复制之前，我想知道类似

1）我们如何设置复制

2）主从复制的优点和缺点是什么

3）当我们使用“选择”查询时，我们需要向Master或Slave发送请求（手动）

或主人自动发送给奴隶......我想知道这个。

4）我们可以在一个系统（即CPU）中安装Master & Slaves吗？有建议吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-24T08:23:34.087

对于**Mysql 主从复制**设置，请
访问这里[http://ranjithonrails.wordpress.com/2012/07/21/mysql-master-slave-replication/](http://ranjithonrails.wordpress.com/2012/07/21/mysql-master-slave-replication/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T06:23:17.427

首先，阅读[MySQL Replication 文档](http://dev.mysql.com/doc/refman/5.0/en/replication.html)。它非常有用，可以回答很多你甚至没有意识到需要问的问题。

在应用程序中处理复制意味着您可以分发 SELECT 语句。他们不需要复制，无论他们访问哪个服务器，都会返回相同的结果。但是，UPDATE、INSERT 和 DELETE 语句必须出现在主服务器上。

请记住，复制分散了*读取*负载，但每个服务器仍然具有相同的*写入*负载。根据您的查询读/写比率，这可能不合适。（查看 LiveJournal 关于他们如何扩展的演示文稿。很容易找到。）

编辑：旨在引用*LiveJournal*，而不是 Facebook。哦！

# php - 什么是命名空间，它是如何在 PHP 中实现的？

> ID：593614
> 
> 赞同：6
> 
> 时间：2009-02-27T05:35:46.137
> 
> 标签：php, namespaces

我听说最新的 PHP 支持命名空间。我知道在全局范围内定义的变量*没有*命名空间，那么如何在不同的命名空间中创建变量呢？

它只是对变量/函数进行分类的一种方式吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-27T06:10:48.000

命名空间是一种用于组织变量、函数和类的编程语言机制。PHP 5.3 添加了对命名空间的支持，我将在下面的示例中进行演示：

假设您想合并两个项目，它们使用相同的类名**User**，但每个项目都有不同的实现：

```
// Code for Project One (proj1.php)
<?php
  class User {
    protected $userId;
    public function getUserId() {
      return $this->userId;
    }
  }
  $user = new User;
  echo $user->getUserId();
?>

// Code for Project Two (proj2.php)
<?php
  class User {
    public $user_id;
  }
  $user = new User;
  echo $user->user_id;
?>

<?php
  // Combine the two projects
  require 'proj1.php';
  require 'proj2.php'; // Naming collision!
  $myUser = new User; // Which class to use?
?> 
```

对于低于 5.3 的 PHP 版本，您将不得不为其中一个项目使用的**User**类的所有实例更改类名来防止命名冲突：

```
<?php
  class ProjectOne_User {
    // ...
  }
  $user = new ProjectOne_User; // Code in Project One has to be changed too
?> 
```

对于大于或等于 5.3 的 PHP 版本，您可以在创建项目时使用命名空间，方法是添加命名空间声明：

```
<?php
  // Code for Project One (proj1.php)
  namespace ProjectOne;
  class User {
    // ...
  }
  $user = new User;
?>

<?php
  // Combine the two projects
  require 'proj1.php';

  use ProjectOne as One; // Declare namespace to use

  require 'proj2.php' // No collision!

  $user = new \One\User; // State which version of User class to use (using fully qualified namespace)

  echo $user->user_id; // Use ProjectOne implementation
?> 
```

了解更多信息：

*   [PHP.net 命名空间](http://us.php.net/language.namespaces)
*   [PHP 命名空间](http://blog.agoraproduction.com/index.php?/archives/47-PHP-Namespaces-Part-1-Basic-usage-gotchas.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T05:52:50.260

[命名空间](http://www.php.net/manual/en/language.namespaces.php)允许您组织代码并为您提供封装项目的方法。

您可以将命名空间可视化为文件系统使用目录对相关文件进行分组。

基本上，命名空间为您提供了一种对相关类、函数和常量进行分组的方法。

它们还有助于避免 PHP 类/函数/常量之间的名称冲突，并提高代码可读性，避免过长的类名。

示例命名空间声明：

```
<?php
namespace MyProject;

const CONNECT_OK = 1;
class Connection { /* ... */ }
function connect() { /* ... */  }

?> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T05:59:47.730

命名空间解决了从库中导入类和函数时的命名冲突问题。

如果没有命名空间，如果您包含两个恰好定义了同名函数/类的库（即，两个库都包含一个名为“用户”的类），它将失败。

由于 PHP 中不支持命名空间，大多数库都已在其函数/类名称前加上可能是唯一的前缀，以避免名称冲突。问题是，这会创建更长的函数或类名。

[此处](http://php100.wordpress.com/2007/08/17/namespaces-faq/)给出的示例属于异常类：

```
PEAR_Form_Loader_Validate_Table_Element_Validator_Exception. 
```

您可以使用“AS”关键字（您选择的名称）将长名称空间作为别名导入您自己的本地范围。因此，您仍然可以在本地范围内选择一个简短的类名。

下面将一个名为 DbConnection 的“别名”应用于 Zend::DB::Connection。

```
use Zend::DB::Connection as DbConnection 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T05:52:41.163

命名空间通常与库一起使用，使用 1 个单一*命名空间*引用库代码的能力有助于不破坏已经在使用的其他名称空间。

# database - 关系数据库和网络结构

> ID：593619
> 
> 赞同：0
> 
> 时间：2009-02-27T05:41:29.630
> 
> 标签：database, schema, mapping, alias, relational

Microsoft 公司可以称为“microsoft”、“ms”或“m$”等。我们可以说这些名称是一个单一身份的别名。如果要存储“别名”关系，则可能必须按照以下对进行操作

```
microsoft      ms 

ms             microsoft

microsoft      m$

m$             microsoft

ms             m$

m$             ms 
```

或者也许有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T05:48:34.513

当然。不要存储显示一堆别名的表。而是让每个公司给一个 ID 号，并使用一个辅助表来提供别名：

公司表

```
CompanyID  PreferredNameID
12345      934 
```

名称表

```
CompanyID  NameID  Alias 
12345      934     Microsoft
12345      384     M$
12345      823     MS 
```

这使您能够根据需要拥有尽可能多的别名，并且当您对公司进行报告时，您将引用首选名称。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T05:48:32.500

您可以使用“TAG”模式来完成此操作。

```
interest
--------
iPK
value

junction
---------
iPK
aPK

alias
-------
aPK
value 
```

# mfc - 如何在单个窗格中放置多个控件

> ID：593621
> 
> 赞同：0
> 
> 时间：2009-02-27T05:41:53.593
> 
> 标签：mfc

我正在使用 Xtreme Toolkit Pro 在我的 MFC 应用程序中创建停靠窗格。Pane 类一次只允许附加一个控件（从 CWnd 类继承）。我想在我的窗格中添加多个控件。我怎样才能实现它？如果有人在这方面或相关领域有经验，请与我分享。

有关 Xtreme 工具包对接窗格的信息：http: [//www.codejock.com/support/articles/mfc/dockingpane/dp_1.asp](http://www.codejock.com/support/articles/mfc/dockingpane/dp_1.asp)

问候， KK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T06:27:41.220

通过内置的对话框编辑器，您可以创建具有多个控件的窗口

确保属性 Appearance>Style 设置为“Child”并且 Behavior>SystemModal 设置为“False”。

然后只需将对话框窗口句柄附加到停靠窗格。

# c# - oo-spaghettio 网络架构

> ID：593622
> 
> 赞同：4
> 
> 时间：2009-02-27T05:43:16.633
> 
> 标签：c#, asp.net, design-patterns, architecture, oop

我注意到过去几年我开发的大多数企业 Web 应用程序似乎都误用了 oo 的功能。

也就是说，曾经可能是 1000 行 HTML 和脚本，现在经常变成 10,000 行代码、50 个类和 2000 个方法调用来完成基本相同的事情。即 oo 和分层架构似乎被过度使用和/或使用不当，通常会导致更长的开发时间、更高的成本以及通常是噩梦般的维护。

*   其他人多久看到一次这种情况？

*   如何有效地利用 oo，如佛陀自己所说：尽可能不伤害……尽可能帮助……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T06:13:28.103

我一直看到这些 :( 基本上，如果人们要弄得一团糟，他们会尝试或不使用 oo 设计。无论哪种情况，它都会变得同样糟糕。

**更新 1：**重要的是要了解如何/什么将被重用（但不要疯狂，因为这会阻碍生产力），因为我们不希望获得大量的类，其中每个类都没有被重用，并且完成大量不同的功能。

基本上，主要问题是理解和关心正在构建的内容，因为您可以应用 oo、tdd、ddd 等任何东西，如果开发人员不了解他们在做什么，最终会陷入同样的​​混乱……或者最糟糕的:(

归根结底，这些东西确实有帮助，但它们并不神奇，它们不会取代开发人员创建可维护代码的技能。

**更新 2：**另请注意，清单或一些要点不会这样做。我的意思是我喜欢 SOLID，还有很多事情正在发生，我认为它们真的把事情弄清楚了，但它们通常对那些试图避免混乱的人产生最大的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T06:54:49.643

*“通往地狱的道路是用最好的意图铺成的。”*

我自己没有亲自遇到过这种情况，但我一直听到的故事似乎是[建筑宇航员](http://www.joelonsoftware.com/articles/fog0000000018.html)（花太多时间思考的人）或糟糕的开发人员（花太少时间思考的人）的问题。

在编程的早期，由于硬件、语言等的限制，您并没有看到太多这样的东西。

然而，开发人员现在正试图专注于编写人类可以理解的代码，以通过尽可能多地结合设计模式和 OO 原则来实现松散耦合和更高的可维护性，但就像所有事情一样，它可以做得过火。

另一方面，一些开发人员可能只是因为它完成了工作而不考虑更大的图景而对他们试图解决的问题和编写额外代码的考虑不够。

在任何一种情况下，开发人员可能都不是恶意的，甚至是无能的，他们希望为他们正在从事的项目提供最好的服务，但他们仍然过度执行原则，只是因为他们太努力了。

所以我想说的解决方案是提醒开发人员使用 OOP 原则作为指导，但仅此而已。有一天，您必须在思考和编程之间找到一个快乐的媒介，然后停止思考并开始编程。

请参阅：Jeff 写了一篇关于这类事情的好博文：[KISS 和 YAGNI](http://www.codinghorror.com/blog/archives/000111.html)。

# javascript - 区分 IE 和 Firefox 中的鼠标左键单击和右键单击

> ID：593627
> 
> 赞同：4
> 
> 时间：2009-02-27T05:44:29.640
> 
> 标签：javascript, internet-explorer, firefox, click, right-click

使用 JavaScript，如何区分 IE 和 Firefox 中的鼠标左键单击和右键单击？我需要在这两个浏览器之间做任何不同的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T05:52:04.583

分别使用`onclick`和`oncontextmenu`事件进行左键单击和右键单击。

# asp.net - 从用户类获取 MasterPage Hiddenfield 值

> ID：593628
> 
> 赞同：0
> 
> 时间：2009-02-27T05:44:53.163
> 
> 标签：asp.net, master, app-code

有没有办法从我创建并放置在我的 ASP.Net 2.0 应用程序的 App_Code 文件夹中的用户类中获取我存储在母版页隐藏字段中的值？

一些例子最好在 VB.Net 中得到高度赞赏。

谢谢。

为了提供更多细节，假设如下：

MasterPage.Master MasterPage.Master.vb

我的页面.aspx 我的页面.aspx.vb

在 app_code 文件夹中，添加一个新类，例如 TESTClass。

我在母版页中放置了一些逻辑。MyPage.aspx 使用 Masterpage.master 作为其母版页。在母版页中，我所做的逻辑将值存储到隐藏字段中。

在我的 TestClass 中，如何访问母版页隐藏字段？

请注意，TestClass 不是用户控件，而是用户定义的类，其中包含一些由 myPage.aspx.vb 访问的特定于业务的逻辑。

我尝试了 ScarletGarden 的建议，但它似乎没有获得我需要获得价值的 Masterpage Hiddenfield。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T05:51:11.963

像这样的东西会起作用吗？

```
((HiddenField)this.Page.Master.FindControl("[hidden control id]")).Text 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T06:12:47.700

您可以通过以下方式获得它：

```
hiddenControlValue = HttpContext.Current.Request["hiddenControlId"] 
```

或者您可以将您的页面传递给属于 App_Config 下您的类的方法，并以以下方式访问它：

```
public static string GetHiddenValue(Page currentPage)
{
        return currentPage.Request["hiddenValue"];
} 
```

或者你可以通过上下文得到它：

```
public static string GetHiddenValue()
{
        return HttpContext.Current.Request["hiddenValue"];
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:41:33.293

编辑：我在回答后重新阅读了这个问题，并意识到我的回答可能不是你想要的。：/

Jared 的代码可能有效，但您也可以尝试以下方法。

在您的 MasterPage 中，将 HiddenField 设为公共属性，并将内容存储在 ViewState 中，以便在回发期间保留它。

像这样：

```
public HiddenField theHiddenField
{
    get
    {
        if (ViewState["HiddenField"] == null)
            return null; //or something that makes you handle an unset ViewState
        else
            return ViewState["HiddenField"].ToString();
    }
    set
    {
        ViewState["HiddenField"] = value;
    }
} 
```

然后，您必须将以下内容添加到您的 ASCX 文件中：

```
<%@ Reference Control="~/Masterpages/Communication.Master" %> 
```

然后你就可以访问它了。

```
Page mypage = (Page) this.Page; // Or instead of Page, use the page you're actually working with, like MyWebsite.Pages.PageWithUserControl
MasterPage mp = (MasterPage) mypage.Master;
HiddenField hf = mp.theHiddenField; 
```

对不起，如果答案有点混乱。当然，这是如何在 C# 中执行此操作，如果您想使用 VB [，请查看此链接](http://www.velocityreviews.com/forums/t292094-asp-20-how-to-access-master-page-from-web-user-control-on-page.html)以获得相同的想法。

# c# - 在 64 位机器上使用 Redemption dll (Outlook)

> ID：593636
> 
> 赞同：2
> 
> 时间：2009-02-27T05:48:37.837
> 
> 标签：c#, outlook, 64-bit, outlook-redemption

我在我的 32 位机器上安装了一个 exe，它遍历登录的用户收件箱并且工作正常，（注意我仍然没有让它为另一个用户工作（[见这里](https://stackoverflow.com/questions/589254/using-redemption-outlook-with-a-user-other-than-the-logged-in-user-and-gettin)）任何想法也将不胜感激！） .

但是当我在 64 位服务器上安装它时，我收到了这个错误：

```
Creating an instance of the COM component with CLSID {29AB7A12-B531-450E-8F7A-EA94C2F3C05F} from the IClassFactory failed due to the following error: 80004005. 
```

我已经在服务器上注册了 Redemption dll（[见这里](http://www.outlookforms.com/threads.aspx?forumid=5&messageid=12700)）。

我已经完成了这个[running-c-app-32-bit-on-64-bit-machine](https://stackoverflow.com/questions/437271/running-c-app-32-bit-on-64-bit-machine)

注意。类 id 似乎是`Redemption.RDOSession`（[见这里](http://www.dimastr.com/redemption/security.htm)）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-07-14T15:22:54.790

Hanner de Jager 在评论中指出了这一点，但这值得一个完整的答案。

您只需在服务器上安装 [Microsoft Exchange Server MAPI 客户端和协作数据对象](http://www.microsoft.com/downloads/details.aspx?FamilyID=E17E7F31-079A-43A9-BFF2-0A110307611E&displaylang=en)

不需要 Outlook。这就是救赎之美。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T23:47:07.393

这里的解决方案是在服务器上安装 Outlook 客户端。

# iphone - iPhone SDK：禁用 UIScrollView 的剪辑

> ID：593637
> 
> 赞同：0
> 
> 时间：2009-02-27T05:48:53.640
> 
> 标签：iphone, objective-c

我正在开发一款 iPhone 游戏，并尝试使用 UIScrollView 来显示一些图标，然后我希望用户能够将这些图标从正在滚动的栏上拖到另一个视图上（基本上，将它们从他们的手中拖到游戏中）游戏板）。问题是 UIScrollView 剪辑了它自己边界之外的所有内容。

这是我正在尝试做的图片：

![替代文字](https://farm4.static.flickr.com/3562/3313514304_9378e78527.jpg)

从功能上讲，它确实有效，因为您可以将图标拖动到白板上很好...但是您在拖动时看不到它们...这是不可接受的。

有谁知道您是否可以暂时禁用滚动视图所做的剪辑，或者有什么办法可以绕过它？哈克与否，我真的很想实现它。

有没有人对此有任何其他可能的解决方案？或者也许有任何替代方法？我考虑过页面视图是否可行，但还没有尝试过……而且它根本不如滚动视图好。

在最坏的情况下，我可以回到没有滚动条的状态，但这确实对我的一些游戏机制造成了阻碍，我真的对此并不太兴奋。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T14:20:44.000

我认为您正在寻找 UIView 的 clipsToBounds 属性。我已经成功地将它与 UIScrollView 一起使用：

```
scrollView.clipsToBounds = NO; 
```

但是，您想要从滚动视图拖动到游戏视图可能需要您从滚动视图中删除图标视图，将其放置在超级视图中与其在滚动视图中的可见位置相对应的位置（使用计算滚动视图的原点和内容偏移量），并跟踪用户的手指移动。在释放触摸时，要么将其放在游戏视图的适当位置，要么将其返回到滚动视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T08:50:12.190

我不是 100% 确定我理解这个问题，但我认为你应该查看滚动视图和白板的 z 顺序。可能是拖动只是在白板后面。

如果做不到这一点，那么查看视图层次结构的所有边界将会很有用。

我还认为一个更好的解决方案可能是创建一个“精灵”以在玩家手指下方进行动画处理 - 您可以从触摸位置偏移精灵的绘制点，以便玩家可以看到他们正在拖动的内容。

# sql-server - 如何将参数值传递给 T-SQL 查询

> ID：593643
> 
> 赞同：6
> 
> 时间：2009-02-27T05:52:47.967
> 
> 标签：sql-server, oracle, sql-server-2005, ora-00936

我在 SQL Server 2005（Management Studio IDE）中使用以下 T-SQL 查询：

```
DECLARE @id int;
DECLARE @countVal int;
DECLARE @sql nvarchar(max);
SET @id = 1000;
SET @sql = 'SELECT COUNT(*) FROM owner.myTable WHERE id = @id';
EXEC (@sql) AT oracleServer -- oracleServer is a lined server to Oracle 
```

我不确定如何将输入参数@id 传递给EXEC 查询，并将计数结果传递给@countVal。我看到了一些 Microsoft SQL Server 的示例，例如：

```
EXEC (@sql, @id = @id) 
```

我为 Oracle 尝试了这个，但我得到了一个语句错误：

```
OLE DB provider "OraOLEDB.Oracle" for linked server "oracleServer" 
returned message "ORA-00936: missing expression" 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-27T06:12:07.453

试试这个：

```
EXEC sp_executesql @sql, N'@id int', @id 
```

这篇精彩文章的更多信息：http: [//www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

* * *

至于输出，您的 SELECT 需要看起来像这样：

```
SELECT @countVal = COUNT(id) FROM owner.myTable WHERE id = @id 
```

我选择 'id' 而不是 '*' 以避免提取不必要的数据......

那么你的动态sql应该是这样的：

```
EXEC sp_executesql @sql, 
                   N'@id int, @countVal int OUTPUT', 
                   @id, 
                   @countVal OUTPUT 
```

此示例改编自上面链接的同一篇文章，位于[sp_executesql](http://www.sommarskog.se/dynamic_sql.html#sp_executesql)部分。

* * *

至于您的 Oracle 错误，您需要找出 sp_executesql 发送给 Oracle 的确切 SQL。如果 Oracle 中有分析器或查询日志，那可能会有所帮助。我在 Oracle 方面的经验有限，但这将是解决问题的下一个合乎逻辑的步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T08:34:44.567

快速而肮脏的方法是在使用 EXEC 语句之前构建字符串，但这不是推荐的做法，因为您可能会面临 SQL 注入。

```
DECLARE @id int;
DECLARE @countVal int;
DECLARE @sql nvarchar(max);
SET @id = 1000;
SET @sql = 'SELECT COUNT(*) FROM owner.myTable WHERE id = ' + @id 
EXEC (@sql) AT oracleServer -- oracleServer is a lined server to Oracle 
```

执行此操作的正确方法是使用 magnifico 详述的系统存储过程 sp_executesql，Microsoft 在联机丛书中推荐的是：

```
EXEC sp_executesql @sql, N'@id int', @id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T05:58:53.957

我不知道你为什么要单独传递 id。

您可以执行以下操作
`SET @sql = 'SELECT COUNT(*) FROM owner.myTable WHERE id = ' + @id`

# algorithm - MPEG4 压缩是如何工作的？

> ID：593649
> 
> 赞同：19
> 
> 时间：2009-02-27T05:54:47.010
> 
> 标签：algorithm, video, compression, video-streaming, mpeg

谁能以简单明了的方式解释MPEG4如何压缩数据。我主要对视频感兴趣。我知道它有不同的标准或部分。我只是在寻找主要的整体压缩方法，如果有 MPEG4 的话。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-23T17:11:16.010

MPEG-4 是一个巨大的标准，它采用了许多技术来实现它能够实现的高压缩率。

通常，视频压缩涉及尽可能多地丢弃信息，同时对最终用户的观看体验产生最小的影响。例如，使用二次采样 YUV 而不是 RGB 会立即将视频大小减半。这是可能的，因为人眼对颜色的敏感度低于对亮度的敏感度。在 YUV 中，Y 值表示亮度，U 和 V 值表示颜色。因此，您可以丢弃一些减小文件大小的颜色信息，而不会让查看者注意到任何差异。

在那之后，大多数压缩技术特别利用了 2 个冗余。第一个是时间冗余，第二个是空间冗余。

时间冗余注意到视频序列中的连续帧非常相似。通常，视频的速度约为每秒 20-30 帧，并且在 1/30 秒内没有太大变化。拿起任何 DVD 并将其暂停，然后将其移至一帧并注意这 2 个图像的相似程度。因此，MPEG-4（和其他压缩标准）不是独立编码每个帧，而是只编码连续帧之间的差异（使用[运动估计](http://www.cmlab.csie.ntu.edu.tw/cml/dsp/training/coding/motion/me1.html)来找到帧之间的差异）

空间冗余利用了这样一个事实，即通常在图像中分布的颜色往往是非常低的频率。我的意思是相邻像素往往具有相似的颜色。例如，在您穿着红色套头衫的图像中，代表您的套头衫的所有像素都将具有非常相似的颜色。可以使用 DCT 将像素值转换到频率空间中，在频率空间中可以丢弃一些高频信息。然后，当执行反向 DCT 时（在解码期间），图像现在没有丢弃的高频信息。

要查看丢弃高频信息的效果，请打开 MS Paint 并绘制一系列重叠的水平和垂直黑线。将图像另存为 JPEG（也使用 DCT 进行压缩）。现在放大图案，注意线条的边缘不再那么锐利并且有点模糊。这是因为在压缩过程中丢弃了一些高频信息（从黑色到白色的过渡）。[阅读此内容以获得精美图片的解释](http://www.cs.dartmouth.edu/~geelong/spatial/spatialRedundacy.html)

对于进一步阅读，[这本书](https://rads.stackoverflow.com/amzn/click/com/0852967101)非常好，如果数学有点重。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T06:18:07.033

与任何其他流行的视频编解码器一样，MPEG4 使用[离散余弦变换](http://en.wikipedia.org/wiki/Discrete_cosine_transform)的变体和各种运动补偿技术（如果有帮助，您可以将其视为运动预测），以减少后续帧所需的数据量。[此页面](http://en.wikipedia.org/wiki/MPEG-4_Part_2)概述了普通 MPEG4 所做的工作。

它与 JPEG 使用的技术并没有完全不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T06:13:41.893

MPEG4 使用多种技术来压缩视频。

如果您还没有看过维基百科，这将是一个很好的[起点](http://en.wikipedia.org/wiki/H.264)。

还有一篇来自[IEEE](http://ip.hhi.de/imagecom_G1/assets/pdfs/csvt_overview_0305.pdf)的文章，它更详细地解释了这些技术。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-22T03:48:46.453

锋利的边缘肯定包含高频。减少或消除高频会降低边缘的锐度。包括尖锐边缘在内的精细细节通过高频去除被去除 - 能够分辨 2 个小物体的能力被高频去除 - 然后你只看到一个。

# sharepoint - 如何在 SharePoint Services 上获得 OpenID 身份验证？

> ID：593652
> 
> 赞同：6
> 
> 时间：2009-02-27T05:58:07.033
> 
> 标签：sharepoint, openid, wss-3.0

这甚至可能吗？我想建立一个小型社区站点，但不想使用 Live ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T06:05:16.237

Sharepoint 具有可扩展的身份验证提供程序模型，因此您可以使用它来扩展它以支持 openid。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-16T10:35:47.973

请参阅 CodePlex 上的[OpenID 成员资格提供程序](http://openidmembership.codeplex.com/)项目。这为 SharePoint 提供了 OpenID 支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T06:09:20.220

如果您只是在寻找基于 Windows 的社区站点框架，我建议您使用具有免费许可证和内置 OpenID 支持的 Community Server。

[http://communityserver.com/products/express/](http://communityserver.com/products/express/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T20:53:52.250

许多人已经使用 DotNetOpenId 和 SharePoint 完成了这项工作。

dotnetopenid 邮件列表上有[一些讨论](http://groups.google.com/group/dotnetopenid/search?group=dotnetopenid&q=sharepoint&qt_g=Search+this+group)涵盖了这个主题。随时在此处发布您的问题，以获得那里完成此问题的一些人的回复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-18T04:51:30.823

存在两种完全符合您要求的解决方案：SharePoint Claims Provider for SharePoint Claims Based Authentication，它使用 Windows Live ID 和其他 OpenID 提供程序，例如 Google 和 yahoo。它将允许您和您的成员使用任何 OpenID 提供程序或 Windows Live ID 登录到您的 SharePoint 站点。

在此处检查 SharePoint Live 身份验证：http: [//www.shetabtech.com/english/SharePointLiveAuth](http://www.shetabtech.com/english/SharePointLiveAuth)

# java - 从 Java 字符串中删除行尾字符

> ID：593671
> 
> 赞同：65
> 
> 时间：2009-02-27T06:05:57.780
> 
> 标签：java, string, end-of-line

我有这样的字符串

```
"hello
java
book" 
```

我想`\r`从`\n`. `String(hello\r\njava\r\nbook)`我希望结果是`"hellojavabook"`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-02-27T06:13:06.607

带有replaceAll的正则表达式。

```
public class Main
{
    public static void main(final String[] argv) 
    {
        String str;

        str = "hello\r\njava\r\nbook";
        str = str.replaceAll("(\\r|\\n)", "");
        System.out.println(str);
    }
} 
```

如果您只想在它们成对时删除 \r\n（上面的代码删除了 \r 或 \n），请改为：

```
str = str.replaceAll("\\r\\n", ""); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-27T06:23:48.423

如果您想避免使用正则表达式，或者必须针对较早的 JVM，String.replace() 将执行以下操作：

```
str=str.replace("\r","").replace("\n",""); 
```

并删除一个 CRLF 对：

```
str=str.replace("\r\n",""); 
```

后者比构建一个正则表达式来做同样的事情更有效。但我认为前者作为正则表达式会更快，因为字符串只解析一次。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-11-12T14:11:38.933

```
public static void main(final String[] argv) 
{
    String str;

    str = "hello\r\n\tjava\r\nbook";
    str = str.replaceAll("(\\r|\\n|\\t)", "");
    System.out.println(str);
} 
```

在正则表达式中添加表格也会很有用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-27T06:09:50.500

给定一个字符串 str：

```
str = str.replaceAll("\\\\r","")
str = str.replaceAll("\\\\n","") 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-10-25T07:59:49.977

如果您知道 Windows、Mac 或 UNIX 中的行终止符，则可以直接传递行终止符，例如 \n。或者，您可以使用以下代码替换三个主要操作系统中的任何一个中的换行符。

```
str = str.replaceAll("\\r\\n|\\r|\\n", " "); 
```

上面的代码行将在 Mac、Windows 和 Linux 中用空格替换换行符。您也可以使用行分隔符。它适用于所有操作系统。下面是行分隔符的代码片段。

```
String lineSeparator=System.lineSeparator();
String newString=yourString.replace(lineSeparator, ""); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T06:10:21.077

您是否尝试过使用[replaceAll](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html#replaceAll(java.lang.String,%20java.lang.String))方法将任何出现的 \n 或 \r 替换为空字符串？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-09-20T09:28:15.107

```
static byte[] discardWhitespace(byte[] data) {
    byte groomedData[] = new byte[data.length];
    int bytesCopied = 0;

    for (int i = 0; i < data.length; i++) {
        switch (data[i]) {
            case (byte) '\n' :
            case (byte) '\r' :
                break;
            default:
                groomedData[bytesCopied++] = data[i];
        }
    }

    byte packedData[] = new byte[bytesCopied];

    System.arraycopy(groomedData, 0, packedData, 0, bytesCopied);

    return packedData;
} 
```

在 commons-codec 项目中找到的代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-01-04T07:22:07.780

你可以像下面这样`unescapeJava`使用`org.apache.commons.text.StringEscapeUtils`

```
str = "hello\r\njava\r\nbook";
StringEscapeUtils.unescapeJava(str); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-09T19:23:45.060

嘿，我们也可以使用这个正则表达式解决方案。

```
String chomp = StringUtils.normalizeSpace(sentence.replaceAll("[\\r\\n]"," ")); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-07-01T11:05:32.993

试试下面的代码。它对我有用。

```
str = str.replaceAll("\\r", "");
str = str.replaceAll("\\n", ""); 
```

* * *

## 回答 #11

> 赞同：-7
> 
> 时间：2012-08-23T05:39:17.670

你试过了吗

```
string.trim(); 
```

这是为了修剪字符串中所有前导和倾斜的空格。希望这可以帮助。

编辑：（我不够明确）

因此，当您使用 string.split() 时，您将有一个 string[] - 对于数组中的每个字符串，执行 string.trim() 然后附加它。

```
String[] tokens = yourString.split(" ");
StringBuffer buff = new StringBuffer();
for (String token : tokens)
{
  buff.append(token.trim());
} 
```

使用 stringBuffer/Builder 而不是追加到同一个字符串中。

# python - Python适合数学学生？

> ID：593685
> 
> 赞同：7
> 
> 时间：2009-02-27T06:10:16.147
> 
> 标签：python, math

我需要为数学系的学生举办一个半小时的编程研讨会。

我选择了 python 作为语言。

1.  我的演讲内容应该是什么？
2.  有哪些好的资源可用？
3.  数学学生编程的必要性是什么？
4.  编程知识将如何帮助他们？

谢谢 ！！！

注意：我知道[这](https://stackoverflow.com/questions/488502/best-language-to-program-some-math-free-fast-easy-cool-etc)是一篇文章，但它不能解决我的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T06:13:05.810

scipy的入门指南吗？

[http://www.scipy.org/Getting_Started](http://www.scipy.org/Getting_Started)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T07:22:18.610

圣人： http: [//www.sagemath.org/](http://www.sagemath.org/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T06:16:45.443

假设这些学生是编程新手（这对数学学生来说很可能），您需要向他们介绍编程的基本知识（什么是函数，什么是变量，它们与函数和变量有何不同在数学等）。

向他们展示一些示例程序，以了解对数学有帮助的东西：数值方法、矩阵乘法等。

只要有可能，让他们惊叹，这样他们就会对使用计算机进行自己的项目感到兴奋。 [一些 Python/数学资源](http://www.math.okstate.edu/~ullrich/PyPlug/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T03:43:01.707

我将通过以下方式提出使用 Python 作为免费和开源选项来替换/增加昂贵的软件包，如 Matlab、IDL 等：

*   scipy - fft 的，
*   ipython - “外壳”/调试器
*   matplotlib - 二维绘图
*   MayaVi - 3d 图形/可视化

[该视频](http://www.archive.org/details/Perez_Python_Workshop_2008_10_09c)可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T08:10:34.640

您将不得不决定要向他们展示什么。如果您想向他们展示如何使用计算机可以成为数学中有用的工具，请向他们展示圣人以及如何使用它执行数值方法来获得难题的答案。然后用它来操作一些代数公式。也许展示它如何能够不费吹灰之力地通过硬积分和导数。毕竟，他们的一些第一门微积分课程即将结束。

这些都没有说明为什么他们当然需要知道如何编程。这只是表明其他人的编程对他们使用有多么有用。虽然你在 sage 中确实拥有 python 的全部功能，但现实是奇怪的“for 循环”和一些“if 语句”实际上是大多数数学家大部分时间都会使用 sage 进行的所有编程（尽管有少数人会做得更多）。如果您想走这条路，我建议您尝试阅读其中一本实验数学书籍（[http://www.experimentalmath.info/](http://www.experimentalmath.info/)）。这些人（在许多其他有趣的结果中）提出了 BBP 数字：这是找到任意 pi 数字的方法。他们主要使用枫树和数学，但大部分工作都转化为鼠尾草。

我强烈建议您不要向他们展示如何自己实际实现数值方法。很少有数学家编写程序来解决数值问题。大多数只是将他们的程序插入到其他人的程序中。所以我不认为展示他们如何自己实现这些方法，只要他们知道如何编程，就会让任何人兴奋。

如果这是我，我想我可能会举办一个研讨会，为 cgsuite ( [http://cgsuite.sourceforge.net/](http://cgsuite.sourceforge.net/) ) 构建一个简单的游戏插件。我认识到这是 java 而不是 python，但它们对这种方法有很多好处。首先，年轻的数学家总是对组合博弈论感到兴奋。您从根本上向他们展示了如何使用数学在某些游戏中始终获胜。就好像你给了他们一种超能力。

其次，您正在程序中实现游戏规则。游戏规则是学习编程习惯的好方法，因为它们可以直接转化为编程概念。

最后，您将获得一个可以完美玩游戏的工具。就我而言，90 分钟对于一个研讨会来说是很长的时间。如果你能以一声巨响结束，比如与电脑玩 10 分钟的游戏，他们会兴奋地离开，​​而不是感到无聊和筋疲力尽。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T08:34:15.817

我建议在 Python 中解决 Project Euler 中的几种不同类型的问题，并讨论解决方案、如何以不同的方式完成它们以提高效率等，作为研讨会的一部分。Python 是一种非常优雅的解决数学问题的语言，应该是比大多数数学学生更容易理解的语言之一，所以我认为你在那里做了一个不错的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T06:20:02.300

我假设这是为新生准备的（只是因为大多数高级数学学生可能知道如何编程）？如果是这样，请做一些有趣且相关的事情。了解基础知识，但可能会引导他们了解游戏（主要面向数学）或基于 Python 的图形计算器的逻辑/基本框架。

但是，如果您想让他们真正成为极客，请向他们展示 Mathematica。我知道，这不是你选择的……但是当我是一名大二数学专业的学生并第一次看到你可以用它做什么时，我爱上了它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T06:21:47.803

Python 会运行良好，但 GNU Octave 可能会更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T07:54:09.377

我的演讲内容应该是什么？

> 使用 Python进行**函数式编程**的概念。**对NumPy**和**SciPy**等第三方模块的一些介绍。

有哪些好的资源可用？

> Hans Petter Langtangen，**用于计算科学的 Python 脚本**，Springer

数学学生编程的必要性是什么？

> **无**。通常数学学生在编程方面不会有问题，因为大多数编程语言都是为了解决数学问题而开发的。

编程知识将如何帮助他们？

> **与人类相比，**计算机较早被开发为科学家的工具，可帮助他们在很短的时间内有效地解决科学/数学问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-01T20:55:49.120

[http://www.sagemath.org](http://www.sagemath.org)

在我们的 wiki 中有一系列谈话，它们可能会对您有所帮助！[http://wiki.sagemath.org/Talks](http://wiki.sagemath.org/Talks)

另请注意，Sage 包含 NumPy、SciPy 和 SymPy。因此，关于这三个 python 库的所有信息都适用于 Sage。

# language-agnostic - 用于此特定场景的排序算法

> ID：593689
> 
> 赞同：0
> 
> 时间：2009-02-27T06:11:29.700
> 
> 标签：language-agnostic, sorting, performance

我有两个列表 - 我们称它们为*details*和*totals*。

*详细*的项目对于列表排序的每个键都有多个元素，如下所示：

KEY1
KEY1
KEY2
KEY2
KEY3
KEY3
KEY3
等

*总计*中的项目每个键只有一次，例如：

KEY1
KEY2
KEY3
等

两个列表都已按键排序。需要组合列表，以便新列表具有*details*元素，后跟来自*totals*的相应元素，如下所示：

KEY1（来自*详细信息*）
KEY1（来自*详细信息*）
KEY1（来自*总计*）等

在这种情况下，哪种排序算法会产生最佳性能？

（老实说，我只是要更改代码，以便在构建*详细信息*列表时创建和插入*总计*中的行，这更像是一个学术问题）

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T06:16:42.747

如果您正在考虑将这两个列表合并为一个，并且它们已经排序，那么您不应该诉诸。

一个简单的合并就可以了，如下所示。这是假设您的假设是正确的，并且没有“裸”的细节或总行（没有总计的细节或没有细节的总计）。如果有，您将需要额外的代码来处理它，但原理是相同的。

```
Get first detail-list
Get first total-list

While total-list not finished:
    If detail-list.key > total-list.key:
        Output total-list
        Get next total-list
        Next while
    Output detail-list
    Get next detail-list 
```

# mysql - 识别缺失的空间

> ID：593700
> 
> 赞同：5
> 
> 时间：2009-02-27T06:14:50.800
> 
> 标签：mysql, coldfusion, full-text-search

如何识别用户在输入搜索词时错过了空格？例如，如果用户输入“usbcable”，我想搜索“usb cable”。我正在 MySQL 中进行 REGEX 搜索以匹配完整的单词。

我有一个表格，其中包含搜索中使用的每个术语，因此我知道“usb”和“cable”是有效术语。有没有办法构造一个 WHERE 子句，它会给我所有与该术语匹配的部分字符串的行？

像这样的东西：

```
SELECT st.term 
FROM SearchTerms st
WHERE 'usbcable' LIKE '%' + st.term + '%' 
```

还是有其他想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T06:27:27.337

[文本分割](http://en.wikipedia.org/wiki/Text_segmentation)是[自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)的一部分，也是您在这个特定示例中寻找的内容。它用于搜索引擎和拼写检查器，因此您可能会对查看开源拼写检查器和搜索引擎的示例源代码感到幸运。

无论如何，拼写检查可能是要考虑的正确范例，因为在尝试将其撬开之前，您首先需要知道它是否是合法的单词。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T22:21:10.670

发表在评论中，但我认为提出答案很重要：

> 该查询不起作用吗？——西蒙·巴肯

其次是：

> 好吧，我应该在发布之前对其进行测试。该查询不起作用，但使用 CONCAT 可以，如下所示：WHERE 'usbcable' LIKE Con​​cat('%', st.term, '%')。我认为这是最简单、最相关（特定于我的网站）的方法。– arnie0674

对于这个应用程序来说，当然比文本分割要容易得多......

-亚当

# c# - C#如何获取当前页面的URL

> ID：593709
> 
> 赞同：700
> 
> 时间：2009-02-27T06:20:47.027
> 
> 标签：c#, asp.net

任何人都可以帮助我在 C# 中获取 ASP.NET 当前工作页面的 URL 吗？

* * *

## 回答 #1

> 赞同：954
> 
> 时间：2009-02-27T06:23:46.737

尝试这个 ：

```
string url = HttpContext.Current.Request.Url.AbsoluteUri;
// http://localhost:1302/TESTERS/Default6.aspx

string path = HttpContext.Current.Request.Url.AbsolutePath;
// /TESTERS/Default6.aspx

string host = HttpContext.Current.Request.Url.Host;
// localhost 
```

* * *

## 回答 #2

> 赞同：538
> 
> 时间：2013-05-22T13:46:54.300

您有时可能需要从 URL 获取不同的值。

下面的示例显示了提取 URL 不同部分的不同方法

**示例：（**示例网址）

`http://localhost:60527/WebSite1test/Default2.aspx?QueryString1=1&QueryString2=2`

**代码**

```
Response.Write("<br/>Host " + HttpContext.Current.Request.Url.Host);
Response.Write("<br/>Authority: " + HttpContext.Current.Request.Url.Authority);
Response.Write("<br/>Port: " + HttpContext.Current.Request.Url.Port);
Response.Write("<br/>AbsolutePath: " + HttpContext.Current.Request.Url.AbsolutePath);
Response.Write("<br/>ApplicationPath: " + HttpContext.Current.Request.ApplicationPath);
Response.Write("<br/>AbsoluteUri: " + HttpContext.Current.Request.Url.AbsoluteUri);
Response.Write("<br/>PathAndQuery: " + HttpContext.Current.Request.Url.PathAndQuery); 
```

**输出**

```
Host: localhost
Authority: localhost:60527
Port: 60527
AbsolutePath: /WebSite1test/Default2.aspx
ApplicationPath: /WebSite1test
AbsoluteUri: http://localhost:60527/WebSite1test/Default2.aspx?QueryString1=1&QueryString1=2
PathAndQuery: /WebSite1test/Default2.aspx?QueryString1=1&QueryString2=2 
```

您可以复制粘贴上面的示例代码并在具有不同 URL 的 asp.net 网络表单应用程序中运行它。

我还建议您阅读 ASP.Net Routing，以防您可能使用 ASP Routing，然后您就不需要使用带有查询字符串的传统 URL。

[http://msdn.microsoft.com/en-us/library/cc668201%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/cc668201%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2012-04-26T16:56:28.733

感谢 Canavar 的帖子，这就是我的解决方案。

如果你有这样的事情：

```
"http://localhost:1234/Default.aspx?un=asdf&somethingelse=fdsa" 
```

或像这样：

```
"https://www.something.com/index.html?a=123&b=4567" 
```

并且您只想要用户输入的部分然后这将起作用：

```
String strPathAndQuery = HttpContext.Current.Request.Url.PathAndQuery;
String strUrl = HttpContext.Current.Request.Url.AbsoluteUri.Replace(strPathAndQuery, "/"); 
```

这将导致这些：

```
"http://localhost:1234/"
"https://www.something.com/" 
```

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2009-02-27T06:27:52.860

如果您只想要 http:// 和第一个斜杠之间的部分

```
string url = Request.Url.Host; 
```

如果从此页面调用，将返回 stackoverflow.com

这是[完整的细分](http://msdn.microsoft.com/en-us/library/system.uri_properties.aspx)

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2013-05-28T04:42:37.873

request.rawurl 将给出当前页面的内容，它给出了您需要的确切路径

利用`HttpContext.Current.Request.RawUrl`

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-01-17T14:31:48.620

如果你想得到

```
localhost:2806 
```

从

```
http://localhost:2806/Pages/ 
```

然后使用：

```
HttpContext.Current.Request.Url.Authority 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-05-23T15:00:46.770

给需要 global.asax 文件中的路径/url 的人的提示；

如果您需要在**global.asax > Application_Start**中运行它并且您的应用程序池模式已**集成**，那么您将收到以下错误：

> **请求在 Application_Start 中的此上下文异常中不可用。**

在这种情况下，你需要使用这个：

> **System.Web.HttpRuntime.AppDomainAppVirtualPath**

希望能帮助别人..

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-08-05T11:13:16.653

搜索使我进入了此页面，但这并不是我想要的。在这里发帖以防其他人也在此页面上寻找我的身份。

如果您只有一个字符串值，有两种方法可以做到这一点。

.NET方式：

与@Canavar 相同，但您可以实例化一个新的 Uri 对象

```
String URL = "http://localhost:1302/TESTERS/Default6.aspx";
System.Uri uri = new System.Uri(URL); 
```

这意味着您可以使用相同的方法，例如

```
string url = uri.AbsoluteUri;
// http://localhost:1302/TESTERS/Default6.aspx

string host = uri.host
// localhost 
```

正则表达式方式：

[获取 URL 的一部分（正则表达式）](https://stackoverflow.com/questions/27745/getting-parts-of-a-url-regex)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-09-19T13:36:37.953

我想它足以返回绝对路径..

```
 Path.GetFileName( Request.Url.AbsolutePath ) 
```

使用 System.IO；

# sql - 一次插入记录

> ID：593714
> 
> 赞同：0
> 
> 时间：2009-02-27T06:23:30.437
> 
> 标签：sql, sql-server-2005, insert-update

我有 2 个表 TableA 和 TableB 如果记录不在 TableB 中，我想一次将所有记录从 TableA 插入到 TableB

请帮忙谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T06:49:50.387

这应该工作

```
INSERT INTO TableB
SELECT * FROM TableA
EXCEPT
SELECT * FROM TableB 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T06:44:35.597

假设它们共享相同的主键。

```
insert TableB
select A.* 
from TableA A 
left join TableB B ON A.pk = B.pk 
where B.pk is null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T06:53:55.713

三宝答案的替代形式。

```
INSERT TableB
SELECT *
FROM TableA A
WHERE NOT EXISTS (
    SELECT *
    FROM TableB B
    WHERE A.pk = B.pk ) 
```

# c - 如何使多个`fork()`-ed 进程使用共享内存进行通信？

> ID：593722
> 
> 赞同：3
> 
> 时间：2009-02-27T06:25:40.307
> 
> 标签：c, fork, shared-memory

我有一个有 5 个子进程的父进程。我想向每个子进程发送一个随机变量。每个孩子将平方变量并将其发送回父母，父母将把它们加在一起。

这甚至可能吗？我想不通...

编辑：此过程将使用共享内存。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T06:28:57.740

有很多方法可以做到这一点，都涉及某种形式的进程间通信。您选择哪一个将取决于许多因素，但其中一些是：

*   共享内存。
*   管道（`popen`等）。
*   插座。

一般来说，`popen`在产生孩子之前，我可能会在父母中进行多次交流；父母会知道所有五个，但每个孩子可以配置为只使用一个。

共享内存也是一种可能性，尽管您可能必须在每个孩子中有几个值以确保通信顺利进行：

*   一个值来存储变量和返回值。
*   存储状态的值（0 = 开始，1 = 变量为子准备就绪，2 = 变量再次为父准备就绪）。

在所有情况下，您都需要一种方法让孩子们只接受他们的价值观，而不是那些注定要给其他孩子的价值观。这可能就像向共享内存块添加一个值来存储孩子的 PID 一样简单。所有子节点都会扫描块中的每个元素，但只会处理状态为 1 且 PID 是其 PID 的元素。

例如：

*   Main 为五个孩子创建共享内存。每个元素都有状态、PID 和值。
*   Main 将所有状态设置为“开始”。
*   Main 启动五个孩子，他们都附加到共享内存。
*   主要存储他们所有的 PID。
*   所有孩子都开始扫描共享内存的 state = "ready for child" 和他们的 PID。
*   主要放入第一个元素（状态=“准备好孩子”，PID = pid1，值= 7）。
*   主要放入第二个元素（状态=“准备好孩子”，PID = pid5，值= 9）。
*   子 pid1 拾取第一个元素，将值更改为 49，将状态设置为“准备好为父”），返回监控。
*   子 pid5 拾取第二个元素，将值更改为 81，将状态设置为“为父级准备就绪”），返回监控。
*   Main 获取 pid5 的响应，将该状态设置回“start.
*   Main 获取 pid1 的响应，将该状态设置回“开始。

这给出了并行度的度量，每个子进程持续监控共享内存的工作，Main 将工作放在那里并定期接收结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T06:43:05.100

最讨厌的方法是使用`vfork()`并让不同的孩子在退出之前踩踏内存的不同部分；然后父级只是将修改后的内存位相加。

非常不推荐 - 但关于我遇到的唯一`vfork()`可能实际有用的情况。

只是为了娱乐（我的），我把它编码了：

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <time.h>
#include <sys/wait.h>

int main(void)
{
    int i;
    int array[5];
    int square[5];
    long sum = 0;

    srand(time(0));
    for (i = 0; i < 5; i++)
    {
        array[i] = rand();
        if (vfork() == 0)
        {
            square[i] = array[i] * array[i];
            execl("/bin/true", "/bin/true", (char *)0);
        }
        else
            wait(0);
    }

    for (i = 0; i < 5; i++)
    {
        printf("in: %d; square: %d\n", array[i], square[i]);
        sum += square[i];
    }
    printf("Sum: %d\n", sum);
    return(0);
} 
```

这行得通。`exit(0)`以前使用 ' ' 代替 ' ' 的试用版`execl()`不起作用；方阵全为零。示例输出（Solaris 10 上的 32 位编译，SPARC）：

```
in: 22209; square: 493239681
in: 27082; square: 733434724
in: 2558; square: 6543364
in: 17465; square: 305026225
in: 6610; square: 43692100
Sum: 1581936094 
```

有时，总和会溢出——在处理上还有很大的改进空间。

' ' 的 Solaris 手册页`vfork()`说：

> 与 fork() 函数不同，子进程借用父进程的内存和控制线程，直到调用 execve() 或退出（异常或调用 _exit() （参见 exit(2)）。任何修改在此期间对子进程内存的任何部分进行的操作都会在从 vfork() 返回时反映在父进程中。父进程在子进程使用其资源时暂停。

这可能意味着 ' `wait()`' 在我的代码中是不必要的。（然而，试图简化代码似乎使它的行为不确定。它`i`不会过早改变是相当重要的；`wait()`确实确保同步性。使用`_exit()`而不是似乎也破坏了事情。如果你重视你的理智，请`execl()`不要使用-`vfork()`或者如果你想为你的家庭作业打分。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T07:57:39.180

[诸如反线程之类的](http://ccan.ozlabs.org/)东西可能会让您更容易，请参阅示例（特别是 ns 查找程序）。

# linux - 使用命令行在进程启动后重定向STDERR / STDOUT？

> ID：593724
> 
> 赞同：137
> 
> 时间：2009-02-27T06:26:24.827
> 
> 标签：linux, bash, shell

在 shell 中你可以做重定向，`>` `<`等等，但是在一个程序启动之后呢？

这就是我问这个问题的方式，在我的终端后台运行的程序不断输出烦人的文本。这是一个重要的过程，所以我必须打开另一个 shell 以避免文本。我希望能够`>/dev/null`或其他一些重定向，以便我可以继续在同一个 shell 中工作。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-02-27T06:48:29.813

如果没有关闭并重新打开您的 tty（即注销并重新打开，这也可能会终止进程中的一些后台进程），您只有一个选择：

*   使用 gdb 附加到有问题的进程，然后运行：
    *   p dup2(open("/dev/null", 0), 1)
    *   p dup2(open("/dev/null", 0), 2)
    *   分离
    *   辞职

例如：

```
$ tail -f /var/log/lastlog &
[1] 5636

$ ls -l /proc/5636/fd
total 0
lrwx------ 1 myuser myuser 64 Feb 27 07:36 0 -> /dev/pts/0
lrwx------ 1 myuser myuser 64 Feb 27 07:36 1 -> /dev/pts/0
lrwx------ 1 myuser myuser 64 Feb 27 07:36 2 -> /dev/pts/0
lr-x------ 1 myuser myuser 64 Feb 27 07:36 3 -> /var/log/lastlog

$ gdb -p 5636
GNU gdb 6.8-debian
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Attaching to process 5636
Reading symbols from /usr/bin/tail...(no debugging symbols found)...done.
Reading symbols from /lib/librt.so.1...(no debugging symbols found)...done.
Loaded symbols for /lib/librt.so.1
Reading symbols from /lib/libc.so.6...(no debugging symbols found)...done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/libpthread.so.0...(no debugging symbols found)...done.
[Thread debugging using libthread_db enabled]
[New Thread 0x7f3c8f5a66e0 (LWP 5636)]
Loaded symbols for /lib/libpthread.so.0
Reading symbols from /lib/ld-linux-x86-64.so.2...(no debugging symbols found)...done.
Loaded symbols for /lib64/ld-linux-x86-64.so.2

(no debugging symbols found)
0x00007f3c8eec7b50 in nanosleep () from /lib/libc.so.6

(gdb) p dup2(open("/dev/null",0),1)
[Switching to Thread 0x7f3c8f5a66e0 (LWP 5636)]
$1 = 1

(gdb) p dup2(open("/dev/null",0),2)
$2 = 2

(gdb) detach
Detaching from program: /usr/bin/tail, process 5636

(gdb) quit

$ ls -l /proc/5636/fd
total 0
lrwx------ 1 myuser myuser 64 Feb 27 07:36 0 -> /dev/pts/0
lrwx------ 1 myuser myuser 64 Feb 27 07:36 1 -> /dev/null
lrwx------ 1 myuser myuser 64 Feb 27 07:36 2 -> /dev/null
lr-x------ 1 myuser myuser 64 Feb 27 07:36 3 -> /var/log/lastlog
lr-x------ 1 myuser myuser 64 Feb 27 07:36 4 -> /dev/null
lr-x------ 1 myuser myuser 64 Feb 27 07:36 5 -> /dev/null 
```

您还可以考虑：

*   使用`screen`；screen 提供了几个虚拟 TTY，您可以在无需打开新的 SSH/telnet/etc、会话的情况下进行切换
*   使用`nohup`；这使您可以关闭并重新打开会话，而不会丢失...进程中的任何后台进程。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-09-14T11:39:49.567

这将做：

```
strace -ewrite -p $PID 
```

它不是那么干净（显示如下行：）`write(#,<text you want to see>)`，但有效！

* * *

你也可能不喜欢参数被缩写的事实。要控制它，请使用`-s`设置显示字符串的最大长度的参数。

它捕获所有流，因此您可能希望以某种方式对其进行过滤：

```
strace -ewrite -p $PID 2>&1 | grep "write(1" 
```

仅显示描述符 1 调用。`2>&1`是将 STDERR 重定向到 STDOUT，因为`strace`默认情况下写入 STDERR。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-09-30T20:31:55.653

将正在运行的进程的输出重定向到另一个终端、文件或屏幕：

```
tty
ls -l /proc/20818/fd
gdb -p 20818 
```

内部*gdb*：

```
p close(1)
p open("/dev/pts/4", 1)
p close(2)
p open("/tmp/myerrlog", 1)
q 
```

*从bash*终端分离正在运行的进程并使其保持活动状态：

```
[Ctrl+z]
bg %1 && disown %1
[Ctrl+d] 
```

解释：

20818 - 只是一个运行进程的示例 pid
p - gdb 命令的打印结果
close(1) - 关闭标准输出
/dev/pts/4 - 终端写入
close(2) - 关闭错误输出
/tmp/myerrlog - 文件到写入
q - 退出 gdb
bg %1 - 在后台运行停止的作业 1
disown %1 - 从终端分离作业 1

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2010-11-01T02:55:14.877

抄袭 vladr（和其他人）的出色研究：

在同一目录中创建以下两个文件，在您的路径中，例如 $HOME/bin：

silent.gdb，包含（来自 vladr 的回答）：

```
 p dup2(open("/dev/null",0),1)
p dup2(open("/dev/null",0),2)
detach
quit 
```

和沉默，包含：

```
 #!/bin/sh
if [ "$0" -a "$1" ]; then
 gdb -p $1 -x $0.gdb
else
 echo Must specify PID of process to silence >&2
fi 
```

```
 chmod +x ~/bin/silence  # make the script executable 
```

现在，例如，下次您忘记重定向 firefox 时，您的终端开始被不可避免的“（firefox-bin：5117）：Gdk-WARNING **：XID 冲突，前方有问题”消息弄乱：

```
 ps  # look for process xulrunner-stub (in this case we saw the PID in the error above)
silence 5117  # run the script, using PID we found 
```

如果您不想看到它，也可以将 gdb 的输出重定向到 /dev/null。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T07:00:53.607

不是对您问题的直接回答，但这是我在过去几天里发现的一种有用的技术：使用“屏幕”运行初始命令，然后分离。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-02-19T14:46:26.027

**`logrotate`**这是基于先前答案的 bash 脚本部分，它在执行打开的进程期间重定向日志文件，它在进程中用作 postscript

```
#!/bin/bash

pid=$(cat /var/run/app/app.pid)
logFile="/var/log/app.log"

reloadLog()
{
    if [ "$pid" = "" ]; then
        echo "invalid PID"
    else
        gdb -p $pid >/dev/null 2>&1 <<LOADLOG
set scheduler-locking on
p close(1)
p open("$logFile", 1)
p close(2)
p open("$logFile", 1)
q
LOADLOG
        LOG_FILE=$(ls /proc/${pid}/fd -l | fgrep " 1 -> " | awk '{print $11}')
        echo "log file set to $LOG_FILE"
    fi
}

reloadLog 
```

**更新**：对于 gdb v7.11 及更高版本，或[此处](https://sourceware.org/gdb/current/onlinedocs/gdb/All_002dStop-Mode.html)`set scheduler-locking on`提到的其他任何选项是必需的，因为附加 gdb 后，它不会停止所有正在运行的线程，并且由于文件使用，您可能无法关闭/打开日志文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-11-29T01:53:30.957

> **Dupx**是一个简单的 *nix 实用程序，用于重定向已运行进程的标准输出/输入/错误。

[https://www.isi.edu/~yuri/dupx/](https://www.isi.edu/~yuri/dupx/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-11T08:45:50.820

您可以使用重定向（[https://github.com/jerome-pouiller/reredirect/](https://github.com/jerome-pouiller/reredirect/)）。

类型

```
reredirect -m FILE PID 
```

并且输出（标准和错误）将写入 FILE。

reredirect README 还解释了如何恢复进程的原始状态，如何重定向到另一个命令或仅重定向 stdout 或 stderr。

`reredirect`还提供一个名为`relink`允许重定向到当前终端的脚本：

```
relink PID
relink PID | grep usefull_content 
```

（重定向似乎与另一个答案中描述的 Dupx 具有相同的功能，但它不依赖于 Gdb）。

# c# - 为什么 C# 中的“int[] 是 uint[] == true”

> ID：593730
> 
> 赞同：40
> 
> 时间：2009-02-27T06:27:55.980
> 
> 标签：c#, arrays, casting, unsigned

有人可以澄清一下 C#`is`关键字吗？特别是这两个问题：

Q1) 第 5 行；为什么这会返回 true？

Q2) 第 7 行；为什么没有演员表异常？

```
public void Test()
{
    object intArray = new int[] { -100, -200 };            

    if (intArray is uint[]) //why does this return true?
    {
        uint[] uintArray = (uint[])intArray; //why no class cast exception?

        for (int x = 0; x < uintArray.Length; x++)
        {
            Console.Out.WriteLine(uintArray[x]);
        }
    }
} 
```

MSDN 的描述没有说明情况。它声明`is`如果满足这些条件中的任何一个，它将返回 true。（http://msdn.microsoft.com/en-us/library/scekt9xw(VS.71).aspx>MDSN 文章）

```
表达式不为空。
表达式可以转换为类型。

```

我不相信您可以将 int[] 有效地转换为 uint[]。因为：

A）此代码无法编译：

```
int[] signed = new int[] { -100 };
uint[] unsigned = (uint[])signed; 
```

B）在调试器中进行强制转换会产生错误：

```
(uint[])signed
"Cannot convert type 'int[]' to 'uint[]'" 
```

果然，如果第 3 行是 int[] 而不是 object 那么它永远不会编译。这让我想到了与 Q2 相关的最后一个问题。

Q3) 为什么 C# 在调试器和编译器中会引发转换/转换错误，但在运行时不会？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-27T07:05:00.540

C# 和 CLR 的转换规则有些不同。

您不能*直接*在 C#之间`int[]`进行转换，因为该*语言*不相信任何转换可用。但是，如果您通过结果取决于 CLI。来自 CLI 规范第 8.7 节（我希望 - 我引用了我不久前[与 Eric Lippert 就该主题进行的电子邮件交流）：](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/2d21bf036a23918e#5a5c351206ebd999)`uint[]`*`object`*

 *> 有符号和无符号整数基元类型可以相互分配；例如， int8 := uint8 是有效的。为此，bool 应被认为与兼容，`uint8`反之亦然，这使得`bool := uint8`有效，反之亦然。对于大小相同的有符号和无符号整数原始类型的数组也是如此；例如，`int32[] := uint32[]`有效。

（我还没有检查过，但我认为这种引用类型转换是有效的也是使`is`return 为 true 的原因。）

不幸的是，语言和底层执行引擎之间存在脱节，但我怀疑从长远来看，这几乎是不可避免的。还有一些类似的案例，但好消息是它们似乎很少造成重大伤害。

编辑：当 Marc 删除了他的答案时，我已经链接到 Eric 的完整邮件，该邮件已发布到 C# 新闻组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T07:12:49.520

现在这很有趣。我在 ECMA-335 标准中发现了这一点。4.3 演员表。注意：

*   数组继承自 System.Array。

*   如果 Foo 可以转换为 Bar，则 Foo[] 可以转换为 Bar[]。

*   出于上述注释 2 的目的，枚举被视为其基础类型：因此，如果 E1 和 E2 共享基础类型，则 E1[] 可以强制转换为 E2[]。

您可以将 int 转换为 uint，但它的行为方式非常奇怪。Visual Studio 无法识别任何这些，即使是手表，当附加调试器时，只会显示一个问号“？”。

**你可能想看看[这个](http://channel9.msdn.com/shows/Going+Deep/Expert-to-Expert-Anders-Hejlsberg-The-Future-of-C/)，快进大约 10 分钟，然后听 Anders 解释协变数组的实现。我认为这是这里根本的根本问题。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T06:48:04.790

建议：

将 intArray 声明为“int [] intArray”而不是“object intArray”将允许编译器获取无效的 C# 强制转换。除非您绝对必须使用对象，否则我会采用这种方法。

关于 Q2、Q3：

在运行时，您是否尝试过将演员表包装在已[检查](http://msdn.microsoft.com/en-us/library/74b4xzyw.aspx)的块中？

来自 MSDN 上的这篇文章：

> 默认情况下，如果表达式生成的值超出目标类型的范围，则仅包含常量值的表达式会导致编译器错误。如果表达式包含一个或多个非常量值，则编译器不会检测到溢出。
> 
> ...
> 
> 默认情况下，这些非常量表达式在运行时也不会检查溢出，并且它们不会引发溢出异常。前面的示例将 -2,147,483,639 显示为两个正整数的和。
> 
> 溢出检查可以通过编译器选项、环境配置或使用 checked 关键字来启用。

正如它所说，您可以通过编译器设置或环境配置在全局范围内强制执行溢出检查。

在您的情况下，这可能是可取的，因为它会导致抛出运行时错误，这将确保可能无效的无符号数到有符号数溢出不会静默发生。

[更新] 在测试了这段代码之后，我发现使用 object 类型的声明而不是 int [] 似乎绕过了标准的 C# 转换语法，无论是否启用了检查。

正如 JS 所说，当你使用对象时，你会受到 CLI 规则的约束，这些显然允许这种情况发生。

关于 Q1：

这与上述有关。简而言之，因为涉及的演员阵容不会引发异常（基于当前的溢出设置）。这是否是一个好主意是另一个问题。

[来自 MSDN](http://msdn.microsoft.com/en-us/library/scekt9xw.aspx)：

> 如果提供的表达式不为空，则“is”表达式的计算结果为 true，并且提供的对象可以转换为提供的类型而不会引发异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T06:54:57.660

我猜测与 .NET 1 的向后兼容性：我对细节仍然有些模糊，但我相信所有数组的 CLR 类型都只是 System.Array，具有额外的 Type 属性来查找元素类型。'is' 可能只是在 CLR v1 中没有考虑到这一点，现在必须保持这一点。

在这种情况下它不起作用`(uint[])(new int[]{})`可能是由于 C# 编译器（而不是 CLR 运行时）能够进行更严格的类型检查。

此外，数组通常只是类型不安全的：

```
Animal[] tigers = new Tiger[10];
tigers[3] = new Elephant(); // ArrayTypeMismatchException 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T07:08:57.283

好的，

我试图对此进行尝试。

首先，文档说，“检查一个对象是否与给定类型兼容。”，它还说如果左边的类型是“可转换的”（你可以毫无例外地转换）到右边的类型，并且表达式的计算结果为非空，“is”关键字的计算结果为`true`.

向 Jon Skeet 寻求其他答案。他说得比我更有说服力。他是对的，如果转换可用，它将接受您的语法，您可以随后编写自己的语法，但在这种情况下似乎有点矫枉过正。

参考： http: [//msdn.microsoft.com/en-us/library/scekt9xw (VS.80).aspx](http://msdn.microsoft.com/en-us/library/scekt9xw(VS.80).aspx)

# javascript - 如何创建一个在点击时在两个值之间翻转的元素？

> ID：593734
> 
> 赞同：1
> 
> 时间：2009-02-27T06:30:48.810
> 
> 标签：javascript, html

给定两个像这样的跨度：

```
<span>Click for info</span>
<span style="display: none">Here is a big long string of info blah blah</span> 
```

...我希望每个都附加一个 onclick 功能，以便访问者看到“点击获取信息”，然后当他们点击它时，第一个跨度被隐藏，第二个被取消隐藏。当然，当第二个被点击时，事情又回到了原来的样子。

我没有轻松生成唯一 ID 的方法，因此我宁愿避免使用 getElementByID() 路线，而且我宁愿不使用 jQuery 或任何其他重量级依赖项。有没有一种优雅的方式来做到这一点？

到目前为止，我最好的想法是编写一个 toggleAllSiblings() 函数，为该对中的两个元素设置 onclick 到该函数，然后将每个对包装在一个父元素中。

没有父节点可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T06:56:54.677

如果您真的想不使用 id，可以执行以下操作：

```
<script>
function togglePrevious(sender) {
    sender.previousSibling.style.display = "inline";
    sender.style.display = "none";
}
function toggleNext(sender) {
    sender.nextSibling.style.display = "inline";
    sender.style.display = "none";
}
</script>
<span onclick="javascript:toggleNext(this);">Click for info</span>
<span onclick="javascript:togglePrevious(this);" style="display:none">Info blablabla</span> 
```

如果您使用跨度，请不要真正使用“内联”而不是“块”，因为它们是内联元素。将它们的显示样式设置为阻止将强制它们成为 div。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T13:39:13.930

另一个版本，一个渐进式增强 - 将在 JavaScript 关闭时正确显示完整信息。

```
<span class="details">Here is a big long string of info blah blah</span>

<script type="text/javascript">
    // Open/close span behaviour
    //
    function infoToggle(span) {
        var ersatz= document.createElement('span');
        ersatz.appendChild(document.createTextNode('Click for info...'));
        span.parentNode.insertBefore(ersatz, span);
        span.style.display= 'none';

        span.onclick= function() {
            ersatz.style.display= 'inline';
            span.style.display= 'none';
        };
        ersatz.onclick= function() {
            ersatz.style.display= 'none';
            span.style.display= 'inline';
        };
    }

    // Bind to all spans with class="details"
    //
    var spans= document.getElementsByTagName('span');
    for (var i= spans.length; i-->0;)
        if (spans[i].className=='details')
            infoToggle(spans[i]);
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T06:33:11.690

我不确定实现，但逻辑看起来类似于

*   获取所有跨度
*   隐藏下面的相邻跨度（默认情况下让非 JS 用户可见）
*   将偶数处理程序附加到第一个跨度
*   事件处理函数 - 如果下一个跨度不可见则显示下一个跨度，否则隐藏它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T06:36:02.137

这是我的头顶和未经测试的。它至少应该让你继续前进。

```
<script>
function toggle(id)
{
var display = document.getElementById(id).style.display;
if ( display == "block" )
document.getElementById(id).style.display = "none";
else
document.getElementById(id).style.display = "block";
}
</script>

<span onclick="javascript: toggle('span_to_toggle');" id="clickable_span">click here</span>

<span id='span_to_toggle' style="diplay:none">foooooooooooooooooooooo</span> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T06:45:50.787

@Jason 的快速返工：

```
<script>
function toggle(targetId, sender)
{
var show = document.getElementById(targetId);

show.style.display = "block";
sender.style.display = "none";
}
</script>

<span onclick="javascript: toggle('more', this);" id="less">click         here</span>

<span style="display:none;" id="more" onclick="javascript: toggle('less', this);" >foooooooooooooooooooooo</span> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-28T22:30:04.893

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-27T06:42:00.110

# sql - SQL 在整个 MS SQL 2000 数据库中搜索一个值

> ID：593746
> 
> 赞同：1
> 
> 时间：2009-02-27T06:37:23.990
> 
> 标签：sql

我想在整个 MS SQL 2000 数据库中搜索一个值。这只是为了帮助发展。在考虑这个问题时请记住这一点。

这将获得所有表名和我正在寻找的数据类型的列：

```
SELECT Columns.COLUMN_NAME, tables.TABLE_NAME
FROM INFORMATION_SCHEMA.Columns as Columns 
JOIN INFORMATION_SCHEMA.TABLES as tables 
On Columns.TABLE_NAME = tables.TABLE_NAME
WHERE Columns.DATA_TYPE = 'INT' 
```

我在想这样的事情：

```
-- Vars
DECLARE @COUNTER INT
DECLARE @TOTAL INT
DECLARE @TABLE CHAR(128)
DECLARE @COLUMN CHAR(128)
DECLARE @COLUMNTYPE CHAR(128)
DECLARE @COLUMNVALUE INT

-- What we are looking for
SET @COLUMNTYPE = 'INT'
SET @COLUMNVALUE = 3
SET @COUNTER = 0

-- Find out how many possible columns exist
SELECT @TOTAL = COUNT(*)  
FROM INFORMATION_SCHEMA.Columns as Columns 
JOIN INFORMATION_SCHEMA.TABLES as tables 
On Columns.TABLE_NAME = tables.TABLE_NAME
WHERE Columns.DATA_TYPE = @COLUMNTYPE
PRINT CAST(@TOTAL AS CHAR) + 'possible columns'
WHILE @COUNTER < @TOTAL
BEGIN
    SET @COUNTER = @COUNTER +1
    -- ADD MAGIC HERE
END 
```

有任何想法吗？

**更新**我最近发现这个[工具](http://www.ssmstoolspack.com/)效果很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T07:00:07.617

既然它只是开发者（并且可能不必非常优雅），那么使用 TSQL 生成一堆 TSQL 然后复制回查询窗口并执行如何呢？

```
SELECT 'SELECT * FROM [' + tables.TABLE_NAME + '] WHERE ['
       + Columns.Column_Name + '] = ' + CONVERT(varchar(50),@COLUMNVALUE)
FROM INFORMATION_SCHEMA.Columns as Columns
INNER JOIN INFORMATION_SCHEMA.TABLES as tables 
    On Columns.TABLE_NAME = tables.TABLE_NAME
WHERE Columns.DATA_TYPE = @COLUMNTYPE 
```

它不会很漂亮，但它应该可以工作......另一种方法可能是将类似上面的内容插入到表变量中，然后使用`EXEC (@Sql)`. 但出于开发目的，它可能不值得......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T15:10:06.857

我发现这个脚本很有帮助……但正如 Marc 所说，这并不值得。自从我六个月前写它以来，我只用过几次。

它只是真正派上用场，因为我们的开发环境中有几个表在您查询它们时会导致绑定错误，而我总是忘记哪些表。

```
BEGIN TRAN

declare @search nvarchar(100)
set @search = 'string to search for'

-- search whole database for text
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

IF nullif(object_id('tempdb..#tmpSearch'), 0) IS NOT NULL DROP TABLE #tmpSearch
CREATE TABLE #tmpSearch (
    ListIndex int identity(1,1),
    CustomSQL nvarchar(2000)
)
Print 'Getting tables...'
INSERT #tmpSearch (CustomSQL)
select 'IF EXISTS (select * FROM [' + TABLE_NAME + '] WHERE [' + COLUMN_NAME + '] LIKE ''%' + @search + '%'') BEGIN PRINT ''Table ' + TABLE_NAME + ', Column ' + COLUMN_NAME + ''';select * FROM [' + TABLE_NAME + '] WHERE [' + COLUMN_NAME + '] LIKE ''%' + @search + '%'' END'  FROM information_schema.columns
where DATA_TYPE IN ('ntext', 'nvarchar', 'uniqueidentifier', 'char', 'varchar', 'text')
and TABLE_NAME NOT IN ('table_you_dont_want_to_look_in', 'and_another_one') 

Print 'Searching...

'
declare @index int
declare @customsql nvarchar(2000)
WHILE EXISTS (SELECT * FROM #tmpSearch)
BEGIN
    SELECT @index = min(ListIndex) FROM #tmpSearch

    SELECT @customSQL = CustomSQL FROM #tmpSearch WHERE ListIndex = @index

    IF @customSql IS NOT NULL
        EXECUTE (@customSql)

    SET NOCOUNT ON
    DELETE #tmpSearch WHERE ListIndex = @index
    SET NOCOUNT OFF
END

print 'the end.'
ROLLBACK 
```

# php - 如何在不使用 .htaccess 的情况下强制 apache 请求使用 CGI

> ID：593749
> 
> 赞同：0
> 
> 时间：2009-02-27T06:41:46.367
> 
> 标签：php, .htaccess, cgi

我学校的内部网络服务器仍在运行 PHP v4。*.* （不完全确定）。我继续在运行 5.2.5 的本地计算机上编写所有实验和作业。现在，我的代码都不能在学校机器上运行，因为功能根本不存在。

我可以访问大量编译器，并下载了 PHP v5.2.9 源代码，并将编译它以用作 CGI。

我的问题？学校已为我们的帐户禁用了 .htaccess 文件，因此我无法神奇地重定向所有请求以通过我全新的 v5.2.9 安装。

有没有人有任何想法、建议、黑客或解决方法来让所有请求转到我的 cgi 版本而不是 mod_php 版本？有什么办法可以通过 301 重定向或其他方式做到这一点？

万分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T06:46:24.063

您可以使用... PHP4 进行重定向。使用[标题](http://fr3.php.net/manual/en/function.header.php)功能。[或者您可以使用passthru](http://fr3.php.net/manual/en/function.passthru.php)从 PHP4 脚本执行您的 CGI 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T06:49:41.480

查看您的 Web 根目录中是否有 /cgi-bin 目录。即使它不存在，请尝试创建它并将您的脚本放在那里。默认情况下，许多 Web 服务器会假定该目录中的文件是脚本。

此外，您将需要尝试：

1.  使用 .cgi 扩展名重命名脚本
2.  在顶部放置一条“shebang line”以指示要使用的解释器。例如：

#!/path/to/php5

请注意，它必须是没有空格的第一行。

# tsql - T-SQL 中的序列生成器

> ID：593755
> 
> 赞同：2
> 
> 时间：2009-02-27T06:44:13.910
> 
> 标签：tsql, sequence

我们有一个使用标准模式填充代理键的 Oracle 应用程序。我们有一系列外部行（具有代理键的特定值）和其他具有内部值的行。我们使用以下 Oracle 触发器片段来确定如何处理插入时的代理键：

```
IF :NEW.SurrogateKey IS NULL THEN

 SELECT SurrogateKey_SEQ.NEXTVAL INTO :NEW.SurrogateKey FROM DUAL;

END IF; 
```

如果提供的代理键为空，则从指定的序列中获取一个值，否则将提供的代理键传递给该行。

我似乎找不到一个简单的方法来做到这一点是 T-SQL。有各种各样的方法，但没有一种方法像 Oracle 和其他符合 SQL-92 的数据库那样使用序列生成器的概念。

有人知道在 SQL Server T-SQL 中执行此操作的一种非常有效的方法吗？顺便说一句，如果有帮助的话，我们正在使用 SQL Server 2008。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T06:48:06.087

您可能想查看 IDENTITY。这为您提供了一个列，当您插入该行时将确定该列的值。

这可能意味着您必须插入行，然后使用 SCOPE_IDENTITY() 确定值。

这里还有一篇关于在 SQL Server 中模拟 Oracle 序列的文章：[http ://www.sqlmag.com/Articles/ArticleID/46900/46900.html?Ad=1](http://www.sqlmag.com/Articles/ArticleID/46900/46900.html?Ad=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T06:56:26.910

身份是一种方法，尽管它会在每个表级别生成唯一标识符。

另一种方法是使用唯一标识符，特别是使用 NewSequantialID() 确保生成的 id 总是大于最后一个。这种方法的问题是您不再处理整数。

模拟 oracle 方法最接近的方法是拥有一个带有计数器字段的单独表，然后编写一个用户定义的函数来查询该字段，将其递增并返回值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-25T22:47:23.760

这是一种使用表格来存储您的最后一个序列号的方法。存储过程非常简单，里面的大部分东西都是因为我很懒，如果我忘记了什么不喜欢惊喜，所以......这里是：

----- 创建序列值表。

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[SequenceTbl]
(
  [CurrentValue] [bigint]
) ON [PRIMARY]

GO 
```

* * *

-----------------创建存储过程

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE procedure [dbo].[sp_NextInSequence](@SkipCount BigInt = 1)
AS

BEGIN

  BEGIN TRANSACTION

    DECLARE @NextInSequence BigInt;

    IF NOT EXISTS
    (
      SELECT
        CurrentValue
      FROM
        SequenceTbl
    )

    INSERT INTO SequenceTbl (CurrentValue) VALUES (0);

    SELECT TOP 1
      @NextInSequence = ISNULL(CurrentValue, 0) + 1
    FROM
      SequenceTbl WITH (HoldLock);

    UPDATE SequenceTbl WITH (UPDLOCK)
      SET CurrentValue = @NextInSequence + (@SkipCount - 1);

  COMMIT TRANSACTION

  RETURN @NextInSequence
END;
GO 
```

* * *

--------使用 Sql Manager 中的存储过程来检索测试值。

```
declare @NextInSequence BigInt

exec @NextInSequence = sp_NextInSequence;

--exec @NextInSequence = sp_NextInSequence <skipcount>;

select NextInSequence = @NextInSequence; 
```

-----显示当前表值。

```
select * from SequenceTbl; 
```

精明的人会注意到存储过程有一个参数（可选）。这是为了允许调用者在调用者有多个需要唯一 id 的记录的情况下保留一个 ID 块 - 使用 SkipCount，调用者只需调用一次即可，但需要许多 ID。如果您记得在创建表时插入一条记录，则可以删除整个“IF EXISTS...INSERT INTO...”块。如果您还记得使用值插入该记录（您的种子值 - 一个永远不会用作 ID 的数字），您还可以删除选择的 ISNULL(...) 部分并仅使用 CurrentValue + 1。现在，在任何人发表评论之前，请注意我是软件工程师，*而不是*dba！所以，任何*建设性的*欢迎批评使用“Top 1”、“With (HoldLock)”和“With (UPDLock)”。我不知道这将如何扩展，但到目前为止这对我来说还可以......

# windows - 有什么方法可以限制进程的 CPU/内存？

> ID：593760
> 
> 赞同：14
> 
> 时间：2009-02-27T06:46:36.980
> 
> 标签：windows, performance, testing, cpu-usage

问题：我有一台开发机器（读取：快速，大量内存），但用户有一台用户机器（读取：慢，内存不多）。

[我可以使用 Fiddler ( http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/) )模拟慢速网络我可以使用 Process Explorer ( [http://technet.microsoft.com/en](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx) ) 查看 CPU 在一段时间内如何用于进程[-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)）。

有什么方法可以限制一个进程可以拥有的 CPU 数量，或者一个进程可以拥有的内存量，以便更有效地模拟用户机器？（例如为了隔离性能问题）

我想我可以使用虚拟机，但我正在寻找更轻的东西。

我使用的是 Windows XP，但欢迎任何 Windows 机器的解决方案。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T06:53:39.740

过去，平台 SDK 带有用于执行此操作的压力工具（`STRESS.EXE`在`CPUSTRESS.EXE`SDK 中），但它们可能仍然存在（请检查您的平台 SDK 和/或 Visual Studio 安装中的这两个文件——不幸的是我正在输入的机器上既没有安装 PSDK 也没有安装 VS。）

其他工具：

*   **内存**：性能和可靠性（例如处理失败的内存分配）：可以使用[EatMem](http://msdn.microsoft.com/en-us/magazine/cc163613.aspx)
*   **CPU**：性能和可靠性（例如竞争条件）：可以使用[CPU Burn](http://users.bigpond.net.au/CPUburn/)、[Prime95](http://www.mersenne.org/freesoft/)等
*   **句柄**（GDI，用户）：可靠性（例如处理失败的 GDI 资源分配）：？？？可能必须自己编写，但 GDI 句柄用完（有缺陷的 GTK 应用程序通常会将它们全部吃掉，直到系统上的所有其他应用程序开始像苍蝇一样死掉）是对任何 Windows 应用程序的真正考验
*   **磁盘**：性能和可靠性（例如处理磁盘已满）：[DiskFiller](http://askywhale.com/diskfiller/)等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T08:18:01.127

[AppVerifier](http://technet.microsoft.com/en-us/library/bb457063.aspx)具有低资源模拟功能。

您也可以尝试将进程的优先级设置为非常低。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T06:54:21.610

您可以运行[MemAlloc](http://www.soft.tahionic.com/download-memalloc/download.html)来消耗 RAM，一次可能需要几个副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T06:58:55.717

我发现了一个相关的问题：

[设置 Windows 进程（或用户）内存限制](https://stackoverflow.com/questions/192876/set-windows-process-or-user-memory-limit)

该问题的公认答案有一个指向 Windows API 的链接`SetProcessWorkingSetSize`，因此它不完全是一个可以限制进程可以使用的内存量的工具。

在更改进程可以使用的 CPU 资源量方面，如果您不介意每核资源限制的粒度，任务管理器可以更改进程的处理器亲和性。

在任务管理器中，右键单击一个进程并选择“Set Affinity...”，然后选择该进程可以分配到的处理器内核。

如果开发机器有很多核心，而用户机器只有一个，那么与其让进程在所有可用的核心上运行，不如将进程的处理器亲和性设置为只有一个核心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T11:19:33.640

它与 SetProcessWorkingSetSize 无关

只需使用内部 Win32 内核 API 来限制 CPU 使用率

# java - Swing GUI：当 JTable 变大时滚动不更新

> ID：593765
> 
> 赞同：0
> 
> 时间：2009-02-27T06:49:13.383
> 
> 标签：java, swing, jtable, jscrollpane

我有一个 Java Swing GUI，但`JTable`在`JScrollPane`. 由于某种原因，在程序执行期间增加表格模型的行时，`JScrollPane`不会更新 - 也就是说，如果增加行以使表格的高度超过滚动视图的高度，则滚动窗格未按预期更新。（新行按预期显示在屏幕上）。如果调整窗口大小，滚动会按预期更新。

垂直滚动策略是`VERTICAL_SCROLLBAR_AS_NEEDED`，表模型`fireTableDataChanged`被称为..

不幸的是，代码有点复杂，所以我无法提供导致问题的代码示例。但是想问一下是否有人有一些想法。

**编辑：**仍然有点混乱：水平滚动策略是`HORIZONTAL_SCROLLBAR_AS_NEEDED`，如果表格宽度超过视图宽度（即使用水平滚动条），则不会发生此问题...

**EDIT2：**问题不在于应该滚动表格，而是滚动条没有按应有的方式激活。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T11:17:14.893

您可能需要发布一些代码。我刚刚完成了以下测试，它像宣传的那样工作，即当行数超过视口高度时，垂直滚动条被激活：

```
import java.awt.GridLayout;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.ScrollPaneConstants;
import javax.swing.table.AbstractTableModel;

public class JTableTest {

    public static void main(String[] args) {
        final MyTableModel tm = new MyTableModel();
        tm.addData(new Data("R1C1", "R1C2"));

        JTable table = new JTable(tm);
        JScrollPane scrollPane = new JScrollPane(table);
        scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);
        JFrame frame = new JFrame();
        frame.setLayout(new GridLayout());
        frame.add(scrollPane);
        frame.pack();
        frame.setSize(400, 150);
        frame.setVisible(true);

        Thread t = new Thread(new Runnable() {
            private int count = 2;
            public void run() {
                for ( ; ; ) {
                    tm.addData(new Data("R" + count + "C1", "R" + count + "C2"));
                    count++;
                    try {
                        Thread.sleep(2000);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                }
            }
        });
        t.start();
    }

    private static class MyTableModel extends AbstractTableModel {
        private List<Data> dataList = new ArrayList<Data>();

        public int getColumnCount() {
            return 2;
        }

        public void addData(Data data) {
            dataList.add(data);
            fireTableRowsInserted(dataList.size()-1, dataList.size()-1);
        }

        public int getRowCount() {
            return dataList.size();
        }

        public Object getValueAt(int rowIndex, int columnIndex) {
            Data data = dataList.get(rowIndex);
            return columnIndex == 0 ? data.data1 : data.data2;
        }
    }

    private static class Data {
        public String data1;
        public String data2;

        public Data(String data1, String data2) {
            this.data1 = data1;
            this.data2 = data2;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T12:52:06.677

嗯..返回问题后，我发现我们在 JScrollPane 中自定义的行标题导致了问题。（一些首选尺寸设置为不那么明智的值等）..

# user-interface - 幽默可以减少感知响应时间吗？

> ID：593780
> 
> 赞同：4
> 
> 时间：2009-02-27T06:56:07.207
> 
> 标签：user-interface, hci, human-computer-interface

在阅读了 StackoOverflow 问题 [https://stackoverflow.com/questions/182112/funny-loading-statements-to-keep-users-amused](https://stackoverflow.com/questions/182112/funny-loading-statements-to-keep-users-amused)之后，我真的很想思考这个问题“幽默可以减少响应时间吗？”

在加载大量数据的页面中，而不仅仅是“请稍候”或“加载数据”，幽默/有趣/诙谐的消息能否缩短感知响应时间（用户感知）？我想用户的响应时间计数可能需要 3-5 秒。

Joel、Jeff 和其他人对此有何看法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T06:58:25.093

在第 42 次 widgetObject 需要 40 秒加载后，幽默变得烦人。

当你在等待某事发生时，它让你有机会看到笑话中的缺陷。

为什么#@#$ 没有花更多的时间写更好的代码而不是写笑话？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T07:16:52.943

第一次可爱第二次还好第三次烦人第四次微软回形针地狱

很难真正猜出人们会怎么想……人工智能和人机交互是很深的领域，每当专家们试图猜测什么会“更简单”时，他们似乎往往会让情况变得更糟。

经典的例子，道格拉斯·亚当斯的宇宙飞船与乘客在一个废弃的星球上被锁了数百年，但机器人船员坚持他们需要粉红色的餐巾纸，最终会出现一个提供他们的文明，等等。（我认为他们是粉红色的。 )

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T07:26:02.297

我同意 MatthieuF 的观点：进度条是更好的选择。

如果你愿意付出努力，你可能想让进度条稍微倾斜一点：人们认为如果它随着它的进行而加速，它会花费更少的时间。更多细节在这里： http: [//www.chrisarrison.net/projects/progressbars/index.html](http://www.chrisharrison.net/projects/progressbars/index.html)

如果没有，至少一个诚实的进度条会让你知道你是否有时间去泡杯茶。（或网状一些样条线......）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T07:15:47.143

要考虑的一件非常重要的事情也是对质量或专业性的看法。如果我在等待游戏或娱乐应用程序，那么幽默可能会分散注意力。

但是，在处理办公室或财务应用程序时，我不想看到任何幽默的消息。这会让我质疑原本严肃的应用程序的完整性。

如果您真的感兴趣，请阅读Steven C. Seow的“[设计和工程时间：软件中时间感知的心理学”。](https://rads.stackoverflow.com/amzn/click/com/0321509188)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T07:18:08.447

我发现进度条减少了感知时间，而不是使用幽默。至少用户有东西可看，并且知道正在取得进展

我同意以上所述。花哨的东西只会让我烦恼。

# javascript - 通过javascript获取仅比当前元素低1级的元素

> ID：593785
> 
> 赞同：14
> 
> 时间：2009-02-27T06:57:11.977
> 
> 标签：javascript, dom

我需要访问 DOM 树并获取仅比当前元素低 1 级的元素。

阅读以下代码：

```
<div id="node">
    <div id="a">
        <div id="aa">
            <div id="ab">
                <div id="aba"></div>
            </div>
        </div>
    </div>
    <div id="b">
        <div id="ba">
            <div id="bb">
                <div id="bba"></div>
            </div>
        </div>
    </div>
    <div id="c">
        <div id="ca">
            <div id="cb">
                <div id="cba"></div>
            </div>
        </div>
    </div>
</div> 
```

我想在“节点”下获得 3 个元素“a”、“b”、“c”。我该怎么办？

var nodes = node.getElementsByTagName("div") <---- 我得到了所有的 div，但没有得到我需要的 3 个 div。

var 节点 = node.childNodes; <---- 适用于 IE，但 FF 包含文本节点

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-27T07:17:34.953

您可以使用排除所有非元素节点的函数：

```
function getChildNodes(node) {
    var children = new Array();
    for(var child in node.childNodes) {
        if(node.childNodes[child].nodeType == 1) {
            children.push(child);
        }
    }
    return children;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T07:18:32.330

我强烈建议您查看[JQuery](http://www.jquery.com)。您要执行的任务在纯 Javascript 中很简单，但如果您正在执行任何额外的 DOM 遍历，JQuery 将为您节省无数小时的挫败感。不仅如此，它还适用于所有浏览器，并且具有非常好的“文档就绪”方法。

您使用 JQuery 解决的问题如下所示：

```
$(document).ready(function() {
    var children = $("#node").children();
}); 
```

它查找任何 id 为“node”的元素，然后返回其子元素。在这种情况下，`children`是一个可以使用 for 循环迭代的 JQuery 集合。此外，您可以使用 each() 命令对它们进行迭代。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-22T13:19:08.633

这比你想象的要简单：

```
var nodes = node.querySelector("node > div"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-05T12:52:44.213

试试这个（迟到的答案，但对其他人有用）：

```
var list;
list=document.getElementById("node").querySelectorAll("#node>div"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-12T14:26:58.990

在我看来，最简单的方法是在第一级子节点中添加一个类名：

```
<div id="node">
    <div id="a" class="level_1">
        <div id="aa">
            <div id="ab">
                <div id="aba"></div>
            </div>
        </div>
    </div>
    <div id="b" class="level_1">
        <div id="ba">
            <div id="bb">
                <div id="bba"></div>
            </div>
        </div>
    </div>
    <div id="c" class="level_1">
        <div id="ca">
            <div id="cb">
                <div id="cba"></div>
            </div>
        </div>
    </div>
</div> 
```

然后使用方法`getElementsByClassName`，所以在这种情况下：

```
document.getElementById('node').getElementsByClassName('level_1'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-23T15:33:37.457

[通用选择器](https://developer.mozilla.org/en-US/docs/Web/CSS/Universal_selectors)可以解决问题：

```
var subNodes = document.querySelectorAll("#node > *"); 
```

查询部分：

`#node`是唯一的容器选择器

`>`下一个选择器应仅应用于孩子

`*`匹配每个标签但不匹配文本的通用选择器

[我可以使用通用选择器吗](https://caniuse.com/#search=universal%20selector)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T07:21:00.720

我认为 node.childNodes 是正确的起点。您可以（使其也与 FF 一起使用）测试您获得的所有子节点的 nodeName（可能还有 nodeType），以跳过文本节点。

你也可以看看一些像[原型](http://www.prototypejs.org/)这样的javascript库，它提供了很多有用的功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-05T02:23:01.100

我添加了一些文本，以便我们可以看到它正在运行，并且 JavaScript 将添加“已添加！” 到底部每个 div 的底部：

```
var cDiv = document.querySelectorAll('body > div > div'), i;
for (i = 0; i < cDiv.length; i++)
{
	cDiv[i].appendChild(document.createTextNode('added!'));
}
```

```
<div id="node">
    <div id="a">a
        <div id="aa">aa
            <div id="ab">ab
                <div id="aba">aba</div>
            </div>
        </div>
    </div>
    <div id="b">b
        <div id="ba">ba
            <div id="bb">bb
                <div id="bba">bba</div>
            </div>
        </div>
    </div>
    <div id="c">c
        <div id="ca">ca
            <div id="cb">cb
                <div id="cba">cba</div>
            </div>
        </div>
    </div>
</div>
```

# c++ - C++ 目录重构

> ID：593792
> 
> 赞同：6
> 
> 时间：2009-02-27T06:59:57.540
> 
> 标签：c++, refactoring

我在大约 10 个目录中有大约 500 个文件的源代码。我需要重构目录结构——这包括更改目录层次结构或重命名某些目录。

我正在使用 svn 版本控制。有两种重构方法：一种保留 svn 历史记录（使用 svn move 命令），另一种不保留。我认为使用 eclipse CDT 和 SVN 插件重构保留 svn 历史要容易得多（visual studio 根本不适合目录重构）。

但是现在由于代码没有发布，我们可以选择不保留历史。

仍然存在更改包含头文件的包含指令的任务。我正在考虑使用python编写一个小脚本-接收从当前文件名到新文件名的映射，并在需要的地方进行重命名（使用sed之类的东西）。有没有人做过这种目录重构？你知道好的相关工具吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T07:21:59.373

如果您必须重写`#include`s 来执行此操作，那么您做错了。将所有内容更改`#includes`为使用非常简单的目录结构，深度最多为两级，并且仅使用第二级来组织架构或操作系统依赖项（如`sys/types.h`）。

然后更改您的 make 文件以使用`-I`包含路径。

瞧。你永远不必为此再次修改代码，如果出现问题，编译会立即崩溃。

就历史部分而言，我个人发现在做这类事情时更容易重新开始；存档旧的，创建一个新的存储库 v2，从那里开始。反驳是当有大量的更改历史，或现有代码存在大量未解决的问题时。

哦，你确实有很好的测试，而且你不会在即将发布的情况下这样做，对吧？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T07:28:03.230

我会保留历史，即使需要一点额外的时间。能够阅读提交日志并理解为什么函数 X 以一种奇怪的方式编写，或者这确实是一个错误的错误，因为它是由 Oliver 编写的，他总是会出错，这很有价值。

可以为以下用户提出反对保留历史记录的论点：

*   你的代码可能有令人尴尬的事情，比如亵渎和开发人员之间的争吵
*   您不关心代码的提交历史，因为它不会在将来更改或维护

去年我在我们的代码库上做了一些这样的目录重构。如果您的代码一开始结构合理，您可以使用以您选择的语言（我使用 Perl）编写的脚本来完成大约 75-90% 的工作。在我的例子中，我们从一个大目录中的一组文件移动到一系列嵌套目录，具体取决于命名空间。因此，声明类protocols::serialization::SerializerBase 的文件位于src/protocols/serialization/SerializerBase 中。从旧名称到新名称的映射很简单，因此对树中每个源文件中的#includes 进行查找和替换很简单，尽管这是一个很大的变化。我们必须手动修复一些奇怪的边缘情况，但这似乎比必须手动完成所有事情或必须编写自己的 C++ 解析器要好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T09:56:17.553

破解一个 shell 脚本来执行*svn*移动是微不足道的。在*tcsh*中，它是*foreach F ( $FILES ) ... end*来调整一组文件。Perl 和 Python 提供了更好的实用性。

真的值得保存历史。尤其是在试图追踪一些奇异的错误时。那些不从历史中吸取教训的人注定要重蹈覆辙，或者一些这样的垃圾……

至于更改所有文件......前几天有一个类似的问题：

[https://stackoverflow.com/questions/573430/c-include-header-path-change-windows-to-linux/573531#573531](https://stackoverflow.com/questions/573430/c-include-header-path-change-windows-to-linux/573531#573531)

# windows - Windows 系统编程：可以将击键发送到当前不是活动的打开的应用程序吗？

> ID：593796
> 
> 赞同：2
> 
> 时间：2009-02-27T07:01:44.277
> 
> 标签：windows, winapi, operating-system, keystroke

我对我的 Windows 系统编程有点生疏......

`SendMessage()`如果（打开的）目标应用程序当前没有焦点，程序是否可以将击键（我猜是通过api 调用）发送到另一个应用程序？如果可能的话，它是否使目标应用程序成为活动应用程序，还是仍然保留在后台？

提前感谢您提供的任何信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T07:07:39.363

不，它不会改变焦点，除非后续调用执行 setfocus。它将保持相同的窗口顺序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-06T11:07:49.057

```
PostMessage(hwndOther, WM_KEYDOWN, VK_ENTER, 0); 
```

这对我有用，但仅在 Windows XP 下。

但是在 Vista 和 Windows 7 上我也遇到了问题。可能与 UIPI。我正在尝试从注入到此进程的 DLL 发送消息以进行处理。

如何解决？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T07:09:48.187

凭记忆：是的，不是的。

您正在寻找 WM_KEYDOWN：

```
PostMessage(hwndOther, WM_KEYDOWN, VK_ENTER, 0); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T09:14:31.460

是的，您可以发送击键，不，它不会将另一个窗口带到顶部。

*   一种方法是使用[SendInput](http://msdn.microsoft.com/en-us/library/ms646310.aspx) API 函数 - 这是一个[如何](http://vb.mvps.org/samples/project.asp?id=sendinput)在 VB6 中使用它的示例（ulp！）。
*   [使用 .NET Framework 3.0 直接支持的GUI 自动化](http://msdn2.microsoft.com/ms747327.aspx)可能更容易- 例如阅读[此](http://msdn.microsoft.com/en-us/magazine/cc163465.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T09:28:36.420

对于按键的定向发送，SendInput 是首选的本机方法，尽管它在 Vista/2008/W7 上受 UIPI（完整性级别）检查。您不能将击键发送到具有 IL > yours 的应用程序。

捕获和重定向输入的更通用的解决方案是全局键盘挂钩（请参阅 SetWindowsHookEx 的帮助）。但这是相当麻烦的事情——你必须处理如何发送击键，你会影响系统中的每个进程，因为你的代码被有效地插入到输入流中，它涉及到编写一个本地 DLL ......你必须知道正是你在做什么。

我们在我们的系统中使用了一个全局键盘挂钩（我写了它），但我们是一个特例——一个单一功能的紧急呼叫处理系统。我不建议将全局挂钩作为通用 Windows 计算的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T11:16:57.190

你不需要 SendInput() 或钩子

PostMessage 的答案是错误的。

您必须远程附加您的线程。[在Win32 api Group](http://news://nntp.aioe.org/comp.os.ms-windows.programmer.win32)上查看这是一个非常经典的问题（C 代码，正确的 MS 方法）

# .net - 蒙面的文本框，如何将提示符包含到值中？

> ID：593800
> 
> 赞同：1
> 
> 时间：2009-02-27T07:05:33.440
> 
> 标签：.net, winforms

如何在屏蔽文本框的文本中包含提示字符？我也想保存提示字符

示例我指定掩码：&&&&/&&

并提示 _ 的字符

然后我输入 12 4/5。程序应将其保存为 12_4/5。获取蒙版文本框的文本时，任何留空的内容都应转换为提示字符

[编辑]

找到了，将TaskMaskFormat设置为IncludePromptAndLiterals

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T10:29:03.870

您可以从 MaskedTextBox 创建派生类，然后覆盖 Text 属性。在设置时，您会发现/用空格替换提示字符，并在用提示字符替换空格时。

# redirect - DNS 专家：如何仅使用 DNS 将 www.domain.com 转发到 domain.com？

> ID：593807
> 
> 赞同：11
> 
> 时间：2009-02-27T07:10:44.003
> 
> 标签：redirect, dns, cname

我正在posterous.com 上运行一个博客，如果我在我的域注册商的自定义DNS 工具中为他们的IP 创建一条A 记录，他们就可以托管我的域名。

问题是我希望我的域总是读取 domain.com，所以我想让我的 DNS 将任何对 www.domain.com 的请求重新映射到 domain.com，并且我不能使用 .htaccess 或 PHP 或其他服务器方法，因为它只是一个博客界面。

到目前为止，我已经尝试过：

```
@一个target.ip.address
www CNAME 域名.com

```

它将 www.domain.com 重定向到正确的站点，但是 www. 仍在域上。我听说你可以这样做：

```
@一个target.ip.address
www 一个 internal.redirector.ip.address

```

但我不知道我的注册商的内部 IP 地址可能会处理这个重定向（或者即使这样的事情确实存在）。

我要求的可以完成吗？

谢谢，你们摇滚。

-乔什

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-27T09:12:48.237

不，您不能使用 DNS 执行此操作 - DNS 查询的结果不会改变 HTTP 层中发生的情况，因此最初输入的域名将始终是在`Host:`标头中发送到 Web 服务器的域名。

Web浏览器只在DNS中查找`A`记录，而用户的ISP的递归名称服务器检测到该名称实际上只有一条`CNAME`记录，然后查找该记录，并在记录中返回与该名称对应的IP地址`CNAME`。

通常的 C `gethostbyname()`API 不会将任何`CNAME`信息返回给应用程序，它所获得的只是最终生成的 IP 地址。

为了实现您想要的，您需要安排`www.example.com`与您的博客分开托管，然后让该站点执行 HTTP 重定向`example.com`（即不带`www`前缀）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T09:03:17.650

> 我要求的可以完成吗？

不，不是使用 DNS。

您可以使用 dyndns.com webhop 之类的东西进行设置。基本上，您将 www.posterous.com 指向 dyndns 服务器，当浏览器连接时，它们会发送 HTTP 302 重定向到您想要的 url (posterous.com)。

[http://www.dyndns.com/services/webredirect/](http://www.dyndns.com/services/webredirect/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T07:36:04.817

我不确定您是否可以使用 DNS 执行此操作，但我很肯定您可以在您的博客模板中使用一些 javascript 技巧来执行它。即，在每个页面加载时运行的 javascript 片段可以检查当前页面的服务器，如果与“www”匹配，则重写该位置。字首。当然，在页面加载然后重新加载时会有一些闪烁，搜索引擎也会忽略此重定向，因此您的内容可能会出现在搜索结果中的错误地址下，但至少用户会看到正确的预期地址.

**另一种想法：**如果您的 DNS 注册商还提供免费的 Web 服务，则在那里进行重定向，添加重写规则以将请求路径转换为脚本参数，并为每个请求生成一个带有 iframe 访问的简单页面真实的内容。这又需要一些 PHP 编码，但应该不会太难。

# linq - LINQ to SQL 的优势是什么？

> ID：593808
> 
> 赞同：21
> 
> 时间：2009-02-27T07:10:58.433
> 
> 标签：linq, linq-to-sql, stored-procedures, ado.net

我刚刚开始在一个中型项目中使用 LINQ to SQL，并希望加深对 L2S 提供的优势的理解。

我看到的一个缺点是它添加了另一层代码，我的理解是它的性能比使用存储过程和 ADO.Net 慢。似乎调试也可能是一个挑战，特别是对于更复杂的查询，并且这些最终可能会被移动到存储过程中。

我一直想要一种在更好的开发环境中编写查询的方法，L2S 查询是我一直在寻找的解决方案吗？还是我们刚刚在 SQL 之上创建了另一个层，现在要担心的事情是原来的两倍？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-27T09:43:26.850

**L2S 提供的优势：**

*   没有魔法字符串，就像你在 SQL 查询中那样
*   智能感知
*   数据库更改时的编译检查
*   更快的发展
*   工作单元模式（上下文）
*   自动生成的领域对象是可用的小项目
*   延迟加载。
*   学习编写 linq 查询/lambdas 是 .NET 开发人员必须学习的。

**关于性能：**

*   在大多数解决方案中，性能很可能不会成为问题。预优化是一种反模式。如果您稍后发现应用程序的某些区域运行缓慢，您可以分析这些部分，在某些情况下甚至将一些 linq 查询与存储过程或 ADO.NET 交换。
*   在许多情况下，延迟加载功能可以提高性能，或者至少可以大大简化代码。

**关于调试：**

*   在我看来，调试 Linq2Sql 比存储过程和 ADO.NET 都容易得多。我建议您看一下[Linq2Sql Debug Visualizer](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)，它可以让您查看查询，甚至在调试时触发执行以查看结果。
*   您还可以配置上下文以将所有 sql 查询写入控制台窗口，更多信息[在这里](http://www.davidhayden.com/blog/dave/archive/2007/08/17/DataContextLogLoggingLINQToSQLOutputConsoleDebuggerOuputWindow.aspx)

**关于另一层：**

*   Linq2Sql 可以看作是另外一层，但它是一个纯粹的数据访问层。存储过程也是另外一层代码，我见过很多部分业务逻辑已经实现到存储过程中的案例。在我看来，这更糟糕，因为您将业务层分成两个地方，开发人员将更难获得业务领域的清晰视图。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-27T07:26:43.187

只是一些快速的想法。

**一般的 LINQ**

*   使用相同的语法和运算符查询内存中的集合和进程外的数据存储
*   声明式风格非常适合查询 - 在很多情况下都更容易阅读和写作
*   整洁的语言集成允许编写新的提供程序（进程内和进程外）并利用相同的查询表达式语法

**LINQ to SQL（或其他数据库 LINQ）**

*   在需要的地方而不是存储过程中编写查询可以使开发速度更快：只需获取所需数据所涉及的步骤要少得多
*   少得多的字符串（存储过程、参数名称或只是简单的 SQL）涉及的拼写错误可能会令人恼火；这枚硬币的另一面是您的查询获得了 Intellisense
*   除非您打算使用来自 ADO.NET 的“原始”数据，否则无论如何您都会在某个地方拥有一个对象模型。为什么不让 LINQ to SQL 为您处理呢？我更喜欢能够只做一个查询并取回对象，准备好使用。
*   我希望性能很好 - 如果不是，您可以自己调整它或回退到直接 SQL。使用 ORM 当然不会消除创建正确索引等的需要，您通常应该检查为非平凡查询生成的 SQL。

无论如何，它都不是灵丹妙药，但我非常喜欢它直接进行 SQL 查询或使用存储过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T07:17:09.060

我必须说他们是你一直在寻找的。习惯它需要一些时间，但一旦你习惯了，你就不会想到回去（至少对我来说）。关于 linq 与存储过程，如果构建错误，性能可能会很差。我转移到 linq to sql 客户端的一些存储过程，这些存储过程编码非常糟糕，因此时间从 20 秒（对于 Web 应用程序完全不可接受）下降到 < 1 秒。而且代码比存储过程解决方案少得多。

**更新 1：**您还可以获得很大的灵活性，因为您可以限制所获得的列，它实际上只会检索它。在存储过程解决方案中，您必须为您获得的每个列集定义一个过程，即使基础查询是相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-03T18:02:50.127

作为更新，这里有一些关于 LINQ to SQL 未来的链接：

[Linq to SQL 的未来是什么](https://stackoverflow.com/questions/1351789/what-is-the-future-of-linq-to-sql)

[Microsoft 是否确认了他们对 LINQ to SQL 生命周期结束的立场？](https://stackoverflow.com/questions/3407565/has-microsoft-confirmed-their-stance-on-linq-to-sql-end-of-life)

[LINQ to SQL 是死的还是活的？](https://stackoverflow.com/questions/252683/is-linq-to-sql-dead-or-alive)

正如最后一个链接中的评论所说，LINQ to SQL 不会消失，至少不会被微软“改进”。随心所欲地接受这些评论和帖子，只是在你的发展计划中要谨慎。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-27T07:26:11.767

我们最近通过实体框架环境切换到 LINQ2Entity。之前，我们有基本的 SQLadapter。由于我们使用的数据库相当小，我无法评论 LINQ 的性能。

不过我必须承认，编写查询已经变得容易多了，并且实体的添加确实可以实现强类型。

# django - 在 Django 中重命名模型后修复 auth_permission 表

> ID：593810
> 
> 赞同：8
> 
> 时间：2009-02-27T07:12:52.003
> 
> 标签：django, django-models

时不时地，您需要在 Django 中重命名模型（或者，在我最近遇到的一个案例中，将一个模型分成两个，使用新的/不同的名称）。（是的，适当的计划有助于避免这种情况）。

在重命名数据库中的相应表并修复受影响的代码后，仍然存在一个问题：授予用户或组对这些模型进行操作的任何权限仍然引用旧模型名称。是否有任何自动化或半自动化的方法来解决这个问题，还是只是手动数据库手术的问题？（在开发中，您可以删除 auth_permissions 表和 syncdb 以重新创建它，但生产并不那么简单）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T15:15:48.813

这里是一个填充缺少的内容类型和权限[的片段。](http://www.djangosnippets.org/snippets/698/)我想知道它是否可以扩展到至少做一些清理 auth_permissions 的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T00:06:09.093

如果您碰巧使用了 South 模式迁移来重命名表，则正向迁移中的以下行将自动完成此操作：

```
db.send_create_signal('appname', ['modelname']) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T08:13:55.943

我做了一个很长的回答，详细说明了在这种情况下我将采取的攻击计划，但在我写这篇文章的时候，我意识到在这种情况下可能没有任何办法可以避免停机维护。

当然，您可以通过准备好 loaddata 脚本来最大程度地减少停机时间，尽管需要注意确保 auth_perms 主键是同步的。

另请参阅简短答案：我知道没有自动执行此操作的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-11T22:16:58.023

我最近遇到了这个问题并写了一个函数来解决它。如果重命名模型/表，通常会与 ContentType 和 Permission 表存在差异。Django 有内置的帮助函数来解决这个问题，你可以按如下方式使用它们：

```
from django.contrib.auth.management import create_permissions
from django.contrib.contenttypes.management import update_all_contenttypes
from django.db.models import get_apps

def update_all_content_types_and_permissions():
    for app in get_apps():
        create_permissions(app, None, 2)
    update_all_contenttypes() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-05T17:54:41.027

我在应用程序中更改了详细名称，在 Django 2.2.7 中，这是我发现修复权限的唯一方法：

```
from django.core.management.base import BaseCommand, CommandError
from django.contrib.auth.models import Permission

class Command(BaseCommand):
    help = 'Fixes permissions names'

    def handle(self, *args, **options):
        for p in Permission.objects.filter(content_type__app_label="your_app_label_here"):
            p.name = "Can %s %s"%(p.codename.split('_')[0], p.content_type.model_class()._meta.verbose_name)
            p.save() 
```

# java - 与服务器和客户端共享应用程序特定的数据类型

> ID：593815
> 
> 赞同：1
> 
> 时间：2009-02-27T07:17:05.657
> 
> 标签：java, c++, client-server

我必须创建一个服务器（java）-客户端（c++）系统，服务器和客户端都必须使用对象（数据类型），对于客户端和服务器来说，对象（数据类型）是相同的，例如将创建一个汽车对象在客户端，然后发送到服务器，在该服务器上将对汽车对象进行额外的计算。我想做的是创建汽车对象的一个​​通用实现，然后在服务器和客户端中使用这个实现。首先，我考虑创建一个 dll（在 c++ 中），所有数据类型对于客户端和服务器都是相同的，但是这个解决方案有一个缺点。因为这个解决方案只适用于 Windows 操作系统，我必须支持 Win、Mac、Linux。那么是否有针对我的问题的多平台解决方案？

我感谢您的所有回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T07:41:50.140

[Google 有一个名为Protocol Buffers](http://code.google.com/p/protobuf/)的开源库，用于在您的情况下在客户端和服务器之间传输数据对象。它支持 C++、Java 和 Python。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T09:54:46.573

除了协议缓冲区之外，还有另一个称为 thrift（facebook 的协议缓冲区）。见[http://incubator.apache.org/thrift/](http://incubator.apache.org/thrift/)

请参阅此页面进行比较[http://stuartsierra.com/2008/07/10/thrift-vs-protocol-buffers](http://stuartsierra.com/2008/07/10/thrift-vs-protocol-buffers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:58:06.780

这对于 XML 来说似乎是一项不错的工作。那就是我要开始的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T07:20:47.460

看看 CORBA：[http ://en.wikipedia.org/wiki/CORBA](http://en.wikipedia.org/wiki/CORBA)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T07:34:16.990

如果您坚持使用标准库（跨平台），那么在 OS X 和 Linux 上将库 (DLL) 重新编译为共享库 (.so) 应该不会有任何困难。当然，在 Java 中加载它们是一个不同的问题（我没有任何专业知识）。

但是，更重要的是，在您的客户端服务器应用程序的情况下，您可能希望研究对象的有效[序列化](http://en.wikipedia.org/wiki/Serialization)，以便它们可以通过网络传输并由接收器可靠地重建。

# javascript - 正则表达式：创建匹配模式的问题

> ID：593817
> 
> 赞同：0
> 
> 时间：2009-02-27T07:17:12.053
> 
> 标签：javascript, regex

在找出正则表达式以匹配此问题时遇到一些问题：

```
function Array() { [native code] } 
```

我试图只匹配“数组”所在的文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T07:33:41.860

您是否试图找出 javascript 中的变量类型？如果这就是你想要的，你可以将对象的构造函数与你认为创建它的构造函数进行比较：

```
var array = new Array();
if(array.constructor == Array)
    alert("Is an array");
else
    alert("isn't an array"); 
```

这并不是用 javascript 处理事情的最佳方式。Javascript 没有像 C# 那样的类型系统，它可以保证如果变量是由某个构造函数创建的，那么它将具有某些成员，因为 javascript 是一种非常动态的语言，对象从其构造函数中获取的任何内容都可以在运行时被覆盖。

相反，最好使用鸭子打字并询问您的对象它们可以做什么而不是它们是什么： [http ://en.wikipedia.org/wiki/Duck_typing](http://en.wikipedia.org/wiki/Duck_typing)

```
if(typeof(array.push) != "undefined")
{
    // do something with length
    alert("can push items onto variable");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T07:29:02.103

在 Perl 中，您将使用：

```
m/^\s*function\s+(\w+)\s*\(/; 
```

变量“ `$1`”将捕获函数名称。

如果`function`关键字可能不在行首，那么您必须（稍微）更加努力。

[编辑：`\s*`添加了两个 ' ' 序列。]

* * *

关于这是否有效的问题......这是我的测试用例：

测试脚本：

```
while (<>)
{
    print "$1\n" if (m/^\s*function\s+(\w+)\s*\(/);
} 
```

测试输入行（是的，故意错位）：

```
function Array() { ... }
 function   Array2   () { ... }
func Array(22) { ... } 
```

测试输出：

```
Array
Array2 
```

在 Solaris 10 (SPARC) 上使用 Perl 5.10.0 进行测试：我不认为平台或版本是一个重要因素——我希望它在任何可能的 Perl 版本上都能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T09:12:56.660

因此，随后，我得到了这个几乎可行的方法：

```
[function\s]((\S+)+)(?=\(\)) 
```

但是，它仍然匹配 Array 之前的空格

# windows - 如何关闭 Windows 机器上的套接字？

> ID：593821
> 
> 赞同：2
> 
> 时间：2009-02-27T07:17:49.807
> 
> 标签：windows, sockets, networking, tcp

我有一个应用程序，我怀疑它会遇到问题，因为网络节点关闭了它与它通信的各种其他服务器的套接字。我想通过关闭可以在 netstat 中看到的一个或严重的连接来模仿这种行为。我不是操作系统级别的网络专家，所以这个问题可能很愚蠢，如果是这样，你对如何模仿这种情况有任何其他建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T08:21:55.237

在尝试模拟问题之前，您可以通过使用[Wireshark](http://www.wireshark.org/)或在 *nix 上使用 tcpdump 确定地诊断情况。您应该能够捕获流量和观察者，无论其中一个服务器是否正在向您发送`RST`。

如果您正在接收，`RST`那么这可能是由于服务器本身（在等待您向他们发送响应或数据时超时并关闭连接，或者由于服务器错误或负载限制而关闭连接）到您的 ISP 网络设备，或连接到您自己的网络设备（例如，您的无线链路上下移动。）

断开路由器、网线或无线接口的连接可以在不同程度上模拟您在与服务器通信时随时可能遇到的连接问题。断开 PC 的网络电缆应模拟强制关闭连接`RST`，而断开您和互联网之间的电缆，而不是直接连接 PC 的电缆（例如断开路由器和电缆/DSL 调制解调器之间的电缆，或断开电缆/DSL 调制解调器与电缆公司的电缆/电信公司的墙壁插孔的连接）将允许您模拟超时条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-29T16:17:54.817

您可以使用[TCP 视图](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)。您可以查看从您的机器到另一台机器或同一台机器内的所有连接。您可以关闭连接，从而中断连接。

# c - 什么操作将浮点数变成一个“组”？

> ID：593824
> 
> 赞同：1
> 
> 时间：2009-02-27T07:19:03.033
> 
> 标签：c, language-agnostic, math, floating-point, puzzle

可能有人熟悉将一组有效浮点数强制为基于乘法运算的组的技巧和技术吗？

也就是说，给定任意两个浮点数（“double a,b”），什么样的操作序列，包括乘法，会变成另一个有效的浮点数？（有效的浮点数是任何 1 归一化的数字，不包括 NaN、非正规数和 -0.0）。

把这个粗略的代码：

```
double a = drand();
while ( forever ) 
{
    double b = drand();
    a = GROUP_OPERATION(a,b); 
    //invariant - a is a valid floating point number
} 
```

由于 NaN，仅靠自身相乘是行不通的。理想情况下，这将是一种直线方法（避免“如果高于 X，则除以 Y”公式）。

如果这不适用于所有有效的浮点数，是否有一个子集可供此类操作使用？

（我正在寻找的模型类似于 C 中的整数乘法 - 无论两个整数相乘，你总是得到一个整数）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-28T21:33:27.213

> （我正在寻找的模型类似于 C 中的整数乘法 - 无论两个整数相乘，你总是得到一个整数）。

整数模 2^N 不形成一个组 - 哪个整数乘以 2 得到 1？要使整数成为乘法组，您必须对素数进行模数。（例如 Z mod 7, 2*4 = 1，所以 2 和 4 互为倒数）

对于浮点值，简单的乘法或加法饱和到 +/- 无穷大，并且不存在与无穷大相反的值，因此该集合不是封闭的，或者它缺乏可逆性。

另一方面，如果您想要类似于以 2 的幂为模的整数乘法，那么乘法就可以了——有些元素没有逆，所以它不是一个群，但它是封闭的——你总是会得到一个浮点值。对于真正组的浮点子集，请参阅 lakshmanaraj 的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T07:33:13.437

由于舍入错误，浮点数永远不会形成您所说的意义上的组。考虑一下数值分析类中的任何那些可怕的例子，比如 0.1 不能用二进制精确表示。

但是从这个意义上说，即使是计算整数也不会形成一个群，因为它们在乘法下也不是封闭的。（证明：计算 的结果`while true do x = x*x`。在某些时候，你会超过字的大小，用完 BIGNUM 的资源，或者其他什么。）

### @UnderAchievementAward 的更新：

-- 在这里添加，所以我可以得到格式，不像评论

> 由于我从浮点（而不是“实”数）开始，我不能避免任何 0.1 表示问题吗？“x = x*x”问题是为什么需要额外的操作来将结果保持在有效范围内。

好的，但是你会遇到这样一种情况，即存在一些*x,y* st 0 ≤ x,y < *max*其中*xy* < 0。或者同样不直观的东西。

关键是您当然可以定义一组看起来像有限表示集上的组的操作，但是如果您尝试将其用作正常的算术运算，它会做一些奇怪的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T07:38:02.050

浮点数由位支持。这意味着您可以在浮点值的整数表示上使用*整数算术，并且您将获得一个组。*

不确定这是否非常有用。

```
/* You have to find the integer type whose size correspond to your double */
typedef double float_t;
typedef long long int_t;

float_t group_operation(float_t a, float_t b)
{
  int_t *ia, *ib, c;
  assert(sizeof(float_t) == sizeof(int_t));
  ia = &a;
  ib = &b;
  c = *ia * *ib;
  return (float_t)c;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T07:57:54.220

如果组运算是乘法，那么如果 n 是最高位，则 r1=1/power(2,n-1) 是您可以运算的最小十进制数，并且集合 [r1,2 * r1,4 * r1,8 * r1...1] union [-r1, -2 * r1, -4 * r1,....-1] union [0] 将是您所期望的组。对于整数 [1,0,-1] 是组。

如果组操作可以是其他任何东西，则形成 n 组有效组，

A(r)=cos(2*Pi*r/n) 从 r=0 到 n-1

和组操作是

COS(COSINV(A1)+COSINV(A2))

不知道你要不要这个......

或者如果您希望将 INFINITY 设置为有效组，则

简单的答案：GROUP OPERATION = AVG(A1,A2) = (A1+A2)/2

或者某些函数存在 F，它具有 FINV 作为它的逆，然后是 FINV(F(A1)+F(A2)/2) F 的示例是对数、逆、平方等。

```
 double a = drand();
while ( forever ) 
{
    double b = drand();
    a = (a+b)/2
  //invariant - a is a valid floating point number
} 
```

或者，如果您希望将 DIGITAL 格式的 INFINITY 集作为有效组，则令 L 为最低浮点数，H 为最高浮点数

那么组操作 = AVG(A1,A2, L, H) = (A1+A2+L+H)/4

对于所有正数，此操作将始终在 L 和 H 内。

出于实际目的，您可以将 L 作为最低十进制数的四倍，将 H 作为（最高十进制数/4）。

```
double l = (0.0000000000000000000000000//1) * 4
double h = (0xFFFFFFFFFFFFFFFFFFFFFF///F) / 4
double a = abs(drand()) / 4;

while ( forever ) 
{
    double b = abs(drand()) / 4;
    a = (a+b+l+h)/4
//invariant - a is a valid floating point number
} 
```

这具有所有正浮点数 / 4 的子集。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-01T02:49:49.513

整数在乘法下不会形成一个群——0没有逆。

# java - 在 JLabel 中显示 BMP

> ID：593830
> 
> 赞同：6
> 
> 时间：2009-02-27T07:21:57.033
> 
> 标签：java, image, bmp

Java 可以显示 png、jpg 和其他一些图片格式，但我必须通过获取文件路径在 JLable 中显示 bmp 文件。

```
ImageIcon imageIcon = new ImageIcon(imageFile.getAbsolutePath()); 
```

ImageIcon 支持典型`png,gif,jpg`图像。

在我正在工作的项目中，我无法打开 bmp 文件并将相同的文件存储为 jpg，因为我不允许在运行时存储某些内容。我只能在内存中生成图像。但我不知道该怎么做。

我怎样才能`BMP`显示`Java` `1.4`？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T07:47:15.210

[javax.imageio.ImageIO](http://java.sun.com/j2se/1.4.2/docs/api/javax/imageio/ImageIO.html)支持 BMP 格式：

```
Image image = ImageIO.read(imageFile);
ImageIcon icon = new ImageIcon(image);

JLabel label = new JLabel(icon); 
```

ImageIO 也可用于在不同格式之间进行转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T08:41:30.853

我发现一些用 Java 1.5 编写的类，但您可以轻松更新 2 个类，以便可以使用 1.4 中的类。

[imag4j](http://sourceforge.net/project/showfiles.php?group_id=181651&package_id=210461)可以将 bmp 和 ico 文件转换为可以在 java 中显示的 BufferedImage 对象。由于 java 1.5 语句，您可以导入 17 个类并且可能必须更新 10 行。

你会得到一个运行良好的 bmp 转换器。

# networking - 使用电话线的游戏

> ID：593835
> 
> 赞同：4
> 
> 时间：2009-02-27T07:23:12.587
> 
> 标签：networking, dial-up

我记得几年前我和我的朋友正在玩命令与征服红色警报，有一种模式是我们输入其他电话号码，游戏就会拨号并连接。这叫什么？我在哪里可以找到为此编程的资源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T07:34:05.117

拨号网络也许。您将必须学习如何控制调制解调器。我记得有一些命令看起来像这样：**ATH0++**，这是你可以让调制解调器做不同事情的方法。也许这会给你一些寻找的东西。

这个资源看起来很有帮助：[http ://www.activexperts.com/activcomport/tutorials/modem/](http://www.activexperts.com/activcomport/tutorials/modem/)

您可能会发现的一个问题是通常有两种类型的调制解调器。一个是连接到您的串行端口的实际调制解调器。另一个是通常被称为“winmodem”的东西，它通常位于 PCI 插槽中，没有硬件上的所有功能，而是使用通常只在 Windows 中工作的硬件驱动程序。MODEM 代表“MOdulator DEModulator”，这意味着它只是将数字信号转换为模拟信号，反之亦然。

从本质上讲，如果您能弄清楚如何对计算机上的串行/com 端口进行编程，您应该能够访问调制解调器。

另一个有趣的链接：[http ://en.wikibooks.org/wiki/Serial_Programming:Modems_and_AT_Commands](http://en.wikibooks.org/wiki/Serial_Programming:Modems_and_AT_Commands)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T12:05:27.370

看看 TAPI（电话 API）。在 Windows 世界中，操作系统中有一组用于此的 API ( [http://msdn.microsoft.com/en-us/library/ms737219(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms737219(VS.85).aspx) )。如果您将调制解调器视为 COM 端口并将 AT 命令发送到该 COM 端口（这实际上是 TAPI 所做的），那么 AT 命令集（Hayes 命令）也可以在没有 TAPI 的情况下在 Windows 中使用，但它将您与它们的不同变体隔离开来以特定顺序运行初始化和其他命令。

# windows - 当我的程序使用 Swapfile 时 Windows 停止

> ID：593842
> 
> 赞同：0
> 
> 时间：2009-02-27T07:26:30.923
> 
> 标签：windows, memory, swapfile

我正在以正常优先级运行用户模式程序。我的程序正在搜索一个 NP 问题，结果占用了大量内存，最终出现在交换文件中。

然后我的鼠标冻结了，任务管理器需要很长时间才能打开并让我结束进程。

我想知道的是，即使我的 2 个内核中只有 1 个被使用，我如何才能阻止我的 Windows 操作系统完全锁定。

编辑：感谢您的回复。

我知道让它使用更少的内存会有所帮助，但对我来说整个操作系统应该锁定是没有意义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T07:36:13.973

显而易见的答案是“使用更少的内存”。当您的应用程序用完所有可用内存时，操作系统必须调出任务管理器（等）以为您的应用程序腾出空间。当您切换程序时，操作系统必须将其他程序重新分页（根据需要）。磁盘读取比内存读取慢，所以一切似乎都变慢了。

如果您想避免这种情况，请让您的应用程序管理自己的内存，或者使用比蛮力更好的算法。（有遗传算法、模拟退火等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T07:37:51.147

除了“重组你的应用程序以使用更少的内存”之外，我认为这个问题没有编程答案。交换文件问题很可能是由于访问磁盘的瓶颈，特别是如果您使用的是 IDE HDD 或高度碎片化的交换文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T07:39:17.727

问题是当另一个程序（例如 explorer.exe）要执行时，它的所有代码和内存都被换掉了。为了给其他程序腾出空间，Windows 必须首先将程序正在使用的数据写入磁盘，然后加载其他程序的内存。在其他程序中执行的每一页新代码都需要访问磁盘，导致它运行缓慢。

我不知道您的程序的访问模式，但我猜它会以随机方式大量接触其所有内存页面，这使问题变得更糟，因为一旦 Windows 从您的程序中逐出内存页面，突然您再次需要它，Windows 必须找到其他页面来进行相同的处理。

要为其他进程提供更多 RAM，可以使用[SetProcessWorkingSetSize](http://msdn.microsoft.com/en-us/library/ms686234(VS.85).aspx)来减少程序可能使用的最大 RAM 量。当然这会使你的程序运行得更慢，因为它必须做更多的交换。

您可以尝试的另一种选择是向系统添加更多驱动器，并将交换文件分布在这些驱动器上。您可能有一个双核 CPU，但您只有一个驱动器。将交换文件分布在多个驱动器上可以让 Windows 平衡它们之间的工作（尽管我没有亲身体验它的性能如何）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T08:26:39.453

这有点极端，但你总是可以最小化你的交换文件，这样你就没有所有的磁盘 thashing，并且你的程序不允许分配太多的虚拟内存。在控制面板/高级/高级选项卡/性能/虚拟内存下，将页面文件设置为自定义大小并输入值 2mb（XP 上允许的最小值）。当分配失败时，您应该得到一个异常并能够优雅地退出。它并不能完全解决您的问题，只是加快速度；）

另一件值得考虑的事情是，如果您在 32 位平台上，移植到 64 位系统并获得一个具有更多可寻址 RAM 的盒子。

# c# - 如何通过 .Net 网络服务使用相同的域实体？

> ID：593844
> 
> 赞同：1
> 
> 时间：2009-02-27T07:27:14.697
> 
> 标签：c#, .net, web-services, casting

如果您有一个在客户端中引用的实体和这样的网络服务

```
public class Post
{    
        public int ID {get; set;}
        string Data {get; set;}
}

 public class MyService: System.Web.Services.WebService
 {   
         [WebMethod]
         public int Write (Post post)
         { 
               //Do stuff

         }
 } 
```

在客户端上，以便使用您从代理类实例化的实体

```
 public void ClientMethod()
      {
         var post = new proxyclass.Post();
         //fill post
         new ProxyClass.Myservice().Write(post) 

       } 
```

我如何使用我的域实体来调用网络服务？

```
 public void ClientMethod()
          {
             var post = new Post();
             //fill post
             new ProxyClass.Myservice().Write(post) 

           } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T07:36:23.677

基本上，你不能 - 使用常规的网络服务，至少......代理类是完全独立的。但是，上述情况对于 WCF*是可能的，您实际上**根本*不需要代理类（但是，对于 SOA 纯度来说，使用它们是一个好主意）。

*您可以使用反射（等）在您的域实体和代理之间*复制属性，但很难做到 100% 正确（尽管 xml 序列化应该 [理论上] 作为一种中间语言工作）。

* * *

所以; 如果你想使用程序集共享；考虑使用支持此功能的 WCF；-p

要在不使用代理层的情况下获取服务，您可以使用以下技巧：

```
public class WcfClient<T> : ClientBase<T> where T : class
{
    public T Service { get { return base.Channel; } }
} 
```

（这将从 app.config 访问默认配置；为了获得更多控制，您需要添加一些与基本构造函数重载匹配的构造函数重载）

然后：

```
interface IFoo {void Bar();}
...
using(WcfClient<IFoo> client = new WcfClient<IFoo>()) {
    client.Service.Bar();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T07:38:10.723

我怀疑其中之一可能会回答您的问题。共同的主题是`wsdl.exe /sharetypes`和`svcutil /reference`。

[在 .NET 项目中管理 2 个具有共享类依赖关系的 Web 引用](https://stackoverflow.com/questions/578955/managing-2-web-references-with-shared-class-dependency-in-a-net-project) [强制 .NET Web 服务使用本地对象类，而不是代理类](https://stackoverflow.com/questions/216884/force-net-webservice-to-use-local-object-class-not-proxy-class) [.Net 使用 Web 服务：两个不同服务中的相同类型](https://stackoverflow.com/questions/209224/-net-consuming-web-service-identical-types-in-two-different-services) [如何让 Web 服务序列化/反序列化相同类型在 .net](https://stackoverflow.com/questions/224474/how-to-get-a-webserice-to-serialize-deserialize-the-same-type-in-net) [.NET SOAP 常用类型](https://stackoverflow.com/questions/127395/-net-soap-common-types) [wsdl.exe /sharetypes](https://stackoverflow.com/questions/489542/wsdl-exe-sharetypes)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T12:47:51.400

您应该尽可能使用 WCF 进行新开发。

但是，您应该重新考虑您希望在客户端上使用您的域类的原因。通过向客户端公开服务实现的一些细节，它确实违反了 SOA 的原则。为什么客户应该知道你的实体类的任何信息，而不是它们包含的数据？

例如，您的实体类可能包含将实体保存到数据库的方法。为什么您的客户需要访问该方法？

此外，SOA 的原则之一是与不同平台进行互操作。一旦您要求您的客户端使用您的 (.NET) 实体，您就会阻止编写 Java 或 PHP 客户端来使用您的服务。

您可能有足够充分的理由来克服这些反对意见，但我建议您仔细考虑并确保您的理由足够充分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-13T16:23:22.720

对于这种情况，您最好使用 json 向 Web 服务发送和接收数据。
Newtonsoft.json 是 .Net 的最佳 json 序列化程序。所以你应该改变你的 Write 方法，如下所示：

```
public void ClientMethod()
      {
         var post = new Post();
         //fill post
         new ProxyClass.Myservice().Write(JsonConvert.SerializeObject(post)) 

       } 
```

# svn - 如何使用 FTP 从 Subversion 存储库更新我的网站？

> ID：593847
> 
> 赞同：6
> 
> 时间：2009-02-27T07:29:17.097
> 
> 标签：svn

我花了一些时间寻找一种从 svn 存储库更新我的网站的有效方法，但我能找到的只是直接从 Web 服务器“svn update”，或者使用 pre/post-commit 挂钩。

由于我没有 ssh 访问我的网络服务器，我不能真正使用“svn update”，所以我测试了一个实用的 pre/post-commit 钩子（svn2web），但不够可靠。于是我上网查了一下，发现[Springloops](http://www.springloops.com)非常令人满意，因为它有一个 FTP 部署功能，可以让我直接从 svn 存储库更新我的网站。

不幸的是，它不是免费的，我喜欢完全控制我的存储库。所以我的问题是：

**是否有任何工具或脚本允许我通过 FTP 从我的 Subversion 存储库更新我的网站？**

就像他们在 Springloops（或 Beanstalk）中所做的一样。

非常感谢您的帮助，我没有想法...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T07:50:04.410

看看[卡皮斯特拉诺](http://www.capify.org/)。它非常强大，可以使用新的“复制”部署策略进行完整的检查、压缩，然后通过 ftp 将其推送到服务器：

```
set :deploy_via, :copy 
```

有关更多信息，请参见[http://www.capify.org/upgrade/whats-new](http://www.capify.org/upgrade/whats-new)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T07:31:59.193

Ci Factory 支持它 - [http://cifactory.org/joomla/](http://cifactory.org/joomla/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-30T16:30:05.727

如果使用 post commit hook 怎么办：

1.  本地主机上的 SVN 更新或导出
2.  从 localhost 连接到 FTP
3.  将所有文件复制到 FTP

# html - 修复 HTML 表格中表格行的高度

> ID：593849
> 
> 赞同：8
> 
> 时间：2009-02-27T07:31:32.520
> 
> 标签：html

请看下面的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
</head>
<body>
<table id="content" height="525" border="0" cellspacing="0" cellpadding="0">
<tr style="height:9px"><td height="9" bgcolor="#990000">Upper</td></tr>
<tr><td  bgcolor="#990099">Lower</td></tr>
</table>
</body>
</html> 
```

IE 忽略了“height:9px”，我无法得到我想要的。此外，没有 DOCTYPE，它也可以工作。但我必须遵循标准，这样 DOCTYPE 就不能被删除。有人如何固定上排的高度吗？

一些说明： 1\. 第二排的高度可能会根据用户的操作而变化，不能固定。2.表格的高度设置为525px，所以表格的最小高度为525px

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T07:34:30.297

当您输入更多文本时，底部单元格会变大...设置表格宽度也会有所帮助

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
</head>
<body>
<table id="content" style="min-height:525px; height:525px; width:100%; border:0px; margin:0; padding:0; border-collapse:collapse;">
<tr><td style="height:10px; background-color:#900;">Upper</td></tr>
<tr><td style="min-height:515px; height:515px; background-color:#909;">lower<br/>
</td></tr>
</table>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T08:07:43.850

只要您从表中删除 height 属性，这将有效。

```
<table id="content" border="0px" cellspacing="0px" cellpadding="0px">
  <tr><td height='9px' bgcolor="#990000">Upper</td></tr>
  <tr><td height='100px' bgcolor="#990099">Lower</td></tr>
</table> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-01T09:26:47.643

我的 CSS

```
TR.gray-t {background:#949494;}
h3{
    padding-top:3px;
    font:bold 12px/2px Arial;
} 
```

我的 html

```
<TR class='gray-t'>
<TD colspan='3'><h3>KAJANG</h3> 
```

我减小了字体的第二个大小。

`padding-top`用于固定 IE7 中的大小。

# sharepoint - CAML 查询未正确排序

> ID：593863
> 
> 赞同：2
> 
> 时间：2009-02-27T07:37:49.570
> 
> 标签：sharepoint, caml

谁能帮我解决这个 CAML 查询？当我将`Ascending`属性从`TRUE`to翻转`FALSE`（也尝试过`True`and `False`）时，它不会重新排序结果集。

CAML 的其余部分是正确的，它是由工具生成的，并且正在返回适当的结果。

```
<Where>
  <And>
    <And>
      <Eq>
        <FieldRef Name="Branch"/>
        <Value Type="Text">Camp 1</Value>
      </Eq>      
      <Eq>
        <FieldRef Name="Type"/>
        <Value Type="Choice">Day</Value>
      </Eq>
    </And>
    <Geq>
      <FieldRef Name="StartDateTime"/>
      <Value Type="DateTime">2009-01-05T00:00:00Z</Value>
    </Geq>
  </And>
  <OrderBy>
    <FieldRef Ascending="TRUE" Name="Title" />
  </OrderBy>
</Where> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T10:33:47.993

OrderBy 不是必须在 Where 子句之外吗？

```
 <Where>
  <And>
    <And>
      <Eq>
        <FieldRef Name="Branch"/>
        <Value Type="Text">Camp 1</Value>
      </Eq>      
      <Eq>
        <FieldRef Name="Type"/>
        <Value Type="Choice">Day</Value>
      </Eq>
    </And>
    <Geq>
      <FieldRef Name="StartDateTime"/>
      <Value Type="DateTime">2009-01-05T00:00:00Z</Value>
    </Geq>
  </And>
  </Where>
<OrderBy>
    <FieldRef Ascending="TRUE" Name="Title" />
  </OrderBy> 
```

请参阅[http://msdn.microsoft.com/en-us/library/ms442728.aspx](http://msdn.microsoft.com/en-us/library/ms442728.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T11:29:26.987

我同意上面的答案，<Query> 必须在 <Where> 之外。另请注意，在与 DateTime 字段进行比较时，通常最好包含 IncludeTimeValue 属性：

```
<Geq>
      <FieldRef Name="StartDateTime"/>
      <Value Type="DateTime" IncludeTimeValue="FALSE">2009-01-05T00:00:00Z</Value>
</Geq> 
```

并将其设置为 false 或 true，具体取决于您是否要在查询中包含时间值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-22T09:01:28.407

我花了将近一整周的时间尝试使用 Client OM CamlQuery 对象让日期订单正常工作。最后我意识到我必须设置

```
camlQuery.DatesInUtc = true; 
```

在我看来，如果您使用本机对象模型和 SPQuery 对象，那么当您使用 ClientOM 移动到 CamlQuery 对象时，SharePoint 默认将该日期解释为 UTC（在我们的环境中），您需要设置此参数。

# content-management-system - joomla - 如何更改链接中的子目录？

> ID：593874
> 
> 赞同：0
> 
> 时间：2009-02-27T07:42:41.323
> 
> 标签：content-management-system, joomla

我在 localhost 的子目录“joomla”下创建了我的网站。现在，我已将此网站移植到另一个子目录“testing”下的托管服务器。这样做之后，每当我使用任何创建的菜单项时，他们都会尝试在“joomla”文件夹下找到一个页面，而不是“testing”

所以链接类似于[http://www.mydomain.com/joomla/articleid=](http://www.mydomain.com/joomla/articleid=) ... 而不是[http://mydomain.com/testing/articleid=](http://mydomain.com/testing/articleid=) ...

我应该对哪个文件进行此更改以及在文件中的哪个位置？我尝试查看 configuration.php，但不知道应该在哪里进行更改。

这只是主页上使用的菜单的问题（我的主页是自定义页面）我还注意到主页不直接访问 /testing/images 文件夹中的图像。我必须明确地将 /testing 添加到图像 src。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T00:48:46.043

在`configuration.php`文件中查找。您必须更改几个变量：

在 Joomla 1.0 中：

```
$mosConfig_absolute_path = 'C:/webroot/joomla';
$mosConfig_cachepath = 'C:/webroot/joomla/cache';
$mosConfig_live_site = 'http://localhost/joomla';
// change to:
$mosConfig_absolute_path = '/home/username/www/testing';
// of course, use your own path here - find it out with php_info()
$mosConfig_cachepath = '/home/username/www/testing/cache';
$mosConfig_live_site = 'http://www.mydomain.com/testing'; 
```

在 Joomla 1.5 中：

```
var $log_path = '/home/username/www/testing/logs';
var $tmp_path = '/home/username/www/testing/tmp';
var $live_site = 'http://www.mydomain.com/testing'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T18:31:32.117

如果您要多次执行此迁移，我建议使用像[joomlapack](http://www.joomlapack.net/news/releases/jp21stable.html "Joomlapack")这样的备份/迁移工具- 它使从本地主机迁移到生产环境的任务不到 2 分钟。在传输中也包括数据库和模块/组件。从 localhost 中的一个目录结构移动到生产中的另一个目录结构没有问题。

# user-interface - UI 是否应该显示不可用的操作？

> ID：593875
> 
> 赞同：18
> 
> 时间：2009-02-27T07:42:44.613
> 
> 标签：user-interface, usability

当前被认为是 UI 设计中用于显示当前上下文中不可用的操作的最佳实践。

例如，A 页面显示可以拥有许多关联合同的客户。如果有有效合同，我不希望允许用户删除客户。从可用性和 UI 的角度来看，什么被认为是最适合用户体验的。

1.  始终显示删除选项，但在用户选择它时警告用户该选项不可用，因为有活动合同。
2.  显示删除选项，但将其变灰。
3.  根本不显示删除选项

始终显示选项具有一致性的好处，并且相关操作始终在同一个地方等，但相反，向他们展示他们不能做的事情的意义何在。

将选项灰显仍然具有一致性，但不允许他们选择他们无法执行的操作。

完全不显示选项缺乏一致性，但可能不会那么混乱。

在昨天之前，我什至不会问这个问题，而是直接选择选项 2（灰色）但是看到用户多次尝试点击灰色的图像并最终问我为什么他们不能点击按钮我不再确定最好的选择是什么。

有可用性和 UI 测试经验的人觉得什么是最好的选择？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-27T07:48:25.740

我的方法（和建议）是根据您的选项 #2将按钮**变灰。**

当 UI 稀疏且有足够的可用空间时，具有内联（预先）上下文提示（例如 Freddy 建议的问号方法，在按钮旁边，内联详细说明问题，例如始终显示在禁用状态下按钮“没有要删除的用户。通过转到（链接）此选项卡（/链接）添加一些用户！”）可能是可取的。

然而，这种偶尔出现的内嵌提示或问号会使布局复杂化，或在房地产价格昂贵时妨碍界面的有效性。在这种情况下，最好有**一个覆盖提示**（气球或工具提示），当悬停在禁用按钮*上以及*单击禁用按钮时（即用户通过用他的接近禁用按钮来显示意图） /她的光标）；提示应该解释为什么按钮被禁用和变灰，即“没有用户可以删除”。

以上应该照顾所有（典型的和病理的）病例。它结合了您的#2 和#3 选项的优点，希望没有任何缺点。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-27T10:19:12.040

Raymond Chen（旧新事物成名）提供了很好的指导：

[什么时候禁用一个选项，什么时候删除它？](https://devblogs.microsoft.com/oldnewthing/20040514-00/?p=39343)

从博客条目：

> 实验表明，如果显示某些内容但被禁用，用户希望如果他们修补得足够多，他们将能够启用它。因此，如果用户可以执行某些操作以使操作可用，则保留显示但禁用的菜单项。例如，在媒体播放程序中，如果媒体文件没有播放，则停止播放的选项会被禁用。但是一旦开始播放，该选项就会再次可用。
> 
> 另一方面，如果由于用户无法控制的原因该选项不可用，则将其删除。否则用户会疯狂寻找启用它的神奇方法。例如，如果打印机不能打印颜色，则不要显示任何颜色管理选项，因为用户无法使用您的程序使该打印机成为彩色打印机。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T07:45:30.520

我总是被教导从 UI 中删除对象比禁用对象更令人不安。不要为无法帮助的 0.01% 的人设计！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T07:51:32.550

无论处于何种特定状态，您都希望您的 UI 保持一致。许多用户依靠视觉记忆来记住命令的位置。每次都必须搜索特定的操作太费力了，并且正在将用户的注意力从他们在应用程序中的主要工作中吸引过来。

因此，最好显示动作以将其保留在视觉上下文中。但是，明显表明此操作的状态已修改。这将给用户反馈该操作存在，同时仍然建议需要满足某些条件以允许用户执行命令。

更改颜色饱和度是表示禁用状态的最常用方法。它使 UI 元素在背景中淡出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T08:32:17.817

我建议选项1）。我会告诉你为什么。

选项 3）（最差） *“根本不显示删除选项”* 这甚至不会让用户意识到甚至存在这样的功能。所以这是更糟糕的否认方式。

选项 2） *“显示删除选项但将其变灰”*

比 3) 好，但用户可能会一直想知道为什么他被拒绝了该功能。他也可能开始认为他不是特权用户并且缺乏权利。

选项1） *“始终显示删除选项，但在用户选择该选项时警告用户该选项不可用，因为有活动合同。”*

这将清楚地告诉用户缺少什么并让他了解确切的功能。用户总是乐于在一个不会让他们困惑的透明系统上工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T16:38:14.967

对于这种特殊情况，选项 2 是最佳选择。在决定是否隐藏或禁用某些内容时，我遵循的一般规则是：

> 如果用户无法执行某项操作并且他们可以采取一些措施来启用它，那么它应该被禁用。
> 
> 如果用户无法执行某个操作并且他们无法启用它，那么它应该被隐藏*。*

在您的示例中，如果用户摆脱了活动合同，那么他们可以删除客户。所以删除操作应该被禁用，因为他们可以控制启用它。但是，假设用户无法删除客户，因为他们没有“删除客户”权限。在这种情况下，应该隐藏删除操作，因为用户无法执行任何操作来删除客户（他们不能授予自己权限）。

无论何时禁用某个选项，都应该清楚需要做什么才能启用它。在此示例中，当用户将鼠标移到删除按钮上时，他们应该会看到一个工具提示，解释为什么禁用该操作。

On a side note…if users are trying to click your disabled buttons, it may not be obvious enough that the buttons are disabled. Try changing the style of the buttons so there is a greater distinction between enabled and disabled (assuming you are not using standard controls).

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-27T07:44:31.363

对于这种情况，请使用 2，但除此之外还要添加一个问号来解释它被禁用的原因。 **更新 1：**请注意，它让您有机会真正清楚何时激活/禁用它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-27T07:44:56.950

我更喜欢显示选项，但显示为灰色。这就是为什么。如果某个操作有时可用，有时不可用，那么 UI 就会变得混乱。有时我可以看到删除，有时看不到，这似乎很神奇。另一方面，如果它是灰色的，至少我知道以后在哪里寻找该选项。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T08:35:24.860

只需应用**[最小惊喜原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)**：不要做任何意想不到的事情。

灰色选项显然意味着它在当前上下文中不可用。
缺少的选项可能意味着任何事情。

当您的应用程序提供多个级别的可访问性（例如，新手、中级、专家）或当用户帐户遵循某些安全角色时，您会考虑完全从视线中移除 UI 元素。例如，访问“经理”用户会访问的完整界面。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T08:14:12.150

有时删除工具栏按钮是正确的方法，但通常是这样。

删除它只会让用户想知道它在哪里。然而，禁用让用户知道它在哪里，但它不可用。因此，与其浪费时间试图查看选项在哪里，他们可以花时间找出为什么它不可用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T09:03:53.950

第二个选项，灰色删除选项应该足够了。正如建议的那样，添加一个问号来解释对我来说似乎是个好主意。否则，用户可能不知道为什么他可以删除一些客户，而有些则不能。

但是你总是要考虑，当用户 A 已经打开 UI 时，在启用删除选项的情况下，用户 B 输入了一个新的活动合约的可能性。所以如果用户 A 想删除客户端，你仍然需要检查是否没有活跃的合约，如果有则显示错误消息。换句话说，您仍然必须实现第一个选项所需的一切。出于这个原因，我可能会选择第一个选项，始终显示使删除选项可见且处于活动状态，以避免代码重复并提供最一致的行为。

# c# - .Net 中的单元测试属性？

> ID：593879
> 
> 赞同：2
> 
> 时间：2009-02-27T07:44:58.273
> 
> 标签：c#, .net, unit-testing, testing

我正在开发一个我想在开源中发布的库。我已经开始为代码编写测试，我想知道我应该如何测试 .Net 对象中的属性。可以说我有以下内容：

```
 public class Person{
    #region variables
    private string _name = String.Empty;
    private string _surname = String.Empty;
    #region properties
    public string Name{
        get{
             return _name;
        }
    }
    public string Surname{
        get{
            return _surname;
        }
        set{
            _surname = value;
        }
    }
} 

```

我有两个与代码相关的问题：

1.  如何对仅具有 getter 的属性进行单元测试（例如示例中的名称）
2.  如何使用 setter 和 getter 对属性进行单元测试（如示例中的姓氏）

我想测试这么简单的属性，因为我已经在其他代码中发现错误是 Itellinsense 执行了错误的自动完成并且属性没有返回正确的变量。

更新：

我不是在谈论示例中的简单属性，它们背后确实有一些逻辑并且很难调试。编写一个使用 setter 来测试 getter 的测试，反之亦然是不好的，因为如果失败，我将不知道应该归咎于哪个方法。我正在使用属性，因为它们被添加为公共变量，后来必须添加更多逻辑。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-01T02:26:47.273

> 不要浪费时间为 getter 和 setter 编写愚蠢的测试。
> 
> 另一个测试可能会设置 Name 然后获取该属性，这样您就可以覆盖 getter 的代码。

你应该测试任何面向公众的东西，包括属性。如果你不测试一个属性，你就会冒有人可能会在其中添加一些逻辑从而破坏功能的风险。

此外，您不应该依赖它在其他测试中进行测试。这会使您的测试变得脆弱，并且更难确定问题出在哪里，因为测试将测试不止一件事。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-27T08:40:28.720

> 如何对仅具有 getter 的属性进行单元测试（例如示例中的名称）

如果你有一个二传手，真的和测试没有什么不同。您只需要找到另一种确定输出的方法。可能在 ctor 中，或对象上其他设置器/操作的结果。

```
[Test]
public void NamePropTest()
{
    Person p = new Person();

    //Some code here that will set up the Person object
    //  so that you know what the name will be

    Assert.AreEqual("some known value...", p.Name);
} 
```

如果我们有 Name 和 SurName 的 setter，但只有 FullName 的 getter，则测试可能如下所示：

```
[Test]
public void NamePropTest()
{
    Person p = new Person();

    p.Name = "Sean";
    p.Surname = "Penn";

    Assert.AreEqual("Sean Penn", p.FullName);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T08:31:08.787

您应该测试属性。还有自动属性！

单元测试是关于确保对程序进行更改，而不是破坏程序。

您最终可能会在某个时候更改属性实现，并且您希望确保程序仍然按预期工作。你用你的测试来做到这一点。

即使您使用自动属性（作为字段/成员变量的替代品），使它们成为属性的原因是为了以防您以后想要更改它们的实现。然后你会希望测试在那里。

**编辑：（**回应shahkalpesh的评论......）

> 如果您要更改实现，测试可能也需要更改。所以，我不知道为什么有人应该测试简单的get/set？

从这个类开始：

```
public class TimeOfDay
{
    public int Hour{get; private set;}
    public int Minute{get; private set;}

    public TimeOfDay(int hour, int minute)
    {
        Hour = hour;
        Minute = minute;
    }
} 
```

更改实现时，测试仍然有效！

```
public class TimeOfDay
{
    public int _minutesSinceMidnight = 0;

    public int Hour
    {
        get { return _minutesSinceMidnight / 60; }
        set { _minutesSinceMidnight = value * 60 + Minutes; }
    }

    public int Minute
    {
        get { return _minutesSinceMidnight % 60; }
        set { _minutesSinceMidnight = Hour * 60 + value; }
    }

    public TimeOfDay(int hour, int minute)
    {
        Hour = hour;
        Minute = minute;
    }
} 
```

加入一些日期和时间算术函数或其他东西，我希望测试表明一切仍然有效......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T08:14:11.543

我认为您应该测试它们，如果您像以前那样编写它们。毕竟你可能会打错东西。

就像

```
var person = New Person();
person.Surname = "test";
Assert.AreEqual("test", person.Surname); 
```

毕竟，TDD 和单元测试一般都是为了避免尽可能多的错误。

如果你不小心写了这个。

```
public class Person{
    #region variables
    private string _name = String.Empty;
    private string _surname = String.Empty;
    #region properties
    public string Name{
        get{
             return _name;
        }
    }
    public string Surname{
        get{
            return _name;
        }
        set{
            _name = value;
        }
    }
} 
```

那么你会有一个错误。

测试自动属性可能价值不大。但这是另一个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T07:50:56.433

这些属性应该在那里，因为您有需要它们的用途。至于这些应该有单元测试，你应该已经覆盖了它们。如果没有需要它们的场景，它们可能根本不应该存在。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T07:52:01.970

据我了解，您不应该测试属性（即那些简单的获取/设置）。

我不确定您使用的是什么版本的 c#。但是，您可以使用自动属性来避免您面临的简单设置/获取问题。

看到这个[链接](http://msdn.microsoft.com/en-us/library/bb384054.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T07:56:26.063

不要浪费时间为 getter 和 setter 编写愚蠢的测试。

另一个测试可能会设置 Name 然后获取该属性，这样您就可以覆盖 getter 的代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T08:15:54.940

> 我的问题与如何编写测试有关。我一直在考虑它，我需要访问私有值以确保属性按预期工作，否则我不知道该怎么做。 [https://stackoverflow.com/users/59332/mandel](https://stackoverflow.com/users/59332/mandel)

好吧……既然你坚持要知道怎么做……

```
[Test]
TestMethod()
{

    Person p = new Person();
    p.Name = "a name";
    p.Surname = "a surname";

    Assert.That(p.Name, Is.EqualTo("a name"));
    Assert.That(p.Surname, Is.EqualTo("a surname"));
} 
```

但是，这仅在您有二传手时才有效....

如果您只有吸气剂，那么我只能想到两种方法可以做到这一点。

1.  提前知道返回值并断言。
2.  使用反射设置值，然后针对该已知值进行断言。

更好的建议是放弃并测试一些真正为您的软件增加价值的有价值的东西。测试 getter 和 setter 绝对是浪费时间，除非它们背后有复杂的事情发生……这种情况很少发生。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-27T09:49:38.957

我认为您的意思是您的 getter-only 属性使用私有字段或其他私有数据。如果您需要设置它们，唯一的方法是通过反射获取它们（请参阅 System.Reflection 中的所有（某些）信息类）。但是，如果这是一个好的做法，还有一个艰难的讨论。

# directx - 可以用 XNA 和 C# 制作真正的游戏吗？

> ID：593883
> 
> 赞同：5
> 
> 时间：2009-02-27T07:46:24.137
> 
> 标签：directx, xna

XNA 和 C# 能否用于创建商业上可行的 PC/XBOX 游戏？

它是用 C# 创建 3D 游戏的最佳方法吗？如果不是，那会是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T07:58:50.253

实际上你可以做到这一点，但它有点棘手。

您需要通过“社区”（XNA Creators Club Online 用户）的批准程序。

您还需要支付 Xbox Live 帐户和 Xbox Live 开发者许可证。

根据 XNA 常见问题解答：

我是否需要 XNA Creators Club 高级会员才能创建游戏？制作 Windows 或 Zune 游戏不需要高级会员资格。但是，您必须是高级会员并且在受支持的地区才能为 Xbox 360 创建游戏、将 Xbox 360 游戏发布到 Xbox LIVE 上的社区游戏或同行评审提交的游戏。

谁可以对 XNA 社区游戏进行同行评审？创作者俱乐部的会员，其高级（付费）帐户信誉良好并且是合法成年人（对于我们目前服务的国家/地区，这意味着 18 岁或以上）。

并且：为什么我的游戏必须经过同行评审？为什么我不能将它发送到 Xbox LIVE 市场？同行评审员帮助创作者编写更好的游戏，并保护游戏玩家免于体验极具攻击性或故障的游戏。如果出现以下情况，同行评审员将拒绝您的游戏：

> *   您的游戏包含禁止内容，这是 Xbox LIVE 服务上不允许的内容
>     
>     
> *   您歪曲游戏内容或游戏宣传材料中的内容
>     
>     
> *   您的游戏的促销内容（例如，盒子艺术、描述、横幅或标题）不适用于 Xbox LIVE 市场上的所有年龄段
>     
>     
> *   游戏崩溃，错误太多，或者在某些方面存在技术缺陷

常见问题解答可以在[这里阅读](http://creators.xna.com/en-US/faq)

如果您想更简单地进行操作，您可以直接使用 DirectX，甚至可以使用其他库，如 SDL（用于 2D 游戏）。实际上，C# 对很多事情都非常有用，并且随着时间的推移它会变得更好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T07:57:48.790

对您的第一个问题的简短回答是，是的。使用 XNA 库创建几乎任何类型的游戏都是完全可能的。它可用于制作简单的 2D 平台游戏，或中等复杂的 3D 射击游戏。
根据游戏的不同，您需要为游戏创建的逻辑量可能会有所不同。

当然，在创建 3D 游戏时，您要么必须创建自己的 3D 引擎，要么亲自动手制作一个。XNA 本身并没有提供开箱即用的引擎。但是，它确实提供了多种工具来帮助您制作自己的引擎。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T08:01:57.297

C# 并不比 C++ 慢多少，但是 C# 的内存管理并不是真正的游戏友好（AAA 风格）。渲染基本上是一样的，因为我猜你将使用 DirectX，所以没有理由不能用 C# 制作像战争机器这样非常专业的游戏（作为我自己的游戏开发者，我已经看过战争机器的源代码，可以直接告诉你）。但是你需要伟大的艺术家。

真正的障碍是，如果您的源代码是 C#，那么您刚刚将自己锁定在其他非微软平台（比如索尼或任天堂）之外，但 GoW 又是微软绑定的 ASFAIK。

* * *

至于 XNA，最畅销的 Arcade/Community Game [Braid](http://braid-game.com/)是用 C++ 编写的，但那是因为作者不想把自己锁在其他平台之外，而且他有很多经验和庞大的代码库。基于 C++

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T08:07:09.843

XNA 主要致力于车库游戏、小团队的小型项目和爱好者。此外，它对于游戏架构和 3D 编程来说是一个非常好的学习工具。但对于商业应用，XLA 和 XDK 之间显然存在巨大差距。

使用 XDK 可以让您访问更深层次的硬件，如果性能是一个问题，这绝对是必须的。此外，大多数商业游戏引擎都是为与 XDK 一起使用而开发的（例如，虚幻引擎）。XDK 的调试和分析系统也是一个了不起的工具，而使用 XLA 则无法使用。

所以是的，使用 XNA 制作商业游戏在技术上是可行的，但现实世界往往更喜欢 XDK。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-01T06:21:16.430

XNA 为您节省了大量与制作游戏相关的低级乏味。对于少数开发不需要将硬件推向极限的游戏的人来说，这可以节省大量时间。然而，大多数 AAA 游戏都需要一些人在硬件上投入大量精力，才能尽可能地突破极限。

话虽如此，你的游戏不一定非要 AAA 级才能在商业上可行或有趣——人们甚至会争辩说它的伤害大于它的帮助。技术很少是制作好游戏的瓶颈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T07:52:06.433

我怀疑你会用它创造下一个战争机器，但 XNA 适用于许多类型的游戏。Xbox Live 上的大多数（全部？）社区游戏都是使用 XNA 创建的。

# .net - .NET HtmlButton 总是触发验证器

> ID：593884
> 
> 赞同：2
> 
> 时间：2009-02-27T07:47:02.153
> 
> 标签：.net, asp.net, validation, htmlbutton

我已经在禁用验证的情况下从 HtmlButton 创建了一个服务器控件。

```
<button runat="server" causesvalidation="false" /> 
```

不是输入按钮！！！

```
<input type="button" runat="server /> 
```

我的表单上有一堆验证器，当我单击 HtmlButton 时，它们仍然运行验证器。如果我使用输入按钮没有问题并且验证器不会运行。

这是预期的行为还是错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T08:06:21.780

我试过了，它按预期工作。我认为你应该检查你的代码，也许你在服务器端启用它。

```
<button runat="server" ID="btnSubmit" causesvalidation="false"
 onserverclick="SubmitButton_Click"></button> 
```

为了克服这个问题，您可以将验证组添加到您的验证中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-07T21:53:58.170

取决于使用验证的位置以及它们是否在同一个组中。您在验证组上添加验证限制。如果它们不在一个组中，则表单向服务器的发布可能会导致它验证控件。

:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-21T14:15:29.020

您所要做的就是设置属性 type="button"。默认必须是提交。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T20:19:37.147

做了一点谷歌搜索后，我想出了这个： http: [//www.nedcomp.nl/support/origdocs/dotnetsdk/cpref/frlrfsystemwebuihtmlcontrolshtmlbuttonclasscausesvalidationtopic.htm](http://www.nedcomp.nl/support/origdocs/dotnetsdk/cpref/frlrfsystemwebuihtmlcontrolshtmlbuttonclasscausesvalidationtopic.htm)

希望能帮助到你 ：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T08:02:51.150

仍然运行验证器——你的意思是客户端、服务器端，还是两者兼而有之？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T14:13:11.660

你的按钮上没有id？这可能会导致一个问题，即它不知道按钮的名称，因此不会为其加载所有属性。远射，但你永远不知道。

# winapi - 如何将可编辑的 ComboBox 添加到 Vista 的 Common Item Dialog？

> ID：593886
> 
> 赞同：5
> 
> 时间：2009-02-27T07:47:32.963
> 
> 标签：winapi, com, windows-vista, combobox

Vista 引入了用于打开和保存文件的新[通用项目对话框，取代了旧的通用文件对话框。](http://msdn.microsoft.com/en-us/library/bb776913.aspx)[可以使用简单的IFileDialogCustomize](http://msdn.microsoft.com/en-us/library/bb775912(VS.85).aspx)接口添加自定义控件。其中之一`ComboBox`是不可编辑的标准。有没有办法创建可编辑`ComboBox`或修改现有的（通过添加`CBS_DROPDOWN`样式）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-26T03:46:17.903

不幸的是，你不能。无法保证您添加的控件`IFileDialogCustomize`是 Win32 控件。（事实上​​，我相信它们不是。）由于它们不是 Win32 控件，因此无需设置`CBS_DROPDOWN`样式。对不起。

# c - OS X Tiger 上的 mprotect API

> ID：593896
> 
> 赞同：3
> 
> 时间：2009-02-27T07:52:23.500
> 
> 标签：c, macos, unix, mprotect, osx-tiger

我正在尝试在 MacOSX 10.4 (tiger) 上使用 mprotect API，我尝试了所有可能的方法，它总是返回 -1，错误码为 13，这意味着在我尝试添加写入权限时“权限被拒绝”一些可执行代码。

相同的代码完全适用于 MacOS X 10.5（豹）。

代码很简单

```
int ret = mprotect((void*)pFunc, 4096, PROT_WRITE | PROT_EXEC); 
```

其中 pFunc 是进程地址空间中加载的任何函数的地址。我尝试在添加 PROT_WRITE 访问权限之前删除 PROT_EXEC，但没有运气。我还尝试将 pFunc 与内存页面大小对齐，也没有运气..

知道如何使它工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T19:16:26.743

您正在尝试从可执行文件中修改 mmap 的内存吗？mprotect 的手册页（在 Linux 上）似乎表明这会阻止您修改（PROT_WRITE）内存位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T14:40:59.607

您没有写入可执行区域的权限。无论如何，你为什么要这样做？

我确信这适用于某些平台，但不是全部。你想做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T00:24:39.353

这是另一个想法。尝试在没有 WRITE 的情况下将其标记为 EXEC。我认为拒绝 write+exec 可能是一项安全功能。

然后要写入它，将其标记为 WRITE 而不是 EXEC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T08:47:05.333

我对OSX一无所知。也就是说，您可以使用马赫函数[vm_protect](http://www.fi.muni.cz/~xholer/macosx/xnu/vm_protect.html)吗？

# c - 从另一个程序执行和捕获一个程序

> ID：593897
> 
> 赞同：5
> 
> 时间：2009-02-27T07:53:12.857
> 
> 标签：c, windows, winapi, console, stdout

在 C 中的 win32 编程中：

在另一个 win32 程序中执行 win32 控制台程序的最佳方法是什么，并让开始执行的程序捕获输出？目前我让程序将输出重定向到一个文件，但我确定我必须能够打开某种管道？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T08:03:36.793

使用[`CreateProcess`](http://msdn.microsoft.com/en-us/library/ms686329(VS.85).aspx)Win32 API 启动子进程。

向它传递一个[`STARTUPINFO`](http://msdn.microsoft.com/en-us/library/ms686331(VS.85).aspx)带有`hStdInput`,`hStdOutput`和句柄的结构，这些`hStdError`句柄设置为您打开的文件句柄（真实文件或内存映射文件都应该工作）。您不需要指定所有三个，您可以只重定向您真正需要的那些；最常见的情况是`hStdOutput`。

如果要与子进程通信（通过`hStdInput`），则需要通过调用等待它初始化[`WaitForInputIdle`](http://msdn.microsoft.com/en-us/library/ms687022(VS.85).aspx)。

# sql - SQL DateDiff 高级用法？

> ID：593898
> 
> 赞同：3
> 
> 时间：2009-02-27T07:54:04.070
> 
> 标签：sql, datediff

我需要计算两个日期之间的 DateDiff（小时），但仅限于工作时间（8:30 - 16:00，无周末）。然后根据下面的示例将此结果放入 Reaction_Time 列。

```
ID 日期 Reaction_Time 过期
1 2003 年 4 月 29 日 15:00:00                      
1 2003 年 4 月 30 日 11:00:00 3:30        
2 2003 年 4 月 30 日 14:00:00                      
2 01.05.2003 14:00:00 7:30 是

```

*注意：我没有检查示例中的日期是否为假期。

我正在使用 SQL Server 2005

这将与一个更大的查询相结合，但现在我只需要这个就可以开始了，我将尝试弄清楚如何自己将它们组合在一起。谢谢您的帮助！

**编辑：**嘿，谢谢大家的回复。但由于 SQL 端解决方案的明显复杂性，我们决定在 Excel 中执行此操作，因为无论如何报表都将移动到该位置。很抱歉给您带来麻烦，但我真的认为它会比这更简单。事实上，我们只是没有时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T09:23:46.337

我建议构建一个用户定义的函数，根据您的规则计算营业时间的日期差异。

```
SELECT
  Id,
  MIN(Date) DateStarted,
  MAX(Date) DateCompleted,
  dbo.udfDateDiffBusinessHours(MIN(Date), MAX(Date)) ReactionTime
FROM
  Incident
GROUP BY
  Id 
```

我不确定你的`Overdue`价值来自哪里，所以我在我的例子中把它省略了。

在函数中，您可以编写比在查询中更具表现力的 SQL，并且不会用业务规则阻塞查询，从而使其难以维护。

一个函数也可以很容易地被重用。扩展它以包括对假期的支持（我在`Holidays`这里考虑一张桌子）不会太难。无需更改难以阅读的嵌套 SELECT/CASE WHEN 构造，就可以进行进一步的改进，这将是替代方案。

如果我今天有时间，我会考虑编写一个示例函数。

* * *

编辑：这里有一些花里胡哨的东西，在周末透明地计算：

```
ALTER FUNCTION dbo.udfDateDiffBusinessHours (
  @date1 DATETIME,
  @date2 DATETIME
) RETURNS DATETIME AS
BEGIN
  DECLARE @sat INT
  DECLARE @sun INT
  DECLARE @workday_s INT
  DECLARE @workday_e INT
  DECLARE @basedate1 DATETIME
  DECLARE @basedate2 DATETIME
  DECLARE @calcdate1 DATETIME
  DECLARE @calcdate2 DATETIME
  DECLARE @cworkdays INT
  DECLARE @cweekends INT
  DECLARE @returnval INT

  SET @workday_s = 510 -- work day start:  8.5 hours
  SET @workday_e = 960 -- work day end:   16.0 hours

    -- calculate Saturday and Sunday dependent on SET DATEFIRST option
  SET @sat = CASE @@DATEFIRST WHEN 7 THEN 7 ELSE 7 - @@DATEFIRST END 
  SET @sun = CASE @@DATEFIRST WHEN 7 THEN 1 ELSE @sat + 1 END 

  SET @calcdate1 = @date1
  SET @calcdate2 = @date2

  -- @date1: assume next day if start was after end of workday
  SET @basedate1 = DATEADD(dd, 0, DATEDIFF(dd, 0, @calcdate1))
  SET @calcdate1 = CASE WHEN DATEDIFF(mi, @basedate1, @calcdate1) > @workday_e
                   THEN @basedate1 + 1
                   ELSE @calcdate1
                   END

  -- @date1: if Saturday or Sunday, make it next Monday
  SET @basedate1 = DATEADD(dd, 0, DATEDIFF(dd, 0, @calcdate1))
  SET @calcdate1 = CASE DATEPART(dw, @basedate1)
                   WHEN @sat THEN @basedate1 + 2
                   WHEN @sun THEN @basedate1 + 1
                   ELSE @calcdate1
                   END

  -- @date1: assume @workday_s as the minimum start time
  SET @basedate1 = DATEADD(dd, 0, DATEDIFF(dd, 0, @calcdate1))
  SET @calcdate1 = CASE WHEN DATEDIFF(mi, @basedate1, @calcdate1) < @workday_s 
                   THEN DATEADD(mi, @workday_s, @basedate1)
                   ELSE @calcdate1
                   END

  -- @date2: assume previous day if end was before start of workday
  SET @basedate2 = DATEADD(dd, 0, DATEDIFF(dd, 0, @calcdate2))
  SET @calcdate2 = CASE WHEN DATEDIFF(mi, @basedate2, @calcdate2) < @workday_s
                   THEN @basedate2 - 1
                   ELSE @calcdate2
                   END

  -- @date2: if Saturday or Sunday, make it previous Friday
  SET @basedate2 = DATEADD(dd, 0, DATEDIFF(dd, 0, @calcdate2))
  SET @calcdate2 = CASE DATEPART(dw, @calcdate2)
                   WHEN @sat THEN @basedate2 - 0.00001
                   WHEN @sun THEN @basedate2 - 1.00001
                   ELSE @date2
                   END

  -- @date2: assume @workday_e as the maximum end time
  SET @basedate2 = DATEADD(dd, 0, DATEDIFF(dd, 0, @calcdate2))
  SET @calcdate2 = CASE WHEN DATEDIFF(mi, @basedate2, @calcdate2) > @workday_e
                   THEN DATEADD(mi, @workday_e, @basedate2)
                   ELSE @calcdate2
                   END

  -- count full work days (subtract Saturdays and Sundays)
  SET @cworkdays = DATEDIFF(dd, @basedate1, @basedate2)
  SET @cweekends = @cworkdays / 7
  SET @cworkdays = @cworkdays - @cweekends * 2

  -- calculate effective duration in minutes
  SET @returnval = @cworkdays * (@workday_e - @workday_s)
                   + @workday_e - DATEDIFF(mi, @basedate1, @calcdate1) 
                   + DATEDIFF(mi, @basedate2, @calcdate2) - @workday_e

  -- return duration as an offset in minutes from date 0
  RETURN DATEADD(mi, @returnval, 0)
END 
```

该函数返回一个`DATETIME`值，表示从日期 0（即`"1900-01-01 00:00:00"`）开始的偏移量。因此，例如 8:00 小时的时间跨度是`"1900-01-01 08:00:00"`25 小时`"1900-01-02 01:00:00"`。函数结果是两个日期之间*的营业时间的时差。*加班无特殊处理/支持。

```
SELECT dbo.udfDateDiffBusinessHours('2003-04-29 15:00:00', '2003-04-30 11:00:00')
--> 1900-01-01 03:30:00.000

SELECT dbo.udfDateDiffBusinessHours('2003-04-30 14:00:00', '2003-05-01 14:00:00')
--> 1900-01-01 07:30:00.000 
```

该函数假定下一个可用工作日 (08:30 h) 的开始时间是非工作`@date1`时间，而上一个可用工作日 (16:00 h) 的结束时间`@date2`是非工作时间。

“下一个/上一个可用”是指：

*   如果`@date1`是`'2009-02-06 07:00:00'`(Fri)，它将变成`'2009-02-06 08:30:00'`(Fri)
*   如果`@date1`是`'2009-02-06 19:00:00'`（星期五），它将变成`'2009-02-09 08:30:00'`（星期一）
*   如果`@date2`是`'2009-02-09 07:00:00'`(Mon)，它将变成`'2009-02-06 16:00:00'`(Fri)
*   如果`@date2`是`'2009-02-09 19:00:00'`（星期一），它将变成`'2009-02-09 16:00:00'`（星期一）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T10:21:50.487

```
DECLARE @BusHourStart DATETIME, @BusHourEnd DATETIME
SELECT @BusHourStart = '08:30:00', @BusHourEnd = '16:00:00'
DECLARE @BusMinutesStart INT, @BusMinutesEnd INT
SELECT @BusMinutesStart = DATEPART(minute,@BusHourStart)+DATEPART(hour,@BusHourStart)*60, 
@BusMinutesEnd = DATEPART(minute,@BusHourEnd)+DATEPART(hour,@BusHourEnd)*60 
DECLARE @Dates2 TABLE (ID INT, DateStart DATETIME, DateEnd DATETIME)
INSERT INTO @Dates2
SELECT 1, '15:00:00 04/29/2003', '11:00:00 04/30/2003' UNION
SELECT 2, '14:00:00 04/30/2003', '14:00:00 05/01/2003' UNION
SELECT 3, '14:00:00 05/02/2003', '14:00:00 05/06/2003' UNION
SELECT 4, '14:00:00 05/02/2003', '14:00:00 05/04/2003' UNION
SELECT 5, '07:00:00 05/02/2003', '14:00:00 05/02/2003' UNION
SELECT 6, '14:00:00 05/02/2003', '23:00:00 05/02/2003' UNION
SELECT 7, '07:00:00 05/02/2003', '08:00:00 05/02/2003' UNION
SELECT 8, '22:00:00 05/02/2003', '23:00:00 05/03/2003' UNION
SELECT 9, '08:00:00 05/03/2003', '23:00:00 05/04/2003' UNION
SELECT 10, '07:00:00 05/02/2003', '23:00:00 05/02/2003' 

-- SET DATEFIRST to U.S. English default value of 7.
SET DATEFIRST 7

SELECT ID, DateStart, DateEnd, CONVERT(VARCHAR, Minutes/60) +':'+ CONVERT(VARCHAR, Minutes % 60) AS ReactionTime
FROM ( 
    SELECT ID, DateStart, DateEnd, Overtime,
        CASE 
            WHEN DayDiff = 0 THEN 
                CASE 
                    WHEN (MinutesEnd - MinutesStart - Overtime) > 0 THEN (MinutesEnd - MinutesStart - Overtime) 
                    ELSE 0 
                    END
            WHEN DayDiff > 0  THEN 
                CASE 
                    WHEN (StartPart + EndPart - Overtime) > 0 THEN (StartPart + EndPart - Overtime) 
                    ELSE 0 
                    END + DayPart
            ELSE 0
        END AS Minutes 
    FROM(
        SELECT ID, DateStart, DateEnd, DayDiff, MinutesStart, MinutesEnd,
                CASE WHEN(@BusMinutesStart - MinutesStart) > 0 THEN (@BusMinutesStart - MinutesStart) ELSE 0 END +
                CASE WHEN(MinutesEnd - @BusMinutesEnd) > 0 THEN (MinutesEnd - @BusMinutesEnd) ELSE 0 END AS Overtime, 
                CASE WHEN(@BusMinutesEnd - MinutesStart) > 0 THEN (@BusMinutesEnd - MinutesStart) ELSE 0 END AS StartPart,
                CASE WHEN(MinutesEnd - @BusMinutesStart) > 0 THEN (MinutesEnd - @BusMinutesStart) ELSE 0 END AS EndPart,
                CASE WHEN DayDiff > 1 THEN (@BusMinutesEnd - @BusMinutesStart)*(DayDiff - 1) ELSE 0 END AS DayPart
        FROM (
                SELECT DATEDIFF(d,DateStart, DateEnd) AS DayDiff, ID, DateStart, DateEnd,  
                DATEPART(minute,DateStart)+DATEPART(hour,DateStart)*60 AS MinutesStart,
                DATEPART(minute,DateEnd)+DATEPART(hour,DateEnd)*60 AS MinutesEnd 
                FROM (
                        SELECT ID,
                                CASE 
                                        WHEN DATEPART(dw, DateStart) = 7 
                                        THEN DATEADD(SECOND, 1, DATEADD(DAY, DATEDIFF(DAY, 0, DateStart), 2))
                                        WHEN DATEPART(dw, DateStart) = 1 
                                        THEN DATEADD(SECOND, 1, DATEADD(DAY, DATEDIFF(DAY, 0, DateStart), 1))
                                ELSE DateStart END AS DateStart,
                                CASE 
                                        WHEN DATEPART(dw, DateEnd) = 7 
                                        THEN DATEADD(SECOND, -1, DATEADD(DAY, DATEDIFF(DAY, 0, DateEnd), 0))
                                        WHEN DATEPART(dw, DateEnd) = 1 
                                        THEN DATEADD(SECOND, -1, DATEADD(DAY, DATEDIFF(DAY, 0, DateEnd), -1))
                                ELSE DateEnd END AS DateEnd FROM @Dates2
                )Weekends
        )InMinutes
    )Overtime
)Calculation 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T09:34:12.567

```
select datediff(hh,@date1,@date2) - 16.5*(datediff(dd,@date1,@date2)) 
```

唯一的问题是它会给你 3:30 作为 3.5 小时，但你可以很容易地解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-04T20:41:00.407

使用此代码：找出日期之间的周末

```
 (
    DATEDIFF(dd, open_date, zassignment_date) + 1 
    - ( (DATEDIFF(dd, open_date, zassignment_date) + 1) 
    -(DATEDIFF(wk, open_date, zassignment_date) * 2) 
    -(CASE WHEN DATENAME(dw,  open_date) = 'Sunday' THEN 1 ELSE 0 END) 
    -(CASE WHEN DATENAME(dw, zassignment_date) = 'Saturday' THEN 1 ELSE 0 END) )) wk_end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T08:30:08.557

假设您有工作日（及其小时数）的参考表，那么我将使用 3 阶段方法（伪 sql）

（首先排除“一天之内”的琐碎示例，因为这简化了逻辑）

```
 -- days that are neither the start nor end (full days)
 SELECT @FullDayHours = SUM(day start to day end)
 FROM   reference-calendar
 WHERE  Start >= midnight-after-start and End <= midnight-before-end

 -- time after the [query start] to the end of the first working day
 SELECT @FirstDayHours = [query start] to day end
 FROM   reference-calandar
 WHERE  start day

 -- time from the start of the last working day to the [query end]
 SELECT @LastDayHours = day start to [query end]
 FROM   reference-calendar
 WHERE  end-day

 IF @FirstDayHours < 0 SET @FirstDayHours = 0 -- starts outside working time
 IF @LastDayHours < 0 SET @LastDayHours  = 0 -- ends outside working time

 PRINT @FirstDayHours  + @FullDayHours + @LastDayHours 
```

显然，如果没有更多上下文，要正确地做有点困难......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-10T17:40:38.963

此功能将为您提供两个给定时间之间的营业时间差异。这将根据日期部分参数返回以分钟或小时为单位的差异。

```
CREATE FUNCTION [dbo].[fnBusinessHoursDateDiff] (@StartTime SmallDatetime, @EndTime SmallDateTime, @DatePart varchar(2)) RETURNS DECIMAL (10,2)
AS 
BEGIN

DECLARE @Minutes        bigint
    ,   @FinalNumber    Decimal(10,2)

-- // Create Minute By minute table for CTE
-- ===========================================================
;WITH  cteInputHours (StartTime, EndTime, NextTime) AS (
    SELECT  @StartTime  
        ,   @EndTime    
        ,   dateadd(mi, 1, @StartTime)
 ),
 cteBusinessMinutes (TimeOfDay, [isBusHour], NextTime) AS(
    SELECT  StartTime [TimeOfDay]
        ,   case when datepart(dw, StartTime) between 2 and 6 and convert(time,StartTime) between '08:30' and '15:59' then 1 else 0 end [isBusHour]
        ,   dateadd(mi, 1, @StartTime)  [NextTime]
    FROM    cteInputHours
    UNION ALL
    SELECT  dateadd(mi, 1, (a.TimeOfDay)) [TimeOfDay]
        ,   case when datepart(dw, a.TimeOfDay) between 2 and 6 and  convert(time,dateadd(mi, 1, (a.TimeOfDay)) ) between '08:30' and '15:59' then 1 else 0 end [isBusHour]
        ,   dateadd(mi, 2, (a.TimeOfDay)) NextTime
    FROM    cteBusinessMinutes a
    WHERE   dateadd(mi, 1, (a.TimeOfDay)) < @EndTime
) 
SELECT  @Minutes = count(*)
FROM    cteBusinessMinutes
WHERE   isBusHour = 1
OPTION (MAXRECURSION 0);

-- // Final Select
-- ===========================================================
SELECT  @FinalNumber = @Minutes / (case when @DatePart = 'hh' then 60.00 else 1 end)

RETURN @FinalNumber 

END 
```

# zend-framework - Zend 框架：Zend_Gdata_ClientLogin 入门

> ID：593904
> 
> 赞同：0
> 
> 时间：2009-02-27T07:56:44.813
> 
> 标签：zend-framework, gdata-api

我知道这很简单，但是我之前没有使用过 Zend_Gdata，所以我需要一些指导。如果我的任何假设不正确，请纠正我。

我在我的域上使用 Google Apps，所以要开始，我想做一些简单的事情，比如列出域上的所有用户。

据我了解，您需要使用，`Zend_Gdata_ClientLogin`而不是`Zend_Gdata_AuthSub`因为我将使用`Zend_Gdata_Gapps`. 这是我到目前为止所得到的：

```
$client = Zend_Gdata_ClientLogin::getHttpClient('admin@mydomain.com', 'password');
$gdata = new Zend_Gdata_Gapps($client, 'mydomain.com');
$users = $gdata->retrieveAllUsers(); 
```

但是，retrieveAllUsers() 抛出异常并显示此消息：

```
Expected response code 200, got 401 <HTML> <HEAD> <TITLE>Token invalid</TITLE> </HEAD> <BODY BGCOLOR="#FFFFFF" TEXT="#000000"> <H1>Token invalid</H1> <H2>Error 401</H2> </BODY> </HTML> 
```

这意味着什么？我究竟做错了什么？我不知道这是否重要，但我在本地运行这个 PHP 脚本，但我的 Google Apps 在远程服务器上运行。我正在使用 Zend Framework 1.7.5 版。

**更新：**如果有人想知道，我在执行此操作时遇到了更多问题。我发现为了使用 Zend_Gdata，您必须在 Google Apps 的管理部分启用“Provisioning API”。我发现我只有标准（免费）版本的 Google Apps，这意味着我无法使用 Provisioning API，除非我拥有 Google Apps 的高级（付费）版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T09:03:18.600

您缺少服务参数，对于 Google Apps，它是`'apps'`

```
$client = Zend_Gdata_ClientLogin::getHttpClient('admin@mydomain.com', 'password','apps'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T08:41:34.633

我一直在学习如何访问谷歌电子表格并通过了 $service。

```
$service = Zend_Gdata_Spreadsheets::AUTH_SERVICE_NAME;
$client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service); 
```

# postgresql - 在 psql 中重命名数据库

> ID：593905
> 
> 赞同：34
> 
> 时间：2009-02-27T07:56:47.480
> 
> 标签：postgresql

任何人都可以帮我从 Linux shell 重命名 postgresql 中的数据库吗

```
ALTER DATABASE name RENAME TO newname 
```

上面的语句不执行

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-08-17T15:25:01.663

这可能是一个愚蠢的显而易见的问题。您是否以 postgres 用户身份运行 psql？

例如

```
$ sudo -u postgres psql
# alter database FOO rename to BAR;
# \q 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-27T09:09:40.100

哪个版本的postgresql？从[8.1 文档](http://www.postgresql.org/docs/8.1/static/sql-alterdatabase.html)：

> 更改数据库名称重命名为新名称；
> 
> 只有数据库所有者或超级用户可以重命名数据库；非超级用户所有者还必须具有 CREATEDB 权限。当前数据库无法重命名。（如果需要，请连接到不同的数据库。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-27T08:06:11.233

您可能需要 renmae db 的特权。只有数据库所有者或超级用户可以这样做，所有者还需要一个 createdb priv。

您连接的数据库也无法重命名，您需要连接到另一个数据库

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-25T20:53:38.550

您不能重命名您连接到的数据库。确保在更改 dbname 之前已断开连接。在 PGAdmin 中，您只需右键单击数据库本身，转到属性，然后从那里重命名。正如其他人指出的那样，您也可以尝试以下命令：ALTER DATABASE (DB NAME) RENAME TO (NEW DB NAME);

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-07-19T08:18:40.003

断开数据库（`Ctrl + F2`在 DataGrip 中）

接着：

```
$ psql -U postgres
postgres=# ALTER DATABASE db_a RENAME TO db_b; 
```

总帐

* * *

## 回答 #6

> 赞同：-12
> 
> 时间：2013-10-08T04:50:00.170

下面给出了在 postgresql 中重命名数据库的步骤。

> 1）右键单击数据库并选择刷新。
> 2）再次右键单击并选择属性选项。
> 3) 在属性选项卡下，您可以将名称更改为您想要的名称。

# visual-studio - 在 VisualStudio 中使用 Makefile 的好技巧？

> ID：593906
> 
> 赞同：6
> 
> 时间：2009-02-27T07:56:48.650
> 
> 标签：visual-studio, build-process, makefile

我知道构建项目的理想方式是不需要基于 IDE 的项目文件，因为理论上它会导致各种自动化问题以及其他问题。但是我还没有在不依赖于 VisualStudio 项目的 Windows 上编译的项目上工作（好吧，很明显，一些开源的东西是用 Cygwin 完成的，但我在这里很笼统）。

另一方面，如果我们只是使用 VS 来运行一个 makefile，我们就会失去编译选项窗口的所有好处，并且维护外部 makefile 变得很痛苦。

那么使用 VS 的人实际上是如何处理外部 makefile 的呢？我还没有找到一个无痛的系统来做到这一点......

或者实际上大多数人不这样做，尽管它被宣扬为良好的做法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T20:17:23.887

看看 MSBuild！

*   MSBuild 可以使用 VS 中的 sln/csproj 文件，因此对于简单的项目，您可以直接调用它们。
*   如果您需要更多控制，请将项目包装在您自己的构建过程中，添加您自己的任务等 - 它非常可扩展！

（我想添加一个示例，但这个编辑器完全搞砸了 XML ......对不起）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T14:06:08.060

理想情况下也许，实际上没有。

Makefile 将是我作为构建大师的首选，但是，开发人员将所有时间都花在了 Visual Studio IDE 中，当他们进行更改时，它是针对 vcproj 文件，而不是 makefile。因此，如果我使用 makefile 进行全局构建，那么它很容易与 8 或 10 个其他人正在使用的项目/解决方案文件不同步。

我可以与整个团队保持同步的唯一方法是直接在我的构建过程脚本中对解决方案文件运行 devenv.exe。

我的构建中很少有 makefile，它们位于预构建或自定义构建部分或单独的实用程序项目中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T17:28:21.063

一种可能性是使用[CMake](http://www.cmake.org/cmake/help/examples.html) - 您使用脚本描述如何构建项目，然后 CMake 会为您生成 Visual Studio 解决方案/项目文件。

如果您需要从命令行或在持续集成工具中构建项目，您可以使用 CMake 为 NMake 生成 Makefile。

如果您的项目是一个**跨平台**的项目- 您可以运行 CMake 为您选择的工具链生成 makefile。

一个简单的 CMake 脚本如下所示：

```
project(hello)
add_executable(hello hello.cpp) 
```

将这两行与生成文件或在您喜欢的 IDE 中设置简单项目的方式进行比较。

简而言之，CMake 不仅可以**跨平台**启用您的项目，还可以使其成为**跨 IDE**。如果您只想使用 eclipse 或 KDevelop 或代码块测试您的项目，只需运行 CMake 以生成相应的项目文件。

好吧，在实践中并不总是那么容易，但是 CMake 的想法就是摇滚。

例如，如果您考虑将 CMake 与 Visual Studio 一起使用，则需要进行一些调整才能获得熟悉的 VS 项目感觉，主要障碍是组织您的头文件和源文件，但这是可能的 - 检查 CMake wiki（并通过写一个简短的脚本，您甚至可以简化此任务）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T08:14:07.893

我们使用 NAnt 脚本，它在编译步骤调用 MSBuild。使用 NAnt 允许我们执行构建前和构建后的任务，例如设置版本号以匹配源代码控制修订号、整理代码覆盖率信息、组装和压缩部署源。但是，它的核心仍然是 MSBuild 实际上在进行编译。

您可以将 NAnt 构建作为自定义工具集成到 IDE 中，以便在构建或持续集成服务器上以及开发人员以相同的方式使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T08:34:01.307

就个人而言，我使用[Rake](http://rake.rubyforge.org/)在我的解决方案或项目上调用[msbuild 。](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)对于常规开发，我使用 IDE 以及它提供的所有好处。

[设置Rake](http://rake.rubyforge.org/)以便我可以编译、编译和运行测试或编译运行测试并创建可部署的工件。

一旦你有了一个构建脚本，就很容易开始做一些事情，比如设置持续集成并使用它来自动化部署。

如果您[按照以下步骤进行设置，](http://weblogs.asp.net/bsimser/archive/2006/06/06/Simple-NAnt-integration-with-Visual-Studio.aspx)您还可以使用 IDE 中的大多数构建工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T02:23:16.233

我们使用 devenv.exe（启动 IDE 的同一个 exe）从构建脚本（或命令行）构建我们的项目。指定 /Build 选项时，不会显示 IDE，所有内容都会写回控制台（如果指定 /Out 选项，则写回日志文件）

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/xee0c8y7(VS.80).aspx](http://msdn.microsoft.com/en-us/library/xee0c8y7(VS.80).aspx)

例子：

devenv.exe [解决方案文件名] /Build [项目名称] /Rebuild "Release|Win32" /Out solution.log

其中“Release|Win32”是解决方案中定义的配置，solution.log 是获取编译器输出的文件（当您需要找出编译中出了什么问题时，这非常方便）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-22T03:05:30.903

我们有一个程序可以解析 vcproj 文件并从中生成 makefile 片段。（这些包括文件列表和#defines，并且对自定义构建步骤有一些有限的支持。）然后这些片段被包含在一个主makefile中，它执行通常的GNU make的东西。

（这都是针对我们的目标系统之一；它的工具没有对 Visual Studio 的本机支持。）

这不需要大量的工作。设置一天，然后总共可能一两天来解决一些不立即明显的问题。它工作得相当好：编译器设置由主 makefile 控制（不再摆弄那些小文本框），但任何人都可以以通常的方式添加新文件和定义到构建中。

也就是说，Visual Studio 处理构建配置所固有的组合问题仍然存在。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-28T11:08:35.343

为什么要拥有“在不依赖于 VisualStudio 项目的 Windows 上编译”的项目？您已经有一个解决方案文件 - 您可以将它与控制台构建一起使用。

如果您的构建系统不像我们的那样复杂，我建议您将 msbuild 与 makefile、nant 甚至简单的批处理文件结合使用...

有什么我想念的吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T11:19:43.383

这段代码怎么样？

```
public TRunner CleanOutput()
{
    ScriptExecutionEnvironment.LogTaskStarted("Cleaning solution outputs");

    solution.ForEachProject(
        delegate (VSProjectInfo projectInfo)
            {             
                string projectOutputPath = GetProjectOutputPath(projectInfo.ProjectName);

                if (projectOutputPath == null)
                    return;

                projectOutputPath = Path.Combine(projectInfo.ProjectDirectoryPath, projectOutputPath);

                DeleteDirectory(projectOutputPath, false);

                string projectObjPath = String.Format(
                    CultureInfo.InvariantCulture,
                    @"{0}\obj\{1}",
                    projectInfo.ProjectName,
                    buildConfiguration);
                projectObjPath = Path.Combine(productRootDir, projectObjPath);
                DeleteDirectory(projectObjPath, false);
            });

    ScriptExecutionEnvironment.LogTaskFinished();
    return ReturnThisTRunner();
}

public TRunner CompileSolution()
{
    ScriptExecutionEnvironment.LogTaskStarted ("Compiling the solution");

    ProgramRunner
        .AddArgument(MakePathFromRootDir(productId) + ".sln")
        .AddArgument("/p:Configuration={0}", buildConfiguration)
        .AddArgument("/p:Platform=Any CPU")
        .AddArgument("/consoleloggerparameters:NoSummary")
        .Run(@"C:\Windows\Microsoft.NET\Framework\v3.5\msbuild.exe");

    ScriptExecutionEnvironment.LogTaskFinished ();
    return ReturnThisTRunner ();
} 
```

你可以在这里找到它的其余部分：[http ://code.google.com/p/projectpilot/source/browse/trunk/Flubu/Builds/BuildRunner.cs](http://code.google.com/p/projectpilot/source/browse/trunk/Flubu/Builds/BuildRunner.cs)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-28T16:37:28.080

我自己还没有尝试过，但微软有一个名为 NMake 的 Make 实现，它似乎有一个 Visual Studio 集成：

*   [NMake](http://msdn.microsoft.com/en-us/library/dd9y37ha(VS.80).aspx)
*   [创建 NMake 项目](http://msdn.microsoft.com/en-gb/library/txcwa2xx.aspx)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-28T19:18:44.213

从 VS2005 开始，Visual Studio 使用“msbuild”来定义和运行构建。当您在 Visual Studio 设计器中摆弄项目设置时 - 假设您打开或关闭 XML 文档生成，或者添加新依赖项，或者添加新项目或程序集引用 - Visual Studio 将更新 .csproj（或 . vbproj 等）文件，这是一个 msbuild 文件。

与之前的 Java ant 或 Nant 一样，msbuild 使用 XML 模式来描述项目和构建。当您进行“F6”构建时，它会从 VS 运行，您也可以从命令行运行它，而无需打开 VS 或运行 devenv.exe。

因此，使用 VS 工具进行开发，使用命令行 msbuild 进行自动构建 - 相同的构建和相同的项目结构。

# apache - 使用 htaccess 限制 IP

> ID：593922
> 
> 赞同：14
> 
> 时间：2009-02-27T08:06:28.847
> 
> 标签：apache, .htaccess, restriction

我想以只有两个 IP 可以进入该站点的方式限制整个站点。我的 .htaccess 中有以下内容（在站点的根目录）：

```
ErrorDocument 403 http://www.example.com/views/error403.html

Order Deny,Allow
Deny from all
Allow from 311.311.311 322.322.322.322

ErrorDocument 404 /views/error404.html
ErrorDocument 500 views/error500.html 
```

（显然，这些是假 IP，在我的 .htaccess 中它们是正确的 IP）

如您所见，我只允许 322.322.322.322 和来自 311.311.311.0/24 的所有 IP，而拒绝其他人。我想要的是，当任何人从另一个 IP 进入该站点时，他将查看 error403.html 页面。

过滤器工作正常，但不是重定向。当我尝试从拒绝 IP 进入站点时，我看到一条 Apache 消息：

```
Found
The document has moved here 
```

“这里”是指向 error403.html 的链接。

我想我什至限制了 error403.html 页面。

我该如何做这个限制，但允许查看错误页面？我是否应该将 error403.html 页面移动到另一个目录（即 /views/error/ ）并将其他 .htaccess 放入其中，允许该文件中的所有 IP？

先感谢您！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T08:09:27.077

是的，你已经回答了你自己的问题。:) 将所有未受保护的页面移动到另一个目录中，该目录本身`.htaccess`包含正确的`Allow`and `Deny`。

# iphone - 从 iPhone 上的 URL 接收数据？

> ID：593923
> 
> 赞同：0
> 
> 时间：2009-02-27T08:06:42.403
> 
> 标签：iphone, http, nsurlconnection, communication

我正在使用 Apple Document 创建一个应用程序。我成功连接到服务器，但我从服务器收到 0 个字节（没有响应数据）。我采取以下步骤：

1.  我创建了一个基于视图的应用程序并添加了一个属性“receivedData”：

    在 ViewController.h 中：

    ```
    @property (nonatomic, retain) NSMutableData *receivedData;
    ```

    在 ViewController.m 中：

    ```
    @synthesize receivedData; 
    ```

2.  ViewController.m 的动作 'ViewDidLoad'，我补充说：

    ```
    receivedData = [NSMutableData alloc];
    ```

3.  在视图中添加一个按钮并为其添加操作：

    ```
    // create the request
    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://..."]
                        cachePolicy:NSURLRequestUseProtocolCachePolicy
                        timeoutInterval:60.0];
    // create the connection with the request
    // and start loading the data
    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (theConnection) {
    // Create the NSMutableData that will hold
    // the received data
    // receivedData is declared as a method instance elsewhere
    receivedData=[[NSMutableData data] retain];
    } else {
    // inform the user that the download could not be made
    }
    ```

当我调试这些代码时，我发现 receivedData 返回 0 个字节。关于出了什么问题的任何想法？对我的代码进行简单修改将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T08:42:31.380

您的代码仅创建 HTTP 连接 - 只有在框架调用委托回调之后（一旦收到 HTTP 响应），数据才会被写入并在 receivedData 中可用。[您可以从Apple 的文档](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)中获取更多信息和示例代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T23:13:28.760

答案与我上次为您回答时相同，在[我如何在 iPhone 上从 URL 接收数据？](https://stackoverflow.com/questions/593474/how-to-receive-data-from-url-on-iphone/593557#593557). 我给出了详细的解释——你读了吗？

# python - 如何使用 Python 和 PIL 找到颜色相似的图像？

> ID：593925
> 
> 赞同：3
> 
> 时间：2009-02-27T08:07:21.683
> 
> 标签：python, image-processing, python-imaging-library

我的文件夹中有很多图像，我想找到与预先选择的图像颜色相似的图像。

我希望能够做类似的事情：

```
python find_similar.py sample.jpg 
```

并返回如下内容：

```
234324.jpg
55.jpg
9945.jpg
345434.jpg
104.jpg 
```

这是可行的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T08:23:06.263

我不能给你一个固定的解决方案，但这里有一个角度来解决这个问题。它不是特定于 PIL 的，而且可能完全是假的，因为我没有图像处理方面的经验。

1.  对图像进行[颜色量化。](http://en.wikipedia.org/wiki/Color_quantization)这为您提供了一个调色板，可以在没有任何形状信息的情况下对图像中的颜色信息进行编码。

2.  运行[主成分分析](http://en.wikipedia.org/wiki/Principal_components_analysis)以获取颜色立方体中的主要成分。严格来说，你可以在没有量化的情况下运行它，但它可能太贵了。

3.  对不同图像的主成分进行最小二乘拟合。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T08:13:04.883

[Stackoverflow 上](https://stackoverflow.com/questions/75891/algorithm-for-finding-similar-images)的问题中讨论了查找相似图像的算法，您可能希望在 Python 和 PIL 中实现其中之一。

此外，您可以直接使用`ImageChops`PIL 中的模块并使用该`difference`方法比较两个图像，如下所示：

```
import Image
import ImageChops

im1 = Image.open("original.jpg")
im2 = Image.open("sample.jpg")

diff = ImageChops.difference(im2, im1) 
```

这可能会帮助您了解原始图像与其他图像的差异。

Stackoverflow 上还有另一个[类似的问题](https://stackoverflow.com/questions/189943/how-can-i-quantify-difference-between-two-images)讨论了这一点。

# audio - 在 as2 中动态加载声音有问题

> ID：593928
> 
> 赞同：0
> 
> 时间：2009-02-27T08:08:10.247
> 
> 标签：audio, load, actionscript-2, playback

我想加载放在声音文件夹中的声音。代码是

```
var my_sound = new Sound();
my_sound.loadSound("sounds/sound1.mp3");

my_sound.onLoad = function(success:boolean){

     if(success){
        my_sound.start();
      }
} 
```

这会在 Flash 打开并按 CTRL+ENTER（测试影片）时播放声音。

但是当我们播放 swf 时，它不会播放声音。

对于这个问题，我找到了一个解决方案。

我取消了 onLoad 功能。和测试电影。现在相反的事情发生了。

按 CTRL+ENTER (TestMovie) 时不播放；

但它在播放 swf 时播放。

有没有其他加载声音的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T08:30:19.773

尝试：

```
var my_sound:Sound = new Sound();
my_sound.onLoad = function(success:Boolean)
{
    if (success)
    {
        my_sound.stop();
    } 
};
my_sound.loadSound("sounds/sound1.mp3", true); 
```

这将在加载后立即停止声音。每当您想启动声音时，只需调用此函数：

```
my_sound.start(); 
```

# mysql - MySQL INSERT INTO ... SELECT 抛出错误 1064

> ID：593929
> 
> 赞同：4
> 
> 时间：2009-02-27T08:09:06.547
> 
> 标签：mysql, select, insert

试图复制表中的一些行，但只是将`ssreportid`列从 4 更改为 6：

```
插入到 ssreportparticipant (ssreportid, sssurveyparticipantid)
价值观
选择 6，来自 ssreportparticipant 的 sssurveyparticipantid
哪里 ssreportid = 4

```

错误在“select 6, ...”附近显示 #1064 但如果我只运行 select 子句，它会完美地选择记录，`ssreportid`列中的新 id 为 6。

该表有一个名为 ssreportparticipantid 的主键，并且在 (ssreportid, sssurveyparticipantid) 上有一个唯一键。请注意，select 子句创建具有唯一键对的新记录，所以这不是问题。我尝试在 select 子句周围加上括号，甚至为表格使用两个别名，但并不快乐。

使用服务器版本 5.0.45。

请告诉我，程序员的疲劳让我错过了一个逗号或其他东西。

谢谢，

-乔什

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T08:13:37.987

我认为您应该删除“VALUES”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T08:13:44.320

我不确定，但也许您无法从同一个表中选择插入到表中。您是否尝试过从不同的表中进行选择，只是为了测试？

# c++ - 示例 C++ 测试

> ID：593931
> 
> 赞同：4
> 
> 时间：2009-02-27T08:09:37.187
> 
> 标签：c++, testing

我即将参加 C++ 考试。但我只尝试过一次就超过了 85%。如果我不推动这一点，那么我就不会得到这份工作。

这些测试的问题在于它们通常针对**泛型 C++，**并且根据您使用的库，您对泛型的定义可能会有所不同。STL 和 Boost 对某些人来说似乎是合乎逻辑的（并且应该是大多数人的一部分），但在使用模板之前，我已经使用 MFC 工作了多年。既然可以访问 CArray，为什么还要使用 >vector>？（反问）

如果您使用过未使用过的对话框`stdio`。如果您使用过 Borland 产品，那么您还没有使用过 MFC。如果您使用过 Palm，那么您还没有使用过文件系统，而且您肯定没有使用过`CFile`.

**好的，那么问题来了……**

鉴于我想通过 85%，我正在对“通用”C++ 进行在线测试。所以...**有什么地方我可以去寻找测试吗？** 越多越好。正确的答案也很好，无论是在测试期间还是之后。只要我能从错误中吸取教训。

编辑：如果您的答案没有指向测试、一些 C++ 问题或一些面试问题的链接……您错过了**我可以去寻找测试的地方吗？**

*很好的例子..我刚刚发现了这个问题。
以下代码片段打印什么？ `cout << setw(6) << setfill('#') << "Hello";`
我已经编码 9 年了。并且从未使用过`cout`，`setw`或`setfill`一次。不是从大学开始。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T08:31:06.073

暂时抹掉你脑海中的所有 MFC。去买一本像[The C++ Programming Language](http://www.research.att.com/~bs/3rd.html)这样的书，试着从头到尾学习这些概念。你应该没事。如果他们要求的不止于此，我不想知道他们对“通用”的定义是什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T10:22:53.073

有几次我被*“测试”*（很好地*“接受了采访”*），人们更关心以下问题：

*   什么是面向对象编程？OOA（分析）？OOD（设计）？UML？
*   什么时候应该从一个类继承？什么时候应该聚合一个类？
*   什么是虚方法？什么是纯虚方法？什么是虚表？
*   兄弟演员阵容问题。C类：公共A，公共B；C c; B * b = & c; 如何将对象 b（B* 类型）转换为 A*？
*   当一个简单的程序执行时，堆栈是什么样的？
*   堆/堆栈之间的区别？
*   new() 与 malloc() 有何不同？
*   等等

StackOverflow 和其他地方有很多关于 C++ 面试问题的讨论：

[https://stackoverflow.com/questions/240212/what-is-the-difference-between-newdelete-and-mallocfree](https://stackoverflow.com/questions/240212/what-is-the-difference-between-newdelete-and-mallocfree)

[https://stackoverflow.com/questions/347793/c-areas-you-look-for-during-interview](https://stackoverflow.com/questions/347793/c-areas-you-look-for-during-interview)

[https://stackoverflow.com/questions/365823/what-kinds-of-interview-questions-are-appropriate-for-ac-phone-screen](https://stackoverflow.com/questions/365823/what-kinds-of-interview-questions-are-appropriate-for-a-c-phone-screen)

[http://www.joelonsoftware.com/articles/GuerrillaInterviewing3.html](http://www.joelonsoftware.com/articles/GuerrillaInterviewing3.html)

**在这里加上我的两分钱：** 如果他们正在寻找图形细节......看看你是否记住了整个 C++ 规范......好吧，我知道经济现在很糟糕，但它正在改善，还有其他工作在那里，你**需要**找到其中之一。面试是两条路。如果他们在挑剔细节，这**不是**你想工作的地方。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T08:42:14.563

你可以试试 Herb Sutter 的书[Exceptional C++](http://www.gotw.ca/publications/xc++.htm)；它包含像问题一样组织的项目，在我看来，它非常清晰且写得很好。我不知道它是否会对面试直接有用，但它会让你思考你以前从未考虑过的语言的各个方面。

自从我上次访问以来已经很长时间了，但您也可以通过面试问题尝试这个网站：[geekinterview.com](http://www.geekinterview.com) - 特别看一下[C++ 部分](http://www.geekinterview.com/Interview-Questions/Languages/C-Plus-Plus)。

祝你面试一切顺利:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T12:32:05.183

*以下代码片段打印什么？cout << setw(6) << setfill('#') << "你好";*

它将以下句子打印到标准输出：

> 请不要为我们工作。我们不知道成为一名优秀的软件开发人员意味着什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T10:05:04.287

我找到了这些。

[http://www.acuit.com/_vti_bin/shtml.dll/Test_C++.htm](http://www.acuit.com/_vti_bin/shtml.dll/Test_C++.htm)

[http://www.acetheinterview.com/questions/cats/index.php/algorithm](http://www.acetheinterview.com/questions/cats/index.php/algorithm)

[http://www.faqs.org/faqs/C-faq/faq/](http://www.faqs.org/faqs/C-faq/faq/)

[http://www.coolinterview.com/type.asp?iType=41](http://www.coolinterview.com/type.asp?iType=41)

[http://www.radiussg.com.au/Candidate%20Interview%20Guide.pdf](http://www.radiussg.com.au/Candidate%20Interview%20Guide.pdf)

[http://www.eecs.utoledo.edu/~ledgard/oop/left.html](http://www.eecs.utoledo.edu/~ledgard/oop/left.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T09:00:12.853

[常见问题解答](http://www.research.att.com/~bs/bs_faq2.html)中的一些问题可以作为测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T10:31:34.270

如果您要进行工作测试，那么 Brainbench 测试可能会有所帮助。我猜 C++ 测试是免费的，你可以知道你能得到什么样的问题。

祝考试顺利！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T11:00:08.057

During interviews I bother about the candidate being able to show me that he/she understands what he's/she's doing and that he's/she's leaning toward "modern" C++ (i.e. template intensive).

He/she also needs to understand some subtilities of the languages, but not the most arcane. I don't ask tricky question that are based on the oddities of the language. Why?

STL mastery is a pre-requisite. I see knowing nothing about Boost as a bad sign.

If I were to write a test, I would make it quite easy just to filter the really bad programmers that don't master the syntax and the logic of C++. I however prefer a one hour one-to-one interview to filter candidates.

If you find yourself fighting against a very hard written C++ test : run away.

I hope this helps.

Edit : if you *really* want tests and questions, check this out : [http://www.gotw.ca/gotw/](http://www.gotw.ca/gotw/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-21T22:14:27.923

[这里](http://www.interqiew.com/tests?type=cpp)有一些免费测试，并且他们在 youtube 上有一些问题的解释视频。

# internet-explorer - 使用 jQuery 的自动完成功能在 IE7 中不起作用

> ID：593943
> 
> 赞同：0
> 
> 时间：2009-02-27T08:15:15.253
> 
> 标签：internet-explorer, jquery-plugins, autocomplete

我在同一页面的 2 个地方使用 jQuery 自动完成，一个在页眉中，一个在页面正文中。两者都可以在 Firefox 和 Chrome 中正常工作。但是在 IE 中，标题中的自动完成功能可以正常工作，但正文中的自动完成功能却不行。

有人可以让我知道问题可能是什么以及可能的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-09T00:25:31.650

由于缺乏示例，我只是根据我昨天遇到的 IE7 和 jQuery 自动完成插件的问题进行猜测。

在源代码中，第 281 行附近有一段代码如下所示：

```
if ($.browser.msie) {
    // we put a styled iframe behind the calendar so HTML SELECT elements don't show through
    $results.append(document.createElement('iframe'));
} 
```

将其注释掉，清除浏览器缓存，然后重试。

# c++ - 动态内存分配

> ID：593946
> 
> 赞同：0
> 
> 时间：2009-02-27T08:15:55.470
> 
> 标签：c++, data-structures, memory-management

如何为结构数组动态分配内存......例如：

```
class students
{
    struct stud
        {
           int r_no;
           char name[20];
         }*s; 
} 
```

如何为*s动态分配内存...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T08:22:39.323

首先，这**不是**这样做的方式，例如，您可以使用螺柱向量。使用您拥有的代码，它将类似于：

```
class students
{
public:
    struct stud ... *s;
    students() // ctor
    {
        s = new stud[100]; // say you have 100 students
        // from now on you can use s[0], s[1], etc. in the class
    }
}; 
```

但是，您应该使用的是一种 STL 向量或列表：

```
class students
{
public:
    struct stud ... ;
    std::vector<stud> my_students;
    students() // ctor
    {
        stud aStudent = {0, "Student Name"};
        my_students.push_back(aStudent); // add a new student.
    }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T08:20:00.687

为什么在一个只有指针的类中额外包装结构？

无论如何，在 C 中你会做这样的事情：

```
struct stud
{
  int r_no;
  char name[20];
} *s;

size_t num_students = 4711;

s = malloc(num_students * sizeof *s); 
```

当然，谨慎的做法是确保所有这些单独的结构都已初始化。

如果您的意思是这是 C++，您应该编写处理该问题的构造函数，并使用 new[] 来分配结构数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T10:18:03.773

您应该尽可能使用标准组件。这里 std::string 和 std::vector 会帮助你。

```
struct Student
{
    int r_no;
    std::string name;
};
typedef std::vector<Student> StudentList; 
```

有了这样的方法，就没有必要想知道如何动态分配内存了。一切都照顾好了！

**编辑：**

我只是 typedef'ed StudentList 因为对我来说，向它添加更多功能与问题无关。显然，最后一行可以替换为真正的类定义：

```
class StudentList
{
    public:
        // Add your own functionalities here
    private:
    std::vector<Student> m_students;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T10:43:26.707

```
class students
{
public:
  students(size_t noOfStudents):m_noOfStudents(noOfStudents)
   {
     s = new stud[m_noOfStudents];
   }

   ~students()
   {
     delete s;
   }

private: 
   struct stud
        {
           int r_no;
           char name[20];
         }*s; 

   size_t m_noOfStudents;  
} 
```

# sharepoint - 报告 SharePoint 中的工作流

> ID：593948
> 
> 赞同：1
> 
> 时间：2009-02-27T08:16:50.273
> 
> 标签：sharepoint, sharepoint-2007, shared-libraries, sharepoint-designer, shared-hosting

有没有办法在 SharePoint 中创建报告，我可以在其中查看所有当前工作流和每个工作流的状态？

**编辑：**我需要能够有一个列表或其他东西，我可以在我的 SharePoint 网站中查看我的所有工作流以及状态等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T09:54:13.173

有一些内置的基本报告。查看这篇文章；

[http://office.microsoft.com/en-us/sharepointserver/HA101646711033.aspx](http://office.microsoft.com/en-us/sharepointserver/HA101646711033.aspx)

您还可以使用 Codeplex 中的此工具获得一些可用的自定义工作流的概述；

[http://spworkflowstarter.codeplex.com/](http://spworkflowstarter.codeplex.com/)

# .net - 移动设备上的 OutOfMemoryException

> ID：593951
> 
> 赞同：3
> 
> 时间：2009-02-27T08:21:01.463
> 
> 标签：.net, .net-3.5, memory, windows-mobile, out-of-memory

我正在开发一个使用移动设备拍摄照片并使用网络服务发送的应用程序。但是在我拍了 4 张照片之后，我`OutOfMemoryException`在下面的代码中得到了一个。我试着打电话`GC.Collect()`，但它也没有帮助。也许这里有人可以给我一个如何处理这个问题的建议。

```
public static Bitmap TakePicture()
{
    var dialog = new CameraCaptureDialog
    {
        Resolution = new Size(1600, 1200),
        StillQuality = CameraCaptureStillQuality.Default
    };

    dialog.ShowDialog();

    // If the filename is empty the user took no picture
    if (string.IsNullOrEmpty(dialog.FileName))
       return null;

    // (!) The OutOfMemoryException is thrown here (!)
    var bitmap = new Bitmap(dialog.FileName);

    File.Delete(dialog.FileName);

    return bitmap;
} 
```

该函数由事件处理程序调用：

```
private void _pictureBox_Click(object sender, EventArgs e)
{
    _takePictureLinkLabel.Visible = false;

    var image = Camera.TakePicture();
    if (image == null)
       return;

    image = Camera.CutBitmap(image, 2.5);
    _pictureBox.Image = image;

    _image = Camera.ImageToByteArray(image);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T08:36:17.853

我怀疑你持有参考资料。作为一个次要原因，请注意对话框在使用时不会自行处理`ShowDialog`，因此您应该是`using`对话框（尽管我希望 GC 仍会收集未处理但未引用的对话框）。

同样，您可能应该`using`成为图像，但同样：不确定我是否希望这会成败；值得一试，虽然...

```
public static Bitmap TakePicture()
{
    string filename;
    using(var dialog = new CameraCaptureDialog
    {
        Resolution = new Size(1600, 1200),
        StillQuality = CameraCaptureStillQuality.Default
    }) {

        dialog.ShowDialog();
        filename = dialog.FileName;
    }    
    // If the filename is empty the user took no picture
    if (string.IsNullOrEmpty(filename))
       return null;

    // (!) The OutOfMemoryException is thrown here (!)
    var bitmap = new Bitmap(filename);

    File.Delete(filename);

    return bitmap;
}

private void _pictureBox_Click(object sender, EventArgs e)
{
    _takePictureLinkLabel.Visible = false;

    using(var image = Camera.TakePicture()) {
        if (image == null)
           return;

        image = Camera.CutBitmap(image, 2.5);
        _pictureBox.Image = image;

        _image = Camera.ImageToByteArray(image);
    }
} 
```

我也会对`CutBitmap`等有点谨慎，以确保尽快发布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T08:34:54.987

您的移动设备通常没有任何内存交换到磁盘的选项，因此由于您选择将图像作为位图存储在内存中而不是磁盘上的文件，因此您很快就会消耗手机的内存。您的“new Bitmap()”行分配了大量内存，因此很可能会在那里引发异常。另一个竞争者是您的 Camera.ImageToByteArray，它将分配大量内存。这可能与您习惯使用计算机的情况相比并不大，但对于您的手机来说，这是巨大的

尝试将图片保存在磁盘上，直到您使用它们，即将它们发送到 web 服务。要显示它们，请使用您的内置控件，它们可能是最节省内存的，您通常可以将它们指向图像文件。

干杯

尼克

# security - 如何在 Tomcat 中使用 htpasswd 保护？

> ID：593952
> 
> 赞同：5
> 
> 时间：2009-02-27T08:21:09.000
> 
> 标签：security, tomcat, .htpasswd, security-constraint

我已经使用 Apache 的 htpasswd 命令创建了一个用户数据库文件。这个文件现在被其他几个应用程序使用，比如 apache 和 subversion。

中的用户是这样创建的：

```
htpasswd /path/to/users.htpasswd peter 
```

此用户文件是全局的，而不是每个目录。

如何让 Tomcat 6 使用同一个文件作为安全领域？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-08T07:27:28.467

与 htpasswd 最相似的可能是[MemoryRealm](http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html#MemoryRealm)。我自己很难找到一个如何使用它的简单示例，所以我将在这里发布一个简单的示例代码：

1.  在 tomcat-users.xml 中设置角色、用户名和密码

2.  您的 web.xml 应包含以下内容：

    ```
     <security-constraint>
         <web-resource-collection>
          <web-resource-name> 
            My Protected WebSite 
          </web-resource-name>
          <url-pattern> /* </url-pattern>
          <http-method> GET </http-method>
          <http-method> POST </http-method>
        </web-resource-collection>
        <auth-constraint>
        <!-- the same like in your tomcat-users.conf file -->
          <role-name> test </role-name>
        </auth-constraint>
      </security-constraint>
       <login-config>
        <auth-method> BASIC </auth-method>
        <realm-name>  Basic Authentication </realm-name>
      </login-config>
      <security-role>
        <description> Test role </description>
        <role-name> test </role-name>
      </security-role> 
    ```

3.  将此添加到您的 server.xml 文件中：

    ```
    <Realm className="org.apache.catalina.realm.MemoryRealm"></Realm> 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-10T15:14:54.533

为了保护对 Tomcat webapp 的访问，您可以实现简单的安全约束（例如 in `/var/lib/tomcat7/webapps/*/WEB-INF/web.xml`），如下所示（只需在`</web-app>`结束前添加）：

```
<!-- This security constraint protects your webapp interface. -->
<login-config>
  <!-- Define the Login Configuration -->
  <auth-method>BASIC</auth-method>
  <realm-name>Webapp</realm-name>
</login-config>
<security-constraint>
  <web-resource-collection>
    <web-resource-name>Admin</web-resource-name>
    <url-pattern>/*</url-pattern>
    <http-method>GET</http-method>
    <http-method>POST</http-method>
  </web-resource-collection>
  <auth-constraint>
    <role-name>*</role-name>
  </auth-constraint>
  <!-- Specifying a Secure Connection -->
  <user-data-constraint>
    <!-- transport-guarantee can be CONFIDENTIAL (forced SSL), INTEGRAL, or NONE -->
    <transport-guarantee>NONE</transport-guarantee>
  </user-data-constraint>
</security-constraint>
<!-- Authorization, see: tomcat-users.xml --> 
<security-role>
  <role-name>*</role-name>
</security-role> 
```

> login-config 元素包含`auth-method`指定我们使用的身份验证方法的元素，即`BASIC`. 该`security-constraint`元素包含 3 个元素：`web-resource-collection`、`auth-constraint`和`user-data-constraint`。web-resource-collection 指定了我们应用程序中需要身份验证的部分。`/*`表示整个应用程序需要身份验证。auth-constraint 指定用户需要具有的角色才能访问受保护的资源。用户数据约束的传输保证可以是`NONE`,`CONFIDENTIAL`或`INTEGRAL`. 我们将其设置为`NONE`，这意味着`SSL`当您尝试访问受保护的资源时不需要重定向到。

还要确保你有线：

```
<Realm className="org.apache.catalina.realm.MemoryRealm" /> 
```

在您的`conf/server.xml`(`Engine`部分) 内。

如果您没有更改任何配置文件，请检查`conf/tomcat-users.xml`安装中的文件 ( `locate tomcat-users.xml`)。该文件必须包含允许您使用 Tomcat webapp 的凭据。

例如，要将 manager-gui 角色添加到`tomcat`密码为的用户`s3cret`，请将以下内容添加到上面列出的配置文件中：

```
<role rolename="manager-gui"/>
<user username="tomcat" password="s3cret" roles="manager-gui"/> 
```

然后您可以访问您的 webapps 管理器`/manager/html`（例如在配置更改后重新加载）。

阅读更多：[Manager App HOW-TO](https://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html)。

然后重新启动您的 Tomcat，当访问您的 web 应用程序时，它应该会要求您提供正确的凭据。

也可以看看：

*   Oracle 站点[的 Java 中的 HTTP 基本身份验证](http://docs.oracle.com/cd/E19226-01/820-7627/bncbo/index.html)
*   在 Oracle 站点[用 Java 指定身份验证机制](http://docs.oracle.com/cd/E19226-01/820-7627/bncbn/index.html)
*   [Realm Configuration HOW-TO](https://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html) at Apache Tomcat site
*   [Setting up role based security in tomcat](http://www.thecoderscorner.com/team-blog/hosting-servers/17-setting-up-role-based-security-in-tomcat)
*   [How do I use Basic authentication with Tomcat?](http://www.avajava.com/tutorials/lessons/how-do-i-use-basic-authentication-with-tomcat.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-02T15:01:21.390

有两种选择：

1.  使用 Apache 作为 tomcat 的前端（使用 mod_jk 或 mod_proxy_ajp）并且 Apache 进行身份验证。[您可以在此处](http://httpd.apache.org/docs/2.2/howto/auth.html)找到有关如何执行此操作的详细信息

2.  如果您希望 tomcat 进行身份验证，那么您需要使用除 htpasswd 文件之外的其他内容。有 4 种方法可以保存用户的凭据 - 使用数据库、JNDI/LDAP、XML 文件或 JAAS 提供程序。您可以阅读[Realm Configuration HOW-TO](http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html)中的所有选项。

# jquery - 在 HTML 页面上显示对象数据列表

> ID：593959
> 
> 赞同：0
> 
> 时间：2009-02-27T08:23:59.070
> 
> 标签：jquery, html

我一直在开发一个需要用户输入某些请求数据的 Web 应用程序。捕获此数据后，它将以网格的形式显示，仅显示数据的主要内容，而其余内容仅在用户单击主要内容后才显示。目前，我将数据显示为 JQuery 手风琴，如下所示：

[替代文字 http://img16.imageshack.us/img16/2449/requestlist1.jpg](http://img16.imageshack.us/img16/2449/requestlist1.jpg)

我不知何故觉得使用 Accordion 显示数据列表有点混乱。有什么好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T13:07:12.477

我不明白。下面，折叠的数据与上面有关吗？是亲子关系还是他们是如何归属于彼此的？如果是，您正在寻找某种深入研究，如果不是，手风琴完全没问题。

顺便说一句，使用 jpeg 进行屏幕截图通常很糟糕，您应该使用 png 或其他东西（让我想起了[这一点](http://lbrandy.com/blog/2008/10/my-first-and-last-webcomic/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T13:40:33.957

我认为没有一种合适的方式来显示表格数据。这是您的目标受众的问题。

如果您想显示大量可以快速访问详细信息的项目，手风琴可能是正确的解决方案。如果有很多细节，那么你可以考虑去 Master -> Details。

另一种方法可能是实现一个模态弹出[示例](http://www.ajaxline.com/master-detail-with-the-gridview-details-view-and-jquery-s-thickbox)

无论如何，您可以在这里找到更多灵感：[jquery grid](https://stackoverflow.com/questions/159025/jquery-grid-recommendations)或 [RadGrid](http://demos.telerik.com/aspnet-ajax/grid/examples/groupby/grouploadmodeclient/defaultcs.aspx)。

尝试不同的颜色、字体大小、对用户重要的内容与细节/效果/等之间的更多对比。

# php - 从 JavaScript 运行 PHP 类

> ID：593964
> 
> 赞同：0
> 
> 时间：2009-02-27T08:27:16.580
> 
> 标签：php, javascript, function

我需要从 javascript 函数中触发一个 php 类。

代码：

```
<input type="button" name="Submit" value="Submit" class="opinionbox" 
onclick="verifyControl('<?=$control_no?>')"/>

function verifyControl(rNo) {
 Cont_no=document.getElementById("ContNo").value;
  if(rNo==Cont_no) {
    frames['frame1'].print();
    showPage('payment');
  }
  else if(rNo!=Cont_no) {
    alert("invalid  control no");
  } 
} 
```

我需要运行代码

```
$data = $obj_com -> getSelectedData('tbl',
                      'control_no', $contno);
$control_no = $contno;
$obj_com -> recordPay('tbl',$contno); 
```

在里面我该`verifyControl()`怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T08:36:26.280

您不能从 Javascript “调用” PHP 类，因为 Javascript 运行在客户端（即浏览器），而 PHP 运行在服务器上。但是，您可以做的是异步调用 PHP 脚本，获取其输出，然后使用 javascript 做一些有趣的事情。这被称为 AJAX。如果你打算走这条路，强烈建议你使用像[jQuery](http://www.jquery.com)这样的库并从那里学习。这里有几个问题可以帮助您入门（查看答案）：

*   [如何在javascript中动态调用php函数](https://stackoverflow.com/questions/557778/how-to-dynamically-call-a-php-function-in-javascript)
*   [Javascript 和 PHP 函数](https://stackoverflow.com/questions/221396/javascript-and-php-functions/221983)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T08:41:00.357

To call PHP code from Javascript, given that PHP is executing on the server and Javascript is executing on the client, you will need to set up some sort of interface at the server that can be accessed remotely.

You may also want to be aware of the security implications of doing so. In particular, if you want to ensure that only your users will be calling your server in this way - that is, if a malicious user calling this code could do damage, you will need some sort of authentication.

You will also need to decide on a protocol for communicating between the client and server.

Protocols such as SOAP and XML-RPC define everything you need to remotely call procedures on the server. Or you can roll your own, just by calling a certain URL and receiving a certain result, in a certain format (JSON can help) from the server.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-11T23:04:16.657

you can use [Brent Ashley jsrsClient.js](http://www.ibm.com/developerworks/web/library/wa-resc/) or $.ajax of [jQuery](http://www.jquery.org) Javascript lib.

# linux - 用于在 linux 中显示文本、powerpoint 样式的工具

> ID：593967
> 
> 赞同：1
> 
> 时间：2009-02-27T08:30:53.610
> 
> 标签：linux, text2image

我有一个问题，我需要一种方法来在计算机显示器上显示一系列重复的“图像”。具体来说，给定一系列文本文件，我想要一种在屏幕上以类似于 powerpoint 的方式显示所述文件内容的方法。

我目前的想法是找到一些工具来接收某种格式的文本文件，然后输出包含文件中文本的图像。然后我将它放在一个目录中，并让一些幻灯片程序不断地在该目录中的图像之间移动。显然，这是一个非常hacky的解决方案。

那么，有没有人知道可以做这种事情的工具？还是有更好的方法来做到这一点？我查看了库 libgd2，但它似乎不支持图像的文本换行，这是我需要的。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T09:16:04.560

[MagicPoint](http://member.wide.ad.jp/wg/mgp/)是用于显示演示文稿的工具。演示文稿以简单的纯文本文件格式编写，类似于 HTML。

您可以轻松地自动生成 MagicPoint 文件，然后运行它并显示演示文稿。您还可以从演示文稿中生成 HTML、PS 或 PDF 并显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T08:35:50.587

你在寻找 linux 的 powerpoint 等价物吗？[开放式办公](http://en.wikipedia.org/wiki/OpenOffice.org_Impress)？？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T08:47:26.703

你试过用 TeX 编写一些魔法脚本吗？

像一条链子

```
tex file | dvi2ps | ps2jpg > output 
```

并定义一些 TeX 宏？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-18T05:38:37.763

[炫耀](http://github.com/schacon/showoff)很酷。它使用 Markdown 格式的幻灯片创建一个简单的小 Sinatra 应用程序，您可以运行（使用`showoff serve`），然后在浏览器中查看。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T09:41:48.960

文档工具。见[http://docutils.sourceforge.net/docs/user/slide-shows.html](http://docutils.sourceforge.net/docs/user/slide-shows.html)

文本语法是[reStructuredText](http://en.wikipedia.org/wiki/ReStructuredText)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T08:51:08.957

另一个想法：

文本2gif

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T09:28:37.417

为了补充其他人给出的建议，如果您要编写一个程序来执行此操作，那么直接将文本渲染到屏幕上可能会更有效，而不是先将其转换为图像。它可能在您使用的任何窗口管理器（例如 KDE 或 Gnome）上的全屏窗口中使用画布或文本框组件来完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-18T05:49:10.953

我使用[Opera](http://www.opera.com/)的 @media projection CSS 支持进行演示。在[http://talks.webconverger.com/](http://talks.webconverger.com/)上，您可以找到一个模板和一个示例，您可以在 Opera 的全屏模式下加载并开始滑动。

因此，除了使用熟悉的 HTML 语言编写之外，分享幻灯片甚至让您的观众在您浏览幻灯片时查看幻灯片也非常容易。

如果您正在寻找更华丽的东西，网络上有一些工具可以生成动画等等，而且您只需使用全屏浏览器将其回放给您的观众。

# java - JibX：如何映射一个类并避免它被输出为 XML 节点

> ID：593995
> 
> 赞同：2
> 
> 时间：2009-02-27T08:42:40.163
> 
> 标签：java, xml, data-binding, binding

我使用[JibX](http://jibx.sourceforge.net)作为 Java 对象到 XML 绑定工具。

有了它，我想要以下输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<FEAPService>
    <Request>
        <Function>aaa</Function>
        <SubFunction>bbb</SubFunction>
        <Operation>ccc</Operation>
    </Request>
</FEAPService> 
```

但我得到了这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<FEAPService>
    <Request>
        <baseForm> <!-- I DO NOT WANT THIS baseForm TAG -->
            <Function>aaa</Function>
            <SubFunction>bbb</SubFunction>
            <Operation>ccc</Operation>
        </baseForm>
    </Request>
</FEAPService> 
```

这是 JibX 绑定文件：

```
<binding name="requestBinding_com_struts_form_SpecificForm">
    <mapping name="baseForm" class="com.struts.form.BaseForm">
        <value name="Function" field="function" />
        <value name="SubFunction" field="subFunction" />
        <value name="Operation" field="operation" />
    </mapping>    
    <mapping name="FEAPService" class="com.struts.form.SpecificForm"
        extends="com.struts.form.BaseForm">
        <structure name="Request">
            <structure map-as="com.struts.form.BaseForm" />
        </structure>
    </mapping>
</binding> 
```

我想这可以通过实现我自己的 Marshaller 来实现，但我不确定这是否是最简单的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T17:08:28.387

我设法删除了不需要的 XML 节点，有两种方法：

1.  最简单的方法：只需使用 abstract="true" 属性。
2.  核心方式：实现自己的编组器。

* * *

**第一个选项：**

```
<mapping class="com.struts.form.BaseForm" abstract="true">
        <value name="Function" field="function" />
        <value name="SubFunction" field="subFunction" />
        <value name="Operation" field="operation" />
        <value name="doubleField_part1" field="doubleField" serializer="com.struts.form.BaseForm.doubleFieldDeserializer1" />
        <value name="doubleField_part2" field="doubleField" serializer="com.struts.form.BaseForm.doubleFieldDeserializer2" />
    </mapping> 
```

第二个选项：**实现你自己的 Marshaller**：

```
public class MyMarshaller implements IMarshaller {
    private static final String FUNCTION_ELEMENT_NAME = "Function";
    private static final String SUB_FUNCTION_ELEMENT_NAME = "SubFunction";
    private static final String OPERATION_ELEMENT_NAME = "Operation";

    private String m_uri;
    private int m_index;
    private String m_name;

    public MyMarshaller() {
        m_uri = null;
        m_index = 0;

        m_name = "Function";
    }

    public MyMarshaller(String uri, int index, String name) {
        m_uri = uri;
        m_index = index;
        m_name = name;
    }

    public boolean isExtension(int index) {
        return false;
    }

    public void marshal(Object obj, IMarshallingContext ictx)
            throws JiBXException {

        // make sure the parameters are as expected
        if (!(obj instanceof BaseForm)) {
            throw new JiBXException("Invalid object type for marshaller");
        } else if (!(ictx instanceof MarshallingContext)) {
            throw new JiBXException("Invalid object type for marshaller");
        } else {
            // start by generating start tag for container
            MarshallingContext ctx = (MarshallingContext) ictx;
            BaseForm formBean = (BaseForm) obj;

            /*
             * THIS CODE COULD BE REPEATED FOR ALL FormBean CLASS' ATTRIBUTE USING REFLECTION.
             * And to control which attributes should be marshalled the attributes could follow special nomeclatures.
             * Ex.
             * class FormBean { 
             *    String marshallable_Function;
             *    String non_marshallable_Function;
             * }
             */ 
            writeTag(ctx, formBean.getFunction(), FUNCTION_ELEMENT_NAME);
            writeTag(ctx, formBean.getSubFunction(), SUB_FUNCTION_ELEMENT_NAME);
            writeTag(ctx, formBean.getOperation(), OPERATION_ELEMENT_NAME);
        }
    }

    private void writeTag(MarshallingContext ctx, String value, String entryElementName)
            throws JiBXException {
        ctx.startTag(m_index, entryElementName);
        ctx.closeStartContent();
        ctx.content(value);
        ctx.endTag(m_index, entryElementName);
    }
} 
```

* * *

这是我的**binding.xml**：

```
<binding name="requestBinding_com_struts_form_SpecificForm">
    <mapping class="com.struts.form.BaseForm" marshaller="example8.MyMarshaller" />        
    <mapping name="FEAPService" class="com.struts.form.SpecificForm">
        <structure name="Request">
            <structure map-as="com.struts.form.BaseForm" />
        </structure>
    </mapping>
</binding> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T16:03:06.783

**基础（抽象）没有**名称也很重要。

# java - 如何抑制特定函数的 Java 编译器警告

> ID：593996
> 
> 赞同：27
> 
> 时间：2009-02-27T08:42:45.920
> 
> 标签：java, compiler-construction, warnings, compiler-warnings, suppress-warnings

我们总是被教导要确保在 switch 语句中使用*中断*来避免失败。

Java 编译器会针对这些情况发出警告，以帮助我们避免犯微不足道的（但严重的）错误。

但是，我将使用案例失败作为一个功能（我们不必在这里深入探讨，但它提供了一个非常优雅的解决方案）。

但是，编译器会吐出大量警告，这些警告可能会掩盖我需要了解的警告。我知道如何更改编译器以忽略所有失败警告，但我想逐个方法实现这一点，以避免错过我不打算发生失败的地方。

有任何想法吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-27T08:49:21.800

如果您真的必须这样做，并且您确定自己没有犯错，请查看[@SuppressWarnings 注释](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/SuppressWarnings.html)。我想在你的情况下你需要

```
@SuppressWarnings("fallthrough") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T08:49:58.523

注释`@SuppressWarnings`( [javadoc](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/SuppressWarnings.html) ) 是您要查找的吗？

例如：

```
@SuppressWarnings("unchecked")
public void someMethod(...) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T08:56:06.247

要完成有关的其他答案[`SuppressWarnings`](http://java.sun.com/javase/6/docs/api/java/lang/SuppressWarnings.html)：

```
@SuppressWarnings("fallthrough") 
```

尝试在编译器级别抑制所有失败警告是一件坏事：正如您所解释的，清楚地确定了需要通过警告的情况。因此，它应该明确地写在代码中（`@SuppressWarnings("fallthrough")`带有可选注释的注释是受欢迎的）。这样做，如果您真的忘记了代码中其他地方的中断，您仍然会收到失败警告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-05T15:46:07.173

您可以创建一个“if”语句结构来代替开关。可能在视觉上不那么令人愉悦，但警告抑制也不是。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-13T11:32:23.630

```
@SuppressWarnings("fallthrough") 
```

Java 一直遵循 C 风格的 switch 语句，在这种情况下，您需要显式地跳出 switch，除非您希望简单地通过并执行以下案例中的代码。当然，这可能很危险，而且这类错误很难追查。在以下示例中，案例 1 缺少中断：

```
@SuppressWarnings("fallthrough")
public void fallthroughTest(int i)
{
    switch (i)
    {
        case 1:
            // Execute both 1 and 2
        case 2:
            // Execute only 1
    }
} 
```

# linq - .在 LazyList 上不起作用的地方

> ID：593998
> 
> 赞同：0
> 
> 时间：2009-02-27T08:43:42.173
> 
> 标签：linq

我正在使用 Rob 的 LazyList 实现，它运行良好。

但是，我无法在 LazyList 类型的子实体上使用 .where 子句。

例如。就像是

```
var qry = orderRepository.GetOrders();
qry = from p in qry where p.Items.Where(t => t.Name == "test") select p; 
```

产生以下编译时错误：

```
Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<Items>' to 'bool' 
```

查询子实体的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T09:00:11.790

你需要`Any`.

```
var qry = orderRepository.GetOrders();
qry = from p in qry where p.Items.Any(t => t.Name == "test") select p; 
```

您已经有一个 where 子句，使用第二个子句不会有任何好处。第一个 where （小写字母）希望布尔值能够执行过滤，但您提供的是一个`IEnumerable<Items>`（因为这是第二个`.Where`返回的）。只要至少有一个项目与您指定的查询匹配，它的`Any`工作方式与但返回布尔值相同。`Where`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T08:57:20.050

不确定您要通过此声明实现什么目标。

如果您想要所有具有名称为“test”的项目的订单，请使用：

```
var qry = orderRepository.GetOrders();
qry = from p in qry where p.Items.Any(t => t.Name == "test") select p; 
```

如果您想要所有名为“test”的项目，请使用：

```
var qry = orderRepository.GetOrders();
qry = from p in qry select p.Items.Where(t => t.Name == "test"); 
```*************