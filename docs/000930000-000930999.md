# StackOverflow 问答 000930000-000930999

# apache - 将数据库文件放在 htdocs 中是否安全？

> ID：930022
> 
> 赞同：2
> 
> 时间：2009-05-30T16:00:36.870
> 
> 标签：apache, webserver

古德夫，

你能推荐我在我的网络服务器中放置敏感文件的目录吗？我的 htdocs 是这样排列的：

```
XAMPP/htdocs/NewsFeed 
```

NewsFeed 目录有 index.php。index.php 文件的功能是连接数据库。现在，我应该将数据库文件放在 htdocs 中吗？会安全吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T16:25:38.583

如果你有机会把它留在外面，那么我建议你留在外面。如果它受到保护，即使在稍后的时间，也可能会利用漏洞造成一些入侵。所以请尽量让它“远离”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T17:32:57.713

不要将数据库文件放在任何可以通过网络访问的地方。一个人*不*应该能够通过 HTTP 下载您的数据库，如果它可以通过网络访问，那么任何人都可以做到这一点。

这不应该与连接到您的数据库相混淆。这就是你的脚本会做的事情。

将数据库放置在某个服务器目录中，该目录只能由您的脚本在本地（网络服务器）访问。IE。XAMPP/数据库

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T16:13:27.023

我猜你正在使用 SQLite 数据库。我不认为把它放进去`htdocs`是安全的，除非你保护它（也许用 .htaccess / ）以使/`chmod`无法访问数据库。`others``world`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T16:20:07.867

数据库和数据库连接详细信息（登录名、密码等）应保存在 htdocs 目录之外。

仅出于编辑目的，您可以混淆密码，请查看这篇文章：[不要让他们看到您的 MySQL 密码](http://developingmadness.com/blog/2009/05/10/don%E2%80%99t-let-them-see-your-mysql-password/)

# silverlight - 关于 Silverlight 以及如何加载应用程序的问题

> ID：930025
> 
> 赞同：3
> 
> 时间：2009-05-30T16:02:45.323
> 
> 标签：silverlight, navigation

在 Silverlight 3.0 中，我们现在可以使用导航框架创建具有多个页面的应用程序，我的问题是：

当我们运行应用程序时，整个应用程序是立即加载还是在我们导航到特定页面时加载？

这对于那些想要创建一个加载速度非常快的应用程序的人来说可能很重要，如果一切都在开始时加载，整个用户体验可能会变得像一场噩梦，因为他们必须等待很长时间。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T00:05:34.553

整个正在*执行*的XAP 被加载到内存中。这不太重要，因为定义页面并不是工作的大部分。大部分工作是构建页面然后渲染。在页面导航到之前，不会构建/渲染页面。

如果您的 XAP 开始变得庞大（导致初始下载需要一些时间），您可以通过使用 WebClient 延迟加载 XAP 或程序集来解决该问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T19:18:04.877

嗯……

如果加载了整个 XAP，请检查如何存储在浏览器缓存中。

另一方面，您可以按照markti评论执行部分加载，如何定义您的视图？使用接口合同，因此您可以延迟加载视图以按需显示（主要 XAP 加载应用程序，加上接口程序集，您将视图分为几个 DLL，可能加载了主页，其余的只是在后台加载）。

您也可以使用隔离存储来缓存该 Dll（然后您的应用程序将从本地计算机读取该 Dll）。

[http://timheuer.com/blog/archive/2008/09/24/silverlight-isolated-storage-caching.aspx](http://timheuer.com/blog/archive/2008/09/24/silverlight-isolated-storage-caching.aspx)

# screen-scraping - 识别恶意网络爬虫

> ID：930028
> 
> 赞同：4
> 
> 时间：2009-05-30T16:04:05.323
> 
> 标签：screen-scraping, web-crawler

我想知道是否有任何技术可以识别收集非法使用信息的网络爬虫。简而言之，数据盗窃是为了创建网站的副本。

理想情况下，该系统会检测到来自未知来源的抓取模式（如果不在 Google 抓取工具的列表中等），并将虚假信息发送给抓取抓取工具。

*   如果作为防御者，我检测到一个未知爬虫定期访问该站点，则攻击者将随机化这些时间间隔。
*   如果作为防御者，我检测到相同的代理/IP，则攻击者将随机分配代理。

这就是我迷路的地方 - 如果攻击者随机化间隔**和**代理，我如何**不**区分代理和机器从同一网络访问站点？

我正在考虑使用 javascript 和 cookie 支持检查可疑代理。如果柏忌不能始终如一地做到，那么它就是一个坏人。

我还可以做些什么？是否有任何算法，甚至是设计用于对历史数据进行快速动态分析的系统？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T16:11:53.187

我的解决办法是设个陷阱。在您的网站上放置一些被 robots.txt 禁止访问的页面。在你的页面上创建一个链接，但用 CSS 隐藏它，然后禁止任何访问该页面的人。

这将迫使犯罪者遵守 robots.txt，这意味着您可以将重要信息或服务永久远离他，这将使他的副本克隆无用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T16:10:04.090

不要尝试通过 IP 和时间或间隔进行识别——使用您发送给爬虫的数据来跟踪它们。

创建一个已知良好爬虫的白名单——您将正常为他们提供您的内容。其余的，为页面提供一些只有您知道如何查找的独特内容。稍后使用该签名来识别谁在复制您的内容并阻止他们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T16:12:15.697

您如何防止某人在一个低工资国家雇用一个人使用浏览器访问您的网站并记录所有信息？设置 robots.txt 文件，投资安全基础设施以防止 DoS 攻击，混淆您的代码（如果可访问，如 javascript），为您的发明申请专利，并为您的网站提供版权。让法律人员担心有人敲诈你。

# html - 带有字段集的两列页面

> ID：930037
> 
> 赞同：4
> 
> 时间：2009-05-30T16:11:33.903
> 
> 标签：html, css

我不知道从哪里开始学习如何在没有表格的情况下进行这种布局，或者最多将一个两列表格作为一个简单的容器。我应该从哪里开始？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T23:54:50.463

因此，在看到您关于您正在寻找具有两列字段集的布局的评论后，我去写了这个而不使用表格：

```
<html>
<head>
<title>Two Column Fieldsets</title>

<style>
html, body
{
  background: #156;
  text-align: center;
}

#container
{
  background: #FFF;
  border: 1px #222 solid;
  height: 600px;
  margin: 0 auto;
  text-align: left;
  width: 700px;
}

#container form
{
  margin: 0 auto;
}

label
{
  float: left;
  width: 50px;
}

.singleRow
{
  float: left;
  width: 322px;
}

</style>

</head>
<body>
<div id="container">
  <form action="">
    <fieldset class="singleRow">
      <label for="1">Text:</label>
      <input id="1" type="text" />
      <input type="submit" value="submit" />
    </fieldset>
    <fieldset class="singleRow">
      <label for="2">Text:</label>
      <input id="2" type="text" />
      <input type="submit" value="submit" />
    </fieldset>  
  </form>
</div>
</body>
</html> 
```

大多数样式只是为了使它排列整齐并居中并提供一些对比。获得两列的方法是将两个字段集都向左浮动。每个字段集都有一个名为 .singleRow 的类，其唯一*重要*的样式是`float: left;`（其中的宽度使它们排列整齐）。通过将两个元素（在本例中为字段集，但它们可以是 s ，任何元素）向左浮动`div`，`li`并确保它们的组合宽度小于其容器的宽度，您可以实现一个不错的两列布局。

希望这可以帮助。

# shell - UNIX 排序命令如何对一个非常大的文件进行排序？

> ID：930044
> 
> 赞同：116
> 
> 时间：2009-05-30T16:18:32.203
> 
> 标签：shell, sorting

UNIX`sort`命令可以像这样对一个非常大的文件进行排序：

```
sort large_file 
```

排序算法是如何实现的？

怎么不会造成内存过度消耗？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-05-30T16:26:03.590

UNIX 排序命令的[算法细节](http://vkundeti.blogspot.com/2008/03/tech-algorithmic-details-of-unix-sort.html)说 Unix 排序使用外部 R-Way 合并排序算法。该链接包含更多细节，但本质上它将输入分成更小的部分（适合内存），然后在最后将每个部分合并在一起。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-05-30T16:26:57.490

该`sort`命令将工作数据存储在临时磁盘文件中（通常在 中`/tmp`）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-03-02T11:31:42.840

**警告：**这个脚本每块启动一个shell，对于非常大的文件，这可能是数百个。

* * *

这是我为此目的编写的脚本。在 4 处理器机器上，它提高了 100% 的排序性能！

```
#! /bin/ksh

MAX_LINES_PER_CHUNK=1000000
ORIGINAL_FILE=$1
SORTED_FILE=$2
CHUNK_FILE_PREFIX=$ORIGINAL_FILE.split.
SORTED_CHUNK_FILES=$CHUNK_FILE_PREFIX*.sorted

usage ()
{
     echo Parallel sort
     echo usage: psort file1 file2
     echo Sorts text file file1 and stores the output in file2
     echo Note: file1 will be split in chunks up to $MAX_LINES_PER_CHUNK lines
     echo  and each chunk will be sorted in parallel
}

# test if we have two arguments on the command line
if [ $# != 2 ]
then
    usage
    exit
fi

#Cleanup any lefover files
rm -f $SORTED_CHUNK_FILES > /dev/null
rm -f $CHUNK_FILE_PREFIX* > /dev/null
rm -f $SORTED_FILE

#Splitting $ORIGINAL_FILE into chunks ...
split -l $MAX_LINES_PER_CHUNK $ORIGINAL_FILE $CHUNK_FILE_PREFIX

for file in $CHUNK_FILE_PREFIX*
do
    sort $file > $file.sorted &
done
wait

#Merging chunks to $SORTED_FILE ...
sort -m $SORTED_CHUNK_FILES > $SORTED_FILE

#Cleanup any lefover files
rm -f $SORTED_CHUNK_FILES > /dev/null
rm -f $CHUNK_FILE_PREFIX* > /dev/null 
```

另请参阅：“[使用 shell 脚本更快地对大文件进行排序](http://bashcurescancer.com/sorting-large-files-faster-with-a-shell-script.html)”

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-10-23T07:46:29.187

```
#!/bin/bash

usage ()
{
    echo Parallel sort
    echo usage: psort file1 file2
    echo Sorts text file file1 and stores the output in file2
}

# test if we have two arguments on the command line
if [ $# != 2 ]
then
    usage
    exit
fi

pv $1 | parallel --pipe --files sort -S512M | parallel -Xj1 sort -S1024M -m {} ';' rm {} > $2 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-30T16:29:21.623

我不熟悉该程序，但我猜它是通过外部排序完成的（大部分问题保存在临时文件中，而相对较小的部分问题一次保存在内存中）。参见 Donald Knuth 的[计算机编程艺术，卷。3 排序和搜索，第 5.4 节](http://www-cs-faculty.stanford.edu/~uno/taocp.html)对该主题进行了非常深入的讨论。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-06-04T21:18:24.993

仔细查看排序选项以提高性能并了解它对您的机器和问题的影响。Ubuntu 上的关键参数是

*   临时文件的位置 -T directory_name
*   要使用的内存量 -SN%（要使用的所有内存的 N%，越多越好，但要避免导致交换到磁盘的过度订阅。您可以像“-S 80%”一样使用它来使用 80% 的可用 RAM，或“-S 2G”表示 2 GB RAM。）

提问者问“为什么没有高内存使用？” 答案来自历史，旧的 unix 机器很小，默认的内存大小设置得很小。为您的工作负载尽可能大地调整它，以极大地提高排序性能。将工作目录设置在您最快的设备上的一个位置，该位置有足够的空间容纳至少 1.25 * 被排序文件的大小。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-10-13T05:26:14.577

如何使用 -T 选项对大文件进行排序

我必须对大文件的第 7 列进行排序。

我正在使用：

```
grep vdd  "file name" | sort -nk 7 | 
```

我遇到以下错误：

```
******sort: write failed: /tmp/sort1hc37c: No space left on device****** 
```

然后我使用了 -T 选项，如下所示：

```
grep vdda  "file name" | sort -nk 7  -T /dev/null/ | 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2011-06-21T22:27:05.393

内存应该不是问题 - sort 已经解决了这个问题。如果您想充分利用您的多核 CPU，我已经在一个小脚本中实现了这一点（类似于您可能在网上找到的一些脚本，但比大多数脚本更简单/更干净；））。

```
#!/bin/bash
# Usage: psort filename <chunksize> <threads>
# In this example a the file largefile is split into chunks of 20 MB.
# The part are sorted in 4 simultaneous threads before getting merged.
# 
# psort largefile.txt 20m 4    
#
# by h.p.
split -b $2 $1 $1.part
suffix=sorttemp.`date +%s`
nthreads=$3
i=0
for fname in `ls *$1.part*`
do
    let i++
    sort $fname > $fname.$suffix &
    mres=$(($i % $nthreads))
    test "$mres" -eq 0 && wait
done
wait
sort -m *.$suffix 
rm $1.part* 
```

# c# - Subversion 的示例代码

> ID：930053
> 
> 赞同：0
> 
> 时间：2009-05-30T16:27:17.130
> 
> 标签：c#, svn, api

> **可能重复：**
> [有人知道 Subversion 的好 C# API 吗？](https://stackoverflow.com/questions/481247/does-anyone-know-of-a-good-c-sharp-api-for-subversion)

谁能指出我使用 C# API 的 Subversion 的起点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T16:31:14.883

你看过[SharpSVN 吗](http://sharpsvn.open.collab.net/)？它是 .Net 2.0 的 Subversion 客户端 API 的开源绑定

# seo - 将域从服务器 A 转发到服务器 B 的正确方法

> ID：930055
> 
> 赞同：1
> 
> 时间：2009-05-30T16:27:25.667
> 
> 标签：seo, dns, forwarding

这是我的情况。

我向 Webhost Provider A 注册了 myweb.ca（特定国家/地区）域，因为它们允许 ccTLD，而 Webhost Provider B 不允许。[我在http://mysecretweb.com/myweb/](http://mysecretweb.com/myweb/)的 Webhost Provider B 上托管我的 PHP 文件，因为我更喜欢它们（可靠、便宜、经过验证等）。

我想实现以下目标：

1.  当用户键入[http://myweb.ca/aboutus.html](http://myweb.ca/aboutus.html)时，他们将看到[http://mysecretweb.com/myweb/aboutus.html的内容](http://mysecretweb.com/myweb/aboutus.html)
2.  当用户访问 aboutus.html 时，浏览器必须显示[http://myweb.ca/aboutus.html](http://myweb.ca/aboutus.html)，而不是[http://mysecretweb.com/myweb/aboutus.html](http://mysecretweb.com/myweb/aboutus.html)
3.  公众和搜索引擎不能知道域[http://mysecretweb.com/myweb](http://mysecretweb.com/myweb)，因为它是一个秘密。
4.  提供的任何解决方案都不得对 SEO 产生负面影响

带有屏蔽的域转发会解决我的问题吗？有什么建议么？

## 附加细节

有人建议我将名称服务器信息从 ns1.providerA.com 更改为 ns1.providerB.com。其他人反驳说，提供者 B 将禁止这样做，因为提供者 A 不在网络上，并且提供者 B 可能会因为这样做而禁止我的帐户。我很困惑...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T16:35:35.507

您可以编写一个 PHP 脚本，从 $_GET 获取 URL，下载它并传递给用户（包括标题） - 然后一些 .htaccess 重写魔术将所有内容指向该脚本。这是对人类和机器人完全透明的唯一方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T17:13:06.273

您可以尝试分别检测机器人和人类，并对两者采取不同的行动

# java - 从命令提示符编译 J2ME

> ID：930060
> 
> 赞同：2
> 
> 时间：2009-05-30T16:30:09.720
> 
> 标签：java, java-me, cmd

我正在尝试从 2 周前的命令行编译 J2ME java 文件！现在我可以成功编译项目并创建 JAR 和 JAD 文件。我编译的文件模棱两可，这意味着如果我使用与 TextField 或 Form 或其他相同的基本类，则此工作成功，但如果我使用 RecordStores 或更重要的是，如果使用 Resource(s) AND Library(s) 结果不好并且程序无法运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T19:26:39.083

我不知道“从命令提示符编译”是什么意思，但你应该看看[Ant](http://ant.apache.org/) ，它是用于构建 J2ME 应用程序的扩展[Antenna 。](http://antenna.sourceforge.net/)

天线对于开始开发和编译/创建分发包来说应该是非常容易的。它使包括第三方罐子变得轻而易举:)

除了使用一些 IDE 插件，我相信你不会得到比这个更好的答案。

/亚努斯

# asp.net - 简单明细表单上的数据绑定

> ID：930061
> 
> 赞同：0
> 
> 时间：2009-05-30T16:30:24.387
> 
> 标签：asp.net, data-binding

我之前创建了一个简单的细节编辑表单，并决定在上面绑定一些控件。当然，有人告诉我他们需要在数据绑定容器上。我直接的、相当不知情的选择是 FormView。这合适吗？我可以在这里使用哪些容器？

将我的控件包装在 FormView 的 ItemTemplate 中当然会使我的代码无法访问它们，迫使我进入许多 FindControls 和强制转换，这很不整洁。我知道我可以编写帮助程序和扩展方法，使这更加整洁，但我只是想要一个快速演示。在这种情况下，我是否遗漏了有关处理模板化和这种“嵌套”控件的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T16:44:12.300

您的选择是[FormView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.aspx)或[DetailsView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.aspx)控件。它们之间的主要区别在于 DetailsView 为您完成所有工作，而 FormView 要求您创建自己的模板，从而允许更好的控制。正如您所发现的，FormView 需要使用 FindControl 来访问控件，但数据绑定的目的是您不需要经常直接访问控件。

# c# - 单击时 Datagridview 导致 IndexOutOfRangeException

> ID：930069
> 
> 赞同：9
> 
> 时间：2009-05-30T16:35:59.237
> 
> 标签：c#, winforms, datagridview

我有一个 datagridview，我们将其称为 dataGridViewExample。

我的对象（不常见的数据类型是因为我的数据库是 SQLite）：

```
class MyObject
{
    public Int64 Vnr { get; set; }
    public string Name { get; set; }
    public Single Price { get; set; }
    public int Amount { get; set; }
} 
```

以下是相关代码：

```
//This form gets called with a .ShowDialog(); in my form1.

private List<MyObjecte> ExampleList = new List<MyObject>();

public MyForm()
{
    dataGridViewExample.DataSource = OrdreInkøbsListe;
}

private void AddtoDataGridViewExample()
{
    //Add a new MyObject to the list
    ExampleList.Add(new myObject()
                 {
                     Vnr = newVnr,
                     Amount = newAmount,
                     Price = newPrice,
                     Name = newName
                 });

    //refresh datasource
    dataGridViewExample.DataSource = null;
    dataGridViewExample.Refresh();
    dataGridViewExample.DataSource = OrdreInkøbsListe;
    ddataGridViewExample.Refresh();
} 
```

当使用 .ShowDialog 调用 MyForm 时，它会很好地显示并很好地显示我的 DataGridView 示例。从代码中可以看出，`ExampleList`最初是空的，所以它只显示一个空的数据网格视图，有 4 列：Vnr、名称、价格和金额。如果我点击它等等，什么都不会发生 - 所以到目前为止一切都按计划进行。

每次我调用`AddtoDataGridViewExample()`它时，它都会将新对象添加到 Datagridview，并且 datagridview 会更新，列出到目前为止添加的所有对象（它们显示为行，再次根据计划）。

现在，还记得我刚才说过，如果你`DataGridViewExample`在我打电话之前点击里面什么都不会发生`AddtoDataGridViewExample()`吗？好吧，在调用`AddtoDataGridViewExample()`了一次或多次之后，如果我在里面单击，程序就会崩溃`DataGridViewExample`（例如：用户要选择一行）。它抛出一个**IndexOutOfRangeException**并谈论一个 -1 索引。它还会以另一种形式抛出异常，在我用`.ShowDialog()`;调用 MyForm 的那一行。

我真的被困在这个问题上，你们知道有什么问题吗？ **我唯一的线索是**我相信`DataGridViewExample`'s 数据源的刷新可能是问题的原因。另一个**重要**说明：我尚未将任何事件绑定到我的`DataGridViewExample`. 所以你可以排除这个想法。

这是 all`DataGridViewExample`的属性：

```
this.dataGridViewExample.AllowUserToAddRows = false;
this.dataGridViewExample.AllowUserToDeleteRows = false;
this.dataGridViewExample.AllowUserToResizeColumns = false;
this.dataGridViewExample.AllowUserToResizeRows = false;
this.dataGridViewExample.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
this.dataGridViewExample.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
this.dataGridViewExample.Location = new System.Drawing.Point(591, 53);
this.dataGridViewExample.MultiSelect = false;
this.dataGridViewExample.Name = "dataGridViewExample";
this.dataGridViewExample.ReadOnly = true;
this.dataGridViewExample.RowHeadersVisible = false;
this.dataGridViewExample.SelectionMode = System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect;
this.dataGridViewExample.ShowEditingIcon = false;
this.dataGridViewExample.Size = new System.Drawing.Size(240, 150);
this.dataGridViewExample.TabIndex = 31; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-30T16:50:41.370

我猜click事件试图获取当前选定的行并对其进行处理，同时`dataGridViewExample.DataSource = null;`清除数据源，并且当前选定的行变为空。

如果将 设置`DataGridView.DataSource`为列表，则无需将其重置为空，刷新并再次将其重置为列表（并再次刷新）以查看更改。只需刷新`DataGridView`.

您也可以尝试使用`BindingList<T>`object 而不是 a `List<T>`，它会自动通知您的网格其内部更改（添加和删除元素），还有一个`INotifyPropertyChanged`您可以在您的`MyObject`类上实现的接口，这将使对象中的每个属性都发生变化在网格上显示（对于代码中的对象所做的任何更改，而不是通过网格本身）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T16:56:36.683

您是否尝试过运行调试器并在引发 InedxOutOfRangeException 时中断以查看引发异常的位置？

选择 Debug > Exceptions 然后对话框上有一个 Find 按钮，这样您就不必浏览所有的可能性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-01T11:43:07.010

我有类似的情况。我将某些对象的通用列表分配给 DataGridView。然后我将 null 设置为 DataSource 并在刷新之后。之后，我将对象列表分配给 DataSource。在发生运行时错误时单击网格时出现 IndexOutOfRange。我的解决方案是将我的对象的新空列表分配给该网格并刷新，在我的工作列表发生更改后，我确实分配给 DataSource 并调用 Refresh。现在，它可以正常工作，没有任何崩溃。请先查看我的代码：

```
grid.DataSource = null;
grid.Refresh();
if(cases.Count() > 0)
{
   grid.DataSource = cases;
   grid.Refresh();
} 
```

现在在我的代码之后：

```
grid.DataSource = new List<MyCase>();
grid.Refresh();
//do something with cases
if(cases.Count() > 0)
{
   grid.DataSource = cases;
   grid.Refresh();
} 
```

# jquery - MS MVC 表单 AJAXifying 技术

> ID：930074
> 
> 赞同：12
> 
> 时间：2009-05-30T16:40:00.337
> 
> 标签：jquery, asp.net-mvc, ajax, forms

我正在寻找**最优雅**的方式来 ajaxify 我的表单（使用 jQuery）。
你怎么做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T17:00:33.527

这是我的解决方案（我认为这是一个[渐进式增强](http://en.wikipedia.org/wiki/Progressive_enhancement)解决方案），仅使用 jQuery 没有任何插件：

```
var form = $('form#YourFormId');
$(':submit', form).click(function (event) {
    event.preventDefault();
    $.post(form.attr('action'), form.serialize(),
        function(data, status) {
            if(status == 'success') {
                // your code here
            }
        }
    );
}); 
```

**更新：**

如果您的 POST 响应是“带有表单的 HTML”，请尝试以下操作：

```
function ajaxifyForm(form) {
    $(':submit', form).click(function (event) {
        event.preventDefault();
        $.post(form.attr('action'), form.serialize(),
            function(data, status) {
                if(status == 'success') {
                    var newForm = $(data);
                    ajaxifyForm(newForm);
                    form.after(newForm).remove();
                }
            }
        );
    });
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T16:57:12.470

Ajaxify 你的表格......这很模糊。

如果要异步提交表单，可以使用 $.post() 发布到单独的控制器操作。

例子：

在视图中：

```
$.post('<%= Url.Action("DoAjaxCall") %>', $('form').serialize(), 
function (data) {
    alert(data.Message);
}
, "json"); 
```

在您的控制器中：

```
public ActionResult DoAjaxCall(YourModel model)
{
    return Json(new { Message = "Your ajax call is working!" });
} 
```

这就是我至少在某些形式中使用的。

PS：我在stackoverflow文本编辑器中写了这个，所以它没有经过真正的测试。但作为一个大纲，它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T16:47:06.147

Checkout [JQuery plugins storage](http://plugins.jquery.com/project/Plugins/category/47)我相信你会发现你需要

# iphone - UIDevice 方向

> ID：930075
> 
> 赞同：12
> 
> 时间：2009-05-30T16:43:06.293
> 
> 标签：iphone, cocoa-touch, ios-simulator

我在方法中有以下代码。当我在模拟器中运行它时，调试器会直接跳过代码？？我错过了什么？

```
if (([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeLeft) || 
        ([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeRight)) 
{       

} else {

} 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2011-06-14T13:23:06.413

确定界面方向的最佳方法是查看状态栏方向：

```
 UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];

    if(orientation == UIInterfaceOrientationPortrait || 
       orientation == UIInterfaceOrientationPortraitUpsideDown) {

       //Portrait orientation

}

if(orientation == UIInterfaceOrientationLandscapeRight ||
   orientation == UIInterfaceOrientationLandscapeLeft) {

    //Landscape orientation

} 
```

`UIDevice`类基于加速度计测量方向，如果设备平放，它将不会返回正确的方向。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-12-01T06:49:55.437

请注意，有一个宏`UIDeviceOrientationIsLandscape`and `UIDeviceOrientationIsPortrait`，因此与其将其分别与 LandscapeLeft 和 LandscapeRight 进行比较，不如这样做：

```
if (UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation))
{
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-30T18:56:29.380

更新 2

这应该没关系，但请尝试打开方向通知：

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(detectOrientation) name:@"UIDeviceOrientationDidChangeNotification" object:nil]; 
```

* * *

更新

我的错，我以为它是空的。

尝试删除 or 语句并仅测试单个方向。看看能不能解决。也许有一个支架问题或一些愚蠢的事情。

我在生产代码中进行了以下测试，因此您的技术应该可以工作：

```
 if (([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeLeft) || 
        ([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeRight)) {

} 
```

* * *

原始答案

您必须将语句实际放入 if 块中才能使其介入。

调试器足够聪明，可以跳过空块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-22T03:25:17.280

在不打开方向通知的情况下执行此操作的另一种方法是

**第 1 步：**将当前方向保存在局部变量中`myCurrentOrientation`，并像这样分配它：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
                                duration:(NSTimeInterval)duration
{
    myCurrentOrientation = toInterfaceOrientation;
} 
```

**第 2 步：**用于`myCurrentOrientation`您的支票

```
if (UIInterfaceOrientationIsLandscape(myCurrentOrientation) == YES) {
    // landscape
}
else {
    // portrait.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-05T13:35:06.193

嘿，您需要`[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications]` 在获取值之前调用。查看此方法的文档。我花了一段时间才找到这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-03T08:20:07.293

假设您在 Springboard 调整中并希望根据当前应用程序的方向显示某些内容，那么您可以使用它（仅限越狱）：

```
UIInterfaceOrientation o = [[UIApplication sharedApplication] _frontMostAppOrientation]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-29T11:23:45.923

我建议您使用我突出显示的代码而不是您的代码来保护某些行代码。

```
-(void) viewDidLoad
{
    [super viewDidLoad];
    [self rotations];
}

-(void)rotations
{
    [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(orientationChanged:)
                                         name:UIDeviceOrientationDidChangeNotification
                                         object:nil];
}

-(void) orientationChanged:(NSNotification *)notification
{
    //USE THIS PART
    //USE THIS PART
    //USE THIS PART
    //USE THIS PART
    //USE THIS PART
    if (UIDeviceOrientationIsPortrait([UIDevice currentDevice].orientation))
    {
    }
} 
```

代替

```
if([[UIDevice currentDevice] orientation] == UIInterfaceOrientationPortrait || 
   [[UIDevice currentDevice] orientation] == UIInterfaceOrientationPortraitUpsideDown) 
{
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-22T10:39:00.263

这是一种查找屏幕方向和真实中心的方法。我使用了 Tuszy 的方法，所以我可以正确设置 UIActivityIndi​​catorView。

```
- (BOOL) isPortraitOrientation {
    UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];
    if(orientation == UIInterfaceOrientationPortrait ||
       orientation == UIInterfaceOrientationPortraitUpsideDown) {
        return true;
    }
    if(orientation == UIInterfaceOrientationLandscapeRight ||
       orientation == UIInterfaceOrientationLandscapeLeft) {
        return false;
    }
    return false;
} 
```

以及获得中心的方法...

```
- (void) findMyUIViewCenter {
    CGPoint myCenter;
    if ([self isPortraitOrientation]) {
        myCenter = self.view.center;
    }
    else {
        myCenter = CGPointMake(self.view.frame.size.height / 2.0, self.view.frame.size.width / 2.0);
    }
    NSLog(@"true center -- x:%f y:%f )",myCenter.x,myCenter.y);
} 
```

# iphone - 在“同一”时间发送 30 个对象的最简单和最快的方法是什么？

> ID：930078
> 
> 赞同：0
> 
> 时间：2009-05-30T16:43:46.527
> 
> 标签：iphone, cocoa-touch, performance, uikit

我有一个 UIScrollView，在滚动过程中会出现很多对象（UIImageView）。但是，当用户滚动时，我想向所有这些对象发送消息，以告诉他们不要做任何愚蠢的事情。当 UIScrollView 减速时，一些动画会发生在可见对象上。当用户快速移动时（pagingEnabled=YES），越来越多的对象仍在动画，这将导致可怕的滚动性能。

我想告诉他们所有人在用户滚动时立即停止并且什么都不做。那么，我能做些什么呢？for 循环不利于滚动时的性能。它会抽搐一小会儿，但这足以让用户非常非常生气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T18:29:35.407

将它们全部放在一个数组中，然后使用 [NSArray makeObjectsPerformSelector:]。这是最简洁的方法，但我不确定它是否比使用 for 循环更有效......

我不确定您是如何为视图设置动画的，但您可能希望使用 UIScrollView 的委托函数来维护可见项的子数组并将动画限制为这些。例如，每当可见矩形发生变化时，您都可以查看现有的可见视图列表，看看是否有任何完全不在屏幕上。你可以停止动画那些。然后，您可以查找屏幕上但不在列表中的视图并在它们上开始动画。我以前做过类似的事情，它有助于大大提高性能！

然后，如果你想冻结所有正在运行的动画，你有一个动画数组，它相对较短。

希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T21:47:12.217

还要记住，计算机只能以线性方式做事。因此，无论您做什么，都必须使用某种循环控制结构。

也许启动一个包含循环的线程。并且循环将调用

```
perfomrselectoronmainthread: 
```

每个对象的选择器。（请记住，对于 UI 内容，它必须在主线程上执行。）

我假设你正在使用

```
+ (void)setAnimationsEnabled:(BOOL)enabled 
```

停止动画。

如果这仍然不够快，您将不得不查看 Core Animations，这些将具有额外的效率，可以让这种情况发生。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T07:00:41.863

我会使用通知。这样做的好处是您可以通知所有对象，向它们传递所需的所有信息。它也是一种简单但功能强大的机制，允许异步通信。

请参阅通知编程主题简介：

[http://developer.apple.com/documentation/Cocoa/Conceptual/Notifications/Introduction/introNotifications.html](http://developer.apple.com/documentation/Cocoa/Conceptual/Notifications/Introduction/introNotifications.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T20:39:06.693

尝试在不同的线程上执行每条消息。当然所有的 UI 更新都必须在主线程上，但如果你可以在后台线程中做一些工作，也许会减少一些延迟。（但我不能说这对于 30 多个对象有多可行）

# c# - 如何使用字符串中的 XML 标记？

> ID：930083
> 
> 赞同：2
> 
> 时间：2009-05-30T16:45:34.043
> 
> 标签：c#, xml, linq, xelement

我正在使用 Microsoft Visual C# 2008 Express。

假设我有一个字符串，字符串的内容是： `"This is my <myTag myTagAttrib="colorize">awesome</myTag> string."`

我告诉自己我想对“真棒”这个词做点什么——可能调用一个函数来做一些叫做“着色”的事情。

C# 中检测此标记是否存在并获取该属性的最佳方法是什么？我在 C# 中使用过 XElements 等，*但*主要与读入和读出 XML 文件有关。

谢谢！

-阿迪娜

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T17:37:21.793

另一种解决方案：

```
var myString = "This is my <myTag myTagAttrib='colorize'>awesome</myTag> string.";
try
{
    var document = XDocument.Parse("<root>" + myString + "</root>");
    var matches = ((System.Collections.IEnumerable)document.XPathEvaluate("myTag|myTag2")).Cast<XElement>();
    foreach (var element in matches)
    {
        switch (element.Name.ToString())
        {
            case "myTag":
                //do something with myTag like lookup attribute values and call other methods
                break;
            case "myTag2":
                //do something else with myTag2
                break;
        }
    }
}
catch (Exception e)
{
    //string was not not well formed xml
} 
```

我还考虑了您对 Dabblernl 的评论，您希望在其中解析多个元素的多个属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T17:03:49.717

您可以使用正则表达式提取 XML，将提取的 xml 字符串加载到 XElement 中，然后从那里开始：

```
string text=@"This is my<myTag myTagAttrib='colorize'>awesome</myTag> text.";
Match match=Regex.Match(text,@"(<MyTag.*</MyTag>)");
string xml=match.Captures[0].Value;
XElement element=XElement.Parse(xml);
XAttribute attribute=element.Attribute("myTagAttrib");
if(attribute.Value=="colorize") DoSomethingWith(element.Value);// Value=awesome 
```

如果未找到 MyTag 元素，此代码将引发异常，但可以通过插入以下行来补救：

```
if(match.Captures.Count!=0)
{...} 
```

如果字符串可以容纳的不仅仅是 MyTag 标签，那就更有趣了……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T16:53:06.780

我对您的示例有些困惑，因为您在字符串（文本内容）、标签和属性之间切换。但我认为你想要的是 XPath。

因此，如果您的 XML 流如下所示：

<adeena/><parent><child x="this is my awesome string">这是另一个很棒的字符串<child/><adeena/>

您将使用如下所示的 XPath 表达式来查找属性：

//孩子/@x

像这样在子标签下找到文本值的方法：

//孩子

我是一名 Java 开发人员，所以我不知道您会使用哪些 XML 库来执行此操作。但是您需要一个 DOM 解析器来为您创建一个 W3C 文档类实例，方法是读入 XML 文件，然后使用 XPath 提取值。

如果您需要，[W3C 学校](http://www.w3schools.com/XPath/default.asp)有一个很好的XPath 教程。

更新：

如果您说您已经有一个 XML 流作为 String，那么答案是不要从文件中读取它，而是从 String 本身中读取它。Java 具有称为 InputStream 和 Reader 的抽象，它们分别处理字节流和字符流。源可以是文件、字符串等。检查您的 C# DOM API 看它是否有类似的东西。您将把字符串传递给解析器，解析器将返回一个您可以操作的 DOM 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T16:56:12.127

由于输入不是格式良好的 XML，您将无法使用任何内置 XML 库对其进行解析。您需要一个正则表达式来提取格式良好的片段。您可能可以在 CodePlex 上使用更宽容的 HTML 解析器之一，例如[HtmlAgilityPack 。](http://htmlagilitypack.codeplex.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T16:58:37.773

`XmlTextReader`可以使用特殊的构造函数解析 XML 片段，这可能*在*这种情况下有所帮助，但我对此并不积极。

这里有一篇深入的文章：

[http://geekswithblogs.net/kobush/archive/2006/04/20/75717.aspx](http://geekswithblogs.net/kobush/archive/2006/04/20/75717.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T10:21:19.493

这是我使用 Regex 匹配任何类型的 xml 的解决方案： [C# Better way to detect XML?](https://stackoverflow.com/questions/891223/c-better-way-to-detect-xml/891401#891401)

# java - “new”关键字会改变对象引用的值吗？

> ID：930085
> 
> 赞同：2
> 
> 时间：2009-05-30T16:46:46.837
> 
> 标签：java

假设我有一堆用于不同目的的类实例，所以我希望能够直接按名称引用它们：

```
SomeObject aardvark = new SomeObject();
SomeObject llama = new SomeObject();
SomeObject tiger = new SomeObject();
SomeObject chicken = new SomeObject(); 
```

但是我也想要一个数组以便于迭代：

```
SomeObject[] animals = {aardvark, llama, tiger, chicken}; 
```

我的问题是这个。当我这样做时会发生什么：

```
llama = new SomeObject(); 
```

我将创建一个全新的美洲驼对象。这对我的动物阵列有何影响？它会引用新的 llama 对象，还是以某种方式仍然引用旧对象的副本？

我知道 Java 是“按价值传递”，但我仍然对这样的东西感到困惑。当我使用 NEW 关键字时，该对象引用的“值”会改变吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T16:49:26.020

您的动物阵列将不受影响。

也许这会使可视化变得更容易。您的初始设置如下所示：

```
chicken ---------------------------> SomeObject
tiger ---------------------> SomeObject  ^
llama -------------> SomeObject  ^       |
aardvark --> SomeObject  ^       |       |
                 ^       |       |       |
                 |       |       |       |
animals -----> {[0],    [1],    [2],    [3]} 
```

当你这样做时：

```
llama = new SomeObject(); 
```

您正在创建一个新的“SomeObject”，然后将 llama 更改为指向它。

```
chicken ---------------------------> SomeObject
tiger ---------------------> SomeObject  ^
                     SomeObject  ^       |
aardvark --> SomeObject  ^       |       |
                 ^       |       |       |
                 |       |       |       |
animals -----> {[0],    [1],    [2],    [3]}

llama -------> SomeObject 
```

要记住的重要一点是（非原始）变量和数组元素只是对对象的引用，并且无论何时您看到“x = y;” （即使 x 是数组下标）它的意思是“使 x 引用 y*当前*所指的内容”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T16:49:34.337

`animals`当您为 name 分配不同的引用（例如“新”版本）时，您的数组将保留您放在那里的引用（“旧”版本）`llama`。

换句话说，数组包含对值（对象）的引用，而不是对用于构建数组的特定表达式的引用（无论这些表达式是变量的简单名称还是更复杂的形式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T17:08:24.623

这与 pass-by-value 或 pass-by-reference 无关，也与`new`. 这里需要了解的是变量、表达式和引用之间的区别。关键是这样的：

```
SomeObject[] animals = {aardvark, llama, tiger, chicken}; 
```

这是用于创建数组并使用引用填充它的语法糖。大括号内发生的事情是有一个被评估的表达式列表。这些表达式是您之前声明和初始化的变量，但这些变量只是包含对象引用的内存地址的名称。表达式计算出放入数组中的内存地址（引用）的*内容——这隐含地创建了引用的副本。*因此，复制的引用完全独立于变量。考虑到这一点，也许会更容易理解：

```
SomeObject[] animals = {aardvark, llama, tiger, new SomeObject()}; 
```

在这里，最后一个表达式用于`new`创建对象。*该表达式计算为对新创建对象的引用，该对象作为对该对象的唯一*引用放入数组中-*没有*直接引用它的变量！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T16:59:25.743

当你像你一样初始化动物数组时，你是在数组中放置一个引用的副本（这与对象的副本不同）。真的就这么简单，我不敢相信没有人用过完全相同的词......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T16:49:12.947

不，不会的。它创建一个新实例，表达式的值将是对创建实例的引用。分配只会将变量设置为新对象。它不会影响对前一个对象的任何其他引用。

基本上，您可以将其视为两个独立的操作：

```
SomeObject newInstance = new SomeObject();
oldInstance = newInstance; 
```

`oldInstance`仅包含一个参考，而分配将改变这一点。

它与按值传递完全无关。您没有在任何地方传递任何对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T16:51:10.497

不，你的例子是这样的：

```
int a = 1;
int b = 2;
int[] ary = { a, b };
a = 2;
// ary[0] still yields 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T16:51:38.170

更改`llama`不会更改数组。正如您所说，Java 是“按值传递”。把它想象`llama`成一个小盒子，上面写着你可以在哪里找到骆驼。创建数组时，里面的引用`llama`被复制到数组中。所以当你`llama`稍后修改时，你不会弄乱数组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T16:51:55.893

数组应该保持原样，因为数组的所有元素实际上都是指向堆上可以找到实际信息的点的指针。

所以在你的数组中，有一个对堆上某个点的引用。然后，您在堆上创建另一个点并让一个容器保存它，但另一个仍然存在并将指向旧位置。

因此，您的阵列应该保持完整。请注意，唯一的联系方式是通过相关数组的 x'd 元素。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T17:02:08.970

当您使用调试器时，您可以看到您何时拥有相同的对象或新对象。当同一个对象以多种方式可见时，它还可以为您提供帮助。

# c# - 在 SubSonic 中返回多个集合

> ID：930088
> 
> 赞同：0
> 
> 时间：2009-05-30T16:48:45.133
> 
> 标签：c#, asp.net, sql-server-2005, subsonic

我在菜单部分有一个集合，每个部分都包含一组菜单项（这是一个两层菜单，简单的东西）。理想情况下，我可以深度加载 MenuSection 集合以同时获取 MenuItems，但是如果失败了，有没有一种方法可以通过亚音速仅使用一个数据库调用返回每个集合的单独集合？我是否坚持使用具有多个表的 DataSet？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T19:11:44.403

是的-有很多方法可以做到这一点-许多不同的方法。您可以使用视图并加载所有内容，然后将其旋转到结构化对象集。或者，您可以在数据读取器中运行连接查询并使用一些循环逻辑加载对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T04:56:38.887

Rob 说的是对的。另一个角度是这样的：

```
Partial Public Class MenuSection

Private _ChildMenus As Generic.List(Of MenuSection)
Public Property ChildMenus() As Generic.List(Of MenuSection)
    Get
        If _ChildMenus Is Nothing Then
            ' Load the data in the list
            _ChildMenus = New SubSonic.Select().From(Data.MenuSelection). _
            Where("ParentMenuItemId").IsEqualTo(1). _
            ExecuteTypedList(Of Data.MenuSelection)()
        End If
        Return _ChildMenus
    End Get
    Set(ByVal value As Generic.List(Of MenuSection))
        _ChildMenus = value
    End Set
End Property 
```

结束类

# c# - C# 中的 read 和 readline 有什么区别？

> ID：930089
> 
> 赞同：4
> 
> 时间：2009-05-30T16:48:55.023
> 
> 标签：c#, visual-c++

`read()`C#和C#有什么区别`readline()`？

也许我们不使用它，但在我的学院中，唯一的区别是一个有“line”而另一个没有......在 c++ 中，有“cin”，它有“endl”来添加 line。有人可以告诉我区别吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T16:51:20.357

你的意思是`TextReader.Read`和`TextReader.ReadLine`？

一个重载`TextReader.Read`将字符读入缓冲区 (a `char[]`)，您可以指定希望它读取多少个字符（作为最大值）。另一个读取单个字符，`int`如果您已到达阅读器的末尾，则返回一个 -1 。

`TextReader.ReadLine`将整行读取为 a `string`，其中不包括行终止符。

据我所知，`endl`更常与`cout`C++ 结合使用：

```
cout << "Here's a line" << endl; 
```

在.NET中你会使用

```
writer.WriteLine("Here's a line") 
```

完成同样的事情（用于适当的`TextWriter`；或者`Console.WriteLine`用于控制台）。

编辑：`Console.ReadLine`读取一行文本，而`Console.Read`读取单个字符（就像 的无参数重载`TextWriter.Read`）。

`Console.ReadLine()`与 基本相同，`Console.In.ReadLine()`与`Console.Read()`基本相同`Console.In.Read()`。

编辑：在回答您对另一个答案的评论时，您不能这样做：

```
int x = Console.ReadLine(); 
```

因为 of 的返回类型`Console.ReadLine()`是一个字符串，并且没有从`string`to的转换`int`。你*可以*做

```
int x = Console.Read(); 
```

因为`Console.Read()`返回一个`int`. （同样，它是 Unicode 代码点或 -1 表示“数据结束”。）

编辑：如果你想从键盘读取一个整数，即用户输入“15”并且你想将它作为一个整数检索，你应该使用类似的东西：

```
string line = Console.ReadLine();
int value;
if (int.TryParse(line, out value))
{
    Console.WriteLine("Successfully parsed value: {0}", value);
}
else
{
    Console.WriteLine("Invalid number - try again!");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T16:57:39.600

如果您在谈论 Console.Read 和 Console.ReadLine，区别在于 Read 只返回单个字符，而 ReadLine 则返回整个输入行。需要注意的是，在这两种情况下，API 调用都不会返回，直到用户按 ENTER 将文本提交给程序。因此，如果您键入“abc”但不按 ENTER，则 Read 和 ReadLine 都会阻塞，直到您输入。

# asp.net - ASP.NET 不会发送电子邮件，也没有错误消息，很奇怪！

> ID：930100
> 
> 赞同：1
> 
> 时间：2009-05-30T16:54:26.717
> 
> 标签：asp.net, email

我尝试使用下面的这个类发送电子邮件，但没有成功，没有错误消息，页面执行得非常快，这个类有什么问题吗？

```
public bool mailSender(string strSubject, string strFrom, string strFromName, string strTo, string strBody)
{
        SmtpClient smtpClient = new SmtpClient();
        MailMessage message = new MailMessage();

        try
        {
            MailAddress fromAddress = new MailAddress(strFrom, strFromName);

            smtpClient.Host = ConfigurationManager.AppSettings["smtpServer"];
            smtpClient.Port = 25;
            smtpClient.Credentials = new NetworkCredential(ConfigurationManager.AppSettings["smtpUsername"], ConfigurationManager.AppSettings["smtpPassword"]);

            message.From = fromAddress;

            message.To.Add(strTo);
            message.Subject = strSubject;

            message.IsBodyHtml = false;

            message.Body = strBody;

            smtpClient.Send(message);

            return true;
        }
        catch
        {
            return false;
        }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T16:59:25.493

您的 try/catch 块故意丢弃任何错误消息。删除它，看看你得到了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T17:02:44.100

支持布鲁斯所说的话，这样做：

```
try
    'your code here'
catch ex As Exception
    Response.Write(ex.Message)
end try 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T17:02:54.583

我注意到的一件事，尤其是在调试器中运行时，是 SmtpClient 似乎并没有真正发送邮件，直到它被处理掉。至少，当我关闭调试器时，我经常看到消息发出，而不是在实际应该发送邮件的时候。

# cucumber - 如何让黄瓜对 Selenium 和无头浏览器运行相同的步骤

> ID：930108
> 
> 赞同：4
> 
> 时间：2009-05-30T16:57:41.097
> 
> 标签：cucumber

我一直在用 Cucumber 做一些测试 Web 应用程序的工作，目前我已经设置了一些步骤来运行 Culerity。这很好用，但有时在 Selenium 中运行完全相同的故事会很好。

我看到两种可能可行的方法：

1.  编写每个步骤，以便它根据某个全局变量的值适当地执行该步骤。
2.  拥有单独的步骤定义文件，并以某种方式选择性地包含正确的文件。

完成此任务的首选方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-04T16:45:41.473

第三个选项：查看 Culerity 是否实现了 Webrat API。它的[README](http://github.com/langalex/culerity/tree/master)文件说：“Culerity 让您（...）重用现有的 Webrat-Style 步骤定义”。找不到比这更多的东西了。理想情况下，您可以使用配置选项或命令行参数切换后端，而无需触及步骤定义。

当然，这只有在您不测试 Culerity 支持的 Javascript 时才有效，但 Webrat 不支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-05T14:53:39.643

嗨，你看过水豚吗？它将允许您使用各种 Web 驱动程序，并允许您测试与 javascript 相关的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-03T15:07:55.147

我想这就是你要找的那个。[http://robots.thoughtbot.com/post/1658763359/thoughtbot-and-the-holy-grail](http://robots.thoughtbot.com/post/1658763359/thoughtbot-and-the-holy-grail)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-02T21:45:45.020

您可以安排测试在 Jenkins 中运行。本地机器 Jenkins 软件是开源的。您可以在 Jenkins 中获取黄瓜插件，以便在持续测试运行的基础上实现向项目报告部分

# wcf - 在当前程序集中为 WCF 代理重用类型

> ID：930124
> 
> 赞同：11
> 
> 时间：2009-05-30T17:05:17.747
> 
> 标签：wcf

VS WCF 集成有很好的选项“在引用的程序集中重用类型”。问题是我需要相同的，但对于当前的程序集。我的程序集中已经定义了一些类型，我需要重用它们。

使用场景：

1.  我有组装，这里有TypeA。
2.  我在其中添加了服务引用，其中一种方法返回与 TypeA（属性，名称）完全兼容的类型。
3.  添加服务引用会生成代理，但它会在其中重新创建新的 TypeA。

在第 3 步中，我需要返回 TypeA 的代理。不是新的TypeA。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-31T02:36:40.107

如果我了解您想要做什么，那么这是我经常遇到的一个场景，而且 WCF 确实有一个不错的答案：只是不要使用 SvcUtil / WS 服务参考向导。

如果您已经在客户端定义了大多数合同类（因为您有一个共享程序集，或者因为您在项目中定义了等效类），那么您最好进入下一步并导入完整的代码形式的服务合同，或者只是在客户端重新定义它。

没有什么会强迫您使用 svcutil 和朋友，只需定义您的接口并直接使用通道模型（即 ChannelFactory<T> 和朋友），或者，如果您更喜欢使用代理类，只需创建自己的 ClientBase<T>-派生类。这真的很容易，从长远来看，它会为您省去麻烦。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-08-19T08:34:00.717

有一种在客户端和服务之间共享类型的简单方法，只需在添加服务引用之前向客户端添加对共享类型程序集的引用即可。

您可以在那里找到详细的场景和示例项目：

[http://blog.walteralmeida.com/2010/08/wcf-tips-and-tricks-share-types-between-server-and-client.html](http://blog.walteralmeida.com/2010/08/wcf-tips-and-tricks-share-types-between-server-and-client.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:32:23.027

我有同样的问题，我想要一个测试工具来指向几个服务。每个服务都有共同的数据合同。

需要做什么：

1.  在每个 url 上使用 svcutil 和 /t:metadata。
2.  使用服务独有的名称重命名所有生成的文件（例如，将 lala.xsd 重命名为 1_lala.xsd）
3.  将所有生成的文件复制到一个位置
4.  将 svcutil 与 *.xsd *.wsdl /out:output.cs /namespace:* ,MySpecialNamespace 一起使用以将所有服务合同和数据合同生成到单个文件中。

如果您想变得狡猾：使用以下 T4 模板：

```
<#@ template language="C#v4.0" hostspecific="True"#>
<#@ import namespace="System.Diagnostics" #>
<#@ import namespace="System.IO" #>
<#=GetGeneratedCode(
"http://localhost/Service/Service1.svc",
"http://localhost/Service/Service2.svc",
"http://localhost/Service/Service3.svc",
"http://localhost/Service/Service4.svc"
)#>
<#+
const string _svcutil = @"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\svcutil.exe";

private string GetGeneratedCode(params string[] urls)
{
    var tmp = GetTemporaryDirectory();
    foreach (var url in urls)
    {
        GetMetadata(url, tmp);
    }

    RunSvcutil(tmp, "*.wsdl *.xsd /out:output.cs /namespace:*," +     Path.GetFileNameWithoutExtension(Host.TemplateFile));
    var result = File.ReadAllText(Path.Combine(tmp, "output.cs"));
    return result;
}

private static void RunSvcutil(string workingFolder, string arguments)
{
    var processInfo = new ProcessStartInfo(_svcutil);
    processInfo.Arguments = arguments;
    processInfo.WorkingDirectory = workingFolder;

    var p = Process.Start(processInfo);
    p.WaitForExit();
}

private static void GetMetadata(string url, string destination)
{
    var workingFolder = GetTemporaryDirectory();
    RunSvcutil(workingFolder, string.Format("/t:metadata \"{0}\"", url));

    foreach (var filename in Directory.GetFiles(workingFolder))
    {
        File.Copy(filename, Path.Combine(destination,     Path.GetFileNameWithoutExtension(url) + "_" +  Path.GetFileName(filename)));
    }
}

private static string GetTemporaryDirectory()
{
    string tempDirectory = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());
    Directory.CreateDirectory(tempDirectory);
    return tempDirectory;
}
#> 
```

# ruby-on-rails - 您如何将补丁应用于 ruby on rails？

> ID：930126
> 
> 赞同：14
> 
> 时间：2009-05-30T17:05:52.630
> 
> 标签：ruby-on-rails, ruby, rubygems, patch

我想应用此线程中提到的 action_mailer 补丁，但我之前从未应用过补丁，我不确定这些补丁是如何工作的： [https ://rails.lighthouseapp.com/projects/8994/tickets/2263](https://rails.lighthouseapp.com/projects/8994/tickets/2263)

我的行动邮件宝石在这里：/opt/ruby-enterprise-1.8.6-20090421/lib/ruby/gems/1.8/gems/actionmailer-2.3.2

我假设我需要去那个目录并运行补丁命令......像这样的东西？

```
cd /opt/ruby-enterprise-1.8.6-20090421/lib/ruby/gems/1.8/gems/
wget https://rails.lighthouseapp.com/attachments/108548/0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch
patch < 0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch 
```

我不太清楚的一件事是补丁文件是指“actionmailer”目录，但我的称为“actionmailer-2.3.2”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-30T19:45:04.070

您通常不想修补 gem 源本身。您可能希望将 gem 冻结成`${RAILS_ROOT}/vendor/rails`，然后在本地应用补丁。

从您的 ${RAILS_ROOT} 目录中，将所有 rails gem 转储到 vendor/rails

```
rake rails:freeze:gems 
```

应用补丁

```
 cd vendor/rails/ 
  patch -p1 < 0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T20:55:42.540

米科尔森的上述回答有效。但是要修补所有 rails 应用程序的实际 gem（请参阅我对他的回答的评论），这很有效：

```
cd /opt/ruby-enterprise-1.8.6-20090421/lib/ruby/gems/1.8/gems/actionmailer-2.3.2
wget sudo wget https://rails.lighthouseapp.com/attachments/108548/0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch
sudo patch -p2 < 0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch
sudo rm 0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch 
```

我发现如果出现任何问题，您也可以使用 -R 反转补丁。我很惊讶这个过程在某处没有得到更好的记录。希望这会出现在谷歌搜索中，寻找像我这样的新修补程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-11T23:59:51.443

这是一个用于修补 gem 的 shell one-liner：

> `patch -d "$(gem env gemdir)"/gems/actionmailer-* -p1 < <(curl -s https://rails.lighthouseapp.com/attachments/108548/0001-Fix-implicit-multipart-mailer-views-when-RAILS_ROOT.patch)`

另一个使用`gist`gem 的例子：

> `patch -d "$(gem env gemdir)"/gems/gist-* -p1 < <(curl -s https://github.com/defunkt/gist/commit/5843e9827f529cba020d08ac764d70c8db8fbd71.patch)`

# nhibernate - NHibernate 中的解析标准

> ID：930131
> 
> 赞同：0
> 
> 时间：2009-05-30T17:10:10.923
> 
> 标签：nhibernate

是否可以从字符串中解析标准？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T14:11:41.287

你没有给任何人太多继续，所以我只需要猜测你想问什么......

如果你正在寻找一个简单的`criteria.Parse("string here");`那么没有，我不存在这样的事情。

但是，标准接口非常适合动态创建（事实上，这是它的预期目的）。因此，是的，您可以编写一个字符串解析器来`ICriteria`从标记创建元素。

也许如果您提供有关您要解决的问题的更多信息，那么某人可以给出更好的答案。

# silverlight - MVVM 专家需要您对 MVVM 和 Dataforms 的意见

> ID：930137
> 
> 赞同：2
> 
> 时间：2009-05-30T17:16:20.760
> 
> 标签：silverlight, mvvm

据我了解，ViewModel 应该从视图中抽象模型并添加额外的逻辑来处理演示内容。

我的问题是：

我将如何创建一个假设可以同时处理用户输入的订单和详细信息的数据表单。它应该显示用于输入订单的字段以及用于 1 个详细信息的字段。

我的模型将有一个包含 OrderDetails 列表的订单对象。

我的 OrderEntryForm 的 ViewModel 看起来如何？

我会有一个 OrderViewModel 和一个 OrderDetailViewModel，而我的 OrderEntryForm 将包含一个 OrderViewModel 属性和一个 OrderDetailViewModel 属性吗？（嵌套 ViewModel？）在这种情况下如何处理验证？由于验证应该接近模型？尤其是当我使用 RIA-Service 时……将它放在 ViewModel 中不是更有意义吗？

你会从 ViewModel 中抽象出 Model 多远？例子：

```
 private DateTime _OrderDate;
        public DateTime OrderDate
        {
            get { return _OrderDate; }
            set
            {
                if (_OrderDate != value)
                {
                    _OrderDate = value;
                    OnPropertyChanged("OrderDate");
                }
            }
        } 
```

这意味着我必须将 ViewModel-Property 映射到 Model-Properties。此处无法利用模型中的验证逻辑...

这个例子：

```
 public DateTime OrderDate
        {
            get { return Model.OrderDate; }
            set
            {
                if (Model.OrderDate != value)
                {
                    Model.OrderDate = value;
                    OnPropertyChanged("OrderDate");
                }
            }
        } 
```

需要传入一个模型。可以访问模型的验证逻辑，但也可以耦合...

网络上的大多数示例显示使用 ViewModel 的数据表单只是表的表示而不是真正的抽象......

我知道并且我看到了这个

[stackoverflow.com/questions/744474/combining-net-ria-services-and-mvvm-in-silverlight-3-0](https://stackoverflow.com/questions/744474/combining-net-ria-services-and-mvvm-in-silverlight-3-0)

我还阅读了关于此的 nikhils 博客文章，但这也仅处理来自数据库表的 Products 直接映射... =(

我知道很多问题...

你对这个话题有什么看法？您将如何处理复杂的数据表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T02:43:04.093

我个人认为没有硬性规定……嗯，有一个——务实。

务实地说，视图模型是模型，数据模型也是。两者都是类，独立于 UI，表面状态作为属性，操作作为方法，通知作为事件。我认为在我看来区分它们的地方在于它们的通用性。我认为一个模型通常可以跨多个视图使用，而不是针对特定视图优化的视图模型。

我个人永远不会为了抽象而抽象。我永远不会为每个模型属性显示顶级属性并通过委托给底层模型来实现它。这增加了工作量。它增加了要测试的代码量。它需要传播元数据、更改通知等。如果要添加一些实际逻辑，那么是的，视图模型上会有一些属性，我会根据需要公开并委托给底层模型。即使在那里，我也会问将它们作为模型上的计算属性公开是否合理/合适（视图模型和数据模型都是模型）。

至于直接与不显示 DAL 类型，在我看来这有点正交。这取决于其他因素——你想抽象多少 DAL，DAL 类型有多有用——例如，如果 DAL 类型有很多外键，则表示模型等价物或投影可能更有用完成了一些非规范化。有时安全性可能是编写演示模型/投影的原因 - 例如。我不想向客户发送电子邮件地址，而是想要电子邮件地址的替代表示。

在我的示例中，我直接使用了 DAL 类型，以简化并且不会在单个示例中包含过多的概念。我确实想以专门的方式撰写有关演示模型和投影的博客……因此不想同时将 viewmodel 和 .net ria 服务的帖子与演示模型概念混合在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T19:25:56.937

克里斯，

我遇到了同样的问题，最终以一种糟糕的方式实现它:-(（每个视图一个两个 vieModel，但是将父视图传递给子视图......坏东西）。

从我的错误中，我了解到下次我会尝试：

*   生成单个 ViewModel，但在子视图中传递数据上下文中的详细实体（此详细实体不必与代理生成的实体匹配，可能是该实体的容器）。

*   生成一个单例控制器类：这个类不会暴露给视图，它对视图是透明的，只是细节视图模型会向控制器询问依赖数据而不是去 DAL。

    不确定这是否会是干净的解决方案，必须尝试并失败:)。

    我同意你的看法......这种场景没有真实的样本。

    你怎么看？

    谢谢布劳略

    PS：关于验证，如果我们创建自己的超级实体，我们可以在那里定义我们的验证，在我的情况下，我也尝试过使用部分案例扩展实体，然后我可以拥有一个带有特殊验证的实体 myPhoneNumberDetail。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-06T18:22:30.400

通常，对于模式，它确实取决于。ViewModel 可以公开底层模型，并且没有硬性规定说您“必须”隐藏所有内容并委托。我与许多严格遵守 LOD 的人交谈过，但他们仍然同意在 UI 绑定的情况下，它不适用。

现在，对于该模型是否是 DTO，您会发现很多不同的意见。一些人认为唯一应该在客户端上的是纯投影，即所有逻辑都存在于服务器上的 DTO，而另一些人则认为在层之间移动实体是可以的。那将是对不同帖子的讨论。:-)

一般来说，我推荐的指导方针总是至少有一个可用于屏幕状态等的高级 VM。

至于子模型，如 OrderDetail，那么如果子模型足以绑定到然后直接公开它。现在要考虑的一件事是通知，如果您的模型没有实现 INPC，那么您可能别无选择，只能将其包装以使绑定正常工作。

即使它实现了 INPC，也可能存在该模型不包含的特定于视图的关注点，但这些关注点是视图运行所必需的。在这种情况下，我将使用简单的聚合并创建一个 OrderDetailVM，它直接公开底层 OrderDetail 并添加其他属性。

例如

```
public class OrderDetailViewModel
{
  public OrderDetail OrderDetail {get;set;}
  public bool IsValid {get;set;}  
} 
```

IsValid 在哪里检查一些特定于屏幕的逻辑。

这实际上取决于您想要实现多少封装。我不会发现使用委托模型有什么问题。取决于复杂性，尽管它可能会变得笨拙，例如想象一下 OrderDetail 是否有额外的孩子，等等。

HTH格伦

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-01T06:10:40.920

澄清一下，VM 是模型的抽象，而不是视图的抽象，反之亦然。

您当然可以使用多个虚拟机来对应视图的离散部分。如果您不需要单独的 VM 用于 Order 和 Details，您可以只拥有一个包含所有内容的 OrderAndDetialsViewModel，整个 View 将直接绑定到它。这就是抽象的用武之地。

你是对的，你的模型的验证逻辑将不同于你的 ViewModel 的验证逻辑，如果你把任何东西放在那里的话。在任何情况下，验证都不会出现在视图中。

我不确定我是否遵循您的第二个示例。什么*是*模型对象？您的 VM 可能知道组成它的模型，但它不会将它/它们直接暴露给视图。

我希望这会有所帮助。如果您的帖子中有任何我未能解决的部分，请告诉我。

# c++ - 是 clrscr(); C++ 中的函数？

> ID：930138
> 
> 赞同：15
> 
> 时间：2009-05-30T17:16:21.727
> 
> 标签：c++

我到处寻找这个函数，但找不到头文件来使它工作。它说 clrscr() undeclared 这让我想到了这个问题。是 clrscr(); C++ 中的函数？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-30T17:18:44.457

在旧的 Borland C 编译器中，它曾经是 <conio.h> 中的一个函数。

它不是 C++ 标准函数。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-30T17:39:20.963

在有人发布通常的“请给我发送 conio.h 文件”请求之前，我可以指出这个古老的 Borland 头文件只包含函数的声明。您还需要支持 Borland 库，它与任何现代 C++ 编译系统都不兼容。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-30T17:55:00.690

如前所述，clrscr() 来自 turbo c++，在 conio.h 中

出于所有意图和目的，conio.h 是“非标准的”，因此应该避免使用。

我倾向于使用预编译器来选择用于简单清屏的内容，然后调用操作系统的清屏程序......它足够聪明，可以知道屏幕有多“高”。

```
// somewhere in the program
#define WINDOWS 1

void console_clear_screen() {
  #ifdef WINDOWS
  system("cls");
  #endif
  #ifdef LINUX
  system("clear");
  #endif
} 
```

在 windows 中，您可能想查看 windows.h，您可以使用“句柄”直接与 windows 控制台交互，通常在代码中记为 hWin。

在 linux 中，我对 curses/ncurses 很幸运，虽然起初它有点令人困惑。

*更新*调用系统程序（clear.exe？）是一个潜在的安全风险 - 如果有人能够通过其他途径以某种方式劫持系统调用，他们可以强迫你的程序做奇怪的事情。我的建议是深入研究您平台的控制台 api 来完成这些事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T17:25:43.620

您必须为此功能包含此头文件

```
#include <conio.h> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T17:20:55.403

网络搜索显示您想要的头文件是“conio.h” - 我还没有尝试过，所以不能保证。它的存在还可能取决于您正在编译的平台。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-03T16:24:57.623

您可以使用系统 cls 命令清除输出屏幕..

clrscr() 来自 turbo c++，在 conio.h 和 conio.h 中是“非标准的”，因此应该避免使用。例子

```
 #include<windows.h>
    main()
    {
    some code....;
    system("cls");
    some more code;
    } 
```

它经过测试并且可以工作..我使用带有mingw编译器的dev c++ .. :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-13T06:34:52.617

在 Linux 上，我总是使用：

```
void clrscr(void)
{
   fprintf(stdout, "\033[2J"); // clean screen
   fprintf(stdout, "\033[1;1H"); // move cursor to the first line
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T17:23:04.763

在真正的 C++ 中清除屏幕的最简单方法是发送一堆空白行。当然，这是假设标准输出指向屏幕而不是文件：

```
for (int i = 0; i < 80; ++i)
     cout << "\n";
cout << endl; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-22T14:25:35.797

在类 Unix 系统上，您可以使用 VT100 转义码。

```
std::cout << "\033[2J" << std::flush; 
```

见[http://www.termsys.demon.co.uk/vtansi.htm](http://www.termsys.demon.co.uk/vtansi.htm)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-30T22:57:05.820

我以前也做borland。

研究诅咒是个好主意。它适用于许多 unix 平台。

您可以在 source forge 上查看[nconio](http://cvs.sourceforge.jp/view/spartanz/ircpp/nconio/)。

[这](http://www.cs.colorado.edu/~main/cs1300/doc/bgi/index.html)看起来也很有希望。

# c# - 如何在 C# 中获取对象的小写名称，即使为 null

> ID：930147
> 
> 赞同：64
> 
> 时间：2009-05-30T17:21:24.843
> 
> 标签：c#

我有 C# 方法

```
private static string TypeNameLower(object o)
{
   return o.GetType().Name.ToLower();
} 
```

给我输入对象的小写类型名称。

但是，如果输入是设置为 null 的字符串或设置为 null 的可空 int，则此方法当然会失败。

在这种情况下如何获取类型名称？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-30T17:24:29.813

杰夫是正确的。这就像问一个没有标签的空盒子里会有什么样的蛋糕。

作为 Fortran 答案的替代方案，您还可以执行以下操作：

```
string TypeNameLower<T>(T obj) {
   return typeof(T).Name.ToLower(CultureInfo.InvariantCulture);
}

string TypeNameLower(object obj) {
   if (obj != null) { return obj.GetType().Name.ToLower(CultureInfo.InvariantCulture); }
   else { return null; }
}

string s = null;
TypeNameLower(s); // goes to the generic version 
```

这样，如果 C# 对您传入的类型有足够的了解，C# 将在编译时选择泛型。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-12-14T07:15:58.740

我想我会发布我的答案，即使这个问题很老，因为在我看来，接受的答案是错误的。这个答案很有创意，所以我不想敲它。据我所知，这*可能*是 OP 真正想要的。

但是，正如您将从下面的示例中看到的那样，我认为在几乎**所有**情况下，使用已接受答案中描述的通用函数的想法要么是（A）不必要的，要么是（B）完全错误的。我已经从接受的答案中复制了我正在谈论的通用函数并将其粘贴在下面以供参考：

```
string TypeNameLower<T>(T obj) {
    return typeof(T).Name.ToLower();
} 
```

现在，让我们看看这个函数的一些使用方式：

**不需要通用函数的示例：**

```
var s = "hello";
var t = TypeNameLower(s);

//or
foreach(char c in "banana")
    WriteLine(TypeNameLower(c));

//or
foreach(MyCustomStruct x in listOfMyCustomStruct)
    WriteLine(TypeNameLower(x)); 
```

在这些示例中，该函数有效——也就是说，它确实返回了*正确*的值，分别是“string”、“char”和“mycustomstruct”。然而，在所有这样的情况下，（即泛型函数实际上确实返回了正确的类型），编译器提前知道变量的定义类型是什么，当然程序员也是如此（除非他们对它们的变量名）。所以这个函数是完全没有必要的，程序员不妨这样做：

```
var s = "hello";
var t = "string";

//or
foreach(char c in "banana")
    WriteLine("char");

//or
foreach(MyCustomStruct x in listOfMyCustomStruct)
    WriteLine("mycustomstruct"); 
```

起初这可能看起来很幼稚，但想一想......它可能需要一段时间才能真正融入......尝试提出任何使用通用函数在**运行时**提供准确信息的场景'在**编译时**未知（因此可以由编译器或代码生成实用程序如 T4 模板自动生成）。

现在，上一组示例的重点只是展示了泛型函数的一个小麻烦——在它返回*正确*结果的每种情况下都没有必要。但更重要的是，看看下面的例子。他们证明，在任何其他情况下，如果您希望函数返回对象的*真实*运行时类型的名称，则泛型函数的结果实际上是***错误的。***该函数实际上**只**保证返回可分配真值的类型的名称，它可能是祖先类、接口或“对象”本身。

 *****泛型函数错误的示例**

```
Stream ms = new MemoryStream();
IEnumerable str = "Hello";
IComparable i = 23;
object j = 1;

TypeNameLower(ms); //returns "stream" instead of "memorystream"
TypeNameLower(str); //returns "ienumerable" instead of "string"
TypeNameLower(i); //returns "icomparable" instead of "int32"
TypeNameLower(j); //returns "object" instead of "int32"
TypeNameLower<object>(true); //returns "object" instead of "bool" 
```

如您所见，在所有情况下，结果都是非常错误的。现在，我承认最后两行有点做作来证明这一点（更不用说`TypeNameLower(j)`实际上会被编译为使用函数的非泛型版本，这也是公认答案的一部分——但你得到了主意...）

问题是该函数实际上忽略了传入的对象的类型，只使用泛型参数类型的（编译时）信息来返回值。

更好的实现如下：

```
string TypeNameLower<T>(T obj) {
    Type t;
    if (obj == null)
        t = typeof(T);
    else 
        t = obj.GetType();
    return t.Name.ToLower();
} 
```

现在，只要对象为非空，该函数就会返回真正的运行时类型的名称，并且当类型为 时，它默认为编译时/定义的类型`null`。

重要的是，这个函数可以在没有非通用版本的情况下使用！！结果将是该函数**永远不会**返回`null`。最一般的返回值将是“对象”，例如：

```
 object x = null; 
 string s = null;
 byte[] b = null;
 MyClass m = null;
 TypeNameLower(x); // returns "object"
 TypeNameLower(s); // returns "string"
 TypeNameLower(b); // returns "byte[]"
 TypeNameLower(m); // returns "myclass" 
```

请注意，这实际上**更符合**OP 所要求的功能的定义目标。也就是说，如果 OP*真的*想找出对象的类型名称是什么，*如果它不是 null*，那么返回 null 永远不会是一个合适的答案，因为 null 不是任何类型的名称，并且typeof(null) 未定义。

C# 中的每个变量都源自`System.Object`，因此根据定义，如果值不是，`null`那么它将*是*一个`Object`并且在许多情况下，这是在运行时可以确定的关于空引用的最多值。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-01-12T18:51:21.950

```
// Uses the compiler's type inference mechanisms for generics to find out the type
// 'self' was declared with in the current scope.
static public Type GetDeclaredType<TSelf>(TSelf self)
{
    return typeof(TSelf);
}

void Main()
{
    // ...

    Foo bar;
    bar = null;

    Type myType = GetDeclaredType(bar);
    Console.Write(myType.Name);
} 
```

印刷：

```
Foo 
```

我也在一个类似的主题上发布了这个，我希望它对你有用。;-)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-30T17:25:03.167

```
if (o == null) return "null";
else return o.GetType().Name.ToLower(); 
```

一个简单问题的简单解决方案：-p

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-30T17:38:01.670

正如其他人所说，你不能。对于允许对对象进行纯空引用的语言，这实际上是一个众所周知的问题。解决它的一种方法是使用“空对象模式”。基本思想是，您不使用`null`空引用，而是为它分配一个“什么都不做”对象的实例。例如：

```
public class Circle
{
    public virtual float Radius { get; set; }

    public Circle(float radius)
    {
        Radius = radius;
    }
}

public class NullCircle : Circle
{
    public override float Radius 
    { 
        get { return float.NaN; }
        set { }
    }

    public NullCircle() { }
} 
```

然后，您可以传递一个实例，`NullCircle`而不是，`null`您将能够像在代码中一样测试它的类型。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T17:22:40.067

据我所知，你不能。Null 表示没有值，并且对于不同的类型没有区别。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-30T17:25:05.523

没有任何概念认为空字符串不同于空数组与空值不同。从函数内部，您无法确定类型名称。

更具体地说，引用类的实例（内部）包括指向有关对象的类型信息的“指针”。当输入为空时，没有这样的指针，所以类型信息不存在。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-08T18:42:59.153

只是扩展@Jos​​h Einstein 的回答。

下面是两种获取变量类型的扩展方法，即使它当前设置为 null。

```
 /// <summary>
    /// Gets an object's type even if it is null.
    /// </summary>
    /// <typeparam name="T">The type of the object.</typeparam>
    /// <param name="that">The object being extended.</param>
    /// <returns>The objects type.</returns>
    public static Type GetTheType<T>(this T that)
    {
        return typeof(T);
    }

    /// <summary>
    /// Gets an object's type even if it is null.
    /// </summary>
    /// <param name="that">The object being extended.</param>
    /// <returns>The objects type.</returns>
    public static Type GetTheType(this object that)
    {
        if (that != null)
        {
            return that.GetType();
        }

        return null;
    } 
```

此外，这里有两个简单的单元测试来测试扩展方法。

```
 /// <summary>
    /// Tests to make sure that the correct type is return.
    /// </summary>
    [Test(Description = "Tests to make sure that the correct type is return.")]
    public void Test_GetTheType()
    {
        var value = string.Empty;

        var theType = value.GetTheType();

        Assert.That(theType, Is.SameAs(typeof(string)));
    }

    /// <summary>
    /// Tests to make sure that the correct type is returned even if the value is null.
    /// </summary>
    [Test(Description = "Tests to make sure that the correct type is returned even if the value is null.")]
    public void Test_GetTheType_ReturnsTypeEvenIfValueIsNull()
    {
        string value = null;

        var theType = value.GetTheType();

        Assert.That(theType, Is.SameAs(typeof(string)));
    } 
```

***编辑*** 对不起，我忘了提到我目前正在进行的项目需要这个完全相同的功能。所有功劳仍应归功于@Josh Einstein：D

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-21T12:16:02.897

令人沮丧的是，C# 不允许做出这样的决定。这并不类似于问你会在一个空盒子里有什么蛋糕 - 一个对象包含两个独立的组件 - 对象的“化身”和用于创建对象的类的信息。无法轻松访问此信息这一事实是 C# 开发人员的疏忽。

通过确定，您所能做的就是这种相当严重的方法：

```
void Method(object obj)
{
if(obj is int)
{
//obj is of the int type
}
else if(obj is SomeComplexType)
{
//obj is of the SomeComplexType type
}
} 
```

因此，您可以看到，即使对象为空，其类型信息仍然与对象一起传播，它并没有丢失，您只是无法轻松访问它。但这至少可以说是不方便的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-12T18:42:36.380

如果您自己有一个对象（假设作为对象类型的方法的输入参数），没有定义或泛型类型，则无法找到该类型。原因很简单，**您不能向对象发送消息（调用任何方法）以询问类型**。

正如您在某些答案中看到的那样，可能还有其他一些解决方法，例如使用泛型类型。在这种情况下，您不是在询问 Null 对象，而是在询问泛型类型的类型。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-30T17:41:28.653

考虑这段代码：

```
 public class MyClass1{}
    public class MyClass2{}

    public static void Test1()
    {
        MyClass1 one = null;
        MyClass2 two = (MyClass2) (object) one;

        one = new MyClass1();
        //invalid cast exception
        two = (MyClass2)(object) one;
    } 
```

`object`至少从类型安全的角度来看，空实例的运行时类型是。

# php - 停止在 PHP 中显示通知

> ID：930154
> 
> 赞同：9
> 
> 时间：2009-05-30T17:24:21.780
> 
> 标签：php

我希望我的通知停止在 PHP 中显示。代码中没有错误，它只是说诸如未定义索引之类的东西。对此无能为力。

那么如何阻止它显示呢？

```
Notice: Undefined variable: username in C:\wamp\www\watchedit\includes\config.php on line 37

Notice: Undefined variable: key in C:\wamp\www\watchedit\includes\config.php on line 42 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-30T17:26:22.230

这将以编程方式关闭环境的通知——来自 PHP.net。

```
// Report all errors except E_NOTICE   
error_reporting(E_ALL ^ E_NOTICE); 
```

在某些地方，您可以在语句前加上“@”，如果它引起通知，它将只使该位置静音。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T17:29:24.443

[`isset`](http://docs.php.net/isset)在尝试读取其值之前，您应该检查变量是否存在。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-30T17:31:04.813

> 对此无能为力。

在大多数情况下，情况并非如此。可以声明未定义的变量，可以使用[isset(mixed...)](http://de3.php.net/manual/en/function.isset.php)测试未定义的索引。

此外，您应该按照上面的建议使用 error_reporting(...) 配置您的环境。在生产环境中，还建议禁用[display_errors](http://de3.php.net/manual/en/errorfunc.configuration.php#ini.display-errors)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T17:27:05.723

*   更改`[error_reporting](http://lt.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)`php.ini
*   利用`[error_reporting](http://php.net/manual/en/function.error-reporting.php)(E_ALL & ~E_NOTICE | ...)`
*   ...或者只是修复导致通知出现的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T22:47:22.033

努力不产生任何通知是一个健康的目标，因为它们将开始标记潜在的错误或问题。您可以编写自己的错误处理程序来记录这些，因为它们应该（希望）很少而且相距甚远。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-02T20:40:22.873

因为我没有 php.ini 所以我只是把这个标签放在后面

```
error_reporting(E_ALL ^ E_NOTICE); 
```

# jquery - 带有选项的 jQuery 自动完成图像

> ID：930159
> 
> 赞同：2
> 
> 时间：2009-05-30T17:26:06.910
> 
> 标签：jquery, autocomplete

我是 jQuery 的新手。但对它真的很着迷。向 jQuery 团队致敬

我有一个 aspx 页面，我想为文本框实现自动完成功能，用户将在其中键入以搜索产品。如果他们键入，我想在选项中显示名称为 a 的产品及其图像。我有一个数据库具有 3 列 ProductId、ProductName 和 Image Name 的表。

我尝试了 jQuery 自动完成插件 gin。但找不到满足我要求的解决方案。任何人都可以指导我如何继续。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T17:33:39.973

您需要从您的服务器端代码将产品名称和图像 URL 提供回自动完成插件。然后，您可以`formatItem`在插件[选项](http://docs.jquery.com/Plugins/Autocomplete/autocomplete#url_or_dataoptions)中覆盖以修改标记。本质上，您需要创建显示名称和图片的 html。[请参阅http://jquery.bassistance.de/autocomplete/demo/](http://jquery.bassistance.de/autocomplete/demo/)上的图像搜索演示。这是该演示的代码：

```
$("#imageSearch").autocomplete("images.php", {
    width: 320,
    max: 4,
    highlight: false,
    scroll: true,
    scrollHeight: 300,
    formatItem: function(data, i, n, value) {
        return "<img src='images/" + value + "'/> " + value.split(".")[0];
    },
    formatResult: function(data, value) {
        return value.split(".")[0];
    }
}); 
```

# asterisk - Asterisk Dialplan (extensions.conf) 应用程序

> ID：930166
> 
> 赞同：2
> 
> 时间：2009-05-30T17:30:17.373
> 
> 标签：asterisk

我正在开发一个应用程序，允许用户使用他们的手机访问他们的邮箱。我开发了一个 IVR 菜单，用户将使用它来检索他们的邮件。更具体地说，我在 perl 中编写了一个 AGI 来检索邮件。问题是 AGI 执行需要很长时间。为此，我需要让我的用户在执行 agi 时听到一些在后台播放的音乐。也就是说，我需要让拨号方案中的“AGI”和“MusicOnHold”应用程序同时执行。任何线索我如何能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T19:02:34.843

您可以`SET MUSIC ON`从您`AGI`的应用程序发出，处理您的计算，然后发出`SET MUSIC OFF`.

如果您希望音乐可中断，请发出以下命令：

```
CONTROL STREAM FILE <filename> "0123456789*#" "0" "" "" "" 
```

第二个参数是能够打断音乐的数字列表。

最好不要混合`AGI`和拨号计划命令。

`AGI`可以做任何 dialplan 可以做的事情，但`AGI`它是用一种成熟的编程语言实现的，因此可以让您更好地控制执行逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T17:44:38.647

这可能不是您期望的答案，但是如果您打算创建一个适当的应用程序来通过电话做事，请查看除星号之外的其他解决方案。yate 和（据我所知 - 从未尝试过这个用于任何严重的事情）freeswitch 都实现了一个更加异步的接口，您可以在其中将传入呼叫连接到您想要的任何声源，而不会失去对其的控制。对于高级应用程序，它们可能是更好的选择。

Asterisk 对于​​简单的逻辑来说很酷，但是如果您需要在后台进行一些处理并将调用保持在某种状态下一段未定义的时间，则变得非常难以管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T17:45:08.277

完整的执行需要很长时间还是只是启动应用程序？如果整个执行时间太长，那么您可以按照 Quassnoi 的说法，在 AGI 程序启动后立即开始播放音乐。

如果启动时间是问题，那么您可能需要使用 FastAGI 实现一些东西，以便您的应用程序始终运行并通过套接字侦听连接。在具有大量 AGI 调用的环境中，性能要好得多。

# svn - 可以将相同的文件提交到 2 个 SVN 存储库吗？

> ID：930168
> 
> 赞同：1
> 
> 时间：2009-05-30T17:31:52.490
> 
> 标签：svn, version-control, tortoisesvn

如果我有一些特别重要的文件，它们可以被 SVN 提交到两个存储库吗？

我可以在两台不同的机器上设置两个 SVN 存储库，这样如果一台机器出现问题，那么总会有一个备份。

（最好是 Tortoise 或命令行）。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T17:40:10.433

您可以在服务器上使用**svnsync**来创建原始存储库的镜像。

更多信息： http: [//svn.apache.org/repos/asf/subversion/trunk/notes/svnsync.txt](http://svn.apache.org/repos/asf/subversion/trunk/notes/svnsync.txt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T17:47:57.830

好吧，您可以使用 post-commit-hook 并将整个存储库（或仅重要文件）提交到另一个存储库。这将消除记住将所有内容提交到两个存储库的痛苦，并且是一个优雅的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T17:48:20.387

扩展 activa 的想法（使用[svnsync](http://svn.apache.org/repos/asf/subversion/trunk/notes/svnsync.txt)），您可以通过在 SVN 挂钩脚本（例如[post-commit](http://svnbook.red-bean.com/en/1.4/svn-book.html#svn.ref.reposhooks.post-commit) ）中触发 svnsync 在每次提交后运行它。这样，在每次提交后，您的辅助副本将与您的主副本同步，从而始终使您的备份保持最新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T17:49:45.457

如果您担心丢失存储库数据，那么进行自动备份是一种可能的解决方案。“svnadmin dump”命令非常适合。

我使用这个脚本来创建我所有存储库的转储：

```
#!/bin/bash

DATE=`date "+%F"`
BACKUPDIR=/var/backup

# dump subversion repos.
# all subversion projects are in /usr/local/svn
for REPODIR in /usr/local/svn/*
do
    REPONAME=`basename $REPODIR`
    TARGET=svndump-$REPONAME-$DATE.gz
    echo backing up svn repository $REPODIR to $TARGET
    svnadmin dump $REPODIR | gzip > $BACKUPDIR/$TARGET || exit 1
done 
```

此脚本从 cron 作业运行。您可以添加 rsync 命令将这些转储复制到不同的服务器。

# c# - 在 C# 中编写批处理脚本的好方法是什么？

> ID：930169
> 
> 赞同：12
> 
> 时间：2009-05-30T17:32:26.187
> 
> 标签：c#, shell, command-line, powershell, batch-file

我想用 C# 编写简单的脚本。我通常会使用 .bat 或 4NT .btm 文件的东西。复制文件、解析文本、询问用户输入等等。相当简单，但在批处理文件中做这些事情真的很难（例如，没有例外）。

我熟悉像 AxScript 这样的命令行“脚本”包装器，所以这让我成为了其中的一部分。我缺少的是简单的文件操作框架。我希望能够做 cd(".."), copy(srcFile, destFile) 类型的功能。

我尝试过的工具：

*   NANT，我们在构建过程中使用。不是一个好的脚本工具。非常冗长的 XML 语法和添加一个简单的函数，您必须编写一个扩展程序集。不能内联。

*   电源外壳。看起来不错，但我只是无法切换到它作为我的主要 shell。与 4NT 的区别太多了。无论我做什么都需要从一个普通的命令提示符下运行，而不需要一个特殊的 shell 来运行它。PowerShell 可以用作脚本执行器吗？

*   Perl/Python/Ruby。真的很讨厌学习一门全新的语言和框架来进行批处理文件操作。我无法投入我需要的时间来做这件事。另外，我们是 99% 的 .NET 工具链商店，我真的很想利用我们现有的经验和代码库。

是否有框架试图解决您使用过的“在 C# 中制作批处理文件”的问题？

我想要 C#/.NET 的强大功能以及典型 cmd.exe shell 语言的即时模式类型功能。只有我一个人想要这样的东西吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-30T17:37:48.113

我会尝试克服 PowerShell 的焦虑，因为它是未来的外壳。微软推出的所有软件都将其用作管理界面，尤其是 2.0 版非常有用。

我大部分时间都是 C# 开发人员，但 PowerShell 已经解决了临时项目堆积起来的整个“WindowsApplication42”问题。PowerShell 使您可以在命令行 shell 中完全访问 .NET 框架，因此即使您不知道如何在 PowerShell 中执行某些操作，您也很可能知道如何在 .NET 中执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T17:39:45.597

IronPython 和 IronRuby**确实**让您可以利用您所有的 .NET“经验和代码库”（但是，它们不会回答您对学习新语言的反对意见）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T18:11:30.757

如果您有任何 bash 书呆子，您可以随时尝试[cygwin](http://www.cygwin.com/)。

还要记住，Python 最初是作为一种“胶水”语言而设计的。如果您使用了前面提到的[IronPython](http://www.codeplex.com/IronPython)，则很容易将预先编写的 C# 类联系在一起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T06:09:29.080

如果你绑定到 MS，PowerShell 肯定是要走的路。但我不太喜欢它。

我个人更多地使用 MSBuild 脚本，并且希望有一天 Mono C# Shell 能够出现在 Windows 上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-19T07:07:59.290

我认为[CS-Script](http://www.csscript.net/)可能是您的理想解决方案。

# php - 如何在php中上传和显示头像？

> ID：930182
> 
> 赞同：2
> 
> 时间：2009-05-30T17:39:44.270
> 
> 标签：php, upload, avatar

好的，我想用我的用户 reg 加载头像，以便他们可以上传并制作个人资料页面我有用户 reg 和所有内容，并且我在 php 中使用平面文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T17:43:08.790

您应该考虑将现有的头像服务（例如[Gravatar](http://en.gravatar.com/) ）集成到您的应用程序中。它最终可能会为您和您的用户节省大量时间。来自 Gravatar 网站：

> gravatar，或全球公认的头像，很简单，就是在您做事时跟随您从一个站点到另一个站点的图像，出现在您的名字旁边。头像有助于识别您在博客和网络论坛上的帖子，那么为什么不在任何网站上呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T18:32:46.587

只需将头像上传视为任何照片上传即可。创建头像/图像上传表单以将图像上传到个人资料页面中的服务器。

# c# - C# 中的“受保护”方法？

> ID：930190
> 
> 赞同：24
> 
> 时间：2009-05-30T17:42:29.010
> 
> 标签：c#, .net, visual-studio, oop, access-modifiers

`protected`在 C#中定义方法有什么好处？

像 ：

```
protected void KeyDemo_KeyPress( object sender, KeyPressEventArgs e ) 
{
    // some code
} 
```

与这样的东西相比：

```
private void FormName_Click( object sender, EventArgs e )
{
    //some code
} 
```

我在很多书中都看到过这样的例子，但我不明白他们为什么以及何时使用`private`vs `protected`？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-30T17:44:35.777

**可以从派生类调用受保护的方法。私有方法不能。**

这是私有方法和受保护方法之间的唯一区别。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T17:58:38.313

当您希望子类覆盖其他“私有”方法时，通常会使用“受保护”。

```
public class Base {
    public void Api() {
       InternalUtilityMethod();
    }
    protected virtual void InternalUtilityMethod() {
       Console.WriteLine("do Base work");
    }
}

public class Derived : Base {
    protected override void InternalUtilityMethod() {
       Console.WriteLine("do Derived work");
    } 
} 
```

因此，我们从继承中获得了我们知道和喜爱的覆盖行为，而无需将 InternalUtilityMethod 暴露给我们类之外的任何人。

```
var b = new Base();
b.Api();  // returns "do Base work"
var d = new Derived();
d.Api(); // returns "do Derived work" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-07T21:48:30.083

1.  受保护的方法可以通过继承类来访问，而私有方法不能。
2.  请记住 .aspx 和 .ascx 文件继承自它们的代码后面的类 (default.aspx.cs)，可以从 .aspx/.ascx 中访问受保护的方法

请记住这一点：如果您有一个按钮并且该按钮的 OnClick 设置为 Button_Click

```
<asp:Button id="btn" runat="server" OnClick="Button_Click" /> 
```

那么 Button_Click 方法至少需要具有受保护的可见性才能被按钮访问。

您可以通过在 Page_Load 方法中添加以下内容来解决此问题：

```
btn.Click += new EventHandler(Button_Click); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T17:44:58.490

.NET 的某些方面（例如 ASP.NET）会在运行时创建代码隐藏类的子类。因此，例如 ASP.NET Page 类从其代码隐藏类继承。通过使方法受保护，动态生成的页面类可以轻松地将按钮单击事件连接到处理它的基类中的受保护方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T17:45:04.963

如果你有一个继承的形式（或任何类），你将能够从子类中调用这个函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-06T11:53:12.227

受保护的方法就像私有方法一样。只有类的成员才能访问它们。唯一的区别是与私有成员不同，受保护的成员也可以被派生类访问。

# c# - WeakReference 是否提供良好的缓存？

> ID：930198
> 
> 赞同：19
> 
> 时间：2009-05-30T17:46:35.867
> 
> 标签：c#, .net, caching, garbage-collection, weak-references

我有一个缓存，它使用对缓存对象的 WeakReferences 来使它们在内存压力的情况下自动从缓存中删除。我的问题是缓存对象在存储在缓存中后很快就被收集起来。缓存在 64 位应用程序中运行，尽管仍有超过 4gig 的内存可用，但仍会收集所有缓存的对象（此时它们通常存储在 G2 堆中）。正如进程资源管理器所示，没有手动引发垃圾收集。

我可以应用哪些方法来使对象的寿命更长一些？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-30T18:26:14.243

使用 Wea​​kReferences 作为引用缓存对象的主要方法并不是一个好主意，因为正如 Josh 所说，您将受制于 WeakReference 和 GC 的任何未来行为变化。

但是，如果您的缓存需要任何类型的复活功能，则对待清除的项目使用 Wea​​kReferences 很有用。当一个项目满足逐出标准时，而不是立即逐出它，您将其引用更改为弱引用。如果在 GC 之前有任何请求，您可以恢复其强引用，并且该对象可以再次存活。我发现这对于一些难以预测命中率模式且具有足够频繁“复活”的缓存很有用。

如果您有可预测的命中率模式，那么我会放弃 WeakReference 选项并执行显式驱逐。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-30T03:24:00.237

在一种情况下，`WeakReference`基于 - 的缓存可能很好：当类中某项的有用性取决于对其的引用时。在这种情况下，弱内部缓存可能很有用。例如，如果一个应用程序会反序列化许多大型不可变对象，其中许多对象预计是重复的，并且必须在它们之间执行许多比较。如果`X`并且`Y`是对某些不可变类类型的引用，则测试`X.Equals(Y)`如果两个变量都指向同一个实例，将会非常快，但如果它们指向恰好相等的不同实例，则可能会非常慢。如果一个反序列化的对象碰巧与另一个已经存在引用的对象匹配，那么从字典中获取对该后一个对象的引用（需要一个缓慢的比较）可能会加快未来的比较。另一方面，如果它匹配字典中的一个项目，但字典是对该项目的*唯一*引用，那么使用字典对象而不是简单地保留读入的对象几乎没有什么好处；可能没有足够的优势来证明比较的成本是合理的。对于实习缓存，有`WeakReferences`一旦不存在对对象的其他引用，尽快使其失效将是一件好事。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T19:57:57.133

在 .net 中，从 GC 的角度来看，WeakReference 根本不被视为引用，因此任何只有弱引用的对象都将在下一次 GC 运行中被收集（用于适当的生成）。

这使得弱引用完全不适合缓存 - 正如您的经验所示。

您需要一个“真正的”缓存组件，而关于缓存最重要的事情是让驱逐策略（即有关何时从缓存中删除对象的规则）与您的应用程序的使用模式非常匹配。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T17:50:03.723

不，WeakReference 对此不好，因为垃圾收集器的行为会随着时间而改变，并且您的缓存不应该依赖于今天的行为。您无法控制的许多因素也可能会影响内存压力。

.NET 的缓存有很多实现。您可能会在 CodePlex 上找到十几个。我想您需要添加的是查看应用程序当前工作集以将其用作清除触发器的内容。

关于为什么您的对象被如此频繁地收集的另一个注意事项。GC 非常积极地清理 Gen0 对象。如果您的对象的生命周期非常短暂（直到对它的唯一引用是弱引用），那么 GC 正在尽其所能尽快清理。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-16T14:49:58.397

我相信你遇到的问题是垃圾收集器删除弱引用的对象*不仅*是为了响应内存压力 - 相反它有时会非常积极地进行收集，只是因为运行时系统认为某些对象可能已经变得无法访问。

您可能最好使用 System.Runtime.Caching.MemoryCache ，它可以配置内存限制或项目的自定义驱逐策略。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-21T02:08:54.507

有点晚了，但这里有一个相关的用例：

我需要缓存两种类型的对象：大型（反序列化）数据文件，加载需要 10 分钟，每个文件花费 15G 内存，以及包含对这些数据文件的内部引用的较小（动态编译）对象（较小的对象也被缓存因为它们需要大约 10 秒来生成）。这些缓存隐藏在提供对象的工厂中（前者组件不知道后者），并具有不同的驱逐策略。

当我的“数据文件”缓存驱逐一个对象时，它会用一个弱引用替换它，所以如果该对象在下一次请求时仍然可用，我们可以复活它（并更新它的缓存超时）。通过这种方式，我们避免在任何对象真正失效（即未在其他任何地方使用）之前丢失（或意外复制）任何对象。请注意，两个缓存都不需要知道另一个，并且没有其他客户端对象需要知道有任何缓存（例如：我们避免需要“keepalives”、回调、注册、检索和返回范围等——事情变得简单多了）。

因此，尽管单独使用 Wea​​kReference（而不是缓存）是一个糟糕的想法（因为现代 GC 通常会调整到 L2 CPU 缓存的大小，并且常规代码每分钟会烧掉很多次），但它作为一个非常有用的向其余代码*隐藏缓存的方法。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-15T04:14:43.043

答案实际上取决于您尝试构建的缓存的使用特性。我已经成功地使用基于 WeakReference 的缓存策略来提高我的许多项目的性能，在这些项目中，缓存对象预计将用于短时间的多次读取。正如其他人指出的那样，从 GC 的角度来看，弱引用几乎是垃圾，并且会在下一个 GC 周期运行时被收集。这与内存利用率无关。

但是，如果您需要一个能够在 GC 中幸存下来的缓存，您需要使用或模仿 System.Runtime.Caching 命名空间提供的功能。请记住，当内存使用量超过您的阈值时，您需要一个额外的线程来清理缓存。

# ms-access - .mdb 访问文件可以支持多少个同时连接？

> ID：930199
> 
> 赞同：3
> 
> 时间：2009-05-30T17:47:00.467
> 
> 标签：ms-access

我有一个网站 (www.soltrago.com) wghere 我使用 .mdb microsoft access 数据库在页面加载时检索数据。我使用 dns less 连接来连接数据库。我的问题是我的网页可以同时连接多少个连接？比如每秒有多少人可以查看我的网页？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T18:21:07.527

我想知道你为什么不直接使用 SQL Server Express Edition ——一个可扩展得多的引擎，但仍然是免费的。

（编辑）

作为额外的奖励；当您的站点“起飞”并且您需要更多的咕噜声（更大、更多 CPU、更多内存、更多故障转移、集群等）时，您只需购买一个更大的盒子和一个 SQL Server 许可证，您就可以开始了；你没有 mdb 那样的奢侈。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T18:21:09.447

这个问题没有单一的答案。

例如，我可以说... 25，这可能是真的，因为在某些情况下，您可以同时针对数据库运行 25 个用户。

或者我可以说 150，这可能是真的。

问题是，我也可以说 75，但这不是真的，主要是因为您使用数据库的方式存在严重的性能问题。

或者我可以说 2，但这也不是真的，因为您建立的每个连接都会锁定相同的数据，因此您最终会序列化每个访问，因为每个其他用户都必须等待第一个用户完成他的事务，因此解锁数据。

多少用户是数据库引擎的上限，以及您使用数据库的方式的函数。[我在评论中链接到](http://www.tek-tips.com/faqs.cfm?fid=4462)的页面说上限是 255。我不能保证这一点，但这听起来很合理，因为访问并不意味着是一个多用户数据库。当然，它可以处理它，但它并不意味着为成千上万的用户提供服务。

您最好的选择实际上是获取某种负载测试应用程序，并查看您的应用程序何时开始出现严重的性能问题，或者甚至可能只是崩溃。

除此之外，没有人能告诉你正确的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T18:12:52.937

您的 Web 应用程序可能只有一个与 MS Access 文件的连接。可以提供的网页数量不同。

您的标题和问题不匹配。

MS Access 不是服务器意义上的数据库引擎。您无需准备查询、提交到引擎、获得结果（例如每个网页）。这可以很好地扩展，因为它都是无状态的。

在这种情况下，它基本上是 Jet 识别的结构化文件 (.mdb)（由 msaccess.exe 使用），因此您的 Web 应用程序在启动时会打开该文件。

# java - 使用 RDF 实现语义搜索

> ID：930201
> 
> 赞同：1
> 
> 时间：2009-05-30T17:47:52.573
> 
> 标签：java, search, rdf, sparql

我正在尝试使用 Java 作为基础编程语言来创建语义搜索。

我的任务是创建一个搜索原型，其中包含三元组，即患者、就诊和医生。如果我用患者姓名搜索，结果应该是患者姓名和就诊时间以及相应的医生姓名。

我将使用文本文件形式的三元组表示患者、就诊和医生信息将分别包含在每个文本文件中，例如患者.txt、访问.txt 和医生.txt。

在这里，我将使用 java 以及一些完整性约束来创建搜索，以获取我确信我能够做到的结果。但是我被要求使用 RDF 概念来做到这一点。这就是混乱开始的地方，我不确定如何将 RDF 概念和三元组与 java 集成，我也不是真的从哪里开始。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T18:57:48.737

Jena [http://jena.sourceforge.net/](http://jena.sourceforge.net/)是一个用 JAVA 启动语义 Web 应用程序的好 API。使用 RDF 或 N3 语法构建文件。您可以将数据存储在基于 mysql 的数据库 (RDF-store) 中，并使用 SPARQL 语言对其进行查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T14:23:48.053

以下是一些为 Java 提供 RDF 支持的 API。您可以查看这些并决定哪一个最适合您。

1.  [耶拿](http://jena.sourceforge.net/)
2.  [JRDF](http://jrdf.sourceforge.net/)
3.  [芝麻](http://www.openrdf.org)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-12T02:45:39.713

此[链接](http://www.ibm.com/developerworks/edu/x-dw-x-sparql.html?S_TACT=105AGX01&S_CMP=HP)是使用 Jena 和 Joseki 进行 SPARQL 查询开发的一般介绍。

# iphone - iPhone 上的 AVAudioPlayer 声音意外停止循环：如何调试？

> ID：930203
> 
> 赞同：0
> 
> 时间：2009-05-30T17:48:07.253
> 
> 标签：iphone, cocoa-touch, audio, core-audio

我正在实现在用户拖动 UISlider 时播放的声音效果。

在[上一个问题](https://stackoverflow.com/questions/929785/halting-a-playing-sound-sample-on-iphone-using-audioservices)中，我使用了**AudioServicesPlaySystemSound()**但无法停止这种类型的声音。当用户没有主动拖动滑块但没有释放它时，我需要停止声音。

现在我正在使用**AVAudioPlayer**对象创建声音。我在我的视图控制器中初始化它，如下所示：

```
@interface AudioLatencyViewController : UIViewController <AVAudioPlayerDelegate> {
AVAudioPlayer *player1;
}

@implementation AudioLatencyViewController
@property (nonatomic, retain) AVAudioPlayer *player1;
@synthesize player1;

-(void)viewDidLoad {

[super viewDidLoad];

// the sound file is 1 second long
NSString *soundFilePath = [[NSBundle mainBundle] pathForResource:@"tone1" ofType:@"caf"];
NSURL *fileURL = [[NSURL alloc] initFileURLWithPath:soundFilePath];

AVAudioPlayer *newPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:fileURL error:nil];

[fileURL release];
self.player1 = newPlayer;;
[newPlayer release];

[self.player1 prepareToPlay];
[self.player1 setDelegate:self];
} 
```

我有两种方法来控制声音。当滑块移动时，第一个播放声音。它连接到 Interface Builder 中 UISlider 的**Value Changed**事件。

```
-(IBAction)sliderChanged:(id)sender;
{
    // only play if previous sound is done. helps with stuttering
    if (![self.player1 isPlaying]) {
        [self.player1 play];
    }
} 
```

第二种方法在用户释放滑块按钮时停止声音。它连接到 UISlider 的**Touch Up Inside**事件。

```
-(IBAction)haltSound;
{
    [self.player1 stop];
} 
```

这在移动滑块按钮然后快速释放时有效，但如果您按住按钮超过两三秒，声音会重复（好）然后中断（坏）。从那时起，声音将不再播放（超级糟糕）。

我尝试使用以下方法将声音设置为循环：

```
[self.player1 setNumberOfLoops:30]; 
```

...但这会导致应用程序冻结（加上锁定模拟器）。

我能做些什么来调试这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-12T01:48:18.123

当用户拿着 UISlider 时，Value Changed 会被调用很多次（只要用户移动了一点点）。我会改用 Touch Down。

您可能仍想尝试对这条路线使用循环......

我喜欢在用户移动滑块时播放声音的想法。让我知道它是如何工作的。

deggstand@gmail.com

# javascript - 从 XML 加载 Unicode 字符并通过 AJAX 推送到表单中

> ID：930207
> 
> 赞同：1
> 
> 时间：2009-05-30T17:50:20.447
> 
> 标签：javascript, xml, ajax, unicode

如何从 XML 加载 Unicode 字符（特别是商标符号）并通过 AJAX 将其推送到表单中？

当我推送 formelement.value += "\u2122" 时它工作正常，但是当我将 "\u2122" 放入 XML 时，通过 AJAX 加载它，并将它推送到它不起作用的表单元素。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T18:06:26.800

如果您使用 UTF-8 对 XML 文档进行编码，它应该可以工作。否则尝试使用字符引用，例如`&#x2122;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T18:20:38.043

那是一种javascript格式；javascript 理解它并将其转换为适当的字符，但 XML 解析器不能。在 XML 中使用 '™' 代替 '\u2122'。

# version-control - 使用哪个版本控制系统？

> ID：930210
> 
> 赞同：1
> 
> 时间：2009-05-30T17:51:59.057
> 
> 标签：version-control

> **可能重复：**
> [所有不同类型的版本控制之间有什么区别？](https://stackoverflow.com/questions/3859/what-is-the-difference-between-all-the-different-types-of-version-control)

亲爱的大家：

我刚刚开始使用 SVN 进行版本控制，但总是有很多关于 GIT、Mercurial、SVN、CVS 等版本控制系统的讨论。

是什么让一个版本控制系统比另一个更好？或者一种类型的版本控制系统对一项任务有好处，而另一种对其他任务有好处？还是所有的版本控制系统都基本一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T17:55:37.957

不，我不认为他们是一样的。集中式（例如，SVN、CVS 等）与分布式（Git、Mercurial 等）存储库是反映开发团队运作方式的根本区别。

我使用SVN。我认为如果引入像 Git 这样的分布式 SCM 系统，我的组织的集体头脑会爆炸。对于大多数人来说，这是一个不同的概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T17:56:12.933

与 SVN 或 CVS 等集中式 CVS 相比，像 GIT、Mercurial 和 Bazaar 这样的分布式版本控制系统 (DVCS) 在工作流和操作的灵活性方面确实具有优势。[请参阅wikipedia](http://en.wikipedia.org/wiki/Distributed_revision_control)上的讨论。

至于 DVCS 之间的选择，与 vi 和 emacs 之间的选择一样（比如）备受争议；-)。在“课程用马”的基础上，如果您要使用 code.google.com，您可能会务实地选择 hg (Mercurial)，如果您要使用 Launchpad，您可能会选择 Bazaar，如果您要使用 github，您可能会选择 GIT，例如。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T17:56:54.413

大部分是个人喜好；Git 和 Mercurial 是分布式源代码控制系统，如果你有一个分布式团队会更好；对于团队在同一位置或连接到单个服务器的大多数开发环境，像 Subversion 这样的常规版本控制系统就足够了。

我使用过 Git 并且喜欢它，但实际上我更喜欢 Subversion。如果你使用的是 SVN，你应该没问题。

# c# - 如何处理被阻塞的剪贴板和其他奇怪的东西

> ID：930219
> 
> 赞同：53
> 
> 时间：2009-05-30T17:57:12.417
> 
> 标签：c#, .net, clipboard

在过去的几个小时里，我一直在追踪一个相当具体的错误，因为另一个应用程序打开了剪贴板。本质上，剪贴板是共享资源（根据[“为什么我的共享剪贴板不起作用？”](http://blogs.msdn.com/rds/archive/2006/11/20/why-does-my-shared-clipboard-not-work-part-2.aspx)）并且您尝试执行

```
Clipboard.SetText(string) 
```

或者

```
Clipboard.Clear(). 
```

抛出以下异常：

```
System.Runtime.InteropServices.ExternalException：请求的剪贴板操作未成功。
    在 System.Windows.Forms.Clipboard.ThrowIfFailed（Int32 小时）
    在 System.Windows.Forms.Clipboard.SetDataObject（对象数据，布尔副本，Int32 retryTimes，Int32 retryDelay）
    在 System.Windows.Forms.Clipboard.SetText（字符串文本，TextDataFormat 格式）
    在 System.Windows.Forms.Clipboard.SetText（字符串文本）

```

我最初的解决方案是在短暂的暂停后重试，直到我意识到 Clipboard.SetDataObject 具有用于次数和延迟长度的字段。.NET 的默认行为是以 100 毫秒的延迟尝试 10 次。

最终用户注意到了最后一件事。也就是说，尽管抛出异常，复制到剪贴板操作仍然有效。我无法找到任何关于为什么会这样的进一步信息。

我目前对该问题的解决方案只是默默地忽略异常......这真的是最好的方法吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2011-03-05T12:32:51.157

另一种解决方法是使用`Clipboard.SetDataObject`而不是`Clipboard.SetText`.

根据[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms158293.aspx)，此方法有两个参数 - **retryTimes**和**retryDelay** - 您可以像这样使用它们：

```
System.Windows.Forms.Clipboard.SetDataObject(
    "some text", // Text to store in clipboard
    false,       // Do not keep after our application exits
    5,           // Retry 5 times
    200);        // 200 ms delay between retries 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-30T18:11:59.583

由于剪贴板由所有 UI 应用程序共享，您会不时遇到这种情况。显然，您不希望您的应用程序在无法写入剪贴板时崩溃，因此优雅地处理 ExternalException 是合理的。如果写入剪贴板的 SetObjectData 调用失败，我建议向用户显示错误。

一个建议是使用（通过[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)）[`user32!GetOpenClipboardWindow`](http://msdn.microsoft.com/en-us/library/ms649044(VS.85).aspx)查看另一个应用程序是否打开了剪贴板。它将返回打开剪贴板的窗口的 HWND，或者`IntPtr.Zero`如果没有应用程序打开它。您可以在该值上旋转`IntPtr.Zero`指定的时间。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-10-12T22:34:50.803

我今天遇到了这个错误。我决定通过告诉用户潜在的行为不端的应用程序来处理它。为此，您可以执行以下操作：

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
static extern IntPtr GetOpenClipboardWindow();

[System.Runtime.InteropServices.DllImport("user32.dll")]
static extern int GetWindowText(int hwnd, StringBuilder text, int count);

private void btnCopy_Click(object sender, EventArgs e)
{
    try
    {
        Clipboard.Clear();
        Clipboard.SetText(textBox1.Text);
    }
    catch (Exception ex)
    {
        string msg = ex.Message;
        msg += Environment.NewLine;
        msg += Environment.NewLine;
        msg += "The problem:";
        msg += Environment.NewLine;
        msg += getOpenClipboardWindowText();
        MessageBox.Show(msg);
    }
}

private string getOpenClipboardWindowText()
{
    IntPtr hwnd = GetOpenClipboardWindow();
    StringBuilder sb = new StringBuilder(501);
    GetWindowText(hwnd.ToInt32(), sb, 500);
    return sb.ToString();
    // example:
    // skype_plugin_core_proxy_window: 02490E80
} 
```

对我来说，问题窗口标题是“skype_plugin_core_proxy_window”。我搜索了这方面的信息，很惊讶它只命中了一个，而且是俄语的。因此，我添加了这个答案，既是为了对该字符串再次进行打击，又是为了提供进一步的帮助，以使可能出现行为异常的应用程序曝光。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-25T13:58:06.070

做一个`Clipboard.Clear()`before`Clipboard.SetDataObject(pasteString, true)`似乎可以解决问题。

较早的设置建议`retryTimes`和`retryDelay`对我不起作用，无论如何默认设置是`retryTimes = 10`和`retryDelay = 100ms`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-10T19:07:42.723

只需先调用它：

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
static extern IntPtr CloseClipboard(); 
```

我注意到，如果您正在进行粘贴操作（WM_PASTE 消息），包括在 TextChanged 事件期间，剪贴板仍被接收事件的窗口（文本框）锁定。因此，如果您只是在事件处理程序中调用“CloseClipboard”方法，那么您可以调用托管的 Clipboard.Clear 和 Clipboard.SetText 方法，而不会出现任何问题或延迟。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-07-24T13:03:25.610

通过使用 Jeff Roe 的代码（[Jeff's Code](https://stackoverflow.com/questions/930219/how-to-handle-blocked-clipboard-and-other-oddities)）

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
static extern IntPtr GetOpenClipboardWindow();

[System.Runtime.InteropServices.DllImport("user32.dll")]
static extern int GetWindowText(int hwnd, StringBuilder text, int count);

private void btnCopy_Click(object sender, EventArgs e)
{
    try
    {
        Clipboard.Clear();
        Clipboard.SetText(textBox1.Text);
    }
    catch (Exception ex)
    {
        string msg = ex.Message;
        msg += Environment.NewLine;
        msg += Environment.NewLine;
        msg += "The problem:";
        msg += Environment.NewLine;
        msg += getOpenClipboardWindowText();
        MessageBox.Show(msg);
    }
}

private string getOpenClipboardWindowText()
{
    IntPtr hwnd = GetOpenClipboardWindow();
    StringBuilder sb = new StringBuilder(501);
    GetWindowText(hwnd.ToInt32(), sb, 500);
    return sb.ToString();
    // example:
    // skype_plugin_core_proxy_window: 02490E80
} 
```

您能够以非常方便的方式处理错误。

我已经设法通过使用来减少错误的频率， `System.Windows.Forms.Clipboard`而不是`System.Windows.Clipboard`.

我强调这并不能解决问题，但它减少了我的应用程序的发生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-17T05:47:00.970

这有点糟糕......但它解决了我的问题。

延迟后重试 clear()。

更多信息在博客文章*[如何处理被阻止的剪贴板 - Clipboard.Clear() 错误](http://sameerajayalath.blogspot.com/2011/08/how-to-handle-blocked-clipboard.html)*。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2012-03-04T21:28:11.877

我实际上已经提出了自己的解决方案，它似乎对我有用。

```
// This allows the clipboard to have something copied to it.
    public static void ClipboardPaste(String pasteString)
    {
        // This clears the clipboard
        Clipboard.Clear();

        // This is a "Try" of the statement inside {}, if it fails it goes to "Catch"
        // If it "Catches" an exception. Then the function will retry itself.
        try
        {
            // This, per some suggestions I found is a half second second wait before another
            // clipboard clear and before setting the clipboard
            System.Threading.Thread.Sleep(500);
            Clipboard.Clear();
            // This is, instead of using SetText another method to put something into
            // the clipboard, it includes a retry/fail set up with a delay
            // It retries 5 times with 250 milliseconds (0.25 second) between each retry.
            Clipboard.SetDataObject(pasteString, false, 5, 250);
        }
        catch (Exception)
        {
            ClipboardPaste(pasteString);
        }
    } 
```

这显然是 C#，但是这些方法向所有 Visual Studio 公开。我显然已经创建了一个循环函数，并试图通过重试将其强制进入剪贴板。

基本上这里是流程。假设您要将单词剪贴板放入剪贴板中的代码中的任何位置（假设已定义此函数）。

1.  调用函数 ClipboardPaste("剪贴板");
2.  然后它将清除剪贴板
3.  然后它将“尝试”将您的字符串放入剪贴板。
4.  首先它等待半秒（500 毫秒）
5.  再次清除剪贴板
6.  然后它尝试使用 SetDataObject 将字符串放入剪贴板
7.  SetDataObject 如果失败将重试最多五次，每次重试之间有 250 毫秒的延迟。
8.  如果初始尝试失败，它会捕获异常、崩溃，然后重新尝试。

是的，如果您知道剪贴板无论如何都会有异常（无限循环），这确实有缺陷。但是，我还没有使用这种方法陷入无限循环。另一个缺陷是它可能需要几秒钟（基本上减慢您的应用程序）才能工作，而它正在尝试它可能会冻结您的应用程序，一旦成功，应用程序将继续运行。

# visual-studio-2008 - 从外部工具打开 .doc 文件

> ID：930225
> 
> 赞同：0
> 
> 时间：2009-05-30T18:01:46.763
> 
> 标签：visual-studio-2008

我在博客中看到一篇关于在 Visual Studio 2008 中从外部工具打开 .doc 文件的文章（本例中为 C# 语言规范）。

我再也找不到这篇文章了。有谁知道如何做到这一点（以及.pdfs）？在 VS 中执行此操作似乎没有太多指导。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T18:04:52.547

这很容易做到。转到“工具`->`外部工具....”将命令设置为 MSWord（或您选择的 PDF 阅读器）的路径，并将参数设置为文档的路径。

例如，在我的电脑中：

*   标题：C#语言规范
*   命令：`C:\Program Files (x86)\Microsoft Office\Office12\WINWORD.EXE`
*   论据：`"C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC#\Specifications\1033\CSharp Language Specification.doc"`

如果参数路径包含空格等字符，请确保将其放在引号中，因为它需要被视为命令的单个参数。

# grails - 如何完全引导 grails 环境？

> ID：930227
> 
> 赞同：0
> 
> 时间：2009-05-30T18:03:30.893
> 
> 标签：grails, bootstrapping

我在互联网上的某个随机位置找到了包含的 grails 脚本，它非常适合在引导的 grails env 中启动脚本。它似乎唯一没有做的就是`conf/*Bootstrap.groovy`像我在运行应用程序时一样启动我的脚本。

是否有其他类似的功能`loadApp()`可以`configureApp()`为我做这件事？

```
import org.codehaus.groovy.grails.support.PersistenceContextInterceptor

Ant.property(environment: "env")
grailsHome = Ant.antProject.properties."env.GRAILS_HOME"

includeTargets << new File("${grailsHome}/scripts/Bootstrap.groovy")

target('default': "Runs scripts in the test/local directory") {
    if (!args) { throw new RuntimeException("[fail] This script requires an argument - the script to run.") }

    depends(configureProxy, packageApp, classpath)
    classLoader = new URLClassLoader([classesDir.toURI().toURL()] as URL[], rootLoader)
    Thread.currentThread().setContextClassLoader(classLoader)
    loadApp()
    configureApp()

    def interceptor = null
    def beanNames = appCtx.getBeanNamesForType(PersistenceContextInterceptor)
    if (beanNames && beanNames.size() == 1) {
        interceptor = appCtx.getBean(beanNames[0])
    }
    try {
        interceptor?.init()
        new GroovyScriptEngine(Ant.antProject.properties."base.dir", classLoader).run("scripts/${args}.groovy", new Binding(['appCtx':appCtx]))
        interceptor?.flush()
    } catch (Exception e) {
        e.printStackTrace()
        interceptor?.clear()
    } finally {
        interceptor?.destroy()
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T15:41:02.787

是的，试试

> 新的 BootStrap().init()

# c# - ADO.NET Entity Framework：如何获得自动级联删除？

> ID：930235
> 
> 赞同：4
> 
> 时间：2009-05-30T18:06:34.290
> 
> 标签：c#, database, entity-framework, ado.net

我正在使用带有 ASP.NET MVC 的 Ado.Net 实体框架。

例如，在我的 MSSQL 2008 数据库中，我有以下简化的表和关系：

```
 (Song) 1--* (Version) 1 -- 1 (VersionInfo) 
```

删除歌曲时是否可以自动删除链接的版本及其版本信息？

目前我正在使用类似下面的代码，这是很多手工工作，因为有些表有多达 8 个关系，而且这些关系有时也有子关系：

```
 db = new Database() //Entities
  Song song = db.Song.First();

  Song.Version.Load();

  foreach(Version version in Song.Version.ToList())
  {
       //Remove Song-Version Reference.
       song.Version.Remove(version);

       //Get The VersionInfo so we can delete it after we deleted the Version object.
       version.VersionInfoReference.Load();
       VersionInfo versionInfo = version.VersionInfo;

       //Now we can delete the Version Object.
       db.DeleteObject(version);
       //Now we can also delete the versionInfo, since the reference is gone.
       db.DeleteObject(versionInfo);

  }

  db.DeleteObject(song); 
```

必须有一种更简单的方法来获得级联删除。我已经尝试在删除时将 MSSQL 中的关系设置设置为级联，但它没有做任何事情......我错过了什么吗？

无论如何，其他人如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T21:33:58.250

您不应该在实体框架中执行此操作。所有流行的关系数据库都支持`ON CASCADE DELETE`外键，这也更加有效。我建议你就这样吧。

在您的情况下，您可能必须将歌曲中的删除级联到版本，并将版本中的删除级联到版本信息。只需在 SQL 管理器中加载表设计器，您应该会在关系下看到相关选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T20:31:22.090

我用一个更简单的数据库、2 个表进行了尝试，发现级联仅来自 1-many 的 1 侧。

```
table A
id  - int
b_id - int 

table B
id - int 
```

在 A.b_id 和 B.id 之间设置关系。删除规则是级联的。

当我删除A时，B不会被删除。当我删除B时，A被删除。

问题是，我想在删除 A 时删除 B。我想这只能手动进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T18:16:29.233

如果您在数据库中正确设置它，那么它肯定应该级联删除。我认为他们在实体框架的下一个版本中改进了这一点，但我不确定。我只记得在某处看到级联。我建议您再次查看数据库。

例如，是否还有其他关系也需要级联？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-28T00:08:27.620

在EF的RTM中，在设计器中选择一个关系，按F4查看属性。您将看到两个 OnDelete 属性（关系的每一侧一个）设置为“无”。您可以将任一侧设置为“级联”（我认为您必须将其设置在父级上）

# .net - .NET 发送电子邮件的最佳方法（System.Net.Mail 有问题）

> ID：930236
> 
> 赞同：18
> 
> 时间：2009-05-30T18:07:31.060
> 
> 标签：.net, asp.net, smtp, smtpclient, system.net.mail

这似乎很简单。我需要从一些 ASP.NET 应用程序发送电子邮件。我需要始终如一地做到这一点，而不会出现奇怪的错误，也不会出现 CPU 利用率过高的情况。我不是在谈论群发电子邮件，只是偶尔发送电子邮件。

System.Net.Mail*似乎*被严重破坏了。SmtpClient 不发出 Quit 命令（可能是因为 Microsoft(R) 对以下规范不感兴趣），因此连接保持打开状态。**因此，如果有人在该连接最终**关闭之前尝试发送电子邮件，您可能会从 SMTP 服务器收到关于打开的连接过多的错误。这是 Microsoft(R) 对修复完全不感兴趣的错误。看这里：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=146711](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=146711)

另外，如果您环顾四周，建议使用此代码来解决此问题：

```
smtpClient.ServicePoint.MaxIdleTime = 1;
smtpClient.ServicePoint.ConnectionLimit = 1; 
```

好的，是的，这确实“解决”了连接保持打开状态的问题。但是，如果您愿意，这始终如一地在服务器上尝试，这会导致运行进程（在本例中为 w3wp.exe）的 CPU 跳跃并保持在 100%，直到您的应用程序池被回收。无论出于何种原因，运行 mscorwks.dll!CreateApplicationContext 的线程都是罪魁祸首。

这有一个非常好的副作用，如果您在一个对持续 100% 的 CPU 使用不满意的 Web 主机上运行，​​您将禁用您的应用程序池。因此，这并不像某些人建议的那样微不足道。

所以我的问题是怎么办？我需要做的就是这么简单；然而，让那些“打开的连接太多”错误是不可接受的，100% 的 CPU 使用率也是不可接受的。我不想购买第三方组件，不是因为我便宜，而是我购买了足够多的组件和 MSDN 订阅，以至于不得不为简单的 SMTP 功能支付 100 到 300 美元似乎很疯狂。

我读到将 MaxIdleTime 设置得更高会有所帮助，但我对此表示怀疑。我不想因为微软不想遵循 SMTP 规范而冒险禁用我的应用程序池。

**编辑：** 我查看了 quiksoft.com 组件，但它不支持 SMTP 身份验证，而且价格为 500 美元。一定有办法解决这个问题。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-11-29T18:40:42.733

在 .NET 4.0 中，SmtpClient 现在是一次性的。SMTP QUIT 命令在处置时发出，例如在使用块中使用时。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-07-27T21:26:06.647

我在所描述的设置中遇到了同样的 CPU 利用率问题。我最终向 Microsoft 开了一张票，以确定问题的原因。CPU 利用率问题在于 ServicePoint 类。在 ServicePoint 类内部，有一个每 (MaxIdleTime/2) 毫秒运行一次的计时器。看到问题了吗？通过将 MaxIdleTime 值更改为 2，CPU 利用率将下降到正常水平。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T18:13:19.753

我一直使用 Quiksoft 的 EasyMail .NET 组件，完全没有问题。

产品主页：[http ://www.quiksoft.com/emdotnet/](http://www.quiksoft.com/emdotnet/)

如果您只需要发送电子邮件，他们也有该组件的免费版本：

[http://www.quiksoft.com/freesmtp/](http://www.quiksoft.com/freesmtp/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-04T06:25:42.330

我们使用[hMailserver](http://www.hmailserver.com)取得了巨大成功。该配置可能需要一段时间才能习惯，但它是一个很棒的——而且是免费的——邮件服务器产品。

如果你想自己动手（几年前我在玩 CDONTS 的时候就做过），你可以从下面的代码开始，并根据你的内心进行定制。它使用 TcpClient 直接创建到邮件服务器的 TCP 连接。并不是说当有这么多已建立和调试的解决方案时我会推荐这个，但我发现这对于调试和确定预制 MS 邮件组件的问题非常有用。

```
 private void Send_Email() 
    {
        #region Email Sending Function
        string strMail = "";

        try 
        {
            // See RFC821 http://www.faqs.org/rfcs/rfc821.html for more specs
            // TcpClient is an abstraction of a TCP Socket connection
            TcpClient myTCP = new TcpClient();

            // Connect to the mail server's port 25
            myTCP.Connect(mailserver, 25);

            // Open a network stream which sends data to/from the TcpClient's socket
            System.Net.Sockets.NetworkStream ns = myTCP.GetStream();

            // The data to send to the mail server, basically a raw SMTP mail message
            strMail = "HELO\n";
            strMail += "MAIL FROM:from@address.com\n";
            strMail += "RCPT TO:" + recipient + "\n";
            strMail += "DATA\n";
            strMail += "Subject: mySubject\n";
            strMail += "To:" + recipient + "\n";
            strMail += "From: \"From Real Name\" <from@address.com>\n";
            strMail += "\n";
            strMail += " ---------------------------------------\n";
            strMail += "Name:     " + txtName.Text + "\n";
            strMail += "Address1: " + txtAddress1.Text + "\n";
            strMail += "Address2: " + txtAddress2.Text + "\n";
            strMail += "City:     " + txtCity.Text + "\n";
            strMail += "State:    " + txtState.Text + "\n";
            strMail += "Zip:      " + txtZip.Text + "\n";
            strMail += "Email:    " + txtEmail.Text + "\n";
            strMail += "Dealer:   " + txtDealer.Text + "\n";
            strMail += " ---------------------------------------\n";
            strMail += "THIS IS AN AUTOMATED EMAIL SYSTEM. DO NOT REPLY TO THIS ADDRESS.\n";
            strMail += "\n.\n";

            // Defines encoding of string into Bytes (network stream needs
            // an array of bytes to send -- can't send strings)
            ASCIIEncoding AE = new ASCIIEncoding();
            byte[] ByteArray = AE.GetBytes(strMail);

            // send the byte-encoded string to the networkstream -> mail server:25
            ns.Write(ByteArray, 0, ByteArray.Length);

            //ns.Read(ByteArray, 0, ByteArray.Length);
            //lblStatus.Text = ByteArray.ToString();

            // close the network stream
            ns.Close();

            // close the TCP connection
            myTCP.Close();
        }
        catch(Exception ex) 
        {
            throw new Exception("Couldn't send email: <p>" + ex.Message);
        }

        #endregion

    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T18:12:16.450

虽然到目前为止我没有遇到任何具体问题`System.Net.Mail`，但您始终可以使用旧[`System.Web.Mail`](http://msdn.microsoft.com/en-us/library/system.web.mail.smtpmail.aspx)API，它是 CDOSYS 的包装器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T13:04:02.207

我过去使用过 Quicksoft，没有任何抱怨。您可以尝试的另一件事是将 SMTP 配置切换为使用拾取文件夹而不是使用网络发送，这应该可以解决“它不发送 QUIT”问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-01T18:41:52.533

我使用 Sproc 发送大部分邮件。我什至可以附加一个文件。

```
创建过程 [dbo].[sendMail_With_CDOMessage]  
    @to VARCHAR(64),
    @CC VARCHAR(1024)='',
    @BCC VARCHAR(1024)='',
    @subject VARCHAR(500)='',
    @body VARCHAR(8000)='' ,
    @来自 VARCHAR(64),
    @filename VARCHAR(255)='',
    @priority INT = 0
作为  
开始  
    设置无计数  

    宣布  
        @handle INT，  
        @return 整数，  
        @s VARCHAR(64),  
        @sc VARCHAR(1024),  
        @up CHAR(27),   
        @server VARCHAR(255)  

    SET @s = '"http://schemas.microsoft.com/cdo/configuration/'  

    选择  
        @s = 'Configuration.Fields(' + @s,  
        @up = 'Configuration.Fields.Update',
        @server = 'smtp.yourdomain.com'

    EXEC @return = sp_OACreate 'CDO.Message', @handle OUT  
    SET @sc = @s + 'sendusing").Value'  
    EXEC @return = sp_OASetProperty @handle, @sc, '2'  
    SET @sc = @s + 'smtpserver").Value'  
    执行@return = sp_OASetProperty @handle、@sc、@server  
    EXEC @return = sp_OAMethod @handle, @up, NULL  
    EXEC @return = sp_OASetProperty @handle, 'To', @to  
    EXEC @return = sp_OASetProperty @handle, 'CC', @CC
    EXEC @return = sp_OASetProperty @handle, 'BCC', @BCC
    EXEC @return = sp_OASetProperty @handle, 'From', @from  
    EXEC @return = sp_OASetProperty @handle, 'Subject', @subject  
    EXEC @return = sp_OASetProperty @handle, 'HTMLBody', @body    
    EXEC @return = sp_OASetProperty @handle, 'Priority', 'cdoHigh'  

    如果@filename 不为空  
        EXEC @return = sp_OAMethod @handle, 'AddAttachment', NULL, @filename  

    EXEC @return = sp_OAMethod @handle, '发送', NULL  
    如果 @return 0  
    开始  
        PRINT '邮件失败。'  
        如果 @from 为空  
            PRINT '来自未定义的地址。  
        别的  
            ' PRINT '检查服务器是否有效。
    结尾
    别的  
        PRINT '邮件已发送。  

    执行@return = sp_OADestroy @handle  
结尾  

```

# javascript - Javascript：取消/停止图像请求

> ID：930237
> 
> 赞同：44
> 
> 时间：2009-05-30T18:07:39.000
> 
> 标签：javascript, image

我有一个大量使用 Ajax 的网站。有时我需要在页面上为用户加载大图像文件。我的问题是，当下载这些大图像文件时，如果用户离开显示图像的页面，有没有办法阻止它们？谢谢。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-09-23T20:50:40.640

我遇到了完全相同的问题，当用户通过（ajax）搜索结果快速“分页”时，浏览器仍在尝试下载每个页面的个人资料图片，而不仅仅是当前页面。这段代码对我有用，在运行新搜索之前调用了分页事件：

```
//cancel image downloads
if(window.stop !== undefined)
{
     window.stop();
}
else if(document.execCommand !== undefined)
{
     document.execCommand("Stop", false);
} 
```

本质上，这就像单击浏览器上的“停止”按钮。

在**IE、FireFox、Chrome、Opera 和 Safari中测试**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-10T09:44:08.567

像这样。

```
$(img).attr('src',''); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T18:32:17.790

假设您使用 ajax 加载图像，您可以简单地在[window.onunload](https://developer.mozilla.org/en/DOM/window.onunload)事件中中止请求。为您正在使用的 XMLHttpRequest 对象声明一个全局变量。

```
var xhr;
//if using the XMLHttpRequest object directly
//you may already be doing something like this
function getImage(...){
  xhr = new XMLHttpRequest();
  xhr.open(....);
} 
```

如果使用 jQuery，您可以将调用 $.ajax() 或 $.get 的返回值分配给 xhr 变量。

```
xhr = $.ajax(.....); 
```

处理 window.onunload 并中止请求。

```
window.onunload = function(){
  xhr.abort();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-21T20:33:00.417

将 SRC 标记重新分配给不同的图像在 IE7 中不起作用，它会继续尝试下载第一个图像。

这是设置：

我创建了一个 JPEG 类型的 HTTP 处理程序。它包含永远不会完成执行的代码。所以 someImage.src=myhandler.ashx 将永远坐在那里加载，直到超时。

在这中间，按下另一个按钮，将图像重新分配给一个小图像文件：someImage.src=small.jpg

即使我们重新分配了 src，对 myhandler.ashx 的请求也没有结束。

此外，如果您实际上删除了节点 someImage.parentNode.removeChild(someImage) 仍在尝试下载 myhandler.ashx

使用 IE7 测试并使用 HTTP Watch Pro 进行监控。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-09-23T20:53:08.063

可怜的 mans 解决方案是简单地将图像标签的 SRC 属性设置为空字符串，或者将其指向一个小部件。

*编辑*

看到您的评论，很惊讶将 SRC 属性更改为空时不起作用...尝试使用空白.gif 或其他东西。

如果这不起作用，您可能会受到浏览器架构的限制，这意味着您是 SOL

# objective-c - NSUserDefaults 与 sqlite3

> ID：930239
> 
> 赞同：2
> 
> 时间：2009-05-30T18:08:28.000
> 
> 标签：objective-c, iphone, performance, sqlite, nsuserdefaults

我有一个存储对象列表的小型 iPhone 应用程序。用户可以添加和删除对象，但此列表将保持相当小（大多数用户将有 10-30 个对象）。`NSUserDefaults`似乎更容易使用，但会`sqlite3`更快？只有 30 条“记录”会有什么明显的区别吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T18:45:12.333

NSUserDefaults 用于用户偏好，通常是基本对象，如 NSString 或 NSNumber。Sqlite、序列化属性列表中的对象集合或 Core Data 都是用于存储用户数据（例如您创建的模型对象）的有效选项。

你不会看到速度差异，但最好还是为你正在做的事情选择正确的机制。如果只是偏好，那么使用 NSUserDefaults，否则我会将您的对象序列化为 plist。如果你是 Cocoa 的新手，我会首先避免使用 Core Data 甚至 sqlite，让自己有机会先学习基础知识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T20:54:19.547

尝试使用 NSCoding 协议。声明你的类来实现 NSCoding 协议：

```
@interface Person : NSObject <NSCoding> 
```

上一行承诺实现以下方法：

```
-(id)initWithCoder:(NSCoder *)coder;
-(void)encodeWithCoder:(NSCoder *)coder; 
```

您的方法应类似于：

```
-(void)encodeWithCoder:(NSCoder *)coder {
  [super encodeWithCoder:coder];
  [coder encodeObject:firstName forKey:@"firstName"];
  [coder encodeObject:lastName forKey:@"lastName"];
}

-(id)initWithCoder:(NSCoder *)coder {
  [super init];
  firstName = [[coder decodeObjectForKey:@"firstName"] retain];
  lastName = [[coder decodeObjectForKey:@"lastName"] retain];
  return self;
} 
```

# database-design - 数据仓库中的事实表是否需要代理主键？

> ID：930246
> 
> 赞同：4
> 
> 时间：2009-05-30T18:10:51.490
> 
> 标签：database-design, business-intelligence

当我问我们的数据库设计人员为什么我们的 Fact 表没有 PK 时，我被告知即使选择了所有列，表中也没有一组列可以唯一标识一条记录。当我建议我们在这种情况下创建一个身份列时，我被告知“我只是在浪费空间而且不需要它。”

我的感觉是，源系统中的每个表都应该有一个PK，即使它是一个标识列。鉴于数据仓库 (DW) 是来自其他系统的数据的接收者，如果无法绑定各个记录，我将如何确保 DW 中的数据准确反映源系统中的内容？如果你有一个失控的加载程序，它搞砸了数据并且已经运行了一周，你将如何在没有某种独特约束来比较的实时事务源系统中调和这些差异？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T18:33:09.677

数据仓库不一定是关系数据存储，尽管您可以选择使其成为一个，因此关系定义不一定适用。

仅当您想对需要唯一标识符的数据执行某些操作时才需要主键（例如将其跟踪到源，但这并不总是必需或必要甚至可能的）；并且数据仓库中的数据通常可以以不需要主键的方式使用。具体来说，您可能不需要将行彼此区分开来。最常用于构造聚合值。

时间不是构建数据仓库表的必要维度。

这可能在心理上不舒服，浪费空间是一个小问题，但你的同事是正确的——PK 不是必需的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T18:23:09.240

身份类型列是替换您的“候选”键之一的“代理”键（简单地说）。如果您无法识别没有它的行，则添加代理键列不会增加任何内容。这需要一个候选键。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T17:01:13.160

您至少应该在事实表上有一个自然键，以便您可以识别行并将它们与源相协调，或在必要时跟踪更改。

在 SQL Server 上，标识列免费为您提供代理键，而在使用序列的其他系统（例如 Oracle）上，可以相当容易地添加它。由于各种不同的原因，代理事实表键可能很有用。一些可能的应用是：

*   有些工具喜欢在事实表上使用数字键，最好是单调递增的。这方面的一个例子是 MS SQL Server 分析服务，它非常喜欢为用于填充度量组的事实表提供一个数字的、单调递增的键。这对于增量负载尤其需要。

*   如果事实表之间有任何关系（例如熟悉保险的人的书面收入明细），那么合成键在这里很有帮助。

*   如果您的维度与事实表存在 M:M 关系（例如 ICD 代码），那么事实表上的数字键可以简化此操作。

*   如果您对交易有任何自加入要求（例如，某些交易是对其他交易的更正），那么合成密钥将简化这些交易。

*   如果你在你的数据仓库中做相反的重述操作（即通过生成反转和重新陈述行来处理对事务数据的更改），那么你可以为同一个自然键拥有多个事实表行。

否则，如果您没有任何东西以 1:M 关系加入事实表，那么合成密钥可能不会用于任何事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T18:16:47.253

没有主键的数据库表似乎是一个糟糕的设计选择，并且为不同类型的异常留出了很多空间，即您将如何删除或更新此类表中的单个记录？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T18:18:36.173

你是对的——在某种程度上。没有主键，表不符合关系的最低定义。作为关系的基础，它不能允许重复的行。数据仓库设计中的表应该是关系型的，即使它们不是严格的标准形式。

因此，行中必须有一些列（或一组列）用于唯一标识行。但它不一定是代理键的标识列。

如果 Fact Table 没有一组列可以充当候选键的角色，那么这个 DW 中需要更多的 Dimension Table，并且 Fact Table 中需要更多的列。

这个新的 Dimension 本身可能不是主键；它可以与事实表中的现有列组合以创建候选键。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-30T18:22:09.850

我会同意你的。

“有人告诉我，表中没有一组列可以唯一标识一条记录，即使选择了所有列。” - 据我了解，这似乎打破了关系数据库的一些基本内容。

事实由附加值加上维度的外键组成。时间是我所知道的每个维度模型所共有的一个明显维度。如果不出意外，包含时间戳的复合键肯定足够唯一。

我想知道您的 DBA 是否对维度建模有很多了解。这是一种不同于正常关系型、交易型的思维方式。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-31T02:30:07.967

如果事实表位于星型模式的中心，则实际上存在候选键。如果将事实表中的所有外键放在一起，即指向维度表中行的外键，那就是候选键。

将其声明为主键可能没有多大用处。它唯一能做的就是保护您免受流氓 ETL 过程的侵害。运行仓库的人可能会很好地处理 ETL。

就索引和查询速度而言，星型模式与面向 OLTP 的数据库完全不同。经营仓库的人可能也有这个。

在为 OLTP 设计数据库时，让表没有主键是不明智的。相同的考虑不会延续到仓库中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-02-15T13:53:59.043

我一直认为一个表应该按照最常见的查询或性能命中者排序，因此表的聚集索引应该与最困难或最常见的查询一致。

主键不必是聚集索引，所以我知道您可能想知道我将如何处理，但我更关心的是聚集索引而不是主键（老实说，它们通常相互跟随）。

所以对我来说最初的问题不是“我应该在事实表上有一个代理主键吗？” 但更像是“我应该在事实表上有一个聚集索引吗？” 我认为答案是肯定的，你应该有一个（是的，这个网站上还有其他帖子涵盖了这个问题，但我仍然认为在这里值得一提，以防这是人们真正提出的问题，尽管措辞错误）

有时您需要代理键，但我衷心建议代理键不是表的聚集索引。这样做会按照无意义的代理键对表进行排序。（通常人们在表中添加一个代理标识列，并使其成为主键，默认情况下也是聚集索引）

那么在哪些列上创建聚集索引？我个人喜欢事实表的日期，为此您可能会添加一些其他维度的 FK 以获得唯一性，但这会增加大小并且可能不会提供任何好处，因为为了使索引有用，必须引用相关维度（在生成密钥的重要性顺序）。

为了解决这个问题（以及我在这里回答这个问题的原因），我认为您应该添加一个代理项，然后在日期键上创建聚集索引，然后是代理项（按此顺序）。我这样做是因为单独的日期不会成为唯一的行，而是添加代理将。这使数据按日期排序，这有助于所有其他非聚集索引，并保持聚集索引大小合理。

此外，随着数据的增长，您可能希望对其进行分区，在这种情况下，您将需要一个分区键，该分区键始终是日期。以日期作为键的主要部分构建聚集索引使这更容易。通过分区，您现在可以使用滑动窗口技术来归档旧数据或加载。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T21:49:19.577

没有每行的唯一标识符比最初看起来更糟糕。当然，这是不稳定的，很容易无意中删除一些行。

但是性能也差很多。每次您最终要求数据库为您获取员工的行时，`EmployeeType = 'Manager'`您都在进行字符串比较。标识符更快更好。

*此外，存储很便宜，在这种情况下，我想如果*那样的话，对空间的影响将不到四分之一个百分点——作为数据仓库，您可能正在为 TB 级数据设计。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T08:54:24.463

[http://www.ralphkimball.com/html/controversies.html](http://www.ralphkimball.com/html/controversies.html)

## 寓言：

事实表的主键由所有引用的维度外键组成。

## 事实：

事实表通常有 10 个或更多外键连接到维度表的主键。然而，行唯一性通常只需要事实表的外键引用的一个子集。大多数事实表都有一个主键，它由外键的连接/复合子集组成。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-19T22:37:40.007

使用维度代理键的组合作为事实表的主键并不适用于所有情况。考虑存在三个维度a、b和c的情况。在大多数设计中，我们通常有一个“未知”的维度行，假设我总是为这一行分配 -1 的代理键。我可以很容易地在我的事实表中有两行具有键 a=n1、b=n2 和 c=-1，即重复键，因为这两行没有得到维度 c 的有效值，因此都解析为未知行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-10T11:08:33.103

您在这里混淆了两个问题——识别事实表中的唯一记录，以及从源系统到事实表的跟踪记录。

在后一种情况下，源系统中的单个记录很可能具有多个事实表记录。想象一个源系统记录，它表示资金从一个帐户转移到另一个帐户。可能有两条事实表记录来表示这一点，一条用于借方账户，一条用于贷方账户。此外，可能有多个事实记录来表示源系统记录在其生命周期的不同点的不同状态。

对于事实表的主键问题，真的没有一个“正确”的答案。您可能需要一些理想/基本特征（例如，单个记录的身份可以在系统用户之间轻松通信，或者单个记录可以轻松删除或更新）。但是，对于 Oracle 系统，ROWID 可能会很好地做到这一点，只要它是否偶尔更改无关紧要。

但实际上，维护单个合成密钥的开销很小，无论如何您都可以这样做。您可能会选择不为其编制索引，因为索引将比列本身消耗更多的资源。

# c++ - 需要帮助将滚动条添加到编辑框

> ID：930257
> 
> 赞同：2
> 
> 时间：2009-05-30T18:15:21.500
> 
> 标签：c++, visual-studio-2005, mfc, dialog, scrollbar

我正在 Visual C++ 2005 中制作一个基于 MFC 对话框的应用程序。我在编辑框中添加了一个滚动条。如何对滚动条进行编程以使其工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T06:17:14.713

窗口样式 wS_VSCROLL 和 WS_HSCROLL 控制是否存在滚动条。通常，您只需将这些样式设置为资源对话框模板的一部分。

使用 MFC，您可以使用“ [CWnd::ShowScrollBar](http://msdn.microsoft.com/en-us/library/bcs3129s(VS.80).aspx) ”方法打开/关闭滚动条。

当滚动条打开时，它们应该自动用于编辑控件。你不需要做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T00:51:22.813

[http://www.functionx.com/visualc/controls/scrollbar.htm](http://www.functionx.com/visualc/controls/scrollbar.htm)

具有可用于控制滚动条的代码。

# sql - SQL 之类的 Windows 注册表包装器？

> ID：930258
> 
> 赞同：1
> 
> 时间：2009-05-30T18:15:22.263
> 
> 标签：sql, windows, registry

在处理大量数据时，更新注册表的每个键处理似乎有点差。是否有任何库可以将所有键视为表并允许以更加程序化的方式进行 INSERTS、UPDATES 或 SELECTS？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T18:33:17.273

如果你想做脚本，windows powershell 有一些非常漂亮的[注册表访问](http://tfl09.blogspot.com/2007/01/using-registry-with-powershell.html)。它像处理文件系统一样处理注册表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T18:33:15.727

WMI 提供对注册表的访问，并有一种[类似于 SQL 的语言，称为 WQL](http://msdn.microsoft.com/en-us/library/aa394606(VS.85).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T18:19:42.380

WMI 可能会有所帮助，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/aa394582(VS.85).aspx)。

# paypal - 支付用户贝宝帐户的最佳方式？

> ID：930264
> 
> 赞同：8
> 
> 时间：2009-05-30T18:17:20.887
> 
> 标签：paypal, payment

我知道标题的描述性并不好，抱歉。

基本上我正在创建一个网站，用户可以在其中搜索和购买网站布局、wordpress/joomla 主题等。现在用户将能够从贝宝记入他们的帐户并使用这个“网站信用”购买主题等。现在这可以通过 IPN 完成，但对于销售主题的人来说，让他们将收入提取到他们的贝宝账户的最佳方式是什么。例子;

1.  Joe Bloggs 信用（20 美元存入网站贝宝账户）
2.  Joe Bloggs 以 10 美元从 John Smith 购买了一个主题（a. Joe Bloggs 账户余额 = 原始余额 - 10，b. John Smiths 账户余额 = 原始余额 + 10）
3.  约翰史密斯想要提取他刚刚赚到的 10 美元

任何帮助表示赞赏，希望我足够清楚，如果有人可以推荐使用哪种类型的贝宝帐户，显然这种流量会通过它，我需要尽可能少或没有限制。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T18:28:01.383

您将需要一个 Paypal Business 帐户以避免对交易的任何限制。

至于通过贝宝向人们付款，我假设您将从网站帐户中向人们付款。如果是这样，那么您可以使用 PayPal Mass Pay API，它允许您从您用来调用 API 的帐户中向一位或多位用户付款。有关详细信息，请参阅[https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_NVPAPI_DeveloperGuide.pdf](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_NVPAPI_DeveloperGuide.pdf)和 Mass Pay API 部分。还有一个等效的 SOAP 接口，但基础是：

*   提供收款帐户的 ID 或电子邮件
*   提供支付给他们的金额。

我不打算进入 NVP 或 paypal API 身份验证系统，因为你提到你已经对他们进行了排序，但基本上相同的系统适用。

如果您希望人们能够“提款”，只需在注册时告诉他们指定“付款电子邮件地址”，然后当他们想提款时，只需有一个表单，其结果运行对 API 的调用，并支付给他们。

**编辑**：刚刚检查过，Mass Pay API 需要 Website Payments Pro，每月收费 30 美元，交易费为：2.2% – 2.9% + 0.30 美元（这些仅适用于传入交易） - 请参阅[https： //www.paypal.com/us/cgi-bin/webscr?cmd=xpt/Marketing/general/PaymentSolutions-outside](https://www.paypal.com/us/cgi-bin/webscr?cmd=xpt/Marketing/general/PaymentSolutions-outside)获取信息。不知道你项目的成本限制是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T18:39:17.213

似乎假设资金必须通过您的帐户。您是否考虑过更多地充当店面，您的网站将买家引导到他们将直接向卖家付款的 PayPal 页面？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-09T07:08:20.483

我正在做一个需要做类似事情的项目，我修改了 PayPal 的示例代码：

[如何使用php汇款到paypal](https://stackoverflow.com/questions/4191887/how-to-send-money-to-paypal-using-php/4395365#4395365)

我希望它有用。

# java - 在 Windows 上手动安装 Java？

> ID：930265
> 
> 赞同：29
> 
> 时间：2009-05-30T18:18:24.677
> 
> 标签：java, windows, installation

我见过许多与 JDK 捆绑在一起的产品，我想知道是否有一种方法可以通过简单地将内容解压缩到目录来安装 JDK，因此在添加/删除程序中没有创建图标，没有注册表项等。

同样在这种情况下：我们如何为浏览器配置 Java 插件？我们如何配置通过 Java 控制面板条目看到的设置？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-01-06T19:40:45.520

据此[，](https://stackoverflow.com/a/6571736/1646025)我创建了一个[批处理脚本](https://github.com/hydra1983/usr_local_bin/tree/master/extra/jdk2z)来自动构建 jdk 档案。

链接的基本部分是：

> *   创建工作 JDK 目录（在本例中为“C:\JDK”）
> *   从 oracle 下载最新版本的 JDK（例如“jdk-7u7-windows-i586.exe”）
> *   下载并安装 7-zip（如果您不是管理员，请下载 7-zip 便携版）
> *   使用 7-zip 从目录 "C:\JDK" 中的 "jdk-[6-7]u?-windows-i586.exe" 中提取所有文件
> *   在命令外壳 (cmd.exe) 中执行以下操作：
>     1.  将目录更改为目录 C:\JDK.rsrc\JAVA_CAB10
>     2.  执行命令：**extract32 111**
> *   用 7-zip 解压 C:\JDK.rsrc\JAVA_CAB10\tools.zip
> *   在命令外壳 (cmd.exe) 中执行以下操作：
>     1.  将目录更改为 C:\JDK.rsrc\JAVA_CAB10\tools\
>     2.  执行命令：**for /r %x in (*.pack) do .\bin\unpack200 -r "%x" "%~dx%~px%~nx.jar"**（这会将所有打包文件转换为jar）
> *   将 c:\JDK.rsrc\JAVA_CAB10\tools 的整个目录和所有子目录复制到您希望 JDK 所在的位置，并手动设置 JAVA_HOME 和 PATH 以指向您的 JDK 目录及其 BIN 子目录。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-31T03:02:50.800

是的，您可以创建一个压缩的 JDK，将其解压缩到目标机器上，然后从该目录运行 java、javac 等。

创建此类 zip 文件的最简单方法是在机器上安装 JDK，然后压缩 JDK 目录的内容。我们在某些情况下这样做，我们需要准确控制将在我们的部署中使用的 Java 配置。在这种情况下，我们的脚本只是将 JAVA_HOME（或等效的）指向我们内部捆绑的 JDK，而不是依赖系统管理员在到达之前准确安装我们需要的东西。

在与浏览器集成方面，这可能会有点问题。*简短的回答是否定的，如果没有某种*安装程序，您将无法直接与浏览器集成。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-31T04:10:21.137

您可以使用 SysInternals RegMon 和 FileMon（现在由 MS 拥有和分发）来查看Java 安装程序所修改的*确切内容。*我相信您会想要创建许多注册条目。例如，像 WISE 安装程序这样的产品，也在底层使用这种方法来重新打包产品安装（例如，作为 MSI）。

*请小心*，因为安装程序也会做出一些*动态*决定，这些决定可能会影响安装的内容（例如在 XP 与 W2K3 服务器上）。关于已安装的代码页，我曾经被这个咬过。我不记得确切的细节，但效果是我的嵌入式 JRE + JDK 中缺少代码页文件（仅限合法可再发行部分）。这在我的代码中导致了一个非常奇怪且看似荒谬的运行时错误。不用说，这同样适用于服务器与客户端 JVM DLL。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T18:21:37.103

真的，不，至少如果你想从 Windows 而不是从 cygwin 中使用它。Windows 过于依赖注册表；您可以模拟必要的注册表更新，但是将文件移动到正确位置并更新注册表的软件称为“安装程序”；你只是在重新发明安装程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-30T18:34:12.263

我相信这至少在 Java 的早期版本中是可行的——我不知道它是否仍然如此。

正如您在问题中提到的那样，大多数注册表项都用于浏览器插件之类的东西。如果您*只想*能够运行 Java（例如从批处理文件），那是一回事 - 但真正*安装*它是另一回事。即使您只是想运行它，您也需要小心始终明确地使用您打算使用的那个，而不是意外地将已安装的一个用于您的应用程序的一部分。

你的实际用例是什么？你真的需要浏览器插件吗？您对配置的哪个方面感兴趣？许多控制面板配置与更新和浏览器集成有关。可以使用命令行选项来控制许多其他方面，以设置特定的系统属性。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-31T02:48:34.667

如果你只是想为你的应用程序提供一个 JVM 很好，但我不建议这样做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-03T12:30:25.707

如果您只想拥有 JDK (JRE) 文件，您可以在[sandboxie](http://www.sandboxie.com)中运行安装程序。在沙箱中安装后，只需从中复制文件`c:\sandbox`即可。

我正在使用它来编译和运行无法轻松迁移到较新版本的 Java 的遗留 Java 应用程序。我可以将 Eclispe 指向这个 JDK，并告诉它符合 Java 1.3。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-12T21:28:33.307

只需从 Oracle 下载页面下载 Java 的 Windows 服务器版本。自行设置 JAVA_HOME 和 PATH 变量。

# php - mysqli 数组 -> 查询未获得正确的数据

> ID：930279
> 
> 赞同：1
> 
> 时间：2009-05-30T18:26:14.680
> 
> 标签：php, mysqli, echo

我`mysqli_fetch_array(mysqi_query($db, $query))`似乎没有从数据库中获取正确的信息，因此 PHP 应用程序无法正常工作。

以下是查询，

```
<?php
if($_GET){
$current = mysqli_fetch_array(mysqli_query($db, "SELECT * from `tbl_user` WHERE `userid` = '".$_GET['userid']."'"));
$currentperms  = mysqli_fetch_array(mysqli_query($db, "SELECT * from `tbl_perms` WHERE `userid` = '".$_GET['userid']."'"));
} 
?> 
```

同时，`if ($current['userid'] == "1") {echo(" selected ");}`根本不输出任何内容，因此未在 SELECT 标记中选择正确的选项。

所以，在哪里：我希望：echo($currentperms['newapp']); 不等于1，因为在数据库中是这样设置的，结果是“1”。我通过回显获得的字符串对此进行了测试。Newapp 也不是表中的列，因此它不应该返回“1”。

有了这个：

```
 if $current['userid'] == "1") {
 echo(" selected ");
 } 
```

没有回显任何内容，但是，该变量已在之前的脚本中使用，其输出为“1”。

请帮助我，我正在穿过屋顶：|

@sasa：输出：Success!Array ( [0] => 1 [userid] => 1 [1] => shamil.nunhuck [username] => shamil.nunhuck [2] => Shamil Nunhuck [userfullname] => Shamil Nunhuck [3] => shamil.nunhuck@localhost [useremail] => shamil.nunhuck@localhost [4] => 6363d731bd7492fe4c33fc3d90fd61bc [用户密码] => 6363d731bd7492fe4c33fc3d90fd61bc [5] => 1 [用户级别] => 1管理员 [usertitle] => 管理员 [7] => 1 [tos] => 1 ) 数组 ( [0] => 1 [userid] => 1 [1] => 0 [ptodo] => 0 [2] = > 0 [usercp] => 0 [3] => 0 [pm] => 0 [4] => 0 [bug] => 0 [5] => 0 [abug] => 0 [6] => 0 [admincp] => 0 [7] => 0 [intmgs] => 0 [8] => 0 [adduser] => 0 [9] => 0 [pass] => 0 [10] => 0 [useredit ] => 0 [11] => 0 [listuser] => 0 [12] => 0 [newapp] => 0)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T18:40:41.937

如果问题是数据库返回的信息不正确，最好只发布代码的 mysql 部分（尤其是查询）、当前结果以及您希望看到的结果。

也仅供参考，我希望您在将 $_GET 和 $_POST 变量转储到该查询之前解析它们。像这样将它们直接传递到 SQL 中并不是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T19:33:54.717

我不是 100% 确定我遵循了这个问题，但您似乎在说结果`$current['userid'] == "1"`是错误的，尽管`$current['userid']`打印为“1”，对吗？

如果是这种情况，则可能有一些空格或其他垃圾进入导致比较失败的值，尽管我怀疑如果`userid`是由数据库自动生成的情况。

您可以通过更彻底地检查该值来验证这一点，例如

```
var_dump( $current['userid'] ); // Check for whitespace
echo strlen( $current['userid'] ); // Is this greater than 1? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T19:47:52.193

试试这个代码：

```
//  I put some echo for testing
if(!empty($_GET['id'])) {
    $id = (int)$_GET['id'];
    $sql = mysqli_query($db, "SELECT * from tbl_user WHERE userid = $id LIMIT 1");
    if(mysqli_affected_rows($db) == 0) {
        echo "There is no user with that id";
    } else {
        $current = mysql_fetch_assoc($sql);
        $currentperms  = mysql_fetch_assoc(mysqli_query($db, "SELECT * from tbl_perms WHERE userid = $id"));
        echo "Success!";
        // Or try to print result
        print_r($current);
        print_r($currentperms);
    }
} else {
    echo "There is no user id";
} 
```

或者可能只是一个语法错误：

> 有了这个：
> 
> ```
>  if $current['userid'] == "1") {
>  echo(" selected ");
>  } 
> ```

它应该是：

```
if($current['userid'] == 1) {
    echo(" selected ");
} 
```

# java - 如何找到在 Java 中调用给定方法的所有方法？

> ID：930289
> 
> 赞同：36
> 
> 时间：2009-05-30T18:30:06.200
> 
> 标签：java

我需要在 Java 中获取我感兴趣的方法的所有调用方方法的列表。有没有可以帮助我解决这个问题的工具？

编辑：我忘了提到我需要从程序中执行此操作。我正在使用 Java Pathfinder，我想在所有调用我感兴趣的方法的方法中运行它。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-31T05:51:21.787

对于分析字节码，我会推荐[ASM](http://asm.ow2.org/)。给定一个要分析的类列表，可以创建一个访问者来查找您感兴趣的方法调用。下面是一个分析 jar 文件中的类的实现。

请注意，ASM 使用带有 '/' 而不是 '.' 的[internalNames 。](http://asm.ow2.org/current/doc/javadoc/user/index.html)作为分隔符。将目标方法指定为不带修饰符的[标准声明。](http://asm.ow2.org/current/doc/javadoc/user/org/objectweb/asm/commons/Method.html#getMethod(java.lang.String))

例如，列出可能在 java 运行时 jar 中调用 System.out.println("foo") 的方法：

```
java -cp "classes;asm-3.1.jar;asm-commons-3.1.jar" App \
    c:/java/jdk/jre/lib/rt.jar \
    java/io/PrintStream  "void println(String)" 
```

*编辑*：添加的源代码和行号：请注意，这仅表示每个调用方法的最后一个目标方法调用 - 原始 q 只想知道*哪些*方法。我将其作为练习留给读者，以显示调用方法声明的行号，或每个目标调用的行号，具体取决于您实际追求的内容。:)

结果是：

```
LogSupport.java:44 com/sun/activation/registries/LogSupport log (Ljava/lang/String;)V
LogSupport.java:50 com/sun/activation/registries/LogSupport log (Ljava/lang/String;Ljava/lang/Throwable;)V
...
Throwable.java:498 java/lang/Throwable printStackTraceAsCause (Ljava/io/PrintStream;[Ljava/lang/StackTraceElement;)V
--
885 methods invoke java/io/PrintStream println (Ljava/lang/String;)V 
```

来源：

```
public class App {
    private String targetClass;
    private Method targetMethod;

    private AppClassVisitor cv;

    private ArrayList<Callee> callees = new ArrayList<Callee>();

    private static class Callee {
        String className;
        String methodName;
        String methodDesc;
        String source;
        int line;

        public Callee(String cName, String mName, String mDesc, String src, int ln) {
            className = cName; methodName = mName; methodDesc = mDesc; source = src; line = ln;
        }
    }

    private class AppMethodVisitor extends MethodAdapter {

        boolean callsTarget;
        int line;

        public AppMethodVisitor() { super(new EmptyVisitor()); }

        public void visitMethodInsn(int opcode, String owner, String name, String desc) {
            if (owner.equals(targetClass)
                    && name.equals(targetMethod.getName())
                    && desc.equals(targetMethod.getDescriptor())) {
                callsTarget = true;
            }
        }

        public void visitCode() {
            callsTarget = false;
        }

        public void visitLineNumber(int line, Label start) {
            this.line = line;
        }

        public void visitEnd() {
            if (callsTarget)
                callees.add(new Callee(cv.className, cv.methodName, cv.methodDesc, 
                        cv.source, line));
        }
    }

    private class AppClassVisitor extends ClassAdapter {

        private AppMethodVisitor mv = new AppMethodVisitor();

        public String source;
        public String className;
        public String methodName;
        public String methodDesc;

        public AppClassVisitor() { super(new EmptyVisitor()); }

        public void visit(int version, int access, String name,
                          String signature, String superName, String[] interfaces) {
            className = name;
        }

        public void visitSource(String source, String debug) {
            this.source = source;
        }

        public MethodVisitor visitMethod(int access, String name, 
                                         String desc, String signature,
                                         String[] exceptions) {
            methodName = name;
            methodDesc = desc;

            return mv;
        }
    }

    public void findCallingMethodsInJar(String jarPath, String targetClass,
                                        String targetMethodDeclaration) throws Exception {

        this.targetClass = targetClass;
        this.targetMethod = Method.getMethod(targetMethodDeclaration);

        this.cv = new AppClassVisitor();

        JarFile jarFile = new JarFile(jarPath);
        Enumeration<JarEntry> entries = jarFile.entries();

        while (entries.hasMoreElements()) {
            JarEntry entry = entries.nextElement();

            if (entry.getName().endsWith(".class")) {
                InputStream stream = new BufferedInputStream(jarFile.getInputStream(entry), 1024);
                ClassReader reader = new ClassReader(stream);

                reader.accept(cv, 0);

                stream.close();
            }
        }
    }

    public static void main( String[] args ) {
        try {
            App app = new App();

            app.findCallingMethodsInJar(args[0], args[1], args[2]);

            for (Callee c : app.callees) {
                System.out.println(c.source+":"+c.line+" "+c.className+" "+c.methodName+" "+c.methodDesc);
            }

            System.out.println("--\n"+app.callees.size()+" methods invoke "+
                    app.targetClass+" "+
                    app.targetMethod.getName()+" "+app.targetMethod.getDescriptor());
        } catch(Exception x) {
            x.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-30T18:38:33.907

编辑：对原始问题进行了编辑以指示需要运行时解决方案 - 此答案是在编辑之前给出的，仅指示如何在开发过程中执行此操作。

如果您使用的是 Eclipse，您可以右键单击该方法并选择“打开调用层次结构”来获取此信息。

阅读评论后更新：其他 IDE 也以类似的方式支持这一点（至少 Netbeans 和 IntelliJ 支持）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T22:28:53.380

使用 @Deprecated 注释该方法（或使用 @deprecated 对其进行标记），打开弃用警告，运行编译并查看触发了哪些警告。

可以通过调用外部 ant 进程*或*使用[Java 6 编译器 API](http://java.sun.com/javase/6/docs/api/javax/tools/package-summary.html)来运行您的编译位。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-08-25T21:07:06.810

1.  右键单击方法
2.  转到参考并（根据您的要求）
    选择工作区/项目/层次结构。

这会弹出一个面板，显示对此函数的所有引用。日食FTW！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-31T06:20:51.103

在 Eclipse 中，突出显示方法名称，然后**Ctrl+Shift+G**

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T22:08:01.303

没有办法通过 Java 反射库（以编程方式）做到这一点 - 你不能问[java.lang.reflect.Method](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Method.html) “你调用了哪些方法？”

这留下了我能想到的另外两个选择：

1.  源代码的静态分析。我确信这就是 Eclipse Java 工具集所做的——您可以查看 JDT 背后的 Eclipse 源代码，并在您要求 Eclipse“查找引用”某个方法时找到它的作用。

2.  字节码分析。您可以检查字节码以查找对该方法的调用。我不确定有哪些库或示例可以帮助解决这个问题 - 但我无法想象某些东西不存在。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T18:39:11.007

是的，大多数现代 IDE:s 都可以让您搜索方法或变量的用法。或者，您可以使用调试器并在方法条目上设置跟踪点，在每次调用方法时打印堆栈跟踪或其他任何内容。最后，您可以使用一些简单的 shell 工具来 grep 方法，例如

```
find . -name '*.java' -exec grep -H methodName {} ; 
```

但是，唯一可以让您找到通过某种反射方法进行的调用的方法是使用调试器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-04-16T17:58:30.567

我使用@Chadwick 的例子做了一个小例子。这是一个评估对 getDatabaseEngine() 的调用是否由实现 @Transaction 的方法进行的测试。

```
/**
 * Ensures that methods that call {@link DatabaseProvider#getDatabaseEngine()}
 * implement the {@link @Transaction} annotation.
 *
 * @throws Exception If something occurs while testing.
 */
@Test
public void ensure() throws Exception {
    final Method method = Method.getMethod(
            DatabaseEngine.class.getCanonicalName() + " getDatabaseEngine()");

    final ArrayList<java.lang.reflect.Method> faultyMethods = Lists.newArrayList();

    for (Path p : getAllClasses()) {
        try (InputStream stream = new BufferedInputStream(Files.newInputStream(p))) {
            ClassReader reader = new ClassReader(stream);

            reader.accept(new ClassAdapter(new EmptyVisitor()) {
                @Override
                public MethodVisitor visitMethod(final int access, final String name, final String desc, final String signature, final String[] exceptions) {

                    return new MethodAdapter(new EmptyVisitor()) {
                        @Override
                        public void visitMethodInsn(int opcode, String owner, String nameCode, String descCode) {
                            try {
                                final Class<?> klass = Class.forName(Type.getObjectType(owner).getClassName());
                                if (DatabaseProvider.class.isAssignableFrom(klass) &&
                                        nameCode.equals(method.getName()) &&
                                        descCode.equals(method.getDescriptor())) {

                                    final java.lang.reflect.Method method = klass.getDeclaredMethod(name,
                                            getParameters(desc).toArray(new Class[]{}));

                                    for (Annotation annotation : method.getDeclaredAnnotations()) {
                                        if (annotation.annotationType().equals(Transaction.class)) {
                                            return;
                                        }
                                    }

                                    faultyMethods.add(method);

                                }
                            } catch (Exception e) {
                                Throwables.propagate(e);
                            }
                        }
                    };
                }
            }, 0);

        }
    }

    if (!faultyMethods.isEmpty()) {
        fail("\n\nThe following methods must implement @Transaction because they're calling getDatabaseEngine().\n\n" + Joiner.on("\n").join
                (faultyMethods) + "\n\n");
    }

}

/**
 * Gets all the classes from target.
 *
 * @return The list of classes.
 * @throws IOException If something occurs while collecting those classes.
 */
private List<Path> getAllClasses() throws IOException {
    final ImmutableList.Builder<Path> builder = new ImmutableList.Builder<>();
    Files.walkFileTree(Paths.get("target", "classes"), new SimpleFileVisitor<Path>() {
        @Override
        public FileVisitResult visitFile(final Path file, final BasicFileAttributes attrs) throws IOException {
            if (file.getFileName().toString().endsWith(".class")) {
                builder.add(file);
            }
            return FileVisitResult.CONTINUE;
        }
    });

    return builder.build();
}

/**
 * Gets the list of parameters given the description.
 *
 * @param desc The method description.
 * @return The list of parameters.
 * @throws Exception If something occurs getting the parameters.
 */
private List<Class<?>> getParameters(String desc) throws Exception {
    ImmutableList.Builder<Class<?>> obj = new ImmutableList.Builder<>();

    for (Type type : Type.getArgumentTypes(desc)) {
        obj.add(ClassUtils.getClass(type.getClassName()));
    }

    return obj.build();
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-30T10:51:11.373

1）在eclipse中它是->右键单击方法并选择打开调用层次结构或`CLT+ALT+H`

2）在jdeveloper它是->右键单击方法并选择调用或`ALT+SHIFT+H`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-30T18:39:47.057

我能找到的最接近的是这个 StackOverflow questions selected answer中描述的方法。[看一下这个](https://stackoverflow.com/questions/421280/in-java-how-do-i-find-the-caller-of-a-method-using-stacktrace-or-reflection/421338#421338)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-05-30T19:39:11.353

您可以使用 IDE 中的某些内容来执行此操作，例如“Find Usages”（在 Netbeans 和 JDeveloper 中就是这样称呼的）。有几点需要注意：

1.  如果您的方法从接口或基类实现方法，您只能知道您的方法可能被调用。
2.  许多 Java 框架使用反射来调用您的方法（IE Spring、Hibernate、JSF 等），所以要小心。
3.  同样，您的方法可能被某些框架调用，无论是否反射，所以再次小心。

# list - 在specman中将字符串拆分为列表

> ID：930290
> 
> 赞同：1
> 
> 时间：2009-05-30T18:30:54.657
> 
> 标签：list, split, specman

假设我有一个字符串：

```
str = “ab,cd,ef” 
```

我想把它分成一个列表

```
lst = [“ab”,”cd”,ef”] 
```

假设我不提前知道字符串中有多少项，我怎样才能做到最好？

* * *

基本上我正在寻找一个与 Perl 相当的规范：

```
$str = "ab,cd,ef";
@lst = split /,/, $str; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T07:56:17.650

str_split 是你想要的。

来自 Specman 6.1 文档：

```
str_split(str: string, regular-exp: string): list of string 
```

语法示例

```
var s: list of string = str_split("first-second-third", "-"); 
```

# c# - C#隐藏调整大小光标

> ID：930297
> 
> 赞同：6
> 
> 时间：2009-05-30T18:33:47.583
> 
> 标签：c#, user-interface, mouse-cursor

在我的程序中，我使用 WndProc 覆盖来阻止我的表单被调整大小。问题是，当您将指针移动到表单边缘时，光标仍然存在。

有没有办法隐藏这个光标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T18:35:59.500

为什么[`FormBorderStyle`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.formborderstyle.aspx)不适当地设置属性呢？那么你也不需要使用`WndProc`。

下面是一些示例代码来演示 - 单击按钮来切换是否可以调整表单的大小：

```
using System;
using System.Windows.Forms;
using System.Drawing;

class Test
{   
    [STAThread]
    static void Main(string[] args)
    {
        Button button = new Button 
        {
            Text = "Toggle border",
            AutoSize = true,
            Location = new Point(20, 20)
        };
        Form form = new Form
        {
            Size = new Size (200, 200),
            Controls = { button },
            FormBorderStyle = FormBorderStyle.Fixed3D
        };
        button.Click += ToggleBorder;
        Application.Run(form);
    }

    static void ToggleBorder(object sender, EventArgs e)
    {
        Form form = ((Control)sender).FindForm();
        form.FormBorderStyle = form.FormBorderStyle == FormBorderStyle.Fixed3D
            ? FormBorderStyle.Sizable : FormBorderStyle.Fixed3D;
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T19:05:28.223

感谢 Lasse 发给我的链接，我找到了使用 WndProc 的方法。感谢您的回复乔恩，但这并不是我想要的。对于那些想知道我是如何做到的人，我使用了这个：

```
 protected override void WndProc(ref Message m)
    {
        const int WM_NCHITTEST = 0x0084;

        switch (m.Msg)
        {
            case WM_NCHITTEST:
                return;
        }

        base.WndProc(ref m);
    } 
```

我还没有彻底测试它，所以不知道是否有任何副作用，但它目前对我来说很好:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T19:10:18.617

只需设置 FormBorderStyle 就足够了。你为什么要为此使用 WndProc？

# delphi - 在delphi 2009中创建一个gif动画文件？

> ID：930300
> 
> 赞同：5
> 
> 时间：2009-05-30T18:34:28.020
> 
> 标签：delphi, delphi-2009

```
gif := TgifImage.Create;
gif.Width := 100;
gif.Height := 100;
gif.AnimationSpeed := 500;
gif.Animate := true;
gif.add(image1.Picture.Bitmap);
gif.add(image2.Picture.Bitmap);
gif.add(image3.Picture.Bitmap);
gif.SaveToFile('gif.gif'); 
```

这个循环只循环一次，速度不是500？

如何让它循环并设置速度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T19:37:48.953

编写原始[TGIFImage](http://melander.dk/delphi/gifimage/)的 Anders Melander有以下[答案](http://melander.dk/delphi/gifimage/#faq_5)。

> 您需要在 GIF 的第一帧中添加“Netscape Loop”扩展块。循环块必须是您为框架定义的第一个扩展，否则它将不起作用。
> 
> 有关如何构建动画 GIF 的示例，请参阅[Animate 演示。](http://melander.dk/articles/gifanimate/)

[这是Animate 演示](http://melander.dk/articles/gifanimate/)的代码摘录：

```
// Add the source image to the animation
Result := GIF.Add(Source);

// Netscape Loop extension must be the first extension in the first frame!
if (GIF.Images.Count = 1) then
begin
  LoopExt := TGIFAppExtNSLoop.Create(Result);
  LoopExt.Loops := 0; // Number of loops (0 = forever)
end; 
```

您可以在[此处查看 TGIFImage 文档](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/GIFImg_TGIFImage.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T01:16:18.053

```
var Gif:TGifImage;
begin
    //Setting the delay for each frame
    TGIFGraphicControlExtension.Create(Gif.Add(image1.Picture.Bitmap)).Delay := 300;
    TGIFGraphicControlExtension.Create(Gif.Add(image2.Picture.Bitmap)).Delay := 300;
    TGIFGraphicControlExtension.Create(Gif.Add(image3.Picture.Bitmap)).Delay := 300;
    //Adding loop extension in the first frame (0 = forever)
    TGIFAppExtNSLoop.Create(Gif.Images.Frames[0]).Loops := 0;

    Gif.SaveToFile('gif.gif');
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T14:36:42.927

您可以在我的主页 www.tolderlund.eu/delphi/ 上查看如何创建动画 GIF 的示例，还有 Delphi 5 和 Delphi 6、Delphi 7、Delphi 2005、Delphi 2006、Delphi 2007 的原始 TGIFImage，德尔福 2009。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-30T19:15:22.337

至少需要一个计时器和一些无闪烁的方法。

请参阅 RXLibrary 中单元 rxAnimate.pas 中的示例（可免费获得。SourceForge.net 或[http://www.dummzeuch.de/delphi/english.html](http://www.dummzeuch.de/delphi/english.html)的来源）。

JVCL 也有类似组件的来源。

# python - Python 字符串清理 + 操作（重音字符）

> ID：930303
> 
> 赞同：5
> 
> 时间：2009-05-30T18:36:16.393
> 
> 标签：python, regex, unicode, string

我有一个充满名称的数据库，例如：

```
John Smith  
Scott J. Holmes  
Dr. Kaplan  
Ray's Dog  
Levi's  
Adrian O'Brien  
Perry Sean Smyre  
Carie Burchfield-Thompson  
Björn Árnason 
```

有一些带有重音符号的外国名称需要转换为带有非重音字符的字符串。

我想将全名（在剥离“'”、“-”等字符后）转换为用户登录名，如：

```
john.smith  
scott.j.holmes  
dr.kaplan  
rays.dog  
levis
adrian.obrien  
perry.sean.smyre
carie.burchfieldthompson  
bjorn.arnason 
```

到目前为止，我有：

```
Fullname.strip()  # get rid of leading/trailing white space
Fullname.lower() # make everything lower case

... # after bad chars converted/removed
Fullname.replace(' ', '.') # replace spaces with periods 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T18:47:38.553

看看这个链接[编辑]

这是页面中的代码

```
def latin1_to_ascii (unicrap):
    """This replaces UNICODE Latin-1 characters with
    something equivalent in 7-bit ASCII. All characters in the standard
    7-bit ASCII range are preserved. In the 8th bit range all the Latin-1
    accented letters are stripped of their accents. Most symbol characters
    are converted to something meaningful. Anything not converted is deleted.
    """
    xlate = {
        0xc0:'A', 0xc1:'A', 0xc2:'A', 0xc3:'A', 0xc4:'A', 0xc5:'A',
        0xc6:'Ae', 0xc7:'C',
        0xc8:'E', 0xc9:'E', 0xca:'E', 0xcb:'E',
        0xcc:'I', 0xcd:'I', 0xce:'I', 0xcf:'I',
        0xd0:'Th', 0xd1:'N',
        0xd2:'O', 0xd3:'O', 0xd4:'O', 0xd5:'O', 0xd6:'O', 0xd8:'O',
        0xd9:'U', 0xda:'U', 0xdb:'U', 0xdc:'U',
        0xdd:'Y', 0xde:'th', 0xdf:'ss',
        0xe0:'a', 0xe1:'a', 0xe2:'a', 0xe3:'a', 0xe4:'a', 0xe5:'a',
        0xe6:'ae', 0xe7:'c',
        0xe8:'e', 0xe9:'e', 0xea:'e', 0xeb:'e',
        0xec:'i', 0xed:'i', 0xee:'i', 0xef:'i',
        0xf0:'th', 0xf1:'n',
        0xf2:'o', 0xf3:'o', 0xf4:'o', 0xf5:'o', 0xf6:'o', 0xf8:'o',
        0xf9:'u', 0xfa:'u', 0xfb:'u', 0xfc:'u',
        0xfd:'y', 0xfe:'th', 0xff:'y',
        0xa1:'!', 0xa2:'{cent}', 0xa3:'{pound}', 0xa4:'{currency}',
        0xa5:'{yen}', 0xa6:'|', 0xa7:'{section}', 0xa8:'{umlaut}',
        0xa9:'{C}', 0xaa:'{^a}', 0xab:'<<', 0xac:'{not}',
        0xad:'-', 0xae:'{R}', 0xaf:'_', 0xb0:'{degrees}',
        0xb1:'{+/-}', 0xb2:'{^2}', 0xb3:'{^3}', 0xb4:"'",
        0xb5:'{micro}', 0xb6:'{paragraph}', 0xb7:'*', 0xb8:'{cedilla}',
        0xb9:'{^1}', 0xba:'{^o}', 0xbb:'>>',
        0xbc:'{1/4}', 0xbd:'{1/2}', 0xbe:'{3/4}', 0xbf:'?',
        0xd7:'*', 0xf7:'/'
    }

    r = ''
    for i in unicrap:
        if xlate.has_key(ord(i)):
            r += xlate[ord(i)]
        elif ord(i) >= 0x80:
            pass
        else:
            r += i
    return r

# This gives an example of how to use latin1_to_ascii().
# This creates a string will all the characters in the latin-1 character set
# then it converts the string to plain 7-bit ASCII.
if __name__ == '__main__':
s = unicode('','latin-1')
for c in range(32,256):
    if c != 0x7f:
        s = s + unicode(chr(c),'latin-1')
print 'INPUT:'
print s.encode('latin-1')
print
print 'OUTPUT:'
print latin1_to_ascii(s) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-26T08:36:53.340

如果你不怕安装第三方模块，那么看看[Perl 模块的 python 端口`Text::Unidecode`](http://www.tablix.org/~avian/blog/archives/2009/01/unicode_transliteration_in_python/)（它也在[pypi 上](http://pypi.python.org/pypi/Unidecode)）。

该模块仅使用查找表来音译字符。我浏览了代码，它看起来很简单。所以我想它几乎可以在任何操作系统和任何 Python 版本（交叉手指）上运行。它也很容易与您的应用程序捆绑在一起。

使用此模块，您不必手动创建查找表（= 降低不完整的风险）。

与 Unicode 规范化技术相比，该模块的优势在于：Unicode 规范化不会替换所有字符。一个很好的例子是像“æ”这样的字符。Unicode 规范化将其视为“字母，小写”(Ll)。这意味着使用该`normalize`方法既不会给您替换字符，也不会给您有用的提示。不幸的是，该字符不能用 ASCII 表示。所以你会得到错误。

提到的[模块](http://www.tablix.org/~avian/blog/archives/2009/01/unicode_transliteration_in_python/)在这方面做得更好。这实际上会将“æ”替换为“ae”。这实际上是有用且有意义的。

我见过的最令人印象深刻的事情是它走得更远。它甚至可以正确地替换日文假名*字符*。例如，它将“は”替换为“ha”。Wich 完全没问题。~~尽管当前版本将“ち”替换为“ti”而不是“chi”，但这并不是万无一失的。因此，您必须小心处理更具异国情调的角色。~~

模块的使用很简单::

```
from unidecode import unidecode
var_utf8  = "æは".decode("utf8")
unidecode( var_utf8 ).encode("ascii")
>>> "aeha" 
```

请注意，我与此模块没有直接关系。碰巧我发现它非常有用。

**编辑：**我提交的补丁修复了有关日文假名的错误。我只修复了我可以立即发现的那个。我可能错过了一些。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T01:43:14.707

以下函数是通用的：

```
import unicodedata

def not_combining(char):
        return unicodedata.category(char) != 'Mn'

def strip_accents(text, encoding):
        unicode_text= unicodedata.normalize('NFD', text.decode(encoding))
        return filter(not_combining, unicode_text).encode(encoding)

# in a cp1252 environment
>>> print strip_accents("déjà", "cp1252")
deja
# in a cp1253 environment
>>> print strip_accents("καλημέρα", "cp1253")
καλημερα 
```

显然，您应该知道字符串的编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T18:51:11.667

我会做这样的事情

```
# coding=utf-8

def alnum_dot(name, replace={}):
    import re

    for k, v in replace.items():
        name = name.replace(k, v)

    return re.sub("[^a-z.]", "", name.strip().lower())

print alnum_dot(u"Frédrik Holmström", {
    u"ö":"o",
    " ":"."
}) 
```

第二个参数是您要替换的字符的字典，所有非 az 和 . 未被替换的字符将被剥离

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T18:53:34.627

translate 方法允许您删除字符。您可以使用它来删除任意字符。

```
Fullname.translate(None,"'-\"") 
```

如果要删除整个字符类，则可能需要使用 re 模块。

```
re.sub('[^a-z0-9 ]', '', Fullname.strip().lower(),) 
```

# javascript - 如果我想做 Javascript、AJAX 的东西，我是否需要服务器端知识（例如 Django、Rails）？

> ID：930312
> 
> 赞同：0
> 
> 时间：2009-05-30T18:45:40.727
> 
> 标签：javascript, ruby-on-rails, django, user-interface

我正在尝试进入 Web 开发，特别有兴趣构建网站的前端、UI 部分，同时学习 JavaScript 可能使用 AJAX 技术。（我有 UI、HCI 背景。）

但是，我以前也完全没有关于服务器端 Web 开发的知识。据我了解，像 Django 这样的框架似乎很擅长这一点（如果我误解了，请纠正我）。

所以问题是：如果我的兴趣主要是 Web 开发的用户界面部分，我需要了解多少 Django 或 Rails。我可以让其他人做后端的事情吗？

请原谅我对术语的不精确选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T18:59:24.943

您需要对服务器端有所了解。这是你需要知道的。

如果您有一个繁重的 JavaScript 网站，您可能希望使用 JSON（JavaScript 对象表示法）将信息从服务器传递到客户端。这只是一种将数据格式化为 JavaScript 知道如何转换为对象的字符串的方法。

因此，每个向客户端发送数据的服务器端函数都将返回 JSON。如果有人为您编写服务器端，那么您应该知道的就是这些。你的 JS 函数会收到 JSON，然后你处理它。

如果您必须自己编写服务器端，那么这涉及 1) 从数据库中获取数据 2) 格式化数据 3) 转换为 JSON。

我已经开源了一个接受 JSON 消息的评论小部件，并提供了如何设置 Django 服务器代码的示例。也许它会帮助你：[http ://www.trailbehind.com/comment_widget/](http://www.trailbehind.com/comment_widget/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T20:59:30.537

您可以在不了解服务器代码的情况下从事前端用户界面开发的职业。但是，您最好至少对发送请求时服务器上发生的情况、数据的来源以及网页的生命周期有一个基本的了解。这假设您有后端开发人员的支持。正如您在问题中提到的 Ajax，这意味着您希望您的网站实际执行某些操作，这将需要在后端发生一些事情（例如存储、数据操作、用户登录等）。

与所有事情一样，您知道的越多，就越容易从敬业的专业人士那里得到您想要的东西。我建议您学习一般的编程知识，而不是尝试学习语言和框架。特别是，尝试理解数据类型、服务器设置（如超时、post 与 get 等）、安全性和数据库交互，因为它们存在于 JavaScript/ECMAScript 之外。这样，当开发人员解释为什么他们不能做你要求的事情或提供替代方案时，你说的是同一种语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T18:52:26.690

是和不是。通常人们对 AJAX 的看法，例如在 YouTube 上发表评论并看到评论立即出现感谢消息，例如，需要服务器端语言来处理请求、查找数据并将结果作为 html 片段、JSON 数据返回，或 XML。

但是，也可以对静态资源进行 AJAX 调用。您可以将 XML 文件或 html 片段静态存储在您的 Web 服务器上并加载它。这种静态加载的用途通常较少，因为如果您的常规页面旁边的文件中已经有静态 html 或数据，为什么不直接将这些数据放入页面中呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T18:53:30.087

它有助于设置本地服务器并编写几行代码来为您的 AJAX 调用提供服务。你可以通过少量的后端学习来学习大量的 JavaScript。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T18:58:38.003

如果您是 Web 开发的新手，您宁愿等待 Ajax 和服务器端语言，直到您学习了 HTML、CSS 和 JavaScript 的基础知识，特别是如果您想主要使用用户界面而不是功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T19:04:54.323

正如您所说，您可以让其他人做后端并专注于前端（JavaScript、HTML、CSS）。

在存储或处理来自服务器的数据时，您需要与后端开发人员进行沟通。

如前所述，后端开发知识会很有用，但如果有人在做，那对于开始来说并不是必需的。

# cocoa - 如何以一定角度绘制 NSString？

> ID：930313
> 
> 赞同：4
> 
> 时间：2009-05-30T18:46:18.433
> 
> 标签：cocoa, macos, nsstring

是否有一组我可以指定的字符串属性，当我调用时会以一定角度绘制文本：

```
[label drawAtPoint:textStart withAttributes:attributes]; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-30T20:28:13.343

这是一个使用变换来旋转绘图上下文的示例。本质上它就像设置颜色或阴影一样，只需确保使用`-concat`而不是`-set`.

```
CGFloat rotateDeg = 4.0f;
NSAffineTransform *rotate = [[NSAffineTransform alloc] init];

[rotate rotateByDegrees:rotateDeg];
[rotate concat];

// Lock focus if needed and draw strings, images here.

[rotate release]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T19:04:27.193

NSString 本身没有旋转，但是你可以旋转上下文。就坐标空间而言，字符串将始终“水平”绘制，但对应的实际方向取决于上下文。只需根据需要使用 NSAffineTransform 旋转它。

# vb.net - vb.net 在用户控件上调用子例程

> ID：930322
> 
> 赞同：0
> 
> 时间：2009-05-30T18:49:25.417
> 
> 标签：vb.net, user-controls

我在拆分容器中有一个 panel2，其中加载了几个用户控件。面板 1 有一个退出按钮，我想调用加载到面板 2 中的用户控件之一中的子例程之一。

```
Private Sub btnExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExit.Click
        Dim dialogMessage As DialogResult
        Dim a As New ucTimeTracker

    dialogMessage = MessageBox.Show("Are you sure you want to exit?", "Exit Ready Office Assistant?", _
    MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question)

    If dialogMessage = Windows.Forms.DialogResult.Yes Then

        ucTimeTracker.autoWriteFileOnExit()
        Me.Close()

    Else
        Return
    End If

End Sub 
```

这条线给我带来了麻烦。

```
ucTimeTracker.autoWriteFileOnExit() 
```

我得到了（对非共享成员的引用需要对象引用）。

我希望 frmMain.SplitContainer.Panel1 上的退出按钮调用加载到 splitContainer.Panel2 的名为 ucTimeTracker 的用户控件上的 autoWriteFileOnExit()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T19:12:40.143

您似乎使用的是用户控件类名称`ucTimeTracker`而不是实例名称。在设计视图中单击用户控件，在属性视图中，有一个“名称”属性。改用 name 属性中的值（可能`ucTimeTracker1`）：

```
 ucTimeTracker1.autoWriteFileOnExit() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T19:12:39.300

您正在使用`ucTimeTracker`来引用方法，这是类的名称。在该方法的前面，您创建了该类的一个实例 ( `Dim a As New ucTimeTracker`)，因此`a. autoWriteFileOnExit()`如果这是您要使用的实例，您应该调用它。如果 ucTimeTracker 是窗体上的控件，则应改为使用该控件的名称。

要理解这一点，您需要了解*静态*成员和*实例*成员之间的区别。静态成员可以直接通过类访问，而不需要创建类的实例。为了使用实例成员，您首先需要一个类的实例。您可以以 Int32 类为例：

```
' call a static method in the Int32 class, that returns an Int32 instance'
Dim asInt As Int32 = Int32.Parse("14") 
' call an instance method on the Int32 instance, that will act on the data in '
' that instance, returning a string representation of its value '
Dim asString As String = asInt.ToString() 
```

通常静态方法不会作用于类中保存的数据（尽管并非总是如此），而是作用于通过参数传递给方法的数据。实例方法可以访问该特定实例的内部数据，并且可以对该数据进行操作（如上例所示）。

# c++ - «F(5)» 和 «int x; F(x)» 调用不同的函数？

> ID：930323
> 
> 赞同：2
> 
> 时间：2009-05-30T18:50:04.820
> 
> 标签：c++

我想编写两个不同的函数来处理一个常量值和一个给定类型的变量（即，`int`）。

这是示例测试用例：

```
int main(void) {
        int x=12;
        F(5); // this should print "constant"
        F(x); // this should print "variable"
} 
```

我认为定义如下就足够了：

```
void F(int v) {  cout << "constant\n"; }
void F(int& v) { cout << "variable\n"; } 
```

这假设编译器将选择`int&`变量作为“更好的专业化”，并将`int`常量作为唯一选择）。然而，`G++`结果如下：

```
test.cc: In function ‘int main()’:
test.cc:13: error: call of overloaded ‘F(int&)’ is ambiguous   // for line: F(x);
test.cc:4: note: candidates are: void F(int)
test.cc:5: note:                 void F(int&) 
```

`G++`确实`F(int)`为常量选择，但不知道为变量选择哪个函数。
有谁知道为什么会这样？

**背景**：我正在 C++ 中尝试类似 prolog 的统一方法。能够知道常量和变量之间的区别将帮助我在诸如`functor(x,5) <=> functor(3,5)`.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-30T18:59:46.067

如果您想要区分编译时间常数和非编译时间常数 - 那么您就没有机会了。那是不可能的。

但是，如果您想区分非常量变量和常量变量（以及包括的所有其他内容 - 如文字），那么您可以使用 const 引用和非常量引用参数重载函数。对于这种情况，C++ 标准引入了额外的规则，使原本模棱两可的情况变得不模棱两可。

```
void f(int const&); // #1
void f(int&);       // #2 
```

在这件事上，做了以下决定

```
int x = 0;
int const y = x;
int const z = 1;

f(1); // #1
f(x); // #2
f(y); // #1
f(z); // #1 
```

请注意它如何无法区分 y 和 z，即使 z 的值是编译时常数（称为积分常数表达式，或 ICE），而 y 不是。

你*可以*做的是只接受编译时间值。重载函数，使一个是模板，另一个不是

```
template<int N> void f(); // #1
void f(int n);            // #2 
```

它的行为是这样的：

```
int x = 0;
int const y = x;
int const z = 1;

f<1>(); // #1
f(1);   // #2
f<y>(); // error, y not an ICE
f<z>(); // #1
f(x);   // #2 
```

# c++ - 使用 Spirit Parser 框架处理转义

> ID：930334
> 
> 赞同：2
> 
> 时间：2009-05-30T18:56:21.033
> 
> 标签：c++, boost-spirit

我正在尝试使用精神解析器解析类似于以下内容的字符串：

`<junk> -somearg#this is a string with a literal ## in it# <junk>`

我正在寻找的是一种可以提取 # 标记内的部分的语法，但是很聪明地跳过了中间的双 ##，这是一个转义，意思是文字 #。

这就是我的想法：
`confix_p(L'#', *anychar_p, L'#' >> ~ch_p(L'#'))`
但是这会返回：
`#this is a string with a literal ##`
我希望它跳过`##`字符....这可能吗？

比利3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T01:14:17.743

我通过在 confix 解析器中添加一个 kleene 星来解决这个问题。不管怎么说，还是要谢谢你！

`*confix_p(L'#', *anychar_p, L'#' >> ~ch_p(L'#'))`按预期工作。

# wpf - RoutedCommand 的类构造函数 ownertype 参数有什么用？

> ID：930340
> 
> 赞同：11
> 
> 时间：2009-05-30T18:58:50.513
> 
> 标签：wpf, routed-commands

RoutedCommand 的构造函数将“所有者类型”作为最后一个参数。它的意义是什么？什么时候使用？

MSDN 文档完全不知道为什么需要它以及我是否可以对所有命令使用一种类型

引用自 MSDN

```
ownerType
     Type: System.Type The type
     which is registering the command. 
```

还有一件事。从名称数组动态创建新的路由命令时应该使用什么类型。看起来任何类型都有效，所以我使用的是 UIElement，但如果有更适合的类型，我想知道。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T19:15:46.843

RoutedCommand 的源代码显示该类型成为 OwnerType 属性。在获取 InputGestures 时，最终会通过以下私有方法查询该属性。因此，看起来这种类型似乎被用于根据创建 RoutedCommand 的类型来查找（硬编码的）命令集。

```
private InputGestureCollection GetInputGestures()
{
    if (this.OwnerType == typeof(ApplicationCommands))
{
    return ApplicationCommands.LoadDefaultGestureFromResource(this._commandId);
}
if (this.OwnerType == typeof(NavigationCommands))
{
    return NavigationCommands.LoadDefaultGestureFromResource(this._commandId);
}
if (this.OwnerType == typeof(MediaCommands))
{
    return MediaCommands.LoadDefaultGestureFromResource(this._commandId);
}
if (this.OwnerType == typeof(ComponentCommands))
{
    return ComponentCommands.LoadDefaultGestureFromResource(this._commandId);
}
return new InputGestureCollection();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-17T16:54:50.290

我知道这是一个非常古老的问题，但它是“routedcommand ownertype”的热门搜索。

在每个 RoutedCommand 对象中存储 OwnerType 和 Name 可以提示您如何在代码中查找对它的引用。假设您在某个具有任意[ICommandSource](http://msdn.microsoft.com/en-us/library/system.windows.input.icommandsource.aspx)参数的方法上运行调试器。您可以检查 Command 属性，如果您看到 OwnerType 是`CommonCommands`并且 Name 是`"DoSomething"`，您可以导航到 CommonCommands 类的 DoSomething 字段，其中可能有有用的注释，或者搜索对`CommonCommands.DoSomething`以查找关联的 CommandBindings 或其他内容的引用。如果没有这些属性，RoutedCommand 将只是一个匿名对象。

我不知道这个原因是否是 API 设计者在加入这个论点时真正想到的，但至少它对我有用。

# database - 随着数据量的增加确保数据库性能

> ID：930347
> 
> 赞同：3
> 
> 时间：2009-05-30T19:00:26.580
> 
> 标签：database, performance

我目前正在进行性能调整练习。该应用程序是数据库密集型的，处理逻辑很少。性能调优是围绕数据库调用的方式和数据库本身进行的。

我们进行了查询调优，我们放置了缺失的索引，我们尽可能减少或消除了数据库调用。该应用程序运行良好，一切都很好。

使用较小的数据量（比如多达 100,000 条记录），性能非常出色。我的问题是，需要做些什么来确保在更高数据量下的良好性能？数据量预计将达到 1000 万条记录。

我可以想到表和索引分区，建议为数据库存储和定期归档优化文件系统以控制行数。我想知道还能做什么。任何提示/策略/模式都会非常有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T19:11:43.203

**监测。** 使用一些工具来监控性能以及 CPU、内存和 I/O 的饱和度。制作趋势线，以便在到达那里之前知道下一个瓶颈在哪里。

**测试。** 创建模拟数据，以便您今天在测试服务器上拥有 1000 万行*。* 对应用程序中的查询进行基准测试，看看它们在数据量增加时的表现如何。您可能会对首先发生故障的情况感到惊讶，或者它可能完全按照预期进行。关键是你可以*找出来*。

**维护。** 确保您的应用程序和基础架构支持一些停机时间，因为这始终是必要的。您可能必须对索引进行碎片整理和重建。您可能需要重构一些表结构。您可能必须升级服务器软件或应用补丁。要在不中断连续运行的情况下做到这一点，您需要在设计中内置一些冗余。

**研究。**为您正在使用的数据库品牌找到最好的期刊和博客，然后阅读它们（例如，如果您使用 MySQL ，[请访问 http://www.mysqlperformanceblog.com ）。](http://www.mysqlperformanceblog.com)你可以问像你在这里问的那样好的问题，但也可以阅读其他人在问什么，以及他们被建议做些什么。您可以学习解决您甚至还没有的问题的解决方案，这样*当*您拥有它们时，您就会有一些策略可以使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T19:08:21.820

你是在正确的方式：
**1）**正确的索引
**2）** DBMS 选项调整（内存缓存，缓冲区，内部线程控制等）
**3）**查询调整（特别是记录慢查询，然后调整/重写它们）
**4）**调整你的您可能需要研究查询执行计划的查询和索引
**5)**强大的专用服务器
**6)**考虑您的客户端应用程序发送到数据库的查询。它们总是必要的吗？您需要您要求的所有数据吗？是否可以缓存一些数据？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T19:08:54.080

不同的数据库需要以不同的方式进行调整。您使用的是什么 RDBMS？

此外，您如何知道到目前为止所做的事情是否会导致较大数据集的性能不佳？您是否使用大量测试数据测试了当前的优化？

当你这样做时，性能有何变化？如果您能够调整数据库以便它使用现有数据执行，那么没有理由认为您的方法不适用于更大的数据集。

根据 RDBMS，下一种解决方案很简单：获得更大、更强大的硬件。更多 RAM、更多磁盘、更多 CPU。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T19:57:19.927

1000 万条记录可能太小而无法进行分区。通常，只有当您的数据量比这大一个数量级或数量级时，分区才会有意义。

对具有 100,000 行的数据库进行索引调整可能会为您提供 1000 万行所需的 99%。注意系统中大型表的表扫描或索引范围扫描。在较小的桌子上它们很好，在某些情况下甚至是最佳的。

归档旧数据可能会有所帮助，但这对于 1000 万行来说可能是多余的。

一种可能的优化是将报告转移到单独的服务器上。这将减轻服务器的负担——报告在操作系统上运行时通常是非常反社会的，因为模式往往没有针对它进行很好的优化。

您可以使用数据库复制来执行此操作或创建数据集市以进行报告。复制更容易实现，但报告的效率会降低，不会比生产系统上的效率高。构建星型模式数据集市的报告效率更高，但需要额外的开发工作。

# .net - 使用 MVC 的部分页面返回

> ID：930349
> 
> 赞同：0
> 
> 时间：2009-05-30T19:00:36.733
> 
> 标签：.net, asp.net-mvc

我对 MVC 很陌生，希望我能以正确的方式处理这个问题。任何意见或建议都会很棒。

我想正常加载图像的缩略图视图，当用户单击图像时，动态图片使用 colorbox jquery 插件加载。

问题是当您单击较小的图像时，动态图像会变成整个页面。我意识到这是因为 href 指向的位置，但我需要一些关于正确方法的指针来完成此操作。

```
 <div id="gallery">

    <% For Each item In Model%>

    <ul>
        <li>
            <a href="<%=Url.Action("CreateWM", "Image", New With {.id = item.ImageID })%>" title="Please work" rel="Test">
                <img src="<%=Url.Action("Create", "Image", New With {.id = item.ImageID })%>" width="300" height="300" alt="Woot" />
            </a>
        </li>
    </ul>

    <% Next%>

</div> 
```

如果有人需要，这就是 ImageController。ImageActionResult 正在获取内存流并返回图像

```
Public Class ImageController
   Inherits System.Web.Mvc.Controller

    Public Function CreateWM(ByVal id As String) As ImageActionResult

        Using db As New DataClasses1DataContext
            Dim ms As New MemoryStream(db.MyImages.Single(Function(x) x.ImageID = id).ImageData.ToArray())
            Return New ImageActionResult(ms, "hey.jpg", True)
        End Using

    End Function

    Public Function Create(ByVal id As String) As ImageActionResult

        Using db As New DataClasses1DataContext
            Dim ms As New MemoryStream(db.MyImages.Single(Function(x) x.ImageID = id).ImageData.ToArray())
            Return New ImageActionResult(ms, "hey.jpg", False)
        End Using

    End Function

End Class 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T19:04:11.063

您需要使用客户端 javascript操作**图像元素的 URL，例如：**

```
<a href="#" onclick="$('#myImg')[0].src='<%=Url.Action("CreateWM", "Image", New With {.id = item.ImageID })%>'" title="Please work" rel="Test">
     <img id="myImg" src="<%=Url.Action("Create", "Image", New With {.id = item.ImageID })%>" width="300" height="300" alt="Woot" />
</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T19:04:45.620

使用您正在使用的 ColorBox 插件，您可以指定动态图像的宽度/高度：

```
$('a.dynamicImage').colorbox({width: 75%, height: 75%}); 
```

# wpf - 如何刷新 WPF DataGrid？

> ID：930350
> 
> 赞同：29
> 
> 时间：2009-05-30T19:01:12.753
> 
> 标签：wpf, data-binding, datagrid

我有一个包含`DataGrid`一些数据的 WPF。您可以通过单独的窗口添加行。`DataContext`是一样的，一个对象`LINQ-to-SQL`。绑定也是一样，我把`ItemsSource`属性绑定到一个表上。

在另一个窗口中，当用户单击 时`Save`，我以编程方式创建一行并使用`InsertOnSubmit`. 之后我使用`DataContext`'s`SubmitChanges`方法。

我的问题是`DataGrid`没有更新。如果我重新启动应用程序，我可以看到新行，所以它在数据库中，但我找不到刷新`DataGrid`.

到目前为止，我已经尝试`UpdateTarget`在`BindingExpression`of the上使用`DataGrid`，但没有帮助。我也试过`dataGrid.Items.Refresh()`——同样的结果。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2011-01-26T05:47:25.433

从这里尝试 datagrid.Items.Refresh() [http://programmer.wrighton.org/2009/01/wpf-datagrid-items-refresh.html](http://programmer.wrighton.org/2009/01/wpf-datagrid-items-refresh.html)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-01T14:42:56.683

它不更新的原因是它`LINQ-to-SQL`没有实现`INotifyCollectionChanged`，所以 WPF 没有办法告诉它`ItemsSource`已经更新。解决此问题的最不可怕的方法是将您的 LINQ-to-SQL 结果复制到`ObservableCollection`- 当您执行插入时，还添加到可观察集合中。然后你会看到更新。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-21T20:53:42.997

我遇到了同样的问题，发现 ObservableCollection 的最佳位置是 DataContext。它有一些由设计器生成的部分方法，可用于更新集合。这段代码运行良好：

```
partial class DataClassesDataContext
{
    private ObservableCollection<Task> taskCollection;
    public ReadOnlyObservableCollection<Task> TaskView { get; private set; }

    partial void OnCreated()
    {
        taskCollection = new ObservableCollection<Task>(Tasks);
        TaskView = new ReadOnlyObservableCollection<Task>(taskCollection);
    }

    partial void InsertTask(Task instance)
    {
        taskCollection.Add(instance);
        this.ExecuteDynamicInsert(instance);
    }

    partial void DeleteTask(Task instance)
    {
        taskCollection.Remove(instance);
        this.ExecuteDynamicDelete(instance);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T14:45:27.473

问题是您需要刷新 LINQ-to-SQL DataContext。即使在提交更改后，DataContext 也不会正确识别新行。您需要处理您拥有的 DataContext 并创建一个新的。在大多数情况下，DataContext 应该用于一个短期操作，而不是作为一个长期存在的对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-15T01:47:53.183

如果您必须在另一个窗口中重新加载网格，您可以简单地关闭该窗口并再次调用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-08T00:11:39.900

或者只是再次调用搜索代码（通常是搜索按钮）>我已经解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-13T14:08:17.053

由于某种原因`Items.Refresh()`不适合我。起作用的是让我的基础集合继承`ObservableCollection`，然后调用它的`Add`方法。

```
((ContactUIObjects)dgrdContacts.ItemsSource).Add(new ContactUIObject(o)); 
```

`ContactUIObjects`只是网格基础集合。

# java - Netbeans 6.5 阻止向 Java 文件添加断点。配置问题？

> ID：930351
> 
> 赞同：1
> 
> 时间：2009-05-30T19:01:25.063
> 
> 标签：java, netbeans6.5

我无法向任何 Java 文件添加断点。似乎在 netbeans issuezilla 中略有不同的上下文中报告了这个问题。除了升级到 NB6.7M2 之外，我找不到任何具体的解决方法，目前这是不可行的。

我尝试过的其他事情是 JDK 升级、辣蝙蝠翅膀和一瓶 silvermoon 端口（多次系统重启；））

我只是想知道 SO 的任何大师之前是否遇到过这个问题，以及是否是某些配置在 ide 更新/项目 svn 更新等过程中搞砸了。

注意构建版本：20081110001 Java：1.6.0__14

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T19:38:41.947

做了更多调查，发现 Netbeans 更新中的一个错误已经停用了我的大多数 Java 插件，其中一个是......“Java 调试”

激活插件解决了这个问题。

“哦。好吧，我觉得很害羞。[变成一只羊]”——精灵（阿拉丁）

作为参考，该设置位于“Java”类别下的 Tools > Plugins > Installed (tab) 中

# subsonic - 获取所有已删除的记录

> ID：930361
> 
> 赞同：0
> 
> 时间：2009-05-30T19:05:03.887
> 
> 标签：subsonic

我正在寻找一种方法来获取在特定表上`deleted`设置的所有记录。`true`我怎么能做到这一点？

注意：使用 SubSonic 自动生成的类。不是 T-SQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T19:47:42.630

自动生成的 SubSonic 类不支持查询逻辑删除。但你可以这样做（版本 2.1/2.2 语法）：

```
public partial class TableClassCollection
{

    public TableClassCollection LoadAll(bool suppressLogicalDeletes)
    {

          SubSonic.SqlQuery q = new SubSonic.Select(TableClass.Schema)
              .From(TableClass.Schema);

          if (suppressLogicalDeletes)
          {
              q.Where(TableClass.DeletedColumn).IsEqualTo(false);
          }

          return q.ExecuteAsCollection<TableClassCollection>();
      }

} 
```

[subsonicproject.com](http://subsonicproject.com/querying/select-queries/)上的更多示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T19:49:21.660

我以前从未听说过 SubSonic，但出现了一个快速的 Google 搜索： [在 SubSonic 中选择查询](http://subsonicproject.com/querying/select-queries/)。

因此，使用该页面作为指南，听起来您可以将查询编写为：

```
FooCollection deletedFoos = // use the generated collection class
    DB.Select().From("FooTable") // table name goes here
        .Where("deleted").IsEqualTo(true) // might need 1, depends on database?
        .ExecuteAsCollection<FooCollection>(); // should match the type above 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-30T19:06:56.457

您的问题没有太多细节，但假设有一个名为“已删除”的列，它看起来像这样：

```
select * from tableName where deleted = true 
```

# c# - C# 视频课程

> ID：930375
> 
> 赞同：0
> 
> 时间：2009-05-30T19:11:45.433
> 
> 标签：c#, .net

### 复制

> *   [是否有任何一个网站包含许多好的 C# 截屏视频？](https://stackoverflow.com/questions/155393/is-there-any-one-website-which-contains-many-good-c-screencasts)
>     
> *   [C# 培训视频](https://stackoverflow.com/questions/100772/c-training-videos)

* * *

因此，任何人都可以推荐一组学习 C# 的视频，最好是免费的（根据我的经验，非免费视频似乎更倾向于 shlock），

我了解一些大学现在使用 C# 作为他们的“101”语言。有没有这样的大学有开放课程系列的视频？

PS：我对大学课程特别感兴趣。这些是最有可能采用长期（3-4 个月）结构化方法的方法，也就是教学大纲。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T11:48:14.747

我认为 Plural Sight 有最好的课程。他们有一个免费的 C# 介绍。

[http://www.pluralsight.com/main/olt/Course.aspx?n=dotnet-csharp-tutorial](http://www.pluralsight.com/main/olt/Course.aspx?n=dotnet-csharp-tutorial)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T19:22:22.947

它们不是免费的，但我从[LearnVisualStudio.Net](http://www.learnvisualstudio.net)看到的每个视频都非常好。我以 90 美元的价格获得了“终身”会员资格，这非常值得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-05T14:18:54.237

[**在 YouTube 上学习 C#**](http://www.youtube.com/view_play_list?p=CF53106B24EF9ACB)：89 个 C# 教程合集。主要是如何用 C# 做某事的例子。另一个[**98 个 C# 视频的大集合**](http://www.youtube.com/view_play_list?p=13141D4688033C31)。它涵盖了很多 C# 基础知识。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T19:14:53.103

我觉得[AppDev](http://www.appdev.com/)不错。那里有很多免费的东西（尽管不是全部）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T19:15:50.197

MSDN 有大量的学习视频。看看[这里](http://msdn.microsoft.com/en-us/vcsharp/aa336766.aspx)。这些视频通常针对特定主题，并且有足够的细节让您从中学到很多东西。

此外，如果您正在寻找基于 Web 的应用程序，Microsoft 会为 ASP.NET 制作视频。看看[这里](http://www.asp.net/LEARN/videos/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T10:37:29.163

试试微软学习管理器 - [http://learning.microsoft.com/Manager/Catalog.aspx?view=free](http://learning.microsoft.com/Manager/Catalog.aspx?view=free)

您为大部分视频付费，但也有一些免费的介绍性视频也不错。

希望这可以帮助...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-07T16:34:27.027

[http://polishwords.com.pl/video_tutorials.php?g=programowanie_w_visual_studio](http://polishwords.com.pl/video_tutorials.php?g=programowanie_w_visual_studio)但不幸的是波兰语:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-05T14:25:38.623

*   这些是 Microsoft 免费提供的 Learnvisualstudio.net 的视频：[链接](http://msdn.microsoft.com/en-us/beginner/bb308734.aspx)
*   威廉·斯蒂尔 (William J. Steele) 的 C# 汤到坚果网络广播：[链接](http://blogs.msdn.com/wsteele/archive/2007/01/29/c-soup-to-nuts-webcast-links.aspx)

# django - 在 Django 中创建订单

> ID：930379
> 
> 赞同：0
> 
> 时间：2009-05-30T19:13:21.403
> 
> 标签：django, django-admin, django-forms

大家好，我有几个关于 django 管理员的问题。

先说相关细节。我目前有客户端、打印机、墨盒和订单模型。

Printer 模型对 Cartridge 模型有一个 ManyToManyField，这将允许您选择可以与该打印机一起使用的所有墨盒。

Cliente 对他们拥有的打印机有一个 ManyToManyField。

1) 我想通过 Django 管理员创建一个订单，让您通过 ManyToManyField 指定客户端、折扣和多个墨盒。这有点棘手，因为我必须通过另一个表来指定它是新墨盒还是重新填充。

2) 我希望管理员过滤墨盒以仅显示属于他们拥有的打印机的墨盒。

3）我也想有一个字段来保存他们订单的总价格，但它应该根据他们添加到订单中的墨盒数量来计算。我不知道这是否应该通过向订单中添加更多相同的墨盒或通过在相关表中指定数量的另一个字段来完成。

这可以在管理员中完成还是我需要使用表格？如果是这样，我将如何将其添加到管理员？这似乎很困难，可能我必须在多个部分中做一些事情，因为为了过滤墨盒列表，我必须事先了解客户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T00:09:44.053

据我所知，不，这不可能。开发版本有一些[限制外键的方法](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_for_foreignkey)，但在我看来，基于客户的限制是不可能的，因为它依赖于单独的外键。

最好的建议是，如果您真的想在管理表单中执行此操作，则使用 Javascript 来执行此操作。您仍然需要通过 AJAX 调用来获取客户拥有的打印机列表以及基于此显示的墨盒，但可以这样做。您只需指定要与[Media 类](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-media-definitions)一起加载的 JS 文件。

但我认为这比它的价值更多。我认为最简单的方法是使用[Form Wizards](http://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/)。这样，您将有一个步骤来选择客户，因此在下一步您知道要显示哪些墨盒。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:40:05.993

我已经解决了类似的问题，并且得出的结论是，在许多这样的情况下，使用表单编写自己的管理界面确实比尝试将不打算存在的功能硬塞到管理员中更好。

就 3) 而言，这取决于您的产品基础是什么样的。如果您可能有客户订购 50 个相同的小部件，您可能确实需要数量字段。如果客户更有可能订购 2 个小部件，一个是红色的，一个是蓝色的，则将每个项目分别添加到 manytomany 字段并将它们分组到您的订单界面中。

# javascript - 我应该在哪里包含 JS 文件

> ID：930380
> 
> 赞同：2
> 
> 时间：2009-05-30T19:13:27.660
> 
> 标签：javascript, html, include

我有一个 PHP 应用程序，其中有一个 div 容器，其中包含`$_GET`来自 URL 字符串的应用程序。

目前，有两个应用程序需要 TinyMCE，一个应用程序需要 jQuery 和 jQuery UI。

**问题是，我应该在页面上的哪里包含文件？**

在标题中，页面加载非常缓慢，>30 秒（现在 <10 秒，使用不同的路由器），在底部，需要脚本的页面无法正确加载。

JS 文件已经被缩小和压缩。

TinyMCE 不会 gZIP，因为安装了 Zlib（由于 GD），那么我应该如何优化这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T19:20:27.740

雅虎[！Exceptional Performance 团队](http://developer.yahoo.com/performance/)建议将元素[放在元素`script`的末尾`body`](http://developer.yahoo.com/performance/rules.html#js_bottom)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T19:18:48.163

在底部并在文档完全加载时运行您的脚本（使用“onload”事件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T19:22:15.630

通过将 JavaScript 文件放在结束 BODY 标记之前，您可以在 JavaScript 文件加载时加载页面的其余部分。如果将其放在 HEAD 部分，则页面将挂起，直到脚本加载。

但是，如果在标题中加载需要 30 秒，那么您可能会面临不同的问题。TinyMCE 加载时间不应超过 30 秒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T19:23:25.923

对此可能没有一个正确的答案。

通常放置 javascript 可以`<head>`正常工作，但 30 秒太多了。我正在开发一个 JavaScript 应用程序，它可以动态加载大约 70 个未压缩的 javascript 文件（有些非常大），并且不需要 30 秒左右。

信息太少，无法解决。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T19:33:02.347

有多少个JS文件？如果它很多，那么您可能想查看 Steve Souders 的幻灯片，了解更快的网站。下载 JS 文件是一个阻塞动作。Souders 有一个很好的解决脚本阻塞的方法。[查看来自http://www.thebitsource.com/2009/03/14/sxsw-interactive-2009-steve-souders-on-even-faster-web-sites/](http://www.thebitsource.com/2009/03/14/sxsw-interactive-2009-steve-souders-on-even-faster-web-sites/)的 PPT

另外，您从哪里为 JS 提供服务？尝试从 Google AJAX Libraries API 提供 jQuery。它使用他们的 CDN 和缓存很长一段时间。所以用户只需要 dl 文件 1 次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-28T00:12:10.910

I want my JS Code be completely seperated from the XHTML, thus putting it inline HTML before the body closing tag won't do for me.

I declare one single JS File in the html head. Then copy/paste all Libraries etc into that JS file. This will result in one HTTP Request, which speeds things up on mobile browsers too.

I then use Prototype to get DOM sensitive functions started:

`document.observe("dom:loaded", function) { // code goes here });`

# python - 如何获取列表的最后一个元素

> ID：930397
> 
> 赞同：2537
> 
> 时间：2009-05-30T19:28:53.667
> 
> 标签：python, list, indexing

在 Python 中，如何获取列表的最后一个元素？

* * *

## 回答 #1

> 赞同：3704
> 
> 时间：2009-05-30T19:29:55.660

`some_list[-1]`是最短和最 Pythonic 的。

事实上，你可以用这种语法做更多的事情。`some_list[-n]`语法获取倒数第 n 个元素。所以`some_list[-1]`得到最后一个元素，`some_list[-2]`得到倒数第二个，等等，一直到`some_list[-len(some_list)]`，这给了你第一个元素。

您也可以通过这种方式设置列表元素。例如：

```
>>> some_list = [1, 2, 3]
>>> some_list[-1] = 5 # Set the last element
>>> some_list[-2] = 3 # Set the second to last element
>>> some_list
[1, 3, 5] 
```

请注意，[`IndexError`](https://docs.python.org/3/library/exceptions.html#IndexError)如果预期的项目不存在，按索引获取列表项将引发一个。这意味着`some_list[-1]`如果为空将引发异常`some_list`，因为空列表不能有最后一个元素。

* * *

## 回答 #2

> 赞同：300
> 
> 时间：2010-11-09T23:26:38.220

如果您的`str()`or`list()`对象可能最终为空：`astr = ''`or `alist = []`，那么您可能希望使用`alist[-1:]`而不是`alist[-1]`for 对象“相同性”。

这样做的意义在于：

```
alist = []
alist[-1]   # will generate an IndexError exception whereas 
alist[-1:]  # will return an empty list
astr = ''
astr[-1]    # will generate an IndexError exception whereas
astr[-1:]   # will return an empty str 
```

区别在于返回空列表对象或空 str 对象更像是“最后一个元素”，然后是异常对象。

* * *

## 回答 #3

> 赞同：126
> 
> 时间：2009-05-30T22:21:08.810

你也可以这样做：

```
last_elem = alist.pop() 
```

这取决于您想对列表做什么，因为该`pop()`方法将删除最后一个元素。

* * *

## 回答 #4

> 赞同：94
> 
> 时间：2012-08-20T17:41:54.517

在 python 中显示最后一个元素的最简单方法是

```
>>> list[-1:] # returns indexed value
    [3]
>>> list[-1]  # returns value
    3 
```

还有许多其他方法可以实现这样的目标，但这些方法都很简短且易于使用。

* * *

## 回答 #5

> 赞同：79
> 
> 时间：2017-06-23T22:05:25.930

> ## 在 Python 中，如何获取列表的最后一个元素？

要获取最后一个元素，

*   不修改列表，并且
*   假设您知道列表*有*最后一个元素（即它是非空的）

传递`-1`给下标符号：

```
>>> a_list = ['zero', 'one', 'two', 'three']
>>> a_list[-1]
'three' 
```

## 解释

索引和切片可以将负整数作为参数。

我修改了[文档](https://docs.python.org/3/tutorial/introduction.html)中的一个示例，以指示每个索引引用的序列中的哪个项目，在这种情况下，在 string`"Python"`中，`-1`引用最后一个元素，即字符，`'n'`：

```
 +---+---+---+---+---+---+
 | P | y | t | h | o | n |
 +---+---+---+---+---+---+
   0   1   2   3   4   5 
  -6  -5  -4  -3  -2  -1

>>> p = 'Python'
>>> p[-1]
'n' 
```

## 通过可迭代解包分配

为了获取最后一个元素，此方法可能不必要地实现第二个列表，但为了完整性（并且因为它支持任何可迭代的 - 不仅仅是列表）：

```
>>> *head, last = a_list
>>> last
'three' 
```

变量名，head 绑定到不必要的新创建列表：

```
>>> head
['zero', 'one', 'two'] 
```

如果您不打算对该列表执行任何操作，则更合适：

```
*_, last = a_list 
```

或者，真的，如果你知道它是一个列表（或者至少接受下标符号）：

```
last = a_list[-1] 
```

## 在一个函数中

一位评论者说：

> 我希望 Python 有一个像 Lisp 一样的 first() 和 last() 函数……它会摆脱很多不必要的 lambda 函数。

这些将很容易定义：

```
def last(a_list):
    return a_list[-1]

def first(a_list):
    return a_list[0] 
```

或使用`operator.itemgetter`：

```
>>> import operator
>>> last = operator.itemgetter(-1)
>>> first = operator.itemgetter(0) 
```

在任一情况下：

```
>>> last(a_list)
'three'
>>> first(a_list)
'zero' 
```

## 特别案例

如果您正在做一些更复杂的事情，您可能会发现以稍微不同的方式获取最后一个元素会更高效。

如果您不熟悉编程，则应避免使用此部分，因为它将算法的其他语义不同部分耦合在一起。如果你在一个地方改变你的算法，它可能会对另一行代码产生意想不到的影响。

我尝试尽可能完整地提供警告和条件，但我可能遗漏了一些东西。如果您认为我留下警告，请发表评论。

### 切片

列表的切片返回一个新列表 - 因此，如果我们想要新列表中的元素，我们可以从 -1 切片到末尾：

```
>>> a_slice = a_list[-1:]
>>> a_slice
['three'] 
```

如果列表为空，这样做的好处是不会失败：

```
>>> empty_list = []
>>> tail = empty_list[-1:]
>>> if tail:
...     do_something(tail) 
```

而尝试通过索引访问会引发`IndexError`需要处理的问题：

```
>>> empty_list[-1]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: list index out of range 
```

但同样，只有在需要时才应为此目的进行切片：

*   创建了一个新列表
*   如果先前的列表为空，则新列表为空。

### `for`循环

`for`作为 Python 的一个特性，循环中没有内部作用域。

如果您已经对列表执行了完整的迭代，最后一个元素仍将被循环中分配的变量名引用：

```
>>> def do_something(arg): pass
>>> for item in a_list:
...     do_something(item)
...     
>>> item
'three' 
```

这在语义上不是列表中的最后一件事。`item`从语义上讲，这是名称绑定的最后一件事。

```
>>> def do_something(arg): raise Exception
>>> for item in a_list:
...     do_something(item)
...
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
  File "<stdin>", line 1, in do_something
Exception
>>> item
'zero' 
```

因此，这应该只用于获取最后一个元素，如果你

*   已经在循环，并且
*   您知道循环将完成（不会因错误而中断或退出），否则它将指向循环引用的最后一个元素。

### 获取和删除它

我们还可以通过删除并返回最后一个元素来改变我们的原始列表：

```
>>> a_list.pop(-1)
'three'
>>> a_list
['zero', 'one', 'two'] 
```

但是现在原始列表被修改了。

（`-1`实际上是默认参数，因此`list.pop`可以在没有索引参数的情况下使用）：

```
>>> a_list.pop()
'two' 
```

仅在以下情况下执行此操作

*   您知道列表中有元素，或者如果它为空，则准备处理异常，并且
*   您确实打算从列表中删除最后一个元素，将其视为堆栈。

这些是有效的用例，但不是很常见。

### 将其余部分保存以备后用：

我不知道你为什么要这样做，但为了完整起见，由于`reversed`返回一个***迭代器***（它支持迭代器协议），你可以将其结果传递给`next`：

```
>>> next(reversed([1,2,3]))
3 
```

所以这就像做这个的相反：

```
>>> next(iter([1,2,3]))
1 
```

但是我想不出这样做的充分理由，除非您稍后需要反向迭代器的其余部分，它可能看起来更像这样：

```
reverse_iterator = reversed([1,2,3])
last_element = next(reverse_iterator)

use_later = list(reverse_iterator) 
```

现在：

```
>>> use_later
[2, 1]
>>> last_element
3 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2019-04-13T04:11:25.950

要防止`IndexError: list index out of range`，请使用以下语法：

```
mylist = [1, 2, 3, 4]

# With None as default value:
value = mylist and mylist[-1]

# With specified default value (option 1):
value = mylist and mylist[-1] or 'default'

# With specified default value (option 2):
value = mylist[-1] if mylist else 'default' 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2018-08-01T01:57:38.350

`lst[-1]`是最好的方法，但是对于一般的迭代，请考虑[`more_itertools.last`](https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.last)：

**代码**

```
import more_itertools as mit

mit.last([0, 1, 2, 3])
# 3

mit.last(iter([1, 2, 3]))
# 3

mit.last([], "some default")
# 'some default' 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2016-01-10T12:32:06.260

另一种方法：

```
some_list.reverse() 
some_list[0] 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2016-10-07T02:21:23.373

`list[-1]`将检索列表的最后一个元素而不更改列表。 `list.pop()`将检索列表的最后一个元素，但它会改变/更改原始列表。通常，不建议更改原始列表。

或者，如果由于某种原因，您正在寻找不那么 Python 的东西，您可以使用`list[len(list)-1]`，假设列表不为空。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2017-06-02T13:23:40.440

如果您不想在列表为空时获取 IndexError，也可以使用下面的代码。

```
next(reversed(some_list), None) 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2020-07-03T05:47:43.673

这是您查询的解决方案。

```
a=["first","second from last","last"] # A sample list
print(a[0]) #prints the first item in the list because the index of the list always starts from 0.
print(a[-1]) #prints the last item in the list.
print(a[-2]) #prints the last second item in the list. 
```

输出：

```
>>> first
>>> last
>>> second from last 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2015-10-07T17:22:04.353

好的，但是几乎所有语言的通用方式`items[len(items) - 1]`呢？这是 IMO 获取最后一个元素的最简单方法，因为它不需要任何*Python*知识。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2021-05-09T19:03:25.733

# 蟒蛇方式

所以让我们考虑一下我们有一个 list `a = [1,2,3,4]`，在 Python 中 List 可以被操纵来给我们它的一部分或它的一个元素，使用下面的命令可以很容易地得到最后一个元素。

```
print(a[-1]) 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2021-10-19T07:27:59.780

奇怪的是还没有人发布这个：

```
>>> l = [1, 2, 3]
>>> *x, last_elem = l
>>> last_elem
3
>>> 
```

解包就行了。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-06-04T04:15:28.797

在 Python 中访问列表中的最后一个元素：

**1：使用负索引访问最后一个元素 -1**

```
>> data = ['s','t','a','c','k','o','v','e','r','f','l','o','w']
>> data[-1]
'w' 
```

**2\. 使用 pop() 方法访问最后一个元素**

```
>> data = ['s','t','a','c','k','o','v','e','r','f','l','o','w']
>> data.pop()
'w' 
```

但是，pop 方法将从列表中删除最后一个元素。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-03-23T05:28:04.037

为避免“IndexError: list index out of range”，您可以使用这段代码。

```
list_values = [12, 112, 443]

def getLastElement(lst):
    if len(lst) == 0:
        return 0
    else:
        return lst[-1]

print(getLastElement(list_values)) 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-05-07T15:35:40.683

您只需要获取并放置 [-1] 索引。例如：

```
list=[0,1,2]
last_index=list[-1]
print(last_index) 
```

您将得到 2 作为输出。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-12-26T17:51:32.950

如果这样做`my_list[-1]`，则返回列表的最后一个元素。负序列索引表示从数组末尾开始的位置。负索引表示从末尾开始，-1 指最后一项，-2 指倒数第二项，依此类推。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-06-23T17:18:13.303

找不到任何提到这一点的答案。所以补充。

你也可以试试`some_list[~0]`。

那是**波浪**号

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-09-12T02:07:02.010

您可以将其与`next`和`iter`一起使用`[::-1]`：

```
>>> a = [1, 2, 3]
>>> next(iter(a[::-1]))
3
>>> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-11-04T22:04:59.470

您还可以使用长度来获取最后一个元素：

```
last_elem = arr[len(arr) - 1] 
```

如果列表为空，您将收到`IndexError`异常，但您也可以使用`arr[-1]`.

# android - Android：有效地滚动画布的内容？

> ID：930402
> 
> 赞同：5
> 
> 时间：2009-05-30T19:31:52.740
> 
> 标签：android, canvas

我想绘制一个实时更新的图表（从右边开始）。我能想到的最有效的方法是将 x[0 .. width-2] 中的所有内容复制 1 个像素，然后在 x[width-1] 处绘制新值。

我对 Android 几乎没有经验，但据我所知，Canvas 根本无法对其内容进行操作。我每次都需要重新绘制整个屏幕吗？这涉及缩放和平滑，所以我担心它会很慢。

我应该画一个 byte[][] 然后用它来画到屏幕上（每次都把我的缓冲区的内容向左移动）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T07:58:06.157

Regarding performance, without profiling we cannot say.

It may be that line drawing is hardware accelerated on your target phone, and you should draw the graph from scratch using line-drawing primitives each frame.

On the other hand, the straightforward pixel manipulation of an image buffer would be:

Create an image that is the right size and clear it to a "`background_color`". This image needs to have setpixel() functionality.

Have an array of values that record the y of each x time, so for any column you know where you last plotted your graph.

Treat this "`chart_image`" and "`chart_array`" as a circular buffer. For each time step:

```
Y = ...;
X = time_since_start % chart_width;
chart_image.setpixel(X,chart_array[X],background_color); // clear previous line
chart_array[X] = Y;
chart_image.setpixel(X,chart_array[X],foreground_color); // draw new plot 
```

And now you need to blit it. You need to blit the image twice:

```
X = time_since_start % chart_width;
// the newest data is on the left of the chart_image but gets drawn on the right side of the output
blit(out_x+X,out_y, // destination coordinates
    chart_image,
    0,0, // top left of part of chart_image to blit
    X,chart_height); // bottom right of chart_image part
// the oldest data is on the right of the chart_image but gets drawn on the left side of the output
blit(out_x,out_y,
    chart_image,
    X,0,
    chart_width,chart_height); 
```

Things get more tricky if you want to use lines rather than individual pixels, but a `drawline()` instead of a `setpixel()` can make that work with this approach too.

(Apologies for not knowing the Android APIs; but the approach is generic.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T02:07:18.053

如果您的图表是有界的，请尝试将其全部渲染一次到一个图像，然后将该图像的相关部分blit到您的画布上。尽量避免实际“移动”缓冲区中的像素，因为这可能会在您的读取和写入之间引入依赖关系，并且可能会真正降低性能。实际上，从一个缓冲区复制到另一个缓冲区并交替将哪个缓冲区传送到屏幕上可能会更好。最后，如果您最终不得不手动处理像素，请确保您以行而不是列在图像上运行，并且从行的开头开始以帮助缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T12:13:15.930

只是一个想法，您可能已经考虑过，但我不会改变缓冲区的内容 - 我只是尝试像循环缓冲区一样使用它。保留当前列的索引，一旦您再次绕到最左侧的列，您可以分两段绘制到目标 - 当前列右侧的内容和左侧的内容，包括最近填充的列。这样您就不必四处移动任何东西，并且每次屏幕刷新只是两个段的两个 blit（位图副本）。如果那一点太慢了，您仍然可以始终将它们绘制到第二个屏幕外缓冲区中，然后一次将整个内容传输到屏幕上。当然，屏幕上的一个大块相当快，不是吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-03T19:02:55.723

由于我可以理所当然地将图形数据存储在内存中，因此重绘它应该不是问题。每帧重绘一组点一点也不费力。移动内存将是密集的，它移动所有东西而不是只绘制你需要的东西。最坏的情况，因为它是时间的函数，显示器的每列只有一个值，系统必须绘制的横向大约 800 像素/值。这是微不足道的。你有没有介绍过这个？编辑：记住，不是系统必须绘制每个点，它只绘制内存，然后使用它的原语。不要认为它重复绘制点，转储到视频内存，然后再一次。

# c# - 为了学习正确的编程概念，我应该开发什么样的应用程序

> ID：930406
> 
> 赞同：4
> 
> 时间：2009-05-30T19:34:39.020
> 
> 标签：c#, sql

我是一名 ERP 程序员，主要使用 MS SQL 和某种脚本编程语言。

我还用 C# 编写了一些简单的项目（我们公司的一个 Web 应用程序和一个简单的 Windows 服务），我非常喜欢它，所以我的下一份工作有望在 .NET 环境中进行。

现在我正在从一本 Wrox 书中学习 C#，并且我阅读了所有基础章节。这一切都很好，但在我看来，学习一门语言的更好方法是通过一个真实的项目。所以我的问题是：我应该写什么样的应用程序，这样我才能使用所有花哨的概念，比如继承、委托、泛型、反射、LINQ……如果它也连接到 SQL Server 那就太好了.

我想到了个人费用管理系统或调度系统。还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T19:39:15.767

此类项目中的第一条规则：**它必须是有趣的东西，或者你希望从中获利的东西。**

当我和你在同一个地方时（我的意思是同一个...C#...WROX 书...），我选择了基于文本的冒险游戏引擎。
它有你上面描述的一切，更重要的是我写得很开心，后来看到人们玩它。

所以，你选择什么并不重要，只要你喜欢它（而且它的范围足够大）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T19:44:07.957

任何设计良好的应用程序都可以使用任何或所有这些概念。特定语言的书籍倾向于只关注语言细节（有充分的理由）并且通常忽略基本的设计原则。另一个重要的一点是委托、泛型、反射等都有它们的位置，但它们不应该仅仅“因为”而在应用程序中实现。这可能会导致不必要的复杂性。

综上所述，选择一个你感兴趣的项目。更好的是，你真正想要使用的东西。然后，在编写代码之前，请考虑如何构建应用程序，以便以后轻松修改和添加功能。如果您将所有代码都放在表单/代码隐藏页面中，那么您可能做错了什么。

花一些时间学习[设计模式](http://en.wikipedia.org/wiki/Design_pattern_(computer_science))。这些是随着时间的推移组织代码的“最佳实践”。无需重新发明轮子。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T06:46:43.453

搔自己的痒痒...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T19:38:58.000

我会选择某种简单的 CRUD 应用程序，这将锻炼您的数据库技能（并让您有机会针对您的数据库使用 LINQ 提供程序），但可能不太简单；即不止一张桌子。

一个给定的问题没有任何东西可以从本质上使它更好地学习。坚持一个您可以轻松设计和建模的领域可能是一个好主意，以消除挑战中的那个方面。您可能会考虑做一些“更多”的事情，而不仅仅是数据访问操作；也许涉及图形或其他数据处理的东西会给你一个学习其他 API 的机会。

您的建议（费用管理、调度程序）对我来说似乎相当不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T19:50:02.703

如果你想尝试所有那些“花哨的概念”，最好做一个完全不反映你在工作中可能做的任何事情的项目。例如写一个游戏。如果您创建了一个小型 CRUD 应用程序，但以某种方式设法使用继承、泛型、委托等，那么您的程序很可能比应有的复杂得多。下次你在工作中做类似的事情时，你可能会想以同样的方式去做。这将是一个真正的坏主意。（KISS 原则）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T23:44:09.970

感谢所有答案，在您的启发下，我为我的项目找到了主题:-)

它是妓院的 IS。我们保留了我们的客户、妓女、房间、可用服务、工作经历、价格、...

现在我在 SQL 中创建了所有表（带有主键、外键和索引），下一步是什么？我应该为 SQL 中的每个表在 C# 中创建它自己的类，然后向它添加方法吗？然后继续从这个基础构建我的程序？还是我应该使用另一种方法...？

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T19:42:44.137

使用一些基本的 CRUD 应用程序 - 视频管理系统、学生注册系统、宠物店库存系统等...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T20:00:18.843

您总是可以查看使用 C# 的开源项目...通常，它们有很多您想研究的不同概念...

-JFV

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T20:26:51.710

你可以编写一个支持冒险风格游戏的引擎——没什么花哨的，但我发现它是一个很好的初学者项目，因为你最终可以使用大量的 OO。你也可以制作一个基本的媒体播放器，虽然我看不出这对于降低语言的基础非常好。您甚至可以获取 XNA 框架并尝试编写一个简单的游戏！

# testing-strategies - 如何在 TDD 中管理构建时间

> ID：930407
> 
> 赞同：3
> 
> 时间：2009-05-30T19:35:55.680
> 
> 标签：testing-strategies

嗨，在我的项目中，我们有数百个测试用例。这些测试用例是构建过程的一部分，在每次签入时都会触发并将邮件发送到我们的开发人员组。这个项目相当大，已经有五年多了。
现在我们有这么多测试用例，构建需要一个多小时。有些测试用例的结构不正确，在重构它们之后，我能够大大减少运行时间，但是我们有数百个测试用例，并且一个一个地重构它们一个似乎有点太多了。
现在我运行一些测试用例（这需要很长时间才能执行）仅作为夜间构建的一部分，而不是作为每次签入的一部分。
我很好奇其他人是如何做到这一点的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T19:51:44.027

我相信他在“有效地使用遗留代码”中说，如果您的测试套件花费的时间超过几分钟，它将大大降低开发人员的速度，并且测试将开始被忽视。听起来你正在掉进那个陷阱。

您的测试用例是否针对数据库运行？那么这很可能是您性能问题的最大来源。作为一般规则，如果可能的话，测试用例不应该进行 I/O。依赖注入可以让您用模拟代码的数据库部分的模拟对象替换数据库对象。这使您可以测试*代码*而不必担心数据库是否设置正确。

我强烈推荐Michael Feathers 的[《有效使用遗留代码》 。](https://rads.stackoverflow.com/amzn/click/com/0131177052)他讨论了如何处理您似乎遇到的许多令人头疼的问题，而无需一次全部重构代码。

更新：

另一个可能的帮助是 NDbUnit。我还没有广泛使用它，但它看起来很有希望：[http ://code.google.com/p/ndbunit/](http://code.google.com/p/ndbunit/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-07T11:50:22.517

也许您可以考虑保留您的 oracle 数据库但从内存驱动器运行它？它不需要很大，因为它只包含测试数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T08:08:47.203

我们有大约 1000 个测试，其中很大一部分通过 REST 通信并访问数据库。总运行时间约为 8 分钟。一个小时似乎太长了，但我不知道您在做什么以及您的测试有多复杂。

但我认为有一种方法可以帮助你。我们正在使用 TeamCity，它有一个很好的能力来拥有多个构建代理。您可以做的是将您的测试项目拆分为子项目，每个子项目仅包含一些测试。您可以使用 JNunit/NUnit 类别来分隔它们。然后，您将配置 TeamCity，以便每个代理只构建一种类型的子项目。这样，您将获得并行执行测试。使用很少的代理（您可以免费获得 3 个），您应该能够达到 20 分钟，这甚至是可以接受的。如果您将每个代理放入 VM，您甚至可能不需要额外的机器，您只需要大量 RAM。

# javascript - 当我单击此文本框时，它变大了，但是当我单击离开时，如何使其恢复正常？

> ID：930411
> 
> 赞同：0
> 
> 时间：2009-05-30T19:38:18.233
> 
> 标签：javascript, jquery, html, css

我基本上是在用 jquery 模仿 facebook 上的共享按钮功能，我想做的是当我点击文本框区域时，文本框的高度会变大。当我点击离开时，它应该恢复正常。使用最后一段 jquery 代码根本不起作用。我有什么选择让它发挥作用？谢谢。

ps：
我知道这大部分可以用css完成，但我正在尝试用jquery来更好地学习它。:)

这是我的jQuery。

```
$(function() {

  $('input[name=search]').click(function() {

    $(this).addClass('txthover');
  });

  $('body').click(function() {

      $('input[name=search]').removeClass('txthover');
  });

}); 
```

html

```
<div id="box">
<div id="search">
<input type="text" name="search" /><input type="button" name="btnsearch" value="search" />
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T19:40:24.750

正确的方法是使用元素的焦点和模糊事件：

```
$('input[name=search]').focus(function() {
    $(this).addClass('txthover');
}).blur(function() {
    $(this).removeClass('txthover');
}); 
```

[这是一个简单的例子。](http://jsbin.com/owate)

# c++ - 为 C++ 设置窗口

> ID：930416
> 
> 赞同：1
> 
> 时间：2009-05-30T19:40:05.343
> 
> 标签：c++, windows, ide, installation, environment

引用常见问题解答，“毫无疑问 [...] 太“新手”了”

设置 Windows 系统（vista，如果这很重要）以使用 C++ 的最佳方法是什么？

最好有一个不错的 IDE，易于编译的软件（支持 make 文件等），但适合初学者。

我非常希望 IDE 使用相对可移植的格式，例如 makefile 和配置脚本，不要太专有。

我还希望能够轻松添加新库等，并使用其他人编写的大多数 C++ 代码。

我很喜欢使用命令行。

感谢您的帮助，希望问题很清楚。如果它已经得到回答，我深表歉意，我确实看过类似的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T19:59:23.900

我知道这并不完全是“专有的”，但您应该看看[Visual C++ 的免费 Express Edition](http://www.microsoft.com/Express/vc/)。在它的覆盖下，您将获得所有熟悉的 make 和命令行工具，但包装在一个精致的 IDE 中。

如果您对命令行真的很满意，那么您可以在编译器/调试器套件之上从代码编辑器制作一个 IDE。MS 自己的命令行工具随[平台 SDK （免费）一起提供，您可以在](http://www.microsoft.com/downloads/details.aspx?FamilyID=e6e1c3df-a74f-4207-8586-711ebe331cdc&displaylang=en)[Windbg](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)中获得一个很棒的调试器。我个人最喜欢的代码编辑器是[Code Insight](http://www.sourceinsight.com/)。我非常希望有一个 Mac 版本 /sigh。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T19:51:34.150

Microsoft 的[Visual Studio](http://www.microsoft.com/Express/)有一个免费的速成版，其中包含了编写 c++ 所需的几乎所有内容。
对于 Gui，主要选择可能是 MFC（旧且丑陋）、CLR/.Net（新且令人困惑）或查看 Qt（现为 LGPL）或 wxWigets

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T19:49:16.013

在 Windows 上有很多不错的 C++ IDE。

专业软件开发的事实标准是[Microsoft 的 Visual Studio](http://www.microsoft.com/visualstudio/)，它有不同的版本，例如免费的[Express Editions](http://www.microsoft.com/Express/)。这将为您提供一个出色的 Windows 开发工具链。

但是，对于更“跨平台”的方法，您应该看看免费的[Eclipse C++ Development Tooling](http://www.eclipse.org/cdt/)，它可用于许多平台。只要你自己的代码是平台无关的，整个项目可以在Windows、Linux、Mac等之间共享。

其他替代方案是[MinGW](http://www.mingw.org/)或[CygWin](http://www.cygwin.com/)，它们都允许在 Windows 上使用[GCC工具链。](http://gcc.gnu.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T19:50:02.297

试试[MinGW 编译器](http://www.mingw.org)，它会附带一个 C 和 C++ 编译器、Make 等——等等。这可以很容易地从命令行使用：`g++ -o someprogram.exe somecode.cpp`

至于IDE，那里有很多。现在我正在使用[Code::Blocks](http://www.codeblocks.org)，到目前为止它真的很好。同样，它已经支持 GCC 编译器，并为您设置了许多适当的标志，所以您真正需要做的就是点击“构建”按钮。

您可能想尝试的其他一些工具是 Eclipse，它确实非常强大，但是在您开始习惯之前，它的许多“功能”将非常令人困惑且难以使用。Visual C++ 是另一种，它（显然）可以很好地集成到 Windows 中。当然，你总是可以使用 emacs :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T22:52:41.023

我建议您评估[CodeBlocks](http://www.codeblocks.org/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T19:50:01.847

Microsoft 的 Visual Studio 功能强大但相当专有。如果你更喜欢开放/便携的东西，我推荐[Dev-C++](http://www.bloodshed.net/devcpp.html)和[Cygwin](http://www.cygwin.com/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T21:04:41.507

FWIW，我最近经历了这个并尝试了基于 VC++ Express 和 QT Creator 的东西。来自 linux/unix 背景，我发现 QT 稍微好一点，因为它使用了 Ming 编译器和一些基于 make 的结构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T21:24:00.377

如果您只为 Windows 进行黑客攻击，我会选择 Visual Studio。它肯定会节省您可以花在编码上的时间。大多数适用于 Windows 的开源项目都已经有 VC 项目，如果没有，设置一个通常非常简单。通常他们有 make 或 nmake 文件供你构建 VC 兼容的库来链接。

# c# - 抽象与普通类继承性能

> ID：930418
> 
> 赞同：4
> 
> 时间：2009-05-30T19:40:57.730
> 
> 标签：c#, .net, performance, inheritance, class

当您从一个类派生并实例化子类时，运行时也会实例化超类，对吗？

既然抽象类不能被实例化，那么在子类被实例化时，它们不是由运行时创建的吗？

如果是这样，那么抽象类继承会比普通类实例更快吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T19:43:06.947

运行时从不创建基类和派生类的单独实例 - 只是派生类实例*还具有*基类的所有变量等，并作为初始化的一部分运行基类构造函数。“普通”基类和抽象基类之间没有区别。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T19:44:31.840

我认为您对某些细节感到困惑。

当您构造一个对象时，该对象的类继承自另一个类，这不像您在内存中获得两个对象。

你只得到一个，但它为来自两者的字段留出了空间。

换句话说，如果原始类需要 10 个字节来保存其字段，而您的继承类需要 5 个字节来保存其特定字段，那么当您从继承的类构造对象时，它将占用 15 个字节，其中前 10 个对应到基类的字段。（注意，这是一个非常简单的解释，还有很多事情决定了对象的实际大小）。

# .htaccess - .htaccess 问题

> ID：930420
> 
> 赞同：0
> 
> 时间：2009-05-30T19:41:39.897
> 
> 标签：.htaccess, mod-rewrite

我有一个使用 PHP 的登录脚本。登录和退出的变量是

log.php?do=in 和 log.php?do=out

如果可能，我想将其更改为登录/登录和注销/注销。

我现在真的很难理解 .htaccess 和重写 ^^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T19:46:28.263

试试这个：

```
RewriteEngine on
RewriteRule ^log/(in|out)$ log.php?do=$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T19:58:48.927

你想要的基本格式是（在[这个网站上](http://www.yourhtmlsource.com/sitemanagement/urlrewriting.html)找到的例子）

```
RewriteEngine on
RewriteRule ^old\.html$ new.html 
```

插入符号 ^ 表示当前目录下**URL 的开始。**美元符号表示要匹配**的字符串的结尾。**反斜杠是为了转义点，这是一个特殊字符。

您可能还想查看一些[mod_rewrite 教程](http://www.blogstorm.co.uk/htaccess-mod_rewrite-ultimate-guide/)，如果您环顾四周，就会有一些写得很好的教程。

# php - 通过 FTP 添加新文件时运行 PHP 脚本

> ID：930421
> 
> 赞同：4
> 
> 时间：2009-05-30T19:42:16.823
> 
> 标签：php, linux, ftp

我有多个相机通过 FTP 以随机间隔将图像发送到预定文件夹。

例如：
recordings/camera1/images/ - 用于第一台摄像机
records/camera2/images/ - 用于第二台摄像机
等

他们每个人都以 .jpg 格式保存图像，然后关闭 FTP 连接。

每次添加新文件后，我都需要调用 PHP 脚本。假设每当将新图像添加到 /recordings 文件夹中时，我都需要调用 php 脚本

```
newimage.php?location=recordings/camera1/images/picture002.jpg 
```

等等。

服务器是一个运行 ProFTPD 的 Linux 机器

我怎样才能做到这一点？

请注意：Cron 作业不是一个选项，因为会有数千个文件，而且我们没有使用数据库。所以我们无法找出是否有任何新文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T19:57:01.770

我建议你看看 ProFTPD 的[mod_exec](http://www.castaglia.org/proftpd/modules/mod_exec.html)。这是解释其目标的引述：

> mod_exec 模块可用于在处理 FTP 命令的过程中的各个点执行外部程序或脚本。通过有意识的设计，ProFTPD 不会也不会执行外部程序。这是一个安全决定，因为决定不允许 ProFTPD 作为破坏系统或通过外部程序或脚本中的错误披露信息的手段。使用此模块允许执行此类外部程序，并且还向服务器开放了通过这些程序进行妥协或泄露的上述可能性。

您还可以查看[inotify](http://www.ibm.com/developerworks/linux/library/l-inotify.html)，它可以让您监控系统文件活动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-05T14:12:32.653

您应该[`fam_monitor_directory`](http://php.net/manual/en/function.fam-monitor-directory.php)在 PHP 中使用函数（如果它是使用 编译的`--with-fam`）。它完全符合您的需要，即每当目录的内容更改时执行一个 PHP 程序。

在你的 cronjob 中使用这样的东西（不管目录中有多少文件，目录中的每次*更改*循环都会进行一次：

```
/* opens a connection to the FAM service daemon */
$fam_res = fam_open ();

/* The second argument is the full pathname of the directory to monitor. */
$nres = fam_monitor_directory ( $fam_res, '/home/www/example.com/cameras/');

while( fam_pending ( $fam_res ) ) {
    $arr = (fam_next_event($fam_res)) ;
    if ($arr['code']) == FAMCreated ) {
        /* deal here with the new file, which name now is stored in $arr['filename'] */
    }  
}

fam_close($fam_res); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T19:46:11.400

我会做一个每 5 或 10 分钟查找新文件的 cronjob。`wget`然后为找到的任何新图像调用 PHP 脚本。

**更新：**看来您需要以某种方式连接到 ProFTPD。也许[mod_exec](http://www.castaglia.org/proftpd/modules/mod_exec.html)可以提供帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T19:56:23.253

您应该能够在 Linux 上使用 inotify 来执行此操作。有一个 PECL 模块允许 PHP 接收 inotify 事件。文档在[这里](http://us3.php.net/manual/en/book.inotify.php)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-22T19:29:53.010

还有另一种方式。

mod_exec 打开您的 FTP 服务器以解决安全问题。读取日志文件有时会导致您的服务器无法写入日志文件等。

尝试启用 mod_mysql。然后启用对数据库表的日志记录，这样您就可以扫描您的 MySQL 表以进行更改。[尝试使用 MySQL 和 proFTPd http://www.iezzi.ch/archives/110](http://www.iezzi.ch/archives/110)搜索日志记录

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-13T14:31:47.267

如果您在 linux 下，只需执行此代码

```
inotifywait -m /path/to/folder -e create -e moved_to |
while read path action file; do
    echo "The file '$file' appeared in directory '$path' via '$action'"
    # do something with the file for example
    php index.php upload '$path/$file'
done 
```

# android - 作为开发人员，什么是最好的安卓手机

> ID：930424
> 
> 赞同：15
> 
> 时间：2009-05-30T19:43:05.197
> 
> 标签：android

我知道你可以买到开发者手机，但新 G2 看起来很不错，三星也近在咫尺。但是，我认为如果消费者手机是您希望制作的应用程序的目标市场，尤其是用于测试目的，那么使用消费者手机会是一个更好的主意。

有没有其他人有过这种选择的经验并为这个问题提供任何进一步的启示？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-01T15:22:44.683

G1。它是唯一一款带有硬键盘的手机。打开键盘后，您将获得几个事件/活动重新启动，这些事件/活动不会在仅触摸屏的手机上发生。如果您正在开发应用程序，那么您获得的是开发版还是零售版并不重要。

展望未来，随着硬件的不同，您可能需要购买几部手机。例如，三星有一个 5way 而不是轨迹球。根据您使用轨迹球的方式，这可能会有很大的不同。

但就外观而言，获得三星。这是迄今为止我见过的最好看的安卓手机。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T20:38:39.750

如果您只是构建消费者应用程序，那没关系。它们都具有调试功能。如果您在操作系统上进行黑客攻击，开发人员电话通常是有益的，因为它没有被运营商锁定。

我已经使用 G1 几个月了，没有任何问题。如果您想要更好的相机并且不介意缺少键盘，那么 Magic/Sapphire/myTouch/G2/whatever-theyre-call-it-now 会很好，否则它们是相同的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-03T15:43:00.290

您需要获取 ADP2 设备。Google 在 2009 年的 Google IO 上提供了一些产品，并将在开发者大会上提供更多产品，或者您可以等待它出现在 Adp 订单页面上时下订单。

性能方面，它是与 G1/Adp1 不同的硬件设备。

您需要一个 ADP 设备来进行完全调试，因为您需要完全的 root 访问权限才能进行完全调试，这确实很重要。不要被我面前的答案所迷惑，需要 ADP 设备！与 IDE 集成的设备调试桥需要 root 设备访问权限。

# mod-rewrite - Mod重写环境变量

> ID：930431
> 
> 赞同：1
> 
> 时间：2009-05-30T19:45:21.997
> 
> 标签：mod-rewrite

使用这个基本示例，我似乎无法让环境变量“接受”

```
SetEnv APPLICATION_ENV production
RewriteEngine On
RewriteCond %{ENV:APPLICATION_ENV} =production 
RewriteRule ^loading$ /images/loading.gif [NC,L] 
```

出于某种原因去

```
/loading 
```

不显示 loading.gif

我使用语法 ^production 尝试了许多比较排列，但没有任何效果

我知道只需删除 RewriteCond 即可使其正常工作，但这个问题是关于使用环境变量进行正确比较

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T19:51:43.013

您还需要使用 mod_rewrite 设置环境变量：

```
RewriteRule ^ - [E=APPLICATION_ENV:production] 
```

# c# - 自动将一个对象的属性值应用于另一个相同类型的对象？

> ID：930433
> 
> 赞同：91
> 
> 时间：2009-05-30T19:46:03.507
> 
> 标签：c#, linq-to-sql

给定类型为 T 的 2 个对象 A 和 B，我想将 A 中的属性值分配给 B 中的相同属性，而无需为每个属性进行显式分配。

我想保存这样的代码：

```
b.Nombre = a.Nombre;
b.Descripcion = a.Descripcion;
b.Imagen = a.Imagen;
b.Activo = a.Activo; 
```

做类似的事情

```
a.ApplyProperties(b); 
```

可能吗？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-01-04T08:47:51.540

因为我认为 Jon 的版本太复杂了，而 Steve 的版本太简单了，而且我喜欢 Daniel 的扩展类的想法。

加上通用版本很漂亮，但没有必要，因为所有项目都是对象。

我想自愿提供我精益和卑鄙的版本。归功于以上所有内容。:D

**代码：**

```
using System;
using System.Reflection;
/// <summary>
/// A static class for reflection type functions
/// </summary>
public static class Reflection
{
    /// <summary>
    /// Extension for 'Object' that copies the properties to a destination object.
    /// </summary>
    /// <param name="source">The source.</param>
    /// <param name="destination">The destination.</param>
    public static void CopyProperties(this object source, object destination)
    {
        // If any this null throw an exception
        if (source == null || destination == null)
            throw new Exception("Source or/and Destination Objects are null");
            // Getting the Types of the objects
        Type typeDest = destination.GetType();
        Type typeSrc = source.GetType();

        // Iterate the Properties of the source instance and  
        // populate them from their desination counterparts  
        PropertyInfo[] srcProps = typeSrc.GetProperties();
        foreach (PropertyInfo srcProp in srcProps)
        {
            if (!srcProp.CanRead)
            {
                continue;
            }
            PropertyInfo targetProperty = typeDest.GetProperty(srcProp.Name);
            if (targetProperty == null)
            {
                continue;
            }
            if (!targetProperty.CanWrite)
            {
                continue;
            }
            if (targetProperty.GetSetMethod(true) != null && targetProperty.GetSetMethod(true).IsPrivate)
            {
                continue;
            }
            if ((targetProperty.GetSetMethod().Attributes & MethodAttributes.Static) != 0)
            {
                continue;
            }
            if (!targetProperty.PropertyType.IsAssignableFrom(srcProp.PropertyType))
            {
                continue;
            }
            // Passed all tests, lets set the value
            targetProperty.SetValue(destination, srcProp.GetValue(source, null), null);
        }
    }
} 
```

**用法：**

```
/// <summary>
/// ExampleCopyObject
/// </summary>
/// <returns></returns>
public object ExampleCopyObject()
{
    object destObject = new object();
    this.CopyProperties(destObject); // inside a class you want to copy from

    Reflection.CopyProperties(this, destObject); // Same as above but directly calling the function

    TestClass srcClass = new TestClass();
    TestStruct destStruct = new TestStruct();
    srcClass.CopyProperties(destStruct); // using the extension directly on a object

    Reflection.CopyProperties(srcClass, destObject); // Same as above but directly calling the function

    //so on and so forth.... your imagination is the limits :D
    return srcClass;
}

public class TestClass
{
    public string Blah { get; set; }
}
public struct TestStruct
{
    public string Blah { get; set; }
} 
```

因为我很无聊，评论建议了一个 linq 版本

```
using System;
using System.Linq;
using System.Reflection;
/// <summary>
/// A static class for reflection type functions
/// </summary>
public static class Reflection
{
    /// <summary>
    /// Extension for 'Object' that copies the properties to a destination object.
    /// </summary>
    /// <param name="source">The source.</param>
    /// <param name="destination">The destination.</param>
    public static void CopyProperties(this object source, object destination)
    {
        // If any this null throw an exception
        if (source == null || destination == null)
            throw new Exception("Source or/and Destination Objects are null");
        // Getting the Types of the objects
        Type typeDest = destination.GetType();
        Type typeSrc = source.GetType();
        // Collect all the valid properties to map
        var results = from srcProp in typeSrc.GetProperties()
                                    let targetProperty = typeDest.GetProperty(srcProp.Name)
                                    where srcProp.CanRead
                                    && targetProperty != null
                                    && (targetProperty.GetSetMethod(true) != null && !targetProperty.GetSetMethod(true).IsPrivate)
                                    && (targetProperty.GetSetMethod().Attributes & MethodAttributes.Static) == 0
                                    && targetProperty.PropertyType.IsAssignableFrom(srcProp.PropertyType)
                                    select new { sourceProperty = srcProp, targetProperty = targetProperty };
        //map the properties
        foreach (var props in results)
        {
            props.targetProperty.SetValue(destination, props.sourceProperty.GetValue(source, null), null);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-05-30T20:57:19.870

我有一个[`MiscUtil`](http://pobox.com/~skeet/csharp/miscutil)被调用的类型，`PropertyCopy`它做类似的事情——尽管它创建了一个目标类型的新实例并将属性复制到其中。

它不需要类型相同 - 它只是将所有可读属性从“源”类型复制到“目标”类型。当然，如果类型相同，那更有可能起作用:) 这是一个浅拷贝，顺便说一句。

在此答案底部的代码块中，我扩展了该类的功能。要从一个实例复制到另一个实例，它`PropertyInfo`在执行时使用简单的值——这比使用表达式树要慢，但另一种方法是编写一个动态方法，我不太喜欢这个方法。如果性能对您来说绝对至关重要，请告诉我，我会看看我能做些什么。要使用该方法，请编写如下内容：

```
MyType instance1 = new MyType();
// Do stuff
MyType instance2 = new MyType();
// Do stuff

PropertyCopy.Copy(instance1, instance2); 
```

（其中`Copy`是使用类型推断调用的通用方法）。

我还没有准备好发布完整的 MiscUtil，但这里是更新的代码，包括注释。我不会为 SO 编辑器重新包装它们 - 只需复制整个块。

（如果我从头开始，我可能还会在命名方面重新设计 API，但我不想破坏现有用户......）

```
#if DOTNET35
using System;
using System.Collections.Generic;
using System.Linq.Expressions;
using System.Reflection;

namespace MiscUtil.Reflection
{
    /// <summary>
    /// Non-generic class allowing properties to be copied from one instance
    /// to another existing instance of a potentially different type.
    /// </summary>
    public static class PropertyCopy
    {
        /// <summary>
        /// Copies all public, readable properties from the source object to the
        /// target. The target type does not have to have a parameterless constructor,
        /// as no new instance needs to be created.
        /// </summary>
        /// <remarks>Only the properties of the source and target types themselves
        /// are taken into account, regardless of the actual types of the arguments.</remarks>
        /// <typeparam name="TSource">Type of the source</typeparam>
        /// <typeparam name="TTarget">Type of the target</typeparam>
        /// <param name="source">Source to copy properties from</param>
        /// <param name="target">Target to copy properties to</param>
        public static void Copy<TSource, TTarget>(TSource source, TTarget target)
            where TSource : class
            where TTarget : class
        {
            PropertyCopier<TSource, TTarget>.Copy(source, target);
        }
    }

    /// <summary>
    /// Generic class which copies to its target type from a source
    /// type specified in the Copy method. The types are specified
    /// separately to take advantage of type inference on generic
    /// method arguments.
    /// </summary>
    public static class PropertyCopy<TTarget> where TTarget : class, new()
    {
        /// <summary>
        /// Copies all readable properties from the source to a new instance
        /// of TTarget.
        /// </summary>
        public static TTarget CopyFrom<TSource>(TSource source) where TSource : class
        {
            return PropertyCopier<TSource, TTarget>.Copy(source);
        }
    }

    /// <summary>
    /// Static class to efficiently store the compiled delegate which can
    /// do the copying. We need a bit of work to ensure that exceptions are
    /// appropriately propagated, as the exception is generated at type initialization
    /// time, but we wish it to be thrown as an ArgumentException.
    /// Note that this type we do not have a constructor constraint on TTarget, because
    /// we only use the constructor when we use the form which creates a new instance.
    /// </summary>
    internal static class PropertyCopier<TSource, TTarget>
    {
        /// <summary>
        /// Delegate to create a new instance of the target type given an instance of the
        /// source type. This is a single delegate from an expression tree.
        /// </summary>
        private static readonly Func<TSource, TTarget> creator;

        /// <summary>
        /// List of properties to grab values from. The corresponding targetProperties 
        /// list contains the same properties in the target type. Unfortunately we can't
        /// use expression trees to do this, because we basically need a sequence of statements.
        /// We could build a DynamicMethod, but that's significantly more work :) Please mail
        /// me if you really need this...
        /// </summary>
        private static readonly List<PropertyInfo> sourceProperties = new List<PropertyInfo>();
        private static readonly List<PropertyInfo> targetProperties = new List<PropertyInfo>();
        private static readonly Exception initializationException;

        internal static TTarget Copy(TSource source)
        {
            if (initializationException != null)
            {
                throw initializationException;
            }
            if (source == null)
            {
                throw new ArgumentNullException("source");
            }
            return creator(source);
        }

        internal static void Copy(TSource source, TTarget target)
        {
            if (initializationException != null)
            {
                throw initializationException;
            }
            if (source == null)
            {
                throw new ArgumentNullException("source");
            }
            for (int i = 0; i < sourceProperties.Count; i++)
            {
                targetProperties[i].SetValue(target, sourceProperties[i].GetValue(source, null), null);
            }

        }

        static PropertyCopier()
        {
            try
            {
                creator = BuildCreator();
                initializationException = null;
            }
            catch (Exception e)
            {
                creator = null;
                initializationException = e;
            }
        }

        private static Func<TSource, TTarget> BuildCreator()
        {
            ParameterExpression sourceParameter = Expression.Parameter(typeof(TSource), "source");
            var bindings = new List<MemberBinding>();
            foreach (PropertyInfo sourceProperty in typeof(TSource).GetProperties(BindingFlags.Public | BindingFlags.Instance))
            {
                if (!sourceProperty.CanRead)
                {
                    continue;
                }
                PropertyInfo targetProperty = typeof(TTarget).GetProperty(sourceProperty.Name);
                if (targetProperty == null)
                {
                    throw new ArgumentException("Property " + sourceProperty.Name + " is not present and accessible in " + typeof(TTarget).FullName);
                }
                if (!targetProperty.CanWrite)
                {
                    throw new ArgumentException("Property " + sourceProperty.Name + " is not writable in " + typeof(TTarget).FullName);
                }
                if ((targetProperty.GetSetMethod().Attributes & MethodAttributes.Static) != 0)
                {
                    throw new ArgumentException("Property " + sourceProperty.Name + " is static in " + typeof(TTarget).FullName);
                }
                if (!targetProperty.PropertyType.IsAssignableFrom(sourceProperty.PropertyType))
                {
                    throw new ArgumentException("Property " + sourceProperty.Name + " has an incompatible type in " + typeof(TTarget).FullName);
                }
                bindings.Add(Expression.Bind(targetProperty, Expression.Property(sourceParameter, sourceProperty)));
                sourceProperties.Add(sourceProperty);
                targetProperties.Add(targetProperty);
            }
            Expression initializer = Expression.MemberInit(Expression.New(typeof(TTarget)), bindings);
            return Expression.Lambda<Func<TSource, TTarget>>(initializer, sourceParameter).Compile();
        }
    }
}
#endif 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2015-11-19T20:44:16.960

这是一个简短而甜蜜的版本，因为您说您的两个对象都属于同一类型：

```
foreach (PropertyInfo property in typeof(YourType).GetProperties().Where(p => p.CanWrite))
{
    property.SetValue(targetObject, property.GetValue(sourceObject, null), null);
} 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2011-08-31T20:13:59.633

在史蒂夫的方法的基础上，我采用了扩展方法。这使用我的基类作为类型，但即使使用对象作为参数类型也应该可用。非常适合我的使用。

```
using System.Reflection;
//*Namespace Here*
public static class Ext
{
    public static void CopyProperties(this EntityBase source, EntityBase destination)
    {
        // Iterate the Properties of the destination instance and  
        // populate them from their source counterparts  
        PropertyInfo[] destinationProperties = destination.GetType().GetProperties(); 
        foreach (PropertyInfo destinationPi in destinationProperties)
        {
            PropertyInfo sourcePi = source.GetType().GetProperty(destinationPi.Name);     
            destinationPi.SetValue(destination, sourcePi.GetValue(source, null), null);
        } 
    }
} 
```

用法如下所示：

```
item1.CopyProperties(item2); 
```

现在 Item2 具有与 item1 相同的属性数据。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-03-03T15:35:50.740

修改丹尼尔版本以避免异常。

```
foreach (PropertyInfo property in typeof(YourType).GetProperties())
{
  if (property.CanWrite)
  {
    property.SetValue(marketData, property.GetValue(market, null), null);
  }
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-09-22T08:52:22.357

This short and simple Extension method will allow you to copy matching properties from one object to another with the check of Null value and is writable.

```
public static void CopyPropertiesTo(this object fromObject, object toObject)
    {
        PropertyInfo[] toObjectProperties = toObject.GetType().GetProperties();
        foreach (PropertyInfo propTo in toObjectProperties)
        {
            PropertyInfo propFrom = fromObject.GetType().GetProperty(propTo.Name);
            if (propFrom!=null && propFrom.CanWrite)
                propTo.SetValue(toObject, propFrom.GetValue(fromObject, null), null);
        }
    } 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-11T17:48:06.983

基本上在 2019 年，我们可能应该使用更多最新的语言特性，比如表达式树和编译的 lambda 表达式，而不是反射

由于找不到符合我要求（最重要的是速度）的“浅层克隆器”，我决定自己创建一个。它枚举所有可获取/可设置的属性，然后创建一个`Block`表达式，然后编译和缓存。这使得它比流行的 AutoMapper 快了近 13 倍。用法很简单：

```
DestType destObject = PropMapper<SourceType, DestType>.From(srcObj); 
```

你可以在这里查看完整的源代码：[https ://github.com/jitbit/PropMapper](https://github.com/jitbit/PropMapper)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-30T20:42:53.253

您可以使用序列化来深度克隆对象：

```
public static T DeepClone<T>(this T objectToClone) where T: BaseClass
{
    BinaryFormatter bFormatter = new BinaryFormatter();
    MemoryStream stream = new MemoryStream();
    bFormatter.Serialize(stream, objectToClone);
    stream.Seek(0, SeekOrigin.Begin);
    T clonedObject = (T)bFormatter.Deserialize(stream);
    return clonedObject;
} 
```

当然，类只需要标记为可序列化。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-09-22T09:08:59.323

几年来，我一直在使用一个名为**ValueInjecter的流行库**

nuget：[https ://www.nuget.org/packages/ValueInjecter/](https://www.nuget.org/packages/ValueInjecter/)

github：[https ://github.com/omuleanu/ValueInjecter](https://github.com/omuleanu/ValueInjecter)

```
target.InjectFrom(source);
target.InjectFrom<Injection>(source);
target.InjectFrom(new Injection(parameters), source);
target.InjectFrom<Injection>(); // without source 
```

请注意，即使基本解决方案非常简单（请参阅其他答案），也有很多边缘情况（例如深拷贝、泛型、空值）和优化（例如缓存反射属性），因此最好使用维护的库。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-30T20:13:26.197

有[ICloneable](http://msdn.microsoft.com/en-us/library/system.icloneable.aspx)和[object.MemberwiseClone](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)（浅拷贝）（它们创建了一个全新的对象，因此可能不符合您的要求）。

您可以自己使用反射来完成（从基类继承，因此您不必重新实现）。

或者你可以代码生成它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-01T15:39:25.557

你可以试试这样的......

```
MyType destination = new MyType();
MyType source = new MyType();

// Iterate the Properties of the destination instance and 
// populate them from their source counterparts

PropertyInfo[] destinationProperties = destination.GetType().GetProperties();
foreach (PropertyInfo destinationPI in destinationProperties)
{
    PropertyInfo sourcePI = source.GetType().GetProperty(destinationPI.Name);

    destinationPI.SetValue(destination,
                           sourcePI.GetValue(source, null), 
                           null);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-04-26T20:04:51.723

也许这篇文章有点老了，答案很好，但是当您需要将大量对象映射到目标类型时 - 循环遍历属性可能会很昂贵（成像 100 个道具等等）。

我使用这个 AutoMapFactory 方法（只需要 LinQ），它只会在属性中迭代一次，并且每个对象的映射会很快（100000 道具/秒）

```
private Func<S,T> AutoMapFactory<S,T>() where T: class, new() where S : class
        {
            List<Action<T, S>> mapActions = typeof(T).GetProperties().Where(tp => tp.CanWrite)
                .SelectMany(tp => typeof(S).GetProperties().Where(sp => sp.CanRead)
                .Where(sp => sp.Name == tp.Name && tp.PropertyType.IsAssignableFrom(sp.PropertyType))
                .Select(sp => (Action<T,S>)((targetObj, sourceObj) => 
                    tp.SetValue(targetObj, sp.GetValue(sourceObj)))))
                .ToList();

            return sourceObj => {
                if (sourceObj == null) return null;

                T targetObj = new T();
                mapActions.ForEach(action => action(targetObj, sourceObj));
                return targetObj;
            };
        } 
```

如何使用这个：

```
...
var autoMapper = AutoMapFactory<SourceType, TargetType>(); //Get Only 1 instance of the mapping function
...
someCollection.Select(item => autoMapper(item)); //Almost instantaneous
... 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-30T20:28:47.213

如果你想要 ApplyProperties 之类的东西，你可以在 Object 上编写一个扩展方法来满足你的需要。只要意识到这样的扩展方法不会是“纯粹的”，或者没有副作用。但是，如果您需要该功能，则可以通过它来完成它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-27T10:51:15.983

我已经接受了@Shimmy Weitzhandler 上面写的所有内容并进行了轻微修改。因为当我必须定义多个具有相同属性的对象时使用此方法，所以我创建了一个接受可变数量元素的函数：

```
public static void CopyProperties<T>(T source, params T[] dests)
{
    if(source == null)
        return;

    foreach (var dest in dests)
    {
        foreach (System.Reflection.PropertyInfo property in typeof(Button).GetProperties().Where(p => p.CanWrite))
            property.SetValue(dest, property.GetValue(source, null), null);
    }
} 
```

有了它，您可以定义一个或多个元素。例如：

```
Helper.CopyProperties(btn_Src, bt_Dest1); 
```

或者

```
Helper.CopyProperties(btn_Src, bt_Dest1, btn_Dest2, btn_Dest3); 
```

我把它变成了静态的，因为我在我的 Helper 库中有它

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-13T15:10:14.057

扩展@Azerothians 的答案，我需要一些额外的要求：

1.  需要一种方法来忽略源对象上的空属性
2.  需要一种方法来忽略显式属性
3.  想要一种方法来强制数据类型尽可能匹配，例如 int？到十进制？或 long to int （由于前任的不幸的早期模式决策）
4.  想知道是否复制了属性（以确定是否需要更新数据库）

    ```
    /// <summary>
    /// Extension for 'Object' that copies the properties to a destination object.
    /// </summary>
    /// <param name="source">The source.</param>
    /// <param name="destination">The destination.</param>
    /// <param name="PropertiesToIgnore">an optional list of property names which will NOT be copied</param>
    /// <param name="IgnoreNullProperties">when true will not update properties where the source is null</param>
    /// <param name="CoerceDataType">when true, will attempt to coerce the source property to the destination property (e.g. int to decimal) </param>
    /// <param name="ThrowOnTypeMismatch">when true, will throw a InvalidCastException if the data cannot be coerced</param>
    /// <exception cref="InvalidCastException">if there is a data type mismatch between source/destination and ThrowOnTypeMismatch is enabled and unable to coerce the data type.</exception>
    /// <returns>true if any properties were changed</returns>
    public static bool CopyProperties(this object source, object destination, IEnumerable<string> PropertiesToIgnore = null, bool IgnoreNullProperties = false, bool ThrowOnTypeMismatch = true, bool CoerceDataType = true)
    {
        if (source is null)
            throw new ArgumentNullException(nameof(source));

        if (destination is null)
            throw new ArgumentNullException(nameof(destination));

        // Getting the Types of the objects
        Type typeDest = destination.GetType();
        Type typeSrc = source.GetType();

        // Collect all the valid properties to map
        var results = (from srcProp in typeSrc.GetProperties()
                       let targetProperty = typeDest.GetProperty(srcProp.Name)
                       where srcProp.CanRead
                       && targetProperty != null
                       && (targetProperty.GetSetMethod(true) != null && !targetProperty.GetSetMethod(true).IsPrivate)
                       && (targetProperty.GetSetMethod().Attributes & MethodAttributes.Static) == 0
                       && !(
                           from i in PropertiesToIgnore ?? Enumerable.Empty<string>()
                           select i
                         ).Contains(srcProp.Name)
                       && (!IgnoreNullProperties || srcProp.GetValue(source, null) != null)
                       select new { sourceProperty = srcProp, targetProperty = targetProperty }).ToList();

        bool PropertyChanged = false;
        //map the properties
        foreach (var props in results)
        {
            var srcValue = props.sourceProperty.GetValue(source, null);
            var dstValue = props.targetProperty.GetValue(destination, null);
            if (props.targetProperty.PropertyType.IsAssignableFrom(props.sourceProperty.PropertyType))
                props.targetProperty.SetValue(destination, srcValue, null);
            else
            {
                try
                {
                    if (!CoerceDataType)
                        throw new InvalidCastException($"Types do not match, source: {props.sourceProperty.PropertyType.FullName}, target: {props.targetProperty.PropertyType.FullName}.");

                    if (srcValue != null)
                    {
                        // determine if nullable type
                        Type tgtType = Nullable.GetUnderlyingType(props.targetProperty.PropertyType);
                        // if it is, use the underlying type
                        // without this we cannot convert int? -> decimal? when value is not null
                        if (tgtType != null)
                            props.targetProperty.SetValue(destination, Convert.ChangeType(srcValue, tgtType, CultureInfo.InvariantCulture), null);
                        else // otherwise use the original type
                            props.targetProperty.SetValue(destination, Convert.ChangeType(srcValue, props.targetProperty.PropertyType, CultureInfo.InvariantCulture), null);
                    }
                    else // if null we can just set it as null
                        props.targetProperty.SetValue(destination, null, null);
                }
                catch (Exception ex)
                {
                    if (ThrowOnTypeMismatch)
                        throw new InvalidCastException($"Unable to copy property {props.sourceProperty.Name} with value {srcValue} from object of type ({typeSrc.FullName}) to type ({typeDest.FullName}), Error: {ex.Message}");
                    // else ignore update
                }
                var newdstValue = props.targetProperty.GetValue(destination, null);
                if (newdstValue == null && dstValue != null || !newdstValue.Equals(dstValue))
                    PropertyChanged = true;
            }
        }

        return PropertyChanged;
    } 
    ```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2019-06-27T20:23:26.307

```
public TestClass {
    public TestName {get;set;}
}
public void submain()
{
    var originalTestClass = new TestClass()
    {
        TestName  ="Test Name";
    };

    var newTestClass = new TestClass();
     newTestClass.CopyPropertiesFrom(originalTestClass);
} 
```

# php - mysqli->prepare 函数返回 null

> ID：930435
> 
> 赞同：0
> 
> 时间：2009-05-30T19:46:22.227
> 
> 标签：php, mysql, prepared-statement

这是一个可怕的问题，因为我没有简单的方法来重现它。但是，我使用 Zend 框架连接到我在 OS X 上的 MySQL 数据库。有时调用 mysqli 对象上的 prepare 函数会返回 null。准备函数的声明返回值为 false 或语句对象。

我不知道在哪里可以找到有关准备语句失败的原因的信息。有什么方法可以了解准备过程以了解它失败的原因吗？我所有的问题都是在交易开放时出现的。

对不起，缺乏细节，但我真的无法确定为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T21:32:35.790

只是为了纠正 ToughPal，您应该使用：

> mysqli_query($db, "INSERT INTO table (variable1, variable2) VALUES (hello, mynameis);

请记住，在实际 SQL 之前，您需要先在查询中定义和说明 db 连接。

请记住在反引号转义中包含表名、列名和值数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T20:00:17.627

准备好的语句示例
$result = $db->query( 'INSERT INTO server (key, value) VALUES (:key, :value)', array('key' => $foo, 'value' => $bar)

你能告诉我们你的数据库查询吗？

尝试使用测试数据执行您的数据库查询，看看查询是否可以正常开始。如果查询正常，那么我们可以查看代码失败的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T12:10:04.713

好吧，我设法在周末找到了问题，但实际上只能解决症状而不是原因。

我没有在原始问题中包含任何 SQL，因为问题是随机发生的，相同的代码有时可以工作，有时不能。这个问题看起来像是一个内存指针问题。每当我遇到问题时，Zend Debugger 都会告诉我我有一个 mysqli 对象。我相信这一点，否则我会在尝试对其运行准备功能时出错。我有一个单例对象，它充当我的 mysqli 连接的容器，但是每当准备函数失败时，=== 表明正在使用的 mysqli 与我的单例对象中的 mysqli 连接不同。

最后，Zend Framework 唯一的问题是，如果准备函数返回 null，它不会失败。如果您看到此问题，请使用 === 来验证连接实际上与您之前启动的连接相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-15T01:32:32.430

如果你正在做这样的事情

```
$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME);
$query = "...";
$mysqli->prepare($query); 
```

然后您可以检查[mysqli::$error](http://php.net/manual/en/mysqli.error.php) next 以查看有关 prepare() 失败原因的有用错误

```
print_r($mysqli->error); 
```

# visual-studio-2010 - NUnit 没有运行 Visual Studio 2010 代码

> ID：930438
> 
> 赞同：98
> 
> 时间：2009-05-30T19:46:46.610
> 
> 标签：visual-studio-2010, visual-studio, debugging, nunit

我正在尝试将 Visual Studio 2010 beta dll 加载到 NUnit GUI 中。我收到一个弹出错误。

> 此程序集由比当前加载的运行时更新的运行时构建，无法加载。您可能正在尝试使用比当前运行 NUnit 的版本更高版本的 CLR 加载程序集构建。

如何强制可执行文件在 .NET 4 下运行？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-05-31T16:37:31.537

我已经下载了 NUnit 2.5 源代码并在 VS2010 beta 中打开了 VS2008 解决方案。转换完成后，我打开所有项目并将所有项目的目标框架设置更改为“.NET Framework 4.0”。然后我构建了没有任何错误的解决方案。我现在可以使用 NUnit GUI 应用程序运行为 .NET 4.0 构建的测试。我没有对此构​​建进行详尽的测试，因此可能存在问题，但就我的目的而言，它运行良好。

更新：没有必要重建 NUnit。我发现如果您将以下内容添加到相关的 NUnit 配置文件中，您可以运行为 .NET 4.0 构建的测试 dll。

在 <配置> 添加：

```
<startup>
  <supportedRuntime version="v4.0.30319" />
</startup> 
```

并在 <runtime> 下添加：

```
<loadFromRemoteSources enabled="true" /> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-04-16T20:44:57.400

随着 .NET 4 的发布，我使用了

```
<supportedRuntime version="v4.0.30319" /> 
```

在 NUnit 2.5.4 exe.config 而不是 requiredRuntime 中，以及如上所示的 loadFromRemoteResources 标记，一切都运行良好。谢谢！

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-12-26T23:34:28.493

您不必修改任何文件

只需打开此文件，一切都会正常

**C:\Program Files (x86)\NUnit 2.5.10\bin\net-2.0\nunit-x86.exe**

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-04-27T10:40:59.763

在[NUnit 2.5.5](http://nunit.org/index.php?p=releaseNotes&r=2.5.5)中，您可以在命令行中指定选项**/framework=net-4.0**，它与最新 VS2010 版本生成的新程序集兼容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-10T20:05:30.697

提议的解决方案非常适合让 NUnit 运行。不幸的是，当我进入代码覆盖步骤时，NCover 开始给我：

> 已分析的进程已终止。未建立探查器连接。

我发现的最佳解决方案是仅使用带有 NCover 的“-x86”版本的 NUnit：

> NCover.Console.exe nunit-console-x86.exe --附加参数--

现在工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-14T19:47:38.660

要从 Visual [C# 2010 Express 或任何版本] 中找到您的 .net 4 版本，请转到菜单的帮助项下的 Visual 应用程序的“关于”。它应该在窗口右上角的 Microsoft .NET Framework 行下显示为版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-21T04:23:59.477

我在运行 NUnit 2.4.8 时遇到了同样的错误消息。由于我有一段时间没有升级，我安装了当前的 NUnit (v2.5.9)，发现它现在支持 VS2010 程序集。因此，如果您新遇到此错误，*请检查您的 NUnit 版本*：截至 2010 年 12 月（左右），您**唯一**需要做的就是升级 NUnit。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-03T17:23:27.453

从 NUnit 2.5.10 开始，您可以在 GUI 运行器中启用 Visual Studio 支持：

> 工具-> 设置-> IDE 支持

之后，我能够成功附加到 nunit-agent.exe 进程，该进程在 .NET 4.0 应用程序域中运行您的程序集

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-22T16:15:09.163

如果您在升级到 nunit 2.5.5 后遇到此问题，那么您需要将 nant 升级到对我来说是 .91 alpha 的最新版本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-05-26T10:21:52.243

我[发现](http://www.csharpblog.co.cc/2011/05/integrate-nunit-with-visual-studio.html)从 NUnit Application [Template](http://visualstudiogallery.msdn.microsoft.com/b8a7a8fa-9f5a-4b9b-8e8b-8839a4364f26)开始很有用。它支持 VS C# Express，允许调试测试并包含用于 .NET 4.0 的预编译 NUnit。感谢作者，一键即可准备好新的测试项目。

# git - 将 git 与 emacs 一起使用

> ID：930439
> 
> 赞同：9
> 
> 时间：2009-05-30T19:47:37.857
> 
> 标签：git, macos, version-control, emacs

我正在尝试配置 git.el。当我执行 git-status 时，我可以看到状态缓冲区已更改，我也可以使用“a”添加文件，但是当我尝试使用 c 提交文件时，写入提交日志并使用 Cc 完成它 Cc 给了我

```
env: git: No such file or directory 
```

错误并且文件未提交。我在 OS X 上使用 emacs 23。我添加到我的 .emacs 中的唯一自定义是

```
(setq exec-path (append exec-path '("/opt/local/bin")) ) 
```

因为 emacs 找不到 git 可执行文件。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-31T06:46:00.770

在我的 Mac OS X 的 .emacs 中，我有以下代码：

```
(when (equal system-type 'darwin)
  (setenv "PATH" (concat "/opt/local/bin:/usr/local/bin:" (getenv "PATH")))
  (push "/opt/local/bin" exec-path)) 
```

似乎问题在于，当您运行 terminal.app 时，它使用您的 shell 初始化文件来设置所有环境变量，但是当您从 Dock 启动 Emacs 时，这些变量并没有设置。

[PS 顺便说一句 - Emacs 中还有其他与 Git 配合使用的包 - magit、DVC、egg... 你可以在我的文章](http://xtalk.msk.su/~ott/en/writings/emacs-vcs/)中阅读它们

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T23:30:41.353

好吧，由于错误行的开头是`env:`，这表明 git.el 正在使用程序“env”来查找 git 并调用它。查看源代码证实了这一点，因为所有对 git 的调用似乎都通过这里：

```
(defun git-call-process-env (buffer env &rest args)
  "Wrapper for call-process that sets environment strings."
  (if env
      (apply #'call-process "env" nil buffer nil
             (append (git-get-env-strings env) (list "git") args))
    (apply #'call-process "git" nil buffer nil args))) 
```

扫描代码显示，在大多数情况下，Emacs 直接使用 git 调用 git `call-process`，但有时会使用“env”命令，尤其是在需要传递环境变量时（如“GIT_INDEX_FILE”）。

问题是 Emacs 在通过运行它时`exec-path`没有传递它，所以在 Emacs 中设置不会帮助 `env' 找到 git。`env``call-process``exec-path`

实际上有两种解决方案：

1.  弄清楚如何`env`知道 git 在哪里。恐怕我不能真正帮助你，因为我不知道如何在 Mac 上设置这种东西，但它应该是对 PATH 的一个相当简单的修改。

2.  调用 git 时破解 git.el 以传递`PATH=/path/to/git`给 env。这不太干净，但它并不是那么糟糕，特别是如果你选择了进入 a 的路径`defcustom`，它可能对其他人有用。

不过，我建议从 1 开始。您可以使用以下方法更改 Emacs 的环境变量：

```
(setenv "PATH" (concat "/opt/local/bin:" (getenv "PATH"))) 
```

然后尝试 git.el 。虽然 Emacs 不会将变量传递`exec-path`给子进程，但它会从调用它的任何内容中复制其 PATH 环境变量。由于 Emacs 也直接调用 git，因此您还需要按照`exec-path`您已有的方式进行设置。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:03:51.890

解决此问题的一个非常简单的方法是修改 .emacs 文件中的 exec 路径

```
(add-to-list 'exec-path "/usr/local/git/bin/") 
```

这对我有用。

# reflector - 为什么人们要反汇编 .NET (CLR) 二进制文件？

> ID：930442
> 
> 赞同：4
> 
> 时间：2009-05-30T19:48:34.190
> 
> 标签：reflector, il, disassembly

我对 .NET 有点陌生，但对编程并不陌生，而且我对反汇编已编译的 .NET 代码的趋势和兴奋感到有些困惑。似乎毫无意义。

.NET 的高级易用性是我使用它的原因。我在资源有限的环境中编写了 C 和真实（硬件处理器）程序集。这就是为什么要在如此多的细节上花费精力，以提高效率。在 .NET 领域，如果您浪费时间深入研究实现的最隐秘的细节，这有点违背了拥有高级面向对象语言的目的。在使用 .NET 的过程中，我调试了常见的性能问题和奇怪的竞争条件，我通过阅读自己的源代码完成了这一切，从来没有想过编译器正在生成什么中间语言。例如，考虑到 foreach() 将使用枚举，很明显 for(;;) 循环将比数组上的 foreach() 更快*对象*带有一个方法调用来前进到下一次，而不是简单地增加一个变量，这很容易通过一个紧密的循环运行几百万次来证明（不需要反汇编）。

真正让反汇编 IL 变得愚蠢的是它不是*真正的*机器代码。是虚拟机代码。我听说有些人实际上喜欢移动指令来优化它。你在开玩笑吧？即时编译的虚拟机代码甚至无法以本机编译代码的速度执行简单的紧 for(;;) 循环。如果您想从处理器中挤出最后一个周期，那么请使用 C/C++ 并花时间学习真正的汇编。这样一来，您花在了解许多低级细节上的时间实际上是值得的。

那么，除了手头有太多时间之外，人们为什么还要反汇编 .NET (CLR) 二进制文件呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T19:55:10.587

了解各种高级语言的编译器实际上对您的源代码做了什么是您掌握特定环境时需要掌握的一项重要技能，就像了解数据库引擎将如何计划执行各种 SQL 查询一样可以向他们折腾。要以熟练的方式使用某种抽象级别，熟悉（至少）低于它的级别是一件非常好的事情；例如，请参阅[我关于抽象主题的演讲的一些注释](http://defcraft.blogspot.com/2009/04/notes-from-alex-martellis-talk-pycon.html)和[该演讲的幻灯片，](http://www.aleax.it/pycon_abst.pdf)以及我在演讲中提到的 Joel Spolsky 的“泄漏抽象法则”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T20:06:58.987

当源代码丢失或特定标记版本中的版本控制中的内容似乎与随附的二进制文件不对应时，我会使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T20:41:23.007

在刚刚完成 4 天的安全软件开发课程后，我想说很多人会反编译源代码以发现其中的任何漏洞。了解客户端应用程序的来源有助于计划对服务器的攻击。

当然，小实用程序之类的，不会有任何此类问题。

如果我没记错的话，有一个应用程序可以混淆你的 .net 二进制文件。我相信它被称为dotfuscator。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T22:40:00.253

了解如何使用文档记录不佳的界面。

（遗憾的是，在 BizTalk 或 WCF 等基于 .net 的工具中过于频繁，只能生成通用生成的文档，因此有时需要反汇编为 C# 以查看方法正在做什么，在什么上下文中使用它）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T19:12:33.053

实际上，一个 int[] 上的 foreach 被编译成一个 for 语句。如果我们将它转​​换为可枚举，你是对的，它使用枚举器。 **然而，奇怪的是，它更快，因为没有增加 temp int。** 为了证明这一点，我们使用基准测试和反编译器来增加理解......

所以我认为通过问这个问题，你真的自己回答了。

如果此基准与您的不同，请告诉我如何。我用对象数组、空值等进行了尝试……

代码：

```
 static void Main(string[] args)
    {

        int[] ints = Enumerable.Repeat(1, 50000000).ToArray();

        while (true)
        {
            DateTime now = DateTime.Now;
            for (int i = 0; i < ints.Length; i++)
            {
                //nothing really
            }
            Console.WriteLine("for loop: " + (DateTime.Now - now));

            now = DateTime.Now;
            for (int i = 0; i < ints.Length; i++)
            {
                int nothing = ints[i];
            }
            Console.WriteLine("for loop with assignment: " + (DateTime.Now - now));

            now = DateTime.Now;
            foreach (int i in ints)
            {
                //nothing really
            }
            Console.WriteLine("foreach: " + (DateTime.Now - now));

            now = DateTime.Now;
            foreach (int i in (IEnumerable<int>)ints)
            {
                //nothing really
            }
            Console.WriteLine("foreach casted to IEnumerable<int>: " + (DateTime.Now - now));
        }

    } 
```

结果：

```
for loop: 00:00:00.0273438
for loop with assignment: 00:00:00.0712890
foreach: 00:00:00.0693359
foreach casted to IEnumerable<int>: 00:00:00.6103516
for loop: 00:00:00.0273437
for loop with assignment: 00:00:00.0683594
foreach: 00:00:00.0703125
foreach casted to IEnumerable<int>: 00:00:00.6250000
for loop: 00:00:00.0273437
for loop with assignment: 00:00:00.0683594
foreach: 00:00:00.0683593
foreach casted to IEnumerable<int>: 00:00:00.6035157
for loop: 00:00:00.0283203
for loop with assignment: 00:00:00.0771484
foreach: 00:00:00.0771484
foreach casted to IEnumerable<int>: 00:00:00.6005859
for loop: 00:00:00.0273438
for loop with assignment: 00:00:00.0722656
foreach: 00:00:00.0712891
foreach casted to IEnumerable<int>: 00:00:00.6210938 
```

反编译（请注意，空的 foreach 必须添加一个变量赋值......我们的空 for 循环没有但显然需要）：

```
private static void Main(string[] args)
{
    int[] ints = Enumerable.Repeat<int>(1, 0x2faf080).ToArray<int>();
    while (true)
    {
        DateTime now = DateTime.Now;
        for (int i = 0; i < ints.Length; i++)
        {
        }
        Console.WriteLine("for loop: " + ((TimeSpan) (DateTime.Now - now)));
        now = DateTime.Now;
        for (int i = 0; i < ints.Length; i++)
        {
            int num1 = ints[i];
        }
        Console.WriteLine("for loop with assignment: " + ((TimeSpan) (DateTime.Now - now)));
        now = DateTime.Now;
        int[] CS$6$0000 = ints;
        for (int CS$7$0001 = 0; CS$7$0001 < CS$6$0000.Length; CS$7$0001++)
        {
            int num2 = CS$6$0000[CS$7$0001];
        }
        Console.WriteLine("foreach: " + ((TimeSpan) (DateTime.Now - now)));
        now = DateTime.Now;
        using (IEnumerator<int> CS$5$0002 = ((IEnumerable<int>) ints).GetEnumerator())
        {
            while (CS$5$0002.MoveNext())
            {
                int current = CS$5$0002.Current;
            }
        }
        Console.WriteLine("foreach casted to IEnumerable<int>: " + ((TimeSpan) (DateTime.Now - now)));
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-29T23:06:14.660

学习。

文章很好，但它们不提供生产代码。如果没有*.NET Reflector*，我可能需要几周的时间才能弄清楚微软是如何在`FileSystemWatcher`组件中实现事件的。相反，只用了几个小时，我就完成了我的`FileSystemSearcher`组件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T20:00:43.320

每种 .NET 语言都实现了自己的 CLR 功能子集。知道 CLR 能够完成您当前使用的语言所不具备的功能，可以让您就是否更改语言或发出 IL 或寻找其他方式做出明智的决定。

您认为人们这样做的唯一原因是因为他们有太多时间的假设是侮辱和未受过教育的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T21:02:08.393

定位库错误并找出解决方法。

例如：没有反射，你不能远程异常并重新抛出它而不杀死它的回溯。但是框架可以做到。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-30T21:08:49.377

从您的问题来看，您似乎不知道 Reflector 将 CLR 程序集反汇编回 C# 或 VB，因此您几乎看到的是原始代码，而不是 IL！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-26T05:38:37.770

Something that folks haven't mentioned is that reflector comes in super useful if you use a compile time weaving AOP framework like PostSharp.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-30T19:56:41.160

我自己经常想知道这个...... :)

有时需要了解特定的库方法是如何工作的，或者为什么它会以这种方式工作。可能存在此功能的文档含糊不清或存在一些需要调查的奇怪行为的情况。在这种情况下，有些人会去反汇编库来查看某些方法内部的调用是什么。

至于优化，我从来没有听说过。我认为尝试优化 MIL 最终是愚蠢的，因为它将被馈送到一个翻译器，该翻译器将以相当高的效率生成真正的机器代码，并且无论如何你的“优化”可能会丢失。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-30T21:06:24.077

要了解底层系统是如何实现的，请了解 IL 中高级代码的等价物，规避许可......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-30T22:15:35.187

我在以下更多案例中使用了它：

1.  我没有源代码的内部程序集遇到问题。
2.  需要弄清楚特定第三方控件库如何查找运行时许可证。
3.  需要了解 .Net 许可证编译器的工作原理。（只是将 lc.exe 放在 Reflector 中）
4.  用它来确保我正确构建了某些库。

# ruby-on-rails - 分号作为 Rails 控制台中的语句分隔符

> ID：930454
> 
> 赞同：6
> 
> 时间：2009-05-30T19:51:49.987
> 
> 标签：ruby-on-rails, console

Rails 控制台似乎不喜欢在同一行上用分号分隔多个 ruby​​ 语句。每当我这样做时，下一行都会开始，`?>`我发现只执行了第一条语句。**您是否必须将每个语句放在单独的行上？**

```
>> user = User.new
user = User.new

=> #<User id: nil, username: "", hashed_password: "", first_name: "", last_name: "", email: "", display_name: "", user_level: 0, created_at: nil, updated_at: nil, posts_count: 0>

>> user.username = "John"; hashed_password = "John"; first_name = "John"; last_name = "coltrane"; email = "John@coltrane.com"; display_name = "Johndispay"; user_level = 9; 
user.username = "John"; hashed_password = "John"; first_name = "John"; last_name = "coltrane"; email = "John@coltrane.com"; display_name = "Johndispay"; user_level = 9; 

?> user.save
user.save

=> true 
```

**除了`user.username = "John";`被忽略的一切**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T19:57:29.100

你需要说“用户”。所以Ruby知道你的意思是调用用户实例的属性分配方法。否则，您只是设置名为“hashed_pa​​ssword”等的局部变量。

```
>> user.username = "John"; user.hashed_password = "John"; user.first_name = "John"; user.last_name = "coltrane"; user.email = "John@coltrane.com"; user.display_name = "Johndispay"; user.user_level = 9; 
```

虽然，您可以只传递要在新实例上设置的属性的哈希值，就像这样

```
>> user = User.new(:username => "John", :hashed_password => "John", ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T20:20:24.390

这是尾随；根据您的输入。当你放一个';' 最后 IRB 会假设您要添加另一个语句。如果您将其关闭，它将评估所有语句并返回最后一个语句的返回值。

有时，如果我调用的方法要返回一个大数组，我会做这样的事情......

```
a = Account.entries; a.size 
```

这将保存我需要的值并仅输出数组的大小，而不是尝试将其转储到控制台，如果它很大，这可能需要很长时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T19:57:54.280

你确定你不是故意的

```
user.username = "John"; user.hashed_password = "John"; 
```

我试过

```
>> a = 1; b= 2
=> 2

>> a
=> 1

>> b
=> 2 
```

当某些事情不起作用时，您可以使用一条规则：始终将其简化为最简单的情况。

# ruby-on-rails - 在类急切加载时排除子目录

> ID：930455
> 
> 赞同：0
> 
> 时间：2009-05-30T19:53:05.537
> 
> 标签：ruby-on-rails

我面临一个问题，即我的 Rails 应用程序在登台或生产环境中运行时设置为缓存类。虽然 load_paths 仅包含“app/models”，但初始化步骤似乎递归地缓存了“app/models”中的所有内容。

```
 # Eager load application classes
  def load_application_classes
    if configuration.cache_classes
      configuration.eager_load_paths.each do |load_path|
        matcher = /\A#{Regexp.escape(load_path)}(.*)\.rb\Z/
        Dir.glob("#{load_path}/**/*.rb").sort.each do |file|
          require_dependency file.sub(matcher, '\1')
        end
      end
    end
  end 
```

问题在于我们在“app/models”中有一个子目录，其中包含带有引用并发 JRuby 环境的 require 语句的文件。由于 Rails 对这种环境一无所知，我们的应用程序在加载时会中断。

就目前而言，这里是建议的解决方案......不幸的是，只有＃1是理想的。

1）最简单的解决方案是排除罪魁祸首子目录，但还没有找到任何方法来完成此操作。

2) Monkey 修补 load_application_classes 方法以跳过特定的子目录。

3) 将子目录从“app/models”下移出。感觉有点hackish，需要修改很多代码。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T20:10:26.937

作为临时措施，您可以使用选项 2 的版本并覆盖 load_application_classes 的定义，将其替换为空实现。这将迫使您明确要求您需要的类，但它可以让您完全控制加载的内容，并且将是一个完全透明的解决方案。

听起来您的应用程序已经足够复杂，以至于超出了 Rails 框架。我知道这并不能直接回答您的问题，因此请提前应用，但您可能需要考虑查看像 Merb 这样的替代 Ruby 框架。Rails 很棒，但迟早你会碰到框架的边缘——听起来就像你现在所处的位置。

我们去年改用 Merb 并没有重新使用它。

克里斯

# android - 将复杂的原生应用程序编译到 Android ARM 的完整方法

> ID：930458
> 
> 赞同：2
> 
> 时间：2009-05-30T19:55:53.660
> 
> 标签：android, java-native-interface, native

这是我的第一个 S/O 问题，请温柔！

我想了解更多关于将 C 应用程序移植到本机 ARM 以在 Android 设备上使用的信息。

我可以使用源代码附带的预构建工具链制作简单的程序，但是如何将此工具链与多个文件且需要配置和制作的应用程序一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T16:40:51.017

这篇文章解释得很好： [http ://davanum.wordpress.com/2007/12/09/android-invoke-jni-based-methods-bridging-cc-and-java/](http://davanum.wordpress.com/2007/12/09/android-invoke-jni-based-methods-bridging-cc-and-java/)

基本上，您像往常一样创建一个共享库，用 JNI 包装它，然后用 Java 的本地方法调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:58:46.300

在 Google I/O 上，他们谈到了引入“NDK”——原生开发工具包——应该可以简化创建使用原生 (C) 代码的应用程序的过程。

在您沿着这条路线走得太远之前，有几件事值得注意：

1.  NDK 将提供有限的功能。它的主要目的是提供一种在本机上运行对时间极为敏感的代码的方法，但无法访问整个系统，也不会提供替代的应用程序开发模型（您仍然需要编写大部分应用程序）达尔维克）。
2.  您可以在没有 NDK 的情况下编写本机应用程序，但您将无法使用应用商店支持的传统 APK 应用程序包将它们分发给最终用户。如果您的应用程序是作为运营商/OEM 构建的一部分分发的，那么这确实是一个可行的选择——即使这样也不推荐。

# .net - 接口声明属性而不是方法是否可以接受？

> ID：930459
> 
> 赞同：3
> 
> 时间：2009-05-30T19:55:54.690
> 
> 标签：.net, oop, interface

接口声明属性而不是方法是否可以接受？
哪个更受欢迎？
接口 ITaggable { 字符串 GetTag(); }
或
接口 ITaggable { 标签 {get;} }

生活在 .Net 世界中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T20:00:36.130

绝对地。在接口中使用属性就像在类中一样。

框架中的示例包括[`IEnumerator<T>.Current`](http://msdn.microsoft.com/en-us/library/58e146b7.aspx)和[`ICollection<T>.Count`](http://msdn.microsoft.com/en-us/library/5s3kzhec.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T19:58:22.373

在这种情况下使用属性是完全可以的。当你真的只是得到一个值时，我更喜欢使用属性而不是 GetFoo() 方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T19:59:04.823

在这种情况下，属性绝对是首选。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T20:03:51.117

属性和方法之间的通常区别（至少我使用的那个，我真的希望它是“通常的”:)）仍然适用。

如果通过命名标识符（属性或方法）从对象获取数据的行为是：

*   昂贵的操作（即它可能会查询数据库）
*   或具有副作用的操作（即它可能会更改内部字段）

...那么它应该是一种方法。

如果操作是轻量级的，没有副作用，它可以是一个属性。

所以读取一个人的名字是一个属性，因为该值可能应该在对象中开始。

但是，要弄清楚他在系统中有多少订单，这可能应该是一种方法，因为它可能需要进行更昂贵的操作。

至少这是我使用的标准。

在这方面，它是类还是接口对我来说没有区别。

在您的具体情况下，我会选择该物业。“可标记”项目应该知道它的标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T20:00:09.173

在预期的实现语言支持属性的情况下，在您的界面中使用它们也是完全正确的（当然，如果您的预期目标是一种缺乏支持的语言，您必须坚持使用 getter/setter 访问器属性）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T20:00:35.083

我相信如果您尝试声明一个只读属性（即使没有私有设置器），编译器会建议您改用方法。

至于真正的选择，这取决于特定情况、您的编码风格和您所遵循的设计方法。

# algorithm - 给定一个树结构，你如何使用递归将其变成一个简单的链表？

> ID：930477
> 
> 赞同：1
> 
> 时间：2009-05-30T20:03:01.150
> 
> 标签：algorithm, recursion

给定一棵二叉树（只有左右子树），你如何编写一个递归函数将其变成一个简单的链表？（不应该创建新的数据结构。伪代码是可以的）。假设每个节点都有一个整数值，例如 123、2 或 3。最终的链接列表应该包含树中的所有节点。顺序并不重要。

**更新：**需要就地。不应创建新的数据结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T20:10:23.397

迭代树总是有不同的方法，因为有：

*   为了
*   预购
*   邮购

您可以选择其中任何一个来形成您的列表...

例如（伪代码，PreOrder）：

```
function treeToList(LinkedList l, Tree t)
    if(t not nil)
        l.add(t.element)
        treeToList(l, t.Left)
        treeToList(l, t.Right)
    endif
end function 
```

记住：如果您在二叉搜索树上执行 InOrder，您将按排序顺序获得元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T20:10:59.167

不要粗鲁，但这听起来有点像家庭作业。让我给出一个描述作为答案：

*   您为结果创建一个空链表。

*   制作一个接受链表和节点的帮助函数。

*   辅助函数应将子节点（如果有）添加到列表中，并在子节点（如果有）上递归调用自身。

*   将根节点添加到结果列表中。

*   在根节点和结果列表上调用辅助函数。

*   将结果列表返回给调用者。

Wikipedia 上当然有很多关于此的内容：[二叉树](http://en.wikipedia.org/wiki/Binary_tree)和[树遍历](http://en.wikipedia.org/wiki/Tree_traversal)。

**编辑：**或查看 Kevin 发布的伪代码 :-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T20:15:44.150

由于您已将其标记为作业，因此我将不使用源代码或伪代码进行回复，但会进行更全面的描述。

由于您的树将包含您想要包含在链接列表中的所有值，因此我们必须确保我们能够到达所有这些值。

为此，我们必须确保处理每个叶节点。

为此，我们需要确保处理每个节点的每个左右子节点。

让我们从根节点开始，当您谈论二叉树时，它通常是您参考的那个。

我假设您知道如何通过按顺序将项目附加到链表来生成链表。

所以要处理根节点，我们这样做：

*   如果根包含一个值：将该值附加到列表中

这会处理可以选择存储在根节点中的单个值。一些二叉树只将值存储在叶节点（没有孩子的节点）中，大多数也将值存储在内部节点（*有*孩子的节点）中。

但这当然会让我们无处可去，因为我们只添加一个项目，我们甚至不知道这个特定值在所有值中的位置，所以它可能是第一个，或最后一个，或介于两者之间的任何值。

但是，我们知道如果根节点在左侧“方向”上有子节点，那么我们可能在所有这些节点中找到的任何值都将出现在根节点中的节点之前。

而且我们还知道，如果根节点在正确的“方向”上有子节点，那么这些值将出现在它之后。

所以我们能做的是：

*   处理左子树中的所有节点
*   在节点中追加值
*   处理右子树中的所有节点

这种方法假设：

*   节点值是有序的（即左子树在节点本身的值之前，等等）
*   您想要按顺序排列的值

如果您将上述方法定义为一种方法，您将拥有如下内容：

```
to process a node, do this:
    first process the left-child sub-node, if present
    then append the value of the node, if any
    then process the right-child sub-node, if present 
```

在上面的伪代码中，您会看到“进程”一词，您可以将相同的进程应用于上述这些节点。

这是处理简单二叉树并将结果附加到给定链表的 C# 代码：

```
public void AppendTreeToLinkedList<T>(Node<T> node, LinkedList<T> list)
{
    if (node.LeftChild != null)
        AppendTreeToLinkedList(node.LeftChild, list);
    list.Append(node.Value);
    if (node.RightChild != null)
        AppendTreeToLinkedList(node.RightChild, list);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T20:51:47.120

要获得一个以与原始树相同的方式排序的双重喜欢列表，C# 代码：

```
function Listify(Node n, out Node First, out Node Last)
{
    if ( Node.Left != null )
    {
        Node Tmp;
        Listify(Node.Left, out First, out Tmp);
        Node.Left = Tmp;
    }
    else
    {
        First = Node;
    }
    if ( Node.Right != null )
    {
        Node Tmp;
        Listify(Node.Right, out Tmp, out Last);
        Node.Right = Tmp;
    }
    else
    {
        Last = Node;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T20:06:49.753

你真的在问我如何走一棵二叉树。答案可以在任何有关算法和数据结构的书中找到。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T20:11:10.257

您可以按许多顺序“走一棵树”，主要的顺序是前序、后序和中序。下面是一些有序的伪代码，例如：

```
def in_walk(tree, doit):
  if tree is null: return
  in_walk(tree.left, doit)
  doit(tree.root)
  in_walk(tree.right, doit) 
```

我希望这个伪代码中的假设是显而易见的：一棵树有左右链接，可以为空，意思是“没有更多的东西可以在这里走”，还有一个根节点；在给定节点参数的情况下，您可以传递一个正确思考的函数或闭包（附加到链表或其他）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T20:13:23.500

```
/* bst.c: sort the input numbers and print them forward and backward with no duplicates */

#include <stdio.h>
#include <stdlib.h>

struct node {
    int key;
    struct node *left;
    struct node *right;
};

static struct node **bst_find(struct node **root, int key) {
    struct node **n;

    n = root;
    while (*n != NULL && (*n)->key != key) {
        if (key < (*n)->key) {
            n = &(*n)->left;
        } else {
            n = &(*n)->right;
        }
    }
    return n;
}

static void bst_insert(struct node **root, int key) {
    struct node **n;

    n = bst_find(root, key);
    if (*n == NULL) {
        *n = malloc(sizeof (**n));
        (*n)->key = key;
        (*n)->left = NULL;
        (*n)->right = NULL;
    }
}

/* massage the tree rooted at "root" to be a doubly-linked list
 * return the leftmost and rightmost nodes via the parameters "leftend" and "rightend"
 * bst_flatten() is invoked 2N+1 times, where N is the number of tree elements
 */
static long Flatten_count = 0;
static void bst_flatten(struct node **leftend, struct node **rightend, struct node *root) {
    Flatten_count++;
    if (root != NULL) {
        /* flatten the left side of the tree */
        *leftend = root;
        bst_flatten(leftend, &root->left, root->left);
        /* if necessary, splice "root" onto the right end */
        if (root->left != NULL) {
            root->left->right = root;
        }
        /* flatten the right side of the tree */
        *rightend = root;
        bst_flatten(&root->right, rightend, root->right);
        /* if necessary, splice "root" onto the left end */
        if (root->right != NULL) {
            root->right->left = root;
        }
    }
}

int main(void) {
    int key;
    long N = 0;
    struct node *root = NULL;
    struct node *leftend = NULL;
    struct node *rightend = NULL;
    struct node *n;

    /* read the input into a bst */
    while (scanf("%d", &key) == 1) {
        N++;
        bst_insert(&root, key);
    }
    /* make a list */
    bst_flatten(&leftend, &rightend, root);
    /* traverse the list forward */
    for (n = leftend; n != NULL; n = n->right) {
        printf("%d\n", n->key);
    }
    /* traverse the list backward */
    for (n = rightend; n != NULL; n = n->left) {
        printf("%d\n", n->key);
    }
    fprintf(stderr, "%ld items input, %ld invocations of bst_flatten()\n", N, Flatten_count);
    return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T20:42:21.083

假设树的节点包含指向名为 left 和 right 的节点的指针。我们最终会得到一个仅使用正确节点指针的列表。

```
listify( node )
    if node has no children 
        return

    else if node.left == null
        listify(node.right)

    else if node.right == null
        listify(node.left)
        mode.right = node.left

    else
        listify(node.left)
        listify(node.right)

        temp = node.left
        while temp.right != null
            temp = temp.right

        temp.right = node.right

        node.right = node.left 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-31T00:14:31.750

在 Scheme 中，使用记忆递归，有序算法将是：

```
(define (tree->list tree)
  (define empty-set (list))
  (define (copy-to-list tree result-list)
    (if (null? tree)
      result-list
      (copy-to-list (left-branch tree)
                    (cons (entry tree)
                          (copy-to-list (right-branch tree)
                                        result-list)))))
   (copy-to-list tree empty-set)) 
```

这假设树结构表示为：

```
(define (entry tree) (car tree))
(define (left-branch tree) (cadr tree))
(define (right-branch tree) (caddr tree))
(define (make-tree entry left right)
  (list entry left right)) 
```

注意我本可以使用文字`'()`来表示，`empty-set`但是这样会弄乱块引用代码的颜色编码。

# c# - 分别针对值和引用类型的最完整的 Equals 实现

> ID：930478
> 
> 赞同：0
> 
> 时间：2009-05-30T20:03:28.027
> 
> 标签：c#, .net, equals

对于像 Point3 （例如）这样的引用类型（类），这是一个矫枉过正，缺乏：

```
#region System.Object Members

public override bool Equals ( object obj )
{
        //return this == ( Point3 ) obj;

        if ( obj == null )
        {
                return false;
        }

        if ( this.GetType ( ) != obj.GetType ( ) )
        {
                return false;
        }

        return this.Equals ( ( Point3 ) obj );
}

public override int GetHashCode ( )
{
        return this.X.GetHashCode ( ) ^ this.Y.GetHashCode ( ) ^ this.Z.GetHashCode ( );
}

public override string ToString ( )
{
        return String.Format ( "[{0}, {1}, {2}]", this.X, this.Y, this.Z );
}

#endregion

#region IEquatable<Point3> Members

public bool Equals ( Point3 other )
{
        if ( other == null )
        {
                return false;
        }

        if ( ReferenceEquals ( this, other ) )
        {
                return true;
        }

        if ( this.GetHashCode ( ) != other.GetHashCode ( ) )
        {
                return false;
        }

        if ( !base.Equals ( other ) )
        {
                return false;
        }

        return this == other;
}

#endregion

public static bool operator == ( Point3 v0, Point3 v1 )
{
        return ( v0.X.IsEqual ( v1.X ) ) && ( v0.Y.IsEqual ( v1.Y ) ) && ( v0.Z.IsEqual ( v1.Z ) );
}

public static bool operator != ( Point3 v0, Point3 v1 )
{
        return !( v0 == v1 );
} 
```

请为值和引用类型进行调整或发布一个新的，我可以在我的基本类型（值和引用）中使用它，而无需在每次我再次实现它时考虑太多。

编辑：这适用于不可变类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T20:23:04.510

好吧，首先，不要陷入使用 XOR 作为组合运算符生成哈希码的陷阱。

否则，您将遇到以下问题，其中 HC(x) 表示“对象/值 x 的哈希码”：

```
HC(a,b) = HC(b,a)
HC(a,a) = HC(b,b) = 0 
```

相反，选择至少考虑值顺序的东西，如下所示：

```
hashcode = 23 // prime number
for each sub-value of the object, do:
    hashcode = hashcode * 31 // another prime number
    hashcode = hashcode + the hashcode of the sub-value 
```

这将尽可能地保留排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T20:22:42.997

> this.GetType ( ) != obj.GetType ( )

那会很慢。`obj is Type`宁可使用。

`ReferenceEquals`对值类型毫无意义，我认为 Point3 是。

我也不会为相等程序中的哈希码检查而烦恼。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T20:29:00.143

如果您真的很注重性能并且您的值 x、y 和 z 不会改变（至少经常如此），那么当您进行大量比较时，您可以预先计算您的哈希码。然后在你的平等比较期间很早就使用它。

但在这种情况下最好的方法是：使用分析器找到真正的瓶颈。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T13:17:59.567

此外，如果您正在创建自己的 Equals 方法，您应该考虑实现 IEquatable。这为您提供了一个很好的相等方法来比较相同的类型，并且通常您可以将 Equals(object) 方法缩减为（对于引用类型）：

```
public override Equals(object other)
{
    Point3 otherP = other as Point3;
    return otherP != null && Equals(otherP); // calls the Equals(Point3) method
} 
```

除了更好一点之外，如果类型是结构，这会减少框操作 - 如果 IEquatable 实现是隐式的，代码将自动使用类型化的 Equals(Point3) 方法，而不是使用涉及装箱操作（并且可能实际上在该方法内进行了拆箱）

# javascript - 为什么这个搜索框在点击时不选择所有文本？

> ID：930485
> 
> 赞同：0
> 
> 时间：2009-05-30T20:07:22.607
> 
> 标签：javascript, html, yui

您可以在以下网址查看相关搜索框：[http](http://www.trailbehind.com) ://www.trailbehind.com 。如果用户尝试搜索两次，他们必须按退格键来清除文本，但我想在双击时选择所有文本，默认情况下应该执行哪些输入。为什么不介意？

当用户第一次点击时，我清除输入如下：

```
input.onclick = clearInitialValue;

功能清除初始值（）{
  this.value = "";
  this.onclick = '返回 True';
  this.style.color = "黑色";
}

```

为了帮助我解决这个谜题，您可能需要知道的另一件事是我使用输入来实例化 YUI 自动完成：http: [//developer.yahoo.com/yui/autocomplete/](http://developer.yahoo.com/yui/autocomplete/)，但我在文档中找不到任何内容这就解释了为什么双击输入以选择文本不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T06:30:35.623

而不是你的

```
 this.onclick = 'return True'; 
```

尝试

```
 this.onclick = 'this.select(); return true'; 
```

这将选择框中的文本。

考虑在焦点上执行此操作，而不是单击。

如果这不符合您的要求，请尝试关闭 YUI 自动完成功能，看看是否有干扰。我已经看到了。

如果那不这样做，通过在没有其他 JS 的干净页面上实现它来简化更多，然后将其粘贴到谷歌地图中。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T20:57:19.183

请记住，每个 javascript 事件只能使用一种方法，因此，在您的示例中，您正在分配 onclick 事件，请确保不要再这样做。

要拥有更多，您需要使用事件侦听器。

```
var oDiv = document.getElementById('thediv');

oDiv.addEventListener('click', function (e) {
    // your method here
}, true); 
```

或简单

```
oDiv.addEventListener('click', clearInitialValue, true); 
```

你提到你正在使用 YUI，所以代码将类似于：

```
 YAHOO.util.Event.on(oDiv, "click", clearInitialValue); 
```

不是直接回答您的问题，但在处理 javascript 事件时请记住。

* * *

回答您的问题，您的代码运行良好...查看在[JSBIN运行的代码](http://jsbin.com/aziri)

您可以将 /edit 添加到 url 以对其进行编辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T20:21:55.213

我看到一件事可能是个问题，你有

```
this.onclick = 'return True'; 
```

尝试

```
this.onclick = 'return true'; 
```

javascript 区分大小写。

# associativity - 什么是运算符的关联性，为什么它很重要？

> ID：930486
> 
> 赞同：97
> 
> 时间：2009-05-30T20:08:07.783
> 
> 标签：associativity

什么是关联性（对于操作员），为什么它很重要？

**更新：**运算符关联性

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-05-30T20:15:37.410

对于运算符，关联性意味着当同一运算符连续出现时，我们首先应用哪个运算符出现。在下面，让`Q`成为操作员

```
a Q b Q c 
```

如果`Q`是左关联的，那么它评估为

```
(a Q b) Q c 
```

如果它是右结合的，那么它评估为

```
a Q (b Q c) 
```

这很重要，因为它改变了表达式的含义。考虑整数算术的除法运算符，它是左结合的

```
4 / 2 / 3    <=>    (4 / 2) / 3    <=> 2 / 3     = 0 
```

如果它是右结合的，它将评估为未定义的表达式，因为您将除以零

```
4 / 2 / 3    <=>    4 / (2 / 3)    <=> 4 / 0     = undefined 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-30T20:13:16.650

关联性分为三种：

[数学中的结合性质](http://en.wikipedia.org/wiki/Associativity)

[编程语言中的操作顺序](http://en.wikipedia.org/wiki/Operator_associativity)

[CPU 缓存中的关联性。](http://en.wikipedia.org/wiki/CPU_cache#Associativity)

数学中的关联属性是运算符的属性，例如加法 (+)。此属性允许您在不更改语句值的情况下重新排列括号，即：

```
(a + b) + c = a + (b + c) 
```

在编程语言中，运算符的关联性（或固定性）是一种属性，它决定了相同优先级的运算符在*没有*括号的情况下如何分组；即以什么顺序评估每个运算符。这可能因编程语言而异。

在 CPU 缓存中，关联性是一种优化性能的方法。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-08-05T21:27:09.183

**简单的！！**

```
Left Associative means we evaluate our expression from left to right

Right Associative means we evaluate our expression from right to left 
```

我们知道 *、/ 和 % 具有相同的优先级，但根据关联性，答案可能会改变：

例如：我们有表达式：4 * 8 / 2 % 5

```
Left associative:   (4 * 8) / 2 % 5 ==> (32 / 2) % 5 ==> 16 % 5 ==> 1

Right associative:  4 * 8 /(2 % 5) ==>  4 * ( 8 / 2) ==> 4 * 4 ==> 16 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-30T20:19:36.513

它是相同优先级的运算符的求值顺序。从左到右或从右到左的顺序很重要。为了

```
3 - 2 - 1 
```

如果它是从左到右，那么它是

```
(3 - 2) - 1 
```

并且是 0。如果它是 RIGHT 到 LEFT，那么它是

```
3 - (2 - 1) 
```

它是 2。在大多数语言中，我们说减号运算符具有从左到右的关联性。

### 2020 年更新：

`3 - 2 - 1`如果声称“我们当然是从左到右”，那么这种情况可能看起来微不足道。但在其他情况下，例如在 Ruby 或 NodeJS 中完成：

```
$ irb
2.6.3 :001 > 2 ** 3 ** 2
 => 512 
```

是“`**`权力”运算符。关联性是从右到左。它是

```
 2 ** (3 ** 2) 
```

这是`2 ** 9`, 即 ,`512`而不是

```
(2 ** 3) ** 2 
```

即`8 ** 2`, 即`64`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-30T20:25:05.737

如果您指的是“运算符关联性” - 它是一种语言如何确定相同优先级的运算符在没有括号的情况下如何分组。

例如，基于 C 语言的 + 和 - 运算符具有相同的优先级。当您编写一个同时使用它们（不带括号）的表达式时，编译器必须确定以什么顺序评估它们。

如果你写 12 - 5 + 3，可能的评估包括：

1.  (12 - 5) + 3 = 10
2.  12 - (5 + 3) = 4

根据您评估表达式的顺序，您可以获得不同的结果。在基于 C 的语言中，+ 和 - 具有左结合性，这意味着上面的表达式将作为第一种情况进行计算。

所有语言对优先级和关联性都有严格定义的规则。您可以在此处了解有关[C#](http://msdn.microsoft.com/en-us/library/aa691323(VS.71).aspx)规则的更多信息。操作符[关联性](http://en.wikipedia.org/wiki/Operator_associativity)和[优先级](http://en.wikipedia.org/wiki/Order_of_operations)的一般概念在维基百科中有很好的介绍。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T20:12:34.420

我假设您的意思是运算符关联性...

这是将操作数绑定到运算符的顺序。基本上：

a - b + c

可能被评估为（假设 - 和 + 具有相同的优先级）：

((a - b) + c) 或
(a - (b + c))

如果运算符是左关联的（立即绑定到左操作数），它将被评估为第一个。如果它们是右结合的，它将被评估为第二个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T20:13:23.500

如果您的意思是运算符关联性：

它定义了解析表达式的方式。它提供了一个标准，因此每个表达式都以相同的方式解析。

当可能存在副作用时，这对于具有相同优先级的操作最为重要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T22:05:50.667

前面的大多数示例都使用了常量。如果参数恰好是函数调用，则调用的顺序可能由关联规则确定，当然这取决于您的编译器。如果这些功能有副作用..

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-22T10:12:49.260

我们都知道优先级很重要，但解释表达式含义时的关联性也很重要。对于一个非常简单的介绍，请尝试[Power of Operators](http://www.i-programmer.info/babbages-bag/667-operators.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-26T04:31:51.010

关联性属于编程语言概念中的计算顺序。计算顺序决定了表达式的含义。它有两个主要规则，

> 1.  优先规则
> 2.  关联规则

优先规则定义了评估不同类型的“相邻”运算符的顺序。每种编程语言都有关于其运算符的自己的运算符优先级表。

回到关联性，

它定义了具有相同优先级的相邻操作的执行顺序。它有3种口味，

> 左结合性
> 右结合性
> 非结合性

如果一个运算符是左结合的，它从左到右求值，同样，如果它是右结合的，它从右到左求值。

# google-search - 有效的谷歌搜索短名称

> ID：930488
> 
> 赞同：1
> 
> 时间：2009-05-30T20:10:10.447
> 
> 标签：google-search

时不时地，我需要在一种非常小的语言中查找一些关键字或函数，和/或具有特殊字符。
示例包括
python 中的“as”关键字（“python as”、“python as 关键字”。 . 等不起作用）
像 '$:' 在 ruby​​ 中的东西（想知道它代表什么） irb 等
中的 'p' 命令

谷歌在这样的搜索上完全让我失望了。在 SO 上提出这样愚蠢的问题是不值得的。语言文档通常不能正确解释这些（或者如果确实如此，如果没有谷歌的帮助，我不知道在哪里寻找）

在这种情况下你能做什么？如何诱使谷歌找到此类问题的答案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T20:16:44.910

使用引号有很大帮助。例如，如果您搜索：

```
python "as keyword" 
```

那么第一个命中是["The as keyword ((An Unofficial) Python Reference Wiki)"](http://pyref.infogami.com/as)。其他点击也与“as”关键字有关。

除此之外，我会寻找处理*所有*Python 关键字的页面，并找到相关条目。

但是，对于符号来说，这要困难得多。拥有正确的术语会有很大帮助 - 如果您知道“？：”是 C# 中的条件运算符，那么查找起来会更容易。这就是一本好书（或再次，运算符/关键字列表）有助于将符号放入语言的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T20:13:13.453

那么对于 ruby​​，你为什么不搜索 ruby​​ 内置全局变量？我假设你对你要找的东西有足够的了解，你可以描述它吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T20:42:45.360

对于符号，我经常需要输入符号（尽管谷歌在符号方面做得越来越好。）

例如： [http](http://www.google.com/search?q=unix+%22dot+dot%22) ://www.google.com/search?q=unix+%22dot+dot%22 或 [http://www.google.com/search?q=ruby+%22dollar+sign%22](http://www.google.com/search?q=ruby+%22dollar+sign%22)

# windows - 生成单 EXE Windows 应用程序的语言？

> ID：930504
> 
> 赞同：0
> 
> 时间：2009-05-30T20:15:31.903
> 
> 标签：windows, user-interface, programming-languages

我想知道有哪些工具可以生成单 EXE Windows 应用程序，即。将所有库编译成一个 EXE，没有任何依赖关系。

我知道这些：

*   德尔福
*   PowerBasic 和其他非 OO 编译器，如 FirstBasic 等。
*   真实基础
*   C/C++

你有其他工具吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T20:35:03.907

如果您愿意，可以很容易地将各种 .NET 文件合并到一个文件中。

[http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T20:24:45.723

Visual C++ 6。Windows 附带 MFC，或者您可以只写入 Win32 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T20:34:41.770

如果您选择正确的静态链接选项，您也可以使用现代 Visual C++ 来执行此操作。

另一种选择是使用正确的方案在与可执行文件相同的目录中提供所有并行程序集。但是你的程序集[不会被 Windows Update 更新。](http://support.microsoft.com/kb/835322)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T22:41:15.057

我相信[仍然存在](http://www.activestate.com/perl_dev_kit/features/)编译为本机二进制文件（处理多个目标平台）的 Perl 编译器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T22:50:19.173

Fortran。它被称为[静态链接](http://en.wikipedia.org/wiki/Static_library)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-30T20:32:20.543

对于预装了 .NET 框架的现代 Windows 版本，任何 .NET 语言都是显而易见的选择……VB.NET 和 C# 也有那些不错的 GUI 构建器 :)

这是我想的 M$ 答案，因为他们会说 .NET 不是依赖项，因为它现在是 Windows 的核心部分。至少对于那些运行 Windows 2000 的人来说不是这样。

# javascript - 如何使用 WSH -Jscript 与程序交互

> ID：930508
> 
> 赞同：0
> 
> 时间：2009-05-30T20:16:51.433
> 
> 标签：javascript, desktop-application, wsh, interaction

我正在尝试使用 WSH 单击系统托盘中应用程序上的按钮。这可能吗？有人可以提供一个用 Jscript 编写的示例吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T20:30:47.630

不，除非程序本身提供 COM 工具（例如 Office 和 IE 这样做），否则这是不可能的。绝大多数程序无法检测。WSH 提供了非常基本的 shell 访问，据我所知，它根本不提供对通知区域的访问。

您可能需要其他一些工具来执行此操作。虽然我不确定一个确切的程序，但我确信谷歌可以在“Windows 自动化”领域产生一些东西。

# javascript - 在图像上绘制一个框，仅 javascript？

> ID：930512
> 
> 赞同：1
> 
> 时间：2009-05-30T20:19:54.327
> 
> 标签：javascript

我想做的是让用户上传他的图片。完成后，它将在同一页面上显示图像而无需刷新。这是我需要弄清楚的部分，我如何让用户在图像中选择一个框？所以当用户完成时我可以裁剪它？（使用 ImageMagick）。

如果可能的话，我希望用户可以拉伸边框以编辑宽度和高度。然后在矩形内单击以移动。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T20:26:29.993

有很多方法；包括几个可通过网络获得的预先编写的插件。

你在使用任何框架吗？

在以下内容中，我使用了 Jcrop 和 Lasso.Crop，它们的效果都很好。其他的没试过。

这是一个非详尽的清单：

**纯Javascript**

[http://www.dhtmlgoodies.com/index.html?whichScript=image-crop](http://www.dhtmlgoodies.com/index.html?whichScript=image-crop)

**jQuery**

[http://deepliquid.com/content/Jcrop.html](http://deepliquid.com/content/Jcrop.html)

**MooTools**

[http://www.nwhite.net/2009/02/25/lassocrop-preview/](http://www.nwhite.net/2009/02/25/lassocrop-preview/)

**原型**

[http://www.defusion.org.uk/code/javascript-image-cropper-ui-using-prototype-scriptaculous/](http://www.defusion.org.uk/code/javascript-image-cropper-ui-using-prototype-scriptaculous/)

# delphi - 在 Delphi 7 中设置 EXE 图标

> ID：930515
> 
> 赞同：10
> 
> 时间：2009-05-30T20:21:45.573
> 
> 标签：delphi, icons, delphi-7

我正在尝试自定义在我的 Delphi 应用程序的 Windows 资源管理器和桌面快捷方式中显示的图标。

在 Delphi 7 IDE 中，我已经在 Project Options 对话框的 Application 选项卡中加载了所需的图标。它将我想要的图标显示为图形。

我认为没有必要，但我也将我的图标设置为 TMainForm Icon 属性。

但是，生成的 EXE 仍显示默认的 D7 图标。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T20:34:21.303

经过更多的狩猎，我找到了它。我通过从另一个文件夹复制现有项目来创建一个新项目。我忘记更改 DPR 文件顶部的程序名称以匹配新项目的名称。不知何故，如果在那里使用了错误的名称，它会阻止图标在生成的 EXE 文件中被更改......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-08T15:10:16.303

当您将图标分配给应用程序时，图标将嵌入到与程序名称（在 .dpr 文件的第一行中提到的名称）名称相同的 .res 文件中。当您更改 .dpr 文件中的程序名称时，delphi 会使用新的程序名称创建一个新的 .res 文件，并在新的 res 文件中查找图标资源并没有找到，因此使用默认图标（或矩形白色盒子）。旧的带有图标资源的 res 文件将不再使用。总之，如果您更改程序名称，您将不得不重新分配图标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T20:33:25.517

也许需要删除图标缓存。关于这个问题有很多页面，这个链接可能有用：[http ://smallvoid.com/article/windows-icon-cache.html](http://smallvoid.com/article/windows-icon-cache.html)

# python - 如何在被 Python 杀死之前运行最后一个函数？

> ID：930519
> 
> 赞同：30
> 
> 时间：2009-05-30T20:22:53.840
> 
> 标签：python, function, interrupt, exit

有没有办法在运行的 Python 脚本被其他脚本、键盘中断等杀死之前运行最后一个命令？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-30T20:29:50.813

```
import time

try:
    time.sleep(10)
finally:
    print "clean up"

clean up
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
KeyboardInterrupt 
```

如果需要捕捉其他操作系统级别的中断，看信号模块：

[http://docs.python.org/library/signal.html](http://docs.python.org/library/signal.html)

### 信号示例

```
from signal import *
import sys, time

def clean(*args):
    print "clean me"
    sys.exit(0)

for sig in (SIGABRT, SIGBREAK, SIGILL, SIGINT, SIGSEGV, SIGTERM):
    signal(sig, clean)

time.sleep(10) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-30T20:32:14.617

您可以使用该`atexit`模块。使用它，您可以注册一个将在程序终止时调用的函数。这里的一个例子：http: [//docs.python.org/library/atexit.html](http://docs.python.org/library/atexit.html)

```
try:
    _count = int(open("/tmp/counter").read())
except IOError:
    _count = 0

def incrcounter(n):
    global _count
    _count = _count + n

def savecounter():
    open("/tmp/counter", "w").write("%d" % _count)

import atexit
atexit.register(savecounter) 
```

您还可以将位置和关键字参数传递给要在程序终止时调用的函数。

请注意，文档中列出了一些不会调用您的处理程序的情况：

> **注意**：当程序被未由 Python 处理的信号杀死、检测到 Python 致命内部错误或被调用时，不会调用通过此模块注册的函数[`os._exit()`](https://docs.python.org/3/library/os.html#os._exit)。

因此，您可能还想注册一个信号处理程序。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-30T20:24:34.257

```
import signal
import sys
import time

def cleanup(*args):
    print 'Exiting'
    sys.exit(0)

signal.signal(signal.SIGINT, cleanup)
signal.signal(signal.SIGTERM, cleanup)
while True:
    time.sleep(60)  # less busy loop 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-01-03T09:55:32.433

向“未知”道歉，因为他们接受了他们的答案并进行了更正，就好像这是我自己的答案一样，但我的编辑被拒绝了。

批准的答案包含将导致段错误的错误。

您不能在信号处理程序中使用 sys.exit()，但可以使用 os._exit 使其变为：

```
from signal import *
import os, time

def clean(*args):
    print "clean me"
    os._exit(0)

for sig in (SIGABRT, SIGINT, SIGTERM):
    signal(sig, clean)

time.sleep(10) 
```

如果目标平台是 Windows，则可以使用 SIGBREAK。

根据用例和在发生致命错误时清理的需要 - 您可以添加 SIGSEGV 和 SIGILL 但通常不建议这样做，因为程序状态可能会导致您创建无限循环。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-30T20:32:20.683

使用 atexit 模块注册一个将在最后调用的函数。

```
import atexit
atexit.register(some_function) 
```

# javascript - 如何通过 JavaScript 在新的浏览器窗口中仅打开外部链接？

> ID：930525
> 
> 赞同：0
> 
> 时间：2009-05-30T20:25:45.003
> 
> 标签：javascript

我知道这是一个常见的要求，并且在野外有很多答案。如果有人能提供一个正确的脚本，在新窗口中只打开 HTML 文件的外部链接，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T20:34:55.717

您可以为此使用 jQuery：

```
$(document).ready(function(){  
    $("a[href^='http']:not([href*='"+location.hostname+"'])").attr("target","_blank");  
}); 
```

它应该匹配 http 和 https 链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T20:40:03.257

我在自己的网站上使用了一点 JavaScript。然后我有一个样式设置来修改链接（它添加了一个小图像/地球，有点像 MSDN。通过修改目标属性使链接在新页面中打开也很简单。

```
if (document.links) {              
    for (var i = 0; i < document.links.length; i++) {
        l = document.links[i].href;
        if (l.indexOf('http://www.mysite.com')!=0 &&
            l.indexOf('http://udv.mysite.com')!=0 &&
            l.indexOf('http://')==0 ) {
            c = document.links[i];
            if (c.className == "dontModify") continue;
            c.className = c.className + " external";
            if (c.title != "") {
                c.title = "External link: " + c.title;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T20:34:11.430

具体代码将决定您是使用纯 DOM 脚本还是任何 Javascript 框架。但一般来说，这是你要做的：

1.  为所有锚点设置 onclick 回调。

2.  在您的回调中，检查`href`链接的属性是否指向外部站点。您可以使用多种方法来执行此操作，但最简单的方法可能是 URL 上的简单正则表达式。

3.  如果不是外部的，则允许链接正常进行（即，返回 true 等）。

4.  如果是外部的，在新窗口中打开，然后返回false。

在 Javascript 中打开一个新窗口很容易：

`window.open('http://www.google.com');`

# javascript - 在 javascript 数组中查找元素哪个更快？

> ID：930536
> 
> 赞同：0
> 
> 时间：2009-05-30T20:29:42.170
> 
> 标签：javascript, performance, arrays

我是一个菜鸟，写了一个完整的程序，却不知道在数组中查找元素的简单方法......

```
my_array.indexOf("find this value"); 
```

indexOf 是否比存储数组中有多少元素并循环遍历数组直到找到所需的元素要好得多？我本可以大大简化我的代码。

我试图通过使用多个数组并存储键来使查找时间恒定。它使插入/删除速度变慢，因为我必须更新密钥。

我应该只使用 indexOf 吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T20:32:15.130

大多数情况下，您最好使用已针对您提出的任何解决方案进行优化的本机功能。但是，除此之外，您还谈到了在数组中存储元素的数量。`.length`不确定当数组具有属性时为什么要这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T20:55:48.670

Javascript 基本上有两种类型的集合：数组和哈希图。两者都有点特别。哈希映射只是一个具有命名属性的对象。键是用于直接访问值的字符串。这是一个例子：

```
// create the hash map
var hashMap = {};
// add a value
var key = "John Dillinger";
hashMap[key] = "Criminal";
// retrieve the value
var stuff = hashMap[key]; 
```

Javascript 数组具有双重功能。它们当然是数组，但也是堆栈。堆栈遵循“后进先出”规则。这是数组和堆栈的示例：

```
// Array example
var anArray = []; // or: var anArray = new Array();
anArray[0] = "some value";
alert(anArray[0]); // pops up "some value"
// Stack example
var stack = [];
stack.push("first");
stack.push("second");
alert(stack.pop()); // pop up "second" 
```

最后，对于一些问题，链表可以派上用场。为此，您使用一个对象。像这样的东西：

```
var linkedList = {value: "stuff"};
linkedList.next = {value: "other"};
linkedList.next.next = {value: "yet another value"};
// Traverse the list
var node = linkedList;
while(node) {
  alert(node.value)
  node = node.next;
} 
```

鉴于您描述的问题，我会使用哈希图。只要记住为任何给定的问题选择正确的集合类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T20:32:20.857

[您可以在 javascript](http://weblogs.asp.net/ssadasivuni/archive/2003/09/17/27902.aspx)中使用哈希表实现将值映射到数组索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T21:43:32.037

本机函数应该更快，因为它将是运行时引擎预编译的代码。

然而，indexOf 直到 1.6 版才实现，这意味着它在 jscript/IE afaik 中不起作用。

但在这种情况下，我只会为它设计一个解决方法。本机函数通常是您的最佳选择。

但是，在您的情况下，您似乎想要一个哈希图，正如 Helgi 指出的那样，它在 js 中只是一个常规对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T21:26:25.690

该`indexOf`方法的实现很可能只是在数组上循环，直到找到请求的值，因为在一般情况下，这就是您*所*能做的。使用它会清理你的代码，但不太可能让它更快。（有[更快](http://en.wikipedia.org/wiki/Binary_search)的搜索数组的方法，但它们有一定的限制和/或前期成本。）

您应该为工作使用正确的数据结构。数组适用于顺序很重要的情况。如果您发现自己经常搜索它们，您可能应该使用散列代替。散列是无序的，但查找在恒定时间内发生（无搜索）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-07-09T21:01:53.607

我已经实现了 javascript HashMap，可以从[http://github.com/lambder/HashMapJS/tree/master获取代码](http://github.com/lambder/HashMapJS/tree/master)

这是代码：

```
/*
 =====================================================================
 @license MIT
 @author Lambder
 @copyright 2009 Lambder.
 @end
 =====================================================================
 */
var HashMap = function() {
  this.initialize();
}

HashMap.prototype = {
  hashkey_prefix: "<#HashMapHashkeyPerfix>",
  hashcode_field: "<#HashMapHashkeyPerfix>",

  initialize: function() {
    this.backing_hash = {};
    this.code = 0;
  },
  /*
   maps value to key returning previous assocciation
   */
  put: function(key, value) {
    var prev;
    if (key && value) {
      var hashCode = key[this.hashcode_field];
      if (hashCode) {
        prev = this.backing_hash[hashCode];
      } else {
        this.code += 1;
        hashCode = this.hashkey_prefix + this.code;
        key[this.hashcode_field] = hashCode;
      }
      this.backing_hash[hashCode] = value;
    }
    return prev;
  },
  /*
   returns value associated with given key
   */
  get: function(key) {
    var value;
    if (key) {
      var hashCode = key[this.hashcode_field];
      if (hashCode) {
        value = this.backing_hash[hashCode];
      }
    }
    return value;
  },
  /*
   deletes association by given key.
   Returns true if the assocciation existed, false otherwise
   */
  del: function(key) {
    var success = false;
    if (key) {
      var hashCode = key[this.hashcode_field];
      if (hashCode) {
        var prev = this.backing_hash[hashCode];
        this.backing_hash[hashCode] = undefined;
        if(prev !== undefined)
          success = true;
      }
    }
    return success;
  }
}

//// Usage

// creation

var my_map = new HashMap();

// insertion

var a_key = {};
var a_value = {struct: "structA"};
var b_key = {};
var b_value = {struct: "structB"};
var c_key = {};
var c_value = {struct: "structC"};

my_map.put(a_key, a_value);
my_map.put(b_key, b_value);
var prev_b = my_map.put(b_key, c_value);

// retrieval

if(my_map.get(a_key) !== a_value){
  throw("fail1")
}
if(my_map.get(b_key) !== c_value){
  throw("fail2")
}
if(prev_b !== b_value){
  throw("fail3")
}

// deletion

var a_existed = my_map.del(a_key);
var c_existed = my_map.del(c_key);
var a2_existed = my_map.del(a_key);

if(a_existed !== true){
  throw("fail4")
}
if(c_existed !== false){
  throw("fail5")
}
if(a2_existed !== false){
  throw("fail6")
} 
```

好胃口，羊肉

# asp.net-mvc - 构建日历/事件应用程序（视图）的好方法是什么？

> ID：930547
> 
> 赞同：1
> 
> 时间：2009-05-30T20:32:39.170
> 
> 标签：asp.net-mvc, calendar

我想为我的网站构建一个日历“组件”。我想让它在未来易于管理和扩展。我不会将它用于任何其他网站，但它希望使其独立于网站的其余部分。该网站是使用 ASP.NET MVC 构建的。

我想包含不同的视图（月、周、日[甚至可能是年]）。我计划使用不同的方式向用户展示信息：

*   图标
*   着色（周，小时，周期[！]）
*   弹出屏幕

这些信息需要根据其他（.NET）模型中包含的信息来显示。我希望正确分离这个逻辑。

我相当擅长 javascript，因此我将能够构建一个很好的界面，用于在日历上拖放事件并浏览日历日期。但是我也希望组件在没有 javascript 的情况下也能工作。

**我应该从头开始构建这个组件吗？如果是这样，您能否命名为构建组件而创建的不同部分？**

**或者**

**我可以更改 .NET 日历控件以满足我的需要吗？**

感谢您的输入！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T20:46:37.190

我在这里有*很大的*偏见，但看看[谷歌日历](http://calendar.google.com)做了什么。在我看来，这是一个非常非常好的日历 Web UI。

我的主要建议是期待它是一种痛苦。特别是，这些“轴”中的每一个都增加了一个额外数量级的复杂性：

*   与其他日历客户端（例如 iCal 或 ActiveSync）互操作
*   与其他日历服务器（例如 Google 日历）互操作
*   处理时区（不要*假设*时区只是与 UTC 的偏移量！您需要了解更多信息，以便预测夏令时何时开始，考虑历史/未来变化等）
*   处理经常发生的事件（如果你不小心，最终可能会变得任意复杂）
*   处理共享事件（例如会议）
*   处理共享访问（例如，用户 X 是用户 Y 的秘书，有权做各种事情）
*   处理本地化（每种文化以不同的方式显示其日期）
*   处理不同的日历类型（您需要支持科普特日历等吗？）

当你把所有这些结合起来时，你最终会感到非常痛苦。找出您真正需要涵盖的内容，并排除其他所有内容。尝试*永久*排除它（并且明确地 - 保留一份您*不*打算支持的事情的文件，并获得管理层的批准）。

全面披露：我在移动设备上使用[Google Sync ，主要是在日历方面。](http://www.google.com/mobile/default/sync.html)你不会相信出现的一些极端案例。我的开发空间基本上是由角落组成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T20:45:06.993

如果您可以重复使用并可能改进已经很好的轮子，为什么还要重新发明轮子？

尝试查看它使用[Javascript API的](http://dhtmlx.com/docs/products/docsExplorer/index.shtml?node=dhtmlxscheduler)[DHTMLxScheduler](http://dhtmlx.com/docs/products/dhtmlxScheduler/index.shtml) ，这样您就可以做您需要的一切......

你可以阅读更多关于[WebAppers 条目](http://www.webappers.com/2009/05/27/lightweight-highly-customizable-ajax-events-calendar/)

在我们今天的世界上，我们应该重复使用而不是一次又一次地发明一些东西……至少我是这个想法的道歉者。

> 开源 - GPL 允许您在 GPL 项目中免费使用 dhtmlxScheduler。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T22:08:39.273

我肯定会阻止你建立自己的。想一想。

如果您预计构建日历会花费您 X 个小时，那么您应该花费 X/10 个小时来寻找一个日历：

1.  甚至接近您需要的一半。在最坏的情况下，您会浪费 10% 的时间，而可能会节省 50% 的时间。我知道那里有数百个日历，因此您可能会找到一个几乎完全符合您需求的日历，即渐进式渲染等等（拖放是您可能需要自己做的事情）。

2.  拥有适合您需求的许可证。他们中的大多数人都拥有自由许可证，因为它是如此常见的控制。

3.  如果日历的采用率很高，那么您的情况会更好，因为它将在野外进行测试，因此错误更少，但是您的日历将继续在数月后的大量浏览器中显示错误。当您可以花同样的时间编码功能时，您真的不想花时间修复错误。如果社区很大，它甚至可能有很酷的功能，你甚至可以在没有想到它们的情况下免费获得它们（比如在某些国家，将一周的开始时间从周一改为周日）。

您可以将节省的时间集中在拖放功能上，并根据需要调整日历。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T06:59:58.037

我同意其余的答案...您可以为此使用一些库，例如 jquery ui calendar：

[http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)

干杯

# asp.net-mvc - 将 SelectList "SelectedValue" 传递给控制器 操作方法

> ID：930560
> 
> 赞同：2
> 
> 时间：2009-05-30T20:41:16.797
> 
> 标签：asp.net-mvc, selectlist

我有一个注册表单，其中显示了用户名（文本框）、电子邮件（文本框）和部门（SelectList）。名称和电子邮件已预先填充（我使用的是 Windows 身份验证、Intranet 应用程序），并且我想将 DropDown 中的 SelectedValue 作为 Int32 发送到我的控制器，我不想将整个 SelectList 发回。这个列表现在很小，但会增长到相当大的规模。

我有一个名为 的类`RegistrationViewModel`，它包含这些字段的公共属性。但是，当我使用`SelectList`DivisionList 时，我收到此错误：`No parameterless constructor defined for this object.`.

如果我更改类型，它没有问题，但 Division 为 null 或 0。有没有办法将 SelectedValue 从 DropDown 传递给控制器​​ Action 方法作为 Int32？

# 编辑1：

我不太确定自己在做什么，我已经使用 MVC 大约 48 小时，观看了 PDF、TechEd 和 TechDays 视频。

抱歉，这是我的控制器代码：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Register(RegistrationViewModel rvm)
{
    IApplicationContext context = ContextRegistry.GetContext();
    IValidationErrors errors = new ValidationErrors();

    IValidator validator = (IValidator)context.GetObject("RegistrationValidator");
    bool valid = validator.Validate(rvm, errors);

    if (valid)
        repo.SaveRegistration();
    else
        ViewData["DivisionList"] = repo.GetDivisions();

    return View(rvm);
} 
```

`RegistrationViewModel`班级

```
public class RegistrationViewModel
{
    public string Name { get; set; }
    public string Email { get; set; }
    //public SelectList DivisionList { get; private set; }
    public int Division { get; set; }    
} 
```

这是视图

```
<%@ Page Language="C#" 
MasterPageFile="~/Views/Shared/Site.Master" 
Inherits="System.Web.Mvc.ViewPage<RegistrationViewModel>" %>

<%@ Import Namespace="Project1.Entities"%>
<%@ Import Namespace="Project1.Models"%>

<asp:Content ID="registerTitle" ContentPlaceHolderID="TitleContent" runat="server">
    Register
</asp:Content>

<asp:Content ID="registerContent" ContentPlaceHolderID="MainContent" runat="server">
...
    <% using (Html.BeginForm())
       { %>
        <div>
            <fieldset>
                <legend>Account Information</legend>
                <p>
                    <label for="name">Name:</label>
                    <%= Html.TextBox("Name", User.Identity.Name.GetDisplayName()) %>
                    <%= Html.ValidationMessage("username") %>
                </p>
                <p>
                    <label for="email">Email:</label>
                    <%= Html.TextBox("email", User.Identity.Name.GetEmailFromLogin()) %>
                    <%= Html.ValidationMessage("email") %>
                </p>              
                <p>
                    <label for="division">Division:</label>
                    <%= Html.DropDownList("DivisionList", ViewData["DivisionList"] as SelectList)%>
                    <%= Html.ValidationMessage("confirmPassword") %>
                </p>
                <p>                
                    <input type="submit" value="Register" />
                </p>
            </fieldset>
        </div>
    <% } %>
</asp:Content> 
```

# 编辑2：

Eilon：这也是我改变它的地方：

控制器：

```
public ActionResult Register()
{
  ViewData["DivisionList"] = repo.GetDivisions();
  return View();
} 
```

看法：

```
<%= Html.DropDownList("DivisionValue", ViewData["DivisionList"] as SelectList)%> 
```

我收到此异常：没有具有“IEnumerable”类型的键“DivisionValue”的 ViewData 项。

当我将视图更新为：

```
<%= Html.DropDownList("DivisionList", ViewData["DivisionList"] as SelectList)%> 
```

它工作得很好！只有在所有“部门”项目名称相同的情况下，它似乎才有效。如果我更改名称，View 崩溃或 ViewModel“Division”属性被发送为 0。

这是为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T00:57:45.640

**RegistrationViewModel**类型应该包含一个简单类型的属性，例如：

```
public string DivisionValue { get; set; } 
```

或者将类型更改为 int、DateTime 或任何适当的类型。

在 HTML 和 HTTP 中，为下拉列表返回的唯一内容是字段的名称和选定的值。

要使所有内容匹配，您还需要更改视图以为下拉列表呈现不同的输入名称：

```
<%= Html.DropDownList("DivisionValue", ViewData["DivisionList"] as SelectList)%> 
```

请注意，我使用“DivisionValue”是列表的*值*，*DivisionList*作为所有可用项目的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T05:41:56.257

我只是对`SelectList`类型更明确。我建议`SelectList`在控制器操作中创建并忘记将其投射到视图中。我的代码是这样工作的（CRUD 编辑页面）：

..在行动中：

```
 ViewData["WorkType.ID"] = new SelectList(this._vacancySvc.GetVacancyWorkTypes(),
            "ID", "Name", ViewData["WorkType.ID"] ?? vacancy.WorkType.ID); 
```

..在视图中：

```
<p><% =Html.Encode("Work Type:") %><br />
            <% =Html.DropDownList("Worktype.ID")%><span class="smallgrey">(required)</span><br /> 
```

.. 通过使用 [null 合并运算符][1] (??)，您可以看到初始选择（来自 DB）或来自回发的 ViewData（例如，如果表单验证失败）。

此外，如果我重构此代码，我可能会像您一样使用 ViewModel 对象。唯一的事情是：（1）你永远不需要在`SelectList`视图中引用 ViewModel 属性，因为 MVC 会通过`Html.DropDownList()`重载自动为我们绑定它。（2）我仍然需要在操作中引用 ViewData从失败的验证帖子中获取选定的值，那么真正的意义何在？

# php - PHP + MySQL 错误

> ID：930574
> 
> 赞同：-1
> 
> 时间：2009-05-30T20:47:54.770
> 
> 标签：php, mysql, syntax

```
if ($_POST) {$content = stripslashes($_POST['content']);
    $by = $_SESSION['exp_user']['username'];
    $dt = date("F j, Y, g:i a"); 
    mysql_query("UPDATE tbl_intmsg SET time = ".$dt.", by = ".$by." AND content = ".$content."") or die(mysql_error()); 
```

我收到错误：

> 您的 SQL 语法有错误；查看与您的 MySQL 服务器版本相对应的手册，了解在 '26, 2009, 2:28 pm, by = shamil.nunhuck AND content = Test message 附近使用的正确语法！' 在第 1 行

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T01:04:46.623

您也可以考虑使用预期功能清理您的输入：

```
mysql_real_escape_string() 
```

见：[http ://uk3.php.net/manual/en/function.mysql-real-escape-string.php](http://uk3.php.net/manual/en/function.mysql-real-escape-string.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T01:37:57.680

是的，当 MySQL 服务器读取 SQL 时，它看起来像这样：

```
UPDATE tbl_intmsg SET time = 26, 2009, 2:28 pm, by = shamil.nunhuck 
    AND content = Test message! 
```

MySQL 如何弄清楚该语句中的内容是什么？

例如，想象一下，您将 $content 设置为“0 WHERE dummy = true”。然后您的 SQL 将如下所示：

```
UPDATE tbl_intmsg SET time = 26, 2009, 2:28 pm, by = shamil.nunhuck 
    AND content = 0 WHERE dummy = true 
```

你看到问题了吗？SQL是如何弄清楚你的数据是什么，SQL关键字是什么？

答案是：引号！

您的 SQL 应如下所示：

```
UPDATE tbl_intmsg SET time = '26, 2009, 2:28 pm', by = 'shamil.nunhuck' 
    AND content = 'Test message!' 
```

您的 PHP SQL 查询字符串可能如下所示：

```
$q="UPDATE tbl_intmsg SET time = '$dt', by = '$by' AND content = '$content'"; 
```

（请注意，PHP 会解析双引号字符串中的变量并将其替换为它们的值。另外请注意，您应该使用上述函数

```
mysql_real_escape_string($var) 
```

在将数据放入 MySQL 之前对其进行清理。这是 mechler 无法发布的链接：[php.net/mysql-real-escape-string](http://php.net/mysql_real_escape_string) )

干杯!

/0

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T20:50:07.573

在你的字符串变量周围加上 SQL 引号：

```
UPDATE tbl_intmsg SET time = \"".$dt."\", by = \"".$by."\" AND content = \"".$content."\" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T20:48:36.360

啊，废话，这是答案：

```
$db = mysql_query("UPDATE `tbl_intmsg` SET `time` = '".$dt."', `by` = '".$by."', `content` = '".$content."'"); 
```

# python - Python应用引擎；获取用户信息和发布参数？

> ID：930578
> 
> 赞同：2
> 
> 时间：2009-05-30T20:48:40.510
> 
> 标签：python, google-app-engine

我正在查看谷歌提供的关于如何开始使用 python 的示例；特别是此处发布的代码；[http://code.google.com/appengine/docs/python/gettingstarted/usingdatastore.html](http://code.google.com/appengine/docs/python/gettingstarted/usingdatastore.html)

我想倾斜的是，在这里：

```
class Guestbook(webapp.RequestHandler):
  def post(self):
    greeting = Greeting()

    if users.get_current_user():
      greeting.author = users.get_current_user()

    greeting.content = self.request.get('content')
    greeting.put()
    self.redirect('/') 
```

他们正在保存评论，如果用户登录，我们保存用户；如果它不是空的，当我们将它从数据库中取出时，我们实际上会在这里检查：

```
 if greeting.author:
    self.response.out.write('<b>%s</b> wrote:' % greeting.author.nickname())
  else:
    self.response.out.write('An anonymous person wrote:') 
```

所以我想要的是使用 User 对象来获取信息，如下所示：

```
class Guestbook(webapp.RequestHandler):
    def post(self):
        user = users.get_current_user()
        if user:
            greeting = Greeting()
        if users.get_current_user():
            greeting.author = users.get_current_user()
            greeting.content = self.request.get('content')
            greeting.put()
            self.redirect('/')
        else:
            self.redirect(users.create_login_url(self.request.uri)) 
```

所以，我想用该代码做的是将用户发送到登录网址（如果他没有登录）；然后带着他在帖子中的所有内容回来并实际发布。但是发生的事情是它甚至没有达到那个动作，因为帖子中什么都没有。我知道我可以在会话中放一些东西并在留言簿的获取操作中检查它，但我想检查是否有人能提出更好的解决方案！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T01:33:47.173

问题是，`self.redirect`不能“携带” `POST`HTTP 请求的有效负载，因此（从`post`方法）重定向到 login-url &c 会出现异常行为（事实上，我相信登录 URL 将`get`在完成后继续使用，并且没有办法要求它`post`代替）。

如果您不想将该`POST`有效负载存储在某个地方（会话或其他），您可以通过将`def post`上面代码段`def get`中`action="post"`的没有剪到`action="get"`。还有其他一些小的解决方法（您可以接受`post`来自已登录用户的“正常”消息并将它们重定向到`get`如果他们尚未登录可能会做一些更简单的事情），但我认为这些信息足以帮助您继续从这里，对吧？

# c# - app.configs 和 MSTest 项目 - 连接字符串的空引用

> ID：930585
> 
> 赞同：8
> 
> 时间：2009-05-30T20:51:36.870
> 
> 标签：c#, .net, unit-testing, app-config

当我尝试运行单元测试（mstest）时，我遇到了这个问题。
代码行：

```
_mainCnStr = System.Configuration.ConfigurationManager.
               ConnectionStrings["main"].ConnectionString; 
```

作为空引用返回

当我运行它时，它不会在主 UI 项目中执行此操作。获取单元测试项目看到的此连接字符串设置的正确方法是什么？我尝试嵌入作为资源。我试过总是复制。为我解决此问题的正确设置组合是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-30T21:41:31.947

使用 MSTest 需要注意的一件事（至少来自 IDE）；它不会在常规输出 (bin) 文件夹中运行测试，并且不尊重项目的文件包含（“复制到输出目录”）。您经常需要明确告诉它 (MSTest) 哪些文件要放入测试区域。您需要在此列表中包含“app.config”；通过 testrunco​​nfig（“部署”），或者通过向[`[DeploymentItem]`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.webtesting.deploymentitemattribute(VS.80).aspx)受影响的测试夹具添加属性（）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-30T20:52:53.030

您应该`app.config`在单元测试项目中添加一个。它不会自动使用 UI 应用程序中的设置`app.config`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T20:53:44.667

我假设 mstests 像 nunit 测试一样嵌入在由测试应用程序加载的单独程序集中？在这种情况下，您可能需要创建一些加载到配置文件中的测试设置代码。

# string - 我应该如何在方法中测试 null 和/或空字符串参数？

> ID：930594
> 
> 赞同：9
> 
> 时间：2009-05-30T20:54:37.737
> 
> 标签：string, testing, parameters, null

通常有带有字符串参数的类的方法必须再次验证 null 或空，例如这个例子：

```
public class MyClass {

    public void MyMethod(string param){

        if(string.IsNullOrEmpty(param)){
            throw new ArgumentNullException(...);
        }
        //...
    }
} 
```

很明显，对于两个（无效）值，该方法的行为是相同的。这是一种很常见的情况，当谈到测试这些方法时，我总是怀疑如何去做。我总是为这些情况创建两个单独的测试：

```
[TestClass]
public class Tests {

    [TestMethod]
    public void MyMethod_should_fail_if_param_is_null(){
        //...
        myclass.MyMethod(null);
        //...
    }

    [TestMethod]
    public void MyMethod_should_fail_if_param_is_empty(){
        //...
        myclass.MyMethod("");
        //...
    } 
```

}

但我看到太多冗余。这些测试完全相同，唯一的区别是传递给方法的参数。这让我非常困扰，因为我必须为每个字符串参数创建两个测试。具有 3 个参数的方法将只有 6 个测试来测试参数。

我认为这是测试这些参数的正确方法，但是如果我知道 99% 的字符串参数将以相同的方式进行验证，那么最好只测试它们是否为空（或空）并假设其中的行为其他情况会一样吗？

我想知道你对此有何看法。我知道我要问的是技术意见而不是技术问题，但我认为测试社区可能对这种情况有一些有趣的说法。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T21:02:22.463

我个人会*考虑*对所有参数使用单个测试。这不遵循单元测试的正常教条，但它增加了测试的可读性（通过最小化专门用于非常重复的案例的测试代码的数量）并且没有太多的缺点。是的，如果测试失败，您不知道在第一次失败之后的所有检查是否也会失败——但这在实践中*真的*是个问题吗？

重要的一点是确保您有一条捷径来测试案例。例如，你可能会写这样的东西（如果你的单元测试框架还没有）：

```
public static void ExpectException<T>(Action action) where T : Exception
{
    try
    {
        action();
        Assert.Fail("Expected exception " + typeof(T).Name);
    }
    catch (T exception)
    {
        // Expected
    }
} 
```

然后你可以写：

```
[Test]
public void MyMethodFailsWithInvalidArguments()
{
    ExpectException<ArgumentNullException>(() => myClass.MyMethod(null));
    ExpectException<ArgumentException>(() => myClass.MyMethod(""));
} 
```

比使用单独的 try/catch 块，甚至使用`ExpectedException`属性和多个测试更简洁。

如果您还想验证是否在每种情况下都没有触及任何模拟对象（以检查是否避免了副作用），或者对于常见异常（如`ArgumentNullException`.

对于单参数方法，您甚至可以编写一个方法来准确封装您需要的内容：

```
public void ExpectExceptionForNullAndEmptyStrings(Action<string> action)
{
    ExpectException<ArgumentNullException>(() => action(null));
    ExpectException<ArgumentException>(() => action(""));
} 
```

然后调用它：

```
[Test]
public void MyMethodFailsWithInvalidArguments()
{
    // This *might* work without the 
    ExpectExceptionForNullAndEmptyStrings(myClass.MyMethod);
} 
```

...对于具有单个参数但返回类型为非 void 的方法，可能还有另一种方法。

不过，这可能有点远:)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-05-30T21:12:13.910

如果您使用 Java 和 JUnit，则可以使用此语法

```
@Test(expected = IllegalArgumentException.class)
public void ArgumentTest() {
   myClass.MyMethod("");
   myClass.MyMethod(null);
} 
```

# haskell - 具有超时的并发 Haskell 操作

> ID：930595
> 
> 赞同：6
> 
> 时间：2009-05-30T20:54:55.240
> 
> 标签：haskell, timeout, action, concurrency

如何在并发haskell中实现一个函数，该函数要么成功返回'a'，要么由于超时'b'而返回？

```
timed :: Int → IO a → b → IO (Either a b)
timed max act def = do 
```

最好的问候，
Cetin Sert

注意：timed 的签名可以完全不同，也可以略有不同。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T01:48:02.200

`timed`在上面实现您的期望`System.Timeout.timeout`很容易：

```
import System.Timeout (timeout)

timed :: Int -> IO a -> b -> IO (Either b a)
timed us act def = liftM (maybe (Left def) Right) (timeout us act) 
```

顺便说一下，常见的实现更`timeout`接近于`$!`：`seq`

```
import Control.Concurrent (forkIO, threadDelay, killThread)
import Control.Concurrent.MVar (newEmptyMVar, putMVar, takeMVar)
import System.IO (hPrint, stderr)

timeout :: Int -> IO a -> IO (Maybe a)
timeout us act = do
    mvar <- newEmptyMVar
    tid1 <- forkIO $ (putMVar mvar . Just $!) =<< act
    tid2 <- forkIO $ threadDelay us >> putMVar mvar Nothing
    res <- takeMVar mvar
    killThread (maybe tid1 (const tid2) res) `catch` hPrint stderr
    return res 
```

库中的实现`System.Timeout.timeout`稍微复杂一些，处理更多的异常情况。

```
import Control.Concurrent  (forkIO, threadDelay, myThreadId, killThread)
import Control.Exception   (Exception, handleJust, throwTo, bracket)
import Data.Typeable
import Data.Unique         (Unique, newUnique)

data Timeout = Timeout Unique deriving Eq
timeoutTc :: TyCon
timeoutTc = mkTyCon "Timeout"
instance Typeable Timeout where { typeOf _ = mkTyConApp timeoutTc [] }
instance Show Timeout where
    show _ = "<<timeout>>"
instance Exception Timeout

timeout n f
    | n <  0    = fmap Just f
    | n == 0    = return Nothing
    | otherwise = do
        pid <- myThreadId
        ex  <- fmap Timeout newUnique
        handleJust (\e -> if e == ex then Just () else Nothing)
                   (\_ -> return Nothing)
                   (bracket (forkIO (threadDelay n >> throwTo pid ex))
                            (killThread)
                            (\_ -> fmap Just f)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T21:25:37.473

这是我能想到的第一个答案。我需要这个用于端口扫描仪。o_O 忘记了我的路由器的管理员密码，并想检查我之前在家庭服务器上打开了哪些端口，我现在可以重新利用和重用 ^ _ ^" ...这个实现暂时应该可以完成这项工作。

```
module Control.Concurrent.Timed (timed) where

import Prelude hiding (take)
import System.IO
import Control.Monad
import System.Process
import System.Timeout
import Control.Concurrent
import System.Environment

timed :: Int → IO a → b → IO (Either b a)
timed max act def = do

  w ← new
  r ← new

  t ← forkIO $ do
    a ← act
    r ≔ Right a
    e ← em w
    case e of
      False → kill =<< take w
      True  → return ()

  s ← forkIO $ do
    (w ≔) =<< mine
    wait max
    e ← em r
    case e of
      True  → do
        kill t
        r ≔ Left def
      False → return ()

  take r

timed_ :: Int → IO a → a → IO a
timed_ max act def = do
  r ← timed max act def
  return $ case r of
    Right a → a
    Left  a → a

(≔) = putMVar
new = newEmptyMVar
wait = threadDelay
em = isEmptyMVar
kill = killThread
mine = myThreadId
take = takeMVar 
```

或者只使用[System.Timeout.timeout](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-Timeout.html#v:timeout) -__-"

# c# - 在 C# 中处理非常大的整数

> ID：930611
> 
> 赞同：3
> 
> 时间：2009-05-30T21:02:22.497
> 
> 标签：c#, factorial

有谁知道我可以在 C# 中计算非常大的整数的方法

我正在尝试计算数字的阶乘，例如

5！= 5*4*3*2*1 = 120

对于小数字，这不是问题，但试图计算 unsigned int 的最大值的阶乘，即 4,294,967,295，这似乎是不可能的。

我已经查看了 BigInteger 类，但它似乎没有做我需要的

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-30T21:14:20.117

要计算阶乘，`uint.MaxValue`您需要*大量*存储空间。

例如，[维基百科的文章](http://en.wikipedia.org/wiki/Factorial)为 8.2639316883... × 10^5,565,708。你会疯狂地获取信息。

我*强烈*怀疑你不会在理智的时间内找到任何在理智的计算机上计算它的方法。为什么需要这个值？斯特林的近似值是否足够接近？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T21:08:23.357

首先，值得指出的是， 的阶乘`uint.MaxValue`是*天文数字*。我无法很好地估计其阶乘的数量级，但它的位表示可能会占据标准 RAM 的很大比例，如果不是很好的话。

一个`BigInteger`类似乎是你想要的，只要你只想提高到大约 1,000,000 左右（非常粗略）。在那之后，时间和记忆变得非常令人望而却步。在 .NET 的当前（稳定）版本（最高 3.5）中，您必须使用自定义实现。[CodeProject 上的这个](http://www.codeproject.com/KB/cs/biginteger.aspx)似乎得到了很高的评价。如果您碰巧正在为 .NET 4.0 开发，Microsoft 团队终于开始在 BCL[`BigInteger`](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger(VS.100).aspx)的命名空间中包含一个类。`System.Numerics`与一些 BigInteger 实现不同，.NET 4.0 中存在的那个没有内置的阶乘方法（我不确定 CodeProject 的那个），但是实现一个应该很简单——扩展方法会很好方式。

由于您似乎认为您不想使用 BigInteger 类型，因此如果您可以在阅读我的回复后验证它不是您想要的，然后准确解释为什么它不适合您的目的，这将很有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T22:38:21.523

4294967295! = 10^(10^10.597) ~ 10^(40000000000) This value requires about 40 Gb of RAM to store, even if you will find any BigInteger implementation for C#!

P.S. Well, with optimized storing, let's say 9 digits in 4 bytes, it will take ~18 Gb of RAM.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T22:13:02.883

为什么你认为你需要计算这些阶乘？对于进行实际计算的任何事情，它实际上都没有用。

仅计算 (2^32-1) 的阶乘结果会占用大量空间，大约 16 GB。

计算本身当然会花费很多时间。如果您构建程序以便可以将计算过程转移到发明时更快的硬件，那么您应该能够在您的有生之年获得结果。

如果您尝试解决类似于[欧拉](http://projecteuler.net/)问题的问题，请考虑通过消除实际上无需计算即可获得答案的问题来找到许多解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T17:40:13.870

[Here](http://www.luschny.de/math/factorial/index.html) . The fastest one, straight from the Factorial Man - Peter Luschny.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T21:11:52.133

尝试为此任务使用数组。您可以使用尽可能长的整数，因为您有可用的内存空间。数组的每个成员都代表一个十进制数字。您唯一需要的是实现乘法运算。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T21:13:29.947

您现在可以使用 J# 库中的 BigInteger 类。 [这是一篇关于如何的文章](http://msdn.microsoft.com/en-us/magazine/cc163696.aspx)。它使部署更加困难，因为您必须发送[J# redistributable](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=F72C74B3-ED0E-4AF8-AE63-2F0E42501BE1&displaylang=en)。您还可以考虑使用[VS2010 beta](http://www.microsoft.com/downloads/details.aspx?FamilyID=3296bb4f-d8ba-4cfd-aa95-a424c5913f6b&displaylang=en)，因为[Framework 4.0 将具有 BigInteger](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger(VS.100).aspx)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T21:18:16.753

如果您安装了 J# redist，另一种方法是`java.math.BigInteger`通过添加对程序集的引用来使用`vjslib`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T22:31:11.303

例如，如果您正在使用诸如组合之类的阶乘进行计算，您很少需要一直乘以 1（例如 98 * 98 * 97，因为其他所有内容都会抵消）。

# git - git 删除文件的最旧版本

> ID：930612
> 
> 赞同：20
> 
> 时间：2009-05-30T21:03:05.660
> 
> 标签：git

我有一个 33 MB 的大文件，我想永久删除该文件的最旧版本，所以我只保留最新的 X 版本。怎么做？

我的裸存储库因此变得巨大。

我已经尝试了以下..但它完全删除了文件

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch big_manual.txt' HEAD 
```

为了识别存储库中的大文件，我使用[了 Aristotle Pagaltzis 的 git-large-blob](https://stackoverflow.com/questions/298314/find-files-in-git-repo-over-x-megabytes-that-dont-exist-in-head)。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-31T01:47:27.460

我认为`git filter-branch`您尝试使用的命令是正确的。问题是您没有告诉它在任何提交中保留该文件，因此它已从所有提交中删除。现在，我认为没有办法*直接*告诉`git-filter-branch`跳过任何提交。但是，由于命令是在 shell 上下文中运行的，因此使用 shell 删除除最后 X 个修订之外的所有版本应该不会太难。像这样的东西：

```
KEEP=10 I=0 NUM_COMMITS=$(git rev-list master | wc -l) \
git filter-branch --index-filter \
'if [[ ${I} -lt $((NUM_COMMITS - KEEP)) ]]; then
     git rm --cached --ignore-unmatch big_manual.txt;
 fi;
 I=$((I + 1))' 
```

这将保留`big_manual.txt`在最后 10 次提交中。

话虽如此，就像查尔斯提到的那样，我不确定这是最好的方法，因为您实际上是通过删除旧版本来撤销 VCS 的全部意义。

`git-gc`您是否已经尝试使用和/或优化 git 存储库`git-repack`？如果没有，这些可能值得一试。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-31T07:57:41.313

***注意：****这个答案是关于缩短整个项目的历史，而不是从旧历史中删除**单个文件**问题是什么！*

* * *

使用[git filter-branch缩短](http://git-scm.com/docs/git-filter-branch "git-filter-branch(1) Manual Page")*整个项目*历史的最简单方法是使用**嫁接机制**（请参阅[存储库布局](http://www.kernel.org/pub/software/scm/git/docs/gitrepository-layout.html "Git Repository Layout")文档）来缩短历史：

 **```
$ echo "$commit_id" >> .git/info/grafts 
```

`$commit_id`您希望成为新存储库的根（第一次提交）的提交在哪里。使用“git log”或图形历史查看器（例如 gitk）检查历史看起来像您想要的那样，然后运行“git filter-branch --all”；git-filter-branch 文档中描述了移植物的使用。

或者您可以使用[git clone](http://git-scm.com/docs/git-clone "git-clone(1) Manual Page")选项来使用**浅**克隆。`--depth <depth>`

* * *

* * *

您可以使用以下描述的步骤使用**移植**来删除单个文件的部分历史记录（最初请求的内容）。[该解决方案比Dan Molding 提出的](https://stackoverflow.com/questions/930612/git-remove-oldest-revisions-of-a-file/931054#931054)解决方案包含更多步骤，但每个步骤都更简单，您可以使用“git log”或图形历史查看器检查中间步骤。

1.  首先，选择要删除文件的点，并通过在这些点创建分支来标记这些提交。例如，如果您希望文件在提交中首次出现`f020285b`并在其所有祖先中删除，请使用

    ```
    $ git branch cleanup f020285b^ 
    ```

2.  `cleanup`其次，使用 git-filter-branch 从历史记录中删除以(ie )开头的文件，如[git-filter-branch](http://git-scm.com/docs/git-filter-branch "git-filter-branch(1) 手册页")手册页`f020285b^`的“示例”部分所示：

    ```
    $ git filter-branch --index-filter 'git rm --cached --ignore-unmatch big_manual.txt' cleanup 
    ```

    如果您还想删除所有仅更改为已删除文件的提交，您还可以使用`--prune-empty`git-filter-branch 选项。

3.  接下来，使用移植机制将重写的部分历史与其余历史连接起来：

    ```
    $ echo $(git-rev-parse f020285b) $(git rev-parse cleanup) >> .git/info/grafts 
    ```

    然后您可以检查历史以检查它是否正确连接。

4.  最后，使用 git-filter-branch 使移植物永久化（这将使所有移植物永久化，但在这里假设您不使用移植物），

    ```
    $ git filter-branch cleanup..HEAD 
    ```

    并移除移植物（因为不再需要它们）和`cleanup`分支

    ```
    $ rm .git/info/grafts
    $ git branch -d cleanup 
    ```

最后说明：如果您删除了某个文件的部分历史记录，最好确保没有该文件的项目有意义（例如正确编译）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T08:26:23.733

您可能要考虑使用[git submodules](http://book.git-scm.com/5_submodules.html)。这样，您可以将图像和其他大文件保存在另一个 git 存储库中，并且具有源代码的存储库可以引用该其他存储库的特定修订。

这将帮助您保持存储库修订同步，因为父存储库包含指向特定子存储库修订的链接。它还允许您在子存储库中删除/重新调整旧修订，而不会影响您的源代码所在的父存储库 - 删除子存储库中的旧修订不会弄乱父存储库的历史记录，因为您只是更新父存储库中的子存储库链接指向的修订版本。

# c++ - 是否存在用于编辑 doxygen 评论的“wiki”？

> ID：930622
> 
> 赞同：14
> 
> 时间：2009-05-30T21:06:02.567
> 
> 标签：c++, git, documentation, wiki, doxygen

我正在开发一个相当大的开源 RTS 游戏引擎（[Spring](http://springrts.com/)）。我最近添加了一堆可由 Lua 调用的新 C++ 函数，我想知道如何最好地记录它们，同时也鼓励人们为*许多*现有的 Lua 调用编写/更新文档。

因此，我认为如果我最初可以将文档编写为 C++ 函数附近的 doxygen 注释，这可能会很好——这很容易，因为函数体显然准确地定义了函数的作用。但是，我希望使用引擎的游戏开发人员能够改进文档，他们通常对 git（我们使用的 VCS）或 C++ 了解甚少。

因此，如果有一种方法可以从 C++ 文件中自动生成 apidocs，而且还有一个类似于 wiki 的 Web 界面，以允许更广泛的受众更新评论、添加示例等，那将是理想的。

所以我想知道，是否存在一个集成了 doxygen 样式格式、对这些评论进行类似 wiki 的编辑（最好不允许编辑源文件的任何其他部分）和 git 的网络工具？（将通过 Web 界面更改的评论提交到特殊分支）

然后，我们开发人员可以不时合并此分支以将改进添加到主分支，同时开发人员对文档的任何改进都将最终在此 Web 工具上，只需将主分支合并到此特殊分支分支。

我还没有找到任何东西，怀疑这个特定的东西是否存在，所以欢迎任何建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T23:34:54.653

这确实是一个非常酷的想法，几年前我也非常需要类似的东西。不幸的是，至少在那时，我无法找到类似的东西。在 sourceforge 和freshmeat 上进行快速搜索今天也没有找到任何相关内容。

但我同意这样一个用户贡献文档的 wiki 前端会非常有用，我知道最近 Lua 社区也讨论了类似的事情（参见[this](http://lua-users.org/wiki/LuaSource)）。

那么，也许我们可以确定要求以提出基本的工作草案/原型？

希望这能让我们以最少的功能启动这样一个项目，然后简单地将它作为一个开源项目（例如在 sourceforge 上）发布到野外，以便其他用户可以为它做出贡献。

理想情况下，可以使用统一补丁来应用以这种方式贡献的更改。此外，将修改限制为仅添加/编辑注释可能是有意义的，而不是允许任意修改文本，这可能通过使用简单的正则表达式来实现。

也许，人们可以通过修改现有的（已建立的）wiki 软件（如 mediawiki）来实现类似的功能。或者最好是已经使用 git 作为后端进行存储的东西。然后，主要需要迎合那些 Doxygen 风格的评论，并在其之上提供一个简单的界面。

再想一想，DoxyGen 本身已经提供了对生成 HTML 文档的支持，所以从这个角度来看，DoxyGen 可以如何扩展可能会很有趣，因此它可以很好地与这样的脚本后端集成，从而可以轻松嵌入式源代码文档的定制。

这可能主要归结为提供一个带有 doxygen 的独立脚本（例如在 python、php 或 perl 中），然后可选地将表单嵌入到自动创建的 HTML 文档中，以便可以通过浏览器将文档修复/增强发送到相应的脚本，这反过来会将任何修改写回相应的分支。

从长远来看，如果这样的脚本能够支持不同类型的后端（CVS、SVN 或 git），或者至少能够足够通用地实现，从而易于扩展，那将是很酷的。

所以，如果我们能想出一个好的设计，甚至有可能这样的修改会被普遍接受为对 doxygen 本身的贡献，这也会给整个事情更多的曝光和动力。

即使这个想法没有直接实现到一个真正的项目中，看看有多少其他用户真正喜欢这个想法也会很有趣，因此它可能会在 doxygen 问题跟踪器中被提及（[https://github.com/ doxygen/doxygen/问题/新](https://github.com/doxygen/doxygen/issues/new)）。

编辑：您可能还想查看[这篇](http://morch.com/content/documentation-git-and-mediawiki)题为[“文档、Git 和 MediaWiki”](http://morch.com/content/documentation-git-and-mediawiki)的文章。

# php - 在 Symfony 中修改路由集合的动作名称？

> ID：930624
> 
> 赞同：0
> 
> 时间：2009-05-30T21:06:38.633
> 
> 标签：php, symfony1, action, propel

创建 sfPropelRouteCollection 时，如何编辑集合将生成的操作名称？

例如：

```
# “产品” CRUD 的路由
产品：
  类：sfPropelRouteCollection
  选项：
    型号：产品
    模块：产品
    操作：[新建、创建、编辑、更新、删除]

```

**如何更改为任何新/创建/编辑/更新/删除方法调用的实际操作？**我希望他们调用“ajaxNew”、“ajaxCreate”等，因此 URL 看起来像“product/ajaxNew”，或者“update”的操作将是“ajaxUpdate”。

让我知道是否需要进一步澄清。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T13:19:34.603

使用 segment_names 选项

```
# Routing for "product" CRUD
product:
  class:              sfPropelRouteCollection
  options:
    model:            Product
    module:           product
    actions:          [new, create, edit, update, delete]
    segment_names:    { create: ajaxCreate, edit: ajaxEdit } 
```

# erd - 如何绘制具有基数的ERD？

> ID：930625
> 
> 赞同：0
> 
> 时间：2009-05-30T21:07:42.017
> 
> 标签：erd

如何绘制具有基数的 ERD？我还在上学，不知道该怎么办。我只需要一个示例想法谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T21:51:06.390

取决于您使用的符号。我发现将“0..*”或“m”或“1”之类的东西放在关系链接的一端，靠近它适用的表，以表示“零或更多”或“m”或“正好 1 required”很好地传达了我的意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T14:54:00.210

一般来说，我喜欢使用 MS Visio（如果你是学生，你应该可以在[Dreamspark](https://www.dreamspark.com/)免费获得它。

一定要考虑 ERD 中的 INSTANCE 而不是类（即实体将被称为学生，而不是学生）。

避免多对多关系，因为它们没有逻辑意义。而是使用关联实体（[参见此处](http://www.wisegeek.com/what-are-associative-entities.htm)）。

从只显示最大基数开始 学生有很多成绩并且成绩属于一个学生：

```
(student)|---<(Grade) 
```

然后进入最小基数 学生不必有成绩，所以学生有 0-许多成绩，但成绩必须属于学生，所以成绩只有 1 个学生

```
 (student)||---0<(Grade) 
```

要阅读上面的示例，您从第一个实体开始，并确定关系。实体是 (student)，关系将其连接到 (Grade)。查看您开始的对面的基数标记。自从我们从（学生）开始，我们正在研究`0<`. 最接近等级的是 MAXIMUM CARDINALITY，或学生可以拥有的最多（等级）。`<`意味着一个（学生）可以有很多（等级）的。是`0`最小基数，它告诉我们是否需要这种关系。在这种情况下它是 a`0`而不是 a`|`所以它不是必需的

# asp.net-mvc - 如何在 ASP.Net MVC 中预填充表单？

> ID：930635
> 
> 赞同：0
> 
> 时间：2009-05-30T21:09:33.760
> 
> 标签：asp.net-mvc, ajax, forms

当您有一个由 Html.BeginForm() 创建的 ASP.Net MVC 表单时，如何填充其中的字段？如果是

```
<asp:Content ID="Main" ContentPlaceHolderID="MainContent" runat="server">
<h2>Edit Dinner</h2>
<%= Html.ValidationSummary("Please correct the errors and try again.") %>
<% using (Html.BeginForm()) { %>
   <p>
       <label for="Title">Dinner Title:</label>
       <%= Html.TextBox("Title") %>
       <%= Html.ValidationMessage("Title", "*") %>
   </p> 
```

Html.TextBox("Title") 的值从何而来？我知道，模型。在这种情况下，模型确实有一个 Title 字段。但是我有一些情况下我必须创建一个视图模型，所以我最终得到了类似的东西：

```
public class DinnerViewModel {
    public Dinner Dinner {get; set;};
    public SomethingElse SomethingElse {get; set;};
} 
```

并将其用作模型， <%= Html.TextBox("Title") %> 获得正确的值。或者至少在验证失败并且重新显示表单时会这样做。

我问是因为我有一个通过 AJAX 提交的表单（使用 Ajax.BeginForm()）并且表单被刷新的案例。我正在为它创建一个空的新模型对象，但它仍在加载上次提交的值。当我在没有 AJAX 的情况下提交时，一切正常。

**更新**

我正在查看模板中的调试器。Model.Dinner.Title 等于 "" 但 Html.TextArea("Title", Model.Dinner.Title) 将之前提交的值放在文本区域内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-27T13:21:43.130

数据存储在 ModelState 中。HtmlHelper 方法将根据表单元素的名称查找存储在模型状态中的值。ModelState 会在我重定向时被清除，但在我刚返回时不会被清除，就像在 AJAX 调用的情况下一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T21:45:24.560

您还可以强制值为空：

```
<% =Html.TextBox("Title", null, new { @value = '' }); %> 
```

将空模型（默认值）传递给视图会更好吗？**编辑**这就是你正在做的我看到;)。只是去我的第一个建议，检查请求是否是 AJAX 请求，然后基于此将 emtpy @value 传递给 TextBox。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T23:14:51.770

我不确定我是否理解这个问题。你做了一个 ajax 请求，但你表单中的文本字段在调用后仍然保持它们的值？

如果是这种情况，那么您应该检查这些文本字段是否在与 AjaxOption 类的 UpdateTargetId 属性关联的元素内。当您执行 ajax 请求时，只有页面的一部分被更新（由 UpdateTargetId 属性引用的那个）。无论您是否更新模型，页面中的其余字段都不会更新。看这个例子：

```
<%= Html.TextBox("Title") %>
....
<div id="myDiv">
    <%= Html.TextBox("SomeField") %>
</div>

<% using (Ajax.BeginForm(new AjaxOptions() { UpdateTargetId = "myDiv" })) {%>
    //... blah blah blah
<% } %> 
```

当您提交 ajax 表单时，只有 SomeField 字段会更新，Title 字段将保持不变。

当您提交常规表单时，整个页面都会更新，这就是为什么所有字段都会在没有 ajax 的情况下更新。

**编辑：**错字。

# python - Windows 中的 Django Shell 快捷方式

> ID：930641
> 
> 赞同：0
> 
> 时间：2009-05-30T21:12:42.660
> 
> 标签：python, django, command-line, windows-xp, batch-file

我正在尝试编写一个 bat 文件，以便我可以快速启动我的一个 Django 项目的 Interactive Shell。

基本上我需要编写一个可以启动“manage.py shell”然后能够从 mysite.myapp.models import * 打印的 python 脚本

问题是 manage.py shell 不能接受额外的参数并且启动到“manage.py shell”会退出父脚本，所以我无法执行额外的命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T00:09:29.123

首先从谷歌代码下载 django-extensions。搜索“django 命令扩展”

通过从文件夹中运行 setup.py install 下载并安装它（它有一个名为“setup.py”的文件）然后您将能够运行 manage.py shell_plus 而不是 manage.py shell，为您提供增强版将自动加载所有模型的 python shell

现在是批处理文件：在桌面上创建一个新文件“run_django.bat”（例如），然后输入它

```
@echo off
cd [path/to/project]
manage.py shell_plus 
```

保存文件。任何时候你点击它，它都会启动你的 shell 并加载你所有的模型

# c# - 摆脱每次使用对象时检查设置值的负担

> ID：930645
> 
> 赞同：1
> 
> 时间：2009-05-30T21:15:16.433
> 
> 标签：c#, aop

想象一个基于选项的应用程序。

我想在每个字符串的末尾添加一个感叹号（这本身就是一项非常简单的任务）。但是，我在 web.config 或 XML 文件中有一个选项，因此如果该选项为真，则附加感叹号，否则不附加。

我知道如何检查 web.config 或 xml 文件的设置值，但是，最好的方法是什么？在字符串的情况下，它将在任何程序中大量使用。

我可以写：

```
if (ExclamationIsSet)
{
// Append here
}

// Otherwise it isn't set, so don't. 
```

但是，这对于大型（甚至小型）代码库是不切实际的。有没有办法摆脱这种手动检查？我听说 AOP 或属性可能能够解决这个问题，但我还没有看到一个例子。

有哪些方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T21:31:11.173

该操作可以描述为：

```
public interface ITextDecorator
{
    string GetString(string input);
} 
```

这封装了*方式*（Web.config、XML 等）并强调了*内容*（装饰字符串）。

然后，任何可能需要装饰文本的类都可以采用该接口的实例：

```
public class Foo
{
    private ITextDecorator _textDecorator;

    public Foo(ITextDecorator textDecorator)
    {
        _textDecorator = textDecorator;
    }

    public void Bar(string text)
    {
        text = _textDecorator.GetString(text);

        // ...
    }
} 
```

的示例实现`ITextDecorator`可能是：

```
public sealed class ExclamationPointTextDecorator : ITextDecorator
{
    public string GetString(string input)
    {
        return input + "!";
    }
}

public sealed class ConditionalTextDecorator : ITextDecorator
{
    private Func<bool> _condition;
    private ITextDecorator _innerTextDecorator;

    public ConditionalTextDecorator(Func<bool> condition, ITextDecorator innerTextDecorator)
    {
        _condition = condition;
        _innerTextDecorator = innerTextDecorator;
    }

    public string GetString(string input)
    {
        return _condition() ? _innerTextDecorator.GetString(input) : input;
    }
} 
```

这些类的示例用法可能是：

```
var textDecorator = new ConditionalTextDecorator(
    () => true,  // Check Web.config, an XML file, or any other condition
    new ExclamationPointTextDecorator());

var foo = new Foo(textDecorator);

foo.Bar("Test"); 
```

请注意附加的感叹号与其条件调用的分离。这两个类现在可以独立于另一个类重用。这种细粒度对象的设计风格最适用于控制反转 (IoC) 容器。但是，这不是必需的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T21:30:00.880

我可能不会在这里使用 AOP ......我的问题是：你什么**时候**做这个附加？那时我会简单地挂钩到一个实用程序方法 - 即

```
WriteOutput(someValue); // presumably with some other args 
```

哪里`WriteOutput`有检查这个标志的负担 - 即它不在*很多*地方。您可能还会发现 C# 3.0 扩展方法可以发挥作用；例如，如果您正在写信给`TextWriter`：

```
public static void WriteWithMarker(this TextWriter writer, SomeType value) {
    writer.Write(value);
    if(ExclamationIsSet) writer.Write(SomeExtraStuff);
} 
```

然后你的代码只是（总是）调用`output.WriteWithMarker(value);`- 工作完成。

我可能还会通过在初始化时存储这个值来确保我最小化影响 - 静态构造函数非常方便：

```
public static class MyUtiltiyClass {
    private static readonly bool exclamationIsSet;
    public static bool ExclamationIsSet {get{return exclamationIsSet;}}
    static MyUtiltiyClass() {
        exclamationIsSet = FindWhetherTheFlagIsSet();
    }
    public static void WriteWithMarker(this TextWriter writer, SomeType value) {
        writer.Write(value);
        if(ExclamationIsSet) writer.Write(SomeExtraStuff);
    }
    //etc
} 
```

也许有了更多关于你目前在做什么和在哪里做这件事的背景，它可能会变得更清楚......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T21:31:23.107

您可以将检查包装到一个方法中：

```
private string SomeGoodMethodName(string text)
{
    if (text == null || text.EndsWith("!")) { return text; }

    return ConfigurationManager.AppSettings["addExclamation"] == "1" ? text + "!" : text;
} 
```

...然后通过该方法获取您的字符串。如果需要，您可能希望查看 ConfigurationManager.AppSettings 的性能，并可能将其存储为布尔值以进行测试。

# iphone - 如何在横向模式下正确显示 iPhone 通讯录？

> ID：930646
> 
> 赞同：1
> 
> 时间：2009-05-30T21:17:12.137
> 
> 标签：iphone, objective-c

我添加了一个 ABPeoplePickerNavigationController，但它不能在横向中正确显示。我正在使用 iPhone SDK 2.2。

```
 ABPeoplePickerNavigationController *ab = [[ABPeoplePickerNavigationController alloc] init];
[ab setPeoplePickerDelegate:self];
[self presentModalViewController:ab animated:YES]; 
```

它显示如下，搜索栏被切断：screencast.com/t/4gVhonWFzT8

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T16:48:14.487

我在设备上按原样部署了通讯录。它只是在模拟器上显得很奇怪。它在设备上的横向显示效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T22:37:52.317

如果您使用的是 2.2.1 SDK，目前通讯簿没有横向视图。

# ms-access - MS Access 用户级别安全性，可读取表单但隐藏表

> ID：930654
> 
> 赞同：1
> 
> 时间：2009-05-30T21:23:29.003
> 
> 标签：ms-access

用户级别的安全性可以使某人访问表单，但不能访问表吗？我有一个使用“SELECT”命令连接到表的表单。它不会“更新”或“删除”。我希望用户访问我的表单，但我不希望他们能够查看基础表中的详细信息。我在用户级安全向导中尝试了各种组合，但由于某种原因，我的表单出现空白，除非我授予用户完全访问权限以执行任何操作。有任何想法吗？顺便说一句，我正在使用 Access 2003。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T01:03:32.243

您可以制作 MDE 并将其提供给您的用户。如果您这样做，用户将只能看到您提供的用户界面之外的任何内容。

如果您的表与表单和查询位于同一个 Access 数据库中，则首先需要将数据库“拆分”为前端和后端。看：

[http://databases.about.com/od/tutorials/ss/splitaccessdb.htm](http://databases.about.com/od/tutorials/ss/splitaccessdb.htm)

有关如何执行此操作的信息。前端包含除表格之外的所有内容。后端包含表格。前端使用前端中的“链接表”对象链接到后端表。

拆分数据库后，在 Access 中打开前端，然后通过从菜单栏中选择 Tools/Database Utilities/Make MDE File 创建一个 MDE。MDE 是您提供给用户的内容。他们打开它的方式与打开任何其他数据库的方式相同，只是他们不能设计任何对象。

确保您在前端定义了一个 AUTOEXEC 宏，这样当用户打开 MDE 时，它就有一个入口点。用户在 MDE 中看不到任何对象，因此如果您没有 AUTOEXEC 宏来打开第一个表单，则当他们尝试打开 MDE 时不会发生任何事情。

如果您需要通过允许用户使用文件/打开对话框连接到后端数据库来管理 MDE 中的链接表的能力，请参阅以下文章：

[http://www.mvps.org/access/tables/tbl0009.htm](http://www.mvps.org/access/tables/tbl0009.htm)

当然，这些都不妨碍您的用户打开后端数据库。如果您需要更强的安全性，您可以将后端数据库升级为 SQL Server Express。更多信息在这里：

[http://office.microsoft.com/en-us/access/HA102755371033.aspx](http://office.microsoft.com/en-us/access/HA102755371033.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T02:07:20.207

What you're looking for is a RWOP query. That means "run with owner permission."

To make it work, assuming you've already run the security wizard on your front-end and back-end databases and have removed permissions for the users to even read the tables, you then create a saved query as the recordsource of your form. In the properties of the query, it is set by default to RUN PERMISSIONS as "user's." Change that to "owner's" and save the query. The query will run with whatever permissions on the base table the owner of the query has. If you are running as an administrator with full permissions, you'll want to set the permissions of the saved query to read-only (or create the query under a user logon that has read-only access to the tables -- it's much easier to do the former).

Some caveats:

1.  user-level security is tricky. If you miss even one step outlined in the ULS security white paper, your app won't be secured. The way to test this is to open Access with a default workgroup file and then see if you can access the objects in your database logged on as the default admin user. If you can, then you made a mistake somewhere along the line.

2.  user-level security is crackable by anyone who wants to. This doesn't mean it's not useful, it just means that it's not bullet-proof. I don't worry about that so much, as I consider security as much a people problem as a technical problem -- you have to give employees sufficient privileges to do their work, and you have trust them that they won't abuse the privileges you've given them.

3.  if you're running Access 2007 and using the ACCDB format, RWOP queries are not available to you, as Jet user-level security is not supported for the ACCDB format. If you're using MDB format, though, it will work just fine in A2007.

# algorithm - 教孩子帕斯卡的简单问题

> ID：930670
> 
> 赞同：2
> 
> 时间：2009-05-30T21:40:42.997
> 
> 标签：algorithm, pascal

我被要求给一个孩子辅导帕斯卡。尽管在我设法获得教程之前从未见过 Pascal，但我现在知道的足以教他。

我写信给你们看看是否有人能指出一些涉及简单算法的基本练习，比如：对这个数组进行排序，找到平均值等......

它可以是任何语言，我只需要找一些练习，这样他就可以锻炼了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T21:49:41.807

这是自由职业者[学习一门新编程语言的 15 个练习](http://www.freelancingjob.com/articles/article_description.php?art_id=96)的列表，它扩展了许多语言中使用的基本技术，并且可以让他感受他正在学习的新语言

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T21:52:08.853

我将以（主要）与语言无关的方式解决这个问题。在教他打印语句和流程控制（`if`语句、`for`循环等）之后，我的建议是从简单的 ASCII 艺术模式开始，这些模式可以由`for`循环等生成。

例如，你将如何打印半棵树，像这样？

```
*
**
***
****
*****
****** 
```

好的，现在你将如何打印一棵*完整*的树，像这样？

```
 *
    ***
   *****
  *******
 *********
*********** 
```

现在试着画一艘火箭飞船。;)

这些对大多数孩子来说都很棒，因为它们是视觉的，结果很诱人，而且练习将传授循环和消除冗余的重要性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-30T22:00:23.937

有关[排序算法](http://en.wikipedia.org/wiki/Sorting_algorithm)，请参见链接。这是一篇 Wikipedia 文章 - 关于排序算法的一些一般信息，但在下方您可以单独找到每种类型的链接，以及伪代码（和某些语言）中的算法。

就“找到平均值”而言，当你有“n”个元素时：

```
SUM=0.
DO i=1,n
 SUM=SUM+element(i)
ENDDO
AVRG=SUM/n 
```

此外，出于学习目的和思考[Project Euler](http://projecteuler.net/)非常好。

* * *

另外，请看一下这个问题： [在哪里可以找到有趣/有教育意义的编程挑战？](https://stackoverflow.com/questions/24692/where-can-you-find-funeducational-programming-challenges)我不想复制粘贴所有内容，但它有一堆链接，其中包含您正在寻找的东西（编程练习）。还有这个：[算法问题网站](https://stackoverflow.com/questions/456535/algorithm-questions-website)，[你的编程练习是什么？](https://stackoverflow.com/questions/6327/what-are-your-programming-exercises). 你可能会在那里找到你认为他会感兴趣的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T22:02:09.287

经典一：
让程序选择一个随机数，游戏的目的是通过消除找到数字。如果用户猜到一个较低的数字，程序就说它太低，如果它更高，它就说它太高。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T22:09:45.823

带有“AI”（即预定义动作）和文本图形的井字游戏是一个不错的项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T23:03:07.430

给它增添一些乐趣。一个好的开始：

剪刀石头布游戏

用户输入 P、R 或 S

程序响应您赢、输或平局

更高级的功能：跟踪记录、获胜百分比、连续赢/输

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T21:35:57.257

如果您知道任何类似 C/C 的语言，则基本相同：

*   { } 是开始结束；
*   == 是 =
*   = 是 :=
*   什么都不返回的函数是一个过程。
*   返回某些东西的函数仍然是一个函数。
*   int 是整数。

其余的几乎相同。语法有点不同，但差别不大。

您需要知道他们使用的是哪种 Pascal，以及他们教给他们的内容，以确保您不会浪费您/他/她的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-07T20:09:53.093

对双向链表做基本操作也是经典。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-07T20:32:14.670

我从中学到的早期练习包括绘制[Mandelbrot 集](http://www.math.lsa.umich.edu/mmss/coursesONLINE/chaos/chaos6/index.html)（现在计算机速度要快得多，因此您不必立即担心优化问题）和实现像[Game of Life](http://ddi.cs.uni-potsdam.de/HyFISCH/Produzieren/lis_projekt/proj_gamelife/ConwayScientificAmerican.htm)这样的元胞自动机。

当然，如果这是学校课程的练习，那么只有在测试可能测试类似的知识/技能领域时，这样的练习才会有帮助。

# haskell - 功能段落

> ID：930675
> 
> 赞同：4
> 
> 时间：2009-05-30T21:41:50.077
> 
> 标签：haskell, functional-programming

抱歉，我还没有完全理解 FP，我想将一系列行拆分为一系列行，假设一个空行作为段落划分，我可以在 python 中这样做：

```
def get_paraghraps(lines):
    paragraphs = []
    paragraph = []
    for line in lines:
        if line == "": # I know it could also be  "if line:"
            paragraphs.append(paragraph)
            paragraph = []
        else:
            paragraph.append(line)
    return paragraphs 
```

你会如何在 Erlang 或 Haskell 中做这件事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T22:09:10.473

我也在尝试学习 Haskell。这个问题的解决方案可能是：

```
paragraphs :: [String] -> [[String]]
paragraphs [] = []
paragraphs lines = p : (paragraphs rest)
    where (p, rest) = span (/= "") (dropWhile (== "") lines) 
```

我在哪里使用[Data.List](http://haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html)中的函数。我正在使用的那些已经可以从 Prelude 中获得，但你可以在链接中找到他们的文档。

我们的想法是使用`span (/= "")`. 这将返回段落和后面的行。然后我们在我称之为的较小的行列表上进行递归`rest`。

在拆分第一段之前，我们使用 . 删除任何空行`dropWhile (== "")`。这对于吃掉分隔段落的空行很重要。我的第一次尝试是这样的：

```
paragraphs :: [String] -> [[String]]
paragraphs [] = []
paragraphs lines = p : (paragraphs $ tail rest)
    where (p, rest) = span (/= "") lines 
```

但是当我们到达最后一段时这会失败，因为`rest`那时是空字符串：

```
*Main> 段落 ["foo", "bar", "", "hehe", "", "bla", "bla"]
[["foo","bar"],["hehe"],["bla","bla"]*** 例外：Prelude.tail：空列表

```

删除空行解决了这个问题，它还使代码将任意数量的空行视为段落分隔符，这是我作为用户所期望的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T22:24:18.930

我只是一个初级 Haskell 程序员（我学的小 Haskell 是 5 年前的），但首先，我会写你的函数的自然翻译，累加器（“当前段落”）被传递（为了清楚起见，我添加了类型）：

```
type Line = String
type Para = [Line]

-- Takes a list of lines, and returns a list of paragraphs
paragraphs :: [Line] -> [Para]
paragraphs ls = paragraphs2 ls []

-- Helper function: takes a list of lines, and the "current paragraph"
paragraphs2 :: [Line] -> Para -> [Para]
paragraphs2 [] para = [para]
paragraphs2 ("":ls) para = para : (paragraphs2 ls [])
paragraphs2 (l:ls)  para = paragraphs2 ls (para++[l]) 
```

这有效：

```
*Main> paragraphs ["Line 1", "Line 2", "", "Line 3", "Line 4"]
[["Line 1","Line 2"],["Line 3","Line 4"]] 
```

* * *

所以这是一个解决方案。但是，Haskell 的经验表明，几乎总是有库函数可以做这样的事情:) 一个相关的函数称为[groupBy](http://www.zvon.org/other/haskell/Outputlist/groupBy_f.html)，它几乎可以工作：

```
paragraphs3 :: [Line] -> [Para]
paragraphs3 ls = groupBy (\x y -> y /= "") ls

*Main> paragraphs3 ["Line 1", "Line 2", "", "Line 3", "Line 4"]
[["Line 1","Line 2"],["","Line 3","Line 4"]] 
```

哎呀。我们真正需要的是一个“splitBy”，[它不在库](http://www.google.com/search?q=haskell%20splitBy)中，但我们可以自己过滤掉坏的：

```
paragraphs4 :: [Line] -> [Para]
paragraphs4 ls = map (filter (/= "")) (groupBy (\x y -> y /= "") ls) 
```

或者，如果你想变得很酷，你可以摆脱争论并以毫无意义的方式去做：

```
paragraphs5 = map (filter (/= "")) . groupBy (\x y -> y /= "") 
```

我敢肯定还有更短的方法。:-)

**编辑**：[ehemient](https://stackoverflow.com/users/20713/ephemient)指出`(not . null)`比`(/= "")`. 所以我们可以写

```
paragraphs = map (filter $ not . null) . groupBy (const $ not . null) 
```

重复`(not . null)`是一个强烈的迹象，表明我们真的应该将它抽象成一个函数，这就是[Data.List.Split 模块](http://byorgey.wordpress.com/2008/12/21/datalistsplit/)所做的，正如下面的答案所指出的那样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-31T09:57:31.803

最干净的解决方案是使用[拆分](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/split)包中适当的东西。

您需要先安装它，然后`Data.List.Split.splitWhen null`才能完美地完成这项工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T22:08:05.560

递归思考。

```
get_paragraphs []      paras para = paras ++ [para]
get_paragraphs ("":ls) paras para = get_paragraphs ls (paras ++ [para]) []
get_paragraphs (l:ls)  paras para = get_paragraphs ls paras (para ++ [l]) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-31T00:12:57.087

您想对这些行进行分组，因此`groupBy`from`Data.List`似乎是一个不错的候选者。它使用自定义函数来确定哪些行“相等”，因此可以提供使同一段落中的行“相等”的内容。例如：

```
import Data.List( groupBy )

inpara :: String -> String -> Bool
inpara _ "" = False
inpara _ _  = True

paragraphs :: [String] -> [[String]]
paragraphs = groupBy inpara 
```

这有一些限制，因为`inpara`只能比较相邻的两条线，更复杂的逻辑不适合`groupBy`. 如果更灵活，则更基本的解决方案。使用基本递归可以写：

```
paragraphs [] = []
paragraphs as = para : paragraphs (dropWhile null reminder)
  where (para, reminder) = span (not . null) as
                           -- splits list at the first empty line 
```

`span`在提供的函数为假的点（第一个空行）拆分列表，`dropWhile`删除提供的函数为真的前导元素（任何前导空行）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-23T20:39:39.467

迟到总比不到好。

```
import Data.List.Split (splitOn)

paragraphs :: String -> [[String]]
paragraphs s = filter (not . null) $ map words $ splitOn "\n\n" s

paragraphs "a\nb\n\nc\nd"                == [["a", "b"], ["c", "d"]]
paragraphs "\n\na\nb\n\n\nc\nd\n\n\n"    == [["a", "b"], ["c", "d"]]
paragraphs "\n\na\nb\n\n \n  c\nd\n\n\n" == [["a", "b"], ["c", "d"]] 
```

# c# - 扩展 IQueryable Where() 作为 OR 而不是 AND 关系

> ID：930677
> 
> 赞同：9
> 
> 时间：2009-05-30T21:42:41.027
> 
> 标签：c#, iqueryable

我正在使用自己的 IQueryable<> 扩展方法来创建可链接的查询，例如 FindAll().FindInZip(12345).NameStartsWith("XYZ").OrderByHowIWantIt() 等，然后在延迟执行时根据我的扩展方法链。

但问题在于，扩展链中的所有 Where （FindXYZ、FindInZip 等）将始终组合为 AND，这意味着我不能做这样的事情：

FindAll().FirstNameStartsWith("X").OrLastNameStartsWith("Z") 因为我不知道如何在单独的 Where 方法中注入 OR。

知道如何解决这个问题吗？

* * *

额外的; 到目前为止，我了解如何将表达式链接为 Or 如果我包装它们（例如 CompileAsOr(FirstNameStartsWith("A").LastNameStartsWith("Z").OrderBy(..))）

我正在尝试做的事情稍微复杂一些（并且 PredicateBuilder 在这里没有帮助..）因为我希望稍后的 IQueryable 基本上访问之前建立的 Where 条件，而不必包装它们来创建 Or between他们。

由于每个扩展方法都返回 IQueryable<> 我知道它应该了解某处查询条件的当前状态，这使我相信应该有一些自动化的方式或在所有先前的 Where 条件中创建一个 Or 而不必包装你想要什么或'd。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-30T21:50:12.150

我假设查询的不同部分仅在运行时才知道，即您不能只`||`在`where`...

一个懒惰的选择是`Concat`- 但这往往会导致糟糕的 TSQL 等；但是，我倾向于改为编写 custom `Expression`。采取的方法取决于提供者是什么，因为 LINQ-to-SQL 支持 EF 的不同选项（例如） - 这在这里有真正的影响（因为您不能将子表达式与 EF 一起使用）。你能告诉我们是哪个吗？

* * *

下面是一些适用于 LINQ-to-SQL 的代码；如果您构建一个表达式数组（或列表，并调用`.ToArray()`），它应该可以正常工作；示例是 LINQ-to-Objects，但仍应有效：

```
 static void Main()
    {
        var data = (new[] { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }).AsQueryable();

        var predicates = new List<Expression<Func<int, bool>>>();
        predicates.Add(i => i % 3 == 0);
        predicates.Add(i => i >= 8);           

        foreach (var item in data.WhereAny(predicates.ToArray()))
        {
            Console.WriteLine(item);
        }
    }

    public static IQueryable<T> WhereAny<T>(
        this IQueryable<T> source,
        params Expression<Func<T,bool>>[] predicates)
    {
        if (source == null) throw new ArgumentNullException("source");
        if (predicates == null) throw new ArgumentNullException("predicates");
        if (predicates.Length == 0) return source.Where(x => false); // no matches!
        if (predicates.Length == 1) return source.Where(predicates[0]); // simple

        var param = Expression.Parameter(typeof(T), "x");
        Expression body = Expression.Invoke(predicates[0], param);
        for (int i = 1; i < predicates.Length; i++)
        {
            body = Expression.OrElse(body, Expression.Invoke(predicates[i], param));
        }
        var lambda = Expression.Lambda<Func<T, bool>>(body, param);
        return source.Where(lambda);
    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-30T21:45:46.557

使用[`PredicateBuilder<T>`](http://www.albahari.com/nutshell/predicatebuilder.aspx). 这可能是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-14T23:36:57.513

```
 List<string> fruits =
        new List<string> { "apple", "passionfruit", "banana", "mango",
               "orange", "blueberry", "grape", "strawberry" };

    var query = fruits.AsQueryable();

    // Get all strings whose length is less than 6.
    query = query.Where(fruit => fruit.Length < 6);

    // Hope to get others where length is more than 8\.  But you can't, they're gone.
    query = query.Where(fruit => 1 == 1 || fruit.Length > 8);

    foreach (string fruit in query)
        Console.WriteLine(fruit); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-12T10:58:11.903

在一个理想的世界里，我个人认为`||`和`&&`操作符将是最简单和可读的。但是它不会编译。

> 运算符“||” 不能应用于“ `Expression<Func<YourClass,bool>>`”和“ `Expression<Func<YourClass,bool>>`”类型的操作数

因此，我为此使用了扩展方法。在您的示例中，它看起来像这样 `.Where(FindInZip(12345).Or(NameStartsWith("XYZ")).And(PostedOnOrAfter(DateTime.Now))`：

代替：

`.Where(FindInZip(12345) || NameStartsWith("XYZ") && (PostedOnOrAfter(DateTime.Now))`.

表达式示例：

```
private Expression<Func<Post,bool>> PostedOnOrAfter(DateTime cutoffDate)
{
      return post => post.PostedOn >= cutoffDate;
}; 
```

扩展方法：

```
public  static  class PredicateExtensions
{
     ///  <summary>
     /// Begin an expression chain
     ///  </summary>
     ///  <typeparam id="T""></typeparam>
     ///  <param id="value"">Default return value if the chanin is ended early</param>
     ///  <returns>A lambda expression stub</returns>
     public  static Expression<Func<T,  bool>> Begin<T>(bool value =  false)
    {
         if (value)
             return parameter =>  true;  //value cannot be used in place of true/false

         return parameter =>  false;
    }

     public  static Expression<Func<T,  bool>> And<T>(this Expression<Func<T,  bool>> left,
        Expression<Func<T,  bool>> right)
    {
         return CombineLambdas(left, right, ExpressionType.AndAlso);
    }

     public  static Expression<Func<T,  bool>> Or<T>(this Expression<Func<T,  bool>> left, Expression<Func<T,  bool>> right)
    {
         return CombineLambdas(left, right, ExpressionType.OrElse);
    }

     #region private

     private  static Expression<Func<T,  bool>> CombineLambdas<T>(this Expression<Func<T,  bool>> left,
        Expression<Func<T,  bool>> right, ExpressionType expressionType)
    {
         //Remove expressions created with Begin<T>()
         if (IsExpressionBodyConstant(left))
             return (right);

        ParameterExpression p = left.Parameters[0];

        SubstituteParameterVisitor visitor =  new SubstituteParameterVisitor();
        visitor.Sub[right.Parameters[0]] = p;

        Expression body = Expression.MakeBinary(expressionType, left.Body, visitor.Visit(right.Body));
         return Expression.Lambda<Func<T,  bool>>(body, p);
    }

     private  static  bool IsExpressionBodyConstant<T>(Expression<Func<T,  bool>> left)
    {
         return left.Body.NodeType == ExpressionType.Constant;
    }

     internal  class SubstituteParameterVisitor : ExpressionVisitor
    {
         public Dictionary<Expression, Expression> Sub =  new Dictionary<Expression, Expression>();

         protected  override Expression VisitParameter(ParameterExpression node)
        {
            Expression newValue;
             if (Sub.TryGetValue(node,  out newValue))
            {
                 return newValue;
            }
             return node;
        }
    }

     #endregion
} 
```

一篇关于通过扩展表达式进行 LINQ 查询的非常好的文章。也是我使用的扩展方法的来源。

[https://www.red-gate.com/simple-talk/dotnet/net-framework/giving-clarity-to-linq-queries-by-extending-expressions/](https://www.red-gate.com/simple-talk/dotnet/net-framework/giving-clarity-to-linq-queries-by-extending-expressions/)

# asp.net - 虚拟目录中的 Web.config... 根目录 web.config 的权限被拒绝？

> ID：930684
> 
> 赞同：0
> 
> 时间：2009-05-30T21:44:46.777
> 
> 标签：asp.net, web-config

在 IIS 6 Win23k 下。在网站的根目录下有一个 web.config（我认为根网站实际上是一个共享点站点）。我在我的 asp.net 应用程序中创建了一个虚拟目录和 plunk，它是 web.config。我的应用程序作为一个特定的用户 ID 运行，并且碰巧没有对根目录的 web.config 的权限。

我的虚拟目录的 web.config 应该有错误（引用拼写错误）。当我通过浏览器访问虚拟目录时，我收到一个关于“权限被拒绝”的 ASP.NET 错误。

更改对父 web.config 的权限...噗我现在得到正确的错误。删除父 web.config... 噗我现在得到正确的错误。

这里发生了什么？为什么我的虚拟目录需要/想要根目录的 web.config？如何防止我的虚拟目录这样做？

编辑：这是共享点是一个坏公民。它将 web.confg 上的权限设置为仅具有完全控制权的管理员和系统，并将 STS_WPG 设置为只读。请注意，我确定第一次 sharepoint 与网络服务器发生了冲突。

谢谢！

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T21:48:33.930

afaik，虚拟目录“继承”根配置。您可以禁用该行为：

[http://dotnetslackers.com/Security/re-55457_Stopping_ASP_NET_web_config_inheritance.aspx](http://dotnetslackers.com/Security/re-55457_Stopping_ASP_NET_web_config_inheritance.aspx)

# c++ - 为什么“删除节点；” 使我的 C++ 链表应用程序崩溃？

> ID：930693
> 
> 赞同：-1
> 
> 时间：2009-05-30T21:48:35.710
> 
> 标签：c++, linked-list

我的链表类的 jDeleteAfter 方法应该删除紧跟在作为参数传递的节点之后的节点。如果是这样，我不知道，但是当“删除 tlp;”时它会突然关闭我的控制台应用程序；（临时列表指针）被读取。我的导师、编程论坛的用户和我还没有确定这个问题的根源。

用 Dev-C++ 4.9.9.2 编写：

```
[source]
#include "JawaListT.h"
#include <cstdlib>
#include <iostream>
#include <new.h>

/*DEFAULT CONSTRUCTOR*/
JawaListT::JawaListT()
{
    if((this->jHead = new (nothrow) JawaLinkT) && (this->jTail = new (nothrow) JawaLinkT))
    {
        this->jHead->jSetNext(this->jTail);
        this->jTail->jSetNext(this->jTail);
    }//end if allocated
}

/*INSERT NODE AFTER*/
void JawaListT::jInsertAfter(JawaLinkT* lp, int val)
{
    if(lp != NULL && lp != this->jTail)     //if passed not tail and not null
    {
        JawaLinkT* tlp;             //new list node

        if((tlp = new (nothrow) JawaLinkT) != NULL) //if dynamically allocated  
        {
            tlp->jSetNext(lp->jGetNext());  //temp.next = passed.next                   
            lp->jSetNext(tlp);      //passed.next = temp
            tlp->jSetValue(val);        //temp.data = val
        }//end if allocated
    }//end if not tail
}

/*INSERT NODE BEFORE*/
void JawaListT::jInsertBefore(JawaLinkT* lp, int val)
{
    if(lp != NULL && lp != this->jHead)     //if passed not head and not null
    {
        JawaLinkT* tlp;             //new list node

        if((tlp = new (nothrow) JawaLinkT) != NULL) //if dynamically allocated
        {
            tlp->jSetNext(lp->jGetNext());
            tlp->jSetValue(lp->jGetValue());
//          *tlp = *lp;         //copies passed node to temp node
            lp->jSetNext(tlp);      //passed.next = temp
            lp->jSetValue(val);     //passed.data = val
            if(lp == this->jTail)       //if passed is tail
            {
                this->jTail = tlp;  //tail is temp
                this->jTail->jSetNext(this->jTail); //tail.next = tail
            }//end if lp
        }//end if tlp
    }//end if head
}

/*REMOVE NODE AFTER*/
void JawaListT::jDeleteAfter(JawaLinkT* lp)
{
    if(lp != NULL && lp->jGetNext() != this->jTail) //if not tail and not null
    {
        JawaLinkT* tlp;             //temp pointer to node

        tlp = lp->jGetNext();           //temp = passed.next
        lp->jSetNext(tlp->jGetNext());      //passed.next = temp.next
        delete tlp;             //delete to what temp points
    }//end if next  

        /*code that did not work any better*/
//      tlp->jSetNext((lp->jGetNext())->jGetNext());    
//      delete lp->jGetNext();
//      lp->jSetNext(tlp);

/*Also tried declaring and/or deleting tlp outside of decision structure, and
jDeleteCurrent(tlp) since that function works properly.*/   
}

/*REMOVE CURRENT NODE*/
void JawaListT::jDeleteCurrent(JawaLinkT* lp)
{
    if(lp != NULL && lp != jHead && lp != jTail)    //if not head or tail, not null
    {   
        JawaLinkT* tlp;             //temp pointer to node

        tlp = lp->jGetNext();           //temp = passed.next
        *lp = *tlp;             //copy temp to passed
        if(tlp == jTail)            //if temp is tail
        {
            this->jSetTail(lp);     //tail = passed
            lp->jSetNext(lp);       //passed.next = passed
        delete tlp;             //delete to what temp points
        }//end if tail
    }//end if not head
}

/*LINEAR SENTINEL SEARCH*/
JawaLinkT* JawaListT::jFindItemS(int item)
{
    JawaLinkT* tlp;                 //temp pointer to node
this->jTail->jSetValue(item);               //tail.data = item

    for(tlp = jHead->jGetNext(); tlp->jGetValue() != item; tlp = tlp->jGetNext());
    /*INIT: node after head, EXIT: data found, UPDATE: increment node*/

    if(tlp == jTail)                //if sentinel found
            std::cout << item << " not in list" << std::endl;   

    return((tlp != this->jTail->jGetNext()) ? tlp : NULL);
    /*If sentinel not found, return proper node, else return null*/
}

[/source] 
```

我使用类的哨兵搜索来遍历列表并提供适当的节点作为 jDeleteAfter 的参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T22:07:49.413

一个简单的提示：删除所有分配失败的测试 - 它们永远不会在 Windows 平台上发生并且会使代码复杂化。如果它们确实发生了，你就无法从它们中恢复过来，所以测试是双重无用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T02:59:59.700

一些代码审查提示：

```
JawaLinkT* tlp;                         //new list node

if((tlp = new (nothrow) JawaLinkT) != NULL) 
```

更具可读性：

```
if(JawaLinkT* tlp = new (nothrow) JawaLinkT) 
```

（另外，请参阅上面尼尔的评论，为什么使用 nothrow 而不实际做任何事情）

该代码还充斥着随机潜在的内存泄漏：

```
if((this->jHead = new (nothrow) JawaLinkT) && (this->jTail = new (nothrow) JawaLinkT))
// What if first new succeeds and second fails? 
```

至于这个问题，这是很多代码要阅读而没有堆栈跟踪来寻找一个通用的错误，但我认为 jDeleteAfter 可能实施不正确。考虑函数在尾部之前传递节点的情况。我会在那儿剪掉它，因为它看起来确实像家庭作业；但如果您仍然遇到问题，请发表评论，我会澄清。

编辑：我意识到我错了。没关系！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T03:06:02.387

事实证明，我的虚拟析构函数中的 delete 语句存在冲突。现在一切正常。感谢您查看我的代码。

至于 nothrows——我这样做是因为我们的文本介绍了这个想法，但我还不知道如何处理异常。不过，感谢您的建议。

# scala - 为什么 PartialFunction <: Scala 中的函数？

> ID：930698
> 
> 赞同：48
> 
> 时间：2009-05-30T21:51:01.837
> 
> 标签：scala, type-systems, subtype

在 Scala 中，`PartialFunction[A, B]`类派生自类型`Function[A, B]`（参见 Scala 参考，12.3.3）。但是，这对我来说似乎违反直觉，因为 a `Function`（需要为 all 定义`A`）比 a 具有更严格的要求`PartialFunction`，在某些地方可能未定义。

我遇到的问题是，当我有一个偏函数时，我不能使用 a`Function`来扩展偏函数。例如。我不能做：

```
(pf orElse (_)=>"default")(x) 
```

（希望语法至少远程正确）

为什么这个子类型是反向进行的？有没有我忽略的原因，比如`Function`类型是内置的？

顺便说一句，如果`Function1 :> Function0`我不需要上面示例中的虚拟参数，那也很好:-)

### 编辑以澄清子类型问题

通过查看两个示例可以强调两种方法之间的区别。他们哪一个是对的？

一：

```
val zeroOne : PartialFunction[Float, Float] = { case 0 => 1 }
val sinc = zeroOne orElse ((x) => sin(x)/x) // should this be a breach of promise? 
```

二：

```
def foo(f : (Int)=>Int) {
  print(f(1))
}
val bar = new PartialFunction[Int, Int] {
  def apply(x : Int) = x/2
  def isDefinedAt(x : Int) = x%2 == 0
}
foo(bar) // should this be a breach of promise? 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-30T23:22:08.593

因为在 Scala 中（就像在任何图灵完备语言中一样），不能保证函数是完全的。

```
val f = {x : Int => 1 / x} 
```

该函数未在 0 处定义。PartialFunction 只是一个承诺告诉您未定义的函数。尽管如此，Scala 仍然可以轻松地做你想做的事

```
def func2Partial[A,R](f : A => R) : PartialFunction[A,R] = {case x => f(x)}

val pf : PartialFunction[Int, String] = {case 1 => "one"} 

val g = pf orElse func2Partial{_ : Int => "default"}

scala> g(1)
res0: String = one

scala> g(2)
res1: String = default 
```

如果您愿意，可以将 func2Partial 设为隐式。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-03T16:37:15.217

`PartialFunction`有`Function1`没有的方法，因此它是子类型。这些方法是`isDefinedAt`和`orElse`。

您真正的问题是，`PartialFunction`当您真正希望它们时，有时不会推断出 s 。我希望这将在未来的某个日期得到解决。例如这不起作用：

```
scala> val pf: PartialFunction[String, String] = { case "a" => "foo" }
pf: PartialFunction[String,String] = <function>

scala> pf orElse { case x => "default" }
<console>:6: error: missing parameter type for expanded function 
((x0$1) => x0$1 match { case (x @ _) => "default" }) 
```

但这确实：

```
scala> pf orElse ({ case x => "default" } : PartialFunction[String,String])
res5: PartialFunction[String,String] = <function> 
```

当然，你总是可以这样做：

```
scala> implicit def f2pf[T,R](f: Function1[T,R]): PartialFunction[T,R] = 
  new PartialFunction[T,R] { 
    def apply(x: T) = f(x)
    def isDefinedAt(x: T) = true 
  }
f2pf: [T,R](f: (T) => R)PartialFunction[T,R] 
```

现在它更像你想要的：

```
scala> pf orElse ((x: String) => "default")
res7: PartialFunction[String,String] = <function>

scala> println(res7("a") + " " + res7("quux"))
foo default 
```

# python - Python & 解析 IRC 消息

> ID：930700
> 
> 赞同：7
> 
> 时间：2009-05-30T21:51:58.730
> 
> 标签：python, parsing, irc

根据 RFC，用 Python 解析从 IRC 服务器收到的消息的最佳方法是什么？我只是想要某种列表/无论如何，例如：

```
:test!~test@test.com PRIVMSG #channel :Hi! 
```

变成这样：

```
{ "sender" : "test!~test@test.com", "target" : "#channel", "message" : "Hi!" } 
```

等等？

（编辑：我想解析 IRC 消息，而不仅仅是 PRIVMSG 的**）**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-30T21:58:04.740

查看 Twisted 的实现[http://twistedmatrix.com/](http://twistedmatrix.com/)

不幸的是，我没有时间，也许其他人可以将它粘贴在这里。

### 编辑

好吧，我回来了，奇怪的是还没有人粘贴它，所以它是：

[http://twistedmatrix.com/trac/browser/trunk/twisted/words/protocols/irc.py#54](http://twistedmatrix.com/trac/browser/trunk/twisted/words/protocols/irc.py#54)

```
def parsemsg(s):
    """Breaks a message from an IRC server into its prefix, command, and arguments.
    """
    prefix = ''
    trailing = []
    if not s:
       raise IRCBadMessage("Empty line.")
    if s[0] == ':':
        prefix, s = s[1:].split(' ', 1)
    if s.find(' :') != -1:
        s, trailing = s.split(' :', 1)
        args = s.split()
        args.append(trailing)
    else:
        args = s.split()
    command = args.pop(0)
    return prefix, command, args

parsemsg(":test!~test@test.com PRIVMSG #channel :Hi!")
# ('test!~test@test.com', 'PRIVMSG', ['#channel', 'Hi!']) 
```

该函数严格遵循 IRC RFC 中描述的 EBNF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T22:26:11.547

如果格式总是这样，您可以通过简单的列表理解来完成。

```
keys = ['sender', 'type', 'target', 'message']
s = ":test!~test@test.com PRIVMSG #channel :Hi!"
dict((key, value.lstrip(':')) for key, value in zip(keys, s.split())) 
```

结果：

```
{'message': 'Hi!', 'type': 'PRIVMSG', 'sender': 'test!~test@test.com', 'target': '#channel'} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T22:44:01.010

您是只想解析 IRC 消息，还是只想解析 PRIVMSG？但是我有一个实现。

```
def parse_message(s):
    prefix   = ''
    trailing = ''
    if s.startswith(':'):
        prefix, s = s[1:].split(' ', 1)
    if ' :' in s:
        s, trailing = s.split(' :', 1)
    args = s.split()
    return prefix, args.pop(0), args, trailing 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T04:37:44.463

如果您想保持低级别的黑客攻击，我会支持 Unknown 的 Twisted 答案，但首先我认为您应该看看最近发布的**[Yardbird](http://zork.net/motd/nick/django/introducing-yardbird.html)**，它是 Twisted 之上的一个很好的请求解析层。它允许您使用类似于 Django URL 调度的东西来处理 IRC 消息，并具有使 Django ORM 可用于生成响应等的附带好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-18T11:21:55.270

我知道这不是 Python，但对于基于正则表达式的解决此问题的方法，您可以查看[POE::Filter::IRCD](http://github.com/bingos/poe-filter-ircd/blob/master/lib/POE/Filter/IRCD.pm)，它处理 IRC 服务器协议（请参阅[POE::Filter::IRC::](http://github.com/bingos/poe-component-irc/blob/master/lib/POE/Filter/IRC/Compat.pm) Compat客户端协议添加）解析 Perl 的[POE::Component::IRC](http://github.com/bingos/poe-component-irc)框架。

# iphone - 通过 http 将 mp4 流式传输到 iphone/ipod touch

> ID：930708
> 
> 赞同：2
> 
> 时间：2009-05-30T22:00:50.943
> 
> 标签：iphone

是否可以通过 http 将视频流式传输到 iphone/ipod touch，而无需使用 .net 的适当流服务器？可能是某种渐进式下载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-03T09:29:04.863

我建议的最好方法是使用 HTML 5。iDevices (iPhone/iPod Touch/iPad) 不支持 Silverlight 或 Flash。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T16:39:55.857

我认为您尝试观看视频的移动设备具有“视频大小限制”，因为当我测试我的网站时，我会通过 wifi 测试所有内容以适应现实世界的场景，当我达到一定的视频大小时，我无法观看该移动设备上的视频。1gb 以下的视频效果很好，但是当我尝试观看 2.5gb 高清视频时，它不会在我的 ipod/ipad/iphone/android 设备上打开视频....

# sql-server - 更改表中的列顺序时出现问题 (SQL Server 2008)

> ID：930713
> 
> 赞同：4
> 
> 时间：2009-05-30T22:04:12.277
> 
> 标签：sql-server, ddl

当我尝试更改此列列表时：

```
Nombre
Imagen
Descripcion
Activo
IdLineaProducto 
```

进入这个（IdLineaProducto 是第一个）

```
IdLineaProducto
Nombre
Imagen
Descripcion
Activo 
```

SQL Server Management Studio 表示不允许保存更改，因为必须删除并重新创建表（西班牙语......）。我可以在 SQL Server 2005 中执行此操作，但不能在 SQL Server 2008 中执行此操作。

在其他情况下也会发生同样的情况，例如尝试将 int 非标识列转换为标识。为什么会这样？我该如何解决这个问题？也许是一些配置错误的问题？SQL Server 中的一些新功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T22:32:59.240

我找到了[解决这个问题](http://pragmaticworks.com/community/blogs/brianknight/archive/2008/06/04/sql-server-2008-designer-behavior-change-saving-changes-not-permitted.aspx)的方法。

> This is by design and can be quickly fixed in Management Studio by unchecking a property. To fix this in Management Studio, go to Tools -> Options then go to the Designer Page and uncheck "Prevent saving changes that require table re-creation".

Beware that it may have [undesired consequences](http://sqlblog.com/blogs/kalen_delaney/archive/2009/01/23/management-studio-got-smarter.aspx), like losing data in other tables related to this.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T22:08:01.007

这就是它的工作方式......您只能将列添加到末尾，除非您`DROP`和`CREATE`它（通常将数据复制出和复制回，IDE 可能会提供帮助）。但是*为什么*要更改顺序？即使它不理想，你的`SELECT`等也可以处理这个......即

```
SELECT IdLineaProducto, Nombre, Imagen, Descripcion, Activo
FROM   TheTable
... 
```

（仅使用很少是一个好主意`SELECT *`）

* * *

重新`IDENTITY`; 再次，这是列的基础 - 尽管在这种情况下，您可以将数据复制出来，`DROP`列，然后`ADD`将列重新复制为`IDENTITY`（在右侧），然后将其复制回来 - 但是您会遇到额外的复杂情况`IDENTITY INSERT`和`SEED`值（因此您不会尝试获取现有身份值的重复项）。

# javascript - JavaScript 的替代品

> ID：930716
> 
> 赞同：147
> 
> 时间：2009-05-30T22:06:09.963
> 
> 标签：javascript, browser

目前，唯一完全受支持的语言以及浏览器中 DOM 树操作的事实上的标准是 JavaScript。看起来它有很深的设计问题，使其成为新手的错误和安全漏洞的雷区。

您是否知道任何现有的或计划的倡议来为下一代浏览器中的 DOM 树操作和 HTTP 请求引入一种更好的（重新设计的）任何类型的语言（不仅仅是 javascript）？如果是，那么将其集成到 Firefox 中的路线图是什么？如果不是，出于什么原因（除了互操作性），JavaScript 应该是浏览器平台上唯一支持的语言？

我已经使用过 jQuery，并且还阅读了“javascript: the good parts”。确实这些建议很好，但我无法理解的是：为什么只有 javascript？在服务器端（您最喜欢的操作系统平台），我们可以使用每种语言操作 DOM 树，甚至是 fortran。为什么客户端（浏览器平台）只支持javascript？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-30T22:10:04.060

javascript 的问题不在于语言本身——它是一种非常好的原型和动态语言。如果您来自 OO 背景，则有一些学习曲线，但这不是语言的错。

大多数人认为 Javascript 类似于 Java，因为它具有相似的语法和相似的名称，但实际上它更像 lisp。它实际上非常适合 DOM 操作。

真正的问题是它是由浏览器编译的，这意味着它的工作方式因客户端而异。

实际的 DOM 不仅因浏览器而异，而且在性能和布局方面也存在巨大差异。

* * *

*编辑以下有问题的澄清*

假设支持多种解释语言——你仍然有同样的问题。各种浏览器仍然有问题并且有不同的 DOM。

此外，您必须在浏览器中内置一个解释器，或者以某种方式安装为每种语言的插件（您可以在提供页面之前对其进行检查）。使 Javascript 保持一致需要很长时间。

您不能以相同的方式使用编译语言 - 然后您将引入一个无法轻松检查其功能的可执行文件。许多用户会选择不让它运行。

好的，那么对于已编译代码的某种沙箱呢？对我来说听起来像 Java Applets。或 Flash 中的 ActionScript。或 Silverlight 中的 C#。

某种 IL 标准呢？那更有潜力。使用您想要的任何语言进行开发，然后将其编译为 IL，然后浏览器会进行 JIT。

除了，Javascript 已经是那种 IL - 看看[GWT](http://code.google.com/webtoolkit/)。它允许您用 Java 编写程序，但将它们分发为 HTML 和 JS。

* * *

*在有问题的进一步澄清后进行编辑*

Javascript 不是，或者更确切地说，不是，浏览器支持的唯一语言：回到 Internet Explorer 的黑暗时代，您可以选择 Javascript 或 VBScript 在 IE 中运行。从技术上讲，IE 甚至没有运行 Javascript——它运行的是[JScript](https://en.wikipedia.org/wiki/JScript)（主要是为了避免向 Sun 支付*java*这个词，Oracle 仍然拥有*Javascript*这个名称）。

问题是 VBScript 是 Microsoft 专有的，但也不是很好。虽然 Javascript 在其他浏览器（如 FireBug）中添加了功能并获得了顶级调试工具，但 VBScript 仍然仅限 IE 并且几乎不可调试（IE4/5/6 中的开发工具不存在）。同时 VBScript 也扩展成为操作系统中一个非常强大的脚本工具，但这些功能在浏览器中都不可用（当它们出现时，它们变成了巨大的安全漏洞）。

仍然有一些公司内部应用程序使用 VBScript（并且一些依赖于这些安全漏洞），并且它们仍在运行 IE7（它们只是停止了 IE6，因为 MS 最终将其关闭）。

让 Javascript 达到目前的状态一直是一场噩梦，花了 20 年的时间。它仍然没有一致的支持，一些浏览器仍然缺少语言功能（1999 年指定）并且需要大量的填充程序。

添加用于在浏览器中解释的替代语言面临两个主要问题：

*   让所有浏览器供应商实施新的语言标准——他们在 20 年里仍然没有为 Javascript 管理过的东西。

*   第二种语言可能会削弱您已经拥有的支持，允许（例如）IE 拥有二流的 Javascript 支持，但（再次）很棒的 VBScript。我真的不想为不同的浏览器用不同的语言编写代码。

应该注意的是，Javascript 并没有“完成”——它仍在不断发展，以便在新的浏览器中变得更好。最新[版本](http://www.ecma-international.org/news/Publication%20of%20ECMA-262%206th%20edition.htm)比浏览器的实现早了几年，他们正在开发下一个。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-11-23T17:29:28.563

# 编译为 Javascript

目前，使用编译为 Javascript 的语言似乎是在编写更智能代码的同时到达所有平台的唯一现实方法，而且这种情况可能会持续很长时间。对于任何新产品，总会有一个或多个供应商不急于发货的原因。

（但我真的不认为这是一个问题。Javascript 现在已经很好地优化了。如果手动编写机器代码也是不安全的，但作为编译目标和执行语言可以正常工作。）

# 这么多选择

有越来越多的语言可以编译成 Javascript。可以在这里找到一个相当全面的列表：

*   Coffeescript Wiki 上[编译为 JS 的语言列表](https://github.com/jashkenas/coffeescript/wiki/List-of-languages-that-compile-to-JS)

# 值得注意的

我会提到一些我认为值得注意的（当然忽略了一些我不知道的宝石）：

*   [Spider](http://spiderlang.org/)出现在 2016 年。它声称吸收了 Go、Swift、Python、C# 和 CoffeeScript 的最佳创意。它不是类型安全的，但确实有一些次要的[安全特性](http://spiderlang.org/#code-safety)。

*   [Elm](http://elm-lang.org/)：Haskell 可能是所有语言中**最聪明的语言**，Elm 是 Haskell for Javascript 的变体。它具有高度的类型意识和简洁性，并提供**函数响应式编程**作为响应式模板或 MVC 意大利面条的简洁替代品。但这**对程序程序员来说可能是一个相当大的震惊**。

*   Google 的[Go](http://golang.org/)旨在简洁、简单和安全。Go 代码可以通过[GopherJS](https://github.com/gopherjs/gopherjs)编译成 Javascript 。

*   [Dart](http://www.dartlang.org/)是 Google 后来尝试替换 Javascript。它通过类似 C/Java 的语法和可选类型提供接口和抽象类。

*   [Haxe](http://haxe.org/)类似于 Flash 的 ActionScript，但它可以**针对多种语言**，因此您的代码可以在 Java、C、Flash、PHP 和 Javascript 程序中重复使用。它提供类型安全和动态对象。

*   [Opalang](http://opalang.org/)在 Javascript 中添加了语法糖，以提供**直接的数据库访问**、智能延续、类型检查并协助客户端/服务器分离。（绑定到 NodeJS 和 MongoDB。）

*   [GorillaScript](http://ckknight.github.io/gorillascript/ "大猩猩脚本")，*“一种编译为 JavaScript 的语言，旨在为用户提供支持，同时尝试防止一些常见错误。”* 类似于 Coffeescript 但更全面，提供了许多额外的功能来提高安全性并减少重复的样板模式。

*   [LiteScript](https://github.com/luciotato/LiteScript)介于 Coffeescript 和 GorillaScript 之间。它为“内联”回调提供 async/yield 语法，并检查变量拼写错误。

*   Microsoft 的[TypeScript](http://www.typescriptlang.org/)是 Javascript 的一个小型超集，可让您对函数参数设置类型限制，这可能会捕获一些错误。类似地， [BetterJS](http://betterjs.org/)允许您应用限制，但在纯 Javascript 中，可以通过添加额外调用或通过在 JSDoc 注释中指定类型。现在 Facebook 提供了[Flow](https://flowtype.org/)，它还可以执行类型推断。

*   [LiveScript](http://gkz.github.io/LiveScript/)是 Coffeescript 的衍生产品，它因其简洁而广受欢迎，但对我来说看起来不太可读。可能不是团队的最佳选择。

# 如何选择？

**选择**替代语言时，需要**考虑一些因素**：

*   如果其他开发人员将来加入您的项目，他们需要多长时间才能加快速度并学习这种语言，或者他们已经知道它的机会有多大？

*   该语言是否具有太少的功能（代码仍然充满样板）或太多的功能（需要很长时间才能掌握，在此之前一些有效的代码可能无法破译）？

*   它是否具有您的项目所需的功能？（你的项目需要类型检查和接口吗？它是否需要智能延续来避免嵌套回调地狱？是否有很多反应性？将来可能需要针对其他环境吗？）

# 未来...

Jeff Walker 写了一系列关于“Javascript 问题”[的发人深省的博客文章，包括为什么他认为](http://www.walkercoderanger.com/blog/2014/02/javascript-minefield)[TypeScript](http://www.walkercoderanger.com/blog/2014/02/typescript-isnt-the-answer)、[Dart](http://www.walkercoderanger.com/blog/2014/03/dart-isnt-the-answer)和[Coffeescript](http://www.walkercoderanger.com/blog/2014/03/coffeescript-isnt-the-answer)都没有提供足够的解决方案。[他在结论](http://www.walkercoderanger.com/blog/2014/04/what-coffeescript-should-have-been/)中提出了改进语言的一些理想特征。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-09-06T01:31:51.850

> JavaScript 应该是浏览器平台上唯一支持的语言吗？

是和不是。有一种替代方案，称为 Dart by Google，它可以编译为 JavaScript，就像 jQuery 一样，它试图使 DOM 操作更容易一些。尝试一下可能很有趣，看看吧。

*   从谷歌看到[飞镖语言](http://www.dartlang.org/)
*   从微软看[TypeScript 语言](http://www.typescriptlang.org/)

也可以看看

*   [榆树](http://elm-lang.org)
*   [卡尔](http://rzimmerman.github.io/kal/)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-30T22:10:26.743

确实，Javascript 在某一时刻是出了名的难以处理，但从那时起 Web 开发社区已经走了很长一段路。相反，我会鼓励你看看[jQuery](http://www.jquery.com/)。这很容易，并且可以抽象出所有各种问题。

而且确实没有其他替代方案可以全面发挥作用。Flash 浮现在脑海，但这也是 ECMA 脚本，对于大多数事情来说它可能已经过时了。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-30T22:14:07.373

短期内，我会使用 jQuery 之类的东西来隐藏浏览器的不兼容性。从长远来看，Silverlight 或 Adob​​e AIR 等技术可能会使未来成为一个非常不同的雷区（但仍然是一个雷区）。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-30T22:14:36.810

Doug Crockford[与 Google 进行了一次谈话，](http://www.youtube.com/watch?v=hQVTIJBZook "讲了")详细介绍了 JavaScript 的优缺点及其未来。自 1999 年以来，它实际上并没有太大变化——这可以说是一件好事（几乎所有浏览器都可以运行相同的代码，只要你知道它们的局限性），Doug 展示了好的部分在哪里主要是误解，结果非常强大。

对于 DOM 操作，将 JQuery 视为一个客户端库，它将大多数糟糕的 DOM API 替换为更容易编写的非常优雅的代码。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-30T22:12:58.077

如果您认为 JavaScript 存在严重问题，我推荐 Doug Crockford 的书[JavaScript：The Good Parts](https://rads.stackoverflow.com/amzn/click/com/0596517742)。（或在 Google 中搜索“Crockford JavaScript”以找到他完成的几个视频演示。）Crockford 勾勒出一个安全的子集和一组实践，并特别列出了要避免的语言的一些部分。

我不知道将 JavaScript 替换为操作 DOM的*事实上的手段的计划。*所以最好学会安全和良好地使用它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-30T22:09:16.870

就客户端而言，Javascript 是操作 DOM 的唯一方法。就服务器端而言，有多种方式。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-30T22:11:19.440

Internet Explorer 支持可插入的脚本语言，尽管除了 JScript 之外，IE 中唯一可靠的语言是 VBScript。

据我所见，浏览器中似乎普遍存在对动态语言的偏见，而 JavaScript 似乎足以满足这一需求，以至于网络效应使任何其他语言都无法入门。该语言实际上非常强大，尽管它在浏览器中的实现还有很多不足之处。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-05-31T00:57:19.197

如果您愿意将您的客户/访问者限制在特定的浏览器中，并且可能愿意要求他们安装插件，您可以查看[MS Silverlight——](http://silverlight.net/)一个可读的概述在[wikipedia](http://en.wikipedia.org/wiki/Silverlight)上。使用 Silverlight 2，您可以在客户端运行您用 C#、IronPython、IronRuby、VB.NET 等编写的代码；来自 Mono 项目的 Silverlight的免费[Moonlight](http://www.mono-project.com/Moonlight)克隆，承诺为 Linux 带来相同的功能。

在实践中，大多数 Web 应用程序和网站的开发人员更愿意接触比 Silverlight（最终是 Moonlight）目前所能提供的更广泛的受众——这意味着坚持使用 Javascript，或者可能是 Flash（它使用类似的编程语言，Actionscript）。

因此，即使对于拥有大量工程师和营销预算**以及**一个免费软件项目的微软来说，在其他任何事情上获得大量的思想份额、采用和牵引力都被证明是一场艰苦的战斗（可能缓解对专有锁定的担忧） )——这可能有助于解释为什么很少有兴趣，例如 Mozilla 基金会，推动实现这样的目标。“除了互操作性”，你说：但显然互操作性问题是这里的大问题，鉴于我们观察到 Silverlight 的进展......

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-31T01:25:49.623

如前所述，您拥有可以通过插件在浏览器中运行的 Flash（ActionScript，它是 Javascript 的派生语言）和 Silverlight/Moonlight（IronPython、IronRuby、JScript、VBScript、C#）（第一个更为普遍） .

如果您喜欢 Ruby，还有另一种选择：[HotRuby](http://hotruby.yukoba.jp/)，它是 javascript 中的 ruby​​ 实现，将在浏览器中运行。它还不是很成熟，但你可以看看它。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-31T01:56:51.777

一件事我没有看到提到（哦，我看到 Alcides 在我写作时提到了 HotRuby，而 Nosredna 提到了 GWT 和 Script#）并且想抛出的是 [插入语言]-on- 的许多实现JavaScript（例如，允许您在客户端或部署之前将[Ruby](http://hotruby.yukoba.jp/)、[Python](http://pyjs.org/)、[C#](http://jsc.sourceforge.net/)、[Java](http://code.google.com/webtoolkit/)、[Obj-J/Cappuccino](http://cappuccino.org/) [类似于 Obj-C/Cocoa] 或[Processing](http://processingjs.org/) [for Canvas] 转换为 JavaScript [和一些其中还具有各种抽象库]）。当然，如果在客户端上翻译它会产生性能开销，但如果您更熟悉另一种语言，它会给您一些灵活性。

不过，就我个人而言，我建议学习爱上 JavaScript。它是一种优秀、强大的语言，一旦你了解它就会非常优雅。我正面临着相反的困境，急切地想要拥有一个能够满足我所有需求的功能强大的服务器端 JavaScript/DOM 解决方案。/不请自来的意见

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-02-27T10:21:47.320

JavaScript 是网络的英语语言。英语在历史上传播开来，是因为它拥有强大的海军征服各个国家。这可以与用 JavaScript 征服网络的大公司相媲美。这是一种从多个欧洲来源（希腊语、拉丁语、日耳曼语、法语甚至一些中文和印度语）拼凑而成的语言。多年来，JavaScript 从其他语言（结构、OO、函数）中借鉴了许多概念。英语在不同的地方使用，方言和口音略有不同，这可能会使理解变得困难。就像 JavaScript 有不同的浏览器解释它有点不同。

尽管英语最初很容易学习，但它的发音非常不一致，并且例外多于规则。就像 JavaScript 一样，它总是在那里提供惊喜。

尽管有不同的口音，JavaScript 是网络的通用语。就像您可能不是英语并在这里用英语写作一样，每个网络浏览器都有一定程度的英语理解。IE6就像一个在简历上说自己流利的人，但只参加了为期两周的英语作为外语的课程。

已经有人试图取代英语作为世界主要语言，例如世界语。但他们都失败了，因为地球上大多数人都会说一些英语。同样，也很难引入更好的 JavaScript 替代品。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-30T22:26:59.877

Jquery（仍然是 javascript 但是）它真的会帮助你他们支持几乎所有的浏览器，而且学习起来并不难:)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-30T22:10:46.180

不。JavaScript 是它，但它会发展。下一个版本是“JavaScript Harmony”，您可以通过 Google 了解更多信息。

有时有人建议将字节码解释器与 JavaScript 一起放入浏览器中。可能不会发生，至少暂时不会。

我碰巧喜欢 JavaScript。但还有其他解决方案，包括将 Java 编译为 JavaScript 的 GWT 和将 C# 编译为 JavaScript 的 Script#。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-30T22:14:26.530

我认为 Javascript 不会很快被取代。对于富客户端的完全不同方法，您可能需要研究 Flex，它是一种基于 Flash 的技术。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-30T22:23:00.633

也许像 haxe（见 haxe.org）这样的东西可以帮助你。它是一种看起来比 JavaScript 更干净的语言，并且可以编译为 JavaScript，因此它可以在浏览器中运行。

我知道这不是您问题的直接答案，但我认为这对您来说可能很有趣。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-05-31T23:06:15.967

许多人都知道 Javascript 并不是最好的和最漂亮的语言。但是，目前浏览器都支持它，因此很难引入不同的语言。我们根本不需要另一场浏览器大战。

这就解释了为什么我不知道切换到不同的客户端语言的计划。

但是我认为如果您开始考虑 DOM 模型以及如何使用它，Javascript 并不是那么糟糕。很多 JS 乱七八糟的东西都是 DOM 模型工作方式的结果。

# c# - 正则表达式关键字

> ID：930733
> 
> 赞同：1
> 
> 时间：2009-05-30T22:11:11.187
> 
> 标签：c#, regex

我正在尝试在 C# 中使用正则表达式来查找一堆文本中的关键字列表。但是，我想非常具体地说明“周围”文本可以作为关键字的内容。

例如，关键字“hello”应该在 (hello)、hello.、hello< 中找到，但在 hellothere 中没有。

我的主要问题是我不需要分隔符，如果关键字是第一个词或最后一个词就可以了。我想另一种看待它的方式是文件开头和文件结尾应该是可接受的分隔符。

我是 Regex 的新手，所以我希望有人可以帮助我正确使用模式。到目前为止，我有：

```
[ <(.]+?keyword[<(.]+? 
```

其中 <, (, . 是一些示例分隔符，关键字当然是我要查找的关键字。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T22:16:52.110

您可以使用[单词边界](http://www.regular-expressions.info/wordboundaries.html)锚：

```
\bkeyword\b 
```

只有在不属于较大单词的情况下才能找到您的关键字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T22:15:51.880

您将需要查看`word boundary`(\b) 以避免匹配作为另一个单词的一部分出现的关键字（如在您的 hellothere 示例中）。

您还可以在行首 (^) 和行尾 ($) 添加匹配项，以控制关键字可能出现的位置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-30T22:15:28.697

我想你想要这样的东西：

```
(^$|[ <(.])+?keyword($|[<(.]+?) 
```

`^`和字符分别表示输入文本的`$`开始和结束。（如果您指定该`Multiline`选项，它会匹配行的开头/结尾而不是文本，但您似乎需要该`Singleline`选项。）

# ruby - hpricot中的分段错误

> ID：930742
> 
> 赞同：2
> 
> 时间：2009-05-30T22:15:05.610
> 
> 标签：ruby, segmentation-fault, hpricot

我正在使用 hpricot 来阅读 HTML。我遇到了一个分段错误错误，我用谷歌搜索，有人说升级到最新版本的 Ruby。我正在使用 rails 2.3.2 和 ruby​​ 1.8.7。如何解决此错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-03T19:11:53.283

我试图解析其中包含许多 unicode 字符的 html 页面，而 Hpricot 一直在崩溃。最后，我使用了来自 sanitize 的猴子补丁并将其放入我的 rails 应用程序的 environment.rb 中。自从我添加此补丁以来，没有发生过一次崩溃：

[http://github.com/rgrove/sanitize/blob/1e1dc9681de99e32dc166f591343dfa60fc1f648/lib/sanitize/monkeypatch/hpricot.rb](http://github.com/rgrove/sanitize/blob/1e1dc9681de99e32dc166f591343dfa60fc1f648/lib/sanitize/monkeypatch/hpricot.rb)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-25T11:42:31.520

如果您可以自由选择您的 HTML 解析库，请切换它。为什么，Hpricot 的创建者最近发布说，现在你应该更好地使用[Nokogiri](http://nokogiri.rubyforge.org/nokogiri/)而不是 HPricot。

你也可以看看 HTTParty。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-13T08:32:32.690

在 ruby​​ 1.8.5 上尝试使用 hpricot -v 0.6.161

这对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-26T17:25:11.227

从记忆中，自从我大约一年前上次使用它以来：

Hpricot 将属性存储在一个固定大小的缓冲区中，并且一些框架在文档属性中生成非常长的散列。您可以在解析之前设置一些静态字段，以设置此缓冲区的大小。

我记得它在网页上的文档中相当突出，尽管它现在已经消失了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T22:17:17.477

好吧，根据您自己的问题，我会说“升级到最新版本的 Ruby”。但是，我也遇到了 hpricot segfaulting 的问题，这似乎与我对线程的使用有关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T02:35:31.087

这似乎是错误列表中的一个突出问题。我亲身经历过。我的理论与文件中的 HTML 结构或坏/损坏的字符有关，但我还没有找到确切的位置。

以下是问题的链接：

*   [http://github.com/why/hpricot/issues/#issue/10](http://github.com/why/hpricot/issues/#issue/10)
*   [http://github.com/why/hpricot/issues/#issue/4](http://github.com/why/hpricot/issues/#issue/4)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-26T17:03:47.043

我有同样的段错误问题，但遗憾的是无法查阅 Dave 上面提到的问题，即使通过谷歌缓存 - 从我一直在谷歌搜索的 parse.rb 段错误与编码实体或 alt 字符集（重音字符也许）

sanitize lib 遇到了同样的问题并在这里发布了一个monkeypatch：http: [//github.com/rgrove/sanitize/blob/1e1dc9681de99e32dc166f591343dfa60fc1f648/lib/sanitize/monkeypatch/hpricot.rb](http://github.com/rgrove/sanitize/blob/1e1dc9681de99e32dc166f591343dfa60fc1f648/lib/sanitize/monkeypatch/hpricot.rb)

# java - 如何直观地显示 java ResultSet？

> ID：930745
> 
> 赞同：7
> 
> 时间：2009-05-30T22:15:22.067
> 
> 标签：java, sql, user-interface

我正在寻找一种在屏幕上显示 java.sql.ResultSet 的方法。最好内置在java或swing中。如果这些都没有一个简单的体面方法，我会考虑春天。

如何？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T22:20:49.623

循环遍历 ResultSet 的结果并放入 TableModel。

```
DefaultTableModel resultSetToTableModel(
     DefaultTableModel model,
     ResultSet row) throws SQLException
    {
    ResultSetMetaData meta= row.getMetaData();
    if(model==null) model= new DefaultTableModel();
    String cols[]=new String[meta.getColumnCount()];
    for(int i=0;i< cols.length;++i)
        {
        cols[i]= meta.getColumnLabel(i+1);
        }

    model.setColumnIdentifiers(cols);

    while(row.next())
        {
        Object data[]= new Object[cols.length];
        for(int i=0;i< data.length;++i)
             {
             data[i]=row.getObject(i+1);
             }
        model.addRow(data);
        }
    return model;
    } 
```

然后你可以做类似的事情

```
JOptionPane.showMessageDialog(null,new JScrollPane(new JTable(model))); 
```

跳它有帮助

# c# - 动态 C#.NET Web 服务

> ID：930753
> 
> 赞同：7
> 
> 时间：2009-05-30T22:17:26.073
> 
> 标签：c#, asp.net, web-services, dynamic, reflection.emit

我在 C# ASP.NET 项目中使用一个类，以允许用某种随机脚本语言编写的脚本动态公开 web 服务方法 - 换句话说，脚本应该能够公开具有任何签名的任何名称的方法（只要因为它是有效的，无论如何）通过这个 SOAP 接口（能够随意添加和删除它们，而不需要硬代码更改），因此我需要能够在 C# 中创建一个 webservice 类，同时能够在运行时动态添加和删除方法。

现在，到目前为止，我能想出的最好的计划是（运行时）生成 C# 代码来表示 web 服务，使用 System.Reflection.Emit 来编译它，然后在运行时加载程序集——只要脚本添加或从服务中删除一个方法（不应该经常发生，请注意）。

有没有人有比这更好的主意？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-02T04:37:35.957

您可以使用[SoapExtensionReflector](http://msdn.microsoft.com/en-us/library/system.web.services.description.soapextensionreflector.aspx)类修改 WSDL。从[柯克埃文斯博客](http://blogs.msdn.com/kaevans/archive/2005/11/16/493496.aspx)：

> SoapExtensionReflector 在反射您的类型时调用，以便为您的服务提供 WSDL 定义。您可以利用此类型拦截反射调用并修改 WSDL 输出。

以下示例从 2 个 Web 服务方法中删除了第一个方法：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
public class Service1 : System.Web.Services.WebService
{
   [WebMethod]
   public string HelloWorld()
   {
      return "Hello World";
   }

   [WebMethod]
   public int Multiply(int a, int b)
   {
      return a * b;
   }
} 
```

创建一个继承自 SoapExtensionReflector 的类：

```
namespace TestWebservice
{
   public class MyReflector : SoapExtensionReflector
   {
      public override void ReflectMethod()
      {
         //no-op
      }

      public override void ReflectDescription()
      {
         ServiceDescription description = ReflectionContext.ServiceDescription;
         if (description.PortTypes[0].Operations.Count == 2)
            description.PortTypes[0].Operations.RemoveAt(0);
         if (description.Messages.Count == 4)
         {
            description.Messages.RemoveAt(0);
            description.Messages.RemoveAt(0);
         }
         foreach (Binding binding in description.Bindings)
         {
            if (binding.Operations.Count == 2)
               binding.Operations.RemoveAt(0);
         }
         if (description.Types.Schemas[0].Items.Count == 4)
         {
            description.Types.Schemas[0].Items.RemoveAt(0);
            description.Types.Schemas[0].Items.RemoveAt(0);
         }
      }
   }
} 
```

将此添加到 web.config 中的 configuration/system.web 部分：

```
<webServices>
   <soapExtensionReflectorTypes>
      <add type="TestWebservice.MyReflector, TestWebservice" />
   </soapExtensionReflectorTypes>
</webServices> 
```

这应该为您提供从 WSDL 文档中动态删除方法的起点。如果 Web 方法被禁用，您还需要从 Web 方法中抛出 NotImplementedException。

最后，您需要禁用通过调用没有 ?WSDL 参数的 .asmx 端点生成的 Web 服务文档。将 wsdlHelpGenerator 元素的 href 属性设置为某个 URL。您可以使用 DefaultWsdlHelpGenerator.aspx 作为您自己的文档处理程序的起点。[请参阅XML 文件](http://msdn.microsoft.com/en-us/magazine/cc302115.aspx)中有关 Web 服务文档的问题，2002 年 8 月。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T00:34:22.880

XMLRPC 已经死了，不是吗？

SOAP 意味着一个 WSDL。如何动态生成 W​​SDL？

您应该考虑使用 WCF。我希望您能够控制生成 WSDL（和其他元数据）的过程，但您也应该能够控制传入消息的处理。特别是，您将能够检查传入的消息以确定要运行的脚本、要传递的参数等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T21:10:15.227

您可以创建输入和输出类型为的 WCF 服务，`xs:any`并将传入请求作为原始`Message`. 这将允许您接受任何类型的数据并返回任何类型的数据。你不会使用数据契约或静态类型，只是一个`Message`输入和`Message`输出。

这种方法的问题在于，从 WSDL 生成代理实际上对消费者没有任何帮助，只是提供了一个包装器来调用该方法。提供该方法可接受的数据将需要手动滚动数据类型等，这并不难，只是不像硬类型合同那样直观。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T22:21:21.790

它必须是 SOAP 接口吗？听起来它可能更适合基于路由/REST/etc 的 API。您可以`IController.Execute`很容易地在 ASP.NET MVC 中执行某些操作（使用将操作解析为方法的自定义方法）（事实上，我目前正在[为我自己的一些代码](http://code.google.com/p/protobuf-net/source/browse/trunk/demo-rpc-server-mvc/Helpers/ProtoController.cs)处理非常相似的事情）。

例如，您可能有路线：

```
http://myserver/myservice/mymethod 
```

接受（在正文或参数中）有效负载（参数），并在响应中返回结果。在非 MVC 中，您应该能够使用通配符映射的通用处理程序执行类似的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-06T10:52:08.660

这是一个建议：

*   使用 WCF。
*   使用以下博客文章中的信息从 WCF 创建 WSDL：

    [http://www.pluralsight.com/community/blogs/kirillg/archive/2006/06/18/28380.aspx](http://www.pluralsight.com/community/blogs/kirillg/archive/2006/06/18/28380.aspx)

*   然后，您可以使用 MEX 发布此信息。

*   然后这些服务会为您的客户打开以下载元数据并调用服务。

# c# - MessageBox 按钮 - 设置语言？

> ID：930754
> 
> 赞同：24
> 
> 时间：2009-05-30T22:18:11.280
> 
> 标签：c#, .net, localization, messagebox

使用时，`MessageBox.Show()`您可以选择[MessageBoxButtons](http://msdn.microsoft.com/en-us/library/system.windows.forms.messageboxbuttons%28v=vs.110%29.aspx)。可用的按钮是一个枚举，并为您提供“Yes No”、“OK Cancel”等选项。

例如，当我使用挪威语消息文本时，用户仍然会收到英文“Yes No”。

有没有办法更改按钮的文本（在 C# 中）以使语言正确？我可以覆盖文本，或者以某种方式设置当前语言环境，以便我可以使用“Ja Nei”而不是“Yes No”吗？

我不想依赖在我的客户端安装 .NET 语言包。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-30T22:28:25.787

.NET 中没有对此的本机支持（据我所知，无论如何；如果我错了，请纠正我，任何人）。我确实遇到过这篇 CodeProject 文章，它似乎通过一些消息挂钩和 P/Invoke 来解决问题：http: [//www.codeproject.com/KB/miscctrl/Localizing_MessageBox.aspx](http://www.codeproject.com/KB/miscctrl/Localizing_MessageBox.aspx)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-30T22:29:23.553

通常消息框按钮（与所有 Windows 一样）支持当前为 Windows 设置的 UI 语言。因此，如果您安装了英文并且无法更改语言（MUI 版本或 Vista/7 的 Ultimate），那么您就不走运了。

你可以自己实现一个消息框，但我求你不要这样做。当人们开始重新发明方轮时，我最想念的就是按钮的常用热键、使用 Ctrl+Ins 复制内容等简单的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T22:29:00.200

我认为不可能，但请参阅 MSDN 文章*[MessageBox.Show Method](http://msdn.microsoft.com/en-us/library/system.windows.forms.messagebox.show(vs.71).aspx)*。你可能会得到一些想法。您可以更改消息框中的文本。如何创建自己的消息框（新表单）并显示它们？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-12T15:57:15.720

您可以创建一个`pnlExitMode`具有属性的面板 ( )，`Visible=false`并将信息文本以及标记为 YES 和 NO 的按钮 ( `btnYes`, `btnNo`)（带有“您的”语言的按钮标题）放在此面板上，然后将所需的 Yes/No- 操作放入按钮事件处理例程。在决策时（在我的情况下：如果`ini`在关闭应用程序时文件尚未写入，则发出警告）将面板设置为`Visible`. 将弹出带有按钮的面板。

**示例代码：**

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    if (bIniModified) 
    {
        pnlExitMode.Visible = true; pnlExitMode.BringToFront();
        e.Cancel = true;
    }
}
private void btnYes_Click(object sender, EventArgs e)
{
    SaveToIni();
    pnlExitMode.Visible = false; bIniModified = false;
    Application.Exit();
}
private void btnNo_Click(object sender, EventArgs e)
{
    pnlExitMode.Visible = false; bIniModified = false;
    Application.Exit();
} 
```

# .net - 如何使用 Fluent 设置 NHibernate.Burrow？

> ID：930755
> 
> 赞同：0
> 
> 时间：2009-05-30T22:19:11.637
> 
> 标签：.net, asp.net, orm, nhibernate-burrow

我对在我的 ASP.NET 应用程序中使用 NHibernate.Burrow 进行会话处理和 DAO 非常感兴趣，但我在配置时遇到了问题。Burrow 需要一个 XML NHibernate 配置来设置其持久性，但我没有配置文件，因为我使用 Fluent NHibernate 来生成我的配置。那么有没有办法让 Burrow 知道我的 Fluent 配置？希望这是有道理的。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-27T08:01:51.180

[http://andyhitchman.wordpress.com/2009/02/24/fluent-nhibernate-with-burrow/](http://andyhitchman.wordpress.com/2009/02/24/fluent-nhibernate-with-burrow/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-04T07:43:37.780

[http://www.reversealchemy.net/2009/08/27/configuring-nhibernate-burrow-using-fluent-nhibernate/](http://www.reversealchemy.net/2009/08/27/configuring-nhibernate-burrow-using-fluent-nhibernate/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T00:50:30.367

我没有使用 FNH 配置 Burrow，但我知道可以使用 Fluent NHibernate 将其他属性注入到 NHibernate 配置中。

此工作单元文件的第 117 行显示了如何将属性与 FNH 配置相结合。

[http://gist.github.com/108433](http://gist.github.com/108433)

第 150 行显示了这些属性在 FNH 配置中的实际使用位置。

# arrays - List.Sort IComparer 性能

> ID：930763
> 
> 赞同：3
> 
> 时间：2009-05-30T22:22:57.387
> 
> 标签：arrays, list, sorting, icomparer

我正在尝试对一对 int 数组进行排序 (int[] a; int[] b;)

如果我使用 Array.Sort(a,b) 那么性能很棒。

但是，我更喜欢使用 List<> 并将 int 对加载到结构中。我可以使用带有重载的 Array.Sort() 来实现它，该重载为结构提供了一个简单的比较器，但它比 Array.Sort(a,b) 慢了大约 4 倍

这正常吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T22:35:40.577

这听起来很现实；您正在引入更多复杂性（更多查找等，更多虚拟方法，更多范围检查），因此它只会变得更慢（数组访问非常直接且非常快速）。

`IComparer<T>`看起来你可以通过实现而不是委托方法来更快地获得它（但不如数组快） ；（**编辑**）并再次使用更快`IComparable<T>`：

```
Array.Sort: 2241ms
List.Sort (delegate): 8714ms
List.Sort (interface): 6976ms
List.Sort (comparable): 5456ms 
```

带代码：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;

struct MyStruct : IComparable<MyStruct>
{
    private readonly int key, value;
    public int Key { get { return key; } }
    public int Value { get { return value; } }
    public MyStruct(int key, int value)
    {
        this.key = key;
        this.value = value;
    }
    public int CompareTo(MyStruct other)
    {
        return key.CompareTo(other.key);
    }
}
static class Program
{
    static void Main()
    {
        const int SIZE = 10000000;
        int[] a = new int[SIZE], b = new int[SIZE];
        Random rand = new Random();
        for(int i = 0 ; i < SIZE ; i++) {
            a[i] = rand.Next();
            b[i] = i;
        }
        var list = new List<MyStruct>(SIZE);
        for (int i = 0; i < SIZE; i++)
        {
            list.Add(new MyStruct(a[i], b[i]));
        }
        var list2 = new List<MyStruct>(list);
        var list3 = new List<MyStruct>(list);

        var watch = Stopwatch.StartNew();
        Array.Sort(a, b);
        watch.Stop();
        Console.WriteLine("Array.Sort: " + watch.ElapsedMilliseconds + "ms");

        watch = Stopwatch.StartNew();
        list.Sort((x, y) => x.Key.CompareTo(y.Key));
        watch.Stop();
        Console.WriteLine("List.Sort (delegate): " + watch.ElapsedMilliseconds + "ms");

        watch = Stopwatch.StartNew();
        list2.Sort(MyComparer.Default);
        watch.Stop();
        Console.WriteLine("List.Sort (interface): " + watch.ElapsedMilliseconds + "ms");

        watch = Stopwatch.StartNew();
        list3.Sort();
        watch.Stop();
        Console.WriteLine("List.Sort (comparable): " + watch.ElapsedMilliseconds + "ms");
    }
    sealed class MyComparer : IComparer<MyStruct>
    {
        private MyComparer() { }
        public static readonly MyComparer Default = new MyComparer();
        public int Compare(MyStruct x, MyStruct y)
        {
            return x.Key.CompareTo(y.Key);
        }
    }
} 
```

# javascript - 在 MooTools 中探索工具/扩展

> ID：930766
> 
> 赞同：1
> 
> 时间：2009-05-30T22:26:07.350
> 
> 标签：javascript, class, mootools, oop

我正在研究一些效果和东西来处理类/实现/扩展。这里的例子是用于基类（MooSlidesFx、MooSlidesFx.Elements），通过我正在处理的项目创建许多效果，以及两个实际上做某事的子类（MooSlidesFx.Fade、MooSlidesEffects.Elements.Fade）。

[http://paste.mootools.net/m6afc7746](http://paste.mootools.net/m6afc7746)

第一个类 MooSlidesFx 为其他人设置了东西，旨在实现。

第二个类，MooSlidesFx.Elements，扩展了 MooSlidesFx 以同样被实现，但不仅仅是动画传入的元素，它会按顺序动画它的孩子（现在不是在寻找课程链，但它是我列表中的下一个！） ，因此重新定义了一些方法。

第三类 MooSlidesFx.Fade 效果很好。它实现了 MooSlidesFx，定义了两个小方法，然后我们就开始比赛了。

然后是问题。看来 *我*可以同时实现 MooSlidesFx.Elements 和 MooSlidesFx.Fade 和 POW ！我有一个新效果，它不会淡入元素，而是淡入它的孩子交错。

不是这样，谢谢你的帮助！

这是一大堆代码：

```
var MooSlidesFx = new Class({

    Implements: Options,

        options: {
            delay: 0,
            duration: 500,
            how: 'in',
            transition: 'sine:in:out'
        },

    initialize: function(el,options){
        this.setOptions(options);
        this.el=$(el);
        this.animation = this.setAnimation(el);
    },

    animate: function(){

        this.animation.set($clear);
        var calculations = this.calculate(this.el);
        this.animation.set(calculations[0]);

        var delayed = function(){ 
            this.animation.start(calculations[1]) 
        }.bind(this).delay(this.options.delay);

    },

    getDuration: function(){
        return this.options.delay+this.options.duration
    }

});

MooSlidesFx.Elements = new Class({

    Extends: MooSlidesFx,

        options: {
            selector: false,
            elementDelay: 200,
            order: 'normal'
        },

    animations: [],

    initialize: function(el,options){
        console.log('Elements initialize');
        this.parent(options);

        this.elements=this.el.getElements(this.options.selector);

        this.elements.each(function(el,index){
            this.animations.include(this.setAnimation(el,index));
        }.bind(this));

    },

    animate: function(){

        var eachDelay = this.options.elementDelay;
        var calculations=[];

        this.animations.each(function(animation,index){
            animation.set($clear);
            calculations.include(this.calculate(index));
            animation.set(calculations[0]);
        }.bind(this));

        var delayed = function(){
            this.elements.each(function(el,i){
                var go = function(){
                    console.log('going '+i)
                    this.animations[i].start(calculations[i][1]);
                }.bind(this).delay(d);
                eachDelay = eachDelay + this.options.elementDelay;
            }.bind(this));
        }.bind(this).delay(this.options.delay);

    },

    getDuration: function(){
        return this.options.delay+this.options.duration+((this.elements.length-1)*this.options.elementDelay);
    }

});

MooSlidesFx.Fade = new Class({

    Implements: MooSlidesFx,

    setAnimation: function(el){
        var animation = new Fx.Tween(el,{ 
            property: 'opacity',
            duration: this.options.duration,
            transition: this.options.transition,
        });
        return animation;
    },

    calculate: function(el){
        return (this.options.how=='in') ? [0,1] : [1,0];
    }

});

MooSlidesFx.Elements.Fade = new Class({

    Implements: [MooSlidesFx.Fade,MooSlidesFx.Elements]

    // TypeError: Result of expression 'this.caller._owner.parent' [undefined] is not an object.
    // mootools-core.js (line 1173) 
});

MooSlidesFx.Elements.Fade = new Class({

    Implements: MooSlidesFx.Fade,
    Extends: MooSlidesFx.Elements

    // TypeError: Result of expression 'this.setAnimation' [undefined] is not a function.
    // MooSlides.Fx.js (line 15)
});

MooSlidesFx.Elements.Fade = new Class({

    Implements: [MooSlides.Fx.Fade, MooSlidesFx.Elements]

    // line 49 is never logged, so Elements isn't ever initialized, acts just like MooSlidesFx.Fade
});

/***** usage *****/

var fx = new MooSlidesFx.Elements.Fade('test',{ selector: 'li'}).animate();

/* 

HTML

<ul id="test">
    <li>One</li>
    <li>Two</li>
    <li>Three</li>
</ul>

*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T23:51:34.870

问题出在 MooSlidesFx.Elements 尝试扩展 MooSlidesFx 时。仍然不知道为什么，但我现在不在乎。

我意识到我在 MooSlidesFx.Elements 中扩展了 MooSlidesFx 并重新编写了每一种方法。我从中得到的唯一重用是 this.el 和一些选项。

所以...我将它们分成 MooSlidesFx.Element 和 MooSlidesFx.Elements。

然后我创建了一个库 MooSlidesFx.lib 并将 Fade 类存储在那里 (MooSlidesFx.lib.Fade)。

现在我可以：

```
MooSlidesFx.Fade = new Class({
    Implements: [MooSlidesFx.lib.Fade, MooSlidesFx.Element]
});

MooSlidesFx.Fade.Elements = new Class({
    Implements: [MooSlidesFx.lib.Fade, MooSlidesFx.Elements]
}); 
```

这太神奇了。我 <3 MooTools。现在是时候用更多的效果类来构建库了！

# javascript - jQuery iframe 滚动事件 (IE)

> ID：930779
> 
> 赞同：6
> 
> 时间：2009-05-30T22:31:59.460
> 
> 标签：javascript, jquery, internet-explorer, iframe

无法在 Internet Explorer 7 中侦听滚动事件。

我试过了：

```
$("#myIframe").scroll(function() { alert('hi'); }) 
```

适用于 FF：

```
$($("#myIframe").contents().get(0)).scroll(function() { alert('hi'); }) 
```

让按键工作：

```
$($("#myIframe").contents().get(0)).keydown(function() { alert('hi'); }) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T23:51:55.587

就像我喜欢 jQuery 一样。我不能让它工作。但是，我在普通的旧 javascript 中尝试了这个，它在 IE、FF、Safari 和 Chrome 中运行良好。

```
<script type="text/javascript">
    window.onload = function() {
      var frm = document.getElementById("myIframe").contentWindow;
      frm.onscroll = function(){
        alert("EUREKA");
      }
    }
</script> 
```

**编辑：**使用 window.load() 时，以下内容适用于 FF、Safari 和 Chrome。使用 document.ready 时，它仅适用于 FF。无论出于何种原因，它在任何一种情况下都不能在 IE8 中工作。

```
$(window).load(function(){
    $($('#myIframe').contents()).scroll(function(){
       alert('frame scrolled in jquery');
    }); 
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-02T11:03:25.270

我知道这是一个旧线程，但有些人会发现它很有用。

`$(document).scroll()`可以替换为`$(window).scroll()`，到目前为止它对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-28T20:16:26.813

尝试这个：

在遍历嵌套浏览上下文的 dom 之前，必须发生 2 件事。

您需要知道 iframe 存在，并由 document ready 事件处理。

并且您需要确保 iframe 已加载。

IE：

```
 $(document).ready(function(){

        // #page is the id of the iframe
        $('#page').load(function(){
            // $(this)[0].contentWindow is the window of your nested browsing context/ iframe
            $($(this)[0].contentWindow).scroll(function(){
                console.log($(this).scrollTop());
            });
        });
     }); 
```

需要注意的一件事是，这绝对不能在 Firefox 中跨浏览器工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-08T20:30:58.197

把这个放在父母身上：

```
var childScrollHandler = function () {
   alert('Scrolling going on');
} 
```

然后把它放在 iframe 内容上：

```
$(document).bind('scroll', function(ev){
    parent.childScrollHandler(ev);
}); 
```

替换`$(document)`为您尝试收听的任何元素。

# .htaccess - .htaccess - 漂亮的用户配置文件 URL

> ID：930789
> 
> 赞同：1
> 
> 时间：2009-05-30T22:39:29.710
> 
> 标签：.htaccess, mod-rewrite

我想让我的用户配置文件“漂亮”。这是常规网址：

user.php?user=用户名

我希望它变成：

用户/用户名

请帮助 :) 我是 .htaccess 新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T22:42:40.873

试试这些指令：

```
RewriteEngine on
RewriteRule ^user/([^/]+)$ user.php?user=$1 [L,QSA] 
```

`/user/`*`foobar`*此规则将任何具有内部表单 URL 路径的请求重写为`/user.php?user=`*`foobar`*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T22:41:40.733

```
RewriteRule ^user/(.+)$ user.php?user=$1 [L,QSA] 
```

# apache-flex - AS3 项目 - 鼠标移动侦听器在应用程序之外做出反应

> ID：930791
> 
> 赞同：1
> 
> 时间：2009-05-30T22:40:01.033
> 
> 标签：apache-flex, actionscript-3, listeners, stage

我遇到了一种不寻常的行为，我似乎无法深究。当我运行它时，如果我在 swf 区域中移动，它通常会在鼠标移动时跟踪。值得期待。

但是当我单击屏幕上的*任意位置时，它会跟踪移动事件。*如果我单击并拖动，它的轨迹就好像我在浏览器的 swf 区域中移动一样。

这是代码。我已经简化为它的准系统。只需将其放入 Flex 中名为“Engine”的空 AS3 项目中 - 显然没有引号。

```
package {
import flash.display.Sprite;
import flash.events.MouseEvent;

[SWF(width='640', height='360', backgroundColor='#888888', frameRate='31')]
public class Engine extends Sprite
{       
    public function Engine()
    {
        // Add the mouse handlers
        stage.addEventListener(MouseEvent.MOUSE_MOVE, mouseMoveHandler);
    }

    public function mouseMoveHandler(evt:MouseEvent):void
    {
        trace("move");
    }
}
} 
```

作为一种解决方法，我添加了 MOUSE_MOVE 一个 MOUSE_OVER 并在 MOUSE_OUT 上删除它。但是这种行为似乎仍然很不寻常，我有兴趣了解它为什么会发生。

谁能告诉我如何将事件限制在应用程序的实际阶段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T09:57:25.097

如前所述，您无法阻止这些事件触发。它们会被触发，直到您释放鼠标。

您可以做的是将 MouseEvent 的坐标与舞台的边界进行比较，而忽略外面的那些。

```
public function mouseMoveHandler(evt:MouseEvent):void
{
    if (evt.stageX >= 0 && evt.stageX <= stage.stageWidth &&
        evt.stageY >= 0 && evt.stageY <= stage.stageHeight)
    {
        trace("move");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T09:03:15.627

如果您在 Flash 电影内部单击并将鼠标拖到外部，则 MOUSE_MOVE 事件将继续触发，直到您松开鼠标。MOUSE_LEAVE 仅当您在播放器外部释放鼠标时才会触发。这就是 Flash Player 的工作方式。

也许我错了，但我认为你不能改变这种行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T11:43:27.523

好的，这是一个仅在 Mac 上发生的已知错误。

这里有一个修复：

[http://www.visible-form.com/blog/transformmanager-fix-for-mac-firefox/](http://www.visible-form.com/blog/transformmanager-fix-for-mac-firefox/)

# .net - .NET Kiosk 屏幕键盘

> ID：930793
> 
> 赞同：1
> 
> 时间：2009-05-30T22:40:13.577
> 
> 标签：.net, keyboard, kiosk

我为我们的信息亭应用程序开发了一个相当简单的 OSK。它通过打开我们的 .net 应用程序中的文本框触发的 onfocus 事件来工作。问题是，我们正在尝试与单点登录服务集成，这意味着我们将打开一个网络浏览器控件来处理第三方身份验证。由于 SSO 页面的文本框位于浏览器控件中，因此我不完全确定使用现有 OSK 的最佳方式，或者我什至可以。

我最初的想法是尝试某种 javascript 注入，以添加我的应用程序可以响应的事件。然后我应该能够判断文本框何时获得焦点，并打开 OSK。OSK 关闭后，我可以使用输入的值更新表单字段。我的问题是它似乎很脆弱。SSO 页面上的 html/js 更改可能会扰乱所有信息亭的登录过程。

我看到的另一个选择是废弃我拥有的 OSK 并使用较低级别的 OSK。我用这种方法看到的问题是我发现的 OSK 软件的可编程性很差。每当我需要从用户那里获取键盘输入时，我基本上都需要启动一个第 3 方 exe，而且它看起来不像我可以使用现有解决方案那样顺利集成。

我可以混合使用这两者，将我们的 OSK 用于普通的 winforms 控件，并在需要使用 web 控件时切换到第 3 方 OSK，但我认为每个人都可以看到这种方法的问题。

任何关于走哪条路的建议/建议，以及关于实现通用 javascript 注入以允许我使用现有 OSK 的任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T18:39:26.860

```
private void Form1_Load(object sender, EventArgs e)
{
    webBrowser1.ObjectForScripting = this;
    webBrowser1.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(LoadComplete);
    webBrowser1.Navigate("http://www.google.com");
}

public void LoadComplete(object sender, WebBrowserDocumentCompletedEventArgs args)
{
    foreach(HtmlElement input in webBrowser1.Document.GetElementsByTagName("input"))
    {
        if (input.GetAttribute("type").ToLower() == "text")
        {
            input.Click += new HtmlElementEventHandler(Clicked);
        }
    }
}

public void Clicked(object sender, HtmlElementEventArgs args)
{
    // Show OSK, Get Results Text
        (sender as HtmlElement).SetAttribute("value", oskText);
} 
```

# java - 在运行时修改摆动定时器的延迟

> ID：930798
> 
> 赞同：2
> 
> 时间：2009-05-30T22:41:41.467
> 
> 标签：java, swing, queue, timer, delay

我正在开发一个队列模拟，使用 Swing Timer 在一定时间后使对象出队。间隔是通过查看队列中的下一个对象，从中获取一个整数，并设置其相应计时器的延迟来确定的。

这是程序中的相关片段（注意：`_SECONDS_PER_ITEM`是在其他地方定义的常量`2000`）：

```
// stop the timer
qTimer[q].stop();

// peek at how many items the customer has, and set the delay.
qTimer[q].setDelay(customerQueue[q].peek().getItems()*_SECONDS_PER_ITEM);

// the next time around, this method will see the flag, and dequeue the customer.
working[q] = true;

// denote that the customer is active on the UI.
lblCustomer[q][0].setBorder(new LineBorder(Color.RED, 2));

// start the timer.
qTimer[q].start(); 
```

我遇到的问题是每个客户，无论他们有多少物品，都会在一秒钟内得到处理。

我应该使用其他方法或技术来设置延迟吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T23:07:44.800

似乎在`stop()`使用 Timer 时，用于触发下一个事件的延迟是初始延迟。因此，在上述示例中使用的正确方法是`setInitialDelay()`：

```
{
// stop the timer
qTimer[q].stop();

// peek at how many items the customer has, and set the delay.
qTimer[q].setInitialDelay(customerQueue[q].peek().getItems()*_SECONDS_PER_ITEM);

// the next time around, this method will see the flag, and dequeue the customer.
working[q] = true;

// denote that the customer is active on the UI.
lblCustomer[q][0].setBorder(new LineBorder(Color.RED, 2));

// start the timer.
qTimer[q].start();

} 
```

# c# - 程序红外接收器

> ID：930804
> 
> 赞同：2
> 
> 时间：2009-05-30T22:43:34.710
> 
> 标签：c#, hook, infrared

我正在考虑为我的 HTPC 购买一个 IR 接收器。

我想知道我是否可以自己为我的 IR 接收器制作软件。

ir 接收器如何在 windows 上工作？

我的意思是，如果我安装了 IR 接收器驱动程序并按下遥控器上的一个键，会发生什么？我可以使用钩子在 c# 中按下按钮吗？如果我能抓住按下的按钮，玩起来会很有趣:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T02:21:52.070

一个好的起点是[WinLIRC](http://winlirc.sourceforge.net/)。我个人对 IR 遥控器没有任何经验，但我怀疑您使用的任何遥控器都位于抽象层后面。本质上，遥控器上的按键与普通键盘按键没有区别。

# javascript - JW FLV 播放器 Javascript 事件

> ID：930805
> 
> 赞同：0
> 
> 时间：2009-05-30T22:43:54.710
> 
> 标签：javascript, jwplayer

当用户触发 Javascript 操作时，我希望 JW FLV 从当前位置回溯 5 秒。我知道如何使用 player.sendEvent('SEEK',seconds) 发送事件。但是我不知道要经过多少秒，因为 JS 不知道当前位置。有人可以帮忙吗？ [http://developer.longtailvideo.com/trac/wiki/FlashEvents#Viewevents](http://developer.longtailvideo.com/trac/wiki/FlashEvents#Viewevents)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:35:00.717

1）您可以获得当前位置：

**getPosition()**：以数字形式返回当前播放位置（以秒为单位）。

2）然后寻找所需的位置：

**seek(position)**：跳转到当前播放项目内的指定位置。参数：`position:Number: Requested position in seconds.`

也参考[这个](http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12540/javascript-api-reference/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-04T17:15:12.687

实际上，您可以使用 javascript 获取当前位置。就是这样：

```
player.addModelListener('TIME', 'timeMonitor');
var time = null;
function timeMonitor(obj) {
  time = obj.position;
} 
```

时间变量不断更新，所以只需执行以下操作：

```
function userTriggeredJsAction(){
   var newTime = time - 5;
   player.sendEvent('SEEK',newTime);
} 
```

# c# - 通过 C# 登录网站

> ID：930807
> 
> 赞同：83
> 
> 时间：2009-05-30T22:44:50.743
> 
> 标签：c#, httpwebrequest, webclient

我对使用 C# 比较陌生，并且有一个可以读取网站上部分源代码的应用程序。一切正常；但问题是有问题的页面需要用户登录才能访问此源代码。我的程序需要一种方法来初始将用户登录到网站 - 完成之后，我将能够访问和阅读源代码。

需要登录的网站是：mmoinn.com/index.do?PageModule=UsersLogin

我已经搜索了一整天关于如何执行此操作并尝试了示例，但没有运气。

提前致谢

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-05-31T01:33:03.947

您可以继续使用 WebClient 进行 POST（而不是 GET，这是您当前与 DownloadString 一起使用的[HTTP 动词），但我认为您会发现使用（稍微）较低级别的类 WebRequest 和 WebResponse 会更容易。](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)

这有两个部分 - 第一个是发布登录表单，第二个是恢复“Set-cookie”标头并将其作为“Cookie”与您的 GET 请求一起发送回服务器。从现在开始，服务器将使用此 cookie 来识别您（假设它使用基于 cookie 的身份验证，我相当有信心，因为该页面返回一个包含“PHPSESSID”的 Set-cookie 标头）。

* * *

**发布到登录表单**

表单帖子很容易模拟，只需将帖子数据格式化如下：

```
field1=value1&field2=value2 
```

使用 WebRequest 和我改编自[Scott Hanselman](http://www.hanselman.com/blog/HTTPPOSTsAndHTTPGETsWithWebClientAndCAndFakingAPostBack.aspx)的代码，您可以将表单数据发布到登录表单：

```
string formUrl = "http://www.mmoinn.com/index.do?PageModule=UsersAction&Action=UsersLogin"; // NOTE: This is the URL the form POSTs to, not the URL of the form (you can find this in the "action" attribute of the HTML's form tag
string formParams = string.Format("email_address={0}&password={1}", "your email", "your password");
string cookieHeader;
WebRequest req = WebRequest.Create(formUrl);
req.ContentType = "application/x-www-form-urlencoded";
req.Method = "POST";
byte[] bytes = Encoding.ASCII.GetBytes(formParams);
req.ContentLength = bytes.Length;
using (Stream os = req.GetRequestStream())
{
    os.Write(bytes, 0, bytes.Length);
}
WebResponse resp = req.GetResponse();
cookieHeader = resp.Headers["Set-cookie"]; 
```

这是您应该在登录表单的 Set-cookie 标头中看到的示例：

```
PHPSESSID=c4812cffcf2c45e0357a5a93c137642e; path=/; domain=.mmoinn.com,wowmine_referer=directenter; path=/; domain=.mmoinn.com,lang=en; path=/;domain=.mmoinn.com,adt_usertype=other,adt_host=- 
```

* * *

**获取登录表单后面的页面**

现在您可以对需要登录的页面执行 GET 请求。

```
string pageSource;
string getUrl = "the url of the page behind the login";
WebRequest getRequest = WebRequest.Create(getUrl);
getRequest.Headers.Add("Cookie", cookieHeader);
WebResponse getResponse = getRequest.GetResponse();
using (StreamReader sr = new StreamReader(getResponse.GetResponseStream()))
{
    pageSource = sr.ReadToEnd();
} 
```

**编辑：**

如果您需要查看第一个 POST 的结果，您可以恢复它返回的 HTML：

```
using (StreamReader sr = new StreamReader(resp.GetResponseStream()))
{
    pageSource = sr.ReadToEnd();
} 
```

将它直接放在下面`cookieHeader = resp.Headers["Set-cookie"];`，然后检查 pageSource 中保存的字符串。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-06-23T08:31:29.840

您可以通过创建一个派生自 WebClient 的类、覆盖其 GetWebRequest 方法并在其上设置一个 CookieContainer 对象来大大简化事情。如果您始终设置相同的 CookieContainer 实例，则会自动为您处理 cookie 管理。

但是在发送之前获取 HttpWebRequest 的唯一方法是从 WebClient 继承并覆盖该方法。

```
public class CookieAwareWebClient : WebClient
{
    private CookieContainer cookie = new CookieContainer();

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);
        if (request is HttpWebRequest)
        {
            (request as HttpWebRequest).CookieContainer = cookie;
        }
        return request;
    }
}

var client = new CookieAwareWebClient();
client.BaseAddress = @"https://www.site.com/any/base/url/";
var loginData = new NameValueCollection();
loginData.Add("login", "YourLogin");
loginData.Add("password", "YourPassword");
client.UploadValues("login.php", "POST", loginData);

//Now you are logged in and can request pages    
string htmlSource = client.DownloadString("index.php"); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-12-10T05:01:02.497

[Matthew Brindley](https://stackoverflow.com/users/40050/matthew-brindley)，您的代码对于我需要的某些网站（需要登录）非常有效，但我需要更改为`HttpWebRequest`，`HttpWebResponse`否则我会从远程服务器收到*404 Bad Request 。*另外，我想使用您的代码分享我的解决方法，并且我尝试使用它登录到*基于 moodle 的网站*，但在您的步骤“**获取登录表单后面的页面**”时它不起作用，因为当成功*发布*登录，尽管其他网站有，但标题`'Set-Cookie'`没有返回任何内容。

所以我认为这是我们需要为下一个请求存储 cookie 的地方，所以我添加了这个。

到“ **POSTing to the login form** ”代码块：

```
var cookies = new CookieContainer();
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(formUrl);
req.CookieContainer = cookies; 
```

并到“**获取登录表单后面的页面**”：

```
HttpWebRequest getRequest = (HttpWebRequest)WebRequest.Create(getUrl);
getRequest.CookieContainer = new CookieContainer();
getRequest.CookieContainer.Add(resp.Cookies);
getRequest.Headers.Add("Cookie", cookieHeader); 
```

这样做，让我*登录*`CookieContainer`并获取“登录后页面”的源代码（基于网站的moodle）将请求发送到服务器。无论如何，这都没有问题，但这里有一个很好的信息可供阅读`WebRequest`以及`WebResponse`示例项目和教程：
[Retrieving HTTP content in .NET](http://www.west-wind.com/presentations/dotnetWebRequest/dotnetWebRequest.htm)
[How to use HttpWebRequest and HttpWebResponse in .NET](http://www.codeproject.com/KB/IP/httpwebrequest_response.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-11T22:35:43.363

有时，它可能有助于关闭`AllowAutoRedirect`和设置登录`POST`和页面`GET`请求相同的用户代理。

```
request.UserAgent = userAgent;
request.AllowAutoRedirect = false; 
```

# database - 关于构建快速分布式数据库的建议

> ID：930811
> 
> 赞同：2
> 
> 时间：2009-05-30T22:49:42.043
> 
> 标签：database, database-design, data-structures

我目前正在处理一个涉及查询大量数据（数十亿行）的问题，并且对这类事情有些缺乏经验，希望得到一些聪明的建议。

数据/问题如下所示：

1.  每个表有 2-5 个键列和 1 个值列。
2.  每行都有唯一的键组合。
3.  我需要能够通过任何键子集（即 key1='blah' 和 key4='bloo'）进行查询。
4.  能够快速插入新行（如果该行已经存在，则更新值）会很好，但如果我能慢慢地做到这一点，我会很满意。

目前，我已经在一台机器上运行的 MySQL 中实现了这个，在每个键上定义了单独的索引，一个跨所有键的索引（唯一）和一个组合第一个和最后一个键的索引（这是目前我正在做的最常见的查询，但这很容易改变）。不幸的是，这很慢（索引最终占用了大约 10 倍的磁盘空间，这不是一个大问题）。

我碰巧有一堆快速计算机可供我使用（约 40 台），这使得这个单机数据库令人难以置信的缓慢变得更加烦人。我想利用所有这些能力来使这个数据库变得更快。我考虑过构建一个分布式哈希表，但这会使仅查询键的子集变得困难。似乎 BigTable / HBase 之类的解决方案是一个不错的解决方案，但我还不相信不存在更简单的解决方案。

非常感谢，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T00:18:42.847

我建议您收听这个播客，了解有关分布式数据库的一些极好的信息。 [第 109 集-ebays-architecture-principles-with-randy-shoup](http://www.se-radio.net/2008/09/episode-109-ebays-architecture-principles-with-randy-shoup/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T22:57:00.007

指出显而易见的：你可能是磁盘绑定的。

在某些时候，如果您正在执行随机查询并且您的工作集比 RAM 大得多，那么您将受到磁盘可以执行的少量随机 IOPS 的限制。您不会比每个附加磁盘每秒数十个子查询做得更好。

如果您遇到了这个瓶颈，您可能会通过切换到 SSD、更大的 RAID 或大量 RAM 获得更多收益，而不是通过在多台计算机之间分配数据库（这通常只会让您获得更多的最后两个资源）

# javascript - 如何为 IE 调试这个 ajax 脚本？

> ID：930815
> 
> 赞同：1
> 
> 时间：2009-05-30T22:54:37.760
> 
> 标签：javascript, ajax, internet-explorer

我在一个页面中有一个 AJAX 脚本，它工作得很好，firefoex 中没有错误，但是 IE6 加载页面时状态栏上有一个丑陋的错误图标。我可以解决/调试此问题的最佳方法是什么？

这是错误报告：

![替代文字](https://i.stack.imgur.com/CGbyR.jpg)

我已经多次检查第 323 行这是函数：

```
function checkAvailability(){

   var card_select  = document.getElementById('card_select').value;
   var price_select = document.getElementById('price_select').value;
   var num_of_cards = document.getElementById('num_of_cards').value;
   var url = 'checkAvailability.php?cardName=' + card_select + '&value=' + price_select + '&amount=' + num_of_cards;

   var xmlhttp;
            if (window.XMLHttpRequest)
            {
                // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else if (window.ActiveXObject)
            {
                // code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            else
            {
                alert("Your browser does not support XMLHTTP!");
            }

            xmlhttp.onreadystatechange =    function()
                                            {
                                                if(xmlhttp.readyState == 4 && xmlhttp.responseText) /**** line 323 ****/
                                                {
                                                    document.getElementById('submit_button').className      = 'hidden';
                                                    document.getElementById('div_error_massage').className  = 'anounce_div';
                                                    document.getElementById('error_massage').innerHTML      = xmlhttp.responseText;
                                                    document.getElementById('num_of_cards').className       = 'red_inputs';
                                                }
                                                else if(isNaN(num_of_cards))
                                                {
                                                    document.getElementById('submit_button').className      = 'hidden';
                                                    document.getElementById('num_of_cards').className       = 'red_inputs';
                                                    document.getElementById('div_error_massage').className  = 'hidden';

                                                }
                                                else if(num_of_cards != "" && !xmlhttp.responseText) 
                                                {
                                                    document.getElementById('submit_button').className      = '';
                                                    document.getElementById('error_massage').innerHTML      = 'Total: $' + document.getElementById('price_select').value * document.getElementById('num_of_cards').value  + '.00';
                                                    document.getElementById('div_error_massage').className  = 'anounce_div';

                                                }
                                                else
                                                {
                                                    document.getElementById('submit_button').className      = 'hidden';
                                                    document.getElementById('num_of_cards').className       = 'red_inputs';
                                                }
                                            }

            xmlhttp.open("GET",url,true);
            xmlhttp.send(null);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T23:10:30.507

在 IE 中，您可以尝试旧的[脚本调试器](http://www.microsoft.com/downloads/details.aspx?FamilyID=2f465be0-94fd-4569-b3c4-dffdf19ccd99&displaylang=en)或[Visual Web Developer Express](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)。当错误抛出时，进入调试器并检查`xmlhttp`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T23:29:26.957

除了 outis 的回答之外，如果您想使用调试器控制跳转的位置，请使用 Javascript 的`debugger`关键字，它的作用类似于断点。当与行`debugger;`被击中时，在 IE 中您将收到一个提示（如果在 IE 中启用了调试，请检查您的 Internet 选项）以启动调试器，从该行开始。在 Firefox 中，该`debugger;`语句被 Firebug 作为断点拾取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T01:32:08.613

当 readyState 不是 4 时，您正在尝试阅读 !xmlhttp.responseText

尝试删除该行并查看 IE 是否运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T01:56:37.940

MS Office 附带了一个出色的 IE Javascript 调试器。

一个快速的谷歌显示这是一个howto：[http ://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)

# .net - 为什么 OpenFileDialog 会更改我的工作目录？

> ID：930816
> 
> 赞同：15
> 
> 时间：2009-05-30T22:56:35.587
> 
> 标签：.net, openfiledialog

为什么 OpenFileDialog 会更改我的工作目录？我应该假设 System.Windows.Forms 中的许多功能会改变我的工作目录吗？

```
 OpenFileDialog open = new OpenFileDialog();
    open.Filter = filter;
    a = Directory.GetCurrentDirectory(); //<-- correct
    if (open.ShowDialog() == DialogResult.OK) //-- select a file on my desktop
    {
        a = Directory.GetCurrentDirectory(); //<-- incorrect, is set to my desktop 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-09T17:08:22.843

或者你可以让它不这样做。请参阅[FileDialog.RestoreDirectory](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.restoredirectory.aspx)属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-07-06T04:04:37.200

我们在当前项目中发现的是 OpenFileDialog 不再更改当前目录，从而使属性 .RestoreDirectory 过时。每当我们打开文件时（在 Windows XP 中运行时），应用程序中的代码用于更改当前目录。它在 Windows 7 中不再这样做。结果它破坏了我们的应用程序，因为现在我们的数据集不知道文件在哪个目录中，当我们尝试使用没有完整路径的文件名来反序列化它时。如果您计划迁移到 Windows 7，请注意。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-30T23:09:36.733

当前工作目录可以在运行时更改，是的。

考虑使用

```
Directory.GetParent(Assembly.GetExecutingAssembly().Location) 
```

或者

```
System.AppDomain.CurrentDomain.BaseDirectory 
```

当您需要您的应用程序目录时。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-30T23:09:51.130

这是一种痛苦，尽管在某些方面你可能会预料到......如果你多次进入一个打开的对话框（在一个应用程序中），你经常会在上次离开它的地方找到它。

如果它影响您的代码，您可以`GetCurrentDirectory()`在进入对话框之前拍摄快照，然后将其恢复（因此您的代码看不到更改）。您可能希望单独存储*用户的*工作目录（并交换它们），以便用户也获得预期的行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-01T09:36:31.963

对于为什么在XP中​​文件对话框更改当前目录，最好问MS。无论如何，XP中的打开文件对话框有这种奇怪的行为，但在w7或更高版本中没有。因此，您可以在保存从 SaveFileDialog 选择的路径后简单地设置当前目录，从而更改当前目录。

我发布了我的方法，您可以在其中看到选择的路径已保存到设置并重置当前目录

```
 private void ShowSaveFileDialog(object sender, RoutedEventArgs e)
    {    
        private const int xpVerMajorNumber = 5;        
        var saveFileDialog = new SaveFileDialog()
        {                
            FileName = Settings.Default.ExcelFileName,
            DefaultExt = "*.xlsx",
            Filter = "Excel Workbook (.xlsx)|*.xlsx"
        };

        if (saveFileDialog.ShowDialog(this) == true)
            Settings.Default.ExcelFileName = saveFileDialog.FileName;

         if (Environment.OSVersion.Version.Major <= xpVerMajorNumber)
        {
       Directory.SetCurrentDirectory(System.AppDomain.CurrentDomain.BaseDirectory);
        }

    } 
```

# c# - 参考通用注释

> ID：930819
> 
> 赞同：7
> 
> 时间：2009-05-30T23:00:27.297
> 
> 标签：c#, visual-studio, intellisense, xml-comments, xml-documentation

我想知道是否可以在评论中引用动态泛型类名并在 IDE 中有条件地解决它？

简单的基类示例：

```
// <summary>
// Retrieves all <T> members from the database.
// </summary>
public void GetAll<T>()
{
 //magic
} 
```

如果我现在从此类继承并且恰好是**User**类，那么我希望 IntelliSense 将我的评论显示为“从数据库中检索所有用户成员”。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T23:06:04.757

没有办法让 Intellisense 自动编写用于特定调用的泛型类型的名称。您可以做的最好的事情是使用[`typeparamref`](http://msdn.microsoft.com/en-us/library/ms173192.aspx)标记，它向 Visual Studio（更重要的是任何文档生成器）表明您指的是泛型类型参数（`T`在这种情况下）。

```
// <summary>
// Retrieves all <typeparamref name="T"/> members from the database.
// </summary>
public void GetAll<T>()
{
    //magic
} 
```

# mysql - 在mysql中显示innodb状态的MYISAM的等效版本是什么

> ID：930821
> 
> 赞同：7
> 
> 时间：2009-05-30T23:02:24.780
> 
> 标签：mysql

通过`Show innodb status`我可以看到有关死锁等的信息，

但我不知道 MISAM 引擎表是否有等效版本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T02:24:42.907

`show open tables`和`show table status`，虽然两者都不是 myisam 独有的，但 show table status 有更多关于 myisam 表的信息。

Myisam 只有表级锁定，没有事务，因此其表的状态要简单得多。

# refactoring - 任何类中的方法顺序

> ID：930823
> 
> 赞同：2
> 
> 时间：2009-05-30T23:04:36.320
> 
> 标签：refactoring, conventions

我对编程还是很陌生，我想编写尽可能干净的代码。

这听起来像是一个愚蠢的问题，但我应该按什么顺序排列我的方法？功能上当然没关系，但布局却有很大的不同。假设我们在一个类中有以下代码：

```
-(void)testCreateProjectWithStartDate {
    [self setUpTestCreateProjectWithStartDate];
    ...
}

-(void)setUpTestCreateProjectWithStartDate {
    testMOC = [self setUpInMemoryStore];
    [self mockOutXMLStoreForInMemoryStore];
}

- (NSManagedObjectContext *)setUpInMemoryStore {
    ...
    NSPersistentStoreCoordinator *coordMock = [self pscMock];
    ...
}

- (NSPersistentStoreCoordinator *)pscMock {
    ...
}

-(void)mockOutXMLStoreForInMemoryStore {
    ...
} 
```

我是否按照调用顺序对方法进行了排序？如果从类中的两个地方调用方法怎么办？

这段代码片段在我看来完全是一团糟——为了弄清楚什么是一个非常简单的流程，不得不跳过这么多的内容非常令人困惑。

哪种方法顺序更有意义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T23:33:57.540

我发现方法比类更正确——但我认为这是因为我做得不够：保持足够短，这样的问题就会消失。

因此，对于方法 - 长期以来一直存在关于是否在顶部初始化所有变量，或者在使用它们的位置附近初始化它们的问题（答案就在使用它们的位置附近，fwiw） - 但是如果你保持你的方法足够短，没关系。靠近使用它们的*位置*位于顶部。

至少在理论上，对于类也是如此：保持它们足够短，内部组织无关紧要（限制和不可能的情况：每个类只有一个方法；它会自动按照您声明的任何顺序进行）。如果你的类有很多方法，你想知道如何组织 - 考虑提取一些属于它们自己的类的方法。越小越好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T00:03:53.753

在我看来，这似乎没有一个明确的答案，除非你有一个标准可以为你的项目/工作场所遵循。就个人而言，如果我不遵循另一个标准，我将构造函数放在第一位，然后是析构函数。之后，我只是按方法名称的字母顺序排列它们。我有点像恐龙（自卡特政府以来我一直在编程），所以在我听说面向对象编程之前就采用了函数的字母顺序方法，并且在我开始做对象时就沿用了它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T23:23:33.740

您有多个选项可以对您的方法进行分组：

*   按功能（即需要彼此的方法靠得很近）
*   通过可见性（例如，在接口中声明的公共方法首先出现）
*   按名称（即方法仅按名称排序）

就我个人而言，我更喜欢按功能对方法进行分组，所以如果我跟踪流程，我不需要跳得太远。使用现代 IDE 为您实现跳跃，这不再是一个大问题。

在您的具体示例中，您可能希望减少方法的数量以提高可读性。如果您的方法都很短（2-3 行）并且只从一个地方调用，您可以内联代码并省略一些方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T23:28:16.007

我总是这样订购我的方法：

首先是构造函数/析构函数，然后是访问器，然后是其他按重要性排序的方法。

首先是重要的方法，所以当我打开一个文件时，我必须滚动最少才能找到最重要的方法。

public/protected/private 也一样：首先是公共的，因此在打开文件时可以快速看到其他文件中可以使用的所有内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-30T08:45:54.810

我也遇到过这个问题。我确实尝试根据类的角色对方法进行分组。这种方法并没有真正起作用，因为它留下了很多未解决的问题。我最近开始为 Objective-C 使用以下约定：

方法按受众规模递减的顺序排列，但 、 、`initialize`和`init`便利方法（即返回类的自动发布实例的类方法）除外。`dealloc``awakeFromNib`

```
//initialze, init, dealloc, awakeFromNib
//convenience methods
//properties
//IBActions
//General public methods
//Delegate methods (eg NSResponder, NSTableview etc)
//Binding and notification call back methods
//private methods 
```

我仍然不是 100% 确定如何`ivar`在头文件中订购 s 。目前我正在按内存管理责任对它们进行排序：

```
//IBOutlets
//other non-retained objects (eg delegates - these can most likely be labeled IBOutlet too)
//primative data types (no mm responsibilties)
//retained objects 
```

# wpf - 如何从 ViewModel 中聚焦并选择 TextBox 中的文本

> ID：930828
> 
> 赞同：0
> 
> 时间：2009-05-30T23:06:44.990
> 
> 标签：wpf, mvvm, textbox, focus

我正在一个简单的 WPF 应用程序的上下文中试验 MVVM。我有一个附加到按钮的命令。如果 TextBox 中的文本“不正确”，我希望 TextBox 获得焦点并选择它的所有内容。似乎做到这一点的唯一方法是通过从我的 ViewModel 中的 Command 直接调用 View，或者设置 ViewModel 触发和 View 侦听的某种 Event。从那里，视图可以直接调用相关的 TextBox。

我试图保持 MVVM 的解耦性质，但似乎我无法在 XAML 中以声明方式或直接在 ViewModel 中的代码中获得这种行为，而无需至少间接与 View 对话（接口或事件）。我还必须在 ViewModel 中保留对 View 的引用。

在这里什么会被认为是“最佳实践”，以及在“真实”MVVM 应用程序中视图与视图模型的解耦程度如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T10:44:30.743

它是与 UI 控件直接相关的代码，所以我认为在这种情况下，View 的代码隐藏是它所属的地方。您可能想要设置一个事件或类似的东西。这样它仍然像以前一样解耦 - 无论如何视图都知道视图模型，您只需在代码隐藏中添加几行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:10:11.577

我遇到了同样的问题，我所做的是制作了一个自定义文本框并从此控件公开依赖属性。

像焦点一样，选择所有文本并将这些属性绑定到视图模型。

# python - Python正则表达式 - 条件匹配？

> ID：930834
> 
> 赞同：0
> 
> 时间：2009-05-30T23:09:58.230
> 
> 标签：python, regex

我不知道这是否是正确的词，但我正在尝试提出一些可以从数学表达式中提取系数和指数的正则表达式。该表达式将以“axB+cxD+exF”的形式出现，其中小写字母是系数，大写字母是指数。我有一个可以匹配它们的正则表达式，但我想知道是否可以使用 2 个正则表达式，一个用于匹配系数，一个用于指数。有没有办法在不匹配字母的情况下将数字与一侧的字母匹配？例如，在 '3x3+6x2+2x1+8x0' 我需要得到 ['3', '6', '2', '8'] 和 ['3', '2', '1', '0' ]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T23:22:25.893

您可以使用[积极的前瞻](http://www.regular-expressions.info/lookaround.html#lookahead)来匹配后面跟着其他东西的东西。要匹配系数，您可以使用：

```
>>> s = '3x3+6x2+2x1+8x0'
>>> re.findall(r'\d+(?=x)', s)
['3', '6', '2', '8'] 
```

从[`re`](http://docs.python.org/library/re.html)模块的文档中：

> (?=...) 匹配 if ... 匹配下一个，但不消耗任何字符串。这称为前瞻断言。例如，Isaac (?=Asimov) 仅在其后跟 'Asimov' 时才会匹配 'Isaac'。

对于指数，您可以改用[正向后视](http://www.regular-expressions.info/lookaround.html#lookbehind)：

```
>>> s = '3x3+6x2+2x1+8x0'
>>> re.findall(r'(?<=x)\d+', s)
['3', '2', '1', '0'] 
```

同样，来自文档：

> (?<=...) 如果字符串中的当前位置前面有一个在当前位置结束的 ... 匹配，则匹配。这称为肯定的后向断言。(?<=abc)def 将在 abcdef 中找到匹配项，因为后视将备份 3 个字符并检查包含的模式是否匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T23:14:51.323

```
>>> import re
>>> equation = '3x3+6x2+2x1+8x0'
>>> re.findall(r'x([0-9]+)', equation)
['3', '2', '1', '0']
>>> re.findall(r'([0-9]+)x', equation)
['3', '6', '2', '8'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T23:39:36.610

没有正则表达式的另一种方法：

```
>>> eq = '3x3+6x2+2x1+8x0'
>>> op = eq.split('+')
['3x3', '6x2', '2x1', '8x0']
>>> [o.split('x')[0] for o in op]
['3', '6', '2', '8']
>>> [o.split('x')[1] for o in op]
['3', '2', '1', '0'] 
```

# javascript - 自定义嵌入 iframe 的谷歌地图

> ID：930837
> 
> 赞同：10
> 
> 时间：2009-05-30T23:11:23.047
> 
> 标签：javascript, google-maps

所以我一直在看谷歌地图，他们有“制作”你自己的地图的功能，并通过他们自己的界面添加标记和那种性质的东西。他们让您将其嵌入您的网站的方式是使用 iframe。

我一直在阅读 Google Maps 的文档，显示的示例是在页面加载时使用静态输入或使用数据库动态构建地图时创建的。这是我现在正在查看的文档...[文档](http://code.google.com/apis/maps/documentation/index.html)

所以我想知道是否有一种方法可以自定义使用谷歌界面构建的地图，就像在页面加载时构建它一样？

列维

编辑：通过阅读更多关于它的信息，我得出结论，谷歌地图基本上有两个版本？一种是为开发人员准备的，另一种是为只想要一张地图而不关心它的外观或制作方式的人准备的？谁能证实这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-01T16:18:51.647

这是正确的。iframe 地图只是指向您在 maps.google.com 上的地图的链接。如果您想更好地控制地图，则需要使用 API 创建它

*   [JS API v2](http://code.google.com/apis/maps/documentation/introduction.html#The_Hello_World_of_Google_Maps)
*   [JS API v3（新）](https://developers.google.com/maps/documentation/javascript/tutorial)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-08T22:22:04.320

我知道这是一个旧帖子，但我相信它仍然会获得很多观点。

如果您不想打扰 API 脚本并且只想真正了解基本内容，您可以将 iframe 样式的谷歌地图放在 div 中，然后为该 div 创建一个父级，并使用溢出：隐藏。然后，您可以使用它的大小与持有 iframe 的孩子的大小和边距来控制人们可以查看地图的哪些部分，即：右上角和左上角控件、下部信息、比例等。

如果您不想通过 API 完全设置地图样式并且需要快速有效的解决方案，那么这不是一条糟糕的路线。

# java - 如何克隆 JAXB 对象

> ID：930840
> 
> 赞同：9
> 
> 时间：2009-05-30T23:12:08.800
> 
> 标签：java, jaxb

我有一些需要克隆的 jaxb 对象（由 jaxb 从 xsd 生成的代码实例化）。Jaxb 类似乎没有提供一个接口来轻松地做到这一点。我不能手动编辑类，也不能扩展它——所以我需要创建一个帮助器/实用程序方法来做到这一点。最好的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T23:35:46.150

鉴于 JAXB 的目的，我认为最简单的方法是将您的对象编组为 XML 并将其解组。

更多关于[谷歌](http://www.google.com/search?q=jaxb+clone)的讨论。

JAXB FAQ[建议](https://jaxb.dev.java.net/guide/Working_with_generated_code_in_memory.html) [使用 beanlib](http://beanlib.sourceforge.net/)。

还有一些关于 jaxb2-commons 下的 Cloneable 插件的[讨论](http://www.nabble.com/cloning-JAXBElements-td4708089.html)（以及下载链接），尽管我在项目页面上找不到任何参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-03T19:37:56.813

您应该尝试[cc-xjc](http://ccxjc.sf.net)，它可以在 sourceforge 上找到。它的功能之一是生成 clone() 和复制构造函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-11T18:26:02.360

您可以使用[Copyable 插件](https://github.com/highsource/jaxb2-basics/wiki#jaxb2-basics-plugins)。它生成深拷贝/克隆方法（甚至可以使用策略自定义）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-03T13:37:43.490

我已经针对克隆 JAXB 对象的各种解决方案运行了基准测试。以下是一些结果：

1.  使用[mofokom 的 xjc-clone 插件](http://www.mofokom.biz/artifactory/snapshots-public/mofokom/xjc-clone/)似乎是最快的解决方案。它只是让您生成的所有工件都实现[`Cloneable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Cloneable.html)并公开覆盖[`Object.clone()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#clone%28%29)。不幸的是，这还没有进入 Maven 中心（还）。

2.  生成[`Serializable`](http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html)人工制品并将它们序列化/反序列化为虚拟流比使用 Java 的克隆机制慢 10 倍：

    ```
    public <T extends Serializable> T clone(T jaxbObject) {
      ByteArrayOutputStream out = new ByteArrayOutputStream();
      ObjectOutputStream o = new ObjectOutputStream(out);
      o.writeObject(jaxbObject);
      o.flush();

      ByteArrayInputStream in = new ByteArrayInputStream(out.toByteArray());
      ObjectInputStream i = new ObjectInputStream(in);
      return (T) i.readObject();
    } 
    ```

3.  编组/解组 JAXB 对象再次比序列化/反序列化慢 5 倍。这就是[ykaganovich 的](https://stackoverflow.com/a/930867/521799)解决方案所暗示的：

    ```
    public <T extends Serializable> T clone(T jaxbObject) {
      StringWriter xml = new StringWriter();
      JAXB.marshal(jaxbObject, xml);
      StringReader reader = new StringReader(xml.toString());
      return JAXB.unmarshal(reader, jaxbObject.getClass());
    } 
    ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-09T12:19:02.570

我们使用了 jaxb2-basics 插件——它在 Maven repo 中可用，只添加了一个依赖项，也可以用来生成其他有用的东西：equals、hashCode、toString、默认值等。有​​关详细信息，请参阅此链接：[http ://pragmaticintegrator.wordpress.com/2012/11/20/cloning-a-jaxb-object/](http://pragmaticintegrator.wordpress.com/2012/11/20/cloning-a-jaxb-object/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-26T18:49:42.667

这是一个旧线程，但我也必须创建可克隆的 JAXB 域对象，我认为编组 - 解组肯定不是最好的解决方案。

理想情况下，您应该使用生成的克隆方法将对象复制到内存中。有一个 Maven 插件 ( **maven-jaxb2-plugin** ) 可用于此目的。

这些是我的 Maven pom.xml 文件中的相关部分：

```
<dependency>
    <groupId>org.jvnet.jaxb2_commons</groupId>
    <artifactId>jaxb2-basics</artifactId>
    <version>0.11.1</version>
</dependency> 
```

...

```
<plugin>
    <groupId>org.jvnet.jaxb2.maven2</groupId>
    <artifactId>maven-jaxb2-plugin</artifactId>
    <executions>
        <execution>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <extension>true</extension>
        <schemaDirectory>${basedir}/src/main/xsd</schemaDirectory>
        <bindingDirectory>${basedir}/src/main/xjb</bindingDirectory>
        <args>
            <arg>-Xcopyable</arg>
        </args>
        <plugins>
            <plugin>
                <groupId>org.jvnet.jaxb2_commons</groupId>
                <artifactId>jaxb2-basics</artifactId>
                <version>1.11.1</version>
            </plugin>
        </plugins>
    </configuration>
</plugin> 
```

请注意**-Xcopyable**参数，它在所有对象中生成克隆方法。

如果你使用

```
mvn clean install 
```

为了构建项目，这将生成具有克隆实现的域类。

这是其中一个域类中与克隆相关的方法的摘录：

```
public Object clone() {
    return copyTo(createNewInstance());
}

public Object copyTo(Object target) {
    final CopyStrategy2 strategy = JAXBCopyStrategy.INSTANCE;
    return copyTo(null, target, strategy);
} 
```

您可以在此页面上找到 jaxb2 基础项目的源代码和示例：

[https://github.com/highsource/jaxb2-basics/wiki/Sample-Projects](https://github.com/highsource/jaxb2-basics/wiki/Sample-Projects)

可以从这里下载带有有用示例的版本：

[https://github.com/highsource/jaxb2-basics/releases](https://github.com/highsource/jaxb2-basics/releases)

# mysql - 如何手动更新 MySQL 表的索引？

> ID：930843
> 
> 赞同：1
> 
> 时间：2009-05-30T23:17:24.827
> 
> 标签：mysql

我不小心重置了之前的索引，现在我需要手动更新它，以便索引=表中的行数。

这个的sql命令是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T23:40:01.960

ALTER TABLE 表名 AUTO_INCREMENT = 1

# c# - 关闭form2时如何让form1刷新

> ID：930845
> 
> 赞同：3
> 
> 时间：2009-05-30T23:18:18.913
> 
> 标签：c#, winforms

当表单 2 关闭时，我希望刷新表单 1。我知道使用 form2 中的关闭事件，但这就是我迷路的地方。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T23:36:47.160

实现此目的的一个好方法是使用中介者模式。这样，您的表单不必相互了解。允许 Mediator 管理表单之间的交互，以便每个单独的表单可以专注于自己的职责。

可以实现您想要的非常粗糙的调解器可以这样实现：

```
public class FormMediator
{
    public Form MainForm { private get; set; }
    public Form SubForm { private get; set; }

    public void InitializeMediator()
    {
        MainForm.FormClosed += MainForm_FormClosed;
    }

    void MainForm_FormClosed(object sender, FormClosedEventArgs e)
    {
        SubForm.Refresh();
    }
} 
```

现在，只要主表单关闭，您的子表单就会更新，并且双方都不必知道彼此的任何信息。

**编辑：**

好的，所以我将提出这个解决方案来帮助您入门，但请注意，这只是中介者模式的基本实现。我强烈建议您阅读有关该模式和一般设计模式的信息，以便更好地了解正在发生的事情。

同样，这是一个示例，但它确实有一些基本的错误检查，应该可以帮助您。

您的表单声明将如下所示：

```
public partial class MainForm : Form
{
    private FormMediator _formMediator;

    public MainForm()
    {
        InitializeComponent();
    }

    public void SomeMethodThatOpensTheSubForm()
    {
        SubForm subForm = new SubForm();

        _formMediator = new FormMediator(this, subForm);

        subForm.Show(this);
    }
} 
```

修改后的 Mediator 实现如下所示：

```
public class FormMediator
{
    private Form _subForm;
    private Form _mainForm;

    public FormMediator(Form mainForm, Form subForm)
    {
        if (mainForm == null)
            throw new ArgumentNullException("mainForm");

        if (subForm == null)
            throw new ArgumentNullException("subForm");

        _mainForm = mainForm;
        _subForm = subForm;

        _subForm.FormClosed += MainForm_FormClosed;
    }

    void MainForm_FormClosed(object sender, FormClosedEventArgs e)
    {
        try
        {
            _mainForm.Refresh();
        }
        catch(NullReferenceException ex)
        {
            throw new InvalidOperationException("Unable to close the Main Form because the FormMediator no longer has a reference to it.", ex);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T23:25:09.883

一种解决方案是在构造函数中将 Form1 的引用传递给 Form2，然后在 Form2 的关闭事件上调用 f1.Invalidate(true)。

# firefox - 如何运行外部程序并在 Firefox-Addon 中获取返回码

> ID：930846
> 
> 赞同：4
> 
> 时间：2009-05-30T23:18:57.273
> 
> 标签：firefox, process, firefox-addon, return-value

嗨，我正在尝试从 mozilla firefox 插件启动一个外部进程（所以只允许 js 代码）。这很容易使用[NSIProcess](https://developer.mozilla.org/en/nsIProcess)，但我需要执行程序的返回码。由于[NSIProcess](https://developer.mozilla.org/en/nsIProcess)不提供获取返回码的可能性，我正在寻找另一种可能性。

我试图避免在 C 中编写我自己的 XPCom 组件，因为这会使插件平台绑定。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T00:58:27.323

您提供的链接提到了属性 exitValue - 这不是您要找的吗？

# usability - 需要可用性反馈 - 两侧较暗，中间较亮

> ID：930850
> 
> 赞同：1
> 
> 时间：2009-05-30T23:23:14.707
> 
> 标签：usability

我想从你们那里得到关于网站设计/布局的反馈（希望对相关信息有一些参考）。

[![布局](https://i.stack.imgur.com/k4ppX.png)](https://i.stack.imgur.com/k4ppX.png)

这是完整尺寸图片的链接：http: [//62.128.51.43/design/layout.png](http://62.128.51.43/design/layout.png)

该网站是类似 eBay 的服务（在特定的利基市场中）。我想听听您对这种布局是否可以在这样的网站上工作（许多类别、浏览、搜索帖子、阅读描述等）的意见。

我注意到所有像 eBay 这样的网站和像亚马逊这样的大型在线商店都有白色背景。为了给我们未来的用户带来一些不同的东西（我们将提供的服务的小改动），我们想要创建一个非标准的外观，但仍然实用且坚固，可以长期使用。

由于它不是经典的“黑底白字”与“白底黑字”布局，而是一种混合体，我想听听你的意见。

该网站旨在供私人消费者和企业用户使用。

如果您对大型网站的类似布局有任何参考（希望是相同类型的网站），请发布它们。

此外，我想知道这种网站是否应该具有流畅的布局（随着分辨率的提高而延伸）或固定的布局（居中并针对 1024x768 进行优化）。

我在这里先向您的帮助表示感谢。

罗伊。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T23:40:21.037

黑白相间的外观使内容在我看来是盒装的。也许您可以使用另一种颜色，但两者之间的对比度没有那么大。

老实说，您的用户可能会更关心您的服务质量，而不是您选择作为背景的颜色。如果您的服务引人注目，除非颜色非常难看，否则这无关紧要。

就流布局而言，支持更高分辨率总是一个好主意，但前提是它有意义。我的意思是，某些内容（例如大量文本）具有影响可读性的线宽上限，因此您的流布局必须是智能的——它不能只是 width=100% 或一些这样的快捷方式。

如果您要创建供所有人使用的服务，我要记住的另一件事是允许比 1024x768 更小。我的意思是更大的字体塞进了那个分辨率。有些人看不太清楚，而且人口统计范围越广，您的布局就应该越灵活。

我的 .02

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T23:47:57.777

1）通过有一个被颜色包围的白色区域，你将用户的眼睛引导到那里，这有助于他们集中注意力。因此没关系。

2) 对于在线商店，2-3% 的观众意味着多 2-3% 的钱。因此，请务必调查用户人口统计数据，以了解他们使用的屏幕分辨率并尝试适应它们。

3) 如果使用流式布局，请记住可读文本最长为 100 个字符（有些人可能会争辩说，即使这个值太大了）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T08:40:20.820

从认知的角度来看，我不确定您的用户是否会注意到背景。虽然页脚中的高对比度效果很好。

从可用性的角度来看，您从最初的用户组中获得了哪些信息？

# linux - Linux 中的递归批量编辑

> ID：930852
> 
> 赞同：0
> 
> 时间：2009-05-30T23:24:08.607
> 
> 标签：linux, recursion, editor, bulk

我正在尝试更改多个文件中的某些行（分散在子文件夹中），而不必逐个编辑每个文件。我是查斯给的。以下

```
perl -pi.bak -e 's{[^/]Css/Template.css}{/Css/Template.css}' * 
```

它就像一个魅力，但想知道这个命令或类似的命令是否可以一次递归地完成

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T23:31:34.753

```
find . -type f -exec perl -pi.bak -e 's{[^/]Css/Template.css}{/Css/Template.css}' '{}' '+' 
```

这会将其应用于当前目录和所有子目录中的所有文件。它不会遵循符号链接。您可能还想使用 -name 指令缩小查找范围。

# python - 引用另一个项目

> ID：930857
> 
> 赞同：2
> 
> 时间：2009-05-30T23:28:44.697
> 
> 标签：python

在我制作的一个简单程序中，我想从另一个项目中获取一个列表并从中访问元素。由于我是 python 新手，我真的不知道该怎么做。在我的项目中，我选中了我想引用的项目名称框，然后......我不知道该怎么做。一些谷歌搜索对我没有好处，所以我希望这里有人可以告诉/链接我如何设置它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T23:44:31.530

使用导入。然后您可以访问“模块”（项目）及其中的所有内容，就像一个对象一样。/

```
# a.py
some_list = [1,2,3,4]

# b.py
import a
print a.some_list 
```

如果你运行 b.py，它将打印 [1,2,3,4]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T23:44:36.350

通常，如果您有一些代码，`project1.py`然后想从同一目录中的不同文件中使用它，您可以`project1`作为模块导入：

```
import project1

data = project1.my_data_function() 
```

这与您从标准库中导入任何模块的方式相同。

# c# - 如何在 C#/VS 中构建自定义断言？

> ID：930863
> 
> 赞同：3
> 
> 时间：2009-05-30T23:33:17.090
> 
> 标签：c#, visual-studio, unit-testing

我在一些代码中遇到了一个错误，它从一些文本中提取元数据并将其放入字典中。

当我比较两个字典对象时，我的测试失败了，因为键的顺序不同。我真的不在乎钥匙的顺序。

我想要一个可用的断言方法，例如：

```
Assert.AreEquivalent(propsExpected,propsActual) 
```

这将评估为：

```
Assert.AreEqual(propsExpected.Count, propsActual.Count);
foreach (var key in propsExpected.Keys)
{
    Assert.IsNotNull(props[key]);
    Assert.AreEqual(propsExpected[key], props[key]);
} 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-18T09:43:15.660

为了完整起见，请查看 [Microsoft.VisualStudio.TestTools.UnitTesting.CollectionAssert](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.collectionassert_members%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T00:14:03.293

如果您能够使用 LINQ，

```
 void Main()
{
    Dictionary d1 = new Dictionary<int, string>();
    Dictionary d2 = new Dictionary<int, string>();  

    d1.Add(1, "1");
    d1.Add(2, "2");  
    d1.Add(3, "3");  

    d2.Add(2, "2");  
    d2.Add(1, "1");  
    d2.Add(3, "3");  

    Console.WriteLine(d1.Keys.Except(d2.Keys).ToArray().Length);  
} 

```

这会将 0 打印到控制台。除了尝试在上面的示例中找到两个列表之间的差异。

您可以将其与 0 进行比较以查找是否有任何差异。

编辑：您可以在执行此操作之前添加检查以比较 2 个字典的长度。
即你可以使用Except，***只有***当长度不同时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T00:57:23.550

使用 NUnit，您可以使用 Is.EquivalentTo() 约束比较两个集合。此约束将评估集合并检查集合是否具有相同的元素，但它不关心顺序。

[CollectionEquivalentConstraint 的文档](http://www.nunit.org/index.php?p=collectionConstraints&r=2.5) 如果您不使用 NUnit，那么您正在使用的测试框架中可能存在类似的东西？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-26T17:00:34.400

正如@Sprintstar 在@Michael La Voie 答案的评论中指出的那样，由于 Assert 类是静态的，因此无法扩展它，我解决此问题的方法通常是创建一个包含我的自定义方法的测试存储库在同一方法中进行多个断言和其他验证。对于前-

```
public static class MyTestRepository
{   
    public static void ArePropsEquivalent(
        Dictionary<string, int> propsExpected, 
        Dictionary<string, int> propsActual)
    {
        //Multiple Asserts and validation logic
        //required for Equivalence goes here
    }

    public static void ArePropsSimilar(
        Dictionary<string, int> propsExpected, 
        Dictionary<string, int> propsActual)
    {
        //Multiple Asserts and validation logic 
        //required for similarity goes here
    }
} 
```

然后我从单元测试方法中调用这些方法。

```
[TestMethod]
public void TestMthod1()
{
    //Props declaration goes here
    MyTestRepository.ArePropsEquivalent(propsExpected, propsActual);
}

[TestMethod]
public void TestMthod2()
{
    //Props declaration goes here
    MyTestRepository.ArePropsSimilar(propsExpected, propsActual);
} 
```

这样我就可以在实际的单元测试用例方法中写得更少，做更多的事情，并保持模块化（在不同模型的情况下）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-28T21:06:09.900

现在有可能（可能由 MS 添加，因为最初回答了问题） - 如果您使用`That`单例，扩展将起作用。

在这种情况下，扩展可以称为：

```
Assert.That.AreEquivalent(propsExpected,propsActual); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T00:14:54.103

从这些帖子看来，MbUnit 已经通过 AreElementsEqualIgnoringOrder 支持这一点。

[http://japikse.blogspot.com/2008/12/my-favorite-mbunit-assertions.html](http://japikse.blogspot.com/2008/12/my-favorite-mbunit-assertions.html)

[http://blog.bits-in-motion.com/2008/10/announcing-gallio-and-mbunit-v304.html](http://blog.bits-in-motion.com/2008/10/announcing-gallio-and-mbunit-v304.html)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-05-31T00:20:29.723

这里的技巧是使用 .Net 3.5 的一个新特性，称为[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

例如，要使用上面提供的代码让 Assert 类支持 AreEquivalent 方法，您可以执行以下操作：

```
public static class MyAssertExtensions
{
    public static void AreEquivalent(this Assert ast, 
        Dictionary<string, int> propsExpected, 
        Dictionary<string, int> propsActual)
    {
        Assert.AreEqual(propsExpected.Count, propsActual.Count);
        foreach (var key in propsExpected.Keys)
        {
            Assert.IsNotNull(props[key]);
            Assert.AreEqual(propsExpected[key], props[key]);
        }
    }
} 
```

这样，您实际上可以像这样调用断言：

```
Assert.AreEquivalent(propsExpected,propsActual); 
```

# python - 如何在 django 中按计算值排序

> ID：930865
> 
> 赞同：6
> 
> 时间：2009-05-30T23:34:20.863
> 
> 标签：python, django, web-applications, sorting, django-models

嘿，我想根据 django 中的计算值对对象进行排序......我该怎么做？

这是一个基于堆栈溢出的示例用户配置文件模型，它解释了我的困境：

```
class Profile(models.Model):
    user = models.ForeignKey(User)

    def get_reputation():
        ... 
        return reputation
    reputation = property(get_reputation) 
```

所以，假设我想按声誉对用户进行排序。我怎么做？我知道你不能这样做：

```
Profile.objects.order_by("-reputation") 
```

谢谢大家的帮助 ：）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-30T23:54:29.247

由于您的计算代码仅存在于 Python 中，因此您还必须在 Python 中执行排序：

```
sorted (Profile.objects.all (), key = lambda p: p.reputation) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-11-04T07:44:10.467

从 Django-1.8 开始，只要计算值可以在 SQL 中呈现，就可以使用[查询表达式](https://docs.djangoproject.com/en/1.8/ref/models/expressions/)对 QuerySet 进行排序。您也可以使用[`annotations`](https://docs.djangoproject.com/en/1.8/topics/db/aggregation/#order-by)模型作为[`order_by`](https://docs.djangoproject.com/en/1.8/ref/models/querysets/#order-by)术语。

```
from django.db.models import F
Profile.objects.annotate(reputation=(F('<field>') + ...)).order_by("-reputation") 
```

`+`, `-`,`*`和`/`等基本操作`**`可与 ​​. 一起使用`F()`。此外还有其他几个功能，例如`Count`, `Avg`, `Max`, ...

链接：

*   [聚合 -`order_by`](https://docs.djangoproject.com/en/1.8/topics/db/aggregation/#order-by)
*   [进行查询 - 过滤器可以引用模型上的字段](https://docs.djangoproject.com/en/1.8/topics/db/queries/#filters-can-reference-fields-on-the-model)
*   [查询表达式 - 内置表达式](https://docs.djangoproject.com/en/1.8/ref/models/expressions/#built-in-expressions)

另请参阅此 SO Q&A：[Order a QuerySet by aggregate field value](https://stackoverflow.com/a/476033/1020470)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-31T01:41:57.377

如果您需要在数据库中进行排序（因为您有很多记录，并且需要对它们进行分页），唯一真正的选择是将信誉转换为非规范化字段（例如在`save()`模型上的覆盖方法中更新）。

# git - 跨多台机器管理主目录有一些差异？

> ID：930871
> 
> 赞同：4
> 
> 时间：2009-05-30T23:38:30.730
> 
> 标签：git, dvcs, configuration-management

所以我现在有一个非常定制的点文件设置，我一直在寻找一种解决方案来保持机器之间的同步。我喜欢拥有一个 ~/dotfiles 目录（或类似目录）的想法，其中包含一个处理符号链接创建的 makefile。通过 rsync/unison/dvcs/whatever 将 dotfiles 目录从一个机器移动到另一个机器，我很高兴。

出现此问题是因为某些机器上的文件略有不同，我想要一种方法来跟踪它。例如，我的 .xmobarrc（不熟悉的面板应用程序）有一个配置设置，可以在我的笔记本电脑上显示电池寿命，而不是在我的台式机上。

像这样管理具有每台机器差异的文件的最佳方法是什么，如果我在一台机器上更改应该影响所有机器的东西，我可以合并回来，如果我在一台机器上更改不应该合并，不会。显然，与 rsync/unison/etc 不同的是，需要像 git 这样的 DVCS，但我不确定如何设置它。

主分支，每台机器一个分支，我来回选择合并/变基/樱桃？这似乎有点乏味。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T06:43:15.330

一种方法是：

*   具有所有全局参数的全局配置（如果您更改它并将其合并回来，它将影响所有机器）
*   每台机器一个配置文件（例如以机器名称命名）
*   一个脚本，将您的最终配置文件构建为全局配置文件和基于机器的配置文件的组合。

考虑合并：

*   当您将配置文件从一个分支合并到另一个分支时，您可以合并所有内容（不涉及挑选）
*   或者您不必总是每台机器都有一个分支，因为基于机器的配置文件已经确保这些参数的分离和隔离（在不同的文件而不是不同的分支中）

# design-patterns - c#方法循环和控制

> ID：930875
> 
> 赞同：0
> 
> 时间：2009-05-30T23:40:15.890
> 
> 标签：design-patterns, loops, methods

我有一个方法，我想一遍又一遍地运行。我希望能够启动和停止这个过程。

我一直在使用这种模式进行一些套接字工作，我想知道我可以做出哪些改进？

```
public delegate void VoidMethod();

public class MethodLooper
{
    private VoidMethod methodToLoop;
    private volatile bool doMethod;
    private readonly object locker = new object();
    private readonly Thread loopingThread;

    public void Start()
    {
        if (!doMethod)
        {
            doMethod = true;
            loopingThread.Start();
        }
    }

    public void Stop()
    {
        if (doMethod)
        {
            doMethod = false;
            loopingThread.Join();
        }
    }

    public void ChangeMethod(VoidMethod voidMethod)
    {

        if (voidMethod == null)
            throw new NullReferenceException("voidMethod can't be a null");

        Stop();
        lock (locker)
        {
            methodToLoop = voidMethod;
        }
    }

    public MethodLooper(VoidMethod voidMethod)
    {
        if (voidMethod == null)
            throw new NullReferenceException("voidMethod can't be a null");
        methodToLoop = voidMethod;
        loopingThread = new Thread(new ThreadStart(_MethodLoop));
    }

    private void _MethodLoop()
    {
        VoidMethod methodToLoopCopy;
        while (doMethod)
        {
            lock (methodToLoop)
            {
                methodToLoopCopy = methodToLoop;
            }
            methodToLoopCopy();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T23:50:53.623

好吧，您应该将 doMethodToLoop 表示为 volatile。如 MSDN 中所述：

> “ volatile 关键字表示程序中的字段可以被操作系统、硬件或并发执行的线程等修改。”

我很着急，但是您应该从打开代码中查看[本教程。](http://www.switchonthecode.com/tutorials/csharp-tutorial-simple-threaded-tcp-server)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T00:09:53.147

一个更安全的版本是这样做：

```
private readonly object m_locker = new object(); // readonly so it can never be null
private readonly Thread m_workerThread; // readonly so must set in constructor,
    // and never can be null afterwards

private Action m_methodToRun;
private volatile bool m_keepGoing = true; // needs to be volatile or else you need to lock around accesses to it.

public Constructor()
{
  m_workerThread = new Thread(ThreadWorker);
}

public void SetMethod(Action action)
{
  lock(m_locker)
    m_methodToRun = action;
}

private void ThreadWorker()
{
  while(m_keepGoing)
  {
    // use a lock to take a local copy in case another thread sets m_methodToRun to null
    // while we are processing things
    Action methodLocal;
    lock(m_locker)
      methodLocal = m_methodToRun;

    methodLocal(); // call it
    // Note: Remember that the underlying method being pointed to must ALSO be
    // thread safe. Nothing you do here can make up for that if it is not.
  }
}

private void Stop()
{ 
  m_keepGoing = false; 
  m_workerThread.Join(); // BLOCK and wait for it to finish
}

private void Start()
{ 
  m_keepGoing = true;
  m_workerThread.Start();
} 
```

有关易失性与锁定的更详细信息，请参阅[this other question](https://stackoverflow.com/questions/154551/volatile-vs-interlocked-vs-lock/154803#154803)

# php - apc vs eaccelerator vs xcache

> ID：930877
> 
> 赞同：105
> 
> 时间：2009-05-30T23:43:11.377
> 
> 标签：php, apc, opcode-cache, xcache, eaccelerator

我正在研究使用其中的哪一个，但我真的找不到一个突出的。 [Eaccelerator](http://eaccelerator.net/)比[APC](http://pecl.php.net/apc)快，但 APC 维护得更好。[Xcache](http://xcache.lighttpd.net/)更快，但其他的语法更简单。

任何人都建议使用哪个以及为什么？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-05-31T00:28:44.763

APC 将包含在 PHP 6 中，我猜它被选中是有充分理由的 :)

它相当容易安装，并且肯定会加快速度。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-31T00:12:46.573

查看基准和比较：

[这里](http://www.ducea.com/2006/10/30/php-accelerators/) 和[这里](http://2bits.com/articles/benchmarking-drupal-with-php-op-code-caches-apc-eaccelerator-and-xcache-compared.html) 和[那里](http://2bits.com/articles/benchmarking-apc-vs-eaccelerator-using-drupal.html)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-31T00:52:48.117

APC 肯定。它是由 PHP 人编写的，因此即使它可能无法共享最高速度，但您可以打赌它是最高质量的。

另外，您还可以获得我一直使用的其他一些漂亮的功能（[http://www.php.net/apc](http://www.php.net/apc)）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-31T00:37:22.513

最后我选择了 eAccelerator - 速度提升、内存占用更小以及非常易于安装的事实影响了我。它还有一个不错的基于 Web 的前端来清除缓存并提供一些统计信息。

它不再维护的事实对我来说不是问题 - 它有效，这就是我所关心的。将来，如果它破坏了 PHP6（或其他），那么我将重新评估我的决定并可能会选择 APC，因为它已被 PHP 开发人员采用（因此应该更容易安装）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-07-05T08:52:08.497

指出每个版本（包括日期）的当前稳定、不稳定和开发版本可能很重要：

## 装甲运兵车

[http://pecl.php.net/package/apc](http://pecl.php.net/package/apc)

```
dev        dev          2013-09-12
3.1.14     beta         2013-01-02
3.1.9      stable       2011-05-14 
```

## Xcache

[http://xcache.lighttpd.net/](http://xcache.lighttpd.net/)

```
dev/3.2     dev        2013-12-13
dev/3.1     dev        2013-11-05
3.1.0       stable     2013-10-10
3.0.4       stable     2013-10-10 
```

## 电子加速器

[https://github.com/eaccelerator/eaccelerator](https://github.com/eaccelerator/eaccelerator)

```
dev         dev        2012-08-16
0.9.6-rc1   unstable   2010-01-26
0.9.5.1     stable     2007-05-16 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-12-02T13:17:36.937

在我见过的所有测试中，eAccelerator 的执行速度都比任何其他缓存都快，并且使用的内存更少。它带有一个漂亮的脚本来查看缓存利用率和清除缓存等。eAccelerator 与 xdebug 和 Zend Optimizer 兼容。

APC 包含在 PHP 中是因为它由 PHP 开发人员维护。它的性能非常好，但不如 eAccelerator。并且它与 Zend Optimizer 存在兼容性问题。

Xcache 是由 lighttpd 的开发人员制作的，基准测试表明它的性能类似于 eAccelerator，并且比 APC 更快。

那么哪个是最好的？

APC = 如果您想要一个始终与 PHP 一起使用的简单缓存，那就太好了，不用大惊小怪。eAccelerator = 如果您有时间维护它，保持更新并了解它的工作原理，它将执行得更快。长期支持不如 APC 确定，因为 APC 是由 PHP 开发人员完成的。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-11-25T14:41:15.657

我使用 Apache、Lighttp 和 Nginx 以及 Wordpress 站点测试了 eAccelerator 和 XCache。eAccelerator 每次都赢。坏事只是缺少 Debian 和 Ubuntu 的软件包。在 PHP 更新后，如果没有重新编译 eAccelerator 模块，服务器通常不再工作。

eAccelerator 上一个 RC 来自 2009/07/15 (0.9.6 rc1)，支持 PHP 5.3

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-06-13T16:06:39.963

我总是将 APC 与 php 5.1 和 5.2 一起使用，但是在将 APC 与 php 5.3 一起使用时，我遇到了很多（随机）错误：奇怪的空白页，随机内存不足错误。当我禁用 APC 时，它们都消失了。但这不是选择，因为它正在运行一个大容量的网站。

所以我尝试了加速器。到目前为止，它一直坚如磐石，速度提升甚至比 APC 还要大。APC 家伙确实需要花一些时间来修复错误。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-31T07:28:12.370

我认为除非您在站点上使用 Zend Optimizer，否则 APC 是可行的方法。APC 与 Zend Optimizer 不兼容，因此在这种情况下，您需要使用 eAccelerator 之类的东西。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-05-13T23:12:24.007

即使 eaccelerator 和 xcache 在中等负载下都表现得相当好，APC 在严重的请求强度下也能保持其稳定性。如果我们在这里谈论几百个请求/秒，您将感觉不到差异。但是，如果您想做出更多回应，请务必坚持使用 APC。特别是如果您的应用程序具有过度动态特性，这可能会在此类负载下导致锁定问题。[http://www.ipsure.com/blog/2011/eaccelerator-as-zend-extension-high-load-averages-issue/](http://www.ipsure.com/blog/2011/eaccelerator-as-zend-extension-high-load-averages-issue/)可能会有所帮助。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-09-26T15:18:09.943

如果您只想缓存 PHP 文件，您可以直接使用 eAccelerator。非常容易安装和配置，并且效果很好。

[但太糟糕了，他们从最新版本 0.9.6 中删除了 eaccelerator_put 和 eaccelerator_put。](http://eaccelerator.net/ticket/423)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-09-05T04:02:30.363

APC segfaults 整天整夜，没有使用 eAccelerator 的经验，但 XCache 非常可靠，具有大量选项和不断开发。

# asp.net-mvc - ASP.NET MVC：使用 Kigg 作为基础 MVC 应用程序

> ID：930881
> 
> 赞同：0
> 
> 时间：2009-05-30T23:44:38.393
> 
> 标签：asp.net-mvc, inversion-of-control, kigg

希望创建我的第一个 MVC 应用程序。来自 WebForms，我很高兴能创建一个我可以轻松测试的应用程序。

我研究了 Kigg（在 MVC 中完成的 Digg 克隆），从外观上看，它在其架构中使用了许多最佳实践。

话虽如此，他们的方法会成为我的 Web 应用程序（社交网站）的基础吗？

我会说我了解大约 80% 的代码，并且可能可以删除所有我不需要的东西（就他使用的业务对象和业务规则而言）。

拥有一个使用最佳实践的架构的好处是否会超过可能“你不需要它”的增加复杂性的成本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T00:21:50.487

我是 KiGG 的负责人，是的，你说得对，它有太多的扩展点，但我不相信 80% 的代码只是为了可扩展性。KiGG 的目标是证明您可以应用所有最佳实践，同时能够运行出色的应用程序 ( [DotNetShoutout.com](http://dotnetshoutout.com) )。如果需要任何澄清，或者如果您认为我们做了一些多余的事情，请告诉我，我很乐意为您提供帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T23:32:18.367

我给你的建议是从头开始。如果愿意，可以复制您在 KIGG 中看到的所有好东西（代码片段、模式、良好实践等），但尝试自己编写/重写它们（如果某些类或代码片段有用，只需复制/粘贴，没有必要达到极端：P）。这样，您将获得以下好处：

*   满足您确切需求的解决方案（不多也不少）。
*   通过编写自己的代码而不是仅仅重用其他代码，您将学习得更快（而且更多！）。
*   您会对自己的代码标准感到满意，这将使代码更容易阅读。
*   你可以个性化你喜欢的东西。
*   如果这是您的第一个 ASP.NET MVC 应用程序，您可能会遇到很多错误或错误，但这很好，您将从这些最初的错误中学到很多东西。

我就是这么看的...

# iphone - 从相机 iPhone 发送照片？

> ID：930886
> 
> 赞同：4
> 
> 时间：2009-05-30T23:48:06.967
> 
> 标签：iphone, camera, email

我已经知道如何使用 iPhone 中的相机，但我不知道如何拍照然后通过电子邮件发送。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T02:32:06.497

我假设您正在为 2.x 开发。这已在此线程 ( [https://devforums.apple.com/message/39377#39377](https://devforums.apple.com/message/39377#39377) ) 中介绍。

您可以使用数据 URL，但并非所有邮件客户端都支持它。

```
NSString *imgUrl = @"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAASUExURf///8zMzJmZmWZmZjMzMwAAAPOPemkAAAM1SURBVHjaYmBgYGBkYQUBFkYWFiCPCchixQAMCCZAACF0MAMVM4K4TFh0IGsBCCAkOxhYmBnAAKaHhZkZmxaAAGJgYIbpYGBihGgBWsTMzMwE4jIhaWGAYoAAYmCECDExYAcwGxkg5oNIgABigDqLARdgZmGB2wICrKwAAcSA3xKgIxlZ0PwCEEAMBCxhgHoWSQtAADFAAxgfYEJ1GEAAQbQw4tUCsocBYQVAADEgu4uRkREeUCwszEwwLhOKLQABhNDCBA4aSDgwwhIAJKqYUPwCEEAMUK/AUwnc9aywJMCI7DAgAAggBohZ8JTBhGIJzCoWZL8ABBCYidAB8RUjWppkYUG2BSCAGMDqEMZiswUtXgACiAHsFYixTMywGGLGpgUWYgABxAA2mQkWCMyMqFoYmdD8ACQAAogBHJHMrCxg1cyIiICmCkYWDFsAAgiihYmZCewFFpR0BfI3LLch+QUggBiQ0iQjEyMDmh54qCBlUIAAYsCRJsElADQvgWKTlRGeKwECiAF3XgGmMEYQYADZzcoA9z5AAMG9RQCAtEC9DxBADFiyFyMjVi0wABBAWLQwQdIiuhYGWJIACCBg+KKUJ9BoBRdS2LQALQMIIGDQIEmwAO1kYcVWHCDZAhBAqFqYmOAxj2YNtAwDAYAAYmDEiBYWzHKKkRERYiwAAYSphZEZwxZGZiZQVEJTJkAAMTCyokc7M5oORlC5wcoEjxeAAAJqQXU0UB6W5WFmABMtEzMi1wEEEFAbE0YyAUuzMMEsYQalMkQSBQggUDmNPU3C9IA4LCxI+QUggEBiKOU8yExgqccCL3chnkPKlQABhGo6ejHBDKmdUHMlQAAhhQvQaGZGkBIkjcAMywLmI+VKgABCSowsTJhZkhlWXiBpAQggYBqBZl9GVOdBcz0LZqEEEEAMqLULMBLg1THWog9IAwQQA0qiZcRW5aPbAhBADCg1El4tMAAQQAxoiZYZXnTh1AIQQAzo2QlYpDDjcBgrxGEAAcSAJTthswmiBUwDBBC2GpkZJTaRvQ+mAQKIAUuuxdZWQvILQABBmSxMjBj5EpcWgACCMoFOYYSpZyHQHgMIMACt2hmoVEikCQAAAABJRU5ErkJggg==";
NSString *mailString = [[ @"mailto:?subject=Subject%20Here&body=%3Cb%3EFat%20Text%3C%2Fb%3E%0A%3Cimg%20src%3D%22"stringByAppendingString:imgUrl] stringByAppendingString:@"%22%20alt%3D%22An%20image%22%20%2F%3E"]; [[UIApplication sharedApplication] openURL:[NSURL URLWithString:bodyString]];` 
```

如果你正在为 3.0 开发，那么你可以很容易地做到这一点。使用 MFMailComposeViewController。

# c++ - 无锁结构的 C++ 原子操作

> ID：930897
> 
> 赞同：12
> 
> 时间：2009-05-30T23:58:07.057
> 
> 标签：c++, atomic, lock-free

我正在使用原子（双）比较和交换指令实现无锁机制，例如 cmpxchg16b

我目前正在汇编中编写它，然后将其链接。但是，我想知道是否有办法让编译器自动为我执行此操作？例如，用“原子”包围代码块并让它弄清楚如何在底层处理器架构中将代码实现为原子指令（或者如果底层架构不支持它，则在编译时生成错误）？

PS我知道gcc有一些内置的（至少对于CAS）

[http://gcc.gnu.org/onlinedocs/gcc-4.4.0/gcc/Atomic-Builtins.html#Atomic-Builtins](http://gcc.gnu.org/onlinedocs/gcc-4.4.0/gcc/Atomic-Builtins.html#Atomic-Builtins)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-31T00:49:29.137

已经有点回答[here了](https://stackoverflow.com/questions/523827/c0x-atomic-template-implementation)。

C++0x 标准将提供一些[原子数据类型](http://www.open-std.org/JTC1/sc22/wg21/docs/papers/2007/n2427.html#DiscussOperations)，主要是使用 std::atomic<> 模板的整数和 void 类型。那篇文章提到[了 Boehm 的 atomic_ops 项目](http://www.hpl.hp.com/research/linux/atomic_ops/)，您可以立即下载并使用它。

如果没有，你不能在编译器中实现你的汇编器内联吗？我知道 MSVC 有[__asm](http://msdn.microsoft.com/en-us/library/45yd4tzz(VS.80).aspx)关键字用于内联汇编程序例程。谷歌说[是](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html)的，gcc[也可以](http://www.awarenetwork.org/home/.rants/10-07-2007.10.18/gcc.vcpp.asm.txt)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-31T00:07:42.853

C++ 未来的“C++0x”标准将支持原子操作 &c——参见[http://www.open-std.org/JTC1/sc22/wg21/docs/papers/2007/n2427.html](http://www.open-std.org/JTC1/sc22/wg21/docs/papers/2007/n2427.html)彻底的讨论。当然，在即将到来的标准被批准并广泛实施之前，没有办法在编译器之间“可移植”地获得这样的功能。如果您对 gcc 之外的特定编译器感兴趣，也许您可​​以专门针对它们提出另一个问题。

# mysql - 如何设置 MySQL 的时区？

> ID：930900
> 
> 赞同：406
> 
> 时间：2009-05-31T00:02:07.077
> 
> 标签：mysql, timezone

在一台服务器上，当我运行时：

```
mysql> select now();
+---------------------+
| now()               |
+---------------------+
| 2009-05-30 16:54:29 |
+---------------------+
1 row in set (0.00 sec) 
```

在另一台服务器上：

```
mysql> select now();
+---------------------+
| now()               |
+---------------------+
| 2009-05-30 20:01:43 |
+---------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：619
> 
> 时间：2013-09-28T16:48:01.000

我认为这可能有用：

# 在 MySQL 中可能会在三个地方设置时区：

## 在 [mysqld] 部分的文件“my.cnf”中

```
default-time-zone='+00:00' 
```

## @@global.time_zone 变量

要查看它们设置为什么值：

```
SELECT @@global.time_zone; 
```

要为其设置值，请使用以下任一：

```
SET GLOBAL time_zone = '+8:00';
SET GLOBAL time_zone = 'Europe/Helsinki';
SET @@global.time_zone = '+00:00'; 
```

（使用像“欧洲/赫尔辛基”这样的命名时区意味着您必须正确填充时区表。）

请记住，这`+02:00`是一个偏移量。`Europe/Berlin`是一个时区（有两个偏移量）并且`CEST`是对应于特定偏移量的时钟时间。

## @@session.time_zone 变量

```
SELECT @@session.time_zone; 
```

要设置它，请使用以下任一：

```
SET time_zone = 'Europe/Helsinki';
SET time_zone = "+00:00";
SET @@session.time_zone = "+00:00"; 
```

两者都可能返回 SYSTEM，这意味着它们使用 my.cnf 中设置的时区。

要使时区名称起作用，您必须设置需要填充的时区信息表：http: [//dev.mysql.com/doc/refman/5.1/en/time-zone-support.html](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)。我还提到了如何在[这个答案](https://stackoverflow.com/a/19075291/175071)中填充这些表。

## 获取当前时区偏移量为`TIME`

```
SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP); 
```

如果您的时区是 +2:00，它将返回 02:00:00。

## 要获取当前的 UNIX 时间戳：

```
SELECT UNIX_TIMESTAMP();
SELECT UNIX_TIMESTAMP(NOW()); 
```

## 获取时间戳列作为 UNIX 时间戳

```
SELECT UNIX_TIMESTAMP(`timestamp`) FROM `table_name` 
```

## 获取 UTC 日期时间列作为 UNIX 时间戳

```
SELECT UNIX_TIMESTAMP(CONVERT_TZ(`utc_datetime`, '+00:00', @@session.time_zone)) FROM `table_name` 
```

注意：更改时区**不会更改存储的 datetime 或 timestamp**，但它将显示现有时间戳列的不同日期时间，因为它们在内部存储为 UTC 时间戳，并在当前 MySQL 时区中显示在外部。

我在这里做了一个备忘单：[MySQL 是否应该将其时区设置为 UTC？](https://stackoverflow.com/questions/19023978/should-mysql-have-its-timezone-set-to-utc/19075291#19075291)

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2016-04-22T12:30:04.820

对于仍然遇到此问题的任何人：

```
value="jdbc:mysql://localhost:3306/dbname?serverTimezone=UTC" 
```

为我工作。只在最后追加`?serverTimezone=UTC`。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2012-02-10T18:11:43.647

当您可以为 MySQL 或 PHP 配置时区服务器时：

记住：

1.  更改时区系统。以 Ubuntu 为例：

    ```
    $ sudo dpkg-reconfigure tzdata 
    ```

2.  重新启动服务器，或者您可以重新启动 Apache 2 和 MySQL：

    ```
    /etc/init.d/mysql restart 
    ```

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2009-05-31T00:08:05.757

要为当前会话设置它，请执行以下操作：

```
SET time_zone = timezonename; 
```

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2013-04-17T17:08:02.270

只需在您的 MySQL 服务器上运行它：

```
SET GLOBAL time_zone = '+8:00'; 
```

+8:00 将是您的时区。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2016-10-03T12:55:52.873

这对我来说适用于印度的一个地点：

```
SET GLOBAL time_zone = "Asia/Calcutta";
SET time_zone = "+05:30";
SET @@session.time_zone = "+05:30"; 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2019-09-27T20:04:47.667

这是一个 10 年前的问题，但无论如何这对我有用。我将 MySQL 8.0 与 Hibernate 5 和 SpringBoot 4 一起使用。

我已经尝试了上述接受的答案，但对我没有用，对我有用的是：

```
db.url=jdbc:mysql://localhost:3306/testdb?useSSL=false&serverTimezone=Europe/Warsaw 
```

如果这对您有帮助，请不要忘记投票：D

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2013-11-09T19:13:17.517

请记住，“国家/地区”有时不起作用...这个问题与操作系统、MySQL 版本和硬件无关——我从 2003 年的 FreeBSD 4 和 Slackware Linux 到今天就遇到了它。MySQL 从版本 3 到最新的源主干。这很奇怪，但它确实发生了。例如：

```
root@Ubuntu# ls -la /usr/share/zoneinfo/US
total 8

drwxr-xr-x  2 root root 4096 Apr 10  2013 .
drwxr-xr-x 22 root root 4096 Apr 10  2013 ..
lrwxrwxrwx  1 root root   18 Jul  8 22:33 Alaska -> ../SystemV/YST9YDT
lrwxrwxrwx  1 root root   21 Jul  8 22:33 Aleutian -> ../posix/America/Adak
lrwxrwxrwx  1 root root   15 Jul  8 22:33 Arizona -> ../SystemV/MST7
lrwxrwxrwx  1 root root   18 Jul  8 22:33 Central -> ../SystemV/CST6CDT
lrwxrwxrwx  1 root root   18 Jul  8 22:33 Eastern -> ../SystemV/EST5EDT
lrwxrwxrwx  1 root root   37 Jul  8 22:33 East-Indiana -> ../posix/America/Indiana/Indianapolis
lrwxrwxrwx  1 root root   19 Jul  8 22:33 Hawaii -> ../Pacific/Honolulu
lrwxrwxrwx  1 root root   24 Jul  8 22:33 Indiana-Starke -> ../posix/America/Knox_IN
lrwxrwxrwx  1 root root   24 Jul  8 22:33 Michigan -> ../posix/America/Detroit
lrwxrwxrwx  1 root root   18 Jul  8 22:33 Mountain -> ../SystemV/MST7MDT
lrwxrwxrwx  1 root root   18 Jul  8 22:33 Pacific -> ../SystemV/PST8PDT
lrwxrwxrwx  1 root root   18 Jul  8 22:33 Pacific-New -> ../SystemV/PST8PDT
lrwxrwxrwx  1 root root   20 Jul  8 22:33 Samoa -> ../Pacific/Pago_Pago
root@Ubuntu# 
```

像这样的声明应该有效：

```
SET time_zone='US/Eastern'; 
```

但是你有这个问题：

> 错误代码：1298。未知或不正确的时区：'EUS/Eastern'

查看您的区域信息目录中的子文件夹，并查看符号链接的实际文件名，在本例中为 EST5EDT。然后试试这个语句：

```
SET time_zone='EST5EDT'; 
```

它实际上正在按预期工作！:) 记住这个技巧；我还没有看到它记录在 MySQL 手册和官方文档中。但是阅读相应的文档是必须做的事情：[MySQL 5.5 timezone 官方文档](http://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html)- 并且不要忘记像这样将时区数据加载到您的服务器中（以 root 用户身份运行！）：

```
mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -u root mysql 
```

技巧一 - 它必须完全在 MySQL root 用户下完成。即使是对 MySQL 数据库具有完全访问权限的用户，它也可能会失败或产生无法工作的结果——我自己也看到了这个故障。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-05-31T00:09:55.410

您可以在启动服务器时指定服务器的默认时区，请参阅[http://dev.mysql.com/doc/refman/5.1/en/server-options.html](http://dev.mysql.com/doc/refman/5.1/en/server-options.html)和具体的`--default-time-zone=timezone`选项。您可以检查全球和会话时区

```
SELECT @@global.time_zone, @@session.time_zone; 
```

用语句设置一个或两个`SET`， &c; 有关更多详细信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html 。](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2017-09-29T09:06:47.403

如果您使用的是 PDO：

```
$offset="+10:00";
$db->exec("SET time_zone='".$offset."';"); 
```

如果您使用的是 MySQLi：

```
$db->MySQLi->query("SET time_zone='".$offset."';"); 
```

有关在此处格式化偏移量的更多信息： [https ://www.sitepoint.com/synchronize-php-mysql-timezone-configuration/](https://www.sitepoint.com/synchronize-php-mysql-timezone-configuration/)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2018-03-10T13:42:46.903

Ancient question with one more suggestion:

If you've recently changed the timezone of the OS, e.g. via:

```
unlink /etc/localtime
ln -s /etc/usr/share/zoneinfo/US/Eastern /etc/localtime 
```

... MySQL (or MariaDB) will not notice until you restart the db service:

```
service mysqld restart 
```

(or)

```
service mariadb restart 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-11-03T03:48:53.803

如果您使用的是**MySql Workbench**，您可以通过打开管理员视图并选择 Advanced 选项卡来进行设置。顶部是“本地化”，第一个复选框应该是“默认时区”。选中该框，然后输入您想要的时区，重新启动服务器，您应该一切顺利。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2019-07-08T01:38:06.690

首先要弄清楚你可以查询的 time_zone 是什么

```
SHOW VARIABLES LIKE '%time_zone%'; 
```

您的输出应该类似于以下内容

```
**Variable_name**     **Value**
system_time_zone      CDT
time_zone             SYSTEM 
```

然后，如果您想确认您处于 CDT 之类的时区而不是 EST 之类的时区，您可以通过以下方式检查它认为您的机器所处的时间

```
SELECT NOW(); 
```

如果这不是你想要的时间，你需要改变它......你需要做的就是`SET time_zone = timezone_name`。确保它是一种`Continent/City`格式。

如果您因为有托管服务而在共享服务器上，请参阅这些关于更改 php.ini 文件或 .htaccess 文件的[答案。](https://stackoverflow.com/questions/27981208/change-mysql-timezone-from-phpmyadmin)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-04-28T10:01:20.207

[编辑 MySQL 配置文件](https://phoenixnap.com/kb/change-mysql-time-zone)

```
sudo nano /etc/mysql/my.cnf 
```

滚动并将这些添加到底部。更改为相关时区

```
[mysqld]
default-time-zone = "+00:00" 
```

重启服务器

```
sudo service mysql restart 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-06-21T11:04:44.127

**要在MariaDB**中设置标准时区，您必须转到**50-server.cnf**文件。

```
sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf 
```

然后，您可以在 mysqld 部分输入以下条目。

```
default-time-zone='+01:00' 
```

**例子：**

```
#
# These groups are read by MariaDB server.
# Use it for options that only the server (but not clients) should see
#
# See the examples of server my.cnf files in /usr/share/mysql/
#

# this is read by the standalone daemon and embedded servers
[server]

# this is only for the mysqld standalone daemon
[mysqld]

#
# * Basic Settings
#
user            = mysql
pid-file        = /var/run/mysqld/mysqld.pid
socket          = /var/run/mysqld/mysqld.sock
port            = 3306
basedir         = /usr
datadir         = /var/lib/mysql
tmpdir          = /tmp
lc-messages-dir = /usr/share/mysql
skip-external-locking

### Default timezone ###
default-time-zone='+01:00'

# Instead of skip-networking the default is now to listen only on
# localhost which is more compatible and is not less secure. 
```

必须通过配置文件进行更改，否则 MariaDB 服务器将在重新启动后重置 mysql 表！

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-09-29T08:11:41.657

在服务器选项卡下的 MySQL Workbench 8.0 中，如果您转到状态和系统变量，您可以从这里进行设置。

[![在此处输入图像描述](https://i.stack.imgur.com/pAYOu.png)](https://i.stack.imgur.com/pAYOu.png)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-01-08T10:32:02.203

通过登录到 mysql 服务器在服务器上设置 MYSQL 时区，并根据需要设置时区值。对于 IST

```
SET SESSION time_zone = '+5:30'; 
```

然后运行`SELECT NOW();`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-02-21T14:18:23.020

如果符合您的方案，您可以通过更改操作系统时区轻松完成此操作。

在 Ubuntu 中，要列出时区，请运行此命令

```
sudo timedatectl list-timezones 
```

要更改操作系统时区，请使用您的时区运行此命令

```
timedatectl set-timezone America/New_York 
```

检查操作系统时区，运行

```
date 
```

然后重启MySQL

```
sudo service mysql restart 
```

要在 MySQL 中检查时区，请登录并运行

```
SELECT TIMEDIFF(NOW(), UTC_TIMESTAMP); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-12-30T21:43:34.630

如果您使用命名时区会导致错误：

```
mysql> SET GLOBAL time_zone = "Asia/Bangkok";    
ERROR 1298 (HY000): Unknown or incorrect time zone: 'Asia/Bangkok' 
```

你可以试试：

```
mysql_tzinfo_to_sql tz_file tz_name | mysql -u root -p mysql 
```

接着：

```
SET GLOBAL time_zone = "Asia/Bangkok";
SET time_zone = "+07:00";
SET @@session.time_zone = "+07:00"; 
```

检查现在几点：

```
SELECT NOW(); 
```

参考： [https ://dev.mysql.com/doc/refman/5.7/en/time-zone-support.html#time-zone-installation](https://dev.mysql.com/doc/refman/5.7/en/time-zone-support.html#time-zone-installation)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-07-29T16:35:11.920

您必须设置您的位置时区。所以按照下面的过程
打开你的 MSQLWorkbench 写一个像这样的简单 sql 命令；

```
select now(); 
```

你的网址也可能是这样的；

```
url = "jdbc:mysql://localhost:3306/your_database_name?serverTimezone=UTC"; 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-11-18T08:14:17.167

就我而言，解决方案是将高级设置中的 serverTimezone 参数设置为适当的值（我的时区的 CET）。

当我使用 IntelliJ 时，我使用它的数据库模块。在向数据库添加新连接并在“常规”选项卡中添加所有相关参数后，“测试连接”按钮出现错误。同样，解决方案是在高级选项卡中设置 serverTimezone 参数。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-06-11T10:31:02.263

如果有人在使用 GoDaddy 共享主机，您可以尝试以下解决方案，为我工作。

启动数据库连接时，在我的 PDO 对象中设置 time_zone 命令，例如：

```
$pdo = new PDO($dsn, $user, $pass, $opt);
$pdo->exec("SET time_zone='+05:30';"); 
```

其中“+05:30”是印度的时区。您可以根据需要更改它。

在那之后; 所有与日期和时间相关的 MySQL 进程都设置了所需的时区。

来源：[https ://in.godaddy.com/community/cPanel-Hosting/How-to-change-TimeZone-for-MySqL/td-p/31861](https://in.godaddy.com/community/cPanel-Hosting/How-to-change-TimeZone-for-MySqL/td-p/31861)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-08-27T18:25:00.040

在 Windows (IIS) 上，为了能够 SET GLOBAL time_zone = 'Europe/Helsinki' （或其他），需要首先填充 MySQL time_zone 描述表。

我从这个链接下载了这些[https://dev.mysql.com/downloads/timezones.html](https://dev.mysql.com/downloads/timezones.html)

运行下载的 SQL 查询后，我能够设置 GLOBAL time_zone 并解决我遇到的问题 where SELECT NOW(); 正在返回 GMT 而不是 BST。

# mysql - 如何使用 Symfony 插件 DbFinderPlugin 制定查询以按列分组？

> ID：930902
> 
> 赞同：0
> 
> 时间：2009-05-31T00:05:05.887
> 
> 标签：mysql, plugins, symfony1, count

我无法弄清楚如何使用带有 Symfony 和 Propel 的 DbFinderPlugin 1.2.2 编写以下查询：

```
SELECT species, COUNT(*) FROM Bird GROUP BY species; 
```

[这是 DbFinderPlugin 页面](http://www.symfony-project.org/plugins/DbFinderPlugin)

我对插件相当陌生，到目前为止我确实很喜欢它，但是这个查询到目前为止让我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T00:35:22.423

我不是 DBFinder 的专家，但看起来以下应该可以工作

```
$result = DbFinder::from('Bird')->
  groupBy('species')-> 
  select(array('species', 'count(*) cnt'))->
  find(); 
```

编辑更改代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T00:35:56.927

事实证明，您必须使用 withColumn 才能获得正确的结果：

```
$result = DbFinder::from('Bird')
    ->withColumn('count(Bird.Id)', 'total_birds')
    ->groupBy(species')
    ->find(); 
```

# java - 计算给定日期的一天

> ID：930904
> 
> 赞同：5
> 
> 时间：2009-05-31T00:06:25.963
> 
> 标签：java, date

从给定的日期开始，我需要计算当天的午夜。这就是我想出的。太丑了，我想一定有更好的方法。

```
private Date day(Date creation) {
    Calendar calendar = Calendar.getInstance();
    calendar.setTime(creation);
    calendar.set(Calendar.HOUR_OF_DAY, 0);
    calendar.set(Calendar.MINUTE, 0);
    calendar.set(Calendar.SECOND, 0);
    calendar.set(Calendar.MILLISECOND, 0);
    return calendar.getTime();
} 
```

建议？

肯特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T08:08:53.537

您应该考虑过时的内置日期 API。而是使用 Joda 日期和时间 API。

这是您的方法的直接替代品。

```
private Date day(Date creation) {
    return new DateMidnight(creation).toDate();
} 
```

这是一个简单的测试：

```
public static void main(String[] args) {
    final Date creation = new Date();
    final Date midnight = new Foobar().day(creation);
    System.out.println("creation = " + creation);
    System.out.println("midnight = " + midnight);
} 
```

输出是：

```
creation = Sun May 31 10:09:38 CEST 2009    
midnight = Sun May 31 00:00:00 CEST 2009 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T01:33:32.277

[JODA](http://joda-time.sourceforge.net/)可能有更好的解决方案，但代价是对库的另一个依赖。我正在查看它的[DateMidnight 属性](http://joda-time.sourceforge.net/api-release/index.html)。很抱歉我不能更权威地回答，但我自己不是JODA用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T00:24:17.720

如果您正在寻找当地时间，那是您将获得的最佳时间。尽管您可能认为它丑陋，但幕后（可能）发生了很多事情。

如果您想要午夜 UTC，以下将起作用：

```
public static void main(String[] argv)
throws Exception
{
    final long MILLIS_PER_DAY = 24 * 3600 * 1000L;

    long midnightUTC = (System.currentTimeMillis() / MILLIS_PER_DAY) * MILLIS_PER_DAY;
} 
```

**编辑**：我真的不建议在“生产”代码中使用本地日期。它们造成的麻烦多于它们的价值——考虑一下美国西海岸的一个人，他突然发现他/她的“一天”被修剪了 3 个小时，因为东海岸的计算机对午夜有不同的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T14:41:42.823

如果您有严重的日历需求，至少在[JSR-310](https://jsr-310.dev.java.net/)进入 JDK 之前（如果不是 1.8，可能是 1.7），[JODA是您的最佳选择。](http://joda-time.sourceforge.net/)

话虽如此，有几件事可以使这段代码更好一点。

```
import static java.util.Calendar.*;

...

private static final List<Integer> TIME_FIELDS = 
    Arrays.asList(HOUR_OF_DAY, MINUTE, SECOND, MILLISECOND);

private Date day(Date creation) {
     Calendar c = getInstance();
     c.setTime(creation);
     for(int field : TIME_FIELDS) c.set(field, 0);
     return c.getTime();
} 
```

那不会赢得任何表演奖。您可以根据特定字段值执行标准 for 循环（Calendar 类具有 FIELD_COUNT 字段类型，暗示您可以执行类似操作），但这可能会在 JDK 实现之间和版本之间存在问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-13T02:38:22.663

使用[date4j](http://www.date4j.net)库：

```
DateTime start = dt.getStartOfDay(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T01:37:58.727

我认为你要让这段代码变得更好的唯一方法是改变表示。例如，

*   [用 Nachum Dershowitz 和 Ed Reingold 在日历计算](http://emr.cs.uiuc.edu/home/reingold/calendar-book/index.shtml)中解释的“绝对日期”系统表示这一天。

*   通过从午夜开始数秒来表示时间。或者，如果您需要亚秒级分辨率，请计算毫秒。

从您的简短示例中，我无法判断您的程序中的哪些点需要与现有`Date`和`Calendar`类兼容，或者您​​是否可以使用更明智的表示创建有用的子类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T01:47:50.687

有一段时间没有编写 Java 了，但您可以调用这个[set 方法](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html#set(int,%20int,%20int))，传入年、月和日的当前值。虽然读得有点近，但你可能必须先打电话给 clear。这可能会或可能不会比使用您当前的方法更详细。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T21:21:40.870

这只是对最初发布的代码的补充。它在新的 GregorianCalendar 对象中设置年、月和日，而不是清除日历变量中除年、月和日之外的所有内容。这并没有太大的改进，但我认为更清楚地说你正在复制哪些字段，而不是你忽略了哪些字段。

```
public Date day(Date creation) {
    Calendar calendar = Calendar.getInstance();
    calendar.setTime(creation);
    return new GregorianCalendar(
            calendar.get(Calendar.YEAR),
            calendar.get(Calendar.MONTH),
            calendar.get(Calendar.DAY_OF_MONTH)).getTime();
} 
```

就个人而言，我认为我会选择其他人提出的 Joda 库。

# sql-server - 用于商业 Windows 应用程序的嵌入式数据存储？

> ID：930905
> 
> 赞同：3
> 
> 时间：2009-05-31T00:06:51.373
> 
> 标签：sql-server, database

抱歉这个愚蠢的问题，因为我是新手。如果我想构建一个商业 Windows 应用程序（我会以美元出售），那么在嵌入式数据存储方面我有哪些选择？我会使用 MSDE 吗？这是我会与我的应用程序捆绑在一起的东西吗？是否有其他选择（来自 MS 和其他供应商）？您是否必须为您销售的每个应用程序副本中包含的每个产品副本向数据存储供应商支付费用？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T00:09:51.853

最好的选择之一是[SQLite](http://www.sqlite.org/)。它完全是公共领域，因此您可以将其用于任何目的（包括以盈利为目的的商业软件），而无需担心许可问题。许多不同的平台和语言都有可用的绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T00:24:47.720

您的数据需要嵌入到何种程度？如果它在进程中，那么[SQL Server Compact Edition](http://www.microsoft.com/Sqlserver/2008/en/us/compact.aspx)将是一个不错的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T00:26:11.383

继@Matt 的回答之后，如果它不需要在内存中，但确实需要一个小空间和专用于您的应用程序的服务器，那么您应该考虑免费的 SQL Server Express Edition。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:39:57.587

[Firebird](http://www.firebirdnews.org/docs/fb2min.html) can be a good choice too.

It have more features than SQLite

# java - 哪个 Java 线程占用 CPU？

> ID：930915
> 
> 赞同：69
> 
> 时间：2009-05-31T00:11:19.383
> 
> 标签：java, multithreading, cpu

假设您的 Java 程序占用了 100% 的 CPU。它有 50 个线程。你需要找出哪个线程是有罪的。我还没有找到可以提供帮助的工具。目前我使用以下非常耗时的例程：

1.  Run `jstack <pid>`，其中 pid 是 Java 进程的进程 ID。找到它的简单方法是运行 JDK 中包含的另一个实用程序 - `jps`. 最好将 jstack 的输出重定向到文件。
2.  搜索“可运行”线程。跳过那些在套接字上等待的（由于某种原因它们仍然被标记为可运行）。
3.  重复步骤 1 和 2 几次，看看您是否可以找到一个模式。

或者，您可以附加到 Eclipse 中的 Java 进程并尝试一个一个地挂起线程，直到遇到占用 CPU 的线程。在单 CPU 机器上，您可能需要首先降低 Java 进程的优先级才能移动。即使这样，Eclipse 也经常由于超时而无法附加到正在运行的进程。

我本来希望 Sun 的`visualvm`工具能够做到这一点。

有人知道更好的方法吗？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2015-03-19T15:23:02.860

确定哪个 Java 线程在生产服务器中消耗最多的 CPU。

大多数（如果不是全部）生产系统做任何重要的事情都会使用超过 1 个 java 线程。当某些事情变得疯狂并且您的 cpu 使用率达到 100% 时，很难确定是哪个线程导致了这种情况。或者我是这么想的。直到比我聪明的人向我展示了如何做到这一点。在这里，我将向您展示如何做到这一点，您也可以用您的极客技能让您的家人和朋友惊叹不已。

**测试应用程序**

为了对此进行测试，我们需要一个测试应用程序。所以我给你一个。它由3个类组成：

*   `HeavyThread`执行 CPU 密集型操作（计算 MD5 哈希）的类
*   一个`LightThread`做一些不那么密集的CPU（计数和睡眠）的类。
*   一个`StartThreads`启动 1 个 cpu 密集型和几个轻线程的类。

以下是这些类的代码：

```
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.UUID;

/**
 * thread that does some heavy lifting
 *
 * @author srasul
 *
 */
public class HeavyThread implements Runnable {

        private long length;

        public HeavyThread(long length) {
                this.length = length;
                new Thread(this).start();
        }

        @Override
        public void run() {
                while (true) {
                        String data = "";

                        // make some stuff up
                        for (int i = 0; i < length; i++) {
                                data += UUID.randomUUID().toString();
                        }

                        MessageDigest digest;
                        try {
                                digest = MessageDigest.getInstance("MD5");
                        } catch (NoSuchAlgorithmException e) {
                                throw new RuntimeException(e);
                        }

                        // hash the data
                        digest.update(data.getBytes());
                }
        }
}

import java.util.Random;

/**
 * thread that does little work. just count & sleep
 *
 * @author srasul
 *
 */
public class LightThread implements Runnable {

        public LightThread() {
                new Thread(this).start();
        }

        @Override
        public void run() {
                Long l = 0l;
                while(true) {
                        l++;
                        try {
                                Thread.sleep(new Random().nextInt(10));
                        } catch (InterruptedException e) {
                                e.printStackTrace();
                        }
                        if(l == Long.MAX_VALUE) {
                                l = 0l;
                        }
                }
        }
}

/**
 * start it all
 *
 * @author srasul
 *
 */
public class StartThreads {

        public static void main(String[] args) {
                // lets start 1 heavy ...
                new HeavyThread(1000);

                // ... and 3 light threads
                new LightThread();
                new LightThread();
                new LightThread();
        }
} 
```

假设您从未见过此代码，并且您拥有一个运行这些类并消耗 100% CPU 的失控 Java 进程的 PID。

首先让我们开始`StartThreads`上课。

```
$ ls
HeavyThread.java  LightThread.java  StartThreads.java
$ javac *
$ java StartThreads & 
```

在这个阶段，一个正在运行的 Java 进程应该占用 100 个 cpu。在我的顶部，我看到： ![顶部输出的屏幕截图](https://i.stack.imgur.com/tjjTe.png)

在顶部按 Shift-H 打开线程。top 的手册页说：

```
 -H : Threads toggle
        Starts top with the last remembered 'H' state reversed.  When
        this  toggle is On, all individual threads will be displayed.
        Otherwise, top displays a  summation  of  all  threads  in  a
        process. 
```

现在在我的顶部，线程显示打开，我看到： ![显示线程的顶部屏幕截图](https://i.stack.imgur.com/p9SO5.png)

我有一个`java`PID 进程`28294`。让我们使用以下方法获取此进程的堆栈转储`jstack`：

```
$ jstack 28924
2010-11-18 13:05:41
Full thread dump Java HotSpot(TM) 64-Bit Server VM (17.0-b16 mixed mode):

"Attach Listener" daemon prio=10 tid=0x0000000040ecb000 nid=0x7150 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"DestroyJavaVM" prio=10 tid=0x00007f9a98027800 nid=0x70fd waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"Thread-3" prio=10 tid=0x00007f9a98025800 nid=0x710d waiting on condition [0x00007f9a9d543000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at LightThread.run(LightThread.java:21)
    at java.lang.Thread.run(Thread.java:619)

"Thread-2" prio=10 tid=0x00007f9a98023800 nid=0x710c waiting on condition [0x00007f9a9d644000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at LightThread.run(LightThread.java:21)
    at java.lang.Thread.run(Thread.java:619)

"Thread-1" prio=10 tid=0x00007f9a98021800 nid=0x710b waiting on condition [0x00007f9a9d745000]
   java.lang.Thread.State: TIMED_WAITING (sleeping)
    at java.lang.Thread.sleep(Native Method)
    at LightThread.run(LightThread.java:21)
    at java.lang.Thread.run(Thread.java:619)

"Thread-0" prio=10 tid=0x00007f9a98020000 nid=0x710a runnable [0x00007f9a9d846000]
   java.lang.Thread.State: RUNNABLE
    at sun.security.provider.DigestBase.engineReset(DigestBase.java:139)
    at sun.security.provider.DigestBase.engineUpdate(DigestBase.java:104)
    at java.security.MessageDigest$Delegate.engineUpdate(MessageDigest.java:538)
    at java.security.MessageDigest.update(MessageDigest.java:293)
    at sun.security.provider.SecureRandom.engineNextBytes(SecureRandom.java:197)
    - locked <0x00007f9aa457e400> (a sun.security.provider.SecureRandom)
    at sun.security.provider.NativePRNG$RandomIO.implNextBytes(NativePRNG.java:257)
    - locked <0x00007f9aa457e708> (a java.lang.Object)
    at sun.security.provider.NativePRNG$RandomIO.access$200(NativePRNG.java:108)
    at sun.security.provider.NativePRNG.engineNextBytes(NativePRNG.java:97)
    at java.security.SecureRandom.nextBytes(SecureRandom.java:433)
    - locked <0x00007f9aa4582fc8> (a java.security.SecureRandom)
    at java.util.UUID.randomUUID(UUID.java:162)
    at HeavyThread.run(HeavyThread.java:27)
    at java.lang.Thread.run(Thread.java:619)

"Low Memory Detector" daemon prio=10 tid=0x00007f9a98006800 nid=0x7108 runnable [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"CompilerThread1" daemon prio=10 tid=0x00007f9a98004000 nid=0x7107 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"CompilerThread0" daemon prio=10 tid=0x00007f9a98001000 nid=0x7106 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"Signal Dispatcher" daemon prio=10 tid=0x0000000040de4000 nid=0x7105 runnable [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

"Finalizer" daemon prio=10 tid=0x0000000040dc4800 nid=0x7104 in Object.wait() [0x00007f9a97ffe000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <0x00007f9aa45506b0> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:118)
    - locked <0x00007f9aa45506b0> (a java.lang.ref.ReferenceQueue$Lock)
    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:134)
    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)

"Reference Handler" daemon prio=10 tid=0x0000000040dbd000 nid=0x7103 in Object.wait() [0x00007f9a9de92000]
   java.lang.Thread.State: WAITING (on object monitor)
    at java.lang.Object.wait(Native Method)
    - waiting on <0x00007f9aa4550318> (a java.lang.ref.Reference$Lock)
    at java.lang.Object.wait(Object.java:485)
    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)
    - locked <0x00007f9aa4550318> (a java.lang.ref.Reference$Lock)

"VM Thread" prio=10 tid=0x0000000040db8800 nid=0x7102 runnable 

"GC task thread#0 (ParallelGC)" prio=10 tid=0x0000000040d6e800 nid=0x70fe runnable 

"GC task thread#1 (ParallelGC)" prio=10 tid=0x0000000040d70800 nid=0x70ff runnable 

"GC task thread#2 (ParallelGC)" prio=10 tid=0x0000000040d72000 nid=0x7100 runnable 

"GC task thread#3 (ParallelGC)" prio=10 tid=0x0000000040d74000 nid=0x7101 runnable 

"VM Periodic Task Thread" prio=10 tid=0x00007f9a98011800 nid=0x7109 waiting on condition 

JNI global references: 910 
```

从我的顶部我看到顶部线程的 PID 是`28938`. 十六进制`28938`是. `0x710A`请注意，在堆栈转储中，每个线程都有一个`nid`以十六进制显示的。恰好这`0x710A`就是线程的 id：

```
"Thread-0" prio=10 tid=0x00007f9a98020000 nid=0x710a runnable [0x00007f9a9d846000]
   java.lang.Thread.State: RUNNABLE
    at sun.security.provider.DigestBase.engineReset(DigestBase.java:139)
    at sun.security.provider.DigestBase.engineUpdate(DigestBase.java:104)
    at java.security.MessageDigest$Delegate.engineUpdate(MessageDigest.java:538)
    at java.security.MessageDigest.update(MessageDigest.java:293)
    at sun.security.provider.SecureRandom.engineNextBytes(SecureRandom.java:197)
    - locked <0x00007f9aa457e400> (a sun.security.provider.SecureRandom)
    at sun.security.provider.NativePRNG$RandomIO.implNextBytes(NativePRNG.java:257)
    - locked <0x00007f9aa457e708> (a java.lang.Object)
    at sun.security.provider.NativePRNG$RandomIO.access$200(NativePRNG.java:108)
    at sun.security.provider.NativePRNG.engineNextBytes(NativePRNG.java:97)
    at java.security.SecureRandom.nextBytes(SecureRandom.java:433)
    - locked <0x00007f9aa4582fc8> (a java.security.SecureRandom)
    at java.util.UUID.randomUUID(UUID.java:162)
    at HeavyThread.run(HeavyThread.java:27)
    at java.lang.Thread.run(Thread.java:619) 
```

因此，您可以确认运行`HeavyThread`该类的线程正在消耗最多的 CPU。

在读取世界的情况下，可能是一堆线程消耗了一部分 CPU，这些线程放在一起将导致 Java 进程使用 100% 的 CPU。

概括

*   运行顶部
*   按 Shift-H 启用线程视图
*   获取CPU最高的线程的PID
*   将 PID 转换为十六进制
*   获取java进程的堆栈转储
*   查找具有匹配 HEX PID 的线程。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-26T14:42:47.530

[jvmtop](https://github.com/patric-r/jvmtop)可以向您显示消耗最多的线程：

```
 TID NAME                                 STATE     CPU    TOTALCPU
     25 http-8080-Processor13                RUNNABLE  4.55%     1.60%
 128022 RMI TCP Connection(18)-10.101\.       RUNNABLE  1.82%     0.02%
  36578 http-8080-Processor164               RUNNABLE  0.91%     2.35%
 128026 JMX server connection timeout   TIMED_WAITING  0.00%     0.00% 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-31T01:58:59.027

尝试查看[用于可视 VM 的 Hot Thread Detector 插件](http://java.dzone.com/news/porting-hot-thread-detector-vi)——它使用 ThreadMXBean API 获取多个 CPU 消耗样本以查找最活跃的线程。它基于[Bruce Chapman 的命令行等价物，](https://web.archive.org/web/20111225025057/http://weblogs.java.net/blog/brucechapman/archive/2008/03/hot_threads.html) 它也可能有用。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-31T01:33:12.293

只需运行 JVisualVM，连接到您的应用程序并使用线程视图。持续活跃的那个是你最有可能的罪魁祸首。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-31T21:51:48.163

查看 JConsole 的[Top Threads](http://blog.luminis.nl/roller/luminis/entry/top_threads_plugin_for_jconsole)插件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-31T01:36:43.317

如果您在 Windows 下运行，请尝试[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。为您的进程打开属性对话框，然后选择线程选项卡。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-31T04:53:14.927

进行线程转储。等待 10 秒。进行另一个线程转储。再重复一次。检查线程转储并查看哪些线程卡在同一个地方，或处理同一个请求。这是一种手动方式，但通常很有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-09-28T13:35:43.040

我建议看看阿里巴巴开源的[Arthas工具。](https://alibaba.github.io/arthas/en/index.html)

它包含一堆有用的命令，可以帮助您调试生产代码：

*   **仪表板**：Java 进程概述
*   **SC** : 搜索你的 JVM 加载的类
*   **Jad**：将类反编译成源代码
*   **观看**：查看方法调用输入和结果
*   **Trace** : 找到方法调用的瓶颈
*   **Monitor** : 查看方法调用统计信息
*   **Stack** : 查看方法的调用栈
*   **Tt** : 方法调用的时间隧道

仪表板示例： [![仪表盘](https://i.stack.imgur.com/2Iq5E.jpg)](https://i.stack.imgur.com/2Iq5E.jpg)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-26T11:05:04.233

使用`ps -eL`or `top -H -p <pid>`，或者如果您需要实时查看和监控，请运行 top（然后 shift H），以获取与 java 进程关联的轻量级进程（LWP aka 线程）。

```
root@xxx:/# ps -eL
PID LWP TTY TIME CMD
 1 1 ? 00:00:00 java
 1 7 ? 00:00:01 java
 1 8 ? 00:07:52 java
 1 9 ? 00:07:52 java
 1 10 ? 00:07:51 java
 1 11 ? 00:07:52 java
 1 12 ? 00:07:52 java
 1 13 ? 00:07:51 java
 1 14 ? 00:07:51 java
 1 15 ? 00:07:53 java
…
 1 164 ? 00:00:02 java
 1 166 ? 00:00:02 java
 1 169 ? 00:00:02 java 
```

注意 LWP=轻量级进程；在 Linux 中，线程与进程相关联，以便在内核中对其进行管理；LWP 与父进程共享文件和其他资源。现在让我们看看最耗时的线程

```
 1 8 ? 00:07:52 java
 1 9 ? 00:07:52 java
 1 10 ? 00:07:51 java
 1 11 ? 00:07:52 java
 1 12 ? 00:07:52 java
 1 13 ? 00:07:51 java
 1 14 ? 00:07:51 java
 1 15 ? 00:07:53 java 
```

**Jstack**是一个打印 Java Stack 的 JDK 实用程序；它打印表单的线程。

熟悉其他很酷的 JDK 工具（**jcmd jstat jhat jmap jstack**等 — [https://docs.oracle.com/javase/8/docs/technotes/tools/unix/](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/)）

`jstack -l <process id>`

堆栈跟踪中的 nid，本机线程 id 是连接到 linux 中的 LWT 的那个（[https://gist.github.com/rednaxelafx/843622](https://gist.github.com/rednaxelafx/843622)）

```
“GC task thread#0 (ParallelGC)” os_prio=0 tid=0x00007fc21801f000 nid=0x8 runnable 
```

nid 以十六进制形式给出；因此，我们在 DEC = 8,9,A, B,C,D,E,F 中将花费最多时间的线程 id 转换为 8,9,10,11,12,13,14,15 十六进制。

（请注意，这个特定的堆栈是从 Docker 容器中的 Java 中获取的，如果为 1 则使用方便的过程）让我们看看具有这个 id 的线程。

```
“GC task thread#0 (ParallelGC)” os_prio=0 tid=0x00007fc21801f000 nid=0x8 runnable
“GC task thread#1 (ParallelGC)” os_prio=0 tid=0x00007fc218020800 nid=0x9 runnable
“GC task thread#2 (ParallelGC)” os_prio=0 tid=0x00007fc218022800 nid=0xa runnable
“GC task thread#3 (ParallelGC)” os_prio=0 tid=0x00007fc218024000 nid=0xb runnable
“GC task thread#4 (ParallelGC)” os_prio=0 tid=0x00007fc218026000 nid=0xc runnable
“GC task thread#5 (ParallelGC)” os_prio=0 tid=0x00007fc218027800 nid=0xd runnable
“GC task thread#6 (ParallelGC)” os_prio=0 tid=0x00007fc218029800 nid=0xe runnable
“GC task thread#7 (ParallelGC)” os_prio=0 tid=0x00007fc21802b000 nid=0xf runnable 
```

所有 GC 相关的线程；难怪它会占用大量 CPU 时间。但是GC在这里是一个问题。

使用 jstat（不是 jstack ！）实用程序来快速检查 GC。

`jstat -gcutil <pid>`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-31T01:05:28.853

这是一种 hacky 方式，但似乎您可以在调试器中启动应用程序，然后暂停*所有*线程，并查看代码并找出哪个没有阻塞锁或 I/ O调用某种循环。或者这就像你已经尝试过的？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-31T05:20:22.867

您可以考虑的一个选项是从应用程序中查询您的线程以获得答案。通过[ThreadMXBean](http://www.javamex.com/tutorials/profiling/profiling_java5_threads_howto.shtml)，您可以从 Java 应用程序中查询线程的 CPU 使用情况，并查询有问题的线程的堆栈跟踪。

ThreadMXBean 选项允许您将这种监控构建到您的实时应用程序中。它的影响可以忽略不计，并且具有明显的优势，您可以让它完全按照您的意愿行事。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-31T06:07:18.023

如果您怀疑 VisualVM 是一个很好的工具，请尝试一下（因为它会这样做）找出线程只会帮助您了解为什么它会消耗如此多的 CPU。

但是，如果它很明显，我会直接使用分析器来找出你消耗这么多 CPU 的原因。

# asp.net-mvc - ASP.Net MVC 中的表单字段从哪里获取值？

> ID：930916
> 
> 赞同：2
> 
> 时间：2009-05-31T00:12:11.537
> 
> 标签：asp.net-mvc, ajax, forms

我知道诸如 Html.TextBox() 之类的字段接受两个值，第一个是名称，第二个是值。Html.TextArea() 也是如此。但是在表单作为 AJAX 提交并且放置表单的 div 替换为来自服务器的视图的情况下，表单字段坚持采用以前的值。一张图片胜过一千个字：

[图片 http://img132.imageshack.us/img132/4171/aspnetmvcbug.png](http://img132.imageshack.us/img132/4171/aspnetmvcbug.png)

我检查了控制器和模型上的所有内容，图像来自调试视图本身。该模型是空的，但从它生成的字段采用先前提交的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T00:33:38.683

回发数据保存在 ModelState 中。内置的 HtmlHelper 方法将在呈现其内容时根据表单元素的名称查找存储在模型状态中的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T00:28:52.500

检查 View.ModelState 属性。在某些情况下，表单可以从那里获取值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T00:28:34.293

您有条目 ViewData["Body"] 吗？MVC 还将尝试根据名称将控件绑定到 ViewData 项。

# c - 在 C 中嵌入程序集，编译器为您查找寄存器

> ID：930923
> 
> 赞同：3
> 
> 时间：2009-05-31T00:16:16.067
> 
> 标签：c, assembly, inline-assembly, cpu-registers

将汇编代码嵌入到 C/C++ 程序中时，您可以通过使用 push 指令保存寄存器来避免破坏寄存器（或指定编译器支持它的 clobber 列表）。

如果您包含汇编内联并希望避免推送和弹出破坏寄存器的开销，有没有办法让 gcc 为您选择寄存器（例如，它知道其中没有有用信息的寄存器）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-31T00:22:44.337

是的。您可以指定要将特定变量（输入或输出）存储在寄存器中，但不必指定寄存器。有关详细说明，请参阅[此文档](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html)。本质上，内联程序集如下所示：

```
asm("your assembly instructions"
      : output1("=a"),  // I want output1 in the eax register
        output2("=r"),  // output2 can be in any general-purpose register
        output3("=q"),  // output3 can be in eax, ebx, ecx, or edx
        output4("=A")   // output4 can be in eax or edx
      : /* inputs */
      : /* clobbered registers */
   ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-18T10:01:09.363

[编译器内在函数](http://msdn.microsoft.com/en-us/library/26td21ds.aspx?ppud=4)是混合汇编和 C/C++ 代码的一种非常有用的方法。它们是看起来像函数的声明，但实际上直接编译为单独的本机指令（通过编译器内的特殊情况）。这为您提供了在汇编中工作的大部分控制权，但将寄存器着色和调度留给了编译器。

一个优点是您可以将一个普通的 C 变量传递给一个内部变量，并让编译器负责将其加载到寄存器上并围绕它调度其他操作。例如，

```
struct TwoVectors
{
   __m128 a; __m128b;
}

// adds two vectors A += B using the native SSE opcode
inline void SimdADD( TwoVectors *v ) 
{
   v->a = _mm_add_ps( v->a , v->b ); // compiles directly to ADDSS opcode
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T22:15:08.473

好的，所以我不能在上面发表评论，但我很确定正确的语法（与上面显示的不同）是：

```
asm ( "your assembly instructions"
    : "=a"(output1),
      "=r"(output2),
      "=q"(output3),
      "=A"(output4)
    : /* inputs */
    : /* clobbered registers */
); 
```

尽管您可以将输入和输出寄存器的分配留给编译器，但没有明显的方法可以将暂存/临时寄存器（即用于中间值但不用于输入或输出）的分配留给编译器。从历史上看，我只是在 clobber 列表中明确列出它们（例如“%xmm1”、“%rcx”），但我现在认为最好将它们列为输出以便让编译器选择它们。我不知道有任何来源可以明确解决这个问题。

# iphone - iPhone 开发人员：UIWebView Youtube 崩溃。我可以用try catch包围它吗？

> ID：930924
> 
> 赞同：2
> 
> 时间：2009-05-31T00:18:11.820
> 
> 标签：iphone, crash, youtube

我在我的 iPhone 应用程序中集成了一个 youtube 视频。 [该线程](https://stackoverflow.com/questions/679685/problem-loading-youtube-videos)描述了如何集成它（通过 UIWebView）、警告消息和崩溃，但没有得到答复。在我的情况下，崩溃只是不时发生（我认为这可能是当用户太快点击“播放”图标时）所以我想将错误包装在 try catch 中并避免应用程序崩溃。

可能吗？

我在哪里放置 try catch 语句？因为一旦用户与 UIWebView 交互，我就无法控制。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-10T13:41:57.213

如果您在 Web 视图仍在加载时卸载它，您会遇到崩溃 - 听起来这可能是您的问题。打电话`-stopLoading`修复它。

# iphone - “isEqualToString”可可错误

> ID：930929
> 
> 赞同：3
> 
> 时间：2009-05-31T00:21:42.047
> 
> 标签：iphone, objective-c, cocoa, exception

我的控制台出现错误：

> 2009-05-30 20:17:05.801 ChuckFacts[1029:20b] *** -[笑话 isEqualToString:]：无法识别的选择器发送到实例 0x52e2f0

这是我认为错误来自的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
     cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Joke";  
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) { 
    [[NSBundle mainBundle] loadNibNamed:@"TableCell" owner:self options:nil]; 
    cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero 
                                   reuseIdentifier:CellIdentifier] autorelease];
    cell = tableCell;
}

NSString *jokeText = [jokes objectAtIndex:indexPath.row];
UILabel *jokeTextLabel = (UILabel*) [cell viewWithTag:1];
jokeTextLabel.text = jokeText; 
NSString *dateText = formattedDateString;
UILabel *dateTextLabel = (UILabel*) [cell viewWithTag:2];
dateTextLabel.text = dateText;
[self todaysDate];
return cell;
} 
```

**“笑话”是一个充满笑话的数组，以防你需要知道**

为什么会出现这个错误？

另外，您是否看到错误的部分内容：

> 发送到实例 0x52e2f0

如何确定“0x52e2f0”是什么，以便下次更容易找到问题？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-31T00:41:25.610

> 为什么会出现这个错误？

因为您要发送`isEqualToString:`到 Joke 对象，而您的 Joke 对象不响应`isEqualToString:`.

您可能不是故意将该消息发送到您的 Joke 对象；相反，您将 Joke 对象传递或返回给期望 NSString 对象的东西。

你说那`jokes`是“一堆笑话”。然而，在你的代码中，你这样做：

> ```
> NSString *jokeText = [jokes objectAtIndex:indexPath.row];
> UILabel *jokeTextLabel = (UILabel*) [cell viewWithTag:1];
> jokeTextLabel.text = jokeText; 
> ```

除了例外，我猜你所说的“充满笑话的数组”是指“笑话对象的数组”。

将 Joke 对象放入`NSString *`变量中不会将 Joke 对象转换为 NSString。您所做的只是告诉编译器该变量包含一个 NSString，然后将一个笑话放入其中。我称之为“对编译器撒谎”。

解决此问题的第一步是消除谎言并恢复真相：

```
Joke *joke = [jokes objectAtIndex:indexPath.row]; 
```

如果您在执行此操作后立即编译，您会注意到编译器在几行之后开始向您发出警告：

> ```
> jokeTextLabel.text = jokeText; 
> ```
> 
> 警告：从不同的 Objective-C 类型传递 'setText:' 的参数 1

没错，当然。笑话仍然不是 NSStrings。既然您对变量的类型很诚实，编译器就可以为您捕捉到这一点。

当您向 Joke 对象询问其文本时（我假设它有一个属性，并且该属性的值是一个 NSString）并将*其*提供给`jokeTextLabel.text`设置器，实际的修复就出现了。

> 如何确定“0x52e2f0”是什么，以便下次更容易找到问题？

在 Xcode 的 Breakpoints 窗口中，在`objc_exception_throw`. 然后运行你的程序。当异常发生时，调试器将停止您的程序，并打开调试器窗口。然后，`po 0x52e2f0`在调试器控制台中键入。（`po`代表“打印对象”。）

这适用于 Mac 应用程序；我假设它也适用于 iPhone 应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T00:41:19.167

通过“一个充满笑话的数组”，您显然是指“一个充满笑话类型的数组”。您不能将 Joke 对象分配给 UILabel 的`text`属性——它只需要`NSString`。

（Cocoa 不像 Java 或 C++，其中任何对象都可以通过某种方法自动强制转换为字符串。通常，框架在需要字符串时会明确`.toString()`要求s。）`NSString`

这就是正在发生的事情：您正在将一个`Joke`对象分配给该`text`属性。Cocoa 允许您快速轻松地使用这样的类型，在这种情况下甚至没有警告，因为它被隐式理解为 NSString （该`id`类型将默默地成为您分配给它的任何类型）。但是当它试图`isEqualToString:`在一个笑话对象上调用（一个 NSString 方法）时，它当然会失败。

您需要将笑话的文本分配给标签。

至于如何识别对象：您可以`po 0x52e2f0`在调试器中发出命令，如果内存没有完全耗尽，这通常会起作用。它将在该地址打印对象的 Objective-C 表示。

# c++ - 根据数据返回不同的数据类型（C++）

> ID：930932
> 
> 赞同：10
> 
> 时间：2009-05-31T00:23:53.493
> 
> 标签：c++, return-value

反正有做这样的事情吗？

```
(correct pointer datatype) returnPointer(void* ptr, int depth)
{

    if(depth == 8)
        return (uint8*)ptr;
    else if (depth == 16)
        return (uint16*)ptr;
    else
        return (uint32*)ptr;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T00:28:28.867

不可以。C++ 函数的返回类型只能根据显式模板参数或其参数的*类型*而有所不同。它不能根据其参数的*值而变化。*

但是，您可以使用各种技术来创建一个类型，该类型是几个其他类型的联合。不幸的是，这不一定对您有所帮助，因为其中一种技术是 void * 本身，并且回到原始类型将是一种痛苦。

然而，通过把问题从里到外，你可能会得到你想要的。我想你想使用你发布的代码，例如：

```
void bitmap_operation(void *data, int depth, int width, int height) {
  some_magical_type p_pixels = returnPointer(data, depth);
  for (int x = 0; x < width; x++)
    for (int y = 0; y < width; y++)
      p_pixels[y*width+x] = some_operation(p_pixels[y*width+x]);
} 
```

因为 C++ 需要在编译时知道 p_pixels 的类型，所以这不会按原样工作。但是我们可以做的是让 bitmap_operation 本身成为一个模板，然后用一个基于深度的开关来包装它：

```
template<typename PixelType>
void bitmap_operation_impl(void *data, int width, int height) {
  PixelType *p_pixels = (PixelType *)data;
  for (int x = 0; x < width; x++)
    for (int y = 0; y < width; y++)
      p_pixels[y*width+x] = some_operation(p_pixels[y*width+x]);
}

void bitmap_operation(void *data, int depth, int width, int height) {
  if (depth == 8)
    bitmap_operation_impl<uint8_t>(data, width, height);
  else if (depth == 16)
    bitmap_operation_impl<uint16_t>(data, width, height);
  else if (depth == 32)
    bitmap_operation_impl<uint32_t>(data, width, height);
  else assert(!"Impossible depth!");
} 
```

现在编译器会自动为你生成 bitmap_operation_impl 的三个实现。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-31T00:50:37.650

如果您可以使用模板参数而不是普通参数，则可以创建一个模板函数，该函数为每个`depth`值返回正确的类型。首先需要根据`depth`. 您可以为不同的位大小定义具有专业化的模板：

```
// template declaration
template<int depth>
struct uint_tmpl;

// specializations for certain types
template<> struct uint_tmpl<8>  { typedef uint8_t type; };
template<> struct uint_tmpl<16> { typedef uint16_t type; };
template<> struct uint_tmpl<32> { typedef uint32_t type; }; 
```

this 定义可用于声明一个模板化函数，该函数为每个位值返回正确的类型：

```
// generic declaration
template<int depth>
typename uint_tmpl<depth>::type* returnPointer(void* ptr);

// specializations for different depths
template<> uint8_t*  returnPointer<8>(void* ptr)  { return (uint8_t*)ptr;  }
template<> uint16_t* returnPointer<16>(void* ptr) { return (uint16_t*)ptr; }
template<> uint32_t* returnPointer<32>(void* ptr) { return (uint32_t*)ptr; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T00:53:22.827

您可以在堆上分配一些内存，并返回一个您强制转换为已分配类型的 void*。这是一种危险且不安全的工作方式，是一种古老的 C 技巧。

您可以返回一个包含所有有效数据类型（和一个选择指示符）的联合。

您可以使用模板，这是针对此类事情推荐的 C++ 方式。

您可以提供一组重载函数，它们将（每种类型的）参数作为引用 - 编译器将根据数据类型决定调用哪个函数。我经常喜欢这种方式，因为我认为它最简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T03:56:50.620

不; 你不能在 C++ 中做到这一点。正确答案是返回`void *`。

从调用的另一端考虑它——从编译器的角度来看：

如果编译器不可能知道将返回三种返回类型中的哪一种，编译器如何能够验证返回值是否被正确使用（例如分配给正确类型的变量）？

到那时，将“多种类型之一”分配给返回值的概念变得毫无意义。函数的返回类型在生活中没有其他目的，只是让编译器能够完成它的工作。编译器需要“一个”类型才能进行类型检查。由于您直到运行时才知道它是哪一个，因此编译器无法为您进行类型检查。您必须告诉编译器“停止尝试”以将返回值与任何特定的指针类型匹配——因此，返回一个`void *`.

如果您的深度参数在编译时已知，您可以选择使用一组模板，如[@sth](https://stackoverflow.com/questions/930932/returning-different-data-type-depending-on-the-data-c/930973#930973)演示的，或者使用一组单独的独立函数，或者使用一组调用共享实现函数然后转换返回的相关函数到正确的类型。你选择哪一个主要是一个审美决定。

如果 的值`depth`直到运行时才知道，那么您可能应该 return `void *`。

现在，我假设您的实际实现实际上做了一些事情来生成指针，而不是您的示例代码显示的内容。您的示例代码不是实际功能；这更像是试图复制 a 所做的事情`cast`。A`cast`不是函数调用；这是一个编译器指令，试图将它的操作数“制作”为特定类型（确切地说是“如何”，对于另一篇文章来说是一个很长的故事）。它不是 C++ 语言操作，而是编译器操作。你不能用 C++ 本身重写它。

# ruby-on-rails - 何时考虑在 Rails 应用程序中创建自己的 Ruby 模块？

> ID：930938
> 
> 赞同：20
> 
> 时间：2009-05-31T00:26:52.287
> 
> 标签：ruby-on-rails, ruby, module

使用 Ruby 模块，您可以将可能在一个地方使用的一堆方法聚集在一起，然后将它们包含到一个类中，就像您在该类中编写它们一样。

**Rails 应用程序中的 Ruby 模块有哪些实际用途？**

如果有人可以提及他们实际使用自己的模块的示例，我将不胜感激，这样我就知道我应该考虑在什么情况下创建它们。谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-31T02:05:28.653

1）任何时候我要复制（或基本上复制）一段代码：“哦，我可以剪切/粘贴到另一个控制器中......”

2）任何时候我写的代码很明显将来会被重用。

3) 具有特定目的的大型代码，该目的与控制器/模型的主要目的完全不同。这与（2）有些相关，但有时代码不会被重用，但模块有助于组织。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-31T01:18:33.790

您可以将它们放在 /lib 目录中，它们将与您的 Rails 项目一起加载。

例如，您可以查看我的一个旧项目的这个 repo：[Rails 项目的 lib 目录](http://github.com/mwilliams/sports-charting/tree/06efac324f6284fa04b7a37ae25845eb4cec9194/lib)

例如，我有以下模块：

```
google_charts.rb

Module GCharts
  class GoogleCharts
    def some_method

    end
  end
end 
```

在我的 Rails 应用程序的任何地方，我都可以访问这些方法。

因此，如果我要从控制器访问它，我只需执行以下操作：

```
require 'google_charts'

GCharts::GoogleCharts.some_method 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-31T01:46:01.097

我们使用模块来实现与 ActiveRecord 模型无关的功能，也没有抽象到插件或 gem 中。

我们生产代码库中最近的一个示例是与 Campaign Monitor 集成以进行电子邮件列表管理的库。系统的核心使用我们的用户模型，但与 extenrl 服务的实际交互是通过 /lib 中的模块抽象出来的。

# opengl - 在 OpenGL 中使用 glCallList 时修改 alpha 状态

> ID：930944
> 
> 赞同：0
> 
> 时间：2009-05-31T00:30:39.423
> 
> 标签：opengl, transparency

我编写的一个 OpenGL 应用程序可以作为一个适当格式的大型数据文件的查看器。

这很简单，它一次遍历每个数据集，使用 glCallList 绘制每个数据集：

```
for (all objects in our in our data set)
{
    if (first time drawing this object)
    {
        glNewList(...);
        for (all pixels in object_memory)
        {
          drawpixel(); 
        }
        glEndList();
        glCallList(...);
        delete object_memory
    }
    else 
    {
        glCallList(...);
    }
} 
```

我正在尝试添加一个功能，我可以在其中更改单个 glCallList 的透明度。问题是，数据文件太大了，我生成了 glCallList，然后必须删除我从中读取的实际数据。这使内存使用量从**4GB**下降到**400MB**左右。glCallLists 的使用对应用程序的速度也非常重要，如果没有它们，它会变得缓慢。

**有没有办法在我实际调用列表之前修改当前矩阵的全局透明度？**

每次需要更新 alpha 值时更新列表不是一种选择。

**或者，是否有另一种具有与 CallLists 相同的性能优势但可以轻松更新的方法？**

我之前读过 VBO（顶点缓冲区对象），它们听起来很相似，但我不确定我的数据是否适合应用程序域。

任何想法或意见都会受到重视。

谢谢，

〜布赖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T03:02:58.087

我能想到的最简单的修改 alpha 的通用方法是通过统一传递给顶点或片段着色器。

VBO 可能会有所帮助，但是如果没有更多关于您实际在做什么的信息，就很难判断...当您的顶点数量超过卡的带宽可以在一帧中处理时，VBO 的帮助 - 所以如果您有非常复杂的网格（例如高分辨率地形）它们可能是您正在寻找的东西。

（回复评论）听起来您的 DrawPixel 例程是在立即模式下实现的，这确实是低效的。尝试使用顶点数组而不是 glBegin()...glEnd() - 我敢打赌，你会看到很多与绘制列表相同的性能改进。

# ruby-on-rails - 如何格式化十进制？

> ID：930946
> 
> 赞同：7
> 
> 时间：2009-05-31T00:31:34.273
> 
> 标签：ruby-on-rails, ruby

我需要像这样格式化小数：

```
00.33
11.24
05.22 
```

问题是当我检索`00.33`它时输出为`0.33`.

我尝试了一切，但无法使其正常工作。我可以做 MySQL `Zerofill`，但我真的想避免这种情况。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-31T00:54:23.697

```
sprintf("%05.2f", 0.33)
# or
"%05.2f" % 0.33 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T00:42:24.673

使用 printf 格式化浮点数，如下所示：

```
printf( "%05.2f", yourFloat) 
```

有关`printf`C++ 中的示例，请参见：[http](http://www.cplusplus.com/reference/clibrary/cstdio/printf/) ://www.cplusplus.com/reference/clibrary/cstdio/printf/ 。

Ruby 文档`sprintf`位于：[http](http://www.ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/function.html#sprintf**) ://www.ruby-doc.org/core-1.9.2/Kernel.html#method-i-sprintf 。

# sql-server - 管理员无法管理 sql server 报告服务

> ID：930947
> 
> 赞同：2
> 
> 时间：2009-05-31T00:32:13.837
> 
> 标签：sql-server, iis-7, reporting-services, ssrs-2008

我在 SQL Server 2008 Standard 上运行 SQL Server Reporting Services 并试图让网页正常工作。

* * *

我必须做些什么才能让 RS（报表管理器、报表服务连接）首先将我视为管理员，以便我可以更改我的角色并正确查看 Web 服务 URL？

* * *

我在 II7 中启用了 Windows 身份验证，并且禁用了匿名身份验证。

我以本地管理员身份登录（但是页面似乎没有意识到我是管理员）。

通过 ReportServer db 中的表，我可以看出 BUILTIN\Administrators 在那里。

我在 Internet Explorer 的受信任站点中有我的本地计算机。

使用 Chrome 而不是 IE，我得到了类似的结果。我还没有尝试过火狐。

我在网上找到的大多数帮助都假定您可以从 RS 的角度明确添加您的登录作为管理员。我无法弄清楚如何做到这一点，因为每次我尝试管理我无法开始工作的角色......

在：

[http://machine/ReportServer_DEPAHELIX](http://machine/ReportServer_DEPAHELIX)

我得到：

报告服务错误

授予用户“Chris-PC\Chris”的权限不足以执行此操作。(rsAccessDenied) 获取在线帮助

* * *

SQL Server 报告服务

在： [http://machine/Reports_DEPAHELIX/Pages/Folder.aspx](http://machine/Reports_DEPAHELIX/Pages/Folder.aspx) 我只看到主页、主页、我的订阅、帮助，但实际上什么也做不了。那里还没有报告，因为当我尝试从 BIDS 部署时，我收到错误 1 ​​授予用户 'Chris-PC\Chris' 的权限不足以执行此操作。0 0

* * *

在： [http://machine/Reports_DEPAHELIX/Pages/SystemSecurity.aspx](http://machine/Reports_DEPAHELIX/Pages/SystemSecurity.aspx) 我看到您没有访问此页面的权限。

* * *

当我通过 SQL Server Management Studio 连接到 Reporting Services 时，我会看到 Jobs、Security 和 Shared Schedules，仅此而已。我可以展开 Security>Roles 并看到 5 个内置角色，但是当我右键单击一个角色时，上下文菜单的属性显示为灰色。

* * *

我需要做什么才能让 RS 将我视为管理员？

* * *

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T13:35:12.753

感谢您有一个解决方案；如果其他人有这个问题；MS 在 msdn 上提供了分步指南。“在 Windows Vista 和 Windows Server 2008 上为本地管理配置报表服务器”

[http://msdn.microsoft.com/en-us/library/bb630430.aspx](http://msdn.microsoft.com/en-us/library/bb630430.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-04T16:28:41.007

I have the same exact problem, i am running on Windows 7\. I also cannot deploy to the SQL Server, if I am not logged in as Administrator (and not as a users of the Admin group.) One thing that solved my problem is to start Internet Explorer as Administrator, even if you are logged in as a Admin users. (Right-click and select "Start as an Administrator") Same in Visual Studio in order for you to deploy. It's annoying, but it works...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T04:30:51.207

正如约翰所说，必须是“管理员”，而不仅仅是管理员组的成员。试图让更多用户成为 BUILTIN\Administrators 的一部分并不是答案。答案是最初以“管理员”身份登录，然后为您的系统或域设置 Reporting Services 相关组，然后使用 RS 工具配置与这些组关联的角色，并将适当的用户添加到特定的新组中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T17:13:20.293

经过数小时的搜索找到了我的答案...

正如其他用户建议的那样，您需要右键单击并选择以管理员身份运行。但是，在 Windows 7 上，默认情况下 Internet Explorer 似乎不向 Reporting Services 提供当前用户凭据。然后发生的情况是，当您尝试访问 Reporting Services 时会收到登录提示。***如果您收到登录提示，则需要调整安全设置。***

选择 Internet 选项并转到安全选项卡。单击受信任的站点。将安全滑块拖动到低安全级别或单击自定义级别。如果单击自定义级别，请转到用户身份验证/登录选项并选择“使用当前名称和密码自动登录”。

原帖在这里供参考： [http ://blogical.se/blogs/jahlen/archive/2009/10/02/setting-up-sql-server-reporting-services-on-windows-7-vista-or-windows- 2008.aspx](http://blogical.se/blogs/jahlen/archive/2009/10/02/setting-up-sql-server-reporting-services-on-windows-7-vista-or-windows-2008.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-09T13:15:54.573

我发现 BUILTIN\Administrators 帐户未正确处理 SSRS 中的权限，如果您创建一个新组，例如 SSRS_Administrators 并将所有管理员用户添加到该组并将 SSRS_Administrators 定义为报表管理器中的内容管理器，一切都很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T11:19:40.390

Sql Server 2008 不将 Windows 管理员识别为数据库系统管理员。您必须将 Windows 管理员组添加到 Sql sysadmins 角色。

您可以像这样添加组：

1.  打开 Sql Server 管理工作室
2.  打开 Security -> Logins，并为 Administrators 组创建一个登录名
3.  打开 Security -> Server Roles，并将登录名添加到 syadmin 角色

在安装过程中，安装程序将让当前用户成为数据库管理员。如果您接受，当前的 windows 用户将被添加到数据库 sysadmin 组中。如果您将 Sql Server 安装为“管理员”，这就解释了为什么只有“管理员”帐户才能配置您的报告服务器。

如果您已将 Sql Server 安装为“YourDomain\YourAccount”，则该帐户将改为添加到 sysadmin 角色。所以“The”管理员没有什么特别之处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-15T15:26:11.657

如果您是本地管理员，请以管理员身份运行 c:\program files\Internet Explorer\iexplore.exe（右键单击，以管理员身份运行）。这将打开 SSRS 报告管理器，您可以执行所需的操作。

# java - jsp数组列表问题

> ID：930953
> 
> 赞同：0
> 
> 时间：2009-05-31T00:36:07.913
> 
> 标签：java, jsp, netbeans6.5

我正在尝试创建一个如果值/大小超过 20 则不添加项目的数组。此解决方案仅添加 1 个项目，然后即使值小于 20 也停止。我如何更改它以使其仅接受值最多 20 个

```
package business;
import java.io.Serializable;
import java.util.ArrayList;

public class Cart implements Serializable
{
private ArrayList<LineItem> items;

    public Cart()
{
    items = new ArrayList<LineItem>();
}

    public ArrayList<LineItem> getItems()
{
    return items;
}

    public int getCount()
{
    return items.size();
}

    public void addItem(LineItem item)
{
    String code = item.getProduct().getCode();
    int quantity = item.getQuantity();
    double credit = item.getProduct().getCHours();
    String credit2 = Double.toString(item.getProduct().getCHours());
    int isize = items.size();

    for (int i = 0; i < items.size(); i++)
    {
        if(isize <= 20)
        {
        LineItem lineItem = items.get(i);
            lineItem.setQuantityCredit(credit);
            return;
       }
    }
    items.add(item);
    }

    public void addItemCredit(LineItem item)
{
        double credit = item.getProduct().getCHours();
        String credit2 = Double.toString(item.getProduct().getCHours());
        String code = item.getProduct().getCode();

    for (int i = 0; i < 20; i++)
    {
        LineItem lineItem2 = items.get(i);
            lineItem2.setQuantityCredit(credit);
            return;

        }
    items.add(item);

    }

public void removeItem(LineItem item)
{
        String code = item.getProduct().getCode();
        for (int i = 0; i < items.size(); i++)
        {
            LineItem lineItem = items.get(i);
            if (lineItem.getProduct().getCode().equals(code))
            {
                items.remove(i);
                return;
            }
        }
    }
} 
```

我认为你说的是​​对的，所以我尝试了这个

```
if(isize <= 20) 
{ 
LineItem lineItem = items.get(i); lineItem.setQuantityCredit(credit); 
} 
return; 
} 
items.add(item); 
} 

and 

if(isize <= 20) 
{ 
LineItem lineItem = items.get(i); lineItem.setQuantityCredit(credit); 
} 
} 
items.add(item); 
return; 
} 
```

但都没有奏效。那么我应该在哪里放置 d return 语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T02:42:36.147

`addItem`在将项目添加到列表之前，您正在从该方法返回。

```
if(isize <= 20)
{
     LineItem lineItem = items.get(i);
     lineItem.setQuantityCredit(credit);
     return; // This is the problem
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T05:06:10.187

我只是想在尝试回答之前澄清您的代码。

```
// get the total number of items in the cart
int isize = items.size();

// loop through the items
   // if there are more than 20 items then set the credit quantity and
     // return without adding
   // otherwise do nothing 
for (int i = 0; i < items.size(); i++)
{
    if(isize <= 20)
    {
    LineItem lineItem = items.get(i);
        lineItem.setQuantityCredit(credit);
        return;
   }
}
// if there are more than 20 items add another
items.add(item); 
```

它只添加一项而不添加更多项的原因如下：第一次调用此方法“isize”等于0，因此跳过了for循环。第二次调用此方法时，“isize”为零，因此循环执行一次并在添加之前返回。

我不确定你在 for 循环中试图做什么，因为它真的没有意义。如果您只想将 items 数组限制为 20 或更少，只需添加

```
if (items.size() < 20) {
  items.add(item);
} 
```

到你的代码。如果您正在尝试一些更复杂的逻辑，请解释您的目标。

# c# - 如何将 javascript getTime() 值转换为 C# DateTime

> ID：930962
> 
> 赞同：16
> 
> 时间：2009-05-31T00:44:23.500
> 
> 标签：c#, javascript

我想我的大脑因为时间太晚而停止了思考。谁能告诉我将 javascript getTime() 值转换为 C# DateTime 值的最佳方法，

我有一个 ajax 组件，它将 JS 时间值作为参数发送到 ASP.NET mvc 控制器，然后它将返回一些 Json 对象。

谢谢你的帮助。

我知道 JS 时间值是自 1970 年 1 月 1 日以来经过的毫秒数。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-31T00:49:59.477

```
new DateTime(1970, 01, 01).AddMilliseconds(jsGetTimeValue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T22:11:50.610

由于我没有能力修改 .NET 组件，我需要在 JavaScript 本身中进行此翻译。

要将 JavaScript 值传递到 C# 函数中，`DateTime`我需要传递自 1899 年 12 月 30 日午夜以来的小数天数。我用这个做了转换：

```
var now = new Date();
var days = (now.getTime() / 86400000)-(now.getTimezoneOffset() / 1440)+25569; 
```

然后我只是将它传递给`days`我的 .NET 组件。

# java - App Engine 数据存储区不支持运算符 OR

> ID：930966
> 
> 赞同：4
> 
> 时间：2009-05-31T00:45:56.023
> 
> 标签：java, google-app-engine, google-cloud-datastore, jdoql

我正在尝试在 google 数据存储中查询类似的内容（使用 pm --> persistanceManager）：

```
String filters = "(  field == 'value' ||  field == 'anotherValue' )";
Query query = pm.newQuery(myType.class, filters); 
```

当我执行时 - 我回来了：**App Engine 数据存储不支持运算符 OR**。

对于这种查询，人们体验的最佳方法是什么？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-31T03:32:51.660

执行多个查询。与所有其他数据库一样，Datastore 无法有效地执行析取。与其他数据库不同，它向用户展示了这种困难，以明确您所做的事情效率不高。您唯一的解决方案是执行多个查询 - 每个查询一个或 - 并将它们组合起来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-12T20:02:14.263

我不知道 GAE 的 JDO 和 JPA 实现是否支持这一点，但使用低级 API，您可以在一个查询中为此使用运算符 IN。

```
Query query = new Query("Issue");
List<String> list = Arrays.asList("NEW", "OPEN", "ACCEPTED");
query.addFilter("status", FilterOperator.IN, list);

DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();
PreparedQuery preparedQuery = datastore.prepare(query);
for (Entity entity : preparedQuery.asIterable()) {
    // should iterate over 'NEW', 'OPEN' and 'ACCEPTED' issues
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T00:59:47.977

根据[Google App Engine - 查询和索引](http://code.google.com/appengine/docs/java/datastore/queriesandindexes.html#Queries_on_Keys)：

> ## **查询过滤器**
> 
> **过滤器**指定字段名称、运算符和值。该值必须由应用程序提供；它不能引用另一个属性，也不能根据其他属性计算。运算符可以是以下任何一种：`< <= == >= >`
> 
> > **注意：** Java 数据存储接口不支持在 Python 数据存储接口中实现的 != 和 IN 过滤器运算符。（在 Python 接口中，这些运算符在客户端库中实现为多个数据存储查询；它们不是数据存储本身的功能。）
> 
> 过滤器的主题可以是任何对象字段，包括主键和实体组父级（请参阅 [事务](http://code.google.com/appengine/docs/java/datastore/transactions.html)）。
> 
> 实体必须匹配所有过滤器才能成为结果。在 JDOQL 字符串语法中，多个过滤器由`&&`（逻辑“和”）分隔。不支持过滤器的其他逻辑组合（逻辑“或”、“非”）。
> 
> 由于 App Engine 数据存储区执行查询的方式，单个查询不能`< <= >= >`对多个属性使用不等式过滤器 ( )。允许对同一属性使用多个不等式过滤器（例如查询一系列值）。请参阅[查询限制](http://code.google.com/appengine/docs/java/datastore/queriesandindexes.html#Restrictions_on_Queries)。

基本上，您要么必须重组数据，以便可以通过一个条件或多个“和”条件找到要查找的内容，要么必须通过两个（或更多）查询来检索数据并在您的代码中过滤/组合它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-07T18:47:03.630

对不起，我迟到了。我今天刚刚遇到了你的问题。

“模拟”“IN”和“OR”行为的另一种方法是使用“低级”Datastore API。DatastoreService 支持 get() 方法，该方法接受 Key 集合并返回与传入的 Key 匹配的所有实体的 Map。它是一个接口，但有一个方便的 DatastoreServiceFactory 可用，它将分发一个现成的实例。

不幸的是，Google 决定他们不想推广这种低级 API 方法，而是更喜欢开发人员使用 JDO 或 JPA，因此除了 JavaDocs 和您在 Google“DatastoreService”时可能找到的任何代码示例之外，没有可用的文档.

TL

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-09T19:27:55.623

迟来的新闻……至少我刚刚明白了。当我下载用于 GAE 的最新 Java SDK 时，我在发行说明中注意到“问题 29：公开批处理获取”已在最新版本 (v1.2.1) 中得到修复。基本上，我们（我正在寻找与它似乎相同的支持）似乎有一个基于 JDO 的替代方案，而不必下降到“低级”数据存储 API。我刚刚下载了最新的 Java GAE SDK，所以我还没有机会测试任何东西，但我想尽快给你一个提示。在我有机会确认这个“修复”之后，我会发布更多我学到的东西。

如果我通过重新发布我的评论作为答案违反了 StackOverflow 礼仪，请接受我的道歉，但我决定这样做有两个原因。首先是因为，即使我再次解决了同样的问题，恕我直言，这个新信息似乎为这个问题提供了一个完全不同的“答案”。其次，我担心在您花费大量时间查看我提供的第一个答案之前，评论表可能不会引起您的注意。

下次我会在行动之前更仔细地考虑。

TL

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-08T20:30:11.663

简化“自己动手”的一种方法可能是使用参数化查询：

```
 Query query = pm.newQuery(mytype.class);
   query.setFilter("field == autoParam");
   query.declareParameters("String autoParam");

   List<String> params = myListOfThingsFieldCanBeEqualTo;

   Set merged = new HashSet();
   for (String f : params) {
     merged.addAll(q.execute(f));
   } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-11T15:51:01.913

与 cletus 的回答相反，**OR-ing**无论如何在更新版本的 App Engine 中都有效。

事实上，我发现 OR-ing 在我拥有的 App Engine 1.3.0 中不起作用，但根据[Google App Engine - Queries and Indexes](http://code.google.com/appengine/docs/java/datastore/queriesandindexes.html#Introducing_Queries)（他的回答中提到的相同源 cletus），

> 实体必须匹配所有过滤器才能成为结果。在 JDOQL 字符串语法中，您可以使用 || 分隔多个过滤器。（逻辑“或”）和 &&（逻辑“与”），但请记住 || 只能在它分隔的过滤器都具有相同的字段名称时使用。换句话说，|| 只有在它分离的过滤器可以组合成一个 contains() 过滤器的情况下才合法。

我认为自从他的回答（并且自从我上次更新我的 App Engine 以来），App Engine 一定已经在这个问题上升级了。

**将 App Engine 更新到 1.3.4，OR-ing 就可以工作了！**虽然有限制。

无论如何都要感谢cletus：）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-22T10:10:36.333

您可以使用 contains 方法

```
String filters = "( :values.contains(field) )";
Query query = pm.newQuery(myType.class, filters); 
```

# iphone - iPhone：为越界的行请求 cellforrow

> ID：930967
> 
> 赞同：0
> 
> 时间：2009-05-31T00:46:21.403
> 
> 标签：iphone, uitableview, crash

我做错了什么？我只是稍微修改了基于导航的应用程序代码以读取和显示 JSON 字符串。当我使用消息 Objc_msgSend 向上滚动列表并将其指向问题时，它会崩溃： cell.textLabel.text=[[locations objectAtIndex: storyIndex] objectForKey: @"title"];

```
 #import "RootViewController.h"
 #import "JSON.h"

 @implementation RootViewController

 @synthesize locations;

 - (NSString *)stringWithUrl:(NSURL *)url
 {
    // Construct a String around the Data from the response
    return [[NSString alloc] initWithContentsOfURL:url];
 }

 -(void)jsonLoad {

    NSURL *URL = [NSURL URLWithString:@"http://bombaytokyo.com/whrru/jsonexample.html"];

     NSString *jsonstring = [self stringWithUrl:URL];
    NSLog(jsonstring);
    locations = [jsonstring JSONValue];
    [jsonstring release];
 }

 - (void)viewDidLoad {
     [super viewDidLoad];

     // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
     // self.navigationItem.rightBarButtonItem = self.editButtonItem;
    [self jsonLoad];

 }

 - (void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
     [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
    [locations release];
 }

 - (void)viewDidUnload {
    // Release anything that can be recreated in viewDidLoad or on demand.
    // e.g. self.myOutlet = nil;
 }

 #pragma mark Table view methods

 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
     return 1;
 }

 // Customize the number of rows in the table view.
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
 //    return 0;
    return [locations count];
 }

 // Customize the appearance of table view cells.
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

     static NSString *CellIdentifier = @"Cell";

     UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
     if (cell == nil) {
         cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
     }

    // Configure the cell.
    int storyIndex = [indexPath indexAtPosition: [indexPath length] - 1];
    NSLog(@"Index Path: %i",indexPath);
    //NSLog(title);
    cell.textLabel.text=[[locations objectAtIndex: storyIndex] objectForKey: @"title"];

     return cell;
 }

 - (void)dealloc {
     [super dealloc];
 }

 @end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T03:35:28.593

解决方案：

self.locations = [jsonstring JSONValue];

感谢所有的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T03:44:25.763

基于 0 的数组，id 长度为 0 0 - 1 = -1 这显然会导致异常。

```
[indexPath indexAtPosition: [indexPath length] - 1] 
```

改成

```
[indexPath indexAtPosition: [indexPath length]] 
```

你确定你不想要 indexPath.row。看起来您每次都只是返回长度。

# c - Obj-C 中的图像识别库？

> ID：930980
> 
> 赞同：1
> 
> 时间：2009-05-31T00:56:12.943
> 
> 标签：c, objective-c, cocoa, image-recognition

我正在寻找一些可以让我识别白色背景上的黑点的库。最好在C或objective-c中。

另外，我可以在搜索此类算法时使用哪些关键字？我找到了很多关于图像识别的东西，但没有一个与我正在寻找的东西相似。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T01:17:06.333

我认为有可能在 obj-c 中使用 OpenCV

通用 API 位于： http: [//opencv.willowgarage.com/](http://opencv.willowgarage.com/wiki/Welcome)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T01:25:14.150

[OpenCV vs. Apple iPhone](http://www.computer-vision-software.com/blog/2009/04/opencv-vs-apple-iphone/)文章展示了在 iPhone 上获取 OpenCV 的 2 种方法，这可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T15:15:56.373

你可以试试imagemagick。 [http://www.imagemagick.org/](http://www.imagemagick.org/)

# ruby - 是否有一种简单的方法来检查 Ruby IO 实例是否会在 read() 上阻塞？

> ID：930989
> 
> 赞同：14
> 
> 时间：2009-05-31T01:00:23.577
> 
> 标签：ruby, asynchronous, io, nonblocking

我正在寻找 Ruby 中的一种方法，基本上是这样的：

```
io.ready_for_read? 
```

我只想检查给定`IO`对象（在我的例子中，`popen`调用的结果）是否有可用的输出，即后续调用`io.read(1)`不会阻塞。

这是我看到的两个选项，我都不喜欢：

1.  `io.read_nonblock`- Unix 的抽象太薄了`read()`- 我不想处理`errno`错误处理。

2.  `io.select`with timeout 0 -- 混淆了这个简单操作的目的。

有没有我忽略的更好的选择？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-11-16T14:50:58.347

有点晚了，但是如果你`require 'io/wait'`，你可以使用`ready?`来验证 IO 可以被读取而不阻塞。当然，取决于您打算阅读多少（以及您打算如何阅读），您的 IO 对象可能仍会阻塞，但这应该会有所帮助。我不确定这个库是否在所有平台上都受支持，我也不知道为什么这个功能与 IO 库的其余部分是分开的。在此处查看更多信息：[http ://ruby-doc.org/stdlib/libdoc/io/wait/rdoc/](http://ruby-doc.org/stdlib/libdoc/io/wait/rdoc/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-04T01:01:37.020

我已经准备好得出结论，不，没有简单的方法可以做到这一点。根据彼得库珀的建议，这里是`IO#ready_for_read?`：

```
class IO
  def ready_for_read?
    result = IO.select([self], nil, nil, 0)
    result && (result.first.first == self)
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-16T21:42:32.717

在 Windows 上，我看到了一些与**IO/wait**不一致的地方。我现在这里的红宝石是：

*红宝石 1.9.2p136 (2010-12-25) [i386-mingw32]*

在这个既**nread**又**准备好了吗？**已实现，但它们返回错误的结果。在我正在使用的不同版本上**准备好了吗？**仍然被破坏，甚至**nread**都不存在。

一种可能性是使用**io.stat.size**，它告诉您在 IO 流中可读取的字节数。 [http://www.ruby-doc.org/core/classes/File/Stat.html](http://www.ruby-doc.org/core/classes/File/Stat.html)

文档表明它是用于文件的，但我已经在连接到单独进程的管道上使用它（通过 Ruby 的 Open3.popen3）。到目前为止它对我有用。

# python - python中的assertEquals与assertEqual

> ID：930995
> 
> 赞同：234
> 
> 时间：2009-05-31T01:07:03.483
> 
> 标签：python, unit-testing

python`assertEquals`和in之间有区别吗？`assertEqual``unittest.TestCase`

如果没有，为什么有两个功能？只是为了方便？

* * *

## 回答 #1

> 赞同：257
> 
> 时间：2009-05-31T01:17:47.083

实际上，在 Python 2.6 中，`assertEqual`和`assertEquals`都是`failUnlessEqual`. 来源这样声明它们：

```
# Synonyms for assertion methods
assertEqual = assertEquals = failUnlessEqual 
```

在[Python 3](http://docs.python.org/3/library/unittest.html#deprecated-aliases)中，就您而言，`failUnlessEqual`已明确弃用。`assertEquals`带有此评论:-)

```
# Synonyms for assertion methods
# The plurals are undocumented.  Keep them that way to discourage use.
# Do not add more.  Do not remove.
# Going through a deprecation cycle on these would annoy many people. 
```

所以，结果似乎是你应该在 Python 2.x 中使用任何你喜欢的东西，但倾向于`assertEqual`使用 Python 3。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2014-02-24T16:21:40.340

3.3 更新：从[26.3.7.1.1 开始。不推荐使用的别名](http://docs.python.org/3.3/library/unittest.html#deprecated-aliases)：

> 由于历史原因，一些 TestCase 方法有一个或多个别名，现在已弃用。下表列出了正确的名称及其不推荐使用的别名：

```
Method Name   | Deprecated alias | Deprecated alias
--------------+------------------+-----------------
assertEqual() | failUnlessEqual  | assertEquals
... 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-01-09T00:58:59.907

不仅适用于 Python 3.x，因为 Python 2.7`assertEquals`也已被弃用：

```
Method Name            | Deprecated alias(es)
_________________________________________________________
assertEqual()          | failUnlessEqual, assertEquals 
```

从[25.3.7.1.1 开始。不推荐使用的别名](https://docs.python.org/2/library/unittest.html#deprecated-aliases "25.3.7.1.1.1。 不推荐使用的别名")

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-01T22:35:26.587

我认为这是“唯一一种明显的方法”与“使整体代码在语义上流动的别名”之间的紧张关系。我个人发现我喜欢阅读

```
failIf(some_condition) 
```

超过

```
assertFalse(some_condition) 
```

但喜欢

```
assertEqual(a, b) 
```

超过其他两个（`assertEquals(a, b)`打扰我的语法意识）。

“唯一一种明显的方式来做到这一点”已经占据了优先地位。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-31T01:14:37.917

[我在http://docs.python.org/library/unittest.html](http://docs.python.org/library/unittest.html)中没有找到任何提及 assertEquals 的内容。但是，当我导入 TestCase 然后执行“帮助（TestCase）”时，它会被列出。我认为这只是方便的同义词。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-12-19T19:48:32.627

我知道它没有回答具体问题，但如果您在搜索时来到这里：

```
using deprecated method assertEquals() 
```

您只需将调用更改为 .assertEqual() （删除 equalS 中的 's'）*****