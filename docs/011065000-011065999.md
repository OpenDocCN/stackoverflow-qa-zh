# StackOverflow 问答 11065000-11065999

# scorm - 活动的主要目标是强制性的吗？

> ID：11065000
> 
> 赞同：1
> 
> 时间：2012-06-16T16:01:49.867
> 
> 标签：scorm, scorm2004

我想知道活动的主要目标是否是强制性的？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T07:04:52.973

不，您不必为每项活动声明主要目标。事实上，如果您不声明主要目标，LMS 将为您创建一个，因为 LMS 在汇总和排序过程中使用主要目标。但是，如果您创建本地目标，则必须在清单文件中声明主要目标。

# python - 使用 Python ElementTree 提取 XML 标记中的文本

> ID：11065004
> 
> 赞同：3
> 
> 时间：2012-06-16T16:02:02.887
> 
> 标签：python, xml

我有一个包含数万个 XML 文件（小型文件）的语料库，我正在尝试使用 Python 并提取其中一个 XML 标记中包含的文本，例如，body 标记之间的所有内容，例如：

```
<body> sample text here with <bold> nested </bold> tags in this paragraph </body> 
```

然后编写一个包含此字符串的文本文档，然后在 XML 文件列表中向下移动。

我正在使用 effbot 的 ELementTree，但找不到正确的命令/语法来执行此操作。我找到了一个使用 miniDOM 的 dom.getElementsByTagName 的网站，但我不确定 ElementTree 的相应方法是什么。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T19:09:53.077

一个更好的答案，展示了如何实际使用 XML 解析来做到这一点：

```
import xml.etree.ElementTree as ET
stringofxml = "<body> sample text here with <bold> nested </bold> tags in this paragraph </body>"

def extractTextFromElement(elementName, stringofxml):
    tree = ET.fromstring(stringofxml)
    for child in tree:
        if child.tag == elementName:
            return child.text.strip()

print extractTextFromElement('bold', stringofxml) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T19:44:52.563

我只会使用 re：

```
import re
body_txt = re.match('<body>(.*)</body>',body_txt).groups()[0] 
```

然后删除内部标签：

```
body_txt = re.sub('<.*?>','',body_txt) 
```

你不应该在不需要的时候使用正则表达式，这是真的……但是在需要的时候使用它们并没有错。

# iphone - iOS 应用程序上的 SQLite DB 是否限制为任何大小

> ID：11065011
> 
> 赞同：2
> 
> 时间：2012-06-16T16:03:20.727
> 
> 标签：iphone, objective-c, sqlite

我可以在 iOS 应用程序的 SQLite DB 上存储超过 200 MB 的数据吗？数据库有大小限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T16:05:35.323

是的，您可以在 sqlite 数据库中存储任意数量的数据。您仅受设备容量的限制。

# qt - PySide 移动 QGraphicsPixmapItem 跳转到场景左上角

> ID：11065012
> 
> 赞同：1
> 
> 时间：2012-06-16T16:03:35.347
> 
> 标签：qt, pyqt, pyside, qgraphicsview, qgraphicsscene

我正在编写一个应用程序，该应用程序允许用户通过单击空白区域将图像放置在 QGraphicsScene（包含在 QGraphicsView 中）上，然后使用 mousemoveevent 移动它们。图像是使用子类 QGraphicsPixmapItem 创建的。

问题出在：第一次尝试移动项目时按预期工作。但是，对于所有后续移动，所选项目会立即跳转到场景的左上角。这是代码：

```
import sys
from PySide import QtGui,QtCore

class TestPixmapItem(QtGui.QGraphicsPixmapItem):
    def __init__(self, imagename, position, parent=None):
        QtGui.QGraphicsPixmapItem.__init__(self, parent)

        px = QtGui.QPixmap(imagename)
        self.setPixmap(px)

        self.setFlag(QtGui.QGraphicsItem.ItemIsMovable, True)
        self.setFlag(QtGui.QGraphicsItem.ItemIsSelectable, True)

        # set position
        self.setPos(position.x(),position.y())

    def mouseReleaseEvent(self,e):
        self.setSelected(False)

    def mouseMoveEvent(self, e):
        QtGui.QGraphicsPixmapItem.mouseMoveEvent(self, e)

class GfxScene(QtGui.QGraphicsScene):
    def __init__(self, parent=None):
        #build parent user interface
        super(GfxScene, self).__init__(parent)

    def mousePressEvent(self, e):
        if(self.itemAt(e.scenePos().x(),e.scenePos().y()) == None):
            pixmapItem = TestPixmapItem('test.png',e.scenePos())
            self.addItem(pixmapItem)
        else:
            QtGui.QGraphicsScene.mousePressEvent(self,e); 

class MainForm(QtGui.QMainWindow):
    def __init__(self, parent=None):
        super(MainForm, self).__init__(parent)

        scene = GfxScene(self)
        scene.setSceneRect(QtCore.QRect(0, 0, 800, 800))

        view = QtGui.QGraphicsView()
        view.setScene(scene)
        view.setSceneRect(scene.sceneRect())
        #view.setGeometry(QtCore.QRect(0, 0, 800, 800))
        self.setCentralWidget(view)

def main():
    #This function means this was run directly, not called from another python file.
    app = QtGui.QApplication.instance()
    if app == None:
            app = QtGui.QApplication(sys.argv)
    myapp = MainForm()
    myapp.show()

    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:29:02.593

当您覆盖鼠标释放事件时，您应该调用 QtGui.QGraphicsPixmapItem.mouseReleaseEvent(self, e)，请参阅：http: [//goo.gl/ChSYP](http://goo.gl/ChSYP)

```
import sys
from PySide import QtGui,QtCore

class TestPixmapItem(QtGui.QGraphicsPixmapItem):
    def __init__(self, imagename, position, parent=None):
        QtGui.QGraphicsPixmapItem.__init__(self, parent)

    px = QtGui.QPixmap(imagename)
    self.setPixmap(px)

    self.setFlag(QtGui.QGraphicsItem.ItemIsMovable, True)
    self.setFlag(QtGui.QGraphicsItem.ItemIsSelectable, True)

    # set position
    self.setPos(position.x(),position.y())

def mouseReleaseEvent(self,e):
    self.setSelected(False)
    QtGui.QGraphicsPixmapItem.mouseReleaseEvent(self, e) // here calling the event

def mouseMoveEvent(self, e):
    QtGui.QGraphicsPixmapItem.mouseMoveEvent(self, e)

class GfxScene(QtGui.QGraphicsScene):
    def __init__(self, parent=None):
        #build parent user interface
        super(GfxScene, self).__init__(parent)

def mousePressEvent(self, e):
    if(self.itemAt(e.scenePos().x(),e.scenePos().y()) == None):
        pixmapItem = TestPixmapItem('test.png',e.scenePos())
        self.addItem(pixmapItem)
    else:
        QtGui.QGraphicsScene.mousePressEvent(self,e); 

class MainForm(QtGui.QMainWindow):
    def __init__(self, parent=None):
        super(MainForm, self).__init__(parent)

    scene = GfxScene(self)
    scene.setSceneRect(QtCore.QRect(0, 0, 800, 800))

    view = QtGui.QGraphicsView()
    view.setScene(scene)
    view.setSceneRect(scene.sceneRect())
    #view.setGeometry(QtCore.QRect(0, 0, 800, 800))
    self.setCentralWidget(view)

def main():
    #This function means this was run directly, not called from another python file.
    app = QtGui.QApplication.instance()
    if app == None:
        app = QtGui.QApplication(sys.argv)
    myapp = MainForm()
    myapp.show()

sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

# c - 二维数组 - 为什么我没有引用预期的元素？

> ID：11065014
> 
> 赞同：1
> 
> 时间：2012-06-16T16:03:55.827
> 
> 标签：c, arrays

毫无疑问，真正的菜鸟问题，但我无法理解这种行为。我初始化一个二维数组，然后调用一个函数从中打印出某些值。程序和结果如下图所示：

```
int
main(void)
{
    int matrix[3][5] = 
    {
        {14,7,6,55,2},
        {8,33,12,88,24},
        {19,20,21,90,7}
    };

    printArray(3, 5, matrix);

    printArray(2, 3, matrix);

    return 0;
}

void
printArray(int rows, int columns, int matrix[rows][columns])
{
    int i, j;

    for (i = 0; i < rows; i++)
    {
        for (j = 0; j < columns; j++)
            printf("%3i ", matrix[i][j]);

        printf("\n");
    }   

    printf("\n");       
}

 14   7   6  55   2 
 8  33  12  88  24 
 19  20  21  90   7 

 14   7   6 
 55   2   8 
```

似乎第二次调用 printArray() 它继续在新行上打印第一行的值，而不是实际访问下一行。我不明白这一点，因为索引值肯定是恒定的，不是吗？（即 matrix[1][2] 应该是（在这种情况下）12，而不是 8。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T16:08:45.213

以下：

```
void printArray(int rows, int columns, int matrix[rows][columns]) 
```

向编译器保证第三个参数的尺寸为`rows`x `columns`。

同时，以下行打破了这个承诺：

```
printArray(2, 3, matrix); 
```

因为`matrix`是`3`x`5`而不是`2`x `3`。

如果您只想打印行和列的子集，您可以执行以下操作：

```
void
printArray(int rows, int columns, int matrix[rows][columns], int max_row, int max_col)
{
    int i, j;

    for (i = 0; i < max_row; i++)
    {
        for (j = 0; j < max_col; j++)
            printf("%3i ", matrix[i][j]);
        printf("\n");
    }           
    printf("\n");       
}

int main(void)
{
   ...
   printArray(3, 5, matrix, 3, 5);
   printArray(3, 5, matrix, 2, 3);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:18:22.057

[http://en.wikipedia.org/wiki/Row-major_order](http://en.wikipedia.org/wiki/Row-major_order)

# c++ - C++ Winsock recv 不阻塞

> ID：11065017
> 
> 赞同：0
> 
> 时间：2012-06-16T16:04:06.577
> 
> 标签：c++, winsock

我正在用 C++ 开发服务器，当我在 while 循环中使用 recv() 时，它返回 -1 的所有时间长度，并且继续循环而不阻塞。

```
while(true)
{
   char buffer[1024];
   int dataLength =  recv(socket, buffer, 1024, 0)
   cout << dataLength;
} 
```

输出：-1-1-1-1-1-1-1-1-1.............

任何人都知道如何让这个套接字阻塞直到它接收到数据？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T16:39:10.087

可能在初始化期间出现错误尝试调用 GetLastError() 并在每次调用后打印结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:10:22.490

正如詹姆斯建议的那样，检查是否发生了套接字错误。`recv()`s 默认行为是阻止。另请参阅此处的[此线程](https://stackoverflow.com/questions/4159158/c-winsock-recv-does-not-block)。

# php - 如何将字符串转换为jqplot的数组

> ID：11065018
> 
> 赞同：2
> 
> 时间：2012-06-16T16:04:13.000
> 
> 标签：php, jqplot

我正在尝试使用 Jqplot 创建折线图。

我正在像这样在 PHP 中生成一个字符串 -

```
$retstring = "[['Q2 2011', 3.7813],['Q1 2011', 3.7813],['Q3 2011', 3.9000]],  [['Q2 2011', 3.6563],['Q1 2011', 3.6563],['Q3 2011', 3.5765]]"; 
```

从字符串结构中可以看出，我想绘制两条线。

`$retstring`正在使用简单的 AJAX 将其传递给 JavaScript 函数。当我在 JavaScript 函数中获取此字符串时，如何将其转换为要传递给 JqPlot 的数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T01:04:06.297

I think your problem is related to [the question I have already answered.](https://stackoverflow.com/q/10191122/613495)

Therefore, [please check my answer there.](https://stackoverflow.com/a/10233111/613495)

Particularly the code sample, which you will fined towards the bottom of my answer, where you could see how the date you provide could be used.

**EDIT:** When it goes to the main part of the problem, the decoding bit, do just as @mahok says use the `json_decode`. I wonder if you actually will not experience problems since, technically the `String` you have is not a proper [JSON](http://json.org/). In JSON `String`s are wrapped in double quotes (`""`) not in single once (`''`). Therefore, you might need to replace them appropriately but other than that the method would do the trick.

I was suspecting that the `json_decode` could have problem with this encoding and [as they say it here, the method will return `null` in this case, please see example 3.](http://uk3.php.net/json_decode)

# php - 将页面上的回显文本更改为来自 MySQL Query 的带有 Javascript 或 PHP 的链接

> ID：11065021
> 
> 赞同：0
> 
> 时间：2012-06-16T16:04:52.627
> 
> 标签：php, javascript, mysql

所以我正在制作一个非常基本的网站，有人在框中键入一些文本并将其发布到 mysql 中。

例子：

这是我的帖子，链接很酷 - htt://www.coolness.com

下面的脚本只是简单地从数据库中获取想要的列并将其显示在一行上。

```
<?php
$con = mysql_connect("localhost","####","####");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("####", $con);

$result = mysql_query("SELECT * FROM posts");

while($row = mysql_fetch_array($result))
  {
  echo $row['post_content'];
  echo "<br />";
  }

mysql_close($con);
?> 
```

该链接是纯文本的，相反，我希望 php 或 javascript 通过将整个位添加到其中来将其编写为超链接。

我浏览了示例，但当我尝试应用它们时似乎没有任何效果。

任何提示都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:08:11.290

希望我明白你的意思：

改成

```
while($row = mysql_fetch_array($result))
  {
  echo '<a href="' . $row['post_content'] . '">' . $row['post_content'] . '</a>';
  echo "<br />";
  } 
```

这段代码的作用是打印`<a>`标签内的链接，这些链接是链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T16:17:12.093

在 PHP 中使用 preg_replace()。将 URL 的正则表达式传递给它，您希望如何替换匹配的 URL，然后是您从数据库中提取的字符串。

你想把“ [http://www.coolness.com](http://www.coolness.com) ”变成“http://www.coolness.com'> [http://www.coolness.com](http://www.coolness.com) ”。

有关URL 匹配的正则表达式的讨论，请参阅[此问题，有关 preg_replace() 函数的更多信息，请参阅](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url)[PHP 文档](http://php.net/manual/en/function.preg-replace.php)。

编辑：所以我的第二行似乎很有趣！它应该是：

你想把“ [http://www.coolness.com](http://www.coolness.com) ”变成“ `<a href='http://www.coolness.com'>http://www.coolness.com</a>`”。

# c# - 设置矩形的不透明度

> ID：11065023
> 
> 赞同：1
> 
> 时间：2012-06-16T16:05:23.443
> 
> 标签：c#, wpf

单击某个按钮时，我触发了一个事件

```
private void set_Opacity(object sender, RoutedEventArgs e)
    {
        this.Opacity = 0;
    } 
```

但是单击按钮时没有效果。我究竟做错了什么？谢谢。

**编辑：** 我将提供一些有关我正在尝试做的事情的背景：

我创建了一个自定义按钮，它应该使用淡出动画最小化我的窗口，所以这里是它的代码：

```
 private void minimize_Window(object sender, EventArgs e)
    {
        var anim = new DoubleAnimation(0, (Duration)TimeSpan.FromSeconds(1));
        anim.Completed += (s, _) => this.Minimize();
        this.BeginAnimation(UIElement.OpacityProperty, anim);

    }
    private void Minimize()
    {
        WindowState = WindowState.Minimized;
    } 
```

它工作得很好，虽然问题是当我尝试从任务栏中检索我的程序时它不会做任何事情（当我在最小化后从任务栏单击它时我无法看到该程序）。我从中了解到的是，我的程序的不透明度被设置为 0，而它被最小化（因为动画）。所以我使用了调用该方法的激活事件：

```
private void set_Opacity(object sender, EventArgs e)
    {
        rectangle2.Opacity = 1;
        WindowState = WindowState.Normal;
    } 
```

而且，同样的问题。希望你能帮忙。

非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T16:22:20.977

问题似乎是，在大多数情况下，`this`将是一个`Window`. 不过，我的假设是，您并没有尝试将整个窗口设置为不可见，而是设置为矩形。您需要使用`x:Name`属性为您的 Rectangle 命名。这是一个例子：

```
<Rectangle Width="40" Height="40" x:Name="MyRectangle" Fill="Red" /> 
```

然后，在您的按钮中单击：

```
private void set_Opacity(object sender, RoutedEventArgs e)
{
    MyRectangle.Opacity = 0;
} 
```

如果你真的想设置整个`Window`'s 的透明度：

除非您在 XAML 中指定`AllowTransparency`为 true 和`WindowStyle`None，否则不能设置整个 Window 的不透明度：

```
<Window x:Class="ScratchApplication.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        AllowsTransparency="true" WindowStyle="None"> 
```

注意正在设置的属性。

**编辑**：

> 当我的程序从我的任务栏被激活时，我需要一个事件被触发。你知道我可以使用什么事件吗？

使用`Window.Activated`事件。从您的 XAML：

```
<Window Activated="Window_Activated"> 
```

在你的 C# 中：

```
private void Window_Activated(object sender, EventArgs e)
{
    //Put code here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:14:11.130

这应该有一些效果（假设这是在 WPF 应用程序主窗口上调用的，它将使整个窗口变黑）。

几乎听起来事件处理程序没有正确连接。尝试在不透明度设置行上设置断点或右键单击 set_opacity 函数名称并选择“查找所有引用”，您应该会看到在 windowname.g.cs 文件中创建了一个事件处理程序。

# c# - 获取另一个进程的窗口状态

> ID：11065026
> 
> 赞同：13
> 
> 时间：2012-06-16T16:05:28.593
> 
> 标签：c#, process

如何获取另一个正在运行的进程的窗口状态（ `maximized`， ）？`minimized`

我试过用这个：

```
Process[] procs = Process.GetProcesses();

        foreach (Process proc in procs)
        {

            if (proc.ProcessName == "notepad")
            {
                MessageBox.Show(proc.StartInfo.WindowStyle.ToString());

            }
        } 
```

但如果过程是`Maximized`或`Minimized`，它永远返回`Normal`。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-16T16:23:30.103

您需要通过 P/Invoke 使用 Win32 来检查另一个窗口的状态。这是一些示例代码：

```
static void Main(string[] args)
{
    Process[] procs = Process.GetProcesses();

    foreach (Process proc in procs)
    {
        if (proc.ProcessName == "notepad")
        {
            var placement = GetPlacement(proc.MainWindowHandle);
            MessageBox.Show(placement.showCmd.ToString());
        }
    }
}

private static WINDOWPLACEMENT GetPlacement(IntPtr hwnd)
{
    WINDOWPLACEMENT placement = new WINDOWPLACEMENT();
    placement.length = Marshal.SizeOf(placement);
    GetWindowPlacement(hwnd, ref placement);
    return placement;
}

[DllImport("user32.dll", SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
internal static extern bool GetWindowPlacement(
    IntPtr hWnd, ref WINDOWPLACEMENT lpwndpl);

[Serializable]
[StructLayout(LayoutKind.Sequential)]
internal struct WINDOWPLACEMENT
{
    public int length;
    public int flags;
    public ShowWindowCommands showCmd;
    public System.Drawing.Point ptMinPosition;
    public System.Drawing.Point ptMaxPosition;
    public System.Drawing.Rectangle rcNormalPosition;
}

internal enum ShowWindowCommands : int
{
    Hide = 0,
    Normal = 1,
    Minimized = 2,
    Maximized = 3,
} 
```

定义由 pinvoke.net 提供。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-16T16:19:35.707

您正在使用 proc.StartInfo，这是不正确的。它不反映目标进程的运行时窗口样式。它只是您可以设置的启动信息，然后可以在启动时传递给进程。

C# 签名是：

```
[DllImport("user32.dll", SetLastError=true)]
static extern int GetWindowLong(IntPtr hWnd, int nIndex); 
```

您需要使用 p/invoke 并调用 GetWindowLong(hWnd, GWL_STYLE)，并将 proc.MainWindowHandle 作为 hWnd 参数传递。

您可以通过执行以下操作来检查窗口是否最小化/最大化：

```
int style = GetWindowLong(proc.MainWindowHandle,  GWL_STYLE);
if((style & WS_MAXIMIZE) == WS_MAXIMIZE) 
{
   //It's maximized
} 
else if((style & WS_MINIMIZE) == WS_MINIMIZE) 
{
  //It's minimized
} 
```

**注意：**标志的值（WS_MINIMIZE 等）可以在此页面中找到：[http ://www.pinvoke.net/default.aspx/user32.getwindowlong](http://www.pinvoke.net/default.aspx/user32.getwindowlong)

感谢卡卡西指出我们测试结果的错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-14T11:10:32.723

在 Windows PowerShell 中，您可以通过以下代码执行此操作：

```
Add-Type -AssemblyName UIAutomationClient
$prList = Get-Process -Name "<ProcessNamesWhichHaveWindow>"
$prList | % {
    $ae = [System.Windows.Automation.AutomationElement]::FromHandle($_.MainWindowHandle)
    $wp = $ae.GetCurrentPattern([System.Windows.Automation.WindowPatternIdentifiers]::Pattern)
    echo "Window title: $($_.MainWindowTitle)"
    echo "Window visual state: $($wp.Current.WindowVisualState)"
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-04T09:20:26.233

通过调用 WinAPI IsIconic() / IsZoomed() 可以获得两个窗口状态（最大化/最小化），如下所示：

```
 [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool IsIconic(IntPtr hWnd);

    [DllImport("user32.dll")]
    public static extern bool ShowWindowAsync(IntPtr hWnd, ShowWindowCommands cmdShow);

    if (IsIconic(_helpWindow.MainWindowHandle)) {
        ShowWindowAsync(_helpWindow.MainWindowHandle, ShowWindowCommands.SW_RESTORE);
    } 
```

枚举 ShowWindowCommands 和其他函数的定义取自 www.PInvoke.net

# spring-security - 带有嵌入式 LDAP 服务器的 Spring LDAP 身份验证

> ID：11065028
> 
> 赞同：0
> 
> 时间：2012-06-16T16:05:50.950
> 
> 标签：spring-security, ldap

我正在尝试使用 spring 安全框架使用嵌入式 spring LDAP 服务器配置来实现 LDAP 身份验证和 DB 授权。尝试登录时收到以下错误消息：结果代码：（INVALID_CREDENTIALS）invalidCredentials

问题是：当我使用配置 1 时出现登录问题，但如果我使用配置 2 则它可以工作。请求帮助：

## 配置一：

```
<security:authentication-manager>       
   <security:authentication-provider ref="ldapActiveDirectoryAuthProvider" />
</security:authentication-manager>

<bean id="ldapActiveDirectoryAuthProvider"
   class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
    <constructor-arg>
        <bean class="org.springframework.security.ldap.authentication.BindAuthenticator">
            <constructor-arg ref="appLdapServer" />
            <property name="userDnPatterns">
                <list>
                    <value>uid={0},ou=users</value>
                </list>
            </property>
        </bean>
    </constructor-arg>
    <constructor-arg>
        <bean class="com.smd.security.UserServiceBean" />
    </constructor-arg>
</bean>

<security:ldap-server id="appLdapServer" ldif="/WEB-INF/conf/mojo.ldif" root="o=mojo" port="007" /> 
```

## 配置2：

```
<security:authentication-manager>

 <security:ldap-authentication-provider
    user-search-filter="(uid={0})" user-search-base="ou=users"
    group-search-filter="(uniqueMember={0})" group-search-base="ou=groups"
    group-role-attribute="cn" role-prefix="ROLE_">
 </security:ldap-authentication-provider>

</security:authentication-manager>

<security:ldap-server id="appLdapServer" ldif="/WEB-INF/conf/mojo.ldif" root="o=mojo" port="007" /> 
```

## LDIF 文件片段：

```
dn: o=mojo
objectClass: organization
objectClass: extensibleObject
objectClass: top
o: mojo

dn: ou=users,o=mojo
objectClass: extensibleObject
objectClass: organizationalUnit
objectClass: top
ou: users

dn: cn=John Milton,ou=users,o=mojo
objectClass: organizationalPerson
objectClass: person
objectClass: inetOrgPerson
objectClass: top
cn: John Milton
sn: Milton
uid: jmilton
userPassword:: cGFzcw== 
```

（密码是通过）

我可以在 LDAP 服务器日志中看到正在传递正确的密码。

感谢您阅读本文。阿米特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T17:24:02.757

在第一个配置中，您告诉LDAP DN`BindAuthenticator`使用特定模式`uid={0}`，而实际上它根本不是从`uid`属性构造的，而是使用通用名称 ( `cn=John Milton`)。

这与您使用搜索具有特定`uid`属性的用户的第二种配置不同。

您应该`usedDnsPatterns`从`BindAuthenticator`配置中删除 ，而是配置一个搜索 bean，如[参考手册](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ldap-bean-config)中所述：

```
<bean 
  class="org.springframework.security.ldap.authentication.BindAuthenticator">
   <constructor-arg ref="appLdapServer"/>
   <property name="userSearch" ref="userSearch" />
</bean>

<bean id="userSearch"
  class="org.springframework.security.ldap.search.FilterBasedLdapUserSearch">
   <constructor-arg index="0" value="ou=users"/>
   <constructor-arg index="1" value="(uid={0})"/>
   <constructor-arg index="2" ref="appLdapServer" />
</bean> 
```

# magento - Magento - 获取所有语言的产品名称

> ID：11065032
> 
> 赞同：1
> 
> 时间：2012-06-16T16:06:22.237
> 
> 标签：magento, export, product

在为导出扩展读取所有 magento 产品时，我遇到了一个问题：尝试在加载的模型上使用 getName() 获取产品名称时，您只能获得活动语言名称，或者如果未设置默认名称的产品。但我需要获取默认、英语、德语、法语等的所有产品名称。有没有人有这个问题的解决方案或如何解决它的想法？

```
$model      = Mage::getModel('catalog/product');
$collection = $model->getCollection();
foreach ($collection as $product) {
   $id   = $product->getId();
   $model->load($id);
   $name = $model->getName(); // gives you only the active language name / default name
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-17T12:28:41.307

由于您还想要`default`商店，我只知道一种工作方式：

```
$aStoreHash = Mage::getModel('core/store')
    ->getCollection()
    ->setLoadDefault(true)
    ->toOptionHash();

$aName = array();

foreach ($aStoreHash as $iStoreId => $sStoreName) {
    Mage::app()->setCurrentStore($iStoreId);
    $oCollection = Mage::getModel('catalog/product')
        ->getCollection()
        // Uncomment next line for testing if you have thousands of products
        // ->addFieldToFilter('entity_id', array('from' => 1, 'to' => 5))
        ->addAttributeToSelect('name');
    foreach ($oCollection as $oProduct) {
        $aName[$oProduct->getId()][$iStoreId] = $oProduct->getName();
    }
}
var_dump($aName); 
```

如果您不需要`default`商店，则可以将其丢弃`Mage::app()->setCurrentStore($iStoreId);`并用于`->addStoreFilter($iStoreId)`收藏。

# ruby-on-rails - 乘客 NGINX 模块失败

> ID：11065037
> 
> 赞同：8
> 
> 时间：2012-06-16T16:07:39.473
> 
> 标签：ruby-on-rails, nginx, passenger

有一次，我在我的系统上使用 NGINX、Rails 和Passenger 一切都运行良好。

昨天我重新安装了Passenger，现在`passenger-install-nginx-module`失败了。

```
 /.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/passenger-3.0.13/ext/nginx/../common/libpassenger_common.a /.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/passenger-3.0.13/ext/nginx/../common/libboost_oxt.a -lstdc++ -       lpthread -lm -lpcre -lssl -lcrypto -lz
Undefined symbols for architecture x86_64:
 "_pcre_free_study", referenced from:
  _ngx_pcre_free_studies in ngx_regex.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make[1]: *** [objs/nginx] Error 1
make: *** [build] Error 2 
```

这个确切的问题昨天发布在 ServerFault 上，但我认为这里更有可能得到回答（如果这是一个问题，我深表歉意）。

[https://serverfault.com/questions/399304/cannot-install-phusion-passenger-3-0-13-with-nginx-1-2-1](https://serverfault.com/questions/399304/cannot-install-phusion-passenger-3-0-13-with-nginx-1-2-1)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T22:25:09.697

我看到 NGINX 有一张已关闭的[票](http://trac.nginx.org/nginx/ticket/94#comment:9)，但该解决方案对我不起作用。

然而，我确实通过运行自定义安装来让 NGINX 重新启动并与Passenger 一起运行。这显然是与版本 2 及更高版本的兼容性问题。

首先，我刚刚下载了 NGINX 源代码（1.0.15）。

在我的 /usr/local

```
wget http://www.nginx.org/download/nginx-1.0.15.tar.gz nginx_source 
```

解压

```
 tar -xvz nginx-1.0.15.tar.gz 
```

然后运行乘客安装。选择选项 2（自定义安装）

```
sudo passenger-install-nginx-module 
```

在那里它会提示您输入源的位置`/usr/local/nginx-1.0.15`以及您想要安装它的位置`/usr/local/nginx`（在我的情况下）。

从那里一切正常，任何人都知道 NGINX 2 的任何真正修复，请告诉我。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T15:12:07.643

```
brew install pcre 
```

当配置步骤也添加

```
--with-pcre --with-ipv6 --with-ld-opt=-L/usr/local/lib 
```

它还使用 with-ld-opt 作为自制软件，它并不完美。

也可以看看[http://wiki.nginx.org/InstallOptions](http://wiki.nginx.org/InstallOptions)

# css - CSS3多重动画效果

> ID：11065047
> 
> 赞同：2
> 
> 时间：2012-06-16T16:09:05.330
> 
> 标签：css, hover, css-animations

我必须建立一个以儿童为目标的网站，并且我希望有一些图像可以在悬停或单击时进行动画处理（仅限 CSS，只是为了好玩，我已经知道如何在 JS 中做到这一点）。你见过迪斯尼游戏吗？菜单实际上并不存在，您只有一些图像（例如日历或抽屉），如果您浏览它们，它们就会产生动画效果。我有一个女孩的形象（所有的图画都是漫画风格的），如果你悬停在她身上，我希望这个女孩向你打招呼。然后，动画分为不同的步骤： 1）放下手臂，并被桌子隐藏。共有三个图像：女孩、前臂和手（加上手臂的最后部分）。2）悬停！前臂向上移动，比如说 85-90 度。3）前臂停止，但手臂和手的其余部分继续移动（左，右，左，右，再一次）。考虑一下，

目前我只能让女孩移动一次（整个手臂向上移动，但这并不像我想要的那样自然）。如何实现我想要的多个动画？

非常感谢！

Ps 我不想让所有浏览器都这么舒服，只是 webkit+mozilla，不关心 IE。

编辑：

随着时间的推移多次转换呢？像“翻译（0,4em）”和x秒后“旋转（50度）”之类的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:17:05.293

您可能会考虑查看 @keyframes 以使用纯 CSS 实现某些目标，但请记住您的浏览器支持会限制您。查看 caniuse.com 以了解故障可能是什么。否则，您正在考虑使用大量 javascript、sprite 和 CSS 对其进行编程。Flash 也始终是一种选择，虽然不是流行的，但在您描述的游戏网站上经常可以找到。

所以在 CSS 中是这样的：

```
//webkit only here:
@-webkit-keyframes fade-in {
0% {
    -webkit-transform: ease-in-out(0);
opacity: 0;
}
50% {
    opacity: 0;
}
100% {
 -webkit-transform: ease-in-out(1);
opacity: 1;
}
}

#el{
-webkit-animation-duration: 1.5s;
-webkit-animation-name: fade-in; 

} 
```

# c++ - 如何正确使用“__beginthreadex”？

> ID：11065048
> 
> 赞同：2
> 
> 时间：2012-06-16T16:09:14.770
> 
> 标签：c++, multithreading, visual-c++

我正在使用 VC2010，并编写以下代码来测试“__beginthreadex”

```
#include <process.h>
#include <iostream>

unsigned int __stdcall threadproc(void* lparam)
{
    std::cout << "my thread" << std::endl;
    return 0;
}
int _tmain(int argc, _TCHAR* argv[])
{
    unsigned  uiThread1ID = 0;
    uintptr_t th = _beginthreadex(NULL, 0, threadproc, NULL, 0, &uiThread1ID);

    return 0;
} 
```

但是没有任何东西打印到控制台。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T16:12:30.247

您的主例程立即退出，导致整个进程立即关闭，包括作为该进程一部分的所有线程。它怀疑你的新线程甚至有机会开始执行。

处理此问题的典型方法是使用[WaitForSingleObject](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687032%28v=vs.85%29.aspx)并阻塞直到线程完成。

```
int _tmain(int argc, _TCHAR* argv[])
{
    unsigned  uiThread1ID = 0;
    uintptr_t th = _beginthreadex(NULL, 0, threadproc, NULL, 0, &uiThread1ID);

    // block until threadproc done
    WaitForSingleObject(th, INFINITE/*optional timeout, in ms*/);

    return 0;
} 
```

# asp.net - 如何将 DOB 从 3 下拉列表（ASP.NET）保存到 sql 数据库中？

> ID：11065053
> 
> 赞同：0
> 
> 时间：2012-06-16T16:09:44.053
> 
> 标签：asp.net, sql

我有一个包含 3 个下拉列表的 ASP.NET 表单。这些列表用于选择 DOB（出生日期）。如何将选定的日期保存在 sql 数据库中？我是否需要 3 个单独的列用于`DD`、`MM`和 `YY`？如果我需要创建 3 列，我将如何计算年龄？我使用存储过程将值从表单传输到我的数据库。

请记住，我是初学者。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:12:15.180

您获取各个值（星期一、日、年），将它们组合成一个日期，然后将其存储。为了显示你做相反的事情，你把日期分解成单独的值，然后适当地更新每个下拉列表。

确保在存储之前验证日期，以免最终尝试存储“2012 年 2 月 30 日”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:22:49.077

您还可以执行以下操作

*   在数据库表中创建日期列

然后像这样

```
int yr = 2009; //yrdropdown value
int month = 04; //monthdropdown value
int days = 30; //day dropdown value
DateTime dob = new DateTime(yr, month, day); 
```

# c# - Amazon S3 - 远程服务器返回错误：(407) 代理身份验证

> ID：11065054
> 
> 赞同：1
> 
> 时间：2012-06-16T16:09:45.720
> 
> 标签：c#, .net, authentication, proxy, amazon-s3

我有以下代码在 s3 中上传文件。

```
AmazonS3 s3Client = AWSClientFactory.CreateAmazonS3Client("AWSAccessKey", "AWSSecretKey");

String strS3KEY = "JSON_FILE_NAME";
PutObjectRequest request = new PutObjectRequest();
request.WithBucketName("AWS_BUCKET");
request.WithKey(strS3KEY);
request.WithContentBody("Test");
request.CannedACL = S3CannedACL.PublicRead;
s3Client.PutObject(request); 
```

这可以在本地系统中找到。**当我在s3Client.PutObject(request);**行中从部署服务器运行应用程序时 它给出了以下错误-

**远程服务器返回错误：(407) 需要代理身份验证。**

堆栈跟踪是 -

```
at System.Net.HttpWebRequest.GetRequestStream(TransportContext& context)
at System.Net.HttpWebRequest.GetRequestStream()
at Amazon.S3.AmazonS3Client.getRequestStreamCallback[T](IAsyncResult result)
at Amazon.S3.AmazonS3Client.endOperation[T](IAsyncResult result)
at Amazon.S3.AmazonS3Client.EndPutObject(IAsyncResult asyncResult)
at Amazon.S3.AmazonS3Client.PutObject(PutObjectRequest request)
at XMLandCloudConsole.Program.Main(String[] args) in C:\Users\spxc\Desktop\consoletest \XMLandCloudConsole\XMLandCloudConsole\Program.cs:line 29
at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext,     ContextCallback callback, Object state)
at System.Threading.ThreadHelper.ThreadStart() 
```

# css - 带有 CSS 显示表的三列布局，第一行有多行？

> ID：11065058
> 
> 赞同：2
> 
> 时间：2012-06-15T23:24:50.043
> 
> 标签：css, css-tables

我正在开发一个新网站：

1.  有 3 列 - 每列都是一个单元格
2.  第一列有 3 行（徽标、导航、图标） - 有一个带有 display: 的 Div 表，它用`display:table-row`.
3.  其他两列只有 1 行。中间列是内容区域。

然而，由于这是我第一次使用`display:table`，我遇到了一些对我来说不太清楚的事情。我试图避免浮动div。

1.  如果我需要多行，每列每行有一个单元格，我是将每个单元格嵌入一行还是只创建每一行而不声明单元格。我了解浏览器会自动创建缺少的元素，但我想确保我正确地执行此操作以避免由于浏览器自动创建缺少的元素而可能发生的任何副作用。

**编辑：**

我认为我的大脑工作过度了，我想我可以通过在第一列中使用 3 个 div 而不是使用带有行的嵌套表 div 来实现这一点。这只是突然出现在我的脑海中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T01:03:37.547

这样的事情怎么样？

```
<table>
    <tr>
        <td>
            Content One
        </td>
        <td>
            Content Two
        </td>
        <td>
            Content Three
        </td>
    </tr>
    <tr>
        <td colspan="3">
            MainVontent Four
        </td>
    </tr>
</table> 
```

还是像这样？

```
<table>
    <tr>
        <td>
            Content One
        </td>
        <td>
            Content Two
        </td>
        <td>
            Content Three
        </td>
    </tr>
    <tr>
        <td>
            <!-- INTENTIONALLY BLANK -->
        </td>
        <td>
            MainVontent Four
        </td>
        <td>
            <!-- INTENTIONALLY BLANK -->
        </td>
    </tr>
</table> 
```

# php - 更改用户状态

> ID：11065061
> 
> 赞同：-1
> 
> 时间：2012-06-16T16:10:46.600
> 
> 标签：php, mysql, session

我的网站上有一个日志系统，但我不知道如何获取用户的状态（在线/离线）。我已经阅读了更多主题，但我不明白它们......有人可以给我一个例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T16:15:42.157

你不知道页面是否离服务器很近，你不能用 PHP 来检查。您可以在客户端使用 javascript 检查并在每个事件上以 ajax 调用您的服务器。

以 Jquery 为例：

```
<script>
$(window).unload( function () { $.get('http://exemple.com/user.php?offline=true'); } );
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:13:33.810

只需在数据库`status`中的`user_info`表中添加一列，当用户登录时使用“登录”更新它，当它注销时使用“注销”更新它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T16:19:37.813

我会跟踪用户的行为；这就是 Stack Overflow 所做的（以及“最后一次看到”而不是“在线”或“离线”），它工作得非常好。

选择一个标准：

*   请求了一个页面
*   发布了一些东西
*   特别适用于您的网站的任何其他内容

如果用户在过去*n*分钟内没有这样做，那么您可以假设用户处于离线状态。我想说一个好的阈值可能是 30 分钟。

# java - AES/CBC/PKCS5Padding 问题

> ID：11065063
> 
> 赞同：3
> 
> 时间：2012-06-16T16:11:07.730
> 
> 标签：java, cryptography, aes, jce

我正在尝试加密和解密一些简单的文本。但由于某种原因，我收到了一个奇怪的错误：`javax.crypto.BadPaddingException`. 为什么 JCE 会生成未正确填充的字节？

我有以下代码：

```
import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import java.security.SecureRandom;

public class SimplestTest {
    public static void main(String[] args) throws Exception {
        SecureRandom rnd = new SecureRandom();

        String text = "Hello, my dear! ... " + System.getProperty("user.home");
        byte[] textData = text.getBytes();

        IvParameterSpec iv = new IvParameterSpec(rnd.generateSeed(16));

        KeyGenerator generator = KeyGenerator.getInstance("AES");
        generator.init(128);
        SecretKey k = generator.generateKey();

        Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
        c.init(Cipher.ENCRYPT_MODE, k, iv);
        c.update(textData);
        byte[] data = c.doFinal();

        System.out.println("E: " + data.length);

        c = Cipher.getInstance("AES/CBC/PKCS5Padding");
        c.init(Cipher.DECRYPT_MODE, k, iv);
        c.update(data);

        System.out.println("R: " + c.doFinal().length);
    }

} 
```

但由于某种原因，它不起作用。它因以下异常而失败：

```
E: 16
Exception in thread "main" javax.crypto.BadPaddingException: Given final block not properly padded
        at com.sun.crypto.provider.SunJCE_f.b(DashoA13*..)
        at com.sun.crypto.provider.SunJCE_f.b(DashoA13*..)
        at com.sun.crypto.provider.AESCipher.engineDoFinal(DashoA13*..)
        at javax.crypto.Cipher.doFinal(DashoA13*..)
        at SimplestTest.main(SimplestTest.java:31) 
```

怎么了？数据大小为 16 字节，但仍“未正确填充”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T16:30:47.983

Cipher.update 也返回一个 byte[]。因此，当您进行解密时，您会丢失部分加密数据。将最后一部分更新为如下所示：

```
Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] someData = c.update(textData);
byte[] moreData = c.doFinal();

System.out.println("E: " + (someData.length + moreData.length));

c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.DECRYPT_MODE, k, iv);
byte[] someDecrypted = c.update(someData);
byte[] moreDecrypted = c.doFinal(moreData);

System.out.println("R: " + (someDecrypted.length + moreDecrypted.length)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T18:40:49.243

您可以放弃调用，直接`update`将`byte[]`数据传递给`doFinal`一步执行加密或解密操作。

# sbt - 使用 SBT 复制文件

> ID：11065064
> 
> 赞同：6
> 
> 时间：2012-06-16T16:11:11.727
> 
> 标签：sbt

我正在使用 SBT 构建一个 java 项目，并且需要复制文本文件（不是资源，而是由 java 类用来读取）。我对 SBT 或 Scala 都没有经验（需要 build.scala 文件）任何帮助将不胜感激。

例如，如果我的目录结构是：

```
test
    |- files
            |- one.text
    |- main
            |- java
                   |- Test.java 
```

一旦执行 sbt 目标，我希望目标文件夹中的 one.text 文件也可用

```
sbt test 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T10:56:54.760

build.sbt 中的以下几行应该可以解决问题：

```
unmanagedResourceDirectories in Test <+= (baseDirectory) {_ / "files"}

unmanagedSourceDirectories in Test <+= (baseDirectory) {_ / "main" / "java"} 
```

你有一个非标准的项目布局。如果您可以将其更改为标准的“maven 样式”：

```
project/src/main/java
project/src/main/resources
project/src/test/java/{Test.java, ...}
project/src/test/resources/{one.text, ...} 
```

sbt 会自动进行资源复制。

# algorithm - 在数组中找到最短时间的中位数

> ID：11065066
> 
> 赞同：10
> 
> 时间：2012-06-16T16:11:50.993
> 
> 标签：algorithm, math, data-structures

我有一个数组，`a = { 1,4,5,6,2,23,4,2};` 现在可以说我必须找到从 2 到 6 的数组位置的中位数（奇数项），所以我所做的，我已经接受`a[1]`了`a[5]`，然后我对它进行了排序并将其写`arr[0]`为中位数。`arr[4]``arr[2]`

但是每次我将值从一个数组放到另一个数组时，我的初始数组的值都保持不变。其次，我已经排序了，所以这个过程要花很多时间`**time**`。所以我想知道是否有任何方法可以与`reduce my computation time`.

任何网站，要理解的材料，什么以及如何做？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-16T16:56:22.390

使用O [`std::nth_element`](http://en.cppreference.com/w/cpp/algorithm/nth_element)( `<algorithm>`N)：

```
nth_element(a, a + size / 2, a + size);
median = a[size/2]; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-06-16T16:15:31.543

无需在 O(n) 时间内*排序*即可找到中位数；执行此操作的算法称为[选择算法](http://en.wikipedia.org/wiki/Selection_algorithm)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-16T18:08:37.333

如果您在同一个数组上执行多个查询，那么您可以使用分段树。它们通常用于执行范围最小/最大值和范围总和查询，但您可以将其更改为范围中位数。

具有 n 个间隔的集合的段树使用 O(n log n) 存储，并且可以在 O(n log n) 时间内构建。范围查询可以在 O(log n) 中完成。

范围段树中的中位数示例：

您自下而上构建分段树（自上而下更新）：

```
 [5]
        [3]                     [7]
 [1,2]        [4]         [6]         [8] 
1     2     3     4     5     6     7     8 
```

节点覆盖的索引：

```
 [4]
        [2]                     [6]
 [0,1]        [3]         [5]         [7] 
0     1     2     3     4     5     6     7 
```

查询范围索引为 4-6 的中位数将沿着这条值的路径进行：

```
 [4]
                          [5]
0     1     2     3     4     5     6     7 
```

搜索中位数，您知道查询中的总元素数 (3)，并且该范围内的中位数将是第二个元素（索引 5）。因此，您实际上是在搜索包含该索引的第一个节点，该索引是具有值 [1,2] 的节点（索引 0,1）。

搜索 3-6 范围的中位数有点复杂，因为您必须搜索恰好位于同一节点中的两个索引 (4,5)。

```
 [4]
                                [6]
                          [5] 
0     1     2     3     4     5     6     7 
```

[段树](http://en.wikipedia.org/wiki/Segment_tree)

[Segment Tree上的范围最小查询](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-16T16:21:15.503

要找到少于 9 个元素的数组的中位数，我认为最有效的方法是使用像*插入排序*这样的排序算法。复杂性很差，但是对于这么小的数组，由于`k`快速排序等更好的算法的复杂性，插入排序非常有效。做你自己的基准测试，但我可以告诉你，插入排序会比 shell 排序或快速排序有更好的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-16T18:35:39.427

我认为最好的方法是使用中位数算法计算数组的第 k 个最大元素。您可以在此处找到该算法的总体思路：[Java 中的 Median of Median](https://stackoverflow.com/questions/1790360/median-of-medians-in-java)，在维基百科上：[http](http://en.wikipedia.org/wiki/Selection_algorithm#Linear_general_selection_algorithm_-_Median_of_Medians_algorithm) ://en.wikipedia.org/wiki/Selection_algorithm#Linear_general_selection_algorithm_-_Median_of_Medians_algorithm或只是浏览互联网。在实现过程中可以进行一些一般性的改进（在选择特定数组的中值时避免排序）。但是，请注意，对于少于 50 个元素的数组，使用插入排序比中位数算法更有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-18T15:29:05.823

在某些情况下，所有现有答案都有一些缺点：

1.  对整个子范围进行排序并不是很有效，因为不需要对整个数组进行排序来获得中位数，如果要找到多个子范围的中位数，则需要一个额外的数组。
2.  使用`std::nth_element`效率更高，但它仍然会改变子范围，因此仍然需要一个额外的数组。
3.  使用分段树可以获得有效的解决方案，但您需要自己实现结构或使用第三方库。

出于这个原因，我发布了我的方法，该方法使用`std::map`并受到选择排序算法的启发：

1.  首先将第一个子范围内元素的频率收集到 的对象中`std::map<int, int>`。
2.  有了这个对象，我们可以有效地找到长度为 的子范围的中位数`subrangeLength`：

    ```
    double median(const std::map<int, int> &histogram, int subrangeLength)
    {
        const int middle{subrangeLength / 2};
        int count{0};

        /* We use the fact that keys in std::map are sorted, so by simply iterating
           and adding up the frequencies, we can find the median. */
        if (subrangeLength % 2 == 1) {
            for (const auto &freq : histogram) {
                count += freq.second;
                /* In case where subrangeLength is odd, "middle" is the lower integer bound of
                   subrangeLength / 2, so as soon as we cross it, we have found the median. */
                if (count > middle) {
                    return freq.first;
                }
            }
        } else {
            std::optional<double> medLeft;
            for (const auto &freq : histogram) {
                count += freq.second;
                /* In case where subrangeLength is even, we need to pay attention to the case when
                   elements at positions middle and middle + 1 are different. */
                if (count == middle) {
                    medLeft = freq.first;
                } else if (count > middle) {
                    if (!medLeft) {
                        medLeft = freq.first;
                    }
                    return (*medLeft + freq.first) / 2.0;
                }
            }
        }

        return -1;
    } 
    ```

3.  现在，当我们想要获得下一个子范围的中值时，我们只需通过降低要删除的元素的频率来更新直方图，然后为新元素添加/增加它（使用`std::map`，这是在**恒定时间内**完成的）。现在我们再次计算中位数并继续此操作，直到我们处理所有子范围。

# verilog - 关于verilog触发器延迟

> ID：11065067
> 
> 赞同：2
> 
> 时间：2012-06-16T16:12:03.387
> 
> 标签：verilog

我想用两个单比特触发器缓冲一个“完成”的单比特信号。在我的设计中，完成信号只会上升一个时钟周期。所以我写了下面的代码。

```
//first level buffer done signal for one cycle to get ciphertext_reg ready
always @(posedge clk or posedge rst) begin
    if(rst)
        done_buf_1 = 1'b0;
    else
        done_buf_1 = done;
end

//second level buffer
always @(posedge clk or posedge rst) begin
    if(rst)
        done_buf_2 = 1'b0;
    else
        done_buf_2 = done_buf_1;
end 
```

在功能仿真中，我发现 done_buf_1 在完成后上升一个周期，但 done_buf_2 与 done_buf_1 同时上升。

对此有何解释？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T08:20:09.193

您已经得到了解决方案的答案（“使用非阻塞分配”），但这里尝试说明您为什么需要这样做。

您的两个`always`语句都具有相同的事件，因此它们可以按任何顺序运行。似乎正在发生的事情是第一个先运行。当线路...

```
done_buf_1 = done; 
```

...被击中，它将阻塞直到分配完成（这是一个“阻塞”分配）。因此 done_buf_1 立即采用新值。这与非阻塞版本不同......

```
done_buf_1 <= done; 
```

...它说'给 done_buf_1 在时间片结束时完成的值（我现在将评估）'。

现在我们继续，并分配了 done_buf_2。

```
done_buf_2 = done_buf_1; 
```

现在，如果`done_buf_1`使用阻塞分配对其进行了更新，则它的当前值为`done`，您将看到两个信号同时上升。如果它是一个非阻塞赋值，那么它`done_buf_1`仍然具有之前的值`done`，因为它直到时间片结束才会更新，结果是 2 个周期延迟`done_buf_2`。

不过还有另一个问题。还记得我说过，因为事件是相同的，因此 always 语句可以按任意顺序运行吗？好吧，如果首先执行第二个，则代码似乎可以按预期工作（`db2 = db1; db1 = done;`没问题）。所以值得知道的是，使用像这样的阻塞分配会产生不稳定的结果，尤其是在工具之间。这可能会导致一些微妙的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:53:14.087

您正在使用阻塞分配`=`来模拟同步逻辑。您需要使用非阻塞分配`<=`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T11:03:09.317

正如其他人所说：不要`=`为此使用阻塞分配（）。

关键是“this”是不同进程之间通信的工作。阻塞分配中固有的竞争条件使这种情况变得不可预测。VHDL 非常重视这一点，它将这些类型的赋值分开，这样你*就不能*使用错误的赋值（只要你远离共享变量）。

Jan Decaluwe 关于这个主题的一些有趣的著作：

*   [Verilog的主要缺陷](http://www.sigasi.com/content/verilogs-major-flaw)
*   [VHDL 的皇冠上的明珠](http://www.sigasi.com/content/vhdls-crown-jewel)

# iphone - 在应用程序中显示文件

> ID：11065074
> 
> 赞同：1
> 
> 时间：2012-06-16T16:13:20.157
> 
> 标签：iphone, objective-c, ios, ipad

我有`Open-in`各种文档类型的应用程序设置。例如，用户在我的应用程序中打开一个 PDF，然后我让他们选择他们想要放入的文件夹并将其上传到我的服务器，而不是显示它。我正在获取 url，将其转换为 NSData 并将其上传到我的服务器（效果很好）。

然后，当他们想稍后查看文件时，我从我的服务器中提取 NSData ......这就是我卡住的地方。如何获取该 NSData 对象并从我的应用程序中向用户显示内容？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:45:11.943

使用 UIWebView 显示包含 PDF 的 NSData

```
[self.webView loadData:data MIMEType:@"application/pdf" textEncodingName:@"utf-8"     baseURL:nil]; 
```

Web 视图可以显示不同的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:26:57.827

您要么必须为您计划支持的每种类型的文档包括视图支持，要么将该任务交给另一个应用程序，该应用程序可以使用 UIDocumentInteractionController 为您完成。

有关更多信息，请参阅[iOS 文档交互编程主题](http://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/DocumentInteraction_TopicsForIOS/Articles/PreviewingandOpeningItems.html#//apple_ref/doc/uid/TP40010410-SW1)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T16:18:46.350

如果服务器不需要任何用户/密码挑战，您可以这样做

```
NSURL*url=[NSURL URLWithString:@"your url goes here"];
NSData*data=[NSData dataWithContentsOfURL:url]; 
```

您还可以使用 NSURLRequest 更好地控制您的下载，并使用它的委托方法实现 NSURLConnection 类

如果您使用 NSURLConnection 实现 NSURLRequest 您可以挑战用户/密码

对于大型内容，您可以使用类方法

```
+ sendAsynchronousRequest:queue:completionHandler: 
```

要从 NSData 创建 pdf 文档，您可以执行以下操作：

```
CFDataRef myPDFData = (CFDataRef)data;
CGDataProviderRef provider= CGDataProviderCreateWithCFData(myPDFData);
CGPDFDocumentRef pdf= CGPDFDocumentCreateWithProvider(provider); 
```

data 是你收到的数据

# linux - Bash 中的 eval 命令及其典型用途

> ID：11065077
> 
> 赞同：190
> 
> 时间：2012-06-16T16:13:41.057
> 
> 标签：linux, bash, shell, scripting, eval

在阅读了 bash 手册页和关于这篇[文章之后](http://www.unix.com/shell-programming-scripting/66063-eval-shell-scripting.html)。

我仍然无法理解该`eval`命令的确切作用以及它的典型用途。例如，如果我们这样做：

```
bash$ set -- one two three  # sets $1 $2 $3
bash$ echo $1
one
bash$ n=1
bash$ echo ${$n}       ## First attempt to echo $1 using brackets fails
bash: ${$n}: bad substitution
bash$ echo $($n)       ## Second attempt to echo $1 using parentheses fails
bash: 1: command not found
bash$ eval echo \${$n} ## Third attempt to echo $1 using 'eval' succeeds
one 
```

这里到底发生了什么，美元符号和反斜杠如何与问题联系起来？

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2012-06-16T16:32:37.527

`eval`接受一个字符串作为它的参数，并评估它，就好像你在命令行上输入了那个字符串一样。（如果你传递了几个参数，它们首先用它们之间的空格连接起来。）

`${$n}`是 bash 中的语法错误。在大括号内，你只能有一个变量名，带有一些可能的前缀和后缀，但你不能有任意的 bash 语法，特别是你不能使用变量扩展。不过，有一种说法是“名称在此变量中的变量的值”：

```
echo ${!n}
one 
```

`$(…)`在子shell 中运行括号内指定的命令（即在从当前shell 继承所有设置（例如变量值）的单独进程中），并收集其输出。所以作为 shell 命令`echo $($n)`运行，并显示其输出。`$n`由于`$n`计算结果为`1`，因此`$($n)`尝试运行`1`不存在的命令。

`eval echo \${$n}`运行传递给的参数`eval`。展开后参数为`echo`和`${1}`。所以`eval echo \${$n}`运行命令`echo ${1}`。

请注意，大多数情况下，您必须在变量替换和命令替换周围使用双引号（即，只要有 a `$`）`"$foo", "$(foo)"`：。**总是在变量和命令替换周围加上双引号**，除非你知道你需要把它们去掉。如果没有双引号，shell 会执行字段拆分（即，它将变量的值或命令的输出拆分为单独的单词），然后将每个单词视为通配符模式。例如：

```
$ ls
file1 file2 otherfile
$ set -- 'f* *'
$ echo "$1"
f* *
$ echo $1
file1 file2 file1 file2 otherfile
$ n=1
$ eval echo \${$n}
file1 file2 file1 file2 otherfile
$eval echo \"\${$n}\"
f* *
$ echo "${!n}"
f* * 
```

`eval`不经常使用。在某些 shell 中，最常见的用途是获取名称直到运行时才知道的变量的值。`${!VAR}`在 bash 中，由于语法原因，这不是必需的。`eval`当您需要构建包含运算符、保留字等的较长命令时，它仍然很有用。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-06-16T16:19:06.237

简单地将 eval 视为“在执行前再评估一次表达式”

`eval echo \${$n}``echo $1`第一轮评估后就变成了。需要注意的三个变化：

*   become `\$`（`$`需要反斜杠，否则它会尝试评估`${$n}`，这意味着一个名为 的变量`{$n}`，这是不允许的）
*   `$n`被评估为`1`
*   `eval`消失的

第二轮基本上`echo $1`是可以直接执行的。

所以`eval <some command>`将首先评估`<some command>`（这里的评估是指替换变量，用正确的字符替换转义字符等），然后再次运行结果表达式。

`eval`当您想要动态创建变量或从专门设计为这样读取的程序中读取输出时使用。有关示例，请参见[http://mywiki.wooledge.org/BashFAQ/048](http://mywiki.wooledge.org/BashFAQ/048)。该链接还包含一些典型`eval`的使用方式以及与之相关的风险。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-10-22T17:29:13.357

根据我的经验，eval 的“典型”用途是运行生成 shell 命令以设置环境变量的命令。

也许您有一个使用环境变量集合的系统，并且您有一个脚本或程序来确定应该设置哪些变量及其值。每当您运行脚本或程序时，它都会在分叉的进程中运行，因此它直接对环境变量执行的任何操作都会在退出时丢失。但是该脚本或程序可以将导出命令发送到标准输出。

如果没有 eval，您需要将 stdout 重定向到临时文件，获取临时文件，然后将其删除。使用 eval，您可以：

```
eval "$(script-or-program)" 
```

注意引号很重要。以这个（人为的）示例为例：

```
# activate.sh
echo 'I got activated!'

# test.py
print("export foo=bar/baz/womp")
print(". activate.sh")

$ eval $(python test.py)
bash: export: `.': not a valid identifier
bash: export: `activate.sh': not a valid identifier
$ eval "$(python test.py)"
I got activated! 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-09-23T09:12:59.513

eval 语句告诉 shell 将 eval 的参数作为命令并通过命令行运行它们。它在以下情况下很有用：

在您的脚本中，如果您将命令定义为变量，并且稍后您想使用该命令，那么您应该使用 eval：

```
/home/user1 > a="ls | more"
/home/user1 > $a
bash: command not found: ls | more
/home/user1 > # Above command didn't work as ls tried to list file with name pipe (|) and more. But these files are not there
/home/user1 > eval $a
file.txt
mailids
remote_cmd.sh
sample.txt
tmp
/home/user1 > 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-10-26T00:28:29.063

[*更新：有人说不应该 - 永远 - 使用 eval。我不同意。我认为当损坏的输入可以传递给`eval`. 但是，在许多常见情况下，这不是风险，因此在任何情况下都值得了解如何使用 eval。这个[stackoverflow 答案](https://stackoverflow.com/a/17529221/2079103)解释了 eval 的风险和 eval 的替代方案。最终，由用户来确定 eval 是否/何时安全有效地使用。*]

* * *

bash`eval`语句允许您执行由 bash 脚本计算或获取的代码行。

也许最直接的例子是一个 bash 程序，它打开另一个 bash 脚本作为文本文件，读取每一行文本，然后`eval`按顺序执行它们。这本质上与 bash 语句的行为相同`source`，除非有必要对导入脚本的内容执行某种转换（例如过滤或替换），否则会使用该语句。

我很少需要，但我发现读取或写入*名称*包含在分配给其他变量的字符串中的`eval`变量很有用。例如，对变量集执行操作，同时保持代码占用空间小并避免冗余。

 *`eval`概念上很简单。然而，bash 语言的严格语法，以及 bash 解释器的解析顺序可能是细微的，使得`eval`显得晦涩难懂，难以使用或理解。以下是要点：

1.  传递给的参数`eval`是一个在运行时计算的*字符串表达式。*`eval`将其参数的最终解析结果作为脚本中的*实际代码行执行。*

2.  语法和解析顺序是严格的。如果结果不是可执行的 bash 代码行，则在您的脚本范围内，程序将在`eval`尝试执行垃圾时在语句上崩溃。

3.  测试时，您可以将`eval`语句替换为`echo`并查看显示的内容。如果它是当前上下文中的合法代码，那么运行它就`eval`可以了。

* * *

## *以下示例可能有助于阐明 eval 的工作原理...*

*示例 1：*

## `eval`“正常”代码前面的语句是 NOP

```
$ eval a=b
$ eval echo $a
b 
```

在上面的示例中，第一个`eval`语句没有任何目的，可以删除。`eval`在第一行中没有意义，因为代码没有动态方面，即它已经解析为 bash 代码的最后几行，因此它与 bash 脚本中的正常代码语句相同。第二个`eval`也是没有意义的，因为虽然有一个解析步骤转换`$a`为它的文字字符串等价物，但没有间接性（例如，没有通过*实际*bash 名词或 bash 持有的脚本变量的字符串值进行引用），所以它的行为相同作为没有`eval`前缀的代码行。

* * *

* * *

*示例 2：*

## 使用作为字符串值传递的 var 名称执行 var 赋值。

```
$ key="mykey"
$ val="myval"
$ eval $key=$val
$ echo $mykey
myval 
```

如果你要`echo $key=$val`，输出将是：

```
mykey=myval 
```

*那*，作为字符串解析的最终结果，将由 eval 执行，因此最后的 echo 语句的结果......

* * *

* * *

*示例 3：*

## 为示例 2 添加更多间接性

```
$ keyA="keyB"
$ valA="valB"
$ keyB="that"
$ valB="amazing"
$ eval eval \$$keyA=\$$valA
$ echo $that
amazing 
```

上面的例子比前面的例子要复杂一些，更多地依赖于 bash 的解析顺序和特性。该`eval`行将大致按以下顺序在内部进行解析*（注意以下语句是伪代码，而不是真实代码，只是为了尝试显示语句如何在内部分解为步骤以达到最终结果）*。

```
 eval eval \$$keyA=\$$valA  # substitution of $keyA and $valA by interpreter
 eval eval \$keyB=\$valB    # convert '$' + name-strings to real vars by eval
 eval $keyB=$valB           # substitution of $keyB and $valB by interpreter
 eval that=amazing          # execute string literal 'that=amazing' by eval 
```

如果假定的解析顺序不能充分解释 eval 的作用，则第三个示例可能会更详细地描述解析以帮助澄清正在发生的事情。

* * *

* * *

*示例 4：*

## 发现*名称*包含在字符串中的变量本身是否包含字符串值。

```
a="User-provided"
b="Another user-provided optional value"
c=""

myvarname_a="a"
myvarname_b="b"
myvarname_c="c"

for varname in "myvarname_a" "myvarname_b" "myvarname_c"; do
    eval varval=\$$varname
    if [ -z "$varval" ]; then
        read -p "$varname? " $varname
    fi
done 
```

在第一次迭代中：

```
varname="myvarname_a" 
```

Bash 将参数解析为`eval`，并`eval`在运行时从字面上看到：

```
eval varval=\$$myvarname_a 
```

下面的***伪代码***试图说明bash*如何*解释上面这行***真实***代码，以得出由`eval`. （以下几行是描述性的，而不是确切的 bash 代码）：

```
1\. eval varval="\$" + "$varname"      # This substitution resolved in eval statement
2\. .................. "$myvarname_a"  # $myvarname_a previously resolved by for-loop
3\. .................. "a"             # ... to this value
4\. eval "varval=$a"                   # This requires one more parsing step
5\. eval varval="User-provided"        # Final result of parsing (eval executes this) 
```

一旦所有的解析完成，结果就是执行的结果，它的效果是显而易见的，说明它`eval`本身并没有什么特别神秘的地方，复杂的地方在于它的参数*解析*。

```
varval="User-provided" 
```

上面示例中的其余代码只是测试分配给 $varval 的值是否为空，如果是，则提示用户提供一个值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-01-05T19:12:30.183

本来我是故意没学过 eval 的，因为大部分人都会建议远离它，像瘟疫一样远离它。然而，我最近发现了一个用例，让我因为没有早点识别它而脸红。

如果您有要以交互方式运行以测试的 cron 作业，您可以使用 cat 查看文件的内容，然后复制并粘贴 cron 作业以运行它。不幸的是，这涉及到触摸鼠标，这在我的书中是一种罪过。

假设您在 /etc/cron.d/repeatme 有一个 cron 作业，内容如下：

`*/10 * * * * root program arg1 arg2`

您不能将其作为脚本执行，并且前面有所有垃圾，但我们可以使用 cut 删除所有垃圾，将其包装在子 shell 中，然后使用 eval 执行字符串

`eval $( cut -d ' ' -f 6- /etc/cron.d/repeatme)`

cut 命令只打印文件的第 6 个字段，由空格分隔。eval 然后执行该命令。

我在这里使用了一个 cron 作业作为示例，但其概念是从标准输出格式化文本，然后评估该文本。

在这种情况下使用 eval 并不是不安全的，因为我们事先就知道我们将要评估什么。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-05T09:16:32.770

我最近不得不使用`eval`强制按我需要的顺序评估多个大括号扩展。Bash 从左到右进行多个大括号扩展，所以

```
xargs -I_ cat _/{11..15}/{8..5}.jpg 
```

扩展到

```
xargs -I_ cat _/11/8.jpg _/11/7.jpg _/11/6.jpg _/11/5.jpg _/12/8.jpg _/12/7.jpg _/12/6.jpg _/12/5.jpg _/13/8.jpg _/13/7.jpg _/13/6.jpg _/13/5.jpg _/14/8.jpg _/14/7.jpg _/14/6.jpg _/14/5.jpg _/15/8.jpg _/15/7.jpg _/15/6.jpg _/15/5.jpg 
```

但我需要先完成第二个大括号扩展，产生

```
xargs -I_ cat _/11/8.jpg _/12/8.jpg _/13/8.jpg _/14/8.jpg _/15/8.jpg _/11/7.jpg _/12/7.jpg _/13/7.jpg _/14/7.jpg _/15/7.jpg _/11/6.jpg _/12/6.jpg _/13/6.jpg _/14/6.jpg _/15/6.jpg _/11/5.jpg _/12/5.jpg _/13/5.jpg _/14/5.jpg _/15/5.jpg 
```

我能想到的最好的办法是

```
xargs -I_ cat $(eval echo _/'{11..15}'/{8..5}.jpg) 
```

这是有效的，因为单引号保护第一组大括号在`eval`命令行解析期间不被扩展，让它们被`eval`.

可能有一些涉及嵌套大括号扩展的狡猾方案，可以让这一步发生，但如果有的话，我太老太笨了，看不到它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-03-18T10:34:00.893

您询问了典型用途。

关于 shell 脚本的一个常见抱怨是您（据称）不能通过引用传递以从函数中取回值。

但实际上，通过“eval”，您**可以**通过引用传递。被调用者可以传回要由调用者评估的变量赋值列表。它是通过引用传递的，因为调用者可以指定结果变量的名称 - 请参见下面的示例。错误结果可以传回标准名称，如 errno 和 errstr。

下面是一个在 bash 中通过引用传递的示例：

```
#!/bin/bash
isint()
{
    re='^[-]?[0-9]+$'
    [[ $1 =~ $re ]]
}

#args 1: name of result variable, 2: first addend, 3: second addend 
iadd()
{
    if isint ${2} && isint ${3} ; then
        echo "$1=$((${2}+${3}));errno=0"
        return 0
    else
        echo "errstr=\"Error: non-integer argument to iadd $*\" ; errno=329"
        return 1
    fi
}

var=1
echo "[1] var=$var"

eval $(iadd var A B)
if [[ $errno -ne 0 ]]; then
    echo "errstr=$errstr"
    echo "errno=$errno"
fi
echo "[2] var=$var (unchanged after error)"

eval $(iadd var $var 1)
if [[ $errno -ne 0 ]]; then
    echo "errstr=$errstr"
    echo "errno=$errno"
fi  
echo "[3] var=$var (successfully changed)" 
```

输出如下所示：

```
[1] var=1
errstr=Error: non-integer argument to iadd var A B
errno=329
[2] var=1 (unchanged after error)
[3] var=2 (successfully changed) 
```

该文本输出中的带宽几乎是**无限的！**如果使用多个输出行，还有更多的可能性：例如，第一行可以用于变量赋值，第二行用于连续的“思想流”，但这超出了本文的范围。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-17T04:38:03.187

我喜欢“在执行前再评估一次表达式”的答案，并想用另一个例子来澄清一下。

```
var="\"par1 par2\""
echo $var # prints nicely "par1 par2"

function cntpars() {
  echo "  > Count: $#"
  echo "  > Pars : $*"
  echo "  > par1 : $1"
  echo "  > par2 : $2"

  if [[ $# = 1 && $1 = "par1 par2" ]]; then
    echo "  > PASS"
  else
    echo "  > FAIL"
    return 1
  fi
}

# Option 1: Will Pass
echo "eval \"cntpars \$var\""
eval "cntpars $var"

# Option 2: Will Fail, with curious results
echo "cntpars \$var"
cntpars $var 
```

选项 2 中奇怪的结果是我们将传递 2 个参数，如下所示：

*   第一个参数：`"value`
*   第二个参数：`content"`

反直觉如何？额外的`eval`将解决这个问题。

改编自[https://stackoverflow.com/a/40646371/744133](https://stackoverflow.com/a/40646371/744133)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-28T04:46:38.950

在问题中：

```
who | grep $(tty | sed s:/dev/::) 
```

输出错误，声称文件 a 和 tty 不存在。我理解这意味着 tty 在执行 grep 之前没有被解释，而是 bash 将 tty 作为参数传递给 grep，grep 将其解释为文件名。

还有一种嵌套重定向的情况，应该通过匹配的括号来处理，应该指定一个子进程，但是bash原始是一个单词分隔符，创建要发送给程序的参数，因此括号不首先匹配，而是解释为见过。

我使用 grep 进行了具体操作，并将文件指定为参数而不是使用管道。我还简化了基本命令，将命令的输出作为文件传递，这样 i/o 管道就不会被嵌套：

```
grep $(tty | sed s:/dev/::) <(who) 
```

效果很好。

```
who | grep $(echo pts/3) 
```

并不是真正需要的，但消除了嵌套管道并且效果很好。

总之，bash 似乎不喜欢嵌套的 pipping。重要的是要了解 bash 不是以递归方式编写的新浪潮程序。相反，bash 是一个旧的 1,2,3 程序，它已经附加了一些特性。为了确保向后兼容，最初的解释方式从未被修改过。如果 bash 被重写为首先匹配括号，那么多少个 bash 程序会引入多少错误？许多程序员喜欢神秘。*

# excel - Excel：计算非连续范围内的相同数值

> ID：11065078
> 
> 赞同：2
> 
> 时间：2012-06-16T16:13:45.337
> 
> 标签：excel, vba

我正在寻找最优雅的方法来计算非连续范围内的相同数值（我将其称为“范围”）。这是范围：

```
=$C$2:$C$31,$E$2:$E$31,$G$2:$G$31,$I$2:$I$31,$K$2:$K$31,$M$2:$M$31,$O$2:$O$31,$Q$2:$Q$31,$S$2:$S$7 
```

这些是参数：

*   该范围包含不相邻的列。
*   列的高度不同。
*   范围内的单元格为空或包含整数。
*   我正在检查范围内有多少个单元格等于“1”，多少个等于“2”等。（不是一口气，而是在单独的公式中）。
*   我使用了一个命名范围来引用该范围。我真的很想以一种或另一种方式在公式中使用这个命名范围。

我希望我已经给了你足够的信息......提前谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T23:01:06.483

我同意 Kartik 的观点，即需要 VBA 解决方案。然而，提供的解决方案效率有点低，因为它循环遍历传递给函数的范围内的每个单元格。它还将`key`参数限制为范围引用，并且最多只能计数 32767 个匹配项。这是解决这些缺点的替代方案

```
Function CountIf_N(rng As Range, key As Variant) As Variant
    Dim r As Range
    Dim count As Long
    count = 0
    For Each r In rng.Areas
        count = count + WorksheetFunction.CountIfs(r, key)
    Next
    CountIf_N = count
End Function 
```

注意：假设 Excel 07 或更高版本。如果使用更早的版本，请替换`CountIfs`为`CountIf`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T16:53:23.773

一种方法是使用内置函数 Countif 的 excel，但它不适用于非连续范围。另一种方法（简单的方法）是使用 VBA 创建您自己的自定义函数，然后在 excel 中使用它。
我在这里介绍了这种技术。

按 Alt+F11 转到 Excel 中的 Visual Basic 编辑器，在项目窗口中插入一个新模块并粘贴以下代码：

```
Function countif_n(rng As Range, key As Range) As Integer

Dim count As Integer
count = 0

For Each cell In rng
    If cell.Value = key.Value Then
        count = count + 1
    End If
Next cell

countif_n = count

End Function 
```

这里 rng 是您的非连续范围，而 key 表示包含您要计算的值的“范围”（单元格）。例如，要检查 1 在任何单元格中输入 1 假设“F2”，并且您的非连续范围是“testrange”

然后通过在任何空白单元格中输入以下内容来使用上述功能：

```
=countif_n(testrange, F2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-17T13:42:14.523

尽管 COUNTIF 不能处理非连续范围，但某些函数可以，例如 RANK 和 COUNT，因此对于称为**Range**的范围，此公式将给出 Z2 中某个数字在**Range内的实例数**

`=IFERROR(COUNT(Range)-SUM(RANK(Z2,Range,{1,0}))+2,0)`

假定 Excel 2007 或更高版本，但可以修改为在早期版本中工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T18:35:38.327

如果 S7 以下的东西无法计数，这并不完全有效，但您可以修改。它也不包含命名范围。

```
=SUM(IF(MOD(COLUMN(A2:S31),2)=0,IF(A2:S31=2,1,0))) 
```

此示例计算 2 的数量。

这需要使用 进行数组输入`ctrl-shift-enter`。这是基于您在其他列中计数的事实，至少在您的示例中是这样。此外，尽管您提到列的高度不同，但看起来除了 S 之外的所有列的高度都相同。所以也许有办法解决这个问题。

# emacs - Emacs 中的 XHTML / JSF 样板代码

> ID：11065079
> 
> 赞同：2
> 
> 时间：2012-06-16T16:13:50.563
> 
> 标签：emacs, xhtml, nxhtml

我正在使用 Emacs 在 JSF 项目中编写 XHTML 页面，并且必须在每个 XHTML 文件的标题处使用的样板代码量难以键入、丑陋且容易出错。例如：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"> 
```

处理这个问题的“emacs方式”是什么？我已经阅读了有关[nXhtml 模式](http://ourcomments.org/Emacs/nXhtml/doc/nxhtml.html)的信息，但没有尝试过，也不知道它是否像上面那样自动完成样板文件，或者只是提供更多基本的 XML 检查/完成语法。无论如何，我想首先评估更轻量级的替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:13:34.567

搜索“模板 emacs”。 [https://www.google.com/search?q=template+engine+emacs](https://www.google.com/search?q=template+engine+emacs)

这是一个很好的调查：[http](http://www.emacswiki.org/emacs/CategoryTemplates) ://www.emacswiki.org/emacs/CategoryTemplates 。

我使用 defaultcontent.el，这是该页面上列出的选项之一。Defaultcontent.el 根据文件名上的模式匹配使用模板填充新文件。所有 .html 文件都可以获得特定的模板。您可以进行更高级的模板到文件的映射；defaultcontent.el 使用 alist，您可以为您喜欢的文件名指定任何正则表达式。

放入新文件的模板可以动态扩展各种内容，包括文件名、基本文件名、日期/时间、环境变量。在更高级的场景中，模板可以运行您提供的 elisp 代码。

它是 yasnippet 的好伴侣，我将它用于文件中的可选代码段。例如，我的基本 .htm 模板（由 defaultcontent.el 插入）不包含 jquery 的脚本引用。但是我有一个 jquery 的 yasnippet ，所以当我输入 (jquery[TAB]) 时，我得到了完整的扩展

```
<script type='text/javascript'
        src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js'>
</script> 
```

defaultcontent.el 使用 find-file-hooks 并仅在最初创建文件时插入模板内容。

我几乎将它用于所有文件格式。

# ruby-on-rails-3 - 在这种情况下如何摆脱 sql 注入

> ID：11065080
> 
> 赞同：0
> 
> 时间：2012-06-16T16:14:09.217
> 
> 标签：ruby-on-rails-3, mongoid, sql-injection

我的 RoR 3 应用程序中有这样的方法

```
 def buscar
    array = params[:query].split(' ')
    array.each_with_index  do |query, index|
      array[index] = array[index].gsub(/<\/?[^>]*>/, "").downcase
    end
    @noticias = Noticia.where(:tags.all => array).paginate(:page => params[:page])
  end 
```

我`brakeman`用来扫描任何问题，他说这个

`Possible SQL injection near line 116: Noticia.where(:tags.all => (params[:query].split(" ")))`

如何更改查询以消除此问题？哦，我正在使用 mongoid 提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:47:16.997

这是未经测试的，但是是这样的：

```
tag = params[:query].split(" ")
tag.each do |tag|
  @noticias << Noticias.find_by_tag(tag)
end
@noticias.paginate(:page => params[:page]) 
```

你可能不得不弄乱`<<`. 我不确定 paginate 在 @noticias 对象中寻找什么。

# python - 如何使用 EPD python 在 Ubuntu 12.04 中使用 FEniCS？

> ID：11065082
> 
> 赞同：1
> 
> 时间：2012-06-16T16:14:35.817
> 
> 标签：python, ubuntu-12.04, enthought

Ubuntu 12.04 存储库中的 FEniCS 不适用于[Enthought](http://fenicsproject.org/) [EPD](http://www.enthought.com/products/epd.php)，除非我使用 PYTHONPATH 做一些疯狂的事情，这通常会导致 EPD 使用 Ubuntu 存储库 python 模块而不是 EPD 模块。

然后，另一种方法是手动编译和安装所有[FEniCS 模块](http://fenicsproject.org/download/installation_from_source.html#installation-from-source)。这很麻烦，因为 FEniCS 需要 sudo 才能安装在正常的 EPD 目录 /usr/local/EPD 中。如果您使用 sudo，这意味着 PATH 环境变量不是来自 ~/.bashrc，因此它认为它正在使用本机 python，而不是 EPD。我尝试在 sudo 上使用 -i 选项，这也做了一些棘手的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T16:14:36.657

我设法解决了我自己的问题。我将要描述这种技术有很多问题，[在这里](https://bugs.launchpad.net/dolfin/+bug/1013466)和[这里](https://answers.launchpad.net/ubuntu/+source/fenics/+question/199888)都有详细介绍。由于我不明白的原因，重新安装 Ubuntu 解决了链接中描述的问题，但这超出了我在这里试图涵盖的范围。可以说最好将 Ubuntu 与 / 和 /home 作为单独的分区安装，因为它使完全重新安装变得非常容易。

## 安装 FEniCS 以与 EPD 一起使用的程序

1.  [在此处](http://fenicsproject.org/download/installation_from_source.html#installation-from-source)下载所有软件包。创建目录 ~/.local/src/fenics 并将它们保存在那里。对该目录中的所有文件运行 tar -xvf。使用命令很容易做到这一点`for i in *.tar.gz; do tar -xvf $i; done`。
2.  首先安装 python 模块 FFC、FIAT、Instant、Viper 和 UFL，方法是进入它们的每个目录并运行`python setup.py install --user`. 用户标志使它们安装在 /.local/lib.. 中。这将被添加到 python 中的 sys.path 中。[您可以在此处](http://docs.python.org/install/index.html#alternate-installation-the-user-scheme)阅读有关 --user 标志的更多信息。
3.  然后导航到 dolfin 和 ufc 的目录，并在每个目录中运行以下命令：`cmake -DCMAKE_INSTALL_PREFIX=~/.local .`, `make`, `make install`.
4.  最后，`source /home/chad/.local/share/dolfin/dolfin.conf`如果您想使用功能强大的文本编辑器，请使用 gedit 或 emacs 添加到 ~/.bashrc。

编辑您还必须使用安装[ScientificPython](https://sourcesup.renater.fr/frs/?group_id=180&release_id=1351#stable-releases-2-8-title-content)`python setup.py install --user`，这是相对轻松的。
编辑

这应该可以让您启动并运行 ~/.local/share/dolfin/demo/pde/poisson/python 中的演示。我希望这可以帮助别人。

# jquery - 如何使用 jQuery 拆分或迭代交错的纯文本和 HTML 内联标记？

> ID：11065084
> 
> 赞同：1
> 
> 时间：2012-06-16T16:14:53.630
> 
> 标签：jquery, html, markup

我正在处理一些第 3 方 HTML，它是半结构化的标记文本（粗体、斜体等）。

这是结构的简化示例：

```
<div>
  <strong class="term">one</strong>
  -
  <b class="defs">
    foo        
    <i class="pos">verb</i>
    bar
    <i class="pos">noun</i>
    baz
    <i class="pos">adjective</i>
    blah
  </b>
  <br>
  <strong class="term">two</strong>
  ... etc ...
</div> 
```

事实上，我已经对其进行了一些处理以使其成为这种形状。我可以处理 HTML 元素，**但我无法弄清楚如何处理交错的文本和`<i>`元素。**

我对一个解决方案感到满意，该解决方案要么在`<i>`s 周围拆分“defs”，一个迭代各个部分的解决方案等。由于特定于浏览器的怪癖，我不希望混合使用 jQuery 和“原始”DOM API 调用，但是我明白如果我不能避免它。从我的浅薄知识看来，jQuery 对标记文本的支持不如对“结构”HTML 的支持...

我错过了一些明显的东西吗？这似乎很难搜索...

* * *

事实证明，在现实世界的数据中，文本运行和`<i>`节点总是交错的，但其中的第一件事`defs`可能是任何一个，每个文本运行可以包含一个或多个实际文本节点。这意味着`<i>`s 和 text 运行不是成对的。

好的解决方案可能是为每个文本运行添加标记，或者进行迭代，为每个文本运行做一件事，`<i>`为每个文本运行做另一件事。我在想`jQuery.contents()`一些节点类型检查必须是关键......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T16:41:08.850

您可以执行以下操作将所有文本检索到数组中

```
$(function(){
  var json = $('.defs').contents().map(function(){
     var text = $.trim($(this).text()); 
     return  text != "" ? text : null;
  });

  console.log(json);
});​ 
```

**演示：http:** [//jsfiddle.net/joycse06/Z5AgL/](http://jsfiddle.net/joycse06/Z5AgL/)

上面的代码为您提供了所有的列表`defs`以及 textnode 和`i`.

**更新**

`this.nodeName`是的，您可以使用 map 函数或在 map 函数内部进行节点类型或名称检查`this.nodeType`。`nodeType`因为`textnode`是`3`。例如在里面添加它`.map()`并检查

```
console.log(this.nodeName,this.nodeType); 
```

因此，对于这个特定的标记结构，您可以执行以下操作来检查它是否`<i>`是`textnode`

```
if(this.nodeName.toLowerCase() == 'i'){
    console.log('<i>');
    // do stuff for <i> here
}    
else{
    console.log('Text Node');            
    // it's text node
}  

// or with nodeType

if(this.nodeType == 3){
 // textNode
}else{
 // <i> 
} 
```

**演示**：http: [//jsfiddle.net/joycse06/Z5AgL/6/](http://jsfiddle.net/joycse06/Z5AgL/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T16:33:12.333

如果您的结构始终如您所见，您可以这样做：

```
var defs = [];
var def = null;
var tokens = $('.defs').text().split('\n');
for (var i=0; i<tokens.length; i++) {
    if (tokens[i].trim().length>0) {
        if (def==null) {
            def = {name:tokens[i]};
        } else {
            def.value = tokens[i];
            defs.push(def);
            def = null;
        }
    }
};
console.log(defs); 
```

当然，你必须增加保护，或者丰富，这取决于你有什么，但你会得到你可以做的那种操作的精神。

另一种解决方案是让所有部分都用斜体（带有）并在（最后提取的对之后的第`$('.pos')`一个位置）中寻找它们的第一个位置。`$('.defs').text()`

# api - 用于监控/修改投资组合的谷歌金融 API 替代方案？

> ID：11065088
> 
> 赞同：0
> 
> 时间：2012-06-16T16:15:07.337
> 
> 标签：api, finance, google-finance, google-finance-api

我曾经使用谷歌金融来创建投资组合/更改它们，然后将它们显示在我的网站上，但自从它被删除后，我想知道是否有任何好的免费替代品？

基本上，我有一个程序可以根据不同的因素（现在有 20 个）创建不同的投资组合，所以我网站上的 20 个链接中的每一个都将人们引导到显示投资组合的页面。我正在寻找可以用来自动更新投资组合的东西。

如果有帮助，我的网站基本上是一个免费的教程网站，可以帮助人们学习如何管理自己的投资组合。有不同的课程，然后使用市场数据和新闻（我已经得到）我自动生成一个示例投资组合，向他们展示一切是如何结合在一起的。我喜欢谷歌金融，因为他们可以看到谷歌的所有数据，但如果他们愿意，他们也可以点击并深入挖掘。

有什么我可以用来得到这个结果的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T16:51:27.157

我不确定我是否完全理解您想要什么，但听起来@DirkEddelbuettel 的[BeanCounter](http://dirk.eddelbuettel.com/code/beancounter.html)会满足您的需求。

或者，如果您只是在寻找报价，请参阅[http://www.gummy-stuff.org/Yahoo-data.htm](http://www.gummy-stuff.org/Yahoo-data.htm)和[http://developer.yahoo.com/yql/](http://developer.yahoo.com/yql/)

# c# - 如何使用 C# 定义结构元素？

> ID：11065094
> 
> 赞同：0
> 
> 时间：2012-06-16T16:15:43.993
> 
> 标签：c#, image-processing, aforge

我需要定义一个掩码大小为 30 x 105 像素的结构元素。我的意思是我已经为 3x3 的正方形硬编码了一个结构元素，但是对于 30x105 的结构元素，有没有一种特殊的方法可以做而不是硬编码呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:52:06.877

多维数组？

```
object[,] myArray = new object[30,105];
myArray[0,0] = 1; 
```

当然，您可以使用自己的类而不是对象。

[http://msdn.microsoft.com/en-us/library/2yd9wwz4(VS.71).aspx](http://msdn.microsoft.com/en-us/library/2yd9wwz4(VS.71).aspx)

# java - Android图形布局eclipse

> ID：11065095
> 
> 赞同：0
> 
> 时间：2012-06-16T16:15:52.450
> 
> 标签：java, android, xml, eclipse, user-interface

我一直在尝试通过 eclipse 上的图形布局访问以查看我的 xml，它给了我这个错误：

```
java.lang.NullPointerException
    at com.android.ide.eclipse.adt.internal.editors.layout.configuration.ConfigurationComposite.updateThemes(ConfigurationComposite.java:1491)
    at com.android.ide.eclipse.adt.internal.editors.layout.configuration.ConfigurationComposite.onRenderingTargetChange(ConfigurationComposite.java:2183)
    at com.android.ide.eclipse.adt.internal.editors.layout.configuration.ConfigurationComposite.access$4(ConfigurationComposite.java:2162)
    at com.android.ide.eclipse.adt.internal.editors.layout.configuration.ConfigurationComposite$2.widgetSelected(ConfigurationComposite.java:443)
    at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:240)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4128)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1457)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1480)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1465)
    at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1270)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3974)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3613)
    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2696)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2660)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2494)
    at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:674)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:667)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1410) 
```

它只是在我重新启动 Eclipse 时才开始的。我在谷歌等上没有找到任何东西。在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:07:49.900

创建尽可能小的 HelloAndroid 并查看是否可以查看布局的 XML。我猜您安装的 Eclipse/ADT 已经出现问题，您可能需要重新安装。

# jquery - 在 jquery 中滚动过去锚点时更改固定 div 的内容

> ID：11065096
> 
> 赞同：0
> 
> 时间：2012-06-16T16:16:07.467
> 
> 标签：jquery

我有一个两列站点布局，其中左列的内容是绝对的，右列中的 div 是固定的。我正在尝试获取它，以便当我向下滚动页面并且固定 div 框滚动经过锚点（左侧）时，固定 div 的内容将发生变化（将附加图像）。

到目前为止，我拥有的非常松散的编织 jquery 是这样的：

```
(function ($) {
  $(document).ready(function () {  
    var anchor = $("")
    var code = 
    $(window).scroll(function (event) {
      var y = $(this).scrollTop();
      if (y >= anchor) {
        $('#theDiv').append('<img id="livecodeimg" src="' + code +'.png" />')
      } else {
        $("#test img:last-child").remove()
      }
    });
  });
})(jQuery); 
```

我无法弄清楚如何制作变量...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T16:43:51.250

您需要遍历每个 a 标签并检查是否已在滚动中传递它。

```
(function ($) {
    $(document).ready(function () {
        var anchor = $("")
        var code = 
        $(window).scroll(function (event) {
            var y = $(this).scrollTop();
            $('a').each(function() {
                if (y >= $(this).offset.top) {
                    $('#theDiv').append('<img id="livecodeimg" src="' + code +'.png" />')
                } else {
                    $("#test img:last-child").remove()
                }
            });
        });
    });
}) 
```

希望这可以帮助。

# android - 选择 ListView 中的所有项目

> ID：11065098
> 
> 赞同：9
> 
> 时间：2012-06-16T16:16:35.753
> 
> 标签：android, listview

我目前正在开发一个 Android 项目。我正在使用 ListView 并使用上下文操作栏，并且我成功地选择了每个项目并显示了在列表视图中选择了多少项目的计数。

在上下文栏中，我有一个菜单选项，`Select All`但我不知道如何确保选择列表视图中的每个项目。

我似乎在 Google 上找不到任何东西，任何关于这种类型的东西和可选择的 ListViews 似乎都被很好地隐藏了。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-16T16:31:17.687

您可以一一查看列表视图项目：

```
for ( int i=0; i < listview.getAdapter().getCount(); i++) {
   listview.setItemChecked(i, true);
} 
```

如果您只想选择屏幕上的内容，请使用`listview.getChildCount()`.

如果您使用的是片段，则需要使用`getListAdapter().getCount()`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-16T17:48:43.857

在 android 中，listview 项目布局有许多不同的默认布局用于选择列表项目。您可以使用默认布局，也可以为列表项创建自己的布局。您可以使用

> Android.R.Layout.simple_list_item_multiple_choice

从列表视图中选择多个列表项。有关更多参考，请参阅此[链接](http://developer.android.com/reference/android/R.layout.html)

# python - 终端上带有-e选项的python后台进程

> ID：11065100
> 
> 赞同：1
> 
> 时间：2012-06-16T16:16:51.120
> 
> 标签：python, unix, subprocess, background-process

我想编写一个基于控制台的包装器来启动程序，除非我尝试使用 'urxvt -e myscript' 或某些变体来运行它，否则它工作正常。例如：

测试.py

```
#!/usr/bin/python2.7
import subprocess

print 'Press enter to launch'
raw_input()

subprocess.Popen( ['firefox'] ) 
```

如果我在带有 ./test.py 的终端中运行它，它会按预期工作。Firefox 启动，脚本存在。但是，如果我使用 'urxvt -e ./test.py' 尝试此操作，脚本将打开、运行并启动 firefox。但是当脚本退出时，firefox 被杀死了。

如果我使用“term -e script”运行脚本，如何启动一个程序以便在脚本退出时它不会被杀死。

编辑：更清楚一点：我想启动一个运行 python 脚本的新终端。脚本做它的事情并启动程序。然后脚本退出，终端关闭，程序继续运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:39:05.560

将 & 符号 (&) 添加到您启动的命令中。

```
subprocess.Popen( ['firefox &'] ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T00:55:22.170

在测试时，我发现结果高度依赖于要启动的程序，问题与 python 无关。我从未注意到它，但“term -e program”仅适用于某些程序，其他程序以我得到的行为退出。有些程序不保留继承的 pid/sid，而其他程序则保留。

例如

```
>>> print os.getpid()
3556
>>> os.execl( '/usr/bin/gvim', 'gvim' ) 
```

一个快速的“ps -e”显示

```
3556 pts/1    00:00:00 gvim <defunct>
3557 ?        00:00:00 gvim 
```

当启动终端关闭时，所有具有相同 sid 的进程都会关闭。所以'gvim defunct'消失了，但另一个仍然存在。未获得新 pid/sid 的程序将在启动终端关闭时退出。解决方案是在该过程中强制使用新的 sid。

```
import os

if os.fork():
    # parent
    do_stuff()

else:
    # child
    os.setsid()
    os.execl('prog', 'prog') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T16:37:10.697

```
import os

print 'Press enter to launch'
raw_input()

if os.fork():
    # Parent
    print 'clean up'
    raw_input()

else:
    # Child
    os.execl('/usr/bin/firefox', 'firefox') 
```

[os.execl](http://docs.python.org/library/os.html#os.execl)将 python 进程替换为 firefox 进程。

如您所述，使用 subprocess.Popen，当脚本结束时，firefox 子进程将被终止。

使用`os.execl`，脚本本身不会结束。它被替换为不会（立即）结束（并且不会被杀死）的 firefox 进程。到达`os.execl`命令后，它的行为就像您调用了`term -e firefox`.

# android - EditText 不保存输入

> ID：11065103
> 
> 赞同：0
> 
> 时间：2012-06-16T16:17:08.423
> 
> 标签：android, android-edittext

我是 android 新手，正在编写一个简单的应用程序来计算击球后到洞的距离。一切运行都没有错误或警告，但我似乎无法将 editText 值存储在变量中。我究竟做错了什么？代码中的注释是我尝试过的其他事情。谢谢您的帮助。

```
package my.pckg.ezgolf;

import android.app.Activity;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnKeyListener;
import android.widget.EditText;
import android.widget.TextView;

public class EZGolfActivity extends Activity {
    /** Called when the activity is first created. */
    int hole_length;
    int shot_length;
    int dist_remain;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        int dist_remain = hole_length - shot_length;

    final EditText edittext = (EditText) findViewById(R.id.editText1);
    edittext.setOnKeyListener(new OnKeyListener() {
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // If the event is a key-down event on the "enter" button
            if ((event.getAction() == KeyEvent.ACTION_DOWN) &&
                (keyCode == KeyEvent.KEYCODE_ENTER)) {
              // Perform action on key press
              //Toast.makeText(EZGolfActivity.this, edittext.getText(), Toast.LENGTH_SHORT).show();
                hole_length = Integer.parseInt(edittext.getText().toString());

              return true;
            }
            return false;}               

            TextView myTextView = (TextView) findViewById(R.id.textView4); 
            myTextView.setText("You have this many feet to the pin: " + dist_remain);

    });

    final EditText edittext2 = (EditText) findViewById(R.id.editText2);
    edittext.setOnKeyListener(new OnKeyListener() {
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // If the event is a key-down event on the "enter" button
            if ((event.getAction() == KeyEvent.ACTION_DOWN) &&
                (keyCode == KeyEvent.KEYCODE_ENTER)) {
              // Perform action on key press
              //Toast.makeText(EZGolfActivity.this, edittext.getText(), Toast.LENGTH_SHORT).show();
                shot_length = Integer.parseInt(edittext2.getText().toString());
              return true;
            }
            return false;}

            //TextView myTextView = (TextView) findViewById(R.id.textView4); 
            //myTextView.setText("You have this many feet to the pin: " + dist_remain); 

        //int dist_remain = hole_length - shot_length;

        TextView myTextView = (TextView) findViewById(R.id.textView4); 
        myTextView.setText("You have this many feet to the pin: " + dist_remain); 

});

    //int dist_remain = hole_length - shot_length;

    //TextView myTextView = (TextView) findViewById(R.id.textView4); myTextView.setText("You have this many feet to the pin: " + dist_remain);

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:23:49.573

似乎，您的计算和 myTextView 的更新仅在 Activity 初始化时调用一次。您必须移动计算并将 myTextView.setText 调用到 KeyListeners 中。这是未经测试的，但我认为，这会奏效。至少应该修复语法错误。如您所见，每次按下回车按钮时都会完成计算，然后才会更新文本视图。

```
public class EZGolfActivity extends Activity {
    /** Called when the activity is first created. */
    int hole_length;
    int shot_length;
    int dist_remain;

    TextView myTextView = (TextView) findViewById(R.id.textView4);

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        final EditText edittext = (EditText) findViewById(R.id.editText1);
        edittext.setOnKeyListener(new OnKeyListener() {
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                // If the event is a key-down event on the "enter" button
                if ((event.getAction() == KeyEvent.ACTION_DOWN) && (keyCode == KeyEvent.KEYCODE_ENTER)) {
                    // Perform action on key press
                    // Toast.makeText(EZGolfActivity.this, edittext.getText(), Toast.LENGTH_SHORT).show();
                    hole_length = Integer.parseInt(edittext.getText().toString());
                    int dist_remain = hole_length - shot_length;
                    myTextView.setText("You have this many feet to the pin: " + dist_remain);
                    return true;
                }
                return false;
            }
        });

        final EditText edittext2 = (EditText) findViewById(R.id.editText2);
        edittext.setOnKeyListener(new OnKeyListener() {
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                // If the event is a key-down event on the "enter" button
                if ((event.getAction() == KeyEvent.ACTION_DOWN) && (keyCode == KeyEvent.KEYCODE_ENTER)) {
                    // Perform action on key press
                    // Toast.makeText(EZGolfActivity.this, edittext.getText(), Toast.LENGTH_SHORT).show();
                    shot_length = Integer.parseInt(edittext2.getText().toString());
                    int dist_remain = hole_length - shot_length;
                    myTextView.setText("You have this many feet to the pin: " + dist_remain);
                    return true;
                }
                return false;
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:22:06.583

我有一点不大

你已经为 edittext 设置了 setOnKeyListener

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T16:26:43.430

我认为您不想使用 getInteger。使用 parseInt，您走上了一条更好的道路：

[为什么 int num = Integer.getInteger("123") 会抛出 NullPointerException？](https://stackoverflow.com/questions/3123349/why-does-int-num-integer-getinteger123-throw-nullpointerexception)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-18T14:20:21.010

您可以尝试使用`addTextChangedListener`EditText 的方法。

```
 EditText txt_value = (EditText) findViewById(R.id.txt_value);
 txt_value.addTextChangedListener(new TextWatcher() 
    {
        public void  afterTextChanged (Editable s)
        {
            //Log.d("after", "afterTextChanged");
        }
        public void  beforeTextChanged  (CharSequence s, int start, int count, int after)
        {
            //Log.d("before", "beforeTextChanged");
        }
        public void onTextChanged(CharSequence s, int start, int before, int count) 
        {
            txt_value.removeTextChangedListener(this);
            String textValue = s.toString();
            int intValue = Integer.parseInt(textValue);
        }
    }); 
```

# apache - 通过cgi运行脚本后如何在apache上重定向

> ID：11065108
> 
> 赞同：1
> 
> 时间：2012-06-16T16:17:40.573
> 
> 标签：apache, redirect

我有一台安装了 apache 的 ubuntu 机器。我想使用网页通过 cgi 运行一些简单的 shell 脚本，然后回到我的主屏幕。我还希望自动返回步骤。我在我的 apache.conf 中设置了一个重定向，它工作正常，但脚本根本没有运行。

有没有办法运行脚本然后才应用重定向？

评论：
我认为[这](http://www.unix.com/shell-programming-scripting/109937-how-redirect-web-page-shell-script.html)可能是答案，但我不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T09:30:22.707

你不能让你的cgi脚本输出这样的东西吗？

```
<META HTTP-EQUIV=Refresh CONTENT="0; URL=http://www.your-home-page.com/"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T09:12:31.007

**我猜您的 apache 在执行之前**会将访问重定向到您的 cgi 脚本。

您将需要在您的 cgi 脚本中进行重定向。有两种可能的方式：

1.  如您链接的示例中所示，输出带有元重定向的简单 html 页面。这将告诉浏览器加载新站点。
2.  让您编写脚本输出一个 http 重定向标头。这也将告诉网络浏览器加载新站点。这是 perl 中的一个示例：

    ```
    #!/usr/bin/perl
    use CGI;
    my $c = CGI->new();

    print $c->redirect("http://yoursite"); 
    ```

    如果您在控制台调用此脚本，它将输出以下内容：

    ```
    Status: 302 Found
    Location: http://yoursite 
    ```

使用 perl CGI 模块之类的帮助模块最容易生成此标头。但是你也可以直接打印出上面的行。

如果您想从网页调用 shell 脚本，您也可以使用服务器端包含，或者如果您使用例如 php，则使用*system()*或*exec()*从您的 php 页面调用您的脚本。

最后提醒一句：通过 cgi 或 php 中的系统调用从 apache 执行脚本并不是一个非常优雅的解决方案，原因如下

*   安全性：用户可能能够让脚本做你不想要的事情（寻找“命令注入”）
*   性能：您的 linux 系统将在每次 cgi 或系统调用时创建一个新进程。在加载的站点上，这可能会导致性能下降。

在不知道您要解决的问题的情况下，很难给出更详细的建议。如果您想要某种形式的用户身份验证，请查找 htaccess-mechanism。否则，编写一个 php 脚本，它在被浏览器调用时执行所有处理，完成后也可能重定向到另一个页面。

# jquery - JQuery 远程验证器总是返回 false

> ID：11065109
> 
> 赞同：1
> 
> 时间：2012-06-16T16:17:51.703
> 
> 标签：jquery, asp.net-mvc-3, validation, jquery-validate

我有一个包含 ZipCode 字段的页面，我需要在服务器上进行验证。加载页面时，ZipCode 必须已经从某个外部源预填充。

我添加了一个 jquery 远程验证器来验证这个字段： $(document).ready(function () {

```
 $("#Buyer_ZipCode").rules("add", {
        remote: { url: zipcodeValidationUrl, async: false },
        messages:
           {
               remote: "Cannot determine location for given zip code."
           }
    });

    var zipcode = $("#Buyer_ZipCode");
    if (zipcode.val().length > 0) {
        zipcode.trigger('blur');
    };

}); 
```

为了在页面加载后立即执行操作，我添加了一个模糊触发器。我的模糊处理程序：

```
$("#Buyer_ZipCode").bind('blur', function (e) {       

    //some actions

    element = $(e.target);        
    if (!element.valid()) {
        console.log(element.val());
        // Invalidate lookup target control.
        targetCity.get(0).value = "";
        targetState.get(0).value = "";
        return;
    };

 // yet some actions

}); 
```

一切正常，除了页面加载的情况，我们已经有了 ZipCode 字段的值。在这种情况下，valid() 方法总是返回 false，但是远程验证不是异步的，服务器*确实*返回 true。顺便说一句，这是我的验证控制器

```
 public JsonResult IsZipCodeValid([NestedFieldModelBinder]string Buyer_ZipCode)
    {
        if (Utils.GetZipcode(Buyer_ZipCode) != null)
        {
            return Json(true, JsonRequestBehavior.AllowGet);
        }

        return Json("Cannot determine location for given zip code.", JsonRequestBehavior.AllowGet);
    } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:40:22.127

[您会发现使用RemoteAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.remoteattribute%28v=vs.98%29.aspx)更加简单和简洁。

在您的视图模型中，将 Remote[] 属性添加到您的 Buyer_ZipCode 属性

```
[Remote("ValidateZipCode", HttpMethod="Post", ErrorMessage = "Cannot determine location for given zip code.")]
public string Buyer_ZipCode{ get; set; } 
```

以及您的验证操作：

```
[HttpPost]
public ActionResult ValidateZipCode(string Buyer_ZipCode)
{
    // do your validation
    return Json(true);
} 
```

问候

# css - 在 iPad 和 Android 上滚动 DIV

> ID：11065114
> 
> 赞同：1
> 
> 时间：2012-06-16T16:18:05.760
> 
> 标签：css, ipad, html, overflow

好的，我正在努力思考究竟是什么让 div 可滚动，以及是什么扼杀了 iPad 和 Android 上的可滚动功能（所以我猜是任何移动 webkit）。

假设我有这样的结构：

```
<div id="wrapper">
 <div id="inner">
  <div class="dynamic_content"></div>
 </div>
</div> 
```

所以至少我会设置**溢出：自动；**在**#wrapper**上。

我还从阅读here中看到**#wrapper**应该有固定的尺寸（所以假设固定的高度和宽度）。

#inner或**.dynamic_content** div 呢**？**有什么特别的（CSS）吗？

 **如果当用户调整浏览器大小时我有 javascript 调整**#wrapper**大小怎么办- 这会影响什么吗？

我问这个是因为我有一些使用类似于上面解释过的 DOM 的东西，它们在 iPad 上滚动得很好，而其他的不滚动，我不知道还有什么可能会影响功能。

所以一般的问题是，是否有一套规则可以让滚动工作，第二个问题是哪些其他力量会影响和/或破坏它？

谢谢。**

# wordpress - 如何在档案页面内显示来自 2 个类别（同时）的帖子

> ID：11065116
> 
> 赞同：0
> 
> 时间：2012-06-16T16:18:20.230
> 
> 标签：wordpress, categories

嗨，我在档案页面中有一些链接，我想过滤内容如何创建一个链接来给我仅来自类别 A 和类别 B 的帖子。我的工作示例是这个[http://myurl.com/?cat=39,38,-37,-29,-36,-4,-11,-6,-27,-30](http://myurl.com/?cat=39,38,-37,-29,-36,-4,-11,-6,-27,-30) 但它不是我想要的 seo 友好像这样[http://myurl.com/?cat=39and38](http://myurl.com/?cat=39and38)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T20:08:11.810

最好的方法是创建和使用自定义页面模板：[http ://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

接下来在自定义页面模板中，创建一个您想要使用的循环`query_posts()`： http: [//codex.wordpress.org/Function_Reference/query_posts](http://codex.wordpress.org/Function_Reference/query_posts)

这两个链接都是一个很好的起点。

回到你的问题：我认为[http://myurl.com/?cat=39&cat=38](http://myurl.com/?cat=39&cat=38)会工作，你试过了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T17:24:49.097

你可以简单地做 [http://myurl.com/?cat=39,38](http://myurl.com/?cat=39,38) 只有昏迷，它适用于我

对你来说可能有点晚了，但它可以帮助别人

# python - BeagleBone 和 Python 的蓝牙串行问题

> ID：11065117
> 
> 赞同：3
> 
> 时间：2012-06-16T16:18:22.140
> 
> 标签：python, bluetooth, serial-port

我正在尝试在 BeagleBone 和我的笔记本电脑之间建立串行连接。这类似于我之前在 Arduino 和笔记本电脑上成功使用的设置。问题是，虽然机器之间显然有信号传递，但输出似乎已损坏。

BB 连接到 TX 和 RX 线上的 Bluesmirf Silver。

我用 Python 编写了一个类来处理串行通信。这在 BB 和 Arduino 之间进行通信时效果很好，所以我非常确信我已经处理了引脚、多路复用器模式等的设置。

但是相同的代码在通过 Bluesmirf 时无法工作。一切都设置为 19200 波特 8-N-1，从 BB 发送到笔记本电脑的文本以一系列 0xE0 字符的形式到达。更改波特率（是的，我很小心地在两端更改它）可以改变笔记本电脑上显示的内容 - 有时什么都无法通过，有时它显然是随机的。但是，大多数情况下，字节似乎具有很高的价值。在 19200 处，显示的字节数比发送的字符数多两个或三个字节。

使用 Serial()（即 PySerial）将 self.serPort 定义为串行端口后，我使用以下内容发送文本（作为字符串“sendStr”传递）：

```
self.serPort.write(sendStr.encode('utf-8', 'replace')) 
```

我试过使用'ascii'而不是'utf-8'

在同一个程序中，我以相同的方式将相同的字符串发送到 Arduino，Arduino 将其回显，并且在那里一切正常。只是通过 Bluesmirf 的东西让我很伤心。

（作为记录，在笔记本电脑 MacBook Pro 上，我使用 CoolTerm 进行发送和接收。在我之前的设置中，Arduino 通过 Bluesmirf 与笔记本电脑通信，笔记本电脑正在运行处理草图。我试过了与 BB 设置相同的草图，但仍然没有乐趣）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T04:31:14.673

好吧，您的问题似乎是由于您省略了配置 BlueSMIRF 模块本身的事实。实际上，您在计算机端指定的波特率并不重要，因为您可以使用任何波特率，并且不必与 BeagleBone 上使用的相同（尽管如果它高于波特率率，如果您不够小心，可能会出现缓冲区溢出错误）。

另一方面，需要配置 Blue 模块，使其本地 UART 接口（链接到 BeagleBone）的波特率与后者相同。为此，请参阅 Roving Network 用户手册中的命令指南（当前可在[此处](http://www.sparkfun.com/datasheets/Wireless/Bluetooth/rn-bluetooth-um.pdf)找到）。根据数据表，您需要：

(1) 进入命令模式（在开机后的前 60 秒内执行此操作，您可以从 PC 远程执行所有配置到蓝牙模块）：

`$$$`（请勿发送 ASCII 13 和 10 个字符）

(2) 发送命令：

`SU,19`（按 ENTER，即发送 ASCII 13 和 10 个字符）

这会将 BlueSMIRF 上的 RN-42 模块设置为 19200 波特，与 BeagleBone 相同。您应该停止看到您看到的错误（从我可以从您的评论中推断，这可能是由于 BlueSMIRF 波特率设置为 57.6 K）。

请注意，模块配置完成后需要重新设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T18:38:47.807

你是如何通过USB连接蓝牙的？您必须使用如下代码：

```
import serial as s
device = "/dev/tty01"
s.Serial(device, 4800) 
```

BBB中的USB接口叫什么名字？或者你是如何在 BBB 中列出 USB 端口的？

# javascript - RequireJS / AMD 模块中的 JavaScript 代码覆盖率

> ID：11065119
> 
> 赞同：8
> 
> 时间：2012-06-16T16:18:32.247
> 
> 标签：javascript, unit-testing, code-coverage, requirejs, js-amd

简短而看似愚蠢的问题，因为如此简单而且您会认为无处不在：是否有人获得了任何类型的代码覆盖以在 RequireJS 前端项目（非 NodeJS）中工作？

由于 JS 世界中 TDD 方法的流行以及 AMD 开发的接管，这似乎是一个愚蠢的问题。

我已经尝试了一百万种方法，都缺乏。我的项目是一个带有 Jasmine 单元测试的 Backbone 项目：

1) 带有 Coverage 插件的 JSTD。JSTD 无法正确加载和检测 AMD 模块。如果我在单个 js 文件（由 RequireJS 优化器组合）上运行 JSTD，那么代码覆盖率会很好地工作，除非随后收集覆盖率并在整个文件上定义指标。太好了，那没用，因为它包括 3rd 方库，而且我不能针对单个单元来帮助测试开发。啊。

2) JSCoverage - 完全失败，不喜欢 AMD 模块。

3) Chrome 特定和 Firebug 特定的“实时”仪器 - 失败，不喜欢 AMD 模块。

我尝试的每一种方法似乎都需要大量的定制工作。所以也许我需要从头开始定制解决方案？

下面的方法怎么样：扩展 RequireJS 优化器以检测代码并创建覆盖。这将是内存检测，可以使用 require.config({ instrument: true }) 标志启用。每次 require 加载一个模块时，它都会自动检测它并将其放置在其模块存储库中。覆盖率统计信息收集在全局 require 对象下的一个对象中，并且可以从任何地方访问，例如在 Jasmine 测试运行之后。

输入？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T17:35:00.460

[Blanket.js](http://blanketjs.org/)使用修改后的 RequireJS 加载器与 Qunit 一起工作。我们正在努力支持 Jasmine，并且很乐意接受任何反馈或建议。

如果您的项目要投入生产，Blanket.js 不适合您，但如果它只是一个副项目，那么它是否满足您的需求可能值得一看。

编辑：毯子现在支持茉莉花。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T14:59:11.150

事实证明，[Node-Coverage](https://github.com/piuccio/node-coverage)实际上提供了一个与 AMD 无关的接口，它与 RequireJS 和 Jasmine 一起工作得很好，通过提供要从自己的服务器检测的代码。

我仍然会花一些时间来研究我开始的 RequireJS 覆盖实现，因为它不需要运行单独的服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T14:23:32.407

AMD 模块和 JSCoverage 到底有什么问题？我有一个运行 AMD 模块的设置（QUnit/PhantomJS/JSCoverage）。

也许您只是忘记在您的 require.config 中正确设置您的库路径？

在我更改库路径以使用检测代码而不是“正常”文件后，一切正常。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-18T09:08:34.463

查看我最近发布的项目，以获得简单的 javascript 浏览器内覆盖率报告，JSCovReporter [https://github.com/TwoApart/JSCovReporter](https://github.com/TwoApart/JSCovReporter)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-22T08:50:54.280

**摩卡包装**

我刚刚编写了一个自动覆盖报告的节点模块。它基于 mocha、jscoverage 和 node 的 assert。您不必修改 require 或使用 make 或 enviornment 变量。

它托管在 github 上： [mochawrapper](https://github.com/haraldrudell/mochawrapper)

jscoverage 可能不在浏览器中运行，所以你可能想看看：基于 uglify-js 的[bunker](https://github.com/substack/node-bunker)

# javascript - 小自动滚动窗口

> ID：11065121
> 
> 赞同：0
> 
> 时间：2012-06-16T02:34:20.033
> 
> 标签：javascript

我想在站点的右下角应用一个全局站点范围的小 javascript 窗口，该窗口将显示一个大约 40 x 80 宽的窗口，只有一个书本图标和“圣经”一词，当一个人点击它时，它将打开一个弹出窗口，居中并拉出我给它的任何页面以显示圣经本身（我已经在内部拥有它）。当您向上或向下滚动页面时，这些小 javascript 窗口会自动滚动，您已经多次看到它们。

PS：我还想要一个“隐藏”选项，但它不会隐藏它，而是将其最小化为一个小图标，一直到网站的右下角。所以，点击它打开，点击它最小化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T05:32:09.117

您的解决方案在于 jquery www.jquery.com 有（字面上）数以千计的脚本，您一定会在那里找到您的解决方案。

# http - iptables 将 80 重定向到 8080 但阻止公共 8080 访问

> ID：11065124
> 
> 赞同：24
> 
> 时间：2012-06-16T16:19:10.017
> 
> 标签：http, redirect, port, iptables

我有一些`iptables`规则可以将端口 80 的请求重定向到我们的应用程序服务器（GlassFish）的端口 8080（以及 SSL 端口，但为简单起见，我将它们排除在外）。

虽然我们的工作正常（我个人对此没有问题），但如果有人希望在 url 中指定它，端口 8080 也对外界开放。已强制要求将 8080 端口关闭，禁止外界访问，仅开放 80 端口。

我不希望更改应用程序服务器上的侦听器（对于使用端口 80，这似乎需要为运行应用程序服务器的用户提升权限）并且端口 8080 上的侦听器需要知道数据包的源 IP 作为应用程序审核对应用程序的请求（即，我们不能将源 IP 地址更改为本地地址）。

当前`iptables`配置如下。有谁知道是否有办法阻止公共互联网上的 8080，同时保留从端口 80 重定向到的数据包中的源 IP？

提前谢谢了。

```
 iptables -P INPUT ACCEPT
    iptables -P OUTPUT ACCEPT
    iptables -P FORWARD DROP

    # allow establishment of connections initialised by my outgoing packets
    iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT

    # accept anything on localhost
    iptables -A INPUT -i lo -j ACCEPT

    ################################################################
    #individual ports tcp 
    ################################################################
    iptables -A INPUT -p tcp --dport 80 -j ACCEPT
    iptables -A INPUT -p tcp --dport 8080 -j ACCEPT

    #drop everything else
    iptables -A INPUT -j DROP

    ################################################################
    #Redirection Rules
    ################################################################
    # redirection rules (allowing forwarding from localhost)
    iptables -t nat -A OUTPUT -o lo -p tcp --dport 80 -j REDIRECT --to-port 8080

    # redirection http
    iptables -t nat -A PREROUTING -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8080 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-03T19:32:41.930

我发现实现此目的的一种方法是在 mangle 表的 PREROUTING 链中使用 MARK 目标。

添加规则以标记要阻止的数据包：

```
iptables -t mangle -A PREROUTING -p tcp --dport 8080 -j MARK --set-mark 1 
```

然后，在允许端口 8080 之前将其添加到 DROP 标记的数据包中：

```
iptables -A INPUT -m mark --mark 1 -j DROP 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T02:38:37.267

我以稍微不同的方式处理了这个问题。我将 443 转发到 3000（如上所述），但也将 3000 转发到 443。然后我允许 3000 上的流量，但在 443 上阻止它。过滤 443 流量时，应该只来自端口 3000。

我正在使用 ufw，因此使用该工具输入了过滤规则。我在`/etc/ufw/before.rules`.

```
iptables -t nat -A PREROUTING -p tcp -m tcp --dport 443 -j REDIRECT --to-ports 3000

iptables -t nat -A PREROUTING -p tcp -m tcp --dport 3000 -j REDIRECT --to-ports 443 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-24T03:42:44.827

我知道现在为时已晚，但我想出了另一个对大多数人来说可能更直接的解决方案。

只需将端口 8080 重定向到另一个关闭的端口（例如 3000）：

```
iptables -t nat -A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-ports 3000
iptables -A INPUT -p tcp --dport 3000 -j REJECT --reject-with tcp-reset 
```

然后，您可以在本地计算机的 8080 端口访问该应用程序，而 Internet 上的其他人可能只能看到端口 80 已打开。

# javascript - 在原型中使用对象参数

> ID：11065125
> 
> 赞同：0
> 
> 时间：2012-06-16T16:19:10.230
> 
> 标签：javascript, prototype

这可能吗？

```
function testObj(testArg) {
    //Do obj stuff here
}

testObj.prototype.addFn = function() {
    this.test = testArg;
} 
```

这将不起作用，因为原型无法使用原始对象参数，但是有没有一种方法可以访问它们而不必通过函数再次传递它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:21:31.243

```
function testObj() {
    // take a copy of the arguments
    this._args = [].slice.call(arguments, 0);

    // Do obj stuff here
}

testObj.prototype.addFn = function() {
    this.test = this._args[0];
} 
```

# c - 将整数指针分配给结构数组并且仍然执行代码？

> ID：11065135
> 
> 赞同：2
> 
> 时间：2012-06-16T16:21:14.317
> 
> 标签：c, pointers

我在教科书中看到了以下 C 代码片段，它工作正常......但我不明白输出以及为什么它工作正常，因为它看起来不对：

```
#include <stdio.h>

int main()
{

    struct {
        int x,y;
    } s[4] = {{10,20},{15,25},{8,75},{6,2}};
    int *i;
    i=s;

    clrscr();
    printf("\n%d",s[i[7]].x);
    printf("\n%d",i[i[1]-i[2]]);
    printf("\n%d",i[s[3].y]);
    printf("\n%d",(s+1)->x+5);
    printf("\n%d",s[i[0]-i[4]].y + 10);
    printf("\n%d",++i[i[6]]);
    getch();

    return 0;

} 
```

另外我不明白我们如何`s`在语句中分配一个整数指针

```
i=s; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T16:27:32.927

> 我也不明白我们如何在语句中为 s 分配一个整数指针：`i=s;`

这很简单，你不能在没有演员表的情况下使用 C 语言。你的编译器可以接受这样的程序，但其他编译器有权拒绝编译该程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T16:26:25.080

至于指针分配：

要从下面发表评论：

> “整数数组和仅由整数组成的结构数组的内存布局是相同的”

必须定义指针类型的原因是编译器必须知道指针**指向**的数据的**大小**。整数的大小为 4 个字节，而此结构的大小为 8 个字节。当程序试图访问 location 的内存时，编译器知道程序需要 8 个字节之后的数据，而 where只需要 4 个字节之后的数据。**`s[1]``s[0]``i[1]``i[0]`**

 **`s`是一个结构数组（有两个 int 类型的成员），`i`是一个指向 int 的指针。由于 的第一个元素`s`是 2 个整数的结构，`i = s`因此将 的第一个元素的第一个成员的地址分配`s`给`i`。

`i = &s[0]`是同一个任务。

如果`s[0]`从*0x00*开始，它的第一个成员的地址为*0x00*，而它的第二个成员的地址为*0x04*。`s[1]`将从*0x08*开始，该位置的结构具有地址为*0x0C*的第二个成员。

`i = s`其中,具有`i[0]`地址*0x00*，而`i[1]`具有地址*0x04*，即 的第一个元素的第二个成员`s`。`i[2]`具有地址*0x08*，数组中第二个结构的第一个成员，`i[3]`具有地址*0x0C*，数组中第二个结构的第二个成员。等等...

```
 { 10, 20 } { 15, 25 } { 8, 75 } { 6, 2 }
s:|    0    |     1    |    2    |   3   |
i:| 0 |  1  |  2 |  3  |  4 | 5  | 6 | 7 | 
```

`i`现在指向第一个整数（全部 8 个）。

`i[0] = 10`

`i[7] = 2`

第一个 printf 语句解释如下： 因为`i[7] = 2`, 那么我们`s[2]`指的`{8,75}`是具有 x 值的对`8`。

指针确实不兼容，使用 gcc 版本 4.4.3 (Ubuntu 4.4.3-4ubuntu5.1) 编译会产生以下***警告***：

> test.c：在函数'main'中：test.c：10：警告：来自不兼容的指针类型的赋值

但是，该程序会编译并生成输出：

> 8 75 15 20 85

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-19T05:09:46.653

补充一点：在 CI 中，当它出现这样的情况时，它会遵循技巧：每当你看到这样的 #type# s[p]，s 是 #type# 类型的指针，s[p] 是另一种写法* (s+p)。因此 ('i' 分配了数组的基地址) 例如 -- i[i[1]-i[2]] 是 i[(*(i+1)) - (*(i+2))] => i[20 - 15] => i[5] => *(i+5) => 75。

另请注意，

1) 内部填充可用于为结构分配存储空间。例如。具有两个 int 和一个 char 的结构不一定会连续占用 4+4+2 = 10 个字节，可能存在内部填充。然而，这个只有两个整数的结构不使用内部填充。

2) 由于大多数编译器分配了不兼容的指针，将给出警告。

3) 'i' 被分配了结构数组的基地址，没有内部填充，因此这个精心设计的代码可以神奇地工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T16:47:29.703

编译器将s[4]的数据存储在线性内存中，如10,20,15,25,8,75,6,2。i[7] 等于 2。这只是一个类似下面例子的技巧。

有这样的结构：

```
struct block{
int a;
int b;
};

struct block item; 
```

如果我知道 的地址`item->b`，我怎么知道 的地址`item`。

答案是使用`item->b`减号的地址`((struct block *)0)->b`。**

# python - py2app gui错误

> ID：11065137
> 
> 赞同：2
> 
> 时间：2012-06-16T16:21:29.933
> 
> 标签：python, user-interface, wxpython, py2app

我有一个非常简单的 gui 应用程序：http: [//pastebin.com/aVVTBJPd](http://pastebin.com/aVVTBJPd)

这是用 Python 和 wxPython 编写的。它在我的 Mac 上运行良好。

我尝试运行 py2app。这是我的确切步骤：

```
$ py2applet --make-setup gui.py
$ #returns "Wrote setup.py" (this appears to have been successful)
$ python setup.py py2app #this prints out A LOT of stuff in the terminal, also 
$ #seems to be working ok 
```

然后，我进入我的 dist 目录，双击 gui.app，立即收到 gui 错误。

![在此处输入图像描述](../Images/93f4b834b685df43f419fc4cf65f4c55.png)

这是控制台中出现的内容：

![在此处输入图像描述](../Images/ed8f53bd8070c1273d3ebf3faea5f39d.png)

我究竟做错了什么？

# c# - 在 Windows 启动时启动窗口

> ID：11065139
> 
> 赞同：8
> 
> 时间：2012-06-16T16:21:45.037
> 
> 标签：c#, wpf, startup

我希望我的应用程序（一个 WPF `Window`）在 Windows 启动时启动。我尝试了不同的解决方案，但似乎没有一个有效。我必须在我的代码中写什么来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-16T16:29:31.553

当您说必须向注册表添加密钥时，您是正确的。

将密钥添加到：

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run 
```

如果要为当前用户启动应用程序。

或者：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run 
```

如果您想为所有用户启动它。

例如，为当前用户启动应用程序：

```
var path = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Run";
RegistryKey key = Registry.CurrentUser.OpenSubKey(path, true);
key.SetValue("MyApplication", Application.ExecutablePath.ToString()); 
```

只需将第二行替换为

```
RegistryKey key = Registry.LocalMachine.OpenSubKey(path, true); 
```

如果您想在 Windows 启动时为所有用户自动启动应用程序。

如果您不想再自动启动应用程序，只需删除注册表值。

像这样：

```
var path = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Run";
RegistryKey key = Registry.CurrentUser.OpenSubKey(path, true);
key.DeleteValue("MyApplication", false); 
```

此示例代码已针对 WinForms 应用程序进行了测试。如果您需要确定 WPF 应用程序的可执行文件的路径，请尝试以下操作。

```
string path = System.Reflection.Assembly.GetExecutingAssembly().Location; 
```

只需将“Application.ExecutablePath.ToString()”替换为可执行文件的路径即可。

# java - JavaFX 2.1 TableView 刷新项

> ID：11065140
> 
> 赞同：65
> 
> 时间：2012-06-16T16:21:45.707
> 
> 标签：java, javafx, tableview, javafx-8, fxml

我有这个常见的问题，因为它似乎是。重置后，我的表格视图不会刷新我的项目。我检查了数据，它是新的。

**我从互联网尝试了多种解决方案，但没有成功。**

无法重置所有列，因为它增加了一个空的一个额外的（不知道为什么）并且调整大小只是中断。

我的表不可**编辑**。新数据已更改。

如果我**更改项目的顺序**并且行更改（：|），则会刷新数据。

我只是没有想法。

目前刷新代码非常简单。

```
ObservableList<User> data = FXCollections.observableArrayList(User.getResellers());
reseller_table.setItems(data); 
```

新数据再次正确。当我对 tableView 进行选择时，它会返回新的正确项目。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-09-27T03:45:16.117

解决方法：

```
 tableView.getColumns().get(0).setVisible(false);
 tableView.getColumns().get(0).setVisible(true); 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2016-09-23T22:37:13.157

由于`JavaFX 8u60`您可以使用（假设`tableView`是[TableView](https://docs.oracle.com/javase/8/javafx/api/javafx/scene/control/TableView.html)类的一个实例）：

```
tableView.refresh(); 
```

从文档中：

> 调用 refresh() 会强制 TableView 控件重新创建和重新填充填充控件视觉边界所需的单元格。换句话说，这会强制 TableView 更新它向用户显示的内容。这在底层数据源以 TableView 本身未观察到的方式发生更改的情况下很有用。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2012-10-04T22:56:46.543

我在刷新时遇到了类似的问题。我的解决方案是将 上的操作限制为`ObservableList`与`bind()`.

假设`ObservableList obsList`是`TableView`.

*然后*
`obsList.clear()`（继承自`java.util.List<>`）**不会正确更新**但是`TableView`。

**也**调用`setItem(obsList)`无法触发刷新......但是......

 **`obsList.removeAll(obsList)`（被 覆盖`ObservableList`）**工作正常**，因为它正确触发了 changeEvent。

用全新的内容重新填充列表然后工作如下：

*   `obsList.removeAll(obsList);`
*   `obsList.add(...); //e.g. in a loop...`

或者

*   `obsList.removeAll(obsList);`
*   `FXCollections.copy(obsList, someSourceList)`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-16T18:33:39.940

**更新：**
最后 tableview 刷新在**JavaFX 8u60**中得到解决，可用于早期访问。

* * *

关于刷新，请参阅[Tableview 中的更新行](https://stackoverflow.com/q/10912690/682495)。
关于空白列，请参阅[JavaFx 2 create TableView with single column](https://stackoverflow.com/q/11033404/682495)。基本上它不是一个列，即您无法选择单击此空白列项目的项目。它只是一个样式像行的空白区域。

* * *

**更新：**如果您要通过更新 tableView，`reseller_table.setItems(data)`则无需使用`SimpleStringProperty`. 如果您只更新一行/项目，这将很有用。这是刷新表数据的完整示例：

```
import java.util.ArrayList;
import java.util.List;
import javafx.application.Application;
import javafx.collections.FXCollections;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.Group;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;

public class Dddeb extends Application {

    public static class Product {
        private String name;
        private String code;

        public Product(String name, String code) {
            this.name = name;
            this.code = code;
        }

        public String getCode() {
            return code;
        }

        public void setCode(String code) {
            this.code = code;
        }

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }
    }

    private TableView<Product> productTable = new TableView<Product>();

    @Override
    public void start(Stage stage) {

        Button refreshBtn = new Button("Refresh table");
        refreshBtn.setOnAction(new EventHandler<ActionEvent>() {
            @Override
            public void handle(ActionEvent arg0) {
                // You can get the new data from DB
                List<Product> newProducts = new ArrayList<Product>();
                newProducts.add(new Product("new product A", "1201"));
                newProducts.add(new Product("new product B", "1202"));
                newProducts.add(new Product("new product C", "1203"));
                newProducts.add(new Product("new product D", "1244"));

                productTable.getItems().clear();
                productTable.getItems().addAll(newProducts);
                //productTable.setItems(FXCollections.observableArrayList(newProducts));
            }
        });

        TableColumn nameCol = new TableColumn("Name");
        nameCol.setMinWidth(100);
        nameCol.setCellValueFactory(new PropertyValueFactory<Product, String>("name"));

        TableColumn codeCol = new TableColumn("Code");
        codeCol.setCellValueFactory(new PropertyValueFactory<Product, String>("code"));

        productTable.getColumns().addAll(nameCol, codeCol);
        productTable.setColumnResizePolicy(TableView.CONSTRAINED_RESIZE_POLICY);

        // You can get the data from DB
        List<Product> products = new ArrayList<Product>();
        products.add(new Product("product A", "0001"));
        products.add(new Product("product B", "0002"));
        products.add(new Product("product C", "0003"));

        //productTable.getItems().addAll(products);
        productTable.setItems(FXCollections.observableArrayList(products));

        final VBox vbox = new VBox();
        vbox.setSpacing(5);
        vbox.getChildren().addAll(productTable, refreshBtn);

        Scene scene = new Scene(new Group());
        ((Group) scene.getRoot()).getChildren().addAll(vbox);
        stage.setScene(scene);
        stage.setWidth(300);
        stage.setHeight(500);
        stage.show();
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

注意

```
productTable.setItems(FXCollections.observableArrayList(newProducts)); 
```

和

```
productTable.getItems().clear();
productTable.getItems().addAll(newProducts); 
```

几乎是等价的。所以我第一次用这个来填充表格，刷新表格时使用另一个。它仅用于演示目的。我已经在 J​​avaFX 2.1 中测试过代码。最后，您可以（并且应该）编辑您的问题，通过在您的问题的答案中移动代码片段来改进它。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-07-24T05:42:13.320

我终于找到了一个丑陋的解决方法来刷新所有行。

```
void refreshTable() {
    final List<Item> items = tableView.getItems();
    if( items == null || items.size() == 0) return;

    final Item item = tableView.getItems().get(0);
    items.remove(0);
    Platform.runLater(new Runnable(){
        @Override
        public void run() {
            items.add(0, item);
        }
    });
 } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-10-22T15:13:27.413

oldItems.equals(newItems) 周围似乎有几个单独的问题

[RT-22463](https://javafx-jira.kenai.com/browse/RT-22463)的第一部分：即使调用 items.clear()，tableView 也不会更新

```
// refresh table 
table.getItems().clear();
table.setItems(listEqualToOld); 
```

那是固定的。在设置新列表之前清除旧项目会清除所有旧状态，从而刷新表。这不起作用的任何示例都可能是回归。

仍然不起作用的是在没有先清除的情况下重新设置项目

```
// refresh table
table.setItems(listEqualToOld); 
```

如果表格显示的属性未涉及到项目的平等决定（参见[RT-22463](https://javafx-jira.kenai.com/browse/RT-22463)或[Aubin 中的](http://pastebin.com/QKnvzXTd)示例）并且希望被[RT-39094覆盖，那将是一个问题](https://javafx-jira.kenai.com/browse/RT-39094)

**更新**：[RT-39094](https://javafx-jira.kenai.com/browse/RT-39094)后者也已修复，适用于 8u40！应该会在几周内冒泡进入 ea，推测 u12 之类的。

技术原因似乎是单元格实现中的相等检查：在实际调用 updateItem(T, boolean) 之前检查项目的更改是为了解决性能问题。合理，只是硬编码“更改” == old.equals(new) 在某些情况下会造成问题。

一个对我来说很好的解决方法（没有正式测试！）是一个自定义的 TableRow，如果需要身份检查，它会跳进去：

```
/**
 * Extended TableRow that updates its item if equal but not same.
 * Needs custom skin to update cells on invalidation of the 
 * item property.<p>
 * 
 * Looks ugly, as we have to let super doing its job and then
 * re-check the state. No way to hook anywhere else into super 
 * because all is private. <p>
 * 
 * Super might support a configuration option to check against
 * identity vs. against equality.<p>
 * 
 * Note that this is _not_ formally tested! Any execution paths calling
 * <code>updateItem(int)</code> other than through 
 * <code>indexedCell.updateIndex(int)</code> are not handled.
 * 
 * @author Jeanette Winzenburg, Berlin
 */
public class IdentityCheckingTableRow<T>  extends TableRow<T> {

    @Override
    public void updateIndex(int i) {
        int oldIndex = getIndex();
        T oldItem = getItem();
        boolean wasEmpty = isEmpty();
        super.updateIndex(i);
        updateItemIfNeeded(oldIndex, oldItem, wasEmpty);

    }

    /**
     * Here we try to guess whether super updateIndex didn't update the item if
     * it is equal to the old.
     * 
     * Strictly speaking, an implementation detail.
     * 
     * @param oldIndex cell's index before update
     * @param oldItem cell's item before update
     * @param wasEmpty cell's empty before update
     */
    protected void updateItemIfNeeded(int oldIndex, T oldItem, boolean wasEmpty) {
        // weed out the obvious
        if (oldIndex != getIndex()) return;
        if (oldItem == null || getItem() == null) return;
        if (wasEmpty != isEmpty()) return;
        // here both old and new != null, check whether the item had changed
        if (oldItem != getItem()) return;
        // unchanged, check if it should have been changed
        T listItem = getTableView().getItems().get(getIndex());
        // update if not same
        if (oldItem != listItem) {
            // doesn't help much because itemProperty doesn't fire
            // so we need the help of the skin: it must listen
            // to invalidation and force an update if 
            // its super wouldn't get a changeEvent
            updateItem(listItem, isEmpty());
        }
    }

    @Override
    protected Skin<?> createDefaultSkin() {
        return new TableRowSkinX<>(this);
    }

    public static class TableRowSkinX<T> extends TableRowSkin<T> {

        private WeakReference<T> oldItemRef;
        private InvalidationListener itemInvalidationListener;
        private WeakInvalidationListener weakItemInvalidationListener;
        /**
         * @param tableRow
         */
        public TableRowSkinX(TableRow<T> tableRow) {
            super(tableRow);
            oldItemRef = new WeakReference<>(tableRow.getItem());
            itemInvalidationListener = o -> {
                T newItem = ((ObservableValue<T>) o).getValue();
                T oldItem = oldItemRef != null ? oldItemRef.get() : null;
                oldItemRef = new WeakReference<>(newItem);
                if (oldItem != null && newItem != null && oldItem.equals(newItem)) {
                    forceCellUpdate();
                }
            };
            weakItemInvalidationListener = new WeakInvalidationListener(itemInvalidationListener);
            tableRow.itemProperty().addListener(weakItemInvalidationListener);
        }

        /**
         * Try to force cell update for equal (but not same) items.
         * C&P'ed code from TableRowSkinBase.
         */
        private void forceCellUpdate() {
            updateCells = true;
            getSkinnable().requestLayout();

            // update the index of all children cells (RT-29849).
            // Note that we do this after the TableRow item has been updated,
            // rather than when the TableRow index has changed (as this will be
            // before the row has updated its item). This will result in the
            // issue highlighted in RT-33602, where the table cell had the correct
            // item whilst the row had the old item.
            final int newIndex = getSkinnable().getIndex();
            for (int i = 0, max = cells.size(); i < max; i++) {
                cells.get(i).updateIndex(newIndex);
            }
       }

    }

    @SuppressWarnings("unused")
    private static final Logger LOG = Logger
            .getLogger(IdentityCheckingListCell.class.getName());

}

 // usage
 table.setRowFactory(p -> new IdentityCheckingTableRow()); 
```

请注意，TableCell 具有类似的硬编码相等性检查，因此如果自定义行不够，可能需要使用具有类似解决方法的自定义 TableCell（虽然没有遇到需要这样做的示例）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-22T23:55:00.473

我想[这个线程](https://forums.oracle.com/forums/thread.jspa?threadID=2382342)对表刷新问题有很好的描述。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-25T19:52:22.110

什么BUG！这是另一种解决方法...

```
public void forceRefresh() {
  final TableColumn< Prospect, ? > firstColumn = view.getColumns().get( 0 );
  firstColumn.setVisible( false );
  new Timer().schedule( new TimerTask() { @Override public void run() {
     Platform.runLater( new Runnable() { @Override public void run() {
        firstColumn.setVisible( true  ); }});
     }}, 100 );
} 
```

我已经做了一个[SSCCE](http://sscce.org/)来[显示这个错误](http://pastebin.com/QKnvzXTd)。我鼓励大家用另一种更优雅的方式来修复它，因为我的解决方法非常难看！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-23T09:23:51.880

我有一个用例，Aubin 的解决方案没有其他帮助。我调整了该方法并通过删除项目并将其添加到表的项目列表中进行了更改，因为它最终仅在此 hack 中可靠，列可见切换仅在第一次完成这项工作。

我也在 Jira 任务中报告了它： [https ://javafx-jira.kenai.com/browse/RT-22463](https://javafx-jira.kenai.com/browse/RT-22463)

```
 public <T> void tableItemsRefresh(final ObservableList<T> items) {

      if (items == null || items.size() == 0)
         return;

      int idx = items.size() -1;
      final T item = items.get(idx);
      items.remove(idx);

      new Timer().schedule(new TimerTask() {
         @Override
         public void run() {
            Platform.runLater(new Runnable() {
               @Override
               public void run() {
                  items.add(item);
               }
            });
         }
      }, 100);
   } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-04T00:05:55.583

我遇到了同样的问题，经过一番搜索，这是我的解决方法。我发现如果列被删除然后重新添加，表就会更新。

```
public static <T,U> void refreshTableView(final TableView<T> tableView, final List<TableColumn<T,U>> columns, final List<T> rows) {

    tableView.getColumns().clear();
    tableView.getColumns().addAll(columns);

    ObservableList<T> list = FXCollections.observableArrayList(rows);
    tableView.setItems(list);
} 
```

使用示例：

```
refreshTableView(myTableView, Arrays.asList(col1, col2, col3), rows); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-06-12T22:24:46.140

user1236048的解决方案是正确的，但关键点没有说出来。在用于表的可观察列表的 POJO 类中，您不仅需要设置 getter 和 setter 方法，还需要设置一个名为 Property 的新方法。在 Oracle 的 tableview 教程 ( [http://docs.oracle.com/javafx/2/ui_controls/table-view.htm](http://docs.oracle.com/javafx/2/ui_controls/table-view.htm) ) 中，他们忽略了关键部分！

下面是 Person 类的外观：

```
public static class Person {

    private final SimpleStringProperty firstName;
    private final SimpleStringProperty lastName;
    private final SimpleStringProperty email;

    private Person(String fName, String lName, String email) {
        this.firstName = new SimpleStringProperty(fName);
        this.lastName = new SimpleStringProperty(lName);
        this.email = new SimpleStringProperty(email);
    }

    public String getFirstName() {
        return firstName.get();
    }

    public void setFirstName(String fName) {
        firstName.set(fName);
    }

    public SimpleStringProperty firstNameProperty(){
        return firstName;
    }

    public String getLastName() {
        return lastName.get();
    }

    public void setLastName(String fName) {
        lastName.set(fName);
    }

    public SimpleStringProperty lastNameProperty(){
        return lastName;
    }

    public String getEmail() {
        return email.get();
    }

    public void setEmail(String fName) {
        email.set(fName);
    }

    public SimpleStringProperty emailProperty(){
            return email;
        } 
```

}

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-04-04T14:46:05.513

看看 Jira 中的这个问题： [https ://bugs.openjdk.java.net/browse/JDK-8098085](https://bugs.openjdk.java.net/browse/JDK-8098085)

2012-09-20 08:50 的评论给出了一个可行的解决方法。

```
//wierd JavaFX bug
reseller_table.setItems(null); 
reseller_table.layout(); 

ObservableList<User> data = FXCollections.observableArrayList(User.getResellers());
reseller_table.setItems(data); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-02-21T15:45:47.077

我一直试图找到一种方法来刷新 tableView(ScalaFx) 3-4 小时。最后我得到了答案。我只想发布我的解决方案，因为我已经浪费了几个小时。

-为了从数据库中检索行，我曾经声明一个返回 ObservableBuffer 的方法。

我的 JDBC 类

```
 //To get all customer details
def getCustomerDetails : ObservableBuffer[Customer] = {

val customerDetails = new ObservableBuffer[Customer]()
  try {

    val resultSet = statement.executeQuery("SELECT * FROM MusteriBilgileri")

    while (resultSet.next()) {

      val musteriId = resultSet.getString("MusteriId")
      val musteriIsmi = resultSet.getString("MusteriIsmi")
      val urununTakildigiTarih = resultSet.getDate("UrununTakildigiTarih").toString
      val bakimTarihi = resultSet.getDate("BakimTarihi").toString
      val urununIsmi = resultSet.getString("UrununIsmi")
      val telNo = resultSet.getString("TelNo")
      val aciklama = resultSet.getString("Aciklama")

      customerDetails += new Customer(musteriId,musteriIsmi,urununTakildigiTarih,bakimTarihi,urununIsmi,telNo,aciklama)

    }
  } catch {
    case e => e.printStackTrace
  }

  customerDetails
} 
```

- 我创建了一个 TableView 对象。

```
var table = new TableView[Customer](model.getCustomerDetails)
table.columns += (customerIdColumn,customerNameColumn,productInstallColumn,serviceDateColumn,
        productNameColumn,phoneNoColumn,detailColumn) 
```

- 最后我得到了解决方案。在刷新按钮中，我插入了这段代码；

```
table.setItems(FXCollections.observableArrayList(model.getCustomerDetails.delegate)) 
```

model 是我的 jdbc 连接类的参考

```
val model = new ScalaJdbcConnectSelect 
```

这是 scalafx 代码，但它为 javafx 提供了一些想法

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-03-02T13:10:05.753

**JavaFX8**

我正在通过对话框添加新项目。这是我的代码。

```
ObservableList<Area> area = FXCollections.observableArrayList(); 
```

**在 initialize() 或 setApp()**

```
this.areaTable.setItems(getAreaData()); 
```

**获取区域数据（）**

```
private ObservableList<Area> getAreaData() {
    try {
        area = AreaDAO.searchEmployees(); // To inform ObservableList
        return area;
    } catch (ClassNotFoundException | SQLException e) {
        System.out.println("Error: " + e);
        return null;
    }
} 
```

通过对话框添加。

```
@FXML
private void handleNewArea() {
    Area tempArea = new Area();
    boolean okClicked = showAreaDialog(tempArea);
    if (okClicked) {
        addNewArea(tempArea);
        this.area.add(tempArea); // To inform ObservableList
    }

} 
```

`Area`是一个普通的JavaFX POJO。希望这可以帮助某人。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-06-17T12:38:41.303

初始化（）方法

```
fullNameColumn = new TableColumn("Full name");
fullNameColumn.setCellValueFactory(new PropertyValueFactory<User, String>("fullName"));
usernameColumn = new TableColumn("Username");
usernameColumn.setCellValueFactory(new PropertyValueFactory<User, String>("test"));
emailColumn = new TableColumn("Email");
emailColumn.setCellValueFactory(new PropertyValueFactory<User, String>("email"));
reseller_table.setColumnResizePolicy(TableView.CONSTRAINED_RESIZE_POLICY);
reseller_table.getColumns().addAll(usernameColumn, fullNameColumn, emailColumn);

ObservableList<User> data = FXCollections.observableArrayList(User.getResellers());
reseller_table.setItems(data); 
```

用户类（Hibernate POJO 类）

```
private SimpleStringProperty test;

public void setFullName(String fullName) {
  this.fullName = fullName;
  this.test = new SimpleStringProperty(fullName);    
}

public SimpleStringProperty testProperty() {
  return test;
} 
```

刷新（）方法

```
ObservableList<User> data = FXCollections.observableArrayList(User.getResellers());
reseller_table.setItems(data); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-07-04T12:30:06.593

您应该使用可观察的属性，而不是手动刷新。这个问题的答案示例目的： [SimpleStringProperty and SimpleIntegerProperty TableView JavaFX](https://stackoverflow.com/questions/13381067/simplestringproperty-and-simpleintegerproperty-tableview-javafx)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-07-15T20:51:58.870

基于 Daniel De León 的回答

```
public static void refresh_table(TableView table) {
    for (int i = 0; i < table.getColumns().size(); i++) {
        ((TableColumn)(table.getColumns().get(i))).setVisible(false);
        ((TableColumn)(table.getColumns().get(i))).setVisible(true);
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-07-21T06:14:19.740

我的解决方案类似于[Daniel De León](https://stackoverflow.com/users/980442/)的解决方法，但是当您需要隐藏第一列（在他的示例中为索引 0）时，它也可以工作。当然，您可以只更改他解决方案中的索引，但如果您要重新排列列，我的解决方案可能对您更有效。这个想法是通过其名称隐藏和显示列，而不是通过其索引隐藏和显示它：

```
private void updateMyTableView() {
    // update table view WORKAROUND !!!
    if (myTableView != null) {
        ObservableList<TableColumn<Entry, ?>> columns = myTableView.getColumns();
        for (TableColumn<Entry, ?> column : columns) {
            // at this point, we look for the specific column, which should
            // always be visible
            // therefore we use the "Column Title" String, e.g. "First name"
            if (column.getText().equals("Column Title")) {
                column.setVisible(false);
                column.setVisible(true);
            }
        }
    }
} 
```

最好在 UI 更新线程中更新您的表格。但是，它也可以通过`updateMyTableView();`在您更改表中的某些内容后调用，因为 JavaFX 似乎无论如何都会在 UI 线程中更新（不确定）。

```
Platform.runLater(new Runnable() {
    public void run() {
         updateMyTableView();
    }
}); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-11-30T18:06:42.873

我不确定这是否适用于您的情况，但我会发布对我有用的内容。

我根据对数据库的查询/搜索更改我的表视图。例如，数据库表包含患者数据。我程序中的初始表格视图包含所有患者。然后我可以按名字和姓氏搜索患者的查询。我使用这个查询的结果来重新填充我的 Observable 列表。然后我通过调用 tableview.setItems(observableList) 重置 tableview 中的项目：

```
/**
 * Searches the table for an existing Patient.
 */
@FXML
public void handleSearch() {
    String fname = this.fNameSearch.getText();
    String lname = this.lNameSearch.getText();
    LocalDate bdate = this.bDateSearch.getValue();

    if (this.nameAndDOBSearch(fname, lname, bdate)) {
        this.patientData = this.controller.processNursePatientSearch(fname, lname, bdate);
    } else if (this.birthDateSearch(fname, lname, bdate)) {
        this.patientData = this.controller.processNursePatientSearch(bdate);
    } else if (this.nameSearch(fname, lname, bdate)) {
        this.patientData = this.controller.processNursePatientSearch(fname, lname);
    }

    this.patientTable.setItems(this.patientData);
} 
```

if 块使用查询结果更新 ObservableList。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-02-26T12:36:41.653

同样的问题，我尝试了一些解决方案，对我来说最好的解决方案如下：

在控制器的初始化方法中，创建一个空的 observableList 并将其设置到表中：

```
obsBericht = FXCollections.observableList(new ArrayList<Bericht>(0));
tblBericht.setItems(obsBericht); 
```

在您的更新方法中，只需使用 observableList，清除它并添加刷新的数据：

```
obsBericht.clear();
obsBericht.addAll(FXCollections.observableList(DatabaseHelper.getBerichte()));
// tblBericht.setItems(obsBericht); 
```

不需要重新设置表格的项目

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-04-09T11:40:19.343

按照丹尼尔·德莱昂的回答...

*   我在我的模型中引入了一个虚拟属性“modelChangedProperty”并
*   在我的模型中创建了一个方法 refresh() 来更改该属性的值。
*   在我的控制器中，我向更新表视图的虚拟属性添加了一个侦听器。

-

```
/**
 * Adds a listener to the modelChangedProperty to update the table view
 */
private void createUpdateWorkAroundListener() {

    model.modelChangedProperty.addListener(
            (ObservableValue<? extends Boolean> arg0, final Boolean oldValue, final Boolean newValue) -> updateTableView()
            );
}

/**
 * Work around to update table view
 */
private void updateTableView() {
    TableColumn<?, ?> firstColumn = scenarioTable.getColumns().get(0);
    firstColumn.setVisible(false);
    firstColumn.setVisible(true);
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-12-30T19:18:41.490

我知道这个问题已经 4 年了，但我有同样的问题，我尝试了上面的解决方案但没有奏效。我也调用了 refresh() 方法，但仍然不是我的预期结果。所以我在这里发布我的解决方案可能会对某人有所帮助。

```
Question db = center.getSelectionModel().getSelectedItem();
new QuestionCrud().deleteQ(db.getId());
ObservableList<Question> aftDelete = FXCollections.observableArrayList(
        (new QuestionCrud()).all()
        );
center.setItems(aftDelete); 
```

即使在此之前，我在 ObeservableList 中使用了另一个变量来将项目设置到 tableview 中，我称之为“肮脏的方法”，但在我得到更好的解决方案之前是可以的。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-11-14T05:12:05.067

为了刷新我的表，我这样做：

在名为`RequisicionesController`我的 ControllerA 中，我这样做

```
@FXML public TableView<Requisiciones>  reqtable;

public TableView<Requisiciones> getReqtable() {
    return reqtable;
}

public void setReqtable(TableView<Requisiciones> reqtable) {
    this.reqtable = reqtable;
} 
```

在 FXML 加载器中，我得到了 ControllerB，他也命名为`RevisionReqController`

```
RevisionReqController updateReq = cargarevisionreq.<RevisionReqController>getController();

RequisicionesController.this.setReqtable(selecciondedatosreq());                  
updateReq.setGetmodeltable(RequisicionesController.this.getReqtable()); 
```

在我的 ControllerB 中，我这样做：

```
public TableView<Requisiciones>  getmodeltable;     

public TableView<Requisiciones> getGetmodeltable() {
    return getmodeltable;
}

public void setGetmodeltable(TableView<Requisiciones> getmodeltable) {
    this.getmodeltable = getmodeltable;
} 
```

然后：

```
public void refresh () {
    mybutton.setonMouseClicked(e -> {
    ObservableList<Requisiciones> datostabla = FXCollections.observableArrayList();
    try {
        // rest of code

        String Query= " select..";

        PreparedStatement pss =Conexion.prepareStatement(Query);
        ResultSet rs = pss.executeQuery();
        while(rs.next()) {
            datostabla.add(new Requisiciones(
                // al requisiciones data
            ));
        }
        RevisionReqController.this.getGetmodeltable().getItems().clear();
        RevisionReqController.this.getGetmodeltable().setItems(datostabla);
    } catch(Exception ee) {
         //my message here
    }
} 
```

所以在我的控制器中，我只是用 setCellValueFactory 加载表，这就是全部。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-02-08T22:03:42.837

您只需要清除表格并调用生成表格填充的函数即可。

> ```
> ButtonRefresh.setOnAction((event) -> {
>             tacheTable.getItems().clear();
>             PopulateTable();
>         }); 
> ```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2018-04-26T21:28:59.020

在寻找所有可能的解决方案之后。尝试先清除数据，然后在 tableview 中添加，`tableView.getItems().clear();`但仍然没有解决我的问题。我尝试了这里给出的所有答案，但对我没有用，我的桌子上仍然有陈旧的对象，如下图所示：

[![在此处输入图像描述](../Images/50de4d3bfefea75345bbbb0d20ad1cf2.png)](https://i.stack.imgur.com/Nmu11.png)

为了修复它，我创建了一个 DUMMY 标签并使用`setGraphic`如下：

[![在此处输入图像描述](../Images/5c527610e30024ef42d838596094fd12.png)](https://i.stack.imgur.com/vNg28.png)

* * *

## 回答 #26

> 赞同：-11
> 
> 时间：2015-05-31T08:35:21.393

我当时认为使用列绑定的更改表的方法绑定数据的方法，如果这是 FX 的 bug 那也激活了连接决断了，不应该拖到 Java8 解决了。</p>

跟踪JavaFX源代码后，并没有发现bug。利用Listener等方法观察也没有异样。尝试利用JFace中的PropertyChangeSupport方式也声明POJO内容变更没有效果。最后将DoubleProperty改为WritableObjectValue，问就解决了。</p>

```
 解決於台灣台北 
```

我已经确定使用更改 Column Visable Property 不符合数据绑定自动化目的。

在我跟踪 JavaFX TableView 源代码之后。我从未发现 Tableview 绑定问题的任何问题代码。4 周前，我将 POJO 字段的类型从 DoubleProperty 更改为 WritableObjectValue，问题解决了。

```
 resolve in Taiwan Taipei. 
```

示例代码：</p>

```
public class CostAnalytics{
protected WritableObjectValue<Double> subtotal=new SimpleObjectProperty<Double>();//利用WritableObjectValue達到自動更新目的，不需要使用個別Column操作setVisable(false)及setVisable(true)
//...
public void setQuantity(double quantity) {
    this.pcs.firePropertyChange("quantity", this.quantity, quantity);
    this.quantity.set(quantity);
    this.calsSubtotal();
}
public WritableObjectValue<Double> getSubtotal() {//利用WritableObjectValue達到自動更新目的，不需要使用個別Column操作setVisable(false)及setVisable(true)
    return subtotal;
}
///...
}

TableColumn<CostAnalytics, Double> subtotal = new TableColumn<CostAnalytics, Double>(
            "小計");
subtotal.setCellValueFactory(new Callback<CellDataFeatures<CostAnalytics, Double>, ObservableValue<Double>>() {

        public ObservableValue<Double> call(
                CellDataFeatures<CostAnalytics, Double> p) {
            WritableObjectValue<Double> result = p.getValue().getSubtotal();// //利用WritableObjectValue達到自動更新目的，不需要使用個別Column操作setVisable(false)及setVisable(true)
            // return (ObservableValue<Double>)
            // result;//利用WritableObjectValue達到自動更新目的，不需要使用個別Column操作setVisable(false)及setVisable(true)
            // return new
            // ReadOnlyObjectWrapper<Double>(p.getValue().getSubtotal());//造成無法自動更新
            return (ObservableValue<Double>) p.getValue().getSubtotal();// 利用WritableObjectValue達到自動更新目的，不需要使用個別Column操作setVisable(false)及setVisable(true)
        }

    }); 
```**

# php - 使用php备份mysql数据库

> ID：11065155
> 
> 赞同：0
> 
> 时间：2012-06-16T16:24:37.080
> 
> 标签：php, mysql, backup

我正在使用下面的代码备份到 mysql 数据库。但是当我将备份文件导入新数据库时，文件导入成功但新数据库为空（无表）。

这是我使用的代码：

```
<?php
  $dbhost = 'localhost:3036';
  $dbuser = 'root';
  $dbpass = 'rootpassword';

   $backup_file = $dbname . date("Y-m-d-H-i-s") . '.gz';
   $command = "mysqldump --opt -h $dbhost -u $dbuser -p $dbpass ".
       "test_db | gzip > $backup_file";

   system($command);
   ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:41:03.650

首先，`.sql`扩展名不太正确，您得到的`SELECT ... INTO OUTFILE`是逗号（或其他分隔符）分隔的文本文件，而不是 SQL 语句文件。这更多是代码可读性问题，但更好地命名您的文件广告`file.txt`或`file.csv`（如果分隔符符合 CSV 标准）。

也就是说，如果您使用

```
LOAD DATA LOCAL INFILE '/path/to/file.txt' INTO TABLE your-table-name;` 
```

备份/导入应该可以工作，但**前提是您首先使用`CREATE TABLE`**. 所以这给你留下了重新创建模式代码的负担，非常痛苦。如果您使用已经有架构（例如导出/导入到同一个数据库），那没关系。

* * *

如果您有权限，另一种尝试`exec`是使用`mysqldump`. 对于 Linux 系统，它应该是：

```
exec("/usr/bin/mysqldump -uusername-ppassword databasename | gzip -9 > /path/to/backupfile.gz"); 
```

备份整个数据库，并具有 GZIP 压缩的额外好处。要备份特定表，只需将其名称添加到数据库名称旁边。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T16:27:08.390

我认为这个脚本将有助于您进行 dabase 备份

```
<?php
backup_tables(‘hostaddress’,'dbusername’,'dbpassword’,'dbname’);

/* backup the db OR just a table */
function backup_tables($host,$user,$pass,$name,$tables = ‘*’)
{

$link = mysql_connect($host,$user,$pass);
mysql_select_db($name,$link);

//get all of the tables
if($tables == ‘*’)
{
$tables = array();
$result = mysql_query(‘SHOW TABLES’);
while($row = mysql_fetch_row($result))
{
$tables[] = $row[0];
}
}
else
{
$tables = is_array($tables) ? $tables : explode(‘,’,$tables);
}

//cycle through
foreach($tables as $table)
{
$result = mysql_query(‘SELECT * FROM ‘.$table);
$num_fields = mysql_num_fields($result);

$row2 = mysql_fetch_row(mysql_query(‘SHOW CREATE TABLE ‘.$table));
$return.= “\n\n”.$row2[1].”;\n\n”;

for ($i = 0; $i < $num_fields; $i++)
{
while($row = mysql_fetch_row($result))
{
$return.= ‘INSERT INTO ‘.$table.’ VALUES(‘;
for($j=0; $j<$num_fields; $j++)
{
$row[$j] = addslashes($row[$j]);
$row[$j] = ereg_replace(“\n”,”\\n”,$row[$j]);
if (isset($row[$j])) { $return.= ‘”‘.$row[$j].’”‘ ; } else { $return.= ‘”"‘; }
if ($j<($num_fields-1)) { $return.= ‘,’; }
}
$return.= “);\n”;
}
}
$return.=”\n\n\n”;
}

//save file
$handle = fopen(‘db-backup-’.time().’-’.(md5(implode(‘,’,$tables))).’.sql’,'w+’);
fwrite($handle,$return);
fclose($handle);
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T16:28:28.637

此代码实际上并不存储表的架构，因此当您尝试导入它时，您只是在导入数据。

您可以手动创建表，也可以使用 cli 实用程序 mysqldump 来提供帮助。

可以通过 php 转储数据和模式，但需要更多的工作。

# printing - 向 Windows 8 ListView App 添加多页打印

> ID：11065157
> 
> 赞同：2
> 
> 时间：2012-06-16T16:25:06.033
> 
> 标签：printing, windows-8

我有一个带有 ListView 的应用程序，其中显示了摘要项目的列表。

我添加了打印支持，但我坚持将我的内容分成不同的页面。

我可以添加多个页面，但我不知道如何根据页面大小将内容拆分为页面。

目前，我的打印内容有一个 xaml 用户控件，其中包含一个绑定的 ItemsControl。我想绑定到仅适合页面的项目的列表，或者根据页码向上移动顶部可见项目的位置。

我不确定哪个是最好的方法，我也不知道该怎么做。

我可以在文档中找到的唯一分页示例是富文本块，它依赖于 RichTextBlockOverflow 控件。我认为这对我没有帮助。

# css - 定义 CSS 媒体查询

> ID：11065162
> 
> 赞同：1
> 
> 时间：2012-06-16T16:25:51.320
> 
> 标签：css, media-queries

以下媒体查询在移动设备和计算机上的行为是否完全相同，或者有什么不同？

```
@media only screen and (max-width: 480px), 
screen and (max-device-width: 480px){
...
} 
```

和

```
@media (max-width: 480px) {
..
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-18T22:07:29.503

不，他们不会。这是因为`device-width`不一样`width`。如果您的媒体查询只是`width`它们的行为相同，但是当您介绍时，`device-width`您会得到不同的结果。有关更多信息，请参阅我对这个问题的回答：[针对 iPhone iPad 的 CSS 样式表不起作用](https://stackoverflow.com/questions/11006754/css-stylesheet-that-targets-iphone-ipad-not-working/11024633#11024633)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:03:23.643

媒体查询本身将表现相同。但是当他们查询不同的东西时，他们很可能会得到不同的答案。

“仅屏幕”*通常*有效，但少数移动设备将自己归类为“手持”而不是“屏幕”。（我个人的倾向是“只有全部”更好，部分原因是它包括手持设备，部分原因是它也提供了相同的 CSS 来打印和演示 [即投影仪]。）

对于第一个近似值，min/max-width 是逻辑当前窗口（可能已经由用户设置），而 min/max-device-width 是物理屏幕。**但是**许多移动设备*不会*返回您在其销售规格中阅读的屏幕尺寸。其中许多包含“视口”的概念......您可以修改（使用 <meta name="viewport" content="...），但通常默认为比实际屏幕尺寸大得多的东西。彻底了解“视口”将澄清（也​​可能回答）您的查询。

此外，由于移动设备的观看距离通常更近，因此它们需要更密集的像素才能提供同等的用户体验。（iPad 的“视网膜”显示器就是这一趋势的例证。）由于像素密度非常高，小物理尺寸无论如何都可能具有显着的大像素尺寸。（我自己的倾向是认为您最终必须在您的媒体查询中考虑密度，以便产生真正合理的结果。）

无论如何，对于保留概念但实施方式不同的媒体查询的替代方案，你可能想看看[http://www.ckollars.org/alternative-to-media-queries.html](http://www.ckollars.org/alternative-to-media-queries.html)

# php - PHP Curl IIS7 抛出 500 错误

> ID：11065164
> 
> 赞同：0
> 
> 时间：2012-06-16T16:26:22.087
> 
> 标签：php, curl, iis-7, windows-7-x64

我只是在 php.ini 中取消注释 curl 并开始尝试在我的小型 php 应用程序中使用它。首先，我的 php 适用于其他大多数情况。它能够连接到 mysql 数据库。我得到的错误

HTTP 错误 500.0 - 内部服务器错误 C:\PHP\php-cgi.exe - FastCGI 进程意外退出

这并不完全有帮助。

我在用着

IIS 7 PHP 5 Windows 7

# asp.net-mvc - ASP.net MVC 或 Knockout.JS

> ID：11065166
> 
> 赞同：2
> 
> 时间：2012-06-16T16:26:34.020
> 
> 标签：asp.net-mvc, mvvm, knockout.js

这可能是一个新手问题。我最初在 MVVM 和 WPF 中编写了一个原型。客户想要使用 MVC 和 jQuery。没什么大不了。我在VIEWMODEL中写了很多业务逻辑。

如果我使用 knockout.js 是否只是使用 javascript 库和创建新绑定的问题？

任何意见将是有益的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T20:45:24.440

两者都是用于不同目的的完全不同的技术。Knockout.JS 是一个强大的客户端脚本，使用 mvvm 模式，而 MVC 是一种架构模式，用于构建真正的无状态 Web 应用程序，具有根据需要进行调整的能力。

可能存在一种误解，即 MVC 模式仅适用于 ASP.NET MVC 框架。其他网络编程语言也使用它或有可能实现这种模式。但是，在 .NET 中，它有一些非常强大的扩展和一个活跃的社区，可以快速学习并无所畏惧地练习。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T19:04:14.560

为什么不两者都用？我正在使用淘汰赛和 mvvm

# c++ - 3D '射手' 跳跃算法 - C++ 低级缺陷。两个相同的双打不应该相等。4.0 != 4.0 显然

> ID：11065171
> 
> 赞同：-4
> 
> 时间：2012-06-16T16:26:59.870
> 
> 标签：c++, opengl, floating-point

> **可能重复：**
> [浮点比较](https://stackoverflow.com/questions/7011184/floating-point-comparison)

嗯，这是一个奇怪的。通常以下`if( 4.0 == 4.0 ){return true}`将始终返回`true`。在我拥有的一个简单的 opengl 3d '射手'程序中，当我尝试添加'跳跃'效果时，情况并非如此。

这个想法相当简单，我有一个三角形地带的地形，当“角色”移动/行走时，你会沿着二维高度阵列移动，因此你会在山丘/低谷的不同高度上下行走。

在`drawScene()`函数之外（或者如果你知道 opengl，the `glutDisplayFunc()`），我有一个`update()`函数可以在角色“跳跃”时上下提升角色，这被称为 in `drawScene()`。换句话说，尽我所能解释的高级，跳跃算法如下：

参数：

```
double currentJumpingHeight
double maximumJumpingHeight = 4.0
double ypos;
const double jumpingIncrement = 0.1; //THE PROBLEM!!!! HAS TO BE A MULTIPLE OF 0.5!!
bool isJumping = false;
bool ascending = true; 
```

算法：

```
(when space is pressed) isJumping = true.

if ascending = true and isJumping = true, 
      currentJumpHeight += jumpingIncrement (and the same for ypos)

if currentJumpingHeight == maximumJumpingHeight, //THE PROBLEM
     ascending = false
     (we decrement currentJumpingHeight and start to fall until we hit the ground.) 
```

* * *

它非常简单，但只有当 jumpingIncrement 是`0.5`!!

如果`jumpingIncrement`是，比如说，，`0.1`那么`currentJumpingHeight`永远不会等于`maximumJumpingHeight`。角色像火箭一样起飞，永远不会回到地面。即使两个变量打印到标准输出并且相同，条件也永远不会为真。这是我想解决的问题，很荒谬。

我不想要关于跳跃算法的任何反馈——请只看上面的段落。

请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T16:33:20.773

这只是一个典型的浮点精度问题。特别是`0.1`不能使用二进制浮点数精确表示。另一方面，像 0.5 和 0.25 这样的数字可以精确表示，因此*可能会*起作用。我相信即使在这种情况下，编译器仍然可以让它不起作用。

在您的情况下，解决方案正在使用`>=`：

```
if ascending && (currentJumpingHeight >= maximumJumpingHeight)
     ascending = false
     currentJumpingHeight = maximumJumpingHeight 
```

您也可以使用 epsilon 比较，但我尽可能避免使用它们。在您的情况下，简单`>=`似乎比 epsilon 平等更清洁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T16:45:59.340

正如人们所说，这是一个典型的浮点精度问题。看看[这个](http://docs.python.org/tutorial/floatingpoint.html) 基本上，同样的方式，你不能用有限的数字 1/3 以 10 为基数进行编码

```
1/3 = 0.3333333333..... 
```

你不能在 base 2 中做 1/10。它将是

```
0.1 = 0x0.0001100110011001100110011001100110011001100110011... 
```

您永远不应该比较浮点数，但要检查差异是否小于一个值，例如

```
if (fabs(a-b) < 1e-6) 
```

代替

```
if(a==b) 
```

当然，在您的情况下，只需使用'> ='。

它适用于您的 0.5 增量，因为 0.5 是二进制的 1/2 或 0.1，因此编码正确。这适用于 2 的任何幂，即 0.5 或 0.125，但绝不适用于 0.1。

# php - 无法打开 WampServer 的配置文件，请更改 index.php 文件中的路径

> ID：11065172
> 
> 赞同：2
> 
> 时间：2012-06-16T16:27:03.693
> 
> 标签：php, wamp, wampserver

> 无法打开 WampServer 的配置文件，请更改 index.php 文件中的路径。

如何在我的窗口中解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T08:05:15.263

尝试更改 index.php，不要使用位于 www 的 index.php。

# java - 为什么 java 有 int 和 int Integer 数据类型，我可以将数据从一个移动到另一个？

> ID：11065173
> 
> 赞同：6
> 
> 时间：2012-06-16T16:27:04.877
> 
> 标签：java

> **可能重复：**
> [为什么 Integer 和 int 可以互换使用？](https://stackoverflow.com/questions/7121581/why-can-integer-and-int-be-used-interchangably)

我试图了解这些之间的区别。例如，我可以将某些东西声明为 int，然后将其与我放入 Integer 的数字进行比较吗？还有为什么Java有这两个。为什么不把这些结合起来呢？

有人可以通过向我展示每个如何使用的 3-4 行代码示例来帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T16:31:15.063

`int`原语不是对象。数组允许primiteves：

```
int[] array = new int[10]; 
```

但泛型不会：

```
List<int>  //won't compile 
```

这是当今使用包装类的主要原因。您也可以`Integer`在`Object`预期的地方使用。如果你想实现*可选*性， finally`Integer`可以有价值。`null`

 *请注意，有些语言处理了这种不一致。在[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")中，您有值类型，在[scala](/questions/tagged/scala "显示标记为“scala”的问题") 中，类从类扩展，`Int` *而*`AnyVal`普通对象扩展`AnyRef`（这两个都从类扩展`Any`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T16:32:23.630

请参阅Java 中的类型[装箱](http://docs.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html)。有人说从 Ja​​va 9 开始让它们完全一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-16T16:33:44.347

*   原始`int`类型和[整数](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html)类是不同的类型。您不能直接将基元`int`与`Integer`对象进行比较。你需要`intValue`从`Integer`对象中获取。
*   是的，这是必需的功能。Java 和其他一些语言为原始类型提供了这些类型的对象包装器，以处理需要对象的情况。例如，集合类需要对象，您不能`int`对它们使用原始类型。所以你需要一个`Integer`包装器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-16T16:34:09.650

Integer 是一个对象，而 int 是一个原始类型。从根本上说，对象是通过引用传递的，而基元是通过值传递的。它们的分配位置也不同。

在 Java 中，对象具有函数。调用类似的东西：

```
Integer.toString() 
```

很好，但是：

```
int.toString() 
```

不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-16T16:31:43.880

int 是一个原始类型，Integer 是一个类。你不能说`ArrayList<int>`，但你可以说`ArrayList<Integer>`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-16T16:32:51.197

Java 中的所有原始类型都有对应的类（从 Object 派生的类），例如 Boolean、Long 等。它被称为“装箱”。解释参见例如[here](http://mindprod.com/jgloss/intvsinteger.html)。*

# android - OpenGL ES - 在不同的顶点上重复相同的纹理

> ID：11065182
> 
> 赞同：2
> 
> 时间：2012-06-16T16:30:17.437
> 
> 标签：android, ios, opengl-es, textures

假设我有一个由多个三角形组成的多边形（一个长矩形），使用`GL_TRIANGLE_STRIP`.

![在此处输入图像描述](../Images/27e9199a6dd21e20d57a8b1243548666.png)

现在想象我有一个正方形纹理，应该映射到构成矩形的每个小正方形上。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T16:38:51.003

您需要沿几何体重复纹理。为此，您需要将纹理设置`GL_TEXTURE_WRAP_S`为`GL_REPEAT`.

然后你可以为你的顶点分配纹理坐标：

*   (0,0), (0,1) 用于第一列的 2 个顶点
*   (1,0), (1,1) 用于第 2 列的 2 个顶点
*   (2,0), (2,1) 第三列
*   等等

# c# - WIX - 安装后从工作目录运行 VB 脚本。

> ID：11065188
> 
> 赞同：1
> 
> 时间：2012-06-16T16:31:28.683
> 
> 标签：c#, wix, windows-installer, wix3.5

我在使用 WIX 时遇到问题。在安装 MSI 期间，我想验证是否安装了 .NET Framework 4.0，如果没有，那么我必须从 dotnet msi 安装。

由于我无法从另一个 MSI 调用 MSI，所以我编写了一个执行 .NET 框架验证和安装的 VB 脚本。

现在的问题是，我想在从安装目录安装后运行那个 VB 脚本。我尝试了所有可能的方法，但无法得到它。

这是一段 WIX 代码。

```
 <CustomAction Id="StartAppOnExit" FileKey="DotNetFrameworkCheck.vbs"
   Execute="deferred" Return="asyncWait" />

    <InstallExecuteSequence>
      <Custom Action="StartAppOnExit" After="InstallFinalize"></Custom>
    </InstallExecuteSequence> 
```

FileKey 在哪里

```
 <File Id="DotNetFrameworkCheck.vbs" Source="Build_\message.vbs" /> 
```

我可以知道代码中的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T19:44:44.817

安装 .NET 或其他先决条件的推荐方法是使用引导程序 exe。此引导程序将首先调用 .NET 安装程序，然后是您自己的 MSI。

Wix 3.6 包含生成此类引导程序的功能。请参阅[如何：使用 Burn 安装 .NET Framework](http://wix.sourceforge.net/manual-wix3/install_dotnet.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T10:36:09.763

此外，所有自定义操作都必须在`InstallInitialize`和之间执行`InstallFinalize`。你需要改变你的`InstallExecuteSequence`.

# import - 在不同域上的两个 umbraco 安装之间导入数据

> ID：11065191
> 
> 赞同：0
> 
> 时间：2012-06-16T16:32:00.697
> 
> 标签：import, content-management-system, umbraco

我在一个域上安装了 umbraco：http: [//www.domain1.com/](http://www.domain1.com/)。是否有某种方式（包或其他方式）将此域中的数据（当我说数据时，我指的是节点中属性内的实际内容）导入另一个域上的另一个 umbraco 安装，比如说 http:/ www.domain2.com/?

（我当然有两种安装的用户权限）。

我问的原因是第一个域是一个临时域，它将保存数据而不显示前端，而第二个域将保存前端的最终数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T21:29:43.170

查看商业快递包裹。它使您只需单击几下即可迁移内容。不幸的是，每个域 99 美元，但如果你有一个 localhost 登台/开发环境，你要从中迁移内容，这是值得的，因为它是从 localhost 免费运行的。子域也包含在许可证中。

[http://umbraco.com/products/more-add-ons/courier-2.aspx](http://umbraco.com/products/more-add-ons/courier-2.aspx)

# python - 在浏览器中浏览 Python 文件的内容/代码的类似 pydoc 的程序？

> ID：11065198
> 
> 赞同：1
> 
> 时间：2012-06-16T16:33:07.043
> 
> 标签：python, pydoc

pydoc 允许我在浏览器中查看添加到我的 PYTHONPATH 的目录中的 Python 模块和包的文档。有没有办法浏览这些文件的完整代码？

[我使用3to2](http://pypi.python.org/pypi/3to2)转换了 Edoardo Ivanec 的代码：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from __future__ import with_statement
import CGIHTTPServer, SimpleHTTPServer, BaseHTTPServer
import os  
from pygments import highlight
from pygments.lexers import PythonLexer
from pygments.formatters import HtmlFormatter
from io import open

class SourceViewer(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
        path = os.path.join(os.getcwdu(), self.path[1:])
        if os.path.exists(path) and path.endswith(u'.py'):
            with open(path) as file:
                code = file.read()
                hl = highlight(code, PythonLexer(), HtmlFormatter(noclasses=True, linenos=u'table'))
                self.send_response(200)
                self.end_headers()
                self.wfile.write(str(hl).encode('UTF-8'))
                return
        else:       
            super(self.__class__, self).do_GET()

if __name__ == u"__main__":
    server = BaseHTTPServer.HTTPServer((u'localhost', 8080), SourceViewer)
    server.serve_forever() 
```

将`localhost:8080`显示一条`no data received`消息。我应该如何为其提供数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T20:54:55.163

[您可以在pygments](http://pygments.org/)的帮助下扩展标准库中的 HTTP 服务器，以提供目录中 Python 源文件的突出显示和行号版本。

这是 Python 3 的示例：

```
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import http.server
import os  
from pygments import highlight
from pygments.lexers import PythonLexer
from pygments.formatters import HtmlFormatter

class SourceViewer(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        path = os.path.join(os.getcwd(), self.path[1:])
        if os.path.exists(path) and path.endswith('.py'):
            with open(path) as file:
                code = file.read()
                hl = highlight(code, PythonLexer(), HtmlFormatter(noclasses=True, linenos='table'))
                self.send_response(200)
                self.end_headers()
                self.wfile.write(bytes(hl, 'UTF-8'))
                return
        else:       
            super().do_GET()

if __name__ == "__main__":
    server = http.server.HTTPServer(('localhost', 8080), SourceViewer)
    server.serve_forever() 
```

Python 2，基于您的 3to2 转换：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from __future__ import with_statement
import SimpleHTTPServer, BaseHTTPServer
import os  
from pygments import highlight
from pygments.lexers import PythonLexer
from pygments.formatters import HtmlFormatter

class SourceViewer(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
        path = os.path.join(os.getcwdu(), self.path[1:])
        if os.path.exists(path) and path.endswith(u'.py'):
            with open(path) as file:
                code = file.read()
                hl = highlight(code, PythonLexer(), HtmlFormatter(noclasses=True, linenos=u'table'))
                self.send_response(200)
                self.end_headers()
                self.wfile.write(hl)
                return
        else:    
            SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self)

if __name__ == u"__main__":
    server = BaseHTTPServer.HTTPServer((u'localhost', 8080), SourceViewer)
    server.serve_forever() 
```

示例结果：

![示例结果](../Images/0f6f9b59a9e403868b824d7a0617f964.png)

# java - 如何在 JSF 中使用会话实现多用户登录

> ID：11065199
> 
> 赞同：0
> 
> 时间：2012-06-16T16:33:08.760
> 
> 标签：java, session, jsf, login, sessiontracking

我是 JSF 的新手，我正在做 web 项目。

1.  我想实现登录系统，多个用户可以登录。就像 Facebook 或任何其他您提供用户名和密码并访问您的帐户的网站一样。

2.  我想要的另一件事是，如果用户未登录并且他想要访问（受限）url，他必须被重定向到登录页面。

我什至不知道从哪里开始，但是我知道如何在 Servlet 中进行“会话跟踪”。

任何人都可以建议我很好的例子或通过示例代码帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:29:38.580

据我所知，JSF 没有特殊的身份验证功能。

*   编写自己的身份验证。只适用于非常简单的场景（没有基于角色的授权等）
    1.  编写一个[过滤器](http://docs.oracle.com/javaee/5/api/javax/servlet/Filter.html)来控制页面访问（检查你的会话。如果用户没有登录，将他重定向到登录页面）
    2.  构建登录页面，检查用户凭据并设置登录标志
    3.  建立一个注销方法来清除用户会话中的标志
*   使用容器管理安全[Java EE 5 教程](http://docs.oracle.com/javaee/5/tutorial/doc/bncbx.html#bncby)
*   使用第三方库，如[Apache Shiro](http://shiro.apache.org/index.html)或[Spring Security](http://static.springsource.org/spring-security/site/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T18:37:25.487

1.  将登录数据保存在会话范围的 Bean 中。[在这里](http://www.coreservlets.com/JSF-Tutorial/jsf2/#Tutorial-Introhttp://www.coreservlets.com/JSF-Tutorial/jsf2/#Tutorial-Intro)，您有一个完整的 JSF 教程，其中包含一些示例和源代码。检查有关 Managed Beans I 的部分。

2.  实现该功能的一种基本方法是在用户访问页面时检查用户是否已登录（会话中存储了一个有效的登录 Bean）。如果不是，请重定向到登录页面。[这](http://mowyourlawn.com/blog/?p=6)是关于检查用户是否使用 Phase Listeners 登录

# validation - 检查 MATLAB 中的日期一致性

> ID：11065201
> 
> 赞同：2
> 
> 时间：2012-06-16T16:33:15.407
> 
> 标签：validation, matlab, datetime, date

有没有直接的方法可以做到这一点？我想给出一个日期数组作为输入（例如 1997-01-02 1997-01-03... 使用格式 yyyy-mm-dd），如果给定数组的所有元素都一致并且得到 1否则为 0。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:03:37.827

使用正则表达式的许多方法。几个简单的：

```
str = '1917-01-23';

regexp(str,'\d\d\d\d-\d\d-\d\d')
ans =
     1 
```

如果字符串与该模式完全匹配，您将得到 1，否则为空。

或者这样做：

```
regexp(str,'-','split')
ans = 
    '1917'    '01'    '23' 
```

现在您可以验证第一块是有效的年份，第二块是有效的月份，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:03:48.120

这是一个想法：

```
d = {
    '1997-01-02'
    '1997-01-03'
    '1111-99-99'
    'not a date'
}

isDateValid = false(size(d));
for i=1:numel(d)
    try
        str = datestr(datenum(d{i},'yyyy-mm-dd'),'yyyy-mm-dd');
        isDateValid(i) = isequal(str,d{i});
    catch ME
    end
end 
```

结果：

```
>> isDateValid
isDateValid =
     1
     1
     0
     0 
```

我来回进行转换的原因是 MATLAB 会将超出正常字段范围的值传递到下一个——第三个示例实际上将被解析为：`1119-06-07`. 虽然最后一个会抛出异常

# android - 进行“删除布局”的最佳方式？

> ID：11065202
> 
> 赞同：0
> 
> 时间：2012-06-16T16:33:16.167
> 
> 标签：android, android-layout

我有一个应用程序，它有一个显示消息日志的活动。问题是用户必须能够选择一些消息然后删除它们，就像你想删除一些短信一样。

最好的方法是什么？添加更多细节：

这是仅包含消息的捕获。

![在此处输入图像描述](../Images/8e4db511ea7ee3a077bc022e0861dfc4.png)

这是带有选择布局的捕获。

![在此处输入图像描述](../Images/47c23b96d2514d18935a20a2910e4578.png)

我想知道他们是如何展示的`CheckBoxes`。他们使用了两种布局吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T06:22:54.713

> 我想知道他们是如何显示复选框的，他们使用 2 种布局吗？

我怀疑他们使用两个布局文件。由于行非常相似，因此很容易通过更改可见性从没有的布局切换到有的`CheckBox`布局。`CheckBox`一种方法是在您的适配器中有一个标志，指示行中存在并根据该标志`CheckBox`更新可见性：`CheckBox`

```
boolean checkStatus = false;

//...

public void getView(int position, View convertView, ViewGroup parent) {
     //...
     if (checkStatus) {
          checkBox.setVisibility(View.VISIBLE); //show the CheckBox for each row
     } else {
          checkBox.setVisibility(View.GONE); // hide the CheckBox for each row
     }
     //...
} 
```

然后，当需要显示这些`CheckBoxes`（`Button`单击、菜单单击等）时，您只需将标志设置为`checkStatus`所需的值（当前，否则）并调用您的适配器。`true``CheckBoxes``false``notifyDataSetChanged()`

当然，您可以使用两种布局，一种包含 ，`CheckBox`另一种不包含。`ListView`但是，通常，当两个布局非常（或实质性）不同（这不是您的情况）时，您会使用两种布局。要实现这两种布局，您必须使用方法`getItemViewType`和`getViewTypeCount`.

```
boolean checkStatus = false;

public int getViewTypeCount() {
     return 2; // you have two layouts
}

public int getItemViewType(int position) {
     if (checkStatus) {
          return 1;
     } else {
          return 0;
     }
} 
```

然后在你的`getView`方法中：

```
public void getView(int position, View convertView, ViewGroup parent) {
     int which = getItemViewType(position)
     // make a switch statement and inflate the correct layout file
     // based on the which variable if the convertView is null
     // do stuff;
} 
```

当然，当需要显示时，`CheckBoxes`您必须`checkStatus`再次设置标志并调用`notifyDataSetChanged()`您的适配器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T20:24:04.813

如果您使用 listView 和适配器，我的猜测是适配器包含消息的（纯 java）列表。因此，当用户删除一个项目时，根据项目在列表中的位置将其从列表中删除。

紧接着，调用[`notifyDataSetChanged`](http://developer.android.com/reference/android/widget/BaseAdapter.html#notifyDataSetChanged%28%29)适配器。而已 。

# c# - C# 程序在 HTTP 请求后停止

> ID：11065204
> 
> 赞同：0
> 
> 时间：2012-06-16T16:33:41.883
> 
> 标签：c#, webclient, httprequest

我的代码在这里可以很好地获取内容长度，并告诉我文件有多大，然后它适用于 if 语句。只是由于某些原因在 if 语句之后，如果 MB 小于 5，它不会下载文件，它只是一般停止程序。就像在 HTTP 请求之后，它就停止了。所以我不知道这是我的代码错误，还是其他原因，如果这是一个愚蠢的问题，我很抱歉。

```
 byte[] test;
            int size;
            long MB = 0;
            HttpWebRequest req = (HttpWebRequest)WebRequest.Create(Path);
            req.Method = "HEAD";
            HttpWebResponse resp = (HttpWebResponse)(req.GetResponse());
            long len = resp.ContentLength;
            MB = len / 1048576;

            if (MB > 5)
            {
                Console.WriteLine("File to big!");
            }
            else
            {
                var webClient = new WebClient();
                MemoryStream ms = new MemoryStream();
                byte[] imageBytes = webClient.DownloadData(Path);
                test = imageBytes;
                size = test.Length;
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:47:08.917

只是猜测，但也许`resp.Close();`在尝试打开另一个连接之前打电话会有所帮助？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:55:17.230

`Dispose()`在`HttpWebResponse`继续之前调用`WebClient`。

它应该工作。

# ios - Cocos2d。精灵和进度条紧密连接

> ID：11065206
> 
> 赞同：0
> 
> 时间：2012-06-16T16:33:46.860
> 
> 标签：ios, cocos2d-iphone

开始学习Cocos2d，有个问题。随着精灵的移动，我需要进度（健康）条与它们一起移动（略高于精灵），并保持它相对于精灵的位置，就像它是一个精灵一样。任何想法如何实现？

谢谢，亚历克斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:10:17.743

将健康栏作为孩子添加到精灵中，在士兵身体所需的偏移处。当您稍后移动士兵时，健康栏将随之而来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:17:04.257

您可以将健康栏精灵添加为另一个精灵的子元素：

```
[sprite addChild:healthBar]; 
```

您可以像往常一样定位生命值条精灵，但最终位置将相对于父级的锚点（默认情况下位于精灵的中心）。

# ios - 具有多个 xib 的 PageControl？

> ID：11065208
> 
> 赞同：4
> 
> 时间：2012-06-16T16:34:14.610
> 
> 标签：ios, cocoa, uiscrollview, pagecontrol

我无法使用多个 xib 设置页面控制。我现在在 Internet 上的 Stack 上搜索了一段时间，但我得到的只是使用带有颜色或图像的数组设置页面控制。是否可以为多个视图控制器获取带有 PageControl 的 UIScrollView？我在想我应该使用 (initwithNibName: method)，但我不确定如何使用滚动视图进行设置。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T22:54:30.663

对的，这是可能的。检查这个非常有用的库。这是一个 iPhone UIScrollView 与水平分页，如移动 Safari 选项卡[HGPageScrollView](http://100grams.github.com/HGPageScrollView/)。它在我们的应用程序中非常有效。

[GitHub HGPageScrollView](https://github.com/100grams/HGPageScrollView)。

[更新]

这是另一个例子。检查此[链接](http://www.wannabegeek.com/?p=168)。

# php - 服务器会同时处理两个或更多吗？

> ID：11065212
> 
> 赞同：4
> 
> 时间：2012-06-16T16:35:22.957
> 
> 标签：php

我在 PHP 中有这段代码将视图写入文本文件并只是增加了数量。我的问题在这里：如果两个或更多人使用我的网站并运行 PHP 脚本会发生什么？服务器会处理吗？增量是否会保存到文件中？

这是我的代码（如果有帮助）：

```
<?php

    $clicks = file_get_contents("clicks.txt");
    $clicks++;

        $fp = fopen("clicks.txt", "w+");
        fwrite($fp, $clicks);
        fclose($fp);

//give the count to the user
echo "result: $clicks";

    ?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T16:43:21.147

首先：这不是我编写点击计数器的方式。

也就是说，100 个用户同时访问您的服务器（初始点击为 0）可能会导致记录的数量为 1..100，其中低（=错误）值很突出。

*   如果您想计入文本文件，请按照@lanzz 的答案锁定并为重大性能损失做好准备 - 您正在有效地序列化请求。
*   如果您想计入任何文件，请考虑使用 SQlite 并为可管理的性能冲击做好准备
*   如果您只想数数，请考虑性能影响很小的真实数据库

**编辑：实现**

我为文本文件、SQLite 和 MySQL 中的文件计数器创建了以下实现

请不要因为使用`mysql_*()`函数系列而激怒我——因为代码总是具有指导性的，而不是富有成效的：在专注于手头的问题而不是周围层的意义上是有指导性的。

**计数器文件.php：**

```
<?php

//acquire file handle
$fd=fopen('counter.txt','c+b');
if (!$fd) die("Can't acquire file handle");

//lock the file - we must do this BEFORE reading, as not to read an outdated value
if (!flock($fd,LOCK_EX)) die("Can't lock file");

//read and sanitize the counter value
$counter=fgets($fd,10);
if ($counter===false) die("Can't read file");
if (!is_numeric($counter)) {
    flock($fd,LOCK_UN);
    die("Value in file '$counter' is not numeric");
}

//increase counter and reconvert to string
$counter++;
$counter="$counter";

//Write to file
if (!rewind($fd)) {
    flock($fd,LOCK_UN);
    die("Can't rewind file handle");
}
$num=fwrite($fd,$counter);
if ($num!=strlen($counter)) {
    flock($fd,LOCK_UN);
    die("Error writing file");
}

//Unlock the file and close file handle
flock($fd,LOCK_UN);
fclose($fd);

printf ("Counter is now %05d",$counter);
?> 
```

**反sqlite.php：**

```
<?php

//counter.sqlite3 was created with 
//CREATE TABLE counter (counter NUMERIC)
//INSERT INTO counter VALUES (0)

//Open database
$dsn='sqlite:'.dirname(__FILE__).'/counter.sqlite3';
$db=new PDO($dsn);
if (!$db) die("Can't open SQlite database via DBO");

//Make exclusive
$sql="BEGIN EXCLUSIVE TRANSACTION";
if ($db->exec($sql)===false) die("Error starting exclusive transaction");

//Update counter
$sql="UPDATE counter SET counter=counter+1";
if (!$db->exec($sql)) die("Error inserting into database");

//Read value
$sql="SELECT counter FROM counter";
$result=$db->query($sql);
if (!$result) die("Error querying database");
foreach ($result as $row) $counter=$row['counter'];

//Commit
$sql="COMMIT TRANSACTION";
if (!$db->exec($sql)) die("Error committing to database");

//Print result
printf("Counter is now %05d",$counter);

?> 
```

**反mysql.php：**

```
<?php

//mysql database was created with 
//CREATE TABLE counter (counter INT NOT NULL)
//INSERT INTO counter VALUES (0)

//Open database connection and select database 
$db=mysql_pconnect('127.0.0.1','redacted','redacted');
if (!$db) die("Can't open database");
if (!mysql_select_db('redacted', $db)) die("Can't select database");

//Update counter
$sql="UPDATE counter SET counter=counter+1";
$qry=mysql_query($sql,$db);
if (!$qry) die("Error updating database");

//Read value
$sql="SELECT counter FROM counter";
$qry=mysql_query($sql,$db);
if (!$qry) die("Error reading from database");
$counter=mysql_fetch_array($qry,MYSQL_ASSOC);
if (!$counter) die("Error reading result");

//Print result
printf("Counter is now %05d",$counter['counter']);

?> 
```

至于表现：**我的立场是正确的。**SQLite 实现比其他两个慢 100 倍 - 这是因为我不得不接受，除了计算 1000 次点击`START EXCLUSIVE TRANSACTION`来结束测试之外，别无其他。`ab -n 1000 -c 50 http://127.0.0.1/stackoverflow/counter/counter-sqlite.php`

我对 OP 的建议是使用 MySQL 版本 - 它速度快，并且会在操作系统崩溃时可靠地保存计数器。文件版本具有几乎相同的性能特征，但它很容易被操作系统崩溃破坏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T16:38:53.707

服务器无法自行处理。您需要自己实现文件锁定。[参考。](http://bg2.php.net/manual/en/function.flock.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T14:42:47.980

下面的代码将实现您的代码，但带有文件锁定。当一个文件不能被锁定时，它会等待半秒钟然后再试一次。

```
<?php

    $clicks = file_get_contents("clicks.txt");
    $clicks++;

    $fp = fopen("clicks.txt", "w+");

    while ( !flock($fp, LOCK_EX) ) {    
        usleep(500000); // Delay half a second
    }

    fwrite($fp, $clicks);
    fclose($fp);
    flock($fp, LOCK_UN);

    //give the count to the user
    echo "result: $clicks";

?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T12:35:20.780

您询问的行为取决于文件系统如何处理文件 i/o，而不是 PHP 本身。命令行脚本也会有同样的问题（如果它们中的许多可以同时运行）。

您的代码受到两个竞争条件的影响：文件的磁盘内容可能会在您读取文件和打开文件进行写入之间发生变化；它可能会在打开写入和实际写入（刷新）到磁盘之间发生变化。

第一个竞争条件意味着您将写入一个陈旧的值：您从 10 增加到 11，但另一个线程已经从 10 增加到 11。您失去了一次点击。第二个竞争条件更微妙：因为`w+`模式会截断文件，如果另一个线程试图在之后读取，它将读取一个空文件，并且可能认为计数为零。最后，您的文件内容可能会损坏。考虑以下事件序列：

1.  线程 1 和线程 2 都从文件中读取“8”，然后打开它进行写入（截断它）。
2.  线程 1 写入“9”，但线程 2 延迟了几毫秒。
3.  与此同时，线程 3 打开文件，读取“9”，写入“10”。
4.  最后，线程 2 唤醒，将“9”写入文件开头并退出。

结果：文件现在显示“90”。每当同时写入不同长度的数据时，这都是一个真正的问题。

**结论：**除非您可以合理地预期不会有并发访问，否则不要在磁盘文件中维护状态。如果游客很少而且相距甚远，没问题。但是，如果您的猫视频传播开来，您的计数器将被打乱，您将不得不让您的父母检查他们的服务器日志并计算您页面的点击量。

改用数据库：数据库旨在处理并发性。安排访问 MySQL 数据库（它*不需要*您的父母授予您在服务器上的重要权限）。即使不这样做，您也可以通过在您的计算机上安装一个供私人使用的数据库来了解数据库。如果您有一台 Windows 计算机，easyPHP 是一种快速下载的方式，可以帮助您自己访问私有网络服务器、php 和 MySQL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-16T16:42:56.753

在您的示例中，您可能有两个锁定问题：

*   点击次数可以重置为 0
*   点击可以被另一次点击删除

您可以使用flock 方法（http://php.net/manual/en/function.flock.php）锁定文件。如果锁定失败，则需要重试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-16T16:44:11.040

AFAIK 如果脚本同时执行，那么它不会给你两次点击，而只是一次。您最好使用数据库进行此操作。

实际上，如果您预计网站上的流量较低，那么这个脚本会做得很好。但它会在更高的负载下失败。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-23T10:29:37.083

我认为避免冲突的最好方法是使用日志系统。你可以试试这个日志库： http: [//pear.php.net/package/Log/docs/latest/Log/Log.html](http://pear.php.net/package/Log/docs/latest/Log/Log.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-20T19:43:22.663

大多数人会不同意这种方法，但是您会遇到并发请求的问题。作为一种解决方案，您可以使用独占文件锁定。

查看示例：[http ://www.php.net/manual/en/function.flock.php](http://www.php.net/manual/en/function.flock.php)

# security - Cloudfoundry 中的安全性

> ID：11065214
> 
> 赞同：1
> 
> 时间：2012-06-16T16:35:30.147
> 
> 标签：security, cloud-foundry

正如您可能知道的那样，Cloud Foundry 是云中的平台即服务提供商。有人知道该提供商的安全原则吗？它是否在其基础设施中为用户提供任何安全性？提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T16:13:38.827

Cloud Foundry 有一项名为 UAA 的服务 - 用户帐户和身份验证。

UAA 服务的文档在这里：[https ://github.com/cloudfoundry/uaa/blob/master/README.md](https://github.com/cloudfoundry/uaa/blob/master/README.md)

# html - 书（参考）微数据清单

> ID：11065217
> 
> 赞同：0
> 
> 时间：2012-06-16T16:36:00.353
> 
> 标签：html, microdata

我有一个像这样的书单

```
Title, Author(s), Publisher
Title, Author(s), Publisher
Title, Author(s), Publisher
Title, Author(s), Publisher
... 
```

在阅读了大约之后`HTML5`，`microdata`我想，如果我错了，请纠正我，这可以从一些 html5 微数据中受益，但我不确定如何设计这个书单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T16:58:10.837

一个很好的起点是来自 Google 的文档：http: [//support.google.com/webmasters/bin/answer.py](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=99170&topic=1088472&ctx=topic) ?hl=en&answer=99170&topic=1088472&ctx= topic 他们描述了所有三种可能性（微数据、微格式、RDFa）用于将元信息添加到 HTML。除此之外，他们还有测试工具，您可以在其中检查您的代码是否正确：[http ://www.google.com/webmasters/tools/richsnippets](http://www.google.com/webmasters/tools/richsnippets)

对于您的书单，最适合的应该是“产品”类型

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T16:45:04.177

我建议您查看[schema.org 上的文档，尤其是](http://schema.org/docs/gs.html)[http://schema.org/Book](http://schema.org/Book)上的书籍词汇

# android - 获取可用的音频源

> ID：11065219
> 
> 赞同：5
> 
> 时间：2012-06-16T16:36:53.973
> 
> 标签：android, android-mediarecorder

有没有办法获取在运行应用程序的设备上实现的可用音频源列表？我希望这允许用户从这些中进行选择，但是 API 似乎对此没有任何帮助。如果指定的音频源不可用，它只是回退到默认值。因此，当它们甚至可能无法工作时，将它们显示给用户是一种浪费。

还是保证所有安卓设备都实现了一定数量的这些资源？

提前致谢。

# macos - 类似全屏的 Mail.app 撰写窗格

> ID：11065220
> 
> 赞同：1
> 
> 时间：2012-06-16T16:36:58.900
> 
> 标签：macos, cocoa, osx-lion, fullscreen

如果您在 Mail.app 中以全屏方式撰写消息，您会得到一些看起来像 iPad 上的模态视图控制器的东西。但是在 OSX Lion 上的 Mail 应用程序中是什么？你如何完成这样的事情？

它是为邮件定制的吗？还是所有开发人员都可以使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T14:00:53.303

不，不幸的是没有。但我想编码并不太难。只需创建一个新窗口并使用 addChildWindow:ordered: 方法将其添加为主窗口的子窗口。您可以使用 setFrame:display:animate 来制作动画：

# css - 在 Google Chrome 中调试 CSS

> ID：11065229
> 
> 赞同：14
> 
> 时间：2012-06-16T16:37:56.357
> 
> 标签：css, debugging, google-chrome

我正在编写一些 CSS 文件，但是当我出错时，Chrome 似乎只是*默默地*忽略了我搞砸的部分，并渲染了其余部分。

这使得调试很烦人，因为我不知道出了什么问题。

那么，有没有办法让 Chrome “用大红字对我尖叫”，这样我就可以花更少的时间来查找错误并花更多的时间来修复它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-17T04:45:33.900

虽然您不能“调试” CSS，因为它不是一种脚本语言，但您可以利用 Chrome DevTools Elements 面板检查元素并查看右侧的 Styles 面板。这将使您深入了解被覆盖或忽略的样式（行抛出）。样式窗格也很有用，因为它能够实时编辑正在检查的文档，这可以帮助您解决问题。如果样式被覆盖，您可以查看 Computed Style 窗格以查看实际用于设置文档样式的 CSS。

要打开 Chrome DevTools 窗口，请在Chrome 浏览器选项卡中点击`Ctrl`++ 。（+ +对于 mac）`Shift``I``Command``Opt``I`

欲了解更多信息，请访问[https://developer.chrome.com/devtools/index](https://developer.chrome.com/devtools/index)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T16:44:20.790

由于 CSS 不是脚本语言，因此您无法正确调试它。无论如何，如果您知道哪里出了问题，您可以尝试手动调整它。

此外，您还可以在此处获得 w3c 验证器：http: [//jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)这可能会给您一些反馈

# .net - .net this.Close() 无法正常工作

> ID：11065232
> 
> 赞同：0
> 
> 时间：2012-06-16T16:38:15.960
> 
> 标签：.net, window

这是我按下按钮时的部分代码我希望关闭当前窗口并打开新窗口但当前窗口保持打开状态

```
AdminWindow window = new AdminWindow();
window.ShowDialog();
this.Close(); 
```

如果我只写`this.Close();`，当前窗口将被关闭。如何关闭当前窗口并打开我的`adminWindow`或为什么此代码不起作用？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T07:43:48.970

你可以`this.Hide();`改用。

# objective-c - 如何使用带有渐变的 UIBezierPath 绘制多点线

> ID：11065237
> 
> 赞同：0
> 
> 时间：2012-06-16T16:39:03.090
> 
> 标签：objective-c, path, drawing, line, gradient

我需要画很多线。

我正在使用 UIBezierPath 绘制线条和用于渐变的小 5x10 图案图像。这是下面的代码部分：

```
 l1 = [UIBezierPath bezierPath];
    [l1 moveToPoint:CGPointMake(76, 373)];  
    [l1 addLineToPoint:CGPointMake(940, 373)];   

    CAShapeLayer *pathLayer = [CAShapeLayer layer];
    CGRect pathRect = self.view.frame;

    path = l1;
    pathLayer.frame = self.view.bounds;
    pathLayer.bounds = pathRect;
    pathLayer.geometryFlipped = NO;
    pathLayer.path = path.CGPath;
    pathLayer.strokeColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"line1Pattern.png"]];
    pathLayer.fillColor = nil;
    pathLayer.lineWidth = 8.0f;
    pathLayer.opacity = 1;
    [pathLayer setShadowOffset:CGSizeMake(0, 5)];
    [pathLayer setShadowOpacity:0.5];
    pathLayer.lineCap = kCALineCapRound;
    pathLayer.lineJoin = kCALineJoinRound;
    [pathArray addObject:pathLayer];

    self.pathLayer = pathLayer; 
```

如果这条线是水平的（如蓝色和红色） - 一切都很好，结果很好。但是如果我画倾斜线，或者笔直然后平铺 - 结果就不行了。这是图像的链接：左侧 - 我需要什么，右侧 - 什么 mu 结果：[示例](http://i.stack.imgur.com/YRlGO.png)

所以，据我了解 - 我需要旋转渐变以匹配线条。但我无法想象如何实现这一点。

此外，有些线可能具有像此图上的之字形形式：[示例](http://i.stack.imgur.com/hVSl8.jpg)

谁能帮我解决这个问题？或者建议另一种画线的方法。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:43:50.593

您只能绘制水平线并使用变换旋转它们。但如果你需要一条曲线，那么一切都会复杂得多。

您也可以创建渐变并绘制它而不是平铺图像。

# orm - Symfony 学说 refclass：奇怪

> ID：11065243
> 
> 赞同：0
> 
> 时间：2012-06-16T16:39:46.983
> 
> 标签：orm, doctrine, symfony-1.4

我对 refClass 关系有一个奇怪的行为：

```
User:
 [.....]
MyFriends: {class: User, refClass: UserFriend, local: id_owner, foreign: id_friend, type: many}

UserFriend:
  columns:
    id_owner: {type: integer(8)}
    id_friend: {type: integer(8)}
  relations:
    Owner: {class: User, local: id_owner, foreign: id, type: one}
    Friend: {class: User, local: id_friend, foreign: id, type: one} 
```

哪里`id_owner`是朋友关系的“所有者”并且`id_friend`是朋友。但是，当我尝试获得与结果`$user->getMyFriends()`相同`$user`的结果时。

我的架构有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T20:47:37.917

友谊关系是[平等的嵌套关系](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/defining-models.html#equal-nest-relations)。您似乎缺少`equal: true`示例中的位显示。另外，你真的不需要在 refClass 中定义关系。

# c - Valgrind（在 main 下面），如何获得完整的堆栈跟踪？

> ID：11065244
> 
> 赞同：5
> 
> 时间：2012-06-16T16:39:52.860
> 
> 标签：c, debugging, gdb, stack-trace, valgrind

我有以下来自 valgrind 的堆栈跟踪。但它并没有给我完整的堆栈跟踪。

```
==2433== Invalid free() / delete / delete[] / realloc()
==2433==    at 0x402B06C: free (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==2433==    by 0x43F345B: av_freep (mem.c:172)
==2433==    by 0x5A6F4D2: (below main) (libc-start.c:226) 
```

在 gdb 中，我*想*我得到了同样的错误：

```
#5  0xb7c1345c in av_free (ptr=<optimized out>) at libavutil/mem.c:172
#6  av_freep (arg=0x88a2e48) at libavutil/mem.c:181
#7  0xb7c165c8 in av_opt_free (obj=0x88a2ba0) at libavutil/opt.c:787
#8  0xb6b56efc in avcodec_close (avctx=0x88a2ba0) at libavcodec/utils.c:1675
#9  0x0808a3e0 in encode_lavc_finish (ctx=0x8343a40) at encode_lavc.c:288
#10 0x08077d0b in exit_player_with_rc (mpctx=0x8313058, how=EXIT_EOF, rc=0)
at mplayer.c:705
#11 0x0806ced0 in main (argc=8, argv=0xbffff374) at mplayer.c:4771 
```

但是随着 gdb 跟踪一直到`main()`.

如何在 valgrind 中获取完整的堆栈跟踪，这完全有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T19:24:11.270

> 在 gdb 中，我想我得到了同样的错误

您在 GDB中没有收到*错误。*你有一个断点`av_free`，但肯定`av_free`被调用了*很多*，而且你没有提供任何证据表明这个特定的调用是触发 Valgrind 错误的那个。

*其他*一些调用很可能`av_free`实际上触发了 Valgrind 错误，并且该调用也很可能是从`atexit`处理程序执行的，Valgrind 堆栈*实际上*是一个完整的堆栈跟踪。

如果您使用的是最新版本的 Valgrind，您实际上可以使用 调试在 Valgrind 下运行的程序`--vgdb-error=1`，并将 GDB*准确地*附加到问题发生的位置。文档[在这里](http://valgrind.org/docs/manual/manual-core-adv.html#manual-core-adv.gdbserver)。

# c - 如何在 Kruskal 函数的图形上实现具有动态数据的 qsort

> ID：11065246
> 
> 赞同：1
> 
> 时间：2012-06-16T16:40:16.323
> 
> 标签：c, algorithm, graph, kruskals-algorithm

我创建了一个 Kruskal 函数，以便它可以在图形上找到最小的路径。但是我用冒泡排序做到了，我正在尝试使用 qsort 使其工作并使我的结构动态化，这样它可以让我更有效率。

使用的所有功能都可以正常工作，但如果您对此有疑问，请询问我，以便我发布。我正在使用联合查找作为`pd(dynamcc partition)`链接。

我的代码是：

```
struct _temp{
    float weight;
    int source;
    int destination;
};
typedef struct _temp Temp;

struct _graph{

    int NumberVertex;
    int NumberEdges;
    float* NeighborMatrix;
};
typedef struct _graph Graph;

struct din_part{
    int n;
    int*v;
};
typedef struct din_part PartDin;

Graph* grKruskal(Graph* g) 
{
    Graph*   tree_min = graph_Create(g->NumberVertex);
    PartDin* p = pd_Create(g->NumberVertex);
    int i, j,number_edges=0,n=0,representative;
    Temp edges[300],temp;

    for (i = 0; i < (g->NumberVertex); i++)
    {
        for (j = n; j < (g->NumberVertex); j++)
        {
            if(g->NeighborMatrix[g->NumberVertex * i + j]!=0)
            {
                edges[number_edges].weight=g->NeighborMatrix[g->NumberVertex * i + j];
                edges[number_edges].source=i;
                edges[number_edges].destination=j;
                number_edges++;
            }
        }
        n++;
    }

    if(number_edges>0){
        for(i=0; i<number_edges; i++)
        {
            int change=0;
            for(j=0 ;j<number_edges-1; j++)
            {
                if(edges[j].weight >edges[j+1].weight){        // blubble_sort
                    temp=edges[j];
                    edges[j]= edges[j+1];
                    edges[j+1]=temp;
                    change=1;

                }
            }
            if(!change)
            {
                for(i=0;i<number_edges;i++)
                {
                    if(pd_Representative(p,edges[i].source)!=pd_Representative(p,edges[i].destination))
                    {
                        representative=pd_Union(p,edges[i].source,edges[i].destination);
                        graph_InsertEdge(arvore_min,edges[i].source,edges[i].destination,edges[i].weight);
                    }
                }
                p=pd_Free (p);
                return tree_min;

            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:14:25.790

您可以使用 C 中的快速排序`qsort`功能轻松使用`<stdlib.h>`. 你不需要你的数据结构是动态的，尽管它会帮助你的程序更加灵活。

它的签名如下

```
void qsort ( void * base, size_t num, size_t size, int ( * comparator ) ( const void *, const void * ) ); 
```

`base`是要排序的向量。

`num`是向量中的元素数。

`size`是每个元素的大小，从 . 返回的那个`sizeof`。

`comparator`是一个函数指针，指向一个函数，它接收两个`void`指针并返回一个`int`. 如果第一个参数大于第二个参数，则此函数必须返回正数，否则返回负数，如果它们相等则返回 0。

在您的情况下，您可以简单地将冒泡排序部分替换为

```
 qsort((void*)edges, number_edges, sizeof edges[0], comparator); 
```

并定义`comparator`为

```
 int edge_comparator(void *ptr1, void *ptr2){
     Temp edge1 = *((Temp *)ptr1);
     Temp edge2 = *((Temp *)ptr2);
     return edge1.weight - edge2.weight;
 } 
```

# opencv - 将 cvmat 转换为 iplimage

> ID：11065249
> 
> 赞同：2
> 
> 时间：2012-06-16T16:40:42.933
> 
> 标签：opencv, iplimage

如何使用 OpenCV 在 C 中将`cvMat`矩阵转换为`IplImage`可以保存的矩阵？`cvSaveImage`

我了解了一个函数`cvGetImage(const CvArr* arr, IplImage* imageHeader)`。我知道它`arr`代表`cvMat`数组，但无法真正理解“图像标题”实际上是什么。那是存储图像的指针吗？也就是说，以下工作会起作用吗？

```
clusters = cvCreateMat( image2_size, 1, CV_32SC1 );
IplImage *kmeans;
cvGetImage(clusters, &kmeans);
cvSaveImage("kmeans.jpg", kmeans);
//clusters is the output matrix after performing k-means clustering
// on a certain image. 
```

# jquery - jQuery ajax 接受属性有什么意义？它真的有什么作用吗？

> ID：11065252
> 
> 赞同：30
> 
> 时间：2012-06-16T16:40:57.030
> 
> 标签：jquery, types, header, set, response

花了整整一个小时试图弄清楚为什么会这样（咖啡脚本）

```
$.ajax
  accepts: "application/json; charset=utf-8" 
```

完全*没有*改变接受头，而这

```
$.ajax
  dataType: "json" 
```

将接受标头正确设置为`application/json; charset=utf-8`

完全困惑，我是否遗漏了什么或者接受属性是全年愚人节的玩笑？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-16T16:45:27.163

与往常一样，[文档](http://api.jquery.com/jQuery.ajax/)是您的朋友：

> **接受**
> 
> 默认值：取决于数据类型
> 
> 在请求标头中发送的内容类型告诉服务器它将接受什么样的响应作为回报。如果接受设置需要修改，建议在 $.ajaxSetup() 方法中修改一次。
> 
> **数据类型**
> 
> 默认值：智能猜测（xml、json、脚本或 html）
> 
> 您期望从服务器返回的数据类型。如果没有指定，jQuery 将尝试根据响应的 MIME 类型推断它（XML MIME 类型将产生 XML，在 1.4 中 JSON 将产生一个 JavaScript 对象，在 1.4 中脚本将执行脚本，其他任何东西都会作为字符串返回）。可用的类型（以及作为第一个参数传递给成功回调的结果）是：
> 
> “ **xml** ”：返回一个可以通过 jQuery 处理的 XML 文档。
> 
> “ **html** ”：以纯文本形式返回 HTML；包含的脚本标签在插入 DOM 时进行评估。
> 
> “ **script** ”：将响应评估为 JavaScript 并将其作为纯文本返回。`_=[TIMESTAMP]`除非缓存选项设置为 true，否则通过将查询字符串参数 附加到 URL 来禁用缓存。注意：这会将 POST 转换为远程域请求的 GET。
> 
> “ **json** ”：将响应评估为 JSON 并返回一个 JavaScript 对象。在 jQuery 1.4 中，JSON 数据以严格的方式解析；任何格式错误的 JSON 都会被拒绝并引发解析错误。（有关正确的 JSON 格式的更多信息，请参阅 json.org。）
> 
> “ **jsonp** ”：使用 JSONP 加载到 JSON 块中。在 URL 的末尾添加一个额外 `?callback=?`的以指定回调。
> `_=[TIMESTAMP]`除非缓存选项设置为 true，否则通过将查询字符串参数 附加到 URL 来禁用缓存。
> 
> “ **text** ”：纯文本字符串。多个空格分隔的值：从 jQuery 1.5 开始，jQuery 可以将 dataType 从它在 Content-Type 标头中接收到的内容转换为您需要的内容。例如，如果您希望将文本响应视为 XML，请使用“ **text xml** ”作为数据类型。您还可以发出 JSONP 请求，将其作为文本接收，并由 jQuery 解释为 XML：“jsonp text xml”。类似地，诸如“jsonp xml”之类的速记字符串将首先尝试从 jsonp 转换为 xml，如果失败，则从 jsonp 转换为文本，然后从文本转换为 xml。

现在回到你的问题。我不熟悉 cofeescript 但与它相反的`dataType`是一个字符串，`accepts`参数是一个映射，应该像这样使用：

```
$.ajax({
    url: ...
    dataType: 'json',
    accepts: {
        xml: 'text/xml',
        text: 'text/plain'
    }
}); 
```

# python - 如何让 Pymacs 在带有 EPD python 的 Ubuntu 中工作？

> ID：11065256
> 
> 赞同：2
> 
> 时间：2012-06-16T16:41:11.693
> 
> 标签：python, ubuntu, ubuntu-12.04, enthought

EPD python 不知道寻找 Ubuntu 存储库 python 所以通过 Ubuntu 安装 Pymacs 没有帮助。另一种方法是克隆到 [Pymacs source from github] 并手动安装它[1](https://bugs.launchpad.net/python-mode/+bug/852287)。

一个干净的方法是使用`python setup.py install --user`，并且您想在 Makefile 中更改它，但这不起作用！我试过这个，它没有为原生 python 或 EPD 提供 Pymacs 模块。[您可以在此处](https://bugs.launchpad.net/python-mode/+bug/852287)和[此处](https://bugs.launchpad.net/python-mode/+bug/852293)阅读有关此问题的信息。

为了使用来自 Ubuntu 存储库的 Pymacs，我尝试放入`export PYTHONPATH=$PYTHONPATH:/usr/lib/python2.7/dist-packages/`我的 ~/.bashrc，但这导致很多 EPD 内容被本机 python 内容覆盖，因为该路径被添加到前面的 sys.path EPD 的初始路径。如果我在运行 ipython 时使用 sys.path.append 手动添加此路径，那可行，但很麻烦。

我也尝试放入`export PYTHONPATH=$PYTHONPATH:/usr/lib/python2.7/dist-packages/Pymacs`我的 ~/.bashrc，但由于某种原因，这并没有使 Pymacs 模块对 EPD 可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:41:13.287

我想出了一个似乎效果不错的解决方法。使用 安装rope、ropemode 和ropemacs 后`python setup.py install --user`，我运行了命令`ln -s /usr/lib/python2.7/dist-packages/Pymacs ~/.local/lib/python2.7/site-packages/Pymacs`。出于某种原因，EPD 显然会在启动时扫描此目录，以知道它可以访问 Pymacs 模块。我不知道为什么没有将目标目录添加到我的 PYTHONPATH 中，而这确实发生了，但这就是发生的事情。如果有人有更好的方法，请告诉我。

# java - 从 Python 调用非本地 Java 代码

> ID：11065260
> 
> 赞同：6
> 
> 时间：2012-06-16T16:41:49.380
> 
> 标签：java, python, cgi

我希望能够调用已在运行的 Java jar 中包含的某些方法等（保证它将运行）。我找到了 Jython 之类的东西，但它们似乎只能访问 Java 的本机类等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T16:47:32.547

**看看这个：[从 Python 调用 Java](https://stackoverflow.com/questions/3652554/calling-java-from-python)**

"**您也可以使用 Py4J。首页上有一个示例和大量文档，但本质上，您只需从 Python 代码中调用 Java 方法，就好像它们是 Python 方法一样：**

```
from py4j.java_gateway import JavaGateway 
```

> > > gateway = JavaGateway() # 连接到 JVM
> > > 
> > > java_object = gateway.jvm.mypackage.MyClass() # 调用构造函数
> > > 
> > > other_object = java_object.doThat()
> > > 
> > > other_object.doThis(1,'abc')
> > > 
> > > gateway.jvm.java.lang.System.out.println('Hello World!') # 调用一个静态方法

与 Jython 不同，Py4J 的一部分在 Python VM 中运行，因此它始终与最新版本的 Python “保持同步”，并且您可以使用在 Jython 上运行不佳的库（例如 lxml）。另一部分在您要调用的 Java VM 中运行。

**通信是通过套接字而不是 JNI 完成的，Py4J 有自己的协议（优化某些情况，管理内存等）** “

# java - 如何使用 ASM 添加带有初始值设定项的静态最终字段？

> ID：11065262
> 
> 赞同：5
> 
> 时间：2012-06-16T16:42:02.053
> 
> 标签：java, bytecode, java-bytecode-asm, bytecode-manipulation

我想使用 ASM 将静态最终字段添加到 .class 文件中，源文件是

```
public class Example {

    public Example(int code) {
        this.code = code;
    }

    public int getCode() {
        return code;
    }

    private final int code;

} 
```

反编译生成的类应该是这样的：

```
public class Example {

    public static final Example FIRST = new Example(1);

    public static final Example SECOND = new Example(2);

    public Example(int code) {
        this.code = code;
    }

    public int getCode() {
        return code;
    }

    private final int code;

} 
```

作为结论，我想使用 ASM 将 FIRST 和 SECOND 常量添加到 .class 文件中，我该怎么做？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-07T17:45:13.627

这个答案显示了如何使用 ASM 的访问者 api 来完成它（请参阅[ASM 主页](http://asm.ow2.org/)上的*ASM 4.0 A Java 字节码工程库*的第 2.2 节），因为它是我最熟悉的 api。ASM 也有一个对象模型 api（参见同一文档中的第二部分）变体，在这种情况下通常可能更容易使用。对象模型可能有点慢，因为它在内存中构造了整个类文件的树，但如果只有少量类需要转换，性能损失应该可以忽略不计。

当创建`static final`值不是常量（如数字）的字段时，它们的初始化实际上会转到“[静态初始化块](https://stackoverflow.com/questions/2420389/static-initialization-blocks)”。因此，您的第二个（转换后的）代码清单等效于以下 java 代码：

```
public class Example {

  public static final Example FIRST;

  public static final Example SECOND;

  static {
    FIRST = new Example(1);
    SECOND = new Example(2);
  }

  ...
} 
```

在 java 文件中，您可以有多个这样的静态 { ... } 块，而在类文件中只能有一个。java编译器自动将多个静态块合并为一个来满足这个要求。在操作字节码时，这意味着如果之前没有静态块，那么我们创建一个新块，而如果已经存在静态块，我们需要将代码添加到现有块的开头（添加比添加更容易）。

使用 ASM，静态块看起来像具有特殊名称的静态方法`<clinit>`，就像构造函数看起来像具有特殊名称的方法一样`<init>`。

在使用访问者 api 时，要知道一个方法是否已经从之前定义过，方法是监听所有的 visitMethod() 调用，并检查每个调用中的方法名称。在访问完所有方法后，调用 visitEnd() 方法，因此如果到那时还没有访问任何方法，我们知道我们需要创建一个新方法。

假设我们有一个 byte[] 格式的原始类，请求的转换可以这样完成：

```
import org.objectweb.asm.*;
import static org.objectweb.asm.Opcodes.*;

public static byte[] transform(byte[] origClassData) throws Exception {
  ClassReader cr = new ClassReader(origClassData);
  final ClassWriter cw = new ClassWriter(cr, Opcodes.ASM4);

  // add the static final fields 
  cw.visitField(ACC_PUBLIC + ACC_FINAL + ACC_STATIC, "FIRST", "LExample;", null, null).visitEnd();
  cw.visitField(ACC_PUBLIC + ACC_FINAL + ACC_STATIC, "SECOND", "LExample;", null, null).visitEnd();

  // wrap the ClassWriter with a ClassVisitor that adds the static block to
  // initialize the above fields
  ClassVisitor cv = new ClassVisitor(ASM4, cw) {
    boolean visitedStaticBlock = false;

    class StaticBlockMethodVisitor extends MethodVisitor {
      StaticBlockMethodVisitor(MethodVisitor mv) {
        super(ASM4, mv);
      }
      public void visitCode() {
        super.visitCode();

        // here we do what the static block in the java code
        // above does i.e. initialize the FIRST and SECOND
        // fields

        // create first instance
        super.visitTypeInsn(NEW, "Example");
        super.visitInsn(DUP);
        super.visitInsn(ICONST_1); // pass argument 1 to constructor
        super.visitMethodInsn(INVOKESPECIAL, "Example", "<init>", "(I)V");
        // store it in the field
        super.visitFieldInsn(PUTSTATIC, "Example", "FIRST", "LExample;");

        // create second instance
        super.visitTypeInsn(NEW, "Example");
        super.visitInsn(DUP);
        super.visitInsn(ICONST_2); // pass argument 2 to constructor
        super.visitMethodInsn(INVOKESPECIAL, "Example", "<init>", "(I)V");
        super.visitFieldInsn(PUTSTATIC, "Example", "SECOND", "LExample;");

        // NOTE: remember not to put a RETURN instruction
        // here, since execution should continue
      }

      public void visitMaxs(int maxStack, int maxLocals) {
        // The values 3 and 0 come from the fact that our instance
        // creation uses 3 stack slots to construct the instances
        // above and 0 local variables.
        final int ourMaxStack = 3;
        final int ourMaxLocals = 0;

        // now, instead of just passing original or our own
        // visitMaxs numbers to super, we instead calculate
        // the maximum values for both.
        super.visitMaxs(Math.max(ourMaxStack, maxStack), Math.max(ourMaxLocals, maxLocals));
      }
    }

    public MethodVisitor visitMethod(int access, String name, String desc, String signature, String[] exceptions) {
      if (cv == null) {
        return null;
      }
      MethodVisitor mv = super.visitMethod(access, name, desc, signature, exceptions);
      if ("<clinit>".equals(name) && !visitedStaticBlock) {
        visitedStaticBlock = true;
        return new StaticBlockMethodVisitor(mv);
      } else {
        return mv;
      }
    }

    public void visitEnd() {
      // All methods visited. If static block was not
      // encountered, add a new one.
      if (!visitedStaticBlock) {
        // Create an empty static block and let our method
        // visitor modify it the same way it modifies an
        // existing static block
        MethodVisitor mv = super.visitMethod(ACC_STATIC, "<clinit>", "()V", null, null);
        mv = new StaticBlockMethodVisitor(mv);
        mv.visitCode();
        mv.visitInsn(RETURN);
        mv.visitMaxs(0, 0);
        mv.visitEnd();
      }
      super.visitEnd();
    }
  };

  // feed the original class to the wrapped ClassVisitor
  cr.accept(cv, 0);

  // produce the modified class
  byte[] newClassData = cw.toByteArray();
  return newClassData;
} 
```

由于您的问题没有进一步说明您的最终目标是什么，因此我决定使用硬编码的基本示例来为您的 Example 类案例工作。如果您想创建正在转换的类的实例，您必须更改上面包含“Example”的所有字符串，以使用实际正在转换的类的完整类名。或者，如果您特别希望在每个转换后的类中有两个 Example 类的实例，那么上面的示例将按原样工作。

# wordpress - 谁在 wordpress 'the_date' 中添加换行符？

> ID：11065269
> 
> 赞同：0
> 
> 时间：2012-06-16T16:43:09.963
> 
> 标签：wordpress

我有这条线：

```
<?php the_date(' F j Y')?> 
```

这以`June 13 2012`（当前日期）结束。我想把这一年放在另一条线上。我试过这个：

```
<?php the_date(' F j <br /> Y')?> 
```

但它不起作用。有没有办法在两者之间取得突破。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:13:58.367

您可以在调用该函数时分隔日期的组成部分。“f”、“j”、“Y”等。al 本质上会被日期替换，因此省略“Y”将允许您在换行后的另一个函数调用中指定它。

```
echo get_the_date('F j');
echo '<br />';
echo get_the_date('Y'); 
```

Wordpress 实际上有一个很好的指南来解释格式字符：[http ://codex.wordpress.org/Formatting_Date_and_Time](http://codex.wordpress.org/Formatting_Date_and_Time)

编辑：固定使用`get_the_date`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:08:49.257

我对日期函数不太熟悉，但你可以用它`substr()`来打破你想要的，这是一个例子；

```
$date = the_date(' F j Y'); // in your example it should return : "June 13 2012"
echo substr($date,0,(count($temp)-5)); //this will echo just "June 13"
echo "<br />";
echo substr($date,-4,4); //This will echo just the year 
```

哪个会显示；

```
    6月13日
    2012

```

# mysql - Innodb：文件操作中的操作系统错误号 1117

> ID：11065272
> 
> 赞同：0
> 
> 时间：2012-06-16T16:43:31.780
> 
> 标签：mysql, mysql-error-1067

我在 Windows 7 64 位上安装了 apache 和 mysql 5.5。它工作但今天mysql无法启动，当我尝试手动启动mysql时，Windows给我这个错误“无法启动MySQL错误1067”。.
我在错误日志中看到这一行：

```
120616 16:35:47 [Note] Plugin 'FEDERATED' is disabled.
120616 16:35:48 InnoDB: The InnoDB memory heap is disabled
120616 16:35:48 InnoDB: Mutexes and rw_locks use Windows interlocked functions
120616 16:35:48 InnoDB: Compressed tables use zlib 1.2.3
120616 16:35:48 InnoDB: Initializing buffer pool, size = 103.0M
120616 16:35:48 InnoDB: Completed initialization of buffer pool
120616 16:35:48 InnoDB: highest supported file format is Barracuda.
120616 16:35:50  InnoDB: **Operating system error number 1117 in a file operation.**
InnoDB: Some operating system error numbers are described at
InnoDB: http://dev.mysql.com/doc/refman/5.5/en/operating-system-error-codes.html
InnoDB: File name .\ib_logfile0
InnoDB: File operation call: 'Windows aio'.
InnoDB: Cannot continue operation. 
```

什么是问题和 InnoDB：文件操作中的操作系统错误号 1117。?

我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T16:31:40.503

我找到这个[链接](http://imknight.net/development/cant-start-mysql-error-1067/)。我删除了数据文件夹中的 ib_logfile0 或 ib_logfile1 并且它可以工作。

# java - 为 Maven 构建的 Web 应用程序指定运行时配置参数

> ID：11065273
> 
> 赞同：1
> 
> 时间：2012-06-16T16:43:43.207
> 
> 标签：java, maven, deployment, configuration, war

我是 Maven 的新手，我想知道是否有一种合理的方法可以在构建时为 Web 应用程序指定配置信息参数。

我的意思如下。使用 Ant，我通常会创建一个文件夹（例如*config-params*），并在该文件夹中放置一些属性文件或任何其他必要的文件，并为我的应用程序将运行的环境设置正确的设置。

例如：

```
- test.jdbc.properties
- cert.jdbc.properties
- prod.jdbc.properties
- test.log4j.properties
- test.myapplication.properties
- test.web.xml

... ad nauseum 
```

*然后，在我的 ant 构建脚本中，我只是从project.properties*文件中读取了一个配置文件配置变量，它简单地指示了我想要使用的文件集（*test*、*cert*或*prod*）。

这样，当我为已知环境构建应用程序时，我不必担心检查每个可能的框架配置参数。

所以两个问题：

1.  这是否可以通过 Maven POM 以非 hackish 的方式实现？是否有处理应用程序构建这个阶段的 Maven 文档、书籍或参考资料？

2.  是否有更明智的方法将我的应用程序构建配置文件定位到特定的执行环境（测试、产品等）？我想这可能更容易引起争论，但如果有一种更简单、更优雅的方式来处理这个问题，我会全神贯注：P。

我感谢您提供的任何帮助。干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:00:26.127

我建议的第一件事是将测试环境的配置放入 src/test/resources 中，Maven 可以自动将其用于测试。生产配置应该位于 src/main/resources ，这意味着在打包和发布过程中将自动使用生产配置。其他配置目标（如 cert）意味着您需要为不同的环境再次构建应用程序。

您是否通过为不同环境生成工件的 CI 环境构建？是的，仅仅基于为每个环境分别构建应用程序的需要，基于配置文件的解决方案并不是一个好的选择。最好只构建一次具有代表不同环境的工件。让我们从这样的事情开始：

```
.
|-- pom.xml
`-- src
    |-- main
    |   |-- java
    |   |-- resources
    |   |-- environment
    |   |   |-- test
    |   |   |   `-- database.properties
    |   |   |-- qa
    |   |   |   `-- database.properties
    |   |   `-- production
    |   |       `-- database.properties
    |   `-- webapp 
```

对于每个环境，您都有一个包含不同配置部分（在本例中为属性文件）的文件夹。您需要 maven-assembly-plugin 的配置文件（适用于每个环境），如下所示：

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">

  <id>test</id>
  <formats>
    <format>war</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>
  <dependencySets>
    <dependencySet>
      <unpack>true</unpack>
      <useProjectArtifact>true</useProjectArtifact>
    </dependencySet>
  </dependencySets>
  <fileSets>
    <fileSet>
      <outputDirectory>WEB-INF</outputDirectory>
      <directory>${basedir}/src/main/environment/test/</directory>
      <includes>
        <include>**</include>
      </includes>
    </fileSet>
  </fileSets>
</assembly> 
```

当然还有这样的 maven-assembly-plugin 配置：

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-assembly-plugin</artifactId>
    <executions>
      <execution>
        <id>test</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/test.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
      <execution>
        <id>qa</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/qa.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
      <execution>
        <id>production</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/production.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

结果是只有一个构建，它为每个环境生成一个工件，如下所示：

1.  artifactId-version-test.war

2.  artifactId-version-qa.war

3.  artifactId-version-production.war

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:47:38.813

阅读有关[Maven 构建配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)的信息。

基本概念是在单个`POM`文件中创建多个构建配置，然后使用

```
mvn -P <profile-name> <targets> 
```

`<activation/>`您还可以通过定义规则让 maven 决定使用哪个配置文件。

# c# - C# DirectSound DirectSoundBuffer.SetVolume E_NOINTERFACE

> ID：11065280
> 
> 赞同：0
> 
> 时间：2012-06-16T16:44:33.387
> 
> 标签：c#, directx, directsound

我正在为我的音频库编写 DirectSound 包装器。我遇到了directsound，它工作得很好。这意味着音频播放的效果比 waveout 等效果要好得多。但现在我有一个问题。我正在尝试设置辅助缓冲区的音量。我收到一个例外，即存在 HResult E_NOINTERFACE，因为我的接口无法转换或类似的东西。这怎么可能。我有这个 Setvolume 方法的代码： void SetVolume(int lVolume);

我正在向它传递例如 -56 的值。

这里是确切的错误消息：

> “System.__ComObject”类型的 COM 对象不能转换为接口类型“AMEngine.DX.IDirectSoundBuffer”。无法执行此操作，因为对具有 IID '{279AFA85-4981-11CE-A521-0020AF0BE560} 的接口的 COM 组件上的 QueryInterface 调用由于无法执行错误：不支持此类接口（来自 HRESULT 的异常：0x80004002 (E_NOINTERFACE))。

我翻译了这个：

```
DEFINE_GUID(IID_IDirectSoundBuffer, 0x279AFA85, 0x4981, 0x11CE, 0xA5, 0x21, 0x00, 0x20, 0xAF, 0x0B, 0xE5, 0x60);

#undef INTERFACE
#define INTERFACE IDirectSoundBuffer
   DECLARE_INTERFACE_(IDirectSoundBuffer, IUnknown)
{
    STDMETHOD(QueryInterface)       (THIS_ __in REFIID, __deref_out LPVOID*) PURE;
    STDMETHOD_(ULONG,AddRef)        (THIS) PURE;
    STDMETHOD_(ULONG,Release)       (THIS) PURE;
    STDMETHOD(GetCaps)              (THIS_ __out LPDSBCAPS pDSBufferCaps) PURE;
    STDMETHOD(GetCurrentPosition)   (THIS_ __out_opt LPDWORD pdwCurrentPlayCursor, __out_opt LPDWORD pdwCurrentWriteCursor) PURE;
    STDMETHOD(GetFormat)            (THIS_ __out_bcount_opt(dwSizeAllocated) LPWAVEFORMATEX pwfxFormat, DWORD dwSizeAllocated, __out_opt LPDWORD pdwSizeWritten) PURE;
    STDMETHOD(GetVolume)            (THIS_ __out LPLONG plVolume) PURE;
    STDMETHOD(GetPan)               (THIS_ __out LPLONG plPan) PURE;
    STDMETHOD(GetFrequency)         (THIS_ __out LPDWORD pdwFrequency) PURE;
    STDMETHOD(GetStatus)            (THIS_ __out LPDWORD pdwStatus) PURE;
    STDMETHOD(Initialize)           (THIS_ __in LPDIRECTSOUND pDirectSound, __in LPCDSBUFFERDESC pcDSBufferDesc) PURE;
    STDMETHOD(Lock)                 (THIS_ DWORD dwOffset, DWORD dwBytes,
                                           __deref_out_bcount(*pdwAudioBytes1) LPVOID *ppvAudioPtr1, __out LPDWORD pdwAudioBytes1,
                                           __deref_opt_out_bcount(*pdwAudioBytes2) LPVOID *ppvAudioPtr2, __out_opt LPDWORD pdwAudioBytes2, DWORD dwFlags) PURE;
    STDMETHOD(Play)                 (THIS_ DWORD dwReserved1, DWORD dwPriority, DWORD dwFlags) PURE;
    STDMETHOD(SetCurrentPosition)   (THIS_ DWORD dwNewPosition) PURE;
    STDMETHOD(SetFormat)            (THIS_ __in LPCWAVEFORMATEX pcfxFormat) PURE;
    STDMETHOD(SetVolume)            (THIS_ LONG lVolume) PURE;
    STDMETHOD(SetPan)               (THIS_ LONG lPan) PURE;
    STDMETHOD(SetFrequency)         (THIS_ DWORD dwFrequency) PURE;
    STDMETHOD(Stop)                 (THIS) PURE;
    STDMETHOD(Unlock)               (THIS_ __in_bcount(dwAudioBytes1) LPVOID pvAudioPtr1, DWORD dwAudioBytes1,
                                           __in_bcount_opt(dwAudioBytes2) LPVOID pvAudioPtr2, DWORD dwAudioBytes2) PURE;
    STDMETHOD(Restore)              (THIS) PURE;
}; 
```

进入

```
 /// <summary>
/// Line 687 Dsound.h
/// </summary>
[ComImport, InterfaceType(ComInterfaceType.InterfaceIsIUnknown), Guid("279AFA85-4981-11CE-A521-0020AF0BE560")]
public interface IDirectSoundBuffer
{
    //IDirectSoundBuffer methods
    void GetCaps([Out, MarshalAs(UnmanagedType.LPStruct)] DSBufferCaps pDSBufferCaps); //TODO
    void GetCurrentPosition([Out] out UInt32 pdwCurrentPlayCursor, [Out] out UInt32 pdwCurrentWriteCursor);
    void GetFormat([Out, MarshalAs(UnmanagedType.CustomMarshaler, MarshalType = "AMEngine.Wave.WaveFormatMarshaler")] out AMEngine.Wave.WaveFormat pwfxFormat,
                    int dwSizeAllocated, [Out] out int pdwSizeWritten); //TODO implement
    [return: MarshalAs(UnmanagedType.I4) /*See http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx */]
    Int32 GetVolume();
    [return: MarshalAs(UnmanagedType.I4)]
    Int32 GetPan();
    [return: MarshalAs(UnmanagedType.I4)]
    Int32 GetFrequency();
    [return: MarshalAs(UnmanagedType.I4)]
    Int32 GetStatus();
    void Initialize([In, MarshalAs(UnmanagedType.Interface)] IDirectSound pDirectSound, [In] DSBufferDescription pcDSBufferDesc);
    void Lock(int dwOffset, int dwBytes,
              [Out] out IntPtr ppvAudioPtr1, [Out] out int pdwAudioBytes1,
              [Out] out IntPtr ppvAudioPtr2, [Out] out int pdwAudioBytes2,
              DSBLock dwFlags /*TODO Flags enum erstellen */);
    void Play(int dwReserved1, int dwPriority, DSBPlayFlags dwFlags); //TODO Flags enum erstellen -- Done
    void SetCurrentPosition(int dwNewPosition);
    void SetFormat([In] AMEngine.Wave.WaveFormat pcfxFormat);
    void SetVolume(int lVolume);
    void SetPan(int lPan);
    void SetFrequency(int dwFrequency);
    void Stop();
    void Unlock([In] IntPtr pvAudioPtr1, int dwAudioBytes1,
                [In] IntPtr pvAudioPtr2, int dwAudioBytes2);
    void Restore();

} 
```

使用以下代码成功创建它：

```
 DSBufferDescription secondaryBufferDesc = new DSBufferDescription();
        secondaryBufferDesc.dwBufferBytes = (uint)(bufferSize * 2);
        //http://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.reference.dsbcaps%28v=vs.85%29.aspx
        secondaryBufferDesc.dwFlags = DirectSoundBufferCaps.DSBCAPS_CTRLVOLUME |
                                      DirectSoundBufferCaps.DSBCAPS_CTRLPOSITIONNOTIFY |
                                      DirectSoundBufferCaps.DSBCAPS_GETCURRENTPOSITION2 |
                                      DirectSoundBufferCaps.DSBCAPS_GLOBALFOCUS |
                                      DirectSoundBufferCaps.DSBCAPS_STICKYFOCUS;
        secondaryBufferDesc.dwReserved = 0;
        secondaryBufferDesc.dwSize = Marshal.SizeOf(secondaryBufferDesc);
        secondaryBufferDesc.guid3DAlgorithm = Guid.Empty;
        secondaryBufferDesc.guid3DAlgorithm = Guid.Empty;

        Wave.WaveFormat format = new Wave.WaveFormat(waveFormat, waveFormat.SampleRate);
        GCHandle lpwfxSecondaryPtr = GCHandle.Alloc(format, GCHandleType.Pinned);
        secondaryBufferDesc.lpwfxFormat = lpwfxSecondaryPtr.AddrOfPinnedObject();
        //IntPtr waveFormatPtr = Marshal.AllocHGlobal(Marshal.SizeOf(waveFormat));
        //Marshal.StructureToPtr(waveFormat, waveFormatPtr, false);
        //secondaryBufferDesc.lpwfxFormat = waveFormatPtr;

        object primaryBufferObj, secondaryBufferObj;
        //http://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.idirectsound8.idirectsound8.createsoundbuffer%28v=vs.85%29.aspx
        directSound.CreateSoundBuffer(primaryBufferDesc, out primaryBufferObj, IntPtr.Zero);
        directSound.CreateSoundBuffer(secondaryBufferDesc, out secondaryBufferObj, IntPtr.Zero);

        lpwfxSecondaryPtr.Free();

        this.primaryBuffer = (IDirectSoundBuffer)primaryBufferObj;
        this.secondaryBuffer = (IDirectSoundBuffer)secondaryBufferObj; 
```

并且使用以下代码设置音量：（我传递的值是-56）没有声音= 0和maxsound = -10000

```
 private void SetCurrentVolume()
    {
        if (secondaryBuffer != null)
        {
            secondaryBuffer.SetVolume(volume);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:58:20.993

错误很简单：您用来查询另一个接口的`E_NOINTERFACE`接口指针无法为您提供。也就是说，您（或者可能是您正在使用的库）正在`IDirectSoundBuffer`从不是缓冲区对象的东西中获取信息。如果您在错误位置周围发布代码片段会很有帮助。

# windows - 当一个调用 SetWaitableTimer 的线程退出而另一个线程正在等待定时器时，定时器是否被取消？

> ID：11065281
> 
> 赞同：7
> 
> 时间：2012-06-16T16:44:40.117
> 
> 标签：windows, winapi

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms686289%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686289%28v=vs.85%29.aspx)

根据msdn，在备注部分中，它指出：“如果设置定时器的线程终止并且有关联的完成例程，则定时器被取消。但是，定时器的状态保持不变。**如果没有完成例程，然后终止线程对计时器没有影响。** ”

然后再往下，它声明：“**如果调用 SetWaitableTimer 的线程退出，定时器将被取消。这会在定时器设置为信号状态之前停止定时器并取消未完成的 APC；它不会更改定时器的信号状态。** "

因此我的问题是，如果我有一个线程调用 SetWaitableTimer 而没有关联的完成例程，另一个线程调用 WaitOnMultipleObjects（传入计时器对象句柄）并且调用 SetWaitiableTmer 的线程在此后不久退出，那么计时器对象会被取消还是仍然会变成期限到期时发出信号？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T19:54:19.413

直接从可等待计时器的实现中提供更多信息：如果您使用 CompletionRoutine，则计时器被放置在一个链表上，该链表与调用 SetWaitableTimer 的线程链接。当线程终止时，内核会遍历垂死线程的链表并取消仍在排队的计时器。

如果您不使用完成例程，则计时器永远不会添加到任何线程的链表中，因此不会在任何特定线程死亡时取消。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T17:06:39.243

文档有些不清楚。我认为你能做的最好的就是自己测试。但是，我相信只有在使用 I/O 完成例程时，计时器才会自动取消。

我可以提供一些关于 Windows APC 的“理论”背景，以证明我的（受过教育的）猜测是正确的。

APC = "异步过程调用"。在 Windows 中，每个用户模式线程都配备了一个所谓的 APC 队列，这是一个系统管理的过程队列，必须在该线程上调用。线程可能会进入所谓的“可提醒等待”状态（故意），在此期间它可能会执行该队列中的一个或多个过程。您可以手动将过程调用放入 APC 队列，或者发出一个 I/O，它在完成时会将过程调用“放入”那里。

简而言之，场景如下：您发出多个 I/O，然后等待其中任何一个完成（或失败），也许还有其他一些事件。然后，您调用其中一个警报等待函数：`SleepEx`或`WaitForMultipleObjectsEx`类似函数。

重要提示：此机制旨在支持**单线程**并发。也就是说，同一个线程发出几个 I/O，等待某事发生，然后做出适当的响应。**保证**在**同一个线程**中调用所有 APC 例程。因此 - 如果这个线程退出 - 没有办法调用它们。因此，所有未完成的 I/O 也会**被取消**。

有几个处理异步 I/O 的 Windows API 函数，但它们允许选择几种完成机制（例如`ReadFileEx`）：APC、设置事件或将完成放入 I/O 完成端口。如果这些函数与 APC 一起使用 - 如果发出线程退出，它们会自动取消 I/O。

因此，我猜想等待计时器只有在与 APC 一起使用时才会自动取消。

# java - 在 JComboBox 项中显示按钮

> ID：11065282
> 
> 赞同：7
> 
> 时间：2012-06-16T16:44:49.317
> 
> 标签：java, swing, jcombobox

我目前有一个 JComboBox 用作音频播放列表 - 我想要实现的是每个项目右侧的一个小“删除”按钮，我可以使用它从底层模型中删除它，其中圆圈是：

实现这一目标的最佳方法是什么？

我希望 JComboBox 中的所有项目的按钮都相同。

![演示截图](../Images/25ad257cfd451f5d64f52e02aedf0e11.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-19T08:48:23.507

*首先让我说这是一个有趣的问题（前一阵子+1）。*

我不得不快速尝试，亲眼看看用`JComboBox`. 我得到的结论（正如@trashgod 在上面的评论中所说）是这个对象从未被设计为具有其他组件，或者至少对我来说是这样的。

下面是一个示例，可以执行您想要的操作。你可以用它作为开始，但老实说你应该忘记使用`JComboBox`这个问题。

**下面的示例绝不是解决问题的正确方法。它只是显示了我尝试解决问题的结果。下面的代码没有保留良好的实践规则，例如它将表示与功能混合在一起（渲染器删除了元素）。这实际上只是一个黑客而不是真正的解决方案。**

```
import java.awt.*;
import java.awt.event.*;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;

public class ButtonCombo {

    private JPanel getContent() throws MalformedURLException {
        String[] ids = {"north", "west", "south", "east"};
        JComboBox combo = new JComboBox(ids);
        Icon removeIcon = new ImageIcon(new URL("http://filesharefreak.org/images/red_x.png"));
        combo.setRenderer(new ButtonComboRenderer(removeIcon, combo));
        JPanel panel = new JPanel();
        panel.add(combo);
        return panel;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                try {
                    JFrame f = new JFrame();
                    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                    JPanel panel = new JPanel();
                    panel.add(new ButtonCombo().getContent());
                    JButton button = new JButton("OKOKO");
                    panel.add(button);
                    f.setContentPane(panel);
                    f.setSize(300, 160);
                    f.setLocation(200, 200);
                    f.setVisible(true);
                } catch (MalformedURLException ex) {
                    Logger.getLogger(ButtonCombo.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        });
    }
}

class ButtonComboRenderer implements ListCellRenderer {
    Icon icon;
    JPanel panel;
    JLabel label;
    JButton button;

    public ButtonComboRenderer(Icon removeIcon, final JComboBox combo) {
        icon = removeIcon;
        label = new JLabel();
        button = new JButton(icon);
        button.setPreferredSize(new Dimension(icon.getIconWidth(), icon.getIconHeight()));
        panel = new JPanel(new BorderLayout());
        panel.add(label);
        panel.add(button, BorderLayout.EAST);
        panel.addMouseListener(new MouseAdapter() {

            @Override
            public void mousePressed(MouseEvent e) {
                if (button.getX() < e.getX()) {
                    System.out.println("button contains the click remove the item");
                    combo.removeItem(label.getText());
                }
            }
        });
    }
    //so we will install the mouse listener once
    boolean isFirst = true;

    @Override
    public Component getListCellRendererComponent(JList list,
            Object value,
            int index,
            boolean isSelected,
            boolean cellHasFocus) {
        if (isFirst) {
            isFirst = false;
            list.addMouseListener(new MouseAdapter() {

                @Override
                public void mousePressed(MouseEvent e) {
                    panel.dispatchEvent(e);
                    e.consume();
                }
            });
        }
        String text = (String) value;
        label.setText(text);
        if(text == null)
            button.setIcon(null);
        else if(button.getIcon() == null)
            button.setIcon(icon);
        panel.setBackground(isSelected ? Color.red : Color.white);
        panel.setForeground(isSelected ? Color.white : Color.black);
        return panel;
    }
} 
```

* * *

我的最终建议和我会做的方式是： **构建您自己的组件。**通过将其与触发器和表示分开来使其可扩展和可修改，其中两者都使用`JComponent`s 来反对使用渲染器。通过这种方式，您将能够在组件上捕获和提供事件，而不是在这种情况下所有事件都由`JList`用于渲染的捕获。

下面是一个可以帮助您入门的示例。这不是最终的解决方案，但它提出了制造此类组件所涉及的许多重要问题。您应该使用提供的功能并将其全部包装在一个组件中：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import javax.swing.*;

public class MockJComboBox {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                final JPanel popupContent = new JPanel(new GridLayout(0, 1));
                popupContent.setBackground(Color.GREEN);
                popupContent.add(new JLabel("Content of popupContent panel"));
                popupContent.add(new JLabel("Content of popupContent panel"));
                popupContent.add(new JLabel("Content of popupContent panel"));
                popupContent.add(new JLabel("Content of popupContent panel"));
                popupContent.add(new JLabel("Content of popupContent panel"));
                popupContent.add(new JComboBox(new Object[]{"Content of popupContent panel"}));
                final JButton popupCloseButton = new JButton("X");
                popupContent.add(popupCloseButton);

                final JScrollPane s = new JScrollPane(popupContent);
                s.setPreferredSize(new Dimension(popupContent.getPreferredSize().width + s.getVerticalScrollBar().getPreferredSize().width
                        + s.getBorder().getBorderInsets(s).left
                        + s.getBorder().getBorderInsets(s).right, 100));

                JPanel panel = new JPanel();
                panel.setPreferredSize(new Dimension(200, 200));
                final JButton popupOpenButton = new JButton();
                panel.add(popupOpenButton);
                final JFrame f = new JFrame();
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.setContentPane(panel);
                final PopupFactory popupFactory = PopupFactory.getSharedInstance();
                popupOpenButton.setAction(new AbstractAction("Open") {
                    private Popup popup;
                    private boolean isShown = false;

                    @Override
                    public void actionPerformed(ActionEvent e) {
                        if (isShown) {
                            popup.hide();
                        } else {
                            popup = popupFactory.getPopup(popupOpenButton, s,
                                    popupOpenButton.getLocationOnScreen().x, popupOpenButton.getLocationOnScreen().y + popupOpenButton.getHeight());
                            popupCloseButton.setAction(new AbstractAction(popupCloseButton.getText()) {

                                @Override
                                public void actionPerformed(ActionEvent e) {
                                    isShown = false;
                                    popup.hide();
                                }
                            });
                            popup.show();
                        }
                        isShown = !isShown;
                    }
                });
                f.pack();
                f.setVisible(true);
            }
        });
    }
} 
```

# python - 从python调用c函数

> ID：11065283
> 
> 赞同：0
> 
> 时间：2012-06-16T16:44:56.667
> 
> 标签：python

我在 c 中有代码：

```
typedef struct {
int bottom;
int top;
int left;
int right;
} blur_rect;

int bitmapblur(
char* input,
char* output,
blur_rect* rects,
int count,
int blur_repetitions); 
```

我需要使用 python 中的 bitmapblur 函数。我怎么做？关于结构数组的问题。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T16:56:38.593

您需要将您的 c 代码编译为共享库，然后使用“ctypes”python 模块与库进行交互。
我建议你[从这里开始](http://docs.python.org/library/ctypes.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:00:09.997

这也很有用：“用 C 或 C++ 扩展 Python”，从一个简单的例子开始。[你可以在这里](http://docs.python.org/extending/extending.html)找到更多关于它的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T18:09:16.560

您首先需要使用 ctypes。首先，构建一个结构：

```
import ctypes

class BlurRect(ctypes.Structure):
    """
    rectangular area to blur
    """
    _fields_ = [("bottom", ctypes.c_int),
                ("top", ctypes.c_int),
                ("left", ctypes.c_int),
                ("right", ctypes.c_int),
                ] 
```

现在加载你的函数。您需要找出共享库的最佳名称，然后加载它。您应该已经将此代码实现为 dll 或 .so 并在 ld 路径中可用。

另一个棘手的问题是您的函数有一个“输出”参数，并且该函数应将其结果写在那里。您将需要为此创建一个缓冲区。

ctypes 代码将如下所示：

```
blurlib = ctypes.cdll.LoadLibrary("libblur.so")
outbuf = ctypes.create_string_buffer(1024) # not sure how big you need this

inputStructs = [BlurRect(*x) for x in application_defined_data]

successFlag = blurlib.bitmapblur("input", 
    outbuf,
    inputStructs,
    count,
    reps) 
```

# ios - 为 iOS 构建具有 OpenGL 支持的 OpenCV

> ID：11065289
> 
> 赞同：0
> 
> 时间：2012-06-16T16:46:07.210
> 
> 标签：ios, opencv, opengl-es, building

我目前正在为盲人开发一些计算机视觉应用程序。现在我们决定将研究转移到移动应用程序上。

从 OpenCV 2.4 开始，由于有两个脚本，为 iOS 构建它们非常简单。

我面临的最大问题是处理时间。我读到 iPhone 上的大部分图像处理都是使用 OpenGL 完成的。所以我想知道在为 iOS 构建时是否有可能构建具有 OpenGL 支持的 OpenCV。

OpenCV（在 iPhone 上）中非常简单的操作的处理时间对于实时应用程序来说太长了，特别是如果专门用于需要快速反馈现实的盲人。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:16:15.057

无法为 iOS（和 OS X）构建具有 OpenGL 支持的 OpenCV。OpenCV 的构建脚本无条件禁用它。

实际上，OpenCV 中不使用 OpenGL 进行加速。因此，即使在编辑源代码后，您也不会获得任何加速。

# visual-c++ - 在基于对话框的应用程序中，我应该在哪里放置主执行循环？在 Dialog 类或 App 类中？

> ID：11065302
> 
> 赞同：0
> 
> 时间：2012-06-16T16:48:23.097
> 
> 标签：visual-c++, mfc, dialog

我正在编写一个通过串行（USB）链接与 Arduino 微控制器通信并控制它的应用程序。该应用程序是基于对话框的。我需要一个主循环来不断地向 Arduino 发送命令并接收来自 Arduino 的输入。

1.  我应该把这个主循环放在对话框类还是应用程序类中？
2.  如果在应用程序类中，那么对话框应该是无模式的吗？

一个非常简单的例子（没有 Arduino 和 USB 链接的东西）会很有帮助。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T12:16:49.840

不要将此循环放置在任何提到的对象中。这很可能会使应用程序无响应。

在 OnInitDialog 中创建一个工作线程并将循环放置在线程中。

至于示例，您应该查阅您正在使用的库的 Arduino API 文档，或者使用 VS 插件。

# php - $_SESSION[] 是否与定义的类冲突？

> ID：11065304
> 
> 赞同：0
> 
> 时间：2012-06-16T16:49:12.557
> 
> 标签：php

我叫了一堂课：

```
$user = new user; 
```

然后我定义了一个会话变量：

```
$_SESSION['user']= 'username'; 
```

在我的脚本中，如果我`$_SESSION['user']`在它显示的某些函数中使用了回显；

```
Catchable fatal error: Object of class user could not be converted to string in /home/username/public_html/cart-admin/include/classes/class.auth.php 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:06:51.593

`user`不，$_SESSION 可能永远不会与您的类的对象/实例发生冲突。

尽管您声明这是您的实际代码，但很难相信您`'username'`在脚本中进行了硬编码。;-)

假设您的实际代码如下所示：

```
$user = new user;
// ... many lines between ...
$_SESSION['user'] = $user;
// ... more lines between ...
echo $_SESSION['user']; 
```

...那么错误很容易解释。当您执行此操作时， `echo $_SESSION['user']`PHP 会尝试将此变量中引用的对象（类的对象`user`）隐式转换为字符串，以便可以打印。

要检查我是否正确，您可以在您之前插入此代码`echo`：

```
echo "session variable 'user' is of type: ", gettype($_SESSION['user']); 
```

你要么看到`.. is of type: user`我所期望的，要么你会看到`.. is of type: string`，这是你想要的。

有两种可能的解决方法：

1.  要么将用户名属性（而不是对象）存储在会话中。例如：`$_SESSION['user'] = $user->getName();`或`$_SESSION['user'] = $user->name;`
2.  在你的类中使用魔法[`__toString()`方法（见手册）](http://www.php.net/manual/en/language.oop5.magic.php#object.tostring)`user`使这种隐式转换成为可能。在`__toString()`中，只需从`user`对象内部返回用户名。

我会选择选项 1，这更重要，并且不会在会话中存储用户对象的序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:52:04.467

您的脚本似乎保存了一个名为`user`$_SESSION var 的对象。这就是您看不到`username`字符串的原因，它可能会被脚本覆盖。您必须使用另一个关键字来存储用户名。

# drupal - 根据 Ubercart 中的分类术语批量设置价格

> ID：11065305
> 
> 赞同：0
> 
> 时间：2012-06-16T16:49:20.953
> 
> 标签：drupal, drupal-6, taxonomy, product, ubercart

我需要根据 Ubercart 中的分类术语批量设置价格。因此，当我将产品“xyz”添加到具有 10 美元的“Hello”分类术语中时，该产品将为 10 美元。谢谢M的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:32:23.773

您可以创建一个[View](http://drupal.org/project/views)并使用[Views Bulk Operations](http://drupal.org/project/views_bulk_operations)模块手动执行此操作。如果要自动执行此操作，请使用[规则](http://drupal.org/project/rules)模块。很难说出确切的方式，您的问题也不清楚。根据我目前的经验，没有开箱即用的方法可以做到这一点。

# asp.net - 什么 API 解析 .NET 中的浏览器定义文件架构文件？

> ID：11065307
> 
> 赞同：1
> 
> 时间：2012-06-16T16:49:36.890
> 
> 标签：asp.net, iis-7, browser-detection, logfiles, 51degrees

我有一些带有标头信息的 IIS 日志，希望由预先存在的框架解析。我可以利用 ASP.NET 中使用[浏览器定义文件](http://msdn.microsoft.com/en-us/library/ms228122.aspx)的部分，或许与[51 度 mobi](http://blog.stevensanderson.com/2010/12/17/using-51degreesmobi-foundation-for-accurate-mobile-browser-detection-on-aspnet-mvc-3/)工具一起使用。

我应该用来分析日志文件的正确 .NET API（或类似的）是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:03:41.790

我目前正在为 51Degrees 做一些开源工作。我最近写了一篇关于使用 API 的 C 实现来解析 W3C 日志文件的文章。你可以在[这里](http://51degrees.mobi/Support/Blogs/tabid/212/EntryId/67/Gaining-Device-Statistics-from-W3C-Server-Logs.aspx?CATReferrer=1765)找到这篇文章。这是你要找的那种东西吗？希望这可以帮助。

# python - Django 模型标签

> ID：11065308
> 
> 赞同：1
> 
> 时间：2012-06-16T16:49:55.523
> 
> 标签：python, django, django-models, tags, django-admin

我正在开发一个 django 应用程序，需要在我的一个模型中添加一个标签字段。在管理界面中，我需要它像 wordpress 标记一样工作。（逗号分隔条目，自动创建新标签和自动完成）

我找到了两个标记库，`django-tagging`并且`django-taggit`，它们也都有一个自动完成扩展。

问题是它们都非常旧（上次更新是在 2 年前），没有维护，需要一些工作才能使它们跟上速度。

有没有我没有找到的好的、最近的标记模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:19:09.867

两者都很好。我在 30 多个项目中使用了 Django 标记，但还没有发现问题。有没有具体的挑战

# javascript - 每 60 秒仅启动一次事件 (JavaScript)

> ID：11065310
> 
> 赞同：1
> 
> 时间：2012-06-16T16:50:18.923
> 
> 标签：javascript

我有一个 60 秒长的视频。我正在添加一些 JavaScript 以将数据从我的视频播放器发送到 Google Analytics。我要做的是在一段时间内每 60 秒不超过一次启动一个事件。

因此，例如，用户观看 21 到 40 秒的视频，我希望只启动一个事件（而不是在 19 秒的时间内启动 19 次）。然后用户观看 41 到 60 秒的视频，我只想启动一个事件。我实际上已经弄清楚了这部分。

**问题在于时间。**因此，如果用户观看 21 到 40 秒，它就会启动一个事件。他们观看视频的其余部分并对其进行心理处理并决定“嘿，我想再次观看视频”。如果他们再次观看视频，除非他们刷新页面，否则 21 到 40 秒的事件将不会再次启动。

如何编辑我的脚本，以便在特定范围内每 60 秒仅启动一次事件？

```
<script type="text/javascript">
function Follow( minimum, maximum )
{
this.min = minimum;
this.max = maximum;
this.done = false;
}
var following = [
new Follow( 1, 20 ),
new Follow( 21, 40 ),
new Follow( 41, 60 )
]; 

player().Time(
function(event) 
{
    var gone = Number(event.secondspassed);
    for ( var t = 0; t < following.length; ++t )
    {
        var Follow = following[t];
        if ( gone >= Follow.min && gone < Follow.max )
        {
             if ( ! Follow.done )
             {
                 var range = Follow.min + " Seconds Watched ";
                 _gaq.push(['_trackEvent', range, 'Play', 'Title']);
                 Follow.done = true; 
             }
             break;
        }
    }
}
);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T16:54:21.183

使用javascript 的[setTimeout](http://www.electrictoolbox.com/using-settimeout-javascript/)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:02:00.527

您可以添加`this.last`到您的 Follow 对象并记录`Follow`上次触发的时间。

```
function Follow( minimum, maximum ){
    this.min = minimum;
    this.max = maximum;
    this.done = false;
    this.last = 0;
} 
```

然后在您的函数中，您可以检查自上次触发以来是否已经超过一分钟：

```
var Follow = following[t];
if((new Date).getTime() > Follow.last + 60000)
    Follow.done = false; 
```

最后，当您设置`Follow.done`为 true 时，还将上次触发的时间设置为当前时间：

```
Follow.done = true; 
Follow.last = (new Date).getTime(); 
```

上面的代码可以满足您的要求，但我不确定这将如何在一分钟后暂停和继续播放视频。在这种情况下，它可能还会触发该事件两次。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-16T17:03:24.750

像这样的东西可能很有用：

```
function yourFunction() {
        // Do whatever you need
        setTimeout('yourFunction()', 60000);
} 
```

# jquery - CakePHP, JQuery .load 控制器函数

> ID：11065312
> 
> 赞同：1
> 
> 时间：2012-06-16T16:50:39.430
> 
> 标签：jquery, cakephp, controller, load

我在让 Jquery 与 cakephp 配合使用时遇到了一些麻烦，我不确定问题出在哪里。

查看文件，查看/成员/index.ctp

```
<script>
  $(document).ready(function(){

    $("#place").click(function(event){
      $("#place").load('/member/jax', function(){
        alert("load successful");
      });
    });

  });

</script>
<div id="place"></div> 
```

控制器文件 Controller/MembersController

```
public function jax() {
  echo "<p>TESTTHIS</p>";
  $this->layout='ajax';
  $this->render('/Elements/test');
} 
```

并且为了完整性

测试元素 /View/Elements/test.ctp

```
<b>test element</b> 
```

当我单击 div 时，我得到“加载成功”弹出窗口，但我没有得到“

测试这个

我希望控制器打印出来，我也没有从渲染中获得“**测试元素”。**

谁能告诉我哪里出错了？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T16:57:05.903

您可以尝试以下操作：

```
$("#place").load('/members/jax',... 
```

CakePHP 中的控制器通常使用复数名称调用。所以，我认为不`members`应该`member`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-15T03:55:49.463

如果你想用视图加载完整的控制器，然后打印控制器的 URL 并通过 PHP 在 .load() 中查看

# c++ - 在 T1 和 T2 之间选择的 C++ 类型特征

> ID：11065313
> 
> 赞同：11
> 
> 时间：2012-06-16T16:50:39.743
> 
> 标签：c++, templates, metaprogramming, template-meta-programming, typetraits

我想要一个模板根据某些条件从两种类型中进行选择。例如

```
struct Base {};

template <typename T1, typename T2>
struct test
{
    // e.g. here it should select T1/T2 that is_base_of<Base>
    typename select_base<T1, T2>::type m_ValueOfBaseType;
}; 
```

当然，将条件传递给 select_base（使其通用）会很有用，但硬编码的解决方案也更容易也更好。

这是我尝试过的示例解决方案，但它始终选择 T1：http: [//ideone.com/EnVT8](http://ideone.com/EnVT8)

问题是如何实现 select_base 模板。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-16T17:07:53.860

如果您使用[`std::conditional`](http://en.cppreference.com/w/cpp/types/conditional)而不是`if_`@Matthieu 在他的回答中实现的类模板，那么您的解决方案将简化为：

```
template <typename T, typename U>
struct select_base
{
   typedef typename std::conditional<std::is_base_of<T, Base>::value, T, U>::type base_type;
}; 
```

或者简单地说：

```
template <typename T, typename U>
struct select_base : std::conditional<std::is_base_of<T, Base>::value, T, U> {}; 
```

看起来更好。

这两个解决方案之间的区别在于，在第一个解决方案中，您为嵌套类型提供了一个*程序员友好的*名称，正如我给它的那样`base_type`，而在第二个解决方案中，嵌套类型`type`看起来对程序员不友好.

请注意，在上述两种解决方案中，您必须将嵌套类型用作`select_base<T,U>::base_type`（在第一个解决方案中）或`select_base<T,U>::type`（在第二个解决方案中） - 因此，如果您使用`typename`按照自己在问题本身。

但是，如果您*改为*使用模板别名，则定义为：

```
template<typename T, typename U>
using base_type = typename std::conditional<std::is_base_of<T, Base>::value, T, U>::type; 
```

那么你可以`base_type<T,U>`在没有任何嵌套类型的情况下使用`typename`：

```
template <typename T1, typename T2>
struct test
{
   //typename select_base<T1, T2>::type m_ValueOfBaseType; //ugly!

   base_type<T1, T2>  m_ValueOfBaseType; //better
}; 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-16T17:00:36.657

**C++14**（及更高版本）：

```
template <typename T, typename U>
struct select_base:
    std::conditional_t<std::is_base_of<T, Base>::value, T, U> {}; 
```

同样，您可以改用这个：

```
template<typename T, typename U>
using select_base = std::conditional_t<std::is_base_of_v<T,Base>, T, U>; 
```

当您使用它们时，可以观察到这两种方法之间的区别。例如，在第一种情况下，如果您必须使用`::type`，而在第二种情况下，您不需要。如果任何依赖类型涉及第一种方法的使用，您也必须使用`typename`，以帮助编译器。第二种方法没有所有此类噪音，因此优于此答案中的其他方法。

另外，请注意，您也可以在 C++11 中编写类似的类型别名。

* * *

**C++11**：

```
template <typename T, typename U>
struct select_base:
    std::conditional<std::is_base_of<T, Base>::value, T, U>::type {};
//                 ^                                       ^~~~~~ 
```

* * *

**C++98**：

条件很容易：

```
template <typename bool, typename T, typename U>
struct conditional { typedef T type; };

template <typename T, typename U>
struct conditional<false, T, U> { typedef U type; }; 
```

`is_base_of`稍微复杂一些，Boost 中提供了一个实现，我不会在这里重现。

之后，请参阅 C++11。

# asp.net-mvc-3 - ASP.NET MVC 3 Razor 中的 WMD 编辑器

> ID：11065317
> 
> 赞同：3
> 
> 时间：2012-06-16T16:51:31.120
> 
> 标签：asp.net-mvc-3, razor, wmd-editor

我正在尝试使用[derobins wmd](https://github.com/derobins/wmd)编辑器和 ASP.NET MVC 3 项目。我设法添加了控件，

```
<script src="@Url.Content("~/WMD/showdown.js")" type="text/javascript"></script>
<link href="@Url.Content("~/WMD/wmd.css")" rel="stylesheet" type="text/css" />
......
        <div id="wmd-editor" class="wmd-panel">
            <div id="wmd-button-bar"></div>
            @Html.TextArea("Contents", string.Empty, new
            {
               @class = "wmd-input"
            })
            <div id="wmd-preview" class="wmd-panel"></div>
        </div>
.......
<script src="@Url.Content("~/WMD/wmd.js")" type="text/javascript"></script> 
```

但 WDM 编辑器未正确显示（没有工具栏，也没有预览）。 ![](../Images/87bfb2dcebea78aabcdfccc8aa7946d4.png)

请帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:44:32.317

根据文档，元素的 id 很重要：

> 输入文本区域
> 
> ```
> This is where you'll enter markdown.  id is "wmd-input". 
> ```

但是使用您的代码：

```
 @Html.TextArea("Contents", string.Empty, new
            {
               @class = "wmd-input"
            }) 
```

您正在设置文本的类而不是 id。试试这个：

```
 @Html.TextArea("Contents", string.Empty, new
            {
               id = "wmd-input"
            }) 
```

# php - 如果 php 值小于结果，则 MySQL 查询 SUM 结果

> ID：11065319
> 
> 赞同：0
> 
> 时间：2012-06-16T16:51:57.050
> 
> 标签：php, mysql, sum

很抱歉，很长的帖子......

我有这个表格，用户输入一个*startdate*和一个*enddate*结果将被发送到一个 PHP 文件，该文件正在生成这样的结果变量：
**PHP**

```
if(isset($_POST['user_selected_dates'])) {
    $invoice_startdate = $_POST['start_date'];
    $invoice_enddate = $_POST['end_date'];
} 
```

然后是这个讨厌的 MySQL 查询......

```
SELECT

  s.student_socialnr, s.student_lastname, s.student_firstname,
  cs.city_name,
  c.customer_name,
  scp.cpl_startdate, scp.cpl_enddate, scp.cpl_coursename, scp.cpl_pricevalue,
  SUM(scpe.scpe_days) AS total_days, scp.cpl_pricevalue * SUM(scpe.scpe_days) AS      total_invoice

 FROM studentcourseplan scp
   INNER JOIN students s ON s.student_id = scp.student_id
   INNER JOIN studentcourseplanelements scpe ON scpe.scpe_cpl_id = scp.cpl_id
   INNER JOIN cityselections cs ON cs.city_id = s.student_city_id
   INNER JOIN customers c ON c.customer_id = s.student_customer_id
 WHERE scp.cpl_startdate BETWEEN '$invoice_startdate' AND '$invoice_enddate'

 GROUP BY scp.cpl_id ORDER BY s.student_lastname ASC 
```

这将在表中输出类似这样的内容（使用 PHP `mysql_fetch_array`）：

```
+------------------+------------------+-------------------+---------------+---------------+---------------+----------------+----------------+------------+---------------+
| student_socialnr | student_lastname | student_firstname | customer_name | cpl_startdate | cpl_enddate   | cpl_coursename | cpl_pricevalue | total_days | total_invoice |
+------------------+------------------+-------------------+---------------+---------------+---------------+----------------+----------------+------------+---------------+
| 000000-0000      | Doe              | John              | A name        | 2012-06-01    | 2012-06-30    | A coursename   | 620            | 40         | 24800         |
+------------------+------------------+-------------------+---------------+---------------+---------------+----------------+----------------+------------+---------------+
| 000000-0000      | Clerksson        | Lisa              | A name        | 2012-01-05    | 2012-07-30    | A coursename   | 950            | 10         | 9500          |
+------------------+------------------+-------------------+---------------+---------------+---------------+----------------+----------------+------------+---------------+
| 000000-0000      | Derpson          | Derp              | A name        | 2012-04-01    | 2012-04-05    | A coursename   | 620            | 40         | 24800         |
+------------------+------------------+-------------------+---------------+---------------+---------------+----------------+----------------+------------+---------------+ 
```

现在我正在寻找一个可以执行以下操作的函数：为和

之间的天数创建一个值。如果该值**较小**，则列中结果的值进行计算：列* [新值的结果]并将其输出到每一行（但前提是它小于数据库中的值...）也许它可以在-query 中完成吗？我真的很想得到一些帮助。这是我第一个使用 PHP 和 MySQL 的网站，请多多包涵！谢谢。`$invoice_startdate``$invoice_enddate`

**`total_days`

`price_value`

`MySQL`** 

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T19:07:45.363

我通过在查询中添加以下代码自己解决了这个问题：

```
CASE WHEN SUM(scpe.scpe_days) > DATEDIFF('$invoice_enddate', '$invoice_startdate') THEN
 (scp.cpl_pricevalue * DATEDIFF('$invoice_enddate', '$invoice_startdate')) ELSE SUM(scpe.scpe_days) * scp.cpl_pricevalue
END AS to_invoice 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:58:03.303

我相信您正在考虑使用 MySQL IF() 和 TO_DAYS() 函数的组合。所以是这样的：

```
SELECT IF( TO_DAYS(DATE_DIFF('$invoice_enddate', '$invoice_startdate')) < total_days, price_value * ... ) as total_invoice 
```**

# cryptography - 使用 Python 加盐哈希密码（每个新密码的盐值不同）

> ID：11065325
> 
> 赞同：5
> 
> 时间：2012-06-16T16:52:56.840
> 
> 标签：cryptography, hash, salt

据我阅读和研究后的理解，使用盐的目的应该是为每个要存储的密码使用不同的盐。

如果使用相同的盐来存储所有密码，我可以理解如何实现这一点，因为我可以将盐存储到一个常量私有变量并使用它。但是，事实并非如此。

虽然用新的不同盐存储每个新密码是非常有意义的，但是我怎么知道哪个用户的密码与哪个盐相关联？我想到的快速解决方案是将盐与用户的表属性一起存储，可能称为“盐”，但是如果太容易从中找到盐，那也会失去从一开始就有盐的目的数据库。

任何人都可以对此提出建议吗？

注意：我使用 Python 内置库 ( [hashlib](http://docs.python.org/library/hashlib.html) ) 或 Bycrypt ( [Cryptacular](http://pypi.python.org/pypi/cryptacular)或[Passlib](http://packages.python.org/passlib/) )

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T16:54:17.637

> 我想到的快速解决方案是将盐与用户的表属性一起存储

这正是你所做的。知道盐并不会真正减损它们的好处：

*   数据库中相同的密码将具有不同的哈希值。
*   彩虹表不起作用。
*   *尝试与您的任何*哈希匹配的蛮力攻击将被减慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T21:24:44.830

如果您正在使用`cryptacular.bcrypt.BCRYPTPasswordManager`，那么您无需担心盐分。它负责使用哈希生成和存储盐。

您可以在下面看到相同密码的哈希字符串不同。这意味着已经使用了盐。

例如：

```
>>> import cryptacular.bcrypt
>>> crypt = cryptacular.bcrypt.BCRYPTPasswordManager()
>>> crypt.encode('aaa')
'$2a$10$B0czYdLVHJG4x0HnEuVX2eF7T9m1UZKynw.gRCrq8S98z84msdxdi'
>>> crypt.encode('aaa')
'$2a$10$Ni7K.pQoal3irbGmREYojOYoi0lye/W0Okz7jqoynRJhW5OCi8Upu' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T16:57:54.910

没有密码的目的只是为了避免简单的字典攻击。TMHO 在许多应用程序中只有一个哈希用于所有密码。

例如，假设：上帝、太阳和爱是通用密码。任何攻击者都可以拥有包含这些单词的字典并且有哈希。

如果不是存储哈希（密码），而是存储哈希（密码+盐）（或哈希（盐+密码）），您可以使这个字典攻击无效，因为如果您的盐是 'dza$^"é)àù'字典包含 'dza$^"é)àùgod' 往往为 0。

在每个输入处更改盐也可能是一个好习惯（但我认为不那么常见），但您必须找到如何检索它以检查密码。

# c - 全局变量上的 Linux 计时器

> ID：11065326
> 
> 赞同：2
> 
> 时间：2012-06-16T16:53:00.817
> 
> 标签：c, timer, locking

我在互联网上找到了下面的代码，我试图了解 Linux 计时器是如何工作的，无论如何，正如您在 counter1 下方看到的那样，它是全局变量，如果 while 正在工作并且计时器关闭并更改会发生什么counter1 的值，我需要锁在那里吗？

```
// timertst1.c: Simple timer demo program. Use cross-gcc 
// Vers. 1.00 - 21.Oct. 2002
// k.d.walter@t-online.de

#include <stdio.h>
#include <string.h>
#include <signal.h>
#include <sys/time.h>

// This is a timer handler.
int counter1 = 0;
void timerHandler (int signum)
{
   printf ("timerHandler: counter= %d\n", counter1++);
   fflush (stdout);
}

// This is the one and only main function.

int main (void)
{
   struct sigaction sa;
   struct itimerval timer;

   // Install the timer handler...

   memset (&sa, 0, sizeof (sa));
   sa.sa_handler= &timerHandler;
   sigaction (SIGALRM, &sa, NULL);

   // Configure the timer to expire every 100 msec...

   timer.it_value.tv_sec= 0;            // First timeout
   timer.it_value.tv_usec=  500000;
   timer.it_interval.tv_sec= 0;         // Interval
   timer.it_interval.tv_usec= 500000;

   // Start timer...

   setitimer (ITIMER_REAL, &timer, NULL);   setitimer (ITIMER_REAL, &timer, NULL);
   // Do noting...

   while (1) {
       printf("i'm here waiting to be interuppted = %d\n",counter1);
       //some work;
       counter1++;
       //some other work;
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T21:16:28.313

您还可以考虑使用`sig_atomic_t`用于从信号处理程序与程序的其余部分进行安全通信。但是，这在您发布的示例中不起作用，因为读取、递增和存储值不是原子操作。

在这里，您可以看到 GLIBC 手册的摘录解释`sig_atomic_t`：

> 为避免中断对变量的访问的不确定性，您可以使用始终为原子访问的特定数据类型：sig_atomic_t。读取和写入这种数据类型保证在一条指令中发生，因此处理程序无法在访问的“中间”运行。
> 
> sig_atomic_t 类型始终是整数数据类型，但它是哪一种，以及它包含多少位，可能因机器而异。
> 
> — 数据类型：sig_atomic_t 这是一个整数数据类型。这种类型的对象总是以原子方式访问。
> 
> 在实践中，您可以假设 int 是原子的。你也可以假设指针类型是原子的；这很方便。这两个假设在 GNU C 库支持的所有机器和我们知道的所有 POSIX 系统上都是正确的。

这里有一个使用示例：

```
 #include <signal.h>
 #include <stdio.h>
 #include <stdlib.h>

 /* This flag controls termination of the main loop. */
 volatile sig_atomic_t keep_going = 1;

 /* The signal handler just clears the flag and re-enables itself. */
 void catch_alarm (int sig) {
   keep_going = 0;
   signal (sig, catch_alarm);
 }

 void do_stuff (void) {
   puts ("Doing stuff while waiting for alarm....");
 }

 int main (void) {
   /* Establish a handler for SIGALRM signals. */
   signal (SIGALRM, catch_alarm);

   /* Set an alarm to go off in a little while. */
   alarm (2);

   /* Check the flag once in a while to see when to quit. */
   while (keep_going)
     do_stuff ();

   return EXIT_SUCCESS;
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T18:04:45.543

信号处理程序很危险。操作系统将中断您的程序，无论它在做什么，并运行处理程序；当处理程序返回时，操作系统会将您的程序带回它正在执行的操作。

假设它`counter1++`被编译为加载、增量和存储。如果在加载和存储之间触发中断，那么指令序列将是加载、加载、递增、递增、存储、存储。变量将增加一，而不是二；灾难！你是对的，这看起来像是一个经典的多线程问题。

如果我们添加一个锁会发生什么？现在不是加载、增量、存储，而是锁定、加载、增量、存储、解锁。但是如果信号在我们处于锁定和解锁之间时触发，操作系统会将我们直接跳转到处理程序中——它不会让我们的代码首先解锁。当处理程序尝试锁定时，main() 仍然持有锁定，所以我们死锁。灾难！

安全的做法是编写您的信号处理程序，以便它只记下必须做的事情，并编写代码来处理在其他地方实际执行的操作。但即使这样也不一定简单 - 如果您的信号处理程序本身被中断怎么办？在这种特殊情况下不是问题，但值得考虑一个兔子洞有多深的例子。编写正确的信号处理程序很难。有一些技巧，例如您可以[阻止信号处理程序](http://www.gnu.org/software/libc/manual/html_node/Blocking-Signals.html)。但这仍然很难。

# ruby-on-rails-3 - Rspec：如何在运行测试时抑制警告和通知？

> ID：11065328
> 
> 赞同：10
> 
> 时间：2012-06-16T16:53:06.340
> 
> 标签：ruby-on-rails-3, postgresql, rspec2, rails-postgresql

我之前使用的是 Mysql 数据库并决定切换到 Postgresql，现在，当我使用 rspec 运行测试时，我收到了很多警告和通知。

```
WARNING:  there is already a transaction in progress
NOTICE:  there is no transaction in progress
      should has link "Suspender"
WARNING:  there is already a transaction in progress
NOTICE:  there is no transaction in progress
      should has css "title" with text "Suspensão de anúncio"
WARNING:  there is already a transaction in progress
NOTICE:  there is no transaction in progress
      should has css "h1" with text "Awesome job!" 
```

我怎么能压制它？有没有办法，对吧？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-17T04:27:00.220

您是否设置：`config.use_transactional_examples = true`为 false 并查看是否会破坏任何内容？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T20:05:59.477

我已经`config.use_transactional_fixtures = true`定了。这是默认设置（使用 生成的 spec_helper `rails g rspec:install`）。我使用的是 FactoryGirl 而不是固定装置，摆脱了这个设置删除了警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T19:28:15.880

> 禁用事务
> 
> 如果您更喜欢自己管理数据，或者使用其他工具（如 database_cleaner）为您完成，只需告诉 RSpec 告诉 Rails 不要管理事务：
> 
> RSpec.configure 做 |config| config.use_transactional_fixtures = 假结束

[https://www.relishapp.com/rspec/rspec-rails/docs/transactions](https://www.relishapp.com/rspec/rspec-rails/docs/transactions)

# javascript - 在 SVG 中显示流动运动的最佳方式？

> ID：11065334
> 
> 赞同：6
> 
> 时间：2012-06-16T16:53:23.807
> 
> 标签：javascript, html, svg, inkscape

我想创建一个显示流动流体等内容的网页。为此，我想使用 SVG 图形，其中（重复）运动的开始和停止是通过 JavaScript 控制的。

这个动作可以通过这种手绘 GIF 的方式轻松显示：
![在此处输入图像描述](../Images/6803a10f8300dbd286fba314e4f3d8c1.png)

但是我怎样才能通过简单的方式在 SVG 中获得这样的外观呢？特别是因为这也必须在拐角处流动，即不仅需要线性运动......

最好已经（半自动）在 Inkscape 中创建......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-17T12:20:10.887

好的，现在我找到了问题“第一”部分的答案，即**上面的“流程”**：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   version="1.1"
   width="202"
   height="32"
   id="svg2">
  <g id="layer1">
    <path
       d="m 1,16 200,0"
       id="path1"
       style="stroke:#000000;stroke-width:30" />
    <path
       d="m 1,16 200,0"
       id="path2"
       style="stroke:#ff0000;stroke-width:20" />
    <path
       d="m 1,16 200,0"
       id="path3"
       style="stroke:#000000;stroke-width:16;stroke-dasharray:48, 48;stroke-dashoffset:10.6" />
  </g>
</svg> 
```

这是在 Inkscape 中创建的（+ 之后手动简化以仅发布相关内容），只需复制一条不同宽度的线，一条非常大的（`id=path1`）黑色用于周围，一条大线（`id=path2`）用于红色流体`id=path3`稍后将用于动画的小虚线 ( )。

现在剩下要做的就是`stroke-dashoffset`通过 JavaScript 或 CSS 动画更改属性，因为这将移动小条以指示流动。例如：

```
 <style type="text/css">  
      @keyframes move {  
        from {  stroke-dashoffset: 0;  }  
        to   {  stroke-dashoffset: 96;  }  
      }  
      @-moz-keyframes move {  
        from {  stroke-dashoffset: 0;  }  
        to   {  stroke-dashoffset: 96;  }  
      }  
      @-webkit-keyframes move {  
        from {  stroke-dashoffset: 0;  }  
        to   {  stroke-dashoffset: 96;  }  
      }  
  </style> 
```

然后在`<path id="path3">`元素中：

```
 animation-duration: 3s;  
  -moz-animation-duration: 3s;  
  -webkit-animation-duration: 3s;  
  animation-name: move; 
  -moz-animation-name: move; 
  -webkit-animation-name: move; 
  animation-timing-function: linear; 
  -moz-animation-timing-function: linear; 
  -webkit-animation-timing-function: linear; 
  animation-iteration-count: infinite;
  -moz-animation-iteration-count: infinite;
  -webkit-animation-iteration-count: infinite; 
```

注意：路径可以是任何形状，不需要是直的 :)

**较低的流量：**
通过使用[http://owl3d.com/svg/tubefy/articles/article3.html](http://owl3d.com/svg/tubefy/articles/article3.html)的想法，我还找到了“较低流量”的解决方案（更好：解决方法）。这个想法只是多次克隆路径并使用相互绘制的不同颜色的破折号。动画如上。现在可以在以下位置看到两者：http: [//jsfiddle.net/pXkvD/2](http://jsfiddle.net/pXkvD/2)

# mips - MIPS 基本解释

> ID：11065335
> 
> 赞同：0
> 
> 时间：2012-06-16T16:53:41.027
> 
> 标签：mips

我是 MIPS 的新手，我正在使用 QtSpim。

在我的第一个示例中，控制台打印 5。

```
li $a0, 5
li $v0, 1
syscall 
```

在这个例子中，它将打印*hello*

```
str: .asciiz "hello"

li $v0, 4
la $a0, str
syscall 
```

当我将示例 1 中的*1*更改为*4*时，我没有得到*5*结果。
当我在示例 2 中将 4 更改为 1 时，结果我没有得到*你好*。

**1** in的目的是什么

```
li $v0, 1 
```

4 in 的目的是什么

```
li $v0, 4 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:00:46.313

系统调用根据中的值调用不同的函数`$v0`：1 代表 print-int，4 代表 print-string。它们打印使用`li`（立即加载）指令存储的值`$a0`。有关详细信息，请参阅[有关 MIPS 的教程](http://logos.cs.uic.edu/366/notes/mips%20quick%20tutorial.htm)。

# c++ - 生成注释以解释 C++ 程序的结构

> ID：11065336
> 
> 赞同：1
> 
> 时间：2012-06-16T16:54:05.070
> 
> 标签：c++, syntax, comments

是否有任何（合理）直接的方法来生成注释来解释 C++ 程序的结构？例如，我想将此代码作为输入：

```
int main(){
cout << "Hello World!";
return 0;
} 
```

并将其作为输出生成：

```
int main(){
//create a function called main that returns an integer and takes no parameters.
cout << "Hello World!";
//print the string "Hello World" to the standard output.
return 0;
//the function main returns 0
} 
```

如果可以做到这一点，它可能会使（任何 C++ 程序的语法）对初学者来说稍微不那么令人生畏。

如果 C++（使用现有工具）无法做到这一点，那么（任何类似的工具）是否可用于其他编程语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:30:25.183

有解释声明的工具（和[http://cdecl.org/](http://cdecl.org/)`cdecl`的在线版本）。看一看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:10:13.933

您的示例非常冗长，只会使任何源代码完全不可读。有一些解决方案不那么冗长但更相关，比如我听说很受欢迎的 www.doxygen.org/。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:05:59.137

您在评论中添加的内容没有多大意义 - 函数返回整数或不带参数的事实通过函数原型是不言自明的。但是，如果您通常指的是解释功能如何工作的自动注释工具，那么有些东西。

我不确定这是否适用于 C++，因为它适用于 C#，但有一个名为 GhostDoc 的 Visual Studio 插件，它根据变量/函数/等名称等生成“人类语言”注释。您可以在这里看到它的实际效果：[http](http://www.youtube.com/watch?v=4aA4VZoVDQw) ://www.youtube.com/watch?v=4aA4VZoVDQw （视频的第二部分）。

即使它不能完全解决您的问题，也许它会给您提示要查找的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T17:10:18.100

如果我很好地理解了您的问题，您会想要一个通过在每一行中注入适当的文档来“解释”代码的工具。

据我所知，正如您对初学者所说的那样，并且要在现有代码上运行它，以这种方式编写代码完全没用（这就是您投票失败的原因）。

这些注释只是现有代码的重复，因此完全没用。如果您更改代码而不更改注释会发生什么？最糟糕的是，如果您再次运行您的工具，您是希望它删除旧评论还是同时保留它们？

好的注释应该为代码添加有用的信息（如编码意图，或避免的技巧等），但大声阅读代码只是噪音。

所以要回答你的问题，我认为不，没有工具可以做到这一点。但是，某些 IDE 可能会提供类似的功能，您可以在将鼠标悬停在代码行上时在工具提示上获得此类信息，但绝对不能作为代码中的注释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-16T17:14:03.730

也许您正在寻找的是文学编程？[http://www-cs-faculty.stanford.edu/~uno/cweb.html](http://www-cs-faculty.stanford.edu/~uno/cweb.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-16T17:30:43.433

注释不应描述代码将做什么。评论应该解释，

*   意图是什么，必须执行哪个任务
*   程序员期望什么，为什么要采用特定的分支
*   为什么程序员以这种方式编写代码

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-16T20:40:59.080

在我看来，其意图并不是要在程序中实际包含此类评论。只是为了让初学者有办法问“这个语法是什么意思？” 针对特定事物有一些有限的解决方案，例如声明语法的 cdecl.org，但没有通用的解决方案。这不会是微不足道的。也许可以在 Clang 库之上相对容易地（仅相对地）构建一些东西来处理 c++。

# java - 方法是否重载了一种形式的多态性或其他形式？

> ID：11065339
> 
> 赞同：4
> 
> 时间：2012-06-16T16:54:16.627
> 
> 标签：java, oop, overloading

我有一个长期的疑问。有人可以告诉我方法重载是多态的一种形式还是完全不同的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T16:56:41.740

方法**重载**只是一种语法糖，允许您拥有具有相同名称但不同参数的方法。它与多态性无关。方法重载通常用于定义两个接受不同参数的方法，例如：

```
public void println(boolean x) //...
public void println(char x) //... 
```

或跳过某些参数并使用一些默认值：

```
public String substring(int beginIndex) //...
public String substring(int beginIndex, int endIndex) //... 
```

另一方面，方法**覆盖是继承的基础，与多态性关系更密切。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T17:37:51.783

**多态性**，字面意思是具有**多种行为的事物。**

在java中，我们可以拥有静态多态和运行时多态。

**重载**是静态多态性，因为它通过传递不同的参数来允许不同的行为。但这仅在编译时解决，因此是静态的。

**重写**, 是动态多态性，因为对函数的实际调用取决于调用它的对象的类型，它仅在运行时可用，因此是动态的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-16T16:57:40.443

不它不是。

通过*重载*，您只需提供具有不同签名的相同方法名称的不同实现。

由于*多态性*（通过子类型化）需要相同的签名（由方法名称或参数生成），因此这两个东西永远不会相交。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-16T16:56:30.107

不，不是，它是方法重载。

java通过接口进行多态性。它没有多重继承。

但是，您可以通过使用多个接口和复合/委托模式来模拟多个继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-16T16:56:43.507

不，它与面向对象编程无关。重载只是意味着您可以为不同的方法签名使用相同的名称。

# java - JWindow的窗口不动

> ID：11065343
> 
> 赞同：0
> 
> 时间：2012-06-16T16:54:37.020
> 
> 标签：java, swing, jwindow

我有一个框架从`JWindow`（因为我想处理我的 X 和 - 按钮）延伸，所以我不希望它被装饰。我的问题是当我运行应用程序时，我无法拖动我的窗口 - 它固定在某个位置。我的代码如下（我的类很大，所以我选择了相关部分）：

公共类 StatisticsMainFrame 扩展 JWindow{

```
public StatisticsMainFrame()
{
     bodyPane = new JPanel();
    bodyPane.setLayout(new BoxLayout(bodyPane, BoxLayout.X_AXIS));
    sideBannerPane = new JPanel(); // program banner
    buttonsPane = new JPanel(); // contains buttons
    contentPane = new JPanel();
    contentPane.setBorder(BorderFactory.createEtchedBorder(EtchedBorder.LOWERED));
    contentPane.setPreferredSize(new Dimension(500,500)); 
    // contentPane contains some panel for display data

    Container container = new Container();
    container.setLayout(new BoxLayout(container, BoxLayout.X_AXIS));
    container.add(Box.createVerticalGlue());
    container.add(sideBannerPane);
    container.add(buttonsPane);
    container.add(contentPane);

    Container cont = new Container();
    cont.setLayout(new BoxLayout(cont, BoxLayout.Y_AXIS));
    //cont.add(Box.createHorizontalGlue());
    //cont.add(custDecorationPane);
    cont.add(container);
    add(cont);
    // Adding Panes

    setAlwaysOnTop(true);
    //setUndecorated(true);
    pack();

}

public static void main(String[] arg)
{
    new StatisticsMainFrame().setVisible(true);
}

private CustomFrameDecorationButtons custDecorationPane;
private JPanel bodyPane;
private JPanel contentPane;
private JPanel sideBannerPane;
private JPanel buttonsPane;

// buttonsPane components
private JLabel general_lbl;
private JLabel Diagnosis_lbl;
private JLabel chemotherapy_lbl;
private JLabel radiotherapy_lbl;
private JLabel surgery_lbl;
private JLabel hermonalTherapy_lbl;

private RootButton generalStatistics_btn;
private RootButton statOfAffectedSys_btn;
private RootButton statOfGrade_btn;
private RootButton statOfCombinations_btn;
private RootButton statOfResponses_btn;
private RootButton statOfRadiotherapy_btn;
private RootButton statOfSurgery_btn;
private RootButton statOfHermonaltherapy_btn;

private GeneralStatisticsContentPanel generalStatPane;
private StatisticsOfAffectedSystemPanel2 statOfAffectedSysPanel2;
private StatisticsOfGradePanel statOFGradingPanel;
private ChemotherapyCombinationStatisticsPanel statChemotherapyCombinationPanel;
private ChemotherapyResponseStatisticsPanel statChemotherapyResponsePanel;
private RadiotherapyStatisticsPanel radiotherapyPanel;
private SurgeryStatisticsPanel surgeryStatPanel;
private HermonaltherapyStatisticsPanel hermonaltherapy; 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T18:38:25.757

您可以使用例如以下代码添加自定义拖动：

```
addMouseMotionListener(new MouseMotionListener() {
    private int mx, my;

    @Override
    public void mouseMoved(MouseEvent e) {
        mx = e.getXOnScreen();
        my = e.getYOnScreen();
    }

    @Override
    public void mouseDragged(MouseEvent e) {
        Point p = StatisticsMainFrame.this.getLocation();
        p.x += e.getXOnScreen() - mx;
        p.y += e.getYOnScreen() - my;
        mx = e.getXOnScreen();
        my = e.getYOnScreen();
        StatisticsMainFrame.this.setLocation(p);
    }
}); 
```

如果将此代码段直接放在构造函数中，`StatisticsMainFrame`则可以使用鼠标通过单击窗口内的任意位置来拖动窗口。（您也可以将侦听器添加到任何其他组件。）

# mysql - 跨会话保留 MySQL 缓存

> ID：11065346
> 
> 赞同：0
> 
> 时间：2012-06-16T16:55:24.973
> 
> 标签：mysql

我有一个执行大型 MySQL 语句的 Python 程序。即使在 Python 程序终止后，我如何告诉 MySQL 保留缓存，以便下次运行 Python 程序时结果将被缓存？

现在，每次我运行 Python 脚本时，即使我运行的是完全相同的查询，也需要永远检索结果。我已经将我的`query_cache_size`and`query_cache_limit`设置为大于结果集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:37:48.110

不幸的是，没有选项可以指示 MySQL 引擎将某些特定的查询结果保存在缓存中。你需要自己实现一个。

您可以将查询结果保存在“缓存”表中（但不能保存在`TEMPORARY`表中，因为此类表只能从创建线程访问，并且在连接关闭时会被删除）。

然后，您将`TRIGGERS`在基础表上进行设置，当任何此类表被更新时，这将清除缓存。或者，您可以简单地将 a 添加`TIMESTAMP`到缓存数据中，并在任意时间跨度后认为它已过时。如果您能负担得起从缓存中获取稍微过时的数据，则后一种选择更便宜。

但是，解决方案可能是您需要优化查询或结构，以加快查询速度。

[编辑]

实际上，有一种（扭曲的）方法可以做到这一点。您可以将[`query_cache_type`](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_query_cache_type)server 选项设置为 2，以便仅[`SQL_CACHE`](http://dev.mysql.com/doc/refman/5.5/en/query-cache-in-select.html)缓存使用关键字的查询。这允许对缓存哪些查询进行非常精细的控制。使用使您的`query_cache_size`大小足以容纳每个查询的每个结果`SQL_CACHE`，并且您确定不会覆盖任何结果。但是你必须自己管理所有缓存......

# javascript - 在 Firefox 中使用工具栏按钮库

> ID：11065351
> 
> 赞同：0
> 
> 时间：2012-06-16T16:56:24.350
> 
> 标签：javascript, html, firefox, firefox-addon

我想将弹出框图标添加到 URL 栏旁边的区域，就像 Firebug 图标所在的位置一样。这样做的库，（由先前的答案推荐：[导航栏上的 Firefox 扩展图标使用附加组件构建器](https://stackoverflow.com/questions/9621253/firefox-extension-icon-on-the-navigation-bar-using-the-add-on-builder)）

如何在我的 Firefox 扩展中使用该库？该图标现在位于 FF 窗口的右下方，而且非常小。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T11:50:11.213

下载这个包： [https ://github.com/voldsoftware/toolbarbutton-jplib](https://github.com/voldsoftware/toolbarbutton-jplib)

添加`toolbarbutton.js`到您的 Lib 文件夹。此外，您可能还想添加`listen.js`and `unload+.js`。（依赖项）

在函数中添加以下代码`exports.main`：

```
// create toolbarbutton
var tbb = toolbar.ToolbarButton({
    id: "TBB-TEST",
    label: "TBB TEST",
    onCommand: function () {
        tbb.destroy(); // kills the toolbar button
    }
});

if (require('self').loadReason == "install") {
    tbb.moveTo({
        toolbarID: "nav-bar",
        forceMove: false // only move from palette
    });
} 
```

默认情况下，这会将一组新图标添加到导航工具栏。去搞清楚 ：）

# ruby-on-rails - 在 Rails 中使用 oauth2 创建谷歌联系人

> ID：11065353
> 
> 赞同：2
> 
> 时间：2012-06-16T16:56:31.090
> 
> 标签：ruby-on-rails, oauth-2.0, contacts

最近几天我一直在为这个问题挠头，所以我希望有人能帮助我，因为我不知道在哪里挖掘。正如标题所说，我正在使用omniauth google oauth2进行身份验证的项目。这部分从一开始就工作正常。下一部分是在 google 联系人 api 中创建联系人，但它不起作用。

由于要生成的 xml/atom 有点重，我决定使用 xml 视图并使用 render_to_string 在我的控制器中检索它。因为我对rails不太了解，所以我只是认为这样生成会更干净。这工作正常。

所以这是我的 oauth2 调用：

```
strxml = render_to_string( :partial => 'createInGoogle', :layout => false )
response = access_token.post('/m8/feeds/contacts/default/full', params: {:body => strxml, :header => 'Content-type: application/atom+xml;GData-Version: 3.0'}) 
```

当我调试该调用时，我可以看到生成的 url 看起来像

```
"https://www.google.com/m8/feeds/contacts/default/full?body=%3Catom%3Aentry+xmlns%3Aatom%3D%27http%3A%2F%2Fwww.w3.org%2F2005%2FAtom%27+xmlns%3Agd%3D%27http%3A%2F%2Fschemas.google.com%2Fg%2F2005%27%3E%0A%3Catom%3Acategory+scheme%3D%27http%3A%2F%2Fschemas.google.com%2Fg%2F2005%23kind%27+term%3D%27http%3A%2F%2Fschemas.google.com%2Fcontact%2F2008%23contact%27%2F%3E%0A%3Cgd%3Aname%3E%0A%3Cgd%3AgivenName%3EPhilippe+Henri+Raymond%3C%2Fgd%3AgivenName%3E%0A%3Cgd%3AfamilyName%3EMichel+%3C%2Fgd%3AfamilyName%3E%0A%3Cgd%3AfullName%3EPhilippe+Henri+Raymond+Michel+%3C%2Fgd%3AfullName%3E%0A%3C%2Fgd%3Aname%3E%0A%3Catom%3Acontent+type%3D%27text%27%3ENotes%3C%2Fatom%3Acontent%3E%0A%3Cgd%3Aemail+rel%3D%27http%3A%2F%2Fschemas.google.com%2Fg%2F2005%23work%27+primary%3D%27true%27+address%3D%27fifoooo%40gmail.com%27+displayName%3D%27Philippe+Henri+Raymond+Michel+%27%2F%3E%0A+++++++++++++++++++++++++++++++++++++%C3%A9%0A%3Cgd%3AphoneNumber+rel%3D%27http%3A%2F%2Fschemas.google.com%2Fg%2F2005%23work%27+primary%3D%27true%27%3E%0A04442453369%0A%3C%2Fgd%3AphoneNumber%3E%0A%3Cgd%3AphoneNumber+rel%3D%27http%3A%2F%2Fschemas.google.com%2Fg%2F2005%23work%27+primary%3D%27true%27%3E%0A%2B33662473369%0A%3C%2Fgd%3AphoneNumber%3E%0A%3Cgd%3AstructuredPostalAddress+rel%3D%27http%3A%2F%2Fschemas.google.com%2Fg%2F2005%23work%27+primary%3D%27true%27%3E%0A%3Cgd%3Acity%3ESausset+les+pins%3C%2Fgd%3Acity%3E%0A%3Cgd%3Astreet%3E9+Avenue+G%C3%A9n%C3%A9ral+de+Gaulle+%3C%2Fgd%3Astreet%3E%0A%3Cgd%3Apostcode%3E13960%3C%2Fgd%3Apostcode%3E%0A%3Cgd%3AformattedAddress%3E%0A9+Avenue+G%C3%A9n%C3%A9ral+de+Gaulle++13960+Sausset+les+pins%0A%3C%2Fgd%3AformattedAddress%3E%0A%3C%2Fgd%3AstructuredPostalAddress%3E%0A%3C%2Fatom%3Aentry%3E&header=Content-type%3A+application%2Fatom%2Bxml%3B+GData-Version%3A+3.0" 
```

如您所见，gem 如何格式化我的 xml 肯定存在问题....然后是我在调试器中找到的响应

Content-Type application/x-www-form-urlencoded 不是有效的输入类型。

所以我想我的 xml 格式有问题，或者我的内容类型错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T10:02:14.377

好的，这是正确的称呼方式：

```
strxml = render_to_string( :partial => 'createInGoogle', :layout => false )
response = access_token.post('/m8/feeds/contacts/default/full', {:body => strxml, :header => {'Content-type' => 'application/atom+xml;GData-Version: 3.0'}}) 
```

# jquery - 使用 Chrome 开发工具/Firebug/IE 开发工具栏查找元素的附加/绑定事件

> ID：11065358
> 
> 赞同：41
> 
> 时间：2012-06-16T16:56:39.080
> 
> 标签：jquery, google-chrome-devtools, dom-events, firebug, ie-developer-tools

在检查页面的 DOM 时，我想快速了解元素的附加事件

例如，如果一个按钮有这个 HTML DOM

```
<button id="button1">Click Me</button> 
```

在某个地方（不是在我事先知道的地方）它附加了一个事件，例如

```
$("#button1").click(function(){...}); 
```

我知道它可以以编程方式完成（[我可以使用 jQuery 找到绑定在元素上的事件吗？](https://stackoverflow.com/questions/2008592/can-i-find-events-bound-on-an-element-with-jquery)）

但是有没有办法只使用 Chrome / Firefox / IE 的开发工具之一来查看事件列表？

* * *

**更新**：我发现在较新的 Chrome 版本中，我有一个名为**EventListeners**的选项卡，但似乎它不允许轻松深入到事件源，因为 jQuery 包装了原始

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-02-06T05:01:44.873

**获取第一个 $("#button1") 元素上的第一个附加处理程序**

```
$._data($("#button1").get(0),"events").click[0].handler 
```

[JSFiddle](http://jsfiddle.net/m9HsR/)

***没人想听的长篇大论：*** *我来这里是为了寻找插件。我很高兴看到@schmidlop 的回答，但在 jQuery 中，它实际上并没有给我我正在寻找的侦听器，它只是显示了最终调用特定回调的 jQuery 事件的通用处理程序。我仍在寻找一个 Chrome 插件，它允许我右键单击一个元素并让我深入了解附加到该对象的处理程序。*

*因为那会很酷。*

***更新：*** *我找到了一个名为 jQuery Debugger 的 chrome 扩展。您只需“检查元素”并从“元素”子菜单中选择“jQuery 事件”...* [https://chrome.google.com/webstore/detail/jquery-debugger/dbhhnnnpaeobfddmlalhnehgclcmjimi](https://chrome.google.com/webstore/detail/jquery-debugger/dbhhnnnpaeobfddmlalhnehgclcmjimi)![在此处输入图像描述](../Images/33740b99bfefd60589df8ff0174bff3a.png)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-01-21T04:41:41.133

Chrome 中现在有一个事件侦听器选项卡。![事件侦听器选项卡](../Images/997ee94a7581b52dce0c9a88462d7c55.png)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-09-18T18:19:36.013

使用 Chrome 检查器在“元素”选项卡中选择元素，然后从“控制台”选项卡中，您可以看到附加到元素的事件`getEventListeners($0);`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-01T02:58:02.640

Firefox 的开发者工具现在在具有绑定事件的元素旁边显示一个“ev”。这可用于检查绑定事件（包括 jQuery 事件）。

这是一个检查[jQuery click 文档](https://api.jquery.com/click/)中的“First Paragraph”元素的示例：

![Firefox 开发者工具中的绑定事件](../Images/33de475b78b7c80de0580561766a33f4.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-17T11:01:28.000

您还可以查看适用于 chrome 的 Visual Event 插件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-14T23:43:30.953

FireQuery - [http://firequery.binaryage.com/](http://firequery.binaryage.com/)可让您查看绑定到元素的事件并深入了解它们

# javascript - Date.parse 上的 javascript 文档

> ID：11065359
> 
> 赞同：1
> 
> 时间：2012-06-16T16:56:39.920
> 
> 标签：javascript, parsing, date

我能够使用以下脚本在 JavaScript 中解析日期字符串：

```
var mydate = new Date(Date.parse('06/15/2012','MM/dd/yyyy')); 
```

真正困扰我的是上述方法没有适当的文档。MSDN、w3school 和 Mozilla 开发者网站只有一个参数的文档。

即，Date.parse('一些日期字符串');

具有正确最新信息的最佳 JavaScript 参考是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:10:38.510

[MDN 文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)是正确的。

Javascript 是一种动态的弱类型语言，它不检查方法签名。它只是将您放入方法调用中的任何内容传递给 Function 对象并让它担心它。

在这种情况下，`Date.parse`忽略您的第二个参数。

它起作用的原因是因为`Date.parse`它旨在识别符合[RFC 2822](https://www.rfc-editor.org/rfc/rfc2822#page-14)的日期并...解析它们。

如果你执行

```
Date.parse('06/07/2012','MM/dd/yyyy') === Date.parse('06/07/2012','dd/MM/yyyy') 
```

在浏览器控制台中，您会看到第二个字符串对解析没有影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:04:26.747

该方法只关注第一个参数。那是，

```
var mydate = new Date(Date.parse('06/15/2012')); 
```

会给你同样的结果。

# c++ - 我可以以这种方式返回迭代器吗？

> ID：11065368
> 
> 赞同：1
> 
> 时间：2012-06-16T16:57:39.203
> 
> 标签：c++, iterator

我希望我的 c++ 代码尽可能地被封装，这种返回迭代器的方式可以吗？

```
const map<string,bool>::iterator getFollowers() {

        return followers.begin();

    }

    const map<string,bool>::iterator getFollowing() {

        return following.begin();

    } 
```

完整代码：

```
#ifndef twitClient_twitUser_h
#define twitClient_twitUser_h

#include <map>
#include <iostream>
#include <string>

using namespace std;
class user {
    string username;
    map<string,bool> followers;
    map<string,bool> following;
    string name;

public:

    user(string username):username(username) {
        followers [username] = false;
        following [username] = false;
    }

    bool removeFollower (string friendName);
    bool addFollower(string friendName);
    bool stopFollowing(string friendName);
    bool startFollowing(string friendName);

    const map<string,bool>::iterator getFollowers() {

        return followers.begin();

    }

    const map<string,bool>::iterator getFollowing() {

        return following.begin();

    }

}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:02:23.257

您的方法没有任何问题，只是您可能还想添加 const 访问方法，例如

```
map<string,bool>::const_iterator getFollowers() const; 
```

另外，您还想添加对`end()`迭代器的访问。

关于封装，您封装了地图，但您的客户暴露于`map<string, bool>::iterator`. [有一篇关于在此处](http://www.artima.com/cppsource/type_erasure.html)隐藏这些依赖项的非常有趣的文章。这绝不是微不足道的，但仍然值得考虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:09:17.667

是和不是。

封装有多种含义。

*   以较轻的形式，这意味着该类可以完全控制封装的成员，这可能是这里的情况（如果您返回 a `const_iterator`）
*   在其较重的形式中，这意味着类实现细节不会泄漏到外部单词中，这里*不是*这种情况

因此，您不要让其他人控制您的内部（很好），但您仍然会公开实现细节，如果您更改了如何`followers`或`following`在幕后实现，则会破坏客户端。

一种可能的解决方案是引入循环构造（例如 foreach）：

```
template <typename Pred>
void user::foreachFollower(Pred& p) const {
    for (auto const& f: followers) { p(f); }
} 
```

这更灵活，因为如果您将地图从 更改`<string, bool>`为`<string, int>`（改为计算数字），您始终可以更改函数：

```
template <typename Pred>
void user::foreachFollower(Pred& p) const {
    for (std::pair<std::string, bool> const& f: followers) { p(f); }
} 
```

这样您的客户就不会被破坏。它们也是检测客户端是否可以处理的复杂技巧`std::pair<std::string, int>`，但它们（有点）难以实现。

* * *

另一方面，仅仅给出`begin`迭代器是不够的，他们还需要`end`一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T17:14:01.703

如果您进一步考虑这个问题，我认为可能存在一些设计问题。似乎您将在此设置中保留许多容器并设置跟随者/跟随布尔值来说明条件是否为真。一分钟后回到这个。

如果在使用之前/期间从另一个方法操作容器，则传回迭代器可能非常危险。因此，对于您的问题，我会考虑传递对要分析/操作的容器的引用，如果使用多线程（在这些多核时代，我们需要始终考虑这一点）使用互斥锁使容器线程安全或[活动对象](http://herbsutter.com/2010/07/12/effective-concurrency-prefer-using-active-objects-instead-of-naked-threads/)类型设计和简单的安全队列实现。

对于这种设置，如果您有一个封闭的用户组，或者如果您有多对多的情况，那么考虑使用矩阵类型设计可能会更好，那么也许考虑像[boost multi index](http://www.boost.org/doc/libs/1_49_0/libs/multi_index/doc/index.html)之类的东西。这可以提供更清晰更可扩展的设计。

# macos - CALayer 调用 NSView

> ID：11065373
> 
> 赞同：2
> 
> 时间：2012-06-16T16:58:05.000
> 
> 标签：macos, cocoa, core-animation, calayer

CALayer 可以在 OS X 上调用它的主机 NSView 吗？有问题的层是一个子层。视图是图层支持的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T20:08:17.737

我相信 CALayer 支持 setValue:forKey: 和 valueForKey 方法将任意键/值对添加到层。您可以使用它将视图属性添加到您的自定义层，然后在您的层的方法中访问该视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:13:36.663

是和不是。

该层无法直接访问它正在备份的视图。图层上没有“视图”属性。

但是，如果视图的变量在当前范围内，那么它可以通过该变量访问视图，就像任何其他对象一样。

# android - 如何在 Android 上的 SQLite 数据库中实现“继承”关系

> ID：11065374
> 
> 赞同：9
> 
> 时间：2012-06-16T16:58:06.623
> 
> 标签：android, sqlite, database-design, inheritance, schema

考虑这个简单的模型：

基本位置表：

```
+-------------------------------+
|           Locations           |
+-------------------------------+
|(PK) _id Integer Autoincrement |
|     name Text(100) Not null   |
|     is_in_range Integer       |
+-------------------------------+ 
```

还有更专业的表称为 WifiLocation：

```
+-------------------------------+
|         wifi_location         |
+-------------------------------+
|     ssid Text(0) Not null     |
|     signal_threshold Real     |
|(PK) _id Integer               |
+-------------------------------+ 
```

我希望这个模型将代表`WifiLocation`继承自`BaseLocation`. 所以我在表的列`REFERENCES`上添加了一个子句，如下所示：`_id``wifi_locations`

```
CREATE TABLE wifi_locations (_id Integer primary key references Locations(_id), ....) 
```

我正在尝试在这些表之间实现 1:1 的关系。

当我想在`wifi_locations`表中插入一行时，我首先将适当的值（Name，IsInRange）插入到`Locations`表中，然后取回`rowId`. 然后我将其余数据 (ssid)`wifi_locations`连同 rowId 作为外键插入到表中。

所以插入 Location 表是有效的，我得到了一个 Id，但是当我尝试使用这个 Id 并将它插入到 wifi_locations 表时，我得到一个 SQL`Constraint violation`错误。没有关于究竟出了什么问题的更多细节。

我的架构有什么问题吗？有没有更好的方法来实现这样的建模？

**编辑：**

确切的错误：

```
06-16 15:56:42.846: E/Database(2038):
android.database.sqlite.SQLiteConstraintException: 
error code 19: constraint failed 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T17:27:30.663

您应该在第二个表中创建，并在 Locations 表中`FOREIGN KEY`引用。`PRIMARY KEY`在 SQLite`FOREIGN KEYS`中支持但隐式未启用，因此首先您必须启用它们。

```
final String ENABLE_FOREIGN_KEYS ="PRAGMA foreign_keys=ON";
db.execSQL(ENABLE_FOREIGN_KEYS); 
```

在你的`onOpen()`方法中`SQLiteOpenHelper`。

然后你`FOREIGN KEY`看起来像这样：

```
CREATE TABLE wifi_location (
   SSID TEXT NOT NULL,
   SIGNAL_THRESHOLD REAL,
   _id INTEGER,  
  FOREIGN KEY(_id) REFERENCES Locations(_id)
); 
```

所以，但这一切都有效`SQLite version 3.6.19`。有关更多信息，请查看[SQLite Foreign Key Support](http://www.sqlite.org/foreignkeys.html)。

# objective-c - 设置器是否也“重置”关联的对象？

> ID：11065375
> 
> 赞同：0
> 
> 时间：2012-06-16T16:58:09.387
> 
> 标签：objective-c, setter, objective-c-runtime, associated-object

在就内存位置、指针和关联对象进行了一个很好的长[争论](https://stackoverflow.com/questions/11064498/confusion-with-pointers-and-objects-objective-c/11064559#comment14479969_11064559)时，我们偶然发现了一些令人头疼的问题：虽然 setter 可以将传递的对象的内存地址设置为彼此相等，但所说的传递对象是否反过来具有相同的关联对象？

从理论上讲，这是有道理的，因为任何共享相同内存地址的对象都必须具有相同的关联对象，因为它们*是*同一个对象，对吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:37:02.130

您不能有两个 Objective-C 对象（或原语、结构或任何其他数据结构）占用相同的内存地址。* 如果您有两个对象，它们位于同一位置在内存中，那么你实际上只有一个对象。

我们使用指针来访问对象。如果将一个指针设置为另一个，使用简单的赋值：

```
NSString * s = [NSString stringWithContentsOfFile:@"README"];
NSString * t = s; 
```

那么你有两个指向*一个*对象的指针。没有对象的复制。如果您通过一个指针更改对象的 ivars 之一，那么当您通过另一个指针查看对象时，您会看到更改后的值。

* * *

[*完全迂腐：当然，您可以*重新解释*特定位置的数据（请参阅“梅尔的故事”），但这是超出本问题范围的黑魔法。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T17:07:34.813

当你说你传递一个对象时，你传递的是一个指针，而不是一个对象。而设置的是内存地址。

当一个带有指向关联对象的内存地址的新指针被传递给 setter 方法，并且内部的对象被设置为新地址时，现在两个指针（传递的指针和设置的指针）具有相同的内存地址，并且它们共享相同的关联对象。

# android - 使用 CursorLoader 查询专辑的歌曲

> ID：11065377
> 
> 赞同：6
> 
> 时间：2012-06-16T16:58:11.950
> 
> 标签：android, android-cursor, android-cursorloader

我想通过查询`MediaStore`with来获取专辑的歌曲列表`CursorLoader`

我怎样才能做到这一点 ？我可以使用以下代码获取设备的所有歌曲：

```
static final String[] TRACK_SUMMARY_PROJECTION = { MediaStore.Audio.Media._ID, MediaStore.Audio.Media.TITLE}; 

public Loader<Cursor> onCreateLoader(int id, Bundle args) {  
    String sortOrder = MediaStore.Audio.Media.TITLE + " ASC";
    String select = null;  
    return new CursorLoader(getActivity(), MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,  
                    TRACK_SUMMARY_PROJECTION, select, null,  
                    sortOrder);  
} 
```

我应该在代码中添加什么或修改以过滤特定专辑的歌曲？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-16T18:41:46.257

一步一步走

**第 1 步查看手机上加载的专辑名称**

请求光标获取专辑信息

```
String[] columns = { android.provider.MediaStore.Audio.Albums._ID,
        android.provider.MediaStore.Audio.Albums.ALBUM };

cursor = managedQuery(MediaStore.Audio.Albums.EXTERNAL_CONTENT_URI,
        columns, null, null, null); 
```

**第 2 步找到所有专辑名称后。您可以写下所需的专辑名称并从中查询歌曲**

请求包含特定专辑歌曲信息的光标

```
String[] columns = { MediaStore.Audio.Media.DATA,
          MediaStore.Audio.Media._ID,
          MediaStore.Audio.Media.TITLE,
          MediaStore.Audio.Media.DISPLAY_NAME,
          MediaStore.Audio.Media.MIME_TYPE, };

      String where = android.provider.MediaStore.Audio.Media.ALBUM
          + "=?";

      String whereVal[] = { Album name from which you want songs };

      String orderBy = android.provider.MediaStore.Audio.Media.TITLE;

      cursor = managedQuery(
          MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, columns,
          where, whereVal, orderBy); 
```

现在返回这个光标。

以下是检索专辑名称和其中所有歌曲的源代码供您参考。

```
package org.vipul;

import android.app.Activity;
import android.database.Cursor;
import android.os.Bundle;
import android.provider.MediaStore;
import android.util.Log;

public class HelloActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        String[] columns = { android.provider.MediaStore.Audio.Albums._ID,
                android.provider.MediaStore.Audio.Albums.ALBUM };

        Cursor cursor = managedQuery(
                MediaStore.Audio.Albums.EXTERNAL_CONTENT_URI, columns, null,
                null, null);

        if (cursor.moveToFirst()) {
            do {
                Log.v("Vipul",
                        cursor.getString(cursor
                                .getColumnIndex(android.provider.MediaStore.Audio.Albums.ALBUM)));
            } while (cursor.moveToNext());
        }

        // I want to list down song in album Rolling Papers (Deluxe Version)

        String[] column = { MediaStore.Audio.Media.DATA,
                MediaStore.Audio.Media._ID, MediaStore.Audio.Media.TITLE,
                MediaStore.Audio.Media.DISPLAY_NAME,
                MediaStore.Audio.Media.MIME_TYPE, };

        String where = android.provider.MediaStore.Audio.Media.ALBUM + "=?";

        String whereVal[] = { "Rolling Papers (Deluxe Version)" };

        String orderBy = android.provider.MediaStore.Audio.Media.TITLE;

        cursor = managedQuery(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,
                column, where, whereVal, orderBy);

        if (cursor.moveToFirst()) {
            do {
                Log.v("Vipul",
                        cursor.getString(cursor
                                .getColumnIndex(MediaStore.Audio.Media.DISPLAY_NAME)));
            } while (cursor.moveToNext());
        }

    }
} 
```

# git - 适用于许多小文件的最佳 git 类版本控制工具

> ID：11065383
> 
> 赞同：9
> 
> 时间：2012-06-16T16:59:30.150
> 
> 标签：git, version-control

我想知道每个人对可以用于许多小（1 - 30kb）文件的最好的“git like”版本控制工具的想法是什么。我真正想要跟踪的只是删除、移动、重命名，而不是内容更改。

我的情况是大约 200,000 个 1 到 30 KB 的文件。

一些搜索把我带到了 git-annex。那会做我需要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T02:26:43.460

重申一个评论，为什么不只是 git 本身呢？该工具旨在在许多不同的环境中正常工作。

不过，就其价值而言，在 git 中跟踪实际重命名并不是那么容易。这些工具就在那里，但没有简单的方法可以访问它们。请参阅[查找“重写”文件的 git 提交](https://stackoverflow.com/questions/3714563/find-git-commits-that-rewrite-files)。

另一个想法：找到一些简单的工具，将所有文件名收集到一个文本文件中，然后使用 git 来跟踪它。不过，同样，可能会很好地处理重命名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T02:08:14.440

git-annex 是我唯一知道的——基于 git。该工具支持您正在寻找的内容以及更多内容。例如，一次同步多个附件回购。你有完整的 git 命令支持和所有新的附件命令。为了澄清，重命名，删除，移动出现在 git 上。附件使用符号链接来跟踪您的内容。

我使用该工具来跟踪和更新我的主页文件。Rsync 无法处理重命名。这就是我使用这个工具的原因，也因为我很了解 git。

# c++ - 复制构造函数中 const 引用的调用方法

> ID：11065384
> 
> 赞同：0
> 
> 时间：2012-06-16T16:59:35.630
> 
> 标签：c++, reference, constants, copy-constructor

我正在使用复制构造函数来获取`MapObject`并复制它和它的属性。
但是，这个对象已经生成到游戏中，所以在构建时我想从游戏中删除这个对象。

本质上，我想要做的是：

```
MapObject::MapObject(const MapObject& _mapobject)
{
    _mapobject.Derez();
    Rez();
} 
```

我怎样才能在复制构造函数中完成它而不调用它`const&`？

编辑：切换到智能指针向量完全解决了这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:03:00.477

您可以制作一个*可变的复制构造函数*：

```
MapObject::MapObject(MapObject& _mapobject) // << no const here 
```

但是你会得到一个不复制的*复制构造函数*，这只是在自找麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:04:12.493

我强烈建议不要让您的复制构造函数修改其参数的逻辑状态。这是非惯用语，并且可能会导致混乱。

相反，在呼叫站点做这样的事情：

```
MapObject o2 = o1;
o1.remove(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T17:04:21.930

`Derez`如果is ，您只能调用它`const`。

但在我看来，设计似乎是错误的。为什么创建副本会从游戏中删除原件？为什么类首先要负责从游戏中删除自身的实例？你为什么还要尝试复制游戏中已经存在的对象？

对我来说，这似乎比实际调用该方法更重要。

# php - 如何在我自己的 div 中添加产品类别？

> ID：11065385
> 
> 赞同：1
> 
> 时间：2012-06-16T16:59:36.097
> 
> 标签：php, magento

我创建了一个名为的 div `nav_container`，我希望将 Magento 产品类别放置在该 div 中，而不是默认标题中。

最简单的方法是什么？我研究了很长时间，没有解决方案。感谢您的任何建议。我正在使用 Magento 1.7。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T17:28:22.880

有几种方法可以实现这一点：

1.  复制`app/design/frontend/base/default/page/html/topmenu.phtml`到`app/design/frontend/your_package/your_theme`并简单地添加您的包装 div。

2.  编辑`app/design/frontend/your_package/your_theme/page/html/header`并找到该行：`<?php echo $this->getChildHtml('topMenu') ?>`并简单地用你的 div 包围它

3.  您也可以使用布局 xml，特别是`page/html_wrapper`块 - 但对于这个简单的示例，选项 1 或 2 很可能是最佳选项

**编辑**

*意识到您对块的困惑后，请参阅下面的正确解决方案*

好的，首先，块在 Magento 中具有非常特定的含义，与 html 标签的含义完全不同。您可以在此处找到块的定义：http: [//www.magentocommerce.com/design_guide/articles/magento-design-terminologies4#term-blocks](http://www.magentocommerce.com/design_guide/articles/magento-design-terminologies4#term-blocks)

现在，在 1.7 CE 中移动顶部导航：

与 Magento 中的布局一样，您有两个主要选择：将基本布局文件复制到当前主题并进行编辑，或者在主题中使用 local.xml 文件来覆盖所有基本布局。

每个都有优点和缺点 - 尽管我建议你使用 local.xml ，除非有特定的理由不这样做。但这完全取决于您选择哪种方法:)

**1.使用local.xml**

```
app/design/frontend/your_package/your_theme/layout/local.xml 
```

```
<layout version="0.1.0">

    <!-- Other layout xml -->

    <!-- 
        Unset the nav from the header 
    -->
    <reference name="header">
        <action method="unsetChild"><alias>topMenu</alias></action>
    </reference>

    <!-- 
        Insert it into your new containing block
    -->
    <reference name="nav_container">
        <action method="insert"><alias>top.menu</alias></action>
    </reference>

    <!-- Other layout xml -->

</layout> 
```

**2\. 复制基础文件**

首先，复制`app/design/frontend/base/default/layout/page.xml`到`app/design/frontend/your_package/your_theme/layout/page.xml`

找到 header 块，如果未触及，它将完全如下：

```
<block type="page/html_header" name="header" as="header">
    <block type="page/template_links" name="top.links" as="topLinks"/>
    <block type="page/switch" name="store_language" as="store_language" template="page/switch/languages.phtml"/>
    <block type="core/text_list" name="top.menu" as="topMenu" translate="label">
        <label>Navigation Bar</label>
        <block type="page/html_topmenu" name="catalog.topnav" template="page/html/topmenu.phtml"/>
    </block>
    <block type="page/html_wrapper" name="top.container" as="topContainer" translate="label">
        <label>Page Header</label>
        <action method="setElementClass"><value>top-container</value></action>
    </block>
</block> 
```

并更改为：

```
<block type="page/html_header" name="header" as="header">
    <block type="page/template_links" name="top.links" as="topLinks"/>
    <block type="page/switch" name="store_language" as="store_language" template="page/switch/languages.phtml"/>
    <block type="page/html_wrapper" name="top.container" as="topContainer" translate="label">
        <label>Page Header</label>
        <action method="setElementClass"><value>top-container</value></action>
    </block>
</block> 
```

此时，您只需从布局中删除 top.menu 块。

接下来，您需要将块重新添加到正确节点下的布局中：nav_container。

因此，无论您当前在何处声明 nav_container 块，都将您刚刚删除的 xml 添加为子节点，即：

```
<block type="core/text_list" name="top.menu" as="topMenu" translate="label">
    <label>Navigation Bar</label>
    <block type="page/html_topmenu" name="catalog.topnav" template="page/html/topmenu.phtml"/>
</block> 
```

最后清除缓存并重新加载页面。

# android - Android 数字格式在某种程度上是错误的，而不是 3.5 我得到 3.499999999，为什么？

> ID：11065397
> 
> 赞同：2
> 
> 时间：2012-06-16T17:01:25.953
> 
> 标签：android, numbers, format, rounding

我将一些数据存储在数据库中，然后用游标读取这些数据。所有数据均为 56.45 , 3.04, 0.03 类型，所以小数点后有两位数。现在我想对它们求和，但这似乎并不容易......我得到这些数字`c.getDouble(3)`然后我将它添加到 sum 变量中，如：

```
sum+= c.getDouble(4) * multi 
```

multi 是 1 到 100 之间的整数。现在我的问题是，在得到 sum 变量后，我得到一个数字，例如：59.51999999999999999。我没有发布代码，但是除了`string.valueOf`使数字出现在我的小部件上之外，没有任何转换。所以有人经历过吗？据我计算，它应该是 59.52，但我得到的数字是 99999……为什么会这样？（有趣的是，a`Math.round()`不起作用，即使我设置 (sum)*100 / 100 ，我也会得到 59.0 ..提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-16T17:09:02.877

你的数字对你来说是十进制的，但对计算机来说是二进制的。

在十进制和二进制中，某些分数无法精确表示。

例如 1/3 不能用十进制精确表示。您只能用 0.3333333333 之类的值来近似它。但是如果你尝试做 3 * 0.3333333333，你最终会得到 0.9999999999 而不是 1.0000000000。

在二进制中，您有相同的问题，但分数不同。

因此，有时当您从十进制转换为二进制并再次转换回来时（计算机基本上必须为您执行浮点运算），即使所有数字在十进制中都是非常精确的，您也会在精度上出现小错误。当计算机使用它们的二进制近似等效项时，会引入近似值，它们会导致小错误。

这实际上是编程中非常常见的问题。有关更多详细信息，请参阅[每个计算机科学家应该了解的浮点运算知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T17:11:41.190

其他方法，您可以将 sum 变量定义为`double`，然后您可以设置`NumberFormat`sum 变量。

**例子：**

```
double sum = 21.2015;
NumberFormat formatter = new DecimalFormat("#.##");
formatter.format(sum); 
```

# ruby - 来自其他数组的 Ruby 切片数组

> ID：11065398
> 
> 赞同：0
> 
> 时间：2012-06-16T17:01:37.187
> 
> 标签：ruby, arrays

我正在为我的 Rails 应用程序制定一些规范，这些规范涉及在数据库中重新排序模型。

由于事先不知道模型 ID，我不想硬编码“模型 ID 列表应该是 [1,2,3]”，所以我只是在创建它们时将它们收集在一个数组中，例如

```
(1..3).each
  ids << Model.create().id

Model.find(:all, order: position).should == ids 
```

无论如何，我想测试我的重新排序逻辑，它需要一个有序 ID 列表：

```
Model.reorder( [3,1,2] ) # will change position in db 
```

为了保持干燥，我只是这样做：

```
reordered_ids = [ids[3], ids[1], ids[2]]
Model.reorder( reordered_ids )

Model.find(...).should == reordered_ids 
```

我很好奇是否有更优雅的方式来做

```
reordered_ids = [ids[3], ids[1], ids[2]] 
```

这有效，但似乎并不好：

```
[3,1,2].collect{|i| ids[i] } 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:13:48.483

> reordered_ids = [ids[3], ids[1], ids[2]]

```
reordered_ids = ids.values_at(3, 1, 2) 
```

> (1..3).each ids << Model.create().id

```
ids = 3.times.map { Model.create.id } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T00:34:43.537

我的回答不完全是你问的，但可能是你需要的。

不自己决定重新排序并进行洗牌怎么样，比如

```
reordered_ids = ids.shuffle 
```

更新：在作者的评论正确指出之后，shuffle 未排序的优先级较低，并且他希望它是明确的，我认为我们可以在这种情况下简单地颠倒顺序以使其明确。例如

```
reordered_ids = ids.reverse 
```

# objective-c - 如何检测鼠标是否在菜单栏上？

> ID：11065401
> 
> 赞同：0
> 
> 时间：2012-06-16T17:02:00.837
> 
> 标签：objective-c, cocoa

我正在调用一些需要在继续之前检测鼠标是否在（主）菜单栏上的方法。我该如何定义这样的方法`- (BOOL)isMouseOverMenu`？

我想确保鼠标实际上在菜单栏中，因此，当应用程序全屏、隐藏菜单或鼠标位于第二台显示器上菜单栏的相同坐标时，它应该返回 false没有菜单栏。如果它位于菜单栏中的任何其他项目上，它也应该返回 true，但不一定在弹出菜单中。

注意：当它触发时，我的窗口并不总是关键窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:17:33.810

根据[NSMenu](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSMenu_Class/Reference/Reference.html)文档，`NSMenuDidBeginTrackingNotification`在菜单跟踪开始时发布。

为这个通知添加一个观察者，只要鼠标悬停在菜单上，你就会收到通知。

**更新：**

我不认为这是可以做到的。`NSMenuDidBeginTrackingNotification`仅当用户单击菜单而不是鼠标悬停在菜单上时才会发布。

`NSMenu`不是从其中派生的，`NSResponder`因此无法通过覆盖其中一种鼠标方法来检测它。

我认为这是一个错误，因为在 Apple 文档中将鼠标跟踪定义为光标位于没有按下按钮的矩形区域上。如果没有其他解决方案浮出水面，我将考虑提交错误报告。

# java - GestureDetector 不适用于我的视图

> ID：11065403
> 
> 赞同：2
> 
> 时间：2012-06-16T17:02:15.923
> 
> 标签：java, android

我一直在开发绘图应用程序，我需要通过视图检测双击：

```
package com.nda.painter.library.views;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.Path;
import android.util.Log;
import android.view.GestureDetector;
import android.view.GestureDetector.OnDoubleTapListener;
import android.view.GestureDetector.OnGestureListener;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnLongClickListener;
import android.view.View.OnTouchListener;

import com.nda.painter.library.Painter;
import com.nda.painter.library.listeners.DrawingListener;

public class PainterView extends View implements 
    DrawingListener,  OnTouchListener,
    OnGestureListener, OnDoubleTapListener {

    private GestureDetector detector;
    private Context context;
    private Painter painter;
    private Bitmap bitmap;
    private Paint bitmapPaint;
    private Path path;
    private Paint paint;

    private float x;
    private float y;

    public PainterView(Context context, Painter painter) {

        super(context);
        this.context=context;
        this.painter=painter;
        //setClickable(true);
        //setLongClickable(true);
        //setOnTouchListener(this);
        detector=new GestureDetector(context, this);
        detector.setIsLongpressEnabled(true);
        detector.setOnDoubleTapListener(this);

    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
    }

    public void setPainter(Painter painter) {
        this.painter=painter;
    }

    @Override
    public boolean onDown(MotionEvent e) {
        // TODO Auto-generated method stub
        Log.e("event", "event");
        return false;
    }

    @Override
    public void onShowPress(MotionEvent e) {
        // TODO Auto-generated method stub

    }

    @Override
    public boolean onSingleTapUp(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
            float distanceY) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public void onLongPress(MotionEvent e) {
        // TODO Auto-generated method stub
        Log.e("event", "long");
        painter.drawString(x,y,"123");
    }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onSingleTapConfirmed(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean onDoubleTap(MotionEvent e) {
        // TODO Auto-generated method stub
        Log.e("event", "double");
        return true;
    }

    @Override
    public boolean onDoubleTapEvent(MotionEvent e) {
        // TODO Auto-generated method stub
        return false;
    }
} 
```

请不要在其他代码中查看，仅在 GestureDetector 中查看。它不起作用！我没有在 Log 中看到任何注释。请告诉我为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:05:58.400

试试这个：

```
 detector = new GestureDetector(getContext(), new GestureDetector.SimpleOnGestureListener() {
        @Override
        public boolean onDown(MotionEvent e) {
            return true; // the magic is here
        }

        @Override
        public boolean onDoubleTap(MotionEvent e) {
            Ln.d("!!! onDoubleTap");
            return super.onDoubleTap(e);
        }

        @Override
        public boolean onDoubleTapEvent(MotionEvent e) {
            Ln.d("!!! onDoubleTapEvent");
            return super.onDoubleTapEvent(e);
        }
    });

    setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View view, MotionEvent motionEvent) {
            return detector.onTouchEvent(motionEvent);
        }
    }); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-01-22T05:39:57.900

```
detector = new GestureDetector(getContext(), new GestureDetector.SimpleOnGestureListener() {
    @Override
    public boolean onDown(MotionEvent e) {
        return true; 
    }

    @Override
    public boolean onDoubleTap(MotionEvent e) {
        Ln.d("!!! onDoubleTap");
        return super.onDoubleTap(e);
    }

    @Override
    public boolean onDoubleTapEvent(MotionEvent e) {
        Ln.d("!!! onDoubleTapEvent");
        return super.onDoubleTapEvent(e);
    }
});

setOnTouchListener(new OnTouchListener() {
    @Override
    public boolean onTouch(View view, MotionEvent motionEvent) {
        return detector.onTouchEvent(motionEvent);
    }
}); 
```

# c# - 将下一个 Texbox1 聚焦到 Textbox17

> ID：11065412
> 
> 赞同：0
> 
> 时间：2012-06-16T17:03:52.347
> 
> 标签：c#, vb.net, visual-studio

我有一个类（ChorNumbers），在这个类中我有一个测试 textbox1...17 是字符还是数字的函数。

我创建了一个有 9 个文本框的 WindowsForm。如果我在必须跳转到下一个 textbox2 的 textbox1 中输入 1（执行此操作） 如果我在必须跳转到 textbo3 的 textbox2 中输入 A，但它们不会跳转。为什么它不跳转的问题在哪里？

我想使用一个 textbox1_TextChanged 函数。

```
 private void textbox1_TextChanged(object sender, EventArgs e)
 {
        TextBox myText = (TextBox)sender;
        ChorNumbers myNR = new ChorNumbers();

        bool _focused = false;
        if (myNR.CheckTextbox(myText.Name, myText.Text) == false)
            foreach (Control ctrtb in base.Controls)
                if (ctrtb is TextBox && _focused == false)
                {
                    _focused = ctrtb.Focused;
                }
                else if (ctrtb is TextBox && _focused == true)
                    ctrtb.Focus();
 } 
```

我有我不想使用的解决方案。我只想要一个 textbox1 函数用于其他文本框

```
 private void textbox3_TextChanged(object sender, EventArgs e)
    {
        TextBox myText1 = (TextBox)sender;
        ChorNumbers myNR1 = new ChorNumbers();

        if (myNR1.CheckTextbox(myText1.Name, myText1.Text) == false)
        {
            textbox4.Focus();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:44:58.277

你为什么不试试：

```
if textbox2.text = "A" then
    'whatever you want, for exapmple:
    textbox3.text = textbox2.text
end if 
```

而不是 if textbox2.text = "A" 那么你也可以使用类似的东西：

```
if not textbox2.text = nothing then
end if 
```

这不是比你尝试的容易得多吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T19:13:52.993

1.  编写一个事件处理程序来处理所有文本框的 TextChanged 事件：

    ```
     private void textbox_TextChanged(object sender, EventArgs e)
     {
            TextBox txtBox = (TextBox)sender;

            // Either write your own character/number and focus moving logic here 
            // Or the following
            char ch = txtBox.Text.Trim()[0];
            switch(txtBox.Name){
                case "textbox1":
                    if(Char.IsDigit(ch))
                        textbox2.focus();
                break;
                case "textbox2":
                    if(Char.IsLetter(ch))
                        textbox3.focus();
                break;

                ... // rest of the cases
            }
     } 
    ```

2.  在设计时，选择`textbox1`，转到 Properties > Events > TextChanged 并`textbox_TextChanged`在那里绑定。对其余的文本框执行相同的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T19:41:45.630

经过

> 我有我不想使用的解决方案。我只想要一个 textbox1 函数用于其他文本框

你的意思是你只希望每个文本框调用一个回调函数，然后（如果填充正确）传递到下一个？如果是这样，那么那部分就很简单了，只需将每个事件处理程序指向相同的方法（尽管它可能会变得复杂，除非每个事件处理程序的验证完全相同 - 因此，每个文本框都有一个可能会更好）。

我认为您的问题将是一个标准问题-您试图在该控件完成处理之前在该控件调用的事件期间更改焦点。也就是说，textbox1 在被填充时触发您捕获的事件 - 在您的捕获（回调）方法中您更改焦点 - 现在处理返回到 textbox1（在您的回调方法的返回/结束时）并且焦点被切换为副产品（因为克拉正在为 textbox1 的下一次更新做好准备）。

一种解决方案是在几毫秒后调用一个定时事件，然后在处理返回到文本框并返回等待消息状态后，定时事件启动焦点（跳转）。

您也可以尝试将启用设置为强制并查看是否强制当前控件通过（尽管需要排序制表位）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-17T08:08:38.797

那是我的函数 ChorNumbers

```
 public bool ChorNumbers(string Name, string _Text)
        {
            bool error = false;
            if (_Text.Length < 1)
            {
                error = true;
                return error;
            }

                if (Name == "textbox1" && _Text.Length == 1)
                {
                    if (!Regex.IsMatch(_Text, "^[0-9\\s]"))
                    {
                        MessageBox.Show("Only Number and Space!");
                        error = true;
                    }
                }
                if (Name == "textbox2" && _Text.Length==1)
                {
                    if (!Regex.IsMatch(_Text, "^[a-zA-z]"))
                        {
                            MessageBox.Show("Only Character!");
                            error = true;
                        }
                 }

           // textbo3 ... textbox17

    return error;
  } 
```

# java - 永久 SensorEventListener 摇动

> ID：11065414
> 
> 赞同：0
> 
> 时间：2012-06-16T17:03:58.527
> 
> 标签：java, android

当检测到震动事件时，我想启动我的应用程序的 Activity。我希望这发生在我的应用程序之外。

[这里](https://stackoverflow.com/questions/2317428/android-i-want-to-shake-it)和[这里](https://github.com/commonsguy/cw-advandroid/blob/master/Sensor/Shaker/src/com/commonsware/android/shaker/Shaker.java)有很多很棒的代码片段，例如，如何正确实现[SensorEventListener](http://developer.android.com/reference/android/hardware/SensorEventListener.html)，但即使我没有取消注册监听器，它仍然会被破坏。

如何防止它被破坏并注册一个“永久”监听器？我在任何地方都找不到任何这样的例子......任何链接或指导将不胜感激。

最后，当显示器打开时，我将如何只监听此类事件？我知道这可能是[硬件限制](https://stackoverflow.com/questions/9982433/android-accelerometers-not-working-when-screen-is-turned-off)。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:58:07.857

[您可以为BOOT_COMPLETED 意图](http://developer.android.com/reference/android/content/Intent.html#ACTION_BOOT_COMPLETED)注册广播接收器，并在[onReceive中使用](http://developer.android.com/reference/android/content/BroadcastReceiver.html#onReceive%28android.content.Context,%20android.content.Intent%29)[PARTIAL_WAKELOCK](http://developer.android.com/reference/android/os/PowerManager.html#PARTIAL_WAKE_LOCK)启动您的后台服务，然后注册您的传感器事件侦听器。像这样的东西：

```
@Override
public int onStartCommand(Intent i, int flags, int startId) {
    acquireWakeLock();
    registerSensorListener();
    return START_STICKY;
}

@Override
public void onDestroy() {
    unregisterSensorListener();
    releaseWakeLock();
    super.onDestroy();
}

private void acquireWakeLock() {
    try {
        PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
        if (pm == null) {
            Log.e(TAG, "Power manager not found!");
            return;
        }
        if (wakeLock == null) {
            wakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, getPackageName());
            if (wakeLock == null) {
                Log.e(TAG, "Could not create wake lock (null).");
                return;
            }
        }
        if (!wakeLock.isHeld()) {
            wakeLock.acquire();
            if (!wakeLock.isHeld()) {
                Log.e(TAG, "Could not acquire wake lock.");
            }
        }
    } catch (RuntimeException e) {
        Log.e(TAG, "Caught unexpected exception: " + e.getMessage(), e);
    }
}

private void releaseWakeLock() {
    if (wakeLock != null && wakeLock.isHeld()) {
        wakeLock.release();
        wakeLock = null;
    }
} 
```

希望这可以帮助。

# javascript - 我们可以在二维码中保存/存储多少数据/信息？

> ID：11065415
> 
> 赞同：95
> 
> 时间：2012-06-16T17:04:01.753
> 
> 标签：javascript, image, html, qr-code

我想使用这个脚本[https://github.com/jeromeetienne/jquery-qrcode](https://github.com/jeromeetienne/jquery-qrcode)
（或者有更好的解决方案吗？）

我喜欢做的是“保存”一些小脚本或程序，甚至像 xml 格式的文件（svg、x3d、...）这样的文件作为 QR 码图像。

但是我可以将多少信息（以字节为单位）精确保存到 QR 码图像（使用这个 javascript 解决方案）？

有使用此脚本和使用 qr 代码存储文件的经验吗？
[https://github.com/jeromeetienne/jquery-qrcode](https://github.com/jeromeetienne/jquery-qrcode)

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-06-16T17:14:57.617

二维码具有三个参数：数据类型、大小（“像素”数）和纠错级别。那里可以存储多少信息也取决于这些参数。例如，纠错级别越低，可以存储的信息越多，但代码越难被读者识别。

最大尺寸和最低纠错给出以下值：
仅限数字 最大。7,089 个字符
字母数字 最大。4,296 个字符
二进制/字节 最大。2,953 个字符（8 位字节）

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-06-16T17:08:19.507

见此[表](http://blog.qr4.nl/page/QR-Code-Data-Capacity.aspx)。

具有高级纠错功能的 101x101 QR 码可容纳 3248 位或 406 字节。对于任何有意义的 SVG/XML 数据来说可能还不够。

根据所需的纠错级别，177x177 网格可以存储 1273 到 2953 个字节。也许足以存储一些小东西。

[![在此处输入图像描述](../Images/1edb2fa5f31dfdfbee84525147ed2182.png)](https://i.stack.imgur.com/KzV6s.png)

# python - 解包关键字参数，但仅限与函数匹配的参数

> ID：11065419
> 
> 赞同：22
> 
> 时间：2012-06-16T17:04:29.073
> 
> 标签：python

假设我有一个功能：

```
def foo(a=None, b=None, c=None):
  return "a:%s, b:%s, c:%s" % (a, b, c) 
```

我有一个字典，上面有一些（或没有）参数，但也有函数中未命名参数的键，例如：

```
d = {'a': 1, 'x': 4, 'b': 2, 'y': 5} 
```

如果我调用以下命令，我会得到一个错误，因为 'x' 和 'y' 不是 foo 函数中的关键字参数。

```
foo(**d)  # error 
```

是否有一种优雅的方式将参数从字典传递给函数，但只有那些具有与函数参数匹配的键的值。

如果我的参数/参数术语不正确，请纠正我。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-16T17:06:39.603

```
def foo(a = None, b=None, c=None,**extras):
    return "a:%s, b:%s, c:%s" % (a, b, c) 
```

这里`**extras`将收集所有额外的命名/关键字参数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-16T17:17:33.420

@Ashwini Chaudhary 有一种非常 Pythonic 的方式来解决您的问题。但是，它需要更改`foo`函数的签名。

如果您不想更改函数签名，可以使用[自省](http://docs.python.org/library/inspect.html)来找出函数期望的参数：

```
arg_count = foo.func_code.co_argcount
args = foo.func_code.co_varnames[:arg_count]

args_dict = {}
for k, v in d.iteritems():
    if k in args:
        args_dict[k] = v

foo(**args_dict) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-23T19:47:43.673

有趣的问题。我认为现实生活中的大多数人都使用@Ashwini Chaudhary 方法。

我同意@Rodrigue 的观点，有时您无法修改函数的调用签名*（也许是其他人的模块）*。

发生这种情况时，**请使用函数装饰器**

```
from inspect import getargspec
from funtools import wraps

def allow_kwargs(foo):
    argspec = getargspec(foo)
    # if the original allows kwargs then do nothing
    if  argspec.keywords:
        return foo
    @wraps(foo)
    def newfoo(*args, **kwargs):
        #print "newfoo called with args=%r kwargs=%r"%(args,kwargs)
        some_args = dict((k,kwargs[k]) for k in argspec.args if k in kwargs) 
        return foo(*args, **some_args)
    return newfoo

# with your function:
@allow_kwargs
def foo(a = None, b=None, c=None):
  return "a:%s, b:%s, c:%s " % (a,b,c)

# with someone_elses function:
from some_place import foo
foo = allow_kwargs(foo) 
```

`@wraps`from functools 保持`__name__`和`__doc__`字符串的完整性。您还可以：

*   从装饰器模块看，`FunctionMaker`但这应该是一种更可重用的方法。
*   修改 newfoo 以允许不传递额外的非关键字变量。

# c++ - DirectX - 使用顶点数组作为参数创建缓冲区

> ID：11065420
> 
> 赞同：0
> 
> 时间：2012-06-16T17:04:37.917
> 
> 标签：c++, directx, vertex-buffer, vertex-array

今天我开始使用 DirectX(D3D9)，一切都很顺利，直到我创建了一个静态网格类。此类包含用于生成缓冲区、绘制和释放缓冲区的方法。

问题出在缓冲区生成函数中。如果我想将顶点数组作为参数传递给函数，则在绘制时不会绘制三角形（用三角形测试），但是，如果顶点是在函数中声明的（与作为论点），则不绘制三角形。

顶点类：

```
#define CUSTOMFVF (D3DFVF_XYZRHW | D3DFVF_DIFFUSE)
class CUSTOMVERTEX
{
public:
    float X, Y, Z, RHW;
    DWORD Color;
}; 
```

顶点缓冲区生成函数（不起作用）：

```
void StaticMesh::CreateBuffer(CUSTOMVERTEX Vertices[], LPDIRECT3DDEVICE9 d3ddev)
{
    // USING FIXED SIZE WHILE TESTING WITH A SINGLE TRIANGLE.
    d3ddev->CreateVertexBuffer(3*sizeof(CUSTOMVERTEX), 0, CUSTOMFVF, D3DPOOL_MANAGED, &Buffer, NULL);

    VOID* p;

    Buffer->Lock(0, 0, (void**)&p, 0);
    memcpy(p, Vertices, sizeof(Vertices));
    Buffer->Unlock();
} 
```

顶点缓冲区生成函数（确实有效）：

```
void StaticMesh::CreateBuffer(LPDIRECT3DDEVICE9 d3ddev)
{
    CUSTOMVERTEX vertices[3] = 
    {
        { 400.0f, 62.5f, 0.5f, 1.0f, D3DCOLOR_XRGB(0, 0, 255), },
        { 650.0f, 500.0f, 0.5f, 1.0f, D3DCOLOR_XRGB(0, 255, 0), },
        { 150.0f, 500.0f, 0.5f, 1.0f, D3DCOLOR_XRGB(255, 0, 0), },
    };

    // USING FIXED SIZE WHILE TESTING WITH A SINGLE TRIANGLE.
    d3ddev->CreateVertexBuffer(3*sizeof(CUSTOMVERTEX), 0, CUSTOMFVF, D3DPOOL_MANAGED, &Buffer, NULL);

    VOID* p;

    Buffer->Lock(0, 0, (void**)&p, 0);
    memcpy(p, Vertices, sizeof(Vertices));
    Buffer->Unlock();
} 
```

我看不出有什么问题。感谢您的帮助，如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:56:49.657

函数的参数 Vertices

```
void StaticMesh::CreateBuffer(CUSTOMVERTEX Vertices[], LPDIRECT3DDEVICE9 d3ddev) 
```

是一个类型指针。因此，函数内部的 sizeof(Vertices) 仅返回指针的大小，而不是您期望的整个数组的大小。

请将顶点数作为另一个参数传递给函数并像这样修改函数。

```
void StaticMesh::CreateBuffer(CUSTOMVERTEX Vertices[], int aNumVertices, LPDIRECT3DDEVICE9 d3ddev)
{
    // USING FIXED SIZE WHILE TESTING WITH A SINGLE TRIANGLE.
    d3ddev->CreateVertexBuffer(aNumVertices*sizeof(CUSTOMVERTEX), 0, CUSTOMFVF, D3DPOOL_MANAGED, &Buffer, NULL);

    VOID* p;

    Buffer->Lock(0, 0, (void**)&p, 0);
    memcpy(p, Vertices, aNumVertices * sizeof(CUSTOMVERTEX));
    Buffer->Unlock();
} 
```

# command-line - 命令提示符不会将目录更改为另一个驱动器

> ID：11065421
> 
> 赞同：433
> 
> 时间：2012-06-16T17:04:39.977
> 
> 标签：command-line, cmd, directory, command-line-interface, command-prompt

我正在尝试编译一些java（目前正在学习java），为此我需要更改命令提示符的目录。

```
C:\...\Admin> cd D:\Docs\Java
C:\...\Admin> cd
C:\...\Admin 
```

它不会更改目录。我再次尝试使用引号：

```
C:\...\Admin> cd "D:\Docs\Java"
C:\...\Admin> 
```

同样，它不会更改目录。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：810
> 
> 时间：2012-06-16T17:40:26.543

正如[@nasreddine](https://stackoverflow.com/users/162671/nasreddine)回答的那样，或者您可以使用`/d`

```
cd /d d:\Docs\Java 
```

有关`cd`命令的更多帮助，请使用：

```
C:\Documents and Settings\kenny>help cd 
```

> 显示或更改当前目录的名称。
> 
> CHDIR [/D] [驱动器:][路径] CHDIR [..] CD [/D] [驱动器:][路径] CD [..]
> 
> .. 指定要更改到父目录。
> 
> 键入 CD 驱动器：显示指定驱动器中的当前目录。键入不带参数的 CD 以显示当前驱动器和目录。
> 
> 除了更改驱动器的当前目录外，使用 /D 开关更改当前驱动器。
> 
> 如果启用命令扩展，则 CHDIR 更改如下：
> 
> 当前目录字符串被转换为使用与磁盘名称相同的大小写。因此，如果磁盘上存在这种情况，CD C:\TEMP 实际上会将当前目录设置为 C:\Temp。
> 
> CHDIR 命令不将空格视为分隔符，因此可以将 CD 放入包含空格的子目录名称中，而不用引号将名称括起来。例如：
> 
> cd \winnt\profiles\用户名\程序\开始菜单
> 
> 是相同的：
> 
> cd "\winnt\profiles\用户名\程序\开始菜单"
> 
> 如果扩展程序被禁用，这是您必须输入的内容。

* * *

## 回答 #2

> 赞同：176
> 
> 时间：2012-06-16T17:11:19.597

您要切换到的目录位于另一个驱动器上，您需要使用以下命令切换到该驱动器：

```
C:\...\Admin> d: 
```

然后你可以`cd`进入你想要的目录。

```
C:\...\Admin> d:
D:\>cd "Docs\Java"

D:\Docs\Java> 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2015-10-08T11:34:54.257

使用驱动器号*d*更改为*D*驱动器，例如：

```
 C:\> d: 
```

更换驱动器时，只需键入驱动器号，如**d:（**不要*使用反斜杠，如 d:\；它不起作用*）。

> 只有在同一驱动器内的目录之间移动时才使用**cd 。**

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2017-07-08T11:08:23.567

### 简短的回答

`C:\...\Admin`从驱动器到驱动器的正确方法`D:\Docs\Java`是以下命令：

```
cd /d d:\Docs\Java 
```

* * *

### 更多细节

如果您在`D:\`驱动器上的某个地方是随机的，并且想要转到驱动器的根目录，则可以使用以下命令：

```
cd d:\ 
```

如果您在`D:\`驱动器上的某个地方是随机的，并且想要转到驱动器上的特定文件夹，则可以使用以下命令：

```
cd d:\Docs\Java 
```

如果您在不同的驱动器上，并且想要转到`D:\`驱动器的根目录，则可以使用以下命令：

```
cd /d d:\ 
```

如果您在不同的驱动器上，并且想要转到`D:`驱动器上的特定文件夹，则可以使用以下命令：

```
cd /d d:\Docs\Java 
```

如果您在不同的驱动器上，并且想要转到`D:`驱动器的最后一个打开文件夹，则可以使用以下命令：

```
cd /d d: 
```

作为 的简写`cd /d d:`，您还可以使用以下命令：

```
d: 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2017-12-06T16:01:40.990

您应该在路径之前使用 /d ，如下所示：

```
cd /d e:\ 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-09-25T11:50:30.093

如果要从当前工作目录更改到另一个目录，则需要在命令提示符下键入要更改到的驱动器的名称，后跟：符号。示例：假设您要更改为 D 盘并且您当前在 C 盘中，然后键入 D: 并按 Enter。

另一方面，如果您希望更改同一工作目录中的目录，请使用 cd(change directory) 命令后跟目录名称。示例：假设您希望更改为新文件夹，然后键入：cd“新文件夹”并按 Enter。

使用 CMD 的提示：Windows 命令行不区分大小写。使用带空格的文件或目录时，请将其括在引号中。例如，我的文档将是“我的文档”。在命令行中删除文件或目录时，不会将其移至回收站。如果您需要任何命令类型的帮助 /? 命令之后。例如，目录 /? 将给出可用于 dir 命令的选项。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2019-07-11T06:45:06.397

为了在 windows 使用移动到 D 盘，C:\Users\Balaji>d:

为了移动到E盘使用，C:\Users\Balaji>e:

这同样适用于其他驱动器。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-03-30T07:05:51.343

您可以使用此命令更改目录，例如：当前，如果您当前的工作目录是 c:\ 驱动器，如果您想转到 D:\ 驱动器，则键入此命令

```
cd /d D:\ 
```

现在您当前的工作目录是 D:\ 驱动器，因此您想转到 Docs 下的 Java 目录，因此请键入以下命令：

```
cd Docs\Java 
```

注：d 代表驱动器

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-04-28T07:45:28.647

一种更简单的方法是使用**PowerShell**，它不需要任何附加标志：

```
W:\> cd C:\path\on\different\disk 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-02-24T09:12:24.207

我想你使用的是Windows系统。

打开 CMD 后，您将看到默认位置，即像这样

C:\Users\Admin - 在您的情况下，它的管理员如前所述，它将是您计算机的用户名

考虑是否要移动到 E 目录，然后只需键入 E：

这会将用户移动到 E：目录。现在更改为您要在 E: Drive 中指向的任何文件夹

例如：如果要移动到 E 文件夹的 Software 目录，则首先键入

E：

然后输入文件夹的位置

cd E:\软件

中提琴

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-02-01T11:40:13.550

Windows 上的`cd`命令对于 Linux 系统的用户来说并不直观。如果您希望`cd`转到另一个目录，无论它是在当前驱动器中还是另一个驱动器中，您都可以为`cd`. 以下是如何在[Cmder](https://github.com/cmderdev/cmder)中执行此操作：

*   转到`$CMDER_ROOT/config`并打开文件`user_aliases.cmd`
*   将以下内容添加到文件末尾：

```
cd=cd /d $* 
```

重新启动 Cmder，您应该能够 cd 到您想要的任何目录。这是一个小技巧，但效果很好，可以节省您的时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-08-26T21:53:17.820

您可以通过编写此命令 cd /? 在 cd 命令的命令提示符下使用帮助 如图所示 [![在此处输入图像描述](../Images/9cb20dd960f78547423e6d6821959b6d.png)](https://i.stack.imgur.com/otMhJ.jpg)

# ios - 表和数组

> ID：11065424
> 
> 赞同：0
> 
> 时间：2012-06-16T17:04:56.390
> 
> 标签：ios, uitableview

我对 TableView 有问题，它是空的。

在（.h）文件中：

```
@interface TableViewController : UITableViewController{

NSMutableArray *coursArray; } 
```

在 (.m) 文件中：

在`viewDidLoad`

```
[coursArray addObject:[[NSMutableDictionary alloc]initWithObjectsAndKeys:@"AR111",@"courseCode",@"Arabic Communication Skills (I)",@"courseName", nil]];
[coursArray addObject:[[NSMutableDictionary alloc]initWithObjectsAndKeys:@"AR112",@"courseCode",@"Arabic Communication Skills (II)",@"courseName", nil]]; 
```

并且在`numberOfRowsInSection`

```
return [coursArray count]; 
```

并且在`cellForRowAtIndexPath`

```
cell.textLabel.text = [[coursArray objectAtIndex:indexPath.row]objectForKey:@"courseCode"]; 
```

所以有什么问题请帮助我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:20:37.473

很好。只需确保在 viewDidLoad 中也对 coursArray 本身进行必要的分配和初始化，例如

```
coursArray = [[NSMutableArray alloc] init] 
```

# java - 如何检查对象是否在 CPU 缓存中？

> ID：11065426
> 
> 赞同：0
> 
> 时间：2012-06-16T17:05:21.410
> 
> 标签：java, caching, cache-control, low-level, cpu-cache

java中有没有办法检查特定对象是否在CPU缓存中？有没有办法测试读取/写入其中一个字段是否会导致缓存未命中？

过去我写过java程序，但不复杂，现在我必须在java方面做一些学术研究。

如果这是不可能的，是否有一种通用的方法来模拟这种事情？这在诸如 C 之类的低级编程中是否可能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T17:20:39.210

TL;DR - 没有

在 Java 中，JVM 将您与 CPU 隔离开来，因此这种低级信息在设计上不会暴露给程序。

此外，即使您使用较低级别的语言（例如，C）并使用了一些汇编级别的技巧，我也很难想象您可以从哪里获得有关缓存状态的有意义的数据，原因如下：缓存是动态的 - 新数据是不断地加载到其中，并且（较旧的）数据不断地从其中刷新。在每个给定的时刻，您都有几个进程在 CPU 上运行，每个进程都产生至少一个线程（可能不止一个）——所有这些线程的组合活动会影响缓存和存储在其中的数据。

因此，即使你能得到一个 Y/N 的答案，`is object X in cache`那么这个答案在你得到它的那一刻就会过时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:29:38.110

正如其他人已经说过的那样：不。

即使您可以查询缓存中的特定数据，也无法确定整个对象是否在缓存中，因为在如此低的级别上没有这样的概念。

# jsf-2 - 如何在 jsf 中获取多选复选框值？

> ID：11065427
> 
> 赞同：3
> 
> 时间：2012-06-16T17:05:39.447
> 
> 标签：jsf-2

我创建了复选框。当我选择了多个复选框时，如何获得这些多个选中的复选框值？我的代码是：

```
<h:selectManyCheckbox id="chkedition" value="#{adcreateBean.editionID}" layout="lineDirection" styleClass="nostyle">
<f:selectItems value="#{adcreateBean.editions}" var="item" itemLabel="#{item.editionName}" itemValue="#{item.editionID}"/>
</h:selectManyCheckbox> 
```

我采用了 value="#{adcreateBean.editionID}" ，因此它返回单个值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:43:12.800

组件的需要指向一个数组或`value`与. 假设它是，那么它需要绑定到 a或。`<h:selectManyXxx>``List``itemValue``Long``Long[]``List<Long>`

例如

```
private Long[] selectedEditionIds; // +getter +setter
private List<Edition> availableEditions; // +getter 
```

和

```
<h:selectManyCheckbox value="#{bean.selectedEditionIds}">
    <f:selectItems value="#{bean.availableEditions}" var="edition" itemLabel="#{edition.name}" itemValue="#{edition.id}" />
</h:selectManyCheckbox> 
```

如果您更喜欢 a `List<Long>`，那么您应该显式地为该`Long`类型提供一个转换器，因为泛型类型在运行时会被删除，并且如果没有转换器，EL 会在 中设置`String`值，`List`最终只会导致`ClassCaseException`s。因此：

```
private List<Long> selectedEditionIds; // +getter +setter
private List<Edition> availableEditions; // +getter 
```

和

```
<h:selectManyCheckbox value="#{bean.selectedEditionIds}" converter="javax.faces.Long">
    <f:selectItems value="#{bean.availableEditions}" var="edition" itemLabel="#{edition.name}" itemValue="#{edition.id}" />
</h:selectManyCheckbox> 
```

# javascript - DZSlides 如何缩放视口内容？

> ID：11065431
> 
> 赞同：2
> 
> 时间：2012-06-16T17:06:06.753
> 
> 标签：javascript, css

我喜欢[DZSlides](http://paulrouget.com/dzslides)如何使用像素尺寸并将它们缩放到视口大小，因为它为演示文稿提供了一些很好的可预测性（尽管我不想在常规网站上使用它）。

但是，我似乎无法弄清楚缩放是如何工作的——我自己重新创建[代码](https://github.com/paulrouget/dzslides/blob/054cf071bd9d013e1e468d8236e79478ce847da4/template.html#L401)的尝试有一些烦人的怪癖，要么没有占据整个高度，要么表现出奇怪的垂直偏移：

[http://jsfiddle.net/vYA8L/](http://jsfiddle.net/vYA8L/)

对于我的示例缺少的内容以及 DZSlides 的实际工作原理，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T11:17:15.273

DZSlides 设置`body`为[800x600 并在窗口中居中](https://github.com/paulrouget/dzslides/blob/054cf071bd9d013e1e468d8236e79478ce847da4/template.html#L208)（我添加的评论）：

```
body {
    width: 800px; height: 600px;
    margin-left: -400px; margin-top: -300px;  /* these two lines center */
    position: absolute; top: 50%; left: 50%;  /* body in the window     */
    ...
} 
```

并且每张幻灯片都有[`width: 100%`和`height: 100%`](https://github.com/paulrouget/dzslides/blob/054cf071bd9d013e1e468d8236e79478ce847da4/template.html#L229)，这意味着幻灯片从 . 继承它们的宽度和高度`body`。

JavaScript 代码实际上会缩放`body`以适应窗口，因此通过扩展，每张幻灯片也会缩放以适应窗口。

[使用](http://jsfiddle.net/vYA8L/1/)这些样式更新的 jsFiddle 将正确缩放。

如果要缩放幻灯片元素而不是`body`，可以将相同的样式/计算应用于幻灯片（[演示](http://jsfiddle.net/vYA8L/2/)）。

# grails - Grails 表单验证

> ID：11065436
> 
> 赞同：-1
> 
> 时间：2012-06-16T17:07:03.533
> 
> 标签：grails

在 grails 中验证表单的最简单方法是什么？我没有使用脚手架。我也不想使用 jquery 编写那些 javascript。我知道 jquery 插件，但文档不是很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:36:15.543

最简单的方法？

使用动态脚手架并实施约束，即

```
class User {

  String name
  String password
  String personalInfo

  static constraints = {
    name(size: 4..20, unique:true, blank:false)
    password(size:8..20, blank:false)
    personalInfo(size: 1000, nullable:true)
  }
} 
```

如果您不想使用动态脚手架，则必须通过`grails User generate-all`命令行为对象创建控制器和视图。这将为用户域生成控制器和视图，您可以在其中随意修改。但是，这更复杂，您需要熟悉 GSP 标签

# ruby-on-rails - 无法让设计全能工作

> ID：11065439
> 
> 赞同：4
> 
> 时间：2012-06-16T17:07:19.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, omniauth

我需要访问谷歌 API，我试图让用户使用 Devise 2.1.1 和 Omniauth 使用他们的谷歌帐户登录（使用 gem `google_oauth2`，因为 OAuth2 是谷歌文档中推荐的一个）。

不幸的是我无法让它工作，这是`routes.rb`

```
TestApp::Application.routes.draw do
  root :to => 'Landing#index'

  devise_for :users, :controllers => { :omniauth_callbacks => "users/omniauth_callbacks" }

  devise_scope :user do
    get 'sign_in', :to => 'users/sessions#new', :as => :new_session
    get 'sign_out', :to => 'users/sessions#destroy', :as => :destroy_session
  end
end 
```

然后我配置`config/initializers/devise.rb`为包含一行

```
 config.omniauth :google_oauth2, 'ID', 'SECRET', {access_type: 'offline', approval_prompt: 'force', scope: 'https://www.googleapis.com/auth/analytics.readonly'} 
```

实际上我有一个 void 回调类`app/controllers/users/omniauth_callbacks_controller.rb`

```
class Users::OmniauthCallbacksController < Devise::OmniauthCallbacksController
end 
```

当我单击“使用 Google 登录”时，我在 Google 上被重定向，请求授权，然后我返回回调，并在 URL 上被重定向并`http://localhost:3000/sign_in.user`出现错误

```
uninitialized constant Users::SessionsController 
```

这里有什么问题？我花了 2 天时间试图自己弄清楚它，我玩了很多配置，但从来没有让它工作，它开始让我感到沮丧。

这是来自的输出`rake routes`

```
root     /                                      Landing#index
user_omniauth_authorize     /users/auth/:provider(.:format)        users/omniauth_callbacks#passthru {:provider=>/google_oauth2/}
user_omniauth_callback     /users/auth/:action/callback(.:format) users/omniauth_callbacks#(?-mix:google_oauth2)
new_session GET /sign_in(.:format)                     users/sessions#new
destroy_session GET /sign_out(.:format)                    users/sessions#destroy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-08T23:35:19.997

您似乎被重定向到您的`sign_in`路线，该路线`users/sessions#new`根据您的`routes.rb`.

但是，`Users::SessionsController`不存在导致您描述的错误。

我不确定在哪些情况下 Devise/OmniAuth 会将您重定向到该特定路线，但我想您可以将其转到您的主页（人们可以再次单击 Google OAuth 登录按钮/链接）或将其直接连接到Google OAuth 页面。（这可能会让人们陷入无限循环，具体取决于 Devise/OmniAuth 使用`sign_in`路由的方式。）

# vim - 有没有办法让 vim 中的 yanks 可视化？

> ID：11065441
> 
> 赞同：3
> 
> 时间：2012-06-16T17:07:36.840
> 
> 标签：vim

在 vim 中拉动时，您刚刚进行的拉动没有视觉指示。除了检查寄存器之外，有没有人知道一个设置或插件可以使 vim 突出显示刚刚被拉出的编辑器区域？

尝试谷歌搜索，但如果它在那里，我使用错误的短语进行搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T20:07:27.303

您可能可以使用`'[`and`']`来标记最后一个被拉出的文本的开头和结尾，但您的目的是什么，究竟是什么？您想验证您实际拉动的内容是否与您想要拉动的内容相对应？请澄清你的问题。

相反，您可以做的是反转整个过程：

1.  使用*视觉*模式或*视觉线*模式来直观地选择你想要拉的东西
2.  拉它

这样您就可以确切地知道要拉出什么，*并且*可以使用 重新选择它`gv`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T20:35:01.767

怎么会这样？

除了 yanking word 或 line，当你通常知道你 yanking 的内容时，大多数 yanks 是通过视觉或块模式完成的，而在那些你知道什么是 yanking 的情况下，因为它是在 yanking 之前选择的。

但是除此之外，就像您说的那样，您可以查看寄存器，或者您可以安装像 YankRing 之类的插件（或其一些更简单的 coutnerparts）。它为您提供了一个很棒的功能，可以快速（pff，除非您使用多个剪贴板管理器，这有点难以解释）在抽出的文本之间切换。您按下，`p`粘贴，然后从那里选择，让我们说出`Ctrl-p`您想要拉入到位的内容。这是一个非常实用且易于使用的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-17T16:28:37.057

我不知道它是否总是有效，但我试过了

```
vnoremap <silent> y y:execute '2match InterestingWord2 /<c-r>"/'<cr>
hi InterestingWord2 guibg=DarkOrange guifg=black ctermbg=202 ctermfg=black 
```

它适用于单行的视觉选择 - 但不适用于多行。

也许以下工作也是 - 我没有尝试过

```
nnoremap <silent> yy yy:execute '2match InterestingWord2 /<c-r>"/'<cr>
nnoremap <silent> y$ y$:execute '2match InterestingWord2 /<c-r>"/'<cr>
nnoremap <silent> Y Y:execute '2match InterestingWord2 /<c-r>"/'<cr> 
```

# asp.net - 将 Twitter Bootstrap 与 Asp.net MVC 3 表单集成

> ID：11065442
> 
> 赞同：25
> 
> 时间：2012-06-16T17:07:46.247
> 
> 标签：asp.net, twitter-bootstrap, forms, asp.net-mvc-3, unobtrusive-validation

我正在使用 Asp.net MVC 3 和 Twitter Bootstrap。我想要的是整合它们。对我来说最大的问题是表格。我正在使用`HtmlHelper`它，这是一个问题，当涉及到验证时，我希望它生成这样的 HTML：

```
<div class="control-group error">
   <label for="field" class="control-label">OMG this label is so awesome: </label>
   <div class="controls">
      <input type="text" name="field" id="field" value="yeah" />
      <span class="help-inline">Eventually some error :C</span>
   </div>
</div> 
```

这是我的 HtmlHelper 代码：

```
@Html.LabelFor(x => x.Field)
@Html.EditorFor(x => x.Field)
@Html.ValidationMessagesFor(x => x.Field) 
```

问题是我希望仅在此字段上确实存在错误时才设置最外层 div 上的类错误。另一个问题是我不知道如何强制使用 span 标签来处理错误。我可以在 HtmlHelper 中编写我的方法，但它会让我重新实现几乎所有的`LabelFor`,`EditorFor`和`ValidationMessageFor`. 有没有更简单的方法来做到这一点？那么不显眼的验证呢？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-25T16:10:09.287

我遇到了同样的挑战，并且在标签方面得到了一些帮助（见下文），这就是我得到的：

```
<div class="control-group @if (!ViewData.ModelState.IsValidField("Name")) { @Html.Raw("error"); }">
    @Html.LabelFor(model => model.Name, new {@class = "control-label"})
    <div class="controls">
        @Html.EditorFor(model => model.Name)
        @Html.ValidationMessageFor(model => model.Name, null, new {@class = "help-inline"})
    </div>
</div> 
```

`Html.LabelFor`实施：[https ://stackoverflow.com/a/6722082](https://stackoverflow.com/a/6722082)

我没有尝试不显眼的验证，但似乎你只需要激活它。

如果你正在寻找一个**全局**错误，你应该使用类似的东西：

```
@if (ViewData.ModelState.IsValid == false) {
    <div class="alert alert-error"><button class="close" dismiss="alert">x</button><!-- some text--></div>
} 
```

这里有一个**活生生的例子**（法语）**：[http ://ws.sherbrow.fr/auth](http://ws.sherbrow.fr/auth)**

整个项目的源代码应该很快就会提供（请参阅我的个人资料 - 或直接询问我）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-08T04:24:25.313

答案有点晚了，但我会提出一个更好的解决方案，你应该完全接受我的回答；）

使用[TwitterBootstrapMVC](https://www.twitterbootstrapmvc.com/)。

只需一行代码，它将完全生成您需要的 html：

```
@Html.Bootstrap().ControlGroup().TextBoxFor(x => x.Field) 
```

对于全局错误，您需要编写的是：

```
@Html.Bootstrap().ValidationSummary() 
```

...它将生成一个警报 div，其中列出了所有错误。请注意，对于客户端验证，它需要[一些 JavaScript](https://www.twitterbootstrapmvc.com/Scripts/TwitterBootstrapMvcJs-3.0.0.js)才能正确设置样式。

最重要的是，它会为您处理所有不显眼的验证标签。它还提供流畅的语法，可以完全自定义输入/标签......

看看这个！

免责声明：我是 TwitterBootstrapMVC 的作者，从 Bootstrap 3（和 TwitterBootstrapMVC 3）开始，TwitterBootstrapMVC 需要使用许可证。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-01T12:03:22.373

我冒昧地创建了一个扩展方法，该方法封装了来自 Sherbrow 的代码，以在字段无效时呈现错误类。这种扩展方法的优点是它是强类型的并且写起来更短：

```
public static MvcHtmlString ModelStateFor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression)
    {
        var modelMetadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);

        if (html.ViewData.ModelState.IsValidField(modelMetadata.PropertyName))
        {
            return MvcHtmlString.Empty; 
        }

        return new MvcHtmlString("error");
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T21:01:55.810

有[一篇关于 BrainDonor](http://www.braindonor.net/blog/integrating-bootstrap-error-styling-with-mvcs-unobtrusive-error-validation/381/)的文章，我仅使用主要的 LabelFor、EditorFor 和 ValidationFor 就成功实现了。我已经放置了这是一个站点范围的 js，然后只需确保我有控制组 div 就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T14:46:58.673

您可以通过将以下 javascript 添加到您的页面（查看）来将 MVC3 验证与 Bootstrap 框架集成

```
<script>
$(document).ready(function () {
/* Bootstrap Fix */
$.validator.setDefaults({
    highlight: function (element) {
        $(element).closest("div.control-group").addClass("error");
    },
    unhighlight: function (element) {
        $(element).closest("div.control-group").removeClass("error");
    }
});
var current_div;
$(".editor-label, .editor-field").each(function () {
    var $this = $(this);
    if ($this.hasClass("editor-label")) {
        current_div = $('<div class="control-group"></div>').insertBefore(this);
    }
    current_div.append(this);
});
$(".editor-label").each(function () {
    $(this).contents().unwrap();
});
$(".editor-field").each(function () {
    $(this).addClass("controls");
    $(this).removeClass("editor-field");
});
$("label").each(function () {
    $(this).addClass("control-label");
});
$("span.field-validation-valid, span.field-validation-error").each(function () {
    $(this).addClass("help-inline");
});
$("form").each(function () {
    $(this).addClass("form-horizontal");
    $(this).find("div.control-group").each(function () {
        if ($(this).find("span.field-validation-error").length > 0) {
            $(this).addClass("error");
        }
    });
});
});
</script> 
```

此外，在视图（例如“Create.cshtml”）上，确保表单中的字段格式如下...

```
 <div class="editor-label">
        @Html.LabelFor(Function(model) model.Name)
    </div>
    <div class="editor-field">
        @Html.EditorFor(Function(model) model.Name)
        @Html.ValidationMessageFor(Function(model) model.Name)
    </div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-09T15:41:08.023

我不知道这是否会帮助任何人，但我已经修改了 M$ 的 jquery.validate.unobtrusive.js 来实现这一点。它覆盖了 $.validator.setDefaults() 提供的默认设置，给我带来了问题。如果您用这个替换 JS 文件，它应该可以像您希望它与 bootstrap 的 CSS 一起使用（不需要其他更改 - 除了输入元素和标签上的一些 CSS 类）。

$jQval.setDefaults() 是主要内容。剩下的只是我修复 M$ 的代码。

这是文件：

```
/* NUGET: BEGIN LICENSE TEXT
 *
 * Microsoft grants you the right to use these script files for the sole
 * purpose of either: (i) interacting through your browser with the Microsoft
 * website or online service, subject to the applicable licensing or use
 * terms; or (ii) using the files as included with a Microsoft product subject
 * to that product's license terms. Microsoft reserves all other rights to the
 * files not expressly granted by Microsoft, whether by implication, estoppel
 * or otherwise. Insofar as a script file is dual licensed under GPL,
 * Microsoft neither took the code under GPL nor distributes it thereunder but
 * under the terms set out in this paragraph. All notices and licenses
 * below are for informational purposes only.
 *
 * NUGET: END LICENSE TEXT */
/*!
** Unobtrusive validation support library for jQuery and jQuery Validate
** Copyright (C) Microsoft Corporation. All rights reserved.
*/

/*jslint white: true, browser: true, onevar: true, undef: true, nomen: true, eqeqeq: true, plusplus: true, bitwise: true, regexp: true, newcap: true, immed: true, strict: false */
/*global document: false, jQuery: false */

(function ($) {
    var $jQval = $.validator,
        adapters,
        data_validation = "unobtrusiveValidation";

    // Override jquery validate plugin defaults in order to utilize Twitter Bootstrap 3 has-error, has-success, etc. styling.
    $jQval.setDefaults({
        highlight: function (element, errorClass, validClass) {
            if (element.type === 'radio') {
                this.findByName(element.name).addClass(errorClass).removeClass(validClass);
            } else {
                $(element).addClass(errorClass).removeClass(validClass);
                $(element).closest('.form-group').removeClass('success').addClass('has-error');
            }
        },
        unhighlight: function (element, errorClass, validClass) {
            if (element.type === 'radio') {
                this.findByName(element.name).removeClass(errorClass).addClass(validClass);
            } else {
                $(element).removeClass(errorClass).addClass(validClass);
                $(element).closest('.form-group').removeClass('has-error').addClass('success');
            }
        },
        errorElement: 'span',
        errorClass: 'help-block',
        errorPlacement: function (error, element) {
            if (element.parent('.input-group').length || element.prop('type') === 'checkbox' || element.prop('type') === 'radio') {
                error.insertAfter(element.parent());
            } else {
                error.insertAfter(element);
            }
        }
    });

    $('span.field-validation-valid, span.field-validation-error').each(function () {
        $(this).addClass('help-inline');
    });

    function setValidationValues(options, ruleName, value) {
        options.rules[ruleName] = value;
        if (options.message) {
            options.messages[ruleName] = options.message;
        }
    }

    function splitAndTrim(value) {
        return value.replace(/^\s+|\s+$/g, "").split(/\s*,\s*/g);
    }

    function escapeAttributeValue(value) {
        // As mentioned on http://api.jquery.com/category/selectors/
        //return value.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g, "\\$1");
        return value.replace(new RegExp("([!\"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])", 'g'), "\\$1");
    }

    function getModelPrefix(fieldName) {
        return fieldName.substr(0, fieldName.lastIndexOf(".") + 1);
    }

    function appendModelPrefix(value, prefix) {
        if (value.indexOf("*.") === 0) {
            value = value.replace("*.", prefix);
        }
        return value;
    }

    function onError(error, inputElement) {  // 'this' is the form element
        var container = $(this).find("[data-valmsg-for='" + escapeAttributeValue(inputElement[0].name) + "']"),
            replaceAttrValue = container.attr("data-valmsg-replace"),
            replace = replaceAttrValue ? $.parseJSON(replaceAttrValue) !== false : null;

        container.removeClass("field-validation-valid").addClass("field-validation-error");
        error.data("unobtrusiveContainer", container);

        if (replace) {
            container.empty();
            error.removeClass("input-validation-error").appendTo(container);
        }
        else {
            error.hide();
        }
    }

    function onErrors(event, validator) {  // 'this' is the form element
        var container = $(this).find("[data-valmsg-summary=true]"),
            list = container.find("ul");

        if (list && list.length && validator.errorList.length) {
            list.empty();
            container.addClass("validation-summary-errors").removeClass("validation-summary-valid");

            $.each(validator.errorList, function () {
                $("<li />").html(this.message).appendTo(list);
            });
        }
    }

    function onSuccess(error) {  // 'this' is the form element
        var container = error.data("unobtrusiveContainer"),
            replaceAttrValue = container.attr("data-valmsg-replace"),
            replace = replaceAttrValue ? $.parseJSON(replaceAttrValue) : null;

        if (container) {
            container.addClass("field-validation-valid").removeClass("field-validation-error");
            error.removeData("unobtrusiveContainer");

            if (replace) {
                container.empty();
            }
        }
    }

    function onReset(event) {  // 'this' is the form element
        var $form = $(this);
        $form.data("validator").resetForm();
        $form.find(".validation-summary-errors")
            .addClass("validation-summary-valid")
            .removeClass("validation-summary-errors");
        $form.find(".field-validation-error")
            .addClass("field-validation-valid")
            .removeClass("field-validation-error")
            .removeData("unobtrusiveContainer")
            .find(">*")  // If we were using valmsg-replace, get the underlying error
                .removeData("unobtrusiveContainer");
    }

    function validationInfo(form) {
        var $form = $(form),
            result = $form.data(data_validation),
            onResetProxy = $.proxy(onReset, form),
            defaultOptions = $jQval.unobtrusive.options || {},
            execInContext = function (name, args) {
                var func = defaultOptions[name];
                func && $.isFunction(func) && func.apply(form, args);
            }

        if (!result) {
            result = {
                options: $.extend($jQval.defaults, {  // options structure passed to jQuery Validate's validate() method
                    errorClass: defaultOptions.errorClass || "input-validation-error",
                    errorElement: defaultOptions.errorElement || "span",
                    errorPlacement: function () {
                        onError.apply(form, arguments);
                        execInContext("errorPlacement", arguments);
                    },
                    invalidHandler: function () {
                        onErrors.apply(form, arguments);
                        execInContext("invalidHandler", arguments);
                    },
                    messages: {},
                    rules: {},
                    success: function () {
                        onSuccess.apply(form, arguments);
                        execInContext("success", arguments);
                    }
                }),
                attachValidation: function () {
                    $form
                        .off("reset." + data_validation, onResetProxy)
                        .on("reset." + data_validation, onResetProxy)
                        .validate(this.options);
                },
                validate: function () {  // a validation function that is called by unobtrusive Ajax
                    $form.validate();
                    return $form.valid();
                }
            };
            $form.data(data_validation, result);
        }

        return result;
    }

    $jQval.unobtrusive = {
        adapters: [],

        parseElement: function (element, skipAttach) {
            /// <summary>
            /// Parses a single HTML element for unobtrusive validation attributes.
            /// </summary>
            /// <param name="element" domElement="true">The HTML element to be parsed.</param>
            /// <param name="skipAttach" type="Boolean">[Optional] true to skip attaching the
            /// validation to the form. If parsing just this single element, you should specify true.
            /// If parsing several elements, you should specify false, and manually attach the validation
            /// to the form when you are finished. The default is false.</param>
            var $element = $(element),
                form = $element.parents("form")[0],
                valInfo, rules, messages;

            if (!form) {  // Cannot do client-side validation without a form
                return;
            }

            valInfo = validationInfo(form);
            valInfo.options.rules[element.name] = rules = {};
            valInfo.options.messages[element.name] = messages = {};

            $.each(this.adapters, function () {
                var prefix = "data-val-" + this.name,
                    message = $element.attr(prefix),
                    paramValues = {};

                if (message !== undefined) {  // Compare against undefined, because an empty message is legal (and falsy)
                    prefix += "-";

                    $.each(this.params, function () {
                        paramValues[this] = $element.attr(prefix + this);
                    });

                    this.adapt({
                        element: element,
                        form: form,
                        message: message,
                        params: paramValues,
                        rules: rules,
                        messages: messages
                    });
                }
            });

            $.extend(rules, { "__dummy__": true });

            if (!skipAttach) {
                valInfo.attachValidation();
            }
        },

        parse: function (selector) {
            /// <summary>
            /// Parses all the HTML elements in the specified selector. It looks for input elements decorated
            /// with the [data-val=true] attribute value and enables validation according to the data-val-*
            /// attribute values.
            /// </summary>
            /// <param name="selector" type="String">Any valid jQuery selector.</param>

            // $forms includes all forms in selector's DOM hierarchy (parent, children and self) that have at least one
            // element with data-val=true
            var $selector = $(selector),
                $forms = $selector.parents()
                                  .addBack()
                                  .filter("form")
                                  .add($selector.find("form"))
                                  .has("[data-val=true]");

            $selector.find("[data-val=true]").each(function () {
                $jQval.unobtrusive.parseElement(this, true);
            });

            $forms.each(function () {
                var info = validationInfo(this);
                if (info) {
                    info.attachValidation();
                }
            });
        }
    };

    adapters = $jQval.unobtrusive.adapters;

    adapters.add = function (adapterName, params, fn) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute (where nnnn is the adapter name).</param>
        /// <param name="params" type="Array" optional="true">[Optional] An array of parameter names (strings) that will
        /// be extracted from the data-val-nnnn-mmmm HTML attributes (where nnnn is the adapter name, and
        /// mmmm is the parameter name).</param>
        /// <param name="fn" type="Function">The function to call, which adapts the values from the HTML
        /// attributes into jQuery Validate rules and/or messages.</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        if (!fn) {  // Called with no params, just a function
            fn = params;
            params = [];
        }
        this.push({ name: adapterName, params: params, adapt: fn });
        return this;
    };

    adapters.addBool = function (adapterName, ruleName) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation, where
        /// the jQuery Validate validation rule has no parameter values.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute (where nnnn is the adapter name).</param>
        /// <param name="ruleName" type="String" optional="true">[Optional] The name of the jQuery Validate rule. If not provided, the value
        /// of adapterName will be used instead.</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        return this.add(adapterName, function (options) {
            setValidationValues(options, ruleName || adapterName, true);
        });
    };

    adapters.addMinMax = function (adapterName, minRuleName, maxRuleName, minMaxRuleName, minAttribute, maxAttribute) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation, where
        /// the jQuery Validate validation has three potential rules (one for min-only, one for max-only, and
        /// one for min-and-max). The HTML parameters are expected to be named -min and -max.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute (where nnnn is the adapter name).</param>
        /// <param name="minRuleName" type="String">The name of the jQuery Validate rule to be used when you only
        /// have a minimum value.</param>
        /// <param name="maxRuleName" type="String">The name of the jQuery Validate rule to be used when you only
        /// have a maximum value.</param>
        /// <param name="minMaxRuleName" type="String">The name of the jQuery Validate rule to be used when you
        /// have both a minimum and maximum value.</param>
        /// <param name="minAttribute" type="String" optional="true">[Optional] The name of the HTML attribute that
        /// contains the minimum value. The default is "min".</param>
        /// <param name="maxAttribute" type="String" optional="true">[Optional] The name of the HTML attribute that
        /// contains the maximum value. The default is "max".</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        return this.add(adapterName, [minAttribute || "min", maxAttribute || "max"], function (options) {
            var min = options.params.min,
                max = options.params.max;

            if (min && max) {
                setValidationValues(options, minMaxRuleName, [min, max]);
            }
            else if (min) {
                setValidationValues(options, minRuleName, min);
            }
            else if (max) {
                setValidationValues(options, maxRuleName, max);
            }
        });
    };

    adapters.addSingleVal = function (adapterName, attribute, ruleName) {
        /// <summary>Adds a new adapter to convert unobtrusive HTML into a jQuery Validate validation, where
        /// the jQuery Validate validation rule has a single value.</summary>
        /// <param name="adapterName" type="String">The name of the adapter to be added. This matches the name used
        /// in the data-val-nnnn HTML attribute(where nnnn is the adapter name).</param>
        /// <param name="attribute" type="String">[Optional] The name of the HTML attribute that contains the value.
        /// The default is "val".</param>
        /// <param name="ruleName" type="String" optional="true">[Optional] The name of the jQuery Validate rule. If not provided, the value
        /// of adapterName will be used instead.</param>
        /// <returns type="jQuery.validator.unobtrusive.adapters" />
        return this.add(adapterName, [attribute || "val"], function (options) {
            setValidationValues(options, ruleName || adapterName, options.params[attribute]);
        });
    };

    $jQval.addMethod("__dummy__", function (value, element, params) {
        return true;
    });

    $jQval.addMethod("regex", function (value, element, params) {
        var match;
        if (this.optional(element)) {
            return true;
        }

        match = new RegExp(params).exec(value);
        return (match && (match.index === 0) && (match[0].length === value.length));
    });

    $jQval.addMethod("nonalphamin", function (value, element, nonalphamin) {
        var match;
        if (nonalphamin) {
            match = value.match(/\W/g);
            match = match && match.length >= nonalphamin;
        }
        return match;
    });

    if ($jQval.methods.extension) {
        adapters.addSingleVal("accept", "mimtype");
        adapters.addSingleVal("extension", "extension");
    } else {
        // for backward compatibility, when the 'extension' validation method does not exist, such as with versions
        // of JQuery Validation plugin prior to 1.10, we should use the 'accept' method for
        // validating the extension, and ignore mime-type validations as they are not supported.
        adapters.addSingleVal("extension", "extension", "accept");
    }

    adapters.addSingleVal("regex", "pattern");
    adapters.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url");
    adapters.addMinMax("length", "minlength", "maxlength", "rangelength").addMinMax("range", "min", "max", "range");
    adapters.addMinMax("minlength", "minlength").addMinMax("maxlength", "minlength", "maxlength");
    adapters.add("equalto", ["other"], function (options) {
        var prefix = getModelPrefix(options.element.name),
            other = options.params.other,
            fullOtherName = appendModelPrefix(other, prefix),
            element = $(options.form).find(":input").filter("[name='" + escapeAttributeValue(fullOtherName) + "']")[0];

        setValidationValues(options, "equalTo", element);
    });
    adapters.add("required", function (options) {
        // jQuery Validate equates "required" with "mandatory" for checkbox elements
        if (options.element.tagName.toUpperCase() !== "INPUT" || options.element.type.toUpperCase() !== "CHECKBOX") {
            setValidationValues(options, "required", true);
        }
    });
    adapters.add("remote", ["url", "type", "additionalfields"], function (options) {
        var value = {
            url: options.params.url,
            type: options.params.type || "GET",
            data: {}
        },
            prefix = getModelPrefix(options.element.name);

        $.each(splitAndTrim(options.params.additionalfields || options.element.name), function (i, fieldName) {
            var paramName = appendModelPrefix(fieldName, prefix);
            value.data[paramName] = function () {
                return $(options.form).find(":input").filter("[name='" + escapeAttributeValue(paramName) + "']").val();
            };
        });

        setValidationValues(options, "remote", value);
    });
    adapters.add("password", ["min", "nonalphamin", "regex"], function (options) {
        if (options.params.min) {
            setValidationValues(options, "minlength", options.params.min);
        }
        if (options.params.nonalphamin) {
            setValidationValues(options, "nonalphamin", options.params.nonalphamin);
        }
        if (options.params.regex) {
            setValidationValues(options, "regex", options.params.regex);
        }
    });

    $(function () {
        $jQval.unobtrusive.parse(document);
    });
}(jQuery)); 
```

# objective-c - 错误访问代码 1：访问对象实例变量

> ID：11065450
> 
> 赞同：0
> 
> 时间：2012-06-16T17:08:21.723
> 
> 标签：objective-c, arrays, loops

我已经建立了一个对象数组，从一个类创建，我之前写过。我只是想在遍历数组时访问一些类变量：

```
- (void)viewDidLoad
{
       [super viewDidLoad];

       NSMutableArray *medicalCenters = [(AppDelegate *)[[UIApplication sharedApplication] delegate] medicalCenters];

       for (MedicalCenter *row in medicalCenters){
           NSString *latitude = row.MCLatitude;
           NSLog(@"%@", latitude);
       }
} 
```

我创建的类文件如下所示：

```
#import <Foundation/Foundation.h>
#import <MapKit/MapKit.h>

@interface MedicalCenter : NSObject
{
    CLLocationCoordinate2D _coordinate;
}

@property (nonatomic, strong) NSString *medicalCenter;
@property (nonatomic, assign) NSString *MCLatitude;
@property (nonatomic, assign) NSString *MCLongitude;
@property (nonatomic, readonly) CLLocationCoordinate2D coordinate;

- (id)initWithName:(NSString *)medicalCenter coordinate:(CLLocationCoordinate2D)coordinate;

@end 
```

每当我建立 时`NSString *latitude = row.MCLatitude`，我都会收到消息：Bad_excess Code:1

但是当我只列出数组medicalCenters 中的对象时，我可以看到它们全部............我错过了什么重要的东西吗？

谢谢塞巴斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:15:44.727

那是因为内存管理不好，`MCLatitude`并且`MCLongitude`属性设置为（分配），它们没有被正确保留，不知道你将它们设置为分配的原因，我看不到任何理由，所以如果你将它们更改为坚强，并使用setter分配值，应该没问题。

```
@property (nonatomic, strong) NSString *MCLatitude;
@property (nonatomic, strong) NSString *MCLongitude; 
```

# c# - C# 4.0 COM 类库

> ID：11065451
> 
> 赞同：1
> 
> 时间：2012-06-16T17:08:34.593
> 
> 标签：c#, class, com

如何使我的类库 STA 与 VBScript 中的 CreateObject 一起使用？我想确保当我执行以下操作时（请参见下文），该过程应该终止/处置。

```
Set MyObject = Nothing ' Dispose 
```

这可能吗？我已经看到，当我运行上述语句时，我的对象没有被释放，我的析构函数也没有被运行。请指教。

下面是我的班级的快照（标记为 COM 可见并注册为 COM 互操作）：

```
[Guid("")]
[ClassInterface()]
[ProgID()]
[ComVisible(true)]
public class MyClass {} 
```

当我从 COM 将其设置为空时，是否需要用另一个属性标记它或创建另一个设置以将其处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:30:50.180

这与标记您的类库 STA 无关。.NET 不支持确定性破坏，因此当您将引用设置为 Nothing 时，它无法调用任何内容。

.NET 最接近的结构是`IDisposbale`必须手动调用的接口。如下所示：

```
MyObject.Dispose
Set MyObject= Nothing 
```

注意 C# 对象没有析构函数——它们有终结器。终结器在对象被垃圾回收时运行，这比对象不再被引用时晚了一段时间。

# php - Yii 框架 - 资产管理器

> ID：11065455
> 
> 赞同：1
> 
> 时间：2012-06-16T17:09:14.377
> 
> 标签：php, yii

进入 Yii 资产引擎后，我阅读了官方文档（http://www.yiiframework.com/wiki/148/understanding-assets/）。我理解它背后的原因，但我仍然觉得我的应用程序有一个带有随机生成名称的文件夹有点不雅。因此，我有几个问题希望 SO 人群能给我一些反馈：

1.  我已经有一段时间没有研究新的 Web 框架了（除了我非常喜欢的 ASP.NET MVC）。资产管理器是新 Web 框架的趋势吗？这是肤浅的，但我正在考虑切换到更轻的框架，只是为了避免这个特性。

2.  我想很难让资产经理成为可选的，但我是唯一一个对此有问题的人吗？至少自定义文件夹名称怎么样？

也许我只是对事物有错误的看法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T17:43:24.640

我将从第二个问题开始

> 我想很难让资产经理成为可选的，但我是唯一一个对此有问题的人吗？

使资产（或至少您自己定义的资产）成为可选资产非常容易。只需将它们作为和标签包含在您的布局中（带有完整的非生成 URL），您就可以开始了。

在许多用例中，资产管理器对您非常有用：

1.  解决脚本文件之间的依赖关系
2.  （带有一些插件）压缩和最小化 CSS 和 JS 文件
3.  缓存资产，更重要的是，使缓存失效（比如你想更新产品并希望 CSS/JS 文件中的更改直接反映到用户的浏览器.. 你怎么办？只需删除 assets 文件夹的内容并且资产将自动重新生成......这通常在其他平台上通过附加一个参数来完成（http://example.com/js/very_dynamic_js_file.js?v=32432）

个人意见，保留它们，你不会注意到它们的存在，它们可能有一天对你很有帮助。

一些改善资产当前行为的插件：[eClientScript](http://www.yiiframework.com/extension/eclientscript/)和[MinScript](http://www.yiiframework.com/extension/minscript)

# jquery - Jquery循环 - 每个列表中嵌套ul li ul li多个图像（不同数量）

> ID：11065457
> 
> 赞同：1
> 
> 时间：2012-06-16T17:09:28.727
> 
> 标签：jquery

有问题，无法理解这个 jquery，希望您的帮助/指导。

我需要的功能：

每个菜单列表都包含单击时应滚动的图像，而当鼠标悬停时应滚动。如果鼠标悬停，它将在设置的间隔时间限制内滚动图像。

一旦我让它滚动，我就会寻求更多的功能，但如果它至少现在可以工作，我会很感激

终极功能：当鼠标悬停时也停止动画可能包括使用 .wrap 进行更有效的编码，并可能在鼠标悬停图像 div 时暂停图像。

这是我写的Jquery，顺便说一句不起作用。

```
 $(function() {
    $('.main-img ul').cycle({
        fx: 'fadeout',
        height:      458,
        speed:       300,
        timeout:     0,
        pager:'.menu ul li',
        pagerEvent: 'click',
        pagerAnchorBuilder: function(idx, slide) { 
            return '.menu ul li:eq(' + idx + ') a'; 
        },
        after: function(){
            // start new sub animaion
        },
        before: function(){
            // stop the current animation
        }

    });
});/* 
```

这是html

```
 <div class="main-cont">
        <div class="menu">
            <div class="portfolio"><span>Portfolio</span></div>
            <ul>
                <li><a href="#" class="camp-txt"><span>One</span></a></li>
                <li><a href="#" class="edit-txt"><span>Two</span></a></li>
                <li><a href="#" class="ad-txt"><span>Three</span></a></li>
                <li><a href="#" class="bio-txt"><span>Four</span></a></li>
                <li><a href="#" class="vid-txt"><span>Five</span></a></li>
            </ul>
            <div class="footer"><span>Footer</span></div>
        </div>
        <div class="main-img">
            <ul>
                <li><ul>
                    <li><img src="images/port/1.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/2.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/3.jpg" width="597" height="453" alt="img"  /></li>
                </ul></li>
                <li><ul>
                    <li><img src="images/port/4.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/5.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/6.jpg" width="597" height="453" alt="img"  /></li>
                </ul></li>
                <li><ul>
                    <li><img src="images/port/7.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/8.jpg" width="597" height="453" alt="img"  /></li>
                </ul></li>
                <li><ul>
                    <li><img src="images/port/9.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/10.jpg" width="597" height="453" alt="img"  /></li>
                </ul></li>
               <li><ul>
                    <li><img src="images/port/11.jpg" width="597" height="453" alt="img"  /></li>
                    <li><img src="images/port/12.jpg" width="597" height="453" alt="img"  /></li>
                </ul></li>
            </ul>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:15:12.817

如果您希望显示所有子 UL，并且菜单悬停以触发适用幻灯片的暂停/恢复，请尝试以下操作：

演示：http: [//jsfiddle.net/Gq8uu/2/](http://jsfiddle.net/Gq8uu/2/)

```
/* set options for all slideshows */
var cycleOpts={
   timeout: 2000,
    manualTrump:true    
}

$(function() {
    var $menu_items = $('.menu li');
    var $shows = $('.main-img li ul')

    $shows.each(function(idx) {
        var $sho = $(this);
        /* create slidshow and set to pause*/
        $sho.cycle(cycleOpts).cycle('pause');
        /* menu hover pause/resume show*/
        $menu_items.eq(idx).on('mouseenter mouseleave', function(evt) {
            var action = evt.type == 'mouseenter' ? 'resume' : 'pause';
            $sho.toggleClass('active').cycle(action);
        /* menu click for next slide*/  
        }).click(function(){
            $sho.cycle('next');
            return false;
        });
    });
}); 
```

# javascript - JavaScript - 互相替换两个字符？

> ID：11065461
> 
> 赞同：3
> 
> 时间：2012-06-16T17:09:59.077
> 
> 标签：javascript

我有一个字符串，我想用小“i”替换每个大写“I”，用大写“I”替换每个小“i”。如您所见，如果我分两个阶段执行此操作，它只是将其转换，然后将其转换回以前的状态。那么我将如何一次完成这一切呢？

```
<html>
<head>
<script type="text/javascript">
function init() {
    text = document.getElementById('test');
    newtext = text.innerHTML.replace(/I/g, "i");
    newtext = newtext.replace(/i/g, "I");
    text.innerHTML = newtext;
}
</script>   
</head>

<body onload="init()">
<div id="test">
THIS IS SOME TEST 
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T17:13:12.203

```
newtext = text.innerHTML.replace(/[iI]/g, function(l) {
  return l.toUpperCase() === l ?
    l.toLowerCase() : l.toUpperCase();
}); 
```

# image-processing - 图像处理 Matlab

> ID：11065466
> 
> 赞同：1
> 
> 时间：2012-06-16T17:10:21.863
> 
> 标签：image-processing, matlab

为了去除大部分不需要的边缘，我需要连接图像中的组件，并根据欧拉数过滤掉没有恰好一个孔的组件。

我知道我必须使用图像处理功能`bwconncomp`，`regionprops`但我没有使用它们的经验。

这是我的代码：

```
rgb=imread('2whgyzr.jpg');
gray_scale = rgb2gray(rgb);
BW3 = edge(gray_scale,'canny',[],1); 
```

这是图像：

![http://tinypic.com/r/2whgyzr/6](../Images/3cc9abd539b02149e92636397ef576cc.png)

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T19:58:34.527

如果我正确理解您的问题，这应该可以完成工作：

```
filtered = false(size(BW3));
CC = bwconncomp(BW3);
CC_props = regionprops(CC,'EulerNumber');

for cc_idx = 1:length(CC.PixelIdxList)
   if(CC_props(cc_idx).EulerNumber == 0)
       pixels = CC.PixelIdxList{cc_idx};
       filtered(pixels) = true;
   end
end

imshow(filtered) 
```

![在此处输入图像描述](../Images/c362fc2aa732c46d2bd015743254c980.png)

# javascript - chrome 扩展：从弹出窗口发送数据以取消链接 js 文件

> ID：11065467
> 
> 赞同：0
> 
> 时间：2012-06-16T17:10:38.240
> 
> 标签：javascript, google-chrome, google-chrome-extension

我在搞乱 chrome 扩展。我得到了我在 中做的一个小表格`popup html`，我试图用用户输入做一些事情。我有一个链接在 中的文件，该文件包含`popup.html`此功能：

```
function click(e) {
chrome.tabs.executeScript(null, {
    file: "theJs.js"
}); 
```

}

现在在文件`theJs.js`中，我编写了要在正在运行的当前选项卡上执行的代码（可以在当前选项卡上获取和设置信息）。

所以我的问题是：

如何从 中获取信息`popup.html`并将其发送到`theJs.js`文件，以便我可以使用当前选项卡上的用户输入？

可能吗？

（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T00:14:43.313

使用[消息传递](http://code.google.com/chrome/extensions/messaging.html "Chrome 扩展消息传递")

内容.js

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
    if (request.type == 'apply') {
        applySettings(request.settings);
        sendResponse();
    }
}); 
```

popup.js

```
chrome.tabs.getSelected(function(tab) {
    chrome.tabs.sendRequest(tab.id, { type: "apply", name: name, settings: settings },
        function(response) {
            showMessage('success', '<strong>' + name + '</strong> applied.');
        }
    );
}); 
```

*   [我的扩展：user-bootstrap#popup.html](https://github.com/greatghoul/user-bootstrap/blob/master/popup.html#L86)
*   [我的扩展：user-bootstrap#content.js](https://github.com/greatghoul/user-bootstrap/blob/master/content.js#L1)

# netbeans - 如何在一组选定组件上右键单击 Netbeans 的“自定义布局”（在 Mac 上）

> ID：11065470
> 
> 赞同：1
> 
> 时间：2012-06-16T17:10:45.717
> 
> 标签：netbeans, netbeans-7, netbeans-platform

我使用来自 stackoverflow 用户的提示（ctrl + alt + 单击）在“自定义布局”屏幕中选择了两个组件，但是当您选择多个组件时，似乎无法右键单击。有什么组合键可以解决这个问题吗？先感谢您。

PS：我使用的是 Netbeans 7.1.2

PS2：我的操作系统是 MAC OS Lion (10.7.4)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:23:28.433

对我来说，以下适用于 NB + Mac：

1.  选择第一个组件
2.  按住 ctrl + alt + cmd 并单击另一个组件（ctrl + alt 导致选择第二个而不取消选择第一个并且 cmd 导致出现弹出菜单 - 即右键单击）

# windows-phone-7 - 视窗手机。隔离存储。一个文件或多个小文件

> ID：11065472
> 
> 赞同：1
> 
> 时间：2012-06-16T17:10:57.913
> 
> 标签：windows-phone-7, isolatedstorage

我正在 Windows 手机上编写一个小应用程序。用户在独立存储中保存一些信息（具有 10-15 个属性的抽象类结果 + 具有新属性的派生类）。他还可以查看以前结果的历史记录+他可以删除一些不需要的结果。（可以是 100 多个以前的结果）

我应该使用一个文件（在启动事件中读取并在停用事件中写入）还是应该将每个新结果存储在单独的文件中？我应该使用 XmlSerialization 还是 DataContractJsonSerializer？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:17:56.417

如果保存的数据不是太大，我认为一个文件就足够了。否则，多文件方法是可行的方法，但可能应该使用某种摘要文件进行备份，该文件将包含单个结果的预览，以便在显示某种列表时不必全部读取它们。最好的解决方案是使用本地 SQL Compact 数据库，因为这样可以在处理数据时为您提供最佳性能，但也需要一些额外的编码。

# c# - 错误无法从 'System.Collections.Generic.List 转换 ' 到 'GameLibrary.Cards.Card'

> ID：11065481
> 
> 赞同：-3
> 
> 时间：2012-06-16T17:12:25.310
> 
> 标签：c#

```
 private List<List<Card>> GetCardMatchesInHand()
    {
        List<Card> list4;
        List<List<Card>> list = new List<List<Card>>();
        List<GameLibrary.Cards.Card> list2 = new List<GameLibrary.Cards.Card>()
        List<Card> list3 = new List<Card>();
        list4 = new List<Card> {
            list2,
            list3,
            list4
        };
        List<Card> list5 = this.Cards.ToList<Card>();
        using (List<Card>.Enumerator enumerator = this.Cards.GetEnumerator())
        {
            Predicate<Card> match = null;
            Predicate<Card> predicate2 = null;
            Predicate<Card> predicate3 = null;
            Predicate<Card> predicate4 = null;
            Predicate<Card> predicate5 = null;
            Card c;
            while (enumerator.MoveNext())
            {
                c = enumerator.Current;
                list5.Remove(c);
                if (match == null)
                {
                    match = element => element.CardValue == c.CardValue;
                }
                Card item = list5.Find(match);
                if (item != null)
                {
                    if (predicate2 == null)
                    {
                        predicate2 = element => element.CardValue == c.CardValue;
                    }
                    if (list2.Exists(predicate2))
                    {
                        if (predicate3 == null)
                        {
                            predicate3 = element => element.CardValue == c.CardValue;
                        }
                        item = list2.Find(predicate3);
                        list2.Remove(item);
                        list3.Add(c);
                    }
                    else
                    {
                        if (predicate4 == null)
                        {
                            predicate4 = element => element.CardValue == c.CardValue;
                        }
                        if (list3.Exists(predicate4))
                        {
                            if (predicate5 == null)
                            {
                                predicate5 = element => element.CardValue == c.CardValue;
                            }
                            item = list3.Find(predicate5);
                            list3.Remove(item);
                            list4.Add(c);
                        }
                        else
                        {
                            list2.Add(c);
                        }
                    }
                }
            }
        }
        return list;
    } 
```

我在“list2，list3，list4”这一行收到错误消息。现在为什么我会收到这个错误？这是现在发布的整个代码。也许现在你可以看到我想要做什么。还使用它来检查列表中的匹配项。

```
 List<List<Card>> cardMatches = this.GetCardMatchesInHand(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:15:04.343

它试图做相当于：

```
List<Card> tmp = new List<Card>();
tmp.Add(list2);
tmp.Add(list3);
tmp.Add(list4);
List<Card> list4 = tmp; 
```

现在您无法`Add`使用元素类型*列表*进行调用 - 这就是您收到该错误的原因。您*还*尝试在第一次`list4`分配值时使用。`list4`

目前还不清楚您要实现什么，但如果您想成为and`list4`的所有元素，您可以使用：`list2``list3`

```
List<Card> list4 = list2.Concat(list3).ToList(); 
```

或者，如果您真的想`list4`成为列表列表，则需要以这种方式声明它并调用适当的构造函数：

```
// Note not using list4 within the initializer...
List<List<Card>> list4 = new List<List<Card>> { list2, list3 }; 
```

目前，您的整个方法看起来有些混乱-您根本没有使用该`list`变量，而且您声明`list4`的时间比使用它的时间早得多。这些都不是错误，但都有点奇怪。

# css - HTML5 页脚标签

> ID：11065484
> 
> 赞同：2
> 
> 时间：2012-06-16T17:13:24.150
> 
> 标签：css, html

我正在建立这个网站，但我的页脚有问题。我希望页脚中的深绿色覆盖整个页脚。但要知道它只覆盖 10px 或类似的高度，而不是 +- 200px。我究竟做错了什么？

链接到我的网站：[http](http://bit.ly/LSVux5) ://bit.ly/LSVux5但我希望它看起来像这样[http://bit.ly/LSW3Hn](http://bit.ly/LSW3Hn)

颜色无关紧要，只有覆盖它的区域

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T17:15:51.203

添加`overflow:hidden;`到`#footer-container`规则中。浮动元素会导致页脚看起来没有内容，溢出属性会解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:16:37.303

**[工作版本](http://jsfiddle.net/loktar/Fu2Ax/)**

您只需要清除浮动，您可以通过将页脚更改为以下内容来做到这一点。

```
 <footer class="wrapper clearfix"> 
```

只需将`clearfix`类（已在样式表中声明）添加到页脚。

# java - java中的JS风格的警告框

> ID：11065485
> 
> 赞同：2
> 
> 时间：2012-06-16T17:13:28.600
> 
> 标签：java, swing, popup, alert

JavaScript 弹出窗口的 Java Swing 对应项是什么`alert()`（如果有的话）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-16T17:18:20.157

完成此类弹出窗口的基本方法是使用`JOptionPane.showMessageDialog`，[请参见此处](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)。

```
JOptionPane.showMessageDialog(frame, "here comes the text.");   
// assumes frame to be a reference to the desired parent frame 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:17:28.680

认为您正在寻找 JOptionPanes 但这里是不同对话框的一个很好的描述：http: [//docs.oracle.com/javase/tutorial/uiswing/components/dialog.html](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-16T17:19:50.090

如何在 Java 中创建对话框：

*   [如何制作对话框](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)（Java 教程）
*   [Java - 如何创建自定义对话框？](https://stackoverflow.com/questions/789517/java-how-to-create-a-custom-dialog-box)（堆栈溢出答案）

# rest - Play 2.0 RESTful 请求后处理

> ID：11065487
> 
> 赞同：4
> 
> 时间：2012-06-16T17:13:37.810
> 
> 标签：rest, request, playframework-2.0, post-processing

关于[这个问题](https://stackoverflow.com/questions/11060761/how-can-my-play-2-app-respond-to-different-accept-headers-from-the-client)，我很好奇如何进行请求后 REST 处理（粗略）：

```
def postProcessor[T](content: T) = {
  request match {
    case Accepts.Json() => asJson(content)
    case Accepts.Xml()  => asXml(content)
    case _ => content
  }
} 
```

[在全局配置中覆盖 onRouteRequest](https://github.com/playframework/Play20/wiki/ScalaInterceptors)似乎无法提供对响应正文的访问，因此看起来[Action 组合](https://github.com/playframework/Play20/wiki/ScalaActionsComposition)是拦截响应并执行后处理任务的方法。

问题：这是一个好主意，还是直接在已知类型转换的控制器（或其他类）方法中进行内容类型转换更好？

目前我到处都在做这种事情：

```
toJson( i18n("account not found") )
toJson( Map('orderNum-> orderNum) ) 
```

虽然我希望根据接受标头后请求进行 toJson/toXml 转换。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-17T21:28:15.187

您希望能够根据请求的标头值计算`Result`包含类型对象的表示的 a 。您可以使用以下*类型 trait*对该功能进行编码：`A``Accept`

 *```
trait Repr[-A] {
  def render(a: A, request: RequestHeader): Result
} 
```

然后，您可以使用以下辅助特征从您的控制器渲染任何资源：

```
trait ReprSupport {
  def repr[A](a: A)(implicit request: RequestHeader, repr: Repr[A]) =
    repr.render(a, request)
}

object MyApp extends Controller with ReprSupport {
  def index = Action { implicit request =>
    repr(Foo("bar"))
  }
} 
```

where`Foo`是一个简单的case类定义如下：

```
case class Foo(bar: String) 
```

为了能够编译上面的代码，你需要`Repr[Foo]`在你的隐式作用域中有一个类型的值。第一个实现可以写成如下：

```
object Foo extends AcceptExtractors {
  implicit val fooRepr = new Repr[Foo] {
    def render(foo: Foo, request: RequestHeader): Result = request match {
      case Accepts.Html() => Ok(views.html.foo(foo)) // Assumes there is a foo.scala.html template taking just one parameter of type Foo
      case Accepts.Json() => Ok(Json.obj("bar" -> foo.bar))
      case _ => NotAcceptable
    }
  }
} 
```

但是对于您要为其编写`Repr`实例的每种数据类型，该`render`方法将遵循相同的模式：

```
implicit val somethingRepr = new Repr[Something] {
  def render(value: Something, request: RequestHeader): Result = request match {
    // <Some interesting code> (e.g. case Accepts.Html() => Ok(views.html.something(value)))
    case _ => NotAcceptable
  }
} 
```

您可能希望通过抽象此模式来减少样板文件并避免用户忘记最后一个“case”语句。例如，您可以编写以下辅助方法来构建`Repr[Something]`：

```
object Repr {
  def apply[A](f: PartialFunction[RequestHeader, A => Result]): Repr[A] = new Repr[A] {
    def render(a: A, request: RequestHeader): Result =
      if (f.isDefinedAt(request)) f(request)(a)
      else NotAcceptable
  }
} 
```

因此，您只需要编写以下内容即可获得`Repr[Foo]`：

```
implicit val fooRepr = Repr[Foo] {
  case Accepts.Html() => foo => Ok(views.html.foo(foo))
  case Accepts.Json() => foo => Ok(Json.obj("bar" -> foo.bar))
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T21:11:21.103

一种选择可能是为此创建一种包装器。

它应该类似于以下内容：

```
 //THE WRAPPER that takes the action computation and the formatter
  def acceptEnabledAction[A]: (RequestHeader => A, (RequestHeader, A) => Result) => Action[AnyContent] =
     (a, f) => 
        Action { request => 
            f(request, a(request))
        }

  //a sample formatter
  val encoder = (r, r) => r.accept /*or smthg*/ match {
        case x if x == "text/json" || x == "application/json" => Ok(toJson(r)) /*dummy to json*/
        case x if x == "text/xml" || x == "application/xml"   => Ok(toXml(r)) /*dummy to xml*/
        case _ => BadRequest("not accepted")
      }

  //an action using it    
  def index = acceptEnabledAction[Map[String, Boolean]](
      rh => /*the real action content is here*/Map("a" -> true), 
      encoder
    ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T22:20:01.110

另一种选择是使用[mimerender](http://github.com/martinblech/play-mimerender)模块（披露：我写的）。您定义一次映射：

```
val m = mapping(
  "text/html" -> { s: String => views.html.index(s) },
  "application/xml" -> { s: String => <message>{s}</message> },
  "application/json" -> { s: String => toJson(Map("message" -> toJson(s))) },
  "text/plain" -> identity[String]_
) 
```

并在所有控制器中重用它：

```
object Application extends Controller {
  def index = Action { implicit request =>
    m.status(200)("Hello, world!")
  }
} 
```

注意：这是一个非常早的版本，仅在 Play 2.0.4 上进行了测试*

# android - 查询日历 ICS

> ID：11065492
> 
> 赞同：2
> 
> 时间：2012-06-16T17:13:58.830
> 
> 标签：android, calendar

我尝试读出所有现有的日历。我从这里尝试了这个例子：

[http://developer.android.com/guide/topics/providers/calendar-provider.html](http://developer.android.com/guide/topics/providers/calendar-provider.html)

但我收到以下编译错误：方法 getContentResolver() 未定义类型 xxx 有人可以帮帮我吗？

```
public HashMap<String, String> readCalendar() {     
String[] EVENT_PROJECTION = new String[] {
        Calendars._ID,   
        Calendars.OWNER_ACCOUNT,                    
        Calendars.ACCOUNT_NAME,                  
        Calendars.CALENDAR_DISPLAY_NAME                                   
    };
    String selectionICS = "((" + Calendars.ACCOUNT_NAME + " = ?) AND (" 
            + Calendars.ACCOUNT_TYPE + " = ?) AND ("
            + Calendars.OWNER_ACCOUNT + " = ?))";
    String[] selectionArgs = new String[] {"VISIBLE=1"}; // or "selected=1" ??

    Cursor managedCursor = null;
        ContentResolver cr = getContentResolver();
        managedCursor = cr.query(calendarUri, EVENT_PROJECTION, selectionICS, selectionArgs, null);selectionICS, selectionArgs, null);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:39:32.423

`getContentResolver()`是 的一种方法`Context`，所以我的猜测是您的类不是派生自`Activity`（派生自`Context`）。

如果要在活动类 ( `context.getContentResolver()`) 之外调用它，则必须使用上下文变量。如果您的类是 BroadcastReceiver，则上下文变量作为参数给出`onReceive()`。如果没有，您必须在调用时将其发送到您的方法。

# vb.net - 整数的 vb.net char 文字

> ID：11065495
> 
> 赞同：0
> 
> 时间：2012-06-16T17:14:20.503
> 
> 标签：vb.net, char, literals, chr

使用带有选项 VBruntime- 的命令行 Visual Basic 编译器 (vbc.exe) 不允许使用 chr() 或 chrw() 来指定文字字符。MSDN 提供 "x"c 作为指定文字字符的解决方案。这很好用，但是我如何为整数值指定文字字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:24:18.307

您应该能够使用[System.Convert.ToChar()](http://msdn.microsoft.com/en-us/library/3hkfdkcx.aspx#Y0)将整数转换为字符值。这是在 mscorlib 中定义的，因此无论您的命令行选项如何，它都可用。

# php - 获取 PHP ssl 会话 ID

> ID：11065502
> 
> 赞同：1
> 
> 时间：2012-06-16T17:15:32.890
> 
> 标签：php, session, ssl

我想获取 ssl 会话 ID，所以我知道它是同一个用户。当我尝试`$_SERVER['ssl_session_id']`时，它什么也没有返回，`print_r($_SERVER)` `$_SERVER['ssl_session_id']`并且没有出现。

我需要 ssl 会话 ID 的原因是我正在创建一个登录系统，并希望确保无法通过固定攻击使用该会话。我将把它添加到身份验证会话 cookie 中，然后可以稍后检查它。

编辑：根据我得到的答案和评论：它会更改每个请求，而不是存储在 $_SERVER 或 $_SESSION 超级全局数组中的东西；因此在网络上使用是无用的，不应该使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:27:14.413

我从评论和研究中了解到的是，您无法通过 PHP 获取 ssl_session_id，即使您可以更改它也没有用。感谢那些回答和评论的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:26:40.600

你有没有

```
session_start(); 
```

在尝试访问会话之前？如果是，那么您的会话以某种方式被破坏（cookie 设置不正确，因此不断启动新会话），或者您没有将该值保存到会话中开始。

$_SERVER 与会话无关。它是一个超全局变量，包含有关服务器和 PHP 配置的信息。$_SERVER 是它自己专用的超全局变量，纯粹用于服务器数据。

# c# - 带有数据模型的列表不会绑定到 json 对象

> ID：11065504
> 
> 赞同：0
> 
> 时间：2012-06-16T17:15:42.360
> 
> 标签：c#, jquery, json, asp.net-mvc-3, post

我以前遇到过这个问题，但我从来没有很好地解决它。

这是我的 JSON 对象：

```
{ Targets: [{ Target: { Id: -1, EditUrl: editUrl}}] } 
```

这些是我使用的模型：

```
public class TargetList
{
    public List<Target> Targets { get; set; }
}

public class Target
{
    public int Id { get; set; }
    public string EditUrl { get; set; }
} 
```

这是动作：

```
 [HttpPost]
    public PartialViewResult GetSpecifics(TargetList targetList)
    {
        //Code and stuff
    } 
```

TargetList 总是结果为空。我从来没有使用过这样的列表，即使它应该可以工作 OOTB（对吗？）。只有属性而没有列表的“普通”数据模型可以完美运行。

我在这里看到了一些相关的问题，其中一些建议`traditional: true`在`$.post`. 不工作。我已经对数据进行了字符串化并且没有对数据进行字符串化，但无济于事。如果在传统设置为 true 时未进行字符串化，那么 json 对象就会变成`Targets: [Object object]`所以我猜它与帖子有关。

我可以以某种方式手动绑定我的对象吗？在某些情况下覆盖工厂？我觉得我需要更多地控制这个功能。

我正在使用 MVC3、.NET4 和 jQuery-1.7.2。

我真的非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:30:54.783

`Target:`是多余的。代表您的模型的 Json 字符串应该是

```
{"Targets":[{"Id":1,"EditUrl":"aaa"},{"Id":2,"EditUrl":"bbb"}]} 
```

如果可以，请将其从您的 Json 字符串中删除。否则将您的类声明为：

```
public class TargetList
{
    public List<Target1> Targets { get; set; }
}

public class Target1
{
    public Target2 Target;
}

public class Target2
{
    public int Id { get; set; }
    public string EditUrl { get; set; }
} 
```

我用

```
string json = "{ Targets: [{ Target: { Id: -1, EditUrl: \"aaaa\"}}] }";
var validObj = new JavaScriptSerializer().Deserialize<TargetList>(json); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T21:05:32.683

不确定为什么您的 TargetList 没有正确反序列化。您可以尝试创建自定义 ModelBinder，然后在活页夹中手动反序列化您的 JSON。这将使您的控制器保持清洁。我在我的项目中使用[Json.NET](http://json.codeplex.com/)作为序列化程序。只需创建您自己的 ModelBinder：

```
public class CustomModelBinder : IModelBinder
{
  public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
  {
    string inputContent;
    using (var sr = new StreamReader(controllerContext.HttpContext.Request.InputStream))
    {
      inputContent = sr.ReadToEnd();
    }
    //JsonConvert is part of Json.NET
    var result = JsonConvert.DeserializeObject(inputContent, bindingContext.ModelType);
    return result;
  }
} 
```

然后在 Global.asax.cs 中为 TargetList 设置你的 ModelBinder：

```
protected void Application_Start()
{
  ModelBinders.Binders[typeof(TargetList)] = new CustomModelBinder();
} 
```

您还可以将 ModelBinder 用于需要反序列化的任何其他模型。

# android - 是什么导致了 IOException 和 Broken pipe

> ID：11065509
> 
> 赞同：47
> 
> 时间：2012-06-16T17:16:11.580
> 
> 标签：android, avd

我的 AVD 是 API 15，我不知道为什么，但是每当我在模拟器上运行应用程序时，都会出现以下消息。除了控制台中的错误消息外，它似乎没有造成任何麻烦。

```
[2012-06-17 00:03:26 - ddmlib] Broken pipe
java.io.IOException: Broken pipe
    at sun.nio.ch.FileDispatcher.write0(Native Method)
    at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
    at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:122)
    at sun.nio.ch.IOUtil.write(IOUtil.java:93)
    at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:352)
    at com.android.ddmlib.JdwpPacket.writeAndConsume(JdwpPacket.java:213)
    at com.android.ddmlib.Client.sendAndConsume(Client.java:575)
    at com.android.ddmlib.HandleHeap.sendREAQ(HandleHeap.java:348)
    at com.android.ddmlib.Client.requestAllocationStatus(Client.java:421)
    at com.android.ddmlib.DeviceMonitor.createClient(DeviceMonitor.java:837)
    at com.android.ddmlib.DeviceMonitor.openClient(DeviceMonitor.java:805)
    at com.android.ddmlib.DeviceMonitor.processIncomingJdwpData(DeviceMonitor.java:765)
    at com.android.ddmlib.DeviceMonitor.deviceClientMonitorLoop(DeviceMonitor.java:652)
    at com.android.ddmlib.DeviceMonitor.access$100(DeviceMonitor.java:44)
    at com.android.ddmlib.DeviceMonitor$3.run(DeviceMonitor.java:580) 
```

可能是什么原因？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-03-31T14:21:18.053

如果有人同时使用eclipse和android studio，那么eclipse会抛出这个错误。所以即使你通过 DDMS 选择设备，它也会抛出这个错误。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-09-30T09:49:02.380

老问题，但仍然相关，我没有看到有关此信息的任何其他答案：

对我来说，它发生在另一个 Eclipse 同时运行时，DDMS 与试图连接到 Android 设备的 Eclipse 在同一个套接字上竞争。

解决方案是关闭另一个 Eclipse。希望它可以帮助某人。

**更新**：可能更好的解决方案是将另一个 Eclipse 的 DDMS 端口编辑为您不使用的东西。所以它退出了比赛。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-22T12:11:43.390

当我同时`monitor`打开 Eclipse ADT 时，这发生在我身上。尝试关闭所有与 Android 相关的东西，然后`adb kill-server && sleep 5 && adb devices`重新启动您的工具（Eclipse/Ant/AS）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-06-22T12:44:46.330

“Broken pipe”表示您已将数据写入已被对等方关闭的连接。解决方案：不要。它本质上是一个应用程序协议错误。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-16T22:17:57.533

我猜客户端（Eclipse）通过管道协议与服务器（你的模拟器）通信（这个协议众所周知，可以在同一台机器上通信 2 个进程）。

沟通渠道有时会中断。（可能有 100 多个原因）

要解决此问题：重新启动模拟器 (AVD)。也许您将不得不等待片刻（约 1 分钟？？），以便 Eclipse 可以恢复管道通道并且您的 Log Cat 将返回。否则，重新启动 Eclipse 和模拟器以消除此错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-13T10:58:08.767

我注意到最近经常发生这种情况（每 5 分钟左右）。如果我同时运行物理设备和模拟器，频率似乎会增加。

停止模拟器并仅使用物理设备进行调试阻止了它经常发生 - 现在我每天只看到一两次。

要在它发生时解决它，您无需关闭模拟器或重新启动设备 - 关闭并重新打开 USB 调试模式应该使其再次显示在 adb 下。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-20T01:45:38.413

我对“管道损坏”的最常见原因是一台机器（通过套接字通信的一对机器）在通信完成之前关闭了它的套接字端。其中大约一半是因为在该套接字上通信的程序已终止。

如果发送字节的程序将它们发送出去并立即关闭套接字或自行终止，则套接字可能会在字节传输和读取之前停止运行。

尝试在关闭套接字的任何地方以及在允许程序终止之前暂停以查看是否有帮助。

仅供参考：“管道”和“套接字”是有时可以互换使用的术语。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-12-04T09:05:44.170

我已经为这个问题苦苦挣扎了很长时间。每当我想使用 Chrome 的调试工具调试 android 移动应用程序时，我每 5 分钟就会断开连接。

我发现造成这种情况的原因确实是其他使用手机连接的进程在操作系统中运行，它破坏了手机和操作系统之间的通信。

我使用 Macbook Pro，我正在运行 IntelliJ IDEA 调试器 + Android 文件传输（不知道这是在后面运行）和 Chrome 的调试器工具。当我使用“活动监视器”工具关闭 Android 文件传输过程时，一切正常，手机和操作系统之间不再断开连接。我的建议是始终检查您是否正在运行其他 Android 进程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-17T09:30:34.843

当另一端的客户端关闭套接字连接时，会发生“Broken pipe”异常。大多数时候，这没什么好担心的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-17T14:08:29.370

我同时使用了 Android Studio 和 DDMS。关闭 DDMS 为我解决了这个问题。

重新启动 Android Studio 没有影响。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-05-01T04:37:13.403

重新启动android设备解决了我的问题

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-10T08:44:52.150

万一其他人没有找到任何解决方案。在 Eclipse Neon 中，当我在插件目录中有两个 DDMS jar 时，就会发生这种情况。我有 andmore.ddms.jar 和 com.android_ddms.jar。删除一个解决了错误，我猜他们都竞争连接到同一个端口。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2013-10-24T10:01:21.687

就我而言，我删除了主目录中的 .android 。没关系。

# iphone - 苹果错误 LLVM 3.1

> ID：11065513
> 
> 赞同：0
> 
> 时间：2012-06-16T17:16:28.220
> 
> 标签：iphone, ios, xcode

我真的很害怕，我今天正在编码，我试图在构建设置中更改应用程序的名称..现在我收到这个错误，我不知道该怎么办......更改后出现错误名称，所以我返回了它的样子，但仍然收到错误。

有任何想法吗？

```
ProcessPCH /Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-    dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/PrecompiledHeaders/CogniviaTaxi2012-cnqijsqktrplrbdjpydsurpnfjtl/CogniviaTaxi2012.pth CogniviaTaxi2012 normal i386 objective-c com.apple.compilers.llvm.clang.1_0.compiler
cd /Users/Tidane/Desktop/CogniviaTaxi2012
setenv LANG en_US.US-ASCII
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -x objective-c-header -arch i386 -fmessage-length=0 -std=gnu99 -fobjc-arc -Wno-trigraphs -fpascal-strings -O0 -Wno-missing-field-initializers -Wmissing-prototypes -Wreturn-type -Wno-implicit-atomic-properties -Wformat -Wno-missing-braces -Wparentheses -Wswitch -Wno-unused-function -Wno-unused-label -Wno-unused-parameter -Wunused-variable -Wunused-value -Wno-uninitialized -Wno-unknown-pragmas -Wno-shadow -Wno-four-char-constants -Wno-sign-compare -Wno-shorten-64-to-32 -Wpointer-sign -Wno-newline-eof -Wno-selector -Wno-strict-selector-match -Wno-undeclared-selector -Wno-deprecated-implementations -DDEBUG=1 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -fexceptions -fasm-blocks -Wprotocol -Wdeprecated-declarations -mmacosx-version-min=10.6 -g -Wno-conversion -Wno-sign-conversion -fobjc-abi-version=2 -fobjc-legacy-dispatch "-DIBOutlet=__attribute__((iboutlet))" "-DIBOutletCollection(ClassName)=__attribute__((iboutletcollection(ClassName)))" "-DIBAction=void)__attribute__((ibaction)" -D__IPHONE_OS_VERSION_MIN_REQUIRED=50100 -iquote /Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/CogniviaTaxi2012.build/Debug-iphonesimulator/CogniviaTaxi2012.build/CogniviaTaxi2012-generated-files.hmap -I/Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/CogniviaTaxi2012.build/Debug-iphonesimulator/CogniviaTaxi2012.build/CogniviaTaxi2012-own-target-headers.hmap -I/Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/CogniviaTaxi2012.build/Debug-iphonesimulator/CogniviaTaxi2012.build/CogniviaTaxi2012-all-target-headers.hmap -iquote /Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/CogniviaTaxi2012.build/Debug-iphonesimulator/CogniviaTaxi2012.build/CogniviaTaxi2012-project-headers.hmap -I/Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Products/Debug-iphonesimulator/include -I/Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/CogniviaTaxi2012.build/Debug-iphonesimulator/CogniviaTaxi2012.build/DerivedSources/i386 -I/Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/CogniviaTaxi2012.build/Debug-iphonesimulator/CogniviaTaxi2012.build/DerivedSources -F/Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Products/Debug-iphonesimulator --serialize-diagnostics /Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/PrecompiledHeaders/CogniviaTaxi2012-cnqijsqktrplrbdjpydsurpnfjtl/CogniviaTaxi2012.dia -c 
/Users/Tidane/Desktop/CogniviaTaxi2012/CogniviaTaxi2012 -o /Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/PrecompiledHeaders/CogniviaTaxi2012-cnqijsqktrplrbdjpydsurpnfjtl/CogniviaTaxi2012.pth -MMD -MT dependencies -MF /Users/Tidane/Library/Developer/Xcode/DerivedData/CogniviaTaxi2012-dibsqcvprykadbdonevlhydjtyef/Build/Intermediates/PrecompiledHeaders/CogniviaTaxi2012-cnqijsqktrplrbdjpydsurpnfjtl/CogniviaTaxi2012.d

error: error reading '/Users/Tidane/Desktop/CogniviaTaxi2012/CogniviaTaxi2012'
1 error generated. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:16:16.670

我想我遇到了同样的问题。我更改了我的应用程序名称，突然我无法构建该项目。

就我而言，我发现“Apple LLVM compiler 3.2 - Language”的“Prefix Header”已更改为目录名，而不是文件名。

所以我手动将它修复为 XXXX-Prefix.pch，现在我可以构建项目了。

我不知道我的情况与您的情况相同，但仅供您参考。

# c# - 请求 RSS 提要在浏览器中工作，但不使用 XmlDocument.Load()

> ID：11065514
> 
> 赞同：0
> 
> 时间：2012-06-16T17:16:36.070
> 
> 标签：c#, rss, webbrowser-control

我正在尝试使用简单的 C# WebForms 应用程序以编程方式下载 RSS 提要。

RSS 提要的 URI 包含特定于我的登录详细信息的授权令牌。

如果我使用 WebBrowser 控件请求 RSS 提要，则提要被包装在 HTML 中并且不可解析。

如果我使用请求 RSS 提要

```
var rssXml = new XmlDocument();
rssXml.Load(feedUri); 
```

然后它返回一个*401 - Unauthorized*响应。

但是，我可以打开浏览器，清除主机站点的所有 cookie（事实上，这是一个我从未用于访问主机站点的很少使用的浏览器）并使用相同的 RSS URI 并收到预期的 RSS*提要*。这表明 URI 中的授权令牌被接受。

那么为什么我无法使用此代码成功请求 RSS 提要呢？

```
var rssXml = new XmlDocument();
rssXml.Load(feedUri); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:47:40.767

对于查看此问题以寻求答案的任何人，请参阅上面的@LB 评论。

# java - Eclipse 消息说 List 无法解析为类型

> ID：11065517
> 
> 赞同：28
> 
> 时间：2012-06-16T17:16:42.030
> 
> 标签：java, eclipse

我正在eclipse中尝试以下代码：

```
public class A {    
    List<Integer> intList = new ArrayList<Integer>();
} 
```

但是，它给了我一个错误消息：无法将列表解析为类型，而无法将 ArrayList 解析为类型。

我需要添加一些库吗？我该怎么做？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-16T17:19:55.217

您可以按`Shift`+ `Ctrl`+`O`进行自动导入。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-06-16T17:18:24.990

将以下内容放在源文件的顶部：

```
import java.util.ArrayList;
import java.util.List; 
```

[这](http://docs.oracle.com/javase/tutorial/java/package/usepkgs.html)是对包是什么以及`import`语句如何工作的解释。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-16T17:42:25.560

您将不得不使用`either import`这些类所在的包，`or write the entire path.`

## 1\. 进口：

```
import java.util.ArrayList;
import java.util.List; 
```

## 2.完整路径：

公共类 A {

`java.util.List<Integer>`intList = 新的`java.util.ArrayList<Integer>()`；

}

## 3\. 在 Eclipse IDE 中，

用于`ctrl + shift + O`导入。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-09T08:13:45.647

有时也可能是没有为您的项目正确设置 Java 构建路径。

转到项目属性（右键单击工作区中的项目名称，然后单击属性）并在“Java Build Path”中检查是否`JRE System Library`设置为`unbound`.

如果是这种情况，请将其更改为您机器上可用的 Java SDK 之一。下载地址就是[这个。](http://www.oracle.com/technetwork/java/javase/downloads/index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-16T17:19:31.487

您需要以下 2 个导入

```
import java.util.ArrayList;
import java.util.List; 
```

你使用 IDE 吗？大多数 IDE 都有帮助，可以建议像这些导入这样的修复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-24T11:56:02.450

将光标放在显示错误的位置，然后 Eclipse 将通过对话框建议一些快速修复。在对话框中选择“导入数组列表”选项。然后Eclipse会自动导入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-05T05:36:32.233

即使在导入所需的包之后，如果错误仍然存​​在，只需单击菜单栏中的项目，然后单击清理。然后从项目资源管理器中右键单击您的项目并刷新您的项目。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-01T06:57:21.987

java.util.List intList = new java.util.ArrayList();

这解决了这个问题。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2019-01-19T00:45:16.557

您在任何方法之外声明 List 对象。将其移动到方法中，它将起作用。

# c# - 程序最小化后未从任务栏检索

> ID：11065518
> 
> 赞同：2
> 
> 时间：2012-06-16T17:16:45.747
> 
> 标签：c#, wpf

我将提供一些有关我正在尝试做的事情的背景：

我创建了一个自定义按钮，它应该使用淡出动画最小化我的窗口，所以这里是它的代码：

```
private void minimize_Window(object sender, EventArgs e)
{
    var anim = new DoubleAnimation(0, (Duration)TimeSpan.FromSeconds(1));
    anim.Completed += (s, _) => this.Minimize();
    this.BeginAnimation(UIElement.OpacityProperty, anim);
}

private void Minimize()
{
    WindowState = WindowState.Minimized;
} 
```

它工作得很好，虽然问题是当我尝试从任务栏中检索我的程序时它不会做任何事情（当我在最小化后从任务栏单击它时我无法看到该程序）。我从中了解到的是，我的程序的不透明度被设置为 0，而它被最小化（因为动画）。所以我使用了调用该方法的激活事件：

```
private void set_Opacity(object sender, EventArgs e)
{
    rectangle2.Opacity = 1;
    WindowState = WindowState.Normal;
} 
```

而且，同样的问题。希望你能帮忙。

非常感谢你。 **如果需要任何其他解释，请告诉我。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T20:58:32.633

尝试使用另一个动画将不透明度设置回 1：

```
 private void set_Opacity(object sender, EventArgs e)
    {
        var anim = new DoubleAnimation(1, (Duration)TimeSpan.FromSeconds(0));
        this.BeginAnimation(UIElement.OpacityProperty, anim);
    } 
```

**编辑**：这种方法有效并且简单地将不透明度设置为 1 的原因不是[依赖属性值设置优先级](http://msdn.microsoft.com/en-us/library/ms743230.aspx#listing)。简而言之，动画设置的值优先于“本地”值设置，即那些通过分配给属性设置的值。

在您的情况下，动画已经完成，但它仍然“保留”`Opacity`依赖属性。但是，如果您使用

```
 anim.FillBehavior = FillBehavior.Stop; 
```

然后动画将在完成后“释放”该`Opacity`属性，然后您不需要另一个动画将其设置回 1。然后您的原始`set_Opacity`方法应该可以工作。

另请注意，您不应`WindowState = WindowState.Normal`在`set_Opacity`方法中分配。如果您最大化窗口，单击您的按钮将其最小化，然后单击任务栏按钮，该窗口不会重新显示为最大化。

# ruby-on-rails - 使用 RSpec 和 FactoryGirl 在模型中测试 rails 类方法的正确方法是什么？

> ID：11065519
> 
> 赞同：2
> 
> 时间：2012-06-16T17:16:49.630
> 
> 标签：ruby-on-rails, ruby, unit-testing, rspec, tdd

我必须与 rspec 和 factory girl 隔离测试 Category rails 模型。我开始使用 FactoryGirl 定义一个类别（记录），如下所示：

```
#spec/factories/category.rb
FactoryGirl.define do
  factory :category do |f|
    f.name "A/B Testing"
    f.tags_array %w(test a/b)
  end
end 
```

和类别模型规范，如：

```
# spec/models/category_spec.rb
require 'spec_helper'

  describe "Category" do
    before(:each) do
      @category = FactoryGirl.create(:category)
    end
    it "has a valid factory" do
      @category.should be_valid
    end
    it "is invalid without a name" do
      @category.name = nil
      @category.should_not be_valid
    end
    it "is invalid without at last one tag" do
      @category.tags_array = nil
      @category.should_not be_valid
    end
  end 
```

现在我应该定义 & 测试，一个**Category 类方法**，它返回一个**竞争者**数组，它是一个**Struct**对象，如下所示：

```
 Object.const_set :Competitor, Struct.new(:html_url, :description, :watchers, :forks) 
```

那么这个类方法**seff.find_competitors_by_tags**应该返回一个结构数组（：竞争对手结构对象数组）：

```
 def self.find_competitors_by_tags(tags_array)
    competitors = []
    Extractor.each do |wl|
      competitors << Competitor.new(wl.html_url, wl.description, wl.watchers, wl.forks)
    end
    return competitors
  end 
```

使用 RSpec 和 FactoryGirl 单独测试的最佳方法是什么？我想到了以下内容，但我不能说清楚：

```
spec/factories/competitor.rb
FactoryGirl.define do
  factory :competitor do |f|
    f.html_url "https://github.com/assaf/vanity"
    f.description "Experiment Driven Development for Ruby"
    f.watchers "844"
    f.forks "146"
  end
end

# spec/models/category_spec.rb
require 'spec_helper'

  describe "Category" do
    ...
    ...

    it "returns a list of all competitors for each category" do
      competitors << FactoryGirl.create(:competitor) 
      competitors << Factory.build(:competitor, html_url: "https://github.com/andrew/split",
                                   description: "Rack Based AB testing framework",
                                   watchers: "357",
                                   forks: "42")
      @category.find_competitors_by_tags("A/B Testing").should == competitors
    end
  end 
```

无论如何它都不起作用，我也不确定它是否有意义：

```
Failures:

      1) Category returns a list of all competitors for each category
         Failure/Error: @competitors << FactoryGirl.create(:competitor)
         NameError:
           uninitialized constant Competitor
         # ./spec/models/category_spec.rb:22:in `block (2 levels) in <top (required)>' 
```

测试这种方法的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T21:09:28.547

您问如何单独测试：

```
 def self.find_competitors_by_tags(tags_array)
    competitors = []
    Extractor.each do |wl|
      competitors << Competitor.new(wl.html_url, wl.description, wl.watchers, wl.forks)
    end
    return competitors
  end 
```

主要问题是对 Extractor.each 的调用...您应该将数组发送到此方法并反转此依赖关系。任何时候，您的方法都会自行获取信息，这使得测试变得困难。所以是这样的：

```
def self.find_competitors_by_tags(extractions, tags_array)
  extractions.map do |wl|
    Competitor.new(wl.html_url, wl.description, wl.watchers, wl.forks)
  end
end 
```

然后您可以轻松地发送并测试它：

```
let(:extractions) {[ stub(:competitor), {html_url: "url", description: "description", watchers: "watchers", forks: "forks"] }

it "should map the extractions" do
  competitors = Class.find_competitors_by_tags(extractions, nil)
  competitors.first.html_url.should eq("url")
  #continue
end 
```

最后注：`tags_array`似乎未使用。

# php - PHP 警告：file_get_contents 无法打开流：HTTP 请求失败！HTTP/1.1 400 错误请求

> ID：11065522
> 
> 赞同：8
> 
> 时间：2012-06-16T17:17:17.103
> 
> 标签：php, json

我已经使用 Codeigniter 构建了一个本地 DVD 数据库，其中包含电影名称等。我要做的是从[这个 IMDB API](http://imdbapi.com/)加载更多的电影数据。

但是我收到以下错误：

> 遇到 PHP 错误
> 
> 严重性：警告
> 
> 消息：file_get_contents（http://www.imdbapi.com/?i=&t=2 Fast 2 Furious）[function.file-get-contents]：打开流失败：HTTP 请求失败！HTTP/1.1 400 错误请求
> 
> 文件名：控制器/dvd.php
> 
> 行号：92

[将此 URI](http://www.imdbapi.com/?i=&t=2%20Fast%202%20Furious)复制到地址栏中会返回 json 数据，但是在我的页面中加载时，它会给我这个错误。

值得注意的是，我在 localhost 这个特定站点上运行。因为我只是熟悉 Codeigniter。

我的代码是......

```
 // Send Query To IMDB Api

        $film_q = $film_name[0]->title;
        $imdb_uri = "http://www.imdbapi.com/?i=&t=$film_q";
        $json = file_get_contents($imdb_uri);
        $json = json_decode($json);

        print_r($json); 
```

*编辑*：进一步研究这个。单字电影名称似乎可以正常加载，所以我假设我需要以某种方式在空格中钻取“+”？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-16T17:18:31.967

尝试`urlencode()`：

```
 $film_q   = urlencode($film_name[0]->title);
 $imdb_uri = "http://www.imdbapi.com/?i=&t=$film_q"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:22:41.170

您可以考虑在电影标题上运行 urlencode()。“2 F​​ast 2 Furious”中的空格可能被留下了。

您的链接应如下所示。

```
http://www.imdbapi.com/?i=&t=2%20Fast%202%20Furious 
```

不是这个。

```
http://www.imdbapi.com/?i=&t=2 Fast 2 Furious 
```

# html - 使用 -moz-transform 进行 CSS 转换

> ID：11065529
> 
> 赞同：1
> 
> 时间：2012-06-16T17:17:51.557
> 
> 标签：html, css, firefox

我正在尝试制作网页，该网页将使用框架并排显示另外两个网页。当我尝试缩小一点以便我可以看到更多页面时，就会出现问题。我正在使用 -moz-transform 但我无法得到我想要的结果。

我希望它看起来像[这样](http://i.imgur.com/syOWn.png?1)，只是在每个单独的页面上缩小更多。但是，在使用转换后，我[得到](http://i.imgur.com/NUNyh.png?1)了.

代码：

```
<div id="window1" style="height:60%; width:50%; float: left">
  <iframe style="-moz-transform: scale(0.5, 0.5); transform-origin: 0 0;" id="thistory" src="http://www.15min.lt/" height="100%" width="100%"></iframe>
</div>
<div id="window2" style="height:60%; width:50%; float: right;">
  <iframe style="-moz-transform: scale(0.5, 0.5); transform-origin: 0 0;" id="thistory1" src="http://www.15min.lt/" height="100%" width="100%"></iframe>
</div> 
```

任何建议都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:45:43.950

这`-moz-transform`就是应该如何工作。

您可以做的是使`iframe`s 的大小是它们的两倍，然后通过变换将它们缩小。这也会缩小滚动条，因此您需要`iframe`在滚动`div`条（`overflow:auto`等）中包含无滚动条的 s，以便获得正常大小的滚动条。

# c++ - 正在读取一个 bool atomic 以及它需要多少个周期

> ID：11065538
> 
> 赞同：-3
> 
> 时间：2012-06-16T17:19:03.047
> 
> 标签：c++

读取布尔值是原子动作吗？

```
if (value != true)//here I'm reading bool, then I'm comparing it to the value I'm interested in. 
```

另外，读取它需要多少个处理器周期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T17:23:48.603

> 读取布尔值是原子动作吗？

C++ 标准不强制执行任何保证。

> 读取它需要多少个处理器周期？

这取决于处理器，并且取决于从何处读取数据（磁盘交换与主内存与高速缓存与寄存器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:53:05.180

只需添加一个真实世界的示例，请考虑以下代码：

```
void f(bool x)
{
    if (x == true) x++;
} 
```

如果用 编译`g++ -S`，它会给出以下输出：

```
 .file   "test.c"
    .text
    .globl  _Z1fb
    .type   _Z1fb, @function
_Z1fb:
.LFB0:
    .cfi_startproc
    pushq   %rbp
    .cfi_def_cfa_offset 16
    .cfi_offset 6, -16
    movq    %rsp, %rbp
    .cfi_def_cfa_register 6
    movl    %edi, %eax
    movb    %al, -4(%rbp)
    cmpb    $0, -4(%rbp)
    je  .L1
    movb    $1, -4(%rbp)
.L1:
    popq    %rbp
    .cfi_def_cfa 7, 8
    ret
    .cfi_endproc
.LFE0:
    .size   _Z1fb, .-_Z1fb
    .ident  "GCC: (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3"
    .section    .note.GNU-stack,"",@progbits 
```

如果在该`cmpb $0, -4(%rbp)`指令之前，另一个线程更改了 , 的值`rbp`，则比较的结果将是未定义的。

# wpf - 如何使用 UIElement.Effect 将元素染成蓝色？

> ID：11065540
> 
> 赞同：0
> 
> 时间：2012-06-16T17:19:26.777
> 
> 标签：wpf, effects

有没有一种简单的方法可以`UIElement.Effect`在 WPF 中使用来改变我的元素的颜色，就好像它上面有一个蓝色的半透明覆盖？

我敢肯定还有很多其他方法可以实现我所追求的外观；没有必要建议这些。我想知道如何`UIElement.Effect`具体使用，而不是替代技术。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:32:00.013

Expression Blend 中的[ColorToneEffect](http://msdn.microsoft.com/en-us/library/microsoft.expression.media.effects.colortoneeffect%28v=expression.40%29.aspx)是否有用？

例如：

```
<Button Content="This is a test" Height="Auto">
    <Button.Effect>
        <ee:ColorToneEffect DarkColor="AliceBlue" LightColor="AliceBlue"/>
    </Button.Effect>
</Button> 
```

# php - 当我向数据库发出新请求时的问题视图

> ID：11065543
> 
> 赞同：0
> 
> 时间：2012-06-16T17:19:36.790
> 
> 标签：php, controller

我有一个表格。在那里您应该能够注册新用户。但它也应该检查用户名是否已经存在。如果我们假设一个人想要注册自己但他的用户名已经存在。所以我们提出了一个“用户名已经存在”的文本。当他再次尝试注册时不会丢失错误消息但会留下

```
class RegisterController {

public function DoControllNewUser() {
    $Validation = new Validation();
    $Stringer = "";
    //..skapar
    $RegisterView = New RegisterView();
    $UserHandler = new UserHandler();

    if ($RegisterView -> TriedTocreateNewUser()) {
        if ($Validation -> ValidateUserName($RegisterView -> GetUserName()) == TRUE && ($Validation -> ValidatePassword($RegisterView -> GetPassword(), $RegisterView -> GetSecondPassword()) == TRUE)) {

            $UserHandler -> DoCreateNewUser($RegisterView -> GetUserName(), $RegisterView -> GetPassword());
            if($UserHandler -> DoCreateNewUser($RegisterView -> GetUserName(), $RegisterView -> GetPassword()) == false){
                $Stringer .= "Användarnamnet finns redan hos oss!";
            }
            else{
        #   $RegisterView -> ChangeAction(true);
            $Stringer .= $RegisterView -> NewMemberMessage();
            }

        }
        if ($Validation -> ValidateUserName($RegisterView -> GetUserName()) == TRUE && ($Validation -> ValidatePassword($RegisterView -> GetPassword(), $RegisterView -> GetSecondPassword()) == false))
            $Stringer .= $RegisterView->WrongSecondPasswordMessage();
            return $Stringer;
    }
    $Stringer .= $Validation -> ShowErrorMessages();
    return $Stringer;
}

} 
```

# google-chrome-extension - 防止工具栏弹出窗口消失

> ID：11065546
> 
> 赞同：1
> 
> 时间：2012-06-16T17:19:58.677
> 
> 标签：google-chrome-extension

在我的 chrome 扩展中，我使用了一个工具栏按钮弹出窗口，其中包含最后一个焦点窗口选项卡的列表。单击某些列表项可通过 chrome.tabs.update 将该选项卡设置为活动状态（我不知道另一种方法）。之后单击弹出窗口消失。我想让它保持可见，至少直到在该窗口外单击。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T22:56:17.430

我知道这有点旧，但看起来答案是使用背景页面。此链接可能会有所帮助： http: [//mycodefixes.blogspot.com/2012/02/building-chrome-extensions-from-scratch_27.html](http://mycodefixes.blogspot.com/2012/02/building-chrome-extensions-from-scratch_27.html)。

我也是扩展的新手，所以如果其他人知道更好的方法，请告诉我！

# java - 这种构造代码有设计模式吗？

> ID：11065550
> 
> 赞同：1
> 
> 时间：2012-06-16T17:21:20.727
> 
> 标签：java, design-patterns

```
public class A {
    private A(int param1, String param2) {}

    public static A createFromCursor(Cursor c) {
        // calculate param1 and param2 from cursor
        return new A(param1, param2);
    }
} 
```

这种构造代码有设计模式吗？如果是这样，这种模式的目的是什么？为什么不直接使用：

```
// calculate param1 and param2 from cursor
new A(param1, param2); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T17:54:59.237

所以，总结一下。

该模式称为**静态工厂方法**，例如在此处进行了描述：[如何使用“静态工厂方法”而不是构造函数？](https://stackoverflow.com/questions/4029622/static-factory-method-for-constructors)

在最简单的形式中，它看起来像这样：

```
 class A {

     public static A newA() {
        return new A();
     }
     private A(){}
 } 
```

您的示例稍微复杂一些，因为它包含用于调用构造函数的计算参数

```
public class A {
    private A(int param1, String param2) {}

    public static A createFromCursor(Cursor c) {
        // calculate param1 and param2 from cursor
        return new A(param1, param2);
    }
} 
```

使用这种方式创建新对象的目的可能是需要在每次`new A(params)`直接调用之前重复计算。所以它只是避免重复自己，实现这一点的最简单方法是创建一个方法。

此外，使用相同的方式，您可以提供更多选项来创建`new A`. 例如，您可以更改计算的方式：

```
 public static A createFromCursorDifferently(Cursor c) {
        // calculate param1 and param2 from cursor in different way
        return new A(param1, param2);
    } 
```

然后你可以将相同的参数传递给这个方法，结果会有所不同（因为方法名称不同）。

当然，您可以`new A`使用与以前相同的构造函数从任何其他参数创建您的：

```
 public static A createFromObject(Object o) {
        // calculate param1 and param2 from object
        return new A(param1, param2);
    } 
```

因此，与仅使用构造函数相比，**静态工厂方法**有更多的可能性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:22:51.810

如果您的代码已编译，它将代表一个简单的[工厂方法](http://en.wikipedia.org/wiki/Factory_object)（它返回一个静态什么？当然是一个 A）。有些人认为这是一种模式，但其他人则认为它非常简单。有一种称为[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)的模式使用了这个概念，但方式要复杂得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T17:26:01.753

如果更正，您发布的内容的目的应该是提供一种方法来返回`extends A`无需先验地知道运行时类型的事物的实例。

所以是的，它听起来类似于[工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern)，尽管它与你写的有些不同。*工厂*类应该不同于*产品*类。

# c# - 解析器括号正则表达式

> ID：11065551
> 
> 赞同：0
> 
> 时间：2012-06-16T17:21:22.113
> 
> 标签：c#, regex

我完全是正则表达式的菜鸟，但我被迫使用它。

我尝试阅读有关正则表达式的其他主题，但我仍有一些问题

我有这样的字符串：

```
a(b(c))d 
```

我希望在 while 循环之后向我展示如下内容：

```
c
b(c) 
```

我试过和

```
Regex r = new Regex("/{\"(:\":\"(.*?)\")/"); 
```

但它根本没有用

您还可以向我推荐任何可以从哪里了解正则表达式的教程或书籍吗？

提前感谢拉德克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:28:45.410

如果您想了解更多关于正则表达式的信息，请[访问 http://www.regular-expressions.info/](http://www.regular-expressions.info/)

在处理嵌套内容时，正则表达式和解析[充其量是一种残缺的关系。](http://kore-nordmann.de/blog/do_NOT_parse_using_regexp.html)

由于您正在查看的模式可以任意深入，因此您需要能够理解每个支架位置的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:33:20.773

如果您使用正则表达式来执行此操作，我建议您先阅读一些教程，例如[This](http://www.codeproject.com/Articles/9099/The-30-Minute-Regex-Tutorial)

此外，您似乎正在尝试匹配字符串中的任何参数，在这种情况下，我建议您阅读[这篇文章](http://social.msdn.microsoft.com/Forums/en-US/regexp/thread/3768bbb8-e95d-493e-8698-6d760e46dbd0/)，该文章描述了类似的场景。

# php - 为我的整个站点设置目录路径

> ID：11065554
> 
> 赞同：1
> 
> 时间：2012-06-16T17:22:12.603
> 
> 标签：php

在我管理的网站上，我使用了几个`include`和`require`. 我想在每个页面中包含的一些配置文件中定义网站的整个结构，这样我就不必再担心路径了，无论文件位于何处，`include('any_filename.php');`都将始终有效。我想补充一点，该站点位于共享主机上，我无法完全控制绝对路径或任何 .ini 文件。目录结构如下所示：

```
myDomainName.com
|
+-public_html
  |
  +-pictures
  |
  +-include
  |
  +-templates 
```

myDomainName.com 是我能达到的最高点。
还是有更聪明的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:24:37.230

使用[`set_include_path`](http://php.net/manual/en/function.set-include-path.php)PHP 内置的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:24:18.987

我能想到的最好的方法是有一个包含你的基本目录的常量：

```
define("BASE_DIR", "/myDomainName.com/public_html/"); 
```

并以以下形式包含所有后续文件：

```
include BASE_DIR . "any_file.php"; 
```

如果您的 PHP 版本高于 4.3.0（很可能），您也可以使用[**`set_include_path()`**](http://php.net/manual/en/function.set-include-path.php)

# api - Twitter API 交互时间线

> ID：11065556
> 
> 赞同：1
> 
> 时间：2012-06-16T17:22:38.253
> 
> 标签：api, twitter, timeline

是否可以通过 Twitter API获得类似[Twitter/Interactions的时间线？](https://twitter.com/#!/i/connect)

我的意思是，时间线，女巫包含谁关注我，谁提到我，谁回复我，谁转发了我，谁取消关注我（所有的行动日期）。

# android - Android APK 拒绝将其原生 .so 安装到某些设备上的 /data 中

> ID：11065562
> 
> 赞同：3
> 
> 时间：2012-06-16T17:23:50.200
> 
> 标签：android, android-ndk

我成功地从 Android NDK 编译并打包了 NativeActivity 示例。它在 Android 模拟器甚至 TI OMAP3621 设备（Nook Color）上运行良好。但是，它在 Tegra 2 设备上崩溃。我还注意到 APK 中包含的 .so 被复制到 Nook 上的 /dev/dev/com.example.native_activity/lib/libnative-activity.so 中，但在 Tegra 2 手机上没有。确实创建了 /data/data/com.example.native_activity/lib 目录，但是缺少应该在其中的 .so ！我什至尝试手动复制 .so ，但是当我尝试启动它时应用程序仍然崩溃。

为什么安装程序允许安装 APK，但拒绝复制 .so？

模拟器运行 Android 2.3.3 Nook Color 运行 Android 4.0.4 Tegra 2 手机运行 Android 2.3.7

**更新：**

事实证明，如果我手动将 .so 复制到 /data ，该应用程序*确实会运行。*所以现在问题似乎是由于 aapt 的包装，因为当手机安装应用程序时，它不会复制 .so。我从命令行使用 aapt（不是通过 Eclipse），所以在包含共享库时我可能没有使用正确的选项。有人能解释一下 aapt 如何打包一个包含本机共享库的 APK 吗？

**另一个更新：**

嗯，这很奇怪。我刚刚发现，如果我安装了 APK，然后立即在已安装的应用程序上获取应用程序信息并“移动到 SD 卡”，它就可以了！.so 按预期复制到 /data/data/com.example/native-activity。如果我然后选择“移动到手机”，它也可以工作！

我在 Tegra 2 设备上运行 Cyanogenmod 7。为什么在移动/安装到 SD 卡而不是手机时这会起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:37:21.117

[库文件未在 2.3 中加载但在 4.0 中加载](https://stackoverflow.com/questions/11003506/library-file-not-loading-in-2-3-but-loading-in-4-0)

> 重建所有可能的 CPU/ABI 组合。Android 4 经常尝试加载 armeabi-v7a，而 Android 2.x 对 armeabi 很满意。
> 
> 为此，请在 jni 文件夹中创建/打开 Application.mk，然后放置以下内容：
> 
> APP_ABI := armeabi x86 armeabi-v7a mips
> 
> 仅当您拥有 NDK r8 时才使用 MIPS。

# html - 比它应该的大

> ID：11065566
> 
> 赞同：0
> 
> 时间：2012-06-16T17:24:26.340
> 
> 标签：html, css

, `<body>`, `<html>`... 和其他元素的大小通常为 385 像素（应该是），但内容区域更大。

我不明白问题出在哪里...

[https://dl.dropbox.com/u/9487343/2012-06-16%2019.09.00.jpg](https://dl.dropbox.com/u/9487343/2012-06-16%2019.09.00.jpg)

尊重盒子模型：[https ://dl.dropbox.com/u/9487343/2012-06-16%2019.31.09.jpg](https://dl.dropbox.com/u/9487343/2012-06-16%2019.31.09.jpg)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:27:47.440

您应该阅读 CSS[盒子模型](http://www.w3.org/TR/CSS2/box.html)。根据您的简短描述，我怀疑这是由于您在身体中添加了一些填充，或者是其中一个子元素。您可以尝试在文档中设置以下 CSS：

```
html,body {
    margin: 0;
    padding: 0;
    overflow: hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:29:00.960

请记住，任何高度或宽度都不包括填充、边距和边框宽度。大的内容可能会推动一个比设定的更宽的盒子。

# python - 使用 heroku/python/django 导入数据库 (.mdb)

> ID：11065567
> 
> 赞同：1
> 
> 时间：2012-06-16T17:24:29.003
> 
> 标签：python, django, ms-access, heroku

我们正在使用 python/django 创建一个 web 应用程序，托管在 heroku 上。我们想要的部分功能是用户能够将 .mdbs（Access 数据库）上传到我们的站点，然后对其进行解析。服务器运行 linux（因此 windows 解决方案将不起作用），受到 heroku 的限制。

在我们的本地测试服务器上，我们使用 shell 脚本从 mdb 创建 csvs，然后使用 python 代码读取 csvs，从而毫无问题地完成此操作。但是，一旦我们推送到heroku，这将不起作用

我尝试过使用 pyodbc，但在配置驱动程序时遇到了问题，即使在我们的测试机器上也是如此。

有没有人对可能的解决方法有任何想法，或者过去成功地做到了这一点？我很乐意发布任何可能有用的代码，或提供任何其他可能有用的信息。我也对任何解决方案持开放态度——在这一点上，我们只需要让它发挥作用

感谢你们！

# magento - Magento 显示“抱歉，此时此订单没有报价”

> ID：11065570
> 
> 赞同：4
> 
> 时间：2012-06-16T17:24:49.470
> 
> 标签：magento, shipping

我正在使用magento 1.6版。我在使用客人结账时遇到了这个问题，当我在第 4 步（这是运输方式）时，它一直显示“抱歉，此时此订单没有可用的报价”。我输入了正确的地址、正确的邮政编码和正确的国家。但是，如果我用我的帐户登录错误，我可以看到正确的运费计算。

我用谷歌搜索了一下，我读到我必须在管理员中设置“如果不适用则显示方法”为是。我跟着它，但它仍然对我没有帮助。

而且，该问题仅发生在某个产品类别上，并非所有项目都发生。例如：我有1类、2类、3类、4类。所有属于2类和4类的产品，发货方式都会显示“对不起，这个订单目前没有报价”。但是第 1 类和第 3 类计算正确的费用。

对此有任何想法吗？

附加信息：

```
 Shipping Method Use

     1\. Flatrate - Fixed per item ($3.00)
     2\. Tablerate (Bestway) - Weight vs. Destination (I have no idea about the configuration of this). That is just what i saw in admin. I'm nob on this!
     3\. Free Shipping - For every $500 purchase 
```

经过进一步调查，我发现：
如果购物车中的总成本低于 500.00 美元，它将忽略统一费率运输方式，这被认为是当其总额未达到 500 时使用的方法。而且，将返回消息“抱歉，此时此订单没有可用的报价”。但如果您购物车中的总金额大于或等于 500 美元，您将在列表中看到免费送货方式。没有其他方法出现。

这里的问题是，即使您在管理员中设置了最小值，下面的代码也不会返回任何值。

```
 $this->getConfigData('free_shipping_subtotal') 
```

但如果它的购物车总额 >= 500 美元，那么一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T14:21:46.523

Well if it's specifically do with the products in categories 2 and 4 then I would look at how you've set up the weights for the products in those categories. Just a total guess (you've not elaborated on your shipping method) but Magento will return the "Sorry, no quotes available for this order at this time" message if the total weight of the order exceeds the upper weight that has been catered for by your shipping matrix.

There's something different about those products - identify what that is!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-28T20:41:42.223

对我来说，问题是因为我使用 UPS 作为我唯一的运输方式，而且我来自中国。

UPS 从中国发货时无法计算任何运费，所以我唯一的解决方案是将原产地切换到美国。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2015-06-19T13:30:54.167

**遵循相同的步骤并且工作正常。**

> 第 1 步：转到管理面板找到导航系统 >> 配置
> 
> 第2步：销售>>运输方式>>手续费文本字段输入0值并保存并清除缓存并检查前端

# android - 简单的 Android 相机应用程序 - 旋转导致 NullPointerException

> ID：11065574
> 
> 赞同：1
> 
> 时间：2012-06-16T17:26:16.693
> 
> 标签：android, camera, nullpointerexception, android-orientation

我是 Android 开发的新手，正在玩相机。我只是想创建一个简单的应用程序，该应用程序将使用本机相机应用程序拍照并返回该图像的文件路径。

我的工作正常，但我遇到了一个奇怪的错误。当我点击按钮启动相机时，如果我在相机应用程序中更改屏幕方向，并且在我退出相机之前不切换回来（当我被问到是否要重新拍摄时按下完成按钮与否），它会导致 NullPointerException 被抛出。

我对如何弄清楚这一点有点不知所措，所以任何信息都会有所帮助！

这是我到目前为止的代码：

```
package com.CameraTest;

import android.app.Activity;
import android.content.ContentValues;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class CameraTestActivity extends Activity
{
    private static final int CAMERA_PIC_REQUEST = 1234;
    protected Uri mCapturedImageURI;
    protected TextView textview;
    protected Button button;

    /** Called when the activity is first created. */
    @Override public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        button = (Button) findViewById(R.id.button1);
        textview = (TextView) findViewById(R.id.textView1);

        if (savedInstanceState != null) {
            textview.setText(savedInstanceState.getString("textview"));
        }

        button.setOnClickListener(new View.OnClickListener()
        {
            public void onClick(View view)
            {               
                String fileName = "temp.jpg";  
                ContentValues values = new ContentValues();  
                values.put(MediaStore.Images.Media.TITLE, fileName);  
                mCapturedImageURI = getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);  

                Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);  
                intent.putExtra(MediaStore.EXTRA_OUTPUT, mCapturedImageURI);  
                startActivityForResult(intent, CAMERA_PIC_REQUEST);
            }
        });
    }

    @Override protected void onSaveInstanceState(Bundle outState)
    {
        super.onSaveInstanceState(outState);

        outState.putString("textview", textview.getText().toString());
    }

    protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {
        super.onActivityResult(requestCode, resultCode, data);

        if (requestCode == CAMERA_PIC_REQUEST && resultCode == -1)
        {
            String[] projection = { MediaStore.Images.Media.DATA}; 
            Cursor cursor = managedQuery(this.mCapturedImageURI, projection, null, null, null); 
            int column_index_data = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA); 
            cursor.moveToFirst(); 
            String capturedImageFilePath = cursor.getString(column_index_data);
            this.textview.setText("File Path:" + capturedImageFilePath);
        }
    }    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:03:32.273

你必须改变你的清单文件

在您的清单中只需替换以下代码

```
<activity android:name=".CameraTestActivity"
              android:label="@string/app_name" android:configChanges="keyboardHidden|orientation"> 
```

用你的代码

```
<activity android:name=".CameraTestActivity"
              android:label="@string/app_name"> 
```

# python - Python/SQLite 按 TEXT 日期排序

> ID：11065575
> 
> 赞同：1
> 
> 时间：2012-06-16T17:26:27.997
> 
> 标签：python, sqlite, datetime

SQLite 文档说将日期存储为 TEXT 或 sqlite 二进制文件。所以，我想我会使用 str(datetime.datetime.now())。当它以 TEXT 格式存储时，您将如何按日期顺序对列进行排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T17:34:18.607

ISO 日期是文本可排序的：

```
>>> datetime.now().isoformat()
'2012-06-16T19:34:05.418407'
>>> sorted([datetime.now().isoformat(), (datetime.now() - timedelta(days=100)).isoformat()])
['2012-03-08T19:34:06.802304', '2012-06-16T19:34:06.802288'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:35:03.100

只有[ISO 8601 时间格式](http://en.wikipedia.org/wiki/ISO_8601)有可能被分类为文本，即使有多种合法格式，这也很有可能。

这就是[datetime 模块](http://docs.python.org/library/datetime.html)存在的原因，使用它。

# java - 在java中模拟线程调度（stackless java？）

> ID：11065582
> 
> 赞同：3
> 
> 时间：2012-06-16T17:28:24.980
> 
> 标签：java, scheduling, python-stackless, stackless

对于一些学术研究，我需要模拟在单个处理器上运行的多个线程。

我希望能够在我的代码中插入 *call_scheduler()* 调用，其中当前的“线程”将暂停（记住它在哪个代码行中）并且一些调度函数将决定放开哪个线程。

在 python 中，这可以使用无堆栈 python 巧妙地实现。有java替代品吗？

我可以使用真正的线程和一些消息队列（或管道）来实现它，这将强制一次只运行一个线程 - 但这是一个丑陋且有问题的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:06:36.490

对于协作用户线程，您可以使用 Apache javaflow 延续： [http ://commons.apache.org/sandbox/javaflow/](http://commons.apache.org/sandbox/javaflow/)

我很想知道如何用这个延续包实现一个抢占式调度程序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:18:55.907

像 Akka 这样的 Scala 演员框架就是这样做的。每个线程处理许多演员，这就是他们如此高效地创建的方式。我建议看看他们的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:49:50.173

你的问题：

我可以使用真正的线程和一些消息队列（或管道）来实现它`that will force only one thread to run at a time`- 但这是一个丑陋且有问题的解决方案

好吧，如果您希望一次只运行一个线程，通过以更简洁的方式控制线程对对象的访问，然后使用`Semaphores in java.util.concurrent package.`

`Semaphores sem = new Semaphores(1);` // 这里的1表示只有一个线程可以访问

使用`sem.acquire() to get the key of the object, and when its done, use sem.release()` 然后只有另一个线程将获得对该对象的访问权限。

# database - 函数依赖的最小覆盖

> ID：11065586
> 
> 赞同：1
> 
> 时间：2012-06-16T17:28:45.037
> 
> 标签：database, functional-dependencies

我有点难以理解最小覆盖的概念，所以我想知道我是否做对了，这样说是真的吗：

给定一个具有属性 A1...An 的关系 R

如果 G 是 FD 集 F 的最小覆盖，那么对于 R 中的每个属性子集 X，X 在 F 中的闭包与 X 在 G 中的闭包相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T21:53:18.807

就闭包而言，您是对的，您可以将其视为一系列 FD 的简化：如果您有`F = {A->B, B->C, A->C}`FD ，则它是多余的，`A->C`因为它可以从前两个 FD 派生。在这种情况下，F 的最小覆盖 G 是`{A->B, B->C}`。

# ruby-on-rails-3 - 路由中没有父 ID 的嵌套资源

> ID：11065591
> 
> 赞同：2
> 
> 时间：2012-06-16T17:29:10.473
> 
> 标签：ruby-on-rails-3, routes, nested-resources

我有两个资源：

```
resources :users do
 resources :cars
end 
```

该协会是：

*   一个用户可以有很多辆车
*   一辆车属于一个用户

在进行这种嵌套资源时，我会得到如下网址：

```
/users/:id/cars/new 
```

我的问题是：

如果只做`/cars/new`（没有 /users/:id）更有意义，因为我`:id`从 current_user 登录，我将如何在路由中解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-17T20:38:02.360

这个问题的正确答案是：

```
resources :users do
  collection do
    resources :cars
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T18:01:08.090

我根本不会使用嵌套路由。您可以拥有嵌套模型而不必拥有嵌套路由。只需从会话中加载当前用户（您可能已经这样做了），并确保没有人可以访问汽车控制器，除非他们已登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:54:12.873

在路线.rb

```
resources :cars, :only => [:new, :create] # if you don't need all actions
resources :users do
  resources :cars
end 
```

在汽车控制器中类似

```
before_filter :find_user
...
private
def find_user
  @user = params[:user_id] ? User.find(params[:user_id]) : current_user
end 
```

# google-drive-api - 如何使用 google drive sdk 将文件共享给其他人？

> ID：11065593
> 
> 赞同：1
> 
> 时间：2012-06-16T17:29:40.043
> 
> 标签：google-drive-api

我想使用我的代码而不是 Google Drive Web 界面共享文件。

我已经检查了下面页面上的 API 参考，找不到任何方法可以做到这一点，是因为 SDK/API 不允许这样做吗？ [https://developers.google.com/drive/v1/reference](https://developers.google.com/drive/v1/reference)

谢谢大家可以给一些关于这个问题的提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T19:40:00.730

Drive API 目前无法做到这一点，但您可以使用 Documents List API 来管理共享：[https ://developers.google.com/google-apps/documents-list/#managing_sharing_permissions_of_resources_via_access_control_lists_acls](https://developers.google.com/google-apps/documents-list/#managing_sharing_permissions_of_resources_via_access_control_lists_acls)

# mongodb - 使用 YAML 进行地理空间索引“未找到字段映射”

> ID：11065595
> 
> 赞同：1
> 
> 时间：2012-06-16T17:29:58.740
> 
> 标签：mongodb, doctrine-orm, yaml, geospatial, embedded-database

我在尝试使用 Doctrine2 的 OD 和 YAML 格式和 MongoDB 映射嵌入文档以进行地理空间索引时遇到问题：我会尝试在“位置”文档中嵌入“坐标”文档，以便能够执行一些地理空间索引查询，但是有一个映射问题。

如官方文档所示： http: [//docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/indexes.html#geospatial-indexing](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/indexes.html#geospatial-indexing)

但我使用 YAML 映射格式......并遇到了这个问题：

“在类'IntraMuros\CoreBundle\Document\Coordinates'中找不到字段'/Applications/MAMP/htdocs/intramuros-web/src/IntraMuros/CoreBundle/Resources/config/doctrine/Coordinates.mongodb.yml'的映射。”

这是我的 YAML 文件：Place.mongodb.yml，正确放置在我的 Symfony2 包的 Resources\config 目录中。

```
IntraMuros\CoreBundle\Document\Place:
  type: document
  db: intramuros
  collection: places
  repositoryClass: IntraMuros\CoreBundle\Repository\PlaceRepository
  fields:
    id:
      type: id
      id:  true
    name:
      type: string
    address:
      type: string
    coordinates:
      embedded: true
      type: one
      targetDocument: IntraMuros\CoreBundle\Document\Coordinates
      cascade: all
      strategy: set
    indexes:
      coordinates:
        keys:
          coordinates: 2d

IntraMuros\CoreBundle\Document\Coordinates:
  type: EmbeddedDocument
  db: intramuros
  fields:
    latitude:
      type: float
    longitude:
      type: float 
```

这是我要使用的 PHP Document 类。

```
<?php

namespace IntraMuros\CoreBundle\Document;

/**
 * @Document(requireIndexes=true)
 * @Indexes({
 *     @Index(keys={"coordinates"="2d"})
 * })
 */
class Place
{
    /**
     * @Id
     */
    protected $id;

    /**
     * @String
     */
    protected $name;

    /**
     * @String 
     */
    protected $address;

    /**
     * @EmbedOne(targetDocument="IntraMuros\CoreBundle\Document\Coordinates")
     */
    protected $coordinates;

    public function __construct($latitude = NULL, $longitude = NULL)
    {
        $coordinates = new Coordinates($latitude, $longitude);
        $this->setCoordinates($coordinates);
    }

    public function getId()
    {
        return $this->id;
    }

    public function setName($name)
    {
        $this->name = $name;
    }

    public function getName()
    {
        return $this->name;
    }

    public function setAddress($address)
    {
        $this->address = $address;
    }

    public function getAddress()
    {
        return $this->address;
    }

    public function setCoordinates($coordinates)
    {
        $this->coordinates = $coordinates;
    }

    public function getCoordinates($toArray = false)
    {
        if ($toArray) {
            if ($this->coordinates) {
                return $this->coordinates->toArray();
            }
        }
        return $this->coordinates;
    }

    public function toArray()
    {
        return array(
            'id' => $this->getId(),
            'name' => $this->getName(),
            'address' => $this->getAddress(),
            'coordinates' => $this->getCoordinates(true)
        );
    }
}

/**
 * @EmbeddedDocument
 */
class Coordinates
{
    /**
     * @Float
     */
    protected $latitude;

    /**
     * @Float
     */
    protected $longitude;

    public function __construct($latitude = NULL, $longitude = NULL)
    {
        $this->latitude = $latitude;
        $this->longitude = $longitude;
    }

    public function setLatitude($latitude)
    {
        $this->latitude = $latitude;
    }

    public function getLatitude()
    {
        return $this->latitude;
    }

    public function setLongitude($longitude)
    {
        $this->longitude = $longitude;
    }

    public function getLongitude()
    {
        return $this->longitude;
    }

    public function toArray()
    {
        return array(
            'latitude' => $this->getLatitude(),
            'longitude' => $this->getLongitude()
        );
    }
} 
```

非常感谢你，鲍比。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-16T22:44:34.067

您应该使用注释而不是 YML 来映射您的文档。

它会很容易工作。

祝你好运 ！;)

# .net - 如何获得 MS Office 插件的安全证书？

> ID：11065598
> 
> 赞同：7
> 
> 时间：2012-06-16T17:30:36.863
> 
> 标签：.net, security, certificate, ms-office, add-in

办公室里的一些人觉得不得不禁用“Outlook 加载项的宏安全性”才能让我的加载项正常工作。

如何为我的加载项获取安全证书，以便在当前存在安全设置的情况下加载它？值得麻烦吗？是不是要花很多钱？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:38:45.747

为此，您需要一个代码签名证书。各种证书颁发机构发布它们：

1.  [http://www.symantec.com/verisign/code-signing/microsoft-authenticode](http://www.symantec.com/verisign/code-signing/microsoft-authenticode)
2.  [http://www.thawte.com/code-signing/content-signing-certificates/microsoft-office/index.html](http://www.thawte.com/code-signing/content-signing-certificates/microsoft-office/index.html)

这只是两个，但还有更多。

当然，您可以创建自己的代码签名证书（实际上是两个，一个根证书和一个代码签名证书）。但缺点是您需要在安装插件的每台计算机上安装根证书。

# google-closure-compiler - 如何使用 Google Closure 优化 CasperJS 项目？

> ID：11065601
> 
> 赞同：1
> 
> 时间：2012-06-16T17:30:47.657
> 
> 标签：google-closure-compiler, casperjs

我正在尝试优化 CasperJS 测试 run.js 代码（https://github.com/n1k0/casperjs/blob/master/tests/run.js），以便我可以了解如何进一步使用它来优化进一步我写的测试。这是我尝试使用编译器的 ADVANCED_OPTIMIZATIONS 标志优化的 CasperJS 项目的示例 run.js。(https://github.com/n1k0/casperjs/blob/master/tests/run.js) 但优化后的代码如下：

```
phantom.d || (console.log("This script must be invoked using the casperjs executable"), phantom.c(1)); var a = require("fs"), c = require("utils").h, d = require("casper").create({g:!1}); d.options.n = d.a.get("direct") || !1; d.options.i = d.a.get("log-level") || "error"; d.m("open.location", function(b) { return!/^http/.test(b) ? c("file://%s/%s", phantom.e, b) : b }); var e = []; d.a.b.length ? e = d.a.b.filter(function(b) { return a.isFile(b) || a.isDirectory(b) }) : (d.f("No test path passed, exiting.", "RED_BAR", 80), d.c(1)); d.test.j("tests.complete", function() { this.k(true, void 0, d.a.get("xunit") || void 0) }); d.test.l.apply(d.test, e); 
```

显然，编译器告诉这是失败的（例如：JSC_INEXISTENT_PROPERTY: Property casperLoaded never defined on phantom at line 2 character 5 if (!phantom.casperLoaded)）

您能否指导我如何使用 Closure 编译器来优化项目中的所有 JS 文件及其依赖项，从而避免这些错误并继续进行。

我浏览了 Closure 的文档，但我无法弄清楚这种情况下所需的方法。

仅供参考：我使用的是 Closure compiler.jar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:31:39.653

已向 Closure Compiler 添加了支持，以便使用以下编译器标志更轻松地使用[Common JS](http://www.commonjs.org/specs/)和[AMD/require.js模块：](http://requirejs.org/docs/whyamd.html)

*   `--transform_amd_modules`
*   `--process_common_js_modules`
*   `--common_js_entry_module`
*   `--common_js_module_path_prefix`

请参阅[Closure Compiler 中对 Common JS 和 AMD/require.js 模块的实验性支持](http://www.nonblocking.io/2011/12/experimental-support-for-common-js-and.html)

# javascript - 为什么 NodeJS 更喜欢逗号优先的编码风格？

> ID：11065604
> 
> 赞同：14
> 
> 时间：2012-06-16T17:30:56.320
> 
> 标签：javascript, node.js, jslint

我最近一直在学习 NodeJS。

首先用逗号编写代码似乎是 Node 世界的标准：

```
var connect = require('connect')
  , HTTPSServer = require('./https')
  , HTTPServer = require('./http')
  , Route = require('./router/route') 
```

我不喜欢它，我通过 JSLint 的代码编辑器会抛出无数错误。

我的问题是：“nodesters”这样做是否有正当理由，或者它只是一种很酷的新风格？

到目前为止，我一直在通过将逗号放回“它们应该在的位置”来“纠正”它以符合 JSLint。

但最近我发现这种方法不是很可持续，特别是如果我要使用更多的社区模块。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-16T17:35:02.477

通常，它使代码看起来更清晰（主观），并且容易发现错误。**[快乐阅读](https://gist.github.com/357981)**

# ios - 未调用 didSelectViewController 方法（带有情节提要）

> ID：11065605
> 
> 赞同：3
> 
> 时间：2012-06-16T17:31:17.723
> 
> 标签：ios, ios5, uitabbarcontroller, storyboard

我有 2 个版本的选项卡式 ios5 应用程序，一个使用情节提要创建，一个使用 xib 文件创建。故事板版本不调用该`UITabBarControllerDelegate`方法`didSelectViewController`（xib 版本调用）。故事板（我认为）缺少某些东西，但我不知道是什么。提出问题的另一种方式可能是——我如何引用`UITabBarController`故事板实例化的对象？

谢谢你的帮助。

编辑：标签栏控制器委托设置：

在 AppDelegate.h 中：

```
@interface MyAppDelegate : UIResponder <UIApplicationDelegate, UITabBarControllerDelegate>
@property (strong, nonatomic) UITabBarController *tabBarController; 
```

在 AppDelegate.m 中：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.tabBarController.delegate = self;
    return YES;
} 
```

然后稍后在 AppDelegate.m 中，委托方法是：

```
- (void) tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController
{
    NSLog(@"Got Here");
} 
```

NSLog 输出永远不会出现。在我看来，问题似乎是我没有正确引用故事板已实例化的选项卡栏控制器对象。我怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-11T10:25:25.997

我有这个问题。

如果您不使用情节提要，则可以`UITabBarController`在其中设置委托`AppDelegate`。但是，使用 时`Storyboards`，`AppDelegate`不知道`tabBarController`启动时在哪里。您会想到`subclassing`并`tabBarController`添加委托方法：

```
(void)tabBarController:(UITabBarController *)tabBarController
   didSelectViewController:(UIViewController *)viewController {

} 
```

……就够了。但是，令人恼火的是没有。

我需要知道用户何时按下了选项卡按钮。我需要更多地了解这一点，我需要知道 viewController 的 " `- (void)viewWillDisappear:(BOOL)animated {}` " 方法已经运行。

我决定让自己成为自己`UITabBarController`的代表。这对我来说似乎很愚蠢，但我做了以下......

```
#import <UIKit/UIKit.h>

@interface PlumbsTabBarController : UITabBarController <UITabBarControllerDelegate>

@end 
```

然后，在我的`viewDidLoad`方法中，写了以下内容：

```
[self setDelegate:self]; 
```

这使我的标签栏委托方法能够运行。

疯了还是什么？

好的 - 我现在正在编辑这个答案，即使上面的内容都是正确的，在`navigationController`使用 a 的地方，每次`tabBarButton`触摸都会选择`didSelectViewController`，当您尝试`NSLog(@"%@", viewController);`仅向您显示您已选择`UINavigationController`该类时，委托方法将？

因此，为了增加更多复杂性，总的解决方案是`UINavigationController`为每个`viewController`要监视的对象子类化，（做某事）当`tabBarbutton`被触摸时。

无论如何它对我有用。而且，如果有人可以通过上面的运球来挑剔，他们可能会发现一个有用的方面——这对我来说已经足够了——因为我发现这个网站也非常有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-23T14:58:31.043

放入`[self setDelegate:self];`您`ViewDidLoad`或对象初始化的地方

# c++ - 'int8_t'：尝试将 mysql cpp 连接器连接到 Visual Studio 2010 时，config.h 中的重新定义错误

> ID：11065606
> 
> 赞同：0
> 
> 时间：2012-06-16T17:31:42.693
> 
> 标签：c++, visual-studio-2010, connector

这是尝试使用 Visual Studio 编译我的文件时生成的完整错误报告。编译后的文件是在网上找到的示例代码。它使用非常基本的方法直接连接到 mysql 数据库。

错误输出：

```
> 1>------ Build started: Project: mysql-sample, Configuration: Debug
> x64 ------ 1>Build started 16/06/2012 22:49:55\. 1>PrepareForBuild: 1> 
> Creating directory "c:\users\rupertt aryeen wind\documents\visual
> studio 2010\Projects\mysql-sample\x64\Debug\".
> 1>InitializeBuildStatus: 1>  Creating
> "x64\Debug\mysql-sample.unsuccessfulbuild" because "AlwaysCreate" was
> specified. 1>ClCompile: 1>  stdafx.cpp 1>  mysql-sample.cpp
> 1>c:\program files\mysql\connector c++ 1.1.0\include\sqlstring.h(36):
> warning C4251: 'sql::SQLString::realStr' : class
> 'std::basic_string<_Elem,_Traits,_Ax>' needs to have dll-interface to
> be used by clients of class 'sql::SQLString' 1>          with 1>      
> [ 1>              _Elem=char, 1>             
> _Traits=std::char_traits<char>, 1>              _Ax=std::allocator<char> 1>          ] 1>C:\Program Files\MySQL\Connector C++ 1.1.0\include\mysql_connection.h(156):
> warning C4251: 'sql::mysql::MySQL_Connection::proxy' : class
> 'boost::shared_ptr<T>' needs to have dll-interface to be used by
> clients of class 'sql::mysql::MySQL_Connection' 1>          with 1>   
> [ 1>              T=sql::mysql::NativeAPI::NativeConnectionWrapper 1> 
> ] 1>C:\Program Files\MySQL\Connector C++
> 1.1.0\include\cppconn/exception.h(59): warning C4251: 'sql::SQLException::sql_state' : class
> 'std::basic_string<_Elem,_Traits,_Ax>' needs to have dll-interface to
> be used by clients of class 'sql::SQLException' 1>          with 1>   
> [ 1>              _Elem=char, 1>             
> _Traits=std::char_traits<char>, 1>              _Ax=std::allocator<char> 1>          ] 1>c:\program files\mysql\connector c++ 1.1.0\include\cppconn\config.h(60): error
> C2371: 'int8_t' : redefinition; different basic types 1>         
> C:\Program Files (x86)\Microsoft Visual Studio
> 10.0\VC\include\stdint.h(17) : see declaration of 'int8_t' 1>c:\program files\mysql\connector c++
> 1.1.0\include\cppconn\config.h(60): error C2371: 'int8_t' : redefinition; different basic types 1>          C:\Program Files
> (x86)\Microsoft Visual Studio 10.0\VC\include\stdint.h(17) : see
> declaration of 'int8_t' 1> 1>Build FAILED. 1> 1>Time Elapsed
> 00:00:12.92
> ========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:53:12.760

看起来您应该能够通过在项目设置中设置以下宏定义来解决此问题：

```
HAVE_INT8_T=1 
```

或者`/DHAVE_INT8_T=1`如果您使用的是命令行。

实际上，您可能应该在项目中设置以下宏定义：

```
HAVE_STDINT_H=1
CPPCONN_DONT_TYPEDEF_MS_TYPES_TO_C99_TYPES=1 
```

这应该使 MySQL 连接器标头仅依赖于`stdint.h`C99 整数类型名，而不是尝试自行定义它们中的任何一个。

# python - 在 mac 中设置龙卷风

> ID：11065607
> 
> 赞同：0
> 
> 时间：2012-06-16T17:31:45.010
> 
> 标签：python, installation, tornado

我是使用 Mac 和龙卷风的新手。我已经安装了easy_install并尝试安装tornado，但我不断收到“权限被拒绝”

easy_install 龙卷风

搜索 tornado 最佳匹配：tornado 2.3 处理 tornado-2.3-py2.7.egg 将 tornado 2.3 添加到 easy-install.pth 文件错误：/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site -packages/easy-install.pth：权限被拒绝

出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-22T01:46:28.027

尝试像这样运行它：

sudo easy_install 龙卷风

当您在 OSX 上使用 stock python 时，easy_install 命令将在整个系统范围内安装 tornado，因此需要管理员权限。当使用 homebrew python 时（例如安装 brew 和带有“brew install python”的python），您可以安装 python 包而无需执行 sudo。

一句忠告：在处理大量python项目时，最好使用virtualenv来安装python deps；这样你就可以拥有多个独立的 python 环境并且你不需要 sudo。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:34:12.573

`virtualenv`如果您想在系统范围内安装 tornado 或查看在沙盒环境中安装 python 包，您可能想尝试以 root 身份运行该命令。`pythonbrew`另外，如果您想尝试各种版本的 Python ，我建议您这样做。

# c# - 如何显示保存在 int 变量中的文本？

> ID：11065608
> 
> 赞同：-1
> 
> 时间：2012-06-16T17:31:51.237
> 
> 标签：c#

我的变量包含一些文本，但当前存储为 int（使用的类读取内存地址处的字节并转换为 int。Variable.ToString 仅显示十进制表示，但不将其编码为可读文本，或换句话说，我现在想使用 ascii 编码或其他方式将数据从 int 转换为字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T19:06:34.910

假设一个 int 变量

```
 int x=10; 
```

您可以将其转换为字符串

```
 string strX = x.ToString(); 
```

尝试这个

```
 string s = "9quali52ty3";
    byte[] ASCIIValues = Encoding.ASCII.GetBytes(s);
    foreach(byte b in ASCIIValues) {
    Console.WriteLine(b);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T21:09:53.310

这是一个演示（基于我们上面的 Q+A）。

注意：设置一个带有空终止符的字符串作为测试，然后将其编码为 ASCII 字节，然后使用 unsafe（您需要在项目属性的 Build Option 中允许它），遍历每个字节并转换它直到 0x0 到达。

```
private void button1_Click(object sender, EventArgs e)
        {
            var ok = "OK" + (char)0;
            var ascii = Encoding.ASCII;

            var bin = ascii.GetBytes( ok );

            var sb = new StringBuilder();
            unsafe
            {

                fixed (byte* p = bin)
                {
                    byte b = 1;
                    var i = 0;
                    while (b != 0)
                    {
                        b = p[i];

                        if (b != 0) sb.Append( ascii.GetString( new[] {b} ) );
                        i++;
                    }
                }
            }
            Console.WriteLine(sb);
        } 
```

请注意 FIXED 语句，这是必需的托管字符串/数组等不保证静态放置在内存中 - 这可以确保它在该部分期间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:34:05.967

[Int32.ToString()](http://msdn.microsoft.com/en-us/library/8wch342y.aspx)有一个采用格式字符串的重载。查看可用的格式字符串并使用其中之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T19:20:44.680

好的。如果您的变量是一个指针，那么 Tim 将您指向正确的方向（假设它是一个地址而不是地址的偏移量 - 在这种情况下，您将需要起始地址来偏移）。

另一方面，如果您的变量包含四个编码的 ascii 字符（每个字节），那么您需要拆分为字节并将每个字节转换为一个字符。像这样的东西`Console.WriteLine(TypeDescriptor.GetConverter(myUint).ConvertTo(myUint, typeof(string)));`从[这里 - MSDN ByteConverter](http://msdn.microsoft.com/en-us/library/system.componentmodel.byteconverter.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-16T17:36:43.330

从您之前的问题来看，您拥有的 int （可能）是指向字符串的指针。根据指针处的数据是字符还是字节，执行以下操作之一来获取您的字符串：

```
var s = new string((char*)myInt);
var s = new string((sbyte*)myInt); 
```

# python - 使用 django-allauth

> ID：11065610
> 
> 赞同：5
> 
> 时间：2012-06-16T17:32:22.040
> 
> 标签：python, django, django-admin, django-allauth

我在使用 django-allauth 时遇到问题。我收到这个错误。

NoReverseMatch at /accounts/login/ 使用参数“()”和关键字参数“{}”对“facebook_channel”进行反向操作。

到目前为止，我已经遵循了一切。

这是我的 settings.py

```
INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
    'app',
    'uni_form',
    'emailconfirmation',
    'allauth',
    'allauth.account',
    'allauth.socialaccount',
    'allauth.socialaccount.providers.facebook',
    'allauth.socialaccount.providers.twitter',
)

TEMPLATE_CONTEXT_PROCESSORS = (
    "django.core.context_processors.request",
    "allauth.context_processors.allauth",
    "allauth.account.context_processors.account",
    "django.contrib.auth.context_processors.auth",
)

AUTHENTICATION_BACKENDS = (
    "allauth.account.auth_backends.AuthenticationBackend",
) 
```

我还从 allauth 提供的管理模块添加了 facebook 密码和应用程​​序 ID。

期待快速回复。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-17T23:11:13.027

刚刚面对并解决了同样的问题。您需要安装 django-allauth 所依赖的 Facebook SDK egg，即：

```
pip install -e git://github.com/pythonforfacebook/facebook-sdk.git#egg=facebook-sdk 
```

（顺便说一下，如果您使用的是 Django 1.4，由于 django-allauth 没有使用新的时区感知日期，在确认电子邮件地址时会遇到运行时错误。快速修复是设置

```
USE_TZ = False 
```

在您的 settings.py 中。）

# qt - 使用 on_textEdit_textChanged() 的 WebKit Previewer 示例程序崩溃

> ID：11065612
> 
> 赞同：1
> 
> 时间：2012-06-16T17:32:28.383
> 
> 标签：qt, webkit, qtwebkit

我重新创建了一个 webkit 的示例，它显示了包含 HTML 的 textEdit 的内容：http: [//qt-project.org/doc/qt-4.8/webkit-previewer.html](http://qt-project.org/doc/qt-4.8/webkit-previewer.html)

我对其进行了更改，而不是在单击按钮时更改 webkit HTML，而是在更改 textEdit 中的文本时更改了它：

```
// changed when button is click. Works fine.
void Previewer::on_previewButton_clicked()
{
    // Update the contents in web viewer
    QString text = htmlTextEdit->toPlainText();
    webView->setHtml(text);
}

// change when text is changed. Crashes.
void Previewer::on_htmlTextEdit_textChanged()
{
    // Update the contents in web viewer
    QString text = "<html><body><h1>No crash!</h1></body></html>";
    webView->setHtml(text);
} 
```

这会导致程序一启动就崩溃。我稍后更改了程序以运行该函数（我认为可能需要初始化一些东西），但是一旦到达 textChanged 函数，它仍然崩溃。为什么会崩溃？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T00:48:58.097

您的程序正在进入一个无限循环，因为在示例中，webView 的`loadFinished(bool)`信号和 text/html 编辑器的`updateTextEdit()`插槽之间存在连接。

基本上，编辑 HTML 会导致页面再次加载，这会导致编辑器更新，从而导致页面再次加载，依此类推。

我解决这个问题的一个快速方法是向`updateTextEdit`SLOT/函数添加一个静态布尔标志，只允许它运行一次。

```
 void MainWindow::updateTextEdit()
 {
     static bool once = false;

     if (once) {
         return;
     }

     once = true;

     QWebFrame *mainFrame = centralWidget->webView->page()->mainFrame();
     QString frameText = mainFrame->toHtml();
     centralWidget->plainTextEdit->setPlainText(frameText);
 } 
```

这样做对我有用，但你的版本可能与我的不同。我密切关注该示例，但`htmlchanged()`在预览器类中添加了一个插槽，并像这样进行连接：

```
connect(centralWidget->plainTextEdit, SIGNAL(textChanged()), centralWidget, SLOT(html_changed())); 
```

另外，我不是专家，但我很确定这不是解决这个问题的最佳方法，我认为这`updateTextEdit()`需要运行不止一次。不过，它会暂时起作用。

# php - 如何从数据库中返回有序数据

> ID：11065620
> 
> 赞同：2
> 
> 时间：2012-06-16T17:33:28.803
> 
> 标签：php, mysql

假设我有一个包含 4 个字段的 mySQL 数据库表：

*   link_id（主键）
*   page_id
*   锚文本
*   网址

我的数据如下所示：

```
link_id | page_id | anchor_text | url 
1       | 1       | Link One    | http://www.one.com
2       | 1       | Link Two    | http://www.two.com
3       | 2       | Link Three  | http://www.three.com 
```

我如何最好地编写一个函数来获取给定页面的链接，然后使用该函数来显示它们？

## **功能：**

```
 function get_page_links($page_id) {

        $db = new mysqli("localhost", "root", "root", "my_db");

        //what's next?

        } 
```

**用法：**

```
$my_links = get_page_links(1);

//do something to parse $my_links 
```

**展示：**

```
<a href="http://www.one.com">Link One</a>
<a href="http://www.two.com">Link Two</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:38:42.460

```
$q = "SELECT *";
$q.= " FROM yourtablename";
$q.= " WHERE `page-id` = ".(int)$page_id;
$q.= " ORDER BY `link-id`"; 
```

可能不需要反引号，但我将它们扔在那里，因为您的字段名称中有连字符。

请注意，这里正在进行非常基本的验证。通过`$page_id`在附加之前强制转换为 int，您可以确保它不会是某种注入攻击。这不是一个很好的方法，但它会起作用。

类似的东西`mysqli_real_escape_string()`是应该考虑的替代方案，尤其是对于更一般的消毒。

或者：

```
$q = sprintf("SELECT *
              FROM yourtablename
              WHERE `page-id` = %d
              ORDER BY `link-id", $page_id); 
```

我更喜欢哪个。

* * *

**编辑**回复：现在呢？

首先，让我们不要使用 mysqli，让我们使用[PDO](http://php.net/manual/en/book.pdo.php)。

其次，我们不想在每次调用函数时都连接到数据库，我们只想这样做一次。所以把它移出函数。

```
// Typically this line is in another file and included once, but for now lets just
//  get this out of the function
$db = new PDO('mysql:host=localhost;dbname=my_db', 'root', 'root');

// Your function
function get_page_links($page_id) {
    // Build query
    $q = sprintf("SELECT *
                  FROM yourtablename
                  WHERE `page-id` = %d
                  ORDER BY `link-id`", $page_id);
    // Run Query
    foreach ($db->query($q) as $a) {
        printf('<a href="%s">%s</a>'."\n", $a['url'], $a['anchor-text']);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:39:41.570

对我来说似乎是一个相当简单的查询

```
SELECT *
    FROM `links_table`
    WHERE `page_id` = $page_id
    ORDER BY `link_id` ASC; 
```

这当然是假设`$page_id`不是来自用户输入，并且是经过安全清理的。如果没有，您应该使用准备好的语句。

阅读有关**[在 MySQLi 上执行语句](http://il.php.net/manual/en/mysqli.quickstart.statements.php)**以了解如何处理此查询生成的结果。

* * *

我不精通 MySQLi，因为我更喜欢 PDO。在 PDO 中，我会这样做：

```
<?php

/**
 * @param integer $page_id
 * @param PDO     $db
 *
 * @return array
 */
/*
 * First, we give the function the database connection object as an argument.
 * A function to get the page links shouldn't care where you got the connection from!
 */
function get_page_links($page_id, PDO $db) {
    $query = <<<MySQL
SELECT *
    FROM `links_table`
    WHERE `page_id` = :page_id
    ORDER BY `link_id` ASC;
MySQL;
    /*
     * Prepare the query and bind all values to placeholders
     */
    $stmt  = $db->prepare($query);
    $stmt->bindValue(":page_id", $page_id, PDO::PARAM_INT);

    $stmt->execute();

    /*
     * Fetch all results to an array, and return it
     */
    $result = $stmt->fetchAll(PDO::FETCH_ASSOC);
    return $result;
}

try {
    /*
     * Start new PDO connection for the function
     */
    $db = new PDO("mysql:host=localhost;dbname=database_name", "user", "password");
    //This line tells PDO to throw PDOExceptions in case of errors,
    //which are much easier to handle
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    //This lines disables PDO's default emulation for prepared statements. Adds security.
    $db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

    $links = get_page_links(1, $db);
}
catch (PDOException $e) {
    die("There has been an error with the database: " . $e->getMessage());
}

foreach ($links as $link) {
    echo "<a href='{$link["url"]}'>{$link["anchor_text"]}</a>";
} 
```

# c++ - Windows消息循环中的睡眠（）？

> ID：11065621
> 
> 赞同：1
> 
> 时间：2012-06-16T17:33:37.577
> 
> 标签：c++, winapi, sleep, message-loop

a 在典型的无限窗口消息循环中是否`Sleep(sometime)`有用，或者它只是无用甚至有害？

一些示例包含`Sleep`，其中大多数不包含。

```
 // Main message loop:
    MSG msg;
    while (GetMessage(&msg, NULL, 0, 0))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
        Sleep(500); // As pointed out below, completely nonsense
        Sleep(5); // Would have been the better example, but still bad
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:35:40.150

那个电话毫无意义。`GetMessage`等到队列中有消息，当它出现时，您的程序将不会占用 CPU。没有必要尝试做它已经做的事情。

现在关于有害，也许（*很*可能）它会！如果队列中有 1000 条消息，它将休眠 500 秒，然后才能处理所有消息。在那段时间里，您将积累超过 1000 条消息。用不了多久，您的窗户就会变得完全无用。Windows 确实收到很多消息。你会告诉我，每次鼠标在你的窗口上移动*时*，你都会等待半秒来响应？

此外，从[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644936%28v=vs.85%29.aspx)`GetMessage`中，如果出现错误，将返回 -1。由于 -1 不是 0，因此您的循环无论如何都会尝试处理该消息。更正确的方法是要么放入处理程序，要么完全退出：

```
while (GetMessage (&msg, NULL, 0, 0) > 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:36:17.997

这个`Sleep()`电话既完全无用又有害。 `GetMessage()`将已经使您的线程休眠，直到您的一个窗口准备好消息为止。添加`Sleep(500)`只会使您的窗口无响应，因为它们每秒只会处理两条消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T17:47:05.370

当您的应用程序不工作时，Windows 工作。您甚至不需要了解这方面的技术：您发布的示例代码相当于当电话响起时客户服务代表正在工作中睡觉。删除`Sleep()`.

# database - Drupal 7 数据库 API 错误“您的 SQL 语法有错误”

> ID：11065624
> 
> 赞同：0
> 
> 时间：2012-06-16T17:34:11.127
> 
> 标签：database, api, drupal-7

使用以下代码：

```
 db_update('nodesequence_nodes')
  ->fields(array(
    'order' => 1,
  ))
  ->condition('nid', 1, '=')
  ->condition('nsid', 1, '=')
  ->execute(); 
```

我收到以下错误：

> PDOException: SQLSTATE[42000]: 语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'order='1' WHERE (nid = '1') AND (nsid = '1')' 附近使用正确的语法： UPDATE {nodesequence_nodes} SET order =:db_update_placeholder_0 哪里 (nid = :db_condition_placeholder_0) AND (nsid = :db_condition_placeholder_1) ; 数组（ [:db_update_placeholder_0] => 1 [:db_condition_placeholder_0] => 1 [:db_condition_placeholder_1] => 1 ）在 nodesequence_init() （/var/www/eventbooking2/sites/all/modules/nodesequence/nodesequence.module 的第 13 行） ）。

很抱歉我不能提供更多的见解，但我希望你能。

`db_update`在我看来，简单的代码应该可以工作，但我不知道为什么不能。

数据库架构：

```
 $schema['nodesequence_nodes'] = array(
        'description' => 'Relating nodesequences to their consituent nodes.',
        'fields'     => array(
            'nsid'   => array('type' => 'int', 'unsigned' => TRUE, 'not null' => TRUE),
            'nid'    => array('type' => 'int', 'unsigned' => TRUE, 'not null' => TRUE),
            'order'  => array('type' => 'int', 'unsigned' => TRUE, 'not null' => TRUE, 'default' => 0),
        ),
        'primary key' => array('nsid', 'nid'),
    ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T19:32:47.760

您不能在表中使用名为“order”的列，因为这是保留字。您需要将其更改为其他内容。

更多信息在这里[http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)看看表 9.2

# jquery - jQuery动态改变元素高度

> ID：11065626
> 
> 赞同：9
> 
> 时间：2012-06-16T17:34:18.597
> 
> 标签：jquery, height, window-resize

我正在做一个流畅的布局项目。我的文档中有一些固定高度的 DIV，它们的高度都不同。我需要在浏览器调整大小时按比例更改这些 DIV 的高度。这是标记。

```
<body>
<div id="a" class="target"></div>
<div id="b" class="target"></div>
<div id="c" class="target"></div>
</body> 
```

和CSS：

```
<style>
    body { width: 90%; margin: 0 auto;} 
    .target { width:30%; float:left; margin:1.6%; cursor:pointer; }
    #a { height: 200px; background-color: yellow;}
    #b { height: 400px; background-color: green;}
    #c { height: 600px; background-color: grey;}
</style> 
```

听起来很容易！主要条件是我**不知道目标 DIV 及其 ID 的精确数量**，这就是我使用 .each(function()) 的原因。这是我写的脚本：

```
$(document).ready(function(){
//set the initial body width
var originalWidth = 1000; 
/*I need to go through all target divs because i don't know 
how many divs are here and what are their initial height*/
$(".target").each(function() 
{
    //get the initial height of every div
    var originalHeight = $(this).height(); 
    //get the new body width
    var bodyWidth = $("body").width(); 
    //get the difference in width, needed for hight calculation 
    var widthDiff = bodyWidth - originalWidth; 
    //new hight based on initial div height
    var newHeight = originalHeight + (widthDiff / 10); 
    //sets the different height for every needed div
    $(this).css("height", newHeight); 
}); 
```

});

当用户重新加载页面时，此脚本完美运行。当用户在不重新加载的情况下调整浏览器大小时，我怎样才能获得相同的结果？我知道我应该应用 $(window).resize 事件监听器。但问题是 DIV 的初始高度将在事件内部计算，结果将几乎像无限循环 - 即最终高度将在巨大的进程中增加或减少。我不需要那个！如何在事件函数外部进行**每个**DIV 初始高度计算，然后在事件函数内部使用这些高度？或者可能有另一种方法可以获得相同的结果？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-16T17:45:39.803

您需要存储每个 div 的原始高度。有不同的方法可以做到这一点，这里有一个技巧，将它存储在 DOM 节点本身中（有更好的方法，但这又快又脏）。

```
$(document).ready(function(){
  //set the initial body width
  var originalWidth = 1000; 
  /*I need to go through all target divs because i don't know
  how many divs are here and what are their initial height*/

  function resize() {
    //This will only set this._originalHeight once
    this._originalHeight = this._originalHeight || $(this).height();
    //get the new body width
    var bodyWidth = $("body").width(); 
    //get the difference in width, needed for hight calculation 
    var widthDiff = bodyWidth - originalWidth; 
    //new hight based on initial div height
    var newHeight = this._originalHeight + (widthDiff / 10); 
    //sets the different height for every needed div
    $(this).css("height", newHeight); 

  }

  $(".target").each(resize);
  $(document).resize(function(){
      $(".target").each(resize);
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:41:00.367

总结您的调整大小功能并订阅窗口调整大小事件。

```
$(document).ready(function(){
   //set the initial body width
   var originalWidth = 1000; 
   resizeTargets();
   $(window).resize(resizeTargets);

});

function resizeTargets()
{
   $(".target").each(function() 
   {
       //get the initial height of every div
       var originalHeight = $(this).height(); 
       //get the new body width
       var bodyWidth = $("body").width(); 
       //get the difference in width, needed for hight calculation 
       var widthDiff = bodyWidth - originalWidth; 
       //new hight based on initial div height
       var newHeight = originalHeight + (widthDiff / 10); 
       //sets the different height for every needed div
       $(this).css("height", newHeight); 
   });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:40:59.243

查看可以与 jquery 绑定的 resize 事件

[http://api.jquery.com/resize/](http://api.jquery.com/resize/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T17:46:16.823

使用 .data 将 div 的初始大小存储在 $.each 函数中

```
$(this).data('height', $(this).height());
$(this).data('width', $(this).width()); 
```

您可以稍后在调整大小回调中检索旧尺寸

```
var old_height = $(this).data('height');
var old_width = $(this).data('width'); 
```

希望这可以帮助

# google-app-engine - Google App Engine：关闭 .put() 和 .get() 竞争条件？

> ID：11065636
> 
> 赞同：2
> 
> 时间：2012-06-16T17:35:44.583
> 
> 标签：google-app-engine, google-cloud-datastore

我通过 entity.put() 将一些数据放入数据存储区，然后很快通过 .get() 从数据存储区读取数据（获取包含刚刚放置的实体的数据）。

.get() 数据是正确的，但它的顺序通常没有意义：

```
SELECT * FROM entityName
WHERE someThing = 'value'
ORDER BY votes DESC, lastTouchedTimestamp DESC 
```

将返回正确的实体（已更新以包含来自上述 .put() 的新数据），但顺序不正确（即投票和/或 lastTouchedTimestamp 实际上不按顺序排列）

GAE 很新，如果我忽略了一些简单的事情，我很抱歉。

编辑/添加：

每个实体都有一个投票整数。SELECT 应该按投票顺序返回实体，例如：10,8,7,7,1，但有时会返回 10,7,8,7,1。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-17T15:58:46.670

您所描述的在 App Engine 术语中*不是*.get() 调用，而是一个*query*。正确的 .get() 调用指定了一个键并且不受这场比赛的影响。（也不是祖先查询。）有关此主题的更多背景信息，请阅读[https://developers.google.com/appengine/docs/python/datastore/overview#Datastore_Writes_and_Data_Visibility](https://developers.google.com/appengine/docs/python/datastore/overview#Datastore_Writes_and_Data_Visibility)

你很幸运，你在查询结果中得到了更新的实体——那是因为在你的 .put() 调用之前存在的实体仍然与查询匹配。您在实体中获得了正确的值，因为查询结果（@tesdal 提到的投影查询除外）是通过键访问的；但是你得到了错误的排序，因为排序是从索引中获取的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T22:12:49.640

App Engine 不保证索引更新时间。

在您的示例中，这意味着索引数据为 10,7,7,7,1 但返回的结果是实际对象（已更新），因此您注意到排序已关闭，因为您希望其中一个条目为 8。

如果您使用[投影查询](https://developers.google.com/appengine/docs/python/datastore/queries#Query_Projection)，您将看到 10,7,7,7,1。

# java - java中如何知道jar文件的目录？

> ID：11065637
> 
> 赞同：1
> 
> 时间：2012-06-16T17:35:47.340
> 
> 标签：java, executable-jar, filepath, text-files

我有一个可执行的 jar 文件，我希望它能够读取和写入与 .jar 文件位于同一目录的 txt 文件的信息。我怎样才能做到这一点？如何获取可执行的 jar 文件 dir 路径。它只需要在windows平台上工作，它是一个桌面应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T00:58:49.877

Class.getProtectionDomain().getCodeSource().getLocation() will return the location of the JAR that contains the class you called it on, if it's in a JAR.

However see also Andrew Thompson's answer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:45:07.540

创建新文件不需要指定完整路径，java 默认会在当前工作目录中创建新文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T19:52:22.943

以下代码片段将为您执行此操作：

```
final File f = new File(MyClass.class.getProtectionDomain().getCodeSource().getLocation().getPath()); 
```

[替换`MyClass`为您的`main`班级]

结果`File`对象`f`表示`.jar`已执行的文件。您可以使用此对象获取文件所在的目录并使用它来构建目录路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-16T18:22:34.227

> 我有一个可执行的 jar 文件，我希望它能够读取和写入与 .jar 文件位于同一目录的 txt 文件的信息。

不要那样做！大多数操作系统制造商长期以来一直在说不要将应用程序和应用程序数据放在同一个地方。应用程序数据的最佳位置是`user.home`.

例如

```
import java.io.File;

public class QuickTest {

    public static void main(String[] args) {
        String[] pkgPath = { "com", "our", "app" };
        File f = new File(System.getProperty("user.home"));
        File subDir = f;
        for (String pkg : pkgPath) {
            subDir = new File(subDir,pkg);
        }
        System.out.println(f.getAbsoluteFile());
        System.out.println(subDir.getAbsoluteFile());
    }
} 
```

# objective-c - 多余的 UITableView 单元格

> ID：11065639
> 
> 赞同：0
> 
> 时间：2012-06-16T17:36:09.057
> 
> 标签：objective-c, ios, xcode, uitableview

我有一个自定义 UITableViewCell 似乎在我开始滚动之前多次出现在我的桌子上。似乎 dequeueReusableCellWithIdentifier 工作不正常。这是我的手机：

```
MyCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[MyCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    ... setup ...
} 
```

当我在我的 tableView 上调用 reloadRowsAtIndexPaths: 时，由于某种原因，它不会使该单元格出列，而是重新创建新单元格。然后当我向上滚动然后再次向下滚动时，有时我的第一个单元格出列，有时第二个单元格出列。MyCustomCell 基本上是一个文本字段，因此取决于哪个出队，文本每次都有不同的数据。

在我的自定义单元格中我还应该做些什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:17:28.777

您`reloadRowsAtIndexPaths:`在问题中提到，但方法实际上是`reloadRowsAtIndexPaths:withRowAnimation:`. 重新加载可以动画的事实很重要。例如，要制作动画`UITableViewRowAnimationLeft`，表格视图需要滑出旧单元格，同时滑入新单元格。新旧单元格同时出现在屏幕上，因此表格视图不能只`UITableViewCell`为两者使用相同的对象。这就是为什么“它不会使那个单元出队而是重新创建新的”。它需要一个新的，因为旧的仍然可见。

您需要确保在收到`tableView:cellForRowAtIndexPath:`消息时完全初始化单元格（无论是出队的还是新创建的）以显示请求行的数据，并且*只*显示请求行的数据。

此外，您不能保留自己的从行`indexPath`到单元格的映射，因为（在动画期间）同一行可能有两个单元格。相反，如果在任何时候您需要获取当前显示行数据的单元格，您需要通过向表格视图发送`cellForRowAtIndexPath:`消息来询问该单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:12:22.643

从您显示的代码看来，您似乎只在创建新单元格时才设置单元格的内容。由于无法知道您将从缓存中获得哪个单元格，因此您需要配置该单元格是新的还是正在重复使用的单元格。

# macos - Xcode/Interface Builder Mac 应用程序开发

> ID：11065640
> 
> 赞同：0
> 
> 时间：2012-06-16T17:36:12.193
> 
> 标签：macos, nsmenuitem

好吧，我想从下拉菜单（菜单项列表）中将一项作为链接工作，在 safari 中打开一个 url/网站 - 就是这样。当这如此简单时，为什么没有人在这里提出线索 - 我在 Xcode 中尝试了许多不同的方法，使用 Apple Xcode 示例......我想我需要一个 AppDelegate.m，拖动或链接一些部分，获取操作.. .我没能把它带到某个地方——现在我迷路了。任何建议/帮助/链接/提示将非常感谢解决这个“简单”问题......

使用 Xcode/Interface Builder 3.2.6 - 请帮助，否则我会完全发疯，发疯，我现在会崩溃我的 f...ing mac - 谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-17T10:12:44.443

如果您只是在 Xcode 中创建一个空的 Cocoa 项目并按照以下步骤操作，它应该可以工作：

首先，在 AppDelegate.h 的界面部分，输入以下行：

```
 -(IBAction)openLink:(id)sender; 
```

其次，在 AppDelegate.m 的实现部分中，输入以下行：

```
 -(IBAction)openLink:(id)sender
    {
        [[NSWorkspace sharedWorkspace] openURL:[NSURL URLWithString:@"http://www.stackoverflow.com"]];
    } 
```

第三，在您的方法和菜单项之间建立联系。在界面生成器中执行此操作。有几种方法可以做到这一点，一种简单的方法是首先单击要连接的菜单项：

![步骤1](../Images/82af20c6cda14d911badf9e379e3ae91.png)

然后前往 IB 窗口右侧的连接窗格：

![在此处输入图像描述](../Images/3bd7f348c051e59ca238cca19d8d4031.png)

单击并按住描述“选择器”旁边的小圆圈并将鼠标向左拖动。它应该如下所示：

![在此处输入图像描述](../Images/f9c8faede9f7d2854a82a18a82a0426a.png)

将鼠标向左移动，直到指针位于 IB 左侧的“AppDelegate”项上：

![在此处输入图像描述](../Images/f45871c169b47ed06836a264557fedab.png)

现在（最后一步！）会弹出一个小窗口，询问您要连接菜单项的 AppDelegate 的哪个方法。只需单击 openLink: 方法，您就完成了：

![在此处输入图像描述](../Images/71cfe1dd5ba7c42399e90f40a7366055.png)

如果您现在运行您的程序并单击已连接到 openLink: 方法的菜单项，该链接将在您的默认 Web 浏览器（不一定是 Safari）中打开。

# python - 谁能解释 list-urls.py

> ID：11065647
> 
> 赞同：0
> 
> 时间：2012-06-16T17:36:39.960
> 
> 标签：python

我正在阅读 Dive into Python，尤其是试图理解这些示例，并且我对 list-urls.py 有一些疑问。

在最后一行，它编译来自“parser.urls”的 url 列表。这些数据来自哪里？我在 URLLister 或 SGMLparser 中没有看到 urls 方法。

还创建了一个方法 start_a 但从未使用过。这是什么？

完整代码链接，下面是精简版[http://pastebin.com/EbB4micK](http://pastebin.com/EbB4micK)

```
#!/usr/bin/python
"""Extract list of URLs in a web page"""

from sgmllib import SGMLParser
import sys

class URLLister(SGMLParser):
    def reset(self):
            SGMLParser.reset(self)
            self.urls = []

    def start_a(self, attrs):
            href = [v for k, v in attrs if k=='href']
            if href:
                    self.urls.extend(href)

if __name__ == "__main__":

    link = sys.argv[1]
    try:
            usock = urllib.urlopen(link)
            parser = URLLister()
            parser.feed(usock.read())
            parser.close()
            usock.close()
            for url in parser.urls: print url 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:41:14.623

它是一个属性，在方法中绑定和变异。

```
 self.urls = [] 
```

...

```
 self.urls.extend(href) 
```

`start_a()`是 的协议的一部分[`SGMLParser`](http://docs.python.org/library/sgmllib.html#sgmllib.SGMLParser)，它`URLLister`是 的后代。

> 除了覆盖或扩展上面列出的方法外，派生类还可以定义以下形式的方法来定义特定标签的处理。输入流中的标签名称不区分大小写；方法名称中出现的标记必须小写：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:42:14.810

parser.urls 是 URLLister 中的“self.urls”。您需要研究 sgmllib.SGMLParser 的来源，以了解“提要”的内部结构以及它与 URLLister 中定义的方法的关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:43:46.123

start_a 是 SGML Parser 用来处理“a”标签的函数。[请参阅SGML Parser 文档](http://docs.python.org/library/sgmllib.html)中的函数 start_tag 。parser.urls 只是包含 url 并由 start_a 函数填充的字段。

# c++ - 基类引用 - 为其分配其他类型

> ID：11065657
> 
> 赞同：12
> 
> 时间：2012-06-16T17:38:00.497
> 
> 标签：c++, reference

下面的例子会发生什么？

```
struct B { };
struct D1 : B  { };
struct D2 : B  { };
int main()
{
    D1 d;
    D2 d2;
    B& x = d;
    x = d2;
} 
```

我知道引用没有重新分配。`x`还是指`d`，可是那又怎么能指派`d2`给`d`呢？

多一点：

```
struct B
{
    B () { x = 0; }
    int x;
    virtual void foo () { cout << "B" << endl; }
};
struct D1 : B
{
    D1 () { x = 1; }
    virtual void foo () { cout << "D1" << endl; }
};
struct D2 : B
{
    D2 () { x = 2; }
    virtual void foo () { cout << "D2" << endl; }
};

int main()
{
D1 d;
D2 d2;
B& x = d;
x.foo();   //D1
               //x.x is 1 here
x = d2;
x.foo();   //also D1
               //but x.x is 2 here
} 
```

似乎`x.x`已更新，但 vftable 没有……为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-16T17:44:14.530

`x`指的是 的基`B`类*子对象*。`d`赋值从 中`x = d2` [*切*](http://en.wikipedia.org/wiki/Object_slicing)出`B`基础子对象`d2`并将其值分配给 的子对象`d`。

这通常不是故意的。

**编辑：**

> 好像 xx 更新了，但是 vftable 没有……为什么？

这就是赋值运算符的`B::operator=`作用。C++ 中的基类完全不知道它们是基类。此外，对象的类型在其生命周期内永远无法更改。最接近的替代方案是 C++11 `std::move`，它可以将 a 中的旧`B`对象`D1`转换为新`D2`对象。然后，您将销毁旧对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T18:01:31.807

如果需要，您可以自己实现 = 并通过检查适当的具体类型（或给出错误）“避免”切片。请参阅下面的错误示例。

```
struct B { 
  virtual B& operator = (B& b) = 0;
};
struct D1 : B  { 
  D1& operator = (B& b) {
    if ( dynamic_cast<D1*>(&b) == 0 ) {
      cerr << "Cannot assign non D1 to D1" << endl;
      exit(255);
    }
    // handle the assignments
    return *this;
  }
};
struct D2 : B  { 
  int c;
  D2& operator = (B& b) {
    if ( dynamic_cast<D2*>(&b) == 0 ) {
      cerr << "Cannot assign non D2 to D2" << endl;
      exit(255);
    }
    // handle the assignments
    return *this;
  }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T17:44:42.440

在您的情况下，当您以这种方式分配成员时，不属于 Base 类的成员将被切片。这意味着，在这种情况下，它就像您将一个基类对象分配给另一个一样被复制。

# sql - 如何修改 SELECT 语句中的列值

> ID：11065658
> 
> 赞同：-1
> 
> 时间：2012-06-16T17:38:00.993
> 
> 标签：sql

我有一个名为“子频道”的列，其中包含以下值：

```
gujrat channel,Delhi_channel,ROMG channel etc. 
```

我想格式化报告的值。所以值应该是这样的：

```
Gujrat,Delhi,ROMG . 
```

基本上我想从值中删除“通道”这个词。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:54:20.320

什么风格的 SQL - 在 TSQL 中，我将使用`REPLACE`并摆脱通道和 _channel。语法和链接`REPLACE`：

[替换（字符串表达式，字符串模式，字符串替换）](http://msdn.microsoft.com/en-us/library/ms186862.aspx)

```
SELECT REPLACE(REPLACE([Sub channel],'_channel',''),'channel','') FROM ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:49:16.820

尝试这个：：

```
update table as tab1 
inner join 
(Select id, REPLACE('_channel','') as new_column from table) tab2 on (tab1.id=tab2.id)
set tab1.column = tab2.new_column 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:50:17.913

在供应商的文档中查找字符串函数，并使用适当的函数。

如果您使用的是 postgresql，请到[这里](http://www.postgresql.org/docs/9.1/static/functions-string.html)选择一个满足您需求的函数。您可以使用“replace”或“regex_replace”。

这是一个使用替换的示例：

```
SELECT replace(t1.col1, 'channel', '') AS col1 FROM t1; 
```

这从名为“t1”的表中选择所有行，并选择“col1”列，并从中删除单词通道，并将列命名为“col1”（默认情况下，它将在 postgres 中命名为“replace”）。

# ruby-on-rails - 多产品类型购物车的导轨方式

> ID：11065659
> 
> 赞同：9
> 
> 时间：2012-06-16T17:38:06.480
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

我正在设计一个管理大量不同设备租用的应用程序。我想知道为应用程序设计模型的最佳方法是什么。我的软件必须管理许多不同类型的设备（具有数据类型），例如：

```
Speaker
  Make - String
  Model - String      
  Wattage - Integer
  Price - Decimal

Light
  Make - String
  Model - String      
  Wattage - Integer
  Price - Decimal

Microphone
  Make - String
  Model - String
  Use - Choice of: Instrumental, Vocal, Versatile
  Price - Decimal

Cable
  Length - Decimal
  Connector 1 - String
  Connector 2 - String
  Price - Decimal

Stand
  Type - Choice of: Microphone, Speaker
  Height - Decimal
  Boom - Boolean
  Price - Decimal 
```

我对设计的看法：

*   每种产品都有一个单独的模型，然后是购物车中的多态关联，以便它可以处理所有类型的设备。
*   一个单一的产品模型，它包含所有类型的设备的字段，以及可以在使用产品时检查的类型字段。
*   具有价格属性的产品模型，然后每种类型的产品都扩展了该模型。

但是，在轨道中处理这些不同类型产品的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T16:36:18.573

动态属性 gem 应该允许您自动执行此操作：

[https://github.com/moiristo/dynamic_attributes](https://github.com/moiristo/dynamic_attributes)

可能有更好的宝石可以满足您的需求，但这是我发现的第一个。

如果您使用 Postgres 作为数据库，那么您可以使用[hstore](http://www.postgresql.org/docs/current/static/hstore.html)。有一些宝石可以与 hstore 一起使用。如果您负担得起，请订阅 railscast 并观看有关实施 hstore的[截屏视频。](http://railscasts.com/episodes/345-hstore)

[Activerecord-postgres-hstore](https://github.com/softa/activerecord-postgres-hstore)似乎是这方面的首选。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T12:23:53.693

我个人会选择一个模型产品和另一个名为 ProductAttribute 的模型。

在此表中，您将有一`name`列和一`value`列。

这样，您就不会受到架构的限制。产品有 n `product_attributes`，动态命名。您可以在管理部分开发快捷方式，因此如果您创建麦克风产品，它将自动在链接表中创建特定属性名称。您只需要输入值。

这样，您的应用程序就完全能够销售具有任意数量属性的任何类型的产品。当经理在 3 个月内想要添加另一种类型的产品时，无需再次编码 :)

编辑：当然，您有一个`ProductType`模型来管理您可以销售的所有不同产品类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T18:41:38.933

另一种选择是制作产品属性表，并通过管理界面而不是低级代码构建每种产品类型。这样您就不需要更改应用程序来销售新产品。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T09:59:31.203

这是之前让很多ERP解决方案厂商头疼的问题。根据我在此类供应商处看到的情况，我向您建议的最优雅的解决方案就是这个。

您定义了 4 个模型：设备、设备类型、特征、选择。

Equipment 和 Characteristic 之间会有多对多的关系，通过 EquipmentType。Characteristic 模型有一个名为“value_type”的属性，以及您拥有的每种值类型（String、Integer、Decimal、Boolean）的一个属性。最后，特性和选择之间会有一对多的关系。

这实际上是该供应商实施的简化版本，适合您的特定要求。该供应商的实际实现实际上是在我向您展示的之上一两个抽象级别构建的，以使解决方案更通用。但这些人以过度设计事物而闻名。

HTH。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T22:02:12.503

第三种方法非常接近正确的方法。您肯定希望将项目的所有通用参数（例如商店 ID，以及正如您提到的价格）抽象到每个其他项目都将扩展的基本模型中。然后，正如您在第一个建议的解决方案中提到的那样，您将在必要时使用 :references 在其余项目类之间进行引用。

至于“类型”和“使用”，您可能最好使用与父模型的一对一关系。然后，为每个模型存储一个可能的字段类型列表（例如， for `Stand`，类似的东西`possible_uses = "Microphone, Speaker"`）。最后，在模型实例化时进行服务器端验证，以确保它是有效类型。您还可以做一些技巧，让您看到确保`Microphone`并且`Speaker`是您的代码实际使用的唯一两种可能的“用途”。

一种完全不同但更简洁的方法是执行我在第一段中提到的所有操作，但将继承继续到较低级别。具体来说，有`Microphone`extend `BaseItem`，给出and参数`Microphone`，然后有 models ，VersatileMicrophone Microphone` 类。这将是最干净的，并将允许完整的功能。`Make``Model``InstrumentalMicrophone``VocalMicrophone, and``extend the`

# javascript - 身体的动态最小高度？

> ID：11065669
> 
> 赞同：1
> 
> 时间：2012-06-16T17:40:39.617
> 
> 标签：javascript, html, css

我有一个居中的固定宽度内容`div`，如果没有足够的内容（即一个小错误页面），它的高度会小于我的网络浏览器的高度。

这使得页脚位于屏幕中间，内容 div 的背景和背景不会继续到底部。只是看起来像狗屎。

**如果内容小于当前屏幕，有没有办法强制内容 div 始终填满屏幕？**

我意识到这可能必须使用 javascript，但我不太熟悉它。

编辑：如果用户重新调整窗口大小，我也希望它更新。

编辑：看起来我可以使用`window.innerWidth`,`window.innerHeight`属性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T17:43:58.070

听起来你想要的是一个粘性页脚，而不是调整身体的大小。

查看 Ryan Fait 关于如何执行此操作的精彩教程：[http ://ryanfait.com/resources/footer-stick-to-bottom-of-page/](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)

这是它的实际演示：[http ://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:44:32.047

查看 Ryan Fait 的[Sticky Footer](http://ryanfait.com/sticky-footer/)。这听起来像是您需要的，并且是在 CSS 中实现的。我已经为几个项目使用了一个变体，它只是工作。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-16T18:05:37.587

用可以用这个，

```
<style> 
        html,body{
            height:100%;
            margin:0;
        }
        #wrapper {
            min-height:80%;
        }
</style>
<div id='wrapper'>
hello
</div>
<div id='footer'>
    my footer
</div> 
```

# jquery - jquery使用递归函数更改背景颜色

> ID：11065673
> 
> 赞同：0
> 
> 时间：2012-06-16T17:41:15.047
> 
> 标签：jquery, css, background-color

我正在尝试在两种颜色之间制作 css 背景闪烁。最好的解决方案似乎是使用在类似问题上显示的递归函数：

```
(function pulse(){
        $('#my_div').delay(100).css("background-color","blue").delay(100).css("background-color","red").delay(100).fadeIn('slow',pulse);
})();​ 
```

[http://jsfiddle.net/bSWMC/223/](http://jsfiddle.net/bSWMC/223/)

我似乎无法获得背景切换颜色。这里可能有一个非常明显的答案，我是 jQuery 新手！

非常感谢您的帮助，杰里米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T17:46:59.630

我只会为每种颜色创建两个 css 类，然后使用 jquery 函数 toggleClass 并给两个 css 类命名，即

```
$(div).toggleClass('class1 class2') 
```

您可能还需要使用 setInterval 来设置运行 toggleClass 的时间。像这样的东西（[http://jsfiddle.net/Eyq5x/31/](http://jsfiddle.net/Eyq5x/31/)）

```
<div id="me" class='yellow'></div>

div
{
    height:50px;
    width:50px;
}
.yellow
{
    background-color:yellow;

}

.red
{
    background-color:red;
}
​
$(document).ready(function(){
    setInterval(
        function(){
            $('#me').toggleClass('yellow red');
        },1000);
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T17:53:45.647

`seTimeout`上面指出的另一种使用 Like @DhirajBodicherla 的潜在方法`.delay`不适用于`.css`. 由于 jQuery 返回`rgb`颜色`.toggleClass`可能是更好的方法。

```
function pulse(){
    var div = $('#my_div');
    if(div.css("background-color")=="rgb(255, 0, 0)"){
        div.css("background-color","blue");
    }else{
         div.css("background-color","red");
    }
      setTimeout(pulse,100);
}

pulse(); 
```

​现场 **[演示](http://jsfiddle.net/loktar/bSWMC/227/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T18:55:32.297

我是这样做的-> [http://jsfiddle.net/joplomacedo/bSWMC/229/](http://jsfiddle.net/joplomacedo/bSWMC/229/)

我将粘贴下面的代码：

js/jquery：

```
(function pulse() {
   $('#my_div').css('background-color', 'red');

   setTimeout(function() {
       $('#my_div').css('background-color', 'green');
   }, 2000);

   setTimeout(function() {
       $('#my_div').css('background-color', 'blue');
   }, 4000);

   setTimeout(pulse, 6000);
})(); 
```

CSS：

```
#my_div {
    height:60px;
    width:60px;
    background-color:red;
    -webkit-transition: 0.5s;
    transition: 0.5s;
}​ 
```

# c - Intel 指令的 LOCK 前缀。重点是什么？

> ID：11065675
> 
> 赞同：7
> 
> 时间：2012-06-16T17:41:35.950
> 
> 标签：c, linux, assembly, parallel-processing, intel

我阅读了英特尔手册，发现指令有一个锁定前缀，可以防止处理器同时写入相同的内存位置。我对此感到非常兴奋。我想它可以用作硬件互斥锁。所以我写了一段代码来试一试。结果相当令人沮丧。该锁不支持 MOV 或 LEA 指令。手册上说 LOCK 只支持 ADD、ADC、AND、BTC、BTR、BTS、CMPXCHG、CMPXCH8B、DEC、INC、NEG、NOT、OR、SBB、SUB、XOR、XADD 和 XCHG。更重要的是，如果 LOCK 前缀与这些指令之一一起使用并且源操作数是内存操作数，则可能会生成未定义的操作码异常 (#UD)。

我想知道为什么这么多限制，这么多限制让 LOCK 看起来毫无用处。我不能用它来保证一般的写操作没有脏数据或其他由并行引起的问题。

例如，我在 C 中编写了代码 ++(*p)。p 是指向共享内存的指针。对应的程序集如下：

```
movl    28(%esp), %eax
movl    (%eax), %eax
leal    1(%eax), %edx
movl    28(%esp), %eax
movl    %edx, (%eax) 
```

我在“movl”和“leal”之前添加了“lock”，但处理器抱怨“Invalid Instruction”。:-( 我想使写操作序列化的唯一方法是使用软件互斥锁，对吧？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-16T17:45:24.467

我当然不会说`lock`没用。`lock cmpxchg`是执行[比较和交换](http://en.wikipedia.org/wiki/Compare-and-swap)的标准方法，它是许多同步算法的基本构建块。

另请参阅[fetch-and-add](http://en.wikipedia.org/wiki/Fetch-and-add)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-16T17:45:47.710

的目的`lock`是使操作**原子**化，而不是序列化。这样CPU在操作生效之前就不能被抢占。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-17T07:28:42.577

x86 处理器以其毛茸茸的设计而闻名，它具有许多特性、许多规则，甚至还有所有这些规则的更多例外。这与家族的悠久历史有关。

当编译器或人们在使用`LOCK`时，他们总是在使用它时受到所有限制，通常是在专门引入以执行线程之间同步的数据上，而不是算法最终操作的应用程序数据。然后将线程同步协议调整为`LOCK`可以为它们做什么，而不是反之。

您似乎要寻找的一般指令类型称为[内存屏障](http://en.wikipedia.org/wiki/Memory_barrier)。事实上，x86 有几个来自这个系列的“现代”指令（MFENCE、LFENCE、SFENCE）。它们分别是全围栏、装载围栏和存储围栏。然而，它们在指令集中的重要性仅限于[SSE](http://en.wikipedia.org/wiki/Streaming_SIMD_Extensions)，因为英特尔保证对指令集传统部分的写入序列化，这就是为什么这种陈旧的架构很容易成为多线程编程目标的原因。

另请参阅[此答案](https://stackoverflow.com/questions/4232660/which-is-a-better-write-barrier-on-x86-lockaddl-or-xchgl)以获取更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-16T18:46:21.473

当在多处理器机器上，有两个并发进程正在使用相同的数据但它们不能同时修改它时，它很有用。

当其中一个进程正在修改数据时，它会在修改指令上使用锁定，这样，当第二个进程尝试修改它时，它必须等待第一个进程完成其工作，然后才能自行完成。转动。

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-26T14:13:36.333

在您提供的示例中，您可以将`lock`前缀与这样的`inc`指令一起使用（假设`p`位于 中`%eax`）：

```
lock inc (%eax) 
```

在更一般的情况下，您必须使用锁。

# stored-procedures - 授予 SQL Azure 上存储过程的执行权限

> ID：11065679
> 
> 赞同：12
> 
> 时间：2012-06-16T17:42:20.520
> 
> 标签：stored-procedures, azure, azure-sql-database

我最近在我的 SQL Azure 数据库中添加了一个存储过程。我添加了以 username1 身份登录的程序。但是，我需要允许 username2 能够执行该存储过程。据我所知，username2 无法查看/执行存储过程。但是，username1 可以。

我需要运行什么命令来允许 username2 执行我的存储过程？我相信这是 GRANT。但是，我不确定语法。有人可以给我一个例子吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-16T18:15:29.337

您拥有与使用 SQL Server 数据库相同的选项。您需要授予用户适当的权限。登录`username1`并执行以下命令：

```
GRANT EXECUTE ON Nameofyourprocedure TO username2; 
```

有关 Azure SQL 语法和限制的更多帮助，请参阅以下链接：http: [//msdn.microsoft.com/en-us/library/windowsazure/ee336226](http://msdn.microsoft.com/en-us/library/windowsazure/ee336226)

# r - qplot 刻度不对应于图中的线条

> ID：11065680
> 
> 赞同：1
> 
> 时间：2012-06-16T17:42:22.347
> 
> 标签：r, ggplot2

我有以下代码来绘制一些东西。我也展示了结果。我的问题是，我希望线条与刻度线同步。

有什么建议吗？

谢谢你的时间。

```
g <- qplot(hora, puntual, colour=part, data=x, group=part) +
geom_line() +
geom_pointrange(aes(ymin = inf, ymax = sup)) +
scale_color_manual(values=c("red", "green")) + 
scale_y_continuous(breaks=seq(1, 55, 0.5)) + 
opts(panel.background = theme_rect(fill='white', colour='gray'))
jpeg("plot.jpg", width=800, height=800)
print(g)
dev.off() 
```

追逐：这是我正在阅读的 DF（节选）

```
72000,   40.920,  44.478,
72010,   41.197,  42.212,
72020,   41.462,  41.893,
72030,   41.523,  41.759,
72045,   41.509,  41.725,
72050,   41.504,  41.719,
72055,   40.920,  44.478, 
```

第一列是 X，第二列和第三列是 jpg 样本中以红色显示的间隔。

![结果](../Images/e9b2b61e133c055a701c4d97e426cf2e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T20:39:44.660

您的示例仍远未重现。当我们要求可重复性时，我们并没有试图变得困难。请记住，您是在要求随机的陌生人抽出时间（在周末！）来帮助您。尽可能多地预先完成工作对您来说是有礼貌的。如果我可以简单地复制+粘贴一些代码并在干净的 R 会话中运行它以查看发生了什么，我更有可能将时间花在这个问题上。这就是我的意思：

创建一些可重现的数据：

```
dat <- data.frame(x = 1:10,y = sample(10,10,replace = TRUE)) 
```

那是*一条线*，使回答者的生活*变得*更加轻松。我们要求人们提供可重现示例的另一个原因是，这样做通常会导致您解决自己的问题。

在我开发这个可重现的例子的过程中，我首先制作了这个图：

```
ggplot(dat,aes(x = x,y = y)) + 
    geom_point() + 
    scale_y_continuous(breaks = seq(1,10,0.5)) 
```

![在此处输入图像描述](../Images/b07b7dcfc8c9d71f970719c75b936a51.png)

一切看起来都很好，对吧？但请注意，由于默认面板背景为灰色，因此网格线为白色。此时，您的脑海中应该响起警钟...

接下来我绘制了这个：

```
ggplot(dat,aes(x = x,y = y)) + 
    geom_point() + 
    scale_y_continuous(breaks = seq(1,10,0.5)) + 
    opts(panel.background = theme_rect(fill='white', colour='gray')) 
```

![在此处输入图像描述](../Images/df984206f8644853294d41ddefefb172.png)

请注意，“网格线”现在实际上不是网格线。它们是你`theme_rect`背景的边界。当您为 2D 对象指定颜色时会发生这种情况；边框是彩色的。

此时我意识到我们只需要重新着色网格线：

```
ggplot(dat,aes(x = x,y = y)) + 
    geom_point() + 
    scale_y_continuous(breaks = seq(1,10,0.5)) + 
    opts(panel.background = theme_rect(fill='white', colour='gray'),
         panel.grid.minor = theme_blank(),
         panel.grid.major = theme_line(colour = "grey80")) 
```

![在此处输入图像描述](../Images/b868784ecaae814f7d33bb13cac74657.png)

我已经删除了次要网格线，`theme_blank`并简单地重新着色了主要网格线。他们一直都在那里，只是被画成白色！

所以这里的教训是，制作一个可重复的例子不仅仅是我们回答者懒惰......它也有利于你！:)

# c# - 将现有 WCF 项目更改为 Azure 项目

> ID：11065682
> 
> 赞同：1
> 
> 时间：2012-06-16T17:42:30.803
> 
> 标签：c#, wcf, azure, hosting

我有一个工作的 WCF 服务。我想在 Windows Azure 上部署它。有[Host Existing WCF Service On Azure](https://stackoverflow.com/questions/10685515/host-existing-wcf-service-on-azure) 它是写的，我应该右键单击项目并选择一个选项。但我的菜单中没有这样的选项。对于哪些类型的项目，我可以通过上面提到的右键单击进行此类转换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:21:51.827

首先，您必须在 Visual Studio 2010 中检查项目类型。请确保您要部署的项目是 WCF Application 或 WebApplication 类型（托管 WCF 服务）。如果它是网站项目（托管 WCF 服务），您可以轻松地将其从 Visual Studio 中转换为 WebApplication 项目。

如果您的项目是 WCF 库，那么您必须先将其托管在 WCF 应用程序或 WebApplication 项目中，然后才能将其部署到 Windows Azure（或者甚至更好地将其直接托管在 Windows Azure WCFServiceRole 或 WebRole 项目中）。

然后您必须安装最新的 Windows Azure SDK，以便在您的开发机器上安装所有 Windows Azure 功能。您应该有“添加 Windows Azure 部署项目”选项。

要在 WCF 应用程序中托管 WCF 库，请执行以下操作（对于 Windows Azure WCFServiceRole 项目应该几乎相同）：

在 Visual Studio 2010 中，创建一个 WCF 应用程序项目并将其添加到您的解决方案中。

在这个新的 WCF 应用程序项目的解决方案视图下，通过“References->Add References->Projects”或“References->Add References->Browser”向其 DLL 添加对 WCF 库的引用。

在新项目的解决方案视图下，删除 IService1.cs，同时删除 Service1.svc 下的 Service1.svc.cs，因为我们将使用 WCF 库中的服务实现。但保留Service1.svc。

在新项目的解决方案视图下，双击Service1.svc将其打开，替换其以下标记行：

```
<%@ ServiceHost Language="C#" Debug="true" Service="WcfWebService.Service1" 
CodeBehind="Service1.svc.cs" %> 
```

和

```
<%@ ServiceHost Language="C#" Debug="true" Service="WcfServiceLibrary.Service1" %> 
```

您可能需要更改 WcfWebService、WcfServiceLibrary 和 Service1 并使用您的真实姓名才能使其正常工作。

请让我知道这是否有帮助。

# c# - 从 C# 中的结构继承的梦想

> ID：11065683
> 
> 赞同：6
> 
> 时间：2012-06-16T17:42:45.233
> 
> 标签：c#, inheritance, struct, xna, xna-4.0

在那里，我正在用 C# XNA 4.0 制作一个 2D 游戏，但又遇到了我的一个小烦恼；**矩形**。_ 对于那些使用基本碰撞的人来说，这几乎是必须的。对于几乎所有创建的游戏对象，您都需要一个矩形。然后我去改变 X，检查碰撞，或其他任何东西。在那里我开始了永无止境的战斗`objectName.Rectangle.Whatever`。为了解决这个问题，我当然提供了 objectName 类属性/方法来为我访问这些属性/方法。

那我就敢做梦了。我有宏伟的设计来制作一个基本的游戏对象类，所有可绘制的东西都将从中继承，这将允许父子关系、精确的局部坐标（浮点数），并保存纹理/精灵批次。为了完成这个，我准备从 Rectangle 继承，以使用它拥有的所有方法和属性。哎呀，每当需要一个 Rectangle 时，我都可以懒得说 objectName，而不是 objectName.Rectangle。

然后我意识到，没有机会。我一开始很沮丧，因为我非常聪明的想法被粉碎了。从那时起，我完美的小类拥有一个矩形，可以根据需要使用各种方法和属性访问它。我也借此机会让它继承自 XNA DrawableGameComponent。虽然从长远来看，这更实用，但每次我查看 draw 或 update 方法并看到对 rectangle 的调用时，我经常想知道，有没有希望做我想做的事？有没有一些我可以做的聪明的工作？或者是从一个 Rectangle 继承而来的，真的是我无法掌握的？

虽然使用 XNA 中提供的 DrawableGameComponent 类允许大多数与游戏对象相关的动作发生在类 Update() 方法中，但每次在类之外我需要引用的不是 Rectangle 的属性，而是 Rectangle 本身，我有点考虑到我的对象实际上是增强型矩形，这让我很生气。然后我又一次发现自己在问：

**有没有办法从预定义的结构继承，或者给项目留下你的印象（一种变通方法）？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-16T17:56:41.420

不继承，但您可以使用扩展方法向 Rectangle 对象添加许多“默认”功能。例如

```
 //(inside a static class)
  public static int GetSurface(this Rectangle rect){return rect.Width * rect.Height;}

  //calling
  Rectangle rect;
  var s = rect.GetSurface(); 
```

* * *

也就是说，我通常做的是封装所述结构。使用该类作为基础对象，并添加一个运算符，以便可以将其隐式转换为 Rectangle。这样它就可以传递给一个需要矩形而不进行强制转换的方法。

```
 public class MyRect //class so you can inherit from it, but you could make your own struct as well
    {
        public int X { get; set; }
        public int Y { get; set; }
        public int Width { get; set; }
        public int Height { get; set; }
        public int Right { get { return X + Width; } }
        public int Bottom{ get { return Y + Height; } }

        public static implicit operator Rectangle(MyRect rect)
        {
            return new Rectangle(rect.X, rect.Y, rect.Width, rect.Height);
        }

        public static implicit operator MyRect(Rectangle rect)
        {
            return new MyRect { X = rect.X, Y = rect.Y, Width = rect.Width, Height = rect.Height };
        }

    }       
 } 
```

现在您可以手动或从现有的矩形创建自己的矩形：

```
 MyRect rect = ARectangleVar 
```

您可以在期望 Rectangle 而不进行强制转换的遗留方法中使用它

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T17:55:01.870

这是一种可能的解决方法（将其放入`MyClass`，您所说的具有 Rectangle 属性的类）：

```
public static implicit operator Rectangle(MyClass obj)
{
    return obj.Rectangle;
} 
```

例如，这将允许您将对象传递给期望 a 的方法`Rectangle`，并且它可以工作。请注意，与真正的继承不同，存在的 Rectangle 与`MyClass`您传入的实例不同，它只是一个由值组成的结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-17T17:11:59.533

值类型从根本上与适用于类类型的继承风格不兼容，但能够以编译器识别派生之间的双向身份保持转换的方式声明“派生结构”将是有帮助的类型和原件。派生的结构需要有一个字段，称为“Base”（尽管 C# 编译器可以接受关键字`base`作为替代），其类型是被派生的结构的类型。名称与周围类型不匹配的“Base”的所有成员都将被视为封闭结构的成员。

“派生结构”将提供但目前缺乏的主要内容是：

1.  无需添加额外的语法间接层即可访问包装结构的成员的能力。例如，如果有一个从 `Point` 定义的类型的实例 `MyFancyPoint`，则可以说 `MyFancyPoint.X += 5` 而不是 `MyFancyPoint.Base.X += 5`。
2.  一次进行多个隐式或显式类型转换的能力。C# 通常只允许从 `X` 到 `Y` 的转换，除非存在直接转换，部分原因是搜索所有可能的转换序列很困难，部分原因是这样做通常会产生关于哪个转换序列的歧义应该被雇用。如果假设包装特定结构的所有类型都表示具有相互保持身份的转换的“云”，则两个派生结构 XX:X 和 YY:Y 之间的转换可以明确地视为到 X 的转换，然后是 `Y`，然后是 `YY`（如果存在 `X` 到 `Y` 的转换，这将是合法的）。
3.  将 ByRef 对一种类型的实例视为对另一种类型的实例的 ByRef 以及对一种类型的字段的 ByRef 被视为另一种中相应字段的 ByRef 的能力。

我不确定是否需要对运行时进行任何更改才能支持这些功能中的任何一个，如果人们接受盒装派生类型的项目只能作为相同的派生类型拆箱；允许将装箱版本的结构直接转换为可转换身份的派生实例的实例会有所帮助，但可能会增加复杂性。我不确定是否需要这种行为才能使泛型工作。不幸的是，我感觉许多负责做出此类决定的人真的不喜欢值类型。由于 .net 历史早期的一些设计决策（尤其是缺少“const ref”参数和一种通过`ref`)，使结构以语义正确的方式工作可能是一个挑战，我认为一些实施者宁愿以结构的问题为借口不改进 .net 对它们的处理，而不是添加可以解决问题的功能。

# node.js - 此代码如何防止 XSS 攻击？

> ID：11065687
> 
> 赞同：0
> 
> 时间：2012-06-16T17:43:16.577
> 
> 标签：node.js, xss, security

我正在使用一个验证库，它从我的 Web 应用程序的输入中删除了一些常见的 XSS 攻击。它工作正常，而且我还逃避了我渲染的所有内容以防止 XSS 攻击。

该库在 XSS 过滤过程的一部分中包含此行：

```
// Protect query string variables in URLs => 901119URL5918AMP18930PROTECT8198
str = str.replace(/\&([a-z\_0-9]+)\=([a-z\_0-9]+)/i, xss_hash() + '$1=$2'); 
```

`xss_hash`返回一串随机的字母数字字符。基本上，它需要一个带有查询字符串的 URL，并对其进行了一些修改：

```
> xss('http://example.com?something=123&somethingElse=456&foo=bar')
'http://example.com?something=123eujdfnjsdhsomethingElse=456&foo=bar' 
```

除了有一个错误（它只“保护”一个参数，而不是所有参数），在我看来，整个事情*本身就是*一个错误。

所以我的问题是：这种替代品可以抵御什么样的攻击媒介？

如果它没有真正做任何事情，我想向项目提交一个补丁，将其完全删除。如果它合法地保护图书馆的用户，我想提交一个补丁来修复现有的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:52:41.060

> `xss_hash`返回一串随机的字母数字字符。

它们绝对是随机的，还是基于可计算数据生成的？

它似乎是[Security through obscurity](http://en.wikipedia.org/wiki/Security_through_obscurity)：它试图用 's 替换所有的`&`'s，`xss_hash()`这样查询的可读性就会降低。我猜库的一部分可以撤消此操作（即`xss_hash()`，将字符串中的所有 ' 视为`&`s 用于解析目的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T19:48:36.267

The code in question "protected query string variables" by replacing the `&` separating URL parameters with a random string, before doing some other processing that would remove or otherwise mangle ampersands. As Jay Shah pointed out, there was code just below that was meant to replace the query string ampersands, but another bug was preventing it from working as intended.

# c# - 处理大型位图（最大 3GB）

> ID：11065689
> 
> 赞同：6
> 
> 时间：2012-06-16T17:43:25.750
> 
> 标签：c#, file, memory, bitmap

我正在做一些大学项目，但遇到了内存问题。我在 HDD 上加载了一个大约 1.5GB 的位图，代码如下：

```
Bitmap bmp = new Bitmap(pathToFile); 
```

问题是新创建的 Bitmap 对象使用了大约 3,5GB 的 RAM，这是我无法理解的（这真的是 BIG 包装器：E）。我需要获取像素数组，并且使用 Bitmap 类确实很有帮助（我稍后使用 LockBits() 方法，并按字节处理数组字节），但在这种情况下，它是完全阻塞的。所以这是我的问题：

有没有简单的方法来提取像素阵列而不借出额外的 2gb？

我使用 c# 只是为了提取所需的数组，然后在 c++ 中处理 - 也许我可以在 c++ 中提取所有需要的数据（但这里出现转换问题 - 我专注于 24bgr 格式）？

PS：我需要将整个位图保存在内存中，因此将其分成几部分不是解决方案。

PS2：只是为了澄清一些问题：我知道文件扩展名和文件格式之间的区别。加载的文件是未压缩的位图，每像素 3 个字节，大小约为 1.42GB（16k x 32k 像素），那么为什么 Bitmap 对象要大两倍以上呢？不会发生任何解压缩问题并转换为其他格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:48:00.470

考虑使用内存映射文件来访问您的大量数据:)。可以在此处找到一个专注于您需要的示例：http: [//visualstudiomagazine.com/articles/2010/06/23/memory-mapped-files.aspx](http://visualstudiomagazine.com/articles/2010/06/23/memory-mapped-files.aspx) 它在托管代码中，但您不妨从等效的本机代码中使用它.

如果您需要更多详细信息，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T11:52:07.610

[您可以使用此解决方案，在 C# http://www.codeproject.com/Tips/240428/Work-with-bitmap-faster-with-Csharp](http://www.codeproject.com/Tips/240428/Work-with-bitmap-faster-with-Csharp)中更快地使用位图

或者您可以使用内存映射文件

[http://visualstudiomagazine.com/articles/2010/06/23/memory-mapped-files.aspx](http://visualstudiomagazine.com/articles/2010/06/23/memory-mapped-files.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-22T00:28:32.353

您可以停止内存缓存。

代替

`Bitmap bmp = new Bitmap(pathToFile);`

利用

`var bmp = (Bitmap)Image.FromStream(sourceFileStream, false, false);`

见[https://stackoverflow.com/a/47424918/887092](https://stackoverflow.com/a/47424918/887092)

# c++ - 包括指令搞乱程序

> ID：11065695
> 
> 赞同：-1
> 
> 时间：2012-06-16T17:44:01.487
> 
> 标签：c++, compiler-construction, include

我遇到了一种情况，我无法编译程序，因为我拆分了文件，因为我认为它太大了。一旦文件全部合并为一个，它就可以完美运行。现在我拆分了它们，编译器给了我以下错误：

```
||=== Snake_Game, Debug ===|
D:\Projects\Snake_Game\Graph_Funcs.c||In function 'snake_crashed':|
D:\Projects\Snake_Game\Graph_Funcs.c|24|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
D:\Projects\Snake_Game\Graph_Funcs.c||In function 'read_string':|
D:\Projects\Snake_Game\Graph_Funcs.c|91|warning: 'textout' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:157)|
D:\Projects\Snake_Game\Highscore.c||In function 'set_hscore':|
D:\Projects\Snake_Game\Highscore.c|30|warning: implicit declaration of function 'sort_scores'|
D:\Projects\Snake_Game\Menus.c||In function 'option_menu':|
D:\Projects\Snake_Game\Menus.c|114|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
D:\Projects\Snake_Game\Menus.c|115|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
D:\Projects\Snake_Game\Menus.c|116|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
D:\Projects\Snake_Game\Menus.c|117|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
D:\Projects\Snake_Game\Menus.c|118|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
D:\Projects\Snake_Game\GamePlay.c||In function 'game_play':|
D:\Projects\Snake_Game\GamePlay.c|59|warning: 'textprintf_centre' is deprecated (declared at c:\program files (x86)\codeblocks\mingw\bin\../lib/gcc/mingw32/4.4.1/../../../../include/allegro/alcompat.h:178)|
obj\Debug\Highscore.o||In function `check_hscore':|
D:\Projects\Snake_Game\Highscore.c|13|multiple definition of `img_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Highscore.o||In function `check_hscore':|
D:\Projects\Snake_Game\Highscore.c|14|multiple definition of `snd_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Highscore.o||In function `check_hscore':|
D:\Projects\Snake_Game\Highscore.c|14|multiple definition of `fnt_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|33|first defined here|
obj\Debug\Init_Stuff.o||In function `init_allegro':|
D:\Projects\Snake_Game\Init_Stuff.c|14|multiple definition of `img_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Init_Stuff.o||In function `init_allegro':|
D:\Projects\Snake_Game\Init_Stuff.c|14|multiple definition of `snd_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Init_Stuff.o||In function `init_allegro':|
D:\Projects\Snake_Game\Init_Stuff.c|15|multiple definition of `fnt_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|33|first defined here|
obj\Debug\Menus.o||In function `main_menu':|
D:\Projects\Snake_Game\Menus.c|13|multiple definition of `img_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Menus.o||In function `main_menu':|
D:\Projects\Snake_Game\Menus.c|13|multiple definition of `snd_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Menus.o||In function `main_menu':|
D:\Projects\Snake_Game\Menus.c|14|multiple definition of `fnt_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|33|first defined here|
obj\Debug\main.o||In function `mangled_main':|
D:\Projects\Snake_Game\main.c|12|multiple definition of `img_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\main.o||In function `mangled_main':|
D:\Projects\Snake_Game\main.c|12|multiple definition of `snd_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\main.o||In function `mangled_main':|
D:\Projects\Snake_Game\main.c|13|multiple definition of `fnt_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|33|first defined here|
obj\Debug\Algorithms.o||In function `qsort_helper_by_score':|
D:\Projects\Snake_Game\Algorithms.c|13|multiple definition of `img_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Algorithms.o||In function `qsort_helper_by_score':|
D:\Projects\Snake_Game\Algorithms.c|14|multiple definition of `snd_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\Algorithms.o||In function `qsort_helper_by_score':|
D:\Projects\Snake_Game\Algorithms.c|14|multiple definition of `fnt_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|33|first defined here|
obj\Debug\GamePlay.o||In function `game_play':|
D:\Projects\Snake_Game\GamePlay.c|13|multiple definition of `img_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\GamePlay.o||In function `game_play':|
D:\Projects\Snake_Game\GamePlay.c|13|multiple definition of `snd_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|32|first defined here|
obj\Debug\GamePlay.o||In function `game_play':|
D:\Projects\Snake_Game\GamePlay.c|13|multiple definition of `fnt_datafile'|
obj\Debug\Graph_Funcs.o:c:\program files (x86)\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\allegro\alcompat.h|33|first defined here|
ld.exe||cannot find -lalleg|
||=== Build finished: 37 errors, 9 warnings (0 minutes, 1 seconds) ===| 
```

这真让我抓狂。当我拆分它们时，我无法让它们工作。我发现它更有条理，我真的很想做。

我正在处理文件，所以你们可以检查一下。

头文件 main.h（项目中唯一的头文件。虽然每个 .c 文件我有多个头文件）：

```
/**
Snake-Game:
A remake of the mobile game from nokia(don't know what model)
Made by Patrick Farias Bassut Souza <patrickbassut@hotmail.com

File: main.h
**/

#ifndef MAIN_H
#define MAIN_H

#include <stdio.h>
#include <stdlib.h>
#include <allegro.h>
#include <string.h>
#include <time.h>
#include "Images.h"
#include "Fonts.h"
#include "Sounds.h"

#define WINDOW_TITLE "Snake Game by Patrick Bassut"
#define VIDEO_CARD    GFX_AUTODETECT_WINDOWED
#define MAX_X       800
#define MAX_Y       600
#define V_MAX_X     0
#define V_MAX_Y     0
#define COLOR_BITS  32
#define DIGI_CARD   DIGI_AUTODETECT
#define MIDI_CARD   MIDI_AUTODETECT

#define WHITE makecol(255, 255, 255)
#define BLACK makecol(0, 0, 0)
#define PINK makecol(255, 0, 255)
#define RED makecol(255, 0, 0)
#define BLUE makecol(0, 0, 255)

#define NORTH 0
#define EAST 1
#define SOUTH 2
#define WEST 3

#define LEFT_BORDER 18
#define RIGHT_BORDER 766
#define TOP_BORDER -13
#define BOTTOM_BORDER 577

#define WALL_COLLISION 0
#define ITSELF_COLLISION 1
#define FOOD_COLLISION 2

#define INIT_SPEED 200

#define START_TAILS 2

typedef enum{false, true}bool;

typedef struct _POS{
    int x;
    int y;
}Pos;

typedef struct _config{
    int resolutionx;
    int resolutiony;
    bool window_mode;
    bool changed;
    bool music;
    bool sound;
    int volume;
}tConfig;

typedef struct _snake{
    Pos pos;
    int prev_snake_pos_x[400]; // Váriavel usada para 'guardar' os rastros X da snake.
    int prev_snake_pos_y[400]; // Váriavel usada para 'guardar' os rastros Y da snake.
    int tails_number;
    int direction;
    int speed;
}tSnake;

typedef struct _game{
    tConfig cur_cfg;
    Pos possible_food[24];
    Pos food;
    int food_type;
    int points;
    float speed_food_time;
    Pos spr;
    bool is_paused;
    bool is_playing;
}tGame;

typedef struct _Score
{
  int player_score;
  char player_name[11];
}Score;

tSnake player;
tGame game;
DATAFILE *imggg_datafile = NULL;
DATAFILE *snd_datafile = NULL;
DATAFILE *fnt_datafile = NULL;
Score score_table[11];

int qsort_helper_by_score(const void *e1, const void *e2);
bool check_collision(int collision_type);
BITMAP *new_food();
inline void close_game();
void game_play();
void snake_crashed(int points);
void game_introduction();
void read_string(char *str_to, int x, int y, int size);
void fadein(BITMAP *bmp_orig, int speed, int until);
void fadeout(int speed, int until);
inline bool check_hscore(int points);
bool load_scores();
bool save_scores();
void show_hscore_list(char *name);
void set_hscore();
bool init_allegro();
bool init_game();
bool init_settings();
int main_menu();
void option_menu();
void apply_settings(tConfig new_config);

#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T17:49:18.987

看起来该文件多次`include\allegro\alcompat.h`定义相同的符号 ( `fnt_datafile`, )，无论您在何处包含它。`snd_datafile`

如果这些是全局变量，则应`extern`在标头中声明它们并在单个实现文件中定义。

如果它们是方法，则应声明它们`inline`。

它适用于只有一个文件的情况，因为这意味着只有一个翻译单元可以导出这些符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T19:24:25.287

尝试在头文件的开头添加警卫，例如`#pragma once`，因此`#included`在编译期间不会多次。

或者，您可以指定

```
#ifndef _SNAKE_GAME.H // or any label you want 
#define _SNAKE_GAME.H
//All other code of header file goes here
#endif 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-16T18:22:20.987

每个文件可能不包括他们需要的所有内容使用一个大文件，所有内容都*可以看到*所有内容。

您可能需要在每个吐出的文件中添加缺少的包含。

# c - 成功写入不会在文件上写入任何内容

> ID：11065697
> 
> 赞同：0
> 
> 时间：2012-06-16T17:44:14.373
> 
> 标签：c, linux, file, unix, system-calls

首先很抱歉，如果这是一个愚蠢的问题（当然它是），但我对 Unix 中 Syscall 的使用真的很陌生。我试图使用“write”在文件上写一些东西；它正确地创建了文件，但是上面没有写任何东西，这就是代码：

```
int main(void) {
   int fd;
   char *string = "Test";
   if(fd=open("home/user/test.txt", O_WRONLY | O_APPEND | O_CREAT)==-1){
    perror("Open failed");

   }
   printf("%d\n", strlen(string));
   printf("Wrote %d byte on the file", write(fd,string,strlen(string)));
   close(fd);
   return 0;
} 
```

我的问题在哪里？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T17:52:30.733

问题似乎出在这一行：

```
fd=open("home/user/test.txt", O_WRONLY | O_APPEND | O_CREAT)==-1 
```

相等比较运算符`==`具有更高的优先级，因此首先对其进行评估。因此，不是将文件描述符编号分配给`fd`，而是将比较结果分配给`fd`。

解决这个问题很简单，因为您可以将比较前的部分括在括号中`()`。

# java - Finalize() 清理与垃圾收集器从内存中删除对象

> ID：11065702
> 
> 赞同：3
> 
> 时间：2012-06-16T17:44:52.877
> 
> 标签：java, garbage

我正在阅读有关 finalize() 方法并且很好奇：

在 finalize 中清理对象（将它们设置为 NULL ）的任务和从内存中删除对象有什么区别？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-16T18:09:50.160

> finalize 中清理对象（将它们设置为 NULL ）的任务有什么区别

设置为**null**会删除对对象的**ONE引用。**如果**不再**存在对某个对象的引用，则允许（不需要）垃圾收集器删除该对象

> 并从内存中删除一个对象？

java中没有明确的方法来删除（销毁，删除）一个对象。垃圾收集器会在他喜欢的时候做。尤其是从删除最后一个引用到删除/销毁对象的时间是不确定的

不需要在**finalize**方法中设置对**null的引用。**当垃圾收集器调用**最终确定**对象时，它的引用无论如何都会很快消失。

在我很长的 Java 经验中，我从未编写过自己的 finalize 方法。

如果您的对象正在处理 os-resources，那么编写自己的 finalize 方法是有意义的罕见情况。但是，通常您使用标准包进行操作系统访问

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:56:18.127

将对象设置为时不会“清理”对象`null`，只是将引用设置为 null，请考虑：

```
Object a = new Object();
Object b = a;
a = null;
System.out.println(b); 
```

一旦一个对象丢失了所有引用，它将在下一次 GC 传递时被收集。Finalize 是一种在发生这种情况时被调用的方法，**您应该避免使用它**。

只是不要保留额外的引用，让 GC 完成它的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T17:47:11.940

当对象没有更多引用时，垃圾收集器会调用 finalize()。您可以覆盖它，最佳做法是在 try-catch-finally 块中使用它来释放文件等非 Java 资源。无论如何，如果您以这种方式使用它，您还应该调用 super.finalize() 以确保类层次结构最终确定。

此方法始终用于高级用途，不应在正常生产代码中使用。在使用这些资源的方法中的 finally 子句中释放您的资源。

# xml - 在 Atomineer 中修改规则

> ID：11065708
> 
> 赞同：2
> 
> 时间：2012-06-16T17:45:26.853
> 
> 标签：xml, documentation, atomineer

我在评论块中使用@remarks 和@ingroup，但是当我运行Atomineer 时，它一直将它们标记为删除，我不知道如何防止它这样做。我查看了 .XML 配置文件中的修改规则，但我显然遗漏了一些东西。

使用 Atomineer 处理之前的示例：

```
//-------------------------------------------------------------------------------------
/// @copydoc interface_Result
///          
/// @ingroup platform_implementation module_core
//------------------------------------------------------------------------------------- 
```

使用 Atomineer 处理后的示例：

```
//------------------------------------------------------------------------------------
/// @copydoc interface_Result.
///
/// ### ingroup platform_implementation module_core.
//------------------------------------------------------------------------------------ 
```

文档说：“设置您的 Doxygen 或 DocXML 模板以指示新评论格式中的‘合法’条目，以及它们应如何在新评论块中排序。任何在旧格式和新格式中具有相同标签的条目（例如 param -> param）将自动“转换”（以新样式重新格式化）。任何不被 AtomineerUtils 视为“合法”的条目都将被标记为带有###前缀的“已删除”。

任何指示或想法将不胜感激？我真的需要它停止这样做。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T20:24:09.483

（我是[Atomineer Pro 文档](http://www.atomineerutils.com/)的作者）

在 Visual Studio 中，

*   转到工具 > Atomineer > Atomineer 选项...
*   切换到“高级自定义”选项卡
*   单击**块模板 - Doxygen**按钮。

将打开一个编辑器（记事本），其中包含供您自定义的模板。

模板是基于 XML 的，它们向 Atomineer 指示：

*   哪些条目是合法的（必填或可选）。任何未提及的条目都被视为“非法”并按照您的发现删除。
*   生成/更新评论时条目的排序顺序
*   在注释块中放置额外空格（空白行）的位置
*   其他一些事情，例如是否应该为每个条目启用/禁用标点校正等

Atomineer 可以记录的每种不同类型的代码元素都有一个模板，因此您可以非常精确地控制文档的每个部分的外观，但这确实意味着您必须将新元素复制并粘贴到每个模板。

例如，这里是 Doxygen 方法注释的默认模板：

```
 <method>
        <prototype _punctuate="false" />
        <_ />
        <summary />
        <_ />
        <author _punctuate="false">%user%</author>
        <date _punctuate="false">%date%</date>
        <_ />
        <exception />
        <_ />
        <param />
        <_ />
        <returns />
        <_ />
        <sa _punctuate="false" _optional="true" />
    </method> 
```

此处的每个 XML 元素（行）都描述了注释中的一个条目。例如，XML 标记`<param/>`对应于`@param`条目在最终注释块中的放置位置。特殊元素`<_/>`用于指示应在何处插入空行。（原型是一种特殊的 doxygen，告诉它在哪里插入原型/声明@fn、@class 等）

要允许`@ingroup`并`@remarks`插入到 Atomineer 评论中，只需在您希望它出现在评论中的位置添加它们的条目，如下所示：

```
 <method>
        <prototype _punctuate="false" />
        <ingroup _optional="true" /> 
        <_ />
        <summary />
        <_ />
        <remarks _optional="true" />
        <_ />
        <author _punctuate="false">%user%</author>
        ...
    </method> 
```

您将看到我添加的示例元素中包含该属性`_optional="true"`。没有这个，Atomineer 将把条目添加到每条评论中（一个必需的条目）。如果设置为`true`，则 Atomineer 不会*添加*该条目，但如果您自己输入，Atomineer 将确保在您更新文档评论时保留它。

对于这涉及到的程度，我深表歉意，但它是一个灵活的系统，可以让每个人都得到他们想要的东西，尽管有时需要几分钟的设置。每当我有时间时，我都会编写改进的配置工具和教程，以使这个过程更容易。但是，一旦您配置了它，您应该会有很多快乐的岁月;-)

有更多关于模板的文档以及您可以在[此处](http://www.atomineerutils.com/rulesguide.php)执行的其他操作。

如果您还有其他问题，请随时在支持电子邮件中留言，该电子邮件位于 Atomineer 网站每个页面的底部。我总是很乐意提供帮助。

# android - glGenerateMipmap IMGSRV 错误

> ID：11065721
> 
> 赞同：2
> 
> 时间：2012-06-16T17:47:06.087
> 
> 标签：android, opengl-es-2.0, mipmaps

在我的应用程序中，我尝试使用纹理，但出现错误

```
:0: SGXQueueTransfer: all paths failed
:0: HardwareMipGen: Failed to generate texture mipmap levels (error=3) 
```

在我的 Galaxy Nexus 上。我的 EVO 4G 没有出现这些错误。

这是相关的加载代码。

```
private static int load(Context context, int resID) {
    Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(),
            resID);

    int[] texts = new int[1];
    GLES20.glGenTextures(1, texts, 0);
    int texID = texts[0];

    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texID);

    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,
            GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_LINEAR);
    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,
            GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR);

    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S,
            GLES20.GL_CLAMP_TO_EDGE);
    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T,
            GLES20.GL_REPEAT);

    GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0);

    return texID;
}

private static int loadWithMipmap(Context context, int resID) {
    int texID = load(context, resID);

    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,
            GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_LINEAR_MIPMAP_NEAREST);
    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,
            GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR_MIPMAP_NEAREST);

    GLES20.glGenerateMipmap(GLES20.GL_TEXTURE_2D);

    return texID;
} 
```

任何想法发生了什么以及如何解决它？

编辑：只有一张图片导致错误，它是 1024x2048 png。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T13:50:18.263

吓死人了 在 Galaxy Nexus 7 上测试。

您需要执行以下操作：

```
 GLES20.glTexParameterf(
        GLES20.GL_TEXTURE_2D,
        GLES20.GL_TEXTURE_MIN_FILTER,
    GLES20.GL_LINEAR_MIPMAP_NEAREST);
    this.context.checkError("GL_TEXTURE_MIN_FILTER");
    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,
        GLES20.GL_TEXTURE_MAG_FILTER,
    GLES20.GL_LINEAR); 
```

严格来说，我猜 GL_LINEAR_MIPMAP_NEAREST 不是有效的 MAG_FILTER。无论如何，Nexus 7 都是这么认为的。它与所做的更改完美地融合在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T21:07:40.193

我看到了这一点，一旦我将图像压缩为正方形，它就起作用了。OpenGL 不会给出错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T21:01:43.823

疯狂的猜测，因为我无法访问您提到的硬件，但是错误是否发生在*没有二维幂的*纹理上？

# c - 双重释放或损坏（输出） fclose

> ID：11065722
> 
> 赞同：1
> 
> 时间：2012-06-16T17:47:11.593
> 
> 标签：c, glibc

```
*** glibc detected *** /home/ghoshs/workspace/Simulator/Debug/Simulator: double free or corruption (out): 0x00000000017e6030 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x7e626)[0x7f34b8553626]
/lib/x86_64-linux-gnu/libc.so.6(fclose+0x155)[0x7f34b85432a5]
/home/ghoshs/workspace/Simulator/Debug/Simulator[0x40e7bf]
/home/ghoshs/workspace/Simulator/Debug/Simulator[0x40e94a]
/home/ghoshs/workspace/Simulator/Debug/Simulator[0x40e357]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xed)[0x7f34b84f676d]
/home/ghoshs/workspace/Simulator/Debug/Simulator[0x405e19]
======= Memory map: ========
00400000-0128c000 r-xp 00000000 08:06 1576650                            /home/ghoshs/workspace/Simulator/Debug/Simulator
0148b000-0148c000 r-xp 00e8b000 08:06 1576650                            /home/ghoshs/workspace/Simulator/Debug/Simulator
0148c000-014bd000 rwxp 00e8c000 08:06 1576650                            /home/ghoshs/workspace/Simulator/Debug/Simulator
014bd000-014c7000 rwxp 00000000 00:00 0 
017e6000-01807000 rwxp 00000000 00:00 0                                  [heap]
7f34b84d5000-7f34b8688000 r-xp 00000000 08:06 4849816                    /lib/x86_64-linux-gnu/libc-2.15.so
7f34b8688000-7f34b8887000 ---p 001b3000 08:06 4849816                    /lib/x86_64-linux-gnu/libc-2.15.so
7f34b8887000-7f34b888b000 r-xp 001b2000 08:06 4849816                    /lib/x86_64-linux-gnu/libc-2.15.so
7f34b888b000-7f34b888d000 rwxp 001b6000 08:06 4849816                    /lib/x86_64-linux-gnu/libc-2.15.so
7f34b888d000-7f34b8892000 rwxp 00000000 00:00 0 
7f34b8892000-7f34b88a7000 r-xp 00000000 08:06 4853364                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f34b88a7000-7f34b8aa6000 ---p 00015000 08:06 4853364                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f34b8aa6000-7f34b8aa7000 r-xp 00014000 08:06 4853364                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f34b8aa7000-7f34b8aa8000 rwxp 00015000 08:06 4853364                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f34b8aa8000-7f34b8ac0000 r-xp 00000000 08:06 4855760                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7f34b8ac0000-7f34b8cbf000 ---p 00018000 08:06 4855760                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7f34b8cbf000-7f34b8cc0000 r-xp 00017000 08:06 4855760                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7f34b8cc0000-7f34b8cc1000 rwxp 00018000 08:06 4855760                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7f34b8cc1000-7f34b8cc5000 rwxp 00000000 00:00 0 
7f34b8cc5000-7f34b8dbe000 r-xp 00000000 08:06 4849815                    /lib/x86_64-linux-gnu/libm-2.15.so
7f34b8dbe000-7f34b8fbd000 ---p 000f9000 08:06 4849815                    /lib/x86_64-linux-gnu/libm-2.15.so
7f34b8fbd000-7f34b8fbe000 r-xp 000f8000 08:06 4849815                    /lib/x86_64-linux-gnu/libm-2.15.so
7f34b8fbe000-7f34b8fbf000 rwxp 000f9000 08:06 4849815                    /lib/x86_64-linux-gnu/libm-2.15.so
7f34b8fbf000-7f34b8fe1000 r-xp 00000000 08:06 4849818                    /lib/x86_64-linux-gnu/ld-2.15.so
7f34b91bd000-7f34b91c1000 rwxp 00000000 00:00 0 
7f34b91dd000-7f34b91e1000 rwxp 00000000 00:00 0 
7f34b91e1000-7f34b91e2000 r-xp 00022000 08:06 4849818                    /lib/x86_64-linux-gnu/ld-2.15.so
7f34b91e2000-7f34b91e4000 rwxp 00023000 08:06 4849818                    /lib/x86_64-linux-gnu/ld-2.15.so
7fffc3f01000-7fffc3fab000 rwxp 00000000 00:00 0                          [stack]
7fffc3fff000-7fffc4000000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall] 
```

我正在做一个简单的 `FILE* temp_dataset = fopen(dataset_filnames,"w");` 操作，经过几次写入操作后，我正在使用一个简单的方法关闭它 `fclose(temp_dataset);` 。此时，我收到了双重免费损坏错误。在函数中，我只是生成两个随机数，它们将充当源和目标，算法将进一步使用它们在图上查找路线。但那部分完全独立于这部分代码。（抱歉，不相关的信息堆栈溢出不会让我发布问题。）

```
void generate_dataset(int number_of_src_dest,
        char dataset_filnames[],NI* network_info, int k, int network_set,int dataset_num)
{
    int i,j;

    printf("Generating Dataset for the Network Set...\n");
    sprintf(dataset_filnames,"src_dest_pair_#nodes_%d_#SDP_%d_NS_%d_DS_%d",NUMBER_OF_NODES,number_of_src_dest,network_set,dataset_num);
    printf("in file.. %s\n",dataset_filnames);
    int temp_topo[NUMBER_OF_NODES][NUMBER_OF_NODES];
    copy_2D_array(NUMBER_OF_NODES,NUMBER_OF_NODES,temp_topo,network_info->topology);
    FILE* temp_dataset = fopen(dataset_filnames,"w");
    int number_of_source_destination_generated = 0;
    int source_destination[_BIG_SIZE][2];
    for (i = 0; i < NUMBER_OF_NODES; ++i)
    {
        for (j = 0; j < NUMBER_OF_NODES; ++j)
        {

            if(i != j)
            {
                int shortestpath[NUMBER_OF_NODES];
                int dist = shortest_path(i,j,temp_topo,shortestpath);
                int paths[K][NUMBER_OF_NODES];
                initialize_two_d_array(K,NUMBER_OF_NODES,paths,-1);
                if(dist>=percentage_of(PERCENTAGE_LOWER_LIMIT,compute_optical_reach()) &&
                                        dist<=percentage_of(PERCENTAGE_UPPER_LIMIT,compute_optical_reach()))
                {
                    int paths_generated = k_shortest_path(i,j,K,
                            paths,temp_topo,compute_optical_reach());
                    if(paths_generated>=K)
                    {
                        source_destination[number_of_source_destination_generated][0] = i;
                        source_destination[number_of_source_destination_generated][1] = j;
                        number_of_source_destination_generated ++;
                    }

                }
            }
        }
    }
    if(number_of_source_destination_generated>=NUMBER_OF_SOURCE_DESTINATION)
    {
        int visited_demand[number_of_source_destination_generated];
        initialize_one_d_array(number_of_source_destination_generated,visited_demand,0);

        for (i = 0; i < NUMBER_OF_SOURCE_DESTINATION; ++i)
        {
            int next_demand = random_in_range(0,number_of_source_destination_generated);
            while(visited_demand[next_demand])
                next_demand = random_in_range(0,number_of_source_destination_generated);
            visited_demand[next_demand] = 1;
            fprintf(temp_dataset,"%d\t%d\n",source_destination[next_demand][0],source_destination[next_demand][1]);
        }
    }

    else
    {
        printf("Number of Source-Destination Pairs Generated: %d\n",number_of_source_destination_generated);
        printf("Cannot generate the required number of SD pairs\nExiting...");
        exit(1);
    }

    printf("Number of Source-Destination Pairs Generated: %d\n",number_of_source_destination_generated);
    printf("Freeing up memory and flushing all buffer...\n");
    fclose(temp_dataset);
    printf("Done Generating data-sets.\n");
} 
```

我意识到当我打开文件时，`network_info`类型`NI`(a `struct`) 中的数据被破坏了。该`network`结构有一个代表网络的二维数组。打开文件后，我看到数组中引入了垃圾值。的大小`network_info`使用 初始化`(NI*) malloc(sizeof(NI*))`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T19:58:04.590

根据我的经验，双重释放或损坏错误通常是代码中更早出现错误的症状。我注意到您有以下代码片段：

```
 int number_of_source_destination_generated = 0;
    int source_destination[NUMBER_OF_SOURCE_DESTINATION][2]; 
```

并在一个循环内：

```
source_destination[number_of_source_destination_generated][0] = i;
source_destination[number_of_source_destination_generated][1] = j;
number_of_source_destination_generated ++; 
```

您如何保证 number_of_source_destination_generated 始终小于 NUMBER_OF_SOURCE_DESTINATION？特别是你以后：

```
if(number_of_source_destination_generated>=NUMBER_OF_SOURCE_DESTINATION)
{ 
```

这是非错误产生的情况。这使我相信小写变量应该大于大写变量。因此，我相信这意味着您正在写入未分配给您想要的数组的内存。这可能会在以后引起问题，可能是您要询问的问题。如果我这样做，我的实现不会总是向我抱怨，所以如果你的实现类似，你就不能依赖编译器来捕获这些错误。

我仍然相当缺乏经验，所以对这个建议持怀疑态度（你总是应该这样做的）。

编辑：我刚刚点击了“显示更多评论”，这已经得到解决。所以，这里没有什么新鲜事。

# android - 点击更改背景

> ID：11065725
> 
> 赞同：-6
> 
> 时间：2012-06-16T17:47:22.910
> 
> 标签：android

> **可能重复：**
> [Android 按钮：设置 onClick 背景图像更改与 XML？](https://stackoverflow.com/questions/4125774/android-button-set-onclick-background-image-change-with-xml)

当你触摸屏幕改变背景时，我需要它。我有一个 flashlight.xml、FlashlightActivity 和两张图片 background1 和 bacground2。我知道告诉我并不难

我试过：

```
 public void onClick(View v) {
if (v==Button1)
Button1.setImageResource(R.drawable.background1);

else if Button1.setImageResource(R.drawable.background2);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:05:01.983

为此，您必须在一个主要线性布局内创建两个布局，并给布局宽度和高度都填充父级。默认情况下使其中一个布局不可见，并使其在另一个布局的布局单击中可见。

```
<Linearlayout android:layout_width="fill_parent" 
android:layout_height="fill_parent">

  <Linearlayout android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:id="@+id/layout2"
    android:background="@drawable/background1">
  </Linearlayout>

  <Linearlayout android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:id="@+id/layout2"
    android:background="@drawable/background2">
  </Linearlayout>
</Linearlayout> 
```

在您的布局中的活动中单击这样的句柄（不完全是），

```
// Enable Layout 2 and Disable Layout 1
  Layout1 .setVisibility(View.GONE);
  Layout2.setVisibility(View.VISIBLE); 
```

# java - 新的数组列表 (); 在 Java 中给出语法错误

> ID：11065730
> 
> 赞同：1
> 
> 时间：2012-06-16T17:48:35.700
> 
> 标签：java

我正在尝试运行以下在 StackOverflow 上标记为正确的代码：

[SO上的代码](https://stackoverflow.com/questions/1073919/how-to-convert-int-into-listinteger-in-java)

```
List<Integer> intList = new ArrayList<Integer>();
for (int index = 0; index < ints.length; index++)
{
    intList.add(ints[index]);
} 
```

当我运行代码时，我收到一个错误：令牌“;”上的语法错误，{ 预计在以 List 开头的行上的这个令牌之后

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:53:04.557

您可能已将此代码块放置在类的顶层。它必须进入一个函数：

```
class Foo {
  public static void main(String[] args) {
    int[] ints = {1, 2, 3};
    List<Integer> intList = new ArrayList<Integer>();
    for (int index = 0; index < ints.length; index++)
    {
        intList.add(ints[index]);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T17:59:45.177

试试这个

你有没有`added these below line inside a method`像这样

```
public void go(){

List<Integer> intList = new ArrayList<Integer>();

for (int index = 0; index < ints.length; index++)
{
    intList.add(ints[index]);
}

} 
```

而且，

```
if you want to add an Array into a List, do this way

List<Integer> intList = new ArrayList<Interger>(Arrays.asList(ints)); 
```

# php - 为什么两个表达式字段之间的 addCondition 不起作用？

> ID：11065732
> 
> 赞同：1
> 
> 时间：2012-06-16T17:48:58.023
> 
> 标签：php, user-interface, frameworks, atk4

我正在构建一个模型来列出当月生日的学生：但是这不返回任何记录，尽管有一些确实匹配，这不是根据来自 addExpression 的两个字段添加条件的正确方法吗? 什么是正确的方法？

```
class Model_Student_ThisMonthBirthday extends Model_Student {
  function init(){
    parent::init();

    $this->addExpression('birthdayMonth')->set("month(birthDate)");
    $this->addExpression('currentMonth')->set("month(now())");

    $this->addCondition('birthdayMonth','currentMonth');
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T08:03:55.273

第二个参数默认是一个值，所以如果你想在那里使用字段，你应该这样做：

```
$this->addCondition('birthdayMonth', $this->getElement('currentMonth')); 
```

# javascript - CKEditor 在焦点/单击上更改配置设置

> ID：11065733
> 
> 赞同：2
> 
> 时间：2012-06-16T17:49:03.967
> 
> 标签：javascript, jquery, ckeditor

当我更改页面上的一些详细信息时，我需要能够更改 CKEditor 的 filebrowserUploadUrl，因为我通过的查询字符串被我实施的自定义上传过程使用。

我正在使用 JQuery 插件。这是我的代码：

```
$('#Content').ckeditor({
    extraPlugins: 'autogrow',
    autoGrow_maxHeight: 400,
    removePlugins: 'resize'
});

$("#Content").ckeditorGet().on("instanceReady", function () {
    this.on("focus", function () {
        // Define browser Url from selected fields
        this.config.filebrowserUploadUrl = filebrowserUploadUrl: '/my-path-to-upload-script/?ID1=' + $("ID1").val() + '&ID2=' + $("#ID2").val();
    });
}); 
```

这第一次工作正常，但如果我退出对话并更改#ID1 和#ID2 的值，它会保留以前的值。调试时，filebrowserUploadUrl 设置正确，但不影响提交值。似乎配置值已缓存。

有没有办法即时更改配置值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:28:52.537

目前，我认为没有任何可能在不进行黑客攻击的情况下即时更改此 URL。

看看[http://dev.ckeditor.com/browser/CKEditor/trunk/_source/plugins/filebrowser/plugin.js#L306](http://dev.ckeditor.com/browser/CKEditor/trunk/_source/plugins/filebrowser/plugin.js#L306)

这个`element.filebrowser.url`属性被设置一次，你可以看到上面的几行将再次被重用。您可以尝试以某种方式找到此元素并重置此属性，但对这个插件的代码没有更深入的了解，我不知道如何。

第二种选择是将此行 #L284 更改为： `url = undefined;`

但是，我没有检查这是否是正确的解决方案:) 祝你好运！

顺便提一句。随时在[http://dev.ckeditor.com](http://dev.ckeditor.com)上填写问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T06:25:39.783

我通过在发生更改时重新加载编辑器来解决这个问题；我实际上浏览了浏览器插件等的源代码，但无法进行任何更改（当然，我真的不想为将来的升级进行任何更改）。

```
function setFileBrowserUrl() {
    // Remove editor instance
    $("#Content").ckeditorGet().destroy();
    // Recreate editor instance (needed to reset the file browser url)
    createEditor();
}
function createEditor() {
    $('#Content').ckeditor({
        filebrowserUploadUrl: '/my-path-to-upload-script/?ID1=' + $("ID1").val() + '&ID2=' + $("#ID2").val(),
        extraPlugins: 'autogrow',
        autoGrow_maxHeight: 400,
        removePlugins: 'resize'
    });
} 
```

然后，每次页面上的相关元素发生变化时，我都会调用 setFileBrowserUrl。不理想，但它适用于我的目的:)

# php - MySQL “一劳永逸” INSERT / UPDATE / DELETE - mysql_unbuffered_query 使用可取吗？

> ID：11065735
> 
> 赞同：3
> 
> 时间：2012-06-16T17:49:17.897
> 
> 标签：php, mysql, unbuffered-queries

我们有很多我们认为“一劳永逸”的查询。

从某种意义上说，这些只是记录插入、更新等。不那么重要的东西，以及用户看到的前端从未使用过的数据。

这听起来像是`mysql_unbuffered_query`.

这是可取的吗？

我们正在使用 innodb，所以使用类似的东西`INSERT DELAYED`是不可能的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:46:58.993

阅读[http://www.php.net/manual/en/mysqlinfo.concepts.buffering.php](http://www.php.net/manual/en/mysqlinfo.concepts.buffering.php)后：

> 在您只期望有限的结果集或需要在读取所有行之前知道返回的行数的情况下，应该使用遵循这些特征的缓冲查询。当您期望更大的结果时，应使用无缓冲模式。

似乎无缓冲查询**仅**在*select*上有用，因为更新、插入和删除没有结果集。

我没有看到使用无缓冲更新、插入和删除有任何问题，除了：

> 除非从服务器获取完整的结果集，否则不能通过同一连接发送进一步的查询。无缓冲查询也可以称为“使用结果”。

那么，**last_insert_id**和**affected_rows**是一个结果吗？我不相信，因为没有完成**mysql_fetch** * 来获取这些信息。

因此，如果您体验到使用无缓冲查询的性能改进，请使用它！

# c - C 什么时候创建变量？

> ID：11065737
> 
> 赞同：0
> 
> 时间：2012-06-16T17:49:37.387
> 
> 标签：c, debugging, variables

我正在使用 ubuntu 12.04 和 Qt Creator 2.4.1。它默认构建我的 C 代码`GCC`。

我正在调试我的程序 ( `Qt Creator (uses GDB)`)，并且已经可以看到许多将在程序的后续步骤中调用/创建的变量。在程序开始时看到所有变量是否正常？换句话说，我是否因为调试选项（`-g`）而在程序的早期看到了变量？例如，我“进入”代码并在第一步停止`int main()` [![一只忙碌的猫](../Images/f6517b64e35faab27ed8a77658f9e6b5.png)](https://i.stack.imgur.com/IweOt.png)

`char[1000] mesg;`在第 129 行执行，但是我已经可以看到它和它的内存地址。或`int tem_hopt_dist=0;`在第 230 行，但我已经看到它的值为“3”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:10:33.220

具有“静态持续时间”的变量（与`static`关键字不同，尽管`static`通常声明的变量确实具有静态持续时间）在执行模型中，由`main`调用时间“创建”。具有“自动持续时间”的变量（“在堆栈上”，正如许多人所说的那样）是在进入其范围时创建的。`malloc`通过last until 显式分配的变量`free`d （或通过 减少空间`realloc`等）。

上面的关键要点不是“*在*此时创建”，而是“*在*此时创建”。如果效率更高，编译器可以更早地自由执行此操作。对于块范围的自动持续时间变量，将它们全部集中到一个大的入口点堆栈分配中通常是最便宜的，编译器可以在最典型的情况下使用单个“减法”指令（“从堆栈指针中减去常量”）来完成现代机器。释放空间要么完全免费（“从函数返回”），要么再次只需要一条指令（“将常量添加到堆栈指针”）。

C99 的可变长度数组（“VLA”）使这有点复杂。一个 VLA 通常必须在每次进入其封闭块时分配，并在每次退出块时释放。同样，这通常相当便宜（从堆栈指针中减去一个以创建 VLA，一个添加以销毁它），但显然每块两条指令比每块零指令更昂贵。这也会稍微干扰一些编译时优化。

如果您曾经使用过非标准`alloca`函数，这通常也是通过从堆栈指针中减法来实现的，并且它可能无法与 VLA“很好地配合”，因为这种减法倾向于假定编译器已经完成了自己的“减法”从堆栈指针”恰好一次，就在函数本身开始之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T17:54:15.350

是的，这很正常。调试器不理解语言的所有范围语义，并显示数据，就好像所有变量都在其最终内存位置初始化一样，即使它们超出范围。

一些调试器比其他的更好。这是一个常见的刺激源，例如，如果您习惯将单独的索引变量全部调用`i`，并且调试器不会区分它们。

# android - 在 Spring roo 生成的代码和 Android 应用程序中共享域类

> ID：11065740
> 
> 赞同：1
> 
> 时间：2012-06-16T17:50:05.650
> 
> 标签：android, spring-roo

我正在编写一个 Web 服务，其代码是使用 Spring roo 生成的。与此同时，我还在为 Web 服务编写一个 android 客户端。

我想在这两个项目中共享域类，因为 Spring roo 代码分散在 Java 和 (.aj) 文件中，我正在寻找在 Webservice 项目和 android 项目中共享域类的最佳实践，所以我不必须在android项目中手动编写域类。

我将 Spring STS 用于 Webservice 项目和 Android 项目。

我将不胜感激在这件事上的任何帮助

谢谢

# javascript - node.js 中的通用要求

> ID：11065741
> 
> 赞同：0
> 
> 时间：2012-06-16T17:50:07.430
> 
> 标签：javascript, node.js

我目前正在开发一个小型个人多人游戏项目。我正在使用 node.js 以及 express.js、mongoose 和 socket.io。这是我的第一个 JavaScript 项目，我来自 C/C++ 背景。

问题是：某种通用要求是否可能：我的项目根目录中目前有一个模型文件夹，所有猫鼬模型都在那里，它们看起来都类似于这个：

```
function make(Schema, mongoose) {
var UserSchema = new Schema({
    name      : String
  , passwd    : String
  , is_online : Boolean
  , socket_id : Number
});
mongoose.model('User', UserSchema);
}
module.exports.make = make; 
```

如果我没记错的话，我在 stackoverflow 的某个地方找到了这种方法。现在，当我启动 node.js 应用程序时，我必须连接到数据库，然后必须调用所有 make 函数。

有没有通用的方法来做到这一点？

像这样（伪代码）：

```
models = require('./models/');
for each m in models do
{
     m.make(Schema, mongoose);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:02:29.093

我做的有点不同：

```
var UserSchema = new Schema({
    name      : String
  , passwd    : String
  , is_online : Boolean
  , socket_id : Number
});
module.exports = mongoose.model('User', UserSchema); 
```

现在我可以要求模型并立即使用它，如下所示：

```
var userModel = require('models/user');
userModel.find()//... 
```

# javascript - HTML大图性能问题

> ID：11065743
> 
> 赞同：0
> 
> 时间：2012-06-16T17:50:30.617
> 
> 标签：javascript, html, css, image

我正在尝试制作一个像这样[http://learnlakenona.com/的病态滑块](http://learnlakenona.com/)

但是我在 chrome 中遇到了主要的性能问题（似乎他们的网站甚至没有在 chrome 上运行滑块）。我通过在 div 上使用 background-image CSS 来显示图像，将它们添加为 img 标签会导致更多延迟。

我禁用了所有 javascript，并注意到我仍然会因为有一些巨大的图像坐在彼此之上而变得滞后。

这里只是坐在那里的一些图像。尝试更改面板的大小，重新绘制图像将其锁定。（有时它运行得很好，这很奇怪） [http://jsfiddle.net/LRynj/2/](http://jsfiddle.net/LRynj/2/)

有谁知道如何在这样的滑块上获得可接受的性能！？（图片需要很大）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T17:59:37.517

通过在图像编辑器中调整它们的大小或降低质量来优化您的图像资源。

您还可以在线使用免费工具：

[http://sixrevisions.com/tools/8-excellent-tools-for-optimizing-your-images/](http://sixrevisions.com/tools/8-excellent-tools-for-optimizing-your-images/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T20:35:48.740

该网站使用巨大的透明 PNG 来实现视差效果，因此：

*   您必须减少图像的总重量：如果还没有这些 PNG，您可以尝试将它们转换为 PNG-8。量化算法等在将图像减少到 256 种颜色方面做得非常好，而且质量没有太多下降。
*   您必须保持视差效果的透明度。两种类型的透明度都与 PNG-8 兼容：每个像素上的类似 GIF 的不透明/透明位透明度和类似“PNG-32”的（PNG-24 + 8 位透明度），其中每个像素具有 256 级透明度。Adobe Fireworks 尤其擅长创建这样的“PNG-8+alpha”图像；转换器也存在，但它们并不完美（取决于您的图像）。
*   加载立即可见的图像的最小部分，然后再加载 9600 像素宽（！）的其余部分，将大大减少首次查看的时间。您可以通过将图像按 1920 或 2560 像素的块切片来实现这一点，将 3 个图像的查看部分加载为背景图像，并通过仅在 DOM[准备好](http://api.jquery.com/ready/)加载所有其他部分后执行的脚本来实现。没有太多的部分，因为这意味着要下载更多的资产，但仍然不是 4MB 精灵 :) 奖励：通过将 3 张图像切片为 PNG-8，每个 PNG 将有自己的 256 色调色板，整体质量会更好（不是与 PNG-24 一样完美，但比单个 9600 像素的 PNG-8 更好，后者总共只能使用 256 种颜色。在一个 PNG 中为男士西装提供更多的灰色阴影，为球棒分子提供更多闪亮的颜色等

编辑：永远不要尝试在智能手机上加载它！我确实喜欢媒体查询并避免 UA 检测，因为它大部分时间都不需要并且永远不会完美，但这是受欢迎的情况之一（选择加载 8MB 图像）......忽略不这样做的用户没有光纤并且不会等待您的网站显示是与您的问题无关的另一个问题。

# hibernate - Hibernate HQL 映射异常的列名

> ID：11065749
> 
> 赞同：2
> 
> 时间：2012-06-16T17:51:30.067
> 
> 标签：hibernate, hql, hibernate-mapping

晚上好！

我一直在学习并部分使用休眠一段时间，但在使用 hql 连接时遇到了麻烦。

我遵循这些说明只是为了练习，看看它是如何工作的......
[http://www.java2s.com/Tutorial/Java/0350__Hibernate/HSQLJoinTwoClasses.htm](http://www.java2s.com/Tutorial/Java/0350__Hibernate/HSQLJoinTwoClasses.htm)

他基本上创建了 3 个类：供应商、产品、软件
一个供应商有很多产品 许多产品都有一个供应商

一切都很好......除了我无法理解一件阻止我在自己的代码中实现它的特定事情。这是我无法理解的部分：

```
<class name="Product">

   <id name="id" type="int">
      <generator class="increment"/>
   </id>

   <property name="name" type="string"/>
   <property name="description" type="string"/>
   <property name="price" type="double"/>

   <many-to-one name="supplier" class="Supplier" column="supplierId"/>
</class>

<class name="Supplier" >
  <id name="id" type="int">
     <generator class="increment"/>
  </id>

  <property name="name" type="string"/>
  <bag name="products" inverse="true" cascade="all,delete-orphan">
    <key column="supplierId"/>
    <one-to-many class="Product"/>
  </bag>

</class>

The query would be:
SELECT s.name, p.name, p.price 
     FROM Product p INNER JOIN p.supplier AS s"; 
```

当到处都没有定义供应商ID时，为什么他使用“supplierId”作为列值。我无法弄清楚后台发生了什么或为什么它甚至工作......

多年来，我一直在寻找解释。希望你们中的一个人有过类似的经历，可以帮助我。真的很棒。希望我不是太含糊。

祝你有美好的一天，迈克尔·卡格尔

* * *

# 解决方案

问题是我错过了数据库中实际的外键列被称为供应商ID ...

```
create table Product(
       id int, 
       name varchar,
       description varchar,
       price decimal(6,2),
       >>>> supplierid int <<<<<
) 
```

（我再也不会像那样复制和粘贴代码了..）[@carbontax 的帖子](https://stackoverflow.com/a/11072448/1177024)和[@MikkoMaunu 的帖子](https://stackoverflow.com/a/11070703/1177024)
对其余部分进行了很好的解释

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T15:23:04.357

你说这`supplierId`没有定义，但它是。

当您`<many-to-one name="supplier" class="Supplier" column="supplierId"/>`在 Product 定义中编写时，您将其定义`supplierId`为 Product 类上的一个字段。

在 Supplier 类中，您告诉 Hibernate 对于`products`集合，Product 类中的外键名称是`supplierId`。

当您执行 HQL 语句时，Hibernate 会将此信息转换为“ON p.supplierId=s.id”sql 子句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-17T10:42:44.057

在

```
 <many-to-one name="supplier" class="Supplier" column="supplierId"/> 
```

列的值定义产品表中外键列的名称。外键包含供应商表的一些主键值。此列具体化数据库中产品和供应商之间的关系。如果没有这样的列，数据库中的产品和供应商之间就没有关系。然后 Bag 是这种关系的反面。

类似的案例可以从[Hibernate 文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#assoc-bidirectional-m21)中找到。

# typo3 - Typo3 - 制作 ID = X 的 Page 子页面的菜单

> ID：11065751
> 
> 赞同：1
> 
> 时间：2012-06-16T17:51:52.387
> 
> 标签：typo3, typoscript

我在 ID = 24 的 SysFolder 中有许多页面。

我怎么能用打字稿制作一个带有这个文件夹的所有直接子级的 TMENU，这样如果我以后添加新页面，它们会自动出现在这个菜单中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T08:31:37.693

使用这个答案：[如何使用选项拆分来控制typo3菜单属性？](https://stackoverflow.com/questions/10401926/how-to-use-option-split-to-control-typo3-menu-properties/10409292#10409292)

只需将 更改`special.value`为您的系统文件夹的页面 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:52:59.023

CType 站点地图可以从树或文件夹中的所有页面创建 TMENU。

# ruby-on-rails-3 - 更改表的列名后在所有单元和功能测试中出错

> ID：11065752
> 
> 赞同：2
> 
> 时间：2012-06-16T17:52:05.007
> 
> 标签：ruby-on-rails-3, activerecord, sqlite

我重命名了一个表的 3 列，突然我的所有单元和功能测试都抛出了相同的错误，即他们找不到具有旧列名的表。即使是与我修改的表无关的模型测试也会抛出同样的错误：

例子：

```
 54) Error:
test_should_show_user(UsersControllerTest):
ActiveRecord::StatementInvalid: SQLite3::SQLException: table answers has no column named id_user: INSERT INTO "a
nswers" ("id_user", "id_survey", "id_question", "answer", "created_at", "updated_at", "id") VALUES ('MyString', 
1, 1, 'MyText', '2012-06-16 17:45:56', '2012-06-16 17:45:56', 980190962) 
```

这是我在迁移中所做的更改表的操作：

```
class EditAnswersTable < ActiveRecord::Migration
  def self.up
    rename_column :answers, :id_user, :user_id
    rename_column :answers, :id_survey, :survey_id
    rename_column :answers, :id_question, :question_id
  end

  def self.down

    rename_column :answers, :user_id, :id_user
    rename_column :answers, :survey_id, :id_survey
    rename_column :answers, :question_id, :id_question

  end
end 
```

我重新启动了控制台和 Eclipse，但没有任何改变。

应用程序本身在服务器上运行良好，那么为什么每次测试都会抛出这些错误呢？

我该怎么办？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:04:12.733

检查您的灯具文件！每当我重命名列时，我通常会忘记调整我的固定装置以匹配。就像您看到的那样，这会导致每个测试都出现错误。

希望有帮助！

# paypal-ipn - 处理购物车中的 txn_id 以接收 Paypal IPN

> ID：11065758
> 
> 赞同：0
> 
> 时间：2012-06-16T17:52:44.493
> 
> 标签：paypal-ipn

我的滑雪课程网站购物车的工作原理如下：

*   客户选择他们想要滑雪课程的日期。有些日期有不同的价格，例如学校假期和周末。他们提交选定的日期，事件及其详细信息临时记录在带有随机事务 ID 的 SQL 表中。
*   购物车还添加了所有选定日期的费用，并创建了一个带有价格的 Paypal Advanced Buy Now Button。
*   客户为他们选择的滑雪课程 Paypal 支付费用，Paypal 将 IPN 发送回我的 IPN 侦听器以进行验证并确认订单。

但是这有一个问题，我的 IPN 脚本只知道如何验证静态价格，并且由于每个订单都会根据选择而有不同的价格，因此我需要将收到的 IPN 与最初放置的特定订单相关联。

经过一番摸索后，我想知道是否可以将其操作为`txn_id`与上述第一步中设置的随机事务 ID 相同。这样，当 IPN 报告返回时，脚本将确切知道它指的是哪个事件，并且我可以比较该事件的详细信息（例如，支付的金额与计算的金额相比）与 IPN 报告中返回的变量。

是否可以使用 Paypal 按钮操纵`txn_id`或以其他方式发送不同的标识符，以便我可以识别付款？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:11:02.230

可以在“发票”字段中发送标识符，PayPal 将在 IPN 中发回该标识符。

# php - 在 php 中抓取安全页面 https

> ID：11065762
> 
> 赞同：3
> 
> 时间：2012-06-16T17:53:00.640
> 
> 标签：php, dom, web-crawler

我正在尝试使用 curl抓取安全页面（https），例如[google](https://www.google.co.uk/search?sugexp=chrome,mod=14&sourceid=chrome&ie=UTF-8&q=crawling%20https#hl=en&gs_nf=1&pq=site%3astackoverflow.com%20crawling%20https%20php&cp=6&gs_id=s&xhr=t&q=stackoverflow&pf=p&sclient=psy-ab&oq=stacko&aq=0&aqi=g4&aql=&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=8baefeb740f734a5&biw=1280&bih=685)

但我似乎没有从我的爬虫那里得到任何数据

**php函数**

```
function getDOM($url){
   $ch = curl_init($url);
   curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
   curl_setopt($ch, CURLOPT_RANGE, '0-100');
   $content = curl_exec($ch);
   curl_close($ch);
   echo $url."<br>";

   echo $content;

   $dom = new simple_html_dom();
   $dom->load($content);

   if($dom){
      return $dom;
   }

   return null;
}

getDOM("https://www.google.co.uk/search?sugexp=chrome,mod=14&sourceid=chrome&ie=UTF-8&q=crawling%20https#hl=en&gs_nf=1&pq=site:stackoverflow.com%20crawling%20https%20php&cp=6&gs_id=s&xhr=t&q=stackoverflow&pf=p&sclient=psy-ab&oq=stacko&aq=0&aqi=g4&aql=&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=8baefeb740f734a5&biw=1280&bih=685"); 
```

我可以做些什么来爬取 https，因为我似乎对普通页面没有这个问题

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-16T17:57:54.800

```
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); 
```

将此添加到您的代码中。这将允许任何证书通过，所以它应该适合您的使用（但通常不是一个好主意）。

# web - 书籍：Web 服务器、应用服务器的初学者指南

> ID：11065769
> 
> 赞同：3
> 
> 时间：2012-06-16T17:53:20.843
> 
> 标签：web, server-side

我想知道有用的资源/书籍，这将有助于作为初学者学习 Web 服务器、应用程序服务器和 Web 架构的基础知识。

我正在尝试了解不同的服务器如何相互交互。浏览器如何向服务器发送请求以及服务器如何发送响应。我有兴趣了解这个过程的内部流程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:10:52.457

您将需要了解包括（但不限于）TCP/IP、DNS 和 HTTP 在内的服务。您还需要至少对路由器、交换机、电缆等有基本的了解。

Mike Meyer 的 CompTIA Network+[学习指南](https://rads.stackoverflow.com/amzn/click/com/0071789227)将告诉您开始运行所需的大部分知识。该指南附有技术和协议的时间表，直至电缆标准。它最终命中 TCP/IP。

另请查看[Wiley 的网络自学指南](https://rads.stackoverflow.com/amzn/click/com/0470402385)。它在本书开头附近较少关注硬件，以便为网络本身的概念留出更多空间。

如果您想在 Web 服务器方面暂时远离书籍......好吧，只需使用这个[Google 搜索](https://www.google.com/search?rlz=1C1_____enUS424US424&sugexp=chrome,mod=7&sourceid=chrome&ie=UTF-8&q=how+to+set+up+a+web+server#hl=en&safe=off&rlz=1C1_____enUS424US424&sclient=psy-ab&q=how+to+set+up+an+apache+web+server&oq=how+to+set+up+an+apache+web+server&aq=f&aqi=g-s2g-K2&aql=&gs_l=serp.3..0i10l2j0i30l2.6320.7583.0.7702.8.8.0.0.0.1.98.482.8.8.0...0.0.KhI1-OsYXYw&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=15d75812b8b4e1a0&biw=2133&bih=1061)来使用 Apache（HTTP 服务器）安装。

# javascript - Javascript使背景图像可点击？

> ID：11065770
> 
> 赞同：1
> 
> 时间：2012-06-16T17:53:32.683
> 
> 标签：javascript, image, background, clickable

我不能使用 div，因为我使用的 CMS 不允许 html 进入主题样式（它在其编码中使用奇怪的结构）并且我发现唯一有效的是 javascript 但我不知道什么 javascript 代码将启用可点击的背景图像。

有任何想法吗？

```
<meta name="description" content="description here"> 
<script type="text/javascript"> 
    document.backgroundImage = "url('http://mydomain.com/image.jpg')";
    function callback() { 
        location.href = "http://mylink.com";
    } 
    document.addEventListener("click", callback, false);
</script> 
<script type="text/javascript"> //google analytics code </script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T17:55:22.820

这是*什么东西*的背景吧？这个*东西*必须接收点击事件处理程序。

干杯。

编辑：添加示例：

假设：

```
o.id = "OhMyCuteness";
o.style.backgroundImage = "url('...')"; 
```

然后：

```
o.addEventListener("click", callback, false); 
```

和：

```
function callback(clickEvent) {
    alert("They clicked meeeee buhuhuhu: " + clickEvent.target.id);
} 
```

Edit2：如果您的文档具有完全相同的背景，请使用文档而不是元素“o”作为`addEventListener`.

# c++ - C++：向量.erase（这个）

> ID：11065773
> 
> 赞同：1
> 
> 时间：2012-06-16T17:53:54.840
> 
> 标签：c++, vector

我有一个`std::vector`保存所有对象并在每一帧中传递给它们的对象，以便每个对象都可以访问其他对象。我的问题是对象如何从向量中删除自己？

这不起作用：

```
vector.erase(this); 
```

有没有其他解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-16T17:58:30.473

`erase`需要一个迭代器。`this`是成员函数/类定义中可用的指针。此外，`erase`需要在实例上调用`vector`-- 你不能使用`vector.erase`.

对象不能自行删除。您将需要传递一个迭代器。您可以使用`std::find`来查找对象是否存在于向量中，然后将其传递。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T17:59:06.693

您需要通过访问它的迭代器来删除元素，这可以通过 来完成`std::find`，或者如果您知道索引（不太复杂），可以通过：

```
vector.begin() + indexOfElement 
```

以便您可以删除它：

```
vector<Type>::iterator it = yourVector.begin() + index;
yourVector.erase(it); 
```

请注意，由于向量以数组格式存储其数据，**这会导致您要删除的元素之后的所有元素都向左移动（这很昂贵）**。`std::list`如果您不需要随机访问，请考虑使用 a 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T18:10:38.400

或者，您可以使用 set 并使用 set.erase(this)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-16T18:33:58.407

如前所述，您可以使用 std::find （[http://www.cplusplus.com/reference/algorithm/find/](http://www.cplusplus.com/reference/algorithm/find/)）如果我没记错的话，这需要您重载 == 运算符。

例如

```
std::vector<YourObjectType>::iterator it = find(yourVector.begin(), yourVector.end(), referenceToObject);

bool operator == (const YourObjectType* object) {return object == this; } 
```

然后你就用`yourVector.erase(it);`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-16T18:38:28.483

你可以这样做：

```
vec.erase(vec.begin() + (this - &vec.front())); 
```

如果您确定元素确实来自向量

# haskell - 如何使用管道对从文件中读取的行进行编号？

> ID：11065777
> 
> 赞同：3
> 
> 时间：2012-06-16T17:54:24.367
> 
> 标签：haskell, conduit

我是一名 Haskell 初学者，试图将我的头绕在导管库上。

我试过这样的东西，但它没有编译：

```
import Data.Conduit
import Data.Conduit.Binary as CB
import Data.ByteString.Char8 as BS

numberLine :: Monad m => Conduit BS.ByteString m BS.ByteString
numberLine = conduitState 0 push close
  where
    push lno input = return $ StateProducing (lno + 1) [BS.pack (show lno ++ BS.unpack input)]
    close state = return state

main = do
  runResourceT $ CB.sourceFile "wp.txt" $= CB.lines $= numberLine $$ CB.sinkFile "test.txt" 
```

看来，conduitState 中的状态必须与管道的输入类型属于同一类型。或者至少这是我从错误消息中理解的：

```
$ ghc --make exp.hs
[1 of 1] Compiling Main             ( exp.hs, exp.o )

exp.hs:8:27:
    Could not deduce (Num [ByteString]) arising from the literal `0'
    from the context (Monad m)
      bound by the type signature for
                 numberLine :: Monad m => Conduit ByteString m ByteString
      at exp.hs:(8,1)-(11,30)
    Possible fix:
      add (Num [ByteString]) to the context of
        the type signature for
          numberLine :: Monad m => Conduit ByteString m ByteString
      or add an instance declaration for (Num [ByteString])
    In the first argument of `conduitState', namely `0'
    In the expression: conduitState 0 push close
    In an equation for `numberLine':
        numberLine
          = conduitState 0 push close
          where
              push lno input
                = return
                  $ StateProducing (lno + 1) [pack (show lno ++ unpack input)]
              close state = return state 
```

如何使用管道来做到这一点？我想从文件中读取行并将行号附加到每一行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T18:29:22.230

是的，这是可以做到的。我更喜欢使用辅助函数，`Data.Conduit.List`并且`Data.ByteString.Char8`尽可能避免使用。我假设您的文件是 UTF-8 编码的。

```
import Data.Conduit
import Data.Conduit.Binary as CB
import Data.Conduit.List as Cl
import Data.Conduit.Text as Ct
import Data.Monoid ((<>))
import Data.Text as T

numberLine :: Monad m => Conduit Text m Text
numberLine = Cl.concatMapAccum step 0 where
  format input lno = T.pack (show lno) <> T.pack " " <> input <> T.pack "\n"
  step input lno = (lno+1, [format input lno])

main :: IO ()
main =
  runResourceT
     $ CB.sourceFile "wp.txt"
    $$ Ct.decode Ct.utf8
    =$ Ct.lines
    =$ numberLine
    =$ Ct.encode Ct.utf8
    =$ CB.sinkFile "test.txt" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T09:37:19.017

```
close state = return state 
```

这就是类型错误。您的`close`函数应该具有类型`(state -> m [output])`（根据[文档](http://hackage.haskell.org/packages/archive/conduit/0.4.2/doc/html/Data-Conduit.html#v%3aconduitState)）。在您的情况下`state = Int`（您可能希望添加类型注释以确保它选择`Int`）和`output = BS.ByteString`，因此可能只返回空列表，因为在关闭管道时，您还没有真正保存任何`ByteString`要生产的 s 或类似的东西.

```
close _ = return [] 
```

特别注意该论点的文档：

> 不需要返回状态，因为它不会再次使用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:03:09.890

[管道 3.0](http://hackage.haskell.org/package/pipes-3.0.0)的替代解决方案，尽管它确实使用字符串而不是 ByteString。在我看来，主要优势是能够使用正常状态的 monad 方法 get 和 put。另一个好处是起始行号不会隐藏在 addLineNumber(numberLine) 中，因此更容易从任何给定的行号开始。

```
import System.IO
import Data.Monoid ((<>))
import Control.Proxy
import qualified Control.Proxy.Trans.State as S

addLineNumber r = forever $ do
    n <- S.get
    line <- request r -- request line from file
    respond $ show n <> " " <> line
    S.put (n + 1) -- increments line counter

main = 
    withFile "wp.txt" ReadMode    $ \fin  ->
    withFile "test.txt" WriteMode $ \fout ->
    runProxy $ S.execStateK 1 -- start at line number at 1
             $ hGetLineS fin >-> addLineNumber >-> hPutStrLnD fout 
```

[在管道安全的公告博客文章中](http://www.haskellforall.com/2013/01/pipes-safe-10-resource-management-and.html)了解如何进行更细粒度的资源管理。.

# ruby - Rubymine - 启用行号

> ID：11065778
> 
> 赞同：38
> 
> 时间：2012-06-16T17:54:49.903
> 
> 标签：ruby, rubymine

有人知道我如何为 Ruby（以及 Ruby on Rails）项目启用行号吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-06-16T18:24:26.757

此设置位于`File`| `Settings`（`Preferences`在 Mac 上）| `Editor`| `Appearance`| **显示行号**：

![显示行号](../Images/c45e56e4ef88547a53bdb7342d98619a.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-07-12T15:15:10.850

在 Rubymine 7.1 上，使用 Mac，我在以下位置找到了它：

*   首选项 --> 编辑器 --> 常规 --> 外观

靠近顶部的是一个`Show line numbers`复选框。参见插图。

![Mac OS X 中的首选项图示](../Images/769b290104659632bd0279412f4ecc20.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T22:11:34.607

在 RubyMine 6.3 上，我使用 File->Settings...->Editor->Appearance 并选中“Show line numbers”框以启用它们。

# c++ - 创建一个函数来匹配 main 中的字符串

> ID：11065784
> 
> 赞同：0
> 
> 时间：2012-06-16T17:56:10.437
> 
> 标签：c++, string-matching

这是一项小组作业，我们的教授将项目延长了 1 周，这变得相当困难。有 50 个阶段/测试，我们只能达到第 11 阶段，然后功能失败。

这个函数在我们的 .cpp 文件中（我们肯定是这个函数导致了问题，因为当我们改变它的一部分时，它会影响我们已经通过的第 11 阶段）。

```
int segment::match(const char word[]) {
    int i;
    cout << data[0];
    data[0] == "OOP";
    cout << data[0];
    for(i=0;i<NUM_MAX;i++) {
        cout << "word = " << &word[i] << " data[i] = " << data[i];
        if(strstr(&word[i],data[i])!= NULL)
        break;
    }
       return i==NUM_MAX ? 1 : i-1; 
```

从 main.cpp （作为作业提供给我们）这就是我们想要完成的

通过测试 11...

```
Your match( ) return value ----> -1
Actual match( ) return value --> -1 
Press the ENTER key to continue... 
word = OOP data[i] = 

Failed while testing the match( ) 
function... Failed on test 12... 
Your match( ) return value ----> -1 
Actual match( ) return value --> 1 
Press the ENTER key to continue...

You passed 11/50 tests... 
Your program is 22.00% complete! 
Your program still needs some work! 
Keep at it! 
```

该函数要做的是检查“oop”，如果不存在，则以-1退出，如果存在，则应以1返回true。

我想我要问的是如何使该函数以正确的顺序返回-1和1？

如果您想访问 main.cpp 和 segement.cpp，我可以将其作为文件上传到某处，因为它们很长，我不想塞满帖子。

任何帮助表示赞赏，谢谢。

***编辑******** 这是我们拥有的完整代码 [http://jsfiddle.net/h5aKN/](http://jsfiddle.net/h5aKN/)

“html”部分包含我们构建的 segement.cpp。jscript 部分有 a2main.cpp，这是我们教授构建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:22:14.807

`data[0] == "OOP";`可能不是你想要做的。double `=`( `==`) 测试是否相等，因此在这里您要测试`data`( `data[0]`) 的第一个索引处的项目和字符串`"OOP"`是否相等。

在测试的运行中，您正在 cout'ing: `word = OOP data[i] =`，这意味着它`word[i]`可能被正确定义，但`data[i]`不是。这可以追溯到上面等价测试的用法。

如果您`data`正确设置初始化，（正确意味着正确分配内存，我不知道在哪里`data`实例化），那么测试可能会返回 -1，因为它会从`strstr()`调用中获得一个非 NULL 指针（假设这`data`是正确的type),`i`将`0`on `break`ing，三元运算符将 yield `i-1`, = `-1`。

所以修复`data`变量的初始化/赋值

如果您不限于 c 样式字符串（char 数组），我会使用 std::string 类型及其相关方法（如果您还没有，请参阅[c++ 字符串参考）。](http://www.cplusplus.com/reference/string/string/)通常更好地工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:22:54.153

如果您将单词列表传递给函数：

由于 ( `strstr(&word[i],data[i])`) 的使用表明您正在另一个字符串中寻找一个字符串。因此，您正在遍历字符串（单词）列表。

那么这看起来是错误的：

```
int segment::match(const char word[]) { 
```

在这里你传递一个字。
不可能说出它应该是什么，但猜测是：

```
int segment::match(const char* word[]) {
                   //      ^^^^^ 
```

但老实说，整个事情都是相当丑陋的 C++。如果你在写 CI 会说很好，但如果你一直在正确地写 C++，那么类型系统会让你免于所有这些问题。使用 std::string 来表示单词。

# c# - 在 C# 中重置列表

> ID：11065793
> 
> 赞同：0
> 
> 时间：2012-06-16T17:57:20.520
> 
> 标签：c#, list

以下是我用来计算列表中元素的幂集的两段代码

代码 1)

```
 public static List<List<int>> getCpower(List<int> list)
    {
        var result = new List<List<int>>();
        for (int i = 0; i < (1 << list.Count); i++)
        { 
            var sublist = new List<int>();
            for (int j = 0; j < list.Count; j++)
            {   if ((i & (1 << j)) != 0)
                {   sublist.Add(list[j]); 
                }
            }
            result.Add(sublist); 
        }

        return result;
    } 
```

代码 2)

```
public static List<List<int>> getCpower(List<int> list)
    {
        var result = new List<List<int>>();var sublist = new List<int>();
        for (int i = 0; i < (1 << list.Count); i++)
        { 
            sublist.Clear();sublist.TrimExcess();
            for (int j = 0; j < list.Count; j++)
            {   if ((i & (1 << j)) != 0)
                {   sublist.Add(list[j]); 
                }
            }
            result.Add(sublist); 
        }

        return result;
    } 
```

第一个代码使用了一个新语句，如果我尝试找出计数为 30 的列表的幂集，则会出现 OutOfMemoryException。所以为了节省内存，我使用 Clear() 和 TrimExcess() 来获取列表，就好像它是使用新语句初始化的一样在代码2中。但是这两个代码返回不同的结果。我不明白为什么会这样。请帮忙。

下面的两块是不是做同样的事情

```
 for(....)   
      {
       var sublist = new List<int>();
       for(......)
           {
            //some code
           }
      } 
```

和

```
 var sublist = new List<int>();
 for(.....)
    {
      sublist.Clear();sublist.TrimExcess();
      for(.... )
      {
      //some code 
      }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T18:01:39.283

在您的第二个代码中，您只有一个嵌套列表 - 您正在添加多个引用同一个子列表的引用，这是没有意义的。

您是否考虑过您的第一个代码空间不足的原因可能是因为您从根本上试图一次在内存中保存太多数据？

您可以考虑返回`IEnumerable<List<int>>`这样的：

```
public static IEnumerable<List<int>> getCpower(List<int> list)
{
    for (int i = 0; i < (1 << list.Count); i++)
    { 
        var sublist = new List<int>();
        for (int j = 0; j < list.Count; j++)
        {   if ((i & (1 << j)) != 0)
            {   
                sublist.Add(list[j]); 
            }
        }
        yield return sublist;
    }
} 
```

这现在将被延迟评估 - 因此您可以迭代顶级序列，但除非调用者保留列表，否则您一次只能在内存中拥有一个列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:00:55.593

在第二段代码中，您正在清除结果列表。这会改变算法的结果。您正在丢弃您的结果，因为您正在为所有迭代重用相同的列表实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T18:01:17.343

在第二个代码示例中，您只有一个`sublist`实例。每次循环时，相同的实例都会被清除并再次添加到列表中。这里有一个例子可以帮助你理解：

```
var sublist = new List<int> { 1, 2, 3 };
var result = new List<List<int>> { sublist };
//result[0] is now {1, 2, 3}
sublist.Clear();
//result[0] is now {}
result.Add(sublist);
//result[0], result[1], and sublist are the same instance 
```

# javascript - 在javascript中将值获取到动态变量中的问题

> ID：11065800
> 
> 赞同：1
> 
> 时间：2012-06-16T17:58:35.443
> 
> 标签：javascript, jquery, variables

selectedsong div 有不同的链接与不同的 rel=""... 问题是...

我正在使用它：

```
selectedBtn = $('#selectedsong a');
selectedBtn.click(function()
{
    self.selectedsong($(this).attr('rel'));
    return false;
});

selectedsong: function(number)
{
    $('#selectedsong').html('new content with new links, rel, and more...');
    selectedBtn = $('#selectedsong a'); <---- THE PROBLEM IS HERE,
} 
```

问题是，在第一次单击时它可以正常工作，但是当#selectedsong 内容发生变化时， selectedBtn = $('#selectedsong a'); 不能正常工作，因为 selectedBtn.click(function() 不起作用:'(

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:01:32.697

采用

```
$('#selectedsong').on('click','a',function(e)
{
    e.preventDefault(); // prevent default behavior of anchor click

    self.selectedsong($(this).attr('rel'));

    //return false;  dont use return false as it does more work than you need
});
selectedsong: function(number) 
{
  $('#selectedsong').html('new content with new links, rel, and more...');

} 
```

随着您的 HTML 内容发生变化，您需要使用事件委托。

阅读更多关于[.on()](http://api.jquery.com/on)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:04:07.657

我认为问题在于您更改了 html inside `#selectedsong`，并且从中删除了您的`<a>`标签，而这正是您要对其进行选择的内容，是`<a>`inside 的标签`#selectedsong`。也许您可以尝试只选择`#selectedsong`而不是锚标签？或者当你更改 html 时，更改 .html 的 html `#selectedsong a`。

# javascript - 确定从 dragenter 和 dragover 事件中拖动的内容

> ID：11065803
> 
> 赞同：80
> 
> 时间：2012-06-16T17:59:04.740
> 
> 标签：javascript, html, draggable

我正在尝试使用 HTML5 可拖动 API（尽管我意识到它[有问题](http://www.quirksmode.org/blog/archives/2009/09/the_html5_drag.html)）。到目前为止，我遇到的唯一障碍是我无法找到一种方法来确定当一个`dragover`or`dragenter`事件触发时正在拖动什么：

```
el.addEventListener('dragenter', function(e) {
  // what is the draggable element?
}); 
```

我意识到我可以假设它是触发`dragstart`事件的最后一个元素，但是......多点触控。我也尝试使用`e.dataTransfer.setData`from`dragstart`来附加唯一标识符，但显然[无法](https://developer.mozilla.org/En/DragDrop/DataTransfer#getData())从`dragover`/访问数据`dragenter`：

> 只有在 drop 事件期间发生 drop 时，此数据才可用。

那么，有什么想法吗？

**更新：**在撰写本文时，HTML5 拖放似乎没有在任何主要的移动浏览器中实现，这使得多点触控在实践中没有实际意义。但是，我想要一个保证[在 spec](http://www.whatwg.org/specs/web-apps/current-work/multipage/dnd.html)的任何实现中都能工作的解决方案，这似乎并不排除同时拖动多个元素。

我在下面发布[了一个可行的解决方案](https://stackoverflow.com/a/11089592/66226)，但这是一个丑陋的黑客。我仍然希望得到更好的答案。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2014-05-01T20:36:59.710

我想在这里添加一个非常明确的答案，以便每个路过这里的人都清楚。在其他答案中已经多次说过，但在这里，我可以说得很清楚：

# `dragover`无权查看拖动事件中的数据。

此信息仅在 DRAG_START 和 DRAG_END（下降）期间可用。

问题是它一点也不明显而且令人抓狂，直到你碰巧对规范或像这里这样的地方进行了足够深入的阅读。

解决方法：

作为一种可能的解决方法，我向 DataTransfer 对象添加了特殊键并对其进行了测试。例如，为了提高效率，我想在拖动开始时查找一些“放置目标”规则，而不是每次发生“拖动”时查找。为此，我将标识每个规则的键添加到 dataTransfer 对象上，并使用“包含”测试了这些键。

```
ev.originalEvent.dataTransfer.types.includes("allow_drop_in_non_folders") 
```

诸如此类的事情。需要明确的是，“包含”不是灵丹妙药，它本身可能会成为性能问题。请注意了解您的使用情况和场景。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-25T16:29:30.670

对我的问题的简短回答是：不[。WHATWG 规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/dnd.html)没有提供对在 、 或 事件中被拖动的元素（在规范中称为“源节点”）`dragenter`的`dragover`引用`dragleave`。

为什么不？两个原因：

[首先，正如 Jeffery 在他的评论](https://stackoverflow.com/questions/11065803/determine-what-is-being-dragged-from-dragenter-dragover-events/11125533#comment14565009_11065803)中指出的那样，WHATWG 规范基于 IE5+ 的拖放实现，该实现早于多点触控设备。（在撰写本文时，没有主要的多点触控浏览器实现 HTML 拖放。）在“单点触控”上下文中，很容易将当前拖动元素的全局引用存储在`dragstart`.

其次，HTML 拖放允许您跨多个文档拖动元素。这太棒了，但这也意味着提供对每个 、 或 事件中拖动的元素的引用是`dragenter`没有`dragover`意义`dragleave`的；您不能引用不同文档中的元素。API 的优势在于，无论拖动是源自同一个文档还是不同的文档，这些事件的工作方式都是相同的。

`dataTransfer.types`但是，除了通过（如我的[工作解决方案](https://stackoverflow.com/a/11089592/66226)答案中所述）之外，无法为所有拖动事件提供序列化信息是 API 中明显的遗漏。**我已经向 WHATWG[提交了关于拖动事件中的公共数据的提案，](http://lists.w3.org/Archives/Public/public-whatwg-archive/2012Jun/0221.html)希望您能表示支持。**

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-18T19:21:26.083

一个（非常不优雅的）解决方案是将选择器作为一种数据*类型*存储在`dataTransfer`对象中。这是一个例子：http: [//jsfiddle.net/TrevorBurnham/eKHap/](http://jsfiddle.net/TrevorBurnham/eKHap/)

这里的活动线路是

```
e.dataTransfer.setData('text/html', 'foo');
e.dataTransfer.setData('draggable', ''); 
```

然后在`dragover`and`dragenter`事件中，`e.dataTransfer.types`包含 string `'draggable'`，这是确定正在拖动哪个元素所需的 ID。（请注意，浏览器显然也需要为可识别的 MIME 类型设置数据才能`text/html`使其正常工作。在 Chrome 和 Firefox 中测试。）

这是一个丑陋，丑陋的黑客，如果有人能给我一个更好的解决方案，我会很高兴地给他们赏金。

**更新：**一个值得补充的警告是，除了不优雅之外，规范声明所有数据类型都将转换为小写 ASCII。因此请注意，涉及大写字母或 unicode 的选择器会损坏。[Jeffery 的解决方案](https://stackoverflow.com/a/11125533/66226)回避了这个问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-20T18:07:34.973

鉴于当前的规范，我认为没有任何解决方案不是“黑客”。[向 WHATWG 提出请愿](http://www.whatwg.org/mailing-list#specs)是解决此问题的一种方法 :-)

扩展“（非常不优雅的）解决方案”（[演示](http://jsfiddle.net/jefferyto/eKHap/1/)）：

*   创建当前被拖动的所有元素的全局哈希：

    ```
    var dragging = {}; 
    ```

*   在`dragstart`处理程序中，为元素分配一个拖动 ID（如果它还没有），将元素添加到全局哈希，然后将拖动 ID 添加为数据类型：

    ```
    var dragId = this.dragId;

    if (!dragId) {
        dragId = this.dragId = (Math.random() + '').replace(/\D/g, '');
    }

    dragging[dragId] = this;

    e.dataTransfer.setData('text/html', dragId);
    e.dataTransfer.setData('dnd/' + dragId, dragId); 
    ```

*   在`dragenter`处理程序中，在数据类型中找到拖动 ID，并从全局哈希中检索原始元素：

    ```
    var types = e.dataTransfer.types, l = types.length, i = 0, match, el;

    for ( ; i < l; i++) {
        match = /^dnd\/(\w+)$/.exec(types[i].toLowerCase());

        if (match) {
            el = dragging[match[1]];

            // do something with el
        }
    } 
    ```

如果您将`dragging`哈希对您自己的代码保密，第三方代码将无法找到原始元素，即使他们可以访问拖动 ID。

这假设每个元素只能拖动一次；使用多点触控，我想可以使用不同的手指多次拖动相同的元素......

* * *

**更新：**为了允许对同一元素进行多次拖动，我们可以在全局哈希中包含拖动计数：http: [//jsfiddle.net/jefferyto/eKHap/2/](http://jsfiddle.net/jefferyto/eKHap/2/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-08-02T21:14:43.623

要检查它是否是文件，请使用：

```
e.originalEvent.dataTransfer.items[0].kind 
```

要检查类型，请使用：

```
e.originalEvent.dataTransfer.items[0].type 
```

即我只想允许一个文件 jpg, png, gif, bmp

```
var items = e.originalEvent.dataTransfer.items;
var allowedTypes = ["image/jpg", "image/png", "image/gif", "image/bmp"];
if (items.length > 1 || items["0"].kind != "file" || items["0"].type == "" || allowedTypes.indexOf(items["0"].type) == -1) {
    //Type not allowed
} 
```

参考：[https ://developer.mozilla.org/it/docs/Web/API/DataTransferItem](https://developer.mozilla.org/it/docs/Web/API/DataTransferItem)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-18T18:53:38.243

您可以确定拖动开始时正在拖动的内容，并将其保存在一个变量中，以便在触发 dragover/dragenter 事件时使用：

```
var draggedElement = null;

function drag(event) {
    draggedElement = event.srcElement || event.target;
};

function dragEnter(event) {
    // use the dragged element here...
}; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-19T02:06:35.333

在这种情况下，将和`drag`复制到一个对象并将其设置为拖动元素上的 expando 属性的值。`event.x``event.y`

```
function drag(e) {
    this.draggingAt = { x: e.x, y: e.y };
} 
```

在`dragenter`and`dragleave`事件中查找其 expando 属性值与当前事件的`event.x`and匹配的元素。`event.y`

```
function dragEnter(e) {
    var draggedElement = dragging.filter(function(el) {
        return el.draggingAt.x == e.x && el.draggingAt.y == e.y;
    })[0];
} 
```

为了减少需要查看的元素数量，您可以通过将元素添加到数组或在事件中分配一个类并在`dragstart`事件中撤消它来跟踪元素`dragend`。

```
var dragging = [];
function dragStart(e) {
    e.dataTransfer.setData('text/html', '');
    dragging.push(this);
}
function dragEnd(e) {
    dragging.splice(dragging.indexOf(this), 1);
} 
```

[http://jsfiddle.net/gilly3/4bVhL/](http://jsfiddle.net/gilly3/4bVhL/)

现在，理论上这应该有效。但是，我不知道如何为触摸设备启用拖动功能，因此无法对其进行测试。此链接是移动格式的，但触摸和滑动并没有导致在我的 android 上开始拖动。 [http://fiddle.jshell.net/gilly3/4bVhL/1/show/](http://fiddle.jshell.net/gilly3/4bVhL/1/show/)

**编辑：**根据我的阅读，任何触摸设备都不支持 HTML5 可拖动。您是否能够在任何触摸设备上进行可拖动工作？如果没有，多点触控将不是问题，您可以仅将拖动的元素存储在变量中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-19T10:56:53.203

根据我在 MDN 上阅读的内容，您所做的是正确的。

MDN 列出了一些[推荐的拖动类型](https://developer.mozilla.org/En/DragDrop/Recommended_Drag_Types)，例如 text/html，但如果没有合适的，则只需使用 'text/html' 类型将 id 存储为文本，或者创建自己的类型，例如 'application/node-id'。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-06-18T18:41:37.590

~~我想你可以通过调用`e.relatedTarget` 看到它：http: [//help.dottoro.com/ljogqtqm.php](http://help.dottoro.com/ljogqtqm.php)~~

好的，我试过`e.target.previousElementSibling`了，它可以工作，有点...... [http://jsfiddle.net/Gz8Qw/4/](http://jsfiddle.net/Gz8Qw/4/)我认为它挂断了，因为事件被触发了两次。一次用于 div，一次用于文本节点（当它为文本节点触发时，它是`undefined`）。不确定这是否会让你到达你想去的地方......

# java - 为 Mac OSX 解压 Java 3D 文件

> ID：11065811
> 
> 赞同：0
> 
> 时间：2012-06-16T18:00:56.657
> 
> 标签：java, macos, zip, java-3d

我已经下载了 Java 3d-1_5_1-macosx.zip。我正在尝试解压缩文件。文件 j3d-jre.zip 是需要根据 README.txt 解压的文件。我已将文件夹移动到我的桌面，所以我从终端输入了 cd Desktop/java3d-1_5_1-macosx-2/。然后从终端我输入 unzip j3d-jre.zip 这就是我看到的。*存档：j3d-jre.zip 替换 lib/ext/j3dcore.jar？[y]es，[n]o，[A]ll，[N]one，[r]ename：*我也尝试使用右键单击并填充它。README 文件中的说明如下。

将 java3d-1_5_1-XXX.zip 下载到临时目录，例如“/tmp”

将 java3d-1_5_1-XXX.zip 解压到“/tmp”，如下：

cd /tmp 解压 java3d-1_5_1-*.zip

这将在 /tmp 中创建一个“java3d-1_5_1-XXX”子目录，可以在其中找到下载的文件。手动安装所需的文件是“j3d-jre.zip”。

将 Java 3D 1.5.1 解压缩到 JDK 的“jre”目录中。例如，如果您的 JDK 在“/usr/java/jdk1.6.0_01/jre”中，您将执行以下操作：

cd /usr/java/jdk1.6.0_01/jre 解压 /tmp/java3d-1_5_1-*/j3d-jre.zip

验证 j3dcore.jar、j3dutils.jar 和 vecmath.jar 文件是否以“/usr/java/jdk1.6.0_01/jre/lib/ext”结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:15:40.213

您不能简单地使用存档实用程序打开它（在 Mac 上右键单击文件）或下载免费程序，例如 Stuff It Expander 吗？[http://www.stufit.com/mac-expander.html#compare](http://www.stuffit.com/mac-expander.html#compare)？

据我了解，您似乎已经多次执行此步骤

> 存档：j3d-jre.zip 替换 lib/ext/j3dcore.jar？[y]es, [n]o, [A]ll, [N]one, [r]ename:

如果它给了你这些选项，那么文件必须已经解压缩并且在文件夹中，也许检查一下你是否能找到它。

> README.txt 说 j3d-jre.zip 是包含需要安装的文件的 zip 文件。这是否一定意味着该文件应该被解压缩？

我会说是的

# delphi - 如何在Delphi中一次正确释放包含各种类型的记录？

> ID：11065821
> 
> 赞同：22
> 
> 时间：2012-06-16T18:02:05.350
> 
> 标签：delphi, records

```
type
  TSomeRecord = Record
    field1: integer;
    field2: string;
    field3: boolean;
  End;
var
  SomeRecord: TSomeRecord;
  SomeRecAr: array of TSomeRecord; 
```

这是我所拥有的最基本的示例，因为我想重用`SomeRecord`（某些字段保持为空，而不释放所有内容，当我重用时，某些字段将被保留`SomeRecord`，这显然是不希望的）我正在寻找一种方法来一次释放所有字段。我开始`string[255]`使用. 我仍然缺乏了解原因的知识，但这似乎与它是动态的有关。我也在使用动态数组，所以我认为尝试任何动态都会导致泄漏。花了一天时间才弄清楚这一点。我想我通过使用on或before解决了这个问题`ZeroMemory()``string``ZeroMemory()``Finalize()``SomeRecord``SomeRecAr``ZeroMemory()`，但我不确定这是正确的方法还是只是我很愚蠢。

所以问题是：如何一次释放所有东西？是否存在一些我不知道的单一程序？

换一种说法，或者我愿意接受有关如何以不同方式实施这些记录的建议，因此我不需要在释放内容时进行复杂的尝试。我已经研究过使用它创建记录`New()`然后将其删除`Dispose()`，但我不知道调用后的变量`Dispose()`未定义而不是 nil 时意味着什么。另外，我不知道某个类型的变量（`SomeRecord: TSomeRecord`）与指向某个类型的变量（ ）之间有什么区别`SomeRecord: ^TSomeRecord`。我目前正在研究上述问题，除非有人能快速解释，否则可能需要一些时间。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-16T18:57:21.873

假设您有一个支持在记录上实现方法的 Delphi 版本，您可以像这样清除记录：

```
type
  TSomeRecord = record
    field1: integer;
    field2: string;
    field3: boolean;
    procedure Clear;
  end;

procedure TSomeRecord.Clear;
begin
  Self := Default(TSomeRecord);
end; 
```

如果您的编译器不支持`Default`，那么您可以像这样简单地做同样的事情：

```
procedure TSomeRecord.Clear;
const
  Default: TSomeRecord=();
begin
  Self := Default;
end; 
```

* * *

您可能更愿意避免在方法中改变值类型。在这种情况下，创建一个返回空记录值的函数，并将其与赋值运算符一起使用：

```
type
  TSomeRecord = record
    // fields go here
    class function Empty: TSomeRecord; static;
  end;

class function TSomeRecord.Empty: TSomeRecord;
begin
  Result := Default(TSomeRecord);
end;

....

Value := TSomeRecord.Empty; 
```

* * *

顺便说一句，我找不到`Default(TypeIdentifier)`. 有谁知道在哪里可以找到它？

* * *

至于你问题的第二部分，我认为没有理由不继续使用记录，并使用动态数组分配它们。尝试自己管理生命周期更容易出错。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-16T20:41:59.407

不要让想法过于复杂！

分配“默认值”`record`只是 CPU 功率和内存的损失。

当 a 在 a`record`中声明时`TClass`，它用零填充，因此被初始化。当它在堆栈上分配时，仅初始化引用计数变量：其他类型的变量（如整数或双精度或布尔值或枚举）处于随机状态（可能非零）。当它将在堆上分配时，`getmem`不会初始化任何东西，将用`allocmem`零填充所有内容，并且`new`只会初始化引用计数的成员（就像在堆栈初始化中一样）：在所有情况下，您应该使用堆分配的.`dispose``finalize+freemem``record`

所以关于你的确切问题，你自己的假设是正确的：在使用后重置记录内容，永远不要在没有前一个“”的情况下使用“ `fillchar`”（或“ `zeromemory`”）`finalize`。这是正确和最快的方法：

```
Finalize(aRecord);
FillChar(aRecord,sizeof(aRecord),0); 
```

再一次，它比分配默认记录要快。在任何情况下，如果您使用`Finalize`，甚至多次使用，它都不会泄漏任何内存 - 100% 退款保修！

*编辑：*查看生成的代码后`aRecord := default(TRecordType)`，代码优化得很好：实际上是`Finalize`一堆`stosd`要模拟的`FillChar`。因此，即使语法是复制/赋值（`:=`），它也不是作为复制/赋值实现的。我的错误在这里。

但是我仍然不喜欢`:=`必须使用 a 的事实，Embarcadero 应该更好地使用`record`像语法这样的方法`aRecord.Clear`，就像[DelphiWebScript 的动态数组](http://code.google.com/p/dwscript/wiki/DynamicArrays)一样。事实上，这种`:=`语法与 C# 使用的完全相同。听起来好像 Embacardero 只是到处模仿 C# 语法，却没有发现[这很奇怪](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/340786b7-730f-4f06-980f-84194c6e9533)。如果 Delphi 只是一个追随者，而不是实施者认为“它的方式”，那有什么意义呢？人们总是更喜欢原来的 C# 而不是它的祖先（Delphi 有同一个父亲）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-16T18:13:20.157

我想到的最简单的解决方案是：

```
const
  EmptySomeRecord: TSomeRecord = ();
begin
  SomeRecord := EmptySomeRecord; 
```

但是要解决您问题的所有其余部分，请采用以下定义：

```
type
  PSomeRecord = ^TSomeRecord;
  TSomeRecord = record
    Field1: Integer;
    Field2: String;
    Field3: Boolean;
  end;
  TSomeRecords = array of TSomeRecord;
  PSomeRecordList = ^TSomeRecordList;
  TSomeRecordList = array[0..MaxListSize] of TSomeRecord;    
const
  EmptySomeRecord: TSomeRecord = ();
  Count = 10;    
var
  SomeRecord: TSomeRecord;
  SomeRecords: TSomeRecords;
  I: Integer;
  P: PSomeRecord;
  List: PSomeRecordList;

procedure ClearSomeRecord(var ASomeRecord: TSomeRecord);
begin
  ASomeRecord.Field1 := 0;
  ASomeRecord.Field2 := '';
  ASomeRecord.Field3 := False;
end;

function NewSomeRecord: PSomeRecord;
begin
  New(Result);
  Result^.Field1 := 0;
  Result^.Field2 := '';
  Result^.Field3 := False;
end; 
```

然后这里有一些关于如何操作它们的多个示例：

```
begin
  // Clearing a typed variable (1):
  SomeRecord := EmptySomeRecord;

  // Clearing a typed variable (2):
  ClearSomeRecord(SomeRecord);

  // Initializing and clearing a typed array variabele:
  SetLength(SomeRecords, Count);

  // Creating a pointer variable:
  New(P);

  // Clearing a pointer variable:
  P^.Field1 := 0;
  P^.Field2 := '';
  P^.Field3 := False;

  // Creating and clearing a pointer variable:
  P := NewSomeRecord;

  // Releasing a pointer variable:
  Dispose(P);

  // Creating a pointer array variable:
  ReallocMem(List, Count * SizeOf(TSomeRecord));

  // Clearing a pointer array variable:
  for I := 0 to Count - 1 do
  begin
    Pointer(List^[I].Field2) := nil;
    List^[I].Field1 := 0;
    List^[I].Field2 := '';
    List^[I].Field3 := False;
  end;

  // Releasing a pointer array variable:
  Finalize(List^[0], Count); 
```

随意选择和/或组合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-16T19:27:10.577

`SomeRecord: TSomeRecord`,将`SomeRecord`是类型的实例/变量`TSomeRecord`。使用`SomeRecord: ^TSomeRecord`,`SomeRecord`将是指向类型的实例或变量的指针`TSomeRecord`。在最后一种情况下，`SomeRecord`将是一个类型化的指针。如果您的应用程序在例程之间传输大量数据或与外部 API 交互，建议使用类型指针。

`new()`并且`dispose()`仅与类型化指针一起使用。使用类型化的指针，编译器无法控制/了解您的应用程序正在使用这种 vars 的内存。释放类型指针使用的内存取决于您。

另一方面，当您使用普通变量时，根据使用和声明，编译器将在认为不再需要它们时释放它们使用的内存。例如：

```
function SomeStaff();
var
    NativeVariable: TSomeRecord;
    TypedPointer: ^TSomeRecord;
begin
    NaviveVariable.Field1 := 'Hello World';

    // With typed pointers, we need to manually
    // create the variable before we can use it.
    new(TypedPointer);
    TypedPointer^.Field1 := 'Hello Word';

    // Do your stuff here ...

    // ... at end, we need to manually "free"
    // the typed pointer variable. Field1 within
    // TSomerecord is also released
    Dispose(TypedPointer);

    // You don't need to do the above for NativeVariable
    // as the compiler will free it after this function
    // ends. This apply also for native arrays of TSomeRecord.
end; 
```

在上面的例子中，变量`NativeVariable`只在`SomeStaff`函数内部使用，所以编译器会在函数结束时自动释放它。这适用于几乎大多数本机变量，包括数组和记录“字段”。对象的处理方式不同，但这是另一篇文章。

# matlab - Matlab 使循环同时运行

> ID：11065825
> 
> 赞同：1
> 
> 时间：2012-06-16T18:02:54.490
> 
> 标签：matlab, user-interface, simultaneous

不幸的是，我有两个循环。这就是为什么我的代码使第一个循环运行并且只有当它完成时，它才使第二个循环运行。

但我希望 gui 同时显示数据：在 hAxes 和 loading1 中。

我怎样才能做到？

```
hFigure = figure('units','pixels','position',[300 300 424 470],'menubar','none',...
'name','start processing','numbertitle','off','resize','off');        

hAxes = axes('Parent',hFigure,'Units','pixels','Position',[0 112 424 359]); 

loading1 = uicontrol('style','text','unit','pix','position',[0 72 424 40],...
'backgroundcolor','r','fontsize',20);

%% shows the data on hAxes
for i = 5:100
    if mod(i,2) == 0
        set(hAxes,'Color','b');
    else
        set(hAxes,'Color','g');
    end
    drawnow;
end

%% shows the data on loading1
for i=1:200
    image2 = horzcat('now processing ', 'image', num2str(i), '.jpg of 200 images');
    set(loading1,'string',image2);
    drawnow;
end 
```

这段代码是彼得的：

```
 function test1

    hFigure = figure('units','pixels','position',[300 300 424 470],'menubar','none','name','start processing','numbertitle','off','resize','off'); 

    % Your other setup calls
    hAxes = axes('Parent',hFigure,'Units','pixels','Position',[0 112 424 359]); 

    loading1 = uicontrol('style','text','unit','pix','position',[0 72 424 40],'backgroundcolor','r','fontsize',20);

    c = 1;
    t = timer('TimerFcn', @color_change_fcn,'StartDelay',1.0);
    start(t);

    for i=1:200
        image2 = horzcat('now processing ', 'image', num2str(i), '.jpg of 200 images');
        set(loading1,'string',image2);
        drawnow;
    end

    function color_change_fcn
        if mod(c,2) == 0
            set(hAxes,'Color','b');
        else
            set(hAxes,'Color','g');
        end
        drawnow;
        c = c + 1;
    end
end 
```

它不起作用（不显示 hAxes）。我看到它没有使 color_change_fcn 运行（我试图在 color_change_fcn 函数的第一行写： disp('test') ，但它什么也没打印。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:48:23.190

这是你想要的吗？只需组合循环体。

```
for i=1:200
    if mod(i,2) == 0
        set(hAxes,'Color','b');
    else
        set(hAxes,'Color','g');
    end

    image2 = horzcat('now processing ', 'image', num2str(i), '.jpg of 200 images');
    set(loading1,'string',image2);
    drawnow;
end 
```

编辑：好的，在这种情况下，尝试一个计时器而不是第一个循环

```
function output = main_function

% Your other setup calls
hAxes = axes('Parent',hFigure,'Units','pixels','Position',[0 112 424 359]); 

c = 0;
t = timer('TimerFcn', @color_change_fcn, 'Period', 1.0);
start(t);

for i=1:200
    image2 = horzcat('now processing ', 'image', num2str(i), '.jpg of 200 images');
    set(loading1,'string',image2);
    drawnow;
end

function color_change_fcn
    if mod(c,2) == 0
        set(hAxes,'Color','b');
    else
        set(hAxes,'Color','g');
    end
    drawnow;
    c = c + 1;
end
end 
```

请记住，MATLAB 控制流本质上是单线程的，因此如果 MATLAB 正忙于在其他地方工作，这些回调将不会运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T06:40:11.527

这似乎与您[之前的问题有关](https://stackoverflow.com/q/11048494/97160)，您希望两个循环同时运行（至少看起来是这样）。

基于[@Peter](https://stackoverflow.com/a/11066142/97160)的回答，考虑以下工作示例：

```
function timerDemo()
    %# prepare GUI
    hFig = figure('Menubar','none', 'Resize','off');
    axes('XLim',[0 1], 'YLim',[0 1], 'Visible','off', ...
        'Units','normalized', 'Position',[0.1 0.2 0.8 0.6])
    hTxt = uicontrol('Style','text', 'FontSize',24, ...
        'Units','normalized', 'Position',[0 0.9 1 0.1]);
    hPatch = patch([0 0 1 1 0],[0 1 0 1 0],'k');

    %# colors to cycle through
    c = 1;
    clr = lines(4);

    %# create timer
    delay = 0.5;
    hTimer = timer('Period',delay, 'StartDelay',delay, ...
        'ExecutionMode','FixedRate', 'TimerFcn',@timerCallback);

    %# when figure is closed
    set(hFig, 'CloseRequestFcn',@onClose);

    %# process images
    start(hTimer);          %# start timer
    for i=1:100
        if ~ishandle(hFig), break; end

        msg = sprintf('Processing image %d / %d', i, 100);
        set(hTxt, 'String',msg)

        %# some lengthy operation
        pause(.1)
    end
    if isvalid(hTimer)
        stop(hTimer)        %# stop timer
        delete(hTimer)      %# delete timer
    end

    %# timer callback function
    function timerCallback(src,evt)
        if ~ishandle(hFig), return; end

        %# incremenet counter circularly
        c = rem(c,size(clr,1)) + 1;

        %# update color of patch
        set(hPatch, 'FaceColor',clr(c,:));
        drawnow
    end

    %# on figure close
    function onClose(src,evt)
        %# stop and delete timer
        if isvalid(hTimer)
            stop(hTimer);
            delete(hTimer);
        end

        %# call default close callback
        feval(@closereq)
    end
end 
```

该代码模拟了对多个图像运行冗长的处理步骤，同时显示动画以保持用户的娱乐性。

为了保持代码简单，我展示了一个不断更新其颜色的补丁（使用计时器）。这代表“正在加载...”的[动画 GIF 图像。](https://stackoverflow.com/q/10863014/97160)

![截屏](../Images/8b10d595d052c242d612d5a1a053dedc.png)

# javascript - 创建购物清单 Web 应用程序

> ID：11065828
> 
> 赞同：0
> 
> 时间：2012-06-16T18:03:35.840
> 
> 标签：javascript, jquery, python, django

我正在通过尝试构建一个简单的购物清单 Web 应用程序来学习 Python、Django、Javascript 和 jQuery。如果我的方法正确，我想听听经验丰富的开发人员的意见：

**功能：** 网页将显示食物列表。当我点击某种食物时，我希望显示一份配料清单（这将是我的购物清单）。单击另一种食物将向购物清单添加更多成分。

**我的方法：** 我用 django 构建了一个简单的页面。我能够显示已输入数据库的所有食物的列表。我现在需要的是在我点击食物时开始构建成分列表。

我在想我会在第一页加载时从数据库中加载成分列表，但用 css 隐藏它们。当我点击一个食品项目时，我会使用 jquery/css 取消隐藏与食品项目相关的成分。

这种方法对我来说似乎很笨拙。您能否给我一些建议，如何使用上述技术创建我的购物清单应用程序？我的方法正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:14:25.453

这就是我的做法。但请注意，这个问题没有*正确*答案。

让我们调用您单击食物的页面，`index.php`。

在 上`index`，我将拥有所有可以点击的食物，以及一个 ID 为“ingredients”的空 div——例如。`<div id="ingredients"></div>`

当点击食物时，他们会在`main.js`.

onClick 处理程序将：

*   跟踪当前选择的食物
*   `get_ingredients.php`通过 AJAX将 json 或其他格式的列表发送到页面。
*   （此页面将返回我想在“Ingedients”部分显示的 HTML）
*   使用 AJAX 调用返回的 html 设置成分 div 的内容。

更明确地说，`get_ingredients.php`将：

*   解析通过 AJAX 发送的食物的 GET/POST 列表`index`
*   查询数据库以查看所选食品所需的成分
*   构造与查询结果相对应的 HTML，该查询结果应放入面向用户的页面上的“成分”div 中。
*   `echo`通过/ `print`/ /etc “显示它” `printf`，这并不是真正用AJAX显示，而是作为AJAX响应发送。

这样，您只需跟踪选择的食物，而不是在选择和取消选择食物时添加/减去单个成分的数量。

这具有重新传输“您已经知道”的东西的缺点，即先前选择的食物成分，但是它消除了许多原本需要的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:11:05.390

@jedwards 的评论是正确的。而不是在开始时为*每个*项目加载*所有内容*（这可能导致初始页面加载缓慢）。您应该执行一个单击事件，该事件会回调服务器并传递数据库中对象的名称或 id 并返回其成分，然后填充包含这些成分的 div。*`jquery``ajax`*

# java - 在求解 X 时从 JTextArea 检索双精度

> ID：11065830
> 
> 赞同：2
> 
> 时间：2012-06-16T18:04:11.797
> 
> 标签：java, swing, runtime-error, jtextarea

好的，我对java有点陌生。我正在制作一个求解一步方程的程序。我在运行它时遇到了一些困难。这是我的主文件的代码`Main.java`：

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class Main extends JFrame implements ActionListener {
    private static final long serialVersionUID = 1L;
    Solve solve = new Solve();
    JButton add = new JButton("Add");
    JButton sub = new JButton("Subtract");
    JButton mult = new JButton("Multiply");
    JButton div = new JButton("Divide");
    JButton solv = new JButton("Solve!");
    JTextArea one = new JTextArea();
    JLabel two = new JLabel(" = ");
    JLabel three = new JLabel("X");
    JLabel four = new JLabel();
    JTextArea five = new JTextArea();
    JLabel solved = new JLabel();
    JPanel row1 = new JPanel();
    JPanel row2 = new JPanel();
    JPanel row3 = new JPanel();

    public double funct;

    public Main() {
        super("Solving a one step equation!");
        setSize(500, 500);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
        GridLayout layout = new GridLayout();
        setLayout(layout);

        FlowLayout layout1 = new FlowLayout(FlowLayout.CENTER);

        row1.setLayout(layout1);
        row1.add(add);
        row1.add(sub);
        row1.add(mult);
        row1.add(div);
        row1.add(solv);
        add(row1);
        add.addActionListener(this);
        sub.addActionListener(this);
        mult.addActionListener(this);
        div.addActionListener(this);
        solv.addActionListener(this);

        GridLayout layout2 = new GridLayout(1, 1, 1, 1);
        row2.setLayout(layout2);
        row2.add(one, BorderLayout.CENTER);
        row2.add(two, BorderLayout.CENTER);
        row2.add(three, BorderLayout.CENTER);
        row2.add(four, BorderLayout.CENTER);
        row2.add(five);
        add(row2, BorderLayout.CENTER);

        GridLayout layout3 = new GridLayout(5, 5, 5, 5);
        row3.setLayout(layout3);
        row3.add(solved);
        add(row3);
    }

    public static void main(String[] args) {
        Main frame = new Main();
    }

    public void actionPerformed(ActionEvent evt) {
        Object source = evt.getSource();
        if(source == add)
        {
            four.setText(" + ");
            funct = 1;
        }
        else if(source == sub)
        {
            four.setText(" - ");
            funct = 2;
        }
        else if(source == mult)
        {
            four.setText(" * ");
            funct = 3;
        }
        else if(source == div)
        {
            four.setText(" / ");
            funct = 4;
        }
        if(source == solv)
        {
            if(funct == 1)
            {

                double Ones = Double.parseDouble(three.getText());
                double Twos = Double.parseDouble(three.getText());
                solved.setText("X = " + solve.Add(Ones, Twos));
            }
            else if(funct == 2)
            {
                double Ones = Double.parseDouble(three.getText());
                double Twos = Double.parseDouble(three.getText());
                solved.setText("X = " + solve.Sub(Ones, Twos));
            }
            else if(funct == 3)
            {
                double Ones = Double.parseDouble(three.getText());
                double Twos = Double.parseDouble(three.getText());
                solved.setText("X = " + solve.Mult(Ones, Twos));
            }
            else if(funct == 4)
            {
                double Ones = Double.parseDouble(three.getText());
                double Twos = Double.parseDouble(three.getText());
                solved.setText("X = " + solve.Div(Ones, Twos));
            }

        }
    }

} 
```

这是我的另一个文件 Solve.java 的代码

```
public class Solve {
    public double Add(double One, double Two)
    {
        return One - Two;
    }

    public double Sub(double One, double Two)
    {
        return One + Two;
    }

    public double Mult(double One, double Two)
    {
        return One / Two;
    }

    public double Div(double One, double Two)
    {
        return One * Two;
    }
} 
```

一些帮助将不胜感激。有人看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T18:45:45.337

单击一次`NumberFormatException`“解决”按钮。这似乎是一个复制/粘贴问题 - 您没有检索到正确的数字。您正在尝试将 'X' 字符串转换为双精度。最好给变量起有意义的名称。要修复异常，试试这个，替换：

```
double Ones = Double.parseDouble(three.getText());
double Twos = Double.parseDouble(three.getText()); 
```

和：

```
double Ones = Double.parseDouble(one.getText());
double Twos = Double.parseDouble(five.getText()); 
```

熟悉 Java[代码约定](http://www.oracle.com/technetwork/java/codeconv-138413.html)，尤其是[命名约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-16T22:25:36.123

除了@Max 的有用答案，这里还有一些其他建议：

*   将框架的布局设置为`new GridLayout()`默认为没有填充的单行和单列。作为替代方案，请考虑`new GridLayout(0, 1, 5, 5)`，它在一列中产生任意数量的行，填充为 5x5。然后你可以专注于每一行的布局：

    ```
    row1.setLayout(new FlowLayout(FlowLayout.CENTER));
    row2.setLayout(new FlowLayout(FlowLayout.CENTER));
    row3.setLayout(new GridLayout(1, 1, 5, 5)); 
    ```

*   将您的`setVisible()`调用移到框架构造函数的末尾：

    ```
    pack();
    setLocationRelativeTo(null);
    setVisible(true); 
    ```

*   考虑`getRootPane().setDefaultButton(solv)`将`Solve`按钮设为默认按钮。

*   考虑将添加设为默认值：

    ```
    private JLabel four = new JLabel("+");
    private int funct = 1; // add by default 
    ```

*   考虑`JTextField`用于数字输入：

    ```
    private JTextField one = new JTextField(10);
    private JTextField five = new JTextField(10); 
    ```

# domain-driven-design - DDD：对具有两个聚合根的简单域进行建模

> ID：11065834
> 
> 赞同：2
> 
> 时间：2012-06-16T18:04:40.660
> 
> 标签：domain-driven-design, root, aggregate

假设我想创建一个行动网站，成员可以在其中竞标项目。为了对这个域建模，我有三个类：Member、Item 和 Bid。我的头脑风暴会是这样的：

*   项目可以包含多个出价
*   出价与一个项目和一个成员相关联
*   成员可以包含多个出价
*   Member 和 Item 可以在没有出价实例的情况下存在
*   没有 Member 和 Item 的投标实例不能存在

考虑到这一切，很明显，由于 Member 和 Item 对象是独立的，我们可以将它们视为聚合根。投标将是这些总和之一的一部分。这很清楚，但现在让我感到困惑的是我应该选择哪个聚合根？项目或成员？

这是 Apress 的 Pro ASP.NET MVC 3 Framework 书中的示例，他们的做法如下：

![在此处输入图像描述](../Images/219936b843fc8c4b820dd60f1da822b4.png)

这给出了以下代码：

```
public class Member 
{
    public string LoginName { get; set; } // The unique key
    public int ReputationPoints { get; set; }
}

public class Item 
{
    public int ItemID { get; private set; } // The unique key
    public string Title { get; set; }
    public string Description { get; set; }
    public DateTime AuctionEndDate { get; set; }
    public IList<Bid> Bids { get; set; }
}

public class Bid 
{
    public Member Member { get; set; }
    public DateTime DatePlaced { get; set; }
    public decimal BidAmount { get; set; }
} 
```

Member 和 Item 在这里是聚合根，并且 Bid 包含在 Item 中。现在假设我有应用程序用例：“获取特定成员发布的所有出价”。这是否意味着我必须首先获取所有项目（例如，通过存储库接口从数据库中获取），然后枚举每个项目的所有投标以试图找到匹配的成员？是不是有点低效？因此，更好的方法是在 Member 内部聚合 Bid 对象。但在这种情况下，请考虑新的用例：“获取特定项目的所有投标”。现在我们又需要换一种方式来获得所有的出价......

所以考虑到我需要在我的应用程序中实现这两个用例，那么对这个域建模的正确和有效的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T18:17:16.890

您的域应该只反映命令（[CQRS](http://martinfowler.com/bliki/CQRS.html)）要求（更新/更改数据）。我认为您需要查询（读取数据，不更新/更改数据）：“获取特定项目的所有投标”和“获取特定成员发布的所有投标”。因此，这种“查询”与域无关，因为查询实现独立于命令实现（命令正在调用域方法）。这使您可以自由地以有效的方式实现每个查询。我的方法是实现一个高效的 DB 视图，让您只获取想要在 UI 中显示的数据。然后创建一个名为 BidForItemDto 的新类（DTO =[数据传输对象](http://en.wikipedia.org/wiki/Data_transfer_object)) 并将数据从 DB 视图映射到 BidForItemDto 的集合中（您可以通过 ADO.NET 手动完成或使用 NHibernate（首选，为您完成一切））。对于第二个查询也是如此，创建一个名为 BidPostedByMemberDto 的新类。

因此，如果是您需要的查询，请忘记域，意识到它只是您想要在 UI 中显示的数据，并从数据库中高效地查询它们。仅当您在 UI 中执行某些操作时（例如单击按钮进行出价），它才会执行“出价”命令，该命令最终会调用域方法 Item.PlaceBid(Member member, DateTime date, decimal amount ）。顺便说一句，恕我直言，它是一个“有很多出价”的项目，域方法“出价”肯定需要访问以前的出价才能正确实现整个逻辑。将投标集合放入会员对我来说没有多大意义......

从我的脑海中浮现出一些 DB 视图和 sql 查询的例子：

获取特定项目的所有出价：

```
create view BidForItemDto
as
select 
    i.ItemId,
    b.BidId,
    b.MemberId,
    b.DatePlaced,
    b.BidAmount     
from Item i
join Bid b ON b.ItemId = i.ItemId 
```

询问：

```
SELECT *
from BidFormItemDto
where ItemId = <provide item id> 
```

获取特定成员发布的所有出价：

```
create view BidPostedByMemberDto
as
select 
    m.MemberId,
    b.BidId,
    b.MemberId,
    b.DatePlaced,
    b.BidAmount     
from Member m
join Bid b ON b.MemberId = i.MemberId 
```

询问：

```
SELECT *
from BidPostedByMemberDto
where MemberId = <provide member id> 
```

# iphone - 为什么要删除子视图？

> ID：11065836
> 
> 赞同：2
> 
> 时间：2012-06-16T18:04:47.343
> 
> 标签：iphone, objective-c, ios, xcode, subviews

我意识到如果我从我的应用程序中相应地删除子视图，内存管理似乎更好（我的应用程序中有很多子视图）。

所以我的问题是必须删除您创建的所有子视图或其可选（当您的子视图非常少时，它不会对内存使用产生太大影响）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:08:03.407

您会看到界面响应的显着跳跃，因为子视图实际上确实消耗了相当多的内存（与底层 CALayers 相比，UIView 非常昂贵），因此，调用`-removeSubview`不仅可以减轻 GPU 的压力，还可以释放更多内存内存，因为子视图通常在之后被释放。

但是要回答您的问题：不。一旦视图脱离上下文或从子视图树中删除，它自己的子视图树就会被破坏，视图会在 ARC 环境中释放，然后为您销毁。即使没有 ARC，也没有必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T18:06:24.893

这不是必须的，因为当持有视图的超级视图被删除时，它的所有子视图也被删除，你真的不需要担心删除视图，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-02T21:04:19.987

我发现为我创建的每个子视图分配一个标签允许我在将来的某个时间点在删除超级视图之前将其删除，这使得根据标签值引入和取出元素变得简单。
视图上的每个对象都是一个子视图，因此当以简单的方式使用图形时，在某些应用程序上保留标签似乎是明智的。

假设您要绘制一条简单的水平线：

绘制水平线的函数的一部分：

```
CGFloat lineWidth=8;
UIView *lineView = [[UIView alloc]initWithFrame:CGRectMake(oxx,oyy-(lineWidth/2),pxx+(lineWidth/2),pyy)];
lineView.backgroundColor = colours;
lineView.tag=5;
[self.view addSubview: lineView]; ... 
```

然后一段时间后，删除一些标记的子视图：

```
 for (UIView *subview in [self.view subviews]) {
    if (subview.tag == 101 || subview.tag == 102 ||subview.tag == 103 ||subview.tag == 104 || subview.tag == 5) {
        [subview removeFromSuperview];
    }
} 
```

# r - R根据数据框中的当前值替换值

> ID：11065842
> 
> 赞同：1
> 
> 时间：2012-06-16T18:05:09.600
> 
> 标签：r, replace, conditional, dataframe

我有一个尺寸约为 ts1[100, 2000] 的数据框，如下所示：

```
> ts1[1:8, 1:6]
       DD LEVEL     X136747     X136749     X136752     X136753     ... ...
1 D04MX.x    LC        0.25        0.30       -0.01       -0.05
2 D08MX.x    LC        0.22        0.11        0.11        0.00
3 D15MX.x    LC        0.31        0.33       -0.23       -0.08
4 D29MX.x    LC        0.28        0.14       -0.28       -0.08
5 D04HX.x    SC        0.11       -0.26       -0.21       -0.33
6 D08HX.x    SC        0.25       -0.23       -0.07       -0.25
7 D15HX.x    SC        0.29        0.03       -0.05       -0.10
8 D29HX.x    SC        0.29        0.13       -0.09        0.02
... ... 
```

我想将名为 X###### (ts1[3:ncol(ts1)]) 的列下介于 -0.1 和 0.1 之间的所有值替换为 0。我尝试了以下操作：

```
> ts1 <- ifelse(abs(ts1) < 1, 0, ts1)
Error in Math.data.frame(ts1) : 
  non-numeric variable in data frame: DDLEVEL
> ts1[which(abs(ts1) < 1)] <- 0
Error in Math.data.frame(ts1) : 
  non-numeric variable in data frame: DDLEVEL
> ts1[which(abs(is.numeric(ts1)) < 1)] <- 0
> ts1
  DD LEVEL X1367471_at X1367495_at X1367527_at X1367536_at
1  0    LC        0.25        0.30       -0.01       -0.05
2  0    LC        0.22        0.11        0.11        0.00
3  0    LC        0.31        0.33       -0.23       -0.08
... ...
> ts1 <- ts1[, lapply(.SD[3:ncol(ts1)], ifelse(abs(ts1) < 1, 0, ts1))]
Error in Math.data.frame(ts1) : 
  non-numeric variable in data frame: DDLEVEL 
```

我究竟做错了什么？我确实需要保留前两列。有什么捷径吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:28:05.960

假设您的数据名为`df`：

```
colsToEdit <- grepl("X", names(df))
df[, colsToEdit][abs(df[, colsToEdit]) <= 0.1] <- 0 
```

给你：

```
 DD LEVEL X136747 X136749 X136752 X136753
1 D04MX.x    LC    0.25    0.30    0.00    0.00
2 D08MX.x    LC    0.22    0.11    0.11    0.00
3 D15MX.x    LC    0.31    0.33   -0.23    0.00
4 D29MX.x    LC    0.28    0.14   -0.28    0.00
5 D04HX.x    SC    0.11   -0.26   -0.21   -0.33
6 D08HX.x    SC    0.25   -0.23    0.00   -0.25
7 D15HX.x    SC    0.29    0.00    0.00    0.00
8 D29HX.x    SC    0.29    0.13    0.00    0.00 
```

# objective-c - 修复了分组 UITableView 中的背景

> ID：11065844
> 
> 赞同：0
> 
> 时间：2012-06-16T18:05:13.457
> 
> 标签：objective-c, uitableview, background

我有一个带有 UINavigationController 和两个表视图的应用程序。当我在这两个表格视图之间切换时，我希望背景保持静态，所以它不会改变，但我不知道如何做到这一点。

我正在考虑使两个表格视图的背景透明，然后在后面添加一个 UIViewController，并将所需的静态图像作为背景。这是一个正确的方法吗？还是有更好或更简单的解决方案？顺便说一句，我正在使用故事板。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:20:21.050

如果您喜欢动画，那么帧更改并不是那么糟糕。您可以为表格使用透明背景，并在两个表格后面插入一个图像视图：

```
[UIView animateWithDuration:1.0f animations:^{
     [self.tableOne setFrame:CGRectMake(-320,0,self.view.frame.size.width, self.view.frame.size.height)];
     [self.tableTwo setFrame:CGRectMake(0,0,self.view.frame.size.width, self.view.frame.size.height)];
 }]; 
```

当然框架只是一种选择。中心也有效。

# php - 删除第 x 个单词 PHP 之后的文本

> ID：11065847
> 
> 赞同：-4
> 
> 时间：2012-06-16T18:05:53.983
> 
> 标签：php

我有一个用 PHP 写的博客，需要缩短最新的博客文章以供首页。我在 $variable 中有最新的帖子，并且想删除第 x 个单词之后的所有文本。在每个单词之间我有一个空格，如果这有帮助的话。提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:12:37.433

```
implode(' ', array_slice(explode(' ', $variable), 0, x)); 
```

用您需要的单词数替换“x”。

# facebook - Facebook 使用什么技术进行链接？

> ID：11065850
> 
> 赞同：-1
> 
> 时间：2012-06-16T18:06:07.430
> 
> 标签：facebook, google-api, youtube-api

只是想知道 facebook 在发布链接时使用什么技术。我注意到，每当我在屏幕上粘贴链接时，我都会将链接作为页面获取。

例如，当我粘贴 youtube 的链接时...它显示为视频，我只能在那里播放。

有人可以让我知道如何做到这一点。什么都需要

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:08:32.263

他们所做的可能是解析链接（正则表达式在这里很有用），获取电影的 ID 并使用 Youtube API 嵌入播放器。这是 API 的文档：[https ://developers.google.com/youtube/player_parameters](https://developers.google.com/youtube/player_parameters)

# javascript - 为什么我的 jquery 代码不运行？

> ID：11065853
> 
> 赞同：5
> 
> 时间：2012-06-16T18:06:22.273
> 
> 标签：javascript, jquery

单击链接时，我想切换该 id 的*pg元素。*标题：

```
<title>Example</title>
        <script type="text/javascript" src="jquery-1.3.2.js"></script>
        <script type="text/javascript">
            $(function() {
                $("#link").click(function() {
                    $("#pg").toggle();
            });
        </script> 
```

元素：

```
<p id="pg">deneme deneme 123 deneme</p>
<a href="#" id="link">toggle</a> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-16T18:08:18.027

通过添加关闭点击功能`});`：

```
$(function() {
     $("#link").click(function() {
         $("#pg").toggle();
     });
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-16T18:08:26.833

你错过了最后`});`的陈述

```
<title>Example</title>
  <script type="text/javascript" src="jquery-1.3.2.js"></script>
  <script type="text/javascript">
    $(function() {
      $("#link").click(function() {
        $("#pg").toggle();
      });
    )}; //<-- Missing close bracket
  </script> 
```

此外，如果您使用的是 Firefox，请查看[Firebug](http://getfirebug.com/)。它是一个非常宝贵的调试器工具，会告诉你哪里发生了错误。

Chrome 启用了开发者工具，不确定 IE。

# android - 在 TextView 中换行多行文本 - Android

> ID：11065854
> 
> 赞同：4
> 
> 时间：2012-06-16T18:06:24.160
> 
> 标签：android

我有一个带有 layout_width="wrap_content" 属性的多行 TextView。问题是当 TextView 实际上变成多行时，这个属性就不起作用了。我该如何解决这种行为？

这是插图：

![在此处输入图像描述](../Images/2eecbcee1d4eb6109a85673aff5d9098.png)

XML:

```
 <TextView android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:textColor="#000000"
                  android:focusable="false"
                  android:textSize="16.5dip"
                  android:padding="2dip"
                  android:lineSpacingMultiplier="1.1"
                /> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-16T18:21:50.800

似乎您正在使用父视图（ViewGroup），您已在其中为框定义了背景。您只需要为 TextView 而不是 ViewGroup 定义背景。所以，不要在你的 ViewGroup 中使用背景，尝试在 textview 中使用它。例如：

```
<FrameLayout android:layout_width="fill_parent"
             android:layout_height="wrap_content">

<TextView android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:textColor="#000000"
              android:focusable="false"
              android:textSize="16.5dip"
              android:padding="2dip"
              android:lineSpacingMultiplier="1.1"
              android:background="@drawable/background_box"
            />

</FrameLayout> 
```

# windows - Windows 上的 drand48

> ID：11065861
> 
> 赞同：5
> 
> 时间：2012-06-16T18:07:06.407
> 
> 标签：windows, random, posix

我正在寻找与 Windows 上的 drand48 等效的版本。对于所有不知道的人，以下内容并不等同：

```
(double)rand()/RAND_MAX; 
```

首先， rand 返回的值包括 RAND_MAX 其次，在 Windows RAND_MAX=32767 上，这对我的应用程序来说太短了。

我的目的是为模拟产生噪音。最好使用与 drand48 具有相同周期的伪随机生成器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-17T00:56:37.067

首先，请注意，您似乎将决议与期间混淆了。在 Windows 上，rand 将返回 0 到 32767 之间的值，但这并不意味着每次调用 32768 次都会重复相同的值。所以 rand 应该是完全足够的，除非你需要超过 16 位的分辨率。（分辨率和周期在 drand48 中是相同的，但不是在所有伪随机数生成器中。）

如果您不需要 drand48 的确切行为，[rand_s](http://msdn.microsoft.com/en-us/library/sxtz2fa8.aspx)将是最简单的选择。它具有 32 位分辨率，低于 drand48，但足以满足大多数用途。它生成一个密码安全的随机数，因此没有固定的周期。一个可能的问题是它会比 drand48 慢得多。

如果您想要 drand48 的相同行为，该[算法已记录在案](http://pubs.opengroup.org/onlinepubs/007908799/xsh/drand48.html)并且应该易于重新实现，或者您可以使用[来自 FreeBSD 的源代码](http://fxr.watson.org/fxr/source/gen/drand48.c?v=FREEBSD-LIBC;im=10)（链接到[http://fxr.watson.org/](http://fxr.watson.org/)上的源代码浏览器）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-09T01:24:30.110

晚会晚了 7 年。对不起。

Gnu Scientific Library 很好地解决了这个问题。该库采用了几种高质量的生成算法。

[https://www.gnu.org/software/gsl/doc/html/rng.html](https://www.gnu.org/software/gsl/doc/html/rng.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T18:11:53.820

它可能不是您问题的确切答案，但它仍然是一个解决方案。使用[CryptGenRandom](http://msdn.microsoft.com/en-us/library/aa379942%28v=vs.85%29.aspx)（它是 WinAPI 的形式）。

# python - 如何让 linux 在 Python 解释器中自动运行我的 python 脚本？

> ID：11065863
> 
> 赞同：6
> 
> 时间：2012-06-16T18:07:18.597
> 
> 标签：python, linux

我已经决定走出我的 .NET 泡沫并开始尝试其他技术对我来说是件好事。我正在运行 Ubuntu12 并安装了 python2.7 和 3.2。我可以直接在解释器中运行代码。

我在文件系统上有一个名为 Standalone.py 的基本脚本：

```
#!/usr/bin/env python3.2

import sys

print("this is a standalone script.") 
```

当我在 bash 提示符下输入`$ python3.2 Standalone.py`. 我得到一个回应说`this is a standalone script`。但是当我键入时`$ Standalone.py`，它告诉我找不到该命令。

我如何运行这样的脚本？

谢谢你的帮助。

## 更新

我将 Standalone.py 的权限更改为 755。然后我运行命令：

```
$ ./Standalone.py 
```

并收到消息：

```
: No such file or directory 
```

然后我将 Standalone.py 的权限切换回 644。然后当我运行

```
$ ./Standalone.py 
```

我收到了消息

```
-bash: ./Standalone.py: Permission denied 
```

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-16T18:09:27.820

1.  您需要使脚本可执行使用

    ```
    chmod +x Standalone.py 
    ```

2.  通常不会在当前目录搜索可执行文件，所以需要使用

    ```
    ./Standalone.py 
    ```

    告诉 shell 脚本在当前目录中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-16T21:41:27.730

确保您的脚本文件有 linux 换行符（只是`\n`）而不是 Windows 换行符（`\r\n`）。你是在windows上写的吗？这发生在我身上一次。您应该检查您的编辑器设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-16T18:38:04.860

1.  你的脚本应该以`#!/usr/bin/python`not开头`#!/usr/bin/env python3.2`

2.  确保你在你的脚本所在的文件夹中，你可以检查`ls`

3.  `chmod +x Standalone.py`

4.  `./Standalone.py`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-16T19:59:21.497

首先，要执行一个脚本，它需要是可执行的。所以你要么必须做一个 chmod +x $file 要么 chmod 0740 $file。当您将文件权限设置为 644 时，您将立即执行，因此 if 会给您一个错误。如果您不确定执行权和八进制表示法，可以使用： http: [//permissions-calculator.org/decode/0644/](http://permissions-calculator.org/decode/0644/)。那么，要真正回答您的问题，如果您想使用 $file.py 调用脚本，它需要位于您的 PATH 变量中。您可以使用 echo $PATH 显示它。这些是搜索要执行的脚本的目录。因此，您只需为您的脚本赋予可执行权限，并将其放在 PATH 指定的目录之一中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-17T08:12:58.507

你能检查 /usr/bin/python 或 /usr/bin/python3.2 是否存在吗

执行以下命令：

```
which python3.2 
```

然后在脚本之上使用生成的路径。

# svn - 删除服务器上svn下的连接和所有文件

> ID：11065869
> 
> 赞同：1
> 
> 时间：2012-06-16T18:08:29.380
> 
> 标签：svn, command-line

嗨，我在 assembla 有一个存储库，我正在使用 svn 来存储新类、更改等。我的 servlet 在服务器上运行，所以我决定连接 assembla 和服务器以进行自动更新。我使用了

```
 svn checkout http://blah...
     svn update 
```

但是我的问题开始了。我无法打开我的页面。网页可以上传，甚至可以上传 30 分钟而没有任何事情发生。只是上传。所以我决定删除所有围绕svn的东西。我使用以下命令行：

```
 find . -type d -name .svn 
```

结果：

```
 ./.svn 
```

然后我删除并使用以下内容：

```
 rm ./.svn -rf 
```

实际上，我想做的是删除与 svn 和连接相关的所有内容，因为问题从那里开始。请给我任何命令行或建议我该怎么做。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:19:15.280

做一个`svn export`。这会将 svn 工作副本中的内容导出到另一个目录，除了任何 svn 相关文件/目录。

如果您只想删除 .svn 文件，请输入以下命令。

```
rm -r `find -type d -iname .svn` 
```

# javascript - 为什么我的两个 javascript 代码没有运行？

> ID：11065874
> 
> 赞同：2
> 
> 时间：2012-06-16T18:08:46.087
> 
> 标签：javascript, jquery

我在一页上使用了两个不同的脚本，当我同时调用它们时，其中一个不起作用。如果我删除一个，那么剩下的一个就可以了。为什么他们两个都不工作？这是我页面顶部的内容：

```
<script type="text/javascript" src="jscript/jquery.js"></script>
<script type="text/javascript" src="jscript/script.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="../plugins/nicescroll/jquery.nicescroll.min.js"></script>
<script>
    $(document).ready(function () {
        var nice = $("html").niceScroll();
        $("#outer").html($("#outer").html());
        $(".overflow").niceScroll({
            cursorborder: "",
            cursorcolor: "#333333",
            boxzoom: false,
            cursorwidth: "5px"
        });
    });
</script>
<script type="text/javascript" src="tabslider/javascripts/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="tabslider/javascripts/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="tabslider/javascripts/jquery.coda-slider-2.0.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#coda-slider-1').codaSlider();
    });
</script> 
```

[在 PasteBin 上发布代码：http://pastebin.com/MwNTNhXV](http://pastebin.com/MwNTNhXV)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:13:09.883

您的脚本应如下所示：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="jscript/script.js"></script>
<script type="text/javascript" src="../plugins/nicescroll/jquery.nicescroll.min.js"></script>
<script type="text/javascript" src="tabslider/javascripts/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="tabslider/javascripts/jquery.coda-slider-2.0.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    var nice = $("html").niceScroll(); 
    $("#outer").html($("#outer").html());
    $(".overflow").niceScroll({cursorborder:"",cursorcolor:"#333333",boxzoom:false,cursorwidth:"5px"}); 
    $('#coda-slider-1').codaSlider();
});
</script> 
```

问题是您正在加载 3 个 jQuery 版本，而其他脚本的顺序不正确

# c++ - 容器中的对象范围

> ID：11065875
> 
> 赞同：2
> 
> 时间：2012-06-16T18:08:56.767
> 
> 标签：c++, vector, constructor, scope

我试图将对象向量放在一个类中并遇到范围问题。我需要用不同的参数构造每个。我试图避免空的构造函数和初始化函数，因为这违背了拥有构造函数的目的。我有这样的事情：

```
class inner
{
    inner::inner(string &dev);
    inner::~inner();
};

class outer
{
    vector<inner> devs;
}; 
```

这将创建一个空向量。然后我需要在外部方法中构造 devs 矢量对象。不幸的是，它们超出了范围，并且正在以相同的方法调用析构函数。我需要范围是向量的范围（即：外部对象），而不是实例化向量元素的方法。这是我的构造代码：

```
for (unsigned i=0; i<dev_strings.size(); i++)
{
    devs.resize(i+1, inner(dev_strings[i]));
} 
```

我想我可以使用 new 来获取内部对象，但是它们我有一个指向对象的指针向量，并且必须显式删除，这似乎违背了让向量为其资源管理内存的目的。我宁愿避免这种情况。

# c++ - C++ 列表迭代器在打印列表时不兼容

> ID：11065880
> 
> 赞同：0
> 
> 时间：2012-06-16T18:09:42.007
> 
> 标签：c++, iterator

好吧，伙计们，我一直在寻找这个错误的答案，但我没有针对我的案例的具体答案。我有一个用户类，每个用户都有自己的计算机列表，计算机类由这三个类（操作系统、内存和处理器）组成。所以 Computer 有自己的 toString ，它从上面提到的组件中调用特定的 toString。

所以...用户有他的属性列表computerList；

在我称为 Controler 的其他类中，我有一个从特定用户打印计算机列表的功能。这是我的功能：

```
void printComputerList(User* u){
    list<Computer*>::iterator itr;
    for(itr=u->getComputerList().begin(); itr!=u->getComputerList().end(); itr++){
        cout<<(*itr)->toString(); //(*itr) calls its own toString implemented in the class Computer
    }
} 
```

所以，当我运行程序时，当我选择打印我已经填写的列表时，我会从标题中得到错误。我认为这可能是托特林之间的某种混淆？

PD：如有必要，我可以发布其余代码

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:21:29.507

临时列表存在（至少）一个问题。固定版本如下所示：

```
void printComputerList(User* u){
  list<Computer*> const computers = u->getComputerList();
  list<Computer*>::const_iterator it = computers.begin();
  while (it != computers.end())
  {
    cout << (*it)->toString(); //(*it) calls its own toString implemented in the class Computer
    ++it;
  }
} 
```

你确定，列表上的指针是有效的（非空的，不是悬空的）吗？

# html - 如何创建具有多种颜色的居中标题？

> ID：11065882
> 
> 赞同：2
> 
> 时间：2012-06-16T18:09:52.387
> 
> 标签：html, css, position, positioning

我想重新创建以下标题：

![](../Images/2603c93fbf972dd2359354e44631eefe.png)

问题是内容在白色部分居中。灰色是正文的背景，标题是屏幕的 100%。

我现在拥有的是：

CSS

```
.top_left {
  background:#3c4d74;
}

.top_right {
  background:#2f3a5a;
}

.top_center {
  background:#3c4d74 url(http://img85.imageshack.us/img85/2816/headerbgo.jpg) no-repeat right top;
  height:140px;
}

#page, 
.top_center {
  max-width:1000px;
  margin:0 auto;
}

#page {
  background:#FFF;
}

body {
  background:#DEDEDE;
} 
```

HTML

```
<body>
    <div id="top-header">
        <div class="top_left"></div>
        <div class="top_center">
            <a href="#">LOGO</a>    
        </div>
        <div class="top_right"></div>
    </div>
    <div id="page" class="hfeed">
        MY content bla bla bla
    </div>    
</body>​​​​​​ 
```

您可以在[http://jsfiddle.net/gTnxX/](http://jsfiddle.net/gTnxX/)上看到它（我将最大宽度设置为 600 像素而不是 1000 像素，以便您可以在小提琴上看到它）。

如何在任何分辨率下使左侧软蓝色和右侧硬蓝色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:37:11.117

为此，您需要非常了解定位的工作原理。

的`#header-bg`位置使其低于`#wrapper`。它是 100% 宽，140px 高，有 2 个 div，它们都占用了 50% 的空间，并且它们的左/右颜色都不同。

的`#wrapper`相对定位是为了`z-index`工作，把它放在上面`#header-bg`。宽度设置为 600 像素，并将`margin: 0 auto;`其居中。

这`#header`是一个简单的 div，它设置了高度和所需的背景。

内容遵循`#header`正常流程。

这是一个带有请求行为的jsfiddle。

[http://jsfiddle.net/sg3s/cRZxN/](http://jsfiddle.net/sg3s/cRZxN/)

如果内容大于屏幕，这甚至可以很好地降级并让您水平滚动（我从原始 jsfiddle 中注意到了这一点）。

**编辑：**

To make it IE7 compatible I made some changes to fix 2 bugs. I had to add `left: 0;` and `top: 0;` explicitly to `#header-bg` to fix a positioning bug. Made the divs inside `#header-bg` 49% instead of 50% or else IE7 would not resize them properly and make the right div bump down. To compensate for the small gap that created I made the right div `float: right;`.

# regex - 从字符串中解析 twitter 短链接

> ID：11065895
> 
> 赞同：0
> 
> 时间：2012-06-16T18:12:05.967
> 
> 标签：regex

我正在尝试解析链接`'bit.ly/KATlrT'`：`asdfs asdf as dfa sdf a bit.ly/KATlrT f sf sd f dsfdsa`

这是我正在使用的正则表达式，但它不匹配？

```
bit?/S+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T18:18:48.427

```
(bit\.ly\/\S+)
^\ /^^\/^^\/^^
| | ||| ||| ||
| | ||| ||| |`- End first capture group
| | ||| ||| `-- Match 1 or more of previous (any non-space character)
| | ||| ||`---- Match any non-space character
| | ||| |`----- Match '/' literally because of previous escape character
| | ||| `------ Escape next special character
| | ||`-------- Match 'ly' literally
| | |`--------- Match '.' literally because of previous escape character
| | `---------- Escape next special character
| `------------ Match 'bit' literally
`------------- Start first capture group 
```

**[在行动中看到它。](http://rubular.com/r/onoXe6mtZO)**

* * *

您在问题中提供的解释：

```
bit?/S+
\/^^^^^
| |||||
| ||||`- repeat previous ('S') 1 or more times
| |||`-- match 'S' literally
| ||`--- this is not escaped, and will cause problems
| |`---- previous is optional ('t')
| `----- match 't' literally 
`------- match 'bi' literally 
```

* * *

如果你想了解更多关于正则表达式的信息，[www.regular-expressions.info](http://www.regular-expressions.info)是一个很好的资源，[Regexr](http://www.regexr.com)或[Rubular](http://www.rubular.com)是测试你的正则表达式的好工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:17:24.327

由于我不懂语言，我将发布 Java 正则表达式的答案（主要基于 Perl 正则表达式）。有相当多的语言或多或少地遵循 Perl 的正则表达式语法。

```
"bit\\.ly/[a-zA-Z]+" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T18:19:19.863

它不匹配可能是因为您忘记了 escape `\S`，所以它寻找一个文字`S`。此外，您将需要`.`而不是`?`大多数语言。

尝试`bit\.\S+`or`bit\.ly\/\S+`等​​。

# c# - 更新错误无法从'System.Collections.Generic.List 转换 ' 到 'GameLibrary.Cards.Card'

> ID：11065898
> 
> 赞同：-4
> 
> 时间：2012-06-16T18:12:53.517
> 
> 标签：c#

> **可能重复：**
> [错误无法从“System.Collections.Generic.List<GameLibrary.Cards.Card>”转换为“GameLibrary.Cards.Card”](https://stackoverflow.com/questions/11065481/error-cannot-convert-from-system-collections-generic-listgamelibrary-cards-car)

```
 private List<List<Card>> GetCardMatchesInHand()
    {
        List<Card> list4;
        List<List<Card>> list = new List<List<Card>>();
        List<GameLibrary.Cards.Card> list2 = new List<GameLibrary.Cards.Card>()
        List<Card> list3 = new List<Card>();
        list4 = new List<Card> {
            list2,
            list3,
            list4
        };
        List<Card> list5 = this.Cards.ToList<Card>();
        using (List<Card>.Enumerator enumerator = this.Cards.GetEnumerator())
        {
            Predicate<Card> match = null;
            Predicate<Card> predicate2 = null;
            Predicate<Card> predicate3 = null;
            Predicate<Card> predicate4 = null;
            Predicate<Card> predicate5 = null;
            Card c;
            while (enumerator.MoveNext())
            {
                c = enumerator.Current;
                list5.Remove(c);
                if (match == null)
                {
                    match = element => element.CardValue == c.CardValue;
                }
                Card item = list5.Find(match);
                if (item != null)
                {
                    if (predicate2 == null)
                    {
                        predicate2 = element => element.CardValue == c.CardValue;
                    }
                    if (list2.Exists(predicate2))
                    {
                        if (predicate3 == null)
                        {
                            predicate3 = element => element.CardValue == c.CardValue;
                        }
                        item = list2.Find(predicate3);
                        list2.Remove(item);
                        list3.Add(c);
                    }
                    else
                    {
                        if (predicate4 == null)
                        {
                            predicate4 = element => element.CardValue == c.CardValue;
                        }
                        if (list3.Exists(predicate4))
                        {
                            if (predicate5 == null)
                            {
                                predicate5 = element => element.CardValue == c.CardValue;
                            }
                            item = list3.Find(predicate5);
                            list3.Remove(item);
                            list4.Add(c);
                        }
                        else
                        {
                            list2.Add(c);
                        }
                    }
                }
            }
        }
        return list;
    } 
```

我在“list2，list3，list4”这一行收到错误消息。现在为什么我会收到这个错误？这是现在发布的整个代码。也许现在你可以看到我想要做什么。还使用它来检查列表中的匹配项。

```
 List<List<Card>> cardMatches = this.GetCardMatchesInHand(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:15:58.637

改变

```
list4 = new List<Card> { 
```

至

```
list1 = new List<List<Card>> { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:17:33.297

变量`list2`和保存卡片列表`list3`，`list4`因此您无法制作包含它们的卡片列表。它们是卡片列表，而不是卡片。

保存它们的列表将是卡片列表的列表：

```
list4 = new List<List<Card>> {
  list2,
  list3,
  list4
}; 
```

# python - 使用 sqlalchemy 进行区分大小写的查询

> ID：11065899
> 
> 赞同：3
> 
> 时间：2012-06-16T18:13:08.417
> 
> 标签：python, mysql, sqlalchemy

我需要使用 sqlalchemy 对 mysql 数据库进行一些区分大小写的查询，如何使用 sqlalchemy 使查询区分大小写。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T22:45:13.633

您需要指定列上的排序规则区分大小写。
SQLAlchemy 对 MySQL 方言的支持[允许几种列类型接受`collation`kwarg](http://docs.sqlalchemy.org/en/latest/dialects/mysql.html)。
下面是创建表时如何指定列排序规则的示例。

```
import sqlalchemy as sa
sa.__version__
# -> '0.7.7'
engine = sa.create_engine('mysql+mysqldb://uname:pword@localhost/your_db', 
                          pool_recycle=3600)
metadata = sa.MetaData()
some_table = sa.Table('some_table', metadata,
    sa.Column('id', sa.Integer, primary_key=True),
    sa.Column('some_column', 
              # specify case-sensitive collation
              sa.dialects.mysql.VARCHAR(100, collation='utf8_bin')), 
)
metadata.create_all(engine)
conn = engine.connect()
conn.execute('''INSERT INTO some_table (some_column) 
                VALUES (%s);''', ('foo',))
conn.execute('''INSERT INTO some_table (some_column) 
                VALUES (%s);''', ('FOO',))
conn.execute('SELECT * FROM some_table;').fetchall()
# -> [(1L, 'foo'), (2L, 'FOO')]
conn.execute('''SELECT * 
                FROM some_table 
                WHERE some_column LIKE %s;''', ('foo%',)).fetchall()
# -> [(1L, 'foo')]
conn.execute('''SELECT * 
                FROM some_table 
                WHERE some_column LIKE %s;''', ('FOO%',)).fetchall()
# -> [(2L, 'FOO')] 
```

# java - 如何减少java程序的内存消耗

> ID：11065905
> 
> 赞同：0
> 
> 时间：2012-06-16T18:13:37.523
> 
> 标签：java, memory, garbage-collection

我有一个 Java 3D 程序，它使用了很多（数百个）3D 模型（3ds 和 obj）。我使用的模型越多（我真的，真的必须这样做，它是真实世界对象的一种 3D 模型），程序变得越重，直到任何单个操作都需要很长时间才能完成。

CPU 消耗很少达到 50%，大部分在 10%-30% 之间移动，但内存消耗随着每个添加的 3D 模型而增长（显然）。

我知道如何最小化 c++/c 程序的内存印记，但是对于 Java 的 GC，除了使用 -Xmx 增加 JVM 的内存之外，我能做些什么吗？我已经在运行 -xMx512Mb。

我使用 GCViewer 检查了 GC 日志，没有发现任何可疑之处。

我知道关于 SO 的一些非常相似的问题，但没有人准确回答我的问题。

我的 IDE 是 IntelliJ 11。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:27:51.420

有两种简单的方法可以减少您正在创建的对象的数量，其中一种或两种可能适用于您的目的，尽管没有规范我无法确定。

1) 使用高度可变的对象。如果您需要模拟大量相似度很高但不必相互交互的事物（例如，十万次模拟十几个粒子交互，每次粒子略有不同），然后一遍又一遍地使用相同的十几个对象，并利用 mutator 函数将负担转移到 CPU。但是，我怀疑按顺序使用许多对象对您来说是个问题，因为 Java 已经内置了垃圾收集。

2）将相似对象之间的相似性作为自己的类。例如，如果您需要大量对象，并且注意到其中很大一部分共享许多内存密集型特征，请将这些特征存储在它们自己的类中，并在每个对象中引用该类的单个实例具有完全相同的字段值的对象。例如，考虑一组 Apple 对象。您可以为 GrannySmithApples、MackintoshApples、RedDeliciousApples 创建不同的类，并使用它们自己的静态字段来实现跨类共享的特征（例如 RedDeliciousApples 在抽象类 Apple 中声明了一个静态字符串字段并设置为“red”），或者（允许更多运行时的灵活性）每个类都可以有一个 CoreCharacteristic 的实例。

```
CoreCharacteristic c = new CoreCharacteristic(<some parameters>);
Apple apple1 = new Apple(c);
Apple apple2 = new Apple(c);
Apple apple3 = new Apple(c);
Apple apple4 = new Apple(c); 
```

将只为所有四个苹果使用一个 CoreCharacteristic，将存储 CoreCharacteristic 字段所需的内存量减半，否则这些字段将被每个 Apple 复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T18:30:15.183

我可以想到两种不同的方法来处理您的问题：

1.  控制 GC 何时启动：[这](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html)是一篇完整的文章，描述了如何控制垃圾收集器以及用于清理内存的不同算法。当应用程序在一分钟内创建成千上万个 DTO 时，我发现这种方法非常有用。
2.  如果您的应用程序没有创建太多快速丢弃的对象，那么我建议您查看您的模型并提高其效率。请记住，在处理 3D 可视化时，重要的是如何构建场景图。

附带说明一下，使用基于 OpenGL 的解决方案时，3D 可视化不会占用那么多 CPU。这主要是因为在渲染场景图时涉及很多的是 GPU，而不是 CPU。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T18:33:25.443

从我的角度来看，您有两个选择：

1.  通过使它们不可变来减少创建新对象，如果它们不变则重用它们
2.  使用flywieght模式-重用创建的对象并在它们上使用setter，而不是一次又一次地创建新的对象-这是一个很好的实现示例，可能完全适合您的需求[http://www.javacamp.org/designPattern/flyweight。 html](http://www.javacamp.org/designPattern/flyweight.html) - 它是关于创建色环。如果没有 flywiegh，它需要 2.5 倍的时间，并且内存消耗要大 200 倍。尝试一下。

# asp.net - Asp.net 组合框 - 记住会话中的索引或值

> ID：11065906
> 
> 赞同：0
> 
> 时间：2012-06-16T18:13:50.407
> 
> 标签：asp.net, session

由于我在回发后丢失索引时遇到问题，在会话中记住索引或值会更好吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:32:58.720

我认为，如果您只是确保`EnableViewState`未`false`针对该特定控件或页面级别设置为，那么您将能够保留索引以供用户选择

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T18:25:58.537

我会说将它们存储在会话中，但是，您是否在页面加载事件中进行了任何选择，如果是，您是否检查过它不会在回发后重做该填充？

这可能会把事情搞砸，这将设置每次回发的时间：

```
 protected void Page_Load(object sender, EventArgs e)
    {
            Label1.Text = DateTime.Now.ToString();
    } 
```

但是，这将使您的内容在视图状态中保持不变，并且只有在没有回发的情况下加载页面时时间才会更新：

```
 protected void Page_Load(object sender, EventArgs e)
    {

        if (Page.IsPostBack != true)
        {
            Label1.Text = DateTime.Now.ToString();
        }
    } 
```

# iphone - BG 图像大小调整

> ID：11065908
> 
> 赞同：0
> 
> 时间：2012-06-16T18:14:14.907
> 
> 标签：iphone, ios

我有一个包含三个视图的基本应用程序，第一个视图（初始视图）有一个 ImageView，其中包含一个 320 x 460（我也尝试过 320 x 480）的图像，作为视图的背景图像。状态栏已启用。当我在手机上测试应用程序时，图像会在应用程序首次加载并最终缩放以适应屏幕时调整大小。我的图像尺寸做错了什么？由于图像大小调整，当应用程序首次加载时，初始视图似乎“跳跃”，我不希望用户认为存在问题。

这是我的故事板：

```
<objects>
            <placeholder placeholderIdentifier="IBFirstResponder" id="vni-Jh-JGC" userLabel="First Responder" sceneMemberID="firstResponder"/>
            <viewController id="gWY-GQ-C35" sceneMemberID="viewController">
                <view key="view" contentMode="scaleToFill" id="e8S-C8-ddz">
                    <rect key="frame" x="0.0" y="20" width="320" height="460"/>
                    <autoresizingMask key="autoresizingMask"/>
                    <subviews>
                        <imageView autoresizesSubviews="NO" userInteractionEnabled="NO" contentMode="scaleToFill" image="targetbg.png" id="s7d-M3-VIr">
                            <rect key="frame" x="-1" y="0.0" width="320" height="460"/>
                            <autoresizingMask key="autoresizingMask"/>
                            <rect key="contentStretch" x="0.0" y="0.0" width="0.0" height="0.0"/>
                        </imageView>
                        <button opaque="NO" contentMode="scaleToFill" contentHorizontalAlignment="center" contentVerticalAlignment="center" lineBreakMode="middleTruncation" id="uF7-4u-0PX">
                            <rect key="frame" x="14" y="417" width="300" height="38"/>
                            <autoresizingMask key="autoresizingMask" flexibleMaxX="YES" flexibleMaxY="YES"/>
                            <fontDescription key="fontDescription" type="boldSystem" pointSize="15"/>
                            <state key="normal" image="newsubmit.png">
                                <color key="titleColor" red="0.19607843459999999" green="0.30980393290000002" blue="0.52156865600000002" alpha="1" colorSpace="calibratedRGB"/>
                            </state>
                            <state key="highlighted">
                                <color key="titleColor" white="1" alpha="1" colorSpace="calibratedWhite"/>
                            </state>
                            <connections>
                                <segue destination="2" kind="modal" id="Qkv-0y-8Sh"/>
                            </connections>
                        </button>
                        <label opaque="NO" clipsSubviews="YES" userInteractionEnabled="NO" contentMode="left" text="Blake Design Group" textAlignment="center" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" minimumFontSize="10" id="Am2-mX-6Yv">
                            <rect key="frame" x="22" y="386" width="280" height="21"/>
                            <autoresizingMask key="autoresizingMask" flexibleMaxX="YES" flexibleMaxY="YES"/>
                            <fontDescription key="fontDescription" type="system" pointSize="10"/>
                            <color key="textColor" red="1" green="1" blue="1" alpha="1" colorSpace="calibratedRGB"/>
                            <nil key="highlightedColor"/>
                        </label>
                        <label opaque="NO" clipsSubviews="YES" userInteractionEnabled="NO" contentMode="left" text="version 2.0" textAlignment="center" lineBreakMode="tailTruncation" baselineAdjustment="alignBaselines" minimumFontSize="10" id="Buw-jD-jIs">
                            <rect key="frame" x="16" y="374" width="280" height="21"/>
                            <autoresizingMask key="autoresizingMask" flexibleMaxX="YES" flexibleMaxY="YES"/>
                            <fontDescription key="fontDescription" type="system" pointSize="10"/>
                            <color key="textColor" red="1" green="1" blue="1" alpha="1" colorSpace="calibratedRGB"/>
                            <nil key="highlightedColor"/>
                        </label>
                    </subviews>
                    <color key="backgroundColor" white="1" alpha="1" colorSpace="custom" customColorSpace="calibratedWhite"/>
                </view>
                <nil key="simulatedTopBarMetrics"/>
                <simulatedOrientationMetrics key="simulatedOrientationMetrics"/>
                <simulatedScreenMetrics key="simulatedDestinationMetrics"/>
            </viewController>
        </objects> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:45:48.497

我将假设您正在尝试创建启动画面这是我为使启动画面适用于 iPhone 和 iPad 所做的工作

*   我创建一个`UIView`（我的启动视图）不是`UIViewController`
*   首先创建一个大小为 320*460 的视图
*   添加a `UIImageView`，imageView大小为320*460，y设置为-10
*   `UIImageView`和容器的`UIView`调整大小掩码设置为 0（根本没有调整大小）
*   将`UIImageView`内容设置为`center`
*   在`willMoveToSuperview`我有以下

    ```
    - (void)willMoveToSuperview:(UIView *)newSuperview
    {  
        BOOL isiPad = UIUserInterfaceIdiomPad == UI_USER_INTERFACE_IDIOM();

        if(isiPad)
        {
            mainImage.image = [UIImage newImageFromResource:@"Default-Portrait~ipad.png"];            
        }
        else {
            mainImage.image = [UIImage newImageFromResource:@"Default"];                    
        }
    } 
    ```

*   现在在`didFinishLaunchingWithOptions`我创建这个视图并将其添加到`self.window.rootViewController`

    ```
    [self.window.rootViewController.view addSubview:splashScreen];
    splashScreen.frame = self.window.rootViewController.view.bounds;
    splashScreen.autoresizingMask = AUTORESIZE_ALL;
    [splashScreen initialize]; 
    ```

这在方向和 iPad 和 iPhone 上都对我有用，

注意：我使用相同的 default.png 图像来创建启动画面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T21:25:52.283

我终于弄明白了，它是如此简单。我的启动图像是 480，我的 bg 图像是 460。这在加载过程中造成了短暂的重叠，并创建了似乎是调整大小/重新缩放的内容。今天吸取了很好的教训。

# jquery - 带有长内容侧边栏的固定位置

> ID：11065910
> 
> 赞同：2
> 
> 时间：2012-06-16T18:14:32.937
> 
> 标签：jquery, html, css, css-position

我有一个带有长边栏的网站（内容高于一个浏览器的“屏幕”）。我需要的是：

*   向下滚动页面时，我们还滚动侧边栏（因为它是静态位置）
*   当屏幕底部到达侧边栏底部时，我们开始拖动它（侧边栏位置固定到底部）
*   在我们拖动它一段时间后，向上滚动时，再次像静态位置一样滚动它
*   当屏幕顶部到达侧边栏顶部时，我们开始将其向上拖动，直到它到达它应该重新定位的起始点（位置固定到顶部）

我一直在寻找解决方案，也尝试用 jquery 来做，但对我没有任何帮助。有什么建议我应该使用什么？

链接：[http ://savicky.pl/etno/](http://savicky.pl/etno/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T19:03:46.270

我给你做了一个例子。利用它！[http://jsfiddle.net/QQjTW/](http://jsfiddle.net/QQjTW/)

# go - 通过未加密的连接发送电子邮件

> ID：11065913
> 
> 赞同：9
> 
> 时间：2012-06-16T18:14:48.350
> 
> 标签：go, smtp-auth

我有一个不使用加密连接的 SMTP 帐户。我可以使用同一个帐户从 C# 和 Python 发送电子邮件而不会出现问题，但是使用 Go 我得到错误： **未加密的连接**

这是我正在使用的代码：

```
package main

import (
        "log"
        "net/smtp"
)

func main() {
        // Set up authentication information.
        auth := smtp.PlainAuth(
                "",
                "user@example.com",
                "password",
                "mail.example.com",
        )
        // Connect to the server, authenticate, set the sender and recipient,
        // and send the email all in one step.
        err := smtp.SendMail(
                "mail.example.com:25",
                auth,
                "sender@example.org",
                []string{"recipient@example.net"},
                []byte("This is the email body."),
        )
        if err != nil {
                log.Fatal(err)
        }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-16T18:37:53.287

这里的问题是`smtp.PlainAuth`拒绝通过未加密的连接发送您的密码。这是为了保护你自己。类似的东西`smtp.CRAMMD5Auth`会是一个更好的选择。使用 CRAM-MD5 时，即使通过未加密的连接，您的密码也不会泄露。

如果您仍然想使用普通身份验证，则需要制作自己的`smtp.PlainAuth`. 幸运的是，这是一件非常容易的事情。只需从标准库中复制 20 行左右并删除：

```
if !server.TLS {
    return "", nil, errors.New("unencrypted connection")
} 
```

[http://golang.org/src/pkg/net/smtp/auth.go?s=1820:1882#L41](http://golang.org/src/pkg/net/smtp/auth.go?s=1820:1882#L41)包含代码。

如果您不想复制代码，您可以通过将函数返回的 smtp.Auth 包装在您自己的类型中来重用标准库实现。通过这种方式，您可以拦截`*smtp.ServerInfo`并欺骗实际的身份验证机制（来自标准库），即存在加密连接。确保大量评论以明确您为什么要做您正在做的事情。像这样的东西（未经测试）：

```
type unencryptedAuth struct {
    smtp.Auth
}

func (a unencryptedAuth) Start(server *smtp.ServerInfo) (string, []byte, error) {
    s := *server
    s.TLS = true
    return a.Auth.Start(&s)
}

auth := unencryptedAuth {
    smtp.PlainAuth(
        "",
        "user@example.com",
        "password",
        "mail.example.com",
    ),
} 
```

# c++ - 从 MFC 和 VS2010 中的编辑控件中读取文本

> ID：11065919
> 
> 赞同：5
> 
> 时间：2012-06-16T18:16:08.633
> 
> 标签：c++, visual-studio-2010, user-interface, mfc

我正在编写一个带有对话框窗口和一些按钮的简单 MFC 应用程序。我还添加了一个编辑控件，以便让用户插入一个文本字符串。

我想读取编辑控件中存在的值并将其存储在字符串中，但我不知道如何执行此操作。

我没有编译错误，但我总是只读一个“。” 标记。

我在文本编辑控件中添加了一个变量名，`filepath1`这是代码：

```
 // CMFC_1Dlg dialog
    class CMFC_1Dlg : public CDialogEx
    {
    // Construction
    public:
        CMFC_1Dlg(CWnd* pParent = NULL);    // standard constructor

    // Dialog Data
        enum { IDD = IDD_MFC_1_DIALOG };

        protected:
        virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support

    // Implementation
    protected:
        HICON m_hIcon;

        // Generated message map functions
        virtual BOOL OnInitDialog();
        afx_msg void OnSysCommand(UINT nID, LPARAM lParam);
        afx_msg void OnPaint();
        afx_msg HCURSOR OnQueryDragIcon();
        DECLARE_MESSAGE_MAP()
    public:
        afx_msg void OnBnClickedButton1();
        afx_msg void OnBnClickedButton2();
        afx_msg void OnEnChangeEdit1();
        CString filePath1;
    }

    //...
void CMFC_1Dlg::OnSysCommand(UINT nID, LPARAM lParam)
{
    if ((nID & 0xFFF0) == IDM_ABOUTBOX)
    {
        CAboutDlg dlgAbout;
        dlgAbout.DoModal();
    }
    else
    {
        CDialogEx::OnSysCommand(nID, lParam);
    }
}

    CMFC_1Dlg::CMFC_1Dlg(CWnd* pParent /*=NULL*/)
        : CDialogEx(CMFC_1Dlg::IDD, pParent)
        ,filePath1(("..\\Experiments\\Dirs\\"))
    {
        m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);
    }

    void CMFC_1Dlg::DoDataExchange(CDataExchange* pDX)
    {
        CDialogEx::DoDataExchange(pDX);
        DDX_Text(pDX, IDC_EDIT1, filePath1);

    }

    // then i try to get the string value with
    CString txtname=filePath1;
    _cprintf("Value %s\n", txtname); // but i always read just a "." 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-16T18:31:33.963

```
_cprintf("Value %S\n", txtname.GetString()); 
```

注意大写的“S”

或者你可以投：

```
_cprintf("Value %S\n", (LPCTSTR)txtname); 
```

最好使用编辑控件。要创建 CEdit 变量，请在 VS 中的编辑框上单击鼠标右键并选择“添加成员变量”，为变量命名并单击“确定”。

然后，您可以像这样检索编辑框中的文本：

```
CEdit m_EditCtrl;
// ....
CString filePath1 = m_EditCtrl.GetWindowText() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:17:04.217

我认为您的原始代码可以用于 DDX 和 CString。使用控制变量并避免使用 DDX/DDV 函数的建议实际上是一种偏好，而不是问题。

我怀疑您正在使用 UNICODE 库进行编译，但显式调用了 ASCII 函数`_cprintf`。UNICODE 保存为两个字节，对于 ASCII 字符，其中一个为 0。如果将其传递给 ASCII 字符串函数，它将在第一个字符之后停止。

如果您使用的是 UNICODE，则调用`_cwprintf`或使用将为编译器开关调用正确版本的`tchar.h`宏。`_tcprintf`

提示：如果您只针对 UNICODE 并且永远不需要 MBCS 支持，那么请避免使用`tchar.h`宏，因为它们会掩盖任何`char`数据`TCHAR`类型混合问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-05T01:03:38.927

第 1 步：使用“添加变量列表”创建 CEdit 控制变量。第 2 步：使用 GetDlgItemText() 保存该命令控件的文本。

示例：如CEdit控制列表变量为mc_strChatPane，则GetDlgItemText(mc_strChatPane, message) 其中message为用户定义的CString变量。

# iphone - iOS Box 应用程序是否响应自定义 URL 方案？

> ID：11065920
> 
> 赞同：0
> 
> 时间：2012-06-16T18:16:12.597
> 
> 标签：iphone, ios, ios5, url-scheme, box-api

我希望能够直接从我自己的原生 iOS 应用程序启动原生 Box iOS 应用程序。例如，Dropbox 使用`db-api-1://`、Facebook 使用`fb://`、Square 使用`square://`等。

Box for iOS 是否使用类似的 URL 方案？如果是这样，是否有文档概述了它可以解析的参数？如果没有，是否有另一种从我的应用程序启动它的方法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T18:25:29.847

我检查了应用程序的 Info.plist：

```
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLName</key>
        <string>com.box.boxapp</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>box</string>
            <string>box-login</string>
        </array>
    </dict>
    <dict>
        <key>CFBundleURLName</key>
        <string>com.box.docinteraction.upload</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>box-upload-all</string>
            <string>box-upload-all-direct</string>
        </array>
    </dict>
</array> 
```

所以总共有4个url方案：box、box-login、box-upload-all和box-upload-all-direct。但是，如果您没有任何文档，则很难使用它们...

# c - 此 C 代码中是否存在泄漏？

> ID：11065921
> 
> 赞同：1
> 
> 时间：2012-06-16T18:16:22.613
> 
> 标签：c, malloc

此 C 代码中是否存在泄漏？
虽然答案是正确的，但只是想知道这样写是否可以：

```
// _mm_adds_epi16 : Adds the 8 signed 16-bit integers in a to the 8 signed 
//16-bit integers in b and saturates
__m128i t7=_mm_adds_epi16(  t5 ,t6  );
unsigned short *p= (unsigned short *)malloc(8);
p=(unsigned short *)&t7;
for(int i=0;i<8;i++)
{
    printf("%d\n", p[i]);
} 
```

**更新**

所以现在我将其更新如下：

```
// _mm_adds_epi16 : Adds the 8 signed 16-bit integers in a to the 8 signed 
//16-bit integers in b and saturates
__m128i t7=_mm_adds_epi16(  t5 ,t6  );
unsigned short *p= (unsigned short *)malloc(8);
p=(unsigned short *)&t7;
for(int i=0;i<8;i++)
{
    printf("%d\n", p[i]);
}

 free(p); 
```

我还有泄漏吗？

**打印t7的正确方法是什么**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-16T18:18:19.427

是的，有泄漏。您立即覆盖存储动态分配内存地址的指针。因此，该内存不再可访问。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-16T18:18:21.897

C 中的每一个都`malloc`需要有一些对应`free`的，在终止之前可以到达。对此的任何异常都会构成内存泄漏。

您存储`malloc`in的返回值`p`并通过覆盖它来丢失指针。因此，指针没有机会被释放。在您的特定情况下，它`malloc`本身是多余的，因为您没有以任何方式使用 return。

* * *

在回答您关于新代码是否存在内存泄漏的问题时，是的。`malloc`分配内存并返回一个指向已分配内存的指针。您通过覆盖指针的值然后从不使用分配的内存来丢失指针。更糟糕的是，您现在正在调用`free`似乎是未定义行为的自动变量。

如果打印工作正常，您可以这样做：

```
__m128i t7 = _mm_adds_epi16(t5, t6);
unsigned short *p = (unsigned short *)&t7;
for(int i=0;i<8;i++) {
    printf("%d\n", p[i]);
} 
```

这`malloc`是多余的，因为您甚至没有使用它分配的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T19:08:23.023

`free`将释放由`malloc`.

```
unsigned short *p= (unsigned short *)malloc(8); 
```

在这里，您分配了 8 个字节的内存并将该内存地址分配给`p`.

```
p=(unsigned short *)&t7; 
```

您刚刚分配了一个不同的内存地址给`p`; 先前的内存地址（由 返回的地址`malloc`）已被覆盖。我们不再知道分配了 8 个字节的内存地址。

```
free(p); 
```

内存泄漏。它不再指向分配的内存`malloc`。

# ios - UIButton 的 setTitleShadowOffset 已弃用

> ID：11065928
> 
> 赞同：3
> 
> 时间：2012-06-16T18:17:52.053
> 
> 标签：ios, uibutton, customization

我正在使用`UIButton`的外观代理来自定义`UIButtons`我的应用程序中的所有内容。一切运行良好——我可以设置自定义图像、文本颜色和阴影颜色。只有一件事困扰着我。为了设置阴影偏移，我使用了这段代码：

```
[[UIButton appearance] setTitleShadowOffset:CGSizeMake(1, 1)]; 
```

它正在工作。但是文档说不`setTitleShadowOffset:`推荐使用，而是我们应该使用`shadowOffset`titleLabel 的属性。我试过这样：

```
[[[UIButton appearance] titleLabel] setShadowOffset:CGSizeMake (1.0, 1.0)]; 
```

但它不起作用。我可以在不使用已弃用方法的情况下设置阴影偏移吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T20:33:09.677

尝试：

```
[[UILabel appearanceWhenContainedIn:[UIButton class], nil]
    setShadowOffset:CGSizeMake(1.0, 1.0)]; 
```

（`[[UILabel appearance] setShadowOffset:CGSizeMake(1.0, 1.0)];`也应该有效，但可能有点过分了，因为它会影响所有人`UILabels`，而不仅仅是`UIButtons`.)

# google-app-engine - 使用 Objectify Cursors 时 GWT 如何在 DataGrid 中设置寻呼机

> ID：11065932
> 
> 赞同：1
> 
> 时间：2012-06-16T18:18:28.553
> 
> 标签：google-app-engine, gwt, objectify

我最近达到了可以使用光标检索数据的地步（请参阅此链接：[GWT pass Objectify Cursor from Server to Client with RequestFactory and show more pages in DataGrid](https://stackoverflow.com/questions/11058737/gwt-pass-objectify-cursor-from-server-to-client-with-requestfactory-and-show-mor)）

我遇到了什么 - 当我在客户端获取数据包时，它只有一个 25 个列表 - 当我在 DataGrid 中设置数据时，底部的寻呼机显示 25 个中的 1-25 个，显然还有更多数据库中的记录我一次只用光标检索其中的 25 个

我尝试做的是设置以下内容：

```
pager.setRangeLimited(false); 
```

不幸的是——虽然这允许我从数据库中分页和选择更多——但它实际上从来没有给我数据库中的数量。我想知道的是，如果我在服务器端使用光标 - 我如何设置寻呼机中的总数？

我想做的一件事就是简单地向我返回的 ListCursor 包装器对象添加一个总计数变量 - 不幸的是，这将要求如果我使用空初始查询请求它，我每次都要经过并获得总计数 - 这似乎效率极低——一旦我把它拿回来，我仍然不知道如何实际告诉寻呼机可用的数据比我实际提供的数据多。

对此的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T19:51:02.097

通过告诉寻呼机行数是准确的，您可以在寻呼机中设置总计数：

```
asyncDataProvider.updateRowCount(int size, boolean exact); 
```

如果您不告诉寻呼机行数是准确的，那么您显然无法导航到最后一页。

核心问题是如何掌握总行数。查询行数确实非常低效。更好的选择是在数据存储中保留一个计数器来跟踪记录的数量。这也可能非常低效，因为你有这个计数器同步/事务的增量。

在我的项目中，我不跟踪确切的行数，但我提供了灵活的搜索选项。

# c# - MaskedTextBox 继承自定义 EventHandler

> ID：11065935
> 
> 赞同：0
> 
> 时间：2012-06-16T18:18:47.973
> 
> 标签：c#, winforms

我已经构建了一个 Custom `MaskedTextBox`，更改了 和 的值，`BeepOnError`并`AsciiOnly`为 . 添加了一个客户 EventHandler `MaskInputRejected`。我构建了这个类，当我把它放在我的表单上时，我添加到自定义类的自定义属性会出现，但是对和
的更改不会，自定义 EventHandler 也不会触发。 `BeepOnError``AsciiOnly`

有人可以指出我做错了什么吗？如果我手动将 EventHandler 添加到表单中，它可以正常工作。

自定义类；

```
public partial class BaseMaskedTextBox : MaskedTextBox
{
    public string gsOrigValue { get; set; }
    public string gsReadOnlyMode { get; set; }
    public bool gbIsString { get; set; }
...
    private void BaseMaskedTextBox_MaskInputRejected(Object sender, MaskInputRejectedEventArgs e)
    {
        System.Text.StringBuilder messageBoxCS = new System.Text.StringBuilder();
        messageBoxCS.AppendFormat("{0} = {1}", "Character Position", e.Position);
        messageBoxCS.AppendLine();
        messageBoxCS.AppendFormat("{0} = {1}", "Reason Rejected", e.RejectionHint);
        messageBoxCS.AppendLine();
        MessageBox.Show(messageBoxCS.ToString(), "Input Mask Invalid...");
    } 
```

在`InitializeComponent(`）：

```
this.BaseMaskedTextBox1.AsciiOnly = <b>true</b>;
this.BaseMaskedTextBox1.BeepOnError = <b>true</b>;
this.BaseMaskedTextBox1.Font = new System.Drawing.Font("Microsoft Sans Serif", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
this.BaseMaskedTextBox1.Location = new System.Drawing.Point(0, 0);
this.BaseMaskedTextBox1.Name = "BaseMaskedTextBox1";
this.BaseMaskedTextBox1.Size = new System.Drawing.Size(100, 21);
this.BaseMaskedTextBox1.TabIndex = 0;
this.BaseMaskedTextBox1.MaskInputRejected += new System.Windows.Forms.MaskInputRejectedEventHandler(this.BaseMaskedTextBox_MaskInputRejected);
this.ResumeLayout(false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:36:00.710

我只是将其作为自定义组件进行了尝试，然后将 CustomTextBox 拖放到了 FORM 上。它确实将其正确设置为`true`. 我检查了设计器。此外，拖放后添加事件处理程序。有用。请参阅下面的代码。

```
public partial class CustomTextBox : MaskedTextBox
{
    public CustomTextBox()
    {
        InitializeComponent();

        this.BeepOnError = true;
        this.AsciiOnly = true;
        this.MaskInputRejected += new MaskInputRejectedEventHandler(CustomTextBox_MaskInputRejected);
    }
    /// <summary>
    /// Alas this event is not virtual in the base MS class like other events. Hence,
    /// we have to mark it as virtual now
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
   public virtual void CustomTextBox_MaskInputRejected(object sender, MaskInputRejectedEventArgs e)
    {
        System.Text.StringBuilder messageBoxCS = new System.Text.StringBuilder();
        messageBoxCS.AppendFormat("{0} = {1}", "Character Position", e.Position);
        messageBoxCS.AppendLine();
        messageBoxCS.AppendFormat("{0} = {1}", "Reason Rejected", e.RejectionHint);
        messageBoxCS.AppendLine();
        MessageBox.Show(messageBoxCS.ToString(), "Input Mask Invalid...");
    } 
```

}

`// Derive a class like this and override the event where you delegate the request to the base class`

```
 public class MyMaskedBox : CustomTextBox
    {
        public override void CustomTextBox_MaskInputRejected(object sender, MaskInputRejectedEventArgs e)
        {
            base.CustomTextBox_MaskInputRejected(sender, e);
        }
    } 
```

在表单上，​​现在拖放`MyMaskedBox`，添加一个掩码说`Numeric (5-Digits)`并尝试输入字符。基类处理程序 ie of`CustomTextBox`将被调用，您将看到在基类中添加的 MessageBox。

**这将解决您的问题，您现在将实现所需的功能。**

# c++ - 提升程序选项 - 获取部分中的所有条目

> ID：11065938
> 
> 赞同：7
> 
> 时间：2012-06-16T18:19:01.703
> 
> 标签：c++, boost-program-options

根据文档，我可以解析样式中的配置文件：

```
 [main section]
 string = hello world. 
 [foo]
 message = Hi ! 
```

但我需要解析插件列表：

```
 [plugins]
 somePlugin. 
 HelloWorldPlugin
 AnotherPlugin
 [settings]
 type = hello world 
```

如何获取插件部分中的字符串向量？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-16T22:49:30.637

对于 boost 程序选项配置文件，如果该行没有声明一个部分，例如`[settings]`，那么它需要是一个`name=value`格式。对于您的示例，将其编写如下：

```
[插件]
名称 = somePlugin
名称 = HelloWorldPlugin
名称 = 另一个插件
[设置]
类型=你好世界
```

插件列表现在将对应于“plugins.name”选项，它需要是一个多令牌选项。

下面是一个从 settings.ini 文件中读取上述设置的示例程序：

```
#include <boost/program_options.hpp>
#include <iostream>
#include <fstream>
#include <string>
#include <vector>

int main()
{
  namespace po = boost::program_options;

  typedef std::vector< std::string > plugin_names_t;
  plugin_names_t plugin_names;
  std::string settings_type;

  // Setup options.
  po::options_description desc("Options");
  desc.add_options()
    ("plugins.name", po::value< plugin_names_t >( &plugin_names )->multitoken(),
                     "plugin names" )
    ("settings.type", po::value< std::string >( &settings_type ),
                      "settings_type" );

  // Load setting file.
  po::variables_map vm;
  std::ifstream settings_file( "settings.ini" , std::ifstream::in );
  po::store( po::parse_config_file( settings_file , desc ), vm );
  settings_file.close();
  po::notify( vm );    

  // Print settings.
  typedef std::vector< std::string >::iterator iterator;
  for ( plugin_names_t::iterator iterator = plugin_names.begin(),
                                      end = plugin_names.end();
        iterator < end;
        ++iterator )
  {
    std::cout << "plugin.name: " << *iterator << std::endl;
  }
  std::cout << "settings.type: " << settings_type << std::endl;

  return 0;
} 
```

产生以下输出：

```
plugin.name: somePlugin
插件名称：HelloWorldPlugin
plugin.name: 另一个插件
settings.type：你好世界
```

# iphone - SizeToFit 导航栏项 (UITextField)

> ID：11065942
> 
> 赞同：0
> 
> 时间：2012-06-16T18:19:23.170
> 
> 标签：iphone, uitextfield, uinavigationbar

如何调整 UITextField 的大小以适应整个 UINavigationBar？到目前为止，我有这个：

```
 locationField = [[UITextField alloc] initWithFrame:CGRectMake(37,7,246,31)];
    locationField.delegate = self;
    locationField.autoresizingMask = UIViewAutoresizingFlexibleWidth;
    locationField.textColor = [UIColor colorWithRed:102.0/255 green:102.0/255 blue:102.0/255 alpha:1.0];
    locationField.textAlignment = UITextAlignmentLeft;
    locationField.borderStyle = UITextBorderStyleRoundedRect;
    locationField.font = [UIFont fontWithName:@"Helvetica" size:15];
    locationField.autocorrectionType = UITextAutocorrectionTypeNo;
    locationField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter; 
```

我基本上想转向`locationField = [[UITextField alloc] initWithFrame:CGRectMake(37,7,246,31)];`适合 UINavigationBar，可能正在使用`sizeToFit`，只是不是 100% 确定如何实现它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T21:31:53.903

你可以试试

```
[self.navigationItem setTitleView:locationField]; 
```

请参见下面的代码：

```
 UITextField *locationField = [[UITextField alloc] initWithFrame:CGRectMake(37,7,246,31)];
    locationField.delegate = self;
    locationField.autoresizingMask = UIViewAutoresizingFlexibleWidth;
    locationField.textColor = [UIColor colorWithRed:102.0/255 green:102.0/255 blue:102.0/255 alpha:1.0];
    locationField.textAlignment = UITextAlignmentLeft;
    locationField.borderStyle = UITextBorderStyleRoundedRect;
    locationField.font = [UIFont fontWithName:@"Helvetica" size:15];
    locationField.autocorrectionType = UITextAutocorrectionTypeNo;
    locationField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
    [self.navigationItem setTitleView:locationField];
    [locationField release]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T17:27:16.497

没关系，通过从以下位置切换 CGRect 来修复它：

```
UITextField *locationField = [[UITextField alloc] initWithFrame:CGRectMake(37,7,246,31)]; 
```

至

```
UITextField *locationField = [[UITextField alloc] initWithFrame:CGRectMake(37,7,300,31)]; 
```

# ruby-on-rails - 如何在rails 3中按两个条件分组并循环它们

> ID：11065945
> 
> 赞同：4
> 
> 时间：2012-06-16T18:19:40.037
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, group-by

好的，所以我有一个销售模型

```
recent_sales = Sale.recent
 => [#<Sale id: 7788, contact_id: 9988, purchasing_contact_id: 876, event_id: 988, #<BigDecimal:7fdb4ac06fe8,'0.0',9(18)>, fulfilled_at: nil, skip_print: nil, convention_id: 6, refund_fee: #<BigDecimal:7fdb4ac06de0,'0.0',9(18)>, processing: false>, #<Sale id: 886166, , contact_id: 7775,

recent_sales.count
=> 32 
```

我知道我能做到

```
grouped_sales = recent_sales.group_by(&:contact_id).map {|k,v| [k, v.length]}
=> [[9988, 10], [7775, 22]] 
```

但我真正需要的不仅仅是在contact_id上分组，还有event_id，所以最终结果看起来像这样

```
=> [[9988, 988, 5], [9988, 977, 5], [7775, 988, 2], [7775, 977, 20]] 
```

所以我有 event_id 并且分组正确地将它们分开......关于如何做到这一点的任何想法

我试过了

```
 recent_sales.group('contact_id, event_id').map {|k,v| [k, k.event, v.length]} 
```

但不行

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-16T22:42:29.033

```
grouped_sales = recent_sales.group_by { |s| [s.contact_id, s.event_id] }
                .map { |k,v| [k.first, k.last, v.length] } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-03T06:44:09.997

简单，试试

```
group(['contact_id','event_id']) 
```

它对我有用。因此，我也发布了帮助他人的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-10T22:40:29.653

要求数据库进行分组

```
grouped_sales = recent_sales.group([:contact_id, :event_id]).count 
```

结果是散列，每个键是联系人和事件 ID 的数组，值是计数。

所以如果你想要三个数组

```
grouped_sales = recent_sales.group([:contact_id, :event_id]).count.map{ |k,v| k << v } 
```

# ios - 用 UIDatePicker 替换 UITextField 输入

> ID：11065946
> 
> 赞同：7
> 
> 时间：2012-06-16T18:19:59.877
> 
> 标签：ios, uitextfield, modal-dialog, uidatepicker

我有一个表格视图控制器（其中包括一个代表日期的单元格）。我关注了这篇文章“[如何制作一个只覆盖一半屏幕的模态日期选择器？](https://stackoverflow.com/questions/8484147/how-do-i-make-a-modal-date-picker-that-only-covers-half-the-screen) ”我让它在一个很大的例外情况下工作——我不能让选择器消失！

我尝试注册事件 UIControlEventTouchUpOutside，但似乎这不是由选择器生成的（或者至少在我使用它的模式下）。

如何识别用户已完成日期选择？

另外，有没有办法禁止用户直接输入 UITextField？我想强迫他们使用选择器。我看到了这篇文章“[在 UITextField 中禁用闪烁光标？](https://stackoverflow.com/questions/11065946/replacing-uitextfield-input-with-a-uidatepicker) ”，但还有其他方法吗？

问候，

- 约翰

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-16T19:37:08.480

试试这个代码..这里我把一个日期选择器放到一个uitextfield ..它会在右上角的导航栏有一个完成按钮..所以通过点击完成我将用户可以关闭日期选择器..另一个最好的方法是把具有完成按钮的日期选择器上方的工具栏..试试这个它会起作用..更改日期选择器时，您可以填充文本字段..希望这会有所帮助..

请参阅此 stackoverflow 链接[https://stackoverflow.com/a/4824319/763747](https://stackoverflow.com/a/4824319/763747) 这将具有带有完成按钮的日期选择器作为键盘上方的工具栏。

```
#pragma mark -
#pragma mark - TextField Delegate

- (BOOL)textFieldShouldReturn:(UITextField *)textField 
{
    [textField resignFirstResponder];
    return TRUE;
}

- (void) textFieldDidBeginEditing:(UITextField *)textField {
    itsRightBarButton.title  = @"Done";
    itsRightBarButton.style = UIBarButtonItemStyleDone;
    itsRightBarButton.target = self;
    itsRightBarButton.action = @selector(doneAction:);
    if ([textField isEqual:itsIncidentDateTextField])
    {
        itsDatePicker = [[[UIDatePicker alloc] init] autorelease];
        itsDatePicker.datePickerMode = UIDatePickerModeDate;
        [itsDatePicker addTarget:self action:@selector(incidentDateValueChanged:) forControlEvents:UIControlEventValueChanged];
        //datePicker.tag = indexPath.row;
        textField.inputView = itsDatePicker;
    }
}

- (IBAction) incidentDateValueChanged:(id)sender{
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"MMM d, yyyy"];
    itsIncidentDateTextField.text = [dateFormatter stringFromDate:[itsDatePicker date]];
    [dateFormatter release];
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-12-15T18:56:39.960

我使用了另一种方法来消除 UIDatePicker。

创建一个 XIB (nib) 文件并向其中添加一个 UIDatePicker，然后调整视图大小，使其仅适合 UIDatePicker，在您的 ViewController（或您使用的任何类，当然是合成）中创建一个属性（使其强大且非原子）。

```
@property (nonatomic, strong) UIView *myDatePickerView;  
@synthesize myDatePickerView; 
```

然后创建一个**loadDatePickerView 方法**

```
- (void) loadDatePickerView
{
    UINib *nib = [UINib nibWithNibName:kNIBname bundle:[NSBundle mainBundle]];
    NSArray *views = [nib instantiateWithOwner:self options:nil];
    self.myDatePickerView = [views firstObject];
    [myDatePickerView setFrame:CGRectMake(0, 318, 320, 162)];
    [self.view addSubview:myDatePickerView];
} 
```

实现 UITextFieldDelegate，并在**textFieldDidBeginEditing 方法中调用 loadDatePickerView 方法**，

```
[self loadDatePickerView]; 
```

使函数创建一个属性，它是一个**UIDatePicker 实例**

```
@property (nonatomic,strong) 

UIDatePicker *myDatePicker; 
```

（当然是合成）

现在像这样创建一个**IBAction**：

```
-(IBAction)datePickerValueChanged:(UIDatePicker *)sender
{
    myDatePicker = [[myDatePickerView subviews] lastObject];
    //now you can do whatever you want with the DatePicker
} 
```

现在将 IBAction 连接到 XIB 文件中的选择器，这样 XIB 现在是您在 VC 中创建的 UIDatePicker 实例，如果您希望它消失，您可以添加一个**UITapGestureRecognizer（在 ViewDidLoad 中）**，选择器将是另一个 IBAction它将 myDatePickerView 从它的 superView 中删除，如下所示：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self     action:@selector(dropPicker:)];
    [self.view addGestureRecognizer:tap];
    [self datePickerValueChanged:myDatePicker];
}

-(IBAction)dropPicker:(id)sender
{
    [myDatePickerView removeFromSuperview];
} 
```

# android - Eclipse 不会更新或安装软件

> ID：11065948
> 
> 赞同：2
> 
> 时间：2012-06-16T18:20:18.083
> 
> 标签：android, eclipse, eclipse-plugin, subversive

我最近在我的机器上安装了颠覆。所以我决定为 Eclipse 安装 Subversive，这样我就可以检查我的 Android 项目。问题是，它会达到一定的百分比，比如 49%，然后就坐在那里。我给它几个小时和几个小时的时间，它一动不动。我想我会尝试更新 Eclipse 以查看是否有帮助，但我什至无法更新它。完全相同的事情也会发生。我试过以管理员身份运行它，更改网络设置，但没有运气。非常感谢您对此的任何帮助。

这是 Subversive 安装当前停留的位置：

![在此处输入图像描述](../Images/cd399a029a1ae995fa75730a96f17601.png)

# c - 如何存储联系信息

> ID：11065950
> 
> 赞同：0
> 
> 时间：2012-06-16T18:20:46.150
> 
> 标签：c, data-structures, trie

存储联系信息 [姓名、电话号码] 的最佳数据结构是什么？

***给出姓名时， Trie***可用于搜索电话号码。
如果我想根据他的电话号码找到一个人的名字怎么办。即当我知道电话号码时如何找到姓名？
**trie 对这种搜索有效吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T02:30:26.487

是的，试一试很好。您可以使用电话号码中的位（如果您将它们存储为整数），而不是使用字符串中的字符作为每个级别的键。出于速度原因，您可能决定一次使用 3 或 4 位。

这将通过拥有一个存储当前身份信息的 trie 结构和一个指向子 trie 结构的指针数组来工作。

```
struct phone_number_trie {
   struct contact_info *info;
   struct phone_number_trie *children[4]; //  or 2, 8 or 16 etc.
}; 
```

例如，将电话号码“83”（`1100011`二进制）存储在根为 的树中`root`，您可能会屏蔽低 2 位（例如`& 3`），即`11`，因此您将递归到`root->children[3]`电话号码的剩余位`11000`（即向右移动 2）。下一个索引是`0`,`10`然后是`1`（所以你会指向`root->children[3]->children[0]->children[2]->children[1]`）。此时，您的电话号码中没有任何设置位，因此您找到了正确的插入位置。

（您也可以考虑使用[Patricia trie](https://en.wikipedia.org/wiki/Patricia_trie)，但这很难实现。）

# c# - 如何计算每日总数？

> ID：11065951
> 
> 赞同：-3
> 
> 时间：2012-06-16T18:20:56.990
> 
> 标签：c#, arrays, list

我有这段代码及其工作，但我希望它返回`dailyTotals`具有四个值的列表，目前它正在返回三个值......我似乎无法弄清楚如何让它返回`dailyTotals`四个值。顺便说一句，`billTotals`和`dateList`的长度相同，目前为 7 并且它们会增长。`billTotals`并且`dateList`将始终保持相同的长度

```
List<double> dailyTotals = new List<double>();

        string dateValue = "";
        double oneDayTotal = 0;
        int n = 0;

        for (int i = 0; i < billTotals.Count; i += n)
        {
            dateValue = dateList[i];
            oneDayTotal = 0;

            while (dateValue == dateList[n])
            {
                oneDayTotal += billTotals[n];

                n++;
            }

            dailyTotals.Add(oneDayTotal);
        }

        return dailyTotals; 
```

[编辑]：对不起，我应该在之前写这个：/在数据库中我有 billTotals 和存储的每张账单的日期。因此，一个日期可以有多个与之关联的账单。我想要做的是获取一个月的数据并总结每一天的总数。所以我在while循环中使用的逻辑应该在日期相同的情况下总结总数......我希望这会使场景更加清晰。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:25:56.713

您永远不会重置 n，因此您将 i 增加的数量越来越大，从而跳过了一些数字。

您需要`n = 0`在循环内设置。

```
int n = 0;
for (int i = 0; i < billTotals.Count; i += n)
{
    dateValue = dateList[i];
    oneDayTotal = 0;

    n = 0;  // This counts the number of equal dates.
    while (i + n < dateList.Length && dateValue == dateList[i + n])
    {
        oneDayTotal += billTotals[i + n];
        n++;
    }

    dailyTotals.Add(oneDayTotal);
}

return dailyTotals; 
```

您还可以完全重写代码以简化它并避免这种增加循环变量的奇怪方式。我建议创建一个包含日期和总数的对象数组，然后您可以使用 LINQ 来解决您的问题，而无需任何复杂的循环：

```
var dailyTotals = datesAndTotals
    .GroupBy(x => x.Date)
    .Select(g => g.Sum(x => x.BillTotal))
    .ToList(); 
```

您也可以使用`Zip`而不是创建单独的类，尽管使用该类会更具可读性。

# certificate - 我可以在 J2ME 中使用自签名应用程序而不是使用昂贵的数字证书吗？

> ID：11065953
> 
> 赞同：2
> 
> 时间：2012-06-16T18:21:13.780
> 
> 标签：certificate, java-me, midp, digital-certificate

自 JDK 1.1 以来我一直在使用 java。几天前，我以 33 美元的价格购买了一部便宜的中国 Java 手机。我开始学习 midlets 编程。在几个小的 midlets 之后，我开始使用移动设备研究真正的盖革计数器。

互联网上已经有许多使用手机摄像头实现此目的的安卓应用程序。当相机镜头被黑色胶带覆盖时，光线无法通过。但是，如果任何放射性样品放在相机附近，β 和 γ 射线就会通过，相机传感器会给出一些读数。虽然看不到图片，从alpha、r、g。b 值可以关联实际累积剂量。我的想法是每秒至少拍摄 4 张快照，平均每分钟读取 240 张照片以获得正确读数。

但是这个应用程序需要获得快照的权限，而且我需要写权限，所以，我必须在这个数字上签名。

我开始知道那分钟。Thwate 的数字证书费用为每年 129 美元，而 Verisign 的数字证书费用为每年 331 美元。

不幸的是，我的手机无法添加其他根证书，因为 GoDaddy 每年仅提供 19 美元的证书。

与其花这么多钱，不如买个安卓手机，我能买到 90 美元左右（MicroMax A 50）。我已确保 android 应用程序可以自签名。

但在出于这个原因离开 J2ME 之前，我想知道是否有任何方法可以运行自签名应用程序。

我认为所有 J2ME 开发人员都应该向 Oracle 施压，要求他们推出允许自签名中间件的 Java VM。（任何方式应用程序都在向用户请求许可）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T12:58:38.070

Some mobiles supports adding self signed.It is vendor and model dependent.
In Nokia s60 devices we can add self signed certificates which is used to sign midlet.
Nokia s40 device does not support self signed certificate.
Better you visit the vendor's website for further details

# bash - 从 .bashrc 启动后台进程

> ID：11065954
> 
> 赞同：5
> 
> 时间：2012-06-16T18:21:21.393
> 
> 标签：bash, putty

我意识到这可能是一个愚蠢的问题，但即使彻底挖掘了 stackoverflow 网站和谷歌，我也无法解决几个小时。

这是 .bashrc 中的基本代码，用于在我登录 shell 后启动 gkrellm

```
if ps ax | grep -v grep | grep gkrellm > /dev/null
then
    echo "gkrellm is already running"
else
    command gkrellm &
fi 
```

我已经尝试过

```
...
else
    nohup gkrellm &
fi
... 
```

和

```
...
else
    gkrellm
    $GK_PID=`pidof gkrellm`
    disown -h $GK_PID
fi
... 
```

gkrellm 被正确地作为后台作业，我可以使用 shell（如预期的那样）。但是，即使我从同一个 shell 启动其他应用程序，一旦按下 Ctrl-c，我仍然会退出 gkrellm。如何防止 gkrellm 在 Ctrl-c 按下时关闭？

以防万一。我正在使用名为 KiTTY 的 PuTTY 克隆，但相信这不是问题。

感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-09T09:33:16.087

在很久以前找到一个可行的解决方案后几乎忘记了这个问题并回答了我自己的问题；）多年来，Follow 在我的 .bashrc 中效果很好

```
mygkrellm()
{
    if pidof -x "gkrellm" >/dev/null; then
    echo "Gkrellm is already running. Go to shell!"       
    else
    nohup "/usr/bin/gkrellm" &
    fi
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T23:29:53.580

使用*bash* ( `disown`and `&>/dev/null`)
你需要在 bg ( `gkrellm &`) 中运行应用程序，然后`disown`它

```
if ps -C gkrellm -o user | grep "$LOGNAME" &>/dev/null 
then echo "gkrellm is already running"
else gkrellm & disown
fi 
```

如果您想更便携并使用*posix sh*
，您将需要使用`nohup`（`coreutils`POSIX 的一部分）
以及背景它（`nohup cmd &`）
，您也可以使用*`.profile`*而不是*`.bashrc`*

```
if ps -C gkrellm -o user | grep "$LOGNAME" 2>/dev/null 1>&2
then echo "gkrellm is already running"
else nohup gkrellm &
fi 
```

* * *

其他方法将包括 - 正如@Pontus 回答的那样 - 使用或等工具`dtach`，其中命令在分离的环境中执行。`screen``tmux`

> *by Pontus*：
> 使用窗口管理器的自动启动功能会更有意义

确实:) 因为 afaik`gkrellm`是一个 GUI 应用程序，所以最好使用*`.xinitrc`*（如果您的登录管理器支持它）或您的窗口管理器的自动启动工具来自动启动它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-16T20:27:56.463

尝试用这个替换“nohup gkrellm &”：

```
screen -S gkrellm -d -U -m gkrellm 
```

这将启动一个运行 gkrellm 的分离屏幕会话，它不会关心当前的 shell 会话。我不确定从 .bashrc 启动它是否是最好的解决方案，但使用窗口管理器的自动启动功能会更有意义。

编辑：不确定我是否正确阅读了问题，您是否使用 KiTTY 连接到 linux 主机并通过 X 转发远程运行 gkrell？如果是这种情况，您显然不能使用窗口管理器功能。:)

# ruby-on-rails - Rails has_one 和 belongs_to 迁移？

> ID：11065959
> 
> 赞同：2
> 
> 时间：2012-06-16T18:22:10.203
> 
> 标签：ruby-on-rails, migration, belongs-to, has-one

我正在尝试在 Rails 中的两个模型之间建立关系，但我无法弄清楚我在迁移中需要做什么。任何帮助深表感谢。

我希望每个企业都有一个类型/类别，例如“汽车”或“餐厅和酒吧”。

业务.rb：

```
class Business < ActiveRecord::Base
  has_one :category, :foreign_key => "cid"
  attr_accessible :description, :email, :facebook, :foursquare, :google, :manager,
  :mobile, :name, :phone, :url, :yelp
end 
```

类型.rb：

```
class Type < ActiveRecord::Base
  attr_accessible :cid, :category
  belongs_to :business
end 
```

CreateTypes 迁移文件：

```
class CreateTypes < ActiveRecord::Migration
  def change
    create_table :types do |t|
      t.integer :cid
      t.string :category
      t.references :business

      t.timestamps
    end
  add_index :types, :cid
 end
end 
```

CreateBusinesses 迁移文件：

```
class CreateBusinesses < ActiveRecord::Migration
  def change
    create_table :businesses do |t|
      t.string :name
      t.string :url
      t.string :phone
      t.string :manager
      t.string :email
      t.boolean :mobile
      t.boolean :foursquare
      t.boolean :facebook
      t.boolean :yelp
      t.boolean :google
      t.text :description
      t.integer :cid

      t.timestamps
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-16T18:48:17.087

遵循 Rails 命名约定对您来说是最容易的。如果我理解正确，则企业属于类型/类别。让业务引用类型。在业务方面添加belongs_to，在类型/类别方面添加has_many。大致是这样的：

```
class Business < ActiveRecord::Base
  attr_accessible :description, :email, :facebook, :foursquare, :google, :manager, :mobile, :name, :phone, :type_id, :url, :yelp
  belongs_to :type
end

class Type < ActiveRecord::Base
  has_many :businesses
end

class CreateTypes < ActiveRecord::Migration
  def change
    create_table :types do |t|
      t.string :category

      t.timestamps
    end
  end
end

class CreateBusinesses < ActiveRecord::Migration
  def change
    create_table :businesses do |t|
      t.string :name
      t.string :url
      t.string :phone
      t.string :manager
      t.string :email
      t.boolean :mobile
      t.boolean :foursquare
      t.boolean :facebook
      t.boolean :yelp
      t.boolean :google
      t.text :description
      t.integer :type_id

      t.timestamps
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:30:46.597

您的`businesses`表必须具有整数字段`cid`，因为您将其设置为外键。你`types`的表不能有`cid`字段。该`types.id`字段将用于创建关系。请注意，该`belongs_to`方法没有`foreign_key`选项，您应该将其从其调用中删除。

我可以建议您不要无故更改外键名称。如果不指定外键，则默认为`type_id`.

# ruby - Ruby `split'：UTF-8 中的无效字节序列（ArgumentError）

> ID：11065962
> 
> 赞同：22
> 
> 时间：2012-06-16T18:22:23.403
> 
> 标签：ruby, character-encoding, argument-error

我正在尝试填充电影对象，但是在解析`u.item`文件时出现此错误：

> `split'：UTF-8 中的无效字节序列（ArgumentError）

```
File.open("Data/u.item", "r") do |infile|
            while line = infile.gets
                line = line.split("|")
            end
end 
```

该错误仅在尝试使用花哨的国际标点符号分割行时发生。

这是一个示例

> 543|悲惨世界 (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Mis%E9rables%2C%20Les%20%281995%29|0|0| 0|0|0|0|0|0|1|0|0|0|1|0|0|0|0|0|0

有解决办法吗？？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-17T14:07:48.617

我不得不将每一行的编码强制为 iso-8859-1（这是欧洲字符集）... [http://en.wikipedia.org/wiki/ISO/IEC_8859-1](http://en.wikipedia.org/wiki/ISO/IEC_8859-1)

```
a=[]
IO.foreach("u.item") {|x| a << x}
m=[]
a.each_with_index {|line,i| x=line.force_encoding("iso-8859-1").split("|"); m[i]=x} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-16T18:42:12.937

Ruby 对字符编码问题有些敏感。你可以做很多事情来解决你的问题。例如：

1.  将编码注释放在源文件的顶部。

    ```
    # encoding: utf-8 
    ```

2.  在拆分之前显式编码您的行。

    ```
    line = line.encode('UTF-8').split("|") 
    ```

3.  替换无效字符，而不是引发 Encoding::InvalidByteSequenceError 异常。

    ```
    line.encode('UTF-8', :invalid => :replace).split("|") 
    ```

试一试这些建议，如果它们都不适合您，请更新您的问题。希望能帮助到你！

# algorithm - 可以通过六次比较按中位数划分五个元素吗？

> ID：11065963
> 
> 赞同：4
> 
> 时间：2012-06-16T18:22:24.430
> 
> 标签：algorithm, sorting, selection, median

给定五个随机元素，只需进行六次比较就可以找到中位数。但我有一个额外的要求，即还满足以下条件：

a < c && b < c && c < d && c < e

a < b 或 d < e 不需要。

我已经能够使用**七次**比较来满足这个条件，但不是六次。这是我的代码，应该是不言自明的：

```
void medianSort(int[] arr)
{
    assert(arr.length == 5);

    void sortPair(ref int a, ref int b)
    {
        if(a > b) swap(a, b);
    }

    sortPair(arr[0], arr[1]);
    sortPair(arr[3], arr[4]);
    sortPair(arr[0], arr[3]);
    sortPair(arr[1], arr[4]);
    sortPair(arr[2], arr[3]);
    sortPair(arr[1], arr[2]);
    sortPair(arr[2], arr[3]);
} 
```

我有一个快速排序，我希望通过使用 5 的中位数来选择枢轴来增强它。通过满足该条件，五个元素已经排序。

是否有可能在六次比较中完成这一点，还是我能做到最好的七次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T19:04:06.730

我花了两个小时解决这个问题，但我找到了解决方案。重要的是要跟踪所做的比较，我在评论中做了非常详细的比较。该函数用 D 编写。

```
void medianSort(alias pred = "a < b", T)(ref T a, ref T b, ref T c, ref T d, ref T e)
{
    alias binaryFun!pred less;
    bool greater(T a, T b){ return !less(a, b); }

    if(greater(a, b)) swap(a, b); // #1
    // a<b
    if(greater(d, e)) swap(d, e); // #2
    // a<b d<e

    if(less(a, d)) // #3
    {
        // a<d<e a<b
        // eliminate a
        // d<e
        if(greater(b,c)) swap(b,c); // #4
        // b<c d<e
    }
    else // if(less(d, a))
    {
        // a<b d<a d<e
        // d<a<b   d<e
        swap(a, d);
        // a<d<b   a<e
        // eliminate a
        // d<b
        swap(d, b);
        // b<d
        if(greater(c, e)) swap(c, e); // #4
        // b<d c<e
        swap(c, d);
        // b<c d<e
    }

    // b<c d<e
    if(less(b, d)) // #5
    {
        // b<c b<d d<e
        // b<c b<d<e
        // eliminate b
        // d<e
    }
    else
    {
        // b<c d<e d<b
        // d<b<c d<e
        swap(b, d);
        // b<d<c b<e
        // eliminate b
        // d<c
        swap(c, e);
        // d<e
    }

    // d<e
    // median is smaller of c and d
    if(greater(c, d)) swap(c, d); // #6
} 
```

Python： http: [//pastebin.com/0kxjxFQX](http://pastebin.com/0kxjxFQX)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T12:36:50.023

好的，这是一个证明你至少需要 6 次比较的证据。

首先，请注意，我们获得的所有信息仅基于比较。我们可以根据比较步骤中发生的情况在最后进行交换。另请注意，我们的比较只能基于*之前*所做的比较。例如，算法的第一步将始终与之前未进行任何比较相同；第二个比较已经可以取决于第一个，等等。

让我们根据它们的大小“命名”元素 - 1,2,3,4,5。它们可以任何顺序出现在输入中。现在，我们*至少需要四次比较*才能正确排序元素。他们是：

```
3 > 2           [1]
3 > 1 OR 2 > 1  [2]
3 < 4           [3]
3 < 5 OR 4 < 5  [4] 
```

任何其他比较都是*额外的*。此外，如果我们不能避免两个比较 in`[2]`或两个比较 in `[4]`- 这些也会变得*extra*。

由于初始排列可以是任何东西，我们立即得到一个*额外的*比较：（`1 < 5`理解这一点很重要：因为我们的算法总是根据它们在输入中的呈现方式采用相同的前两个元素，比如*a*和*b*，所以总是有`a = 1`和)的可能性`b = 5`。

现在，第二步需要考虑两种情况：

**案例 1：**我们比较`1`和以外的两个元素`5`。由于我们无法区分`2`, `3`, 并且`4`在这个阶段我们立即得到第二个*额外的*比较：`2 < 4`。所以我们最多可以进行 6 次比较。

**情况 2：**我们将`1`or`5`与 、 或 中的一个`2`进行`3`比较`4`。不失一般性，让我们假设我们正在比较`1`。由于我们无法区分`2`, `3`, ant`4`我们得到第二个*额外*比较：`1 < 4`. 量子点

# javascript - jQuery 预加载多个图像然后调用事件

> ID：11065964
> 
> 赞同：1
> 
> 时间：2012-06-16T18:22:26.820
> 
> 标签：javascript, jquery

我想在加载所有图像后触发一个事件。而且，我想将每个图像标签附加到特定`div#ID`的 s，例如：

```
image01.jpg -> <div id="load01"></div>

image02.jpg -> <div id="load02"></div>

image03.jpg -> <div id="load03"></div>
... 
```

我卡在中间了...

HTML

```
<div id="blinker0">Smooth Blink</div>
<div class="profile" id="blinker1"></div>
<div class="profile" id="blinker2"></div>
<div class="profile" id="blinker3"></div>
<div class="profile" id="blinker4"></div>
<div class="profile" id="blinker5"></div> 
```

JS：

```
function smBlink(){
  for(i=0;i<3;i++) {
    $("#blinker0,#blinker1, #blinker2, #blinker3, #blinker4, #blinker5")
   .fadeTo('normal', 0.3)
   .fadeTo('normal', 1.0);
  }
}

$('<img />')
.attr('src', 'http://placekitten.com/160/160')
.load(function(){
$('#blinker1').append( $(this) );
smBlink();
}); 
```

现场样本：http: [//jsfiddle.net/nori2tae/E4erT/](http://jsfiddle.net/nori2tae/E4erT/)

我参考了这个网站：http: [//jquery-howto.blogspot.jp/2009/02/preload-images-with-jquery.html](http://jquery-howto.blogspot.jp/2009/02/preload-images-with-jquery.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:35:33.023

您可以使用[imagesLoaded](http://desandro.github.com/imagesloaded/)插件和不可见的保持元素来预加载图像：http: [//jsfiddle.net/imsky/E4erT/15/](http://jsfiddle.net/imsky/E4erT/15/)

```
$.each([1, 2, 3, 4, 5], function(i, j) {
    $("#invisible").append(
    $("<img />").attr("src", 
    "http://placekitten.com/" + j * (20 + Math.floor(Math.random() * 30)) + 
    "/" + j * 24))
});
$(function() {
    $("#invisible").imagesLoaded(function(img) {
        img.each(function(index, el) {
            $("#blinker" + (index + 1)).append(el);
        });
    });
}); 
```

# hibernate - 为什么 Hibernate 在 FetchType.Eager 映射中查找子实体时会加载父实体

> ID：11065974
> 
> 赞同：0
> 
> 时间：2012-06-16T18:24:02.170
> 
> 标签：hibernate, jpa

使用：休眠 4

在有 FetchType.Eager 映射的父子关系中，我注意到 Hibernate 将在任何时候加载父实体，并且 EntityManager.find 在子实体上执行。这似乎有点浪费。父级的“幕后”加载导致持久性上下文中出现额外的 SELECT 和额外的对象。此外，它会[强制应用在删除 child 时解决父子关联问题](https://stackoverflow.com/questions/11058085/entitynotfoundexception-deleted-entity-passed-to-persist-on-entitymanager-remov)。

为什么 Hibernate 会这样？这是 JPA 规范要求的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T14:51:11.727

它来自规范，必须在加载实体时获取具有急切获取策略的持久属性：

> 如果具有 FetchType.EAGER 的所有属性（无论是明确指定还是默认情况下）（包括关系和其他集合值属性）都已从数据库加载或由应用程序分配，则认为已加载实体。带有 FetchType.LAZY 的属性可能已加载，也可能未加载。

# jquery - 带有 NodeJS + Node.io 的选择器内的 jQuery 选择器

> ID：11065976
> 
> 赞同：0
> 
> 时间：2012-06-16T18:24:31.500
> 
> 标签：jquery, node.js, this, selector, node.io

我有一个尝试使用 JQuery 抓取网页的 NodeJS 应用程序。在我试图抓取的网页中：

```
<div class="gs_rt">
<a href="www.google.com">someTextHere</a>
</div> 
```

我想通过在第一个 jQuery 选择器中调用 jQuery 选择器来获得“someTextHere”。

```
$('.gs_r .gs_rt').each(function(index,result) {
    //fetches div okay
var test = $(this).find('a');
console.log(test);              
}); 
```

不幸的是，“this”似乎指向我的 Node.io Job 对象。此外，“索引”似乎不起作用（如何获取“每个”获取的当前对象的索引？）。

我不太确定发生了什么。帮助任何人？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T18:49:01.097

我找到了原因。Node.io 具有可通过 $() 调用的内置选择器，但它实际上并不使用 jQuery。

有关 API，请参阅[https://github.com/chriso/node.io/wiki/API---CSS-Selectors-and-Traversal-methods](https://github.com/chriso/node.io/wiki/API---CSS-Selectors-and-Traversal-methods)。

相反，应该做

```
var jQuery = require('jquery); 
```

并使用他们的内置选择器。

# java - 未找到 DatagramPacket 构造函数

> ID：11065980
> 
> 赞同：0
> 
> 时间：2012-06-16T18:24:36.053
> 
> 标签：java, udp

以下代码产生“找不到合适的构造函数”错误。我无法找出原因。

```
 try {
        Sock = new DatagramSocket();             
        InetAddress IP_add=InetAddress.getByName("192.168.1.2");
        DatagramPacket PACKET=new DatagramPacket(buf,buf.length,IP_add,2000);

       } catch (Exception e) {} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:30:40.950

有几个选项

1.  您的 buf 实例不是字节数组，必须是`byte []`
2.  您使用的 InetAddress 不是来自包 java.net

重新检查一下，我认为第一点会对您有所帮助。

# .net-4.0 - 使用 C#.NET 从网络摄像头捕获视频的最佳方法是什么？

> ID：11065981
> 
> 赞同：1
> 
> 时间：2012-06-16T18:24:51.200
> 
> 标签：.net-4.0, webcam, video-capture

我需要从网络摄像头捕获视频并保存到文件（mp4 格式）。使用 C#.net 4.0 应用程序执行此操作的最佳方法是什么？

有没有不涉及 WIA(Windows Image Acquisition) / DirectShow 的解决方案？还是我需要使用其中任何一个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T09:07:00.837

[我知道一个名为Leadtools](https://www.leadtools.com/)的第三方工具包可能会对您有所帮助。该工具包使用 DirectShow 的过滤器和编解码器从网络摄像头捕获视频。此外，它还提供了简单的方法来处理捕获的视频并以包括 MP4 在内的多种格式保存它们。有关更多信息，您可以查看本[教程](http://www.leadtools.com/help/leadtools/v175/dh/multimedia/to/leadtools.topics.multimedia~leadtools.topics.multimedia.creatingamultimediacaptureapplication.html)

# database-design - Anchor Modeling 中的非破坏性模式演化是什么意思？

> ID：11065982
> 
> 赞同：2
> 
> 时间：2012-06-16T18:25:06.383
> 
> 标签：database-design, database-schema, anchor-modeling

假设您有一个锚模型并将单个名称属性替换为三个属性：FirstName、MiddleName 和 LastName。原始名称属性会发生什么变化？我可以想象其他感觉具有破坏性的模式更改，那么 Anchor Modeling 声称以非破坏性方式发展模式意味着什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T21:00:19.667

## 破坏性操作会影响正常运行时间

它可能是指它与正常运行时间的交互。如果您 ALTER 一个足够大的基表，您将暂停对它的请求，直到它完成。使用锚建模，不存在这种情况，因为新列是不与基表交互的新实体（就阻止对基表的 I/O 操作而言，除了删除，因为新列被实现为空，所以没有实际意义表）。

因此，假设您有一个带有 FullName 属性的 Person 基表。然后你已经非破坏性地进化到包括 FirstName、MiddleName 和 LastName。FullName 表可能会继续有用，直到所有代码路径都采用 First、Middle 和 Last。在这一点上，它变成了一种退化的器官，继续进化的类比。

审核（删除）此表也是非破坏性的。作为一个单独的实体，其生命周期的破坏不会中断任何基表或属性表的操作。

所以这可能就是锚模型作者所说的破坏性。

破坏正常运行时间。

# java - 输入字符串未知时的字符串拆分（Java Android SMS拆分和转发）

> ID：11065985
> 
> 赞同：0
> 
> 时间：2012-06-16T18:25:39.833
> 
> 标签：java, android, sms, split, broadcastreceiver

我的 android 应用程序从 a 获取短信`BroadcastReceiver`并将消息复制到新的短信中。然后转发。由于技术原因，我必须拆分短信并仅复制以下部分`split[2]`：

```
 public string splitAndReturnRest(String inputStr)
  {
     String[] split = inputStr.split("\\s"); // split where spaces
     // now ignore split[0], split[1], split [2], copy rest of the split parts into
     String restOfTheSplits=//copy rest of the splits except split[0], split[1], split[2]

      return restOfTheSplits;
 } 
```

问题是我不能硬编码它。我不知道消息包含多少部分。所以之后的元素数量`split[2]`对我来说是未知的，并且每次都可能改变。也许我需要某种 for 循环或不同的拆分标准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T18:33:44.410

在 split[2] 之后，使用以下....

```
String restOfTheSplits = null;
for (int i=3 ; i<split.length; i++)
{
  restOfTheSplits = restOfTheSplits + split[i];
}
return restOfTheSplits 
```

如果您使用`StringBuilder`获取`restOfTheSplits`然后将其转换为字符串并返回它会更好......

# javascript - 滚动时激活

> ID：11065986
> 
> 赞同：0
> 
> 时间：2012-06-16T18:25:49.893
> 
> 标签：javascript, jquery, wordpress, html, wordpress-theming

我试图在滚动上突出显示一个不同的列表项，但现在我无法让它工作，因为我将它移植到这个 wordpress 安装中。

这是我目前的菜单：

```
<div id="navigation">
    <ul>
        <li class="nav1">
            <a href="#post-31"></a>
        </li>
        <li class="nav2">
            <a href="#post-28"></a>
        </li>
        <li class="nav3">
            <a href="#post-17"></a>
        </li>
        <li class="nav4">
            <a href="#post-12"></a>
        </li>
        <li class="nav5">
            <a href="#post-5"></a>
        </li>
        <li class="nav6">
            <a href="#post-1"></a>
        </li>
    </ul>
</div> 
```

这是Javascript：

```
//#### Change Active Menu Item 
// Cache selectors
var lastId,
    topMenu = $("#navigation ul"),
    topMenuHeight = topMenu.outerHeight()+15,
    // All list items
    menuItems = topMenu.find("a"),
    // Anchors corresponding to menu items
    scrollItems = menuItems.map(function(){
      var item = $($(this).attr("href"));
      if (item.length) { return item; }
    });

// Bind click handler to menu items
// so we can get a fancy scroll animation
menuItems.click(function(e){
  var href = $(this).attr("href"),
      offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+1;
  //$('html, body').stop().animate({ scrollTop: offsetTop }, 300);
  e.preventDefault();
});

// Bind to scroll
$(window).scroll(function(){
   // Get container scroll position
   var fromTop = $(this).scrollTop()+topMenuHeight;

   // Get id of current scroll item
   var cur = scrollItems.map(function(){
     if ($(this).offset().top < fromTop)
       return this;
   });
   // Get the id of the current element
   cur = cur[cur.length-1];
   var id = cur && cur.length ? cur[0].id : "";

   if (lastId !== id) {
       lastId = id;
       // Set/remove active class
       menuItems
         .parent().removeClass("active")
         .end().filter("[href=#"+id+"]").parent().addClass("active");
   }                   
}); 
```

我可以说脚本有点工作，因为滚动时它会将活动类放在#post-1 列表项上，但它不会从那里移动。

在不正确的代码中可以看到任何内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T23:01:39.117

出于某种原因，在菜单中添加 'order' => 'ASC' 似乎可以让它工作。我不知道为什么，但它现在工作

# postgresql - 找不到符号：带有 Django 项目的 _PQbackendPID

> ID：11065990
> 
> 赞同：0
> 
> 时间：2012-06-16T18:26:06.993
> 
> 标签：postgresql, django-models, pg

在安装了 postgresSQL 的 MAC os 10.6.8 上运行，以及 django - 使用 python2.7 还在我的虚拟环境中使用 pip 安装了 psycopg2 和 dj-database-url 并将这两行添加到我的 setting.py 中：

```
import dj_database_url
DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

基于 Heroku 的说明： [https](https://devcenter.heroku.com/articles/django#database_settings) ://devcenter.heroku.com/articles/django#database_settings 运行时：

```
python manage.py runserver 
```

我收到此错误：

```
ImportError: dlopen(/Users.... venv/lib/python2.7/site-packages/psycopg2/_psycopg.so, 2): Symbol not found: _PQbackendPID
Referenced from: /Users.... venv/lib/python2.7/site-packages/psycopg2/_psycopg.so
Expected in: dynamic lookup 
```

我一直在寻找几个小时并尝试了各种事情，包括以下建议： [Mac OS X Lion Psycopg2：找不到符号：_PQbackendPID](https://stackoverflow.com/questions/6999105/mac-os-x-lion-psycopg2-symbol-not-found-pqbackendpid) 无济于事。

想知道是否有人遇到过这样的问题并且有任何运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:28:59.843

我有同样的问题。而不是像 Heroku 建议的那样安装依赖项

```
pip install Django psycopg2 dj-database-url 
```

克隆您希望在 venv 中运行的任何 repo，保留其原始 settings.py。然后：

```
source venv/bin/activate 
```

激活新环境，`cd`进入你的新仓库，然后`python manage.py runserver`. 应该设置。

或者，您可以重新制作 PostGreSQL，然后再次运行，但这需要更多的任务——不过，它适用于 psycopg2。据我所知，当您应该使用 32 构建时，问题来自使用 64 或 i386 构建 - 但我不确定这一点，上述解决方案可以很好地解决问题并使用 venv 来满足您的需求'实际上很可能会使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-27T18:24:39.773

我和你们有同样的问题，我读了很多页，但我都找不到答案。许多解决方案是关于从源文件安装，与虚拟环境无关。我已经找到并测试了以下解决方案，它解决了我的问题。

[1-根据 psycopg2](http://initd.org/psycopg/docs/install.html)确保您的 Postgres 不高于 9.4 版本。还要检查 python 版本。我使用 Postgres 3.9.9。

2- 问题出在不同版本的 Python（32/64 位）背后。它应该符合您的操作系统的位架构，即 64 位。从系统中卸载所有版本的 Python 和 pip。您可以在[此处](https://stackoverflow.com/questions/3819449/how-to-uninstall-python-2-7-on-a-mac-os-x-10-6-4)找到说明，但不要删除 Python2.7，它是 Apple 提供的系统 Python。

3-从python[官方网站安装“](https://www.python.org/downloads/mac-osx/) [Mac OS X 64-bit/32-bit](https://www.python.org/ftp/python/3.5.0/python-3.5.0-macosx10.6.pkg) ”安装程序并安装它。之后安装 pip。请注意，您应该使用命令“python3.5”来使用 Python 3.5 版本。您也可以从新的 pip 安装 virtualenv。

4-毕竟你可以继续你的virtualenv并输入“pip3 install -r requirements.txt”来在你的本地机器上安装所有依赖项。

希望这可以帮到你。

# javascript - getelementbyid 不工作

> ID：11065991
> 
> 赞同：0
> 
> 时间：2012-06-16T18:26:30.623
> 
> 标签：javascript, getelementbyid

嗨，我正在尝试从 getelementbyid 获取 div，但它对我不起作用这是我的代码

```
 <body onload="ErrorCheck(-1)">
<script type="text/javascript">
function ErrorCheck(var1)
{

    if(var1 = -1)
    {   alert("in function");
        var cont = document.getElementBId('msg');       
        if(cont==null){
        alert("null");
        }
        else{
        alert("not null");
        }
    }
}
</script>
<h1 class="header">Register</h1>
<div id="msg"></div>
</body> 
```

在调用 getElementBId 后，此函数将变为死函数，因为它不会执行任何 if 或 else。请检查我在这里做错了什么

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-16T18:27:43.463

你之前忘记了**y**`...Id('msg');`：

```
var cont = document.getElementById('msg'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T18:31:57.430

错误包括以下

第 6 行是

```
if(var == -1) 
```

接下来是

```
document.getElementById // not document.getElementBId 
```

# specflow - Specflow 未通过表

> ID：11065994
> 
> 赞同：0
> 
> 时间：2012-06-16T18:27:11.687
> 
> 标签：specflow

我刚刚开始使用 Specflow、Watin 和 Deleporter。

我遇到了集成类型测试的问题，因为它不会将表数据传递到相应的测试中。

```
Scenario: User tries to register and their email already exists
Given I have filled out the register page with the following data
| Name | Password  | Nickname     | Email           |
| Sam  | password1 | SamsNickname | email@email.com |
When I already have an account with the same email
| Name | Password  | Nickname     | Email           |
| Sam  | password1 | SamsNickname | email@email.com |
Then Show message that the account exists

[Given(@"I have filled out the register page with the following data")]
public void GivenIHaveFilledOutTheRegisterPageWithTheFollowingData(Table table)
{
    var data = table.Rows.First();

} 
```

我遇到的问题是上面的 Table 参数作为 null 传入。我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-30T13:49:35.300

错误的跑步者执行你的测试。

转到以下选项：工具 -> 选项 -> Specflow -> 常规 -> 测试运行工具

将值更改为“Auto”或“SpecRun”

# wpf - 在应用了 HierarchicalDataTemplate 的 WPF TreeView 中绑定 SelectedItem

> ID：11065995
> 
> 赞同：16
> 
> 时间：2012-06-16T18:27:17.613
> 
> 标签：wpf, data-binding, treeview, treeviewitem, hierarchicaldatatemplate

我有一个数据绑定`TreeView`，我想绑定`SelectedItem`。[这种附加的行为](https://stackoverflow.com/a/5118406/986080)在没有它的情况下完美地工作，`HierarchicalDataTemplate`但附加的行为只能以一种方式（UI 到数据）而不是另一种方式工作，因为 now `e.NewValue`is `MyViewModel`not `TreeViewItem`。

这是附加行为的代码片段：

```
private static void OnSelectedItemChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
{
    var item = e.NewValue as TreeViewItem;
    if (item != null)
    {
        item.SetValue(TreeViewItem.IsSelectedProperty, true);
    }
} 
```

这是我的`TreeView`定义：

```
<Window xmlns:interactivity="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity">
    <TreeView ItemsSource="{Binding MyItems}" VirtualizingStackPanel.IsVirtualizing="True">
        <interactivity:Interaction.Behaviors>
            <behaviors:TreeViewSelectedItemBindingBehavior SelectedItem="{Binding SelectedItem, Mode=TwoWay}" />
        </interactivity:Interaction.Behaviors>
        <TreeView.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:MyViewModel}" ItemsSource="{Binding Children}">
                <TextBlock Text="{Binding Name}"/>
            </HierarchicalDataTemplate>
        </TreeView.Resources>
    </TreeView>
</Window> 
```

如果我可以`TreeView`在附加的行为方法中获得对 的引用`OnSelectedItemChanged`，也许我可以使用[这个问题](https://stackoverflow.com/questions/616948/how-to-get-treeviewitem-from-hierarchicaldatatemplate-item)中的答案来获得，`TreeViewItem`但我不知道如何到达那里。有谁知道如何以及这是正确的方法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-09-09T14:04:49.453

这是上述附加行为的改进版本。它完全支持双向绑定，并且还可以在其项目被虚拟化的地方使用`HeriarchicalDataTemplate`和s。`TreeView`请注意，虽然要找到需要选择的'TreeViewItem'，它会实现（即创建）虚拟化`TreeViewItem`s，直到找到正确的s。这可能是大型虚拟树的性能问题。

```
/// <summary>
///     Behavior that makes the <see cref="System.Windows.Controls.TreeView.SelectedItem" /> bindable.
/// </summary>
public class BindableSelectedItemBehavior : Behavior<TreeView>
{
    /// <summary>
    ///     Identifies the <see cref="SelectedItem" /> dependency property.
    /// </summary>
    public static readonly DependencyProperty SelectedItemProperty =
        DependencyProperty.Register(
            "SelectedItem",
            typeof(object),
            typeof(BindableSelectedItemBehavior),
            new UIPropertyMetadata(null, OnSelectedItemChanged));

    /// <summary>
    ///     Gets or sets the selected item of the <see cref="TreeView" /> that this behavior is attached
    ///     to.
    /// </summary>
    public object SelectedItem
    {
        get
        {
            return this.GetValue(SelectedItemProperty);
        }

        set
        {
            this.SetValue(SelectedItemProperty, value);
        }
    }

    /// <summary>
    ///     Called after the behavior is attached to an AssociatedObject.
    /// </summary>
    /// <remarks>
    ///     Override this to hook up functionality to the AssociatedObject.
    /// </remarks>
    protected override void OnAttached()
    {
        base.OnAttached();
        this.AssociatedObject.SelectedItemChanged += this.OnTreeViewSelectedItemChanged;
    }

    /// <summary>
    ///     Called when the behavior is being detached from its AssociatedObject, but before it has
    ///     actually occurred.
    /// </summary>
    /// <remarks>
    ///     Override this to unhook functionality from the AssociatedObject.
    /// </remarks>
    protected override void OnDetaching()
    {
        base.OnDetaching();
        if (this.AssociatedObject != null)
        {
            this.AssociatedObject.SelectedItemChanged -= this.OnTreeViewSelectedItemChanged;
        }
    }

    private static Action<int> GetBringIndexIntoView(Panel itemsHostPanel)
    {
        var virtualizingPanel = itemsHostPanel as VirtualizingStackPanel;
        if (virtualizingPanel == null)
        {
            return null;
        }

        var method = virtualizingPanel.GetType().GetMethod(
            "BringIndexIntoView",
            BindingFlags.Instance | BindingFlags.NonPublic,
            Type.DefaultBinder,
            new[] { typeof(int) },
            null);
        if (method == null)
        {
            return null;
        }

        return i => method.Invoke(virtualizingPanel, new object[] { i });
    }

    /// <summary>
    /// Recursively search for an item in this subtree.
    /// </summary>
    /// <param name="container">
    /// The parent ItemsControl. This can be a TreeView or a TreeViewItem.
    /// </param>
    /// <param name="item">
    /// The item to search for.
    /// </param>
    /// <returns>
    /// The TreeViewItem that contains the specified item.
    /// </returns>
    private static TreeViewItem GetTreeViewItem(ItemsControl container, object item)
    {
        if (container != null)
        {
            if (container.DataContext == item)
            {
                return container as TreeViewItem;
            }

            // Expand the current container
            if (container is TreeViewItem && !((TreeViewItem)container).IsExpanded)
            {
                container.SetValue(TreeViewItem.IsExpandedProperty, true);
            }

            // Try to generate the ItemsPresenter and the ItemsPanel.
            // by calling ApplyTemplate.  Note that in the 
            // virtualizing case even if the item is marked 
            // expanded we still need to do this step in order to 
            // regenerate the visuals because they may have been virtualized away.
            container.ApplyTemplate();
            var itemsPresenter =
                (ItemsPresenter)container.Template.FindName("ItemsHost", container);
            if (itemsPresenter != null)
            {
                itemsPresenter.ApplyTemplate();
            }
            else
            {
                // The Tree template has not named the ItemsPresenter, 
                // so walk the descendents and find the child.
                itemsPresenter = container.GetVisualDescendant<ItemsPresenter>();
                if (itemsPresenter == null)
                {
                    container.UpdateLayout();
                    itemsPresenter = container.GetVisualDescendant<ItemsPresenter>();
                }
            }

            var itemsHostPanel = (Panel)VisualTreeHelper.GetChild(itemsPresenter, 0);

            // Ensure that the generator for this panel has been created.
#pragma warning disable 168
            var children = itemsHostPanel.Children;
#pragma warning restore 168

            var bringIndexIntoView = GetBringIndexIntoView(itemsHostPanel);
            for (int i = 0, count = container.Items.Count; i < count; i++)
            {
                TreeViewItem subContainer;
                if (bringIndexIntoView != null)
                {
                    // Bring the item into view so 
                    // that the container will be generated.
                    bringIndexIntoView(i);
                    subContainer =
                        (TreeViewItem)container.ItemContainerGenerator.
                                                ContainerFromIndex(i);
                }
                else
                {
                    subContainer =
                        (TreeViewItem)container.ItemContainerGenerator.
                                                ContainerFromIndex(i);

                    // Bring the item into view to maintain the 
                    // same behavior as with a virtualizing panel.
                    subContainer.BringIntoView();
                }

                if (subContainer == null)
                {
                    continue;
                }

                // Search the next level for the object.
                var resultContainer = GetTreeViewItem(subContainer, item);
                if (resultContainer != null)
                {
                    return resultContainer;
                }

                // The object is not under this TreeViewItem
                // so collapse it.
                subContainer.IsExpanded = false;
            }
        }

        return null;
    }

    private static void OnSelectedItemChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
    {
        var item = e.NewValue as TreeViewItem;
        if (item != null)
        {
            item.SetValue(TreeViewItem.IsSelectedProperty, true);
            return;
        }

        var behavior = (BindableSelectedItemBehavior)sender;
        var treeView = behavior.AssociatedObject;
        if (treeView == null)
        {
            // at designtime the AssociatedObject sometimes seems to be null
            return;
        }

        item = GetTreeViewItem(treeView, e.NewValue);
        if (item != null)
        {
            item.IsSelected = true;
        }
    }

    private void OnTreeViewSelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
    {
        this.SelectedItem = e.NewValue;
    }
} 
```

为了完整起见，hier 是以下实现`GetVisualDescentants`：

```
/// <summary>
///     Extension methods for the <see cref="DependencyObject" /> type.
/// </summary>
public static class DependencyObjectExtensions
{
    /// <summary>
    ///     Gets the first child of the specified visual that is of tyoe <typeparamref name="T" />
    ///     in the visual tree recursively.
    /// </summary>
    /// <param name="visual">The visual to get the visual children for.</param>
    /// <returns>
    ///     The first child of the specified visual that is of tyoe <typeparamref name="T" /> of the
    ///     specified visual in the visual tree recursively or <c>null</c> if none was found.
    /// </returns>
    public static T GetVisualDescendant<T>(this DependencyObject visual) where T : DependencyObject
    {
        return (T)visual.GetVisualDescendants().FirstOrDefault(d => d is T);
    }

    /// <summary>
    ///     Gets all children of the specified visual in the visual tree recursively.
    /// </summary>
    /// <param name="visual">The visual to get the visual children for.</param>
    /// <returns>All children of the specified visual in the visual tree recursively.</returns>
    public static IEnumerable<DependencyObject> GetVisualDescendants(this DependencyObject visual)
    {
        if (visual == null)
        {
            yield break;
        }

        for (var i = 0; i < VisualTreeHelper.GetChildrenCount(visual); i++)
        {
            var child = VisualTreeHelper.GetChild(visual, i);
            yield return child;
            foreach (var subChild in GetVisualDescendants(child))
            {
                yield return subChild;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-17T13:55:34.057

我知道这是一个老问题，但也许对其他人有帮助。我结合了来自 [Link的代码](https://github.com/thoemmi/Solutionizer/blob/master/Solutionizer/Infrastructure/BindableSelectedItemBehavior%20.cs)

现在看起来：

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Interactivity;
using System.Windows.Media;

namespace Behaviors
{
    public class BindableSelectedItemBehavior : Behavior<TreeView>
    {
        #region SelectedItem Property

        public object SelectedItem
        {
            get { return (object)GetValue(SelectedItemProperty); }
            set { SetValue(SelectedItemProperty, value); }
        }

        public static readonly DependencyProperty SelectedItemProperty =
            DependencyProperty.Register("SelectedItem", typeof(object), typeof(BindableSelectedItemBehavior), new UIPropertyMetadata(null, OnSelectedItemChanged));

        private static void OnSelectedItemChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            // if binded to vm collection than this way is not working
            //var item = e.NewValue as TreeViewItem;
            //if (item != null)
            //{
            //    item.SetValue(TreeViewItem.IsSelectedProperty, true);
            //}

            var tvi = e.NewValue as TreeViewItem;
            if (tvi == null)
            {
                var tree = ((BindableSelectedItemBehavior)sender).AssociatedObject;
                tvi = GetTreeViewItem(tree, e.NewValue);
            }
            if (tvi != null)
            {
                tvi.IsSelected = true;
                tvi.Focus();
            }
        }

        #endregion

        #region Private

        private void OnTreeViewSelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
        {
            SelectedItem = e.NewValue;
        }

        private static TreeViewItem GetTreeViewItem(ItemsControl container, object item)
        {
            if (container != null)
            {
                if (container.DataContext == item)
                {
                    return container as TreeViewItem;
                }

                // Expand the current container
                if (container is TreeViewItem && !((TreeViewItem)container).IsExpanded)
                {
                    container.SetValue(TreeViewItem.IsExpandedProperty, true);
                }

                // Try to generate the ItemsPresenter and the ItemsPanel.
                // by calling ApplyTemplate.  Note that in the 
                // virtualizing case even if the item is marked 
                // expanded we still need to do this step in order to 
                // regenerate the visuals because they may have been virtualized away.

                container.ApplyTemplate();
                var itemsPresenter =
                    (ItemsPresenter)container.Template.FindName("ItemsHost", container);
                if (itemsPresenter != null)
                {
                    itemsPresenter.ApplyTemplate();
                }
                else
                {
                    // The Tree template has not named the ItemsPresenter, 
                    // so walk the descendents and find the child.
                    itemsPresenter = FindVisualChild<ItemsPresenter>(container);
                    if (itemsPresenter == null)
                    {
                        container.UpdateLayout();
                        itemsPresenter = FindVisualChild<ItemsPresenter>(container);
                    }
                }

                var itemsHostPanel = (Panel)VisualTreeHelper.GetChild(itemsPresenter, 0);

                // Ensure that the generator for this panel has been created.
#pragma warning disable 168
                var children = itemsHostPanel.Children;
#pragma warning restore 168

                for (int i = 0, count = container.Items.Count; i < count; i++)
                {
                    var subContainer = (TreeViewItem)container.ItemContainerGenerator.
                                                          ContainerFromIndex(i);
                    if (subContainer == null)
                    {
                        continue;
                    }

                    subContainer.BringIntoView();

                    // Search the next level for the object.
                    var resultContainer = GetTreeViewItem(subContainer, item);
                    if (resultContainer != null)
                    {
                        return resultContainer;
                    }
                    else
                    {
                        // The object is not under this TreeViewItem
                        // so collapse it.
                        //subContainer.IsExpanded = false;
                    }
                }
            }

            return null;
        }

        /// <summary>
        /// Search for an element of a certain type in the visual tree.
        /// </summary>
        /// <typeparam name="T">The type of element to find.</typeparam>
        /// <param name="visual">The parent element.</param>
        /// <returns></returns>
        private static T FindVisualChild<T>(Visual visual) where T : Visual
        {
            for (int i = 0; i < VisualTreeHelper.GetChildrenCount(visual); i++)
            {
                Visual child = (Visual)VisualTreeHelper.GetChild(visual, i);
                if (child != null)
                {
                    T correctlyTyped = child as T;
                    if (correctlyTyped != null)
                    {
                        return correctlyTyped;
                    }

                    T descendent = FindVisualChild<T>(child);
                    if (descendent != null)
                    {
                        return descendent;
                    }
                }
            }

            return null;
        }

        #endregion

        #region Protected

        protected override void OnAttached()
        {
            base.OnAttached();

            AssociatedObject.SelectedItemChanged += OnTreeViewSelectedItemChanged;
        }

        protected override void OnDetaching()
        {
            base.OnDetaching();

            if (AssociatedObject != null)
            {
                AssociatedObject.SelectedItemChanged -= OnTreeViewSelectedItemChanged;
            }
        }

        #endregion
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-12T16:16:14.880

如果您像我一样发现[此答案](https://stackoverflow.com/a/20636049/208817)有时会因为为空而崩溃`itemPresenter`，那么对该解决方案的此修改可能对您有用。

更改`OnSelectedItemChanged`为这个（如果树还没有加载，那么它会等到树*被*加载并再次尝试）：

```
private static void OnSelectedItemChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
{
    Action<TreeViewItem> selectTreeViewItem = tvi2 =>
    {
        if (tvi2 != null)
        {
            tvi2.IsSelected = true;
            tvi2.Focus();
        }
    };

    var tvi = e.NewValue as TreeViewItem;

    if (tvi == null)
    {
        var tree = ((BindableTreeViewSelectedItemBehavior) sender).AssociatedObject;
        if (!tree.IsLoaded)
        {
            RoutedEventHandler handler = null;
            handler = (sender2, e2) =>
            {
                tvi = GetTreeViewItem(tree, e.NewValue);
                selectTreeViewItem(tvi);
                tree.Loaded -= handler;
            };
            tree.Loaded += handler;

            return;
        }
        tvi = GetTreeViewItem(tree, e.NewValue);
    }

    selectTreeViewItem(tvi);
} 
```

# android - NinePatchDrawable 没有从块中获得填充

> ID：11065996
> 
> 赞同：9
> 
> 时间：2012-06-16T18:27:23.043
> 
> 标签：android, drawable, padding, nine-patch

我需要有关 NinePatchDrawable 的帮助：

我的应用程序可以从网络下载主题。除了 9-Patch PNG 之外，几乎所有东西都可以正常工作。

```
final Bitmap bubble = getFromTheme("bubble");
if (bubble == null) return null;

final byte[] chunk = bubble.getNinePatchChunk();
if (!NinePatch.isNinePatchChunk(chunk)) return null;

NinePatchDrawable d = new NinePatchDrawable(getResources(), bubble, chunk, new Rect(), null);
v.setBackgroundDrawable(d);

d = null;
System.gc(); 
```

getFromTheme() 从 SD 卡加载位图。9-Patch PNG 已经编译，这意味着它们包含所需的块。

我如何将位图转换为 NinePatchDrawable 对象的方式似乎很有效，因为图像是可拉伸的，就像我绘制它一样。

唯一不起作用的是填充。我已经尝试将填充设置为这样的视图：

```
final Rect rect = new Rect();   // or just use the new Rect() set
d.getPadding(rect);             // in the constructor
v.setPadding(rect.left, rect.top, rect.right, rect.bottom); 
```

d.getPadding(rect) 应该用从块中获得的填充填充变量 rect，不是吗？但事实并非如此。

结果：TextView (v) 未在 9-Patch 图像的内容区域中显示文本。每个坐标中的填充设置为 0。

谢谢阅读。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-18T16:23:10.313

最后，我做到了。Android 没有正确解释块数据。可能有bug。所以你必须自己反序列化块来获取填充数据。

开始了：

```
package com.dragonwork.example;

import android.graphics.Rect;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;

class NinePatchChunk {

    public static final int NO_COLOR = 0x00000001;
    public static final int TRANSPARENT_COLOR = 0x00000000;

    public final Rect mPaddings = new Rect();

    public int mDivX[];
    public int mDivY[];
    public int mColor[];

    private static void readIntArray(final int[] data, final ByteBuffer buffer) {
        for (int i = 0, n = data.length; i < n; ++i)
            data[i] = buffer.getInt();
    }

    private static void checkDivCount(final int length) {
        if (length == 0 || (length & 0x01) != 0)
            throw new RuntimeException("invalid nine-patch: " + length);
    }

    public static NinePatchChunk deserialize(final byte[] data) {
        final ByteBuffer byteBuffer =
            ByteBuffer.wrap(data).order(ByteOrder.nativeOrder());

        if (byteBuffer.get() == 0) return null; // is not serialized

        final NinePatchChunk chunk = new NinePatchChunk();
        chunk.mDivX = new int[byteBuffer.get()];
        chunk.mDivY = new int[byteBuffer.get()];
        chunk.mColor = new int[byteBuffer.get()];

        checkDivCount(chunk.mDivX.length);
        checkDivCount(chunk.mDivY.length);

        // skip 8 bytes
        byteBuffer.getInt();
        byteBuffer.getInt();

        chunk.mPaddings.left = byteBuffer.getInt();
        chunk.mPaddings.right = byteBuffer.getInt();
        chunk.mPaddings.top = byteBuffer.getInt();
        chunk.mPaddings.bottom = byteBuffer.getInt();

        // skip 4 bytes
        byteBuffer.getInt();

        readIntArray(chunk.mDivX, byteBuffer);
        readIntArray(chunk.mDivY, byteBuffer);
        readIntArray(chunk.mColor, byteBuffer);

        return chunk;
    }
} 
```

使用上面的类如下：

```
final byte[] chunk = bitmap.getNinePatchChunk();
if (NinePatch.isNinePatchChunk(chunk)) {
    textView.setBackgroundDrawable(new NinePatchDrawable(getResources(),
          bitmap, chunk, NinePatchChunk.deserialize(chunk).mPaddings, null));
} 
```

它会完美地工作！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-05T18:24:24.260

它实际上比这*稍微*复杂一些，但归结为非常简单：

填充矩形由[`BitmapFactory.decodeStream(InputStream, Rect, Options)`](https://github.com/android/platform_frameworks_base/blob/android-4.2.2_r1/graphics/java/android/graphics/BitmapFactory.java#L467). 没有`decodeByteArray()`哪个版本可以返回填充矩形。

整个九个补丁 API 有点傻：

*   `decodeByteArray()`调用`nativeDecodeByteArray()`，这可能比`nativeDecodeStream()`在 a 上更有效`ByteArrayInputStream`，但显然开发人员从未期望您要从内存中解码一个九个补丁。
*   padding rect*仅*由九个补丁使用，因此将其作为的一部分`NinePatch`而不是`BitmapFactory`. 可悲的是，[`NinePatch.java`](https://github.com/android/platform_frameworks_base/blob/jb-mr1-release/graphics/java/android/graphics/NinePatch.java)它只不过是一个将位图和九个补丁块传递给绘图方法的包装器（并且`NinePatch.draw()`由于对 的调用，大多数调用都不是线程安全的`mRect.set(location)`）。
*   [`NinePatchDrawable`](https://github.com/android/platform_frameworks_base/blob/android-4.2.2_r1/graphics/java/android/graphics/drawable/NinePatchDrawable.java)不提供采用 a`NinePatch`和 padding rect 的方法，这`NinePatch`在应用程序代码中有些用处（除非您想自己进行填充）。没有`NinePatchDrawable.getNinePatch()`或`NinePatch.getBitmap()`。

[这条评论](https://github.com/android/platform_frameworks_base/blob/android-4.2.2_r1/graphics/java/android/graphics/drawable/Drawable.java#L773)总结得很好：

> 啊。约定是我们`decodeStream`已经分配了 pad rect，但是如果位图没有 Ninepatch 块，那么 pad 将被忽略。如果我们可以将其更改为懒惰地分配/分配 rect，我们可以避免生成 new `Rect`的 GC 搅动，只是将它们放在地板上。

我的修复相当简单：

```
public final class NinePatchWrapper {
  private final Bitmap mBitmap;
  private final Rect mPadding;
  /**
  * The caller must ensure that that bitmap and padding are not modified after
  * this method returns. We could copy them, but Bitmap.createBitmap(Bitmap)
  * does not copy the nine-patch chunk on some Android versions.
  */
  public NinePatchWrapper(Bitmap bitmap, Rect padding) {
    mBitmap = bitmap;
    mPadding = padding;
  }
  public NinePatchDrawable newDrawable(Resources resources) {
    return new NinePatchDrawable(mBitmap, mBitmap.getNinePatchChunk(), mPadding, null);
  }
}

...

public NinePatchWrapper decodeNinePatch(byte[] byteArray, int density) {
  Rect padding = new Rect();
  ByteArrayInputStream stream = new ByteArrayInputStream(byteArray);
  Bitmap bitmap = BitmapFactory.decodeStream(stream, padding, null);
  bitmap.setDensity(density);
  return new NinePatchWrapper(bitmap, padding);
} 
```

未经测试，因为它已大大简化。特别是，您可能想要检查九个补丁块是否有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-18T14:34:04.223

我从来没有见过这样的例子，其中`Padding`不包含在 9-patch 中：

![在此处输入图像描述](../Images/059306b20d899e126b6f00ce93124a19.png)

为此，您应该首先构造一个[NinePatch](http://developer.android.com/reference/android/graphics/NinePatch.html)，然后从中创建您是 Drawable 的：

```
NinePatch ninePatch = new NinePatch(bitmap, chunk, srcName);
NinePatchDrawable d = new NinePatchDrawable(res, ninePatch); 
```

但是，您似乎正在用一个空矩形构造您的 Drawable：

```
NinePatchDrawable d = new NinePatchDrawable(getResources(), bubble, chunk, new Rect(), null); 
```

如果您想以编程方式指定填充，请尝试以下操作：

```
Rect paddingRectangle = new Rect(left, top, right, bottom);
NinePatchDrawable d = new NinePatchDrawable(getResources(), bubble, chunk, paddingRectangle, null); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-22T14:21:57.153

聚会有点晚了，但这是我解决它的方法：

我使用`NinePatchDrawable`提供的解码器方法，它正确读取填充：

```
 var myDrawable = NinePatchDrawable.createFromStream(sr, null); 
```

# c# - 为附加的字符串创建一个实例

> ID：11065997
> 
> 赞同：0
> 
> 时间：2012-06-16T18:27:36.930
> 
> 标签：c#, reflection

我正在尝试创建一个通用方法，我必须将一些字符串附加到通用数据类型并创建该附加字符串的实例。

例如：我有两个类 Object1、Object2、Object3、Object4、....Object100 和 Object1Address、Object2Address、Object3Address、Object4Address、....Object100Address

现在我有每个对象的方法，比如 MethodObject1()、MethodObject2()、MethodObject3()、MethodObject4()

```
MethodObject1()
{
     Object1 object = new Object1();
     Object1Address objectAddress = new Object1Address();

     TestMethod();
}

MethodObject2()
{
     Object2 object = new Object2();
     Object2Address objectAddress = new Object2Address();

     TestMethod();
}

MethodObject3()
{
     Object3 object = new Object3();
     Object3Address objectAddress = new Object3Address();

     TestMethod();
}

MethodObject4()
{
     Object4 object = new Object4();
     Object4Address objectAddress = new Object4Address();

     TestMethod();
}
.
.
.
MethodObject100()
{
     Object100 object = new Object100();
     Object100Address objectAddress = new Object100Address();

     TestMethod();
} 
```

但是大约有 100 个对象，所以我必须以类似的方式创建 100 个方法。所以我想创建一个通用方法。

```
There is a method which returns only the an array of Object name from an XML file.
Eg: ObjectName[] objectName = GetObjects(); // Returns an array of Object Names from XML file so that 

objectName[0] = Object1;
objectName[1] = Object2;
objectName[2] = Object3;
objectNmae[3] = Object4;
.
.
.
objectName[99] = Object100;

I am looping through objectName array
foreach(var objectItem in objectName)
{
    MethodName<objectItem>();
}

In my generic method I can create an instance of object, like
MethodName<T>()
{
   T t = new T();
   Some how I have to get the name of T and append Address to T 
   So that I can create TAddress instance like
   TAddress tAddress = new TAddress();

} 
```

有什么办法可以使用 CSharp 来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T19:05:34.163

即使进行了编辑，我仍然无法按照您的要求进行操作。但是，为了取得进展，我将提供一个至少可以帮助隔离您想要的答案的答案。

```
public class ThingWithAddress<T>
{
    public T Item { get; private set; }
    public string Address { get; private set; }

    public static ThingWithAddress<T> Create(T item, string address)
    {
        return new ThingWithAddress<T>
        {
            Item = item,
            Address = address,
        };
    }
} 
```

然后你可以得到一个对象，它有一个人和一个地址，比如：

```
Person person = ...;
var personWithAddress = ThingWithAddress.Create(person, "some address"); 
```

不要采取错误的方式，但您可能需要学习足够多的 C# 才能提出一个好的问题，因为就目前而言，这个问题似乎令人困惑和不一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T18:33:35.723

您的案例实际上并不需要通用方法。

您可能想要的是覆盖`ToString`类中的方法。

```
class PersonAddress()
{
    public override string ToString()
    {
        return string.Concat(this.Street, ", ",  this.City, ", ", this.Postcode);
    }
}

class Person()
{
    public override string ToString()
    {
        return string.Concat(this.Name, ", ",  this.PersonAddress.ToString());
    }
} 
```

注意`Person`类如何重用`PersonAddress.ToString()`方法。

# plugins - 需要的一般方向：我应该使用什么架构/方法来封装网站以在其他人的网站上运行（插件）？

> ID：11065998
> 
> 赞同：1
> 
> 时间：2012-06-16T18:27:41.123
> 
> 标签：plugins, hosting, subdomain, subdirectory

我有一个产品需要开发一个应该在另一个组织的当前网站中运行的网站。因此，这将是一个提供许多其他组织希望在自己的域上托管并使用其用户当前登录凭据的功能的网站。可以说是一个插件。

我如何开发一个在他们的域上存在并与他们的网站交互的模块？我想避免使用需要它们集成的 API（除了我不知道如何解决的凭据问题）。我希望这是一个即插即用的解决方案，他们从我这里购买软件，托管它，然后无缝集成到他们的网站中。

我没有任何细节可提供。我需要一个大致的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T18:46:45.193

注意：ANDED 来自上述评论：

..如果没有流行的平台，例如 WordPress 或 Joomla 等，允许您与它集成，并且与它集成的每个人都可以使用您的插件，除了与自定义通信进行自定义集成之外别无他法。