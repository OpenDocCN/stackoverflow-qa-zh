# StackOverflow 问答 000182000-000182999

# .net - 从数据库中检索数据时转换或转换？

> ID：182011
> 
> 赞同：5
> 
> 时间：2008-10-08T10:10:19.700
> 
> 标签：.net, datatable, casting

访问从数据库检索的 DataTable 中的对象时，是否有任何理由不将该对象转换为所需的类型，或者是否有理由使用转换？我知道当我们知道我们正在使用的数据类型时，该规则被强制转换，并在尝试将数据类型更改为它不是的东西时进行转换。假设我们知道列中存储了什么数据类型，强制转换似乎是合适的，但是是否有任何数据库类型问题意味着我们不能依赖它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T10:17:22.290

出于你所说的原因，我总是会投。我知道你需要处理的问题是：

1.  您显然需要能够处理 DBNulls（例如通过使用 Convert.IsDBNull 进行测试）

2.  在 ExecuteScalar 的情况下，我相信您需要检查 null 以及 DBNull。

3.  SQL Server @@IDENTITY 和 SCOPE_IDENTITY 函数即使对于声明为 INT 的列也会返回数字（十进制）。在这种情况下，您可以转换两次 "(int)(decimal)value" 或在 T-SQL 代码中处理它，例如： .

    插入 MyTable ... 从 MyTable 中选择 AutoIdColumn，其中 AutoIdColumn = SCOPE_IDENTITY()

或者

```
INSERT INTO MyTable ...
SELECT CAST(SCOPE_IDENTITY() AS INT) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T10:18:22.803

两者`CAST`和`CONVERT`都用于显式地将一种数据类型的表达式转换为另一种数据类型。但是，`CONVERT`您也可以指定**格式**样式。

CAST 的语法：

```
CAST ( expression AS data_type [ (length ) ]) 
```

转换的语法：

```
CONVERT ( data_type [ ( length ) ] , expression [ , style ] ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-30T00:29:18.060

从 RDBMS 检索时，您应该让数据库驱动程序处理本机类型和请求类型之间的编组。

CAST 受到 SQL 标准的认可，可在最多的 RDBMS 平台上工作。

CONVERT 在更少的平台上可用。

如果您有多平台考虑，则 CONVERT 应仅用于特殊情况，例如无法使用 CAST 完成的自定义格式。

# java - 将结果集写入具有排序输出的文件

> ID：182018
> 
> 赞同：3
> 
> 时间：2008-10-08T10:13:27.167
> 
> 标签：java, file, sorting, resultset

我想以排序方式将我的结果集（大约 150 万行）中的“随机”输出放入文件中。我知道我可以在查询中使用按命令排序，但该命令是“昂贵的”。你能告诉我是否有任何算法可以在文件中写入结果集行，以便最终对内容进行排序，我可以通过它获得性能吗？我使用的是 java 1.6，并且查询有多个连接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T10:15:23.200

为表中的排序标准定义一个索引，然后您可以毫无问题地使用 order by 子句并写入来自结果集中的文件。

如果您的查询有多个连接，请为连接和排序条件创建正确的索引。您可以对程序中的数据进行排序，但您会浪费时间。当受雇于学习如何正确调整/使用数据库而不是重新发明数据库引擎中已经存在的排序算法时，这段时间将更有价值。

获取数据库的分析器并检查查询的执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T10:15:40.843

根据我的经验，在数据库端排序通常一样快或更快......当然，如果您排序的列被索引

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T10:25:49.280

如果您正在从数据库中读取数据，那么如果您有适当的索引，那么获得排序输出不应该那么“昂贵”。

但是，有时对于复杂的查询，SQL 优化器很难应用索引。在这种情况下，数据库只是将结果累积到一个临时表中，然后透明地为您排序。

您不太可能匹配放入数据库引擎的优化级别；但是，如果您的问题是因为您正在对数据进行一些后处理而否定数据库所做的任何排序，那么您别无选择，只能自己排序。

同样，最简单的方法是使用 DB：只需写入具有适当索引的临时表并从那里转储即可。

如果您确定数据将始终适合 RAM，则可以在内存中对其进行排序。这是您*可能*能够击败数据库引擎的唯一情况，只是因为您知道您不需要高清访问权限。

但这是很多“如果”。更好地留在你的数据库

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T12:42:25.430

如果您需要对数据进行排序，则必须有人来做——您或数据库。将 ORDER BY 添加到查询中当然更容易。但是没有理由不能在内存中对它进行排序。最简单的方法是使用 Comparator 对排序集合（TreeSet、TreeMap）中的数据进行分块，以便对所需的列进行排序。然后写出排序后的数据。

# windows - Windows 资源管理器从哪里获得“Folder Up”和“Back”图标？

> ID：182034
> 
> 赞同：0
> 
> 时间：2008-10-08T10:20:26.827
> 
> 标签：windows, user-interface, icons, explorer

首选特定于 XP 的答案，但也欢迎其他答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T11:17:57.787

Windows、Visual Studio 和 Office 中的许多图标都随 Visual Studio 一起提供。您可以在 Common7 文件夹中找到图像库。Visual Studio 2005 专注于 Office 2003 和 Windows XP，而 Visual Studio 2008 带有许多 Vista 图标。

您不应该从系统 DLL 中读取图标，因为该图标[可能在未来的版本中不再存在，](http://blogs.msdn.com/oldnewthing/archive/2005/10/26/485133.aspx)因为它是一个实现细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T10:27:11.227

从`%windir%\System32\Shell32.dll`

# css - 有没有办法通过 CSS 增强 HTML及其 on IE 6? Internet explorer 6 seems totally ignore CSS classes or rules on select, option or optgroup tags. Is there a way to bypass that limitation (except install a recent version of IE) ? Edit : to be more precise

> ID：182035
> 
> 赞同：8
> 
> 时间：2008-10-08T10:21:08.493
> 
> 标签：css, internet-explorer, browser

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-08T10:54:00.673

[此处](http://www.456bereastreet.com/archive/200409/styling_form_controls/)和[此处](http://www.456bereastreet.com/archive/200409/styling_form_controls/)的文章中提供了有关表单元素样式有效和无效的非常详细的指南。根据我的商业经验，在 IE6 上工作的跨浏览器表单布局并非不可能（尽管您确实需要仔细测试）。执行摘要是您可以控制大小和颜色，但尝试对文本对齐等进行微观管理是一场失败的战斗。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-08T14:56:06.690

这不会完全符合您的要求，但您可以使用一些而不是使用 CSS

```
&nbsp ; 
```

对于缩进或破折号：

1级

-2级

--3级

等等

如果你不是特别喜欢这样，你可以用

```
<!--[if lt IE 7]><![endif]--> 
```

或者

```
<!--[if IE 6]><![endif]--> 
```

所以它看起来像

```
Level 1
<!--[if lt IE 7]>-<![endif]-->Level 2 
<!--[if lt IE 7]>--<![endif]--> Level 3 
```

然后你可以拥有现代浏览器的 CSS。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T13:50:14.700

查看 optgroup 标记以对 select 标记内的条目进行分组。看这里： http: [//www.netmechanic.com/news/vol4/html_no20.htm](http://www.netmechanic.com/news/vol4/html_no20.htm)为例

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T09:34:41.673

来自[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms535877(VS.85).aspx#)：

> 除了 background-color 和 color 之外，通过样式对象为选项元素应用的样式设置将被忽略。此外，直接应用于单个选项的样式设置会覆盖应用于整个 SELECT 元素的样式设置。

好的，所以......没有办法让它在 IE 上运行......

感谢马特的 nbsp；主意。我一定会使用该解决方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T10:30:14.590

选项的 IE6 css 实现是错误的（就像 IE6 的整个 css 实现一样）但是您可以使用 css 样式选项。我刚刚测试了更改选项并选择标签 bgcolor，它按预期工作。我知道的唯一无法设置样式的组件是文件输入。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T10:51:22.817

是的，您可以（在某种程度上）为它们设置样式。我有时会更改字体、背景颜色和颜色样式。

你想达到什么目的？

CSS 和 HTML 片段会很有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T15:35:53.583

您可以使用下拉菜单脚本来模拟整个事情。它会给你完全的控制权。

# ruby-on-rails - rails 资源路由中的默认段名称

> ID：182040
> 
> 赞同：3
> 
> 时间：2008-10-08T10:22:36.430
> 
> 标签：ruby-on-rails, resources, routing

我想在我的rails应用程序中创建一条路线

```
/panda/blog
/tiger/blog
/dog/blog 
```

其中 panda、tiger 和 dog 都是永久链接（对于动物类）

这样做的正常方式

```
map.resources :animals do |animal|
 animal.resource :blog
end 
```

将创建沿线的路线

```
/animals/panda/blog
/animals/tiger/blog
/animals/dog/blog 
```

但我不想要第一段，因为它总是一样的。

我知道我可以通过手动路由来做到这一点，但我想知道如何使用 rails 资源，因为拥有动物和博客是我的要求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-06-01T13:11:55.770

在 rails 3.x 中，您可以添加`path => ""`到 any`resource`或`resources`调用以从生成的路径中删除第一段。

```
resources :animals, :path => "" 
```

* * *

```
$ rake routes

    animals GET    /                   {:action=>"index", :controller=>"animals"}
            POST   /                   {:action=>"create", :controller=>"animals"}
 new_animal GET    /new(.:format)      {:action=>"new", :controller=>"animals"}
edit_animal GET    /:id/edit(.:format) {:action=>"edit", :controller=>"animals"}
     animal GET    /:id(.:format)      {:action=>"show", :controller=>"animals"}
            PUT    /:id(.:format)      {:action=>"update", :controller=>"animals"}
            DELETE /:id(.:format)      {:action=>"destroy", :controller=>"animals"} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T10:45:24.810

你可以使用这个插件：

[http://github.com/caring/default_routing/tree/master](http://github.com/caring/default_routing/tree/master)

# visual-studio - Teamcity 工件路径如何工作？

> ID：182044
> 
> 赞同：28
> 
> 时间：2008-10-08T10:23:22.497
> 
> 标签：visual-studio, teamcity, artifact

如果我想在使用 sln 2008 构建运行器并使用默认 bin/Release 构建项目的地方创建两个工件 dist 和 source，谁能给我一个示例，说明为构建配置定义的工件路径设置可能是什么样子？

```
**/Source/Code/MyProject/bin/Release/*.* => dist
**/*.* => 来源

```

我得到了两个工件根 dist 和 source 但在 dist 下我得到了我不想要的整个目录结构（Source/Code/MyProject/bin/Release），在 source 下我得到了整个目录以及 obj 和 bin/Release我不想。

您能否就如何正确执行此操作提供一些建议？

我是否需要更改我正在构建的所有项目的目标位置才能让这个东西工作？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-10T08:53:35.063

所以你只需要：

```
Source\Code\MyProject\bin\Release\* => dist
Source\**\* => source 
```

这会将 release 中的所有文件放入名为 dist 的工件文件夹中，并将 Source 中的所有文件放入名为 source 的工件文件夹中。

如果您在 Release 中有子文件夹，请尝试：

```
Source\Code\MyProject\bin\Release\**\* => dist 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-17T16:18:06.440

根据 TeamCity 文档；它应该是这样的：

```
file_name|directory_name|Ant-like wildcard [ => target_directory ] 
```

所以..

```
Source\Code\MyProject\bin\Release|**\* => dist  (| not \) 
```

# python - 在 Windows 上设置 Python 环境

> ID：182053
> 
> 赞同：4
> 
> 时间：2008-10-08T10:29:28.913
> 
> 标签：python, windows, database, installation, development-environment

如何在 Windows 计算机上设置 Python 环境，以便开始编写和运行 Python 脚本，是否有安装包？另外我应该使用哪个数据库？

* * *

我应该提到我正在将它用于基于 Web 的应用程序。它需要apache吗？还是它使用另一个http服务器？Python 运行 Web 应用程序的标准设置是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T10:31:26.180

[从python.org](http://python.org/)（[直接链接](http://python.org/ftp/python/2.6/python-2.6.msi)）下载 Python 2.6 Windows 安装程序。如果您只是在学习，请使用包含的 SQLite 库，这样您就不必摆弄数据库服务器。

* * *

大多数 Web 开发框架（Django、Turbogears 等）都带有一个内置的 webserver 命令，该命令可以在没有 Apache 的本地计算机上运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T11:12:43.227

**Bundle**：使用 Activestate 的 Python，它捆绑了许多有用的 win32 相关库。它还没有 2.6 版本，但您在网上找到的大多数代码都是指 2.5 或更低版本。

**数据库**：任何流行的开源数据库都易于配置。但正如 John 已经建议的那样，对于简单的开始内容，只需使用已经与 Python 捆绑在一起的 SQLite。

**Web 服务器**：取决于规模。是的，您可以配置 Apache，但是为了尝试简单的事情，以下是一个非常完整的 Python 网络服务器，它也将提供用 Python 编写的 CGI 脚本：

```
import CGIHTTPServer
import BaseHTTPServer

class Handler(CGIHTTPServer.CGIHTTPRequestHandler):
    cgi_directories = ["/cgi"]

PORT = 9999

httpd = BaseHTTPServer.HTTPServer(("", PORT), Handler)
print "serving at port", PORT
httpd.serve_forever() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T11:13:07.890

我强烈推荐[ActiveState Python](http://www.activestate.com/Products/activepython/index.mhtml)用于 windows 开发中的 python。它带有 Win32Com 和其他各种好东西，有一个成熟而干净的安装程序，一个 chm 版本的文档，并且运行良好。我一直使用这个。

至于数据库，Activestate 带有 odbc 支持，与 SQL server 配合得非常好。我也让它与 Sybase 和 DB2/400 一起工作（尽管后者的连接字符串往往相当复杂）。对于 Oracle，我推荐[CX_Oracle](http://python.net/crew/atuining/cx_Oracle/)作为最好的接口库。大多数专有和开源数据库（例如[MySQL](http://mysql-python.sourceforge.net/)和[PostGreSQL](http://www.pygresql.org/)）的本地驱动程序也存在。最新版本的 Python（从 IIRC 2.5 开始）标配[SQLite 。](http://www.python.org/doc/2.5.2/lib/module-sqlite3.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T13:56:21.710

我可以建议看看[Karrigell](http://karrigell.sourceforge.net/)吗？如果您不需要 Django 和 Turbogears 提供的所有东西，它确实是一个不错的 Python Web 框架。在您熟悉它们之前，使用 Web 框架可能会更容易。

对于开发，我建议下载最新的[SPE](http://pythonide.blogspot.com) IDE。它应该为您提供几乎所有您需要的工具，此外它还包括用于 GUI 开发的 wxGlade。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T10:54:18.177

安装官方（命令行）安装程序后不要忘记安装[pywin32 。](http://sourceforge.net/projects/pywin32/)这将定义额外的*开始菜单*项和非常有用的*PythonWin IDE*。

[Activestate](http://activestate.com/Products/activepython/index.mhtml)提供了两者的安装程序（还没有 2.6）。Activestate 发行版包含其他文档。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T11:12:24.113

Django 教程[如何安装 Django](http://docs.djangoproject.com/en/dev/topics/install/)提供了一个很好的例子，一个 web 开发 Python 环境的外观。

# c# - WHERE IN（ID 数组）

> ID：182060
> 
> 赞同：31
> 
> 时间：2008-10-08T10:33:12.773
> 
> 标签：c#, sql-server, tsql, ado.net, sqlparameter

我有 web 服务，它传递了一个整数数组。我想按如下方式执行 select 语句，但不断出现错误。我需要将数组更改为字符串吗？

```
[WebMethod]
public MiniEvent[] getAdminEvents(int buildingID, DateTime startDate)
{    
    command.CommandText = @"SELECT id,
                            startDateTime, endDateTime From
                            tb_bookings WHERE buildingID IN
                            (@buildingIDs) AND startDateTime <=
                            @fromDate";

    SqlParameter buildID = new SqlParameter("@buildingIDs", buildingIDs);
} 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-08T10:45:21.893

你不能（不幸地）那样做。一个 Sql 参数只能是一个值，所以你必须这样做：

```
WHERE buildingID IN (@buildingID1, @buildingID2, @buildingID3...) 
```

当然，这需要您知道有多少建筑物 ID，或者动态构建查询。

作为一种解决方法*，我做了以下事情：

```
WHERE buildingID IN (@buildingID)

command.CommandText = command.CommandText.Replace(
  "@buildingID", 
  string.Join(buildingIDs.Select(b => b.ToString()), ",")
); 
```

它将用数字替换语句的文本，结果如​​下：

```
WHERE buildingID IN (1,2,3,4) 
```

*   请注意，这接近于 Sql 注入漏洞，但由于它是一个 int 数组，因此是安全的。任意字符串*不安全*，但无法将 Sql 语句嵌入整数（或日期时间、布尔值等）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-15T18:33:18.390

首先你需要一个函数和一个存储过程。该函数将拆分您的数据并返回一个表：

```
CREATE function IntegerCommaSplit(@ListofIds nvarchar(1000))
returns @rtn table (IntegerValue int)
AS
begin
While (Charindex(',',@ListofIds)>0)
Begin
    Insert Into @Rtn 
    Select ltrim(rtrim(Substring(@ListofIds,1,Charindex(',',@ListofIds)-1)))
    Set @ListofIds = Substring(@ListofIds,Charindex(',',@ListofIds)+len(','),len(@ListofIds))
end
Insert Into @Rtn 
    Select  ltrim(rtrim(@ListofIds))
return 
end 
```

接下来你需要一个存储过程来使用它：

```
create procedure GetAdminEvents 
    @buildingids nvarchar(1000),
    @startdate datetime
as
SELECT id,startDateTime, endDateTime From
            tb_bookings t INNER JOIN 
dbo.IntegerCommaSplit(@buildingids) i
on i.IntegerValue = t.id
 WHERE startDateTime <= @fromDate 
```

最后，您的代码：

```
[WebMethod]
        public MiniEvent[] getAdminEvents(int[] buildingIDs, DateTime startDate)
        command.CommandText = @"exec GetAdminEvents";
 SqlParameter buildID= new SqlParameter("@buildingIDs", buildingIDs); 
```

这远远超出了你的问题，但它会做你需要的。

**注意：**如果你传入任何不是 int 的东西，整个数据库函数都会失败。我将错误处理留给最终用户作为练习。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-08T14:31:18.627

**注意：**我通常不喜欢使用未参数化的查询。然而，在这个例子中，鉴于我们正在处理一个整数数组，你*可以*做这样的事情，它会更有效率。但是，鉴于每个人似乎都想降级答案，因为它不符合他们的有效建议标准，我将提交另一个执行得很糟糕但可能会在 LINK2SQL 中运行的答案。

假设，正如您的问题所述，您有一个整数数组，您可以使用以下代码返回一个字符串，该字符串将包含 SQL 接受的逗号分隔列表：

```
private string SQLArrayToInString(Array a)
{
 StringBuilder sb = new StringBuilder();
 for (int i = 0; i < a.GetUpperBound(0); i++)
  sb.AppendFormat("{0},", a.GetValue(i));
 string retVal = sb.ToString();
 return retVal.Substring(0, retVal.Length - 1);
} 
```

然后，我建议您跳过尝试参数化命令*，因为这是一个整数数组，*只需使用：

```
command.CommandText = @"SELECT id,
            startDateTime, endDateTime From
            tb_bookings WHERE buildingID IN
            (" + SQLArrayToInString(buildingIDs) + ") AND startDateTime <=
            @fromDate"; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-03T22:15:50.017

一种不需要不安全代码或用户定义函数的超快 XML 方法：

您可以使用存储过程并传递以逗号分隔的 Building ID 列表：

```
Declare @XMLList xml
SET @XMLList=cast('<i>'+replace(@buildingIDs,',','</i><i>')+'</i>' as xml)
SELECT x.i.value('.','varchar(5)') from @XMLList.nodes('i') x(i)) 
```

所有功劳归于 Guru [Brad Schulz 的博客](http://beyondrelational.com/modules/2/blogs/114/posts/14617/delimited-string-tennis-anyone.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T10:37:29.163

访问[接受多个 Id 值的 T-SQL 存储过程，](https://stackoverflow.com/questions/43249/t-sql-stored-procedure-that-accepts-multiple-id-values)了解如何执行此操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-26T15:20:23.733

我使用这种方法并为我工作。

我的变量 act = 我在字符串中的 ID 列表。

> 行动 = “1, 2, 3, 4”

```
 command = new SqlCommand("SELECT x FROM y WHERE x.id IN (@actions)", conn);    
 command.Parameters.AddWithValue("@actions", act);
 command.CommandText = command.CommandText.Replace("@actions", act); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T18:26:51.647

> [网络方法]
> 
> 公共 MiniEvent[] getAdminEvents(int **buildingID** , DateTime startDate)
> 
> ...
> 
> SqlParameter buildID= new SqlParameter("@buildingIDs", **buildingIDs** );

也许我说得太详细了，但是这个方法接受一个 int，而不是一个 int 数组。如果您希望传入一个数组，则需要更新您的方法定义以拥有一个 int 数组。获得该数组后，如果您打算在 SQL 查询中使用它，则需要将该数组转换为字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-16T14:02:06.737

你可以使用这个。在 SQLServer 中执行以在您的数据库上创建一个函数（仅一次）：

```
IF EXISTS(
    SELECT *
    FROM sysobjects
    WHERE name = 'FN_RETORNA_ID_FROM_VARCHAR_TO_TABLE_INT')
BEGIN
    DROP FUNCTION FN_RETORNA_ID_FROM_VARCHAR_TO_TABLE_INT
END
GO

CREATE FUNCTION [dbo].FN_RETORNA_ID_FROM_VARCHAR_TO_TABLE_INT (@IDList VARCHAR(8000))
RETURNS
    @IDListTable TABLE (ID INT)
AS
BEGIN

    DECLARE
        --@IDList VARCHAR(100),
        @LastCommaPosition INT,
        @NextCommaPosition INT,
        @EndOfStringPosition INT,
        @StartOfStringPosition INT,
        @LengthOfString INT,
        @IDString VARCHAR(100),
        @IDValue INT

    --SET @IDList = '11,12,113'

    SET @LastCommaPosition = 0
    SET @NextCommaPosition = -1

    IF LTRIM(RTRIM(@IDList)) <> ''
    BEGIN

        WHILE(@NextCommaPosition <> 0)
        BEGIN

            SET @NextCommaPosition = CHARINDEX(',',@IDList,@LastCommaPosition + 1)

            IF @NextCommaPosition = 0
                SET @EndOfStringPosition = LEN(@IDList)
            ELSE
                SET @EndOfStringPosition = @NextCommaPosition - 1

            SET @StartOfStringPosition  = @LastCommaPosition + 1
            SET @LengthOfString = (@EndOfStringPosition + 1) - @StartOfStringPosition

            SET @IDString =  SUBSTRING(@IDList,@StartOfStringPosition,@LengthOfString)                  

            IF @IDString <> ''
                INSERT @IDListTable VALUES(@IDString)

            SET @LastCommaPosition = @NextCommaPosition

        END --WHILE(@NextCommaPosition <> 0)

    END --IF LTRIM(RTRIM(@IDList)) <> ''

    RETURN

ErrorBlock:

    RETURN

END --FUNCTION 
```

创建函数后，您必须在代码上调用它：

```
command.CommandText = @"SELECT id,
                        startDateTime, endDateTime From
                        tb_bookings WHERE buildingID IN
                        (SELECT ID FROM FN_RETORNA_ID_FROM_VARCHAR_TO_TABLE_INT(@buildingIDs))) AND startDateTime <=
                        @fromDate";

command.Parameters.Add(new SqlParameter(){
                           DbType = DbType.String,
                           ParameterName = "@buildingIDs",
                           Value = "1,2,3,4,5" //Enter the parameters here separated with commas
                       }); 
```

此函数获取“数组”上的文本内逗号，并使用此值作为 int 制作一个表，称为 ID。当此功能在您的数据库上时，您可以在任何项目中使用。

* * *

感谢微软 MSDN。

伊戈·文图拉

微软 MVA

Sistema Ari de Sá

igo1-2@hotmail.com

PS：我来自巴西。对不起我的英语... XD

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-25T10:49:29.003

这是我想出的一个 Linq 解决方案。它会自动将列表中的所有项目作为参数@item0、@item1、@item2、@item3 等插入。

```
[WebMethod]
public MiniEvent[] getAdminEvents(Int32[] buildingIDs, DateTime startDate)
{
    // Gets a list with numbers from 0 to the max index in buildingIDs,
    // then transforms it into a list of strings using those numbers.
    String idParamString = String.Join(", ", (Enumerable.Range(0, buildingIDs.Length).Select(i => "@item" + i)).ToArray());
    command.CommandText = @"SELECT id,
                        startDateTime, endDateTime From
                        tb_bookings WHERE buildingID IN
                        (" + idParamString + @") AND startDateTime <=
                        @fromDate";
    // Reproduce the same parameters in idParamString 
    for (Int32 i = 0; i < buildingIDs.Length; i++)
            command.Parameters.Add(new SqlParameter ("@item" + i, buildingIDs[i]));
    command.Parameters.Add(new SqlParameter("@fromDate", startDate);
    // the rest of your code...
} 
```

# asp.net-mvc - LINQ to SQL 表依赖

> ID：182066
> 
> 赞同：3
> 
> 时间：2008-10-08T10:37:46.027
> 
> 标签：asp.net-mvc, linq, linq-to-sql

如果我有两张桌子……类别和宠物。

LINQ to SQL 中是否有一种方法可以将连接查询的结果映射到另一个强类型类（例如：PetWithCategoryName），以便我可以将其强烈传递给 MVC 视图？

我目前有类别和宠物课程...我应该再做一个吗？

也许我在这里遗漏了一些东西。你们中的任何人都可以启发我吗？

```
from p in petTable
join c in categoryTable on p.CategoryId equals c.Id
where (c.Id == categoryId.Value)
select new
{
    p.Id, 
    p.Name,
    p.Description,
    p.Price,
    CategoryName = c.Name
}

<?xml version="1.0" encoding="utf-8" ?>
<Database Name="PetShop" xmlns="http://schemas.microsoft.com/linqtosql/mapping/2007">
  <Table Name="Category" Member="PetShop.Models.Category">
    <Type Name="PetShop.Models.Category">
      <Column Name="Id" Member="Id" IsDbGenerated="true" IsPrimaryKey="true" />
      <Column Name="Name" Member="Name" />
      <Column Name="Description" Member="Description" />
    </Type>
  </Table>
  <Table Name="Pet" Member="PetShop.Models.Pet">
    <Type Name="PetShop.Models.Pet">
      <Column Name="Id" Member="Id" IsDbGenerated="true" IsPrimaryKey="true" />
      <Column Name="Name" Member="Name" />
      <Column Name="Description" Member="Description" />
      <Column Name="ImageUrl" Member="ImageUrl" />
      <Column Name="Price" Member="Price" />
      <Column Name="CategoryId" Member="CategoryId" />
      <Association Name="FK_Pet_Category" Member="Category" ThisKey="CategoryId" OtherKey="Id" IsForeignKey="true" />
    </Type>
  </Table>
</Database> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T11:58:39.607

> 我将如何使用 LoadWith？我在网上找不到太多帮助。有什么好的资源吗？

我在网上找到了这个：http: [//blogs.msdn.com/wriju/archive/2007/10/04/linq-to-sql-change-in-datacontext-from-beta-1-to-beta-2.aspx](http://blogs.msdn.com/wriju/archive/2007/10/04/linq-to-sql-change-in-datacontext-from-beta-1-to-beta-2.aspx)

你会做这样的事情：

```
var loadOption = new DataLoadOptions();           
loadOption.LoadWith<Pets>(p => p.Category);
db.LoadOptions = loadOption; 

var pets = from p in PetStoreContext.Pets
           select p; 
```

然后您的宠物查询将已经包含类别，因此当您尝试访问类别时不会访问数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T11:40:56.383

如果您使用 LoadWith LoadOption 那么您的 Pet 查询将对类别进行急切加载，这样您就可以做到

MyPet.Category.Name 不会产生额外的查询，因此您将连接数据并进行强类型化，而不会在循环或绑定 Pet 集合时为类别运行多个查询。

或者你可以在 Linq To SQL 中使用存储过程，结果是强类型的。

# c# - 序列化问题

> ID：182070
> 
> 赞同：3
> 
> 时间：2008-10-08T10:39:09.720
> 
> 标签：c#, serialization

情况是这样的：主项目A.和一个类库B.A**引用B**

项目 B 具有将被序列化的类。这些类在 A 中使用。现在，当从 Project AI 尝试序列化 B 中的对象时出现问题。抛出异常，表示 A 中的类无法序列化。这是奇怪的部分，因为在 BI 中的类中不能引用 A 中的那些。（将创建循环依赖项）。

我怎样才能找到问题？因为异常方法没有说明问题出现在哪里？

**编辑：好的，我在****Kent Boogaart 的**小应用程序 的帮助下发现了问题：D。我在项目 A 的一个类中有一个 PropertyChanged 侦听器，它没有标记为 Serializable - 我不想这样标记它。（它会将该类序列化为正确的？）

我通过以下链接解决了事件问题：[.NET 2.0 solution to serialization of objects that raise events](http://www.lhotka.net/weblog/CommentView,guid,776f44e8-aaec-4845-b649-e0d840e6de2c.aspx#commentstart)。仍然存在问题，但它可能是类似的东西。

**PS：**来自**Kent Boogaart的好工具**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-08T10:44:52.877

我编写了一个名为[sertool](http://kent-boogaart.com/blog/sertool)的工具，它会告诉您对象图中的哪些内容不能被序列化以及它是如何被引用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T10:51:04.237

您首先需要将问题隔离到特定的类。然后您可以实现自定义序列化并对其进行调试以找到真正的问题。

只是一个简单的实现，让您逐步完成该过程：

```
using System;
using System.Runtime.Serialization;
using System.Security.Permissions;

[Serializable]
public class Test : ISerializable
{
    private Test(SerializationInfo info, StreamingContext context)
    {
        PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(typeof(Test));

        foreach (SerializationEntry entry in info)
        {
            PropertyDescriptor property = properties.Find(entry.Name, false);
            property.SetValue(this, entry.Value);
        }
    }

    [SecurityPermission(SecurityAction.LinkDemand, SerializationFormatter = true)]
    void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
    {
        PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(typeof(Test));

        foreach (PropertyDescriptor property in properties)
        {
            info.AddValue(property.Name, property.GetValue(this));
        }
    }
} 
```

Kent 的工具看起来也很漂亮，毫无疑问，它会帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T10:43:29.337

也许您来自 B 的对象正在使用不属于 A 或 B 的类/接口存储对来自 A 的对象的引用，例如，如果 B 使用对象 (System.Object) 引用从 A 存储对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T11:19:40.387

假设 TA 和 TB 是在 A 和 B 中定义的类型。假设在 B 或 B 和 A 引用的程序集中有一个接口 I。TA 实现了 I。TB 有一个名为 P 的类型 I 的公共可设置属性。

您现在可以这样做：

```
TB b = new TB();
b.P = new TA(); 
```

由于 TA 实现了 I，因此这是可能的。

现在您的对象图有一个类型的实例，该实例可能无法序列化并且来自程序集 A。

# javascript - 什么会更快 Flash 或 Javascript？

> ID：182071
> 
> 赞同：3
> 
> 时间：2008-10-08T10:39:30.280
> 
> 标签：javascript, flash

我有一个网站的想法，它涉及一个没有大小限制的画布区域。基本上你可以在画布上添加项目（笔记、照片等等）。然后，您可以拖动画布，将这些项目与画布一起移动，直到它们从屏幕上消失。如果您将画布向后拖动，它们将再次出现。

问题：Flash 或 Javacsript 哪个最适合这种类型的东西？

我主要担心的是 javascript/flash 以所述方式在屏幕上移动多个项目的速度。对于慢速机器上的用户来说，哪种语言处理得更好。

**更新：**

感谢您的意见，但要澄清画布与直接 jQuery DOM 操作相比有什么好处？反之亦然。我以前从未使用过画布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T12:35:55.960

我不认为这个问题会给你一个客观的答案——Flash 开发人员会告诉你 Flash 更好，Web 开发人员会说 JavaScript。为了保持客观，我想说这两种技术都适合您所描述的，但具有不同的优势。

Flash 肯定会渲染得更快，即使在慢速机器上也是如此，并且图形更加丰富。

JavaScript 更易于访问并且可以在更多的设备上运行。不过使用一个好的 JS 框架。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T10:41:42.553

我最初的想法是使用 Javascript——如果它对谷歌地图来说足够好，那么它对你的应用程序也可能足够好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T11:02:59.843

您是否需要使用画布，您所描述的可以仅使用 javascript 和 DOM 来完成。除非有大量元素，否则它会表现得非常好，并且它是跨浏览器兼容的。对于画布，您需要[exCanvas](http://excanvas.sourceforge.net/)支持 IE，这有时会减慢速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T11:27:38.670

最好的方法肯定是 Javascript。我什至会说你应该重新考虑使用画布。听起来它可以在纯 DHTML 中完成。这样你就不会失去对 IE 的支持。

考虑使用其中一种 javascript 框架；想到原型或 jQuery。它将极大地简化您的编码。鉴于 javascript 引擎性能的发展（Webkit (Squirrelfish Extreme) 和 Mozilla (TraceMonkey) 的下一个版本将快如闪电），对性能的担忧可能没有实际意义。

此外，如果您决定没有画布就无法做到这一点，请考虑使用 John Resig 的[processing.js](http://ejohn.org/blog/processingjs/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T04:13:44.240

我会说使用闪存（如果您不需要额外的冲击力，则使用 DOM）。这是我的推理：

*   您可以使用画布进行很酷的转换（倾斜、旋转、图像中的渐变淡入、反射效果等），而使用 DOM 则无法做到。缺点是做这些很酷的事情需要大量的数学运算。

*   画布在 IE 中不起作用。IE 的等价物 (VML) 显然有一个根访问安全漏洞。

*   DOM 比 canvas 存在的时间更长，并且由于它被更广泛地使用（和依赖），它比 canvas 更优化和完善。

*   Flash 社区有很多很好的免费组件，它们可能已经完全可以满足您的需求。

*   Flash 和 DOM 有很多很好的文档和教程，canvas 没有那么多。

*   Flash 几乎可以做 DOM 和画布可以做的所有事情，以及音频、视频和从网络摄像头抓取输入。

# java - 如何使用 oracle.jdbc.driver.OracleLog？

> ID：182073
> 
> 赞同：2
> 
> 时间：2008-10-08T10:39:57.550
> 
> 标签：java, oracle, logging, jdbc, oracle10g

尝试获取与 10g 数据库的连接时，我收到来自 Oracle JDBC 驱动程序 (ojdbc14_g.jar) 的错误。该驱动程序有一个 oracle.jdbc.driver.OracleLog 类可以提供帮助，但 Oracle 文档不清楚如何最好地使用它。有没有人成功使用过这个类？如果是这样，将不胜感激有关其使用的一些指导。

有关信息，我从 JDBC 驱动程序得到的错误是：

```
java.sql.SQLException: No more data to read from socket
    at oracle.jdbc.driver.DatabaseError.throwSqlException
        (DatabaseError.java:112)
    at oracle.jdbc.driver.DatabaseError.throwSqlException
        (DatabaseError.java:146)
    at oracle.jdbc.driver.DatabaseError.throwSqlException
        (DatabaseError.java:208)
    at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1
        (T4CMAREngine.java:1118)
    at oracle.jdbc.driver.T4CMAREngine.unmarshalSB1
        (T4CMAREngine.java:1070)
    at oracle.jdbc.driver.T4CTTIoauthenticate.receiveOsesskey
        (T4CTTIoauthenticate.java:266)
    at oracle.jdbc.driver.T4CConnection.logon
        (T4CConnection.java:357)
    at oracle.jdbc.driver.PhysicalConnection.<init>
        (PhysicalConnection.java:414)
    at oracle.jdbc.driver.T4CConnection.<init>
        (T4CConnection.java:165)
    at oracle.jdbc.driver.T4CDriverExtension.getConnection
        (T4CDriverExtension.java:35)
    at oracle.jdbc.driver.OracleDriver.connect
        (OracleDriver.java:801)
    at oracle.jdbc.pool.OracleDataSource.getPhysicalConnection
        (OracleDataSource.java:297)
    at oracle.jdbc.pool.OracleDataSource.getConnection
        (OracleDataSource.java:221)
    at oracle.jdbc.pool.OracleDataSource.getConnection
        (OracleDataSource.java:165) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T20:58:25.930

谷歌刚刚为我找到了[这个](http://www.oracle.com/technology/tech/java/sqlj_jdbc/htdocs/jdbc_faq.htm#36_00 "Oracle JDBC 常见问题解答")。

另外，请尝试使用 java.sql.DriverManager.setLog(Stream|Writer) 并查看是否可以为您提供有关正在发生的事情的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T23:52:31.757

日志记录通常太低，除了 Oracle 支持之外的任何人都无法解释。

无论如何，上面的代码表明客户端和服务器之间存在一些网络连接问题（预计会从 TCP 套接字读取更多数据，但不知何故被中断了）。你使用什么样的网络？您检查了服务器侦听器上的状态和错误日志？

# wpf - WPF 快速入门文档

> ID：182075
> 
> 赞同：18
> 
> 时间：2008-10-08T10:40:30.123
> 
> 标签：wpf, documentation

我对 WPF 完全陌生，正在寻找好的快速入门文档。我会从 Adam Nathan 那里购买《WPF Unleashed》一书，但我认为这与其说是快速入门，不如说是参考。
我只是想让你告诉我你最喜欢的链接和书籍，也许还有关于 wpf 开发的演示应用程序。

答案的重点应该是最佳实践、可读性好的介绍（我讨厌 msdn 上的链接农场；）和全面的参考资料。

编辑：我将尝试将所有建议汇总在按类型排序的简短列表中。并且请尝试给出一个简短的理由*，为什么*您特别建议该链接或那本书。

**图书：**

*   [亚当·内森 (Adam Nathan) 发布的 WPF](https://rads.stackoverflow.com/amzn/click/com/0672328917)
*   Pro WPF：.NET 3.0 中的 Windows Presentation Foundation
*   [Chris Sells 和 Ian Griffiths 编写的 WPF 编程](https://rads.stackoverflow.com/amzn/click/com/0596510373)

**博客：**

*   [Beatriz Costa 撰写的关于 WPF 中数据绑定的博客](http://www.beacosta.com/blog/)
*   [问 WPF 博士](http://www.drwpf.com/blog/)
*   [WPF 导览](http://joshsmithonwpf.wordpress.com/a-guided-tour-of-wpf/)

**链接：**

*   微软关于 WPF[的 MSDN 动手实验室](http://www.microsoft.com/switzerland/msdn/de/presentationfinder/detail.mspx?id=104056)
*   [msdn 关于 WPF 入门](http://msdn.microsoft.com/en-us/library/ms742119.aspx)
*   [windowsclient.net](http://windowsclient.net/)
*   [Lernwpf.com](http://learnwpf.com/)
*   [Codeproject系列文章](http://www.codeproject.com/KB/WPF/BeginWPF1.aspx)
*   [windowsclient.net 上的一些 WPF 视频](http://windowsclient.net/learn/videos_wpf.aspx)

**演示应用程序：**

*   来自 Vertigo 的[Family.Show](http://www.vertigo.com/familyshow.aspx)
*   [宝贝粉碎](http://www.hanselman.com/babysmash/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T10:45:30.487

查看有关 WPF的[Channel9](http://channel9.msdn.com/Media/Screencasts/)[视频](http://channel9.msdn.com/Media/Videos/)和截屏视频。

[另一个入门资源是windowsclient.net](http://windowsclient.net)上的 Microsoft WPF 官方站点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T10:50:33.783

我最喜欢的书是 Pro WPF：.NET 3.0 中的 Windows Presentation Foundation ( [http://www.apress.com/book/view/1590597826](http://www.apress.com/book/view/1590597826) )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T14:09:16.690

有一个出色的[动手实验室，用于使用 Blend 和 Visual Studio 构建 Outlook 风格的 UI](http://www.microsoft.com/switzerland/msdn/de/presentationfinder/detail.mspx?id=104056)。它在 Blend 2.5 方面有点过时，但它有助于学习如何使用 WPF 和有效地使用 Blend。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T10:29:34.837

我已经阅读了市场上的大多数 WPF 书籍。由 Chris Sells 和 Ian Griffiths 编写的 WPF 编程是最好的，Pro WPF 是第二好的恕我直言。只是我的两分钱。

# testing - 模拟 WAN 网络的最佳方法

> ID：182077
> 
> 赞同：11
> 
> 时间：2008-10-08T10:40:43.990
> 
> 标签：testing, networking, bandwidth, wan

简而言之，我有一个应用程序，其中数据旨在通过互联网在两台服务器之间流动。理想情况下，我想测试软件在什么时候停止运行。在什么下限（带宽、延迟、丢弃的数据包）下，事情会停止工作以测试软件的可靠性。

我想我会做的是以下几点：

1.  设置 3 台机器（VMware 实例）
2.  在两台服务器上安装 2 个应用程序。
3.  通过在 Windows 2003 上使用路由和远程访问来设置第三台服务器以坐在两台机器之间
4.  安装[Traffic Shaper XP](http://bandwidthcontroller.com/trafficShaperXp.html)或[NetLimiter](http://netlimiter.com/)以限制带宽
5.  运行类似[TMnetSim 网络模拟器](http://www.tmurgent.com/download%5CTMnetsim32_02040000.zip)的东西来模拟一个坏的连接。

这听起来是个好主意还是有更简单/更好的方法来做到这一点？我在 Linux 上不太舒服，我的队友更不习惯。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-06T05:53:51.950

[WANem](http://wanem.sourceforge.net/)正是这样做的。我们在桌面上的虚拟机和专用的旧电脑上都使用过它，效果很好。它可以模拟各种断开的连接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T11:49:08.377

FreeBSDs ipfw 提供了模拟具有给定带宽、延迟或错误率的链接。您可以在上述设置中使用该 FreeBSD 机器作为“中间”机器。

如果您想减少所涉及的服务器数量，您可能还可以在同一台机器上运行至少一个端点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-10T01:11:55.383

也许是时候了解一下 Linux 了，因为只需键入一行就可以在每个传出数据包上添加 50 毫秒的延迟：

```
tc qdisc add dev eth0 root netem delay 50ms 
```

有关更多信息，请参阅[Linux 流量控制 HOWTO](http://lartc.org/howto/lartc.qdisc.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T22:53:03.170

有人实际上打包了 FreeBSD 解决此问题所需的设置和其他东西，他们称之为[DUMMYNET](http://info.iet.unipi.it/~luigi/ip_dummynet/)。

> 它模拟/强制执行队列和带宽限制、延迟、数据包丢失和多路径效应。它还实现了加权公平队列的一种变体，称为 WF2Q+。它可以在用户的​​工作站上使用，或者在 FreeBSD 机器上用作路由器或网桥。

它可以准确地模拟您想要的东西，而且它是免费的，并且可以启动到商品硬件上。他们甚至有一个罐头安装，它小到可以放在软盘上（！），您可以从该链接下载。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T11:52:49.727

大约十年前我们有类似的要求——我会看看我是否能回忆起我们是如何管理它的。

如果我记得，我们在 UNIX 机器上编写了一个由 inetd 控制的套接字代理程序。此套接字将接受来自客户端的连接并打开到服务器的等效会话。然后它会循环，双向传递消息。

我们实现 WAN 特性的方法是在连接建立和链路建立后的数据传递中引入随机延迟（有上限和下限）。

它还具有偶尔断开链接的功能，因为 WAN 链接对我们来说不如本地流量可靠。

我记得我们必须使其线程化以阻止延迟影响链接上的反向流量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-15T20:09:25.590

有一个非常好的（免费的）微软解决方案，我们使用了很长一段时间，效果很好，它可以很容易地模拟每件事（丢包、低带宽、断开连接、延迟......）这是我为 Windows 环境找到的最佳解决方案

更多信息和下载链接可在此处找到：[MARCO 博客文章](http://blog.mrpol.nl/2010/01/14/network-emulator-toolkit/)

该产品经过了一些改进，现在作为自动化测试的一部分集成到了 Visual Studio 中，但我发现使用独立的（很难找到，所以保留一个本地副本）工作得更好。请记住，您至少需要两台计算机（或虚拟机），因为您需要通过网络适配器才能使应用程序发挥其魔力。

# asp.net - 如何在属性中对属性进行数据绑定

> ID：182082
> 
> 赞同：0
> 
> 时间：2008-10-08T10:42:19.090
> 
> 标签：asp.net, vb.net, data-binding

我现在有一个像下面这样的设置

```
Public ClassA

property _classB as ClassB

End Class

Public ClassB

property _someProperty as someProperty 

End Class 
```

我想做的是将对象A数据绑定到gridview，其中一列数据绑定到ClassB._someProperty。当我尝试将其作为 Classb._someProperty 进行数据绑定时，我收到“在选定数据源上找不到字段或属性”错误

我尝试使用 objectContainerDataSource 并直接绑定到 gridview，但没有成功。

过去有没有人遇到过这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T10:51:34.673

普通数据绑定通常不允许表达式。在后台，数据网格使用反射（而不是像 DataBinder.Eval 在 ASP.NET 页面上那样执行代码）来查找您指定绑定到列的属性。要执行您想要的操作，需要将绑定评估为表达式，确定您正在寻找父 -> 子关系，然后反映到该级别。AFAIK 网格上的内置数据绑定太笨了，不知道该怎么做。

我最近遇到了同样的问题，我的解决方案是进行 LINQ 投影并将其绑定到网格。类似于以下内容（在 C# 中，因为我对 VB 中的 LINQ 语法不满意）：

```
IList<ClassA> listOfClassAObjects = GetMyListOfClassAObjectsFromSomewhere();
var projection = from ClassA a in listOfClassAObjects
                 select new { SomeProperty = a.SomeProperty, 
                              SomeOtherProperty = a.SomeOtherProperty,
                              SomePropertyFromB = a.ClassB.SomeProperty };
datagrid.DataSource = projection;
datagrid.DataBind(); 
```

您将获得包含该投影的匿名类型列表，并且可以将相应的列绑定到`SomePropertyFromB`.

For extra encapsulation (if you do this a lot) put the projection into an extension method so you can do something like

```
var data = GetMyListOfClassAObjectsFromSomewhere().ProjectionForDataGrid();
datagrid.DataSource = data;
datagrid.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T14:02:07.330

I found the way to do this is to use a template field and eval (see below)

Set the datafield as property classB and then:

```
<asp:TemplateField HeaderText="_someProperty">
<ItemTemplate>       
                           <%#Eval("classB._someProperty")%>

</ItemTemplate>
</asp:TemplateField> 
```

# algorithm - 从成对距离集中确定点

> ID：182086
> 
> 赞同：7
> 
> 时间：2008-10-08T10:43:29.227
> 
> 标签：algorithm, geometry, matrix

给定点之间的距离矩阵，是否有一种算法可以确定一组具有这些距离的 n 维点？（或至少最小化错误）

有点像收费公路问题的 n 维版本。

我能想到的最好的方法是使用多维缩放。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T16:31:25.140

您在多维缩放 (MDS) 方面走在正确的轨道上，但 MDS 对于大型数据集是不切实际的，因为它的时间复杂度是点数的二次方。你可能想看看 FastMap，它具有线性时间复杂度，更适合索引。看：

> Christos Faloutsos 和 King-Ip Lin：“FastMap：传统和多媒体数据集的索引、数据挖掘和可视化的快速算法，在*Proc. SIGMOD*中，1995 年，[doi:10.1145/223784.223812](http://dx.doi.org/10.1145/223784.223812)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-01T04:46:26.557

您可以“作弊”并为此使用迭代数值方法。最初将所有点置于某些“随机”位置，然后循环遍历它们，使它们按所需距离成比例地彼此远离。这将更喜欢一些点，但在应用它们之前取平均移动，然后应用平均将消除这个问题。这是一个 O(n²) 算法，但实现和理解非常简单。在下面的二维示例中，误差为 << 10%，但如果给定的距离不切实际，它可能表现不佳。

C++ 示例：

```
#include <conio.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>

#define DAMPING_FACTOR 0.99f

class point
{
public:
    float x;
    float y;
public:
    point() : x(0), y(0) {}
};

// symmetric matrix with distances
float matrix[5][5] =    {
                            { 0.0f, 4.5f, 1.5f, 2.0f, 4.0f },
                            { 4.5f, 0.0f, 4.0f, 3.0f, 3.5f },
                            { 1.5f, 4.0f, 0.0f, 1.0f, 5.0f },
                            { 2.0f, 3.0f, 1.0f, 0.0f, 4.5f },
                            { 4.0f, 3.5f, 5.0f, 4.5f, 0.0f }
                        };
int main(int argc, char** argv)
{
    point p[5];
    for(unsigned int i = 0; i < 5; ++i)
    {
        p[i].x = (float)(rand()%100)*0.1f;
        p[i].y = (float)(rand()%100)*0.1f;
    }

    // do 1000 iterations
    float dx = 0.0f, dy = 0.0f, d = 0.0f;
    float xmoves[5], ymoves[5];

    for(unsigned int c = 0; c < 1000; ++c)
    {
        for(unsigned int i = 0; i < 5; ++i) xmoves[i] = ymoves[i] = 0.0f;
        // iterate across each point x each point to work out the results of all of the constraints in the matrix
        // collect moves together which are slightly less than enough (DAMPING_FACTOR) to correct half the distance between each pair of points
        for(unsigned int i = 0; i < 5; ++i)
        for(unsigned int j = 0; j < 5; ++j)
        {
            if(i==j) continue;
            dx = p[i].x - p[j].x;
            dy = p[i].y - p[j].y;
            d = sqrt(dx*dx + dy*dy);
            dx /= d;
            dy /= d;
            d = (d - matrix[i][j])*DAMPING_FACTOR*0.5f*0.2f;

            xmoves[i] -= d*dx;
            ymoves[i] -= d*dy;

            xmoves[j] += d*dx;
            ymoves[j] += d*dy;
        }

        // apply all at once
        for(unsigned int i = 0; i < 5; ++i)
        {
            p[i].x += xmoves[i];
            p[i].y += ymoves[i];
        }
    }

    // output results
    printf("Result:\r\n");
    for(unsigned int i = 0; i < 5; ++i)
    {
        for(unsigned int j = 0; j < 5; ++j)
        {
            dx = p[i].x - p[j].x;
            dy = p[i].y - p[j].y;
            printf("%f ", sqrt(dx*dx + dy*dy));
        }
        printf("\r\n");
    }

    printf("\r\nDesired:\r\n");
    for(unsigned int i = 0; i < 5; ++i)
    {
        for(unsigned int j = 0; j < 5; ++j)
        {
            printf("%f ", matrix[i][j]);
        }
        printf("\r\n");
    }

    printf("Absolute difference:\r\n");
    for(unsigned int i = 0; i < 5; ++i)
    {
        for(unsigned int j = 0; j < 5; ++j)
        {
            dx = p[i].x - p[j].x;
            dy = p[i].y - p[j].y;
            printf("%f ", abs(sqrt(dx*dx + dy*dy) - matrix[i][j]));
        }
        printf("\r\n");
    }

    printf("Press any key to continue...");

    while(!_kbhit());

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T11:48:26.833

[Programming Collective Intelligence](https://rads.stackoverflow.com/amzn/click/com/0596529325) , p.中有一个算法可以做到这一点。49，“在二维中查看数据”，可适用于 n 维。

嘿 - 这是多维缩放 - 所以我猜你是在正确的轨道上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T11:47:32.203

我无法编辑原件，因为我没有足够的代表，但我试图在这里重申问题。

OP 有一个输入 NxN 距离矩阵。他想创建一个大小为 N 的输出数组，其 N 维坐标表示点，其中每个点之间的距离存储在输入矩阵中。

请注意，这在一般情况下是无法解决的：

假设我有一个这样的矩阵

```
   美国广播公司  
一个 x 1 2  
乙×0  
Cx  

```

A 距离 B 1 个单位的距离（例如 1 米），A 距离 C 1 米。但 B 和 C 在同一个位置。

在这种特殊情况下，误差的最小总和为 1 米，并且有无数种解决方案可以实现该结果

# jquery - Web App 可在不刷新页面的情况下最好地添加、删除和编辑行

> ID：182088
> 
> 赞同：0
> 
> 时间：2008-10-08T10:43:31.583
> 
> 标签：jquery, asp.net-mvc, ajax

我正在编写一个 Time Sheeting Web 应用程序，其中涉及用户输入他们本周的任务。我不想刷新页面，所以我正在探索在客户端浏览器上使用 JavaScript 添加/删除/编辑任务的方法。

目前我正在使用 ASP.NET-MVC、Ajax、JQuery 和 LiveValidation，并且我取得了稳定（如果缓慢）的进展。

我有兴趣看看这是否是一个已解决的问题以及各种方法的优缺点。

例如，我当前添加新任务（类别/活动/时间）的方法涉及使用 LiveValidation 和 Web 服务调用来检查类别/活动的基本验证。如果所有字段都有效，我将创建一个新表行来显示任务并隐藏它。接下来，我再次调用 Web 服务以将任务添加到数据库，并在成功时显示新行并启用它以进行删除/编辑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T12:47:39.680

我建议使用 ExtJS。它是一个用于更多“应用程序”的库，例如 Web 应用程序中的界面。包括一个`EditorGridPanel`类，它可以很容易地做你正在寻找的东西。它看起来很棒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T11:22:23.627

为什么不在单个请求中验证和添加数据？如果数据未验证，则返回 false 并带有错误字段，如果验证，则返回 true 并带有新创建的任务 ID。您不需要验证和添加单独的请求。

# visual-studio - 用于多个可部署项目的 Visual Studio 解决方案结构

> ID：182096
> 
> 赞同：7
> 
> 时间：2008-10-08T10:46:03.187
> 
> 标签：visual-studio, structure, solution

### 设想：

目前，我们有一个支持单个可部署实体的单一解决方案，即 WinForm/WPF 客户端，该解决方案具有层架构，其中项目代表不同层（数据、业务、UI）。我们将介绍其他可部署的实体，例如 LiteClient、Server 和 RIA。

我们正在考虑进行重组，我们将有多个解决方案，每个可部署实体一个（客户端解决方案、服务器解决方案、RIA 解决方案等），这些解决方案将共享各种项目，例如数据层项目。这本质上是微软 P&P 小组推荐的分区单一解决方案 ( [http://msdn.microsoft.com/en-us/library/Ee817674(pandp.10).aspx](http://msdn.microsoft.com/en-us/library/Ee817674(pandp.10).aspx) )

### 问题：

除了这种方法的管理开销之外，如果我们采用它，是否有任何严肃的现实世界等着我们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T11:40:19.037

这是合理且正常的做法。归根结底，Visual Studio 解决方案只是包含部署信息的项目集合。

为了减少可能的依赖问题，请确保使用负责编译和部署的构建服务器（TFS 或其他）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T10:51:55.060

如果您更改共享项目中的某些内容，则必须检查这是否没有破坏依赖项目。如果您将这些项目保存在单独的解决方案中，则必须记住每次修改共享项目时都重新编译它们。

这是我可以看到的一个缺点。

# sql-server - SQL Server 2000 实时数据镜像

> ID：182101
> 
> 赞同：2
> 
> 时间：2008-10-08T10:48:37.953
> 
> 标签：sql-server, database, sql-server-2000, mirror

我目前正在使用 2 个 sql 2000 服务器，其中一个我可以查询但不添加任何数据库，这会导致第二个数据库有很多使用第一个作为链接服务器的查询。我想在查询实时数据的同时提高性能。

是否可以将实时数据镜像到第二台服务器，这样查询将在该服务器本地？我有哪些选择？

如果需要从 sql 2000 升级，这是可能的。

数据具有低更新、插入、删除使用和高选择使用，所以我认为如果可能的话这将是理想的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T11:34:41.667

你有三个选择。

1.  使用复制将数据从第一台服务器移动到第二台服务器。由于需要为每个更改拆除和设置复制，这具有使更改极其困难的缺点。

2.  在 SQL 2000 中使用日志传送。这个想法是，在主服务器上发生更改后，数据会立即传输到备用服务器。我没有这样做，所以我个人不知道缺点。 [http://www.microsoft.com/technet/prodtechnol/sql/2000/maintain/logship1.mspx](http://www.microsoft.com/technet/prodtechnol/sql/2000/maintain/logship1.mspx)

3.  升级到 SQL 2005 或 SQL 2008 并使用其内置的镜像功能。请注意，您应该进行一些相当深入的测试，以确保在像这样的重大升级后一切正常。虽然兼容，但我不得不在升级后对某些应用程序查询进行调整，以保持一切正常运行。

# sql - SQL - 状态机 - 基于变更集报告历史数据

> ID：182130
> 
> 赞同：1
> 
> 时间：2008-10-08T10:55:38.877
> 
> 标签：sql, postgresql

我想记录用户状态，然后能够根据我们保留的更改记录进行历史报告。我正在尝试在 SQL 中执行此操作（使用 PostgreSQL），并且我有一个用于记录用户更改的建议结构，如下所示。

```
CREATE TABLE users (
  userid SERIAL NOT NULL PRIMARY KEY, 
  name VARCHAR(40), 
  status CHAR NOT NULL
);

CREATE TABLE status_log (
  logid SERIAL, 
  userid INTEGER NOT NULL REFERENCES users(userid), 
  status CHAR NOT NULL, 
  logcreated TIMESTAMP
); 
```

这是我根据数据提出的表结构。

对于状态字段，“a”代表活动用户，“s”代表暂停用户，

```
INSERT INTO status_log (userid, status, logcreated) VALUES (1, 's', '2008-01-01'); 
INSERT INTO status_log (userid, status, logcreated) VALUES (1, 'a', '2008-02-01'); 
```

因此，该用户在 1 月 1 日被暂停，并在 2 月 1 日再次活跃。

如果我想在 2008 年 1 月 15 日获得暂停的客户列表，那么应该显示用户 ID 1。如果我在 2008 年 2 月 15 日收到一份暂停的客户名单，那么用户 ID 1 应该不会出现。

1）这是为这种查询构建数据的最佳方式吗？

2）我如何查询此结构或您建议的修改结构中的数据，以便我可以简单地有一个日期（比如 1 月 15 日）并仅在 SQL 中找到在该日期具有活动状态的客户列表？这是 SQL 的工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T11:33:09.410

这可以做到，但如果您存储每个日志的结束日期，效率会高得多。使用您的模型，您必须执行以下操作：

```
select l1.userid
from status_log l1
where l1.status='s'
and l1.logcreated = (select max(l2.logcreated)
                     from status_log l2
                     where l2.userid = l1.userid
                     and   l2.logcreated <= date '2008-02-15'
                    ); 
```

使用附加列，它更像是：

```
select userid
from status_log
where status='s'
and logcreated <= date '2008-02-15'
and logsuperseded >= date '2008-02-15'; 
```

（对任何语法错误表示歉意，我不知道 Postgresql。）

为了解决菲尔提出的一些进一步的问题：

> 用户可能会从活动状态变为暂停状态、取消状态、再次活动状态。这是一个简化版本，实际上，还有更多的状态，人们可以直接从一个状态移动到另一个状态。

这将出现在表格中，如下所示：

```
userid  from       to         status
FRED    2008-01-01 2008-01-31 s
FRED    2008-02-01 2008-02-07 c
FRED    2008-02-08            a 
```

我使用 null 作为当前记录的“到”日期。我本可以使用像 2999-12-31 这样的未来日期，但在某些方面 null 更可取。

> 此外，当前状态也没有“结束日期”，所以我认为这会稍微破坏您的查询？

是的，我的查询必须重写为

```
select userid
from status_log
where status='s'
and logcreated <= date '2008-02-15'
and (logsuperseded is null or logsuperseded >= date '2008-02-15'); 
```

这种设计的一个缺点是，每当用户的状态发生变化时，您都必须结束他们当前的 status_log 的日期并创建一个新的。但是，这并不难，我认为查询优势可能超过了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T20:30:09.840

Postgres 是否支持分析查询？这将为 2008-02-15 上的活跃用户提供

```
select userid
from
(
select logid, 
       userid, 
       status, 
       logcreated,
       max(logcreated) over (partition by userid) max_logcreated_by_user
from   status_log
where  logcreated <= date '2008-02-15'
)
where  logcreated = max_logcreated_by_user
  and  status     = 'a'
/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T13:54:18.390

@Tony“结束”日期不一定适用。

用户可能会从活动状态变为暂停状态、取消状态、再次活动状态。这是一个简化版本，实际上，还有更多的状态，人们可以直接从一个状态移动到另一个状态。

此外，当前状态也没有“结束日期”，所以我认为这会稍微破坏您的查询？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T20:24:25.093

@菲尔

我喜欢托尼的解决方案。它似乎最恰当地模拟了所描述的情况。任何特定用户都具有给定时间段（一分钟、一小时、一天等）的状态，但它是持续时间的，而不是瞬间的。由于您想知道谁在特定时间段内活跃，因此将信息建模为持续时间似乎是最好的方法。

我不确定其他状态是否有问题。如果某人处于活动状态，然后被暂停，然后被取消，然后再次处于活动状态，那么这些状态中的每一个都将适用于给定的持续时间，不是吗？它可能是很短的持续时间，例如几秒钟或一分钟，但它们仍然会持续很长时间。

您是否担心一个人的状态在一天内可能会发生多次变化，但您想知道谁在一天内处于活跃状态？如果是这样，那么您只需要更具体地定义在特定日期活跃的含义。如果他们在当天的任何时间都活跃就足够了，那么托尼的回答就可以了。如果它们必须在给定的一天内活动一段时间，则可以修改 Tony 的解决方案以简单地确定时间长度（以小时、分钟或天为单位），并在 WHERE 子句中添加更多限制检索适当的日期、状态和处于该状态的时间长度。

至于当前状态没有“结束日期”，只要结束日期可以为空，那也没有问题。只需使用类似“WHERE enddate <= '2008-08-15' or enddate is null”的内容。

# java - Validate 接口的继承设计

> ID：182133
> 
> 赞同：1
> 
> 时间：2008-10-08T10:56:38.967
> 
> 标签：java, inheritance, interface

我从来没有这么擅长设计，因为有很多不同的可能性，它们都有优点和缺点，我永远不知道该选择哪一个。无论如何，这是我的问题，我需要许多不同的松散相关的类来进行验证。但是，其中一些类需要额外的信息来进行验证。我想要一个`validate`可用于验证 Object 的方法，并且我想确定 Object 是否可以通过接口验证，比如`Validatable`. 以下是我可以拥有的两个基本解决方案。

```
interface Validatable {
  public void validate() throws ValidateException;
}
interface Object1Validatable {
  public void validate(Object1Converse converse) throws ValidateException;
}
class Object1 implements Object1Validatable {
  ...
  public void validate() throws ValidateException {
    throw new UnsupportedOperationException();
  }
}
class Object2 implements Validatable {
  ...
  public void validate() throws ValidateException {
    ...
  }
} 
```

这是第一个解决方案，我有一个通用的全局接口，可以验证的东西实现并且我可以`validate()`用来验证，但 Object1 不支持这个，所以它有点失效，但 Object2 确实支持它，许多其他类也可以。

或者，我可以拥有以下内容，这将使我没有顶级界面。

```
interface Object1Validatable {
  public void validate(Object1Converse converse) throws ValidateException;
}
class Object1 implements Object1Validatable {
  ...
  public void validate(Object1Converse converse) throws ValidateException {
    ...
  }
}
interface Object2Validatable {
  public void validate() throws ValidateException;
}
class Object2 implements Object2Validatable {
  ...
  public void validate() throws ValidateException {
    ...
  }
} 
```

我认为我遇到的主要问题是我有点坚持拥有顶级接口的想法，因此我至少可以说 X 或 Y 对象是可验证的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T11:04:26.707

那这个呢 ：

```
interface Validatable {
  void validate(Validator v);
}

class Object1 implements Validatable{
  void validate(Validator v){
    v.foo
    v.bar
  }
}
class Object1Converse implements Validator{
 //....
}
class Object2 implements Validatable{
  void validate(Validator v){
    //do whatever you need and ingore validator ? 
  }
} 
```

如果 Object2 收到不需要的参数，你关心什么？如果它能够在没有它的情况下正确运行，它可以忽略它对吗？

如果您担心在 object2 和 Object1Converse 之间引入不必要的依赖关系，那么只需指定一个接口来解耦它们并将其用作验证器。

现在我必须补充一点，有一个混合模型，其中既有能够自我验证的对象，也有需要外部状态信息来验证的对象，这听起来很奇怪。

介意说明吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T11:04:35.957

也许[apache commons 验证器](http://commons.apache.org/validator/)项目在这里会很有用 - 直接或作为如何解决您的问题的模型。它们实际上有一组并行的对象来进行验证——所以对象上没有接口，只是对象/类的相关验证器的存在/不存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T11:05:29.807

这是在 C# 中，但同样的想法当然可以在许多其他语言中实现。

```
public class MyClass {
    //Properties and methods here
}

public class MyClassValidator : IValidator<MyClass> {
    IList<IValidatorError> IValidator.Validate(MyClass obj) {
        //Perform some checks here
    }
}

//...

public void RegisterValidators() {
    Validators.Add<MyClassValidator>();
}

//...

public void PerformSomeLogic() {
    var myobj = new MyClass { };
    //Set some properties, call some methods, etc.
    var v = Validators.Get<MyClass>();
    if(v.GetErrors(myobj).Count() > 0)
        throw new Exception();
    SaveToDatabase(myobj);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T11:11:39.560

“可以验证对象”问题的简单解决方案是添加第三个接口。

这第三个接口是其他两个接口的空接口，这意味着您可以只检查该接口（假设您不担心有人欺骗是可验证的），然后在需要时迭代检查可能的验证接口实际验证。

例子：

```
interface Validateable
{
}

interface EmptyValidateable inherits Validateable //Or is it implements?
{
     void validate() throws ValidateException;
}

interface Objectvalidateable inherits Validateable
{
     void validate(Object validateObj);
} 
```

# algorithm - 阅读网格算法和网格库

> ID：182145
> 
> 赞同：9
> 
> 时间：2008-10-08T11:01:05.993
> 
> 标签：algorithm, mesh

我有兴趣阅读和理解 2D 网格算法。在 Google 上搜索会发现[很多论文和资料来源](http://www.google.com.my/search?rlz=1C1GGLS_enMY291&sourceid=chrome&ie=UTF-8&q=meshing+algorithm)，但大多数都过于学术，对初学者而言并不多。

那么，这里有人会推荐任何我可以从一开始就学习的阅读资源（适合初学者）或开源实现吗？谢谢。

此外，与三角形网格生成相比，我对四边形网格和混合网格（四边形和三边形组合）更感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T15:21:42.943

我第二次大卫关于[乔纳森 Shewchuk 的](http://www.cs.berkeley.edu/~jrs/)网站的回答是一个很好的起点。

就开源软件而言，这取决于您到底在寻找什么。

*   如果您对网格生成感兴趣，可以查看[CGAL](http://www.cgal.org/)的代码。了解 CGAL 代码的低级部分对于初学者来说太过分了。但是，即使对于初学者来说，查看更高级别的算法也会很有趣。另请注意，[CGAL 的文档](http://www.cgal.org/Manual/3.3/doc_html/cgal_manual/contents.html)非常详细。
*   你也可以看看[TetGen](http://tetgen.berlios.de/)，但是它的源代码是单一的并且没有文档记录（它更像是一个最终用户软件而不是一个库，即使它也可以从其他程序中简单地调用）。尽管如此，它还是相当易读的，[用户手册](http://tetgen.berlios.de/files/tetgen-manual.pdf)包含网格生成的简短介绍，并附有一些参考资料。
*   如果你也对网格处理感兴趣，可以看看[OpenMesh](http://www.openmesh.org/)。

有关您的目标的更多信息肯定会有助于提供更多相关的指针。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-08T13:42:42.627

Google 搜索的第一个链接会将您带到[Jonathan Shewchuk 的](http://www.cs.berkeley.edu/~jrs/)网站。这实际上并不是一个糟糕的起点。他有一个叫做[三角形](http://www.cs.cmu.edu/~quake/triangle.html)的程序，你可以下载它来进行二维三角测量。在该页面上，有一个指向用于[创建三角形的参考资料的](http://www.cs.cmu.edu/~quake/tripaper/triangle0.html)[链接](http://www.cs.cmu.edu/~quake/triangle.research.html)，其中包括一个指向三角[测量算法](http://www.cs.cmu.edu/~quake/tripaper/triangle3.html)描述的链接。

网格生成有多种方法。最常见的一种是创建 [Delaunay 三角剖分](http://en.wikipedia.org/wiki/Delaunay_triangulation)。对一组点进行三角剖分相当简单，并且有几种算法可以做到这一点，包括在三角形中使用[的 Watson 和 Rupert](http://www.cs.cmu.edu/~quake/tripaper/triangle3.html) 。有点困难，因为您需要恢复某些边缘。

我将从了解德劳内三角剖分开始。然后也许看看其他一些网格算法。

您将在网格生成论文中找到的一些常见主题是

*   鲁棒性 - 这就是如何处理浮点舍入错误。
*   网格质量 - 确保三角形/四面体的形状接近等边。这是否重要取决于您创建网格的原因。对于分析工作来说非常重要，
*   如何选择在网格中插入节点的位置以提供良好的网格分布。
*   啮合速度
*   四边形/六面体网格生成。这比使用三角形/四面体更难。

3D 网格生成比 2D 更难，所以很多论文都是关于 3D 生成的

网格生成是一个很大的话题。如果您能提供更多关于您感兴趣的方面（例如 2D 或 3D）的信息，那将很有帮助。如果您能对您的蚂蚁做什么有所了解，那么也许我可以找到一些更好的信息来源。

# login - Spring security：添加“成功登录事件侦听器”

> ID：182160
> 
> 赞同：41
> 
> 时间：2008-10-08T11:05:21.947
> 
> 标签：login, spring-security, listener

我是 Spring Security 的新手。如何添加将在用户成功登录时调用的事件侦听器？此外，我需要在此侦听器中获取某种唯一的会话 ID，该 ID 应该可以进一步使用。我需要此 ID 与另一台服务器同步。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-08T11:14:31.270

您需要定义一个实现[ApplicationListener](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/context/ApplicationListener.html)的 Spring Bean 。

然后，在您的代码中，执行以下操作：

```
public void onApplicationEvent(ApplicationEvent appEvent)
{
    if (appEvent instanceof AuthenticationSuccessEvent)
    {
        AuthenticationSuccessEvent event = (AuthenticationSuccessEvent) appEvent;
        UserDetails userDetails = (UserDetails) event.getAuthentication().getPrincipal();

        // ....
    }
} 
```

然后，在您的 applicationContext.xml 文件中，只需定义该 bean，它将自动开始接收事件 :)

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-08-08T13:56:45.450

AuthenticationSuccessEvent 的问题是它没有在记住我登录时发布。如果您使用记住我身份验证，请改用 InteractiveAuthenticationSuccessEvent，它适用于正常登录以及记住我登录。

```
@Component
public class LoginListener implements ApplicationListener<InteractiveAuthenticationSuccessEvent> {

    @Override
    public void onApplicationEvent(InteractiveAuthenticationSuccessEvent event)
    {
        UserDetails userDetails = (UserDetails) event.getAuthentication().getPrincipal();
        // ...
    }
} 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-12-26T16:34:56.220

类似于菲尔的答案，但修改为考虑泛型：

```
public class AuthenticationListener implements ApplicationListener<AuthenticationSuccessEvent> {

  @Override
  public void onApplicationEvent(final AuthenticationSuccessEvent event) {

      // ...

  }

} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-05-10T22:34:05.460

在 Grails 中，使用 Spring Security Plugin，您可以在 Config.groovy 中执行此操作：

```
grails.plugins.springsecurity.useSecurityEventListener = true

grails.plugins.springsecurity.onAuthenticationSuccessEvent = { e, appCtx ->

        def session = SecurityRequestHolder.request.getSession(false)
        session.myVar = true

} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-01-06T16:41:04.467

另一种使用方式`@EventListener`

```
@EventListener
public void doSomething(InteractiveAuthenticationSuccessEvent event) { // any spring event
    // your code 

} 
```

# ajax - 哪个模板引擎和 Ajax 框架/工具包可以从 JAR 文件中加载模板？

> ID：182177
> 
> 赞同：0
> 
> 时间：2008-10-08T11:09:32.733
> 
> 标签：ajax, templates, frameworks, toolkit

哪个模板引擎和 Ajax 框架/工具包能够从 JAR 文件中加载模板信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T11:45:43.407

如果您指的是服务器端模板引擎，您可以让 Velocity 从类路径（包括 JAR 文件）加载其模板。查看[开发人员指南](http://velocity.apache.org/engine/devel/developer-guide.html#configuring_resource_loaders)中的“配置资源加载器（模板加载器）”部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T09:35:52.123

看看[http://www.ztemplates.org](http://www.ztemplates.org)，它简单易学。这个允许您将所有相关的模板、javascript 和 css 放入一个 jar 中并透明地使用它。意味着您甚至不必关心在使用提供的组件时在页面中声明所需的 javascript，因为框架会为您完成。

# google-analytics - 来自谷歌分析的数据

> ID：182180
> 
> 赞同：8
> 
> 时间：2008-10-08T11:10:11.013
> 
> 标签：google-analytics

所以谷歌分析没有我们可以用来获取数据的 API，那么有没有一种有效的方法来以编程方式获取谷歌收集的数据，而无需在本地记录呢？

编辑：我更喜欢 Python 或 PHP 解决方案，但任何方法都可以。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-29T02:57:31.883

Google 刚刚宣布他们正在[为 Google Analytics 提供数据导出 API](http://analytics.blogspot.com/2008/10/more-enterprise-class-features-added-to.html)。听起来这正是您正在寻找的。

根据他们的公告，该功能目前处于私人测试阶段，但我认为它将在未来几周/几个月内推广到所有帐户。根据您的需要，您可能只想等待，而不是构建一个短期的骇人听闻的解决方案。

如果您有兴趣，我认为该功能首先会向[Google Analytics Trusted Tester](http://code.google.com/apis/analytics/docs/trustedTester.html)计划的成员推出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T11:31:54.653

另外，我忘记了这一点：我从来没有真正为客户完全实现过这个，因为交易失败了......

但是您可以自定义仪表板以包含您的报告可能需要的 Google Analytics 部分，并有一个预定的电子邮件。如果报告不需要太详细，并且如果 Google 已经按照您需要的方式汇总了数据，那么这可能适合您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T15:05:58.140

[Google Analytics API](http://code.google.com/apis/analytics/docs/gdata/gdataDeveloperGuide.html)现在对所有人开放，看起来它包含完整的数据集

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T11:14:38.853

好吧，这取决于您要对数据做什么。如果只想处理一部分，那我觉得不难。

这是一个基本的网络搜索，其中包含来自 Google 和其他人的热门解释： [http ://www.google.com/support/analytics/bin/answer.py?hl=en&answer=](http://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55561) [55561 http://blogoscoped.com/archive/ 2008-01-17-n73.html](http://blogoscoped.com/archive/2008-01-17-n73.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T11:37:05.203

有一种使用 greqo(PHP) 访问数据的完全编程方式，但分析类处于测试阶段。[在这里](http://code.google.com/p/greqo/)查看。

如果测试版不可接受，您可以混合使用 XML 和 Yahoo Pipes 来获得所需的内容。

> 基本方法
> 
> 以可用格式获取跟踪数据——我们可以安排 Google Analytics 定期将其作为 XML 文件通过电子邮件发送。
> 
> 使 XML 文件可在线访问 - 通过将附件通过电子邮件发送到 Google 网上论坛，该文件会自动获得一个公共 URL。
> 
> 计算出最新报告的 URL – 由于 Google 网上论坛为所有消息提供 RSS/Atom 提要，因此我们可以轻松找到最新消息的 URL，从而计算出 XML 报告的 URL。
> 
> 准备数据以供使用——我们需要操作 XML 并将其转换为方便的 JSON 格式，我们可以在我们的博客上使用，这一切都可以使用 Yahoo Pipes 完成。

取自[这里](http://blogoscoped.com/archive/2008-01-17-n73.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T12:10:40.003

我实施了一个解决方案，我们安排每天将分析报告通过电子邮件发送到 gmail 帐户，然后我通过 POP3 按需提取报告。这很容易，而且工作速度很快。我听说 Epic1 也会为你做这件事。我现在正在研究那个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-02T14:02:20.603

如果你使用 Python，Pandas io 也很有帮助。Pandas 在 Google Analytics API 之上有一个界面。启动和运行并与 Pandas 集成非常简单，因此您可以获得聚合、时间序列功能和其他数据分析库功能。

有关如何验证和显示示例的说明：http: [//blog.yhathq.com/posts/pandas-google-analytics.html](http://blog.yhathq.com/posts/pandas-google-analytics.html)

更多示例：http: [//quantabee.wordpress.com/2012/12/17/google-analytics-pandas/](http://quantabee.wordpress.com/2012/12/17/google-analytics-pandas/)

我还发布了一些查询以开始 [https://github.com/sk8asd123/ga_pandas](https://github.com/sk8asd123/ga_pandas)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-08T11:25:26.320

自从我不得不处理这个问题已经有一段时间了，但是 Google Analytics 有一个 XML 输出类型，所以你可以解析它来在你自己的系统中获取数据。但是，我相信没有办法以编程方式获取 xml 文件，因此仍然必须有人进入并生成文件并将其提供给您的应用程序。

不过，这是个好问题，我很想看看是否有 100% 自动化的解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-26T17:41:05.527

我们刚刚发布了一个产品[——Megalytic——](http://megalytic.com)它使得使用来自 Google Analytics API 的数据创建自定义报告变得非常容易。您可以将这些报告通过电子邮件发送给其他人，而无需共享您的 Google Analytics（分析）帐户。此外，创建报告链接、下载为 PDF 等。

# .net - sql参数转换

> ID：182181
> 
> 赞同：1
> 
> 时间：2008-10-08T11:10:25.803
> 
> 标签：.net, sql, sql-server

我试图调用下面的 SQL 语句，但得到以下错误：

> System.Data.SqlClient.SqlException：将 varchar 值“+@buildingIDs+”转换为数据类型 int 时转换失败。

```
@"SELECT id, startDateTime, endDateTime 
    FROM tb_bookings 
   WHERE buildingID IN ('+@buildingIDs+') 
     AND startDateTime <= @fromDate"; 
```

`buildingID`是`int`db 中的类型列。我需要将 ID 作为整数数组传递吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T11:37:23.237

Bravax的方式有点危险。我会采用以下方法，这样您就不会受到 SQL 注入的攻击：

```
int[] buildingIDs = new int[] { 1, 2, 3 };

/***/ @"SELECT id, startDateTime, endDateTime From tb_bookings WHERE buildingID IN (" +
      string.Join(", ", buildingIDs.Select(id => id.ToString()).ToArray())
      + ") AND startDateTime <= @fromDate"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T11:42:58.810

请注意，LINQ 可以通过 Contains（映射到 IN）来执行此操作。使用常规 TSQL，另一种选择是将列表作为 CSV（等）varchar 传递，并使用表值 UDF 将 varchar 拆分为多个片段。这允许您使用单个 TSQL 查询（对 UDF 结果执行 INNER JOIN）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T11:41:06.600

如果可能的话，我宁愿建议使用存储过程，并将 ID 列表作为 xml 传递。**[您可以从此处](http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx)**获得有关此方法的更多详细信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-08T11:20:03.630

它试图将 int 与字符串值 '+@buildingsIDs+' 进行比较，
因此它尝试将字符串转换为 int 并失败。

因此，请执行以下操作：
`buildingsIDs = "1, 5, 6";
@"SELECT id, startDateTime, endDateTime From tb_bookings WHERE buildingID IN (" + buildingIDs + ") AND startDateTime <= @fromDate";`

# apache - SSL 证书没有 WWW Apache (ModRewrite) EV

> ID：182192
> 
> 赞同：2
> 
> 时间：2008-10-08T11:12:14.177
> 
> 标签：apache, mod-rewrite, ssl

ModRewrite 可以轻松处理从我的域前面剥离 www。
在 .htaccess 中：

```
RewriteEngine On
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ https://%1/$1 [R=301,L]
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

但是使用 SSL，证书检查在 .htaccess 重写之前进行，导致证书错误。
我宁愿不为 www 购买 SSL 证书，只是为了重定向它。
你能给我一个更聪明的解决方案吗？（顺便说一句，EV 证书不能用作通配符）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T11:14:41.350

您可以获得其中包含多个域名的证书。得到一个`mydomain.com`和`www.mydomain.com`。我认为也可以购买与任何子域匹配的“通配符”证书，但它们的成本要高得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T11:35:56.890

根据您的情况，您可以查看[cacert](http://www.cacert.org)。

在获得足够多的人保证获得 50 个“积分”后，您可以创建自己的服务器证书，数量不限。

通常，通过在现实生活中与他/她会面并出示某种身份证明（驾驶执照、护照），您会得到某人的“保证”。

欲了解更多信息，请阅读该网站，或者您 pm 我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T02:10:46.223

在您的情况下，有两个选项显示承诺：
1）当需要安全连接时，链接到[https://domain.com](https://domain.com)
保留部分 .htaccess 重定向

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

将阻止 www.domain.com，并希望最小化[https://www.domain.com 2）正如其他人所建议的那样，为](https://www.domain.com)[https://www.domain.com](https://www.domain.com)
获取单独的证书[startssl.com](http://startssl.com)有免费证书，适合像这样的仅重定向工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T00:36:44.517

许多 SSL 证书提供商，包括 DigiCert、GlobalSign 和可能的 GoDaddy，将免费将 www 作为主题备用名称放入证书中。这意味着该证书将适用于 paypal.com 和 www.paypal.com。然后，您可以将所有流量从[https://www.paypal.com](https://www.paypal.com)转发到[https://paypal.com](https://paypal.com)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T00:09:37.783

你试图做的事情是不可能的。如果用户通过 SSL 访问 www.domain.cc，那么如果您没有有效的 SSL 证书，您将收到证书错误 - 即使您只想将他们重定向到正确的站点。

您将需要 www.domain.cc 的新证书，或者说服您的注册商为您提供 *.domain.cc 的通配符证书，或者具有多个 subjectAltName 属性的证书。见[http://www.crsr.net/Notes/Apache-HTTPS-virtual-host.html](http://www.crsr.net/Notes/Apache-HTTPS-virtual-host.html)

# model-view-controller - 新的 Web 应用程序应该遵循 MVC 还是 MVP 模式？

> ID：182194
> 
> 赞同：6
> 
> 时间：2008-10-08T11:12:42.990
> 
> 标签：model-view-controller, architecture, web-applications, design-patterns, mvp

**请注意，我不是问选择哪一个（MVC 或 MVP），而是问是否应该将两者之一用于 Web 应用程序。**

我意识到将旧应用程序从其当前设计转换为 MVC 或 MVP 模式可能需要做太多工作。但是，对于新应用程序呢？看起来这些是最流行的架构模式，那么应该选择其中一种吗？如果不是，还有哪些其他模式？

如果您不熟悉 MVC 和/或 MVP，一个很好的问题是[“什么是 MVP 和 MVC，有什么区别？”](https://stackoverflow.com/questions/2056/what-are-mvp-and-mvc-and-what-is-the-difference) . 它有很多很好的答案，包括指向各个网站的链接，这些网站会分解每个网站。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T11:46:07.353

MVP / MVC 在 Web 应用程序中运行良好，因为 HTTP 动词 + URL 组合是确定要采取的操作的非常好的方法。有理由不使用它，例如如果您的团队对另一个框架有很多经验，但我通常会推荐 MVP / MVC 框架。您的申请将以更高的质量更快地完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T11:20:13.647

两者都是不错的选择。

我会选择 MVC，因为它有更广泛的采用，并且更容易被前端（HTML / CSS）开发人员理解和使用。

此外，考虑到采用 MVC 模式的框架的数量，chanches 正在与您在 MVC 中的同事交谈，您将谈论一种众所周知的语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T03:07:20.083

[我已经为另一个问题发布了以下答案，尽管在这里](https://stackoverflow.com/questions/10061451/mvc-tutorials-for-mvp/10061562#10061562)可能更合适。

**MVC**适用于普通的服务器端脚本。在 MVC 中，开发人员总是尽量保持控制器非常精简。控制器主要用于选择合适的模型并反映在视图上。但是在当今的 Web 应用程序中，视图部分已经发生了根本性的变化，变得复杂到足以产生一个又大又胖又凌乱的控制器。所以现在我们需要一个新的地方来放置用户界面的复杂控制逻辑。这里**MVP的****P**进来了，即 Presenter。因此演示者负责控制特定用户界面组件的逻辑。不用担心控制器还在这里，命名为**Application Controller**。它最终负责在相对较大的应用程序组件之间进行切换。所以**MVP********也可以说是**MVPC(!!)**。顺便说一句，这是我理解 MVP 的方式，显然不是任何基本规则。******

 ****所以我已经倾向于复杂网络应用程序的**MVP**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T17:46:34.770

您的问题是“我应该使用其中一种设计模式”。

我不得不说这真的取决于你的项目范围。对于一个非常大的项目，该项目与预算庞大的大型组织中的其他系统相互依赖，我认为它们绝对值得考虑。

我认为这些模式经常在较小的项目中被过度使用，它们可能会增加不必要的复杂性和成本。

松耦合的主要目的是让您可以在以后更改数据库或 UI，或重用业务逻辑。很多时候，这永远不会发生。您必须意识到，这两种模式中的任何一种都将花费更长的时间来实现并使代码变得相当复杂。因此，我强烈建议认真考虑一下并权衡您的选择。通过使用可以完成工作并降低复杂性的非常简单的架构，您通常可以更快地交付更好的解决方案！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T11:21:13.597

这取决于您使用的框架。只需使用它支持的东西。我见过的大多数 Web 框架都使用前端控制器模式并将其称为 MVC 或 MVP。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-25T13:56:22.913

我认为你应该这样做。它们更难实现，尤其是在 MS 世界中，因为它们竭尽全力推动 Web 表单并使构建 Web 应用程序更容易。
使用它们，您可以直接进行编程，并且感觉自己已经完成了很多工作。但是在您的网站变大后，它们会变得更慢且更难维护。
使用 MVC 和 MVP 允许您分离模型（代表您正在使用的域的基本类）、控制器和视图。最好的一点是您可以在其他应用程序（如移动应用程序或 Windows 应用程序）中重用您的模型。然后它们有更多的共同点，而不仅仅是一个数据库，因此您必须编写更少的代码。你只需要编写控制器和视图。
我对此并不陌生，但我看到了好处，因为当我不得不在一个地方更改某些东西时，其他地方的其他东西就会崩溃（因此您还必须考虑松散耦合并编写单元测试）。在 Web 表单中编写测试是不可能的。

但是，如果您正在构建代表个人或公司的应用程序，而 Web 上没有业务逻辑，并且您必须快速完成，那么 Web 表单就适合它。并且还用于构建原型，以便您可以展示完成后应用程序能够执行的操作。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-27T13:52:40.933

我喜欢这两种模式。我的最佳做法是选择一种模式，这总是比没有模式更好。

我已经在这两种模式上开发了很多应用程序，我个人的感觉是，当你是一名 RAD 开发人员并且你对 CSS 和 javascript 不太擅长时（大多数是想要创建 webapp 的 winforms 开发人员，没有冒犯 ;-) ）你应该使用 MVP 模式，因为这很容易与 Web 应用程序项目一起使用。

但是，当您知道分配 CSS 和 javascript 时，您应该考虑 ASP.NET MVC 模式。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-25T14:04:10.760

我更喜欢 MVC 模式，只是因为松耦合。模型、视图和控制器之间有明显的分离，通过这种分离，它更适合测试驱动开发或单元测试。

# python - 如何查看文件的更改？

> ID：182197
> 
> 赞同：371
> 
> 时间：2008-10-08T11:12:55.410
> 
> 标签：python, file, pywin32, watch

我有一个由另一个进程写入的日志文件，我想观察它的变化。每次发生更改时，我都想读取新数据以对其进行一些处理。

最好的方法是什么？我希望 PyWin32 库中有某种钩子。我找到了该`win32file.FindNextChangeNotification`功能，但不知道如何要求它观看特定文件。

如果有人做过这样的事情，我将非常感激听到如何...

**[编辑]**我应该提到我正在寻求不需要轮询的解决方案。

**[编辑]**诅咒！似乎这不适用于映射的网络驱动器。我猜windows不会像在本地磁盘上那样“听到”文件的任何更新。

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2011-01-14T11:52:26.400

你试过[看门狗](http://packages.python.org/watchdog/)吗？

> 用于监视文件系统事件的 Python API 库和 shell 实用程序。
> 
> ### 目录监控变得容易
> 
> *   一个跨平台的 API。
> *   用于响应目录更改运行命令的 shell 工具。
> 
> 通过快速入门中的一个简单示例[快速入门](https://pythonhosted.org/watchdog/quickstart.html#quickstart)...

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2008-10-08T11:34:14.850

如果轮询对您来说足够好，我会观察“修改时间”文件统计信息是否发生变化。要阅读它：

```
os.stat(filename).st_mtime 
```

（另请注意，Windows 本机更改事件解决方案并非在所有情况下都有效，例如在网络驱动器上。）

```
import os

class Monkey(object):
    def __init__(self):
        self._cached_stamp = 0
        self.filename = '/path/to/file'

    def ook(self):
        stamp = os.stat(self.filename).st_mtime
        if stamp != self._cached_stamp:
            self._cached_stamp = stamp
            # File has changed, so do something... 
```

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2008-10-08T11:29:43.330

您是否已经查看过[http://timgolden.me.uk/python/win32_how_do_i/watch_directory_for_changes.html](http://timgolden.me.uk/python/win32_how_do_i/watch_directory_for_changes.html)上提供的文档？如果您只需要它在 Windows 下工作，那么第二个示例似乎正是您想要的（如果您将目录的路径与您想要观看的文件之一交换）。

否则，轮询可能是唯一真正独立于平台的选项。

**注意：**我没有尝试过任何这些解决方案。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2011-03-17T13:45:31.360

如果您想要一个多平台解决方案，请检查[QFileSystemWatcher](http://doc.qt.io/qt-4.8/qfilesystemwatcher.html)。这是一个示例代码（未清理）：

```
from PyQt4 import QtCore

@QtCore.pyqtSlot(str)
def directory_changed(path):
    print('Directory Changed!!!')

@QtCore.pyqtSlot(str)
def file_changed(path):
    print('File Changed!!!')

fs_watcher = QtCore.QFileSystemWatcher(['/path/to/files_1', '/path/to/files_2', '/path/to/files_3'])

fs_watcher.connect(fs_watcher, QtCore.SIGNAL('directoryChanged(QString)'), directory_changed)
fs_watcher.connect(fs_watcher, QtCore.SIGNAL('fileChanged(QString)'), file_changed) 
```

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2009-01-23T16:08:40.207

它不应该在 Windows 上工作（也许用 cygwin ？），但对于 unix 用户，你应该使用“fcntl”系统调用。这是 Python 中的一个示例。如果您需要用 C 编写它，它几乎是相同的代码（相同的函数名称）

```
import time
import fcntl
import os
import signal

FNAME = "/HOME/TOTO/FILETOWATCH"

def handler(signum, frame):
    print "File %s modified" % (FNAME,)

signal.signal(signal.SIGIO, handler)
fd = os.open(FNAME,  os.O_RDONLY)
fcntl.fcntl(fd, fcntl.F_SETSIG, 0)
fcntl.fcntl(fd, fcntl.F_NOTIFY,
            fcntl.DN_MODIFY | fcntl.DN_CREATE | fcntl.DN_MULTISHOT)

while True:
    time.sleep(10000) 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2010-06-13T05:12:49.907

查看[pyinotify](https://github.com/seb-m/pyinotify)。

inotify 在较新的 linux 中替换 dnotify （来自较早的答案），并允许文件级而不是目录级监视。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-10-08T14:05:53.203

好吧，在对 Tim Golden 的脚本进行了一些修改之后，我得到了以下似乎运行良好的内容：

```
import os

import win32file
import win32con

path_to_watch = "." # look at the current directory
file_to_watch = "test.txt" # look for changes to a file called test.txt

def ProcessNewData( newData ):
    print "Text added: %s"%newData

# Set up the bits we'll need for output
ACTIONS = {
  1 : "Created",
  2 : "Deleted",
  3 : "Updated",
  4 : "Renamed from something",
  5 : "Renamed to something"
}
FILE_LIST_DIRECTORY = 0x0001
hDir = win32file.CreateFile (
  path_to_watch,
  FILE_LIST_DIRECTORY,
  win32con.FILE_SHARE_READ | win32con.FILE_SHARE_WRITE,
  None,
  win32con.OPEN_EXISTING,
  win32con.FILE_FLAG_BACKUP_SEMANTICS,
  None
)

# Open the file we're interested in
a = open(file_to_watch, "r")

# Throw away any exising log data
a.read()

# Wait for new data and call ProcessNewData for each new chunk that's written
while 1:
  # Wait for a change to occur
  results = win32file.ReadDirectoryChangesW (
    hDir,
    1024,
    False,
    win32con.FILE_NOTIFY_CHANGE_LAST_WRITE,
    None,
    None
  )

  # For each change, check to see if it's updating the file we're interested in
  for action, file in results:
    full_filename = os.path.join (path_to_watch, file)
    #print file, ACTIONS.get (action, "Unknown")
    if file == file_to_watch:
        newText = a.read()
        if newText != "":
            ProcessNewData( newText ) 
```

它可能与负载更多的错误检查有关，但对于简单地查看日志文件并在将其吐出到屏幕之前对其进行一些处理，这很有效。

感谢大家的投入 - 很棒的东西！

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2018-02-27T11:30:25.837

为了查看带有轮询和最小依赖项的单个文件，这里有一个完整的示例，基于[Deestan](https://stackoverflow.com/a/182259/5859283)的回答（上图）：

```
import os
import sys 
import time

class Watcher(object):
    running = True
    refresh_delay_secs = 1

    # Constructor
    def __init__(self, watch_file, call_func_on_change=None, *args, **kwargs):
        self._cached_stamp = 0
        self.filename = watch_file
        self.call_func_on_change = call_func_on_change
        self.args = args
        self.kwargs = kwargs

    # Look for changes
    def look(self):
        stamp = os.stat(self.filename).st_mtime
        if stamp != self._cached_stamp:
            self._cached_stamp = stamp
            # File has changed, so do something...
            print('File changed')
            if self.call_func_on_change is not None:
                self.call_func_on_change(*self.args, **self.kwargs)

    # Keep watching in a loop        
    def watch(self):
        while self.running: 
            try: 
                # Look for changes
                time.sleep(self.refresh_delay_secs) 
                self.look() 
            except KeyboardInterrupt: 
                print('\nDone') 
                break 
            except FileNotFoundError:
                # Action on file not found
                pass
            except: 
                print('Unhandled error: %s' % sys.exc_info()[0])

# Call this function each time a change happens
def custom_action(text):
    print(text)

watch_file = 'my_file.txt'

# watcher = Watcher(watch_file)  # simple
watcher = Watcher(watch_file, custom_action, text='yes, changed')  # also call custom action function
watcher.watch()  # start the watch going 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-10-08T11:28:12.243

检查[我](https://stackoverflow.com/questions/62832/reading-data-from-a-log-file-as-a-separate-application-is-writing-to-it#63446)对[类似问题](https://stackoverflow.com/questions/62832/)的回答。您可以在 Python 中尝试相同的循环。[该页面](http://code.activestate.com/recipes/157035/)建议：

```
import time

while 1:
    where = file.tell()
    line = file.readline()
    if not line:
        time.sleep(1)
        file.seek(where)
    else:
        print line, # already has newline 
```

另请参阅问题[tail() a file with Python](https://stackoverflow.com/questions/136168/tail-a-file-with-python)。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-12-08T16:09:42.800

这是 Kender 代码的简化版本，它似乎具有相同的技巧，并且不导入整个文件：

```
# Check file for new data.

import time

f = open(r'c:\temp\test.txt', 'r')

while True:

    line = f.readline()
    if not line:
        time.sleep(1)
        print 'Nothing New'
    else:
        print 'Call Function: ', line 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2013-02-25T16:05:07.080

这是 Tim Goldan 脚本的另一个修改，它在 unix 类型上运行，并通过使用 dict (file=>time) 添加了一个简单的文件修改观察程序。

用法：whateverName.py path_to_dir_to_watch

```
#!/usr/bin/env python

import os, sys, time

def files_to_timestamp(path):
    files = [os.path.join(path, f) for f in os.listdir(path)]
    return dict ([(f, os.path.getmtime(f)) for f in files])

if __name__ == "__main__":

    path_to_watch = sys.argv[1]
    print('Watching {}..'.format(path_to_watch))

    before = files_to_timestamp(path_to_watch)

    while 1:
        time.sleep (2)
        after = files_to_timestamp(path_to_watch)

        added = [f for f in after.keys() if not f in before.keys()]
        removed = [f for f in before.keys() if not f in after.keys()]
        modified = []

        for f in before.keys():
            if not f in removed:
                if os.path.getmtime(f) != before.get(f):
                    modified.append(f)

        if added: print('Added: {}'.format(', '.join(added)))
        if removed: print('Removed: {}'.format(', '.join(removed)))
        if modified: print('Modified: {}'.format(', '.join(modified)))

        before = after 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-10-08T12:18:25.980

好吧，由于您使用的是 Python，您可以打开一个文件并继续读取其中的行。

```
f = open('file.log') 
```

如果读取的行**不为空**，则处理它。

```
line = f.readline()
if line:
    // Do what you want with the line 
```

您可能错过了继续致电`readline`EOF 是可以的。在这种情况下，它只会继续返回一个空字符串。并且当某些内容附加到日志文件时，读取将根据您的需要从停止的位置继续。

如果您正在寻找使用事件或特定库的解决方案，请在您的问题中指定。否则，我认为这个解决方案很好。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2014-06-25T13:43:37.950

对我来说最简单的解决方案是使用看门狗的工具 watchmedo

从[https://pypi.python.org/pypi/watchdog](https://pypi.python.org/pypi/watchdog)我现在有一个进程可以在目录中查找 sql 文件并在必要时执行它们。

```
watchmedo shell-command \
--patterns="*.sql" \
--recursive \
--command='~/Desktop/load_files_into_mysql_database.sh' \
. 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-08T11:42:12.247

正如您在[Tim Golden 的文章中所看到的，由](http://timgolden.me.uk/python/win32_how_do_i/watch_directory_for_changes.html)[Horst Gutmann](https://stackoverflow.com/users/22312/horst-gutmann)指出，WIN32 相对复杂并且监视目录，而不是单个文件。

我建议您研究[IronPython](http://www.codeplex.com/IronPython)，这是一个*.NET* python 实现。使用 IronPython，您可以使用所有*.NET*功能 - 包括

```
System.IO.FileSystemWatcher 
```

*它使用简单的事件*接口处理单个文件。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-09-22T18:40:48.793

```
ACTIONS = {
  1 : "Created",
  2 : "Deleted",
  3 : "Updated",
  4 : "Renamed from something",
  5 : "Renamed to something"
}
FILE_LIST_DIRECTORY = 0x0001

class myThread (threading.Thread):
    def __init__(self, threadID, fileName, directory, origin):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.fileName = fileName
        self.daemon = True
        self.dir = directory
        self.originalFile = origin
    def run(self):
        startMonitor(self.fileName, self.dir, self.originalFile)

def startMonitor(fileMonitoring,dirPath,originalFile):
    hDir = win32file.CreateFile (
        dirPath,
        FILE_LIST_DIRECTORY,
        win32con.FILE_SHARE_READ | win32con.FILE_SHARE_WRITE,
        None,
        win32con.OPEN_EXISTING,
        win32con.FILE_FLAG_BACKUP_SEMANTICS,
        None
    )
    # Wait for new data and call ProcessNewData for each new chunk that's
    # written
    while 1:
        # Wait for a change to occur
        results = win32file.ReadDirectoryChangesW (
            hDir,
            1024,
            False,
            win32con.FILE_NOTIFY_CHANGE_LAST_WRITE,
            None,
            None
        )
        # For each change, check to see if it's updating the file we're
        # interested in
        for action, file_M in results:
            full_filename = os.path.join (dirPath, file_M)
            #print file, ACTIONS.get (action, "Unknown")
            if len(full_filename) == len(fileMonitoring) and action == 3:
                #copy to main file
                ... 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-04-20T11:11:19.840

这是检查文件更改的示例。一种可能不是最好的方法，但它肯定是一种捷径。

对源进行更改时重新启动应用程序的便捷工具。我在玩 pygame 时做了这个，所以我可以在文件保存后立即看到效果。

在 pygame 中使用时，请确保将“while”循环中的内容放置在您的游戏循环中，即更新或其他任何内容中。否则，您的应用程序将陷入无限循环，您将看不到游戏更新。

```
file_size_stored = os.stat('neuron.py').st_size

  while True:
    try:
      file_size_current = os.stat('neuron.py').st_size
      if file_size_stored != file_size_current:
        restart_program()
    except: 
      pass 
```

如果您想要我在网上找到的重启代码。这里是。（与问题无关，尽管它可能会派上用场）

```
def restart_program(): #restart application
    python = sys.executable
    os.execl(python, python, * sys.argv) 
```

让电子做你想让他们做的事，玩得开心。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-03-11T13:48:17.937

似乎没有人发布[fswatch](https://github.com/emcrisostomo/fswatch)。它是一个跨平台的文件系统观察者。只需安装它，运行它并按照提示进行操作。

我已经将它与 python 和 golang 程序一起使用，并且它可以正常工作。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-09-29T16:45:01.360

由于我已在全球范围内安装它，因此我最喜欢的方法是使用 nodemon。如果您的源代码在 中`src`，并且您的入口点是`src/app.py`，那么它很简单：

```
nodemon -w 'src/**' -e py,html --exec python src/app.py 
```

... 在哪里`-e py,html`可以控制要监视更改的文件类型。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-09-21T01:53:44.947

这是一个示例，旨在查看每秒写入不超过一行但通常要少得多的输入文件。目标是将最后一行（最近的写入）附加到指定的输出文件。我从我的一个项目中复制了这个，只是删除了所有不相关的行。您必须填写或更改缺少的符号。

```
from PyQt5.QtCore import QFileSystemWatcher, QSettings, QThread
from ui_main_window import Ui_MainWindow   # Qt Creator gen'd 

class MainWindow(QMainWindow, Ui_MainWindow):
    def __init__(self, parent=None):
        QMainWindow.__init__(self, parent)
        Ui_MainWindow.__init__(self)
        self._fileWatcher = QFileSystemWatcher()
        self._fileWatcher.fileChanged.connect(self.fileChanged)

    def fileChanged(self, filepath):
        QThread.msleep(300)    # Reqd on some machines, give chance for write to complete
        # ^^ About to test this, may need more sophisticated solution
        with open(filepath) as file:
            lastLine = list(file)[-1]
        destPath = self._filemap[filepath]['dest file']
        with open(destPath, 'a') as out_file:               # a= append
            out_file.writelines([lastLine]) 
```

当然，包含 QMainWindow 类并不是严格要求的，即。您可以单独使用 QFileSystemWatcher。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-01-31T01:06:58.380

最好和最简单的解决方案是使用 pygtail： [https ://pypi.python.org/pypi/pygtail](https://pypi.python.org/pypi/pygtail)

```
from pygtail import Pygtail
import sys

while True:
    for line in Pygtail("some.log"):
        sys.stdout.write(line) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-11-19T13:41:32.373

您还可以使用一个名为[repyt](https://github.com/di/repyt)的简单库，这是一个示例：

```
repyt ./app.py 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-06-27T09:40:21.527

相关@4Oh4 解决方案平滑更改要观看的文件列表；

```
import os
import sys
import time

class Watcher(object):
    running = True
    refresh_delay_secs = 1

    # Constructor
    def __init__(self, watch_files, call_func_on_change=None, *args, **kwargs):
        self._cached_stamp = 0
        self._cached_stamp_files = {}
        self.filenames = watch_files
        self.call_func_on_change = call_func_on_change
        self.args = args
        self.kwargs = kwargs

    # Look for changes
    def look(self):
        for file in self.filenames:
            stamp = os.stat(file).st_mtime
            if not file in self._cached_stamp_files:
                self._cached_stamp_files[file] = 0
            if stamp != self._cached_stamp_files[file]:
                self._cached_stamp_files[file] = stamp
                # File has changed, so do something...
                file_to_read = open(file, 'r')
                value = file_to_read.read()
                print("value from file", value)
                file_to_read.seek(0)
                if self.call_func_on_change is not None:
                    self.call_func_on_change(*self.args, **self.kwargs)

    # Keep watching in a loop
    def watch(self):
        while self.running:
            try:
                # Look for changes
                time.sleep(self.refresh_delay_secs)
                self.look()
            except KeyboardInterrupt:
                print('\nDone')
                break
            except FileNotFoundError:
                # Action on file not found
                pass
            except Exception as e:
                print(e)
                print('Unhandled error: %s' % sys.exc_info()[0])

# Call this function each time a change happens
def custom_action(text):
    print(text)
    # pass

watch_files = ['/Users/mexekanez/my_file.txt', '/Users/mexekanez/my_file1.txt']

# watcher = Watcher(watch_file)  # simple

if __name__ == "__main__":
    watcher = Watcher(watch_files, custom_action, text='yes, changed')  # also call custom action function
    watcher.watch()  # start the watch going 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-05-29T20:49:46.350

```
import inotify.adapters
from datetime import datetime

LOG_FILE='/var/log/mysql/server_audit.log'

def main():
    start_time = datetime.now()
    while True:
        i = inotify.adapters.Inotify()
        i.add_watch(LOG_FILE)
        for event in i.event_gen(yield_nones=False):
            break
        del i

        with open(LOG_FILE, 'r') as f:
            for line in f:
                entry = line.split(',')
                entry_time = datetime.strptime(entry[0],
                                               '%Y%m%d %H:%M:%S')
                if entry_time > start_time:
                    start_time = entry_time
                    print(entry)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-02-09T16:22:31.497

最简单的解决方案是在一段时间后获取同一文件的两个实例并比较它们。你可以试试这样的

```
 while True:
        # Capturing the two instances models.py after certain interval of time
        print("Looking for changes in " + app_name.capitalize() + " models.py\nPress 'CTRL + C' to stop the program")
        with open(app_name.capitalize() + '/filename', 'r+') as app_models_file:
            filename_content = app_models_file.read()
        time.sleep(5)
        with open(app_name.capitalize() + '/filename', 'r+') as app_models_file_1:
            filename_content_1 = app_models_file_1.read()
        # Comparing models.py after certain interval of time
        if filename_content == filename_content_1:
            pass
        else:
            print("You made a change in " + app_name.capitalize() + " filename.\n")
            cmd = str(input("Do something with the file?(y/n):"))
            if cmd == 'y':
                # Do Something
            elif cmd == 'n':
                # pass or do something
            else:
                print("Invalid input") 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-10T10:28:18.823

我的理解是您想不断检查是否在特定文件上写入了某种数据，这是一个解决方案：

```
import os
filename="myfile.txt" # Add full path if file is located in another directory
initial_filesize=os.path.getsize(filename) # Getting size of the file for comparition 
while 1:
    final_filesize=os.path.getsize(filename)
    if final_filsize<intial_filesize or final_filesize>initial_filesize:
        print("change in file")
        break
        # You execute your code here
    else:
        pass 
```

上面的代码工作如下：

1.  首先我们使用了`OS module`为了与系统或操作系统进行交互。
2.  在进入循环之前，我们已经检索了文件的原始文件大小并将其命名为`initial_filesize`.
3.  现在我们使用`While loop`，在其中我们不断检索文件的文件大小，如果进行了更改，它将进入`if statement`.

So basically, we have just used the file size to check if changes are made in the file, pretty simple and this method can work for almost every file type.

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2020-08-17T15:23:44.563

如果您使用的是 Windows，请创建此 POLL.CMD 文件

```
@echo off
:top
xcopy /m /y %1 %2 | find /v "File(s) copied"
timeout /T 1 > nul
goto :top 
```

然后您可以键入“poll dir1 dir2”，它会将所有文件从 dir1 复制到 dir2 并每秒检查一次更新。

“查找”是可选的，只是为了减少控制台的噪音。

这不是递归的。也许您可以在 xcopy 上使用 /e 使其递归。

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2008-10-08T11:25:57.270

我不知道任何 Windows 特定功能。您可以尝试每秒/分钟/小时获取文件的 MD5 哈希（取决于您需要多快）并将其与最后一个哈希进行比较。当它不同时，您知道文件已更改并且您读出了最新的行。

* * *

## 回答 #28

> 赞同：-6
> 
> 时间：2008-10-08T11:26:44.960

我会尝试这样的事情。

```
 try:
            f = open(filePath)
    except IOError:
            print "No such file: %s" % filePath
            raw_input("Press Enter to close window")
    try:
            lines = f.readlines()
            while True:
                    line = f.readline()
                    try:
                            if not line:
                                    time.sleep(1)
                            else:
                                    functionThatAnalisesTheLine(line)
                    except Exception, e:
                            # handle the exception somehow (for example, log the trace) and raise the same exception again
                            raw_input("Press Enter to close window")
                            raise e
    finally:
            f.close() 
```

循环检查自上次读取文件以来是否有新行 - 如果有，则将其读取并传递给`functionThatAnalisesTheLine`函数。如果没有，脚本将等待 1 秒并重试该过程。

# python - 我需要导入什么才能访问我的模型？

> ID：182229
> 
> 赞同：9
> 
> 时间：2008-10-08T11:23:54.933
> 
> 标签：python, django

我想运行一个脚本来填充我的数据库。我想通过 Django 数据库 API 访问它。

唯一的问题是我不知道我需要导入什么才能访问它。

如何做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-08T11:55:46.883

也导入您的设置模块

```
import os
os.environ["DJANGO_SETTINGS_MODULE"] = "mysite.settings"

from mysite.polls.models import Poll, Choice 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-08T21:00:46.767

这就是我的数据加载脚本顶部的内容。

```
import string
import sys
try:
    import settings # Assumed to be in the same directory.
    #settings.DISABLE_TRANSACTION_MANAGEMENT = True
except ImportError:
    sys.stderr.write("Error: Can't find the file 'settings.py' in the directory containing %r. It appears you've customized things.\nYou'll have to run django-admin.py, passing it your settings module.\n(If the file settings.py does indeed exist, it's causing an ImportError somehow.)\n" % __file__)
sys.exit(1)

#Setup the django environment with the settings module.
import django
import django.core.management
django.core.management.setup_environ(settings)

from django.db import transaction 
```

这应该在您在脚本中执行许多其他操作之前全部执行。

另一种方法是使用fixtures 和manage.py。虽然如果您只是尝试完成批量数据加载以初始化数据库，这应该可以正常工作。

此外，根据您在做什么，您可能希望或可能不想在一次交易中完成所有操作。取消注释上面的事务行并像这样构建您的代码。

```
transaction.enter_transaction_management()
try:
    #Do some stuff
    transaction.commit()
finally:
    transaction.rollback()
    pass
transaction.leave_transaction_management() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T13:38:07.160

如果您在项目目录中使用脚本的`shell`参数，则`manage.py`不必手动导入设置：

```
$ cd mysite/
$ ./manage.py shell
Python 2.5.2 (r252:60911, Jun 10 2008, 10:35:34) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> from myapp.models import *
>>> 
```

对于非交互式使用，您可以实现[自定义命令](http://docs.djangoproject.com/en/dev/howto/custom-management-commands/)并使用`manage.py`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-24T00:21:03.750

最干净的解决方案是添加 django 扩展。

```
(virt1)tsmets@calvin:~/Documents/prive/rugby-club/proposal/kitu$ yolk -l
Django - 1.3.1 - 活跃
Pygments - 1.4 - 活跃
Python - 2.6.5 - 积极开发 (/usr/lib/python2.6/lib-dynload)
django-extensions - 0.7.1 - 活跃
pip - 1.0.2 - 活跃
setuptools - 0.6c11 - 活动
wsgiref - 0.1.2 - 积极开发 (/usr/lib/python2.6)
蛋黄 - 0.4.1 - 活跃

```

然后使用 runscript 命令扩展可能的命令列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T11:37:18.433

除了您自己的模型文件之外，您还需要导入您的设置模块。

# c# - 如何在 C# 中复制 Perl 的解包功能？

> ID：182243
> 
> 赞同：4
> 
> 时间：2008-10-08T11:28:20.057
> 
> 标签：c#, perl, unpack

我正在尝试在 C# 中重新创建 Perl 脚本，但在创建目标系统所需的校验和值时遇到问题。

在 Perl 中，此校验和是使用以下`unpack`函数计算的：

```
while (<PACKAGE>) {
    $checksum += unpack("%32C*", $_);
}
$checksum %= 32767;
close(PACKAGE); 
```

`PACKAGE`.tar 文件输入流在哪里

我需要在 C# 中复制它，但找不到复制该`unpack`函数的方法。

所有帮助表示赞赏！

（我知道有更好的校验和计算可用，但不能改变目标系统所以不能改变计算）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T11:32:22.093

Mono 中似乎有一个名为[DataConvert](http://www.mono-project.com/Mono_DataConvert)的库，它被编写为提供类似于 Perl 的打包/解包的工具。这能满足您的需要吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T11:33:15.023

Perkl 的解包在[此处](http://www.perl.com/doc/manual/html/pod/perlfunc/unpack.html)和[此处](http://www.catonmat.net/blog/wp-content/plugins/wp-downloadMonitor/user_uploads/perl.pack.unpack.printf.cheat.sheet.pdf)进行了描述。从那你应该能够在 C# 中编写一个等价的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-08T11:36:04.363

为了补充 Mitch Wheat 的评论，这里有一个 Java 实现（它只做一个块）。我相信您会找到一种将其转换为 C# 并执行多个块的方法。

```
int sum = 0;
for (byte b : buffer) {
    sum += (int) b & 255;
}
return sum % 32767; 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T21:49:02.410

在我在这里的测试中，使用 %32C 解包似乎是字节的加法总和，限制为 32 位。

```
print unpack("%32C*", 'A');
65
print unpack("%32C*", 'AA');
130 
```

重现它应该不难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-10T12:56:49.157

Based on the comments of Chris Jester-Young and piCookie, I developed the following function. I hope you find it useful.

```
int fileCheckSum(const char *fileName)
{
   FILE *fp;
   long fileSize;
   char *fileBuffer;
   size_t result;
   int sum = 0;
   long index;

   fp = fopen(fileName, "rb");
   if (fp == NULL)
   {
      fputs ("File error",stderr); 
      exit (1);
   }

   fseek(fp, 0L, SEEK_END);
   fileSize = ftell(fp);
   fseek(fp, 0L, SEEK_SET);

   fileBuffer = (char*) malloc (sizeof(char) * fileSize);   
   if (fileBuffer == NULL)
   {
      fputs ("Memory error",stderr);
      exit (2);
   }

   result = fread(fileBuffer, 1, fileSize, fp);   
   if (result != fileSize)
   {
      fputs ("Reading error", stderr);
      if (fileBuffer != NULL)
         free(fileBuffer);

      exit (3);
   }

   for (index = 0; index < fileSize; index++)
   {
      sum += fileBuffer[index] & 255;
   }

   fclose(fp);
   if (fileBuffer != NULL)
      free(fileBuffer);

   return sum % 32767;  
} 
```

# python - Os.path ：你能解释一下这种行为吗？

> ID：182253
> 
> 赞同：7
> 
> 时间：2008-10-08T11:32:16.227
> 
> 标签：python, path

我喜欢 Python，因为它包含电池，而且我经常使用内置函数来为我完成这项肮脏的工作。

我一直很高兴地使用 os.path 模块来处理文件路径，但最近我在 Ubuntu linux 下的 Python 2.5 上得到了意想不到的结果，同时处理了代表 Windows 文件路径的字符串：

```
filepath = r"c:\ttemp\FILEPA~1.EXE"
print os.path.basename(filepath)
'c:\\ttemp\\FILEPA~1.EXE']
print os.path.splitdrive(filepath)
('', 'c:\ttemp\\FILEPA~1.EXE') 
```

怎么回事？

它以与 filepath = u"c:\ttemp\FILEPA~1.EXE" 和 filepath = "c:\ttemp\FILEPA~1.EXE" 相同的方式结束。

你有线索吗？Ubuntu 使用 UTF8，但我觉得这与它无关。也许我的 Python 安装搞砸了，但我没有对它进行任何我记得的特殊调整。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-08T12:11:55.803

如果你想在 linux 上操作 Windows 路径，你应该使用 ntpath 模块（这是在 windows 上作为 os.path 导入的模块 - posixpath 在 linux 上作为 os.path 导入）

```
>>> import ntpath
>>> filepath = r"c:\ttemp\FILEPA~1.EXE"
>>> print ntpath.basename(filepath)
FILEPA~1.EXE
>>> print ntpath.splitdrive(filepath)
('c:', '\\ttemp\\FILEPA~1.EXE') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T11:38:57.697

从`os.path`文档：

**os.path.splitdrive(path)**
将路径名路径拆分为一对 (drive, tail)，其中 drive 是驱动器规范或空字符串。在不使用驱动器规范的系统上，驱动器将始终为空字符串。在所有情况下，驱动器 + 尾部都将与路径相同。

如果你在 unix 上运行它，它不使用驱动器规范，因此 - 驱动器将是空字符串。

如果你想在任何平台上解决 windows 路径，你可以使用一个简单的正则表达式：

```
import re
(drive, tail) = re.compile('([a-zA-Z]\:){0,1}(.*)').match(filepath).groups() 
```

`drive`将是一个驱动器号，后跟`:`（例如`c:`，`u:`）或`None`，以及`tail`整个其余部分:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T11:39:03.780

[请参阅此处](http://pydoc.org/2.5.1/posixpath.html)的文档，特别是：

> splitdrive(p) 将路径名拆分为驱动器和路径。**在 Posix 上，驱动器总是空的。**

所以这在Linux机器上不起作用。

# security - 在我的网站上使用 OpenID 作为身份验证方法是否存在与我相关的安全风险？

> ID：182258
> 
> 赞同：22
> 
> 时间：2008-10-08T11:33:19.050
> 
> 标签：security, openid

[OpenID](http://en.wikipedia.org/wiki/OpenID)是一种在网站上验证用户的安全方法吗？

如果没有，与 OpenID 相关的安全风险是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T17:01:36.453

我同意大卫上面提出的许多观点，所以我在这里提出一些观点只是为了争论。

对于知识渊博的用户，我认为 OpenID 是一种比许多网站提供的*更*安全的身份验证形式。现在让我支持那句话。*首先，知识渊博的用户*是什么意思？我会将那个人定义为意识到 OpenID 的弱点并采取措施缓解这些弱点的人：

*   如果他们不希望网站能够有效地跟踪他们，则维护多个角色。
*   在存在 24/7 访问问题的网站上注册两个或多个 OpenID 提供程序。
*   始终直接登录到他们的 OpenID 提供商。他们从不登录到第三方网站将他们重定向到的页面。

许多网站[不知道如何安全地维护用户的密码](http://www.codinghorror.com/blog/archives/000953.html)。OpenID 的真正好处是*我*可以选择我的 OpenID 提供程序，从而选择登录依赖方所需的身份验证级别。例如，我可以选择将身份验证委托给[Verisign](https://pip.verisignlabs.com/)或[Trustbearer](http://openid.trustbearer.com/) - 两者都提供比 Web 上的大多数网站更强大的身份验证技术。我宁愿相信一个专门为我的密码提供安全性的组织，而不是网络上的一些随机网站。所以我会争辩说，对于知识渊博的用户来说，OpenID*可能*比每个实施自己的身份验证系统的网站更安全。

尽管如此，大多数用户并没有意识到 OpenID 固有的风险因素，也不会采取措施来降低风险。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-08T13:24:34.783

实际上，由于各种原因，我一直不喜欢 OpenID。

*   我必须信任我提供数据的 OpenID 提供商。我确实在一定程度上信任某些方面，但仅仅因为我可能信任 Stack Overflow，我不会自动信任任何知名的 OpenID 提供商。

    2.  如果我的 OpenID 密码被泄露，那么我使用 OpenID 的所有站点都会被泄露。通常我会为我使用的每个站点选择不同的密码，但我不能使用 OpenID。

    3.  我根本不喜欢 Persona 的概念。即使在发送任何数据之前我被问到，一个提供商拥有此信息而其他服务可以请求它似乎并不正确。好的，如果我不喜欢，我不必使用它，但这个概念对我来说似乎有缺陷。

    4.  正如已经提到的，数据在站点和 OpenID 提供者之间发送并再次返回。无论何时交换数据，都可能受到损害。没有系统是 100% 安全的；甚至没有 SSL (HTTPS)。如果数据只从我传到一侧再传回我自己，或者它也从那一侧传到另一侧再传回来，那就不同了。

    5.  如果一个 OpenID 提供者被黑了并且黑客获取了所有用户的登录数据（毕竟他们可爱地集中在一个地方！），想想影响！

仅举几个。我也看不到 OpenID 的巨大优势。对于他们说的用户

1.  更快更容易的注册和登录
    *   减少忘记用户名/密码带来的挫败感
    *   在首选站点保持最新的个人数据
    *   将密码安全风险降至最低

好，我们来分析一下。

(1) 您每天注册一个页面的频率是多少？200次？如果我每周注册 2 页，那已经是很多了。通常最多一个月 2-3 次（实际上 Stack Overflow，或者我使用 Stack Overflow 的 OpenID 提供程序，是我注册的最后一页，这不是昨天）。因此，当您每月注册 2 个站点时，您没有 5 分钟的时间来填写表格吗？来吧，别开玩笑了。

(2) 怎么做？因为它在任何地方都使用相同的密码？“这没有未来，这是一个漏洞”，大多数安全专家会说。还是因为它允许我通过邮件恢复我的密码？好吧，实际上我使用的几乎任何一面都允许我这样做。尽管如此，我的 Firefox 能很好地记住我的密码，将它们加密存储在磁盘上（使用主密码），并且这个加密的数据库会定期备份，以免丢失。

(3) 嗯，这可能是积极的……但是，到目前为止，我的名字从未改变，我的电子邮件地址也不会因为它是我使用的域之一并转发到真实地址（所以真实一个可以改变，我只是更新转发，一切都像以前一样）。我的街道地址？嗯，有些人经常搬家。到目前为止，我一生中只搬过一次。但是，大多数方面不需要知道我的街道地址。我认为没有理由让人们知道这些信息的网站，但要求我填写它以进行注册，只是得到一个伪造的。整个互联网上很少有网站知道我的真实地址（实际上只有那些可能不得不向我发送蜗牛邮件或我可能在哪里订购商品的网站）。

(4) 其实我是反过来看的。它最大限度地提高了安全风险。如何将风险降到最低？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-08T11:35:37.530

OpenID 本质上是不安全的。它的工作原理是您的站点将用户重定向到他们的开放 ID 提供者站点，然后接受从该站点返回的 ID。这提供了两个方向的不安全感。您必须信任返回的 ID（因为您自己无法验证用户身份），并且很容易操作用户的开放 ID 提供者的代理，这允许您窃取他们的用户名和密码。

OpenID 适用于 Stack Overflow 之类的东西，如果有人冒充你并不重要。将 OpenID 用于具有更严重（在个人层面上）内容的网站是非常危险的。例如，如果您将 OpenID 用于您的电子邮件，那么任何窃取您 ID 的人都可以访问您的电子邮件。然后，他们可以反过来向您使用的其他网站发送密码提醒请求，以获取这些网站的密码。在最坏的情况下，您可以将 OpenID 用于银行帐户，或者让银行向您的电子邮件帐户发送密码提醒......

OpenID 还有许多其他安全问题。[您可以在“互联网隐私”](http://idcorner.org/2007/08/22/the-problems-with-openid/)中找到更多信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-08T22:52:49.333

OpenID 确实将另一方添加到身份验证过程中，您必须将其视为受信任的组件。这与任何允许通过电子邮件恢复帐户的应用程序非常相似，但是虽然您的电子邮件消息以明文形式传输，但您可以选择仅通过经过验证的 HTTPS 连接与 OpenID 提供商进行通信。

查看规范的[安全注意事项](http://openid.net/specs/openid-authentication-2_0.html#security_considerations)部分。

有关 OpenID 中的弱点的详细描述以及优秀 OpenID 提供者如何提供比传统的容易被钓鱼的密码更安全的体验的演示，请参阅[Kim Cameron](http://www.identityblog.com/wp-content/images/2008/02/OpenID/Normal/OpenIDPhish.html)的来自他的[Identity Weblog](http://www.identityblog.com/)的这段简短视频。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-24T11:52:41.253

如果您选择忽略所有不支持 HTTPS 的 OpenID 提供程序，则可以使 OpenID 更加安全

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-09T09:39:42.903

我认为大多数 OpenId 提供商的主要弱点是他们通过电子邮件提供密码恢复。这会将 OpenId 的安全性降低到我的电子邮件提供商的安全性。如果有人可以访问我的电子邮件帐户，他可以有效地窃取我的身份（无论是否有 OpenId）。

使用 OpenId 进行身份验证使窃取 ym 身份变得更加容易。只需访问我的电子邮件帐户并重置我的 OpenId 密码。没什么可做的（而不是 100 个密码重置请求，我在网络上的每个帐户一个）。

更糟糕的是，如果攻击者更改了我的电子邮件帐户密码，我将很难证明我是该 OpenId 帐户的原始所有者。攻击者可能会将关联的电子邮件帐户更改为他的帐户，因此即使我稍后取回我的电子邮件帐户，我也无法重置密码。

访问我的 OpenId 提供商发送的用于窃取我的身份的密码恢复电子邮件可能就足够了。

OpenId 提供商必须提供禁用电子邮件密码恢复功能，并提供更安全的方式来恢复丢失的密码。基于邮政地址、护照或银行账户的东西（我比电子邮件账户更信任的东西）。

只要可以通过访问单个电子邮件来接管 OpenId 帐户，它只不过是一个额外的单点故障。

另请参阅：[http](http://danielmiessler.com/blog/from-password-reset-mechanisms-to-openid-a-brief-discussion-of-online-password-security) ://danielmiessler.com/blog/from-password-reset-mechanisms-to-openid-a-brief-discussion-of-online-password-security其中“最弱的链接：电子邮件密码重置机制”是也解决了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-29T17:40:58.083

虽然这个线程很旧，但我想加我的 2 美分。我认为 OpenId 有一个似乎没人关心的缺陷。当我通过雅虎进行身份验证时，它实际上将我登录到雅虎。它不应该让你登录到雅虎它应该只是验证你有雅虎的正确凭据。当您退出我的应用程序时，您仍然登录到雅虎。如果您离开共享计算机而另一个人转到雅虎，您将登录..因为当您通过雅虎进行身份验证时，他们也会将您登录到他们的服务。他们应该只是对您进行身份验证，而不是让您登录。我已经告诉过几个人，甚至用 stackoverflow.com 进行了演示（他的注销机制很糟糕，当我点击注销时，我希望被注销，请不要点击另一个注销按钮）。尝试退出 yahoo 或 gmail。关闭所有标签，然后使用 yahoo/gmail 登录到 stackoverflow。然后注销堆栈溢出..（确保您两次注销）..现在浏览到 yahoo 或 gmail，您已登录。现在我得到的讽刺答案是“不要使用共享计算机，您应该注销Yahoo / gmail 等”......每个人都不是拥有 MIS 或计算机科学学位的开发人员，我的岳母会认为当她退出 Stackoverflow 时，她仍然不会登录到 yahoo.. 也许我我缺少一些参数或实际上会强制执行我想要的东西，但肯定不会在文档中告诉您 OpenId 有多棒！！！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-22T13:33:48.857

哎哟。MyOpenID 报告未经确认的电子邮件地址，只是对此进行了测试。看起来只有一些手动列入白名单的提供商（如 google/yahoo 和其他几个）才应该信任电子邮件信息。如果有人感兴趣，我会在这里链接代码。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-09-11T14:00:09.783

我喜欢 Verisign 的 VIP 访问权限，网站可以使用，还有一个不错的 iPhone 小应用程序，可以让您拥有生成的令牌进入，就像 secureID

# oracle - 如何约束数据库表，使一列中只有一行可以具有特定值？

> ID：182262
> 
> 赞同：16
> 
> 时间：2008-10-08T11:34:52.930
> 
> 标签：oracle, triggers, constraints

使用 Oracle，如果列值可以是“YES”或“NO”，是否可以约束表，以便只有一行可以具有“YES”值？

我宁愿重新设计表结构，但这是不可能的。

[UDPATE] 遗憾的是，此表中不允许使用空值。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-08T12:13:33.197

使用基于函数的索引：

```
create unique index only_one_yes on mytable
(case when col='YES' then 'YES' end); 
```

Oracle 只索引不完全为空的键，这里的 CASE 表达式确保所有“NO”值都更改为空值，因此不被索引。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-08T11:42:53.413

这是一个笨拙的 hack，但如果该列允许 NULL，那么您可以使用 NULL 代替“NO”并像以前一样使用“YES”。对该列应用唯一键约束，您将永远不会得到两个“YES”值，但仍然有很多 NO。

更新：@Nick Pierpoint：建议添加一个检查约束，以便将列值限制为“YES”和 NULL。语法都在他的回答中制定出来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-08T15:25:24.963

您将需要查看 Tom Kyte 的文章，其中确切地提出了这个问题和他的答案：

[http://tkyte.blogspot.com/2008/05/another-of-day.html](http://tkyte.blogspot.com/2008/05/another-of-day.html)

总结：不使用触发器，不使用自治事务，使用两张表。

如果您使用 Oracle 数据库，那么您必须了解[AskTom](http://asktom.oracle.com)并获取他的书籍。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-08T11:38:17.853

它不适用于表定义。

但是，如果您使用调用存储过程的触发器更新表，则可以确保只有一行包含“YES”。

1.  将所有行设置为“否”
2.  将您想要的行设置为 YES

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T12:30:02.680

从我的评论到 yukondude 之前的回答，我将添加一个唯一索引和一个检查约束：

```
create table mytest (
    yesorno varchar2(3 char)
);

create unique index uk_mytest_yesorno on mytest(yesorno);

alter table mytest add constraint ck_mytest_yesorno check (yesorno is null or yesorno = 'YES'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T11:48:40.970

**Oracle 是否支持过滤索引**之类的东西（上周我听说例如 MSSQL2008 支持）？也许您可以定义一个**唯一键**，该键仅适用于列中值为“是”的行。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-08T12:22:40.557

我想我会使用第二个表来指向当前表中的适当行。该其他表也可用于存储其他变量的值。

# sharepoint - SharePoint 中的默认版本控制

> ID：182273
> 
> 赞同：5
> 
> 时间：2008-10-08T11:36:55.267
> 
> 标签：sharepoint

如何修改 SharePoint 网站，以便在文档库中默认启用版本控制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T11:43:57.810

版本控制不是在站点级别进行的，而是在列表级别进行的。

如果您希望在每个新库上启用版本控制，您必须：

*   使用您自己的库模板（打开版本控制）
*   使用功能 + 事件处理程序以编程方式激活每个新列表的版本控制

最简单的方法可能是使用您自己的模板。为此，请创建一个新文档库，激活版本控制，然后将此列表另存为模板。

当您创建一个新列表时，您将能够使用您的模板并直接创建一个激活了版本控制的列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T00:04:15.850

您当然可以创建自己的站点定义，但这可能不是最佳解决方案。创建自定义库模板也可以，但如果您希望为特定站点定义为您创建的库打开版本控制，您将不得不想出其他方法。

我们碰巧为我们的 SharePoint 实施完成了这项工作。我们决定最好的方法是创建一个事件处理程序功能并将其装订到所有站点，以便在创建站点时，将为所有现有文档库启用版本控制。当然，新文档库将获得创建它的用户设置的任何版本控制选项。

我们遇到的问题是没有“ListCreating”事件处理程序，所以我们当时无法打开版本控制。因此，我们尝试将代码放在 FeatureActivated 事件处理程序中，认为它将在站点创建时激活，然后可以更改所有文档库以启用版本控制。问题是在实际创建库之前触发了此事件。

因此，我们决定将代码放入“ItemAdding”事件处理程序中，并在第一次运行后将其删除。因此，当用户第一次添加列表项或文档时，它将为站点中的所有文档库打开版本控制。这样，我们确保用户无法在没有版本控制的情况下将文档添加到现有库中。此外，在添加项目之前创建的任何库也将默认打开版本控制。

这是一个有点麻烦的解决方案，但对我们来说效果很好。这是我们使用的代码：

```
public class SetVersioning : SPItemEventReceiver
{
    public override void ItemAdding(SPItemEventProperties properties)
    {
        SPWeb CurrentWeb = properties.OpenWeb();
        foreach (SPDocumentLibrary doclib in CurrentWeb.GetListsOfType(SPBaseType.DocumentLibrary))
        {
            doclib.EnableVersioning = true;
            doclib.MajorVersionLimit = 8;
            //doclib.EnableMinorVersions = true;
            doclib.Update();
        }
        //now get rid of the receiver
        SPEventReceiverDefinitionCollection receivers = CurrentWeb.EventReceivers;
        foreach (SPEventReceiverDefinition definition in receivers)
        {
            if (definition.Name.Equals(EVENT_RECEIVER_NAME))
            {
                definition.Delete();
                break;
            }
        }

        base.ItemAdding(properties);
    }
} 
```

# open-source - 寻找用于编辑 AAC 元数据（M4A 文件）的开源库

> ID：182277
> 
> 赞同：8
> 
> 时间：2008-10-08T11:37:32.613
> 
> 标签：open-source, audio, aac, m4a

我正在寻找一个开源库，用于编辑 M4A 文件中的 AAC 元数据（如 iTunes 中所示）。具体来说，我需要能够添加专辑封面标签。它应该类似于 id3lib，它适用于 MP3 文件上的 ID3 标签。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-01T03:36:44.863

尝试查看[mp4v2](//github.com/svnpenn/mp4v2)。尽管代码库相当大并且可能难以集成到您的构建系统中，但该库提供了一些命令行可执行文件，您可以使用它们来修改 AAC 标签，包括艺术品。

谢谢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-12T07:22:27.170

由于我没有找到任何开源库，也许开源程序可以读取和设置 MPEG-4 文件中的 iTunes 风格的元数据标签，这将对您有所帮助。 [atomicparsley.sourceforge.net](http://atomicparsley.sourceforge.net/)

还提供了已知的 iTunes 元数据结构：[http://atomicparsley.sourceforge.net/mpeg-4files.html](http://atomicparsley.sourceforge.net/mpeg-4files.html)

此讨论也可能对您有所帮助：[www.hydrogenaudio.org/forums/lofiversion/index.php/t31022.html](http://www.hydrogenaudio.org/forums/lofiversion/index.php/t31022.html)

祝你好运

# java - 有没有办法在 Java 中模拟 C++ 的“朋友”概念？

> ID：182278
> 
> 赞同：226
> 
> 时间：2008-10-08T11:37:53.360
> 
> 标签：java, c++, friend, accessor

我希望能够在一个包中编写一个 Java 类，该类可以访问另一个包中的类的非公共方法，而不必使其成为另一个类的子类。这可能吗？

* * *

## 回答 #1

> 赞同：557
> 
> 时间：2013-09-05T10:39:37.790

**这是我在 JAVA 中用来复制 C++ 友元机制的一个小技巧。**

可以说我有一个班级`Romeo`和另一个班级`Juliet`。出于仇恨的原因，他们在不同的包裹（家庭）中。

`Romeo`想要`cuddle` `Juliet`并且`Juliet`只想让`Romeo` `cuddle`她。

在 C++ 中，`Juliet`会声明`Romeo`为（情人）`friend`，但在 java 中没有这样的东西。

这是课程和技巧：

女士优先 ：

```
package capulet;

import montague.Romeo;

public class Juliet {

    public static void cuddle(Romeo.Love love) {
        Objects.requireNonNull(love);
        System.out.println("O Romeo, Romeo, wherefore art thou Romeo?");
    }

} 
```

所以方法`Juliet.cuddle`是`public`，但你需要`Romeo.Love`调用它。它使用这个`Romeo.Love`作为“签名安全”来确保只有`Romeo`可以调用这个方法并检查爱是真实的，这样运行时就会抛出一个`NullPointerException`if it is `null`。

现在男孩：

```
package montague;

import capulet.Juliet;

public class Romeo {
    public static final class Love { private Love() {} }
    private static final Love love = new Love();

    public static void cuddleJuliet() {
        Juliet.cuddle(love);
    }
} 
```

该类`Romeo.Love`是公共的，但它的构造函数是`private`. 因此任何人都可以看到它，但只能`Romeo`构建它。我使用静态引用，因此`Romeo.Love`从未使用过的引用只构造一次，不会影响优化。

因此，`Romeo`可以`cuddle` `Juliet`而且只有他可以，因为只有他可以构造和访问一个`Romeo.Love`实例，这是她所需要的`Juliet`（`cuddle`否则她会打你一巴掌`NullPointerException`）。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-10-08T12:00:54.050

Java 的设计者明确拒绝了朋友的想法，因为它在 C++ 中工作。你把你的“朋友”放在同一个包裹里。作为语言设计的一部分，强制执行私有、受保护和打包的安全性。

James Gosling 希望 Java 成为没有错误的 C++。我相信他觉得那个朋友是个错误，因为它违反了 OOP 原则。包提供了一种合理的方式来组织组件，而不会过于纯粹地关注 OOP。

NR 指出您可以使用反射来作弊，但即使这样也只有在您不使用 SecurityManager 时才有效。如果您打开 Java 标准安全性，您将无法使用反射作弊，除非您编写安全策略来明确允许它。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2008-11-25T09:44:13.493

“朋友”概念在 Java 中很有用，例如，将 API 与其实现分开。实现类通常需要访问 API 类内部，但这些不应暴露给 API 客户端。这可以使用下面详述的“朋友访问器”模式来实现：

通过 API 暴露的类：

```
package api;

public final class Exposed {
    static {
        // Declare classes in the implementation package as 'friends'
        Accessor.setInstance(new AccessorImpl());
    }

    // Only accessible by 'friend' classes.
    Exposed() {

    }

    // Only accessible by 'friend' classes.
    void sayHello() {
        System.out.println("Hello");
    }

    static final class AccessorImpl extends Accessor {
        protected Exposed createExposed() {
            return new Exposed();
        }

        protected void sayHello(Exposed exposed) {
            exposed.sayHello();
        }
    }
} 
```

提供“朋友”功能的类：

```
package impl;

public abstract class Accessor {

    private static Accessor instance;

    static Accessor getInstance() {
        Accessor a = instance;
        if (a != null) {
            return a;
        }

        return createInstance();
    }

    private static Accessor createInstance() {
        try {
            Class.forName(Exposed.class.getName(), true, 
                Exposed.class.getClassLoader());
        } catch (ClassNotFoundException e) {
            throw new IllegalStateException(e);
        }

        return instance;
    }

    public static void setInstance(Accessor accessor) {
        if (instance != null) {
            throw new IllegalStateException(
                "Accessor instance already set");
        }

        instance = accessor;
    }

    protected abstract Exposed createExposed();

    protected abstract void sayHello(Exposed exposed);
} 
```

从“朋友”实现包中的类访问示例：

```
package impl;

public final class FriendlyAccessExample {
    public static void main(String[] args) {
        Accessor accessor = Accessor.getInstance();
        Exposed exposed = accessor.createExposed();
        accessor.sayHello(exposed);
    }
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-05-27T15:44:03.760

您的问题有两种解决方案，它们不涉及将所有类保存在同一个包中。

第一种是使用(Practical API Design, Tulach 2008) 中描述的 Friend Accessor/ [Friend Package模式。](http://wiki.apidesign.org/wiki/APIDesignPatterns:FriendPackages)

二是使用OSGi。[这里](http://www.1biznow.com/2009/02/hide-private-parts-of-your-bundle.html)有一篇文章解释了 OSGi 是如何做到这一点的。

相关问题：[1](https://stackoverflow.com/questions/5872124/how-to-hide-the-internal-structure-of-a-java-api-to-the-rest-of-the-world/6154321#6154321)、[2](https://stackoverflow.com/questions/4759692/hiding-classes-in-a-jar-file)和[3](https://stackoverflow.com/questions/4647599/why-friend-directive-is-missing-in-java)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-08T11:48:25.447

据我所知，这是不可能的。

也许，你可以给我们一些关于你的设计的更多细节。像这样的问题很可能是设计缺陷的结果。

只考虑

*   如果它们密切相关，为什么这些类在不同的包中？
*   A 可以访问 B 的私有成员，还是应该将操作移至 B 类并由 A 触发？
*   这真的是调用还是事件处理更好？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-18T02:27:23.900

eirikma 的回答既简单又出色。我可能会再添加一件事：不是使用公开访问的方法 getFriend() 来获取无法使用的朋友，您可以更进一步并禁止在没有令牌的情况下获取朋友：getFriend(Service.FriendToken)。这个 FriendToken 将是一个带有私有构造函数的内部公共类，因此只有 Service 可以实例化一个。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-08-13T08:57:38.930

`Friend`这是一个带有可重用类的清晰用例示例。这种机制的好处是使用简单。可能有利于为单元测试类提供比应用程序的其余部分更多的访问权限。

首先，这是一个如何使用`Friend`该类的示例。

```
public class Owner {
    private final String member = "value";

    public String getMember(final Friend friend) {
        // Make sure only a friend is accepted.
        friend.is(Other.class);
        return member;
    }
} 
```

然后在另一个包中你可以这样做：

```
public class Other {
    private final Friend friend = new Friend(this);

    public void test() {
        String s = new Owner().getMember(friend);
        System.out.println(s);
    }
} 
```

`Friend`课程如下。

```
public final class Friend {
    private final Class as;

    public Friend(final Object is) {
        as = is.getClass();
    }

    public void is(final Class c) {
        if (c == as)
            return;
        throw new ClassCastException(String.format("%s is not an expected friend.", as.getName()));
    }

    public void is(final Class... classes) {
        for (final Class c : classes)
            if (c == as)
                return;
        is((Class)null);
    }
} 
```

但是，问题在于它可以像这样被滥用：

```
public class Abuser {
    public void doBadThings() {
        Friend badFriend = new Friend(new Other());
        String s = new Owner().getMember(badFriend);
        System.out.println(s);
    }
} 
```

现在，`Other`该类可能确实没有任何公共构造函数，因此使上述`Abuser`代码成为不可能。但是，如果您的类*确实*有一个公共构造函数，那么可能建议将 Friend 类复制为内部类。以这个`Other2`类为例：

```
public class Other2 {
    private final Friend friend = new Friend();

    public final class Friend {
        private Friend() {}
        public void check() {}
    }

    public void test() {
        String s = new Owner2().getMember(friend);
        System.out.println(s);
    }
} 
```

然后`Owner2`类将是这样的：

```
public class Owner2 {
    private final String member = "value";

    public String getMember(final Other2.Friend friend) {
        friend.check();
        return member;
    }
} 
```

请注意，`Other2.Friend`该类有一个私有构造函数，因此这是一种更安全的方法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-07T18:37:40.413

提供的解决方案可能不是最简单的。另一种方法基于与 C++ 中相同的想法：私有成员在包/私有范围之外是不可访问的，除了所有者与自己交朋友的特定类。

需要对成员进行朋友访问的类应该创建一个内部公共抽象“朋友类”，拥有隐藏属性的类可以通过返回实现访问实现方法的子类来导出访问权限。朋友类的“API”方法可以是私有的，因此在需要朋友访问的类之外无法访问它。它唯一的语句是调用导出类实现的抽象受保护成员。

这是代码：

首先验证这确实有效的测试：

```
package application;

import application.entity.Entity;
import application.service.Service;
import junit.framework.TestCase;

public class EntityFriendTest extends TestCase {
    public void testFriendsAreOkay() {
        Entity entity = new Entity();
        Service service = new Service();
        assertNull("entity should not be processed yet", entity.getPublicData());
        service.processEntity(entity);
        assertNotNull("entity should be processed now", entity.getPublicData());
    }
} 
```

然后需要朋友访问实体的包私有成员的服务：

```
package application.service;

import application.entity.Entity;

public class Service {

    public void processEntity(Entity entity) {
        String value = entity.getFriend().getEntityPackagePrivateData();
        entity.setPublicData(value);
    }

    /**
     * Class that Entity explicitly can expose private aspects to subclasses of.
     * Public, so the class itself is visible in Entity's package.
     */
    public static abstract class EntityFriend {
        /**
         * Access method: private not visible (a.k.a 'friendly') outside enclosing class.
         */
        private String getEntityPackagePrivateData() {
            return getEntityPackagePrivateDataImpl();
        }

        /** contribute access to private member by implementing this */
        protected abstract String getEntityPackagePrivateDataImpl();
    }
} 
```

最后：Entity 类仅对类 application.service.Service 提供对包私有成员的友好访问。

```
package application.entity;

import application.service.Service;

public class Entity {

    private String publicData;
    private String packagePrivateData = "secret";   

    public String getPublicData() {
        return publicData;
    }

    public void setPublicData(String publicData) {
        this.publicData = publicData;
    }

    String getPackagePrivateData() {
        return packagePrivateData;
    }

    /** provide access to proteced method for Service'e helper class */
    public Service.EntityFriend getFriend() {
        return new Service.EntityFriend() {
            protected String getEntityPackagePrivateDataImpl() {
                return getPackagePrivateData();
            }
        };
    }
} 
```

好吧，我必须承认它比“friend service::Service;”要长一点。但是可以通过使用注释在保留编译时检查的同时缩短它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-08T11:39:35.947

不使用关键字左右。

您可以使用反射等“作弊”，但我不建议“作弊”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-13T10:57:42.617

在 Java 中，可以有一个“包相关的友好性”。这对于单元测试很有用。如果你没有在方法前面指定 private/public/protected，它将是“包中的朋友”。同一个包中的类将能够访问它，但它在类之外是私有的。

这条规则并不总是已知的，它是 C++“朋友”关键字的一个很好的近似值。我觉得它是一个很好的替代品。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-03-26T18:58:49.807

我认为 C++ 中的友元类就像 Java 中的内部类概念。使用内部类，您实际上可以定义一个封闭类和一个封闭类。封闭类可以完全访问其封闭类的公共和私有成员。请参阅以下链接： [http ://docs.oracle.com/javase/tutorial/java/javaOO/nested.html](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-08-01T16:01:29.633

我认为，使用朋友访问器模式的方法太复杂了。我不得不面对同样的问题，我在 Java 中使用 C++ 中已知的良好的、旧的复制构造函数解决了问题：

```
public class ProtectedContainer {
    protected String iwantAccess;

    protected ProtectedContainer() {
        super();
        iwantAccess = "Default string";
    }

    protected ProtectedContainer(ProtectedContainer other) {
        super();
        this.iwantAccess = other.iwantAccess;
    }

    public int calcSquare(int x) {
        iwantAccess = "calculated square";
        return x * x;
    }
} 
```

在您的应用程序中，您可以编写以下代码：

```
public class MyApp {

    private static class ProtectedAccessor extends ProtectedContainer {

        protected ProtectedAccessor() {
            super();
        }

        protected PrivateAccessor(ProtectedContainer prot) {
            super(prot);
        }

        public String exposeProtected() {
            return iwantAccess;
        }
    }
} 
```

这种方法的优点是只有您的应用程序才能访问受保护的数据。它不完全是friend关键字的替代品。但是我认为当您编写自定义库并且需要访问受保护的数据时，它非常适合。

每当您必须处理 ProtectedContainer 的实例时，您都可以将 ProtectedAccessor 包裹在它周围并获得访问权限。

它也适用于受保护的方法。您在 API 中定义它们受保护。稍后在您的应用程序中，您编写一个私有包装类并将受保护的方法公开为公共的。就是这样。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-08T11:48:57.800

如果你想访问受保护的方法，你可以创建一个你想使用的类的子类，它将你想使用的方法公开（或者在命名空间内部更安全），并在你的类中有一个该类的实例（将其用作代理）。

就私有方法而言（我认为）你不走运。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-08T04:07:06.023

我更喜欢委托或组合或工厂类（取决于导致此问题的问题）以避免使其成为公共类。

如果是“不同包中的接口/实现类”问题，那么我会使用与 impl 包在同一个包中的公共工厂类，并防止 impl 类的暴露。

如果这是一个“我讨厌公开这个类/方法只是为了为不同包中的其他类提供这个功能”问题，那么我会在同一个包中使用一个公共委托类并只公开那部分功能“局外人”阶层需要。

其中一些决策是由目标服务器类加载架构（OSGi 包、WAR/EAR 等）、部署和包命名约定驱动的。例如，上面提出的解决方案“Friend Accessor”模式对于普通的 Java 应用程序来说是很聪明的。我想知道由于类加载风格的不同，在 OSGi 中实现它是否会变得棘手。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-08-17T02:57:00.507

我同意在大多数情况下，朋友关键字是不必要的。

*   包私有（又名。默认）在大多数情况下就足够了，因为您有一组紧密交织的类
*   对于想要访问内部的调试类，我通常将方法设为私有并通过反射访问它。速度通常在这里并不重要
*   有时，您实现的方法是“hack”或其他可能会发生变化的方法。我将其公开，但使用 @Deprecated 表示您不应依赖现有的此方法。

最后，如果确实有必要，还有其他答案中提到的朋友访问器模式。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-04-08T21:45:26.230

我发现解决此问题的一种方法是创建一个访问器对象，如下所示：

```
class Foo {
    private String locked;

    /* Anyone can get locked. */
    public String getLocked() { return locked; }

    /* This is the accessor. Anyone with a reference to this has special access. */
    public class FooAccessor {
        private FooAccessor (){};
        public void setLocked(String locked) { Foo.this.locked = locked; }
    }
    private FooAccessor accessor;

    /** You get an accessor by calling this method. This method can only
     * be called once, so calling is like claiming ownership of the accessor. */
    public FooAccessor getAccessor() {
        if (accessor != null)
            throw new IllegalStateException("Cannot return accessor more than once!");
        return accessor = new FooAccessor();
    }
} 
```

第一个调用`getAccessor()`访问者“声明所有权”的代码。通常，这是创建对象的代码。

```
Foo bar = new Foo(); //This object is safe to share.
FooAccessor barAccessor = bar.getAccessor(); //This one is not. 
```

与 C++ 的友元机制相比，这也有一个优势，因为它允许您在*每个实例*级别上限制访问，而不是在*每个类*级别上。通过控制访问器引用，您可以控制对对象的访问。您还可以创建多个访问器，并为每个访问器提供不同的访问权限，这允许对哪些代码可以访问哪些内容进行细粒度控制：

```
class Foo {
    private String secret;
    private String locked;

    /* Anyone can get locked. */
    public String getLocked() { return locked; }

    /* Normal accessor. Can write to locked, but not read secret. */
    public class FooAccessor {
        private FooAccessor (){};
        public void setLocked(String locked) { Foo.this.locked = locked; }
    }
    private FooAccessor accessor;

    public FooAccessor getAccessor() {
        if (accessor != null)
            throw new IllegalStateException("Cannot return accessor more than once!");
        return accessor = new FooAccessor();
    }

    /* Super accessor. Allows access to secret. */
    public class FooSuperAccessor {
        private FooSuperAccessor (){};
        public String getSecret() { return Foo.this.secret; }
    }
    private FooSuperAccessor superAccessor;

    public FooSuperAccessor getAccessor() {
        if (superAccessor != null)
            throw new IllegalStateException("Cannot return accessor more than once!");
        return superAccessor = new FooSuperAccessor();
    }
} 
```

最后，如果你想让事情更有条理，你可以创建一个参考对象，它将所有东西放在一起。这允许您通过一个方法调用来声明所有访问器，并将它们与其链接的实例保持在一起。获得参考后，您可以将访问器传递给需要它的代码：

```
class Foo {
    private String secret;
    private String locked;

    public String getLocked() { return locked; }

    public class FooAccessor {
        private FooAccessor (){};
        public void setLocked(String locked) { Foo.this.locked = locked; }
    }
    public class FooSuperAccessor {
        private FooSuperAccessor (){};
        public String getSecret() { return Foo.this.secret; }
    }
    public class FooReference {
        public final Foo foo;
        public final FooAccessor accessor;
        public final FooSuperAccessor superAccessor;

        private FooReference() {
            this.foo = Foo.this;
            this.accessor = new FooAccessor();
            this.superAccessor = new FooSuperAccessor();
        }
    }

    private FooReference reference;

    /* Beware, anyone with this object has *all* the accessors! */
    public FooReference getReference() {
        if (reference != null)
            throw new IllegalStateException("Cannot return reference more than once!");
        return reference = new FooReference();
    }
} 
```

经过多次头部撞击（不是好的那种），这是我的最终解决方案，我非常喜欢它。它灵活、易于使用，并且可以很好地控制类访问。（*with reference only*访问非常有用。）如果您对访问器/引用使用 protected 而不是 private，则 Foo 的子类甚至可以从`getReference`. 它也不需要任何反射，因此可以在任何环境中使用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-11T07:05:30.450

从 Java 9 开始，在许多情况下，可以使用模块来解决这个问题。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-10-08T14:44:01.253

我曾经看到一个基于反射的解决方案，它在运行时使用反射进行“朋友检查”并检查调用堆栈以查看调用该方法的类是否被允许这样做。作为运行时检查，它有一个明显的缺点。

# asp.net - 替代 Html.Button ?

> ID：182280
> 
> 赞同：0
> 
> 时间：2008-10-08T11:38:26.357
> 
> 标签：asp.net, asp.net-mvc, controller, action, codeplex

我知道 Html.Button 已移至 Microsoft.Web.Mvc 命名空间，但我真的很怀念早期预览版中曾经存在的通用版本。

我想要 Html.Button 做的就是在我的控制器中点击一个动作，但我宁愿不在 onClickMethod 参数中编写 JavaScript。

在我之前的项目中，我只是从之前的预览版本中获取了通用的 Html.Button 代码，但是随着事情的进展，这似乎不是最好的方法。还有 Html.NavigateButton ......那在哪里，为什么我必须重新创建它？

其他人是如何做到这一点的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T14:18:19.857

通用版本的问题是允许过滤器将操作的实际名称与方法的名称不同（如 [ActionName] 属性）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T11:40:29.580

是的，他们真的把 CTP5 中的 Html.Button 和 Html.CheckBox 搞砸了。我希望他们回到以前的行为。

# c# - 用c#替换word文档中的占位符

> ID：182281
> 
> 赞同：6
> 
> 时间：2008-10-08T11:38:54.733
> 
> 标签：c#, .net, ms-word, placeholder

我有一个 word (.docx) 格式的模板，想用我自己的数据替换这个模板中的一些占位符，你知道我在哪里可以找到适合这个项目的类吗？知道命名空间对我来说会很好。有没有比 com 类更新的类来处理 docx 格式 (xml) 的 word 文档？感谢您的所有回答，我希望有人可以帮助我解决我的问题。

打招呼

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T11:47:56.150

新的办公格式（docx、xlsx 等）是包含 xml 文件集合的 zip 文件。考虑到这一点，您有几种方法。

1.  您可以使用位于[http://www.microsoft.com/downloads/details.aspx?FamilyId=AD0B72FB-4A1D-4C52-BDB5-7DD7E816D046&displaylang=en的 Open XML SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=AD0B72FB-4A1D-4C52-BDB5-7DD7E816D046&displaylang=en)

2.  您可以解压缩 docx 文件，搜索并替换您的令牌，然后将其压缩备份。

在[openxmldeveloper.org](http://openxmldeveloper.org)上有一个专门针对此类事情的网站。另外，请记住，他们已经发布了 SDK 的 beta 版本 2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T14:05:07.153

Eric White 在一篇博客文章中已经谈到了这个主题，该[文章详细介绍了一个旨在验证嵌入在 DocX 文件中的源代码片段的程序](http://blogs.msdn.com/ericwhite/archive/2008/09/08/openxmlcodetester-validating-code-in-open-xml-documents.aspx)。除了那篇文章，我强烈推荐阅读他关于[Office Open XML 和 C#](http://blogs.msdn.com/ericwhite/archive/2008/09/29/the-flat-opc-format.aspx)的系列文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-09T13:52:11.707

我用过这个：

IEnumerable test2 = from element in body.Elements() where element.InnerText.Contains("sdt") 选择元素；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T07:27:01.650

顺便说一句，使用 xml 我找到了这个解决方案，它可以找到所有 sdt 节点

```
 NameTable nt = new NameTable();
        XmlNamespaceManager nsManager = new XmlNamespaceManager(nt);
        nsManager.AddNamespace("w", wordmlNamespace);

        XmlDocument xDoc = new XmlDocument();
        xDoc.Load(doc.MainDocumentPart.GetStream());

        XmlNodeList nodeList = xDoc.SelectNodes(@"./w:document/w:body//w:sdt", nsManager); 
```

它可以工作，但 Open XML Format SDK 2.0 没有给我任何机会吗？

# php - Can PHP PDO Statements accept the table or column name as parameter?

> ID：182287
> 
> 赞同：259
> 
> 时间：2008-10-08T11:39:57.787
> 
> 标签：php, pdo

Why can't I pass the table name to a prepared PDO statement?

```
$stmt = $dbh->prepare('SELECT * FROM :table WHERE 1');
if ($stmt->execute(array(':table' => 'users'))) {
    var_dump($stmt->fetchAll());
} 
```

Is there another safe way to insert a table name into a SQL query? With safe, I mean that I don't want to do

```
$sql = "SELECT * FROM $table WHERE 1" 
```

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2008-10-08T11:57:15.897

**Table and Column names CANNOT be replaced by parameters in PDO.**

In that case you will simply want to filter and sanitize the data manually. One way to do this is to pass in shorthand parameters to the function that will execute the query dynamically and then use a `switch()` statement to create a white list of valid values to be used for the table name or column name. That way no user input ever goes directly into the query. So for example:

```
function buildQuery( $get_var ) 
{
    switch($get_var)
    {
        case 1:
            $tbl = 'users';
            break;
    }

    $sql = "SELECT * FROM $tbl";
} 
```

By leaving no default case or using a default case that returns an error message you ensure that only values that you want used get used.

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2013-04-13T17:04:20.017

To understand *why* binding a table (or column) name doesn't work, you have to understand how the placeholders in prepared statements work: they are not simply substituted in as (suitably escaped) strings, and the resulting SQL executed. Instead, a DBMS asked to "prepare" a statement comes up with a complete query plan for how it would execute that query, including which tables and indexes it would use, which will be the same regardless of how you fill in the placeholders.

The plan for `SELECT name FROM my_table WHERE id = :value` will be the same whatever you substitute for `:value`, but the seemingly similar `SELECT name FROM :table WHERE id = :value` cannot be planned, because the DBMS has no idea what table you're actually going to select from.

This is not something an abstraction library like PDO can or should work around, either, since it would defeat the 2 key purposes of prepared statements: 1) to allow the database to decide in advance how a query will be run, and use the same plan multiple times; and 2) to prevent security issues by separating the logic of the query from the variable input.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-04-30T17:30:06.143

I see this is an old post, but I found it useful and thought I'd share a solution similar to what @kzqai suggested:

I have a function that receives two parameters like...

```
function getTableInfo($inTableName, $inColumnName) {
    ....
} 
```

Inside I check against arrays I've set up to make sure only tables and columns with "blessed" tables are accessible:

```
$allowed_tables_array = array('tblTheTable');
$allowed_columns_array['tblTheTable'] = array('the_col_to_check'); 
```

Then the PHP check before running PDO looks like...

```
if(in_array($inTableName, $allowed_tables_array) && in_array($inColumnName,$allowed_columns_array[$inTableName]))
{
    $sql = "SELECT $inColumnName AS columnInfo
            FROM $inTableName";
    $stmt = $pdo->prepare($sql); 
    $stmt->execute();
    $result = $stmt->fetchAll(PDO::FETCH_ASSOC);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-08T11:46:45.263

Using the former isn't inherently more safe than the latter, you need to sanitize the input whether it's part of a parameter array or a simple variable. So I don't see anything wrong with using the latter form with `$table`, provided you make sure that the content of `$table` is safe (alphanum plus underscores?) before using it.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-11-08T15:05:53.197

*(Late answer, consult my side note).*

The same rule applies when trying to create a "database".

You cannot use a prepared statement to bind a database.

I.e.:

```
CREATE DATABASE IF NOT EXISTS :database 
```

will not work. Use a safelist instead.

**Side note:** I added this answer (as a community wiki) because it often used to close questions with, where some people posted questions similar to this in trying to bind a **database** and not a table and/or column.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-29T00:21:15.373

Part of me wonders if you could provide your own custom sanitizing function as simple as this:

```
$value = preg_replace('/[^a-zA-Z_]*/', '', $value); 
```

I haven't really thought through it, but it seems like removing anything except characters and underscores might work.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-09T15:36:05.027

As for the main question in this thread, the other posts made it clear why we can't bind values to column names when preparing statements, so here is one solution:

```
class myPdo{
    private $user   = 'dbuser';
    private $pass   = 'dbpass';
    private $host   = 'dbhost';
    private $db = 'dbname';
    private $pdo;
    private $dbInfo;
    public function __construct($type){
        $this->pdo = new PDO('mysql:host='.$this->host.';dbname='.$this->db.';charset=utf8',$this->user,$this->pass);
        if(isset($type)){
            //when class is called upon, it stores column names and column types from the table of you choice in $this->dbInfo;
            $stmt = "select distinct column_name,column_type from information_schema.columns where table_name='sometable';";
            $stmt = $this->pdo->prepare($stmt);//not really necessary since this stmt doesn't contain any dynamic values;
            $stmt->execute();
            $this->dbInfo = $stmt->fetchAll(PDO::FETCH_ASSOC);
        }
    }
    public function pdo_param($col){
        $param_type = PDO::PARAM_STR;
        foreach($this->dbInfo as $k => $arr){
            if($arr['column_name'] == $col){
                if(strstr($arr['column_type'],'int')){
                    $param_type = PDO::PARAM_INT;
                    break;
                }
            }
        }//for testing purposes i only used INT and VARCHAR column types. Adjust to your needs...
        return $param_type;
    }
    public function columnIsAllowed($col){
        $colisAllowed = false;
        foreach($this->dbInfo as $k => $arr){
            if($arr['column_name'] === $col){
                $colisAllowed = true;
                break;
            }
        }
        return $colisAllowed;
    }
    public function q($data){
        //$data is received by post as a JSON object and looks like this
        //{"data":{"column_a":"value","column_b":"value","column_c":"value"},"get":"column_x"}
        $data = json_decode($data,TRUE);
        $continue = true;
        foreach($data['data'] as $column_name => $value){
            if(!$this->columnIsAllowed($column_name)){
                 $continue = false;
                 //means that someone possibly messed with the post and tried to get data from a column that does not exist in the current table, or the column name is a sql injection string and so on...
                 break;
             }
        }
        //since $data['get'] is also a column, check if its allowed as well
        if(isset($data['get']) && !$this->columnIsAllowed($data['get'])){
             $continue = false;
        }
        if(!$continue){
            exit('possible injection attempt');
        }
        //continue with the rest of the func, as you normally would
        $stmt = "SELECT DISTINCT ".$data['get']." from sometable WHERE ";
        foreach($data['data'] as $k => $v){
            $stmt .= $k.' LIKE :'.$k.'_val AND ';
        }
        $stmt = substr($stmt,0,-5)." order by ".$data['get'];
        //$stmt should look like this
        //SELECT DISTINCT column_x from sometable WHERE column_a LIKE :column_a_val AND column_b LIKE :column_b_val AND column_c LIKE :column_c_val order by column_x
        $stmt = $this->pdo->prepare($stmt);
        //obviously now i have to bindValue()
        foreach($data['data'] as $k => $v){
            $stmt->bindValue(':'.$k.'_val','%'.$v.'%',$this->pdo_param($k));
            //setting PDO::PARAM... type based on column_type from $this->dbInfo
        }
        $stmt->execute();
        return $stmt->fetchAll(PDO::FETCH_ASSOC);//or whatever
    }
}
$pdo = new myPdo('anything');//anything so that isset() evaluates to TRUE.
var_dump($pdo->q($some_json_object_as_described_above)); 
```

The above is just an example, so needless to say, copy->paste won't work. Adjust for your needs. Now this may not provide 100% security, but it allows some control over the column names when they "come in" as dynamic strings and may be changed on users end. Furthermore, there is no need to build some array with your table column names and types since they are extracted from the information_schema.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-04T23:17:13.217

Short answer is NO you cannot use dynamic table name, field names, etc in the Prepared execute statement with PDO because it adds quotes to them which will break the query. But if you can sanitize them, then you can safely plop them right in the query itself just like you would with MySQLi anyway.

The correct way to do this is with mysqli's mysqli_real_escape_string() function because the mysql_real_escape_string was removed from PHP hastily without any consideration into how that affects dynamic structure applications.

```
$unsanitized_table_name = "users' OR '1'='1"; //SQL Injection attempt
$sanitized_table_name = sanitize_input($unsanitized_table_name);

$stmt = $dbh->prepare("SELECT * FROM {$unsanitized_table_name} WHERE 1"); //<--- REALLY bad idea
$stmt = $dbh->prepare("SELECT * FROM {$sanitized_table_name} WHERE 1"); //<--- Not ideal but hey, at least you're safe.

//PDO Cant sanitize everything so we limp along with mysqli instead
function sanitize_input($string)
{
   $mysqli = new mysqli("localhost","UsahName","Passerrrd");
   $string = $mysqli->real_escape_string($string);

   return $string;
} 
```

# svn - Subversion 与 Vault

> ID：182298
> 
> 赞同：16
> 
> 时间：2008-10-08T11:42:28.047
> 
> 标签：svn, version-control, sourcegear-vault

> **可能重复：**
> [有什么工具可以将 repo 从 Vault 迁移到 Subversion？](https://stackoverflow.com/questions/57530/any-tool-to-migrate-repo-from-vault-to-subversion)

我目前正在审查从 SVN 迁移到 SourceGear Vault 的好处。有没有人得到建议或链接到两者之间的详细比较？请记住，我将不得不移动我当前的源代码控制系统，该系统在 SVN 的支持下非常有效

这是我迄今为止从自己的调查中发现的一些信息。

我已经在两者之间进行了一些时间测试，而 Vault 似乎执行大多数操作的速度要快得多。时间测试使用与存储库相同的服务器、相同的工作站客户端和相同的项目。

**时间比较**

*   SVN

添加/提交 12:30 获取最新版本 5:35 标记/标签 0:01 分支 N/A - 我认为 SVN 中不存在真正的分支

*   保险库

添加/提交 4:45 获取最新版本 0:51 标记/标签 0:30 分支 3:23

*（无法正确格式化）*

我还找到了一个比较其他点的在线资源。这是我正在寻找的信息。

**使用比较**

*   颠覆只是编辑/合并/提交。Vault 允许您进行编辑/合并/提交或签出/编辑/签入。

*   Vault 的外观和行为就像 VSS，这使得 VSS 用户的学习曲线实际上为零。

*   Vault 有一个 VS 插件，但它仅在您要在结帐模式下运行时才有效。

*   Subversion 拥有几乎所有你能想象到的操作系统的客户端。Vault 有一个用于 Windows 的 GUI 客户端和一个用于 Mono 的命令行客户端。

*   两者都将支持远程工作，因为它们都使用 HTTP 作为传输（Subversion 使用扩展 DAV，Vault 使用 SOAP）。

*   Subversion 安装，尤其是带有 Apache 的安装，更加复杂。

*   Subversion 有很多第三方支持。保险柜只有几样东西。

**我的问题**

有没有人得到建议或链接到两者之间的详细比较？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-08T12:27:24.667

在“愤怒地”使用这两种方法后，我每天都会选择 Subversion（使用 TortoiseSVN）而不是 Vault。

[当我从 Subversion 转到 Vault 时，我注意到了这一点](http://blog.mrlacey.co.uk/2008/03/subversion-vs-vault.html)：

*   无法在一个简单的步骤中获取我未更改的所有内容的最新信息，开箱即用
*   不能轻易看到任何变化
*   默认情况下，Vault 会尝试将我尚未签出的所有内容设为只读
*   我必须检查一下
*   加载（保险库客户端）真的很慢，而不是总是在资源管理器中
*   客户端导航更尴尬 - 比使用资源管理器
*   更容易与旧版本进行比较
*   签入时输入注释时的拼写检查
*   一切都变得更快更容易！

显然，其中一些取决于 Vault 的配置方式，但你明白了。

我最终编写了一堆脚本来自动化 Vault 不能做的事情，但即便如此，命令行版本可以做的事情也有限制。此外，没有记录 Vault API。

**更新**
请注意最初发布的日期。自从我最初写这篇文章以来，这两个产品都发生了变化并得到了极大的增强。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-03-03T21:31:55.093

我在以前的工作中使用（和管理）Subversion 几年，而最近三年在我目前的工作中使用 Vault。在这一点上，我迫切希望摆脱 Vault 并回到 Subversion（或者可能是 git 或 Mercurial 之类的工具）。

我们在性能和可靠性方面遇到了很多问题（Vault 并不总是会提取已修改的文件，有时会坚持认为您没有修改过文件）但这可能归结为（长）我们存储库的历史以及我们过去如何处理分支。我会争辩说，如果它设计得更好，那么这些都不重要，但如果你没有用它做古怪的事情，那么也许你不会遇到我们遇到的问题。

也就是说，有一些我不能原谅的基本设计决策：

*   工作文件夹模型（类似于 VSS）过于严格；如果我想在本地多个地方签出相同的代码，我应该能够
*   合并工具爆炸
    *   每次我需要合并更改时，我都不需要经过七步向导
    *   无法挑选多个修订版进行合并
    *   在您提交更改之前，添加/删除的文件不会合并到您的工作文件夹中，这意味着您无法在签入之前验证一切是否正常
*   不等同于“svn switch”；将签出的文件夹切换到存储库中的新位置会使 Vault 吓坏

归根结底，Vault 的灵活性远不如 Subversion，尽管缺乏灵活性确实意味着它可以更简单地使用。如果您有一个习惯于 VSS 的开发人员团队，并且您不会需要太多的源代码控制工具，那么 Vault 可能是一个不错的选择。不过，在习惯了 Subversion 的灵活性之后，我发现使用 Vault 是一种令人沮丧的练习。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-08T12:15:58.777

我使用 Vault，所以我想更正您的功能列表中的一个错误：

> Vault 有一个 VS 插件，但它仅在您要在结帐模式下运行时才有效。

不正确 - 我不确定它是在哪个版本中添加的，但您可以在 Visual Studio 中的 Edit|Merge|Commit 模式下运行 vault

我还要补充一点，Vault 使用 MS SQL Server 作为它的存储库 - 使备份变得容易。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-08T12:11:06.133

Subversion 也有 VisualStudio 插件：

*   [http://www.visualsvn.com/](http://www.visualsvn.com/)
*   [http://ankhsvn.open.collab.net/](http://ankhsvn.open.collab.net/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-08T12:21:17.377

Source gear网站有一个[比较](http://www.sourcegear.com/vault/literature/Vault%20vs%20Subversion.pdf)。但是我不建议。如果您迁移到新的存储库，您希望查看分布式版本控制系统。

Monotone 、[Git](http://git.or.cz)和[Bazaar之类的](http://bazaar-vcs.org/)[软件](http://monotone.ca)在生产力方面确实提高了标准。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-08T12:13:22.167

Subversion 允许您将文件标记为“必须锁定”，在这种情况下，签出（锁定）、签入（自动解锁提交）有效。AnkhSVN 将这一点可视化，就像 VSS 签入签出一样。

颠覆有：

*   [TortoiseSVN](http://tortoisesvn.net) for Windows 资源管理器
*   [AnkhSVN](http://ankhsvn.net)，Visual Studio 的免费真实 SCC 提供程序。（尚未完成，但每天都在进步）
*   [VisualSVN](http://visualsvn.com) , TortoiseSVN 类似 Visual Studio 的集成（商业）
*   [SvnBook](http://svnbook.red-bean.co)，一个很棒的在线免费手册

Subversion 将在 1.6 或 1.7 中获得更高效的 HTTP 协议（​​正在进行中）。这可能使创建 IIS 插件成为可能。

请参阅[Subversion 中有关分支和合并的 subversion 书籍](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.html)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-08T12:13:01.997

Subversion 也有锁。不过，我从来不需要它们。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-03-18T08:26:25.893

Vault 内置而 Subversion 没有内置的一项功能是，可以将 Vault 配置为保留文件修改的时间戳。这是我真正可以从中受益的功能。作为一种解决方法，Subversion 确实允许配置将修改后的时间戳设置为提交时间，这对于我的大多数场景来说已经足够了。为了从中受益，我必须提交，然后删除我的工作副本，然后进行更新，以强制时间戳成为提交时间戳，以便我可以部署文件并使其时间戳与颠覆的时间戳相匹配。有人建议使用脚本或诸如此类的东西将修改后的时间戳存储在属性中，但我不知道是否有人成功地做到了这一点，如果是这样，我不知道这种解决方法有多可靠。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-08T12:00:40.040

> Subversion 有很多第三方支持。保险柜只有几样东西。

Subversion 肯定有 3rd 方支持，Vault 有 1st 方支持，因为你已经购买了它。根据我的经验，第一手信息（来自制造商）往往比分布在世界各地的 14 个论坛更好？虽然我们现在有 SO 所以这一点可能是静音的。:)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-04-16T14:07:42.507

有许多与 subversion 集成的工具（错误跟踪器、持续集成）。在保险库的情况下，没有多少工具支持它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-08T12:14:25.207

SVN 具有真正的分支[http://svnbook.red-bean.com/en/1.1/ch04.html](http://svnbook.red-bean.com/en/1.1/ch04.html)，分支的处理方式与大多数源代码控制系统不同。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-08T08:50:41.530

> 论坛很难拖网，但提供了许多线索，以充分利用人们所经历的所有试验和错误。

制造商的评论可能有偏见，并且不确定他们是否只是试图提供他们的解决方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-10-21T22:35:59.967

Vault 在与 Visual Studio 无缝实现方面做得很好。

对于其他一切，这很糟糕。

“WebDAV”支持慢得令人痛苦——太慢了，我发现使用 Vault Client 结帐然后切换回 Dreamweaver 比尝试通过 WebDAV 在 Dreamweaver 中结帐更快。

# c# - 如何从 C# 打印到 Bluebird BIP-1300 热敏打印机？

> ID：182306
> 
> 赞同：2
> 
> 时间：2008-10-08T11:44:18.683
> 
> 标签：c#, embedded, thermal-printer

我的应用程序在本地 CF 2.0 下运行，我想知道如何在 http://www.milliontech.com/home/content/view/195/95/'>Bluebird 的嵌入式打印机中连接和发送要打印的内容BIP-1300 设备。

理想情况下，我想要一个 C# 中的示例。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-23T12:35:51.133

在 c# 中使用 bbpdaapi.dll（通过 google 搜索）

```
using Bluebird.BIP.Printer;
...
this.prn1 = new Bluebird.BIP.Printer.Printer();
if (!this.prn1.Open(0))
            {
                MessageBox.Show("Can not open Printer", "Printer problem");
            }
this.prn1.PrintText("sdfgidfui", 0);
this.prn1.PrintBitmap(@"\My Documents\sample.bmp", 0);

if (this.prn1.WaitUntilPrintEnd() == 1)
{
MessageBox.Show("No paper in Printer", "Printer problem");
                }
            }
this.prn1.Close(); 
```

等等..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T11:52:56.950

我不熟悉这个特定的设备，但一般来说，这类打印机需要您发送 RAW 数据，因为它们没有 Windows 驱动程序。

[此知识库文章](http://support.microsoft.com/kb/322091)概述了如何使用 C# 将数据发送到设备：这对您是否有用取决于所使用的非托管 API 在您的 CF 应用程序运行的环境中是否可用。

如果支持 API，您接下来需要的是设备的正确转义码，以便获得所需的纸上结果。这些通常在打印机手册中有详细记录。

如果 Spooler API 不可用，或者您遇到其他问题，使这种方法比它的价值更麻烦，第三方[PrinterCE.NetCF SDK](http://www.fieldsoftware.com/PrinterCE_NetCF.htm)也可能值得研究。

# java - Java：Swing 库和线程安全

> ID：182316
> 
> 赞同：23
> 
> 时间：2008-10-08T11:47:26.900
> 
> 标签：java, multithreading, swing

我经常听到有人批评 Swing 库中缺乏线程安全性。然而，我不确定我在自己的代码中会做什么可能会导致问题：

Swing 不是线程安全的事实在什么情况下发挥作用？

我应该积极避免做什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-08T12:12:28.503

1.  永远不要为响应按钮、事件等而执行长时间运行的任务，因为它们位于事件线程上。如果您阻止事件线程，整个 GUI 将完全没有响应，从而导致用户非常生气。这就是为什么 Swing 看起来缓慢而硬朗的原因。

2.  使用线程、执行器和 SwingWorker 来运行不在 EDT 上的任务（事件调度线程）。

3.  不要在 EDT 之外更新或创建小部件。您可以在 EDT 之外执行的唯一调用是 Component.repaint()。使用 SwingUtilitis.invokeLater 确保某些代码在 EDT 上执行。

4.  使用[EDT 调试技术](http://weblogs.java.net/blog/alexfromsun/archive/2006/02/debugging_swing.html)和智能外观（如检查 EDT 违规的[Substance](https://substance.dev.java.net/)）

如果您遵循这些规则，Swing 可以制作一些非常吸引人且响应迅速的 GUI

一些非常棒的 Swing UI 工作示例：[Palantir Technologies](http://www.palantirtech.com/)。注意：我不为他们工作，只是一个很棒的挥杆的例子。可惜没有公开演示......他们的[博客](http://blog.palantirtech.com/)也很好，稀疏，但很好

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-08T21:28:46.197

这是让我很高兴我购买了[Robinson & Vorobiev 关于 Swing 的书的问题](http://www.manning.com/robinson2/)之一。

**任何访问 a 状态的东西`java.awt.Component`都应该在 EDT 中运行，除了三个例外：** 任何特别记录为线程安全的东西，例如`repaint()`、`revalidate()`和`invalidate()`; UI 中尚未*实现*的任何组件；`start()`以及在该 Applet被调用之前的 Applet 中的任何组件。

特制线程安全的方法非常少见，通常只需记住它们就足够了；您通常也可以假设没有这样的方法（例如，将重绘调用包装在 SwingWorker 中是完全安全的）。

*已实现*意味着该组件是一个顶级容器（如 JFrame），其中任何一个`setVisible(true)`、`show()`或`pack()`已被调用，或者它已被添加到已实现的组件中。这意味着在 main() 方法中构建你的 UI 是非常好的，就像许多教程示例所做的那样，因为它们不会调用`setVisible(true)`顶级容器，直到每个组件都被添加到它，字体和边框配置等等。

出于类似的原因，在它的`init()`方法中构建你的小程序 UI 是非常安全的，然后`start()`在它全部构建后调用。

在 Runnables 中包装后续组件更改以发送到`invokeLater()`，只需执行几次即可轻松完成。我觉得烦人的一件事是`someTextField.getText()`从另一个线程读取组件的状态（例如，）。从技术上讲，这也必须包含在 中`invokeLater()`；在实践中，它可以使代码很快变得丑陋，而且我通常不会打扰，或者我很小心地在初始事件处理时获取该信息（无论如何，在大多数情况下通常是正确的时间）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-08T13:09:43.100

不仅 Swing 不是线程安全的（不是很多），而且它是线程敌对的。如果您开始在单个线程（EDT 除外）上执行 Swing 工作，那么当 Swing 切换到 EDT（未记录）时，很可能会出现线程安全问题。即使是旨在实现线程安全的 Swing 文本也不是很有用的线程安全（例如，要附加到文档，您首先需要找到长度，该长度可能会在插入之前更改）。

因此，在 EDT 上执行所有 Swing 操作。请注意，EDT 不是调用 main 的线程，因此请启动您的（简单）Swing 应用程序，如下面的样板：

```
class MyApp {
    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() { public void run() {
            runEDT();
        }});
    }
    private static void runEDT() {
        assert java.awt.EventQueue.isDispatchThread();
        ... 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-21T14:52:45.847

使用类似物质的智能皮肤的另一种方法是创建以下实用方法：

```
public final static void checkOnEventDispatchThread() {
    if (!SwingUtilities.isEventDispatchThread()) {
        throw new RuntimeException("This method can only be run on the EDT");
    }
} 
```

在您编写的每个需要在事件调度线程上的方法中调用它。这样做的一个优点是可以非常快速地禁用和启用系统范围的检查，例如可能在生产中删除它。

请注意，智能皮肤当然可以提供额外的覆盖范围以及仅此而已。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-08T12:04:50.950

除了在事件分派线程上，积极避免做任何 Swing 工作。Swing 被编写为易于扩展，Sun 认为单线程模型对此更好。

在遵循上述建议时，我没有遇到任何问题。在某些情况下，您可以从其他线程“摇摆”，但我从未发现需要。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-08T13:45:52.637

如果您使用的是 Java 6，那么 SwingWorker 无疑是处理这个问题的最简单方法。

基本上，您要确保在 EventDispatchThread 上执行任何更改 UI 的操作。

这可以通过使用 SwingUtilities.isEventDispatchThread() 方法告诉您是否在其中找到（通常不是一个好主意 - 您应该知道哪个线程处于活动状态）。

如果您不在 EDT 上，则使用 SwingUtilities.invokeLater() 和 SwingUtilities.invokeAndWait() 在 EDT 上调用 Runnable。

如果你在 EDT 上更新 UI，你会得到一些非常奇怪的行为。就我个人而言，我不认为这是 Swing 的缺陷，通过不必同步所有线程来提供 UI 更新，您可以获得一些不错的效率 - 您只需要记住这个警告。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T02:25:36.033

“线程不安全”这句话听起来好像有一些本质上不好的东西（你知道......“安全” - 好；“不安全” - 坏）。现实情况是，线程安全是有代价的——线程安全对象的实现通常要复杂得多（尽管 Swing 已经足够复杂了。）

此外，使用锁定（慢）或比较和交换（复杂）策略来实现线程安全。鉴于 GUI 与人类的交互往往不可预测且难以同步，因此许多工具包决定通过单个事件泵来引导所有事件。这适用于 Windows、Swing、SWT、GTK 和其他可能的应用程序。实际上，我不知道一个真正线程安全的 GUI 工具包（这意味着您可以从任何线程操作其对象的内部状态）。

相反，通常做的是 GUI 提供了一种处理线程不安全的方法。正如其他人所指出的，Swing 总是提供有点简单的 SwingUtilities.invokeLater()。Java 6 包括出色的 SwingWorker（可从 Swinglabs.org 获得以前的版本）。还有像 Foxtrot 这样的第三方库，用于在 Swing 上下文中管理线程。

Swing 的臭名昭著是因为设计人员采取了轻率的做法，即假设开发人员会做正确的事情，不会拖延 EDT 或从 EDT 外部修改组件。他们已经大声而清晰地说明了他们的线程策略，开发人员可以遵循它。

让每个 swing API 为每个属性集、无效等向 EDT 发布作业是微不足道的，这将使其线程安全，但代价是大幅减速。您甚至可以使用 AOP 自己完成。作为比较，当从错误的线程访问组件时，SWT 会抛出异常。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T01:00:29.670

这是一个模式，可以让你轻松地挥动线程。

Sublass Action (MyAction) 并使其成为 doAction 线程。使构造函数采用字符串名称。

给它一个抽象的 actionImpl() 方法。

让它看起来像.. **（伪代码警告！）**

```
doAction(){
new Thread(){
   public void run(){
    //kick off thread to do actionImpl().
       actionImpl();
       MyAction.this.interrupt();
   }.start();  // use a worker pool if you care about garbage.
try {
sleep(300);
Go to a busy cursor
sleep(600);
Show a busy dialog(Name) // name comes in handy here
} catch( interrupted exception){
  show normal cursor
} 
```

您可以记录任务所花费的时间，下一次，您的对话框可以显示一个不错的估计。

如果你想变得非常好，也可以在另一个工作线程中睡觉。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-11T20:00:26.923

请注意，即使模型接口也不是线程安全的。使用单独的 get 方法查询大小和内容，因此无法同步它们。

从另一个线程更新模型的状态允许它至少绘制大小仍然更大（表格行仍然存在）但内容不再存在的情况。

始终在 EDT 中更新模型的状态可以避免这些。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-16T06:00:31.170

当您从不是 EDT 的任何线程与 GUI 组件进行任何交互时，确实必须使用 invokeLater() 和 invokeAndWait()。

它可能在开发过程中起作用，但像大多数并发错误一样，您会开始看到奇怪的异常出现，这些异常似乎完全不相关，并且是非确定性的——通常是在真实用户发布后发现的。不好。

此外，您不相信您的应用程序将继续在具有越来越多内核的未来 CPU 上运行 - 由于它们是真正并发的而不是仅由操作系统模拟，因此更容易遇到奇怪的线程问题。

是的，将每个方法调用都包装回 EDT 中的 Runnable 实例会变得很丑陋，但这对你来说就是 Java。在我们关闭之前，您只需要忍受它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-01T06:11:48.597

有关线程的更多详细信息，Allen Holub 的 Taming Java Threads 是一本较旧的书，但值得一读。

Holub，真正促进响应式 UI 和详细示例以及如何缓解问题。

[http://www.amazon.com/Taming-Java-Threads-Allen-Holub/dp/1893115100](https://rads.stackoverflow.com/amzn/click/com/1893115100) [http://www.holub.com/software/taming.java.threads.html](http://www.holub.com/software/taming.java.threads.html)

喜欢最后的“如果我是国王”部分。

# java - 如何正确序列化 Hibernate 集合？

> ID：182323
> 
> 赞同：2
> 
> 时间：2008-10-08T11:48:47.927
> 
> 标签：java, hibernate, serialization, collections

我正在尝试从使用 Hibernate 检索到的数据库中序列化对象，并且我只对对象的完整实际数据感兴趣（包括周期）。

现在我一直在使用[XStream](http://xstream.codehaus.org/)，这似乎很强大。XStream 的问题在于它在信息上看起来过于盲目。它可以识别 Hibernate 的 PersistentCollections，包括所有的 Hibernate 元数据。我不想序列化那些。

那么，是否有一种合理的方法可以从 PersistentCollection 中提取原始集合，并初始化对象可能指向的所有引用数据。或者你能推荐我一个更好的方法吗？

（[Simple](http://simple.sourceforge.net/)的结果看起来很完美，但它无法处理像 Calendar 这样的基本 util 类。它一次也只接受一个带注释的对象）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T14:06:30.940

我推荐一种更简单的方法：用户推土机：[http](http://dozer.sf.net) ://dozer.sf.net 。Dozer 是一个 bean 映射器，您可以使用它来将 PersonEJB 转换为同一类的对象。Dozer 将通过 getter() 调用递归地触发所有代理 fecthes，并且还将 src 类型转换为 dest 类型（比如说 java.sql.date 到 java.utilDate）。

这是一个片段：

```
MapperIF mapper = DozerBeanMapperSingletonWrapper.getInstance();
PersonEJB serializablePerson = mapper.map(myPersonInstance, PersonEJB.class); 
```

请记住，当推土机遍历您的对象树时，它将触发代理一一加载，因此如果您的对象图有许多代理，您将看到许多查询，这可能会很昂贵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-23T16:23:54.083

这里描述的解决方案对我来说效果很好：http: [//jira.codehaus.org/browse/XSTR-226](http://jira.codehaus.org/browse/XSTR-226)

这个想法是为休眠集合提供自定义 XStream 转换器/映射器，它将从休眠集合中提取实际集合并调用相应的标准转换器（用于 ArrayList、HashMap 等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T04:20:39.750

通常似乎是最好的方法，而我目前正在做的方法是拥有另一层 DTO 对象。通过这种方式，您可以排除不想通过通道的数据，并限制图形序列化的深度。我将 Dozer 用于从 Hibernate 对象到 Flex 客户端的当前 DTO（数据传输对象）。

它工作得很好，但有一些注意事项：

*   它并不快，实际上它非常慢。如果您发送大量数据，Dozer 的性能将不会很好。这主要是因为反射在执行其魔法时所涉及的。
*   在少数情况下，您必须为特殊行为编写自定义转换器。这些工作非常好，但它们是双向的。我个人不得不破解 Dozer 源以允许单向自定义转换器。

# unit-testing - 为什么功能测试还不够？单元测试提供什么？

> ID：182325
> 
> 赞同：12
> 
> 时间：2008-10-08T11:49:01.030
> 
> 标签：unit-testing, tdd, functional-testing

我刚刚与我的首席开发人员进行了交谈，他不同意单元测试是所有必要或重要的。在他看来，具有足够高代码覆盖率的功能测试就足够了，因为任何内部重构（接口更改等）都不会导致需要重写或重新检查测试。

我尝试解释但没有走得很远，并认为你们可以做得更好。;-） 所以...

对功能测试不提供的代码进行单元测试有什么好的理由？如果你只有功能测试，会有什么危险？

**编辑＃1**感谢所有出色的答案。我想补充一点，通过功能测试，我不仅仅指对整个产品的测试，还包括对产品内的模块的测试，而不是在必要时进行模拟的单元测试的低级别等。另请注意我们的功能测试是自动的，并且会持续运行，但它们只需要比单元测试更长的时间（这是单元测试的一大优势）。

我喜欢砖与房子的例子。我想我的首席开发人员说的是测试房子的墙壁就足够了，你不需要测试单个砖块...... :-)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-08T11:52:40.460

在我的头顶

*   单元测试可以毫不费力地重复。一次编写，运行数千次，无需人工，并且比从功能测试中获得的反馈快得多
*   单元测试测试小单元，因此立即指向发生错误的正确“扇区”。功能测试会指出错误，但它们可能是由大量模块引起的，即使是在协作时也是如此。
*   我几乎不会将接口更改称为“内部重构”。接口更改往往会破坏大量代码，并且（在我看来）强制一个新的测试循环而不是没有。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-08T12:02:11.423

单元测试供开发人员查看代码失败的地方

功能测试是让企业查看代码是否符合他们的要求

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-08T12:13:17.033

> 单元测试供开发人员查看代码失败的地方
> 
> 功能测试是让企业查看代码是否符合他们的要求

单元测试正在检查你是否正确地制造了你的积木

功能测试是检查房屋是否满足客户的需求。

它们是不同的东西，但如果前者已经执行，后者会容易得多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-08T11:53:29.460

如果功能测试失败，找到问题的根源可能会困难得多，因为您每次都在有效地测试整个代码库。相比之下，单元测试划分了潜在的问题区域。如果除此之外的所有其他单元测试都成功，*那么*您可以保证问题出在您正在测试的代码中，而不是其他地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T12:00:44.313

应在开发周期中尽快发现错误 - 将错误从设计转移到代码，或从代码转移到测试，或者（希望不会）从测试转移到生产会增加修复它所需的成本和时间。

我们的商店仅出于这个原因就强制执行单元测试（我确信还有其他原因，但这对我们来说已经足够了）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T12:19:17.647

如果您使用纯粹的极限编程/敏捷开发方法，则始终需要单元测试，因为它们是开发的要求。

在纯 XP/Agile 中，所有需求都基于将对应用程序执行的测试

*   功能测试 - 生成功能需求。
*   单元测试 - 生成功能或对象需求。

除此之外，单元测试可用于持续跟踪功能需求。

**即**如果您需要更改函数的工作方式但输入字段和输出保持不变。那么单元测试是跟踪可能出现的问题的最佳方式，因为您只需要运行测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-03T22:23:32.207

在[TDD/BDD](http://butunclebob.com/ArticleS.UncleBob.TheThreeRulesOfTdd)中，编写程序需要单元测试。过程进行

> 测试失败 -> 代码 -> 通过测试 -> 重构 -> 重复

链接的文章还提到了 TDD/BDD 的好处。总之：

*   非常接近于消除调试器的使用（我现在只在测试中使用它，而且很少用于那些）
*   代码不能保持混乱超过几分钟
*   内置 API 的文档示例
*   强制松散耦合

该链接还有一个 TDD/BDD 的（愚蠢的）演练示例，但它在 PowerPoint（ew）中，所以[这里](http://www.objectmentor.com/resources/articles/xpepisode.htm)是一个 html 版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-27T05:11:43.970

假设您**已经有一套**完整的功能测试来检查每个可用的可能用例，并且您正在考虑添加单元测试。由于功能测试将捕获所有可能的错误，因此单元测试将无助于捕获错误。然而，与单元测试、集成测试和功能测试的组合相比，仅使用功能测试有一些折衷。

*   单元测试运行得更快。如果您曾经参与过一个测试套件需要数小时才能运行的大型项目，您就会理解为什么快速测试很重要。
*   根据我的经验，实际上，功能测试更有可能是不稳定的。例如，有时无头 capybara-webkit 浏览器由于某种原因无法访问您的测试服务器，但您重新运行它并且它工作正常。
*   单元测试更容易调试。假设单元测试发现了一个错误，那么准确定位问题所在会更容易、更快捷。

另一方面，假设您决定只保留功能测试**而不**添加任何单元测试

*   如果您需要重新构建整个系统，您可能不需要重写任何测试。如果你有单元测试，其中很多可能会被删除或重写。
*   如果您需要重新构建整个系统，则不必担心回归。如果您依赖单元测试来覆盖极端情况，但您被迫删除或重写这些单元测试，那么您的新单元测试比旧单元测试更有可能出现错误。
*   Once you already have the functional test environment set up and you have gotten over the learning curve, writing additional functional tests is often easier to write and often easier to write correctly than a combination of unit tests, integration tests, and functional tests.

# documentation - 公司坚持对我们所有的文档使用二进制格式

> ID：182334
> 
> 赞同：14
> 
> 时间：2008-10-08T11:52:52.317
> 
> 标签：documentation

我在一家公司工作，出于某种原因，它坚持我们所有的开发文档都应该是 MS Word 格式。作为二进制格式，这意味着我们不能：

*   文档的不同版本（因此同行评审很痛苦——因为我们工作的领域，所有更改的同行评审都是必不可少的）
*   grep 一个包含关键字文档的文件夹

你用什么来写文档，为什么？

也请给我弹药来改变这种情况......

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-08T12:57:33.997

我最近开始使用 DocBook XML 来编写我的文档。

从好的方面来说，它是一种纯文本格式。您可以将一个大文档分成多个文件，并使用节点将它们全部组合成一本书。自动生成目录和索引。文档内链接（在任意文本中，指向章节或部分）非常容易。只需按一下按钮，我就可以创建一个单 html 文件版本、一个分块 html 版本（每章一个文件）和一个 PDF 版本。

经过一些调整和定制，我对输出非常满意。文件看起来*很棒*！

DocBook 被真正的出版商（最著名的是 O'Reilly）广泛使用，并且已经存在超过 15 年，因此它已经达到了一定的成熟度。

另一方面，所有的处理都是通过 XSLT 完成的，使用了一组特别的工具。（我自己的 docbook 管道包括 Python、Java、Xerces、Xalan、Apache FOP 和 PDF-SAM。加上官方 XSLT 样式表分发，以及我自己的 XSLT 定制。）

DocBook 不是一个交钥匙解决方案。如果不阅读手册，您将无法快速上手。如果您对 XSLT 一无所知，则必须学习。

另一方面，*编写*文档时真正需要知道的 XML 标记只有一打或两个。（真正的专业知识在从 XML 源生成文档时发挥作用。）如果您团队中的一个人愿意负责编写文档构建脚本，那么团队中的其他人都可以学习 DTD 并做得不错贡献。

无论如何... DocBook 肯定有一些缺点。这不是最简单的技术作者系统。但它是我所知道的最好的开源工具。

“Subversion Book”是用 DocBook 编写的。这是一个页面，其中包含指向不同书籍版本（single-html、chunked-html 和 PDF）的链接：

[http://svnbook.red-bean.com/](http://svnbook.red-bean.com/)

这是第一章 DocBook XML 源代码的链接，以便您了解它的工作原理：

[http://sourceforge.net/p/svnbook/source/HEAD/tree/branches/1.7/en/book/ch01-fundamental-concepts.xml](http://sourceforge.net/p/svnbook/source/HEAD/tree/branches/1.7/en/book/ch01-fundamental-concepts.xml)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-08T12:12:08.037

对于弹药，有值得信赖的老实用程序员，第 14 章：纯文本的力量。

> 作为务实的程序员，我们的基础材料不是木头或铁，而是知识。我们将需求收集为知识，然后在我们的设计、实现、测试和文档中表达这些知识。我们相信持久存储知识的最佳格式是 *纯文本*。有了纯文本，我们就可以使用几乎所有可用的工具手动和编程操作知识。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T11:56:59.313

出于您提到的两个原因，我们使用 wiki（特别是 Trac 提供的）。另外，如果我们真的需要，我们也可以获取标记的文本版本并在纯文本环境中操作它（例如，作为提交期间的 svn 注释的一部分）。

可以轻松简化为纯文本（非二进制）的格式绝对是必须的。对我们来说，能够将其*上转换*为像 PDF 这样的漂亮格式并不是很重要。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-08T11:57:47.393

Word 具有文档的更改跟踪功能（尽管它仅在您接受更改之前有效），您也可以对它们进行 grep（文本未加密）。所以我不确定你的任何一个论点都会受到审查。我很想给你弹药来改变这一点，但随着年龄的增长，我变得厌倦和愤世嫉俗。

我们将 MS Word 用于我们的文档（这比之前的选择（Lotus WordPro - 啊！）有很大的改进。）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-17T09:01:25.710

与 Dylan 的组织一样，我们也使用出色的[Confluence](http://www.atlassian.com/software/confluence/) wiki。我写了一篇关于为什么这是更好的方法的文章[Wiki is my word-processor](http://www.lunatech-research.com/archives/2006/12/04/wiki-my-word-processor)，它应该给你一些改变这种情况的理由。

将 wiki 用于*内部*文档的好处包括以下几点。

*   文字处理器用户会被吸引到更改布局和排版，无论您的模板多么好，这会浪费时间并降低一致性。
*   wiki 提供全文搜索，您不太可能对每个人编写的 MS Word 文档的正文进行搜索。
*   wiki 提供文档版本历史；我从未听说过一个团队成功地将所有修订保留在 Word 文档中，并且始终能够比较旧版本，或者使用版​​本控制系统（SharePoint 可能例外，但这是完全不同的失败场景）。
*   wiki 使文档之间的超链接变得容易；在 Word 文档集合中的文档之间可靠地链接太难了，因此新文档最终会将旧内容复制到新的整体文档中，这意味着它们需要更多时间来读写。
*   单独的wiki页面可以由不同的人同时编辑，Confluence可以在多人同时编辑同一个页面时合并更改；一次只有一个人可以编辑的 Word 文档更难协作。
*   像 Confluence 这样的 wiki 会根据 wiki 结构和标签自动生成导航页面；您需要图书管理员和大量的纪律才能浏览大量的 Word 文档。
*   wiki 页面通常比 Word 文档更快地加载和显示。
*   维基页面有更多的自动元数据；您需要模板和规范以确保 Word 文档始终在文档属性中设置标题、作者和版本，并且在屏幕上和打印中的文档中可见。

如果您想要比这更多的弹药，那么[Atlassian 博客](http://blogs.atlassian.com/news/wikis/)上有很多 wiki-promotion 。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-08T12:11:54.323

我们使用一个 wiki，特别是 Atlassian 的[Confluence](http://www.atlassian.com/software/confluence/)。

这是一个商业产品，它很棒。我们选择它而不是免费/开放的 wiki 引擎的原因之一是它具有成熟的所见即所得编辑器和各种其他功能，使熟悉 Word 的用户更容易访问它。

我们还想出了一个巧妙的技巧，在 Subversion 中存储图像、设计、线框等，然后通过 Apache/SVN Web 界面模块在 wiki 文档中嵌入指向这些资源 URL 的链接；如果您有兴趣，请在[此处](http://dylanbeattie.blogspot.com/2008/05/subversion-webdav-wiki-cool-fact.html)说明我们如何做到这一点。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-08T11:57:13.230

您可以要求文档采用 OOXML（`.docx`在 Word 的情况下为 ）格式。然而，在我看来，它不像使用 ODT 那样理想，它仍然只是一个包含一堆 XML 文件的 zip 文件。:-)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-08T12:22:57.890

文本格式有助于将您的文档与生成的项目（如 JavaDoc、API 参考或数据字典）合并。它的扩展性也比 word 好得多，word 很难用于大型文档。最后，允许包含的格式允许多个作者同时处理文档。

[LaTeX](http://www.latex-project.org/)和[FrameMaker](http://www.adobe.com/products/framemaker/)（我为此使用的两个系统）都具有非常出色的索引和交叉引用功能，并且具有可以包含的本机文本格式或本机格式的文本版本（在 Framemaker 的情况下为 MIF） . 它们也都比 word 稳定得多。

我已经构建了读取数据字典和生成文档的工具，这些文档可以包含在*具有稳定索引和双向交叉引用的更大文档中。*[该产品](http://www.roomsolutions.net/insurance-software/data-warehouse/acumen-advantage.aspx) 的功能规范是用 LaTeX 以这种方式完成的，并让我在公司获得了另一份工作。我还使用 FrameMaker 开发了类似的流程。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-08T11:57:26.410

是整个开发团队都反对这个要求，还是一个小团体？如果是整个团队，就忽略任务并使用基于文本的格式——这不是员工第一次忽略愚蠢的规则。如果您过去没有对此大惊小怪，则效果特别好。如果您*有*，管理层可能会特别努力地查看您的文档。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-08T11:58:46.703

MS Word 支持文档更改跟踪和同行评审。

新的 MS Office 格式完全基于 XML（要查看此内容，请将 MS Word .docx 文件重命名为 .zip，然后解压缩以查看）。

也许 Office 2007 可能既适合您的公司要求，也适合您的顾虑？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-08T12:01:56.200

您至少可以比较 Word 文档，查看“附加”菜单中的“跟踪更改”命令，或使用[DeltaView](http://www.workshare.com/products/wsdeltaview/)等软件。通过谷歌搜索[在 lifehacker.com 上的](http://lifehacker.com/software/microsoft-word/microsoft-word-tip--how-to-compare-two-documents-for-differences-247919.php)第一个链接找到。应该可以使用[Google 桌面搜索](http://desktop.google.com/gettingstarted.html)或其他类似的程序来搜索 word 文档，这些程序为他们能够阅读的所有文件编制索引。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-27T12:13:46.483

您不将文档文件存储在某种版本控制系统中，理想情况下与源代码一起存储吗？我建议这样做（可以轻松获取旧软件版本的文档）。

如果您确实将文档存储在 VCS 中，您会注意到纯文本或基于 XML 的文件对此要好得多，因为您可以获得差异；此外，文本文件之间的更改通常比二进制文件之间的更改更有效地存储。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-08T12:03:33.700

他们是坚持你用 Word*写*的还是只提供 Word 格式的？您可以以文本格式书写并自动将其转换为 Word。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-08T11:58:21.823

这里不是为 MS 产品辩护，但 MS word 可以区分文档。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-08T13:01:05.080

自动化 word 以将 word 文档中的所有文本提取到文本文件中应该很容易。因此，您可以编写一个脚本，从 word 文档创建文本文件，然后 grep、比较、版本控制、查看这些文本文件。

当然这不是一个理想的解决方案，因为你失去了漂亮的格式，但它应该可以工作。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-08T13:16:39.760

我认为有些程序可以将 Word 文档转换为纯文本。使用其中之一将单词 doc 转换为纯文本，然后使用 diff、grep 等

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-08T12:05:53.523

如果您使用[Beyond Compare](http://www.scootersoftware.com/)作为源代码控制系统的差异工具（正如我们使用 Perforce 所做的那样），它将显示您的 Word 文档版本之间的差异。诚然，它只显示文本差异 - 不显示格式更改 - 但这通常足以让您看到发生了什么变化。

这只是投资 Beyond Compare 的另一个原因，因为它是我用过的最精美的软件之一——而且它是我在软件上花费的最好的 30 美元（如果你买几个就少）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-08T12:09:48.680

word文档比较有很多工具。我目前使用一个 python 脚本，它在 word 的内置比较和合并功能上放置一个命令行。

[http://nicolas.lehuen.com/index.php/post/2005/06/30/60-comparing-microsoft-word-documents-stored-in-a-subversion-repository](http://nicolas.lehuen.com/index.php/post/2005/06/30/60-comparing-microsoft-word-documents-stored-in-a-subversion-repository)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-02-15T17:08:39.990

还可以查看[推荐](https://stackoverflow.com/questions/122752/what-is-the-recommended-toolchain-for-formatting-xml-docbook)的 DocBook 工具链。

# .net - 在 .NET 中查找子字符串匹配的结尾

> ID：182349
> 
> 赞同：7
> 
> 时间：2008-10-08T11:56:30.313
> 
> 标签：.net, unicode, string, culture

我正在尝试在与特定文化下的另一个字符串匹配的字符串中查找子字符串的索引（由 System.CultureInfo 提供）。

例如，字符串“ass”匹配德国文化下“straße”中的子字符串“aß”。

我可以使用找到比赛开始的索引

```
culture.CompareInfo.IndexOf(value, substring); 
```

但是在不诉诸蛮力的情况下，是否有一种简单的方法可以识别匹配 2 个字符而不是 3 个字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T12:02:13.890

如果您使用捕获组，您可以捕获找到的精确匹配项，并从中确定匹配的字符数。

我现在举个例子有点时间紧张，所以我希望你能从我的描述中弄清楚。

也许我稍后会修改我的答案。

戴夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T12:00:12.350

正则表达式是否处理 ss 与 ß 的区别？

# winapi - 故障转储中的模块版本

> ID：182365
> 
> 赞同：2
> 
> 时间：2008-10-08T11:59:55.533
> 
> 标签：winapi, crash-dumps, module-versions

当进程从调用 MiniDumpWriteDump 函数的进程生成的崩溃转储中崩溃时，有没有办法找出加载到进程地址空间中的模块版本？换句话说，是否有任何版本信息存储在 dmp 文件中？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T12:23:07.560

将您的 minidump 加载到 WinDbg 中，然后在 Debug 菜单中有一个 Modules 项，显示校验和和时间戳信息。对于您的目的，这可能是足够的信息。

您可以通过在 WinDBG 的命令窗口中键入“LM v”来从所有加载的模块中获取版本。该列表很长，您会得到很多，包括产品和文件版本字符串。但是，我认为它从它加载的本地存储模块中获取此信息，确保它从用于将它们与符号文件匹配的校验和信息中获得正确的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-19T10:03:27.973

将转储文件加载到 WinDbg 并键入以下命令：

```
lm v <name_of_module> // shows information about specified module 
```

`lm v`将向您显示有关所有模块的信息。

# c# - 使用 .net 检查事件日志中是否记录了事件的最简单方法是什么？

> ID：182372
> 
> 赞同：1
> 
> 时间：2008-10-08T12:01:07.230
> 
> 标签：c#, .net, testing, event-log

检查一段时间内事件日志中是否记录了事件的最简单方法是什么？

我想执行一系列自动化测试步骤，然后检查是否有任何错误记录到应用程序事件日志中，忽略一些我不感兴趣的来源。我可以使用 System.Diagnostics.EventLog 然后查看条目集合，但在这种情况下似乎不是很有用。例如，如果事件日志正在删除旧条目，Entries.Count 会随着时间的推移而变小。我更喜欢某种方式来查询日志或监视它在一段时间内的变化。例如

```
DateTime start = DateTime.Now;
// do some stuff...
foreach(EventLogEntry entry in CleverSolution.EventLogEntriesSince(start, "Application"))
{ 
  // Now I can do stuff with entry, or ignore if its Source is one
  // that I don't care about.
  // ...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T16:08:49.353

只是为了成为一名优秀的 Wiki 公民并努力完成，还有其他方法。我之前没有建议它，因为它对于仅作为测试套件的一部分在内部运行的东西来说完全是矫枉过正，而且你在标题中说你想要一些简单的东西。

但是，如果您需要查看运输代码中发生的事件，请继续阅读。信不信由你，目前这件事有*三种不同的 Windows API。*

## 通知更改事件日志（）

这类事情的原始 API 称为[NotifyChangeEventLog()](http://msdn.microsoft.com/en-us/library/aa363670(VS.85).aspx)，从 Windows 2000 开始就支持它。本质上，您使用[WIN32 事件日志 API](http://msdn.microsoft.com/en-us/library/aa363654(VS.85).aspx)打开事件日志，然后使用另一个给定的句柄调用此 API API 和事件句柄。当有新的事件日志条目可供查看时，Windows 将发出您的事件信号。

我自己从未使用过这个 API，因为我最感兴趣的是远程事件日志访问，而这个 API 明确不*支持*远程日志。但是，如果您拥有正确的权限，它所属的 API 集的其余部分*确实可以让您按顺序读取远程日志。*

## Windows 管理规范

第二种方法是使用[Windows Management Instrumentation API](http://msdn.microsoft.com/en-us/library/aa394582(VS.85).aspx)，它支持本地和远程日志。这是一个基于 COM/DCOM 的 API，在 Windows 中已经存在了好几年，.NET Framework 在[System.Management](http://msdn.microsoft.com/en-us/library/system.management.aspx)命名空间中有一个很好的实现。本质上，您所做的是创建一个[EventQuery来查找](http://msdn.microsoft.com/en-us/library/system.management.eventquery.aspx)[Win32_NTLogEvent](http://msdn.microsoft.com/en-us/library/aa394226(VS.85).aspx)类型（在 WMI 类型系统内）的新 WMI 对象的外观。这些的出现将指示新的事件日志条目，并且它们将几乎实时呈现。这些对象的属性包含日志条目的所有详细信息。有[一篇来自 MSDN 杂志的文章](http://msdn.microsoft.com/en-us/magazine/cc302051.aspx)谈论在 Visual Studio 中玩这些东西。

同样，这对于测试应用程序来说完全是多余的，它需要比现有解决方案更多的代码。但是几年前，我为一个网络管理应用程序编写了一个子系统，它使用这个 API 的 DCOM 风格来收集网络上所有服务器的事件日志，以便我们可以对特定的服务器发出警报。它几乎是实时的。如果您使用 DCOM 在 C++ 中实现此功能，请准备好处理多线程单元和大量复杂的逻辑来检测您与远程服务器的连接是否/何时启动或关闭。

## Windows Vista 事件日志

Windows Vista（和 Server 2008）有一个全新的与事件记录和跟踪相关的 API 套件。此处记录了[新的事件日志](http://msdn.microsoft.com/en-us/library/aa385780(VS.85).aspx)。看起来有一个名为 EvtSubscribe 的 API 允许您[订阅事件](http://msdn.microsoft.com/en-us/library/aa385771(VS.85).aspx)。我没有使用过这个 API，所以我不能评论它的优缺点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T16:53:38.293

话虽如此，这里的答案实际上应该非常简单，即使对于您的测试应用程序并且是特定于 .NET Framework 的。

您需要在开始测试之前打开 EventLog，并将事件处理程序订阅到[EventLog.EntryWritten](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.entrywritten.aspx)事件。这是 .NET 公开 NotifyChangeEventLog() Win32 API 的方式。

将您当前的逻辑从`GetEventLogEntriesSince()`事件处理程序中移出，但不要将事件添加到列表中以进行返回，而是将它们存储在一个列表中，您可以在运行结束时从某个地方检索它们。您可以通过其[Entry](http://msdn.microsoft.com/en-us/library/system.diagnostics.entrywritteneventargs.entry.aspx)属性从传递的 EntryWrittenEventArgs 参数中检索日志条目的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T12:56:52.203

[System.Diagnostics.EventLog](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)类确实是执行此操作的正确方法。

您的主要反对意见似乎是日志在某些情况下可以删除旧条目。但是您说这是在软件测试场景中。您不能安排配置您的测试系统，使日志足够大以包含所有条目，并且在您的测试期间不会删除旧条目？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T13:21:34.447

那么我提出的解决方案确实使用[System.Diagnostics.EventLog](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)并简单地迭代所有事件以过滤我想要的事件。我想这很简单，我只是认为会有一个更有效的界面。非常欢迎任何建议或改进！

我创建了一种方法来返回某个时间以来的事件日志条目：

```
/// <summary>
/// Steps through each of the entries in the specified event log and returns any that were written 
/// after the given point in time. 
/// </summary>
/// <param name="logName">The event log to inspect, eg "Application"</param>
/// <param name="writtenSince">The point in time to return entries from</param>
/// <param name="type">The type of entry to return, or null for all entry types</param>
/// <returns>A list of all entries of interest, which may be empty if there were none in the event log.</returns>
public List<EventLogEntry> GetEventLogEntriesSince(string logName, DateTime writtenSince, EventLogEntryType type)
{
    List<EventLogEntry> results = new List<EventLogEntry>();
    EventLog eventLog = new System.Diagnostics.EventLog(logName);
    foreach (EventLogEntry entry in eventLog.Entries)
    {
        if (entry.TimeWritten > writtenSince && (type==null || entry.EntryType == type))
            results.Add(entry);
    }
    return results;
} 
```

在我的测试类中，我存储了一个时间戳：

```
private DateTime whenLastEventLogEntryWritten; 
```

在测试设置期间，我将时间戳设置为写入最后一个事件日志条目的时间：

```
EventLog eventLog = new EventLog("Application");
whenLastEventLogEntryWritten = eventLog.Entries.Count > 0 ? 
     eventLog.Entries[eventLog.Entries.Count - 1] : DateTime.Now; 
```

在我的测试结束时，我检查没有事件日志错误：

```
Assert.IsEmpty(GetEventLogEntriesSince("Application",
                                       whenLastEventLogEntryWritten,  
                                       EventLogEntryType.Error), 
               "Application Event Log errors occurred during test execution."); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T17:02:30.617

我使用此 Powershell 在过去 7 天内扫描事件日志以查找相关条目：

```
$d=Get-Date
$recent=[System.Management.ManagementDateTimeConverter]::ToDMTFDateTime($d.AddDays(-7))

get-wmiobject -computer HOSTNAME -class Win32_NTLogEvent `
    -filter "logfile = 'Application' and (sourcename = 'SOURCENAME' or sourcename like 'OTHERSOURCENAME%') and (type = 'error' or type = 'warning') AND (TimeGenerated >='$recent')" | 
sort-object @{ expression = {$_.TimeWritten} } -descending |
select SourceName, Message | 
format-table @{Expression = { $_.SourceName};Width = 20;Label="SourceName"}, Message 
```

如果您使用 C#（已标记，但问题中未提及），那么神奇之处在于 get-wmiobject 查询。

# c# - 进行无闪烁动画 C# 自定义控件的最佳方法是什么？

> ID：182373
> 
> 赞同：4
> 
> 时间：2008-10-08T12:01:40.177
> 
> 标签：c#, animation, controls, doublebuffered

我目前正在创建一个需要在 C# 项目中处理动画的自定义控件。它基本上是一个列表框，其中包含固定数量的可以移动的元素。一个元素（另一个带有背景图像和几个生成标签的用户控件）可以向上、向下移动或从列表中取出。

我想创建动画运动，因为元素在容器自定义控件中四处移动，但在我看来，使用线条移动控件，例如

```
myCustomControl.left -= m_iSpeed;
```

在计时器事件中触发是闪烁的并且具有糟糕的渲染，即使打开了双缓冲也是如此。

那么问题来了：**实现无闪烁动画 C# 控件的最佳方法是什么？**我是否应该不创建自定义控件并处理我生成的面板背景图像中的所有绘图？有没有我没发现的超级动画方法？:)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T12:25:30.427

无闪烁动画的最佳选择是自己绘制（使用 Paint 事件处理程序中的 Graphics 对象）并使用双缓冲。在您的自定义控件中，您将需要在构造函数中使用如下代码：

```
this.SetStyle(ControlStyles.UserPaint | ControlStyles.OptimizedDoubleBuffer | 
    ControlStyles.AllPaintingInWmPaint | ControlStyles.SupportsTransparentBackColor,
    true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T12:23:14.177

今天上午就这个问题进行了类似的讨论。[visual c# 表单更新导致闪烁。](https://stackoverflow.com/questions/181374/visual-c-form-update-results-in-flickering)所以我会很懒惰并给出我在那里给出的相同答案：

您可以尝试调用**this.SuspendLayout();** 在你开始行动之前**this.ResumeLayout(false);** 当您完成移动所有控件时。通过这种方式，所有控件都应该立即绘制，并且您应该有更少的闪烁。

*在旁注中，我试图在工作中重现这一点，但似乎失败了。你能提供一些我可以修复的示例代码吗？*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T15:16:45.540

[请参阅如何在表单上加倍缓冲 .NET 控件。](https://stackoverflow.com/questions/76993/how-to-double-buffer-net-controls-on-a-form/77233#77233)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T12:25:29.130

获得无闪烁动画的正常方法是实现双缓冲。看看这篇代码项目文章

[http://www.codeproject.com/KB/GDI-plus/flickerFreeDrawing.aspx](http://www.codeproject.com/KB/GDI-plus/flickerFreeDrawing.aspx)

在你准备好之前尽量减少对绘画的调用也是一个好主意。

# sql - 数据库表中一列中的前两个字符大写

> ID：182379
> 
> 赞同：3
> 
> 时间：2008-10-08T12:03:23.093
> 
> 标签：sql, sql-server, tsql, language-agnostic

我在包含如下数据的数据库表（SQL Server 2005）中有一个列：

```
TQ7394
SZ910284
T r1534
su8472 
```

我想更新此列，以便前两个字符为大写。我还想删除前两个字符之间的任何空格。所以`T q1234`会变成`TQ1234`.

**该解决方案应该能够处理前两个字符之间的多个空格。**

这在 T-SQL 中可能吗？在 ANSI-92 中怎么样？我总是很想看看在其他数据库中是如何做到这一点的，所以请随时为 PostgreSQL、MySQL 等发布答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T12:27:45.710

这是一个解决方案：

**编辑：** **更新以支持在第一个和第二个非空格字符之间替换多个空格**

```
/* TEST TABLE */
DECLARE @T AS TABLE(code Varchar(20))
INSERT INTO @T SELECT 'ab1234x1'   UNION SELECT ' ab1234x2' 
         UNION SELECT '  ab1234x3' UNION SELECT 'a b1234x4' 
         UNION SELECT 'a  b1234x5' UNION SELECT 'a   b1234x6' 
         UNION SELECT 'ab 1234x7'  UNION SELECT 'ab  1234x8' 

SELECT * FROM @T
/* INPUT
    code
    --------------------
      ab1234x3
     ab1234x2
    a   b1234x6
    a  b1234x5
    a b1234x4
    ab  1234x8
    ab 1234x7
    ab1234x1
*/

/* START PROCESSING SECTION */
DECLARE @s Varchar(20)
DECLARE @firstChar INT
DECLARE @secondChar INT

UPDATE @T SET
     @firstChar = PATINDEX('%[^ ]%',code)
    ,@secondChar = @firstChar + PATINDEX('%[^ ]%',  STUFF(code,1, @firstChar,'' ) )
    ,@s = STUFF(
            code,
            1,
            @secondChar,
            REPLACE(LEFT(code,
                    @secondChar
                ),' ','')
        ) 
     ,@s = STUFF(
            @s, 
            1,
            2,
            UPPER(LEFT(@s,2))
        )
    ,code = @s
/* END PROCESSING SECTION */

SELECT * FROM @T
/* OUTPUT
    code
    --------------------
    AB1234x3
    AB1234x2
    AB1234x6
    AB1234x5
    AB1234x4
    AB  1234x8
    AB 1234x7
    AB1234x1
*/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T12:24:50.710

```
UPDATE YourTable 
SET YourColumn = UPPER(
                   SUBSTRING(
                     REPLACE(YourColumn, ' ', ''), 1, 2
                   )
                 ) 
                 + 
                 SUBSTRING(YourColumn, 3, LEN(YourColumn)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T12:37:55.893

`UPPER`不会损害任何数字，因此，如果您提供的示例完全具有代表性，那么这样做并没有任何害处：

```
UPDATE tbl
SET col = REPLACE(UPPER(col), ' ', '') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T13:02:17.560

示例数据的开头只有空格和小写字母。如果这适用于真实数据，那么只需：

```
UPPER(REPLACE(YourColumn, ' ', '')) 
```

对于更具体的答案，我会礼貌地要求您扩展您的规范，否则我将不得不围绕所有其他可能性（例如小于三个字符的值）进行编码，而不知道我是否过度设计了我的解决方案来处理数据实际上不会出现在现实中:)

与以往一样，一旦您修复了数据，请放入数据库约束以确保错误数据不会再次出现，例如

```
 ALTER TABLE YourTable ADD
     CONSTRAINT YourColumn__char_pos_1_uppercase_letter
        CHECK (ASCII(SUBSTRING(YourColumn, 1, 1)) BETWEEN ASCII('A') AND ASCII('Z'));

  ALTER TABLE YourTable ADD
     CONSTRAINT YourColumn__char_pos_2_uppercase_letter
        CHECK (ASCII(SUBSTRING(YourColumn, 2, 1)) BETWEEN ASCII('A') AND ASCII('Z')); 
```

@huo73：你的在 SQL Server 2008 上对我不起作用：我得到的是 'TRr1534' 而不是 'TR1534'。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T12:18:07.087

```
update Table set Column = case when len(rtrim(substring (Column , 1 , 2))) < 2 
            then UPPER(substring (Column , 1 , 1) + substring (Column , 3 , 1)) + substring(Column , 4, len(Column)
            else UPPER(substring (Column , 1 , 2)) + substring(Column , 3, len(Column) end 
```

这适用于这样一个事实，即如果有空格，则字符串的该部分的修剪将产生小于 2 的长度，因此我们将字符串分成三部分，并在第一个和第三个字符上使用大写。在所有其他情况下，我们可以将字符串分成两部分并使用 upper 将前两个字符变为大写。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T12:18:44.217

如果您要进行更新，我会分两步进行；首先摆脱空间（SUBSTRING 上的 RTRIM），然后在前 2 个字符上执行 UPPER：

```
// uses a fixed column length - 20-odd in this case
UPDATE FOO
SET bar = RTRIM(SUBSTRING(bar, 1, 2)) + SUBSTRING(bar, 3, 20)

UPDATE FOO
SET bar = UPPER(SUBSTRING(bar, 1, 2)) + SUBSTRING(bar, 3, 20) 
```

如果您在 SELECT 中需要它（即内联），那么我很想编写一个标量 UDF

# programming-languages - 游戏项目开发

> ID：182389
> 
> 赞同：5
> 
> 时间：2008-10-08T12:04:50.687
> 
> 标签：programming-languages

我想开发一个包含 3D 世界的游戏，其中简单的 3D 形状相互交互，其中涉及“真实”的物理。

我没有视频游戏编程的经验，我愿意学习，所以我想问一下你会使用哪种编程语言和/或库来制作一个由相互交互的 3D 形状组成的游戏，并且像物理一样“真实” ?

我知道这个问题有多个答案，但我想了解目前最常用的技术是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T12:07:43.940

看看[子弹](http://code.google.com/p/bullet/)：

Bullet 3D 游戏多物理库提供最先进的碰撞检测、软体和刚体动力学。

*   许多游戏公司在 Playstation 3、XBox 360、Nintendo Wii 和 PC 上的 AAA 游戏中使用
*   模块化可扩展 C++ 设计，可热插拔大多数组件
*   为 Playstation 3 Cell SPU 和其他平台提供多线程支持的优化后端
*   离散和连续碰撞检测 (CCD)
*   扫描碰撞查询
*   带有自定义碰撞过滤的光线投射
*   通用凸支持（使用 GJK）、胶囊、圆柱、圆锥、球、盒子和非凸三角形网格。
*   刚体动力学，包括约束求解器、通用约束、布娃娃、铰链、球窝
*   支持约束限制和电机
*   柔软的身体支撑，包括布料、绳索和可变形
*   Bullet 已集成到 Blender 3D 中并提供 Maya 插件
*   支持导入和导出为 COLLADA 1.4 物理格式
*   通过改装加速结构，支持非凸三角形网格的动态变形

该库在 ZLib 许可下可免费用于商业用途和开源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-08T12:09:04.280

您应该查看 SDL 库 ( [http://www.libsdl.org](http://www.libsdl.org) )，因为它支持多个平台并具有多种编程语言的绑定。它还支持 OpenGL。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T12:09:09.447

用 C# 编写的 XNA 游戏工作室。它比 C++ 和 DirectX/OpenGL 更容易（主观）学习。 [http://creators.xna.com/](http://creators.xna.com/)

这里有另一个关于它的线程。当我找到它时会链接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T12:07:52.070

我建议您从使用 Flash 开始。这是一个创建简单游戏的好环境，但当您希望获得更多花哨时，它有很好的 3D 和物理引擎可用（例如[Papervision3D](http://blog.papervision3d.org/)和[Fisix ）。](http://www.fisixengine.com)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T12:16:23.003

仅供参考，有一个非常有趣的开源 BSD 许可项目，名为[OpenSim](http://opensimulator.org) ，它包括在C# 和 Mono中重新创建服务器端[SecondLife基础设施。](http://www.secondlife.com)

它似乎与您的朋友和您想做的事情相对应。虽然仍处于 Alpha 阶段，但它相当稳定，绝对值得一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T12:30:01.120

简单而强大的东西（至少根据我的口味:)）是**[Apocalyx](http://apocalyx.sourceforge.net/)**。

完全开源，大量demo，大量教程，可直接处理多种常用格式（如MD2、Cal3D或BSP），让您可以使用高级工具来创建自己的世界。

用 C++ 编写，可在 Lua 中编写脚本（有专门的脚本编辑器）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T13:10:22.847

在 C++ 中，我使用过[SDL](http://libsdl.org)和[GLFW](http://glfw.sourceforge.net/)；在 Python 中，我使用了[PyGame](http://www.pygame.org/)和[Pyglet](http://www.pyglet.org/)。

就语言而言，如果您使用 C++，那么我肯定会建议您考虑使用[Squirrel](http://www.squirrel-lang.org/)、Lua 或 Python 之类的东西来编写脚本，尽管用 Python 之类的东西编写整个游戏也很好（并且性能应该开始成为一个问题稍后，您可以只编写在 C++ 中导致问题的模块 - 当然是在分析之后）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-08T12:07:17.000

我使用 David Brackeen 的“Developing Games in Java”一书为 Windows 开发了几个 Java 平台游戏。它确实涵盖了 3D 的东西，但我还没有到那一步。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-08T12:07:27.593

我建议研究微软的 XNA 框架。这将涵盖它的“游戏”方面。至于物理，我建议看看子弹引擎，虽然有很多可供选择。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-08T12:09:02.143

用于性能的 C/C++ 和用于脚本的[Lua 。](http://en.wikipedia.org/wiki/Lua_(programming_language))

**Lua 简介** [http://www.gamedev.net/reference/programming/features/lua/](http://www.gamedev.net/reference/programming/features/lua/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-08T12:09:12.580

Blitz 非常擅长快速启动和运行。

[http://www.blitzbasic.com/](http://www.blitzbasic.com/)

Blitz3D 支持 3d 卡片等等。 [http://shareit1.element5.com/product.html?productid=147747](http://shareit1.element5.com/product.html?productid=147747)

它也足够强大，可以让“真实”游戏由它驱动

例如 [http://www.zee-3.com/nakedwar/index.php](http://www.zee-3.com/nakedwar/index.php)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-08T12:11:19.160

SDL 是事实上的游戏起点，无论如何在某些平台上也是如此。它会让你快速启动并运行（它可以在 linux 上运行）。

在那里，您可以在 sourceforge 中搜索一些：例如，PLIB、Ogre、CrystalSpace。他们都很好，虽然我不知道他们在过去几年里进展如何。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-08T12:12:24.727

如果您想运行具有良好物理性能的纯实时 3D，我建议使用 C++ 与例如 OpenGL。

我建议您在[http://nehe.gamedev.net/](http://nehe.gamedev.net/)下查看有关 OpenGL 的教程。[您还可以在http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=30](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=30)找到碰撞检测系统的示例

如果您实际上不擅长实时的东西，您可能可以使用 C++ 并使用“更简单”的编码语言。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-08T12:13:23.260

有[很多引擎](http://en.wikipedia.org/wiki/List_of_game_engines)可供您使用。您需要开始研究哪一个适合您的游戏设计。

大多数商业游戏都是用 C++ 编写的，并带有一些其他语言来完全绑定它。其他语言提供不同的特性，例如 Java 对移动电话的可移植性。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-08T12:20:08.550

如果您完全没有编程经验并且希望获得真正快速的视觉效果，那么您应该查看诸如 DarkBasic 或 Blitz3D 之类的语言。

也就是说，这些语言有相当大的限制，如果你也在考虑学习编程，你可能会想要使用 Java 或 C# 的不同用户创建的 API，例如 JOpenGl、Jogre、XNA、SDL.Net 或 Irrlicht.Net . 它们将允许您在创建游戏时学习对象编程的基础知识。

以下是不同的链接：

[DarkBasic 主页](http://darkbasic.thegamecreators.com/)

[闪电战3d](http://www.blitzbasic.com/)

爪哇：

[JopenGL](https://jogl.dev.java.net/)

[乔格雷](http://jogre.sourceforge.net/)

C＃ ：

[XNA](http://creators.xna.com/)

[SDL.net](http://cs-sdl.sourceforge.net/)

[Irrlicht.net](http://irrlichtnetcp.sourceforge.net/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-20T11:54:49.003

如果您熟悉 Delphi，请尝试使用 GlScene。

# java - XML 配置与基于注释的配置

> ID：182393
> 
> 赞同：134
> 
> 时间：2008-10-08T12:06:00.247
> 
> 标签：java, xml, spring, annotations

在我最近从事的一些大型项目中，选择其中一个（XML 或 Annotation）似乎变得越来越重要。随着项目的增长，一致性对于可维护性非常重要。

我的问题是：基于 XML 的配置相对于基于注解的配置有哪些优势，基于注解的配置相对于基于 XML 的配置有哪些优势？

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2008-10-08T15:31:53.513

注释有其用途，但它们并不是杀死 XML 配置的唯一灵丹妙药。我建议将两者混合使用！

例如，如果使用 Spring，将 XML 用于应用程序的依赖注入部分是完全直观的。这使代码的依赖关系远离将要使用它的代码，相比之下，在需要依赖关系的代码中使用某种注释使代码知道这种自动配置。

但是，与其使用 XML 进行事务管理，不如使用注释将方法标记为事务性是非常有意义的，因为这是程序员可能希望知道的信息。但是一个接口将被注入为 SubtypeY 而不是 SubtypeX 不应该包含在类中，因为如果现在你想注入 SubtypeX，你必须改变你的代码，而你之前有一个接口契约，所以使用 XML，您只需要更改 XML 映射，并且这样做相当快速且轻松。

我没有使用 JPA 注释，所以我不知道它们有多好，但我认为将 bean 映射到 XML 中的数据库也很好，因为对象不应该关心它的信息来自哪里，它应该只关心它可以用它的信息做什么。但是，如果您喜欢 JPA（我对它没有任何经验），那就去吧。

一般来说：如果注释提供功能并作为注释本身，并且不将代码绑定到某些特定过程以便在没有此注释的情况下正常运行，那么请使用注释。例如，标记为事务性的事务性方法不会杀死其操作逻辑，并且还可以用作良好的代码级注释。否则，此信息可能最好用 XML 表示，因为尽管它最终会影响代码的运行方式，但不会改变代码的主要功能，因此不属于源文件。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-06-12T13:59:56.970

这里有一个更广泛的问题，即外部化元数据与内联元数据。如果您的对象模型只会以一种方式持久化，那么内联元数据（即注释）会更加紧凑和可读。

但是，如果您的对象模型在不同的应用程序中以这样一种方式重用，每个应用程序都希望以不同的方式持久化模型，那么将元数据（即 XML 描述符）外部化就变得更合适了。

两者都不是更好，因此两者都受支持，尽管注释更时尚。因此，像 JPA 这样的新框架往往会更加强调它们。更成熟的 API，如原生 Hibernate，两者都提供，因为众所周知，这两者都不够。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-08T13:14:46.723

*我*总是将注释视为某种指示类的能力，或者它*如何*与其他类交互的指标。

另一方面，Spring XML 配置对我来说就是这样，*配置*

例如，关于代理的 ip 和端口的信息，肯定会进入 XML 文件，它是运行时配置。

使用`@Autowire`,`@Element`来指示框架如何处理类是很好地使用注释。

将 URL 放入`@Webservice`注释中是不好的风格。

但这只是我的看法。交互和配置之间的界限并不总是很清楚。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-02T05:09:42.533

我已经使用 Spring 几年了，所需的 XML 数量肯定变得乏味。在 Spring 2.5 中新的 XML 模式和注释支持之间，我通常会做这些事情：

1.  使用“组件扫描”来自动加载使用@Repository、@Service 或@Component 的类。我通常给每个 bean 命名，然后使用 @Resource 将它们连接在一起。我发现这个管道不会经常改变，所以注释是有意义的。

2.  对所有 AOP 使用“aop”命名空间。这真的很棒。我仍然将它用于交易，因为将@Transactional 放在所有地方有点拖累。您可以为任何服务或存储库上的方法创建命名切入点，并非常快速地应用建议。

3.  我使用 LocalContainerEntityManagerFactoryBean 和 HibernateJpaVendorAdapter 来配置 Hibernate。这让 Hibernate 可以轻松地自动发现类路径上的 @Entity 类。然后我使用引用 LCEMFB 的“factory-bean”和“factory-method”创建一个命名的 SessionFactory bean。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-17T13:13:19.270

使用仅注释方法的一个重要部分是“bean 名称”的概念或多或少地消失了（变得微不足道）。

Spring 中的“bean 名称”在实现类之上形成了一个额外的抽象级别。使用 XML bean 是相对于它们的 bean 名称定义和引用的。使用注释，它们被它们的类/接口引用。（虽然bean名称存在，但不需要知道）

我坚信摆脱多余的抽象可以简化系统并提高生产力。对于*大型*项目，我认为摆脱 XML 的好处是巨大的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-08T12:34:27.693

这取决于您要配置的所有内容，因为有些选项无法使用注释进行配置。如果我们从注解的角度来看：

*   加：注释不那么啰嗦
*   减号：注释不太明显

由你决定什么更重要......

一般来说，我会建议选择一种方式并在产品的某些封闭部分使用它......

（有一些例外：例如，如果您选择基于 XML 的配置，则可以使用 @Autowire 注释。它是混合的，但这有助于可读性和可维护性）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-12T13:48:08.043

我认为可见性是基于 XML 的方法的一大胜利。我发现 XML 并没有那么糟糕，考虑到用于导航 XML 文档的各种工具（即 Visual Studio + ReSharper 的文件结构窗口）。

您当然可以采用混合方法，但这对我来说似乎很危险，因为这可能会使项目的新开发人员难以弄清楚不同对象的配置或映射位置。

我不知道; 最后，XML Hell 对我来说似乎并没有那么糟糕。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-07-10T07:50:55.617

还有其他方面可以比较，例如重构和其他代码更改。使用 XML 时，重构需要付出很大的努力，因为您必须处理所有 XML 内容。但是使用注释时很容易。

我首选的方式是基于 Java 的配置，没有（或最少）注释。[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-java](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-java)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-08T12:09:08.337

我可能错了，但我认为注释（如 Java 的 @Tag 和 C# 的 [Attribute] 中）是编译时选项，而 XML 是运行时选项。这对我来说是不等同的，并且有不同的优点和缺点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-08T16:12:02.280

我也认为混合是最好的，但这也取决于配置参数的类型。我正在开发一个也使用 Spring 的 Seam 项目，我通常将它部署到不同的开发和测试服务器。所以我分裂了：

*   服务器特定配置（如服务器上资源的绝对路径）：Spring XML 文件
*   将 bean 作为其他 bean 的成员注入（或在许多 bean 中重用 Spring XML 定义的值）：注解

关键区别在于您不必为所有更改的服务器特定配置重新编译代码，只需编辑 xml 文件。还有一个好处是，一些配置更改可以由不了解所有相关代码的团队成员完成。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-04-03T05:58:05.410

在 DI 容器的范围内，我认为基于注解的 DI 滥用了 Java 注解的使用。话虽如此，我不建议在您的项目中广泛使用它。如果您的项目确实需要 DI 容器的强大功能，我建议您使用 Spring IoC 和基于 Xml 的配置选项。

如果只是为了单元测试，开发人员应该在他们的编码中应用依赖注入模式，并利用 EasyMock 或 JMock 等模拟工具来规避依赖关系。

您应该尽量避免在错误的上下文中使用 DI 容器。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-03-05T08:43:40.630

始终链接到特定 Java 组件（类、方法或字段）的配置信息是由注释表示的良好候选者。当配置是代码目的的核心时，注释在这种情况下尤其有效。由于注释的限制，最好每个组件只能有一个配置。如果您需要处理多个配置，尤其是那些以包含注释的 Java 类之外的任何内容为条件的配置，则注释可能会产生比它们解决的问题更多的问题。最后，注解不能在不重新编译 Java 源代码的情况下进行修改，因此任何需要在运行时重新配置的东西都不能使用注解。

请参考以下链接。它们也可能有用。

1.  [注释 vs XML，优点和缺点](https://stackoverflow.com/questions/17086421/annotations-vs-xml-advantages-and-disadvantages)
2.  [http://www.ibm.com/developerworks/library/j-cwt08025/](http://www.ibm.com/developerworks/library/j-cwt08025/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-08T12:20:40.873

这是经典的“配置与约定”问题。在大多数情况下，个人品味决定了答案。但是，我个人更喜欢 Configuration（即基于 XML）而不是 Convention。IMO IDE 足够强大，足以克服人们经常与构建和维护基于 XML 的方法相关联的一些 XML 地狱。最后，我发现配置的好处（例如构建实用程序来构建、维护和部署 XML 配置文件）从长远来看胜过约定。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-05T16:38:21.020

我两个都用。主要是 XML，但是当我有一堆从公共类继承并具有公共属性的 bean 时，我在超类中为它们使用注释，因此我不必为每个 bean 设置相同的属性。因为我有点控制狂，我使用 @Resource(name="referredBean") 而不仅仅是自动装配的东西（如果我需要另一个与原始引用Bean 相同类的 bean，可以为自己省去很多麻烦） .

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-01-20T09:20:12.113

根据我的经验，注释配置有一些优点和缺点：

*   当涉及到 JPA 配置时，因为它只完成一次并且通常不会经常更改，所以我更喜欢坚持注释配置。可能会担心看到更大的配置图——在这种情况下，我使用 MSQLWorkbench 图表。
*   XML 配置非常适合获得更大的应用程序图，但在运行之前发现一些错误可能很麻烦。在这种情况下，Spring *@Configuration*注解听起来是一个更好的选择，因为它也可以让您看到更大的图景，并且还允许在编译时验证配置。
*   至于 Spring 配置，我更喜欢将这两种方法结合起来：将*@Configuration*注释与 Services 和 Query 接口和 xml 配置用于 dataSource 和 spring 配置内容，例如 context:component-scan base-package="..."
*   但是当涉及到流配置（Spring Web Flow 或 Lexaden Web Flow）时，xml 配置位 java 注释，因为看到整个业务流程的更大图景非常重要。使用注释方法实现它听起来很麻烦。

我更喜欢将这两种方法结合起来——Java 注释和基本的 xml 最小值，可以最大限度地减少配置地狱。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-03-27T16:01:35.833

对于 Spring 框架，我喜欢能够使用 @Component 注释并设置“组件扫描”选项的想法，以便 Spring 可以找到我的 java bean，这样我就不必在 XML 中定义我的所有 bean，也不必在Java配置。例如，对于只需要连接到其他类（理想情况下通过接口）的无状态单例 Java bean，这种方法非常有效。一般来说，对于 Spring bean，我大部分时间都从用于定义 bean 的 Spring XML DSL 中移出，现在更倾向于使用 JavaConfig 和 Spring Annotations，因为您可以获得一些编译时检查您的配置和一些您没有的重构支持'无法使用 Spring XML 配置。在我发现 JavaConfig/Annotations 无法完成使用 XML 配置可用的功能的某些极少数情况下，我确实将两者混合使用。

对于 Hibernate ORM（还没有使用过 JPA），我仍然更喜欢 XML 映射文件，因为域模型类中的注释在某种程度上违反了我过去几年采用的分层架构风格[的 Clean Architecture 。](http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html)发生违规是因为它要求核心层依赖于持久性相关的东西，例如 Hibernate 或 JPA 库，并且它使域模型 POJO 对持久性的无知程度降低了一些。事实上，核心层根本不应该依赖任何其他基础设施。

但是，如果 The Clean Architecture 不是您的“一杯茶”，那么我可以看到在域模型类中使用 Hibernate/JPA 注释肯定比单独的 XML 映射文件具有优势（例如方便性和可维护性）。

# c++ - 从 Linux 到 Windows 交叉编译 C++ 应用程序的手册？

> ID：182408
> 
> 赞同：40
> 
> 时间：2008-10-08T12:09:44.607
> 
> 标签：c++, windows, linux, cross-compiling

是否有将 C++ 应用程序从 Linux 交叉编译到 Windows 的手册？

只是。我想要一些信息（链接、参考、示例...）来指导我这样做。

我什至不知道这是否可能。

我的目标是在 Linux 中编译一个程序并获得一个可以在 Windows 下运行的 .exe 文件。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-08T12:21:42.073

基础并不难：

```
sudo apt-get install mingw32    
cat > main.c <<EOF
int main()
{
  printf("Hello, World!");
}
EOF
i586-mingw32msvc-cc main.c -o hello.exe 
```

替换`apt-get`为`yum`，或您的 Linux 发行版使用的任何内容。这将为 Windows 生成一个`hello.exe`。

一旦你明白了这一点，你可以使用[autotools](http://sources.redhat.com/autobook/autobook/autobook_268.html#SEC268)，并设置`CC=i586-mingw32msvc-cc`

```
CC=i586-mingw32msvc-cc ./configure && make 
```

或者使用[CMake 和工具链文件](http://www.cmake.org/Wiki/CMake_Cross_Compiling)来管理构建。更困难的仍然是添加本地交叉库。通常它们存储在`/usr/cross/i586-mingw32msvc/{include,lib}`其中，您需要在构建过程的配置步骤中单独添加这些路径。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-08T12:25:02.330

这取决于你的意思（我真的不能说）。

1.  如果您的意思是要在 Windows 上使用现有的 Linux 应用程序，那么您可以尝试在 Windows 上使用[Cygwin](http://en.wikipedia.org/wiki/Cygwin)编译它。然而，这并没有为您提供一个没有对 Cygwin 的所有依赖项的 Windows 可执行文件（您的可执行文件仍然依赖于该`cygwin.dll`文件） - 它仍然可能需要一些移植才能工作。请参阅[http://www.cygwin.com](http://www.cygwin.com)。

2.  如果您的意思是您希望能够在 Linux 上执行 Windows 应用程序的实际编译并生成在 Windows 上可执行的 .exe 文件 - 从而使用您的 Linux 机器进行开发和/或编译，那么您应该查看[MinGW](http://en.wikipedia.org/wiki/MinGW) Linux 是一个用于在 Linux 上为 Windows 进行交叉编译的工具。请参阅[http://www.mingw.org/wiki/LinuxCrossMinGW](http://www.mingw.org/wiki/LinuxCrossMinGW)。

最好的祝福！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-25T23:15:43.130

我建议您尝试一下[GUB](http://lilypond.org/gub/)（Grand Unified Builder），因为它交叉编译了几个包及其依赖项，并将它们组装成一个适用于当前 11 种架构的安装包。您可以从此处下载预构建的 iso 以安装在 VM 中，并[在](http://github.com/janneke/gub)[此处](http://lilypond.org/doc/v2.13/Documentation/contributor/using-a-virtual-machine-to-compile-lilypond)关注源代码。它目前可用于交叉编译 GNU LilyPond/GNU Denemo/Inkscape 和 OpenOffice.org。

目标架构是：

*   darwin-ppc - Darwin 7 (MacOS 10.3)/PowerPC 的 tar.bz2 文件
*   darwin-x86 - Darwin 8 (MacOS 10.4)/x86 的 tar.bz2 文件
*   mingw - Windows32 的 mingw 可执行文件
*   linux-x86 - Linux/x86 的 shar 存档
*   linux-64 - Linux/x86_64 的 shar 存档
*   linux-ppc - Linux/PowerPC 的 shar 存档
*   freebsd-x86 - FreeBSD 4/x86 的 shar 存档
*   freebsd-64 - FreeBSD 6/x86_64 的 shar 存档
*   cygwin - 用于 Cygwin/Windows32 的 .tar.bz2 包
*   arm - Linux/ARM 的 shar 存档（大部分未经测试）
*   debian - Debian 的 shar 存档（大部分未经测试）

# javascript - 如何在 JavaScript 中对数组元素进行 JSON 解码？

> ID：182410
> 
> 赞同：24
> 
> 时间：2008-10-08T12:10:04.577
> 
> 标签：javascript, json

我有一个 JavaScript 数组，其中包含一个 URL。如果我尝试简单地将 URL 放在页面中（该数组位于涉及 Yahoo! Maps API 的项目中），它会显示应有的 URL。

但是，如果我尝试执行重定向或只是对链接数组元素执行“警报”，我会得到：

> function(){返回 JSON.encode(this);}

据我所知，这是因为浏览器在呈现页面时执行了 JSON.encode，因此链接显示正常。我尝试了几种方法使其正确重定向（这就是我想要对链接执行的操作）（包括使用“eval”），但没有运气。

在遵循一些建议后，我运行了`eval('(' + jsonObject + ')')`，但它仍然返回相同的输出。

那么这是怎么做到的呢？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2011-06-30T21:47:04.913

```
var obj = jQuery.parseJSON('{"name":"John"}');
alert( obj.name === "John" ); 
```

[请参阅 jQuery API](http://api.jquery.com/jQuery.parseJSON/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-03-15T07:38:07.797

假设您在 PHP 中有一个包含 5 个字段的 $iniData 数组。如果使用 ajax -

```
echo json_encode($iniData); 
```

在 Javascript 中，使用以下内容：

```
<script type="text/javascript">
    $(document).ready(function(){
        $.ajax({
            type: "GET",
            url: "ajaxCalls.php",
            data: "dataType=ini",
            success: function(msg)
            {
                var x = eval('(' + msg + ')');
                $('#allowed').html(x.allowed);              // these are the fields which you can now easily access..
                $('#completed').html(x.completed);
                $('#running').html(x.running);
                $('#expired').html(x.expired);
                $('#balance').html(x.balance);
            }
        });
    });
</script> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T15:20:22.600

如果您在警报中收到此文本：

```
function(){return JSON.encode(this);} 
```

当您尝试 alert(myArray[i]) 时，有几种可能性：

*   myArray[i] 是一个函数（很可能）
*   myArray[i] 是文字字符串“function(){return JSON.encode(this);}”
*   myArray[i] 有一个 .toString() 方法，该方法返回该函数或该字符串。这是三者中可能性最小的。

最简单的判断方法是检查 typeof(myArray[i])。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T15:23:51.830

```
eval('(' + jsonObject + ')') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T23:41:30.093

如果你得到的对象元素是一个函数，你可以试试这个：

```
var url = myArray[i](); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T12:19:25.743

如果您信任该字符串，JavaScript 中的 JSON 解码只是一个 eval()，如果您不信任，您可以在[http://json.org](http://json.org)上找到更安全的代码。

然后，您将拥有一个 JavaScript 数据结构，您可以遍历该数据结构以获取所需的数据。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-25T11:33:31.250

我以这种方式解码 JSON：

```
eval( 'var from_json_object = ' + my_json_str + ';' ); 
```

# sql-server - 如何使用默认值添加不可为空的列

> ID：182432
> 
> 赞同：5
> 
> 时间：2008-10-08T12:15:29.400
> 
> 标签：sql-server

通常我们需要在表中添加不可为空的列，这是一项艰巨的任务。按原样使用默认约束*是*行不通的，因此我们必须创建可为空的列，将它们更新为默认值，然后使它们不可为空。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-08T14:21:15.310

是的，默认约束的 WITH VALUES 修饰符将默认值应用于现有行，从而消除了问题中描述的所有“硬”工作。

```
IF NOT EXISTS (SELECT * FROM sys.columns WHERE object_id=OBJECT_ID('[caConfig]') AND [Name]='ExportWizardVersion')
ALTER TABLE [caConfig] 
    ADD 
        [ExportWizardVersion] varchar(5) not null CONSTRAINT DF_caConfig_ExportWizardVersion DEFAULT '5.8' WITH VALUES,
        [ExportPeriodEnd] varchar(10) not null CONSTRAINT DF_caConfig_ExportPeriodEnd DEFAULT 'MonthEnd' WITH VALUES 
```

# sql - 用于验证 SQL Server 数据库架构的工具

> ID：182436
> 
> 赞同：4
> 
> 时间：2008-10-08T12:17:33.280
> 
> 标签：sql, sql-server, validation, schema

是否有任何工具可用于根据一组设计规则、命名约定等验证数据库模式？

我不是在谈论将一个数据库与另一个数据库进行比较（正如[这个问题](https://stackoverflow.com/questions/165401/how-to-comparevalidate-sql-schema)所涵盖的那样）。

我希望能够说“这个数据库中的什么不符合这套规则”。

我正在谈论的规则类型的一些示例如下：
- 主键字段应该是表中的第一个。
- 外键应该在该字段上有一个索引。
- 以“xxx”结尾的字段名称应该是某种类型。
- 具有约束的字段将其限制为某些值，它应该具有默认值。

我过去写了一堆脚本来做到这一点，并且想知道是否有一些通用的东西。

理想情况下，我想要一些用于 SQL Server 的东西，但如果您了解其他数据库的一些东西，那么了解它们也可能很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T12:26:24.653

实现此目的的一种方法是编写整个数据库的脚本，然后将由正则表达式组成的规则应用于脚本。SSW 的[商业工具](http://www.ssw.com.au/ssw/SQLAuditor/)对 SQL Server 做了类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-12T01:21:35.753

一个名为 SQLCop 的工具正在满足您的要求，但我不相信它实际上允许您自己编写规则。

[http://sqlcop.lessthandot.com/detectedissues.php](http://sqlcop.lessthandot.com/detectedissues.php)

# design-patterns - “TryParse / Parse like”模式：实现它的最佳方式是什么

> ID：182440
> 
> 赞同：10
> 
> 时间：2008-10-08T12:18:23.093
> 
> 标签：design-patterns, return-value, try-catch

[这个问题是如何指示方法不成功](https://stackoverflow.com/questions/161822/how-to-indicate-that-a-method-was-unsuccessful)的后续问题。xxx() Tryxxx() 模式在许多库中都非常有用。我想知道在不复制代码的情况下提供两种实现的最佳方式是什么。

什么是最好的：

```
public int DoSomething(string a)
{
     // might throw an exception
}
public bool TrySomething(string a, out result)
{
    try
    {
        result = DoSomething(a)
        return true;
    }
    catch (Exception)
    {
        return false;
    } 
```

或者

```
public int DoSomething(string a)
{
     int result;
     if (TrySomething(a, out result))
     {
         return result;
     }
     else
     {
         throw Exception(); // which exception?
     }
}
public bool TrySomething(string a, out result)
{
    //...
} 
```

我本能地假设第一个示例更正确（您确切知道发生了哪个异常），但是 try/catch 不会太贵吗？有没有办法在第二个示例中捕获异常？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-08T12:37:05.770

让 TrySomething 捕获并吞下异常是一个非常糟糕的主意。TryXXX 模式的一半是为了避免异常对性能的影响。

如果您在异常中不需要太多信息，您可以使 DoSomething 方法只调用 TrySomething 并在失败时抛出异常。如果您需要异常中的详细信息，则可能需要更详细的内容。我还没有计时异常的大部分性能影响在哪里——如果是抛出而不是创建，你可以编写一个与 TrySomething 具有相似签名但返回异常或 null 的私有方法：

```
public int DoSomething(string input)
{
    int ret;
    Exception exception = DoSomethingImpl(input, out ret);
    if (exception != null)
    {
        // Note that you'll lose stack trace accuracy here
        throw exception;
    }
    return ret;
}

public bool TrySomething(string input, out int ret)
{
    Exception exception = DoSomethingImpl(input, out ret);
    return exception == null;
}

private Exception DoSomethingImpl(string input, out int ret)
{
    ret = 0;
    if (input != "bad")
    {
        ret = 5;
        return null;
    }
    else
    {
        return new ArgumentException("Some details");
    }
} 
```

不过，在你承诺之前先计时！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-08T12:34:46.727

我通常使用这种模式。取决于内部方法是如何实现的，这是否有意义。如果您必须使用条件 catch 块，它可能会有点讨厌......

```
public object DoSomething(object input){
  return DoSomethingInternal(input, true);
}

public bool TryDoSomething(object input, out object result){
  result = DoSomethingInternal(input, false);
  return result != null;
}

private object DoSomethingInternal(object input, bool throwOnError){
  /* do your work here; only throw if you cannot proceed and throwOnError is true */
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T12:27:54.773

如果您只是要捕获异常而不做任何事情但返回 false，那么第一个示例是正确的。

您可以将 TrySomething 更改为如下所示。

```
public bool TrySomething(string a, out result, bool throwException)
{
  try
  {
    // Whatever
  }
  catch
  {
    if(throwException)
    {
      throw;
    }
    else
    {
      return false;
    }
  }

}

public bool TrySomething(string a, out result)
{
  return TrySomething(a, out result, false);
} 
```

所以 DoSomething 看起来像

```
public int DoSomething(string a)
{
  int result;

  // This will throw the execption or 
  // change to false to not, or don't use the overloaded one.
  TrySomething(a, out result, true) 

  return result;      
} 
```

如果您不希望带有 throwException 的 TrySomething 公开，您可以将其设为私有成员。

异常可能会变得昂贵，您可以对字符串进行一些正则表达式检查以防止抛出异常。这取决于你想要做什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T12:30:51.227

假设这是 C#，我会说第二个例子

```
public bool TrySomething(string a, out result)
{
    try
    {
        result = DoSomething(a)
        return true;
    }
    catch (Exception)
    {
        return false;
    }
} 
```

它模仿了内置的`int.TryParse(string s, out int result)`，在我看来，最好与语言/环境保持一致。

# html - 如何在 IE 中从一个 HTML 表单上传多个文件？

> ID：182446
> 
> 赞同：1
> 
> 时间：2008-10-08T12:19:51.233
> 
> 标签：html, internet-explorer, http, post, file-upload

Internet Explorer（至少从版本 4 到 7）将使用单个 'input type="file"' 表单字段上传的文件数限制为一个。如果我想在一个 HTTP POST 请求中上传多个文件，最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T12:21:43.477

您必须包含多个`input`控件，每个要上传的文件一个。

如果您不知道要提前多少，您可以使用 jQuery（或纯 javascript）即时创建它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T12:34:42.607

还有[SWFUpload 库](http://www.swfupload.org)。它允许在文件选择对话框中选择多个文件。但是，它需要同时启用 Flash 和 javascript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T12:26:21.190

还有一个很棒的资源“ [HTML 表单中的文件输入（或“上传”），](http://www.cs.tut.fi/~jkorpela/forms/file.html)它讨论了文件上传的跨浏览器问题。

# java - 如何使用 XFire 创建文档化的 WSDL

> ID：182452
> 
> 赞同：1
> 
> 时间：2008-10-08T12:20:55.677
> 
> 标签：java, web-services, documentation, wsdl, xfire

我使用[XFire](http://xfire.codehaus.org/)在我的应用程序周围创建一个 web 服务包装器。XFire 在运行时提供 webservice 接口和 WSDL（或者在编译时创建它们，不确切知道）。

我们的许多客户不太了解 Web 服务，而且他们根本不阅读任何外部文档，例如 Javadoc。我知道可以将文档（用于参数和方法）直接添加到 WSDL 文件中。

我考虑过 Annotations 或 Aegis XML 文件，但我不知道如何......你知道方法吗？

编辑：我刚刚发现了这个[JIRA 问题](http://jira.codehaus.org/browse/XFIRE-507)，但最后一次活动是 2006 年。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T23:24:03.933

XFire 正慢慢走向 /dev/null。请改用[CXF](http://cxf.apache.org/)。换句话说，XFire 被弃用，取而代之的是 CXF——它几乎是同一个开发者。

由于您使用 Java-first 方法，我建议您使用 CXF 的工具一劳永逸地生成 WSDL `java2wsdl`，然后将文档放入其中并告诉 CXF 使用*该*文档化的 WSDL，而不是让 CXF 在运行时/部署时间。

[这个页面](http://cwiki.apache.org/CXF20DOC/developing-a-service.html)几乎包含了关于在 CXF 中创建 Web 服务所需了解的所有信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-12T23:52:01.180

> 我关于 CXF 的最后一个提示 - 使用 Aegis 进行数据绑定而不是 JAXB。它不适用于复杂的 POJO。

根据我的经验，我们对复杂的 POJO 和 JAXB 没有任何问题，唯一的问题是代码开始被 JAXBElements 弄得一团糟。另一方面，Aegis 文档非常稀少，与 CXF 相关的维护也不是很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T05:53:25.760

让我加上我关于 XFire 的两分钱。我们在 JDK6（Tomcat 6.0 和 5.5）下的 XFie 遇到了非常严重的问题。请看一眼[那个问题](http://jira.codehaus.org/browse/XFIRE-1033)。在我们的案例中，JDK6 下带有 4 个以上 Web 服务的 XFire 会导致应用服务器挂起（线程死锁等）。这很有趣，但在 JDK5 下一切正常。

我完全同意 Christian Vest 关于从 XFire 迁移到 CXF 的观点。它在很多情况下都有意义，例如 ESB Mule 2 不再支持原生 XFire 连接器（[另请参阅](http://www.mulesource.org/display/XFIRE/Home)）。

而且我想补充一点，从 XFire 迁移到 CXF 并不是一种简单的方式（例如，CXF 具有与某些休眠版本冲突的 jar 依赖关系，[另请参阅](http://cxf.apache.org/docs/xfire-migration-guide.html)），但它是可行的。在我们的例子中，我们做了几天没有代码更正（仅限 Spring 配置）。

我关于 CXF 的最后一个提示 - 使用 Aegis 进行数据绑定而不是 JAXB。它不适用于复杂的 POJO。

# coldfusion - ColdFusion 和尾随逗号

> ID：182455
> 
> 赞同：12
> 
> 时间：2008-10-08T12:21:25.363
> 
> 标签：coldfusion

如何从 ColdFusion 中的字符串中删除尾随逗号？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-08T12:24:07.997

要删除尾随逗号（如果存在）：

```
REReplace(list, ",$", "") 
```

去除一个或多个尾随逗号：

```
REReplace(list, ",+$", "") 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-20T08:11:17.973

也很容易：

```
<cfset CleanList = ListChangeDelims(DirtyList, ",", ",")> 
```

说明：这利用了 CF 列表函数忽略空元素这一事实。`ListChangeDelims()`因此剥离了最后一个“元素”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-08T12:23:29.103

检查最右边的字符 - 如果它是逗号，则将字符串设置为原始的子字符串，长度为 -1。

修剪字符串可确保尾随逗号后的空格不会干扰此方法。

```
<cfset myStr = "hello, goodbye,">
<cfset myStr = trim(myStr)>

<cfif right(myStr, 1) is ",">
    <cfset myStr = left(myStr, len(myStr)-1)>
</cfif> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T15:30:38.680

这可能比正则表达式列表更多地影响性能，但有时当我最终过滤/修复脏数据时，我将其转换为数组，然后将其转换回列表。

```
 <cfset someVariable = arrayToList(listToArray(someVariable, ","), ",")> 
```

这是作弊，但它有效;-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T12:35:43.510

添加到帕特里克的答案。要在末尾替换一个或多个逗号，请使用以下命令：replace(myString, ",+$", "", "all")

下面的例子

```
<cfset myString = "This is the string, with training commas,,,">
<cfset onlyTheLastTrailingComma = reReplace(myString, ",$", "", "all")>
<cfset allTrailingCommas = reReplace(myString, ",+$", "", "all")>
<cfoutput>#onlyTheLastTrailingComma#<br />#allTrailingCommas#</cfoutput> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-18T18:17:30.393

从两侧、仅右侧或仅左侧删除“，”

```
<cfset theFunnyList = ",!@2ed32,a,b,c,d,%442,d,a"> 
```

替换有趣的字符并用逗号分隔

```
<cfset theList = rereplace(theFunnyList, "[^A-Za-z0-9]+", ",", "all")>
<cfset theList = trim(theList)>
<cfif left(theList, 1) is "," and right(theList, 1) is ",">
  <cfset theList = right(theList, len(theList)-1)>
  <cfset theList = left(theList, len(theList)-1)>
<cfelseif right(theList, 1) is ",">
  <cfset theList = left(theList, len(theList)-1)>
<cfelseif left(theList, 1) is ",">
  <cfset theList = right(theList, len(theList)-1)>
</cfif> 
```

排序列表（从数字到 AZ）升序

```
<cfoutput> #ListSort("#theList#", "text", "ASC", ",;")# </cfoutput> 
```

# delphi - 在 Delphi 中比较货币值时如何避免舍入问题？

> ID：182475
> 
> 赞同：4
> 
> 时间：2008-10-08T12:26:17.773
> 
> 标签：delphi, winapi, floating-point, currency

AFAIK，Delphi Win32 中的货币类型取决于处理器浮点精度。因此，我在比较两个货币值时遇到了舍入问题，根据机器返回不同的结果。

现在我使用传递 Epsilon 参数 = 0.009 的 SameValue 函数，因为我只需要 2 个十进制数字精度。

有没有更好的方法来避免这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-08T13:43:44.637

Delphi 中的 Currency 类型是按 1/10,000 缩放的 64 位整数；换句话说，它的最小增量等于 0.0001。它不像浮点代码那样容易受到精度问题的影响。

但是，如果您将货币数字乘以浮点类型，或将货币值相除，则确实需要以一种或另一种方式计算舍入。FPU 控制这个机制（它被称为“控制字”）。数学单元包含一些控制这种机制的过程：特别是 SetRoundMode。你可以在这个程序中看到效果：

```
{$APPTYPE CONSOLE}

uses Math;

var
  x: Currency;
  y: Currency;
begin
  SetRoundMode(rmTruncate);
  x := 1;
  x := x / 6;
  SetRoundMode(rmNearest);
  y := 1;
  y := y / 6;
  Writeln(x = y); // false
  Writeln(x - y); // 0.0001; i.e. 0.1666 vs 0.1667
end. 
```

您正在使用的第三方库可能将控制字设置为不同的值。您可能希望在重要计算的起点明确设置控制字（即舍入模式）。

此外，如果您的计算曾经转换为普通浮点数，然后又转换回货币，那么所有的赌注都会被取消 - 太难审计了。确保您的所有计算都使用货币。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-08T13:34:40.163

不，货币不是浮点类型。它是一个固定精度的小数，用整数存储实现。它可以精确比较，并且不存在例如 Double 的舍入问题。因此，如果您在 Currency 变量中看到不精确的值，则问题不在于 Currency 类型本身，而在于您放入其中的内容。很可能，您的代码中的其他地方有一个浮点计算。由于您没有显示该代码，因此很难在这个问题上提供更多帮助。但一般来说，解决方案是在存储到 Currency 变量之前将浮点数四舍五入到正确的精度，而不是对 Currency 变量进行不精确的比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-09T07:07:15.940

比较两个`currency`值的更快和更安全的方法当然是将变量映射到它们的内部`Int64`表示：

```
function CompCurrency(var A,B: currency): Int64;
var A64: Int64 absolute A;
    B64: Int64 absolute B;
begin
  result := A64-B64;
end; 
```

这将避免比较期间的任何舍入错误（使用 *10000 整数值），并且将比默认的基于 FPU 的实现更快（尤其是在 64 位 XE2 编译器下）。

有关其他信息，请参阅[本文](http://blog.synopse.info/post/2011/11/08/Currency-is-your-friend)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T15:06:46.997

如果您的情况和我一样，您可能会发现这种方法很有帮助。我主要在工资单上工作。如果一个企业有3个部门，想在这三个部门之间平均收取员工的费用，很多时候都会出现四舍五入的问题。

我一直在做的是循环各部门收取总成本的三分之一并将收取的成本添加到小计（货币）变量中。但是当循环变量等于限制时，我不是乘以分数，而是从总成本中减去小计变量并将其放在最后一个部门。由于这个过程产生的日记帐分录总是需要平衡，我相信它总是有效的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T15:48:55.327

见线程：

D7 / DUnit：所有 CheckEquals(Currency, Currency) 测试突然失败......

[https://forums.codegear.com/thread.jspa?threadID=16288](https://forums.codegear.com/thread.jspa?threadID=16288)

看起来我们的开发工作站上的更改导致货币比较失败。我们还没有找到根本原因，但是在两台运行 Windows 2000 SP4 的计算机上，并且独立于 gds32.dll 的版本（InterBase 7.5.1 或 2007）和 Delphi（7 和 2009），这一行

```
TIBDataBase.Create(nil); 
```

现在将 8087 控制字的值从 $1372 更改为 $1272。

并且单元测试中的所有货币比较都会失败并显示有趣的消息，例如

```
Expected: <12.34> - Found: <12.34> 
```

gds32.dll 没有被修改，所以我猜这个库中存在对修改控制字的第三方 dll 的依赖。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-08T12:34:58.240

为了避免在 Delphi 中可能出现的货币四舍五入问题，请使用 4 位小数。

这将确保您在进行非常少量的计算时永远不会遇到舍入问题。

`"Been there. Done That. Written the unit tests."`

# svn - 如何正确配置 TortoiseSVN 的“全局忽略模式”？

> ID：182492
> 
> 赞同：43
> 
> 时间：2008-10-08T12:30:17.687
> 
> 标签：svn, tortoisesvn, svnignore

我希望 TortoiseSVN (1.5.3) 忽略某些文件夹、它们的内容和某些其他文件，它们可能出现在我的目录层次结构中，但我无法正确获取全局忽略字符串。

无论我做什么，它要么增加太多，要么忽略太多

要忽略的正确“全局忽略模式”是什么？...

```
Folders : bin obj release compile 
Files   : *.bak *.user *.suo 
```

更新：为了帮助澄清......是的，我在 Windows 上使用它。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-08T12:34:48.787

目前，我的全局忽略模式中有以下内容：

```
bin obj CVS .cvsignore *.user *.suo Debug Release *.pdb test.* Thumbs.db 
```

可以很好地忽略几个隐藏或临时文件/文件夹....

因此，对于您的特定要求：

*   文件夹：`bin obj release compile`
*   文件：`*.bak *.user *.suo`

我会使用：

```
bin obj release compile *.bak *.user *.suo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T12:47:39.040

如果您使用的是 Windows，则不需要使用这样的忽略模式：

*/bin */obj

目录？甚至可能：

```
*/bin/* */obj/*

```

我必须承认，我是在做错事后才意识到这一点的，所以我还没有“现场”尝试过。注意目录模式中正斜杠的使用。

（来源见此链接： http: [//svn.haxx.se/tsvnusers/archive-2007-03/0281.shtml](http://svn.haxx.se/tsvnusers/archive-2007-03/0281.shtml) ）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-29T15:48:01.380

（添加到一个老问题..）
这主要取决于您的语言。所以这里已经有一些版本用于 VB6 和其他版本。

这适用于**Visual Studio 和 C#**：

```
global-ignores = *.suo *.user *.userosscache *.sln.docstates *.userprefs debug release Debug Release bin x64 x86 obj Obj *_i.c *_p.c *_i.h *.ilk *.meta *.obj *.pch *.pdb *.pgc *.pgd *.rsp *.sbr *.tlb *.tli *.tlh *.tmp *.tmp_proj *.log *.psess *.vsp *.vspx *.sap Thumbs.db _UpgradeReport_Files *.dbmdl 
```

并进入你的

```
%APPDATA%/Subversion/config 
```

文件。如果你像我一样有一个新的*配置*文件，你只会找到被注释掉的*global-ignore条目，所以你可以附加该行。*

它主要来自[https://github.com/github/gitignore/blob/master/VisualStudio.gitignore](https://github.com/github/gitignore/blob/master/VisualStudio.gitignore)的 gitignore 。

**任何语言的一般情况**
基本上，谷歌搜索（或 binging，如果你愿意）“gitignore（语言或工具）”你会找到示例 gitignore 文件，语法类似于 SVN 的*global-ignore*，你只需要做一些编辑（SVN 在一行中的所有条目，对于 GIT，每个条目在新行中）。

像[Sublime](http://www.sublimetext.com/)或[Notepad++](https://notepad-plus-plus.org/)这样好的文本编辑器 在转换时有很大帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T12:36:01.043

这是我用于 .NET 的一种。请注意，我使用 VB6 以及其他软件包，因此有额外的条目。它也区分大小写。

*.chm *.dat *.dll *.ini *.err *.exe *.DLL *.INI *.ERR *.EXE *.backup *.zip *.ZIP *.vbw *.scc *.vbg *.日志 *.exp *.lib *.vrs* .SCC *.PRF *.prf *.NIP *.NOP *.nip *.nop *.out *.bjob *.job *.prt *.tmp *.txt *.EX_ *.ex_ *.MDP *.bak *.BAK *.CFG *.cfg *.TXT *.vrs *.VRS *.scc *.SCC *.vsc *.VSC *.mdb *.MDB *.cur *. oca *.setup *.png *.suo *.user Debug Release bin *.pdb *.trx TestResults *.WS~ *.ocx

事实证明，这三个对于大大减少我必须追踪的文件通配符数量至关重要。

调试发布箱

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-28T08:59:32.580

请注意，使用 subversion 1.7+ 不需要全局忽略列表中的路径（%appdata%\subversion\config 文件中的 global-ignores 行）。见[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html)

*因此，要忽略所有*项目中的 bin 和 obj 目录： global-ignores = bin obj

# c# - MS 实体框架的最佳起点是什么？

> ID：182497
> 
> 赞同：0
> 
> 时间：2008-10-08T12:31:37.123
> 
> 标签：c#, .net, entity-framework

请给我关于实体框架的最佳指导方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T12:37:58.793

[Mike Taulty 在这里](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/category/1024.aspx)有一系列值得一读的博客文章。但首先 - 确保您真的非常想要 EF 的复杂性；NHibernate、LINQ-to-SQL 等在许多情况下都能提供更好的答案。EF 方法存在许多问题（尤其是强制基类和非常复杂的 xml - 几乎无法理解）。

我并不是说不要使用它：只要确保你首先需要它提供的东西（以复杂性为代价）......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T12:45:35.487

[此问题](https://stackoverflow.com/questions/62110/adonet-entity-framework-tutorials)中提供了一些教程的列表。

[这](http://forums.microsoft.com/msdn/ShowForum.aspx?ForumID=533&SiteID=1)是一个有用的实体框架论坛。

对我来说，当我开始使用实体框架时，最有用的参考资料是[Daniel Simmons 的 FAQ](http://blogs.msdn.com/dsimmons/pages/entity-framework-faq.aspx)。看看这个！

# php - 生成 RSS/Atom 的最佳 PHP 库/类

> ID：182510
> 
> 赞同：21
> 
> 时间：2008-10-08T12:35:03.917
> 
> 标签：php, rss, rdf, atom-feed

我必须在各种应用程序中生成 RSS/Atom 提要，并且我想知道一个能够同时生成两者并且已经处理所有常见问题的好的库或类。

例如，我多年来使用的日期格式不正确，因此我的提要没有被几个聚合器很好地处理。

**更新：** 我为什么要找图书馆？因为我用了好几年的那个，我被黑了几次，有一个小问题。也许没有正确遵循规范。

[为什么我的 RSS 提要重复某些条目？](https://stackoverflow.com/questions/182615/why-my-rss-feed-duplicate-some-entries)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-08T12:59:04.087

[PHP 通用提要生成器](http://www.phpclasses.org/package/4427-PHP-Generate-feeds-in-RSS-1-0-2-0-an-Atom-formats.html)似乎正是您所追求的——它有一种简单的、基于 OO 的方式来声明新提要并将其输出到您想要的规范。

它还具有内置的日期格式转换作为其功能之一。

> 特征：
> 
> *   生成 RSS 1.0、RSS 2.0 和 ATOM 1.0 提要
> *   所有提要均由提要验证器进行验证。
> *   为不同的版本实现适当的命名空间。
> *   自动转换日期格式。
> *   为 ATOM 提要生成 UUID。
> *   处理所需标签的 CDATA 编码。
> 
> 支持的版本：
> 
> *   RSS 1.0（正式废弃 RSS 0.90）
> *   RSS 2.0（正式废弃 RSS 0.91、0.92、0.93 和 0.94）
> *   原子 1.0

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T12:41:25.650

你真的需要图书馆吗？选择格式并简单地按照其规范输出有效的 XML。

这是一些入门[教程。](http://www.xul.fr/en-xml-rss.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T12:43:47.317

嗯，IMO，除非你想要外壳，否则这两种格式都很容易制作，无需任何课程。例如，对于我管理的网站的 RSS 提要，我只是简单地编写了一个 Smarty 小模板，它运行得非常顺利。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-09-27T08:29:52.473

对于非英语字符集，请查看 PHP 函数 htmlentities： [http://php.net/manual/en/function.htmlentities.php](http://php.net/manual/en/function.htmlentities.php)

我刚刚添加了支持克罗地亚字符集：

```
$nodeText .= (in_array($tagName, $this->CDATAEncoding))? $tagContent : htmlentities($tagContent, ENT_COMPAT, 'UTF-8'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T09:22:28.003

PHP Universal Feed Generator 是一个很好的答案。我只需根据网页上的评论修改代码以处理正确的法语字符。

[http://www.ajaxray.com/blog/2008/03/08/php-universal-feed-generator-supports-rss-10-rss-20-and-atom/#comment-341](http://www.ajaxray.com/blog/2008/03/08/php-universal-feed-generator-supports-rss-10-rss-20-and-atom/#comment-341)

> 就像 Kereste 所说（1\. June）FeedWrite 对一些非英语 utf-8 字符（如 ä 等）产生了问题。这是因为 xml 只知道 5 个实体（&、”、'、）。所以我将源代码中的第 298 行更改为
> 
> $nodeText .= (in_array($tagName, $this->CDATAEncoding))? $tagContent : str_replace ( 数组 ( '&', '"', "'", ”), 数组 ('&' , '"', ''' , '<' , '>' ), $tagContent );
> 
> 避免将字符转换为错误的 xml 实体。

# java - 正则表达式：替换 XML 文件中的版本号

> ID：182519
> 
> 赞同：1
> 
> 时间：2008-10-08T12:39:11.990
> 
> 标签：java, regex, ant

好的，我放弃了，我一直在尝试在 ant 中编写一个正则表达式来替换我在属性文件中的版本号。我有以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
    <feature
          id="some.feature.id"
          label="Some test feature"
          version="1.0.0"
          provider-name="Provider">

   <plugin
         id="test.plugin"
         download-size="0"
         install-size="0"
         version="0.0.0"
         unpack="false"/>
..... many plugins later....
</feature> 
```

我想要实现的是仅替换功能标记的版本号，而不更改 xml 的版本或文件中插件 miriad 的版本。

我遇到的问题是我匹配太多或太少。明确匹配“版本”是不够的，因为一切都会改变

考虑到“0.0.0”可以是任何数字，是否有任何简单的方法可以匹配标签内的版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T12:54:15.610

以下正则表达式可能会做你想要的......

```
(?<=<feature[^>]{*,1000}version=")[^"]*(?=") 
```

用人类的话说，大致意思是

> 我想匹配紧跟在字符串“<feature”之后的文本，后跟最多一千个字符而不是大于括号和“version =”；要匹配的文本后面紧跟双引号，并包含没有双引号。

`**`*感谢 Alan M 提供有关 java* lookbehinds ಠ_ಠ</p> 的提示

如果您将此正则表达式与 Replace 操作一起使用，它将使用您设置为替换值的任何内容切换 version="" 属性内的任何内容。由您提供格式正确的版本号。

现在，既然您正在使用 XML 执行此操作，那么显而易见的问题是，“您为什么不使用 XPath？”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T13:00:30.933

假设您正在使用该`replaceregexp`任务：

```
<replaceregexp file="whatever"
               match="(<feature\b[^<>]+?version=\")[^\"]+"
               replace="\1${feature.version}" /> 
```

我还假设只有一个`<feature>`元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T14:05:58.103

只是为了好玩：单行，*使用 xpath* (！)，与**ruby**

（我知道：这不是一个正则表达式，但它是为了说明 Will 的建议，他在说

> 现在，既然您正在使用 XML 执行此操作，那么显而易见的问题是，“您为什么不使用 XPath？

)

输入“irb”，然后：
**需要“rexml/document”；包括 REXML；file = File.new("a.xml"); doc = Document.new(file);puts doc; doc.elements.each("/feature") {|e| e.attributes["version"]="1.2.3" }; 放文档**

它将所有“功能”元素的所有“版本”属性替换为“1.2.3”

```
irb(main):001:0* require "rexml/document";include REXML;file = File.new("a.xml"); doc = Document.new(file);puts doc; doc.elements.each("/feature") {|e| e.attributes["version"]="1.2.3" }; puts doc

<?xml version='1.0' encoding='UTF-8'?>
<feature id='some.feature.id' version='1.0.0' provider-name='Provider' label='Some test feature'>
   <plugin unpack='false' id='test.plugin' download-size='0' version='0.0.0' install-size='0'/>
</feature>

<?xml version='1.0' encoding='UTF-8'?>
<feature id='some.feature.id' version='1.2.3' provider-name='Provider' label='Some test feature'>
   <plugin unpack='false' id='test.plugin' download-size='0' version='0.0.0' install-size='0'/>
</feature> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T15:01:16.853

它可能有点重量级，但由于您正在处理 XML，我建议使用这样的 XSLT：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="@*|*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*|*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/feature/@version">
        <xsl:attribute name="version">
            <xsl:text>1.0.1</xsl:text>
        </xsl:attribute>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T12:44:51.573

Perl 替换正则表达式看起来像这样......

```
s/<feature(.*?)version=".*?"/<feature$1version="1.2.3.4"/s 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T12:51:24.197

怎么样：

```
<feature[^<>]+version\s*=\s*"(\d+\.\d+\.\d+)"[^<>]*> 
```

括号中是与版本号匹配的组。移动括号以获得您需要的精确匹配。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T13:05:55.773

Vim 的救援：

```
:s/\(label=".+"\_.\s*version="\).+"/\1NEWVERSIONNUMBER"/ 
```

# css - 这就是您构建 CSS 样式表的方式吗？

> ID：182528
> 
> 赞同：2
> 
> 时间：2008-10-08T12:42:31.280
> 
> 标签：css, stylesheet, markup

抛开应该提供单个样式表还是多个样式表的问题不谈，假设您只发送一个样式表，您认为这是什么基本结构？

/* 结构 */

任何模板布局的东西都应该放在这里，所以页眉、页脚、正文等。

/* 结构结束 */

/* 通用组件*/

重复的元素，例如注册表单、列表等。

/* 常用组件结束*/

/* 特定页面 1 */

有些页面可能有特定的样式，会放在这里。

/* 具体第 1 页结束 */

/* 特定页面 2 */

如上

/* 具体的第 2 页结束 */

/* 特定页面等 */

等等。

/* 特定页面等结束 */

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-08T15:15:39.507

这与我的结构类似，但是，我发现使用子标题是最好的方法，所以我使用这种结构：

/************************* * 全球的 * ********************* ****/

/*所有常见的东西都放在适当的子标题下*/

/* 标题格式 */

/* 文本格式 */

/* 表格格式 */

/* 表格格式 */

/* ETC */

/************************* * 布局 * ********************* ****/

/* 所有布局的东西都放在小标题下 */

/* 标题 */

/* 左侧边栏 */

/* 右侧边栏 */

/* 页脚 */

/************************* * 导航 * ********************* ****/

/* 我将导航与布局分开，因为它们的子标题下可以有许多导航点 */

/* 主（水平）导航 */

/* 左侧导航 */

/* 右导航 */

/* 面包屑导航 */

/************************* * 形式 * ********************* ****/

/* 任何与普通格式不同的表单格式，如果有多个不同格式的表单，则使用子标题 */

/************************* * 表格 * ********************* ****/

/* 与表单相同的交易 */

/************************* * 列表 * ********************* ****/

/* 与表格和表格相同的交易 */

/************************* * 内容 * ********************* ****/

/* 特定页面的任何特定格式，按页面的子标题分组，与表单、表格和列表相同 */

/************************* * CSS 支持 * ************************ *****/

/* 这适用于任何特殊格式，可以应用于任何页面上的任何元素，并让它覆盖该项目的常规格式。例如，这可能有如下内容： */

```
.float-right { float: right; }
.float-left { float: left; }
.float-center { margin-left: auto; margin-right: auto; }
.clear { clear: both }
.clear-block { display: block }
.text-left { text-align: left }
.text-right { text-align: right }
.text-center { text-align: center }
.text-justify { text-align: justify }
.bold { font-weight: bold }
.italic { font-style: italic }
.underline { border-bottom: 1px solid }
.nopadding { padding: 0 }
.nobullet { list-style: none; list-style-image: none } 
```

/* ETC */

希望有帮助。

不过，我通常不建议像那样写在一行上，或者像亚当发布的链接中建议的那样，如果它们太长，它们很难略读。对于上面的示例，以这种方式键入它们会更快，因此我不必缩进每一行。

对于格式化，我会推荐这种结构：

```
.class {
    width: 200px;
    height: 200px;
    border: 1px solid #000000;
} 
```

依此类推，我将类或 ID 的结构放在顶部，然后是任何其他格式，例如字体等。使浏览变得非常快速和清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T18:27:24.050

任何对你有意义的东西都足够好。坦率地说，当其他人在你的样式表中寻找某些东西时——或者当你来寻找某些东西时——他们不会试图弄清楚你的组织结构是什么。他们只是要搜索他们需要查看的任何类或元素。因此，只要您通常将相关的东西放在一起，并用@Matt 建议的评论将它们分开，就可以了。

事实是，即使有一个经过深思熟虑的组织结构——就像一个经过深思熟虑的文件系统一样——它的去向并不总是很明显。所以你最好还是有点理智，不要花很多时间来整理东西，而是依靠搜索工具来找到你需要的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T08:26:43.543

我以与您类似的方式组织我的 CSS，但我确实从重置部分开始。主要思想是从一般到具体。所以这里是：

*   重启

*   结构体

*   html_tags

*   导航

*   具体部分

*   错误消息 - 这是我的最后一部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T12:50:16.633

你提出的结构正是我使用的。但是，在我看来，它仍然变得过于复杂，新规则的出现和相互覆盖......也许我应该尝试坚持亚当链接的主题中建议的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T15:30:17.247

似乎每次我创建一个新的 css 文件时，我都会找到一种新的方式来组织它。他们都比以前更好。

# c# - 在循环中创建控件

> ID：182529
> 
> 赞同：1
> 
> 时间：2008-10-08T12:43:18.613
> 
> 标签：c#, asp.net, .net-2.0

我有一些代码可以将新单元格添加到表格中并用文本框填充它们。

到目前为止，我对其进行编码的方式效果很好：

```
 TableCell tCell1 = new TableCell();
        TableCell tCell2 = new TableCell();
        TableCell tCell3 = new TableCell();
        TableCell tCell4 = new TableCell();
        TableCell tCell5 = new TableCell();
        TableCell tCell6 = new TableCell();
        TableCell tCell7 = new TableCell();

        TextBox txt1 = new TextBox();
        TextBox txt2 = new TextBox();
        TextBox txt3 = new TextBox();
        TextBox txt4 = new TextBox();
        TextBox txt5 = new TextBox();
        TextBox txt6 = new TextBox();
        TextBox txt7 = new TextBox();

        tCell1.Controls.Add(txt1);
        tCell2.Controls.Add(txt2);
        tCell3.Controls.Add(txt3);
        tCell4.Controls.Add(txt4);
        tCell5.Controls.Add(txt5);
        tCell6.Controls.Add(txt6);
        tCell7.Controls.Add(txt7);

        tRow.Cells.Add(tCell1);
        tRow.Cells.Add(tCell2);
        tRow.Cells.Add(tCell3);
        tRow.Cells.Add(tCell4);
        tRow.Cells.Add(tCell5);
        tRow.Cells.Add(tCell6);
        tRow.Cells.Add(tCell7); 
```

如您所见，基本上有 4 条指令重复 7 次。我确信必须有一种方法可以在 FOR 循环中仅使用 4 行代码并动态分配所有名称来完成此操作，但我似乎无法找到任何可以指引我的方法做。

以下是我所追求的：

```
 for (int i = 0; i < 6; i++)
    {

        TableCell tCell[i] = new TableCell();
        TextBox txt[i] = new TextBox();
        tCell[i].Controls.Add(txt[i]);
        tRow.Cells.Add(tCell[i]);

    } 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T12:48:50.567

我认为应该这样做：

```
 for (int i = 0; i < 7; i++)
    {

        TableCell tCell = new TableCell();
        TextBox txt = new TextBox();
        tCell.Controls.Add(txt);
        tRow.Cells.Add(tCell);

    } 
```

确保将 6 更改为 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T12:48:16.247

这应该可以正常工作吗？

```
for (int i = 0; i < 6; i++)
{
    TableCell tCell = new TableCell();
    TextBox txt = new TextBox();
    tCell.Controls.Add(txt);
    tRow.Cells.Add(tCell);
} 
```

我真的不明白你需要什么名字。
您是否打算使用“txt5”名称作为对该特定文本框的引用？
为什么不直接使用`tRow.Cells[4].Controls[0] As TextBox`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T12:49:40.457

你写的实际上看起来和我很接近。不过，有几点需要牢记。

我不相信你需要数组索引。只要 tRow 在循环外初始化，它就会每次都添加新元素。您可能还想设置每个文本框的 ID 属性，以便您可以访问您可能正在寻找的任何特定内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T13:00:56.033

感谢所有有用的答案。对于那些询问我对阵列做了什么的人，我不是！这只是我试图实现的一个例子。

Ian 和 Lars 的想法是正确的，因为我稍后需要参考这些文本框，所以我只需要使用 Eugene 和 Lubos 的解决方案，并确保我添加的行将为他们提供顺序 ID (txt1, txt2等），这样我就可以做到这一点。

再次感谢所有精彩（和快速！）的输入，我现在爱上了这个网站！

# sql-server - 给定 SQL Server 需要多长时间才能相当精通 Oracle

> ID：182534
> 
> 赞同：2
> 
> 时间：2008-10-08T12:44:15.007
> 
> 标签：sql-server, oracle

在通过代理申请工作时，我有时会被代理阻止，他说你知道软件包 X。当我回复说我知道类似的软件包 Y 时，他们可能会说，除非你知道 XI 不能让你前进。

问题是这些代理中的一些不知道他们在说什么，他们只是被他们的客户用作筛选过滤器。

能够对这些代理人说，因为我知道 YI 可以期望在给定的天数/月内合理地精通 X，这将是有用的。但是不知道 X 确定所需的时间是我问这个问题的原因。

最近 X 是 Oracle，Y 是 SQL Server。

请那些都知道这两者的人能否就需要多长时间才能变得相当精通发表意见？**注意我不是在谈论成为 DBA！**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-08T16:30:14.690

I'll state my bias upfront - Oracle is far more complex than Sql Server. So it depends what you'll be asked to do. You say that this is not for a DBA position but that definition is pretty fluid. At my company, Developers are charged with designing tables, adding the correct indexes, determining partitioning.

If you say, all I'll do is code in java or c# and call packages written by a DBA or Oracle Developer, then you are safe.

But if you take all of your MSSS experience and add semi-colons to the end of your lines you'll kill your Oracle instance. Many standard practices in MSSS are anethema to Oracle. In MSSS it's recommended to have clustered indexes on most every table. In Oracle we build IOTs (Index Organized Tables) only for specific purposes. In MSSS doing DDL in T-SQL is as easy as falling off a log. In Oracle it is made difficult on purpose, it's discouraged and in fact somewhat dangerous. In MSSS you whip off #temp table like they're jelly beans, in Oracle we plan them in advance since they are permanent database objects that aren't just created in the middle of a proc when the logic gets a little tricky.

That said, would you be able to make Oracle do something? Well, yah, but the real question is will it work efficiently and scale to meet the needs of the business your agent placed you at. And that's a resounding no.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T13:38:11.497

我走了另一条路（先是 Oracle，然后是 SQL Server）。我的经验是：

SQL 查询 - 微不足道的差异，除了字符串日期转换领域，这在 Oracle 中更容易。

存储过程 - T-SQL 语法与 PL/SQL 有很大不同。那里有一条学习曲线，但没有什么是不可逾越的。

数据库管理员 - 非常不同，但在 SQL Server 中更容易。如果这是工作描述的一部分，那么他们可能有理由考虑其他人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T12:48:44.733

如果您被聘为 DBA，则在数据库之间切换需要一段时间，因为它们的管理方式不同（我仅基于我对 Oracle 和 DB2 的经验）。

我不知道 SQL Server，但我可以想象一个具有良好 GUI 管理的 Microsoft 程序将与管理 DB2/z 大不相同，例如（尽管如果您可以使用花哨的 DB2 LUW (Linux/UNIX/Window) 工具） '那样倾斜）。

如果您只是削减代码以使用数据库，则 SQL 差异很小（相对而言）。假设您已经精通 SQL，那根本不需要太多时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T13:55:09.870

我已经使用 SQL Server 10 年了，但大约一年半前开始使用 Oracle。像任何数据库一样，没有神奇的精通点——你使用的越多，你就越了解它。就开发人员需要了解的内容而言，经验丰富的开发人员不应该花费超过一周的时间（甚至这有点多）来加快使用它的速度。PL/SQL 与 T-SQL 没有太大区别，尽管存储过程有点不同。

编程方面，Oracle 数据访问类在 ADO.NET 上建模（我们实际上使用 OleDb - 附带的好处之一是您不必为了访问 BLOB 数据而使用 OracleBlob 类），所以不是那里有很多学习要做。

我最初让我的团队使用 TOAD，因为我听说 TOAD 是您应该与 Oracle 一起使用的（尽管我也听说过它的坏话）。我们最终达到了我是唯一一个使用 TOAD 的人，而其他人都在使用 SqlDeveloper 的地步。避免蟾蜍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T11:15:16.027

如果您只想在简历上加上一个要点以通过代理，只需添加它，这将使您通过代理并让您有机会踏上大门。如果您是诚实的人，请使用 Oracle XE，阅读[文档](http://www.oracle.com/pls/db102/portal.portal_db?selected=5)库中的相应指南，然后花一到 5 天时间用您最喜欢的语言编写博客/地址簿/flickr 克隆/等，以对抗 Oracle。

正如其他人所建议的那样，与 SQL Server 相比，您所做的事情存在一些显着差异，如果您只是将您从 SQL Server 所知道的应用到 Oracle，您可能会降低性能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T11:36:17.623

我不同意 SQL 是相似的。*SQL SYNTAX*与基本 CRUD 开发类似（类似于 ANSI的最低公分母）。但实际上构建包、编写多表/多步连接、批量更新和插入，使用丰富而强大的 Oracle 功能集与 SQL Server 有很大不同。这需要不同的心态，可能需要很多年才能掌握。然而...

CV /简历的目的是获得面试。

**与您的经纪人合作，突出您的最佳才能和行为，而不仅仅是技能。**

技能是可以学习和传授的。在新环境中学习新技能的才能和示范对雇主来说是金粉。

不要试图吹嘘它。不要撒谎。你会被发现的。使用您从 SQL Server 获得的经验来证明您可以解决问题。表现出对学习、培训和嫁接的渴望。

*但是，如果他们真的想要一个“降落伞并开始运行 Oracle 程序员”，那你就完蛋了！*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T13:17:52.053

2001 年，我从 SQL Server 转到 Oracle，从从事 VB6/SQL Server 项目（作为开发人员）到担任大型 J2EE 项目的 Oracle 开发 DBA。以下是我的经历和一些反思的编辑要点。

对于开发来说，SQL 的基本原理并没有根本的不同。T-SQL 与 PL/SQL 有点不同，所以习语也有点不同。大多数有能力的程序员应该能够通过修补并获得一些好的 SQL 服务器书籍（例如[Guru's Guide）](https://rads.stackoverflow.com/amzn/click/com/0201615762)或 Oracle 书籍（例如[Expert one-on-one Oracle](https://rads.stackoverflow.com/amzn/click/com/1590595254) ）来实现跳跃，这取决于您要走的路。

我会说，对于开发人员来说，一两个星期来习惯另一个数据库平台会让你大部分时间都在那里。基本原理非常相似（架构中的模数差异）；真的只有橱窗装饰不同。但是，如果您要去 Oracle，请获取第三方查询工具（例如[TOAD](http://www.toadsoft.com/) ）的副本，因为这些工具比 Oracle 提供的工具要好得多。

众所周知，代理商在匹配特定流行语方面很糟糕，我会半定期地得到这个（我是承包商）。如果您需要熟悉 SQL Server，[开发人员版](https://rads.stackoverflow.com/amzn/click/com/B000BHQ5JW)非常便宜，可以安装在 Windows XP 等桌面操作系统上。Oracle 还为其所有支持的平台提供[免费下载，您可以使用这些平台进行修补。](http://www.oracle.com/technology/software/products/database/index.html)

您还可以通过按照“PL/SQL 和 T-SQL 之间的主要惯用差异是什么”来询问 stackoverflow 问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-23T06:03:43.717

据我所知，学习 Oracle 比学习 SQL Server 更好，因为在我的一生中，我遇到了大多数使用 SQL Server 的人，并且因为这个数据库很容易学习，所以涉及到很多竞争。所以如果你学习甲骨文，它会让你在初始阶段变得强大，并减少参与其中的竞争。

# sql - 将 XML 日期时间转换为 SQL 日期时间

> ID：182541
> 
> 赞同：1
> 
> 时间：2008-10-08T12:46:10.493
> 
> 标签：sql, sql-server-2005

我有一个 XML 数据类型，并且想将一个元素转换为一个 sql DateTime 变量。如何？

例如

```
Declare @Xml Xml
Set @Xml = '<Root><DateFrom>2008-10-31T00:00:00</DateFrom></Root>'

Declare @DateFrom DateTime
Set @DateFrom = ????? 
```

如何使用上面 xml 中的日期设置 @DateFrom？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T13:17:12.117

```
Declare @Xml Xml
Set @Xml = '<Root><DateFrom>8/10/2008</DateFrom></Root>'

Declare @DateFrom DateTime
Select @DateFrom= t.b.value('DateFrom[1]', 'datetime')
from @xml.nodes('//Root') t(b) 
```

我强烈建议您查看`.nodes`XML 数据类型的功能。上面的代码提取出 DateFrom 元素的值，并将其转换为日期时间格式。

# asp.net - ASP.NET 的电子邮件地址验证

> ID：182542
> 
> 赞同：68
> 
> 时间：2008-10-08T12:46:21.070
> 
> 标签：asp.net, validation, email

您使用什么来验证 ASP.NET 表单上的电子邮件地址。我想确保它不包含 XSS 漏洞。

这是 ASP.NET 1.1

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-10-08T12:55:47.713

在 ASP.NET Web 表单上发布的任何脚本标记都会导致您的站点抛出未处理的异常。

您可以使用 asp 正则表达式验证器来确认输入，只需确保使用 if(IsValid) 子句将代码包装在方法后面，以防您的 javascript 被绕过。如果您的客户端 javascript 被绕过并且脚本标签被发布到您的 asp.net 表单，asp.net 将抛出一个未处理的异常。

你可以使用类似的东西：

```
<asp:RegularExpressionValidator ID="regexEmailValid" runat="server" ValidationExpression="\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*" ControlToValidate="tbEmail" ErrorMessage="Invalid Email Format"></asp:RegularExpressionValidator> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-07T12:43:00.357

这是我刚刚根据 Simon Johnson 的想法创建的基本电子邮件验证器。如果需要，它只需要添加 DNS 查找的额外功能。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web.UI.WebControls;
using System.Text.RegularExpressions;
using System.Web.UI;

namespace CompanyName.Library.Web.Controls
{
    [ToolboxData("<{0}:EmailValidator runat=server></{0}:EmailValidator>")]
    public class EmailValidator : BaseValidator
    {

        protected override bool EvaluateIsValid()
        {
            string val = this.GetControlValidationValue(this.ControlToValidate);
            string pattern = @"^[a-z][a-z|0-9|]*([_][a-z|0-9]+)*([.][a-z|0-9]+([_][a-z|0-9]+)*)?@[a-z][a-z|0-9|]*\.([a-z][a-z|0-9]*(\.[a-z][a-z|0-9]*)?)$";
            Match match = Regex.Match(val.Trim(), pattern, RegexOptions.IgnoreCase);

            if (match.Success)
                return true;
            else
                return false;
        }

    }
} 
```

更新：请不要使用原始的正则表达式。寻找更新更完整的样本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-08T12:55:12.410

您可以使用正则表达式验证器。ValidationExpression 属性有一个按钮，您可以在 Visual Studio 的属性面板中按下该按钮，该面板会列出许多有用的表达式。他们用于电子邮件地址的一种是：

```
\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)* 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-03-31T10:28:57.050

您也应该始终进行服务器端验证。

```
public bool IsValidEmailAddress(string email)
{
    try
    {
        var emailChecked = new System.Net.Mail.MailAddress(email);
        return true;
    }
    catch
    {
        return false;
    }
} 
```

更新

您也可以使用`EmailAddressAttribute`in `System.ComponentModel.DataAnnotations`。那么就不需要尝试捕获它是一个更清洁的解决方案。

```
public bool IsValidEmailAddress(string email)
{
    if (!string.IsNullOrEmpty(email) && new EmailAddressAttribute().IsValid(email))
        return true;
    else
        return false;
} 
```

请注意，`IsNullOrEmpty`还需要检查，否则一个`null`值将返回 true。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-08T12:56:21.067

验证它是一个真实的电子邮件地址要困难得多。

确认语法正确的正则表达式可能很长（例如，参见[http://www.regular-expressions.info/email.html ）。](http://www.regular-expressions.info/email.html)确认电子邮件地址的最佳方法是向用户发送电子邮件，并让用户通过单击链接来回复以确认他们已收到电子邮件（大多数注册系统的工作方式）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-08T12:59:44.927

在我们的代码中，我们有一个从 BaseValidator 类继承的特定验证器。

此类执行以下操作：

1.  根据正则表达式验证电子邮件地址。
2.  对域的 MX 记录进行查找，以确保至少有一个服务器可以传送到。

这是您无需实际向该人发送电子邮件确认链接即可进行验证的最接近的方法。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-08T12:54:48.073

防止 XSS 与验证输入是不同的问题。

关于 XSS：您不应该尝试检查XSS 或相关漏洞的*输入*。在将字符串插入某些字符是“魔法”的不同语言（例如，在 HTML 或 SQL 中插入字符串时）时，您应该通过正确转义来防止 XSS 攻击、SQL 注入等。例如，像 O'Reilly 这样的名称是完全有效的输入，但如果未转义插入 SQL，可能会导致崩溃或更糟。您无法通过验证输入来防止此类问题。

验证用户输入对于防止丢失或格式错误的数据是有意义的，例如。用户在邮政编码字段中写入“asdf”等。写。电子邮件地址，但语法非常复杂，使用正则表达式验证它并没有提供太多好处。只需检查它是否包含“@”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-09T10:22:36.547

快速简单的代码

```
public static bool IsValidEmail(this string email)
{
    const string pattern = @"^(?!\.)(""([^""\r\\]|\\[""\r\\])*""|" + @"([-a-z0-9!#$%&'*+/=?^_`{|}~]|(?<!\.)\.)*)(?<!\.)" + @"@[a-z0-9][\w\.-]*[a-z0-9]\.[a-z][a-z\.]*[a-z]$";    
    var regex = new Regex(pattern, RegexOptions.IgnoreCase);    
    return regex.IsMatch(email);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-27T10:08:22.380

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Globalization;
using System.Text.RegularExpressions;

/// <summary>
/// Summary description for RegexUtilities
/// </summary>
public class RegexUtilities
{
    bool InValid = false;

    public bool IsValidEmail(string strIn)
    {
        InValid = false;
        if (String.IsNullOrEmpty(strIn))
            return false;

        // Use IdnMapping class to convert Unicode domain names.
        strIn = Regex.Replace(strIn, @"(@)(.+)$", this.DomainMapper);
        if (InValid)
            return false;

        // Return true if strIn is in valid e-mail format. 
        return Regex.IsMatch(strIn, @"^(?("")(""[^""]+?""@)|(([0-9a-z]((\.(?!\.))|[-!#\$%&'\*\+/=\?\^`\{\}\|~\w])*)(?<=[0-9a-z])@))" + @"(?(\[)(\[(\d{1,3}\.){3}\d{1,3}\])|(([0-9a-z][-\w]*[0-9a-z]*\.)+[a-z0-9]{2,17}))$",
               RegexOptions.IgnoreCase);
    }

    private string DomainMapper(Match match)
    {
        // IdnMapping class with default property values.
        IdnMapping idn = new IdnMapping();

        string domainName = match.Groups[2].Value;
        try
        {
            domainName = idn.GetAscii(domainName);
        }
        catch (ArgumentException)
        {
            InValid = true;
        }
        return match.Groups[1].Value + domainName;
    }

}

RegexUtilities EmailRegex = new RegexUtilities();

       if (txtEmail.Value != "")
                {
                    string[] SplitClients_Email = txtEmail.Value.Split(',');
                    string Send_Email, Hold_Email;
                    Send_Email = Hold_Email = "";

                    int CountEmail;/**Region For Count Total Email**/
                    CountEmail = 0;/**First Time Email Counts Zero**/
                    bool EmaiValid = false;
                    Hold_Email = SplitClients_Email[0].ToString().Trim().TrimEnd().TrimStart().ToString();
                    if (SplitClients_Email[0].ToString() != "")
                    {
                        if (EmailRegex.IsValidEmail(Hold_Email))
                        {
                            Send_Email = Hold_Email;
                            CountEmail = 1;
                            EmaiValid = true;
                        }
                        else
                        {
                            EmaiValid = false;
                        }
                    }

                    if (EmaiValid == false)
                    {
                        divStatusMsg.Style.Add("display", "");
                        divStatusMsg.Attributes.Add("class", "alert alert-danger alert-dismissable");
                        divStatusMsg.InnerText = "ERROR !!...Please Enter A Valid Email ID.";
                        txtEmail.Focus();
                        txtEmail.Value = null;
                        ScriptManager.RegisterStartupScript(Page, this.GetType(), "SmoothScroll", "SmoothScroll();", true);
                        divStatusMsg.Visible = true;
                        ClientScript.RegisterStartupScript(this.GetType(), "alert", "HideLabel();", true);
                        return false;
                    }
                } 
```

# sql - SQL 查找重复条目（在组内）

> ID：182544
> 
> 赞同：4
> 
> 时间：2008-10-08T12:46:46.920
> 
> 标签：sql, oracle, join

SQL 查找重复条目（在组内）

我有一个小问题，我不确定修复它的最佳方法是什么，因为我只能有限地访问数据库 (Oracle) 本身。在我们的表“EVENT”中，我们有大约 160k 个条目，每个 EVENT 都有一个 GROUPID，而一个普通条目正好有 5 行具有相同的 GROUPID。由于一个错误，我们目前得到了几个重复的条目（重复，所以 10 行而不是 5 行，只是一个不同的 EVENTID。这可能会改变，所以它只是 <> 5）。我们需要过滤这些组的所有条目。

由于对数据库的访问受限，我们不能使用临时表，也不能向 GROUPID 列添加索引以使其更快。

我们可以使用此查询获取 GROUPID，但我们需要第二个查询来获取所需的数据

```
select A."GROUPID"
from "EVENT" A
group by A."GROUPID"
having count(A."GROUPID") <> 5 
```

一种解决方案是子选择：

```
select *
from "EVENT" A
where A."GROUPID" IN (
  select B."GROUPID"
  from "EVENT" B
  group by B."GROUPID"
  having count(B."GROUPID") <> 5
) 
```

如果没有 GROUPID 和 160k 条目的索引，这需要很长时间。尝试考虑可以处理此问题的连接，但到目前为止找不到好的解决方案。

任何人都可以找到一个好的解决方案吗？

小编辑：我们这里没有 100% 重复，因为每个条目仍然有一个唯一的 ID，而且 GROUPID 也不是唯一的（这就是我们需要使用“分组依据”的原因）——或者我只是错过了一个简单的解决方案它 ：）

关于数据的小例子（我不想删除它，只是找到它）

`EVENTID | GROUPID | TYPEID
123456    123       12
123457    123       145
123458    123       2612
123459    123       41
123460    123       238

234567    123       12
234568    123       145
234569    123       2612
234570    123       41
234571    123       238` 
它还有更多列，例如时间戳等，但正如您已经看到的，除了 EVENTID 之外，一切都是相同的。

我们将更频繁地运行它以进行测试，以查找错误并检查它是否再次发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T13:28:57.427

分析查询要解决的一个经典问题：

```
select eventid,
       groupid,
       typeid
from   (
       Select eventid,
              groupid,
              typeid,
              count(*) over (partition by group_id) count_by_group_id
       from   EVENT
       )
where count_by_group_id <> 5 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-08T13:15:59.060

您可以通过联接而不是子查询获得答案

```
select
    a.*
from
    event as a
inner join
    (select groupid
     from event
     group by groupid
     having count(*) <> 5) as b
  on a.groupid = b.groupid 
```

这是从组中的行中获取所有信息的一种相当常见的方法。

就像您建议的答案和其他回复一样，使用 groupid 上的索引会运行得更快。DBA 需要在使查询运行得更快的好处与维护另一个索引的成本之间取得平衡。

如果 DBA 决定不使用索引，请确保相关人员了解它是索引策略，而不是您编写查询的方式会减慢速度。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-08T13:12:17.430

该 SQL 实际需要多长时间？你只会在我假设的情况下运行它，首先修复了导致损坏的错误？我只是设置了一个这样的测试用例：

```
SQL> create table my_objects as 
  2  select object_name, ceil(rownum/5) groupid, rpad('x',500,'x') filler
  3  from all_objects;

Table created.

SQL> select count(*) from my_objects;

  COUNT(*)
----------
     83782

SQL> select * from my_objects where groupid in (
  2  select groupid from my_objects
  3  group by groupid
  4  having count(*) <> 5
  5  );

OBJECT_NAME                       GROUPID FILLER
------------------------------ ---------- --------------------------------
XYZ                                 16757 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
YYYY                                16757 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Elapsed: 00:00:01.67 
```

不到2秒。好的，我的表的行数是你的一半，但 160K 并不大。我添加了填充列以使表占用一些磁盘空间。AUTOTRACE 执行计划是：

```
-------------------------------------------------------------------------
| Id  | Operation             | Name       | Rows  | Bytes | Cost (%CPU)|
-------------------------------------------------------------------------
|   0 | SELECT STATEMENT      |            |   389 |   112K| 14029   (2)|
|*  1 |  HASH JOIN            |            |   389 |   112K| 14029   (2)|
|   2 |   VIEW                | VW_NSO_1   | 94424 |  1198K|  6570   (2)|
|*  3 |    FILTER             |            |       |       |            |
|   4 |     HASH GROUP BY     |            |     1 |  1198K|  6570   (2)|
|   5 |      TABLE ACCESS FULL| MY_OBJECTS | 94424 |  1198K|  6504   (1)|
|   6 |   TABLE ACCESS FULL   | MY_OBJECTS | 94424 |    25M|  6506   (1)|
------------------------------------------------------------------------- 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T12:53:50.883

如果您的 DBA 不会添加索引以加快速度，请询问他们建议您做什么（毕竟这是他们的报酬）。大概您有一个商业案例，为什么您需要此信息，在这种情况下，您的直接管理人员应该站在您这边。

也许您可以要求您的 DBA 将数据复制到**可以**添加索引的数据库中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T13:02:46.933

从 SQL 的角度来看，我认为您已经回答了自己的问题。您描述的方法（即使用子选择）很好，如果任何其他编写查询的方式在性能上差别很大，我会感到惊讶。

160K 记录对我来说似乎并不多。我可以理解如果您对该查询的性能不满意，如果它进入一段应用程序代码，但从它的声音来看，您只是将它用作一些数据清理练习的一部分。（因此希望您在性能方面更加宽容）。

即使没有任何支持索引，它仍然只是对 160K 行进行两次全表扫描，坦率地说，我希望在某种模糊合理的时间内执行。

与您的数据库管理员交谈。他们帮助制造了问题，所以让他们成为解决方案的一部分。

/EDIT/ 同时，运行您的查询。找出需要多长时间，而不是猜测。更好的是运行它，设置自动跟踪，并在此处发布结果，然后我们也许可以帮助您对其进行一些改进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T13:21:17.130

这项工作是否符合您的要求，是否提供更好的性能？（我只是想我会把它作为一个建议提出来）。

```
select * 
from group g
where (select count(*) from event e where g.groupid = e.groupid) <> 5 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T13:26:53.360

怎么分析：

```
SELECT * FROM (
SELECT eventid, groupid, typeid, COUNT(groupid) OVER (PARTITION BY groupid) group_count
  FROM event
)
  WHERE group_count <> 5 
```

# silverlight - 在 Silverlight 2 (RC0) 中自动应用模板（主题）

> ID：182553
> 
> 赞同：0
> 
> 时间：2008-10-08T12:48:31.970
> 
> 标签：silverlight, theming, silverlight-2-rc0

有没有办法自动将主题/模板/样式应用于目标类型的所有控件，所以我不必在所有控件上指定 Template=..., Style=...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T18:04:59.507

我认为有一种方法可以通过省略 x:Key 属性来做到这一点，但这似乎不再起作用了。根据一些谷歌搜索，在我看来，最好的办法是创建一个自己的自定义控件库，其中包含一个定义自定义样式的主题/generic.xaml 文件。然后，您可以使用自己的样式正确的元素（MyButton 而不是 Button）。要么[坚持使用 Style 属性](https://silverlight.net/blogs/msnow/archive/2008/10/02/silverlight-tip-of-the-day-55-how-to-apply-styles-in-silverlight-part-i.aspx)。

[这里](http://cynergysystems.com/blogs/page/josefajardo?entry=skinning_a_button_4_different)的一些例子和使用主题的替代方法[这里](http://www.nikhilk.net/Silverlight-Themes.aspx)。

**更新：刚刚在**[这里](http://www.ingebrigtsen.info/post/2008/10/13/Creating-a-theme-manager-for-Silverlight-2-Beta-1-Beta-2-RC0.aspx)找到了一个很好的例子（我想你可能已经看过了：）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-16T03:50:22.293

To set up a theme for all controls create a Startup event and set the theme in the Startup event Handler. That theme will be applied all user control in that solution.

```
//App.xaml

<Application x:Uid="Application_1" x:Class="SampleApp.Home.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="MainWindow.xaml"
             Startup="Application_Startup">

//App.xaml.cs

private void Application_Startup(object sender, StartupEventArgs e)
        {
            StyleManager.ApplicationTheme = new MetroTheme(); //Set your theme here           
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T19:02:31.607

Einarl：目前还没有办法在 Silverlight 2 核心中“级联”控制模板/样式。也就是说，您不能为 TextBox 设置样式/控件模板，并期望所有 TextBox 都将其选中。这绝对是团队正在为未来版本寻找的东西。

# linux - Linux 中微秒级精确（或更好）的进程计时

> ID：182554
> 
> 赞同：13
> 
> 时间：2008-10-08T12:48:42.423
> 
> 标签：linux, process, real-time, timing, high-resolution

我需要一种非常准确的方法来计时我的程序的某些部分。我可以为此使用常规的高分辨率时钟，但这会返回挂钟时间，这不是我需要的：我需要只运行我的进程所花费的时间。

我清楚地记得看到一个 Linux 内核补丁，它可以让我将我的进程计时到纳秒精度，除了我忘记给它添加书签并且我也忘记了补丁的名称:(。

我记得它是如何工作的：

在每次上下文切换时，它会读取一个高分辨率时钟的值，并将最后两个值的增量添加到正在运行的进程的进程时间。这产生了过程的实际过程时间的高分辨率准确视图。

常规处理时间使用常规时钟保持，我相信这是毫秒级的（1000Hz），这对于我的目的来说太大了。

有谁知道我在说什么内核补丁？我还记得它就像一个单词，在它之前或之后有一个字母——比如“rtimer”之类的东西，但我不记得确切了。

（也欢迎其他建议）

* * *

Marko 建议的完全公平调度器不是我想要的，但它看起来很有希望。我遇到的问题是我可以用来获取处理时间的调用仍然没有返回足够细化的值。

*   times() 以毫秒为单位返回值 21、22。
*   clock() 返回值 21000、22000，粒度相同。
*   getrusage() 正在返回诸如 210002、22001 （和类似的）之类的值，它们看起来有更好的准确性，但这些值看起来明显相同。

所以现在我可能遇到的问题是内核有我需要的信息，我只是不知道将返回它的系统调用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T16:11:39.243

有关更多信息，请参阅[此问题。](https://stackoverflow.com/questions/275004/c-timer-function-to-provide-time-in-nano-seconds)

我用过的东西是gettimeofday()。它提供了具有秒和微秒的结构。在代码之前调用它，然后再调用它。然后只需使用 timersub 减去这两个结构，您就可以从 tv_usec 字段中获取以秒为单位的时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T18:09:47.900

如果您正在寻找这种级别的时序分辨率，您可能正在尝试进行一些微优化。如果是这种情况，您应该查看[PAPI](http://icl.cs.utk.edu/papi/)。它不仅提供挂钟和虚拟（仅限进程）计时信息，还提供对 CPU 事件计数器的访问，当您试图提高性能时，这可能是必不可少的。

[http://icl.cs.utk.edu/papi/](http://icl.cs.utk.edu/papi/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T14:49:11.430

如果您需要非常小的时间单位来（我假设）测试您的软件的速度，我建议您只在循环中运行您想要计时的部分数百万次，在循环前后花费时间并计算平均值. 这样做的一个很好的副作用（除了不需要弄清楚如何使用纳秒之外）是您将获得更一致的结果，因为由 os 调度程序引起的随机开销将被平均化。

当然，除非您的程序不需要能够在一秒钟内运行数百万次，否则如果您无法测量毫秒的运行时间，它可能已经足够快了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T14:50:56.280

我相信 CFC（[完全公平调度程序](http://en.wikipedia.org/wiki/Completely_Fair_Scheduler)）是您正在寻找的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T14:57:55.487

如果您有一个相当新的 2.6 内核，则可以使用高精度事件计时器 ( [HPET )。](http://en.wikipedia.org/wiki/HPET)查看[Documentation/hpet.txt](http://www.mjmwired.net/kernel/Documentation/hpet.txt)以了解如何使用它。这个解决方案虽然依赖于平台，但我相信它只适用于较新的 x86 系统。HPET 至少有一个 10MHz 的定时器，所以它应该很容易满足您的要求。

我相信飞思卡尔的几个 PowerPC 实现也支持周期精确指令计数器。几年前我用它来分析高度优化的代码，但我不记得它叫什么了。我相信飞思卡尔有一个内核补丁，你必须应用它才能从用户空间访问它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T16:53:42.833

[http://allmybrain.com/2008/06/10/timing-cc-code-on-linux/](http://allmybrain.com/2008/06/10/timing-cc-code-on-linux/)

可能对你有帮助（如果你是用 C/C++ 直接做的，但我希望即使你不是，它也会给你指点）......它声称提供微秒精度，这只是通过你的标准。:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T10:53:36.367

我想我找到了我正在寻找的内核补丁。把它贴在这里，这样我就不会忘记链接：

[http://user.it.uu.se/~mikpe/linux/perfctr/](http://user.it.uu.se/~mikpe/linux/perfctr/) [http://sourceforge.net/projects/perfctr/](http://sourceforge.net/projects/perfctr/)

编辑：它适用于我的目的，虽然不是很用户友好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T19:13:48.037

试试 CPU 的[时间戳计数器](http://en.wikipedia.org/wiki/Time_Stamp_Counter)？维基百科似乎建议使用clock_gettime()。

# asp.net - 我可以将 ASP.NET Web 服务升级到 WCF 并仍然从 ASP.NET 1.1 调用它吗？

> ID：182558
> 
> 赞同：2
> 
> 时间：2008-10-08T12:48:57.197
> 
> 标签：asp.net, wcf, web-services

我需要对几年前在 2.0 上编写的 ASP.NET Web 服务进行更改。我从一个旧的 1.1 网站调用此 Web 服务。我需要对 Web 服务进行一些更改，所以我在想，我是否应该将其重写为 WCF 服务，如果是这样，我仍然可以从我的 1.1 网站使用它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T13:14:47.707

您可以使 WCF 服务的行为和行为与传统的 1.1 ASMX Web 服务一样，但这是您想要的吗？

我认为您需要问问自己 WCF 的哪些功能会促使您升级。
您还想将服务公开为 REST-ful 服务吗？您是否需要实现消息级别的安全性？

如果只是为了最新技术而使用最新技术，如果您对消息和协议安全性的要求不高并且您主要使用微软技术，我会说坚持使用 ASMX Web 服务。

遗憾的是，编写 WCF 服务比编写普通的 asmx Web 服务要困难得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T13:16:48.217

是的，这会起作用。您的服务至少需要 .net 3.0，但只要您使用 basicHttpBinding 或 wsHttpBinding，您就可以像使用任何其他 Web 服务一样使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T16:02:45.213

是的，您可以...确保选择正确的绑定和身份验证方法

# networking - 从服务访问网络共享

> ID：182564
> 
> 赞同：1
> 
> 时间：2008-10-08T12:50:08.753
> 
> 标签：networking, service

我正在创建一个需要在 Windows 2000、XP、2003、2008 和 Vista 上运行的服务。该服务需要访问网络共享作为其处理的一部分。对于 XP 及更高版本，该服务可以作为网络服务帐户运行，但在 Windows 2000 中等效的是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T12:59:46.007

在 Windows 2000 中，没有具有所需权限的内置主体，为此您需要使用普通用户帐户（当然，它确实需要启用“作为服务运行”权限，但是通过服务控制管理器用户界面输入帐户凭据时会自动处理）。

顺便说一句，使用命名帐户总是一个好主意：虽然在部署服务时使用“网络服务”非常方便（因为不需要用户交互），但服务连接到的网络共享*也*需要应用访问权限它。

这是您可能会遇到问题的地方，因为将这些访问权限授予“网络服务”并不是很精细。换句话说：不仅您的服务，而且在这些凭据下运行的所有其他服务都可以访问该共享。开始使用唯一帐户时，可以避免此问题。

# sql - Sybase 表中的行号

> ID：182569
> 
> 赞同：1
> 
> 时间：2008-10-08T12:51:23.057
> 
> 标签：sql, sybase

Sybase db 表没有自更新行号的概念。但是，对于其中一个模块，我需要存在与数据库中的每一行相对应的行号，这样 max(Column) 总是会告诉我表中的行数。

我想我会引入一个 int 列并不断更新此列以跟踪行号。但是，如果发生删除，我在更新此列时遇到问题。我应该在删除触发器中使用什么 sql 来更新此列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T13:28:22.810

您可以使用标识列轻松地为每一行分配一个唯一编号。标识可以是数字或整数（在 ASE12+ 中）。

这*几乎*可以满足您的要求。在某些情况下，您会在身份序列中出现缺口。（这些被称为“身份差距”，关于它们的最佳讨论在[这里](http://www.sypron.nl/idgaps.html)）。正如您所确定的，删除也会导致序列中的间隙。

为什么你需要使用 max(col) 来获取表中的行数，而你可以只使用 count(*)？如果您试图从表中获取最后一行，那么您可以这样做

```
select * from table where column = (select max(column) from table). 
```

关于更新手动管理的列的删除触发器，我认为这将是死锁和许多性能问题的潜在来源。假设您的表中有 100 万行，并且您删除了第 1 行，即您现在必须更新 999999 行以从 id 中减去 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T15:56:05.103

我不确定你为什么要这样做。您可以尝试使用临时表并使用如下所示[的 Identity 列“选择” 。](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_12.5.sqlug/html/sqlug/sqlug345.htm)

```
create table test
 ( 
 col1 int,
 col2 varchar(3)
 )

 insert into test values (100, "abc")
 insert into test values (111, "def")
 insert into test values (222, "ghi")
 insert into test values (300, "jkl")
 insert into test values (400, "mno")

select rank = identity(10), col1 into #t1 from Test
select * from #t1

delete from test where col2="ghi"

select rank = identity(10), col1 into #t2 from Test
select * from #t2

drop table test
drop table #t1
drop table #t2 
```

这会给你一个动态的ID（排序）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T12:44:17.407

## 删除触发器

```
CREATE TRIGGER tigger ON myTable FOR DELETE
AS 
update myTable 
set id = id - (select count(*) from deleted d where d.id < t.id)  
from myTable t 
```

## 避免锁定问题

您可以像这样添加一个额外的表（连接到您的主表）：

```
CREATE TABLE rowCounter 
(id    int,      -- foreign key to main table
 rownum int) 
```

...并使用此表中的 rownum 字段。
如果您将删除触发器放在此表上，那么您将大大减少锁定问题的可能性。

## 近似解决方案？

表是否需要始终保持其行号是最新的？
如果没有，您可以有一个每分钟左右运行一次的作业，它检查 rownum 中的间隙并进行更新。

问题：行号是否必须反映插入行的顺序？
如果没有，您可以进行更少的更新，但只更新最近的行，将它们“移动”到间隙中。

如果您希望我为这些想法发布任何 SQL，请发表评论。

# ruby-on-rails - 在带有 RoR 的大项目中使用 ExtJS 的危险？

> ID：182571
> 
> 赞同：22
> 
> 时间：2008-10-08T12:51:34.913
> 
> 标签：ruby-on-rails, ruby, extjs, ria, rich-internet-application

我们正在使用 Ruby on Rails 框架（CRM 系统）开发一个相当大的应用程序，并且正在考虑重写它以使用 ExtJS，这样 Rails 就可以只处理数据，而 ExtJS 会以类似桌面的方式完成所有浏览器的繁重工作。

任何人都对什么是最好的方法有一些经验和提示？ExtJS 是否足够成熟，可以在相对较大（和复杂）的应用程序中使用？那么 Rails 部分呢？这里最好的方法是什么？

编辑：

只是为了说清楚。我宁愿以这样一种方式做到这一点，即一次加载所有 javascript 客户端应用程序代码（在应用程序启动时，最好作为一个压缩的 js 文件），然后只使用 ajax 向 Rails 发送数据和从 Rails 发送数据应用程序。此外，如果 ERB 可用于动态生成 Ext 应用程序元素，那就太好了。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-08T17:28:12.243

我目前有一个用 ExtJS 编写的非常大的桌面风格应用程序。它曾经运行在 Perl 的 Catalyst MVC 框架之上，但是一旦整个 View 层转换为基于 ExtJS 的桌面，我就开始迁移到 Ruby on Rails 模型和控制器。它同样快，即使不是更快，也更容易维护，并且代码库要小得多。

*   确保您将活动记录配置设置为在 json 中不包含模型的根名称，以便 Ext 的 JsonStore 读取记录没有问题。ActiveRecord BASE 上有一个选项叫`include_root_in_json`你必须设置为 false。

*   确保您在 Ext 中正确定义了您的应用程序类并最大化代码重用，并且您将需要某种方法来清理 DOM 中未使用的节点。除非您使用的是最新版本的 Safari 或 Firefox 3.1，否则 Javascript 性能可能会非常痛苦。

*   您可能需要某种缓存方法，以便在页面加载时以 JSON 格式将服务器上的数据提供给您的应用程序。这将减少通过 Ajax 的往返次数。

*   绝对使用 Ext 的 WindowManager 和 StoreManager 对象，或者从 Ext.util.MixedCollection 推出你自己的对象

*   在单独的、可管理的文件中开发您的代码，然后有一个构建过程将它们组合成一个文件，然后在其上运行 YUI 的压缩器或 Dean Edwards Packer 来压缩/混淆文件。在它们自己的单个文件中提供所有 JS 和 CSS，包括 Ext 提供的文件。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-09T08:49:46.353

**[2012 更新]** ExtJS 被[Sencha 收购，后者提供 GPLv3 许可证](http://www.sencha.com/products/extjs/license/)和两个商业许可证。

[2008 年-10 月评论] ExtJS 在技术方面非常出色，但是几个月前许可的惨败让我开始关注其他框架——我现在根本不信任 ExtJS 的创建者。我不喜欢他们如何措辞他们的许可证，以及他们如何伪装成开源倡导者，同时显然试图不公平地从那些相信他们的人身上获利。

我只是出于道德原因反对使用 ExtJS。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-18T12:57:56.320

这属于对米兰对我之前回答的评论的回答，但作为一个新来者，我没有足够的声誉点来回复：

“sp 未定义”存在问题，这是由于 Rails 将 JavaScript 文件缓存到一个大文件中（否则会有数百个文件）。缓存引入了一些带有换行符的奇怪错误，这些错误使整个事情都失败了。这让我费了好一阵子，但解决方案是将 Ruby 从 1.8.6（补丁级别 72）更新到最新的 1.8.7。这解决了问题，因此如果您想查看，请再次检查（您需要完全刷新才能击败资产缓存）。

我很高兴你以前遇到过 Ext MVC 的东西。目前我可以完全相信它一定很难理解，主要是由于缺乏示例、教程和演示。然而，代码本身的文档记录得相当好（至少无论如何更新的代码，有很多需要清除）。

我目前正在重构一些关键类，然后才准备好进行适当的“发布”。当一切准备就绪时（我想几个星期），我将生成文档并建立一个包含一些演示和示例代码的快速站点。完成后，我会在我的博客 ( [http://edspencer.net](http://edspencer.net) ) 上发表一篇文章。

我的目标是尝试提供一个框架，使编写这种类型的应用程序变得更加简单，并建立一些约定。目前对于构建 ExtJS 应用程序没有达成共识或默认的方式，所以我们可以做的任何事情来推动这将是朝着正确方向迈出的一步！非常欢迎评论和贡献。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-12T13:26:07.263

我已经成功部署了您描述的那种大型 RoR/ExtJS 应用程序（“单页”客户端 AJAX 驱动）。Ext_scaffold 几乎是一个红鲱鱼。

让 RoR 和 ExtJS 一起顺利工作并不太费力。根本的选择是是否将 ExtJS 扩展为“说 Rails”，修补 RoR 以“说 ExtJS”，或者在中间相遇。这将取决于您的团队的技能在哪里。

我采用了中间相遇策略，其中包括：

*   扩展`Ext.data.Store`并`Ext.data.Record`了解 Rails 路由约定
*   破解`Ext.grid.EditorPanel`并`Ext.form.BasicForm`与 ActiveRecord 关联打好
*   编写一些模块来扩展`ActiveRecord::Base`和简单地从和`ApplicationController`提交`Ext.grid.EditorPanel``Ext.form.BasicForm`

差不多就是这样。

话虽如此，ExtJS 也有缺点。

*   你将不得不在内部弄脏你的手。不要被演示所迷惑。
*   社区文档很差并且以 PHP 为中心。
*   来自以 Github/Lighthouse 为中心的 RoR 世界，使用 VBulletin 就像在 1998 年醒来。我的意思是，没有公开的 bugtracker，只是一个更新的论坛帖子（WTF？）。
*   代码有点过度设计。
*   该团队失去了开源的可信度，因此他们失去了开源的氧气。
*   该团队似乎专注于与 GWT 的集成（谁能说“enterpri$ey”？）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T21:24:02.223

您可能想看看 Netzke 框架，它被认为是这样做的：促进创建复杂的单页 Web 应用程序，并强调模块化方法。

Netzke 的优势在于：

*   代码的可重用性和可扩展性。一旦你制作了你的组件（客户端和服务器端），你可以在任何地方重用它，与其他组件结合，或者通过继承来扩展它。

*   效率。每个组件的类只从服务器加载（并评估）一次，这节省了服务器-客户端通信的大量时间。

*   它是开源的，并且正在积极开发中。它有现场演示和示例代码。

*   它具有预构建的组件，您可以直接使用，甚至无需接触 Ext JS（只需在 Rails 中配置它们）

*   它已（由其作者）用于复杂物流应用程序的实际开发。

Netzke的缺点是：

*   代码还很年轻，社区很小。

如果您有兴趣，请在此处查看描述和设计详细信息：[https ://github.com/nomadcoder/netzke-core](https://github.com/nomadcoder/netzke-core)

现场演示/教程可以在这里找到：http: [//netzke-demo.herokuapp.com](http://netzke-demo.herokuapp.com)和这里：http: [//yanit.heroku.com](http://yanit.heroku.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T12:58:35.257

Ext 绝对足够成熟来处理这种情况。我目前正在开发一个带有很多 Ext 的 Rails 项目，最难的部分肯定是使用 Rails`to_json`来渲染 Ext 可以读取的 JSON（对于数组、哈希、模型，验证失败等）

查看`scaffold`Rails 的 ext_ 插件。我从这个开始并破解了它的`ActiveRecord`/`ActionView`扩展，直到它完成了我需要它做的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T08:21:30.887

我也有一些使用 ExtJS 和 Rails 的经验。使用该框架是免费获得一些漂亮小部件的好方法。如果您使用它来开发单页应用程序，REST 约定也应该与框架很好地配合。也适用于 RJS。

这是我对使用框架的抱怨

1.  您不能真正使用 flash[:notice]，因为重新加载单页应用程序很愚蠢。这使得传递验证通知和消息成为一件苦差事，因为您必须使用 RJS/javascript 方法来显示它们。

2.  你不能太多地使用erb，因此你必须将很多逻辑封装到json回调中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T13:52:39.500

我已经为许多应用程序部署了 ExtJS 和 Rails，它们当然可以相互通信。我们在[http://demo.domine.co.uk/admin](http://demo.domine.co.uk/admin)上汇总了我们目前在 Rails + Ext 中开发的应用程序的快速演示。暂时忽略前端，因为它不完整 - 管理部分基本上已经完成，您可以使用以下命令登录：

用户名：edward 密码：rarrar

由于演示还没有完全完成，我不能保证它在这个阶段除了 Firefox 之外的任何东西都能正常工作。它没有理由不在其他浏览器中工作，我只是还没有花时间测试它们。重点更多是关于与 Rails 的集成。

开始菜单上的每个应用程序都通过 JSON 与 Rails 后端交互。我已经编写了一个基本的 Rails 插件来为我们完成大部分工作。我将很快发布其背后的代码，但现在希望这能让您了解这两种技术如何协同工作......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T08:55:23.860

虽然我没有使用 ExtJS 的经验（除了阅读“ [Practical Rails Projects](http://www.amazon.co.uk/Practical-Rails-Projects-Experts-Voice/dp/1590597818/ref=sr_1_5?ie=UTF8&s=books&qid=1223974401&sr=8-5) ”一书中的内容），但我使用带有[jrails](http://ennerchi.com/)的 jQuery [Flexigrid](http://webplicity.net/flexigrid/)来获得更多的桌面感觉。

那工作得很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-08T05:40:43.833

行。我在很多项目中使用 extjs gxt gwt，开发起来非常容易。但我想告诉你，我用 extjs+gwt (gxt) 构建了我的项目，我不确定 Ruby。 [链接文本](http://extjs-gwt.blogspot.com/)

# winforms - PowerShell：CLI 或 GUI - 您需要或更喜欢哪个？

> ID：182573
> 
> 赞同：0
> 
> 时间：2008-10-08T12:51:47.987
> 
> 标签：winforms, command-line, powershell, scripting, automation

PowerShell v1.0 显然是一个基于控制台的管理 shell。它实际上并不需要 GUI 界面。如果需要，例如 Exchange 2007 管理 GUI，它构建在 PowerShell 之上。您可以在 PowerShell 脚本中使用 Windows 窗体创建自己的 GUI。我的问题是，“您认为添加一个简单的图形界面最适合哪种 PowerShell 脚本或管理任务？您创建了 winform 来完成什么？”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-19T20:38:51.973

为了回答[蒙库特的建议](https://stackoverflow.com/questions/182573/powershell-cli-or-gui-which-do-you-need-or-prefer#185822)，这里有一个使用 WindowsForms 获取文件路径的简单函数`OpenFileDialog`：

```
[void] [Reflection.Assembly]::LoadWithPartialName( 'System.Windows.Forms' )

function Select-File( [string]$initialDirectory=$pwd, [switch]$multiselect ) {
  $dialog = New-Object Windows.Forms.OpenFileDialog
  $dialog.ShowHelp = $true  # http://tinyurl.com/6cnmrr
  $dialog.InitialDirectory = $initialDirectory
  $dialog.Multiselect = $multiselect

  if( $dialog.ShowDialog( ) -eq 'OK' ) { $dialog.FileNames }
  $dialog.Dispose( )
} 
```

我也尝试过创建一个类似的`Select-Directory`功能，但是在 PowerShell v1 中， [`FolderBrowserDialog`STA 线程的要求](https://stackoverflow.com/questions/216817/call-folderbrowserdialog-from-powershell)是相当困难的。

* * *

**编辑：**感谢[Gordon](https://stackoverflow.com/questions/216817/call-folderbrowserdialog-from-powershell#217527)`FolderBrowserDialog` ，这是一个显示使用 COM的解决方法：

```
function Select-Directory( ) {
  $app = New-Object -COM Shell.Application
  $directory = $app.BrowseForFolder( 0, "Select Directory", 0 )
  $path = $directory.Self.Path
  if( $path ) { return $path }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T03:22:15.077

我最喜欢的命令行 shell 旧 gui 工具是一个选择目录工具，当从命令行执行时会打开一个 gui 目录选择对话框。当您必须 cd 到具有长路径名的其他目录时，非常有帮助。

不幸的是，我找不到以前使用的旧 exe 工具。（无论如何它是pre-powershell）另外，我对powershell还不够熟悉，无法弄清楚如何直接从powershell调用对话框并将其设为cmd-let或其他任何东西，但这就是我正在谈论的一些python混入。

这里是：

```
PS D:\> $dir = & "C:\python25\python.exe" "C:\python25\selectdir.pyw"; cd $dir;
# Directory selection dialog opens here, user selects the directory to goto.
PS D:\NewDirectory> 
```

和python代码：

```
import Tkinter
import tkFileDialog

root = Tkinter.Tk()
root.withdraw()
dirname = tkFileDialog.askdirectory(parent=root)

print dirname 
```

我想再次拥​​有这个工具，如果有人知道如何清理它，那么我可以调用一个命令，如“cdir”或请评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T14:28:34.173

Isnt this mainly used by powershell guys who want to make there scripts pretty before handing to users or people who know nothing about a console and like pretty pictures ?!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T14:41:51.353

我会前往 PowerGUI 站点，我相信您已经知道 Jeff。用户在那里做的事情是我认为的 powershell 和 GUI 融合的范例。能够生成对象列表，然后深入了解对象的层次结构，或在对象上运行脚本。这种事情就是我会看到 GUI 界面大放异彩的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T01:47:04.410

我对这里的一些示例抱有希望，因为我确信如果他们有漂亮的 UI 并且可以用鼠标使用，我可以委派很多任务。

但就添加用户界面而言，我很难想出一个没有用户界面的地方。我能想到的大多数示例要么只是简化或暴露现有 UI 的选定部分。它们通常只是与现有数据不同的视图，这些数据不存在，或者在提供的管理控制台中很难看到。或者它们通过循环或流水线扩展某些功能（如果需要，您仍然可以使用鼠标更改 200 个文件的名称）。我所做的几乎所有仍在使用的事情要么是一次性脚本，要么是某个地方的计划任务。

我在等待想法:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T07:30:45.823

实际上，更多地考虑这一点，在我看到的使用 GUI 的示例中，它们似乎是多个输入前端，这比带有多个开关的命令行容易得多，这些开关可能很长且难以可视化。

# asp.net - 将 Javascript 与 ASP.Net 控件一起使用

> ID：182587
> 
> 赞同：2
> 
> 时间：2008-10-08T12:56:40.067
> 
> 标签：asp.net, javascript, events

在使用 ASP.Net 控件时设置客户端“onclick”事件是否有最佳实践？简单地添加 onclick 属性会导致 Visual Studio 警告 onclick 不是该控件的有效属性。在 Page_Load 事件期间通过代码隐藏添加它是可行的，但没有我想要的那么清楚。

只有这两个选择吗？有没有我想念的正确方法来做到这一点？

谢谢！埃里克·斯普尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T13:09:32.193

`**`*只是对答案的预先说明：VS中的HTML验证通常是BS。它抱怨 IRL 有效的东西，即使这些东西是不好的做法。但有时你必须改变规则才能完成任务。*

每个 ASP.NET 页面（2.0 和更高版本）都带有一个[ClientScriptManager](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.aspx)。您可以使用它从服务器端代码注册 javascript。当页面上的 HTML 控件都存在于 DOM 中时，您可以在页面加载后传入在控件上注册事件的 javascript。

它在页面上提供了一个单一、统一的位置来动态添加 javascript，这不是一件坏事。然而，它非常丑陋。

在这个 ASP.NET 服务器控件模型消亡的时代，您可能希望按照 ASP.NET MVC 的未来方式设置事件。[获取jQuery](http://jquery.com)的副本并将其添加到您的网站。然后，您可以轻松地注册您的活动：

```
 <html>
  <head>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $("controlId").bind("click", function(e) { /* do your best here! */ });
      });
    </script>
  </head>
  <!-- etc -->
  </html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T13:14:53.447

您可以通过 Javascript 将事件添加到所需的 HTML 元素中。这是最干净的方式，因为它不会混合服务器和客户端技术。此外，这种方式可以将许多处理程序注册到同一个事件（与 onclick 属性相反）。

基本上，代码将是

```
document.getElementById('myLovelyButtonId').attachEvent('onclick',doSomething) 
```

对于 Internet Explorer 和

```
document.getElementById('myLovelyButtonId').addEventListener('click',doSomething,false) 
```

对于其他浏览器。（doSomething 是一个事件处理程序 - JavaScript 函数）。这些调用应该在*窗口加载*事件处理程序中进行

考虑阅读[有关 Quirksmode 的高级活动注册文章以](http://quirksmode.org/js/events_advanced.html)获取更多信息。

另外，考虑使用像[jQuery](http://jquery.com/)这样的库。这样，语句将变为

```
$('#myLovelyButtonId').click(
    function doSomething () {
        alert('my lovely code here');
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T13:08:31.870

设置值`WebControl.Attributes["onclick"]`是可以的。如果 ASP.NET 需要客户端`click`处理程序，它将连接值，以分号分隔。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-19T11:43:41.770

修正语法或拼写错误。

澄清意义而不改变它。

纠正小错误。

添加相关资源或链接。

永远尊重原作者。

# mysql - mod_perl 下的 MySQL 驱动程序段错误 - 在哪里寻找问题

> ID：182592
> 
> 赞同：5
> 
> 时间：2008-10-08T12:58:10.970
> 
> 标签：mysql, perl, mod-perl

我有一个 web 应用程序，当数据库重新启动并尝试使用旧连接时会出现段错误。在下运行它`gdb --args apache -X`会导致以下输出：

```
Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1212868928 (LWP 16098)]
0xb7471c20 in mysql_send_query () from /usr/lib/libmysqlclient.so.15 
```

我检查了驱动程序和数据库是否都是最新的（[DBD::mysql](http://search.cpan.org/dist/DBD-mysql/ "DBD::mysql") 4.0008，MySQL 5.0.32-Debian_7etch6-log）。

恼人的是，我无法用一个简单的脚本来重现这个：

```
use DBI;
use Test::More tests => 2;

my $dbh = DBI->connect( "dbi:mysql:test", 'root' );

sub test_db {
    my ($number) = $dbh->selectrow_array("select 1 ");
    return $number;
}

is test_db, 1, "connected to db";

warn "restart db now";
getc;

is test_db, 1, "connected to db"; 
```

这给出了以下内容：

```
ok 1 - connected to db
restart db now at dbd-mysql-test.pl line 23.

DBD::mysql::db selectrow_array failed: MySQL server has gone away at dbd-mysql-test.pl line 17.
not ok 2 - connected to db
#   Failed test 'connected to db'
#   at dbd-mysql-test.pl line 26.
#          got: undef
#     expected: '1' 
```

这行为正确，告诉我请求失败的原因。

让我难过的是它是段错误，它不应该这样做。由于它似乎只在整个应用程序运行（使用[DBIx::Class](http://search.cpan.org/dist/DBIx-Class "DBIx::类")）时发生，因此很难将其简化为测试用例。

我应该从哪里开始调试呢？有没有其他人看过这个？

**更新**：进一步的刺激表明它在 mod_perl 之下是一个红鲱鱼。将其简化为一个简单的测试脚本后，我现在已将其发布到[DBI 邮件列表](http://www.mail-archive.com/dbi-users@perl.org/msg31416.html)。感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T13:30:50.483

这可能意味着您的 mod_perl 环境与您通过脚本测试的环境之间存在差异。需要检查的一些事项：

*   你的 mod_perl 是用相同版本的 Perl 编译的吗

*   两者的@INC 是否相同

*   你在你的 mod_perl 设置中使用线程吗？我不相信 DBD::mysql 是完全线程安全的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T22:31:10.673

我已经看到了这个问题，但我不确定它与您的原因相同。您是否偶然使用某个模块从您的应用程序中发送邮件（忘记名称，抱歉）？当我们在一个项目中遇到问题时，经过几天的调试，我们发现这个邮件模块对打开的文件描述符做了奇怪的事情，然后分叉了另一个名为控制台工具 sendmail 的进程，它再次对文件描述符做了奇怪的事情。我猜它弄乱的文件描述符之一是与数据库的连接，但我仍然不确定。当我们切换到另一个模块发送邮件时，问题就消失了。也许它也值得你看看。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T07:12:36.313

如果您遇到段错误，您是否有一个核心文件？如果没有，请检查 ulimit -c。如果返回 0，您的系统将不会创建核心文件，您必须更改它。如果您确实有核心文件，则可以使用 gdb 或类似工具对其进行调试。这不是特别*有趣*，但有可能。该命令的开头将类似于：

```
gbd /usr/bin/httpd core 
```

有很多教程用于[调试](http://www.google.com/search?hl=en&q=debugging+core+files&btnG=Search)分散在 Web 上的核心文件。

更新：刚刚找到了[确保您从 mod_perl 获得核心转储](http://modperlbook.org/html/21-6-3-Dumping-the-core-File.html)的参考。那应该有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-15T22:56:28.493

这是旧 DBD::mysql 中的一个已知问题。升级它（4.008*不是*最新的）。

[https://rt.cpan.org/Public/Bug/Display.html?id=37027](https://rt.cpan.org/Public/Bug/Display.html?id=37027)附有一个简单的测试脚本 ，将触发此错误。

# java - 如何在Java中将视频输出到纹理？

> ID：182594
> 
> 赞同：2
> 
> 时间：2008-10-08T12:58:37.287
> 
> 标签：java, video, textures

我需要在我的游戏中播放视频，并且视频必须在纹理中，以便在游戏世界中播放。

我正在使用 Java（Java3D，JOGL）。关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T13:06:08.830

使用您需要的任何编解码器解码视频（在 Java 中这可能需要 JNI）。将输出数据（通常是像素数据的一些缓冲区）复制到纹理。以所需的帧速率重复。

# performance - 是否应该在 for 循环中使用 < 或 <=

> ID：182600
> 
> 赞同：128
> 
> 时间：2008-10-08T12:59:56.817
> 
> 标签：performance, conventions, readability

如果您必须遍历一个循环 7 次，您会使用：

```
for (int i = 0; i < 7; i++) 
```

或者：

```
for (int i = 0; i <= 6; i++) 
```

有两个考虑：

*   表现
*   可读性

为了性能，我假设使用 Java 或 C#。使用“小于”或“小于或等于”是否重要？如果您对其他语言有见解，请指出是哪一种。

为了便于阅读，我假设基于 0 的数组。

**UPD：**我提到的基于 0 的数组可能会让人感到困惑。我不是在谈论遍历数组元素。只是一个一般的循环。

下面有一个很好的观点，即使用一个常数来解释这个幻数是什么。所以如果我有“ `int NUMBER_OF_THINGS = 7`”，那么“ `i <= NUMBER_OF_THINGS - 1`”会看起来很奇怪，不是吗。

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2008-10-08T13:03:44.750

第一个是更[惯用](http://en.wiktionary.org/wiki/idiomatic)的。特别是，它表示（在基于 0 的意义上）迭代次数。当使用基于 1 的东西（例如 JDBC、IIRC）时，我可能会想使用 <=。所以：

```
for (int i=0; i < count; i++) // For 0-based APIs

for (int i=1; i <= count; i++) // For 1-based APIs 
```

我希望在实际代码中性能差异很小。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2008-10-08T13:02:32.253

这两个循环都迭代了 7 次。我会说带有 7 的那个更易读/更清晰，除非你对另一个有很好的理由。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2008-10-08T13:30:32.823

我记得我们在大学做 8086 组装的时候，它的性能更高：

```
for (int i = 6; i > -1; i--) 
```

因为有一个[JNS](http://tic01.tic.ec-lyon.fr/~muller/trotek/cours/8086/JNS.html.en)操作意味着如果没有符号则跳转。使用这意味着在每个周期之后没有内存查找来获取比较值，也没有比较。如今，大多数编译器都优化了寄存器的使用，因此内存不再重要，但您仍然可以获得不需要的比较。

顺便说一句，将 7 或 6 放入循环中就是引入了一个“[幻数](http://en.wikipedia.org/wiki/Magic_number_(programming))”。为了更好的可读性，您应该使用带有 Intent Revealing Name 的常量。像这样：

```
const int NUMBER_OF_CARS = 7;
for (int i = 0; i < NUMBER_OF_CARS; i++) 
```

编辑：人们没有得到组装的东西，所以显然需要一个更完整的例子：

如果我们为 (i = 0; i <= 10; i++) 你需要这样做：

```
 mov esi, 0
loopStartLabel:
                ; Do some stuff
    inc esi
                ; Note cmp command on next line
    cmp esi, 10
    jle exitLoopLabel
    jmp loopStartLabel
exitLoopLabel: 
```

如果我们为 (int i = 10; i > -1; i--) 做，那么你可以摆脱这个：

```
 mov esi, 10
loopStartLabel:
                ; Do some stuff
    dec esi
                ; Note no cmp command on next line
    jns exitLoopLabel
    jmp loopStartLabel
exitLoopLabel: 
```

我刚刚检查了一下，微软的 C++ 编译器没有做这个优化，但如果你这样做了：

```
for (int i = 10; i >= 0; i--) 
```

所以道德是，如果您使用的是 Microsoft C++†，并且升序或降序没有区别，要获得一个快速循环，您应该使用：

```
for (int i = 10; i >= 0; i--) 
```

而不是其中任何一个：

```
for (int i = 10; i > -1; i--)
for (int i = 0; i <= 10; i++) 
```

但坦率地说，获得“for (int i = 0; i <= 10; i++)”的可读性通常比错过一个处理器命令重要得多。

† 其他编译器可能会做不同的事情。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-10-08T13:02:54.250

我总是使用 <array.length，因为它比 <= array.length-1 更容易阅读。

也有 < 7 并且假设您知道它以 0 索引开始，因此该数字是迭代次数应该很直观。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-10-08T13:04:32.017

从优化的角度来看，这并不重要。

从代码风格的角度来看，我更喜欢 < 。原因：

```
for ( int i = 0; i < array.size(); i++ ) 
```

可读性比

```
for ( int i = 0; i <= array.size() -1; i++ ) 
```

< 也可以立即为您提供迭代次数。

对 < 的另一个投票是，您可以防止许多意外的错误。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-08T16:03:29.130

@Chris，您关于 .Length 在 .NET 中成本高昂的说法实际上是不真实的，在简单类型的情况下恰恰相反。

```
int len = somearray.Length;
for(i = 0; i < len; i++)
{
  somearray[i].something();
} 
```

实际上比

```
for(i = 0; i < somearray.Length; i++)
{
  somearray[i].something();
} 
```

后者是运行时优化的案例。由于运行时可以保证 i 是数组的有效索引，因此不会进行边界检查。在前者中，运行时不能保证 i 在循环之前没有被修改，并强制对数组进行边界检查以进行每次索引查找。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-08T13:02:16.797

就性能而言，它没有有效的区别。因此，在您正在解决的问题的上下文中，我会使用更容易理解的那个。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-08T13:03:11.083

我更喜欢：

```
for (int i = 0; i < 7; i++) 
```

我认为这更容易转化为“迭代循环 7 次”。

我不确定性能影响 - 我怀疑任何差异都会被编译掉。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-08T14:56:59.497

在 C++ 中，我更喜欢 using `!=`，它适用于所有 STL 容器。并非所有 STL 容器迭代器都具有可比性。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-08T13:02:52.613

在 Java 1.5 中你可以这样做

```
for (int i: myArray) {
    ...
} 
```

所以对于数组的情况你不需要担心。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-08T13:03:09.790

我不认为有性能差异。第二种形式肯定更具可读性，您不必在心里减去一个即可找到最后一个迭代次数。

**编辑：**我看到其他人不同意。就我个人而言，我喜欢查看循环结构中的实际索引号。也许是因为它更让人想起 Perl 的`0..6`语法，我知道它相当于`(0,1,2,3,4,5,6)`. 如果我看到一个 7，我必须检查它旁边的运算符，看看实际上，索引 7 永远不会到达。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-08T13:09:20.323

我会说使用“< 7”版本，因为这是大多数人会阅读的内容 - 所以如果人们略读您的代码，他们可能会错误地解释它。

我不担心“<”是否比“<=”快，只是为了可读性。

如果您确实想提高速度，请考虑以下事项：

```
for (int i = 0; i < this->GetCount(); i++)
{
  // Do something
} 
```

为了提高性能，您可以将其稍微重新排列为：

```
const int count = this->GetCount();
for (int i = 0; i < count; ++i)
{
  // Do something
} 
```

请注意从循环中删除 GetCount()（因为将在每个循环中查询）以及“i++”更改为“++i”。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-08T21:17:15.593

Edsger Dijkstra在 1982 年[写了一篇](http://www.cs.utexas.edu/users/EWD/transcriptions/EWD08xx/EWD831.html)关于此的文章，他主张 lower <= i < upper：

> 有一个最小的自然数。排除下界（如 b）和 d）中的下界会强制从最小自然数开始的子序列将下界作为非自然数领域中提到的。这很难看，所以对于下界，我们更喜欢 a) 和 c) 中的 ≤。现在考虑从最小自然数开始的子序列：包含上限将迫使后者在序列缩小到空序列时变得不自然。这很难看，所以对于上限，我们更喜欢 < ，如 a) 和 d)。我们得出结论，约定 a) 是首选。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-08T14:09:39.233

首先，不要使用 6 或 7。

更好地使用：

```
int numberOfDays = 7;
for (int day = 0; day < numberOfDays ; day++){

} 
```

在这种情况下，它比使用更好

```
for (int day = 0; day <= numberOfDays  - 1; day++){

} 
```

更好（Java / C#）：

```
for(int day = 0; day < dayArray.Length; i++){

} 
```

甚至更好（C#）

```
foreach (int day in days){// day : days in Java

} 
```

反向循环确实更快，但由于它更难阅读（如果不是你被其他程序员阅读），最好避免使用。尤其是在 C#、Java 中......

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-08T13:05:02.843

我同意人群说 7 在这种情况下是有意义的，但我要补充一点，在 6 很重要的情况下，说你想明确你只对第 6 个索引的对象起作用，然后<= 更好，因为它使 6 更容易看到。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-08T13:05:40.453

回到大学时，我记得这两个操作在 CPU 上的计算时间相似。当然，我们是在装配级别进行讨论。

但是，如果您在谈论 C# 或 Java，我真的不认为其中一个会比另一个提高速度，您获得的几纳秒很可能不值得您引入任何混淆。

就个人而言，我会编写从业务实现角度来看有意义的代码，并确保它易于阅读。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-08T13:14:41.043

顺便说一句，在.Net中循环遍历数组或其他集合时，我发现

```
foreach (string item in myarray)
{
    System.Console.WriteLine(item);
} 
```

比数字 for 循环更具可读性。这当然假设循环代码中没有使用实际的计数器 Int 本身。不知道性能有没有变化。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-08T18:36:18.663

这直接属于[“使错误的代码看起来错误”](http://www.joelonsoftware.com/articles/Wrong.html)的类别。

在从零开始的索引语言中，例如 Java 或 C#，人们习惯于`index < count`条件的变化。因此，利用这种事实上的约定将使一个错误的错误更加明显。

关于性能：任何值得其内存占用的好的编译器都应该呈现为非问题。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-08T13:17:07.937

写 i<7 有很多很好的理由。在循环中迭代 7 次的数字 7 很好。性能实际上是相同的。几乎每个人都写 i<7。如果您是为了可读性而写作，请使用每个人都会立即识别的形式。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-08T13:36:07.147

我一直喜欢：

```
for ( int count = 7 ; count > 0 ; -- count ) 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-08T13:54:29.000

你也可以`!=`改用。这样，如果您在初始化时出错，您将获得一个无限循环，从而导致更早发现错误，并且它导致的任何问题都仅限于陷入循环中（而不是在很久以后出现问题并且找不到它）。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-08T14:38:07.397

当您遍历数组时，养成使用 < 的习惯将使您和读者都保持一致。每个人都有一个标准的约定会更简单。如果您使用的是基于 0 的数组的语言，则 < 是惯例。

这几乎肯定比 < 和 <= 之间的任何性能差异更重要。首先以功能和可读性为目标，然后进行优化。

另一个注意事项是养成使用 ++i 而不是 i++ 的习惯会更好，因为 fetch 和 increment 需要一个临时的和 increment 而 fetch 不需要。对于整数，您的编译器可能会优化暂时离开，但如果您的迭代类型更复杂，它可能无法做到。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-08T14:51:01.007

不要使用幻数。

为什么是7？（或6）。

为您要使用的号码使用正确的符号...

在这种情况下，我认为最好使用

```
for ( int i = 0; i < array.size(); i++ ) 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-08T15:03:41.573

'<' 和 '<=' 运算符的性能成本完全相同。

'<' 运算符是标准的，并且在从零开始的循环中更易于阅读。

使用 ++i 而不是 i++ 可以提​​高 C++ 的性能，但不能提高 C# 的性能——我不了解 Java。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-08T15:47:49.613

正如人们所观察到的，您提到的两种选择中的任何一种都没有区别。为了证实这一点，我在 JavaScript 中做了一些简单的基准测试。

你可以在[这里](http://unitorganizer.com/javascript/loops/)看到结果。从中不清楚的是，如果我交换第一次和第二次测试的位置，那么这两个测试的结果交换，这显然是一个内存问题。然而，第三次测试，我颠倒迭代顺序的测试显然更快。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-08T16:43:01.653

正如大家所说，习惯上使用 0 索引的迭代器，即使是数组之外的东西。如果一切都开始于`0`，结束于`n-1`，下界总是`<=`，上界总是`<`，那么在审查代码时，你需要做的思考就会少得多。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2010-01-11T10:43:58.373

好问题。我的答案：使用A型（'<'）

*   您清楚地看到您有多少次迭代 (7)。
*   两个端点之间的差异是范围的宽度
*   更少的字符使其更具可读性
*   您通常拥有元素的总数`i < strlen(s)`而不是*最后一个元素的索引，*因此一致性很重要。

另一个问题是整个结构。`i`出现**3 次**，所以可能会打错。for-loop 结构说明**了如何做**而不是**做什么**。我建议采用这个：

`BOOST_FOREACH(i, IntegerInterval(0,7))`

这更清楚，编译为exaclty相同的asm指令等。如果你愿意，请向我询问IntegerInterval的代码。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2010-09-22T00:12:21.897

这么多答案......但我相信我有一些东西要补充。

我的偏好是文字数字清楚地显示**“i”将在循环中采用的值**。因此，在迭代从零开始的数组的情况下：

`for (int i = 0; i <= array.Length - 1; ++i)`

如果你只是循环，而不是遍历数组，从 1 计数到 7 非常直观：

`for (int i = 1; i <= 7; ++i)`

在您对其进行分析之前，可读性胜过性能，因为在此之前您可能不知道编译器或运行时将如何处理您的代码。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-10-08T13:04:28.943

我认为两者都可以，但是当您选择时，请坚持其中一个。如果你习惯使用 <=，那么尽量不要使用 <，反之亦然。

我更喜欢 <=，但是在您使用从零开始的索引的情况下，我可能会尝试使用 <。不过这都是个人喜好。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-10-08T13:11:18.307

严格来说，从逻辑的角度来看，您必须认为这`< count`会比测试相等性`<= count`的确切原因更有效。`<=`

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-10-08T13:39:56.640

至少与 x86 编译器的性能应该没有差异。据我所知，JL 和 JLE 同时工作。至于可重复性，对包含七个元素的数组使用“<7”是有意义的。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-10-08T13:47:47.797

我遵循第一种方法，因为该成语经常重复。

for (int index = 0; index < array.length; i++)

字符串 s = oldString.substring(0, numChars);

等等

我已经习惯了被排除在外的上限，除非有充分的理由改变它，否则我更愿意保持这种状态。（示例——基于 1 的索引）

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-10-08T13:51:22.280

先追求可读性，然后再优化（尽管老实说，我无法想象有什么明显的区别）。

请注意，0 -> K 形式是通过使数组基于 0 来继承到 C# 中的 C 习语。遵循成语，不要违反最小惊讶原则。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-10-08T15:25:44.603

我更喜欢这个：

```
for (int i = 0; i < 7; i++) 
```

但是（这只是一个想法），它的可读性可能与数组是基于 0（C#、Java）还是基于 1（VB .NET）有关。我这样说是因为当您使用基于 0 的数组时，您会认为 0-6 会运行 7 次。我认为 0-6 比 1-7 更直观。再说一次，我来自 C++、Java、C# 背景。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-08T15:27:47.220

对于某些语言/技术（例如 .NET），使用 .Size 或 .Length 或 size()/length() 是一个坏主意，因为它每次迭代时都会访问该属性，因此将其分配给变量对性能的影响略小。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-08T18:28:36.153

结果没有意义。

从硬件的角度来看，带有 loopNumber-1 的 <= 将引入一个额外的计算来执行 loopNumber-1 每次迭代。所以我假设 < 将花费更少的时间，如果不是相同的时间比 <=

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-10-27T20:41:15.950

过早的优化是万恶之源。除非有充分的理由担心`<`over ，否则保持可读性`<=`。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-11-04T22:18:49.367

没有速度差异，但 < 在基于 0 的数组的语言中更可能是正确的。另外，如果你想向下迭代而不是向上迭代，你可以说：

```
for (i = 7; --i >= 0; ) ... 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-05-13T17:04:11.923

我认为它应该是<。

为什么要使用很多词，而少数人会这样做。一项测试比两项更容易理解。因此，以后更容易进行单元测试和修改。

差别很小吗？是的。但是，为什么在没有必要的情况下增加任何复杂性。

最后，当代码开始优化时，您不依赖于任何优化器或解释器的实现。引用爱因斯坦的话，“尽可能简单，但不要简单”。

# c# - 如何使用 javascript 在 LinkBut ton 模式下触发 BulletedList？

> ID：182602
> 
> 赞同：2
> 
> 时间：2008-10-08T13:00:35.253
> 
> 标签：c#, asp.net, javascript, bulletedlist

我在 asp.net 中有一个 BulletedList，它设置为 DisplayMode="LinkBut​​ton"。我想从javascript触发第一个“子弹”，可以这样做吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T15:25:50.390

假设您有 BulletedList 作为

```
<asp:BulletedList runat="server" ID="MyLovelyBulletedList" DisplayMode="LinkButton">
    <asp:ListItem Text="My Lovely Text 1" />
    <asp:ListItem Text="My Lovely Text 2" />
</asp:BulletedList> 
```

...然后您可以像这样触发“onclick”事件（跨浏览器）：

```
var links = document.getElementById('<%= MyLovelyBulletedList.ClientID %>').getElementsByTagName('a');

var targetLink = links[0];

if (targetLink.fireEvent)
{
    // IE
    targetLink.fireEvent("onclick");
}
else if (targetLink.dispatchEvent)
{
    // W3C
    var evt = document.createEvent("MouseEvents");

    evt.initMouseEvent("click", true, true, window,
        0, 0, 0, 0, 0, false, false, false, false, 0, null);

    targetLink.dispatchEvent(evt);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T02:46:27.660

类似于 Alexander 所指出的，除了您可以使用 jQuery 来触发事件并依赖它们的跨浏览器支持而不是自己维护它。

```
$('#<%= MyLovelyBulletedList.ClientID %>')
    .contents()
    .find('a:first')
    .trigger('click'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T13:12:20.150

经过大量测试后，似乎唯一的依赖方法是手动触发 __doPostBack 脚本，如下所示：

```
__doPostBack('MyLovelyBulletedList', '0'); 
```

正如[亚历山大·乔舍夫所建议的那样](https://stackoverflow.com/users/25427/alexander-gyoshev)

# syntax - 为什么我的 RSS 提要重复某些条目？

> ID：182615
> 
> 赞同：3
> 
> 时间：2008-10-08T13:02:54.283
> 
> 标签：syntax, rss, feed

使用 Thunderbird 提要阅读器阅读我的 RSS 提要时，有些条目是重复的。[谷歌阅读器](https://en.wikipedia.org/wiki/Google_Reader)没有同样的问题。

这是错误的提要： [http ://plcoder.net/rss.php?rss=Blog](http://plcoder.net/rss.php?rss=Blog)

有问题，但在哪里？

我添加了一个[GUID](https://en.wikipedia.org/wiki/Globally_unique_identifier)，但问题仍然存在。其他提要不会像我的那样重复，所以我会在这个模块上进行返工并替换这个旧的好代码。

结论：我完全重写了 RSS 生成器代码，还可以。我想我使用的是非常旧的[RDF](https://en.wikipedia.org/wiki/Resource_Description_Framework)版本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T13:08:59.700

尝试`<guid>`为每个项目添加一个标签，给它一个永久链接。IE：

```
<item rdf:about="http://plcoder.net/?doc=2134&amp;amp;titre=mon-pc-se-la-pete">
  <link>http://plcoder.net/?doc=2134&amp;amp;titre=mon-pc-se-la-pete</link>
  <guid>http://plcoder.net/?doc=2134&amp;amp;titre=mon-pc-se-la-pete</guid>
  ...
</item> 
```

如果没有 GUID，如果帖子中的任何内容发生更改，您的 RSS 聚合器可能会认为这是一个新帖子。使用 GUID，即使该项目的内容发生更改，您的 RSS 聚合器*也应该*只更新帖子，而不是将其视为新项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T09:12:00.427

至少对于 Thunderbird 2.0.0.21，问题是 Thunderbird 似乎不尊重 GUID 标签，但它*确实*尊重*频道的*pubDate-tag。因此，如果 pubDate 比上次读取的时间更近，Thunderbird 将读取*所有*条目（看起来）。

我不知道如果频道的 pubDate-tag 丢失会发生什么...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T13:32:37.250

我在自己的一些提要中遇到了这些问题。我从这样的条目列表开始：

```
Item A
Item B
Item C 
```

客户端下载它们，一切都很好。然后我添加了一个新项目，因此提要显示为：

```
Item D
Item A
Item B 
```

D 出现在阅读器中。

但后来我决定我不想要那个项目，所以列表恢复为：

```
Item A
Item B
Item C 
```

当 Thunderbird 读到这个时，它会将 C 视为一个新项目。我***正在***使用 GUID 元素，所以我怀疑这是问题所在。我认为这与 Thunderbird 的解析器没有考虑较旧的元素有关。

冗长的解决方法是“记住”您已经发布的项目以及后来被新项目推离列表末尾的项目。您基本上需要在提要中保留当前的项目列表，当您从中删除项目时，将其缩短，直到有新项目来替换它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-09T13:46:25.800

这在[Thunderbird 的文档](https://support.mozilla.org/en-US/kb/how-subscribe-news-feeds-and-blogs)中进行了解释（在“疑难解答常见问题解答”下）：

> **问：为什么 Feed 消息有时会重复？**
> 
> 答：内容相同但唯一 ID 不同的 Feed 消息不会被检测为重复消息。有关更多详细信息，请参阅[这篇文章。](http://forums.mozillazine.org/viewtopic.php?p=13360829#p13360829)

链接帖子供参考：

> 1.  [Atom](https://en.wikipedia.org/wiki/Atom_(Web_standard))提要（强制）具有唯一 ID；RSS 提要（非强制性）通常具有唯一的 GUID。对于没有 GUID 的 RSS 提要，将尝试从提要项的必需部分创建唯一 ID。
> 2.  所有下载的提要消息都有一个存储在 feeditems.rdf 中的具有此 ID 的记录，并且只要它们存在于具有该 ID 的发布者的文件中，它们就存在在那里。如果发布者从他们的文件中删除带有 ID 的消息，则在 24 小时后，feeditems.rdf 缓存也会被清除（在获取消息 biff 时）。
> 3.  如果发布者在清除 ID 后重新使用它，您将得到一个重复的 ID（如果内容相同）。这是对唯一 ID 背后意图的滥用，是发布者的错误。
> 4.  如果发布者在清除之前重复使用 ID，并且内容不同，您将看不到新内容，因为它将被视为重复内容。Thunderbird 目前不使用 <updated> 标签，发布者滥用它可能会使其难以实施。
> 5.  如果您查看两个明显重复的来源 ( `Ctrl`+ `U`)，您会注意到 Message-Id 标头。如果两个明显的重复项具有不同的 Message-Id 值，那么无论潜在的相同内容如何，​​它们都不是重复项。Thunderbird 不区分重复内容。
> 
> 如果您想进行极端调试，请将 Feeds.logging.console 首选项设置更改为调试或跟踪并重新启动，以查看在提要处理期间会发生什么。
> 
> 如果您取消订阅一个提要 URL，这将清除该提要的*feeditems.rdf*缓存。如果您随后重新订阅，您将获得发布者文件中所有当前项目的副本，这些项目也存在于您的提要文件夹中。
> 
> 压实对饲料加工没有影响；它只是从文件中删除标记为删除的项目。如果您删除文件夹/将其移至垃圾箱，则会取消订阅。从 Thunderbird 29 开始，如果您将文件夹从一个提要帐户拖放到另一个提要帐户，订阅将被保留（但不是提要项）。对于非常旧的配置文件/订阅源帐户（Thunderbird 17 之前），创建一个新的订阅源帐户并将文件夹拖到那里（Thunderbird 29 及更高版本）可能是个好主意，因为创建了一个新的*feeds.rdf*数据库；惩罚是一次性重复的可能性。

# c# - 程序终止后抛出的异常（遇到的错误）

> ID：182622
> 
> 赞同：5
> 
> 时间：2008-10-08T13:03:50.303
> 
> 标签：c#, vb.net, unsafe

我有一个似乎只有在程序关闭后才抛出异常的应用程序。而且非常不一致。（我们都知道不一致的错误是多么有趣......）

我的猜测是清理过程中出现错误。但是这些内存读/写错误似乎表明我的“不安全”代码使用有问题（指针？）。

我感兴趣的是调试这些情况的最佳方法是什么？
如何调试已经关闭的程序？
我正在寻找一个起点来解决一个更大的问题。

这些错误似乎以多种方式出现（一些运行时，一些调试）：

```
1：.NET-BroadcastEventWindow.2.0.0.0.378734a.0：Application.exe - 应用程序错误

“0x03b4eddb”处的指令引用了“0x00000004”处的内存。内存无法“写入”。

2：Application.vshost.exe - 应用程序错误

“0x0450eddb”处的指令引用了“0x00000004”处的内存。内存无法“写入”。

3：Application.vshost.exe - 应用程序错误

“0x7c911669”处的指令引用了“0x00000000”处的内存。无法“读取”内存。

4：Application.vshost.exe - 应用程序错误

“0x7c910ed4”处的指令引用了“0xfffffff8”处的内存。无法“读取”内存。

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-08-09T09:48:54.077

我在使用 AcrobarReader COM 组件时遇到了这个问题。应用程序退出后时不时出现“Application.vshost.exe - 应用程序错误”“无法读取内存”。GC.Collect() 和 WaitForPendingFinalizers() 没有帮助。

我的 google-fu 将我带到此页面： http: [//support.microsoft.com/kb/826220](http://support.microsoft.com/kb/826220)。我为我的案例修改了方法 3。

使用进程资源管理器我发现 AcroPDF.dll 在 Main 函数的最后一行之前没有发布。所以，API 调用来了。

DLLImports（DLLImport 位于 System.Runtime.InteropServices 命名空间中）：

```
<DllImport("kernel32.dll", EntryPoint:="GetModuleHandle", _
       SetLastError:=True, CharSet:=CharSet.Auto, _
       CallingConvention:=CallingConvention.StdCall)> _
Public Overloads Shared Function GetModuleHandle(ByVal sLibName As String) As IntPtr
End Function

<DllImport("kernel32.dll", EntryPoint:="FreeLibrary", _
    SetLastError:=True, CallingConvention:=CallingConvention.StdCall)> _
Public Overloads Shared Function FreeLibrary(ByVal hMod As IntPtr) As Integer
End Function 
```

然后在应用程序退出之前：

```
Dim hOwcHandle As IntPtr = GetModuleHandle("AcroPDF.dll")
If Not hOwcHandle.Equals(IntPtr.Zero) Then
    FreeLibrary(hOwcHandle)
    Debug.WriteLine("AcroPDF.dll freed")
End If 
```

可以针对任何其他行为不端的 dll 修改此过程。我只是希望它不会引入任何新的错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T13:54:01.777

如果您的应用程序是多线程的，您可能会从未正确终止并尝试访问已处理对象的工作线程中获取错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T13:18:34.563

我最近看到很多这样的错误。我的问题与与 .NET 运行时交互的 CRT（C 运行时）如何清理关闭进程有关。我的应用程序很复杂，因为它是 C++，但允许加载 COM 加载项，其中一些是用 C# 编写的。

要对此进行调试，我认为您将需要使用本机调试。Visual Studio（设置为混合模式调试）或 WinDbg。查看如何使用 Microsoft 公共符号服务器下载 Windows 组件的 PDB - 您将***需要***这些符号。

我们的许多问题都与 .NET（糟糕的）COM 客户端支持有关。我说很糟糕，因为它没有正确引用计数（开发人员没有做很多工作）。在垃圾收集完成之前，COM 对象不会被引用 - 倒数归零。这通常会在关机期间设置奇怪的计时问题 - COM 对象在应该清理很久之后才被清理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T18:52:21.503

“不一致”的更好用词是“非确定性”。在 .NET 环境中不确定地会发生什么？对象破坏。

当这发生在我身上时，罪魁祸首是我编写的用于包装对外部 API 的不安全调用的类。我将清理代码放在类的析构函数中，期望在对象超出范围时调用代码。但这不是 .NET 中对象销毁的工作方式，当对象超出范围时，它会被放入终结器的队列中，并且在终结器处理它之前不会调用其析构函数。直到程序终止后，它才能执行此操作。如果发生这种情况，结果将与您在此处描述的非常相似。

一旦我让我的类实现`IDisposable`，并在我完成后显式调用`Dispose()`该对象，问题就消失了。（实现 IDisposable 的另一个优点是您可以在`using`块的开头实例化您的对象，并确信 Dispose() 将在代码离开块时获取。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T20:21:31.103

试试这个以强制在程序控制下发生错误

```
 //set as many statics as you can to null;
   GC.Collect();
   GC.WaitForPendingFinalizers();
} //exit main 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-14T15:08:05.743

使用建议的代码后，错误停止出现：

```
GC.Collect(); 
GC.WaitForPendingFinalizers(); 
```

# asp.net - 多长时间才能熟悉 ASP.NET？

> ID：182627
> 
> 赞同：3
> 
> 时间：2008-10-08T13:05:37.677
> 
> 标签：asp.net

这个问题与我之前的问题类似。

大约 4 年前，我在 Visual Studio 2005 中使用过 ASP .Net。恢复最新版本的速度需要多长时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T13:11:36.090

这取决于你“使用”了多少。经验丰富的开发人员应该可以轻松地更新他对 3.0 到 3.5 框架更改和特定语言更改的知识。从那时起，我想说的最大的介绍是 LINQ，它提供了从语言级别而不是 SQL 查询数据的能力。

但是如果你不是经验开发者，并且在之前的版本中没有良好的基础，那么你将学习的大部分内容将是 Framework 3.0 和 VS2005。

所以，最终，如果你只是从 VS2005 到 2008，那应该不会有太大的麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T13:08:20.747

不是很长。VS 2008 的主要补充是对 Linq 的支持，但您不必使用它（或任何新功能）。

IDE 与 VS 2005 极为相似。

本质上，2005 面向 3.0 框架，2008 面向 3.5 框架，但这些都只是 2.0 框架的扩展，而不是新版本（与从 1.1 到 2.0 的变化不同）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T11:00:21.500

这取决于您要使用 ASP.NET 的目的。

如果您生活在 HTTP 请求/响应世界中，这将需要时间。大部分时间将花在尝试转移完全忽略 Requrest/Respone 世界的文档以支持 ViewState 和其他类似项目。

如果你想用 ViewState 的方式，不要太久，因为微软的网站上到处都是教程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T13:38:04.820

如果您当时能够生产和应用程序，那么您现在可能仍然可以构建完全相同的应用程序。

如前所述，.NET v3.5 只是 v2.0，带有额外的花里胡哨，如 LINQ 和 AJAX。这些是更广泛的工具包中的工具，并且不要求您必须使用任何/全部。

所以从你离开的地方开始。刷新自己，一旦你重新开始工作，看看一些最新的增强功能，并挑选一两个你认为对你有用的东西。一步一步来！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T13:44:40.237

其他人都是正确的，它应该很容易。我只想补充一点，ListView 控件是新增内容之一，所以一定要检查一下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T13:08:48.593

如果您之前已经精通它，那么您将能够很快再次进入它。核心概念没有太大变化，所以你应该有宾至如归的感觉。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T13:22:12.853

看看一些入门工具包，如[Kigg](http://www.asp.net/downloads/starter-kits/Kigg/)、[DinnerNow](http://www.dinnernow.net/)和[DropThings](http://www.dinnernow.net/)。您将了解 MVC、WCF 和 LINQ。忽略那种下沉的感觉，开始工作学习吧！

# javascript - jQuery 提示和技巧

> ID：182630
> 
> 赞同：507
> 
> 时间：2008-10-08T13:06:00.220
> 
> 标签：javascript, jquery

## 句法

*   roosteronacid[的 ready-event简写](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/2218129#2218129)
*   [roosteronacid](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/2218135#2218135)的换行和可链接性
*   Nathan Long 的[嵌套过滤器](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/389474#389474)
*   缓存一个集合并通过roosteronacid[在同一行执行命令](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/552831#552831)
*   [包含](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/1519474#1519474)roosteronacid 的选择器
*   用 roosteronacid[定义元素创建的属性](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/2750689#2750689)
*   通过 roosteronacid[访问 jQuery 函数，就像访问数组一样](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/3967325#3967325)
*   [noConflict 函数 -](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/182666#182666)由 Oli释放 $ 变量
*   通过nickf[在noConflict模式下隔离$变量](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/382853#382853)
*   roosteronacid[无冲突模式](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/2218120#2218120)

## 数据存储

*   [数据函数 -](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/382834#382834)通过 TenebrousX将数据绑定到元素
*   [HTML5 数据属性支持，在类固醇上！](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/5410587#5410587)通过公鸡酸
*   Filip Dupanović[的 jQuery 元数据插件](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/504776#504776)

## 优化

*   通过 roosteronacid[优化复杂选择器的性能](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/1019899#1019899)
*   lupefiasco[的上下文参数](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/504732#504732)
*   [保存并重复使用](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/389793#389793)Nathan Long 的搜索
*   [创建 HTML 元素并保持引用，检查元素是否存在，编写自己的选择器](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/382922#382922)by Andreas Grech

## 各种各样的

*   通过redsquare[检查集合中元素的索引](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/389906#389906)
*   TM 的[实时事件处理程序](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/892617#892617)
*   用ken[命名函数替换匿名函数](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/696385#696385)
*   Slace 的[Microsoft AJAX 框架和 jQuery 桥接器](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/191139#191139)
*   egyamado 的[jQuery 教程](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/922865#922865)
*   [从集合中删除元素并](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/998547#998547)通过 roosteronacid保持可链接性
*   [在匿名函数的开头声明 $this](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/191061#191061) by Ben
*   [FireBug lite，Hotbox 插件，](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/1771311#1771311)通过 Color Blend告诉图像何时加载和 Google CDN
*   harriyott[对第三方 jQuery 脚本的明智使用](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/182715#182715)
*   Jan Zich[的每个功能](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/1584927#1584927)
*   Chris S[的表单扩展插件](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/1235178#1235178)
*   OneNerd[异步每个函数](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/2750689#2750689)
*   [jQuery 模板插件：使用](https://stackoverflow.com/questions/182630/jquery-tips-and-tricks/4962433#4962433)roosteronacid的渲染函数实现复杂的逻辑

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2008-12-20T04:35:44.413

**创建 HTML 元素并保留引用**

```
var newDiv = $("<div />");

newDiv.attr("id", "myNewDiv").appendTo("body");

/* Now whenever I want to append the new div I created, 
   I can just reference it from the "newDiv" variable */ 
```

**检查元素是否存在**

```
if ($("#someDiv").length)
{
    // It exists...
} 
```

**编写自己的选择器**

```
$.extend($.expr[":"], {
    over100pixels: function (e)
    {
        return $(e).height() > 100;
    }
});

$(".box:over100pixels").click(function ()
{
    alert("The element you clicked is over 100 pixels height");
}); 
```

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2008-12-20T03:08:59.597

jQuery 的[`data()`](http://docs.jquery.com/Core/data)方法很有用，但并不为人所知。它允许您在不修改 DOM 的情况下将数据绑定到 DOM 元素。

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2008-12-23T17:14:34.083

## 嵌套过滤器

您可以嵌套过滤器（如[nickf 所示](https://stackoverflow.com/questions/382301/jquery-accordion-close-then-open#382828)）。

```
.filter(":not(:has(.selected))") 
```

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2008-10-08T13:11:42.907

我真的不喜欢`$(document).ready(fn)`捷径。当然它减少了代码，但它也减少了代码的可读性。当你看到时`$(document).ready(...)`，你就知道你在看什么。`$(...)`以太多其他方式使用，无法立即理解。

如果您有多个框架，您可以`jQuery.noConflict();`按照您的说法使用，但您也可以为它分配一个不同的变量，如下所示：

```
var $j = jQuery.noConflict();

$j("#myDiv").hide(); 
```

如果您有多个可以归结为`$x(...)`-style 调用的框架，这将非常有用。

* * *

## 回答 #5

> 赞同：77
> 
> 时间：2009-02-02T20:35:41.677

哦，别忘了[jQuery 元数据](http://docs.jquery.com/Plugins/Metadata)！data() 函数很棒，但它必须通过 jQuery 调用来填充。

而不是破坏 W3C 与自定义元素属性的合规性，例如：

```
<input 
  name="email" 
  validation="required" 
  validate="email" 
  minLength="7" 
  maxLength="30"/> 
```

改用元数据：

```
<input 
  name="email" 
  class="validation {validate: email, minLength: 2, maxLength: 50}" />

<script>
    jQuery('*[class=validation]').each(function () {
        var metadata = $(this).metadata();
        // etc.
    });
</script> 
```

* * *

## 回答 #6

> 赞同：73
> 
> 时间：2009-05-21T12:05:51.953

## 实时事件处理程序

**为任何**匹配选择器的元素设置事件处理程序，即使它在初始页面加载后被添加到 DOM：

```
$('button.someClass').live('click', someFunction); 
```

这允许您通过 ajax 加载内容，或通过 javascript 添加内容，并自动为这些元素正确设置事件处理程序。

同样，要停止实时事件处理：

```
$('button.someClass').die('click', someFunction); 
```

与常规事件相比，这些实时事件处理程序有一些限制，但它们适用于大多数情况。

有关更多信息，请参阅[jQuery 文档](http://docs.jquery.com/Events/live)。

**更新：在 jQuery 1.7 中已弃用`live()`。`die()`有关类似的替换功能，请参阅[http://api.jquery.com/on/](http://api.jquery.com/on/)和[http://api.jquery.com/off/](http://api.jquery.com/off/)。**

**UPDATE2：`live()`早在 jQuery 1.7 之前就已经被弃用了。对于 1.7 之前的 jQuery 1.4.2+ 版本，使用[`delegate()`](http://api.jquery.com/delegate/)和`undelegate()`.** `live()`示例 ( `$('button.someClass').live('click', someFunction);`) 可以这样重写`delegate()`：`$(document).delegate('button.someClass', 'click', someFunction);`.

* * *

## 回答 #7

> 赞同：46
> 
> 时间：2009-03-30T08:17:40.060

用命名函数替换匿名函数。这确实取代了 jQuery 上下文，但由于它依赖于回调函数，它更像是在使用 jQuery 时发挥作用。我对内联匿名函数的问题是它们更难调试（更容易查看具有明确命名函数的调用堆栈，而不是 6 级“匿名”），以及多个匿名函数在同一jQuery-chain 可能会变得难以阅读和/或维护。此外，匿名函数通常不会被重用；另一方面，声明命名函数鼓励我编写更有可能被重用的代码。

插图；代替：

```
$('div').toggle(
    function(){
        // do something
    },
    function(){
        // do something else
    }
); 
```

我更喜欢：

```
function onState(){
    // do something
}

function offState(){
    // do something else
}

$('div').toggle( offState, onState ); 
```

* * *

## 回答 #8

> 赞同：45
> 
> 时间：2010-02-07T17:39:55.810

**在元素创建时定义属性**

在 jQuery 1.4 中，您可以在创建元素时使用对象字面量来定义属性：

```
var e = $("<a />", { href: "#", class: "a-class another-class", title: "..." }); 
```

...您甚至可以添加样式：

```
$("<a />", {
    ...
    css: {
        color: "#FF0000",
        display: "block"
    }
}); 
```

这是[文档的链接](http://api.jquery.com/jQuery/#jQuery2)。

* * *

## 回答 #9

> 赞同：43
> 
> 时间：2008-12-20T03:35:40.043

而不是为 jQuery 对象使用不同的别名（当使用 noConflict 时），我总是通过将其全部包装在一个闭包中来编写我的 jQuery 代码。这可以在 document.ready 函数中完成：

```
var $ = someOtherFunction(); // from a different library

jQuery(function($) {
    if ($ instanceOf jQuery) {
        alert("$ is the jQuery object!");
    }
}); 
```

或者你可以这样做：

```
(function($) {
    $('...').etc()    // whatever jQuery code you want
})(jQuery); 
```

我发现这是最便携的。我一直在一个同时使用 Prototype 和 jQuery 的网站上工作，这些技术避免了所有冲突。

* * *

## 回答 #10

> 赞同：39
> 
> 时间：2008-12-23T19:57:15.067

## **检查索引**

jQuery 有 .index 但使用起来很痛苦，因为您需要元素列表，并传入您想要索引的元素：

```
var index = e.g $('#ul>li').index( liDomObject ); 
```

以下内容要容易得多：

如果您想知道无序列表中集合（例如列表项）中元素的索引：

```
$("ul > li").click(function () {
    var index = $(this).prevAll().length;
}); 
```

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2010-02-07T20:07:40.497

**就绪事件的简写**

显式和详细的方式：

```
$(document).ready(function ()
{
    // ...
}); 
```

速记：

```
$(function ()
{
    // ...
}); 
```

* * *

## 回答 #12

> 赞同：22
> 
> 时间：2009-02-02T20:24:56.957

在核心 jQuery 函数上，除了选择器参数外，还要指定上下文参数。指定 context 参数允许 jQuery 从 DOM 中更深的分支开始，而不是从 DOM 根开始。给定足够大的 DOM，指定 context 参数应该会转化为性能提升。

示例：在文档的第一个表单中查找类型为 radio 的所有输入。

```
$("input:radio", document.forms[0]); 
```

参考：[http ://docs.jquery.com/Core/jQuery#expressioncontext](http://docs.jquery.com/Core/jQuery#expressioncontext)

* * *

## 回答 #13

> 赞同：21
> 
> 时间：2008-10-10T12:58:24.230

不仅仅是 jQuery，但我为 jQuery 和 MS AJAX 搭建了一个不错的小桥梁：

```
Sys.UI.Control.prototype.j = function Sys$UI$Control$j(){
  return $('#' + this.get_id());
} 
```

如果你在做大量的 ASP.NET AJAX，那就太好了，因为 jQuery 得到了 MS 的支持，现在有了一个很好的桥，这意味着做 jQuery 操作真的很容易：

```
$get('#myControl').j().hide(); 
```

所以上面的例子不是很好，但是如果你正在编写 ASP.NET AJAX 服务器控件，可以很容易地在你的客户端控件实现中使用 jQuery。

* * *

## 回答 #14

> 赞同：20
> 
> 时间：2009-06-19T20:26:42.907

**优化复杂选择器的性能**

使用复杂选择器时查询 DOM 的子集可以显着提高性能：

```
var subset = $("");

$("input[value^='']", subset); 
```

* * *

## 回答 #15

> 赞同：19
> 
> 时间：2010-05-01T16:27:55.097

**异步 each() 函数**

如果您有**非常复杂**的文档，其中运行 jquery **each()**函数会在迭代期间锁定浏览器，和/或 Internet Explorer 弹出“*您要继续运行此脚本*吗”消息，此解决方案将节省一天的时间。

```
jQuery.forEach = function (in_array, in_pause_ms, in_callback)
{
    if (!in_array.length) return; // make sure array was sent

    var i = 0; // starting index

    bgEach(); // call the function

    function bgEach()
    {
        if (in_callback.call(in_array[i], i, in_array[i]) !== false)
        {
            i++; // move to next item

            if (i < in_array.length) setTimeout(bgEach, in_pause_ms);
        }
    }

    return in_array; // returns array
};

jQuery.fn.forEach = function (in_callback, in_optional_pause_ms)
{
    if (!in_optional_pause_ms) in_optional_pause_ms = 10; // default

    return jQuery.forEach(this, in_optional_pause_ms, in_callback); // run it
}; 
```

**您可以使用它的第一种方式就像 each()：**

```
$('your_selector').forEach( function() {} ); 
```

可选的**第二个参数允许您指定迭代之间的速度/延迟，**这可能对动画有用（*以下示例将在迭代之间等待 1 秒*）：

```
$('your_selector').forEach( function() {}, 1000 ); 
```

请记住，由于这是异步工作的，因此您不能依赖迭代在下一行代码之前完成，例如：

```
$('your_selector').forEach( function() {}, 500 );
// next lines of code will run before above code is complete 
```

我为一个内部项目写了这个，虽然我确信它可以改进，但它可以满足我们的需要，所以希望你们中的一些人觉得它有用。谢谢 -

* * *

## 回答 #16

> 赞同：19
> 
> 时间：2009-05-28T20:00:13.080

说到提示和技巧以及一些教程。[我发现Jeffery Way](http://jeffrey-way.com/)的这些系列教程（ “绝对初学者的**jQuery”视频系列）**非常有用。

它针对那些不熟悉 jQuery 的开发人员。他展示了如何使用 jQuery 创建许多很酷的东西，例如动画、创建和删除元素等等……

我从中学到了很多。他展示了使用 jQuery 是多么容易。现在我喜欢它，我可以阅读和理解任何 jQuery 脚本，即使它很复杂。

这是我喜欢“**调整文本大小**”的一个例子

**1- jQuery ...**

```
<script language="javascript" type="text/javascript">
    $(function() {
        $('a').click(function() {
            var originalSize = $('p').css('font-size'); // get the font size 
            var number = parseFloat(originalSize, 10); // that method will chop off any integer from the specified variable "originalSize"
            var unitOfMeasure = originalSize.slice(-2);// store the unit of measure, Pixle or Inch

            $('p').css('font-size', number / 1.2 + unitOfMeasure);
            if(this.id == 'larger'){$('p').css('font-size', number * 1.2 + unitOfMeasure);}// figure out which element is triggered
         });        
     });
</script> 
```

**2- CSS 样式...**

```
<style type="text/css" >
body{ margin-left:300px;text-align:center; width:700px; background-color:#666666;}
.box {width:500px; text-align:justify; padding:5px; font-family:verdana; font-size:11px; color:#0033FF; background-color:#FFFFCC;}
</style> 
```

**2- HTML...**

```
<div class="box">
    <a href="#" id="larger">Larger</a> | 
    <a href="#" id="Smaller">Smaller</a>
    <p>
    In today’s video tutorial, I’ll show you how to resize text every time an associated anchor tag is clicked. We’ll be examining the “slice”, “parseFloat”, and “CSS” Javascript/jQuery methods. 
    </p>
</div> 
```

强烈推荐这些教程...

[http://blog.themeforest.net/screencasts/jquery-for-absolute-beginners-video-series/](http://blog.themeforest.net/screencasts/jquery-for-absolute-beginners-video-series/)

* * *

## 回答 #17

> 赞同：18
> 
> 时间：2009-02-16T10:08:42.857

句法速记-sugar-thing--缓存一个对象集合并在一行上执行命令：

**代替：**

```
var jQueryCollection = $("");

jQueryCollection.command().command(); 
```

**我愿意：**

```
var jQueryCollection = $("").command().command(); 
```

一个有点“真实”的用例可能是这样的：

```
var cache = $("#container div.usehovereffect").mouseover(function ()
{
    cache.removeClass("hover").filter(this).addClass("hover");
}); 
```

* * *

## 回答 #18

> 赞同：15
> 
> 时间：2008-10-10T12:39:58.450

我喜欢`$this`在匿名函数的开头声明一个变量，所以我知道我可以引用一个 jQueried this。

像这样：

```
$('a').each(function() {
    var $this = $(this);

    // Other code
}); 
```

* * *

## 回答 #19

> 赞同：14
> 
> 时间：2008-12-23T19:13:19.413

## 将 jQuery 对象保存在变量中以供重用

将 jQuery 对象保存到变量中可以让您重复使用它，而无需通过 DOM 进行搜索来找到它。

（正如@Louis 所建议的，我现在使用 $ 来表示一个变量包含一个 jQuery 对象。）

```
// Bad: searching the DOM multiple times for the same elements
$('div.foo').each...
$('div.foo').each...

// Better: saving that search for re-use
var $foos = $('div.foo');
$foos.each...
$foos.each... 
```

作为一个更复杂的示例，假设您在商店中有一份食品清单，并且您只想显示符合用户条件的食品。您有一个带有复选框的表单，每个复选框都包含一个条件。复选框具有和之类的名称`organic`，`lowfat`产品具有相应的类 -`.organic`等。

```
var $allFoods, $matchingFoods;
$allFoods = $('div.food'); 
```

现在您可以继续使用该 jQuery 对象。每次单击复选框（选中或取消选中）时，从食物主列表开始并根据选中的框向下过滤：

```
// Whenever a checkbox in the form is clicked (to check or uncheck)...
$someForm.find('input:checkbox').click(function(){

  // Start out assuming all foods should be showing
  // (in case a checkbox was just unchecked)
  var $matchingFoods = $allFoods;

  // Go through all the checked boxes and keep only the foods with
  // a matching class 
  this.closest('form').find("input:checked").each(function() {  
     $matchingFoods = $matchingFoods.filter("." + $(this).attr("name")); 
  });

  // Hide any foods that don't match the criteria
  $allFoods.not($matchingFoods).hide();
}); 
```

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2009-10-18T13:46:18.837

似乎大部分有趣和重要的技巧都已经提到了，所以这只是一点点补充。

小技巧是[jQuery.each(object, callback)](http://docs.jquery.com/Utilities/jQuery.each)函数。每个人都可能使用[jQuery.each(callback)](http://docs.jquery.com/Core/each)函数来迭代 jQuery 对象本身，因为它很自然。jQuery.each(object, callback) 实用函数迭代对象和数组。很长一段时间以来，不知何故，除了不同的语法（我不介意编写所有流行的循环）之外，我没有看到它的用途，而且我有点惭愧，我直到最近才意识到它的主要优势。

问题是，由于**jQuery.each(object, callback) 中的循环体是一个函数**，因此每次在循环中都会获得一个**新范围，这在循环中创建****闭包**时特别方便。

换句话说，一个典型的常见错误是执行以下操作：

```
var functions = [];
var someArray = [1, 2, 3];
for (var i = 0; i < someArray.length; i++) {
    functions.push(function() { alert(someArray[i]) });
} 
```

现在，当您调用`functions`数组中的函数时，您将收到三倍警报，其中的内容`undefined`很可能不是您想要的。问题是只有一个变量`i`，所有三个闭包都引用它。当循环结束时， 的最终值为`i`3，并且`someArrary[3]`是`undefined`。您可以通过调用另一个为您创建闭包的函数来解决它。或者您使用 jQuery 实用程序，它基本上会为您完成：

```
var functions = [];
var someArray = [1, 2, 3];
$.each(someArray, function(item) {
    functions.push(function() { alert(item) });
}); 
```

现在，当您调用函数时，您会收到三个警报，其内容为 1、2 和 3，正如预期的那样。

总的来说，没有什么是你自己做不到的，但拥有它是件好事。

* * *

## 回答 #21

> 赞同：11
> 
> 时间：2010-10-19T10:17:43.283

**像访问数组一样访问 jQuery 函数**

添加/删除基于布尔值的类...

```
function changeState(b)
{
    $("selector")[b ? "addClass" : "removeClass"]("name of the class");
} 
```

是不是短版...

```
function changeState(b)
{
    if (b)
    {
        $("selector").addClass("name of the class");
    }
    else
    {
        $("selector").removeClass("name of the class");
    }
} 
```

没有那么多用例。尽管如此; 我认为它很整洁:)

**更新**

万一您不是评论阅读类型，ThiefMaster 指出[toggleClass 接受一个布尔值](http://api.jquery.com/toggleClass/)，它决定是否应该添加或删除一个类。所以就我上面的示例代码而言，这将是最好的方法......

```
$('selector').toggleClass('name_of_the_class', true/false); 
```

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2009-06-15T21:42:02.700

**从集合中删除元素并保留可链接性**

考虑以下：

```
<ul>
    <li>One</li>
    <li>Two</li>
    <li>Three</li>
    <li>Four</li>
    <li>Five</li>
</ul> 
```

```
$("li").filter(function()
{
    var text = $(this).text();

    // return true: keep current element in the collection
    if (text === "One" || text === "Two") return true;

    // return false: remove current element from the collection
    return false;
}).each(function ()
{
    // this will alert: "One" and "Two"       
    alert($(this).text());
}); 
```

该`filter()`函数从 jQuery 对象中删除元素。在这种情况下：所有不包含文本“One”或“Two”的 li 元素都将被删除。

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2009-11-20T15:38:59.830

更新：

只需在站点上包含此脚本，您就会得到一个 Firebug 控制台，该控制台会弹出以在任何浏览器中进行调试。没有那么全功能，但它仍然很有帮助！完成后请记住将其删除。

```
<script type='text/javascript' src='http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js'></script> 
```

看看这个链接：

[来自 CSS 技巧](http://css-tricks.com/snippets/html/use-firebug-in-any-browser/)

更新：我发现了一些新东西；它是 JQuery Hotbox。

[jQuery 热盒](http://www.s3maphor3.org/demo/hotbox/)

Google 在 Google Code 上托管了几个 JavaScript 库。从那里加载它可以节省带宽，并且加载速度很快，因为它已经被缓存了。

```
<script src="http://www.google.com/jsapi"></script>  
<script type="text/javascript">  

    // Load jQuery  
    google.load("jquery", "1.2.6");  

    google.setOnLoadCallback(function() {  
        // Your code goes here.  
    });  

</script> 
```

或者

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js" type="text/javascript"></script> 
```

您还可以使用它来判断图像何时完全加载。

```
$('#myImage').attr('src', 'image.jpg').load(function() {  
    alert('Image Loaded');  
}); 
```

firebug 的“console.info”，您可以使用它来将消息和变量转储到屏幕上，而无需使用警报框。“console.time”允许您轻松设置一个计时器来包装一堆代码并查看需要多长时间。

```
console.time('create list');

for (i = 0; i < 1000; i++) {
    var myList = $('.myList');
    myList.append('This is list item ' + i);
}

console.timeEnd('create list'); 
```

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2010-12-03T18:16:37.583

尽可能在伪选择器上使用过滤方法，以便 jQuery 可以使用 querySelectorAll（这比嘶嘶声要快得多）。考虑这个选择器：

```
$('.class:first') 
```

可以使用以下方法进行相同的选择：

```
$('.class').eq(0) 
```

这必须更快，因为“.class”的初始选择与 QSA 兼容

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2010-02-07T21:04:21.603

**更改输入元素的类型**

当我尝试更改已附加到 DOM 的输入元素的类型时，我遇到了这个问题。您必须克隆现有元素，将其插入旧元素之前，然后删除旧元素。否则它不起作用：

```
var oldButton = jQuery("#Submit");
var newButton = oldButton.clone();

newButton.attr("type", "button");
newButton.attr("id", "newSubmit");
newButton.insertBefore(oldButton);
oldButton.remove();
newButton.attr("id", "Submit"); 
```

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2010-02-07T20:10:07.543

**换行和可链接性**

在集合上链接多个调用时...

```
$("a").hide().addClass().fadeIn().hide(); 
```

您可以使用换行符增加可读性。像这样：

```
$("a")
.hide()
.addClass()
.fadeIn()
.hide(); 
```

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2008-10-08T13:21:23.293

明智地使用第三方 jQuery 脚本，例如表单字段验证或 url 解析。值得一看，这样您下次遇到 JavaScript 需求时就会知道。

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2010-07-06T19:14:33.883

在方法调用中使用自执行匿名函数，例如`.append()`迭代某些东西。IE：

```
$("<ul>").append((function ()
{
    var data = ["0", "1", "2", "3", "4", "5", "6"],
        output = $("<div>"),
        x = -1,
        y = data.length;

    while (++x < y) output.append("<li>" + info[x] + "</li>");

    return output.children();
}())); 
```

我用它来迭代那些很大并且不舒服的东西，因为我无法摆脱我的链接来构建。

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2010-05-05T23:27:20.043

触发动画时使用 .stop(true,true) 可防止其重复动画。这对于翻转动画特别有用。

```
$("#someElement").hover(function(){
    $("div.desc", this).stop(true,true).fadeIn();
},function(){
    $("div.desc", this).fadeOut();
}); 
```

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2011-03-23T19:30:43.817

**HTML5 数据属性支持，在类固醇上！**

[数据函数](http://api.jquery.com/data/)前面已经提到过。使用它，您可以将数据与 DOM 元素相关联。

最近 jQuery 团队增加了对[HTML5 自定义 data-* 属性](http://dev.w3.org/html5/spec/elements.html#embedding-custom-non-visible-data-with-the-data-attributes)的支持。好像这还不够；他们用类固醇强行输入数据函数，这意味着您可以直接在您的标记中以 JSON 的形式存储复杂的对象。

的HTML：

```
<p data-xyz = '{"str": "hi there", "int": 2, "obj": { "arr": [1, 2, 3] } }' /> 
```

JavaScript：

```
var data = $("p").data("xyz");

data.str // "hi there"
typeof data.str // "string"

data.int + 2 // 4
typeof data.int // "number"

data.obj.arr.join(" + ") + " = 6" // "1 + 2 + 3 = 6"
typeof data.obj.arr // "object" ... Gobbles! Errrghh! 
```

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2009-10-05T11:16:17.163

这个去[科比](https://stackoverflow.com/users/7586/kobi)。

考虑以下代码片段：

```
// hide all elements which contains the text "abc"
$("p").each(function ()
{
    var that = $(this);

    if (that.text().indexOf("abc") > -1) that.hide();
}); 
```

这是一个速记......它的速度大约是原来的两倍：

```
$("p.value:contains('abc')").hide(); 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2011-02-20T18:51:24.813

## 为折叠上方的元素添加选择器

### 作为一个 jQuery 选择器插件

```
 $.extend($.expr[':'], {
 "aboveFold": function(a, i, m) {
   var container = m[3],
   var fold;
  if (typeof container === "undefined") {
     fold = $(window).height() + $(window).scrollTop();
  } else {
     if ($(container).length == 0 || $(container).offset().top == null) return false;
     fold = $(container).offset().top + $(container).height();
  }
  return fold >= $(a).offset().top;
 } 
}); 
```

### 用法：

```
$("p:aboveFold").css({color:"red"}); 
```

[谢谢](http://flowcoder.com/scottymac)scottymac

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2011-03-10T13:02:25.427

在更基础和更高级的注释中，您可以尝试通过编写自己的小框架来模拟 jQuery 的基本选择器机制（它比听起来更简单）。它不仅会无休止地改进你的 Javascript，它还会帮助你理解为什么 jQuery 的 $("#elementId") 比 $(".elementClass") 快很多倍，并且也比 $("element#elementId ") （这可能在表面上是违反直觉的）。

这也将迫使您学习面向对象的 Javascript，这将帮助您以更加模块化的方式组织代码，从而避免繁重的 jQuery 脚本块可能出现的意大利面条式代码性质。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2009-08-05T19:14:34.943

*（这是一个无耻的插件）*

与其编写重复的表单处理代码，你可以试试我写的[这个插件](http://code.google.com/p/jquery-form-extensions/)，它通过添加表单相关的方法来添加到 jQuery 的流畅 API：

```
// elementExists is also added
if ($("#someid").elementExists())
  alert("found it");

// Select box related
$("#mydropdown").isDropDownList();

// Can be any of the items from a list of radio boxes - it will use the name
$("#randomradioboxitem").isRadioBox("myvalue");
$("#radioboxitem").isSelected("myvalue");

// The value of the item selected. For multiple selects it's the first value
$("#radioboxitem").selectedValue();

// Various, others include password, hidden. Buttons also
$("#mytextbox").isTextBox();
$("#mycheck").isCheckBox();
$("#multi-select").isSelected("one", "two", "three");

// Returns the 'type' property or 'select-one' 'select-multiple'
var fieldType = $("#someid").formElementType(); 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2011-04-20T02:27:02.237

“结束于”元素选择器非常适合 ASP.NET Web 表单开发，因为您无需担心前面的 ctl00 愚蠢：

```
$("[id$='txtFirstName']"); 
```

如评论中所述，如果不小心使用此选择器（与任何抽象层一样）可能会很慢。更喜欢将选择器的范围限定为某些包含元素，例如，

```
$(".container [id$='txtFirstName']"); 
```

减少需要遍历的元素的数量。

[jQuery 文档](http://docs.jquery.com/Selectors/attributeEndsWith#attributevalue)

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2011-03-23T17:17:32.890

**访问 iFrame 元素** iframe 并不是大多数问题的最佳解决方案，但是当您确实需要使用它时，知道如何使用 Javascript 访问其中的元素非常方便。jQuery 的 contents() 方法使这变得轻而易举，使我们能够像这样在一行中加载 iframe 的 DOM：

```
$(function(){
    var iFrameDOM = $("iframe#someID").contents();
    //Now you can use <strong>find()</strong> to access any element in the iframe:

    iFrameDOM.find(".message").slideUp();
    //Slides up all elements classed 'message' in the iframe
}); 
```

[资源](http://www.problogdesign.com/coding/30-pro-jquery-tips-tricks-and-strategies/)

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2010-07-06T20:01:27.590

## 在名称中增加行索引

如果您的输入元素名称包含如下行索引，则这是增加克隆输入元素的行索引的一种巧妙方法`'0_row'`：

```
$(this).attr('name', $(this).attr('name').replace(/^\d+/, function(n){ return ++n; })); 
```

克隆元素的名称现在将是`'1_row'`

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2010-02-07T20:04:18.677

**无冲突模式**

```
jQuery.noConflict(); 
```

> “运行这个函数将`$`变量的控制权交还给第一个实现它的库。这有助于确保 jQuery 不会与`$`其他库的对象发生冲突。
> 
> 通过使用此函数，您将只能使用该`jQuery`变量访问 jQuery。例如，你以前做的地方`$("div p")`，现在必须做`jQuery("div p")`"。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2011-07-20T23:23:19.963

绑定到一个事件并立即执行事件处理程序：

```
$('selector').bind('change now', function () { // bind to two events: 'change' and 'now'
    // update other portions of the UI
}).trigger('now'); // 'now' is a custom event 
```

这就像

```
function update() {
    // update other portions of the UI
}
$('selector').change(update);
update(); 
```

但无需创建单独的命名函数。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2011-02-10T20:41:45.517

一个不要脸[的插件……jQuery模板插件：使用render-functions实现复杂逻辑](http://roosteronacid.com/blog/index.php/2011/02/10/the-jquery-template-plug-in-implementing-complex-logic-using-render-functions/)

> 新的 jQuery 模板插件很棒。话虽如此，双花括号模板标签并不完全是我的一杯茶。在更复杂的模板中，标签会掩盖模板标记，并且通过简单的 if/else 语句实现逻辑是一种痛苦。
> 
> 在搞砸了插件几个小时后，我开始因为试图将模板中的标记与数百万个双花括号区分开来而感到头疼。
> 
> 所以我开了一片阿司匹林，开始研究另一种药物

# regex - 如何匹配一个管道字符，后跟空格和另一个管道？

> ID：182635
> 
> 赞同：9
> 
> 时间：2008-10-08T13:07:16.787
> 
> 标签：regex, perl

我正在尝试在以 . 开头的字符串中查找所有匹配项`| |`。

我试过了：`if ($line =~ m/^\\\|\s\\\|/)`这没有用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-08T13:09:32.537

您逃避管道的次数太多了，而是有效地逃避了反斜杠。

```
print "YES!" if ($line =~ m/^\|\s\|/); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-08T15:04:14.100

在 Perl 正则表达式中，管道字符应使用单个反斜杠进行转义。（Perl 正则表达式与 POSIX 正则表达式有点不同。如果您在 grep 中使用它，情况会有所不同。）如果您专门寻找它们之间的空格，请使用未转义的空格。它们在 Perl 正则表达式中是完全可以接受的。这是一个简短的测试程序：

```
my @lines = <DATA>;

for (@lines) {
    print if /^\| \|/;
}

__DATA__  
| | Good - space  
|| Bad - no space  
|   | Bad - tab  
 | | Bad - beginning space  
        Bad - no bars 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T15:09:42.763

如果它是您要搜索的文字字符串，则不需要正则表达式。

```
my $search_for = '| |';
my $search_in = whatever();
if ( substr( $search_in, 0, length $search_for ) eq $search_for ) {
    print "found '$search_for' at start of string.\n";
} 
```

或者这样做可能更清楚：

```
my $search_for = '| |';
my $search_in = whatever();
if ( 0 == index( $search_in, $search_for ) ) {
    print "found '$search_for' at start of string.\n";
} 
```

当您想在正则表达式中使用文字时，您可能还想查看[quotemeta 。](http://perldoc.perl.org/functions/quotemeta.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T18:28:35.667

删除 ^ 和双反斜杠。^ 强制字符串位于字符串的开头。由于您要在一个字符串中查找所有匹配项，因此这可能不是您想要的。

```
m/\|\s\|/ 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-08T13:12:46.883

关于什么：

```
m/^\|\s*\|/ 
```

# java - 如何确定泛型类型的类？

> ID：182636
> 
> 赞同：61
> 
> 时间：2008-10-08T13:07:34.040
> 
> 标签：java, generics

我正在创建一个泛型类，并且在其中一种方法中我需要知道当前使用的泛型类型的类。原因是我调用的方法之一期望 this 作为参数。

例子：

```
public class MyGenericClass<T> {
  public void doSomething() {
    // Snip...
    // Call to a 3rd party lib
    T bean = (T)someObject.create(T.class);
    // Snip...
  }
} 
```

显然，上面的示例不起作用并导致以下错误：类型参数 T 的非法类文字。

我的问题是：有人知道一个好的替代方案或解决方法吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-08T13:12:35.713

仍然存在同样的问题：通用信息在运行时被删除，无法恢复。一种解决方法是在静态方法的参数中传递类 T：

```
public class MyGenericClass<T> {

    private final Class<T> clazz;

    public static <U> MyGenericClass<U> createMyGeneric(Class<U> clazz) {
        return new MyGenericClass<U>(clazz);
    }

    protected MyGenericClass(Class<T> clazz) {
        this.clazz = clazz;
    }

    public void doSomething() {
        T instance = clazz.newInstance();
    }
} 
```

这很丑陋，但它有效。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-01-15T10:35:46.110

我只是指出了这个解决方案：

```
import java.lang.reflect.ParameterizedType;

public abstract class A<B> {
    public Class<B> g() throws Exception {
        ParameterizedType superclass =
            (ParameterizedType) getClass().getGenericSuperclass();

        return (Class<B>) superclass.getActualTypeArguments()[0];
    }
} 
```

如果`A`子类给定了具体类型，则此方法有效：

```
new A<String>() {}.g() // this will work

class B extends A<String> {}
new B().g() // this will work

class C<T> extends A<T> {}
new C<String>().g() // this will NOT work 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-07T23:06:15.897

不幸的是，Christoph 所写的解决方案仅在非常有限的情况下有效。[编辑：正如下面评论的那样，我不再记得我对这句话的推理，它可能是错误的：“请注意，这首先只适用于抽象类。”] 下一个困难是`g()`只适用于`A`. 不过，我们可以解决这个问题：

```
private Class<?> extractClassFromType(Type t) throws ClassCastException {
    if (t instanceof Class<?>) {
        return (Class<?>)t;
    }
    return (Class<?>)((ParameterizedType)t).getRawType();
}

public Class<B> g() throws ClassCastException {
    Class<?> superClass = getClass(); // initial value
    Type superType;
    do {
        superType = superClass.getGenericSuperclass();
        superClass = extractClassFromType(superType);
    } while (! (superClass.equals(A.class)));

    Type actualArg = ((ParameterizedType)superType).getActualTypeArguments()[0];
    return (Class<B>)extractClassFromType(actualArg);
} 
```

这将在实践中的许多情况下起作用，但并非总是如此。考虑：

```
public class Foo<U,T extends Collection<?>> extends A<T> {}

(new Foo<String,List<Object>>() {}).g(); 
```

这将抛出 a `ClassCastException`，因为这里的类型参数根本不是 a`Class`或 a `ParameterizedType`；这是`TypeVariable` `T`. 所以现在你会被困在试图弄清楚`T`应该代表什么类型，等等。

我认为唯一合理的一般答案类似于 Nicolas 最初的答案——一般来说，如果您的类需要实例化在编译时未知的其他类的对象，则您的类的用户需要传递该类文字（或者，也许是一个工厂）明确地添加到你的类中，而不是仅仅依赖于泛型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-09T07:23:59.327

我找到了另一种获取通用对象类的方法

```
public Class<?> getGenericClass(){
         Class<?> result =null;
         Type type =this.getClass().getGenericSuperclass();

         if(type instanceofParameterizedType){
              ParameterizedType pt =(ParameterizedType) type;
              Type[] fieldArgTypes = pt.getActualTypeArguments();
              result =(Class<?>) fieldArgTypes[0];
        }
        return result;
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-21T17:13:15.020

T 可以很容易地使用[TypeTools](https://github.com/jhalterman/typetools)解决：

```
Class<T> t = (Class<T>) TypeResolver.resolveRawArguments(
                                MyGenericClass.class, getClass()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-11T21:59:08.600

我将详细说明 Christoph 的解决方案。

这是 ClassGetter 抽象类：

```
private abstract class ClassGetter<T> {
    public final Class<T> get() {
        final ParameterizedType superclass = (ParameterizedType)
            getClass().getGenericSuperclass();
        return (Class<T>)superclass.getActualTypeArguments()[0];
    }
} 
```

这是一个静态方法，它使用上述类来查找泛型类的类型：

```
public static <T> Class<T> getGenericClass() {
    return new ClassGetter<T>() {}.get();
} 
```

作为其用法的示例，您可以使用以下方法：

```
public static final <T> T instantiate() {
    final Class<T> clazz = getGenericClass();
    try {
        return clazz.getConstructor((Class[])null).newInstance(null);
    } catch (Exception e) {
        return null;
    }
} 
```

然后像这样使用它：

```
T var = instantiate(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-05-29T05:53:23.670

公共类 DatabaseAccessUtil {

```
EntityManagerFactory entitymanagerfactory;
EntityManager entitymanager;

public DatabaseAccessUtil() {
    entitymanagerfactory=Persistence.createEntityManagerFactory("bookmyshow");
    entitymanager=entitymanagerfactory.createEntityManager();
}

public void save  (T t) {
    entitymanager.getTransaction().begin();
    entitymanager.persist(t);
    entitymanager.getTransaction().commit();
}

public void update(T t) {
    entitymanager.getTransaction().begin();
    entitymanager.persist(t);
    entitymanager.getTransaction().commit();
}

public void delete(T t) {
    entitymanager.getTransaction().begin();
    entitymanager.remove(t);
    entitymanager.getTransaction().commit();
}

public Object retrieve(Query query) {
    return query.getSingleResult();
}
//call the method - retrieve(object,requiredclass.class)
public Object retrieve(Object primaryKey,class clazz) throws Exception {

    return entitymanager.find(clazz,primaryKey);    

} 
```

}

# windows - 我应该如何在 Windows Vista PC 上安装 Linux？

> ID：182637
> 
> 赞同：8
> 
> 时间：2008-10-08T13:07:40.420
> 
> 标签：windows, linux, ubuntu, windows-vista

除了 c 和 c++ 开发之外，我还在进行 .net 编程，并且希望在我的家用机器上具有更大的灵活性。我希望能够在我的家用计算机上同时安装 Linux（可能是 Ubuntu）和 Windows Vista。有没有一种方法可以同时安装并在启动时提示要启动哪个？有没有办法将 Windows 设置为默认值？

我以前在本科的 CS 实验室中看到过这一点。

另外，我认为如果我将 Windows 32 位与 Ubuntu 64 位一起使用不会有问题。有什么建议吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-08T13:11:29.163

最新版本的 Ubuntu 包括一个名为[Wubi](http://wubi-installer.org/)的安装程序，它将 Ubuntu 安装为 Windows 应用程序（即：可以从添加/删除程序中卸载它）并为您设置双启动！对于那些想在不进行系统大修的情况下尝试 Linux 的人来说，这非常棒！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-08T13:08:35.427

您可以双启动，但我建议您使用虚拟机来完成您想做的事情。

看看[VMWare](http://www.vmware.com/)和[Virtual PC](http://www.microsoft.com/windows/products/winfamily/virtualpc/default.mspx)。

有关 Virtual PC 的更多信息：[http ://en.wikipedia.org/wiki/Microsoft_Virtual_PC](http://en.wikipedia.org/wiki/Microsoft_Virtual_PC)

有关 VMWare 的更多信息：[http ://en.wikipedia.org/wiki/VMware_Workstation](http://en.wikipedia.org/wiki/VMware_Workstation)

您应该注意，双启动 Windows 和 Linux 可能有点风险，而且有点永久性。在虚拟机中运行意味着您可以在一个窗口中运行 Linux 安装，而完全不用担心它会影响您的开发机器。软件不会知道差异，因此您的测试不会受到影响。

考虑到虚拟机就像一个沙盒，您可以在其中尝试新的和不同的东西，而不必担心后果。

虚拟机运行确实需要一些开销，因此您不应该期望通过它们玩游戏或任何东西。我想说，就性能而言，这非常类似于通过远程桌面（良好的 LAN 连接）登录机器。

编辑：您还可以查看[VirtualBox 。](http://www.virtualbox.org/)感谢我评论中的帮助者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T13:10:45.327

我也建议为此使用虚拟机。

我在某些 Linux 发行版上遇到了 Virtual PC 的问题（想到了 Fedora Core），但在[VMWare](http://www.vmware.com/)或[Virtual Box](http://www.virtualbox.org/)上没有问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T14:18:05.190

即使是双引导，在安装另一个操作系统之前也要三思而后行。它很少简单，即使像 Ubuntu 这样的安装程序不需要你在命令行上乱七八糟。您可能会花费数天时间试图让您通常的操作系统恢复正常，尤其是在您使用 Vista 的情况下。

VMWare 和 Virtual PC 都是不错的选择。在其中一个上进行测试安装，并在决定安装之前使用操作系统一段时间。

使用虚拟机的另一件好事是您只需担心在主操作系统上对网络设置进行排序，因为 VMWare（等）会借用这些设置。

此外，如果可能，请尝试使用 Live CD 或 DVD 上的操作系统来启动。您可能还会发现您可以从 U 盘运行操作系统。这显然有利于便携性 - 但请注意，您也可以将虚拟机放在可移动 USB 驱动器上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T15:01:24.620

您所要做的就是访问[http://www.ubuntu.com/getubuntu/download](http://www.ubuntu.com/getubuntu/download)并按照说明进行操作。我下载了 Ubuntu，将其刻录到 CD，然后使用驱动器中的 CD 重新启动。我不必购买第二块硬盘，也不必担心它会干扰我的 Vista Home Premium 安装。

使用 Ubuntu（与大多数安装 Live CD 的发行版一样），您需要做的就是弹出光盘，启动，然后单击菜单。默认情况下，双启动设置完美，您甚至不必考虑它。我已经在我的 Vista Home Premium 机器上使用 Ubuntu、Debian、PC Linux OS、Freespire 和 Xandros 完成了这项工作，它们都以这种方式工作。

如果你是偏执狂，那么你应该备份你的电脑。如今，与硬盘驱动器（USB 或内部）一样便宜，确实没有理由不完整备份您的系统。这太容易了。我使用 Acronis True Image，但我也听说过有关 Norton Ghost 的好消息。

Regadless，您不需要 Wubi 或 VMWare，或任何虚拟的任何东西，带有双引导设置的直接安装是典型 Live CD Linux 安装的默认设置，它甚至适用于 Vista。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T13:31:59.980

多年来，我以不同的方式完成了它，我想说使用虚拟机是我最喜欢的一种。我试过VMWare和VirtualBox，都是免费的，我更喜欢VirtualBox，因为你可以直接使用.iso。您不需要有人为您创建虚拟机映像。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T15:47:15.773

另一种选择是在 Windows 上实际将 Linux 作为应用程序运行，这样您就可以让 Linux 几乎全速运行，同时还能够同时运行 Windows 应用程序。在[http://www.colinux.org/](http://www.colinux.org/)上查看。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T13:54:58.683

我还没有机会玩它，但对我来说看起来很有希望的一个选项是 Ubuntu 中的一个工具，用于创建一个带有 Ubuntu 的可启动 USB 驱动器。它具有 live cd 的优点（对您的系统没有影响）、比 live CD 更好的性能以及在会话之间保存数据的能力。我以前用过五笔，但不记得为什么要卸载它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-10T13:40:56.893

看看“cygwin”。

这在您的 Windows 环境中安装了一个“类似 linux”的窗口应用程序。它对 gcc 和大多数标准 gnu/linux 开发工具有很好的支持。

你不必搞乱双启动。它特别适合测试与 unix 通信的窗口，因为您可以在一个盒子中启动并运行所有内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-08T13:13:51.797

您正在寻找的是所谓的“双启动”。它允许人们在开始时选择要启动的操作系统。它在 Linux 中得到很好的支持，尤其是 Ubuntu。只需安装 Ubuntu，它将默认设置双启动。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-08T13:14:12.763

您可以采用任何一种方式，双启动或使用虚拟机。我认为这取决于您在 Linux 环境中开发时是否要使用任何 Windows 应用程序。如果是这样，我会使用虚拟机，否则，[这里](http://www.howtoforge.com/dual_boot_windows_xp_vista_ubuntu_feisty)有一个设置双启动计算机的教程。它有一部分是关于安装两个操作系统的，还有一部分是关于你是否已经安装了 Windows。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-08T13:14:17.927

Wubi 是一个很棒的（特定于 Ubuntu 的）解决方案。我发现的唯一问题是将 Wubi 安装在 FAT 格式的 Windows 分区上——那时我遇到了严重的问题。此外，它可能会运行得稍微慢一些，因为在进行磁盘访问时还有另一层，但我不能说我已经注意到了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-08T14:27:37.793

我双启动 Vista Ultimate 32 位和 Ubuntu 8.10 beta 64 位没有问题。在我看来，关键是要有一个完全独立的硬盘来安装 Ubuntu。这消除了很多风险，因为您不必大惊小怪地对主 HDD 进行分区，并且如果您决定不想要它，也可以非常简单地删除 Ubuntu。

安装时请注意并注意您选择的驱动器。我很容易将它们区分开来，因为我的 Linux 驱动器与我的主要 Vista 和数据存储驱动器的大小不同。

如果您宁愿走虚拟机路线，VMware Player 运行良好，而且我听说过有关 VirtualBox 的好消息。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-02T04:36:49.930

尝试 ubuntu 的 live cd install :D

创建可启动闪存盘很容易 - 来自 sourceforge.net 的 unetbootin

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-09-21T21:57:15.803

我已经多次双启动 Ubuntu 和 Xp，完全没有问题。我怀疑你可以用一个 32 位操作系统和另一个 64 位操作系统来做虚拟的事情。这不会是双引导的问题。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-06-03T20:30:53.437

我在使用 wubi 时遇到了问题，而且我现在启动到 windows7 时充其量是不稳定的，所以事后看来，选择 VM 解决方案会更有利。然而，在其他机器上，我通过在启动时选择 try ubuntu 选项在 USB 上运行 Ubuntu Live（使用 pendrivelinux.com 安装），并且运行良好并且很快就开始了。

# php - 如何将第一个字母显示为大写？

> ID：182641
> 
> 赞同：6
> 
> 时间：2008-10-08T13:08:27.190
> 
> 标签：php, mysql

我的数据库中有 fname 和 lname，名称可以存储为 JOHN DOE 或 john DOE 或 JoHN doe，但最终我想将其显示为 John Doe

fname 是 John， lname 是 Doe

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-08T13:12:27.820

请注意，还有其他大写格式，例如 John McDoe、John D'Oe、John de O 和 John van den Doe。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-08T13:12:41.190

看到它被标记为 PHP:
要么

> `string ucfirst ( string $str );`

将第一个单词的第一个字母大写

或者

> `string ucwords ( string $str );`

将每个单词的首字母大写

您可能希望将它们与

> `string strtolower ( string $str );`

首先将所有名称标准化为小写。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-08T13:11:28.120

我不确定你想在哪里以及如何显示它，但如果它在网页上，你可以尝试使用 CSS 简单地改变显示。尝试添加：

```
text-transform:capitalize; 
```

到相关规则，像这样：

```
.name { text-transform:capitalize;} 
```

如果您将名称放在带有 class="name" 的 div 或 span 中。当然，这不会以任何方式改变数据库条目，但我不清楚哪个更可取。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-08T13:12:53.590

[来自php.net](http://lt.php.net/manual/en/function.ucfirst.php)的示例：

```
$bar = 'HELLO WORLD!';
$bar = ucfirst($bar);             // HELLO WORLD!
$bar = ucfirst(strtolower($bar)); // Hello world! 
```

请记住有关语言环境的注释...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T13:24:51.773

对于简单的名称，这将起作用。请注意特殊情况（如以下示例中的“麦当劳叔叔”）。

**在 SQL Server 中：**

```
SELECT  --step 2: combine broken parts into a final name
  NAME_PARTS.FNAME_INITIAL + NAME_PARTS.REST_OF_FNAME AS FNAME
 ,NAME_PARTS.LNAME_INITIAL + NAME_PARTS.REST_OF_LNAME AS LNAME
FROM
  (     --step 1: break name into 1st letter and "everything else"
  SELECT
    UPPER(SUBSTRING(TEST.FNAME,1,1)) AS FNAME_INITIAL
   ,UPPER(SUBSTRING(TEST.LNAME,1,1)) AS LNAME_INITIAL
   ,LOWER(SUBSTRING(TEST.FNAME,2,LEN(TEST.FNAME))) AS REST_OF_FNAME
   ,LOWER(SUBSTRING(TEST.LNAME,2,LEN(TEST.LNAME))) AS REST_OF_LNAME
  FROM
    (   --step 0: generate some test data
          SELECT 'john' AS FNAME, 'doe' as LNAME
    UNION SELECT 'SUZY', 'SMITH'
    UNION SELECT 'bIlLy', 'BOb'
    UNION SELECT 'RoNALD', 'McDonald'
    UNION SELECT 'Edward', NULL
    UNION SELECT NULL, 'Jones'
    ) TEST
  ) NAME_PARTS 
```

**在甲骨文中**

```
SELECT  --step 2: combine broken parts into a final name
  NAME_PARTS.FNAME_INITIAL || NAME_PARTS.REST_OF_FNAME AS FNAME
 ,NAME_PARTS.LNAME_INITIAL || NAME_PARTS.REST_OF_LNAME AS LNAME
FROM
  (     --step 1: break name into 1st letter and "everything else"
  SELECT
    UPPER(SUBSTR(TEST.FNAME,1,1)) AS FNAME_INITIAL
   ,UPPER(SUBSTR(TEST.LNAME,1,1)) AS LNAME_INITIAL
   ,LOWER(SUBSTR(TEST.FNAME,2,LENGTH(TEST.FNAME))) AS REST_OF_FNAME
   ,LOWER(SUBSTR(TEST.LNAME,2,LENGTH(TEST.LNAME))) AS REST_OF_LNAME
  FROM
    (   --step 0: generate some test data
          SELECT 'john' AS FNAME, 'doe' as LNAME FROM DUAL
    UNION SELECT 'SUZY', 'SMITH' FROM DUAL
    UNION SELECT 'bIlLy', 'BOb' FROM DUAL
    UNION SELECT 'RoNALD', 'McDonald' FROM DUAL
    UNION SELECT 'Edward', NULL FROM DUAL
    UNION SELECT NULL, 'Jones' FROM DUAL
    ) TEST
  ) NAME_PARTS 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-08T13:53:06.850

结合 PHP 速记函数[strtolower](http://php.net/strtolower)和[ucwords](http://php.net/ucwords)可以解决您的问题：

```
function ucname($f, $l)
{
    return ucwords(strtolower($f." ".$l));
}
echo ucname($fname, $lname); 
```

附带说明一下，请记住，您可以在许多不同的阶段进行这种数据美化：

1.  在插入之前，在您的应用程序中
2.  在插入期间，在 SQL 插入/更新查询中使用字符串函数
3.  在提取期间，在 SQL 选择查询中使用字符串函数
4.  提取后，在您的应用程序中

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-08T13:11:00.803

将名称更改为小写，然后将 ('A' - 'a') 添加到 fname 和 lname 的第一个字母。

# c# - 如何为将在 Rhino Mocks 中的另一个线程上进行的调用设置期望

> ID：182648
> 
> 赞同：1
> 
> 时间：2008-10-08T13:09:22.770
> 
> 标签：c#, nunit, rhino-mocks

我有一个类，旨在启动一个后台线程，从中调用一个管理器。出于单元测试的目的，该经理将被嘲笑。相关的代码片段是：

```
 MockRepository mocks = new MockRepository();
ICacheManager manager = mocks.CreateMock<ICacheManager>();

Expect.On(manager).Call(manager.CacheSize).Return(100);
mocks.ReplayAll();

CacheJanitor janitor = new CacheJanitor(manager);

// get janitor to do its stuff
// ...

mocks.VerifyAll(); 
```

问题是，经过验证后，我们抛出了两个异常 - 一个在测试线程上表明调用`CacheSize`是预期的但没有发生，另一个在后台线程（在 内`CacheJanitor`）表明调用`CacheSize`发生但不是预期的。

显然，期望与创建它们的线程有密切关系。有谁知道一种方法来指示 Rhino Mocks 期望在不同的线程上进行调用（在定义期望时甚至不存在）？

编辑：

忘了提到我们在不久的将来仍然使用 VS 2005 的限制。Rhino Mocks 版本是 3.4 - 我将尝试使用 3.5，但改进列表似乎并未表明该区域有任何修复。

目前我可能会为这一系列测试创建自己的模拟对象并在其中记录结果，但肯定会感谢任何允许我使用 Rhino Mocks 干净地实现这一目标的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T13:21:58.767

哇。太疯狂了。我已经使用 MoQ 毫无问题地做这种事情。

你用的是什么版本的犀牛？您以 3.5 之前的方式使用它；也许这不会是 3.5 版的问题？

另一种选择是避免验证对模拟的期望。（对不起，我不熟悉 Rhino 的语法，但它可能是可能的）。使用回调在测试函数中设置局部变量并验证该变量。

在 MoQ 中，我会这样做：

```
// Arrange
var called = false;
var mock = new Mock<SomeObject>();            

mock.Expect(x => SomeFunction()).Callback(() => called = true);            

var target = new MultithreadedTarget(mock.Object);            

// Act
target.DoSomethingThatCallsSomeFunctionOnAnotherThreadLol();            

// this part is a bit ugly
// spinlock for a bit to give the other thread a chance
var timeout = 0;
while(!called && timeout++ < 1000)
  Thread.Sleep(1);

// Assert
Assert.IsTrue(called); 
```

# c# - .NET 的视觉打印设计

> ID：182670
> 
> 赞同：2
> 
> 时间：2008-10-08T13:12:25.887
> 
> 标签：c#, .net, vb.net, printing

我有一个正在处理的项目，我需要能够从该程序中打印出身份证。是否有任何价格合理的产品，以便我可以设计用于打印的文档并在 .NET 中使用它？我试图避免使用 System.Drawing 手动操作，因为当我工作的公司需要更改 ID 卡时，以后更改它会很痛苦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T13:15:25.600

您可以使用 Adob​​e Acrobat 和其中一个库来编写 PDF。这样您就可以在 Adob​​e Acrobat 中设计文档模板，用代码填写它，然后用代码打印它。有一些开源 PDF 编写器和一些商业编写器。不同之处在于功能集。

我过去使用过[PDFWriter](http://www.codeproject.com/KB/printing/PDFWriter.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T14:47:26.397

我使用 PowerPoint 文档作为模板做了类似的事情。我在 PP 文档上放置字段或标签，然后以编程方式填充它们。显然，添加或删除字段需要更改代码，但可以轻松更改 PP 文档的布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T15:22:44.827

使用 WPF 是一种选择吗？您可以将 WPF UserControl 制作为单独的卡片（并使用 WYSIWYG 设计器使其看起来像您想要的那样），然后您可以创建一个包含充满卡片的网格的窗口，以编程方式填充它们，然后将它们打印出来。

# php - 为什么有些 PHP 错误没有写入 PHP 日志？

> ID：182675
> 
> 赞同：1
> 
> 时间：2008-10-08T13:12:46.180
> 
> 标签：php, logging, error-handling

在我必须处理的服务器上，来自虚拟主机的错误不会进入标准 PHP 错误日志。

在 php.ini 我们有

```
log = /var/log/file 
```

并且`phpinfo()`没有显示虚拟主机和整个服务器之间的任何区别。

但是由设置的回调函数`set_error_handler()`捕获不在php日志中的错误。

`error_reporting`设置为`E_ALL`一次并且从不修改。

你能帮我找到一种方法来探索这里发生的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T13:19:02.330

也许[不应该](http://php.net/error-reporting)记录未记录的错误？使用[set_error_handler 时，错误报告设置无效](http://php.net/set_error_handler)，因此您会看到比日志文件中更多的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T20:06:44.587

我将查看 php.ini 中的 error_log、log_error 和 error_reporting 指令，并查看 httpd.conf，因为还可以使用“php_admin_value”等添加指令。

# c# - LinqToSql 引用的实体会抛出 NullReferenceException

> ID：182683
> 
> 赞同：1
> 
> 时间：2008-10-08T13:14:27.050
> 
> 标签：c#, .net, sql, database, linq

我的 LinqToSql 模型有一个非常有趣的问题。在我的一些表上，我有对其他表的引用，在 LinqToSql 中，这由 EnitiyRef 类表示，当您尝试访问引用表时，LinqToSql 将从数据库中加载引用。

在我的开发机器上一切正常（引用被完美加载）但昨晚我将更改上传到我们的生产服务器并在尝试访问我的表上的引用时开始收到 NullReferenceExceptions。

示例代码：

```
var sale = db.Sales.Single(s => s.ID == 1);
string username = sale.User.Name;    // User is a reference to a User table
                                     // LinqToSql will automatically load the
                                     // row and access the fields i need.

// On my server the sale.User throws an exception that its null (User) but the user
// is definitly in the database (there is even a FK constraint from Sale to User) 
```

起初我以为我的 DataContext 得到了 GC，但我仔细检查了所有内容，但没有结果（除了它适用于我的盒子）。

（服务器和我的机器上的一切都是一样的，相同的 dll，相同的 db 架构等......）（我实际上将整个 DBF 文件复制到了我的服务器上，所以它的架构完全相同）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T13:16:27.203

您是否打开了上下文日志记录并将开发盒上的结果与生产盒上的结果进行了比较？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T13:25:19.073

如果将源移动到生产服务器并在那里编译，请尝试为 DataContext 重新生成生成的源。您可以通过从 DataContext 源文件的上下文菜单中运行“运行用户定义的工具”来执行此操作。

如果两者共享相同的二进制文件，请确保两个数据库中的数据库定义完全相同。像一列在生产服务器上可以为空但在您的 devbox 上不能为空这样的小差异可能会产生重大影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T14:04:22.317

为了找到并解决这样的问题，堆栈跟踪和数据库分析可能会有所帮助。

问题可能是安全问题。您是否尝试在 Management Studio 中使用与您的应用程序使用的凭据相同的凭据登录并在表格上进行选择。

这至少会让您对安全性或 linq 问题有所了解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T15:09:59.550

检查 DataContext 生命周期。这里可能有陈旧的缓存在起作用

例如：

1.  Context1：加载 ID == 1 的 Sale。检查其 User 属性并观察 null User。
2.  上下文 2：加载 ID == 1 的销售。通过添加新用户来修改用户属性。犯罪。
3.  上下文 1：加载 ID == 1 的销售。检查其用户属性。是的，仍然为空（它被缓存了！！）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T16:49:40.550

一种可能性是您的 DBML 使用的连接字符串仍然指向生产以外的数据库服务器。

每当在 ASPX 页面中直接使用 LinqDataSource 时，我们都会遇到这种情况，因此 DataContext 使用默认构造函数，该构造函数指向基于最后一个开发人员用于导入 DBML 的数据库的连接字符串。

我们所做的是创建一个继承自生成的 DataContext 的 DataContext 对象，并使用 web.config 中的正确连接字符串覆盖默认构造函数。

# visual-studio - VS2008 起始页替换

> ID：182691
> 
> 赞同：9
> 
> 时间：2008-10-08T13:15:13.883
> 
> 标签：visual-studio, visual-studio-2008

我真的不喜欢 VS2008 起始页。我不需要 RSS 阅读器、入门或标题。唯一有用的是“最近的项目”

**有没有办法定制它或用更好的替换？**
该页面包含收藏夹项目和最近的项目会很好。

PS 我知道我可以禁用它或用其他网页替换它，只是寻找一个好的生产力提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T13:19:39.460

转到工具 > 选项 > 环境 > 启动并选择您喜欢的最佳选项

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T17:07:57.033

这是一篇详细介绍如何精确自定义起始页的文章。不幸的是，这看起来是一个相当艰巨的过程。但是，嘿，如果你有时间...

[自定义 Visual Studio .NET 2003 起始页](http://msdn.microsoft.com/en-us/library/aa290348.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T13:24:43.117

一个建议是按照此处的步骤操作：http: [//blogs.msdn.com/saraford/archive/2008/01/03/did-you-know-how-to-customize-what-visual-studio-opens- to-or-how-to-make-the-start-page-not-show-up-when-vs-opens.aspx](http://blogs.msdn.com/saraford/archive/2008/01/03/did-you-know-how-to-customize-what-visual-studio-opens-to-or-how-to-make-the-start-page-not-show-up-when-vs-opens.aspx)

您还可以在[此处](http://msdn.microsoft.com/en-us/library/aa991992.aspx)查看有用的信息。Aso 对于建议的事情，请查看这篇[文章](http://www.bluevisionsoftware.com/WebSite/TipsAndTricksDetails.aspx?Name=VSStartPage)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T13:10:13.613

Kyralessa 发布的链接是对您原始问题的完整答案。不幸的是，它看起来确实是一个复杂的过程。

我只是补充一点，如果您担心与获取 RSS 提要相关的任何性能影响，您可以输入一个不存在的 URL，这样`http://localhost:12345`会很快失败并减少需要呈现的内容量。这样，您可以保留“最近的项目”面板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-14T15:47:48.540

我也不喜欢显示来自 MSDN 的最新文章和新闻的启动页面。

我不介意浏览几篇文章，但是 RSS 提要非常慢，而且等待确实会降低工作效率，尤其是当我发现自己一直在打开和关闭它时。

禁用起始页时，Visual Studio 的加载速度会更快。

这是如何做到的：

> 转到**工具**=>**选项**
> 
> 选择**Environment节点下的****Startup**子节点。
> 
>  ****取消勾选**新闻文章的自动加载
> 
> 清除**url 框**...只是为了确定 ;)
> 
> 从组合框中选择**“显示空环境”****

 **现在，惊叹于 Visual Studio 2008 的显着速度提升。

# java - 如何使用 JavaMail API 在带有 Java 的电子邮件中发送二进制附件？

> ID：182702
> 
> 赞同：0
> 
> 时间：2008-10-08T13:17:12.630
> 
> 标签：java, email, smtp, jakarta-mail

使用JDK1.5 如何使用JavaMail API 轻松发送二进制附件（如PDF 文件）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T13:27:11.643

您看过[JavaMail 常见问题解答](http://java.sun.com/products/javamail/FAQ.html)吗？它似乎有一些片段来演示这个过程（以及如何解决一个常见问题——内存不足）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T13:42:22.300

假设您不想阅读某些链接并且不想要任何外部依赖项，则需要使用 MimeMultipart 和 BodyPart：

```
MimeMultipart messageContent = new MimeMultipart();

BodyPart bodyPart = new MimeBodyPart();
DataSource source = new FileDataSource(yourFile);
bodyPart.setDataHandler(new DataHandler(source));
bodyPart.setFileName("MyFile.ext");
bodyPart.setDisposition(Part.ATTACHMENT);

// Then add to your message:
messageContent.addBodyPart(bodyPart); 
```

将正文附加到消息只是附加具有处置 Part.INLINE 的 BodyPart

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T13:27:06.510

如果您想轻松完成，我建议您使用[Commons-Email](http://commons.apache.org/email/)！它建立在 JavaMail API 之上，但它更简单。

[用户指南](http://commons.apache.org/email/userguide.html)中有一个关于如何发送带有附件的电子邮件的示例……它比使用标准 JavaMail API 容易得多！

# wpf - 您在 WPF 工作中使用了哪些设计模式，您喜欢哪种设计模式？

> ID：182707
> 
> 赞同：5
> 
> 时间：2008-10-08T13:19:33.717
> 
> 标签：wpf, design-patterns, tdd, mvp

我一直在研究有几个人建议的 Model-View-ViewModel 模式（尤其是 John Gossman，看看这篇[文章](http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx)和这个[播客](http://pixel8.infragistics.com/#Episode:9071)），但是**人们使用和喜欢的其他模式（如果有的话）。 .. 他们在哪里增加价值？**

我也偶然发现：

*   模型-视图-视图模型
*   [演示模型](http://blogs.southworks.net/jdominguez/2008/04/using-the-presentation-model-in-wpf/)
*   [数据模型-视图-视图模型](http://blogs.msdn.com/dancre/archive/2006/10/11/datamodel-view-viewmodel-pattern-series.aspx)
*   [Prism 中的模式](http://msdn.microsoft.com/en-us/library/cc707841.aspx)（现在称为 WPF 的复合应用程序指南）

我很乐意就上述这些以及我可能尚未发现的那些进行积极讨论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T17:33:43.567

我们使用和喜爱的另一种模式是**附加行为模式**......使用 WPF 中附加属性的可扩展性机制。也有很多关于这种有用模式的帖子。

*   [http://blogs.msdn.com/johngossman/archive/2008/05/16/attachedbehavior-pattern-sample.aspx](http://blogs.msdn.com/johngossman/archive/2008/05/16/attachedbehavior-pattern-sample.aspx)
*   [http://blogs.msdn.com/johngossman/archive/2008/05/07/the-attached-behavior-pattern.aspx](http://blogs.msdn.com/johngossman/archive/2008/05/07/the-attached-behavior-pattern.aspx)
*   [http://blogs.msdn.com/dancre/archive/2006/03/04/543854.aspx](http://blogs.msdn.com/dancre/archive/2006/03/04/543854.aspx)
*   [http://www.codeproject.com/KB/WPF/AttachedBehaviors.aspx](http://www.codeproject.com/KB/WPF/AttachedBehaviors.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T14:32:45.647

我一直在使用 Model-View-Presenter 模式的变体。它很好地满足了我们开发各种 UI 的目的。它并不完美，但它可以很好地完成工作。我遇到的问题之一是我对多线程场景从不满意。我们最近一直在使我们的许多演示者成为多线程的。由于这些工作线程最终会更新 UI，因此我们不得不通过 View 的调度程序向 UI 调度操作。如果每个 View 属性都检查调度程序，代码会变得非常冗长，因此由于时间限制，我们最终将 View 的调度程序暴露给 Presenter。如果你问我，这不是最大的举动......

我们正在使用类似于 CAB 和 Prism 的模块化 UI 框架，因此其中很多模式也适用于我们。

我也是 WPF 中命令的忠实粉丝。我还不能玩弄 Prism 的 DelegateCommand 和 CompositeCommand，但它们听起来真的很不错。

# .net - .NET 中抛出的奇怪异常

> ID：182711
> 
> 赞同：4
> 
> 时间：2008-10-08T13:20:05.213
> 
> 标签：.net, vb.net, exception

抛出异常：“System.ComponentModel.ReflectPropertyDescriptor 未标记为可序列化”

这是否意味着我错过了自己将某些东西标记为可序列化，或者这是我无法控制的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T13:31:10.123

您能否提供更多关于何时发生这种情况以及使用哪个序列化程序的上下文？大多数序列化程序都能够忽略某些成员 - `NonSerializedAttribute`for `BinaryFormatter`、`XmlIgnoreAttribute`for`XmlSerializer`等。

在你的类中有一个`PropertyDescriptor`实例通常意味着你的类是一个属性包；在这种情况下，您可能需要进行自定义序列化 ( `ISerializable`/ `IXmlSerializable`)。如果该字段由于其他原因而存在，只需将其标记为忽略即可。

当您有一个事件（例如更改通知事件 / `INotifyPropertyChanged`）与 UI 挂钩（数据绑定）时，这种（或类似的症状）也很常见；在这种情况下，您需要将支持字段标记为非序列化。我不了解 VB，但是使用 C#，您可以使用“类似字段的事件”来执行此操作，如下所示：

```
[field: NonSerialized]
public event EventHandler BarChanged; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T13:25:52.443

您的班级中有这种类型的字段吗？如果是这样，您将必须自己实现 ISerializable - 自动实现要求您的所有字段都标记为 Serializable。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T13:31:44.147

它在你的控制之中。问题很可能与此相同： [http ://www.codeplex.com/SharedCache/Thread/View.aspx?ThreadId=19759](http://www.codeplex.com/SharedCache/Thread/View.aspx?ThreadId=19759)

# twitter - Twitter 会帮助您成为更好的开发人员还是分散您的注意力？

> ID：182714
> 
> 赞同：4
> 
> 时间：2008-10-08T13:21:17.333
> 
> 标签：twitter

自从我加入 twitter 以来，我发现掌握技术的脉搏和它的发展方向非常有帮助。

我关注了许多顶级 Microsoft 开发人员，发现他们的奋斗、意见和影响很有趣……

*   编码恐怖/杰夫阿特伍德
*   shanselman / 斯科特·汉塞尔曼
*   哈克/菲尔·哈克
*   里克斯特拉尔 / 里克斯特拉尔
*   罗伊奥舍罗夫/罗伊奥舍罗夫

可以说，推特只是一种分散注意力的东西，而不是一种灵感。

你是如何发现 twitter 成为精通技术的媒介的？它有帮助还是只是浪费时间？

如果您觉得它有用……您会建议关注 ASP.NET 领域的谁？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-08T13:23:30.793

分心，很像crackoverflow ;)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-08T14:03:17.467

这绝对是一种分心，但我发现这里和那里有趣的分心对我有好处。当我的士气高涨时，我会在更短的时间内完成更多的工作，而与外界的联系对此有所帮助。我关注我的妻子、我们的猫（是的，有一个 twitter）、几个朋友、几个 ColdFusion 和 Flex 传播者、一个 SQL Server MVP、一些喜剧救济推特，以及其他开发人员和朋友。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-08T13:23:02.900

这取决于你如何使用它。它不会比 RSS 阅读器或 stackoverflow 更让人分心。例如，如果您将使用量分配给午餐时间，那就没问题了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T18:53:45.267

分心，我用了1周就停了。我知道你在生活中需要“接触”，但你也需要一些时间来工作。我需要问一个问题，我去产品论坛或这里问。如果我需要联系我认识的人，我会使用 IM。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T18:47:11.973

分心！我们不得不将它用于项目更新，并且不禁浪费时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T13:26:05.267

这让人分心……尤其是因为大多数**推文**都与编程无关……即 Hanselman……**但这**就是 Twitter 的目的！作为一个追随者，真为我感到羞耻！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T13:27:28.600

我不得不说分心。我已经发布了几条关于我遇到的问题的推文，但没有人“挽救这一天”。也许我的网络还不够大。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-08T13:30:24.010

我尝试使用推特，但老实说，我没有得到它的用处......所以我停止了

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-02T06:18:41.200

我更喜欢关注 Redis、MySQL、mongoDB、memcache、Sphinx 等技术推特。通常跟踪新版本、错误修复等非常重要。Twitter 是最好的方法之一。关注具体的人会提供太多“浪费时间”的链接和无用的信息。

# java - Spring + Hibernate：如何拥有一个可配置的 PK 生成器？

> ID：182721
> 
> 赞同：1
> 
> 时间：2008-10-08T13:23:36.237
> 
> 标签：java, hibernate, spring, sequences

我们将 Spring + Hibernate 用于 Web 应用程序。

此 Webapp 将部署在两个不相关的生产站点上。这两个生产站点将使用 Webapp 并行生成和使用 Person 数据。

我需要做的是确保在这两个不相关的生产站点上生成的 Persons 都有不同的 PK，以便我们可以随时合并来自这两个站点的 Person 数据。

对我施加的另一个限制是这些 PK 适合 a `Long`，所以我不能使用 UUID。

我想要做的是改变当前的休眠映射，它有序列`S_PERSON`作为生成器：

```
<hibernate-mapping default-cascade="save-update" auto-import="false">
    <class name="com.some.domain.Person" abstract="true">
        <id name="id">
            <column name="PERSON_ID"/>
            <generator class="sequence">
                <param name="sequence">S_PERSON</param>
            </generator>
        </id>
    ...
</hibernate-mapping> 
```

变成可配置的东西，以便根据部署站点的 Spring 配置文件`PERSON_ID`从不同的序列（可能`S_PERSON_1`和）生成其 PK。`S_PERSON_2`

当然，

```
 <generator class="sequence">
                <param name="sequence">${sequenceName}</param>
            </generator> 
```

不起作用，所以我必须弄清楚其他事情......我想我的生成器应该指向一个可配置的bean，而该bean又指向一个序列或另一个，但我不知道该怎么做......

有什么想法或解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T16:33:28.867

您可以在两个生产系统上使用序列，但以不同方式定义它们：

生产系统 1：CREATE SEQUENCE sequence_name START WITH 1 INCREMENT BY 2;

生产系统 2：CREATE SEQUENCE sequence_name START WITH 2 INCREMENT BY 2;

第一个序列将仅生成奇数，第二个仅生成偶数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T18:01:49.670

您基本上需要确保键的值属于不同的集合。因此，在 varchar 前面加上系统标识符。

注意：我没有对此进行测试，但您应该能够为每个数据库定义一个正常的序列

并做类似的事情

```
insert VALUES('Sys1' || to_char(sequence.nextval), val1, val2, val3);
insert VALUES('Sys2' || to_char(sequence.nextval), val1, val2, val3); 
```

# c++ - Is it possible to enumerate the wxFrame children in wxWidgets?

> ID：182739
> 
> 赞同：2
> 
> 时间：2008-10-08T13:27:19.427
> 
> 标签：c++, user-interface, wxwidgets, wxglade

I'm using the wxGlade designer to generate the GUI for a small application. It generates a class, inherited from wxFrame, which is the main application window. In order to facilitate the maintenance, I'd like to avoid writing additional code in this generated class.

But all the widgets created with the wxGlade are actually created in the auto-generated method do_layout() and it is not possible to access them outside the scope of that generated method in the generated class.

Is there a way to get pointer of certain widget outside that generated class - by name, by type, by enumerating the children or something like that?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T13:39:35.440

All classes inherited from wxWindow (wxFrame being one of them) have a function "[GetChildren](http://docs.wxwidgets.org/stable/wx_wxwindow.html#wxwindowgetchildren)", which returns a list of child windows that you can then enumerate over. If you are looking for a specific field by name then use the "[FindWindow](http://docs.wxwidgets.org/stable/wx_wxwindow.html#wxwindowfindwindow)" function.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T13:42:02.893

Actually I found the answer myself:

```
wxWindowList & children = myframe->GetChildren();
for ( wxWindowList::Node *node = children.GetFirst(); node; node = node->GetNext() )
{
     wxWindow *current = (wxWindow *)node->GetData();

     // .. do something with current
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-22T05:41:49.363

May I recommend you try [wxFormBuilder](http://www.wxformbuilder.org). I also used wxGlade before, but it presents too much constraints on how you use it. For example, with wxFormBuilder you can select 'visibility' (public,protected,private) for each control on the form. It can also generate virtual functions for event handlers, so you just derive your class from wxFormBuilder generated class and implement those functions.

# unit-testing - 工作流单元测试

> ID：182740
> 
> 赞同：8
> 
> 时间：2008-10-08T13:27:27.773
> 
> 标签：unit-testing, workflow, workflow-foundation

如何对 Windows 工作流程进行单元测试？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-12T00:20:48.253

K. Scott Allen 发布了[这个](http://odetocode.com/Blogs/scott/archive/2006/08/02/5492.aspx)，它提供了一种对自定义活动进行单元测试的方法（尽管他说他不满意）。[Ron Jacobs在这里](http://blogs.msdn.com/rjacobs/archive/2008/08/26/unit-testing-workflows.aspx)和[这里](http://blogs.msdn.com/rjacobs/archive/2008/08/27/unit-testing-activities-with-windows-workflow-foundation.aspx)提出了类似的方法。

[Maurice在这里](http://msmvps.com/blogs/theproblemsolver/archive/2008/06/02/unit-testing-custom-workflow-activities.aspx)和[这里](http://msmvps.com/blogs/theproblemsolver/archive/2008/06/11/unit-testing-asynchronous-workflow-activities.aspx)提出了另一种方法（他使用[TypeMock](http://www.typemock.com/)，正如 Will 已经[提到](https://stackoverflow.com/questions/182740/workflow-unit-testing#182888)的那样）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-24T22:09:02.623

[Microsoft.Activities.UnitTesting](http://wf.codeplex.com/wikipage?title=Microsoft.Activities.UnitTesting%20Overview).

A library of helper classes and activities designed to make unit testing of workflows easier.

Looks like there's a Channel 9 video for it on the [downloads page](http://wf.codeplex.com/), too.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T13:55:22.443

MS 放弃了使工作流程易于模拟和测试的问题。如果您想对您的自定义活动进行彻底的测试，您需要购买一个可以模拟密封类型的模拟框架，例如[TypeMock。](http://www.typemock.com/) 否则，您将不得不围绕 Workflow 的限制编写代码。

# sql - 如何在 SQL 中计算一个月的最后一天？

> ID：182742
> 
> 赞同：6
> 
> 时间：2008-10-08T13:27:49.257
> 
> 标签：sql, sql-server, tsql, date

特别是 MSSQL 2005。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-08T13:34:37.493

这是一个解决方案，可为您提供当月的最后一秒。您可以提取日期部分或对其进行修改以仅返回日期。我在 SQL Server 2005 上对此进行了测试。

```
select dateadd( s, -1, dateadd( mm, datediff( m, 0, getdate() ) + 1, 0 ) ); 
```

要了解它是如何工作的，我们必须查看[dateadd()](http://www.w3schools.com/sql/func_dateadd.asp)和[datediff()](http://www.w3schools.com/sql/func_datediff.asp)函数。

```
DATEADD(datepart, number, date)  
DATEDIFF(datepart, startdate, enddate) 
```

如果您只运行对 datediff() 的最内部调用，您将获得自时间戳 0 以来的当前月份数。

```
select datediff(m, 0, getdate() );  
1327 
```

下一部分将该月数加上 1 加到 0 时间戳中，为您提供下一个日历月的起点。

```
select dateadd( mm, datediff( m, 0, getdate() ) + 1, 0 );
2010-09-01 00:00:00.000 
```

最后，外部 dateadd() 只是从下个月的开始时间戳中减去一秒，为您提供当月的最后一秒。

```
select dateadd( s, -1, dateadd( mm, datediff( m, 0, getdate() ) + 1, 0 ) );
2010-08-31 23:59:59.000 
```

* * *

**这个旧答案（如下）有一个错误，它在一个月的最后一天不起作用，比下个月有更多的天数。我把它留在这里作为对其他人的警告。**

将一个月添加到当前日期，然后使用函数 DAY 和 DATEADD 减去应用于当前日期的 DAY 函数返回的值。

```
dateadd(day, -day(getdate()), dateadd(month, 1, getdate())) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T14:20:55.873

```
SELECT DATEADD(M, DATEDIFF(M, '1990-01-01T00:00:00.000', CURRENT_TIMESTAMP), '1990-01-31T00:00:00.000') 
```

解释：

一般方法：使用时间功能。

```
SELECT '1990-01-01T00:00:00.000', '1990-01-31T00:00:00.000' 
```

这些是 DATETIME 文字，分别是同一 31 天月份的第一天和最后一天的第一个时间颗粒。选择哪个月份是完全任意的。

```
SELECT DATEDIFF(M, '1990-01-01T00:00:00.000', CURRENT_TIMESTAMP) 
```

这是参考月份的第一天和当前时间戳之间的整月差异。让我们称之为`@calc`.

```
SELECT DATEADD(M, @calc, '1990-01-31T00:00:00.000') 
```

这会将`@calc`月份粒度添加到参考月份的最后一天，其结果是将当前时间戳“四舍五入”到其月份的最后一天。量子点

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T13:32:39.603

试试这个：

```
DATEADD (DAY, -1, DATEADD (MONTH, DATEDIFF (MONTH, 0, CURRENT_TIMESTAMP) + 1, 0) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-07T12:27:25.287

他们的关键点是您是否可以获得当月的第一天、上个月的最后一天和当月的最后一天。

下面是逐步编写查询的方法：

在 SQL Server 中，日期从 1901/01/01（日期 0）开始，直到现在每个月都可以用一个数字来标识。12 月是 1902 年的第一个月，意思是一月。1200 月是 2001 年 1 月。类似地，每一天都可以分配唯一的编号，例如日期 0 是 1901/01/01。日期 31 是 1901/02/01，因为 1901 年 1 月从 0 开始。

找出当前月份的第一天（当前日期或给定日期）

1.  首先，我们需要检查自日期 0(1901/01/01) 以来已经过去了多少个月。选择日期（MM，0，GETDATE（））
2.  添加相同的月份日期 0(1901/01/01)

    > > 选择 DATEADD(MM, DATEDIFF(MM,0,GETDATE()),0)

然后我们将获得当前月份的第一天（当前日期或给定日期）

获取上个月的最后一天

我们需要从当月的第一天减去一秒

> > 选择 DATEADD(SS,-1,DATEADD(MM, DATEDIFF(MM,0,GETDATE()),0))

获取当月的最后一天

为了首先获取当前月份的第一天，我们检查了自日期 0(1901/01/01) 以来已经过去了多少个月。如果我们再添加一个自日期 0 以来的总月数，然后添加日期为 0 的总月数，我们将得到下个月的第一天。

```
SELECT DATEADD(MM, DATEDIFF(MM,0,GETDATE())+1,0) 
```

如果我们得到下个月的第一天然后得到当月的最后一天，我们只需要减去一秒钟。

> > 选择 DATEADD(SS,-1,DATEADD(MM, DATEDIFF(MM,0,GETDATE())+1,0))

希望这会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-02T10:39:01.247

使用 SQL2005，您无法访问有用的功能[`EOMONTH()`](https://msdn.microsoft.com/en-gb/library/hh213020.aspx)，因此您必须自己计算。

> 这个简单的功能将类似于**EOMONTH**

```
CREATE FUNCTION dbo.endofmonth(@date DATETIME= NULL)
RETURNS DATETIME
BEGIN
RETURN DATEADD(DD, -1, DATEADD(MM, +1, DATEADD(DD, 1 - DATEPART(DD, ISNULL(@date,GETDATE())), ISNULL(@date,GETDATE()))))
END 
```

**要执行的查询：**

```
SELECT dbo.endofmonth(DEFAULT)  --Current month-end date
SELECT dbo.endofmonth('02/25/2012') --User-defined month-end date 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T13:28:36.820

一些可能答案的链接：

*   [http://www.extremeexperts.com/sql/Tips/DateTrick.aspx](http://www.extremeexperts.com/sql/Tips/DateTrick.aspx)

*   [http://www.devx.com/tips/Tip/14405](http://www.devx.com/tips/Tip/14405)

*   [http://blog.sqlauthority.com/2007/08/18/sql-server-find-last-day-of-any-month-current-previous-next/](http://blog.sqlauthority.com/2007/08/18/sql-server-find-last-day-of-any-month-current-previous-next/)

*   [http://www.sqlservercurry.com/2008/03/find-last-day-of-month-in-sql-server.html](http://www.sqlservercurry.com/2008/03/find-last-day-of-month-in-sql-server.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T14:05:14.377

```
DECLARE
  @Now datetime,
  @Today datetime,
  @ThisMonth datetime,
  @NextMonth datetime,
  @LastDayThisMonth datetime

SET @Now = getdate()
SET @Today = DateAdd(dd, DateDiff(dd, 0, @Now), 0)
SET @ThisMonth = DateAdd(mm, DateDiff(mm, 0, @Now), 0)
SET @NextMonth = DateAdd(mm, 1, @ThisMonth)
SET @LastDayThisMonth = DateAdd(dd, -1, @NextMonth) 
```

有时你确实需要这个月的最后一天，但很多时候你真正想要的是描述**这个月的时间间隔**。**这是描述本月时间间隔**的最佳方式：

```
WHERE @ThisMonth <= someDate and someDate < @NextMonth 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-08T16:13:58.750

为了完整起见，在 Oracle 中，您会执行类似...

```
select add_months(trunc(sysdate,'MM'),1) ... 
```

或者

```
select last_day(sysdate)+1 ... 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-21T10:14:58.047

```
DATEADD(dd, -1, DATEADD(mm, +1, DATEADD(dd, 1 - DATEPART(dd, @myDate), @myDate))) 
```

# c# - .NET IExtenderProvider (C#)

> ID：182748
> 
> 赞同：2
> 
> 时间：2008-10-08T13:29:03.340
> 
> 标签：c#, .net, iextenderprovider

我正在尝试扩展`TextBox`,`ComboBox`和`Panel`控件使用`IExtenderProvider`，但我无法让它正常工作。我开始相信我还没有完全理解这个概念。

有没有人知道网络上有什么好的资源（带有例子）如何`IExtenderProvider`使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-08T13:31:32.353

[http://www.codeproject.com/aspnet/FixingIExtenderProvider.asp](http://www.codeproject.com/aspnet/FixingIExtenderProvider.asp) [http://www.codeproject.com/aspnet/ExtenderProviderComponent.asp](http://www.codeproject.com/aspnet/ExtenderProviderComponent.asp)

# c# - 在 Java 和 C# 之间移动时，您是否会改变您的思维方式？

> ID：182749
> 
> 赞同：6
> 
> 时间：2008-10-08T13:29:32.623
> 
> 标签：c#, java

对于任何有幸在 Java 和 C# 中工作的人来说，这是一个问题。

当您从一个移动到另一个时，您是否发现必须进行某种心理上下文切换？

我目前同时在这两个领域工作，因为语法和库非常相似，但又存在细微差别，当我从一个转移到另一个时，我发现它令人沮丧。

这比我在任何其他编程语言之间移动时所经历的都要多。

有没有人有任何技巧可以让你的大脑在如此相似的语言中以不同的方式工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T13:32:34.363

是的，我必须进行心理上下文切换 - 因为 LINQ 在 Java 中不可用 :(

`foreach (X x in y)`除此之外，还有诸如vs之类的小事`for (X x : y)`经常让我绊倒，但除此之外没有*很多*。

至于让你的大脑以不同方式工作的提示：不要屈服于使用另一种语言的命名约定的诱惑。例如，我发现在 Java 中使用驼峰式方法名称对我的大脑有很好的推动作用。

编辑：泛型方面的差异很重要，有时也可能令人费解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T13:33:55.267

我发现最困难的切换是围绕泛型（C# 做得更好）、委托（Java 对匿名内部类的黑客攻击）和事件（Java 没有）

我发现确保您使用该语言的惯用语（即使用委托而不是在 C# 中创建接口）将有助于您快速思考问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-08T15:05:39.307

其他人提到的语言差异是最明显和最成问题的。我也发现图书馆的差异有时令人抓狂，真的浪费了很多时间。

“细节”也可以真正让您受益，例如了解内存模型的工作原理或运行时执行优化的方式。深入了解运行时环境的内存模型、垃圾收集技术、线程模型等，可以对您思考和开发软件的方式产生***重大影响***。

我无法在该级别智能地比较 Java 与 C# 的细节，但我可以说很多我会在 Java 中做的事情，我感到不舒服或不确定我是否可以在 C# 中做，因为我不了解它的低级细节。这会影响我为从 GUI-worker 交互到处理内存管理的所有内容编写的代码。

我发现处理 Java 和 C# 差异的最佳方法是将它们简单地视为完全不同的语言——避免“C# 和 Java 基本上是具有不同类名的相同语言”的陷阱。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-08T17:32:46.563

Java 和 C# 之间的字符串相等比较工作方式的差异是需要牢记的一件事，尤其是在从 C# 工作转移到 Java 工作时。

在 C# 中，您可以`string`使用运算符对两个实例进行值比较`==`：

```
// C# string value comparison example
string string1 = GetStringValue1();
string string2 = GetStringValue2();

// Check to see whether the string values are equal
if (string1 == string2) 
{
    // Do something...
} 
```

在 Java 中，`==`运算符对字符串进行引用（而非值）比较，因此您需要使用该`equals()`方法：

```
// Java string value comparison example
String string1 = getStringValue1();
String string2 = getStringValue2();

// Check to see whether the string values are equal
if (string1.equals(string2)) 
{
    // Do something...
} 
```

底线：在 Java 中比较字符串时，不要忘记运算符`==`不会进行值相等比较，就像在 C# 中比较字符串时那样。（同样的概念也适用于 operator `!=`。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T13:41:52.723

它们足够相似，以至于差异使我感到困惑。我在大学学习了 Java，并在获得第一份编程工作时开始使用 C#。

.Net 1.1 中的 C# 看起来更相似，但现在在 C# 3.0 中，我使用委托、泛型，尤其是像字典这样的 API 构造，比我在 Java 中所做的要多得多。在学习 F# 的过程中，我越来越多地使用 C# 的功能方面（现在用它或 OCaml 编写真的迫使我改变我的思维方式）。

# windows - 映射要由服务使用的网络驱动器

> ID：182750
> 
> 赞同：231
> 
> 时间：2008-10-08T13:29:49.080
> 
> 标签：windows, windows-services, unc, system-administration, mapped-drive

假设某些 Windows 服务使用需要映射网络驱动器且没有 UNC 路径的代码。启动服务时，如何使驱动器映射可用于服务会话？以服务用户身份登录并创建持久映射不会在实际服务的上下文中建立映射。

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2011-01-21T20:11:54.390

使用它需要您自担风险。（我在 XP 和 Server 2008 x64 R2 上测试过）

对于这个 hack，你需要[Mark Russinovich 的 SysinternalsSuite](http://technet.microsoft.com/en-us/sysinternals/bb842062.aspx)：

**第一步：** 打开提升的 cmd.exe 提示符（以管理员身份运行）

**第二步：** 使用 PSExec.exe 再次提升到根目录：导航到包含 SysinternalsSuite 的文件夹并执行以下命令 `psexec -i -s cmd.exe` ，您现在在提示符中`nt authority\system`，您可以通过键入来证明这一点`whoami`。是必需的`-i`，因为驱动器映射需要与用户交互

**第三步：** 使用以下命令将持久映射驱动器创建为 SYSTEM 帐户 `net use z: \\servername\sharedfolder /persistent:yes`

就这么容易！

**警告**：您只能以与创建它相同的方式从 SYSTEM 帐户中删除此映射。如果您需要删除它，请按照步骤 1 和 2，但将步骤 3 中的命令更改为`net use z: /delete`.

**注意**：新创建的映射驱动器现在将为该系统的所有用户显示，但他们会看到它显示为“断开连接的网络驱动器 (Z:)”。不要让这个名字欺骗你。它可能声称已断开连接，但它适用于所有人。这就是您如何判断 M$ 不支持此 hack。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2011-10-23T15:28:21.537

我找到了一个与 psexec 类似的解决方案，但**无需其他工具即可工作并且在重新启动**后仍然有效。

只需添加一个已调度的任务，在“运行方式”字段中插入“系统”，然后使用简单的命令将任务指向一个批处理文件

```
net use z: \servername\sharedfolder /persistent:yes 
```

然后选择“在系统启动时运行”（或类似的，我没有英文版），你就完成了。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2008-10-08T13:48:29.540

您要么需要修改服务，要么将其包装在辅助进程中：除了会话/驱动器访问问题之外，持久驱动器映射仅在交互式登录时恢复，而这些服务通常不会执行。

辅助进程方法可以非常简单：只需创建一个映射驱动器并启动“真实”服务的新服务。唯一不是完全无关紧要的事情是：

*   辅助服务需要将所有适当的 SCM 命令（启动/停止等）传递给实际服务。如果真正的服务接受自定义 SCM 命令，请记住也传递这些命令（不过，我不希望认为 UNC 路径具有异国情调的服务会使用此类命令......）

*   在凭证方面，事情可能会变得有些棘手。如果真实服务运行在普通用户帐户下，您也可以在该帐户下运行助手服务，只要该帐户对网络共享具有适当的访问权限，一切都应该没问题。如果真正的服务只有在以 LOCALSYSTEM 或类似的方式运行时才能工作，事情会变得更有趣，因为它要么根本无法“看到”网络驱动器，要么需要一些凭证才能让事情正常工作。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2011-10-26T15:16:17.870

更好的方法是使用 mklink.exe 使用符号链接。您可以在文件系统中创建任何应用程序都可以使用的链接。请参阅[http://en.wikipedia.org/wiki/NTFS_symbolic_link](http://en.wikipedia.org/wiki/NTFS_symbolic_link)。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2016-06-03T02:38:22.953

这里有一个很好的答案： [https ://superuser.com/a/651015/299678](https://superuser.com/a/651015/299678)

即您可以使用符号链接，例如

```
mklink /D C:\myLink \\127.0.0.1\c$ 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-08T13:38:23.370

您可以使用“net use”命令：

```
var p = System.Diagnostics.Process.Start("net.exe", "use K: \\\\Server\\path");
var isCompleted = p.WaitForExit(5000); 
```

如果这在服务中不起作用，请尝试 Winapi 和 PInvoke [WNetAddConnection2](http://msdn.microsoft.com/en-us/library/aa385413(VS.85).aspx)

**编辑：**显然我误解了你——你不能改变服务的源代码，对吧？在这种情况下，我会遵循[mdb](https://stackoverflow.com/users/8562/mdb)的建议，但稍作改动：创建您自己的服务（我们称之为映射服务）来映射驱动器并将此映射服务添加到第一个（实际工作）服务的依赖项中。这样，在映射服务启动（并映射驱动器）之前，工作服务将不会启动。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-01-22T15:14:37.630

力推，

**注意**：新创建的映射驱动器现在将为该系统的所有用户显示，但他们会看到它显示为“断开连接的网络驱动器 (Z:)”。不要让这个名字欺骗你。它可能声称已断开连接，但它适用于所有人。这就是您如何判断 M$ 不支持此 hack ...

**这完全取决于共享权限。**如果您在共享权限中拥有所有人，则其他用户将可以访问此映射驱动器。但是，如果您只有某个特定用户的凭据在您的批处理脚本中使用，并且此批处理脚本已添加到启动脚本中，则只有系统帐户才能访问该共享，甚至管理员也不能。因此，例如，如果您使用计划的 ntbackuo 作业，则必须在“运行身份”中使用系统帐户。如果您的服务的“登录为：本地系统帐户”，它应该可以工作。

**我所做**的，我没有在我的启动脚本中映射任何驱动器号，只是`net use \\\server\share ...`在我的计划作业中使用和使用了 UNC 路径。添加了一个登录脚本（或只是将一个批处理文件添加到启动文件夹），其映射到具有某些驱动器号的相同共享：`net use Z: \\\...`具有相同的凭据。现在登录的用户可以查看和访问该映射驱动器。同一个共享有 2 个连接。在这种情况下，用户不会看到烦人的“断开的网络驱动器......”。但是，如果您真的需要通过驱动器号访问该共享，而不仅仅是 UNC，请使用不同的驱动器号映射该共享，例如 Y 代表系统，Z 代表用户。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-01-20T09:13:42.037

找到了一种授予 Windows 服务访问网络驱动器的方法。

以带有 NFS Disk 的 Windows Server 2012 为例：

> 第 1 步：编写要挂载的批处理文件。

编写一个批处理文件，例如：C:\mount_nfs.bat

```
echo %time% >> c:\mount_nfs_log.txt
net use Z: \\{your ip}\{netdisk folder}\ >> C:\mount_nfs_log.txt 2>&1 
```

> 第 2 步：将磁盘挂载为 NT AUTHORITY/SYSTEM。

打开“任务计划程序”，新建一个任务：

1.  在“系统启动”中以“SYSTEM”身份运行。
2.  创建操作：运行“C:\mount_nfs.bat”。

经过这两个简单的步骤，我的 Windows ActiveMQ 服务在“本地系统”权限下运行，无需登录即可完美运行。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-09-29T11:51:53.947

当您通常从命令提示符运行可执行文件时能够访问驱动器的原因是，当您将其作为普通 exe 执行时，您是在您登录的用户帐户中运行该应用程序。该用户有权访问网络。但是，当您将可执行文件安装为服务时，默认情况下，如果您在任务管理中看到它在“系统”帐户下运行。而且您可能知道“系统”无权访问网络资源。

这个问题可以有两种解决方案。

1.  将驱动器映射为如上所述的持久性。

2.  还有另一种方法可以遵循。如果您通过键入“services.msc”打开服务管理器，您可以转到您的服务，在您的服务属性中有一个登录选项卡，您可以在其中将帐户指定为“系统”以外的任何其他帐户，您可以从您自己登录的用户帐户或通过“网络服务”启动服务。当你这样做时..服务可以访问任何网络组件和驱动器，即使它们也不是持久的。要以编程方式实现这一点，您可以查看 [http://msdn.microsoft.com/en-us/library/ms682450(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms682450(v=vs.85).aspx)上的“CreateService”函数，并将参数“lpServiceStartName”设置为“NT” AUTHORITY\NetworkService'。这将在“网络服务”下启动您的服务

3.  您也可以尝试通过在 CreateService() 函数的 servicetype 参数标志中指定 SERVICE_INTERACTIVE_PROCESS 来使服务具有交互性，但这仅限于 XP as Vista 和 7 不支持此功能。

希望解决方案对您有所帮助。如果这对您有用，请告诉我。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-01-26T20:57:47.490

您可以将脚本设置为每次使用驱动器时映射/取消映射驱动器，而不是依赖持久驱动器：

```
net use Q: \\share.domain.com\share 
forfiles /p Q:\myfolder /s /m *.txt /d -0 /c "cmd /c del @path"
net use Q: /delete 
```

这对我有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-08T13:37:56.350

您既不想从“系统”更改运行服务的用户，也不想找到一种偷偷摸摸的方式将您的映射作为系统运行。

有趣的是，这可以通过使用[“at”](http://support.microsoft.com/kb/313565)命令来实现，只需将您的驱动器映射安排到未来一分钟，它将在系统帐户下运行，使驱动器对您的服务可见。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-06T19:16:00.610

我还不能发表评论（致力于声誉），但创建了一个帐户只是为了回答@Tech Jerk @spankmaster79（好名字哈哈）和@NMC 问题，他们在回复“我找到了一个与psexec，但无需其他工具即可工作，并且可以在重新启动后继续存在。” @Larry 发布的帖子。

解决方案是从登录帐户中浏览到该文件夹​​，即：

```
 \\servername\share 
```

并让它提示登录，并在 psexec 中输入您用于 UNC 的相同凭据。之后它开始工作。就我而言，我认为这是因为具有该服务的服务器与我映射到的服务器不是同一域的成员。我在想如果 UNC 和计划任务都引用 IP 而不是主机名

```
 \\123.456.789.012\share 
```

它可以完全避免这个问题。

如果我在这里获得足够的代表点数，我会将其添加为回复。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-26T06:22:05.143

我找到了一个非常简单的方法：使用powershell的命令“New-SmbGlobalMapping”，它将全局挂载驱动器：

```
$User = "usernmae"
$PWord = ConvertTo-SecureString -String "password" -AsPlainText -Force
$creds = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $User, $PWord
New-SmbGlobalMapping -RemotePath \\192.168.88.11\shares -Credential $creds -LocalPath S: 
```

# wpf - 如何使 Silverlight 控件对鼠标操作不可见？

> ID：182771
> 
> 赞同：8
> 
> 时间：2008-10-08T13:33:20.633
> 
> 标签：wpf, uielement, silverlight-2-rc0

我怎样才能`UIElement`忽略鼠标点击并将其传递给它后面的控件？

我有一个 50% 的透明`UIElement`覆盖另一个元素。当我尝试单击背景元素时，鼠标单击被前景半透明捕获`UIElement`。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-08T17:01:32.617

放`IsHitTestVisible=false`

# sql - 从 MS SQL 将数据导入 MySQL

> ID：182784
> 
> 赞同：2
> 
> 时间：2008-10-08T13:36:58.923
> 
> 标签：sql, mysql, sql-server, database-design

我想从 MS SQL Server 导入数据，通过某种正则表达式运行它以过滤掉东西，然后将其导入 MySQL。然后，对于每个查询，我希望显示来自第三个数据库的相关图像。明智地导入和链接，最简单的方法是什么？

谢谢你。

澄清：这是一个 php 应用程序，用于过滤来自另一个数据库的数据，然后为每条记录显示来自第三个数据库的关联图像。是从零开始...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T23:19:15.613

您可以尝试 MySQL 迁移工具包。 [http://dev.mysql.com/downloads/gui-tools/5.0.html](http://dev.mysql.com/downloads/gui-tools/5.0.html)

现在存档在[http://downloads.mysql.com/archives.php?p=mysql-migration-toolkit](http://downloads.mysql.com/archives.php?p=mysql-migration-toolkit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T13:45:48.657

使用 SQL Management Studio（或 Enterprise Manager，取决于版本）和 SQL Server import wizerd 将其导入 MS SQL。

从那里您可以使用 MySQL 连接器驱动程序将其导出到 Mysql。

至于显示来自第三个数据库的图像，这完全取决于您在应用程序中编写的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T02:30:02.733

我会使用 Microsoft SQL Server 数据发布向导（免费）。您可以使用它来编写整个数据库的脚本（包括插入语句）。您可能必须稍微编辑此脚本才能使其在 MySQL 中运行。现在你只有一个正则表达式问题。你可以试试：

*   通过查询或从代码（使用正则表达式）传输操作 MS SQL 中的数据。
*   在脚本文件本身上运行你的正则表达式，也许尝试一些宏，查找和替换等。
*   通过查询或在传输后从代码（使用正则表达式）操作 MySQL 中的数据。

# file - 如何监视目录中新上传的文件？

> ID：182797
> 
> 赞同：5
> 
> 时间：2008-10-08T13:39:09.297
> 
> 标签：file, windows-services

我需要创建一个 Windows 服务来监视新上传文件的目录。这些文件的大小约为 100K 到 400K。

我的监控系统是否有可能会注意到一个新文件，但该文件尚未完全完成复制？即它仍在流式传输，EOF 尚未写入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-08T13:52:47.693

是的，这有可能发生。您应该先将文件上传到临时目录，然后在文件系统上存在整个文件时将其移动到您正在监视的目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T13:52:55.820

[尝试阅读这里](http://thedailywtf.com/Articles/A-Problem-at-the-Personal-Level--More.aspx)的第二个故事和评论。本质上，就像蜥蜴比尔所说的那样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T13:41:20.587

是的。对于小文件，风险相当低，但如果你想确定它何时看到文件以确保它的大小在一两秒内保持稳定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T14:05:40.240

你在使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)吗？我只使用过一次，但我认为您可以配置参数以告诉它您想要考虑哪些事件并为每个事件设置单独的处理程序。我怀疑在文件关闭之前 FileSystemWatcher 甚至可能不会通知您创建文件，但我还没有尝试过。

注意：这是 .NET 解决方案。如果您不使用 .NET，请忽略。

# asp.net - ASP.Net 错误：“不能使用前导 .. 退出顶级目录”

> ID：182858
> 
> 赞同：4
> 
> 时间：2008-10-08T13:51:32.593
> 
> 标签：asp.net, iis-6, directory, windows-server-2003

我每小时在我的生产站点上多次看到此错误，但不太确定如何修复它。我已经 grepped 了源代码，并且我没有在我的代码中的任何地方使用“../”来生成路径。

我的应用程序在 Win2003 服务器上的 IIS6 上运行。它使用 URLRewriter.Net 来允许网站拥有友好的 URL，我想知道这是否会导致问题。

我已经在谷歌上搜索了一个解决方案，并找到了几种可能性，但没有一个对我有用。

我已经尝试创建一个新的 App_Browser 文件来强制标签编写器设置使用特定的 HtmlTextWriter，正如最流行的解决方案之一中所建议的那样，但这对我不起作用。我还没有看到任何其他可能的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T23:10:38.923

这可能是由于使用了“~/something”，可能是在超链接控件上。当物理文件与友好 URL 位于不同的目录级别时，ASP.NET 在它生成的相对 URL 中使用了太多的 ../，从而产生此错误。如果您不能只使用绝对 URL，我相信您可以使用 Page.ResolveUrl("~/foo/bar") 来获取正确的相对 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-16T07:34:09.723

只需在您网站的 ASP 设置中将 Enable Parent Paths 设置为 True

这为我解决了问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T14:31:02.217

使用反射器深入研究 URLRewriter.Net 代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T16:01:15.047

我会给你的重写路径再一次通过，看看是否有一个路径包含一个不存在的文件夹，已经被删除或者实际上在 Web 应用程序之外。你可以在这里发布重写规则吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T20:01:14.360

你确定是你造成的错误吗？一些脚本（Code Red/Nimda）在互联网上寻找一个看起来像那个错误的 URL 遍历。

这是内部的还是外部的？您的机器是否有可能被扫描？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-05T13:01:44.507

我能够通过安装 .NET 3.5 SP1 解决此问题。

# c# - 不使用 WSE 从 Web 服务下载附件？

> ID：182859
> 
> 赞同：0
> 
> 时间：2008-10-08T13:51:35.930
> 
> 标签：c#, web-services

有什么方法可以在不使用 C# 中的 WSE 的情况下从 Web 服务下载附件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T23:27:47.030

如果您的意思是下载文件，您可以`byte[]`从您的网络方法返回

# ruby-on-rails - 独立测试rails部分视图

> ID：182865
> 
> 赞同：7
> 
> 时间：2008-10-08T13:52:30.110
> 
> 标签：ruby-on-rails, ruby, testing, tdd, views

我正在使用带有标准**rails 2.1**项目的测试/单元。我希望能够独立于任何特定的控制器/动作来测试部分视图。

似乎[ZenTest 的 Test::Rails::ViewTestCase](http://zentest.rubyforge.org/)会有所帮助，但我无法让它工作，与 view_test [http://www.continuousthinking.com/tags/view_test类似](http://www.continuousthinking.com/tags/view_test)

谷歌出现的大多数东西似乎都已经过时了，所以我猜它并不真正适用于 Rails 2.1

对此非常感谢的任何帮助。

谢谢，罗兰

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T23:39:21.610

我们在 Rails 2.1 项目中使用[RSpec](http://rspec.info)，我们可以做这样的事情：

```
describe "/posts/_form" do
  before do
    render :partial => "posts/form"
  end
  it "says hello" do
    response.should match(/hello/i)
  end
  it "renders a form" do
    response.should have_tag("form")
  end
end 
```

但是我不知道你可以用香草 Rails 测试设备做多少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T09:36:12.323

发现这可能是相关的：

[http://broadcast.oreilly.com/2008/10/testing-rails-partials.html](http://broadcast.oreilly.com/2008/10/testing-rails-partials.html)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-08T17:52:47.957

在没有控制器代码的情况下测试视图是一件危险的事情。您的测试可能会通过，但您的应用程序可能会抛出错误。始终针对现实生活中的情况进行测试，而不是人为的情况。

# java - 如何测试方法返回类型是否匹配List

> ID：182872
> 
> 赞同：16
> 
> 时间：2008-10-08T13:53:20.703
> 
> 标签：java, generics, reflection

什么是最简单的测试方法（使用反射），给定的方法（即 java.lang.Method 实例）是否具有返回类型，可以安全地转换为 List<String>？

考虑这个片段：

```
public static class StringList extends ArrayList<String> {}

public List<String> method1();
public ArrayList<String> method2();
public StringList method3(); 
```

方法 1、2、3 均满足要求。对方法 1 进行测试非常容易（通过 getGenericReturnType()，它返回 ParameterizedType 的实例），但对于方法 2 和 3，它并不那么明显。我想，通过遍历所有 getGenericSuperclass() 和 getGenericInterfaces()，我们可以非常接近，但我看不到，如何将 List<E> 中的 TypeVariable（发生在超类接口中的某处）与实际类型参数（即此 E 与字符串匹配的位置）。

或者也许有一种完全不同（更简单）的方式，我忽略了？

**编辑：**对于那些研究它的人，这里是方法 4，它也满足要求，并且显示了更多需要调查的案例：

```
public interface Parametrized<T extends StringList> {
    T method4();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-08T14:58:50.647

我尝试了这段代码，它返回了实际的泛型类型类，因此似乎可以检索到类型信息。但是，这只适用于方法 1 和 2。方法 3 似乎没有像海报所假设的那样返回一个列表类型的字符串，因此失败了。

```
public class Main {
/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    try{
        Method m = Main.class.getDeclaredMethod("method1", new Class[]{});
        instanceOf(m, List.class, String.class);
        m = Main.class.getDeclaredMethod("method2", new Class[]{});
        instanceOf(m, List.class, String.class);
        m = Main.class.getDeclaredMethod("method3", new Class[]{});
        instanceOf(m, List.class, String.class);
        m = Main.class.getDeclaredMethod("method4", new Class[]{});
        instanceOf(m, StringList.class);
    }catch(Exception e){
        System.err.println(e.toString());
    }
}

public static boolean instanceOf (
        Method m, 
        Class<?> returnedBaseClass, 
        Class<?> ... genericParameters) {
    System.out.println("Testing method: " + m.getDeclaringClass().getName()+"."+ m.getName());
    boolean instanceOf = false;
    instanceOf = returnedBaseClass.isAssignableFrom(m.getReturnType());
    System.out.println("\tReturn type test succesfull: " + instanceOf + " (expected '"+returnedBaseClass.getName()+"' found '"+m.getReturnType().getName()+"')");
    System.out.print("\tNumber of generic parameters matches: ");
    Type t = m.getGenericReturnType();
    if(t instanceof ParameterizedType){
        ParameterizedType pt = (ParameterizedType)t;
        Type[] actualGenericParameters = pt.getActualTypeArguments();
        instanceOf = instanceOf
            && actualGenericParameters.length == genericParameters.length;
        System.out.println("" + instanceOf + " (expected "+ genericParameters.length +", found " + actualGenericParameters.length+")");
        for (int i = 0; instanceOf && i < genericParameters.length; i++) {
            if (actualGenericParameters[i] instanceof Class) {
                instanceOf = instanceOf
                        && genericParameters[i].isAssignableFrom(
                            (Class) actualGenericParameters[i]);
                System.out.println("\tGeneric parameter no. " + (i+1) + " matches: " + instanceOf + " (expected '"+genericParameters[i].getName()+"' found '"+((Class) actualGenericParameters[i]).getName()+"')");
            } else {
                instanceOf = false;
                System.out.println("\tFailure generic parameter is not a class");
            }
        }
    } else {
        System.out.println("" + true + " 0 parameters");
    }
    return instanceOf;
}
public List<String> method1() {
    return null;
}
public ArrayList<String> method2() {
    return new ArrayList<String>();
}
public StringList method3() {
    return null;
}
public <T extends StringList> T method4() {
    return null;
} 
```

这输出：

```
测试方法：javaapplication2.Main.method1
        返回类型测试成功：true（预期'java.util.List'找到'java.util.List'）
        泛型参数匹配数：true（预期 1，找到 1）
        通用参数编号 1 个匹配项：真（预期 'java.lang.String' 发现 'java.lang.String'）
测试方法：javaapplication2.Main.method2
        返回类型测试成功：true（预期'java.util.List'找到'java.util.ArrayList'）
        泛型参数匹配数：true（预期 1，找到 1）
        通用参数编号 1 个匹配项：真（预期 'java.lang.String' 发现 'java.lang.String'）
测试方法：javaapplication2.Main.method3
        返回类型测试成功：false（预期 'java.util.List' 发现 'com.sun.org.apache.xerces.internal.xs.StringList'）
        泛型参数匹配数：true 0 个参数
测试方法：javaapplication2.Main.method4
        返回类型测试成功：true（预期 'com.sun.org.apache.xerces.internal.xs.StringList' 发现 'com.sun.org.apache.xerces.internal.xs.StringList'）
        泛型参数匹配数：true 0 个参数

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-01T22:41:48.880

一般来说，仅使用 Java 本身提供的工具来解决这个问题并不容易。有很多特殊情况（嵌套类、类型参数边界……）需要处理。这就是为什么我编写了一个库来使泛型类型反射更容易：[gentyref](http://code.google.com/p/gentyref/)。我添加了示例代码（以 JUnit 测试的形式）来展示如何使用它来解决这个问题：[StackoverflowQ182872Test.java](http://code.google.com/p/gentyref/source/browse/trunk/gentyref/src/test/java/com/googlecode/gentyref/StackoverflowQ182872Test.java)。基本上，您只需`GenericTypeReflector.isSuperType`使用`TypeToken`（来自[Neil Gafter](http://gafter.blogspot.com/2006/12/super-type-tokens.html)的想法）调用来查看是否`List<String>`是返回类型的超类型。

我还添加了第 5 个测试用例，以表明`GenericTypeReflector.getExactReturnType`有时需要对返回类型 ( ) 进行额外的转换，以将类型参数替换为它们的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T15:44:16.033

[java.net 论坛上的这个](http://forums.java.net/jive/thread.jspa?threadID=47527&tstart=0 "泛型和获取实际类型...")帖子可能会有所帮助（尽管我不得不承认我没有理解他们所说的一切）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T22:53:57.880

我认为你已经在正确的轨道上。继续使用[getGenericSuperclass()](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getGenericSuperclass())和 getGenericInterface() 直到您开始获取参数化类型...

所以基本上：

```
//For string list
ParameterizedType type = (ParameterizedType)StringList.class.getGenericSuperclass();
System.out.println( type.getActualTypeArguments()[0] );

//for a descendant of string list
Class clazz = (Class)StringListChild.class.getGenericSuperclass();
ParameterizedType type = (ParameterizedType)clazz.getGenericSuperclass();
System.out.println( type.getActualTypeArguments()[0] ); 
```

您可能想要构建一些递归的东西来检查这一点——甚至可能会沿着链条向上寻找 java.util.List。

# c# - 可序列化的继承

> ID：182873
> 
> 赞同：49
> 
> 时间：2008-10-08T13:53:22.450
> 
> 标签：c#, .net, vb.net

如果某些东西从 Serializable 类继承，那么子类是否仍然是 Serializable？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-10-08T14:46:07.087

这取决于你的意思是可序列化的。如果您指的是 CLI 标记（即`[Serializable]`属性），那么这*不是*继承的（下面的证明）。您必须将每个派生类显式标记为`[Serializable]`. 但是，如果您指的是`ISerializable`接口，那么是的：接口实现是继承的，但您需要小心 - 例如通过使用`virtual`方法，以便派生类可以将其数据贡献给序列化。

```
using System;

class Program
{
    static void Main()
    {
        Console.WriteLine(typeof(Foo).IsSerializable); // shows True
        Console.WriteLine(typeof(Bar).IsSerializable); // shows False
    }
}

[Serializable]
class Foo {}

class Bar : Foo {} 
```

# sharepoint - 共享点灾难恢复

> ID：182874
> 
> 赞同：1
> 
> 时间：2008-10-08T13:53:39.517
> 
> 标签：sharepoint, backup, restore

您的 Windows Sharepoint Services 3.0 灾难恢复计划是什么？

目前我们正在使用 sql 备份工具备份所有数据库（1 个内容、管理员、搜索和配置），并通过 dataprotector 备份前端服务器。

为了测试我们的备份，我们使用另一个服务器场，恢复内容数据库（按照[technet](http://technet.microsoft.com/en-us/library/cc719752.aspx)上的过程）并创建一个使用该数据库的新应用程序。我们只需在新创建的 sharepoint 应用程序上重新部署解决方案。

但是，我们必须更改数据库访问凭据（在 sql server 上）：生产中使用的用户帐户与我们的“测试”农场中使用的用户帐户不同。

最后，我们可以恢复我们的内容数据库并访问我们所有的网站。搜索不起作用，但我们正在调查。

这种还原方案是否可靠（如 Microsoft 支持的那样）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T14:58:56.967

您不能真正备份/恢复配置数据库和搜索数据库：

*   仅当您的新场具有完全相同的服务器名称时，才能恢复配置数据库
*   还原搜索数据库时，全文索引未同步。但是，这不是问题，因为您可以重新索引。

结果，我会说是的，这是可靠的内容。但请注意：

*   您可能需要重做一些配置（AAM、托管路径...）。
*   这不包括自定义，您希望保留解决方案的备份

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T14:20:04.347

可靠性在旁观者的眼中。在这种情况下，如果您对还原过程的测试成功，那么是的，它是可靠的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T15:00:07.417

我的许多客户在虚拟环境中运行 SharePoint（MOSS 和 WSS），SQL Server 也通过 SQL 工具和卷影副本进行了虚拟化和备份。

虚拟环境的优点是停机时间只要您的虚拟服务器主机引导映像。

如果您不使用虚拟化，请记住定期备份事务日志，因为这将更容易恢复到一天中的给定时间点 - 这也意味着您的事务日志不会变得太大！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T14:29:14.730

I prefer to use the stsadm -o backup command 'for catastrophic backup' as it says in the help. This can be scheduled but requires some maintenance of the backup metadata XML file when you start running out of disk space and need to archive older backups. It has the advantage of transferring over timer jobs (usually) and other configuration because as Nico says, restoring the config database won't work for most situations.

To restore, you can use the user interface which is nice and not have to mess around with much else. I think it restores your solutions as well but haven't tested that extensively.

# image - 创建/编辑PNG图像的免费工具？

> ID：182875
> 
> 赞同：66
> 
> 时间：2008-10-08T13:53:46.987
> 
> 标签：image, png

是否有任何免费工具可用于创建和编辑 PNG 图像？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-10-08T13:54:43.927

[Paint.NET](http://getpaint.net/)将热情地创建和编辑 PNG。这是一个在很多方面都很棒的节目。它是免费的，就像啤酒和演讲一样。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-10-08T13:54:40.607

[GIMP](http://gimp.org/)（GNU 图像处理程序）。它是免费的、开源的，可以在 Windows 和 Linux（也许还有 Mac？）上运行。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2011-11-29T14:27:24.237

我使用[Pixlr](http://pixlr.com/editor/) - 一个在线照片编辑器，它有很棒的过滤器和用户友好的界面。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-08T16:24:54.547

[Inkscape](http://inkscape.org/)是一个矢量绘图程序，可以导出 PNG 图像。因此，您最终会编辑 SVG 文档并将它们导出为 PNG。如果您从头开始，Inkscape 是不错的选择，但如果您只想编辑现有的 PNG，它就不是理想的选择。

注意——Inkscape 是开源的，可在多个平台上免费使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-08T15:38:36.463

[ImageMagick](http://www.imagemagick.org/)和[GD](http://www.libgd.org/)也可以处理 PNG；哎呀，你甚至可以只用[gdk-pixbuf](http://library.gnome.org/devel/gdk-pixbuf/stable/)做一些事情。您是否在寻找图形编辑器或可编写脚本/可嵌入的库？

# java - IBM Websphere OutOfMemoryException

> ID：182876
> 
> 赞同：4
> 
> 时间：2008-10-08T13:53:53.027
> 
> 标签：java, web-services, jakarta-ee, websphere

我经常在 IBM Websphere Application Server 上发现 OutOfMemoryException。我认为发生此异常是因为我的应用程序从数据库中检索了大量数据。所以，我限制所有查询不要检索超过 1000 条记录的数据，并设置 WAS 的 JVM 跟随

```
+ Verbose garbage collection
+ Maximum Heap size = 1024 (RAM on my server is 16 GB and now I already change to 8192)
+ Debug arguments = -Djava.compiler=NONE -Xdebug -Xnoagent  
                    -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=7777
+ Generic JVM arguments = -Dsun.rmi.dgc.server.gcInterval=60000 
                          -Dsun.rmi.dgc.client.gcInterval=60000 -Xdisableexplicitgc  
                          -Dws.log=E:\WebApp\log -Dws.log.level=debug
(ws.log and ws.log.level are my properties) 
```

我在配置文件文件夹中找到**了 heapdump**、**javacore**和**snap**文件，我认为它们可以告诉我问题的原因，但我不知道如何阅读/使用 heapdump、javacore 和 snap 文件。

请告诉我如何预防/避免/修复 OutOfMemoryException。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T14:45:40.113

如果您想查看堆转储文件，IBM[在此处](http://publib.boulder.ibm.com/infocenter/tivihelp/v3r1/index.jsp?topic=/com.ibm.itcamwas_b.doc_6.1/pdmst_basic56.htm)提供了分析它们的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T14:34:40.073

对此的答案取决于与 OutOfMemoryException 关联的消息。您也可以尝试 -XX:MaxPermSize=... 并将其设置为更大的值，例如 256m。

此外，如果您在某处有递归函数，则可能会导致堆栈溢出。

如果可以，请发布与异常相关的消息。Stacktrace 也可能有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T08:12:56.273

[“Thanks for the memory”](http://www.ibm.com/developerworks/linux/library/j-nativememory-linux/index.html?ca=dgr-jw22Linux-JVM&S%5FTACT=105AGX59&S%5FCMP=grjw22)是一篇关于JVM使用内存的好文章，可能有助于分析这个问题......

感谢[bwalliser](https://stackoverflow.com/users/15375/bwalliser)提供此链接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T17:13:52.140

尝试在本地重现问题，以便您可以使用 JProfiler 之类的工具对其进行调试。即使您不能在本地强制 OOM，您也可能会看到 JProfiler 中的内存增加。然后你拍摄快照并寻找没有被垃圾收集的类。这不是一门精确的科学，但它比查看 IBM 堆转储要容易得多。但是，如果必须，检查堆转储的旧方法是使用 HeapRoots。这可能取决于您使用的版本。我确实知道某些版本的 IBM JDK 在压缩方面存在问题，因此即使您有足够的内存，您也可以获得 OOM，因为没有足够大的可用片段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T15:10:17.630

我假设您使用休眠/JPA 作为持久性提供程序？您是否使用二级缓存？如果是这样，您是否考虑过从缓存中逐出大型结果集？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T23:32:49.377

如果我们不知道这是什么*类型*的 OutOfMemoryError，这个问题就很难回答；是两种截然不同的野兽`permgen`。`heapspace`

我在 JBoss 上追了好几个月的 perm-gen，尽管这种特殊类型的问题对于任何动态重新加载 Web 应用程序的应用程序服务器都是普遍的。[这里](http://my.opera.com/karmazilla/blog/2008/08/31/permgen-our-workable-solution)记录了这个传奇。

您拥有的那些堆转储......可能是您可以在[Eclipse MAT](http://www.eclipse.org/mat/)中分析它们。

# .net - 通过 XSLT 呈现 App.config/Web.config 文件

> ID：182891
> 
> 赞同：1
> 
> 时间：2008-10-08T13:55:48.217
> 
> 标签：.net, xslt, app-config

有没有人有一个 XSLT 可以获取 app.config 并将其呈现为非技术人员可口的格式？

目的主要是提供信息，但具有验证 XML 的良好副作用（如果它被设为无效，则不会呈现）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T01:59:19.223

显示解决方案的初稿

*   连接字符串
*   应用设置

在 app.config 中敲这个：

```
<?xml-stylesheet type="text/xsl" href="display-config.xslt"?> 
```

这是 display-config.xslt 的内容：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="/">
   <html>
    <body>
     <h2>Settings</h2> 
     <xsl:apply-templates /> 
    </body>
   </html>
  </xsl:template>      

  <xsl:template match="connectionStrings">
   <h3>Connection Strings</h3>
   <table border="1">
    <tr bgcolor="#abcdef">
     <th align="left">Name</th>
     <th align="left">Connection String</th>
    </tr>
    <xsl:for-each select="add">
     <tr>
      <td><xsl:value-of select="@name"/></td>
      <td><xsl:value-of select="@connectionString"/></td>
     </tr>
    </xsl:for-each>
   </table>
  </xsl:template>

  <xsl:template match="appSettings">
   <h3>Settings</h3>
   <table border="1">
    <tr bgcolor="#abcdef">
     <th align="left">Key</th>
     <th align="left">Value</th>
    </tr>
    <xsl:for-each select="add">
     <tr>
      <td><xsl:value-of select="@key"/></td>
      <td><xsl:value-of select="@value"/></td>
     </tr>
    </xsl:for-each>
   </table>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T14:30:21.313

您正在寻找哪种类型的转换？只是为了提供信息？您希望转换什么级别的细节？

# php - 实现可搜索、可浏览的图片库的最快方法 - flickr 集成？

> ID：182901
> 
> 赞同：2
> 
> 时间：2008-10-08T13:57:11.270
> 
> 标签：php, flickr, image-gallery

我有一个朋友需要一个网页。他做室内建筑，并希望有一个他的作品画廊。我可能会选择一个 php 主机，并且正在考虑为他实现图像库的最佳方式。我想出了：

*   使用 flickr 托管图像。它们可以被标记，添加到集合中，我可以使用标记和集合信息来显示画廊的“类别”，以及浏览。Flickr 也有多重上传工具，因此 20 张照片的工作不会成为上传的 PITA。
*   如何最好地获取api？是否有用于 flickr 集成的良好 PHP 库？我应该自己滚动吗？
*   API 密钥 - 这是否被视为商业项目？该网页是为他的业务而设的，他将付钱给我来创建该网站...
*   flickr 是不是适合这项工作的工具？在我看来，这似乎是一个很好的解决方案，但是我缺少什么吗？我根本没有使用过他们的 API。

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T14:00:21.233

这听起来像是一种困难的做事方式——你考虑过[画廊](http://gallery.menalto.com/)吗（这个名字没有创意！）。

除非您真的想节省带宽，否则我认为安装一些预建库会获得更好的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T16:28:28.720

这种事情的完美解决方案是[Picasa](http://www.picasa.com)（当然来自谷歌）

你得到：

*   Google Picasaweb 帐户上有 1gb 的免费存储空间，该帐户已经有一个带有可嵌入幻灯片和内容的网络界面
*   一个直接连接到网络相册的客户端（即Picasa）的竞争图像浏览和上传程序。它非常用户友好，甚至您的祖母也可以将她的照片放到网上。
*   来自谷歌的 RSS 提要和[API](http://googledataapis.blogspot.com/2007/07/picasa-web-albums-adds-new-api-features.html)。
*   [有一个自定义的轻量级 PHP api 可用](http://cameronhinkle.com/blog/id/3696159074811309536)

还需要什么吗？

* * *

克里斯给其他可能正在寻找答案的人的注意事项：API 可以在[此处](http://code.google.com/apis/picasaweb/developers_guide_protocol.html)找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T03:08:44.950

我最近为客户实现了一个基于 Flickr 的照片库。Flickr 非常适合他们，原因有很多。Gallery 是一个令人印象深刻的开源项目，但它的功能集（和管理的复杂性）对于这个客户的需求来说太过分了。

查看[Flickr API](http://www.flickr.com/services/api/)，尤其是关于[构建 URL](http://www.flickr.com/services/api/misc.urls.html)的部分，这在构建您的网页时是必需的。不要费心为 API 编写 PHP 包装器。 [phpFlickr](http://phpflickr.com/)已经做到了，这是一个聪明的实现。

这是我编写的一个辅助函数，它使需要访问 Flicker 的各个页面的工作变得更加轻松：

```
function newFlickr()
{

     static $flickr = NULL;

     if($flickr != NULL)
     {
         return $flickr;
     }

     $flickr = new phpFlickr(api-key, secret);
     $flickr->setToken(token);
     $flickr->enableCache("db", "mysql://acct:pass@localhost/flickrcache");

     return $flickr; 
```

}

这里的诀窍是，您需要输入的所有杂物都存储在代码的中心位置。缓存是关键，所以使用它。而且，如果您需要在多个地方为每个请求创建一个 phpFlickr 对象，您只需对它进行一次操作，这样可以节省初始化时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T18:42:45.710

阅读了 SchizoDuckie 的帖子后，我查看了用于 php 的 picasa api，发现它开始有点令人生畏，但是我发现这个[示例代码](http://framework.zend.com/svn/framework/standard/trunk/demos/Zend/Gdata/Photos.php)非常适合开始一些基本的集成。

[其他语言](http://code.google.com/apis/picasaweb/code.html)的示例似乎也可用 - 不能保证它们的有用性，但怀疑它们也会很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T19:00:39.567

这些可能会有所帮助。它们是 mootools 脚本，无需任何服务器端编码即可运行。两者都与 Flickr 集成。

*   [http://imago.codeboje.de/](http://imago.codeboje.de/)
*   [http://www.moopix.org/](http://www.moopix.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T15:19:14.537

如果您对 Ruby on Rails 有任何兴趣，这里有一个截屏视频[，](http://www.rubyonrails.org/screencasts)展示了如何创建一个类似于您在 RoR 中描述的站点。

# .net - 确定最高 .NET Framework 版本

> ID：182910
> 
> 赞同：13
> 
> 时间：2008-10-08T13:58:50.690
> 
> 标签：.net, c++, c, version-detection

我需要从 C\C++ 代码确定桌面计算机上安装的最高 .NET 框架版本。看起来我可以迭代下的文件夹`%systemroot%\Microsoft.NET\Framework`，但这似乎很容易出错。有没有更好的办法？也许我可以检查一个注册表项？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-08T14:02:46.517

使用[Windows 注册表](http://en.wikipedia.org/wiki/Windows_Registry)位置`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-08T14:09:56.130

.NET Framework 的注册表项如下所示：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\NET Framework Setup\NDP\ 
```

根据版本的不同，密钥的其余部分会有所不同（请查看[此页面](http://www.walkernews.net/2007/07/30/how-to-verify-dot-net-framework-version/)）。

*[您可以在 MSDN 文章Using the registry in a C++ application](http://msdn.microsoft.com/en-us/library/ms838625.aspx)*中查看如何访问注册表。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-14T02:15:32.467

如果您尝试从托管代码执行此操作，请查看这篇[文章](http://www.codeproject.com/KB/dotnet/frameworkversiondetection.aspx)，它包含了确定是否安装了特定框架版本所需的所有逻辑。

[否则，请在此处](http://blogs.msdn.com/astebner/archive/2007/11/29/6608419.aspx)查看 Aaron 的博客文章，其中提供了 C/C++ 方法来做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T14:10:43.850

以下应该会给你答案，但它似乎非常糟糕:(

```
c:\Program Files>clrver
Versions installed on the machine:
v2.0.50727 
```

# asp.net - 即使在数据绑定之后，ListBox 仍保留发布的值

> ID：182919
> 
> 赞同：0
> 
> 时间：2008-10-08T14:00:27.363
> 
> 标签：asp.net, vb.net, webforms

**请注意，下面描述的问题与“我的控件在每次页面加载时显示相同的值。我理解所表达的行为通常是不可取的”的常见问题几乎完全相反。**

我有一个列表框，即使在回发时也在页面加载事件中进行数据绑定。

当 selectedindex 更改的事件处理程序被命中时，控件以某种方式具有发布的值，即使它已经再次绑定并且此时不应具有 selectedindex。

有谁知道这怎么可能。

编辑：

为了证明 SelectedIndex 确实已重置，您可以使用以下简单标记创建一个表单：

```
 <label for="textbox1">Original Posted Value: </label>
    <asp:TextBox runat="server" ID="textbox1" />
    <asp:DropDownList runat="server" ID="dropdown" OnSelectedIndexChanged="dropdown_SelectedIndexChanged" AutoPostBack="true" />
    <label for="textbox2">Value at point handler is hit: </label>
    <asp:TextBox runat="server" ID="textbox2" /> 
```

在 .cs 中使用以下代码

```
 protected void Page_Load(object sender, EventArgs e)
    {
        textbox1.Text = dropdown.SelectedIndex.ToString();
        dropdown.DataSource = new string[] { "none", "A", "B", "C" };
        dropdown.DataBind();
    }
    protected void dropdown_SelectedIndexChanged(object sender, EventArgs e)
    {
        textbox2.Text = dropdown.SelectedIndex.ToString();
    } 
```

请注意，第二个文本框中的值始终为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T16:15:42.493

这里的问题是数据源在每个页面加载（包括回发）时都被重新分配和重新绑定。所选索引已更改，然后更改回 0。尝试使用回发，并且仅在它不是回发（初始加载）时才设置数据源，例如在 .cs 中

protected void Page_Load(object sender, EventArgs e)

```
 {
        if (Page.IsPostBack)
        {
            textbox1.Text = dropdown.SelectedIndex.ToString();
        }
        else
        {
            dropdown.DataSource = new string[] { "none", "A", "B", "C" };
            dropdown.DataBind();
        }
    }

    protected void dropdown_SelectedIndexChanged(object sender, EventArgs e)
    {
        textbox2.Text = dropdown.SelectedIndex.ToString();
    } 
```

# c# - Winforms工具栏的按钮包装。

> ID：182925
> 
> 赞同：1
> 
> 时间：2008-10-08T14:01:37.033
> 
> 标签：c#, winforms, toolbar, button

我动态地将一堆按钮添加到工具栏。如果按钮数量超过当前表单中的水平空间，我希望能够以编程方式将其包裹到第二行。我不希望用户必须单击下拉按钮才能查看更多按钮，因为我需要确保所有按钮始终可见。

有没有关于如何做到这一点的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T14:04:31.397

你只需要四行。首先，禁用对接：

```
Me.ToolStrip1.Dock = System.Windows.Forms.DockStyle.None 
```

然后关闭自动调整大小：

```
Me.ToolStrip1.AutoSize = False 
```

现在将布局设置为“流”

```
Me.ToolStrip1.LayoutStyle = System.Windows.Forms.ToolStripLayoutStyle.Flow 
```

然后将大小更改为普通 ToolStrip 高度的两倍，或者任何你想要的。

```
Me.ToolStrip1.Size = New System.Drawing.Size(300, 50) 
```

# svn - 如何为svn编写一个自动“复制、签出、更改和签入”的脚本

> ID：182928
> 
> 赞同：-1
> 
> 时间：2008-10-08T14:01:52.917
> 
> 标签：svn, workflow

我们有一个经常复制的模板项目。所以我们可以定制副本并且仍然有一个通用的模板。

为了优化“复制和初始更改”过程，我虽然可以编写一个小脚本，但它执行以下操作：

*   将项目模板（在 svn 中）复制到 svn 中的另一个目录
*   签出项目并进行一些更改（更改某些文件中的名称）
*   签入定制项目

问题是：最好的方法是什么？有这方面的经验吗？哪种类型的脚本（普通批处理或 java）？任何示例代码？

谢谢你的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-08T14:29:39.397

这是我与我在[这里](http://forums.devshed.com/unix-help-35/unix-find-and-replace-text-within-all-files-within-a-146179.html)找到的一些信息放在一起的东西。

```
#!/bin/bash

searchterm="<ProjectName>"
replaceterm="New Project"
srcsvnrepo="file:///svnrepoaddress"
destsvnrepo="file:///data/newrepo"
dumpfile="/home/<user>/repo.dump"
tmpfolder="/home/<user>/tmp_repo"

svnadmin dump $srcsvnrepo > $dumpfile
svnadmin create --fs-type fsfs $destsvnrepo
svnadmin load $destsvnrepo < $dumpfile
svn co $destsvnrepo $tmpfolder

for file in $(grep -l -R $searchterm $tmpfolder)
  do
    sed -e "s/$searchterm/$replaceterm/ig" $file > /tmp/tempfile.tmp
    mv /tmp/tempfile.tmp $file
    echo "Modified: " $file
  done

svn ci $tmpfolder --message "Initial Check-In" 
```

基本上，这会将指定源 svn repo 的备份转储到文件中，创建一个新的 repo，将备份加载到其中，检查文件，获取包含要搜索的字符串的文件列表，对每个文件执行正则表达式这些文件将新版本存储在临时位置，然后将临时文件移回原始位置，最后将更改检查回新存储库。

我尚未对此进行全面测试，因此可能需要进行一些小的调整，但基本步骤应该是正确的。请让我知道我是否犯了一些严重的错误计算，这完全行不通。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-08T14:22:09.787

只需一个 shell 脚本就可以了。

# oracle - 在 Oracle 集群中，sysdate 是否总是返回一致的答案？

> ID：182931
> 
> 赞同：1
> 
> 时间：2008-10-08T14:02:10.683
> 
> 标签：oracle, function, plsql, cluster-computing, oracleinternals

在 Oracle 集群中（多台机器合作为一个数据库提供服务）“sysdate”函数是否总是返回一致的答案？即使服务器的操作系统时钟报告的值不一致？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-14T14:21:31.850

SYSDATE 与节点操作系统相关；如果在整个集群中保证正确，那么每次调用 SYSDATE 时节点都必须同步。在集群环境中，有序序列很昂贵；如果可能，最好避免。有序序列将保证您的唯一性和顺序 - 但是，如果在从序列中选择之后和提交事务之前处理失败，您仍然可能会出现间隙。

我们使用了一些解决方法：

1.  通常，将序列设置为无序且具有大缓存大小 (25,000) 以减少集群间通信。
2.  使用 NTP 对节点进行时间同步（它们仍然可能不正确，+/- 纳秒，所以你不能依赖这个）
3.  对于审计风格的日志，我们使用 systimestamp (timestamp(6)) 作为唯一标识符 - 并且接受这样一个事实，即日志可能出现乱序（尽管极不可能）（这在正常处理中也是可能的，取决于提交发生的时间）
4.  在需要有序序列并且可能存在间隙的地方 - 使用有序序列（尽量避免在集群环境中，因为“缓存”无济于事）

5.  在需要有序序列的地方——但不能有间隙——我们有自己的序列表，锁定记录，获取数字，然后保持记录锁定直到用户提交；这将导致其他试图获得相同序列的其他人等到用户的事务完全提交 - 尽可能避免这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T12:07:14.897

使用 NTP 在所有服务器（Oracle 和其他服务器）之间同步时间，并确保不会发生这种情况。不一致的系统时钟是灾难的根源。

我*猜想*sysdate 在您描述的场景中会返回不一致的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T00:42:11.500

我强烈怀疑 SYSDATE 也与操作系统相关。非常注意您需要使用它的原因。如果有任何实现事件增量跟踪的逻辑（例如，您正在执行增量导出）并且您必须确保没有遗漏任何项目以及没有重复，则基于顺序 ID 而不是 SYSDATE 进行跟踪。

事实上，即使对于非集群系统也是如此，因为 SYSDATE 有时会发生变化（节省时间、系统管理员错误......）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T23:07:53.563

我花了（一点点）时间寻找答案，但找不到答案，但是，鉴于 sysdate 只是从操作系统返回日期/时间，我怀疑 dmitriy 是正确的。

# svn - 如何在发出“svn update”命令之前查看将从存储库更新的内容？

> ID：182945
> 
> 赞同：118
> 
> 时间：2008-10-08T14:04:27.730
> 
> 标签：svn

我已将大量文件中的更改从 Eclipse 提交到 SVN 存储库。

然后我转到 linux 框上的网站目录，我想将这些更改从存储库更新到那里的目录。

我想说“svn update project100”，它将用我添加和更改的所有文件等更新“project100”下的目录。

但是，我不一定要更新我没有做的更改。所以我想我可以说“svn status project100”，但是当我这样做时，我会得到一个完全不同的更改列表，我的列表中没有一个，这很奇怪。

因此，为了确保只有我的更改更新到 web 目录，我被迫导航到我知道有更改的每个目录，并仅显式更新这些文件，例如“svn update newfile1.php”等。这很乏味。

任何人都可以在这里阐明标准工作程序，即如何在执行“svn update”命令之前获得即将进行的所有更改的准确列表？我认为这是“状态”命令。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-10-08T14:08:35.007

尝试：

```
svn status --show-updates 
```

或（相同但更短）：

```
svn status -u 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-11-08T16:14:50.037

根据您想知道的工作副本和最新的 svn 服务器存储库之间的内容，在不更新本地工作副本的情况下，您可以执行以下操作：

如果您想知道 svn 服务器存储库中发生了什么变化，请运行命令：

```
$ svn st -u 
```

如果您想知道在本地工作副本和 svn 服务器存储库中是否修改了同一个文件，请运行命令：

```
$ svn st -u | grep -E '^M {7}\*' 
```

如果要获取特定修订版和 HEAD 之间更改的文件列表，请运行命令：

```
$ svn diff -r revisionNumber:HEAD --summarize 
```

如果您想获取在特定版本之间更改的文件列表，请运行命令：

```
$ svn diff -r revisionNumber:anotherRevisionNumber --summarize 
```

如果您想查看将要更新的内容（没有实际更新），请运行命令：

```
$ svn merge --dry-run -r BASE:HEAD . 
```

如果您想知道与您的工作副本相比，svn 服务器存储库中特定文件的哪些内容发生了更改，请运行命令：

```
$ svn diff -r BASE:HEAD ./pathToYour/file 
```

如果您想知道与您的工作副本相比，svn 服务器存储库中所有文件的哪些内容已更改，请运行命令：

```
$ svn diff -r BASE:HEAD . 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-10-08T14:07:08.100

您可以通过发出以下命令来查看将更新的内容（没有实际更新）：

```
svn merge --dry-run -r BASE:HEAD . 
```

更多细节[在这里](http://translocator.ws/2005/10/12/svn-update-dry-run)。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-02-14T20:54:06.487

这就是我一直在寻找的。首先检查了谷歌，但`svn help`最终通过了我:)

```
svn diff -r BASE:HEAD . 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-08-23T08:06:14.567

相同但更短:)：

```
svn st -u 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-08T14:08:08.317

您可以使用 'svn diff' 查看工作副本和存储库之间的差异。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-08T14:17:03.743

理论上，您可以在为自己使用而创建的分支中进行所有更改。然后，您将有理由确定您是唯一一个致力于此的人。

恕我直言，功能开发应该这样完成。

然后你可以从这个分支而不是从主干更新这个目标机器。

# c++ - 使用 STL 在 Vector 中定位

> ID：182957
> 
> 赞同：17
> 
> 时间：2008-10-08T14:06:55.200
> 
> 标签：c++, stl

我试图使用 STL 查找算法（和 min_element 算法）来定位向量中最小值的位置，但不是返回位置，它只是给了我值。例如，如果是最小值，则位置将返回为 8 等。我在这里做错了什么？

```
int value = *min_element(v2.begin(), v2.end());
cout << "min value at position " << *find(v2.begin(), v2.end(), value); 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-08T14:09:42.480

`min_element`已经为您提供了迭代器，无需调用`find`（此外，它效率低下，因为它是工作的两倍）。使用`distance`或`-`运算符：

```
cout << "min value at " << min_element(v2.begin(), v2.end()) - v2.begin(); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-08T14:23:49.737

您使用的两种算法都返回迭代器。如果你取消引用一个迭代器，你会得到这个迭代器“指向”的对象，这就是为什么你在做的时候打印*值*而不是*位置*

> ```
> cout << "min value at position " << *find(v2.begin(), v2.end(), value); 
> ```

迭代器可以看作是一个指针（嗯，不完全是，但为了简单起见，我们这样说）；因此，单独的迭代器无法为您提供容器中的位置。由于您正在迭代向量，因此您可以使用减号运算符，正如 Konrad 所说：

> ```
> cout << "min value at " << min_element(v2.begin(), v2.end()) - v2.begin(); 
> ```

但我建议使用 std::distance 算法，它更加灵活，适用于所有标准容器：

> ```
> cout << "min value at " << distance(v2.begin(), min_element(v2.begin(), v2.end())); 
> ```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-09T05:55:50.820

您认为您所问的问题的简短答案是“我如何确定`std::vector<>`给定迭代器的位置？” 是函数`std::distance`。

但是，您可能打算做的是获取迭代器的值，您可以通过取消引用它来获得它：

```
using namespace std;
vector<int>::const_iterator it = min_element(v2.begin(), v2.end());
cout << "min value at position " << distance(v2.begin(), it) << " is " << *it; 
```

# visual-studio-2005 - Static library - visual studio 2005/6.0 compatibility

> ID：182965
> 
> 赞同：0
> 
> 时间：2008-10-08T14:08:27.817
> 
> 标签：visual-studio-2005, compatibility, visual-studio-6

In the past we experienced some problems using a DLL library created with Visual Studio 2005 in our Visual Studio 6.0 application (VS2005 DLL was C++ unmanaged, of course). In your opinion can we fall in the same kind of problem if the library is static (*.lib) and not dynamic?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-08T14:14:58.647

It seems like the problem area would be the runtime libraries -- if the VS2005 DLL is using the DLL versions of the runtime libraries, then you would need both sets of runtimes installed when the application is installed. If your VS2005 DLL is statically linked to the VS2005 runtime, then it should be OK.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-02T16:29:13.633

Microsoft recommends that unmanaged DLLs must be compiled with the same CRT / STL as the main application. And the main application and the DLL should be using dynamic linking with the CRT.

If the DLL implements a pure C-interface or a COM-interface, then it should be possible use DLLs from another version of Visual Studio. But if the DLL doesn't use static linking of the CRT, then it will require that the CRT-dlls are available.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T14:15:19.813

It depends on what kind of problems of course. There are some conflicts that are more likely to occur in DLLs and some that are more likely to occur in static libs. If you are building against the same version of the Microsoft SDK it will minimize the problems.

# .net - 用 XmlDocuments、XSLT 或 Linq 解析 Xml、XPath 更有效的是什么？

> ID：182976
> 
> 赞同：28
> 
> 时间：2008-10-08T14:10:05.160
> 
> 标签：.net, xml, linq, xslt, xpath

我已经使用以下两种方法解析了 XML...

*   使用对象模型和 XPath 查询解析 XmlDocument。
*   XSL/T

但是我从来没用过...

*   .Net 3.5 新增的 Linq Xml 对象模型

谁能告诉我这三种选择之间的比较效率？

我意识到特定的用法会是一个因素，但我只是想要一个粗略的想法。例如，Linq 选项是否比其他选项慢很多？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-08T19:32:38.037

查询 XML 文档的绝对最快方法是最难的：编写一个使用 XmlReader 处理输入流的方法，并让它在读取节点时对其进行处理。这是将解析和查询组合到单个操作中的方法。（仅仅使用 XPath 不会这样做；XmlDocument 和 XPathDocument 都在它们的 Load 方法中解析文档。）如果您正在处理非常大的 XML 数据流，这通常是一个好主意。

您描述的所有三种方法的执行方式都相似。XSLT 有很多空间可以成为最慢的，因为它可以让您将 XPath 的低效率与模板匹配的低效率结合起来。XPath 和 LINQ 查询本质上都做同样的事情，即通过 XML 节点的可枚举列表进行线性搜索。我希望 LINQ 在实践中稍微快一些，因为 XPath 在运行时解释，而 LINQ 在编译时解释。

但总的来说，您编写查询的方式对执行速度的影响要比您使用的技术大得多。

无论您使用 XPath 还是 LINQ，针对 XML 文档编写快速查询的方法都是相同的：制定查询，以便在执行期间访问尽可能少的节点。使用哪种技术并不重要：检查文档中每个节点的查询将比仅检查其中一小部分节点的查询运行得慢得多。您这样做的能力比其他任何事情都更依赖于 XML 的结构：具有可导航元素层次结构的文档通常比其元素都是文档元素的子元素的文档要快得多。

**编辑：**

虽然我很确定我是对的，查询 XML 的绝对最快方法是最难的，但真正最快（也是最难）的方法不使用`XmlReader`; 它使用状态机直接处理来自流的字符。就像用正则表达式解析 XML 一样，这通常是一个糟糕的主意。但它确实为您提供了以速度交换功能的选项。通过决定不处理您的应用程序不需要的那些 XML 片段（例如名称空间解析、字符实体的扩展等），您可以构建一些比搜索更快的字符流的东西`XmlReader`。我可以想到这甚至不是一个坏主意的应用程序，尽管我想不出很多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-08T14:23:08.957

LinqToXml 查询对 IEnumerable 合约起作用......它的大部分操作都是 O(N)，因为它们需要对 IEnumerable 进行迭代。

如果您开始的是一个包含 xml 的字符串，为了在 Linq 中使用它，您需要使用[XElement.Parse](http://msdn.microsoft.com/en-us/library/bb468714.aspx)将其解析为完整的对象图，然后迭代其中的部分（过滤它，例如例子）。

我对 XPath 的理解是它会在解析时进行过滤，从性能的角度来看，这可能是非常有利的。不需要构造完整的对象图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-08T14:15:55.507

我还没有实际测试过，但 Linq 主要是编译器代码生成类型功能，因此它应该与使用 XmlDocument 和 XPath 查询相当。

Linq 的主要价值在于它提供了查询语句的编译时验证，而 XPath 和 XSLT 都无法提供。

我认为如果性能是一个问题，您的决定将基于手头的任务。例如，使用单个 XPath 查询从 XML 文档中检索单个值可能最快，但使用 XSLT 将 XML 数据转换为 HTML 页面会更快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T11:06:48.930

如果您想要真正快速的 XML 处理（读取），您应该考虑使用 XmlReader 不幸的是实现有点困难。

还有一种方法可以结合 XmlReader 来实现 LINQ 解决方案，这样您就可以轻松使用 LINQ。此外，您可以获得比 XmlDocument/XPath 更好的性能。

有关这方面的更多信息，请参阅以下链接。 [http://blogs.msdn.com/xmlteam/archive/2007/03/24/streaming-with-linq-to-xml-part-2.aspx](http://blogs.msdn.com/xmlteam/archive/2007/03/24/streaming-with-linq-to-xml-part-2.aspx)

另外我认为，如果您只使用 XmlDocument/XPath 处理小型 XML 文件，这不会是性能问题。

# asp.net - ASP.NET- 在 App_Code 类中实例化 Web 用户控件

> ID：182984
> 
> 赞同：4
> 
> 时间：2008-10-08T14:11:34.847
> 
> 标签：asp.net

文件：

网站\控件\map.ascx

网站\App_Code\map.cs

我想在 map.cs 中创建 map.ascx 的强类型实例

通常，在 aspx 中，您将添加一个 <%Register... 标记以便能够在代码隐藏中实例化。这在 app_code 类中可行吗？我正在使用 .NET 3.5/Visual Studio 2008

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-08T14:14:06.400

通常，我会做这样的事情（假设您的类型是“地图”并且您的 .ascx 文件中有适当的“继承”声明）：

```
Map map = (Map)LoadControl("~/Controls/map.ascx"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T14:42:51.617

Website\Controls 中是否有 map.ascx.cs 文件？如果是这样，请将其移至 App_Code。请注意，您可能必须将 .ascx 文件中的 CodeFile 属性更新为 ~\App_Code\map.ascx.cs。或者，由于控件是部分类，您可以在 ~\App_Code\map.cs 中创建代码：

```
public partial class controls_Map : UserControl
{
    protected void Page_Load( object sender, EventArgs e )
    {
         ...code here....
    }
} 
```

并从 controls 目录中的 map.ascx.cs 文件中删除所有方法。

# image - How to draw ARGB bitmap using GDI+?

> ID：182988
> 
> 赞同：5
> 
> 时间：2008-10-08T14:12:45.750
> 
> 标签：image, gdi+

I have valid `HBITMAP` handle of `ARGB` type. How to draw it using *GDI+*?

I've tried method:

```
graphics.DrawImage(Bitmap::FromHBITMAP(m_hBitmap, NULL), 0, 0); 
```

But it doesn't use alpha channel.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-08T15:56:31.047

我有工作样本：

*使用位图句柄获取信息：图像大小，位*

```
BITMAP bmpInfo;  
::GetObject(m_hBitmap, sizeof(BITMAP), &bmpInfo);  
int cxBitmap = bmpInfo.bmWidth;  
int cyBitmap = bmpInfo.bmHeight;  
void* bits = bmpInfo.bmBits; 
```

*使用像素格式 PixelFormat32bppARGB 的位创建和绘制新的 GDI+ 位图*

```
Gdiplus::Graphics graphics(dcMemory);  
Gdiplus::Bitmap bitmap(cxBitmap, cyBitmap, cxBitmap*4, PixelFormat32bppARGB, (BYTE*)bits);  
graphics.DrawImage(&bitmap, 0, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-05T16:39:42.790

我在让我的透明渠道正常工作时遇到了类似的问题。就我而言，我知道透明区域应该使用什么背景颜色（它是纯色的）。我使用了 Bitmap.GetHBITMAP(..) 方法并传入了用于透明区域的背景颜色。这是一个更简单的解决方案，我尝试使用 LockBits 并使用 PixelFormat32bppARGB 重新创建位图以及克隆。在我的例子中，Bitmap 忽略了 alpha 通道，因为它是从 Bitmap.FromStream 创建的。

我也有一些非常奇怪的问题，我的图像的背景区域略有改变。例如，它不是纯白色，而是像 0xfff7f7 这样的灰白色。无论我使用的是 JPG（混合色）还是 PNG 和透明色，情况都是如此。

请参阅我的问题和解决方案

[白色背景的 JPG 的 GDI+ DrawImage 不是白色的](https://stackoverflow.com/questions/4596346/gdi-drawimage-of-a-jpg-with-white-background-is-not-white)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-08T14:22:02.920

Ah... but .Net doesn't use HBITMAP and GDI+ is a C++ library atop the basic Windows GDI, so I'm assuming you're using non-.Net C++.

GDI+ has a Bitmap class, which has a FromHBITMAP() method.

Once you have the GDI+ Bitmap instance, you can use it with the GDI+ library.

Of course, if you can write your program in C# using .Net it will be a lot easier.

# c# - 虚拟目录中的 ASP.NET MVC

> ID：182993
> 
> 赞同：10
> 
> 时间：2008-10-08T14:14:17.133
> 
> 标签：c#, asp.net-mvc, model-view-controller, iis-5

我的 Global.asax.cs 中有以下内容

```
routes.MapRoute(
    "Arrival",
    "{partnerID}",
    new { controller = "Search", action = "Index", partnerID="1000" }
);

routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = "" }
); 
```

我的 SearchController 看起来像这样

```
public class SearchController : Controller
{
    // Display search results
    public ActionResult Index(int partnerID)
    {
        ViewData["partnerID"] = partnerID;
        return View();
    }
} 
```

并且 Index.aspx 目前只显示 ViewData["partnerID"]。

我在 Windows XP 上的 IIS 中设置了一个名为 Test 的虚拟目录。

如果我将浏览器指向[http://localhost/Test/](http://localhost/Test/)，那么我会按预期显示 1000。但是，如果我尝试[http://localhost/Test/1000](http://localhost/Test/1000)我会得到一个找不到页面的错误。有任何想法吗？

在虚拟目录中运行 MVC 是否有任何特殊注意事项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-26T10:26:09.937

IIS 5.1 会解释您的 url，以便它在名为 Test 的文件夹下寻找名为 1000 的文件夹。为什么呢？

> 发生这种情况是因为 IIS 6 仅当它在映射到 aspnet_isapi.dll（这是一个负责调用 ASP.NET 的 C/C++ ISAPI 过滤器）的 URL 中看到“文件扩展名”时才调用 ASP.NET。由于路由是一个名为 UrlRoutingModule 的 .NET IHttpModule，因此除非调用 ASP.NET 本身，否则不会调用它，这仅在调用 aspnet_isapi.dll 时发生，仅当 URL 中有 .aspx 时才会发生。所以，没有 .aspx，没有 UrlRoutingModule，因此是 404。

最简单的解决方案是：

> 如果您不介意在您的 URL 中使用 .aspx，只需检查您的路由配置，在每个模式的正斜杠之前添加 .aspx。例如，使用 {controller}.aspx/{action}/{id} 或 myapp.aspx/{controller}/{action}/{id}。不要将 .aspx 放在大括号参数名称中或“默认”值中，因为它实际上并不是控制器名称的一部分 - 它只是在满足 IIS 的 URL 中。

来源： http: [//blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T12:40:23.707

如果您在 Windows XP 上执行此操作，那么您使用的是 IIS 5.1。您需要让 ASP.Net 来处理您的请求。您需要为您的路由添加一个扩展名 ({controller}.mvc/{action}/{id}) 并将该扩展名映射到 ASP.Net 或将所有请求映射到 ASP.Net。[http://localhost/Test](http://localhost/Test)之所以有效，是因为它转到了在 MVC 项目中专门处理的 Default.aspx。

此外，您需要指定[http://localhost/Test/Search/Index/1000](http://localhost/Test/Search/Index/1000)。如果要指定 ID，则控制器和操作部分不是可选的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-08T14:18:12.803

在应用程序中使用虚拟目录时有许多注意事项。

一个特别之处是大多数浏览器不会将来自一个虚拟目录的 cookie 提交到另一个虚拟目录，即使这些应用程序驻留在同一台服务器上也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T18:03:49.527

尝试设置虚拟路径：右键单击mvc项目，属性，Web选项卡，输入适当的位置。******