# StackOverflow 问答 10013000-10013999

# database - 如何在java中显示数据库名称和更改数据库属性（spring框架）

> ID：10013001
> 
> 赞同：0
> 
> 时间：2012-04-04T14:17:28.463
> 
> 标签：database, spring, jakarta-ee

我需要在由 web 应用程序连接的屏幕上显示数据库名称（通过 weblogic 服务器上的数据源配置，spring 数据 xml 具有所有配置），还有什么方法可以从当前数据库切换到在 Web 应用程序（带有用户屏幕）上工作/运行时不同的数据源（数据库服务器）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:45:41.840

据我所知，没有直接的方法可以知道这些信息。我能想到的一种方法是使用 XML 解析器为所需元素解析 spring config XML 文件 - 即使这样也只会为您提供应用程序将使用的数据源的 JNDI 名称。我希望您有一种机制来确定哪个 JDBC JNDI 名称映射到哪个数据库。如果您没有该信息，则必须使用 JMX (MBeans) 连接到 Weblogic 环境以获取该信息。

# html - 桌子位置（桌子不应该倒下）

> ID：10013006
> 
> 赞同：0
> 
> 时间：2012-04-04T14:17:49.817
> 
> 标签：html, css, asp.net-mvc

这是我的代码：

```
<form id="form1" style="height: 800px; width:1000px" >
<table style="width: 90%; height: 193;">
    <tr>
        <td class="style4">
            <table style="width: 100%; height: 701px;">
                <tr>
                    <td style="height: 587px; width: 629px;" colspan="4" >
                        <div id="tableTree" style="height:600px;">
                            <table style="width: 150px;">
                                <div id="treeboxbox_tree" style="width:280px; height:100%; ">
                </div>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td >
                        <input type="button" value="Add" id="btnAdd" onclick="return someMethod()" />
                    </td>
                    <td >
            //other button
                    </td>
                    <td >
            //other button
                    </td>
                </tr>
            </table>
        </td>

        <div>
            <td>
                <table width="100%" id="smth">
                    <div style="float:left"><%Html.RenderPartial("Something"); %></div>
                </table>
            </td>
        </div>

    </tr>
</table>
</form> 
```

直到我点击一个按钮，smth 才会显示出来。但是由于 smth 的高度非常大，所以有 style4 的 td 往下走，也就是 smth 的中间位置。这是非常令人沮丧的。如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:37:20.940

我想你的意思是垂直对齐在 td 中是关闭的？

```
<td class="style4"> 
```

将其更改为

```
<td class="style4" valign="top"> 
```

或添加到 style4

```
vertical-align: top; 
```

不确定您定义的是哪个版本的 html...

# ios - 在 XCode 中使用 XMPPFramework 时如何查看 XML？

> ID：10013014
> 
> 赞同：0
> 
> 时间：2012-04-04T14:18:04.227
> 
> 标签：ios, xml, xcode, cocoa-touch, xmppframework

**问题**：这可能是一个非常基本的问题，但是当我在 XCode 中使用 XMPPFramework 时，如何查看创建的 XML。

**额外细节**：我正在研究使用 TurnSocket 发送和接收文件。我的日志说

> TURN 连接失败！

但是，当我在 stackoverflow 上查看其他类似问题的问题时，人们有各种 xml 块告诉他们更多关于这个问题的信息。例如

[XMPP 在 iphone sdk 中发送/接收文件...？](https://stackoverflow.com/questions/6328553/xmpp-sending-receving-file-in-iphone-sdk)

和

[不进行文件传输 (xep 0234, 0065)](https://stackoverflow.com/questions/8271586/dont-work-file-transfer-xep-0234-0065)

**2012 年4 月 12 日更新：**针对 Prasanna Venkatesh 的回复，这里是 didRecieveIQ 的截图。我仍然不确定如何查看 XML。

![在此处输入图像描述](../Images/59cdc35a20e210ac2908ecf050d4cf94.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:24:27.093

在您的 xmppstream 委托中，IQ 将在 xcode 中显示您的 xml 日志。

```
-(BOOL)xmppStream:(XMPPStream *)sender didReceiveIQ:(XMPPIQ *)iq 

-(void)xmppStream:(XMPPStream *)sender didSendIQ:(XMPPIQ *)iq 
```

# sql - 如何按一组数据排序？

> ID：10013015
> 
> 赞同：2
> 
> 时间：2012-04-04T14:18:06.190
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我被要求创建一个按年份分组的收入最多的特许经营列表，但是 order by 子句需要根据日期范围按收入最多的特许经营商进行排序。我可以按单笔金额（收入）罚款，但我如何按收入对特许经营分组进行排序？

```
group by
    vFranMasterNumRollup.MasterFranNumber, 
    REPLACE(vFranMasterNumRollup.FranchiseName, ',', '') ,
    YEAR(vremittheaderdetailandfran.remd_ServiceDate)
order by
    sum(vremittheaderdetailandfran.remd_LaborRevenue) desc,
    REPLACE(vFranMasterNumRollup.FranchiseName, ',', '') 
```

你在这里看到我试图在排序中添加另一列，但我想将最高的特许经营组按降序排列

如果您需要更多代码，请告诉我

这是更多代码：

```
SELECT     vFranMasterNumRollup.MasterFranNumber, REPLACE(vFranMasterNumRollup.FranchiseName, ',', '') AS FranchiseName, 
sum(vremittheaderdetailandfran.remd_LaborRevenue),YEAR(vremittheaderdetailandfran.remd_ServiceDate) 
FROM         vremittheaderdetailandfran INNER JOIN
                      vFranMasterNumRollup ON vremittheaderdetailandfran.remh_FranchiseNumber = vFranMasterNumRollup.fran_FranchiseID
WHERE     (vremittheaderdetailandfran.remd_ServiceDate BETWEEN @startdate and @enddate AND (vFranMasterNumRollup.fran_Status = N'ACTIVE') OR
                      (vremittheaderdetailandfran.remd_ServiceDate BETWEEN @startdate and @enddate))
group by vFranMasterNumRollup.MasterFranNumber, 
REPLACE(vFranMasterNumRollup.FranchiseName, ',', '') , YEAR(vremittheaderdetailandfran.remd_ServiceDate)
order by sum(vremittheaderdetailandfran.remd_LaborRevenue) desc,REPLACE(vFranMasterNumRollup.FranchiseName, ',', '') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T18:06:03.410

如果我理解正确，你可能想要这样的东西：

```
ORDER BY
   SUM(SUM(vremittheaderdetailandfran.remd_LaborRevenue))
     OVER (PARTITION BY vFranMasterNumRollup.MasterFranNumber),
   REPLACE(vFranMasterNumRollup.FranchiseName, ',', '') 
```

`SUM(…) OVER (…)`事情是一个窗口聚合函数。这个特定的窗口`SUM()`计算您的子句中指定的整个范围内的总数，并按（我理解这是一种特许经营唯一标识符）对`WHERE`它们进行分组（分区）。`vFranMasterNumRollup.MasterFranNumber`

windowed 的参数`SUM()`通常是一列或包含列引用的表达式，就像它与 "normal" 一样`SUM()`。在这种情况下，您可以将另一个`SUM()`视为参数。另一个`SUM()`是“正常”聚合函数。我们必须直接引用聚合值`vremittheaderdetailandfran.remd_LaborRevenue`而不是列，因为这是一个`GROUP BY`查询，并且相关列不包含在`GROUP BY`子句中。结果，整个表达式读作“sum of sums of `remd_LaborRevenue`”，我猜这在这种情况下非常有意义。

[您可以在OVER 子句 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms189461.aspx)手册中阅读有关窗口聚合函数的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:39:39.890

如果您使用分组依据，则需要按参与分组的任何列或聚合列之一（例如 SUM）排序

此外，您不需要在 order by 上添加完整的聚合功能，您可以简单地执行“order by”并添加列的索引。例如：

```
select columns1, column2, sum(coulm3)
from table1
group by columns1, column2
order by 3 
```

将按 SUM 排序

# c++ - 如何将 wchar_t[] 转换为 basic_string<_Elem>？

> ID：10013016
> 
> 赞同：0
> 
> 时间：2012-04-04T14:18:12.503
> 
> 标签：c++

我需要将一个项目从 VS2003 转换为 VS2008。在以下代码中：

```
wchar_t wpom[30];
mbtowc(wpom, "olaboga", 10);

ati_dom::DOMString w = wpom; 
```

我收到一个错误（在最后一行）：无法从 'wchar_t[30]' 转换为 'basic_string<_Elem>'）。

我试图将其修改为：

```
wchar_t wpom[30];
mbtowc(wpom, "olaboga", 10);

std::basic_string<wchar_t> basic_wpom(wpom);
ati_dom::DOMString w = basic_wpom; 
```

但我所完成的只是得到另一个错误：无法从 'std::basic_string<_Elem,_Traits,_Ax>' 转换为 'std::basic_string<_Elem>'

如何将 wchar_t[] 转换为 basic_string<_Elem> 而不是 basic_string<_Elem,_Traits,_Ax>...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:21:21.620

只需通过构造函数直接使用 std::wstring ，该构造函数接受指向第一个元素的指针和数组的长度：

```
wchar_t warr[ 30 ];
// populate the array
std::wstring wstrTemp( &warr[ 0 ], 30 ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T10:41:41.487

抱歉没有回复 - 我自己发现了问题所在。

事实证明，DOMString 是这样声明的：

```
typedef std :: basic_string< unsigned short > DOMString; 
```

如此简单的转换为 unsigned short 就可以了：

```
ati_dom::DOMString w = (unsigned short *)wpom; 
```

# facebook - Facebook JavaScript SDK 无需身份验证即可获取用户名

> ID：10013021
> 
> 赞同：-1
> 
> 时间：2012-04-04T14:18:35.880
> 
> 标签：facebook, facebook-graph-api, authentication

我有一个使用 JavaScript SDK 的 Facebook 画布 iframe 应用程序。如何在无需授权应用程序的情况下获取用户名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:29:23.083

不，这是不可能的。

当 Facebook 调用您的页面时，它是通过 POST 到 iframe 来完成的，如果用户尚未授权您的应用程序，您会收到一个缺少大部分数据的[签名请求，如文档中所述：](http://developers.facebook.com/docs/authentication/signed_request/)

> 某些字段和值，例如 user_id 和 oauth_token 仅在用户授权您的应用程序时才会被传递

[Graph API](http://en.wikipedia.org/wiki/Facebook_Platform#Graph_API)请求要求您提供活动访问令牌，否则您应该收到此错误：

```
{
  "error": {
    "message": "An active access token must be used to query information about the current user.", 
    "type": "OAuthException", 
    "code": 2500
  }
} 
```

（您可以在[Graph API Explorer](http://developers.facebook.com/tools/explorer/?method=GET&path=me)中进行检查；在尝试之前删除访问令牌。）

# android - 坚持从活动移植到片段

> ID：10013023
> 
> 赞同：6
> 
> 时间：2012-04-04T14:18:47.573
> 
> 标签：android, android-activity, fragment

现在正是我尝试将一个简单的基于活动的应用程序移植到片段的一周。我完全被困住了。

这个野兽是一个简单的列表、详细信息、添加/编辑应用程序，带有上下文菜单和选项菜单。我试图让它正确：片段和活动各自在他们自己的文件中，使用手机和平板电脑的 v4 支持包，片段完成可重用片段应该做的所有事情，并且回调（很多）飞来飞去通知活动和关于做什么的片段。从 SQLiteOpenHelper 转换为 ContentProvider，从 optionmenu 转换为 actionbarmenu，以及，和，和，...（我使用的几乎所有东西现在都已弃用）。

这太糟糕了。我的简单而小型的基于工作活动的应用程序现在的大小几乎是 3 倍，而且很多东西还没有工作。

如果需要，我可以在这里添加我的代码 - 但它有很多东西（你已经被警告过）。

我的问题：有人愿意与列表、详细信息**和**添加/编辑分享一个完整的示例吗？这个例子应该为片段和活动使用单独的文件（不是来自谷歌的一体化包）。

请不要投反对票。我真的很想看看如何使它正确。

提前谢谢了。

**编辑：**

这是具有两种布局的起始活动（用于手机的 res/layout 和用于平板电脑的 res/layout-large-land）和上下文菜单：

```
public class ActivityList extends FragmentActivity implements FragmentList.MyContextItemSelectedListener,
                                                      FragmentList.MyDeleteListener,
                                                      FragmentList.MyListItemClickListener,
                                                      FragmentList.MyOptionsItemSelectedListener,
                                                      FragmentDetails.MyDeleteListener,
                                                      FragmentDetails.MyOptionsItemSelectedListener {

    @Override
    public void myContextItemSelected(final int action, final long id) {
        if (action == R.id.men_add) {
            processEdit(0);
        } else if (action == R.id.men_delete) {
            processUpdateList();
        } else if (action == R.id.men_details) {
            processDetails(id);
        } else if (action == R.id.men_edit) {
            processEdit(id);
        }
    }

    @Override
    public void myDelete(final long id) {
        processUpdateList();
    }

    @Override
    public void myListItemClick(final long id) {
        processDetails(id);
    }

    @Override
    public void myOptionsItemSelected(final int action) {
        myOptionsItemSelected(action, 0);
    }

    @Override
    public void myOptionsItemSelected(final int action, final long id) {
        if (action == R.id.men_add) {
            processEdit(0);
        } else if (action == R.id.men_edit) {
            processEdit(id);
        } else if (action == R.id.men_preferences) {
            processPreferences();
        }
    }

    @Override
    protected void onActivityResult(final int requestCode, final int resultCode, final Intent intent) {
        processUpdateList();
    }

    @Override
    public void onCreate(final Bundle bundle) {
        super.onCreate(bundle);

        setContentView(R.layout.activitylist);
    }

    private void processEdit(final long id) {
        Intent intent = new Intent(this, ActivityEdit.class);
        intent.putExtra("ID", id);
        startActivityForResult(intent, MyConstants.DLG_TABLE1EDIT);
    }

    private void processDetails(final long id) {
        if (Tools.isXlargeLand(getApplicationContext())) {
            Fragment fragment = getSupportFragmentManager().findFragmentById(R.id.right);
            if (fragment == null ||
                    (fragment instanceof FragmentDetails && ((FragmentDetails) fragment).getCurrentId() != id)) {
                fragment = new FragmentDetails(id);

                FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
                transaction.replace(R.id.right, fragment);
                transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
                transaction.commit();
            }
        } else {
            Intent intent = new Intent(this, ActivityDetails.class);
            intent.putExtra("ID", id);
            startActivityForResult(intent, MyConstants.DLG_TABLE1SHOW);
        }
    }

    private void processPreferences() {
        Intent intent = new Intent(this, MyPreferenceActivity.class);
        startActivityForResult(intent, MyConstants.DLG_PREFERENCES);
    }

    private void processUpdateList() {
        // TODO:
    }
}

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment 
        class="com.test.app.FragmentList"
        android:id="@+id/fragmentlist"
        android:layout_height="match_parent"
        android:layout_width="match_parent"
        android:name="com.test.app.FragmentList" />
</LinearLayout>

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment 
        class="com.test.app.FragmentList"
        android:id="@+id/fragmentlist"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:layout_width="0dip"
        android:name="com.test.app.FragmentList" />

    <FrameLayout
        android:id="@+id/right"
        android:layout_height="match_parent"
        android:layout_weight="2"
        android:layout_width="0dip" />
</LinearLayout> 
```

这是具有行布局、选项菜单和上下文菜单的 ListFragment：

```
public class FragmentList extends ListFragment implements LoaderManager.LoaderCallbacks<Cursor> {

    private SimpleCursorAdapter           adapter;
    private AlertDialog                   alertDialog;
    private Context                       context;
    private MyContextItemSelectedListener contextItemSelectedListener;
    private MyDeleteListener              deleteListener;
    private long                          id;
    private MyListItemClickListener       listItemClickListener;
    private ListView                      listView;
    private MyOptionsItemSelectedListener optionsItemSelectedListener;

    public interface MyContextItemSelectedListener {
        public void myContextItemSelected(int action, long id);
    }

    public interface MyDeleteListener {
        public void myDelete(long id);
    }

    public interface MyListItemClickListener {
        public void myListItemClick(long id);
    }

    public interface MyOptionsItemSelectedListener {
        public void myOptionsItemSelected(int action);
    }

    @Override
    public void onActivityCreated(final Bundle bundle) {
        super.onActivityCreated(bundle);

        context = getActivity().getApplicationContext();

        listView = getListView();

        getActivity().getSupportLoaderManager().initLoader(MyConstants.LDR_TABLE1LIST, null, this);

        adapter = new SimpleCursorAdapter(context,
                                          R.layout.fragmentlist_row,
                                          null,
                                          new String[] { Table1.DESCRIPTION },
                                          new int[] { R.id.fragmentlist_row_description },
                                          CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);
        setListAdapter(adapter);
        setListShown(false);

        registerForContextMenu(listView);

        if (bundle != null && bundle.containsKey("ID")) {
            id = bundle.getLong("ID");
            listItemClickListener.myListItemClick(id);
        }

        if (Tools.isXlargeLand(context)) {
            listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
        }

        setHasOptionsMenu(true);
    }

    @Override
    public void onAttach(final Activity activity) {
        super.onAttach(activity);

        // Reduced: Check for implemented listeners
    }

    @Override
    public boolean onContextItemSelected(final MenuItem menuItem) {
        AdapterContextMenuInfo adapterContextMenuInfo = (AdapterView.AdapterContextMenuInfo) menuItem.getMenuInfo();

        final long id = adapterContextMenuInfo.id;

        if (menuItem.getItemId() == R.id.men_delete) {
            processAlertDialog(id);
            return true;
        } else {
            contextItemSelectedListener.myContextItemSelected(menuItem.getItemId(), adapterContextMenuInfo.id);
        }

        return super.onContextItemSelected(menuItem);
    }

    @Override
    public void onCreateContextMenu(final ContextMenu contextMenu, final View view, final ContextMenuInfo contextMenuInfo) {
        super.onCreateContextMenu(contextMenu, view, contextMenuInfo);

        if (view.getId() == android.R.id.list) {
            getActivity().getMenuInflater().inflate(R.menu.fragmentlist_context, contextMenu);
        }
    }

    @Override
    public Loader<Cursor> onCreateLoader(final int id, final Bundle bundle) {
        MyCursorLoader loader = null;

        switch (id) {
            case MyConstants.LDR_TABLE1LIST:
                loader = new MyCursorLoader(context,
                                            MySQLiteOpenHelper.TABLE1_FETCH,
                                            null);
                break;
        }

        return loader;
    }

    @Override
    public void onCreateOptionsMenu(final Menu menu, final MenuInflater menuInflater) {
        super.onCreateOptionsMenu(menu, menuInflater);

        menu.clear();

        menuInflater.inflate(R.menu.fragmentlist, menu);
    }

    @Override
    public void onListItemClick(final ListView listView, final View view, final int position, final long id) {
        super.onListItemClick(listView, view, position, id);

        this.id = id;

        if (Tools.isXlargeLand(context)) {
            listView.setItemChecked(position, true);
        }

        listItemClickListener.myListItemClick(id);
    }

    @Override
    public void onLoaderReset(final Loader<Cursor> loader) {
        adapter.swapCursor(null);
    }

    @Override
    public void onLoadFinished(final Loader<Cursor> loader, final Cursor cursor) {
        adapter.swapCursor(cursor);

        setListShown(true);
    }

    @Override
    public boolean onOptionsItemSelected(final MenuItem menuItem) {
        optionsItemSelectedListener.myOptionsItemSelected(menuItem.getItemId());

        return super.onOptionsItemSelected(menuItem);
    }

    @Override
    public void onSaveInstanceState(final Bundle bundle) {
        super.onSaveInstanceState(bundle);

        bundle.putLong("ID", id);
    }

    private void processAlertDialog(final long id) {
        final AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(getActivity());
        alertDialogBuilder.setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {

            @Override
            public void onClick(final DialogInterface dialogInterface, final int which) {
                dialogInterface.dismiss();
            }
        } );
        alertDialogBuilder.setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {

            @Override
            public void onClick(final DialogInterface dialogInterface, final int which) {
                MyApplication.getSqliteOpenHelper().deleteTable1(id);

                alertDialog.dismiss();

                deleteListener.myDelete(id);
            }
        } );
        alertDialogBuilder.setCancelable(false);
        alertDialogBuilder.setMessage(R.string.txt_reallydelete);

        alertDialog = alertDialogBuilder.create();
        alertDialog.show();
    }
}

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:orientation="horizontal"
    android:paddingBottom="2dip"
    android:paddingTop="2dip" >

    <TextView
        style="@style/TextViewLarge"
        android:id="@+id/fragmentlist_row_description"
        android:textStyle="bold" />
</LinearLayout>

<menu
    xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:icon="@drawable/ic_menu_add"
        android:id="@+id/men_add"
        android:showAsAction="ifRoom|withText"
        android:title="@string/txt_add" />

    <item
        android:icon="@drawable/ic_menu_preferences"
        android:id="@+id/men_preferences"
        android:showAsAction="ifRoom|withText"
        android:title="@string/txt_preferences" />
</menu>

<menu
    xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:id="@+id/men_details"
        android:title="@string/txt_details" />

    <item
        android:id="@+id/men_edit"
        android:title="@string/txt_edit" />

    <item
        android:id="@+id/men_delete"
        android:title="@string/txt_delete" />
</menu> 
```

这是详细信息活动：

```
public class ActivityDetails extends FragmentActivity implements FragmentDetails.MyDeleteListener, 
                                                                    FragmentDetails.MyOptionsItemSelectedListener {

    private long id;

    @Override
    public void myDelete(final long id) {
        setResult(RESULT_OK);
        finish();
    }

    @Override
    public void myOptionsItemSelected(final int action, final long id) {
        if (action == R.id.men_add) {
            processEdit(0);
        } else if (action == R.id.men_edit) {
            processEdit(id);
        } else if (action == R.id.men_preferences) {
            processPreferences();
        }
    }

    @Override
    protected void onActivityResult(final int requestCode, final int resultCode, final Intent intent) {
        if (requestCode == MyConstants.DLG_PREFERENCES || requestCode == MyConstants.DLG_TABLE1EDIT) {
            finish();

            startActivity(getIntent()); 
        }
    }

    @Override
    protected void onCreate(final Bundle bundle) {
        super.onCreate(bundle);

        if (bundle != null) {
            if (bundle.containsKey("ID")) {
                id = bundle.getLong("ID");
            }
        } else {
            Bundle bundleExtras = getIntent().getExtras();
            if (bundleExtras != null) {
                id = bundleExtras.getLong("ID");
            }

            processDetails(id);
        }
    }

    @Override
    public void onSaveInstanceState(final Bundle bundle) {
        super.onSaveInstanceState(bundle);

        bundle.putLong("ID", id);
    }

    private void processDetails(final long id) {
        FragmentDetails fragment = new FragmentDetails(id);

        FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
        transaction.replace(android.R.id.content, fragment);
        transaction.commit();
    }

    private void processEdit(final long id) {
        Intent intent = new Intent(this, ActivityEdit.class);
        intent.putExtra("ID", id);
        startActivityForResult(intent, MyConstants.DLG_TABLE1EDIT);
    }

    private void processPreferences() {
        Intent intent = new Intent(this, MyPreferenceActivity.class);
        startActivityForResult(intent, MyConstants.DLG_PREFERENCES);
    }
} 
```

这是带有布局和菜单的 DetailsFragment：

```
public class FragmentDetails extends Fragment {

    private AlertDialog                   alertDialog;
    private MyDeleteListener              deleteListener;
    private long                          id;
    private MyOptionsItemSelectedListener optionsItemSelectedListener;
    private TextView                      textViewDescription;
    private TextView                      textViewId;

    public FragmentDetails() {
        id = 0;
    }

    public FragmentDetails(final long id) {
        this.id = id;
    }

    public long getCurrentId() {
        return id;
    }

    public interface MyDeleteListener {
        public void myDelete(long id);
    }

    public interface MyOptionsItemSelectedListener {
        public void myOptionsItemSelected(int action, long id);
    }

    @Override
    public void onActivityCreated(final Bundle bundle) {
        super.onActivityCreated(bundle);

        if (bundle != null && bundle.containsKey("ID")) {
            id = bundle.getLong("ID");
        }

        setHasOptionsMenu(true);
    }

    @Override
    public void onAttach(final Activity activity) {
        super.onAttach(activity);

        // Reduced
    }

    @Override
    public void onCreateOptionsMenu(final Menu menu, final MenuInflater menuInflater) {
        super.onCreateOptionsMenu(menu, menuInflater);

        menu.clear();

        menuInflater.inflate(R.menu.fragmentdetails, menu);
    }

    @Override
    public View onCreateView(final LayoutInflater inflater, final ViewGroup viewGroup, final Bundle bundle) {
        View view = inflater.inflate(R.layout.fragmentdetails, null);

        textViewDescription = (TextView) view.findViewById(R.id.tv_description);
        textViewId = (TextView) view.findViewById(R.id.tv_id);

        if (id != 0) {
            Table1 table1;
            if ((table1 = MyApplication.getSqliteOpenHelper().getTable1(id)) != null) {
                textViewDescription.setText(Tools.defaultString(table1.getDescription()));
                textViewId.setText(Tools.defaultString(String.valueOf(table1.getId())));
            }
        }

        return view;
    }

    @Override
    public boolean onOptionsItemSelected(final MenuItem menuItem) {
        if (menuItem.getItemId() == R.id.men_delete) {
            processAlertDialog(id);
            return true;
        } else {
            optionsItemSelectedListener.myOptionsItemSelected(menuItem.getItemId(), id);
        }

        return super.onOptionsItemSelected(menuItem);
    }

    @Override
    public void onSaveInstanceState(final Bundle bundle) {
        super.onSaveInstanceState(bundle);

        bundle.putLong("ID", id);
    }

    private void processAlertDialog(final long id) {
        final AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(getActivity());
        alertDialogBuilder.setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {

            @Override
            public void onClick(final DialogInterface dialogInterface, final int which) {
                alertDialog.dismiss();
                alertDialog = null;
            }
        } );
        alertDialogBuilder.setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {

            @Override
            public void onClick(final DialogInterface dialogInterface, final int which) {
                MyApplication.getSqliteOpenHelper().deleteTable1(id);

                alertDialog.dismiss();
                alertDialog = null;

                deleteListener.myDelete(id);
            }
        } );
        alertDialogBuilder.setCancelable(false);
        alertDialogBuilder.setMessage(R.string.txt_reallydelete);

        alertDialog = alertDialogBuilder.create();
        alertDialog.show();
    }
}

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="wrap_content"
    android:layout_width="match_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:orientation="horizontal" >

        <TextView
            style="@style/TextViewStandard"
            android:layout_weight="1" 
            android:text="@string/txt_id" />

        <TextView
            style="@style/TextViewStandard"
            android:id="@+id/tv_id"
            android:layout_weight="1" />
    </LinearLayout>

    <LinearLayout
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:orientation="horizontal" >

        <TextView
            style="@style/TextViewStandard"
            android:layout_weight="1" 
            android:text="@string/txt_description" />

        <TextView
            style="@style/TextViewStandard"
            android:id="@+id/tv_description"
            android:layout_weight="1" />
    </LinearLayout>
</LinearLayout>

<menu
    xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:icon="@drawable/ic_menu_add"
        android:id="@+id/men_add"
        android:showAsAction="ifRoom|withText"
        android:title="@string/txt_add" />

    <item
        android:icon="@drawable/ic_menu_edit"
        android:id="@+id/men_edit"
        android:showAsAction="ifRoom|withText"
        android:title="@string/txt_edit" />

    <item
        android:icon="@drawable/ic_menu_delete"
        android:id="@+id/men_delete"
        android:showAsAction="ifRoom|withText"
        android:title="@string/txt_delete" />

    <item
        android:icon="@drawable/ic_menu_preferences"
        android:id="@+id/men_preferences"
        android:showAsAction="ifRoom|withText"
        android:title="@string/txt_preferences" />
</menu> 
```

我不发布 EditActivity，因为它只是一个没有 Fragment 的 FragmentActivity。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:30:38.667

这可能不是全部答案，而是部分答案：您仍然有一个主要活动，在您曾经拥有 listview 的 xml 中，您现在添加了一个框架布局。然后在您的活动 oncreate 中添加以下内容：

```
 mMainFragment = new ListFragment();
        FragmentManager fragmentManager = getSupportFragmentManager();
        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();

        fragmentTransaction.replace(R.id.center_container, mMainFragment);

        fragmentTransaction.commit();
        mCurrentFragment = mMainFragment; 
```

在你的列表片段中

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    // setup view
    View view = inflater.inflate(R.layout.calendar_list, null);

    mListAdapter = new CustomAdapter(getActivity(), R.layout.calendar_row, (ArrayList<Item>) mFullList);
    setListAdapter(mListAdapter);

    return view;
} 
```

列表片段的 XML：

```
<somelayout>
    <ListView android:id="@id/android:list"
        android:layout_width="match_parent"
        android:layout_height="match_parent"/>
</somelayout> 
```

点击列表在片段中触发：

```
@Override
public void onListItemClick(ListView list, View view, int position, long id) {
    final Item item = (Item) list.getAdapter().getItem(position);
    mListener.OnListClick(item);
} 
```

哪个使用这个监听器：

公共接口 OnListItemClickListener { public void OnListClick(Item item); }

Listfragment 需要在顶部有这个：

```
@Override
public void onAttach(Activity activity) {
    super.onAttach(activity);
    try {
        mListener = (OnListItemClickListener) activity;
    } catch (ClassCastException e) {
        throw new ClassCastException(activity.toString() + " must implement OnListItemClickListener");
    }
} 
```

然后，主要活动通过实现接口来订阅它，并在触发侦听器时启动详细信息片段。

编辑：好的，所以您的问题更为根本:) 请记住每次旋转时都会在您的活动中调用 oncreate，因此您的活动需要记住要显示的片段，就像它需要记住要显示的视图一样。您还需要将片段添加到后退堆栈中，否则后退键将无法与它们一起使用。将片段视为具有功能的视图，它们不是活动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T13:52:52.237

我将尝试回答其中一个问题。你写：

“现在我旋转并单击后退按钮。我希望从编辑返回到列表页面或详细信息页面。在我的情况下，应用程序结束。”

从您的代码示例看来，您没有将事务添加到后台堆栈。在调用 commit() 之前调用 addToBackStack()，如下所示：

```
transaction.replace(R.id.fragment_container, newFragment);
transaction.addToBackStack(null);
transaction.commit(); 
```

# android - 是否可以覆盖引导完整构造函数？

> ID：10013027
> 
> 赞同：1
> 
> 时间：2012-04-04T14:19:02.223
> 
> 标签：android, constructor, broadcastreceiver, bootcompleted

```
public class bootCompleteReceiver extends BroadcastReceiver{
private External external;

public bootCompleteReceiver(External _external){
    external = _external;
}

@Override
public void onReceive(Context context, Intent intent) {
    external.doStuff();
}
} 
```

使用此代码启动完成不会注册，但如果您删除构造函数，它将正常工作。（注意：不用说，接收者已在清单中正确注册）。

谁能证实我担心静态接收器不能有构造函数或解释做这个代码试图做什么的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:40:52.690

由于构造函数有一个参数，因此在启动时没有任何东西可以调用该代码。无法填充该参数，因此系统永远无法调用它。就系统而言，您的“外部”类是未知实体。

添加无参数构造函数或删除当前构造函数，以便系统可以访问它。

# ruby-on-rails - Ruby on Rails 中的 HTTPClient::ReceiveTimeoutError

> ID：10013037
> 
> 赞同：6
> 
> 时间：2012-04-04T14:19:16.957
> 
> 标签：ruby-on-rails, timeout, httpclient

嗨，我正在使用 HTTPClient gem，但我遇到了问题；我用它来注册用户。运行时用户名和密码被插入到我的数据库中，但它等待很长时间并返回给我

```
HTTP Client::ReceiveTimeout Error in User Controller#signup execution expired. 
```

我该如何解决我的问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-11T12:48:30.677

用于receive_timeout 错误；

```
client = HTTPClient.new
client.receive_timeout = 10000    # setting receivetimeout for HTTPClient! 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T15:45:31.133

我猜你的 http 连接或远程连接不稳定。每当我遇到这种情况时，我都会使用超时并重试几次。以下代码将执行您的代码 10 秒，如果未完成，它将超时并重试。如果多次重试失败，最终会失败。

```
def timeout_and_retry
  retries = 0
  begin
    Timeout::timeout(10) { yield }
  rescue Timeout::Error
    raise if (self.retries += 1) > 3
    retry
  end
end

timeout_and_retry do
   # http client get code goes here
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-15T09:21:04.467

当您收到 HTTP:ReceiveTimeOutError 时，这意味着请求已发送并且它已经等待特定时间并且由于没有响应，在 time 内它过期并且您收到此错误。

始终指定更多时间，以便等待响应的时间更长。

# templates - 如何以编程方式导入或创建页面模板

> ID：10013038
> 
> 赞同：1
> 
> 时间：2012-04-04T14:19:17.153
> 
> 标签：templates, liferay

我想以编程方式创建可扩展的页面模板（不是布局模板），例如博客或内容显示页面模板。

我怎样才能得到这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T19:34:34.960

Create `LayoutPrototype` and set a `Layout` with defined portlets, thats all.

See Liferay source for creating a Blogs-, CMS-Template: `com.liferay.portal.events.AddDefaultLayoutPrototypesAction`

# c# - C# 属性 - 需要子属性

> ID：10013041
> 
> 赞同：3
> 
> 时间：2012-04-04T14:19:28.650
> 
> 标签：c#, xml, json, class, properties

我的任务是将 xml 和 json 数据解析到应用程序中。我正在尝试创建一个包含我将收集的所有数据的属性类。

这是我的问题/问题

我创建了一个包含天气数据、温度、风、紫外线指数等变量的类。我也创建了这些日子。我可以单独访问这些日子，但不能作为一个整体访问。例如。

```
Monday m = new Monday();
m.TempHiF = "65"; 
```

我想做的就是这个。

```
WDay d = new WDay();
d.Monday.TempHiF = "65"
d.Tuesday.TempHiF = "67"; 
```

等等。我对 C# 很陌生，我什至不知道要谷歌什么。我已经绞尽脑汁一个星期了，但取得的成功有限。我也愿意接受有关存储数据的其他建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T14:22:30.943

您所要做的就是让 WDay 拥有所有日子的属性：

```
public class WDay
{
    public Day Monday {get;set;}
    ... 
```

然后让`Day`类有一个`TempHiF`属性，依此类推：

```
public class Day
{
    public string TempHif {get;set;}
    ...
} 
```

确保 WDay 的构造函数使用新实例初始化其所有 Day 属性以避免空引用异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:28:58.980

你只需要嵌套你的类，这样你的工作日类就有一个星期一类、一个星期二类等。然后给你的每个日类一个 TempHi 属性或你想要的任何其他属性，然后引用那些

```
class WDay{

  public Monday mon = new Monday();
  public Tuesday tue = new Tuesday();
  public Wednesday wed = new Wednesday();

}

class Monday
{
  private string _TempHi;
  public TempHi
  {
    get {
     return _TempHi;
    }
    set {
     _TempHi = value;
    }
  }
}

class main
{
  WDay WeekDay = new WDay();

  WeekDay.mon.TempHi = "65F";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:23:23.583

```
class Week {
  public Day Sunday{get;set;}
  public Day Monday{get;set;}
  // etc...
}

class Day {
// Define day-bound properties here
} 
```

# c# - 从证书颁发机构请求证书

> ID：10013043
> 
> 赞同：7
> 
> 时间：2012-04-04T14:19:36.220
> 
> 标签：c#, certificate, certificate-authority

网络钓鱼问题。

我有一个 tcp 服务器应用程序，它使用 tls/ssl 证书并存储在 pkcs#12 文件中。假设 CA 安装在网络上的某个位置并且可以访问，那么通常的做法是从 CA（一次）以编程方式（C#）请求 ssl 证书并将其写入 pkcs#12 文件以供服务器使用。

这是正常的做法，还是更有可能的情况是从诸如 Thawte 或 Versign 等 CA 购买证书，专门针对该客户，并事先创建 pkcs#12 文件，并作为安装过程的一部分进行安装。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T01:53:53.523

我认为这是一个论点可以向任何方向发展的情况。

如果您需要管理大量站点，则程序化证书请求和签名有其优点，如果出现严重错误（例如，如果有人劫持或监听您的初始请求），则会失去人工验证。在某些时候，需要以编程方式或作为人工操作员做出信任决定。

[Bruce Schneier 的这篇论文更详细地讨论了支持](http://www.schneier.com/paper-pki-ft.txt)[PKI 密码学](http://en.wikipedia.org/wiki/Public_key_infrastructure)信任决策的 CA 架构的潜在风险。我相信这涵盖了许多与您的问题和设计相关的案例，您可能没有并且应该考虑。

# .net - GACUtil 与手动编辑 C:\Windows\assembly

> ID：10013047
> 
> 赞同：2
> 
> 时间：2012-04-04T14:19:53.487
> 
> 标签：.net, gac, gacutil

我们在项目中使用 GAC，在开发过程中，我们经常需要在注册新的 DLL 之前取消注册以前版本的 DLL。虽然我们可以使用 GACutil.exe 来执行此操作，但我们也可以将我们的 DLL 拖放到 C:\Windows\assembly 以注册它们，然后右键单击 + 卸载以取消注册它们（或者有时我们在命令提示符下使用“del”和 DLL 的名称）。

我的问题：是否有任何迹象表明我们的行事方式不符合要求？它是否等同于“GACUtil -i”和“GACUtil -u”，还是会导致问题？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:37:33.500

此功能由自定义外壳扩展 shfusion.dll 提供。它使 GAC 扁平化并使其看起来像一个文件夹。并在您操作资源管理器窗口时自动为您取消/注册程序集。所以你这样做很好。

请注意，这将不再适用于 .NET 4，它在不同的文件夹 (c:\windows\microsoft.net\assembly) 中使用 GAC，并且该文件夹没有相同类型的 shell 扩展，您会看到原始GAC 文件夹的内容。不要惹那个。

一般来说，你不应该*像*那样在你的开发机器上使用 GAC。一方面，使用它的目的是允许程序集的多个版本共存，因此不断地取消/注册是没有意义的。另一方面，在开发过程中不断更改 [AssemblyVersion] 没有多大意义。强烈支持 IDE 支持的 Copy Local 功能。将它放在 GAC 中对您的用户计算机很有用。我认为，这也是微软不再支持 shell 扩展的原因。它被使用得太频繁了:)

# asp.net - 同步提交未在 IE 外部触发

> ID：10013049
> 
> 赞同：1
> 
> 时间：2012-04-04T14:19:55.673
> 
> 标签：asp.net, postback

我有一个非常简单的表单，我正在尝试将其同步回发到服务器。在 IE 中，一切正常。点击提交，它进入服务器，一切都是金色的。当我点击提交按钮时，任何其他浏览器（嗯，我尝试过 Chrome、FF 和 Opera）都会坐在那里。把它放在更新面板中，一切正常。我想我可以使用 UpdatePanel 并异步执行它——它当然不会受到伤害——但我至少想知道出了什么问题。

编辑：我不确定从 HTML 中可以获得什么——它是非常简单的表单 + 提交按钮，但这里是：

```
<div id="leftColumn">

    <formContent />

</div>

<div id="rightColumn">

    <conditionalFormContent />
</div>

<div class="clear">

    <input type="submit" name="ctl00$MainContent$SubmitButton" value="Send Report" onclick="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$MainContent$SubmitButton&quot;, &quot;&quot;, true, &quot;&quot;, &quot;&quot;, false, false))" id="MainContent_SubmitButton" />

</div> 
```

啊，也许你的意思是 ASP 代码？

```
<asp:Button runat="server" 
                ID="SubmitButton"
                Text="Send Report" 
                OnClick="SubmitReport"
                UseSubmitBehavior="true" 
                CausesValidation="true" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:42:35.463

尝试`UseSubmitBehavior`在按钮上设置为 false。

# php - Kohana 日志 - 写入错误

> ID：10013051
> 
> 赞同：0
> 
> 时间：2012-04-04T14:19:57.310
> 
> 标签：php, kohana

我正在使用 kohana 3 上的网站构建，实际上我开始使用 kohana。我想对错误使用简单的日志记录。我在不同事物的应用程序路径中的日志目录中出现错误，我尝试添加我自己的一个并出现错误。

我喜欢这样：

```
Kohana::$log->add('error', 'Could not locate user');
Kohana::$log->write(); 
```

在最后一行之后，我遇到了这个错误：

```
ErrorException [ Notice ]: Undefined index: error

SYSPATH\classes\kohana\log\file.php [ 91 ]

86 
87      foreach ($messages as $message)
88      {
89          // Write each message into the log file
90          // Format: time --- level: body
91          file_put_contents($filename, PHP_EOL.$message['time'].' --- '.$this->_log_levels[$message['level']].': '.$message['body'], FILE_APPEND);
92      }
93  }
94 
95 } // End Kohana_Log_File
SYSPATH\classes\kohana\log\file.php [ 91 ] » Kohana_Core::error_handler(arguments)

SYSPATH\classes\kohana\log.php [ 184 ] » Kohana_Log_File->write(arguments)

APPPATH\classes\controller\main.php [ 23 ] » Kohana_Log->write()

{PHP internal call} » Controller_Main->action_index()

SYSPATH\classes\kohana\request\client\internal.php [ 118 ] » ReflectionMethod->invoke(arguments)

SYSPATH\classes\kohana\request\client.php [ 64 ] » Kohana_Request_Client_Internal->execute_request(arguments)

SYSPATH\classes\kohana\request.php [ 1138 ] » Kohana_Request_Client->execute(arguments)

DOCROOT\index.php [ 109 ] » Kohana_Request->execute() 
```

这有什么问题？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T14:22:25.610

只需将日志常量用于消息类型，例如

`Kohana::$log->add(Log::ERROR, 'Could not locate user');`

因为这些反映了 PHP 中的错误类型。

PS 不需要调用 Log::write()，它会在关机时自动完成。

# android - android wifi加载驱动失败

> ID：10013056
> 
> 赞同：0
> 
> 时间：2012-04-04T14:20:11.290
> 
> 标签：android, android-wifi

> **可能重复：**
> [在 Android 模拟器上启用 Wifi](https://stackoverflow.com/questions/7876302/enabling-wifi-on-android-emulator)

I have come across an issue in the android emulator 2.2, as the enable wifi is selected, the ddms displays a error saying wifi serivece : failed to lead driver. 如何解决这个问题？谢谢你。

# c# - 使用 SWI-Prolog C# 从 C# 中的 Prolog 查询中获取结果

> ID：10013062
> 
> 赞同：1
> 
> 时间：2012-04-04T14:20:26.550
> 
> 标签：c#, prolog, swi-prolog

我正在使用 C# 使用 SWI-Prolog 为 prolog 文件编写 GUI，但是我不知道如何从查询中获取解决方案到某些字符串中。

pl 中的查询 direct_evening_flight(london,edinburgh) 返回一周中的某些日子，例如星期一、星期二、星期四。

如果我在 C# 中执行查询

```
PlQuery q = new PlQuery("direct_evening_flight(london,edinburgh).") 
```

它会自动将结果打印到控制台中。但是，我想将结果一一接收到字符串变量中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:23:43.507

您必须将`direct_evening_flight/2`谓词转换为`direct_evening_flight/3`最后一个变量将保存查询结果的谓词。这样查询不会输出到标准输出，而是输出到这个变量。

# jquery - jquery访问输入标签

> ID：10013064
> 
> 赞同：0
> 
> 时间：2012-04-04T14:20:28.827
> 
> 标签：jquery

我有一些这样的 HTML：

```
<input type="radio" class="MyRadio" name="TheName">
<label for="TheLabel">the text</label> 
```

如何更改标签的文本？

试过了

```
$('#TheLabel').text('My New Text'); 
```

它不起作用。有什么办法呢？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:23:51.913

你有一些事情在这里扭转。“for”不标识标签，它标识您正在标记的控件。您需要正确使用“for”，并且需要给它一个 ID：

```
<label for="TheName" id="TheLabel">The Label Text</label> 
```

然后：

```
$('#TheLabel').text('My New Text'); 
```

将工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:25:09.647

使用 id 来引用标签，这将允许更简单的 jquery 操作

然后，您可以使用 jquery [.html()](http://api.jquery.com/html/)随心所欲地更改标签的内部，或者如果您继续只需要文本操作，则[.text()](http://api.jquery.com/text/)函数将产生相同的结果。

这是一个 jsfiddle，显示了您想要的结果的示例：[here](http://jsfiddle.net/sxbM4/1/)

的HTML：

```
<input type="radio" class="MyRadio" name="TheName">
<label id="mylabel" for="TheLabel">the text</label>​ 
```

jQuery：

```
$('#mylabel').text('My New Text');​ 
```

或者

```
$('#mylabel').html('My New Text');​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:23:06.013

**更新：查看@Mark 的答案......你的代码是错误的。** “for”属性应该指向输入。 **我已经清理了解决此问题的答案。**

匹配属性同样的东西，而不是文本框的#id（标签没有id）。

```
<input type="radio" class="MyRadio" name="TheName" id="TheName">
<label for="TheName">the text</label>​​​​​​​​​​​

$('label[for="TheName"]').text('This is my new text');​ 
```

[查看它在您的 HTML 上运行的 jsFiddle。](http://jsfiddle.net/VB2hH/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T14:23:46.763

您使用了错误的选择器（在这种情况下，将`TheLabel`其视为 ID），您可以使用以下内容：

```
$('label[for=TheLabel]').text('My New Text');​​​ 
```

您还可以更改`for`for`id`以使您已经拥有的代码起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T14:49:22.103

'for' 属性是指输入，而不是标签。为了正确识别标签，最好的做法是给它一个 ID。这是一个养成的好习惯，因为它有助于快速查找：

HTML：

```
<input type="radio" class="MyRadio" name="TheName">
<label for="TheName" id="TheLabel">the text</label> 
```

jQuery 选择器：

```
$( '#TheLabel' ) 
```

但是，如果您想通过 for 属性获取元素，使用原始 HTML，您可以这样做：

```
$( 'label[for=TheLabel]' ) 
```

# iphone - 将 UIImage 保存到文档 - 需要两个文件？

> ID：10013065
> 
> 赞同：0
> 
> 时间：2012-04-04T14:20:37.263
> 
> 标签：iphone, uiimage, save, nsdocumentdirectory

一个简单的问题，我问自己和以后可能偶然发现的任何人一样多：将 UIImage 保存到文档目录时，我必须保存两个版本，一个 @2x 和一个用于非视网膜显示器? 如果是这样，假设系统将应用与捆绑图像相同的命令并知道为每个设备使用正确的文件是否正确？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:21:07.677

我认为类中的[`imageNamed:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/occ/clm/UIImage/imageNamed%3a)类方法`UIImage`为你做了这个“把戏”。

但是由于您不会使用该方法，而是[`imageFromContentsOfFile:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/occ/clm/UIImage/imageWithContentsOfFile%3a) 直接打开文件而不是通过辅助方法打开文件，因此您应该自己使用@2x 技巧（扩展`UIImage`类并创建类似的东西就可以了）

# javascript - 使用 super() 调用的 Javascript 继承

> ID：10013066
> 
> 赞同：0
> 
> 时间：2012-04-04T14:20:41.443
> 
> 标签：javascript, inheritance

我有一些伪类共享它们的大部分初始化。我决定取消这个初始化并创建一个基类，它们将从中继承。

```
function BaseClass(param1, param2) {
    ...
}

function SubClassA(param1) {
    ...
}

function SubClassB(param1) {
    ...
} 
```

我想`SubClass1`并以下列方式`SubClass2`继承：`BaseClass`

`SubClassA(param1)`构造函数调用`BaseClass(param1, "I am A.")`

`SubClassB(param1)`构造函数调用`BaseClass(param1, "I am B.")`

因此`BaseClass`为它们添加了一些属性。然后两个子类自己做一些初始化。

现在我不能只做`SubClassA.prototype = new BaseClass()`，因为我希望超级构造函数接受参数。如何优雅地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-13T18:02:05.037

为此，我制作了一个名为[Class.js](https://github.com/eppz/eppz-js/blob/master/Classes/eppz!kit/Class.js) - [https://github.com/eppz/eppz-js - soley 的](https://github.com/eppz/eppz-js)**Objective-JavaScript 助手**（无需应用任何额外的样板代码，也减少了原型的麻烦）。

使用它，您可以轻松地进行此设置：

```
var BaseClass = Class.extend
({
    param1: null,
    param2: null,

    construct: function(param1, param2)
    {
        this.param1 = param1;
        this.param2 = param2;
    },
});

var SubClassA = BaseClass.extend
({
    construct: function(param1)
    {
        this.super.construct(param1, 'This is A.');
    },
});

var SubClassB = BaseClass.extend
({
    construct: function(param1)
    {
        this.super.construct(param1, 'This is B.');
    },
});

var a = new SubClassA('A stuff.');
var b = new SubClassB('B stuff.');

console.log(a.param1); // A stuff.
console.log(b.param1); // B stuff.

console.log(a.param2); // This is A.
console.log(b.param2); // This is B. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:25:35.720

```
function SubClassA(param1) {
    BaseClass.call(this, param1, "I Am A.");
}

function SubClassB(param1) {
    BaseClass.call(this, param1, "I Am B.");
} 
```

当您执行`new SubClassA(param1)`或`new SubClassB(param1)`基本构造函数时，将使用适当的参数调用。

`SubClassA.prototype = new BaseClass()`此外，除了定义基类之外，还有其他方法。您可以查看[此](https://stackoverflow.com/questions/7944880/js-confusion-about-inheritance)问题以获取一些详细信息。（免责声明：这个问题是我提出的。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:26:23.913

我有类似的东西，我这样做：

```
function SubClass (param1) {
    BaseClass.call(this, param1, "I am A.");
} 
```

这为我提供了`BaseClass`的实例对象上的所有属性`SubClass`。

编辑：这是关于[call 函数](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)的一些信息。它很有用，因为您可以指定`this`调用期间的内容并提供参数列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-06T13:05:47.293

在 Rectangle 的原型中添加 area 方法。创建一个 Square 类，满足以下条件：

1.  它是 Rectangle 的子类。
2.  它包含一个构造函数，没有其他方法。
3.  它可以使用 Rectangle 类的 area 方法来打印 Square 的面积

    ```
    class Rectangle {

      constructor(w, h) {
       this.w = w;
        this.h = h;
      }
    } 
    Rectangle.prototype.area = function()
    {
      var a = this.w * this.h;
      return a;
     }
     class Square extends Rectangle{
         constructor(r) {
            super(r, r)
           }
      }

      const rec = new Rectangle(3, 4);
      const sqr = new Square(3);

      console.log(rec.area());
      console.log(sqr.area()); 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-15T10:46:22.170

这是一个带有 super 关键字的继承示例

```
 class Animal {
  constructor(animalName, country) {
    this.animalName = animalName;
    this.country = country;
  }

  update(animalName=null, country=null) {
    if (animalName) {
      this.animalName = animalName;
    }
    if (country) {
      this.country = country;
    }
  }

  show() {
    console.log("A");
    console.log("Animal Name: ", this.animalName);
    console.log("Animal Country: ", this.country);
  }
}

animal = new Animal("Elephant", "India");
animal.show();
animal.update();
animal.show();
animal.update("Dog");
animal.show();
animal.update(null, "Africa");
animal.show();
animal.update("Whale", "Antartica");
animal.show();

class Whale extends Animal {
  constructor(name, animalName, country) {
    super(animalName, country);
    this.name = name;
  }

  updateName(name=null) {
    if (name) {
      this.name = name;
    }
  }

  show() {
    console.log("W");
    super.show();
    console.log("Penguin Name: ", this.name);
  }
}

whale = new Whale("Ele", "Whale", "Goa");
whale.show();
whale.updateName();
whale.show();
whale.updateName("Molly");
whale.show();
whale.updateName(null);
whale.show();
animal.update("Ants");
whale.show();
animal.update(null, "Australia");
whale.show();
animal.update("Mites", "New Zealand");
whale.show();

class Penguin extends Animal {
  constructor(name, animalName, country) {
    super(animalName, country);
    this.name = name;
  }

  updateName(name=null) {
    if (name) {
      this.name = name;
    }
  }

  show() {
    console.log("P");
    super.show();
    console.log("Penguin Name: ", this.name);
  }
}

penguin = new Penguin("Molly", "Penguin", "Goa");
penguin.show();
penguin.updateName();
penguin.show();
penguin.updateName("Pikachu");
penguin.show();
penguin.updateName(null);
penguin.show();
animal.update("Cat");
penguin.show();
animal.update(null, "Russia");
penguin.show();
animal.update("Seal", "Artic");
penguin.show(); 
```

您可以在此处尝试此代码：[https ://repl.it/@VinitKhandelwal/inheritance-javascript](https://repl.it/@VinitKhandelwal/inheritance-javascript)

# java - 尝试在地球仪上计算目的地纬度和经度的问题

> ID：10013067
> 
> 赞同：0
> 
> 时间：2012-04-04T14:20:42.037
> 
> 标签：java, android

`dest()`我正在尝试使用以下函数计算地球上的目的地距离。但是，我的函数会打印`(61.488580, 23.784896 )`距离初始点仅 0.018 公里的目标点`(61.488414, 23.784976)`。正确答案应该是`(61.49806, 23.765)`。

有人可以帮我弄清楚我做错了什么吗？

[我如何计算地球上的目的地点的来源](http://www.catalina-capri-25s.org/tech/latlongcalc.asp)

```
lat2 = asin( sin(lat1)*cos(d/R) + cos(lat1)*sin(d/R)*cos(br) ) 
lon2 = lon1 + atan2( sin(θ)*sin(d/R)*cos(lat1), cos(d/R)−sin(lat1)*sin(lat2) ) 
```

以下是我的出发点：

```
lat1= 61.488414 (degree) 
lon1= 23.784976 (degree)  
br= 315 (degree)  
d= 1.5 (km)  
R= 6371 (km)  
lat2= ? (degree)  
lon2= ? (degree) 
```

这是我对以下功能的实现：

```
void dest(){
    double lat1, lon1, lat2, lon2, x, y, R, d, br;
    double lat1rad, lat2rad, lon1rad, dbyRrad, brrad;

    lat1=61.488414;
    lon1=23.784976;
    br=315;
    d=1.5;
    R=6371;

    lat1rad=Math.toRadians(lat1);
    lat2rad=Math.toRadians(lat2); 
    lon1rad=Math.toRadians(lon1); 
    dbyRrad=Math.toRadians(d/R); 
    brrad=Math.toRadians(br);

    lat2 = Math.asin(Math.sin(lat1rad)*Math.cos(dbyRrad)          
      +Math.cos(lat1rad)*Math.sin(dbyRrad)*Math.cos(brrad));
    lat2=Math.toDegrees(lat2);

    y=Math.sin(brrad)*Math.sin(dbyRrad)*Math.cos(lat1rad);
    x=Math.cos(dbyRrad)-Math.sin(lat1rad)*Math.sin(lat2rad);
    lon2 = Math.atan2(y,x);
    lon2 = Math.toDegrees(lon2);
    lon2 = lon1 + lon2;

    System.out.println("lat2 = "+ lat2);   // correct lat2= 61.49806, lon2=23.765
    System.out.println("lon2 = "+ lon2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:36:16.717

```
lat2rad=Math.toRadians(lat2); 
```

但此时您尚未初始化 lat2，因此它使用 0 值。然后，您进行一些涉及 lat2 的计算：

```
lat2 = Math.asin(Math.sin(lat1rad)*Math.cos(dbyRrad)          
  +Math.cos(lat1rad)*Math.sin(dbyRrad)*Math.cos(brrad));
lat2=Math.toDegrees(lat2); 
```

但您永远不会将此值映射回 lat2rad。然后你使用 lat2rad（仍然是 0）来计算 x：

```
x=Math.cos(dbyRrad)-Math.sin(lat1rad)*Math.sin(lat2rad); 
```

也许第二个代码块应该是：

```
lat2rad = Math.asin(Math.sin(lat1rad)*Math.cos(dbyRrad)          
  +Math.cos(lat1rad)*Math.sin(dbyRrad)*Math.cos(brrad));
lat2=Math.toDegrees(lat2rad); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:32:26.993

我认为 d/R 已经是弧度了，你不需要再次转换它。

# sql-server - T-Sql 声明和设置

> ID：10013068
> 
> 赞同：8
> 
> 时间：2012-04-04T14:20:47.670
> 
> 标签：sql-server, tsql

这是我的声明

为什么会出现这些错误 关键字“select”附近的语法不正确，关键字“FROM”附近的语法不正确。？？？

```
BEGIN
Declare @idToutesPlantesDérivés  int 
DECLARE @idPlantesDérivés  int 

SET @idPlantesDérivés = select(ID_CHIMQ FROM dbo.SOUS_CATGR where Name = 'plantes et ses dérivés')

SET @idToutesPlantesDérivés = select(ID_CHIMQ  FROM dbo.SOUS_CATGR where Name = 'toutes les autres plantes et dérivés')

   select @idToutesPlantesDérivés
END 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-04T14:22:18.467

单程

```
BEGIN
Declare @idToutesPlantesDérivés  int 
DECLARE @idPlantesDérivés  int 

SET @idPlantesDérivés = ( SELECT ID_CHIMQ 
FROM dbo.SOUS_CATGR
where Name = 'plantes et ses dérivés')

SET @idToutesPlantesDérivés = ( SELECT ID_CHIMQ 
  FROM dbo.SOUS_CATGR
where Name = 'toutes les autres plantes et dérivés')

   select @idToutesPlantesDérivés
END 
```

或者

```
BEGIN
Declare @idToutesPlantesDérivés  int 
DECLARE @idPlantesDérivés  int 

SELECT @idPlantesDérivés = ID_CHIMQ  
FROM dbo.SOUS_CATGR
where Name = 'plantes et ses dérivés'

SELECT @idToutesPlantesDérivés = ID_CHIMQ 
FROM dbo.SOUS_CATGR
where Name = 'toutes les autres plantes et dérivés'

   select @idToutesPlantesDérivés
END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T14:22:31.680

使用 SELECT 为变量设置值的另一种语法如下所示：

```
SELECT @variable = column_name FROM some_table WHERE ... 
```

所以对于你的情况：

```
BEGIN
Declare @idToutesPlantesDérivés  int 
DECLARE @idPlantesDérivés  int 

select @idPlantesDérivés = ID_CHIMQ FROM dbo.SOUS_CATGR where Name = 'plantes et ses dérivés'

select @idToutesPlantesDérivés = ID_CHIMQ  FROM dbo.SOUS_CATGR where Name = 'toutes les autres plantes et dérivés'

   select @idToutesPlantesDérivés
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:22:59.497

你需要

```
(select ID_SOUS_CATGR_AGENT_CHIMQ FROM dbo.MAD_SOUS_CATGR_AGENT_CHIMQ where NM_SOUS_CATGR_AGENT_CHIMQ = 'plantes et ses dérivés') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T14:24:08.157

移动括号：

```
BEGIN
Declare @idToutesPlantesDérivés  int 
DECLARE @idPlantesDérivés  int 

SET @idPlantesDérivés = (select (ID_CHIMQ 
                        FROM dbo.SOUS_CATGR
                        where Name = 'plantes et ses dérivés')

SET @idToutesPlantesDérivés = (select (ID_CHIMQ 
                            FROM dbo.SOUS_CATGR
                            where Name = 'toutes les autres plantes et dérivés')

   select @idToutesPlantesDérivés
END 
```

# python - Django 基于类的视图 - 意外的装饰器行为

> ID：10013080
> 
> 赞同：1
> 
> 时间：2012-04-04T14:21:27.843
> 
> 标签：python, django, django-views, decorator, django-class-based-views

**[编辑]所以看来我的代码工作正常，另一段代码+疲倦是问题[/编辑]。**

我有一个装饰器，它可以简单地检查几个所需的请求键。

```
def fields_required(*fields):
assert isinstance(fields, tuple), "Fields must be of type tuple."

def wrap_func(fn):

    def wrapper(cls, request, *args, **kwargs):
        print 'oh hi'
        missing_fields = []
        for field in fields:
            if not request.REQUEST.has_key(field):
                missing_fields.append(field)

        if len(missing_fields) > 0:
            #maybe do smth here
            return HttpResponseBadRequest()          

        return fn(cls, request, *args, **kwargs)
    return wrapper
return wrap_func 
```

如果其中一个字段丢失，我预计 HTTP 403 错误请求状态代码，但是装饰器从不执行该代码。

我的视图文件的基本表示：

```
class ViewA(View):

    @fields_required('name','api_key')
    def get(self, request, *args, **kwargs):
        # some logic

class ViewB(View):

    @fields_required('SHOULD_NEVER_SEE','THIS_STUFF')
    def get(self, request, *args, **kwargs):
        # some logic 
```

在浏览器中打开 ViewA 时，控制台输出如下：

```
('name', 'api_key')
('SHOULD_NEVER_SEE','THIS_STUFF') 
```

我不明白为什么要执行 ViewB 的装饰器，以及为什么我的控制台中没有“哦，嗨”。有什么见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:40:37.830

ViewB 的装饰器已“执行”，但不是因为您正在查看 ViewA。这是因为 Python 在执行文件本身时装饰了该方法。例如，`b`即使`func`未调用以下内容也会打印：

```
def deco(f):
    print 'b'
    def g():
        print 'c'
    return g

@deco
def func():
    print 'a' 
```

关于不打印'oh hi'的问题；您可以尝试将装饰器添加到`dispatch`而不是`get`（即，将以下内容添加到您的视图中）：

```
@method_decorator(fields_required('SHOULD_NEVER_SEE','THIS_STUFF'))
def dispatch(self, *args, **kwargs):
    pass 
```

# ruby-on-rails - 在 Rails 的 ERB 中实现 if/not 的最简洁方法是什么？

> ID：10013084
> 
> 赞同：2
> 
> 时间：2012-04-04T14:21:34.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3, views, erb

从索引视图考虑以下代码：

```
<td>
  <%= 'foo' if bar == BAZ %>
  <%= 'qux' if bar != BAZ %>
</td> 
```

这是最干净的方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T14:27:00.270

[对于三元条件](http://en.wikipedia.org/wiki/Ternary_operation#Ruby)，这似乎是一个很好的案例：

```
<%= bar == BAZ ? 'foo' : 'qux' %> 
```

除此之外，一个普通的旧 if/else：

```
<%= if bar == BAZ then 'foo'
    else 'qux'
    end
%> 
```

# jquery - 对于网站动画效果，哪个执行性能更好：CSS3还是jQuery？

> ID：10013087
> 
> 赞同：4
> 
> 时间：2012-04-04T14:21:48.590
> 
> 标签：jquery, browser, css, jquery-animate

哪个执行性能更好：CSS3 动画还是 jQuery 动画？

它们如何影响用户浏览器的性能或执行速度？

我不关心浏览器的兼容性，只关心执行性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T18:08:38.357

@tstenner 分享了一个很好的链接，它可能会消除你的疑虑，但如果你想做一些测试，你可以使用[http://jsperf.com/进行一些性能测试](http://jsperf.com/)

你应该查看 Github 上的“Animate.css”。仅使用 CSS3 的出色而酷炫的动画[http://daneden.me/animate/](http://daneden.me/animate/)

[]的伊戈尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T19:36:54.003

以我的经验，权衡是兼容性。如果你绝对需要你的网页有动画，请使用 jQuery 以与旧浏览器兼容。然而，CSS3 为浏览器提供了可以在 GPU 中预先计算和渲染的预期动画。这意味着**CSS3 在所有情况下都比 jQuery 具有明显的性能优势**。当然，CSS3 动画在浏览器和机器之间会有不同的性能，但 JavaScript 的性能往往会随之变化，这意味着如果 CSS3 慢，JS 会更慢。

# multithreading - Qt 事件监听器是否占用文件句柄？

> ID：10013094
> 
> 赞同：3
> 
> 时间：2012-04-04T14:22:18.997
> 
> 标签：multithreading, qt, unix, signals

在运行 Qt 应用程序的服务器上，当其他备份作业在夜间开始运行时，我收到以下错误：

```
QEventDispatcherUNIXPrivate(): Unable to create thread pipe: Too many open files
QEventDispatcherUNIXPrivate(): Can not continue without a thread pipe 
```

连接函数是否可能需要“unix 文件句柄”？例如，如果我执行以下操作，是否会从操作系统获取额外的文件句柄资源，直到我断开连接？

```
connect(this, SIGNAL(sendConfig(QString, QString)), deviceCon, SLOT(setDeviceConfig(QString, QString)));
emit sendConfig(configEntry, configValue);
disconnect(this, SIGNAL(sendConfig(QString, QString)), deviceCon, SLOT(setDeviceConfig(QString, QString))); 
```

谢谢。尖刺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:33:05.810

[我能在这个主题上找到的最好的就是来自QT 4.2](http://cep.xor.aps.anl.gov/software/qt4-x11-4.2.2-browser/db/d00/class_q_event_dispatcher_u_n_i_x_private.html)的这个参考。

你的问题的答案是肯定的。该类打开一个管道，创建文件句柄，然后用于`select`处理事件。

**PS**刚刚在4.8中确认了类似的方法

# asp.net-mvc-3 - 在 BeginForm 样式的一次性 html 助手中捕获包装的内容

> ID：10013095
> 
> 赞同：9
> 
> 时间：2012-04-04T14:22:21.710
> 
> 标签：asp.net-mvc-3, html-helper

我正在尝试编写一个 BeginForm 样式的 html 助手，它使用 IDisposable 来包装其他代码。我希望助手仅在满足特定条件时才呈现包装代码（例如，用户处于特定角色）。

我认为我可以简单地在 Begin 方法中切换 context.Writer 并在 Dispose 方法中将其切换回。下面的代码编译并运行，但在所有情况下都会呈现包装的内容。如果我单步执行，则包装的内容不会写入新的 StringWriter，因此不在我的控制范围内。

```
 public static IDisposable BeginSecure(this HtmlHelper html, ...)
    {
        return new SecureSection(html.ViewContext, ...);
    }

    private class SecureSection : IDisposable
    {
        private readonly ViewContext _context;
        private readonly TextWriter _writer;

        public SecureSection(ViewContext context, ...)
        {
            _context = context;
            _writer = context.Writer;
            context.Writer = new StringWriter();
        }

        public void Dispose()
        {
            if (condition here)
            {
                _writer.Write(_context.Writer);
            }

            _context.Writer = _writer;
        }
    } 
```

我正在尝试使用 html 助手做的事情吗？

我知道 razor 中的声明性 html 助手可能会起作用，但如果可能的话，我会更喜欢标准的 html 助手方法，因为 MVC3 中 razor 助手的 app_code 限制。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T18:46:28.977

实际上**，您可以**使用类似 BeginForm 的结构有条件地隐藏内容。它只涉及稍微弄乱内部 StringBuilder ：

```
public class Restricted: IDisposable
{
    public bool Allow { get; set; }

    private StringBuilder _stringBuilderBackup;
    private StringBuilder _stringBuilder;
    private readonly HtmlHelper _htmlHelper;

    /// <summary>
    /// Initializes a new instance of the <see cref="Restricted"/> class.
    /// </summary>
    public Restricted(HtmlHelper htmlHelper, bool allow)
    {
        Allow = allow;
        _htmlHelper = htmlHelper;
        if(!allow) BackupCurrentContent();
    }

    private void BackupCurrentContent()
    {
        // make backup of current buffered content
        _stringBuilder = ((StringWriter)_htmlHelper.ViewContext.Writer).GetStringBuilder();
        _stringBuilderBackup = new StringBuilder().Append(_stringBuilder);
    }

    private void DenyContent()
    {
        // restore buffered content backup (destroying any buffered content since Restricted object initialization)
        _stringBuilder.Length = 0;
        _stringBuilder.Append(_stringBuilderBackup);
    }

    /// <summary>
    /// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
    /// </summary>
    public void Dispose()
    {
        if(!Allow)
            DenyContent();
    }
} 
```

然后你只需要制作一个 HtmlHelper 来制作上述对象的实例

```
public static class RestrictedHelper
{
    public static Restricted RestrictedContent(this HtmlHelper htmlHelper, bool allow)
    {
        return new Restricted(htmlHelper, allow);
    }
} 
```

用法如下：

```
@using (var restricted = Html.Restricted(true))
{
    <p>This will show up</p>
}
@using (var restricted = Html.Restricted(false))
{
    <p>This won't</p>
} 
```

好处：

*   编写自定义逻辑以显示/隐藏您的内容并将其传递给 Restricted 构造函数。
*   Restricted 对象中的公共属性可以在视图中的代码块中访问，因此您可以在那里重用计算值。

用 ASP.Net MVC 4 测试

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-14T11:39:47.410

您不能有条件地呈现辅助方法返回的主体内容`IDisposable`。它会一直渲染。当你想`using`用一些自定义标记包装块的主体时，你可以使用这种风格的助手，比如`BeginForm`助手对`<form>`元素所做的。

您可以使用 a[`templated Razor delegate`](http://haacked.com/archive/2011/02/27/templated-razor-delegates.aspx)代替：

```
public static class HtmlExtensions
{
    public static HelperResult Secure(this HtmlHelper html, Func<object, HelperResult> template)
    {
        return new HelperResult(writer =>
        {
            if (condition here)
            {
                template(null).WriteTo(writer);
            }
        });
    }
} 
```

进而：

```
@Html.Secure(
    @<div>
         You will see this text only if some condition is met
    </div>
) 
```

# .htaccess - 使用 htaccess 重定向所有 url

> ID：10013097
> 
> 赞同：0
> 
> 时间：2012-04-04T14:22:27.670
> 
> 标签：.htaccess, redirect

我被这个问题困扰了一段时间。但是我想将我所有没有#的页面重定向到带有#的URL，请参见下面的示例。此示例适用于一页，但我想一次性为我的所有页面获取此示例。

```
RewriteEngine on 
Redirect permanent /index.php/artikel/contact http://www.mydomain.com/#index.php/artikel/contact 
```

有没有办法插入一个变量或类似的东西，所以我不必一个一个地插入我的网址？

再次感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:38:40.410

你想使用 mod_rewrite。[http://httpd.apache.org/docs/current/mod/mod_rewrite.html](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

然后，您可以使用 paringin 而不是使用 Redirect 指定每个 url（甚至可能不需要重写引擎）

```
RewriteCond
RewriteRule 
```

使用正则表达式指定条件。

# visual-studio - 在 VS Extension 中调用文本转换

> ID：10013098
> 
> 赞同：0
> 
> 时间：2012-04-04T14:22:30.460
> 
> 标签：visual-studio, templates, t4, template-engine, t4-toolbox

我想创建一个 Visual Studio 项目模板，通过在将其添加到解决方案时执行 T4 模板在解决方案中生成项目（例如自定义 .aspx 页面）。为此，我正在使用此链接： http: [//msdn.microsoft.com/en-us/library/gg586947.aspx](http://msdn.microsoft.com/en-us/library/gg586947.aspx) 谁能告诉我如何获取服务提供商，这在上面链接的代码中提到。为了解决这个问题，我写道：

> EnvDTE.DTE dte = (EnvDTE.DTE)Package.GetGlobalService(typeof(EnvDTE.DTE)); // 获取一个服务提供者——你怎么做取决于上下文：
> 
> > IServiceProvider serviceProvider = new Microsoft.VisualStudio.Shell.ServiceProvider(dte as Microsoft.VisualStudio.OLE.Interop.IServiceProvider);

但它给了我一个争论空异常错误，因为变量 dte 仍然为空。为什么它是空的？我不知道我这样做是对还是错。请建议我如何实现上面链接中代码中给出的 serviceprovider 以便我可以继续前进。如果可能，请给我一个代码示例。

请建议，

谢谢，马尤尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T18:52:22.470

您应该能够在 Visual Studio 2010 中使用 GetGlobalService 直接查询 STextTemplating。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T13:17:25.947

可能是因为我在这个项目中使用了不同的程序集版本。我正在开发的应用程序在 VS2010 中，我尝试使用版本为 10.0.0 且运行时版本为 4.0 的程序集。但是在版本 10.0.0.0 和运行时版本为 v4.0 时我找不到几个 dll。这是让我烦恼的事情吗？我尝试添加具有所需版本的新 dll，但我没有 10.0 版的这些 dll，而且我在网上的任何地方都没有得到它。如果这就是原因，那么请让我知道我将在哪里获得这些 dll ......？我使用的dll如下：

1.  Microsoft.VisualStudio.OLE.Interop，版本：7.1.40304.0，运行时版本：v1.1.4322

2.  Microsoft.VisualStudio.Shell，版本：10.0.0.0，运行时版本：v4.0.30319，

3.  microsoft.visualstudio.shell.interop.8.0，版本：8.0.0.0，RuntimeVersion：v1.1.4322

4.  Microsoft.VisualStudio.TemplateWizardInterface，版本：8.0.0.0，运行时版本：v2.0.50727

5.  Microsoft.VisualStudio.TextTemplating，版本：9.0.0.0，运行时版本：v2.0.50727

6.  Microsoft.VisualStudio.TextTemplating.Interfaces.10.0，版本：10.0.0.0，运行时版本：v4.0.30319

7.  Microsoft.VisualStudio.TextTemplating.VSHost.10.0，版本：10.0.0.0，运行时版本：v4.0.30319

请建议...

# javascript - FireFox中的DOM原型链遍历

> ID：10013105
> 
> 赞同：0
> 
> 时间：2012-04-04T14:22:38.780
> 
> 标签：javascript, firefox, dom, google-chrome

Chrome 为 div 提供了以下原型链：

```
element = document.getElementById("test")
<div id=​"test">​…​&lt;/div>​
element.__proto__
HTMLDivElement
element.__proto__.__proto__
HTMLElement
element.__proto__.__proto__.__proto__
Element
element.__proto__.__proto__.__proto__.__proto__
Node
element.__proto__.__proto__.__proto__.__proto__.__proto__
Object
element.__proto__.__proto__.__proto__.__proto__.__proto__.__proto__
null 
```

在 Firefox 的情况下，我得到如下所示的内容，而 xpconnect 看起来像一些桥梁。我在 Mozilla 文档中得到了相同的原型链图片（与 Chrome 相同）。这里我的问题是如何通过遍历 HTMLDiv 元素来获取 Node 对象？如果我们有 div 元素，有人可以编写给我 Node 对象或任何其他对象（如 HTMLElement）的 js 代码吗？

图像看起来与 chrome 模型相同，但我需要代码来遍历这棵树:)

提前致谢。

[图片链接](https://developer.mozilla.org/en/JavaScript-DOM_Prototypes_in_Mozilla)

![在此处输入图像描述](../Images/68382a248c2974eff8dcc6e069f4f990.png)

```
var element = document.getElementById("test");
element.toString();
[object HTMLDivElement]
element.__proto__.toString();
[xpconnect wrapped native prototype]
element.__proto__.__proto__.toString();
[xpconnect wrapped native prototype]
element.__proto__.__proto__.__proto__.toString();
[xpconnect wrapped native prototype]
element.__proto__.__proto__.__proto__.__proto__.toString();
[object DOM Constructor.prototype]
element.__proto__.__proto__.__proto__.__proto__.__proto__.toString();
[object Object] 
```

我相信 element.constructor.prototype。**原型**和元素。**原型**是一样的。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-04T15:11:43.760

一个对象的**proto**是一个 object ，它当然有一个对象的**proto** ref，所以它们都是一样的

# jquery-ui - 选择后 IE8 清除 JQuery-UI 自动完成输入字段

> ID：10013110
> 
> 赞同：2
> 
> 时间：2012-04-04T14:22:47.017
> 
> 标签：jquery-ui, events, internet-explorer-8, autocomplete, focus

我有一个 jquery_ui 自动完成功能。当我单击 Firefox 中的选择时，我的代码按预期运行。当我在 IE8 中运行它时，有些东西正在清除输入框中的选择（在我的所有代码运行之后）。

我无法识别清除该字段的代码 - 我正在单步执行代码，但它发生在不同的点 - 我正在处理很多超时，所以可能是其中之一。

我想我希望有人以前遇到过这个..

更新

好的，我已经设法进一步追查了这个问题。这是我附加到实际删除文本的焦点事件的代码。我的问题似乎与 ff 和 ie 之间触发事件的顺序不同有关

我在 jsfiddle 上有一个演示 - [http://jsfiddle.net/aidanewen/nKyLu/](http://jsfiddle.net/aidanewen/nKyLu/)

我在下面包含了我的代码 -

```
<script>
   $(function() {
        var availableTags = [
            "ActionScript",
            "AppleScript",
            "Asp",
            "BASIC",
            "C",
            "C++",
            "Clojure",
            "COBOL",
            "ColdFusion",
            "Erlang",
            "Fortran",
            "Groovy",
            "Haskell",
            "Java",
            "JavaScript",
            "Lisp",
            "Perl",
            "PHP",
            "Python",
            "Ruby",
            "Scala",
            "Scheme"
        ];
        $( "#tags" ).autocomplete({
            source: availableTags,
            select: function(event, ui) {
                $('#output').val(ui.item.label);
            }
        }).focus(function(e) {
            $(this).val("");
        });
    });
</script>

<div id="content_padding">

        <div class="ui-widget">
            <label for="tags">Tags: </label>
            <input id="tags"/>
            <label for="output">Output: </label>
            <input id="output"/>
        </div>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T08:28:43.070

解决方案是添加`return false`到焦点事件 -

```
 $( "#tags" ).autocomplete({
        source: availableTags,
        select: function(event, ui) {
            $('#output').val(ui.item.label);
        }
    }).focus(function(e) {
        $(this).val("");
        return false;
    }); 
```

# rbac - 什么是 XACML 配置文件？

> ID：10013114
> 
> 赞同：3
> 
> 时间：2012-04-04T14:23:01.823
> 
> 标签：rbac, xacml, abac

我是 XACML（可扩展访问控制标记语言）的新手，我有点困惑。我不明白个人资料是什么。例如 RBAC 或 SAML 配置文件。

它们之间有什么区别？结构和元素不总是一样的吗？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T03:13:55.333

XACML 配置文件指定了两件事：应将哪个 AttributeId 用于某些信息，以及策略应采用的特定结构。

XACML 很强大，主要是因为它的灵活性，但是当您想要在组织之间交换策略时，这种灵活性是有代价的。例如，一个组织可能使用标识符“login-id”来指定用户的帐户名，而另一个组织可能使用“用户名”。配置文件可以为此属性定义众所周知的标识符。

当更高级别的管理界面建立在某些策略之上时，指定结构会很有用。通常需要从策略中提取信息并将其呈现给用户，并且限制配置文件中的结构可能是记录预期内容的一种方式。

配置文件也可以用作“这是在 XACML 中执行此用例的一种方法”类型的文档，这样可以节省客户和供应商重新实现轮子的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T20:48:43.147

XACML 中有两种类型的配置文件需要考虑：

1.  配置文件定义了有关如何使用 XACML 来表达明确定义的场景的最佳实践，例如出口控制、知识产权保护和基于角色的访问控制。这些是克雷格提到的个人资料。除了核心 XACML 2.0/3.0 语言之外，这些配置文件不需要代表 XACML 引擎的任何特定技术实现。它们定义了一组通用属性、它们的标识、它们的可能值以及它们在可能的策略中的用途。例如，请参阅此处的 IP 保护配置文件：http: [//docs.oasis-open.org/xacml/3.0/ipc/xacml-3.0-ipc-v1-spec-cs-01-en.pdf](http://docs.oasis-open.org/xacml/3.0/ipc/xacml-3.0-ipc-v1-spec-cs-01-en.pdf)。这些配置文件旨在定义表达共同需求的可互操作方式。
2.  扩展 XACML 2.0/3.0 的技术用途/范围的配置文件。此类配置文件需要代表所用引擎的技术实施。此类配置文件包括 XACML 的 SAML 配置文件、多决策配置文件和管理委托配置文件。例如，多决策配置文件定义了策略执行点如何在单个整体 XACML 请求中发送多个授权请求。这些配置文件旨在扩展 XACML 的技术范围。

我希望这会有所帮助，大卫。

# django - Django Caching - 如何设置我的代码以避免重复缓存逻辑？

> ID：10013115
> 
> 赞同：4
> 
> 时间：2012-04-04T14:23:02.103
> 
> 标签：django, caching

我开始分析我的应用程序，发现有一段代码比其他代码需要更长的时间才能完成。在视图中，我正在从数据库中检索一些数据并对其进行一些转换。在模板中，有一个过滤器将获取这些转换后的数据并将其转换为 HTML。

我意识到我可以利用缓存，因为这个组件不会经常更改，但我想知道最好的方法是什么。我可以缓存数据库调用/转换的结果，但我也可以缓存模板片段。我需要缓存两件事以获得最佳效果似乎很奇怪，所以我想我的代码应该有不同的结构，所以我只需要将数据缓存在一个位置。

我的一个想法是从模板过滤器函数中进行数据库调用，但我一直试图将我的模型代码保留在模板过滤器之外。

处理此类问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T17:59:49.947

如果转换可以表示为复杂的查询集，您可以在模板中评估它，而无需在视图中缓存。如果没有，你可以

*   在缓存块内的模板标签中执行逻辑
*   包装逻辑并将其传递给渲染，通常以闭包或模型方法的形式
*   只做视图缓存，只要渲染过程简单
*   在 TemplateResponse 的帮助下检查 SSI 的可能性
*   编写代码以检查并使用视图中的模板缓存，同时考虑可能的竞争写入和狗堆问题。

此外，对于查询集缓存，您可以尝试[johnny-cache](http://packages.python.org/johnny-cache/)以及[django-cache-machine](https://github.com/jbalogh/django-cache-machine)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:17:13.790

您不需要在视图和模板片段中缓存。缓存的想法是，一旦你缓存了一些东西，你就可以从缓存中获取它，直到缓存键过期。

在视图中缓存数据库结果意味着编写一些特定于视图逻辑的代码，您可能需要在每次逻辑更改时进行更改。

缓存模板片段是一种更好的方法，因为即使您更改模板“逻辑”，只要将片段保留在缓存块中，缓存将继续工作。

恕我直言，您缓存的最终响应越接近，缓存逻辑就越可靠。

# eclipse - Eclipse中已关闭项目的外观

> ID：10013117
> 
> 赞同：3
> 
> 时间：2012-04-04T14:23:04.813
> 
> 标签：eclipse

我们工作的所有项目的列表（即使在我们关闭它们之后）都保留在 Eclipse 的 Package Explorer 窗口中，它们永远不会从窗口中消失。Eclipse 的这种行为真的很烦人，特别是如果我们处理过很多项目的话。

Eclipse 中是否有任何设置使关闭的项目退出窗口？

（默认情况下，已关闭的项目在 Netbeans 中消失）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T14:28:58.950

在 Package Explorer 中，单击右上角的小箭头。选择“过滤器...”，并在要排除的元素列表中标记“已关闭项目”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:27:32.207

查看[工作集](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.user/concepts/cworkset.htm)。就保持工作空间清洁而言，这听起来您可能正在寻找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:26:24.707

您可以删除项目——它将从工作区中消失。您还可以选择物理删除文件，但您可能不想这样做）

# c# - 如何使用 AutoMapper 将数组映射到多个属性？

> ID：10013121
> 
> 赞同：4
> 
> 时间：2012-04-04T14:23:09.663
> 
> 标签：c#, automapper

我需要将一个固定大小的数组映射到多个属性。例如给定这个类：

```
public class Source
{
    public int[] ItemArray{get;set} // always 4 items
} 
```

我想将数组映射到这个类

```
public class Dest
{
    public int Item1 { get; set; }
    public int Item2 { get; set; }
    public int Item3 { get; set; }
    public int Item4 { get; set; }
} 
```

有没有一种简单的方法可以使用 AutoMapper 来实现（无需实际映射每个单独的字段）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T14:30:59.777

为 Dest 的属性创建映射：

```
Mapper.CreateMap<Source, Dest>()
    .ForMember(d => d.Item1, o => o.MapFrom(s => s.ItemArray[0]))
    .ForMember(d => d.Item2, o => o.MapFrom(s => s.ItemArray[1]))
    .ForMember(d => d.Item3, o => o.MapFrom(s => s.ItemArray[2]))
    .ForMember(d => d.Item4, o => o.MapFrom(s => s.ItemArray[3])); 
```

用法：

```
Source source = new Source() { ItemArray = new int[] { 1, 2, 3, 4 } };
Dest dest = Mapper.Map<Source, Dest>(source); 
```

更新：不，没有简单的方法。AutoMapper 将如何理解，您的属性 Foo 应该映射到源属性 Bar 中索引 N 处的元素？您应该提供所有这些信息。

更新：来自[Automapper](https://github.com/AutoMapper/AutoMapper/wiki/Projection)

> 投影将源转换为目标，而不是展平对象模型。如果没有额外的配置，*AutoMapper 需要一个扁平化的目标来匹配源类型的命名结构*。如果要将源值投影到与源结构不完全匹配的目标中，则必须指定自定义成员映射定义。

所以，是的。如果命名结构不匹配，则必须为成员指定自定义映射。

更新：好吧，实际上您可以手动进行所有转换（但我认为这不是更好的方法，特别是如果您有其他可以按名称映射的属性）：

```
Mapper.CreateMap<Source, Dest>().ConstructUsing((s) => new Dest()
{
    Item1 = s.ItemArray[0],
    Item2 = s.ItemArray[1],
    Item3 = s.ItemArray[2],
    Item4 = s.ItemArray[3]
} 
```

# javascript - 在javascript中删除两个“/”之间的字符的正则表达式是什么

> ID：10013124
> 
> 赞同：0
> 
> 时间：2012-04-04T14:23:20.913
> 
> 标签：javascript, regex

我有下一个字符串“/1234/somename”，我想使用正则表达式提取“somename”。

我可以使用下一个代码来完成这项工作，但我想知道如何使用 RegExp 做同样的事情。 `mystring.substring(mystring.lastIndexOf("/") + 1, mystring.length)`

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:26:26.997

在正则表达式中，可以这样做：

```
var pattern = /\/([^\/]+)$/
"/1234/somename".match(pattern);
// ["/somename", "somename"] 
```

该模式匹配 a 之后的所有字符`/`（除了另一个`/`）直到字符串的末尾`$`。

但是，我可能会`.split()`改用：

```
// Split on the / and pop off the last element
// if a / exists in the string...
var s = "/1234/somename"
if (s.indexOf("/") >= 0) {
  var name = s.split("/").pop();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:28:34.783

尝试这个：

```
mystring.match( /\/[^\/]+$/ ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:26:28.060

这个：

```
mystring.substring(mystring.lastIndexOf("/") + 1, mystring.length) 
```

相当于：

```
mystring.replace(/.*[/]/s, '') 
```

（请注意，尽管名称为“replace”，但该方法不会修改`mystring`，而是会返回 的修改副本`mystring`。）

# c# - ASP MVC FileStreamResult OutOfMemoryException

> ID：10013127
> 
> 赞同：0
> 
> 时间：2012-04-04T14:23:34.147
> 
> 标签：c#, asp.net, memorystream, chunking, filestreamresult

我有一个大 zip 文件（500MB 或更大），我正在读入 MemoryStream 并作为 FileStreamResult 返回。但是，对于超过 200MB 的文件，我收到了 OutOfMemory 异常。在我的操作中，我有以下代码：

```
MemoryStream outputStream = new MemoryStream();
using (var fs = new FileStream(filepath, FileMode.Open, FileAccess.Read))
{
   //Response.BufferOutput = false;   // to prevent buffering
   byte[] buffer = new byte[1024];
   int bytesRead = 0;
   while ((bytesRead = fs.Read(buffer, 0, buffer.Length)) > 0)
   {
      outputStream.Write(buffer, 0, bytesRead);
   }
}

outputStream.Seek(0, SeekOrigin.Begin);
return new FileStreamResult(outputStream, content_type); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:47:56.893

如果您将文件读入 MemoryStream ，您仍然需要为整个文件分配内存，因为在内部 MemoryStream 只不过是一个字节数组。

因此，目前您正在使用较小的中间（也在内存中）缓冲区将文件读入大型内存缓冲区。

为什么不直接将文件流转发到 FileStreamResult？

```
using (var fs = new FileStream(filepath, FileMode.Open, FileAccess.Read))
{
    return new FileStreamResult(fs, content_type); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:38:39.380

您可以尝试此页面上提出的解决方案：

[使用文件流发送 500mb 的大文件时出现 OutOfMemoryException](https://stackoverflow.com/questions/3362849/outofmemoryexception-when-send-big-file-500mb-using-filestream-aspnet)

它显示了如何将文件读入`IStream`并发送响应。

# ruby-on-rails - Ruby：如何在 Rails 3 模型中获取所有可用年份

> ID：10013138
> 
> 赞同：3
> 
> 时间：2012-04-04T14:24:04.787
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的 Rails 3 应用程序中有很多文章。要将链接放在索引页面上，我如何在数组中获取所有可用年份（来自 created_at 属性）来执行类似这样的操作

```
years.do | year |
 = link_to year, articles_path(:year => year) 
```

任何想法如何以最少的努力做到这一点（关于数据库查询）？

问候，阿德里安

*EDIT1*：这可能不是最好/最快的。但是 fl00r 提醒了我：

```
@years = []

Article.pluck(:created_at).each do | year |
    @years << year.strftime("%Y")
end

@years = @years.uniq.reverse 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:43:42.043

如果您只想要一系列年份，则可以替代现有答案：

```
@years = Article.uniq.pluck("EXTRACT(YEAR FROM created_at)") 
```

生成以下 SQL 查询：

```
SELECT DISTINCT EXTRACT(YEAR FROM created_at) FROM `articles` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:34:45.277

```
@years = Article.select("YEAR(created_at) as year").group("YEAR(created_at)").pluck(:year)
@years.each do |year|
  = link_to year, articles_path(year: year)
end 
```

或者，正如@seph 提到的

```
@years = Article.select("DISTINCT YEAR(created_at) as year").pluck(:year)
@years.each do |year|
  = link_to year, articles_path(year: year)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:33:56.183

此解决方案高度依赖于您的数据库，但它应该很快。

`created_at`创建一个类方法，用于按时间戳的日期部分选择文章。这是 SQLite 的示例：

```
class Article
  def self.by_year(year)
    where(['strftime("%Y", created_at) = "?"', year])
  end
end 
```

然后您的控制器可以像这样调用该方法：

```
@articles = Article.by_year(params[:year]) 
```

您的视图代码有轻微的语法错误（`years.do`应该是`years.each do`），但除此之外，它看起来还不错。

# php - 如何访问已转换为对象的数组的属性/值？

> ID：10013143
> 
> 赞同：5
> 
> 时间：2012-04-04T14:24:10.693
> 
> 标签：php, arrays, object, php-5.3

如何访问已转换为对象的数组的属性/值？例如，我想访问索引 0 中的值，

```
$obj = (object) array('qualitypoint', 'technologies', 'India');
var_dump($obj->0); 
```

错误，

> 解析错误：语法错误，意外的 T_LNUMBER，在第 11 行的 C:...converting_to_object.php 中需要 T_STRING 或 T_VARIABLE 或 '{' 或 '$'

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T14:35:21.433

试试这个：

```
$obj = (object) array('test' => 'qualitypoint', 'technologies', 'India');

var_dump($obj->test); 
```

结果是：

```
string(12) "qualitypoint" 
```

但试图访问`$obj->0`，同样的错误出现：`Parse error: syntax error, unexpected T_LNUMBER, expecting T_STRING or T_VARIABLE or '{' or '$'`

如果你遍历对象，很难，你可以像通常的数组一样访问属性：

```
foreach($obj as $x) {
    var_dump($x);
} 
```

显然，属性命名规则与[基本变量命名规则](http://www.php.net/manual/en/language.variables.basics.php)相同。

如果将其转换为 ArrayObject，则可以正常访问索引：

```
$obj = new ArrayObject(array('qualitypoint', 'technologies', 'India')); 
```

并倾倒它：

```
var_dump($obj[0]); 
```

你会得到：

```
string(12) "qualitypoint" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:55:21.740

您无法通过`$obj->0`其访问值的原因是它针对 PHP 变量命名，请参阅[http://php.net/manual/en/language.variables.basics.php](http://php.net/manual/en/language.variables.basics.php)了解更多信息。即使你使用`ArrayObject`你仍然会遇到同样的问题

但是有一个补丁...您可以将所有整数键转换为字符串或编写自己的转换函数

例子

```
$array  = array('qualitypoint', 'technologies', 'India' , array("hello","world"));
$obj = (object) $array;
$obj2 = arrayObject($array);
function arrayObject($array)
{
    $object = new stdClass();
    foreach($array as $key => $value)
    {
        $key = (string) $key ;
        $object->$key = is_array($value) ? arrayObject($value) : $value ;
    }
    return $object ;
}
var_dump($obj2->{0}); // Sample Output
var_dump($obj,$obj2); // Full Output to see the difference 

$sumObject = $obj2->{3} ; /// Get Sub Object
var_dump($sumObject->{1});  // Output world 
```

输出

```
 string 'qualitypoint' (length=12) 
```

全输出

```
object(stdClass)[1]
  string 'qualitypoint' (length=12)
  string 'technologies' (length=12)
  string 'India' (length=5)

    array
      0 => string 'hello' (length=5)
      1 => string 'world' (length=5)

object(stdClass)[2]
  public '0' => string 'qualitypoint' (length=12)
  public '1' => string 'technologies' (length=12)
  public '2' => string 'India' (length=5)
  public '3' => 
    object(stdClass)[3]
      public '0' => string 'hello' (length=5)
      public '1' => string 'world' (length=5) 
```

多阵列输出

谢谢

:)

# c# - 派生类强制属性写入初始化组件

> ID：10013146
> 
> 赞同：1
> 
> 时间：2012-04-04T14:24:18.370
> 
> 标签：c#, serialization, windows-forms-designer, codedom

我有一个基类和一个派生类（如下所述），以及一个属性“TestProperty”。我的目标是让我在 testproperty 中设置的值在 intializecomponent 中序列化。这非常关键，因为稍后，我需要基类在设计时访问此属性的新值，除非该值在 intializecomponent 中设置，否则我将无法访问此新值，“默认值”，如果你好的话（但是，我认为默认值属性在这种情况下不相关）。

在下面的情况下，让我的属性序列化的唯一方法是，如果我在设计器中打开“派生”并手动将属性设置为新值。

我担心自定义 codedomserializer 将成为解决方案，但我非常努力避免这种情况。我希望“基础”的代码尽可能少。

我怎样才能让我的属性（在代码中设置我可以从中获取它的任何地方）通过从设计器中编辑它来卡在 initializecomponent 中？

```
public partial class Base : Form
   {
      public Base()
      {
         InitializeComponent();
         TestProperty = "set in the base class";
      }
      [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
      public string TestProperty
      {
         get;
         set;
      }
   } 
```

和一个简单的派生类

```
public partial class Derived : Base
   {
      public Derived()
      {
         InitializeComponent();
         this.TestProperty = "i want to be packed into initializecomponent somehow";
      }
   } 
```

关于我为什么要尝试做我正在做的事情的更多信息。

我的问题是，当我在设计器中打开“派生”时，我有一个自定义编辑器控件 bieng 用于编辑某些属性，称为“可编辑属性”。在这种情况下，EditableProperty 需要访问 TestProperty。在运行时，这没问题，我可以完全访问 Derived 作为一种类型，这没问题。

问题是我正在使用的 EditorControl 位于不同的程序集中，并且它（无论出于何种原因，我认为这是因为它在与派生不同的程序集中）不会加载我在派生的构造函数中设置的新值.

基本上，当我在设计器中打开派生并尝试使用自定义编辑器时，它会“在基类中设置”作为 TestProperty 的值。我需要在 initializecomponent 中设置 TestProperty 才能让我的 editorcontrol 看到该值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:04:36.607

表单设计器没有创建 Derived 的实例；它正在创建 Base 的一个实例，然后从 Derived 调用 InitializeComponent 方法。这就是为什么您设置的属性的新值没有被设计器拾取。

您所要做的就是在设计器中为 Derived 设置属性的值，而不是在构造函数中设置它。这将在 InitializeComponent 中保留该属性的新值，并使其在设计时可见。

# c# - int.TryParse() 为“#.##”返回 false

> ID：10013147
> 
> 赞同：17
> 
> 时间：2012-04-04T14:24:24.053
> 
> 标签：c#, tryparse

我有一个接收字符串参数并将它们转换为整数的函数。
为了安全转换 int.TryParse() 被使用。

```
public IEnumerable<object> ReportView(string param1, string param2)
{
  int storeId = int.TryParse(param1, out storeId) ? storeId : 0;
  int titleId = int.TryParse(param2, out titleId) ? titleId : 0;
  IEnumerable<object> detailView = new Report().GetData(storeId, titleId);
  return detailView;
} 
```

函数调用 ReportView(“2”,”4”)--> int.Tryparse 解析数字成功
函数调用 ReportView(“2.00”,”4.00”) --> int.TryParse 解析数字失败

为什么？任何的想法？

**@Update**
对不起，我的概念是错误的。我是 c# 的新手，我认为 Int.TryParse() 会返回整数部分并忽略小数。但它不会，甚至 Convert.ToInt32("string")
谢谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T14:25:58.143

int.TryParse 不会尝试解析字符串并将其转换为整数以防万一。您需要使用 decimal.TryParse 作为十进制数字字符串。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-04T14:41:29.817

```
public IEnumerable<object> ReportView(string param1, string param2)
{
  decimal tmp;
  int storeId = decimal.TryParse(param1, out tmp) ? (int)tmp : 0;
  int titleId = decimal.TryParse(param2, out tmp) ? (int)tmp : 0;
  IEnumerable<object> detailView = new Report().GetData(storeId, titleId);
  return detailView;
} 
```

以上将适用于整数或十进制字符串。请注意，“2.123”形式的字符串将导致返回整数值 2。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-04T14:26:58.117

2.00 和 4.00 不是整数；它们是小数点后恰好有 0 的十进制值。如果要解析小数，请使用 decimal.TryParse() 或 double.TryParse()，然后截断它们或检查零值尾数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-04T15:36:18.087

对于计算机，“2.00”是浮点数/十进制数，而不是整数。您可以通过删除尾随零来预处理字符串，然后执行 int.TryParse()，而不是执行 decimal.TryParse()。因此，如果您有“2.00”，则继续检查（并删除）字符串的最后一个字符，直到到达“。” （十进制）。如果是“0”或“.” 你可以放下它。最后你会得到“2”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-04T14:26:17.327

2.00 和 4.00 不是整数数据类型 - 这就是原因。如果您希望这些是真的，请尝试 double.TryParse() 或 decimal.TryParse()

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-04T14:26:18.807

它无法解析，因为十进制数不是整数。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-04T14:26:40.087

好吧 2.00 是十进制数，而不是计算机眼中的 int 。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-04-04T14:27:32.863

一个 Int32(int) 只能包含整数值；因此 Int32 Parse/TryParse 函数无法解析带小数的字符串。如果您的字符串值可能包含小数但旨在表示整数，请使用 Decimal.TryParse 然后强制转换。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-04T14:26:31.943

因为“2.00”是小数，而不是整数。

# oracle10g - 在 oracle 10g 中将行转换为列

> ID：10013148
> 
> 赞同：0
> 
> 时间：2012-04-04T14:24:24.567
> 
> 标签：oracle10g, rows, transpose

我想在 oracle 10g 中使用 JOIN 将行转换为列。我不想使用 DECODE 或 XMLAGG 函数。我的表结构如下：

```
GROUP_ID    ENTITYID    GROUP_ENTITYID
1           A997        A995
2           A997        A993
3           A997        A990
4           A988        A987
5           A988        A982
6           A988        A980
7           A979        A975
8           A979        A974
9           A979        A973 
```

我想获取以下格式的数据：

```
ENTITYID    GROUP_ENTITYID

A979    A979,A975,A974,A973
A988    A988,A987,A982,A980
A997    A997,A995,A993,A990 
```

你们能建议我怎么做吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:38:19.723

[Tim Hall 列出了Oracle 中可用](http://www.oracle-base.com/articles/misc/StringAggregationTechniques.php)的各种字符串聚合技术的规范列表。

使用连接来组合数据既不实用也不高效。如果您碰巧知道这`EntityID`将映射到其他三个`Group_EntityID`值，则可以使用连接

```
SELECT a.entity_id, 
       a.entity_id || ','  ||
         a.group_entityID || ',' ||
         b.group_entityID || ',' ||
         c.group_entityID
  FROM table_name a,
       table_name b,
       table_name c
 WHERE a.entityID = b.entityID
   AND a.entityID = c.entityID
   AND a.group_entityID > b.group_entityID
   AND b.group_entityID > c.group_entityID 
```

`Group_EntityID`但是，如果与特定的值相关的数量发生变化，这种方法既不是特别有效也不是特别灵活`EntityID`。

我通常更喜欢创建用户定义的聚合函数（蒂姆列表中的选项之一）并执行类似的操作

```
SELECT entityID, entityID || ',' || string_agg( group_entity_id )
  FROM table_name
 GROUP BY entityID; 
```

如果您想在不创建任何其他对象或函数的情况下执行此操作，可以使用`SYS_CONNECT_BY_PATH`Tim 网站上的方法

```
SQL> ed
Wrote file afiedt.buf

  1  with x as (
  2    select 1 group_id, 'A997' entityID, 'A995' group_entityID from dual union all
  3    select 2, 'A997', 'A993' from dual union all
  4    select 3, 'A997', 'A990' from dual union all
  5    select 4, 'A998', 'A987' from dual union all
  6    select 5, 'A998', 'A982' from dual union all
  7    select 6, 'A998', 'A980' from dual union all
  8    select 7, 'A979', 'A975' from dual union all
  9    select 8, 'A979', 'A974' from dual union all
 10    select 9, 'A979', 'A973' from dual
 11  )
 12  select entityID,
 13         entityID || ',' ||
 14           ltrim( max( sys_connect_by_path( group_entityID, ','))
 15                     keep(dense_rank last order by group_id),
 16                  ',') group_entityID
 17    from (select group_id,
 18                 entityID,
 19                 group_entityID,
 20                 row_number() over (partition by entityID
 21                                        order by group_id) curr,
 22                 row_number() over (partition by entityID
 23                                        order by group_id) - 1 prev
 24            from x)
 25   group by entityID
 26  connect by prev = PRIOR curr
 27      and entityID = PRIOR entityID
 28*  start with curr = 1
SQL> /

ENTI GROUP_ENTITYID
---- ------------------------------
A979 A979,A975,A974,A973
A997 A997,A995,A993,A990
A998 A998,A987,A982,A980 
```

# php - php设置客户端新路径

> ID：10013150
> 
> 赞同：0
> 
> 时间：2012-04-04T14:24:38.230
> 
> 标签：php, path, include, require

我已经使用[http://php.net/manual/en/function.set-include-path.php](http://php.net/manual/en/function.set-include-path.php) **设置包含路径**来设置新的父文件夹以包含 php 文件。现在，在我设置了新的父文件之后，我想包含 CSS 文件。如何包含 css 文件我需要使用旧的父文件夹路径来包含它。

例如：我的文件夹是这样的 > oldParent/newParent/%files

```
href="newParent/CssFile.css" 
```

和 php 文件是这样的：

```
file.php 
```

如您所见，set_include_path 影响 PHP 文件路径方式，但我如何控制 css 路径文件呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:55:56.280

PHP 不会关心您的 Web 资产，除非您尝试将它们全部注入 HTML 并生成一个巨大的单文档怪物。据我所知，您的问题甚至与 PHP 无关。PHP 是一种**服务器端**技术——一旦生成的 HTML 离开服务器，浏览器就无法知道您的 HTML 是如何制作的。

在 HTML 中，您使用特定的 HTML 标记插入图像、脚本或样式表等外部资产，这些标记需要一个带有链接文件（公共）位置的 URL。这通常与服务器磁盘上的路径无关。

# bash - 使用 shell 脚本删除服务器中的文件

> ID：10013151
> 
> 赞同：3
> 
> 时间：2012-04-04T14:24:45.717
> 
> 标签：bash, shell, unix

对所有文件进行 wget 后如何删除服务器中的文件？
我知道删除命令有效，当您对服务器进行了 ftp 时，但在运行 shell 脚本时我无法使用该命令。以下是我的脚本，请告诉我其中有什么问题。

```
#!/bin/bash

filelist='ls *20120330*'
for file in $filelist
do
ftp -vn <$hostname> <<EOFD
  quote USER <username>
  quote PASS <Pass>
binary
 ls -lrt *20120330*
 delete $filelist
quit
EOFD
done 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T17:53:55.260

你要

```
for file in *20120330* 
```

而不是对字面单词`ls`and进行循环`*20120330*`。如果您的实际用例要复杂得多，那么您可能需要将文件列表放在变量中，但我的猜测是您不会，也永远不会。

（你可能在想的是

```
for file in `ls *20120330*` 
```

但这也是错误的，原因不同但相关。另见[http://porkmail.org/era/unix/award.html#ls](http://porkmail.org/era/unix/award.html#ls)）

切线地，您最好创建一个删除所有文件名的脚本，而不是为要删除的每个文件创建一个新的 ftp 会话；

```
#!/bin/bash

dellist=
nl='
' # yeah, nl is a newline in single quotes
for file in *20120330*
do
    dellist="delete $file$nl"
done
ftp -vn <$hostname> <<EOFD
  quote USER <username>
  quote PASS <Pass>
  binary
  ls -lrt \*20120330\*
  $dellist
  quit
EOFD 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:42:42.683

尝试使用`rm`而不是`delete`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T21:34:22.850

ftp 命令

```
prompt
mdel  *20120330* 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T18:54:19.260

如果它是一个选项，我建议使用[ncftpget](http://www.ncftp.com/ncftp/)而不是常规的 ftp，因为它具有使其对像这样的脚本更友好的功能。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-04T18:18:51.657

```
#!/bin/bash
username=luser
password=secret
hostname=localhost

filelist=`ls *20120330*`
for f in $filelist; do
ftp -vn ${hostname} <<EOFD
  USER ${username}
  PASS ${password}
  binary
  ls -l ${f}
  delete ${f}
  quit
EOFD
done 
```

# javascript - 如何在javascript中使用线程

> ID：10013153
> 
> 赞同：0
> 
> 时间：2012-04-04T14:24:55.700
> 
> 标签：javascript, ajax

在 javascript 中，我试图收集变量中的响应并打印它。它将打印变量 undefind，然后打印响应。它将首先打印 servicedata =undefined 然后它将打印从服务器检索到的响应。

```
var data = get(requiredUrl);
console.log('servicedata ='+jsonstr); 
```

我认为它不是在等待响应并执行它下面的语句。为此，我必须使用线程；我怎么能在javascript中做到这一点？

```
function get(partenerUrl) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', partenerUrl, true);

    xhr.send(null);
    xhr.onreadystatechange = function() {
        console.log('in onreadystatechange:' + xhr.readyState + 'status'
                + xhr.status);

        if (xhr.readyState == 4 && xhr.status == 200) {
            var arrayOfObjects = eval(xhr.responseText);
            var jsonstr = JSON.stringify(arrayOfObjects)
            console.log('response>>' + jsonstr);
            return jsonstr;
        }
        return NETWORK_CONNECTION_NOT_FOUND;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:33:14.980

这里有几件事是错误的。该变量`jsonstr`在您的`get`函数中声明，因此您的`console.log('servicedata ='+jsonstr);`调用甚至无法访问它。

但这无论如何都行不通，因为您是正确的，调用是异步的，因此，该行将立即执行。您需要调用函数的`console.log`内部。`get`您已经使用`console.log('response>>' + jsonstr);`. 所以真的看不出问题出在哪里？

PS - 这与线程无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:38:31.733

两件事，首先你做

```
console.log('servicedata ='+jsonstr); 
```

代替

```
console.log('servicedata =' + data); 
```

此外，您在此处进行 aa（作为异步）jax 查询

```
 xhr.open('GET', partenerUrl, true /* The `true` here mean asynchronous`*/); 
```

所以脚本不会等待 xhr.onreadystatechange 回调继续，get 方法永远不会给你发送任何东西。如果要获取实际数据，则必须在 xhr.onreadystatechange 回调中进行，或者（这是一个糟糕的选择）将异步参数设置为 false，但它最终会冻结您的应用程序。

# tfs - 不能嵌套 TFS 分支，所以分支共享代码不起作用？

> ID：10013157
> 
> 赞同：9
> 
> 时间：2012-04-04T14:25:16.207
> 
> 标签：tfs, branch, shared

我一直在遵循[“使用 Visual Studio Team Foundation Server 进行团队开发”](http://tfsguide.codeplex.com/)中关于[构建项目](http://tfsguide.codeplex.com/wikipage?title=Chapter%204%20-%20Structuring%20Projects%20and%20Solutions%20in%20Team%20Foundation%20Source%20Control&referringTitle=Home)和[使用分支将代码从一个团队项目共享到另一个团队项目中](http://tfsguide.codeplex.com/wikipage?title=Chapter%206%20-%20Managing%20Source%20Control%20Dependencies%20in%20Visual%20Studio%20Team%20System&referringTitle=Home)的建议。所以我们的源代码树看起来像这样：

```
server\instance
  Shared
    share
  Project1
    Main
      Product1
      share   (branched into Project1 from Shared)
    Stories
      1607
      1832 
```

或者至少应该。

如您所见，除了在一些共享代码中进行分支外，我们还为每个用户故事使用分支。

问题是，当我尝试从共享项目（源分支名称：$/Shared/share；目标分支名称：$/Project1/Main/share）在共享文件夹中分支时，出现错误：

> TF203028：您无法在 $/Project1/Main/share 处创建分支，因为在 $/Project1/Main 处已存在分支。

据记载，您不能在 TFS 中嵌套分支，因此该错误不足为奇。因此，我似乎陷入了困境，而《团队发展》这本书是错误的。（这本书暗示这应该有效。）

但外表可能具有欺骗性，我比这本书的作者更容易出错。谁能帮我理解如何解决这个问题？

（一个明显的解决方案是让故事分支的根成为共享的兄弟，而不是父级。但这对我们没有任何用处，因为这意味着我们将无法对共享进行更改故事分支中的代码，这会破坏每个故事的分支对象。这也意味着项目中更改路径的工作量相当大。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:11:40.020

我找到了解决方案。

~~TFS 针对 Project1\Main 显示了一个分支图标，而不是文件夹图标。我去`File>Source Control>Branching and Merging>Convert to Folder`并将它转换回一个文件夹。然后我能够将共享分支到 Project1。~~

~~奇怪的是，Main 仍然是创建故事分支的一个点，并且这些分支仍然存在。~~

真正的解决方案是我必须将共享代码分支到项目普通文件夹的地方，而不是分支图标。我去`File>Source Control>Branching and Merging>Convert to Folder`并将它转换回一个文件夹。然后我能够在 Main 之外创建分支。

Main 的分支和故事分支保留了它们的分支图标。share 现在看起来像一个普通的文件夹。

# c# - MongoDB SetDefaultValue 不起作用 - 为什么？

> ID：10013159
> 
> 赞同：1
> 
> 时间：2012-04-04T14:25:28.463
> 
> 标签：c#, mongodb, mapping

我正在使用 C# 和 mongodb 官方驱动程序。使用 BsonClassMap 类映射我的实体时遇到问题。这是一些示例代码：

```
BsonClassMap.RegisterClassMap<Article>(cm =>
{
      cm.AutoMap();
      cm.GetMemberMap(c => c.Title).SetElementName("title").SetDefaultValue("abc");
} 
```

当我将它保存到 db 时，我总是在标题字段中得到一个空值，而不是预期的“abc”。我试过枚举类型并遇到同样的问题 - 我哪里出错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T04:19:45.627

如果要反序列化的文档没有该字段或属性的值，则在反序列化期间使用默认值为字段或属性分配值。

如果您在内存中为 Title 属性创建一个空值的对象，那么空值将存储在数据库中。仅仅因为 Title 为 null 并不意味着在保存文档时它将被替换为默认值。

# c++ - 共享 Lua 脚本的安全性

> ID：10013160
> 
> 赞同：0
> 
> 时间：2012-04-04T14:25:29.730
> 
> 标签：c++, qt, lua

我正在考虑让用户通过我的服务器共享他们自己构建的 Lua 脚本。但是我担心由 Lua 脚本引起的客户端漏洞。据我了解，Lua 是为了防止这种情况而构建的。但是我已经看到了一些 Lua 漏洞。我是否应该寻求另一种方式，也许是沙箱？

我的框架建立在 Qt 之上，我正在考虑使用[QtLua](http://www.nongnu.org/libqtlua/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T21:23:12.370

[将您的脚本执行沙箱](http://lua-users.org/wiki/SandBoxes)化，并确保禁止在客户端和服务器端加载和执行预编译的字节码。在您的沙箱中，确保向我们提供“白名单”技术，以便仅向用户脚本提供经过审查和已知安全（在您的上下文中）的操作。

您可能希望在单独的进程（或线程）中运行脚本并使用平台服务来限制允许脚本消耗的 CPU 时间和内存量，否则被欺骗运行脚本的用户`repeat until false`将消耗整个 CPU 内核并且有类似的对内存的简单攻击。

恕我直言，这是否是一个问题更多的是一个感知问题，因为对个人的个人计算机进行简单的拒绝服务攻击的可能性与启用导致密码或银行详细信息被盗的漏洞利用的可能性不同。

# wcf - 通过 WCF 从 MS Dynamics CRM 插件获取有用的错误消息

> ID：10013162
> 
> 赞同：1
> 
> 时间：2012-04-04T14:25:35.437
> 
> 标签：wcf, silverlight-4.0, crm, microsoft-dynamics

我们有一个带有 WCF 服务中间层的 Silverlight 4 前端，该中间层又引用了 CRM 4 Web 服务。

当我们的插件中发生 InvalidPluginExecutionException 时，我可以从 WCF FaultException 获得的最佳错误消息是一般的 SoapException 消息，这真的没有多大帮助。

有没有办法从我们的插件中获取特定的错误消息，这些消息传播到我们的 WCF（并最终传播到我们的 Silverlight 应用程序）。我们想知道哪些插件失败了。

* * *

我在这里发布了我的答案：

[http://social.microsoft.com/Forums/en-US/crmdevelopment/thread/e8ea5060-74dc-​​4ae6-9a3b-3c824d6dfb1b](http://social.microsoft.com/Forums/en-US/crmdevelopment/thread/e8ea5060-74dc-4ae6-9a3b-3c824d6dfb1b)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T04:07:52.363

如果我理解正确，你可以在你的插件中使用 Try-catch ：

```
try{
...
}    
catch (Exception e)
{
    throw new InvalidPluginExecutionException("Error in MyCustomPlugin:" + e.Message);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-04T07:59:34.380

我们使用广泛的 try catch 块。错误消息存储在一个名为 errorMessage 的变量中，然后作为记录保存在我们创建的名为错误日志的自定义实体中（我们在 finally 方法中对其进行检查，如果它不为空，我们将创建记录）。

```
try
{
    //invoke the web service here
}
catch (System.Net.WebException ex)
{
    tracingService.Trace("WebException");
    if (errorMessage != null && errorMessage.Length > 0)
        errorMessage += "The application terminated with an error.<br />";
    else
        errorMessage = "The application terminated with an error.<br />";
    if (ex.Status == WebExceptionStatus.ProtocolError)
    {
        errorMessage += "Error Code: " + ((HttpWebResponse)ex.Response).StatusCode;
        if (ex.Response != null)
        {
            using (var errorResponse = (HttpWebResponse)ex.Response)
            {
                using (var reader = new StreamReader(errorResponse.GetResponseStream()))
                {
                    string error = reader.ReadToEnd();
                    errorMessage = "Error Message (JSON Format): " + error + "<br />";
                }
            }
        }
    }
}
catch (FaultException<Microsoft.Xrm.Sdk.OrganizationServiceFault> ex)
{
    if (errorMessage != null && errorMessage.Length > 0)
        errorMessage += "The application terminated with an error.<br />";
    else
        errorMessage = "The application terminated with an error.<br />";
    errorMessage += "Timestamp: " + ex.Detail.Timestamp + ".<br />";
    errorMessage += "Code: " + ex.Detail.ErrorCode + ".<br />";
    errorMessage += "Message: " + ex.Detail.Message + ".<br />";
    errorMessage += "Inner Fault: " +
        (null == ex.Detail.InnerFault ? "No Inner Fault" : "Has Inner Fault") + ".<br />";

    tracingService.Trace("The application terminated with an error.");
    tracingService.Trace("Timestamp: {0}", ex.Detail.Timestamp);
    tracingService.Trace("Code: {0}", ex.Detail.ErrorCode);
    tracingService.Trace("Message: {0}", ex.Detail.Message);
    tracingService.Trace("Inner Fault: {0}",
        null == ex.Detail.InnerFault ? "No Inner Fault" : "Has Inner Fault");
}
catch (System.TimeoutException ex)
{

    if (errorMessage != null && errorMessage.Length > 0)
        errorMessage += "The application terminated with an error.<br />";
    else
        errorMessage = "The application terminated with an error.<br />";
    errorMessage += String.Format("Message: {0} <br />", ex.Message);
    errorMessage += String.Format("Stack Trace: {0} <br />", ex.StackTrace);
    errorMessage += String.Format("Inner Fault: {0} <br />",
        null == ex.InnerException.Message ? "No Inner Fault" : ex.InnerException.Message);

    tracingService.Trace("The application terminated with an error.");
    tracingService.Trace("Message: {0}", ex.Message);
    tracingService.Trace("Stack Trace: {0}", ex.StackTrace);
    tracingService.Trace("Inner Fault: {0}",
        null == ex.InnerException.Message ? "No Inner Fault" : ex.InnerException.Message);
}
catch (System.Exception ex)
{
    tracingService.Trace("The application terminated with an error.");
    tracingService.Trace(ex.Message);

    errorMessage = String.Format("The application terminated with an error.<br />");
    errorMessage += String.Format(ex.Message + "<br />");

    // Display the details of the inner exception.
    if (ex.InnerException != null)
    {
        tracingService.Trace(ex.InnerException.Message);

        FaultException<Microsoft.Xrm.Sdk.OrganizationServiceFault> fe = ex.InnerException
            as FaultException<Microsoft.Xrm.Sdk.OrganizationServiceFault>;
        if (fe != null)
        {
            tracingService.Trace("Timestamp: {0}", fe.Detail.Timestamp);
            tracingService.Trace("Code: {0}", fe.Detail.ErrorCode);
            tracingService.Trace("Message: {0}", fe.Detail.Message);
            tracingService.Trace("Trace: {0}", fe.Detail.TraceText);
            tracingService.Trace("Inner Fault: {0}",
                null == fe.Detail.InnerFault ? "No Inner Fault" : "Has Inner Fault");

            errorMessage += String.Format("Timestamp: {0} <br />", fe.Detail.Timestamp);
            errorMessage += String.Format("Code: {0} <br />", fe.Detail.ErrorCode);
            errorMessage += String.Format("Message: {0} <br />", fe.Detail.Message);
            errorMessage += String.Format("Trace: {0} <br />", fe.Detail.TraceText);
            errorMessage += String.Format("Inner Fault: {0} <br />",
                null == fe.Detail.InnerFault ? "No Inner Fault" : "Has Inner Fault");
        }
    }
} 
```

# javascript - 我打开新窗口的代码无效。谁能发现我的错误？

> ID：10013163
> 
> 赞同：0
> 
> 时间：2012-04-04T14:25:35.547
> 
> 标签：javascript, input, popup

我有这个代码：

```
<INPUT type="button" value="Pre-Requisites" onClick="window.open('pre_requisites.php','pre-requisites','width=670px,height=470px,left=0px,top=100px,screenX=0,screenY=100')"> 
```

它用于打开一个新页面，以允许用户查看他们正在申请的项目的信息。在这种情况下，弹出窗口将很有用，因为用户可以在决定申请哪个许可证时参考新窗口中的材料。

但是使用该输入，无论我如何单击窗口都不会打开。我可以知道我的错误是什么吗？

顺便说一句，我没有`<script></script>`在 head 标签中添加任何内容……这可能是错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:38:43.887

窗口的名称必须是字母数字以获得最大兼容性。所以

```
window.open('pre_requisites.php','prerequisites','width=670px,height=470px,left=0px,top=100px,screenX=0,screenY=100') 
```

它应该是有效的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:30:14.937

如果我查看[此](http://www.javascript-coder.com/window-popup/javascript-window-open.phtml)页面，我看不到**top**、**left**、**screenX**或**screenY**设置。也许那是你的问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:34:58.770

据此[，](http://www.w3schools.com/jsref/met_win_open.asp)没有 screenX 和 screenY 设置。此外，在任何地方都放置“px”：

```
<INPUT type="button" value="Pre-Requisites" onClick="window.open('pre_requisites.php','pre-requisites','width=670,height=470,left=0,top=100')"> 
```

虽然没有测试过。

# google-maps-api-3 - Google Map API 3 从 API 2 的代码中为标记创建不同的颜色

> ID：10013167
> 
> 赞同：0
> 
> 时间：2012-04-04T14:25:49.790
> 
> 标签：google-maps-api-3, google-maps-markers

我在 API 2 中使用了此代码，但找不到 API 3 的等效代码。我想根据严重性为标记创建不同的颜色，因此它们不是静态值。我对如何创建 **GICON、G_DEFAULT_ICON、GSize 和 addOverlay 有疑问**。如果有人告诉我如何转换这个确切的代码，我将不胜感激。由于我使用的特定颜色，我不想使用 micons/color-dot.png。

```
var severity = parseFloat(markers[i].getAttribute("severity"));
var severityIcon = new GIcon(G_DEFAULT_ICON);
var color;
if (severity == 0) color = "66FF33";
else if (severity == 1) color = "990099";
else if (severity == 2) color = "00CCFF";

severityIcon.image = "http://www.googlemapsmarkers.com/v1/" + color;
severityIcon.iconSize = new GSize(15, 30);

markerOptions = { icon:severityIcon };

  var marker = createMarker(point,label,alarm,markerOptions);
  map.addOverlay(marker); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T20:34:00.253

# java - 从文件输入中有效地替换 ANTLRInputStream (ANTLRStringStream) 的字符串或字符

> ID：10013170
> 
> 赞同：1
> 
> 时间：2012-04-04T14:26:00.740
> 
> 标签：java, pattern-matching, antlr3

正如我在[Antlr greedy-option](https://stackoverflow.com/questions/10002164/antlr-greedy-option)中所描述的，我在使用一种可能在字符串文字中包含字符串文字的语言时遇到了一些问题，例如：

```
开始：“img src="test.jpg""
```

Bart Kiers 先生在我的帖子中提到，不可能创建一个可以解决我的问题的语法。因此我决定将语言更改为：

```
开始：“img src='test.jpg'”
```

在启动词法分析器（和解析器）之前。

文件输入可以是：

```
开始：“aaa”aaa“
 “啊啊啊啊啊”
:END_START

开始：“aaa”aaa“
 “啊”啊
 一个
 啊”
:END_START

开始：“aaab”bbaaaa“
:END_START

```

所以我有一个解决方案，~~但它是不正确的~~。我有~~两个~~关于我的问题的问题（在代码下方）。我的代码是：

```
public static void main(String[] args) {

    try{
        FileInputStream fis = new FileInputStream("src/file.txt");
        String preparedCode = preparingCode(fis);

        ANTLRStringStream in = new ANTLRStringStream(preparedCode);

        TestLexer lex = new TestLexer(in);
        CommonTokenStream tokens = new CommonTokenStream(lex);
        TestParser parser = new TestParser(tokens);

        parser.rule();
    }catch(IOException ex){
        ex.printStackTrace();
    } catch (RecognitionException e) {
        System.out.println(e.getMessage());
        System.exit(0);
    }
}

static String preparingCode(FileInputStream input){
    DataInputStream data = new DataInputStream(input);
    StringBuilder oldCode = new StringBuilder();
    StringBuffer newCode = new StringBuffer(oldCode.length());

    Pattern pattern = Pattern.compile("(START:\\s\")(.+)(\"\\n:END_START)");
    String strLine;
    try{
      while ((strLine = data.readLine()) != null)   
          oldCode.append(strLine + "\n");
    }
    catch(IOException ex){
      ex.printStackTrace();
    }

    Matcher matcher = pattern.matcher(oldCode);

    while (matcher.find()) {
      //eliminate quotes inside a string literal
      String stringLiteral = matcher.group(2).replaceAll("\"", "'");

      String replace = matcher.group(1) + stringLiteral + matcher.group(3);
      matcher.appendReplacement(newCode, Matcher.quoteReplacement(replace));
    }
    matcher.appendTail(newCode);

    System.out.println(newCode);

    return newCode.toString();
} 
```

我的问题是：

*   ~~哪种模式是正确的？重要的是，字符串文字可以在多行上定义，例如 "aaaa"\n"bbb"，但*总是*以 "\n:END_START" 行结束。我希望得到以下结果：~~

```
开始：“啊啊啊啊”
 “啊啊啊啊”
:END_START

开始：“啊啊啊啊”
 啊啊啊
 一个
 啊”
:END_START

开始：“aaab'bbaaaa”
:END_START

```

我玩弄了模式标志 Pattern.DOTALL

```
Pattern pattern = Pattern.compile("(START:\s\")(.+)(\"\n:END_START)", Pattern.DOTALL);
```

但这不是解决方案，因为在这种情况下它匹配一切......

-**~~如果我会使用正确的模式，~~有没有其他有效的方法来解决它？**

* * *

**修复第一个问题**
，我必须使用带有模式标志 Pattern.DOTALL 的非贪婪方法：

```
Pattern pattern = Pattern.compile("(START:\\s\")(.+?)(\"\\n:END_START)", Pattern.DOTALL);
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T13:20:58.250

**修复第一个问题**
，我必须使用带有模式标志 Pattern.DOTALL 的非贪婪方法：

```
Pattern pattern = Pattern.compile("(START:\\s\")(.+?)(\"\\n:END_START)", Pattern.DOTALL);
```

编码：

```
 public static void main(String[] args) {

    try{
        FileInputStream fis = new FileInputStream("src/file.txt");
        String preparedCode = preparingCode(fis);

        ANTLRStringStream in = new ANTLRStringStream(preparedCode);

        TestLexer lex = new TestLexer(in);
        CommonTokenStream tokens = new CommonTokenStream(lex);
        TestParser parser = new TestParser(tokens);

        parser.rule();
    }catch(IOException ex){
        ex.printStackTrace();
    } catch (RecognitionException e) {
        System.out.println(e.getMessage());
        System.exit(0);
    }
}

static String preparingCode(FileInputStream input){
    DataInputStream data = new DataInputStream(input);
    StringBuilder oldCode = new StringBuilder();
    StringBuffer newCode = new StringBuffer(oldCode.length());

    Pattern pattern = Pattern.compile("(START:\\s\")(.+?)(\"\\n:END_START)", Pattern.DOTALL);
    String strLine;
    try{
      while ((strLine = data.readLine()) != null)   
          oldCode.append(strLine + "\n");
    }
    catch(IOException ex){
      ex.printStackTrace();
    }

    Matcher matcher = pattern.matcher(oldCode);

    while (matcher.find()) {
        System.out.println("++++"+matcher.group(2));
      //eliminate quotes inside a string literal
      String stringLiteral = matcher.group(2).replaceAll("\"", "'");

      String replace = matcher.group(1) + stringLiteral + matcher.group(3);
      matcher.appendReplacement(newCode, Matcher.quoteReplacement(replace));
    }
    matcher.appendTail(newCode);

    System.out.println(newCode);

    return newCode.toString();
} 
```

那么有没有其他方法可以解决这个问题呢？

# c# - 通信异常并自动重新连接？

> ID：10013175
> 
> 赞同：4
> 
> 时间：2012-04-04T14:26:05.217
> 
> 标签：c#, wcf, fault

假设我有一个 WCF 客户端，它使用 channelfactory 与 IIS7(TCP) 中的 WCF 服务进行通信。如果通信中断（或服务回收），则来自客户端的下一次调用将导致异常。

此时我需要隐藏异常，而是尝试重新连接/重新登录。

**问题是**是否有任何简单的方法可以做到这一点，而无需在客户端的每个 ServiceAgentMethod 中添加处理代码？例如，这可以用 MessageInspector 解决吗？

在我的情况下，我在客户端中有几个代理类，它们使用从 ChannelFactory 创建的单个 IServceInterface 运行服务方法。像这样的东西：

```
MyServiceAgent.GetService().GetMyObjects 
```

GetService() 将返回由 ChannelFactory 在登录时创建的 IServiceInterface。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:43:20.157

我不会使用[消息检查](http://msdn.microsoft.com/en-us/library/aa717047.aspx)器尝试它；当一个通道出现故障时，它会出现*严重*故障（如您所见，您会遇到异常）。它用于指示该通道不再被认为是有效的，并且您不应该对其进行调用。

您可能认为您可以在传输层执行此操作，但您需要协调其上方的各层（以便翻译通过线路输入的内容，您确实不应该访问）以确定不管你有没有过错。

最终，您会希望在调用代理的级别发出重试逻辑。在调用代理之前/之后截取客户端（接口）的抽象；如果出现异常，您可以重试调用，根据需要创建新的代理/通道。

小心限制您执行的重试次数；如果你不这样做，你最终会得到一颗毒丸（你的代码将无限重试）。在某些时候，您会*想要*抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-11T14:17:44.057

您可以编写一个可用于进行 WCF 调用的通用使用者。在提供的示例中，您可以指定重试计数，它可以更好地处理客户端的拆除和重新创建。

这仍将在客户端，但因为它是通用的并且隐藏了复杂性，我认为它是一个优雅的解决方案：

```
var consumer = new ServiceClientWrapper<AuthorServiceClient, AuthorService>();
author = consumer.Excecute(service => service.AddAuthor(request)); 
```

[https://github.com/mariusvrstr/WcfClientStressTest/blob/master/Spike.Common/ServiceClientWrapper.cs](https://github.com/mariusvrstr/WcfClientStressTest/blob/master/Spike.Common/ServiceClientWrapper.cs)

# c++ - std::vector 与普通数组

> ID：10013190
> 
> 赞同：5
> 
> 时间：2012-04-04T14:26:46.250
> 
> 标签：c++, arrays, performance, stl

我正在创建一个需要超快的程序。它使用 CUDA 在 GPU 上运行一些东西，然后在 CPU 上进行一些计算。为此，我需要将高度优化的 GPU 数据结构转换为我可以在 CPU 上轻松使用的东西。我的数据基本上是一个以网格布局的图表。目前我正在使用 std::vector 作为 CPU 部分。因为我知道如果我做很多 s 会有相当大的开销，`push_back()`而且我至少知道因为我知道我的图中有多少个顶点，所以我现在为此使用以下代码：

```
new_graph.resize(blockSize * blockSize);
for (unsigned long long y = 0; y < blockSize; y++) {
    for (unsigned long long x = 0; x < blockSize; x++) {
        int idx = y * blockSize + x;
        new_graph[idx] = Vertex(x, y);
    }
} 
```

之后我添加边缘。不幸的是，我不知道每个顶点有多少条边，但我知道它永远不会大于 8。因此，我`reserve()`在每个用于边的 std::vector 中都有 8 个。

但是，这两者似乎都非常缓慢。如果我对图形本身使用普通数组（所以基本上替换了外部 std::vector），那部分的速度提升是巨大的（比如 10 倍左右）。

对于图形这是可行的，但对于边缘不是真的，因为我在这些边缘上做了一些后处​​理，为此我真的需要像 std::vector 这样有点动态的东西（我添加了一些边缘）。

目前将数据转换为 std::vector 的速度比在 GPU 上运行我的算法（这是一种智能 MST 算法）慢 10 倍。这不是我真正想要的，因为现在开销太大了。

有人知道发生了什么或我该如何解决这个问题？

ps 我用-O2 编译，因为我已经发现这会产生很大的不同。也尝试使用-O3，没有真正的区别。

顶点定义如下：

```
struct Pos {
    int x, y;
    Pos() {
        x = 0;
        y = 0;
    }

    Pos(int x, int y) {
        this->x = x;
        this->y = y;
    }
};

struct Vertex {
    Pos pos;
    bool hidden;
    unsigned long long newIdx;
    Vertex() {
        this->pos = Pos();
        this->hidden = false;
        this->numEdges = 0;
        this->numRemovedEdges = 0;
    }

    Vertex(Pos &pos) {
        this->pos = pos;
        this->hidden = false;
        this->numEdges = 0;
        this->numRemovedEdges = 0;
    }

    Vertex(int x, int y) {
        this->pos = Pos(x, y);
        this->hidden = false;
        this->numEdges = 0;
        this->numRemovedEdges = 0;
    }
    int numEdges;
    int numRemovedEdges;
    std::vector<Edge> edges;
    std::vector<bool> removed;
    std::vector<bool> doNotWrite;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T17:21:55.170

也许您正在`vector`为为其元素保留空间的动态内存分配付费？

即使您`reserve`处于最佳状态，您也将至少**为每个分配 3 个内存`Vertex`**（一个 for `edges`，一个 for`removed`和一个 for `doNotWrite`）。相对于您在此处尝试执行的高性能工作，动态内存分配可能很昂贵。

要么使用保证足够大的普通旧数组（可能会浪费空间），要么使用专门的内存分配器以及`vector`根据您的特定需求量身定制的 .

* * *

另外，您是否按内存顺序访问元素？您的示例似乎表明了这一点，但是您是否在所有情况下都这样做？

* * *

另外，你还需要`Vertex.pos`吗？不能从' 在网格中的位置*推断出来吗？*`Vertex`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T20:39:46.990

我最近在类似情况下使用了另一种解决方案。在 llvm 包中有 SmallVector 类。它提供了与 std::vector 非常相似的接口，但它允许保持一些固定数量的元素内联（因此，除非向量增长超过初始限制，否则不会发生额外的内存分配）。如果 SmallVector 试图增长到超过该初始大小，则分配内存块，并将所有项目移到那里 - 所有这些都在一个透明的步骤中完成。

我必须在这个 SmallVector 中修复的几件事：

1.  可以就地放置的最小项目数是 2，因此当在 99.99% 的情况下使用 1 个项目时，会有相当大的开销
2.  通常使用 swap() 来释放内存（ SmallVector().swap(vec) ）不会释放内存，所以我必须自己实现它

只需查找最新版本的 llvm 即可获取 SmallVector 类的源代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T03:17:51.657

由于动态内存分配的数量、不必要的分配操作以及每个 Vertex 的整体大小，CPU 数据结构的效率极低。在考虑优化此结构之前，最好了解 CPU 数据结构和 GPU 数据结构之间的数据流，因为这两种格式之间的转换可能需要很长时间。这就引出了一个问题，为什么 CPU 端不使用 GPU 结构？

如果您只是从 CPU 端来看这个并且想要维护 AoS 数据结构，那么 1\. 简化 Vertex 数据结构。2.删除所有动态内存分配。每个 std::vector 将执行 dynb 3\. 将已删除和 doNotWrite 替换为 std::bitset<8>。4\. 删除 numRemoveEdges。这是删除的.count()。5\. 如果 Edge 很小，那么您可能会发现声明 Edge 边[8] 会更快。6\. 如果您决定继续使用向量，请考虑使用池分配器。7.按大小对Vertex中的数据元素重新排序，以减小Vertex的大小。

所有这些建议很可能不是与 GPU 共享数据的最佳解决方案。如果您确实使用池分配器并使用 UVA (CUDA Linux)，您可以使用单个内存副本简单地将数据复制到 GPU。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T16:09:31.877

您不能创建一个 Vertex 对象，将 x 和 y 值存储到其中（这样您就不必为每个循环调用构造函数），然后将整个 Vertex 存储到您的 std::vector 中吗？向量的内存保证像常规数组一样布局，因此您可以绕过所有抽象并直接操作内存。不需要复杂的东西。此外，也许您可​​以对从 GPU 返回的数据进行布局，以便您可以一次 memcpy 整个块，从而为您节省更多。

# jquery - 用jquery识别重复值

> ID：10013192
> 
> 赞同：0
> 
> 时间：2012-04-04T14:26:57.060
> 
> 标签：jquery, list, html-lists

假设我有一个这样的列表

```
<ul>
<li>Item 1</li>
<li>Item 2</li>
<li>Item 3</li>
<li>Item 1</li>
</ul> 
```

使用 jQuery 如何识别值何时重复。我的目的是为重复值赋予另一种风格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:35:57.277

您可以循环浏览所有`<li>`对象，获取它们的文本并将其收集到您用作索引的对象中（为了提高效率）。完成后，查看哪些项目具有多个带有任何给定文本的元素，并为它们添加一个特殊的类。出于效率原因，此解决方案使用对象来构建索引。代码是这样工作的：

HTML：

```
<ul id="list">
<li>Item 1</li>
<li>Item 2</li>
<li>Item 3</li>
<li>Item 1</li>
</ul>​ 
```

带有注释的 Javascript：

```
(function() {
    var index = {};
    $("#list li").each(function() {
        var text = $(this).text();
        // if this text not in the index yet, create an array for it
        if (!(text in index)) {
            index[text] = [];
        }
        // add this item to the array
        index[text].push(this);
    });
    // cycle through the index and find each item that has more than one DOM element
    $.each(index, function() {
        // "this" will be an array of DOM nodes
        if (this.length > 1) {
            $(this.slice(1)).addClass("duplicates");
        }
    });
})();​ 
```

​工作演示：http: [//jsfiddle.net/jfriend00/zDhjD/](http://jsfiddle.net/jfriend00/zDhjD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:36:35.950

```
$("ul li").each(function(){
   var val = $(this).text();  
   $("ul li").not(this).each(function(){
    if($(this).text() == val){
     $(this).addClass("mystyle");
    }
   });
}); 
```

[http://jsfiddle.net/tscRG/](http://jsfiddle.net/tscRG/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:36:43.593

试试这个：

```
​$('ul > li')​.each(function(){
    var current = this;
    $('ul').find('li:contains(' + $(this).html() + ')').each(function(){
        if(current != this) {
            $(this).css('color', 'red');
        }
    });
});​ 
```

jsFiddle 上的[演示](http://jsfiddle.net/antyrat/bbV9p/)

# c# - .NET 正则表达式引擎不返回匹配项，但我期待 8

> ID：10013197
> 
> 赞同：3
> 
> 时间：2012-04-04T14:27:10.803
> 
> 标签：c#, .net, regex

我正在尝试编写一个正则表达式以从 SQL 脚本中获取每个插入行。当我在 Regex Hero 上使用 .NET Regex Tester 时，[我得到了预期的 8 个匹配项](http://regexhero.net/tester/?id=46b27299-db52-4797-8701-12378eb55670)。但是，当我将此代码段作为控制台应用程序运行时，它不会返回任何匹配项。

```
const string text =
@"INSERT INTO [AdminPrefs] ( [SpayClinic] , [VaxClinic] , [ShelterClinic] , [DateModified] , [Prefix] , [UpdateCounter] , [LockedRecs] , [dbName] , [Timer] , [MedCtrClinic] , [OtherClinic] , [Da2PPPx] , [Da2PPEPx] , [FVRCPPx] , [FVRCPEPx] , [FELVTPx] , [FELVTEPx] , [FELVVPx] , [FELVVEPx] , [HWTPx] , [HWTEPx] , [RabiesPx] , [RabiesEPx] , [FIVTest] , [FIVTestE] , [OnePlusChar] , [XSHWMPx] , [XSHWMEPx] , [SHWMPx] , [SHWMEPx] , [MHWMPx] , [MHWMEPx] , [LHWMPx] , [LHWMEPx] , [DebuggerOn] , [PayThisAmount] , [free6] , [XSHWMPillPx] , [XSHWMPillEPx] , [SHWMPillPx] , [SHWMPillEPx] , [MHWMPillPx] , [MHWMPillEPx] , [LHWMPillPx] , [LHWMPillEPx] , [free7] , [free8] , [free9] , [XSPMPx] , [XSPMEPx] , [SPMPx] , [SPMEPx] , [MPMPx] , [MPMEPx] , [LPMPx] , [LPMEPx] , [ReceiptFooter] , [MonthsUntilBenefits] , [free12] , [XSPMPillPx] , [XSPMPillEPx] , [SPMPillPx] , [SPMPillEPx] , [MPMPillPx] , [MPMPillEPx] , [LPMPillPx] , [LPMPillEPx] , [free14] , [ClinicName] , [ShelterName] , [ShelterAbbr] , [Address1] , [Address2] , [City] , [State] , [ZipCode] , [MainPhone] , [MainFax] , [SplashPict] , [free17] , [free18] , [LicenseNo] , [SerialNo] , [free20] , [free21] , [free22] , [VLogCC] , [SNLogCC] , [free23] , [free24] , [free25] , [AgeAndBDay] , [free26] , [free27] , [free28] , [CurrRouteNum] )
VALUES
(12 , 7 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0),
(15 , 53 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0),
(20 , 216 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0),
(16 , 8 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0);

INSERT INTO [AdminPrefs] ( [SpayClinic] , [VaxClinic] , [ShelterClinic] , [DateModified] , [Prefix] , [UpdateCounter] , [LockedRecs] , [dbName] , [Timer] , [MedCtrClinic] , [OtherClinic] , [Da2PPPx] , [Da2PPEPx] , [FVRCPPx] , [FVRCPEPx] , [FELVTPx] , [FELVTEPx] , [FELVVPx] , [FELVVEPx] , [HWTPx] , [HWTEPx] , [RabiesPx] , [RabiesEPx] , [FIVTest] , [FIVTestE] , [OnePlusChar] , [XSHWMPx] , [XSHWMEPx] , [SHWMPx] , [SHWMEPx] , [MHWMPx] , [MHWMEPx] , [LHWMPx] , [LHWMEPx] , [DebuggerOn] , [PayThisAmount] , [free6] , [XSHWMPillPx] , [XSHWMPillEPx] , [SHWMPillPx] , [SHWMPillEPx] , [MHWMPillPx] , [MHWMPillEPx] , [LHWMPillPx] , [LHWMPillEPx] , [free7] , [free8] , [free9] , [XSPMPx] , [XSPMEPx] , [SPMPx] , [SPMEPx] , [MPMPx] , [MPMEPx] , [LPMPx] , [LPMEPx] , [ReceiptFooter] , [MonthsUntilBenefits] , [free12] , [XSPMPillPx] , [XSPMPillEPx] , [SPMPillPx] , [SPMPillEPx] , [MPMPillPx] , [MPMPillEPx] , [LPMPillPx] , [LPMPillEPx] , [free14] , [ClinicName] , [ShelterName] , [ShelterAbbr] , [Address1] , [Address2] , [City] , [State] , [ZipCode] , [MainPhone] , [MainFax] , [SplashPict] , [free17] , [free18] , [LicenseNo] , [SerialNo] , [free20] , [free21] , [free22] , [VLogCC] , [SNLogCC] , [free23] , [free24] , [free25] , [AgeAndBDay] , [free26] , [free27] , [free28] , [CurrRouteNum] )
VALUES
(26 , 5 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0),
(18 , 12 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0),
(9 , 10 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0),
(2 , 72 , 0 , '0000/00/00 00:00:00:00' , '' , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , '' , '' , '' , '' , '' , '' , '' , '' , '' , '' , X'5443503408' , 0 , 0 , '' , 0 , 0 , 0 , 0 , '' , '' , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0);
";

static void Main(string[] args)
{
    string query = @"^\(.*?\)(,|;)$";

    var matches = Regex.Matches(text, query, RegexOptions.Singleline | RegexOptions.Multiline);

    Console.WriteLine("Expected Matches: 8");
    Console.WriteLine("Matches Found: {0}", matches.Count);

    Console.ReadLine();
} 
```

对于网站和我的代码（多行和单行），我的选项完全相同，它们应该使用相同的 .NET 正则表达式引擎，那么是什么导致了两者之间的差异？

* * *

**最终结果：**

对于所有好奇的人，我最后的正则表达式是

```
@"(?<=^\()                       # The beginning of a line followed by a (
((('(?<c>.*?)'(?!')(?=[\s\)])) | # Text string in SQL supports line breaks
  (?<c>-?[\d\.]+) |              # Any numbers
  (X'(?<c>[0-9a-f]*)')           # Something formatted like X'0123456789abcdef'
  )(\s,\s)?                      # Spaces and commas between the records
)+                               # Repeat the pattern at least one time
(?=(?<!'')\)[;,]\r?$)            # The End of the line ending with ); or ), and not immediately proceeded by ''"; 
```

请注意所有计划将其用于研发（盗版和部署）开发的人，这仅适用于我的 SQL，因为它非常常规。如果与不是由我的第 3 方程序生成的 SQL 一起使用，则需要调整以处理我不需要处理的许多边缘情况。

这是解析器的解析代码的完整代码。希望它会帮助其他陷入类似问题的人。

```
foreach (var tableFolder in Directory.GetDirectories(_exportFolder))
{
    //Popluate the schema of the DataTable
    DataTable table = new DataTable();
    using (SqlDataAdapter ada = new SqlDataAdapter(String.Format("Select top 0 * from [{0}]", Path.GetFileName(tableFolder)), conn))
    {
        ada.Fill(table);
    }

    //All of the files to import for this table
    string[] filePaths = Directory.GetFiles(tableFolder, "*.sql");

    foreach (string file in filePaths)
    {
        string text;
        using (var txtRdr = new StreamReader(file))
        {
            text = txtRdr.ReadToEnd();
        }

        const string recordRegex =
                        @"(?<=^\()                       #The begining of a line followed by a (
                        ((('(?<s>.*?)'(?!')(?=[\s\)])) | # Something formatted like 'some text' supports line breaks
                            (?<n>-?[\d\.]+) |            # Any numbers
                            (X'(?<h>[0-9a-f]*)')         # Something formatted like X'0123456789abcdef'
                            )(\s,\s)?                    # Spaces and commas between the records
                        )+                               # Repeat the pattern at least one time
                        (?=(?<!'')\)[;,]\r?$)            # The End of the line ending with ); or ), and not immedatly proceded by ''";            

        //Creates one match per row in the database
        var records = Regex.Matches(text, recordRegex, RegexOptions.Singleline | RegexOptions.Multiline | RegexOptions.IgnorePatternWhitespace | RegexOptions.IgnoreCase | RegexOptions.ExplicitCapture);

        const string headerRegex = @"^INSERT\sINTO\s\[[\w_\-\s]+\]\s\(\s(?:\[([\w_\-\s]+)\]\s(?:,\s)?)+\)";
        var header = Regex.Match(text, headerRegex).Groups[1].Captures.Cast<Capture>().ToArray();

        foreach (Match record in records)
        {
            //Due to how we captured the 3 groups we had to put them back in order in one list.
            var columns = record.Groups.Cast<Group>()
                                .Skip(1)  //Groups[0] contins the entire record.
                                .SelectMany(group => group.Captures.Cast<Capture>()) //Flattens all of the captures in the three groups in to one list
                                .OrderBy(capture => capture.Index) //Reorder the combined list as the SelectMany will not be outputting the correct order.
                                .ToArray(); 

            DataRow row = table.NewRow();
            for (int i = 0; i < columns.Length; i++)
            {
                Type columnType = table.Columns[header[i].Value].DataType;
                if (columnType == typeof(String))
                {
                    row[header[i].Value] = columns[i].Value;
                }
                else if (columnType == typeof(Int32))
                {
                    row[header[i].Value] = Convert.ToInt32(columns[i].Value);
                }
                else if (columnType == typeof(Double))
                {
                    row[header[i].Value] = Convert.ToDouble(columns[i].Value);
                }
                else if (columnType == typeof(Boolean))
                {
                    if (columns[i].Value == "0")
                        row[header[i].Value] = false;
                    else if (columns[i].Value == "1")
                        row[header[i].Value] = true;
                    else
                        throw new InvalidDataException();
                }
                else if (columnType == typeof(Int16))
                {
                    row[header[i].Value] = Convert.ToInt16(columns[i].Value);
                }
                else if (columnType == typeof(Byte[]))
                {
                    row[header[i].Value] = StringToByteArray(columns[i].Value);
                }
                else
                {
                    throw new NotImplementedException();
                }

            }
            table.Rows.Add(row);
        }

        using (var bulkCopy = new SqlBulkCopy(conn))
        {
            bulkCopy.DestinationTableName = Path.GetFileName(tableFolder);
            bulkCopy.BulkCopyTimeout = 0;
            bulkCopy.WriteToServer(table);
        }
    }
} 
```

* * *

**更新：**

通过将 caputre 组重命名为所有相同的名称 .NET 的正则表达式引擎为我组合了它们，这简化了

```
var columns = record.Groups[1].Cast<Group>().Skip(1).SelectMany(group => group.Captures.Cast<Capture>()).OrderBy(capture => capture.Index).ToArray(); 
```

到

```
var columns = record.Groups[1].Captures.Cast<Capture>().ToArray(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T14:44:52.590

请注意，在 Regex Hero 页面上切换“CrLf 标记行结束”设置会导致 8 行停止匹配；这是导致问题的线索。

在您的 C# 代码中，文字字符串中的换行符被编码为 CR/LF 对 ( `"\r\n"`)。正`$`则表达式中的 （匹配多行模式下的行尾）仅匹配`\n`字符。`\r`因此，在正则表达式不考虑的最后一个逗号（或分号）之间有一个额外的字符，并且匹配失败。

您可以解决此问题的一些方法包括：

1.  去掉回车：`text = text.Replace("\r\n", "\n");`, 或
2.  匹配回车：`string query = @"^\(.*?\)(,|;)\r$";`

# wpf - WPF 默认窗口样式覆盖

> ID：10013199
> 
> 赞同：0
> 
> 时间：2012-04-04T14:27:26.500
> 
> 标签：wpf, styles

有没有办法在 WPF 应用程序中创建一个样式，它将覆盖所有窗口的 Window 类型的样式？

IE;

```
<Style x:Key="{x:Type Window}"
   TargetType="{x:Type Window}" >
    <Setter Property="Background" Value="Black" />
</Style> 
```

在 App.xaml 或 App.xaml 中引用的资源字典中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T09:10:21.970

简短的回答是：这是不可能的。

解释有很多类似的问题： [WPF Window Style not working at runtime](https://stackoverflow.com/questions/2642220/wpf-window-style-not-working-at-runtime)
[WPF window style not being applied](https://stackoverflow.com/questions/4279773/wpf-window-style-not-being-applied)
[How to set default WPF Window Style in app.xaml?](https://stackoverflow.com/questions/431940/how-to-set-default-wpf-window-style-in-app-xaml)

> Styles 中的 TargetType 不管理派生类型。

您不是在创建 Window 类，而是从它派生的类。如果您创建了 Window 类的实例，它应该应用了样式。

```
Dim frm As New Window
frm.Show() 
```

但是，它不起作用（至少在 4.0 中），我的 Application.xaml 中的样式不会在运行时应用。解决方法是：

在运行时加载资源字典：

```
Dim app As Application = New Application()
Application.Current.Resources.MergedDictionaries.Add(Application.LoadComponent(New Uri("/MyProject;component/MainDictionary.xaml", UriKind.Relative))) 
```

在运行时创建样式

```
Sub Main()
 Dim app As Application = New Application()
 Dim sty As Style
 sty = New Style With {.TargetType = GetType(Window)}
 sty.Setters.Add(New Setter With {.Property = Control.BackgroundProperty, .Value = Brushes.Red})
 Application.Current.Resources.Add(GetType(Window), sty)
 Dim frm As New Window
 frm.ShowDialog()
End Sub 
```

并且窗口具有所需的背景。我认为这是一个错误。

# javascript - 如何将 KML 文件动态加载到谷歌地图并进一步加载到折线？

> ID：10013204
> 
> 赞同：1
> 
> 时间：2012-04-04T14:27:34.873
> 
> 标签：javascript, google-maps, google-maps-api-3, kml, polyline

我找不到答案，如何使用输入文件在地图 KML 文件上动态加载？重要的是，这个操作应该只在客户端完成而不上传到服务器是否可以使用 JavaScript？因此，JavaScript 应该只提取坐标并将它们插入折线，但这是次要的。

我目前的概念：[链接](http://jsfiddle.net/vVLWg/3/)

我发现了一个有趣的例子，但这里有一个复制/粘贴和 api v2：[链接](http://display-kml.appspot.com/)

也许要插入到多段线加载的 kml 中：[链接](http://code.google.com/p/geoxml3/)解析器会很棒吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:00:26.997

您可能想尝试 HTML 5 中的 File API。它现在允许读取本地文件的内容。这是一个[很好的教程](http://www.html5rocks.com/en/tutorials/file/dndfiles/)。不幸的是，有些浏览器不支持它，但这是我所知道的使用 flash 或 java 之外的唯一方法。在 Javascript 中获得 KML 文件内容后，您可以使用您引用的[geoxml3](http://code.google.com/p/geoxml3/)解析器来解析数据并在地图上显示。

# c# - 如何知道 wpf 应用程序是否在终端服务会话中？

> ID：10013205
> 
> 赞同：1
> 
> 时间：2012-04-04T14:27:38.143
> 
> 标签：c#, wpf, wpf-controls

有没有等价于

**wpf中的**SystemInformation.TerminalServerSession ？****

 **我想知道当前的 wpf 应用程序是否正在终端服务器会话中运行。谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T14:48:27.143

您可以使用 SystemParameters 类来查询系统设置，尤其是[SystemParameters.IsRemoteSession](http://msdn.microsoft.com/en-us/library/system.windows.systemparameters.isremotesession.aspx)属性，以获取指示调用进程是否与终端服务客户端会话相关联的值（如 SystemInformation.TerminalServerSession 属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:54:25.437

只需添加对 System.Windows.Forms 的引用由于您没有弄乱 UI，因此您不需要任何特殊的东西。

```
 System.Diagnostics.Debug.WriteLine(System.Windows.Forms.SystemInformation.TerminalServerSession.ToString()); 
```**

# c# - 按对象的属性对 List 中的对象进行排序

> ID：10013207
> 
> 赞同：13
> 
> 时间：2012-04-04T14:27:51.943
> 
> 标签：c#, list, sorting, properties

我在 C# 中有一个对象列表。所有对象都包含属性 code1 和 code2（以及其他属性）。对象列表没有特定的顺序。我需要按它们的 code1 和 code2 属性对对象列表进行排序。

例子：

```
List -> object = id, name, code1, code2, hours, amount. 
```

示例代码 1 = 004
示例代码 2 = 001、002、003、004、016
示例代码 1 = 005
示例代码 2 = 001、002、003、004

因此，在排序之后，我希望按以下顺序排列对象

```
004 001
004 002
004 003
004 005
004 016
005 001
005 002
005 003
005 004 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-04T14:29:10.317

您可以使用 linq 扩展（保留原始列表未排序）：

```
var sorted = theList.OrderBy(o => o.code1).ThenBy(o => o.code2); 
```

要将原始列表替换为排序列表，请稍作修改（效率不是很高，它会创建一个新列表）：

```
theList = theList.OrderBy(o => o.code1).ThenBy(o => o.code2).ToList(); 
```

这假设您的列表是正确的类型，例如：

```
List<MyClass> theList = new List<MyClass>(); 
```

而不是对象列表，在这种情况下，您需要使用`.Cast<>()`or `.OfType<>()`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-04T15:06:48.843

请注意，Adam Houldsworth 对`.ToList()`呼叫的回答不必要地创建了一个新列表。如果您的列表很大，这可能会产生不可接受的内存压力。通过提供自定义比较函数对列表进行排序很可能会更好：

```
theList.Sort((a, b) =>
    {
        var firstCompare = a.code1.CompareTo(b.code1);
        return firstCompare != 0 ? firstCompare : a.code2.CompareTo(b.code2);
    }); 
```

或者，如果此排序是您的类型的内在属性，您可以`IComparable<T>`在您的类型上实现，然后调用

```
theList.Sort(); 
```

...这将使用`IComparable<T>.CompareTo()`实现。

# javascript - 在 JS 模块加载的上下文中，什么是立即执行的工厂函数？

> ID：10013208
> 
> 赞同：1
> 
> 时间：2012-04-04T14:27:57.200
> 
> 标签：javascript, require, js-amd

在 Require.js 文档中，在名为[Why AMD](http://requirejs.org/docs/whyamd.html#today)的部分中，询问了以下内容：

今天的 JavaScript 代码片段是如何定义的？

其他答案如下：

*   **通过立即执行的工厂函数定义。**

我理解（至少我认为我理解）javascript 工厂函数只是一个返回对象新实例的函数，但我不明白这在这个问题的上下文中意味着什么。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:37:28.570

我的猜测是您不清楚javascript“工厂函数”和构造函数之间的区别。[根据 Addy Osmani 的书或本文](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)，我通常会看到短语“[立即调用的函数表达式](http://addyosmani.com/resources/essentialjsdesignpatterns/book/)”或 IIFE ，但我相信 IEFF 是对相同结构的引用。在 IEFF（使用他们的术语）中有这个基本公式：

```
(function () { return {};})(); 
```

它基本上是一种用于创建函数范围的 javascript 模式 (/hack)，因此您可以控制将该范围内的一些但不是全部对象公开给调用者。不要将“工厂函数”与构造函数混淆。您不将`new`关键字与 IIFE 一起使用，而是使用传统的 javascript 构造函数。构造函数是关于创建对象实例的，通常你会创建许多实例，每个实例都有唯一的状态。工厂函数有助于创建干净封装的模块，通常您只需调用它一次并在整个应用程序生命周期中获取对单个模块实例的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T10:14:40.287

[您可以在Why AMD](http://requirejs.org/docs/whyamd.html#today)中查看以下示例代码

```
(function () {
     var $ = this.jQuery;
     this.myExample = function () {};
}()); 
```

这是**立即执行的工厂函数**的示例。所以这个函数会在解释的时候执行。在这个例子之前我们应该考虑加载 JQuery [因为它使用的是 JQuery]。这是[RequireJS](http://requirejs.org)的工作，按照我们的顺序加载所需的 JavaScript 文件。

# c# - 有更好的设计方案吗？

> ID：10013209
> 
> 赞同：6
> 
> 时间：2012-04-04T14:28:03.567
> 
> 标签：c#, oop, design-patterns, maintainability

> ^(**免责声明：**我很想在这个项目上使用[依赖注入](http://martinfowler.com/articles/injection.html)，并且全面采用基于松散耦合接口的设计，但是在这个项目中使用依赖注入已被否决。此外， [SOLID](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)设计原则（以及一般的[设计模式](http://www.oodesign.com/)）在我工作的地方是陌生的，而且我自己对其中的许多人都很陌生。因此，在为这个问题提出更好的设计时要考虑到这一点。)

这是我正在处理的代码的简化版本，因此它可能看起来很做作。如果是这样我道歉。考虑以下类：

```
// Foo is a class that wraps underlying functionality from another 
// assembly to create a simplified API. Think of this as a service layer class,
// a facade-like wrapper. It contains a helper class that is specific to
// foo. Other AbstractFoo implementations have their own helpers.

public class Foo : AbstractFoo
{
    private readonly DefaultHelper helper;
    public override DefaultHelper Helper { get { return helper; } }

    public Foo()
    {
        helper = new Helper("custom stuff");
    }

    public override void Operation1(string value)
    {
        Console.WriteLine("Operation1 using " + value);
    }

    public override void Operation2()
    {
        Console.WriteLine("Operation2");
    }
} 
```

* * *

```
// Helper derives from a default implementation and allows us to
// override it's methods to do things specific for the class that 
// holds this helper. Sometimes we use a custom helper, sometimes
// we use the default one.

public class Helper : DefaultHelper 
{
    private readonly string customStuff;

    public Helper(string value)
    {
        customStuff = value;
    }

    public override void DoSomethingHelpful()
    {
        Console.WriteLine("I was helpful using " + customStuff);
    }
} 
```

假设这两个类的使用如下：

```
 // foo referenced and used in one part of code
    var foo = new Foo();
    foo.Operation2(); // or foo.Operation1();

    // some other point in the program where we don't have a reference to foo
    // but do have a reference to the helper
    helper.DoSomethingHelpful(); 
```

* * *

但是我现在发现我还需要`foo.Operation1`在一些实现中执行`helper.DoSomethingHelpful();`？我想到的潜在解决方法是：

1.  让 foo 和 helper 具有双向关系。所以在 DoSomethingHelpful 我们可以调用 foo.Operation2
2.  让 foo 实现 IHelp 接口并将“帮助”代码移动到 foo
3.  使用委托并将方法 Operation2 作为`Action<string>`委托传递给 Helper 的构造函数。

这些方法似乎都不是理想的（尽管我几乎已经确定我不喜欢*选项 1* ，并且如果我们稍后发现需要传递更多委托，我担心*选项 3的可维护性）。*`Helper`这让我想知道/`Foo`组合的初始设计是否有问题。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:45:23.413

随意（“使用”）关系如何：

```
public class Helper : DefaultHelper 
{
    private readonly string customStuff;

    public Helper(string value)
    {
        customStuff = value;
    }

    public override void DoSomethingHelpful(AbstractFoo foo)
    {
        foo.Operation1();
        Console.WriteLine("I was helpful using " + customStuff);         
    }
} 
```

因此，您修改抽象助手以期望引用正确的`Foo`实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:44:50.533

我想你有你需要的。尽量不要为“以防万一我以后需要它”而设计，不要修复没有损坏的东西。如果将来您需要使用助手中的 Operation1，则将其添加为对构造函数的依赖项（如您所建议的那样），或者将其传递给您正在调用的方法。这将取决于场景，当您真正需要某些东西时，您将拥有它。

**编辑：**更改了“尽量不要为未来设计”，因为这似乎不是我想说的。

**再次编辑由于问题的变化**

你可以这样：

```
helper.DoSomethingUsefulWith( foo ); 
```

因此您的辅助方法将收到它需要的依赖项才能工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:46:01.093

> “这些方法似乎都不是理想的（尽管我已经确定我不喜欢选项 1，并且担心选项 3 的可维护性，如果我们稍后发现我们需要传递更多代表）。这让我想知道如果 Helper/Foo 组合的初始设计有问题。”

你完全正确 - Helper 和 Foo 的设计存在问题。您最初描述的基本 Foo/Helper 关系很好，并且当您必须包装其他不受您控制的对象时，这是一种常见模式。但是你说：

> “如果我发现我还需要在 helper.DoSomethingHelpful(); 的某些实现中执行 foo.Operation1 怎么办？”

这是我们有问题的地方。您开始描述 Foo 依赖于 Helper 的关系；现在您正在描述 Helper 依赖于 Foo 的关系。这立即告诉我你的依赖关系很纠结。对象之间的依赖关系应该只有一种方式；实际上依赖注入依赖于此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T19:03:02.340

我认为您所有的解决方案都很好；它们只是提供不同的功能。这些差异现在无关紧要，但将来可能会如此。

你更喜欢第二个，你的直觉是最好的指导，你比我们其他人更了解你的代码的未来。我最喜欢你的第二个解决方案，因为它摆脱了一个类并且更简单。由于它的简单性，如果您以后必须做其他事情，您将不必丢掉很多工作。

第一种方法让您可以使用不同的 Helper (IHelper?) 实例和子类玩游戏。最后一种方法为 Helper 增加了很大的灵活性。（虽然它可能会增加很多你不需要 Helper 的东西，只是你传递给它的方法。）如果其中任何一个似乎可以解决更多未来未预料到的问题，你可以稍后切换到使用它们。

# c# - C# 从接口转换类型

> ID：10013211
> 
> 赞同：1
> 
> 时间：2012-04-04T14:28:11.820
> 
> 标签：c#, class, interface, casting

我想创建一组非常相似并且可以转换为其他类型的类。我的想法是创建一个接口对象并通过基类实现它。然后创建从我的基础继承的其他类。然后，我可以使用接口来处理通用（基本）方法，并将对象从 BASE 对象转换为自定义类型。

```
interface ImyInterface {

}

public class MyBase : ImyInterface {

}

public class MyCustom1 : MyBase {

}

public class MyCustom2 : MyBase {

}

// in helper class
public static MyBase GetGeneralOjbect() {

    // get a generic base object
    return new MyBase();
}

// How I'm trying to use this

MyCustom1 obj = GetGeneralOjbect() as MyCustom1; 
```

除了对象语句的强制转换之外，这似乎有效。即使静态帮助程序 GetGeneralOjbect 返回一个好的 MyBase 对象，MyCustom1 也始终为空。也许这无法完成，或者我做得不对。任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:29:47.393

这是因为您可以将 a`MyCustom1`或`MyCustom2`to强制转换为`MyBase`，但不一定是其他方式。

当您创建`MyBase`via`MyBase b = new MyBase();`时，`b`是 a`MyBase`但不是 a `MyCustom2`，因此转换`b`为`MyCustom2`将失败。

你*可以*做的是：

```
MyBase b = new MyCustom2();
MyCustom2 c = b as MyCustom2(); 
```

你*不能* 做的是：

```
MyBase b = new MyCustom2();
MyCustom1 c = b as MyCustom1(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:35:06.137

基本上你可以建立一个继承链，但不能向下。假设您具有以下类层次结构：

```
public class A {
}

public class B : A {
}

public class C : B {
} 
```

如果你实例化了一个 B 类型的新实例，你可以将它强制转换为 A 而不是 C。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:38:53.857

“as”关键字表示“如果这个静态类型为 MyBase 的对象的运行时类型为 MyCustom1，则将其返回给我，静态类型为 MyCustom1；否则，给我一个空引用”。您正在转换的对象的运行时类型为 MyBase，而不是 MyCustom1，这就是您获得空引用的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T14:32:48.243

您是否考虑过使用工厂模式？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T14:33:09.023

可以在期望的实例`MyCustom1`时使用实例`MyBase`，但`MyBase`不能在`MyCustom1`期望时使用。

# sharepoint - Sharepoint：获取集合中的站点数量

> ID：10013214
> 
> 赞同：0
> 
> 时间：2012-04-04T14:28:18.883
> 
> 标签：sharepoint, web-crawler, moss

我正在尝试获取在一个非常大的 Sharepoint 集合中创建的子网站的总数。请注意，我没有直接访问服务器的权限。

*   我是否缺少任何可以提供站点计数的本机共享点功能？
*   是否有可以抓取集合的网络服务？（我们有谷歌分析）
*   除了在服务器上运行 powershell 脚本之外，还有其他选择吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:43:40.563

我建议使用“Webs”Web 服务——您可以通过将 /_vti_bin/webs.asmx 放在站点 URL 的末尾来调用它。它有一个方法[GetAllSubWebCollection](http://msdn.microsoft.com/en-us/library/webs.webs.getallsubwebcollection.aspx)。

唯一的问题是您将根据用于访问 Web 服务的用户获得过滤结果。例如，如果您的网站集包含为 HR、业务、管理、销售和 IT 创建的子网站 - 但您的帐户只能访问 HR 和销售网站 - 您将只能获取 HR 和销售网站。

您可能还会发现[SPServices](http://spservices.codeplex.com/) jQuery 库很有帮助，因为它为大多数 Web 服务提供了包装器，并且可以减少从客户端调用它们的痛苦。

*注意：这些 Web 服务适用于 2007 和 2010 版的 SharePoint。您没有提到特定版本，但希望它是这两个版本之一。*

# java - 如何在 Android 中显示一半或四分之一的 ImageView？

> ID：10013215
> 
> 赞同：0
> 
> 时间：2012-04-04T14:28:19.677
> 
> 标签：java, android, android-layout

我有一个 ImageView，我想一次只显示一部分。但从相同的 x,y 坐标开始。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:41:39.000

看看这个

```
Drawable drawable = getResources().getDrawable(R.drawable.image);
Bitmap bitmap = ((BitmapDrawable) drawable ).getBitmap();
bitmap= Bitmap.createBitmap(bitmap , startX, startY, width, height);
imgview.setBackgroundDrawable(new BitmapDrawable(bitmap)); 
```

你也可以调整你的形象

```
Bitmap  resizedImage = Bitmap.createScaledBitmap(bitmap, scrwidth, scrwidth, false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-09T07:26:41.680

使用 x 和 y 调整图片大小

```
top = 0;
bottom = bitmap.getHeight() / 2; //half of picture
Bitmap croppedBitmap = Bitmap.createBitmap(toBeCropped, 0, top, 
toBeCropped.getWidth(), bottom); 
```

第二半可以调整大小

```
top = (bitmap.getHeight() / 2);//starting from here (half)
bottom = (bitmap.getHeight() / 2) ;
Bitmap croppedBitmap = Bitmap.createBitmap(toBeCropped, 0, top, 
toBeCropped.getWidth(), bottom); 
```

希望这会对你有所帮助

# c - 指针之间的比较

> ID：10013216
> 
> 赞同：-2
> 
> 时间：2012-04-04T14:28:19.937
> 
> 标签：c, pointers, data-structures, deque

我正在通过数组在 c 中实现出队。left 和 right 是指向 dequeue 最左边和最右边元素的指针。show() 函数接收左右指针。当我在 void show(int *l,int *r) 中尝试以下操作时，该函数会产生错误的输出-

```
int *t;
for(t=l;t<r;t++);
    {
        printf("%d-->",*t);
    }
        printf("%d\n",*t); 
```

但是当我尝试这个时它可以工作 -

```
for(t=l,i=0;i<r-l;i++,t++)
        printf("%d-->",(*t));
        printf("%d\n",*r); 
```

显然，第一个代码中的指针之间的比较不起作用，即使它们指向同一个数组的成员，为什么会这样？

编辑-这是整个功能

```
void show(int *l,int *r)
{
    if(l==r && r==NULL)
    {
        printf("underflow\n");
    }
    else
    {

        int *t,i;
        for(t=l;t!=r;t++);
        {
                printf("%d-->",*t);
        }
        printf("%d\n",*r);

/*      for(t=l,i=0;i<r-l;i++,t++)
            printf("%d-->",(*t));
        printf("%d\n",*r);*/
    }
} 
```

注释掉的区域在 show() 中不起作用。问题关闭，愚蠢的错误！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T14:47:52.337

```
for(t=l;t!=r;t++); 
```

看到那里的分号了吗？去掉它。照原样，循环递增`t`，直到`r`不做任何事情到达，然后打印指向`t`(now `r`) 的值，然后是“-->”，然后是 指向的值`r`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:36:58.427

已编辑** 您在此处设置一个地址点`for(t=l;t<r;t++);`尝试在 for 循环中取消引用 t 以用作您想要的 int 变量（您对 i 所做的操作）

# c# - C#用户控件崩溃VS11

> ID：10013220
> 
> 赞同：0
> 
> 时间：2012-04-04T14:28:25.323
> 
> 标签：c#, visual-studio, user-controls, crash, controls

我发现自己是第一次编写 C3 代码，并且在很长一段时间内第一次使用 Visual Studio。

我正在创建一个允许选择文件/文件夹等的用户控件，以便将来更容易实现这种控件。但是，每当我将控件拖到任何窗体时，Visual Studio 都会立即崩溃。我曾多次尝试重建整个解决方案。该错误似乎仅在控件中创建公共变量时发生...

有谁知道如何解决这个问题？代码正在进行中.... ;)

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace BackupReport.tools
{
    public partial class pathchooser : UserControl
    {

        #region "Datatypes"
        public enum DLG { Folder, FileSave, FileOpen };
        #endregion

        #region "public properties"
        public DLG Dtype
        {
            get
            {
                return this.Dtype;
            }
            set
            {
                this.Dtype = value;
            }
        }

        public string labelText
        {
            get
            {
                return this.labelText;
            }
            set
            {
                this.labelText = value;
                label1.Text = this.labelText;
            }
        }
        #endregion

        #region "Constructor"
        public pathchooser()
        {
            InitializeComponent();
            this.Dtype = DLG.Folder;
            this.labelText = "Source:";
            label1.Text = this.labelText;
        }
        #endregion

        private void browse_button_Click(object sender, EventArgs e)
        {
            switch (this.Dtype)
            {
                case DLG.Folder:
                    if (fbd.ShowDialog() == DialogResult.OK)
                    {
                        path_textbox.Text = fbd.SelectedPath;
                    }
                    break;

                case DLG.FileSave:
                    break;

                case DLG.FileOpen:
                    break;

                default:
                    break;
            }
        }
    }
} 
```

任何帮助，将不胜感激。我也不确定这是否重要，但我使用的是 VS11 beta。

//马丁

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T14:33:13.533

```
public DLG Dtype
    {
        get
        {
            return this.Dtype;
        }
        set
        {
            this.Dtype = value;
        }
    } 
```

您有一个引用自身的属性，因此在 getter 和 setter 内部（分别）调用它自己的 getter 和 setter。更合适的方法是要么有空的访问器：

```
public DLG DType{get; set;} 
```

或者让访问者引用私有变量：

```
private DLG dtype;
public DLG Dtype
    {
        get
        {
            return this.dtype;
        }
        set
        {
            this.dtype = value;
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T14:33:06.557

我认为您的属性导致 a`StackOverflowException`因为 getter 和 setter 在无限循环中调用自己（Dtype -> Dtype -> Dtype ...）。

试试这个代码：

```
private string labelText;

public DLG Dtype { get; set; }

public string LabelText 
{
  get { return this.labelText; }
  set
  {
    this.labelText = value;
    label1.Text = value;
  }
} 
```

# ios - 激活时不调用iOS handleOpenURL？？？iOS 5.1（这不是 3.2 问题）

> ID：10013228
> 
> 赞同：4
> 
> 时间：2012-04-04T14:28:48.933
> 
> 标签：ios, url, url-scheme

我使用 URL 方案打开我的应用程序并从`-didFinishLaunchingWithOptions:`. 这很好用，但是当应用程序处于活动状态时它不会解析新字符串。我已经实现了`-handleOpenURL:`和 openURL 方法如下，但是当应用程序激活时似乎都没有被调用......

```
-(BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url
{
    if (!url) 
        return NO;

    queryStrings = [self parseQueryString:[url query]];
    return YES;
}

-(BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{
    if (!url) 
        return NO;
    queryStrings = [self parseQueryString:[url query]];
    return YES;
} 
```

请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T15:36:47.877

利用：

`- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation`

您使用的方法已弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T04:42:59.140

澄清上述接受的答案。您可能想要使用它（我对接受的答案感到困惑，因为它只包含您需要的功能，而不是您需要在函数中包含的功能）：

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {

return [FBAppCall handleOpenURL:url sourceApplication:sourceApplication withSession:[PFFacebookUtils session]];

}

- (void)applicationDidBecomeActive:(UIApplication *)application {

    [FBAppCall handleDidBecomeActiveWithSession:[PFFacebookUtils session]];
} 
```

我个人是通过 Ray Wenderlich 教程来解决这个问题的。还有一些很好的使用 Parse 的教程展示了如何将两者结合起来。

可以在这里找到完整的教程：[https ://parse.com/tutorials/integrating-facebook-in-ios](https://parse.com/tutorials/integrating-facebook-in-ios)

希望这有助于减少围绕这个问题的困惑:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:37:16.107

`handleOpenURL`在 iOS 5 上已弃用：您应该`application:openURL:sourceApplication:annotation:`改用 - 您的应用程序中是否也有`application:openURL`方法？如果没有，请添加一个，看看它是否被拾取。

# .net - 如何在 .NET 的参考可执行文件中包含 App.config 信息？

> ID：10013233
> 
> 赞同：7
> 
> 时间：2012-04-04T14:29:05.340
> 
> 标签：.net, app-config

我有一个可执行项目，比方说`A`，它正在运行中启动另一个可执行项目`B`。为了`B.exe`在 A 的当前工作文件夹中有 a，我将 B 添加为 A 的引用，以便在编译`B.exe`后将 a 复制到`A`的文件夹中。但是，我注意到我所做的配置`B`没有在 A 的文件夹中复制或生成（在 A 的文件夹中没有 B.exe.config 文件`A`，只有`B.exe`），因此诸如跟踪之类的东西`B`没有正确配置。

我当然可以`B.exe.config`手动复制到`A`'s 文件夹，但我敢打赌有一些自动的方法可以做到这一点。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-07T19:16:51.383

您可以使用构建后事件，或者...

在项目 A 中，添加对 B.exe.config 的链接引用。您可以通过将现有项目添加到项目中来完成此操作。但是，在按文件对话框上的“添加”按钮之前，请按“添加”按钮右侧的向下箭头并选择“添加为链接”。然后，将文件设置为复制到输出目录。在您的项目文件中，它将如下所示：

来自 ProjectA.csproj：

```
<None Include="..\ProjectB\bin\Debug\B.exe.config">
  <Link>B.exe.config</Link>
  <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</None> 
```

如果您不介意手动编辑项目文件，包含的文件可能取决于构建配置。以下适用于构建（尽管当您双击项目树中的图标时，VS2013 不会打开文件。）

```
<None Include="..\ProjectB\bin\$(Configuration)\B.exe.config">
  <Link>B.exe.config</Link>
  <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</None> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-23T21:13:29.903

一个更简单的解决方案是在 csproj 文件中简单地包含以下内容。这包括引用文件的匹配文件扩展名。

```
 <PropertyGroup>
    <AllowedReferenceRelatedFileExtensions>
      .pdb;
      .xml;
      .exe.config;
      .dll.config
    </AllowedReferenceRelatedFileExtensions>
  </PropertyGroup> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-04T14:34:44.083

您的应用程序目录中不能有 2 个 app.config。
默认情况下，Visual Studio 将使用启动项目的 app.config。
您可以在复制 app.config 的位置创建一个构建后事件触发器，但这将替换原始的 app.config（我猜它包含您需要的数据）。

最好的方法（除了创建一个干净的 dll + 项目架构）是手动将项目 A 的所有配置数据合并到项目 B 的配置数据中。

# php - php -results 应该出现在同一页面中

> ID：10013234
> 
> 赞同：0
> 
> 时间：2012-04-04T14:29:07.243
> 
> 标签：php, javascript

我写了一个登录表单，在这个我使用过的表单和方法是 post 而 action 是（PHP self）`<?php $_PHP_SELF ?>`（我在表单本身中使用 php）。在 php 中，我写了如果登录成功则“欢迎”，如果登录失败则“抱歉”。

但这些结果将出现在新的页面中。当我单击提交按钮时，我想在同一页面中获得这些结果。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:40:53.590

PHP是一种服务器端语言，所以在提交登录数据后，服务器会生成一个新页面，如果你想在`welcome || sorry`不刷新页面的情况下返回消息，则需要使用ajax。我猜你对这一切都很陌生，所以在 ajax 上搜索一些 javascript Tuts，或者如果你需要快速启动并运行它，可以使用 JavaScript 库。最简单的恕我直言是 jQuery，因为它是其中记录最多的

# git - 在 git 中创建一个分支，但担心会损害现有的稳定 master

> ID：10013240
> 
> 赞同：1
> 
> 时间：2012-04-04T14:29:24.967
> 
> 标签：git, git-branch

我的硬盘上有一个珍贵的安装：

/var/www/lukevan/po2/po

这是“PO”项目。我们希望为我们的客户维护那个版本，但是现在我们需要做一个新的、实验性的分支，它可能会在一段时间内不稳定，直到我们准备好将它合并回实时的、当前的、稳定的 PO 项目中。我已经查看了[这个文档](http://book.git-scm.com/3_basic_branching_and_merging.html)，但让我感到困惑的是我是否应该在我珍贵的 /var/www/lukevan/po2/po 文件夹中运行它，或者我是否应该做其他事情以免伤害我珍贵的 /var/www /lukevan/po2/po 文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:31:21.510

在您的情况下，您应该将您的 repo 克隆到安全的地方并在克隆上工作。

这样你的工作就不会影响原始仓库的工作目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:31:32.723

版本控制系统的好处之一是能够恢复您的更改。不要太担心自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:33:21.750

克隆您的“珍贵”文件夹，然后在克隆中创建分支。如果出现严重错误，您可以开始使用原始存储库。

实际上，这就是使用版本控制系统的全部意义所在，但有时有点偏执也无妨。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T14:39:28.383

Git 不是善变的。绝对没有必要重新克隆这个存储库。这就是分支的用途，即让您可以创建一个接缝，您可以在其中独立工作，而无需担心对其他分支进行更改。只需创建您的新分支并开始修改和提交即可。

```
git checkout -b experimental
// hack hack hack
git add foo
git commit -m 'changed foo' 
```

现在 /var/www/lukevan/po2/po 中的文件在实验分支上发生了变化，他们没有改变主分支上的文件。当您切换回 master 时，将根据文件在 master 分支上的外观签出文件。

克隆是一项昂贵的操作。创建一个分支只有 41 字节的文件开销，而且速度超快且重量轻。当涉及到分支时，Git 规则。用它 ！:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T05:24:02.263

这就是我所做的，虽然我不知道这是否是处理这个问题的最佳方式：

在我的开发工作站上，它有一个 Web 服务器：

```
cd /var/www/lukevan
mkdir pof2
cd pof2
git clone user@domain.com:po.git
ls
# a po folder was listed -- that's the MASTER of our project, called "po".
git branch pof2
git checkout pof2 
```

我现在可以在 /var/www/lukevan/po2/po 上工作以在必要时在稳定的 master 分支上工作，然后在 /var/www/lukevan/pof2/po 上工作以在必要时在不稳定的实验性分支上工作. 我可以运行“git pull origin master”或“git pull origin pof2”来下载最新的文件，破解，然后运行 ​​git add .，然后运行 ​​git commit -m “what I'm committing”，然后运行 ​​git push原点主控和 git push origin pof2 for pof2。

# mysql - MySQL 什么时候开始支持 XML 函数的？

> ID：10013242
> 
> 赞同：0
> 
> 时间：2012-04-04T14:29:39.557
> 
> 标签：mysql, xml, database, function

[支持ExtractValue()](http://dev.mysql.com/doc/refman/5.6/en/xml-functions.html)和[UpdateXML()](http://dev.mysql.com/doc/refman/5.6/en/xml-functions.html)等 MySQL XML 函数多久了？

*一个粗略的版本号就可以了。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:31:32.233

5.1.5。

[MySql 5.1 文档第 11.11 节 XML 函数](http://dev.mysql.com/doc/refman/5.1/en/xml-functions.html)

> 从 MySQL 5.1.5 开始，提供了两个提供基本 XPath 1.0（XML 路径语言，1.0 版）功能的函数。本节后面提供了一些关于 XPath 语法和用法的基本信息；但是，深入讨论...

# c# - 线程量 #9000

> ID：10013244
> 
> 赞同：1
> 
> 时间：2012-04-04T14:29:53.470
> 
> 标签：c#, multithreading

好的，所以，我刚开始搞线程，现在需要一些时间来理解这些概念，所以我写了一个非常简单的测试，看看如果打印出 20000 行会更快（和我认为它会更快，因为我有一个四核处理器？）

所以首先我写了这个，（这就是我通常会做的事情）：

```
System.DateTime startdate = DateTime.Now;
    for (int i = 0; i < 10000; ++i)
    {
        Console.WriteLine("Producing " + i);
        Console.WriteLine("\t\t\t\tConsuming " + i);
    }

    System.DateTime endtime = DateTime.Now;
    Console.WriteLine(a.startdate.Second + ":" + a.startdate.Millisecond + " to " + endtime.Second + ":" + endtime.Millisecond); 
```

然后使用线程：

```
public class Test
{
static ProducerConsumer queue;
public System.DateTime startdate = DateTime.Now;
static void Main()
{
    queue = new ProducerConsumer();
    new Thread(new ThreadStart(ConsumerJob)).Start();

    for (int i = 0; i < 10000; i++)
    {
        Console.WriteLine("Producing {0}", i);
        queue.Produce(i);

    }
    Test a = new Test();
}

static void ConsumerJob()
{
    Test a = new Test();
    for (int i = 0; i < 10000; i++)
    {
        object o = queue.Consume();
        Console.WriteLine("\t\t\t\tConsuming {0}", o);

    }
    System.DateTime endtime = DateTime.Now;

    Console.WriteLine(a.startdate.Second + ":" + a.startdate.Millisecond + " to " + endtime.Second + ":" + endtime.Millisecond);
}
}

public class ProducerConsumer
{
readonly object listLock = new object();
Queue queue = new Queue();

public void Produce(object o)
{
    lock (listLock)
    {
        queue.Enqueue(o);        
        Monitor.Pulse(listLock);
    }
}

public object Consume()
{
    lock (listLock)
    {
        while (queue.Count == 0)
        {
            Monitor.Wait(listLock);
        }
        return queue.Dequeue();
    }
}

} 
```

现在，出于某种原因，我认为这会更快，但是在测试了 15 次之后，结果的中位数是......几毫秒不同，有利于非线程

然后我想嘿......也许我应该在一百万个 Console.WriteLine 上试试，但结果是相似的

难道我做错了什么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T14:43:10.917

写入控制台是内部同步的。它不是平行的。它还会导致跨进程通信。

简而言之：这是我能想到的最糟糕的基准；-)

尝试对一些真实的东西进行基准测试，你实际上想要加速的东西。它需要受 CPU 限制而不是内部同步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T14:36:10.377

据我所知，您只有一个线程服务于队列，那为什么会更快呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T14:45:29.877

我有一个例子说明为什么您对通过多线程实现大幅加速的期望是错误的：

假设您要上传 100 张图片。单线程变体加载第一个，上传，加载第二个，上传等等。

这里的限制部分是您的 Internet 连接的带宽（假设每次上传都会用完您拥有的所有上传带宽）。

如果您创建 100 个线程来仅上传 1 张图片会怎样？好吧，每个线程都读取它的图片（这是加快速度的部分，因为读取图片是并行完成的，而不是一个接一个）。

由于当前活动线程使用 100% 的互联网上传带宽来上传其图片，因此其他线程在不活动时无法上传单个字节。作为需要传输的字节数，100个线程每个需要上传一张图片的时间与一个线程需要依次上传100张图片的时间相同。

如果上传图片被限制为可用带宽的 50%，您只会获得加速。然后，100 个线程将在 50% 的时间内完成，一个线程需要上传 100 张图片。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T14:35:15.480

“出于某种原因，我认为这会更快”

如果你不知道为什么你认为它会更快，为什么你会惊讶它不是？永远不能保证简单地启动新线程会使任何操作运行得更快。新线程可以减少原始算法中的一些低效率（这足以克服创建线程的额外开销）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-04T15:24:00.977

别人给的建议都是好建议，尤其是提到控制台是序列化的，以及添加线程并不能保证加速的事实。

我想指出并且其他人似乎错过的是，在您的原始场景中，您在主线程中打印所有内容，而在第二种场景中，您**只是将整个打印任务委托给辅助工作者**。这不会比您的原始方案更快，因为**您只是将一名工人换成另一名工人**。

您可能会看到加速的一种情况是：

```
for(int i = 0; i < largeNumber; i++)
{
    // embarrassingly parallel task that takes some time to process
} 
```

然后将其替换为：

```
int i = 0;
Parallel.For(i, largeNumber,
    o =>
    {
       // embarrassingly parallel task that takes some time to process
    }); 
```

这将在工作人员之间拆分循环，以便每个工作人员处理较小的原始数据块。如果任务不需要同步，您应该会看到预期的加速。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-04T15:30:46.870

您有多个来源，但只有 1 个输出。在这种情况下，多线程不会加快速度。这就像有一条道路，其中 4 条车道合并为 1 条车道。拥有 4 条车道会使交通更快，但最终当它合并到 1 条车道时会减慢速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-04T14:56:28.707

酷测试。

处理线程时要记住的一件事是*瓶颈*。考虑一下：

> 你有一家餐厅。你的厨房可以每 10 分钟下一个新订单（你的厨师有膀胱问题，所以他总是在浴室里，但他是你女朋友的表弟），所以他每小时生产 6 个订单。
> 
> 您目前只雇用一名服务员，可以立即上桌（他可能在 E 上，但只要服务好，您就不会在意）。
> 
> 在营业的第一周，一切都很好：你每十分钟就有一次客户。顾客仍然要等十分钟才能用餐，但这没关系。
> 
> 然而，在那一周之后，你每十分钟就有多达 2 位顾客，他们必须等待多达 20 分钟才能得到他们的饭菜。他们开始抱怨和制造噪音。上帝，你有噪音。所以你会怎么做？
> 
> 服务员很便宜，所以你再雇两个。等待时间会改变吗？一点也不...服务员会更快地得到订单，当然（同时接待两个顾客），但仍有一些顾客等待 20 分钟让厨师完成他们的订单。你需要另一个厨师，但当你搜索时，你会发现他们缺乏！他们每个人都在电视上做一些疯狂的真人秀（除了你女朋友的表弟，你发现他实际上是一名前毒贩）。

在您的情况下，服务员是调用 Console.WriteLine 的线程；但是您的厨师就是控制台本身。它每秒只能处理这么多的呼叫。添加一些线程可能会使事情变得更快，但收益应该很小。

# c++ - 如何在 C++ 中使用嵌入的 NULL 字符构造 BSTR？

> ID：10013245
> 
> 赞同：2
> 
> 时间：2012-04-04T14:29:56.297
> 
> 标签：c++, winapi, null, bstr

如何使用嵌入的 NULL 字符构造 BSTR？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T14:33:41.657

使用[`SysAllocStringLen()`](http://msdn.microsoft.com/en-us/library/ms891287.aspx)传递 null 作为第一个参数来分配缓冲区，然后以您喜欢的任何方式填充主体。像这样的东西：

```
BSTR bstr = SysAllocStringLength( 0, desiredLength );
if( bstr == 0 ) {
   //handle error, get out of here
}
for( int i = 0; i < desiredLength; i++ ) {
    if( i % 3 == 0 ) {
       bstr[i] = 0;
    } else {
       bstr[i] = 'A';
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-20T11:54:10.947

短代码片段

```
BSTR HasNul = ::SysAllocStringLen(L"Who needs\0 embedded like that?", 30);
std::wcout << L"Last character: " << HasNul[29] << "  " << HasNul << L"\n"; 
```

的`BSTR`长度为 30，所以最后一个字符是`HasNul[29]`，在我的示例中是问号。输出是

```
Last character: ?  Who needs 
```

因为纯 C++ 方法`std::wcout`在第一个 NUL 字符处停止。作为初学者，你真的需要吗？

# android - Android - 从 byte[] 数组播放 mp3

> ID：10013246
> 
> 赞同：5
> 
> 时间：2012-04-04T14:29:56.213
> 
> 标签：android, file, mp3, bytearray

我有 byte[] 数组，其中包含 mp3 文件。有什么方法可以在不创建临时文件的情况下播放 mp3 文件？

谢谢

**编辑：**

我尝试过临时文件方法：

```
 File tempMp3 = File.createTempFile("test", ".mp3", getCacheDir());

                //tempMp3.deleteOnExit();
                FileOutputStream fos = new FileOutputStream(tempMp3);
                fos.write(bytes);
                fos.close();

                mediaPlayer = MediaPlayer.create(getApplicationContext(),Uri.fromFile(tempMp3));
                mediaPlayer.start(); 
```

而且我仍然收到 NullPointerException。我正在将字节数组（称为字节）写入文件，我保留它的引用并使用它。但仍然得到NPE。你知道错在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:39:41.920

我假设您正在使用[`MediaPlayer`](http://developer.android.com/reference/android/media/MediaPlayer.html)，并且在最新的 API 之前，无法将数据设置为（路径）`byte[]`格式，或者我担心您将不得不编写一个临时的.`String``FileDescriptor``Uri``File`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:45:02.263

Android 提供了一个非常低级的 API ( [AudioTrack](http://developer.android.com/reference/android/media/AudioTrack.html) ) 来将原始 PCM 数据直接写入声音硬件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-13T14:21:40.867

```
private void playByteArray(byte[] mp3SoundByteArray) {
    try {
        File Mytemp = File.createTempFile("TCL", "mp3", getCacheDir());
        Mytemp.deleteOnExit();
        FileOutputStream fos = new FileOutputStream(Mytemp);
        fos.write(mp3SoundByteArray);
        fos.close();

        MediaPlayer mediaPlayer = new MediaPlayer();

        FileInputStream MyFile = new FileInputStream(Mytemp);
        mediaPlayer.setDataSource(Mytemp.getFD());

        mediaPlayer.prepare();
        mediaPlayer.start();
    } catch (IOException ex) {
        String s = ex.toString();
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:45:33.077

使用 tmpFile，请遵循该帖子：[Android - Playing mp3 from byte[]](https://stackoverflow.com/questions/1972027/android-playing-mp3-from-byte)

如果它仍然是 npe，请检查您的文件 (tempMp3) 是否不为空，以及 Uri.fromFile 是否返回 uri 而不是空。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-11T13:11:03.107

我知道这很旧，但是我搜索了一个答案，但没有找到任何真正允许从没有临时文件的字节数组中播放的答案，而且确实有一种非常简单的方法，可以创建自定义 MediaDataSource。

我在这里发布了 Xamarin Android 的代码，但它很容易移植到 Java，问题是你可以看到实现它的方法。

请注意，这些方法是在 android 6.0 SDK 中添加的，如果您面向较低版本的 Android，则必须使用正确的兼容性支持库。

```
public class AudioPlayer
{
    MediaPlayer currentPlayer;

    public void Play(byte[] AudioFile, bool Loop)
    {
        Stop();

        currentPlayer = new MediaPlayer();
        currentPlayer.Prepared += (sender, e) =>
        {
            currentPlayer.Start();
        };
        currentPlayer.Looping = Loop;
        currentPlayer.SetDataSource(new StreamMediaDataSource(new System.IO.MemoryStream(AudioFile)));
        currentPlayer.Prepare();
    }

    public void Stop()
    {
        if (currentPlayer == null)
            return;

        currentPlayer.Stop();
        currentPlayer.Dispose();
        currentPlayer = null;
    }
}

public class StreamMediaDataSource : MediaDataSource
{
    System.IO.Stream data;

    public StreamMediaDataSource(System.IO.Stream Data)
    {
        data = Data;
    }

    public override long Size
    {
        get
        {
            return data.Length;
        }
    }

    public override int ReadAt(long position, byte[] buffer, int offset, int size)
    {
        data.Seek(position, System.IO.SeekOrigin.Begin);                
        return data.Read(buffer, offset, size);
    }

    public override void Close()
    {
        if (data != null)
        {
            data.Dispose();
            data = null;
        }
    }

    protected override void Dispose(bool disposing)
    {
        base.Dispose(disposing);

        if (data != null)
        {
            data.Dispose();
            data = null;
        }
    }
} 
```

# java - 肥皂：从http到https的地址位置

> ID：10013250
> 
> 赞同：2
> 
> 时间：2012-04-04T14:30:10.383
> 
> 标签：java, web-services, soap, axis2

我有一些网络服务，例如：

```
<wsdl:port name="CalcWithPerson22HttpSoap11Endpoint" binding="ns:CalcWithPerson22Soap11Binding">  
            <soap:address location="http://localhost:8080/axis2/services/CalcWithPerson22"/>  
  </wsdl:port> 
```

在这些中，我需要将 `soap:address location`“http”更改为“https”。

我需要在 WSDL 文件的哪个位置进行更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T09:32:39.740

1.5.3 维护版本已经支持 https。所以我们也可以使用它

2010 年 11 月 12 日 - Apache Axis2/Java 版本 1.5.3 发布！1.5.3 是一个维护版本，包含以下改进：

*   改进了使用 servlet 传输时对 SSL 的支持：现在可以配置 Axis2，以便生成的 WSDL 包含 https 端点 (AXIS2-4465)。
*   改进了与 Rampart（AXIS2-3213 和 AXIS2-4870）和 Sandesha2（潜在的 HTTP 连接池不足）的兼容性。
*   Axiom 已升级到 1.2.10。此版本包含与 Rampart 相关的性能改进。
*   应用程序（业务）故障不再记录在 ERROR 级别 (AXIS2-4280)。
*   提高了对 SAAJ 规范的一致性。1.5.3 版本包含一组针对在主干上开发的 SAAJ 实现的修复和改进，但未包含在 1.5 分支的先前版本中。
*   Axis2 现在完全依赖于 Maven 中央存储库中可用的依赖项，不需要其他 Maven 存储库。这特别修复了 1.5.2 版本之后出现的构建问题。
*   Eclipse 和 IntelliJ IDEA 插件再次可以通过 Axis2 网站下载（以前的 1.5.x 版本只能从 Maven 存储库下载）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T20:01:09.347

1) 首先，您必须确保部署这些服务的应用程序服务器需要在 SSL/https 上运行。

2）无需更改wsdl。只需将客户端中的端点从您打算调用这些服务的位置更改为 https。

但是，您仍然需要更改 wsdl 中的肥皂地址。只需进行此更改：

```
<soap:address location="https://localhost:8080/axis2/services/CalcWithPerson22"/> 
```

**更新：**

**axis2.xml**检查*https transportReceiver*。它在 1.5.3 以上的axis2 版本中默认启用。

```
<transportReceiver name="https"
class="org.apache.axis2.transport.http.SimpleHTTPServer">
<parameter name="port">8443</parameter>
</transportReceiver> 
```

**service.xml**如果你只想在 https 上运行你的服务，它看起来像这样

```
<service name="TestWebservice" >
    <description>
        Please Type your service description here
    </description>
    <messageReceivers>
        <messageReceiver mep="http://www.w3.org/2004/08/wsdl/in-only"
class="org.apache.axis2.rpc.receivers.RPCInOnlyMessageReceiver" />
        <messageReceiver  mep="http://www.w3.org/2004/08/wsdl/in-out" 
class="org.apache.axis2.rpc.receivers.RPCMessageReceiver"/>
    </messageReceivers>
    <transports> 
        <transport>https</transport> 
    </transports>
    <parameter name="ServiceClass">xx.xxx.xxx.TestWebservice</parameter>
</service> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-19T15:18:49.137

在 xml 文件中添加“https”

```
<transportReceiver name="https" class="org.apache.axis2.transport.http.SimpleHTTPServer"> <parameter name="port">8443</parameter> </transportReceiver> 
```

# html - 图像映射 - Firefox 问题

> ID：10013255
> 
> 赞同：2
> 
> 时间：2012-04-04T14:30:35.187
> 
> 标签：html, firefox, imagemap, gecko

为什么这张地图在 Firefox 中不起作用？

```
<img usemap="m_one" id="one" src="/images/layout/town_and_country/Town__Country_Web_Map.jpg" alt="Town__Country_Web_Map" border="0" height="507" width="720"> 
<map id="m_one" name="m_one">
<area href="/local-area/in-the-community" coords="374,278,375,267,378,257,390,240,407,228,417,225,428,224,438,225,448,228,465,240,477,257,480,267,481,278,480,288,477,298,465,315,448,327,438,330,428,331,417,330,407,327,390,315,378,298,375,288,374,278,374,278" shape="poly">
<area href="/local-area/woodside-village-profile" coords="589,63,590,56,592,50,599,40,609,33,616,31,623,30,629,31,636,33,646,40,653,50,655,56,656,63,655,70,653,76,646,86,636,93,629,95,623,96,616,95,609,93,599,86,592,76,590,70,589,63,589,63" shape="poly">
<area href="/flamstead-village-profile" coords="571,392, 41" shape="circle">
<area href="/slip-end-village-profile" coords="575,118, 41" shape="circle">
<area href="/caddington-village-profile" coords="450,55, 41" shape="circle">
<area href="/aly-green-village-profile" coords="383,118, 41" shape="circle">
<area href="/Kensworth-village-profile" coords="235,144, 41" shape="circle">
<area href="/studham-village-profile" coords="53,147, 41" shape="circle">
<area href="/studham-village-profile" coords="145,304, 41" shape="circle"> 
</map> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T08:12:07.273

尝试在“usemap”中添加 #

```
<img usemap="#m_one" id="one" src="/images/layout/town_and_country/Town__Country_Web_Map.jpg" alt="Town__Country_Web_Map" border="0" height="507" width="720"> 
```

# c# - Jquery Autocomplete + ASP.NET MVC 3 不显示结果

> ID：10013261
> 
> 赞同：0
> 
> 时间：2012-04-04T14:30:47.210
> 
> 标签：c#, jquery, asp.net-mvc-3

我的查看代码：

脚本和CSS：

```
<link href="@Url.Content("~/Content/jquery-ui-1.8.18.custom.css")" rel="stylesheet"type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.18.custom.min.js")" type="text/javascript"></script> 
```

输入文本：

```
@Html.TextBoxFor(model => model.Filter.HouseName, new { style = "width: 205px", onKeyUp = "updateHouseNames()" }) 
```

Javascript：

```
function updateHouseNames() {
    var houseArray = new Array();

    $.post('@Url.Action("LoadHouses")', { houseName: $("#Filter_HouseName").val() }, function(houses) {
        houseArray = houses;
    });

    $("#Filter_HouseName").autocomplete({
        source: houseArray 
    });
} 
```

控制器方法：

```
[HttpPost]
public JsonResult LoadHouses(string houseName)
{
    var houses = this.HouseService.SelectByName(houseName).Select(e => new String(e.Name.ToCharArray())).ToArray();

    return Json(houses);
} 
```

我调试了javascript并选择了房屋..但结果未显示在自动完成中。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:26:29.840

我真的不认为你应该这样做。如果您需要自定义逻辑，请在`autocomplete`方法上使用回调：

```
$(function () {
    $('#Filter_HouseName').autocomplete({
        minLength: 1,
        source: function (request, response) {
            var term = request.term;
            var houseArray = new Array();

            $.post('@Url.Action("LoadHouses")', { houseName: term }, function(houses) {
                houseArray = houses;
                response(houseArray);
            });                
        }
    });
}); 
```

# .net - 如何指示 Ninject 从其隐式绑定列表中隐藏类型

> ID：10013262
> 
> 赞同：2
> 
> 时间：2012-04-04T14:30:54.967
> 
> 标签：.net, dependency-injection, ninject, ioc-container, ninject.web.mvc

Ninject 是否具有我可以用来装饰类或构造函数以让 Ninject 忽略它的属性？

我需要摆脱：

> 检测到两个服务的构造函数之间存在周期性依赖关系。

这是我的代码：

```
// Abstraction
public interface ICommandHandler<TCommand>
{
    void Handle(TCommand command);
}

// Implementation
public class ShipOrderCommandHandler 
    : ICommandHandler<ShipOrderCommand>
{
    private readonly IRepository<Order> repository;

    public ShipOrderCommandHandler(
        IRepository<Order> repository)
    {
        this.repository = repository;
    }

    public void Handle(ShipOrderCommand command)
    {
        // do some useful stuf with the command and repository.
    }
} 
```

我的通用装饰器：

```
public TransactionalCommandHandlerDecorator<TCommand>
    : ICommandHandler<TCommand>
{
    private ICommandHandler<TCommand> decoratedHandler;

    public TransactionalCommandHandlerDecorator(
        ICommandHandler<TCommand> decoratedHandler)
    {
        this.decoratedHandler = decoratedHandler;
    }

    public void Handle(TCommand command)
    {
        using (var scope = new TransactionScope())
        {
            this.decoratedHandler.Handle(command);
            scope.Complete();
        }
    }
} 
```

我的容器注册：

```
kernel.Bind(typeof(ICommandHandler<>))
    .To(typeof(TransactionCommandHandlerDecora‌​tor<>)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T14:12:48.873

这是一个基于您的代码的工作示例。

```
public class AutoDecorationFacts
{
    readonly StandardKernel _kernel = new StandardKernel();

    public AutoDecorationFacts()
    {
        _kernel.Bind( typeof( ICommandHandler<> ) )
            .To( typeof( TransactionalCommandHandlerDecorator<> ) )
            .Named( "decorated" );
    }

    [Fact]
    public void RawBind()
    {
        _kernel.Bind( typeof( ICommandHandler<> ) ).To<ShipOrderCommandHandler>().WhenAnyAnchestorNamed( "decorated" );
        VerifyBoundRight();
    }

    void VerifyBoundRight()
    {
        var cmd = _kernel.Get<ICommandHandler<ShipOrderCommand>>();
        Assert.IsType<TransactionalCommandHandlerDecorator<ShipOrderCommand>>( cmd );
    } 
```

最好用于`Ninject.Extensions.Conventions`：-

```
 [Fact]
    public void NameSpaceBasedConvention()
    {
        _kernel.Bind( scan => scan
            .FromThisAssembly()
            .SelectAllClasses()
            .InNamespaceOf<CommandHandlers.ShipOrderCommandHandler>()
            .BindAllInterfaces()
            .Configure( x => x.WhenAnyAnchestorNamed( "decorated" ) ) );
        VerifyBoundRight();
    }

    [Fact]
    public void UnconstrainedWorksTooButDontDoThat()
    {
        _kernel.Bind( scan => scan
            .FromThisAssembly()
            .SelectAllClasses()
            .BindAllInterfaces(  )
            .Configure( x=>x.WhenAnyAnchestorNamed("decorated" )));
        VerifyBoundRight();
    }
} 
```

你的课：

公共类 ShipOrderCommand { }

```
// Abstraction
public interface ICommandHandler<TCommand>
{
    void Handle( TCommand command );
}

// Implementation
namespace CommandHandlers
{
    public class ShipOrderCommandHandler
        : ICommandHandler<ShipOrderCommand>
    {
        public ShipOrderCommandHandler(
            )
        {
        }

        public void Handle( ShipOrderCommand command )
        {
            // do some useful stuf with the command and repository.
        }
    }
}
public class TransactionalCommandHandlerDecorator<TCommand>
    : ICommandHandler<TCommand>
{
    private ICommandHandler<TCommand> decoratedHandler;

    public TransactionalCommandHandlerDecorator(
        ICommandHandler<TCommand> decoratedHandler )
    {
        this.decoratedHandler = decoratedHandler;
    }

    public void Handle( TCommand command )
    {
        this.decoratedHandler.Handle( command );
    }
} 
```

（使用 Ninject 和 Ninject.Extensions.Conventions 的 NuGet 最新版本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T19:50:39.993

您应该能够对带有约束的原始接口使用[上下文绑定](https://github.com/ninject/ninject/wiki/Contextual-Binding)，`Bind`以使它们仅在正确的上下文中被考虑（即，当它们进入装饰器时）。

我有一个非常相似的`When`扩展，如果你还在看的话，我明天可以贴在这里。

编辑：我想到的代码（结果它并不想要你直接想要）

```
public static class NinjectWhenExtensions
{
    public static void WhenRootRequestIsFor<T>( this IBindingSyntax that )
    {
        that.BindingConfiguration.Condition = request => request.RootRequestIsFor<T>();
    }
}

public static class NinjectRequestExtensions
{
    public static bool RootRequestIsFor<T>( this IRequest request )
    {
#if false
        // Need to use ContextPreservingGet in factories and nested requests for this to work.
        // http://www.planetgeek.ch/2010/12/08/ninject-extension-contextpreservation-explained/
        return RootRequest( request ).Service == typeof( T );   
#else
        // Hack - check the template arg is the interface wer'e looking for rather than doing what the name of the method would actually suggest
        IRequest rootRequest = RootRequest( request );
        return rootRequest.Service.IsGenericType && rootRequest.Service.GetGenericArguments().Single() == typeof( T );
#endif
    }

    static IRequest RootRequest( IRequest request )
    {
        if ( request.ParentRequest == null )
            return request;

        return RootRequest( request.ParentRequest );
    }
} 
```

用于附加装饰器：-

```
root.Bind<IEndpointSettings>().To<IAnonymousEndpointSettings>().WhenRootRequestIsFor<IAnonymousService>();
root.Bind<IEndpointSettings>().To<IAuthenticatedSettings>().WhenRootRequestIsFor<IServiceA>(); 
```

编辑 2：您应该能够使用创建一个`When`衍生物，它将 IX 的一般绑定排除在图片之外，除非它`Resolve`被输入到装饰器中。然后`Bind`，您的装饰器可以使用上下文保留（@Remo 有一篇文章）来确保进入上下文以便您的谓词可以决定，或者您可以将元数据添加到请求并让何时依赖它。

所以，我会： 1\. 阅读 Context Preservation 2\. 检查/转储符合您`When`条件的请求的上下文内容，并确定如何适当过滤。

（并希望有人能提供一个罐装的单班轮答案！）

上下文保留扩展可能会发挥作用。

# java - JSAPI 文档：它去哪儿了？

> ID：10013265
> 
> 赞同：0
> 
> 时间：2012-04-04T14:31:06.120
> 
> 标签：java, web, documentation, speech-recognition

我正在尝试访问 java.sun.com，以便在这里阅读他们关于语音识别的文档：http: [//java.sun.com/products/java-media/speech/forDevelopers/jsapi-guide/](http://java.sun.com/products/java-media/speech/forDevelopers/jsapi-guide/)

不幸的是，我无法访问此页面或 java.sun.com 下的任何其他页面...

只是我的电脑有这个问题吗？还是他们的网站宕机了？

是否有人可以共享此文档的副本？或者关于网站何时恢复在线的想法？

我已经在网上寻找有关这些的答案，但我找不到任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:50:27.800

希望您知道这`Sun`是由`Oracle`. 您仍然可以在[此处访问](http://webcache.googleusercontent.com/search?sourceid=chrome&ie=UTF-8&q=cache%3Ahttp%3A%2F%2Fjava.sun.com%2Fproducts%2Fjava-media%2Fspeech%2FforDevelopers%2Fjsapi-guide%2F)此页面的缓存版本。sun.com 的很多链接都被破坏了。

要获取缓存的页面版本，`Google`您可以`cache:<YOUR_URL_HERE>`在地址栏中输入（假设您正在使用`Google Chrome`）或将 URL 复制粘贴到 google 搜索框中，然后从搜索结果导航到缓存的版本。

**编辑**
好吧，4小时前我很懒；）我做了一些研究，这就是我发现的：

*   [官方 Oracle 常见问题解答](http://www.oracle.com/technetwork/java/jsapifaq-135248.html)
*   [JSR-113 JavaTM 语音 API 规范](http://www.jcp.org/en/jsr/detail?id=113)
*   由于 Java Speech API 只是一个规范，您可以从具体实现中找到更多信息。例如，请参阅[FreeTTS 程序员指南](http://freetts.sourceforge.net/docs/ProgrammerGuide.html)（有关实现的完整列表，请参阅上面提到的常见问题解答）。
*   在我输入此编辑时，我可以肯定地告诉您，您在原始帖子中提到的链接可用几分钟 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T20:02:42.590

甲骨文将这项技术[藏在这里](http://www.oracle.com/technetwork/java/index-138153.html)。这里还有[一个关于它的常见问题解答](http://www.oracle.com/technetwork/java/jsapifaq-135248.html)。

由于这只是一个规范，因此您需要获取一个实现。根据 (Sun) Oracle 的说法，[这些是值得注意的实现，](http://www.oracle.com/technetwork/java/jsapifaq-135248.html#implementation)可能在迁移之前。谁知道这些天实际上维护了哪些实现，因为 JSAPI 似乎没有包含在 1.7 中（也许它会进入 1.8？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-20T22:04:40.513

在这里我找到了文档：

[http://docs.oracle.com/cd/E17802_01/products/products/java-media/speech/forDevelopers/jsapi-doc/javax/speech/recognition/package-summary.html](http://docs.oracle.com/cd/E17802_01/products/products/java-media/speech/forDevelopers/jsapi-doc/javax/speech/recognition/package-summary.html)

# performance - 缓冲区使用示例

> ID：10013267
> 
> 赞同：0
> 
> 时间：2012-04-04T14:31:11.757
> 
> 标签：performance, video, stream, connection, buffer

如果视频流所需的 Internet 连接速度较慢，那么缓冲区的实际工作方式如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:39:17.160

缓冲区旨在处理连接速度的突然但短暂的下降。如果平均速度太低，缓冲不能防止流数据的丢失。

# android - android：如何制作页面导航栏

> ID：10013272
> 
> 赞同：0
> 
> 时间：2012-04-04T14:31:32.847
> 
> 标签：android, button

我正在制作一个与 webservie 交互的应用程序，然后从外部数据库获取数据。当我从我的数据库中请求数据时，我会过滤它，例如每页 25 条记录，这样我就不会花太长时间来获取数据。（因为数据库有很多记录）。我想制作一个页面导航栏，以便我可以转到连续的 25 条记录，依此类推。还因为如果我在 listView 上加载所有记录，如果用户从最后想要一些东西，他将不得不向下滚动很长时间。我怎么做这个酒吧？有什么建议么？

我虽然在页面底部制作了 2 个小按钮（下一个和上一个），当您单击下一个时，该按钮会要求 Web 服务（通过 http 请求 url）获取连续的记录等等。有可能还是有更好和/或更简单的方法？

非常感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:48:22.293

我见过的常见做法是在列表末尾添加一个加载更多按钮。基本上只是制作一个自定义列表视图[，这里有一个](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/)关于如何做到这一点的教程。然后只需放置一个按钮，或图像视图或任何您想要的任何东西作为最后一个项目。当用户选择底部项目时，然后加载更多项目。

用于在列表末尾添加按钮的快速 sudo 代码

```
public View getView(int position, View convertView, ViewGroup parent) {
    if(position == size-1){
        return (new Button());
    }
} 
```

# javascript - 谷歌用固定数量的点映射用户可编辑的多边形？

> ID：10013274
> 
> 赞同：2
> 
> 时间：2012-04-04T14:31:45.293
> 
> 标签：javascript, google-maps, geocoding

好的，这是我的问题，我会放一张图片来说明它更容易。 ![谷歌地图可编辑六边形](../Images/cad13ee0ce5b29eabdbb1d643555b43c.png)

我需要用户绘制一些多边形，代表覆盖区域。

多边形需要有固定数量的点（顶点），因为它稍后会进入处理算法，如果多边形可以包含很多点，它会非常慢。

无论如何，在我的例子中，让我们坚持六边形（6 分）。
用户需要能够拖动多边形并对其进行修改，但不能更改点数。

我尝试`editable: true`为多边形设置选项，它工作正常，但它给了我图片上显示的情况。它为每个点创建一个句柄，并在每个点之间的中间创建另一个句柄（半透明）。现在，如果用户移动该半透明点，它将向多边形添加另一个点（顶点），并在新创建的线的中间添加额外的两个手柄。这给了我们一个 7 点多边形。

最好的选择是删除那些半透明的手柄，这样用户只能拖动多边形点，这样他就不会影响点的总数。

我可以使用谷歌地图可编辑选项来实现这一点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-06-27T22:04:23.563

实现您想要的另一种方法是放弃多边形的内置编辑能力并自己实现它。这更加强大和灵活。

首先，不要使多边形可编辑。接下来，为多边形的每个角制作一个标记。最后，使每个标记可拖动并在其“拖动”事件上设置一个事件侦听器以更新多边形。

制作标记并添加事件监听器：

```
for (var i=0; i<coordinates.length; i++){
    marker_options.position = coordinates[i];
    var point = new google.maps.Marker(marker_options);

    google.maps.event.addListener(point, "drag", update_polygon_closure(polygon, i));
} 
```

其中 update_polygon_closure 定义为：

```
function update_polygon_closure(polygon, i){
    return function(event){
       polygon.getPath().setAt(i, event.latLng); 
    }
} 
```

完整代码在此处的 jsfiddle 中：[https ://jsfiddle.net/3L140cg3/16/](https://jsfiddle.net/3L140cg3/16/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-08T21:59:00.023

由于似乎没有人有更好的解决方案，我将我的解决方法标记为已接受，以防有人偶然发现同样的问题。不是很漂亮，但可以完成工作

到目前为止，我发现的唯一解决方案是在绘制多边形后手动隐藏句柄。这里的问题是句柄没有任何 CSS 类或 id，所以我必须隐藏所有不透明度为 0.5 的 div（句柄的不透明度）。它有效，但风险很大，考虑到其他东西可能具有相同的不透明度并且不需要隐藏。

```
// variables
var map, path, color;

polygon = new google.maps.Polygon({
    paths: path,
    strokeColor: color,
    strokeOpacity: 0.8,
    strokeWeight: 2,
    fillColor: color,
    fillOpacity: 0.10,
    editable: true,
});
polygon.setMap(map);
setTimeout(function(){ map.find('div[style*=opacity: 0.5]').hide(); }, 50); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-05T09:26:43.523

作为对@zolakt 答案的轻微改进，您既可以隐藏多边形上的中点 div，也可以添加一个 mousedown 事件侦听器来跟踪单击中点的时间，以防止拖动和更改多边形：

```
// hide the midpoints (note that users can still click where the hidden midpoint
// divs are and drag to edit the polygon
$('#multi_markers div[style*="opacity: 0.5"]').hide();

// get the paths for the current polygon
var octopusPaths = HotelLib.octopusPolygon.getPaths();

// track when a polygon midpoint is clicked on
google.maps.event.addListener(HotelLib.octopusPolygon, 'mousedown', function(mdEvent) {

    // if a midpoint is clicked on, mdEvent.edge will have an integer value
    if(mdEvent.edge || (mdEvent.edge == 0)){

        // immediately reset the polygon to its former paths
        // effectively disabling the drag to edit functionality
        HotelLib.octopusPolygon.setPaths(octopusPaths);

        // hide the midpoints again since re-setting the polygon paths
        // will show the midpoints
        $('#multi_markers div[style*="opacity: 0.5"]').hide();

    }

}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-08T13:19:01.953

我刚刚为此创建了一个替代解决方案，而无需摆弄`setTimeout`或折线的创建。这也是一个有点全球性的解决方案，因此您基本上可以将其放入任何使用 Google 地图的已建立程序中。

我们将使用[MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)观察这些中点节点何时出现在 DOM 上，然后立即隐藏它们。当某些内容设置为可编辑时，它们应该开始出现。

基本上只需在地图初始化后将其放在任何地方：

```
var editMidpointNodeObserver = new MutationObserver(function(list, observer)
{
    if($('#mapwrapper div[style*="opacity: 0.5"]').parent('div[style*="cursor: pointer"]').length > 0)
    {
        $('#mapwrapper div[style*="opacity: 0.5"]').parent('div[style*="cursor: pointer"]').remove();
    }

});

editMidpointNodeObserver.observe($('#mapwrapper')[0], { childList: true, subtree: true }); 
```

将 更改`#mapwrapper`为您的 Google Maps 包装器元素的 id。我在这里使用 jQuery，因此`$('#mapwrapper')[0]`将 jQuery 对象转换为本机 DOM 对象。没有 jQuery 也应该可以工作，我假设你知道如何将它转换为 vanilla js。

我们也只是直接删除节点，因此无需担心用户会意外或以其他方式单击不可见的节点。

所有浏览器都应该支持 MutationObserver：[https ://caniuse.com/mutationobserver](https://caniuse.com/mutationobserver)

# sql - 查询 #1064 出现 Sql 错误

> ID：10013277
> 
> 赞同：0
> 
> 时间：2012-04-04T14:31:46.983
> 
> 标签：sql

您好我正在尝试在数据库上运行查询，但我不断收到此错误，您是否发现我的查询有任何问题？

```
SELECT *
FROM `data`
WHERE `Category` LIKE '%beauty%' and not in (SELECT *
FROM `data`
WHERE `Category` LIKE 'beauty%') 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:34:58.997

问题出在这方面：

> 而不是在

正确的语法是

```
and not <field name> in (Select <INDIVIDUAL FIELD> from ...) 
```

您不能在选择所有列的 where 子句中执行子查询 (*) 您需要在子查询中选择一个单独的列并将其绑定到主查询中的一列。

所以完整的声明应该是这样的

```
SELECT *
FROM `data`
WHERE `Category` LIKE '%beauty%' and `Category` not in (SELECT Category
FROM `data`
WHERE `Category` LIKE 'beauty%') 
```

相当于

```
SELECT *
FROM `data`
WHERE `Category` LIKE '%beauty%' and `Category`  NOT LIKE 'beauty%' 
```

这在 IMO 上更具可读性

有关在 WHERE 子句中的 IN 语句中使用子查询的更多信息，请参阅[http://beginner-sql-tutorial.com/sql-subquery.htm](http://beginner-sql-tutorial.com/sql-subquery.htm)

向下滚动以在文章中找到“相关子查询”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:33:53.123

```
SELECT *
FROM `data`
WHERE `Category` LIKE '%beauty%' and `Category` not in 
    (SELECT `Category`
     FROM `data`
     WHERE `Category` LIKE 'beauty%') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:37:06.377

我认为您的查询应如下所示：

```
SELECT   *
FROM     `data`
WHERE    `Category` LIKE '%beauty%' 
AND      `Category` NOT IN
(
    SELECT   `Category`
    FROM     `data`
    WHERE    `Category` LIKE 'beauty%'
) 
```

无论如何，我会将查询重写为：

```
SELECT   *
FROM     `data`
WHERE    `Category` LIKE '%beauty%' 
AND      `Category` NOT LIKE 'beauty%' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T14:34:09.060

```
SELECT * FROM `data`
WHERE `Category` LIKE '%beauty%' 
and `Category` not in (SELECT *
                      FROM `data` 
                      WHERE `Category` LIKE 'beauty%') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T14:34:11.740

...和`Category`？

```
SELECT *
FROM `data`
WHERE `Category` LIKE '%beauty%' and `Category` not in (SELECT *
FROM `data`
WHERE `Category` LIKE 'beauty%') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-04T14:39:01.623

为什么你需要一个子查询？这应该是您的查询

```
SELECT *
FROM `data`
WHERE `Category` LIKE '%beauty%' and `Category` not LIKE 'beauty%' 
```

# objective-c - strcpy 在较大尺寸上崩溃（iPhone 使用 rapidXML）

> ID：10013278
> 
> 赞同：2
> 
> 时间：2012-04-04T14:31:49.073
> 
> 标签：objective-c, ios5, rapidxml

我正在关注 iOS5 上的 rapidxml 教程，不幸的是我的 c 有点生疏了。以下代码适用于较小的字符大小，但会崩溃

```
EXC_BAD_ACCESS
```

当我拉下更大的尺寸时（我从 RESTful 接口中提取 XML）。

```
# pragma mark - parser methods
-(void)parseIncomingFeed:(NSData *)xmlData:(NSString*)tag {

    NSString *xmlStringOrg = [[NSString alloc] initWithData:xmlData encoding:NSASCIIStringEncoding];
    NSLog(@"[xmlStringOrg length] = %-10d  [xmlData length] = %d", [xmlStringOrg length],[xmlData length]);
    char xmlString[[xmlStringOrg length]];
    strcpy(xmlString, [xmlStringOrg UTF8String]);  // <--- crashes here
    ... 
```

结果如下：

```
[xmlStringOrg length] = 13580       [xmlData length] = 13580
[xmlStringOrg length] = 115476      [xmlData length] = 115476
[xmlStringOrg length] = 154589      [xmlData length] = 154589
[xmlStringOrg length] = 1902        [xmlData length] = 1902
[xmlStringOrg length] = 23402       [xmlData length] = 23402
[xmlStringOrg length] = 93037       [xmlData length] = 93037
[xmlStringOrg length] = 1723        [xmlData length] = 1723
[xmlStringOrg length] = 172329      [xmlData length] = 172329
[xmlStringOrg length] = 3470671     [xmlData length] = 3470671

(boom! with EXE_BAD_ACCESS leading to:  0x3234af6e:  push.w {r3, r4}) 
```

盲目地，我尝试了以下但没有运气：

```
 NSString *xmlStringOrg = [[NSString alloc] initWithData:xmlData encoding:NSASCIIStringEncoding];
 char xmlString[3600000];
 strcpy(xmlString, [xmlStringOrg UTF8String]); 
```

和

```
 NSString *xmlStringOrg = [[NSString alloc] initWithData:xmlData encoding:NSASCIIStringEncoding];
 char xmlString[[xmlStringOrg length]];
 strncpy(xmlString, [xmlStringOrg UTF8String], [xmlStringOrg length]); 
```

有任何想法吗？从我多年前的 c 课程开始，感觉就像我需要将大小大于 X 并单独处理它们，但我不确定从哪里开始。R

# 编辑 1 - 工作

感谢@RichardJ.RossIII，以下工作：

```
# pragma mark - parser methods
-(void)parseIncomingFeed:(NSData *)xmlData:(NSString*)tag {

    NSString *xmlStringOrg = [[NSString alloc] initWithData:xmlData encoding:NSASCIIStringEncoding];
    NSLog(@"[xmlStringOrg length] = %-10d  [xmlData length] = %d", [xmlStringOrg length],[xmlData length]);
    char *xmlString = (char*) malloc([xmlStringOrg length]);
    strcpy(xmlString, [xmlStringOrg UTF8String]);  // no more tears
    ...
    free(xmlString);
  } 
```

# jaxb - JAXB：注解@XmlAccessorType 是否仅用于序列化而与数据绑定无关？

> ID：10013282
> 
> 赞同：15
> 
> 时间：2012-04-04T14:31:57.493
> 
> 标签：jaxb

我想知道为什么我们在使用 JAXB 时需要指定注解 @XmlAccessorType 。

当我用谷歌搜索这个时，我从一个网站上找到了这个描述，说明这个 **@XmlAccessorType 设置了默认字段和属性可序列化。默认情况下，JAXB 序列化公共字段和属性。通过设置@XmlAccessorType，bean 可以选择只允许序列化带注释的字段。**

在这里，作者提到，通过这个注解，它可以控制序列化。

我的问题是，所以 @XmlAccessorType 与从 XML 到 java 和从 java 到 XML 的 JAXB 绑定和解除绑定无关，它只是关于序列化。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-04T15:24:22.683

JAXB 的`@XmlAccessorType`注解仅由[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)实现用于确定如何将文件编组到 XML 或从 XML 编组：

通常要做出的主要决定是在`FIELD`& `PROPERTY`/之间`PUBLIC`。 `FIELD`当您的 get/set 方法中有不想在编组/解组期间触发的逻辑时，它特别有用。要查看此选择影响映射元数据的一种方式，请参阅：

*   [http://blog.bdoughan.com/2012/02/jaxbs-xmltype-and-proporder.html](http://blog.bdoughan.com/2012/02/jaxbs-xmltype-and-proporder.html)

`NONE`当您有许多未映射的属性并且您想告诉您的 JAXB 实现仅映射您已注释的字段/属性时，这是一个有用的选择。这比在模型中添加大量`@XmlTransient`注释要容易得多。

**更多信息**

*   [http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html](http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html)

# javascript - jQuery可排序取消删除基于确认

> ID：10013283
> 
> 赞同：1
> 
> 时间：2012-04-04T14:32:03.860
> 
> 标签：javascript, jquery, json, jquery-ui, jquery-ui-sortable

如果对确认框的响应是否定的，我正在尝试取消删除功能上的可排序。这是我的可排序无序列表。

```
$("#items").sortable({
    remove: function(event, ui) {  
      var id = ui.item.attr("id");
      var loadUrl = "LoadItem.action";
      var removeUrl = "RemoveItem.action";

      $.getJSON(loadUrl, {"id":id}, function(data){
        if (data.passed !== undefined){
          var answer = confirm("A status exists on this item.  Remove anyways?");
          if (!answer){
            $(this).sortable('cancel');  //<-- This is where I need help
            return false;
          }
          $.post(removeUrl, {"id":id}, function(){ 
            //alert('removed'); 
          });
        }
      });
    }
  }); 
```

当我单击取消时，它会阻止我`$.post(removeUrl);`按预期触发，但该行项目仍会移动到另一个可排序列表。我希望它取消订单项移动。在接收事件中使用`$(ui.sender).sortable('cancel');`以这种方式工作，但有没有办法在删除事件中做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T21:18:19.300

```
$("#items").sortable({
  remove: function(event, ui) {  
  var id = ui.item.attr("id");
  var loadUrl = "LoadItem.action";
  var removeUrl = "RemoveItem.action";

  var self = this;
  $.getJSON(loadUrl, {"id":id}, function(data){
    if (data.passed !== undefined){
      var answer = confirm("A status exists on this item.  Remove anyways?");
      if (!answer){
        $(self).sortable('cancel');
        return false;
      }
      $.post(removeUrl, {"id":id}, function(){ 
        //alert('removed'); 
      });
    }
  });
}
}); 
```

# email - 邮件服务器使用什么编程语言？

> ID：10013284
> 
> 赞同：0
> 
> 时间：2012-04-04T14:32:12.790
> 
> 标签：email

我很好奇我必须学习什么编程语言才能创建自己的邮件服务器。我不想与大牌竞争，只是在玩。

例如，gmail、yahoo、msn。能够动态添加@domain.com 电子邮件并允许用户查看和发送电子邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:34:48.040

邮件服务器几乎可以用任何东西编写。通常较大的（sendmail/exim）是 c/c++，但是你几乎可以用你选择的任何东西写一个。如果您查看 SMTP 的工作原理，那么它就是一个大文本对话。

# vba - 如果目标单元格中 的公式超过某个值，则 VBA 代码显示消息框弹出窗口

> ID：10013285
> 
> 赞同：10
> 
> 时间：2012-04-04T14:32:15.097
> 
> 标签：vba, excel, messagebox

如果单元格中的值超过某个值，我正在尝试编写一个简单的宏来显示弹出窗口（vbOKOnly）。

我基本上有一个包含产品和折扣的工作表。我在一个单元格中有一个公式，比如 A1，它将折扣显示为所有条目的有效折扣百分比（50% 或 0.5）。

我正在寻找的是在单元格 A1 的值超过 50% 时显示消息框的代码，因为另一个单元格的输入将折扣推高了 50% 以上。

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-04T14:42:50.310

您可以将以下 VBA 代码添加到工作表中：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If Range("A1") > 0.5 Then
        MsgBox "Discount too high"
    End If
End Sub 
```

每次更改工作表上的单元格时，它都会检查单元格 A1 的值。

笔记：

*   如果 A1 还依赖于其他电子表格中的数据，则如果您更改该数据，则**不会**调用宏。
*   每次在您的工作表上发生更改时都会调用宏。如果它有很多公式（如 1000 秒），它可能会很慢。

[Widor](https://stackoverflow.com/a/10013534/829571)使用不同的方法（`Worksheet_Calculate`而不是`Worksheet_Change`）：

*   优点：如果 A1 的值链接到位于其他工作表中的单元格，他的方法将起作用。
*   缺点：如果您的工作表上有许多引用其他工作表的链接，他的方法运行速度会慢一些。

**结论**：`Worksheet_Change`如果 A1 仅取决于位于同一工作表上的数据，则使用`Worksheet_Calculate`，否则使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:45:15.587

本质上，您希望将代码添加到`Calculate`相关工作表的事件中。

在 VBA 编辑器的项目窗口中，在编辑器窗口顶部的下拉列表中双击要添加代码的工作表，然后分别选择左侧和右侧的“工作表”和“计算”。

或者，将以下代码复制到您要使用的工作表的编辑器中：

```
Private Sub Worksheet_Calculate()

If Sheets("MySheet").Range("A1").Value > 0.5 Then
    MsgBox "Over 50%!", vbOKOnly
End If

End Sub 
```

这样，每次工作表重新计算时，它都会检查该值是否 > 0.5 或 50%。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:40:31.187

我不认为消息框是最好的方法，因为您需要循环运行 VB 代码来检查单元格内容，或者除非您打算手动运行宏。在这种情况下，我认为如果值超过上限，最好向单元格添加条件格式以将背景更改为红色（例如）。

# c - 头文件编译错误中的结构

> ID：10013286
> 
> 赞同：1
> 
> 时间：2012-04-04T14:32:16.133
> 
> 标签：c, compiler-construction, mpi, header-files

我正在尝试编写一个包装 MPI 的框架库。

我有一个框架调用的头文件`afw.h`和一个名为`afw.c`.

我希望能够通过在应用程序代码中编写使用该框架`#include "afw.h"`的应用程序代码。

摘自`afw.h`：

```
#ifndef AFW_H
#define AFW_H

#include <mpi.h>

struct ReqStruct
{
    MPI_Request req;
};

ReqStruct RecvAsynch(float *recvbuf, FILE *fp);
int RecvTest(ReqStruct areq); 
```

`RecvAsynch`我提供了`afw.c`一个实现`#includes afw.h`

当我使用`mpicc`（在这种情况下使用 pgc 下面的 MPI 编译器包装器）进行编译时：

```
mpicc -c afw.c -o afw.o 
```

我得到：

```
PGC-S-0040-Illegal use of symbol, ReqStruct (./afw.h: 69)
PGC-W-0156-Type not specified, 'int' assumed (./afw.h: 69)
PGC-S-0040-Illegal use of symbol, ReqStruct (./afw.h: 71)
PGC-W-0156-Type not specified, 'int' assumed (./afw.h: 71) 
```

`ReqStruct`以及在任何地方使用的类似错误`afw.c`

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T14:34:19.273

您定义了 a `struct ReqStruct`， not `ReqStruct`，它们不是一回事。

要么将功能更改为

```
struct ReqStruct RecvAsynch(float *recvbuf, FILE *fp); 
```

或使用 typedef：

```
typedef struct ReqStruct ReqStruct; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T14:35:35.777

在 C++ 中，序列：

```
struct ReqStruct
{
    MPI_Request req;
}; 
```

定义`ReqStruct`可以在函数声明中使用的类型。

在 C 中，它没有（它定义了`struct ReqStruct`您可以使用的类型）；您需要添加一个`typedef`例如：

```
typedef struct ReqStruct
{
    MPI_Request req;
} ReqStruct; 
```

是的，`struct`标签可以与`typedef`名称相同。或者你可以`struct ReqStruct`在任何地方使用`ReqStruct`；我会`typedef`优先使用。

# forms - 使用 :remote => true Rails 3.2 提交两次表单

> ID：10013287
> 
> 赞同：0
> 
> 时间：2012-04-04T14:32:19.933
> 
> 标签：forms, ruby-on-rails-3.2

我有以下表格：

```
= form_for([current_user,@company], :remote => true) do |f|
  -if @company.errors.any?
    #error_explanation
      %h2= "#{pluralize(@company.errors.count, "error")} prohibited this company from being saved:"
      %ul
        - @company.errors.full_messages.each do |msg|
          %li= msg
  =f.label :name
  =f.text_field :name
  =f.label :address
  =f.text_area :address, :rows => 3, :cols => 5
  =f.label :phone_number
  =f.text_field :phone_number
  .actions
    = f.submit 'Save' 
```

当我单击保存按钮时，我可以在服务器日志中看到以下内容：

```
Started POST "/users/1/companies" for 127.0.0.1 at 2012-04-04 21:27:50 +0700
Processing by CompaniesController#create as JS
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6ZH9hAUuf5ZTCf8Loc4M/IIl/Etzm7uDGoYbIgCTvhI=", "company"=>{"name"=>"test", "address"=>"test", "phone_number"=>"5454543"}, "commit"=>"Save", "user_id"=>"1"}
   (0.2ms)  BEGIN
  SQL (25.2ms)  INSERT INTO "companies" ("address", "name", "phone_number", "url", "user_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["address", "test"], ["name", "test"], ["phone_number", "5454543"], ["url", nil], ["user_id", nil]]
   (1.6ms)  COMMIT
  Rendered companies/create.js.erb (0.7ms)
Completed 200 OK in 41ms (Views: 8.1ms | ActiveRecord: 27.0ms)

Started POST "/users/1/companies" for 127.0.0.1 at 2012-04-04 21:27:50 +0700
Processing by CompaniesController#create as JS
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"6ZH9hAUuf5ZTCf8Loc4M/IIl/Etzm7uDGoYbIgCTvhI=", "company"=>{"name"=>"test", "address"=>"test", "phone_number"=>"5454543"}, "commit"=>"Save", "user_id"=>"1"}
   (0.7ms)  BEGIN
  SQL (2.7ms)  INSERT INTO "companies" ("address", "name", "phone_number", "url", "user_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["address", "test"], ["name", "test"], ["phone_number", "5454543"], ["url", nil], ["user_id", nil]]
   (12.8ms)  COMMIT
  Rendered companies/create.js.erb (0.1ms)
Completed 200 OK in 30ms (Views: 10.5ms | ActiveRecord: 16.1ms) 
```

这意味着表单被提交了两次。我已经从我的公共目录中删除了 assets 文件夹。我还检查了页面上呈现的 html，并且没有双重包含 jquery 或其他依赖项。

为什么要提交两次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T03:22:12.013

我已经运行了 rake assets:precompile 并在开发模式下运行我的服务器。解决方案是 rake assets:clean 并重新启动服务器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T14:44:36.313

我的解决方法：

```
 rake assets:precompile
 with //= require jquery_ujs in your app/assets/javascripts/application.js 
```

rake 后，移除线路`from app/assets/javascripts/application.js`并启动服务器。现在它应该按预期工作。

# spring - 另一个未命名的 CacheManager 已存在于同一虚拟机中（ehCache 2.5）

> ID：10013288
> 
> 赞同：77
> 
> 时间：2012-04-04T14:32:22.780
> 
> 标签：spring, junit, ehcache

这就是我运行 junit 测试时发生的情况......

```
Another CacheManager with same name 'cacheManager' already exists in the same VM. Please 
provide unique names for each CacheManager in the config or do one of following:
1\. Use one of the CacheManager.create() static factory methods to reuse same
   CacheManager with same name or create one if necessary
2\. Shutdown the earlier cacheManager before creating new one with same name.

The source of the existing CacheManager is: 
 DefaultConfigurationSource [ ehcache.xml or ehcache-failsafe.xml ] 
```

异常背后的原因是什么。可以同时运行 1 个以上的 cacheManager 吗？

这就是我使用 Sping 3.1.1 配置 cachManager 的方式。它明确地将 cacheManager 的范围设置为“singleton”

```
<ehcache:annotation-driven />

<bean
    id="cacheManager"
    class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean"
    scope="singleton"
    /> 
```

ehcache.xml 看起来像

```
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd"
     updateCheck="false"
     maxBytesLocalHeap="100M" 
     name="cacheManager"
     >
 ....
 </ehcache> 
```

最后我的课

```
@Component
public class BookingCache implements CacheWrapper<String, BookingUIBean> {

     @Autowired
     private CacheManager ehCacheManager;
      ....
} 
```

我很确定我在我的代码库中只处理一个 cacheManager。其他东西可能正在运行第 n 个实例。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-02T17:07:07.817

Your EhCacheManagerFactoryBean may be a singleton, but it's building multiple CacheManagers and trying to give them the same name. That violates Ehcache 2.5 [semantics](http://ehcache.org/documentation/get-started/key-classes-methods#introduction).

> Versions of Ehcache before version 2.5 allowed any number of CacheManagers with the same name (same configuration resource) to exist in a JVM.
> 
> Ehcache 2.5 and higher does not allow multiple CacheManagers with the same name to exist in the same JVM. CacheManager() constructors creating non-Singleton CacheManagers can violate this rule

Tell the factory bean to created a shared instance of the CacheManager in the JVM by setting the [shared](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/ehcache/EhCacheManagerFactoryBean.html#setShared%28boolean%29) property to true.

```
<bean id="cacheManager"
      class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean"
      p:shared="true"/> 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2014-01-30T14:06:57.773

我在使用 JPA (2.0) + Hibernate (3.6.4) + Spring (3.2.4) 的集成测试中遇到了同样的问题。使用以下 Hibernate 配置解决了该问题：

```
<property name="hibernate.cache.region.factory_class" value="net.sf.ehcache.hibernate.SingletonEhCacheRegionFactory"/> 
```

而不是使用

```
<property name="hibernate.cache.region.factory_class" value="net.sf.ehcache.hibernate.EhCacheRegionFactory"/> 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-08-14T15:29:48.480

您的问题是在 Spring 测试框架中构建的上下文加载优化。一旦测试类完成，Spring（默认）不会破坏上下文，希望另一个测试类可以重用它（而不是从头开始创建它）。

你可以使用@DirtiesContext 覆盖这个默认值，或者如果你使用maven，你可以将surefire forkMode 设置为“always”并为每个测试类创建一个新的VM。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-01-03T21:58:22.747

升级到 Hibernate 5 后，我不得不使用：

```
<property name="hibernate.cache.region.factory_class" value="org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory"/> 
```

代替：

```
<property name="hibernate.cache.region.factory_class" value="net.sf.ehcache.hibernate.SingletonEhCacheRegionFactory"/> 
```

请注意，这些软件包彼此不同。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-08-24T16:35:24.953

您也可以尝试在 ehcache.xml 配置（在 ehcache 元素上）设置名称“xxx”。

这对我有用，因为我认为我的应用程序的一个模块中潜伏着另一个缓存配置。

共享解决方案也有效，但我不知道它的广泛影响。

*   [http://forums.terracotta.org/forums/posts/list/6495.page](http://forums.terracotta.org/forums/posts/list/6495.page)
*   [https://norrisshelton.wordpress.com/2012/03/08/spring-3-1-caching-abstraction-with-ehcache/](https://norrisshelton.wordpress.com/2012/03/08/spring-3-1-caching-abstraction-with-ehcache/)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-02-05T05:29:38.717

对于后代：更好的方法是使用[EhCacheManagerFactoryBean](https://github.com/spring-projects/spring-framework/blob/master/spring-context-support/src/main/java/org/springframework/cache/ehcache/EhCacheManagerFactoryBean.java)的“接受现有”属性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-10-31T07:39:26.023

在我的例子中，我们有一个定义为 bean 的自定义缓存管理器。也是一个自定义应用程序上下文，所以我们不使用 spring junit runner ...因此 @DirtiesContext 不起作用。

诀窍是从 bean 中检索缓存实例，在该缓存上获取 cacheManager（来自 EHCache 的实例）。并在该缓存管理器上调用 removeCache 方法。

将其放入使用 @After 注释的方法中，每次测试后您的缓存都会从 VM 中删除。像这样：

```
@After
public void destroy() {
    MyCustomCacheManager customCacheManager = (MyCustomCacheManager) context.getBean("yourCustomCacheManagerBean");

    try {
        net.sf.ehcache.Cache cache = customCacheManager.getCache();
        net.sf.ehcache.CacheManager cacheManager = cache.getCacheManager();
        cacheManager.removeCache("nameOfYourCache");
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    }

    context.destroy();
    context = null;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-30T06:48:23.767

如果您只是测试您的业务服务，而不是二级缓存，您可以在 spring 配置文件中删除二级配置，您的测试将成功运行。有我的二级配置：

```
 <bean id="entityManagerFactory"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="persistenceUnitName" value="defaultPU" />
        <property name="jpaVendorAdapter" ref="hibernateJpaVendorAdapter" />
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">false</prop>
                <!-- <prop key="hibernate.hbm2ddl.auto">update</prop> -->
                <prop key="hibernate.cache.use_second_level_cache">false</prop>
                <prop key="hibernate.cache.use_query_cache">false</prop>
            </props>
        </property>
    </bean> 
```

如果我更改为二级缓存配置的完整配置，则真正的 webapp 在运行时使用，如下所示：

```
 <bean id="entityManagerFactory"
            class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="dataSource" ref="dataSource" />
            <property name="persistenceUnitName" value="defaultPU" />
            <property name="jpaVendorAdapter" ref="hibernateJpaVendorAdapter" />
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                    <prop key="hibernate.show_sql">false</prop>
                    <!-- <prop key="hibernate.hbm2ddl.auto">update</prop> -->
                    <prop key="hibernate.cache.use_second_level_cache">true</prop>
                    <prop key="hibernate.cache.use_query_cache">true</prop>
                    <prop key="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.EhCacheRegionFactory</prop>               
                    <prop key="net.sf.ehcache.configurationResourceName">ehcache/ehcache-hibernate-local.xml</prop>
                </props>
            </property>
        </bean> 
```

然后我得到相同的异常“另一个未命名的 CacheManager 已存在于同一 VM 中”

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-05-14T08:16:43.047

**切换到Spring Boot 2.0.2**时发生在我身上。通过执行以下操作解决了它：

**在 application.yml 中删除**

```
spring.jpa.properties.hibernate.cache.region.factory_class: org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory 
```

**在 pom.xml 中删除**

```
<dependency>
    <groupId>net.sf.ehcache</groupId>
    <artifactId>ehcache</artifactId>
</dependency> 
```

**仅保留在 pom.xml 中**

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-ehcache</artifactId>
</dependency> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-10-20T10:55:34.687

设置`EhCacheManagerFactoryBean#shared`为`true`对我有用。

设置为`EhCacheManagerFactoryBean#acceptExisting`对`true`我不起作用。

```
import org.springframework.cache.ehcache.EhCacheCacheManager;
import org.springframework.cache.ehcache.EhCacheManagerFactoryBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.io.ClassPathResource;

@Configuration
public class EhCacheConfiguration {

    @Bean
    public EhCacheCacheManager ehCacheCacheManager() {

        return new EhCacheCacheManager(ehCacheManagerFactoryBean().getObject());
    }

    @Bean
    public EhCacheManagerFactoryBean ehCacheManagerFactoryBean() {

        EhCacheManagerFactoryBean cacheManagerFactoryBean = new EhCacheManagerFactoryBean();

        cacheManagerFactoryBean.setConfigLocation(new ClassPathResource("ehcache.xml"));
        cacheManagerFactoryBean.setShared(true);

        return cacheManagerFactoryBean;
    }
} 
```

正如在[没有 XML 的 Spring 4 中使用 EhCache 中所解释的那样](https://stackoverflow.com/a/21992641/4434367)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-03T11:24:35.133

我通过将以下内容添加到 resources.groovy 来解决它：

beans = { ... aclCacheManager(EhCacheManagerFactoryBean) { shared = true } ... }

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-02-11T13:37:23.750

对于未来的读者，这个问题的原因是在我的 pom.xml 文件中我导入了 hibernate-ehcache 库，我不知道它也已经包含了 ehcache 库，然后显式导入了 net.sf.ehache图书馆。

当我作为独立应用程序（例如命令行实用程序）运行时，这似乎工作正常，但在 tomcat 服务器上运行时导致原始帖子中的错误。

从以下位置更改我的 pom 文件：

```
 <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-ehcache</artifactId>
            <version>5.0.2.Final</version>
        </dependency>
        <dependency>
            <groupId>net.sf.ehcache</groupId>
            <artifactId>ehcache</artifactId>
            <version>2.7.4</version>
        </dependency> 
```

至：

```
 <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-ehcache</artifactId>
            <version>5.0.2.Final</version>
        </dependency>
        <!-- ehcache dependency removed --> 
```

修复了问题。如果有人知道为什么只有在 tomcat 容器中运行时才会出现问题，我很想知道..

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-20T00:42:25.423

在 glassfish 3.0.1 中，我将问题追溯到 IniShiroFilter 两次初始化，这发生在服务器启动后触发并发请求时。以下是对应于两个 HTTP 请求的两个不同线程的堆栈跟踪：

```
[#|2012-11-28T08:25:10.630-0800|SEVERE|glassfish3.0.1|javax.enterprise.system.std.com.sun.enterprise.v3.services.impl|_ThreadID=28;_ThreadName=Thread-1;|java.lang.Exception: Stack trace
        at java.lang.Thread.dumpStack(Thread.java:1249)
        at org.apache.shiro.web.servlet.IniShiroFilter.<init>(IniShiroFilter.java:124)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at com.sun.enterprise.container.common.impl.util.InjectionManagerImpl.createManagedObject(InjectionManagerImpl.java:303)
        at com.sun.enterprise.web.WebContainer.createFilterInstance(WebContainer.java:725)
        at com.sun.enterprise.web.WebModule.createFilterInstance(WebModule.java:1948)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:248)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:237)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
        at com.sentilla.filter.DumpFilter.doFilter(DumpFilter.java:152)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:277)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)
        at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:322)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)
        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:239)
        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)
        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)
        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)
        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)
        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)
        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)
        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)
        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)
        at com.sun.grizzly.ContextTask.run(ContextTask.java:69)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)
        at java.lang.Thread.run(Thread.java:662) 
```

另一个线程

```
[#|2012-11-28T08:25:15.299-0800|SEVERE|glassfish3.0.1|javax.enterprise.system.std.com.sun.enterprise.v3.services.impl|_ThreadID=29;_ThreadName=Thread-1;|java.lang.Exception: Stack trace
        at java.lang.Thread.dumpStack(Thread.java:1249)
        at org.apache.shiro.web.servlet.IniShiroFilter.<init>(IniShiroFilter.java:124)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at com.sun.enterprise.container.common.impl.util.InjectionManagerImpl.createManagedObject(InjectionManagerImpl.java:303)
        at com.sun.enterprise.web.WebContainer.createFilterInstance(WebContainer.java:725)
        at com.sun.enterprise.web.WebModule.createFilterInstance(WebModule.java:1948)
        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:248)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:237)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
        at com.sentilla.filter.DumpFilter.doFilter(DumpFilter.java:152)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:277)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)
        at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:322)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)
        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:239)
        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)
        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)
        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)
        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)
        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)
        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)
        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)
        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)
        at com.sun.grizzly.ContextTask.run(ContextTask.java:69)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)
        at java.lang.Thread.run(Thread.java:662) 
```

查看堆栈跟踪 ApplicationFilterConfig.java:248 可能是罪魁祸首。或者，glassfish 在错误的上下文中初始化过滤器，为了比较，Tomcat 在 BootStrap 期间初始化过滤器。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-08-27T05:11:34.580

在我的情况下，问题是组件扫描和 java 配置。

```
root-context.xml
<context:component-scan base-package="org.beansugar">

servlet-context.xml
<context:component-scan base-package="org.beansugar"> 
```

spring component-scan 对 xml 文件工作两次。它每次运行时都会在 SpringConfig.java 中生成 bean。然后创建了重复的缓存管理器。

所以，我改变了如下。

```
root-context.xml
<context:component-scan base-package="org.beansugar">
        <context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
</context:component-scan>

servlet-context.xml
<context:component-scan base-package="org.beansugar" use-default-filters="false">
        <context:include-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
</context:component-scan> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-02-16T12:26:34.620

错误的映射文件也会发生此错误。消息很可怕，没有说明原因。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-02-09T14:51:05.810

从**Spring Boot 2.1.2**开始，以下配置可以解决该问题。（注意，这些是整体配置的片段。）

**依赖项：**

```
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-cache</artifactId>
</dependency>
<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate-core</artifactId>
  <version>5.2.8.Final</version>
</dependency>
<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate-ehcache</artifactId>
  <version>5.2.8.Final</version>
</dependency> 
```

**application.yml 配置：**

```
spring:
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: none
    show-sql: true
    properties:
      dialect: org.hibernate.dialect.MySQLDialect
      net:
        sf:
          ehcache:
            configurationResourceName: ehcache.xml
      hibernate:
        cache:
          use_second_level_cache: true
          region:
            factory_class: org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory 
```

**ehcache.xml 配置：**

```
<?xml version="1.0" encoding="UTF-8"?>
<ehcache>
  <!-- Required elements -->
  <diskStore path="java.io.tmpdir"/>
  <defaultCache
    maxElementsInMemory="10000"
    eternal="false"
    timeToIdleSeconds="120"
    timeToLiveSeconds="120"
    overflowToDisk="true"/>

  <!-- Cache settings per class -->
  <cache name="com.mystuff.component.services.example.Book"
    maxElementsInMemory="1000"
    eternal="false"
    timeToIdleSeconds="300"
    timeToLiveSeconds="600"
    overflowToDisk="true"/>
</ehcache> 
```

我正在处理的应用程序在没有工作缓存的情况下会急剧变慢。因此，为了验证，我只是运行了应用程序并点击了读取密集的端点之一。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-03-02T01:00:06.350

在我的例子中，Manager 是由这个 bean 创建的（ehCache 2.10）：

```
 <bean id="ehcache"
        class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">
    <property name="shared" value="false"/>
  </bean> 
```

对我有用的唯一解决方案是以这种方式手动销毁它：

```
@Inject
private EhCacheManagerFactoryBean ehCacheManagerFactoryBean; 
```

接着

```
ehCacheManagerFactoryBean.destroy(); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-11-13T08:55:15.477

在我的情况下，配置如下：

```
<spring.boot.version>1.5.8.RELEASE</spring.boot.version>
<spring.boot.yarn.version>2.4.0.RELEASE</spring.boot.yarn.version>
<spring.version>4.3.7.RELEASE</spring.version>

<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate-core</artifactId>
  <version>3.5.1-Final</version>
</dependency>
<dependency>
  <groupId>org.hibernate</groupId>
  <artifactId>hibernate-ehcache</artifactId>
  <version>3.5.1-Final</version>
</dependency> 
```

更改 EHCache 提供程序类为我完成了这项工作。我使用的是缓存提供程序类，因为`org.hibernate.cache.EhCacheProvider`我将其更改为： `net.sf.ehcache.hibernate.SingletonEhCacheProvider`

# windmill - 如何成功安装风车？

> ID：10013290
> 
> 赞同：0
> 
> 时间：2012-04-04T14:32:28.467
> 
> 标签：windmill

关注 [https://github.com/windmill/windmill/wiki/installing之后](https://github.com/windmill/windmill/wiki/installing)

我安装 python 2.7 并将其添加到我的路径中，当我运行 ez_setup.py 时收到 404。

```
C:\windmill\windmill-windmill-4304ee7>python ez_setup.py
Downloading http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c9-py
2.7.egg
Traceback (most recent call last):
File "ez_setup.py", line 270, in <module>
 main(sys.argv[1:])
File "ez_setup.py", line 202, in main
 egg = download_setuptools(version, delay=0)
File "ez_setup.py", line 150, in download_setuptools
 src = urllib2.urlopen(url)
File "C:\recsolu\python27\lib\urllib2.py", line 126, in urlopen
 return _opener.open(url, data, timeout)
File "C:\recsolu\python27\lib\urllib2.py", line 400, in open
 response = meth(req, response)
File "C:\recsolu\python27\lib\urllib2.py", line 513, in http_response
 'http', request, response, code, msg, hdrs)
File "C:\recsolu\python27\lib\urllib2.py", line 438, in error
 return self._call_chain(*args)
File "C:\recsolu\python27\lib\urllib2.py", line 372, in _call_chain
 result = func(*args)
File "C:\recsolu\python27\lib\urllib2.py", line 521, in http_error_default
 raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)
urllib2.HTTPError: HTTP Error 404: Not Found

C:\windmill\windmill-windmill-4304ee7> 
```

关于如何解决的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:02:35.787

事实证明，如果您几乎完全按照说明进行操作，它应该可以工作。这包括保存看起来过时的 ez_setup.py 文件。

我现在正在跑步。

# objective-c - 如何扩展 NSWindow 的客户区？

> ID：10013292
> 
> 赞同：0
> 
> 时间：2012-04-04T14:32:28.913
> 
> 标签：objective-c, macos, cocoa, nswindow

这就是它在 Windows 中的调用方式，如果我使用不同的术语，请见谅。我想做一个看起来像这样的窗口：

![在此处输入图像描述](../Images/83918e8a02c7b9b970c52d015e3df5ef.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:55:32.263

在代码中：

修改窗口的样式掩码，并在`setStyleMask:`其中包含`NSTexturedBackgroundWindowMask`（在文档中查找“窗口样式掩码”常量以获取样式掩码中可以包含的其他常量）。如果您正在创建一个新窗口，请`initWithContentRect:styleMask:backing:defer:`类似地使用。

在界面生成器中：

选择您想要的窗口，转到检查器左侧的第四个选项卡并选中“纹理”复选框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:56:20.477

苹果称其为带纹理的窗口。您可以在 Interface Builder 中启用它或在​​窗口的样式掩码中指定 NSTexturedBackgroundWindowMask。

# ruby - open-uri 没有将 http 重定向到 https

> ID：10013293
> 
> 赞同：12
> 
> 时间：2012-04-04T14:32:29.143
> 
> 标签：ruby, rubygems, hpricot, open-uri

我正在使用 Hpricot 和 OpenURI 来解析网页并从中提取 URL。

当我收到“http:rapidshare.com”之类的链接时，它不会重定向到 https。这是我得到的错误：

```
/home/leonidus/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:216:in 
`open_loop': redirection forbidden: http:.................=>     
https:.........................
.
. 
```

我尝试使用异常处理程序`OPENURI::HTTPREDIRECT`，但又遇到了同样的错误。我尝试了所有博客，但那里也没有解决。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-04T16:02:15.890

有关您遇到此问题的原因的讨论，请参阅[此 Ruby 错误报告。](http://bugs.ruby-lang.org/issues/859)请参阅[此要点](https://gist.github.com/1271420)以获取 OpenURI 的猴子补丁以允许“不安全”重定向。

# javascript - JavaScript if 语句测试其中之一，但不能同时测试两者

> ID：10013294
> 
> 赞同：3
> 
> 时间：2012-04-04T14:32:35.017
> 
> 标签：javascript, if-statement

你好 StackOverflowers 伙伴。我现在脑子里放了个屁，我似乎无法弄清楚这一点。

我有以下代码

```
if ((n % 3 === 0 || n % 5 === 0) &&( n % 3 !== 0 && n % 5 !== 0))
    {
        return true;
}
else {
    return false;
} 
```

基本上我需要测试这个数字是否是 3 的倍数 || 5 但不是两者的倍数。

但是，当我输入我输入的任何数字（无论是 3 || 5 || 两者的倍数）时，测试总是失败。我原以为这可以在一个语句中执行。

这段代码虽然工作正常。

```
if (n % 3 === 0 || n % 5 === 0)
{
    if( n % 3 === 0 && n % 5 === 0)
    {
        return false;
    }
    else {
       return true;
    }
}
else {
    return false;
} 
```

但我想知道我在第一次测试中缺少什么。我希望所有的测试都像一个一样，但就像我说的那样，我脑子里放了一个屁，无法弄清楚我错过了什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T14:37:02.643

您也可以使用 XOR 运算符

```
return  (n % 3 === 0 ^ n % 5 === 0); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-04T14:36:01.120

如果它可以被 3 和 5 整除，那么它将被 15 整除。

请尝试以下条件

```
if ((n % 3 === 0 || n % 5 === 0) && ( n % 15 !== 0)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-04T14:37:08.410

改变

```
if ((n % 3 === 0 || n % 5 === 0) &&( n % 3 !== 0 && n % 5 !== 0)) 
```

至

```
if ((n % 3 === 0 || n % 5 === 0) && !(n % 3 === 0 && n % 5 === 0)) 
```

您的逻辑的第一部分是确定所讨论的数字是 3 还是 5 的倍数，而第二部分应该是关于是否只有其中一个。所以...我更改了第二部分以查看两者是否匹配，然后我没有这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-04T14:35:22.377

它应该是：`if ((n % 3 === 0 || n % 5 === 0) &&( n % 3 !== 0 || n % 5 !== 0))`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-04T14:35:40.177

```
return (n % 3 === 0  && !(n % 5 === 0)) || (n % 5 === 0  && !(n % 3 === 0)); 
```

（未经测试）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-04T14:35:40.613

您的第二次检查是错误的：

`if ((n % 3 === 0 || n % 5 === 0) &&**( n % 3 !== 0 && n % 5 !== 0)**)`

将其更改为：

`(! (n%3 === 0 && n % 5 === 0 ) )`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-04T14:37:17.353

`XOR`这是在 javascript 中使用条件语句实现的简短版本

```
if((n % 3 === 0)? (n % 5 !== 0) : (n % 5 === 0)) {
  ...
} 
```

或者您也可以通过这种方式进行比较，检查两个条件何时返回不同的值（一个为真，另一个为假，反之亦然）

```
if( (n % 3 === 0) !==  (n % 5 === 0)) {
  ...
} 
```

所以这段代码可以写得很短

# php - PHP嵌套分页/分页

> ID：10013295
> 
> 赞同：0
> 
> 时间：2012-04-04T14:32:41.207
> 
> 标签：php, pagination, nested, paging

让我们直奔主题...

例如，我有这样的国家和城市数据库：

+---------------+------------------+

|国家名称 |城市名称 |

+---------------+------------------+

| 美国 | 华盛顿 |

| 美国 | 芝加哥 |

| 美国 | 迈阿密 |

<--- 美国直到 100 行 --->

| 英国 | 伦敦 |

| 英国 | 切尔西 |

| 英国 | 热刺 |

<--- 直到英国的 100 行 --->

<--- 有 200 多个国家名称 --->

这就是我想用 PHP 做的事情：

国家名称：美国

*   城市 : 华盛顿

*   城市 : 芝加哥

*   城市 : 迈阿密

-------- >> 仅限 10 个城市 ------>> 见第 2 页了解更多

国名：英国

*   城市 : 伦敦

*   城市 : 切尔西

*   城市：托特纳姆热刺

-------- >> 仅限 10 个城市 ------>> 见第 2 页了解更多

-------- >> 仅限 10 个国家 ------>> 见第 2 页了解更多

可以用 PHP 完成吗？如何像这样进行多重/嵌套分页？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:46:20.370

```
SELECT * FROM MyTable WHERE CountryName = "US" LIMIT $per_page, $start 
```

其中 $per_page 是每页的条目数量，在本例中为 10

$start 是它开始的地方，通常（页码 - 1 * $per_page）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T11:42:05.487

如果您的结果将包含许多页面（即 100 多个页面），请考虑显示“对数”页面导航栏，如下所述：

[如何为很多很多页面进行页面导航？对数页面导航](https://stackoverflow.com/q/7835752/999120)

# iphone - 使用 CAKeyframeAnimation 时，是否可以不预先加载所有关键帧？

> ID：10013301
> 
> 赞同：1
> 
> 时间：2012-04-04T14:33:08.753
> 
> 标签：iphone, optimization, lazy-loading, cakeyframeanimation

我正在开发一个 iOS 应用程序，其中有一些我想播放的动画。对于每个动画，我都有一个文件中的所有信息（初始位置/比例/等..然后文件中的每个记录一个关键帧）。

我目前正在使用 CAKeyframeAnimation，因为这似乎是最合乎逻辑的选择，但是，对于一些动画，我有大量关键帧，需要大约 2 秒来预先加载所有动画。我真的很想避免这种滞后。此外，动画在任何时间点都只需要 2 个关键帧，并且一次加载所有关键帧会导致我的应用程序占用非常大的内存占用，而我也想避免这种占用。

是否可以将关键帧动态添加到已经运行的 CAKeyframeAnimation 中？如果是这样，怎么做？

如果不可能，我应该使用什么来代替 CAKeyframeAnimation？

# javascript - 出现流畅的菜单

> ID：10013309
> 
> 赞同：0
> 
> 时间：2012-04-04T14:33:37.483
> 
> 标签：javascript, jquery, jquery-ui

我想制作一个从右到左滑动的菜单，它是一个 h2 标题**，并且当它**从上到下信息完成时。如果在菜单已经存在的情况下单击不同的选项，则首先向上然后离开，如前所述。所以主要问题是，在某些方面需要出现 2 个信息而不是一个，我不知道该怎么做，所有这些都一个接一个地执行。如果使用回调，一些文本会出现两次或更多次......

```
$("a[rel~='showinfo']").click(function () {
  var info_id = $(this).attr('id');//getting needed id from menu to show info

  if($('.info_name').is(':visible'))//if already exists - removing
    remove_contact();

  for(i=0; i<contact_status.length; i++){//checking all array for item
    if(info_id == contact_status[i]){//if item exist 
        create_contact(i);//putting it in
        //here starts problems....
        $('#info_name'+i).show("slide", {direction: "right"}, 1000, function(){
            $('#info_info'+i).show("slide", {direction: "up"}, 1000);
        });
    }
  }
 //$('.info_name').show("slide", {direction: "right"}, 1000);
 //$('.info_info').show("slide", {direction: "up"}, 1000);

});

function create_contact(id){
    $('.third').append('<div class="showinfo"><h2 id="info_name'+id+'" class="info_name">'+contact_name[id]+'</h2><span class="info_info" id="info_info'+id+'">lol</span></div>')
}

function remove_contact() {
    $('.info_name').hide("slide", {direction: "right"}, 1000);
    $('.showinfo').remove();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:08:42.233

```
 for(i=0; i<contact_status.length; i++){//checking all array for item
    if(info_id == contact_status[i]){//if item exist 
        (function ( idx ) { // use a Anonymous funciton
             create_contact(idx );//putting it in
            //here starts problems....
            var;
            $('#info_name'+idx ).show("slide", {direction: "right"}, 1000, function(){
                $('#info_info'+idx ).show("slide", {direction: "up"}, 1000);
            });
        })( i );
    }
  } 
```

啊，我错了……这次应该是对的

# sql - 为什么 SQL 服务器会抛出此错误：无法将值 NULL 插入“id”列？

> ID：10013313
> 
> 赞同：85
> 
> 时间：2012-04-04T14:33:46.590
> 
> 标签：sql, sql-server

我正在使用以下查询：

```
INSERT INTO role (name, created) VALUES ('Content Coordinator', GETDATE()), ('Content Viewer', GETDATE()) 
```

但是，我没有指定主键（即`id`）。所以我的问题是，为什么 sql server 会出现这个错误：

```
Msg 515, Level 16, State 2, Line 1
Cannot insert the value NULL into column 'id', table 'CMT_DEV.dbo.role'; column does not allow nulls. INSERT fails.
The statement has been terminated. 
```

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2012-04-04T14:36:40.817

我假设这`id`应该是一个递增的值。

你需要设置这个，否则如果你有一个不可为空的列，没有默认值，如果你没有提供值，它会出错。

在 SQL Server Management Studio 中设置自动增量：

*   打开你的桌子`Design`
*   选择您的列并转到`Column Properties`
*   在`Indentity Specification`, 设置`(Is Identity)=Yes`和`Indentity Increment=1`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-01-09T19:41:03.503

在创建表时使用`IDENTITY(1,1)`，例如

```
CREATE TABLE SAMPLE(
[Id]     [int]  IDENTITY(1,1) NOT NULL,
[Status] [smallint] NOT NULL,

CONSTRAINT [PK_SAMPLE] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)
) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-04T14:40:26.773

如果该`id`列没有默认值，但有`NOT NULL`约束，那么您必须自己提供一个值

```
INSERT INTO dbo.role (id, name, created) VALUES ('something', 'Content Coordinator', GETDATE()), ('Content Viewer', GETDATE()) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-16T02:13:07.863

如果您不能或不想设置 id 的 autoincrement 属性，您可以为每一行设置 id 的值，如下所示：

```
INSERT INTO role (id, name, created)
SELECT 
      (select max(id) from role) + ROW_NUMBER() OVER (ORDER BY name)
    , name
    , created
FROM (
    VALUES 
      ('Content Coordinator', GETDATE())
    , ('Content Viewer', GETDATE())
) AS x(name, created) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T14:38:15.507

您要么需要在插入中指定 ID，要么需要将数据库中的 id 列配置为 Identity Specification = Yes。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-04T14:38:26.130

由于 id 是 PK 它必须是唯一的并且不为空。如果您没有提及要插入的字段列表中的任何字段，则它应该是 null 或默认值。如果您不想每次都手动设置，请为此字段设置标识（即自动增量）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-04T14:44:32.463

您需要在创建表时将 id 列的 autoincrement 属性设置为 true，或者您可以更改现有表来执行此操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-09T02:04:17.840

你没有给 id 一个值。试试这个 ：

```
INSERT INTO role (id, name, created) VALUES ('example1','Content Coordinator', GETDATE()), ('example2', 'Content Viewer', GETDATE()) 
```

或者，如果您需要自动添加 id 值，您可以在 id 字段上设置自动增量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-01T15:22:38.567

我有一个类似的问题，在查看它时，它只是实际表中的一个字段丢失**`id`**（`id`是`empty/null`）-这意味着当您尝试创建该**`id`**字段时**`primary key`**，它将导致错误，因为该表包含一个**`null`**值为**`primary key`**.

> 如果您看到与错误关联的临时表，这可能是修复。我使用的是 SQL Server Management Studio。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-08-17T02:19:12.183

@curt 是正确的，但我注意到有时即使这样也会失败并出现 NULL 不允许的错误，而且它似乎是断断续续的。通过将 Indenty Seed 设置为 1 和`IDENTITY(1, 1) NOT FOR REPLICATION`.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-10-05T00:11:57.070

就我而言，

我试图通过需要一个外键来更新我的模型，但是数据库中已经在以前输入的数据的某些列中包含“空”数据。所以每次我运行更新数据库...我都得到了错误。

我通过从数据库中手动删除所有在我需要的列中为空的行来解决它。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-08-13T07:45:04.757

如果使用实体框架。打开迁移，设置值为 nullable: true，并更新数据库

![在此处输入图像描述](../Images/3c50dcf3e0d29f08c0dda8bf66ec6a4d.png)

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2015-06-10T10:44:20.387

您可以在 ID 列中手动插入一个值（这里我称之为“PK”）：

```
insert into table1 (PK, var1, var2)
values ((select max(PK)+1 from table1), 123, 456) 
```

# javascript - 将日期发送到 wcf 休息服务

> ID：10013314
> 
> 赞同：1
> 
> 时间：2012-04-04T14:33:52.500
> 
> 标签：javascript, .net

我通过 jquery ajax 调用从 javascript 调用 wcf rest 服务，而我的服务主体样式是裸露的。出于某种原因，我无法添加包裹的车身样式。我想将日期参数发送给服务。请一些身体帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T10:19:59.613

我不知道它是否是最好的解决方案，但通过使用 Class 和类成员 DateTime 来解决它。IE

```
Class SampleClass{
    private DateTime _sampleDate;
    public DateTime SampleDate
    {
        get
            {
                return _sampleDate;
            }
            set
            {
                _sampleDate= value;
            }
    }

} 
```

使用上述对象来传递日期。

# java - Android - 简化激进分子

> ID：10013317
> 
> 赞同：0
> 
> 时间：2012-04-04T14:33:54.060
> 
> 标签：java

我正在尝试制作一个执行二次公式的计算器。

目前，如果我的结果是小数，它会返回 NaN。（编辑：已解决）

最好我希望结果采用简化的激进形式（即 √(99) = 3√(11) ）。

我将如何实现这一目标？

这就是我到目前为止所拥有的。

```
// Do the math
private double mathCalcPlus(double varA,double varB,double varC) {
    return ((-varB + Math.sqrt(varB * varB - 4 * varA * varC)) / 2 * varA);

}

private double mathCalcMinus(double varA,double varB,double varC) {
    return ((-varB - Math.sqrt(varB * varB - 4 * varA * varC)) / 2 * varA);

} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T23:51:15.093

这很好用！但是，我决定添加激进符号的顶部栏只是为了好玩：D

```
 import java.util.Scanner;

public class Radical {

public static void main(String[] args) {

    System.out.print("Enter the unsimplified radical: ");
    Scanner scan = new Scanner(System.in);
    int input = scan.nextInt();

    recurse(input);

}

public static void recurse(int x) {

    System.out.println("                         ______");
    System.out.println("Attempting to simplify -/" + x);

    int a = 0;
    int b = 0;
    int count = 0;

    for (int i = 1; i < x; i++) {
        if ((i * (x/i)) == x) {
            //System.out.println(i + "<i rest>" + (x/i));
            a = i;
            b = x/i;
            if (Math.sqrt(a)%1==0) {
                if (a != 1) {
                System.out.println("                      ______");
                System.out.println("                   " + (int)Math.sqrt(a) + "-/" + b);
                count = 1;
                }
            }
        }
    }

    if (count>0) {
        recurse(b);
    } else if (count==0) {
        System.out.println("                  ______");
        System.out.println("Cannot simplify -/" + x);
    }

}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T18:59:02.747

就简化部首而言，这可能会有所帮助。给它一个未简化的部首（比如 850），它应该返回正确的答案（5-/34）。它还尝试递归地简化根号中剩余的内容，以防需要再次分解。

这写得很快，所以我确信我错过了一些边缘情况，这些情况会影响计算，但我希望它至少有一点帮助。祝你好运！

```
import java.util.Scanner;

public class Radical {

public static void main(String[] args) {

    System.out.print("Enter the unsimplified radical: ");
    Scanner scan = new Scanner(System.in);
    int input = scan.nextInt();

    recurse(input);

}

public static void recurse(int x) {

    System.out.println("Attempting to simplify -/" + x);

    int a = 0;
    int b = 0;
    int count = 0;

    for (int i = 1; i < x; i++) {
        if ((i * (x/i)) == x) {
            //System.out.println(i + "<i rest>" + (x/i));
            a = i;
            b = x/i;
            if (Math.sqrt(a)%1==0) {
                if (a != 1) {
                System.out.println((int)Math.sqrt(a) + "-/" + b);
                count = 1;
                }
            }
        }
    }

    if (count>0) {
        recurse(b);
    } else if (count==0) {
        System.out.println("Cannot simplify -/" + x);
    }

}

} 
```

# mobile - 使用 PhoneGap 或 Sencha 进行语音识别

> ID：10013319
> 
> 赞同：3
> 
> 时间：2012-04-04T14:33:56.657
> 
> 标签：mobile, speech-recognition

我打算使用 Sencha 2.0 作为我的移动应用程序开发平台。我打算在应用程序中使用语音识别 - 是否有一个语音识别 API 可以在 iOS 和 Android 平台上正常工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T21:13:29.833

据我所知，答案是否定的。

智能手机上的大多数语音识别应用程序都在服务器上进行语音处理。[Google 通过适用于 Android 的语音输入 API](http://android-developers.blogspot.com/2010/03/speech-input-api-for-android.html)提供内置语音识别。客户端的这个 api 将记录用户的语音，将其发送到谷歌服务器进行分析，并返回识别的文本。谷歌免费为安卓应用提供这项服务。如果您想了解它的工作原理，有些人已经对 Google 为[Chrome提供的语音识别服务进行了逆向工程。](http://mikepultz.com/2011/03/accessing-google-speech-api-chrome-11/)

今天，Apple 的 iOS 不包含类似的 API。有希望在未来他们将公开一个 API 来利用 Siri 服务器为 3rd 方应用程序，但今天他们没有。因此，要为 iPhone 构建支持语音的应用程序需要部署或签约语音识别服务。[Nuance](http://www.nuance.com/for-developers/dragon-mobile-sdk/index.htm)、[iSpeech](http://www.ispeech.org/developers)和其他公司为移动应用程序中的语音识别提供 iOS SDK。

StackOverflow 上的其他人已经讨论过使用[PocketSphinx](http://cmusphinx.sourceforge.net/wiki/tutorialpocketsphinx)作为基于客户端的语音识别引擎，但我没有这方面的经验。

虽然我猜 Sencha 或 PhoneGap 有可能为语音识别提供通用 API，但由于 iPhone 没有标准或免费的语音识别解决方案，这些框架似乎不太可能解决这个复杂的问题。也许如果 Apple 在他们的 SDK 中公开 Siri，一个客户端框架可以为 iPhone 和 Android 提供一个通用的解决方案。

# android - AnimationListener 函数（例如：onAnimationEnd）不适用于片段过渡动画

> ID：10013321
> 
> 赞同：3
> 
> 时间：2012-04-04T14:34:01.690
> 
> 标签：android, android-fragments, android-animation

我有一个包含 2 个片段的活动。我使用**setCustomAnimations**函数为片段事务添加了自定义动画。现在我想在**片段过渡动画效果**之后执行一些操作。为此，我在主 Activity 中实现了**android.view.animation.Animation.AnimationListener**接口。但是在片段转换操作之后不会调用**onAnimationEnd方法。**请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:44:11.250

您不能在这些动画上设置 AnimationListener，因为它们是使用资源标识符提供的。要设置 AnimationListener，您需要在代码中引用动画，并且能够调用 setAnimationListener 以在给定动画上实际设置 AnimationListener。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T06:05:31.277

您需要使用以下方法之一在代码中设置动画（取决于您是否使用兼容性库）：

[http://developer.android.com/reference/android/app/Fragment.html#onCreateAnimator(int](http://developer.android.com/reference/android/app/Fragment.html#onCreateAnimator(int) , boolean, int)

[http://developer.android.com/reference/android/support/v4/app/Fragment.html#onCreateAnimation(int](http://developer.android.com/reference/android/support/v4/app/Fragment.html#onCreateAnimation(int) , boolean, int)

# rdlc - 在 .rdlc 报告中显示来自数据库的图像

> ID：10013322
> 
> 赞同：-1
> 
> 时间：2012-04-04T14:34:04.033
> 
> 标签：rdlc

我有一份简单的报告，其中显示了公司信息。

在我的 sql 数据库中，我有一个 CompanyMaster 表，其中有一列**Company Logo**。在该列中，我只存储公司徽标图像的路径。

现在我想在带有公司信息的报告中显示公司徽标，

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T04:25:26.723

您可以在 rdlc 文件中使用图像控件。常见的方法是编写一个返回图像内容的 Web 服务。因此，您的图像 URL 将指向 Web 服务 URL。

你的 webservice 类需要继承 ImageHandler 如下：

```
<%@ WebHandler Language="C#" Class="ServeImage" %>

using System;
using System.Web;
using System.Drawing.Imaging;
using Microsoft.Web;
using MyControllers;

public class ServeImage : ImageHandler {

    public ServeImage()
    {
    }

    public override ImageInfo GenerateImage(System.Collections.Specialized.NameValueCollection parameters)
    {
        ImageInfo retVal = null;

        if (parameters["ID"] != null)
        {
            MyController myCntl = new MyController();
            // myCntl.GetImageFromDB returns the binary[] content from database
            retVal = new ImageInfo(myCntl.GetImageFromDB(parameters["ID"]));
        }

        return retVal;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-12T08:40:06.670

好的..我想，我应该很抱歉让你点击另一个页面。步骤的时间。

1.) EnableExternaImages=true 用于您的示例报告。

2.) 在您的报告中插入图像。将图像源设置为外部。

3.) 在“使用此图像”中输入表达式。

4.) 输入保存在数据库中的图像文件链接的值，例如。这样的表达式是：“file:///”+ First（Fields！Imagelink.Value，“DataSet1”）+“.jpeg”

5.) 重要的是您的 Imagelink 值必须是该图像的完整路径。

# 注意在链接前使用“file:///”。

6.) 任何问题请回来再问。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T13:38:04.563

1-创建文本参数

2-将图像控制添加到报告中

3-将图像设置为外部外部并将“使用此图像”设置为参数：[@ParameterName]。

4-最后在加载报告之前在后面的代码中设置参数值。

[动态设置 RDLC 报告中的图像源](https://stackoverflow.com/questions/5454972/setting-image-source-in-rdlc-report-dynamically)

# ruby-on-rails - 当我覆盖它的邮件程序时，Devise 正在发送带有空白正文的电子邮件

> ID：10013325
> 
> 赞同：5
> 
> 时间：2012-04-04T14:34:14.297
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我正在尝试覆盖 Devise 的默认邮件程序以实现一些自定义功能。设计正在发送电子邮件，但正文是空白的。我剥夺了我的自定义 Mailer 的所有功能，并使其尽可能简单，但无济于事。这是我的代码。

```
# config/initializers/devise.rb
config.mailer = DeviseMailer

# app/mailers/devise_mailer.rb
class DeviseMailer < Devise::Mailer
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T17:50:28.360

您编写的类期望其视图位于 app/views/devise_mailer/ 。如果要使用设计主体，请生成它们或将它们添加到视图路径。

# gwt - 在 GWT Web 应用程序中放置 log4j.properties 的位置

> ID：10013328
> 
> 赞同：3
> 
> 时间：2012-04-04T14:34:22.040
> 
> 标签：gwt, tomcat, ant, log4j, classpath

我在 src 下有 log4j.properties 和另一个 .properties 文件，它可以在 gwt 开发模式下部署。为了构建向 tomcat 启动的战争，我使用了一个 ant 脚本来编译 .java 类并将它们放入 JAR 文件中。JAR 文件被复制到war 文件的WEB-INF 文件夹中。

该应用程序在我不使用 log4j 时运行良好，但在我尝试使用 log4j 时找不到属性文件。我看到的所有答案都说 WEB-INF/classes，但我的项目没有 WEB-INF/classes 目录，而是复制到 WEB-INF 的 JAR 文件包含我的项目类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T17:15:51.407

您必须将 log4j.properties（或 log4j.xml）文件放入您的 servlet-container 将其视为 Classpath 中的资源的目录或 JAR 中。

因此，只需创建 WEB-INF/classes 目录并将其放在那里，或者将其打包到您的 JAR 中。

另请参阅[我应该将 log4j.properties 文件放在哪里？](https://stackoverflow.com/questions/1485987/log4j-properties-file-where-to-put-it)- 它可能很有用。

# python - 如何转义字符串中的特殊正则表达式字符？

> ID：10013329
> 
> 赞同：0
> 
> 时间：2012-04-04T14:34:22.163
> 
> 标签：python, regex, string

我`re.findall(p, text)`通常用来匹配一个模式，但现在我遇到了一个问题：

我只想`p`作为普通字符串匹配，而不是正则表达式。

例如：p 可能包含“+”或“*”，我不希望这些字符具有正则表达式中的特殊含义。换句话说，我希望 p 逐个字符地匹配。

在这种情况下`p`，我不知道，所以我不能在其中添加 '\' 以忽略特殊字符。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T14:35:44.630

您可以使用`re.escape`：

```
>>> p = 'foo+*bar'
>>> import re
>>> re.escape(p)
'foo\\+\\*bar' 
```

或者只是使用字符串操作来检查是否`p`在另一个字符串中：

```
>>> p in 'blablafoo+*bar123'
True
>>> 'foo+*bar foo+*bar'.count(p)
2 
```

顺便说一句，如果您想嵌入`p`适当的正则表达式，这主要是有用的：

```
>>> re.match(r'\d.*{}.*\d'.format(re.escape(p)), '1 foo+*bar 2')
<_sre.SRE_Match object at 0x7f11e83a31d0> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:36:26.900

如果您不需要正则表达式，而只想测试模式是否是字符串的子字符串，请使用：

```
if pattern in string: 
```

如果要在字符串的开头或结尾进行测试：

```
if string.startswith(pattern): # or .endswith(pattern) 
```

有关其他字符串方法，请参阅文档的[字符串方法](http://docs.python.org/library/stdtypes.html#string-methods)部分。

如果您需要知道字符串中子字符串的所有位置，请使用[`str.find`](http://docs.python.org/library/stdtypes.html#str.find)：

```
offsets = []
offset = string.find(pattern, 0)
while offset != -1:
    offsets.append(offset)
    # start from after the location of the previous match
    offset = string.find(pattern, offset + 1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:38:54.860

您可以`.find`在字符串上使用。这将返回“needle”字符串第一次出现的索引（或者`-1`如果它没有找到）。例如

```
>>> a = 'test string 1+2*3'
>>> a.find('str')
5
>>> a.find('not there')
-1
>>> a.find('1+2*')
12 
```

# asp.net - 将表插入使用 JQuery 创建的 Trirand JQGrid 编辑对话框

> ID：10013330
> 
> 赞同：0
> 
> 时间：2012-04-04T14:34:24.857
> 
> 标签：asp.net, jqgrid, jqgrid-asp.net

我有一个 JQuery 和 AJAX 函数，它创建一个带有 2 个列表框和按钮的表，用于从一个列表框添加/删除到另一个列表框。我想将此表插入到 JQGrid 的编辑对话框中。这样，当单击添加或编辑按钮时，表格将显示，用户可以添加项目并编辑相应的单元格。

Java 脚本和 AJAX：

```
function create_listbox() {

    var html = '<select id="ddlRoles" size="7" multiple></select>';
    var selected = '<select id="ddlSelectedRoles" size="7" multiple></select>';
    var table = '<table id="table1" border="3"></table>';
    var tr = '<tr id="tr1"></tr>';
    var td1 = '<td id="td1"></td>';
    var td2 = '<td id="td2"></td>';
    var td3 = '<td id="td3"></td>';
    var addButton = '<button id="add" onclick="addRole()">Add Role</button><br>';
    var removeButton = '<button onclick="removeRole()">Remove Role</button><br>';

    $('#whatever').append(table);
    $('#table1').append(tr);
    $('#tr1').append(td1);
    $('#tr1').append(td2);
    $('#tr1').append(td3);
    $('#td1').append(html);
    $('#td2').append(addButton);
    $('#td2').append(removeButton);
    $('#td3').append(selected);

    $.ajax({
        url: "MyApplication.asmx/GetRoles",
        data: "{ }",
        dataType: "json",
        type: "POST",
        contentType: "application/json; charset=utf-8",
        dataFilter: function (data) { return data; },
        success: function (data) {
            //                  alert(data.d);
            for (var i = 0; i < data.d.length; i++) { 
                $('#ddlRoles').append("<option value=\"" + data.d[i].RoleID + "\">" + data.d[i].RoleName + "</option>")
            }
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
            alert(textStatus + ":" + errorThrown);
        }
    });

} 
```

我知道我需要一个 EditTypeCustomElement 和 EditTypeGetCustomValue 但我完全不知道如何实现这一点。

我尝试使用添加表的 create_listbox 函数返回 $table.get(0) ，但它不添加子元素。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T20:52:54.340

您需要一个 EditTypeCustomElement（如下）JQuery 和 Ajax：

```
function create_listbox(value, options) {

    var htmlRolesDdl = '';
    var htmlRolesSelectedDdl = '';

    $.ajax({
        url: "MyApp.asmx/GetRoles",
        data: "{ }",
        dataType: "json",
        type: "POST",
        contentType: "application/json; charset=utf-8",
        dataFilter: function (data) { return data; },
        success: function (data) {
            var roles = new Array();
            if (value.toString().match(',') == null) roles.push(value.toString());
            else roles = value.toString().split(",")

            for (var i = 0; i < data.d.length; i++) {

                var isMatch = false;
                for (var j = 0; j < roles.length; j++) {
                    if (data.d[i].RoleName == roles[j].toString()) {
                        htmlRolesSelectedDdl += "<option id=\"option" + data.d[i].RoleID + "\"" + " value=\"" + data.d[i].RoleID + "\">" + data.d[i].RoleName + "</option>";
                        //$selected.append("<option id=\"option" + data.d[i].RoleID + "\"" + " value=\"" + data.d[i].RoleID + "\">" + data.d[i].RoleName + "</option>")
                        isMatch = true;
                    }
                }

                if (!isMatch) {
                    htmlRolesDdl += "<option id=\"option" + data.d[i].RoleID + "\"" + " value=\"" + data.d[i].RoleID + "\">" + data.d[i].RoleName + "</option>"
                    //$listbox.append("<option id=\"option" + data.d[i].RoleID + "\"" + " value=\"" + data.d[i].RoleID + "\">" + data.d[i].RoleName + "</option>")
                }
            }
        },
        async: false,            
        error: function (XMLHttpRequest, textStatus, errorThrown) {
            alert(textStatus + ":" + errorThrown);
        }
    });

    var html = '<table id="UserRole" border="0">';
    html += '<tr>';
    html += '<td>';
    html += '<select id="ddlRoles" size="7" multiple width="155" style="width:155px;">';
    html += htmlRolesDdl;
    html += '</select>';
    html += '</td>';
    html += '<td>';
    html += '<button onclick="addRole()" style="width:100px;">  Add >></button><br>';
    html += '<button onclick="removeRole()" style="width:100px;"><< Remove</button><br>';
    html += '</td>';
    html += '<td>';
    html += '<select class="ListBoxStyle" id="ddlSelectedRoles" size="7" width="155" multiple style="width:155px;">';
    html += htmlRolesSelectedDdl;
    html += '</select>';
    html += '</td>';
    html += '</tr>';
    html += '<tr>';
    html += '<td colspan="3" align="center" style="padding-top:5px;padding-bottom:10px;">';
    html += '(Press and Hold "Ctrl" to select multiple roles)';
    html += '</td>';
    html += '</tr>';
    html += '</table>';

    return $(html);
} 
```

和一个 EditTypeGetCustomValue（下）JQuery 和 AJAX：

```
function listbox_value(elem, type, stringvalue) {
    if (type == 'get') {
        var roles = new Array();
        $("#ddlSelectedRoles > option").each(function () {
            roles.push($(this).val().toString());
        });

        return roles.toString();

    } else if (type == 'set') {
        var roles = new Array();
        $("#ddlSelectedRoles > option").each(function () {
            roles.push($(this).val().toString());
        });

        $("#<%= hdnSelectedRoles.ClientID %>").val(roles);

        return roles.toString();
    }

} 
```

# jsf - 如何在从调用的方法中通过另一个bean的对象传递参数

> ID：10013343
> 
> 赞同：0
> 
> 时间：2012-04-04T14:35:08.023
> 
> 标签：jsf, jsf-2

如何在调用 from 的方法中通过另一个 bean 的对象传递参数`<f:event listener="...">`？

我正在尝试在`showData()`要调用的方法中传递由另一个 bean 生成的参数

```
<f:event listener="#{myTransformerBeans.showData}"> 
```

参数将是`#{myDataBean.myId}`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:46:55.207

你也可以试试

```
<f:event listener="#{myTransformerBeans.showData(myDataBean.myId)}"> 
```

# javascript - 输入框之间的计算

> ID：10013344
> 
> 赞同：0
> 
> 时间：2012-04-04T14:35:14.763
> 
> 标签：javascript

我正在编写一个脚本，我需要得到两个计算的总数并确定总报价。问题是在将它们加在一起时我无法让它们工作。请记住，我是新手，代码可能没有完全优化，但我相信你会明白的。对代码的任何改进都非常受欢迎。

```
<div>
        <fieldset>
            <legend>Printing</legend>
        Number of color pages:<input type="text" id="color" placeholder="Color Pages" onchange="printing();" onchange = "binding();" />
        <input type="text" id="colorprice" readonly="readonly" /><br />
        Number of black and white pages:<input type="text" id="black" placeholder="Black and White Pages" onchange="printing();" onchange = "binding();" />
        <input type="text" id="blackprice" readonly="readyonly" /><br />
        Total Pages:<input type="text" id="pages_total" readonly="readonly" /> <input type="text" id="sum_pages" readonly="readonly" onchange = "suming();"/>
        </fieldset>

    </div>

<div>
        <fieldset>
            <legend>Binding</legend>
            Number of Hardbooks: <input type="text" id="books" placeholder="Number of Hardbooks" onchange="binding();" />
            <input type="text" id="books_price" readonly="readonly" /><br />
            Number of Softbacks: <input type="text" id="softback" placeholder="Number of Softbacks" onchange="binding();" />
            <input type="text" id="soft_price" readonly="readonly" /><br />
            Total Bindings: <input type="text" id="total_bindings" readonly="readonly" /><input type "text" id="total_price" readonly="readonly" />
        </fieldset>
    </div>

<p>Final quote:<input type="text" readonly="readonly" id="quote" /></p>

function printing() {
                var blackPrice;
                var colorPrice;
                var printBlack = new Array(0.10, 0.08, 0.06, 0.05);
                var printColor = new Array(0.40, 0.35, 0.30, 0.25);

                var colorPages = parseInt(document.getElementById("color").value);
                var blackPages = parseInt(document.getElementById("black").value);

                if (colorPages < 11) {
                colorPrice = colorPages * printColor[0];
                    }
                else if (colorPages >= 11 && colorPages < 51){
                colorPrice = colorPages * printColor[1];
                    }
                else if (colorPages >= 51 && colorPages < 101){
                    colorPrice = colorPages * printColor[2];
                    }
                else {
                    colorPrice = colorPages * printColor[3];
                    }

                if (blackPages < 11) {
                blackPrice = blackPages * printBlack[0];
                    }
                else if (blackPages >= 11 && colorPages < 51){
                blackPrice = blackPages * printBlack[1];
                    }
                else if (blackPages >= 51 && colorPages < 101){
                blackPrice = blackPages * printBlack[2];
                    }
                else {
                blackPrice = blackPages * printBlack[3];
                    }

                var pagesTotal = colorPages + blackPages;

                var printSum = blackPrice + colorPrice;

                document.getElementById("colorprice").value = "$" + colorPrice.toFixed(2);
                document.getElementById("blackprice").value = "$" + blackPrice.toFixed(2);
                document.getElementById("sum_pages").value = "$" + printSum.toFixed(2);
                document.getElementById("pages_total").value = pagesTotal;

                return printSum;

}

function binding(){

var softbackPrice;
var hardbookPrice;
var hardBooks = new Array(37.50, 23.50);
var softBacks = new Array(3.75, 4.00, 4.25, 4.50, 4.75, 5.00, 5.25);
var noBooks = parseInt(document.getElementById("books").value); 
var noSoftBacks = parseInt(document.getElementById("softback").value); 
var colorPages = parseInt(document.getElementById("color").value);
var blackPages = parseInt(document.getElementById("black").value);
var totalPages = colorPages + blackPages;

if (noBooks == 1) { 
    hardbookPrice = hardBooks[0];
    }
else {
        hardbookPrice = (hardBooks[1] * (noBooks - 1)) + hardBooks[0];
    }

if (totalPages <= 50) {
    softbackPrice = softBacks[0] * noSoftBacks;
    }
else if (totalPages > 50 && totalPages <= 100) {
    softbackPrice = softBacks[1] * noSoftBacks;
    }
else if (totalPages > 100 && totalPages <= 150) {
    softbackPrice = softBacks[1] * noSoftBacks;
    }
else if (totalPages > 150 && totalPages <=200) {
    softbackPrice = softBacks[2] * noSoftBacks;
    }
else if (totalPages > 200 && totalPages <= 250) {
    softbackPrice = softBacks[3] * noSoftBacks;
    }
else if (totalPages > 250 && totalPages <= 300) {
    softbackPrice = softBacks[4] * noSoftBacks;
    }
else if (totalPages > 300 && totalPages <= 350) {
    softbackPrice = softBacks[5] * noSoftBacks;
    }
else {
    softbackPrice = softBacks[6] * noSoftBacks;
}   

var totalPrice = softbackPrice + hardbookPrice;
var bindingsTotal = noSoftBacks + noBooks;

document.getElementById("books_price").value = "$" + hardbookPrice.toFixed(2);
document.getElementById("soft_price").value = "$" + softbackPrice.toFixed(2);
document.getElementById("total_bindings").value = bindingsTotal;
document.getElementById("total_price").value = "$" + totalPrice.toFixed(2);

return totalPrice;

}

function totalSum() {
var totalPrinting = printing();
var totalBinding = binding();
var subtotal = totalPrinting + totalBinding;
document.getElementIdBy("quote").value = subtotal;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:45:00.717

它对我有用（大部分）：http: [//jsfiddle.net/UHnRL/](http://jsfiddle.net/UHnRL/)

第一次计算有问题`onchange`，因为其他页数是`NaN`在您执行`parseInt`. 如果文本框为空白，则应将其默认为零。

您可以使用`isNaN`*^([[MDN]](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/isNaN))*函数来解决计算问题：

```
var colorPages = parseInt(document.getElementById("color").value);
var blackPages = parseInt(document.getElementById("black").value);

if (isNaN(colorPages))
{
    colorPages = 0;
}

if (isNaN(blackPages))
{
    blackPages = 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:04:04.420

这是工作解决方案。[http://jsfiddle.net/UHnRL/2/](http://jsfiddle.net/UHnRL/2/)

`=`以下标记中的类型缺失

```
<input type "text" id="total_price" readonly="readonly" /> 
```

# java - Element::textContent 和 NodeList::item::getNodeValue 之间的区别

> ID：10013347
> 
> 赞同：1
> 
> 时间：2012-04-04T14:35:17.307
> 
> 标签：java, xml, xml-parsing, xmldom

我是 XML 新手，并且有一个带有根标签和子标签的 XML 文件。对于子标签名称“Phone”之一，我使用 DOM API 在 Java 中实现了以下实现。我的问题是代码的最后两行打印相同的结果。在一种情况下，我使用 Element 检索内容，而在另一种情况下，它由 NodeList 函数 getNodeValue 检索。

```
NodeList phoneNodeList = document.getElementsByTagName("Phone");
Node firstPhoneNode = phoneNodeList.item(0);
System.out.println (phoneNodeList.getLength());
Element phoneNodeElement = (Element) firstPhoneNode;
NodeList phoneList = phoneNodeElement.getElementsByTagName("Type");
Element phoneTypeElement = (Element) phoneList.item(0);
NodeList phoneType = phoneTypeElement.getChildNodes();
System.out.println ("NodeName : " + phoneTypeElement.getNodeName());
System.out.println ("Text Content : " + phoneTypeElement.getTextContent());
System.out.println ("Phone : " + phoneType.item(0).getNodeValue()); 
```

Phone 标签实现在 XML 中看起来像这样

```
<Phone>
<Type>work</Type>
<Value>2222</Value>
</Phone>

<Phone>
</Phone>

<Phone>
</Phone>

<Phone>
<Type>mobile</Type>
<Value>1111</Value>
</Phone> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:16:05.990

元素中的文本`<Type>`本身就是 a `Node`，类型为`TEXT`，其值为`mobile`。这就是 DOM 的工作原理。此页面解释更多：[http ://docs.oracle.com/javase/tutorial/jaxp/dom/when.html](http://docs.oracle.com/javase/tutorial/jaxp/dom/when.html)

# javascript - 如何编写具有清晰表示的JS文件？

> ID：10013352
> 
> 赞同：0
> 
> 时间：2012-04-04T14:35:35.393
> 
> 标签：javascript, code-formatting

问题是我有一个非常大的 JS 文件，有 5.000 多行代码，其中包含几个对象（一些从其他对象继承）、函数等。

但是如果你试图找到一些东西，你需要很多时间，因为它太大了，我的 IDE (Netbeans) 并没有真正足够清楚地表示它。即导航对JS的支持不是很好，会合并同名的变量，虽然它们是局部变量并且出现在不同的对象中。

我真的不想把它分成很多文件（即每个对象一个），因为我必须在实时服务器上再次合并它们。

你如何构建你的 JS 文件？你有没有找到一个很好的命名方案或什么的？

**更新：**

到目前为止，我发现，拆分成多个文件是个好主意......你如何命名你的文件？你怎么组织他们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:38:26.150

我建议将其拆分为许多较小的、可维护的文件，然后在生产中使用[SquishIt](https://github.com/jetheredge/SquishIt)（或类似的，取决于您的服务器端语言）来缩小脚本并将其连接回单个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:38:43.707

我的设置对每个对象都有单独的文件。这对我来说是理想的，因为它使查找东西变得非常容易。

拥有一个简单的“构建”脚本也很容易，它以正确的顺序将所有文件连接在一起。我还让我的脚本通过[Closure Compiler](http://code.google.com/p/closure-compiler/)运行连接文件，这会造成无法阅读的混乱，但会将我的脚本压缩到原始大小的 1/3 左右。

在我看来，制作一个“构建”脚本以获得单独文件的所有清晰度是值得的。

**编辑：**

这样做的另一个好处是我有两个版本的脚本。连接的“调试”版本是人类可读的，而缩小的“生产”版本绝对不是。

当我尝试时，页面链接了可读版本；当它上线时，页面会链接缩小版本以加快加载速度（并且可读性不再重要）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:39:58.880

我不会迷失在我的 .JS 文件中的唯一方法是用 3 行这样的注释来分隔每个函数/对象：
/ *-------- ------------------------------------* // *------------*
_ *----第 BC-204 节*
---- // *------------------------ -------------------------------------------* /

我看到的另一种方式是，正如您所说的将它们分成不同的文件，但即使在那里，浏览所有文件仍然很痛苦。

# c++ - 查看 Win32 消息

> ID：10013367
> 
> 赞同：1
> 
> 时间：2012-04-04T14:36:18.863
> 
> 标签：c++, c, winapi

大家好，我是 windows32 编程的新手，我有几个问题-：

当我在程序中使用以下代码时，它可以正常工作-：

```
while(GetMessage(&msg,NULL,0,0))
  {
    TranslateMessage(&msg);                                  
    DispatchMessage(&msg);  
} 
```

但是，当我将 GetMessage 的 null 替换为 hwnd（刚刚创建的窗口的句柄）时，似乎并没有关闭它仍然在后台运行。为什么当我用 hwnd 替换 NULL 时会发生这种情况，这意味着我只接收一个窗口的消息，那么为什么它不起作用？？？？

```
while(GetMessage(&msg,hwnd,0,0))
  {
    TranslateMessage(&msg);                                  
    DispatchMessage(&msg);  
} 
```

顺便说一句，windows功能是-：

```
LRESULT CALLBACK WinProc(HWND hWnd, UINT message,
                              WPARAM wparam, LPARAM lparam){

    switch(message){
                case WM_DESTROY:
                     PostQuitMessage(0);
                     break;
                default:
                return DefWindowProc(hWnd, message, wparam, lparam);
                }
    return 0;
} 
```

第二-：

有什么办法可以看到发送到任何特定窗口的所有消息？？？？

第三——：

编译我的 Windows 程序时编写 __stdcall(WINAPI) 的原因是什么？？？？

快速回复将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:42:48.677

1.  `GetMessage`仅当它接收到 a 时才返回`0`（使循环结束）`WM_QUIT`，但 a`WM_QUIT`不与任何特定窗口相关联，因此如果您有 a`GetMessage`只询问某个特定的消息，则永远不会收到它`hWnd`。

2.  如果它是您的窗口，您已经在它们的窗口过程中看到它们；如果您想在将它们分派到它们的窗口过程之前过滤它们，您可以在调用之前检查`msg`填充的结构。`GetMessage``DispatchMessage`

3.  整个 Windows API 使用`stdcall`调用约定（我认为是因为它比通常的更快/产生的样板代码更少`cdecl`），因此您的回调也必须遵循该调用约定。请注意，您必须仅在由 Windows API 函数调用的函数上使用`WINAPI`(ie )，而对于其他函数，您可以自由使用您最喜欢的任何调用约定。`stdcall`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:38:16.410

`PostQuitMessage`生成`WM_QUIT`由消息队列处理，但不与特定窗口关联的消息。通过仅过滤`hwnd`呼叫中的消息`GetMessage`，您无需处理`WM_QUIT`.

关于查看发送到窗口/线程/进程的所有消息，请参阅[https://stackoverflow.com/questions/4038730/i-am-looking-for-a-windows-spy-application](https://stackoverflow.com/questions/4038730/i-am-looking-for-a-windows-spy-application)

最后，关于`__stdcall`，请参阅[main 函数中的“WINAPI”是什么意思？](https://stackoverflow.com/questions/2348442/winapi-main-function)

# java - 快速多线程在线处理应用框架建议

> ID：10013369
> 
> 赞同：0
> 
> 时间：2012-04-04T14:36:29.120
> 
> 标签：java, spring

我正在寻找一种模式和/或框架，它可以以一种易于配置的方式对以下问题进行建模。

每说 3 分钟，我需要在 Web 应用程序上下文中启动一组作业，这些作业将同时访问 Web 服务以获取最新版本的数据，并将其推送到数据库。问题是数据库将被大量用于读取数据以对数据进行大量复杂的计算。我们目前正在使用 Spring，所以我一直在寻找 Spring Batch 来运行这个过程。有人对使用 Spring 或类似系统的其他技术有任何建议/模式/示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:43:22.357

当我们需要进程重复运行时，我们使用 ServletContextlisteners 在我们的 Web 应用程序中启动 TimerTasks。ServletContextListener 在应用服务器启动应用程序或应用程序重新启动时启动。然后，计时器任务就像一个单独的线程，在指定的时间段内重复您的代码。

ServletContextListener [http://www.javabeat.net/examples/2009/02/26/servletcontextlistener-example/](http://www.javabeat.net/examples/2009/02/26/servletcontextlistener-example/)

TimerTask [http://enos.itcollege.ee/~jpoial/docs/tutorial/essential/threads/timer.html](http://enos.itcollege.ee/~jpoial/docs/tutorial/essential/threads/timer.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:55:01.490

是否有可能将 Web 应用程序中的工作重构为独立应用程序？

这样，您可以将批处理作业粘贴到单独的批处理服务器上（这样批处理作业的额外负载不会影响您的 Web 应用程序），然后调用 Web 服务并更新数据库。然后可以使用 cron 或 Autosys 之类的东西来开始这项工作。

我们正是为此目的使用 Spring-Batch。

数据库设计还取决于批处理数据的用途。如果是出于报告目的，我建议将操作数据库与报告数据库分开，使用数据库链接将所需数据从操作数据库获取到报告数据库中，然后在报告数据库上运行复杂查询。这样，负载就会从操作数据库中转移出去。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T08:51:00.677

我认为还值得研究像[camel-integration](http://camel.apache.org)这样的框架。还要看看所谓的**企业集成模式**。检查[目录](http://camel.apache.org/enterprise-integration-patterns.html)- 它可能为您提供一些有用的词汇来思考手头的缩放/调度问题。

该框架本身与 Spring 集成得非常好。

# url - 获取在 Liferay 中工作的友好网址

> ID：10013370
> 
> 赞同：5
> 
> 时间：2012-04-04T14:36:33.030
> 
> 标签：url, liferay, portlet

我想在 liferay 中为我的 JSR-268 Portlet 启用友好的 url。

我在[http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/FriendlyURLMapper](http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/FriendlyURLMapper)中告诉我配置了友好的 url 映射器，但不知何故这对我不起作用。

我错过了什么？

我的`liferay-portlet.xml`样子是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE liferay-portlet-app PUBLIC "-//Liferay//DTD Portlet Application 6.1.0//EN"     "http://www.liferay.com/dtd/liferay-portlet-app_6_1_0.dtd">
<liferay-portlet-app>
<portlet>
    <portlet-name>content</portlet-name>
    <friendly-url-mapper-class>com.liferay.portal.kernel.portlet.DefaultFriendlyURLMapper</friendly-url-mapper-class>
    <friendly-url-mapping>content</friendly-url-mapping>
    <friendly-url-routes>com/gentics/cr/portlet/content-url-routes.xml</friendly-url-routes>
    <instanceable>true</instanceable>
</portlet>
<portlet>
    <portlet-name>navigation</portlet-name>
    <icon>/icon.png</icon>
    <instanceable>true</instanceable>
</portlet>
<portlet>
    <portlet-name>search</portlet-name>
    <icon>/icon.png</icon>
    <instanceable>true</instanceable>
    <!-- header-portlet-css>/css/test.css</header-portlet-css>
    <footer-portlet-javascript>/js/test.js</footer-portlet-javascript-->
</portlet>
<!--role-mapper>
    <role-name>administrator</role-name>
    <role-link>Administrator</role-link>
</role-mapper>
<role-mapper>
    <role-name>guest</role-name>
    <role-link>Guest</role-link>
</role-mapper>
<role-mapper>
    <role-name>power-user</role-name>
    <role-link>Power User</role-link>
</role-mapper>
<role-mapper>
    <role-name>user</role-name>
    <role-link>User</role-link>
</role-mapper-->
</liferay-portlet-app> 
```

我的`content-url-routes.xml`样子是这样的：

```
<?xml version="1.0"?>
<!DOCTYPE routes PUBLIC "-//Liferay//DTD Friendly URL Routes 6.0.0//EN" "http://www.liferay.com/dtd/liferay-friendly-url-routes_6_0_0.dtd">

<routes>
<route>
    <pattern>/content/{contentid}</pattern>
</route>
<!-- route>
    <pattern>/{instanceId}/search/{filter}</pattern>
    <implicit-parameter name="do">search</implicit-parameter>
</route>
<route>
    <pattern>/{instanceId}/search/{filter}/{start}</pattern>
    <implicit-parameter name="do">search</implicit-parameter>
</route-->
</routes> 
```

portlet 中呈现的 url 仍然是：`http://localhost:8080/web/guest/home?p_auth=Yu81QQrj&p_p_id=content_WAR_genticsportlet_INSTANCE_R2HSaoL5RkHi&p_p_lifecycle=1&p_p_state=normal&p_p_mode=view&p_p_col_id=column-2&p_p_col_count=1&_content_WAR_genticsportlet_INSTANCE_R2HSaoL5RkHi_contentid=10007.33`

该 URL 是使用以下代码创建的：

```
PortletURL actionURL = response.createActionURL();
actionURL.setParameter("contentid", "10007.33"); 
```

如果您能指出我正确的方向，那就太好了...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T14:48:25.987

您的路线应该从已生成 URL的一部分之后`content`的部分开始。`content`该值`<friendly-url-mapping>content</friendly-url-mapping>`用于此目的。

```
<route>
    <pattern>/{contentid}</pattern>
</route> 
```

此外，请务必将 DTD 更改为`*-url-routes.xml`.

```
<!DOCTYPE routes PUBLIC "-//Liferay//DTD Friendly URL Routes 6.1.0//EN" "http://www.liferay.com/dtd/liferay-friendly-url-routes_6_1_0.dtd"> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T07:21:35.073

继 Adarshr 之后回答了您还可以通过创建自己的扩展 DefaultFriendlyURLMapper 并覆盖方法 isCheckMappingWithPrefix 的类来摆脱 /-/ 部分，这样您就可以得到：

```
@Override
public boolean isCheckMappingWithPrefix() {     
    return false;
} 
```

因此，您的 URL 将只是`[http://community_name.com/web/group_name/page_name/content/contentId](http://community_name.com/web/group_name/page_name/content/contentId)`. 然后你在friendly-url-mapper-class 标签中设置你的类。您可以在 GitHub 上的这个 portlet 项目中看到一个示例：

`[https://github.com/DevJonny/Liferay-6-Friendlier-Friendly-URL-Mapper](https://github.com/DevJonny/Liferay-6-Friendlier-Friendly-URL-Mapper)`

~~编辑~~

感谢 Prakash 指出旧链接不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T10:06:12.797

我通过使用删除了除 p_auth 和我的 javax.portlet.action 之外的所有参数

```
<pattern>/myportlet</pattern>
<ignored-parameter name="p_p_lifecycle" />
<ignored-parameter name="p_p_state" />
<ignored-parameter name="p_p_mode" /> 
```

生命周期、状态和模式从 url 中消失。但无法删除 p_auth 和 URL 的其余部分：

# c++ - 以双精度获取第一个数字并将其存储在 int C++ 中

> ID：10013374
> 
> 赞同：0
> 
> 时间：2012-04-04T14:36:55.153
> 
> 标签：c++, int, double, static-cast

你好，我在 C++ 中进行编码，我需要一些帮助来将 double 转换为 int。需要一种从双精度即（3.5945）“3”中获取第一个数字的方法。并将该数字放入一个 int 中。

我现在正在使用 static_cast 并且它返回一个 0。

```
double X = 3.1234;
double Y = 4.3455;

int myIntX =  static_cast <int>(X);
int myIntY =  static_cast <int>(Y);

cout << myIntX << endl;
cout << myIntY << endl; 
```

输出....

0 0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-12T02:54:56.177

试试这个：

```
double x=3.1234;
int myintx=(int)x;

while(myintx%10!=0)
myintx/=10;

cout<<myintx; 
```

这将为您提供作为 int 的 double 的第一个数字。

# c++ - 将 _bstr_t com 属性分配给 LPCTSTR 是否安全？

> ID：10013388
> 
> 赞同：2
> 
> 时间：2012-04-04T14:38:01.643
> 
> 标签：c++, string, com

我遇到了一些将 LPCTSTR 分配给 _bstr_t 的代码。由于 BSTR 确实根据 MSDN 提供了长度信息，而常见的 TCHAR 指针不提供我不确定以下代码是否安全。我没有发现有一个重载运算符可以安全地实现这一点的线索，但是这似乎可以正常工作而没有任何明显的错误，但它可能是未定义的行为。

例子：

```
// pComObject->Property is of type _bstr_t
pComObject->Property = (LPCTSTR) string; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:42:11.527

是的，`_bstr_t`有一个[operator=](http://msdn.microsoft.com/en-us/library/7bh2f8sk.aspx)接受一个以 NULL 结尾的字符串（宽字节和多字节），所以这是安全的

# sql - 如何在数据库中搜索特定字段

> ID：10013389
> 
> 赞同：2
> 
> 时间：2012-04-04T14:38:05.860
> 
> 标签：sql, database, delphi

我希望用户能够从列出数据库的一些字段的下拉组合框中进行选择，然后在下面输入搜索词，然后所有符合查询的结果都显示在 dbgrid 中。我不确定如何将 ComboBox 的当前值链接到 sql 语句中。我试过用这个

```
begin
    with ADOQuery do begin
      Close;
      SQL.Clear;
      SQL.Add ('SELECT * FROM List WHERE combobox1.text =' +   QuotedStr (Asearchterm.Text));
      Open; 
```

它不起作用。我得到的错误是“参数 combobox1.text 没有默认值”。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:43:15.910

如果您想使用 combobox1 文本值作为 sql 语句的一部分，您可以按照以下行设置 sql 字符串

```
'SELECT * FROM List WHERE [' + combobox1.text + '] = ''' + QuotedStr(Asearchterm.Text) + '''' 
```

可能是您正在寻找的。我在 QuotedStr 周围添加了额外的引号，因为我猜测过滤器并不总是数值。这将适用于数字和非数字值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:43:19.233

而不是 'combobox1.text' 你必须输入你正在寻找的实际列名。您可以使用`LIKE`关键字和一些通配符。就像是：

```
SELECT * FROM 'table WHERE 'column' LIKE '%YOUR_SEARCH_TEXT%'; 
```

那是为了搜索......如果你想找到确切的字符串，那么你必须使用`=`运算符而不是 LIKE

[更多信息在这里](http://www.techonthenet.com/sql/like.php)

# html - HTML5 拖放输入

> ID：10013391
> 
> 赞同：1
> 
> 时间：2012-04-04T14:38:10.493
> 
> 标签：html, drag-and-drop, textinput

我正在试验 HTML5，使 html 元素可拖动。它适用于按钮，但不适用于文本输入，完全相同的代码。这有什么原因吗？它调用了dragstart hadnler，但是在它调用dragend处理程序之后，它甚至没有开始按钮本身仅适用于Chrome，但输入类型文本根本不起作用。

（一个工作是按钮元素，而不是输入类型按钮或提交）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T07:03:31.833

DnD 不适用于 Firefox 上的按钮。你可以让它在文本输入上工作，Firefox 中的标签，但它不能在 chrome 中工作。

# android - Android Phonegap 屏幕旋转锁定杀死了我的应用

> ID：10013392
> 
> 赞同：1
> 
> 时间：2012-04-04T14:38:11.237
> 
> 标签：android, cordova, screen-orientation

我的应用程序有问题，我添加了一个必须防止屏幕旋转的清单，但是当我旋转屏幕时它会杀死应用程序。

这是我的代码：

```
public class avantdroidActivity extends DroidGap {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {       
    super.onCreate(savedInstanceState);
    //setContentView(R.layout.main);
    super.clearCache();        
    super.loadUrl("file:///android_asset/www/redir.html");      
}
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
}
} 
```

我的 AndroidManifest.Xml：

```
<activity android:name="org.apache.cordova.DroidGap" android:label="@string/app_name" android:configChanges="keyboard|orientation|keyboardHidden"> <intent-filter> </intent-filter> </activity> 
```

我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T15:13:23.207

你为什么打电话？

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); 
```

你可以在你的 AndroidManifest 中设置你的活动方向。只需添加`android:screenOrientation="portrait"`到您的`activity`标签。

# java - 不可变集合实现

> ID：10013393
> 
> 赞同：3
> 
> 时间：2012-04-04T14:38:15.060
> 
> 标签：java, collections, immutability

我有一个关于不可变集合的一般性问题。我将使用 Java 作为我最了解的参考语言。

首先，是否有确保不变性的通用方法？我的意思是是否应该复制整个集合，进行更改然后返回新对象？有没有更复杂、更通用的方法？

更进一步，“明显的”（对我而言）可变集合（例如树）呢？通常它们被实现为具有 N 个子节点的节点。在这种情况下，您将如何保证不变性？递归地克隆和复制所有引用？

根据上述内容，我想知道这些集合的最佳方法是什么：

1.  列表 - 基于数组的列表，我们会在进行更改之前复制它吗？
2.  队列 - 前后两个数组，在返回之前克隆？那么基于波特的实现呢？
3.  树木
4.  Hashmap - 复制桶数组，以及所有的冲突列表？
5.  放

非常感谢您的回复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T14:42:40.903

令人高兴的是，已经为您完成了大部分工作，请查看具有[ImmutableCollection](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableCollection.html)、[ImmutableList](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableList.html)、[ImmutableSet](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableSet.html)、[ImmutableMap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableMap.html)等的[google guava 。](http://code.google.com/p/guava-libraries/)

通过防止这些类的子类（通过使它们成为最终的，或使它们的构造函数私有）来确保不变性。

当您从可变集合创建不可变集合时，将复制可变集合中的数据，然后不允许所有突变操作 - 它们将引发异常（`UnsupportedOperationException`例如）。

出于性能原因，如果不需要，guava 库会尽量不复制数据。例如，如果您已经有一个`ImmutableMap`, 并用 新建一个`ImmutableMap.copyOf(theOtherImmutableMap)`，则不会复制任何数据，因为我们已经知道另一个映射是不可变的，因此可以对同一数据进行两次引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:46:56.023

就 Java 而言，Collections 实用程序类是您的朋友。我建议不要手动执行这些操作，而是使用给定的 API。特别注意不可变和不可修改的方法。

例如，就不可变而言，有：

```
<T> List<T>
emptyList() 
          Returns the empty list (immutable).
static
<K,V> Map<K,V>
emptyMap() 
          Returns the empty map (immutable).
static
<T> Set<T>
emptySet() 
          Returns the empty set (immutable). 
```

对于不可修改的，您有：

```
static
<T> Collection<T>
unmodifiableCollection(Collection<? extends T> c) 
          Returns an unmodifiable view of the specified collection.
static
<T> List<T>
unmodifiableList(List<? extends T> list) 
          Returns an unmodifiable view of the specified list.
static
<K,V> Map<K,V>
unmodifiableMap(Map<? extends K,? extends V> m) 
          Returns an unmodifiable view of the specified map.
static
<T> Set<T>
unmodifiableSet(Set<? extends T> s) 
          Returns an unmodifiable view of the specified set.
static
<K,V> SortedMap<K,V>
unmodifiableSortedMap(SortedMap<K,? extends V> m) 
          Returns an unmodifiable view of the specified sorted map.
static
<T> SortedSet<T>
unmodifiableSortedSet(SortedSet<T> s) 
```

您可以在下面实施其他策略和一些策略，但我将从那里开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:29:57.720

我假设您的意图是了解不可变集合如何在函数式语言（如 haskell 等）的框架内工作。这个想法是所有集合都是不可变的和最终的，从而避免了关于可变性、同步等的所有多线程陷阱，但仍然允许您添加、删除和修改，就好像它们是可变的一样

我见过的最好的例子是[Clojure](http://clojure.org/)的源代码。它是一种类似于 lisp 的语言，因此将不可变集合作为核心特性来处理。我强烈建议您查看如何在 clojure 中实现集合，因为它们一定会回答您的许多问题。可能有些事情太复杂了（我仍然几乎不理解***try***）。看到[这里](http://www.infoq.com/articles/in-depth-look-clojure-collections)，祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-06T14:12:01.123

Clojure 包含这样的不可变（或持久）[集合](http://clojure.org/data_structures?responseToken=0920a89c78e77e630e53610649600c4ae)。

它提供了您所追求的所有集合，并支持通过构造进行突变：简单地说，添加或删除新元素会返回一个新集合，通常通过巧妙*地*使用 Trie 类型的数据结构重用旧集合的大部分.

就其本身而言，它们不适合在纯 Java 中使用——它们被设计为在 Clojure 中使用。

[Pure4j](https://github.com/robmoffat/pure4j)尝试将这些（以及 Clojure 提倡的基于不可变/基于值的风格）移植到 Java 语言。这可能是你所追求的。

*免责声明：我是 Pure4J 的开发者*

# jquery - IE7在jQuery Slider中堆叠左浮动div

> ID：10013401
> 
> 赞同：0
> 
> 时间：2012-04-04T14:38:32.197
> 
> 标签：jquery, css, slider, internet-explorer-7

我正在为我下载的模板使用内容滑块。在所有现代浏览器中，我几乎都得到了我想要的。现在我正在尝试一些跨浏览器测试，我在 ie7 中遇到了一个错误，它堆叠项目而不是在屏幕上浮动并隐藏它们。

这是我的网站：

[http://dl.dropbox.com/u/62054561/Rust%20Website/index.html](http://dl.dropbox.com/u/62054561/Rust%20Website/index.html)

但这是它在 IE7 中的外观：

![http://dl.dropbox.com/u/62054561/ie7.png](../Images/8f3657898c15d567e5b6b1306da1d743.png)

任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:54:56.597

给最外层的 div 一个指定的宽度，在你的情况下：

```
<div class="slider_main" style="width: 915px">
    ....content.....
  <div style="clear: both;"></div>
</div> 
```

等等。

不久前我遇到了类似的问题，在这里找到了答案：[IE7 中的奇怪浮动行为](https://stackoverflow.com/questions/187279/strange-float-behaviour-in-ie7)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:09:25.980

这是 IE 和 inline-block 元素的问题。

到处都有以下 CSS 代码

> ```
> display:inline-block 
> ```

你需要为 IE 添加这个

> ```
>  display:inline-block;
>     *display: inline;
>     zoom:1; 
> ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T16:45:31.000

您的 Javascript 中有 2 个错误。

您正在尝试将字符串乘以一个数字，这会导致它中断：

> ```
> var height = '190',
>     width = '915',
>     slides = 3,
>     tabs = $('.tab'),
>     contentNum = 1; 
> ```

`'width'`您还缺少jquery`.css()`函数中的引号

> ```
> $('.slider_main_inner').css({
>     width: slides * width,
> }); 
> ```

# 固定版本

使用数字而不是字符串，并在周围添加引号`width`

> ```
> var height = 190,
>     width = 915,
>     slides = 3,
>     tabs = $('.tab'),
>     contentNum = 1;
> 
> $('.slider_main_inner').css({
>     'width': (slides * width)
> }); 
> ```

# javascript - amCharts 不显示最初隐藏的 div 的图表

> ID：10013408
> 
> 赞同：21
> 
> 时间：2012-04-04T14:38:49.483
> 
> 标签：javascript, svg, rendering

我正在使用[amCharts](http://www.amcharts.com/javascript/) （在幕后使用[Raphaël ）将一些图表呈现为 SVG；](http://raphaeljs.com/)并且注意到如果 SVG 在最初不可见的 div 中呈现，则当 div 变得可见时浏览器不会立即呈现图像。但是，如果我修改显示，例如通过调整浏览器大小或 Ctrl-鼠标滚轮缩放，则在重新绘制页面时，SVG 图像将按预期呈现。

div 可见性切换的确切方法是通过[Bootstrap 的选项卡式导航栏](http://twitter.github.com/bootstrap/components.html#navs)。

我承认对 SVG 不是很有经验 - 这是浏览器渲染的问题，还是 amCharts 的 SVG 标记的问题，或者当我知道 SVG 的可见性已经改变时，我是否需要显式调用某种重绘方法？

这是一个[说明问题的jsFiddle](http://jsfiddle.net/8yX65/13/)；如果您切换到第 2 部分（在 Chrome、Firefox 中），图表最初是不可见的。调整显示大小会使其出现。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-04T16:07:32.503

我已经找到了初始行为和解决方法的原因——而且都是 amCharts 特定的（与 SVG 本身无关），所以我相应地改写了标题。

发生的情况是，当 amCharts 创建 SVG 时，它需要（或至少决定）以绝对值定义宽度和高度。这些基于目标 div 的大小，通过`offsetWidth`和`offsetHeight`属性获得。

非活动选项卡具有`display: none`属性集，因此这部分 DOM 甚至没有被渲染，因此对于两个 size 属性都返回零。这最终导致 amCharts 在`chart.write`调用隐藏 div 时创建一个 0x0 SVG 图表。

调整大小可以解决问题，因为每个图表都会为窗口事件注册一个侦听器，该`onresize`事件会调用图表的`handleResize`方法。这会根据 div 的新（当前）尺寸强制重新计算宽度和高度。

* * *

所以总而言之，我认为有两种替代方法可以处理这个问题：

*   `chart.write`当且仅当其选项卡可见时才调用图表。
*   `handleResize`选项卡更改时调用每个图表的方法。

（第一个选项避免了渲染不可见图表的初始命中，但每次更改选项卡时都会重新绘制。后者会预先受到影响，但之后可能更快。对于奖励分数，最好的解决方案是在每次调整大小之间仅呈现每个图表一次，第一次变得可见，但这要复杂得多，因为它会涉及干扰默认事件侦听器等。）

**更新**：渲染不可见图表还有进一步的复杂性；特别是，我发现高度计算的问题没有考虑域轴所需的空间，因此将图表从其 div 中拉伸出来。这不是通过调用来解决的`handleResize`-`measureMargins`事先调用看起来应该可以工作，但没有。（可能还有另一种方法可以在此之后调用以使其工作，`resetMargins`但此时它开始感觉非常不稳定......）

因此，我认为第一次在不可见的 div 上渲染图表是不切实际的，所以我结合了上面的项目符号。我倾听第一次可见图表的选项卡，然后调用`chart.write`适当的图表对象 - 并且只要制表符更改，就会告知*所有*以前呈现的图表来处理调整大小。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T15:36:38.110

*** 已编辑 ***

这是一个更新的[小提琴](http://jsfiddle.net/Ncx9z/3/)。只有在显示选项卡后才会呈现画布。我将 chartdiv id 存储在一个数组中并检查其中是否存在。

*** 已编辑 ***

我发现的唯一解决方案是在显示特定选项卡后显示图表。

正如你在这个[jsFiddle](http://jsfiddle.net/fKyz5/)中看到的。

```
var tabs = $('.tabbable').tab()

tabs.on('shown', function(e){
   id = $(e.target).attr('href');        
   chartdiv_id = $(id).find('.chartdiv').attr('id');                        
   doChart(chartdiv_id, true);
}); 
```

我想这不是您正在寻找的东西，但我希望它暂时有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-06T01:43:19.390

我有同样的问题，但我的解决方案是 display:none，你可以在 css 中使用这个类

```
.hidden {
   position: absolute !important;
   top: -9999px !important;
   left: -9999px !important;
} 
```

这种屏幕消失但对 amchart 可见，因此图表的分辨率永远不会丢失大小！！！！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-30T11:59:14.707

这可能会帮助您解决问题。我的 amchart 显示在不同的选项卡 pan 中。由于调整大小问题，SVG 组件不允许他们显示该 div。

```
$(window).resize(function() {
    setTimeout(function() {
        chart.write("chartdiv1");
    }, 300);
}); 
```

创建图表时再次调整窗口大小..

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-19T14:24:32.253

我也遇到了这个问题，并通过使初始化程序成为一个函数来解决它。[工作小提琴](http://jsfiddle.net/Perry_/sW7Np/2/)。

```
$("#button").click(function(){
    $("#chartdiv").toggle();
    makeChart();
});

function makeChart() {
     var chart = AmCharts.makeChart("chartdiv", {
         //all the stuff
     });
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-05T19:33:42.330

```
<a href="#" class="show_charts">Show me charts</a>
<div class="charts_div" style="display:hidden;">
some charts here
</div>
<script>
    $(document).on('click', '.show_charts', function(){
        $('.charts_div').toggle();
        //just redraw all charts available on the page
        for(var i = 0; i < AmCharts.charts.length; i++) {
            AmCharts.charts[i].validateData();
        }
    });
</script> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-27T13:58:31.640

我完全同意 Andrzej Doyle 的观点。

在带有自定义选项卡（不是 jquery 选项卡）的 cs-cart 上单击所选 div （选项卡）时在图表上发出 handleresize 对我有用。

以下工作在全局定义的购物车蜂鸣中起作用。

```
 function refreshchart(){
        chart.handleResize();
    }; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-17T17:31:34.583

```
var chart = null;
AmCharts.ready(function () {
    chart = AmCharts.makeChart('chart', .....);
});
$(document).ready(function(){
    $("#view_chart").click(function(){
        chart.validateSize();
    });
});

<button type="button" id="view_chart">View Chart</button>
<div style="display:none;" id="chart"></div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-19T11:21:27.267

另一种解决方法是

```
drawTransactionTypeChart();
setTimeout(function(){hidePieCharts();},1); 
```

最初设置`display:inline`为 div 是图表容器，它会被渲染。

然后在 1ms 后设置`display:none`使用。`setTimeout()`

希望这可以帮助...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-09T22:40:18.053

我在不同的选项卡上有**两个 amcharts**。将放置在#chartdiv 上的股票图表和将放置在#chartdivpie 上的饼图。这就是我解决问题的方法。

我的自定义 css - 覆盖引导程序 -

```
#chartdivpie { width: 1138px; height: 500px; }
.tab-content .tab-pane {
   position: absolute;
   top: -9999px;
   left: -9999px;
   display: inline;
}
.tab-content .tab-pane.active {
    position: inherit !important;
} 
```

jQuery 调用

```
$('#myTab a').click(function (e) {
      e.preventDefault()
        $(this).tab('show');
        chart.invalidateSize();
        chart.write('chartdiv');
    }) 
```

# .net - 使用 Rx 执行一次延迟操作，并取消每个窗口

> ID：10013409
> 
> 赞同：1
> 
> 时间：2012-04-04T14:38:53.153
> 
> 标签：.net, system.reactive

具体来说，如果按键的持续时间大于阈值（T），我正在尝试模拟执行操作。

我正在尝试使用**没有状态变量的 Reactive Extensions .NET（稳定的 1.0 版本）来做到这一点。**

这是我的输入和我需要的大理石图：

让 T = 3 （所以 4 dddd 没有按键事件构成“按键按下”）

keyDown: --dddd---dd--d-dddddddddd----

keyUp: ------------u-----u--u----------------u--

所需：--------a-------------a---------

这是我想出的一些示例代码，但它使用了状态变量。

```
var keyDownStream = Observable.FromEventPattern<KeyEventArgs>(this, "KeyDown").Where(args => args.EventArgs.Key == Key.OemPeriod);
        var keyUpStream = Observable.FromEventPattern<KeyEventArgs>(this, "KeyUp").Where(args => args.EventArgs.Key == Key.OemPeriod);

        var repeatGuard = false;
        keyUpStream.Subscribe(x => repeatGuard = false);
        keyDownStream
            .DelayOrCancel(TimeSpan.FromSeconds(2.0), keyUpStream)
            .Where(_ => repeatGuard == false)
            .Do(_ =>
            {
                repeatGuard = true;
            })
            .Subscribe(
                result =>
                {
                    Console.WriteLine("KeyHold");
                }
            );

public static class JustinsRx
{
    public static IObservable<T> DelayOrCancel<T, TCancel>(this IObservable<T> source,
                                     TimeSpan delay,
                                     IObservable<TCancel> cancel)
    {
        //argument checking skipped
        return from s in source
               from i in Observable.Timer(delay).TakeUntil(cancel)
               select s;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:56:17.580

这行得通，但我觉得它可以做得更短。

```
var firstKeyDowns = Observable
    .Merge(keyDownStream.Select(_ => 'd'), keyUpStream.Select(_ => 'u'))
    .DistinctUntilChanged()
    .Where(c => c == 'd');
var query = from s in firstKeyDowns 
            from i in Observable.Timer(delay).TakeUntil(keyUpStream)
            select s; 
```

编辑：这是我认为更好的不同版本：

```
var noRepeats = Observable
    .Merge(keyDownStream.Select(_ => 'd'), keyUpStream.Select(_ => 'u'))
    .DistinctUntilChanged();
var query = noRepeats
    .Throttle(delay)
    .Where(c => c == 'd'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T03:09:49.777

这对我有用：

```
var timer = Observable.Timer(TimeSpan.FromSeconds(1.0));

var query =
    keyDownStream
        .Select(_ =>
            keyUpStream
                .Select(_ => 'u')
                .Amb(timer.Select(_ => 't'))
                .Take(1)
                .Where(x => x == 'u')
                .Select(_ => Unit.Default))
        .Switch(); 
```

# php - 重定向页面是否需要元标记？

> ID：10013414
> 
> 赞同：1
> 
> 时间：2012-04-04T14:39:03.440
> 
> 标签：php, seo, metadata, redirect

只是好奇您是否说过一个重定向到另一个页面的索引页面，当搜索引擎索引该站点时，他们是否遵循重定向并扫描它被重定向到的页面？想知道我是否需要在带有元标记的重定向页面中放置一个简单的 html 结构以进行适当的 SEO。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:50:43.040

如果页面位置发生变化，请使用带有 301 重定向的 PHP 标头函数来通知搜索引擎该页面已移动：。

```
header ('HTTP/1.1 301 Moved Permanently');
header ('Location: '.$location); 
```

这是SEO方面最合适的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:43:22.483

是的，它们会跟随您的重定向，不，您在重定向请求时不需要发送任何 HTML 内容。

此外，根据您发送的 HTTP 标头，他们知道重定向的类型。

在 3XX 部分下，您可以找到可能的重定向列表：[http ://en.wikipedia.org/wiki/List_of_HTTP_status_codes](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

# django - django admin 中的用户设置

> ID：10013417
> 
> 赞同：0
> 
> 时间：2012-04-04T14:39:17.067
> 
> 标签：django, django-models, django-admin

我希望能够从 django 管理员更改一些设置，例如：站点标题或页脚。我想拥有包含此设置的模型的应用程序，但此设置应该是单个副本。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T19:25:00.897

您可以使用 @staff_member_required 装饰器创建视图，该装饰器呈现/保存表单：

```
from django.contrib.admin.views.decorators import staff_member_required
...
@staff_member_required
def edit_config(request, ):
    saved = False
    if request.method == "POST":
        form = ConfigForm(request.POST)
        if form.is_valid():
            ...
            # Do saving here
            saved = True
    else:
        form = ConfigForm()
        ...
    context = {
        'form': form,
        'saved': saved,
    }
    return render_to_response('staff/edit_config.html', context, context_instance=RequestContext(request)) 
```

在视图中使用[django 表单](https://docs.djangoproject.com/en/dev/topics/forms/)，并将其传递给模板。

然后，在模板中扩展“admin/base_site.html”，使您的表单具有管理员的外观和感觉。这是一个示例模板：

```
{% extends 'admin/base_site.html' %}
{% load i18n adminmedia %}

{% block title %}Edit Configuration {{ block.super }} {% endblock %}

{% block extrastyle %}{{ block.super }}<link rel="stylesheet" type="text/css" href="{% admin_media_prefix %}css/forms.css" />{% endblock %}

{% block breadcrumbs %}
    <div class="breadcrumbs">
        <a href="/admin/">{% trans "Home" %}</a> > Edit Configuration
    </div>
{% endblock %}

{% block content %}
    <h1>Edit Configuration</h1>
    {% if saved %}
        <p class="success" style="background-color:#9F9; padding: 10px; border: 1px dotted #999;">
            Settings were saved successfully!
        </p>
    {% endif %}
    <form method="POST" action="">
        {% csrf_token %}
        <fieldset class="module aligned">
            <h2>Configuration</h2>
            <div class="description"></div>
            {% for field in form %}
                <div class="form-row {% if field.errors %}errors{% endif %}">
                    {{ field.errors }}
                    <div class="field-box">
                        {{ field.label }} : {{ field }}
                        {% if field.help_text %}
                            <p class="help">{{ field.help_text|safe }}</p>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </fieldset>
        <div class="submit-row">
            <input type="submit" value="{% trans 'Save' %}" class="default" name="_save"/>
        </div>
    </form>
{% endblock %} 
```

您可以使用数据库、ini 文件、redis 等来存储您的配置。您可以定义一些通用后端，并从中继承您的自定义后端，因此它很灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:08:10.287

听起来[django-constance](https://github.com/comoga/django-constance#readme)很合适。

虽然[django-flatblocks](https://github.com/zerok/django-flatblocks)可能就足够了。

> django-flatblocks 是一个简单的应用程序，用于处理网站上的小文本块。把它想象成 django.contrib.flatpages 只是不是针对整个页面，而只是针对其中的一部分，就像描述您可以在网站上做什么的信息文本一样。

# python - 处理空字符串 - Python

> ID：10013419
> 
> 赞同：-7
> 
> 时间：2012-04-04T14:39:19.863
> 
> 标签：python

我必须为十六进制到二进制转换器做一个程序。我让它工作正常。然而，唯一没有完全按计划进行的是输入了一个空字符串。如果输入了无效数据，则会产生错误，除非没有输入任何内容，也没有产生任何内容。没有错误出现，但它也没有做任何事情。

我将如何使空字符串出现错误？

```
def Binary(Hex):
    Result = ''
    ErrorFound = False
    BinaryEquivalent = ''
    for ThisHexDigit in Hex:
        if ThisHexDigit in ['1','2','3','4','5','6','7','8','9','0','A','B','C','D','E','F']:
            if ThisHexDigit == '0': BinaryEquivalent = '0'
            elif ThisHexDigit == '1': BinaryEquivalent = '1'
            elif ThisHexDigit == '2': BinaryEquivalent = '2'
            elif ThisHexDigit == '3': BinaryEquivalent = '3'
            elif ThisHexDigit == '4': BinaryEquivalent = '4'
            elif ThisHexDigit == '5': BinaryEquivalent = '5'
            elif ThisHexDigit == '6': BinaryEquivalent = '6'
            elif ThisHexDigit == '7': BinaryEquivalent = '7'
            elif ThisHexDigit == '8': BinaryEquivalent = '8'
            elif ThisHexDigit == '9': BinaryEquivalent = '9'
            elif ThisHexDigit == 'A': BinaryEquivalent = '10'
            elif ThisHexDigit == 'B': BinaryEquivalent = '11'
            elif ThisHexDigit == 'C': BinaryEquivalent = '12'
            elif ThisHexDigit == 'D': BinaryEquivalent = '13'
            elif ThisHexDigit == 'E': BinaryEquivalent = '14'
            elif ThisHexDigit == 'F': BinaryEquivalent = '15'
            Result = Result + BinaryEquivalent
        else:
            ErrorFound = True
            print('You have made a mistake')
    return Result 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:48:38.860

```
if not hex_string:
    raise ValueError('Cannot convert empty string') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:45:37.037

我经常发现自己在问字符串是否有任何长度

```
emptyInput = ""
if len(emptyInput): #returns 0 and will fail 
#but as the comments remind me
if emptyInput: #also returns false 
```

现在你有几个选择。只需添加一个 else 并继续，引发错误，或要求新的输入。如果没有您的一些代码，真的很难建议最好的课程。

# iphone - 为什么没有设置我的 Objective-C 类实例变量？

> ID：10013420
> 
> 赞同：0
> 
> 时间：2012-04-04T14:39:20.677
> 
> 标签：iphone, objective-c, ios, ios5

这是一个菜鸟问题，但我一生都无法弄清楚为什么没有设置我的 MSMutableArray 类变量。下面是我的代码：

```
@interface MyClass : NSObject {
   NSMutableArray *imageArr;
}

@implementation MyClass
-(id)init
{
   self = [super init];
   if (self) {
      imageArr = [[NSMutableArray alloc] init]; 
   }
   return self;
}

- (void) checkImageArr {
   NSLog(@"imageArr size::%@",[imageArr count]);
} 
```

当此代码运行时，日志中设置了以下内容：

```
imageArr size::(null) 
```

为什么没有设置该变量？我查看了以下[问题](https://stackoverflow.com/questions/5713816/define-global-nsmutablearray)，并没有发现我的代码和接受的答案有什么不同。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:41:11.300

将 %@ 更改为 %lu，您会看到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:41:28.593

count 方法返回一个 NSUInteger。

请尝试使用此日志格式：

```
NSLog(@"imageArr size::%u",[imageArr count]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T14:55:09.730

%@ 说明符期望参数是一个`id`（或指向对象的指针）。 `-count`返回一个不是对象的 NSUInteger。由于您的数组为空，因此计数为零，因此参数被解释为 nil 对象，`(null)`与说明`%@`符一起使用时会出现。

如果参数不为零，`-description`则将发送给它以获取要插入到日志消息中的字符串。因此，如果您将对象添加到数组中，`NSLog`将尝试将 1 解释为对象指针并发`-description`送给它。这将导致`EXC_BAD_ACCESS`异常（试试看！）。

您需要一个将参数解释为数字的格式说明符。 `NSUinteger`有以下定义

```
#if __LP64__ || TARGET_OS_EMBEDDED || TARGET_OS_IPHONE || TARGET_OS_WIN32 || NS_BUILD_32_LIKE_64
typedef unsigned long NSUInteger;
#else
typedef unsigned int NSUInteger;
#endif 
```

所以它可能是一个无符号长。为了安全起见，我总是将其投射以确保，所以你需要这个：

```
NSLog(@"imageArr size::%lu", (unsigned long)[imageArr count]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T14:44:00.653

```
NSLog(@"imageArr size::%@",[imageArr count]); 
```

当你想“写一个对象”AFAIK 时，你应该使用 %@，就像写 [对象描述]。[imageArr count] 是一个 int，对吗？它不是指向对象的指针。

您应该使用 %i 而不是 %@。大小将为 0。

试试 NSLog(@"imageArr size::%@",imageArr); 如果你想写一个地址

# php - 如何获取别名

> ID：10013421
> 
> 赞同：-2
> 
> 时间：2012-04-04T14:39:23.200
> 
> 标签：php, mysql, variables, alias, fetch

如何从查询中获取别名以获取结果？

查询是：

```
$timecheck = $db->query("SELECT (B <= NOW()) AS var FROM table1 WHERE x='$x'"); 
```

因此，我需要：

```
if ($var != 0){
    $updatestatus = $db->query("UPDATE table2 SET abc='1' WHERE x='$x'");
} 
```

我了解到我不能使用：

```
$var = $db->query("SELECT (B <= NOW()) FROM table1 WHERE x='$x'"); 
```

这会返回错误的值。所以我需要：

```
$db->fetch 
```

但我以前从未使用过它。当我阅读一些手册时，我相信它应该是这样的：

```
while ($var=$db->fetch_object($timecheck){
    if ($var === 0){ 
```

还是我错了？非常感谢。

**更新**

在投票之前，人们最好阅读查询。我试图获取的表中没有一个简单的对象。在表中只给出了一个时间戳。我需要获取别名的结果。这种情况在手册中没有描述，所以请不要发布无用的评论，比如“你的常识”的答案，当你猜不到这个问题的内容时，不要投反对票。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:43:39.873

> 如何获取别名

与常规字段 **[完全相同。](http://php.net/manual/en/function.mysql-fetch-object.php)**

# cocoa - 从文件中创建 NSData 以块的形式读取它

> ID：10013423
> 
> 赞同：1
> 
> 时间：2012-04-04T14:39:31.463
> 
> 标签：cocoa, nsdata

某段代码的工作方式如下：

1.  从磁盘读取文件并将其作为 NSData 存储在内存中
2.  加密（解密）它，从而在内存中产生一个相同大小的附加 NSData 对象
3.  将加密（解密）的数据写入磁盘

现在，对于大小为 10 或 100 mb 的文件，这工作得很好，并保持每秒处理字节的一致速率（因此处理 100 mb 文件将需要 10 倍于 10 mb 的文件）。如果我说 1.5 gigs，那么系统必须将其中的 2 个保留在内存中，以便它开始交换到磁盘，这会大大降低速度。

所以我想也许以下是可能的：

1.  查看文件并将其拆分为 100mb 块（例如）
2.  读取一个块
3.  加密（解密）它
4.  将加密的块附加到输出文件
5.  把原始块扔掉，这样整个过程最多占用 200mb 的 RAM

我的问题是：

1.  那可能吗？
2.  如果是这样，这是最好的方法吗？
3.  如果是这样，我将如何实施它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:00:23.173

你想做的事是完全可能的。你的问题需要一个有点冗长的答案，所以我推荐你到这个网页：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Streams/Articles/ReadingInputStreams.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Streams/Articles/ReadingInputStreams.html)

请注意，页面中的示例处理文件。您可以将缓冲区设置为您想要的大小，并一次读取任意数量的字节。您甚至会看到一个合适的地方来调用您的加密例程。

`-writeToFile:atomically:`使用您创建的 NSMutableData 实例，您可以使用或将其写入磁盘`-writeToURL:atomically:`

试一试，并在您的努力中向您致以最良好的祝愿。

# php - 通过类生成 CSV 仅在一列中给出结果

> ID：10013427
> 
> 赞同：0
> 
> 时间：2012-04-04T14:39:48.330
> 
> 标签：php, zend-framework, export-to-csv, fputcsv

```
 <?php

            class Zend_Controller_Action_Helper_Csv extends Zend_Controller_Action_Helper_Abstract
            {

              /**
               * Perform helper when called as $this->_helper->Csv() from an action controller
               *
               * @param  array $aryData
               * @param  string $strName
               * @param  bool $bolCols; default true; zeigt Spaltenüberschriften
               * @return void
               */
              public function direct($aryData = array(), $strName = "csv", $bolCols = true)
              {
                $this->printExcel($aryData, $strName, $bolCols);
              }

              /**
               * array via fputcsv() zu csv
               *
               * @param  array $aryData
               * @param  string $strName
               * @param  bool $bolCols
               * @return void
               */
              public function printExcel($aryData = array(), $strName = "csv", $bolCols = true)
              {

                if (!is_array($aryData) || empty($aryData))
                {
                  exit(1);
                }

                // header
                header('Content-Description: File Transfer');
                header('Content-Type: text/csv; charset=utf-8');
                header("Content-Disposition: attachment; filename=" . $strName . "-export.csv");
                header('Content-Transfer-Encoding: binary');
                header('Expires: 0');
                header('Cache-control: private, must-revalidate');
                header("Pragma: public");

                // Spaltenüberschriften
                if ($bolCols)
                {
                  $aryCols = array_keys($aryData[0]);
                  array_unshift($aryData, $aryCols);
                }

                // Ausgabepuffer für fputcsv
                ob_start();

                // output Stream für fputcsv
                $fp = fopen("php://output", "w");
                if (is_resource($fp))
                {
                  foreach ($aryData as $aryLine)
                  {
                    // ";" für Excel
                    fputcsv($fp, $aryLine, ';', '"');
                  }

                  $strContent = ob_get_clean();

                  // Excel SYLK-Bug
                  // http://support.microsoft.com/kb/323626/de
                  $strContent = preg_replace('/^ID/', 'id', $strContent);

                  $strContent = utf8_decode($strContent);
                  $intLength = mb_strlen($strContent, 'utf-8');

                  // length
                  header('Content-Length: ' . $intLength);

                  // kein fclose($fp);

                  echo $strContent;
                  exit(0);
                }
                ob_end_clean();
                exit(1);
              }
            } 
```

我的控制器动作

```
 public function smscsvAction(){
            $this->_helper->viewRenderer->setNeverRender();
            $user                   = new Zend_Session_Namespace('user');
            $pid= $user->pid;
            $instance               = new Sms();
            $select                 = $instance->get_csv($pid);
           $this->_helper->Csv($select,"SmsHistory");
            } 
```

这是 get_csv 定义

```
function get_csv($pid){
    $DB = Zend_Db_Table_Abstract::getDefaultAdapter();

    $select = $DB->select()
         ->from('sms', array('sms_id','sb','ss','sr','sc','st'))
         ->where('pd= ?', $pid)
         ->order('dcDESC');
         return $select = $DB->fetchAll($select);
    } 
```

这很好**用但是我只在一个列中获取所有记录，我想要单独的列，就像我们的 phpmyadmin** 如何在我的班级或其他地方进行更改？

输出示例

```
 sms_id;sb;ss;sr;dc;st         
          6525;Kjhhgfdsaerghvddfghb;154008221;;"2012-04-04 18:20:54";Inbox          
          6526;Hi;;03224615015;"2012-04-04 18:20:54";Sent           
          6527;Shgdowsbvdowqopwqndx;3008496482;;"2012-04-04 18:20:54";Inbox         
          6528;Terka;3008496482;;"2012-04-04 18:20:54";Inbox            
          6529;"Never miss a call with Warid Missed Call Alerts! Type 'MCA ON' in an SMS & send it to 129 to activate. Charges Rs.30+tax/month for Postpaid users.";129;;"2012-04-04 18:20:54";Inbox            
          6530;"Make as many calls as you want to 5 friends & family numbers for just Rs. 500+tax/ month. To activate visit nearest Warid Business Center. Conditions Apply";Warid;;"2012-04-04 18:20:54";Inbox         
          6531;Hii;;03324427584;"2012-04-04 18:20:54";Sent          
         6532;.K;3324427584;;"2012-04-04 18:20:54";Inbox 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T08:29:14.757

改变你的这一行

```
fputcsv($fp, $aryLine, ';', '"'); 
```

有了这个

```
fputcsv($fp, $aryLine, ',', '"'); 
```

它会根据需要输出

# vb.net - 使用 WebClient 取消上传？

> ID：10013428
> 
> 赞同：0
> 
> 时间：2012-04-04T14:39:49.140
> 
> 标签：vb.net, ftp, webclient

使用以下 VB.Net 简单代码在 FTP 中上传文件，对 WebClient.CancelAsync() 的调用实际上不会取消上传。

有人知道为什么，对此可以做些什么？

```
Private Sub UploadProgressChanged(ByVal sender As Object, ByVal e As System.Net.UploadProgressChangedEventArgs)
    'TO-DO: Why is pbar empty?
    ProgressBar1.Value = e.ProgressPercentage

    Label1.Text = e.BytesSent & " bytes sent"
End Sub

Private Sub UploadFileCompleted(ByVal sender As Object, ByVal e As System.Net.UploadFileCompletedEventArgs)
    MessageBox.Show("Done!")
    Button1.Text = "Upload"
    ProgressBar1.Value = 0
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim client As New WebClient

    If Button1.Text = "Cancel" Then
        'TO-DO: Doesn't actually cancel upload!
        client.CancelAsync()

        Button1.Text = "Upload"
        ProgressBar1.Value = 0
    Else
        Button1.Text = "Cancel"

        Const MYFILE = "big.file.bin"
        Const LocalFile As String = "C:\" & MYFILE

        Dim RemoteFile As String = "ftp://upload.acme.com/" & MYFILE

        client.Credentials = New NetworkCredential("anonymous", "test")
        client.Proxy = Nothing

        AddHandler client.UploadFileCompleted, AddressOf UploadFileCompleted
        AddHandler client.UploadProgressChanged, AddressOf UploadProgressChanged

        ProgressBar1.Maximum = 100

        Try
            client.UploadFileAsync(New Uri(RemoteFile), LocalFile)
        Catch ex As Exception
            MsgBox(ex.ToString)
        End Try

        client.Dispose()
    End If
End Sub 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:01:41.447

我自己不使用 VB，但在我看来，您在错误的客户端上调用了 client.cancelAsync()。

每次按下取消/上传按钮时，您都会创建一个新客户端。

如果你想取消你启动的第一个客户端，你需要在 click_handler 外部实例化它。

另外，您为什么要使用按钮标签来检查是否应该取消客户端？

如果 client.IsBusy ...

# c++ - 错误 C2668 从站点 http://h264bitstream.sourceforge.net/ 对重载函数代码的模糊调用

> ID：10013434
> 
> 赞同：3
> 
> 时间：2012-04-04T14:40:14.537
> 
> 标签：c++, c, visual-studio-2010, visual-c++

[我运行了一个从站点http://h264bitstream.sourceforge.net/](http://h264bitstream.sourceforge.net/)下载的 h264 解析器程序

当我运行代码时，出现以下错误

> **错误 C2668:'log': 对重载函数的模糊调用**
> 1> c:\program files\microsoft visual studio 10.0\vc\include\math.h(575): 可能是 'long double log(long double)'
> 1> c :\program files\microsoft visual studio 10.0\vc\include\math.h(527): 或 'float log(float)'
> 1> c:\program files\microsoft visual studio 10.0\vc\include\math.h( 120）：或“双对数（双）”

在下面的一段代码中

```
else if( pps->slice_group_map_type == 6 )
        {
            pps->pic_size_in_map_units_minus1 = bs_read_ue(b);
            for( i = 0; i <= pps->pic_size_in_map_units_minus1; i++ )
            {
                **pps->slice_group_id[ i ] = bs_read_u(b, ceil( log2( pps->num_slice_groups_minus1 + 1 ) ) ); // was u(v)**
            }
        }
    } 
```

> 错误 C2668:'log': 对重载函数的模糊调用 1> c:\program files\microsoft visual studio 10.0\vc\include\math.h(575): 可能是 'long double log(long double)'
> 1> c :\program files\microsoft visual studio 10.0\vc\include\math.h(527): 或 'float log(float)'
> 1> c:\program files\microsoft visual studio 10.0\vc\include\math.h( 120): 或 'double log(double)'
> 1> 尝试匹配以下代码中的参数列表 '(int)'

```
 if( pps->num_slice_groups_minus1 > 0 &&
        pps->slice_group_map_type >= 3 && pps->slice_group_map_type <= 5)
    {
        sh->slice_group_change_cycle = 
            **bs_read_u(b, ceil( log2( pps->pic_size_in_map_units_minus1 +  
                                     pps->slice_group_change_rate_minus1 + 1 ) ) ); // was u(v) // FIXME add 2?**
    } 
```

> **错误 C2668:'log': 对重载函数的模糊调用** 1> c:\program files\microsoft visual studio 10.0\vc\include\math.h(575): 可能是 'long double log(long double)'
> 1> c :\program files\microsoft visual studio 10.0\vc\include\math.h(527): 或 'float log(float)'
> 1> c:\program files\microsoft visual studio 10.0\vc\include\math.h( 120): 或 'double log(double)'
> 1> 尝试匹配参数列表 '(int)'

```
bs_write_ue(b, pps->pic_size_in_map_units_minus1);
            for( i = 0; i <= pps->pic_size_in_map_units_minus1; i++ )
            {
                **bs_write_u(b, ceil( log2( pps->num_slice_groups_minus1 + 1 ) ), pps->slice_group_id[ i ] ); // was u(v)**
            }
        } 
```

我应该怎么做才能解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T20:51:38.710

修改对 log2 的调用，如下所示：

```
log2( (double)(pps->num_slice_groups_minus1 + 1) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-11T10:58:01.163

尝试使用 1.0 而不是 1 作为参数输入。您的参数`log(...)`应为双精度、浮点或长双精度变量类型。如果不是这种情况，您的变量`num_slice_groups_minus1`也应该是 double、float 或 long double。

例子：`log2( pps->num_slice_groups_minus1 + 1.0 )`

# iphone - iPhone - 封面流程

> ID：10013435
> 
> 赞同：-3
> 
> 时间：2012-04-04T14:40:16.370
> 
> 标签：iphone, objective-c, ios, coverflow

我想为我的 iPhone 应用程序中显示的图像集成 Cover Flow，谁能指导我如何做到这一点。我在 Google 上找到了很多教程，但没有一个有用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:44:09.783

Cover flow 是一个私有的苹果 api，所以你不能使用它。[但是，也有像FlowCover](http://www.chaosinmotion.com/flowcover.html)这样的开源替代品。

# xcode - 为什么 xCode 4.3 语法高亮在某些 64 位项目上会中断？

> ID：10013437
> 
> 赞同：2
> 
> 时间：2012-04-04T14:40:20.163
> 
> 标签：xcode, macos, syntax-highlighting, automatic-ref-counting

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T16:25:17.350

I can confirm, after several tests, that goint into `Product -> Edit Scheme ->` and then Toggle Either / Or `Peristent State / Document Versions` DOES fix this.

![toggle these](../Images/5c20ab1b633519cca74a224aec1e1434.png)

# objective-c - UITableView 称重传感器和 ObjectForKey

> ID：10013438
> 
> 赞同：0
> 
> 时间：2012-04-04T14:40:20.953
> 
> 标签：objective-c, uitableview

我有一个应该很常见的问题。我有一个数据数组，称为`taskList`这个来自 JSON 并且有几个用户数据。到目前为止，一切都很好。我做了第一个`objectForKey:@"desc"`并返回结果（用户描述），但是当我尝试添加另一个 objectForKey（例如年龄）时，它只显示年龄:(这是代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

    UITableViewCell *cell = nil;
    cell = [tableView dequeueReusableCellWithIdentifier:@"MyCell"];

    if (cell == nil){
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"MyCell"] autorelease];
    }

    NSLog(@"%@",taskList);
    cell.textLabel.text = [[taskList objectAtIndex:indexPath.row] objectForKey:@"desc"];
    return cell;
    cell.textLabel.text = [[taskList objectAtIndex:indexPath.row] objectForKey:@"age"];
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:02:38.447

改为这样做：

```
NSString *desc = [[taskList objectAtIndex:indexPath.row] objectForKey:@"desc"];
NSString *age  = [[taskList objectAtIndex:indexPath.row] objectForKey:@"age"];

cell.textLabel.text = [desc stringByAppendingString:age];
return cell; 
```

另一个示例，它格式化字符串（在这种情况下，唯一的区别是我在两者之间添加了一个空格，但它向您介绍了一个非常有用的方法）（并使用我们在上面创建的两个字符串）：

```
NSString *textForMyLabel = [NSString stringWithFormat:@"%@ %@", desc, age];
cell.textLabel.text      = textForMyLabel; 
```

或者在不使用临时变量的情况下做同样的事情`textForMyLabel`：

```
cell.textLabel.text = [desc stringByAppendingFormat:@" %@", age]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:45:49.860

在您发布的代码中，您永远不会到达“年龄”部分，因为它会在设置“desc”后返回。即使您解决了这个问题，您仍然将 desc 和 age 分配给单元格中的同一字段，这可能不是您想要的。

# button - 贝宝自定义数据

> ID：10013439
> 
> 赞同：1
> 
> 时间：2012-04-04T14:40:22.810
> 
> 标签：button, paypal

使用简单的按钮进行付款时，有没有办法将自定义数据发送到 Paypal？

```
<form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post">
    <input type="hidden" name="cmd" value="_s-xclick">
    <input type="hidden" name="hosted_button_id" value="D9DRKKKXPX5VL">
    <input type="image" src="https://www.sandbox.paypal.com/en_US/i/btn/btn_subscribeCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.sandbox.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

我想在这个表单中有一个字段，我可以在其中设置一个值并使用 IPN 取回它。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:35:30.273

我相信您可以使用以下按钮通过按钮传递自定义数据：

`<input name="custom" type="hidden" id="custom" value="stuff">`

# java - HTML5 本地存储离线缓存在 Google AppEngine 应用程序中不起作用

> ID：10013454
> 
> 赞同：2
> 
> 时间：2012-04-04T14:41:26.100
> 
> 标签：java, html, google-app-engine

我正在尝试使用 HTML5 本地存储离线缓存在本地存储图像但无法正确缓存它，我在我的 HTML 中使用清单配置，这是它的示例代码。

在服务器中，我创建了具有以下配置的“test.appcache”文件。

缓存清单 /images/ *。*

但它无法在本地缓存内容，如果我在 chrome/firefox 中看到网络选项卡，则图像的状态代码为 304，具有脱机缓存配置且没有此配置。我的应用程序登陆 Google AppEngine 平台。

请让我知道哪里出错了。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:28:17.223

仅创建清单是不够的 - 您必须确保提供它（通过将其添加为 App Engine 配置中的静态资源），并从您的 HTML 中引用清单，如此[处](http://www.html5rocks.com/en/tutorials/appcache/beginner/)所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-19T03:53:27.300

我在同样的问题上苦苦挣扎，终于让它工作了。需要将这两个处理程序添加到 app.yam。另请注意，Chrome 控制台会自动调试您的 appcache - 有很大帮助。

* * *

运行时：php55
处理程序：

[![](../Images/17cf49c3efa24f0d30263e3e7ee6b4d6.png)](https://i.stack.imgur.com/12Pay.png)

# android - ImageView 之上的多个视图

> ID：10013463
> 
> 赞同：0
> 
> 时间：2012-04-04T14:41:46.150
> 
> 标签：android

我正在尝试将应用程序从 iOS 移植到 Android。在我的 iOS 应用程序中，我有一个显示地图的图像视图，在它之上我想在某些特定位置显示多个按钮视图。

Android 中的标准视图似乎都不能满足我的需求，但我肯定遗漏了一些东西。我怎么能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:19:17.580

最简单的做法是使用最适合您需求的任何布局（LinearLayout、FrameLayout、RelativeLayout 等）并将其背景设置为您需要的任何图像。我相信图像会自动缩放以填充相应的布局。将图像放入适当的`drawable`文件夹 - 并格式化您的 XML，如下所示：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:id="@+id/buttons"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:background="@drawable/background_image">

    ...

</RelativeLayout> 
```

# ruby - 我可以使用 ruby gem vpim 在 vcard 中设置 url 的标签吗？

> ID：10013465
> 
> 赞同：0
> 
> 时间：2012-04-04T14:41:53.263
> 
> 标签：ruby, web, vcf-vcard

我正在用 ruby​​ 和 gem 'vpim' 制作 vcards 我拥有的卡片包含一些 url。目前，当我将生成的卡片导入 Mac 上的联系人应用程序时，所有网址都在主页后标记：

有没有办法可以将该命名更改为“twitter”或“youtube”之类的名称？

这定义了生成的 vcf 文件中的 url：

```
URL:youtube.com/chelseafc 
```

我这样创建：

```
maker.add_url("youtube.com/chelseafc") 
```

在联系人应用程序中，我看到主页：youtube.com/chelseafc 我希望看到 youtube：youtube.com/chelseafc 以使其更具描述性。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T19:53:46.870

我找到了一个很好的例子，我可以看到我需要如何定义我正在寻找的东西。

```
BEGIN:VCARD
VERSION:3.0
N:Doe;John;;;
FN:John Doe
ORG:Example.com Inc.;
TITLE:Imaginary test person
EMAIL;type=INTERNET;type=WORK;type=pref:johnDoe@example.org
TEL;type=WORK;type=pref:+1 617 555 1212
TEL;type=CELL:+1 781 555 1212
TEL;type=HOME:+1 202 555 1212
TEL;type=WORK:+1 (617) 555-1234
item1.ADR;type=WORK:;;2 Example Avenue;Anytown;NY;01111;USA
item1.X-ABADR:us
item2.ADR;type=HOME;type=pref:;;3 Acacia Avenue;Newtown;MA;02222;USA
item2.X-ABADR:us
NOTE:John Doe has a long and varied history\, being documented on more police files that anyone else. Reports of his death are alas numerous.
item3.URL;type=pref:http\://www.example/com/doe
item3.X-ABLabel:_$!<HomePage>!$_
item4.URL:http\://www.example.com/Joe/foaf.df
item4.X-ABLabel:FOAF
item5.X-ABRELATEDNAMES;type=pref:Jane Doe
item5.X-ABLabel:_$!<Friend>!$_
CATEGORIES:Work,Test group
X-ABUID:5AD380FD-B2DE-4261-BA99-DE1D1DB52FBE\:ABPerson
END:VCARD 
```

取自这里：[http ://www.w3.org/2002/12/cal/vcard-notes.html](http://www.w3.org/2002/12/cal/vcard-notes.html)

# objective-c - 我怎么知道是否有硬件键盘？

> ID：10013467
> 
> 赞同：6
> 
> 时间：2012-04-04T14:41:54.217
> 
> 标签：objective-c, ios, cocoa-touch, keyboard

> **可能重复：**
> [如何检测 iPad 上是否存在外接键盘？](https://stackoverflow.com/questions/2893267/how-can-i-detect-if-an-external-keyboard-is-present-on-an-ipad)

当用户开始在我的 iPhone 应用程序的 UI 中编辑文本字段时，我想使用文本字段和键盘之间的空间来获取相关选项列表。

使用来自 iOS 的常规（屏幕）键盘，有几个[方便的通知](https://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html#//apple_ref/doc/uid/TP40009542-CH5-SW16)可供收听，这有助于我确定我为中间的列表留下了多少空间。

但是，当您附加（或模拟使用）硬件键盘时，这些通知将不再发布。不是太意外，但这给我带来了一些挑战。如果用户使用硬件键盘，我有更多的空间用于列表。

***但是，如果没有触发通知或委托方法可以听，我如何确定用户是否有硬件键盘？或者有吗？***

还需要考虑的是，用户可以先通过软件键盘使用该应用程序，然后连接他/她的硬件键盘并继续使用该应用程序。此时，软件键盘将隐藏，但用户仍在编辑文本字段。

我为这个问题找到了一个老骗子，但没有答案：

*   [如何检测到硬件键盘已连接到 iPhone？](https://stackoverflow.com/questions/3159254/how-do-i-detect-that-a-hardware-keyboard-is-attached-to-an-iphone)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T18:18:17.377

如果连接了硬件键盘（否则它们连接到屏幕键盘的顶部），则输入附件视图将显示在屏幕底部。

将输入视图的附件视图设置`UIView`为 size为空`CGRectZero`。您将收到两种情况的显示/隐藏通知，并能够从[通知的用户信息字典中的指标](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIWindow_Class/UIWindowClassReference/UIWindowClassReference.html#//apple_ref/c/data/UIKeyboardWillShowNotification)确定可用的屏幕尺寸。

```
UIView *inputAccessoryView = [[[UIView alloc] initWithFrame:CGRectZero] autorelease];
inputAccessoryView.autoresizingMask = UIViewAutoresizingFlexibleWidth;
textView.inputAccessoryView = inputAccessoryView;

…

- (void)keyboardWillShow:(NSNotification*)aNotification {
  NSLog(@"%@", [aNotification userInfo]);
} 
```

记录的指标 - 请注意帧在`UIKeyboardFrameEndUserInfoKey`屏幕外

```
// (NSDictionary *) {
//     UIKeyboardAnimationCurveUserInfoKey = 0;
//     UIKeyboardAnimationDurationUserInfoKey = "0.25";
//     UIKeyboardBoundsUserInfoKey = "NSRect: {{0, 0}, {768, 264}}";
//     UIKeyboardCenterBeginUserInfoKey = "NSPoint: {384, 891}";
//     UIKeyboardCenterEndUserInfoKey = "NSPoint: {384, 1155}";
//     UIKeyboardFrameBeginUserInfoKey = "NSRect: {{0, 758}, {768, 264}}";
//     UIKeyboardFrameChangedByUserInteraction = 0;
//     UIKeyboardFrameEndUserInfoKey = "NSRect: {{0, 1022}, {768, 264}}";
// } 
```

[更新 - 与user721239](https://stackoverflow.com/a/5760910/272473)在相关问题中的回答非常相似。

# javascript - 如何使用 jquery 捕获输入中的更改事件？

> ID：10013470
> 
> 赞同：4
> 
> 时间：2012-04-04T14:42:01.753
> 
> 标签：javascript, jquery, onchange

```
$('input').change(function(){
    alert($(this).val());
});
$('input').val(1); 
```

这行不通。我需要使用 JavaScript 捕获更改输入：-s

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T14:43:05.973

对元素的编程更改`<input>`不会导致事件。只有用户交互可以。

但是，您可以这样做：

```
$('input').val(1).trigger('change'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:50:15.303

您必须将这些功能放在“Ready”功能中。看小提琴：http: [//jsfiddle.net/SfjJQ/1/](http://jsfiddle.net/SfjJQ/1/)

```
$(function() {
    $('input').change(function() {
        alert($(this).val());
    });
    $('input').val(1);
    $('input').trigger('change');
});​ 
```

请记住，您的：

```
$('input').val(1); 
```

将输入初始化为值为 1。

当然你也可以这样做：

```
$(function() {
    $('input')
        .change(function() {
            alert($(this).val());
        })
        .val(1)
        .trigger('change');
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:19:49.403

正如其他人所提到的， .val() 不会触发任何事件；但是，您可以向 jQuery 添加一个包装函数，该函数将更改值并在需要时触发事件：

```
$( function () {

    //-- new jQuery function
    $.fn.changeVal = function () {
        $.fn.val.apply( this, arguments );
        $( this ).trigger( 'change' );
    };

    //-- your updated code
    $('input').change(function(){
        alert($(this).val());
    });
    $('input').changeVal(1);

} );​ 
```

[http://jsfiddle.net/bA3V2/](http://jsfiddle.net/bA3V2/)

# windows-phone-7 - 如何使文本居中？

> ID：10013473
> 
> 赞同：0
> 
> 时间：2012-04-04T14:42:20.437
> 
> 标签：windows-phone-7

在 Windows Phone 7 上使用 TouchDevelop 时，有没有办法让文本在文本框中居中？或者，文本框可以在墙上居中吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T14:42:45.413

您可以使用**TextAlignment**属性设置 TextBox 中内容的对齐方式。

```
<TextBox TextAlignment="Center"/> 
```

MSDN 参考： http: [//msdn.microsoft.com/en-us/library/system.windows.controls.textbox.textalignment (v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.textalignment(v=vs.95).aspx)

# joomla - 我可以在不卸载的情况下更新 Joomla 模块吗？

> ID：10013474
> 
> 赞同：0
> 
> 时间：2012-04-04T14:42:22.027
> 
> 标签：joomla, joomla1.5, joomla-extensions

我正在维护一个安装在我没有文件传输权限的站点上的 Joomla 模块。当然，我在 Joomla 的测试实例中进行开发，我确实有文件传输权限，在那里我可以编辑模块代码和重新加载页面，一切正常。

但是，当需要将更新的模块移动到“实时”站点时，唯一的选择似乎是卸载现有版本的模块，然后上传新版本的模块。如果我只是尝试使用 Joomla“扩展管理器”安装选项重新上传模块，我会收到“另一个模块已经在使用目录”错误。

然而，卸载也会清除所有已设置为使用此模块的“位置”，并进行了一些广泛的参数调整。

有没有办法让 Joomla 让我用新版本覆盖旧版本的模块？我可以在模块的 XML 描述中添加一些东西来促进这一点吗？

我所写的网站正在运行 Joomla 1.5.23。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:53:59.330

是的，这可以通过在压缩之前将 xml 中的安装行更改为以下内容来实现：

```
<install version="1.5" type="module" client="site" method="upgrade"> 
```

刚刚在 1.5.23 上对其进行了测试，它保留了我以前的模块设置，但也复制了任何更改的代码。

# mysql - SELECT 返回未出现在任何行中的值列表

> ID：10013475
> 
> 赞同：40
> 
> 时间：2012-04-04T14:42:22.837
> 
> 标签：mysql

询问：

```
select id from users where id in (1,2,3,4,5) 
```

如果用户表包含 ids 1、2、3，这将返回 1、2 和 3。我想要一个返回 4 和 5 的查询。换句话说，我不希望查询返回任何存在的行在表格中，我想给它一个数字列表并从该列表中获取*未*出现在表格中的值。

（更新以澄清几个不适用的答案后的问题）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-11-21T03:26:59.270

如果您不想（明确）使用临时表，这将起作用：

```
SELECT id FROM (
  (SELECT 1 AS id) UNION ALL
  (SELECT 2 AS id) UNION ALL
  (SELECT 3 AS id) UNION ALL
  (SELECT 4 AS id) UNION ALL
  (SELECT 5 AS id)
) AS list
LEFT JOIN users USING (id)
WHERE users.id IS NULL 
```

但是，它很丑，很长，如果 ID 列表很长，我怀疑它会如何执行。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-04T14:50:29.233

给定数字是一个固定的列表。我能想到的最快方法是有一个测试表，填充这些数字并执行

未经测试的选择语句 - 但您将遵循原则。

```
select test.number 
from test 
left join 
    users 
on 
    test.number = users.id 
where test.number <> users.id 
```

然后，您将取回所有没有匹配 user.id 的号码，因此可以填补漏洞..

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-04-19T16:22:41.397

有同样的需求，并建立在 BugFinder 使用会话中的临时表的答案之上。这样它会在我完成查询后自动销毁，所以我不必处理房屋清洁，因为我会经常运行这种类型的查询。

创建临时表：

```
CREATE TEMPORARY TABLE tmp_table (id INT UNSIGNED); 
```

使用您将检查的值填充 tmp_table：

```
INSERT INTO tmp_table (id) values (1),(2),(3),(4),(5); 
```

创建并填充表后，像使用任何常规表一样运行查询：

```
SELECT tmp_table.id
  FROM tmp_table
  LEFT JOIN users u
  ON tmp_table.id = u.id
  WHERE u.id IS NULL; 
```

[MySQL 临时表上的这个信息也很有用](http://www.tutorialspoint.com/mysql/mysql-temporary-tables.htm)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-04T15:00:34.653

另一种选择是使用另一个包含所有可能 id 的表，然后从那里进行选择：

```
mysql> describe ids;
+-------+-----------------+------+-----+---------+-------+
| Field | Type            | Null | Key | Default | Extra |
+-------+-----------------+------+-----+---------+-------+
| id    | int(5) unsigned | NO   |     | 0       |       |
+-------+-----------------+------+-----+---------+-------+
1 row in set (0.05 sec)

mysql> select * from ids;
+----+
| id |
+----+
|  1 |
|  2 |
|  3 |
|  4 |
|  5 |
+----+
5 rows in set (0.00 sec)

mysql> select * from users;
+----+
| id |
+----+
|  1 |
|  2 |
|  3 |
+----+
3 rows in set (0.00 sec)

mysql> select id from ids where id not in (select id from users);
+----+
| id |
+----+
|  4 |
|  5 |
+----+
2 rows in set (0.04 sec) 
```

添加的副作用 - 允许您通过插入 ids 表来扩展结果列表

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-31T01:25:18.850

```
select missing.id
  from
(select ELT(@indx, 1,2,3,4,5) as id, @indx:=@indx+1
  from (select @indx:=1) init,
    users
  where ELT(@indx, 1,2,3,4,5) is not null
) missing
  left join users u using(id)
where u.id is null; 
```

你在这里拥有的是：

*   `ELT`与变量一起，`@indx`您可以将列表“转置”为一列。
*   `(select @indx:=1)`需要将 indx 初始化为 1
*   并且`users`需要内部选择中的表，以便 MySQL 可以进行迭代（因此列表的大小不能超过 users 表中的行数，如果是这种情况，您可以使用任何其他足够大的表来代替对于内部用户来说，表本身并不重要，只是有一些东西可以迭代，所以只有它的大小才重要）。
*   `ELT(@indx, 1,2,3,4,5) is not null`嵌套选择中的条件是在索引超出列表大小时停止迭代。

其余的很简单 -`left join`并检查`null`.

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-12-18T08:59:27.680

抱歉，我无法添加评论，@Austin，

你有我的+1。

无论如何，不​​确定这是否适用于 mysql，但是更改所有原子选择连接联合的值集，所以你有类似的东西：

```
SELECT id FROM (
    VALUES (1), (2), (3), (4), (5)
) AS list(id)
LEFT JOIN users USING (id)
WHERE users.id IS NULL 
```

# objective-c - 初始化对象并建立 CoreData 关系

> ID：10013477
> 
> 赞同：1
> 
> 时间：2012-04-04T14:42:33.727
> 
> 标签：objective-c, core-data, restkit

我正在尝试为一个对象建立关系。但我想我没有正确理解所有内容。当我设置它们时，看起来它们都设置正确（即找到了关系）。但是当我稍后遍历它们时，其中一些（不是全部）不存在。

我有一个`Report`，里面有很多`LineItems`。每项检验项目一项`Rating`。当我创建检查时，我正在从另一个对象复制数据，`ReportMaster`. ReportMaster 也有 MasterLineItems 也有评级。但截至目前，我不能保证 MasterLineItems 和 Ratings 之间的关系是正确的。因此，当我为报告复制 ReportMaster 的属性时，我也会获取评级。

我在 Report 中有一个方法来检查是否所有 LineItems 都有评级。但我永远无法让它返回真实。

我的问题是，我应该如何正确设置这些属性，或者我做错了什么？谢谢。（代码块末尾的关系建立）

```
# Creating Report
Report *report = [Report object];
[report setWithMasterReport:masterReport];

# Report.m
- (void)setWithMasterReport:(MasterReport *)masterReport {
    self.name = [masterReport.name copy];

    [self addLineItems:[LineItems copyItemsFromMasterReportItems:masterReport.masterLineItems]];
    NSLog(@"items have ratings: %i",[self lineItemsHaveRatings]);
}

- (BOOL)lineItemsHaveRatings {
    NSArray *lineItems = [[self lineItems] allObjects];
    BOOL t = TRUE;
    for (LineItem *lineItem in lineItems){
        if (lineItem.rating)
            t = t && TRUE;
        else
            t = FALSE;
    }
    return t;
}

# LineItem.m

+ (NSSet*)copyItemsFromMasterReportItems:(NSSet *)masterLineitems {
    NSMutableArray *lineItems = [NSMutableArray arrayWithArray:[masterLineitems allObjects]];

    // go through one by one and replace inspectionFormItem with the inspectionItem copy
    for (NSUInteger i; i < [lineItems count]; i++){
        LineItem *lineItem = [InspectionItem object];
        [lineItem setWithMasterLineItem:[lineItems objectAtIndex:i]];
        [lineItems replaceObjectAtIndex:i withObject:lineItem];
    }

    return [NSSet setWithArray:lineItems];
}

- (void)setWithMasterLineItem:(MasterLineItem *)masterLineItem {
    self.name = masterLineItem.name;
    self.ratingID = masterLineItem.ratingID;

    Rating *rating = [Rating findFirstByAttribute:@"myID" withValue:self.ratingID];
    if (rating)
        [self setRating:rating];
} 
```

当我跑步时，我得到

```
items have ratings: 0 
```

这个问题的另一部分是，在这些“init”方法（`setWith...:`）中，我是否应该复制属性？如果是这样，我也应该复制这种关系吗？我只想要一个指向对象的指针，对吧？

旁注：这些是 CoreData 对象，我正在使用 RestKit，这就是我获得`findFirstByAttribute:withValue:`辅助方法的原因。

谢谢你的帮助。

## 更新

```
- (BOOL)LineItemsHaveRatings {
    NSArray *lineItems = [[self LineItems] allObjects];
    BOOL t = TRUE;
    for (LineItem *lineItem in lineItems){
        if (lineItem.rating)
            t = t && TRUE;
        else {
            t = FALSE;
            Rating *rating = [Rating findFirstByAttribute:@"myID" withValue:LineItem.ratingID];
            NSLog(@"[No Rating Found] %@",lineItem);
            NSLog(@"[Rating to find]  %@",rating);
        }
    }
    return t;
}

[No Rating Found] <LineItem: 0x8200e40> (entity: LineItem; id: 0x8200d00 <x-coredata:///LineItem/t05319326-640E-4DA5-B619-EB20621E3D533> ; data: {
    rating = nil;
    ratingID = 13903;
})
[Rating to find]  <Rating: 0xec356a0> (entity: Rating; id: 0xec31520 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/Rating/p15553> ; data: {
    myID = 13903;
    name = "APPA (Northwestern Memorial Hospital)";
    rangeItemRatings =     (
        "0xec3a2d0 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/RangeItemRating/p2952>",
        "0xec3a2b0 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/RangeItemRating/p2950>",
        "0xec3a2e0 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/RangeItemRating/p2953>",
        "0xec3a2f0 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/RangeItemRating/p2954>",
        "0xec3a2c0 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/RangeItemRating/p2951>"
    );
    ratingType = "0xec368b0 <x-coredata://4EE6AD5A-CC34-460A-A97A-0909454126A4/RatingType/p112>";
    ratingTypeID = 1;
}) 
```

令我感到奇怪的是，其他关系是建立并保持联系的。但是这个没有。... 哦。我没有将关系设置为一对多关系。哎呀。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:12:29.487

我只需要更改`Rating`.

# c++ - strcpy 不复制分配的字符数组

> ID：10013478
> 
> 赞同：1
> 
> 时间：2012-04-04T14:42:34.773
> 
> 标签：c++, arrays, string, character

为什么这不起作用：

```
SomeClass::SomeClass(char *lit) //Ctor
{
    str = new char[strlen(lit)+1]; // str is a pointer to char in SomeClass
    strcpy(str,"have");
    cout << str << " " << "In Ctor" << " +Size=" << strlen(str)<< endl;
} 
```

上面的代码显示了一个长度为 0 的字符串。但是这段代码有效：

```
SomeClass::SomeClass(char *lit)
{
    char newstr[strlen(lit)+1];
    strcpy(newstr,"have");
    cout << newstr << " " << "In Ctor" << " +Size=" << strlen(newstr)<< endl;
} 
```

**[这](http://ideone.com/MBctI)**是完整的代码。

编辑：
添加到 Ideone 的链接，在我回答问题后 OP 删除了该链接。
没有源代码的链接，这个问答是没有用的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:29:05.970

没有问题`strcpy`，你只是在弄乱你的指针。

问题在这里：

```
 str = new char[strlen(lit)+1];
 strcpy(str,lit);
 length=leng();    <------------- str points to \0 after this call
 cout << str << " " << "In Ctor" << " +Size=" << strlen(lit)<< endl; 
```

`str`是您的类成员，并且您将指针`str`移到`\0`函数`leng()`中，自然地，您在下一条语句中看不到任何输出。

解决方案是将起始地址保存在函数内部的单独指针中。

```
int String :: leng()
{
      int length=0;
      char *tempPtr= str;       <----------- Store the address in a temporary pointer
      while(*str)
      {
                 length++;
                 str++;
      }
      str = tempPtr;            <---------- Point the Pointer member to right address again
      return length;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:41:35.627

另一种写法`String::leng()`：

```
int String::leng()
{
    char *endPtr = str;
    while(*endPtr)
        endPtr++;
    return endPtr - str;
} 
```

# qt - 如何在 Qt 中检测锁定的 sql 表？

> ID：10013479
> 
> 赞同：1
> 
> 时间：2012-04-04T14:42:35.087
> 
> 标签：qt, locking, innodb

我有一个 Qt 应用程序在数据库查询期间冻结，因为同时在后台运行 SQL 转储（它发生在每晚备份期间）。MySQL DB 是一个 innoDB，由于性能问题无法更改为 MyISAM。

db 连接的伪代码是这样的，然后是锁定函数`query.exec()`：

```
QSqlDatabase _db = QSqlDatabase::addDatabase(QT_DB_TYPE, _con);

_db.setConnectOptions("MYSQL_OPT_RECONNECT=1;");
_db.setHostName("127.0.0.1");
_db.setDatabaseName("qtapp_db");
_db.setUserName("qtuser");
_db.setPassword("xxx");
_db.setPort("90000");
bool ok = _db.open();

qDebug() << "DBG: ############# db status: isopen()"<< _db.isOpen() << ", is valid; " << _db.isValid();

QSqlQuery query(_db);
query.prepare("INSERT huge_table {...}");

query.exec() 
```

我想在执行 INSERT 之前检测表 huge_table 是否已锁定。但是`_db.isValid()`并`_db.isOpen()`返回true（无论如何我应该在表本身上检查这个，而不是db，我认为）。

感谢您的任何提示。

# fonts - 在 PostScript 中更改字母间距

> ID：10013481
> 
> 赞同：2
> 
> 时间：2012-04-04T14:42:36.427
> 
> 标签：fonts, postscript, eps

在编写 postscript 文件时，可以选择如下字体：

```
/Courier-Bold findfont 16 scalefont setfont
(bar baz) show 
```

我想更改字体的字母间距 - 有没有办法做到这一点？直接作为字体操作符，或者只是能够在字形渲染之间插入任意 postscript 命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T04:48:14.043

是的，有几种`show`操作符的变体可以用于这样的事情：

*   a [x] a [y] string   **ashow**   -在显示*字符串*
    时 将 ( *a [x] , a [y]* ) 添加到每个字符的宽度

**   c [x] c [y] char string   **widthshow**   -在显示*字符串*
    时 添加 ( *c [x] , c [y]* ) 到*char的宽度*

    **   c [x] c [y] char a [x] a [y] string   **awidthshow**   -
    结合 ashow 和 widthshow 的效果

    *   proc string   **kshow**   -在字符串显示的*字符*之间
    执行*proc*** 

 ***一些提示。由于 postscript 没有字符文字，一个常见的习惯用法是从 1 字节的字符串文字中提取整数值来为and提供*char*参数。例如。`widthshow``awidthshow`

```
( ) 0 get %the space char, aka 32 or 16#20 
```

除非你想要某种阶梯效应，否则所有的[y]值都应该是 0。

kshow 在每个字符之间执行的 proc 按顺序接收 char-just-shown 和 char-about-to-be-shown 作为参数。这大概是为了让您在某种“字距调整表”中查找这对。但我从来没有真正看到过这样做。但是如果不需要它们（通常），请记住弹出它们。

* * *

As for making a derived font, I refer you to [this answer of mine](https://codegolf.stackexchange.com/questions/1197/output-a-playable-crossword-grid/3948#3948) on codegolf.SE which creates a Crossword Font by drawing boxes around Times-Roman. The width of the character is declared with the setcachedevice operator in the /BuildChar procedure. For mine, I just needed a constant width so I used 1 to tie it directly to the font size.***

# jquery - 装载指示器不运动

> ID：10013482
> 
> 赞同：0
> 
> 时间：2012-04-04T14:42:38.007
> 
> 标签：jquery

我试图在页面加载时将 GIF 显示为加载指示符，但 GIF 仍然没有运动。我不知道为什么会这样。这是我的脚本：

```
<script type="text/javascript">
    $(document).ready(function() { 
        $(".class").click(function() {
            $("#ajaxBusy").show();
        });
    });
</script> 
```

`onClick`我在一个按钮中调用这个脚本。

![在此处输入图像描述](../Images/4b10f5f450228fd23004381d0f0f7912.png)

```
<div id="ajaxBusy" title="Loading" style="display:none;">  
 <p>  
 <img src="images/SmallLoader.gif" align="left">  
 Loading content, please wait...  
 </p>  
 </div> 
```

我正在做 ac# web 应用程序

# plugins - 在多值字段上使用自定义索引插件时 solr 的奇怪行为

> ID：10013486
> 
> 赞同：1
> 
> 时间：2012-04-04T14:42:43.883
> 
> 标签：plugins, solr, behavior, multivalue

我正在使用我的自定义插件来索引 solr 中的一堆 xml。该插件所做的是“标记”文档并将这些标记（逗号分隔）添加到多值字段中。

这是我在日志中的内容：

```
...
[MULTIVALUE CAR TYPE - final result] -> 4 Dr. Wagon with Wagon, 4X4,
... 
```

这是我在刻面时在 solr 实例中实际拥有的内容：

```
<lst name="car_type_multivalue">
    <int name="convertible">331</int>
    <int name="4">152</int>
    <int name="x">152</int>
    <int name="wagon">121</int> 
```

这是该字段的定义方式：

```
 <fieldType name="text" class="solr.TextField" positionIncrementGap="100" autoGeneratePhraseQueries="true">
     <analyzer>
       <tokenizer class="solr.WhitespaceTokenizerFactory"/>
       <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true"/>
       <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
       <filter class="solr.LowerCaseFilterFactory"/>
       <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
     </analyzer>
 </fieldType> 
```

如您所见，4x4 被正确添加到文档的标签中，但是当它被分面时，它实际上被分为“4”和“x”。我的字段类型似乎不允许这样的事情，所以问题是为什么 solr 会这样？所有其他值都可以正常工作，但不是“4x4”。我可以假设每次我在我的标签中找到一个“x”，无论如何它都会被拆分吗？谢谢大家！

# .net - 视觉工作室多个项目位置

> ID：10013488
> 
> 赞同：0
> 
> 时间：2012-04-04T14:42:44.450
> 
> 标签：.net, visual-studio, visual-studio-2010

有谁知道如何为视觉工作室创建多个**项目位置？**我知道如何将其重新指向某个特定文件夹（或目录），但我不知道如何添加多个位置，因此在不同分支的不同项目中工作时不必深入研究。例如下面的img，我想补充说（在有人告诉我收起我不拥有的外部东西之前，或者问我为什么关心过时的源之前，我只是在这里使用随机名称），*外源*,*过期源*

![项目地点](../Images/2153aa2dcf356ab36607dafc5339ef52.png)

**澄清：** 在VS中，如果你*打开文件*（CTRL + O），在打开文件窗口的左窗格中，`Visual Studio 2010`顶部有（或2008等），在它下面有Projects Location文件夹，我想添加附加文件夹，这是通过 管理的`Tools -> Options -> Projects and Solutions -> General -> Projects location`，但是我只能在其中放置一个目录，我正在尝试添加其他文件夹`;`，但`,`没有用

# asp.net - 无法共同创建探查器错误 - 但未使用探查器

> ID：10013493
> 
> 赞同：37
> 
> 时间：2012-04-04T14:43:03.047
> 
> 标签：asp.net, .net, iis, profiler

我们得到一个：

> .NET 运行时版本 2.0.50727.5448 - 无法共同创建探查器

我们网络服务器上的事件查看器中的消息，以及随附的：

> .NET 运行时版本 4.0.30319.239 - 在 CoCreateInstance 期间加载探查器失败。探查器 CLSID：'{d37a1b78-6dc5-46fc-bc31-f7c4d5a11c9c}'。HRESULT：0x8007007e。进程 ID（十进制）：224。消息 ID：[0x2504]。

问题是，我们没有尝试使用探查器，服务器上没有运行或安装探查器，并且代码在任何地方都没有引用探查器......

我们已尝试删除其他人指出与这些消息相关的注册表项，但无济于事；似乎我们的两个网站/网络应用程序正在触发错误，一个使用 .Net2，另一个使用 4，但我不知道去哪里找。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-05T08:12:38.673

经过大量搜索，我发现有人以前安装了 dotTrace，然后将其卸载，但是卸载不是很干净，并且注册表中到处都是条目，尽管我们删除了一些我们认为可以解决问题的条目，但有更具体的问题到那个探查器。

删除与 dottrace 相关的所有注册表项及其呈现的 CSID 后，我们不再在事件查看器中出现错误。

请参阅此答案以获取脚本以帮助查找此类条目：[https ://stackoverflow.com/a/36129656/361842](https://stackoverflow.com/a/36129656/361842)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-03-13T09:02:44.480

从用户变量（控制面板>系统>高级系统设置>环境变量）中删除环境变量COR_ENABLE_PROFILING（或将其设置为0）解决了我的问题（无法启动MongoVUE）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-10-17T16:02:21.190

虽然在注册表中删除对分析器 CLSID 的所有引用并不是一件坏事，但您也可以选择通过将注册表项设置为来禁用`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\COR_ENABLE_PROFILING`分析`0`

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-03-21T11:19:22.497

为了帮助找到可以使用此工具的位置，可以使用以下 PowerShell 代码来帮助检测与探查器相关的环境变量和注册表项：

```
clear-host
if (-not (get-psdrive HKU)) {
    New-PSDrive HKU Registry HKEY_USERS
    Set-Location HKU:
}
"COR_ENABLE_PROFILING: $env:COR_ENABLE_PROFILING "
"COR_PROFILER: $env:COR_PROFILER"
$GUID = $env:COR_PROFILER
@(
    "HKLM:\Software\Classes\CLSID\$GUID",
    "HKLM:\SOFTWARE\Classes\Wow6432Node\CLSID\$GUID",
    "HKLM:\SOFTWARE\Wow6432Node\Classes\CLSID\$GUID",
    "HKU:\*\Software\Classes\CLSID\$GUID"
) |
    get-item  | 
    %{$p = $_.Name;Get-ItemProperty $_.PSPath ''} | 
    select @{N='Path';E={$p}}, '(default)'

get-itemproperty 'HKLM:\SYSTEM\CurrentControlSet\Services\*\' 'Environment' -ea SilentlyContinue | 
    %{
        $serviceName = $_.PSChildName
        $x = new-object PSObject -Property @{ServiceName=$serviceName}
        $_ | select -expand Environment | 
            %{if($_ -match '^(?<Name>[^=]+)(=)?(?<Value>.*)$'){$x | Add-Member -MemberType NoteProperty -Name $matches['Name'] -Value $matches['Value']}}
        $x
    } |
    ?{$_.COR_ENABLE_PROFILING -eq 1} | 
    ft ServiceName, COR_ENABLE_PROFILING, COR_PROFILER, NEWRELIC_INSTALL_PATH -AutoSize 
```

希望将来可以帮助其他人。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-01-31T20:31:42.820

[![注册表编辑器](../Images/59d39aec028ac1db3bf9cce47c81b788.png)](https://i.stack.imgur.com/jjcTp.png)

1.  使用*regedit*对错误日志中的 CLSID 值进行*数据*搜索
2.  删除 COR_PROFILER 及其值
3.  将 Cor_Enable_Profiling=1 更改为 Cor_Enable_Profiling=0
4.  不要删除以下任何一项的 Cor_Enable_Profiling 设置 **：**

    ```
     HKEY_LOCAL_MACHINE\SYSTEM\Services\WAS
     HKEY_LOCAL_MACHINE\SYSTEM\Services\W3SVC
     HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMI‌​N 
    ```

    这样做可能会导致 IIS 无法启动。有关更多详细信息，请参阅[此问题](https://serverfault.com/questions/210903/windows-process-activation-service-wont-start-parameter-is-incorrect-visual/210912)。
5.  您可能还需要删除/禁用其他用户和系统变量。如果错误仍然存​​在，请尝试先禁用 (COR_ENABLE_PROFILING = 0) 删除。希望有帮助。感谢@Andreas 和@Mike-Monkey 的初步指导。

[![环境变量](../Images/2a54dd1831e45c3e366bb3fbb6483010.png)](https://i.stack.imgur.com/ilpBC.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-07T19:49:47.700

对我们来说，COR_ENABLE_PROFILING 在多个地方

HKEY_LOCAL_MACHINE\SYSTEM\\Services\W3SVC 和 HKEY_LOCAL_MACHINE\SYSTEM\\Services\WAS

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-06T15:31:32.300

Stackify Profiler 也会对你做同样的事情。:(，我发现很难从注册表中删除。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-06T23:12:39.957

我们在尝试启动 Windows 服务时不时会看到这个问题。
此问题始终是可执行文件的 app.config 已损坏（无效的 xml）。
在编辑注册表设置之前，仔细检查您的 app.config 是否是有效的 xml 是一件容易的事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-29T19:32:08.583

即使做了艾格尼丝的[回答中提到的事情，事情也没有奏效。](https://stackoverflow.com/a/22373643/740756)就我而言，我将我的应用程序池设置为一个帐户，并且它的密码已过期......

# ruby-on-rails - 保护 iOS 应用程序和 Rails 应用程序之间通信的最简单方法是什么？

> ID：10013497
> 
> 赞同：3
> 
> 时间：2012-04-04T14:43:10.110
> 
> 标签：ruby-on-rails, ios, api, authentication, encryption

我有一个对 Rails 应用程序进行身份验证的 iOS 应用程序。第一次进行身份验证时，它需要提交用户名和密码，作为回报，rails 应用程序返回一个令牌，iOS 应用程序可以使用该令牌在进一步的通信中进行身份验证。

他们之间传递的信息包括用户的电子邮件地址和其他琐碎信息，但没有像财务细节等高度敏感的信息。我需要一种方法来保护这些通信。

我可以添加此保护的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:56:40.943

HTTPS 是一种直接的方式来保护通过网络传输的通信。可以使用 oAuth 来重用和令牌以进行后续通信。您可能希望采用 Facebook 在其 iOS SDK 中采用的方法。他们将登录页面放在 UIWebView (HTTPS) 中，并返回 oAuth 令牌以供后续调用。

编辑：由于 SSL 似乎“不在桌面上” - 为什么不使用基本身份验证进行身份验证，并让每个调用重新进行身份验证而不是使用令牌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:51:04.957

为您的网络服务器获取可信且有效的证书并使用 SSL / HTTPS。这就是大多数人所做的。

我不建议实施您自己的加密方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:35:17.667

您在本地使用 SSL 的问题让我想起了本[教程](http://railscasts.com/episodes/270-authentication-in-rails-3-1)

当 Ryan 强制使用 SSL 时，他提到它不能在开发环境（本地）中工作，只能在生产和测试中工作。这个问题在六分钟左右讨论。看来，如果您使用 ssl 部署您的应用程序，那么它将起作用。Omniauth 和使用外部提供程序也是如此。它在本地不起作用，但在部署时会起作用。

# jquery - jQuery UI - 可拖动元素在旋转时失去约束

> ID：10013506
> 
> 赞同：1
> 
> 时间：2012-04-04T14:43:30.423
> 
> 标签：jquery, jquery-ui, css

我在这里创建了一个 jsFiddle[来](http://jsfiddle.net/Sp6qa/)说明我的代码问题（双击粉红色元素并尝试拖动到蓝色框外，再次双击并比较结果）。

**问题：**

当我在带有约束的可拖动元素上旋转 CSS 时，约束无法按预期工作。可拖动元素可以部分拖到容器外。我的猜测是它与 CSS 旋转的工作方式有关，但我不确定。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:04:01.537

似乎在 css 中应用旋转不会改变标签的宽度和高度。这就是为什么您可以将 div 移到外面的原因，因为对于浏览器来说，标签的大小（然后是限制）保持不变。您只需检查 div 即可看到这一点。

如果您知道宽度和高度，您可以手动设置它，或者在每次切换 css 类时动态计算它。

[请参阅与您的问题类似的帖子](https://stackoverflow.com/questions/3276467/adjusting-div-width-and-height-after-rotated)。

**编辑**

我找到了一个解决方案来做你想做的事。诀窍是使用容器 div 作为可拖动项目，并管理子 div 中的旋转。然后你需要调整孩子的顶部/左侧属性。我没有寻找更好的公式，只是应用了固定值。但这只是看看它是否有效。

我希望这会有所帮助。

> [http://jsfiddle.net/Sp6qa/2/](http://jsfiddle.net/Sp6qa/2/)

# java - Java GUI (SWING/AWT) - 空框架 - 组件未显示

> ID：10013511
> 
> 赞同：2
> 
> 时间：2012-04-04T14:43:40.160
> 
> 标签：java, swing, user-interface, awt, jpanel

我正在尝试创建（手动编码）一个类似于下面显示的 GUI 的 GUI，但是，只显示一个空框架。

模拟图形用户界面： ![在此处输入图像描述](../Images/71e0bdef74db3a3b257932007a50b7e2.png)

我使用了各种布局和 SWING/AWT 组件来创建 GUI 和 4 个 JPanel，其中包含：

*   mainPanel：包含其中的所有面板。
*   listPanel：包含 JTable、JLabels 和两个 JButton
*   infoPanel：包含 JLabels、JCheckBox 和 JTextBoxes。
*   addPanel：包含 JLists 和 JButton

这是我到目前为止编码的内容：

```
import java.awt.*; 
import javax.swing.*;
import javax.swing.JTable;

public class GUI extends JFrame {

    public void buildGui() {

        JFrame frame = new JFrame("Hotel TV Scheduler");

                JPanel mainPanel = new JPanel();
        mainPanel.setLayout(new BorderLayout());

                JPanel listPanel = new JPanel();
                listPanel.setLayout(new GridLayout(3,3));

                JPanel infoPanel = new JPanel();
        infoPanel.setLayout(new GridLayout(2,2));

                JPanel addPanel = new JPanel();
        addPanel.setLayout(new FlowLayout());

                mainPanel.add(listPanel, BorderLayout.LINE_START);
                mainPanel.add(infoPanel, BorderLayout.LINE_END);
                mainPanel.add(addPanel, BorderLayout.PAGE_END);

                JTable chOneTable = new JTable();
                JTable chTwoTable = new JTable();
                JTable listTable = new JTable();

                JLabel ch1Label = new JLabel("Channel 1");
                JLabel ch2Label = new JLabel("Channel 2");
                JLabel listLabel = new JLabel("List");

                JButton rmvChOneButton = new JButton("Remove Channel");
                JButton rmvChTwoButton = new JButton("Remove Channel");

                listPanel.add(ch1Label);
                listPanel.add(ch2Label);
                listPanel.add(listLabel);
                listPanel.add(chOneTable);                
                listPanel.add(chTwoTable);
                listPanel.add(listTable);
                listPanel.add(rmvChOneButton);
                listPanel.add(rmvChTwoButton);

                JLabel titleLabel = new JLabel("Title");
                JLabel genreLabel = new JLabel("Genre");
                JLabel durationLabel = new JLabel("Duration");
                JLabel actorLabel = new JLabel("Actor");
                JLabel directorLabel = new JLabel("Director");
                JLabel rentableLabel = new JLabel("Rentable");
                JLabel synLabel = new JLabel("Synopsis");

                JTextField txtTitle = new JTextField();          
                JTextField txtGenre = new JTextField();
                JTextField txtDuration = new JTextField();
                JTextField txtActor = new JTextField();
                JTextField txtDirector = new JTextField();
                JTextField txtSynopsis = new JTextField();

                JCheckBox rentCB = new JCheckBox();

                infoPanel.add(titleLabel);
                infoPanel.add(txtTitle);
                infoPanel.add(genreLabel);
                infoPanel.add(txtGenre);
                infoPanel.add(durationLabel);
                infoPanel.add(txtDuration);
                infoPanel.add(actorLabel);
                infoPanel.add(txtActor);
                infoPanel.add(directorLabel);
                infoPanel.add(txtDirector);
                infoPanel.add(rentableLabel);
                infoPanel.add(rentCB);
                infoPanel.add(synLabel);
                infoPanel.add(txtSynopsis);

                JButton btnAddProg = new JButton("Add Program");

                JList channelList = new JList();
                JList timeList = new JList();

                addPanel.add(btnAddProg);
                addPanel.add(channelList);
                addPanel.add(timeList);

                frame.setVisible(true);

    }

} 
```

谁能告诉我为什么只显示一个空框架？

谢谢和问候， 布赖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T14:49:39.813

是的，刚刚检查过，如果你真的将 mainPanel 添加到框架中，你会看到一些东西，（虽然看起来不像模拟！）

```
frame.setContentPane(mainPanel);
frame.pack(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T14:48:20.717

您尚未将 mainPanel 添加到框架中

# matlab - matlab中cell(m,n)的作用和使用

> ID：10013512
> 
> 赞同：1
> 
> 时间：2012-04-04T14:43:50.720
> 
> 标签：matlab

我在 MatLab 中读到，如果你要填充一个更大的矩阵，使用 cell 命令从以前声明它的大小会更有计算效率；例如

```
X = cell(500,90); 
```

但是当我尝试为其添加值时，例如

```
X(i;) = x 
```

其中 i 是长度为 90 的 double 向量，i 是整数，我得到

`conversion from cell to double is not possible`

我对细胞功能的理解正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:50:46.270

单元格内容使用花括号来处理，例如：

```
X{1,1}=1:8; 
```

`cell`命令创建一个空数组：

```
C = cell(3,4,2);
% Or alternatively:
C{3,4,2} = []; 
```

你用它做什么`cell array`取决于你。但*很可能*这不是您想要的 - 请参阅[拉斯曼的](https://stackoverflow.com/users/666596/rasman)评论。

[在MathWorks](http://www.mathworks.ch/help/techdoc/ref/cell.html)或[其他教程](http://www.dartmouth.edu/~rc/classes/matlab_prog/Cell_Arrys.html)中查看更多示例。

# web-scraping - 类似 Facebook 的图像抓取

> ID：10013516
> 
> 赞同：0
> 
> 时间：2012-04-04T14:44:01.500
> 
> 标签：web-scraping

我正在尝试实现一个图像抓取功能，该功能类似于 Facebook 在您发布链接时所做的工作。我不关心实际的 UI 部分。我只想将 URL 传递给脚本并让它返回页面上所有图像的 URL。

*将只在某些*时候有效的东西放在一起真的很容易——例如[this](https://stackoverflow.com/questions/3261820/screen-scraping-of-image-links-in-php) ——但我想要一些效果相当好的东西。

我有能力自己写这种东西，但如果已经有免费的东西写出来，我这样做当然是愚蠢的。

有谁知道存在这样的工具吗？我不在乎它使用什么语言，只要它能在 *nix 上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T05:29:18.873

你可以从 python 和 Scrapy [http://doc.scrapy.org/en/latest/index.html开始](http://doc.scrapy.org/en/latest/index.html)

# macos - gdb附加过程导致mach_msg_trap()

> ID：10013519
> 
> 赞同：0
> 
> 时间：2012-04-04T14:44:12.093
> 
> 标签：macos, debugging, gdb

我刚开始使用 gdb，所以我得到了一个我正在尝试调试的 CrackMe 应用程序。所以我运行了应用程序，在终端中启动了 gdb 并将其附加到 CrackMe 的 PID 中，它使应用程序崩溃了。

```
(gdb) attach 6040
Attaching to program: `/Users/***/Desktop/CrackMe.app/Contents/MacOS/CrackMe', process 6040.
Reading symbols for shared libraries + done
Re-enabling shared library breakpoint 1
Re-enabling shared library breakpoint 2
0x00007fff8428767a in mach_msg_trap () 
```

在此之后，程序变得无响应。还有其他我需要传递的论点来附加我遗漏的吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:59:30.600

当您使用调试器附加时，它会自动停止程序。这就是它反应迟钝的原因。输入“cont”（或“continue”）让它继续。

它还向您显示堆栈的顶部框架，它已停止。在这种情况下，这就是 mach_msg_trap()。这是一种非常常见的情况，因为空闲应用程序在等待来自窗口服务器的事件时通常会在该函数中被阻止。

# sqlite - 黑莓 SQLite 最佳性能

> ID：10013520
> 
> 赞同：0
> 
> 时间：2012-04-04T14:44:26.023
> 
> 标签：sqlite, blackberry

在尝试在 Blackberry 上使用 SQLite 时，我克服了许多障碍。现在我已经到了一切似乎都可以正常工作的地步，我正在寻找加快查询速度的方法。

有时我的应用程序从 Web 服务调用中检索大量数据，这些数据被解析并存储到我的数据库中。很多 DELETE、INSERT 和 UPDATE 正在进行。数据库调用似乎需要很多时间。

我想知道处理 SQLite 时的一些最佳实践。最好来自在黑莓平台上具有相关经验的人。任何加快删除或插入等的技巧......

好的教程的链接会很棒。或者一些有用的代码片段更好。

提前致谢。

编辑：

这是来自 Blackberry 的一些使用事务的示例代码。

```
import net.rim.device.api.ui.*;
import net.rim.device.api.ui.component.*;
import net.rim.device.api.ui.container.*;
import net.rim.device.api.database.*;
import net.rim.device.api.io.*;
public class UsingTransactions extends UiApplication
{
public static void main(String[] args)
{
    UsingTransactions theApp = new UsingTransactions();
    theApp.enterEventDispatcher();
}
public UsingTransactions()
{

}
}

class UsingTransactionsScreen extends MainScreen
{
    Database d;
public UsingTransactionsScreen()
{
   LabelField title = new LabelField("SQLite Using Transactions Sample",
   LabelField.ELLIPSIS |
   LabelField.USE_ALL_WIDTH);
   setTitle(title);
   add(new RichTextField(
          "Updating data in one transaction in MyTestDatabase.db."));
   try
   {
      URI myURI = URI.create("file:///SDCard/Databases/SQLite_Guide/" +
          "MyTestDatabase.db");
      d = DatabaseFactory.open(myURI);

      d.beginTransaction();
      Statement st = d.createStatement("UPDATE People SET Age=7 " +
          "WHERE Name='Sophie'");
      st.prepare();
      st.execute();
      st.close();
      st = d.createStatement("UPDATE People SET Age=4 " +
          "WHERE Name='Karen'");
      st.prepare();
      st.execute();
      st.close();
      d.commitTransaction();
      d.close();
 }
 catch ( Exception e )
 {
      System.out.println( e.getMessage() );
      e.printStackTrace();
 }
  }
} 
```

他们每次都关闭声明是否有原因？在最后关闭一次不是更好吗（也许在 finally 块中？？）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:54:05.173

标准技术是在事务内的循环内使用准备好的插入语句。在大多数情况下，这将为您提供几乎最佳的效率。它将加快速度至少一个数量级。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:51:21.523

我个人不知道很多特定于黑莓的做法，但这些似乎很有帮助（抱歉我找不到代码片段）：

[《8 大 SQL 最佳实践》](http://sheeri.com/archives/104)

[“最佳实践：优化 SQLite 数据库性能”](http://docs.blackberry.com/en/developers/deliverables/17952/BP_Optimizing_SQLite_database_performance_1554266_11.jsp)

希望这些帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T04:32:46.690

您应该做的一件事是，为数据库处理代码创建不同的方法。并简单地从您的主代码中调用这些方法，并在每个块中**打开**和**关闭数据库。**它将减少冗余，对您的未来更好。这也将帮助您提高应用程序的性能。

# opencv - OpenCV 中的普通贝叶斯实现

> ID：10013524
> 
> 赞同：1
> 
> 时间：2012-04-04T14:44:44.320
> 
> 标签：opencv, machine-learning, computer-vision

我是机器学习的新手。我有一个关于如何在 OpenCV 中实现 Normal Bayes 的问题。

我对**Normal Bayes**和**Naive Bayes**这两个术语有误解。

这个[网站](http://www.emgu.com/wiki/index.php/Normal_Bayes_Classifier_in_CSharp)告诉**正常贝叶斯**和**朴素贝叶斯**的意思是一样的。

**OpenCV 网站**上的[NormalBayes](http://opencv.itseez.com/modules/ml/doc/normal_bayes_classifier.html)文档指定这些功能是正态分布的，不一定是独立的。

 **关于朴素贝叶斯分类器的[维基百科](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)文章告诉我们，假设特征是独立的。因此，不需要确定**协方差矩阵。**

但是，当我查看 Normal Bayes 分类器的实现源时，它**确实计算**了协方差矩阵。

[我还在这里](http://old.nabble.com/Normal-Bayes-Implementation--td33253038.html)找到了一个类似的问题，但没有得到回答。

**我在这里错过了什么吗？还是 OpenCV 中的 Normal Bayes 分类器不是标准的 Naive Bayes 分类器？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T14:12:13.503

从理论上讲，朴素贝叶斯模型假设“影响的原因之间完全独立”，而正态模型假设“来自每个类别的特征向量是正态分布的（尽管不一定是独立分布的）”。请注意，两者都使用均值向量和协方差矩阵，但是，模型假设不同。

在 OpenCV 中，“数据分布函数被假定为高斯混合，每类一个分量”，并且模型没有对这些类的独立性做出假设。**

# optimization - 场景图：递归还是迭代？

> ID：10013527
> 
> 赞同：0
> 
> 时间：2012-04-04T14:44:56.040
> 
> 标签：optimization, recursion, iteration, scenegraph

我和一位同事正在讨论在复杂游戏中通常如何渲染场景。他相信世界是以最真实的面向对象的方式*递归渲染的，世界上的许多演员都覆盖了像 Actor.Draw() 这样的虚拟函数（例如 Koopa.Draw()、Goomba.Draw()）。*

相比之下，我想象今天的复杂游戏会*迭代*他们的场景图，避免虚拟函数开销，并为专门的迭代器提供更大的灵活性（例如，近到远与远到近，跳过树中的某些对象等.) 我在 OpenGL 和 DirectX 方面的经验告诉我，他们倾向于批量绘制对象，并通过递归调用（即类的 Draw() 函数将绘制到的批处理）传递批处理上下文似乎是额外的参数 -传递可以通过迭代避免的开销。

如今，一种方法比另一种更受欢迎吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:57:07.193

*可以递归地*更新部分场景图。*但是*绘制*它通常是通过一些空间分区数据结构和几何/渲染状态批处理器来完成的，以防止过度绘制（通过从前到后绘制），并最大限度地减少渲染管道的状态切换（批处理数据，使用类似的绘制调用资源和渲染状态）。通常这个绘图部分在某种程度上是迭代的。*

 *您必须考虑场景的复杂程度、它们的组成以及正在绘制的对象数量。对于场景简单的项目或您事先拥有某些信息的项目，以最佳方式（接近）对渲染进行排序将不值得*计算*绘图顺序或批处理的实际成本。

最后，“首选”方法将是特定于项目的。*

# c# - 序列化具有大字节数组的对象时的 SerializableAttribute 或 IXmlSerializable

> ID：10013532
> 
> 赞同：1
> 
> 时间：2012-04-04T14:45:08.503
> 
> 标签：c#, xml-serialization, serializable, ixmlserializable

在我最近遇到[大对象堆碎片](https://stackoverflow.com/questions/9889925/outofmemoryexception-when-creating-multiple-byte-arrays)问题之后，我重新审视了我的一些可序列化类。我经常做一些 Xml 序列化和序列化/反序列化包含大字节数组的对象。

一般来说，我只使用 SerializableAttribute 并且不关心序列化细节，直到我真的需要一些特殊行为。然后我切换到 IXmlSerializable 接口，编写自己的序列化/反序列化代码。

当手动将字节数组序列化为 Xml 时，我更喜欢`XmlWriter.WriteBase64(byte[] buffer, int index, int count)`和`XmlReader.ReadElementContentAsBase64(byte[] buffer, int index, int count)`方法。这让我可以分块写入数据——非常方便。

但是当我只使用`SerializableAttribute`? .NET 框架内的自动序列化机制是按块写入数据（就像我手动执行的那样），还是只是通过创建非常大的字符串来保存使用 base64 序列化的整个字节数组来杀死大型对象堆？序列化器是否高效，或者我应该编写自己的序列化代码以确保写入数据而没有不必要的开销？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:02:26.730

使用 Reflector 对 System.Xml.Serialization.XmlSerializer（以及 XmlSerializationWriter 和 System.Xml.Base64Encoder）的一些快速探索表明，base64 字节数组在转换时被分块。

“序列化器效率高，还是我应该编写自己的序列化代码以确保写入数据时没有不必要的开销？”

“高效”不是二元条件；这是一个连续体。您真正的问题是“它对我的需要是否足够有效？”，答案取决于您的需要。很可能您只需要在 XmlSerializer 和您的自定义代码之间运行一些测试，看看哪些在对您最重要的性能维度上表现更好。

PS XmlSerializer 不使用 SerializableAttribute；它只是序列化所有公共读/写属性。只有 System.Xml.Serialization 中的 Xml*Attributes 会影响 XmlSerializer（当然还有 IXmlSerializable）。

# ruby - 在 Ruby 命令行程序中创建选项卡

> ID：10013535
> 
> 赞同：1
> 
> 时间：2012-04-04T14:45:18.473
> 
> 标签：ruby, shell, command-line

我想使用选项卡格式化从命令行工具返回的数据。我不确定该解决方案是否特定于 Ruby 或 MacOS，您能否提供一个如何执行此操作的示例？（可能是一个带有选项卡值的简单 Ruby`puts`语句）我所有的研究都返回了处理在同一个窗口中具有多个 shell 会话的项目。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:54:32.887

制表符由`"\t"`字符串中的 a 表示。

当字符串溢出字段时，您可能仍需要进行一些字符串大小检查。另外，选项卡的大小取决于设备/应用程序，因此如果只是将其导入到电子表格中，那么在所有查看机制（编辑器、终端、寻呼机等）中，事情不一定会以相同的方式对齐，而不是事情。

IIRC 有一些 gems/libraries 用于执行各种文本对齐任务，目前没有参考。

# javascript - 从 Div 获取图像文件名并在按钮悬停时复制到文本字段中

> ID：10013540
> 
> 赞同：1
> 
> 时间：2012-04-04T14:45:38.813
> 
> 标签：javascript, jquery, forms, function, button

在 ID 为 #prlogo 的 div 中，我有图像。当我将鼠标悬停在 ID 为 #button 的按钮上时，我需要将服务器上图像的文件名或位置复制到 ID 为 #input_2_16 的文本文件中。

听起来很简单，但我一直在努力做到这一点......

div html：

```
<div id="prlogo" class="prlogo"><img class="logoplace" src="../preview/logo-place.png"/>
        </div> 
```

米罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:56:41.317

没有更多上下文并使用 jQuery。

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript">
$(function() { //this anonymous function will run when the page is ready
    $("#button").hover(function() {
      //mouse enter
      var imgSrc = $("#prlogo img").attr("src"); 
      //assumes there is an <img /> tag as a child of the #prlogo div
      $("#input_2_16").val(imgSrc);
    },function() {
      //mouse leave
    });
});
</script> 
```

如果您不想在鼠标离开时做任何事情，您可以改为

```
$("#button").mouseenter(function() {
  //mouse enter
  var imgSrc = $("#prlogo img").attr("src"); 
  //assumes there is an <img /> tag as a child of the #prlogo div
  $("#input_2_16").val(imgSrc);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:57:50.947

如果我没看错的话，应该是这样的：

```
$( function () {
    $( '#button' ).mouseover( function () {
        var src = $( '#prlogo img' ).attr( 'src' );
        $( '#input_2_16' ).val( src );
    } );
} );
​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:11:34.993

如果您需要在 DOM 中向下移动不止一层，请使用 .find 代替 .children。

```
$('#button').on('hover', function(){
        $('#input_2_16').val($('#prlogo').children('img').attr('src'));
}); 
```

# java - 内联实现的接口缩进

> ID：10013543
> 
> 赞同：3
> 
> 时间：2012-04-04T14:45:53.727
> 
> 标签：java, eclipse, interface, indentation

我注意到当我在类主体本身中内联实现一个接口时，即。不在方法内部，

```
Runnable r = new Runnable() {    

    @Override
    public void run() {
        // do something
    }
}; 
```

然后按`CTRL`++ （自动修复缩进），eclipse缩进的`SHIFT`方法*很多*：`F`

 *```
Runnable r = new Runnable() {
                            @Override
                            public void run() {
                               // do something
                            }
}; 
```

其他人遇到过这个吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T04:08:50.173

从格式化程序的第一个选项卡中取消选中“对齐列中的字段”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T14:47:50.573

取决于您的日食设置。您可以通过单击更改默认格式：窗口 > 首选项 > java > 代码样式 > 格式化程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T01:22:09.330

在 Eclipse 首选项中，转到格式化程序页面（Window->Preferences、Java->Code Style->Formatter）。编辑格式“配置文件”。转到“空白行”选项卡，并将“第一次声明之前”的值从 1 更改为 0。

仅供参考，这将更改所有类的格式，而不仅仅是匿名类。如果它更细化就好了，但它确实存在。*

# javascript - Object.getPrototypeOf() 混淆

> ID：10013544
> 
> 赞同：4
> 
> 时间：2012-04-04T14:45:57.097
> 
> 标签：javascript, dom

Object.getPrototypeOf(obj) 是如何工作的？

根据定义 Object.getPrototypeOf(obj) 应该返回 Object 的原型属性，或者以另一种方式它与 obj.constructor.prototype 相同。

使用 new 创建的对象使用其构造函数的原型属性值作为其原型。

举个例子：

```
>element = document.getElementById("test")

>a = Object.getPrototypeOf(element)
HTMLDivElement 
```

假设 HTMLDivElement 是元素的原型。

```
>a.constructor.prototype
HTMLDivElement 
```

所以 a.constructor.prototype 是 HTMLDivElement 所以 Object.getPrototypeOf(a) 应该返回 HTMLDivElement 但它返回 HTMLElement。我完全对 getPrototypeOf() 的定义感到困惑。

```
>b = Object.getPrototypeOf(a) 
```

HTMLElement ----> 为什么？a.constructor.prototype 是 HTMLDivElement

实际上它是返回原型的**proto**属性，根据 getPrototypeOf() 的定义是不是错了？

```
>a.constructor.prototype.__proto__
 HTMLElement 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-04T15:37:13.157

引用自[https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Inheritance_Revisited](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Inheritance_Revisited)

> JavaScript 对于来自 Java 或 C++ 的开发人员来说有点令人困惑，因为它都是动态的，都是运行时的，而且它根本没有类。这一切都只是实例（对象）。甚至我们模拟的“类”也只是一个函数对象。

* * *

**注意原型也是一个对象，所以它也可以有它自己的唯一原型**

所以让你感到困惑的代码看起来像这样

```
a = Object.getPrototypeOf(element)
b = Object.getPrototypeOf(a) 
```

可以翻译成这个

```
a = element.__proto__
b = element.__ptoto__.__proto__ 
```

**我认为现在很清楚 `a != b`**

* * *

1) JavaScript中的每个**对象****都有一个原型**，你可以通过`__proto__`属性访问它

2）**函数**在Javascript中也是一个**对象**

3) 函数也有`prototype`属性

4) 我们**可以**在 JavaScript 中通过使用关键字调用函数来创建对象`new`

4) 函数`prototype`是**它们创建的**任何对象的**初始值** `__proto__`

 *** * *

要创建新对象，我们可以编写类似这样的内容

```
//here we define a function
function SomeFunctionThatCreateObject() {
    this.someStringProperty = "blablabla";
} 

var obj = new SomeFunctionThatCreateObject(); //we create new object with function

var p = Object.getPrototypeOf(obj); 
```

此代码等于此

```
var SomeFunctionThatCreateObject = function(@this) {
    @this.someStringProperty = "blablabla";
    return @this;
};

SomeFunctionThatCreateObject.prototype = {}; //note that prototype is also an object

var obj = {};

obj = SomeFunctionThatCreateObject(obj);

obj.constructor = SomeFunctionThatCreateObject;

obj.__proto__ = SomeFunctionThatCreateObject.prototype;

var p = obj.__proto__; 
```

* * *

PS：还阅读此 [https://stackoverflow.com/a/9220317/474290](https://stackoverflow.com/a/9220317/474290) 和此 [https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Inheritance_Revisited](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Inheritance_Revisited)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:27:29.087

```
var elem =  document.getElementsByTagName("div")[0],
a = Object.getPrototypeOf ( elem );
console.log( elem.__proto__ ); //HTMLDivElement
console.log( a ); // HTMLDivElement
console.log( a.__proto__ ); //HTMLElement
console.log( Object.getPrototypeOf ( a ) ); //HTMLElement 
```

所以`Object.getPrototypeOf`返回`object.__proto__`( `object.constructor.prototype`)**

# r - R有任何官方命名约定吗？

> ID：10013545
> 
> 赞同：32
> 
> 时间：2012-04-04T14:45:58.423
> 
> 标签：r

大多数编程语言对函数、参数、类等都有官方的命名约定。这里的官方意味着约定是由语言背后的组织发布的。

**R有任何官方命名约定吗？**

我知道[之前](https://stackoverflow.com/questions/1944910/what-is-your-preferred-style-for-naming-variables-in-r)在 stackoverflow 上讨论过命名约定和 R，但那是前一段时间了，我的问题不是“你喜欢什么命名约定？” 而是关注是否存在官方命名约定。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-04T14:57:18.123

[R 开发人员页面](http://developer.r-project.org/)包含来自 R-core的“R 统计系统或多或少最终确定的想法和计划”。它不包含有关命名约定的任何信息。简要看一下核心 R 代码将证实这一点。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-04T15:03:53.033

R-core 有一个[编码标准指南](http://cran.r-project.org/doc/manuals/R-ints.html#R-coding-standards)，但这不包括变量命名约定。

Bioconductor 还有一个[编码标准指南](https://www.bioconductor.org/developers/how-to/coding-style/)，推荐使用 lowerCamelCase。

这里有这些和其他几个风格指南的[链接](http://4dpiecharts.com/r-code-style-guide/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-12-27T08:27:55.833

Check out "[The State of Naming Conventions in R](http://journal.r-project.org/archive/2012-2/RJournal_2012-2_Baaaath.pdf)" for a good discussion on the topic!

I would like to quote the following:

> Both the CRAN data and the style guides show that there is **no consensus** regarding naming conventions in R and this it likely to continue as naming conventions, to a large degree, are a matter of taste and habit.
> 
> What is most important, however, is to keep a **consistent naming convention** style within your code base, whether you are working on a personal project or developing a package.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-15T09:08:43.590

正如其他人所回答的那样，**没有官方的 R 编码风格**，但如果您正在寻找一致的、经过深思熟虑的风格指南[http://style.tidyverse.org/](http://style.tidyverse.org/)是一个不错的起点。它由流行的 tidyverse 系列软件包（dplyr、ggplot、tidyr 等）的作者编写，并被广泛的流行软件包使用。

作为 2017 年，这也是最流行的命名约定，根据 dwstu 的回答和提问者中引用的论文作者 Rasmus Bååth 在 userR2017 的演讲： [https ://channel9.msdn.com/Events/user- international-R-User-conferences/user-International-R-User-2017-Conference/Room-302-Lightning-Talks](https://channel9.msdn.com/Events/useR-international-R-User-conferences/useR-International-R-User-2017-Conference/Room-302-Lightning-Talks)（10:30 左右开始）

# amazon-ec2 - SIP 和 EC2 弹性 IP

> ID：10013549
> 
> 赞同：3
> 
> 时间：2012-04-04T14:46:10.963
> 
> 标签：amazon-ec2, sip, nat, ifconfig

我正在尝试使自定义 SIP 软件在 EC2 实例上运行。我的软件目前没有 NAT 处理能力，我想知道是否可以让它与与 EC2 实例关联的公共（弹性）IP 透明地工作。

这是在我的 EC2 机器上运行的“iconfig -a”的输出：

eth0 Link encap:Ethernet HWaddr XXXXXX
inet addr: PRIVATE-IP-ADDRESS Bcast:10.48.195.255 Mask:255.255.254.0
inet6 addr: XXXXXX/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packet:3825 错误： 0 丢弃：0 超限：0 帧：0
TX 数据包：3596 错误：0 丢弃：0 超限：0 载波：0
冲突：0 txqueuelen：1000
RX 字节：259666 (253.5 KiB) TX 字节：1106872 (1.0 MiB)

lo Link encap:Local Loopback
inet addr:127.0.0.1 Mask:255.0.0.0
inet6 addr: ::1/128 Scope:Host
UP LOOPBACK RUNNING MTU:16436 Metric:1
RX packet:78 errors:0 dropped:0 overruns:0帧：0
TX 数据包：78 错误：0 丢弃：0 超限：0 载波：0
冲突：0 txqueuelen：0
RX 字节：6892 (6.7 KiB) TX 字节：6892 (6.7 KiB)

有没有办法改变这一点，以便我的应用程序可以透明地打开 PUBLIC（弹性）IP 地址上的 UDP 套接字？并且基本上就像公共 IP 通常分配给 eth0 一样工作。

我考虑过使用 iptables DNAT/SNAT 或手动添加 IP 地址，但目前没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:46:46.900

我建议为 EC2 购买静态 IP。你会省**很多**力气。尽管如此，您通常必须考虑 SIP 通信中的 NAT。顺便说一句，在大多数情况下，nat 遍历是从基础设施处理的 - sip 路由器/网关/sip 服务器 - 它在您的 SIP 消息中添加/删除“路由”标头。SIP 服务意图拥有公共端点，所以我不确定您是否必须实现 NAT 功能。你所说的这个*定制的 SIP 软件*，我假设它是客户端，而不是服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T23:05:55.797

答案是不。当 SIP 服务器应用程序使用私有 IP 地址时，没有好的方法可以让其在 Internet 上透明地工作。服务器应用程序需要知道它的公共 IP 地址以及它应该优先使用该 IP 地址而不是私有 IP 地址这一事实。SIP 需要在多个标头中插入公共地址，例如 Record-Route、Route 和 Contact。作为服务器，它还需要使用 SDP 有效负载中的公共 IP 地址来进行 INVITE 请求和响应。大多数 SIP 服务器应用程序都具有执行此操作的能力，如果您正在编写自定义服务器，那么建议您添加该功能。

除了上述之外，还有一种方法可以让您摆脱使用私有 IP 地址，那就是在您的应用程序前面安装一个 SIP 应用层网关 (ALG)，并使用它来破坏 SIP 中的所有私有 IP 地址来自您的服务器的数据包。然而 SIP ALG 是一场灾难，并且总是导致比他们解决的问题更多的问题，所以我强烈建议你不要走这条路。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T22:49:32.633

我有一些与此类似的问题，我通过编辑我的 sip_nat.conf 文件来解决以下问题：

```
externip=x.x.x.x
localnet=10.0.0.0/255.0.0.0
nat=yes 
```

当然，您的里程可能会有所不同，但这似乎解决了很多问题。当然，如果您的 IP 更改或启动新实例，您必须想办法更新 Asterisk 的配置并重新加载设置。

我的理解是没有告诉它 IP 地址，它总是 ping 一些服务器来取回它，但是 Asterisk 有一个问题，如果它在 ping 响应之前收到任何其他数据，它就不够聪明，无法知道它不是 IP地址。硬编码似乎可以解决很多问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T09:02:06.973

[来自https://forums.aws.amazon.com/](https://forums.aws.amazon.com/)的回答

> 弹性 IP 地址使用 1:1 NAT 映射到实例。实例本身不知道公共地址。由于这个地址不能绑定到接口上，恐怕你需要换一种方式处理。您需要避免更改网络配置，因为它可能会导致连接丢失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-16T12:59:02.457

这是另一种使您的 sip 与星号配合良好的方法。

在 sip.conf 或 chan_sip.conf ->`[general]`设置中，添加这些

```
nat=force_rport,comedia
externip=<PUBLIC_IP/ELASTIC_IP>
localnet=<PRIVATE_IP>/20 
```

如果您没有使用弹性 IP，那么您可能必须在每次重新启动服务器时更改公共 ip。希望这可以帮助

# ios - Apple AS 汇编器是否将某些 NEON 指令替换为 iOS 上的等效指令？

> ID：10013557
> 
> 赞同：3
> 
> 时间：2012-04-04T14:46:46.080
> 
> 标签：ios, ffmpeg, arm, neon

我试图在 iOS 上使用 ffmpeg 并在优化的 arm 代码中调试崩溃。我发现一些无符号（.u16，.u32）指令已被有符号（.i16，.i32）取代。很容易看出，因为 GDB 上的反汇编指令与源代码不太匹配。

例如，

```
vrshrn.u32 -> vrshrn.i32
vrshrn.u16 -> vrshrn.i16
vadd.u16 -> vadd.i16 
```

我的问题：

1.  这种行为是否正确且符合预期？如果不是，我们如何纠正它？
2.  如果它们是等价的，为什么我们还需要未签名的呢？是因为这样代码更明确吗？
3.  其他平台的工具包是否会出现这种行为？比如Android的工具包？（听说苹果的AS很老了）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:03:04.340

这些指令不依赖于元素的符号——这实际上是`.Inn`后缀的意思。汇编器仍然接受其中一个`.Snn`或`.Unn`版本，但反汇编只会使用`.Inn`.

对于区分有符号和无符号整数的指令（例如`VMULL`），汇编器不接受`.Inn`后缀，而只接受`.Snn`or `.Unn`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T18:02:53.090

它们是相同的指令。该标志对操作没有影响。

```
$ cat neon.s 
    .text
    .code 32
    .globl _foo
_foo:
    vrshrn.u32 d0, q0, #1
    vrshrn.i32 d0, q0, #1

$ otool -tv neon.o 
neon.o:
(__TEXT,__text) section
_foo:
00000000    f29f0850    vrshrn.i32  d0, q0, #1
00000004    f29f0850    vrshrn.i32  d0, q0, #1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T02:30:14.037

一般来说，您可以放心，汇编器不会像某些编译器那样做任何疯狂的事情。当汇编器改变一些指令时，它大多是完全等价的或伪指令。

# spring - Spring的EntityManager没有持久化

> ID：10013559
> 
> 赞同：0
> 
> 时间：2012-04-04T14:46:54.413
> 
> 标签：spring, hibernate, jpa, spring-transactions, transactional

好吧，我的项目使用 EJB 和 JPA（使用 Hibernate），但我不得不切换到 Spring。在此之前一切都运行良好。EJB 用于注入 EntityManager、控制事务等。

好的，当我切换到 Spring 时，我遇到了很多问题，因为我是 Spring 新手。但是在一切运行之后，我遇到了问题：数据永远不会保存在数据库中。我配置了我的 Spring 来控制事务，我在 JSF 中使用了 spring bean，它具有执行艰苦工作的 spring 服务。该服务注入了一个 EntityManager 并使用@Transactional REQUIRED。该服务将 EntityManager 传递给调用 entityManager.persist(bean) 的 DAO。

选择似乎运行良好，JTA 事务似乎运行良好（我在日志中看到），但实体没有保存！

这是日志：

```
INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter: doFilterInternal() (linha 136): Opening JPA EntityManager in OpenEntityManagerInViewFilter

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.beans.factory.support.DefaultListableBeanFactory: doGetBean() (linha 245): Returning cached instance of singleton bean 'transactionManager'

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: getTransaction() (linha 365): Creating new transaction with name [br.org.cni.pronatec.controller.service.MontanteServiceImpl.adicionarValor]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; ''

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: doBegin() (linha 493): Opened new Session [org.hibernate.impl.SessionImpl@2b2fe2f0] for Hibernate transaction

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: doBegin() (linha 504): Preparing JDBC Connection of Hibernate Session [org.hibernate.impl.SessionImpl@2b2fe2f0]

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: doBegin() (linha 569): Exposing Hibernate transaction as JDBC transaction [com.sun.gjc.spi.jdbc40.ConnectionHolder40@3bcd4840]

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler: doJoinTransaction() (linha 383): Joined JTA transaction

INFO: Hibernate: 
    select
        hibernate_sequence.nextval 
    from
        dual

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: processCommit() (linha 752): Initiating transaction commit

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: doCommit() (linha 652): Committing Hibernate transaction on Session [org.hibernate.impl.SessionImpl@2b2fe2f0]

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.HibernateTransactionManager: doCleanupAfterCompletion() (linha 734): Closing Hibernate Session [org.hibernate.impl.SessionImpl@2b2fe2f0] after transaction

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.hibernate3.SessionFactoryUtils: closeSession() (linha 800): Closing Hibernate Session

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter: doFilterInternal() (linha 154): Closing JPA EntityManager in OpenEntityManagerInViewFilter

INFO: [Pronatec] - 04/04/2012 11:30:20 - [DEBUG] org.springframework.orm.jpa.EntityManagerFactoryUtils: closeEntityManager() (linha 343): Closing JPA EntityManager 
```

在日志中，我看到它正在提交事务，但我没有看到插入查询（Hibernate 正在打印任何查询）。我还看到 Hibernate 查找以获取序列 ID 的下一个值。但在那之后，它永远不会真正插入。

这是弹簧上下文配置：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
<property name="persistenceUnitName" value="PronatecPU" />
<property name="persistenceXmlLocation" value="classpath:META-INF/persistence.xml" />
<property name="loadTimeWeaver">
    <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver"/>
</property>
<property name="jpaProperties">
    <props>
    <prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JTATransactionFactory</prop>
    </props>
</property>
</bean>

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager" >
    <property name="transactionManagerName" value="java:/TransactionManager" />
<property name="userTransactionName" value="UserTransaction" />
<property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />

<tx:annotation-driven transaction-manager="transactionManager" /> 
```

这是我的persistence.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
  <persistence-unit name="PronatecPU" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc/pronatec</jta-data-source>
    <class>br.org.cni.pronatec.model.bean.AgendamentoBuscaSistec</class>
    <class>br.org.cni.pronatec.model.bean.AgendamentoExportacaoZeus</class>
    <class>br.org.cni.pronatec.model.bean.AgendamentoImportacaoZeus</class>
    <class>br.org.cni.pronatec.model.bean.Aluno</class>
    <class>br.org.cni.pronatec.model.bean.Curso</class>
    <class>br.org.cni.pronatec.model.bean.DepartamentoRegional</class>
    <class>br.org.cni.pronatec.model.bean.Dof</class>
    <class>br.org.cni.pronatec.model.bean.Escola</class>
    <class>br.org.cni.pronatec.model.bean.Inconsistencia</class>
    <class>br.org.cni.pronatec.model.bean.Matricula</class>
    <class>br.org.cni.pronatec.model.bean.Montante</class>
    <class>br.org.cni.pronatec.model.bean.ParametrosVingentes</class>
    <class>br.org.cni.pronatec.model.bean.TipoCurso</class>
    <class>br.org.cni.pronatec.model.bean.Turma</class>
    <class>br.org.cni.pronatec.model.bean.UnidadeFederativa</class>
    <class>br.org.cni.pronatec.model.bean.ValorAssistenciaEstudantil</class>
    <class>br.org.cni.pronatec.model.bean.ValorHora</class>
    <exclude-unlisted-classes>true</exclude-unlisted-classes>
    <properties>
      <property name="current_session_context_class" value="thread"/>
      <property name="hibernate.show_sql" value="true"/>
      <property name="hibernate.format_sql" value="true"/>
      <property name="hibernate.dialect" value="org.hibernate.dialect.OracleDialect"/>
      <property name="hibernate.transaction.manager_lookup_class" value="org.hibernate.transaction.SunONETransactionManagerLookup"/>
      <property name="hibernate.hbm2ddl.auto" value="update"/>
    </properties>
  </persistence-unit>
</persistence> 
```

这是我在托管 bean 中注入的服务：

```
@Service
@Scope("prototype")
@Transactional(propagation= Propagation.REQUIRED)
public class MontanteServiceImpl {
    // more code
    @PersistenceContext(unitName="PronatecPU", type= PersistenceContextType.EXTENDED)
    private EntityManager entityManager;
    // more code
    // The method that is called by another public method that do something before
    private void salvarMontante(Montante montante) {
        montante.setDataTransacao(new Date());

        MontanteDao montanteDao = new MontanteDao(entityManager);
        montanteDao.salvar(montante);
    }
    // more code
} 
```

我的 MontanteDao 继承自基础 DAO，如下所示：

```
public class MontanteDao extends BaseDao<Montante> {

    public MontanteDao(EntityManager entityManager) {
        super(entityManager);
    }

} 
```

BaseDao 中调用的方法是这样的：

```
public void salvar(T bean) {
    entityManager.persist(bean);
} 
```

如您所见，它只是选择注入的 entityManager 并调用 persist() 方法。事务由 Spring 控制，就像打印在日志中一样，但是插入查询永远不会打印在日志中，也永远不会保存。

我很抱歉我的英语不好。提前感谢谁提供帮助。

编辑：调试，我看到在每个 entityManager.persist(T) 之后，在“插入”类型的 actionQueue 中加入了另一个动作。毕竟，它只是对动作进行排队，而从不执行它们。有没有人已经遇到过这种问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:16:49.250

尝试强制[刷新](http://docs.oracle.com/javaee/5/api/javax/persistence/EntityManager.html#flush%28%29)到数据库。

```
entityManager.flush(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T13:55:06.687

好吧，我终于解决了我的问题。JTA 存在一些错误配置。我不知道可能是什么，但我改为 RESOURCE_LOCAL 并且它起作用了。

第一次尝试 RESOURCE_LOCAL 时，Glassfish 验证了 @PersistenceContext 注释并抛出“无法解析与 persistence-context-ref-name[...] 对应的持久性单元”时遇到了麻烦。然后我找到了一个禁用此验证的好方法：指定

```
metadata-complete=true 
```

在我的 web.xml 上。它说“不要看注释，因为没有必要”。好吧，Spring 是我的容器，它自己会查看注释并配置所需的内容。然后我不需要我的服务器这样做。

毕竟，我的配置是这样的：

网页.xml：

```
<web-app version="3.0"
     xmlns="http://java.sun.com/xml/ns/javaee"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="
      http://java.sun.com/xml/ns/javaee
      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
      metadata-complete="true"> 
```

Spring 的 context.xml：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="PronatecPU" />
    <property name="persistenceXmlLocation" value="classpath:META-INF/persistence.xml" />
    <property name="loadTimeWeaver">
        <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver"/>
    </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager" >
    <property name="entityManagerFactory" ref="entityManagerFactory" />
    </bean>

    <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />

    <tx:annotation-driven /> 
```

持久性.xml：

```
<persistence-unit name="PronatecPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <non-jta-data-source>jdbc/pronatec</non-jta-data-source>
    <!-- ... --> 
```

还有我注入的 entityManager：

```
@PersistenceContext(type= PersistenceContextType.EXTENDED)
private EntityManager entityManager; 
```

我希望这会帮助有同样问题的人。

# mysql - 以 DRY 方式创建活动/存档模型 (Django)

> ID：10013563
> 
> 赞同：1
> 
> 时间：2012-04-04T14:47:05.460
> 
> 标签：mysql, django, class, inheritance, model

我有一个像下面这样的模型，它变得太大，需要拆分成一个单独的活动表。一天结束时，一个表将包含所有对象，而另一个表将仅包含活动对象。

```
 class Tickets(models.Model):
        price = ....
        number = .....
        date = ....
        active = ....
        parent = models.ForeignKey('self', related_name='children')

        ManyMoreFields 
```

复杂性有两个来源：

1) ActiveTickets 表的父字段将指向Tickets 表。related_name 不应更改。

2) ActiveTickets 和Tickets 表都有从它们继承的代理模型。

```
 class CityTickets(Tickets):

          class Meta:
             proxy = True

     class ActiveCityTickets(ActiveTickets):
          class Meta:
             proxy = True 
```

显然，我可以复制并粘贴 Ticket 中的所有字段（有很多），但这不是正确的做法。我尝试使用抽象继承和 Mixins（在由门票和 ActiveTickets 继承的单独类中定义字段）。

抽象继承的一个问题是 ForeignKey 字段 parent 会导致问题，因为它是重复的，并且 related_name 是相同的。通常，我的尝试导致我的单元和功能测试失败。

这里有哪些优雅的方法？我是否应该考虑创建两个单独的 MySQL 表，然后只使用具有多个管理器（和 db 路由器）的单个模型？这合理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:34:18.447

也许这有帮助：

```
class Base(models.Model):
    m2m = models.ManyToManyField(OtherModel, related_name="%(app_label)s_%(class)s_related")

    class Meta:
        abstract = True 
```

[https://docs.djangoproject.com/en/dev/topics/db/models/#be-careful-with-related-name](https://docs.djangoproject.com/en/dev/topics/db/models/#be-careful-with-related-name)

# objective-c - 使用 TouchXML 在 iPhone 上无法访问已解析的 .xml 文件中的 NSArray 元素

> ID：10013570
> 
> 赞同：1
> 
> 时间：2012-04-04T14:47:30.203
> 
> 标签：objective-c, ios, nsarray, touchxml

我有一个`NSMutableArray *myArray`.xml 文件，这是正确解析文件的结果，使用`TouchXML`.

我只想用 key 提取所有元素`name`并将其存储在一个单独的`NSMutableArray`中，但我的 final`NSMutableArray *namesList`无法访问，立即使我的 iPhone 应用程序崩溃，因为它只包含最后一个枚举字符串而不是整个数组。

这是代码：

```
NSMutableArray *namesList = [[NSMutableArray alloc] initWithArray:myArray copyItems:YES];

       int i;
        for (i = 0; i < [myArray count]; i++) 
           {
            namesList = [[myArray objectAtIndex:i] objectForKey:@"name"];
            NSLog(@"All Names: %@", namesList);    
           }

          NSLog(@"First Name: %@", [namesList objectAtIndex:0]); <-- crashing line 
```

这是 NSLog：

```
-[__NSCFString objectAtIndex:]: unrecognized selector sent to instance 0x6a42540
2012-04-04 10:34:07.882 Sections[3610:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString objectAtIndex:]: unrecognized selector sent to instance 0x6a42540' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:24:28.063

`[[myArray objectAtIndex:i] objectForKey:@"name"];`返回一个`NSString`对象而不是另一个数组，因此您不能向`objectAtIndex`它发送一个。检查数组的结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T16:53:37.813

你应该能够做到这一点：

```
NSMutableArray * namesList = [NSMutableArray alloc] init];

for(i = 0; i < [myArray count]; i++)
{ 

    NSString * tempString = [NSString stringWithString:[[myArray objectAtIndex:i] objectForKey:@"name"]];
    [namesList addobject:tempString];
}

 NSLog(@"First Name: %@", [namesList objectAtIndex:0]); 
```

# php - 如何输出可以通过 embed 或 iframe 共享的内容？

> ID：10013572
> 
> 赞同：0
> 
> 时间：2012-04-04T14:47:44.523
> 
> 标签：php, javascript, html

我想创建一个可以保存输入的表单，然后允许用户嵌入输出 iframe（类似于 youtube.com）？

内容将主要是文字和一些图像。

# java - 在java中反序列化json推文

> ID：10013578
> 
> 赞同：0
> 
> 时间：2012-04-04T14:48:12.710
> 
> 标签：java, json, twitter, org.json

我正在尝试制作一个程序来使用我从 twitter 流 API (https://stream.twitter.com/1/statuses/sample.json) 获得的数据。因为这是我第一次遇到 Json，所以我遇到了一些问题。我四处寻找 Java 中 JSON 的不同选项，并决定使用 org.json 库，因为它支持以通用 Map 格式进行反序列化，这非常有用，因为并非我从该 API 获得的所有 JSON 对象都具有相同的结构.

我执行此任务的代码部分如下所示：

```
try {
        // Open the file that is the first
        // command line parameter
        FileInputStream fstream = new FileInputStream("twits");
        // Get the object of DataInputStream
        DataInputStream in = new DataInputStream(fstream);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        String strLine;
        //Read File Line By Line
        while ((strLine = br.readLine()) != null) {

            JSONObject json = new JSONObject(strLine);
            //do something with json
        }
        //Close the input stream
        in.close();
    } catch (Exception e) {//Catch exception if any
        System.err.println("Error: " + e.getMessage());
    } 
```

当我运行程序时，出现此异常：错误：无法编译的源代码 - 错误的 ctor 符号类型：

我尝试调试它，似乎当有一个对象嵌套在另一个对象中时它会崩溃，但这应该是受支持的。

我感谢任何形式的帮助！

费德里科

# mongodb - 没有嵌入纬度经度字段的 MongoDB 地理空间查询

> ID：10013579
> 
> 赞同：3
> 
> 时间：2012-04-04T14:48:18.373
> 
> 标签：mongodb, geocoding, geospatial

我有一个从 csv 文件导入的非常大的数据库（约 600 万行）。我正在查看 MongoDB 和他们关于 GeoSpatial indexing 的文档。您需要将纬度和经度字段嵌入到数组中。不幸的是，我导入的结构具有单独的字段。

“纬度”：54.770233，“经度”：-6.537741，

是否有任何可能的方法来查询数据库以使用纬度 54 和经度 -6 计算 25 英里半径内的 20 个最近的文档。

我在 MySQL 中很好地创建了查询：

选择 * , ( 3959 * ACOS( COS( RADIANS( 54 ) ) * COS( RADIANS( `latitude`) ) * COS( RADIANS( `longitude`) - RADIANS( -6 ) ) + SIN( RADIANS( 54 ) ) * SIN( RADIANS( `latitude`) ) ) ) AS distance FROM table_name HAVING distance <25 ORDER BY distance LIMIT 0 , 20

但是，我不确定如何在没有嵌入字段的情况下在 Mongo 中执行此操作。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:11:42.063

我不认为你可以。我会运行一个脚本来检查和更新所有文档，这需要一段时间但不会太长。然后你可以像往常一样创建一个二维索引。

```
> db.test.insert({latitude:73,longitude:-47});
> db.test.insert({latitude:20,longitude:-30});
> db.test.find().forEach(function(doc) {
  doc.loc = [doc.longitude, doc.latitude];
  db.test.save(doc);
});
> db.test.find();
{ "_id" : ObjectId("4f7c63f117cd93783bba936d"), "latitude" : 73, "longitude" : -47, "loc" : [ 73, -47 ] }
{ "_id" : ObjectId("4f7c63f817cd93783bba936e"), "latitude" : 20, "longitude" : -30, "loc" : [ 20, -30 ] } 
```

**更新**实际上，我想您可以使用 where 子句来做到这一点，但它不会使用任何索引。但如果它是一次性查询，它可能会没问题。

```
db.test.find("( 3959 * Math.acos(Math.cos( 54 * 0.0174532925 ) * Math.cos( this.latitude * 0.0174532925 ) * Math.cos( this.longitude * 0.0174532925 ) - (-6 * 0.0174532925)) + Math.sin( 54 * 0.0174532925 ) * Math.sin( this.latitude * 0.0174532925 )) > 25 "); 
```

这实际上不起作用——计算的结果太大了。我只是想复制你的数学，但一定有什么不对劲。无论如何，按距离排序也将是一个问题。我认为第一个解决方案更容易使用。

# ssis - 使用 TFS 2008 构建 SSIS 2008 解决方案

> ID：10013585
> 
> 赞同：1
> 
> 时间：2012-04-04T14:48:27.530
> 
> 标签：ssis, continuous-integration

我正在尝试使用 TFS 2008 构建 SSIS 2008 解决方案。我使用构建定义向导创建了一个“TFSBuild.proj”文件。我的构建似乎可以工作，但在最后一步失败并出现错误......

> (0,0)：警告 MSB4126：指定的解决方案配置“Release|Any CPU”无效。请使用配置和平台属性（例如 MSBuild.exe Solution.sln /p:Configuration=Debug /p:Platform="Any CPU"）指定有效的解决方案配置，或将这些属性留空以使用默认解决方案配置。

我试过了...

1.  将“TFSBuild.proj”中的“FlavorToBuild”和“PlatformToBuild”值留空
2.  将“TFSBuild.proj”文件中的“FlavorToBuild”和“PlatformToBuild”值修改为各种其他字符串

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:02:30.863

显然，您不能开箱即用地构建 SSIS 项目文件，因为它们不是 MSBuild 格式。伟大的！！- 讽刺超载。

# sql - 在记事本++中格式化字符串的宏

> ID：10013586
> 
> 赞同：1
> 
> 时间：2012-04-04T14:48:30.573
> 
> 标签：sql, macros, notepad++

我有大量数据要转换为不同的格式，而无需手动操作。我相信应该有一种方法来创建各种宏，从长远来看，这项任务的耗时要少得多！

我的数据看起来像：

设备雇佣 = 99

设备购买 = 100

设备规格 = 101

等等。我希望它全部转换成这样：（所以我可以将它加载到数据库中）

INSERT INTO table_name VALUES (99, 'EquipmentHire');

谁能帮我吗？谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:57:01.453

我在 MS-Excel 中使用字符串连接和字符串操作函数（如 substring()、charindex()）完成了类似的任务。

基本上，在 Excel 中打开您的文本文件（假设文本将在 A 列中），将 B 列设置为 A 列的字符串操作，向下复制所有行的公式，然后将 B 列内容复制到新的文本文件.

如果这是一次性的，那对我来说将是比编写宏更快的方法。不久前，我也通过 powershell 脚本做了类似的事情，但同样，一次性 Excel 对我来说更快。

**添加了**——

Excel 示例公式。这是非常非常依赖格式的。如果您的数据始终是一致的格式（等号周围的确切空格数等）。如果您需要经常这样做，或者您的格式会因空格等而有所不同，Perl、powershell、宏等可能是更好的方法。

假设 EquipmentHire = 99 是 A1 的内容，以下将在单元格 B1 中为您提供 SQL 语句。

`="INSERT INTO table_name VALUES ("&MID(A1,FIND("=",A1)+2,1000)&", '" & MID(A1,1,FIND("=", A1)-2) & "');"`

使用原始帖子和 MS-Excel 2k10 中的示例数据进行测试

# jquery - 使用 jquery After() 时如何引用当前参考

> ID：10013587
> 
> 赞同：0
> 
> 时间：2012-04-04T14:48:36.677
> 
> 标签：jquery, jquery-selectors

我有多个名为**day-number**的类的 div 。我想在每个实例之后放置一些文本。所以这很好用。.

```
 $('.day-number').after('Put this after'); 
```

我现在需要在 .after() 中包含一些内容，即 .day-number 的 .text()。如何在 .after() 方法中引用 .day-number 的各个实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:50:23.090

```
$('.day-number').each(function(){
    var $this = $(this);
    var txt = $this.text();
    $this.after('Put this after ' + txt);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:52:49.330

大多数 jQuery DOM 操作方法都接受一个函数作为参数，所以你可以这样做：

```
$('.day-number').after(function() {
    return 'Put this after ' + $(this).text();
}); 
```

# objective-c - 将阴影应用到 UIImageView 数组

> ID：10013590
> 
> 赞同：3
> 
> 时间：2012-04-04T14:48:43.790
> 
> 标签：objective-c, ios, uiimageview, shadow

我有一个数组`UIImageViews`。我想对这些图像中的每一个应用阴影。我使用了下面的代码：

```
- (void)awakeFromNib {
    for (UIImageView *image in imagesJigsawPieces) {
        image.layer.shadowColor = [UIColor blackColor].CGColor;
        image.layer.shadowOffset = CGSizeMake(-1, -1);
        image.layer.shadowOpacity = 1;
        image.layer.shadowRadius = 5.0;
        image.clipsToBounds = NO; //EDIT: I have also included this with no change
    }
} 
```

我也包括在内`#import <QuartzCore/CALayer.h>`。

我没有收到任何错误，但我的图像上也没有任何阴影。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T14:59:48.683

您确定正在调用此代码吗？您是否在`for`循环中放置了断点以进行验证？

`-awakeFromNib`仅当您在通过`IBOutlet`代码中的 ivar 连接的 nib 文件中有视图（或其他）时才会调用。`-awakefFromNib`在这种情况下，被称为（或类似的）一个重要的区别，我有时会忘记自己*！*`-initWithFrame:`

# mysql - mysql中的count（*）只返回一条记录

> ID：10013593
> 
> 赞同：1
> 
> 时间：2012-04-04T14:48:51.403
> 
> 标签：mysql, doctrine

我想在同一个选择语句中计算另一个表中有多少条记录，我使用了左连接，在选择语句中我放了**count(ag.*)** 参见示例：

```
$q = Doctrine_Query::create()
            ->select("a.answer_id,a.date_added , count(ag.content_id) AS agree_count")
            ->from('Answer a')
             ->leftJoin("a.Agree ag ON a.answer_id = ag.content_id AND ag.content_type = 'answer' ")
            ->where('a.question_id= ? ', $questionId) 
```

但它只返回第一条记录，我可以修复它吗？还是制作另一张桌子并仅用于计数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T14:51:32.507

您的查询中缺少 a `GROUP BY`。

更多信息[在这里。](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

当您没有 GROUP BY 子句时，只获取一行是正常的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:52:57.920

如果不使用 Group By，Count(*) 只会返回一条记录。您要求它计算所有记录，因此只能有一个结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T14:56:44.933

count() SQL 函数改变了从数据库返回结果的方式——如果没有`GROUP BY`，数据库将只返回一条记录，而不管`SELECT`.

如果您添加：

```
group by a.answer_id 
```

到 SQL 查询的末尾，这可能是 DWYM。

# html - 电子书出版格式？

> ID：10013594
> 
> 赞同：-2
> 
> 时间：2012-04-04T14:48:55.517
> 
> 标签：html, publish, kindle, nook

我很好奇如何将 Word 文档和/或 Adob​​e PDF 文档转换为各种电子书格式（因此，Kindle、Nook、iPad、Sony Table 等）。我了解到其中一些格式需要 HTML 和 JavaScript 知识。我知道 HTML 和一点 JavaScript，但我想知道我需要从哪里开始将 Microsoft Word 文档和/或 Adob​​e PDF 文件转换为上面列出的各种格式。

是否有一个网站有一个逐步的过程来获得这个？在此过程中，我和/或 StackOverflow 社区是否可以从中受益？我需要任何特定的程序/软件吗？

这些问题可能看起来很长，但我在任何地方都找不到关于这个问题的任何信息。我认为公司不希望自己在互联网上执行此操作的信息？

非常感谢您，任何帮助将不胜感激！亚伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:55:58.263

就像 Jamie Taylor 说的那样，Calibre 具有允许转换的代码，但是我不认为您正在寻找对转换软件进行编程，因此只需下载并安装 Calibre 并使用它来转换为您需要的所有电子书格式。

# ruby-on-rails - 新手：如何在生产服务器数据库中获取一些包含数据的数据库列？

> ID：10013595
> 
> 赞同：1
> 
> 时间：2012-04-04T14:48:59.767
> 
> 标签：ruby-on-rails, deployment, rake

从生产数据库中的本地开发数据库获取数据列表的最佳方法是什么？我认为有一个 rake 任务来播种数据，但还有其他方法吗？

由于只有这些数据应该插入 1 次并且之后永远不会更新，所以在上限部署中如何最好地解决这个问题？还是我应该在服务器生产上手动运行导入命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:43:52.340

听起来你只是想要恢复，所以我只想：

您应该使用 dbms 工具进行数据库备份，将文件复制到本地，然后将其还原。

# android - 插入“}”以完成 R.class 中的 ClassBody

> ID：10013596
> 
> 赞同：1
> 
> 时间：2012-04-04T14:49:10.983
> 
> 标签：android

我正在开发一个 Android 应用程序，它在 que 中使用 sereval 库。这意味着：

*   项目 A 是图书馆。
*   项目 B 使用库 A 并且是库。
*   项目 C 用户库 B.

现在在项目 A 或 B 中，我尝试为自定义视图定义属性。从 SDK 17 开始，命名空间应该不再有问题。当我创建可声明样式时，我的 R.class 会按照预期自动生成，并且在 R.class 中列出了定义的属性，因此我不会在 xml-Files 中出现任何错误。（通常，当 xml 中有错误时，清理项目后不会生成 R.class。）现在奇怪的是，我在 R.class 本身中遇到了错误。完成该类的最后一个 } 未构建。如果我手动插入它，它会在几秒钟后自动删除。这是我的 attrs.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<declare-styleable name="ContentBox">
    <attr name="distanceToText" format="dimension" />
    <attr name="distanceBetweenText" format="dimension" />
    <attr name="titleColor" format="color" />
    <attr name="textColor" format="color"></attr>
    <attr name="textSizeTitle" format="dimension"></attr>
    <attr name="textSizeText" format="dimension"></attr>
    <attr name="paddingVerticalTitle" format="dimension"></attr>
    <attr name="paddingLeftTitle" format="dimension"></attr>
    <attr name="paddingHorizontalText" format="dimension"></attr>
    <attr name="titleBackgroundColor" format="color"></attr>
    <attr name="frameColor" format="color"></attr>
    <attr name="backgroundColorClickable" format="color"></attr>
    <attr name="title" format="string"></attr>
    <attr name="textSizeColumnOne" format="dimension"></attr>
    <attr name="textSizeColumnTwo" format="dimension"></attr>
    <attr name="textColorColumnOne" format="color"></attr>
    <attr name="textColorColumnTwo" format="color"></attr>
    <attr name="distanceBetweenTextHoriz"></attr>
</declare-styleable> 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T09:59:01.083

我发现了错误。在最后一行，没有定义格式，以 R.class 的错误结尾...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:22:03.223

如果您使用的是eclipse插件，如果您删除了R类，然后重建项目，应该重新生成它，希望正确

# javascript - Firefox 3.6 和 html5、jQuery

> ID：10013597
> 
> 赞同：1
> 
> 时间：2012-04-04T14:49:12.680
> 
> 标签：javascript, jquery, html, firefox

我使用 HTML5 文档类型和标签构建了一个站点。我正在做一些浏览器测试，我发现其中一部分在 Firefox 3.6（和 FF 3.0.5，但我们只支持回到 3.6）中不起作用。我的标题标签中的所有内容都没有显示。没有什么。Firebug 也不显示错误。

奇怪的是，只有**标题**中的项目不起作用。我的**section**、**article**、**nav**和**footer**标签中的所有内容都可以完美运行并且样式正确。我正在使用[normalize.css](http://necolas.github.com/normalize.css/)。我什至使用这个 html5 shiv 让我的网站在 IE6 中运行良好。

我的**标头**标签与其他标签的不同之处在于其中发生了一些基本的 jQuery 淡入淡出。我正在使用 css *visibility:hidden*隐藏 div，因此我的布局不会改变。我的 JS 代码发布在下面。我正在使用[这种技术](https://stackoverflow.com/a/2256404/395414)（fadeIn 之一）在保持布局的同时淡入我的元素。

我还想指出，当我[打开 Firefox 3.6 html5 解析器](http://www.iandevlin.com/blog/2010/01/html5/enabling-the-html5-parser-in-firefox-3-6)（在 FF 3.6 中默认情况下显然是关闭的）时，一切正常。但正如我之前所说，即使关闭了 html5 解析器，不受 jQuery 影响的 html5 标签也被解析得很好。由于我无法更改最终用户配置，因此我必须解决此问题。

我的标题标签中只有 div、h1、h2、h3、p 和锚链接。没有任何 hgroups 或其他 html5 标签。只是标题标签就是它。

我已经搜索并尝试了许多不同的东西，但没有任何效果。

我的js代码：

```
var mySite = {
_delay : 2000,
init : function () {
    this._frame1();
    this.nextButton();
},
nextButton : function () { 
    var that = this;
    $('.next-button').click(function (e, a) {
        e.preventDefault();
        if (typeof a !== 'undefined' && a === 'auto') {
            that._frame2(a);
        } else {
            clearTimeout(that.timer);
            that._frame2('clicked');
        }
    });     
},
_frame1 : function () { 
    var first = function () { 
        $('#drug-info-1, .specific-info-small').hide().css({visibility: "visible"}).fadeIn();
    };
    var second = function () {
        $('#drug-info-2').hide().css({visibility: "visible"}).fadeIn();
    };
    var third = function () {
        $('#drug-info-3, .next-button').hide().css({visibility: "visible"}).fadeIn();
    };

    setTimeout( first, this._delay);
    setTimeout( second, this._delay*2);
    setTimeout( third, this._delay*3);      
    this.timer = setTimeout( function () { $('.next-button').trigger('click', ['auto']); }, this._delay * 7);
},
_frame2 : function (a) {

    bye1 = function () {
        // fade out all of frame1 and then fadein first part of headline of frame2
        $('.frame1').fadeOut('slow' ,function () {
            $('.frame2').show();
            $('.frame2 h2, #headline-source').hide().css({visibility: "visible"}).fadeIn();
        });                         
    };
    fourth = function () {
        $('#clinical-studies').hide().css({visibility: "visible"}).fadeIn();
    };

    fifth = function () {
        $('.learn-more-button, .important-safety').hide().css({visibility: "visible"}).fadeIn();
    };

    if (typeof a !== 'undefined' && a === 'auto') {
        setTimeout( bye1, this._delay * 2);
    } else {
        bye1();
    }       
    setTimeout( fourth, this._delay * 3);
    setTimeout( fifth, this._delay * 4);
}
};
$(document).ready(function () {
     mySite.init();                             
}); 
```

# delphi - Delphi - TDataSet 确定它在插入/编辑状态时是否被修改

> ID：10013603
> 
> 赞同：8
> 
> 时间：2012-04-04T14:49:36.177
> 
> 标签：delphi, dataset, delphi-2006

当数据集已经处于插入状态时，如何确定数据感知组件字段是否已被修改？我想知道一个字段是否“真的”被修改过。（我不在乎用户是否在字段中输入了某些内容，然后删除所有内容，这意味着发生了修改）。

[DataSet.Modified](http://docwiki.embarcadero.com/Libraries/en/Data.DB.TDataSet.Modified)、[DataSet.UpdateStatus](http://docwiki.embarcadero.com/VCL/XE2/en/DBClient.TCustomClientDataSet.UpdateStatus)或[ChangeCount](http://docwiki.embarcadero.com/Libraries/en/Datasnap.DBClient.TCustomClientDataSet.ChangeCount)没有解决我的问题。

LE：让我更深入地解释一下。所以，初始数据集看起来像

```
-------------------------------------
|PK  | Field1| Field2| Field3|Field4|
-------------------------------------
| 1  |  a    | b     | c     | d    |  
------------------------------------- 
```

插入后

```
-------------------------------------
|PK  | Field1| Field2| Field3|Field4|
-------------------------------------
| 2  |       |       |       |      |  
-------------------------------------
| 1  |  a    | b     | c     | d    |  
------------------------------------- 
```

当数据集真正被修改时

```
-------------------------------------
|PK  | Field1| Field2| Field3|Field4|
-------------------------------------
| 2  | avalue|       |       |      |  
-------------------------------------
| 1  |  a    | b     | c     | d    |  
------------------------------------- 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T07:47:39.937

您可以`DataSet`修改它以更改其在/上的`Modified`属性（并设置初始/默认值）并稍后测试（例如，在发布之前）。 为了确定修改了哪些特定字段，我持有初始记录的副本，例如：`AfterInsert``AfterEdit``DataSet.Modified`

```
type
  TDataRecord = array of record
    FieldName: string;
    Value: Variant;
  end;

type
  TForm1 = class(TForm)
    ... 
  private
    FInitRecord, FPostRecord: TDataRecord;
  end;

function GetDataRecord(DataSet: TDataSet): TDataRecord;
var
  I: Integer;
begin
  Result := nil;
  if Assigned(DataSet) then begin
    SetLength(Result, DataSet.FieldCount);
    for I := 0 to DataSet.FieldCount - 1 do begin
      Result[I].FieldName := DataSet.Fields[I].FieldName;
      Result[I].Value := DataSet.Fields[I].Value;
    end;
  end;
end;

type
  TDataSetAccess = class(TDataSet);

procedure TForm1.ADODataSet1AfterInsert(DataSet: TDataSet);
begin
  // set initial values 
  ADODataSet1.FieldByName('PK').Value := GetMyPKValue;
  ADODataSet1.FieldByName('DateCreated').AsDateTime := Now(); 
  // un-modify
  TDataSetAccess(ADODataSet1).SetModified(False);
  // save initial record
  FInitRecord := GetDataRecord(ADODataSet1);
end;    

procedure TForm1.ADODataSet1BeforePost(DataSet: TDataSet);
var
  I: Integer;
begin
  if ADODataSet1.Modified then
  begin
    FPostRecord := GetDataRecord(ADODataSet1);
    Memo1.Lines.Clear;
    for I := 0 to Length(FPostRecord) - 1 do begin
      if FPostRecord[I].Value <> FInitRecord[I].Value then
        Memo1.Lines.Add(Format('Field %s was modified', [FPostRecord[I].FieldName]));
    end;
  end;
end; 
```

好吧，无论如何，这都是抽象的想法。您可以`TDataSet`像我一样将您的子类化，并直接在您的`TDataSet`组件中实现此功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T16:02:29.493

当状态为 dsInsert 时，使用：

```
VarCompareValue(Field.NewValue, Unassigned) = vrNotEqual; 
```

dsEdit 使用：

```
OldValue <> Value; 
```

不要在 dsInsert 状态下使用它，因为数字字段 0 等于未分配：

```
Field.NewValue <> Unassigned 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T14:12:50.107

到目前为止，我找到了一个似乎可行的解决方案。解决方案包括： - 将数据源链接到 tdataset 后代 - 全局布尔变量在数据集 OnAfterScroll 事件上设置为 false，在数据[源](http://docwiki.embarcadero.com/VCL/en/DB.TDataSet.AfterScroll)的[OnDataChange](http://docwiki.embarcadero.com/Libraries/en/Data.DB.TDataSource.OnDataChange)事件上设置为 true。

从我到现在对应用程序执行的测试来看，这种解决方法似乎是有效的。我现在需要调查所有发生的事件并且需要特殊处理以不改变进程中全局变量的状态。

欢迎任何其他想法

# actionscript-3 - AS3 TextField 根本不显示新文本，即使它在那里

> ID：10013605
> 
> 赞同：0
> 
> 时间：2012-04-04T14:49:52.400
> 
> 标签：actionscript-3, flash

我在试图从外部类中更改出来的 MovieClip 中有一个文本字段。它似乎在舞台上以空的形式返回，但如果我追踪里面的内容，它会给我正确的值，它只是没有出现。

我的代码是这样的：

```
((this.parent.parent.getChildByName('bottomBar') as MovieClip).getChildByName('area_txt') as TextField).text = 'test'; 
```

因此，如果我跟踪“ `((this.parent.parent.getChildByName('bottomBar') as MovieClip).getChildByName('area_txt') as TextField).text`”，它会返回“test”，但它不会显示在舞台上，它只是空白。

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T19:53:37.017

字体需要嵌入，如果你使用`defaultTextFormat`函数，你需要在设置文本之前调用它，如果你使用，`setTextFormat`那么你在之后做

```
textfield.embedFonts          = true;
textfield.defaultTextFormat   = format;          // option 1
textfield.text                = "Hello World";
textfield.setTextFormat (format);                // option 2 
```

# android - GreenDroid 和 MapActivity

> ID：10013606
> 
> 赞同：2
> 
> 时间：2012-04-04T14:49:54.397
> 
> 标签：android, mapactivity, greendroid

请教我如何在 MapActivity 中使用 greendroid 库

```
 public class GreendroidTestActivity extends GDActivity   MapActivity 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T15:42:54.233

您可以使用`GDMapActivity`

例子：

[https://github.com/cyrilmottier/GreenDroid/blob/master/GDDatalog/src/com/cyrilmottier/android/gdcatalog/MapPinMapActivity.java](https://github.com/cyrilmottier/GreenDroid/blob/master/GDCatalog/src/com/cyrilmottier/android/gdcatalog/MapPinMapActivity.java)

# java - 声明的包“com.example.android.softkeyboard”与预期的包“your.test.com.example.android.softkeyboard”不匹配

> ID：10013608
> 
> 赞同：0
> 
> 时间：2012-04-04T14:49:59.407
> 
> 标签：java, android, compiler-errors

我在几行上收到标题错误我使用示例创建应用程序我确实为 .com.example 创建了一个文件夹并将其放在根目录中但它不起作用我尝试手动编辑 Java 脚本，它也不工作..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:16:02.893

据我所知，听起来你提到的编译错误的类的顶部有一个包声明，如下所示：

`package com.example.android.softkeyboard;`

但是，实际包含该类的包如下：

`your.test.com.example.android.softkeyboard`

您需要将包声明行更改为看起来像包目录结构，或者将包的名称更改为看起来像代码中的包声明。后一种选择会更好，因为我怀疑您可能已经将代码从某个地方复制到您自己的包中，这就是为什么事情没有编译的原因。如果您开始重命名软件包，则可能会导致出现更多编译错误，然后才能修复所有内容。如果您是 Java 新手，处理起来可能会非常混乱。

如果您完全不熟悉包的工作原理，或者您想阅读它，这里有一些很好的资源：

[Oracle Java 包教程](http://docs.oracle.com/javase/tutorial/java/package/packages.html)
[Wikipedia Java 包文章](http://en.wikipedia.org/wiki/Java_package)

# android - 为什么要设置内容视图（布局）；在android的新线程中不起作用

> ID：10013609
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:05.197
> 
> 标签：android, textview

我正在制作一个几乎完成的 Android 游戏。我需要添加一个 TextView 来显示用户还剩多少生命。但似乎我不能`setContentView`在这个线程中使用该方法。

我怎样才能使这项工作？我尝试了一些东西，但没有奏效。请看一下我的`setUpGameDesign()`方法。

代码：

```
package com.mysoftwaremobileapps.ParachuteHunter;

import java.util.ArrayList;

import android.content.Context;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.media.MediaPlayer;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;

public class ExampleView extends SurfaceView implements SurfaceHolder.Callback
{
class ExampleThread extends Thread
{
    private ArrayList<Parachuter> parachuters;
    private Bitmap parachuter;
    private Paint black;

    private boolean running;

    private SurfaceHolder mSurfaceHolder;
    private Context mContext;
    private Context mContext1;
    private Handler mHandler;
    private Handler mHandler1;
    private GameScreenActivity mActivity;

    private long frameRate;
    private boolean loading;
    public float x;
    public float y;
    public float x1;
    public float y1;
    public MediaPlayer mp1;
    public int parachuterIndexToResetAndDelete;
    public int canvasGetWidth;
    public int canvasGetHeight;
    public int livesLeftValue;
    TextView livesLeftValueText;

    public ExampleThread(SurfaceHolder sHolder, Context context, Handler handler)
    {
        mSurfaceHolder = sHolder;
        mHandler = handler;
        mHandler1 = handler;
        mContext = context;
        mActivity = (GameScreenActivity) context;

        parachuters = new ArrayList<Parachuter>();
        parachuter = BitmapFactory.decodeResource(getResources(), R.drawable.parachuteman);
        black = new Paint();
        black.setStyle(Paint.Style.FILL);
        black.setColor(Color.GRAY);

        running = true;

        // This equates to 26 frames per second.
        frameRate = (long) (1000 / 26);
        loading = true;
    }

    @Override
    public void run()
    {
        while (running)
        {
            Canvas c = null;
            try
            {
                c = mSurfaceHolder.lockCanvas();

                synchronized (mSurfaceHolder)
                {
                    long start = System.currentTimeMillis();
                    doDraw(c);
                    long diff = System.currentTimeMillis() - start;

                    if (diff < frameRate)
                        Thread.sleep(frameRate - diff);
                }
            } catch (InterruptedException e)
            {
            }
            finally
            {
                if (c != null)
                {
                    mSurfaceHolder.unlockCanvasAndPost(c);
                }
            }
        }
    }

    protected void doDraw(Canvas canvas)
    {
        canvas.drawRect(0, 0, canvas.getWidth(), canvas.getHeight(), black);
        canvasGetWidth = canvas.getWidth();
        canvasGetHeight = canvas.getHeight();

        //Draw
        for (int i = 0; i < parachuters.size(); i++)
        {
            canvas.drawBitmap(parachuter, parachuters.get(i).getX(), parachuters.get(i).getY(), null);
            parachuters.get(i).tick();
        }

        //Remove
        for (int i = 0; i < parachuters.size(); i++)
        {
        if (parachuters.get(i).getY() > canvas.getHeight()) {
            parachuters.remove(i);
            onPlaySound();
            checkLivesLeftValue();
        } else if(parachuters.get(i).isTouched()) {
            parachuters.remove(i);
        }
        }
    }

    private void checkLivesLeftValue() {
        Log.d("checkLivesLeftValue", "lives = " + livesLeftValue);
        // TODO Auto-generated method stub
        if (livesLeftValue == 3) {
            //Message to display: "You lost!
            livesLeftValueText.setText("Lives left=0");
            Log.d("checkLivesLeftValue", "calling onMethod now");
            onMethod();
        }
        else if (livesLeftValue == 2) {
            livesLeftValueText.setText("Lives left=1");
            livesLeftValue = livesLeftValue + 1;
            Log.d("checkLivesLeftValue", "increased lives to " + livesLeftValue);
        }
        else if (livesLeftValue == 1) {
            livesLeftValueText.setText("Lives left=2");
            livesLeftValue = livesLeftValue + 1;
            Log.d("checkLivesLeftValue", "increased lives to " + livesLeftValue);
        }
        else {
            //Set livesLeftValueText 3
            livesLeftValueText.setText("Lives left=3");
            livesLeftValue = livesLeftValue + 1;
            Log.d("checkLivesLeftValue", "increased lives to " + livesLeftValue);
        }
    }
    public void onMethod() {
        mHandler.post(new Runnable() {
            @Override
            public void run() {
                Toast.makeText(getContext(), "You lost!", 15).show();
                livesLeftValue = 0;
                //Tell the user that he lost:
                android.content.Context ctx = mContext;
                Intent i = new Intent(ctx, playerLostMessageActivity.class);  
                i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                ctx.startActivity(i);
                System.exit(0);
            }
        });
    }

    public void onPlaySound()
    {
        try {
        mp1 = MediaPlayer.create(getContext(), R.raw.bombsound);
        mp1.start();
        } catch (Exception e) {
            e.printStackTrace();
            mp1.release();
        }
    }

    public void onPlaySound1()
    {
        try {
        mp1 = MediaPlayer.create(getContext(), R.raw.airriflesoundeffect);
        mp1.start();
        } catch (Exception e) {
            e.printStackTrace();
            mp1.release();
        }
    }

    public boolean onTouchEvent(MotionEvent event)
    {
        if (event.getAction() != MotionEvent.ACTION_DOWN)
        Toast.makeText(getContext(), "onTouchEvent invoked. X= " + event.getX() + " Y= " + event.getY(), 15).show();
        x1 = event.getX();
        y1 = event.getY();
        removeParachuter();
        return false;
    }

    public void removeParachuter()
    {
        try {
        for (Parachuter p: parachuters) {
            if (x1 > p.getX() && x1 < p.getX() + parachuter.getWidth() && y1 > p.getY() && y1 < p.getY() + parachuter.getHeight()) {
                p.setTouched(true);
                Toast.makeText(getContext(), "Setting touched(true) to the parachuter", 25).show();
                onPlaySound1();
                p.setTouched(false);
            }
        }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void setUpGameDesign()
    {
        mHandler.post(new Runnable() {
            @Override
            public void run() {
                setContentView(livesLeftValueText);
            }
        });
    }

    public void initiateDrawParachuters()
    {
        drawParachutersGroup1();
    }
    public void drawParachutersGroup1() {
        // TODO Auto-generated method stub
        //Parachuter group nr. 1

        //Parachuter nr. 2
        x = 75;
        y = 77;

        Parachuter p1 = new Parachuter(x, y);
        parachuters.add(p1);
        //Parachuter nr.1
        x = 14;
        y = 28;

        Parachuter p = new Parachuter(x, y);
        parachuters.add(p);

        //Parachuter nr. 3
        x = 87;
        y = 94;

        Parachuter p3 = new Parachuter(x, y);
        parachuters.add(p3);

        //Parachuter nr. 3
        x = 85;
        y = 80;

        Parachuter p2 = new Parachuter(x, y);
        parachuters.add(p2);

        //Parachuter nr. 5
        x = 67;
        y = 163;

        Parachuter p5 = new Parachuter(x, y);
        parachuters.add(p5);

        x = 217;
        y = 118;

        Parachuter p4 = new Parachuter(x, y);
        parachuters.add(p4);

        //Parachuter nr. 7
        x = 297;
        y = 247;

        Parachuter p7 = new Parachuter(x, y);
        parachuters.add(p7);

        //Parachuter nr. 6
        x = 19;
        y = 57;

        Parachuter p6 = new Parachuter(x, y);
        parachuters.add(p6);
    }

    public void drawParachutersGroup2() {
        // TODO Auto-generated method stub
        //Parachuter group nr. 2

        //Parachuter nr. 5
        x = 57;
        y = 166;

        Parachuter p5 = new Parachuter(x, y);
        parachuters.add(p5);

        x = 283;
        y = 123;

        Parachuter p4 = new Parachuter(x, y);
        parachuters.add(p4);

        //Parachuter nr. 7
        x = 99;
        y = 213;

        Parachuter p7 = new Parachuter(x, y);
        parachuters.add(p7);

        //Parachuter nr. 6
        x = 231;
        y = 121;

        Parachuter p6 = new Parachuter(x, y);
        parachuters.add(p6);
    }

    public void drawParachutersGroup3() {
        // TODO Auto-generated method stub
        //Parachuter group nr. 3

        //Parachuter nr. 2
        x = 33;
        y = 115;

        Parachuter p1 = new Parachuter(x, y);
        parachuters.add(p1);
        //Parachuter nr.1
        x = 277;
        y = 183;

        Parachuter p = new Parachuter(x, y);
        parachuters.add(p);

        //Parachuter nr. 3
        x = 127;
        y = 280;

        Parachuter p3 = new Parachuter(x, y);
        parachuters.add(p3);

        //Parachuter nr. 3
        x = 84;
        y = 80;

        Parachuter p2 = new Parachuter(x, y);
        parachuters.add(p2);

        //Parachuter nr. 5
        x = 67;
        y = 112;

        Parachuter p5 = new Parachuter(x, y);
        parachuters.add(p5);

        x = 260;
        y = 89;

        Parachuter p4 = new Parachuter(x, y);
        parachuters.add(p4);

        //Parachuter nr. 7
        x = 283;
        y = 113;

        Parachuter p7 = new Parachuter(x, y);
        parachuters.add(p7);

        //Parachuter nr. 6
        x = 295;
        y = 25;

        Parachuter p6 = new Parachuter(x, y);
        parachuters.add(p6);
    }

    public void drawParachutersGroup4() {
        // TODO Auto-generated method stub
        //Parachuter group nr. 1

        //Parachuter nr. 2
        x = 75;
        y = 166;

        Parachuter p1 = new Parachuter(x, y);
        parachuters.add(p1);
        //Parachuter nr.1
        x = 118;
        y = 94;

        Parachuter p = new Parachuter(x, y);
        parachuters.add(p);

        //Parachuter nr. 3
        x = 38;
        y = 55;

        Parachuter p3 = new Parachuter(x, y);
        parachuters.add(p3);

        //Parachuter nr. 3
        x = 22;
        y = 18;

        Parachuter p2 = new Parachuter(x, y);
        parachuters.add(p2);

        //Parachuter nr. 5
        x = 67;
        y = 119;

        Parachuter p5 = new Parachuter(x, y);
        parachuters.add(p5);

        x = 217;
        y = 113;

        Parachuter p4 = new Parachuter(x, y);
        parachuters.add(p4);

        //Parachuter nr. 7
        x = 345;
        y = 234;

        Parachuter p7 = new Parachuter(x, y);
        parachuters.add(p7);

        //Parachuter nr. 6
        x = 346;
        y = 44;

        Parachuter p6 = new Parachuter(x, y);
        parachuters.add(p6);
    }

    public void drawParachuters()
    {
            Parachuter p = new Parachuter(x, y);
            parachuters.add(p);
            Toast.makeText(getContext(), "x=" + x + " y=" + y, 15).show();
    }

    public void setRunning(boolean bRun)
    {
        running = bRun;
    }

    public boolean getRunning()
    {
        return running;
    }
}

/** Handle to the application context, used to e.g. fetch Drawables. */
private Context mContext;

/** Pointer to the text view to display "Paused.." etc. */
private TextView mStatusText;

/** The thread that actually draws the animation */
private ExampleThread eThread;

public ExampleView(Context context)
{
    super(context);

    // register our interest in hearing about changes to our surface
    SurfaceHolder holder = getHolder();
    holder.addCallback(this);

    // create thread only; it's started in surfaceCreated()
    eThread = new ExampleThread(holder, context, new Handler()
    {
        @Override
        public void handleMessage(Message m)
        {
           // mStatusText.setVisibility(m.getData().getInt("viz"));
           // mStatusText.setText(m.getData().getString("text"));
        }
    });

    setFocusable(true);
}

@Override
public boolean onTouchEvent(MotionEvent event)
{
    return eThread.onTouchEvent(event);
}

public ExampleThread getThread()
{
    return eThread;
}

@Override
public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3)
{
    // TODO Auto-generated method stub
}

public void surfaceCreated(SurfaceHolder holder)
{
    if (eThread.getState() == Thread.State.TERMINATED)
    {
        eThread = new ExampleThread(getHolder(), getContext(), getHandler());
        eThread.start();
    }
    else
    {
        eThread.start();
    }
}

@Override
public void surfaceDestroyed(SurfaceHolder holder)
{
    boolean retry = true;
    eThread.setRunning(false);

    while (retry)
    {
        try
        {
            eThread.join();
            retry = false;
        }
        catch (InterruptedException e)
        {
        }
    }
}
} 
```

错误：

```
The method setContentView(TextView) is undefined for the type new Runnable(){} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:08:57.440

该方法`setContentView`是在其中声明的`Activity`，尽管它在 UI 线程上运行，但它没有引用`Activity`. 你不能用另一个自己替换你的`View`(your )。`ExampleView`

尝试在`Activity`托管您的`SurfaceView`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T22:34:28.510

Android 包含一个便利功能，用于从另一个线程在 UI 线程上运行内容。本质上，您必须创建一个“可运行”，它只是一个函数，并在活动线程上执行它。你可以这样做：

```
activity.runOnUiThread(new Runnable() {
    public void run() {
        safeSendJavascript(String.format(jsStr, registrationId,registrationId));
    }
}); 
```

# c# - 将动画 .gif 文件转换为 .bmp 条带

> ID：10013612
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:11.727
> 
> 标签：c#, gif, animated-gif, bmp

我想知道是否有人可以指导我或指导我使用 .gif 图像并将其转换为 .bmp 条形图像文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T11:08:30.837

首先，您需要获取 gif 的大小。然后你需要找出有多少帧。

之后，您需要创建一个高度 = 原始高度和宽度 = 帧 * Gif 宽度的新图像。

然后您必须将原始 Gif 的帧粘贴到条带中，如下所示：帧 N 从像素 N*Width 开始。

也就是说，如果您正在制作水平条。

* * *

这是控制台应用程序的完整代码：

```
using System.Drawing;
using System.Drawing.Imaging;

foreach (var arg in args)
    {
        Image gif = Image.FromFile(arg);
        FrameDimension dim = new FrameDimension(gif.FrameDimensionsList[0]);
        int frames = gif.GetFrameCount(dim);

        Bitmap resultingImage = new Bitmap(gif.Width * frames, gif.Height);

        for (int i = 0; i < frames; i++)
        {
            gif.SelectActiveFrame(dim, i);

            Rectangle destRegion = new Rectangle(gif.Width * i, 0, gif.Width, gif.Height);
            Rectangle srcRegion = new Rectangle(0, 0, gif.Width, gif.Height);

            using (Graphics grD = Graphics.FromImage(resultingImage))
            {
                grD.DrawImage(gif, destRegion, srcRegion, GraphicsUnit.Pixel);
            }
        }

        resultingImage.Save("res.png", ImageFormat.Png);
    } 
```

生成的图像保存在名称下的已编译控制台应用程序二进制文件目录中`res.png`。您可以让应用程序将生成的图像保存在源文件所在的位置，询问是否制作水平或垂直条带等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T09:33:23.547

使用 Photoshop 可以轻松制作图像条（您可以获得免费试用版或 Elements）

1.  打开 .gif - Photoshop 会将每一帧作为一个图层打开
2.  将画布大小调整为（gif * 层的高度）像素
3.  删除所有帧信息，保留图层
4.  选择最后一层，并将其移动到最底部
5.  选择所有图层并单击“分布垂直中心”。现在你有一个完美排列的条带。

如果您使用的是 Photoshop，则可以只导出为 BMP。而已。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T10:37:51.473

肯定有效的方法是：

1.  下载安装 Easy GIF Animator
2.  用它打开游览 gif 并将帧导出到单独的文件
3.  下载并安装任何可以创建图层的程序（例如 Photoshop CS3 Little）
4.  创建一个新的文件宽度作为您的图片；高度 = 您照片的高度。X张图片
5.  复制每张照片。作为一个图层到你的新文件中并一个接一个地移动它们。
6.  将其保存为 .png 文件
7.  下载安装 iPAQ 31x Image Explorer
8.  在其中打开您的 .png
9.  将其保存为 RGB 文件（普通 BMP 可能不起作用）
10.  完毕！！

也许这不是最简单的方法，但它提供了精确编辑的可能性，并允许您制作透明背景上的图标条（但不限于图标）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-04T15:38:57.050

只需在 Bitmap 中加载 .gif 并将其保存在 .bmp 中。如果你想导出 .gif 的帧，我不知道该怎么做。你可以看看这个[www.eggheadcafe.com/articles/stripimagefromanimatedgif.asp](http://www.eggheadcafe.com/articles/stripimagefromanimatedgif.asp)，它似乎就是你要找的东西。

# sql - 如何从 Oracle SQL 转换为 DB2？

> ID：10013613
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:12.333
> 
> 标签：sql, oracle, db2

大师们~ 我在将 Oracle SQL 转换为 DB2 时遇到了麻烦。

我需要将这些 Oracle SQL 更改为 DB2。

请帮我

```
CREATE TABLE ABC (
   AA VARCHAR(10 BYTE) WITH DEFAULT TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
);

CREATE TABLE CBA (
BB  INTEGER(22) NOT NULL
) PCTFREE 10 TABLESPACE CC STORAGE (INITIAL 32K NEXT 32K) NOLOGGING; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T15:10:52.923

@Bob Jarvis 在对原始帖子的评论中提到的所有问题，这里有一些粗略的等价物可能会让你通过。您可能应该稍微查阅一下[信息中心文档](http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/index.jsp)以供进一步参考。

```
CREATE TABLE ABC (
   AA TIMESTAMP WITH DEFAULT CURRENT TIMESTAMP GENERATED BY DEFAULT
);

CREATE TABLE CBA (
    BB  BIGINT NOT NULL
); 
```

如果您正在生成时间戳，您应该将它们存储为这样，而不是作为字符串。

此外，DB2 表还有一个`NOT LOGGED`选项，但它只对`LOB`数据类型有效。（或者，有`NOT LOGGED INITIALLY`，它不会记录在与创建表相同的工作单元中应用的任何更改，这很有用，例如，当从另一个源[文件或其他表，也许]导入数据时）

# jquery - 基本的 jQuery 联系表单问题

> ID：10013614
> 
> 赞同：2
> 
> 时间：2012-04-04T14:50:14.663
> 
> 标签：jquery, html, css

我一直在为联系表单编写 jQuery 验证。我写了一个简单的代码来检查输入表单是否包含任何字符；如果有任何字符，那么它可能会继续运行 PHP 代码并向我发送电子邮件。否则，显示一个错误框，告诉客户仔细检查。这是代码：

```
 (function($){
       $('.required',$form).each(function(){
         var inputVal = $('form-element-name').val();
         var inputVal2 = $('form-element-email').val();

                if(inputVal == ''){
                    $('errorbox1').addClass('errormsg1');
                } 

                else if(inputVal2 == '') {
                    $('errorbox2').addclass('errormsg2');
                }
            }
     } 
```

Inputval 是姓名的输入字段，inputval2 是电子邮件的输入字段。此外，Errorbox1 是一个空容器，errormsg1 将是一个类，该类将给 errorbox1 一个背景图像说明错误。

[这是一个 jsFiddle](http://jsfiddle.net/U6xGA/3/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:53:33.317

看起来您缺少 jQuery 选择器中的散列 - 您应该拥有`$('#form-element-name')`而不是`$('form-element-name')`- 它将根据元素的 id 选择元素。

或者 - 改为按类选择的点。

您需要将代码放入表单的 onsubmit 事件中，然后`return false;`使用它`e.preventDefault();`来取消表单提交。

```
$('#your-form-id').submit(function() {
    // if error then cancel form submission
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:53:13.443

`$('errorbox1')`和`$('errorbox2')`

应该

`$('.errorbox1')``$('.errorbox2')`如果类选择器

或者

`$('#errorbox1')``$('#errorbox2')`如果 ID 选择器

注意errorbox1之前的点/#。

下面是对类和 ID 选择器的引用，

[http://api.jquery.com/class-selector/](http://api.jquery.com/class-selector/)

[http://api.jquery.com/id-selector/](http://api.jquery.com/id-selector/)

# apache - 301重定向 - 我可以维护到页面的链接吗

> ID：10013617
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:23.553
> 
> 标签：apache, .htaccess, dns

我会设置场景

我的网站上有很多指向页面的反向链接

我是否需要为每个链接设置一个 301 规则，或者我可以为整个站点设置一个规则，例如

```
Options +FollowSymlinks
RewriteEngine on
rewritecond %{http_host} ^website.uk.com [nc]
rewriterule ^(.*)$ http://www.website.com/$1 [r=301,nc] 
```

想维护：www.website.uk.com/page.html 到 www.website.com/page.html

不重定向： www.website.uk.com/page.html 到 www.website.com

谢谢罗伯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T18:35:24.723

这对我有用（我的网站上有类似的规则，下面适用于您的域）：

```
RewriteCond %{HTTP_HOST} ^website.uk.com [NC,OR]
RewriteCond %{HTTP_HOST} ^www.website.uk.com [NC]
RewriteRule ^(.*)$ http://www.website.com/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:04:34.233

您可以为整个站点设置一个规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T17:11:12.100

您是否尝试了两个单独的规则`OR`？

```
Options +FollowSymlinks
RewriteEngine on
Rewritecond %{http_host} ^website.uk.com [nc, OR]
Rewritecond %{http_host} ^www.website.uk.com [nc]
Rewriterule ^(.*)$ http://www.website.com/$1 [r=301,nc] 
```

# c++ - 当c++标准引入语法`vector的假设时 >`（即`>>`到底是什么？

> ID：10013623
> 
> 赞同：-1
> 
> 时间：2012-04-04T14:50:34.973
> 
> 标签：c++

```
include <vector>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    vector<vector<int>> vecVecInts;

    return 0;
} 
```

我已经关闭了 Visual Studio 2008 语言扩展并编译了上面的代码，没有警告或错误。

我曾经记得我们必须替换以下行

```
vector<vector<int>> 
```

和

```
vector<vector<int> > 
```

因为当时的编译器`>>`最终无法识别。

**问题**> C++ 标准什么时候引入这种语法更甜？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T14:51:33.147

它是在最新的标准 C++11 §14.2/3 中引入的：

> 解析模板参数列表时，将第一个非嵌套`>`的作为结束分隔符而不是大于运算符。类似地，第一个非嵌套`>>`的被视为两个连续但不同的`>`标记，其中第一个被视为模板参数列表的末尾并完成模板 ID。

# c++ - 撤消/重置 AllowSetForegroundWindow() 调用

> ID：10013624
> 
> 赞同：1
> 
> 时间：2012-04-04T14:50:34.833
> 
> 标签：c++, winapi

有没有办法撤消对 的调用`AllowSetForegroundWindow(ASFW_ANY)`？

大图：

*   我想要一次运行我的 exe 的单个进程。
*   为了实现它，进程使用命名管道相互通信，如果进程已经存在，则必须将其窗口置于前面。
*   为此，必须`AllowSetForegroundWindow()`使用现有的进程 ID 设置最新进程。
    *   我不想获取进程 ID（对不起我的懒惰），所以我打算做的是： 1.`AllowSetForegroundWindow()`使用 ASFW_ANY 调用 2\. 以防万一发生错误，撤消调用，`AllowSetForegroundWindow()`以便其他人无法窃取焦点从我的过程中。

简而言之，我希望仅在特定时间窗口内允许其他进程从我身上窃取焦点......

任何人早些时候遇到过类似的问题，并找到任何解决方法？

另外，如果您有更好的建议/替代方案，请告诉我...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:58:17.903

[根据文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632668%28v=vs.85%29.aspx)，目标进程（可能包括“任何”）将在您下次调用时失去从您那里窃取焦点的能力`AllowSetForegroundWindow`。

换句话说，听起来您一次只能激活一个这样的权限。

因此，您应该能够通过使用一些不存在的 ID 或您自己的进程 ID 调用来取消权限。这是理论，但是我没有测试过。

我个人只是通过命名管道发送目标进程 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:12:07.783

如果我了解您的主要要求是一次只运行一个应用程序实例。如果您描述的其他所有内容仅服从此要求，而不是某个更大计划的一部分，那么有一种更简单的方法可以实现这一目标。

您可以在应用程序启动时创建一个全局命名互斥锁。所有其他实例都会将此互斥锁视为已设置，并立即退出。这是它的快速和肮脏：

```
// Multiple instances detection
HANDLE my_mutex = ::CreateMutex(NULL, FALSE, "Global\\MyCuteFluffyMutex" );

int create_mutex_error = ::GetLastError();
bool already_running =
          ( my_mutex && ( create_mutex_error == ERROR_ALREADY_EXISTS ))
       || ( create_mutex_error == ERROR_ACCESS_DENIED );

if ( !already_running ) {
  // Run my application
}

::CloseHandle(my_mutex); 
```

有关更详尽的信息`CreateMutex`及其参数，请参阅[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682411%28v=vs.85%29.aspx)。

# html - 正确使用微格式

> ID：10013625
> 
> 赞同：1
> 
> 时间：2012-04-04T14:50:35.470
> 
> 标签：html, seo, microformats

我是第一次使用微格式。

[因此，作为http://support.google.com/webmasters/bin/answer.py?hl=en&answer=164506](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=164506)上给出的示例，我更改了代码。

这是页面上存在的现有代码：

```
<div class="evD mr10">
    <div class="imgH fl"><img /></div>
    <div class="infAr">
        <h3><a href="event_URL">EVENT NAME</a></h3>
        <h4><span>at</span>VENUE NAME</h4>
        <p>Event Description</p>
        <a class="tdd" href="#">Genre</a>
    </div>
    <div class="dth">
        <div class="sfrD fl">
        </div>
        <div class="strE sn fl">
        </div>
    <div class="Buy">
        <a class="bkT" href="buy_link"></a>
    </div>
    </div>
</div> 
```

我所做的更改包括：将文档类型更改为 html5，并添加了微格式类。

```
<div class="vevent evD mr10">
    <div class="imgH fl"><img class="photo" /></div>
    <div class="infAr">
        <h3><a class="url summary" href="event_URL">EVENT NAME</a></h3>
        <h4 class="location"><span>at</span>VENUE NAME</h4>
        <p class="description">Event Description</p>
        <a href="#" class="tdd category">Genre</a>
    </div>
    <div class="dth">
        <div class="dtstart frD fl">DATE_START<span class="value-title" title="Date in ISO"></span></div>
        <div class="dtend strE sn fl"><span class="value-title" title="Date in ISO"></span></div>
    <div class="Buy tickets">
        <a class="bkT offerurl" href="buy_link"></a>
    </div>
    </div>
</div> 
```

我有以下问题/疑问：

1.  可以像上面那样拥有现有的类以及微格式标签吗？
2.  如[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=1093493#usage](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=1093493#usage)中所述，不允许`display:none`在内容上使用。但是，我使用 javascript 传递数据集并进行分页，其中显示了相关数据。那么我如何确保这些不被忽略。
3.  我加载当前页面上的图像，将`src`as 留空，然后在页面更改时更改 src。所以最初的事件`photo`是空白的。我如何从阅读为空白的搜索引擎中反击。

谢谢你。（抱歉问题太长了）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:06:21.940

1）没问题。您甚至可以在同一个标​​签上组合多种类型的语义标记。

2) 3)

如果数据被隐藏并且在 JavaScript/AJAX 中，那么 Google 极不可能看到它。

您可能必须重组架构以使您的内容可抓取。这是一个很大的话题。我建议查找“渐进式增强”，这是我目前认为最好的方法。

# matlab - 增加 dB 值的 MATLAB 声音生成

> ID：10013627
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:39.877
> 
> 标签：matlab, audio, signal-processing

对于你们中的一些人来说，这可能看起来是一个简单的问题，但我对信号处理不是很熟悉，我宁愿确定这一点。

所以我找到了一些在 MATLAB 中生成纯音的简单代码：

```
Fs = 44100;
duration = 5.0;

numberOfSamples = Fs * duration;
samples = (1:numberOfSamples) / Fs;
s = sin(2 * pi * freq * samples);

sound(s, Fs); 
```

我希望能够在此处以 dB 为单位调整音量。更准确地说，我想引入一个特定的参数，比如`dbOffset`，它在校准后决定了音调的响度。

例如：如果我进行校准以`dbOffset = 0`产生 50 dB 的音调，我希望`dbOffset = 10`产生 60 dB 的音调，依此类推。

这可能吗？谁能帮我解决这个问题？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:05:21.737

声音的强度（即声音的大小）由声波的幅度决定。要增加或减少正弦的幅度，您必须将其乘以比例因子。一般来说：

```
 A*sin(2*pi*f) 
```

产生一个正弦波，其峰值（因此振幅）为**A**，频率为**f** Hz。当然，这是在连续的世界中。

也就是说，要控制声音强度，您必须将其乘以某个常数。

然后，您必须查看该`sound`功能的工作原理。来自官方文档：

> sound 函数假定 y 包含介于 -1 和 1 之间的浮点数，并裁剪超出该范围的值。

这大致翻译为：如果幅度 y 等于 1，则声卡将发出尽可能大的声音。哎呀，你面临一个问题：实际的声音强度主要取决于声卡和连接到PC的扬声器......所以要制作一个以分贝为单位的通用函数并不容易......

如果您只想玩这个概念并习惯它，请尝试：

```
Fs = 44100;
duration = 2.0;

numberOfSamples = Fs * duration;
samples = (1:numberOfSamples) / Fs;
s = sin(2 * pi * freq * samples);
s2 = 0.5*sin(2*pi*freq*samples);

sound(s, Fs);
sound(s2,Fs); 
```

这将创建一个峰值为第一个播放的峰值一半的声音。这**并不**意味着它有一半的强度，或者用更好的术语来说，就是力量。正弦曲线的功率与其幅度不是线性相关的，但这是一个完全不同的故事。

底线是：要做你想做的事，你必须知道再现声音所涉及的整个系统，你必须知道一些物理来计算功率，然后，就在那时，你将能够编写一些代码，将正弦曲线乘以某个计算得出的常数，播放具有指定强度的声波:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:30:49.693

您可能只需要知道 20 dB 等于 10 的因数，即

```
dB = 20 * log10(V / V0) 
```

因此，要将幅度增加 20 dB，您的峰值需要增加 10 倍，相反，-20 dB 是幅度减少 10 倍。

# android - customAdapter如何在getview的TextView.setText()中打印出数组的内容

> ID：10013630
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:51.117
> 
> 标签：android

我编写了一个 CustomAdapter 来将哈希键+值项的列表显示为列表。但我被困在下面的线上。

label.setText(my_VALUES[0])

第二类是我的 CustomAdapter，我正在传递一个 hashMap

```
public MyCustomAdapter(DynamicLists dynamicLists, int row, HashMap<String,String> data) 
```

在这里，我组合键+值对，并将它们分配给一个名为 my_VALUES 的数组。但我不知道这是否正确？

如何在 getview 中将每个 KEY+VALUE 对打印为单独的项目。目前我只能使用 label.setText(my_VALUES[0])

谢谢

格雷厄姆包 gb.org；

```
//lists are not checkboxes 
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;

import android.app.ListActivity;
import android.content.Context;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

//class 1 
public class DynamicLists extends ListActivity { 

//class 2 
public class MyCustomAdapter extends BaseAdapter { 
    private HashMap<String,String> mData = new HashMap<String,String>();
    private String[] mKeys;
    String[] my_VALUES = new String[100];

    public MyCustomAdapter(DynamicLists dynamicLists, int row, HashMap<String,String> data){ 
    mData = data;
    mKeys = mData.keySet().toArray(new String[data.size()]);
    Log.d(TAG, "INSIDE ADAPTER HELLO WORLD " + map.entrySet()); 

    String[] array = new String[map.size()];
    int count = 0;
    String combined="";
    for(Map.Entry<String, String> entry : map.entrySet()){
        combined="A"+entry.getKey()+"B"+entry.getValue();

    my_VALUES[count]=combined;
    Log.d(TAG, " my_VALUES " + my_VALUES);
    count++;

    }

}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
// TODO Auto-generated method stub
    String key = mKeys[position];
    String Value = getItem(position).toString();

    //do your view stuff here
    Log.d(TAG, "inside getview  ");
    View row=convertView;

if (row==null){
    LayoutInflater inflater=getLayoutInflater();
    row=inflater.inflate(R.layout.row, null);
}

TextView label =(TextView)row.findViewById(R.id.blocked);
label.setText(my_VALUES[0]);  //printing out the last value 

return row;   

}
@Override
public int getCount() {

    // TODO Auto-generated method stub
    return mData.size();
}
@Override
public Object getItem(int position) {
    // TODO Auto-generated method stub
    return mData.get(mKeys[position]);
}
@Override
public long getItemId(int position) {
    // TODO Auto-generated method stub
    return position;
}

}  //end of class 2 

private static final String TAG = "Example";

//class 1 

public static  HashMap<String, String> map = new HashMap<String, String>(); 

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   //tie data to list, call constructor MyCustomAdapter 
   //populate the list. ArrayAdapter takes current class, layout and array
   map.put("year", "Apple");    
   map.put("make", "Mango");     
   map.put("model", "Grape");    
   map.put("style", "Orange");     
   map.put("series", "Peach"); 
   Log.d(TAG, "HELLO WORLD " + map.entrySet());    
   //link to my adapter
   setListAdapter(new MyCustomAdapter(DynamicLists.this, R.layout.row, map));

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
// TODO Auto-generated method stub
//super.onListItemClick(l, v, position, id);
String selection = l.getItemAtPosition(position).toString();
Toast.makeText(this, selection, Toast.LENGTH_LONG).show();

}

} //end of class 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:00:47.137

看看这是否有效。

我只改变了两件事：1）如何实例化 my_VALUES 2）label.setText(my_VALUES[position]);

```
public class DynamicLists extends ListActivity { 

//class 2 
public class MyCustomAdapter extends BaseAdapter { 
    private HashMap<String,String> mData = new HashMap<String,String>();
    private String[] mKeys;
    String[] my_VALUES;

    public MyCustomAdapter(DynamicLists dynamicLists, int row, HashMap<String,String> data){ 
    mData = data;

    my_VALUES = new String[mData.size()];

    mKeys = mData.keySet().toArray(new String[data.size()]);
    Log.d(TAG, "INSIDE ADAPTER HELLO WORLD " + map.entrySet()); 

    String[] array = new String[map.size()];
    int count = 0;
    String combined="";
    for(Map.Entry<String, String> entry : map.entrySet()){
        combined="A"+entry.getKey()+"B"+entry.getValue();

    my_VALUES[count]=combined;
    Log.d(TAG, " my_VALUES " + my_VALUES);
    count++;

    }

}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
// TODO Auto-generated method stub
    String key = mKeys[position];
    String Value = getItem(position).toString();

    //do your view stuff here
    Log.d(TAG, "inside getview  ");
    View row=convertView;

if (row==null){
    LayoutInflater inflater=getLayoutInflater();
    row=inflater.inflate(R.layout.row, null);
}

TextView label =(TextView)row.findViewById(R.id.blocked);
label.setText(my_VALUES[position]);  //printing out the last value 

return row;   

}
@Override
public int getCount() {

    // TODO Auto-generated method stub
    return mData.size();
}
@Override
public Object getItem(int position) {
    // TODO Auto-generated method stub
    return mData.get(mKeys[position]);
}
@Override
public long getItemId(int position) {
    // TODO Auto-generated method stub
    return position;
}

}  //end of class 2 

private static final String TAG = "Example";

//class 1 

public static  HashMap<String, String> map = new HashMap<String, String>(); 

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   //tie data to list, call constructor MyCustomAdapter 
   //populate the list. ArrayAdapter takes current class, layout and array
   map.put("year", "Apple");    
   map.put("make", "Mango");     
   map.put("model", "Grape");    
   map.put("style", "Orange");     
   map.put("series", "Peach"); 
   Log.d(TAG, "HELLO WORLD " + map.entrySet());    
   //link to my adapter
   setListAdapter(new MyCustomAdapter(DynamicLists.this, R.layout.row, map));

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
// TODO Auto-generated method stub
//super.onListItemClick(l, v, position, id);
String selection = l.getItemAtPosition(position).toString();
Toast.makeText(this, selection, Toast.LENGTH_LONG).show();

}

} //end of class 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:17:49.133

你在java中只是做 label.setText(mKeys[position] + getItem(position).toString());

# facebook - 如何将之前的“赞”转移到新的升级域名地址？如何将网站与 FB 页面链接？

> ID：10013633
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:57.613
> 
> 标签：facebook, dns, blogs, hyperlink

我对插件的工作原理知之甚少，确实需要帮助。我有一个博客网站，我刚刚升级到了一个普通的域地址。最初的网站是[http://meltfitness.blog.com](http://meltfitness.blog.com)。现在域名地址是[http://meltfitness.net](http://meltfitness.net). 我正在尝试找出是否有任何方法可以不丢失原始域中的页面以前的喜欢。有没有办法将这些转移到新域？这个问题似乎只发生在个别帖子上；不是一般网站本身。此外，当有人在我的网站/页面/帖子上点击“喜欢”时，它不会延续到他们在 FB 上的“喜欢”部分。它似乎确实像最近出现的那样，但它并没有与我的 meltfitness.net FB 页面交织在一起。请，请，请帮忙！！我花了数小时和数天试图弄清楚这一点，但我根本不精通技术！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:58:44.267

我有一种感觉，你可能无法做到这一点。

读：

www.allfacebook.com/likes-domains-transfer-2010-08

和

uk.answers.yahoo.com/question/index?qid=20110628163905AAPh02C

我找不到任何 Facebook 文档说明这是不可能的。您可以通过[http://www.facebook.com/help从 Facebook 获得帮助](http://www.facebook.com/help)

祝你好运

# java - 查找 BankMenu 方法中的错误

> ID：10013634
> 
> 赞同：0
> 
> 时间：2012-04-04T14:50:59.360
> 
> 标签：java

方法bankTellerMenu() 旨在显示银行柜员菜单并重复获取用户的选择并执行该选择。仅当用户做出无效选择时才重新显示菜单。该方法存在语法和逻辑错误。如果这些错误得到纠正，那么实际输出将与下面显示的相匹配。更正代码并通过生成下面的输出对其进行测试。我已经强调了用户的反应，以使他们脱颖而出。

------------------------- 预期输出 ------------------------ ---

FIT银行

1.  订金
2.  提取
3.  客户菜单
4.  账户菜单
5.  出口

选择一个选项（1-5）：**7**

FIT银行

1.  订金
2.  提取
3.  客户菜单
4.  账户菜单
5.  出口

选项必须只有 1-5

选择一个选项（1-5）：**2**

***调用withdraw()

选择另一个选项 (1-5)：**5**

------------------------- 预期输出 ------------------------ ---

***现在问题开始了，我已经尝试对该方法进行编码，但是当我输入一个介于 1 和 5 之间的值时，它似乎无法调用withdraw() 或任何其他选择。有人可以帮忙吗？***

```
import java.util.*;

public class FITBank
{
    //There are no errors in the main method.
    public static void main(String[] args)
    {
        //Just run bank teller menu.
        bankTellerMenu();
    }

public static void bankTellerMenu()
{
    Scanner reader = new Scanner(System.in);
    int option = 1;                
    String message = null;

    do{
            System.out.println("\n\tFIT Bank");
            System.out.println("1\. Deposit");
            System.out.println("2\. Withdraw");
            System.out.println("3\. Client Menu");
            System.out.println("4\. Account Menu");
            System.out.println("5\. Exit");
            if(message!=null){
            System.out.println("\t"+message);
            }
            System.out.print("Select an option (1-5): ");
            option = reader.nextInt();

        if(option < 1 || option > 5){
                message = new String("Option must be only 1-5");
                option=1;
            }

        }while(option <1 && option > 5);

    if(option == 1) {

        System.out.println("***\tInvoke deposit()");

        }

            if(option == 2){
                System.out.println("***\tInvoke withdraw()");

            }

                if(option == 3)
                {   System.out.println("***\tInvoke clientMenu()");

            }

                if(option==4){
                    System.out.println("***\tInvoke accountMenu()");

                }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T14:56:11.910

您正在尽早关闭循环。将所有`if(option == ...)`语句移到 `}while(option >=1 && option < 5);`. 否则这将无法按预期工作。

此外，我建议使用`switch`语句而不是所有这些`if`语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T14:56:50.213

首先也是最重要的：你熟悉[switch 语句](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)吗？如果你不是，那么我认为这将是了解它的最佳时机。

> 现在问题开始了，我已经尝试对该方法进行编码，但是当我输入一个介于 1 和 5 之间的值时，它似乎无法调用withdraw() 或任何其他选择。

无需做功课：如果要调用该`withdraw`方法，则必须有一个`withdraw`方法可以调用。那么你的`withdraw`方法在哪里？或者你只是应该打印你正在调用该`withdraw`方法而不实际调用它？

# amazon - 用于 Amazon API 访问的 WinRT 和缺少的 Web API 模型

> ID：10013637
> 
> 赞同：5
> 
> 时间：2012-04-04T14:51:04.877
> 
> 标签：amazon, windows-8, microsoft-metro, windows-runtime

我正在将示例从下面的链接移植到 Windows 8 Metro 风格的应用程序

[http://aws.amazon.com/code/Product-Advertising-API/2480](http://aws.amazon.com/code/Product-Advertising-API/2480)

看起来 Web 模型中的许多功能在 WinRT 中已删除（或移动）：

```
HttpUtility.UrlEncode
HttpUtility.UrlDecode
HMAC / HMACSHA256 
```

仅举几例，我想知道是否有人可以帮助在 WInRT 上寻找替代方案？我上网查了一下，了解的很少。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T23:05:36.417

[请改用WebUtility](http://msdn.microsoft.com/en-us/library/system.net.webutility.aspx)类中的方法：

```
System.Net.WebUtility.UrlEncode(string);
System.Net.WebUtility.UrlDecode(string); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T09:30:27.490

这里有 URLDecode 的源代码，看起来**Uri.EscapeDataString**可以用于 Encode。

[http://www.koders.com/csharp/fid1A50096D8FA38302680B0EEDAC5B1CE1AEA855D0.aspx?s=%22Lawrence+Pit%22](http://www.koders.com/csharp/fid1A50096D8FA38302680B0EEDAC5B1CE1AEA855D0.aspx?s=%22Lawrence+Pit%22)

把源代码复制过来，把GetChars函数改成这个

```
 static char [] GetChars (MemoryStream b, Encoding e)
    {
        return e.GetChars (b.ToArray(), 0, (int) b.Length);
    } 
```

我必须使用此处的代码片段正确散列加密字符串 [http://channel9.msdn.com/Forums/TechOff/Porting-to-WinRT/4df7586e1ef5400682eda00f0143b610](http://channel9.msdn.com/Forums/TechOff/Porting-to-WinRT/4df7586e1ef5400682eda00f0143b610)

# excel - Excel VBA - 单击工作簿以卸载用户窗体

> ID：10013644
> 
> 赞同：0
> 
> 时间：2012-04-04T14:51:51.500
> 
> 标签：excel, vba

我有一个填充 excel 工作表的用户表单，但允许显示工作簿底部的选项卡。当用户在打开用户窗体时单击其中一个选项卡时，没有任何反应。每当用户单击不属于表单的内容时，是否有办法卸载用户表单？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T17:09:06.180

这是一种方法，尽管我对它在实践中的效果有点怀疑。首先将 Userform 的 ShowModal 属性设置为 False。这将允许用户在用户窗体之外单击并实际选择某些内容。

接下来，将此代码放入 ThisWorkbook 模块

```
Private Sub Workbook_SheetActivate(ByVal Sh As Object)

    On Error Resume Next
        Unload UserForm1

End Sub

Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)

    On Error Resume Next
        Unload UserForm1

End Sub 
```

当用户单击活动工作表中的工作表选项卡或单元格时，它将卸载用户窗体。用户可以单击的其他一百个位置可能不会触发这些事件，但它可能适用于您的情况。

# google-maps - 如何使用动画强制地图到 panTo？

> ID：10013645
> 
> 赞同：4
> 
> 时间：2012-04-04T14:51:59.777
> 
> 标签：google-maps, google-maps-api-3

正如 API 对 panTo() 的描述

> 将地图的中心更改为给定的 LatLng。如果变化小于地图的宽度和高度，则过渡将平滑动画。

但是如果我们需要一种机制来制作动画，即使变化大于地图的宽度/高度，我们该怎么做呢？

# events - Mootools：在补间或变形 FX 或其他事件结束后如何触发一个函数（或多个函数）？

> ID：10013646
> 
> 赞同：2
> 
> 时间：2012-04-04T14:52:02.663
> 
> 标签：events, mootools, chain

作为标题，我想知道如何在事件结束后触发函数。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:07:31.700

Fx 类都支持几个事件：

## 完成

最后一个动画完成时触发。

```
element.set("tween", {
    onComplete: function() {
        this; // the Fx.Tween instance
        this.element; // the element that tweened
    }
}).tween("opacity", [0, 1]); 
```

## 开始

动画开始时触发。

```
var myMorph = new Fx.Morph(element, {
    onStart: function() {
        this.element.addClass("disabled"); 
    }
});

myMorph.start({marginLeft: [-200, 0]}); 
```

## 取消

停止动画时触发。

此外，Fx.Elements 具有一组通用的相同事件，适用于所有受控动画。

看看文档。[例如http://mootools.net/docs/core/Fx/Fx.Morph](http://mootools.net/docs/core/Fx/Fx.Morph) - 和 Fx 文档。您可以使用任何事件或事件组合。

您还可以设置`link: "chain"`或“取消”或“忽略”等进行高级控制。

# c# - 通过快捷方式文件夹从基本文件夹加载文件？

> ID：10013651
> 
> 赞同：1
> 
> 时间：2012-04-04T14:52:26.923
> 
> 标签：c#, .net, io, filesystems

简介：我必须让服务器运行相同的应用程序，其中一个将托管一些媒体文件 [mp4] 我需要播放这些媒体，无论我从服务器 1 还是服务器 2 调用站点。

详细地说，我的网站发布在两个不同的 IIS 服务器上，一个我需要在 IIS 服务器 1 上放置一个文件夹，并且可以从 IIS 服务器 2 访问该文件夹及其内容。

我尝试在服务器 2 上放置一个快捷方式，该快捷方式指的是服务器 1 上的实际文件夹。当然打开它没问题，抛出 windows 文件系统。

但是我怎么能通过快捷方式从实际文件夹中加载文件..如果可能的话

**如果没有，请告诉我解决此类问题的方法！？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:58:36.560

在另一台服务器上的文件夹中创建一个虚拟文件夹。

[在这里](http://support.microsoft.com/kb/308150)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T10:06:35.380

如果您无法在 IIS 中创建虚拟目录，则始终可以创建`NTFS Symbolic Links`. [在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365680%28v=vs.85%29.aspx)阅读有关它们的更多信息

# wpf - WPF MultiBinding TextBlock.Text

> ID：10013652
> 
> 赞同：2
> 
> 时间：2012-04-04T14:52:34.443
> 
> 标签：wpf

以下代码用于绑定 ListView，但对 ListView 的任何更改都不会返回到内存中的数据结构。当我有标准绑定时，它可以双向工作，但不能使用多重绑定。我需要使用多重绑定来获取转换器中使用的 StringFormat 属性。

您能否让我知道一种方法来调用转换器的“ConvertBack”方法？

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:DataFlowControls">

    <local:ValueToFormatedValueConverter x:Key="valueToFormatedValueConverter" />

    <Style TargetType="{x:Type local:DfcEditTextBox}">
        <Setter Property="Margin" Value="-6, 0, -6, 0" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:DfcEditTextBox}">
                    <TextBlock x:Name="PART_TextBlock" Padding="2, 0, 0, 0">                               
                        <TextBlock.Text>
                            <MultiBinding Converter="{StaticResource valueToFormatedValueConverter}">   
                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Value" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"/>
                                <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="StringFormat" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
<!--Text="{Binding Path=Value, Mode=TwoWay, Converter={StaticResource valueToFormatedValueConverter}, RelativeSource={RelativeSource TemplatedParent}}" />-->

<Window x:Class="DataFlowControls.Show.DfcListView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dfc="clr-namespace:DataFlowControls;assembly=DataFlowControls"
        xmlns:local="clr-namespace:DataFlowControls.Show"
        Title="DfcListView" Height="400" Width="500">
    <Grid>
        <StackPanel>
            <dfc:DfcListView Name="lvTradesCollection" ItemsSource="{Binding Path=TradesCollection}" KeyboardNavigation.DirectionalNavigation="Continue" >
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.Resources>
                    <DataTemplate x:Key="Date_DataTemplate">
                        <dfc:DfcEditTextBox Value="{Binding Path=Date, Mode=Twoway, UpdateSourceTrigger=PropertyChanged}" StringFormat='{}{0:dd/MM/yyyy}' HorizontalContentAlignment="Left" IsEditable="true" />
                    </DataTemplate>
                    <DataTemplate x:Key="Asset_DataTemplate">
                        <dfc:DfcEditTextBox Value="{Binding Path=Asset, Mode=Twoway, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Left" IsEditable="true" />
                    </DataTemplate>
                    <DataTemplate x:Key="Lots_DataTemplate">
                        <dfc:DfcEditTextBox Value="{Binding Path=Lots, Mode=Twoway, UpdateSourceTrigger=PropertyChanged}" StringFormat='N0' HorizontalContentAlignment="Center" IsEditable="true" />
                    </DataTemplate>
                    <DataTemplate x:Key="Price_DataTemplate">
                        <dfc:DfcEditTextBox Value="{Binding Path=Price, Mode=Twoway, UpdateSourceTrigger=PropertyChanged}" StringFormat='N2' HorizontalContentAlignment="Center" IsEditable="true" />
                    </DataTemplate>
                    <DataTemplate x:Key="IsCheap_DataTemplate">
                        <dfc:DfcEditCheckBox Value="{Binding Path=IsCheap, Mode=Twoway, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Center" IsEditable="true" />
                    </DataTemplate>
                    <DataTemplate x:Key="NextTrade_DataTemplate">
                        <dfc:DfcEditComboBox Value="{Binding Path=NextTrade, Mode=Twoway, UpdateSourceTrigger=PropertyChanged}" ItemsSource="{x:Static local:DfcListView.NextTradeTypes}" IsEditable="true" />
                    </DataTemplate>
                </ListView.Resources>
                <ListView.View>
                    <dfc:DfcGridView>
                        <dfc:DfcGridViewColumn Header="Date" Width="140" CellTemplate="{StaticResource Date_DataTemplate}" />
                        <dfc:DfcGridViewColumn Header="Asset" Width="40" CellTemplate="{StaticResource Asset_DataTemplate}" />
                        <dfc:DfcGridViewColumn Header="Lots" Width="40" CellTemplate="{StaticResource Lots_DataTemplate}" />
                        <dfc:DfcGridViewColumn Header="Price" Width="50" CellTemplate="{StaticResource Price_DataTemplate}" />
                        <dfc:DfcGridViewColumn Header="IsCheap" Width="60" CellTemplate="{StaticResource IsCheap_DataTemplate}" />
                        <dfc:DfcGridViewColumn Header="NextTrade" Width="80" CellTemplate="{StaticResource NextTrade_DataTemplate}" />                                                                         
                    </dfc:DfcGridView>
                </ListView.View>
            </dfc:DfcListView>
            <Button Content="Add Row" HorizontalAlignment="Left" Margin="5,5,5,5" Click="AddRow_Click"/>
            <Button Content="Update Row" HorizontalAlignment="Left" Margin="5,5,5,5" Click="UpdateRow_Click"/>
        </StackPanel>
    </Grid>
</Window>

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Data;
using System.Globalization;
using System.Windows;

namespace DataFlowControls
{
    public class ValueToFormatedValueConverter : IMultiValueConverter
    {
        public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
        {
            object valueObject = values[0];
            string stringFormat = (string)values[1];

            if (stringFormat == null)
            {
                return valueObject.ToString();
            }
            if (stringFormat.Substring(0, 1) == "N")
            {
                int intValue;
                if (Int32.TryParse(valueObject.ToString(), out intValue))
                {
                    return (intValue * 100).ToString(stringFormat);
                }
                double doubleValue;
                if (Double.TryParse(valueObject.ToString(), out doubleValue))
                {
                    return doubleValue.ToString(stringFormat);
                }
                decimal decimalValue;
                if (Decimal.TryParse(valueObject.ToString(), out decimalValue))
                {
                    return decimalValue.ToString(stringFormat);
                }
            }
            if (stringFormat == "{0:dd/MM/yyyy}")
            {
                return ((DateTime)valueObject).ToShortDateString();
            }
            throw new NotImplementedException();
        }

        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
        {
            return Enumerable.Repeat(value, targetTypes.Length).ToArray();
        }      
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T18:52:36.530

您需要在 MultiBinding 上明确设置 TwoWay 模式：

```
<TextBlock.Text> 
    <MultiBinding Converter="{StaticResource valueToFormatedValueConverter}"
                  Mode="TwoWay">    
        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Value" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"/> 
        <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="StringFormat" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"/> 
    </MultiBinding> 
</TextBlock.Text> 
```

# javascript - jquery：弹出窗口不会出现整个页面

> ID：10013653
> 
> 赞同：0
> 
> 时间：2012-04-04T14:52:36.877
> 
> 标签：javascript, jquery-ui, jquery, jquery-plugins

弹出窗口工作得很好。

`.backdrop`出现一半:(

这是CSS代码

```
.backdrop
{
    position:absolute;
    top:0px;
    left:0px;
    width:100%;
    height:100%;
    background:#000;
    opacity: .0;
    filter:alpha(opacity=0);
    z-index:50;
    display:none;
} 
```

图像样本 ![在此处输入图像描述](../Images/21109698e62a8dc830ee31ca8b85e020.png)

[http://jsfiddle.net/sweetmaanu/qWFLC/](http://jsfiddle.net/sweetmaanu/qWFLC/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:09:05.760

您应该能够通过`position`从更改`absolute`为轻松解决此问题`fixed`。

如果您不想使用，也可以给它一个非常大的像素值，而不是 100% 的高度和宽度`position: fixed;`，即。`height: 99999px; width: 99999px;`，但这可能会导致必须解决的其他问题（例如滚动条问题）。

# mysql - 如何在 MYSQL 的 FROM 子句中指定要更新的目标表？

> ID：10013656
> 
> 赞同：0
> 
> 时间：2012-04-04T14:52:54.720
> 
> 标签：mysql, sql, clause

我的脚本-：

```
UPDATE catalog_product_price 
SET catalog_product_price.value = 200
WHERE value_id = (
    SELECT value_id
    FROM catalog_product_price
    WHERE `entity_id` = ( 
        SELECT `entity_id` 
        FROM `catalog_product_entity` 
        WHERE `sku` LIKE 'sample'
        ) 
    AND website_id = 10
    AND customer_group_id= (
        SELECT customer_group_id
        FROM customer_group
        WHERE 
            customer_group_id = catalog_product_price.customer_group_id 
            AND customer_group_code =100
        )
    ) 
```

它给了我以下错误-：

> #1093 - 您不能在 FROM 子句中指定目标表 'catalog_product_price' 进行更新

任何人都可以为我提供与我在此链接上尝试的解决方案相同的解决方案-： [http ://www.mysqlfaqs.net/mysql-faqs/Errors/1093-You-can-not-specify-target-table-comments- for-update-in-FROM-clause](http://www.mysqlfaqs.net/mysql-faqs/Errors/1093-You-can-not-specify-target-table-comments-for-update-in-FROM-clause) 但无法执行...请帮助我..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:02:34.140

您需要将表连接到 UPDATE 语句而不是使用所有这些子查询

```
UPDATE  catalog_product_price cpp

JOIN    catalog_product_entity cpe
  ON    cpe.entity_id = cpp.entity_id
  AND   cpe.sku LIKE 'sample'
  AND   website_id = 10

JOIN    customer_group cg
  ON    cg.customer_group_id = cpp.customer_group_id
  AND   cg.customer_group_code = 100

SET cpp.value = 200 
```

**注意：**您的语法很难阅读，因此我可能在解释它时犯了错误。无论如何，这就是想法，它应该可以帮助您获得最终答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:15:18.267

将查询的值存储在[用户定义的变量](http://dev.mysql.com/doc/refman/5.0/en/user-variables.html)中：

```
set @value_id := (
    SELECT value_id
    FROM catalog_product_price
    WHERE `entity_id` = ( 
        SELECT `entity_id` 
        FROM `catalog_product_entity` 
        WHERE `sku` LIKE 'sample'
    );
set @customer_group_id := (
    SELECT customer_group_id
    FROM catalog_product_price
    WHERE `entity_id` = ( 
        SELECT `entity_id` 
        FROM `catalog_product_entity` 
        WHERE `sku` LIKE 'sample'
    );

UPDATE catalog_product_price 
SET catalog_product_price.value = 200
WHERE value_id = @value_id 
AND website_id = 10
AND customer_group_id = @customer_group_id; 
```

请注意，您的第二个内部查询是无稽之谈-您正在选择`customer_group_id`由于 where 子句而其值已知的列`WHERE customer_group_id = catalog_product_price.customer_group_id`...完全多余

# javascript - 搜索响应式下拉菜单

> ID：10013657
> 
> 赞同：1
> 
> 时间：2012-04-04T14:52:56.927
> 
> 标签：javascript, jquery, html, css, drop-down-menu

我正在设计一个可用于台式机和移动设备的网站，并且我正在尝试找到一种使用传统下拉菜单的方法，该方法可以更好地适应移动环境。（像手风琴或类似的东西是理想的）

欢迎任何和所有建议:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T14:53:41.030

如果您正在寻找可以将下拉菜单转换为手风琴之类的东西，它保留了相同的功能并且在移动设备上很常见，您可能需要查看以下链接：（*它完全使用 CSS 完成)*

**[CSS 科学 | 手风琴的响应式下拉菜单（带演示）](http://csscience.com/dropdown-accordion/)**

*（当浏览器宽度小于 500 时，这基本上会将您的下拉菜单转换为手风琴，这应该可以满足您对“移动”环境的需求。）*

# actionscript-3 - 如何从我的应用程序 swf 中访问嵌入对象的宽度属性？

> ID：10013658
> 
> 赞同：0
> 
> 时间：2012-04-04T14:52:56.927
> 
> 标签：actionscript-3, flash, apache-flex, flex3, flash-builder

我有一个带有根 mx:Application 的 flex 3 项目。宽度和高度设置为 pct 值，因为应用程序有多种尺寸可供用户选择，因此在嵌入的宽度属性上设置了正确的尺寸。

我试图弄清楚如何访问该属性中的值。我在几个地方读到 this.root.loaderInfo.width 应该给我这个值，但它总是返回 500，我猜它来自默认的应用程序容器宽度（参见[http://help.adobe.com/en_US/弹性/使用/WS2db454920e96a9e51e63e3d11c0bf62d75-7fff.html](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf62d75-7fff.html)）。

我意识到我可以将它作为 flashvar 传递，但由于项目的性质，在这种情况下这不是一个好的解决方案。我还尝试过 Application.application.width、stage.width 和 stage.stageWidth 等等。我不能依赖任何这些值，因为它们会根据浏览器缩放级别而变化。

我真正需要的是嵌入的宽度属性。建议？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T17:19:11.143

返回的宽度`stage.stageWidth`取决于 SWF 的[缩放模式](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/StageScaleMode.html)设置。`stage.scaleMode = StageScaleMode.NO_SCALE;`Flex 使用的，返回容器的大小。它受嵌入大小和浏览器缩放级别的影响。

如果`stage.scaleMode`设置为其他任何值，它将返回 SWF 中定义的尺寸，始终返回相同的值。并且，正如您所提到的，`loaderInfo.width`返回 SWF 中设置的尺寸，无论缩放模式或嵌入尺寸如何。不幸的是，没有设置使其受嵌入大小的影响，但*不受*浏览器缩放级别的影响。

无论浏览器缩放级别如何，找到容器尺寸的唯一方法是将其作为嵌入代码中的参数传递，或者使用[`ExternalInterface`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)，就像 wvxvw 提到的那样。我可能会走 flash var 路线——你在不同的布局之间进行选择，所以有一个设置而不是根据容器大小隐式选择就足够了。或者，您也可以根据一系列尺寸/纵横比而不是特定值来选择布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T13:34:38.137

最终需要使用外部接口。这是我添加到 js 嵌入文件中的 js：

```
function getSwfDimensions() {
    var swf = document.getElementById('myMovie');
    sendSwfDimensions({width:swf.width, height:swf.height});
}
function sendSwfDimensions(d) {
    thisMovie("myMovie").sendToActionScript(d);
}
function thisMovie(movieName) {
    if (navigator.appName.indexOf("Microsoft") != -1) {
        return window[movieName];
    } else {
        return document[movieName];
    }
} 
```

并在一瞬间：

```
private function getSwfDimensions():void {
    ExternalInterface.addCallback("sendToActionScript", swfDimensionsReceived);
    ExternalInterface.call("getSwfDimensions"); 
}
public function swfDimensionsReceived(d):void {
    //set the width and height
    this._width = this.width = d.width;
    this._height = this.height = d.height;
    //set up a listener to handle browser zoom changes
    this.stage.addEventListener(Event.RESIZE, onStageResize);
} 
```

# javascript - 如何将 span 标签存储在文本框旁边？

> ID：10013662
> 
> 赞同：0
> 
> 时间：2012-04-04T14:53:16.533
> 
> 标签：javascript, jquery

嗨，下面我有一个javascript代码，应该发生的是它在文本框旁边附加了一个文本框和[Open Grid]（在一个跨度中）。文本框存储在数组 +"[]" 中，所以我尝试使用 .after() 将跨度放在文本框之后，但问题是即使它显示文本框，它也不显示跨度 [Open Grid]。如何让超链接显示在文本框旁边？

下面是代码：

```
 <script>

    $(document).on('click','.showGrid', function(e) {

        $(".gridBtns").removeClass("gridBtnsOn");

        var value = $(this)
            .siblings('input[name=gridValues]').val();

        $("#btn" + value.replace(/\s/g, '')).addClass("gridBtnsOn");

        $('.optionTypeTbl').fadeToggle('slow');
        $(this).parent().append($('.optionTypeTbl'));
        $('.optionTypeTbl').css({

            left: $(this).position().left,
            top: $(this).position().top + 20

        });

        e.stopPropagation();

    });

        function insertQuestion(form) {   

        var context = $('#optionAndAnswer');

        var $tbody = $('#qandatbl > tbody'); 
        var $tr = $("<tr class='optionAndAnswer' align='center'></tr>");
        var $options = $("<td class='option'></td>");

        $('.gridTxt', context).each( function() {

var $this = $(this);
var $optionsText = $("<input type='text' class='gridTxtRow maxRow' readonly='readonly' />")
    .attr('name',$this.attr('name')+"[]")
    .attr('value',$this.val())
    .appendTo( $options )
    .after("<span href='#' class='showGrid'>[Open Grid]</span>");

    $questionType = $this.val();

        });

        $tr.append($options);    
        $tbody.append($tr); 

        }

    </script>

    <form id="QandA" action="insertQuestion.php" method="post" >

    <table id="optionAndAnswer" class="optionAndAnswer">
    <tr class="option">
    <td>Option Type:</td>
    <td>
    <div>
        <input type="text" name="gridValues" class="gridTxt maxRow" readonly="readonly" />
        <span href="#" class="showGrid" id="showGridId">[Open Grid]</span>
    </div>
    <table class="optionTypeTbl">
    <tr>

        <?php
        $i = 1;
        foreach($num as $key => $val){
            if($i%7 == 1) echo"<tr><td>";
            echo"<input type=\"button\" value=\"$val\" id=\"btn".$val."\" name=\"btn".$val."Name\" class=\"gridBtns gridBtnsOff\">";        
            if($i%7 == 0) echo"</td></tr>";
            $i++;
        }
        ?>

            </tr>
            <tr>
            <td>
            <input class="gridBtns" name="btnTrueorFalseName"  id="btnTrueorFalse"  type="button"  value="True or False"  />
            <input class="gridBtns" name="btnYesorNoName"  id="btnYesorNo"  type="button"  value="Yes or No"  />
            </td>
            </tr> 
            </table>

            </td>
    </tr>
    </td>
    </tr>
    </table>

    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:18:07.267

这是因为你的：

```
var value = $(this)
            .siblings('input[name=gridValues]').val(); 
```

实际上是：

```
var value = $(this)
            .siblings('input[name=gridValues[]]').val(); 
```

试试这个。如果不。然后是`.map()`- 我以前没有使用过，但我们可以一起研究......

* * *

更新

可能你甚至需要：

```
var value = $(this)
            .siblings('input[name=gridValues\\[\\]]').val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:18:03.663

```
var $this = $(this);
var $optionsText = $("<input type='text' class='gridTxtRow maxRow' readonly='readonly' />")
    .attr('name',$this.attr('name')+"[]")
    .attr('value',$this.val())
    .appendTo( $options )
    .after("<span class='showGrid'>[Open Grid]</span>"); 
```

试试这个

# java - 设置以 Java 结尾的默认行

> ID：10013665
> 
> 赞同：6
> 
> 时间：2012-04-04T14:53:24.533
> 
> 标签：java, newline, eol, lf

我在多平台环境（Windows + Linux）中使用 Java。然而，无论我们生成什么文本文件，都应该使用 LF 作为其 EOL 序列。

有没有一种方法可以强制 Java 使用这个 EOL 序列，而不管我在哪个平台上运行程序？我不想改变整个程序，即所有对 System.out.println 和类似的调用都应该保持原样，只有函数末尾的 *ln 应该始终输出“0x0A”而不是“ 0x0D 0x0A”。

我可以想到两种不同的方法，但我不知道是否有一种可能：

1.  覆盖平台相关的默认 EOL 序列
2.  即使我在 DOS 命令行上运行我的程序，也让 Java 相信我正在运行 Linux

这有可能吗？或者别的什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:01:23.717

您可以尝试设置相应的系统属性，如`System.setProperty("line.separator", "something you need");`（也可以通过命令行参数到JVM来实现）

或者，也许，您可以在需要的地方使用`print`insetad of`println`和打印换行符（`"\r"`、 "\n" 或其组合）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:04:07.960

看看[这个](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#setProperty%28java.lang.String,%20java.lang.String%29)和[这个](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)。如果你把它们放在一起，你会发现这`System.setProperty("line.separator", "\n");`可以解决你的问题。

不过还没有测试过，这就是我添加链接的原因，所以你可以自己检查。

# android - 使用带有 ActionBarSherlock 的导航选项卡时不显示片段

> ID：10013666
> 
> 赞同：1
> 
> 时间：2012-04-04T14:53:25.347
> 
> 标签：android, tabs, navigation, android-actionbar, actionbarsherlock

我正在尝试使用导航选项卡在某些片段之间进行更改，就像您可以使用 Tabhost 一样。
不幸的是，选项卡显示在 ActionBar 中，但片段的内容却没有。这是我的 MainActivity 代码：

```
import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.ActionBar.Tab;
import com.actionbarsherlock.app.ActionBar.TabListener;
import com.actionbarsherlock.app.SherlockFragmentActivity;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentTransaction;

public class MainActivity extends SherlockFragmentActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    ActionBar bar = getSupportActionBar();
    bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    Tab tab = bar
            .newTab()
            .setText("Tab1")
            .setTabListener(new MyTabListener(this, new Fragment1()));
    bar.addTab(tab);

    tab = bar
            .newTab()
            .setText("Tab2")
            .setTabListener(new MyTabListener(this, new Fragment2()));
    bar.addTab(tab);
}

public static class MyTabListener implements TabListener {

    private MainActivity mActivity;
    private Fragment mFragment;

    public MyTabListener(MainActivity activity, Fragment fragment) {
        mActivity = activity;
        mFragment = fragment;
    }

    @Override
    public void onTabSelected(Tab tab, FragmentTransaction ignoredFt) {
        FragmentManager fragmentManager = mActivity.getSupportFragmentManager();
        FragmentTransaction ft = fragmentManager.beginTransaction();
        ft.add(R.id.content, mFragment, null);
    }

    @Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
    }

    @Override
    public void onTabReselected(Tab tab, FragmentTransaction ft) {
    }
}
} 
```

片段1.java：

```
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class Fragment1 extends Fragment {

    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return inflater.inflate(R.layout.fragment1, container, false);
    }

} 
```

片段1.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceLarge" />

</LinearLayout> 
```

主.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/content" >
</LinearLayout>

</LinearLayout> 
```

Fragment2 的结构与 Fragment1 相同，但 TextView 中的其他文本！
所以似乎片段的视图无法显示在 main.xml 的内容中。

我希望你能帮帮我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:07:27.113

看起来你错过了`FragmentTransaction.commit()`

# objective-c - NSLog 2位数显示

> ID：10013667
> 
> 赞同：1
> 
> 时间：2012-04-04T14:53:26.587
> 
> 标签：objective-c, nslog

在这里我有一个

```
int x=3;

NSLog(@"%i", x); 
```

如何让它显示为“01”？如果 x=12 让它显示为“12”？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T14:57:35.920

怎么样`"%02d"`？

还是`"%02i"`？

（有关格式化信息或[cocoadev NSLOG](http://www.cocoadev.com/index.pl?NSLog) ，请参见 man printf ）

# c - 如何检测 C 中何时按下 shift 键？

> ID：10013669
> 
> 赞同：0
> 
> 时间：2012-04-04T14:53:29.620
> 
> 标签：c, macos

我正在使用 GCC 编译器，我想编写一个等待`CTRL`++`SHIFT`被`A`按下的程序......

我可以检测到`CTRL`+`A`但我无法确定`SHIFT`是否按下。

请完整编写代码！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:05:52.750

这不是语言的功能，它取决于机器。记住 C 被设计为也可以在没有键盘的机器上运行。

与检测鼠标移动一样，检测按键是您正在使用的操作系统/GUI 窗口的工作。它将记录在 MacOSX 文档的某处。

您可以检测到 ctrl-A 的原因是有一些 ASCII 代码没有键，用于控制功能（敲响铃铛、提前纸等），这些代码是在现代键盘上用 ctr+字母输入的. 所以你可以做'ctrl'有点历史意外

# sql-server - SQL Server 数据库架构（设计）+ 已删除对象的报告

> ID：10013670
> 
> 赞同：0
> 
> 时间：2012-04-04T14:53:31.837
> 
> 标签：sql-server, database, architecture

即使条目被删除，我也想处理条目以用于报告目的。

例如（简单场景），我有两个表：

1.  管理员
2.  管理员操作

如果管理员做某事，它将被保存到`AdministratorActions`表中。应该可以从`Administrators`表中删除一些管理员（条目）。

但是，当我们从表中删除（真正删除）一些管理员时，我们无法将操作跟踪`AdministratorActions`回删除的名称。

最简单的解决方案是：只需`IsDeleted`在`Administrators`表中添加一列，而不实际删除条目。但我认为，这是一个非常丑陋的数据库设计。

有没有其他好的解决方案可以做到这一点？

背景是：我们必须报告所有已完成的操作，并且应该能够将这些操作追溯到发起者（表的管理员名称`Administrators`。

我非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:59:45.797

我觉得一点也不丑。

如果您想实际删除管理员记录，那么您将无法从 AdministratorActions 创建 FOREIGN KEY 约束——恕我直言，这是一个更糟糕的情况。

对记录使用某种形式的 IsDeleted/Status 标志以保持引用完整性是非常常见的，这确保您可以从 FK 约束中受益。

另一种方法是将管理员的数据也存储在 AdministratorActions 表中，而不是通过 id 进行链接。但是，您应该问自己是否真的想要这种级别的数据重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T14:57:37.773

您可以对`AdministratorActions`表和`AdministratorName`列进行非规范化。

# c# - 窗口大小与样机不同

> ID：10013672
> 
> 赞同：0
> 
> 时间：2012-04-04T14:53:38.167
> 
> 标签：c#, .net, wpf, xaml

我已经用其中一种非标准形状构建了一个应用程序，因此所有正常的镶边都被删除了，一切都由我在 Adob​​e Fireworks 中设计的图形组成。

当我运行我的应用程序并将窗口大小与我在 FW 中制作的模型进行比较时，应用程序显得更大。我拥有的模型不仅仅是模型，它们与应用程序相同，我将它们切成 PNG 并使用它们进行构建。

因此，该应用程序看起来与模型完全相同，但稍大一些。任何想法为什么以及如何解决？

我已经仔细检查了 XAML 中设置的宽度和高度是否正确并且与 FW 模型相同，所以不知道它有什么问题。

我需要修复的主要原因是图像都显得有些模糊，我想这是因为应用程序被拉伸了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:06:45.280

这是由于 WPF 应用程序和标准图像（网络 gif 等）之间的 DPI 差异。

默认情况下，Fireworks 将创建 72dpi 的图像，混合或 WPF 会将图像缩放到**96dpi**。

在烟花中......创建新图像时（文件>新建......）将分辨率设置为**96** dpi（见截图）

然后导出的图像将正确缩放。

![在此处输入图像描述](../Images/67d532e638bc39bb341553c77dbdb8f4.png)

本

# ms-access - VBA 代码“查询输入必须包含至少一个表或查询”

> ID：10013676
> 
> 赞同：1
> 
> 时间：2012-04-04T14:53:51.787
> 
> 标签：ms-access, vba

我想获取当前数据库中 TBLCommissionTransactions 中的所有字段，并在 T:\folder\TblBackups.mdb 中创建一个新表，并将今天的日期和时间附加到新表名中。这纯粹是出于存档目的。

对不起，不是很精通VBA。我有以下代码是我从在线搜索中修改的。当我运行它时，我收到消息“查询输入必须包含至少一个表或查询”，我怀疑它在 strTableName 上失败，但并不确定。我玩过它，但无法让它工作。我究竟做错了什么？

```
Private Sub BackupTblCommissions_Click()
Dim strTableName As String
Dim strFilename As String
Dim strSQL As String
strFilename = "T:\folder\TblBackups.mdb"
strTableName = "TBLCommissionTransactions" & Format(Now(), "yyyymmdd-hhmm")
strSQL = "SELECT TBLCommissionTransactions.* INTO " & strTableName & " IN " & _
strFilename & " FROM TBLCommissionTransactions;"

CurrentDb.Execute strSQL
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:57:42.590

您缺少一些大括号和引号：

```
SELECT TBLCommissionTransactions.* 
INTO [TBLCommissionTransactions20120405-0054] IN 'T:\folder\TblBackups.mdb' 
FROM TBLCommissionTransactions; 
```

所以

```
strFilename = "'T:\folder\TblBackups.mdb'"
strTableName = "[TBLCommissionTransactions" & Format(Now(), "yyyymmdd-hhmm" & "]")
strSQL = "SELECT TBLCommissionTransactions.* INTO " & strTableName & " IN " & _
strFilename & " FROM TBLCommissionTransactions;" 
```

# r - 将 data.frame 折叠到 data.frame —— by() 和 aggregate() 的问题

> ID：10013682
> 
> 赞同：5
> 
> 时间：2012-04-04T14:54:17.553
> 
> 标签：r

考虑到我有以下数据和函数返回我喜欢的汇总统计信息

```
landlines <- data.frame(
                year=rep(c(1990,1995,2000,2005,2010),times=3),
                country=rep(c("US", "Brazil", "Asia"), each=5),
                pct =  c(0.99, 0.99, 0.98, 0.05, 0.9,
                         0.4,  0.5,  0.55, 0.5,  0.45,
                         0.7,  0.85, 0.9,  0.85, 0.75)
                )
someStats <- function(x)
{
  dp <- as.matrix(x$pct)-mean(x$pct)
  indp <- as.matrix(x$year)-mean(x$year)
  f <- lm.fit( indp,dp )$coefficients
  w <- sd(x$pct)
  m <- min(x$pct)
  results <- c(f,w,m)
  names(results) <- c("coef","sdev", "minPct")
  results
} 
```

我可以像这样成功地将该函数应用于数据子集：

```
> someStats(landlines[landlines$country=="US",])
      coef      sdev    minPct 
 -0.022400  0.410938  0.050000 
```

或查看如下国家/地区的细分：

```
> by(landlines, list(country=landlines$country), someStats)
country: Asia
      coef       sdev     minPct 
0.00200000 0.08215838 0.70000000 
--------------------------------------------------------------------------------------- 
country: Brazil
      coef       sdev     minPct 
0.00200000 0.05700877 0.40000000 
--------------------------------------------------------------------------------------- 
country: US
     coef      sdev    miPct 
-0.022400  0.410938  0.050000 
```

麻烦的是，这不是`data.frame`我需要进一步处理的对象，它不会这样转换：

```
> as.data.frame( by(landlines, list(country=landlines$country), someStats) )
Error in as.data.frame.default(by(landlines, list(country = landlines$country),  : 
  cannot coerce class '"by"' into a data.frame 
```

“没问题！” 我认为，因为类似的`aggregate()`函数确实返回 a `data.frame`：

```
> aggregate(landlines$pct, by=list(country=landlines$country), min)
  country    x
1    Asia 0.70
2  Brazil 0.40
3      US 0.05 
```

麻烦的是，它不能与任意函数一起正常工作：

```
> aggregate(landlines, by=list(country=landlines$country), someStats)
Error in x$pct : $ operator is invalid for atomic vectors 
```

我真正想要的是一个`data.frame`具有以下列的对象：

*   国家
*   系数
*   开发者
*   最小百分比

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T14:58:53.333

看看`plyr`包装，特别是`ddply`

```
> ddply(landlines, .(country), someStats)
  country    coef       sdev minPct
1    Asia  0.0020 0.08215838   0.70
2  Brazil  0.0020 0.05700877   0.40
3      US -0.0224 0.41093795   0.05 
```

理想情况下，您的函数显式返回 a`data.frame`但在这种情况下，可以轻松且正确地将其强制为 a。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T15:27:53.707

`by`对象实际上是列表，因此您可以`rbind`在 a中使用`do.call`：

```
do.call("rbind",by(landlines, list(country=landlines$country), someStats))
          coef       sdev minPct
Asia    0.0020 0.08215838   0.70
Brazil  0.0020 0.05700877   0.40
US     -0.0224 0.41093795   0.05 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-04T15:11:44.340

`aggregate`是为不同的目的而设计的。你想要的是`lapply(split())`：

```
> lapply( split(landlines, list(country=landlines$country)), FUN=someStats)
$Asia
      coef       sdev     minPct 
0.00200000 0.08215838 0.70000000 

$Brazil
      coef       sdev     minPct 
0.00200000 0.05700877 0.40000000 

$US
     coef      sdev    minPct 
-0.022400  0.410938  0.050000 
```

在输出可以预见的规则的情况下，使用 sapply 可能会更好：

```
> sapply( split(landlines, list(country=landlines$country)), FUN=someStats)
             Asia     Brazil        US
coef   0.00200000 0.00200000 -0.022400
sdev   0.08215838 0.05700877  0.410938
minPct 0.70000000 0.40000000  0.050000 
```

添加了使用行名中的值构造第一列的演示：

```
> ttbl <- as.data.frame(t(tbl))
> ttbl <- cbind(Country=rownames(ttbl), ttbl)
> ttbl
       Country    coef       sdev minPct
Asia      Asia  0.0020 0.08215838   0.70
Brazil  Brazil  0.0020 0.05700877   0.40
US          US -0.0224 0.41093795   0.05 
```

# algorithm - 是否有地球移动器距离的定向版本

> ID：10013686
> 
> 赞同：1
> 
> 时间：2012-04-04T14:54:32.163
> 
> 标签：algorithm, metric

我目前有一个问题，我想比较两个一维分布。在我的情况下，我试图找出我必须将其中一个分布移动到另一个分布，所以我会使用推土机距离进行比较。但是，我也对将分布转变为另一个的实际方向感兴趣。

一维中是否存在有向版本的推土机距离？

更准确地说，我有两个分布`f : {1...N} -> |R`，`g : {1...N} -> |R`我必须互相转换。现在我还想乘以从 bins in 移动到 bins in 的污垢量`f`，`g`但我想考虑这个方向。即，如果“污垢”从一个垃圾箱移动到另一个`x`垃圾箱，`y`我想乘以我移动的数量，`x-y`而不是`d(x,y)`标准的推土机距离。然后我想找到移动地球的总量最小化的运动。

有没有我可以使用的已知算法？我想我应该能够为此修改原始的匈牙利算法，但我还不确定如何做到这一点，因为我以前从未使用过这个算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:16:46.330

因此，如果我正确理解了您的问题，那么我认为下面的代码（在 Go 中）可以解决。如果您可以假设每个分布的积分相等（这意味着可以将一个转换为另一个），那么只需移动通过你的分布，从左到右，并在每一点计算出需要从右侧移动多少污垢，或者需要从那里向左侧移动多少多余的污垢。在所有情况下，您都可以假设您需要的任何污垢都可以得到，因此暂时有“负面”污垢是可以的。

```
// Finds out how to move dirt to transform b into a.
// assumes that the integrals over a and b are equal
func earthMover(a, b []int) []int {
  r := make([]int, len(a))
  for i := 0; i < len(a); i++ {
    // if diff is positive it means that there is too much dirt here and it
    // must be moved to the right.  if it is negative it means some dirt
    // needs to be pulled in from the right.  In either case dirt can be
    // moved over multiple spaces.
    diff := b[i] - a[i]
    r[i] = diff
    b[i] -= diff
    if i < len(a) - 1 {
      b[i+1] += diff
    }
  }
  return r
} 
```

这是一个例子。负数表示从右侧拉入污垢，正数表示从左侧推到右侧。我认为对于您的指标，您只需将移动数组中的所有数字相加，因此这种情况的解决方案是 5。

```
target: [ 3  0  1  0  2  6]
source: [ 1  1  5  0  1  4]
  move: [-2 -1  3  3  2  0] 
```

现在我看到了，如果这确实是您想要的，那么您实际上是在寻找分布的加权平均值或质心（污垢）的差异。例如：

```
 0  1  2  3  4  5
  target: [ 3  0  1  0  2  6]
weighted:   0 +0 +2 +0 +8+30 = 40

  source: [ 1  1  5  0  1  4]
weighted:   0 +1+10 +0 +4+20 = 35 
```

如您所见，目标的质心减去源的质心就是我们之前得到的数字，40 - 35 = 5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:21:00.660

你的“距离”是平均值（f） - 平均值（g）。为了最小化地球移动的总量，而不考虑它移动了多远，贪心算法实现了最优值，即分布之间的统计距离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-10T09:27:19.240

[https://github.com/wihoho/VideoRecognition](https://github.com/wihoho/VideoRecognition)

*   通过文件接口适配作者的[C实现与python模块](http://www.cs.duke.edu/~tomasi/software/emd.htm)
*   修改后的 C 代码在文件夹 EarthMoverDistance SourceCode 下

# c# - 在 Linq to SQL 中检索 ID 为动态的行

> ID：10013691
> 
> 赞同：0
> 
> 时间：2012-04-04T14:54:59.603
> 
> 标签：c#, sql, linq

我有以下代码：

```
var db = new IpsDBDataContext(connectionString);

var record = new IpsJobQueue();

var config = new IpsJobFileConfig();

record.FileName = file.Name;
record.FileNameConventionID = ....?
record.PickupDate = DateTime.Now;

// hard coded to follow suit with "unprocessed" flag in 
// IpsJobProcessCodes table.
record.ProcessStatus = 1; 
record.CreationTime = file.CreationTime;

record.StartTime = null;
record.EndTime = null;

db.IpsJobQueues.InsertOnSubmit(record);

db.SubmitChanges(); 
```

我关心的线是`record.FilenameConventionID = ...?`

在这里，我需要将PublisherName 列 =“Undetermined”的表中分配`FileNameConventionID`给一个`ID`（作为外键） 。`IpsJobFileConfig`这很容易做到，但问题是`ID`与此记录类型（未确定）相关的问题可能会随着它被提升到生产环境而改变。

所以我认为我需要做的将分两个步骤。

1.  查找其记录`PublisherName = Undetermined`
2.  获取该`ID`记录（因为它将是动态的）。

问题是：如何从我正在选择的记录的列中反射性地获取 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:00:19.590

现在您正在创建一条新`IpsJobFileConfig`记录，但没有使用它。我猜你可以完全摆脱它。

您应该能够逃脱（假设 IpsJobFileConfig 表中具有正确发布者名称的任何记录都可以使用，因为可能有多行）：

```
var config = db.IpsJobFileConfigs.First(c => c.PublisherName == "Undetermined");
record.FileNameConventionID = config.Id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T18:38:51.913

您有一个 JobQueue 实例和一个相关的先前存在的 JobFileConfig 实例。

您应该从数据库中加载 JobFileConfig，如下所示：

```
JobFileConfig config = db.JobFileConfig.Where(c => c.PublisherName == "Undetermined").FirstOrDefault(); 
```

然后你应该像这样将新实例附加到对象图中：

```
config.JobQueues.Add(myJobQueue); 
```

不要分配ID。不要`InsertOnSubmit`新的 JobQueue 实例。它连接到对象图，当您调用时，DataContext 将管理其余部分`SubmitChanges()`。它会将新实例保存到数据库中，并将任何 ID 填充回您的实例中。

* * *

PS： DataContext 实现了`IDispoable`，所以你应该`using`这样做。

```
using(IpsDBDataContext db = new IpsDBDataContext(connectionString))
{
  ...
} 
```

# c# - ExcelLibrary 和 EPPlus 在打开网络文件时抛出异常

> ID：10013692
> 
> 赞同：0
> 
> 时间：2012-04-04T14:54:59.820
> 
> 标签：c#, excel

我在服务器上有一个excel文件。我使用如下所示的路径访问它：“\\Server\folder\file.xlsx”。

我可以使用 Office 的 Excel API 读取它，但由于我无法在我的服务器上安装 Office，我需要避免这种依赖。

我尝试使用其他一些库，但它不起作用......

我尝试使用 EPPLUS 打开文件，但是当我尝试打开工作簿时出现异常提示“相对 URI 不支持此操作”...我尝试使用 ExcelLibrary，但出现内存不足异常... .

```
//EXCELLIBRARY
Workbook book = Workbook.Load(_filename);

//EPPLUS
FileInfo file = new FileInfo(_filename);
ExcelPackage pack = new ExcelPackage(file);
ExcelWorksheet sheet = pack.Workbook.Worksheets[1]; 
```

有人知道如何解决这个问题吗？

如果没有，您还有其他图书馆可以推荐吗？我不想使用 OleDB 并且已经尝试过 NOPI。我想要一个只需要添加对 dll 的引用的库。我需要打开 excel 2010 文件。我还需要能够确定工作表中使用的范围并获取包含值的数组。这是我使用并使用 office API 的代码。

```
Excel.Application xlApp;
Excel.Workbook xlWorkBook;
Excel.Worksheet xlWorkSheet;
object misValue = System.Reflection.Missing.Value;

xlApp = new Excel.ApplicationClass();
xlWorkBook = xlApp.Workbooks.Open(_filename, 0, true, 5, "", "", true, Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);

 _range = (System.Array)xlWorkSheet.UsedRange.Value2;
 _headers = GetHeaders(_range);

 _lastRow = xlWorkSheet.Cells.Find("*", misValue, misValue, misValue, Excel.XlSearchOrder.xlByRows,
 Excel.XlSearchDirection.xlPrevious, false, misValue, misValue).Row;

 xlWorkBook.Close(false, misValue, misValue);
 xlApp.Quit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T13:04:06.843

经过一整天的搜索和尝试许多库，我终于找到了一些有用的东西，Koogra。

[http://sourceforge.net/projects/koogra/?_test=b](http://sourceforge.net/projects/koogra/?_test=b)

```
Workbook wb = new Workbook(_filename);
_worksheet = wb.GetWorksheet(0);

//You can do the same to find LastCol, LastRow or FirstCol
uint firstRow = _worksheet.CellMap.FirstRow
string aHeader = (string)_worksheet.GetRow(firstRow).GetCell(3); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:24:41.383

这不是网络路径的样子。它应该是这样的

```
\\server\path\to\file\image.jpg 
```

注意开头的双斜线。只有一个斜杠，它就变成了相对于当前驱动器的路径（这是错误告诉你的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T13:38:53.883

在我看来， FileInfo 构造函数正在抛出该异常，您确定 EEPlus 正在抛出它吗？因为在 NT 系列 FileInfo 构造函数正在调用 Path.NormalizeSlow 并且该方法正在抛出异常：

```
throw new ArgumentException(Environment.GetResourceString("Argument_PathUriFormatNotSupported")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-01T09:00:25.390

尝试使用新的 Epplus 库 4.1

此版本修复了大部分错误

# ms-access - 可以在表单加载之前在 vba 中设置绑定查询的参数吗？

> ID：10013694
> 
> 赞同：3
> 
> 时间：2012-04-04T14:55:04.400
> 
> 标签：ms-access

我有一个绑定表格。表单的数据源是带有参数的查询。是否可以在表单加载之前在 vba 中设置参数？参数的弹出窗口甚至在 form_open 事件之前弹出：/

我知道替代方案.. 使用参数构建我自己的查询字符串，或操作 querydefs 的 sql。但我不喜欢他们。

目前我在设计时使用未绑定的表单，并在运行时将它们绑定到参数查询。但是在设计时有未绑定的表单并不是那么方便。

任何人的想法？

问候

江木

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:40:10.237

你说：

> 目前我在设计时使用未绑定的表单，并在运行时将它们绑定到参数查询。**但是在设计时有未绑定的表单并不是那么方便。**

一种替代方法是使用“虚拟”RecordSource，以便您在设计时拥有一个绑定表单，但仍然在运行时使用您的参数查询更新 RecordSource。

一个虚拟查询的例子是这样的：

```
SELECT 1 AS EmployeeID, 'John' AS FirstName, 'Doe' AS LastName, #1/1/1980# AS DoB 
```

`EmployeeID`这将使用字段、`FirstName`、`LastName`、填充字段列表框`DoB`。显然，您希望您的虚拟查询字段名称反映运行时的字段名称。

这也将避免在加载时显示参数弹出窗口的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T09:13:34.017

实际上，这里的基本解决方案是简单地删除参数而不更改使用的 SQL。访问表单有一个 where 子句。它们旨在解决这个问题。这意味着您不需要带参数的查询，也不必修改表单或报告 sql。

您只需在打开表单时传递 where 子句。

因此，不需要构建查询字符串的替代方案，也不需要操作 querydef 的 sql 的替代方案。并且也不需要修改表单数据源的替代方案。

并且从查询中删除参数后，您可以在表单、报告、导出例程和各种用途中自由使用查询。

# wcf - WCF - 检查 MTOM 编码的消息 BeforeSendRequest

> ID：10013695
> 
> 赞同：0
> 
> 时间：2012-04-04T14:55:05.280
> 
> 标签：wcf, wcf-client, mtom

我正在与使用 Mtom 作为消息编码的第三方 WCF 服务集成。我创建了一个消息检查器行为，我可以通过调用来查看消息请求“字符串” `request.ToString()`，但是，该消息似乎从未被 mtom 编码，并且不包含任何 MIME 部分。我假设 Mtom 编码稍后发生在通道管道中。我的问题是，有没有办法查看实际的传出消息而不管编码如何，因为它将通过线路发送到 WCF 服务？

以下是我正在使用的消息检查器：

```
public class InspectorBehaviorExtensionElement : BehaviorExtensionElement
{
    public InspectorBehaviorExtensionElement()
    {

    }

    public override Type BehaviorType
    {
        get
        {
            return typeof(InspectorBehavior);
        }
    }

    protected override object CreateBehavior()
    {
        return new InspectorBehavior();
    }

}

public class InspectorBehavior : IEndpointBehavior
{
    public void AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
    {
        clientRuntime.MessageInspectors.Add(new MessageInspector());
    }

    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
    {
    }

    public void Validate(ServiceEndpoint endpoint)
    {
    }
}

public class MessageInspector : IClientMessageInspector
{
    public MessageInspector()
    {

    }
    public void AfterReceiveReply(ref Message reply, object correlationState)
    {
        Debug.WriteLine("Received the following reply: '{0}'", reply);
    }

    public object BeforeSendRequest(ref Message request, IClientChannel channel)
    {
        Debug.WriteLine("Sending the following request: '{0}'", request);

        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:03:54.780

AFAIK 消息编码在`BeforeSendRequest`. 您可以使用 WCF 消息日志记录或提琴手来查看消息。

# c# - 模型验证 - 检查发布的值是否小于原始值

> ID：10013699
> 
> 赞同：0
> 
> 时间：2012-04-04T14:55:21.703
> 
> 标签：c#, asp.net-mvc-3

我有一个包含表单的 ViewModel：

```
@using(Html.BeginForm())
{
     @Html.EditorFor(x=>x.Price)
     <input type="submit" value="Submit" />
} 
```

在加载此视图的控制器操作中，我设置了价格并将其传递给视图。例如，我将其设置为 3：

```
public ActionResult MyAction()
{
     MyModel model = new MyModel();
     model.Price = 3;
     return View(model);
} 
```

我想要做的是，当提交此表单时，我想检查用户提交的值是否小于原始值，在这种情况下为 3。模型验证可以吗？因此，如果我输入 2，那么 ModelState 将是无效的，但如果我输入 4，它将是有效的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:02:00.430

我认为 RemoteAttribute 适合这个：

在价格字段顶部：

```
[RemoteAttribute("CheckPrice", "MyController", AdditionalFields="MyModelId")] 
```

在控制器 MyController 中：

```
public ActionResult CheckPrice(decimal price, int myModelId){
   //get model by id
   //return valid or invalid
   return Json(true, JsonRequestBehavior.AllowGet);
} 
```

*编辑服务器端：

制作一个继承 RemoteAttribute 的自定义属性并将相同的逻辑放在 IsValid 方法中：

```
public class MyRemoteAttribute : RemoteAttribute
{
     public MyRemoteAttribute() : base("CheckPrice","Kenmerk"){
         base.HttpMethod = "Post";
     }

     public override bool IsValid(object value){
           //recreate validation here
           //additionalfields can be found in HttpContext.Current.Request.Params
           return true;
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:03:28.757

为什么每次都需要向服务器发布一个值...在客户端检查它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:41:21.500

您想要做的是将原始值包含在隐藏字段中，例如 Price_orig，然后您可以做很多事情中的任何事情。如果您不关心客户端验证，您可以在模型上实现 IValidatableObject。如果您想要客户端验证，那么您可以实现一个自定义属性来检查另一个属性的值，类似于此处描述的属性：

[在 EF 伙伴类上使用自定义属性 (AttributeTargets.Class) 进行数据验证](https://stackoverflow.com/questions/4621210/data-validation-with-custom-attributes-attributetargets-class-on-ef-buddy-clas)

另一种选择是使用[FluentValidation](http://fluentvalidation.codeplex.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T09:22:13.167

只是为了让你知道，我在我的模型上创建了一个新的属性来保存原始值，然后在我的模型上实现 IValidatableObject 的 Validate 方法中，我检查了新值是否小于原始值价值。这解决了我的问题

# html - 最小宽度表

> ID：10013702
> 
> 赞同：1
> 
> 时间：2012-04-04T14:55:23.457
> 
> 标签：html, css, asp.net, html-table, width

我正在尝试创建一个最小宽度为 500 像素的表格，其中一个单元格包含一个最小宽度为 300 像素的文本区域。表格的最小宽度似乎根本不起作用。我正在使用 CSS 来设置表格和文本区域的样式。这是一个已知的问题？我已经发布了下面的代码。

必须在 IE7 中正确显示

ASPX 页面

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html>
    <head>
        <link rel="Stylesheet" href="./CSS/SpecialOps.css" />
        <link rel="Stylesheet" href="./CSS/myadditions.css" />
        <title>PFS Special OPS - My Additions</title>
    </head>
    <body>
        <!-- #include file="./SSI/header.aspx -->
        <div id="spacer">
            <div id="logospacer">

            </div>
            <div class="tabspacer">

            </div>
            <div class="tabspacer highlightspacer">

            </div>
            <div class="tabspacer">

            </div>
        </div>
        <div id="content">
            <div id="contentinner">
                <div class="divtitle">
                    Add News Excerpt
                </div>
                <div id="addnews">
                    <table id="addnewstbl">
                        <tr>
                            <td>
                                Title:
                            </td>
                            <td>
                                <input type="text" class="addnewsform"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Excerpt:
                            </td>
                            <td>
                                <textarea class="addnewsform"></textarea>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Your Name:
                            </td>
                            <td>
                                Steven Norris
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </body>
    </html> 
```

CSS

```
/*
* Stylesheet for my additions page of Special OPS
* Created by Steven T. Norris on 4/4/2012
* Last Update:          Update By:
*/
#addnews
{
    border-style:solid;
    border-width:1px;
    border-color:Black;
    padding:3px;
}
#addnews
{

}
#addnewstbl
{
    min-width:500px;
    border-style:solid;
    border-width:1px;
    border-color:Black;
}
.addnewsform
{
    min-width:300px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:03:51.970

这是我会做的。将以下内容添加到

```
#addnewstbl
{
    width: 100%
    border-style:solid;
    border-width:1px;
    border-color:Black;
}

#addnews
{
    border-style:solid;
    border-width:1px;
    border-color:Black;
    padding:3px;
    float: left;
    min-width: 500px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T12:16:36.830

我找到了一种可以达到预期效果的解决方法。不是特别相同的方法，但至少是相同的最终产品。代码中有一些你不需要担心的额外位，但基本上将你的容器设置为 100%，并且你的表单元素设置为 100 的一小部分，并且应该实现效果。在这种情况下，我使用了 98%，只是为了在右边缘提供一点缓冲。这并不理想，但它有效，而且这种方法的错误几乎不明显。

ASPX 页面

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <link rel="Stylesheet" href="./CSS/SpecialOps.css" />
    <link rel="Stylesheet" href="./CSS/myadditions.css" />
    <title>PFS Special OPS - My Additions</title>
</head>
<body>
    <!-- #include file="./SSI/header.aspx -->
    <div id="spacer">
        <div id="logospacer">

        </div>
        <div class="tabspacer">

        </div>
        <div class="tabspacer highlightspacer">

        </div>
        <div class="tabspacer">

        </div>
    </div>
    <div id="content">
        <div id="contentinner">
            <div class="divtitle">
                Add News Excerpt
            </div>
            <div id="addnews">
                <table id="addnewstbl">
                    <tr>
                        <td class="addnewstitlecell">
                            Title:
                        </td>
                        <td>
                            <input type="text" class="addnewsform"/>
                        </td>
                    </tr>
                    <tr>
                        <td class="addnewstitlecell">
                            Excerpt:
                        </td>
                        <td>
                            <textarea rows="10" class="addnewsform"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td class="addnestitlecell">
                            Catagory:
                        </td>
                        <td>
                            <select>
                                <option value="AVP/VP">AVP/VP</option>
                                <option value="Commercial">Commercial</option>
                                <option value="Compliance">Compliance</option>
                                <option value="Correspondence">Correspondence</option>
                                <option value="Customer Service">Customer Service</option>
                                <option value="ERAC">ERAC</option>
                                <option value="Government Payer">Government Payer</option>
                                <option value="PFS">PFS</option>
                                <option value="Regulatory">Regulatory</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="addnewstitlecell">
                            Submitted By:
                        </td>
                        <td>
                            Steven Norris
                        </td>
                    </tr>
                </table>
            </div>
            <div class="divtitle">
                Previously Added
            </div>
            <div id="prevadded">
                <div class="prevaddedtop">
                    <div class="prevaddedtitle">
                        News Excerpt Title
                    </div>
                    <div class="prevaddedcontent">
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    </div>
                    <div class="prevaddeduser">
                        -Steven Norris
                    </div>
                    <div class="prevaddedbuttons">
                        <input class="button" type="submit" value="Edit" />
                        <input class="button" type="submit" value="Delete" />
                    </div>
                </div>
                <div class="prevaddedtop">
                    <div class="prevaddedtitle">
                        News Excerpt Title
                    </div>
                    <div class="prevaddedcontent">
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.Blah blah blah blah blah blah blah.
                    </div>
                    <div class="prevaddeduser">
                        -Steven Norris
                    </div>
                    <div class="prevaddedbuttons">
                        <input class="button" type="submit" value="Edit" />
                        <input class="button" type="submit" value="Delete" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 
```

CSS

```
/**
* Overall stylesheet for PFS Special OPS
* Created By Steven T. Norris on 4/3/2012
* Last Updated:         Last Updated By:
*/

/*
* Overall Navigation
* #navigation min-width mirrors .tab widths + #logoimg width + 200px allowance for #welcome width
* #navigation height mirrors #logoimg height
*/
#navigation
{
    min-width:677px;
    vertical-align:bottom;
    border-bottom-style:solid;
    border-bottom-width:2px;
    border-bottom-color:Black;
    height:100px;
}

/* 
* TopTabs
* .tab height and width mirrors image height and width for ./Images/blueTab.png
* .tabspacer width, margin-right, and padding mirrors .tab
* .tabspacer bottom mirrored in #content
* .tab top mirrors #logoimg height - .tab height - .tab padding-top - .tab padding-bottom
*/
.tab
{
    float:left;
    height:20px;
    width:100px;
    margin-right:5px;
    padding:2px;
    position:relative;
    top:76px;
    left:20px;
    font-size:large;
    background-image:url('../Images/blueTab.png');
    text-align:center;
}
.tablink
{
    color:Black;
    text-decoration:none;
}
.tablink:hover
{
    cursor:pointer;
    color:white;
}
.tabspacer
{
    height:2px;
    width:100px;
    float:left;
    margin-right:5px;
    padding:2px;
    left:20px;
    bottom:2px;
    position:relative;
    z-index:-1;
    background-color:#0383de;
    border-bottom-width:1px;
    border-bottom-style:solid;
    border-bottom-color:black;
}

/*
* Logo
* #logospacer width mirrors #logoimg width
*/
#logo
{
    float:left;
}
#logoimg
{
    width:130px;
    height:100px;
}
#logospacer
{
    width:130px;
    height:1px;
    float:left;
    clear:left;
}

/*
* Content
* #content min-width mirrors #navigation
* #content background-color mirrors ./Images/blueTab.png bottom color
*/
#content
{
    height:100%;
    width:100%;
    background-color:#0386e1;
    position:relative;
    bottom:2px;
    min-width:677px;
}
#contentinner
{
    margin:10px;
    background-color:White;
    overflow:auto;
    border-style:solid;
    border-width:1px;
    border-color:Black;
    padding:5px;
}

/*
* Welcome
* #welcome height, padding, and top mirrors .tab
*/

#welcome
{
    float:right;
    height:20px;
    position:relative;
    padding:2px;
    top:76px;
    font-weight:bold;
}

/*
* Spacers
* #spacer min-width mirrors #navigation
* #highlightspacer background-color mirrors ./Images/blueTab.png bottom color
*/
#spacer
{
    min-width:677px;
}
.highlightspacer
{
    background-color:#0383de;
    border-bottom-color:#0383de;
    z-index:1;
}

    /*
    * Titles placed directly above a bordered div
    */
    .divtitle
    {
        position:relative;
        top:4px;
        font-weight:bold;
    }

    /*
    * Buttons
    */
    .button
    {
        background:url('../Images/blueButton.png');
        border-style:none;
        width:100px;
        height:20px;
    }
    .button:hover
    {
        cursor:pointer;
    }
/*
* Stylesheet for my additions page of Special OPS
* Created by Steven T. Norris on 4/4/2012
* Last Update:          Update By:
*/
#addnews
{
    border-style:solid;
    border-width:1px;
    border-color:Black;
    padding:3px;
}
#addnewstbl
{
    width:100%;
}
.addnewsform
{
    width:98%;
}
.addnewstitlecell
{
    width:100px;
    vertical-align:top;
}
#prevadded
{
    border-style:solid;
    border-width:1px;
    border-color:Black;
    padding:3px;
}
.prevaddeduser
{
    text-align:right;
}
.prevaddedbuttons
{
    text-align:right;
}
.prevaddedtitle
{
    font-weight:bold;
}
.prevaddedtop
{
    border-bottom-width:1px;
    border-bottom-style:solid;
    border-bottom-color:Black;
    padding-bottom:3px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:49:14.510

根据[这个站点](http://reference.sitepoint.com/css/min-width#compatibilitysection)，最小宽度在 IE7 中是错误的。我推荐一种不使用它的不同方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:51:08.893

这是 Internet Explorer 中的可比性视图问题。

如果您在网上搜索，有几种不同的方法可以解决此问题，但简而言之，您需要在 IE 中禁用此模式才能使 min-width 正常工作。

# android - 如何在单击另一个对话框的按钮时显示一个对话框？

> ID：10013703
> 
> 赞同：1
> 
> 时间：2012-04-04T14:55:25.363
> 
> 标签：android

我正在做我的android项目。我创建了带有“是”和“否”按钮的对话框。如果我单击“是”，则应显示一个新对话框，其中包含可供选择的选项。我创建了带有选项的对话框。但是当我在我首先创建的对话框中单击“是”时无法显示它。我该怎么做？请帮忙。谢谢。

这是我创建的对话框的代码。当我在此对话框中单击“是”按钮时，我应该显示另一个对话框

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setMessage("Low Memory\nYou want to send the file to server?")
               .setCancelable(false)
               .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {

                   }
               })
               .setNegativeButton("No", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {
                        dialog.cancel();
                        finish();
                   }
               });
AlertDialog alert = builder.create();
alert.show(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:14:10.643

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("Low Memory\nYou want to send the file to server?")
            .setCancelable(false)
            .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {

                    AlertDialog.Builder builder2 = new AlertDialog.Builder(CLASSNAME.this);
                    builder2.setTitle("hi!");
                    //etc
                    builder2.show();

                }
            })
            .setNegativeButton("No", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                     dialog.cancel();
                     finish();
                }
            });
     AlertDialog alert = builder.create();
     alert.show(); 
```

希望这可以帮助。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:16:42.833

试试这个代码：

```
 AlertDialog.Builder builder1 = new AlertDialog.Builder(this);
        builder1.setMessage("Are you absolutely positively sure?")
               .setCancelable(false)
               .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {

                   }
               })
               .setNegativeButton("No", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {
                        dialog.cancel();
                        finish();
                   }
               });
        final AlertDialog alert1 = builder1.create();

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setMessage("Low Memory\nYou want to send the file to server?")
               .setCancelable(false)
               .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {
                       alert1.show();
                   }
               })
               .setNegativeButton("No", new DialogInterface.OnClickListener() {
                   public void onClick(DialogInterface dialog, int id) {
                        dialog.cancel();
                        finish();
                   }
               });
        AlertDialog alert = builder.create();
        alert.show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:35:55.213

看看这个

```
AlertDialog alertDialog1,alertDialog2;

     public  void  showAlertDialog1(String title,String message,final Context context)
            {
             alertDialog1 = new AlertDialog.Builder(context).create();
             alertDialog1.setTitle(title);
             alertDialog1.setMessage(message);
             alertDialog1.setButton("OK", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {

                  errorAlertDialog2("second AlertDialog","second AlertDialog",context)

                }
             });
             alertDialog1.show();
            }

         public  void  showAlertDialog2(String title,String message,Context context)
            {
             alertDialog2 = new AlertDialog.Builder(context).create();
             alertDialog2.setTitle(title);
             alertDialog2.setMessage(message);
             alertDialog2.setButton("OK", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {

                  alertDialog2.dismiss();
                }
             });
             alertDialog2.show();
            } 
```

# javascript - 多个元素上的 jQuery 动画/slideUp/slideDown

> ID：10013707
> 
> 赞同：0
> 
> 时间：2012-04-04T14:55:50.680
> 
> 标签：javascript, jquery, jquery-animate

所以我一直在做一些搜索，我会继续寻找，但我认为是时候向 SO 社区提出我的问题了。

我正在做一个涉及高度可变的固定标题的小项目。基本结构是这样的：

```
<header>
  //any amount of elements
  //meaning this will have varying heights
  //I'll also be able to "open" and "close" this header
  //using slideUp and slideDown (because the end height varies I don't want to use animate)
</header>
<section>
  //body content
</section> 
```

作为一个普通的标题（即非 css '定位'ed），这很好。它会在 html 流的正常上下文中，并且会与它下面的内容交互。当标题向下滑动时，它下面的部分也会向下滑动，当它向上滑动时，当然会发生相反的情况。它的工作原理类似于[http://jsfiddle.net/byazaki/7FcJF/](http://jsfiddle.net/byazaki/7FcJF/)

现在，如果标题上的位置是固定的，它下面的部分将不会受到它上下移动的影响，因此引入了一个“标题间隔”元素来代替它。

```
<header>
  //any amount of elements
</header>
<header spacer>
  //in theory this would resize with the 
  //header as it slides up and down to mimic
  //its effect on the other elements in the flow.
</header spacer>
<section>
  //body content
</section> 
```

这听起来很简单吧？好吧，通常是的，如果我知道我的标头在打开时会有多大，而在它关闭时会有多小。为简单起见，我们只说它关闭时为 0，所以现在我只需要担心它何时打开。

很抱歉介绍很长，但这让我回到了最初的观点：如果我不知道我的标题的目标“高度”，我如何为我的间隔设置动画？做 .slideDown 不起作用。

我想到的一个解决方案是做这样的事情：

```
function setSpacer() = { spacer.css('height', header.height())};
var interval = setInterval(setSpacer, 10);
header.slideDown(500, function(){
  clearInterval(interval);
}); 
```

抱歉，如果有语法错误或类似的东西只是试图绘制图片......基本上我开始每 10 毫秒将间隔高度设置为标题高度，然后当标题完成动画时它会清除间隔。

我还没有实现这个，因为我很好奇是否有更优雅的解决方案来解决我的问题，或者甚至可以使用我不知道的 jQuery 动画分支来做些什么？

注意：另一个想法是编写一个插件，扩展 slideUp()/slideDown()/animate() 类以获取包含 1 个或多个 html 元素的参数并镜像目标对象的动画。

非常欢迎任何想法或反馈，谢谢：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:36:21.937

有点不清楚你想要什么。

`.slideDown()`/`.slideUp()`用于显示和隐藏内容，中间没有高度设置。如果你想决定自己的身高，我建议你`.animate()`改用。

**这就是我解释这个问题的方式**

我给了主标题 a`position: fixed`并制作了另一个`<header id="spacer"></header>`. 一开始，我注册了主标题的默认高度，并将相同的高度赋予垫片。然后我临时添加一个 class `full_height`，它基本上只是 a`height: auto`并在它有那个类时注册高度。从那时起，事情应该很简单。要么在两个元素上使用 slideDown 或 slideUp，要么在两个元素上使用 .animate() 来弄乱默认/全高。

话虽如此，这里是使用 slideDown/slideUp 和 .animate 的两个示例

**`.slideDown()`/`.slideUp()`**

[示例](http://jsfiddle.net/7FcJF/1/)| 代码

```
//The full_height class is just a "height: auto"
var defaultHeight = $("#header").outerHeight(),
    entireHeight = $("#header").addClass("full_height").outerHeight();

$("#header").removeClass("full_height");
$("#spacer").height(defaultHeight);

$('#button').click(function() {
    if ($('#header').hasClass('hidden')){
      $('#header, #spacer').slideDown().removeClass('hidden');
    } else {
      $('#header, #spacer').slideUp().addClass('hidden');
    }
}); 
```

**`.animate()`**

[示例](http://jsfiddle.net/7FcJF/2/)| 代码

```
//The full_height class is just a "height: auto"
var defaultHeight = $("#header").outerHeight(),
    entireHeight = $("#header").addClass("full_height").outerHeight();

$("#header").removeClass("full_height");
$("#spacer").height(defaultHeight);

$('#button').click(function() {
    if ($('#header').hasClass('hidden')){
        $('#header, #spacer').animate({
            height: defaultHeight //either use default height or entire height
        }, 500).removeClass('hidden').show();
    } else {
        $('#header, #spacer').animate({
            height: 0, //either use default height or 0
        }, 500, function(){
            $(this).hide(); //hide if you're going to use 0
        }).addClass('hidden');
    }
}); 
```

# google-maps - How to get city from lat/lng with Google Maps V3?

> ID：10013709
> 
> 赞同：1
> 
> 时间：2012-04-04T14:55:54.603
> 
> 标签：google-maps, google-maps-api-3, geolocation

This is [what](http://jsfiddle.net/tLNya/3/) I've done :

```
var geocoder = new google.maps.Geocoder();
var location = new google.maps.LatLng(45.930976,10.639744);

geocoder.geocode({ 'latLng': location  }, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
        alert(results[1].address_components[0].long_name);
    }
}); 
```

but I'd like to prefeer not using address_components[i] which parameter, due to the fact it could be different for each request. How is the parameter to get the city? (or location, or country, and so on...).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T17:34:48.833

Not sure if I'm reading the API right ([Geocoding API doc)](https://developers.google.com/maps/documentation/geocoding/#Types), but it looks like it might be 'types:locality'

# java - Java 对象模型。它是什么？

> ID：10013712
> 
> 赞同：-1
> 
> 时间：2012-04-04T14:56:01.103
> 
> 标签：java, xml

简单地说：什么是Java对象模型。我想为 XML 文件创建一个。我确信它与 Java 应用程序不同。那是什么。显然，我尝试了谷歌，但令我惊讶的是没有得到任何具体或明确的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:03:07.293

我猜对象模型是一些 java POJO，其属性反映了您正在解析的 xml 文件的结构。

实现这种转换的“简单”方法是使用[JAXB](http://jaxb.java.net/tutorial/section_1_1-Introduction.html#About%20JAXB)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:10:26.117

任何模型本质上都是您表示数据的方式。因此，您的 Java 对象模型是您的数据，表示为 Java 对象。XML 模型将您的数据表示为 XML。JSON 是表示为 JavaScript“对象”等的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:45:58.143

对象模型是一组用于表示特定信息集合的类（及其属性和方法）。Java 对象模型只是一个对象模型，其中用于描述这些类的语言是 Java。如果要为 XML 文件创建 Java 对象模型，则需要分析 XML 文件中包含哪些信息并设计 Java 类来表示相同的信息。有一些工具可以自动化这个过程，尽管他们提出的表示并不总是最优的。

# java - 读取和解析 Java 异常

> ID：10013713
> 
> 赞同：10
> 
> 时间：2012-04-04T14:56:10.760
> 
> 标签：java, regex, parsing, exception

我有一个小系统，我想提供一个可以分析错误/异常并提出可能解决方案的产品。

所以我想要一种解析java异常的方法（因为我只在日志中拥有它们[我不想影响实际系统]）。

解析后，我想将其保存在数据库中，并将其与之前保存的异常（以某种格式）进行比较，以便找到最接近的匹配异常。

我想到了以下想法：“XException at A at B at C at D”将保存为 [XException, A, B, C, D] 并且我将以某种方式在我的数据库中搜索： [XException, ?, ?, ?] 哪个是最接近的。例如：[XException, A, G, C, D] 相当不错。

您如何看待这些想法？

解析异常的任何有效方法？

定义两个异常之间距离的有效或更好的方法？

知道任何可以做到这一点的开源 - 我还没有找到任何。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T15:46:51.390

这是一项相当艰巨的工作，但这里是解析一些动态生成的现实异常的演示。

*   该方法称为 generate_$ 以尝试覆盖奇怪命名的方法。我确定我没有涵盖所有情况。
*   将它们重新构建为 java.lang.StackTraceElement 列表，因为它似乎是适合该工作的类型。

代码：

```
private static List<String> generate_$() {
    List<String> returnValue = new LinkedList<String>();
    Exception[] exceptions = { new ClassCastException(),
            new NullPointerException(), new IOException("foo") };
    for (Exception exception : exceptions) {
        try {
            throw exception;
        } catch (Exception e) {
            StringWriter writer = new StringWriter();
            e.printStackTrace(new PrintWriter(writer));
            returnValue.add(writer.getBuffer().toString());
        }
    }
    return returnValue;
}

public static void main(String[] args) {
    List<String> examples = generate_$();
    for (String trace : examples) {
        Pattern headLinePattern = Pattern.compile("([\\w\\.]+)(:.*)?");
        Matcher headLineMatcher = headLinePattern.matcher(trace);
        if (headLineMatcher.find()) {
            System.out.println("Headline: " + headLineMatcher.group(1));
            if (headLineMatcher.group(2) != null) {
                System.out.println("Optional message "
                        + headLineMatcher.group(2));
            }
        }
        // "at package.class.method(source.java:123)"
        Pattern tracePattern = Pattern
                .compile("\\s*at\\s+([\\w\\.$_]+)\\.([\\w$_]+)(\\(.*java)?:(\\d+)\\)(\\n|\\r\\n)");
        Matcher traceMatcher = tracePattern.matcher(trace);
        List<StackTraceElement> stackTrace = new ArrayList<StackTraceElement>();
        while (traceMatcher.find()) {
            String className = traceMatcher.group(1);
            String methodName = traceMatcher.group(2);
            String sourceFile = traceMatcher.group(3);
            int lineNum = Integer.parseInt(traceMatcher.group(4));
            stackTrace.add(new StackTraceElement(className, methodName,
                    sourceFile, lineNum));
        }
        System.out.println("Stack: " + stackTrace);

    }
} 
```

输出：

```
Headline: java.lang.ClassCastException
Stack: [com.adamish.ExceptionParse.generate_$((ExceptionParse.java:16), com.adamish.ExceptionParse.main((ExceptionParse.java:31)]

Headline: java.lang.NullPointerException
Stack: [com.adamish.ExceptionParse.generate_$((ExceptionParse.java:17), com.adamish.ExceptionParse.main((ExceptionParse.java:31)]

Headline: java.io.IOException
Optional message : foo
Stack: [com.adamish.ExceptionParse.generate_$((ExceptionParse.java:17), com.adamish.ExceptionParse.main((ExceptionParse.java:31)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:02:25.777

我想这个问题会因为过于开放而被关闭。SO 适用于可以给出明确和明确答案的问题。

即便如此，在此之前，我想说这似乎是一个不错的主意，我希望你能做到。最好关注堆栈跟踪中清楚识别不可变信息的那些部分，例如包、类和方法名称。至于检测部分或完全匹配，我建议您查看已知的索引和匹配算法。可以应用一些著名的文本搜索算法，但“原子”单元是方法名称或包限定的类名称，而不是单个字母或单词。

祝你好运！

编辑：只是想到了别的东西。您可能希望专注于使您的实现尽可能通用，以适应许多不同编程语言、框架等的堆栈跟踪。这将使软件更具前瞻性和广泛适用性。

# c# - 创建 URL 枚举 - 错误：需要标识符

> ID：10013715
> 
> 赞同：2
> 
> 时间：2012-04-04T14:56:13.660
> 
> 标签：c#, asp.net, enums

对这个简单的问题感到羞耻。出于某种原因，我想将所有 asp.net URL 放在一个枚举中。但我得到一个错误：`identifer expected`

我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Admin.Code
{
    public enum url
    {
       /_layouts/Admin/test1.aspx,
       /_layouts/Admin/test2.aspx,
       /_layouts/Admin/test3.aspx
    }

    class AdminUrlSettings
    {
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:20:43.057

这是我多次将枚举值转换为“友好字符串”的方法。您还可以使用它来创建“字符串值”枚举。它与 Msonic 的解决方案相同，但该属性内置于框架中。

```
public enum url
{
   [Description(@"/_layouts/Admin/test1.aspx")] Test1,
   [Description(@"/_layouts/Admin/test2.aspx")] Test2,
   [Description(@"/_layouts/Admin/test2.aspx")] Test3
}

...

public static string GetDescription(this Enum enumValue)
{
    object[] attr = enumValue.GetType().GetField(enumValue.ToString())
            .GetCustomAttributes(typeof (DescriptionAttribute), false);
        if (attr.Length > 0)
            return ((DescriptionAttribute) attr[0]).Description;

        return enumValue.ToString();
}

//usage
Response.Redirect(url.Test1.GetDescription()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:00:24.610

这些不是有效的枚举标识符。您将需要字符串枚举。这是一个[例子](http://www.codeproject.com/Articles/11130/String-Enumerations-in-C)

您将能够执行以下操作：

```
public enum url
{
    [StringValue("/_layouts/Admin/test1.aspx")]
    Test1,
    [StringValue("/_layouts/Admin/test2.aspx")]
    Test2,
    [StringValue("/_layouts/Admin/test3.aspx")]
    Test3
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:09:19.147

C# 中的标识符不能包含`/`字符。它们仅限于下划线、字母和数字（可能还有`@`前缀）。要解决此问题，您需要使枚举值有效的 C# 标识符

```
enum url {
  test1,
  test2,
  test3
} 
```

稍后将这些转换为实际有效的 url 可以通过在值上的 switch 语句来完成

```
public static string GetRelativeUrl(url u) {
  switch (u) {
    case url.test1:
      return "/_layouts/Admin/test1.aspx";
    case url.test2:
      return "/_layouts/Admin/test2.aspx";
    case url.test3:
      return "/_layouts/Admin/test3.aspx";
    default: 
      // Handle bad URL, possibly throw
      throw new Exception();
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:01:29.697

枚举实际上并不是这样工作的。有效标识符的工作方式与变量名相同（即字母、数字和不以数字开头的下划线的组合）。为什么不只使用列表：

```
List<string> urls = new List<string>{"/_layouts/Admin/test1.aspx", "/_layouts/Admin/test2.aspx", "/_layouts/Admin/test3.aspx"} 
```

或使用稍有不同的标识符：

```
public enum url
{
     layout_Admin_test1,
     layout_Admin_test2,
     layout_Admin_test3
} 
```

# solr - Solr 查询：停用词、OR 和 AND 怪异

> ID：10013721
> 
> 赞同：6
> 
> 时间：2012-04-04T14:56:38.433
> 
> 标签：solr, lucene

我们使用具有以下字段声明的模式的 Solr 3.5：

```
<fieldType name="fieldN" class="solr.TextField" positionIncrementGap="100">
  <analyzer type="index">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.WordDelimiterFilterFactory"
            generateWordParts="0" generateNumberParts="0" catenateWords="0" catenateNumbers="0" 
            catenateAll="0" splitOnCaseChange="1" splitOnNumerics="0" preserveOriginal="1"/>
    <filter class="solr.LengthFilterFactory" min="2" max="256"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.StopFilterFactory"
            ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true"
            />
    <filter class="solr.PorterStemFilterFactory"/>
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.LengthFilterFactory" min="2" max="256"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.StopFilterFactory"
            ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true"
            />
    <filter class="solr.PorterStemFilterFactory"/>
  </analyzer>
</fieldType> 
```

当我们发送这样的查询时：

```
field1:"term1" 
```

Solr 返回结果。

当我们运行这个查询时，我们仍然得到结果：

```
field1:"term1" AND (field2:term2 OR field3:term2) 
```

而*term2*是停用词，而*term1*是常规词。

但是当我们发送这样的查询时：

```
field1:"term1" AND (field2:term2 OR field3:term2 OR field4:term2) 
```

没有任何回报。

我们还注意到，当我们执行以下操作时：

```
(field1:"term1" AND (field2:term2 OR field3:term2)) OR (field1:"term1" AND field4:term2) 
```

也可以，但是因为真正的查询应该在大约 200 个字段中搜索一个词，所以这个选项不太受欢迎。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T03:49:44.560

我猜您的“怪异”更多地与您的 solrconfig 规则有关，而不是与您的停用词查询有关。我在子查询中遇到了类似的停用词查询问题，它最终成为我的 Dismax 搜索处理程序中的最小匹配规则。

查看您的内部`solrconfig.xml`并查找`requestHandler`您的搜索正在使用的内容。您应该`"mm"`声明一个（最小匹配）字符串。无论您的目标是什么，请尝试调整您的规则，使其限制更少或更多。

祝你好运！

# css - 基于大小写敏感 url 的样式表

> ID：10013722
> 
> 赞同：0
> 
> 时间：2012-04-04T14:56:39.163
> 
> 标签：css, orchardcms

目前我没有选择，因为我不知道我为什么会有这种行为。使用 Orchard CMS 1.4 和自定义 superfish 样式表。根据访问网站的方式，行为会有所不同。我们的客户制作了一个主题，它在以下网址的一个简单网站上作为演示。

[https://assicuro.unit4demo.nl/acceptatie-1.0.1](https://assicuro.unit4demo.nl/acceptatie-1.0.1)

[如果您浏览到此网址，您会看到带有来自https://assicuro.unit4demo.nl/acceptatie-1.0.1/themes/assicuro/content/images/nav-bg.jpg](https://assicuro.unit4demo.nl/acceptatie-1.0.1/themes/assicuro/content/images/nav-bg.jpg)的图片的菜单

这是菜单未悬停时的背景。

浏览到 url 后，点击 Home 按钮，可以看到 url 变成了

[https://assicuro.unit4demo.nl/Acceptatie-1.0.1](https://assicuro.unit4demo.nl/Acceptatie-1.0.1) （注意大写A）

有没有人有一些想法是如何可能没有显示背景图像？欢迎所有提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:02:18.973

似乎背景图像被另一种 CSS 样式覆盖：

```
//This is from "/Acceptatie-1.0.1/ (Line 51)"

#menu-24.sf-menu li.selected, #menu-24.sf-menu li.current {
    background: #F1F1F1 !important;
} 
```

如果您对不同页面的布局使用 URL 替代项，这也可能基于布局文件。

*（如果我没记错的话，Orchard CMS 在处理包含某些字符（例如连字符）的 URL 时会遇到问题，这可能是另一个需要考虑的问题。）*

# java - 从 JAVA 中的 hashmap 中删除最小的 k 个元素

> ID：10013723
> 
> 赞同：0
> 
> 时间：2012-04-04T14:56:39.523
> 
> 标签：java, hashmap

我有一个对象的哈希图。每个对象都有两个属性（比如说 int length 和 int weight）。我想删除长度最小的 k 个元素。这样做的有效方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:02:50.867

```
Map<K, V> map = new HashMap<>();

...

Set<K> keys = map.keySet();
TreeSet<K> smallest = new TreeSet<>(new Comparator<K>(){
    public int compare(K o1, K o2) {
        return o1.getLength() - o2.getLength();
    }
});
smallest.addAll(keys);
for(int x = 0; x < num; x++) {
    keys.remove(smallest.pollFirst());
} 
```

`K`您的键类型在哪里，`V`您的值类型在哪里，`num`您希望删除的元素数量在哪里。

如果您经常这样做，那么[`TreeMap`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)首先使用 a 可能是个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:08:42.170

最简单但肯定不是最有效的方法是使用为您的类型提供的[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)创建[TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)的实例，将地图中的 putAll() 元素添加到刚刚创建的地图中，并在[keySet()](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#keySet%28%29)的帮助下删除 k 元素。最后，TreeMap 将不包含 k 最小元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:10:04.610

您没有提到您区分的属性是键还是值的一部分，如果它是键，那么上面讨论的树形图是适用的。

否则，如果您经常需要这样做，我倾向于实现我自己的地图，将地图界面中的所有内容委托给哈希图（或适当的结构0。覆盖添加/删除以及必要时的迭代器，然后使用添加/删除维护一个排序的值列表。

这显然假设值不会改变并且与您的问题高度相关。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-04T16:48:07.820

请记住，TreeMap 按其键的自然顺序排序。因此，您可以根据其值的长度创建具有可比较性的键。例如（因为我在吃午餐，所以代码并不完美，但应该能让你得到你需要的东西）：

```
package com.trip.test;    

import java.util.SortedMap;    
import java.util.TreeMap;    

import org.slf4j.Logger;    
import org.slf4j.LoggerFactory;    

public class ComparisonTest {    

private static Logger logger = LoggerFactory.getLogger(ComparisonTest.class);    

private static String[] a = {"1","2","3","4"};    
private static String[] b = {"A","B","D"};    
private static String[] c = {"1","B","D","1","B","D"};    
/**    
 * @param args    
 */    
static SortedMap<KeyWithLength, String[]> myMap = new TreeMap<KeyWithLength, String[]>();    

static {    

        myMap.put(new KeyWithLength("a", a.length), a);    
        myMap.put(new KeyWithLength("b", b.length), b);    
        myMap.put(new KeyWithLength("c", c.length), c);             
}    

public static void main(String[] args) {    

    // print Map    
    logger.info("Original Map:");    

    int i = 0;    
    for (String[] strArray: myMap.values() ){    
        logger.info(String.format("*** Entry %s: ", i++));    
        printStrings(strArray);    
    }    

    // chop off 2 shortest    
    chopNShortest(myMap, 2);    

    // print Map    
    logger.info("ShortenedMap:");    

    i = 0;    
    for (String[] strArray: myMap.values() ){    
        logger.info(String.format("*** Entry %s: ", i++));    
        printStrings(strArray);    
    }    

}    

static void printStrings(String[] strArray){    
    StringBuffer buf = new StringBuffer();    

    for (String str: strArray){    
        buf.append(String.format("%s, ", str));    
    }    
    logger.info(buf.toString());    
}    

static void chopNShortest(SortedMap<KeyWithLength, String[]> sortedMap, int n) {    
    // Assuming map is not unmodifiable    
    if (n <= sortedMap.size()-1){    
        for (int i = 0; i< n;i++){    
            sortedMap.remove(sortedMap.firstKey());    
        }    
    }    
}    

}    

class KeyWithLength implements Comparable<KeyWithLength> {    
private String key;    
private Integer length;    

public KeyWithLength(String key, int length) {    
    super();    
    this.key = key;    
    this.length = length;    
}    

public String getKey() {    
    return key;    
}    

public int getLength() {    
    return length;    
}    

@Override    
public int hashCode() {    
    final int prime = 31;    
    int result = 1;    
    result = prime * result + ((key == null) ? 0 : key.hashCode());    
    return result;    
}    

@Override    
public boolean equals(Object obj) {    
    if (this == obj)    
        return true;    
    if (obj == null)    
        return false;    
    if (getClass() != obj.getClass())    
        return false;    
    KeyWithLength other = (KeyWithLength) obj;    
    if (key == null) {    
        if (other.key != null)    
            return false;    
    } else if (!key.equals(other.key))    
        return false;    
    return true;    
}    

@Override    
public int compareTo(KeyWithLength another) {    
    // TODO Auto-generated method stub    
    return compare(this.length, another.length);    
}    

    public static int compare(int x, int y) {    
        return (x < y) ? -1 : ((x == y) ? 0 : 1);    
    }    

} 
```

输出：

```
Original Map:
*** Entry 0: 
A, B, D, 
*** Entry 1: 
1, 2, 3, 4, 
*** Entry 2: 
1, B, D, 1, B, D, 

ShortenedMap:
*** Entry 0: 
1, B, D, 1, B, D, 
```

# wordpress - Wordpress 上传文件夹

> ID：10013735
> 
> 赞同：0
> 
> 时间：2012-04-04T14:57:07.260
> 
> 标签：wordpress

我有一个存储在 Wordpress.com 中的博客，但我对此还不是很熟悉。我真的需要从我的电脑上传一个文件夹（里面有一些 html 和 js 文件），但是 wordpress 不允许 FTP 访问（我猜）。我该如何解决这个问题？可能吗？也许是一些管理插件..提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T14:59:56.653

Word press 确实允许 FTP 访问 我经常使用 microsoft web 表达式 4。查看此站点：[http](http://codex.wordpress.org/Using_FileZilla) ://codex.wordpress.org/Using_FileZilla或发布您的问题。谢谢

编辑**错过了您的 .com 我的错误[http://en.support.wordpress.com/ftp-access/](http://en.support.wordpress.com/ftp-access/)确认您的声明。wordpress.com 上不允许使用 HTML 和 JS，解决方法可能会让您被禁止。最好先咨询他们的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:00:03.653

您需要对运行 Wordpress 的服务器进行 FTP 访问，然后您需要像[FileZilla](http://filezilla-project.org/ "FileZilla")这样的 FTP 客户端来传输文件

# email - 如何避免谷歌邮件服务器要求我通过浏览器登录？

> ID：10013736
> 
> 赞同：44
> 
> 时间：2012-04-04T14:57:08.493
> 
> 标签：email, gmail, captcha, google-apps

我正在尝试使用由 Google Apps 配置的电子邮件从 Django 发送电子邮件，我在`settings.py`文件中的配置如下所示：

```
EMAIL_HOST = 'smtp.gmail.com'
EMAIL_HOST_USER = 'contact@mydomain.com'
EMAIL_HOST_PASSWORD = 'password'
EMAIL_PORT = 587
EMAIL_USE_TLS = True 
```

当我尝试使用以下方式发送电子邮件时：

```
from django.core.mail import send_mail

send_mail("Happy new year", "We wish you the best for 3001",
    "contact@mydomain.com", ["someuser@gmail.com"]) 
```

我收到以下错误：

```
SMTPAuthenticationError: 
(535, '5.7.1 Please log in with your web browser and then try again. 
 Learn more at
 5.7.1 https://support.google.com/mail/bin/answer.py?answer=78754 k2sm758604obl.14') 
```

由于我在没有图形用户界面的远程服务器上工作，我什至无法尝试从浏览器登录。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-10-05T10:28:24.120

只需转到 [https://accounts.google.com/DisplayUnlockCaptcha](https://accounts.google.com/DisplayUnlockCaptcha) 并单击“继续”。这将允许从其他服务器访问。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-10-20T18:47:21.433

在黄瓜/水豚/硒测试中，我已经搞砸了几个小时 - 发现了一些愚蠢的东西，可以很好地解决这个错误，保证

再熟悉不过的错误：

```
Please log in via your web browser: https://support.google.com/mail/accounts/answer/78754 (Failure) (Net::IMAP::NoResponseError) 
```

事实证明，**有两个“允许不太安全的应用程序”切换**需要更改以允许从未知设备/IMAP 登录。

**一个在这里**：[https](https://myaccount.google.com/security?pli=1#connectedapps) ://myaccount.google.com/security?pli=1#connectedapps （页面底部）

**还有一个**：[https ://www.google.com/settings/security/lesssecureapps](https://www.google.com/settings/security/lesssecureapps)

需要更改这两个 GODFORSAKEN TOGGLES 以消除此错误消息。

编辑：来自用户 Milothicus（[https://stackoverflow.com/users/3538026/milothicus](https://stackoverflow.com/users/3538026/milothicus)）：在 myaccount.google.com 中，在“登录和安全”下，选择“连接的应用程序和网站”。这也有一个“允许不太安全的应用程序”的选项。打开这个后，我的服务器现在可以向我发送一封自动电子邮件。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-03-04T13:27:56.427

当我尝试访问我的帐户时，我收到了包含此链接的这封电子邮件。 [https://www.google.com/settings/security/lesssecureapps](https://www.google.com/settings/security/lesssecureapps)

完成测试后，您可以打开然后可能关闭。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-05T18:56:07.980

我收到了来自 Google Apps 支持的以下回复：

> 您需要打开出站中继。去做这个：
> 
> 1.  在 google.com/a/yourdomain.com 上登录您的帐户
> 2.  单击设置选项卡，然后在左侧列中选择电子邮件。
> 3.  在出站中继部分中，选择在配置域外托管的“发件人”地址时允许用户通过外部 SMTP 发送邮件。
> 4.  单击保存更改。

他们还提供了一个帮助链接： http: [//support.google.com/a/bin/answer.py ?hl=en&answer=176054](http://support.google.com/a/bin/answer.py?hl=en&answer=176054)

打开出站中继并使用代理再次登录网络邮件后（感谢@DaniloBargen 和@joshcartme），问题得到解决。我已经阅读了解释出站中继是什么的链接，但我不确定我为什么需要它（我不相信我使用的是外部 SMTP 服务器）。

由于我不确定这是解决问题的原因，因此在得到一些确认之前，我不会将响应标记为已接受。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-04T17:49:23.097

设置到相关服务器的 ssh 隧道，以便您可以从家用计算机使用服务器的 IP 登录到 gmail Web 客户端。您可能需要隧道端口 80 和端口 443，也许只是 443。通过 Web 客户端登录后，根据 SMTPAuthenticationError 中列出的知识库文章，问题应该会消失。

以下是如何设置隧道的示例： [http ://www.noah.org/wiki/SSH_tunnel#simple_port_forwarding_.28SSH_tunneling.29](http://www.noah.org/wiki/SSH_tunnel#simple_port_forwarding_.28SSH_tunneling.29)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-02-12T21:31:29.563

**选项＃1（这对我有用）：**

在尝试从我的 Web 应用程序发送电子邮件时收到错误后`Please log in with your web browser and then try again. Learn more etc.`，我从本地计算机通过浏览器登录到电子邮件。

登录后，顶部有一个黄色通知栏，询问我是否要允许外部应用程序访问我的邮件。**我确认了这一点，谷歌要求我在接下来的 10 分钟内**从应用程序登录该帐户。这会将应用程序列入白名单。

**选项#2：**

如果选项 #1 对您不起作用，请尝试以下操作：[http ://www.rocketideas.com/2012/05/gmail-error-password-not-accepted-from-server-solved/](http://www.rocketideas.com/2012/05/gmail-error-password-not-accepted-from-server-solved/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-11-27T18:20:36.800

etusm 提供了两个位置来打开不太安全的应用程序：

> 一个在这里：[https](https://myaccount.google.com/security?pli=1#connectedapps) ://myaccount.google.com/security?pli=1#connectedapps （页面底部）
> 
> 还有一个：[https ://www.google.com/settings/security/lesssecureapps](https://www.google.com/settings/security/lesssecureapps)

两者都已打开，但我的无头服务器仍然无法向我发送电子邮件。根据 JohnPang 的 google+ 推荐，我找到了第三个位置，我必须允许访问不太安全的应用程序：

在 myaccount.google.com 的“登录和安全”下，选择“关联的应用和网站”。这也有一个“允许不太安全的应用程序”的选项。打开这个后，我的服务器现在可以向我发送一封自动电子邮件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-08-13T19:37:13.277

我在以下网址找到了解决方案：[https](https://support.google.com/accounts/answer/185833?hl=en) ://support.google.com/accounts/answer/185833?hl=en ，最后是[https://security.google.com/settings/security/apppasswords](https://security.google.com/settings/security/apppasswords)

如果您在本地机器上测试您的项目，您应该转到后一个链接，并启用“访问不太安全的应用程序”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-03-30T23:17:04.723

您是否为应用程序帐户启用了两因素身份验证？然后，您可能需要为该应用程序使用特定于应用程序的密码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-08-10T16:21:06.227

以上所有对我的情况都没有帮助（奇怪）。但是此链接可能会对您有所帮助：

[https://security.google.com/settings/security/activity](https://security.google.com/settings/security/activity)

您可以通过 Google Plus 访问它

1.  打开谷歌+
2.  从顶部选择“安全”
3.  在“最近的活动”下点击“查看所有活动”
4.  您将看到“异常活动”列表
5.  当我使用来自新加坡的 AWS 时，它显示“应用程序/设备登录尝试（阻止）新加坡”
6.  单击“更改”>“是的，那是我！”
7.  重试。完毕！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-07T10:11:13.670

最近，我发现可以通过访问[Google 帐户确认该活动源自我发起的请求来解决此问题](https://myaccount.google.com/)

我必须在安全事件下确认可疑活动实际上是我，即使发出请求的源服务器是云托管的，因此距离超过 1000 公里。单击此步骤并设置安全性较低的应用程序后，我可以使用 getmail 检索我的邮件，通过 ssl 使用 imap 或 pop。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-16T17:53:43.020

截至目前（查看我的发布日期），Gmail 帐户管理 UI 中只有一个“允许不太安全的应用程序”切换： [https ://myaccount.google.com/u/0/security#connectedapps](https://myaccount.google.com/u/0/security#connectedapps)

之后，它将在您的**本地计算机**（Mac 或 PC）上运行。

为了允许从**Amazon EC2**访问（我怀疑其他位于云的主机），在 Google 与垃圾邮件发送者的永无休止的战斗中设置了另一个标志： [https ://accounts.google.com/b/0/DisplayUnlockCaptcha](https://accounts.google.com/b/0/DisplayUnlockCaptcha)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2015-04-16T13:45:17.213

[在https://www.google.com/settings/security/lesssecureapps](https://www.google.com/settings/security/lesssecureapps)更改您的设置，以便您的帐户不再受到现代安全标准的保护。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-09-16T17:27:19.017

这是因为某些应用程序被谷歌标记为不太安全的应用程序。因此，要使用这些应用程序，您需要授予这些应用程序的访问权限。要做到这一点，请遵循[http://www.codematrics.com/your-imap-server-wants-to-alert-you-to-the-following-please-login-via-your-web-browser-gmail/](http://www.codematrics.com/your-imap-server-wants-to-alert-you-to-the-following-please-login-via-your-web-browser-gmail/)

希望这能解决您的问题。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2012-05-29T02:11:50.853

就我而言，当我尝试通过网络登录谷歌帐户时，它要求我输入验证码。我输入了验证码，然后自动化工作了。

# tfs - 是否可以在引用父工作项的字段的工作时间上显示只读字段？

> ID：10013738
> 
> 赞同：0
> 
> 时间：2012-04-04T14:57:14.527
> 
> 标签：tfs, tfs-workitem

我正在使用 TFS 2010 Scrum 模板并想修改 Task 工作项模板，以便可以显示 PBI 的积压优先级（只读）。

我熟悉编辑流程模板，但不确定是否可以设置一个字段以从另一个工作项中提取数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:30:19.683

没有可用于从其他工作项获取数据的规则。如果您想这样做，您可以使用事件服务（例如，它是在工作项保存上调用的服务），或者您可以创建自定义工作项控件。

# foursquare - 如何通过 Foursquare API 查看场地是否关闭？

> ID：10013739
> 
> 赞同：1
> 
> 时间：2012-04-04T14:57:15.467
> 
> 标签：foursquare

如果场地关闭，来自 /venues/ 的 JSON 响应中似乎没有标志，因此我们可以知道该场地已关闭。

例如，[https:](https://foursquare.com/v/bar-breton/4a2edc78f964a52070981fe3) //foursquare.com/v/bar-breton/4a2edc78f964a52070981fe3 是一个封闭的场所，而foursquare网站明确表示它是封闭的。

但是，如果您通过 API [https://api.foursquare.com/v2/venues/4a2edc78f964a52070981fe3](https://api.foursquare.com/v2/venues/4a2edc78f964a52070981fe3)访问此场地，则似乎没有任何标志或指示该场地已关闭。

我们如何从 API 中获取这些信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T15:13:40.890

从今天晚些时候开始，将出现“关闭”：如果场地关闭，则真正进入场地对象（开放场地不存在）。

# uml - 如何在 UML 中对泛化进行分组？

> ID：10013742
> 
> 赞同：3
> 
> 时间：2012-04-04T14:57:27.183
> 
> 标签：uml

我有看起来像这样的模型：

![概括](../Images/ad8e5b90201847271df322a68800fee5.png)

**问题：**如何正确分组很多泛化箭头？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:49:26.663

UML 元模型包括泛化集的概念，它允许您对一组泛化进行分组（并向它们添加全局约束，如不相交）。

有些工具支持这个概念，但有些不支持。尝试重叠架构中的行并查看工具是否将此操作理解为“合并”操作并将它们分组

# debugging - 将 NodeJs 应用程序从其进程中切换到调试模式

> ID：10013743
> 
> 赞同：4
> 
> 时间：2012-04-04T14:57:34.043
> 
> 标签：debugging, node.js

我有一个 NodeJs 模块“some-module”，我想全局安装它，这样它就可以直接从命令行运行，而无需节点可执行前缀。即：`$> some-module [args]`我希望其中一个论点是`--debug`. 这样做的原因是我不想要求这个模块的用户将它安装到他们的本地目录只是为了运行`node --debug-brk node_modules/some-module/[path to entry point] [args]`.

NodeJs 文档在其关于调试的高级用法部分中声明（[http://nodemanual.org/latest/nodejs_ref_guide/debugging.node.js.html](http://nodemanual.org/latest/nodejs_ref_guide/debugging.node.js.html)）

> V8 调试器可以通过使用`--debug`命令行标志启动 Node.js 或通过使用`SIGUSR1`.

我尝试这样做：

```
process.kill(process.pid, 'SIGUSR1'); 
```

这产生了错误：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: Unknown signal: SIGUSR1
    at EventEmitter.kill (node.js:366:17)
    at Object.<anonymous> (c:\dev\some-module\app.js:94:17)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:31)
    at Function._load (module.js:308:12)
    at Array.0 (module.js:479:10)
    at EventEmitter._tickCallback (node.js:192:40) 
```

我需要做什么才能让正在运行的进程切换到调试模式？

另外，我想用节点检查器调试给定的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T19:16:05.743

我不太确定我是否理解你的问题，但是......

您可能可以全局安装一个应用程序*并*使用 npm 让它在断点处停止。投入`package.json`：

```
...
"scripts": {"start": "node --debug-brk some-module.js"},
"bin" : { "some-module" : "./some-module.js" },
... 
```

运行`npm start -g some-module`将在第一行中断。然后，您可以使用 node-inspector 进行调试。

关于从代码中停止的部分，node 有一个内置调试器（这是非常基本的），但它允许这个功能。如果您在代码中包含某处：

```
debugger; 
```

并运行：

```
node debug some-module.js 
```

它将在调试器中停止（*注意*：这与节点检查器不同，我不知道这是否可以通过节点检查器实现）。

不太了解您这样做的原因，但希望这会有所帮助。

# c - 在 C 中完成的 IDT 不起作用

> ID：10013744
> 
> 赞同：0
> 
> 时间：2012-04-04T14:57:35.390
> 
> 标签：c, operating-system, interrupt-handling, interrupt, keyboardinterrupt

我无法让 IDT 工作，因为我的中断例程没有被调用，尤其是当我按下键盘上的一个键时与键盘相关的例程。我正在传递 IDT 表的特殊 48 位指针地址。我正在这样做

```
dt_ptr idt_ptr; // defining the pointer
loadidt(dt_ptr *a); // how i am passing the pointer's address to assembly routine 
```

我也不知道至少 GDT 是否在工作。

1）我应该怎么做才能让我的 IDT 工作。我也看过一些教程，但没有帮助 2) 我如何验证 GDT 是否正常工作？

提前致谢。

编辑：我正在为我自己的操作系统做这个。我怀疑我的汇编程序是否能够正确接收指针的地址。所以我也尝试使用内联汇编来做lidt，但没有帮助。我不知道出了什么问题。任何线索，想法？

```
void remap_irqs(void)
{
outb(0x20, 0x11);
outb(0xA0, 0x11);
outb(0x21, 0x20);
outb(0xA1, 0x28);
outb(0x21, 0x04);
outb(0xA1, 0x02);
outb(0x21, 0x01);
outb(0xA1, 0x01);
outb(0x21, 0x0);
outb(0xA1, 0x0);
outbyte('a'); 
```

}

```
void set_idt_gate(uint8 num, unsigned long base, word sel, uint8 flags)
{
IDT[num].offset_low = (base & 0xFFFF);
IDT[num].offset_high = (base >> 16) & 0xFFFF;    
IDT[num].selector = sel;    
IDT[num].zero = 0;
IDT[num].type_attrs = flags;   
}

void init_idt()
{
outbyte('M');   
idt_ptr.limit = (sizeof (idt_entry) * 256) - 1;
idt_ptr.base =(uint32) &IDT;

memset((uint8 *)&IDT, 0, sizeof(idt_entry) * 256);
remap_irqs();
set_idt_gate(0,  (unsigned) irq_0, 0x08, 0x8E);
set_idt_gate(1,  (unsigned) irq_1, 0x08, 0x8E);
//install_isrs();
//install_irqs();   
//idt_load();
//print_message();
lidt(&IDT,idt_ptr.limit);
_LIDT(&idt_ptr);
loadidt(&idt_ptr);
}

void lidt( void * base, unsigned short size )
{
struct
{
    unsigned short length;
    unsigned long base;
} __attribute__((__packed__)) IDTR;

IDTR.length = size;
IDTR.base = (unsigned long)base;
asm( "lidt (%0)"
     : : "p"(&IDTR) ); 
```

}

```
void _LIDT(dt_ptr *ptr)
{
asm("lidt (%0)" : :"p"(ptr));
outbyte('n');
}

void irq_0()
{
//before_interrupt();
ticks+=1;
if(ticks%18==0)
{
    outbyte('+');
    outbyte('1');
}
//after_interrupt();
}

void irq_1()
{
outbyte('a');
//before_interrupt();
irq1_keyb();
//after_interrupt();
}

typedef struct {
uint16 offset_low;    // The lower 16 bits of the address to jump to when this
interrupt occures:// offset 0-15  
uint16 selector;      // Kernel segment selector in IDT
uint8  zero;          // This must always be zero.
uint8  type_attrs;    //gate types, atttribute types etc.   
uint16 offset_high;   // The upper 16 bits of the address to jump to. offset 16-31 
} __attribute__((__packed__)) idt_entry;  

typedef struct  {
uint16 limit;
uint32 base;      // The address of the first element in IDT array.
} __attribute__((__packed__)) dt_ptr;

global loadidt
loadidt:
push ebp
mov ebp,esp     
mov eax,[ebp+8]     
lidt [eax]    
pop ebp     
ret 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T18:54:06.803

您将 IRQ 向量偏移设置为`0x20`。这意味着`IRQ0`映射到中断`0x20`、`IRQ1`中断`0x21`等。但是，您将 irq 处理程序设置为在中断`0x00`和`0x01`发生时执行。这就是你应该如何设置 IDR：

```
set_idt_gate(0x20,  (unsigned) irq_0, 0x08, 0x8E);
set_idt_gate(0x21,  (unsigned) irq_1, 0x08, 0x8E); 
```

[您可以在此处](http://wiki.osdev.org/PIC)找到有关 PIC 的更多信息（*初始化*部分准确解释了您在`remap_irqs`函数中所做的事情。

# java - java中接口实现的约束

> ID：10013746
> 
> 赞同：6
> 
> 时间：2012-04-04T14:57:35.703
> 
> 标签：java, interface

> **可能重复：**
> [Java 泛型约束需要像 C# 这样的默认构造函数](https://stackoverflow.com/questions/7563654/java-generics-constraint-require-default-constructor-like-c-sharp)

我想为类型 T 设置一个约束，它必须有一个没有参数的构造函数。在 C# 中，它会像：

`public interface Interface<T> where T : new() { }`

这个功能在 Java 中可用吗？

# 更新：是否有一些技巧可以使泛型类型 T 具有构造函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:00:33.143

您不能在 Java 中为构造函数定义接口。除了类型差异之外，您也不能对类型参数施加任何其他约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:16:30.443

回答您更新的问题：Java 中只有类可以有构造函数， T - 是类型文字，不一定必须是类。在运行时使用反射，您可以检查您的类是否为[ParameterizedType](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/reflect/ParameterizedType.html)是否有一个实际上是类的参数，以及它是否有一个空的构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:08:09.740

您不能在 Java 的编译时执行此操作。我认为你能做的最好的就是尝试在运行时验证这一点，通过使用反射来做类似的事情：

```
public static <T> boolean hasDefaultConstructor(Class<T> cls) {
    Constructor[] constructors = cls.getConstructors();
    for (Constructor constructor : constructors) {
        if (constructor.getParameterTypes().length == 0) {
            return true;
        }
    }

    return false;
} 
```

然后，您可以通过执行以下操作来调用此函数：

```
hasDefaultConstructor(String.class)  => true;
hasDefaultConstructor(Integer.class) => false; 
```

如果此函数返回 false，那么您知道该类将没有默认构造函数，并且您可以抛出异常或任何适合您的应用程序的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:16:06.330

你可以让 T 用你想要的构造函数扩展一个类

```
public interface Interface<T extends Constructable>{}

public abstract class Constructable{
    public Constructable(params..){
     }
} 
```

# javascript - 在jade中迭代mysql查询结果[node-mysql]

> ID：10013747
> 
> 赞同：-1
> 
> 时间：2012-04-04T14:57:37.403
> 
> 标签：javascript, node.js, pug

如何使用jade迭代mysql查询的结果。我正在使用[node-mysql](https://github.com/felixge/node-mysql)。

```
[
    { 
        twitter_id: 52653645,
        screen_name: 'somoething',
        retweeted: '0'
    },
    { 
        twitter_id: 5265343636,
        screen_name: 'somoet',
        retweeted: '45'
    },
] 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:37:49.567

[当我为我的 blog](https://github.com/kcbanner/nodelog/blob/master/views/feed.jade)生成 XML 提要时，您可以像我在这里做的那样做。

```
ul
- each result in results
    li= result.twitter_id
    li= result.screen_name
    li= result.retweeted 
```

`results`传入模板的 MySQL 结果数组在哪里。

# c++ - c ++算法将整数转换为bool数组

> ID：10013758
> 
> 赞同：0
> 
> 时间：2012-04-04T14:58:34.033
> 
> 标签：c++

我正在尝试编写一种算法，该算法将在一个范围内的每个整数都以二进制字符串的形式保存到文件中。例如，对于 0 到 7 的范围：

```
0 0 0
0 0 1
0 1 0
0 1 1
1 0 0
1 0 1
1 1 0
1 1 1 
```

请注意，数字之间的前导零和空格是必不可少的。

我无法弄清楚如何以一种简单的方式将整数转换为由`bool []`s 表示的二进制数（或一些替代方法）。

**编辑**

根据要求，到目前为止我的解决方案是：

```
const int NUM_INPUTS = 6;
bool digits[NUM_INPUTS] = {0};
int NUM_PATTERNS = pow(2, NUM_INPUTS);

for(int q = 0; q < NUM_PATTERNS; q++)
{
    for(int w = NUM_INPUTS -1 ; w > -1 ; w--)
    {

        if( ! ((q+1) % ( (int) pow(2, w)))  )
            digits[w] = !digits[w];

        outf << digits[w] << " ";
    }

    outf << "\n";
} 
```

不幸的是，这有点古怪，因为它给我的第一个模式是 000001 而不是 000000。

这不是家庭作业。我只是在编写一个简单的算法来给我一个用于训练神经网络的输入文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T16:13:56.667

不要使用`pow`. 只需使用二进制数学：

```
const int NUM_INPUTS = 6;
int NUM_PATTERNS = 1 << NUM_INPUTS;

for(int q = 0; q < NUM_PATTERNS; q++)
{
    for(int w = NUM_INPUTS -1 ; w > -1; w--)
    {
        outf << ((q>>w) & 1) << " ";
    }
    outf << "\n";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:04:05.840

注意：我没有提供代码，而只是一个提示，因为这个问题听起来像家庭作业

这很容易。看这个例子：

```
number = 23
binary representation = 10111
first  digit = (number   )&1 = 1
second digit = (number>>1)&1 = 1
third  digit = (number>>2)&1 = 1
fourth digit = (number>>3)&1 = 1
fifth  digit = (number>>4)&1 = 1 
```

或者写成：

```
temp = number
for i from 0 to digits_count
    digit i = temp&1
    temp >>= 1 
```

请注意，此算法采用的数字顺序与您要打印的相反。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T17:00:02.570

懒惰的方法是使用 std::bitset。

例子：

```
#include <bitset> 
#include <iostream>

int main()
{
  for (unsigned int i = 0; i != 8; ++i){
    std::bitset<3> b(i);
    std::cout << b << std::endl;
  }
} 
```

如果要单独输出位，以空格分隔，请替换`std::cout << b << std::endl;`为对类似 的调用`Write(b)`，`Write`定义为：

```
template<std::size_t S>
void Write(const std::bitset<S>& B)
{
  for (int i = S - 1; i >= 0; --i){
    std::cout << std::noboolalpha << B[i] << " ";
  }
  std::cout << std::endl;
} 
```

# javascript - 仅在完全加载后加载背景图像？

> ID：10013769
> 
> 赞同：10
> 
> 时间：2012-04-04T14:59:07.577
> 
> 标签：javascript, jquery, html, background

好吧，标题几乎描述了我的问题：

完全加载后如何动态加载背景图像？有时，我必须使用太大的背景，以至于浏览器可能需要一段时间才能下载它。我宁愿“在后台加载它”，并在它完全加载后让它淡入。

我认为最好使用 jQuery，但如果 JavaScript 已被禁用，我也希望我的背景出现。如果这真的不可能，那就这样吧，但我认为是吗？

最好的问候， 阿尔特

## ...........

**编辑：**

非常感谢，伙计们！我已经被这个问题困扰了很长时间，只是想不出一个好的和简单的方法。

我将 Jeffrey 的 Javascript 解决方案转换为 jQuery 解决方案，只是因为 jQuery 的内置淡入淡出看起来非常棒。

我会在这里发布，以防其他人有同样的问题：

```
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>
<script type='text/javascript'>
    $(document).ready(function() {
        $('#img').css('opacity','0').load(function() {
            $(this).animate({
                opacity: 1
            }, 500);
        });
    });

</script>

<img src='yourimage.jpg' id='img'/> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T15:03:21.163

如果图像包含在`img`元素中：

```
<img src="bg.jpg" id="img" onload="this.style.opacity='1'">

<script>
    document.getElementById("img").style.opacity="0";
</script> 
```

如果 JavaScript 被禁用，那应该会正常加载图像，但假设它已启用，则仅在加载后才显示它。

需要注意的一件事（我忽略了）：如果图像的`display`属性是`none`. 这就是该方法使用`opacity`属性的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:02:38.553

当 JS 被禁用时，你不能这样做。但是，您可以做的是在 CSS 中设置背景图像，然后使用以下脚本（假设元素具有 ID `myelem`）。

```
(function() {
    var elm = document.getElementById('myelem'),
        url = 'background image URL here';
    elm.style.backgroundImage = "none";
    var tmp = new Image();
    tmp.onload = function() {
       elm.style.backgroundImage = "url('"+url+"')";
       // or insert some other special effect code here.
    };
    tmp.src = url;
})(); 
```

编辑：虽然，请确保您的背景图像是最佳的。如果它们是 PNG，请尝试使用尽可能小的颜色表对它们进行索引，或者如果没有透明度，请确保删除 alpha 通道。如果它们是 JPEG，请尝试调整压缩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:02:21.773

检查此页面上的示例：http: [//www.w3schools.com/jsref/event_img_onload.asp](http://www.w3schools.com/jsref/event_img_onload.asp)

仅当图像准备好时，使用“image.onload”才会启动您的代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:03:34.937

如果没有 javascript，您将无法拥有事件，因此您将无法知道图像是否已加载，至少在第一次渲染时是这样。

您还可以使用 css 预加载（将图像作为背景放在隐藏的 div 中），但这在您第一次刷新时会更好，而不是在加载时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-04T15:04:57.757

您可以为图像设置一个变量，并在加载时将其设置为主体背景：

```
var my_bg = new Image();
my_bg.src = "url(mybackground.png)";
document.style.backgroundImage = my_bg; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-04T15:08:59.337

您正在寻找的是图像 onLoad 方法。如果您使用 display:none 设置图像，它将不可见。要解决可能缺少 javascript 的问题，请执行以下操作：

```
<body style="background-image:url(image.png);">
<img src="image.png" style="display:none" onLoad="changeBackground();" />
</body>
<script>
document.body.style.backgroundImage = "";
function changeBackground(){
    document.body.style.backgroundImage = "url(image.png)";
}
</script> 
```

这样，如果未启用 javascript，则 bg 将正常加载。如果是，它会显示在最后

# ruby-on-rails - 为什么我的 has_many :through 关联在删除时不能正常工作？

> ID：10013773
> 
> 赞同：0
> 
> 时间：2012-04-04T14:59:20.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我的 has_many :through 对 Releases/Products/Tracks 的关联似乎正在删除 Track 并在 release_tracks / products_tracks 表中留下孤立的关联。我看不出哪里出错了，我认为默认行为是仅删除关联。有人可以帮忙吗？

我的模型：

```
 class Track < ActiveRecord::Base
   has_many :releases_tracks
   has_many :tracks, :through => :releases_tracks

   has_many :products_tracks
   has_many :products, :through => :products_tracks 
 end

 class Release < ActiveRecord::Base
   has_many :releases_tracks
   has_many :tracks, :through => :releases_tracks
 end

 class Product < ActiveRecord::Base
   has_many :products_tracks
   has_many :tracks, :through => :products_tracks
   before_save do
     self.track_ids = self.releases_track_ids
   end
 end

 class ProductsTrack < ActiveRecord::Base
   belongs_to :product
   belongs_to :track
 end

 class ReleasesTrack < ActiveRecord::Base
   belongs_to :release
   belongs_to :track
 end 
```

我的轨道控制器（用于销毁操作）：

```
 class TracksController < ApplicationController
  before_filter :get_track_parent

 def destroy
   @track = @parent.tracks.find(params[:id])
   @track.destroy
   redirect_to @parent  
 end

 private

 def get_track_parent
   if params[:product_id].present?
   @parent = Product.find(params[:product_id])
   elsif params[:release_id].present?
   @parent = Release.find(params[:release_id])
   end
 end
 end 
```

我在发布视图中的销毁链接：

```
 <%= link_to image_tag("icons/delete.png"), release_track_path(@release,track), :confirm => 'Are you sure?', :method => :delete %> 
```

最后，我在产品视图中的销毁链接：

```
 <%= link_to image_tag("icons/delete.png"), product_track_path(@product,track), :confirm => 'Are you sure?', :method => :delete %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T16:19:36.610

首先，您需要`:dependent => :destroy`为您的关联选择：

```
class Track < ActiveRecord::Base
  has_many :releases_tracks, :dependent => :destroy
  has_many :releases, :through => :releases_tracks # also note you had here :tracks instead of :releases

  has_many :products_tracks, :dependent => :destroy
  has_many :products, :through => :products_tracks 
end 
```

此外，如果您希望在删除版本或产品时删除曲目，请添加以下内容`:dependent => :destroy`：

```
class Release < ActiveRecord::Base
  has_many :releases_tracks, :dependent => :destroy
  has_many :tracks, :through => :releases_tracks
end

class Product < ActiveRecord::Base
  has_many :products_tracks, :dependent => :destroy
  has_many :tracks, :through => :products_tracks
  before_save do
    self.track_ids = self.releases_track_ids
  end
end

class ProductsTrack < ActiveRecord::Base
  belongs_to :product
  belongs_to :track, :dependent => :destroy
end

class ReleasesTrack < ActiveRecord::Base
  belongs_to :release
  belongs_to :track, :dependent => :destroy
end 
```

# asp.net-mvc - Castle Windsor - 注册和解析同一接口的缓存和非缓存实现

> ID：10013778
> 
> 赞同：0
> 
> 时间：2012-04-04T14:59:36.623
> 
> 标签：asp.net-mvc, dependency-injection, castle-windsor

我有一个服务接口 ICustomerService，并通过两种类型实现它：

```
public class CustomerService : ICustomerService
{
    // stuff
}

public class CachedCustomerService : ICustomerService
{
    public CachedCustomerService(CustomerService service) { }
} 
```

缓存的服务然后只是缓存并委托给普通服务。

对于注册，我将 ICustomerService 解析为 CachedCustomerService，然后 CustomerService 只是为其自己的类型注册。

这工作正常。

我想知道是否可以使 CachedCustomerService 需要一个接口而不是具体的 CustomerService。原因是我们最终可能会得到两种类型的 CustomerService，我想避免（如果可能的话）针对每种类型的缓存版本。

因此 CachedCustomerService 的构造函数将更改为：

```
public class CachedCustomerService : ICustomerService
{
    // notice the ICustomerService
    public CachedCustomerService(ICustomerService service) { }
} 
```

我完全控制了注册，但解决方法是由 asp.net mvc 的碗完成的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T06:27:20.107

您对温莎城堡所做的一切就像[这篇文章](http://mikehadlow.blogspot.com/2010/01/10-advanced-windsor-tricks-4-how-to.html)所建议的那样。因此，在您的情况下，您只需要首先使用缓存服务注册您的客户服务：

```
var container = new WindsorContainer()
.Register(
Component.For(typeof(ICustomerService)).ImplementedBy(typeof(CachedCustomerService)),
Component.For(typeof(ICustomerService)).ImplementedBy(typeof(CustomerService))
); 
```

然后缓存客户服务可以`ICustomerService`用作内部/包装对象，如下所示：

```
public class CachedCustomerService : ICustomerService
{
    private ICustomerService _customerService;
    public CachedCustomerService(ICustomerService service)
    {
        Console.WriteLine("Cached Customer service created");
        this._customerService = service;
    }

    public void Run()
    {
        Console.WriteLine("Cached Customer service running");
        this._customerService.Run();
    }
} 
```

然后分辨率正常：

```
ICustomerService service = container.Resolve<ICustomerService>();
service.Run(); 
```

# c++ - 试图使 C++ (MFC) 代码片段易于重用。有什么选择？

> ID：10013779
> 
> 赞同：0
> 
> 时间：2012-04-04T14:59:38.943
> 
> 标签：c++, visual-studio-2010, templates, macros, code-reuse

我发现自己反复编写以下函数：

```
// This function will try to find the 'item' in 'array'.
// If successful, it will return 'true' and set the 'index' appropriately.
// Otherwise it will return false.
bool CanFindItem(data_type item, const data_type* array, int array_size, int& index) const
{
    bool found = false;
    index=0;
    while(!found && i < array_size)
    {
         if (array[index] == item)
              found = true;
         else index++;             
    }

    return found;
} 
```

通常我为每个需要它的类/结构等编写一个类似的函数。

我的问题是，有没有办法让这个片段准备好使用而不重写它？我在 VS 2010 中编程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:04:11.283

您可以通过将其移动到 .h 文件并将其放在`template<typename data_type>`函数的前面来将其转换为模板。

您还可以切换到使用标准 C++ 功能，例如[`std::find`算法](http://www.cplusplus.com/reference/algorithm/find/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:05:21.453

您可以使用**[std::find](http://msdn.microsoft.com/en-us/library/79s2waft.aspx)** ...链接中有一个使用数组的示例。

```
(std::find (array,array + array_size, item) != array + array_size); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:01:52.097

即使在 MFC 中，您也可以使用现代（即 1995 年后）c++ 和 STL 结构

# php - 使用 insert() 方法通过 PHP Doctrine\DBAL 2 插入 DateTime 值

> ID：10013783
> 
> 赞同：14
> 
> 时间：2012-04-04T14:59:58.680
> 
> 标签：php, database, datetime, doctrine-orm, dbal

如何使用**Doctrine\DBAL将 PHP 的****DateTime**对象作为数据库字段的值传递？

 *****$DB**是一个**Doctrine\DBAL\Connection**实例。*

```
$DB->insert('table_name', [
    'field' => new \DateTime(),
]);

// Catchable fatal error: Object of class DateTime could not be converted to string 
```

上面的代码不起作用，文档很少。

我确定您可以使用其他 DBAL 方法直接提供**DateTime对象，是否可以使用****insert()**来做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-05T09:21:36.380

```
$DB->insert('table_name', [
    'foo'   => 'foo',
    'bar'   => 17,
    'field' => new \DateTime(),
], [
    PDO::PARAM_STR,
    PDO::PARAM_INT,
    'datetime',
]); 
```

成功了！))**

# javascript - 在现有 iframe 或运行代码中打开链接，具体取决于 iframe 是否存在

> ID：10013784
> 
> 赞同：0
> 
> 时间：2012-04-04T15:00:01.080
> 
> 标签：javascript, iframe

我对 javascript 很陌生，但我的背景是 C++，所以我了解编码的原理，只是不做太多的网络工作。我有一个电子邮件链接，需要根据 iframe 是否存在来做两件事中的一件。此代码存在于父页面（index.html）中，因此 iframe 将是一个子页面（我想）。如果还没有 iframe，我需要这段代码（gb_page_fs[] 调用一些代码来创建 iframe）。

```
<a href="contact.html" rel="gb_page_fs[]">e-mail</a> 
```

如果 iframe 存在，它将被命名为“GB_frame”，这是链接所需的代码：

```
<a href="contact.html" target="GB_frame">e-mail</a> 
```

我有两个问题：尝试确定框架是否存在并执行第二种情况代码。我已经看到很多代码来识别父 iFrame 名称，但不是孩子。我得到的最接近的是document.getElementById（“framename”）.name，但我得到“无法读取null的属性'name'”。至于后者，我猜有一个简单的解决方案，但我不知道从哪里开始寻找。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:32:20.287

您正在对 iframe 进行正确的测试。你想做这样的事情：

```
var x = document.getElementById('framename');
// if the iframe doesn't exist x will be null and the if statement evaluates to false
if(x) 
{
  doSomething();
} 
```

要设置 iframe 的来源：

```
 document.getElementById('framename').src = 'url to page'; 
```

# php - 使用谷歌地图和复选框过滤

> ID：10013795
> 
> 赞同：0
> 
> 时间：2012-04-04T15:00:39.277
> 
> 标签：php, javascript, google-maps-api-3

我需要帮助：当用户单击输入复选框时，我必须创建一个显示标记的地图。

例如：我点击“酒店”，我只看到酒店。我不再点击酒店，地图上的标记消失

编码：

```
<script type="text/javascript">

(function() {
window.onload = function(){

var latlng = new google.maps.LatLng(37.8530665, 15.287916300000006); 
var options = { 
zoom: 14,
center: latlng,
backgroundColor: '#fff',
mapTypeId: google.maps.MapTypeId.ROADMAP
}; 

var map = new google.maps.Map(document.getElementById('map_canvas'), options);

var markers = new Array(); 

$(".chek").click(function() {

if($(this).is(':checked')) {

var id_checkbox = $(this).val();

$.post("ajax.php?page=mapHome",{ id_checkbox:id_checkbox }, function(data) {    
for (i=0; i < data.marker.length; i++) { 

var marker = new google.maps.Marker({
position: new google.maps.LatLng(data.marker[i].latitude, data.marker[i].longitude), 
animation: google.maps.Animation.DROP,
map: map,
title: data.marker[i].nome,
icon: data.marker[i].marker
});

markers[i] = marker;
markers[i].id_cat = data.marker[i].id_cat; 

}// for
},"json");//json
} else {

//hide markers on the map
for (i = 0; i < markers.length; i++) {
if(id_checkbox == markers[i].id_cat) {
markers[i].setMap(null);
}
}

}

});

}
})();
</script> 
```

我通过 json 进行查询并显示结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T18:24:26.820

我看到`setMap(null);` 但没有`setMap(map);`

# c# - WinRT 图像处理

> ID：10013799
> 
> 赞同：8
> 
> 时间：2012-04-04T15:00:54.123
> 
> 标签：c#, image, windows-runtime, windows-store-apps

我和一个朋友昨晚大部分时间都在试图在 Metro 应用程序中处理一些图像时差点把头发扯下来。我们通过分享功能将图像放入应用程序，然后我想用它们做一些其他的工作，裁剪图像并将它们保存回 appdata 文件夹。事实证明这非常令人沮丧。

我的问题，在这一切结束时，将是“这样做的正确方法是什么，而不觉得我正在拼凑一堆不匹配的拼图？”

当与应用程序共享多个图像时，它们以`Windows.Storage.StorageFile`s 列表的形式出现。这是一些用于处理该问题的代码。

```
var storageItems = await _shareOperation.Data.GetStorageItemsAsync();

foreach (StorageFile item in storageItems)
{
    var stream = await item.OpenReadAsync();
    var properties = await item.Properties.GetImagePropertiesAsync();

    var image = new WriteableBitmap((Int32)properties.Width, (Int32)properties.Height);
    image.SetSource(stream);

    images.Add(image);
} 
```

一些网上搜索表明，目前，a`Windows.UI.Xaml.Media.Imaging.WriteableBitmap`是唯一能够让您访问图像中的像素数据的东西。[这个问题](https://stackoverflow.com/questions/9757885/save-image-using-filesavepicker)包括一个有用的答案，其中包含将图像保存到文件的扩展方法，因此我们使用了这些方法。

当我稍后再次尝试打开文件时，我们的问题是最严重的。我做了类似于以前的事情：

```
var files = await ApplicationData.Current.LocalFolder.GetFilesAsync();

foreach (var file in files)
{
    var fileStream = await file.OpenReadAsync();
    var properties = await file.Properties.GetImagePropertiesAsync();
    var bitmap = new WriteableBitmap((Int32)properties.Width, (Int32)properties.Height);
    bitmap.SetSource(fileStream);

    System.IO.Stream stream = bitmap.PixelBuffer.AsStream(); 
```

问题来了。如果我想要其中的字节，这个流有多长？

```
 // CRASH! Length isn't supported on an IRandomAccessStream.
    var pixels = new byte[fileStream.Length]; 
```

好的再试一次。

```
 var pixels = new byte[stream.Length]; 
```

这可行，除非...如果图像被压缩，则流比您预期的要短，因此您最终会得到一个超出范围的异常。现在假设它是一个未压缩的位图。

```
 await _stream.ReadAsync(pixels, 0, pixels.Length); 
```

好吧，猜猜是什么。即使我说`bitmap.SetSource(fileStream);`为了读入数据，我的字节数组仍然充满了零。我不知道为什么。如果我通过`bitmap`示例数据组将其传递到我的 UI 中，则图像显示得很好。所以它清楚地在某处获得了该位图中的像素数据，但我无法读取它`bitmap.PixelBuffer`？为什么不？

最后，这就是最终实际工作的结果。

```
 var decoder = await BitmapDecoder.CreateAsync(BitmapDecoder.PngDecoderId, fileStream);
    var data = await decoder.GetPixelDataAsync();
    var bytes = data.DetachPixelData();

    /* process my data, finally */

} // end of that foreach I started a while ago 
```

所以现在我有图像数据，但我仍然有一个大问题。为了对它做任何事情，我必须对其格式做出假设。我不知道是 rgba、rgb、abgr、bgra，不管它们是什么。如果我猜错了，我的处理就会失败。我已经进行了数十次测试运行吐出零字节和损坏的图像、颠倒的图像 (???)、错误的颜色等。我本希望在`properties`我从调用中得到的一些信息中找到这些信息`await file.Properties.GetImagePropertiesAsync();`，但没有运气。那只包含图像的宽度和高度，以及其他一些无用的东西。[这里](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.fileproperties.imageproperties)的文档最少。

那么，为什么这个过程如此痛苦呢？这只是反映了图书馆现在的不成熟，我可以期待它变得更好吗？还是已经有一些标准的方法来做到这一点？我希望它像`System.Drawing`. 这为您提供了您曾经需要的所有数据，并愉快地正确加载了任何图像类型，而无需您自己处理流。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:45:40.197

1.  从我所看到的 - 当您计划使用流加载 WriteableBitmap 时 - 您不需要检查图像尺寸 - 只需执行 new WriteableBitmap(1,1)，然后调用 SetSource()。
2.  不知道你为什么在想 var pixel = new byte[fileStream.Length]; 会起作用，因为 fileStream 具有压缩的图像字节而不是像素数组。
3.  您可能需要寻找到流的开头以获取像素数组：

    ```
    var pixelStream = pixelBuffer.AsStream();
    var bytes = new byte[this.pixelStream.Length];
    this.pixelStream.Seek(0, SeekOrigin.Begin);
    this.pixelStream.Read(bytes, 0, Bytes.Length); 
    ```

4.  我已经开始研究[WriteableBitmapEx](http://writeablebitmapex.codeplex.com/)的 WinRT 端口- 也许它可以帮助你：[http](http://bit.ly/WriteableBitmapExWinRT) ://bit.ly/WriteableBitmapExWinRT 。我没有很好地测试它，它基于旧版本的WBX，但在功能支持方面相当完整。可能也比可能的慢一点。

# php - Magento 检查产品是否在多个站点可用

> ID：10013800
> 
> 赞同：1
> 
> 时间：2012-04-04T15:00:57.450
> 
> 标签：php, zend-framework, magento

我有一个包含多个网站和多个商店的 magento 设置，我想检查商店是否以编程方式包含相同的产品。因为我正在为它编写一个模块，所以我重写了产品块，所以我可以`$this->product()->getid()`毫无问题地访问。我检查了`$this->product()`网站列表 ( )，但在那里找不到。知道我如何开始吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T16:37:48.383

你有没有尝试过 ？

```
$this->product()->getWebsiteIds(); 
```

它将为您提供产品处于活动状态的一系列网站 ID。

你也可以这样做，

```
$this->product()->getStoreIds(); 
```

# php - 搜索引擎是否对诸如 somesite.com/index.php?page=photos 之类的网址有问题

> ID：10013802
> 
> 赞同：0
> 
> 时间：2012-04-04T15:01:00.927
> 
> 标签：php, seo, indexing, search-engine

我是 php 编码、Web 开发和搜索优化的新手——总的来说是新手。在学习 php 和 web 开发的过程中，我一直在尝试不同的网站架构和布局。我正在研究的一个方法使用如下方法：

我有一个 index.php 页面，它总是加载 header.php、sidebar.php 和 footer.php。index.php 还包含一个开关，以便根据页面变量传递 index.php，它会加载不同的核心内容。例如，examplesite.com/index.php?page=photos 和 examplesite.com/index.php?page=stories 都具有相同的页眉、页脚和侧边栏，但一个有照片，一个有故事主要内容。

```
<?php $page = $_GET['page'];?>

<?php include("header.php"); ?>
<?php include("nav.php"); ?>
<?php 
      switch ($page)
      {
      case 'play':
        include("photos.php");
        break;
      case 'cards':
        include("stories.php");
        break;
      default:
        include("frontpage.php");
      } 
      ?>
<?php include("footer.php"); ?> 
```

我的导航是由 href="index.php?page=..." 链接组成的，所以在索引页面上选择一个菜单按钮本质上是调用它自己传递新的核心来加载。

我不知道这是否是一种完全非正统的方法，但这一切都开始了，因为我最初打算创建一个 wordpress 主题，但中途决定不在 wordpress 中做。

我担心的是这种方法在搜索引擎、索引、seo 等方面可能存在哪些缺点。

我应该考虑的其他缺点或问题是什么，也许我不是？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:17:59.103

> 我不知道这是否是一种完全非正统的方法

使用查询字符串加载各种页面本质上没有什么“非正统”的。数十亿网站使用这种方法。搜索引擎可以索引这样的页面。
尽管如此，

> 我有一个 index.php 页面，它总是加载 header.php、sidebar.php 和 footer.php。

这是错误的概念。
仅使用 index.php 文件来加载页眉和页脚是没有意义的，并且会使您的网站明显无法使用。

以下是您设计中的主要缺陷：

1.  您假设每个页面调用都会调用 header.php。那是错误的。
2.  您假设 header.php 将始终是静态的。那是错误的。
3.  您忘记为页面本身创建模板。

每个人都必须牢记的主要规则：

**在所有数据准备好之前，不必将单个字符发送到浏览器。**

为什么？

*   今天是 2012 年。AJAX 时代。如果您的代码必须发送 JSON 数据而不是整个 HTML 页面怎么办？
*   有一种东西叫`HTTP header`。有时我们必须发送它们。如果您已经发送了华丽的 HTML 标头，那就不可能了。
*   将显示逻辑与业务逻辑分开将使您可以在许多站点上使用相同的 php 代码。您将只需要更改模板并且不要触摸引擎文件。这真是一个很大的好处。
*   假设您要`<title>`根据页面内容为您的页面制作自定义标签。这不是很常见的事情吗？但是你不能不使用模板。

因此，您必须拥有一个包含页眉和页脚的通用站点模板，以及每个 php 脚本的专用模板。**只有在所有业务逻辑完成后才**
需要调用这些模板——即您已经准备好所有数据。

 **一个示例布局将是这样的：

.1。页面本身。

**它什么都不**输出，只收集所需的数据，然后调用模板：

```
<?
//include our settings, connect to database etc.
include dirname($_SERVER['DOCUMENT_ROOT']).'/cfg/settings.php';
//getting required data
$DATA=dbgetarr("SELECT * FROM links");
$pagetitle = "Links to friend sites";
//etc
//and then call a template:
$tpl = "links.tpl.php";
include "template.php";
?> 
```

.2\. `template.php`这是您的主要网站模板，

由您的页眉和页脚组成：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>My site. <?=$pagetitle?></title>
</head>
<body>
<div id="page">
<? include $tpl ?>
</div>
</body>
</html> 
```

.3\. 最后`links.tpl.php`是实际的页面模板：

```
<h2><?=$pagetitle?></h2>
<ul>
<? foreach($DATA as $row): ?>
<li><a href="<?=$row['link']?>" target="_blank"><?=$row['name']?></a></li>
<? endforeach ?>
<ul> 
```

这样你就不需要包含索引了**

# php - 代码中的wordpress帖子/页面内容

> ID：10013803
> 
> 赞同：0
> 
> 时间：2012-04-04T15:01:01.617
> 
> 标签：php, wordpress, shortcode

我正在尝试将帖子/页面插入到我的一个主题文件中，它不会显示短代码或 php

我在 wordpress 管理面板中创建了一个名为 home 的页面，并将以下内容插入到我的代码中：

```
<div id="home_page"> <!-- echos the content from the page "home" id:43 -->
            <?php $home_id = 43;
            $home_page = get_page( $home_id );
            ?>  
            <?php echo $home_page->post_content; ?>
    </div> <!-- end #home_page --> 
```

并且不是我在页面中拥有的简码。我安装了一个`php in post or page`并尝试使用 php，但它不起作用。

当我插入

```
echo do_shortcode('[youtube_sc url=http://www.youtube.com/watch?v=Db3XGpt6nNU]'); 
```

直接进入它工作的代码。

有谁知道发生这种情况？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T09:20:57.880

我在[wordpress.stackexchange.com上得到了答案](https://wordpress.stackexchange.com/a/47987/14555)

我引用：

> 您需要应用过滤器 the_content 例如：
> 
> `<?php echo apply_filters('the_content',$home_page->post_content); ?>` 此外，您不需要 youtube 的自定义短代码，只需将 URL 放入内容中（但不是超链接），它会在运行时换成 youtube 播放器。oembed 无需插件或额外代码。

谢谢[汤姆·J·诺威尔](https://wordpress.stackexchange.com/users/736/tom-j-nowell)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:03:44.790

$home_page->post_content 值是存储在数据库中的确切帖子内容。回应这一点不会让您的任何短代码有机会运行。

您应该使用“WordPress 循环”来显示内容，因为这会设置允许您使用模板标签，例如 the_title() 和 the_content() - 这将调用短代码的处理函数和 wpautop() 等其他函数该“按摩”发布内容以进行输出。

如果您不想使用循环，可以使用 echo do_shortcode($home_page->post_content); 输出内容

这将通过简码处理器运行帖子内容，让简码有机会运行。

有关 WordPress 如何“按摩”发布内容的更多信息，您可以查看此处：[http ://codex.wordpress.org/How_WordPress_Processes_Post_Content](http://codex.wordpress.org/How_WordPress_Processes_Post_Content)

# php - PHP中不区分大小写的比较

> ID：10013806
> 
> 赞同：0
> 
> 时间：2012-04-04T15:01:18.293
> 
> 标签：php, case-insensitive, string-comparison

PHP中是否有允许不区分大小写比较的运算符？

而不是执行以下操作：

```
if (strtolower("A") == strtolower("a") ) 
```

我想我正在寻找类似的东西：

```
if ^("A" == "a") 
```

Where`^`告诉 php 忽略基于大小写的比较。

是的，我确实有一个疯狂的想象力。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:03:00.363

您可以使用[`stricmp`](http://php.net/strcasecmp)

```
if(!strcasecmp('a', 'A')) echo 'strings are equal'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:03:07.650

你可以用[`strcasecmp`](http://us2.php.net/strcasecmp)这个。只需检查它是否返回 0。

```
if (strcasecmp("A", "a") == 0) {
    // yes
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:03:48.787

您可以使用[http://www.php.net/manual/en/function.strcasecmp.php](http://www.php.net/manual/en/function.strcasecmp.php) `strcasecmp`

```
if (strcasecmp("A", "a") == 0) {
    echo 'OK';
} 
```

谢谢

:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:03:26.307

[`strcasecmp`](http://php.net/manual/en/function.strcasecmp.php)

# jquery - 如何防止 jQuery ajax 在发布后跟随重定向？

> ID：10013812
> 
> 赞同：16
> 
> 时间：2012-04-04T15:01:30.120
> 
> 标签：jquery, http, redirect

我有一个发送 Ajax POST 以执行操作的链接。如果用户尚未登录，则操作方法会返回 302 重定向到登录页面。如果发生这种情况，我想捕获重定向，以便可以在灯箱中显示登录表单。

但是，jQuery 似乎遵循重定向而不返回控制或调用回调函数。在下面的代码中，从未调用过 302 重定向的警报，而当调用 dataFiler 函数时，数据就是登录页面的内容。

我如何才能看到该页面已发送 302 重定向，并分支到不同的操作？

```
 $.ajax(url,
        {
            data: postArguments,
            type : "POST",
            success: function (data) { alert(' success function'); },
            statusCode:
            {
                302: function () { alert(' received redirect 302'); },
                301: function () { alert(' received redirect 301'); }
            },
            dataFilter: function (data, type) { alert('got data ' + data); return data; }
        }); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-04T15:04:40.877

这不是 jQuery 的限制，而是 JavaScript 本身的限制；无法在 JavaScript 中检测 AJAX 请求中的重定向；[浏览器 XHR 对象根据规范](http://www.w3.org/TR/XMLHttpRequest/#infrastructure-for-the-send-method)自动且不可见地遵循重定向。

理想的选择是在您的服务器代码中添加一个 catch 来[检测 AJAX 请求](http://davidwalsh.name/detect-ajax)（“HTTP_X_REQUESTED_WITH”标头），并返回一个特殊的响应来检测 JavaScript 中的匿名用户，并进行适当的处​​理。

# python - PyLucene 的对数似然比统计

> ID：10013818
> 
> 赞同：2
> 
> 时间：2012-04-04T15:01:50.393
> 
> 标签：python, pylucene, weighting

目前我正在分析大量的文本。我想对两个词表执行对数似然比，以识别前景语料库与规范语料库中术语的频率偏差。我已经在 Python 中编写了对数似然编码，但是在二元组上运行代码会导致计算机速度慢和等待时间长。我刚刚读到我可以使用 PyLucene 索引我的语料库，这将加快语料库上的运行任务。有足够的文档如何索引，但我在某个地方读到了 PyLucene 中存在的对数似然比函数。有人知道这个功能吗？提前致谢。

# javascript - Internet Explorer 9 上的 Javascript 未处理字符 NULL (ASCII 0)

> ID：10013825
> 
> 赞同：1
> 
> 时间：2012-04-04T15:02:15.637
> 
> 标签：javascript, google-chrome, utf-8, character-encoding, internet-explorer-9

函数**d(a)显示一个警报，其中包含字符串****a**中每个字符的 ASCII 值。其中一个字符是 ASCII 0，我在这篇文章中用 [NULL] 显示了它。这是我在不同浏览器上收到的输出：

**GOOGLE CHROME - 正确** - 字符串长度：3 - 警报输出：116、0、114

**INTERNET EXPLORER 9 - 错误** - 字符串长度：2 - 警报输出：116、114

如何在 Internet Explorer 9 中显示这些字符？谢谢

```
<script type="text/javascript" charset="x-user-defined">
function d(a)
{
  a=(a+"").split("");
  var l=a.length;
  alert(l); // Displays string length
  for(var z=0;z<l;z++)alert(a[z].charCodeAt(0));
};
d("t[NULL]r");
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:05:03.403

不要将不可打印的字符直接放入代码中——它很可能不起作用。相反，请使用正确的实体`\0`。

# sql - 从 nvarchar 转换为 varchar 时数据加载缓慢

> ID：10013832
> 
> 赞同：0
> 
> 时间：2012-04-04T15:02:38.553
> 
> 标签：sql, sql-server-2008, ssis

我有一个大约有 140 列的表。此表的数据来自事务系统，并且许多列是 Unicode。

我将每日负载转储到我的暂存数据库，其数据类型与源系统的数据类型完全匹配。从暂存中，我进行一些清理并将其加载到报告数据库。从 Staging 加载到 Reports 数据库时，我将所有 Unicode 字符数据转换为 String，然后将其加载到报告数据库。这个过程需要花费大量时间，我正在尝试优化这个过程（使加载时间更快）。

我使用派生列转换将所有 Unicode 数据转换为字符串数据。这里对我有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:49:56.533

如果您在源查询中将列转换为 varchar(size) 怎么样？

# facebook - Facebook 点赞数在 50 次后归零

> ID：10013835
> 
> 赞同：1
> 
> 时间：2012-04-04T15:02:42.547
> 
> 标签：facebook, facebook-like, meta-tags

我有一个问题，Facebook 喜欢在 50 次喜欢后重置为零。

这件事是一样的，根本没有改变：

*   网址
*   标签
*   页面标题

关于正在发生的事情有什么想法吗？

# wpf - WPF ToggleButton 不正确的呈现行为

> ID：10013838
> 
> 赞同：3
> 
> 时间：2012-04-04T15:02:54.170
> 
> 标签：wpf, togglebutton

这里发生了什么，以及如何解决？

1.  按我的切换按钮。现在它看起来像立即按下（选中）。
2.  同时 MyToggleButton_Checked 处理程序禁用 MyToggleButton。
3.  现在按非切换按钮“启用”。我们看到了什么？MyToggleButton 看起来已启用。好的。但是等等，现在它看起来像未按下！为什么？！

XAML：

```
<StackPanel>

    <ToggleButton x:Name="MyToggleButton" Content="MyToggleButton" Checked="MyToggleButton_Checked"/>

    <TextBlock Text="{Binding IsChecked, ElementName=MyToggleButton}" Margin="0,4"/>

    <Button Name="EnableButton" Content="Enable" Click="EnableButton_Click"/>
    <Button Name="DisableButton" Content="Disable" Click="DisableButton_Click"/>

</StackPanel> 
```

代码隐藏：

```
void MyToggleButton_Checked(object sender, RoutedEventArgs e)
{
    MyToggleButton.IsEnabled = false;
}

void EnableButton_Click(object sender, RoutedEventArgs e)
{
    MyToggleButton.IsEnabled = true;
}

void DisableButton_Click(object sender, RoutedEventArgs e)
{
    MyToggleButton.IsEnabled = false;
} 
```

**升级版：**

目前唯一可能的解决方法是：

```
void EnableButton_Click(object sender, RoutedEventArgs e)
{
    MyToggleButton.IsEnabled = true;

    var controlTemplate = MyToggleButton.Template;

    var buttonChrome = (Microsoft.Windows.Themes.ButtonChrome)controlTemplate.FindName("Chrome", MyToggleButton);

    buttonChrome.RenderPressed = false;

    buttonChrome.RenderPressed = true;
} 
```

还有其他人吗？

**UPD2：**

另一种解决方法是：

```
void EnableButton_Click(object sender, RoutedEventArgs e)
{
    MyToggleButton.IsEnabled = true;

    var controlTemplate = MyToggleButton.Template;
    MyToggleButton.Template = null;
    MyToggleButton.Template = controlTemplate;
} 
```

但是在模板替换的那一刻，控件正在闪烁。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T08:59:01.803

这是我解决问题的方法，这里是[视频](http://screencast.com/t/7hU52d0lQPYC)，用法：

```
<StackPanel>
    <ToggleButton x:Name="MyToggleButton" Content="MyToggleButton" Checked="MyToggleButton_Checked"
                    l:CorrectToggleButtonCheckedEnableBehavior.IsActive="True"/>
    <Button Name="EnableButton" Content="Enable" Click="EnableButton_Click"/>
</StackPanel> 
```

以及附加的行为源代码：

```
public static class CorrectToggleButtonCheckedEnableBehavior
{
    public static bool GetIsActive(ToggleButton toggleButton)
    {
        return (bool)toggleButton.GetValue(IsActiveProperty);
    }

    public static void SetIsActive(ToggleButton toggleButton, bool value)
    {
        toggleButton.SetValue(IsActiveProperty, value);
    }

    public static readonly DependencyProperty IsActiveProperty =
        DependencyProperty.RegisterAttached("IsActive", typeof(bool), typeof(CorrectToggleButtonCheckedEnableBehavior),
        new UIPropertyMetadata(false, OnIsActiveChanged));

    static void OnIsActiveChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var toggleButton = (ToggleButton)d;

        if (GetIsActive(toggleButton))
        {
            toggleButton.IsEnabledChanged += new DependencyPropertyChangedEventHandler(ToggleButton_IsEnabledChanged);
        }
        else
        {
            toggleButton.IsEnabledChanged -= new DependencyPropertyChangedEventHandler(ToggleButton_IsEnabledChanged);
        }
    }

    static void ToggleButton_IsEnabledChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        var toggleButton = (ToggleButton)sender;

        if (toggleButton.IsEnabled && (toggleButton.IsChecked ?? false))
        {
            Invalidate(toggleButton);
        }
    }

    static void Invalidate(ToggleButton toggleButton)
    {
        var controlTemplate = toggleButton.Template;
        toggleButton.Template = null;
        toggleButton.Template = controlTemplate;
    }
} 
```

# mysql - MySQL 间隔 - 引入 6 个月未登录的用户

> ID：10013841
> 
> 赞同：1
> 
> 时间：2012-04-04T15:03:05.263
> 
> 标签：mysql

我有一个简单的查询：

```
 $query1="SELECT * FROM wp_users WHERE now() < (last_login + INTERVAL 6 month)";
$result1=mysql_query($query1) or die(mysql_error());

while($rows=mysql_fetch_array($result1)){  

    $inactive_accounts[] = $rows['ID'];
} 
```

我希望它拉入所有 6 个月未登录其帐户的人的 user_id。我已经设置好了，所以当他们登录时，它将 datetime 插入 last_Login 列。

我只是想知道这个 SELECT 查询是否正常，因为我无法测试它。这个会显示6个月未登录的人的ID吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:10:53.320

你在正确的路线上。你可能需要的是MySQL 中的[DATE_SUB函数，所以](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-sub)

```
SELECT *
FROM wp_users
WHERE last_login < DATE_SUB( NOW(), INTERVAL 6 MONTH ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T15:06:58.740

```
SELECT * FROM wp_users WHERE last_login < date_sub(now(), INTERVAL 6 month) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:20:56.547

要测试您的代码是否有效，请手动调整用户的 last_login 字段并将其设置为 > 6 个月前。当然是在你的开发环境中！

# java - Java OpenGL GL_TEXTURE_2D 使其他颜色变暗

> ID：10013845
> 
> 赞同：2
> 
> 时间：2012-04-04T15:03:11.740
> 
> 标签：java, opengl, jogl, lwjgl

我正在尝试将纹理放入我的 Java OpenGL 场景中，但是当我这样做时，其他事物的颜色会出现偏差，就好像它错误地混合了颜色一样。我将 LWJGL 用于 OpenGL，将 Slick 用于加载纹理。当我离开`GL11.glEnable(GL11.GL_TEXTURE_2D);`电话未注释时，颜色变暗，但是当我评论一行时颜色是正确的，但是我显然没有纹理。

我把我的代码放在这里[http://codepaste.net/26bguu](http://codepaste.net/26bguu)

有问题的行是第 63 行

我发现的一种解决方法是在我绘制纹理之前启用纹理，然后立即再次禁用。但是我觉得这应该是不必要的。下面是一些屏幕截图，显示了我的意思。唯一的区别是一行注释与未注释。

![没有启用纹理。 所有的颜色都很鲜艳。](../Images/68aa1b1b23f0ed482a78f9830edf51c0.png)

![启用纹理。 所有颜色都较深。](../Images/f88fdeaf9b76d7c49015a65065e1ec42.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:17:13.783

您确实需要根据需要启用和禁用`GL_TEXTURE_2D`。

如果`GL_TEXTURE_2D`启用，GL 将（通常）*忽略*您提供的顶点颜色，而是将给定的纹理坐标映射到给定的纹理以获取每个片段/像素的颜色。如果你不传递纹理坐标，任何事情都可能发生——比如你发布的第二个屏幕截图。

必须进行 20 多次 opengl 调用来准备绘制每个“对象”的情况并不少见。这就是为什么 OpenGL 程序员花费大量时间将大量三角形组合到单个缓冲区中以通过一次绘制调用立即绘制的原因——它极大地提高了性能。

# excel - 用于选定区域连接的 Excel 宏

> ID：10013853
> 
> 赞同：2
> 
> 时间：2012-04-04T15:03:40.800
> 
> 标签：excel, vba

我希望有人对如何处理以下 Excel 宏要求有所了解。

起始条件：A 列中可变数量的文本值。

建议的解决方案：我希望能够在 A 列中选择*可变*数量的**连续**单元格，然后将文本连接起来，用逗号分隔，并与 B 列中最顶部的单元格相邻。

示例：将在工作表上选择 A2-A4。运行宏后，**B2**的内容（直接与选择的顶部相邻）将包含格式为“A2、A3、A4”的文本。

A5-A10 选中：运行宏后，**B5**的内容（直接与选择的顶部相邻）将包含格式为“A5、A6、A7、A8、A9、A10”的文本。

让我丧命的是如何利用多项选择的可变性，此外，我不清楚如何处理 Excel 宏中的循环。我有计算机科学学位，但我最终在基础设施工作，所以我有点生疏。有人可以帮忙吗，这可以节省我每天的大量时间。感谢任何回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:47:30.987

以下代码可以满足您的需求。我没有添加很多评论，因为我不确定什么级别的评论是合适的。例如，如果您的 CS 学位允许您猜测，我不想解释每个陈述的目的。我还怀疑您的问题比显而易见的要多。例如，我是否应该将其设为一个函数，并将工作表和行号作为参数传递。请带着问题回来，我会根据需要改进我的答案。

```
Option Explicit
Sub JoinCells()

  Dim ColFirst As Long
  Dim ColLast As Long
  Dim JoinedValue As String
  Dim RowCrnt As Long
  Dim RowFirst As Long
  Dim RowLast As Long

  RowFirst = Selection.Row     ' First row of selection
  ' Selection.Rows.Count returns the number of rows in the selection.
  ' Warning! You can fool this code by making multiple selections.
  RowLast = RowFirst + Selection.Rows.Count - 1

  ColFirst = Selection.Column
  ColLast = ColFirst + Selection.Columns.Count - 1

  If ColFirst <> 1 Or ColLast <> 1 Then
    Call MsgBox("Please select a range within column ""A""", vbOKOnly)
    Exit Sub
  End If

  With Worksheets("xxxxxxx")      ' Worksheet of your choice.

    JoinedValue = .Cells(RowFirst, "A").Value
    For RowCrnt = RowFirst + 1 To RowLast
      JoinedValue = JoinedValue & "," & .Cells(RowCrnt, "A").Value
    Next
    .Cells(RowFirst, "B").Value = JoinedValue

  End With

End Sub 
```

# iphone - IOS按钮样式

> ID：10013865
> 
> 赞同：-1
> 
> 时间：2012-04-04T15:04:08.617
> 
> 标签：iphone, ios

我在 Xcode 4 中寻找以下按钮。请参阅以下链接以获取示例。[http://cascade-innovations.nl/image%208.png](http://cascade-innovations.nl/image%208.png)

但我在任何地方都找不到它。有谁知道这个按钮是如何调用的，或者我在哪里可以找到它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:19:13.147

它`UITableViewCell`是用`UITableViewCellStyleValue1`样式初始化的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:05:52.703

那不是一个按钮。它`UITableViewCell`来自一个`UITableView`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T17:03:11.913

您可能会想到它的按钮，因为单击它会将您带到下一个屏幕

但它是“分组”的 uitableview 的 uitableviewcell

# html - CSS a：悬停未按预期工作

> ID：10013866
> 
> 赞同：0
> 
> 时间：2012-04-04T15:04:09.193
> 
> 标签：html, css, hyperlink, hover, mouseover

我正在尝试构建我的第一个站点并尝试使用 CSS 中的“a:hover”功能，但无法使其正常工作 - 无论是否悬停，链接看起来都一样。

这是我的 CSS 文件的片段：

```
 /* main page elements */
    a:link
    {
      text-decoration: none;
      color:white;
    }

    a:visited
    {
      text-decoration: none;
      color:FFFFFF;
    }

    a:hover
    {
      text-decoration: none;
      color:blue;  
    }

    a:active
    {
      text-decoration: none;
      color:blue;
    } 
```

任何帮助表示赞赏。

谢谢，罗伯特。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T15:05:40.377

您需要完成文本装饰指令：P

```
text-decoration: none; 
```

或者

```
text-decoration: underline; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:09:13.713

我希望你需要改变`hover`状态的颜色

试试这样[的](http://jsfiddle.net/2Nhd2/)

例如。

```
HTML   

<a href ='#'> Hover Me </a>

css   

 a
 { 
     text-decoration: none; 
     color:#000000;
 }
 a:hover
 {
     color:#3399FF;
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:14:32.400

您可能正在从 a:active 过渡到具有相同颜色的 a:hover。因此你看不出有什么不同。尝试为 a:hover 设置一个独特的颜色，看看会发生什么。

如果你制作一个 jsfiddle 也会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:07:05.763

您的问题出在`text-decoration:`零件上，如果您删除它们或使用有效的语法，您的 CSS 应该可以工作。

# python - 有没有使用 Python 2/3 兼容源作为移植策略的大型项目？

> ID：10013869
> 
> 赞同：2
> 
> 时间：2012-04-04T15:04:25.697
> 
> 标签：python, python-3.x

众所周知，同时移植和支持 Python 2 和 3 有几种策略：可以直接用 Python 3 编写，然后使用 3to2，也可以用 Python 2 编写，安装时使用 2to3，或者您可以同时编写与 Python 2 和 Python 3 兼容的代码。现在，根据我的经验，大多数项目都使用第二种策略，在安装时运行 2to3。我也觉得这是一种更好的方法，但是有人建议我编写 2/3 兼容的源代码对于我想要从事的项目可能是一个更好的主意。因此，我想知道，**是否有任何具有 2/3 兼容源的重大项目？**我知道的唯一更大的项目是[mpmath](https://code.google.com/p/mpmath/)。

或者，是否有任何来源（例如尝试移植）表明这是一个坏主意？我觉得对于任何中等规模的代码库来说，这意味着过度依赖 Python 内部，最终会减慢开发速度。显然，它适用于较小的项目（例如，最多 10k 行代码）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:07:52.753

我相信金字塔在 2 和 3 上运行，其代码库与此处建议的相同。

[https://github.com/Pylons/pyramid/wiki/Python-3-Porting](https://github.com/Pylons/pyramid/wiki/Python-3-Porting)

# scala - 处理未初始化 var 的惯用形式

> ID：10013870
> 
> 赞同：2
> 
> 时间：2012-04-04T15:04:28.600
> 
> 标签：scala

我正在编写我的第一个 Scala 脚本来感受这种语言，但对于实现某事的最佳方式，我有点困惑。

我的情况如下，我有一个需要调用 N 次的方法，这个方法在每次运行时返回一个 Int （可能不同，执行中有一个随机组件），我想保持最好的运行（这些运行返回的最小值）。

现在，来自 Java/Python 背景，我只需使用 null/None 初始化变量，然后在 if 中进行比较，例如：

```
best = None
for...
    result = executionOfThings()
    if(best is None or result < best):
        best = result 
```

就是这样（请原谅半 python 伪代码）。

现在，在 Scala 上，我有点挣扎。我已经阅读了关于使用选项和模式匹配来实现相同效果的信息，我想我可以编写类似的代码（这是我能想到的最好的）：

```
best match {
    case None => best = Some(res)
    case Some(x) if x > res => best = Some(res)
    case _ =>
  } 
```

我相信这行得通，但我不确定这是否是最惯用的写法。这很清楚，但对于这样一个简单的“用例”来说有点冗长。

任何人都可以照亮我的功能？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:26:42.333

对于这个*特殊*问题，不是一般情况下，我建议使用初始化，`Int.MaxValue`只要你保证`N >= 1`. 那你就

```
if (result < best) best = result 
```

您还可以`best`选择，

```
best = best.filter(_ >= result).orElse( Some(result) ) 
```

如果可选性很重要（例如，有可能`N == 0`，并且在这种情况下您没有通过代码采取不同的路径）。这是处理可能被替换的可选值的更通用方法：用于`filter`保留未替换的情况，并`orElse`在需要时填写替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T16:18:12.750

编辑：调整为@user-unknown的建议

我建议您重新考虑整个计算以使其更具功能性。你改变了应该避免的状态。我可以想到您的代码的递归版本：

```
def calcBest[A](xs: List[A])(f: A => Int): Int = {
  def calcBest(xs: List[A], best: Int = Int.MaxValue): Int = xs match {
    // will match an empty list
    case Nil => best
    // x will hold the head of the list and rest the rest ;-)
    case x :: rest => calcBest(rest, math.min(f(x), best))
  }
  calcBest(xs)
} 
```

可调用`calcBest(List(7,5,3,8,2))(_*2) // => res0: Int = 4`

有了这个，你根本就没有可变状态。

另一种方法是在列表中使用 foldLeft：

```
list.foldLeft(Int.MaxValue) { case (best,x) => math.min(calculation(x),best) } 
```

`foldLeft`接受 B 和 PartialFunction`Tuple2[B,A] => B`并返回 B

两种方式是等价的。第一个可能更快，第二个更具可读性。两者都遍历列表，对每个值调用一个函数并返回最小值。你的片段中的哪一个是你想要的，对吧？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T17:01:29.797

只需使用 min 函数：

```
(for (... executionOfThings()).min 
```

例子：

```
((1 to 5).map (x => 4 * x * x - (x * x * x))).min 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T20:29:17.420

我想我会提供另一个惯用的解决方案。您可以使用`Iterator.continually`创建一个无限长的迭代器来延迟评估，`take(N)`将迭代器限制为 N 个元素，并使用它`min`来找到获胜者。

```
Iterator.continually { executionOfThings() }.take(N).min 
```

# solr - Solr 3.5 没有索引

> ID：10013872
> 
> 赞同：0
> 
> 时间：2012-04-04T15:04:40.570
> 
> 标签：solr

我遇到的问题是 Solr 没有建立索引，并且我在日志文件中没有得到任何异常。我正在使用 Tomcat 7 服务器并连接到 MS 服务器。我的 data-config.xml 如下。

```
<?xml version="1.0" encoding="UTF-8" ?>
<dataConfig>
  <dataSource type="JdbcDataSource"
       driver="com.microsoft.sqlserver.jdbc.SQLServerDriver"
       url="jdbc:sqlserver://testserver:2120;databaseName=testdb"
       user="test"
       password="test1" />
  <document name="parts">
    <entity name="id"
       query="select distinct pa.part_id, pa.part_number, pa.part_description, pa.usage_text, pa.quantity, d.make, d.model, d.model_qualifier_id, @category, @subcategory from testdb..part_application_v pa inner join testdb..equipment_detailed_v d on pa.make = d.make and pa.model inner join testdb..page_part_application ppa on ppa.application_id = pa.application_id where ppa.page_id in (select p.page_id from testdb..page p inner join testdb..nav_lang nl on nl.nav_desc_id = p.nav_desc_id inner join testdb..page_chapter_xref pcx on p.pageId = pcx.page_id and chapter_id in (select deistinct chapter_id from testdb.dbo.chapter_v where parent_id in (select distinct chapter_id from testdb.dbo.chapters_v where catalog_id in (select ed.catalog_id from testdb.models_v m inner join testdb..equipment_detailed_v ed on ed.make_id = (select distinct make_id from testdb..equipment_detailed_v where make = @make) and ed.model_qualifier_id = @year and m.model_id = ed.model_id where m.model_id = (select distinct model_id from testdb..equipment_detailed_v where model = @model)) and parent_id is null and name = @category) and name = @subcategory) inner join testdb..chapters_v c on pcx.chapter_id = c.chapter_id and p.image_id is not null and testdb.dbo.utility_fn_filtermatch(null,p.filter_equation) = 1) and testdb.dbo.utility_fn_filtermatch(null,pa.filter-equation) = 1 and d.model_qualifier_id = @year order by ppa.page_id, pa.part_description />
    <field column="pa.part_id" name="partId" />
    <field column="pa.part_number" name="partNumber" />
    <field column="pa.part_description" name="desc" />
    <field column="pa.usage_text" name="usage" />
    <field column="pa.quantity" name="qty" />
    <field column="d.make" name="make" />
    <field column="d.model" name="model" />
    <field column="d.model_qualifier_id" name="year" />
    <field column="@category" name="category" />
    <field column="@subcategory" name="subcategory" />
  </document>
</dataConfig> 
```

如果没有抛出某种错误，我什至不确定从哪里开始调试它。我将非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T18:10:13.507

两件事情。

首先，您的实体元素是一个空标签，里面没有字段元素。不要用“/>”关闭它，而是用“>”关闭它，并在所有字段元素之后添加“”。是的，当字段元素不在实体元素内时，DataImportHandler 可能应该给出错误。

其次，换行符在属性内是合法的，因此您不必将该查询全部放在一行上。哇，这很难读。你可以这样做：

```
<entity name="id"
        query="select
               table.name as name,
               table.id as id
               from table">
  <field column="name"/>
  <field column="id"/>
</entity> 
```

# php - 简单的随机生成器脚本不起作用

> ID：10013877
> 
> 赞同：0
> 
> 时间：2012-04-04T15:05:02.483
> 
> 标签：php

我有这个脚本，但它不起作用，不知道如何修复它，请问有什么提示吗？我从另一端得到的只是字母“t”

谢谢 ：）

```
<?php
$cachefile = './current_t_id';
$time = $id = null; // assume we have no cached quote
$change_every = 3600; // seconds
$pages = array(1 => 'text1-1.php', 2 => 'text1-2.php');

foreach($pages as $pagekey => $page){
    if($pagekey == $siteId){
        include($page);
    }
}

// if cached quote exists, load it
if(is_file($cachefile)) {
    list($time, $id) = explode(' ', file_get_contents($cachefile));
}

// if no cached quote or duration expired, change it
if(!$time || time() - $time > $change_every) {
    srand ((double) microtime() * 100000);
    $id = rand(0,count($page)-1);
    file_put_contents($cachefile, time().' '.$id); // update cache
}

// echo the quote, be it cached or freshly picked 
echo ($page[$id]);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:24:18.470

好的，我会给你 3 个不同的例子

变量

```
$quotes = array (
        "hello",
        "baba",
        "luke" 
);

$pages = array(1 => 'text1-1.php', 2 => 'text1-2.php'); 
```

A. 使用随机引用

```
// Using Ramdom Quptes
$key = array_rand ( $quotes );
echo $quotes [$key]; 
//Or
include($pages[$key]) ; 
```

B. 使用罗宾

```
// Using Robin
$cacheFile = "robin.cache";
$robin = null;
$quotesID = intval ( file_get_contents ( $cacheFile ) );
$totalQuotes = count ( $quotes );

$key = ($quotesID < ($totalQuotes - 1)) ? $quotesID ++ : 1;
file_put_contents ( $cacheFile, $quotesID );

echo $quotes [$key];
//Or
include($pages[$key]) ; 
```

使用定时器

```
// Using Timer

$cacheFile = "timer.cache";
$expiration = 3600;

$robin = null;
list($quotesID, $time) = explode(' ', file_get_contents($cacheFile));
$totalQuotes = count ( $quotes );

if($time < (time() - $expiration))
{
    $key = mt_rand(0,count($pages)-1);
    file_put_contents($cacheFile, time().' '.$id);
}
echo $quotes [$key];
//Or
include($pages[$key]) ; 
```

我希望你的问题现在可以解决

谢谢 ：）

# php - 如何使用表单更新数据库记录

> ID：10013879
> 
> 赞同：0
> 
> 时间：2012-04-04T15:05:09.710
> 
> 标签：php, mysql, arrays, forms, textbox

我从 mysql 中收集了许多记录，例如：

```
id      name     mark 
1234    john     18
53      smith    12
324     mike     15
... 
```

我想构建一个表单以提供`mark`一次编辑（更新）所有 s 的能力，我知道我可以使用文本框值属性在表单上显示它们。但是，当我想处理已发布的表格时，如何识别完全相同的记录，以便更新正确的归档？而且，我不知道表格中有多少条记录。

这个想法可能是通过`id`字段识别记录。但是怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:09:11.157

构建表单时，使用数据库中的 ID 作为每个文本字段的 NAME 属性的一部分。然后，当您收到您的发布值数组时，您可以处理键以找出您应该更新的记录的 ID。例如，您可以将字段命名为“record-1234”、“record-53”等。然后您将遍历 $_POST 中的键，将它们拆分为“-”并在 UPDATE 查询中使用生成的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:15:35.520

如果此应用程序仅用于管理用途：

```
<input type="hidden" name="id" id="id" value="_ID_VALUE_" />
<input type="text" name="name" id="name" value="_NAME_VALUE_" />
<input type="text" name="mark" id="mark" value="_MARK_VALUE_" /> 
```

然后

```
UPDATE table SET mark = '_SANITIZED_MARK_VALUE_' WHERE id = "_SANITIZED_ID_VALUE_"; 
```

如果它是最终用户的应用程序，您不想相信他/她不会更改隐藏输入的值。在这种情况下，您很可能希望将`id`、`name`和存储`mark`在一个`$_SESSION`变量中，并对 进行比较`post`以确定哪个记录与哪个 相关`id`，然后`update`相应地构建您的语句。

# javascript - 在任何 DOM 元素旁边插入徽标

> ID：10013881
> 
> 赞同：0
> 
> 时间：2012-04-04T15:05:15.760
> 
> 标签：javascript, jquery, firefox-addon

我正在开发一个 Firefox 扩展来修改加载网页的内容。首先，我选择“src”或“href”属性与我的正则表达式匹配的所有元素（这部分代码有效）。

然后，我想使用以下代码在找到的元素的父元素的右上角放置一个小图像：

```
 /* create and add attributes to image */
var img = window.content.document.createElement("img");
var b = window.content.document.createAttribute("src");
b.nodeValue = "chrome://plugin/content/agent.png";
img.setAttributeNode(b);
img.addEventListener("click", function(){ alert("ds"); });
img.style.display = "block";
img.style.border = "3px solid red";
img.style.position = "relative";
img.style.top = "-10px";
img.style.right = "-10px";
img.style.left = "20px"; 
```

// ... 返回元素的代码...

```
//now insert the image
$jq(img).appendTo(element.parentNode); 
```

当前的结果是图像要么显示在元素父级的底部，要么根本不显示。

如果你看这个： http: [//jsfiddle.net/yzwh5/64/](http://jsfiddle.net/yzwh5/64/) - 我希望我的按钮以类似于那个红十字的方式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:33:17.057

您必须“玩”元素的 CSS 定位，事实上，插入图像的位置并不重要，重要的是定位它们的位置。

也许你想看看“next-to”，一个 jQuery 插件，它可以自动计算以将一个元素定位到另一个元素旁边

例如：

```
<script type="text/javascript">
  $('.PlaceThisDiv').nextTo($('.ThisOtherDiv'), {position:'right', shareBorder:'top'});
</script> 
```

正如你在这个小提琴中看到的，我已经准备好了（包含插件本身）

[http://jsfiddle.net/PvcNr/](http://jsfiddle.net/PvcNr/)

你会得到这样的东西：

![看截图](../Images/853e826f534249a956e65ef8ca0d6cdd.png)

更多信息：[https ://code.google.com/p/next-to/](https://code.google.com/p/next-to/)

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:44:41.187

试试这样的 CSS 代码：

```
.my-ext-overlay:after {
    content:url(smiley.gif);
    position: absolute;
    margin-left: -16px; margin-top: -16px;
} 
```

然后将“.my-ext-overlay”类名添加到您找到的每个元素中。

查看[示例](http://jsfiddle.net/x2Fvn/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T15:12:35.820

首先，CSS 浮动被称为`cssFloat`（或`htmlFloat`在某些浏览器中），因为`float`它是一个保留字。`float`其次，不存在`block`.

第三，你错过`x`了房产`-10px`。`right`

第四，同时设置相对左右位置可能会导致意外行为。

第五，你不应该使用`createAttribute`，因为属性节点在所有浏览器中都不可靠。相反，`setAttribute`在元素上使用。

第六，如果这确实有效，它会弄乱您正在搜索的元素周围的页面布局，所以最好`position: absolute`不要影响流程。但是，如果您这样做，您应该使用`margin-left`而不是`left`（其他方向相同）来移动元素。

我认为这至少应该让事情接近工作......

# assignment-operator - 从 C++ 转换为 Java 时，AssignmentOperator 无效

> ID：10013882
> 
> 赞同：0
> 
> 时间：2012-04-04T15:05:17.940
> 
> 标签：assignment-operator

我是java程序员，但我很久以前就用过C++。现在我必须将 C++ 转换为 Java 一个程序，然后我找到了一行，我不知道这是什么意思：

```
if (wr[m-2] == 0) wr[m-1] == 0; 
```

程序在 C++ 中可以正常工作，但在 Eclipse 中当然会出现 AssignmentOperator 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:14:44.070

看起来你正在检查

*基于 wr 是一个 int 数组且 m 是一个 int，如果数组 wr 在索引 m-2 处等于 0，则检查索引 m-1 处的 wr 是否等于 0。*

该行看起来是正确的，但您可能想检查您的减号实际上是减号，而不是不同但相似类型的连字符。否则我觉得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:50:18.503

您引用的行导致可能应该有分配的无操作。

```
if (wr[m-2] == 0)
    wr[m-1] == 0; 
```

应该是

```
if (wr[m-2] == 0)
    wr[m-1] = 0; 
```

# jquery-ui - 在 JQueryUI 自动完成中返回自定义项

> ID：10013890
> 
> 赞同：1
> 
> 时间：2012-04-04T15:05:42.830
> 
> 标签：jquery-ui, jquery, autocomplete, jquery-ui-autocomplete

当没有记录时，我想将“未找到记录”消息作为 ListItem 返回。我设法通过使用“data.d”来检测结果是否为空。但是，我不知道如何将“未找到记录”作为数据项返回。你能帮我解决这个问题吗？谢谢。

```
$.ajax({
                    url: "/WebServices/Misc.asmx/GetOtherQualifications",
                    data: "{ 'ModuleID': '" + $("#<%= hdModuleRef.ClientID %>").val() + "', 'search': '" + $("#<%= txtCourseName.ClientID %>").val() + "' }",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {

                        if (data.d == "") {

                                return {
                                    value: "No record found",
                                    id: -1
                                }                            

                        }
                        else {
                            response($.map(data.d, function (item) {
                                return {
                                    value: item.Name,
                                    id: item.KeyID
                                }
                            }))
                        }
                    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:16:04.257

代替：

```
return {
    value: "No record found",
    id: -1
}; 
```

您需要调用该`response`函数，该函数将结果通知小部件：

```
response([{
    value: "No record found",
    Id: -1
}]); 
```

# jquery - 部分回发和 jquery

> ID：10013891
> 
> 赞同：1
> 
> 时间：2012-04-04T15:05:44.217
> 
> 标签：jquery, asp.net, updatepanel, partial-postback

我遇到了一个问题，在部分回发时，我的一些 jquery 已经停止工作。我有一个带有两个单选按钮的页面，一个用于显示数据，另一个用于显示图片库。我使用 jquery 来显示和隐藏其中一个。

我还有一个模式弹出扩展器，它位于更新面板内。当我关闭 mpe 并切换回图片库时，一些代码停止工作。基本上它是一个画廊，可以在一定时间间隔内切换图像。还有一些缩略图可以做同样的事情（打开一个间隔），它的缩略图不起作用。

**html**

```
<%@ Register Src="~/User_Controls/modify_image_table.ascx" TagName="IMG" TagPrefix="uc2" %>
<%@ Register Src="~/User_Controls/ImageLoaderUC.ascx" TagName="ImageLoader" TagPrefix="uc8" %>

<asp:Content ID="Content1" ContentPlaceHolderID="PageContent" runat="server">
<asp:UpdatePanel ChildrenAsTriggers="true" ID="Upd1" runat="server">
    <ContentTemplate>

        <div class="radioSelection">
            <asp:RadioButtonList ID="selectionby" runat="server" Font-Bold="true" RepeatDirection="Horizontal"
                RepeatColumns="2" CssClass="bodycopy">
                <asp:ListItem Text="Image Library" Selected="True" Value="Libr"></asp:ListItem>
                <asp:ListItem Text="Image Loader" Value="Load"></asp:ListItem>
            </asp:RadioButtonList>
        </div>
        <div id="mpe" style="width: 600px; padding: 5px;">
            <uc2:IMG ID="IMG1" cssclass="bodycopy" runat="server" />
        </div>
        <div id="imgLoader">
            <uc8:ImageLoader ID="ImageLoader" runat="server" />
        </div>
        <asp:UpdateProgress ID="upp1" runat="server" AssociatedUpdatePanelID="Upd1">
            <ProgressTemplate>
                <div id="progressBackgroundFilter">
                </div>
                <div id="modalPopup">
                    &nbsp; &nbsp; Loading...
                    <img align="middle" src="../images/Ajax/loading_1.gif" />
                </div>
            </ProgressTemplate>
        </asp:UpdateProgress>
    </ContentTemplate>
</asp:UpdatePanel> 
```

**Javascript**

```
$(document).ready(function (e) {
    // Execute the slideShow
    slideShow(6000);
    thumbInt(); // Assign int to thumbnail list items
    clearShowClass(); // Prevents multiple li having .show

    function clearShowClass() {
        setTimeout(timedInterval, 1000);
    };

    function timedInterval() {
        $('ul.slideshow li').not('.show').css("opacity", 0);
        clearShowClass();
    }

    $('#footer img').mouseover(

function () {
    $(this).animate({
        opacity: 3.7
    })
});

    $('#footer img').mouseout(
  function () {

      $(this).animate({
          opacity: 0.7
      })
  });

    function thumbInt() {
        for (i = 1; i <= $('ul.slideshow li').length; i++) {
            $('#footer .thumbnail' + i).bind('click', { iteration: i }, function (event) {
                $('ul.slideshow li').removeClass('show').css("opacity", 0).add($('ul.slideshow li:nth-child(' + event.data.iteration + ')').addClass('show').css("opacity", 0.0).animate({
                    opacity: 1.0
                }, 1000));

                $('#footer li').removeClass('highlight').add($('#footer li:nth-child(' + event.data.iteration + ')').addClass('highlight').add($('#footer li:nth-child(' + event.data.iteration + ') img')));

            });
        };
    };
});

function slideShow(speed) {

    //Set the opacity of all images to 0
    $('ul.slideshow li').css({
        opacity: 0.0
    });

    //Get the first image and display it (set it to full opacity)
    $('ul.slideshow li:first').css({
        opacity: 1.0
    }).addClass('show');

    //Get the first thumbnail and change css
    $('#footer li:first').css({
        opacity: 1.0
    }).addClass('highlight');

    //Call the gallery function to run the slideshow
    var timer = setInterval('gallery()', speed);

    //Pause the slideshow on mouse over content
    $('#footer, ul.slideshow').hover(

function () {
    clearInterval(timer);
},

function () {
    timer = setInterval('gallery()', speed);
});
}

function gallery() {
    //if no IMGs have the show class, grab the first image
    var current = ($('ul.slideshow li.show') ? $('ul.slideshow li.show') : $('#ul.slideshow li.first'));

    //Get next image, if it reached the end of the slideshow, rotate it back to the first image
    var next = ((current.next().length) ? ((current.next().attr('id') == 'slideshow-caption') ? $('ul.slideshow li:first') : current.next()) : $('ul.slideshow li:first'));

    //Set the fade in effect for the next image, show class has higher z-index
    next.css({
        opacity: 4.0
    }).addClass('show').animate({
        opacity: 4.0
    }, 1000);

    // Hide the current image
    current.animate({
        opacity: 0.0
    }, 1000).removeClass('show');

    //if no thumbnails have the highlight class, grab the first thumbnail
    var currentThumb = ($('#footer li.highlight') ? $('#footer li.highlight') : $('#footer li:first'));

    var nextThumb = ($('#footer li:last').hasClass('highlight')) ? $('#footer li:nth-child(1)') : $('#footer li.highlight').next($('#footer li'));

    nextThumb.addClass('highlight');
    currentThumb.removeClass('highlight');
} 
```

基本上我想知道更新面板将如何影响 $(document).ready？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:26:36.983

`$(document).ready`部分回发不会再次调用里面的代码；如果您需要函数内部的某些`$(document).ready`功能，那么我建议将这些代码重构为一个函数（例如`initAll()`），并在部分回发之后，从服务器端（在您的事件处理程序中）使用`ClientScriptManager.RegisterClientScriptBlock`函数来调用该函数，例如：

```
...
// last line in your partial postback handler

ScriptManager.RegisterClientScriptBlock(Upd1,typeof(UpdatePanel),"__updp__", "initAll();", true); 
```

# iphone - 如何在 Objective-C 中将 UIImage 添加到 MSMutableArray？

> ID：10013892
> 
> 赞同：1
> 
> 时间：2012-04-04T15:05:44.530
> 
> 标签：iphone, objective-c, ios5

我有noob objective-c 问题。如何将 UIImage 添加到 MSMutableArray？这是我拥有的代码：

```
MSMutableArray *arr = [[NSMutableArray alloc] init];
UIImage *image;
UIGraphicsBeginImageContext(contextSize);
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextTranslateCTM(context, 0, pushUpSize);

    [screenWindow.layer renderInContext: context];  
    image = UIGraphicsGetImageFromCurrentImageContext();
}
UIGraphicsEndImageContext();
[arr addObject:image]; 
```

但是，当它尝试添加图像时，这会使程序崩溃。我在某处读到它添加了一个变量而不是指针，对吗？如何将 UIImage 添加到数组中，它不是一个对象吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T15:08:12.717

~~您正在初始化数组`arr`，但将图像添加到（显然未初始化的）数组`imageArr`中。~~

根据您更新的代码，我会说该`image`对象可能是`nil`. [文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)`addObject:`中明确禁止使用`nil`值调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:15:54.080

@thiesdiggity：据我所见，您的代码没有太大问题。但只需尝试以下代码，因为我认为`image`对象是`nil`：

```
MSMutableArray *arr = [[NSMutableArray alloc] init];
UIImage *image;
UIGraphicsBeginImageContext(contextSize);
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextTranslateCTM(context, 0, pushUpSize);

    [screenWindow.layer renderInContext: context];  
    image = UIGraphicsGetImageFromCurrentImageContext();
}
UIGraphicsEndImageContext();

if(image != nil)
{
    [arr addObject:image];
} 
```

如果您需要更多帮助，请告诉我，请发布您的崩溃日志以获得更多帮助

希望这可以帮助。

# webdriver - 无法在端口 7055 上连接到主机 127.0.0.1

> ID：10013898
> 
> 赞同：7
> 
> 时间：2012-04-04T15:05:59.240
> 
> 标签：webdriver

我是 webdriver 的新手，需要一些帮助..

我在 Windows XP 上使用 Selenium 2.2.0 和 FF v7.0.1

我已经成功地在 IE 中录制和回放了一个 java 脚本，但是每当我尝试在 FF 中执行相同的脚本时，我都会收到以下错误消息：

45000 毫秒后无法连接到端口 7055 上的主机 127.0.0.1

我在很多地方读到过，如果我将 Firefox 版本降级到 3.6 脚本会正常工作，但我并不热衷于降级。有人可以告诉我我做错了什么吗？

```
package hisScripts;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;

public class WebdriverTest_1 {
private WebDriver driver;
private String baseUrl;
private StringBuffer verificationErrors = new StringBuffer();
@Before
public void setUp() throws Exception {
    driver = new FirefoxDriver();
    //driver=new InternetExplorerDriver();
    baseUrl = "https://**********/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
}

@Test
public void testUntitled() throws Exception {
    driver.get(baseUrl + "/");
    driver.findElement(By.xpath("//a[contains(text(),'my profile')]")).click();
    driver.findElement(By.xpath("//a[contains(text(),'about the service')]")).click();
    driver.findElement(By.xpath("//a[contains(text(),'contact us')]")).click();
    driver.findElement(By.xpath("//a[contains(text(),'help')]")).click();
    driver.findElement(By.xpath("//a[contains(text(),'home')]")).click();
    driver.findElement(By.xpath("//a[contains(text(),'logout')]")).click();

}

@After
public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
        fail(verificationErrorString);
    }
}

private boolean isElementPresent(By by) {
    try {
        driver.findElement(by);
        return true;
    } catch (NoSuchElementException e) {
        return false;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T21:33:43.750

您使用的硒版本非常旧。我认为 v2.2 不支持 firefox 10。最新的是 2.20。

[在此处](http://code.google.com/p/selenium/source/browse/trunk/java/CHANGELOG)查看更改日志。从这里的注释来看，从 v2.19.0 开始支持 Firefox 10 中的本机事件，这意味着您需要 2.19 或更高版本才能支持 Firefox 10。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-03-04T17:16:36.573

这个问题是由于firefox版本和selenium jar文件版本的兼容性。使用最新的selenium jar文件。可以解决问题。

# vb6 - 图像映射控件（ocx）

> ID：10013899
> 
> 赞同：0
> 
> 时间：2012-04-04T15:06:05.950
> 
> 标签：vb6, imagemap, ocx

你知道任何可以用来将图像转换为可点击区域的图像映射控件吗？

我目前正在寻找第三方版本、免费软件或共享软件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T08:52:41.120

最简单的方法是让各种图像控件覆盖要单击的图片区域。使用区域或坐标检查有更好的选择，但我不知道任何控件。

# c# - 将密钥发送到进程的非活动窗口

> ID：10013900
> 
> 赞同：2
> 
> 时间：2012-04-04T15:06:12.283
> 
> 标签：c#

我想在 C# 中创建一个简单的程序，它将 SPACE 键发送到非活动窗口或进程（Wow.exe）。但是，我对 C# 不了解，所以如果您想尝试帮助我，请这样做，但如果您不介意向菜鸟解释，那很好；）

所以基本上这个小程序将用于魔兽世界游戏，并希望每 30 秒向游戏发送一个 SPACE 键并让角色跳跃。防止字符自动离开键盘。

这将是一个单按钮程序，一旦您单击按钮，它将开始发送 SPACE 键，并在程序关闭时停止。但是，即使它不是当前的活动窗口，我也希望它将密钥发送到游戏。因此，我可以在 Netflix 上观看电影并让它在后台播放。

单击按钮时我会在里面放什么？...

```
private void btnStart_Click(object sender, EventArgs e)
{

} 
```

如果它比在其中插入一些代码更复杂，请说，我不会费心去尝试：P

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T16:12:55.980

您需要获取窗口句柄 ( [Process.MainWindowHandle](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.mainwindowhandle.aspx) )，然后使用[WM_KEYDOWN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646280%28v=vs.85%29.aspx)和[空格键的虚拟键代码](http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx)[P/Invoke](http://pinvoke.net/default.aspx/user32.SendMessage) [SendMessage](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T16:03:29.710

它无法发送到非活动窗口，因为活动只写 Keys.Send("{SPACE}"); 或 Keys.SendWait("{SPACE}");

# c# - C# 列出所有排列

> ID：10013901
> 
> 赞同：1
> 
> 时间：2012-04-04T15:06:17.683
> 
> 标签：c#

我有一个问题。我用 Apriori 算法开发了一个程序。在 Apriori 算法中，我必须取排列值。为此

```
foreach (String s1 in array1) {

foreach (String s2 in array2) {

        String result = s1 + " " + s2 + " " + s3;
        //Processing

}
} 
```

我编码了一些东西。但是这段代码只采用二进制排列。我必须自动采用二进制、三重、四重、五重排列。你有这个想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:23:05.220

[关联](http://blogs.msdn.com/b/ericlippert/archive/2010/06/28/computing-a-cartesian-product-with-linq.aspx)

代码从上面的链接逐字复制。

```
static IEnumerable<IEnumerable<T>> CartesianProduct<T>(this IEnumerable<IEnumerable<T>> sequences) 
{ 
  IEnumerable<IEnumerable<T>> emptyProduct = new[] { Enumerable.Empty<T>() }; 
  return sequences.Aggregate( 
    emptyProduct, 
    (accumulator, sequence) => 
      from accseq in accumulator 
      from item in sequence 
      select accseq.Concat(new[] {item})); 
} 
```

# php - 高效的排名算法（在 PHP 中）

> ID：10013903
> 
> 赞同：1
> 
> 时间：2012-04-04T15:06:20.740
> 
> 标签：php, algorithm, sorting

我有一个员工计算数据的 PHP 数组（从数据库中检索）。每个员工大约有 10 列，其中 8 列是数字的（另外 2 列是 id 和 name）。这是一个简短的示例：

```
大卫：1024、75、22  
迈克：500、100、25  
杰夫：700、82、10  

```

我可以轻松地对任何（数字）字段上的数组进行排序，以显示谁在顶部/底部，但我真正想在最终表格视图中显示的是按值排名，所以人们不必对表格进行排序和重新排序以获得他们想要的东西。这是一个按第一列排序的表格示例，括号中显示了排名：

```
大卫：1024（#1）、75（#3）、22（#2）  
杰夫：700（#2）、82（#2）、10（#3）  
迈克：500（#3）、100（#1）、25（#1）  

```

现在，我知道最简单的方法就是按列对表格进行排序，使用行索引作为排名并在每一列重复。我只是想知道我是否可以找到更有效的方法。

我考虑过使用有序队列（每列一个需要排名），扫描一次数组并将值推送到队列中。但：

1.  PHP没有数组以外的任何数据结构（除非你使用外部添加）
2.  我不相信这更有效。

任何人都可以建议最好的方法，和/或确认我应该多次重新排序数组吗？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:41:00.933

Ok, after much deliberation, I decided to go the "sort every column" route. For future reference by anyone interested, here's the function I've added to my class - it's called once per every column I need ranked:

```
 private function calculateRankings(&$employees, $columnName) {
        $comparer = "return (\$a[$columnName][0] == \$b[$columnName][0]) ? 0 :  (\$a[$columnName][0] > \$b[$columnName][0] ? -1 : 1);";
        usort($employees, create_function('$a,$b', $comparer));
        foreach($employees as $key => &$employee) {
            $employee[$columnName][1] = $key + 1;
        }
    } 
```

The +1 is due to the keys being zero-based.

You prepare for this function by turning each field you need ranked into a 2-element array: the first ([0]) contains the value, and the second ([1]) will contain the rank in the end.
I.e.: `$employees['salary'] = array(1550, 0);`. You then call the function like this:
`$this->calculateRankings($employees, 'salary');`.

I sincerely hope this helps someone, someday. Thanks to all responders/commenters!

**UPDATE 4/9:** The function I supplied before couldn't work - there's no way to pass a third parameter (in our case, the column name) into the comparer function. The only way to do it is to use a static class variable, or a create_function hack that I ended up with. Sorry for any confusion.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T17:09:34.410

恐怕您将不得不坚持最初的方法。

必须遍历所有列并计算每个列的排名信息，这是不可避免的。

您可以做的是优化算法以更有效地完成该任务。

**PS.：**我不认为该算法不寻常到足以让您担心复杂性、增长顺序或运行时间，即使性能总是很重要。

# python - 在 python 中使用 web-server 代替 GUI

> ID：10013904
> 
> 赞同：5
> 
> 时间：2012-04-04T15:06:21.177
> 
> 标签：python, user-interface

我有一个即将开始的 GUI 项目。GUI 要求很简单（虽然不像 tkinter 那样简单就足够了）。所以我需要为 python 使用一个 GUI 工具包（如果我必须使用 GUI，它将是 wxpython）。现在我在想，为什么我不能使用简单的 web 框架，例如cherrypy 或 bottlepy（对不起，如果我的想法不对。我是服务器端编程的新手）并创建 html 页面作为我的图形界面并使用 DOM（再次，我想，我说得对）而不是使用 wxpython 来创建整体 GUI。然后，我可以编写我所有的业务逻辑，并将其余部分留给简单的 html 渲染，在那里我必须花费更少的时间来格式化表格、创建按钮和表单以及担心大小调整器。

我的问题是：有人可以使用诸如cherrypy 或类似的网络服务器python 包并摆脱使用图形工具包吗？它真的有益还是我认为这件事颠倒了？

我期待的好处：

我可以使用 jquery 来拥有许多使用 wxpython 或其他 GUI 工具包创建可能需要大量时间的功能。例如，如果我想拥有类似于 jquery 的自动完成功能，那么在 wxpython 等 GUI 工具包中会有很多不同的故事。而且，很多拖放功能在 html 中很容易实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T15:15:38.043

是的——那么这只是一个 Web 应用程序，而不是本机应用程序。

优点包括可移植性（假设您可以在任何设置上运行 python 代码——不确定您的应用程序的目的是什么）并且不处理讨厌的布局问题和 TK 事件等。

然而，你也在极大地改变你编程的范式。根据您的目标，这可能无关紧要。

至于使用网络框架：

在最简单的情况下，您可以在 CGI 下运行一组 python 脚本。或者你可以得到一个带有数据库抽象层（DAL/ORM）的 MVC 框架，比如 django 或 web2py。

如果您想快速启动并运行，我建议您使用 web2py - 安装简单，并带有内置服务器，因此您无需设置 apache 实例并弄乱 Proxying 或 mod_wsgi 或所有这些优点。

如果您有一段时间没有标记网页，您绝对应该去 w3c ( [http://www.w3schools.com/ ) 并复习 CSS/HTML。](http://www.w3schools.com/)

但是是的——web2py 将允许你运行任何 python 模块/包，尽管你必须学习处理客户端-服务器模型并意识到客户端事件必须在 javascript 中处理，而 python 代码只能在服务器，然后仅来自请求 URI。

简而言之，会有一些“胶水”代码，但这就是 web2py（恕我直言）擅长的。

[http://web2py.com](http://web2py.com) https://www.djangoproject.com/ [http://wiki.python.org/moin/CgiScripts](http://wiki.python.org/moin/CgiScripts)

享受！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T15:58:52.523

你认为完全正确。有很多基于 python 的框架，只要选择正确的一个：pyramid、pylons、django 是最流行和广泛使用的。

我建议您将 HTML/CSS 切片外包给一些专业人士，而不是自己做。您可以面对很多特定于浏览器的事情，这会浪费您的时间，但对于有经验的人来说很明显。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T15:13:27.393

你是对的，但[不要自己动手](http://pyjs.org/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T15:10:12.983

不，你的想法是正确的。HTML/CSS 非常简单，可用于快速开发。此外，python 微框架将使创建业务逻辑变得轻而易举。这是一条非常直接的简单路线。

# android - Android - 使用展开/捏合放大/缩小 RelativeLayout

> ID：10013906
> 
> 赞同：35
> 
> 时间：2012-04-04T15:06:21.800
> 
> 标签：android, android-layout, android-animation

我有一个活动，其中包含一个`RelativeLayout`和一个私有类，它扩展了`SimpleOnScaleGestureListener`. 在`onScale`听众的方法中，我想放大/缩小整个布局（用户看到的一切），用户展开/捏手指。

我希望布局的更改不是永久性的，即当展开/捏合手势结束时，我希望布局回到最初的状态（任何重置都可以`onScaleEnd`在`SimpleOnScaleGestureListener`例如）。

我尝试通过调用`setScaleX`and`setScaleY`以及`RelativeLayout`使用`ScaleAnimation`. 两者都没有导致平滑缩放（或任何可以称为缩放的东西）。甚至可以放大/缩小 a`RelativeLayout`吗？

我剩下的唯一想法是从缓存中读取屏幕截图并将其`ImageView`放在整个布局的顶部，并通过`setImageMatrix`. 但是，我不知道如何实现这一点。

可能布局还包含一个片段容器，该容器在应该可以缩放时是空的。在`onScaleEnd`手势中，片段被放入它的容器中（已经实现并且工作正常）。这是我的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/layout_pinch"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#ffffff" >   

<!-- Layout containing the thumbnail ImageViews -->
<LinearLayout
    android:id="@+id/thumbnail_group_pui"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:orientation="horizontal" >

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c1"/>

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c2"/>

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c3"/>

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c4"/>

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c5"/>

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c6"/>

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/tn_c7"/>

</LinearLayout>

<!-- Layout containing the dashed boxes -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="152dp"
    android:layout_centerVertical="true"
    android:orientation="horizontal" >

    <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

   <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

   <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

   <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

   <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

   <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

   <ImageView
        android:layout_width="177dp"
        android:layout_height="match_parent"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"
        android:background="@drawable/dashed_box"/>

</LinearLayout>

<!-- Container for the fragments -->
<FrameLayout
    android:id="@+id/fragment_container_pui"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />

</RelativeLayout> 
```

**编辑** 我发现了这两个相关主题：
[扩展RelativeLayout，并覆盖dispatchDraw() 在RelativeLayout 中创建可缩放的ViewGroup](https://stackoverflow.com/questions/6378904/extending-relativelayout-and-overriding-dispatchdraw-to-create-a-zoomable-vie)
[缩放内容](https://stackoverflow.com/questions/9192424/zoom-content-in-a-relativelayout)

但是，我没有得到实施。我必须在扩展类中包含哪些其他方法才能实际缩放布局或重置布局？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-05T13:14:52.970

因此，我创建了`RelativeLayout`上述主题中描述的子类。它看起来像这样：

```
public class ZoomableRelativeLayout extends RelativeLayout {
float mScaleFactor = 1;
float mPivotX;
float mPivotY;

public ZoomableRelativeLayout(Context context) {
    super(context);
    // TODO Auto-generated constructor stub
}

public ZoomableRelativeLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
    // TODO Auto-generated constructor stub
}

public ZoomableRelativeLayout(Context context, AttributeSet attrs,
        int defStyle) {
    super(context, attrs, defStyle);
    // TODO Auto-generated constructor stub
}

protected void dispatchDraw(Canvas canvas) {
    canvas.save(Canvas.MATRIX_SAVE_FLAG);
    canvas.scale(mScaleFactor, mScaleFactor, mPivotX, mPivotY);
    super.dispatchDraw(canvas);
    canvas.restore();
}

public void scale(float scaleFactor, float pivotX, float pivotY) {
    mScaleFactor = scaleFactor;
    mPivotX = pivotX;
    mPivotY = pivotY;
    this.invalidate();
}

public void restore() {
    mScaleFactor = 1;
    this.invalidate();
}

} 
```

我的实现`SimpleOnScaleGestureListener`如下所示：

```
private class OnPinchListener extends SimpleOnScaleGestureListener {

    float startingSpan; 
    float endSpan;
    float startFocusX;
    float startFocusY;

    public boolean onScaleBegin(ScaleGestureDetector detector) {
        startingSpan = detector.getCurrentSpan();
        startFocusX = detector.getFocusX();
        startFocusY = detector.getFocusY();
        return true;
    }

    public boolean onScale(ScaleGestureDetector detector) {
        mZoomableRelativeLayout.scale(detector.getCurrentSpan()/startingSpan, startFocusX, startFocusY);
        return true;
    }

    public void onScaleEnd(ScaleGestureDetector detector) {
        mZoomableRelativeLayout.restore();
    }
} 
```

希望这可以帮助！

## 更新：

您可以使用以下方式`OnPinchListener`为您集成：`ZoomableRelativelayout``ScaleGestureDetector`

```
ScaleGestureDetector scaleGestureDetector = new ScaleGestureDetector(this, new OnPinchListener()); 
```

并且需要将 Zoomable 布局的触摸监听器与 ScaleGestureDetector 的触摸监听器绑定：

```
mZoomableLayout.setOnTouchListener(new OnTouchListener() {

                @Override
                public boolean onTouch(View v, MotionEvent event) {
                    // TODO Auto-generated method stub
                    scaleGestureDetector.onTouchEvent(event);
                    return true;
                }
            }); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-08-08T09:49:16.913

创建名为 Zoomlayout 的类，它扩展了您想要放大的任何布局，在我的情况下它是相对布局。

```
public class ZoomLayout extends RelativeLayout implements ScaleGestureDetector.OnScaleGestureListener {

private enum Mode {
   NONE,
   DRAG,
   ZOOM
 }

 private static final String TAG = "ZoomLayout";
 private static final float MIN_ZOOM = 1.0f;
 private static final float MAX_ZOOM = 4.0f;

 private Mode mode = Mode.NONE;
 private float scale = 1.0f;
 private float lastScaleFactor = 0f;

 // Where the finger first  touches the screen
 private float startX = 0f;
 private float startY = 0f;

 // How much to translate the canvas
 private float dx = 0f;
 private float dy = 0f;
 private float prevDx = 0f;
 private float prevDy = 0f;

 public ZoomLayout(Context context) {
   super(context);
   init(context);
 }

 public ZoomLayout(Context context, AttributeSet attrs) {
   super(context, attrs);
   init(context);
 }

 public ZoomLayout(Context context, AttributeSet attrs, int defStyle) {
   super(context, attrs, defStyle);
   init(context);
 }

 public void init(Context context) {
   final ScaleGestureDetector scaleDetector = new ScaleGestureDetector(context, this);
   this.setOnTouchListener(new OnTouchListener() {
     @Override
     public boolean onTouch(View view, MotionEvent motionEvent) {
       switch (motionEvent.getAction() & MotionEvent.ACTION_MASK) {
         case MotionEvent.ACTION_DOWN:
           Log.i(TAG, "DOWN");
           if (scale > MIN_ZOOM) {
             mode = Mode.DRAG;
             startX = motionEvent.getX() - prevDx;
             startY = motionEvent.getY() - prevDy;
           }
           break;
         case MotionEvent.ACTION_MOVE:
           if (mode == Mode.DRAG) {
             dx = motionEvent.getX() - startX;
             dy = motionEvent.getY() - startY;
           }
           break;
         case MotionEvent.ACTION_POINTER_DOWN:
           mode = Mode.ZOOM;
           break;
         case MotionEvent.ACTION_POINTER_UP:
           mode = Mode.DRAG;
           break;
         case MotionEvent.ACTION_UP:
           Log.i(TAG, "UP");
           mode = Mode.NONE;
           prevDx = dx;
           prevDy = dy;
           break;
       }
       scaleDetector.onTouchEvent(motionEvent);

       if ((mode == Mode.DRAG && scale >= MIN_ZOOM) || mode == Mode.ZOOM) {
         getParent().requestDisallowInterceptTouchEvent(true);
         float maxDx = (child().getWidth() - (child().getWidth() / scale)) / 2 * scale;
         float maxDy = (child().getHeight() - (child().getHeight() / scale))/ 2 * scale;
         dx = Math.min(Math.max(dx, -maxDx), maxDx);
         dy = Math.min(Math.max(dy, -maxDy), maxDy);
         Log.i(TAG, "Width: " + child().getWidth() + ", scale " + scale + ", dx " + dx
           + ", max " + maxDx);
         applyScaleAndTranslation();
       }

       return true;
     }
   });
 }

 // ScaleGestureDetector

 @Override
 public boolean onScaleBegin(ScaleGestureDetector scaleDetector) {
   Log.i(TAG, "onScaleBegin");
   return true;
 }

 @Override
 public boolean onScale(ScaleGestureDetector scaleDetector) {
   float scaleFactor = scaleDetector.getScaleFactor();
   Log.i(TAG, "onScale" + scaleFactor);
   if (lastScaleFactor == 0 || (Math.signum(scaleFactor) == Math.signum(lastScaleFactor))) {
     scale *= scaleFactor;
     scale = Math.max(MIN_ZOOM, Math.min(scale, MAX_ZOOM));
     lastScaleFactor = scaleFactor;
   } else {
     lastScaleFactor = 0;
   }
   return true;
 }

 @Override
 public void onScaleEnd(ScaleGestureDetector scaleDetector) {
   Log.i(TAG, "onScaleEnd");
 }

 private void applyScaleAndTranslation() {
   child().setScaleX(scale);
   child().setScaleY(scale);
   child().setTranslationX(dx);
   child().setTranslationY(dy);
 }

 private View child() {
   return getChildAt(0);
 }

} 
```

在此之后，在只有一个孩子的 xml 中添加 ZoomLayout。例如

```
<?xml version="1.0" encoding="utf-8"?>
<com.focusmedica.digitalatlas.headandneck.ZoomLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:id="@+id/zoomLayout"
    android:background="#000000"
    android:layout_height="match_parent">

<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent">

<TextView
    android:paddingTop="5dp"
    android:textColor="#ffffff"
    android:text="Heading"
    android:gravity="center"
    android:textAlignment="textStart"
    android:paddingLeft="5dp"
    android:textSize="20sp"
    android:textStyle="bold"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/tvSubtitle2"
    android:layout_toLeftOf="@+id/ivOn"
    android:layout_alignParentLeft="true"
    android:layout_alignParentStart="true" />

<ImageView
    android:id="@+id/ivOff"
    android:layout_width="40dp"
    android:layout_height="40dp"
    android:src="@drawable/off_txt"
    android:layout_alignParentTop="true"
    android:layout_alignParentRight="true"
    android:layout_alignParentEnd="true" />

<ImageView
    android:id="@+id/ivOn"
    android:layout_width="40dp"
    android:layout_height="40dp"
    android:src="@drawable/on_txt"
    android:layout_alignParentTop="true"
    android:layout_alignLeft="@+id/pinOn"
    android:layout_alignStart="@+id/pinOn" />

<ImageView
    android:id="@+id/pinOff"
    android:visibility="invisible"
    android:layout_width="40dp"
    android:layout_height="40dp"
    android:src="@drawable/pin_off"
    android:layout_alignParentTop="true"
    android:layout_alignParentRight="true"
    android:layout_alignParentEnd="true" />

<ImageView
    android:id="@+id/pinOn"
    android:layout_width="40dp"
    android:layout_height="40dp"
    android:src="@drawable/pin_on"
    android:layout_alignParentTop="true"
    android:layout_toLeftOf="@+id/ivOff"
    android:layout_toStartOf="@+id/ivOff" />

<RelativeLayout
    android:id="@+id/linear"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true">

<ImageView
    android:src="@drawable/wait"
    android:layout_width="match_parent"
    android:layout_height="300dp"
    android:id="@+id/fullIVideo"/>

    <ImageView
        android:src="@drawable/wait"
        android:layout_width="match_parent"
        android:layout_height="300dp"
        android:id="@+id/colorCode"/>

    <ImageView
        android:src="@drawable/wait"
        android:layout_width="match_parent"
        android:layout_height="300dp"
        android:id="@+id/labelText"/>

<ImageView
    android:src="@drawable/download"
    android:layout_marginTop="91dp"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:id="@+id/label_play"
    android:layout_alignTop="@+id/fullIVideo"
    android:layout_centerVertical="true"
    android:layout_centerHorizontal="true" />
    </RelativeLayout>

<LinearLayout
    android:orientation="vertical"
    android:id="@+id/custom_toast_layout"
    android:layout_width="300dp"
    android:layout_above="@+id/up"
    android:background="@drawable/rectangle_frame"
    android:paddingLeft="10dp"
    android:paddingBottom="10dp"
    android:paddingTop="10dp"
    android:paddingRight="10dp"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:layout_height="wrap_content">

    <TextView
        android:textSize="15sp"
        android:textColor="#ffffff"
        android:layout_gravity="center"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Medium Text"
        android:id="@+id/tvLabel" />

    <TextView
        android:textColor="#ffffff"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="5dp"
        android:text="New Text"
        android:layout_gravity="center"
        android:id="@+id/tvLabelDescription" />
</LinearLayout>

<ImageView
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:src="@drawable/up"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:id="@+id/up" />
    </RelativeLayout>
</com.focusmedica.digitalatlas.headandneck.ZoomLayout> 
```

现在在 MainActivity 创建 ZoomLayout 对象并定义 id.Like

```
ZoomLayout zoomlayout= findViewbyId(R.id.zoomLayout);
zoomlayout.setOnTouchListener(FullScreenVideoActivity.this);
 public boolean onTouch(View v, MotionEvent event) {
     linear.init(FullScreenVideoActivity.this);
     return false;
 } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-11-05T22:02:45.230

我想我设法稍微改进了 Schnodahipfe 的答案。我向 ZoomableRelativeLayout 类添加了两个方法。

```
public void relativeScale(float scaleFactor, float pivotX, float pivotY)
{
    mScaleFactor *= scaleFactor;

    if(scaleFactor >= 1)
    {
        mPivotX = mPivotX + (pivotX - mPivotX) * (1 - 1 / scaleFactor);
        mPivotY = mPivotY + (pivotY - mPivotY) * (1 - 1 / scaleFactor);
    }
    else
    {
        pivotX = getWidth()/2;
        pivotY = getHeight()/2;

        mPivotX = mPivotX + (pivotX - mPivotX) * (1 - scaleFactor);
        mPivotY = mPivotY + (pivotY - mPivotY) * (1 - scaleFactor);
    }

    this.invalidate();
}

public void release()
{
    if(mScaleFactor < MIN_SCALE)
    {
        final float startScaleFactor = mScaleFactor;

        Animation a = new Animation()
        {
            @Override
            protected void applyTransformation(float interpolatedTime, Transformation t)
            {
                scale(startScaleFactor + (MIN_SCALE - startScaleFactor)*interpolatedTime,mPivotX,mPivotY);
            }
        };

        a.setDuration(300);
        startAnimation(a);
    }
    else if(mScaleFactor > MAX_SCALE)
    {
        final float startScaleFactor = mScaleFactor;

        Animation a = new Animation()
        {
            @Override
            protected void applyTransformation(float interpolatedTime, Transformation t)
            {
                scale(startScaleFactor + (MAX_SCALE - startScaleFactor)*interpolatedTime,mPivotX,mPivotY);
            }
        };

        a.setDuration(300);
        startAnimation(a);
    }
} 
```

并像这样重写了 OnPinchListener 类

```
private class OnPinchListener extends ScaleGestureDetector.SimpleOnScaleGestureListener
{
    float currentSpan;
    float startFocusX;
    float startFocusY;

    public boolean onScaleBegin(ScaleGestureDetector detector)
    {
        currentSpan = detector.getCurrentSpan();
        startFocusX = detector.getFocusX();
        startFocusY = detector.getFocusY();
        return true;
    }

    public boolean onScale(ScaleGestureDetector detector)
    {
        ZoomableRelativeLayout zoomableRelativeLayout= (ZoomableRelativeLayout) ImageFullScreenActivity.this.findViewById(R.id.imageWrapper);

        zoomableRelativeLayout.relativeScale(detector.getCurrentSpan() / currentSpan, startFocusX, startFocusY);

        currentSpan = detector.getCurrentSpan();

        return true;
    }

    public void onScaleEnd(ScaleGestureDetector detector)
    {
        ZoomableRelativeLayout zoomableRelativeLayout= (ZoomableRelativeLayout) ImageFullScreenActivity.this.findViewById(R.id.imageWrapper);

        zoomableRelativeLayout.release();
    }
} 
```

每次触摸事件结束时，原始答案都会重置比例，但是像这样您可以多次放大和缩小。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-11-23T17:13:04.233

对于片段，您只需要传递 getActivity() 而不是 Activity Name

```
final ZoomLayout zoomlayout = (ZoomLayout) findViewById(R.id.zoomLayout);
    zoomlayout.setOnTouchListener(new View.OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            zoomlayout.init(getActivity());
            return false;
        }
    }); 
```

# jquery-plugins - 获取用户在 iPad 上滚动的方向（上/下）（touchmove 事件）

> ID：10013910
> 
> 赞同：0
> 
> 时间：2012-04-04T15:06:32.970
> 
> 标签：jquery-plugins, touch, gesture, jquery

我有以下情况：

我有一个绑定到鼠标滚轮事件的代码

```
$('#main').bind("mousewheel",function(ev, delta) {
    ev.preventDefault();
    if(delta == '-1') {
        alert("The user is trying to scroll upwards");
    } else {
        alert("The user is trying to scroll down");
    }
}); 
```

然后我包含了这个[插件](http://furf.com/exp/touch-punch/)，它提供了 Iphone/Ipad 触摸事件的使用。
看下面的代码：

```
$('#main').bind('touchmove', function(event) {
    ev.preventDefault();
}); 
```

我想提醒用户滚动的方向。我怎样才能做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T06:49:31.233

尝试使用这个很棒的库。

```
jQuery('#swipe').bind('swipeup',eventHandler);
jQuery('#swipe').bind('swipedown',eventHandler); 
```

更多信息：http: [//jgestures.codeplex.com/](http://jgestures.codeplex.com/)

# objective-c - 检查 LXSOCKET (iphone) 中的最后一个错误

> ID：10013912
> 
> 赞同：0
> 
> 时间：2012-04-04T15:06:45.713
> 
> 标签：objective-c, c

嗨，我在 iPhone 中使用 lxscoket 为 iPhone 创建套接字。但是在这里我找不到发生的最后一个错误。我正在尝试使用 [err code] 来查找错误，但它没有给出错误。所以任何人都可以在这方面指导我......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T05:18:10.697

使用`errno`现在`<sys/errno.h>`我们可以找到最后一个错误。

# json - 您使用 JSON 进行日志记录吗？

> ID：10013916
> 
> 赞同：3
> 
> 时间：2012-04-04T15:06:50.050
> 
> 标签：json, logging, nlog

我看到人们谈论登录 JSON，例如这篇[文章](http://blog.nodejs.org/2012/03/28/service-logging-in-json-with-bunyan/)，但我实际上从未尝试过。我相信 JSON 格式的日志文件更容易加载到日志数据库中进行离线分析。

有人试过吗？或者更具体地说，任何人都尝试过 NLog（我在 NLog 配置文档中看到了一个 jsonEncode 属性）。

# c# - RNGCryptoServiceProvider 不会为相同的 PWD、Salt、Iteration 组合生成相同的哈希

> ID：10013918
> 
> 赞同：4
> 
> 时间：2012-04-04T15:06:54.217
> 
> 标签：c#, cryptography, hash, pbkdf2

Oki 所以我想通过在 .Net 中附加随机盐来散列我的密码。我为此目的使用的内置类是**RNGCryptoServiceProvider** - 生成随机盐和**Rfc2898DeriveBytes** - 散列实际密码。

但是当我为密码字符串、SaltBytes 和迭代计数的相同组合调用 Rfc2898DeriveBytes 的 GetBytes() 函数时，结果是不同的。我正在粘贴我的代码以供参考

```
 public class PBKDF2Implementation
    {
        int minSaltSize = 32;
        int maxSaltSize = 64;

        public string CreateHash(string plainText , out string  salt)
        {
            Random random = new Random();
            int saltSize = random.Next(minSaltSize, maxSaltSize);

            // Allocate a byte array, which will hold the salt.
            byte[] saltBytes = new byte[saltSize];

            // Initialize a random number generator.
            RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
            // Fill the salt with cryptographically strong byte values.
            rng.GetNonZeroBytes(saltBytes);

            string strSalt = System.Text.Encoding.ASCII.GetString(saltBytes);
            //string strSalt = System.Convert.ToBase64String(saltBytes);
            salt = strSalt;

            Console.WriteLine(saltBytes.Count());
            Console.WriteLine(strSalt);

            Rfc2898DeriveBytes pwdGen = new Rfc2898DeriveBytes(plainText, saltBytes, 1000);

            // generate an RC2 key
            byte[] key = pwdGen.GetBytes(32);

            Console.WriteLine(System.Convert.ToBase64String(key));
            return System.Convert.ToBase64String(key);
        }

        public bool CompareHash(string plainText, string salt, string hashValue)
        {

            byte[] saltBytes = System.Text.Encoding.ASCII.GetBytes(salt);
            //byte[] saltBytes = System.Convert.FromBase64String(salt);

            Console.WriteLine(saltBytes.Count());
            Console.WriteLine(System.Text.Encoding.ASCII.GetString(saltBytes));

            Rfc2898DeriveBytes pwdGen = new Rfc2898DeriveBytes(plainText, saltBytes, 1000);

            // generate an RC2 key
            byte[] key = pwdGen.GetBytes(32);

            Console.WriteLine(System.Convert.ToBase64String(key));
            return System.Convert.ToBase64String(key) == hashValue;
        }
    } 
```

在我的测试课中，我有这个功能

```
 [Test]
    public void shouldGenerateConsistentHash()
    {
        PBKDF2Implementation cPbkdf2Implementation = new PBKDF2Implementation();
        string salt;
        string hashValue = cPbkdf2Implementation.CreateHash("password", out salt);

        bool result = cPbkdf2Implementation.CompareHash("password", salt, hashValue);
        Assert.IsTrue(result) ;
    } 
```

测试失败。
但是，如果在上面的类 PBKDF2Implementation 中，如果我将 System.Text.Encoding.ASCII.GetString 行替换为 System.Text.Encoding.Unicode.GetString 并将 System.Text.Encoding.ASCII.GetBytes 替换为 System.Text.Encoding.Unicode。获取字节

测试通过。知道为什么会这样吗？我想让它与 ASCII 编码一起工作的原因是因为存储此哈希值的同一数据库也将被 PHP 应用程序使用，并且 PHP 的 PBKDF2 实现产生的哈希值仅在盐编码为时才与 Rfc2898DeriveBytes 的哈希值匹配ASCII。

这是相同 [http://www.php.net/manual/en/function.hash-hmac.php#101540的 PHP 实现](http://www.php.net/manual/en/function.hash-hmac.php#101540)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T15:46:35.257

1.  避免使用带加密的字符串。使用字节数组，即`byte[]`
2.  如果您必须使用字符串，请**注意**编码。他们会在 10 次中咬你 9 次；

例如

```
byte [] data = new byte [] { 65, 0, 65 };
var s = System.Text.Encoding.ASCII.GetString (data); 
```

什么是`s`价值？

答案：“A”

如果你`byte[]`从同一个字符串中查询出来，你会得到：`byte [1] { 65 }`，这与原始字符串不同，并且不适用于大多数加密用法。

Base64 更安全，因为它将保持每个字节完整。

# c# - StreamReader system.stackoverlow 异常

> ID：10013922
> 
> 赞同：0
> 
> 时间：2012-04-04T15:07:00.060
> 
> 标签：c#, stack-overflow, streamreader

我正在生成一个文件流并将其包装在缓冲流阅读器中。然后我用读取线一次消耗一条流。在 X 行/字节数之后，我遇到了堆栈溢出异常。递归调用方法似乎不是问题，因为它可以毫无问题地处理较小的文件。我希望我在这里忽略了一些简单的事情。在这里发布整个片段有很多逻辑，但这是要点......

```
Instantiates a static stream reader //
{    
    using (FileStream fs = File.Open(filename, FileMode.Open, FileAccess.Read,
    FileShare.Read))
    using (BufferedStream bs = new BufferedStream(fs))
    using (reader = new StreamReader(bs))

     InitializeRecord(reader) // passes reader in
}

InitializeRecord(StreamReader reader)
{  
    //Makes some determinations whether to take in the first line or skip to first    header record... This is working fine. Initializes first line = reader.ReadLine()
    // Calls the first method to generate the header output which in turns calls the LineReader Method to consume the next line.
}

LineReader()
{ // Main loop for iterating over lines where stackoverflow occurs
    while (!reader.EndOfStream)
    {
        string prev_line = line;
        line = reader.ReadLine(); // StackOverFlow occurs here only on larger files / # of bytes read        
        VerifyLine(line,prev_line);
    }
}

VerifyLine(string line)
{ 
    // Does some checking on the line and calls output methods for each record type which in turn calls LineReader which LineReader exits when the endofstream is reached. 
    //But is blowing up prior to reaching the end of the stream.  By writing the lines out to disk as it iterates it writes a replica of the stream perfectly until the stack overflow occurs. 
    //This is only the difference of anything greater than a 5 MB file. Some of these records are hitting 9 million characters. I tried increasing the buffer size without luck.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:35:42.830

> 递归调用方法似乎不是问题，因为它可以毫无问题地处理较小的文件

但是您是说它会在更大的文件上爆炸，对吗？对我来说，这听起来像是你的递归有问题。反正有没有递归执行你的操作？我想在 verifyLine 方法中看到更多代码。

# android - Android API-Demos 中的 Compass 有错误吗？

> ID：10013925
> 
> 赞同：0
> 
> 时间：2012-04-04T15:07:05.167
> 
> 标签：android, api, sample, android-sensors, coordinate-systems

我最近在 Androids 4.0 API-Demos 中试用了 Compass。只要您将手机保持在纵向模式，它就可以工作，但是一旦您将其置于横向模式，“北方”就会指向与以前不同的方向。我以为[这里](http://developer.android.com/reference/android/hardware/SensorEvent.html)已经明确说明了

> 坐标系是相对于手机屏幕在其默认方向上定义的。当设备的屏幕方向改变时，轴不会交换。

但这正是发生的事情！

为什么指南针指向错误的方向？上述陈述是不真实的，还是只是 API 样本计算数据中的一个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T15:30:10.550

指南针演示确实不完整。在屏幕上绘制指南针时需要考虑设备方向。请查看此[问题](https://stackoverflow.com/questions/4819626/android-phone-orientation-overview-including-compass)以获取更多详细信息。

[这](https://groups.google.com/forum/#!msg/android-beginners/V4pOfLn8klQ/mdL-Wh5A7tIJ)也是一个很好的主题讨论。

我的[github](https://github.com/renard314/QuestCompass)上还有一个工作示例，您可以使用。（这里的代码太多了）相关的类是 CompassSensorListener.java 和 CompassHelper.java。

干杯

# algorithm - 以最少的步骤转换为正确的后缀表示法

> ID：10013933
> 
> 赞同：3
> 
> 时间：2012-04-04T15:07:29.607
> 
> 标签：algorithm, postfix-notation

由操作数和二元运算符组成的表达式可以用逆波兰表示法 (RPN) 编写，方法是在运算符后面写两个操作数。例如，3 + (4 * 5) 可以写成“3 4 5 * +”。

你得到一个由 x 和 * 组成的字符串。x 表示操作数，* 表示二元运算符。很容易看出，并非所有此类字符串都代表有效的 RPN 表达式。例如，“x*x”不是有效的 RPN 表达式，而“xx*”和“xxx**”是有效的表达式。将给定字符串转换为有效 RPN 表达式所需的最少插入、删除和替换操作数是多少？

输入：第一行包含测试用例 T 的数量。接下来是 T 测试用例。每个 case 都包含一个仅由字符 x 和 * 组成的字符串。

输出：输出 T 行，每个测试用例包含所需的最少操作数。

约束：1 <= T <= 100 输入字符串的长度最多为 100。

样本输入：

```
5
x
xx*
xxx**
*xx
xx*xx** 
```

样本输出：

```
0
0
0
2
0 
```

解释：

对于前三种情况，输入表达式已经是有效的RPN，所以答案是0。对于第四种情况，我们可以进行一次删除，一次插入操作：xx -> xx -> xx

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:31:10.540

这是一个异常大的答案。如果还存在一个优雅的两班轮，我不会感到惊讶，但直到那一个被张贴在这里是我的。

假设您有一个简单的 2D 图，其中 x 轴表示解析步骤，y 轴表示当前 X 和星数之间的差异，n(x)-n(*)。例如，对于输入`xx*xx**`，图表将是这样的：

```
╫
╫         +
╫   +   +   +
╫ +   +       +
╬═╧═╧═╧═╧═╧═╧═╧
  x x * x x * * 
```

为了使表达式有效，此图在 y 轴上不得达到零或低于零，并且最后 y 的值必须为 1（堆栈上的单个值）。

为您提供了三个用于输入表达式的操作：插入、删除和替换。这个替换操作实际上是两者之一：用*替换x，用x替换*。当您在表达式中间的某处应用插入或删除时，图形会发生变化，以便从该点开始，图形中的所有点都会向上或向下移动。应用替换时，点会在图中向上或向下移动两个槽口。一个有趣的注意事项：我们不必处理删除操作，因为结果与应用相反的插入相同，不同之处在于插入可以始终应用，只有在有可用符号时才删除。

您的目标是找到最少数量的操作。如果我们只观察最终目标（y = 1），那么我们将确定我们必须移动图形并应用尽可能多的替换操作和一个额外的插入操作的缺口数。如果 N(x)-N(*) 的总和为 N，则操作数将为 floor((N-1)/2)。该符号确定要应用哪些操作。

问题是我们必须注意另一个条件，即图形永远不能达到零。为了确定这一点，我们必须首先对我们的表达式应用先前的操作。'Insert x' 添加在开头，'insert *' 出现在末尾，从开头搜索并用 x 替换每个 *，从结尾向后搜索并用 * 替换每个 x。

在这一步之后，我们有了新的表达方式。从头开始迭代并寻找 y=0 的地方。如果有这样的地方，那么你必须在它之前插入一个 x，并在表达式末尾插入一个 * 作为补偿。但请记住，您可能已经这样做了（在开头插入 x，或在结尾插入 *）。如果你有两个插入 x，那么假装它实际上是用 x 替换 *（少一个操作），而忘记必须插入 x。与一对插入 * 类似：删除两个插入 *，然后再应用一个“将 x 替换为 *”。您确实必须应用它，即更改表达式，因为如果从 end 搜索时找到的 x 实际上在您当前位置之前，那么您不能应用替换，因此不能将两个插入操作压缩为一个替换。

继续迭代直到结束，计算额外的操作，并且始终牢记您是否有一个插入 x 和一个插入 *。应该是这样的。最后，您将进行许多操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T04:59:41.240

公共类 RPN {

```
public static boolean isValidRPN(String expr){

    char arr[] = expr.toCharArray();
    int x = 0;

    for(char c: arr){

        if ( c == 'x'){
            x++;
        }
        else if ( c == '*'){

            if ( x >= 2){
                x--;
            }
            else {
                return false;
            }
        }
    }

    if ( x == 1){
        return true;
    }

    return false;
}

//Think of RPN recursively as x(RPN)*
//The remaining code is self explanatory
private static int computeToRPN(String expr){

    int length = expr.length();

    if ( length == 1 ){
       if (expr.equals("x")){
           return 0;
       }
       else if ( expr.equals("*")){
           return 1;
       }
    }

    if ( length == 2){

        if ( expr.equals("xx") || expr.equals("*x") || expr.equals("x*")){
            return 1;
        }
        else if ( expr.equals("**")){
            return 2;
        }
    }

    char startChar = expr.charAt(0);
    char endChar = expr.charAt(expr.length()-1);

    if ( startChar == 'x' ){

        if ( endChar == 'x'){
            return 1 + compute2RPN(expr.substring(1,length-1));
        }
        else if ( endChar == '*'){
            return compute2RPN(expr.substring(1,length-1));
        }
    }

    return 2 + compute2RPN(expr.substring(1, length-1));

}

public static int compute2RPN(String expr){

    if ( isValidRPN(expr) ) return 0;
    else return computeToRPN(expr);

}

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub
    System.out.println(compute2RPN("xx*"));
    System.out.println(compute2RPN("xxx**"));
    System.out.println(compute2RPN("xxxx"));
    System.out.println(compute2RPN("*xx"));
    System.out.println(compute2RPN("xxxx*"));
    System.out.println(compute2RPN("**xx"));
    System.out.println(compute2RPN("xx*xx**"));

} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-15T21:07:08.040

好吧，这显然是 SE/SWE/SDE 职位的在线代码测试/挑战问题之一。我个人不喜欢这种风格的问题，因为它们与您的编码/算法/设计能力无关，而是与您之前是否知道“技巧”有关。只要你知道'trick'，它就像helloworld.cpp 一样简单。

所以这里是诀窍：

从 Dialecticus 的帖子来看，有两点非常明显：

1.  在任何时候，如果 X 的数量为 n，则最多应该有 (n-1) 个*s。
2.  * 的最终数量应完全等于 X 的数量减一。

因此，您的程序应该将无效字符串转换为满足这两个条件的字符串（我跳过了检查字符串是否有效的部分）。此外，应尽量减少转换次数。那么如何最小化呢？

以下是一些观察结果（假设字符串的长度大于 2，否则它是微不足道的）：

1.  如果我们只想满足条件 2.，我们只需要替换几次加上最多一次插入。因为如果 n(X)>n(*)+1，则将 X 更改为 *，反之亦然。最后，如果字符串的长度是偶数，则只需再插入一个 X（或 *）。

2.  如果同时您想满足标准 1.，您仍然只需要多次替换和一次插入，但位置很重要。我们进一步可以观察到，在字符串的开头用 X 替换 * 并在字符串的末尾用 * 替换 X 总是安全的。同样，很明显，对于一个有效的子串，我们可以将它表示为一个等价的 X。

从上面的观察，现在很清楚，这个问题可以很容易地通过动态规划来解决。

所以这个问题其实和你的算法/设计能力没有关系（其实因为规模很小，1<=T<=100，如果你愿意，你甚至可以通过蛮力解决）只要你知道你只能做更换，最多插入一次。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-13T06:16:57.203

导入 java.util.HashSet；导入 java.util.Set；导入 java.util.Stack；

导入 org.apache.commons.lang3.mutable.MutableInt；

公共类 ProperRPNConversion {

```
public static final char X='x';
public static final char S='*';

public static boolean isRPN(String string)
{
    char[] str=string.toCharArray();
    int count=0;
    Stack stack=new Stack();

    for(char c:str)
    {
        if(c==X)
            stack.push(c);
        else
        {
            if(stack.size()>=2)
            {
                if(((Character)stack.peek())==X)
                {
                    stack.pop();
                }
                else
                    return false;
                if(((Character)stack.peek())==X)
                {
                    stack.pop();
                }
                else
                    return false;
                stack.push(X);

            }
            else
                return false;

        }
    }

    if(stack.size()==1&&(Character)stack.peek()==X)
        return true;

    return false;

}

public static int convertToRPNSteps(String s)
{
    Set<String> curLevel=new HashSet<String>();
    Set<String> nextLevel=new HashSet<String>();
    char[] ss=s.toCharArray();
    curLevel.add(s);
    int minsteps=0;

    if(isRPN(s))
        return minsteps;

    while(curLevel.size()!=0)
    {
        minsteps++;
        for(String str:curLevel)
        {
            //delete
            int lenss=str.length();
            for(int i=0;i<lenss;i++)
            {
                String newstr=new StringBuffer(str).delete(i, i+1).toString();
                if(isRPN(newstr))
                {
                    System.out.println(s);
                    System.out.println(newstr);
                    return minsteps;
                }
                nextLevel.add(newstr);
            }
            //insert
            for(int i=0;i<=lenss;i++)
            {
                //System.out.println(i);
                //System.out.println(s);
                //System.out.println(lenss);
                String newstr=new StringBuffer(str).insert(i, X).toString();
                if(isRPN(newstr))
                {
                    System.out.println(s);
                    System.out.println(newstr);
                    return minsteps;
                }
                nextLevel.add(new StringBuffer(str).insert(i, X).toString());
                String newstr2=new StringBuffer(str).insert(i, X).toString();
                if(isRPN(newstr2))
                    return minsteps;
                nextLevel.add(newstr2);
            }

            //replace
            for(int i=0;i<lenss;i++)
            {
                StringBuffer b=new StringBuffer(str);
                if(ss[i]==X)
                    b.setCharAt(i, S);
                else
                    b.setCharAt(i, X);

                String newstr=b.toString();
                if(isRPN(newstr))
                {
                    System.out.println(s);
                    System.out.println(newstr);
                    return minsteps;
                }
                nextLevel.add(newstr);

            }

        }
        curLevel=nextLevel;
        nextLevel=new HashSet<String>();

    }
    return -1;
}

public static void main(String[] args) {

    System.out.println(convertToRPNSteps("xx*xxxx**xx*x**"));
    System.out.println(convertToRPNSteps("*xx"));

} 
```

}

# c# - 比较两个字典并将字典值添加到另一个字典 C#

> ID：10013938
> 
> 赞同：1
> 
> 时间：2012-04-04T15:07:41.923
> 
> 标签：c#, dictionary, comparison

我正在尝试比较加载的两个字典。每个人都包含一个 ID 和一个个人对象。

到目前为止的代码是

```
 _Individuals1 = file1.fileIndividuals;
        _Individuals2 = file2.fileIndividuals;

        foreach (KeyValuePair<int, Individual> kvpInd in _Individuals1)
        {
            foreach (KeyValuePair<int, Individual> kvpInd2 in _Individuals2)
            {
                if (kvpInd.Value.name.name == kvpInd2.Value.name.name)
                {
                    similarInds.Add(kvpInd.Key, kvpInd.Value);
                }
            }
        } 
```

并且我收到“已添加具有相同密钥的项目”的错误。我可以理解为什么，但我不确定如何以不同的方式进行操作以使其发挥作用。有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:17:38.910

这里的问题是您对不同`Dictionary<TKey, TValue>`实例中的键和值之间的关系有一个错误的假设。多个条目很可能具有不同的键但具有相同的值。如果发生这种情况，`_Individuals2`那么您最终将向字典中添加相同的键两次。考虑

地图1

*   关键1，价值狗

地图2

*   关键 2，价值狗
*   关键 3，价值狗

在这种情况下，Map2 中的多个值具有 Dog 值。所以我最终会根据你的算法基本上执行以下操作

```
// 1:Dog matches 2:Dog
similarInds.Add(1, "Dog");
// 1:Dog matches 3:Dog
similarInds.Add(1, "Dog"); 
```

看起来你想要的只是简单地知道`Individual`两张地图之间相似的对象集。如果是这样，那么只需存储该值并使用 a`Set<Individual>`来防止重复。

```
var similarInds = new HashSet<Individual>();
...

similarInds.Add(kvpInd.Value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:18:57.560

字典中可以有多个具有相同值的条目。您没有做任何事情来检查或比较密钥。

因此，您在 _Individuals2 中有多个具有相同值的条目，尽管它们具有不同的键。

我不知道你在这里做什么，但我认为你的键应该是使每个对象独一无二的东西，它们真的不应该比较值。如果您使用列表或类似的东西，您可以使用 Intersection 方法返回它们的共同点。

或者你可以使用

```
_Individuals1.Values.Intersect(_Individuals2.Values); 
```

此外，在使用泛型时，几乎总是可以覆盖存储在泛型中的对象的相等运算符。然后，您不必执行以下操作：

```
if (kvpInd.Value.name.name == kvpInd2.Value.name.name) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T15:24:14.253

以下是使用 lambda 的方法：

```
var similarInds = file1.fileIndividuals.
Where(kv1 => file2.fileIndividuals.Any(kv2 => kv1.Value.name.name == kv2.Value.name.name)).
ToDictionary(kv => kv.Key, kv => kv.Value); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T15:42:58.830

让我们退后一步。您有两个字典，它们将 Individuals 键入一个整数。但是，您不是在比较相对字典的键，而是比较它们的值。这让我认为键不是唯一的。

听起来你想要的是两个字典的完全外部连接：

*   如果个人仅存在于 File1 中，请使用 File1 中的个人的键和值。
*   同样适用于仅在 File2 中的个人。
*   如果两个文件都包含相同的个人（按名称），则合并记录。

这可以通过一些 Linq 来完成。了解这不是可能的解决方案中性能最高的，但更容易理解正在发生的事情。

```
//get records from 1 that aren't in 2
var left = _Individuals1.Where(l=>!_Individuals2.Any(r=>l.Value.Name == r.Value.Name));
//get records that appear in both 1 and 2, 
//using the select clause to "merge" the data you want from each side
var join = from l in _Individuals1
           join r in _Individuals2 on l.Value.Name equals r.Value.Name
           select new KeyValuePair<int, Individual>(l.Key, r.Value);
//get records from 2 that aren't in 1
var right = _Individuals2.Where(r=>!_Individuals1.Any(l=>l.Value.Name == r.Value.Name));

//Now, the keys from the left and join enumerables should be consistent,
//because we used the keys from _Individuals1 in both of them.
var merged = left.Concat(join).ToDictionary(x=>x.Key, x=>x.Value);

//BUT, keys from records that only existed in 2 may have duplicate keys, 
//so don't trust them
var maxKey = merged.Keys.Max();
foreach(var r in right)
   merged.Add(++maxKey, r.Value); 
```

您可以避免显式创建“左”可枚举，通过构造产生“连接”的查询以产生左连接而不是我展示的内连接。您还可以尝试使用 _Individuals2 中的密钥，方法是根据合并的目录检查每个密钥。该代码如下所示：

```
var maxKey = merged.Keys.Max();
foreach(var r in right)
   if(merged.ContainsKey(r.Key))
      merged.Add(++maxKey, r.Value);
   else
   {
      merged.Add(r.Key, r.Value);
      maxKey = r.Key > maxKey ? r.Key : maxKey;
   } 
```

只要密钥不重复，这将安全地使用来自 _Individuals2 的密钥，因此应该使用来自 _Individuals2 的一些（但可能不是全部）密钥。这是否“更好”取决于具体情况。

# .net - 实体框架：不能将“包含”与另一个对象的属性一起使用

> ID：10013949
> 
> 赞同：3
> 
> 时间：2012-04-04T15:08:13.250
> 
> 标签：.net, linq, entity-framework, linq-to-entities, ef-code-first

抱歉标题不好......这可能最好用一个例子来解释：

```
void Main()
{
    IQueryable<ClassA> toLinkTo = context.ClassAs.Where(a => a.Name == "SomeName");

    var queryToExecute = context.ClassBs.Where(cb => toLinkTo.Select(ca => ca.Id).Contains(cb.Id));

    // This works.
    leafNodesWithExternalChildren.ToList();

    // This doesn't work.
    toLinkTo = new OtherClass(context).LinkedClassAs;
    leafNodesWithExternalChildren.ToList();
}

public class OtherClass
{
    private MyContext m_Context;

    public OtherClass(MyContext ctx)
    {
        this.m_Context = ctx;
    }

    public IQueryable<ClassA> LinkedClassAs
    {
        get
        {
            // Same as toLinkTo as it was originally declared above.
            return this.m_Context.ClassAs.Where(a => a.Name == "SomeName");
        }
    }
} 
```

当在本地声明时如何工作`toLinkTo`，但使用与另一个对象上的属性完全相同`IQueryable`的属性却没有？我得到的例外是：

`Unable to create a constant value of type 'ClassA'. Only primitive types ('such as Int32, String, and Guid') are supported.`

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T16:03:41.800

您的第二个示例也有效 - 如果您将其作为第一个示例：

```
IQueryable<ClassA> toLinkTo = new OtherClass(context).LinkedClassAs;
var queryToExecute = context.ClassBs.Where(cb => toLinkTo.Select(ca => ca.Id)
                                                         .Contains(cb.Id));

// Now, this works.
queryToExecute.ToList();

// Now, this doesn't work.
toLinkTo = context.ClassAs.Where(a => a.Name == "SomeName");
queryToExecute.ToList(); 
```

Somwhow，在第二次尝试中，EF`toLinkTo`预先单独执行查询（好像它会将一个附加`AsEnumerable()`到查询中）以首先在内存中创建对象集合。`queryToExecute`不适用于此集合-如@mellamokb 的回答中所述。在第一次尝试中，查询是作为一个整体执行的，并且不会出现问题。

如果您`queryToExecute2`为第二个示例创建一个新变量，这两个示例都有效：

```
IQueryable<ClassA> toLinkTo = context.ClassAs.Where(a => a.Name == "SomeName");
var queryToExecute = context.ClassBs.Where(cb => toLinkTo.Select(ca => ca.Id)
                                                         .Contains(cb.Id));

// this works.
queryToExecute.ToList();

// And this works too.
toLinkTo = new OtherClass(context).LinkedClassAs;
var queryToExecute2 = context.ClassBs.Where(cb => toLinkTo.Select(ca => ca.Id)
                                                          .Contains(cb.Id));
queryToExecute2.ToList(); 
```

它可能与表达式树的`queryToExecute`构建方式以及它如何使用局部变量`toLinkTo`或 EF 如何评估树的方式有关，但我无法真正理解或解释到底发生了什么。

**编辑**

即使您`toLinkTo`在第二次尝试中使用完全相同的查询也不起作用：

```
IQueryable<ClassA> toLinkTo = context.ClassAs.Where(a => a.Name == "SomeName");
var queryToExecute = context.ClassBs.Where(cb => toLinkTo.Select(ca => ca.Id)
                                                         .Contains(cb.Id));

// this works.
queryToExecute.ToList();

// this doesn't work.
toLinkTo = context.ClassAs.Where(a => a.Name == "SomeName");
queryToExecute.ToList(); 
```

# php - 发布到 Facebook Graph Api 很慢

> ID：10013951
> 
> 赞同：5
> 
> 时间：2012-04-04T15:08:20.897
> 
> 标签：php, facebook, facebook-graph-api, curl, graph

我正在创建一个新的 Facebook 应用程序，并附加了一些操作，例如 Spotify 上的“收听 xxx”。

麻烦的是通话需要大约 6-7 秒，这是相当长的时间。在我的代码下面是 curl_getinfo 的结果。应该这么慢吗？

```
 $attachment = array(
        'access_token' => $access_token,
        'album' => 'sergeant peppers',
    );

    $opts = array(
        CURLOPT_CONNECTTIMEOUT => 10,
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_TIMEOUT => 60,
        CURLOPT_USERAGENT => 'facebook-php-3.1',
        CURLOPT_POST => true,
        CURLOPT_POSTFIELDS => $attachment,
        CURLOPT_URL => 'https://graph.facebook.com/me/APPNAME:listening'
    );
    $ch = curl_init();
    curl_setopt_array($ch, $opts);
    $result = curl_exec($ch);
    $info = curl_getinfo($ch);
    curl_close($ch); 
```

curl_getinfo 的结果：

```
[url] => https://graph.facebook.com/me/APPNAME:listening
[content_type] => text/javascript; charset=UTF-8
[http_code] => 400
[header_size] => 557
[request_size] => 238
[filetime] => -1
[ssl_verify_result] => 0
[redirect_count] => 0
[total_time] => 6.002449
[namelookup_time] => 0.024892
[connect_time] => 0.179322
[pretransfer_time] => 0.77444
[size_upload] => 362
[size_download] => 212
[speed_download] => 35
[speed_upload] => 60
[download_content_length] => 212
[upload_content_length] => 362
[starttransfer_time] => 1.775707
[redirect_time] => 0
[certinfo] => Array
    (
    )

[redirect_url] => 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:33:46.170

好吧，您收到了 http 400 返回（错误请求），这表明出了问题。也许如果您的请求正确，请求会更快？

这篇文章：[facebook api 中的 php cURL 错误](https://stackoverflow.com/questions/6227860/php-curl-error-in-facebook-api) 表示您应该删除 'CURLOPT_POST => true' 如果仍然有问题，我还建议添加 'CURLOPT_VERIFYPEER => false'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T20:58:19.697

**不它不是。** [这个答案](https://stackoverflow.com/a/6409442/517815)更详细地讨论了 Facebook Graph API 的预期时间，尽管它的问题诊断不适用于您的问题。

发现瓶颈的最佳选择是网络诊断，例如[`traceroute`](http://en.wikipedia.org/wiki/Traceroute),[`dig`](http://en.wikipedia.org/wiki/Dig_%28Command%29)和 cURL 的分析功能（如您在此处显示的那样）。如果您在不同的位置有对等点，您还可以尝试从该位置进行分析以查看发生了什么变化。

祝你好运。这是非常热门的信息，但应该足以让您入门。

# spring - 加载使用托管 bean 的 JSF 页面时出现异常

> ID：10013953
> 
> 赞同：-1
> 
> 时间：2012-04-04T15:08:32.420
> 
> 标签：spring, maven, spring-mvc, jsf-2

这是异常和完整的堆栈跟踪。我经历了它，但没有得到实际的问题。提前致谢。

```
com.sun.faces.mgbean.ManagedBeanCreationException: Unable to create managed bean notificationServiceBean.  The following problems were found:
     - Unexpected error processing managed bean notificationTransformerBean
    at com.sun.faces.mgbean.BeanManager.create(BeanManager.java:265)
    at com.sun.faces.el.ManagedBeanELResolver.resolveBean(ManagedBeanELResolver.java:244)
    at com.sun.faces.el.ManagedBeanELResolver.getValue(ManagedBeanELResolver.java:116)
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
    at com.sun.faces.el.ChainAwareVariableResolver.resolveVariable(ChainAwareVariableResolver.java:107)
    at org.springframework.web.jsf.DelegatingVariableResolver.resolveOriginal(DelegatingVariableResolver.java:123)
    at org.springframework.web.jsf.DelegatingVariableResolver.resolveVariable(DelegatingVariableResolver.java:108)
    at com.sun.faces.el.VariableResolverChainWrapper.getValue(VariableResolverChainWrapper.java:115)
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
    at com.sun.el.parser.AstIdentifier.getValue(AstIdentifier.java:103)
    at com.sun.el.parser.AstValue.getTarget(AstValue.java:131)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:221)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at com.sun.faces.facelets.tag.jsf.core.DeclarativeSystemEventListener.processEvent(EventHandler.java:128)
    at javax.faces.component.UIComponent$ComponentSystemEventListenerAdapter.processEvent(UIComponent.java:2508)
    at javax.faces.event.SystemEvent.processListener(SystemEvent.java:106)
    at com.sun.faces.application.ApplicationImpl.processListeners(ApplicationImpl.java:2129)
    at com.sun.faces.application.ApplicationImpl.invokeComponentListenersFor(ApplicationImpl.java:2077)
    at com.sun.faces.application.ApplicationImpl.publishEvent(ApplicationImpl.java:286)
    at com.sun.faces.application.ApplicationImpl.publishEvent(ApplicationImpl.java:244)
    at javax.faces.component.UIComponentBase.encodeBegin(UIComponentBase.java:812)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1754)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1759)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:401)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:558)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1366)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:311)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:101)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:146)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:182)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
    at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:126)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:486)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:973)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:907)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.Dispatcher.forward(Dispatcher.java:271)
    at org.eclipse.jetty.server.Dispatcher.forward(Dispatcher.java:98)
    at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:118)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:486)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:483)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:973)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:907)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
    at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
    at org.eclipse.jetty.server.Server.handle(Server.java:346)
    at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:442)
    at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:924)
    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:582)
    at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:218)
    at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:51)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:586)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:44)
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
    at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
    at java.lang.Thread.run(Thread.java:662) 
```

这是我的堆栈跟踪的“由”部分。实际上，我的 jsf 页面正在调用我的一个名为 notificationServiceBean 的托管 bean 的方法，它将根据某些条件调用我的另一个托管 bean notificationTransformerBean 的方法。

```
Caused by: 
java.lang.NullPointerException
    at java.net.URLEncoder.encode(URLEncoder.java:188)
    at java.net.URLEncoder.encode(URLEncoder.java:154)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:474)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:378)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:848)
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:558)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1366)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:311)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:107)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:64)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:146)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:182)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
    at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:126)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:486)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:973)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:907)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.Dispatcher.forward(Dispatcher.java:271)
    at org.eclipse.jetty.server.Dispatcher.forward(Dispatcher.java:98)
    at com.sun.faces.context.ExternalContextImpl.dispatch(ExternalContextImpl.java:546)
    at javax.faces.context.ExternalContextWrapper.dispatch(ExternalContextWrapper.java:93)
    at com.sun.faces.application.view.JspViewHandlingStrategy.executePageToBuildView(JspViewHandlingStrategy.java:364)
    at com.sun.faces.application.view.JspViewHandlingStrategy.buildView(JspViewHandlingStrategy.java:154)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:100)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:558)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1366)
    at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:126)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:486)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:973)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:907)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.Dispatcher.forward(Dispatcher.java:271)
    at org.eclipse.jetty.server.Dispatcher.error(Dispatcher.java:107)
    at org.eclipse.jetty.servlet.ErrorPageErrorHandler.handle(ErrorPageErrorHandler.java:130)
    at org.eclipse.jetty.server.Response.sendError(Response.java:311)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:571)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:483)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:973)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:907)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
    at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
    at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
    at org.eclipse.jetty.server.Server.handle(Server.java:346)
    at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:442)
    at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:924)
    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:582)
    at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:218)
    at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:51)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:586)
    at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:44)
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
    at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
    at java.lang.Thread.run(Thread.java:662) 
```

这是我的 pom 文件，其中介绍了我们包含的罐子。这两个 bean 之间存在一些问题，而不是 pom 或依赖项。

```
<properties>
        <prettyfaces.version>3.3.2</prettyfaces.version>
        <spring.security.version>3.1.0.RELEASE</spring.security.version>
        <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <jsf.latest.version>2.1.2</jsf.latest.version>
        <org.richfaces.bom.version>4.0.0.Final</org.richfaces.bom.version>
        <netbeans.hint.deploy.server>gfv3ee6</netbeans.hint.deploy.server>
    </properties>
<dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>${jsf.latest.version}</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>${jsf.latest.version}</version>
        </dependency>
<dependency>
            <groupId>org.glassfish</groupId>
            <artifactId>javax.servlet</artifactId>
            <version>3.0</version>
            <scope>provided</scope>
        </dependency>
<dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>${spring.security.version}</version>
            <scope>compile</scope>
            <exclusions>
                <exclusion>
                    <artifactId>spring-core</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-expression</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-acl</artifactId>
            <version>${spring.security.version}</version>
            <exclusions>
                <exclusion>
                    <artifactId>spring-core</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-tx</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-jdbc</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${spring.security.version}</version>
            <exclusions>
                <exclusion>
                    <artifactId>spring-core</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-taglibs</artifactId>
            <version>${spring.security.version}</version>
            <exclusions>
                <exclusion>
                    <artifactId>spring-core</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-tx</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-jdbc</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-expression</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>spring-web</artifactId>
                    <groupId>org.springframework</groupId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency> 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-04-09T05:46:05.843

我重命名了我的对象，并相应地更改了 getter 和 setter 方法下的对象名称，但没有重命名 getter-setter 方法本身。所以在加载托管 bean JSF 时无法创建它。

# ruby-on-rails - 你能让一个模型持有不同类型的订阅吗？

> ID：10013954
> 
> 赞同：0
> 
> 时间：2012-04-04T15:08:37.097
> 
> 标签：ruby-on-rails, ruby-on-rails-3

只有一种模型可以容纳多种不同类型的订阅是否可以？

例如，假设您可以订阅应用程序内的评论、用户、论坛主题和新闻文章。不过，它们都有不同类型的列。这是关联设置的外观。

```
Users
 attr_accessible :name, :role
 has_many :subscriptions
 has_many :comments, :threads, :articles, :through => :subscriptions

Comments
 :content, :rating, :number
 has_many :subscriptions
 has_many :subscribers, :through => :subscriptions, :class_name => 'User'  

Threads
 :title, :type, :main_category
 has_many :subscriptions
 has_many :subscribers, :through => :subscriptions, :class_name => 'User'

Articles
 :news_title, :importance
 has_many :subscriptions
 has_many :subscribers, :through => :subscriptions, :class_name => 'User'

Subscription
 :content, :rating, :number, :name, :role, :title, :type, :main_category, 
 :news_title, :importance, :user_id, :comment_id, :thread_id, :article_id 

 belongs_to :user, :comment, :thread, :article 
```

基本上，使用一种订阅模式，用户可以选择订阅评论、主题或文章，甚至同时订阅所有三者。它可以这样工作吗？一个模型可以容纳所有不同类型的订阅，尤其是当您想要比较属性以执行某些事情（例如为某些用户提供文章）时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:37:41.763

您可以尝试使用多态关联来更普遍地做到这一点：http: [//guides.rubyonrails.org/association_basics.html#polymorphic-associations](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)

例如，

```
Subscription
  :subscriber_id, :subscribable_id, :subscribable_type

  belongs_to :subscriber, :class_name => "User"
  belongs_to :subscribable, :polymorphic => true

User
  has_many :subscriptions

Comment
  has_many :subscriptions, :as => :subscribable

Article
  has_many :subscriptions, :as => :subscribable 
```

然后像这样创建新订阅

```
user.subscriptions.create(:subscribable => article) 
```

并像这样使用它（如果你真的关心类型）

```
user.subscriptions.where(:subscribable_type => "Article").each do |subscription|
   article = subscription.subscribable
   # do stuff with article
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T15:34:43.850

这将是使用多态关系的好地方。

您将comment_id、thread_id、article_id 替换为两列（subscribable_id、subscribable_type），并且您需要将订阅时可订阅的关系定义为多态。

请参阅指南的第 2.9 节：http: [//guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# bugzilla - Bugzilla 将如何在本地 PC 上运行？

> ID：10013958
> 
> 赞同：2
> 
> 时间：2012-04-04T15:08:42.233
> 
> 标签：bugzilla

我在本地系统上安装了 bugzilla 3.6.3 版。当我单击“打开一个新帐户”按钮/链接并输入我的有效电子邮件后，我收到以下错误。

**“从 'bugzilla-daemon@' 向 'myemailaddress@example.com' 发送邮件时出错：无法连接到邮件”**

谁能帮助我如何在本地 PC 上创建用户帐户？

操作系统是 Win 7。我想创建 1 个管理员帐户，一些用户帐户，并通过管理员我想给他们有限或完全访问权限。我还想查看数据库表、修改它们、创建新表等。

本地电脑上可以吗？或者我应该怎么做才能使它成为可能？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T08:16:46.060

现在已经完成了。有一些安装设置我犯了错误。

嗯，有 4 种帐户需要密码字段。

1.  根
2.  错误
3.  管理员（您将使用它来登录）
4.  Windows 用户名和密码。

我的错误是，我没有在第四级给出 Windows 用户名和密码。但是现在当我再次安装它并给出 Windows 用户名和密码时它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-31T03:36:02.220

我来到这里寻找 bugzilla 的无电子邮件服务设置（假设您想在本地服务器上运行自己的 bugzilla 而不发送电子邮件等）。我在[这里](http://vibhurishi.blogspot.com/2009/05/howto-install-bugzilla-on-ubuntu-9.html)按照 linux 的说明进行操作。此后，为了让它在没有电子邮件支持的机器上工作（或者由于某种原因你不希望 bugzilla 发送电子邮件——也许这个 bug db 是私有的），你执行以下操作：

```
$ ./checksetup.pl --make-admin=silly@sillydomain.com
$ ./checksetup.pl --reset-password=silly@sillydomain.com 
```

然后，打开`data/params`并编辑说`mail_delivery_method`to`Test`而不是`SendMail`. 再次运行`./checksetup.pl`以防万一（这需要吗？不完全确定）。

然后，使用浏览器，访问 URL http:///bugzilla，并使用用户名 silly@sillydomain.com 和您在上面第二步中设置的密码登录，您应该可以登录并设置产品/组件名称，创建错误，创建帐户等。

# php - 错字3迁移到新服务器不起作用

> ID：10013959
> 
> 赞同：0
> 
> 时间：2012-04-04T15:08:46.637
> 
> 标签：php, migration, typo3

我试图将typo3网站移动到新服务器。我移动了所有文件并创建了一个新数据库并从旧数据库中导入了所有表。然后我用新的数据库设置更新了 localconf.php 文件。但是，我现在遇到了一系列致命错误，这似乎是因为typo3旧网站中的路径混合使用了大写和小写字母，但在新服务器上，所有文件和文件夹都是小写的，并且正在抛出每当内部路径使用大写字母时出现错误，因为它找不到路径或文件。我不知道这是否是我的主机 1 和 1 所特有的。

有没有简单的方法来解决这个问题，还是我必须通过所有内部代码才能将所有路径更改为小写？这似乎有点不切实际。我希望我能在几个小时内将网站转移过来，但到目前为止已经花了大约一天的时间。我也根本不知道typo3，这是我第一次使用它。尽管我在建立 Drupal 和 Joomla 网站方面经验丰富，并且认为它不会有太大的不同。

任何建议将不胜感激。

本

编辑 - 附加信息：

我收到的错误消息是：

致命错误：require_once() [function.require]: 无法打开所需的 '/htdocs/vincent/typo3conf/ext/formhandler/Resources/PHP/Hooks/class.tx_formhandler_stdwrap.php' (include_path='.:/usr/lib/ php5') 在 /htdocs/vincent/t3lib/class.t3lib_div.php 的第 5046 行

第 5046 行是下面的最后一行代码。我不知道 $requireFile 变量中引用了哪个路径。

```
 /**
 * Require a class for TYPO3
 * Useful to require classes from inside other classes (not global scope). A limited set of global variables are available (see function)
 */
public static function requireOnce($requireFile)    {
    global $T3_SERVICES, $T3_VAR, $TYPO3_CONF_VARS;

    require_once ($requireFile);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T20:02:18.940

看起来，问题出在缓存中，它是在您的旧安装上创建的。检查是否删除了typo3temp、typo3conf/temp_* 文件。

如果它不起作用，请在此处发布致命错误。这将有助于了解您的问题的性质。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T12:59:39.637

我设法通过将任何带有大写字母的文件夹的名称更改为小写来解决问题。

当我移动站点时，我使用了一个 zip 文件，由于某种原因，当我解压缩文件时，它必须使用首字母大写创建了一些文件夹名称，这就是导致问题的原因。

# opengl - 带有 gl_ModelViewProjectionMatrix 的 GLSL 4.1

> ID：10013960
> 
> 赞同：5
> 
> 时间：2012-04-04T15:08:49.857
> 
> 标签：opengl, glsl, maya

我正在开发一个 glsl 着色器程序，作为在“闭源”应用程序中运行的插件的一部分。应用程序 (maya) 是使用 opengl 2.1 编写的，但我们的显卡支持 opengl/glsl 4.1，我想在我的程序中使用曲面细分和几何着色器。该应用程序设置了 opengl 视口和传统的模型/视图矩阵堆栈，我无法控制这部分代码。

我的直通顶点着色器使用 GLSL 1.2 并且工作正常：

```
// GLSL VERTEX SHADER
#version 120

void main ()
{
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
} 
```

我的直通几何着色器使用 glsl 4.1 并且在应用程序中也可以正常工作：

```
// GLSL GEOMETRY SHADER
#version 410

layout (lines_adjacency) in;
layout (line_strip, max_vertices = 2) out;

void main ()
{
    gl_Position = gl_in[1].gl_Position;
    EmitVertex();
    gl_Position = gl_in[2].gl_Position;
    EmitVertex();
    EndPrimitive();
} 
```

但这只是一个通过测试。在我真正的几何着色器中，我需要在世界空间中进行一些计算，但几何着色器点在视图空间中。**我的问题是：我可以在 4.1 几何着色器中访问 gl_ModelViewProjectionMatrix 吗？**我知道在 glsl 4.1 中不推荐使用传统的矩阵堆栈，以支持统一变量，但我无法更改应用程序。我无法在几何着色器中使用 glsl 1.2，因为我需要 lines_adjacency 输入类型。我是否需要将矩阵复制到插件的 C++ 源代码中的统一变量中？还是有一个“后门”可以直接从 glsl 4.1 获得它？还是我没有想到的其他东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T17:05:46.550

您可以通过以下方式使用兼容模式（如果您的 GL 实现支持它）：

```
#version 410 compatibility 
```

在着色器中。这将重新启用所有已弃用的全局统一状态（除其他外）

# jquery - 简单的 jQuery 动画从数组中替换文本

> ID：10013961
> 
> 赞同：3
> 
> 时间：2012-04-04T15:08:49.970
> 
> 标签：jquery, animation, text

我想用数组中的文本替换“div span”中的文本。我想要这个简单的动画做两件事......

1.  随机飞入或淡入文本
2.  连续循环

我有一个小提琴设置，我一直在尝试不同的东西；[http://jsfiddle.net/fmdfrank/W47QV/](http://jsfiddle.net/fmdfrank/W47QV/)

有人吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T15:32:34.753

使用 jquery .queue & .dequeue 将每个操作存储在 fx 队列中。这将使文本更改表现为动画队列的一部分。然后检查是否需要循环。

在小提琴中：http: [//jsfiddle.net/W47QV/4/](http://jsfiddle.net/W47QV/4/)

```
$(document).ready(function() {

    var items = ["Two", "Three", "Four", "Five", "Six", "One"],
        $text = $( '#div1 span' ),
        delay = 2; //seconds

    function loop ( delay ) {
        $.each( items, function ( i, elm ){
            $text.delay(delay*1E3).fadeOut();
            $text.queue(function(){
                $text.html( items[i] );
                $text.dequeue();
            });
            $text.fadeIn();
            $text.queue(function(){
                if(i == items.length-1){
                    loop(delay);   
                }
                $text.dequeue();
            });
        });
    }

    loop(delay);

});​ 
```

# c# - 通过 LINQ 从 XML 元素生成字典

> ID：10013962
> 
> 赞同：1
> 
> 时间：2012-04-04T15:08:52.450
> 
> 标签：c#, linq

我正在尝试解析 XML 文件，并以所需格式获得一些输出。

这是我的 XML 文件格式。

```
<?xml version="1.0" encoding="utf-8" ?>
<Sample>
  <Student name="Tom" id="0" batch="1">
    <Performance>
      <Previous id="1">Marks 1</Previous>
      <Next mid="2">Marks 2</Next>
      <Next mid="3">Marks 3</Next>
    </Performance>
  </Student>
  <Student name="Jerry" id="1" batch="1">
    <Previous mid="1">Marks 4</Previous>
    <Next mid="2">Marks 5</Next>
    <Next mid="3">Marks 6</Next>
    <Next mid="4">Marks 12</Next>
  </Student>
  <Student name="Kate" id="5" batch="2">
    <Previous mid="2">Marks 7</Previous>
    <Previous mid="3">Marks 8</Previous>
    <Next mid="4">Marks 6</Next>
  </Student>
</Sample> 
```

我试图得到的输出是来自这个 XML 文件的字典：

```
0 - Collecion of (Previous and Next Marks) 
1 - Collecion of (Previous and Next Marks)
5 - Collecion of (Previous and Next Marks) 
```

其中 0、1、5 是学生的 ID，对应的是该学生的分数集合。

为此，我编写了这个查询，它并没有给我输出：
**UPDATE (Query added)**

```
XDocument xdoc = XDocument.Load("XMLfile1.xml");
            var content = xdoc.Descendants("Student")
                        .Select(st => st.Descendants("Previous")
                        .Union(st.Descendants("Next"))
                        .Select(terms => new Marks { MarksId = terms.Attribute("mid").Value, MarksName = terms.Value })).ToDictionary<Marks, int>(key => key.StudentId) ; 
```

问题：
1\. 我无法选择`Attribute` `ID`学生节点
2\. 我无法选择用于字典的键，`key => key.StudentID`并且它给出了一些错误。

我在这里用来解析的类文件：

```
class Marks
    {
        public int StudentID
        {
            get;
            set;
        }
        public string MarksId
        {
            get;
            set;
        }
        public string MarksName
        {
            get;
            set;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:42:05.570

检查这个：

```
var dictionary = (from student in xElement.Descendants("Student")
                    let marks = student.Descendants()
                         .Where(e => new []{"Previous" ,"Next"}
                              .Contains(e.Name.ToString()))
                    select new {student, marks})
                  .ToDictionary(t => t.student.Attribute("id").Value, 
                                  t => t.marks.Select(mark => new Data {
                                                                       MarkId = mark.Attribute("mid").Value, 
                                                                       MarkName = mark.Value
                                                                        }).ToList()); 
```

请注意，您的 XML 可能有一个错误：而不是`<Previous id="1">Marks 1</Previous>`应该有可能`<Previous mid="1">Marks 1</Previous>`

# javascript - Fancybox 示例：Fancybox 在哪里初始化？

> ID：10013963
> 
> 赞同：1
> 
> 时间：2012-04-04T15:08:56.973
> 
> 标签：javascript, jquery, fancybox

在[http://fancybox.net/](http://fancybox.net/)上有几个使用 FancyBox 的例子。

但是在代码中有，例如，只有

```
<li><a id="various3" href="/data/login.php">Ajax - passing custom data</a></li> 
```

但是我没有找到任何初始化fancybox处理的代码，也没有找到一些标记链接以用于fancybox的类。

那么线索是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T15:13:46.007

该页面包含此脚本

```
<script type="text/javascript" src="/js/web.js?m=20100203"></script> 
```

这里有你的答案：

编辑：

```
$("#various3").fancybox({
    ajax : {
        type    : "POST",
        data    : 'mydata=test'
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:12:25.247

请参阅此页面上的第 5 部分：http: [//fancybox.net/howto](http://fancybox.net/howto)

`single_image`使用所有默认设置将 Fancybox 应用于具有 id 的元素：

```
$("#single_image").fancybox(); 
```

`group`使用 5 个自定义 Fancybox 设置，将 Fancybox 应用于所有具有 class 的锚点：

```
$("a.group").fancybox({
    'transitionIn'  :   'elastic',
    'transitionOut' :   'elastic',
    'speedIn'       :   600, 
    'speedOut'      :   200, 
    'overlayShow'   :   false
}); 
```

# spring - 休眠不支持的功能

> ID：10013975
> 
> 赞同：13
> 
> 时间：2012-04-04T15:09:37.017
> 
> 标签：spring, hibernate, jpa, junit, hsqldb

我正在使用 spring 对我的 DAO 进行单元测试。我正在使用 JPA + Hibernate。

对于我的测试，我使用以下 hsqldb 版本：

```
<dependency>
    <groupId>hsqldb</groupId>
    <artifactId>hsqldb</artifactId>
    <version>1.8.0.10</version>
    <scope>test</scope>
</dependency> 
```

这是我用于单元测试的 persistence.xml：

```
 <persistence-unit name="unit-test-pu" transaction-type="RESOURCE_LOCAL">   
      <properties>
         <property name="javax.persistence.jdbc.driver" value="org.hsqldb.jdbcDriver"/>
         <property name="javax.persistence.jdbc.user" value="sa"/>
         <property name="javax.persistence.jdbc.password" value=""/>
         <property name="javax.persistence.jdbc.url" value="jdbc:hsqldb:mem:testdb"/>
         <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
         <property name="hibernate.archive.autodetection" value="class"/>
         <property name="hibernate.show_sql" value="true"/>
         <property name="hibernate.use_sql_comments" value="true"/> 
         <property name="hibernate.format_sql" value="true"/>
         <property name="hibernate.hbm2ddl.auto" value="create"/>
      </properties>      
   </persistence-unit> 
```

这是我的测试课：

```
@ContextConfiguration("/spring/test-context.xml")
@TestExecutionListeners({TransactionalTestExecutionListener.class})
@Transactional
public class BaseDaoTestCase extends AbstractJUnit4SpringContextTests { 

    @Autowired
    private MockEntityDao dao;

    @Test
    public void testSave_success() {
        MockEntity e = new MockEntity();
        dao.save(e);
        assertNotNull(e.getId());
    }
} 
```

注意：这个想法是针对内存中的 HSQLDB 实例测试我的 DAO。每个测试方法都在 spring 管理的事务中运行。

不幸的是，当我运行它时，我从休眠中得到以下异常：

```
Caused by: org.hibernate.exception.GenericJDBCException: This function is not supported
    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:54)
    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)
    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110)
    at org.hibernate.engine.jdbc.internal.proxy.ConnectionProxyHandler.continueInvocation(ConnectionProxyHandler.java:146)
    at org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81)
    at $Proxy23.prepareStatement(Unknown Source)
    at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$2.doPrepare(StatementPreparerImpl.java:105)
    at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:166)
    at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareStatement(StatementPreparerImpl.java:103)
    at org.hibernate.id.insert.AbstractSelectingDelegate.performInsert(AbstractSelectingDelegate.java:55)
    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2764)
    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3275)
    at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:81)
    at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362)
    at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:203)
    at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:183)
    at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:167)
    at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:320)
    at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:287)
    at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193)
    at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126)
    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:78)
    at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:208)
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:151)
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:78)
    at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:757)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:732)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:736)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:854)
    ... 42 more
Caused by: java.sql.SQLException: This function is not supported
    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
    at org.hsqldb.jdbc.Util.notSupported(Unknown Source)
    at org.hsqldb.jdbc.jdbcConnection.prepareStatement(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.hibernate.engine.jdbc.internal.proxy.ConnectionProxyHandler.continueInvocation(ConnectionProxyHandler.java:138)
    ... 67 more 
```

我的DAO的save()方法的实现如下：

```
entityManager.persist(entity); 
```

我正在使用以下休眠版本：

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-entitymanager</artifactId>
    <version>4.1.0.Final</version>
    <scope>compile</scope>
</dependency> 
```

有没有人知道发生了什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-12T19:47:11.447

我有类似的问题。在我将我的依赖项（尤其是 hsqldb）更新为：

```
 <hibernate-core-version>4.1.5.Final</hibernate-core-version>
    <spring.version>3.1.2.RELEASE</spring.version>
    <hsqldb.version>2.2.8</hsqldb.version>
    ...
    <dependency>
        <groupId>org.hsqldb</groupId>
        <artifactId>hsqldb</artifactId>
        <version>${hsqldb.version}</version>
    </dependency> 
```

我的问题解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T15:43:12.153

您使用的是哪个模拟框架？我只是在学习使用模拟，所以这只是一个疯狂的猜测，但请确保你已经完成了初始化模拟所需的一切。也许问题与测试的设置方式有关。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-04T17:45:50.613

我在使用 JPA + Hibernate + HSQLDB 时遇到了同样的问题，但不是 spring。这是我的代码：

```
EntityManagerFactory emf = Persistence.createEntityManagerFactory("persistenceUnit");
EntityManager em = emf.createEntityManager();
EntityTransaction tr = em.getTransaction();
tr.begin();
em.persist(new MyEntity());
tr.commit();
em.close();
emf.close(); 
```

这给了我同样的`This function is not supported`例外，但如果我在没有交易的情况下这样做，它不会。像这样：

```
EntityManagerFactory emf = Persistence.createEntityManagerFactory("persistenceUnit");
EntityManager em = emf.createEntityManager();
em.persist(new MyEntity());
em.close();
emf.close(); 
```

现在的问题是我没有看到数据库上反映的更改。

# c# - 使用 EF 4.3 代码优先迁移对列重新排序

> ID：10013976
> 
> 赞同：2
> 
> 时间：2012-04-04T15:09:43.533
> 
> 标签：c#, entity-framework, entity-framework-4, ef-code-first, entity-framework-migrations

在这里阅读这两个演练：

[http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)

[http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough.aspx](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough.aspx)

我找不到指定 SQL 数据表中列顺序的方法。看起来最后添加的属性总是映射到最后一列。

例子：

```
public class SampleData {
    public int Id { get; set; }
    public string Data2 { get; set; }
    public string Data3 { get; set; }
} 
```

将创建一个具有列顺序的表：

**身份证 | 数据2 | 数据3**

更新类，如：

```
public class SampleData {
    public int Id { get; set; }
    public string Data1 { get; set; }
    public string Data2 { get; set; }
    public string Data3 { get; set; }
} 
```

然后运行 ​​update 会将表更新为：

**身份证 | 数据2 | 数据3 | 数据1**

任何人都知道是否有办法在使用迁移时指定列顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T15:35:42.573

除了创建新表并将所有数据从旧表移动到新表之外，别无他法。数据库中列的顺序并不重要——您有您的应用程序和 UI 可以根据需要对列进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-01T11:31:43.383

根据 MS Docs：

[更改表中的列顺序](https://docs.microsoft.com/en-us/sql/relational-databases/tables/change-column-order-in-a-table?view=sql-server-2017)

**...无法使用 Transact-SQL 语句执行此任务。**

# excel - 创建一个复选框，处理它，并将新的复选框报告到新位置

> ID：10013984
> 
> 赞同：2
> 
> 时间：2012-04-04T15:10:05.403
> 
> 标签：excel, vba

好的，我知道标题可能令人困惑，但这里是。

我有一个列表，让我们说 100 人在 Excel 电子表格中，所有名称都在 A 列中，复选框在 B 列中，True 或 False 隐藏在 C 列中。

我在 B 列中手动创建了复选框。它在 C 列中报告真或假。

有没有办法在列表中创建复选框直到最后一个，并让复选框在 C 列中向他们自己的对应方报告，以便上方和下方的复选框不会被任何其他损坏复选框数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T18:07:11.277

您可以在场景中插入 2 种类型的控件。一个是**窗体控件**，另一个是**ActiveX 控件**

**表单控件**

要插入表单控件，您必须使用此代码

```
 Sheets("Sheet1").CheckBoxes.Add 52.5, 3, 42, 17.25 
```

语法是

```
 CheckBoxes.Add Cell.Left, Cell.Top, Cell.Width, Cell.Height 
```

**ActiveX 控件**

要插入 ActiveX 控件，您必须使用此代码

```
 Sheets("Sheet1").OLEObjects.Add ClassType:="Forms.CheckBox.1", Link:=False, _
 DisplayAsIcon:=False, Left:=54, Top:=1.5, Width:=39.75, Height:=11.25 
```

因此，要添加上述任何控件，您必须使用循环来查找单元格的坐标，然后在相关位置添加复选框。对于您的方案，我建议您使用表单控件，这样您就可以拥有一段代码，该代码将在单击上述任何复选框时运行。

现在我们如何确保所有复选框调用相同的宏:)

**提示**：此代码创建一个复选框，然后为该复选框分配一个宏。

```
Sub Sample()
    Dim Shp As Shape

    '~~> Create a Checkbox
    Set Shp = Sheets("Sheet1").CheckBoxes.Add(52.5, 3, 42, 17.25)

    '~~> Assing a macro to it
    Shp.OnAction = "'" & ActiveWorkbook.Name & "'!macro_name"
End Sub 
```

好的，下一个问题。宏如何知道哪个 CheckBox 正在调用它？

**提示**：检查什么`Application.Caller`；）将代码放在与复选框链接的宏中。

```
Sub macro_name()
    MsgBox "This macro was called by " & Application.Caller
End Sub 
```

HTH 让你走上正轨:)

席德

# r - 如何将行从一个data.frame复制到另一个[R]

> ID：10013985
> 
> 赞同：12
> 
> 时间：2012-04-04T15:10:07.490
> 
> 标签：r, copy, dataframe

有两个数据帧 x, y 。我想将编号为 J 的行从 X 复制到 Y 中。类似于

```
 Y[1,] <- X[j,] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-04T15:35:52.253

您的示例恰好回答了您的问题。（试试看！）

如果您不想*替换*目标 data.frame 中的一行，而是想向其中*添加*一行，请尝试`rbind()`：

```
X <- data.frame(name=LETTERS[1:3], value=1:3, stringsAsFactors=FALSE)
Y <- data.frame(name=letters[1:3], value=rnorm(3), stringsAsFactors=FALSE)

X[1,] <- Y[1,]
X <- rbind(X, Y[3,]) 
```

# python-3.x - Python 3.1 服务器端无法将 Unicode 字符串输出到客户端

> ID：10013988
> 
> 赞同：2
> 
> 时间：2012-04-04T15:10:19.157
> 
> 标签：python-3.x

我正在使用免费的网络主机，但选择不使用任何 Python 框架，并且一直试图将保存在源文件中的中文字符（使用 emacs 保存以 utf-8 编码的文件）打印到生成的 HTML 页面。我认为 Unicode 在 Python 3.1 中“正常工作”，所以我很困惑。我发现了三个不起作用的解决方案。我可能只是遗漏了一两个细节。

主机是 Alwaysdata，它使用起来很简单，所以我对它们如何组合部件的细节知之甚少。我所做的只是将 Python 文件上传或编辑（使用 ssh）到 www 文件夹，更改权限，将浏览器指向正确的 URL，然后它就可以工作了。

我的第一次尝试，它适用于本地 IDLE（以及服务器的 Python 命令行交互式 shell，这让我更加困惑，为什么它在传递给浏览器时不起作用）

```
#!/usr/bin/python3.1

mystr = "世界好"
print("Content-Type: text/html\n\n")
print("""<!DOCTYPE html>
<html><head><meta charset="utf-8"></head>
<body>""")

print(mystr) 
```

错误是：

```
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-3: 
ordinal not in range(128) 
```

然后我尝试了

```
print(mystr.encode("utf-8")) 
```

导致没有错误，但以下不希望的输出到浏览器：

```
b'\xe4\xbd\xa0\xe5\xa5\xbd\xe4\xb8\x96\xe7\x95\x8c' 
```

第三，添加了以下行但出现错误：

```
import sys
sys.setdefaultencoding("utf-8")

AttributeError: 'module' object has no attribute 'setdefaultencoding' 
```

最后，用 f.write 替换 print：

```
import codecs
f = codecs.open(sys.stdout, "w", "utf-8")

mystr = "你好世界"
...
f.write(mystr) 
```

错误：

```
TypeError: invalid file: <_io.TextIOWrapper name='<stdout>' 
encoding='ANSI_X3.4-1968'> 
```

如何使输出正常工作？我需要使用框架进行快速修复吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T16:54:03.710

听起来您正在使用 CGI，这是一个愚蠢的 API，因为它使用标准输出，用于输出给人类，输出到您的浏览器。这是你的问题的基本来源。

您需要将其编码为 UTF-8，然后写入 sys.stdout.buffer 而不是 sys.stdout。

在那之后，给自己一个网络框架。真的，你会快乐很多。

# java - 在 Spring 3.1 Java Config 中引用 Spring Security 配置

> ID：10013996
> 
> 赞同：4
> 
> 时间：2012-04-04T15:10:44.230
> 
> 标签：java, spring, spring-security

我最近将大部分 Spring 配置切换为使用 Spring 3.1 中基于代码的配置。但是，现在我已经切换，我的 Spring Security 无法正常工作，并在 Tomcat 启动时引发以下错误：

```
SEVERE: Exception starting filter springSecurityFilterChain
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named     'springSecurityFilterChain' is defined 
```

我仍然在 XML 文件中有 Spring Security，并且知道它不能在 Spring 中转换为 Java 配置，因为它是一个自定义命名空间，但是，我在我的 Java 配置文件中引用它。我还尝试将 applicationContext-security.xml 配置引用从 Java 配置移动到我的 web.xml，但没有任何运气。

```
@Configuration
@EnableWebMvc
@Import(ServicesConfig.class)
@ImportResource({ "classpath:applicationContext-security.xml",
"classpath:dataSources.xml" })
@ComponentScan(basePackages = "com.foobar")
public class WebConfig {
   // left out Beans for clarity
} 
```

applicationContext-security.xml：

```
<b:beans xmlns="http://www.springframework.org/schema/security"
xmlns:b="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:p="http://www.springframework.org/schema/p" xmlns:c="http://www.springframework.org/schema/c"
xmlns:oauth2="http://www.springframework.org/schema/security/oauth2"
xsi:schemaLocation="http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
      http://www.springframework.org/schema/security
      http://www.springframework.org/schema/security/spring-security-3.1.xsd
      http://www.springframework.org/schema/security/oauth2
      http://www.springframework.org/schema/security/spring-security-oauth2.xsd">

<!-- Security configuration -->

<global-method-security pre-post-annotations="enabled" />

<http use-expressions="true" access-denied-page="/error/accessDenied" 
        entry-point-ref="casEntryPoint">
    <intercept-url pattern="/**" access="isAuthenticated()" />
    <custom-filter position="CAS_FILTER" ref="casFilter" />
</http>

<authentication-manager alias="authenticationManager">
    <authentication-provider ref="casAuthenticationProvider" />
</authentication-manager>

<!-- Bean definitions -->
<b:bean id="casAuthenticationProvider"
    class="org.springframework.security.cas.authentication.CasAuthenticationProvider"
    p:serviceProperties-ref="serviceProperties" p:key="1234"
    p:authenticationUserDetailsService-ref="userDetailsByNameServiceWrapper"
    p:ticketValidator-ref="cas20ServiceTicketValidator" />

<b:bean id="userDetailsByNameServiceWrapper"
    class="org.springframework.security.core.userdetails.UserDetailsByNameServiceWrapper"
    c:userDetailsService-ref="userDetailsService" />

<b:bean id="userDetailsService" class="foobar.MyUserDetailsService" />

<b:bean id="cas20ServiceTicketValidator" 
    class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator"
    c:casServerUrlPrefix="https://mycasserver/cas" />

<b:bean id="casFilter"
    class="org.springframework.security.cas.web.CasAuthenticationFilter"
    p:authenticationManager-ref="authenticationManager" />

<b:bean id="casEntryPoint"
    class="org.springframework.security.cas.web.CasAuthenticationEntryPoint"
    p:loginUrl="https://mycasserver/cas/login" 
    p:serviceProperties-ref="serviceProperties" />

<b:bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties"
    p:service="https://foobar.com/services/j_spring_cas_security_check"
    p:sendRenew="false" />

</b:beans> 
```

`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

<description>My App</description>

<!-- Context Params -->
<context-param>
    <param-name>contextClass</param-name>
    <param-value>
         org.springframework.web.context.support.AnnotationConfigWebApplicationContext
    </param-value>
</context-param>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>foobar.WebConfig</param-value>
</context-param>

<!-- Filters --> 
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- Listeners -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!-- Servlets -->
<servlet>
    <servlet-name>dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextClass</param-name>
        <param-value>
            org.springframework.web.context.support.AnnotationConfigWebApplicationContext
         </param-value>
    </init-param>
</servlet>

<servlet-mapping>
    <servlet-name>dispatcher</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T19:11:50.490

不要使用`security`命名空间快捷方式并将所有 spring 配置从 XML 迁移到 Java。它将使您的安全性微调变得更加容易。我将在迁移到 3.1 后不久为我们的项目执行此操作。[您可以在此处](https://github.com/alx3apps/spring-embedded-tomcat/blob/master/etomcat6-test/src/main/app-dirs/x509dir/conf/etomcat-test-ctx.xml#L50)找到重要的几乎普通 bean 安全 XML 配置示例。

**编辑：** 完成配置（上面链接）迁移。故意将所有配置放入一个方法中以使其更短并证明您不需要为每个过滤器使用单独的 spring bean。当然，最好将复杂的初始化部分移动到单独的方法中（`@Bean`必要时标记）。`X509AnnotationTest.Config`您可以在上面的链接中找到工作示例。

```
@Bean
public FilterChainProxy springSecurityFilterChain() throws Exception {
    // AuthenticationEntryPoint
    BasicAuthenticationEntryPoint entryPoint = new BasicAuthenticationEntryPoint();
    entryPoint.setRealmName("AppName Realm");
    // accessDecisionManager
    List<AccessDecisionVoter> voters = Arrays.<AccessDecisionVoter>asList(new RoleVoter(), new WebExpressionVoter());
    AccessDecisionManager accessDecisionManager = new AffirmativeBased(voters);
    // SecurityExpressionHandler
    SecurityExpressionHandler<FilterInvocation> securityExpressionHandler = new DefaultWebSecurityExpressionHandler();
    // AuthenticationUserDetailsService
    UserDetailsByNameServiceWrapper<PreAuthenticatedAuthenticationToken> authenticationUserDetailsService = new UserDetailsByNameServiceWrapper<PreAuthenticatedAuthenticationToken>(authUserDetailService);
    authenticationUserDetailsService.afterPropertiesSet();
    // PreAuthenticatedAuthenticationProvider
    PreAuthenticatedAuthenticationProvider preAuthenticatedAuthenticationProvider = new PreAuthenticatedAuthenticationProvider();
    preAuthenticatedAuthenticationProvider.setPreAuthenticatedUserDetailsService(authenticationUserDetailsService);
    preAuthenticatedAuthenticationProvider.afterPropertiesSet();
    // AuthenticationManager
    List<AuthenticationProvider> providers = Arrays.<AuthenticationProvider>asList(preAuthenticatedAuthenticationProvider);
    AuthenticationManager authenticationManager = new ProviderManager(providers);
    // HttpSessionSecurityContextRepository
    HttpSessionSecurityContextRepository httpSessionSecurityContextRepository = new HttpSessionSecurityContextRepository();
    // SessionRegistry
    SessionRegistry sessionRegistry = new SessionRegistryImpl();
    // ConcurrentSessionControlStrategy
    ConcurrentSessionControlStrategy concurrentSessionControlStrategy = new ConcurrentSessionControlStrategy(sessionRegistry);

    // ConcurrentSessionFilter
    ConcurrentSessionFilter concurrentSessionFilter = new ConcurrentSessionFilter(sessionRegistry);
    concurrentSessionFilter.afterPropertiesSet();
    // SecurityContextPersistenceFilter
    SecurityContextPersistenceFilter securityContextPersistenceFilter = new SecurityContextPersistenceFilter(httpSessionSecurityContextRepository);
    // X509AuthenticationFilter
    X509AuthenticationFilter x509AuthenticationFilter = new X509AuthenticationFilter();
    x509AuthenticationFilter.setAuthenticationManager(authenticationManager);
    x509AuthenticationFilter.afterPropertiesSet();
    // RequestCacheAwareFilter
    RequestCacheAwareFilter requestCacheAwareFilter = new RequestCacheAwareFilter();
    // SecurityContextHolderAwareRequestFilter
    SecurityContextHolderAwareRequestFilter securityContextHolderAwareRequestFilter = new SecurityContextHolderAwareRequestFilter();
    // SessionManagementFilter
    SessionManagementFilter sessionManagementFilter = new SessionManagementFilter(httpSessionSecurityContextRepository, concurrentSessionControlStrategy);
    // ExceptionTranslationFilter
    ExceptionTranslationFilter exceptionTranslationFilter = new ExceptionTranslationFilter(entryPoint);
    exceptionTranslationFilter.setAccessDeniedHandler(new AccessDeniedHandlerImpl());
    exceptionTranslationFilter.afterPropertiesSet();
    // FilterSecurityInterceptor
    FilterSecurityInterceptor filterSecurityInterceptor = new FilterSecurityInterceptor();
    filterSecurityInterceptor.setAuthenticationManager(authenticationManager);
    filterSecurityInterceptor.setAccessDecisionManager(accessDecisionManager);
    LinkedHashMap<RequestMatcher, Collection<ConfigAttribute>> map = new LinkedHashMap<RequestMatcher, Collection<ConfigAttribute>>();
    map.put(new AntPathRequestMatcher("/**"), Arrays.<ConfigAttribute>asList(new SecurityConfig("isAuthenticated()")));
    ExpressionBasedFilterInvocationSecurityMetadataSource ms = new ExpressionBasedFilterInvocationSecurityMetadataSource(map, securityExpressionHandler);
    filterSecurityInterceptor.setSecurityMetadataSource(ms);
    filterSecurityInterceptor.afterPropertiesSet();
    // SecurityFilterChain
    SecurityFilterChain chain = new DefaultSecurityFilterChain(new AntPathRequestMatcher("/**"),
            concurrentSessionFilter,
            securityContextPersistenceFilter,
            x509AuthenticationFilter,
            requestCacheAwareFilter,
            securityContextHolderAwareRequestFilter,
            sessionManagementFilter,
            exceptionTranslationFilter,
            filterSecurityInterceptor);
    return new FilterChainProxy(chain);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-22T21:53:08.213

对于那些仍在寻找将 SpringSecurity XML 配置与 Java 配置 Web 应用程序一起使用的方法的人。我使用 Spring 3.2.0.RELEASE 和 SpringSecurity 3.2.0.M1 完成了这项工作。这是解决方案的重要部分

WebAppConfig.java

```
package com.foo.webapp;

@Configuration
@ComponentScan(basePackages = { "com.foo" })
@ImportResource(value = { "/WEB-INF/spring-security.xml" })
public class WebAppConfig {
    // other beans go here
} 
```

spring-security.xml
*请注意，我必须从 <beans:beans> 定义中删除默认的 xmlns="..." 。*

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:security="http://www.springframework.org/schema/security"
    xsi:schemaLocation="
        http://www.springframework.org/schema/security
        http://www.springframework.org/schema/security/spring-security-3.1.xsd
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

    <security:http auto-config="true">
        <security:intercept-url pattern="/secured/**" access="ROLE_USER" />
        <security:form-login login-page="/login" default-target-url="/main"
                authentication-failure-url="/loginfailed" />
        <security:logout logout-success-url="/logout" />
    </security:http>

    <security:authentication-manager>
        <security:authentication-provider>
            <security:user-service>
                <security:user name="user" password="user" authorities="ROLE_USER" />
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>
</beans:beans> 
```

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://java.sun.com/xml/ns/j2ee
        http://java.sun.com/xml/ns/j2ee/web-app_2_5.xsd">

    <context-param>
        <param-name>contextClass</param-name>
        <param-value>
            org.springframework.web.context.support.AnnotationConfigWebApplicationContext
        </param-value>
    </context-param>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>com.foo.webapp.WebAppConfig</param-value>
    </context-param>

    <!-- Spring Security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>foo</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>foo</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
</web-app> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-26T18:42:47.000

感谢大家在使用 Spring 的 Java 配置时提供有关 springSecurityFilterChain 的上述提示。当我一直在努力应用这些提示来修复我自己的代码中的类似错误时，我注意到 org.springframework.web.WebApplicationInitializer（由 AbstractAnnotationConfigDispatcherServletInitializer 实现的接口）的 Spring 文档具有以下相关的“警告”：

**web.xml 版本控制**

WEB-INF/web.xml 和 WebApplicationInitializer 的使用不是互斥的；例如，web.xml 可以注册一个 servlet，而 WebApplicationInitializer 可以注册另一个。初始化程序甚至可以通过 ServletContext.getServletRegistration(String) 等方法修改在 web.xml 中执行的注册。

***但是，如果应用程序中存在 WEB-INF/web.xml，则其版本属性必须设置为“3.0”或更高版本，否则 ServletContainerInitializer 引导将被 servlet 容器忽略。***

我指出这一点是因为我注意到上面提到的 web.xml 版本仍然是 2.5。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-28T09:49:24.597

我让它与 Spring 3.2.3 和 Servlet 3.0 一起工作。打勾是扩展 DelegatingFilterProxy 类并将其命名为 SpringSecurityFilterChain。

```
public class ServiceInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {

@Override
protected Class<?>[] getRootConfigClasses() {
    return new Class<?>[] { ApplicationConfig.class };
}

@Override
protected Class<?>[] getServletConfigClasses() {
    return new Class<?>[] { WebConfig.class };
}

@Override
protected String[] getServletMappings() {
    return new String[] { "/" };
}

@Override
protected Filter[] getServletFilters() {
    return new Filter[] { new OpenEntityManagerInViewFilter(), new SpringSecurityFilterChain() };
}

public class SpringSecurityFilterChain extends DelegatingFilterProxy {

} 
```

}

# java - 在 Java 中解析 YYYYMMdd 日期的最快方法

> ID：10013998
> 
> 赞同：10
> 
> 时间：2012-04-04T15:10:52.613
> 
> 标签：java, parsing, date, date-parsing

解析 YYYYMMdd 日期时，例如 2012 年 4 月 5 日的 20120405，最快的方法是什么？

```
int year = Integer.parseInt(dateString.substring(0, 4));
int month = Integer.parseInt(dateString.substring(4, 6));
int day = Integer.parseInt(dateString.substring(6)); 
```

对比

```
int date = Integer.parseInt(dateString)
year = date / 10000;
month = (date % 10000) / 100; 
day = date % 100; 
```

mod 10000 for month 是因为 mod 10000 导致 MMdd 并且结果 / 100 是 MM

在第一个示例中，我们执行 3 个字符串操作和 3 个“解析为 int”，在第二个示例中，我们通过模数做了很多事情。

什么更快？有没有更快的方法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-04T15:15:14.627

```
SimpleDateFormat format = new SimpleDateFormat("yyyyMMdd");
Date date = format.parse("20120405"); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-04T15:21:06.937

正如您在下面看到的，仅当您查看*数百万*次迭代时，日期处理的性能才相关。相反，您应该选择易于阅读和维护的解决方案。

尽管您可以使用`SimpleDateFormat`，但它不是可重入的，因此应避免使用。最好的解决方案是使用出色的 Joda 时间课程：

```
private static final DateTimeFormatter DATE_FORMATTER = new DateTimeFormatterBuilder()
     .appendYear(4,4).appendMonthOfYear(2).appendDayOfMonth(2).toFormatter();
...
Date date = DATE_FORMATTER.parseDateTime(dateOfBirth).toDate(); 
```

* * *

如果我们谈论的是您的数学函数，首先要指出的是我已经修复了您的数学代码中的错误。*这就是*手工操作的问题。也就是说，处理一次字符串的那些将是最快的。快速测试运行表明：

```
year = Integer.parseInt(dateString.substring(0, 4));
month = Integer.parseInt(dateString.substring(4, 6));
day = Integer.parseInt(dateString.substring(6)); 
```

大约需要 800 毫秒，而：

```
int date = Integer.parseInt(dateString);
year = date / 10000;
month = (date % 10000) / 100; 
day = date % 100;
total += year + month + day; 
```

大约需要 400 毫秒。

**但是……再一次……**您需要考虑到这是在**1000 万**次迭代之后。这是过早优化的完美示例。我会选择最易读和最容易维护的那个。这就是为什么 Joda time 的答案是最好的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-04T15:24:06.160

我做了一个快速的基准测试，两种方法都被执行了 100 万次。结果清楚地表明模数方法要快得多，正如 Dilum Ranatunga 预测的那样。

```
t.startTiming();
for(int i=0;i<1000000;i++) {
    int year = Integer.parseInt(dateString.substring(0, 4));
    int month = Integer.parseInt(dateString.substring(4, 6));
    int day = Integer.parseInt(dateString.substring(6));
}
t.stopTiming();
System.out.println("First method: "+t.getElapsedTime());

Time t2 = new Time();
t2.startTiming();
for(int i=0;i<1000000;i++) {
    int date = Integer.parseInt(dateString);
    int y2 = date / 1000;
    int m2 = (date % 1000) / 100;
    int d2 = date % 10000;
}
t2.stopTiming();
System.out.println("Second method: "+t2.getElapsedTime()); 
```

结果不会说谎（以毫秒为单位）。

```
First method: 129
Second method: 53 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-04T15:14:10.687

第二个肯定会更快，一旦您更改`mod`并`%`添加缺少的分号并修复`year`计算中的除数。也就是说，我发现很难想象这是一个瓶颈的应用程序。你有多少次将`YYYYMMdd`日期解析到它们的组件中，而不需要验证它们？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-04T15:15:21.277

怎么样（但它会解析一个无效的日期而不说什么......）：

```
public static void main(String[] args) throws Exception {
    char zero = '0';
    int yearZero = zero * 1111;
    int monthAndDayZero = zero * 11;
    String s = "20120405";
    int year = s.charAt(0) * 1000 + s.charAt(1) * 100 + s.charAt(2) * 10 + s.charAt(3) - yearZero;
    int month = s.charAt(4) * 10 + s.charAt(5) - monthAndDayZero;
    int day = s.charAt(6) * 10 + s.charAt(7) - monthAndDayZero;
} 
```

使用 100,000 次迭代预热和 10,000,000 次定时迭代进行快速而肮脏的基准测试，我得到：

*   第一种方法需要 700 毫秒
*   第二种方法需要 350 毫秒
*   我的方法是 10 毫秒。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-04T15:14:35.973

我相信mod方法会更快。通过调用该函数，您可以在堆栈上创建变量和位置实例并创建更重的解决方案。

Mod 是标准的数学运算符，可能非常优化。

但正如 Hunter McMillen 所说“你应该看看 Calendar 类 API”