# StackOverflow 问答 10372000-10372999

# sublimetext2 - 如何更改 Sublime Text 2 / 3 中匹配括号的样式？

> ID：10372004
> 
> 赞同：51
> 
> 时间：2012-04-29T12:07:26.243
> 
> 标签：sublimetext2, sublimetext, sublimetext3

它只是在匹配的括号下划线，是否可以使它更有用，例如更改括号颜色或突出显示括号行？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-06-14T20:09:31.417

您可以通过修改主题的配色方案文件来更改括号的颜色。

转到**首选项/浏览包**打开文件夹**颜色方案 - 默认**找出您当前的主题文件（默认的`Monokai.tmTheme`）。使用 Sublime Text 打开它，找到以下部分：

```
<key>bracketsForeground</key>
<string>#F8F8F2A5</string>
<key>bracketsOptions</key>
<string>underline</string>

<key>bracketContentsForeground</key>
<string>#F8F8F2A5</string>
<key>bracketContentsOptions</key>
<string>underline</string> 
```

您可以在此处更改括号的外观。如果你把它改成这样：

```
<key>bracketsForeground</key>
<string>#FF8000</string>
<key>bracketsOptions</key>
<string>foreground</string>

<key>bracketContentsForeground</key>
<string>#FF8000</string>
<key>bracketContentsOptions</key>
<string>foreground</string> 
```

..您将删除下划线并在括号中添加橙色。

查看文件的其余部分，因为（也许）您会发现更多需要更改的内容；）

**无需重新启动 sublime 即可查看更改。**只需保存文件。

### Sublime Text3 的更新

1.  转到您的 Sublime Text 3 安装文件夹；cd 进入“包”文件夹。搜索`Color Scheme - Default.sublime-package`并将其复制粘贴到您的`Packages`文件夹中（在 windows 下是`%APPDATA%\Sublime Text 3\Packages`）。
2.  解压缩文件（使用任何解压缩工具）。
3.  访问新生成的文件夹并修改主题文件（与 Sublime Text 2 中的步骤相同）。
4.  应用更改后保存文件，您将看到更改。
5.  如果需要，您可以使用`.sublime-package`扩展名再次将文件压缩为 zip，但如果这样做，您必须将该文件移动到文件`Installed Packages`夹中。

### 更新 2

有一个非常有用的包用于编辑名为[PackageResourceViewer](https://github.com/skuroda/PackageResourceViewer)的插件。它允许您非常轻松地编辑包，为您完成所有解压缩和移动内容。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-04-29T12:15:41.263

有插件[BracketHighlighter](https://github.com/facelessuser/BracketHighlighter)

特征：

*   方括号 ()、[]、<>、{} 的可自定义高亮显示
*   标签的可定制高亮显示（支持一元标签并支持自关闭 />（HTML5 即将到来））
*   可定制的报价突出显示
*   有选择地禁用或启用标签、括号或引号的特定匹配
*   基于语言有选择地匹配特定标签、括号或引号的白名单或黑名单
*   使用按需快捷方式时，在状态栏中显示匹配之间的行数和字符数
*   将光标移动到括号内容的开头或结尾的快捷方式（如果当前未多选，则将重点放在开头或结尾括号上）
*   选择所有括号内容的快捷方式
*   和其他人，请参阅 github 站点。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-03-25T01:01:42.273

无需使用插件即可修改括号颜色和其他可见性偏好。以下是本机实现此类更改的方法。

**注意：** 我最近在 SublimeText 论坛上起草了这个答案。这里有一个类似*（未接受）*的答案，但我包含了一些未提及的细节和视觉参考。

* * *

# 例子

这是我的个人配置：

[![演示1](../Images/75dfce4d799f752ec7dfc6017bed9f08.png)](https://i.stack.imgur.com/xjrRj.png)

[![演示2](../Images/1406ea8f40d584eeec60f8de75cd555b.png)](https://i.stack.imgur.com/4fsrT.png)

* * *

# 设置

以下是我的所有可见性相关设置。

正如您在示例中看到的：`brackets`如果插入符号放在括号上，`bracketContents`设置决定括号对的颜色，而如果插入符号放在一组括号内，设置决定括号对的颜色。

My`bracketContentsOptions`设置为`underline`，但`foreground`如果您希望它在两个实例中都突出显示，您可以将其更改为。

### @Preferences.sublime-settings

```
"always_show_minimap_viewport" : true,
"caret_extra_bottom"           : 3,
"caret_extra_top"              : 3,
"caret_extra_width"            : 1,
"caret_style"                  : "phase",
"draw_minimap_border"          : true,
"fade_fold_buttons"            : false,
"fold_buttons"                 : true,
"highlight_line"               : true,
"highlight_modified_tabs"      : true,
"line_numbers"                 : true,
"match_brackets"               : true,
"match_brackets_angle"         : true,
"match_brackets_braces"        : true,
"match_brackets_content"       : true,
"match_brackets_square"        : true,
"match_selection"              : true,
"match_tags"                   : true,
"overlay_scroll_bars"          : "enabled", 
```

### @YourColorScheme.tmTheme

```
 <!-- Indent Guides -->

        <key>guide</key>
        <string>#14191F</string>

        <key>stackGuide</key>
        <string>#14191F</string>

        <key>activeGuide</key>
        <string>#2E4589</string>

    <!-- Highlighted Brackets -->

        <key>bracketsForeground</key>
        <string>#D80E64</string>

        <key>bracketsOptions</key>
        <string>foreground</string>

        <key>bracketContentsForeground</key>
        <string>#D80E64</string>

        <key>bracketContentsOptions</key>
        <string>underline</string>

    <!-- Document Selection -->

        <key>caret</key>
        <string>#D80E64</string>

        <key>lineHighlight</key>
        <string>#121522</string>

        <key>selection</key>
        <string>#1D416B</string>

        <key>selectionForeground</key>
        <string>#bbccff</string>

        <key>selectionBorder</key>
        <string>#4D71FF</string>

        <key>inactiveSelection</key>
        <string>#1D416B</string>

        <key>inactiveSelectionForeground</key>
        <string>#bbccff</string>

    <!-- Search Results -->

        <key>findHighlight</key>
        <string>#0BD0AC</string>

        <key>findHighlightForeground</key>
        <string>#000000</string> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-27T21:46:54.120

使用 BracketHighlighter 包，编辑您的主题 (tmTheme)，并添加：

```
 <dict>
        <key>name</key>
        <string>Tag</string>
        <key>scope</key>
        <string>brackethighlighter.default</string>
        <key>settings</key>
        <dict>
            <key>foreground</key>
            <string>#ffff00</string>
        </dict>
    </dict> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-06T00:50:48.040

```
<dict>
    <key>name</key>
    <string>Tag</string>
    <key>scope</key>
    <string>meta.tag, declaration.tag</string>
    <key>settings</key>
    <dict>
        <key>foreground</key>
        <string>#0033CC</string>
    </dict>
</dict> 
```

这会改变 sb3 中的括号颜色

# opengl - Fluxus - 未定义的标识符 gl 和 gh 不断返回 0.0

> ID：10372009
> 
> 赞同：1
> 
> 时间：2012-04-29T12:07:39.980
> 
> 标签：opengl, 3d-engine

我正在尝试运行 mndl.hu hackpact 的脚本，但我一直遇到错误。

```
undefined identifier gl 
```

我用谷歌搜索并发现了以下内容

```
(define (gl n)
       (log (+ 1 (gh n)))) 
```

但是 gh 一直返回 0.0，所以简单地用 gh 替换 gl 是行不通的。

# python - Python 运行 shell 命令并模拟用户输入

> ID：10372012
> 
> 赞同：1
> 
> 时间：2012-04-29T12:08:24.550
> 
> 标签：python, shell, emulation

我如何从 python 脚本模拟用户数据，例如：

假设我运行 os.system('grunt init:gruntfile')，并且我希望 python 脚本自动“输入”一些数据，所以不是用户输入 shell 命令要求的数据，而是 python 脚本输入一些数据在脚本中硬编码？

希望我的问题有意义，并且有人可以提供帮助。提前谢谢你，亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T12:13:08.923

[`pexpect`](http://pexpect.sourceforge.net/pexpect.html)如果普通旧的`subprocess`不符合您的要求，可能会符合您的要求。

从`pexpect`网站：

> 例如：：
> 
> ```
> child = pexpect.spawn('scp foo myname@host.example.com:.')
> child.expect ('Password:')
> child.sendline (mypassword) 
> ```

# android - 已发送消息的广播接收器

> ID：10372015
> 
> 赞同：3
> 
> 时间：2012-04-29T12:09:24.467
> 
> 标签：android, android-intent, sms, broadcastreceiver, extras

我正在开发一个发送短信的应用程序，并且我能够得到回复以了解是否发送了短信（或未发送）。但是由于我想确定发送了哪些短信（通过接收者和文本），所以我将这些信息添加到`intent`using `extras`.

这很好用，但仅适用于我发送的第一条消息。在第一条消息之后，我收到了相同的附加信息，而且我似乎总是发送相同的短信。实际上每条短信都是正确发送的，所以问题只与“发送的通知”有关。奇怪的是，当我收到另一条短信时，它又可以正常工作了（我得到了正确的附加信息），但只适用于一条短信。似乎一个新的 sms 事件“重置”了已发送消息的广播接收器。

这是我的代码：

```
class SmsSender{
private final String SENT = "SMS_SENT";
private static SmsSender instance=null;
private BroadcastReceiver br;
SmsSender(){}

    //SINGLETON
public static SmsSender getSmsSender(Context ctx, AddressBook ab, DBManager dbm){
    if(instance==null && ctx!=null){
    instance=new SmsSender();
    instance.ctx=ctx;
    instance.ab=ab;
    instance.dbm=dbm;
    instance.setBR();
    }
    return instance;
}

private void setBR(){
    br=new BroadcastReceiver(){
         public void onReceive(Context arg0, Intent arg1) 
            {  
                br=null;

                switch (getResultCode())                
                {              
                case Activity.RESULT_OK:  
                    if(arg1.hasExtra("text") && arg1.hasExtra("receiver")){
                            Log.i("SMS","SMS sent to "+arg1.getStringExtra("receiver")+": "+arg1.getStringExtra("text"));
                    }
                break;
                    .....
                 }
            }
        };

        ctx.registerReceiver(br, new IntentFilter(SENT));

}

public void send(String phoneNumber, String text) {
    String nums[]=phoneNumber.split(",");

    for(int i=0; i<nums.length; ++i){
    if(nums[i]!="" && text!=""){
                SmsManager sms = SmsManager.getDefault();

                ArrayList<String> parts = sms.divideMessage(text);
                messageCount = parts.size();
                ArrayList<PendingIntent> sentIntents = new ArrayList<PendingIntent>(messageCount);
                Intent myIntent=new Intent(SENT);

                **myIntent.putExtra("receiver", nums[i]);
                myIntent.putExtra("text", text);**

                for (int j = 0; j < messageCount; j++){
                    sentIntents.add(PendingIntent.getBroadcast(ctx, 0, myIntent,0));
                }

                    sms.sendMultipartTextMessage( nums[i].trim(), null, parts, sentIntents, null);
            }else{
            Notifica.notify(ab.getContactName(nums[i])+": Error sending SMS",ctx);
            }}

 }} 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T12:09:44.137

最后我解决了只是替换这一行的问题：

```
sentIntents.add(PendingIntent.getBroadcast(ctx, 0, myIntent,0)); 
```

有了这个：

```
sentIntents.add(PendingIntent.getBroadcast(ctx, 0, myIntent,PendingIntent.FLAG_UPDATE_CURRENT)); 
```

**从文档中**：

`FLAG_UPDATE_CURRENT` *...如果描述的 PendingIntent 已经存在，则保留它，但用这个新 Intent 中的内容替换其额外数据。如果您正在创建仅附加内容发生变化的意图，则可以使用此选项，并且不关心任何收到您之前的 PendingIntent 的实体将能够使用您的新附加内容启动它，即使它们没有明确提供。*

# c - 在 PostgreSQL 上返回不止一行崩溃

> ID：10372016
> 
> 赞同：1
> 
> 时间：2012-04-29T12:09:39.023
> 
> 标签：c, postgresql, crash

在 PostgreSQL 上，我在 C 中实现了以下存储过程：

```
extern "C" DLLEXPORT Datum
selectServeralRows(PG_FUNCTION_ARGS)
{
    FuncCallContext     *funcctx;
    int                  call_cntr;
    int                  max_calls;
    TupleDesc            tupdesc;
    AttInMetadata       *attinmeta;

    /* stuff done only on the first call of the function */
    if (SRF_IS_FIRSTCALL())
    {
        MemoryContext   oldcontext;

        /* create a function context for cross-call persistence */
        funcctx = SRF_FIRSTCALL_INIT();

        /* switch to memory context appropriate for multiple function calls */
        oldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);

        /* total number of tuples to be returned */
        funcctx->max_calls = 1;

        /* Build a tuple descriptor for our result type */
        if (get_call_result_type(fcinfo, NULL, &tupdesc) != TYPEFUNC_COMPOSITE)
            ereport(ERROR,
                    (errcode(ERRCODE_FEATURE_NOT_SUPPORTED),
                     errmsg("function returning record called in context "
                        "that cannot accept type record")));

        /*
         * generate attribute metadata needed later to produce tuples from raw
         * C strings
         */
        attinmeta = TupleDescGetAttInMetadata(tupdesc);
        funcctx->attinmeta = attinmeta;

        MemoryContextSwitchTo(oldcontext);
    }

    /* stuff done on every call of the function */
    funcctx = SRF_PERCALL_SETUP();

    if (funcctx->call_cntr < funcctx->max_calls)    /* do when there is more left to send */
    {
        Datum* val = (Datum*)palloc(2 * sizeof(Datum));
        HeapTuple    tuple;
        Datum        result;
        bool    nulls[2]={false,false};

        char * n = new char[2]; 
        n[0] = '1';
        n[1] = '\0';
        char * m = new char[2];
        m[0] = '2';
        n[1] = '\0';

        val[0] = CStringGetTextDatum(m);
        val[1] = CStringGetTextDatum(n);

        /* build a tuple */
        tuple = heap_form_tuple(tupdesc, val, nulls);

        /* make the tuple into a datum */
        result = TupleGetDatum(funcctx->slot, tuple);

        /* clean up (this is not really necessary) */

       SRF_RETURN_NEXT(funcctx, result);
    }
else
       SRF_RETURN_DONE(funcctx);
} 
```

代码几乎和这里一样：[http ://www.postgresql.org/docs/8.4/static/xfunc-c.html](http://www.postgresql.org/docs/8.4/static/xfunc-c.html)

如果该过程只返回一行，那么一切都很好，并且只有一行的表是所需的。但是如果这样改变一行

```
/* total number of tuples to be returned */
funcctx->max_calls = 2; 
```

查询的执行因以下消息而崩溃：

> 程序收到信号 EXC_BAD_ACCESS，无法访问内存。原因：KERN_INVALID_ADDRESS at address: 0x000000000000041a 0x0000000100002d8b in heap_form_tuple()

单步执行代码显示在崩溃之前什么都不是无效指针，所以我有点无能为力。还有什么我监督的吗？

编辑：该函数在 psql 中是这样调用的：

```
select (selectServeralRows()).* 
```

编辑：函数的 SQL 定义：

```
CREATE OR REPLACE FUNCTION selectServeralRows()
RETURNS TABLE(k character varying(20), j character varying(20)) AS
'/opt/local/lib/postgresql84/Debug/libSeveralRows', 'selectServeralRows'
LANGUAGE c STABLE STRICT; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T16:11:15.347

看来您省略了

```
 tuple = BuildTupleFromCStrings(funcctx->attinmeta, val); 
```

打电话之前`TupleGetDatum(...)`打电话。元组变量仍然未初始化，除了第一次调用。

另外，`Datum* val = (Datum*)palloc(2 * sizeof(Datum));`应该是

```
char **val;
val = palloc (2 * sizeof *val); 
```

n 和 m 数组也可以；

```
char n[2] ="1", m[2] = "2";
val[0] = n;
val[1] = m; 
```

你可以*在调用后*释放内存`heap_form_tuple(tupdesc, val, nulls);`

```
pfree(val); 
```

恕我直言，'val' 也可以是一个自动（“堆栈”）变量，就像 n[] 和 m[] 一样。

# javascript - 可以使引导程序中的下拉菜单像手风琴一样工作吗？

> ID：10372017
> 
> 赞同：1
> 
> 时间：2012-04-29T12:10:01.460
> 
> 标签：javascript, html, css, twitter-bootstrap, responsive-design

**编辑**：似乎已经实现了最新版本的引导程序（2.2.2）。

* * *

正如您在图像中看到的，当`navbar`菜单被折叠时，如果您有超过 4 个或 4 个下拉菜单，这可能会成为问题，因此在小屏幕上它会使页面变得很长。

[http://twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

![在此处输入图像描述](../Images/ea855cec015f727cd47e14d8c490a6ad.png)

**所以问题是，有可能让下拉菜单像手风琴一样工作吗？**

我尝试使用`data-toggle="collapse"`，但随后下拉菜单停止工作。

# c# - WCF 数据服务 - 如何编写此选择 LINQ 查询

> ID：10372028
> 
> 赞同：0
> 
> 时间：2012-04-29T12:11:49.127
> 
> 标签：c#, wcf, wcf-data-services

我有一个 WCF 数据服务。我不能使用这种格式（长篇大论，中间的代理类）我正在尝试编写这个 LINQ 查询：

```
from w in je.Streets
where w.CityId == (int)cb_City.EditValue
select new
    {
      HebName = w.HebName,
      EngName = w.EngName,
      ID = w.StreetID
     }).ToList(); 
```

像这样

```
ServiceEntities se = new ServiceEntities();
se.Streets.Where(s => s.CityId == (int)cb_City.EditValue).Select( ???????? ).ToList(); 
```

我没有成功，我得到

```
Error translating Linq expression to URI: Can only specify query options (orderby, where, take, skip) after last navigation. 
```

有人可以帮忙吗？？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T12:30:09.100

试试这个

```
se.Streets.Where(s => s.CityId == (int)cb_City.EditValue)
              .Select(s => new { 
                    HebName = s.HebName,
                    EngName = s.EngName,
                    ID = s.StreetID
              }).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:15:35.980

试试这个

```
je.Streets.Where(w = > w.CityId == (int)cb_City.EditValue).Select(x => 
   new {
          HebName = x.HebName,
          EngName = x.EngName,
          ID = x.StreetID
 }).ToList(); 
```

# actionscript-3 - 加载外部 SWF 文件

> ID：10372029
> 
> 赞同：0
> 
> 时间：2012-04-29T12:12:02.137
> 
> 标签：actionscript-3

我正在使用此代码卸载 swf 文件并返回主菜单。

主菜单可以毫无问题地加载外部 swf 文件，但由于某种原因无法卸载。

```
var BaseMovie:MovieClip = parent.parent as MovieClip;

FinishButton.addEventListener(MouseEvent.MOUSE_UP, RemoveGame );

function RemoveGame(i:MouseEvent):void
{   
    BaseMovie.loader.unload(); //Loads previous movie and unloads current movie.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:16:29.593

如果您在`BaseMovie`其他地方使用（并且您正在使用，因为您已将其添加到显示列表以使其可见），它不会因调用`Loader.unload()`.

要从`BaseMovie`显示列表中删除，请执行以下操作：

```
BaseMovie.parent.removeChild(BaseMovie); 
```

请注意，按照惯例，变量名以小写字母开头。因此，请`BaseMovie`使用`baseMovie`.

希望这有帮助，祝你好运。

# javascript - 在 javascript 中指定对象文字内的属性的不同方法

> ID：10372032
> 
> 赞同：2
> 
> 时间：2012-04-29T12:12:29.403
> 
> 标签：javascript, properties, object-literal

我已经看到以下两种在 javascript 中为对象文字指定属性的方法。

```
var a = {prop:2} 
```

和

```
var a ={'prop':2} 
```

这两种方式有什么区别。我知道第二种方法允许我们在属性名称中包含空格。还有其他优势吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T12:15:20.073

除了您观察到创建不是有效标识符的属性名称的能力之外，没有任何区别。通过使用带引号的字符串作为属性名称，可以使用任何字符串。当然，在访问此类属性时，您以后必须使用`[ ]`而不是`.`：

```
var obj = { 'crazy property name': 100 };

if (obj[ 'crazy property name' ] > 1) alert("hi"); 
```

请注意，严格的 JSON 语法*要求*引用属性名称，而且它*要求*始终使用双引号字符进行引用。

# c++ - 尝试读取 Windows 7 联系人不起作用

> ID：10372035
> 
> 赞同：1
> 
> 时间：2012-04-29T12:12:42.227
> 
> 标签：c++, visual-studio, windows-7, contacts, addressbook

我的代码基于[http://msdn.microsoft.com/en-us/library/ms735866.aspx](http://msdn.microsoft.com/en-us/library/ms735866.aspx)，在对函数 CreateNewContact() 进行了一些修改后，我尝试了以下方法。

我不再有错误，但什么也没发生：

```
IClassFactory* pFactory = NULL;
HRESULT rc;
rc = CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);
if (rc == S_OK)
    rc = CoGetClassObject(CLSID_Contact,CLSCTX_INPROC_SERVER,NULL,IID_IClassFactory, (void **) &pFactory);
if (rc == S_OK)
    rc = CreateNewContact( pFactory);
if (rc == S_OK)
    wprintf( L"Created\n"); 
```

我得到“已创建”，但在 C:\Users\myself\Contacts 中看不到任何新联系人，而只有我现有的联系人。

我不会在此处复制 CreateNewContact()，因为它可以在 URL 上找到。

任何帮助将不胜感激 ！

# java - Java 泛型树遍历

> ID：10372036
> 
> 赞同：3
> 
> 时间：2012-04-29T12:13:01.637
> 
> 标签：java, tree, traversal

我有一个问题要在 Java 中解决。我有一棵需要遍历的树。这里是：

```
 1
     /     \
   1 2 3  1 2 3      
 /   |  \    \
123 123 123  same for those three nodes 
```

现在需要遍历它的方式是从根开始，然后遍历最深的最左侧节点（此处为 1）及其最左侧的叶子（1）。之后它应该再次从根开始跟踪所有数字，这次到达同一个最深的最左边节点的下一个叶子..等等，即从顶部开始，每次一个一个地到达所有剩余的叶子那个节点。在跟踪了最左边节点的所有叶子之后，它应该像往常一样继续（从顶部开始），现在移动到下一个不请自来的节点（这里是 2）.. 以此类推所有树。所以前 6 条轨迹是：

111 112 113 121 122 123 ... 以此类推

所有被追踪的号码都需要按上述方式依次追踪和记录。任何人都可以帮助解决如何实现它的算法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:38:53.700

你需要的是一个树遍历算法。

```
void traverse(Node root, String path) {
    path += root.getValue();
    for (Node child : root.getChildren())
        traverse(child, path);

    // end of current traversal
    if (root.getChildren().isEmpty())
        System.out.print(path + " ");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:15:29.843

您所描述的内容称为[深度优先搜索](http://en.wikipedia.org/wiki/Depth-first_search)。你应该知道这不是最有效的算法，还有更好的算法，比如[Dijkstra 的](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)。

根据您尝试执行的操作，甚至可以采用更专业的策略，例如[Alpha-Beta 修剪](http://en.wikipedia.org/wiki/Alpha-beta_pruning)或其他启发式方法来进行游戏搜索。

如果您设置使用深度优先搜索并希望返回从根到该节点的路径，您可以在找到目标节点后使用类似以下内容。假设`node`是你的目标节点......

```
List<Node> path = new ArrayList<Node>();
path.add(node);
while(node.parent != null){
  path.add(node.parent);
  node = node.parent;
}
return path; //returns a path from {goal,...,root} 
```

# python - 套接字 Python 连接

> ID：10372041
> 
> 赞同：0
> 
> 时间：2012-04-29T12:13:31.970
> 
> 标签：python, sockets, networking, tcp

我正在使用套接字在 Python 中编写客户端/服务器软件。

我有一个问题，专门针对 TCP/IP 和 Socket 模型：

我在服务器端使用这个代码示例（Python 中的服务器端程序）：

```
import socket
# Create a TCP/IP socket
server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Prevent from "address already in use"
server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

# Bind the socket to port
server_address = ("localhost", 5000)
server.bind(server_address)

# Listen for connections
server.listen(5)

# Wait for on incomming connection
read = connection.recv(1024)
print "Received: ",read 
```

一切都很好，***但我有一些概念性问题：***

**1）**启用这种通信的最佳实践是什么？我是否必须为 CLIENT 和 SERVER 程序之间的 TCP/IP 设置心跳流量？我看到即使我让客户端程序没有流量（空闲）与服务器，当我回来并发送另一条消息（连接建立后的很多分钟和几分钟）时，消息仍然存在。这是正常行为吗？

**2)** TCP/IP 栈甚至“socket 模块”有任何类型的 TIMEOUT 功能？！？！我可以控制谁使用 socket 模块在 Python 中丢失了我们的“超时”连接？

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:51:09.647

在 TCP 中，不需要心跳来保持连接处于活动状态。只要两个端点仍然健康，连接就会存在。

但是，心跳可用于及早检测故障。否则，只有在您尝试发送数据（或期望另一端发送数据）时，您才会发现连接是否仍然存在。在许多情况下，这已经足够了。但是对于某些（例如 IRC 应用程序），您想在客户端关闭后立即知道，因此您可以通知其他人他们已从频道中删除。

您也许可以使用`SO_KEEPALIVE`套接字选项自动发送心跳包，但我没有这方面的经验。[这个问题](https://stackoverflow.com/questions/5435098/how-to-use-so-keepalive-option-properly-to-detect-that-the-client-at-the-other-e)可能会有所帮助。

对于超时，请使用`SO_RCVTIMEO`和`SO_SNDTIMEO`套接字选项。`man 7 socket`有关更多信息，请参阅[Python 套接字文档](http://docs.python.org/library/socket.html)。

# c# - 如何将 PointF 列表转换为 IntPtr？

> ID：10372044
> 
> 赞同：0
> 
> 时间：2012-04-29T12:13:56.100
> 
> 标签：c#, .net, emgucv

[我正在使用 EmguCV，但我不知道如何为此处](http://www.emgu.com/wiki/files/1.5.0.0/Help/html/215e547a-75d0-7e82-36db-bbc144cd9e22.htm)记录的图像点传递 2xN、Nx2、3xN、Nx3 或 1xN（N 是点数）的数组。

我有一种创建 float[N,2] 数组的方法，但是 Marshal.Copy 没有多维数组的重载，我不知道如何将 X 和 Y 值作为一个传递。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:39:19.973

您只需调用该[`cvCreateMat`](http://www.emgu.com/wiki/files/1.5.0.0/Help/html/4c51e2f8-2296-af60-2ddb-10d9dfbdde95.htm)函数来创建这些矩阵。本[机接口的文档](http://opencv.willowgarage.com/documentation/camera_calibration_and_3d_reconstruction.html#findfundamentalmat)包含很好的示例，展示了如何执行此操作。

为了设置您可以使用的数据[`cvSet2D`](http://www.emgu.com/wiki/files/1.5.0.0/Help/html/6c18515c-48e4-3187-62aa-5df1b748dd0a.htm)。它不如直接指针访问效率高，但从托管代码中实现这一点相当困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:36:34.873

试试这个：

```
float[,] floats = new float[2,3];
IntPtr intPtr = Marshal.UnsafeAddrOfPinnedArrayElement(floats, 0); 
```

以下方法可能有效，但可能会对 GC 产生问题，因此请谨慎使用：

```
float[,] floats = new float[3, 2];

fixed (void* pt = array)
{
    IntPtr intPtr = new IntPtr(pt);

    CallMethod(intPtr, other parameters...);
} 
```

但是被调用的方法应该以某种方式知道维度是什么。可能按名称（DoSomething2x3、DoSomething3x2 等），或按参数（DoSomething(IntPtr ptr, int width, int height)）

# java - Swing：jLabel.setText 调用太晚

> ID：10372046
> 
> 赞同：1
> 
> 时间：2012-04-29T12:14:21.480
> 
> 标签：java, swing

我有申请：

*   一个用于用户输入的 JTextField，
*   一个 JLabel 来回显示忙碌状态，
*   一个用于打印搜索结果的 JTextArea。

我希望用户将文本写入文本字段，按 Enter 并查看结果。我有这样的听众：

```
private void searchForPattern(java.awt.event.ActionEvent evt) {
        textArea.setText("");
        busyLabel.setText("Searchnig ...");
        doSearch();
        busyLabel.setText("Idle");
    } 
```

在**doSearch**中有一个相当复杂的算法，它会打开大量 XML 文件并搜索给定的模式，这需要一段时间。只有在 doSearch 完成后，busyLabel 的文本才会更改为 Searching ...。doSearch 中没有第二个线程，只有大量的 IO 操作。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:16:17.467

您有一个经典的 Swing 并发问题（教程：Swing中的[并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)），其中 doSearch 正在占用 Swing 事件线程。由于这个线程是 Swing 进行所有绘画/绘图和与用户交互的地方，如果它被需要花费任何可察觉时间来完成的代码所束缚，整个应用程序将“冻结”，没有组件更新和所有用户交互被忽视。

解决方案：在后台线程上执行，例如 SwingWorker 对象提供的线程。`done()`在 SwingWorker 的方法中将“空闲”字符串设置到 JLabel 中。

IE，

```
private void searchForPattern(java.awt.event.ActionEvent evt) {
  textArea.setText("");
  busyLabel.setText("Searching ...");
  new SwingWorker<Void, Void>() {
     @Override
     protected Void doInBackground() throws Exception {
        doSearch();
        return null;
     }

     @Override
     protected void done() {
        busyLabel.setText("Idle");
     }
  }.execute();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:44:40.140

您还可以使用 SwingUtilities 的[invokeLater](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/SwingUtilities.html#invokeLater%28java.lang.Runnable%29)方法从应用程序线程更新 GUI swing 组件。

```
private void searchForPattern(java.awt.event.ActionEvent evt) {

  SwingUtilities.invokeLater(
    new Runnable(){
      public void run(){        
         textArea.setText("");
         busyLabel.setText("Searchnig ...");
      }
    }
  );

  doSearch();

  SwingUtilities.invokeLater(
    new Runnable(){
      public void run(){
         busyLabel.setText("Idle");
      }
    }
  );
} 
```

**编辑** *PS*：这里我假设你没有从 EDT 调用 searchForPattern() 函数，这意味着如果你从 ActionListener 调用它，你必须像这样调用它：

```
new Thread(
   new Runnable(){
      public void run(){
         searchForPattern(....)
      }
    }
  ).start(); 
```

# android - Android SQLite 查询和使用游标过滤和排序行

> ID：10372049
> 
> 赞同：2
> 
> 时间：2012-04-29T12:14:56.287
> 
> 标签：android

目前，我正在制作 android 程序，该程序使用**where**查询根据名称过滤行，但是当我将它与**按**查询排序（时间）一起使用时，排序不起作用。如果我只使用 order by 而没有 WHERE 它工作正常。

```
String WHERE="name LIKE'%John%';";

Cursor cur = db.query("tbl_schedule", 
            null, WHERE, null, null, null, "time"); 
```

# c++ - 语法错误：缺少 ';' 前 '{'

> ID：10372058
> 
> 赞同：0
> 
> 时间：2012-04-29T12:15:32.263
> 
> 标签：c++

我写了一个带有两个属性（数组）的简单类。我正在尝试将所有数组元素初始化为 0 或 NULL，但编译器（vc++ 2010）会抛出错误。

```
class Marina{
public:
char port[100];
char bport[25];

Marina(){
this->port = {0};
this->bport = {0}; 
}

}; 
```

我也尝试过这样的简单语句：

```
class Marina(){
public:
char port[100] = {0};
char port[25] = {0};

}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:21:37.640

你需要这个：

```
Marina() : port(), bport() {} 
```

这会用全零初始化两个数组。

在 C++11 中，您可以在声明时定义非静态成员变量，因此您可以这样做：

```
class Marina {
public:
  char port[100] = {0};
  char bport[25] = {0};
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:17:20.853

```
Marina(){
//std::fill is in <algorithm>
std::fill (port, port + 100, 0);
std::fill (bport, bport + 25, 0); 
```

此代码段缺少某些内容。没有结束大括号！我用只要有支架就可以工作的东西替换了你的作业。

除此之外，您的代码仍然不会以这种方式编译，因为必须在初始化列表中完成初始化：

```
Marina()
    : port ({0}), bport ({0}) {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T12:28:35.203

你的牙套不匹配。您的开括号比闭括号多一个。大括号不匹配的代码格式不正确。不幸的是，响应缺少右括号的编译器消息并不总是最清晰的。编译器如何知道您忘记用右大括号关闭哪个左大括号？

# python - 在python中退出正在运行的命令

> ID：10372060
> 
> 赞同：0
> 
> 时间：2012-04-29T12:15:57.547
> 
> 标签：python

我是 python 新手。我正在编写一个调用命令行工具并在屏幕上显示命令输出的脚本。问题是命令运行后它不会自行退出，它需要手动输入 ctrl-c 来停止并继续执行其余的 python 脚本。有谁知道我怎样才能让它自行停止并继续执行脚本的其余部分？

```
cmd ='./ppshelper -sms "15062929382" warning'
os.system(cmd)
print "SMS sent" 
```

在用户按下 ctrl-c 之前，不会打印“SMS sent”

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:37:05.450

利用[`Popen`](http://docs.python.org/library/subprocess.html#popen-objects)

```
from subprocess import Popen
p = Popen(['/full/path/to/ppshelper', '-sms', '15062929382','warning'])
p.terminate() 
```

# github - 如何通过查看 github 的网络图来选择要使用的正确分支/fork？

> ID：10372063
> 
> 赞同：9
> 
> 时间：2012-04-29T12:16:39.513
> 
> 标签：github, branch, branching-and-merging, fork

我需要使用在 github 上公开可用的第 3 方代码。我正在查看该代码的 github 网络图，我可以看到其他分支有一些未合并到原始存储库中的提交。

**应该如何决定哪个分支/叉子适合我？**

在遇到此类问题时，请考虑您的考虑。

正如John Feminella 所[建议](https://stackoverflow.com/a/10372089/539560)的，应该始终使用（通常是稳定的）“项目的已发布版本”。

我当然同意这一点，但这个问题在以下情况之一中仍然相关：

*   原作者不再维护该代码。
*   我需要的一项功能在原始版本中未实现，但在多个分叉中以不同方式实现
*   代码仍处于开发阶段，每个分支都与原始版本有一些差异（无论是在功能上，还是在开发决策和实现上）

我遇到过很多次这样的情况，目前原作者仍在努力维护回购，但似乎他没有足够的时间，其他分叉更活跃。没有一个分叉被宣布足够稳定以供生产使用。上次我遇到这种情况时，原始存储库也没有实现对我很重要的功能。

所以在这种情况下，我需要选择最稳定的分支，尝试在我的代码中使用它，彻底测试它，并可能做出一些改进以使其稳定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T12:21:02.867

**更新：** OP 澄清了他最初的问题，表明该项目已经死了。

鉴于一个项目已经死亡并且它有 N 个分叉，选择“最佳分叉”的通常策略取决于许多因素：

*   有没有人宣布他们将接管该项目的维护？在邮件列表、公共论坛等（不仅仅是在 GitHub 上）搜索新闻。如果是这样，请开始跟随那个叉子。

*   网络图上是否有来自另一个分叉（而不是，比如说`master`）提交的分叉？如果是这样，这表明支持正在围绕这个另一个分支合并，作为死项目的可能替代品。

*   如果其中任何一个都不起作用，请进行更多挖掘：该项目是否存在前段时间分离的项目变体，现在围绕哪些支持组织？如果是这样，也许其他项目会满足您的需求。

如果做不到这一切，有时项目就没有继续进行的支持。如果是这样，也许是时候自己挠痒痒了！

* * *

**原答案：**

对此有几点评论：

*   通常，您应该使用项目的已*发布版本*，而不是选择特定的分支或分支。如果你不这样做，你的依赖项将在每次项目更新时发生新的提交，这可能会导致你自己的代码中难以发现的错误。

*   如果您决定始终想要最新版本并且您可以接受这种风险，那么请使用项目的`master`分支，因为那是官方分支。当您访问存储库的主页时，这将是您正在查看的默认分支。

*   人们通常分叉存储库，以对原始代码库进行某种修改并征求反馈。

*   因此，除非您正在就该修改进行协作，或者除非您对尽早访问该特定修改特别感兴趣，否则您**无需担心其他分叉。**

在极少数情况下，项目的官方主线开发分支会被称为`master`. 在这种情况下，您应该查阅 README 以了解您应该查看哪个分支。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-08-09T07:43:19.987

完成约翰的回答。

我正在使用[http://gitpop.heroku.com](http://gitpop.heroku.com)，这对于查找最流行和活跃的分叉很有用。这是非常基本的，但它确实有效。

编辑：与 2014 年 3 月一样，GitPop 坏了，所以我自己写了，因为它对我有用。 [http://gitpop2.herokuapp.com](http://gitpop2.herokuapp.com)

# java - 当 io 包已经有方法可用时，java nio 包的确切用途是什么

> ID：10372066
> 
> 赞同：48
> 
> 时间：2012-04-29T12:17:31.527
> 
> 标签：java, nio, java.nio.file

我正在学习 java nio 包，我意识到 File 已经提供了很多方法，nio.Files 通过使用 Path 类再次提供了这些方法。就像我得到的那样。我实际上并没有得到 nio 包的实际用途。

我对这个包很陌生，所以我的问题可能是错误的，但一点帮助可以帮助我进一步阅读。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-29T12:20:16.953

IO 和 NIO 的主要区别在于 IO 是阻塞的，而 NIO 是非阻塞的。

[本文](http://tutorials.jenkov.com/java-nio/nio-vs-io.html)解释了包的区别以及阻塞和非阻塞 IO 是什么。[存档](https://web.archive.org/web/20200426101234/http://tutorials.jenkov.com/java-nio/nio-vs-io.html)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-11-25T21:07:07.180

Java 编程，I/O 直到最近才使用流隐喻进行。所有 I/O 都被视为单个字节的移动，一次一个，通过一个称为 Stream 的对象。Stream I/O 用于联系外部世界。它也在内部使用，用于将对象转换为字节，然后再转换回对象。

NIO 与原始 I/O 具有相同的作用和目的，但它使用了不同的比喻——块 I/O。java.nio (new/non-blocking I/O) ) API 是随 JDK1.4 引入的。

**流 I/O 和块 I/O 有什么区别？**

面向流的 I/O 系统一次处理一个字节的数据。输入流产生一字节数据，输出流消耗一字节数据。为流数据创建过滤器非常容易。将几个过滤器链接在一起也相对简单，这样每个过滤器都可以在一个单一的、复杂的处理机制中发挥作用。另一方面，面向流的 I/O 通常相当慢。

面向块的 I/O 系统以块的形式处理数据。每个操作在一个步骤中产生或消耗一个数据块。通过块处理数据可能比通过（流式）字节处理数据快得多。但是面向块的 I/O 缺乏面向流的 I/O 的一些优雅和简单。

**什么时候应该使用 java.io 什么时候应该使用 java.nio ？**

1.  可扩展性可能会推动您选择软件包。java.net 每个套接字需要一个线程。编码它会容易得多。java.nio 效率更高，但很难编写代码。

2.  一旦处理数以万计的连接，您可能会获得更好的可扩展性，但在较低的数量下，您可能会通过阻塞 IO 获得更好的吞吐量。

3.  当使用 SSL java.nio 时，处理起来并不容易

重要提示：如果您正在使用任何一个包，除非您有令人信服的理由，否则从头开始创建框架不是一个好主意。

对于 java.nio ，Grizzly 和 Quick Server 等项目提供了可重用的非阻塞服务器组件。

值得一读[java.nio 的痛点](http://blog.uncommons.org/2008/09/03/avoid-nio-get-better-throughput/)

最后归结为您的项目的特定要求以及您要实现的目标。一些最好的解决方案可能根本不需要最复杂的基础设施

更新：最近发现了自 jdk 1.7 以来存在的 NIO.2 包。NIO.2 与 NIO 不同，主要是 NIO.2 提供了异步通道功能。[NIO.2 底漆](http://www.ibm.com/developerworks/java/library/j-nio2-1/index.html)

如果您正在与 NIO 合作，那么值得一试差异以及哪一个适合您的目的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-02-04T07:09:44.213

**Java NIO：通道和缓冲区**
在标准 IO API 中，您使用字节流和字符流。在 NIO 中，您使用通道和缓冲区。数据总是从通道读入缓冲区，或从缓冲区写入通道。

**Java NIO：非阻塞 IO**
Java NIO 使您能够进行非阻塞 IO。例如，线程可以要求通道将数据读入缓冲区。当通道将数据读入缓冲区时，线程可以做其他事情。一旦数据被读入缓冲区，线程就可以继续处理它。将数据写入通道也是如此。

**Java NIO：选择器**
Java NIO 包含“选择器”的概念。选择器是一个对象，可以监视多个通道的事件（例如：连接打开、数据到达等）。因此，单个线程可以监视多个通道的数据。
[有关 orcal 的更多详细信息](http://docs.oracle.com/javase/tutorial/essential/io/fileio.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-30T13:01:17.363

由于兼容性原因，几乎每个方法`java.io.File`都存在无法修复的问题，最明显的是方法`boolean`在失败时返回 a。这些问题加上支持可插拔文件系统的愿望和许多其他事情需要开发一个全新的文件系统 API，所以这就是`java.nio.File`创建的原因。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-26T03:30:26.900

NIO 还引入了 Channels，抽象出 Stream 中的专业化——文件、套接字、网络。

# flash - 动画横幅的尖端挥动（就像风中的旗帜）

> ID：10372067
> 
> 赞同：0
> 
> 时间：2012-04-29T12:17:40.480
> 
> 标签：flash, animation, actionscript, 2d, banner

我目前有一个旗帜的 2D 图像，这是我从客户那里得到的。我应该用它创建一个闪光横幅，但旗帜的尖端需要“在风中挥动”。

有没有办法在 Flash 或 Actionscript(3.0) 中做到这一点，而不需要我在多个帧中绘制横幅的尖端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:26:48.403

将标志分成三角形并使用`Graphics.drawTriangles`. 然后以编程方式为顶点设置动画。有关概念概述，请参阅[此链接](http://www.3dtutorialzone.com/tutorial?id=41)（该链接是关于 3D 建模和动画标志，但它是相同的概念）。

# xslt - XSL:FO / Apache FOP 中的内联图像数据

> ID：10372069
> 
> 赞同：12
> 
> 时间：2012-04-29T12:17:42.483
> 
> 标签：xslt, pdf, mime, xsl-fo, apache-fop

我有想要使用 XSL:FO 转换为 PDF 的 MIME 多部分数据。我很喜欢使用[Apache James](http://james.apache.org/)[阅读 MIME](http://www.wissel.net/blog/d6plinks/SHWL-8TMJFU)，并且我掌握了 Mime中的[嵌入式图像数据或 HTML 中的](https://www.rfc-editor.org/rfc/rfc2387)[内联图像](http://danielmclaren.com/2008/03/embedding-base64-image-data-into-a-webpage)。我努力搜索[“[xsl-fo] 内联图形”](https://stackoverflow.com/search?q=%5Bxsl-fo%5D+inline+graphic)和[“[xsl] +html +mime +image”](https://stackoverflow.com/search?q=%5Bxsl%5D+%2Bhtml+%2Bmime+%2Bimage)，并以某种方式找到[了相反的结果](https://stackoverflow.com/questions/1684909/xslt-convert-base64-data-into-image-files)和我想要的[先驱。](https://stackoverflow.com/questions/6691983/how-to-encode-a-image-in-xml-file-with-help-of-xslt)[谷歌关于“将 HTML MIME 转换为 XSL:FO”](http://www.google.com/search?q=convert+HTML+MIME+to+XSL%3AFO)也没有定论。

我想要做的是在 XSL:FO 转换的 PDF 输出中使用一个元素（或一组元素）来呈现图形（JPG/PNG/GIF - 全部或部分）。图形数据应作为 Base64（或其他）编码数据包含*在.fo 文件中。*我找到了如何指向[外部图形](http://www.w3.org/TR/2006/REC-xsl11-20061205/#fo_external-graphic)，但没有关于嵌入式图形数据。

那将如何运作？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-29T15:11:48.563

该元素`fo:external-graphic`也可用于嵌入内联数据。只需使用以下语法：

```
<fo:external-graphic src="url('data:image/jpeg;base64,<DATA>')"/> 
```

`<DATA>`应替换为 JPEG 图像的 base64 数据字符串。

# hook - Liferay 自定义逻辑

> ID：10372070
> 
> 赞同：0
> 
> 时间：2012-04-29T12:17:48.660
> 
> 标签：hook, liferay

我知道我可以通过创建一个 hook 来扩展现有的功能。但是如果我需要创建全新的自定义 *Utils 类并将这个类包含在 Liferay 核心中怎么办。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:45:09.333

您可以在挂钩中使用 Liferay 的服务构建器创建自定义服务。

生成服务后。您将在钩子的 lib 目录中生成的 *service.jar**移动**到 [Server]/lib/ext 文件夹（全局路径），然后部署钩子。

这样，访问服务的接口（*ServiceUtil 和 *LocalServiceUtil 类）将可用于所有 portlet 和钩子（即您可能覆盖的 liferay 的核心），并且服务的实现（即您自己的逻辑）将在钩。

# c# - 如何创建通用局部视图以从 flickr 渲染照片

> ID：10372077
> 
> 赞同：1
> 
> 时间：2012-04-29T12:19:13.303
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, razor

我正在创建一个我想要的个人 flickr 页面，以便显示我的 flickr 照片、收藏等。

我正在使用 asp.net mvc 3 技术执行此操作。这个小项目实际上是我试图为自己完成的第一个真正的项目。看看我是否掌握了 MVC 的基础知识。

因此，我建立了一个小型框架，以便能够通过 Flickr 进行身份验证并获取我的请求的 JSON 响应。（包含图像数据）

我将这些图像渲染为列表。这是对此的看法：

```
<body>
<div id="container">
<div id="slideshow">
    <ul id="slides">
        @Html.Partial("PhotoList", Model)
    </ul>
</div>
</div> 
```

这是使用以下类型的强类型视图：

```
 public class FlickrPhotoCollection
    {
       public string size { get; set; }
       public List<FlickrPhoto> photo { get; set; }
    } 
```

如您所见，它包含一个带有照片对象和大小的列表。size 属性是设置图像的大小。（“t”=缩略图，“m”=中等，....）

接下来使用另外两个局部视图：

照片列表：

```
 @model FlickrPhotoCollection               
  @ViewBag.Size = @Model.size;

  @foreach (FlickrPhoto p in Model.photo)
  {
      <li>                   
        @Html.Partial("Photo", p)          
      </li>
   } 
```

照片：

```
@model FlickrPhoto

<img src="@(Model.display()" name="modal" class="photo" ref="@Model.owner" flickrId="@Model.id" /> 
```

FlickrPhoto 的显示方法会根据需要的大小返回实际图像的路径。

```
private string display(string size)
    {
        if (!string.IsNullOrEmpty(size))
        {
            size = "_" + size;
        }
        return String.Format("http://farm{0}.static.flickr.com/{1}/{2}_{3}{4}.jpg", farm, server, id, secret, size);
    } 
```

如您所见，此方法需要一个大小参数，而我没有在视图中传递大小参数。

我的问题：我应该在我的代码中进行哪些更改，以便正确传递 size 参数？

结果应该是我可以在控制器中设置大小参数，并且我的视图将根据此参数呈现不同大小的图像。

这是我希望我的控制器的样子：

```
 public ActionResult PhotoViewer()
    {
        FlickrMethods flickrmethods = new FlickrMethods();
        FlickrPhotoCollection photocollection = flickrmethods.getPublicPhotos("57820970@N06", "1");
        photocollection.size = "b";
        return View(photocollection);
    } 
```

我再次重复我的问题：如何将大小“b”传递给在我的局部视图“照片”中使用的 FlickrPhoto 类的显示方法？

我希望我说得足够清楚才能理解。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:25:55.197

您将需要将该`size`属性放入`FlickrPhoto`类中并在您的加载方法中相应地设置它。然后在您的照片视图中，您可以替换它：

```
<img src="@(Model.display()" name="modal" class="photo" ref="@Model.owner" flickrId="@Model.id" /> 
```

有了这个：

```
<img src="@(Model.display(Model.size))" name="modal" class="photo" ref="@Model.owner" flickrId="@Model.id" /> 
```

# symfony - 当 targetEntity 在不同的包中时出错

> ID：10372078
> 
> 赞同：7
> 
> 时间：2012-04-29T12:19:16.570
> 
> 标签：symfony, doctrine-orm

尝试执行以下操作时出现以下错误`./app/console doctrine:migrate:diff`：

```
 [Doctrine\ORM\Mapping\MappingException]                                        
  Class VNN\CoreBundle\Entity\Game is not a valid entity or mapped super class. 
```

这是导致它的行：

```
/**
 * @ORM\ManyToOne(targetEntity="VNN\CoreBundle\Entity\Game") 
```

这是我课程的相关部分：

```
<?php

namespace VNN\PressboxBundle\Entity;

use Gedmo\Mapping\Annotation as Gedmo;
use Doctrine\ORM\Mapping as ORM;
use Doctrine\ORM\Query\Expr\OrderBy;
use Symfony\Component\Validator\Constraints as Assert;
use Symfony\Component\Validator\Mapping\ClassMetadata;
use Symfony\Component\Validator\Constraints\NotBlank;
use Symfony\Component\Validator\Constraints\Type;
use VNN\CoreBundle\Entity\Game;

/**
 * VNN\PressboxBundle\Entity\Event
 *
 * @ORM\Table(name="event")
 * @ORM\Entity
 */
class Event
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @ORM\ManyToOne(targetEntity="VNN\CoreBundle\Entity\Game")
     * @ORM\JoinColumn(name="core_game_id", referencedColumnName="game_id")
     **/
    private $coreGame; 
```

我理解它的意思不是它*找不到* `VNN\CoreBundle\Entity\Game`，只是那`Game`不是一个有效的实体。所以这里是`Game.php`：

```
<?php

namespace VNN\CoreBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * VNN\CoreBundle\Entity\Game
 *
 * @ORM\Table(name="games")
 * @ORM\Entity
 */
class Game
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="game_id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var integer $homeSchoolId
     *
     * @ORM\Column(name="home_school_id", type="integer")
     */
    private $homeSchoolId;

    /**
     * @var integer $awaySchoolId
     *
     * @ORM\Column(name="away_school_id", type="integer")
     */
    private $awaySchoolId;

    /**
     * @ORM\ManyToOne(targetEntity="School")
     * @ORM\JoinColumn(name="home_school_id", referencedColumnName="school_id")
     **/
    private $homeSchool;

    /**
     * @ORM\ManyToOne(targetEntity="School")
     * @ORM\JoinColumn(name="away_school_id", referencedColumnName="school_id")
     **/
    private $awaySchool;

    /**
     * @ORM\ManyToOne(targetEntity="Sport")
     * @ORM\JoinColumn(name="sport_id", referencedColumnName="sport_id")
     **/
    private $sport;

    /**
     * @var integer $datetime
     *
     * @ORM\Column(name="game_datetime")
     */
    private $datetime;

    /**
     * @var integer $homeScore
     *
     * @ORM\Column(name="home_score", type="integer")
     */
    private $homeScore;

    /**
     * @var integer $awayScore
     *
     * @ORM\Column(name="away_score", type="integer")
     */
    private $awayScore;

    public function getId()
    {
        return $this->id;
    }

    public function getHomeSchool()
    {
        if ($this->homeSchoolId > 0) {
            return $this->homeSchool;
        } else {
            return FALSE;
        }
    }

    public function getAwaySchool()
    {
        if ($this->awaySchoolId > 0) {
            return $this->awaySchool;
        } else {
            return FALSE;
        }
    }

    public function recordIsValid()
    {
        if (!($this->homeSchoolId > 0)) {
            return FALSE;
        }

        if (!($this->awaySchoolId > 0)) {
            return FALSE;
        }

        return TRUE;
    }

    public function getSport()
    {
        return $this->sport;
    }

    public function getHumanDatetime()
    {
        $date = new \DateTime($this->datetime);
        return $date->format('F d, Y g:ia');
    }

    public function getDatetime()
    {
        $date = new \DateTime($this->datetime);
        return $date->format('m/d/Y g:i:s a');
    }

    public function getOpposingSchoolWithRespectToSchoolName($schoolName)
    {
        if ($schoolName == $this->getHomeSchool()->getName()) {
            return $this->getAwaySchool();
        } else {
            return $this->getHomeSchool();
        }
    }

    public function getHomeScore()
    {
        return $this->homeScore;
    }

    public function getAwayScore()
    {
        return $this->awayScore;
    }
} 
```

为什么不喜欢`Game`？

更新：当我尝试对另一个跨捆绑实体做同样的事情时，我又遇到了同样的问题。我找到[了这篇文章](https://stackoverflow.com/questions/7688602/how-can-i-use-a-different-namespace-class-in-doctrine2-targetentity-mapping)，但是 add-a-leading-slash 修复并没有像它显然对那里的 OP 那样为我做。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-11T23:41:07.033

i've successfully used cross bundle entity relations without any problems. if you have automatic mapping disabled you need to tell doctrine each bundle that contains entities.

so in app/config.yml you need to have either this:

```
doctrine:
    orm:
        auto_mapping: true 
```

or this:

```
doctrine:
    orm:
        auto_mapping: false
        entity_managers:
            default:
                mappings:
                    VNNCoreBundle: ~
                    VNNPressboxBundle: ~ 
```

check your database if tables for the bundles exist. also you could try running `./app/console doctrine:generate:entities --force` and make sure it runs without errors

**edit**

i checked my code and the leading `/` is not necessary. also the `use` statement is superfluous.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T23:32:55.383

我能够在我的捆绑包中得到这样的东西。

```
/**
 * @ORM\ManyToOne(targetEntity="\Company\SomeBundle\Entity\Game")
 */ 
```

您不需要该`use \Company\SomeBundle\Entity\Game`声明。

此外，请确保在您的`AppKernel.php`文件中启用了这两个捆绑包。

# android - Flex Mobile 4.6 Unicode Android

> ID：10372080
> 
> 赞同：0
> 
> 时间：2012-04-29T12:19:40.683
> 
> 标签：android, apache-flex, unicode, character

我正在使用 flash builder 4.6 为 android 构建应用程序。我正在尝试在此 xml “http://www.bbc.co.uk/hindi/index.xml”中显示 unicode 字符

在 flash builder 提供的模拟器上运行时字符显示正确，但在 android 上安装时显示方框 [][][][][][][][][]。我该如何解决这个问题，以便正确嵌入字体？

我测试的 android 版本是 2.3.5。我的代码如下`

```
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
       creationComplete="newCreationComplete(event)" fontSize="11" fontWeight="bold"
        xmlns:s="library://ns.adobe.com/flex/spark" title="News">
    <fx:Style>
        @namespace s "library://ns.adobe.com/flex/spark";

        .messageStyle{
            height:20;
            fontSize:11;
            fontWeight:normal;
        }

    </fx:Style>
    <fx:Script>
        <![CDATA[
            import com.adobe.serialization.json.JSON;

            import mx.collections.ArrayCollection;
            import mx.core.FlexGlobals;
            import mx.events.FlexEvent;
            import mx.rpc.events.FaultEvent;
            import mx.rpc.events.ResultEvent;

            import spark.events.IndexChangeEvent;

            [Bindable] private var newsCollection:Array;

            protected function httpServiceNews_resultHandler(event:ResultEvent):void
            {

                if(!newsCollection)
                    newsCollection = new Array();

                var atom:Namespace = new Namespace("http://www.w3.org/2005/Atom");
                var media:Namespace = new Namespace("http://search.yahoo.com/mrss/");

                var entryList:XMLList = (event.result as XML)..atom::entry;

                for each(var xml:XML in entryList){
                    var object:Object = new Object();
                    object.imageUrl = xml.atom::link..media::thumbnail.(@width == "106").@url;

                    object.summary = xml.atom::summary;
                    object.title = xml.atom::title;

                    newsCollection.push(object);

                }
            }

            protected function httpServiceNews_faultHandler(event:FaultEvent):void
            {
                // TODO Auto-generated method stub

            }

            protected function newCreationComplete(event:FlexEvent):void
            {

                httpServiceNews.send();

            }

        ]]>
    </fx:Script>
    <fx:Declarations>

        <s:HTTPService id="httpServiceNews" result="httpServiceNews_resultHandler(event)"
                       fault="httpServiceNews_faultHandler(event)" resultFormat="e4x" 
                       url="http://www.bbc.co.uk/hindi/index.xml" />
    </fx:Declarations>

    <s:List  dataProvider="{new ArrayCollection(newsCollection)}"  width="100%" height="100%"
             click="newsListSelectedIndexChanged(event)" >
        <s:itemRenderer>
            <fx:Component>
                <s:IconItemRenderer 
                                    iconFunction="newsIconFunction"

                                    messageField="summary"
                                    labelFunction="myLabelFunction"
                                    messageStyleName="messageStyle">
                    <fx:Script>
                        <![CDATA[

                            protected function myLabelFunction(item:Object):String{
                                return item.title;
                            }
                            protected function newsIconFunction(item:Object):String{
                                return item.imageUrl;
                            }
                        ]]>
                    </fx:Script>
                </s:IconItemRenderer> 
            </fx:Component>
        </s:itemRenderer>
    </s:List>
</s:View> 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T15:27:57.177

在我看来，默认的 android 字体不支持这个字符集

您将希望在您的应用程序中嵌入带有这些字符的字体。这个过程非常简单，请查看此链接：

[http://help.adobe.com/en_US/flex/mobileapps/WS19f279b149e7481c6a9f451212b87fe7e87-8000.html](http://help.adobe.com/en_US/flex/mobileapps/WS19f279b149e7481c6a9f451212b87fe7e87-8000.html)

# c++ - 将编译器从 x86 程序集移植到 LLVM

> ID：10372082
> 
> 赞同：11
> 
> 时间：2012-04-29T12:19:55.800
> 
> 标签：c++, assembly, compiler-construction, x86, llvm

所以最近，为了磨练我的汇编技能，我用 C++ 为一种玩具语言编写了一个非常简单的编译器。它运行单遍，并在解析阶段直接将代码发送到多个字符串流，每个字符串流代表一段代码（即一个代表`section .bss`，而其他代表`.data`和`.text`）。之后，这些字符串流被写入一个文件，我使用 NASM 和 gcc 来组装和链接它们。我知道这种单通道方法效率极低，但同样，这更像是一种理解代码生成阶段的练习，而不是其他任何东西。无论如何，我想修改我的代码以直接发出 LLVM IL 而不是原始汇编，再次作为学习练习。是否有 LLVM IL 的入门级指南？或者，甚至更好的工具来确定一行汇编的等效 IL 代码？我看了看，我只找到了完整的规范，这比我需要的信息多得多。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-29T12:53:44.473

LLVM IR 语言参考[可在此处获得](http://llvm.org/docs/LangRef.html)。请注意，这是一个详细的参考页面，而不是教程。x86 程序集和 LLVM IR 之间没有直接的一对一对应关系，尽管由于 LLVM IR 比 x86 程序集更高级别和更通用，因此将编译器从发出 x86 调整为发出 LLVM IR 应该不会太难。

LLVM 官方文档附带了一个[详细的教程](http://llvm.org/docs/tutorial/)，这绝对是您的最佳起点——它介绍了从简单的高级编程语言创建玩具编译器到 LLVM IR。通过学习，您将学习 LLVM 的许多关键概念，然后能够有效地使用上述语言参考。

*如果您发现本教程有任何问题，请将它们报告给 LLVM 错误跟踪器或邮件列表。该教程有望正常运行，任何报告的问题都将得到修复。*

了解 LLVM IR 的另一个很好的入门资源是[在线演示页面](http://llvm.org/demo/)。它允许您在线将 C 代码块编译为 LLVM IR（无需安装任何东西），并且对于理解如何在 LLVM IR 中表示基本编程结构非常有帮助。

# lucene - 对不同的项目使用相同的 neo4j 数据库和索引

> ID：10372083
> 
> 赞同：0
> 
> 时间：2012-04-29T12:20:06.127
> 
> 标签：lucene, indexing, neo4j

如何配置程序以使用另一个创建的 lucene 全文节点索引？

我有两个项目可以访问同一个 neo4j 数据库。第二个项目连接到数据库，识别现有索引，但索引查询返回空指针错误。第一个项目中创建索引的相同查询代码将返回 100 多个节点。谢谢

项目一：

```
GraphDatabaseService greatest = new EmbeddedGraphDatabase(graphLocation);

IndexManager greatestManager = greatest.index();

Index<Node> greatestIndex = greatestManager.forNodes("property1",MapUtil.stringMap(IndexManager.PROVIDER, "lucene", "type", "fulltext")); 
```

项目二：

```
GraphDatabaseService second = new EmbeddedGraphDatabase(graphLocation);

IndexManager secondManager = second.index();

public Integer countHits() {
    IndexHits<Node> hits = greatestIndex.query("property1", new QueryContext("*"));
    Integer hitsSize = hits.size();
    return hitSize;
} 
```

最大.countHits ==> 100+ 个节点

second.countHits ==> NullPointerException

# php - 快速生成图像

> ID：10372086
> 
> 赞同：1
> 
> 时间：2012-04-29T12:20:27.693
> 
> 标签：php, javascript, html, canvas

我正在创建一个应用程序，让您可以在网络上预览字体，就像[myfonts](http://www.myfonts.com/search/tag%3asansserif/fonts/)一样。有谁知道他们是怎么做到这么快的？

我的方法是使用 HTML5 Canvas 和一些 Javascript 生成字体预览。这是在服务器端使用 PHP GD 库或 Imageick 生成图像的替代方法。

然而，尽管使用 HTML5 画布使事情变得快速，并且所有处理都在客户端。我无法隐藏我加载的字体，因为我必须使用 font-face 来加载字体：

```
 @font-face {
        font-family: 'Press Start 2P';
        src: url('fonts/PressStart2P.ttf');
    } 
```

并使用 JS 渲染到画布上：

```
 $('#draw').click(function () {
            var canvas = $('canvas')[0],
            ctx = canvas.getContext('2d');
            ctx.font = '12px "Press Start 2P"';
            ctx.fillStyle = '#000';
            ctx.fillText('Hello, world!', x, y += 20);
            ctx.fillRect(x - 20, y - 10, 10, 10);
        }); 
```

关于如何将字体路径保密或任何其他快速生成图像的替代方法的任何想法。我需要非常频繁地在每个页面上生成大约 40 多个图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:31:42.323

我不认为他们生成它们的速度真的很快。文本是静态的，用户无法更改，因此他们可以预先生成所有图像。

如果您需要动态文本，您确实可以选择在客户端或服务器端呈现。

如果你想对用户“隐藏”字体，唯一的方法是服务器端渲染。确实没有办法允许浏览器使用字体，但不允许用户将其保存到他们喜欢的任何地方。他们可以只使用 Chrome Inspector 或 Firebug 来访问您的网页下载的任何资源，无论您如何混淆 URL。

# asp.net-mvc-3 - 将现有 MVC2 Web 应用程序迁移到 MVC3 的快速且安全的方法

> ID：10372087
> 
> 赞同：0
> 
> 时间：2012-04-29T12:20:46.727
> 
> 标签：asp.net-mvc-3, asp.net-mvc-2, migrate

我们一直在使用 .Net v3.5 SP1 和 MVC 2。后端 SQL Server 2005。它是一个使用多个 AJAX 和 jQuery 功能的 web 2.0 Web 应用程序。

> 现在我们要迁移到 .Net v4.0 和 MVC 3。主要原因是大多数升级和增强功能在 MVC3 上会更好。我们希望以一种能够确保稳定性的方式进行迁移，并在可能的情况下帮助我们快速安全地迁移。

*我在 SO 上找到了一些线程，但已经很长时间了，所以我想知道最好的方法。*

我们可以延迟我们的视图迁移到“Razor 视图引擎”吗？除此之外，我们应该准备在迁移期间进行哪些更改。例如，这里有一些我知道 -

*   我相信我们的 web.config 将在 .Net v4.0 中进行重大改造。
*   RegisterRoutes 需要任何更改吗？
*   需要查看 Global.asax.cs 的任何具体内容吗？
*   我们有用户控件和编辑器模板——有什么变化吗？
*   我们已经明确引用了用户控件以及 Html.EditorFor - 任何更改或更新？
*   基于表单的身份验证、属性、扩展方法、操作过滤器等​​……我希望这些旧东西能很好地适应。

**平台**：我希望 VS.Net 2010 + MVC 3 就足够或需要任何 SP 等。？

任何工具都可以帮助 - 比如：http: [//blogs.msdn.com/b/marcinon/archive/2011/01/13/mvc-3-project-upgrade-tool.aspx](http://blogs.msdn.com/b/marcinon/archive/2011/01/13/mvc-3-project-upgrade-tool.aspx)

我已经浏览了着名的[scottgu 参考链接](http://weblogs.asp.net/scottgu/archive/2011/01/13/announcing-release-of-asp-net-mvc-3-iis-express-sql-ce-4-web-farm-framework-orchard-webmatrix.aspx)。它确实有很多信息，但用于迁移的信息不多。对不起，来晚了。我只是想避免你学习中的错误。

谢谢你。

Ref: 就这么简单[！](http://www.asp.net/whitepapers/mvc3-release-notes#upgrading) 或[http://www.mrrives.com/Technology/?p=743](http://www.mrrives.com/Technology/?p=743)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T14:57:43.323

以下是我进行升级的方式 -

**迁移** 有关迁移过程及其将进行的更改的详细说明。实际上它和 ASP.Net v1.1 for v3.5 一样深（旧），事情更容易（跳过那些为 ASP.Net v1.1 到 3.5 迁移提供的手动更新。例如，你不需要升级你的如果您的应用程序在 v3.5 中，则用于部分类设计的用户控件和页面）

> [http://msdn.microsoft.com/en-us/magazine/ff956194.aspx](http://msdn.microsoft.com/en-us/magazine/ff956194.aspx)

更不用说，请确保您有备份，并注意通过转换日志查找问题。VS.Net 2010 转换向导随时为您服务。*或者，您可以继续使用目标 .Net 框架 v3.5 或升级到 v4.0（就像我一样）*

**迁移后** 您需要查找一些与 .Net v4.0 升级相关的问题——比如它会对控件和 URL 的文本内容进行 HTMLEncode（因此“”将变为“%20”）——我遇到了一些[问题](https://stackoverflow.com/questions/591694/url-encoded-slash-in-url)！

***web.config 更新***，如 - controlRenderingCompatibilityVersion 等......这是一个很好的参考 -

> [http://www.hanselman.com/blog/IntegratingASPNETMVC3IntoExistingUpgradedASPNET4WebFormsApplications.aspx](http://www.hanselman.com/blog/IntegratingASPNETMVC3IntoExistingUpgradedASPNET4WebFormsApplications.aspx)

最后**MVC 3** 手动升级，如果不复杂的话会很困难，所以我继续使用自动化工具。它太棒了！

> [http://aspnet.codeplex.com/releases/view/59008](http://aspnet.codeplex.com/releases/view/59008)

希望这可以帮助。我仍在测试和修改我的网络应用程序以解决迁移后的任何其他问题。让我知道是否有任何编辑！

谢谢你。

# java - 关于Android进度条的工作

> ID：10372092
> 
> 赞同：0
> 
> 时间：2012-04-29T12:21:23.397
> 
> 标签：java, android, android-layout

我对android中的进度条有疑问。我还没有实施它，但由于时间不足，我想确保何时实施我最好清楚将要发生什么以及为什么..

```
dialog = new ProgressDialog(this);
        dialog.setCancelable(true);
        dialog.setMessage("Loading...");
        // set the progress to be horizontal
        dialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        // reset the bar to the default value of 0
        dialog.setProgress(0);

        // get the maximum value
        EditText max = (EditText) findViewById(R.id.maximum);
        // convert the text value to a integer
        int maximum = Integer.parseInt(max.getText().toString());
        // set the maximum value
        dialog.setMax(maximum);
        // display the progressbar
        dialog.show();

        // create a thread for updating the progress bar
        Thread background = new Thread (new Runnable() {
           public void run() {
               try {
                   // enter the code to be run while displaying the progressbar.
                   //
                   // This example is just going to increment the progress bar:
                   // So keep running until the progress value reaches maximum value
                   while (dialog.getProgress()<= dialog.getMax()) {
                       // wait 500ms between each update
                       Thread.sleep(500);

                       // active the update handler
                       progressHandler.sendMessage(progressHandler.obtainMessage());
                   }
               } catch (java.lang.InterruptedException e) {
                   // if something fails do something smart
               }
           }
        });

        // start the background thread
        background.start();

    }

    // handler for the background updating
    Handler progressHandler = new Handler() {
        public void handleMessage(Message msg) {
            dialog.incrementProgressBy(increment);
        }
    }; 
```

这是我从某处获取的上述代码......正如这段代码所说，我必须将我的实际代码保持在下面尝试以保持进度条运行。我怀疑我的代码是一个非常冗长的代码，其中包含嵌套的 for 循环（用所有这些位和字节解析整个文件）..如果我在该部分的那个部分保留我的冗长过程，它如何更新进度条直到它完成任务？我错过了一些概念吗？请解释我如何保持我的进程运行并更新进度条？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:28:49.943

您应该使用 AsynTask 并在其方法中显示您的 ProgreesBar 并在其`onPreExecute()`方法中关闭 ProgressBar `onPostExecute()`。在 method.Further 中执行所有加载`doInBackground()`内容，以更新 ProgressBar 的使用`onProgressUpdate()`

这将有所帮助：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:35:34.170

我认为您缺少的概念是，如果您想要做多件事（在进度条中显示进度并做一些实际工作），您需要使用多个线程。这就是为什么您需要创建一个单独的线程来完成实际工作。

即使你的代码真的很长，试着重构它，把它分解成新的类和方法。

# actionscript-3 - 了解视频中的 GOP 大小（i 帧/p 帧比率）是多少

> ID：10372094
> 
> 赞同：0
> 
> 时间：2012-04-29T12:21:39.800
> 
> 标签：actionscript-3, ffmpeg, video-encoding, codec, mencoder

我正在用动作脚本中的视频做东西，我需要寻找一个视频来确定帧。根据参考资料，使用 NetStream.seek 我只能寻找最近的 k 帧：

```
Seeks the keyframe (also called an I-frame in the video industry) closest to the specified location. The keyframe is placed at an offset, in seconds, from the beginning of the stream.

Video streams are usually encoded with two types of frames, keyframes (or I-frames) and P-frames. A keyframe contains an entire image, while a P-frame is an interim frame that provides additional video information between keyframes. A video stream typically has a keyframe every 10-50 frames. 
```

所以我需要了解以 .f4v 格式编码的视频中有多少 p 帧和 i 帧。

我在mac和ubuntu上，我不关心要使用的工具（也许一些ffmpeg/mencoder调用应该是完美的），有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T16:01:17.177

如果您使用的是 Adob​​e Media Encoder，您可以在视频选项卡/高级设置下设置自定义预设。

检查设置关键帧距离，然后将其设置为 1 帧

这应该会产生很高的关键帧数。

希望这可以帮助。

# php - SwiftMailerBundle：[语义错误]与 getMapType() 方法

> ID：10372099
> 
> 赞同：0
> 
> 时间：2012-04-29T12:23:55.307
> 
> 标签：php, symfony, swiftmailer

我正在做一个 Symfony2 项目。我必须建立一个移动设备可以访问的网络服务。网络服务使用**SwiftmailerBundlle**向新设备发送电子邮件。

Swiftmailer 也是整个项目的邮件发送者。除了我的网络服务之外，它在每个捆绑包上都能完美运行。当**网络服务尝试使用 Swiftmailer 发送电子邮件时，我总是收到 500 type error**。最奇怪的部分是尽管出现了 500 错误，但还是发送了邮件！

这是我得到的错误：

“[语义错误] Swift_CharacterReader_Utf8Reader::getMapType() 方法中的注释 \"@int\" 从未导入。您可能忘记为此注释添加 \"use\" 语句吗？"

SwifMailerBundle 中的方法：

类 Swift_CharacterReader_Utf8Reader 实现 Swift_CharacterReader {

```
/**
* Returns mapType
* @int mapType
*/
public function getMapType()
{
    return self::MAP_TYPE_POSITIONS;
}
} 
```

这是我的网络服务使用的类中的代码：

```
$message = \Swift_Message::newInstance();
$message->setSubject($subject)
->setFrom('test@exemple.com')
->setTo('test@exemple.com')
->setBody("Test")
;

$this->mailer->send($message); 
```

SwiftMailerBundle 版本=4.1.3

这是在我读过的每个文档中实现 Swiftmailer 的方法。你们看到我的问题可能是什么吗？捆绑中有错误吗？我的实施错了吗？

我很困惑，提前感谢您抽出宝贵时间。

埃洛迪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:26:55.863

只需删除 @int 注释，它就会弄乱 symfony 的注释阅读器

# java - 为什么我在传递 RandomAccessFile.writeUTF 这些参数时会出错？

> ID：10372100
> 
> 赞同：-2
> 
> 时间：2012-04-29T12:23:55.690
> 
> 标签：java

```
ManageStock2.java:104: error: method writeUTF in class RandomAccessFile cannot b
e applied to given types;
                                        in.writeUTF(authors , titles ,ISBN);
                                          ^
  required: String
  found: String,String,String
  reason: actual and formal argument lists differ in length
1 error 
```

我已经初始化了变量。

```
String ISBN,ISBN2,authors,titles; 
int levels,level2,stock; 
```

我需要知道要写什么。我已经检查了api。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:28:13.830

该函数[接受一个参数](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/RandomAccessFile.html#writeUTF%28java.lang.String%29)，而您提供三个。将调用分为三个：

```
in.writeUTF(authors);
in.writeUTF(titles);
in.writeUTF(ISBN); 
```

这将一个接一个地写入三个字符串。如果你想应用格式（例如字段分隔符等），你可以使用`StringBuilder`or `String.format()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:29:33.563

就像错误消息说的那样，您`writeUTF`使用**三个**参数调用，但它只需要**[一个](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html#writeUTF%28java.lang.String%29)**：

> 公共最终无效`writeChars(String s)` 抛出 IOException
> 
> 将字符串作为字符序列写入文件。`writeChar`每个字符都像通过该方法一样写入数据输出流。写入从文件指针的当前位置开始。

相反，请进行三个单独的调用：

```
in.writeUTF(authors);
in.writeUTF(titles);
in.writeUTF(ISBN); 
```

# objective-c - 从不同的类调用时无法访问 NSMutableArray 的内容

> ID：10372102
> 
> 赞同：0
> 
> 时间：2012-04-29T12:24:36.687
> 
> 标签：objective-c, cocoa, nsarray

我希望有一个可以在我的 Objective-C 项目中访问的数组，我可以在必要时更改其内容。我的问题是，当我从不同的类调用数组时，我总是得到空值，这不是我想要的。

在我的 .h 文件中，我有

```
@interface MainScreen2 : UIViewController
@property (nonatomic, strong) NSMutableArray *Judith; 
```

在 .m 文件的 viewDidLoad 函数中，我有：

```
@interface MainScreen2 ()

@end

@implementation MainScreen2
@synthesize Judith;

- (void)viewDidLoad
{
   self.Judith = [[NSMutableArray alloc]     initWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9", nil];                                                    
    [super viewDidLoad];
} 
```

这可以。

在一个单独的课程中，我有：

```
#import "MainScreen2.h"

@interface NewGame ()
@end

- (void)viewDidLoad
{
    MainScreen2 *testJudith;

    NSMutableArray *testJudithArray = [[NSMutableArray alloc]init];
    testJudithArray = [testJudith.Judith mutableCopy];
    NSLog(@"Jud test: %@", [testJudith.Judith objectAtIndex:1]);
} 
```

并且此时`NSLog`返回 null。这是因为当我从 MainScreen.h 文件中调用 Judith 数组时，它是空的，因为它尚未加载？

如果是这样，谁能帮我把数组放在哪里，这样当我调用它时，我会保留它的原始内容？

* * *

编辑：4月30日

结合使用此页面上的建议，我现在已经解决了问题，并且现在可以正常工作。

```
I changed the code to the following:

- (void)viewDidLoad
{
MainScreen2 *testJudith = [[MainScreen2 alloc]init];
[testJudith viewDidLoad];
NSString *test = [testJudith.Judith objectAtIndex:1];
NSLog(@"Jud test: %@", test);
} 
```

感谢所有为论坛帖子做出贡献的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:29:45.003

让我们看一下这段代码：

```
MainScreen2 *testJudith;
NSMutableArray *testJudithArray = [[NSMutableArray alloc]init];
testJudithArray = [testJudith.Judith mutableCopy]; 
```

这段代码有两个*严重*的问题。

1.  `testJudithArray`初始化，然后再次初始化。第一个值被丢弃。除非您使用 ARC，否则这是内存泄漏。无论哪种方式，都没有必要对其进行两次初始化。

2.  `testJudith`未**初始化**。如果幸运的话，程序会崩溃。你很不走运，所以程序给了你不正确的结果。

您必须进行初始化`testJudith`才能使您的代码正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:29:16.783

你说过：`MainScreen2 *testJudith;`这将 testJudith 设置为 nil。

然后，您创建了一个数组：

```
NSMutableArray *testJudithArray = [[NSMutableArray alloc]init]; 
```

然后将 testJudithArray 重置为 testJudith 的 Judith 数组的可变副本：

```
testJudithArray = [testJudith.Judith mutableCopy]; 
```

但是 testJudith 是零。你没有把它设置为任何东西。这意味着 nil 的属性将始终为/返回 nil。然后，您尝试制作 nil 的 mutableCopy。因此，testJudithArray 变为 nil。

您一开始还没有创建 testJudith，因此您永远不会创建您要求制作可变副本的数组。mutableCopy 方法因此返回 nil（因为发送到 nil 的任何消息都返回 nil）。

这是否足以解释您的错误在哪里？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T20:20:17.583

尝试使用单例。您可以谷歌单例以获取更多信息。使用单例将允许您从项目中的任何位置访问相同的字符串、数组等。

通过添加一个新的 Objective-C 类并使其成为 NSObject 的子类来创建一个单例。例如：

```
#import <Foundation/Foundation.h>
@interface MyClass : NSObject
+(MyClass *)sharedInstance;
@end

#import "MyClass.h"
@implementation MyClass
+ (MyClass *) sharedInstance
{
if (!_sharedInstance)
{
    _sharedInstance = [[MyClass alloc] init];
}
return _sharedInstance;
}
@end 
```

如果您在 MyClass 中创建 NSMutableArray，只要您在要访问单例的类的 .m 文件中 #import "MyClass" ，就可以从程序的任何其他类访问它。

要从另一个类访问您的 MyClass 数组，请执行以下操作：

```
MyClass *myClass = [MyClass sharedInstance];
NSString *myString = [[myClass someArray] objectAtIndex:1]; 
```

要将某些内容添加到您的 MyClass 数组，请执行以下操作：

```
[[myClass someArray] addObject:@"something"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T20:40:23.183

`viewDidLoad`与`init`...不同，您要么将 NSArray 的分配移入，要么`init`调用`[testJudith viewDidLoad];`

# jquery - jquery：循环旋转项目

> ID：10372103
> 
> 赞同：0
> 
> 时间：2012-04-29T12:24:37.893
> 
> 标签：jquery

你如何让这个滑动导航栏进入循环？

我做了一个简单的 jquery，只是增加了边距，你能想出一种轻松循环这个东西的方法吗？

现在，如果您单击足够多次，它将显示空白区域...

任何帮助表示赞赏。

jsfiddle：http: [//jsfiddle.net/utKqe/2/](http://jsfiddle.net/utKqe/2/)

```
//other category page, navigate through cats
    $(document).ready(function() {

        $('#otherleftarrow').click(function() {
            $('#othermenu ul').animate({marginLeft: '-=100px'}, 200);
            return false; // prevent default click action from happening!
        });

        $('#otherrighttarrow').click(function() {
            $('#othermenu ul').animate({marginLeft: '+=100px'}, 200);
            return false;
        });

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:34:35.987

这个任务有一个相当不错的 jQuery 插件：[jCarousel](http://sorgalla.com/projects/jcarousel)。

[圆形轮播示例](http://sorgalla.com/projects/jcarousel/examples/static_circular.html)。

您可以轻松地将其用于您的目的。

# ant - 动态更新 Ivy 额外属性

> ID：10372106
> 
> 赞同：1
> 
> 时间：2012-04-29T12:25:12.620
> 
> 标签：ant, ivy

我计划在 ivy.xml 文件中使用额外的属性，以便能够访问修订号部分，我需要这样做，以便我可以将这些值用于 ivysettings.xml 文件中的解析器模式：

```
<ivy-module version="2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:e="http://ant.apache.org/ivy/extra" xsi:noNamespaceSchemaLocation="http://ant.apache.org/ivy/schemas/ivy.xsd">
    <info organisation="MyCompany" module="MyModule" revision="1.2.3.4" e:shortrev="1.2.3" e:buildnum="4" publication="20120207140052" />
    ...
</ivy-module> 
```

我想在构建过程中动态更新**shortrev**和**buildnum**额外属性，以便在发布此模块时，它们的值将与它一起保存，并且我可以在 ivysettings.xml 文件中将这些额外属性用于解析器模式。

```
<resolvers>
    <filesystem name="fs.resolver">
        <ivy pattern="${my.dir}/[organisation]/[module]/[shortrev]/[buildnum]/ivy.xml" />
        <artifact pattern="${my.dir}/[organisation]/[module]/[shortrev]/[buildnum]/[artifact].[ext]" />
    </filesystem>
</resolvers> 
```

有人[建议](https://stackoverflow.com/a/10355999/275332)我可以尝试使用 Ivy 文件中的属性来动态设置它们的值，但我不清楚如何去做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T15:32:46.067

此示例使用来自 ANT的标准[buildnumber任务。](http://ant.apache.org/manual/Tasks/buildnumber.html)不幸的是，[常春藤版本号](http://ant.apache.org/ivy/history/latest-milestone/use/buildnumber.html)任务无法正确解析解析器定义中具有额外属性的模块:-(

# 例子

```
$ tree
.
|-- build.xml
|-- ivysettings.xml
|-- ivy.xml
`-- src
    `-- main
        `-- HelloWorld.java 
```

## 常春藤.xml

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<ivy-module version="2.0" xmlns:e="http://ant.apache.org/ivy/extra">
    <info organisation="MyCompany" module="MyModule" e:shortrev="${publish.target.revision}" e:buildnum="${publish.buildnumber}"/>

    <configurations defaultconfmapping="compile->default">
        <conf name="compile" description="Required to compile application"/>
        <conf name="runtime" description="Shared library needed at runtime" extends="compile"/>
        <conf name="test"    description="Required for test only" extends="runtime"/>
    </configurations>

    <publications>
        <artifact name="MyModule" type="jar" e:shortrev="${publish.target.revision}" e:buildnum="${publish.buildnumber}"/>
    </publications>

    <dependencies>
        <dependency org="commons-lang" name="commons-lang" rev="2.6"/>
        <dependency org="junit" name="junit" rev="4.8.2" conf="test->default"/>
    </dependencies>

</ivy-module> 
```

笔记：

*   额外的属性与信息**和**工件定义相关联。

## 构建.xml

```
<project xmlns:ivy="antlib:org.apache.ivy.ant" name="publish-example" default="build">

    <!--
    ==========
    Properties
    ==========
    -->
    <property name="src.dir"     location="src/main"/>
    <property name="build.dir"   location="build"/>
    <property name="classes.dir" location="${build.dir}/classes"/>
    <property name="reports.dir" location="${build.dir}/reports"/>

    <property name="publish.target.revision" value="1.2.3"/>
    <property name="publish.status"   value="release"/>
    <property name="publish.resolver" value="custom.repository"/>

    <!--
    =======
    Targets
    =======
    -->
    <target name='init' description='Resolve project dependencies and set classpaths'>
        <ivy:resolve/>
        <ivy:report todir='${reports.dir}' graph='false' xml='false'/>

        <ivy:cachepath pathid="compile.path"  conf="compile"/>
        <ivy:cachepath pathid="runtime.path"  conf="runtime"/>
        <ivy:cachepath pathid="test.path"     conf="test"/>

        <mkdir dir="${classes.dir}"/>
    </target>

    <target name="compile" depends="init">
        <javac srcdir="${src.dir}" destdir="${classes.dir}" includeantruntime="false" classpathref="compile.path"/>
    </target>

    <target name="build" depends="compile">
        <ivy:info/>
        <jar destfile="${build.dir}/${ivy.module}.jar" basedir="${classes.dir}"/>
    </target>

    <target name="publish-revision" description="Determine the new published revision">
        <buildnumber/>

        <property name="publish.revision" value="${publish.target.revision}.${build.number}"/>
        <property name="publish.buildnumber" value="${build.number}"/>
    </target>

    <target name="publish" depends="build,publish-revision" description="Publish artifacts into repository">
        <ivy:deliver deliverpattern="${build.dir}/ivy.xml" pubrevision="${publish.revision}" status="${publish.status}"/>

        <ivy:publish resolver="${publish.resolver}" pubrevision="${publish.revision}" overwrite="true">
            <artifacts pattern="${build.dir}/[artifact].[ext]"/>
        </ivy:publish>
    </target>

    <target name="clean" description="--> clean project files">
        <delete dir="${build.dir}"/>
    </target>

    <target name="clean-all" depends="clean" description="--> clean ivy cache">
        <ivy:cleancache />
    </target>

</project> 
```

笔记：

*   ivy[交付](http://ant.apache.org/ivy/history/latest-milestone/use/deliver.html)任务确保正确填充已发布的 ivy 文件。

## 常春藤设置.xml

```
<ivysettings>
    <settings defaultResolver="central"/>
    <resolvers>
        <ibiblio name="central" m2compatible="true"/>
        <filesystem name="custom.repository">
            <ivy pattern="${ivy.settings.dir}/repository/[organisation]/[module]/[shortrev]/[buildnum]/ivy.xml" />
            <artifact pattern="${ivy.settings.dir}/repository/[organisation]/[module]/[shortrev]/[buildnum]/[artifact].[ext]" />
        </filesystem>
    </resolvers>
</ivysettings> 
```

笔记：

*   我总是将 Maven Central 设置为我的默认解析器，以便检索第三方依赖项，如 commons-lang 和 junit。
*   custom.repository解析器在构建文件中配置为属性“publish.resolver **”**

# macos - 如何处理窗口的阴影？

> ID：10372107
> 
> 赞同：3
> 
> 时间：2012-04-29T12:25:40.993
> 
> 标签：macos, cocoa, nswindow, shadow

例如：放大阴影，去除底部阴影，...

我试图覆盖 NSWindow 的**invalidateShadow**选择器，但是当窗口的阴影改变时它没有被调用。我不想删除阴影，我想防止阴影失效。什么时候调用**invalidateShadow ？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T10:03:15.937

怎么样..

*   让你的`NSWindow`影子少，
*   使用一个 2\. transparent`NSWindow`和一个 custom `NSView`，都比原来的窗口稍大，
*   将其设置为*内容*窗口的子窗口，
*   将您认为合适的任何阴影/装饰物绘制到该自定义视图中。

# jquery - 在jquery中显示某些元素的悬停效果

> ID：10372108
> 
> 赞同：0
> 
> 时间：2012-04-29T12:25:41.630
> 
> 标签：jquery

我有以下 javascript 代码，用于使悬停在下面生效

*   标签。我有 2 个类 show_on_hover 的跨度，除非用户将鼠标悬停在 li 项目上，否则我希望它是不可见的。

    然而，当我将鼠标悬停在它上面时，即使是下面的 javascript 代码也无法将不透明度更改为 1。请帮我。下面的代码有什么问题？

    需要注意的一点是，下面的 li 代码只是一个虚拟 li。页面上有类似的 35 li，因此当我将鼠标悬停在那个特定的 li 标记上时，只会显示 li 的 show_on_hover 效果。

    javascript

    ```
     $(".altbgcolor").live({
                    mouseenter: function() {
                        var el= $(this);
                        el.addClass('altbgcolor-active');
                        el.data('hover', setTimeout(function()
                            {
                                if (el.hasClass('altbgcolor-active'))
                                {
                                    el.find(".sharedp").slideDown('normal');
                                         el.contents().find(".show_on_hover").css("opacity","1");

                                }
                            }, 1500)
                        );      
                    },
                    mouseleave: function () {
                        var el= $(this);
                        clearTimeout(el.data('hover'));
                        el.removeClass('altbgcolor-active')
                            .find(".sharedp")
                            .slideUp('normal');
                    }
                }); 
    ```

    李码

    ```
     <li class="altbgcolor" id=1436>
                        <div>   <a href=http://mashup2.sunnydsouza.com/mobile/1436/ target="_blank" rel="nofollow">
                            <div class="newsthumb" center center no-repeat;"><img src="/images/mobile/thumb_1436_100X100.jpg"  /></div>
                            </a>

                            <div class="newstext" style="margin:0px;">

                            <a href=http://mashup2.sunnydsouza.com/mobile/1436/full/ target=_blank style="text-decoration:none; "><h1 style="color:#081C28;"><img width="11" height="9" src="/content/icon_topic_newest.gif"> Twitter Reviews ‘The Hunger Games’ in 140 Characters or Less &nbsp;</h1></a>

                                <div style="font-size: 0.4em; color:#666666;">  

                                                <span style="text-decoration:none; color:none; "><i> via <a href="http://mashup2.sunnydsouza.com/user/1/" style="text-decoration: none;color:#105289 ;" onmouseover="this.style.textDecoration = 'underline'" onmouseout="this.style.textDecoration = 'none'">demo1</a></i></span>                          
                                                <i>in <a href="http://mashup2.sunnydsouza.com/mobile/" style="text-decoration: none;color:red ;" onmouseover="this.style.textDecoration = 'none'" onmouseout="this.style.textDecoration = 'none'">Mobile</a></i>                            
                                                <span style="text-decoration:none; color:none; ">

                                                <a class="example7" href="comments_3.php?id=1436" style="text-decoration:none; color:#666666; "><img src="content/comment/comments.png" width=18 height=18><i>No comments</i></a></span>

                                                <span class="show_on_hover" style="text-decoration:none; color:none; margin:5px; opacity:0.001;"><img src="content/styles/images/view_count_icon.png" >  38 views</span>    
                                                <span class="show_on_hover" style="text-decoration:none; color:none; margin:5px;opacity:0.001;"><img src="content/styles/images/rating_count_icon.png" >  6 votes</span>    
                                                <br><br>
                                                <div class="ratings">

                                                    <div class="rating-L">

                                                        <form class="ratedStars" id="rat1436" action="" method="post">

                                                            <select name="rate"><option value="1436_1">Not so great</option><option value="1436_2">Quite good</option><option value="1436_3">Good</option><option value="1436_4" selected  >Great!</option><option value="1436_5">Excellent!</option></select>

                                                            <input type="submit" value="Rate it!" />

                                                        </form>

                                                    </div>
                                                </div>  <br>

                                </div>

                            </div>
                         <div class="clear"></div>
                         </div>

                         <div class="sharedp">
                             <div style="font-size: 0.7em; color:#666666;"> 
                             <span style="text-decoration:none; color:none; "> Posted By: <a href="http://mashup2.sunnydsouza.com/user/1/" style="text-decoration: none;color:#105289 ;" onmouseover="this.style.textDecoration = 'underline'" onmouseout="this.style.textDecoration = 'none'">demo1</a></span>                         
                             |   <span style="text-decoration:none; color:none; "> Date: <i>March 24, 2012, 1:03 pm</i></span> <t />
                            </div>
         </li> 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T12:38:29.740

不要使用`mouseenter`，使用[悬停](http://api.jquery.com/hover/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T15:42:06.387

能够通过对这个 span 标签的每个实例使用 id 来解决这个问题。通过使用 $(this).attr('id') 获取当前 id，然后使用它使计数可见/不可见 $('feed_count_'+id).css('opacity',1)

# javascript - 使用 jQuery 和 "if/else" 制作动画

> ID：10372110
> 
> 赞同：0
> 
> 时间：2012-04-29T12:25:57.643
> 
> 标签：javascript, jquery

我又回来了另一个 jQuery 问题，哇！这就是我正在尝试做的事情，我有文本字段，如果用户没有输入任何内容，我希望它的背景变为红色，或者如果输入内容则变为绿色。这两项检查都发生在“blur”上，我使用的是“.animate()”。更改背景颜色。（我有 jQuery-Color 让我为颜色设置动画）。这是我的脚本：

```
<head>
    <script type="text/javascript" src="assets/javascript/jQuery.js"></script>
    <script type="text/javascript" src="assets/javascript/jQuery-color.js"></script>
    <script>
    var jQ=jQuery.noConflict();

    var fullNameValue=jQ(".fullName").attr("value");

    jQ(document).ready(function(){
        jQ(".fullName").blur(function(){
            if(fullNameValue==null || fullNameValue==""){
                jQ(".fullName").animate({
                    backgroundColor: "#AF383C",
                    color: "#FFFFFF"
                });
            }
            else{
                jQ(".fullName").animate({
                    backgroundColor: "#78BB6C",
                    color: "#000000"
                });
            }
        });
    });
    </script>
</head> 
```

目前，在模糊时，即使在文本字段中输入了某些内容，文本字段也会变为红色，这可能意味着我的 if 语句有问题，对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:28:39.213

您的“fullNameValue”变量是在`<input>`字段本身*尚未在 DOM 中*时建立的。该语句应该*在*您的“模糊”处理程序中。

```
jQ(document).ready(function(){
    jQ(".fullName").blur(function(){
        var fullNameValue=jQ(".fullName").attr("value");
        if(fullNameValue==null || fullNameValue==""){
            jQ(".fullName").animate({
                backgroundColor: "#AF383C",
                color: "#FFFFFF"
            });
        }
        else{
            jQ(".fullName").animate({
                backgroundColor: "#78BB6C",
                color: "#000000"
            });
        }
    });
}); 
```

只有在“模糊”实际发生时检查值，您所做的事情才有意义。

进一步澄清：

```
var fullNameValue=jQ(".fullName").attr("value"); 
```

该语句将“fullNameValue”设置为该字段的值。如果后面的值发生变化，变量**不会**被更新；它仍然是执行语句时值的副本。

最后，最好使用`.val()`获取表单字段的值：

```
var fullNameValue = jQ(".fullName").val(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:49:56.213

```
function inputBorder() {
    var i = $('input[type="text"]');

    i.blur(function() {
        i.removeClass('red green');
        if(i.val() == "") {
            i.addClass('red');   
        } else {
            i.addClass('green');                
        }

    });
}

$(document).ready(function() {
    inputBorder();        
}); 
```

小提琴[在这里](http://jsfiddle.net/toroncino/TvZwt/)！

# c# - 如何将毫秒转换为在 XAML 中显示 mm:ss？

> ID：10372114
> 
> 赞同：3
> 
> 时间：2012-04-29T12:26:48.370
> 
> 标签：c#, wpf, string-formatting, time-format

我想我需要为此使用 StringFormat ，但我对如何找出格式一无所知。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T12:47:20.533

如果您的输入值是 TimeSpan 或 DateTime，那么您可以使用简单的格式字符串。但我认为情况并非如此。

据我所知，您需要实现自己的转换器，它将您的值作为参数，并输出格式化的字符串。标准 C 格式化程序无法进行实际计算，例如计算分钟所需的模数。

一个例子：（这段代码没有被检查，而是即时编写的！）

```
public class MmSsFormatConverter : IValueConverter
{
    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        Int32 sss = (Int32)value;
        Int32 ss = sss / 1000;
        Int32 mm = ss / 60;
        ss = ss % 60;
        return string.Format(@"{0:D2}:{1:D2}", mm, ss);
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return Binding.DoNothing; // Thanks to Danny Varod for the suggestion!
    }

    #endregion
} 
```

现在将命名空间添加到 XAML，以识别转换器，然后将转换器添加为 XAML 中的资源。

然后您可以绑定到转换器，如下所示：

```
<TextBlock Text="{Binding Milliseconds, Converter={StaticResource MmSsFormatConverter}}" /> 
```

请注意，如果您进行双向绑定，则需要实现该 ConvertBack 函数。您还可以使用**参数**参数来传递 ConverterParameter，如格式字符串。

您可能想在我编写的代码上添加类型检查和其他约束。（超过59:59的情况呢？现在到60:00，事件可以到123:59）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T15:08:04.230

如果您不想创建转换器，您也可以这样做：

```
 <TextBox Height="23" Text="{Binding Time, StringFormat={}{0:mm:ss}}" /> 
```

时间可能是您背后代码中的一个属性。或者你可以将它绑定到其他东西..

[这里有更多的例子。](http://elegantcode.com/2009/04/07/wpf-stringformat-in-xaml-with-the-stringformat-attribute/)

# jquery - 如何将较小的图像放置在较大的角落？

> ID：10372117
> 
> 赞同：1
> 
> 时间：2012-04-29T12:27:02.067
> 
> 标签：jquery, html, positioning

您好，我的 div 中有几张大图像和一张小放大镜图像，我希望将其动态定位在每个图像的右上角。我的大图像通过点击它们来切换。它们的尺寸不同。现在我正在尝试手动获取每个图像的高度和宽度并定位小图像 - 有没有办法更好地做到这一点？

小放大镜图像比大放大镜图像具有更高的 z-index。

我的查询代码：

```
 $('img.small').fadeOut('fast', function() {

        $('img.small').css('top',$(el).find('img.big:last').height()+60); // i want to change this
        $('img.small').css('top',$(el).find('img.big:last').width()+60); // and this

        $('img.small').fadeIn(); 
        }); 
```

我的CSS：

```
 #myGallery {
   width: 100%;
   height: 300px;
  }

.small img{
position: absolute;
left:150px;
top:150px;
z-index: 15000;
width: 35px;
height: 35px;   
} 
```

我的 HTML：

```
<div id="myGallery" class="spacegallery">   

<img class="small" src="small.jpg" alt=""  />   
<img class="big" src=images/bw1.jpg alt=""  />
<img class="big" src=images/bw2.jpg alt=""  />
<img class="big" src=images/bw3.jpg alt=""  />

            </div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:18:01.540

为此，只要您的用户在他们的浏览器中是相对最新的，您就可以只使用 CSS，尽管这需要一些标记更改：

```
<div id="myGallery" class="spacegallery">
    <span class="imgWrap">
        <img class="big" src='http://davidrhysthomas.co.uk/img/dexter.png' alt=""/>
    </span>
    <span class="imgWrap">
        <img class="big" src='http://davidrhysthomas.co.uk/img/mandark.png' alt=""/>
    </span>
</div>​ 
```

和 CSS：

```
#myGallery {
    width: 100%;
    height: 300px;
}

.imgWrap {
    float: left;
    position: relative;
}

.imgWrap::after {
    content: url(http://davidrhysthomas.co.uk/img/glass.png);
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(255,255,255,.3);
    border-radius: 0.5em;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/HxnD5/1/)。

但是，如果您更喜欢使用 jQuery，那么我建议您执行以下操作：

```
var glass = $('<img />', {
    src: 'http://davidrhysthomas.co.uk/img/glass.png', // host your own image though. Please.
    class: 'glass'
}).clone();

$('.big')
    .wrap('<span></span>')
    .addClass('wrap')
    .parent()
    .addClass('wrap')
    .append(glass);​​​​ 
```

这是基于您自己发布的标记，[JS Fiddle 演示在这里](http://jsfiddle.net/davidThomas/HxnD5/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:17:07.020

如果您不将图片放在 div 包装器中，我会按照您的方式进行操作。如果你可以放置一个包装器，我可能会将放大镜图像放在每个包装器中，并在包装​​器本身具有“大”类时通过 css 使其可见。例如：

```
div.big {
position: relative;
}
div.big img.magnifier {
display: block;
position: absolute;
top: 0px;
right: 0px;
}
div.small img.magnifier{
display: none;
} 
```

在你的 html 中

```
<div class="small">
<img src="..." />
<img src="..." class="magnifier" />
</div>
<div class="small">
<img src="..." />
<img src="..." class="magnifier" />
</div>
<div class="big">
<img src="..." />
<img src="..." class="magnifier" />
</div> 
```

最后，在你的 js 中：

```
$('img.magnifier').bind('click', function() {
$(this).siblings('img').attr('src', '..your small picture...');
}) 
```

# vmware - vmware 来宾操作系统的 xdebug 2.2.0RC2 奇怪错误？

> ID：10372119
> 
> 赞同：1
> 
> 时间：2012-04-29T12:27:25.920
> 
> 标签：vmware, xdebug

我有一个安装了网络服务器和 xdebug 2.2.0RC2 的 vmware 来宾操作系统，我想打开一个从主机到虚拟机的调试会话。在我的主机上，我安装了 Opera 和 xdebug 扩展。当我加载 Komodo 并尝试连接到 xdebug 时它失败了，但是当我尝试从 Opera 扩展 xdebug 时，有时我会在我的虚拟机 xdebug 日志文件中收到此消息：

```
 Log opened at 2012-04-29 12:15:28
  I: Checking remote connect back address.
  I: Remote address found, connecting to 192.168.92.1:9000.
  I: Connected to client. :-)
  -> <init xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/
  xdebug" fileuri="file:///htdocs/typo3_src-4.7.0/typo3/install/index.php" 
  language="PHP" protocol_version="1.0" appid="5984" idekey="komodo-xdebug"><engine 
  version="2.2.0rc2"><![CDATA[Xdebug]]></engine><author><![CDATA[Derick Rethans]]></
  author><url><![CDATA[http://xdebug.org]]></url><copyright><![CDATA[Copyright (c) 
  2002-2012 by Derick Rethans]]></copyright></init>
  -> <response xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/ 
   xdebug" status="stopping" reason="ok"></response>

  Log closed at 2012-04-29 12:15:58 
```

问题是我的虚拟机在带有 NAT 的 vmnet8 上，它的 ip 与我的虚拟机不同。xdebug 日志中的 ip 是我的 vmnet8 适配器。从我的主机我可以 ping 我的网络服务器和 ftp，但我无法远程登录到端口 9000。我已经使用 vmware nat 选项将端口转发到端口 80 和 9000，但不是 ftp 端口？当我使用我的 opera xdebug 扩展启用 xdebug 时，我收到上述消息，然后站点停止加载，因此 Opera 扩展可以看到我的虚拟机和 xdebug，但为什么不能看到 Komodo？Komdo 可以在没有调试代理的情况下监听另一台服务器然后 localost 吗？通常我使用反向 shell 将远程主机隧道连接到本地计算机，但这很特别，因为我在本地计算机上使用虚拟机，并且我想尝试常规的远程选项。

# iphone - 如何从 fastpdfkit 中获取书签

> ID：10372124
> 
> 赞同：0
> 
> 时间：2012-04-29T12:28:05.817
> 
> 标签：iphone, objective-c, ios, ipad

我正在使用 FastPdfKit，如 youtube 的链接所示

[FastPdfKit](http://www.youtube.com/watch?v=8F63ovh4Rdw&feature=player_embedded#!)

我想从这个工具包中获取书签。以前有人试过吗？？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T09:12:08.363

FastPdfKit 书签由 管理，[`BookmarksViewController`](https://github.com/mobfarm/FastPdfKit/blob/master/Classes/Reader/Bookmarks/BookmarkViewController.m)由`ReaderViewController`.

书签保存在`NSUserDefaults`键*bookmarks_DOCUMENT_ID*下。其中 DOCUMENT_ID 分配给`ReaderViewController`变量`documentId`。

看一下`BookmarksViewController` [Class](https://github.com/mobfarm/FastPdfKit/blob/master/Classes/Reader/Bookmarks/BookmarkViewController.m)，尤其是第`loadBookmarks`28 行的方法。

从您的视图控制器只需调用类似：

```
NSString * bookmarksKey = [NSString stringWithFormat:@"bookmarks_%@",(documentViewController.documentId)];
NSArray * storedBookmarks = [[NSUserDefaults standardUserDefaults]objectForKey:bookmarksKey]; 
```

得到一个`NSArray`充满`NSNumber`书签的页面。

# zend-framework - ZF Zend_Controller_Router_Route_Module 有和没有模块默认路由

> ID：10372141
> 
> 赞同：0
> 
> 时间：2012-04-29T12:30:56.907
> 
> 标签：zend-framework, zend-route, zend-framework-modules, zend-router

我有一个项目，我开始时没有在 ZF 1 中使用模块结构，现在我需要放置一个模块结构来管理用户（对我来说更有意义）。

我的问题“默认”路由应该尝试使用 :controller/:action/:id 并且模块路由
应该使用 :module/:controller/:action/:id ZF 1 的默认设置是使用上面没有:id
但我的“逻辑”需要 :id 字段，我怎样才能使这项工作？

我尝试的是：

```
 protected function _initModuleAutoload()
{
    $modelLoader = new Zend_Application_Module_Autoloader(
                    array('namespace' => 'DM',
                        'basePath' => APPLICATION_PATH . '/modules/default')
                    , array('namespace' => 'UM',
                'basePath' => APPLICATION_PATH . '/modules/users')
    );

    $modelLoader->addResourceType('service', 'services', 'Service');
    $modelLoader->addResourceType('serviceplugin', 'services/plugins', 'Service_Plugin');

    return $modelLoader;
}

public function _initFrontController()
{
    $front = Zend_Controller_Front::getInstance();
    $router = $front->getRouter();

    $route1 = new Zend_Controller_Router_Route(
                    ':module/:controller/:action/:id/',
                    array(
                        'id' => '\d+'
                        , 'module' => 'default'
                        , 'controller' => 'index'
                        , 'action' => 'index'
                    )
    );

    $router->addRoute('default', $route1);

    $front->addModuleDirectory(APPLICATION_PATH . "/modules/");

    $front
            ->registerPlugin(new Far_Access_Plugin_Identity(), 1)
            ->registerPlugin(new Far_Access_Plugin_Access(), 2)
            ->throwExceptions(true)
    ;

    return $front;
} 
```

还尝试为用户创建第二条路线而不是默认路线，但没有奏效。

有任何想法吗？我究竟做错了什么？

**当我提供此链接时，在频道#zftalk 中提供了来自 freenode 中 irc 的帮助。**

> Bittarman: crash82: 向 id 添加要求，所以它必须是 [\d]+
> Bittarman: 或者，只需添加一个 Zend_Controller_Router_Route_Module 实例，链接到 Zend_Controller_Router_Route，其中只有 :id，默认设置为 id，如 false。
> Bittarman：另外，_initModuleAutoload，是毫无意义的 Bittarman：在模块目录中拥有“默认”模块，有点错误
> Bittarman：并且您通过拥有 _initFrontController
> Bittarman 来停止前端控制器资源的工作：因此 resources.frontController 将不再工作。
> 
> crash82: 嗯...这么多问题:(，所以我可以将“默认”模块放入应用程序目录中，并且可以继续从模块/路径加载任何其他模块？
> 
> 比特曼：是的:)
> 
> crash82: 去尝试那个 Bittarman: 并且，每个有引导程序的模块都提供自己的模块资源加载器
> Bittarman: 所以，如果你去创建更多这样的东西，你最终会为每个模块创建两个。
> Bittarman：你会惊讶于有多少人这样做。
> 比特曼：s/tht/that/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T06:44:20.110

当我需要在脚本中的 url 中传递参数时，我使用几种方法之一。对于大多数简单的事情，没有真正需要创建新路线。

1.  `<a href="/music/index/album/id/<?php echo $variable->id ?>"><?php echo $track->album ?></a>`. 将参数传递为 /`id/album_id`
2.  使用 url() 视图助手：`<?php echo $this->url(array('controller' => 'index', 'action' => 'index', 'id' => $variable->id)); ?>`这个助手还将一个模块作为第一个参数。
3.  前 2 个在视图脚本中工作，要在控制器中执行相同的操作，您可以使用 reidrector 操作助手：`$this->getHelper('Redirector')->gotoSimple('action'=> 'someAction', 'controller' => 'someController', 'module' => 'someModule', array('id' => $id );`控制器、模块和参数是可选的，默认为`NULL`.
4.  或者您可以使用操作实用程序方法 _forward() ：`$this->_forward($action, $controller, $module, array($params))`与 gotoSimple() 具有相同的语法。

还有其他方法可以完成这种路由，剩下的我会让你找到，但你可以从[Action Helpers](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html)、[实用方法](http://framework.zend.com/manual/en/zend.controller.action.html#zend.controller.action.utilmethods)和[视图助手开始](http://framework.zend.com/manual/en/zend.view.helpers.html)

# c# - 有没有办法使用 c# 和 MS Access 删除表中的所有行？

> ID：10372146
> 
> 赞同：1
> 
> 时间：2012-04-29T12:31:58.717
> 
> 标签：c#, database, ms-access

我想编写一个简单的代码行来删除某个表中的所有数据行。（使用 c# 和 MS Access 2010）该表包含大约 1000 行、10 列，并且速度有点慢。

这段代码完成了这项工作：

```
 connStr = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=E:\Words\shinunonDB.accdb;Persist Security Info=False;";

  OleDbConnection Conn = new OleDbConnection();
  Conn.ConnectionString = connStr;
  sql = "select * from Heb";
  Conn.Open();
  OleDbDataAdapter da = new OleDbDataAdapter(sql, Conn);
  DataSet ds = new DataSet();
  OleDbCommandBuilder cb = new OleDbCommandBuilder(da);

  da.Fill(ds, "Heb");
  foreach (DataRow dRow in ds.Tables["heb"].Rows)
  {
      dRow.Delete();
  }
  da.Update(ds, "heb"); 
```

但我想可能有一种更短、更有效的方法来做到这一点。

谢谢你们。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-29T12:34:20.327

就在这里。只需使用 SQL 命令：

```
delete from Heb; 
```

您可以在 OleDbConnection 上发出 SQL 命令。像这样的东西：

```
OleDbCommand ac = new OleDbCommand("delete from Heb",Conn);
ac.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-27T12:25:13.523

对我来说，它使用以下几行：

```
OleDbCommand ac = new OleDbCommand("delete from Heb",Conn);
ac.ExecuteNonQuery(); 
```

但它会从表中删除我的所有数据，而不仅仅是一行。

当我这样做时

```
conn.Open();
OleDbCommand cmd = new OleDbCommand("delete from Kunden where id=" + txtKdnID.Text + " ", conn);
cmd.ExecuteNonQuery();
conn.Close();
MessageBox.Show("Eintrag erfolgreich gelöscht"); 
```

我得到[这个错误](https://i.stack.imgur.com/kOciB.jpg)。

# c# - 寻找评分最匹配的用户

> ID：10372147
> 
> 赞同：0
> 
> 时间：2012-04-29T12:32:21.307
> 
> 标签：c#, linq, entity-framework

任何人都可以帮助我创建一种执行以下操作的良好方式吗？：

我有一些用户对一些不同的项目进行评分。

为了给用户提供好的推荐，我需要找到有相似品味的用户。这样我就可以从其他具有相似品味的用户那里推荐高评价的商品。

我的数据来自使用实体框架映射的数据库。

我有一个有效的算法，但在很多循环方面表现不佳。有任何想法吗？

/肯特

```
namespace ConsoleApplication1
{
    using System;
    using System.Collections.Generic;

    class Program
    {
        static void Main()
        {
            const int NoOfUsers = 100;
            const int NoOfRatingsPerUser = 100;
            const int NoOfDifferentItems = 100;

            var listOfRatings = new List<Rating>();

            var r = new Random();

            for (int user = 0; user < NoOfUsers; user++)
            {
                for (int ratingsPerUser = 0; ratingsPerUser < NoOfRatingsPerUser; ratingsPerUser++)
                {
                    var rating = new Rating();
                    rating.Score = r.Next(1, 10);
                    rating.ItemId = r.Next(1, NoOfDifferentItems);
                    rating.UserId = user;
                    listOfRatings.RemoveAll(x => x.UserId == user && x.ItemId == rating.ItemId);
                    listOfRatings.Add(rating);
                }
            }
            Console.ReadLine();
        }

        struct Rating
        {
            public int ItemId;

            public int Score;

            public int UserId;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T12:43:58.287

我没有看到评分算法。你在搜索中被杀了。KeyedCollection 非常适合这里。

P4 为 62 毫秒。1000（不是 100）；

```
 public void BuildData()
    {
        System.Diagnostics.Stopwatch stopWatch = new System.Diagnostics.Stopwatch();
        stopWatch.Start();

        RatingKC Ratings = new RatingKC();

        const Int16 NoOfUsers = 1000;
        const Int16 NoOfRatingsPerUser = 1000;
        const Int16 NoOfDifferentItems = 1000;
        Int16 itemID;
        int score;
        Int32 key;
        var r = new Random();

        for (Int16 userID = 0; userID < NoOfUsers; userID++)
        {
            for (int ratingsPerUser = 0; ratingsPerUser < NoOfRatingsPerUser; ratingsPerUser++)
            {
                itemID = (Int16)r.Next(1, NoOfDifferentItems);
                score = r.Next(1, 10);
                key = (userID & 0xffff) + (itemID << 16);
                if (Ratings.Contains(key))
                {
                    Ratings[key].Score = score;
                }
                else
                {
                    Ratings.Add(new Rating(userID, itemID, score));   
                }
            }
        }
        stopWatch.Stop();
        // Get the elapsed time as a TimeSpan value.
        TimeSpan ts = stopWatch.Elapsed;

        // Format and display the TimeSpan value.
        string elapsedTime = String.Format("{0:00}:{1:00}:{2:00}.{3:00}",
            ts.Hours, ts.Minutes, ts.Seconds,
            ts.Milliseconds / 10);
        System.Diagnostics.Debug.WriteLine("Count = " + Ratings.Count.ToString() + " Time = " + elapsedTime);
    }
}
public class RatingKC : KeyedCollection<int, Rating>
{
    // The parameterless constructor of the base class creates a 
    // KeyedCollection with an internal dictionary. For this code 
    // example, no other constructors are exposed.
    //
    public RatingKC() : base() { }

    // This is the only method that absolutely must be overridden,
    // because without it the KeyedCollection cannot extract the
    // keys from the items. The input parameter type is the 
    // second generic type argument, in this case OrderItem, and 
    // the return value type is the first generic type argument,
    // in this case int.
    //
    protected override int GetKeyForItem(Rating item)
    {
        // In this example, the key is the part number.
        return item.Key;
    }
}
public class Rating: Object
{
    public Int16 UserId { get; private set; }
    public Int16 ItemId { get; private set;}
    public int Score { get; set;}
    public Int32 Key { get { return (UserId & 0xffff) + (ItemId << 16); } }
    public override bool Equals(Object obj)
    {
        //Check for null and compare run-time types.
        if (obj == null || !(obj is Rating)) return false;
        Rating item = (Rating)obj;
        return (UserId == item.UserId && ItemId == item.ItemId);
    }
    public override int GetHashCode()
    {
        return Key;
    }

    public Rating(Int16 userId, Int16 itemId, int score)
    { UserId = userId; ItemId = itemId; Score = score; }
    public Rating(Int16 userId, Int16 itemId)
    { UserId = userId; ItemId = itemId; }
} 
```

# c++ - 从文件加载和保存 c++ 高分函数

> ID：10372149
> 
> 赞同：0
> 
> 时间：2012-04-29T12:33:31.727
> 
> 标签：c++

我有一个我创建的游戏。我想实现一个加载和保存高分的功能。起初，当没有文本文件（在我的情况下`highscore.txt`）时，一旦创建，我想将 0 打印到文件中。如果它在加载中，我希望它加载之前玩游戏的高分。我该怎么办？

这是我的代码：

```
void filewrite(){

    int n;

    FILE *FPtr;
    FPtr = fopen("highscore.txt","w+");//open file
    if (FPtr == NULL){
    fprintf (FPtr, "%d" , highscore);
    rewind(FPtr);
    }
    fscanf(FPtr,"%d",&n);//scan file for integer

    if (n < score){
        if(highscore < score ){
            if(end==true){
                fprintf (FPtr, "%d" , score);//print the score to file if it is higher than the score already there
                rewind(FPtr);//rewind the file, so pointer starts at begining
                fscanf(FPtr,"%d",&highscore);//scan file for int
            }
        }
    }

    fclose(FPtr);//close pointer to file

} 
```

fopen 似乎已经覆盖了文件中的内容并将其留空

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T12:54:15.563

您应该采取的步骤是：

*   尝试打开文件进行阅读。
*   如果失败，则打开写入，写入 0，然后打开读取。
*   读取文件中的值并根据需要进行测试。

# perl - Perl 中的非本地返回（从调用者返回）

> ID：10372150
> 
> 赞同：2
> 
> 时间：2012-04-29T12:33:34.960
> 
> 标签：perl

*有没有办法让我从我的来电者**那里*返回而不是我的来电者？例如

```
sub foo {
    bar();
    # this never gets executed
}

sub bar {
    return_from_caller(5);
}

# This prints 5
print foo(); 
```

（基本原理：我正在编写一个函数 memoize_self，它从函数本身中记住一个函数。我希望它像这样工作：

```
sub complex_function {
    my ($x, $y) = @_;
    memoize_self({key => $y, expires_in => '5min'));
    # compute $result
    return $result;
} 
```

memoize_self 将检查其缓存，如果命中，*则从*其调用者返回缓存值。否则，它将重新调用该函数（使用动态范围的 var 以避免明显的无限循环），将返回值存储在缓存中并再次返回它。

如果没有从调用者返回的能力，我可能会使用 $_ 并这样写：

```
return $_ if memoize_self({key => $y, expires_in => '5min')); 
```

但这是额外的噪音，也没有考虑上下文。）

编辑：对于那些合理地建议[Memoize](http://search.cpan.org/perldoc?Memoize "记忆")的人——是的，我应该说，我很了解这个模块。[我正在写一个基于CHI](http://search.cpan.org/perldoc?CHI "气")的更现代、更有特色的 Memoize 版本。

但就这个问题而言，在某些情况下，从函数*内部*而不是函数*外部*进行记忆是有用的（记忆只做后者）。它可以很容易地自定义缓存键和/或确定是否要为这个特定的调用进行记忆。例如

```
sub complex_function {
    my $key = ...;   # normalize arguments
    if (...) {       # is it worth memoizing in this case?
        memoize_self({key => $key});
    }
} 
```

我也喜欢它被包裹在函数中的方式，而不是在外部创建自己的行，ala [state variables](http://perldoc.perl.org/functions/state.html "状态变量")。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T13:25:57.530

[Continuation::Escape](http://search.cpan.org/perldoc?Continuation::Escape)完全符合您的要求。然而，正如 Nikhil 指出的那样，[Memoize是你真正需要的。](http://search.cpan.org/perldoc?Memoize)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:57:17.430

看看 CPAN 模块[Memoize](https://perldoc.perl.org/Memoize) - 通过空间换时间使功能更快，这可能会解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:35:05.127

“有没有办法让我从我的呼叫者那里返回而不是我的呼叫者？”

是的，有几个。

*   你可以`goto`用来跳回来。见`perldoc -f goto`。
*   您可以使用`eval`和`die`进行更多控制跳转。见`perldoc -f eval`和`perldoc -f die`。
*   而不是以正常方式调用您的子，您可以`goto`。当你这样做时，它将与`goto`调用者一起返回到 sub。见`perldoc -f goto`。

当然，大多数人会告诉您重写所有内容以避免 goto 并使维护代码的人的生活更轻松，但是他们为您做过什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T17:50:17.170

另一种解决方案是使用 Want 模块的 double_return 方法，这会使您的下一个返回弹出两个调用帧：

```
#!/usr/bin/env perl
use warnings;
use strict;

use Want;

sub foo {
    Want::double_return;
    return 11;
}
sub bar { 
    foo();
    # never executed
    return 55;
}

# prints 11;
print bar(); 
```

# tcl - TCL：exec egrep“子进程异常退出”

> ID：10372155
> 
> 赞同：4
> 
> 时间：2012-04-29T12:34:47.940
> 
> 标签：tcl

egrep 命令有问题。当我在 tcsh 中执行命令时，它运行良好，但是当我从 tcl 脚本或 tclsh 中执行它时，我得到：

***子进程异常退出***

我的 tcl 代码：

```
exec egrep -i "^(\\\s+)?(tvf::)?LAYOUT\\\s+PATH" test_file 
```

test_file 包含

```
LAYOUT PATH "file1"
  LAYOUT PATH "file2"
//LAYOUT FILE "file 3"
foo string
tvf::LAYOUT PATH "file4"
  tvf::LAYOUT PATH "file5" 
```

++++++++++++++++++++++++++++++++++++++++++++++++++++++ ++++++++++++++++

大家好，

我做了一些额外的调查并在 32 位机器上运行这个命令。该命令适用于 32 位 egrep

结果：

```
LAYOUT PATH "file1"
    LAYOUT PATH "file2"
tvf::LAYOUT PATH "file3"
      tvf::LAYOUT PATH "file3" 
```

*文件 /bin/egrep* */bin/egrep: 到 `grep' 的符号链接*

*文件 /bin/grep* */bin/grep：ELF 32 位 LSB 可执行文件，Intel 80386，版本 1 (SYSV)，适用于 GNU/Linux 2.2.5，动态链接（使用共享库），已剥离*

但是当我删除额外的反斜杠时：

```
exec egrep -i "^(\s+)?(tvf::)?LAYOUT\s+PATH" test_file 
```

命令返回错误：

***子进程异常退出***

64位机器上的egrep版本是：

*文件 /bin/egrep* */bin/egrep: 到 `grep' 的符号链接*

*文件 /bin/grep* */bin/grep：ELF 64 位 LSB 可执行文件，AMD x86-64，版本 1 (SYSV)，适用于 GNU/Linux 2.6.9，动态链接（使用共享库），适用于 GNU/Linux 2.6 .9，剥离*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-29T16:54:23.470

grep 使用其退出状态来指示匹配的存在/不存在（[手册页](http://man.cx/grep)） - 如果没有匹配，则退出状态为 1。Tcl`exec`将任何非零退出状态视为异常情况。您需要`catch`执行 exec 调用，检查 catch 的返回值，如果非零则检查`$errorCode`变量。这里有一个完整的示例：[http](http://wiki.tcl.tk/exec) ://wiki.tcl.tk/exec ，单击“显示讨论”并向下滚动到 KBK 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-20T18:16:33.553

运行以下命令时我遇到了同样的错误：

```
exec top -b -n 1 -c | egrep lnx64.o/vsimk | wc -l 
```

TCL 对 grep 表达式中的正斜杠“/”不满意。它通过使用“-ignorestderr”开关得到修复：

```
exec -ignorestderr -- top -b -n 1 -c | egrep lnx64.o/vsimk | wc -l. 
```

# clearcase - clearcase 将两个元素合并为一个元素

> ID：10372157
> 
> 赞同：1
> 
> 时间：2012-04-29T12:35:22.733
> 
> 标签：clearcase

有没有办法将 ClearCase 中代表一个实际元素的 2 个元素合并为一个元素？
例如，假设我有一个流 S1，其中我将文件 foo.txt 添加到源代码管理，以及流 S2（其中 S1 和 S2 是同一流的 2 个子流），其中我还将 foo.txt 添加到源代码管理（当然，在相同的相对路径中）。
Clear case 将为 foo.txt 文件创建元素。有没有办法将它们组合成一个元素？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:32:31.953

不，你不能（正如[Paul R](https://stackoverflow.com/users/253056/paul-r)评论的那样）。

两次添加元素会产生邪恶双胞胎：请参阅“ [IBM 关于邪恶双胞胎](http://www-01.ibm.com/support/docview.wss?rs=984&uid=swg21125072)”。

当您合并这些文件时（例如，通过 a [`cleartool findmerge`](https://stackoverflow.com/questions/2730294/clearcase-findmerge-usage/2730665#2730665)），您实际上将首先合并父目录。
这意味着您必须在该合并目录中的两个文件之一之间进行选择（供合并的父目录参考）。

然后，您可以通过在另一个分支的文件和合并目录中存在的文件之间进行手动合并来更新所选文件的内容。
但这不会是 ClearCase 合并，它只是帮助您检测另一个文件的更改并将其包含到合并目录中当前引用的文件中的差异工具的结果。

另见“[邪恶孪生问题和减法合并](https://stackoverflow.com/questions/1636712/evil-twin-problem-and-subtractive-merge/1637405#1637405)”。

# java - jaxb 和 jax-ws 中的循环引用

> ID：10372162
> 
> 赞同：2
> 
> 时间：2012-04-29T12:35:45.293
> 
> 标签：java, web-services, jakarta-ee, soap

我正在使用 jax-ws 编写客户端和服务器。我的一个豆子有对父母的循环引用。为了防止循环，我为我的 bean 使用了 @XMLId 和 @XMLIDRef 注释。

```
class A {
    // simple fields
    A parent;

    @XMLID
    String getID() {}

    @XMLIDRef
    A getParent() {}
} 
```

现在，由于网络方法，我正在返回 bean，一切都按我的预期工作。但是如果我试图通过这个 bean 作为输入参数传递给方法

```
A obj1 = //...
A obj2 = //...
obj2.setParent(obj1); 
ws.updateA(obj2); // web-method signature is updateA(A a) 
```

（这里的bean是由wsimport工具生成的）

我有一个奇怪的行为。客户端使用 obj2 发送 SOAP 请求，其中父对象仅作为 obj2 中的引用存在。因此，obj2 不能在服务器端正常解码，并且`Parent`属性为空。

所以，问题是：“我哪里错了，不了解网络服务？”
我预计客户端将发送带有对象和父对象的请求，它们将通过引用链接。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-27T05:49:23.087

看起来很有趣，但是您的问题与网络服务无关，只是与编组/解组。我猜是`JAXB`你的情况。我建议您相应地标记您的问题，我相信您会得到更多相关的答案。

同时，请发布 wsdl 文件（用于其中的模式）和此类 A 的完整源代码。

# javascript - 是否有支持 Chrome 扩展的 Chromeless Google Chrome？

> ID：10372163
> 
> 赞同：1
> 
> 时间：2012-04-29T12:35:45.373
> 
> 标签：javascript, google-chrome, webkit, chromium, berkelium

我正在寻找一个完全使用 HTML / CSS / JS 呈现的 UI - 修改浏览器的 Chrome 不需要本机编码，最好是其他后端 API 可以通过 Javascript 获得。

这就是 Mozilla 的 Chromeless 项目和 Webian 提供的。

支持 Google 扩展的 Google Chrome 或 Chromium 是否有类似的东西？

如果是这样，它可以允许：

*   更多浏览器开发，更多创新设计

*   对新的桌面界面进行原型设计，而不是依赖现有的启动器和扩展坞

*   自动从内存中加载不需要的标签

我找到了 Berkelium，但[不清楚](https://groups.google.com/forum/?fromgroups#!searchin/berkelium/extension/berkelium/9UA7yazBL_4/NrV8TQi2k3EJ)它是否支持扩展，或者是否有在 Web 标准中实现的 UI，所以这可能是一个死胡同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T05:42:17.523

Chrome 的新打包应用程序允许您在没有任何窗口 chrome 的情况下运行应用程序：http: [//blog.chromium.org/2012/08/the-evolution-of-chrome-packaged-apps.html](http://blog.chromium.org/2012/08/the-evolution-of-chrome-packaged-apps.html)

原则上，您可以构建自己的 UI 并通过 JS 驱动它。您有历史 API，可以将用户导航到不同的页面等。所有的部分都在那里！

# scala - 获取 Actor 正在监听的端口

> ID：10372164
> 
> 赞同：0
> 
> 时间：2012-04-29T12:35:50.867
> 
> 标签：scala, actor

如何获取 Actor 正在侦听的端口？

我有以下代码

```
import scala.actors.Actor
import scala.actors.Actor._
import scala.actors.remote.RemoteActor._

object DispatchActor extends Actor 
{
  def act() 
  {
    alive(8888)
    register('myService, self)
    println("Listening on port " + howToGetPort)

 ..

  }
} 
```

如何打印 Actor 正在侦听的端口？

第二个问题是关于调用 alive() 和 register() 方法。这些方法在 RemoteActor 对象中定义。如何在 Actor 对象上调用它们。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T12:13:18.893

我不认为 Actor API 可以让您知道特定 Actor 正在侦听哪个端口（现在我认为它有点类似于 Java RMI）所以在这种情况下的标准方法是记住您在何时指定的端口你打电话`alive`。

至于你问题的第二部分，你没有在你的 Actor 对象上调用方法，你已经从对象定义顶部的 RemoteActor 导入了相关定义 - 所以你可以这样编写代码：

```
import scala.actors.Actor
import scala.actors.Actor._
import scala.actors.RemoteActor

class DispatchActor(port: Int) extends Actor 
{
  def act() 
  {
    RemoteActor.alive(port)
    RemoteActor.register('myService, self)
    println("Listening on port " + port)
  }
} 
```

请注意，我已将您的对象定义更改为类定义以允许对其进行参数化。

# url - 在 RESTful Web 服务中传递带有特殊字符的参数

> ID：10372165
> 
> 赞同：0
> 
> 时间：2012-04-29T12:35:54.227
> 
> 标签：url, rest, special-characters, parameter-passing

我应该如何在 restful GET 函数中传递包含特殊字符的参数？我必须对参数值进行编码吗？如果是这样，我会怎么做？我通过的参数是 USB0::0x164E::0x13EC::TW00008555 和 *IDN?

任何帮助将不胜感激。干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:40:18.193

您必须使用所谓的[percent hex encoding](https://www.rfc-editor.org/rfc/rfc3986#section-2.1 "百分比编码，统一资源标识符 (URI)：通用语法")对未保留的字符进行编码。

参数将分别编码为`USB0%3A%3A0x164E%3A%3A0x13EC%3A%3ATW00008555`和`%2AIDN%3F`。

# .net - TableLayoutPanel - 按行数添加滚动条

> ID：10372166
> 
> 赞同：3
> 
> 时间：2012-04-29T12:36:03.743
> 
> 标签：.net, scrollbar, rows, tablelayoutpanel

我在 userconrol 中有一个 TableLayoutPanel。我想有条件地向面板添加一个垂直滚动条 - 仅当有超过 5 行时。表格布局面板只需要显示 5 行，无论用户控件的大小如何。其他行（如果有）将在表格布局面板中，但仅在向下滚动时才会显示。

我怎样才能做到这一点？

谢谢。

# java - 符合 HID 标准的游戏控制器 Java 接口

> ID：10372170
> 
> 赞同：1
> 
> 时间：2012-04-29T12:36:41.677
> 
> 标签：java, controller, usb, hid

我有一个 USB RC 飞行模拟器控制器，它在计算机中定义为“符合 HID 的游戏控制器”。问题是我不知道如何将此控制器连接到我的 Java 应用程序以接收来自它的输入。我什至找不到它的 COMM 端口，因为它不是串行端口。这是控制器的图像：

![在此处输入图像描述](../Images/d06b37f0247d067e7d246a31f072f64f.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:34:47.617

你试过 JInput 吗？

[http://fivedots.coe.psu.ac.th/~ad/jg2/ch11/index.html](http://fivedots.coe.psu.ac.th/~ad/jg2/ch11/index.html)

# sqlite - Android sqlite过滤查询结果包含其他两个表中的字符串

> ID：10372171
> 
> 赞同：0
> 
> 时间：2012-04-29T12:36:53.840
> 
> 标签：sqlite

**更新**

最后我用这种方式得到过滤结果。

```
SELECT * FROM statuses WHERE _id NOT IN (
    SELECT DISTINCT statuses._id FROM statuses, filtered_sources WHERE statuses.source LIKE '%'||filtered_sources.text||'%'
    UNION
    SELECT DISTINCT statuses._id FROM statuses WHERE statuses.screen_name IN(SELECT filtered_users.text FROM filtered_users)
    UNION
    SELECT DISTINCT statuses._id FROM statuses, filtered_keywords WHERE statuses.text LIKE '%'||filtered_keywords.text||'%'
); 
```

**为什么我使用这种方式而不是直接组合结果？**

我想使用`query()`方法而不是`rawQuery()`在 Android 中。

@zapi 和 @sixfeetsix ，非常感谢，你的回答给了我这个想法！

**在此处下载 sqlite 数据库进行测试** [http://db.tt/ZsEwE9TV](http://db.tt/ZsEwE9TV)

我有一个 sqlite 数据库，其中包含三个表：statuses、filtered_keywords、filtered_sources。

每个表中的列：

状态：

```
|_id|text|source| 
```

过滤关键字和过滤来源：

```
|_id|text| 
```

现在我想过滤查询结果中`statuses`包含的单词`filtered_keywords`和`filtered_sources`。

我知道我可以`LIKE`在 sqlite 中使用，但我不能像`IN`函数一样使用它。

```
SELECT * FROM statuses WHERE text in (SELECT text FROM filtered_sources); 
```

所以我必须先查询`filtered_sources`and`filtered_keywords`中的所有数据`Cursor`，然后构建一个很长的where子句，这真的很慢。

有没有简单的方法来获得过滤结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:47:49.890

编辑：哎呀误解了你的意图。它对你不起作用。

* * *

我想这行得通：

```
SELECT * FROM statuses WHERE text in (
    SELECT text FROM filtered_sources WHERE text LIKE '%?%'
    UNION
    SELECT text FROM filtered_keywords WHERE text LIKE '%?%'
); 
```

应该首先使用 a 查询表`LIKE`，将两者组合成一组文本，然后从那里选择所有文本`IN`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:12:34.073

你可以这样做：

```
SELECT statuses.* 
FROM statuses, filtered_sources
WHERE statuses.text LIKE '%' || filtered_sources.text || '%'
UNION
SELECT statuses.*
FROM statuses, filtered_keywords
WHERE statuses.text LIKE '%' || filtered_keywords.text || '%';'; 
```

例如：

```
create table statuses (_id, text, source);
create table filtered_keywords (_id, text);
create table filtered_sources (_id, text);

insert into statuses values (1, 'foobar', NULL);
insert into statuses values (2, 'foofoobar', NULL);                              
insert into statuses values (3, 'foofoobarbar', NULL);

insert into filtered_keywords values (1, 'foofoo');
insert into filtered_sources values (1, 'barbar');

.headers on
.mode column
.width 3 15 6 

SELECT statuses.* 
FROM statuses, filtered_sources
WHERE statuses.text LIKE '%' || filtered_sources.text || '%'
UNION
SELECT statuses.*
FROM statuses, filtered_keywords
WHERE statuses.text LIKE '%' || filtered_keywords.text || '%';'; 
```

输出：

```
_id  text             source
---  ---------------  ------
2    foofoobar              
3    foofoobarbar 
```

**更新**：

我更新了`SELECT`语句，因为 OP 指出当两个 filters_* 表之一为空时，以前的版本不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:20:00.610

您可以尝试使用连接查询：

```
SELECT * FROM statuses JOIN filtered_keywords ON statuses.text = filtered_keyword.text JOIN filtered_sources ON statuses.source = filtered_sources.text 
```

# iphone - 安全通信 iPhone 到数据库

> ID：10372173
> 
> 赞同：1
> 
> 时间：2012-04-29T12:37:16.820
> 
> 标签：iphone, mysql, authentication, https

我正在创建一个 iphone 应用程序。

在应用程序中，我需要与我的数据库进行通信。我环顾四周，发现最好的方法是 iPhone -> webserver -> mysql。

如果我使用 https，流量将不会是明文形式。

但我仍然担心安全问题。

假设我有 auth.php，它将验证与网络服务器的当前会话，如果我有游戏或其他东西并使用 registerresult.php 注册结果，用户仍然可以通过 auth 登录.php 通过网站并在 registerresult.php 中注册自己的结果。

（我使用 POST 方法发布数据）

你看到问题了吗？

我看过这个： http: [//www.icodeblog.com/2009/10/29/iphone-coding-tutorial-creating-an-online-leaderboard-for-your-games/2/](http://www.icodeblog.com/2009/10/29/iphone-coding-tutorial-creating-an-online-leaderboard-for-your-games/2/)

但是，这真的是一个好方法，还是有更好的方法？（在每个语句中发送一个硬编码的“密钥”）

如果没有使用 https，那么该密钥无论如何都是明文的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:19:24.163

（*升级到答案*）

实现全面安全是不可能的：您始终必须考虑威胁是什么（来自谁，它们的资源如何等），以便充分防御它们。

例如，即使您在将结果数据发送到您的`registerresult.php`页面之前对结果数据进行了加密签名，签名密钥仍必须嵌入到用户手机上的应用程序中 - 因此，确定的破解者仍然可以提取密钥并发送伪造的结果。我认为您必须在您的服务器上运行游戏，以便将状态信息保存在那里，以击败这种性质的威胁。

However, it's unlikely that anyone would go to such lengths to crack an iPhone game (unless perhaps the game was incredibly popular or paid out prizes of some material value). Would it really matter to you if a few highly skilled people succeeded in sending forged results? It's worth thinking about.

Should you decide that you can tolerate such threats, the approach cited in your question has some flaws. Whilst HTTPS does secure the secret key from being intercepted by a packet sniffer, it does not prevent it being intercepted by a transparent proxy that presents an SSL certificate which is accepted by the phone (such as a self-signed one that has been added to its keychain).

To defeat threats of this sort, I suggest that you calculate a secure hash of (data + random salt value + secretkey) and send (data, that same salt value, that hash) to the server; the server can then recompute what the hash should have been from the known secret key and check that it verifies against the received hash.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:18:17.720

上面的用户@eggyal 据说是最好的答案。你最好在你的项目中使用密码学，然后你会将数据发送到你的服务器文件以供数据库使用。在服务器端，您将解密您从前端接收到的数据，然后您将与数据库进行通信。这将是安全的通信。使用加密和解密方法。

这是[加密和解密的链接。](https://stackoverflow.com/questions/1400246/aes-encryption-for-an-nsstring-on-the-iphone)

# java - 将 Lua shell 嵌入 Java 应用程序 (LuaJava)

> ID：10372174
> 
> 赞同：1
> 
> 时间：2012-04-29T12:37:17.357
> 
> 标签：java, shell, lua, luajava

我正在开发一个应用程序，它有一个 GUI（但不是 Java swing 和 JFrame 的东西）我想将 Lua shell 合并到 GUI 中。LuaJava 没有关于如何执行此操作的良好文档（或至少对我而言）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T13:02:29.183

我已经使用 LuaJ 和 Kahlua 来做到这一点。与任何一个都可以很好地工作（它们的代码库大致相同）LuaJ 具有更完整的 Lua 标准库实现。

![在此处输入图像描述](../Images/b9a696486761603ae675dedd70e31abd.png)

你可以在右边看到，我在我的 IDE 中添加了一个交互式 Lua 控制台。

我所有的来源都在这里：[https ://bitbucket.org/sylvanaar2/lua-for-idea/wiki/Home](https://bitbucket.org/sylvanaar2/lua-for-idea/wiki/Home)

实际上，您真正需要的只是这里的资源：

[https://bitbucket.org/sylvanaar2/lua-for-idea/src/770c80f12c11/src/kahlua](https://bitbucket.org/sylvanaar2/lua-for-idea/src/770c80f12c11/src/kahlua)

这是一个向 Lua 公开 API 并从 Java 调用 Lua 函数的示例。

[https://bitbucket.org/sylvanaar2/lua-for-idea/src/770c80f12c11/src/lang/documentor/KahluaPluginDocumentationProvider.java](https://bitbucket.org/sylvanaar2/lua-for-idea/src/770c80f12c11/src/lang/documentor/KahluaPluginDocumentationProvider.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:50:37.220

您可能必须自己编写“shell”部分（在 java 中），然后将输入的输入传递给嵌入式解释（我想是 LuaJava）。

Maye [java-readline](http://java-readline.sourceforge.net/)可以提供帮助。

# jquery - 尝试在 jQuery 中同步 .load() - 不工作

> ID：10372175
> 
> 赞同：0
> 
> 时间：2012-04-29T12:37:30.017
> 
> 标签：jquery

对于相册，我加载了一个文件（通过 ajax），该文件返回我想要显示的图像的 src 数组。它们必须按照 ajax 调用返回的确切顺序显示。

我正在使用其中包含`.load()`函数的 for 循环，但这样它就不会同步。如果我在`.load()`函数内部输出 i 的值，它不会变为 0、1、3、4 等，而是 0、3、2、4 等。

我的代码的简化版本：

```
$.get('photostack.php', {album_name:album_name} , function(data) {
var items_count = data.length;
for(var i = 0; i < items_count; ++i){
    var item_source = data[i];
    var cnt = 0;
    $('<img />').load(function(){
        var $image = $(this);
        ++cnt;
        console.log(i);
        $ps_container.append($image);
    }).attr('src',item_source).attr('class',i);
}
},'json'); 
```

`console.log(i)`现在给出错误的顺序。它应该是完美的上升。

我已经尝试了很多东西。将每个负载延迟 100 毫秒，使用对象作为`cnt`/的变量`i`等，但它们都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:41:01.907

这是因为`.load`. 您无法预测何时调用回调函数。要同步它们，请使用[Deferred 对象](http://api.jquery.com/category/deferred-object/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:21:25.740

不确定我是否真的明白了，但也许这样的事情会起作用：

```
$.get('photostack.php', {album_name:album_name} , function(data) {
    for(var i = 0; i < data.length; i++){
        var image = new Image();
            image.src = data[i];
            image.className = i;
            image.style.display = 'none';
        $(image).appendTo($ps_container).load(function() {
            $(this).show();
        });
    }
},'json');​ 
```

# php - RewriteRule 有效，但显示丑陋的 URL 而不是漂亮的

> ID：10372178
> 
> 赞同：1
> 
> 时间：2012-04-29T12:38:33.940
> 
> 标签：php, apache, .htaccess, mod-rewrite

这是我的 .htaccess 文件：

```
RewriteEngine on

RewriteBase /admin

RewriteRule menu/([0-9]+)/([0-9]+)/([a-z0-9]+) http://www.mysite.com/admin/index.php?m=$1&o=$2&token=$3 [R,L] 
```

我必须包含完整的 URL，因为没有它，它会一直重定向到`http://www.mysite.com/menu/1/1/login.php`而不是`mysite.com/admin/login.php`

所以我重写了我的链接，使它们看起来像这样：

```
<a href="/admin/menu/1/1/bl4h1234">Some link</a> 
```

这很好用，但是 URL 在地址栏中显示为丑陋的 URL，但整个目的是将 URL 显示为漂亮的 URL：/

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:47:47.637

An alternative *(& standard [MVC / Front controller Patterns])* way to handle mod_rewrite rules and rewriting is to pass the whole url to your index.php and then process it there.

It actually makes it simpler in the long run, otherwise the complexity of your problems will only increase as you add more features.

As it seems you are using folders `(menu|admin)` with an *index.php* in each, you have no kind of router script. So you will need to handle the basic route in the `.htaccess`. You basically just need a rewrite for each folder.

The .htaccess goes in your root. Else you would need a rewrite for each folder and without the RewriteBase /path

**Directory Structure (Where to put the .htaccess, in root):**

```
ROOT>/
     /index.php
     /.htaccess
     /admin/
           /index.php
     /menu/
          /index.php
     /someOtherFolder/
                     /index.php
                     /somefile.php 
```

**The .htaccess rewrite**

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f

RewriteRule ^admin/menu/(.*)$ admin/index.php?route=$1 [L,QSA]
RewriteRule ^menu/(.*)$ index.php?route=$1 [L,QSA] 
```

Then within your index.php files you handle the route, by exploding the `$_GET['route']` param by `/`

```
<?php 
if(isset($_GET['route'])){
    $url = explode('/',$_GET['route']);
    //Assign your variables, or whatever you name them
    $m     = $url[0];
    $o     = $url[1];
    $token = $url[2];
}else{
    $m     = null;
    $o     = null;
    $token = null;
}
?> 
```

Hope it helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:41:25.233

您正在通过 重定向到新 URL `[R]`。相反，从重写中删除协议和域并丢失`[R]`. 这将执行内部重写。

```
RewriteRule menu/([0-9]+)/([0-9]+)/([a-z0-9]+) index.php?m=$1&o=$2&token=$3 [L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T12:41:22.280

1.  不要创建对绝对 URL 的重写。从重写的 URL 中删除协议和主机名。
2.  如果您不想重定向，请不要使用 R 标志。

# git - Git：远程存储库中的头部提交是垃圾 - 我应该如何替换它？

> ID：10372179
> 
> 赞同：0
> 
> 时间：2012-04-29T12:38:36.570
> 
> 标签：git, push, commit

好的 - 所以我有一个人（在学校项目中 - 不要惊慌）提交一个完整的 Eclipse 工作区，其中包含 .class 文件和 .settings/ 目录。***我所做***的是克隆 repo 并制作一个 .gitignore 文件并发出：

```
$ git reset --soft HEAD^
$ ... unstaged all files and added .gitignore and all files that it filtered in ... 
```

然后我尝试了：

```
 $ git commit -c d1cf2d8173234b444c601d5e294a5cf6d790fa2c 
```

其中 SHA 是在线提​​交的 SHA。它不会让我推动：

> 推送到[https://USERNAME@git.assembla.com/PROJECT.git](https://USERNAME@git.assembla.com/PROJECT.git)到 [https://USERNAME@git.assembla.com/PROJECT.git](https://USERNAME@git.assembla.com/PROJECT.git) ！[rejected]
> master -> master (non-fast-forward) error: failed to push some refs to 'https://USERNAME@git.assembla.com/PROJECT.git' 为了防止您丢失历史记录，非快速-前向更新被拒绝 在再次推送之前合并远程更改（例如“git pull”）。有关详细信息，请参阅“git push --help”的“关于快进的说明”部分。

我的问题是***我应该怎么做？***

那么*在这种情况下我应该如何删除提交*。不要警告我不应该这样做 - 在这种情况下，编辑历史记录是非常可接受、推荐和必要的（我想回收在线回购中的空间）。另外-我并不担心如何强制推送-我想要更简单/更清洁的方式来***替换远程 HEAD 提交***。

一切从克隆开始……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T22:34:40.947

除了必须让远程仓库管理员允许您回退“主”分支之外，请参阅[http://help.github.com/remove-sensitive-data/](http://help.github.com/remove-sensitive-data/)，特别是“清理和回收空间”部分。

在像您这样的情况下，使用新遥控器重新开始并让远程管理员完全删除旧遥控器通常是最简单的。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:48:28.143

您可以在 push 语句中使用 --force 标志，但如果其他人使用相同的 repo，这是有风险的。否则，您可能希望更新回远程头并使用 Git 还原。

# php - 无法通过 jquery 提交 post 变量，输入为图像

> ID：10372180
> 
> 赞同：1
> 
> 时间：2012-04-29T12:38:43.090
> 
> 标签：php, html, jquery-plugins

我想编写一个插件，该插件将在单击输入图像或通过任何其他方法时将存储为输入（图像）ID 的变量传递给表单

==================================================== ========================================

```
<?php
echo $_POST['id'];
?>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Kunfu Panda</title>
<link href="css/main.css" rel="stylesheet" type="text/css" media="projection,screen" />
</head>
<body>
    <div class="wrapper" >
        <form action="panda.php" method="post" class="openid_provider" />
             <input type="image" src="images/google_button.png" id="google" /> 
         </form>    
  </div>
<script type="text/javascript" src="js/test.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.19.custom.min.js"></script>
<script type="text/javascript">  
$(document).ready(function(){
    $('form').openid(); 
})
</script>
</body>
</html> 
```

==================================================== ==============================

我的插件是 openid (test,js)

```
(function($){
    $.fn.openid = function() {
        $('input').click(function(){
        var provider = $(this).attr('name');
        $(this).submit(provider);   
        })
        }
})(jQuery); 
```

现在表单正在通过点击 google 图像提交，这是一个 id 为“google”的输入，但是同一页面的表单操作无法识别 $_POST['provider'] 变量

请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T04:14:16.143

尝试这个：

```
<?php
  var_dump($_POST);
?>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Kunfu Panda</title>
  <link href="css/main.css" rel="stylesheet" type="text/css" media="projection,screen" />
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.js"></script>
  <script type="text/javascript" src="js/test.js"></script>
</head>
<body>
  <div class="wrapper" >
    <form action="panda.php" method="post" class="openid_provider" />
      <input type="image" src="images/google_button.png" id="google"/> 
    </form>
  </div>
</body>
<script type="text/javascript">  
  $(document).ready(function(){
    $('form').openid(); 
  })
</script> 
```

js：

```
(function($){
  $.fn.openid = function() {
    $('input').click(function(e){
      var provider = $(this).attr('id');  //get id
      var myinput = $('<input type="hidden" name="provider"/>').val(provider);
      $('form').append(myinput);
      $('form').submit();
    })
  }
})(jQuery); 
```

# api - Twitter APP 和 Twitter API.. 有没有办法创建一个在 Twitter 内部工作的应用程序？

> ID：10372181
> 
> 赞同：-1
> 
> 时间：2012-04-29T12:38:43.317
> 
> 标签：api, twitter

我想问是否有办法创建一个非常简单的应用程序，自动转发我以下列表中的一两个用户。我不想使用外部网站或桌面应用程序来执行此操作，也不想使用移动应用程序。我只想在我的 Twitter 帐户设置中有一个应用程序来执行此操作。这是不可能的吗？如果可能的话，我应该在哪里编写代码？如果不可能，并且应用程序必须与网站连接，我如何使网站不断检查以“自动”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T09:22:38.313

不，你不能把它*放在推特*上。最简单的方法是创建 Web 应用程序（因为您必须对自己进行身份验证才能以编程方式访问您的 twitter 流）

你不必“不断地检查”——你所要做的就是每天运行你的应用程序几次——获取推文并转发推文。您可以使用 CRON（在 Linux 虚拟主机上）或 Windows 机器上的任务计划程序来自动化它。

# c - Linux 从 C 代码中查找所有已挂载的 CDROM

> ID：10372182
> 
> 赞同：0
> 
> 时间：2012-04-29T12:38:51.847
> 
> 标签：c, linux, filesystems

我需要在 Linux 上用 C 语言编写函数来访问所有挂载的 CDROM 并执行一些操作。
我可以在 BSD 上使用

```
count = getmntinfo(&buf, 0); 
```

并在所有设备上循环并检查

```
buf[i].f_type == 17 
```

有什么方法可以在 Linux 上做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:54:48.607

最好的方法可能是解析 /proc/mounts。它看起来与 /etc/mtab 相同，但这实际上不是磁盘文件，它是内核接口，您应该使用低级文件描述符函数 - 即 read()，而不是 fread()，fscanf(等

还有libudev，但我*认为*解决方案会更加复杂：

[http://www.freedesktop.org/software/systemd/libudev/](http://www.freedesktop.org/software/systemd/libudev/)

同样，几乎所有挂载 cd 的 linux 系统也将使用 udev，尽管我认为这对于 proc 来说不太正确。

/sys/dev 包含有关每个已安装设备的更深入的信息，这些信息可能使您能够做出决定。libudev 使用这些路径。

真的，为了尊重用户，我认为你应该尝试并坚持使用传统的符号链接，如 /dev/dvdrw 等，而不是尝试在非常规的地方寻找东西。这就是这些链接的用途。它还使您的工作变得更加轻松。

# sql - 如果为空，则使用前一行的值更新行

> ID：10372185
> 
> 赞同：1
> 
> 时间：2012-04-29T12:39:00.737
> 
> 标签：sql, database, sybase

我使用的是 Sybase 15。
我有一张看起来像这样的桌子

```
--------------------------------------------
 Date       |  GroupId  |  Comment
--------------------------------------------
01/05/2012     1              ABC
01/05/2012     2              XYZ
02/05/2012     1              null
02/05/2012     2              null
03/05/2012     1              null
03/05/2012     2              null
04/05/2012     1              DEF
04/05/2012     2              GHI
05/05/2012     1              null
05/05/2012     2              null
06/05/2012     1              null 
```

我正在寻找的输出如下。如果评论字段为空/null，则使用前一天的值更新它（具有相同的 GroupId）

```
-----------------------------------------------
 Date            |  GroupId  |   Comment
-----------------------------------------------
01/05/2012           1              ABC
01/05/2012           2              XYZ
02/05/2012           1              ABC
02/05/2012           2              XYZ
03/05/2012           1              ABC
03/05/2012           2              XYZ
04/05/2012           1              DEF
04/05/2012           2              GHI
05/05/2012           1              DEF
05/05/2012           2              GHI
06/05/2012           1              DEF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:48:29.623

这是一个棘手的问题，我假设 Sybase 不支持`lag()`or `outer apply`。您可以在子查询中查找所有较早的注释，然后使用`non exists`子句要求中间没有注释。那应该找到以前的评论。

```
select  Date
,       GroupId
,       case
        when Comment is not null then Comment
        else
        (
        select  Comment
        from    YourTable yt2
        where   yt1.GroupId = yt2.GroupId
                and yt2.Comment is not null
                and yt2.Date < yt1.Date
                and not exists
                (
                select  *
                from    YourTable yt3
                where   yt1.GroupId = yt2.GroupId
                        and yt2.Comment is not null
                        and yt3.Date < yt2.Date and yt2.Date < yt1.Date
                )
        ) end as Comment
from    YourTable yt1 
```

# sql - 下一个生日与 fql - fbook

> ID：10372190
> 
> 赞同：0
> 
> 时间：2012-04-29T12:39:19.923
> 
> 标签：sql, facebook-graph-api, facebook-fql

使用 Facebook 图形 API 我有以下显示用户朋友本月的生日

```
SELECT uid, name,pic_square, birthday_date FROM user
WHERE (substr(birthday_date, 0, 2) = "04") AND uid IN
(SELECT uid2 FROM friend WHERE uid1 = me()) order by name 
```

我真正想要展示的是接下来的 10 个生日，所以它可能会跨越几个月，因为月份接近尾声，但是，facebook 确实喜欢查询中的 NOW，所以我有点迷茫我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:22:38.843

我想通了——这就是你的做法！

```
$dd = date(d);

$mm = date(m);

SELECT uid, name,pic_square, birthday_date FROM user
WHERE (((substr(birthday_date, 0, 2) = "$mm") AND 
(substr(birthday_date, 3, 2) > "$dd") OR (substr(birthday_date, 0, 2) > "$mm")))
AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) order by birthday_date asc 
```

# amazon-web-services - Amazon S3 存储定价

> ID：10372192
> 
> 赞同：1
> 
> 时间：2012-04-29T12:39:29.910
> 
> 标签：amazon-web-services, amazon-s3

如果我使用 Amazon s3 存储服务来托管我的图片和可下载内容，我应该支付多少费用。我想知道你为你的项目付了多少钱？s3有多便宜？

我需要弄清楚定价。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:43:06.913

[http://aws.amazon.com/s3/pricing/](http://aws.amazon.com/s3/pricing/)

[http://calculator.s3.amazonaws.com/calc5.html](http://calculator.s3.amazonaws.com/calc5.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:44:00.547

查看那里[http://aws.amazon.com/s3/](http://aws.amazon.com/s3/)向下滚动并选择您的区域。

对于美国来说是：

```
>   Standard Storage    Reduced Redundancy Storage First 1 TB / month   $0.125
> per GB    $0.093 per GB Next 49 TB / month    $0.110 per GB   $0.083 per GB
> Next 450 TB / month   $0.095 per GB   $0.073 per GB Next 500 TB /
> month $0.090 per GB   $0.063 per GB Next 4000 TB / month  $0.080 per
> GB    $0.053 per GB Over 5000 TB / month  $0.055 per GB   $0.037 per GB 
```

# java - 从 jar 中排除某些文件，这是 maven3 战争中的依赖项

> ID：10372197
> 
> 赞同：0
> 
> 时间：2012-04-29T12:41:19.300
> 
> 标签：java, maven-3, war

我有一个 jar 说 xyz.jar，其结构为 src/main/java/resources 。现在这个资源文件夹有 3 个子文件夹，比如 a/fileone.txt b/filetwo.txt 和 c/filethree.txt 。我使用这个 jar 作为构建三个 3 个不同战争文件的依赖项。在每个战争文件中，我只使用三个文件中的一个。即 fileone.txt 或 filetwo.txt 或 filethree.txt。因此，在用于构建 3 个战争文件中的任何一个的 pom.xml 中，有什么方法可以配置以排除剩余的两个文件？例如，如果我正在构建 firstWar.war，我只想包含 fileone.txt 并排除其他两个。我相信 maven war 插件中的[packageExcludes](http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html#packagingExcludes)可以在这里使用，但不确定如何使用？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:55:39.500

*   解决方案1：

您假设您有包含资源的 jar 文件。我建议将文件/资源​​放入战争模块中，并从单个构建中生成三个不同的战争。这可以通过使用 maven-assembly-plugin 来解决。您具有以下结构：

```
.
|-- pom.xml
`-- src
    |-- main
    |   |-- java
    |   |-- resources
    |   |-- environment
    |   |   |-- test
    |   |   |   `-- database.properties
    |   |   |-- qa
    |   |   |   `-- database.properties
    |   |   `-- production
    |   |       `-- database.properties
    |   `-- webapp 
```

你需要一个程序集描述符，当然还有一个像这样的 pom 文件：

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-assembly-plugin</artifactId>
    <executions>
      <execution>
        <id>test</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/test.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
      <execution>
        <id>qa</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/qa.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
      <execution>
        <id>production</id>
        <phase>package</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>${project.basedir}/src/main/assembly/production.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

描述符文件如下所示：

```
<assembly...
   <id>test</id>
  <formats>
    <format>war</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>
  <dependencySets>
    <dependencySet>
      <unpack>true</unpack>
      <useProjectArtifact>true</useProjectArtifact>
    </dependencySet>
  </dependencySets>
  <fileSets>
    <fileSet>
      <outputDirectory>WEB-INF</outputDirectory>
      <directory>${basedir}/src/main/environment/test/</directory>
      <includes>
        <include>**</include>
      </includes>
    </fileSet>
  </fileSets>
</assembly> 
```

每个资源都需要它（在你的情况下是三次）。它们可以像您的环境一样命名，例如测试、质量保证、生产环境（不要忘记给它们一个适当的 ID）。它们应该放在 src/main/assembly 文件夹中。或与您的环境有关（file1、file2、file3，但我认为现实中存在更好的名称。）。

*   解决方案2：

您将对使用的 jar 文件进行相同的设置，并使用代表您喜欢的资源的适当分类器创建三个不同的 jar 文件。但之后您必须更改战争版本，为每个不同的资源创建三个不同的战争文件。关于设置[我写了一篇博](http://blog.soebes.de/index.php?/archives/340-Maven-Configuration-For-Multipe-Environments.html)文。

# wpf - 计算WPF中excel列的动态单元格/行的总和

> ID：10372200
> 
> 赞同：1
> 
> 时间：2012-04-29T12:41:57.417
> 
> 标签：wpf, excel

请问，有什么方法可以将给定列的单元格（行）的内容相加（汇总），其可能的行（单元格）数是动态的，即行数不固定，在一个excel工作表？我一直在尝试没有任何有意义的结果，我尝试使用偏移量但不断从 HRESULT blah blah 获得一些 COM_Exception ......

下面是我试图用来实现我的目的的演示代码的一部分。

请任何建议（带有代码片段）将不胜感激。

```
 private void button1_Click(object sender, RoutedEventArgs e)

       {

        excel.Application xlApp;

        excel.Workbook xlWorkBook;

        excel.Worksheet xlWorkSheet;

        object misValue = System.Reflection.Missing.Value;

        xlApp = new excel.Application();

        var MyExcel = new excel.Application();

        xlWorkBook = xlApp.Workbooks.Add(misValue);

        xlWorkSheet = (excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);

        excel.Range chartRange;
        chartRange = xlWorkSheet.get_Range("$A:$A", Type.Missing);

        xlWorkSheet.Cells[1, 1] = "Temperature(deg)";
        xlWorkSheet.Cells[1, 2] = "Humidity(m-3)";
        xlWorkSheet.Cells[1, 3] = "Wind Speed(m/s)";
        xlWorkSheet.Cells[2, 1] = 33;
        xlWorkSheet.Cells[2, 2] = 45;
        xlWorkSheet.Cells[2, 3] = 34;
        xlWorkSheet.Cells[3, 1] = 23;
        xlWorkSheet.Cells[3, 2] = 26;
        xlWorkSheet.Cells[3, 3] = 43;
        xlWorkSheet.Cells[4, 1] = 45;
        xlWorkSheet.Cells[4, 2] = 24;
        xlWorkSheet.Cells[4, 3] = 34;
        xlWorkSheet.Cells[5, 1] = 40;
        xlWorkSheet.Cells[5, 2] = 32;
        xlWorkSheet.Cells[5, 3] = 42;

        decimal fdt = 0;
        int i = 2;

        excel.Range targetRange = (excel.Range)xlWorkSheet.Cells[2, 1];

        while (xlWorkSheet.Cells.Offset[i, 0].Value2 != null)
        {
            i++;
            fdt += xlWorkSheet.Cells.Offset[i, 0].Value2;
        }

        MessageBox.Show(fdt.ToString());

  excel.ChartObjects xlCharts = (excel.ChartObjects)xlWorkSheet.ChartObjects(Type.Missing);
  excel.ChartObject myChart = (excel.ChartObject)xlCharts.Add(400, 50, 400, 300);
  excel.Chart chartPage = myChart.Chart;      
  chartPage.SetSourceData(chartRange, misValue);
  chartPage.ChartType = excel.XlChartType.xl3DColumnClustered;

  try
  {
      myChart.Chart.HasTitle = true;
      excel.Range objRange = (excel.Range)xlWorkSheet.Cells["$A:$A", Type.Missing];

      String strData = objRange.get_Value(misValue).ToString();

      myChart.Chart.ChartTitle.Text = strData;

  }
  catch (Exception ex)
  {
      MessageBox.Show(ex.ToString());
  }

             xlWorkBook.SaveAs("DemoChart_1.xls", excel.XlFileFormat.xlWorkbookNormal, misValue, misValue, misValue, misValue,

    excel.XlSaveAsAccessMode.xlExclusive, misValue, misValue, misValue, misValue, misValue);

             xlApp.Visible = true;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T04:46:28.513

I don't believe that `xlWorkSheet.Cells.Offset[i, 0].Value2` is valid. Instead of using `Offset`, just stick with `Cells(i, 1).Value2`. Let me know if that works for you.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T06:15:02.053

没关系，我自己已经能够做到了。对于任何可能像我一样被这种问题困扰的人，给你：

```
 int numRows = 0;
            double sum = 0;
            double Average = 0;
            excel.Range count = xlWorkSheet.UsedRange.Columns["A", misValue] as excel.Range;
            foreach (excel.Range cell in count.Cells)
            {
                if (cell.Value2 != null && cell.Value2 is double?)

                 {
                    sum += cell.Value2;
                    numRows += 1;
                }

            }

            Average = sum / numRows;
           txtAverage.Text = Average.ToString(); 
```

//“&&”是非常必要的，以避免将单元格的值（可能是一个字符串——比如列的标题）加倍，以避免出错。

# cocoa - NSView 框架和 setContentBorderThickness:forEdge:

> ID：10372201
> 
> 赞同：0
> 
> 时间：2012-04-29T12:42:02.893
> 
> 标签：cocoa, user-interface

我有一个窗口，我设置了它`setContentBorderThickness:42 forEdge:NSMinYEdge`。

现在，当我这样做时，`[[window contentSize] frame]`它仍然显示窗口的尺寸（减去带有标题和按钮的顶部栏），但它不会减去边框厚度的 42。

请问，我如何获得空白区域的正确尺寸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:38:30.847

你应该使用 not`contentSize`但是`contentView`。如果您使用 42 像素高度 BorderThickness 而不是从窗口视图的高度中减去该高度，如下所示：

```
NSRect windowFrame = [[window contentView] frame];

windowFrame.size.height = windowFrame.size.height - [window contentBorderThicknessForEdge:NSMinYEdge];

NSLog(@"TRUE height: %f",windowFrame.size.height); 
```

# linux - Linux中的绝对路径（文件路径中有空格）

> ID：10372202
> 
> 赞同：0
> 
> 时间：2012-04-29T12:42:03.703
> 
> 标签：linux, path, find

所以我想在当前目录中列出具有完整路径的文件，如果我写

```
find $PWD 
```

事情有效，但是当路径中有空格时，即：

```
/media/sda3/Music/Dub/Albums/Juakali/2011 - DreadBass Soundsystem 
```

`find $PWD`给了我这个：

```
find: `/media/sda3/Music/Dub/Albums/Juakali/2011': No such file or directory
find: `-': No such file or directory
find: `DreadBass': No such file or directory
find: `Soundsystem': No such file or directory 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T12:45:08.160

引用你的论点：

```
find "$PWD" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T12:50:26.703

$PWD 与`.`. 所以你可以使用

```
find . 
```

如果不是 $PWD 你可以用引号括起来`"`

```
find "$VARIABLE" 
```

# c++ - 创建新的 Windows 窗体项目时 VS 2010 中的错误消息

> ID：10372203
> 
> 赞同：0
> 
> 时间：2012-04-29T12:42:06.337
> 
> 标签：c++, visual-studio-2010

每次当我尝试创建新的 C++ Windows 窗体项目时，我都会收到此错误：

![错误](../Images/b5509d425002c64989b3c25da9fa8b03.png)

该问题仅在创建 C++ 项目时仍然存在。我对 C# 或 VB 没有这个问题。

这是调用堆栈：

在 Microsoft.VisualStudio.Designer.Interfaces.IVSMDCodeDomProvider.get_CodeDomProvider() 在 Microsoft.VisualStudio.Shell.Design.Serialization.CodeDom.CodeDomDocDataAdapter.get_Provider() 在 Microsoft.VisualStudio.Shell.Design.Serialization.CodeDom.CodeDomDocDataAdapter.get_CompileUnit()在 Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.PerformLoad(IDesignerSerializationManager serializationManager) 在 Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.DeferredLoadHandler.Microsoft.VisualStudio.TextManager.Interop.IVsTextBufferDataEvents.OnLoadCompleted(Int32 fReload)

# android - Android：AsyncTask 中的错误警报对话框

> ID：10372204
> 
> 赞同：0
> 
> 时间：2012-04-29T12:42:18.580
> 
> 标签：android

我想在 AsyncTask 中显示一个 AlertDialog 但它给出了一个错误的令牌异常。上下文由 AsyncTask 的构造函数给出。

```
protected void onProgressUpdate(Object... obj) {
   AlertDialog alert;
   final CharSequence[] items = {"Run Chat", "Show Position", "Show Infos"};
   AlertDialog.Builder builder = new AlertDialog.Builder(context);
   builder.setTitle("Actions");
   builder.setItems(items, new DialogInterface.OnClickListener() {
   @Override
       public void onClick(DialogInterface arg0, int arg1) {
       // TODO Auto-generated method stub

       }

    });
     builder.show(); //it's give a bad token exception
} 
```

**日志猫：**

```
04-29 12:56:57.035: E/AndroidRuntime(1299): Uncaught handler: thread main exiting due to uncaught exception
04-29 12:56:57.045: E/AndroidRuntime(1299): android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.view.ViewRoot.setView(ViewRoot.java:472)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.app.Dialog.show(Dialog.java:239)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.app.AlertDialog$Builder.show(AlertDialog.java:802)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at fr.utbm.aiechat.TCPHandlerTask.onProgressUpdate(TCPHandlerTask.java:98)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:432)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.os.Looper.loop(Looper.java:123)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at java.lang.reflect.Method.invokeNative(Native Method)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at java.lang.reflect.Method.invoke(Method.java:521)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-29 12:56:57.045: E/AndroidRuntime(1299):     at dalvik.system.NativeStart.main(Native Method) 
```

谢谢你的回答。

```
public class TCPHandlerTask extends AsyncTask<Void, Object, Void>
{
    private boolean done;
    private Network Net;
    private Context context;
    private ServerSocket SocketServer;
    public TCPHandlerTask(Context applicationContext) {
        // TODO Auto-generated constructor stub
        context = applicationContext;
    }

    @Override
    protected void onPreExecute()
    {
        done = false;
        Net = Network.getInstance();
        SocketServer = Net.getSocketServer();
    }

    public void stop()
    {
        done = true;
    }

    @Override
    protected Void doInBackground(Void... params)
    {
        while(!done)
        {
            try
            {
                Socket client = SocketServer.accept();
                InputStream is = client.getInputStream();
                ObjectInputStream dis = new ObjectInputStream(is);
                int idPacket = 0;
                idPacket = dis.readInt();
                switch(idPacket) {
                    case Packets.CHANJOIN_REQUEST : 
                        System.out.println("Paquet request join");

                        publishProgress(idPacket);
                    break;
                }
                client.close();
            }
            catch (IOException e)
            {
                e.printStackTrace();
            }
        }
        return null;
    }
    protected void onProgressUpdate(Object... obj)
    {
        int idProgress = (Integer) obj[0];
        switch(idProgress) {
            case Packets.CHANJOIN_REQUEST :
                AlertDialog alert;
                final CharSequence[] items = {"Lancer Chat", "Voir Position", "Voir Infos"};
                AlertDialog.Builder builder = new AlertDialog.Builder(context);
                builder.setTitle("Actions");
                builder.setItems(items, new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface arg0, int arg1) {
                        // TODO Auto-generated method stub

                    }

                });
                builder.show();
                System.out.println("context4 = ");
            break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T09:42:26.230

您正在使用警报对话框而不关闭进度对话框。这是在活动中添加窗口的问题，即内存窗口泄漏。

当调用对话框而不关闭先前的对话框时会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:49:39.887

我认为“上下文”是导致异常的问题。（上下文不是活动）

编辑：

与其在构造函​​数中发送 Context ，不如发送您的 Activity ，这是您的类名。

```
private Activity activity;
 public TCPHandlerTask(Activity applicationActivity) {
    // TODO Auto-generated constructor stub
    activity = applicationActivity;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-29T20:48:04.703

尝试`AlertDialog`从`onPreExecute`或 从拨打电话`onPostExecute`。

# magento - 自定义选项的 Magento 免费送货规则

> ID：10372207
> 
> 赞同：2
> 
> 时间：2012-04-29T12:43:01.827
> 
> 标签：magento, fedex

我们有 700 种简单的产品和每个产品的自定义选项。如果有人选择自定义选项，我们需要应用规则，那么他将获得免费送货。否则将收取运费。Magento有可能吗？任何人都可以请给出任何解决方案。我如何在自定义选项上应用免费送货。

# stylesheet - 如何使用 pyqt4 样式表拉伸图像？

> ID：10372208
> 
> 赞同：1
> 
> 时间：2012-04-29T12:43:05.570
> 
> 标签：stylesheet, pyqt4

我有一个小部件，我想要一个背景图像。我尝试使用背景大小，但它不起作用。我知道它可以在 qlabel 中完成，但我想知道它是否可能用于 pyqt4 样式表。有没有办法根据小部件的大小来拉伸图像？

```
QWidget#widget{
    image: url(:/images/image.jpg);
    background-size: 100%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T17:07:23.650

你需要`border-image`.

```
QWidget#widget{
    border-image: url(:/images/image.jpg);
} 
```

引用[文档](http://doc.qt.nokia.com/4.7-snapshot/stylesheet-customizing.html)：

> 背景图像不会随着小部件的大小而缩放。要提供与小部件大小一起缩放的“皮肤”或背景，必须使用边框图像。由于border-image 属性提供了备用背景，因此在指定border-image 时不需要指定background-image。在这种情况下，当它们都被指定时，边框图像会覆盖背景图像。

# ios - UIWebView与WebServer的AJAX交互的拦截

> ID：10372212
> 
> 赞同：0
> 
> 时间：2012-04-29T12:44:00.677
> 
> 标签：ios, ajax, uiwebview, proxy, webkit

我正在尝试为 iOS 制作一个具有自定义加密的网络浏览器。

为此，我想做一个本地代理，它将实现数据的加密/加密逻辑，并与远程服务器交互。我希望 UIWebView 可以使用这个代理，就像使用 web 服务器一样。

问题是ajax，哪里有拦截UIWebView收发ajax请求和响应的地方？使用本地代理和 xmlhttprequests 有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T16:34:11.120

我以前做过类似的事情。以下是步骤：

1.  向用户展示一个允许他们输入用户名和密码的视图。
2.  使用要连接的 URL 创建一个 NSURL 对象。
3.  使用您刚刚创建的 NSURL 对象创建一个 NSURLRequest 对象。
4.  使用刚刚创建的 NSURLRequest 对象创建一个 NSURLConnection 对象，并将委托设置为 self。
5.  添加 connection:didReceiveAuthenticationChallenge: 以检测来自 Web 服务器的质询。

检查NSURLConnection 类的[文档希望这有帮助！](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)

# c# - 如何在我的插件菜单中添加几个选项？

> ID：10372213
> 
> 赞同：0
> 
> 时间：2012-04-29T12:44:10.390
> 
> 标签：c#, visual-studio-2010, visual-studio-addins

我真的在为此苦苦挣扎。我想在工具菜单中创建一个项目，以便...

```
tools -->  myaddin  --> my option 1
                    --> my option 2
                    --> my option 3 
```

我只是想不通我是怎么做的。它真的很烦人，没有关于它的真正信息似乎只是在讨论如何添加项目......

我已经拥有的代码是插件库创建的......

```
public void OnConnection(object application, ext_ConnectMode connectMode,
    object addInInst, ref Array custom)
{
  _applicationObject = (DTE2)application;
  _addInInstance = (AddIn)addInInst;
  if(connectMode == ext_ConnectMode.ext_cm_UISetup)
  {
    object []contextGUIDS = new object[] { };
    Commands2 commands = (Commands2)_applicationObject.Commands;

    //Place the command on the tools menu.
    //Find the MenuBar command bar, which is the top-level command bar holding all
    // the main menu items:
    Microsoft.VisualStudio.CommandBars.CommandBar menuBarCommandBar = 
        ((Microsoft.VisualStudio.CommandBars.CommandBars)
            _applicationObject.CommandBars)["MenuBar"];

    //Find the Tools command bar on the MenuBar command bar:
    CommandBarControl toolsControl = menuBarCommandBar.Controls["Tools"];

    //same thing just as a popup
    CommandBarPopup toolsPopup = (CommandBarPopup)toolsControl;

    //This try/catch block can be duplicated if you wish to add multiple commands to
    // be handled by your Add-in,
    // just make sure you also update the QueryStatus/Exec method to include the new
    // command names.
    try
    {
      //Add a command to the Commands collection:
      Command command = commands.AddNamedCommand2(_addInInstance, "Switch",
          "Switch", "Executes the command for Switch", true, 59, ref contextGUIDS,
          (int)vsCommandStatus.vsCommandStatusSupported+
              (int)vsCommandStatus.vsCommandStatusEnabled,
          (int)vsCommandStyle.vsCommandStylePictAndText,
          vsCommandControlType.vsCommandControlTypeButton);

      //Add a control for the command to the tools menu:
      if((command != null) && (toolsPopup != null)) {
        command.AddControl(toolsPopup.CommandBar, 1);
      }
    }
    catch(System.ArgumentException)
    {
      //If we are here, then the exception is probably because a command with that
      //  name
      //  already exists. If so there is no need to recreate the command and we can 
      //  safely ignore the exception.
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T12:53:51.130

```
menuItem.DropDownItems.AddRange(new ToolStrinpItem[] { menuItem1, menuItem2 }); 
```

使用 GUI 构建器的工作方式是将鼠标悬停在菜单项上并输入它们的名称：打开菜单 -> 将鼠标悬停在菜单项上 -> 单击出现的框 -> 输入菜单项文本 -> 输入下一个菜单项目文本。

# javascript - Array.prototype.each = function(callback) { for (var i = 0; i < this.length; i++) callback(this[i]); } - 这个可以吗？

> ID：10372214
> 
> 赞同：3
> 
> 时间：2012-04-29T12:44:12.403
> 
> 标签：javascript, arrays, node.js, iteration, prototype

我知道这是一个品味问题，但是对于我的品味来说，每次我想迭代数组时都使用 for 循环是不好的。所以我想出了这个：

```
Array.prototype.each = function(callback) {
  for (var i = 0; i < this.length; i++)
    callback(this[i]);
} 
```

现在我可以这样做：

```
[10, 20, 30].each(function(n) { console.log(n/10) }) 
```

后来我在网上找到了一些建议这种方法的提示，但我仍然想知道它是否没有副作用。这似乎很明显，这就是我担心的:)

我没有使用像 jQuery 或 Prototype 这样的库。我正在为 Node.js 编写代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T12:48:56.443

我建议你使用`forEach`. 它在大多数现代浏览器中实现，并且 shim 由[MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach)提供。

在 node.js 上，它已实现（它使用 V8，与 Chrome 相同的引擎），因此您不需要 shim。

它的使用类似于以下内容：

```
arr.forEach( function( el ) {
    // play with "el"
} ) 
```

另外，我建议你看看 ES5 提供的新数组方法：

*   [地图](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map)
*   [筛选](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)
*   [减少](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/reduce)
*   [每一个](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/every)
*   [一些](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/some)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-29T12:50:02.570

这确实有很大的副作用

如果我们现在运行以下代码

```
a = [10, 20, 30];
for (var i in a) {
    console.log(i + ": " + a[i]);
} 
```

检查控制台输出，我们看到：

```
0: 10
1: 20
2: 30
each: function (callback) {
  for (var i = 0; i < this.length; i++)
    callback(this[i]);
} 
```

这限制了您可以在数组上执行的 for 循环的类型

```
a = [10, 20, 30];
for (var i = 0; i < a.length; ++i) {
    console.log(a[i] + ": " + a[i]);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-26T00:37:19.807

从：

```
// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.io/#x15.4.4.18
if (!Array.prototype.forEach) {

  Array.prototype.forEach = function(callback, thisArg) {

    var T, k;

    if (this === null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1\. Let O be the result of calling toObject() passing the
    // |this| value as the argument.
    var O = Object(this);

    // 2\. Let lenValue be the result of calling the Get() internal
    // method of O with the argument "length".
    // 3\. Let len be toUint32(lenValue).
    var len = O.length >>> 0;

    // 4\. If isCallable(callback) is false, throw a TypeError exception. 
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== "function") {
      throw new TypeError(callback + ' is not a function');
    }

    // 5\. If thisArg was supplied, let T be thisArg; else let
    // T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6\. Let k be 0
    k = 0;

    // 7\. Repeat, while k < len
    while (k < len) {

      var kValue;

      // a. Let Pk be ToString(k).
      //    This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty
      //    internal method of O with argument Pk.
      //    This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        // method of O with argument Pk.
        kValue = O[k];

        // ii. Call the Call internal method of callback with T as
        // the this value and argument list containing kValue, k, and O.
        callback.call(T, kValue, k, O);
      }
      // d. Increase k by 1.
      k++;
    }
    // 8\. return undefined
  };
} 
```

加上这个与 html 元素一起使用：

```
NodeList.prototype.forEach = HTMLCollection.prototype.forEach = Array.prototype.forEach; 
```

瞧！

# javascript - Jquery验证示例不起作用

> ID：10372215
> 
> 赞同：0
> 
> 时间：2012-04-29T12:44:35.200
> 
> 标签：javascript, asp.net-mvc, validation, jquery-validate

我正在尝试测试一个非常基本的 jquery 验证示例。代码如下：

```
<form action="/" method="post">
    <input type="text" name="foo" id="foo"/>
</form>​ 
```

我的 JS 代码：

```
$('#foo').validate({
    foo: {
        required: true,
        minlength: 2
    }
});​ 
```

那不起作用...任何帮助或工作示例将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T09:29:26.450

尝试这个

```
 <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>

<script> 
    $(document).ready(function(){
        $("#commentForm").validate({
        rules: {
            txtPhNumber: "required",
            txtPhNumber2:
                {
            equalTo: "#txtPhNumber"
                }
            }
        });
    });

  </script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T13:00:49.463

**您在表单**上使用该`validate`方法，而不是在单个元素中，并且所有规则都应该在属性内，例如：**`rules`**

 **```
$("form").validate({
    rules: {
        foo: {
            required: true,
            minlength: 2
        }
    }
}); 
```

[在 JsBin](http://jsbin.com/ipetog/2/edit)中可以找到一个活生生的例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-29T13:04:43.197

在表单中调用该`validate`方法并将规则包装在一个`rules`对象中。如果你想添加一个`messages`对象。

HTML：

```
<form id="form" action="/" method="post">
    <input type="text" name="foo" id="foo">
</form> 
```

javascript:

```
$('#form').validate({
    rules: {
        foo: {
            required: true,
            minlength: 2
        }
    },
    messages: {
       foo: "Please enter your foo"
   }
}); 
```

另请参阅[此示例](http://jsfiddle.net/a7xNX/)。**

# python - 将windows上的python脚本交叉编译成linux可执行文件

> ID：10372216
> 
> 赞同：5
> 
> 时间：2012-04-29T12:44:38.410
> 
> 标签：python, windows, ubuntu, cross-compiling

我在 Windows 上使用 Python 创建了一个程序。你如何把它变成Linux可执行文件？具体来说是 Linux Ubuntu 9.10。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T20:54:43.730

天斗，

由于我通常在 Linux 机器上开发，所以当我需要 windows 版本时，我经常使用 cx_freeze 制作 windows 二进制文件，但我也用它制作 Linux 二进制文件，它工作得很好（它是多平台的，py2exe 不是）。就像 Eli 上面所说的那样，它并没有真正编译，而只是将解释器、字节编译代码和所需的库捆绑到一个可执行文件中，但你会得到你想要的（在没有预装 python 的机器上运行）。

在 Linux 机器上安装 cx_freeze 后，你可以用一些简单的东西来尝试一下，比如我保存为*test.py*的这个虚拟代码：

```
import time

for i in range(10):
  print i
  time.sleep(1) 
```

然后运行*​​cxfreeze*生成二​​进制文件。输出将如下所示：

```
$ cxfreeze test.py 
copying /usr/lib/python2.6/site-packages/cx_Freeze/bases/Console -> /home/claudio/dist/test
copying /usr/lib/libpython2.6.so.1.0 -> /home/claudio/dist/libpython2.6.so.1.0
writing zip file /home/claudio/dist/test

  Name                      File
  ----                      ----
m StringIO                  
m UserDict                  
m __builtin__               
m __main__                  test.py
m _abcoll                   
m _codecs                   
m _codecs_cn                /usr/lib/python2.6/lib-dynload/_codecs_cn.so
m _codecs_hk                /usr/lib/python2.6/lib-dynload/_codecs_hk.so
m _codecs_iso2022           /usr/lib/python2.6/lib-dynload/_codecs_iso2022.so
m _codecs_jp                /usr/lib/python2.6/lib-dynload/_codecs_jp.so
m _codecs_kr                /usr/lib/python2.6/lib-dynload/_codecs_kr.so
m _codecs_tw                /usr/lib/python2.6/lib-dynload/_codecs_tw.so
m _functools                /usr/lib/python2.6/lib-dynload/_functools.so
m _locale                   /usr/lib/python2.6/lib-dynload/_locale.so
m _multibytecodec           /usr/lib/python2.6/lib-dynload/_multibytecodec.so
m _sre                      
m _strptime                 /usr/lib/python2.6/_strptime.py
m _struct                   /usr/lib/python2.6/lib-dynload/_struct.so
m _warnings                 
m abc                       
m array                     /usr/lib/python2.6/lib-dynload/array.so
m base64                    
m binascii                  /usr/lib/python2.6/lib-dynload/binascii.so
m bz2                       /usr/lib/python2.6/lib-dynload/bz2.so
m cStringIO                 /usr/lib/python2.6/lib-dynload/cStringIO.so
m calendar                  /usr/lib/python2.6/calendar.py
m codecs                    
m copy                      
m copy_reg                  
m cx_Freeze__init__         /usr/lib/python2.6/site-packages/cx_Freeze/initscripts/Console.py
m datetime                  /usr/lib/python2.6/lib-dynload/datetime.so
m dummy_thread              /usr/lib/python2.6/dummy_thread.py
P encodings                 
m encodings.aliases         
m encodings.ascii           
m encodings.base64_codec    
m encodings.big5            
m encodings.big5hkscs       
m encodings.bz2_codec       
m encodings.charmap         
m encodings.cp037           
m encodings.cp1006          
m encodings.cp1026          
m encodings.cp1140          
m encodings.cp1250          
m encodings.cp1251          
m encodings.cp1252          
m encodings.cp1253          
m encodings.cp1254          
m encodings.cp1255          
m encodings.cp1256          
m encodings.cp1257          
m encodings.cp1258          
m encodings.cp424           
m encodings.cp437           
m encodings.cp500           
m encodings.cp737           
m encodings.cp775           
m encodings.cp850           
m encodings.cp852           
m encodings.cp855           
m encodings.cp856           
m encodings.cp857           
m encodings.cp860           
m encodings.cp861           
m encodings.cp862           
m encodings.cp863           
m encodings.cp864           
m encodings.cp865           
m encodings.cp866           
m encodings.cp869           
m encodings.cp874           
m encodings.cp875           
m encodings.cp932           
m encodings.cp949           
m encodings.cp950           
m encodings.euc_jis_2004    
m encodings.euc_jisx0213    
m encodings.euc_jp          
m encodings.euc_kr          
m encodings.gb18030         
m encodings.gb2312          
m encodings.gbk             
m encodings.hex_codec       
m encodings.hp_roman8       
m encodings.hz              
m encodings.idna            
m encodings.iso2022_jp      
m encodings.iso2022_jp_1    
m encodings.iso2022_jp_2    
m encodings.iso2022_jp_2004 
m encodings.iso2022_jp_3    
m encodings.iso2022_jp_ext  
m encodings.iso2022_kr      
m encodings.iso8859_1       
m encodings.iso8859_10      
m encodings.iso8859_11      
m encodings.iso8859_13      
m encodings.iso8859_14      
m encodings.iso8859_15      
m encodings.iso8859_16      
m encodings.iso8859_2       
m encodings.iso8859_3       
m encodings.iso8859_4       
m encodings.iso8859_5       
m encodings.iso8859_6       
m encodings.iso8859_7       
m encodings.iso8859_8       
m encodings.iso8859_9       
m encodings.johab           
m encodings.koi8_r          
m encodings.koi8_u          
m encodings.latin_1         
m encodings.mac_arabic      
m encodings.mac_centeuro    
m encodings.mac_croatian    
m encodings.mac_cyrillic    
m encodings.mac_farsi       
m encodings.mac_greek       
m encodings.mac_iceland     
m encodings.mac_latin2      
m encodings.mac_roman       
m encodings.mac_romanian    
m encodings.mac_turkish     
m encodings.mbcs            
m encodings.palmos          
m encodings.ptcp154         
m encodings.punycode        
m encodings.quopri_codec    
m encodings.raw_unicode_escape 
m encodings.rot_13          
m encodings.shift_jis       
m encodings.shift_jis_2004  
m encodings.shift_jisx0213  
m encodings.string_escape   
m encodings.tis_620         
m encodings.undefined       
m encodings.unicode_escape  
m encodings.unicode_internal 
m encodings.utf_16          
m encodings.utf_16_be       
m encodings.utf_16_le       
m encodings.utf_32          
m encodings.utf_32_be       
m encodings.utf_32_le       
m encodings.utf_7           
m encodings.utf_8           
m encodings.utf_8_sig       
m encodings.uu_codec        
m encodings.zlib_codec      
m errno                     
m functools                 /usr/lib/python2.6/functools.py
m genericpath               
m gettext                   /usr/lib/python2.6/gettext.py
m imp                       
m itertools                 /usr/lib/python2.6/lib-dynload/itertools.so
m linecache                 
m locale                    /usr/lib/python2.6/locale.py
m operator                  /usr/lib/python2.6/lib-dynload/operator.so
m optparse                  /usr/lib/python2.6/optparse.py
m os                        
m posix                     
m posixpath                 
m pwd                       
m quopri                    
m re                        /usr/lib/python2.6/re.py
m repr                      
m sre_compile               /usr/lib/python2.6/sre_compile.py
m sre_constants             /usr/lib/python2.6/sre_constants.py
m sre_parse                 /usr/lib/python2.6/sre_parse.py
m stat                      
m string                    /usr/lib/python2.6/string.py
m stringprep                
m strop                     /usr/lib/python2.6/lib-dynload/strop.so
m struct                    
m sys                       
m textwrap                  /usr/lib/python2.6/textwrap.py
m thread                    
m time                      /usr/lib/python2.6/lib-dynload/time.so
m token                     /usr/lib/python2.6/token.py
m tokenize                  /usr/lib/python2.6/tokenize.py
m traceback                 
m types                     
m unicodedata               /usr/lib/python2.6/lib-dynload/unicodedata.so
m warnings                  
m zipimport                 
m zlib                      /usr/lib/python2.6/lib-dynload/zlib.so

copying /usr/lib/python2.6/lib-dynload/_codecs_cn.so -> /home/claudio/dist/_codecs_cn.so
copying /usr/lib/python2.6/lib-dynload/_codecs_hk.so -> /home/claudio/dist/_codecs_hk.so
copying /usr/lib/python2.6/lib-dynload/_codecs_iso2022.so -> /home/claudio/dist/_codecs_iso2022.so
copying /usr/lib/python2.6/lib-dynload/_codecs_jp.so -> /home/claudio/dist/_codecs_jp.so
copying /usr/lib/python2.6/lib-dynload/_codecs_kr.so -> /home/claudio/dist/_codecs_kr.so
copying /usr/lib/python2.6/lib-dynload/_codecs_tw.so -> /home/claudio/dist/_codecs_tw.so
copying /usr/lib/python2.6/lib-dynload/_functools.so -> /home/claudio/dist/_functools.so
copying /usr/lib/python2.6/lib-dynload/_locale.so -> /home/claudio/dist/_locale.so
copying /usr/lib/python2.6/lib-dynload/_multibytecodec.so -> /home/claudio/dist/_multibytecodec.so
copying /usr/lib/python2.6/lib-dynload/_struct.so -> /home/claudio/dist/_struct.so
copying /usr/lib/python2.6/lib-dynload/array.so -> /home/claudio/dist/array.so
copying /usr/lib/python2.6/lib-dynload/binascii.so -> /home/claudio/dist/binascii.so
copying /usr/lib/python2.6/lib-dynload/bz2.so -> /home/claudio/dist/bz2.so
copying /usr/lib/python2.6/lib-dynload/cStringIO.so -> /home/claudio/dist/cStringIO.so
copying /usr/lib/python2.6/lib-dynload/datetime.so -> /home/claudio/dist/datetime.so
copying /usr/lib/python2.6/lib-dynload/itertools.so -> /home/claudio/dist/itertools.so
copying /usr/lib/python2.6/lib-dynload/operator.so -> /home/claudio/dist/operator.so
copying /usr/lib/python2.6/lib-dynload/strop.so -> /home/claudio/dist/strop.so
copying /usr/lib/python2.6/lib-dynload/time.so -> /home/claudio/dist/time.so
copying /usr/lib/python2.6/lib-dynload/unicodedata.so -> /home/claudio/dist/unicodedata.so
copying /usr/lib/python2.6/lib-dynload/zlib.so -> /home/claudio/dist/zlib.so 
```

请注意，对于较大的项目，您可能会收到“缺少模块”错误。*如果您确定它们已安装，您可以使用 --include -modules*开关手动将它们指向 cx_freeze 。请参阅*cxfreeze --help*以获得完整的帮助。

您还可以创建一个*setup.py*文件，使“cxfreezing”类似于我们通常安装 python 包的方式，而不是直接从命令行进行。这篇文章甚至对一个**wxPython**项目也这样做了，它可能与你的项目相似： [A cx_Freeze 教程 – 构建二进制系列！](http://www.blog.pythonlibrary.org/2010/08/12/a-cx_freeze-tutorial-build-a-binary-series/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T12:57:35.220

一些可以帮助您做到这一点的项目是[py2exe](http://www.py2exe.org/)、[cx_freeze](http://cx-freeze.sourceforge.net/)和[pyinstaller](http://www.pyinstaller.org/)。

请注意，他们所做的并不是经典意义上的“编译”。相反，他们可以将 Python 解释器与您的程序所需的所有库捆绑到一个可执行文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T21:21:48.473

我没有在 Linux 上部署应用程序的经验 - 但是你不能在打包软件时添加依赖项`apt-get`吗？我一直在安装引入其他库的软件包。好像你可以为 wx 做这个。

# jquery - 即使弹出 jQuery 模态对话框，我的一些网站页面链接仍然有效

> ID：10372218
> 
> 赞同：0
> 
> 时间：2012-04-29T12:44:40.470
> 
> 标签：jquery, css

当弹出 jQuery 对话框时，如何使我的网站上的所有链接冻结？我已经完成了 z-index 的事情，但似乎没有任何效果。我在屏幕截图上清楚地列出了所有内容。链接在这里。[http://wsoplugins.com/wp-content/uploads/2012/04/pluginproblem.png](http://wsoplugins.com/wp-content/uploads/2012/04/pluginproblem.png)

太感谢了。-罗恩。

这是代码...

```
$j(function{
       $j('#mystuff').dialog({modal: true, resizable: false, width: 800, height: 250});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:47:22.500

在没有看到您的代码的情况下（在这种情况下，屏幕截图确实不算数），我只能建议：

```
$('a').click(
    function(){
        var modal = $(selectorToFindModalDialogue);
        if (modal.is(':visible')){
            return false;
        }
    }); 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/nsEgK/1/)。

参考：

*   [`click()`](http://api.jquery.com/click/).
*   [`is()`](http://api.jquery.com/is/).

# google-app-engine - AppEngine 后端返回 503 - Java

> ID：10372223
> 
> 赞同：0
> 
> 时间：2012-04-29T12:45:08.127
> 
> 标签：google-app-engine, cron, backend

我们有两个 cron 作业，它们遇到了两个不同的动态后端，并且都遇到了同样的问题。我可以通过导航到 cron 作业直接在浏览器中执行的 URL 来复制问题。

我们的应用程序的冷启动时间相当长。当我导航到使用后端的 URL 时，我看到以下错误

```
Error: Server Error
The service you requested is not available yet.

Please try again in 30 seconds. 
```

在日志中，我看到后端的 /_ah/start 请求（我们没有特定的处理程序）并带有以下消息：

```
 This request caused a new process to be started for your application, and thus caused your application code to be loaded for the first time. This request may thus take longer and use more CPU than a typical request for your application. 
```

然后我所做的是刷新后端 URL，它工作正常。

所以我的理论是，如果后端已经加载，cron 作业可以正常工作。如果不是，它不会等待足够长的时间来查看后端是否会加载。

假设这是正确的，有没有办法让 cron 作业等到 /_ah/start 完成？

另外两个选项是使用我们不想做的常驻实例，或者改善我们的冷启动时间，这在待办事项列表中但直到现在对我们来说还不是问题（我们使用常驻实例作为前端）。

后端是B1。假设我们可以升级它，但作为一家资金紧张的初创公司，我宁愿不升级。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T12:58:37.887

Cron 没有 taskqueue 所具有的重试功能，因此我建议使用前端 cron 以便将任务放入具有动态后端实例的任务队列中。这样，cron 请求本身将由空置的前端实例处理，这比您现在所做的更可靠，并且在失败时将重试您的后端任务执行。

为了使第一个 cron 调用更健壮，您可以为一个特定的后端任务多次发出 cron 请求，并在放置任务时，将任务命名为与特定任务相关联的名称（例如 20120430-task1 或其他名称），捕获任务的错误重复（并且在 catch 子句中除了记录之外什么都不做）。

有关命名任务的更多详细信息，请参阅： [https ://developers.google.com/appengine/docs/java/taskqueue/overview#Task_Names](https://developers.google.com/appengine/docs/java/taskqueue/overview#Task_Names)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T18:06:41.580

我用来确保后端在线并准备就绪的一个方便技巧是在你的工作 cron 之前 30 秒安排一个不做任何事情的 cron。no-op 请求失败或成功都没有关系，它会在重要的 cron 之前预热你的后端。

关于错误代码 503 的另一个说明 - 如果您处理不存在的后端实例编号，有时会发生这种情况。检查任务标头以确保后端主机是 0.yourbackend.yourapp.appspot.com，或者 # 是 < 分配的后端总数。

# html - 使菜单中的项目更宽

> ID：10372225
> 
> 赞同：0
> 
> 时间：2012-04-29T12:45:39.483
> 
> 标签：html, css, menu

这是我下面的当前菜单。

菜单 -

```
<ul id="menu"> <li class="one"><a href="http://www.domain.com">Dashboard</a></li>
<li><img src="images/menu-divide.png"></li>
<li class="two"><a href="<?php echo bp_loggedin_user_domain() ?>">Profile</a></li>
<li><img src="images/menu-divide.png"></li>
<li><?php bp_adminbar_notifications_menu() ?></li>  
<li><img src="images/menu-divide.png"></li>
<li class="three"><a href="<?php echo bp_loggedin_user_domain() ?>messages">Messages</a>
<li><img src="images/menu-divide.png"></li> 
<li class="five"><a href="<?php echo bp_loggedin_user_domain() ?>friends">Friends</a></li></ul> 
```

这是CSS -

```
ul#menu li {
    list-style: none;
    float: left;
    margin: 0 0px 0 0;
}

li.one a{
    border-top-left-radius: 3px 3px;
    border-bottom-left-radius: 3px 3px;
    border-right:none;
width:88px;
}
li.two a, li.three a {
}
li.five a{
    border-top-right-radius: 3px 3px;
    border-bottom-right-radius: 3px 3px;
    border-left:none;
}

ul#menu li a:link, ul#menu li a:visited {
    display: block;
    text-align: center;
    width: 88px;
    height: 53px;
    line-height: 53px;
    font-family: 'Montserrat', sans-serif;
    text-decoration: none;
    font-size: 13px;
    color: #05687b;
    letter-spacing: 1px;
    outline: none;
    float: left;
    background: #fff;

}
ul#menu li a:hover {
    background-color: #EDF7FA;
    color: #05687B;

} 
```

* * *

如何使菜单中的第一项更宽，例如 95 像素，我无法更改一个菜单项，因为它会改变一切。如果可以，请你帮助我。

我不能再写这个了，但是 stackoverflow 说我必须写，太好了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T12:19:20.593

您只需要对 css 进行一个小修正：

```
li.one a {
    border-top-left-radius: 3px 3px;
    border-bottom-left-radius: 3px 3px;
    border-right:none; padding:0px 100px 0px 100px;
    width:88px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T12:48:05.803

将这些行添加到您的代码中

```
#menu li:first-child {
    width: 95px;
} 
```

或者

因为您的第一个“li”元素附加了一个类“one”，所以您可以使用

```
#menu li.one{width:95px;} 
```

这是一个小提琴，第一个子元素的宽度设置为 150px，第二个元素的宽度设置为 30px，因此更容易注意到差异：http: [//jsfiddle.net/mymlyn/8sFSZ/1/](http://jsfiddle.net/mymlyn/8sFSZ/1/)

这就是它的工作原理：[http ://www.w3schools.com/cssref/sel_firstchild.asp](http://www.w3schools.com/cssref/sel_firstchild.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T12:51:19.263

非常简单，通过使用类引用`<a>`列表项内部的节点，`.one`我们可以更改整个项的宽度，而不管分配给它的任何其他规则`<a>`。

解决方案：

```
 #menu li.one a{
    width: 150px !important;
} 
```

*   [jsfiddle](http://jsfiddle.net/Rzdjd/)

**参考：**

[！重要的](http://www.w3.org/TR/CSS21/cascade.html#important-rules)

**笔记：**

尽管 !important 不是必需的，因为在代码末尾添加没有它的相同 css 也可以，但我觉得这避免了解决问题的进一步问题。

# visual-studio-2010 - 我通过 Nuget 添加了“Marcos Melis Filehelpers”，我收到了一个我不明白的警告，这是什么意思？

> ID：10372227
> 
> 赞同：3
> 
> 时间：2012-04-29T12:45:43.260
> 
> 标签：visual-studio-2010, resharper, filehelpers

基本上，我将 Marcos Meli 的 FileHelpers 添加到了我的 Visual Studio 项目中，并且收到以下警告：

> 由于间接引用了由程序集 'x:\y\packages\FileHelpers .2.0.0.0\lib\FileHelpers.ExcelStorage.dll'。考虑更改任一程序集上的“嵌入互操作类型”属性。

这是什么意思，我需要做什么（如果有的话，这只是一个警告，而不是一个错误）来修复它？我正在使用 resharper，我不确定这是 resharper 警告还是 Visual Studio 警告。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T10:15:14.287

来自[MSDN](http://msdn.microsoft.com/en-us/library/ff182188.aspx)：

> 您添加了对嵌入互操作类型属性设置为 True 的程序集 (assembly1) 的引用。这指示编译器从该程序集中嵌入互操作类型信息。但是，编译器无法嵌入来自该程序集的互操作类型信息，因为您引用的另一个程序集 (assembly2) 也引用了该程序集 (assembly1) 并且 Embed Interop Types 属性设置为 False。

要消除警告，请在解决方案资源管理器中找到 Microsoft.Office.Interop.Excel 参考。右键单击并查看属性。将有一个称为 Embed Interop 的，它将被设置为 true - 将其设置为 false，警告将消失。

# c# - 保护密码不被反编译

> ID：10372229
> 
> 赞同：2
> 
> 时间：2012-04-29T12:46:02.247
> 
> 标签：c#, .net, passwords, password-protection

我有通过预先确定的用户名和密码连接到 SqlServer 的程序。前任：

```
static void Main(string[] args)
{
    string UserName, Password;
    UserName = "Name";
    Password = "Pass";

    SqlConnection conn = new SqlConnection("...");
} 
```

如何保护密码不被反编译？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-29T13:55:34.677

一开始就不要这样做。该安全系统旨在保护*用户*免受试图让用户运行不良代码的*攻击者的攻击。*它并非旨在保护*您的程序*免受*其用户*的侵害，而这正是您正在尝试做的。

出于多种原因，将用户名和密码硬编码到可执行文件中是最糟糕的做法。*首先，因为它授予拥有您的程序*的人访问数据库的权限，而不是*授权的人*。其次，这意味着如果您需要更改用户名或密码，则需要重新发布程序。第三，如果密码真的泄露了，而且只需要泄露*一次*，会发生什么？您无法将访问权限仅限于攻击者。

一个更好的解决方案是要求每个用户都有自己的帐户。让他们输入密码。或者将数据库访问与其他一些身份和授权方案集成，如 Windows 身份验证或其他。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-29T13:06:15.153

如果此程序将始终在同一台计算机上运行，​​您可以将此信息放在配置文件的 connectionStrings 部分[并使用 DPAPI 对其进行加密](http://msdn.microsoft.com/en-us/library/ff647398.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T13:49:49.503

加密密码是一回事。如果你问我，在你的数据库上有一个专门的用户，只有一组必要的数据库对象权限是另一个，更重要的是。

# joomla - joomla模块位置

> ID：10372231
> 
> 赞同：0
> 
> 时间：2012-04-29T12:46:15.757
> 
> 标签：joomla, module, position

我有一个模板，可以让我有不同的列组合。我的问题是，如果我在主要内容的右侧有两列，一切都很好。但是，如果我只放 1 列，这 1 列继承了 2 列的宽度，不知道为什么会发生这种情况。

你可以在这里看到它的[布局，有 2 列和 maincontent](http://sharkpt.com)

现在，点击“Salas de poker menu”，看看有什么不同。在搜索文件并尝试自己修复后，我找到了这段代码，也许可以在这里提供帮助：

```
$right_column_middle_class = ' oneCol';

if($this->modules('right_left and right_right')) {
$right_column_middle_class = ' twoCol';
}
if($this->getParam("cwidth_position", '') == 'style') {
// right column
if($this->modules('right_left and right_right')) {
     $gkRightLeft = $this->getParam('right2_column_width', '50'). '%';
     $gkRightRight = (100 - $this->getParam('right2_column_width', '50')) . '%';
}
// all columns
$left_column = $this->modules('left_top + left_bottom + left_left + left_right');
$right_column = $this->modules('right_top + right_bottom + right_left + right_right');

if($left_column && $right_column) {
     $gkRight = $this->getParam('right_column_width', '20'). '%';
}  elseif ( $right_column ) {
     $gkRight = $this->getParam('right_column_width', '20'). '%';
}
}
?> 
```

对不起，我不太了解 php，而且英语也不是很好，我必须插入类似的东西，如果只有 right_right 位置，那么满是 50%？

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T16:42:48.217

正如代码所说`$this->getParam`，模板管理器中应该有一个选项，用于您要更改的区域的宽度。

# java - java静态变量和进程

> ID：10372232
> 
> 赞同：10
> 
> 时间：2012-04-29T12:46:16.753
> 
> 标签：java

如果我声明一个变量 static 并将这个类编译成一个可执行的 jar。如果我使用这样的批处理文件开始这个类：

```
java MyClass
java MyClass
java MyClass 
```

所有 3 个进程会共享相同的变量吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-29T12:47:56.837

不可以。静态变量特定于 JVM 实例。事实上，不仅如此 - 它特定于加载类的*类加载器*。因此，如果您创建了三个单独的类加载器，每个都负责加载`MyClass`（不仅仅是委托给某个共同的父级），它们每个都有一个单独的、独立的静态变量在`MyClass`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T12:49:47.347

静态资源是每个类加载器，因此，您的 3 个进程显然具有三个不同的类加载器，因此不会共享变量。

# jquery-masonry - 使用 jQuery Masonry 重叠问题和 Typekit

> ID：10372234
> 
> 赞同：4
> 
> 时间：2012-04-29T12:47:19.660
> 
> 标签：jquery-masonry, typekit

我正在使用[masonry](http://masonry.desandro.com/)和[typekit](https://typekit.com/)。因此，我希望布局[不会](http://masonry.desandro.com/docs/help.html#unloaded_media_and_overlapping)因图像加载而重叠，同时[在我们第一次加载页面时渲染 typekit 字体，而不会在 Flash 中显示默认字体](http://blog.typekit.com/2011/08/11/better-web-font-loading-with-javascript/)。

因此，我需要 javascript 代码来处理这两个问题：重叠砌体中的图像和正确加载 typekit 字体。

我的 javascript 文件中有以下代码可以完美地加载砌体，但我无法正确加载 typekit 字体。当网站第一次加载时，它会显示默认的 Times New Roman 字体，然后在闪烁后显示 typekit 字体。

如何修改我的 javascript 代码？

```
 //trigger masonry and typekit
  var $container = $('#wrapper');
  function triggerMasonry() {
    if ( !$container ) {
      return
    }
    $container.imagesLoaded(function(){
      $container.masonry({
        itemSelector : '.box',
        columnWidth : 240
      });
    });
  }

  $(function(){
    $container = $('#wrapper');
    triggerMasonry();
  });

  Typekit.load({
    active: triggerMasonry,
    inactive: triggerMasonry
  }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T05:40:04.427

感谢您的代码示例，它确实帮助了我，我只需删除 Typekit 提供的原始 Typekit 加载功能即可解决此问题：

```
<script type="text/javascript">try{Typekit.load();}catch(e){}</script> 
```

移除这个后，我的砖石工作完美无瑕。

# css - css 将一个固定的 div 居中，没有溢出

> ID：10372251
> 
> 赞同：0
> 
> 时间：2012-04-29T12:49:09.467
> 
> 标签：css

我正在尝试将`fixed`div 居中在没有`overflow`.

我似乎无法让溢出正常工作

## [这是我到目前为止所拥有的](http://jsfiddle.net/yqzdp/)

如您所见，我不希望整个顶部都是白色的，只是不是的部分`inner`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T12:52:54.037

如果你想，只有“#inner”是白色的，把你的CSS改成：

```
#inner {      
    display: inline-block;
    background-color:white;
} 
```

如果您只想 #inner 为黄色，则：

CSS

```
#inner {      
    background-color:white;
}
.yellow {
    background: yellow;
} 
```

HTML：

```
<div id="inner"><span class="yellow" >Loading</span></div> 
```

# jquery - jQuery 取消绑定插件事件

> ID：10372252
> 
> 赞同：0
> 
> 时间：2012-04-29T12:49:28.810
> 
> 标签：jquery, binding

我以前从来不需要“绑定”或“取消绑定”任何东西，所以我很困惑，因为我找不到与我想做的事情直接相关的例子。

[当您到达此处](http://blog.echoenduring.com/wp-content/uploads/demos/echo_ContainedStickyScroll/)页面的某个点时，有一个插件可以滚动 div - 您都见过这种事情，对吧？

但**我只希望插件在窗口达到一定宽度时触发**，然后如果窗口再次低于该宽度，则“取消触发”/取消绑定，例如......

（顺便说一下，#contact-form 是我正在滚动的容器，你猜对了，它包含一个联系表单）

```
function contactForm() {
    windowWidth = $(window).width();
    if (windowWidth >= 1024) {
        jQuery('#contact-form').containedStickyScroll();
    } else {
        jQuery('#contact-form').unbind(); // I don't want the plugin to fire
    }
};    

// Standard stuff...

$(document).ready(function() {
    contactForm();
});

$(window).resize(function() {   
    contactForm();
}); 
```

这个包含的粘性滚动功能如下所示：

```
 $.fn.containedStickyScroll = function( options ) {

    var defaults = {  
        oSelector : this.selector,
        unstick : true,
        easing: 'linear',
        duration: 500,
        queue: false,
        closeChar: '^',
        closeTop: 0,
        closeRight: 0  
    }  

    var options =  $.extend(defaults, options);

    if(options.unstick == true){  
        this.css('position','relative');
        this.append('<a class="scrollFixIt">' + options.closeChar + '</a>');
        jQuery(options.oSelector + ' .scrollFixIt').css('position','absolute');
        jQuery(options.oSelector + ' .scrollFixIt').css('top',options.closeTop + 'px');
        jQuery(options.oSelector + ' .scrollFixIt').css('right',options.closeTop + 'px');
        jQuery(options.oSelector + ' .scrollFixIt').css('cursor','pointer');
        jQuery(options.oSelector + ' .scrollFixIt').click(function() {
            getObject = options.oSelector;
            jQuery(getObject).animate({ top: "0px" },
                { queue: options.queue, easing: options.easing, duration: options.duration });
            jQuery(window).unbind();
            jQuery('.scrollFixIt').remove();
        });
    } 
    jQuery(window).scroll(function() {
        getObject = options.oSelector;
        if(jQuery(window).scrollTop() > (jQuery(getObject).parent().offset().top) &&
           (jQuery(getObject).parent().height() + jQuery(getObject).parent().position().top - 30) > (jQuery(window).scrollTop() + jQuery(getObject).height())){
            jQuery(getObject).animate({ top: (jQuery(window).scrollTop() - jQuery(getObject).parent().offset().top) + "px" }, 
            { queue: options.queue, easing: options.easing, duration: options.duration });
        }
        else if(jQuery(window).scrollTop() < (jQuery(getObject).parent().offset().top)){
            jQuery(getObject).animate({ top: "0px" },
            { queue: options.queue, easing: options.easing, duration: options.duration });
        }
    }); 
```

};

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:57:05.673

该插件`containedStickyScroll`写得不是很好，因为它没有删除处理程序。

这给您留下了 3 个选择：

1.  分叉插件。

    ```
    $.fn.containedStickyScroll = function( options ) {

       return this.each(function() {

       var self = this;

       function remove() {
            getObject = options.oSelector;
            jQuery(getObject).animate({ top: "0px" }, { queue: options.queue, easing: options.easing, duration: options.duration });
            jQuery(window).unbind("scroll", $self.data("containedStickyScroll").scrollHandler);
            jQuery('.scrollFixIt').remove();

            $(self).data("containedStickyScroll", false);
       }

        if (options == "remove") {
            remove();
            return;
        }

        // Make sure that this is only done once.
        if (this.data("containedStickyScroll"))
            return;

        var defaults = {  
            oSelector : this.selector,
            unstick : true,
            easing: 'linear',
            duration: 500,
            queue: false,
            closeChar: '^',
            closeTop: 0,
            closeRight: 0  
        }  

        var options =  $.extend(defaults, options);

        if(options.unstick == true){  
            $(this).css('position','relative');
            $(this).append('<a class="scrollFixIt">' + options.closeChar + '</a>');
            jQuery(options.oSelector + ' .scrollFixIt').css('position','absolute');
            jQuery(options.oSelector + ' .scrollFixIt').css('top',options.closeTop + 'px');
            jQuery(options.oSelector + ' .scrollFixIt').css('right',options.closeTop + 'px');
            jQuery(options.oSelector + ' .scrollFixIt').css('cursor','pointer');
            jQuery(options.oSelector + ' .scrollFixIt').click(remove);
        } 

        options.scrollHandler = function () {
            getObject = options.oSelector;
            if(jQuery(window).scrollTop() > (jQuery(getObject).parent().offset().top) &&
               (jQuery(getObject).parent().height() + jQuery(getObject).parent().position().top - 30) > (jQuery(window).scrollTop() + jQuery(getObject).height())){
                jQuery(getObject).animate({ top: (jQuery(window).scrollTop() - jQuery(getObject).parent().offset().top) + "px" }, 
                { queue: options.queue, easing: options.easing, duration: options.duration });
            }
            else if(jQuery(window).scrollTop() < (jQuery(getObject).parent().offset().top)){
                jQuery(getObject).animate({ top: "0px" },
                { queue: options.queue, easing: options.easing, duration: options.duration });
            }
        };

        jQuery(window).scroll(options.scrollHandler);

        $(this).data("containedStickyScroll", options);
    };}; 
    ```

    现在你可以这样做：

    ```
    (function($) {

        function contactForm() {
            windowWidth = $(window).width();
            if (windowWidth >= 1024)
                $('#contact-form').containedStickyScroll();
            else
                $('#contact-form').containedStickyScroll("remove");
        };    

        // Standard stuff...

        $(document).ready(contactForm);

        $(window).resize(contactForm);

    })(jQuery); 
    ```

    我还删除了从窗口对象中解除绑定所有事件处理程序的可怕做法，这比选项 2 还要糟糕。

2.  通过使用 unbind 删除所有事件处理程序（包括那些不是由该插件创建的事件处理程序）来解决此问题。

    不是一个真正的选择，因为滚动事件处理程序位于`window`对象上，其他插件等很可能使用相同的事件处理程序。

    ```
    $(window).unbind("scroll"); 
    ```

3.  重置 DOM 上的整个元素。

    ```
    (function() {

        var hasContactForm = false,
            $contactForm = $("#contact-form").clone();

        function contactForm() {
            windowWidth = $(window).width();
            if (!hasContactForm && windowWidth >= 1024) {
                hasContactForm = true;
                jQuery('#contact-form').containedStickyScroll();
            } else if (hasContactForm && windowWidth < 1024)
                hasContactForm = false;
                $('#contact-form').replaceWith($contactForm);
            }
        };    

        // Standard stuff...

        $(document).ready(contactForm);

        $(window).resize(contactForm);

    })(); 
    ```

    这也可能不是一个可行的解决方案，因为它还会重置任何用户输入。但是，您可以添加额外的逻辑来将用户输入携带到恢复的联系表单中。

考虑到每个选项的许多缺点，我强烈建议要么找到更好的插件，要么自己编写。否则选项 1 可能是最好的（如果可行的话）。

# ios - 从 UIViewController 中的 UITableView 中删除核心数据

> ID：10372254
> 
> 赞同：0
> 
> 时间：2012-04-29T12:49:42.563
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller

我在 UIViewController 中有一个 UITableView ，这样我就可以在表格下方有一个 UILabel 。这样做时，我在添加编辑/完成按钮时遇到了困难。我不能做传统的方式，所以我不得不使用以下想法做一个工作：

1）在viewdidload左上角创建编辑按钮：

```
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemEdit target:self action:@selector(editbutton)]; 
```

2）创建代码，以便在单击编辑按钮时，表格视图变为可编辑，并将标题更改为完成。然后点击完成后，它会回到说编辑。

```
-(IBAction)editbutton{
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(donebutton)];
[tableView setEditing:YES animated:YES];

}

-(IBAction)donebutton{
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemEdit target:self action:@selector(editbutton)];

[tableView setEditing:NO animated:YES];

} 
```

这部分一切正常。我只是为了完整性把它放进去。单击编辑按钮时，表格视图变为可编辑的，我可以单击完成并恢复正常。我的问题是单击删除按钮（单击一行旁边的红色减号按钮后）不会删除该行。我尝试了以下代码：

注意：1)context 在 .h 文件中被声明为：@property (nonatomic, retain) NSManagedObjectContext *context; 并在.m文件中合成。2）我在.h文件中声明了@property（非原子，保留）NSFetchedResultsController *fetchedResultsController，然后在.m文件中声明了@synthesize fetchedResultsController = _fetchedResultsController

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
if (editingStyle == UITableViewCellEditingStyleDelete) {

    // Delete the managed object for the given index path
    [context deleteObject:[_fetchedResultsController objectAtIndexPath:indexPath]];

    // Save the context.
    NSError *error = nil;
    if (![context save:&error]) {
        /*
         Replace this implementation with code to handle the error appropriately.

         abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
         */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }
}   
} 
```

**编辑：**

好的，我找到了一些解决方案。我使用以下代码删除了我的核心数据：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
if (editingStyle == UITableViewCellEditingStyleDelete) {
    // Delete the managed object for the given index path
    NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
    [context deleteObject:[self.fetchedResultsController objectAtIndexPath:indexPath]];

    // Save the context.
    NSError *error = nil;
    if (![context save:&error]) {
        /*
         Replace this implementation with code to handle the error appropriately.

         abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
         */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }
    [self fetchedresults];
    [self.tableView reloadData];

}   
} 
```

我的新问题是当我单击删除时。该行被删除，但仍保留在那里，空白行上的红色减号按钮。我仍然可以单击该行（通常编辑数据），但没有要加载的数据。

编辑2：

我忘了添加，为了让它工作，我添加了这个：

```
- (NSFetchedResultsController *)fetchedResultsController{

if (_fetchedResultsController != nil) {
    return _fetchedResultsController;
}

// Set up the fetched results controller.
// Create the fetch request for the entity.
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
// Edit the entity name as appropriate.
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Record" inManagedObjectContext:context];
[fetchRequest setEntity:entity];

// Set the batch size to a suitable number.
[fetchRequest setFetchBatchSize:20];

// Edit the sort key as appropriate.
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"activity" ascending:YES];
NSArray *sortDescriptors = [NSArray arrayWithObjects:sortDescriptor, nil];

[fetchRequest setSortDescriptors:sortDescriptors];

// Edit the section name key path and cache name if appropriate.
// nil for section name key path means "no sections".
NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:context sectionNameKeyPath:nil cacheName:@"Master"];
aFetchedResultsController.delegate = self;
self.fetchedResultsController = aFetchedResultsController;

NSError *error = nil;
if (![self.fetchedResultsController performFetch:&error]) {

    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}

return _fetchedResultsController;
} 
```

编辑 3：

这就是获取的结果的作用：

```
- (void)fetchedresults {

NSManagedObjectContext *moc = [self context];
NSEntityDescription *entityDescription = [NSEntityDescription
                                          entityForName:@"Record" inManagedObjectContext:moc];
NSFetchRequest *request = [[NSFetchRequest alloc] init];
[request setEntity:entityDescription];

NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc]
                                    initWithKey:@"activity" ascending:YES];
[request setSortDescriptors:[NSArray arrayWithObject:sortDescriptor]];

NSError *error = nil;
NSArray *array = [moc executeFetchRequest:request error:&error];
if (array == nil)
{
    // Deal with error...
}

float tot = [[array valueForKeyPath:@"@sum.cpdhours"] floatValue]; 
totalhours.text =  [NSString stringWithFormat:@"%.1f", tot];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:01:24.033

我认为您拥有的 managedObjectContext 属性实际上是您的 fetchedResultsController 上下文的父上下文，因此当您使用它删除实体时，fetchedResultsController 不会知道它应该重新获取和更新表格视图。尝试调用 [self.fetchedResultsController.managedObjectContext deleteItem:yourItem]。

也许这与我在 iPhone 上写的不完全一样，但你明白了。您是否还确保实现获取的结果控制器委托方法来更新您的表格视图？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T02:48:14.217

您可能需要重新缓存您的 NSResultFetchedController。在您的 NSFetchedResultController 初始化函数中，您将获取结果缓存到名为“Master”的缓存中。这可能解释了您遇到的行为。

在设置 NSFetchedResultController 时，您可以通过将缓存名称设置为 nil 来不使用任何缓存

```
NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:context sectionNameKeyPath:nil cacheName:nil]; 
```

或者您在删除 NSManagedObject 后立即删除缓存。

```
[NSFetchedResultController deleteCacheWithName:@"Master"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T15:46:13.487

你在用`NSFetchedResultsController`吗？如果没有，请尝试一下，您根本不用担心重新加载表。

* * *

此外，绝对不需要使用自定义按钮。坚持使用`.editButtonItem`and override `-setEditing:animated:`。

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{
    [super setEditing:editing animated:animated];
    [self.tableView setEditing:editing animated:animated];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-25T23:15:45.050

**斯威夫特**：在我的情况下，我想`tableView`在用户退出后完全擦除我的：

```
func clearData(){
    NSFetchedResultsController.deleteCacheWithName("MyCache")

    let indices = tableView.allIndices
    let moc = NSManagedObjectContext.MR_defaultContext()
    let fetchRequest = NSFetchRequest(entityName: "MyEntity")
    let deleteRequest = NSBatchDeleteRequest(fetchRequest: fetchRequest)
    saveMoc()

    do {
        try moc.persistentStoreCoordinator!.executeRequest(deleteRequest, withContext: moc)
        try fetchedResultsController.performFetch()
        tableView.beginUpdates()
        tableView.deleteRowsAtIndexPaths(indices, withRowAnimation: .Automatic)
        tableView.endUpdates()

    } catch let e as NSError {
        print(e)
    }
} 
```

我做了一个扩展来获取`NSIndexPath`我的 tableview 的所有 s：

```
extension UITableView{
    var allIndices: [NSIndexPath] {
        var indices = [NSIndexPath]()
        let sections = self.numberOfSections
        if sections > 0{
            for s in 0...sections - 1 {
                let rows = self.numberOfRowsInSection(s)
                if rows > 0{
                    for r in 0...rows - 1{
                        let index = NSIndexPath(forRow: r, inSection: s)
                        indices.append(index)
                    }
                }
            }
        }
        return indices
    }
} 
```

# asp.net-mvc-3 - NuGet Gallery 和 EntityFramework 抛出无法打开提供程序错误

> ID：10372256
> 
> 赞同：0
> 
> 时间：2012-04-29T12:49:50.637
> 
> 标签：asp.net-mvc-3, entity-framework, entity-framework-4, nuget

我们这里发生了一个奇怪的情况。[我们已经设置了 NuGet 库的本地安装（与支持http://Nuget.org](http://Nuget.org)的代码相同）。IIS 和 DB 在同一个盒子上。IIS 应用程序池已配置为在域用户下运行，该域用户也是机器上的本地管理员，并且具有“作为服务登录的权限”权限。现在当有人（成功登录后）尝试上传包时，上传包业务需要很长时间并最终抛出“底层提供程序无法打开”错误

```
 [TimeoutException: Transaction Timeout]

[TransactionException: The operation is not valid for the state of the transaction.]
   System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction) +53
   System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification) +241
   System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx) +273
   System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction) +150
   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +2647
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +89
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +6372062
   System.Data.SqlClient.SqlConnection.Open() +300
   System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure) +67

[EntityException: The underlying provider failed on Open.]
   System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure) +11109230
   System.Data.EntityClient.EntityConnection.Open() +142
   System.Data.Objects.ObjectContext.EnsureConnection() +97
   System.Data.Objects.ObjectContext.ExecuteStoreQueryInternal(String commandText, String entitySetName, MergeOption mergeOption, Object[] parameters) +109
   System.Data.Objects.ObjectContext.ExecuteStoreQuery(String commandText, Object[] parameters) +87
   System.Data.Entity.Internal.InternalContext.ExecuteSqlQuery(String sql, Object[] parameters) +118
   System.Data.Entity.Internal.InternalContext.ExecuteSqlQueryAsIEnumerable(String sql, Object[] parameters) +85
   System.Data.Entity.Internal.InternalContext.ExecuteSqlQuery(Type elementType, String sql, Object[] parameters) +241
   System.Data.Entity.Internal.InternalSqlNonSetQuery.GetEnumerator() +34
   System.Data.Entity.Internal.InternalSqlQuery`1.GetEnumerator() +28
   System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) +382
   System.Linq.Enumerable.ToList(IEnumerable`1 source) +80
   NuGetGallery.LuceneIndexingService.GetPackages(DbContext context, Nullable`1 dateTime) in C:\Source\DotNetDevEng.CitiNuGet\Gallery\DEV\Website\Infrastructure\Lucene\LuceneIndexingService.cs:55
   NuGetGallery.LuceneIndexingService.UpdateIndex() in C:\Source\DotNetDevEng.CitiNuGet\Gallery\DEV\Website\Infrastructure\Lucene\LuceneIndexingService.cs:32
   NuGetGallery.PackageService.CreatePackage(IPackage nugetPackage, User currentUser) in C:\Source\DotNetDevEng.CitiNuGet\Gallery\DEV\Website\Services\PackageService.cs:61
   NuGetGallery.PackagesController.VerifyPackage(Nullable`1 listed) in C:\Source\DotNetDevEng.CitiNuGet\Gallery\DEV\Website\Controllers\PackagesController.cs:503
   lambda_method(Closure , ControllerBase , Object[] ) +121
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +248
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +39
   System.Web.Mvc.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() +125
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +640
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +640
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +312
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +691
   System.Web.Mvc.Controller.ExecuteCore() +162
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +305
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +62
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +20
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375 
```

有趣的是，如果我将 IIS 应用程序池切换为在内置的“LocalSystem”帐户下运行，所有这些问题都会消失。我们要使用的域用户已临时设置为 NuGetGallery 数据库的数据库所有者，但它没有帮助。

谁能建议我们在这里可能缺少的设置/配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T08:52:54.817

这是由于代码中正在进行的环境事务。该代码依赖于 TransactionScope 类来管理各种事务，这些事务在嵌套时会陷入困境。如果有人尝试上传大小超过 10MB 的包，事情就会变得特别糟糕。一旦我们调整了盒子上的 MSDTC，应用程序就开始表现得稍微正常了。然而，它在自己的事务中仍然间歇性地陷入僵局，所以现在我们决定从包上传位中删除事务。

对于遇到此问题的其他人，我会推荐这两个中的任何一个

1.  注释掉任何对 TransactionScope 的引用

Services\PackageService.cs（方法 CreatePackage，第 48 行）

```
 using (var tx = new TransactionScope())
            {
                using (var stream = nugetPackage.GetStream())
                {
                    UpdateIsLatest(packageRegistration);
                    packageRegistrationRepo.CommitChanges();
                    packageFileSvc.SavePackageFile(package, stream);
                    tx.Complete();
                }
            } 
```

并在 Controller\PackageController.cs 方法 VerifyPackage(bool? Listed) 第 501 行

```
 using (var tx = new TransactionScope())
            {

                package = packageSvc.CreatePackage(nugetPackage, currentUser);
                packageSvc.PublishPackage(package.PackageRegistration.Id, package.Version);
                if (listed.HasValue && listed.Value == false)
                    packageSvc.MarkPackageUnlisted(package);
                uploadFileSvc.DeleteUploadFile(currentUser.Key);
                tx.Complete();
            } 
```

2 取消注释这些行并遵循此处提到的方法[http://blogs.msdn.com/b/dbrowne/archive/2010/05/21/using-new-transactionscope-considered-harmful.aspx](http://blogs.msdn.com/b/dbrowne/archive/2010/05/21/using-new-transactionscope-considered-harmful.aspx)

基本上创建一个可以与 SQL Server 一起工作的事务范围。在 InfraStructureFolder 中创建一个新类，将其命名为 TranscationUtils 并复制其中的代码。然后使用块看起来像

```
using (var tx = new TransactionUtils.CreateTransactionScope()){

//cod here
tx.Complete();
} 
```

但是，第二种方法可能会导致另一个服务器错误，这又与您可以为 TransactionScope 指定的默认超时有关。我们个人决定采用方法 1 并暂时注释掉所有 TransactionScope 引用。

# php - 将 php 帖子从 url 解释为变量

> ID：10372259
> 
> 赞同：1
> 
> 时间：2012-04-29T12:50:07.877
> 
> 标签：php, url, post

我对 PHP 很陌生（尽管我是在 iOS 的 object-c 编程中编程的，这就是我需要这个的原因）。我需要从帖子 url 中获取用户名和密码并进入变量，例如： [http](http://url.com/phpFile.php?username=TheUsernameToGetOut&password=ThePasswordToGetOut) ://url.com/phpFile.php?username=TheUsernameToGetOut&password=ThePasswordToGetOut 非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:09:50.323

可以通过超级全局数组找到url中发送的参数（ **Get parameters**`$_GET` ） 。例子：

```
$username = $_GET['username'];
$password = $_GET['password']; 
```

[$_GET 来自 php 手册](http://www.php.net/manual/en/reserved.variables.get.php)

如果参数是通过帖子（**发布表单**）发送的，那么它们将通过`$_POST`超级全局数组可用。例子：

```
$username = $_POST['username'];
$password = $_POST['password']; 
```

[$_POST 来自 php 手册](http://www.php.net/manual/en/reserved.variables.post.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:16:47.147

您永远不应该使用查询字符串来传递用户名和密码等敏感信息。

所以，应该只有[http://example.com/phpFile.php](http://example.com/phpFile.php)使用 POST 方法访问，因此你会得到你的变量

```
$username = $_POST['username'];
$password = $_POST['password']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T12:52:13.870

所有 GET 参数将存储在 $_GET 全局数组中，所有 POST 参数将存储在 $_POST

```
$username = $_POST['username']
$password = $_POST['password'] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T13:00:07.950

您需要从 url 获取用户名和密码。那么你为什么要使用 $_POST 它不起作用。使用 $_GET 或 $_REQUEST

```
$username = $_POST['username'];
$password = $_POST['password']; 
```

# css - 无法使徽标文本（字体）看起来类似于 firefox 的呈现方式（问题是 Internet Explorer）

> ID：10372264
> 
> 赞同：1
> 
> 时间：2012-04-29T12:51:07.333
> 
> 标签：css, cross-browser

我使用 Lobster 字体，它在两个 chrome/firefox/opera/safari 和 internet explorer 中看起来完全不同。

它在 IE8、7 中不起作用

您可以在此处查看示例：[dev.holiday.ge/xhtml](http://dev.holiday.ge/xhtml) -> 查看 firefox vs IE 中的红色徽标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:09:03.890

在：dev.holiday.ge/xhtml/all-ie-only.css

你有：

```
@font-face {
    font-family: 'Lobster';
    src: url('fonts/DroidSans.eot');
} 
```

这应该是这样的：

```
@font-face {
    font-family: 'Lobster';
    src: url('fonts/Lobster.eot');
    src: url('fonts/Lobster.eot?#iefix') format('embedded-opentype'); /* IE6-IE8 */
} 
```

如果你有 .eot

为了获得最佳字体兼容性，请使用以下语法：

```
@font-face {
font-family: 'MyWebFont';
src: url('webfont.eot'); /* IE9 Compat Modes */
src: url('webfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
     url('webfont.woff') format('woff'), /* Modern Browsers */
     url('webfont.ttf')  format('truetype'), /* Safari, Android, iOS */   
     url('webfont.svg#svgFontName') format('svg'); /* Legacy iOS */

} 
```

# android - 如何在孟加拉语中设置 android AlertDialog 项目？

> ID：10372268
> 
> 赞同：0
> 
> 时间：2012-04-29T12:51:50.880
> 
> 标签：android, localization, android-alertdialog, android-fonts

这是我的示例代码：

```
final String[] items = {"এক", "দুই", "তিন"};
builder = new AlertDialog.Builder(TestActivity.this);
builder.setItems(items,TestActivity.this); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T16:37:01.283

使用自定义视图创建您自己的对话框，例如使用其中包含自定义字体的 TextView。在您的情况下，在资产文件夹下的字体文件夹中放置一个免费的 Bangla ttf 字体（比如bangla.ttf），然后使用 setTypeface 将此字体附加到 TextView，如：

```
 textView.setTypeface(Typeface.createFromAsset(getAssets(), "fonts/bangla.ttf")); 
```

您可以在这些 TextView 上收听触摸事件以执行所需的操作。这是它在模拟器上的外观： ![在此处输入图像描述](../Images/630dfb682ab67308a405654e5fa73ee3.png)

但是复杂的字形总是显示为损坏的字符（即使你在设备上安装了字体），你可以在这里查看我的答案：[安装孟加拉字体](https://stackoverflow.com/questions/10369552/how-to-install-bangla-on-android-emulator/10369560#10369560)

如果您使用我用于软键盘的叠加技术，则显示复杂的字形图像替换是唯一可以用少量图像和非常快速的处理来完成的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:10:28.840

你写的方式实际上是正确的。但问题是安卓还没有正式支持孟加拉语。但是在一些自定义ROM中，集成了bangla。因此，孟加拉语将仅在那些安装了自定义 ROM（支持孟加拉语）的设备上显示。

所以我建议你使用字母的图像而不是使用实际的孟加拉字体。

# jquery - JQuery 刚刚创建的空 div 没有文档片段作为父级

> ID：10372271
> 
> 赞同：8
> 
> 时间：2012-04-29T12:52:07.190
> 
> 标签：jquery, documentfragment

在使用 jQuery 中创建新的 html 节点时

```
$('<some-node>some html code</some-node>'); 
```

在附加之前，它不会成为 DOM 的一部分。但是，这并不意味着该节点没有父节点。

如果创建的节点是空的，例如：

```
var myNewNode = $('<div>Hello</div>'); 
```

您可以检查父级：

```
myNewNode[0].parentNode; // Who is the parent? 
```

看到你得到

```
DocumentFragment 
```

结果。`DocumentFragment`是一些类似于 的对象`document`，但不是 DOM 树的一部分。

现在奇怪的事情来了。当您创建一个空节点时，例如

```
var myNewEmptyNode = $('<div></div>'); 
```

并尝试检查其内容

```
myNewEmptyNode[0].parentNode; // Who is now the parent? 
```

令人惊讶的是你得到

```
null 
```

我无法理解这种行为，并且在 jQuery 文档中一无所获。我在尝试调试为什么 javascriptMVC mxui 模态在空 div 上失败时发现了它。

我已经在 Chromium 和 Opera 中测试过这种行为，所以它似乎不是与浏览器相关的问题。

有人对此有解释吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-29T15:32:00.207

这是因为 jQuery`document.createElement`用于“快速”HTML 字符串，但`jQuery.buildFragment`用于所有其他（更“复杂”）HTML 字符串。`<div></div>`被认为是快速的，而`<div>a</div>`不是。

我设置了一个小提琴，所以你可以检查：http: [//jsfiddle.net/PzBSY/2/](http://jsfiddle.net/PzBSY/2/)。

“快速”是用正则表达式[定义的：](https://github.com/jquery/jquery/blob/master/src/core.js#L121)

```
var rsingleTag = /^<(\w+)\s*\/?>(?:<\/\1>)?$/; 
```

它传递空的 div 字符串，但不传递非空的 div 字符串。注意检查后的[`if`/`else`块](https://github.com/jquery/jquery/blob/master/src/core.js#L125)，这使得两个分支。

所以这基本上是因为 jQuery 使用非空 div 显式构建了一个文档片段，而它没有使用空 div（它只是使用`document.createElement("div")`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:17:10.843

这里`target`可能是任何有效的 jQuery 选择器。

only`$('<div></div>')`不会为您的 DOM 创建任何节点。它只是虚拟地创建它，但没有将它放置到文档中。要将其插入到您的 DOM 中，您需要使用诸如`append(), appendTo(), insert()`etc之类的方法。

```
$('target').append($('<div class="latest"></div>'));
$('div.latest').parent(); 
```

在这里，我插入了一个`div`with 类，并在附加它之后使用方法`latest`检索其父节点。`parent()`

# objective-c - cellForRowAtIndexPath 在每个部分下获取正确的数据

> ID：10372273
> 
> 赞同：0
> 
> 时间：2012-04-29T12:52:21.147
> 
> 标签：objective-c, ios, uitableview

我遇到了填充`UITableView`. 我有一个`NSMutableArray`with `customers`。它看起来像这样：

```
customer
    first letter="A"
    customer name="Adwars Inc."
customer
        first letter="A"
        customer name="Amman Co."
customer
        first letter="B"
        customer name="Building Inc."
customer
        first letter="C"
        customer name="Computer Co." 
```

所以我有一个对象客户，它将每个客户分开。而且我为每个对象都有一些键。在我的第二个 NSArray 中，我得到了我所有的第一个字母，它们出现在我的客户数据中。它看起来像这样：

```
A
B
C
D
G
J
M
S
Z 
```

我能够获得正确的部分计数和部分中的行，但是当我尝试填充我的表格视图时，它总是如下所示：

[截屏](http://files.beger.org/iOS%20Simulator%20Bildschirmfoto%2029.04.2012%2014.44.16.png)

这是我的代码

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *MyIdentifier = @"CustomerCell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:MyIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:MyIdentifier] autorelease];
}

for(int i = 0; i < [firstletters count]; i++)
{
    if (indexPath.section == i) {

        for(int count = 0 ;count < [customers count]; count++)
        {

        NSString *firstletter;
        NSString *key;

        key = [firstletters objectAtIndex:indexPath.section];
        firstletter = [[customers objectAtIndex:count] objectForKey: @"FirstLetter"];
            if ([key isEqualToString:firstletter]) {
                cell.textLabel.text = [[customers objectAtIndex:count] objectForKey: @"S_NAME1"];
                cell.detailTextLabel.text = [[customers objectAtIndex:count] objectForKey: @"s_town"];
            }

        }
    }
}

return cell;
} 
```

我该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T01:45:39.793

我知道您已经接受了一个答案，但我只是想提出另一种想法，即如何使用以不同方式结构化的数据来完成此操作。如果您有一个字典，其中键是客户姓名的第一个字母，值是第一个字母与键相同的客户对象，那么您不必进行任何循环（我不需要知道您是否仍在解决方案中这样做）。我做了一个示例项目（看看这是否可行），以这种方式构造数据，除了我的“对象”只是公司的名称而不是客户对象。在我的表视图控制器中，我有：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    self.companyDict = [NSMutableDictionary dictionary];
    NSArray *aArray = [NSArray arrayWithObjects:@"Abercrombie & Fitch",@"Altera",@"Agilent",@"Allelix",@"Abbott Laboratories", nil];
    NSArray *cArray = [NSArray arrayWithObjects:@"CocaCola",@"Continental",@"ConocoPhillips", nil];
    NSArray *mArray = [NSArray arrayWithObjects:@"Myriad Genetics",@"Myrexis",@"Microsoft",@"McDonald's", nil];
    NSArray *nArray = [NSArray arrayWithObjects:@"Nokia",@"NPS Pharmaceuticals",@"Norelco",@"Netflix",@"Nextel",@"Navistar International", nil];
    [self.companyDict setValue:aArray forKey:@"A"];
    [self.companyDict setValue:cArray forKey:@"C"];
    [self.companyDict setValue:mArray forKey:@"M"];
    [self.companyDict setValue:nArray forKey:@"N"];
    self.keys = [[self.companyDict allKeys] sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return self.keys.count;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [[self.companyDict valueForKey:[self.keys objectAtIndex:section]]count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *cellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    }
    NSArray *theArray = [self.companyDict valueForKey:[self.keys objectAtIndex:indexPath.section]];
    cell.textLabel.text = [theArray objectAtIndex:indexPath.row];
    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:39:56.917

对于每个单元格，您都在遍历所有客户，为首字母与当前部分匹配的*每个*客户重复设置（和重置）textLabel 和 detailTextLabel（但您没有考虑该客户在该部分中的索引是否匹配当前 indexPath.row 与否）。这意味着在您的代码中，每个单元格都将包含最后一个客户的 textLabel 和 detailTextLabel，其首字母与当前部分的首字母匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T13:50:43.557

试试这个[TableKit](https://github.com/onegray/UITableKit)库。这种情况下，解决方案将干净优雅：

```
NSMutableDictionary* sectionMap = [NSMutableDictionary dictionaryWithCapacity:30];
for(NSDictionary* c in customers) {
    NSString* firstLetter = [c objectForKey:@"FirstLetter"];
    NSString* name = [c objectForKey:@"S_NAME1"];
    NSString* town = [c objectForKey:@"s_town"];

    TKSection* section = [sectionMap objectForKey:firstLetter];
    if(!section) {
        section = [TKSection sectionWithCells:nil];
        section.headerTitle = firstLetter;
        [sectionMap setObject:section forKey:firstLetter];
    }

    TKCell* cell = [TKStaticCell cellWithStyle:UITableViewCellStyleSubtitle text:name detailText:town];
    [section addCell:cell];
}

self.sections = [sectionMap allValues]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T13:10:53.780

试试这个（复制并粘贴此代码）：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [[UITableViewCell alloc] init];
    cell = nil;
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                       reuseIdentifier:@"CustomerCell"] autorelease];

        cell.textLabel.text = nil;
        cell.detailTextLabel.text = nil;       
    }

    for(int i = 0; i < [firstletters count]; i++) {
        if (indexPath.section == i) {
            for(int count = 0 ;count < [customers count]; count++) {
                cell.textLabel.text = nil;
                cell.detailTextLabel.text = nil;

                NSString *firstletter = nil;
                NSString *key = nil;

                key = [firstletters objectAtIndex:indexPath.section];
                firstletter = [[customers objectAtIndex:count] objectForKey: @"FirstLetter"];

                if ([key isEqualToString:firstletter]) {
                    cell.textLabel.text = [[customers objectAtIndex:count] objectForKey: @"S_NAME1"];
                    cell.detailTextLabel.text = [[customers objectAtIndex:count] objectForKey: @"s_town"];
                }
            }
        }
    }

    return cell;
} 
```

# c# - 将接口实现到类中时如何创建自动实现的属性？

> ID：10372274
> 
> 赞同：14
> 
> 时间：2012-04-29T12:52:30.627
> 
> 标签：c#, class, properties, interface

当我第一次在类中实现接口时，我希望 resharper 6 或 Visual Studio 2010 将我的属性实现为自动实现的属性，而不是放入 throw new NonImplementedException(); 的默认值。我怎样才能做到这一点？例如：

```
public interface IEmployee
{
// want this to stay just like this when  implemented into class
ID { get; set; }
}

public class Employee : IEmployee
{
// I do not want the throw new NonImplemented exception
// I want it to just appear as an auto implemented property
// as I defined it in the interface
public int ID
        {
            get
            {
                throw new NotImplementedException();
            }
            set
            {
                throw new NotImplementedException();
            }
        }
} 
```

因为这种情况一直在发生，我发现自己不得不不断重构并手动删除那些抛出新的 UnImplimented() 异常并手动使属性自动实现......很痛苦！毕竟，我在我的界面中将它定义为一个自动实现的属性。

非常感谢任何帮助或建议！谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T14:40:09.227

Note: your R# keyboard shortcuts may differ, I am using the Resharper 2.x keyboard schema.

If you declare the interface on the class and then use `Alt`+`Enter` and select “Implement members”:

![Selecting “Implement mebers”"></p>

<p>Then you will get the default implementation, which happens to be throwing <code>NotImplementedException</code>, unless you change that.</p>

<p>But if you ignore the suggested course of action and instead use <kbd>Alt</kbd>+<kbd>Insert</kbd> to open the Generate menu, you can select “Missing members”:</p>

<p><img src=](../Images/03360a60bae72c238e1e1fda0b9e8341.png)

That will do exactly what you want:

```
class Employee : IEmployee
{
    public int Id { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-29T12:55:58.020

> 毕竟，我在我的界面中将它定义为一个自动实现的属性。

不，你没有。您将其声明为*没有实现*的属性。这就是你在接口中所能做的一切*：*你只是说实现接口的类必须提供这些属性的具体实现。

就我个人而言，我会警惕接口中有太多*可写*属性 - 如果这是你发现“一直发生”的事情，我想知道你是否正在使用可能更适合抽象类的接口。

就您的确切问题而言：我不知道是否可以更改 VS 或 R# 为接口提供的默认实现 - 但老实说，无论如何我都会拒绝进行这些更改。

编辑：在 R# 选项“代码生成”下，您可以选择抛出异常、返回默认值或提供不可编译的代码。这*可能*会做你想做的事。试一试，但我仍然强烈建议您在走这条路之前仔细考虑一下。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-29T12:57:02.627

接口并不意味着指定方法将如何实现，因此无法使用接口绕过它。一种解决方案是使用自动实现的属性创建一个抽象基类并继承该类，而不是直接实现接口。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-12T13:21:34.850

这是我在 VS2015 中找到的快速解决方法。将您的类标记为抽象，然后抽象地实现接口。这会为您添加自动属性，然后您只需将文件中的“abstract”替换为“”。然后你可以从你的类中删除 abstract 关键字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-27T06:38:46.393

对于 VS2015，我使用查找和替换宏作为解决方法：

```
Find:
(\r|\n| |\t)+\{(\r|\n| |\t)+get(\r|\n| |\t)+\{(\r|\n| |\t)+throw(\r|\n| |\t)+new(\r|\n| |\t)+NotImplementedException\(\);(\r|\n| |\t)+\}(\r|\n| |\t)+set(\r|\n| |\t)+\{(\r|\n| |\t)+throw(\r|\n| |\t)+new(\r|\n| |\t)+NotImplementedException\(\);(\r|\n| |\t)+\}(\r|\n| |\t)+\}

replace:
 {get;set;} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-29T13:01:44.910

除了乔恩的回答...如果您真的想更改 Visual Studio 的这种（开箱即用）行为并在实现接口时创建自动属性，您可以尝试以下之一...

1.  使用 T4 生成代码 - [http://msdn.microsoft.com/en-us/library/bb126445.aspx](http://msdn.microsoft.com/en-us/library/bb126445.aspx)

2.  使用 VS SDK 为 Visual Studio 编写一个自定义插件来实现这一点

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-30T18:35:48.737

它与这个问题并不完全相关，但是，当您在接口中具有多个此类属性时，一种不同的方法，而不是接口，您可以拥有一个类并将该类称为主类中的返回类型。您可以创建一个类并在主类中引用该类。例子

```
public class Asset
{
    public int AssetTrackingID { get; set; }

    public Category AssetCategoryInfo { get; set; }

    public Manufacturer AssetManufacturerInfo { get; set; }

    public ManufacturerModel AssetModelInfo { get; set; }

    public Status AssetStatusInfo { get; set; }

    public EmployeeDetails AssetEmployeeInfo { get; set; }

    public string AssetNumber { get; set; }

    public string SerialNumber { get; set; }

    public DateTime? AcquiredDate { get; set; } 
```

}

# uml - 如何识别源自 UML 对象图中的数组属性的关联？

> ID：10372279
> 
> 赞同：1
> 
> 时间：2012-04-29T12:53:07.467
> 
> 标签：uml, object-diagram

就像您从图中看到的那样，它具有三个对象。Object_1 有一个可变大小的有序数组，其中按该顺序引用对象 2 和 3，这正是我想用图表说明的内容。我的问题是，当我浏览 UML 标准规范以获取执行此类操作的符号时，我没有看到任何内容。

如何修复此图，使其成为符合 UML 标准的有效对象图？或者甚至有可能吗？UML 是否指定了一种表达方式？

![uml 对象图](../Images/356a0a0c2a8527fa534b8f8ed97c7446.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T08:07:54.097

没有说明什么是对象图（您显示的）（请参阅[此处](http://www.uml-diagrams.org/class-diagrams-overview.html#object-diagram)的完整说明）。所以无论你做什么都是对的（或错的:-)）

# vb.net - vb.net：关于捕获 webbrowser 图片链接

> ID：10372281
> 
> 赞同：1
> 
> 时间：2012-04-29T12:53:26.867
> 
> 标签：vb.net

关于捕获 webbrowser 图片链接。
我的网络浏览器只有一张图片。
如何将此图像链接捕获到 TextBox 中？
我在 wenBrowser1 属性中设置了网站链接

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim PageElements As HtmlElementCollection = WebBrowser1.Document.GetElementsByTagName("img")
        For Each CurElement As HtmlElement In PageElements
            TextBox1.Text = TextBox1.Text & CurElement.GetAttribute("src") & Environment.NewLine
        Next
    End Sub

    Private Sub WebBrowser1_DocumentCompleted(ByVal sender As System.Object, ByVal e As System.Windows.Forms.WebBrowserDocumentCompletedEventArgs) Handles WebBrowser1.DocumentCompleted

    End Sub

    Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T16:04:44.420

穿上`WebBrowser1_DocumentCompleted`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:10:41.963

我想这就是你需要的吗？

添加一个`Webbrowser`控件、`2 button`控件和一个`textbox`控件，并将 textbox 属性设置为`multiline`.

当您第一次单击 button1 时，您将导航到您的一些网站。

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        WebBrowser1.Navigate("http://www.microsoft.com")
End Sub 
```

当您单击 button2 时，该网络链接中的所有图像都将添加到您的文本框中

```
Private Sub Button2_Click(sender As Object, e As System.EventArgs) Handles Button2.Click
    Dim PageElements As HtmlElementCollection = WebBrowser1.Document.GetElementsByTagName("img")
    For Each CurElement As HtmlElement In PageElements
        TextBox1.Text = TextBox1.Text & CurElement.GetAttribute("src") & Environment.NewLine
    Next
End Sub 
```

这是输出： ![在此处输入图像描述](../Images/77e26f87778ea1db4cb8ea291aaa4c18.png)

# c++ - CRT 如何调用 main ，具有不同的参数

> ID：10372286
> 
> 赞同：6
> 
> 时间：2012-04-29T12:54:05.453
> 
> 标签：c++, c

我们可以用几种方式编写 main 函数，

1.  `int main()`
2.  `int main(int argc,char *argv[])`
3.  `int main(int argc,char *argv[],char * environment)`

运行时 CRT 函数如何知道应该调用哪个 main。请注意这里，我不是在询问是否支持 Unicode。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T13:27:49.330

接受的答案不正确，CRT 中没有特殊代码来识别 main() 声明的类型。

由于 cdecl 调用约定，它可以工作。它指定参数从右到左压入堆栈，并且调用者在*调用*后清理堆栈。因此 CRT 只需将*所有*参数传递给 main() 并在 main() 返回时再次弹出它们。您唯一需要做的就是在 main() 函数声明中以正确的顺序指定参数。argc 参数必须是第一个，它是堆栈顶部的参数。argv 必须是第二个，等等。省略一个参数没有区别，只要你也省略所有后面的参数。

这也是 printf() 函数可以工作的原因，它具有可变数量的参数。*一个*参数在一个已知的位置，第一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-29T13:01:11.797

通常，编译器/链接器需要识别`main`您正在使用的特定形式，然后包含代码以将其从系统启动函数适应您的 C 或 C++`main`函数。

确实，特定平台上的特定编译器可以在不这样做的情况下逃脱，使用 Hans 在他的回答中描述的方法。但是，并非所有平台都使用堆栈来传递参数，并且可以编写具有不兼容参数列表的符合 C 和 C++ 实现。对于这种情况，编译器/链接器需要确定`main`调用哪种形式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T14:55:52.793

嗯。似乎当前接受的答案（表明先前接受的答案不正确）本身就是不正确的。这个问题的标签表明它适用于 C++ 和 C，所以我会坚持 C++ 规范，而不是 C99。不管所有其他解释或论据如何，这个问题的主要答案是“main() 以实现定义的方式被特殊对待”。我相信大卫的答案在技术上比汉斯的更正确，但我会更详细地解释它......

main() 函数是一个有趣的函数，由编译器和链接器处理，其行为与其他函数不匹配。Hans 是正确的，CRT 中没有特殊代码来识别 main() 的不同签名，但他断言它“由于 cdecl 调用约定而工作”仅适用于特定平台，尤其是 Visual Studio。CRT 中没有识别 main() 不同签名的特殊代码的真正原因是没有必要。尽管这有点麻烦，但链接器的工作是在链接时将启动代码绑定到 main() 中，而不是 CRT 在启动时的工作。

根据 C++ 规范（参见第 3.6 节“开始和终止”），main() 函数的大部分处理方式是实现定义的。很可能大多数实现的编译器隐含地处理 main() 类似于外部“C”链接的东西，使 main() 处于非修饰状态，因此无论其函数原型如何，其链接器符号都是相同的。或者，实现的链接器可以足够聪明地扫描符号表，寻找任何其修饰名称解析为某种形式的“[int|void] main(...)”（请注意，作为返回类型的 void 是本身是特定于实现的东西，因为规范本身说 main() 的返回类型必须是'int'）。一旦在可用符号中找到这样的函数，链接器就可以简单地使用启动代码引用“main()”的那个函数，所以确切的符号名称不一定要匹配任何特定的东西；它甚至可以是 wmain() 或其他，只要链接器知道要查找哪些变体，或者编译器为所有变体赋予相同的符号名称即可。

另外需要注意的关键是规范说 main() 可能不会被重载，因此链接器不应该在不同形式的 main() 的多个用户实现之间“挑选”。如果它找到多个，即使参数列表不匹配，这也是重复符号错误（或其他类似错误）。尽管所有实现“应”允许两者

```
int main() { /* ... */ } 
```

和

```
int main(int argc, char* argv[]) { /* ... */ } 
```

它们还被允许允许其他参数列表，包括您显示的包含环境字符串数组指针的版本，以及在任何给定实现中有意义的任何其他变体。

正如 Hans 所指出的，Visual Studio 编译器的 cdecl 调用约定（以及许多其他编译器的调用约定）提供了一个框架，其中调用者可以设置调用环境（即堆栈，或 ABI 定义的寄存器，或两者的某种组合）这样可以传递可变数量的参数，当被调用者返回时，调用者负责清理（将使用的参数空间从堆栈中弹出，或者在寄存器的情况下，不需要做任何清理）。这种设置很适合启动代码传递比可能需要更多的参数，并且用户的 main() 实现可以自由使用或不使用任何这些参数，就像许多平台对各种形式的处理的情况一样您在问题中列出的 main() 。然而，这不是编译器+链接器可以实现此目标的唯一方法：相反，链接器可以根据您的 main() 定义在不同版本的启动代码之间进行选择。这样做将允许使用 cdecl caller-cleanup 模型不可能的各种 main() 参数列表。而且由于所有这些都是实现定义的，因此根据 C++ 规范它是合法的，只要编译器+链接器至少支持上面显示的两种组合（`int main()`和`int main(int, char**)`）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-29T21:54:08.220

C 99 标准（5.1.2.2.1 程序启动）说，实现*不*强制main() 函数的原型，并且程序可以将其定义为：

1) int main(void);

2) int main(int argc, char *argv[]);

或以语义上等同于 2) 的方式，例如

2') int main(int argc, char **argv);

或以其他实现定义的方式。它不*要求*原型：

3) int main(int argc, char *argv[],char * envp[]);

将具有预期的行为 - 尽管该原型必须编译，因为*任何*原型都必须编译。3) 受到 GCC 和 Microsoft C 以及其他编译器的支持。（注意提问者的第三个原型有 char *envp 而不是 char *envp[]，无论是偶然还是因为他/她有其他编译器）。

GCC 和 Microsoft C 都将使用任何原型编译 main()，因为它们应该这样做。它们解析您实际指定的原型并生成汇编语言以正确方式使用参数（如果有）。因此，例如，它们每个都会为程序生成预期的行为：

```
#include <stdio.h>

void main(double d, char c)
{
    printf("%lf\n",d);
    putchar(c);
} 
```

如果您能找到一种将 double 和 char 直接传递给程序的方法，而不是通过字符串数组。

这些观察结果可以通过启用实验程序的汇编语言列表来验证。

编译器的标准 CRT 如何允许我们调用生成的 main() 实现的问题与如何将 main() 定义给编译器的问题不同。

对于 GCC 和 MS C，main() 可以以任何我们喜欢的方式定义。然而，在每种情况下，实现的标准 CRT，AFIK，仅支持将参数传递给 main()，而不是按照 3)。所以 1) - 2') 通过忽略多余的参数也将具有预期的行为，除了提供我们自己的非标准运行时之外，我们没有其他选择。

Hans Passant 的回答似乎偶然地误导了*argc*告诉函数以与 printf() 的第一个参数相同的方式消耗多少后续参数。如果*argc*存在，它仅表示作为第二个参数*argv*传递的数组中的元素数。它不指示传递给 main() 的参数数量。GCC 和 MS C 都通过解析您编写的原型来确定期望的参数 - 本质上是编译器对任何函数所做的事情，*除了*那些被定义为采用可变数量的参数的函数，如 printf()。

main() 不接受可变数量的参数。它接受您在定义中指定的参数，并且通常编译器的标准 CRT 假定它们是 (int, char *[], char *[])。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-29T13:15:18.207

首先， `main`函数在 GCC 中被专门处理（例如GCC 4.7 的源代码树的`main_identifier_node`in 文件）`gcc/c-family/c-common.c`

C11 和 C++11 标准对此有特定的措辞和规范。

然后，C 调用 ABI 约定通常使得额外的参数不会造成太大的伤害。

所以你可以把它想象成语言规范和编译器都有关于“重载”的特定内容`main`。

我什至认为这`main`可能不是一个普通的功能。我相信标准中的某些词——我现在没有——可能会被理解为禁止获取其地址或递归`main`。

在实践中，`main`由一些汇编代码调用，这些代码编译成`crt*.o`由`gcc`. 用于`gcc -v`了解更多正在发生的事情。

# python - makefile() 和 send() recv() Python 的区别

> ID：10372287
> 
> 赞同：4
> 
> 时间：2012-04-29T12:54:06.123
> 
> 标签：python, sockets

使用 Python 套接字时使用 makefile() 的目的是什么？

我可以让一个程序只使用 Python 上的 send() 和 recv() 函数。但我读到最好使用 makefile() 方法来缓冲数据。我不明白这种关系和差异......有什么帮助吗？

谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T13:01:07.700

`makefile`如果你觉得 Python 的文件接口方便，就可以使用。例如，您可以使用诸如`readlines`on 套接字之类的方法（使用时您必须手动实现它`recv`）。如果在套接字上发送文本数据，这会更方便，但是 YMMV。

# php - PHP没有显示值，但值肯定被传递

> ID：10372291
> 
> 赞同：1
> 
> 时间：2012-04-29T12:55:14.100
> 
> 标签：php, mysql, forms

用户从选择框中选择一个值，然后通过表单将其传递到另一个页面，该页面应显示该选择的 mysql 记录。这没有显示任何结果，但是该值肯定会被传递，因为它可以被回显。

```
<?php
    include("top.php");

    $db = getConnection();

    $eventID = $_POST['eventID'];

    echo $eventID;
    $queryEvent = $db->query("SELECT * FROM projectEvent WHERE eventID = '$eventID'");
    $queryEvent->setFetchMode(PDO::FETCH_ASSOC);
    $record = $queryEvent->fetchALL();
?>
<form name="form1" id="form1" method="post" action="deleteOpen.php">
<p> are you sure you want to delete the following Open Day? </p>
    <table width="200" cellpadding="0" cellspacing="0">
                <tr>
                <th scope="row">eventID</th>
                <td><?php echo $record -> eventID; ?></td>
                </tr>
                <tr>    
                <th scope="row">propertyID</th>
                <td><?php echo $record -> propertyID; ?></td>
                </tr>
                <tr>
                <th scope="row">eventDate</th>
                <td><?php echo $record -> eventDate; ?></td>
                </tr>
                <tr>
                <th scope="row">eventTime</th>
                <td><?php echo $record -> eventTime; ?></td>
                </tr>
                <tr>
                <th scope="row">eventDescription</th>
                <td><?php echo $record -> eventDescription; ?></td>
                </tr>
    </table> 
```

谁能建议为什么表中没有显示这些值？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T13:08:51.087

1.  要显示数据，您不应该使用 POST 方法，而是使用 GET 方法。
2.  要么使用 PDO::quote 转义你的值，要么使用准备好的语句来准备/执行而不是 query()
3.  如果您使用的是 ASSOC 模式 - 为什么要将它们作为对象属性访问？
4.  此外，您实际上有一个嵌套数组，但将其作为单个对象访问。如果你不需要一个数组 - 不要使用 fetchAll() 然后
5.  总是`error_reporting(E_ALL);`在你的脚本中看到这些愚蠢的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:02:03.580

您可以像这样单独连接变量：

```
$queryEvent = $db->query("SELECT * FROM projectEvent WHERE eventID = ".$eventID.")"; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-29T12:57:50.913

通常我会做一些不同的方法。它可能不会指出问题，但我认为它会解决它。我通常不在引号内使用变量，但请在下面尝试。

```
$sql = sprintf("SELECT * FROM projectEvent WHERE eventID = '%s'", $eventID);
$queryEvent = $db->query($sql); 
```

# list - Sencha 2.0 动态更改标题工具栏

> ID：10372292
> 
> 赞同：2
> 
> 时间：2012-04-29T12:55:36.283
> 
> 标签：list, sencha-touch, extjs, toolbar, sencha-touch-2

我会动态更改列表标题栏的标题。这是我`app.js`可以查看我的应用程序的地方（请参阅 var list，其中有我要更改的工具栏项和标题）

我怎样才能做到这一点？谢谢。

```
 var mainForm ;
var mainFormPanel={};

var myStore = Ext.create('Ext.data.Store', {
    storeId: 'MyStore',
    fields: ['txt']
}); // create()

var list= Ext.create('Ext.List', {
    fullscreen: true,
    store: 'MyStore',
    itemTpl: '{txt}',
    items: [{
        xtype: 'titlebar',
        docked: 'top',
        title:'change dinamically this title!!!!'
    }] // items (list)
}); // create()

Ext.application({
    glossOnIcon: false,
    autoMaximize: false,
    icon: {
        57: 'lib/sencha-touch/resources/icons/icon.png',
        72: 'lib/sencha-touch/resources/icons/icon@72.png',
        114: 'lib/sencha-touch/resources/icons/icon@2x.png',
        144: 'lib/sencha-touch/resources/icons/icon@114.png'
    },
    phoneStartupScreen: 'lib/sencha-touch/resources/loading/Homescreen.jpg',
    tabletStartupScreen: 'lib/sencha-touch/resources/loading/Homescreen~ipad.jpg',

    requires: [
               'Ext.tab.Panel',
               'Ext.form.*',
               'Ext.field.*',
               'Ext.Button',
               'Ext.data.Store'
               ],

               launch: function() {
                   mainForm = Ext.create('Ext.form.Panel', {
                       xtype:'formpanel',
                       items: [
                               {
                                   xtype: 'textfield',
                                   name : 'distance',
                                   label: 'Distance'
                               },
                               {
                                   xtype: 'textfield',
                                   name : 'quantity',
                                   label: 'Quantity'
                               }
                               ]
                   });

                   mainFormPanel={            
                           xtype: 'toolbar',
                           docked: 'bottom',
                           layout: {
                               pack: 'center'
                           },
                           items: [
                                   {
                                       xtype: 'button',
                                       text: 'Set Data',
                                       handler: function() {
                                           mainForm.setValues({
                                               distance: '300',
                                               quantity: '25'
                                           })
                                       }
                                   },
                                   {
                                       xtype: 'button',
                                       text: 'Get Data',
                                       handler: function() {
                                           Ext.Msg.alert('Form Values', JSON.stringify(mainForm.getValues(), null, 2));
                                       }
                                   },
                                   {
                                       xtype: 'button',
                                       text: 'Clear Data',
                                       handler: function() {
                                           mainForm.reset();
                                       }
                                   }
                                   ]
                   };

                Ext.Viewport.add({
                       xtype: 'tabpanel',
                       items: [
                               {
                                   //each item in a tabpanel requires the title configuration. this is displayed
                                   //on the tab for this item
                                   title: '1-tab',
                                   layout:'fit',
                                   //next we give it some simple html
                                   items: [mainForm,mainFormPanel],
                                   //then a custom cls so we can style it
                                   cls: 'card1'
                               },
                               {
                                   //title
                                   title: '2-tab',
                                   layout:'fit',
                                   items: [list],
                                   cls: 'card2'
                               },
                               {
                                   //title
                                   title: '3-tabs',
                                   //the items html
                                   items: {
                                       html: 'mia auto',
                                       centered: true
                                   },
                                   //custom cls
                                   cls: 'card3'
                               }
                               ]
                   });
               }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:42:22.020

`Ext.List`组件的超类是`Ext.DataView.`，不是`Ext.Panel`。

因此，不可能直接在`Ext.List`组件内添加/停靠任何项目。

因此，我建议您将`Ext.List`组件包装在`Ext.Panel`.

像这样做，

```
var myStore = Ext.create('Ext.data.Store', {
        storeId: 'MyStore',
        fields: ['txt']
}); // create()

 var listpanel = new Ext.Panel({
        layout: 'fit',   // important to make layout as 'fit'
        items: [
            {
                xtype: 'titlebar',
                id: 'myTitle',
                docked: 'top',
                title: 'Before Change title',
                items: [
                    {
                        xtype:'button',
                        text:'Change Title',
                        align:'right',
                        listeners : {
                            tap : function() {
                                Ext.getCmp('myTitle').setTitle('After Title Change');
                            }
                        }
                    }
                ]
            },
            {
              //Definition of the list
              xtype: 'list',
              itemTpl: '{txt}',
              store: myStore,
            }]
      });

    ....
    ....
       {
           title: '2-tab',
           layout:'fit',
           items: [listpanel],
           cls: 'card2'
       },
    ....
    .... 
```

样本输出：-

**更改标题之前**

![在此处输入图像描述](../Images/131a1eec365d84717ac7abed1fdb54f5.png)

**更改标题后**

![在此处输入图像描述](../Images/ff343bf029f11bbb2821077750a95147.png)

* * *

仅供参考，如果您查看 Sencha Docs 中的类，您将在方法中`Ext.List`看到以下代码，`initComponent()`

```
if (Ext.isDefined(this.dockedItems)) {
        console.warn("List: List is not a Panel anymore so you can't dock items to it. Please put this list inside a Panel with layout 'fit'");
    } 
```

# android - Android：如何创建一个接收器来监听系统设置的任何变化？

> ID：10372295
> 
> 赞同：5
> 
> 时间：2012-04-29T12:56:17.760
> 
> 标签：android, settings, listener, receiver

我正在尝试创建一个广播接收器来侦听系统设置的任何更改以更新 UI。

我以这种方式在我的android清单上的intent-filter中编写了一系列动作：

```
<receiver android:name=".Receiver_OnSettingChange">
    <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
            <action android:name="android.net.wifi.WIFI_STATE_CHANGED" />
            <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
            <action android:name="android.intent.action.AIRPLANE_MODE" />
            <action android:name="android.media.RINGER_MODE_CHANGED" />
            <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
            <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />
            <action android:name="android.bluetooth.adapter.action.STATE_CHANGED" />
            <action android:name="android.intent.action.BATTERY_CHANGED" />
            <action android:name="android.net.wifi.WIFI_AP_STATE_CHANGED" />
            <action android:name="android.net.conn.BACKGROUND_DATA_SETTING_CHANGED" />
            <action android:name="com.android.internal.telephony.MOBILE_DATA_CHANGED" />
            <action android:name="com.android.settings.GPS_STATUS_CHANGED" />
            <action android:name="android.nfc.action.ADAPTER_STATE_CHANGE" />
            <action android:name="android.location.PROVIDERS_CHANGED" />
            <action android:name="android.intent.action.USER_PRESENT" />
            <action android:name="com.android.sync.SYNC_CONN_STATUS_CHANGED" />                 
            <action android:name="android.intent.action.MEDIA_SCANNER_FINISHED" />
            <action android:name="android.intent.action.MEDIA_SCANNER_STARTED" />
            <action android:name="android.intent.action.MEDIA_UNMOUNTED" />
            <action android:name="android.intent.action.MEDIA_EJECT" />
            <action android:name="android.intent.action.MEDIA_MOUNTED" />
    </intent-filter>
    </receiver> 
```

但我需要听每一个系统设置的变化（比如“自动旋转”从开到关，反之亦然，亮度从自动到关或其他任何东西）。

如果有我可以在清单中写的动作对我来说更好。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T18:24:33.893

确实有一种方法可以做到这一点，但它不是广播接收器。您需要使用观察者。我在[音频控制](http://www.mobiletrialware.com/audiocontrol)中这样做，它几乎完美无缺。偶尔会发生一些我不会接受的改变，但这种情况很少见。这是一个链接，其中提供了有关如何实施的一些详细信息。

[设置观察者](https://stackoverflow.com/questions/6896746/android-is-there-a-broadcast-action-for-volume-changes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:05:21.133

> 但我需要听每一个系统设置的变化（比如“自动旋转”从开到关，反之亦然，亮度从自动到关或其他任何东西）。

大多数没有`Intent`与他们相关的广播，抱歉。

# php - 将 cURL 标头信息拆分为数组

> ID：10372298
> 
> 赞同：4
> 
> 时间：2012-04-29T12:56:46.593
> 
> 标签：php, curl

考虑以下 PHP cURL 命令：

```
$url = 'http://bit.ly/faV1vd';

$_h = curl_init();
curl_setopt($_h, CURLOPT_HEADER, 1);
curl_setopt($_h, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($_h, CURLOPT_HTTPGET, 1);
curl_setopt($_h, CURLOPT_URL, $url);
curl_setopt($_h, CURLOPT_DNS_USE_GLOBAL_CACHE, false );
curl_setopt($_h, CURLOPT_DNS_CACHE_TIMEOUT, 2 );

$return = curl_exec($_h); 
```

这将返回：

```
HTTP/1.1 301 Moved
Server: nginx
Date: Sun, 29 Apr 2012 12:48:07 GMT
Content-Type: text/html; charset=utf-8
Connection: keep-alive
Set-Cookie: _bit=4f9d3887-00215-020af-2f1cf10a;domain=.bit.ly;expires=Fri Oct 26 12:48:07 2012;path=/; HttpOnly
Cache-control: private; max-age=90
Location: http://www.macroaxis.com/invest/market/VZ--Sat-Feb-26-06-16-35-CST-2011?utm_source=twitterfeed&utm_medium=twitter
MIME-Version: 1.0
Content-Length: 209 
```

我想把头信息拆分成一个数组，如下

```
[Status] => HTTP/1.1 301 Moved,
[Server] => nginx,
[Date] => Sun, 29 Apr 2012 12:48:07 GMT,
...
[Content-Length] => 209 
```

所以： - 第一行（HTTP/1.1 301 Moved）应该是 [Status] 的值 - 所有其他标头信息应该被拆分`:`

我没有成功拆分标题信息：

```
explode("\r\n\r\n", $return);
explode("\r\n", $return); 
```

这不会将标头拆分为数组（`:`按预期进一步拆分等。我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-17T09:28:05.533

[Altaf Hussain](https://stackoverflow.com/a/10372461/2889735)的回答很好，但不支持标头响应包含`':'`. 即`X-URL: http://something.com`。在这种情况下，`$myarray`将只包含`('X-URL' => 'http')`

这可以通过添加[`limit`](http://php.net/manual/en/function.explode.php)参数并将其设置为来解决`2`。此外，冒号后面应该有一个空格。因此，修复错误的完整解决方案是：

```
$myarray=array();
$data=explode("\n",$return);

$myarray['status']=$data[0];

array_shift($data);

foreach($data as $part){
$middle=explode(": ",$part,2);
$myarray[trim($middle[0])] = trim($middle[1]);
}

print_r($myarray); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-29T13:26:49.777

使用它来将您的标题拆分为一个数组

```
$myarray = array();
$data = explode("\n",$return);

$myarray['status'] = $data[0];

array_shift($data);

foreach($data as $part){
     $middle = explode(":",$part);
     $myarray[trim($middle[0])] = trim($middle[1]);
}

print_r($myarray); 
```

`curl_setopt($_h, CURLOPT_NOBODY, 1);` 如果您只需要返回标题，也可以使用 。

更多信息可以在这里找到

[http://altafphp.blogspot.com/2012/04/get-http-headers-of-any-site-using-curl.html](http://altafphp.blogspot.com/2012/04/get-http-headers-of-any-site-using-curl.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-20T12:01:17.177

cURL 已经支持用于解析标头的回调函数。

> CURLOPT_HEADERFUNCTION ：接受两个参数的回调。第一个是 cURL 资源，第二个是包含要写入的标头数据的字符串。标头数据必须由此回调写入。返回写入的字节数。

```
function handle_headers($curl, $header_line) 
{
    list($name, $value) = explode(": ", $header_line, 2);
    //do something with name/value...
    return strlen($header_line);
}

curl_setopt($curl, CURLOPT_HEADERFUNCTION, "handle_headers"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T16:06:07.597

你也可以把它分成**最多2个**

```
explode("\r\n\r\n",$result,2); 
```

如果你想获取实际的 url，记得设置 followlocation 和 max redirect

```
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, TRUE);
curl_setopt($curl, CURLOPT_MAXREDIRS, 5); 
```

# sql-server - Adventureworks 项目/解决方案和数据库不同步

> ID：10372300
> 
> 赞同：2
> 
> 时间：2012-04-29T12:57:08.777
> 
> 标签：sql-server, ssas

我正在努力处理 Adventureworks 多维数据集，尽管如下所述，我能够将数据库拉入 sql server 并检索项目，**但我还没有找到数据库和项目/解决方案的单一下载源。**
我已经概述了我已采取的三个步骤，在每一点上都有可能我遗漏了一些东西——总结一下——是否可以在下面的步骤 1 中从链接 1 获取项目/解决方案，是否可以从链接 2 中获取数据库下面的 2，或者考虑到数据库和项目不同步，需要对多维数据集结构添加什么来纠正步骤 3 中的错误。重新步骤 3 我注意到似乎缺少 2 个维度，dim time 和 dim事实销售摘要，但是像微软一样添加它们可能会很棘手，并且在将它们添加到项目之后可能会有更多）？ **第 1 步：**我已从以下链接检索并成功附加 AdventureWorksDW 数据库（有人知道如何从该链接获取项目吗？）链接 1 **：** [http://msftdbprodsamples.codeplex.com/releases/view/59211](http://msftdbprodsamples.codeplex.com/releases/view/59211) **第 2 步**：我已经从以下链接中检索了 Adventureworks 解决方案（有谁知道如何从该链接获取数据库？.. 虽然我有打开文件流和数据库似乎已创建我不知道如何将它们放入我的 sql server 实例..sigh） **链接 2：** [http ://social.msdn.microsoft.com/Forums/en-US/sqlanalysisservices/thread/ 87fc44d2-80ac-49aa-a9c1-c3302935aafc/](http://social.msdn.microsoft.com/Forums/en-US/sqlanalysisservices/thread/87fc44d2-80ac-49aa-a9c1-c3302935aafc/) 但是，即使我打开了文件流，并且我看到创建脚本正在运行，但数据库并没有在我的 sql server 实例中创建（这有什么特别的技巧吗？你怎么将脚本指向正确的 SQL 服务器连接？或者是否有附加步骤？） **第 3 步：**当我在步骤 1 和 2 中从源处理多维数据集时，出现以下错误：OLE DB 错误：OLE DB 或 ODBC 错误：无效的对象名称“dbo.DimTime”。42S02\. OLAP 存储引擎中的错误：在处理 ID 为“Dim Time”、名称为“Date”的维度时发生错误。OLAP 存储引擎中的错误：处理“Adventure Works DW”数据库中“日期”维度的“会计年度”属性时发生错误。OLE DB 错误：OLE DB 或 ODBC 错误：操作已取消；HY008。OLAP 存储引擎中的错误：在处理 ID 为“Fact Sales Summary”、名称为“Sales Channel”的维度时发生错误。OLAP 存储引擎中的错误：“销售渠道”发生错误

# mongodb - grails 应用程序中的 mondogb-morphia 问题，无法将 Map 正确存储在数据库中

> ID：10372301
> 
> 赞同：1
> 
> 时间：2012-04-29T12:57:13.317
> 
> 标签：mongodb, grails, groovy, map, morphia

我在 grails (2.0.3) 应用程序中使用插件 mongodb-morphia (0.7.8) 并尝试使用 Map 类型的问题。我想在我的数据库中存储一个 Map 类型的地图，但是当我把它放在我的 groovy 文件中时：

```
class ServiceInfo {

    String name

    Map<String,?> args

    Date dateCreated // autoset by plugin
    Date lastUpdated // autoset by plugin

    static constraints = {
        name nullable:false
    }
} 
```

我收到以下错误：

> 2012-04-29 14:39:43,876 [pool-2-thread-3] 错误 MongodbMorphiaGrailsPlugin - 处理 mongodb 域 Artefact > fr.unice.i3s.modalis.yourcast.provider.groovy.ServiceInfo 时出错：未知类型...漂亮糟糕......呼救，挥手......是的！

我试图在我的文件中指定 Map ：

```
Map args 
```

在这种情况下，我会收到以下简单警告：

> 信息：MapKeyDifferentFromString 抱怨 fr.unice.i3s.modalis.yourcast.provider.groovy.ServiceInfo.args ：地图不能由对象（地图）键入；使用受支持的参数化类型（地图）

当我尝试保存一个对象时，属性 args 在数据库中被简单地省略了。有关信息，我的对象具有这种表示形式：

```
def icalReader= new ServiceInfo(name:"IcalReader", args:['uri':DEFAULT_URL, 'path':"fr.unice.i3s.modalis.yourcast.sources.calendar.icalreader/"])
icalReader.save() 
```

最后，如果我只是说 args 是一个 List：

```
List args 
```

我将我的对象更改为只包含一个地图的列表，我只是有一个警告：

> 注意：多值字段“fr.unice.i3s.modalis.yourcast.provider.groovy.ServiceInfo.args”是一个可能的异构集合。无法验证。请声明一个有效类型以消除此警告。无效的

但一切正常，我的地​​图已正确存储在数据库中：

> {“_id”：ObjectId（“4f9be39f0364bf4002cd48ad”），“名称”：“IcalReader”，“args”：[{“路径”：“fr.unice.i3s.modalis.yourcast.sources.calendar.icalreader/”，“ uri" : "http://localhost:8080/" } ], "dateCreated" : ISODate("2012-04-28T12:33:35.838Z"), "lastUpdated" : ISODate("2012-04-28T12:33 :35.838Z") }

那么在定义我的地图时有什么我忘记的吗？我的服务确实有效，但我不喜欢“将地图封装在列表中以对其进行序列化”之类的技巧；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:13:54.010

我不知道地图，但你可以使用嵌入式数据模型吗？

```
class ServiceInfo {
...
@Embedded
MyArgs args
...
} 
```

* * *

```
class MyArgs {
String key
String value
} 
```

# c++ - 无法将函数定义与模板化类中的现有定义匹配

> ID：10372302
> 
> 赞同：0
> 
> 时间：2012-04-29T12:57:17.310
> 
> 标签：c++, templates, operator-overloading

如果之前有人问过这样的问题，我很抱歉，但无论我搜索多少，我都找不到（有类似的问题，但似乎没有一个对我有用）。

我正在编写一个模板类，一切正常，除非我尝试重载 operator+。我尝试为不同的参数重载 operator+ 两次，但编译器看不到其中一个定义并给出错误。这是代码：

Worker.h（我以前的作业之一，在这里实现了这个问题，因为它更容易看到）：

```
#ifndef _WORKER_H
#define _WORKER_H

#include <string>
#include "Project.h"

using namespace std;

template <class T>
class Worker {

public:
  Worker(const string &, Project &);

  void Work(const int &);
  const Worker & Worker::operator+(const int &); //Problem
  const Worker & Worker::operator+(const string &); //Problem

  string getName() const;
  int getTime() const;
private:
  string myName; //The name of the worker
  Project & myProject; 
  int myTime; //Variable to keep track of how much the worker worked.
};

#include "Worker.cpp"
#endif 
```

以及 Worker.cpp 的相关部分：

```
template <class T>
const Worker<T> & Worker<T>::operator+(const int & add)
{
  cout << add;
  return *this;
}

template <class T>
const Worker<T> & Worker<T>::operator+(const string & add) 
{
  cout << add;
  return *this;
} 
```

`+`运算符现在没有做任何事情，问题是编译器只看到第一个声明的函数（在这种情况下，带有参数 int）。这些功能似乎也没有问题，因为如果我只尝试重载一次，它们都可以单独工作。我也可以在非模板类中使用它们（进行必要的更改）。

我认为这很简单，但是由于我是模板新手，所以我无法弄清楚问题所在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:06:36.667

您的方法存在一些与模板无关的问题。

**首先**，您的运算符仅适用于一种操作顺序：`Worker<T> + int`，而**不是** `int + Worker<T>`

**其次**，通常您希望返回一个新的 Worker 实例，而不是`this`通过引用返回，因为`A+B`不应该修改`A`or `B`。

所以你可以做的是为不同的排序定义非成员运算符：

```
template <typename T>
Worker<T> operator+(int i, const Worker<T>& t) { }

template <typename T>
Worker<T> operator+(const Worker<T>& t, int i) { } 
```

等等。

请注意，对于*应该*影响对象状态的运算符，例如 等`+=`，`*=`通常的方法是使用成员运算符并通过引用返回，因为在这些情况下它非常有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:06:12.190

这里有 2 件事，其中 1 是你的问题

成员函数的返回类型不受类是模板的影响，因此返回的声明和`operator+`返回`Worker`的定义`Worker<T>`是不同的。在类定义中，它们应该是：

```
const Worker<T> & operator+(const int &); //Problem
const Worker<T> & operator+(const string &); //Problem 
```

在上面的代码中也改变的另一件事是你不需要`Worker::`类声明中的范围（）

# javascript - 有什么比 HTML5 localStorage 更大的吗？

> ID：10372308
> 
> 赞同：4
> 
> 时间：2012-04-29T12:58:14.377
> 
> 标签：javascript, database, html, local-storage, session-storage

我想在客户端存储本地数据以加快我的网络应用程序的页面加载。我尝试使用 HTML5 的 localStorage，但不幸的是它对于我的需要来说太小了。有没有更大的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T10:41:09.627

您有多种选择，但浏览器支持不同，因此您需要通过在各种浏览器机制之上的额外层将差异从浏览器中抽象出来

几乎所有东西都支持本地存储，通常存储 5-10MB。大多数（但不是所有）桌面浏览器都支持 IndexedDB，并且可以存储更多数据。多少取决于浏览器，但预计 50MB 或无限制。如果您针对 iOS 和 Android 浏览器，WebSQL 是唯一的选择，因为它们不支持 indexeddb。您最多可以在那里存储 50MB。

为您完成所有这些的优雅抽象层有很多：查看[此线程中的答案。](https://stackoverflow.com/questions/6116053/javascript-library-to-bridge-indexeddb-and-websql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:34:27.033

如果数据本质上是静态的，您可能能够在 .js 文件中缓存一些数据或使用 jsonp 而不是本地存储。

否则，您现在唯一的选择是本地存储，存储限制为 5 - 10 兆字节，具体取决于浏览器。您可以通过使用以下方式压缩数据来获得更多收益：[https ://github.com/olle/lz77-kit/blob/master/src/main/js/lz77.js](https://github.com/olle/lz77-kit/blob/master/src/main/js/lz77.js)

# javascript - 如何用动态类型语言描述函数参数？

> ID：10372312
> 
> 赞同：4
> 
> 时间：2012-04-29T12:58:57.420
> 
> 标签：javascript, python, arguments, dynamic-typing, code-documentation

我的问题更面向 Python，但也可能与 JavaScript 或其他脚本语言有关。

我通常使用静态类型语言（Java、C++、ActionScript，...）进行开发。

我喜欢不时使用 Python，有时我也需要使用 JavaScript。这些是动态类型语言。这没什么错，但我通常很头疼要了解函数或方法中需要哪些参数。即使它是我自己的带有一些文档字符串的代码也会发生！也许是因为眼睛必须在函数定义之外的地方寻找其他地方。

当然，答案应该在文档中。但有时根本不清楚，或者由于使用了鸭子类型，文档本身可能很难编写*（“第一个参数是一个函数，它必须有一个 quack() 方法和一个 feathers(arg) 方法，其中 arg是一个字符串"* )。我非常想要的是语言本身内部的一种参数描述（即使它是可选的，就像在 ActionScript 中一样）。

明确描述函数/方法的参数的最佳实践是什么？

如果创建一个特殊的装饰器（如果使用 Python），其目的是在我们使用它时检查数据的类型（但因为它将在运行时而不是在编写时使用，那么重点是什么）呢？

你认为这不应该是一个问题吗？比当前的文档字符串做得更多会使开发人员感到困惑，或者我的思想过于面向静态类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:03:43.290

我不了解 Javascript，但 Python`function annotations`从第 3 版开始具有可选功能，如下所示：

```
def haul(item: Haulable, *vargs: PackAnimal) -> Distance: 
```

或者：

```
def compile(source: "something compilable",
            filename: "where the compilable thing comes from",
            mode: "is this a single statement or a suite?"): 
```

请参阅[PEP](http://www.python.org/dev/peps/pep-3107/)了解更多信息。

它们可以在运行时访问，甚至可以用于`type checking`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:06:28.110

为什么鸭式打字会使文档难以编写？

每当你编写一个函数时，你都会假设参数是特定类型或确认特定接口......所以只需记录一下即可。

例如，如果你有一个`swim_in_pond(duck)`方法，就不需要记录“`duck`应该有`quack()`, `swim()`, 和方法”——在大多数情况下，说“是一个实例”就`dive()`足够了。或者，如果记录“ -like”接口对您很重要，我发现声明一个用作文档的基类很有帮助：`duck``Duck``Duck`

```
class DuckBase(object):
    def quack(self):
        """ Makes the duck quack. """

    def swim(self):
        """ Swims around.
            Assumes the duck is already in water.
            Updates the duck's position. """

    def dive(self):
        """ Dives either as deep as possible (either until the duck runs out of
            air, or it hits the bottom of the pond). """ 
```

# jsf - 带有 OSGi 的 Java EE 6 应用程序

> ID：10372314
> 
> 赞同：3
> 
> 时间：2012-04-29T12:59:18.333
> 
> 标签：jsf, ejb, osgi, java-ee-6

我开发了一个基于 JSF、EJB 和 JPA 的应用程序。带有 ManagedBeans 和 Facelets 的 JSF 方面`war-module`位于`ejb-module`. 这不是什么大事，比如说 20 个页面、15 个 ManagedBeans 以及很少的实体和 EJB。这是我学士论文的一部分，其中一个要求是我需要使这个系统模块化，我应该使用这种`OSGi`技术。

所以我对 OSGi 的了解几乎为零，经过几个小时的谷歌搜索，我没有取得任何进展。所以我想问你，你会如何把这个应用程序分成模块？你能给我指出一些描述这种过程的教程或文章吗？因为我没有找到任何适合我的场景的东西。

它是专门用于管理大学学生项目的应用程序。所以有两个角色，老师和学生。他们都可以创建项目，老师确认，学生提交。

这是我的项目结构

![ejb模块](../Images/35f48e19a2a8a798443c30cbb11f9604.png) ![战争模块](../Images/9c951f50b691b6c9929bc41109362397.png)

我当然不希望你给我一个完整的解决方案，但如果能给我一些作为开始的东西，我会很高兴。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:39:34.367

简而言之，OSGI 模块以捆绑包的形式提供，可以在不干扰应用程序其他部分的情况下启动、停止、修改这些模块。

当您将场景分解为捆绑包时，您将拥有：

1.  服务（在您的情况下为 EJB）
2.  ServiceLocator（在这种情况下将由像您的 jsf 这样的客户端使用，这可以是您客户端本身的一部分）
3.  客户（在您的情况下为 JSF）

    一世。根据项目的复杂性，您还可以将您的 web 分成单独的包，如视图、dao 等，但在您的情况下，我认为这不是必需的。

4.  根据您在应用程序中可能拥有的公共代码，您可能还拥有一个公共捆绑包。

Java EE 和 OSGI 的一个很好的起点是 @Oracle [Wiki](https://wikis.oracle.com/display/GlassFish/BlogsGfOsgi)

# android - 在 Android 中，当我为列表视图行设置不同的颜色时，自定义适配器代码将不起作用？

> ID：10372315
> 
> 赞同：1
> 
> 时间：2012-04-29T12:59:18.427
> 
> 标签：android, listview

我有一个小问题要为我的列表视图行设置颜色。我使用下面的代码（用于适配器）为我的 listiview 设置颜色。我将两种颜色放入阵列中，效果很好。现在我想在我的列表中添加 5 种颜色。但是这段代码不起作用。我怎样才能做到这一点。

**Custom_List_Adapter.java**

```
private class Custom_List_Adapterextends BaseAdapter {
//Defining the background color of rows. The row will alternate between green light and green dark.
private int[] colors = new int[] { 0xAAf6ffc8, 0xAA538d00, 0xAAf6ddc8, 0xAA238d00, 0xAA788d00 };
private LayoutInflater mInflater;

//The variable that will hold our text data to be tied to list.
private String[] data;

public Custom_List_Adapter(Context context, String[] items) {
    mInflater = LayoutInflater.from(context);
    this.data = items;
}

@Override
public int getCount() {
    return data.length;
}

@Override
public Object getItem(int position) {
    return position;
}

@Override
public long getItemId(int position) {
    return position;
}

//A view to hold each row in the list
@Override
public View getView(int position, View convertView, ViewGroup parent) {

// A ViewHolder keeps references to children views to avoid unneccessary calls
// to findViewById() on each row.
ViewHolder holder;

if (convertView == null) {
    convertView = mInflater.inflate(R.layout.row, null);

    holder = new ViewHolder();
    holder.text = (TextView) convertView.findViewById(R.id.headline);
    convertView.setTag(holder);
} else {
    holder = (ViewHolder) convertView.getTag();
}
    // Bind the data efficiently with the holder.
    holder.text.setText(data[position]);

    //Set the background color depending of  odd/even colorPos result
    int colorPos = position % colors.length;
    convertView.setBackgroundColor(colors[colorPos]);

   return convertView;
}
} 
```

# zend-framework - Zend Framework 有 CamelCase 控制器名称的问题？

> ID：10372318
> 
> 赞同：1
> 
> 时间：2012-04-29T12:59:47.917
> 
> 标签：zend-framework, .htaccess, routes, zend-route, camelcasing

我有一个 Zend Framework 应用程序，我一直在我的本地机器上工作，我已经将它部署到服务器上，但是遇到了 .htaccess 问题，因为**一些但不是所有路由都失败并出现“ *Page Not Found* ”**。很奇怪，我无法访问某些控制器。

我的 .htaccess 是：

```
RewriteBase /~user/path/to/app/public/

RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

此错误不会出现在本地机器上，只会出现在服务器上。我能看到的唯一对于在服务器上出现“*未找到页面*”错误的控制器来说是常见的，那就是控制器名称是驼峰式的。

有效的控制器：CustomerController、InvoiceController、StockController。失败的控制器：SuppliersStockController、StockTypesController。

如果我尝试执行“www.route/to/app/stock-types/”或“/stock.types/”之类的操作，我会收到“*应用程序错误*”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T07:49:59.367

您将看到区分大小写的文件系统的效果。

当您访问 时，ZF 将在 Mac OS X 和 Windows 等不区分大小写的系统上`/stocktypes/index`寻找并取得成功。`StocktypesController.php`但是在 Linux 上，它会失败。

如果您转到`/stock-types/index`，那么 ZF 将`StockTypesController.php`在 Linux 上查找并找到它。

如果 ZF 找到 CamelCased 控制器名称，那么它将查找带有连字符的视图文件夹。

# jpa - @AdditionalCriteria 与 @OneToOne 结合使用会产生 QueryException

> ID：10372323
> 
> 赞同：0
> 
> 时间：2012-04-29T13:00:16.683
> 
> 标签：jpa, eclipselink, multi-tenant, one-to-one

我正在尝试创建一个 RESTful 服务。对于多租户，我正在应用 @AdditionalCriteria 注释。但是，当我使用 @OneToOne 注释加入实体时，会引发以下异常：

```
Exception [EclipseLink-6174] (Eclipse Persistence Services - 2.3.0.v20110604-
r9504): org.eclipse.persistence.exceptions.QueryException
Exception Description: No value was provided for the session property 
[SECURITYID]. This exception is possible when using additional criteria or 
tenant discriminator columns without specifying the associated contextual 
property. These properties must be set through Entity Manager, Entity Manager 
Factory or persistence unit properties. If using native EclipseLink, these 
properties should be set directly on the session.
Query: ReadObjectQuery(name="readObject" referenceClass=Addresses 
sql="SELECT id, city, country, postalcode, province, security_id, street 
FROM addresses WHERE ((id = ?) AND (security_id = ?))") 
```

我在 EntityManager 级别设置属性 [SECURITYID] 并且没有加入一切正常。但是，当我使用 @OneToOne 加入实体时，我发现该属性不存在。我没有足够的经验来确定这是由于我做错了什么还是这是一个错误。对我来说，它看起来像是一个不同的 EntityManager 用于获取加入的实体。但我猜是因为我缺乏知识。我还尝试在 EntityManagerFactory 级别设置属性，但无济于事。

这是我的设置。实体：

```
@Entity
@AdditionalCriteria("this.securityId=:SECURITYID")
@Table(name = "tasks", catalog = "catalog", schema = "schema")
@XmlRootElement
@NamedQueries(
{
  @NamedQuery(name = "Tasks.findAll", query = "SELECT t FROM Tasks t")

})
public class Tasks implements Serializable
{
...
  @OneToOne(fetch=FetchType.EAGER)
  @JoinColumn(name="service_address_id")
  private Addresses serviceAddress;

...
} 
```

RESTFacade 类

```
@Stateless
@Path("tasks")
public class TasksFacadeREST extends AbstractFacade<Tasks>
{
  @PersistenceContext(unitName = "UnitName")
  private EntityManager em;

...

  @java.lang.Override
  protected EntityManager getEntityManager()
  {
    // Temp! REMOVE WHEN DONE
    sessionId = "123456789";

    Identifier.setIdentity(em,sessionId);
    em.setProperty("SECURITYID",Identifier.securityId);
    em.setProperty("USERID",Identifier.userId);

    return em;
  } 
```

谢谢和Rgds，M

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:45:14.843

我的猜测是这与缓存有关。

通常，租户属性将在 EntityManagerFactory 上设置，而不是在 EntityManager 上。这意味着每个租户都有不同的 EntityManagerFactory。您还可以在您的 persistence.xml 中定义租户属性，并为每个租户提供不同的持久性单元。

如果需要为每个 EntityManager 设置租户，则需要禁用共享缓存，或者将缓存模式设置为受保护。

[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Advanced_JPA_Development/Single-Table_Multi-Tenancy#Setting_Properties_and_Caching_Scope](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Advanced_JPA_Development/Single-Table_Multi-Tenancy#Setting_Properties_and_Caching_Scope)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-03T11:40:13.963

作为参考，要禁用的属性是`eclipselink.cache.shared.default`

```
<property name="eclipselink.cache.shared.default" value="false"/> 
```

# c# - 寻找在调用属性的 get 时触发的事件

> ID：10372327
> 
> 赞同：1
> 
> 时间：2012-04-29T13:00:57.277
> 
> 标签：c#, winforms, propertygrid

我在我的应用程序中使用 PropertyGrid。我需要在运行时根据自定义*数据*标准更改某些属性的可见性和只读性。

虽然我没有找到简单的东西并准备好，但我找到了一种解决方法，方法是在运行时更改`ReadOnlyAttribute`and`BrowsableAttribute` 属性，如下所示：

```
protected void SetBrowsable(string propertyName, bool value)
{
    PropertyDescriptor property = TypeDescriptor.GetProperties(GetType())[propertyName];
    BrowsableAttribute att = (BrowsableAttribute)property.Attributes[typeof(BrowsableAttribute)];
    FieldInfo cat = att.GetType().GetField("browsable", BindingFlags.NonPublic | BindingFlags.Instance);

    if (property.Attributes.Cast<Attribute>().Any(p => p.GetType() == typeof(BrowsableAttribute)))
        cat.SetValue(att, value);
}

protected void SetReadOnly(string propertyName, bool value)
{
    PropertyDescriptor property = TypeDescriptor.GetProperties(GetType())[propertyName];
    ReadOnlyAttribute att = (ReadOnlyAttribute)property.Attributes[typeof(ReadOnlyAttribute)];
    FieldInfo cat = att.GetType().GetField("isReadOnly", BindingFlags.NonPublic | BindingFlags.Instance);

    if (property.Attributes.Cast<Attribute>().Any(p => p.GetType() == typeof(ReadOnlyAttribute)))
        cat.SetValue(att, value);
} 
```

现在，我的问题是我应该在哪里调用这些方法？有什么我可以处理的事件`object`来调用这些方法吗？也许通过实现一个接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:09:18.060

调用 property-get 时不会触发内置事件，除非您编写一个。

当然，如果您编写自定义描述符（PropertyDescriptor，通常作为装饰器链接到反射描述符），您可以**仅通过描述符**拦截访问（数据绑定等），并做任何您想做的事情 - 但对于任意类型（包括那些你没写）。

在运行时通过反射设置属性值......不是很好。这主要是由于 TypeDescriptor 缓存的意外。如果你打算这样做，TypeDescriptor.AddAttributes （或类似的）是更可取的。但是，通过实现自定义模型，您尝试做的事情会更合适。根据您显示的位置，这可以通过一个或以下方式完成：

*   添加自定义 TypeConverter，覆盖 GetProperties，并在运行时根据数据提供自定义描述符 - 主要适用于 PropertyGrid
*   在对象中实现 ICustomTypeDescriptor，实现 GetProperties，并在运行时根据数据提供自定义描述符 - 适用于大多数控件
*   添加自定义 TypeDescriptionProvider 并与类型 (TypeDescriptor.AddProvider) 关联，提供与上述行为类似的 ICustomTypeDescriptor；这将对象与描述符 voodoo 分开

所有这些都很棘手！最简单的是 TypeConverter 选项，因为您提到了 PropertGrid，所以效果很好。从 ExpandableObjectConverter 继承，并覆盖 GetProperties，根据需要进行过滤，并根据需要为只读描述符提供自定义描述符。然后将 TypeConverterAttribute 附加到您的类型，指定您的自定义转换器类型。

重点：.NET 的这个分支非常复杂、晦涩难懂，而且使用量正在减少。但它有效。

# mongodb - 混合 MongoDB 查询类型（和，或）

> ID：10372328
> 
> 赞同：3
> 
> 时间：2012-04-29T13:01:00.617
> 
> 标签：mongodb

我正在使用 MongoDB 存储有关咖啡的信息，但我遇到了查询问题。

我的文档结构是：

```
{ _id: "Thailand Bok", tags: ["Strong", "Smooth", "Dark"] } 
```

我正在尝试创建允许我搜索名称或标签的查询。

因此，鉴于查询字符串可能是“Thailand Bok”或 [“Strong”、“Smooth”]，我想搜索包含 _id 或每个标签的请求。

如果我用 SQL 术语思考，它可能是这样的：

```
"WHERE `_id` like 'Not present%' OR ("Strong" IN `tags` AND "Smooth" IN `tags`)" 
```

到目前为止我的查询是：

```
{ 
    $or: [
      { _id: { $regex: '^Not present', '$options': 'i' } },
      { 
          $and: [ 
              { tags: 'Strong' }, 
              { tags: 'Smooth' } 
          ]
      }
    ]
} 
```

编辑：更正查询中的错误并澄清如果_id匹配或标签匹配它应该工作

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T13:46:43.077

$and 仅在 MongoDB 2.0+ 版本中受支持，我使用的是 1.8.2

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-29T13:21:18.303

您的查询似乎没问题，除了 $or 使用花括号而不是方括号。

```
{$or: [
  {_id: {$regex: '^hailand', $options: 'i'} }, 
  {'$and': [
       {tags: 'Strong'}, 
       {tags: 'Smooth'}
   ]}
]} 
```

工作得很好。

# opencl - clGetDeviceIDs 在 OpenCL 中失败，错误代码为 -30

> ID：10372329
> 
> 赞同：1
> 
> 时间：2012-04-29T13:01:02.190
> 
> 标签：opencl, gpu, gpgpu, pyopencl, opencl.net

以下程序在我的机器上使用 ATI Firepro V8750 的输出如下：

```
"Couldn't find any devices:No error" 
```

（这发生在调用第一个 clGetDeviceIDs 时）。返回的错误代码是-30。这意味着什么？

我无法理解为什么它无法找到该设备。我检查了 CLinfo.exe 列出了我的 GPU 以及我拥有的 Intel CPU。有人可以给我一些关于这里有什么问题的指示吗？

附加信息：

AMD 应用程序 SK 2.4

Firepro 驱动程序：8.911.3.3_VistaWin7_X32X64_135673

12-4_vista_win7_32_dd_ccc

Windows 7 另外我必须提到 firePro 驱动程序的一些组件无法安装。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#ifdef MAC
#include <OpenCL/cl.h>
#else
#include <CL/cl.h> 
#endif

int main() {

 /* Host/device data structures */
 cl_platform_id platform;
 cl_device_id *devices;
 cl_uint num_devices, addr_data;
 cl_int i, err;

 /* Extension data */
 char name_data[48], ext_data[4096];

 /* Identify a platform */
 err = clGetPlatformIDs(1, &platform, NULL);            
 if(err < 0) {          
  perror("Couldn't find any platforms");
  exit(1);
  }

  /* Determine number of connected devices */
  err = clGetDeviceIDs(platform, CL_DEVICE_TYPE_GPU, 1, NULL, &num_devices);
   if(err < 0) {                
   perror("Couldn't find any devices");
    exit(1);
   }

    /* Access connected devices */
   devices = (cl_device_id*)                    
     malloc(sizeof(cl_device_id) * num_devices);        
   clGetDeviceIDs(platform, CL_DEVICE_TYPE_GPU,             
     num_devices, devices, NULL);               

    /* Obtain data for each connected device */
    for(i=0; i<num_devices; i++) {

    err = clGetDeviceInfo(devices[i], CL_DEVICE_NAME,       
        sizeof(name_data), name_data, NULL);            
    if(err < 0) {       
      perror("Couldn't read extension data");
     exit(1);
   }
   clGetDeviceInfo(devices[i], CL_DEVICE_ADDRESS_BITS,  
        sizeof(ext_data), &addr_data, NULL);            

   clGetDeviceInfo(devices[i], CL_DEVICE_EXTENSIONS,        
        sizeof(ext_data), ext_data, NULL);          

   printf("NAME: %s\nADDRESS_WIDTH: %u\nEXTENSIONS: %s", 
        name_data, addr_data, ext_data);
}

free(devices);
return 0;
} 
```

这是 CLINFO 输出：GPU： ![在此处输入图像描述](../Images/7afef59cb7dc697cb62a97e240a1bd70.png)

中央处理器： ![在此处输入图像描述](../Images/462d961e0775276d53a46852b81bbcd3.png)

为什么两个突出显示的版本不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T06:48:43.810

是不是您的系统上安装了多个 OpenCL 平台？因此，也许您的第一个平台是仅 CPU 的游戏形式，因此对 GPU 设备的查询失败。

编辑：

这就是问题所在：对 clGetDeviceIDs 的第一次调用为 num_entries 传递了 1，但为设备指针传递了 NULL。我认为您想为 num_entries 传入 0。

# c - 用于视频编码的纯 C 代码

> ID：10372334
> 
> 赞同：3
> 
> 时间：2012-04-29T13:01:33.690
> 
> 标签：c, encoding, h.264, decoding

我正在做一些计算机硬件架构探索，我渴望在我的原型上测试不同的任务。所以我需要一些代码来模拟视频编码和/或解码的任务（H264 是完美的，但其他编解码器也可以）。

有什么我可以使用的吗？它不必完全是编码/解码，只需一些代码可以粗略地估计具有相同计算的相同工作负载，这样我就可以获得一些性能/功耗结果。

哦，是的，它必须在“纯 C”中，并且不使用任何复杂的库（math.h 很好），因为我必须将它放到硬件模块上。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T13:05:11.880

看看[libavcodec](http://libav.org/)。它是[纯 C](http://libav.org/faq.html#I_0027m-using-Libav-from-within-my-C_002b_002b-application-but-the-linker-complains-about-missing-symbols-which-seem-to-be-available_002e)。

# html - html 标签的真实用法？

> ID：10372335
> 
> 赞同：2
> 
> 时间：2012-04-29T13:01:42.880
> 
> 标签：html, w3c, link-tag

偶尔我会看到这样的标签+数据：（除了css链接）

```
<link rel="Home" href="/" title="Page d'accueil de Babysun" />
<link rel="Index" href="/" />
<link rel="Top" href="/" title="Babysun / Accueil Babysun - Babysun" />
<link rel="Search" href="/content/advancedsearch" title="Recherche Babysun" />
<link rel="Shortcut icon" href="/extension/ezwebin/design/babysun/images/favicon.png" type="image/x-icon" />
<link rel="Copyright" href="/ezinfo/copyright" />
<link rel="Author" href="/ezinfo/about" /> 
```

链接标签描述为：

> 标签定义了文档和外部资源之间的关系。该标签最常用于链接到样式表。

*文档和外部资源之间的关系？？？* 什么外部资源？搜索引擎优化？如果是这样，谷歌关心什么：

```
<link rel="Home"....
<link rel="Index" ....
<link rel="Top" ... 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T13:47:51.500

`rel`不仅限于`<link>`标签，它也可以与`<a>`.

根据 w3c

> 该属性描述了从当前文档到由 href 属性指定的锚点的关系。此属性的值是以空格分隔的链接类型列表。

您可以在此处找到常见的链接类型：

[http://www.w3.org/TR/html4/types.html#h-6.12](http://www.w3.org/TR/html4/types.html#h-6.12)

即使在这些中，只有 SEO （nofollow、noindex、canonical）有一些真正的影响力（尽管众所周知，谷歌会在他想要的时候忽略它们。）

这句话很好地总结了类型：

> 用户代理、搜索引擎等**可以以****多种**方式解释这些链接类型 。例如，用户代理可以通过导航栏提供对链接文档的访问。

这真是一团糟，Microformats 项目试图标准化它们的使用（Microformats 不限于 rel。）您可以[在此处](http://microformats.org/wiki/Main_Page)找到草案和规范。最酷的是`rel="tag"`（[这里](http://microformats.org/wiki/rel-tag)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:49:29.220

正如规范所定义的那样：

> ...它传达可能由用户代理以各种方式呈现的关系信息（例如，带有链接下拉菜单的工具栏）

进一步，您可以阅读有关[链接类型](http://www.w3.org/TR/html401/types.html#type-links)的信息，并从中提取一些特定信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T13:54:38.927

您可以在此页面上阅读有关标签的更多信息：

[http://www.w3.org/QA/Tips/use-links](http://www.w3.org/QA/Tips/use-links)

**例如，Google**使用**rel="canonical"**来识别具有相同内容的每个页面都应该被搜索引擎索引。

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)

# ruby - 什么是机架 - “无接受器”错误？

> ID：10372340
> 
> 赞同：8
> 
> 时间：2012-04-29T13:02:23.393
> 
> 标签：ruby, rack, thin

在尝试运行我的 config.ru 时，我遇到了一个我似乎无法调试的奇怪错误，称为“无接受器”错误。

完整的错误信息：

```
eventmachine.rb:572:in `start_tcp_server': no acceptor (RuntimeError) 
```

有谁知道这个错误是什么意思？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-29T13:37:15.560

正如@Fivell 所说，我认为问题在于您之前的实例`thin`仍在运行。我建议不要从另一个端口开始，而是建议终止前一个实例。像这样的东西应该可以完成工作（我在这里重新创建了问题，所以这是我的真实输出）：

```
telemachus caps $ ps ax | grep ruby
  153   ??  S      7:52.18 ruby /usr/local/bin/djsd
15801   ??  S      0:00.40 ruby caps.rb  # this is our problem, get it's PID
15973 s000  S+     0:00.00 grep ruby

telemachus caps $ kill -9 15801 # thin needs -9 - hard to kill
telemachus caps $ ps ax | grep ruby
  153   ??  R      7:52.86 ruby /usr/local/bin/djsd
16057 s000  S+     0:00.00 grep ruby 
```

根据您启动应用程序的方式，您可能需要`grep`不同的东西（例如，如果您使用`shotgun`或`rackup`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:16:47.177

我认为问题在于使用端口已经绑定（也许您之前启动了您的应用程序）尝试更改端口

```
rackup config.ru -p port    #default port is 9292 change to something else 
```

或者如果你使用薄

```
thin start  -p port -a 0.0.0.0  -R config.ru #default port is 8080 change to something else 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-08T00:14:54.483

尽管没有僵尸进程并且端口未绑定，但我收到此错误。

这有效：

```
thin -p9292 start 
```

但这不会：

```
rackup 
```

# django - 使用 django 和 celery 运行定期任务

> ID：10372341
> 
> 赞同：4
> 
> 时间：2012-04-29T13:02:37.073
> 
> 标签：django, celery, task

我正在尝试使用 Django-Celery-RabbitMQ 组合创建一个简单的后台定期任务。我安装了 Django 1.3.1，我下载并设置了 djcelery。这是我的 settings.py 文件的样子：

```
BROKER_HOST = "127.0.0.1"
BROKER_PORT = 5672
BROKER_VHOST = "/"
BROKER_USER = "guest"
BROKER_PASSWORD = "guest"
....
import djcelery
djcelery.setup_loader()
...
INSTALLED_APPS = (
    'djcelery',
) 
```

我在我的应用程序文件夹中放置了一个“tasks.py”文件，其中包含以下内容：

```
from celery.task import PeriodicTask
from celery.registry import tasks
from datetime import timedelta
from datetime import datetime

class MyTask(PeriodicTask):
    run_every = timedelta(minutes=1)

    def run(self, **kwargs):
        self.get_logger().info("Time now: " + datetime.now())
        print("Time now: " + datetime.now())

tasks.register(MyTask) 
```

然后我启动我的 django 服务器（本地开发实例）：

```
python manage.py runserver 
```

然后我开始这个`celerybeat`过程：

```
python manage.py celerybeat --logfile=<path_to_log_file> -l DEBUG 
```

我可以在日志中看到这样的条目：

```
[2012-04-29 07:50:54,671: DEBUG/MainProcess] tasks.MyTask sent. id->72a5963c-6e15-4fc5-a078-dd26da663323 
```

而且我还可以看到在数据库中创建了相应的条目，但是我找不到它在哪里记录我`run`在类中的实际函数中指定的文本`MyTask`。

我尝试摆弄日志记录设置，尝试使用 django 记录器而不是 celery 记录器，但没有用。我什至不确定，我的任务正在执行。如果我在任务中打印任何调试信息，它会去哪里？

此外，这是我第一次使用任何类型的消息队列系统。看起来该任务将作为`celerybeat`流程的一部分在 django Web 框架之外执行。我仍然可以访问我创建的所有 django 模型吗？

谢谢，文卡特。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T07:38:53.430

Celerybeat it stuff，它在需要时推送任务，但不执行它们。您的任务实例存储在 RabbitMq 服务器中。你需要执行 celeryd 守护进程来执行你的任务。

```
python manage.py celeryd --logfile=<path_to_log_file> -l DEBUG 
```

另外，如果您使用 RabbitMq，我建议您安装特殊的 rabbitmq 管理插件：

```
rabbitmq-plugins list
rabbitmq-enable rabbitmq_management
service rabbitmq-server restart 
```

它将在 http://:55672/ 登录：访客通行证：访客。在这里您可以在线查看您的兔子实例中有多少任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T16:44:44.177

您应该检查 RabbitMQ 日志，因为 celery 将任务发送到 RabbitMQ 并且它应该执行它们。所以所有任务的打印都应该在 RabbitMQ 日志中。

# prolog - Prolog二叉树 - 语法错误：需要运算符

> ID：10372342
> 
> 赞同：0
> 
> 时间：2012-04-29T13:02:44.017
> 
> 标签：prolog, binary-tree, syntax-error

我试图在 prolog 中编写二叉树，但出现以下错误：

```
Syntax error: Operator expected 
```

在第一次调用 addChildren 时出现错误：

```
addChildren(node(Left, Right, Cand, [(Name, Profit, Weight)|T])):-
getTotalWeight(Cand, 0, Total),
%if total weight is less than 20
((Total + Weight) < 20 -> %then
    New = [Cand | (Name, Profit, Weight)],
    addChildren(Left(_,_, New, T)), %error here
    addChildren(Right(_,_, Cand, T))
; %else
    %end). 
```

我正在使用以下节点：

```
node(node, node, [], []). 
```

任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:05:21.900

```
Left(_,_, New, T) 
```

不是一个有效的复合术语，因为函子可能不是一个变量（大写的标识符）。利用

```
left(_, _, New, T) 
```

相反，对于`Right`.

# android - PhoneGap - 条码扫描器 (Android)

> ID：10372346
> 
> 赞同：0
> 
> 时间：2012-04-29T13:03:09.853
> 
> 标签：android, cordova, barcode, barcode-scanner, phonegap-plugins

我在使用 Phonegap 的条形码扫描仪时遇到了一个基本的机器人错误。我确定它是一个简单的修复，或者我缺少的东西。我似乎无法将手指放在它上面。我已经导入了 com.google.zxing.client.android.R

错误代码：

```
04-29 05:49:38.448: E/AndroidRuntime(12450): java.lang.NoClassDefFoundError: com.google.zxing.client.android.R$layout
04-29 05:49:38.448: E/AndroidRuntime(12450):    at com.google.zxing.client.android.CaptureActivity.onCreate(CaptureActivity.java:156)
04-29 05:49:38.448: E/AndroidRuntime(12450):    at android.app.Activity.performCreate(Activity.java:4465)
04-29 05:49:38.448: E/AndroidRuntime(12450):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-29 05:49:38.448: E/AndroidRuntime(12450):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
04-29 05:49:38.448: E/AndroidRuntime(12450):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
04-29 05:49:38.448: E/AndroidRuntime(12450):    at android.app.ActivityThread.access$600(ActivityThread.java:123) 
```

捕获活动线

```
super.onCreate(icicle);

Window window = getWindow();
window.addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
#156 --> setContentView(R.layout.capture);

CameraManager.init(getApplication());
viewfinderView = (ViewfinderView) findViewById(R.id.viewfinder_view);
resultView = findViewById(R.id.result_view);
statusView = (TextView) findViewById(R.id.status_view); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T11:22:50.203

我又遇到了这个问题，我不敢相信我从来没有发布过答案。对不起，这就是答案。

您需要将 lib 添加到您的 eclipse 项目中并确保选中“Is Library”。但是你需要在你的应用程序中添加 zxing 库作为参考，就像这样。

![在此处输入图像描述](../Images/be43fcc8d77690ccce5313e805071e19.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-13T15:19:47.700

检查已添加到项目中的库和 jar 文件 Zxing 项目应设置为项目的库

1.  单击项目上的属性
2.  检查 Zxing 项目是否需要库 Jar 文件是 Core.jar

在您的应用中

1.  单击属性
2.  单击添加库
3.  选择Zxing项目

除了 Xzing 之外，您的应用所需的 Jar 文件是 SupportV4,Core.jar

在 Android Studio 打开项目结构 (Ctrl+Alt+Shift+S) 在库选项卡上将所需的 Jar 文件添加到您的特定项目 在模块选项卡上添加项目依赖项 (Zxing) 以将其设置为库项目

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T13:34:05.983

```
NoClassDefFoundError 
```

听起来好像缺少库，上次更新后我的项目中的库出现问题，错误是一样的。以前有效吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T15:39:43.307

在我看来，您部署的项目资源中缺少布局（可能是您在扫描条形码时看到的屏幕）。

有必要回顾一下在你的应用程序中加入 zxing 的说明——可能已经错过了一个步骤。

# c - Sqlite通过函数传递数据库

> ID：10372348
> 
> 赞同：0
> 
> 时间：2012-04-29T13:03:30.897
> 
> 标签：c, sqlite

我正在尝试将我的 sqlite 数据库传递给一个函数，然后再传递给另一个函数。这是我的代码。

```
//database Name
// Create a handle for database connection, create a pointer to sqlite3
sqlite3 *dataDB;

//I send it through to the function here
// Execute the query for creating table
retval = sqlite3_exec(dataDB,create_students,0,0,0); 
```

我的原型：

```
int readInFiles(sqlite3 ** dataDB);
void addCourse(sqlite3 ** dataDB, struct course,int k); 
```

从`readInFiles`函数内部调用：

```
addCourse(&dataDB,deg,k); 
```

这是我的错误：

```
"database.c", line 50: warning: argument #1 is incompatible with prototype:
      prototype: pointer to pointer to struct sqlite3 {} : "database.h", line 51 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:15:30.583

From inside `readInFiles`,已经`dataDB`是类型`sqlite3**`，所以你需要调用：

```
addCourse(dataDB,deg,k); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:18:24.460

为什么不简单地传递指针本身？和函数可能不需要写入指针，只需要写入`readInFiles`对象。`addCourse``sqlite3`

```
sqlite3 *db;

retval = sqlite3_exec(db, create_students, 0, 0, 0);

int readInFiles(sqlite3 *db);
void addCourse(sqlite3 *db, struct course, int k);

addCourse(db, deg, k); 
```

此外，`dataDB`（数据库）有点多余:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T13:25:02.383

你可以试试 addCourse(dataDB, deg, k); 我不明白，你想在 readInFile 中初始化 db 吗？如果你只使用 db，你可以像 readInFile(sqlite3* dataDB) 和 addCourse(sqlite* dataDB) 一样声明

# php - 使用 jquery ft.upload、PhoneGap 发送复选框数组

> ID：10372352
> 
> 赞同：0
> 
> 时间：2012-04-29T13:04:25.567
> 
> 标签：php, javascript, jquery, cordova, upload

我的应用程序中有一些复选框，可以（自然地）选中。这个复选框被命名为“checkboxname[]”，每个复选框都有自己的值（4、5、6、7、8，等等）。

现在我想将所有值（仅来自选中的复选框！！）放入一个数组中，通过 ft.upload 发送这个数组，然后用 foreach 和 php 拆分数组。但是我的 php 文件总是说参数对我的 foreach 函数无效。

继承人的JavaScript。

```
var values = new Array();
$("input[name='checkboxname[]']:checked").each(function(){values.push($(this).val());});
params.checkboxname = values; 
```

继承人的PHP代码。

```
$rubriks = $_POST['checkboxname'];
foreach($rubriks as $ausgabe){ 
 echo $ausgabe; } 
```

我不知道怎么了。我用 var_dump 测试了实际从 javascript 发送的内容，没有复选框数组，所以我认为有问题吗？！

# asp.net - ASP.NET 以编程方式将 RadioButtons 添加到窗体。如何设置价值？

> ID：10372353
> 
> 赞同：0
> 
> 时间：2012-04-29T13:04:42.493
> 
> 标签：asp.net, radio-button

> **可能重复：**
> [设置 RadioButton 的 value 属性](https://stackoverflow.com/questions/9368353/set-value-property-of-radiobutton)

```
RadioButton rbtn = new RadioButton();
rbtn.GroupName = "item_selection";
rbtn.Text = Item1;
radio_buttons.Controls.Add(rbtn); 
```

我正在以编程方式向 ASP.NET 中的表单添加一系列单选按钮。我可以很好地添加按钮，但我找不到如何设置“值”，这样它就相当于：

```
<input name="item_selection" type="radio" value="Item1Value"/> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T13:11:55.733

您可以通过使用“属性”属性来实现这一点。例如，

```
 RadioButton rbtn = new RadioButton();
    rbtn.GroupName = "item_selection";
    rbtn.Text = "Sample Text";
    rbtn.Checked = true;
    rbtn.Attributes.Add("value", "Sample Value");
    this.Controls.Add(rbtn); 
```

# python - Python print 语句涉及多少计算机指令？

> ID：10372355
> 
> 赞同：0
> 
> 时间：2012-04-29T13:05:04.827
> 
> 标签：python, performance, printing

我问这个问题是因为当使用重复的打印语句调试循环时，它会减慢程序的速度，这比我最初预期的要慢得多。我已经习惯了，但现在我很好奇为什么会出现这种情况的技术原因？在我看来，变量的各种计算和分配会比输出字符串更昂贵。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T13:13:11.147

不少，但另一个重要（甚至是最重要的）瓶颈与 CPU 无关：I/O 开销。一旦发送了字节码指令并将所有参数转换为字符串，就会调用一个函数将这些字符串写入`sys.stdout`. 根据您的系统和运行程序的方式，这可能是：

1.  磁盘上的文件
2.  来自终端仿真器的管道
3.  一些捕获输出的 Python 对象（这就是 IDLE 所做的 IIRC）来做谁知道用它做什么（捕获它，将它放入 GUI 等）。

在第 1 种情况下，涉及磁盘 I/O，这很容易比写入 RAM 慢一个数量级。与今天的 CPU 相比，RAM 已经非常慢了。正如评论中所指出的，由于操作系统和 Python 的大量缓冲，这不是一个问题，但仍然需要时间来发出写入并且（取决于我不太了解的实现细节）它可能仍然需要一些时间如果有人过早地刷新任何缓冲区的时间。

在案例 #2 中，所有内容都保留在内存中，但它仍然是一个系统调用、一些复制，并且另一端必须读取它并用它做一些事情让你注意到（例如，在一个带有反别名字体，这本身就是一项复杂的任务）。问题不大，因为它可以同时发生，但它仍然会给 CPU 带来负载。

在第 3 种情况下，所有赌注都被取消。据我们所知，它可能会使用 bcrypt 对输出进行哈希处理并将其发送到月球。你碰巧使用IDLE吗？我记得有一个抱怨说 IDLE 在重定向输出时（是？）*非常*慢，尤其是在有很多尖齿的情况下。它必须捕获输出，将它与到目前为止的输出连接起来，然后让 Tkinter 渲染它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:08:59.773

一个巨大的，巨大的，***巨大的***数字，尤其是当输出在屏幕上可见时，例如在现代多任务系统的终端仿真器窗口中。

首先，如果您以十进制输出数字，则每个数字都有一个 divmod，与加法相比，这是一个相对昂贵的操作。（如果以十六进制输出，可能会便宜一些，因为每个数字都可以仅使用移位和掩码来提取。）如果输出浮点数，则涉及更多计算；对于日期和时间，需要考虑各种长度的月份、闰年、闰秒、DST 和时区。

但这只是计算和逻辑，因此与即将发生的事情相比相形见绌。

接下来 Python 必须将输出文本发送到终端进行显示，这意味着操作系统必须介入以通过缓冲区传输数据，然后唤醒其他进程。终端进程扫描其输入以查找控制序列以移动光标或更改颜色。然后文本渲染器扫描文本以查找需要特殊处理的字符：可能需要应用一些组合重音符号，或者需要重新排列一些从右到左的脚本以进行显示。

布局文本后，终端告诉窗口管理器需要重绘其窗口的哪个区域，然后窗口管理器检查它是否可见——它可能被最小化或隐藏在另一个窗口后面。终端被告知哪个区域实际需要绘制，最后以适当的字体和颜色、字距调整和抗锯齿绘制文本。窗口是否有看起来很酷的透明背景？这也必须合并。

根据窗口系统的不同，像素然后可以通过操作系统缓冲区再次到达合成管理器，合成管理器实际上将窗口内容绘制到屏幕上，同时考虑到窗口透明度。

最后，像素到达屏幕，在被数百万的继任者扫走之前，它们几乎没有时间被看到，因为你看到输出流过的速度太快而无法阅读。

令人惊讶的是，我们的计算机为我们做了多少工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T13:11:46.997

这与 CPU 指令无关，至少与 Python 程序中的 CPU 指令无关。当您`print`使用终端模拟器（命令窗口）作为输出时，要打印的字符串被复制到内核缓冲区，然后复制到终端进程的内存中。开销在于上下文切换（两个进程都进行系统调用，即跳转到内核模式）和内存中字符串的复制。

# .htaccess - 需要帮助修复 CodeIgniter 项目的 400 错误请求

> ID：10372359
> 
> 赞同：0
> 
> 时间：2012-04-29T13:06:05.750
> 
> 标签：.htaccess, codeigniter-2, bad-request

在我的 codeigniter 项目中，我有以下 htaccess 文件从 URL 中删除 index.php

```
RewriteEngine on
RewriteCond $1 !^(index\.php|js|media|style|robots\.txt)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

我正在使用搜索表单（使用表单助手）。由于它是基于 POST 的，我创建了一个名为“pre_search”的控制器来将其重定向到搜索控制器，以便 POST 的数据将在 URL 中可见，并且我可以将它与 URI 助手的段方法一起使用。

所以我的 pre_search 控制器

```
<?php

class Presearch extends CI_Controller {

    //just to make form POST data visible in URL string for search
    public function index() {
        redirect('search/' . $this->input->post('term'));
    }
} 
```

搜索控制器进行真正的搜索。同时，我已允许 URL 中的所有字符进行测试。

```
$config['permitted_uri_chars'] = ''; 
```

我现在的问题是，当我在 URL 中有百分号 (%) 时，它会显示错误的请求。我认为这是apache的响应，codeigniter与它无关。

经过一些研究，我发现有人建议通过像这样修改 htaccess 来解决这个问题

```
RewriteRule ^(.*)$ /index.php/$1 [B,L] 
```

我已经尝试过这种方法，它破坏了一切。

由于 % 符号未编码，因此我也尝试在我的 pre_search 控制器中像这样使用

```
redirect('search/' . urlencode($this->input->post('term'))); 
```

但没有解决问题。

那么解决这个问题的最佳方法是什么？我知道这是apache问题。我只是在说明我的 codeigniter 代码以澄清我的意图。

提前致谢

迪帕克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T07:13:15.177

我也这样做，这些是我的参数，我还发现这个链接可能会帮助你使用 htaccess [http://www.dracos.co.uk/code/apache-rewrite-problem/](http://www.dracos.co.uk/code/apache-rewrite-problem/)

```
$this->load->library('form_validation');
$this->form_validation->set_rules('s', '','trim|min_length[3]|required|xss_clean');
if ($this->form_validation->run() == FALSE):
    $this->session->set_flashdata('errorMsg', form_error('s'));
    redirect($this->session->userdata['redirectUrl']);
else:
    redirect(base_url() . $this->lang->line('link_search') . '/' . $this->functions->convertToUrl($this->functions->secureString($this->input->post('s', TRUE))));
endif; 
```

我的配置值

```
 $config['permitted_uri_chars'] = 'a-z 0-9~%\.\:_\-ñ';
 $config['uri_protocol'] = 'PATH_INFO'; 
```

我将 POST 转换为清晰的 url，将字符更改为允许的字符，然后进行重定向。

# c# - 如何使用登录用户的 ASP.NET C# 获取 Mac 和 IP 地址

> ID：10372360
> 
> 赞同：3
> 
> 时间：2012-04-29T13:06:08.180
> 
> 标签：c#, ip, ip-address, mac-address

我想获取登录系统（Web 应用程序）的用户的 IP 地址和 MAC 地址。我正在使用这些代码行

```
 NetworkInterface[] nics = NetworkInterface.GetAllNetworkInterfaces(); 
```

我正在使用这种方法来获取 MAC 地址，但问题是我正在获取计算机所有适配器的 MAC 地址。

我怎么知道哪一个是正确的？，如何获得连接到我网站的设备的正确 MAC 地址？

以及如何获取适配器的 IP。

当我在我的电脑上试用它时，它会提供 8 个带有 8 个 MAC 地址的适配器

我正在我的电脑上尝试，我有一个连接到 IntraNet 的有线连接，以及一个连接到 Internet 的无线连接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T13:24:33.740

您永远无法获得连接到您网站的用户的 MAC 地址，当目标（您的网站的服务器）和源（客户端的计算机）之间发生套接字连接时，您只能获得源 IP 地址，因为 MAC 地址永远不会通过套接字连接（客户端 <--> 服务器）发送，以获取用户的 IP 地址：

```
using System.Net;

Private string GetIP()
{
string strHostName = "";
strHostName = System.Net.Dns.GetHostName();

IPHostEntry ipEntry = System.Net.Dns.GetHostEntry(strHostName);

IPAddress[] addr = ipEntry.AddressList;

return addr[addr.Length-1].ToString();

} 
```

来源：[这里](http://alperguc.blogspot.com/2008/11/c-how-to-get-computer-ip-address.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-21T03:55:43.940

```
using System.Runtime.InteropServices;

[DllImport("Iphlpapi.dll")]
private static extern int SendARP(Int32 dest, Int32 host, ref Int64 mac, ref Int32 length);

[DllImport("Ws2_32.dll")]
private static extern Int32 inet_addr(string ip);

private static string GetClientMAC(string strClientIP) {
    string mac_dest = "";
    try {
        Int32 ldest = inet_addr(strClientIP);
        Int32 lhost = inet_addr("");
        Int64 macinfo = new Int64();
        Int32 len = 6;
        int res = SendARP(ldest, 0, ref macinfo, ref len);
        string mac_src = macinfo.ToString("X");

        while (mac_src.Length < 12) {
            mac_src = mac_src.Insert(0, "0");
        }

        for (int i = 0; i < 11; i++) {
            if (0 == (i % 2)) {
                if (i == 10) {
                    mac_dest = mac_dest.Insert(0, mac_src.Substring(i, 2));
                } else {
                    mac_dest = "-" + mac_dest.Insert(0, mac_src.Substring(i, 2));
                }
            }
        }
    } catch (Exception err) {
        throw new Exception("Lỗi " + err.Message);
    }
    return mac_dest;
} 
```

这段代码会帮助你:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-29T10:00:46.453

您可以使用以下代码段获取 MAC 地址。要实现此功能，您需要在应用程序中添加 System.Management 命名空间。如果它不可用，您需要从项目的“添加引用”中添加它的引用。

```
using System.Management;
using System.IO;

public string GetMACAddress()
{
    string mac_src = "";
    string macAddress = "";

    foreach (System.Net.NetworkInformation.NetworkInterface nic in System.Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces())
    {
        if (nic.OperationalStatus == System.Net.NetworkInformation.OperationalStatus.Up)
        {
            mac_src += nic.GetPhysicalAddress().ToString();
            break;
        }
    }

    while (mac_src.Length < 12)
    {
        mac_src = mac_src.Insert(0, "0");
    }

    for (int i = 0; i < 11; i++)
    {
        if (0 == (i % 2))
        {
            if (i == 10)
            {
                macAddress = macAddress.Insert(macAddress.Length, mac_src.Substring(i, 2));
            }
            else
            {
                macAddress = macAddress.Insert(macAddress.Length, mac_src.Substring(i, 2)) + "-";
            }
        }
    }
    return macAddress;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-26T05:27:59.427

当 IIS 使用代码部署此应用程序时..运行成功

```
 public string GetIPAddress()
    {
        System.Web.HttpContext context = System.Web.HttpContext.Current;
        string ipAddress = context.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];

        if (!string.IsNullOrEmpty(ipAddress))
        {
            string[] addresses = ipAddress.Split(',');
            if (addresses.Length != 0)
            {
                return addresses[0];
            }
        }

        return context.Request.ServerVariables["REMOTE_ADDR"];
    }
    [DllImport("Iphlpapi.dll")]
    private static extern int SendARP(Int32 dest, Int32 host, ref Int64 mac, ref Int32 length);

    [DllImport("Ws2_32.dll")]
    private static extern Int32 inet_addr(string ip);

    private static string GetClientMAC(string strClientIP)
    {
        string mac_dest = "";
        try
        {
            Int32 ldest = inet_addr(strClientIP);
            Int32 lhost = inet_addr("");
            Int64 macinfo = new Int64();
            Int32 len = 6;
            int res = SendARP(ldest, 0, ref macinfo, ref len);
            string mac_src = macinfo.ToString("X");

            while (mac_src.Length < 12)
            {
                mac_src = mac_src.Insert(0, "0");
            }

            for (int i = 0; i < 11; i++)
            {
                if (0 == (i % 2))
                {
                    if (i == 10)
                    {
                        mac_dest = mac_dest.Insert(0, mac_src.Substring(i, 2));
                    }
                    else
                    {
                        mac_dest = "-" + mac_dest.Insert(0, mac_src.Substring(i, 2));
                    }
                }
            }
        }
        catch (Exception err)
        {
            throw new Exception("Lỗi " + err.Message);
        }
        return mac_dest;
    }

 protected void Button1_Click1(object sender, EventArgs e)
    {  
        Label1.Text = GetClientMAC(GetIPAddress());
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-04T16:54:47.573

.NET 和 JS 应用程序都无法访问 MAC 地址。MAC地址它永远不会通过套接字连接发送，只有IP地址，所以你只能获取IP，使用以下代码：

```
public string GetIPAddress()
{
    System.Web.HttpContext context = System.Web.HttpContext.Current;
    string ipAddress = context.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];

    if (!string.IsNullOrEmpty(ipAddress))
    {
        string[] addresses = ipAddress.Split(',');
        if (addresses.Length != 0)
        {
            return addresses[0];
        }
} 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-04-29T13:34:48.790

首先，很高兴知道您为什么想要客户（用户）的 MAC 地址，因为**Mac 地址不是唯一的**。

您只能使用 .NET Framework 来获取 SERVER 连接，而不能使用它自己的用户，为此，为了获取客户端 MAC 地址，您只能依靠 javascript 和 ActiveX 控件，只能在 Internet Explorer 上用作 Firefox几年前已经弃用了它对 ActiveX 控件的支持。

可以在[这篇文章](http://aspboss.blogspot.com/2010/04/how-to-get-mac-address-using-c.html)中找到有关这方面的好读物。

# c - 如何在 C 中分配临时小内存段

> ID：10372363
> 
> 赞同：0
> 
> 时间：2012-04-29T13:06:17.657
> 
> 标签：c, memory, pointers, buffer

我正在尝试使用像这篇文章中提到的那样的循环缓冲区：[https ://stackoverflow.com/a/827749](https://stackoverflow.com/a/827749)

当我需要将东西推送和弹出到缓冲区时，我发现自己一直在做这样的事情：

```
int data;
int *data_ptr = &data;
cb_pop(spi_buffer, data_ptr); 
```

这是最好的（可能不是）方法吗？你会怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T13:10:09.137

你为什么不这样做：

```
int data;
cb_pop(spi_buffer, &data); 
```

创建另一个指针变量是多余的。

# jpa - 安全地使用具有关系的 JPA merge() (eclipselink, glassfish 3.1)

> ID：10372366
> 
> 赞同：1
> 
> 时间：2012-04-29T13:06:42.303
> 
> 标签：jpa, glassfish, ejb, eclipselink

不久前，在 IRC 上，有人告诉我在我的 EJB 更新方法中合并实体的关系时创建复制的子列表。我的问题是：这真的有必要吗？

这是我的代码...

（在 CtCaseEJB 中）

```
 public CtCase update( CtCase pCase )
  {
    CtCase aCtCase = em.merge( pCase );
    ...
    List<CtCaseTest> aCaseTestList = pCase.getCaseTests();               
    List<CtCaseTest> aNewCaseTestList = new ArrayList<CtCaseTest>();
    for( CtCaseTest aCaseTest : aCaseTestList )
    {
        aCaseTest = em.merge( aCaseTest );
        aNewCaseTestList.add( aCaseTest );
    }
    aCtCase.setCaseTests( aNewCaseTestList );
    ...
    return aCtCase;
 } 
```

关系定义为：

（在 CtCase 中）

```
private List<CtCaseTest> mCaseTests = new ArrayList<CtCaseTest>();

@OneToMany( mappedBy = "ctCase", cascade = { CascadeType.PERSIST, CascadeType.REFRESH } )
@OrderBy( "rank" )
public List<CtCaseTest> getCaseTests()
{
    return mCaseTests;
}

public void setCaseTests( List<CtCaseTest> pCaseTests )
{
    mCaseTests = pCaseTests;
} 
```

这就是我目前正在做的事情，尽管我偶尔会遇到一些奇怪的行为（以某种方式创建了双列表）。

我的问题是：为什么我不能添加 CascadeType.MERGE 并简单地在 CtCaseEJB 中执行此操作...

```
 public CtCase update( CtCase pCase )
  {
    return em.merge( pCase );
  } 
```

为什么需要在 JPA/EJB 中手动合并关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:14:33.423

无需手动合并。做添加`CascadeType.MERGE`。重要的是您的`equals()`和`hashcode()`正确实施以使其正常工作。我对为什么你会看到“古怪”行为、列表/等加倍的最佳猜测是`equals()`and/or有问题`hashcode()`。

附带一点：我会复制 中提供的列表`setTestCase()`，以避免将来出现问题。

# html - 为什么 CSS 省略号在表格单元格中不起作用？

> ID：10372369
> 
> 赞同：161
> 
> 时间：2012-04-29T13:07:35.003
> 
> 标签：html, css, ellipsis

考虑以下示例：（[此处为现场演示](http://jsfiddle.net/fd3Zx/1/)）

```
$(function() {
  console.log("width = " + $("td").width());
});
```

```
td {
  border: 1px solid black;
  width: 50px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<table>
  <tbody>
    <tr>
      <td>Hello Stack Overflow</td>
    </tr>
  </tbody>
</table>
```

输出为：`width = 139`，省略号不出现。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-04-29T13:25:56.913

显然，添加：

```
td {
  display: block; /* or inline-block */
} 
```

也解决了这个问题。

* * *

另一种可能的解决方案是`table-layout: fixed;`为表设置，并将其设置为`width`. 例如：http: [//jsfiddle.net/fd3Zx/5/](http://jsfiddle.net/fd3Zx/5/)

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2012-10-11T12:05:50.693

放上去也很重要

```
table-layout:fixed; 
```

在包含表上，因此它在 IE9 中也能正常运行（如果您使用最大宽度）。

* * *

## 回答 #3

> 赞同：84
> 
> 时间：2014-02-26T12:54:10.403

如前所述，您可以使用`td { display: block; }`，但这违背了使用表格的目的。

您可以使用`table { table-layout: fixed; }`，但也许您希望它对某些列表现不同。

因此，实现您想要的最佳方法是将文本包装在 a 中`<div>`并将您的 CSS 应用于`<div>`（而不是`<td>`），如下所示：

```
td {
  border: 1px solid black;
}
td > div {
  width: 50px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
} 
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2012-04-29T13:11:21.080

尝试使用`max-width`代替`width`，表格仍然会自动计算宽度。

即使在`ie11`（使用 ie8 兼容模式）下也可以工作。

```
td.max-width-50 {
  border: 1px solid black;
  max-width: 50px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
```

```
<table>
  <tbody>
    <tr>
      <td class="max-width-50">Hello Stack Overflow</td>
    </tr>
    <tr>
      <td>Hello Stack Overflow</td>
    </tr>
    <tr>
      <td>Hello Stack Overflow</td>
    </tr>
  </tbody>
</table>
```

[jsfiddle](http://jsfiddle.net/fd3Zx/2/)。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2016-04-21T10:17:51.110

## [演示页面](http://codepen.io/vsync/pen/QNxeVQ)

对于具有动态宽度的表格，我发现以下方法可以产生令人满意的结果。每个`<th>`希望具有修剪文本功能的都应该有一个内部包装元素，该元素包装`<th>`允许[`text-overflow`](https://developer.mozilla.org/en/docs/Web/CSS/text-overflow)工作的内容。

> **真正的诀窍是以单位**设置`max-width`（在 上`<th>`）。**[`vw`](https://developer.mozilla.org/en/docs/Web/CSS/length)**

这将有效地导致元素的宽度被“绑定”到视口宽度（浏览器窗口），并将导致响应式内容剪辑。将`vw`单位设置为所需的令人满意的值。

### 最小的 CSS：

```
th{ max-width:10vw; }

th > .wrap{ 
   text-overflow:ellipsis;
   overflow:hidden;
   white-space:nowrap;
} 
```

* * *

### 演示（带有可编辑文本）：

```
document.designMode="on"
```

```
table {
  font: 18px Arial;
  width: 40%;
  margin: 1em auto;
  color: #333;
  border: 1px solid rgba(153, 153, 153, 0.4);
}

table td, table th {
  text-align: left;
  padding: 1.2em 20px;
  white-space: nowrap;
  border-left: 1px solid rgba(153, 153, 153, 0.4);
}

table td:first-child, table th:first-child {
  border-left: 0;
}

table th {
  border-bottom: 1px solid rgba(153, 153, 153, 0.4);
  font-weight: 400;
  text-transform: uppercase;
  max-width: 10vw;
}

table th > .wrap {
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
}
```

```
<table>
    <thead>
        <tr>
            <th>
                <div class="wrap" title="Some long title">Some long title</div>
            </th>
            <th>
                <div class="wrap">Short</div>
            </th>
            <th>
                <div class="wrap">medium one</div>
            </th>
            <th>
                <div class="wrap" title="endlessly super long title which no developer likes to see">endlessly super long title which no developer likes to see</div>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>very long text here</td>
        </tr>
    </tbody>
</table>
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-11-15T16:59:39.437

只是提供了一个替代方案，因为我遇到了这个问题，而这里的其他答案都没有达到我想要的效果。所以我使用了一个列表。现在从语义上讲，我输出的信息既可以被视为表格数据，也可以被视为列出的数据。

所以最后我做的是：

```
<ul>
    <li class="group">
        <span class="title">...</span>
        <span class="description">...</span>
        <span class="mp3-player">...</span>
        <span class="download">...</span>
        <span class="shortlist">...</span>
    </li>
    <!-- looped <li> -->
</ul> 
```

所以基本上`ul`是`table`，`li`是`tr`，`span`是`td`。

然后在 CSS 中我将`span`元素设置为`display:block;`and `float:left;`（我更喜欢这种组合，`inline-block`因为它可以在旧版本的 IE 中工作，要清除浮动效果，请参阅：[http ://css-tricks.com/snippets/css/clear- fix/](http://css-tricks.com/snippets/css/clear-fix/) ) 并且还有省略号：

```
span {
    display: block;
    float: left;
    width: 100%;

    // truncate when long
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
} 
```

然后你所做的就是设置`max-widths`你的跨度，这将使列表看起来像一个表格。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-09-03T09:11:02.370

我没有使用省略号来解决文本溢出的问题，而是发现禁用和样式化的输入看起来更好，并且仍然允许用户在需要时查看和选择整个字符串。

```
<input disabled='disabled' style="border: 0; padding: 0; margin: 0" /> 
```

它看起来像一个文本字段，但可以突出显示，因此更加用户友好

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-26T13:06:22.517

检查元素`box-sizing`的 css 属性。我对将其设置为值`td`的 css 模板有问题。`border-box`你需要设置`box-sizing: content-box`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-08-06T13:59:26.597

我已经尝试了许多上述解决方案，但没有一个感到灵活或令人满意。

这个 max-width: 1px 的小技巧可以直接应用于 td 元素

```
.truncated-cell {
   max-width: 1px;
   white-space: nowrap;
   overflow: hidden;
   text-overflow: ellipsis;
 } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-16T21:46:56.300

让你的桌子保持原样。只需使用应用了截断 CSS 的 span 将内容包装在 TD 内。

```
/* CSS */
.truncate {
    width: 50px; /*your fixed width */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: block; /* this fixes your issue */
}

<!-- HTML -->
<table>
    <tbody>
        <tr>
            <td>
                <span class="truncate">
                    Table data to be truncated if it's too long.
                </span>
            </td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-30T06:22:09.760

```
.ellipsis {
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 1;
  -webkit-box-orient: vertical;
} 
```

上述设置对我有用，无需更改表格宽度。我在里面添加了一个 div 并在其中添加了类省略号。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-04-08T21:00:52.380

如果您不想将 max-width 设置为 td（如在[此答案](https://stackoverflow.com/a/10372381/1691517)中），则可以将 max-width 设置为 div：

```
function so_hack(){} 
```

`function so_hack(){}` [http://jsfiddle.net/fd3Zx/754/](http://jsfiddle.net/fd3Zx/754/) `function so_hack(){}`

```
function so_hack(){} 
```

注意：100% 不起作用，但 99% 可以在 FF 中发挥作用。其他现代浏览器不需要愚蠢的 div hack。

```
td {
  边框：1px纯黑色；
    填充左：5px；
    填充右：5px；
}
td>div{
    最大宽度：99%；
    溢出：隐藏；
    文本溢出：省略号；
    空白：nowrap；

}

```

# python - 尝试使用适用于 python 的 Google API 客户端将 UTF-8 文本文件上传到 Google Drive 时，我收到 UnicodeDecodeError

> ID：10372370
> 
> 赞同：3
> 
> 时间：2012-04-29T13:08:25.160
> 
> 标签：python, google-drive-api, google-api-python-client

**这个问题还没有解决！知道的请回答**

**漏洞**

我在这里提交了一个错误

[http://code.google.com/p/google-api-python-client/issues/detail?id=131&thanks=131&ts=1335708962](http://code.google.com/p/google-api-python-client/issues/detail?id=131&thanks=131&ts=1335708962)

在处理我的[gdrive-cli](http://github.com/tom-dignan/gdrive-cli)项目时，我在尝试使用“text/plain”mime 类型上传 UTF-8 markdown 文件时遇到了这个错误。我还尝试了“text/plain;charset=utf-8”并得到了相同的结果。

这是我得到的堆栈跟踪：

```
Traceback (most recent call last):
  File "./gdrive-cli", line 155, in <module>
    handle_args(args)
  File "./gdrive-cli", line 92, in handle_args
    handle_insert(args.insert)
  File "./gdrive-cli", line 126, in handle_insert
    filename)
  File "/home/tom/Github/gdrive-cli/gdrive/gdrive.py", line 146, in insert_file
    media_body=media_body).execute()
  File "/usr/local/lib/python2.7/dist-packages/apiclient/http.py", line 393, in execute
    headers=self.headers)
  File "/usr/local/lib/python2.7/dist-packages/oauth2client/client.py", line 401, in new_request
    redirections, connection_type)
  File "/usr/local/lib/python2.7/dist-packages/httplib2/__init__.py", line 1544, in request
    (response, content) = self._request(conn, authority, uri, request_uri, method, body, headers, redirections, cachekey)
  File "/usr/local/lib/python2.7/dist-packages/httplib2/__init__.py", line 1294, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/usr/local/lib/python2.7/dist-packages/httplib2/__init__.py", line 1231, in _conn_request
    conn.request(method, request_uri, body, headers)
  File "/usr/lib/python2.7/httplib.py", line 955, in request
    self._send_request(method, url, body, headers)
  File "/usr/lib/python2.7/httplib.py", line 989, in _send_request
    self.endheaders(body)
  File "/usr/lib/python2.7/httplib.py", line 951, in endheaders
    self._send_output(message_body)
  File "/usr/lib/python2.7/httplib.py", line 809, in _send_output
    msg += message_body
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 4518: ordinal not in range(128) 
```

我必须发出来生成它的命令是：

```
gdrive-cli --insert README.md "readme file" none "text/plain" README.md 
```

您可以在此处获取发生此问题时的确切 README.md 文件，[http ://tomdignan.com/files/README.md](http://tomdignan.com/files/README.md)

SDK 示例中的相关代码如下。传入的参数依次为：

服务实例、“README.md”、“自述文件”、无（python 关键字）、“text/plain”和“README.md”

```
def insert_file(service, title, description, parent_id, mime_type, filename):
    """Insert new file.

    Args:
        service: Drive API service instance.
        title: Title of the file to insert, including the extension.
        description: Description of the file to insert.
        parent_id: Parent folder's ID.
        mime_type: MIME type of the file to insert.
        filename: Filename of the file to insert.
    Returns:
        Inserted file metadata if successful, None otherwise.
    """
    media_body = MediaFileUpload(filename, mimetype=mime_type)
    body = {
        'title': title,
        'description': description,
        'mimeType': mime_type
    }

    # Set the parent folder.
    if parent_id:
        body['parentsCollection'] = [{'id': parent_id}]

    try:
        file = service.files().insert(
                body=body,
                media_body=media_body).execute()

        # Uncomment the following line to print the File ID
        # print 'File ID: %s' % file['id']

        return file
    except errors.HttpError, error:
        print "TRACEBACK"
        print traceback.format_exc()
        print 'An error occured: %s' % error
        return None 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T09:54:53.733

追溯：

```
...
resp = pool.request(method, page, fields = fields)
  File "/usr/lib/python2.7/site-packages/urllib3-dev-py2.7.egg/urllib3/request.py", line 79, in request
**urlopen_kw)
  File "/usr/lib/python2.7/site-packages/urllib3-dev-py2.7.egg/urllib3/request.py", line 139, in request_encode_body
**urlopen_kw)
  File "/usr/lib/python2.7/site-packages/urllib3-dev-py2.7.egg/urllib3/connectionpool.py", line 415, in urlopen
body=body, headers=headers)
  File "/usr/lib/python2.7/site-packages/urllib3-dev-py2.7.egg/urllib3/connectionpool.py", line 267, in _make_request
conn.request(method, url, **httplib_request_kw)
  File "/usr/lib64/python2.7/httplib.py", line 958, in request
    self._send_request(method, url, body, headers)
  File "/usr/lib64/python2.7/httplib.py", line 992, in _send_request
    self.endheaders(body)
  File "/usr/lib64/python2.7/httplib.py", line 954, in endheaders
    self._send_output(message_body)
  File "/usr/lib64/python2.7/httplib.py", line 812, in _send_output
    msg += message_body
UnicodeDecodeError: 'ascii' codec can't decode byte 0x8b in position 181: ordinal not in range(128) 
```

urllib3

文件发布.py：

```
def encode_multipart_formdata(fields, boundary=None):
    ...
    body = BytesIO()
    ...
    return body.getvalue(), content_type 
```

请求.py：

```
def request(self, method, url, fields=None, headers=None, **urlopen_kw):
    ...
    else:
        return self.request_encode_body(method, url, fields=fields,
                                        headers=headers,
                                        **urlopen_kw)

def request_encode_body(self, method, url, fields=None, headers=None,
                            encode_multipart=True, multipart_boundary=None,
                            **urlopen_kw):
    ...
    if encode_multipart:
        body, content_type = encode_multipart_formdata(fields or {},
                                                       boundary=multipart_boundary)
    ...
    headers = headers or {}
    headers.update({'Content-Type': content_type})

    return self.urlopen(method, url, body=body, headers=headers,
                        **urlopen_kw) 
```

httplib

httplib.py：

```
def _send_request(self, method, url, body, headers):
    ...
    if body and ('content-length' not in header_names):
        self._set_content_length(body)
    ...

def _set_content_length(self, body):
    # Set the content-length based on the body.
    thelen = None
    try:
        thelen = str(len(body))
    except TypeError, te:
        # If this is a file-like object, try to
        # fstat its file descriptor
        try:
            thelen = str(os.fstat(body.fileno()).st_size)
        except (AttributeError, OSError):
            # Don't send a length if this failed
            if self.debuglevel > 0: print "Cannot stat!!"

    if thelen is not None:
        self.putheader('Content-Length', thelen)

    ...

def _send_output(self, message_body=None):
    ...
    if isinstance(message_body, str):
        msg += message_body
        message_body = None
    self.send(msg)
    if message_body is not None:
        #message_body was not a string (i.e. it is a file) and
        #we must run the risk of Nagle
        self.send(message_body)

    ...

def send(self, data):
    ...
    blocksize = 8192
    if hasattr(data,'read') and not isinstance(data, array):
        if self.debuglevel > 0: print "sendIng a read()able"
        datablock = data.read(blocksize)
        while datablock:
            self.sock.sendall(datablock)
            datablock = data.read(blocksize)
    else:
        self.sock.sendall(data) 
```

我的脚本.py：

```
#!/usr/bin/env python

from io import BytesIO

data = BytesIO()

print type(data.getvalue() 
```

**$./script.py**

**<类型'str'>**

我的解决方案：

```
#!/usr/bin/python

from urllib3 import HTTPConnectionPool, filepost
from io import BytesIO, SEEK_SET

pool = HTTPConnectionPool('web')

archive_name = '/var/archives/mock.tar.gz'

fields = {'uploadedfile' : (archive_name, open(archive_name).read())}

value, content_type = filepost.encode_multipart_formdata(fields)

headers = {'Content-Type' : content_type, 'Content-Length' : len(value)}

# or any temporary file. without Content-Length

data = BytesIO()

data.write(value)

data.seek(0, SEEK_SET)

resp = pool.urlopen('POST', '/upload/uploader.php', data, headers)

print resp.status 
```

**$./upload.py**

**200**

**/var/www/upload# ls**

**mock.tar.gz upload.html upload.php**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T13:38:54.503

尝试编码你的 message_body 字符串：

```
msg += message_body.encode('utf-8') 
```

当谈到 python 字符串和 unicode 时， [这篇文章真的帮助了我。](https://stackoverflow.com/a/5096928/589983)

# android - 为列表视图选择适配器

> ID：10372371
> 
> 赞同：0
> 
> 时间：2012-04-29T13:08:26.823
> 
> 标签：android, listview, adapter, choice

我知道有几个适配器来操作列表视图，如 ArrayAdapter、BaseAdapter、CursorAdapter 等，但我不知道如何选择最适合我需要的解决方案......我的意思是，当我选择适配器时，它们是在选择要使用的适配器之前我应该​​检查的标准？

每一种帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:35:57.357

适配器选择的主要问题是如何让数据填充列表。

如果数据来自数据库/游标，则应使用游标适配器之一。您*可以*使用数组适配器，但这只是在设置适配器之前将光标数据传输到数组的不必要的计算周期。

如果您的数据在数组中，那么您的明显选择是数组适配器类型之一。

如果您的数据来自不同的来源，您将需要创建自己的适配器或修改现有适配器之一。

在传入数据格式考虑之后可能会考虑列表修改以及哪个适配器最适合您修改列表（和/或支持它的数据）的任何需求。

# arrays - 为什么选择对象解析器而不是数组解析器

> ID：10372378
> 
> 赞同：0
> 
> 时间：2012-04-29T13:10:10.860
> 
> 标签：arrays, object, xml-parsing

我正在将 XML 文件解析为对象，但我想知道为什么，我不会选择 Array Parser 而不是 Object Parser？

它比数组解析器有更多的专业人士还是更少的对手？是否更灵活和可扩展？

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:16:55.433

我认为这完全取决于输入数据。如果您的应用程序需要大量简单的配置文件来存储单个对象的状态/设置，那么如果您使用 ObjectParser，则处理解析器输出的开销会更少。

但是，一旦您遇到需要存储实际对象集合（例如，要附加到某处的独立 GUI 控件列表）并且您经常阅读此类集合的场景，那么，如果您仍然使用 ObjectParser，您将不得不发明一个“集合”类并将此列表转换为实际数组。

# objective-c - NSDictionary allKeys 使我的应用程序崩溃？因为我不能使用数字键？

> ID：10372390
> 
> 赞同：0
> 
> 时间：2012-04-29T13:12:59.557
> 
> 标签：objective-c, json, nsdictionary

我有以下`["a","b"]`从 url 获取的json 字符串`http://mysite.com`。这是代码：

```
NSString *urlString = [NSString stringWithFormat:@"http://mysite.com"];
NSURL *url = [NSURL URLWithString: urlString];
NSData *dataresult = [NSData dataWithContentsOfURL:url];
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:dataresult options:kNilOptions error:&error];
NSLog(@"logging:%@", [json allKeys]); 
```

此代码的最后一行使我的应用程序因 SIGBRT 错误而崩溃。我注意到我似乎无法以数字索引作为键访问 NSDictionary 中的任何元素。

我只是想能够做 PHP 等价物：

```
echo $json[1]; //gives me a 
```

我打算用更复杂的数据对象加载我的 json，这些数据对象将通过数字键访问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T13:31:10.260

It's not an NSDictionary. You're retrieving NSArray and trying to ask NSArray to give you allKeys.

# c++ - 带有边缘检测的图像分割

> ID：10372391
> 
> 赞同：-2
> 
> 时间：2012-04-29T13:13:02.570
> 
> 标签：c++, opencv

我将此代码用于分段数字图像我使用轮廓检测​​但是当我尝试隔离每个我有黑色窗口的人时，有人知道问题是什么吗？

![在此处输入图像描述](../Images/4793a9b3bfee904a9ff137ec7f243ae1.png)

有代码执行的图像/

```
IplImage *img_cv = cvLoadImage("lena.jpg",CV_LOAD_IMAGE_GRAYSCALE);

if (!img_cv)
{
     printf("Failed to load image.\n");
     exit(1);
}
//cvSetImageROI(img_cv,cvRect(8,10,70,35));
IplImage *img_pl = cvCreateImage( cvGetSize(img_cv),img_cv->depth,img_cv->nChannels);

cvCopy(img_cv,img_pl, NULL);

//Smooth image
cvSmooth(img_pl, img_pl, CV_GAUSSIAN, 3, 0, 0, 0);        

// threshold image
cvThreshold(img_pl, img_pl, 150, 255, CV_THRESH_BINARY_INV);

//Morfologic filters
//Ouverture :érosion suivie d'une dilatation
cvErode(img_pl, img_pl, NULL,1);
cvDilate(img_pl, img_pl, NULL,1);

//Init variables for countours

  CvSeq* contour2;

contour2 = 0;

IplImage* img_contornos;
CvSeq* contourLow;
contourLow = 0;

//Duplicate image for countour
img_contornos=cvCloneImage(img_pl);

//Create storage needed for contour detection
CvMemStorage* storage2 = cvCreateMemStorage(0);

//Search countours in preprocesed image
cvFindContours( img_contornos, storage2, &contour2, sizeof(CvContour),
                          CV_RETR_EXTERNAL, CV_CHAIN_APPROX_SIMPLE, cvPoint(0, 0) );

//Optimize contours, reduce points
contourLow=cvApproxPoly(contour2, sizeof(CvContour), storage2,CV_POLY_APPROX_DP,0,1);

//For each contour found
for( ; contourLow != 0; contourLow = contourLow->h_next ){

//We can draw the contour of object
cvDrawContours( img_contornos, contourLow, CV_RGB(0,255,0), CV_RGB(0,255,0), -1, 0, 8, cvPoint(0,0) );

printf( " %d elements:\n", contourLow -> total );
for( int i = 0; i < contourLow -> total; ++i )
{
      CvPoint* pt = CV_GET_SEQ_ELEM( CvPoint, contourLow, i );
      // printf( "  %d,  %d", pt -> x, pt -> y );

      CvRect rect;
      CvPoint pt1, pt2;
      rect=cvBoundingRect(contourLow, NULL);
      pt1.x = rect.x;
      pt2.x = (rect.x+rect.width);
      pt1.y = rect.y;
      pt2.y = (rect.y+rect.height);
      cvRectangle(img_cv, pt1,pt2, CV_RGB(0,255,0), 1, 8, 0);
      IplImage *img_rect = cvCreateImage( cvGetSize(img_contornos),img_contornos->depth,img_contornos->nChannels);

      cvSetImageROI(img_contornos,cvRect(pt1.x,pt1.y,50,80));
             //cvCopy(img_contornos, img_rect, NULL);
             cvNamedWindow("segment",CV_WINDOW_AUTOSIZE);
              cvShowImage("segment",img_rect);
              cvResetImageROI(img_contornos);

}}

cvNamedWindow("pla",CV_WINDOW_AUTOSIZE);
cvShowImage("pla",img_cv);
cvResetImageROI(img_cv);
cvReleaseImage( &img_cv ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:16:16.713

```
#include <cv.h>

#include <highgui.h>

int main()
{
    IplImage* img_cv = cvLoadImage(your file name);

    if (!img_cv)
    {
        printf("Failed to load image.\n");

        exit(1);
    }
    IplImage *img_pl = cvCreateImage( cvGetSize(img_cv),8, 3);

    cvCopy(img_cv,img_pl, NULL);

    //Smooth image
    cvSmooth(img_pl, img_pl, CV_GAUSSIAN, 3, 0, 0, 0);        

    // threshold image
    IplImage *img_threshold_pl = cvCreateImage( cvGetSize(img_cv),8, 1);

    cvCvtColor(img_pl, img_threshold_pl, CV_BGR2GRAY);

    cvThreshold(img_threshold_pl, img_threshold_pl, 150, 255, CV_THRESH_BINARY_INV);

    cvErode(img_threshold_pl, img_threshold_pl, NULL,1);

    cvDilate(img_threshold_pl, img_threshold_pl, NULL,1);

CvSeq* contour2;

contour2 = 0;

IplImage* img_contornos = cvCreateImage(cvGetSize(img_cv), 8, 1);

CvSeq* contourLow;

contourLow = 0;

img_contornos=cvCloneImage(img_pl);

CvMemStorage* storage2 = cvCreateMemStorage(0);

cvFindContours( img_threshold_pl, storage2, &contour2, sizeof(CvContour),
                          CV_RETR_EXTERNAL, CV_CHAIN_APPROX_SIMPLE );

contourLow=cvApproxPoly(contour2, sizeof(CvContour), storage2,CV_POLY_APPROX_DP,0,1);

for( ; contourLow != 0; contourLow = contourLow->h_next ){

cvDrawContours( img_contornos, contourLow, CV_RGB(0,255,0), CV_RGB(0,255,0), -1, 0, 8, cvPoint(0,0) );

printf( " %d elements:\n", contourLow -> total );

for( int i = 0; i < contourLow -> total; ++i )
{
      CvPoint* pt = CV_GET_SEQ_ELEM( CvPoint, contourLow, i );

      // printf( "  %d,  %d", pt -> x, pt -> y );

      CvRect rect;

      CvPoint pt1, pt2;

      rect=cvBoundingRect(contourLow, NULL);

      pt1.x = rect.x;

      pt2.x = (rect.x+rect.width);

      pt1.y = rect.y;

      pt2.y = (rect.y+rect.height);

      cvRectangle(img_cv, pt1,pt2, CV_RGB(0,255,0), 1, 8, 0);

      cvSetImageROI(img_contornos,cvRect(pt1.x,pt1.y,50,80));

IplImage *img_rect = cvCreateImage( cvGetSize(img_contornos),img_contornos->depth,img_contornos->nChannels);

       cvCopy(img_contornos, img_rect, NULL);

             cvNamedWindow("segment",CV_WINDOW_AUTOSIZE);

              cvShowImage("segment",img_rect);

              cvResetImageROI(img_contornos);

}
}

cvNamedWindow("pla",CV_WINDOW_AUTOSIZE);

cvShowImage("pla",img_cv);

cvResetImageROI(img_cv);

cvReleaseImage( &img_cv );

cvWaitKey(0);

return 0;

} 
```

# android - 用于登录文件的 Android 最佳记录器

> ID：10372394
> 
> 赞同：5
> 
> 时间：2012-04-29T13:14:33.183
> 
> 标签：android, logging, slf4j, noclassdeffounderror

什么是在 Android 系统中完美用于将文本记录到文件中的最佳记录器框架？

我尝试使用 SLF4J-android 但出现异常

```
04-29 12:58:57.604: E/AndroidRuntime(372): java.lang.NoClassDefFoundError: org.slf4j.LoggerFactory 
```

这是我的代码：

```
public class Main extends TabActivity {
    private static final Logger log = LoggerFactory.getLogger(Main.class); 
```

我将 slf4j-android-1.6.1-RC1.jar 添加到构建路径中

会有什么问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-12T07:14:25.000

`slf4j-android`仅支持日志记录`logcat`，因此省略了常规 SLF4J jar 中的几个类。如果要使用 logback 记录到文件，则需要[API jar](http://search.maven.org/remotecontent?filepath=org/slf4j/slf4j-api/1.7.5/slf4j-api-1.7.5.jar)（不是`slf4j-android`）和[`logback-android`](http://tony19.github.com/logback-android/). 您正在寻找[`FileAppender`](http://logback.qos.ch/manual/appenders.html#FileAppender)or [`RollingFileAppender`](http://logback.qos.ch/manual/appenders.html#RollingFileAppender)。

## 指示：

1.  `slf4j-api-<version>.jar`将和添加`logback-android-<version>.jar`到您的类路径。

2.  在您的项目中创建文件`assets/logback.xml`（或使用`AndroidManifest.xml`...see [example](http://tony19.github.com/logback-android/)），其中包含以下配置：

```
<configuration>
  <appender name="FILE" class="ch.qos.logback.core.FileAppender">
    <file>/sdcard/testFile.log</file>
    <append>true</append>
    <encoder>
      <pattern>%-4relative [%thread] %-5level %logger{35} - %msg%n</pattern>
    </encoder>
  </appender>

  <root level="DEBUG">
    <appender-ref ref="FILE" />
  </root>
</configuration> 
```

*注意：由于指定路径在SD上，请务必使用[`WRITE_EXTERNAL_STORAGE`](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE)权限。您可以改为指定您已经具有写入权限的其他路径。*

您的 Java 代码（包含 SLF4J 日志记录调用）现在将级别或以上`DEBUG`级别的所有事件记录到`/sdcard/testFile.log`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:56:49.883

创建一个名为“libs”的文件夹并将 jar 放入该文件夹中。

# security - Magento 的热门搜索词中显示恶意搜索尝试？

> ID：10372402
> 
> 赞同：2
> 
> 时间：2012-04-29T13:15:52.440
> 
> 标签：security, magento

如果你去这里，你会在我的 Magento 商店遇到一整页的恶意搜索尝试：http: [//www.princessly.com/catalogsearch/term/popular/](http://www.princessly.com/catalogsearch/term/popular/)

我的问题是，如何防止恶意搜索短语出现在热门搜索词页面上，但仍然显示来自善意用户的合法搜索词？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T16:33:17.510

首先检查注入搜索词是否被评估，或者换句话说，seach 词是否被正确转义和过滤以防止 sql 注入。然后继续清理索引搜索词的数据库。接下来我会看看索引功能，如果你在搜索功能中有足够的 sql 注入和 xss 保护，你真的不需要担心这个（除非它占用了你的带宽，那么你可能想要调查将 IP 列入黑名单或主动搜索过滤，但会稍微复杂一些）。本质上您只想存储正确的查询，最简单的方法是只存储按字母顺序排列的查询，但这可能非常严格并且排除其他有效查询。相反，您可以使用黑名单和正则表达式检查，但这将更难实施和及时。最后，您可能希望在每个时间段内施加搜索限制，以及诸如用户代理检查之类的东西，以确保一个人实际上正在搜索。您也可以使用某种形式的验证码，但这可能会严重阻止用户广泛使用搜索功能，所以我不鼓励这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T17:11:23.623

**不要列出不返回结果**或仅返回“草率”匹配项的搜索。“恶意搜索”可能与您网站上的任何产品都不匹配，因此它们将被此规则排除在外。

此规则不要求您以任何方式识别搜索的特定形式（它不是黑名单），因此它是稳健的。此外，列出没有结果的普通搜索可能不会使您或您的客户受益，因此将它们排除在解决垃圾邮件问题之外将是一种改进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:03:01.087

可以以某种方式枚举恶意搜索词，因此当这种情况发生时，开发人员会构建一组正则表达式来检查输入的搜索词/查询是否干净，例如让我们将`' OR '1'='1`SQL 注入作为搜索输入：

目标：防止`' OR '1'='1`在数据库中被捕获。HOWTO：应用一个正则表达式，例如，`^'?1 (')? [Oo][Rr] (')?1(')?=1(')?$`如果该正则表达式返回 true，则阻止该术语被捕获，如果我们想添加更多被阻止的术语，我们可以做类似的事情`^('?1 (')? [Oo][Rr] (')?1(')?=1(')?)|(Other Regex)^`。但是，如果这些术语已经被捕获，那么清理数据库将是最好的解决方案，因为如果我们尝试在每次将要显示热门搜索词时进行正则表达式检查，网站性能会下降，所以我的建议是通过在流行术语表上运行正则表达式来清理数据库并删除具有恶意意图的行。

# android - 替代 Android 中的“FLAG_BLUR_BEHIND”？

> ID：10372404
> 
> 赞同：20
> 
> 时间：2012-04-29T13:15:58.297
> 
> 标签：android, dialog, android-activity, blur, android-windowmanager

我可以看到，当我使用与 API 演示中显示的相同的标志来模糊背景时，我收到一条警告说它已被弃用：

> “字段 WindowManager.LayoutParams.FLAG_BLUR_BEHIND 已弃用”。

我已经阅读过它，我发现“不再支持模糊”。

这是否意味着它将不适用于未来的版本？他们为什么反对它？有替代方案吗？我真的很喜欢这个功能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-30T09:09:37.217

好的，可能没有使用 API 的替代方法，除非我忘记了任何东西。

但是，我可以使用调光，这也很酷，如此[处](http://www.stealthcopter.com/blog/2010/01/android-blurring-and-dimming-background-windows-from-dialogs/)所述：

```
WindowManager.LayoutParams lp = dialog.getWindow().getAttributes();  
lp.dimAmount=0.0f;  
dialog.getWindow().setAttributes(lp);  
dialog.getWindow().addFlags(WindowManager.LayoutParams.FLAG_BLUR_BEHIND); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T14:59:03.453

**当心**

WindowManager.LayoutParams.FLAG_BLUR_BEHIND

**已弃用**..（至少在 Android 4.0 上它会导致背景黑屏...）

参考资料（来源）：http: [//developer.android.com/reference/android/view/WindowManager.LayoutParams.html](http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html)

> int FLAG_BLUR_BEHIND **此常量已弃用**。不再支持模糊。

```
public static final int FLAG_BLUR_BEHIND

Since: API Level 1
This constant is deprecated.
Blurring is no longer supported.

Window flag: blur everything behind this window.

Constant Value: 4 (0x00000004) 
```

真可怜.. :(（效果不错；））

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-25T06:33:14.117

我认为您应该尝试 ShowCaseView 库。用于突出显示 Android 上的元素。

ShowcaseView 库旨在通过独特且有吸引力的叠加层向用户突出和展示应用程序的特定部分。这个库非常适合指出用户的兴趣点、手势或晦涩但有用的项目。

Github 链接：[https ://github.com/amlcurran/ShowcaseView](https://github.com/amlcurran/ShowcaseView)

# ruby-on-rails - 重新启动安装了用户定义目录的 nginx

> ID：10372414
> 
> 赞同：0
> 
> 时间：2012-04-29T13:17:13.350
> 
> 标签：ruby-on-rails, nginx, passenger

我尝试使用 nginx 的命令，但我将其安装在 /home/user/nginx 文件夹中，而不是根目录下的默认系统文件夹中。但是我不能从那里命令 nginx。我怎么能那样做？任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:42:31.987

您可以通过发送`HUP`信号进行处理`kill -HUP `pidof nginx``。这应该重新加载配置，并重新启动乘客。

# facebook - 使用带有 Facebook Graph 的网络应用程序获取用户朋友

> ID：10372415
> 
> 赞同：0
> 
> 时间：2012-04-29T13:17:30.093
> 
> 标签：facebook, facebook-graph-api

我已经对这个问题进行了大量研究，但我无法找到一种方法来检索正在使用 Web 应用程序的用户的所有朋友。

我不相信 Graph Facebook Api 不能做到这一点。

拥有一个“user_token”，我可以检索所有朋友的列表，`https://graph.facebook.com/me/`但我仍然无法找到仅与使用应用程序的朋友一起做的方法。

我试过类似的东西，`https://graph.facebook.com/{ID_APP}/friends`但它根本不起作用。

我真的很感激一些帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T15:46:46.037

You have to make sure that you authenticate the friends that are using your app. You need to ask for a certain permission (check the documentation) in order to view the friendlist. When the users of your app granted your app access to read your friends, you should be able to successfully call [https://graph.facebook.com/](https://graph.facebook.com/){USER_ID}/friends. Dont forget to supply the granted access token of the user who uses your app!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T17:30:43.627

要获取用户好友列表（假设他们已连接到您的应用）：

`FB.api('/me/friends?fields=installed,id,name', function (response { window.console.log(response); });`

# php - get_headers() 尝试解析无法解析的主机时如何捕获错误？

> ID：10372416
> 
> 赞同：2
> 
> 时间：2012-04-29T13:17:37.020
> 
> 标签：php, header, http-headers

考虑以下：

```
$url = 'http://psyng.com/u/9716602b';
$headers = get_headers($url, 1);
print_r($headers); 
```

由于域 psyng.com 无法解析，因此此代码会导致：

```
Warning: get_headers(): php_network_getaddresses: getaddrinfo failed: 
No such host is known 
```

然后脚本停止运行。有没有办法让脚本的其余部分保持运行 - 换句话说：捕捉错误，并继续解析下一个 URL？所以像：

```
$url = 'http://psyng.com/u/9716602b';
$headers = get_headers($url, 1);
if ($headers == 'No such host is known') {
  // nevermind, just move on to the next URL in the list...
}
else {
  // resolve header stuff...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T13:23:30.293

该脚本不应停止运行，因为产生的消息只是一个警告。我自己测试了这个脚本，这就是我看到的行为。您可以在[文档](http://ca.php.net/get_headers)中看到`get_headers()`将`FALSE`在失败时返回，因此您的情况实际上应该是

```
if ($headers === FALSE) {
    // nevermind, just move on to the next URL in the list... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:00:43.223

函数 get_headers 返回一个布尔结果；print_r 的目的是以人类可读的格式返回布尔值。

```
<?php
$url = 'http://psyng.com/u/9716602b';
$headers = get_headers($url, 1);
if ($headers === FALSE) { //Test for a boolean result.
  // nevermind, just move on to the next URL in the list...
}
else {
  // resolve header stuff...
}
?> 
```

# mysql - 如何创建 MySQL 语句以将数组数据拆分为新的表格式

> ID：10372417
> 
> 赞同：3
> 
> 时间：2012-04-29T13:17:58.097
> 
> 标签：mysql, sql

我有旧表，数据存储为

```
tbl_id  tbl_data
--------------------
1       1,2,3,4,5,6
2       3,4,5 
```

现在我想将这些转换为多对多关系表。

```
user_id user_option
-------------------
1       1  
1       2
1       3
... 
```

基本上我在php中插入数据

```
$old = explode(",", $data['tbl_data']);
$query = $db->query("SELECT tbl_id, tbl_data FROM old_table"); 
  while($fetch = $db->fetch($query)) {
    $db->query("INSERT INTO new_table SET .....");
  } 
```

我可以知道，有没有办法用单个 MySQL 语句来完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:20:53.967

不，你最好用 PHP 代码来做。尽管 MySQL 确实有一种方法可以通过 定位值`FIND_IN_SET()`，但它没有一种等效的方法`explode()`可以轻松地将它们分开。可以在 MySQL 过程中编写很多丑陋的循环和字符串操作，但在 PHP 代码中*更容易*做到。

[在MySQL 字符串函数文档](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)下方的注释中有一些处理字符串拆分的建议，但它们并没有真正解决循环插入以规范化列。仅使用 PHP 之类的脚本语言处理确实更容易。

但是，您将其整理出来并正确规范化列是很好的。

# content-management-system - Orchard CMS 搜索和结果列表示例

> ID：10372421
> 
> 赞同：0
> 
> 时间：2012-04-29T13:18:35.123
> 
> 标签：content-management-system

我一直在使用 Orchard CMS 并一直在寻找一个具有类似于[http://www.microsoft-careers.com/search/](http://www.microsoft-careers.com/search/)的搜索工具的示例站点。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T15:54:57.463

I think you'd need to build a custom module for this - it could capture your information and then you could create views for the front-end for searching, filtering, etc.

# jquery - jQuery FancyBox、iFrame 和刷新父窗口中的选择？

> ID：10372422
> 
> 赞同：0
> 
> 时间：2012-04-29T13:18:47.423
> 
> 标签：jquery, ajax, codeigniter, fancybox

我正在创建一个购物车，我必须允许用户在系统中添加一个新地址。为此，我启动了一个 FancyBox（它加载了一个表单的 iFrame）。

当 FancyBox 关闭时，我想刷新一个地址选项列表（基本上，一个 AJAX 查询到一个准备好的页面）。我可以生成新列表没问题，但是我将如何刷新关闭 FancyBox 的选项（我很高兴清空列表并将它们全部重新加载到其中）？

感谢您的时间。

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:30:06.310

如果您关闭窗体、iFrame 和fancybox，它实际上并不在父窗口中，是吗？

要将某些内容绑定到 fancybox 关闭事件，请执行以下操作：

```
$("#elementID").fancybox({
    onClosed: function() {
        //generate new list here
    });
}); 
```

将 onClosed 处理程序添加到您的 fancybox 实例，该函数将在 fancybox 关闭时执行。

# c - fscanf 的奇怪输入

> ID：10372423
> 
> 赞同：1
> 
> 时间：2012-04-29T13:18:52.027
> 
> 标签：c, scanf

我正在尝试使用 fscanf 读取文本文件。输入文件如下所示：

```
1
Test
0
32.1 
```

除了作为随机值读取的第一个整数之外，所有内容都可以正常读取。

我的代码：

```
while((fgets(string,64,fp) != NULL)){
    fscanf(fp, "%i\n", &tid);
    fscanf(fp, "%s\n", name);
    fscanf(fp, "%d\n", &stat);
    fscanf(fp, "%f\n", &per);
    printf("%d %s %d %f", tid, name, stat, per);
    } 
```

输出：

```
11281472 Test 0 32.0999982 
```

有谁知道我做错了什么？

整个函数供参考：

```
Task *readData(Task *strt, char *fname){
    #ifdef DEBUG
        fprintf(stderr, "Entered Data import method\n");
    #endif
    char name[30];
    int tid, stat;
    float per;

    FILE *fp;
    fp= fopen(fname, "r");

    if(fgetc(fp) == EOF){
        printf("File is empty");
    }
    else{
    while(!feof(fp)){

        fscanf(fp, "%i\n", &tid);
        fscanf(fp, "%s\n", name);
        fscanf(fp, "%d\n", &stat);
        fscanf(fp, "%f\n", &per);
        printf("%d %s %d %f", tid, name, stat, per);
        strt = AddB(strt, tid, name, stat, per);
        }
    }
    return (strt);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:22:06.240

`fgets`读取（使用）输入文件中的第一个字符串，然后首先`fscanf`尝试将“Test”解析为“%i”格式并失败。

您可以[`feof`](http://pubs.opengroup.org/onlinepubs/009695399/functions/feof.html)在 while 循环中使用 as 条件，但是（感谢 John Bode）最好检查每个 fscanf 并使用标志或`break`.

每个`fscanf`返回一个值。如[1](http://pubs.opengroup.org/onlinepubs/007904975/functions/scanf.html)所述：

> 返回值
> 
> 成功完成后，这些函数将返回成功匹配和分配的输入项的数量；如果发生早期匹配失败，此数字可以为零。如果输入在第一次匹配失败或转换之前结束，则返回 EOF。如果发生读取错误，则设置流的错误指示符，返回 EOF，并设置 errno 以指示错误。

因此，您可能需要检查每个 fscanf 的返回值，以了解出现（读取）错误。

更新：您永远不应该使用 fgets/fgetc 来检查某些东西（不使用 倒带`fseek`或撤消`ungetc`），因为每个文件读取函数都会从文件中读取数据（文件中的当前位置将增加）。要检查错误，只需查看用于解析输入的常用 fscanf/其他函数的返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:23:35.380

您没有检查每个呼叫是否失败，因此您无法知道发生了什么。

（我对此进行了编辑以删除 %i 无效的断言，抱歉）

# android - Android facebook-sdk 签名安全

> ID：10372427
> 
> 赞同：3
> 
> 时间：2012-04-29T13:20:07.440
> 
> 标签：android, facebook, security

我们一直在我们的 android 应用程序中实现 Facebook Android SDK，它需要将应用程序签名存储在 facebook 服务器上，以便可以验证从应用程序到 facebook 的调用。我们想将此系统用于我们自己的后端，以确保它仅被我们的应用程序使用，对此我有以下问题：

（参考[https://github.com/facebook/facebook-android-sdk/tree/master/facebook/src/com/facebook/android](https://github.com/facebook/facebook-android-sdk/tree/master/facebook/src/com/facebook/android)找到相关类）

1.  显然，要通过匹配签名来验证调用，需要将应用程序的签名发送到服务器。在 sdk 中，我似乎无法找到这是在哪里完成的？
2.  好像没有使用https，对吗？（实用程序.java）
3.  难道不能嗅探签名使整个系统毫无意义吗？
4.  Facebook.java 在文件底部保存 facebook 应用程序的签名。改变这一点似乎微不足道。但是，据我了解，发送 Intent 的应用程序的签名可以通过该 Intent 解决。Android 系统对此进行管理，因此无法伪造签名。但是，在调用 url 时，Android 系统能否以不可变的方式将签名添加到协议中？我猜不是，这让我对上述问题感到好奇。

[编辑回复 nitzan & zapl]

我要实现的目标与 facebook sdk 要求您将签名存储在其服务器上的原因相同；确保对我们后端的调用是从我们的应用程序发送的，而不是其他任何东西。我们不想让机器人或其他应用程序访问我们的服务器 API。facebook sdk 有方法来检查 Intent 是否来自 Facebook 应用程序，这是安全的，因为 Android 系统对签名和 Intent 的封闭管理。解决此问题的唯一方法是运行修改后的 Android 版本，该版本允许覆盖应用程序签名，但人们构建和运行的几率可以忽略不计。但是，运行应用程序、嗅探通过非 https 协议发送的签名并构建使用此签名和 api 调用的应用程序不是。似乎使这样一个系统工作的唯一方法是使用 https，

请注意，我在上面描述的 Intent 验证方法与对 facebook 服务器的 url 调用不同。Intents 用于让设备上的 Facebook 应用程序与实现 SDK 的应用程序进行通信。Android 系统确保与传入 Intent 一起发送的 Facebook 应用程序的签名不会被伪造，因此 Facebook 应用程序->应用程序通信系统是安全的。与这个内部系统相反，我的问题是关于到服务器的传出 url 调用的外部系统，如果签名可以在调用中不可变地发送，这将是安全的，基本上实现与 Intent 系统相同的系统。

[编辑 2]

与我们假设的相反，事实证明应用签名很容易获取。虽然应用程序需要使用私有开发人员密钥进行签名，但这不会损害 Android 上应用程序的安全性，但它显然不能用于验证 api 调用服务器端。

这就引出了更多问题：

1.  为什么 Facebook 实施这个系统，而它很容易被攻破？
2.  是否有任何其他已知的实现来限制服务器 api 仅访问特定应用程序？（混淆除外）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:55:31.890

1.  我不知道。
2.  是的，它似乎正在替换`fbconnect://`Uri，`http://`这意味着使用此代码的连接没有加密。
3.  我想是的，试着验证一下。
4.  改变它是没有问题的，你可以反编译apks，改变一些代码，如果你愿意，可以将它们编译回来。你唯一不能做的就是再次签署apk（你缺少所需的密钥）。或者您可以在自己的代码中使用签名。
    您的应用程序的签名检查发生在安装时，如果您的签名不符合要求，您在清单中请求的权限将被删除。如果您更新您的 apk，新 apk 的签名将与旧的现有 apk 进行检查，如果签名不匹配，升级将失败。但是你可以卸载旧的并安装你的假的。
    如果您从您的应用程序发送和 Intent，系统可能包含发件人的包，您无权更改它。

而且对服务器进行验证的全部目的最终并不是安全问题，因为没有防弹的方法来验证应用程序。它用于使其他人更难滥用 API，并用于跟踪谁在使用该 API。

身份验证机制要求您的 apk 中有某种密钥。但是，由于您将该 apk 发送给潜在的邪恶客户，因此您无法再控制它，并且可能会提取密钥并滥用它。您所能做的就是混淆密钥，以便更难获得它。但这最终是不可能的。

* * *

因此，假设您有一个与您的后端服务器通信的应用程序，并且我将您的应用程序下载到我的设备上。然后我可以`.apk`从我的设备上取下来，反编译它并找到与你的服务器的通信是如何工作的——在创建 https 之前的明文。我还可以看到您的应用程序的签名是什么，它存储在设备上的 xml 文件和 apk 中。然后我要么修改你的应用程序，要么创建一个新的应用程序，它使用这些信息的行为与你的完全一样，只是它不是你的应用程序。使用 https 没问题，我也可以给你发你想要的签名。

你无法阻止这种情况发生。你只能让它很难做到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T17:27:48.997

为了验证在不受信任的设备上运行的应用程序，服务器必须执行一些操作，例如要求来自应用程序的通信使用只有应用程序持有的密钥进行数字签名。

应用程序作者必须在应用程序中隐藏密钥，以便相对难以提取以用于冒名顶替者。但不能让它无法提取。

拥有应用程序提取密钥的冒名顶替者不应仅基于此能够伪装成任意用户，但它可以允许具有真实密码的真实用户从应用程序的伪装版本（有意或无意）登录. 请注意，对于旨在简单地从不知情的用户那里窃取密码的虚假应用程序而言，实际上能够登录服务器可能不是必需的。

SSL 对保护应用程序本身没有什么价值，因为应用程序可以安装在 SSL 损坏的平台上，或者修补以破坏内部 SSL 实现以完成拦截。但是，有效的 SSL 可以帮助保护未受损设备上的应用程序用户。

# java - 安装 netbeans 7.1.2 后，我的所有 Java JRE 和运行任何程序的能力都崩溃了

> ID：10372432
> 
> 赞同：0
> 
> 时间：2012-04-29T13:21:02.323
> 
> 标签：java, netbeans-7

我昨天在我的电脑上安装了 Netbeans 7.1.2，它使所有 java 功能崩溃。我选择升级是因为我在这台 PC 上安装的 7.1 beta IDE 无法识别 treeset 功能中的菱形。

我安装了几个版本，包括 jre 5、12，这是旧程序运行所必需的。我现在不能不安装任何版本。我收到提示，表明我需要 jre 1.6.0_23.msi。我没有要安装的 .msi 文件，它只是 java 可执行文件。我找不到这个 msi 文件来欺骗安装。我也找不到指向安装程序指向的位置的注册表项。它是一个没有指定文件夹的网络驱动器。(\E10001081)。

这里有人对清理损坏的java安装有什么建议吗？如果我尝试在添加/删除程序 (XP PRO) 中删除 SDK 或 JRE，我会收到一个致命错误，而其余的程序则无法找到。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:41:36.947

您可以在 Oracle 的网站 [http://www.oracle.com/technetwork/java/archive-139210.html上找到所有以前版本的 Java](http://www.oracle.com/technetwork/java/archive-139210.html)

我将首先卸载所有可以卸载的版本，然后再次安装我需要的所有版本，从最旧到最新。

# mysql - 在 ANTLR 中编写 SQL 解析器有哪些挑战？

> ID：10372437
> 
> 赞同：4
> 
> 时间：2012-04-29T13:22:32.090
> 
> 标签：mysql, sql, parsing, antlr, yacc

我正在尝试定义时间表并估计实现 MySQL SQL 方言的 ANTLR 解析器所需的工作量。基本上，它归结为将 YACC 解析器语法从 MySQL 版本 ( `sql_yacc.yy`) 转换为 ANTRL 语法。

只是看起来如此直截了当吗？我发现语言语法的某些领域可能需要更多的开发和测试：

*   ANTLR 不接受左递归
*   数字文字将需要自定义 Java 代码来根据值转换类型
*   ...

您知道、遇到或期待的任何其他挑战？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T02:36:59.880

在这样做之前，您应该知道这是一项无法在几天或几周内完成的工作，而是在几个月内完成。这是一个 sql 解析器库，您可以在创建自己的解析器时参考。

[http://www.sqlparser.com/](http://www.sqlparser.com/)

# java - 在 Java 中使用 FFMPEG（在 Mac 上开发）

> ID：10372439
> 
> 赞同：2
> 
> 时间：2012-04-29T13:22:48.610
> 
> 标签：java, playframework, ffmpeg

我试图直接在我的 Java 代码中调用 FFMPEG（在 Playframework 下运行！）。最终产品将在 Linux/Debian 发行版上运行，但我首先需要在我的 Mac 上进行测试（我不知道它是否可以在 Debian 上运行）。

我尝试执行简单的代码：

```
Process pr = Runtime.getRuntime().exec(new String[]{"bash","-c", "ffmpeg"}); 
```

或更简单：

```
Process pr = Runtime.getRuntime().exec("ffmpeg") 
```

或使用 ProcessBuilder：

```
Process pr = new ProcessBuilder("/opt/local/bin/ffmpeg").start(); 
```

我得到的是错误代码 133，但我找不到这意味着什么。在终端中，该命令给出正常输出。我也可以用例如“ls -la”替换“ffmpeg”并获取目录列表。但是我不知道ffmpeg不起作用的问题是什么。

有人有任何线索吗？谢谢！

更新：我查看了错误流。这些是我得到的错误。它如何在终端中工作，但在使用 Java 时却不行？

```
14:43:19,619 DEBUG ~ FFMPEG: dyld: Library not loaded: /opt/local/lib/libogg.0.dylib
14:43:19,619 DEBUG ~ FFMPEG:   Referenced from: /opt/local/bin/ffmpeg
14:43:19,619 DEBUG ~ FFMPEG:   Reason: Incompatible library version: ffmpeg requires version 9.0.0 or later, but libogg.0.dylib provides version 6.0.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:42:31.367

我使用 Xuggle 进行视频编码，它恰好包含一个旧版本并且在类路径中。尽管显示的链接来自较新的，但它使用的是较旧的。

# c# - 如何覆盖 .NET 类

> ID：10372443
> 
> 赞同：2
> 
> 时间：2012-04-29T13:24:28.967
> 
> 标签：c#, class, overriding

作为一个例子，我试图`GetResponse()`改变`HttpWebRequest`

```
class HttpWebRequest_Override : HttpWebRequest
{
    public HttpWebRequest_Override(System.Runtime.Serialization.SerializationInfo SerializationInfo, System.Runtime.Serialization.StreamingContext StreamingContext) 
        : base(SerializationInfo, StreamingContext) { }

    public override WebResponse GetResponse()
    {
        //Edit GetResponse() code here.
    }
} 
```

但是我找不到`GetResponse()`任何地方的标准代码。我应该从头开始写一个吗？我想复制+粘贴原始代码，然后对其进行更改。我已经尝试过查看[这里](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.getresponse.aspx)，但这并没有太大帮助。

为了测试我是否走在正确的轨道上，我注释掉`GetResponse()`并尝试按`HttpWebRequest_Override`原样使用（只有构造函数）。

然后像这样使用它：

```
public static string DownloadText(string url)
{
    try
    {
        var request = (HttpWebRequest_Override)WebRequest.Create(url);
        request.Proxy = null;
        var response = (HttpWebResponse)request.GetResponse();

        using (var reader = new StreamReader(response.GetResponseStream()))
        {
            return reader.ReadToEnd();
        }
    }
    catch (Exception ex) { return "error_program : "+ex.Message; }
} 
```

但这会引发错误：

```
Unable to cast object of type 'System.Net.HttpWebRequest' to type 'bulktest.HttpWebRequest_Override'. 
```

所以两个问题：

为什么类不工作，我在哪里可以找到 .NET 类的代码以便我可以更改它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:29:53.753

WebRequest.Create doesn't create an instance of your class, it creates an instance of HttpWebRequest, which you derive from. While you can cast an instance of a child as it's parent, you can't cast an instance of the parent as the child. The parent isn't guaranteed to have all of the methods of the child, whereas the child is guaranteed to have to the methods of the parent.

You can register custom protocols that are handled by your own, derived class or, via configuration, register your class to handle the default protocols. Whether you need to do this is an open question. From your example, a simple wrapper might be sufficient. The wrapper would take a HttpWebRequest instance in the constructor and delegate the standard WebRequest methods to that instance. Any new methods would use the underlying instance's methods for their work and layer your additional functionality on top of it.

EX:

```
 var request = new WebRequestWrapper((HttpWebRequest)WebRequest.Create(url));
 var html = request.DownloadText(); 
```

Where your class might look like:

```
 public class WebRequestWrapper
 {
      private HttpWebRequest _request;

      public WebRequestWrapper(HttpWebRequest request)
      {
          this._request = request;
      }

      public string DownloadText()
      {
          using (var response = (HttpWebResponse)this._request.GetResponse())
          using (var reader = new StreamReader(response.GetResponseStream()))
          {
              return reader.ReadToEnd();
          }
      }
 } 
```

FWIW, I don't like catching the exception and returning a string. I'd rather let the exception bubble up since the method returns a string.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T13:28:28.793

可以通过 .config 文件“注入”自定义 Web 请求类型。

看看这里：http: [//msdn.microsoft.com/en-us/library/bc0fhzk5.aspx](http://msdn.microsoft.com/en-us/library/bc0fhzk5.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T13:30:54.660

You can browse .NET Framework source in different ways, for example, via .NET Reflector. But you can also see it online - for example, here's the source of `HttpWebRequest.GetResponse()`:

[http://typedescriptor.net/browse/members/326374-System.Net.HttpWebRequest.GetResponse()](http://typedescriptor.net/browse/members/326374-System.Net.HttpWebRequest.GetResponse%28%29)

As noted by others, you don't have to copy-paste the original code. But it's still good to know how it works.

# orm - 在 Symfony2 中非破坏性地删除实体

> ID：10372447
> 
> 赞同：11
> 
> 时间：2012-04-29T13:24:51.573
> 
> 标签：orm, symfony, doctrine-orm

在 Symfony 2 中是否有一种好的、干净和简单的方法可以非破坏性地删除实体？我想给我的管理员一个取消删除项目的机会，同时尽可能少地牺牲框架提供的自动化。

如果没有内置解决方案或第三方捆绑包可以帮助我，那么最好的方法是什么？向实体添加`deleted`属性需要大量添加逻辑以防止它们弄乱由创建的控制器`doctrine:generate:crud`，所以也许它们应该以序列化形式存储在单独的表中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-29T13:29:14.240

What you want is Soft Delete. There is a [Doctrine extension](https://github.com/l3pp4rd/DoctrineExtensions/blob/master/doc/softdeleteable.md) for that and a [bundle](https://github.com/stof/StofDoctrineExtensionsBundle) to integrate it with Symfony.

# symfony - Symfony2 - 输入字段的教义自动转义

> ID：10372450
> 
> 赞同：2
> 
> 时间：2012-04-29T13:25:24.693
> 
> 标签：symfony, doctrine, escaping

我将 Symfony2 版本 2.0.5 与捆绑的 Doctrine ORM 解决方案一起使用。由于我将环境从 dev 更改为 prod，因此在持久保存到数据库时，我的所有表单输入都被转义了。现在我知道这是防止 sql 注入的正确行为，但是在取回数据时，字符串不会被转义。因为我直接将 JSON 字符串保存到数据库，这给我带来了很大的问题。此外，每次我更新此数据时，字符串都会一次又一次地转义。我的问题是，我可以停用某些字段的转义吗？或者我可以在从数据库中获取值时对这些值进行转义吗？为什么这只发生在生产环境中？这是故意的吗？

最好的问候，大卫！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:34:31.070

这可能是由 PHP 配置引起的——而不是由 Symfony 或 Doctrine 引起的。在`php.ini`中，找到以 开头的所有选项`magic_quotes_`并将它们设置为 `Off`。不要忘记重新启动服务器。

# android - 如何以编程方式添加到布局复合组件Android？

> ID：10372451
> 
> 赞同：2
> 
> 时间：2012-04-29T13:25:25.163
> 
> 标签：android, android-layout, view, custom-component

我创建了一个`Box`要添加到布局中的复合组件。`Box`xml:

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayoutForBlock"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical">
    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" android:background="@drawable/screen_background" android:layout_marginLeft="5dp" android:layout_marginTop="5dp">
        <ImageButton
            android:id="@+id/imageButtonContent"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_gravity="center_horizontal"
            android:scaleType="fitCenter"
            android:src="@drawable/beach_bed" android:background="@drawable/buttonbackground" android:clickable="true" android:layout_margin="5dp" android:contentDescription="@string/sample_text"/>
        <TextView
            android:id="@+id/textViewContent"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:text="@string/sample_text"
            android:textColor="@color/deep_blue" android:layout_margin="5dp"/>
    </LinearLayout>
</merge> 
```

`Box`班级：

```
public class Box extends LinearLayout  {

    private TextView textContent;
    private ImageView imageContent;

    public Box(Context context, AttributeSet attrs) {
        super(context, attrs);
        ((Activity)getContext()).getLayoutInflater().inflate(R.layout.box, this);
        setupViewItems();
    }

    private void setupViewItems() {
        textContent = (TextView) findViewById(R.id.textViewContent);
        imageContent = (ImageView) findViewById(R.id.imageButtonContent);
    }

    public void setTextContent(String text) {
        this.textContent.setText(text);
    }
    public void setImageContent(String tag) {
        this.imageContent.setContentDescription(tag);
    }
} 
```

`Box`如果我将 xml 添加到主 xml 文件中，一切正常，例如：

```
<com.mypackage.alexey.Box
android:id="@+id/mybox"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal"
/> 
```

问题是我想以编程方式创建许多盒子，如下所示：`Box mybox= new Box();`. 怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-29T18:44:10.327

我建议你也实现`LinearLayout`只需要 a的构造函数`Context`：

```
public Box(Context context) {
    super(context);
} 
```

然后在你的`Activity`，当你想添加一个新的`Box`，实例化`Box`类并将其添加到你的布局中：

```
// I assumed you have a LinearLayout to which you want to add your Box
LinearLayout parent = (LinearLayout) findViewById(R.id.parent_id);
//create the Box and added to the parent above
Box theBox = new Box(this); // if you are in an Activity
//some LayoutParams to replicate your xml attributes
LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT);
// set the Orientation for the Box
theBox.setOrientation(LinearLayout.HORIZONTAL);
//add the Box
parent.addView(theBox); 
```

# jquery - jQuery 插件两次在一个 HTML 页面中

> ID：10372452
> 
> 赞同：0
> 
> 时间：2012-04-29T13:25:26.173
> 
> 标签：jquery, fancybox

我想知道是否有人可以帮助我。

我已经编写了一个脚本来创建[这个](http://www.mapmyfinds.co.uk/development/testing.php)图片库页面。我正在使用“fancyBox”来创建幻灯片和一个 jquery 演示，我已经对其进行了调整以提供删除功能。

我遇到的问题是他们都需要`jquery-1.7.2.min.js`在我的脚本的这一部分中使用：

```
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.19.custom.min.js"></script>
<script type="text/javascript" src="fancybox/lib/jquery-1.7.2.min.js"></script> 
```

这会导致冲突，如果只包含一个，我只能运行没有错误的页面。

我对 jQuery 真的很陌生，我什至不确定这是否可能。但是有人可以告诉我，是否可以将两者一起运行以及我如何才能做到这一点。

非常感谢和问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:28:08.667

你不需要两者。仅使用其中一个就可以正常运行。删除哪个并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:35:08.863

Jquery 是一个用于简化 javascript 编程工作的库，因此，您只需要在所有依赖它的脚本之前包含它一次！

**使用您的代码：**

```
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.19.custom.min.js"></script>
<script type="text/javascript" src="path_to_fancybox_script.js"></script>
<script type="text/javascript" src="path_to_another_script.js"></script> 
```

你应该从他们的网站上阅读一些关于 Jquery 的信息：http: [//jquery.com/](http://jquery.com/)

既然是新手，也可以了解一下： http: [//www.learningjquery.com/](http://www.learningjquery.com/)

# bash - 如果该行不重复，如何在显示提示之前附加到 bash 历史记录？

> ID：10372454
> 
> 赞同：0
> 
> 时间：2012-04-29T13:25:54.730
> 
> 标签：bash

因为在关闭并且不关闭 gnome 终端时似乎经常没有保存历史记录，所以如果该行不重复，我想在显示提示之前附加到 bash 历史记录。虽然我`export HISTCONTROL=ignoreboth`在 .bashrc 中，这应该意味着被忽略，但它似乎不起作用，因为我仍然在 bash_history 中得到重复项。那么如何做到这一点呢？

提供进一步的指示，虽然不是解决方案：我认为 $PROMPT_COMMAND 需要有`"$(history 1)" (if_not_duplicate) >> ~/.bash_history`

但是 $(history 1) 需要更改，以便实际的命令得到输出，而不是历史条目，例如，它有行号。

如果它们已经插入，这将删除不相邻的重复项。

```
perl -nei '$H{$_}++ or print' ~/.bash_history 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:30:41.857

You need `erasedups` too if you want to remove duplicates from the history.

```
export HISTCONTROL=ignoreboth:erasedups 
```

does the trick for me.

# css - 为什么 html5 样板图像替换在这里不起作用？

> ID：10372458
> 
> 赞同：1
> 
> 时间：2012-04-29T13:26:14.917
> 
> 标签：css, html5boilerplate, image-replacement

[http://jsfiddle.net/hydroplane/r4Kn6/](http://jsfiddle.net/hydroplane/r4Kn6/)

我需要将“reblog”文本移出屏幕。有人知道为什么 h5bp .ir 类在这里不起作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T13:34:38.100

在 css 中替换这个

```
.my-like:hover{ background-position: 0 50%; 
```

和

```
.my-like:hover{ background-position: 0 50%; } 
```

因为你没有壁橱 .my-like:hover

你可以在这里看到它 [http://jsfiddle.net/r4Kn6/3/](http://jsfiddle.net/r4Kn6/3/)

# wpf - 在 WPF 应用程序中放置和配置 IoC 容器的位置？

> ID：10372463
> 
> 赞同：17
> 
> 时间：2012-04-29T13:27:27.343
> 
> 标签：wpf, inversion-of-control, unity-container, containers, where

我正在开发一个中型 WPF 应用程序 (MVVM)，该应用程序将来应该是可扩展和可维护的。因此，我决定使用 IoC 容器（在本例中为 Unity）来保持灵活性。

但是我不确定在 WPF 应用程序中放置和配置 Unity 的位置。

我猜容器应该可以全局访问，所以它可能应该去 Application 类。但是我应该把它作为静态属性吗？我应该在 Application_Startup() 事件处理程序中配置它吗？

例如：

```
/// <summary>
/// Interaction logic for App.xaml
/// </summary>
public partial class App : Application
{
    public static UnityContainer MyUnityContainer;

    private void Application_Startup(object sender, StartupEventArgs e)
    {
        // instantiate and configure Unity
    }
} 
```

这样我就可以通过静态属性从应用程序中的任何位置访问容器：

```
App.MyUnityContainer 
```

我想这是一种方法，但我不确定是否有更好的做法来解决这个问题，特别是针对 WPF 应用程序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-30T06:58:23.463

看看[Composition Root Pattern](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)。您要做的是在您的 Startup 事件处理程序中对其进行初始化，并在应用程序的其余部分忘记它的存在。

您正在尝试实施[Service Locator Pattern](http://en.wikipedia.org/wiki/Service_locator_pattern)，根据许多人的说法，这对于这个问题[来说是一个较差的解决方案](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-16T12:17:44.730

让我发布我的结论，希望它能帮助人们。如有不对请指正！:P

我想我们会研究这样的事情：

```
/// <summary>
/// Interaction logic for App.xaml
/// </summary>
public partial class App : Application
{
    private void Application_Startup(object sender, StartupEventArgs e)
    {
        UnityContainer myUnityContainer = new UnityContainer();
        //make sure your container is configured
        myUnityContainer.RegisterType<ISomeDependency, SomeDependencyImplementation>();
        myUnityContainer.RegisterType<IMainWindow, MainWindow>();

        myUnityContainer.Resolve<IMainWindow>().Show();
    }
}

public partial class MainWindow : Window, IMainWindow
{
    private ISomeDependency _someDependency;

    public MainWindow(ISomeDependency someDependency)
    {
        _someDependency = someDependency;
    }
} 
```

请注意，没有全局变量或单例，只要 MainWindow 存在，容器就会继续存在，并且只要容器知道它们，该入口点后面的所有依赖项就会自动解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-28T04:28:46.863

根据 Unity 容器的新版本，我们还必须注册它自己的实例，以便通过构造函数注入在视图模型中获取它。

**App.xaml.cs 文件：**

```
protected override void OnStartup(StartupEventArgs e)
{
       var unityIoC = new UnityContainer();
       unityIoC.RegisterTypes(AllClasses.FromAssembliesInBasePath(), WithMappings.FromMatchingInterface, WithName.Default);
       unityIoC.RegisterInstance(typeof(IUnityContainer), unityIoC);
} 
```

**查看模型类**

```
[InjectionConstructor]
public MyViewModel(IUnityContainer container)
{
} 
```

现在统一容器将在视图模型中可供我们使用，并可用于解析。

# c++ - 使用数据库结构的简单程序中未声明的标识符错误

> ID：10372465
> 
> 赞同：-3
> 
> 时间：2012-04-29T13:27:47.140
> 
> 标签：c++, compiler-errors

我的编译器不会编译我编写的以下程序。它在我标记的行中给出了一个错误，指出“未声明标识符”，即使我已经在我的 Main() 函数中声明了它。

该程序是不完整的，但它将接受有关活动的输入并输出它。

```
#include <iostream.h>
#include <conio.h>

void addToLog();
void viewLog();

void what()
{
    cout << "What would you like to do?" << endl
         << "1\. View Today's Log" << endl
         << "2\. Add to Today's Log" << endl
         << "__________________________" << endl << endl
         << "? -> ";

    int in;

    cin  >> in;

    if ( in == 1 )
    {
        viewLog();
    }

    if ( in == 2 )
    {
        addToLog();
    }

}

void main()
{
    clrscr();

    struct database
    {
        char act[20];
        int time;
    };

    database db[24];

    what();

    getch();
}

void addToLog()
{
    int i=0;
    while (db[i].time == 0) i++;

    cout    << endl
        << "_______________________________"
        << "Enter Activity Name: ";
    cin     >> db[i].act;                           // <-------------
    cout    << "Enter Amount of time: ";
    cin >> db[i].time;
    cout    << "_______________________________";

    what();

}

void viewLog()
{
    int i=0;
    cout    << "_______________________________";
    for (i = 0; i <= 24; i++)
    {
        cout    << "1\. " << db[i].act << "   " << db[i].time << endl; // <-------
    }
    cout    << "_______________________________";

    what();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T13:29:36.673

You have declared `db` as a local variable in `main()`; it cannot be seen by other functions.

There are at least two solutions:

1.  Make `db` a global (static) variable - i.e. move its declaration/definition out of `main()`. **This is generally not recommended, as it's usually poor practice to rely on global variables too much.**
2.  Pass a pointer to `db` into functions that need it.

# ios - Wrong button image on iPad device but not in the simulator

> ID：10372469
> 
> 赞同：0
> 
> 时间：2012-04-29T13:28:30.360
> 
> 标签：ios, xcode, image, ipad, retina-display

I am updating my universal app and naming my image files as follows:

```
buttonHelp.png
buttonHelp@2x.png
buttonHelp~iPad.png
buttonHelp@2x~iPad.png 
```

This works fine on the simulator, but on my device (classic iPad running iOS 5.1) only buttonHelp.png shows up! (I have also tried "ipad" instead of "iPad").

Any suggestions?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T14:54:19.777

文件名区分大小写，必须使用小写 ~ipad 和 @2x~ipad

```
buttonHelp.png
buttonHelp@2x.png
buttonHelp~ipad.png
buttonHelp@2x~ipad.png 
```

通过从您的设备中删除已安装的版本、进行干净的构建并重新安装，仔细检查 XCode 是否确实在传输文件。

还要检查项目设置中“构建阶段”的“复制捆绑资源”部分中列出的每个文件。

参考：

> 标准：<ImageName><device_modifier>.<filename_extension>
> 
> 高分辨率：<ImageName> **@2x<device_modifier>** .<filename_extension>

[http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreens/SupportingHiResScreens.html](http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreens/SupportingHiResScreens.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:34:51.133

可能 buttonHelp@2x~iPad.png 应该是 buttonHelp~iPad@2x.png。

**编译器会在文件名末尾**使用@2x 获取所有图像以用于视网膜显示。但是，如果找不到该图像，则它应该默认为非视网膜版本。

您是否尝试过摆脱文件名中的波浪号？

# c++ - OpenMP for C++ class variables

> ID：10372470
> 
> 赞同：1
> 
> 时间：2012-04-29T13:28:59.237
> 
> 标签：c++, parallel-processing, openmp, class-variables

In c++ When we parallelize the loop using OpenMP directives, how should we do if we use a instance of the class in the loop and want to keep some members of the class to be private across all threads and others to be shared ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T16:34:53.337

非静态类成员不能单独选择为私有或共享。您只能使整个类对象共享或私有。

# javascript - Flexible layout with fixed width sidebar

> ID：10372471
> 
> 赞同：1
> 
> 时间：2012-04-29T13:29:12.613
> 
> 标签：javascript, jquery, css, layout

I need to a create a flexible layout similar to this [http://jsfiddle.net/Lu9gQ/12/](http://jsfiddle.net/Lu9gQ/12/)

With these following properties:

*   header as in the example
*   the "left" must have: width = ( 100% - #sidebar's width ), and height = ( 100% - #header's height )
*   the "sidebar" must have a fixed width and height = ( 100% - #header's height )
*   the layout must be flexible only if the window'width is greater than a fixed width

    ```
    Is there any way to do it? 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:30:05.300

我已经使用 jquery 和一些 js 编写了一个解决方案来动态管理窗口大小调整。基本上，该函数`conflayout()`管理设置，每次调整窗口大小时都会调用它，并且在开始时设置原始值时也会调用它。

要更改设计变得流畅的设置大小，请更改 800 ：
`if (window.innerWidth > 800) {`

到你喜欢的任何数字。

当屏幕的宽度变得小于该数字时，一个 div 被包裹在其内容周围`body`，充当保持静态的包装器。

现场示例：

[http://thepelican.me/liquidcssexample.html](http://thepelican.me/liquidcssexample.html)

* * *

js：

```
var waitForFinalEvent = (function () {
  var timers = {};
  return function (callback, ms, uniqueId) {
    if (!uniqueId) {
      uniqueId = "Don't call this twice without a uniqueId";
    }
    if (timers[uniqueId]) {
      clearTimeout (timers[uniqueId]);
    }
    timers[uniqueId] = setTimeout(callback, ms);
  };
})();

$(window).resize(function () {
    waitForFinalEvent(function(){

conflayout()

      //...
    }, 1, "reloadproperties");
});

function conflayout() {

if (window.innerWidth > 800) {

$('#left').width((window.innerWidth-$('#sidebar').width())+1) 
$('#left, #sidebar').css({minHeight: window.innerHeight-$('#header').height()}) 
 $("#wrapper").unwrap();
 $('#wrapper').css({width: 'auto !important'});

}
else
{
    if($('#contain').size() < 1) {
    $('body').wrapInner('<div id="contain" />');
    }
    $('#wrapper').css({width: '800px !important'});
    $('#contain').css({width: '800px',position: 'fixed', height: '100%' })
}

}

$(document).ready(function() { 
conflayout()
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:50:37.870

用这个替换你的CSS

```
body{
margin:0px
}
#wrapper {
width:100%;
min-width:500px;
height:auto;
overlay:hidden;
}
#header {
height:5%;
width:100%;        
background-color:yellow;
}
#content {
width:100%;
height: auto;
min-height:500px;
}
#left {
height: auto;
min-height: 100%;
min-width: 90%;
position: absolute;
width: 95%;
background-color:blue;
}
#sidebar {
min-height: 100%;
position: absolute;
right: 0;
top: 5%;
width: 100px;
background-color:red;
} 
```

不知道是不是你需要的

# ios - IOS：在 Facebook 上注册新应用

> ID：10372478
> 
> 赞同：1
> 
> 时间：2012-04-29T13:30:09.657
> 
> 标签：ios, facebook, registration

这个问题应该有一个简单的答案......

我正在尝试将我最新的 IOS 应用程序集成到 Facebook。我以前没有使用过 Facebook，所以只需设置一个包含我公司基本信息的“公司”页面。

我正在关注所有 Facebook 链接，即[https://developers.facebook.com/docs/mobile/ios/build/](https://developers.facebook.com/docs/mobile/ios/build/)

但我无法超越第 1 步（笑）。每当我单击链接“第 1 步：在 Facebook 注册您的 iOS 应用程序”时，它都会一直将我带到我公司的 Facebook 管理屏幕！？我找不到在此屏幕上注册我的应用程序的方法。“添加新应用”链接在哪里？

我在兜圈子。帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:46:19.787

无法在企业帐户下注册应用程序，您必须创建（或借出）个人帐户。请记住：Facebook 对不正确的信息不屑一顾，因此应该是合法的人，否则当他们发现时（而不是如果），您的帐户将被暂停。

其次，您必须授权您的 Facebook 帐户。例如：通过输入手机号码。并从文本 FB 输入代码将发送给您（更多信息： http: [//www.facebook.com/confirmphone.php](http://www.facebook.com/confirmphone.php)）或输入 CC 信息（更多信息：[https](https://secure.facebook.com/cards.php) ://secure.facebook.com/cards.php ）

当您（最终）拥有经过身份验证的帐户时：

[https://developers.facebook.com/apps](https://developers.facebook.com/apps)是您应该查看的位置。

在[http://developers.facebook.com/docs/opengraph/tutorial/](http://developers.facebook.com/docs/opengraph/tutorial/) `Step 1`上描述了 Facebook 应用程序的创建。（相当简单，通过单击“创建新应用程序”）

希望这可以帮助！祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:49:38.223

我认为问题在于您正在尝试使用“页面用户”创建 Facebook 应用程序。IE 您单击了“将 Facebook 用作...”并单击了您的一个页面。

您不能以这种方式创建应用程序。应用程序**必须**由“真实”用户创建。您将要遵循您发布的教程并使用**您的**用户。

如果您对使用自己的帐户犹豫不决，请让您的老板使用他的或您客户的登录凭据以在他们的帐户上打开应用程序。

* * *

这背后的原因是，Facebook 可以将“不良”应用程序追踪给**真实的人**，这些人必须通过提交手机或信用卡号码来验证他们的帐户。

# jquery - Is there a more efficient way of adding or removing a css class depending on a checkbox state?

> ID：10372480
> 
> 赞同：0
> 
> 时间：2012-04-29T13:30:24.580
> 
> 标签：jquery, dry, performance

Is there a more efficient, DRYer way of writing the if-else-statement in following piece of code? It just doesn't look nice.

```
var $diffPaymentAddressFieldset = $('fieldset.diffPaymentAddress', 'form.myForm');

// $checkbox is an input with type=checkbox
if ($checkbox.is(':checked') === true) { 
    $diffPaymentAddressFieldset.removeClass('hidden');
} else {
    $diffPaymentAddressFieldset.addClass('hidden');
} 
```

(FYI: Ignore the long variable names, they'll get minified.)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T13:32:47.387

Use `toggleClass()`

```
$diffPaymentAddressFieldset.toggleClass('hidden', $checkbox.is(':checked')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:39:45.293

还是带有 addClass/removeClass 的单线？

```
$diffPaymentAddressFieldset[$checkbox.is(':checked')?'removeClass':'addClass']('hidden'); 
```

另外，看在上帝的份上，尝试使用较短的变量名？

# python - 有任何 Python 模块可以为 URL 提取/建议图像吗？

> ID：10372488
> 
> 赞同：0
> 
> 时间：2012-04-29T13:32:04.320
> 
> 标签：python, django-models

我正在考虑尝试扩展[Pinry](https://github.com/overshard/pinry)，一个可自我托管的 Pinterest“克隆”。Pinry 缺少的一项关键功能是它目前仅接受图像 URL。我想知道在 Python 中是否有任何建议的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T15:27:33.653

是的，有很多方法可以做到这一点，BeautifulSoup 可能是一种选择。或者更简单地说，您可以使用 requests 库获取 html，然后使用正则表达式进行匹配

```
<img src="">. 
```

下面是使用 BeautifulSoup4 和请求的完整示例

```
import requests
from bs4 import BeautifulSoup

r = requests.get('http://goodnewshackney.com')
soup = BeautifulSoup(r.text)

for img in soup.find_all('img'):
    print(img.get('src')) 
```

将打印出：

```
http://24.media.tumblr.com/avatar_69da5d8bb161_128.png
http://24.media.tumblr.com/avatar_69da5d8bb161_128.png
....
http://25.media.tumblr.com/tumblr_m07jjfqKj01qbulceo1_250.jpg
http://27.media.tumblr.com/tumblr_m05s9b5hyc1qbulceo1_250.jpg 
```

然后，您需要以某种方式将这些图像呈现给用户并让他们选择一个。应该很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:40:32.130

[http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)？

# matlab - Using fminsearch to solve an equation

> ID：10372489
> 
> 赞同：-2
> 
> 时间：2012-04-29T13:32:09.853
> 
> 标签：matlab, equation-solving, fminsearch

```
(vgb-phy_s)^2=G^2*phy_t*((exp(-x)+x-1)+exp(-(2*phi_b/phi_t))*(exp(x)-x-1)) 
```

where

```
x=phy_s/phy_t
phy_t=0.0288; % phy_t=k*T/q; (k=1.3806503*10^-23, T=300 K, q=1.6*10^-19)
phy_b=0.5267; % phy_b=phy_t*ln(Na/ni)
G=(sqrt(2*q*es*Na)/cox); 
```

Here I need to plot `phy_s` for different values of `vgb`.

I tried many ways but since I'm new to matlab I'm on my learning process, I'm not able to find a proper solution.

Few people suggested me to use `fminsearch` but its quite confusing and I'm getting lot of errors.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:15:43.213

`fminsearch`是一个函数，用于求函数的最小值，而不是求方程的解。此外，这里没有一个方程，而是一个至少包含 5 个方程的方程组。您可以`solve`用来求解方程和方程组。但是，下列方程 1-5 的方程组没有显式解。另一个问题是您提出的常数值似乎是不精确的值，如果您有多个舍入或其他不精确的值，即使方程组是可解的，您也找不到解（但是，**这个方程组没有[一个明确的]解决方案）**）。

所以，我将展示解决这个问题的步骤，但这个方程组似乎有问题，即使 [可能不精确] 常量定义 ( `phy_t=0.0288; phy_t=k*T/q; (k=1.3806503*10^-23; T=300; q=1.6*10^-19`; phy_b=0.5267;`) 被排除在外。

方程（无常数定义）：

```
1\. (vgb-phy_s)^2 = G^2*phy_t*((exp(-x)+x-1)+exp(-(2*phi_b/phi_t))*(exp(x)-x-1))
2\. x = phy_s/phy_t
3\. phy_t = k*T/q
4\. phy_b=phy_t*ln(Na/ni)
5\. G=(sqrt(2*q*es*Na)/cox) 
```

解决例如。方程组 1、2 和 3：

```
Solution = solve('(vgb-phy_s)^2 = G^2*phy_t*((exp(-x)+x-1)+exp(-(2*phi_b/phi_t))*(exp(x)-x-1))', 'x = phy_s/phy_t', 'phy_t = k*T/q');

Solution.q
ans =
(T*k)/phy_t
(T*k)/phy_t

Solution.vgb
ans =
phy_s + (G*phy_t^(1/2)*(exp((2*phi_b)/phi_t) - exp(phy_s/phy_t) + exp((2*phy_s)/phy_t) - exp((2*phi_b)/phi_t)*exp(phy_s/phy_t) - (phy_s*exp(phy_s/phy_t))/phy_t + (phy_s*exp((2*phi_b)/phi_t)*exp(phy_s/phy_t))/phy_t)^(1/2))/(exp((2*phi_b)/phi_t)^(1/2)*exp(phy_s/phy_t)^(1/2))
phy_s - (G*phy_t^(1/2)*(exp((2*phi_b)/phi_t) - exp(phy_s/phy_t) + exp((2*phy_s)/phy_t) - exp((2*phi_b)/phi_t)*exp(phy_s/phy_t) - (phy_s*exp(phy_s/phy_t))/phy_t + (phy_s*exp((2*phi_b)/phi_t)*exp(phy_s/phy_t))/phy_t)^(1/2))/(exp((2*phi_b)/phi_t)^(1/2)*exp(phy_s/phy_t)^(1/2))

Solution.x
ans =
phy_s/phy_t
phy_s/phy_t 
```

请注意，此解仅对方程组 1-3 有效。例如方程组 1、2、4 或 1、2、5 给出不同的解。

要求解所有 5 个方程的方程组，您可以使用以下命令：

```
Solution = solve('(vgb-phy_s)^2 = G^2*phy_t*((exp(-x)+x-1)+exp(-(2*phi_b/phi_t))*(exp(x)-x-1))', 'x = phy_s/phy_t', 'phy_t = k*T/q', 'phy_b = phy_t*ln(Na/ni)', 'G = sqrt(2*q*es*Na)/cox'); 
```

但是，没有解决方案：

```
Warning: Explicit solution could not be found. 
In solve at 160 

Solution =
[ empty sym ] 
```

所以，我建议你试着找出你的方程有什么问题，然后`solve`用更正的方程再试一次。

# ajax - AJAX : How to get info about permission reject

> ID：10372490
> 
> 赞同：1
> 
> 时间：2012-04-29T13:32:22.183
> 
> 标签：ajax, asp.net-mvc-3

I have an ASP.NET MVC application, where I call method by AJAX:

```
 $.ajax({
            dataType: 'json',
            url: "/Admin/AllowVideoUpload",
            type: "POST",
            data: { val: val },
            error: function () {
                alert('Error');
            }
        }); 
```

if success - nothing happens on client side, if error - get 'Error' message. But error can be by different reasons - problem inside "AllowVideoUpload" method or user lost his credentials (AdminController has attribute 'Authorize(Roles = "Admin")'). I want to differ these 2 types of error. How to do it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:40:15.777

这些是您的应用程序级别错误。所以它应该在成功处理程序中处理。

`json`您可以从具有状态/错误代码/消息元素的操作方法返回 ，您可以在其中提及错误原因。

**错误的示例 Json**

```
{
    "Status": "Failed",
    "Message": "Authentication Failed"
} 
```

**成功的示例 Json**

```
{
    "Status": "Success",
    "Message": "Successfully Updated"
} 
```

阅读 jSon，然后您可以决定下一步要做什么。可以向用户显示消息

```
$.ajax({
        dataType: 'json',
        url: "/Admin/AllowVideoUpload",
        type: "POST",
        data: { val: val },
        success:function(data){
           if(data.Status=="Success")
           {
               //operation success. do whatever
           }
           else if(data.Status=="Failed")
           {
             alert(data.Message);
           }
        },
        error: function () {
            alert('Error');
        }
}); 
```

# radius-protocol - Obtaining RADIUS attributes without authenticating

> ID：10372494
> 
> 赞同：0
> 
> 时间：2012-04-29T13:33:14.733
> 
> 标签：radius-protocol

My application is using a RADIUS client implementation in order to authenticate users (using username/password and a shared secret). In the response from the server (Access-Accept), various attributes are provided, and I use them for getting a few relevant user properties.

The problem: once in a while, I need to refresh the value of the "Class" attribute. I don't have the full credentials any more, only the user name, and I don't want to force the users to re-authenticate. Is there any way to fetch this attribute without the password?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T12:22:10.543

Class 属性是一个会话 cookie，由 RADIUS 服务器在身份验证数据包中返回，然后由 RADIUS 客户端在计费数据包中发回。我很确定你不能在不重新认证的情况下刷新 Class 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T01:05:32.497

如果您想更改已建立会话的类属性值，您可以发出 CoA 请求（取决于 NAS 支持）。

# c# - 围绕一个点旋转

> ID：10372495
> 
> 赞同：0
> 
> 时间：2012-04-29T13:33:35.577
> 
> 标签：c#, xna, rotation, rotational-matrices

谁能帮我解决这个问题

我希望能够围绕静止的 3D 对象旋转 3D 对象。好吧，不会涉及任何运动，因为我只想在游戏开始后在它们的位置绘制对象，然后它们将在游戏的剩余时间内保持在那里。

例如，我有一个在 3D 空间中静止的对象 X。然后我有 2 个其他对象，Y1 和 Y2。这两个物体也是静止的，不能移动。所有 3 个对象都在同一 x 和 y 轴上。假设 X 位于 (0,0,0)，Y1 位于 (0,0,-50)。我想从 Y1 绕 Y 轴以 45 度角绘制 Y2，但与 X 保持相同的距离。

任何人都可以请建议这样做的最佳方法吗？我尝试了以下方法，但这只是围绕其原点旋转对象。所以我想我必须围绕世界原点旋转它？这是怎么做到的？

```
Matrix.CreateRotationY(Rotation) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:27:05.600

我不确定你想要什么，但这是围绕另一个对象旋转一个对象的一种方法：

```
 Vector3 Origin;     // Stationary Object

  float Yaw, Pitch;   // Angles 

  float Distance;     

  Vector3 OrbitOffset = Vector3.UnitX * Distance;

  // Other approach that consider the initial pos of the object to rotate
  // Vector3 OrbitOffset = OrbitPos - Origin;       

  Matrix Rotation = Matrix.CreateFromYawPitchRoll(Yaw, Pitch, 0);

  Vector3.Transform(ref OrbitOffset, ref Rotation, out OrbitOffset);

  Vector3 OrbitPos = Origin + OrbitOffset;  // Final position of the rotated object 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:08:43.580

如果你不需要一次旋转超过 2 个角度，你可以使用基本的欧拉方法。看 ：

[http://en.wikipedia.org/wiki/Rotation_matrix#Basic_rotations](http://en.wikipedia.org/wiki/Rotation_matrix#Basic_rotations)

这是一种很难的数学方法......但它有效..如果你想要围绕多个轴旋转，万向节锁定就会出现严重问题

# java - get method from content of JInternalframe

> ID：10372502
> 
> 赞同：1
> 
> 时间：2012-04-29T13:34:18.773
> 
> 标签：java, swing, jpanel, jinternalframe

I've got MyJPanel(extends JPanel). Each MyJPanel object has method GetID(). When I create it I set ID with constructor(but also there is method SetID()), set size and then create Jscrollpane and add it to JInternalFrame. All frames are in `ArrayList<JInternalFrame> arr`.

```
JInternalFrame frame = new JInternalFrame("Inner frame",true,true,true,true);
final MyJPanel panel = new MyJPanel(f.getAbsolutePath(),count);
panel.setSize(panel.getWidth()/6,panel.getHeight()/6);
JScrollPane pane = new JScrollPane(panel);
pane.setPreferredSize(new Dimension(theDesktop.getWidth() / 2, theDesktop.getHeight() / 2));
frame.getContentPane().add(pane, BorderLayout.CENTER); 
```

To delete frame I add add FrameListener and method internalFrameClosing method

```
public void internalFrameClosing(InternalFrameEvent e) {
       int index = panel.GetID();//get index of panel окна
       if (index == arr.size())
          arr.remove(index);//remove last element
       else{
          //reset all indexes of JInternalFrames' MyJPanel
       }
} 
```

But I don't know how to reset values for MyJPanels in array of JInternalFrames when one of the frames was deleted because 1)MyJPanel is in JScrollPane. method SetID 2)JScrollPane is in JInternalFrame 3)JInternalFrame is in the array. No method SetID() in `arr.get(i)`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:39:55.683

一个简单的解决方案是拥有一个 Map （例如 HashMap）`HashMap<JInternalFrame, MyJPanel>`——这将允许您轻松地将 MyJPanel 与保存它的内部框架相关联。然后，当您遍历 JInternalFrames 时，很容易检索每个持有的 MyJPanels。

就像是：

```
public void internalFrameClosing(InternalFrameEvent e) {
  int index = panel.GetID();
  arr.remove(index);
  if (index < arr.size()) {
     for (int i = 0; i < arr.size(); i++) {
        JInternalFrame internalFrame = arr.get(i);
        MyJPanel myPanel = framePanelMap.get(internalFrame);
        myPanel.setID(i);
     }
  }
} 
```

顺便说一句，您确实知道这`if (index == arr.size())`永远不会是真的，因为如果您的索引是列表中的索引，那么 index 将保存一个介于 0 和`arr.size() - 1`永远不会 ==之间的值`arr.size()`。

虽然这有点杂乱无章。在我看来，更好的解决方案可能是重新设计代码并将代码的模型逻辑与代码的视图部分分开，这样您就可以拥有模型的 ArrayList 而不是 JInternalFrames。

这样，如果以后您决定不想使用 JInternalFrames 来显示此信息，则不必更改模型的基本逻辑结构。

# sql - 餐厅菜单是什么规范化形式？

> ID：10372503
> 
> 赞同：-5
> 
> 时间：2012-04-29T13:34:19.240
> 
> 标签：sql, database-normalization

这可能是题外话，但我很好奇。

假设您有一个普通的餐厅菜单，其中包含 itemID、餐点名称和价格。它是什么正常形式？

我说它是 BCNF，因为但一个朋友提出它不在 3NF 中，因为传递依赖价格 -> 项目名称 -> 项目编号。你们有什么感想？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T18:27:48.243

餐厅菜单不是任何正常形式。与任何其他要求集一样，菜单可以表示为 BCNF 中的关系模式或其他一些不在 BCNF 中的模式。这是数据库设计者在创建模式时所做的选择；不是菜单信息本身隐含的东西。

您还没有完全指定有问题的架构。假设关系：

```
Menu {ItemID, Name, Price} 
```

有两个键：{ItemID} 和 {Name} 然后菜单在 BCNF 中关于功能依赖集：

```
ItemID -> Name -> Price
Name -> ItemID -> Price 
```

这些不是非键传递依赖项，因为 Name 和 ItemID 都是候选键。由于菜单在 BCNF 中，它也在 3NF 中。

函数依赖总是以 Determinant -> Dependant 的形式编写。我看不出价格如何可能成为决定因素（菜单上每个项目的唯一价格似乎极不可能）所以你提到的依赖：价格 - > 项目名称 - > 项目编号没有多大意义大部头书。如果由于某种原因价格确实是非关键决定因素，那么上述菜单关系当然会违反 BCNF（和 3NF）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:21:55.680

如果菜单只有一种语言，那么表有两个键（id 和 name），每个非键（价格）都依赖于每个键，满足 3NF。4NF 也满足，因为只有一个非键列。5NF 和 6NF 处理多表关系；因为只有一张桌子，他们也很满意。

如果菜单是多语言的，菜单仍然满足第一范式（如果我们将虚拟列“语言”视为真列；否则，菜单甚至不是1NF），但不满足第二范式：没有非key 属性依赖于 key 的适当子集：这里的模式是：columns(language,id,name,price); keys((language,id),(name[,language])) 但价格仅取决于餐点 ID，而不是订购的语言。

DB-理论上，正确的分解是引入一对表 table(language,id,name) keys((language,id),(name[,language])) table(id,price) keys(id) 。当然，这在真正的餐厅里会很不方便（想象一下有两个菜单——一个英文菜单和一个翻译表），唯一的好处是价格独立于语言是强制的，而不是暗示的。

名称不依赖价格：价格不决定名称；这是相反的方式。

# javascript - “The Good Parts”中的 EventListener 示例

> ID：10372518
> 
> 赞同：0
> 
> 时间：2012-04-29T13:36:01.193
> 
> 标签：javascript, yui

我是一个 JavaScript 新手。我需要添加一个 EventListener 到 Node.on('click', foo); 我的第一次尝试是 - 当然 - 失败：

```
var i = 0;
Y.one('#btnDel' + i).on('click', function () {
    Y.one('#part' + i).remove(true);
}); 
```

我记得在“JavaScript：The Good Parts”一书中有类似的东西，我找到了它（第39页）：

```
var add_the_handlers = function (nodes) {
    var i;
    for (i = 0; i < nodes.length; i += 1) {
        nodes[i].onclick = function (i) {
            return function (e) {
                alert(e);
            };
         }(i);
     }
}; 
```

但这也行不通。通过第二次（更多 21 次）查看，我有一些问题：您返回一个需要参数 'e' 的内部函数，但内部函数没有调用 'i' - 只是外部函数。我“修复”了这个问题，现在它适用于我的 YUI：

```
 Y.one('#btnDel' + i).on('click', function (i) {
    return function () {
        Y.one('#part' + i).remove(true);
    }
}(i)); 
```

在[勘误包上](http://oreilly.com/catalog/errata.csp?isbn=9780596517748)，也有人写了这个“修复”。但是作者（Crockford！）仍然坚持书本版本。有什么我监督的 - 我的版本适用于我的情况只是巧合吗？

ps：当我将我的匿名返回函数绑定`i`到 时`this.i`，这将是全局对象吗？

pps：对不起我的英语很棒。:|

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-09T12:19:53.177

...或使用事件委托：http: [//yuilibrary.com/yui/docs/node/node-evt-delegation.html](http://yuilibrary.com/yui/docs/node/node-evt-delegation.html)。

1）您最终将只有一个事件侦听器，该事件侦听器将委托给所需的元素（在您的情况下为按钮），2）它会更好地处理动态内容。如果您稍后添加另一个元素（例如按钮），则不必将另一个侦听器附加到它。它已经由代表团处理。

...您所指的示例（第 39 页）是一个典型的闭包，对于大多数新手来说都是一个问题。所以不用担心。您已经自己想出了令人印象深刻的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T18:13:45.990

尝试使用类选择器收集所有按钮。然后你可以简单地使用'each'函数：

```
Y.all(".buttonClassName").each(function (oneButtonNode) {
    oneButtonNode.on("click", function (event) {
        //do something
        alert(this.get("id"));
    })
}); 
```

YUI3 文档：http: [//yuilibrary.com/yui/docs/node/#nodelist](http://yuilibrary.com/yui/docs/node/#nodelist)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T23:48:45.280

因为 i 是在循环之外定义的，但在点击发生之前不会在订阅者函数中进行评估。同样的 i 被递增，直到它等于 node.length。所以当点击发生时，i 是 node.length。这是 JavaScript 新手的常见错误。有关正在发生的事情的详细信息，请参阅[http://james.padolsey.com/javascript/closures-in-javascript/ 。](http://james.padolsey.com/javascript/closures-in-javascript/)

至于解决方案，请使用事件委托：http: [//yuilibrary.com/yui/docs/event/delegation.html](http://yuilibrary.com/yui/docs/event/delegation.html)

# ruby-on-rails - 使用 pow 设计/omniauth 问题 - 在 Rails 服务器上工作

> ID：10372519
> 
> 赞同：2
> 
> 时间：2012-04-29T13:36:43.313
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, omniauth, rack-pow

我正在使用[pow](http://pow.cx/)在本地托管我的 rails 应用程序。

我添加了设计，并试图让omniauth按照[这些步骤](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)工作。

当我访问[http://my_site.dev/users/auth/twitter](http://my_site.dev/users/auth/twitter)我收到以下错误 -

```
URI::InvalidURIError

the scheme http does not accept registry part: my_site.dev (or bad hostname?) 
```

使用内部 Rails 服务器工作正常，访问[http://0.0.0.0:3000/users/auth/twitter](http://0.0.0.0:3000/users/auth/twitter)按预期工作。

知道我做错了什么吗？我需要在战俘中改变一些东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T13:32:31.490

主机名不允许包含下划线。试试这个：

```
$ mv ~/.pow/my_site ~/.pow/my-site 
```

该站点现在将在 下可用`http://my-site.dev/`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:35:10.810

您将需要编辑您的 etc/hosts 并在此处设置主机接下来转到 twitter 配置页面并在此处设置此 url。可能它被设置为 localhost 或类似的东西，所以他并不急于信任它:)。

# jquery - 如何将名称-值对存储在 Coldfusion 数组/对象中？

> ID：10372520
> 
> 赞同：1
> 
> 时间：2012-04-29T13:37:01.063
> 
> 标签：jquery, arrays, object, coldfusion, multidimensional-array

假设我有一个错误消息列表，如下所示：

```
fieldname    message
--------------------
zip          "please enter your zip code"
city         "please enter your city"
... 
```

我需要将这些名称-值对存储在 Coldfusion* *8* * 数组/对象中，以使客户端验证函数 (Jquery) 可以访问它们。

在 Jquery 中，我通过 id 引用错误消息，所以我需要存储两者。

这个Jquery的等价物是什么：

```
 var onErr = [ ["zip","please enter your zip code"], ["city", "please enter your city"]  ] 
```

在冷聚？

我想做这样的事情：

```
<cfset onErr = createObject("component","errorMsg.cfc")> 
```

在*errorMsg.cfc*中：

```
<cfset onErr.zip = "please enter your zip code">
<cfset onErr.city = "please enter your city">
...
// then serialize this for pickup by Jquery validation handler 
```

但不确定这是否是最好和最方便的解决方案。我也查看了数组，但是我只能存储 ID 或消息，可以吗？多维数组呢？

感谢帮助！

**编辑：** 感谢所有帮助。终于通过（到下一个障碍:-)。

这是它的工作原理（= 我可以 JSONserialize 到对象并在 Jquery 中解析）：

```
<cfset allErrMsgs=ArrayNew(2)>
<cfset allErrMsgs[1][1] = "firma">
<cfset allErrMsgs[1][2] = tx_validate_firma>
<cfset allErrMsgs[2][1] = "re_firma">
<cfset allErrMsgs[2][2] = tx_validate_firma>
... 
```

因此，每当我收到新的错误消息时，我只需将它们附加到我的错误日志中。我将此日志创建为会话开始上的一个组件，并且每当用户更改语言时：

再次感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:07:49.903

你想要一个结构数组（地图或其他语言的对象）：

```
 var onErr = [ {"zip":"please enter your zip code"}, {"city":"please enter your city"}  ] 
```

对于序列化使用 serializeJSON() 像这样：

```
serializeJSON(onErr) 
```

或者，如果您通过远程访问函数 set returnformat="json" 来执行此操作

# c++ - 如何基于 QByteArrays 创建 QDataStreams 数组

> ID：10372524
> 
> 赞同：0
> 
> 时间：2012-04-29T13:37:25.403
> 
> 标签：c++, qt, qt4

我正在尝试创建一个大约 4 个 QDataStreams 的数组，每个 QByteArray 一个。
情况如下：

```
struct dataform{  
    //other members  
    QDataStream block;  
}  
dataform gd[4];  
//initialize data for each item in gd[]  
QDataStream out[4];  
for (int i = 0; i < 4; ++i){  
    out[i] = QDataStream(&gd[i].block, QIODevice::WriteOnly);  
} 
```

编译器返回

> 'QDataStream& QDataStream::operator=(const QDataStream&)' 是私有的

我也尝试过初始化

```
out[i](&gd[i].block, QIODevice::WriteOnly); 
```

无济于事；编译器返回

> 错误：不匹配调用 '(QDataStream) (QByteArray*, QIODevice::OpenModeFlag)'</p>

有什么方法可以做到这一点，还是我需要使数组成为 QDataStream 指针数组，动态分配 QDataStreams，并在我*每次*写入时（在整个程序中数百次）延迟流？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:49:11.847

您可以在不必使用指针的情况下执行此操作，但您需要`QBuffer`在结构中添加 s `dataform`。

类似的东西（未测试）：

```
struct dataform{  
    //other members  
    QBuffer buffer;
    QDataStream block;  
}  

dataform gd[4];  
QDataStream out[4];  
for (int i = 0; i < 4; ++i){  
    dg[i].buffer.setBuffer(&gd[i].block);
    dg[i].buffer.open(QIODevice::WriteOnly);  
    out[i].setDevice(&dg[i].buffer);
} 
```

（根据文档[`QDataStream`](http://qt-project.org/doc/qt-4.8/qdatastream.html#QDataStream-4)，采用 a 的构造函数在内部`QByteArray`使用 a 。）`QBuffer`

# jquery - 如何将属性对象绑定到现有元素？

> ID：10372525
> 
> 赞同：0
> 
> 时间：2012-04-29T13:37:29.913
> 
> 标签：jquery

在 jQuery 中，您可以一步创建新元素并在其上定义属性：

```
$("<div>", {title: "Hey there!", text: "I'm a DIV!"}); 
```

这会产生：

```
<div title="Hey there!">I'm a DIV!</div> 
```

有没有办法对现有元素做同样的事情？以下不起作用：

```
$("#theDiv", {title: "Hey there!", text: "I'm a DIV!"}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T06:17:21.413

事实证明事情相当容易。jQuery`.attr()`用于此。

```
$("#theDiv").attr({title: "Hey there!", text: "I'm a DIV!"}, true); 
```

注意第二个参数设置为`true`。这导致 jQuery 使用与新创建的元素相同的机制。

甚至函数参数也按预期工作：

```
$("#theDiv").attr({
    title: "Hey there!", 
    text: function () { return "some calculated value"; }
}, true);​ 
```

（[见这个jsFiddle。](http://jsfiddle.net/Tomalak/v4fn5/)）

因此，这也适用于事件绑定、CSS 修改和 jQuery 可以做的所有其他事情：

```
$("#theDiv").attr({
    title: "Hi there", 
    text: function (i, v) { return v.replace(/not /, ""); },
    mouseover: function () { $(this).css({color: "red"}) },
    mouseout: function () { $(this).css({color: ""}) },
    css: { fontSize: "20pt", fontStyle: "italic" }
}, true);​ 
```

（[见这个jsFiddle。](http://jsfiddle.net/Tomalak/v4fn5/1/)）

这是**未记录**的，因此它可以在任何 dot 版本中更改而不会在发行说明中列出，但似乎*不太可能*，并且在升级 jQuery 时很容易测试它。

# iphone - iPhone应用登录加密

> ID：10372527
> 
> 赞同：0
> 
> 时间：2012-04-29T13:37:35.987
> 
> 标签：iphone, encryption, login

我需要制作 iPhone 应用程序来发送用户名和密码，然后获取令牌。我一直在寻找简单的使用 iPhone AES 库，但我没有找到任何可用的东西。或者我应该使用 SSL (HTTPS) 吗？你能推荐我最好的方法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:41:02.200

任何需要安全的互联网流量都应使用 SSL。只需使用 SSL 证书设置 Web 服务器，然后将`https`URL 传递给 a `NSURLRequest`，它会处理其余的事情。

# mysql - 存储过程 1064 错误 My SQL

> ID：10372537
> 
> 赞同：0
> 
> 时间：2012-04-29T13:39:15.023
> 
> 标签：mysql, sql, stored-procedures

我第一次使用其中一个，我很确定这可以工作，因为我已经在 Stackoverflow 上找到了它，但是当我将它作为 SQL 命令运行时它失败了。这似乎是一个常见问题，尝试了几组不同的代码后，我似乎遇到了同样的问题......

> MySQL 说：
> 
> # 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法使用
> 
> 在第 1 行的 '$$ CREATE FUNCTION `GetDistance`(coordinate1 VARCHAR(120), coordinate2 VARCHAR(') 附近

```
DROP FUNCTION IF EXISTS `GetDistance`$$
CREATE FUNCTION `GetDistance`(coordinate1 VARCHAR(120), coordinate2 VARCHAR(120))
    RETURNS VARCHAR(120)
BEGIN
    DECLARE pos_comma1, pos_comma2 INT;
    DECLARE lon1, lon2, lat1, lat2, distance DECIMAL(18,12);
    select locate(',', coordinate1) into pos_comma1;
    select locate(',', coordinate1, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate1, 1, pos_comma1-1) as DECIMAL(18,12)) into lon1;
    select CAST(substring(coordinate1, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat1;
    select locate(',', coordinate2) into pos_comma1;
    select locate(',', coordinate2, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate2, 1, pos_comma1-1) as DECIMAL(18,12)) into lon2;
    select CAST(substring(coordinate2, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat2;
        select ((ACOS(SIN(lat1 * PI() / 180) * SIN(lat2 * PI() / 180) + COS(lat1 * PI() / 180) * COS(lat2 * PI() / 180) * COS((lon1 - lon2) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) into distance;
    RETURN distance;
END$$ 
```

谢谢 - 人族

编辑

试过了…………

```
DROP FUNCTION IF EXISTS `GetDistance`;
delimiter $$
CREATE FUNCTION `GetDistance`(coordinate1 VARCHAR(120), coordinate2 VARCHAR(120))
    RETURNS VARCHAR(120)
BEGIN
    DECLARE pos_comma1, pos_comma2 INT;
    DECLARE lon1, lon2, lat1, lat2, distance DECIMAL(18,12);
    select locate(',', coordinate1) into pos_comma1;
    select locate(',', coordinate1, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate1, 1, pos_comma1-1) as DECIMAL(18,12)) into lon1;
    select CAST(substring(coordinate1, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat1;
    select locate(',', coordinate2) into pos_comma1;
    select locate(',', coordinate2, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate2, 1, pos_comma1-1) as DECIMAL(18,12)) into lon2;
    select CAST(substring(coordinate2, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat2;
        select ((ACOS(SIN(lat1 * PI() / 180) * SIN(lat2 * PI() / 180) + COS(lat1 * PI() / 180) * COS(lat2 * PI() / 180) * COS((lon1 - lon2) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) into distance;
    RETURN distance;
END;
$$ 
```

和..........

```
DROP FUNCTION IF EXISTS `GetDistance`;
$$
CREATE FUNCTION `GetDistance`(coordinate1 VARCHAR(120), coordinate2 VARCHAR(120))
    RETURNS VARCHAR(120)
BEGIN
    DECLARE pos_comma1, pos_comma2 INT;
    DECLARE lon1, lon2, lat1, lat2, distance DECIMAL(18,12);
    select locate(',', coordinate1) into pos_comma1;
    select locate(',', coordinate1, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate1, 1, pos_comma1-1) as DECIMAL(18,12)) into lon1;
    select CAST(substring(coordinate1, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat1;
    select locate(',', coordinate2) into pos_comma1;
    select locate(',', coordinate2, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate2, 1, pos_comma1-1) as DECIMAL(18,12)) into lon2;
    select CAST(substring(coordinate2, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat2;
        select ((ACOS(SIN(lat1 * PI() / 180) * SIN(lat2 * PI() / 180) + COS(lat1 * PI() / 180) * COS(lat2 * PI() / 180) * COS((lon1 - lon2) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) into distance;
    RETURN distance;
END;
$$ 
```

两个都失败了......

人族

编辑 - 找到这个工作脚本....链接：[http ://datamoil.blogspot.co.uk/2011/09/calculate-distance-between-two-points.html](http://datamoil.blogspot.co.uk/2011/09/calculate-distance-between-two-points.html)

```
CREATE FUNCTION distance_between (from_lat DECIMAL(6, 3), from_lng DECIMAL(6, 3), to_lat DECIMAL(6, 3), to_lng DECIMAL(6, 3)) RETURNS DECIMAL(11, 3)
RETURN 6371 * 2 * ATAN2(SQRT(POW(SIN(RADIANS(to_lat - from_lat)/2), 2) + POW(SIN(RADIANS(to_lng - from_lng)/2), 2) * COS(RADIANS(from_lat)) * COS(RADIANS(to_lat))), SQRT(1 - POW(SIN(RADIANS(to_lat - from_lat)/2), 2) + POW(SIN(RADIANS(to_lng - from_lng)/2), 2) * COS(RADIANS(from_lat)) * COS(RADIANS(to_lat)))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:42:52.813

```
DROP FUNCTION IF EXISTS `GetDistance`;

delimiter $$
CREATE FUNCTION `GetDistance`...
   ...
   RETURN distance;
END;
$$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:40:51.253

在执行此代码之前，您必须将分隔符更改为 $$。

这对我有用（在 MySql 上测试）

```
DROP FUNCTION IF EXISTS `GetDistance`;
delimiter $$
CREATE FUNCTION `GetDistance`(coordinate1 VARCHAR(120), coordinate2 VARCHAR(120))
    RETURNS VARCHAR(120)
BEGIN
    DECLARE pos_comma1, pos_comma2 INT;
    DECLARE lon1, lon2, lat1, lat2, distance DECIMAL(18,12);
    select locate(',', coordinate1) into pos_comma1;
    select locate(',', coordinate1, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate1, 1, pos_comma1-1) as DECIMAL(18,12)) into lon1;
    select CAST(substring(coordinate1, pos_comma1+1, pos_comma2-pos_comma1-1) as     DECIMAL(18,12)) into lat1;
    select locate(',', coordinate2) into pos_comma1;
    select locate(',', coordinate2, pos_comma1+1) into pos_comma2;
    select CAST(substring(coordinate2, 1, pos_comma1-1) as DECIMAL(18,12)) into lon2;
    select CAST(substring(coordinate2, pos_comma1+1, pos_comma2-pos_comma1-1) as DECIMAL(18,12)) into lat2;
    select ((ACOS(SIN(lat1 * PI() / 180) * SIN(lat2 * PI() / 180) + COS(lat1 * PI() / 180) * COS(lat2 * PI() / 180) * COS((lon1 - lon2) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) into distance;
    RETURN distance;
END;
$$ 
```

# c# - 如何继承列表视图

> ID：10372538
> 
> 赞同：0
> 
> 时间：2012-04-29T13:39:21.487
> 
> 标签：c#, wpf, listview, inheritance, .net-4.0

我有一个想要继承的列表视图我在相同的列表视图中使用了大部分代码，但我想制作一个通用列表视图，以便我可以根据需要为每个列表自定义它。

我正在使用 WPF 和 C#。

最好的方法是什么？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:53:47.440

你的意思是这样的：

```
class MyListView<T> : ListView 
```

# c++ - QGraphicsItemText 不会检测到鼠标标志

> ID：10372547
> 
> 赞同：1
> 
> 时间：2012-04-29T13:40:14.503
> 
> 标签：c++, qt, mouseover, qgraphicsitem, qt4.7

我想做的很简单，当鼠标悬停在 qgraphicsitem 上时，我希望它改变它的文本值。稍后我想在单击图像时使用它来弹出文本（即图像的信息）

到目前为止，这是我的代码：

```
#include <QtGui/QApplication>
#include <QtGui/QGraphicsItem>
#include <QtGui/QGraphicsTextItem>
#include <QtGui/QGraphicsScene>
#include <QtGui/QGraphicsView>
#include <QtGui/QPixmap>

int main( int argc, char * * argv )
{
    QApplication      app( argc, argv );
    QGraphicsScene    scene;
    QGraphicsView     view( &scene );

    QGraphicsTextItem text( "this is my text");
    scene.addItem(&text);
    scene.setActivePanel(&text);
    text.setFlags(QGraphicsItem::ItemIsSelectable | QGraphicsItem::ItemIsFocusable);
    text.setAcceptHoverEvents(true);
    text.setAcceptTouchEvents(true);
    if (text.isUnderMouse() || text.isSelected()){
        text.setPlainText("test");
    }
    view.show();

    return( app.exec() );
} 
```

有些人使用双击事件，但我希望不使用它们，但是......如果这是完成工作的唯一方法，那么没关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T15:35:32.153

此代码块：

```
if (text.isUnderMouse() || text.isSelected()){
    text.setPlainText("test");
} 
```

在您的视图显示之前只运行一次；所以这绝对没有机会做你期望的事情。

您需要为此做更多的工作，即创建一个自定义子类`QGraphicsTextItem`并覆盖适当的事件处理程序。

以下是在悬停时处理更改文本的方法：

```
class MyTextItem: public QGraphicsTextItem
{
    public:
        MyTextItem(QString const& normal, QString const& hover,
                   QGraphicsItem *parent=0)
            : QGraphicsTextItem(normal, parent), normal(normal), hover(hover)
        {
        }

    protected:
        void hoverEnterEvent(QGraphicsSceneHoverEvent *)
        {
            setPlainText(hover);
        }
        void hoverLeaveEvent(QGraphicsSceneHoverEvent *)
        {
            setPlainText(normal);
        }
    private:
        QString normal, hover;

}; 
```

将其添加到您的代码中，并将`text`声明更改为：

```
MyTextItem text("this is my text", "test"); 
```

它应该做你所期望的。

# python - 从我的 django 应用程序与外部 API 通信时出现“Errno 10061 No connection could be made 错误”

> ID：10372558
> 
> 赞同：0
> 
> 时间：2012-04-29T13:41:32.390
> 
> 标签：python, django, windows-7

从本地主机上运行的应用程序与 facebook api 通信时，我不断收到以下错误：

```
<urlopen error [Errno 10061] No connection could be made because the target machine actively refused it> 
```

我的应用程序正在使用一个名为“django social auth”（https://github.com/omab/django-social-auth）的 django 包来使用 facebook graph api 对用户进行身份验证。当 facebook 重定向到我的应用程序时，似乎会发生错误 - 在以下 URL：

[http://localhost:8000/complete/facebook/?code=AQDXjgUiEmaWbO6fFuEiMqDicVDpFAEOy6qfptVP5OcSmHHS9qrTgclg3A1cKsJhw6XnFjqjHWdtclbvyGEKSiJUcbV0vAFbBU-HnPdOz0aPfS8uZMNuoC063U0VjU-7hFtVHe2V3UqjtiQVGwUjAfzd1dnxOtr6Y0b0owbrJBNxSAbtIAkWR1YVxYEuqFdSP_g](http://localhost:8000/complete/facebook/?code=AQDXjgUiEmaWbO6fFuEiMqDicVDpFAEOy6qfptVP5OcSmHHS9qrTgclg3A1cKsJhw6XnFjqjHWdtclbvyGEKSiJUcbV0vAFbBU-HnPdOz0aPfS8uZMNuoC063U0VjU-7hFtVHe2V3UqjtiQVGwUjAfzd1dnxOtr6Y0b0owbrJBNxSAbtIAkWR1YVxYEuqFdSP_g)

该错误仅发生在我的个人计算机（Windows 7、python 2.7.3、Chrome）上——让我相信这可能是 Windows / Python 问题——而不是应用程序问题。它不会发生在另一台使用 XP 运行相同应用程序的机器上。

我已经在网上寻找解决此错误的方法 - 但我似乎无法找到有关如何解决该问题的明确解释。如果这不是唯一的解决方案，我真的不想更改操作系统。

# wpf - 在 Wpf 中使用 ScrollView 和 ViewBox 缩放到鼠标点

> ID：10372560
> 
> 赞同：4
> 
> 时间：2012-04-29T13:42:07.243
> 
> 标签：wpf, mouse, zooming, scrollviewer, viewbox

我在 wpf 中绘制了一些到屏幕的路径。所使用的坐标非常小，因此它们被制作为用视图框填充屏幕。我现在正在尝试实现平移和缩放功能。我希望能够缩放到鼠标相对于 ui 的任何位置（即缩放的屏幕中心等于鼠标坐标）。当前结果是缩放时屏幕的中心不反映 ui 上的确切鼠标位置。

如果你想看看发生了什么......[这是我当前的解决方案文件](http://code.google.com/p/steamtwentythirteen/downloads/detail?name=FOR_SO_ZOOM.zip)。

或者

继承人一些代码：

***查看 Xaml***

```
<Grid Name="MasterGrid" DataContext="{StaticResource mainWindowViewModel}">

    <ScrollViewer HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible" Name="VisualisationScroller">
        <Viewbox Name="VisualisationBox" Stretch="Fill" Loaded="VisualisationBox_Loaded">

            <ItemsControl Name="CustomDrawingElement" ItemsSource="{Binding Trajectories}" Width="{Binding VisualisationWidth}" Height="{Binding VisualisationHeight}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="data:VisualisedTrajectory">
                        <Path Data = "{Binding PathData}" Stroke="Red" StrokeThickness="0.001" Fill="Transparent" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>

                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas
                            Background="DarkGray"
                            IsItemsHost="True">
                        </Canvas>

                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.RenderTransform>

                    <TransformGroup>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                        <TranslateTransform />
                    </TransformGroup>

                </ItemsControl.RenderTransform>

            </ItemsControl>

        </Viewbox>
    </ScrollViewer>
</Grid> 
```

***查看模型***

```
public class MainWindowViewModel : BaseViewModel
{

    public MainWindowViewModel()
    {
        VisualiseRawTrajectories();

    }

    private ObservableCollection<VisualisedTrajectory> _trajectories = new ObservableCollection<VisualisedTrajectory>();
    public ObservableCollection<VisualisedTrajectory> Trajectories
    {
        get { return _trajectories; } 
    }

    #region VisualisationDimensions

    private double _visualisationWidth = 100;
    public double VisualisationWidth
    {
        get { return _visualisationWidth; }
        private set { _visualisationWidth = value; }
    }

    private double _visualisationHeight = 100;
    public double VisualisationHeight
    {
        get { return _visualisationHeight; }
        private set { _visualisationHeight = value; }
    }

    #endregion

    public void VisualiseRawTrajectories()
    {
        var rand = new Random();

        for (int i = 0; i < 5; i++)
        {
            var currentTrajectorySet = new List<Point>(); //each time through reinitialise
            for (int j = 0; j < 5; j++)
            {
                currentTrajectorySet.Add(new Point(rand.NextDouble() * 0.5, rand.NextDouble() * 0.5)); //add a new point with max 0.5
                if(j == 4)
                {
                    currentTrajectorySet.Add(new Point(0.5, 0.5)); //for good measure :)
                    _trajectories.Add(new VisualisedTrajectory(CreatePathData(currentTrajectorySet)));
                }
            }
        }

        VisualisationHeight = 0.5;
        VisualisationWidth = 0.5; //just for demonstration purposes
        OnPropertyChanged("VisualisationHeight");
        OnPropertyChanged("VisualisationWidth");

    }

    private Geometry CreatePathData(IList<Point> points)
    {
        var geometry = new StreamGeometry {FillRule = FillRule.EvenOdd};
        using (StreamGeometryContext ctx = geometry.Open())
        {
            ctx.BeginFigure(points[0], false, false); //use the first index
            ctx.PolyLineTo(points, true, true);
        }
        return (Geometry)geometry.GetAsFrozen(); 
    }

} 
```

***查看后面的代码***

```
public MainWindow()
    {
        InitializeComponent();
        VisualisationScroller.PreviewMouseWheel += OnPreviewMouseWheel;
    }

    private Point originalDimensions;
    private void VisualisationBox_Loaded(object sender, RoutedEventArgs e)
    {
        Viewbox viewBox = sender as Viewbox;
        viewBox.Width = viewBox.ActualWidth;
        viewBox.Height = viewBox.ActualHeight;
        originalDimensions = new Point(viewBox.ActualWidth, viewBox.ActualHeight);

    }

    #region Zoom

    private int _numberDrawnItems = 0;
    private void OnPreviewMouseWheel(object sender, MouseWheelEventArgs e)
    {
        var zoomScale = new Point(CustomDrawingElement.RenderTransform.Value.M11,
                                  CustomDrawingElement.RenderTransform.Value.M22); //gets the scale x and scale y

        if (CustomDrawingElement != null && _numberDrawnItems != CustomDrawingElement.Items.Count) //if there was something draw to screen
        {
            _numberDrawnItems = CustomDrawingElement.Items.Count;
            CustomDrawingElement.RenderTransformOrigin = new Point(0.5, 0.5); //if not set zoom from center
        }
        if (e.Delta > 0)
        {
            if (CustomDrawingElement != null)
            {

                VisualisationBox.Width = originalDimensions.X * (zoomScale.X + 1);
                VisualisationBox.Height = originalDimensions.Y * (zoomScale.Y + 1);

                var mousePosition = e.GetPosition(MasterGrid);
                CustomDrawingElement.RenderTransformOrigin = new Point(mousePosition.X / MasterGrid.ActualWidth, mousePosition.Y / MasterGrid.ActualHeight);
                CustomDrawingElement.RenderTransform = new MatrixTransform(zoomScale.X + 1, 0, 0, zoomScale.Y + 1, 0, 0);

            }
        }
        if (e.Delta < 0)
        {
            if (zoomScale.X > 1 && zoomScale.Y > 1) //stops you from zooming out too much
            {
                if (CustomDrawingElement != null)
                {

                    VisualisationBox.Width = VisualisationBox.Width - originalDimensions.X;
                    VisualisationBox.Height = VisualisationBox.Height - originalDimensions.Y;

                    CustomDrawingElement.RenderTransform = new MatrixTransform(zoomScale.X - 1, 0, 0, zoomScale.Y - 1, 0, 0);

                }
            }
        }

        e.Handled = true;
    }

    #endregion //Zooming code

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T10:26:14.983

解决了它将缩放视图的后置代码更改为：

```
if (e.Delta > 0)
        {
            if (CustomDrawingElement != null)
            {
                //zoom

                _zoomScale++; //increase it now that we have zoomed
                VisualisationBox.Width = _originalDimensions.X * (_zoomScale);
                VisualisationBox.Height = _originalDimensions.Y * (_zoomScale);

                ScrollerDimensions.Content = VisualisationScroller.ActualWidth + "x" + VisualisationScroller.ActualHeight;
                BoxDimensions.Content = VisualisationBox.ActualWidth + "x" + VisualisationBox.ActualHeight;

                var mousePosition = e.GetPosition(MasterGrid);
                mousePosition = MasterGrid.TransformToVisual(VisualisationBox).Transform(mousePosition);

                ScrolledPoint.Content = mousePosition.X + "," + mousePosition.Y;
                VisualisationScroller.ScrollToHorizontalOffset(mousePosition.X);
                VisualisationScroller.ScrollToVerticalOffset(mousePosition.Y);

            }
        }
        if (e.Delta < 0)
        {
            if (_zoomScale > 1) //stops you from zooming out too much
            {
                if (CustomDrawingElement != null)
                {
                    var mousePosition = e.GetPosition(MasterGrid);

                    _zoomScale -= 1; //decrease the zoom
                    VisualisationBox.Width = VisualisationBox.Width - _originalDimensions.X;
                    VisualisationBox.Height = VisualisationBox.Height - _originalDimensions.Y;
                    mousePosition = MasterGrid.TransformToVisual(VisualisationBox).Transform(mousePosition);
                    mousePosition = new Point(mousePosition.X - _originalDimensions.X, mousePosition.Y - _originalDimensions.Y);

                    VisualisationScroller.ScrollToHorizontalOffset(mousePosition.X);
                    VisualisationScroller.ScrollToVerticalOffset(mousePosition.Y);
                }
            }
        }

        e.Handled = true; 
```

如果有人感兴趣，[这里](http://code.google.com/p/steamtwentythirteen/downloads/detail?name=zoomer_panner.zip)是完成的解决方案文件，也实现了平移。

# mysql - 如何从两个表中获取记录以及计数？

> ID：10372563
> 
> 赞同：1
> 
> 时间：2012-04-29T13:43:08.583
> 
> 标签：mysql, sql

我想从表中选择购买最多的商品`orderitems`，然后获取这些商品的详细信息并排序 DESC

我有以下返回最多购买的项目，但我不知道如何从表中返回每个项目（p_id）的`p_name` `p_price`和`p_image_path``products`

```
SELECT      p_id
        ,   COUNT( p_id ) AS p_id_count
FROM        orderitem
GROUP BY    p_id
ORDER BY    p_id_count $direction 
```

我希望这是有道理的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:46:40.193

```
SELECT o.p_id, COUNT( o.p_id ) AS p_id_count, p.p_name, p.p_price, p.p_image_path
FROM orderitem o
INNER JOIN products p ON o.p_id = p.p_id
GROUP BY o.p_id
ORDER BY p_id_count 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T13:53:21.993

您必须在 *p_id* 字段上的*products*和*orderitem*`INNER JOIN`表之间使用，因为这是绑定两个表的公共字段。将仅获取两个表之间的匹配记录。连接将匹配所有匹配的记录，因为 ordereditem 值已经按 *p_id* 列分组，您将看到 products 表中的所有唯一产品信息以及基于 COUNT(p_id) 信息输出的订单计数。**`INNER JOIN`**

 **[**单击此处查看 SQL Fiddle 上的演示。**](http://sqlfiddle.com/#!2/bb834/5)

*脚本*：

```
CREATE TABLE products 
(
    p_id            INT NOT NULL 
  , p_name          VARCHAR(20) NOT NULL
  , p_image_path    VARCHAR(255) NOT NULL  
);

CREATE TABLE orderitem
(
    orderid INT NOT NULL
  , p_id    INT NOT NULL
);

INSERT INTO products (p_id, p_name, p_image_path) VALUES 
    (1, 'product 1', '~\image 1'),
    (2, 'product 2', '~\image 2'),
    (3, 'product 3', '~\image 3');

INSERT INTO orderitem (orderid, p_id) VALUES 
    (1, 2),
    (1, 1),
    (1, 3),
    (1, 2),
    (1, 2),
    (1, 1);

SELECT      p.p_id
        ,   p.p_name
        ,   p.p_image_path
        ,   COUNT(o.p_id) AS orderedcount
FROM        products p 
INNER JOIN  orderitem o
ON          p.p_id = o.p_id
GROUP BY    p.p_id
ORDER BY    orderedcount DESC; 
```

*输出*：

```
P_ID P_NAME      P_IMAGE_PATH ORDEREDCOUNT
---- ----------  ------------ ------------
2    product 2   ~image 2         3
1    product 1   ~image 1         2
3    product 3   ~image 3         1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T13:51:34.010

我假设产品的主键是 id 并且与 orderitem 的 p_id 有参考

```
SELECT o.p_id, COUNT( o.p_id ) AS p_id_count, p.p_name,p.p_price,p.p_image_path 
        FROM orderitem o
    INNER JOIN products p ON p.id = o.p_id 
        GROUP BY o.p_id
        ORDER BY o.p_id_count $direction 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T13:45:56.507

```
SELECT p_id, p_name, p_price, p_image_path, COUNT( p_id ) AS p_id_count
FROM orderitem
inner join products p on p.id = p_id
GROUP BY p_id
ORDER BY p_id_count $direction 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-29T13:46:26.807

您需要将 products 表与 orderitem 表连接起来。

```
SELECT p_id, p_name, p_price, COUNT( p_id ) AS p_id_count
    FROM orderitem
    LEFT JOIN products ON (orderitem.p_id = products.id)
    GROUP BY p_id, p_name, p_price
    ORDER BY p_id_count $direction 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-29T13:46:44.150

```
SELECT p_id, COUNT( p_id ) AS p_id_count
        FROM orderitem o, products p
        WHERE o.p_id = p.p_id
        GROUP BY p_id
        ORDER BY p_id_count $direction 
```**

# cordova - Phonegap 和嵌入式内容

> ID：10372565
> 
> 赞同：1
> 
> 时间：2012-04-29T13:43:41.657
> 
> 标签：cordova, scribd

使用 phonegap 制作的本机应用程序是否能够显示带有嵌入式 Scribd 文档的页面？

[http://support.scribd.com/entries/20533011-embedding-scribd-documents](http://support.scribd.com/entries/20533011-embedding-scribd-documents)

# ios - 将 NSManagedObjectContext 上下文传递给 ViewController 是 nil

> ID：10372574
> 
> 赞同：0
> 
> 时间：2012-04-29T13:45:02.283
> 
> 标签：ios, objective-c, core-data, nsmanagedobjectcontext

我已经使用以下代码将上下文传递给传递中的 ViewController 没有问题，但由于某种原因，它对于这个项目的行为有所不同。

1.  用户执行操作
2.  我像这样加载 ViewController：

    ```
    ProjectListViewController *projectListViewController = [[ProjectListViewController alloc] init]; 
    projectListViewController.context = [self context];
    [self.view addSubview:[projectListViewController view]]; 
    ```

3.  在 viewDidLoad 方法中，我有以下内容：

    ```
    if (_context != nil) {

       NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
       NSEntityDescription *entity = [NSEntityDescription
            entityForName:@"Project" inManagedObjectContext:_context];

       [fetchRequest setEntity:entity];
       NSError *error;
       self.projects = [_context executeFetchRequest:fetchRequest error:&error];
    } 
    ```

4.  事实证明 _context 为零。

做了一个调试，这是我发现的。

ViewDidLoad 方法在到达 [self.view addSubview:[projectListViewController view]]; 行之前运行。因此没有设置上下文。

但是，如果我从视图声明中删除了 init，那么 projectListViewController.context = [self context]; 运行，因此上下文不为零。

我认为在调用 addSubview 之前不应运行 ViewDidLoad 是否不正确？

有没有更好的方法将上下文传递给 ViewController？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:57:59.633

`-viewDidLoad`在需要视图之前不会被调用 - 也就是说，直到它需要显示并且在它加载之后。我通常会在应用程序委托或返回上下文的单例中放置一个便利方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T12:49:51.190

基于 Apple 的文档。

> 当访问视图控制器的视图属性并且视图当前不在内存中时，会触发加载循环。

所以这就是发生的事情，我的 ViewController 调用了 initWithNibName。由于访问了 ViewController，它调用的下一个方法是 ViewDidLoad。

这意味着视图实际上已加载，只是尚未添加，因此 _context 的传递发生在 ViewDidLoad 事件使 _context 为零之后。

简单的解决方案是，如果您不需要 initWithNibName 方法进行任何自定义，然后以不访问视图控制器的方式将其删除，因此在传递上下文并将其添加为子视图之前不会调用 ViewDidLoad。

我将使用 Philip 提出的解决方案，只是想了解原因。

# c++ - 一个简单的国际象棋极小极大

> ID：10372585
> 
> 赞同：6
> 
> 时间：2012-04-29T13:47:07.270
> 
> 标签：c++, artificial-intelligence, chess, backtracking, minimax

我自己的国际象棋引擎使用 minimax 算法搜索国际象棋移动时遇到问题我使用 5 层深度搜索并且仅使用材料/奖励/移动性评估，但它也会做出愚蠢的移动并牺牲有价值的棋子，即使我给他们无穷大（这肯定是一个搜索问题），我没有使用任何类型的修剪，并在几秒钟内给出 5 个深度的搜索结果。

我被这个问题困了一个星期，我确定问题出在回溯而不是国际象棋逻辑（所以没有国际象棋背景的人都会解决这个问题:)）我搜索了很多这是我在 Stack Overflow 中的第一个问题我希望你们不会让我失望:)

这是简单的搜索代码

```
int GameControl::Evaluate(ChessBoard _B)
{

    int material=0,bonus=0,mobility=0;
    for(int i=0;i<8;i++)
        for(int j=0;j<8;j++)
        {

            if(_B.Board[i][j]!=EMPTY)
            {
                if(_B.Board[i][j]->pieceColor==WHITE){
                    material+=-_B.Board[i][j]->Weight;
                    bonus+=-_B.Board[i][j]->bonusPosition[i][j];
                    mobility+=-_B.Board[i][j]->getPossibleMovesList(i,j,B).size();
                }
                else {
                    material+=_B.Board[i][j]->Weight;
                    bonus+=_B.Board[i][j]->bonusPosition[i][j];             
                mobility+=_B.Board[i][j]->getPossibleMovesList(i,j,B).size();
                }
            }
        }
        return material+bonus/10+mobility/20;
}

pair<pair<int,int>,pair<int,int>> GameControl::minimax( int depth , ChessBoard _B )
{
    short int i,j;

    int bestValue = -INFINITY;

    pair<pair<int,int>,pair<int,int>> bestMove;

    vector< pair<int,int> > ::iterator it;

    vector< pair<int,int> > Z;

    for( i = 0; i < 8; i++ )

        for( j = 0; j < 8; j++ )
        {
            if(_B.Board[i][j]!=EMPTY && _B.Board[i][j]->pieceColor==BLACK )
            {
                Z=_B.Board[i][j]->getPossibleMovesList(i,j,_B);
                for(it=Z.begin();it!=Z.end();it++)
                {
                    pair<int,int> temp;
                    temp.first=i,temp.second=j;
                    ChessPieces* DestinationPiece;
                    DestinationPiece=_B.Board[(*it).first][(*it).second];
                    //Moving
                    _B.Board[(*it).first][(*it).second]=_B.Board[i][j];
                    _B.Board[i][j]=EMPTY;
                    //
                    int value = minSearch( depth-1 , _B );
                    if( value > bestValue )
                    {
                        bestValue = value;
                        bestMove.first.first = i;
                        bestMove.first.second = j;
                        bestMove.second.first = (*it).first;
                        bestMove.second.second = (*it).second;

                    }
                    //Undo Move
                    _B.Board[i][j]=_B.Board[((*it).first)][(*it).second];
                    _B.Board[(*it).first][(*it).second]=DestinationPiece;
                }

            }
        }

        return bestMove;
}

int GameControl::minSearch( int depth , ChessBoard _B )
{

    short int i;
    short int j;
    if(depth==0)
        return Evaluate(_B);

    int bestValue = INFINITY;
    for( i = 0; i < 8; i++ )
        for( j = 0; j < 8; j++ )
        {
            vector< pair<int,int> > ::iterator it;
            vector< pair<int,int> > Z;
            if(_B.Board[i][j]!=EMPTY && _B.Board[i][j]->pieceColor==WHITE  && !_B.Board[i][j]->V.empty())
            {

                Z=_B.Board[i][j]->getPossibleMovesList(i,j,_B);
                for(it=Z.begin();it!=Z.end();it++)
                {

                    pair<int,int> temp;
                    temp.first=i;
                    temp.second=j;
                    ChessPieces* DestinationPiece;
                    DestinationPiece=_B.Board[(*it).first][(*it).second];
                    // Moving
                    _B.Board[(*it).first][(*it).second]=_B.Board[i][j];
                    _B.Board[i][j]=EMPTY;
                    //
                    int value = maxSearch( depth-1 , _B );
                    if( value < bestValue )
                        bestValue = value;  
                    //Undo Move
                    _B.Board[i][j]=_B.Board[(*it).first][(*it).second];     
                    _B.Board[(*it).first][(*it).second]=DestinationPiece;
                    //
                }

            }
        }
        return bestValue;
}

int GameControl::maxSearch( int depth , ChessBoard _B )
{

    short int i;
    short int j;
    if(depth==0)
        return Evaluate(_B);
    vector< pair<int,int> > ::iterator it;
    vector< pair<int,int> > Z;
    int bestValue = -INFINITY;
    for( i = 0; i < 8; i++ )
        for( j = 0; j < 8; j++ )
        {

            if(_B.Board[i][j]!=EMPTY && _B.Board[i][j]->pieceColor==BLACK )
            {
                Z=_B.Board[i][j]->getPossibleMovesList(i,j,_B);
                for(it=Z.begin();it!=Z.end();it++)
                {
                    pair<int,int> temp;

                    temp.first=i,temp.second=j;
                    ChessPieces* DestinationPiece;
                    DestinationPiece=_B.Board[(*it).first][(*it).second];
                    //Moving
                    _B.Board[(*it).first][(*it).second]=_B.Board[i][j];
                    _B.Board[i][j]=EMPTY;
                    //
                    int value = minSearch( depth-1 , _B );
                    if( value > bestValue )     
                        bestValue = value;

                    //Undo Move
                    _B.Board[i][j]=_B.Board[((*it).first)][(*it).second];   
                    _B.Board[(*it).first][(*it).second]=DestinationPiece;
                }

            }
        }
        return bestValue;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-30T17:04:34.123

您没有进行[静止搜索](http://en.wikipedia.org/wiki/Quiescence_search)，因此愚蠢的移动可能是由于固定深度极小极大搜索容易受到众所周知的[地平线效应。](http://en.wikipedia.org/wiki/Horizon_effect)至少，您应该扩展搜索任何强制移动、检查或捕获，其中一块捕获一个相等或更大的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T14:51:11.667

有几件事可以通过您的代码进行改进：

1.  使用[negamax](http://en.wikipedia.org/wiki/Negamax)公式。这将消除您的`minsearch`和`maxsearch`.
2.  使用[alpha-beta](http://en.wikipedia.org/wiki/Alpha-beta_pruning)修剪。在给定的搜索时间内，这将使您的搜索深度加倍。
3.  将[迭代深化](https://www.chessprogramming.org/Iterative_Deepening)与[哈希表](https://www.chessprogramming.org/Hash_Table)结合使用。迭代深化会逐渐细化你的搜索结果（这样你就可以随时停止搜索并采取行动），哈希表会让你在博弈树中遇到换位时避免重复工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-03T02:03:42.833

初始 minimax 函数中的搜索函数不应该是最大化而不是最小化吗？

# java - JDBC 连接池问题 - 获取连接时出现死锁

> ID：10372586
> 
> 赞同：3
> 
> 时间：2012-04-29T13:47:08.147
> 
> 标签：java, multithreading, jdbc, connection-pooling

我在 Tomcat 中使用 JDBC 连接池。为了检索连接，我定义了一个连接工厂，如下所示：

```
public class ConnectionManager {

   // reference to the ConnectionManager
   private static ConnectionManager instance = null;
   // Connection to MySQL database
   private Connection connect = null;

   private static DataSource ds = null;
   // Logger
   public static final Logger logger = Logger
         .getLogger(ConnectionManager.class);

   static {

      try {
         Context initCtx = new InitialContext();
         Context envCtx = (Context) initCtx.lookup("java:comp/env");
         ds = (DataSource) envCtx.lookup("jdbc/ConnectionManager");
      } catch (NamingException e) {
         // TODO Auto-generated catch block
         e.printStackTrace();
      }
   }

   /**
    * Private Constructor .. since its a singleton
    * 
    */
   private ConnectionManager() {

   }

   public static ConnectionManager getInstance() {
      if (instance == null) {
         instance = new ConnectionManager();
      }
      return instance;
   }

   public Connection getDbConnection() {
      Connection conn = null;

      try {
         synchronized (DataSource.class) {

            conn = ds.getConnection();
         }
      } catch (SQLException e) {
         // TODO Auto-generated catch block
         e.printStackTrace();
      }

      return conn;
   }

   public void closeDbConnection() throws SQLException {
      conn.close();
   }
} 
```

现在我看到我的代码总是卡在`conn = ds.getConnection();`一行。请让我知道我做错了什么。从我的 DAO 方法中，我使用以下方法来获取连接：`conn = ds.getConnection();`

显然这是一个多线程问题。我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:44:38.430

您的大部分课程似乎都围绕检索 JNDI 数据源并使用它来创建连接。不一定是个坏主意，但在这种情况下，您在程序中引入了一些错误，增加了复杂性。

首先，您的单身人士不是单身人士。您没有同步该`getInstance`方法，因此多个线程可以同时调用此方法。Java 中实现单例的最佳方法（不幸的是）是通过枚举：

```
public enum ConnectionManager {
    INSTANCE;
} 
```

您的第二个重要问题是您正在同步一个您没有明确控制的类。没有什么可以阻止第三方 JAR 甚至您自己的应用程序中的其他类在 DataSource 类上同步，这使其成为死锁问题的普遍目标。我会从类中取出所有多余的方法并删除同步块：

```
public enum ConnectionManager {
    INSTANCE;

    private DataSource ds = null;

    ConnectionManager() {
      try {
         final Context initCtx = new InitialContext();
         final Context envCtx = (Context) initCtx.lookup("java:comp/env");
         ds = (DataSource) envCtx.lookup("jdbc/ConnectionManager");
      } catch (NamingException e) {
         e.printStackTrace();
      }
    }

   public Connection getConnection() throws SQLException {
      if(ds == null) return null;

      return ds.getConnection();
   }
} 
```

现在，根据我的经验，大多数数据源实现都是线程安全的，所以上面的代码大部分时间都应该工作。但是，我们不应该依赖我们无法控制的实现，所以让我们在代码中添加一个*安全*同步，如下所示：

```
public enum ConnectionManager {
    INSTANCE;

    private DataSource ds = null;
    private Lock connectionLock = new ReentrantLock();

    ConnectionManager() {
      try {
         final Context initCtx = new InitialContext();
         final Context envCtx = (Context) initCtx.lookup("java:comp/env");
         ds = (DataSource) envCtx.lookup("jdbc/ConnectionManager");
      } catch (NamingException e) {
         e.printStackTrace();
      }
    }

   public Connection getConnection() throws SQLException {
      if(ds == null) return null;

      Connection conn = null;
      connectionLock.lock();
      try {
          conn = ds.getConnection();
      } finally {
          connectionLock.unlock();
      }

      return conn;
   }
} 
```

您不必添加包装方法来关闭连接，这是调用代码的责任。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T13:54:15.203

@arya，您似乎遇到了连接泄漏的问题，因此池已用尽，代码只是等到它获得新连接，要分析问题，请使用任何数据库监控工具，或手动尝试跟踪泄漏（代码中您使用了连接但忘记在使用后将其返回到池中的点）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:03:23.680

好吧，我会说首先尝试您`dataSource`是否使用测试源。
我建议查看 Apache Tomcat JNDI Data Resource How To，用于[Apache Tomcat 6.0](http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html)和[Apache Tomcat 7.0](http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html)。

仔细查看说明并分析代码中出了什么问题，然后用具体问题更新您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:06:57.120

该代码几乎可以保证在多线程系统中导致连接泄漏。`closeDbConnection()`仅关闭从池中借用的最后一个连接 - 因此，如果调用了 10 个线程`getDbConnection()`，之后`closeDbConnection()`，只有 1 个连接被关闭，9 个仍然活着。重复几次并且池已用尽（除非在 中清理连接`finalize()`，但情况可能并非如此）。我会摆脱整个班级，或者将其重新设计为仅充当数据源定位器。

# spring - 在春季 3.0.2 中调用了两次预定方法

> ID：10372587
> 
> 赞同：1
> 
> 时间：2012-04-29T13:47:23.407
> 
> 标签：spring, spring-mvc, scheduled-tasks

**我正在使用弹簧 3.0.2**

**我的预定方法被调用了两次..**

我犯了一些错误..？

请帮我弄清楚..

```
@Component("happySundayGreetTask")
public class HappySundayGreetTask {

    @Autowired
    private JavaMailSender mailSender;
    public void setMailSender(JavaMailSender mailSender) {
        this.mailSender = mailSender;
    }

    @Value("${mail.sender}")
    private String fromAddress;
    public void setFromAddress(String fromAddress) {
        this.fromAddress = fromAddress;
    }

    @Autowired
    private VelocityEngine velocityEngine;
    public void setVelocityEngine(VelocityEngine velocityEngine) {
        this.velocityEngine = velocityEngine;
    }

    @Autowired
    private SpitterDAO spitterDAO;
    public void setSpitterDAO(SpitterDAO spitterDAO) {
        this.spitterDAO = spitterDAO;
    }

    @Scheduled(cron="0 58 18 ? * SUN")
    public void greetSundayToSpitters(){
        try {
            System.out.println("task started..");
            MimeMessage message = mailSender.createMimeMessage();
            MimeMessageHelper mimeHelper = new MimeMessageHelper(message, true);
            List<String> spittersEmail = spitterDAO.getSpittersEmail(true);
            String toAddress[] = spittersEmail.toArray(new String[spittersEmail.size()]);
            String templateLoc = "com/spitter/task/sundayGreetEmailTemplate.vm";
            String emailText = VelocityEngineUtils.mergeTemplateIntoString(velocityEngine, templateLoc, null); 
            mimeHelper.setFrom(fromAddress);
            mimeHelper.setTo(toAddress);
            mimeHelper.setSubject("Sunday Greeting from Spitter");
            mimeHelper.setText(emailText, true);
            mailSender.send(message);
        }
        catch (MessagingException ex) {
            Logger.getLogger(HappySundayGreetTask.class.getName()).log(Level.SEVERE, null, ex);
        }    
    }
} 
```

**// spitter-servlet.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:jms="http://www.springframework.org/schema/jms"
       xmlns:task="http://www.springframework.org/schema/task"

       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
          http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
          http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
          http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
          http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
          http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd
          http://www.springframework.org/schema/jms http://www.springframework.org/schema/jms/spring-jms-3.0.xsd
          http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd
">

    <!-- Defining a PropertyPlaceholderConfigurer -->
    <context:property-placeholder 
                location="classpath:/com/spitter/dao/db.properties,
                          classpath:/com/spitter/service/alerts/mailserver.properties"/>

    <!-- Declaring security aspects to those beans annotated with @PreAutorize -->
    <security:global-method-security pre-post-annotations="enabled" />

    <!-- Support for annotation driven validation, message conversion -->
    <mvc:annotation-driven/>

    <!-- Automatically registering controllers & service objects as beans -->
    <context:component-scan base-package="com.spitter"/>

    <!-- Autowiring enabled using annotations -->
    <context:annotation-config/>   

    <!-- Using annotation driven transaction facility -->
    <tx:annotation-driven transaction-manager="transactionManager"/>

    <!-- Configuring a mail sender -->
    <bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">

        <!-- Configuring mail server properties -->
        <property name="host" value="${mailserver.host}"/>
        <property name="port" value="${mailserver.port}"/>
        <property name="username" value="${mailserver.username}"/>
        <property name="password" value="${mailserver.password}"/>

        <!-- Other mail properties -->
        <property name="javaMailProperties">
            <props>
                <prop key="mail.transport.protocol">${mail.transport.protocol}</prop>
                <prop key="mail.smtp.auth">${mail.smtp.auth}</prop>
                <prop key="mail.smtp.starttls.enable">${mail.smtp.starttls.enable}</prop>
                <prop key="mail.debug">${mail.debug}</prop>
            </props>
        </property>
    </bean>

    <!-- Velocity email template used for sending email alerts -->
    <bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
        <property name="velocityProperties">
            <props>
                <prop key="resource.loader">class</prop>
                <prop key="class.resource.loader.class">org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader</prop>
            </props>
        </property>
    </bean>

    <!-- support for scheduled and asynchronous backgorund jobs -->
    <task:annotation-driven/>

</beans> 
```

**//spitter-security.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:security="http://www.springframework.org/schema/security" 
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd
">

    <import resource="spitter-servlet.xml"/>

    <security:http auto-config="true" use-expressions="true">
        <security:remember-me key="spitterKey" token-validity-seconds="86400"/>
        <security:form-login login-page="/login" authentication-failure-url="/login?login_error=t"
                             login-processing-url="/static/j_spring_security_check"
                             default-target-url="/home"/>
        <security:logout logout-url="/logout" logout-success-url="/login?logout=success"/>                     
        <security:intercept-url pattern="/login" access="isAnonymous()"/>  
        <security:intercept-url pattern="/spitters" access="isAnonymous()"/>
        <security:intercept-url pattern="/logout" access="isAuhenticated()"/>
        <security:intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')"/>
    </security:http>

    <security:authentication-manager>
        <security:authentication-provider user-service-ref="spitterServiceImpl">
            <security:password-encoder hash="md5"/>
        </security:authentication-provider>
    </security:authentication-manager>

</beans> 
```

**//web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/spitter-security.xml
        </param-value>
    </context-param>
    <filter>
        <description>Filter used to identify requests for PUT &amp; DELETE requests as the case with RESTFul verbs</description>
        <filter-name>httpMethodFilter</filter-name>
        <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>httpMethodFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <filter>
        <description>Spring security servlet filter delegates to spring managed security filter(Spring security filter)</description>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <listener>
        <listener-class>com.sun.xml.ws.transport.http.servlet.WSServletContextListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>spitter</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet>
        <description>Handles static content</description>
        <servlet-name>staticHandler</servlet-name>
        <servlet-class>com.spitter.servlet.StaticServlet</servlet-class>
        <load-on-startup>5</load-on-startup>
    </servlet>
    <servlet>
        <servlet-name>SpitterServiceEndPoint</servlet-name>
        <servlet-class>com.sun.xml.ws.transport.http.servlet.WSServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>spitter</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>staticHandler</servlet-name>
        <url-pattern>/resources/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>SpitterServiceEndPoint</servlet-name>
        <url-pattern>/SpitterServiceEndPoint</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
</web-app> 
```

**我正在使用弹簧 3.0.2**

**我的预定方法被调用了两次..**

我犯了一些错误..？

请帮我弄清楚..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T11:34:47.920

[在spring](http://static.springsource.org/spring-framework/docs/3.2.0.M1/reference/html/scheduling.html#scheduling-annotation-support)的文档中找到：

> 确保您没有在运行时初始化同一 @Scheduled 注释类的多个实例，除非您确实想为每个此类实例安排回调。与此相关，请确保不要在使用 @Scheduled 注释并在容器中注册为常规 Spring bean 的 bean 类上使用 @Configurable：否则，您将获得双重初始化，一次通过容器，一次通过 @Configurable 方面，每个@Scheduled 方法被调用两次的结果。

也许这就是原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T22:12:44.370

看起来你的 cron 语法是错误的 - 我猜你输入了？和 * 不小心。您应该将其更改为：

```
@Scheduled(cron="0 58 18 * SUN") 
```

如果您指定 6 个参数（就像您在原始语法中所做的那样），cron 预计第 6 个元素是年份。SUN 是一个“星期几”参数，应该指定在第 5 位，所以 cron 会感到困惑。

# .htaccess - 将 https 重定向到 http 而不会丢失 postdata

> ID：10372588
> 
> 赞同：0
> 
> 时间：2012-04-29T13:47:26.683
> 
> 标签：.htaccess, mod-rewrite, redirect, https

在我的网站上，有些页面是安全的，有些则不是。我的每个页面上都有一个搜索表单（作为模板的一部分），当我在 https 页面上并启动搜索时，结果页面什么也没有显示。我知道由于重定向，我必须丢失我发布的数据。将结果页面排除在重定向之外会解决我的问题吗？我希望它始终是http。如果是这样的话 - 我到底需要在我的 .htaccess 中放入什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:08:49.717

如果您确保搜索表单在操作中使用“http:searchurl”而不仅仅是“searchurl”，那么它应该可以工作

# javascript - Soundcloud API - 使用 SC.recordupload 从外部 URL 上传图像以获取曲目作品

> ID：10372590
> 
> 赞同：0
> 
> 时间：2012-04-29T13:47:40.970
> 
> 标签：javascript, soundcloud

当图像的位置是外部 URL 时，如何使用 SC.recordUpload 函数上传曲目作品？

我的错误代码：

```
imageObj = new Image();
imageObj.src = "http://maps.googleapis.com/maps/api/staticmap?center=51.4993603,-0.1074693&zoom=12&size=200x200&maptype=roadmap&sensor=false";

....(connection code and track recording)....

SC.recordUpload({
    track: {
        title: "New track",
        description: "Track description",
        sharing: "public",
        artwork_data: imageObj
      }
    }, function(track){
        //Track uploaded!
        $("#uploadStatus").html("Track uploaded!"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:10:36.240

目前 SoundCloud JS SDK 很遗憾不支持艺术品上传。

对于那个很抱歉。

# ruby-on-rails - Rails 和 Neo4j：找到 neo4j (1.3.1)，但适用于平台 java

> ID：10372591
> 
> 赞同：2
> 
> 时间：2012-04-29T13:47:42.427
> 
> 标签：ruby-on-rails, gem, neo4j

我正在尝试安装 neo4j gem，我已经安装了 JRuby 1.6.7，但每次都会出现上述错误。我试过用谷歌搜索这个问题，但找不到答案，我会很感激一些帮助。如何安装 neo4j gem？

`gem install neo4j`给出上述错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:13:42.940

这就是为什么我问你是否使用 rvm 安装它。如果您在 linux/mac 上运行，您可以使用 oh-my-zsh 安装 zsh 并获得一个[提示主题](https://github.com/robbyrussell/oh-my-zsh/wiki/themes)，该主题将显示您当前的 rvm ruby​​ 版本。这将有助于解决这种情况。 [https://github.com/robbyrussell/oh-my-zsh](https://github.com/robbyrussell/oh-my-zsh)

# facebook-c#-sdk - 如何使用 facebook-c# SDK 作为应用程序登录？

> ID：10372595
> 
> 赞同：0
> 
> 时间：2012-04-29T13:48:08.753
> 
> 标签：facebook-c#-sdk

我正在使用 facebook c# SDK v6。来自 GitHub 的演示 Windows 应用程序运行良好，我可以以自己的身份登录并发布到我的墙上，帖子说它来自我的应用程序。

但是，如果我想为用户发布分数（请参阅[http://developers.facebook.com/docs/score/](http://developers.facebook.com/docs/score/)）或获取分数列表以显示排行榜，我需要以应用程序身份登录，而不是用户。这在这里解释[http://developers.facebook.com/docs/authentication/applications/](http://developers.facebook.com/docs/authentication/applications/)。

那么有没有人有任何使用 SDK 作为应用程序登录并发布和/或获取分数的示例？谢谢你。

PS这篇文章有点像[How to post as application to facebook wall, using Facebook C# SDK?](https://stackoverflow.com/questions/5431544/how-to-post-as-application-to-facebook-wall-using-facebook-c-sharp-sdk) 但该帖子仍未得到答复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T16:21:07.093

用户使用 FB 凭据登录您的应用程序/游戏，并允许您的应用程序在他们的墙上发布。您应用程序中的代码将作为他们发布在他们的墙上。

# delphi - 将 dbgrid 中的数据输入到 word 邮件合并中

> ID：10372596
> 
> 赞同：2
> 
> 时间：2012-04-29T13:48:12.077
> 
> 标签：delphi, ms-word, outlook, mailmerge

我想为在每个字母上输入不同名称和地址的字母创建一个邮件标记。我使用 Microsoft 示例作为基点[http://support.microsoft.com/kb/229310](http://support.microsoft.com/kb/229310)并根据我的喜好对其进行了自定义。但是当试图获取 dbgrid 的选定行或整个事物的数据时，我的问题就出现了。我不知道该怎么做。我的第一个想法是对行数做 1，然后放下一些 tedit 框并将它们与邮件合并数据相等，但一次仍然只做一个。dbgrid 链接到 ms Outlook。这就是他们填充数据的方式..

```
// Open the file to insert data
wrdDataDoc := wrdApp.Documents.Open('E:\Temp.doc');
 for iCount := 1 to (DBGrid1.DataSource.DataSet.RecordCount) do
wrdDataDoc.Tables.Item(1).Rows.Add;
FillRow(wrdDataDoc, 2, 'Steve', 'DeBroux',
    '4567 Main Street', 'Buffalo, NY  98052');
// Fill in the data
FillRow(wrdDataDoc, 3, 'Jan', 'Miksovsky',
    '1234 5th Street', 'Charlotte, NC  98765');
FillRow(wrdDataDoc, 4, 'Brian', 'Valentine',
    '12348 78th Street  Apt. 214', 'Lubbock, TX  25874'); 
```

那么我将如何从 dbgrid 中获取数据并用该信息填充文件呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T14:15:56.917

```
var
  i: Integer;
  bm: TBookmark;
begin
  DBGrid1.DataSource.DataSet.DisableControls;
  try
    bm := DBGrid1.DataSource.DataSet.GetBookmark;
    try
      i := 0;
      DBGrid1.DataSource.DataSet.First;
      while not DBGrid1.DataSource.DataSet.Eof do begin
        Inc(i);
        FillRow(wrdDataDoc, i,
          DBGrid1.DataSource.DataSet.FieldByName('Name').AsString,
          DBGrid1.DataSource.DataSet.FieldByName('Address1').AsString,
          ..
          );
        DBGrid1.DataSource.DataSet.Next;
      end;
      if Assigned(bm) then
        DBGrid1.DataSource.DataSet.GotoBookmark(bm);
    finally
      DBGrid1.DataSource.DataSet.FreeBookmark(bm);
    end;
  finally
    DBGrid1.DataSource.DataSet.EnableControls;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T09:20:06.677

嗯，这给了我一些关于如何使用书签来管理 DBGrid 中的选定行的线索。我的问题是能够读取 selectedRows 的某些字段，例如提取所选联系人（记录）的电子邮件地址（或记录 ID 号），以发送电子邮件至。有关使用 TBookmarkList 和 TBookmark 的任何进一步信息都会有所帮助:) 太简单了......似乎循环遍历 TBookmarkLIst 的唯一方法是使用它的 Count 属性，并使用它的 Item[index] 作为 TBookmark。然后将其用于 dataset.gotBookMark，然后访问所需的 fieldByName('Fieldname')。

我本来希望...

```
For bmBookmark in bmlBookmarkList do 
```

但这有效...

```
 var bmlGridSelectedRows: TBookmarkList;
      bmRecord: TBookmark;
      I: Integer;
begin
   JvdbUltimGridContacts.DataSource.DataSet.DisableControls;
   bmlGridSelectedRows := JvdbUltimGridContacts.SelectedRows;

   for I := 0 to bmlGridSelectedRows.Count - 1 do
     begin
       bmRecord := bmlGridSelectedRows.Items[I];
       ABSTableContacts.GotoBookmark(bmRecord);
       MessageDlg(ABSTableContacts.FieldByName('DisplayName').AsString,mtInformation,[mbOK],0); //this is just to show that you are accessing the correct record you expect, replace with your own code of course
     end;
  JvdbUltimGridContacts.DataSource.DataSet.EnableControls; 
```

关于 Dataset.DisableControls / EnableControls 属性的好提示，:)

当然，您不需要为 TbookmarkList 和 TBookmark 声明变量，因为它们可以直接访问，我只是习惯这样做，因为我认为它是更简洁的代码。IE

```
 DBGrid.DataSource.DataSet.DisableControls;

   for I := 0 to DBGrid.SelectedRows.Count - 1 do
     begin
       ABSTableContacts.GotoBookmark(DBGrid.SelectedRows.Items[I]);
       MessageDlg(ABSTableContacts.FieldByName('DisplayName').AsString,mtInformation,[mbOK],0);
     end;
  DBGrid.DataSource.DataSet.EnableControls; 
```

# c# - SQL查询两个表很多列

> ID：10372597
> 
> 赞同：1
> 
> 时间：2012-04-29T13:48:14.790
> 
> 标签：c#, asp.net, sql, sql-server-2005

我有两个表，它们具有所有相同的列但不同的数据。它们代表两个不同的日子。这些表是 D1Table 和 D2Table。列是作者 1、作者 2、作者 3、作者 4、作者 5、位置 1 - 位置 5、标题和传记 - 传记 5。在查询中，我试图获取与用户在文本框中键入的文本匹配的列（这样他们就可以在两天内进行搜索）。

到目前为止我在第一张桌子上工作得很好，但我真的很想搜索第一张和第二张桌子，我只是不知道怎么做，我尝试过使用 join 和 union 但我没有太多运气，我只是得到错误显然我做错了什么。而且我使用的查询真的很长，你可以看到，我相信一定有更好的方法来做到这一点：

```
txt = "SELECT * from D1Table WHERE Synopsis LIKE '%" + txtBText + 
      "%' OR  Author1 LIKE '%" + txtBText + "%' OR Author2 LIKE '%" + txtBText + 
      "%' OR Author3 LIKE '%" + txtBText + "%' OR Author4 LIKE '%" + txtBText + 
      "%'   OR Author5 LIKE '%" + txtBText + "%' OR Biography1 LIKE '%" + txtBText + 
      "%' OR Biography2 LIKE '%" + txtBText + "%' OR Biography3 LIKE '%" + txtBText + 
      "%' OR Biography4 LIKE '%" + txtBText + "%' OR Biography5 LIKE '%" + txtBText + 
      "%' OR Title LIKE '%" + txtBText + "%'  OR Position1 LIKE '%" + txtBText + 
      "%'OR Position2 LIKE '%" + txtBText + "%' OR Position3 LIKE '%" + txtBText + 
      "%' OR Position4 LIKE '%" + txtBText + "%' OR Position5 LIKE '%" + txtBText + "%' "; 
```

现在我知道这很糟糕，你可能会说我对 SQL 查询很垃圾（我刚刚开始学习它们）。我一直在互联网上寻找一段时间试图学习语法，但这是我所掌握的，所以我认为可能是我寻求帮助的时候了。如果有人能给我一些指导，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:50:54.243

我的第一反应是为什么你需要这种方法，也许你应该更好地解释你的需求。但无论如何你最好看看`full text search`，只是谷歌它。

以下是一些有用的链接：

[http://en.wikipedia.org/wiki/Full_text_search](http://en.wikipedia.org/wiki/Full_text_search)

> 在文本检索中，全文搜索是指在全文数据库中搜索单个计算机存储文档或集合的技术。全文搜索不同于基于元数据或数据库中表示的部分原始文本（如标题、摘要、选定部分或参考书目）的搜索。
> 
> 在全文搜索中，搜索引擎在尝试匹配搜索标准时检查每个存储文档中的所有词（例如，用户提供的词）。全文搜索技术在 1990 年代的在线书目数据库中变得很普遍[需要验证]。许多网站和应用程序（如文字处理软件）提供全文搜索功能。一些网络搜索引擎（如 AltaVista）采用全文搜索技术，而另一些则仅索引其索引系统检查的网页的一部分。 [1]

[http://msdn.microsoft.com/en-us/library/ms142571.aspx](http://msdn.microsoft.com/en-us/library/ms142571.aspx) 上面链接的一些引用：比较 LIKE 到全文搜索

> 与全文搜索相比，LIKE Transact-SQL 谓词仅适用于字符模式。此外，您不能使用 LIKE 谓词来查询格式化的二进制数据。此外，针对大量非结构化文本数据的 LIKE 查询比针对相同数据的等效全文查询要慢得多。对数百万行文本数据的 LIKE 查询可能需要几分钟才能返回；而对于相同的数据，全文查询可能只需要几秒钟或更短的时间，具体取决于返回的行数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:12:28.747

如果可以的话，重新设计表格会很有帮助。根据有多少属性，以及将日期划分为不同表的原因，您可以拥有一个名为 DayData 的表，其中包含 Date 列（可能存储为 int 或使用 SQL 2008 R2 的 DATE 数据类型） 字段值

如果位置很重要（例如，作者 1 的处理方式与作者 2 不同），那么您也可以有一个索引字段（整数类型）。这取决于每种类型是否总是恰好有 5 个值，或者是否可能有 0、1 或 N，以及类型是否会随着时间而改变。

无论如何，如果您对现有的内容感到困惑，您可以尝试全文搜索，或者如果那是一座太远的桥梁，请尝试

```
"SELECT * from (select * from D1Table UNION D2Table) D1D2
WHERE Synopsis LIKE '%" + txtBText + "%' OR Author1 LIKE '%" + txtBText + "%'
OR Author2 LIKE '%" + txtBText + "%' OR Author3 LIKE '%" + txtBText + "%'
OR Author4 LIKE '%" + txtBText + "%' OR Author5 LIKE '%" + txtBText + "%'
OR Biography1 LIKE '%" + txtBText + "%' OR Biography2 LIKE '%" + txtBText + "%'
OR Biography3 LIKE '%" + txtBText + "%' OR Biography4 LIKE '%" + txtBText + "%' 
OR Biography5 LIKE '%" + txtBText + "%' OR Title LIKE '%" + txtBText + "%' 
OR Position1 LIKE '%" + txtBText + "%'OR Position2 LIKE '%" + txtBText + "%' 
OR Position3 LIKE '%" + txtBText + "%' OR Position4 LIKE '%" + txtBText + "%' 
OR Position5 LIKE '%" + txtBText + "%' "; 
```

注意名为 D1D2 的派生表：（select * from D1Table UNION D2Table）

但是，您还有另一个问题 - 像您一样构建语句容易受到 SQL 注入攻击（搜索此站点或 Google）。有人可以把

```
'--delete * from D1Table; 'select * from D1Table where ''1= 
```

并从 D1Table 中删除数据。主要网站使用类似的技术被黑客入侵 - 而不是删除数据，查询被操纵以生成错误消息或故意的时间延迟，泄露有关数据库设计和用户名、密码等的信息。

希望有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T05:20:25.283

您可以使用**UNION ALL**并运行两个查询来获得结果...如 RBarryYoung 所示

```
SELECT COLUMN1, COLUMN2 FROM TABLE1 WHERE COLUMN1 LIKE '% Variable %' OR COLUMN2 LIKE '% Variable %'
UNION ALL
SELECT COLUMN1, COLUMN2 FROM TABLE2 WHERE COLUMN1 LIKE '% Variable %' OR COLUMN2 LIKE '% Variable %' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:42:10.303

虽然我基本上同意我在这里看到的其他答案，但我将对我的答案采取不同的策略：

如果您正在尝试学习 SQL，那么您必须训练自己使用更好的格式。这可能看起来很琐碎，但实际上，如果您使用更易于理解的格式 ，您会发现它很容易阅读、理解，*尤其是编辑。*

虽然我真的很怀念 c# 中的 c/c++ 类型块引用，但几十年的 VB 编程已经使我适应了没有它们的这种有点丑陋的要求。比较你的例子：

> txt = "SELECT * from D1Table WHERE Synopsis LIKE '%" + txtBText + "%' OR Author1 LIKE '%" + txtBText + "%' OR Author2 LIKE '%" + txtBText + "%' OR Author3 LIKE '%" + txtBText + "%' OR Author4 LIKE '%" + txtBText + "%' OR Author5 LIKE '%" + txtBText + "%' OR Biography1 LIKE '%" + txtBText + "%' OR Biography2 LIKE '%" + txtBText + "%' OR Biography3 LIKE '%" + txtBText + "%' OR Biography4 LIKE '%" + txtBText + "%' OR Biography5 LIKE '%" + txtBText + "%' OR Title LIKE '%" + txtBText + "% ' OR Position1 LIKE '%" + txtBText + "%'OR Position2 LIKE '%" + txtBText + "%' OR Position3 LIKE '%"+ txtBText + "%' OR Position4 LIKE '%" + txtBText + "%' OR Position5 LIKE '%" + txtBText + "%' ";

相当于：

```
txt = ""
+ "  SELECT  * "
+ "  from    D1Table "
+ "  WHERE   Synopsis    LIKE '%" + txtBText + "%' "
+ "      OR  Author1     LIKE '%" + txtBText + "%' "
+ "      OR  Author2     LIKE '%" + txtBText + "%' "
+ "      OR  Author3     LIKE '%" + txtBText + "%' "
+ "      OR  Author4     LIKE '%" + txtBText + "%' "
+ "      OR  Author5     LIKE '%" + txtBText + "%' "
+ "      OR  Biography1  LIKE '%" + txtBText + "%' "
+ "      OR  Biography2  LIKE '%" + txtBText + "%' "
+ "      OR  Biography3  LIKE '%" + txtBText + "%' "
+ "      OR  Biography4  LIKE '%" + txtBText + "%' "
+ "      OR  Biography5  LIKE '%" + txtBText + "%' "
+ "      OR  Title       LIKE '%" + txtBText + "%' "
+ "      OR  Position1   LIKE '%" + txtBText + "%' "
+ "      OR  Position2   LIKE '%" + txtBText + "%' "
+ "      OR  Position3   LIKE '%" + txtBText + "%' "
+ "      OR  Position4   LIKE '%" + txtBText + "%' "
+ "      OR  Position5   LIKE '%" + txtBText + "%' "
; 
```

显然更容易阅读和理解。没有立即明显的是，它也更容易编辑。考虑您需要通过添加 UNION 来检查两个表：

```
txt = ""
// <CUT from here
+ "  SELECT  * "
+ "  from    D1Table "
+ "  WHERE   Synopsis    LIKE '%" + txtBText + "%' "
+ "      OR  Author1     LIKE '%" + txtBText + "%' "
+ "      OR  Author2     LIKE '%" + txtBText + "%' "
+ "      OR  Author3     LIKE '%" + txtBText + "%' "
+ "      OR  Author4     LIKE '%" + txtBText + "%' "
+ "      OR  Author5     LIKE '%" + txtBText + "%' "
+ "      OR  Biography1  LIKE '%" + txtBText + "%' "
+ "      OR  Biography2  LIKE '%" + txtBText + "%' "
+ "      OR  Biography3  LIKE '%" + txtBText + "%' "
+ "      OR  Biography4  LIKE '%" + txtBText + "%' "
+ "      OR  Biography5  LIKE '%" + txtBText + "%' "
+ "      OR  Title       LIKE '%" + txtBText + "%' "
+ "      OR  Position1   LIKE '%" + txtBText + "%' "
+ "      OR  Position2   LIKE '%" + txtBText + "%' "
+ "      OR  Position3   LIKE '%" + txtBText + "%' "
+ "      OR  Position4   LIKE '%" + txtBText + "%' "
+ "      OR  Position5   LIKE '%" + txtBText + "%' "
// CUT to here>
// VV add a UNION
+ " UNION ALL "
// <PASTE here
+ "  SELECT  + "
+ "  from    D2Table "  // <-- change the table name here
+ "  WHERE   Synopsis    LIKE '%" + txtBText + "%' "
+ "      OR  Author1     LIKE '%" + txtBText + "%' "
+ "      OR  Author2     LIKE '%" + txtBText + "%' "
+ "      OR  Author3     LIKE '%" + txtBText + "%' "
+ "      OR  Author4     LIKE '%" + txtBText + "%' "
+ "      OR  Author5     LIKE '%" + txtBText + "%' "
+ "      OR  Biography1  LIKE '%" + txtBText + "%' "
+ "      OR  Biography2  LIKE '%" + txtBText + "%' "
+ "      OR  Biography3  LIKE '%" + txtBText + "%' "
+ "      OR  Biography4  LIKE '%" + txtBText + "%' "
+ "      OR  Biography5  LIKE '%" + txtBText + "%' "
+ "      OR  Title       LIKE '%" + txtBText + "%' "
+ "      OR  Position1   LIKE '%" + txtBText + "%' "
+ "      OR  Position2   LIKE '%" + txtBText + "%' "
+ "      OR  Position3   LIKE '%" + txtBText + "%' "
+ "      OR  Position4   LIKE '%" + txtBText + "%' "
+ "      OR  Position5   LIKE '%" + txtBText + "%' "
// ^^ change these column names if needed
; 
```

这里剩下的是对于 UNION，SELECT 必须返回相同数量的列，并且列的数据类型必须兼容。因此，如果 D1Table 和 D2Table 具有不同的列，那么您必须删除“*”并为每个 SELECT 创建兼容的列列表。

# c# - XNA 碰撞怪异行为

> ID：10372598
> 
> 赞同：1
> 
> 时间：2012-04-29T13:48:20.723
> 
> 标签：c#, xna, xna-4.0

我正在阅读“Learning XNA 4.0”一书，我在面向对象的设计部分。我对 2 个矩形的碰撞有一个奇怪的问题。

我有一个automatedSprite 列表和一个Player 类，它们都派生自Sprite 类。在更新方法中，我正在检查播放并且 aotomatedSprite 矩形相互接触，现在当我越过列表时，我有一个名为 touch 的字符串表示碰撞。

我的问题是真正的触摸，只有当玩家精灵触摸列表中的最后一个自动精灵时才会改变。

本书提供的测试代码是`Game.Exit()`在发现任何冲突时执行的。这适用于列表中的每个自动精灵，但是当我将其更改为我的简单测试时，它就像我只检查 4 个自动精灵列表中的最后一项。

这是代码：

```
string touching = "";
public override void Update(GameTime gameTime)
    {
        // TODO: Add your update code here
        player.Update(gameTime, Game.Window.ClientBounds);

        foreach (Sprite sprite in spriteList)
        {
            sprite.Update(gameTime, Game.Window.ClientBounds);
            if (sprite.collisionRect.Intersects(player.collisionRect))
                touching = "touching";
            else
                touching = "not touching";
        }

        base.Update(gameTime);
    }

    public override void Draw(GameTime gameTime)
    {
        spriteBatch.Begin(SpriteSortMode.Deferred, BlendState.AlphaBlend);

        spriteBatch.DrawString(font, touching, Vector2.Zero, Color.Red);

        player.Draw(gameTime, spriteBatch);
        foreach (Sprite sprite in spriteList)
        {
            sprite.Draw(gameTime, spriteBatch);

        }

        spriteBatch.End();
        base.Draw(gameTime);
    } 
```

编辑 - - - - - - - - - - - - - - - - - - - - - - - - - ------------------------ 解决方案：我在游戏开发部分问它，我得到了答案。我必须`break;`在 foreach 循环中有一个，这样它就不会在发现碰撞后继续运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:30:47.833

这是因为您的代码会不断覆盖touching 变量，所以最后只显示最后一个结果。

在 foreach 之前，重置 touch 变量，`touching = "";`并像这样扩展 if：

```
if (sprite.collisionRect.Intersects(player.collisionRect) || touching == "touching") 
```

这样，如果任何精灵正在触摸您的玩家精灵，您将获得“触摸”。

# javascript - DOM 更改 Javascript

> ID：10372603
> 
> 赞同：0
> 
> 时间：2012-04-29T13:49:06.710
> 
> 标签：javascript, jquery, node.js

我试图进行一些 DOM 更改。当我尝试添加或更新我的 DOM 时，可以通过这个小代码片段

```
$(abc).each(function() {    
    if (($(this).attr("id") != "SceneOne")) {
        var txt=$($.parseXML(xml)).find(shashin).children().appendTo(thashin);
        console.log(txt);
    }
}); 
```

并删除我使用的 DOM 结构的某些部分

```
var targeti = $(this).find("targetid").text();
var el=document.getElementById(targeti);
el.parentNode.removeChild(el); 
```

但是，当我使用 Node.js 为我的服务器端 JS 使用代码时。添加和更新功能完美运行，但删除功能却不行。我也尝试从 Jquery library 使用它，[但这](http://api.jquery.com/remove/)也不起作用。

任何想法为什么？

# javascript - 与哪个阶段负载事件有关？

> ID：10372607
> 
> 赞同：4
> 
> 时间：2012-04-29T13:49:38.400
> 
> 标签：javascript, jquery, html, image

```
$(".img").on("load",function () {...} ); 
```

确实在以下情况`load`下提出：

*   img 是否已完全下载到计算机？

或者

*   img 完全由浏览器呈现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T13:54:39.173

从[规格](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-htmlevents)：

> **load：**当 DOM 实现完成加载文档中的所有内容、FRAMESET 中的所有框架或 OBJECT 元素时，会发生加载事件。

* * *

更具体[的来自 HTML5 规范](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#update-the-image-data)：

> 当用户代理要**更新元素的图像数据**时[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element) ，它必须运行以下步骤：
> 
> 1.  [`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)将元素返回到[不可用](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#img-none)状态。
> 2.  如果[获取](http://www.w3.org/TR/2011/WD-html5-20110525/fetching-resources.html#fetch)算法的实例仍在为此元素运行，则中止该算法，丢弃该 算法生成的任何未决[任务。](http://www.w3.org/TR/2011/WD-html5-20110525/webappapis.html#concept-task)
> 3.  忘记[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)元素的当前图像数据（如果有）。
> 4.  如果用户代理不支持图像，或者它对图像的支持已被禁用，则中止这些步骤。
> 5.  如果元素的[`src`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#attr-img-src)属性值为空字符串，则将元素设置为[损坏](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#img-error)状态，[将任务排队](http://www.w3.org/TR/2011/WD-html5-20110525/webappapis.html#queue-a-task)以 [触发](http://www.w3.org/TR/2011/WD-html5-20110525/webappapis.html#fire-a-simple-event)`error`在元素上命名的简单事件[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)，然后中止这些步骤。
> 6.  否则，[解析](http://www.w3.org/TR/2011/WD-html5-20110525/urls.html#resolve-a-url)元素[`src`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#attr-img-src)属性的值，相对于元素，如果成功，则 [获取](http://www.w3.org/TR/2011/WD-html5-20110525/fetching-resources.html#fetch)该资源。以这种方式获得的资源 [SIC] 是[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)元素的图像数据。获取图像必须[延迟](http://www.w3.org/TR/2011/WD-html5-20110525/the-end.html#delay-the-load-event)元素文档的加载事件，直到一旦获取资源（定义如下），网络任务源排队的任务已经运行。...在获取资源后，网络任务源排队的任务必须根据以下备选方案采取适当的行动：
> 
> ### ↪ 如果下载成功
> 
> 将[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)元素设置为[完全可用](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#img-all)状态，适当地更新图像的呈现，并[排队任务](http://www.w3.org/TR/2011/WD-html5-20110525/webappapis.html#queue-a-task)以[触发](http://www.w3.org/TR/2011/WD-html5-20110525/webappapis.html#fire-a-simple-event)`load`在[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)元素上 命名的简单事件。
> 
> ### ↪ 否则
> 
> 将[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)元素设置为[损坏](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#img-error)状态，并将任务排队以触发以元素命名的简单`error`事件[`img`](http://www.w3.org/TR/2011/WD-html5-20110525/embedded-content-1.html#the-img-element)。

基于此，具体来说：

1.  将`img`元素设置为完全可用状态
2.  适当地更新图像的呈现方式，并且
3.  排队任务以触发以元素命名的`load`简单`img`事件

...加载事件**仅在浏览器完全呈现图像后**触发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T13:56:38.390

阅读这些行后：

> 一旦图像被加载，处理程序就会被调用。
> 
> 可以停止对已经存在于浏览器缓存中的图像进行触发

我理解回答*“img 已完全下载到计算机”*

[来源](http://api.jquery.com/load-event/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T01:42:53.150

您问：“加载事件与哪个阶段有关？”

然后发布了一个不完整的 jQuery 片段：

```
$(".img").on("load",function () {...} ); 
```

IMG 元素的`onload`事件处理程序（其代码由浏览器自己处理）与 jQuery 的`on`实例方法不同。所以不清楚你想知道什么。

正如您的问题、随后的回复和源代码本身（请阅读下文）所证明的那样，jQuery 继续作为如何不设计 API 的示例——在他们被告知有什么问题之后将近 7 年它。

那么它有什么问题呢？简而言之，jQuery 方法被设计为具有松散的通用合同。他们期望任何东西（字符串、宿主对象等）、类型检查，然后根据可选参数，有时甚至是可选的中间参数，以不同的行为重载方法，并使用广泛的条件逻辑来处理所有情况。该`on`方法以内部标志`one`（`if (one === 1)`-- 如果它是 2 怎么办？）结束它。

```
jQuery.fn.extend({

on: function( types, selector, data, fn, /*INTERNAL*/ one ) {
    var origFn, type;

    // Types can be a map of types/handlers
    if ( typeof types === "object" ) {
        // ( types-Object, selector, data )
        if ( typeof selector !== "string" ) { // && selector != null
            // ( types-Object, data )
            data = data || selector;
            selector = undefined;
        }
        for ( type in types ) {
            this.on( type, selector, data, types[ type ], one );
        }
        return this;
    }

    if ( data == null && fn == null ) {
        // ( types, fn )
        fn = selector;
        data = selector = undefined;
    } else if ( fn == null ) {
        if ( typeof selector === "string" ) {
            // ( types, selector, fn )
            fn = data;
            data = undefined;
        } else {
            // ( types, data, fn )
            fn = data;
            data = selector;
            selector = undefined;
        }
    }
    if ( fn === false ) {
        fn = returnFalse;
    } else if ( !fn ) {
        return this;
    }

    if ( one === 1 ) {
        origFn = fn;
        fn = function( event ) {
            // Can use an empty set, since event contains the info
            jQuery().off( event );
            return origFn.apply( this, arguments );
        };
        // Use same guid so caller can remove using origFn
        fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
    }
    return this.each( function() {
        jQuery.event.add( this, types, fn, data, selector );
    });
},
one: function( types, selector, data, fn ) {
    return this.on( types, selector, data, fn, 1 );
} 
```

# spring-integration - 网关和服务激活器有什么区别？

> ID：10372608
> 
> 赞同：24
> 
> 时间：2012-04-29T13:49:48.457
> 
> 标签：spring-integration, enterprise-integration

作为消息端点的网关和服务激活器有什么区别（就企业集成模式而言）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-29T17:42:19.747

[http://eaipatterns.com/](http://eaipatterns.com/)

通常，服务激活器用于调用本地服务，服务不知道它是从消息传递系统调用的。

网关通常是消息传递系统的入口或出口点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-25T21:24:57.977

服务激活器调用应用程序开发人员提供实现的对象上的方法。Spring Integration 负责使用来自输入通道的消息调用该方法，并将结果分流到某个输出通道。应用程序提供的代码可以做一些任意的工作。

对于网关应用开发者只提供一个接口，它的实现由Spring提供。

Spring Integration 文档的附录包括一个[Cafe 示例](http://docs.spring.io/spring-integration/docs/2.0.0.RC1/reference/html/samples.html#samples-cafe)，其中 Barista 是通过服务激活器调用的服务，Cafe 是网关。

应用程序的 main 方法从 Spring 应用程序上下文中查找一个 Cafe 对象，并在其上调用 placeOrder，将 Order 作为参数传入：

```
public static void main(String[] args) {
      AbstractApplicationContext context = null;
      if (args.length > 0) {
          context = new FileSystemXmlApplicationContext(args);
      }
      else {
          context = new ClassPathXmlApplicationContext(
          "cafeDemo.xml", CafeDemo.class);
      }
      Cafe cafe = (Cafe) context.getBean("cafe");
      for (int i = 1; i <= 100; i++) {
          Order order = new Order(i);
          order.addItem(DrinkType.LATTE, 2, false);
          order.addItem(DrinkType.MOCHA, 3, true);
          cafe.placeOrder(order);
      }
  } 
```

Cafe 是应用程序不为其提供实现的接口。Spring 生成一个实现，将传递给它的订单发送到称为“订单”的输入通道。

在管道的下方，有两个服务激活器引用了 Barista。Barista 是一个 POJO，其代码可用于创建如下所示的饮品：

```
 public Drink prepareHotDrink(OrderItem orderItem) {
      try {
          Thread.sleep(this.hotDrinkDelay);
          System.out.println(Thread.currentThread().getName()
                  + " prepared hot drink #" + hotDrinkCounter.incrementAndGet()
                  + " for order #" + orderItem.getOrder().getNumber() 
                  + ": " + orderItem);
          return new Drink(orderItem.getOrder().getNumber(), 
                  orderItem.getDrinkType(),
                  orderItem.isIced(), orderItem.getShots());
      }
      catch (InterruptedException e) {
          Thread.currentThread().interrupt();
          return null;
      }
  } 
```

咖啡师从服务激活器的输入通道接收饮料订单，并在其上调用一个返回饮品的方法，该饮品通过服务激活器的输出通道“preparedDrinks”发送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-11T07:21:25.127

对我来说，网关用于进行抽象并为一个或多个后端服务提供规范化的 API。例如，您有 5 个提供者使用不同的方式与您交互（SOAP、REST、XML/http 等等），但您的客户只需要一种方式来获取数据（比如说 json/REST）。网关会将来自您的客户端的 json 请求转换为具有自己协议的正确后端，然后将后端响应转换为 json 以将响应提供给您的客户端。

服务激活器更多地充当传入消息的触发器。假设您的激活器轮询数据库以获取传入消息，然后当条件满足“激活”时，它会调用底层服务。

[网关信息在这里。](https://martinfowler.com/eaaCatalog/gateway.html)

[激活器的信息在这里。](http://www.eaipatterns.com/MessagingAdapter.html)

# android - 为 Eclipse 配置 ADT 插件——首选项中没有 Android 选项

> ID：10372612
> 
> 赞同：4
> 
> 时间：2012-04-29T13:50:11.237
> 
> 标签：android, eclipse-adt

我正在我的电脑上安装安卓。操作系统是 windows xp sp-2。我正在使用以下指南：http: [//developer.android.com/sdk/eclipse-adt.html#installing](http://developer.android.com/sdk/eclipse-adt.html#installing)

在我配置 ADT 插件时下载 ADT 插件后，我通过 Windows > 首选项（步骤 1）打开首选项，但左侧​​没有“Android”选项，如步骤（2）所示。

知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T14:31:30.597

我只在“Java”透视图中看到android按钮，而不是在“Java EE”透视图......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-06T13:57:27.900

使用 Ubuntu 12.04（32 位）

以下是对我有用的步骤（尽管我怀疑第 2 步就足够了）。

1) 拆下 ADT。

2) 将您的 .eclipse 目录移开（重命名或删除它）。

3) 安装 ADT

作为旁注，一旦我这样做了，我注意到蚂蚁的设置也出现了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-29T14:13:16.870

我刚遇到这样的问题，这就是我在 30 秒内解决它的方法。在 Eclipse 窗口的左上角（在最小化、最大化和关闭按钮下方）右键单击 Java 透视图按钮并从上下文菜单中选择重置。简单得可笑/令人沮丧，对吧？希望这可以节省您一些时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T13:53:27.697

左下角是否有一个android图标。如果有，你已经安装正确，如果没有，请重新安装：）

# gcc - 海合会技术细节

> ID：10372616
> 
> 赞同：-1
> 
> 时间：2012-04-29T13:50:34.047
> 
> 标签：gcc

我不知道这是否适合这样的事情，但我对 GCC 前端/后端架构的几个方面感到好奇：

1.  我知道我可以`.o`从 C 代码编译文件并将它们链接到 C++ 代码，我想我也可以反过来做。这是因为这两种语言相似，还是因为 GCC 后端真的与语言无关？这也适用于 ADA 代码吗？（我什至不知道这是否有意义，因为我不知道 ADA 或者它是否具有“功能”，但问题是可以理解的。如果没有意义，请考虑“帕斯卡”甚至“我自己的习惯”语言前端")
2.  垃圾收集将在哪里实施？例如，Java 前端。我理解的方式，如果编译到JVM后端，“平台”会处理GC，所以前端不需要做任何事情，但如果编译为本机代码，前端会将垃圾收集 GENERIC 代码发送到后端，还是打开一些标志告诉后端生成垃圾收集代码？第一个对我来说更有意义，但这意味着前端会根据目标产生不同的输出，这似乎错过了 GCC 的前端/后端架构的重点。
3.  特定语言的库会去哪里？例如，标准 Java 类或标准 C 头文件。如果它们最后被链接，那么理论上 C 程序是否可以从 Java 库或类似的东西中调用函数，因为它只是另一个链接库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:09:59.413

1.  是的，后端至少合理地独立于语言。是的，它适用于[Ada](http://gcc.gnu.org/wiki/GNAT)。
2.  [GCJ](http://gcc.gnu.org/java/)生成使用运行时库的本机代码。垃圾收集器是运行时库的一部分。
3.  GCJ 实现了[CNI](http://gcc.gnu.org/onlinedocs/gcj/About-CNI.html)，它允许你用 C++ 编写代码，这些代码可以被 Java 代码用作本机方法——但能够做到这一点是他们设计它的结果，而不仅仅是使用相同的意外副产品后端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:14:28.070

1.  这是可能的，因为调用约定是兼容的，但是名称修改不同（C 中没有修改）。要从 C++ 调用 C 函数，您应该使用`extern "C"`. 并且要从 C 调用 C++ 函数，您应该使用重命名的名称声明它（并且可能使用其他或不同的类型 args）。在某些情况下也可以调用 Fortran 代码，但参数传递约定不同（在 Fortran 中通过 ref 传递）。实际上有一个从 C++ 到 C (cfront) 和从 fortran 到 c (f2c) 的转换器，并且仍然使用它们的一些解决方案。

2.  垃圾收集在运行时库中实现，例如 boehm。后端应生成与所选 GC 库兼容的对象。

3.  编译器驱动程序（g++、gfortran、..）将在链接步骤中添加特定于语言的库。

# xaml - Windows 8 GridView - 每次显示两个项目

> ID：10372620
> 
> 赞同：-1
> 
> 时间：2012-04-29T13:50:58.430
> 
> 标签：xaml, windows-8, windows-runtime, winrt-xaml

我需要使用 GridView 控件来实现一本书。特别是我正在寻找一种每次只显示 2 个项目并且仍然能够使用滚动条滚动整个列表的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T03:51:46.687

您的问题不是很清楚，但我假设您在询问如何向您的应用程序询问 2 行或列的块。查看默认的新 Metro 应用程序模板。它的中心页面有一个多行网格视图。关键是使用 WrapGrid 或 VariableSizedWrapGrid 来显示您的项目。在示例中，使用了 gridview，但随后将 wrapgrid 用作项目模板（用于每组项目）。

# javascript - 从纵向切换到横向时检测移动设备上的浏览器窗口调整大小，反之亦然

> ID：10372624
> 
> 赞同：0
> 
> 时间：2012-04-29T13:52:10.950
> 
> 标签：javascript, cross-browser, mobile-browser

我正在使用以下代码来监视屏幕大小的变化并运行`alertSize()`，但它仅在加载页面时才有效，然后它不起作用

```
 window.onresize=alertSize(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T13:54:02.713

你要

```
window.onresize = alertSize; 
```

您需要设置“onresize”属性来引用您的函数，而不是调用函数的结果。

实际上你可能不应该尝试这个，因为测试你的函数是否真的使用`alert()`. 在桌面计算机上调整窗口大小时，浏览器会触发**许多“调整大小”事件。**

您可能还想研究 CSS 媒体查询。

# vb.net - VB.NET 中的数组列表

> ID：10372625
> 
> 赞同：0
> 
> 时间：2012-04-29T13:52:44.433
> 
> 标签：vb.net, arraylist

在下面的代码中，函数 CreatePage 有一个名为 thumbs 的参数。thumbs 是一个数组列表。我的问题是，您是否知道是否可以将 arraylist thumbs 拆分为 15 的部分并使用 thumbs(1-15)、thumbs(16-30)、thumbs(31-45) 等调用该函数。直到arraylist为空。

```
html.CreatePage(txtTitleTag.Text, txtText.Text, "index", txtDirectory.Text & "\", thumbs,  txtMetaDesc.Text, txtMetaKeywords.Text, "test.com", "test2.com",  BackgroundColor, FontColor) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:37:13.590

首先，从 a 切换`ArrayList`到 a `List(Of String)`。`ArrayList`在 .NET 2.0 中已经过时了，您将从强类型中受益匪浅。

接下来，这是一个分块 a 的方法`List`：

```
<System.Runtime.CompilerServices.Extension()>
Public Function Chunk(Of T)(ByVal this As List(Of T), ByVal length As Integer) As List(Of List(Of T))
    Dim result As New List(Of List(Of T))
    Dim current As New List(Of T)

    For Each x As T In this
        current.Add(x)

        If current.Count = length Then
            result.Add(current)
            current = New List(Of T)
        End If
    Next

    If current.Count > 0 Then result.Add(current)

    Return result
End Function 
```

现在，只需使用`For Each`遍历块的循环：

```
For Each chunk As List(Of String) In myList.Chunk(15)
    'Call the function and pass chunk as an argument
Next 
```

瞧！

# linux - Bash shell `if` 命令返回一些东西 `then` 做某事

> ID：10372626
> 
> 赞同：14
> 
> 时间：2012-04-29T13:52:52.097
> 
> 标签：linux, bash, if-statement

我正在尝试执行 if/then 语句，如果`ls | grep something`命令有非空输出，那么我想执行一些语句。我不知道我应该使用的语法。我尝试了几种变体：

```
if [[ `ls | grep log ` ]]; then echo "there are files of type log"; 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-29T14:00:06.397

好吧，这很接近，但你需要完成`if`with `fi`。

此外，`if`如果命令成功（以状态码 0 退出），只需运行命令并执行条件代码，这`grep`仅在找到至少一个匹配项时才会执行。所以你不需要检查输出：

```
if ls | grep -q log; then echo "there are files of type log"; fi 
```

`grep`如果您使用的是不支持("quiet") 选项的旧版本或非 GNU 版本的系统，则`-q`可以通过将其输出重定向到`/dev/null`：

```
if ls | grep log >/dev/null; then echo "there are files of type log"; fi 
```

但是由于`ls`如果它没有找到指定的文件也会返回非零，你可以在没有的情况下做同样的事情`grep`，就像在 D.Shawley 的回答中一样：

```
if ls *log* >&/dev/null; then echo "there are files of type log"; fi 
```

您也可以只使用 shell 来完成它，甚至不使用`ls`，尽管它有点冗长：

```
for f in *log*; do 
  # even if there are no matching files, the body of this loop will run once
  # with $f set to the literal string "*log*", so make sure there's really
  # a file there:
  if [ -e "$f" ]; then 
    echo "there are files of type log"
    break
  fi
done 
```

只要您专门使用 bash，您就可以设置`nullglob`选项来简化它：

```
shopt -s nullglob
for f in *log*; do
  echo "There are files of type log"
  break
done 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-26T02:40:36.353

或没有`if; then; fi`：

```
ls | grep -q log && echo 'there are files of type log' 
```

甚至：

```
ls *log* &>/dev/null && echo 'there are files of type log' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:03:44.457

`if`内置执行shell命令并根据命令的返回值选择块 。`ls`如果没有找到请求的文件，则返回一个不同的状态代码，因此不需要该`grep`部分。该`[[` *实用程序*实际上是来自 bash IIRC 的内置命令，用于执行算术运算。我在这方面可能是错的，因为我很少偏离 Bourne shell 语法。

无论如何，如果你把所有这些放在一起，那么你最终会得到以下命令：

```
if ls *log* > /dev/null 2>&1
then
    echo "there are files of type log"
fi 
```

# android - 如果我使用 android Project Build Target 4.0，我的应用会在 android 2.2 上显示广告吗？

> ID：10372627
> 
> 赞同：0
> 
> 时间：2012-04-29T13:52:57.550
> 
> 标签：android, android-layout, android-intent, android-emulator, android-ndk

当我尝试在 android Project Build Target 2.2 下使用 GoogleAdMobAdsSdk-6.0.0 时，出现错误“com.google.ads.AdActivity 的 android:configChanges 值必须包括 screenSize。” 我将 android Project Build Target 更改为 4.0 并添加了 android:name="com.google.ads.AdActivity" android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" 它工作正常 android:minSdkVersion= "8" 安卓:targetSdkVersion="14"

那么，广告会在 android 2.2 或更早版本上展示吗？我的应用程序可以安装在 android 2.2 或更早版本上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:17:44.867

`minSdkVersion="8"`意味着它与[API 级别](http://developer.android.com/guide/appendix/api-levels.html)8（即 2.2 ）的所有内容兼容

因此，您的应用程序无法在 2.1 或更低版本的设备上运行，它应该在至少 2.2 的所有设备上运行并显示添加

`android:targetSdkVersion="14"`意味着您已经测试了您的应用程序并声明它与最高版本 14 (4.0.2) 兼容。Android 将禁用一些兼容性选项，您应该检查您的应用程序是否真的在该版本上运行。

# segmentation-fault - MPI 发送接收。在运行时打印出不正确的进程等级和分段错误

> ID：10372630
> 
> 赞同：0
> 
> 时间：2012-04-29T13:53:28.937
> 
> 标签：segmentation-fault, mpi

```
void iso_diffusion_denoising(image *u, image *u_bar, float kappa, int iters) { 

  int my_rank,num_procs;
  float *temp;
  int i,j,k=0;
  MPI_Comm_rank(MPI_COMM_WORLD, &my_rank);
  MPI_Comm_size(MPI_COMM_WORLD, &num_procs);
  int m=u->m;
  int n=u->n;
  //temp= malloc(n*sizeof(float));//1*n array ?

  float *ptr;

  for(k=0;k<iters;k++) {

for(i=1; i<m-1; i++) { 

  for(j=1; j<n-1; j++) {

    /*  temp[m-1]=u->image_data[m-1][0];
    temp[m-1]=u->image_data[m-1][n-1];
    temp[i]=u->image_data[m-1][j];*/

    u_bar->image_data[i][j]= u->image_data[i][j] + kappa*(u->image_data[i-1][j] + u->image_data[i][j-1] - 4*u->image_data[i][j] + u->image_data[i][j+1] + u->image_data[i+1][j]);
    u->image_data[i][j]=u_bar->image_data[i][j];
  } 
}

//temp[m-1][n-1]
if(my_rank==0) {
  ptr = u->image_data[m-1];
  MPI_Send(&ptr[0],n,MPI_FLOAT,1,1,MPI_COMM_WORLD);
  MPI_Recv(&temp,n,MPI_FLOAT,1,2,MPI_COMM_WORLD,&status);
  printf("my rank is :  %d ", my_rank);
  fflush(stdout);
} else if(my_rank==1) { //if(my_rank!=num_procs) {
  ptr = u->image_data[0];
  MPI_Send(&ptr[0],n,MPI_FLOAT,0,2,MPI_COMM_WORLD);
  MPI_Recv(&temp,n,MPI_FLOAT,1,1,MPI_COMM_WORLD,&status);
  printf("my rank is :  %d ", my_rank);
  fflush(stdout);
}

  }

} 
```

`mpirun -np 2 Oblig 0.1 20 noisy denoised`

```
my rank is : 1114636288 [safir:22140] *** Process received signal ***
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 22140 on node safir.ifi.uio.no exited on signal 11 (Segmentation fault). 
```

为什么`my_rank`打印出来的值非常大？我也遇到了分段错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:27:07.067

问题似乎与您对 MPI_Recv 的第一个参数有关。在这里，您正在发送一个指针，`temp`该指针本身就是一个指针。MPI_Recv 试图从为指针`n`保留的内存位置开始复制浮点数。`temp`您需要为`temp`（取消注释对 malloc 的调用）分配内存并将 MPI_Recv 调用更改为：

```
MPI_Recv(temp, ... 
```

这很可能`my_rank`是获得垃圾价值的地方。MPI_Recv 正在尝试写入`n * sizeof(float)`存储的数据字节，`temp`并覆盖到为其他变量保留的内存中，即`my_rank`.

完成后不要忘记释放分配给`temp`它的任何内存！

其他几件事，我做了很少的 MPI 编程，但我认为你在`my_rank == 1`块中的 MPI_Recv 调用的源应该是 0。我还认为 MPI_Send 和 MPI_Recv 是阻塞调用 - 换句话说，它们直到传输才会返回要么完成，要么失败。由于您的两个队伍都首先调用 MPI_Send，我希望他们会阻塞和死锁您的程序。也许他们失败了——你应该检查 MPI_Send 的返回值是否成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T16:09:50.490

除了段错误之外，您的代码也可能会阻塞，因为对于更大`n`的 MPI 实现可能会使用同步语义和死锁，因为两个等级都等待`MPI_Send`完成以发布接收，但这永远不会发生，因为对于同步发送返回，匹配的接收必须被张贴。

您应该在`MPI_Send`其中`MPI_Recv`一种`if`情况下（例如 for `my_rank == 0`）或（更好的解决方案是）使用`MPI_Sendrecv`专门设计为永不死锁的使用的顺序。

要回答您为什么要这样打印排名的问题-堆栈损坏。通过传递缓冲区指针的地址，您实际上会在堆栈中收到消息，从而覆盖其他局部变量。

# java - Spring MVC - 如何在缺少参数时返回 404

> ID：10372632
> 
> 赞同：11
> 
> 时间：2012-04-29T13:53:43.930
> 
> 标签：java, spring-mvc

每当我没有传递所有参数时，我都想触发 404 页面。假设我有以下 URI：

```
/myapp/op?param1=1&param2=2@param3=3 
```

如果没有调用参数，我想返回 404 页面。我试着做：

```
@ResponseStatus(HttpStatus.NOT_FOUND)
@RequestMapping(value = "op", params = { "!param1" })
public void missingArg() {
} 
```

但后来我得到一个异常，告诉我处理丢失的第二个和第三个参数的方法之间存在歧义。

那我该怎么做呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-29T15:56:21.173

如果您使用的是 Spring 3.1，您可以像这样定义一个异常类：

```
@ResponseStatus(value = HttpStatus.NOT_FOUND)
public final class ResourceNotFoundException extends RuntimeException {
   //  class definition
} 
```

现在，无论何时抛出该异常，Spring 都会返回`@ResponseStatus`注释中定义的 http 状态。例如：

```
@RequestMapping(value = "/op")
public void methodWithRequestParams(@RequestParam(value = "param1", required = false) String param1, 
        @RequestParam(value = "param2", required = false) String param2) {
  if (param1 == null || param2 == null) {
    throw new ResourceNotFoundException();
  }
} 
```

`404`将在任何时候返回 a`param1`或`param2`为空。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-29T14:33:19.353

您不必实现该`missingArg()`功能。如果传入请求没有匹配的方法，则 Spring 的[HandlerExceptionResolver](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-exceptionhandlers)将处理它并返回带有适当状态代码的响应。

如果使用[@RequestParam](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-requestparam)注解，Spring 会自动将请求参数转换为方法参数：

```
@RequestMapping(value = "/op")
public void methodWithRequestParams(@RequestParam("param1") String param1, 
        @RequestParam("param2") String param2, 
        @RequestParam("param3") String param3) {

    // do something with params
} 
```

按照惯例，`methodWithRequestParams()`如果不是所有参数都是请求的一部分，则不会调用该方法（除非 的`required`属性`@RequestParam`设置为`false`）。

另请注意，参数不必是字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-14T14:48:07.107

与 matsev 在另一个答案的评论中所说的相呼应，您不应该`@ResponseStatus(HttpStatus.NOT_FOUND)`在这种情况下使用，而是`@ResponseStatus(HttpStatus.BAD_REQUEST)`.

`@ResponseStatus(HttpStatus.NOT_FOUND)`应该在请求正确形成但资源不存在时使用。

# php - 根据总数确定病例数（4,6,12）

> ID：10372634
> 
> 赞同：2
> 
> 时间：2012-04-29T13:53:51.783
> 
> 标签：php, function, math

我有一个物品购物车，如果我可以将物品均匀放入 4,6 或 12 箱中，我可以运送物品，没有剩余。我想我已经弄清楚了，但是如果我的购物车有 8 件商品，我的代码失败了，因为它会计算出 1 6 剩下 2 件，而不是计算出它可以在 2 4 包中工作。8 当然不是唯一可能导致我必须失败的数字，而是它的一个例子。我怎样才能让我的代码正确地解决这个问题？以下是我现在所拥有的，我仍然以 $qTY var 中的金额和金额 8 作为它失败的示例。

```
$num12s = $tQTY / 12;

$num12s = explode(".", $num12s);
$numCases = $num12s[0];

if($num12s[0] >= 1){

$doSub = $num12s[0] * 12;
$tQTY = $tQTY - $doSub;

}

$num6s = $tQTY / 6;
$num6s = explode(".", $num6s);
$numCases = $numCases + $num6s[0];

if($num6s[0] >= 1){

$doSub = $num6s[0] * 6;
$tQTY = $tQTY - $doSub;

}

$num4s = $tQTY / 4;
$num4s = explode(".", $num4s);
$numCases = $numCases + $num4s[0];

if($num4s[0] >= 1){

$doSub = $num4s[0] * 4;
$tQTY = $tQTY - $doSub;

} 
```

我需要先装一个 12 箱，如果我不能这样做，我接下来需要装 6 箱，如果我不能这样做，我需要装 4 箱，但如果我不能按这个顺序装箱 2 箱4 个（适用于 8 个手推车）或 12 个案例、6 个案例和 4 个案例（适用于 22 个手推车）等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T14:09:33.610

假设您只想知道是否可以交付这些物品（没有关于包裹如何分区的信息），这不是完全没有必要吗？在这种情况下，这很容易：*每个*偶数 >=4 都会起作用，所以它只是：

```
$possible = ($number>=4 && $number%2==0); 
```

**编辑：**
如果您还需要有关包装的更多详细信息，我会创建一些类似这样的功能（[请参阅它在键盘上的工作](http://codepad.org/gFSSCzmT)）：

```
/*
 *  determines if the given number of items is deliverable or not.
 */
function delivery_possible($number_of_items){
  return ($number_of_items>=4 && $number_of_items%2==0);
}

/*
 *  returns an array containing a counter for each package-size given
 *  the number of items. returns false if it can't be solved without
 *  leaving a rest.
 */
function delivery_packages($number_of_items){
  if(!delivery_possible($number_of_items)){
    return false; //impossibru!!!
  }
  $r = array('size4'=>0, 'size6'=>0, 'size12'=>0);

  $r['size12'] = $number_of_items%12==0?(int)($number_of_items/12):(int)(($number_of_items-4)/12);
  $number_of_items -= $r['size12']*12;

  $r['size6'] = $number_of_items%6==0?(int)($number_of_items/6):(int)(($number_of_items-4)/6);
  $number_of_items -= $r['size6']*6;

  $r['size4'] = (int)($number_of_items/4);

  return $r;
} 
```

# java - java抛出异常java.lang.IndexOutOfBoundsException：

> ID：10372637
> 
> 赞同：2
> 
> 时间：2012-04-29T13:53:56.737
> 
> 标签：java, list, exception, indexoutofboundsexception

我正在创建一个程序，它需要一系列数字并添加这些数字的最小对。失败的代码如下：

```
import java.util.*;

public class Library {

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);

        String answer;
        int count;
        int books;
        int writers;
        List<Integer> booksList = new LinkedList<>();
        System.out.printf("Numbers: ");

        answer = input.nextLine();
        String[] arr = answer.split(" ");

        for (String num : arr) {
            booksList.add(Integer.parseInt(num));
        }

        books = booksList.remove(0);
        writers = booksList.remove(0);

        while (booksList.size() > writers) {
            mergeMinimalPair(booksList);
        }
    }

    public static void mergeMinimalPair(List<Integer> books) {  
        int index = 0;
        int minValue = books.get(0) + books.get(1);

        for (int i = 1; i <= books.size() - 1; i++){
            if ((books.get(i) + books.get(i + 1)) < minValue){
                index = i;
                minValue = books.get(i) + books.get(i + 1);
            }
        }
        //combine(books, index, index + 1);
    } 
```

combine 方法尚未实现。我检查了调试器，当它即将执行该`mergeMinimalPair`方法时，它会抛出以下异常：

```
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 7, Size: 7
    at java.util.LinkedList.checkElementIndex(LinkedList.java:553)
    at java.util.LinkedList.get(LinkedList.java:474)
    at Library.mergeMinimalPair(Library.java:40)
    at Library.main(Library.java:29)
Java Result: 1 
```

如何避免此异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:56:49.913

在代码中

```
for (int i = 1; i <= books.size() - 1; i++){
    if ((books.get(i) + books.get(i + 1) 
```

i 的最大值是，`book.size() - 1`但是`books.get(i + 1)`这个索引太大了。

最简单的改变是

```
for (int i = 1; i < books.size() - 1; i++){ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T13:57:11.510

问题在这里：

```
for (int i = 1; i <= books.size() - 1; i++){
    if ((books.get(i) + books.get(i + 1)) < minValue){
        index = i;
        minValue = books.get(i) + books.get(i + 1);
    }
} 
```

您正在迭代到`books.size() - 1`. 当`i`完全 等于 时`books.size() - 1`,`i + 1`等于`books.size()`, 当 你 这样做 时 被 认为 是 越界`books.get(i + 1)`. 使固定：

```
for (int i = 1; i < books.size() - 1; i++){
    if ((books.get(i) + books.get(i + 1)) < minValue){
        index = i;
        minValue = books.get(i) + books.get(i + 1);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-29T13:57:16.723

您的循环从`1`to 开始`books.size() - 1`，而不是 from `0`to `books.size() - 2`。在 Java 中，数组和集合索引总是从 0（包含）到 size（排除）。

# java - 通过 jacob java-com 桥更改系统时间

> ID：10372641
> 
> 赞同：1
> 
> 时间：2012-04-29T13:54:18.970
> 
> 标签：java, jacob

我正在尝试使用 Jacob 来更改系统时间。我写了以下方法：

```
/*******************************************************************************
* Sets the system time.
*
* @param par_sSystemTime String
*******************************************************************************/
public void setSystemTime(String par_sSystemTime)
{
    ActiveXComponent os =null;
    ComThread.InitMTA();
    try
    {
        InetAddress address =    FoxEnvironment.getRemoteAddress(FoxEnvironment.getLocalHostName()); 
        String connectStr = String.format("winmgmts:{impersonationLevel=impersonate, authenticationLevel=pkt}!\\\\%s\\root\\CIMV2", address.getHostName());
        ActiveXComponent wmi = new ActiveXComponent(connectStr);
        Variant instances = wmi.invoke("InstancesOf", "Win32_OperatingSystem");
        Enumeration<Variant> en = new EnumVariant(instances.getDispatch());
        os = new ActiveXComponent(en.nextElement().getDispatch());
        os.invoke("SetDateTime", par_sSystemTime);
    }
    catch(Exception ex)
    {
       ex.printStackTrace();
       ML.logMsg(MLCon.SERR, null, BaseMessages.GENERAL_UNEXPECTED_ERROR,"setSystemTime(): " + ex);
    }
    catch(NoClassDefFoundError ex)
    {
       ex.printStackTrace();
       ML.logMsg(MLCon.SERR, null, BaseMessages.GENERAL_UNEXPECTED_ERROR,"setSystemTime(): " + ex);
    }
    finally
    {
       // Release the components
       if (os != null)
       {
          os.safeRelease();
          os = null;
       }
       ComThread.Release();
    }
} 
```

执行此方法时，获取异常

com.jacob.com.ComFailException：调用：SetDateTime 源：SWbemObjectEx 描述：访问被拒绝。

任何人都可以帮助解决这个问题吗？

在此先感谢，华伦天奴

# spring - 错误：元素“security:authentication-provider”的前缀“security”未绑定

> ID：10372649
> 
> 赞同：1
> 
> 时间：2012-04-29T13:54:50.143
> 
> 标签：spring, spring-security, applicationcontext

这是我的 application-security.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?> 
<!--
  - Sample namespace-based configuration
  -
  - $Id: applicationContext-security.xml 3019 2008-05-01 17:51:48Z luke_t $
  -->
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:beans="http://www.springframework.org/schema/beans"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/security 
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<global-method-security secured-annotations="enabled">
</global-method-security> 
```

```
 <!-- Don't set any role restrictions on login.jsp -->
    <intercept-url pattern="/login.jsp" access="IS_AUTHENTICATED_ANONYMOUSLY" />

    <!-- Restrict access to ALL other pages -->
    <intercept-url pattern="/**" access="ROLE_USER" />
    <intercept-url pattern="/admin/*.html" access="ROLE_ADMIN"  />
    <intercept-url pattern="/manager/*.html" access="ROLE_MANAGER"  />
    <intercept-url pattern="/**.html" access="ROLE_USER,ROLE_ADMIN, ROLE_MANAGER"  />
    <!-- Set the login page and what to do if login fails -->
    <form-login login-page="/login.jsp" authentication-failure-url="/login.jsp?login_error=1" default-target-url="/user/userdashboard/dashboard.html"  />
    <logout logout-success-url="/login.jsp"/>
</http>

<!--
Usernames/Passwords are
    rod/koala
    dianne/emu
    scott/wombat
    peter/opal
-->
    **<security:authentication-provider>
        <jdbc-user-service data-source-ref="dataSource" />
    </security:authentication-provider>**
</beans:beans> 
```

一切正常，但我收到“未绑定元素“security:authentication-provider”的前缀“security”的奇怪错误。即使我提供了结束标签。任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-29T14:07:55.563

[通过使用正确的命名空间](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html)，对所有元素使用“安全性” ：

```
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:security="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">
    ...
</beans> 
```

然后在任何地方使用“security:”，例如：

```
<security:global-method-security secured-annotations="enabled">
</security:global-method-security> 
```

或者完全摆脱它：

```
...
<authentication-provider>
        <jdbc-user-service data-source-ref="dataSource" />
    </authentication-provider>
... 
```

因为您配置了默认命名空间`xmlns="http://www.springframework.org/schema/security"`

# wordpress - Wordpress - 自定义字段保存在哪里？

> ID：10372650
> 
> 赞同：2
> 
> 时间：2012-04-29T13:55:11.223
> 
> 标签：wordpress

我已经创建了一些`custom field`- 自定义字段在 WordPress 管理部分中正确显示，但我在数据库中找不到它们。

知道自定义字段保存在哪里吗？`wp_posts`我在表中的帖子数据中找不到我的自定义字段。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T17:31:43.467

保存在 wp_postmeta 表中的自定义字段数据。访问自定义字段的最佳方式是使用 wordpress 内置函数。

例如：

```
<?php
 $mykey_values = get_post_custom_values('my_key');
 foreach ( $mykey_values as $key => $value ) {
     echo "$key  => $value ('my_key')<br />";
 }
?> 
```

0 => 第一个值（'my_key'）

1 => 第二个值（'my_key'）

2 => 第三个值（'my_key'）

您将在此链接中获得有关访问自定义字段的更多信息：http: [//codex.wordpress.org/Custom_Fields](http://codex.wordpress.org/Custom_Fields)

# android - Android - 如何通过 SMS/MMS 发送/读取 vCard？

> ID：10372654
> 
> 赞同：2
> 
> 时间：2012-04-29T13:55:56.000
> 
> 标签：android, sms, contact, mms, vcf-vcard

我正在寻找在我的应用程序中通过 SMS 发送/读取 vCard 的任何方式。我已经阅读了很多文章、网页、论坛等。仍然不知道如何做到这一点。

这里是交易。

1.  用户选择了一些特定的联系人
2.  应用程序为其生成 vCard
3.  用户键入要发送 vCard 的号码
4.  应用程序使用该 vCard 发送短信（？）
5.  收件人使用 vCard 接收短信并要求浏览联系人/添加到联系人（？）

这是stackoverflow中的一些具有相同问题的帖子：[this](https://stackoverflow.com/questions/9697735/how-to-send-vcard-as-an-sms-mms)和[this](https://stackoverflow.com/questions/6080849/how-can-i-send-vcard-contacts-vcf-var-sms-or-mms-in-android)。仍然没有任何帮助...

我发现[这个不错的库](http://code.google.com/p/android-vcard/)可以处理 .vcf 文件（写入和读取）。但是有没有办法将它发送到另一部手机（当然可以正确阅读）？只需将其作为字符串发送即可？

[这里](https://stackoverflow.com/questions/8972905/working-example-of-senddatamessage-for-android)是一篇关于处理 SMSManager.sendDataMessage() 方法发送的接收到的 SMS 数据的很好的堆栈帖子

请帮忙！我很乐意获得任何线索、有用的库或证明它在 Android 上是不可能的。如果没有办法通过短信，你能给我建议如何通过彩信做到这一点吗？

有趣的是，有很多具有该功能的应用程序，所以我想这是可能的。

感谢任何回复的人。祝你有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T05:40:53.900

当您有系统时，您不必从代码中读取彩信。

要使用 vCard 发送彩信，您需要将 .vcf 文件附加到它。

[这](https://stackoverflow.com/questions/10420312/android-how-to-attach-file-to-sms)是如何做到这一点的答案。

# php - 为 WordPress 插件存储文件

> ID：10372656
> 
> 赞同：0
> 
> 时间：2012-04-29T13:56:12.930
> 
> 标签：php, mysql, wordpress

我正在概述一个 WordPress 插件，它将获取一些类似于博客文章的信息，包括特色图片。我不想使用实际的帖子，因为这些信息确实不是博客的一部分。

我的问题是关于存储这些数据的“特色图片”部分。我想将它作为 BLOB 与记录中的其他信息一起放入数据库中，但似乎不是`$wpdb`为处理这种数据类型而构建的对象。

所以我的问题是：如何使用该`$wpdb`对象将 BLOB 数据插入到数据库中，或者是否有更好的替代方法来为此目的使用数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T15:52:59.160

假设您的意思是插件将为多个实体收集此信息，这听起来像是[Custom Post Types](http://codex.wordpress.org/Post_Types)的工作。这将允许您利用帖子的所有功能（包括特色图片），但它们不会污染博客。

还有各种插件可让您通过 UI 生成自定义帖子类型，而无需编写代码。例如，您可以查看自定义帖子类型 UI 插件。

如果您只想使用媒体管理器为插件保存单个图像（而不是每个实体一个），您可以使用教程，如[在您的插件或主题中使用 WordPress 上传器](http://www.webmaster-source.com/2010/01/08/using-the-wordpress-uploader-in-your-plugin-or-theme/)将媒体管理器集成到您自己的设置页面.

此外，您是对的，WordPress 数据库不会将图像存储为 blob。WordPress 将上传的图像文件保存到 wp-content/uploads 目录，并将对它们的 URI 引用存储在数据库中以供以后检索。

# mysql - 计算会员期限，直到现在或直到结束日期

> ID：10372657
> 
> 赞同：1
> 
> 时间：2012-04-29T13:56:21.327
> 
> 标签：mysql, date

我有一个 MySQL 表，其中包含（除其他外）以下列：

```
[名称] [member_since_date] [member_until_date]

```

当某人的成员资格结束时，该`[member_until_date]`字段被填充，否则它包含 NULL。

我需要一个纯粹的基于 SQL 的解决方案来解决以下问题：

我想计算某人成为会员的时间：何时`[member_until_date]`填充，我需要它来计算`[member_until_date] - [member_since_date]`。

当某人仍然是成员时，该字段`[member_until_date]`是`NULL`，所以我需要它来计算`[NOW] - [member_since_date]`。

我希望我对此足够清楚，我希望有人能给我一个答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:11:35.137

要获取日期之间的差异（以天为单位），请使用 DATEDIFF()。要根据条件取一个值或另一个值，请使用 IF，但在这种情况下，我使用的是类似的 IFNULL()。

```
SELECT DATEDIFF(IFNULL(member_until_date, NOW()), member_since_date) AS days_member
FROM ... 
```

IFNULL() 表示使用第一个参数，除非它为空，否则使用第二个参数。

DATEDIFF() 首先需要较大的日期才能获得肯定的结果。

COALESCE() 提供与 IFNULL() 类似的功能，并且是 ANSI SQL 的执行方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:12:04.793

这是一个使用[`DATEDIFF()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_datediff).

```
SELECT name, DATEDIFF(IF(member_until_date,member_until_date,NOW()),
   member_since_date) AS membership_duration
FROM members; 
```

首先，我们检查是否`member_until_date`为空。如果是，我们使用`NOW()`，否则我们使用`member_until_date`。

```
IF(member_until_date,member_until_date,NOW()) 
```

现在我们计算上面和开始成员之间的日期差，`member_since_date`，返回为`membership_duration`。

```
DATEDIFF(IF(member_until_date,member_until_date,NOW()),
   member_since_date) AS membership_duration 
```

# ios - iOS - 访问 Modal 的 Parent 属性

> ID：10372658
> 
> 赞同：3
> 
> 时间：2012-04-29T13:56:36.907
> 
> 标签：ios, modalviewcontroller

我可能过于复杂了，但有没有办法访问模态父项的属性？

因此，我调用“presentModalViewController”，然后我可以访问视图控制器上刚刚从模态调用它的一些属性。

谢谢，阿什利

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T14:45:02.143

如果你使用的是 iOS 5，你可以调用 self.presentingViewController 来访问父视图控制器

这是[苹果参考](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ModalViewControllers/ModalViewControllers.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:47:00.283

您的答案几乎是正确的 - 您想要`presentingViewController`而不是`parentViewController`，但是如果您不小心，这可能会导致紧密耦合（两个类之间的依赖关系，这意味着它们只能相互协作）。

最好仍然定义一个协议，但您的委托属性不是必需的 - 它与该`presentingViewController`属性具有相同的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:36:07.107

好的，所以自从提出这个问题以来，我尝试了一些看起来好像可以工作但没有成功的技术。

这样的例子就是这样。

```
((pController *)self.parentViewController).testString; 
```

然而，虽然它是一个常规的 UIViewController 呈现模式，但父级实际上是一个 UITabBarController，即使使用 selectedViewController 也不起作用。

我的解决方案是添加到我的模态的 .h 文件中

```
id delegate; 
```

和

```
@property (nonatomic, assign) id delegate; 
```

在实现文件中综合它之后，分配/初始化modalViewController，但在呈现它之前我设置了

```
modalViewController.delegate = self; 
```

这样我就可以从我的模态中调用 self.delegate 。这还不够，因为它没有说明它是哪个视图控制器，所以我不能说

```
self.delegate.testString; 
```

但是我之前学到的演员阵容让我得到了一个完全可行的解决方案

```
((pController *)self.delegate).testString; 
```

我希望我不只是胡言乱语，我希望这可以帮助将来的人。

# cocoa - TableView中如何识别item ID并删除数据库

> ID：10372665
> 
> 赞同：0
> 
> 时间：2012-04-29T13:57:25.270
> 
> 标签：cocoa, tableview, fmdb

我是新人，我仍然有一些疑问。我创建了一个将数据从数据库表加载到数组中的类。现在我想通过在 TableView 中选择删除来实现从数据库中删除记录。我有麻烦了。

我无法在 TableView 中显示数据库中项目的描述。字段 _id 显示，但“字段名称”不显示。

就好像对象在数组中不存在一样。

我遇到的另一个问题是如何删除数据库。

```
//Variáveis para coleta de dados do banco
NSString *ID_KEY    = @"_id";
NSString *NAME_KEY  = @"name";
NSString *DESCRIPTION_KEY = @"description";

#pragma mark - Métodos Usuários
- (NSArray *)GetCategories
{
    //Cria uma instância do DataBase para poder trabalhar
    FMDatabase *db = [Database DBWrite];
    //Cria um array para receber os dados do select
    NSMutableArray *array = [[[NSMutableArray alloc] init] autorelease];
    //Testamos se o DataBase está aberto
    if ([db open]){
        //Precisamos de um ResultSet para receber e trabalhar com o resultado do SELECT
        FMResultSet *rs = [db executeQuery:@"SELECT _id, name, description FROM category"];
        //Fazemos um LOOP para carregar o array com os dados do SELECT
        while ([rs next]) {
            //Campo _id
            int _idI = [rs intForColumn:@"_id"];
            NSNumber *fieldID = [[NSNumber alloc] initWithInt:_idI];

            //Campo name
            NSString *fieldName = [rs stringForColumn:@"name"];

            //Campo description
            NSString *fieldDescription = [rs stringForColumn:@"description"];            

            //Dicionário para guardar as chaves e objetos
            NSMutableDictionary *rowDict = [[NSMutableDictionary alloc] initWithCapacity:3];

            //Guardamos as informações do ID e Name no Log para futura consulta em caso de erros
            //NSLog(@"%@ - %@ - %@", fieldID, fieldName, fieldDescription);            

            //Adiciona os valores e chaves de cada linha
            [rowDict setObject:fieldID          forKey: ID_KEY];
            [rowDict setObject:fieldName        forKey: NAME_KEY];
            [rowDict setObject:fieldDescription forKey: DESCRIPTION_KEY];

            NSLog(@"%@ - %@ - %@", [rowDict objectForKey:ID_KEY], [rowDict objectForKey:NAME_KEY], [rowDict objectForKey:DESCRIPTION_KEY]);             

            [array addObject:rowDict];

            [fieldID release];
            [fieldName release];
            [fieldDescription release]; 
            [rowDict release];
        }
        [rs close];
        [db close];
    }
    return array;
}

-(void)viewWillAppear:(BOOL)animated
{
   [super viewWillAppear:animated];
    //Cria e inicializa a classe categoria
    Category *categoria = [[Category alloc] init];
    //Verifica se o array está vazio e inicializado e cria
    if (arrCategory != nil)
        [arrCategory release];
    //Carrega os dados da categoria

    arrCategory = [[NSMutableArray alloc] initWithArray:[categoria GetCategories]];
    //Inicializa tudo

    [categoria release];
    [tbvCategory reloadData];
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

{

    //Cria a célula
    UITableViewCell *celula = [tableView dequeueReusableCellWithIdentifier:@"celula"];
    if (celula == nil) {
        celula = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"celula"] autorelease];
        //Define o estilo da célula
        [celula setSelectionStyle:UITableViewCellSelectionStyleGray];
    }

    NSDictionary *rowVals = (NSDictionary *) [arrCategory objectAtIndex:indexPath.row];
    //Pega o valor do campo Name
    NSString *fieldName = (NSString *) [rowVals objectForKey:@"name"];

    NSLog(@"%@ - %@", [rowVals objectForKey:@"name"], fieldName);

    //Here is ERROR
    celula.textLabel.text = [NSString stringWithFormat:@"%@", [rowVals objectForKey:@"name"]];

    return celula;
}

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{    

    Category *categoria = [[Category alloc] init];
    NSDictionary *dici = (NSDictionary *) [arrCategory objectAtIndex:indexPath.row];
    NSNumber *linha = (NSNumber *) [dici objectForKey:@"_id"];

    NSNumber *selRow = [[NSNumber alloc] initWithInteger: indexPath.row];

    [categoria DeleteCategory:selRow];

    [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];

    [arrCategory removeObjectAtIndex:indexPath.row];
    [tableView endUpdates];
    [tableView reloadData];    

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T08:12:45.763

尝试以下操作：

```
- (NSArray *)GetCategories
{
 NSString* dbPath = @"Path To Database";
 FMDatabase *db = [FMDatabase databaseWithPath:dbPath];

 NSMutableArray *array = [[[NSMutableArray alloc] init] autorelease];
 if (![db open]){
    NSLog(@"Could not open DB");
    return nil;
 }
 FMResultSet *rs = [db executeQuery:@"SELECT _id, name, description FROM category"];
 while ([rs next]) 
 {
     int _idI = [rs intForColumn:@"_id"];
     NSNumber *fieldID = [NSNumber numberWithInt:_idI];
     NSString *fieldName = [rs stringForColumn:@"name"];
     NSString *fieldDescription = [rs stringForColumn:@"description"];            

     NSMutableDictionary *rowDict = [[NSMutableDictionary alloc] initWithCapacity:3];

     //Adiciona os valores e chaves de cada linha
     [rowDict setObject:fieldID          forKey: ID_KEY];
     [rowDict setObject:fieldName        forKey: NAME_KEY];
     [rowDict setObject:fieldDescription forKey: DESCRIPTION_KEY];          

     [array addObject:rowDict];
     [rowDict release];
 }
 [rs close];
 [db close];

 return array;
} 
```

# java - java方法同步和读/写互斥

> ID：10372668
> 
> 赞同：24
> 
> 时间：2012-04-29T13:57:50.747
> 
> 标签：java, multithreading, concurrency

我有两种方法`read()`，`write()`如下所示。

```
class Store
{

  public void write()
  {
    // write to store;
  }

  public string  read()
  {
    // read from store;
  }
} 
```

1）`Store`对象是单例。

2）我有一个`Writer`将写入存储的`Reader`类和几个将同时从存储中读取的类。

我的要求是当作者写到商店时，所有的读者都应该等待。即，当控制在时`write()`，所有的调用都`read()`应该被阻止。我如何实现这一目标？我已经尝试`synchronize(Store.class)`过这种`write()`方法，但似乎对我不起作用。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-29T13:59:55.097

在这种情况下，最好的选择是使用读写锁：[ReadWriteLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html)。它允许单个写入器，但多个并发读取器，因此它是此类场景最有效的机制。

一些示例代码：

```
class Store
{
    private ReadWriteLock rwlock = new ReentrantReadWriteLock();

    public void write()
    {
       rwlock.writeLock().lock();
       try {
          write to store;
       } finally {
          rwlock.writeLock().unlock();
       }
    }

    public String read()
    {
       rwlock.readLock().lock();
       try {
          read from store;
       } finally {
          rwlock.readLock().unlock();
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-29T14:01:44.130

`synchronized`是最简单的解决方案，因此您应该解释“似乎不适合我”的意思，并可能向我们展示您是如何使用它的。

更好的解决方案是使用[ReentrantReadWriteLock](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)，因为它也允许对读取器进行并发访问。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-29T14:05:54.143

当一个方法在某个对象上同步时，执行此方法的线程会阻塞所有其他尝试进入另一个**在同一对象上同步的**块/方法的线程。

因此，如果您希望写入器线程禁止任何读取器线程读取，则必须同步写入和读取方法。没有理由在`Store`课堂上进行同步。在对象上同步`Store`更自然：

```
public synchronized void write() {
  write to store;
}

public synchronized String read() {
  read from store;
} 
```

然而，这（也许）有一个缺点：它还禁止两个读取器线程同时读取。如果你真的需要这样做，你应该使用[ReadWriteLock](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReadWriteLock.html)。但这会导致代码性能降低，并且更难理解和维护。如果我测量到这是需要的，我只会使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:00:31.977

使用 java.util.concurrent 包中的 ReadWriteLock

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-30T19:04:28.773

请注意阅读这篇文章：

[https://blog.takipi.com/java-8-stampedlocks-vs-readwritelocks-and-synchronized/](https://blog.takipi.com/java-8-stampedlocks-vs-readwritelocks-and-synchronized/)

*   RWLocks 可能会很慢，尤其是当作者有很多读者时
*   同步平均是最可靠的快速
*   有像 StampedLock 这样的新锁

# c - 在 C 中实现“更多过滤器”

> ID：10372673
> 
> 赞同：0
> 
> 时间：2012-04-29T13:58:21.870
> 
> 标签：c, shell, unix

我想知道如何实现更多过滤器 - 就像显示文本一样，直到它填满屏幕并用“Enter”移动每一行（就像在 UNIX 中一样）。我知道 ncurses 会很有用，但找不到合适的方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:49:50.643

做一个两个缓冲区的实现

这可以是一个大纲：

```
Read from file into the 1st buffer. 
```

`offset = 0`

```
while `offset != total_lines_in_file`
  [1] show `max_lines_in_a_page` number of lines starting from line number `offset`
  [2] when showing the lines if a buffer end is detected, load the other buffer and switch buffer, and print remaining lines.
  [3] if the specific scroll keypress is detected make `offset = offset + x` (x = 1, 2 etc.) 
```

最好看一下实现的源代码`more`。

# python - 在 Windows 的 virtualenv 中使用 pip 安装 hyde 时遇到问题

> ID：10372675
> 
> 赞同：3
> 
> 时间：2012-04-29T13:58:36.173
> 
> 标签：python, windows, virtualenv, pip, hyde

所以这就是我`pip install hyde`在 Windows 中尝试使用 virtualenv 时得到的结果。这是怎么发生的，我该如何解决？

```
C:\Users\s3z\Desktop\My Dropbox\Art_website>Scripts\activate
(Art_website) C:\Users\s3z\Desktop\My Dropbox\3ambi_website>pip install hyde
Downloading/unpacking hyde
  Downloading hyde-0.8.4.tar.gz (1.3Mb): 1.3Mb downloaded
  Running setup.py egg_info for package hyde

Downloading/unpacking argparse (from hyde)
  Downloading argparse-1.2.1.tar.gz (69Kb): 69Kb downloaded
  Running setup.py egg_info for package argparse

    warning: no previously-included files matching '*.pyc' found anywhere in distribution
    warning: no previously-included files matching '*.pyo' found anywhere in distribution
    warning: no previously-included files matching '*.orig' found anywhere in distribution
    warning: no previously-included files matching '*.rej' found anywhere in distribution
    no previously-included directories found matching 'doc\_build'
    no previously-included directories found matching 'env24'
    no previously-included directories found matching 'env25'
    no previously-included directories found matching 'env26'
    no previously-included directories found matching 'env27'
Downloading/unpacking commando (from hyde)
  Downloading commando-0.1.2a.tar.gz
  Running setup.py egg_info for package commando

Downloading/unpacking jinja2 (from hyde)
  Downloading Jinja2-2.6.tar.gz (389Kb): 389Kb downloaded
  Running setup.py egg_info for package jinja2

    warning: no previously-included files matching '*' found under directory 'docs\_build'
    warning: no previously-included files matching '*.pyc' found under directory 'jinja2'
    warning: no previously-included files matching '*.pyc' found under directory 'docs'
    warning: no previously-included files matching '*.pyo' found under directory 'jinja2'
    warning: no previously-included files matching '*.pyo' found under directory 'docs'
Downloading/unpacking pyYAML (from hyde)
  Downloading PyYAML-3.10.tar.gz (241Kb): 241Kb downloaded
  Running setup.py egg_info for package pyYAML

Downloading/unpacking markdown (from hyde)
  Downloading Markdown-2.1.1.zip (341Kb): 341Kb downloaded
  Running setup.py egg_info for package markdown

Downloading/unpacking smartypants (from hyde)
  Downloading smartypants-1.6.0.3.tar.gz
  Running setup.py egg_info for package smartypants

Downloading/unpacking pygments (from hyde)
  Downloading Pygments-1.5.tar.gz (3.7Mb): 3.7Mb downloaded
  Running setup.py egg_info for package pygments

Downloading/unpacking typogrify-hyde (from hyde)
  Downloading hyde-setup
  Running setup.py egg_info for package typogrify-hyde

    warning: no files found matching '*' under directory 'docs'
Installing collected packages: hyde, argparse, commando, jinja2, pyYAML, markdown, smartypants, pygments, typogr
  Running setup.py install for hyde

    Installing hyde-script.py script to C:\Users\s3z\Desktop\My Dropbox\Art_website\Scripts
    Installing hyde.exe script to C:\Users\s3z\Desktop\My Dropbox\Art_website\Scripts
  Running setup.py install for argparse

    warning: no previously-included files matching '*.pyc' found anywhere in distribution
    warning: no previously-included files matching '*.pyo' found anywhere in distribution
    warning: no previously-included files matching '*.orig' found anywhere in distribution
    warning: no previously-included files matching '*.rej' found anywhere in distribution
    no previously-included directories found matching 'doc\_build'
    no previously-included directories found matching 'env24'
    no previously-included directories found matching 'env25'
    no previously-included directories found matching 'env26'
    no previously-included directories found matching 'env27'
  Running setup.py install for commando

  Running setup.py install for jinja2

    warning: no previously-included files matching '*' found under directory 'docs\_build'
    warning: no previously-included files matching '*.pyc' found under directory 'jinja2'
    warning: no previously-included files matching '*.pyc' found under directory 'docs'
    warning: no previously-included files matching '*.pyo' found under directory 'jinja2'
    warning: no previously-included files matching '*.pyo' found under directory 'docs'
  Running setup.py install for pyYAML
    checking if libyaml is compilable
    Traceback (most recent call last):
      File "<string>", line 1, in <module>
      File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 344, in <module>
        'test': test,
      File "C:\Python27\Lib\distutils\core.py", line 152, in setup
        dist.run_commands()
      File "C:\Python27\Lib\distutils\dist.py", line 953, in run_commands
        self.run_command(cmd)
      File "C:\Python27\Lib\distutils\dist.py", line 972, in run_command
        cmd_obj.run()
      File "C:\Users\s3z\Desktop\My Dropbox\Art_website\lib\site-packages\distribute-0.6.24-py2.7.egg\setu
n run
        return _install.run(self)
      File "C:\Python27\Lib\distutils\command\install.py", line 563, in run
        self.run_command('build')
      File "C:\Python27\Lib\distutils\cmd.py", line 326, in run_command
        self.distribution.run_command(command)
      File "C:\Python27\Lib\distutils\dist.py", line 972, in run_command
        cmd_obj.run()
      File "C:\Python27\Lib\distutils\command\build.py", line 127, in run
        self.run_command(cmd_name)
      File "C:\Python27\Lib\distutils\cmd.py", line 326, in run_command
        self.distribution.run_command(command)
      File "C:\Python27\Lib\distutils\dist.py", line 972, in run_command
        cmd_obj.run()
      File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 171, in run
        _build_ext.run(self)
      File "C:\Python27\Lib\distutils\command\build_ext.py", line 340, in run
        self.build_extensions()
      File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 213, in build_extensi
        with_ext = self.check_extension_availability(ext)
      File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 239, in check_extensi
        depends=ext.depends)
      File "C:\Python27\Lib\distutils\msvc9compiler.py", line 469, in compile
        self.initialize()
      File "C:\Python27\Lib\distutils\msvc9compiler.py", line 379, in initialize
        vc_env = query_vcvarsall(VERSION, plat_spec)
      File "C:\Python27\Lib\distutils\msvc9compiler.py", line 295, in query_vcvarsall
        raise ValueError(str(list(result.keys())))
    ValueError: [u'path']
    Complete output from command "C:\Users\s3z\Desktop\My Dropbox\Art_website\Scripts\python.exe" -c "impo
ious\\Desktop\\My Dropbox\\Art_website\\build\\pyYAML\\setup.py';exec(compile(open(__file__).read().replace('\
ll --single-version-externally-managed --record c:\users\s3z\appdata\local\temp\pip-yffhnx-record\install-re
aeious\Desktop\My Dropbox\Art_website\include\site\python2.7":
    running install

running build

running build_py

creating build

creating build\lib.win-amd64-2.7

creating build\lib.win-amd64-2.7\yaml

copying lib\yaml\composer.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\constructor.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\cyaml.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\dumper.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\emitter.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\error.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\events.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\loader.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\nodes.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\parser.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\reader.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\representer.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\resolver.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\scanner.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\serializer.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\tokens.py -> build\lib.win-amd64-2.7\yaml

copying lib\yaml\__init__.py -> build\lib.win-amd64-2.7\yaml

running build_ext

creating build\temp.win-amd64-2.7

creating build\temp.win-amd64-2.7\Release

checking if libyaml is compilable

Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 344, in <module>

    'test': test,

  File "C:\Python27\Lib\distutils\core.py", line 152, in setup

    dist.run_commands()

  File "C:\Python27\Lib\distutils\dist.py", line 953, in run_commands

    self.run_command(cmd)

  File "C:\Python27\Lib\distutils\dist.py", line 972, in run_command

    cmd_obj.run()

  File "C:\Users\s3z\Desktop\My Dropbox\Art_website\lib\site-packages\distribute-0.6.24-py2.7.egg\setuptoo
n

    return _install.run(self)

  File "C:\Python27\Lib\distutils\command\install.py", line 563, in run

    self.run_command('build')

  File "C:\Python27\Lib\distutils\cmd.py", line 326, in run_command

    self.distribution.run_command(command)

  File "C:\Python27\Lib\distutils\dist.py", line 972, in run_command

    cmd_obj.run()

  File "C:\Python27\Lib\distutils\command\build.py", line 127, in run

    self.run_command(cmd_name)

  File "C:\Python27\Lib\distutils\cmd.py", line 326, in run_command

    self.distribution.run_command(command)

  File "C:\Python27\Lib\distutils\dist.py", line 972, in run_command

    cmd_obj.run()

  File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 171, in run

    _build_ext.run(self)

  File "C:\Python27\Lib\distutils\command\build_ext.py", line 340, in run

    self.build_extensions()

  File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 213, in build_extensions

    with_ext = self.check_extension_availability(ext)

  File "C:\Users\s3z\Desktop\My Dropbox\Art_website\build\pyYAML\setup.py", line 239, in check_extension_a

    depends=ext.depends)

  File "C:\Python27\Lib\distutils\msvc9compiler.py", line 469, in compile

    self.initialize()

  File "C:\Python27\Lib\distutils\msvc9compiler.py", line 379, in initialize

    vc_env = query_vcvarsall(VERSION, plat_spec)

  File "C:\Python27\Lib\distutils\msvc9compiler.py", line 295, in query_vcvarsall

    raise ValueError(str(list(result.keys())))

ValueError: [u'path']

----------------------------------------
Command "C:\Users\s3z\Desktop\My Dropbox\Art_website\Scripts\python.exe" -c "import setuptools;__file__='C
\\Art_website\\build\\pyYAML\\setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'e
nally-managed --record c:\users\s3z\appdata\local\temp\pip-yffhnx-record\install-record.txt --install-header
\Art_website\include\site\python2.7" failed with error code 1 in C:\Users\s3z\Desktop\My Dropbox\3ambi_web
Storing complete log in C:\Users\s3z\AppData\Roaming\pip\pip.log

(Art_website) C:\Users\s3z\Desktop\My Dropbox\3ambi_website> 
```

# wpf - 执行命令后执行自定义代码

> ID：10372677
> 
> 赞同：0
> 
> 时间：2012-04-29T13:58:53.927
> 
> 标签：wpf, silverlight

我有一个 TreeView 控件，添加新节点后，我需要执行一些自定义代码（例如展开节点，使其可见，并启动开始编辑方法）。因为我希望它在 TreeView 控件的每个实例中都可用，所以我想子类化 TreeView 控件。

现在，为了让 treeview 知道何时添加新节点，它要么有一个在添加项目时触发的事件（它没有），要么有一个对执行添加新节点的命令的引用物品。

所以两个问题：

1) 有没有办法在 TreeView 中添加一个事件，每当添加树节点时都会触发该事件（我总是通过 ViewModel 的源集合添加节点） - 我找不到任何方法来做到这一点

2) 我可以向 TreeList 添加一个 AddCommand 属性，该属性将绑定到 ViewModel 的 AddCommand，然后有一些按钮或 ContextMenu 项将绑定到 TreeList.AddCommand，而不是视图模型。这种方式 TreeView 将持有对 AddCommand 的引用，但缺点是实际使用会有点奇怪。问题：我如何知道 TreeView 的 AddCommand（或任何命令，就此而言）何时执行，所以我可以在它之后触发一些自定义代码？似乎 CommandManager.AddExecutedHandler 是一个解决方案，但我无法执行它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:37:09.827

Is this any help?

```
public class CustomTreeControl : TreeView
{
    ...

    // WPF only
    protected override void OnItemsSourceChanged(IEnumerable oldValue, IEnumerable newValue)
    {
        base.OnItemsSourceChanged(oldValue, newValue);

        Debug.WriteLine("OnItemsSourceChanged");
    }

    // WPF + Silverlight
    protected override void OnItemsChanged(NotifyCollectionChangedEventArgs e)
    {
        base.OnItemsChanged(e);

        Debug.WriteLine("OnItemsChanged: {0}", e.Action);
    }
} 
```

# python - 使用 CSS 在 Django 中编辑 EmailField 和 FileField

> ID：10372678
> 
> 赞同：2
> 
> 时间：2012-04-29T13:58:57.140
> 
> 标签：python, django, django-templates

如何使用 CSS 在 Django 中修改 EmailField、FileField 和 TextInputs 的高度和宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:21:34.327

您没有给我们太多信息，您将如何使用这些字段。但我建议你不要对 Django 表单做任何事情。如果可能的话，用`html`标签包装它们并为它们设置类。

```
<div class="email">{{ my_form.email }}</div>

<style>.email input {width: 100px;}</style> 
```

如果你不能，你必须

1.[覆盖小部件](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#django.forms.Widget.attrs)

2.在表单的构造函数中设置属性

```
def __init__(self, *args, **kwargs):
    super(MyForm, self).__init__(*args, **kwargs)
    self.fields['email'].widget.attrs['style'] = 'width: 100px;' 
```

# javascript - JavaScript - 在对象中创建数组

> ID：10372680
> 
> 赞同：2
> 
> 时间：2012-04-29T13:59:19.823
> 
> 标签：javascript, arrays, object

我正在寻找存储以下数据结构：

```
TIMESTAMP | NAME | COUNTS 
```

对于每个时间戳，可以有多个名称，每个名称都有一个计数列表：

```
123456 | EXAMPLE1 | 1,2,3,4
       | EXAMPLE2 | 4,3,2,1
       | EXAMPLE3 | 9,7,4,3 
```

我想将时间戳存储为对象索引，以便在知道时间戳时可以访问它。这也消除了数组大小限制和定义等方面的任何问题。

我不知道如何为每个时间戳创建一个“名称”列表，并且对于每个名称我想存储一个计数列表。

**谁能建议我如何创建此数据结构并访问特定时间戳和名称的所有计数？**

到目前为止，我有这个：

```
dataObj[timestamp] = new Array(name,[count]); 
```

但我有两个问题：

**1）我将如何测试以查看我是否已经拥有该名称？**

**2）我将如何添加另一个名称数组？**

感谢任何评论。

问候，本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:12:07.607

给定时间戳、名称和计数：

```
// if we haven't seen this timestamp, create a new object for it
dataObj[timestamp] = dataObj[timestamp] || {}; 

// if we haven't seen this name yet in this time stamp, create a new array for it
dataObj[timestamp][name] = dataObj[timestamp][name] || []; 

// add this count to the array
dataObj[timestamp][name].push(count); 
```

如果您一次获得给定时间戳/名称对的所有计数，则可以将最后两个语句合并为一个：

```
dataObj[timestamp][name] = countsArray; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:21:10.010

您可以在对象中嵌套对象。所以你`dataObj`可能看起来像

```
var dataObj = {}, 
    currentTime = new Date().getTime();

dataObj[currentTime].example1 = [1,2,3,4];               //<== question 2

// later ...
if (dataObj[currentTime] && !dataObj[newTime].example2){ //<== question 1
  dataObj[currentTime].example2 = [4,3,2,1];             //<== question 2 
}

/* 
  lets say currentTime was 1335709735241\. After the previous 
  code dataObj contains:
   dataObj['1335709735241'].example1 => [1,2,3,4]
   dataObj['1335709735241'].example2 -> [4,3,2,1]
*/ 
```

检查某个对象中是否存在属性的另一种方法：

```
if ('someproperty' in someObj) { /* etc. */} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:33:30.853

有一些我不知道的细节，例如，您是否正在检查名称是否存在，以便当名称存在时，

1.  您向现有数组添加新计数？
2.  用新数组替换当前数组？
3.  忽略新信息？

下面的代码执行 2\. 替换。试试看[http://jsfiddle.net/DrPw6/1/](http://jsfiddle.net/DrPw6/1/)

```
 var data = {};
  setNameArray('12345', 'example1', [1,2,3]);
  setNameArray(33, 'example2', [4,5,6]);

  function setNameArray(timestamp, name, array) {
    if (!(timestamp in data)) {
      data[timestamp] = {};
    }
    data[timestamp][name] = array;
  }

  function nameExists(timestamp, name) {
    return (name in data[timestamp]);
  }
  // to read
  document.write(data['12345'].example1 + "<br>");
  document.write(data['12345']['example1'] + "<br>");
  document.write(JSON.stringify(data)); 
```

请注意，这`data.12345.example1`不起作用，因为键是数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:49:53.043

```
var timeStamp = new Object();

  function propCreator(obj, k, arr) {
    if (!obj.hasOwnProperty(k)) {
          obj[k] = arr;
      }
          else {
             alert("sry. object have property " + k);
          }
    }

// create new name and array         
var arr = [3,4,5,6];
var name = "theName";
// then you can add new new property and its value to the object:
propCreator(timeStamp, name, arr);
alert(JSON.stringify(timeStamp)) 
```

# image - 如何在 matlab 或其他方式中执行颜色量化

> ID：10372681
> 
> 赞同：2
> 
> 时间：2012-04-29T13:59:28.920
> 
> 标签：image, matlab, image-processing

我正在 matlab 中实现机器学习算法，并且正在阅读人眼的颜色范围，并被告知人眼只能感知大约 17,000 种颜色，而图像我有大约 256^3 种颜色. 在 matlab 或其他方式中量化我的图像的最佳方法是什么。另外，作为机器学习方面的一个附带问题，使用位图或 jpeg 哪个更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:18:31.777

JPEG 是一种有损格式。如果您的输入数据还不是 JPEG，则不应使用它。即使是这样，您也不应该重新压缩数据以避免引入进一步的工件。

一种非常简单但流行的颜色量化方法是 k-means 算法。你可以在 Matlab 中找到它。这是一个很好的起点。然而，在最近的研究中存在广泛的范式和方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T21:21:18.193

如果您的颜色量化旨在以某种方式模仿人类感知，我建议从 sRGB 空间转移到更受生物启发的东西，例如 LAB，其中 L 代表整体亮度，A 代表红绿色对，B 代表黄蓝色。使用 LAB 将允许您首次尝试“照明不变”颜色量化。网上有很多 RGB2Lab 转换代码。然后我会完全丢弃 L 通道，除非你也想对黑白进行编码。

最后，声称 17000 种颜色是没有意义的。男人感知7种颜色：红紫粉橙黄绿蓝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-07T22:00:31.290

[使用 K 均值聚类](http://imageprocessingblog.com/color-reduction-using-k-means-clustering/)(Matlab) 减少颜色。

# iphone - 拖动 UIView

> ID：10372684
> 
> 赞同：0
> 
> 时间：2012-04-29T14:00:04.457
> 
> 标签：iphone, ios5, uiview, draggable

在某个框架内拖动一个 UIView，让我们说 (0, 0, 320, 190)。如何使用偏移量拖动 UIView。即当我触摸 UIView 时，UIView 应该不在手指下移动。

使用偏移量，UIView 应该在上面的框架内移动。我怎样才能做到这一点 ？

请让我知道想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T19:16:39.767

首先使用平移手势识别器来获取手指的位置，并计算手指位置 [gesture locationInView:parentView] 与子视图的框架位置之间的 x 和 y 轴变化。将您的偏移量添加到该值。

使用您刚刚计算的 x、y 更改，使用 UIView animateWithDuration 并在其中使用 CATransform3DTranslate 进行翻译。然后子视图将（带有动画）移动到您的手指+偏移量所在的位置。

要将其保留在父视图中，只需确保翻译不会导致子视图的框架超出父视图的范围，并剪辑父视图，这样子视图的任何部分都不会超出父视图被显示。

# .net - 键盘挂钩在应用程序执行其他任务时冻结键盘

> ID：10372692
> 
> 赞同：0
> 
> 时间：2012-04-29T13:58:15.673
> 
> 标签：.net, keyboard

我正在使用[此处](http://sim0n.wordpress.com/2009/03/28/vbnet-keyboard-hook-class/)找到的以下类在我的应用程序中全局挂钩键盘组合。

```
Imports System.Runtime.InteropServices

Public Class KeyboardHook

<DllImport("User32.dll", CharSet:=CharSet.Auto, CallingConvention:=CallingConvention.StdCall)> _
Private Overloads Shared Function SetWindowsHookEx(ByVal idHook As Integer, ByVal HookProc As KBDLLHookProc, ByVal hInstance As IntPtr, ByVal wParam As Integer) As Integer
End Function
<DllImport("User32.dll", CharSet:=CharSet.Auto, CallingConvention:=CallingConvention.StdCall)> _
Private Overloads Shared Function CallNextHookEx(ByVal idHook As Integer, ByVal nCode As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer
End Function
<DllImport("User32.dll", CharSet:=CharSet.Auto, CallingConvention:=CallingConvention.StdCall)> _
Private Overloads Shared Function UnhookWindowsHookEx(ByVal idHook As Integer) As Boolean
End Function

<StructLayout(LayoutKind.Sequential)> _
Private Structure KBDLLHOOKSTRUCT
    Public vkCode As UInt32
    Public scanCode As UInt32
    Public flags As KBDLLHOOKSTRUCTFlags
    Public time As UInt32
    Public dwExtraInfo As UIntPtr
End Structure

<Flags()> _
Private Enum KBDLLHOOKSTRUCTFlags As UInt32
    LLKHF_EXTENDED = &H1
    LLKHF_INJECTED = &H10
    LLKHF_ALTDOWN = &H20
    LLKHF_UP = &H80
End Enum

Public Shared Event KeyDown(ByVal Key As Keys)
Public Shared Event KeyUp(ByVal Key As Keys)

Private Const WH_KEYBOARD_LL As Integer = 13
Private Const HC_ACTION As Integer = 0
Private Const WM_KEYDOWN = &H100
Private Const WM_KEYUP = &H101
Private Const WM_SYSKEYDOWN = &H104
Private Const WM_SYSKEYUP = &H105

Private Delegate Function KBDLLHookProc(ByVal nCode As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer

Private KBDLLHookProcDelegate As KBDLLHookProc = New KBDLLHookProc(AddressOf KeyboardProc)
Private HHookID As IntPtr = IntPtr.Zero

Private Function KeyboardProc(ByVal nCode As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer
    If (nCode = HC_ACTION) Then
        Dim struct As KBDLLHOOKSTRUCT
        Select Case wParam
            Case WM_KEYDOWN, WM_SYSKEYDOWN
                RaiseEvent KeyDown(CType(CType(Marshal.PtrToStructure(lParam, struct.GetType()), KBDLLHOOKSTRUCT).vkCode, Keys))
            Case WM_KEYUP, WM_SYSKEYUP
                RaiseEvent KeyUp(CType(CType(Marshal.PtrToStructure(lParam, struct.GetType()), KBDLLHOOKSTRUCT).vkCode, Keys))
        End Select
    End If
    Return CallNextHookEx(IntPtr.Zero, nCode, wParam, lParam)
End Function

Public Sub New()
    HHookID = SetWindowsHookEx(WH_KEYBOARD_LL, KBDLLHookProcDelegate, System.Runtime.InteropServices.Marshal.GetHINSTANCE(System.Reflection.Assembly.GetExecutingAssembly.GetModules()(0)).ToInt32, 0)
    If HHookID = IntPtr.Zero Then
        Throw New Exception("Could not set keyboard hook")
    End If
End Sub

Protected Overrides Sub Finalize()
    If Not HHookID = IntPtr.Zero Then
        UnhookWindowsHookEx(HHookID)
    End If
    MyBase.Finalize()
End Sub

End Class 
```

即使应用程序有焦点，它也能很好地工作，但我有问题。我的应用程序正在使用

```
 My.Computer.Network.UploadFile 
```

在上传过程中，kayboard 笔画停止响应。鼠标没问题。

如何在我的应用程序中进行其他操作时保持键盘处于活动状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:19:26.777

是的，这是自找麻烦。Windows 只能在您的程序泵送消息循环时调用您的挂钩回调方法。Windows 没有其他可用的机制来调用主线程而不会导致严重的重入问题。

当您的主线程停止执行其他操作（例如上传文件）时，这将停止正常工作。这是 GUI 应用程序的一般要求，其他任务占用主 UI 线程会使用户界面紧张。它停止响应输入并停止绘画。几秒钟后，Windows 窗口管理器介入并用“幽灵窗口”替换您的主窗口，标题栏中显示“无响应”。你的鼻子更难揉搓，因为这现在也停止处理任何键盘输入，Window 不能调用钩子回调。

您需要在另一个线程上执行长时间运行的任务，以便 UI 线程可以保持响应。或者在您正在谈论的特定情况下，请改用 UploadFileAsync() 。

# iphone - 撤消 IBAction？

> ID：10372693
> 
> 赞同：0
> 
> 时间：2012-04-29T14:00:58.590
> 
> 标签：iphone, ios, xcode, ibaction, nsundomanager

我正在尝试按下 UIBarButtonItem 并执行一个操作，它确实如此。当它发生时，我正在更改 BarButtonItem 的标题名称。这样，如果我再次点击它，我想撤消它执行的操作，而不是编写所有内容以将其更改回来。这是我的代码示例。

```
- (IBAction)MyAction:(id)sender{

if([[MyButton title] isEqualToString:@"Test1"]){

//My Action is performed.

    [MyButton  setTitle:@"Test2"];
    [[undoManager prepareWithInvocationTarget:self] MyAction:?];
    [undoManager setActionName:@"UndoLastAction"];

}else if ([[MyButton title] isEqualToString:@"Test2"]){

    [MyButton setTitle:@"Test1"];
    [[undoManager prepareWithInvocationTarget:self]MyAction:?];
    [undoManager setActionName:@"UndoLastAction"];
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T18:24:15.813

没关系，重新运行原始代码以“撤消”操作会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T04:55:10.247

如果你想试试。

在 viewDidLoad.,, 中以编程方式添加 UIButton。

```
 - (void)viewDidLoad
{
MyButton =[UIButton buttonWithType:UIButtonTypeRoundedRect];
[MyButton setFrame:CGRectMake(300, 450, 72, 37)];
[MyButton setTitle:@"Test1" forState:UIControlStateNormal]; 
[MyButton addTarget:self action:@selector(MyAction:) forControlEvents:UIControlEventTouchUpInside];
[self.view MyButton];

} 
```

并给出这样的动作，.,.,

```
 -(IBAction)MyAction:(id)sender
 { 
   UIButton *temp=(UIButton *)sender;

    if(temp.titleLabel.text==@"Test1")
    {
       [temp setTitle:@"Test2" forState:UIControlStateNormal]; 

    }
    else if (temp.titleLabel.text==@"Test2")
    {
      [temp setTitle:@"Test1" forState:UIControlStateNormal]; 
    }

} 
```

我在学习，。，..，

# c++ - 内存/线程泄漏，使用 WinSock2 开发简单的 HTTP 服务器

> ID：10372695
> 
> 赞同：0
> 
> 时间：2012-04-29T14:01:30.493
> 
> 标签：c++, multithreading, sockets, memory-leaks, winsock

我开始开发我的工具，它在 TCP 级别与 net 一起工作，它将展示 web-server 的简单功能。

在测试我的程序时，我遇到了非常严重的错误：

*   内存泄漏
*   立即创建数千个线程

在 taskmgr.exe 中，您可能会看到大约 1.5 个线程和大约 50kb 的分配内存。此外，我将程序编译为 32 位，但在 vmmap 实用程序中您可能会看到很多 64 位堆栈。我的操作系统是 64 位的，但是在 taskmgr.exe 中你可能会看到 *32 ，我不知道 32 位程序如何使用 64 位堆栈，也许在 64 位操作系统中启动 32 位程序是正常的，但我不知道这个操作系统的设计，所以我会很高兴，如果你给我一个关于这个问题的建议。

那么，为什么我的程序会立即创建很多线程呢？*（我猜，while(true) block 的原因）*。

但是，我想要下一个：

*   为每个新请求创建每个线程
*   处理完请求后，终止线程并释放内存

**我应该如何重新制作我的代码？**

谢谢！

这是我的代码（MS VC ++ 9）：

```
#include <iostream>
#include <Windows.h>

#pragma comment(lib, "Ws2_32.lib")

typedef struct Header
{
friend struct Net;

private:
    WORD wsa_version;
    WSAData wsa_data;

    SOCKET sock;
    SOCKADDR_IN service;

    char *ip;
    unsigned short port;

public:
    Header(void)
    {
        wsa_version = 0x202;

        ip = "0x7f.0.0.1";
        port = 0x51;

        service.sin_family = AF_INET;
        service.sin_addr.s_addr = inet_addr(ip);
        service.sin_port = htons(port);
    }

} Header;

typedef struct Net
{
private:
    int result;

    HANDLE thrd;
    DWORD exit_code;

    void WSAInit(WSAData *data, WORD *wsa_version)
    {
        result = WSAStartup(*wsa_version, &(*data));

        if(result != NO_ERROR)
        {
            std::cout << "WSAStartup() failed with the error: " << result << std::endl;
        }
        else
        {
            std::cout << (*data).szDescription << " " << (*data).szSystemStatus << std::endl;
        }
    }

    void SocketInit(SOCKET *my_socket)
    {
        (*my_socket) = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

        if((*my_socket) == INVALID_SOCKET)
        {
            std::cout << "Socket initialization failed with the error: " << WSAGetLastError() << std::endl;
            WSACleanup();
        }
        else
        {
            std::cout << "Socket initialization successful!" << std::endl;
        }
    }

    void SocketBind(SOCKET *my_socket, SOCKADDR_IN *service)
    {
        result = bind((*my_socket), (SOCKADDR*)&(*service), sizeof(*service));

        if(result == SOCKET_ERROR)
        {
            std::cout << "Socket binding failed with the error: " << WSAGetLastError() << std::endl;
            closesocket((*my_socket));
            WSACleanup();
        }
        else
        {
            std::cout << "Socket binding successful!" << std::endl;
        }

        result = listen(*my_socket, SOMAXCONN);

        if(result == SOCKET_ERROR)
        {
            std::cout << "Socket listening failed with the error: " << WSAGetLastError() << std::endl;
        }
        else
        {
            std::cout << "Listening to the socket..." << std::endl;
        }
    }

    static void SocketAccept(SOCKET *my_socket)
    {
        SOCKET sock_accept = accept((*my_socket), 0, 0);

        if(sock_accept == INVALID_SOCKET)
        {
            std::cout << "Accept failed with the error: " << WSAGetLastError() << std::endl;
            closesocket(*my_socket);
            WSACleanup();
        }
        else
        {
            std::cout << "Client socket connected!" << std::endl;
        }

        char data[0x400];
        int result = recv(sock_accept, data, sizeof(data), 0);
        HandleRequest(data, result);
        char *response = "HTTP/1.1 200 OK\r\nServer: Amegas.sys-IS/1.0\r\nContent-type: text/html\r\nSet-Cookie: ASD643DUQE7423HFDG; path=/\r\nCache-control: private\r\n\r\n<h1>Hello World!</h1>\r\n\r\n";
        result = send(sock_accept, response, (int)strlen(response), 0);

        if(result == SOCKET_ERROR)
        {
            std::cout << "Sending data via socket failed with the error: " << WSAGetLastError() << std::endl;
            closesocket(sock_accept);
            WSACleanup();
        }
        else
        {
            result = shutdown(sock_accept, 2);
        }
    }

    static void HandleRequest(char response[], int length)
    {
        std::cout << std::endl;

        for(int i = 0; i < length; i++)
        {
            std::cout << response[i];
        }

        std::cout << std::endl;
    }

    static DWORD WINAPI Threading(LPVOID lpParam)
    {
        SOCKET *my_socket = (SOCKET*)lpParam;
        SocketAccept(my_socket);

        return 0;
    }

public:
    Net(void)
    {
        Header *obj_h = new Header();

        WSAInit(&obj_h->wsa_data, &obj_h->wsa_version);

        SocketInit(&obj_h->sock);
        SocketBind(&obj_h->sock, &obj_h->service);

        while(true)
        {
            thrd = CreateThread(NULL, 0, &Net::Threading, &obj_h->sock, 0, NULL);

            //if(GetExitCodeThread(thrd, &exit_code) != 0)
            //{
            //  ExitThread(exit_code);
            //}
        }

        delete &obj_h;
    }
} Net;

int main(void)
{
    Net *obj_net = new Net();

    delete &obj_net;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:05:21.507

您应该在接受连接*之后*创建线程，而不是之前。

您正在做的是创建大量线程，然后让它们中的每一个等待连接。他们中的许多人无事可做。我什至不知道 Windows 的 accept 调用是否是线程安全的——你最终可能会遇到多个线程处理同一个连接。

相反，您需要做的是，在您的主循环（Net 的构造函数 while(true)）中，您需要调用 accept()。由于 accept()*阻塞*直到它有一个连接，这将导致主线程等待，直到有人尝试连接。然后，当他们这样做时，您创建另一个线程（或进程 - 更有可能在 UNIX 上）来处理该连接。所以，你的循环现在看起来像这样：

```
SOCKET sock_accept = accept((*my_socket), 0, 0);

if(sock_accept == INVALID_SOCKET)
{
    std::cout << "Accept failed with the error: " << WSAGetLastError() << std::endl;
    closesocket(*my_socket);
    WSACleanup();
}
else
{
    std::cout << "Client socket connected!" << std::endl;
}
thrd = CreateThread(NULL, 0, &Net::Threading, &obj_h->sock, 0, NULL);
//push back thrd into a std::vector<HANDLE> or something like that
//if you want to keep track of it for later: there's more than one thread 
```

然后，删除您从 SocketAccept 移入此循环的代码。然后，出于美观的目的，我将 SocketAccept 的名称更改为 SocketHandleConnection。

现在，当您的线程启动时，它已经建立了连接，您需要做的就是处理数据（例如，您从 char data[0x400] 开始执行的操作）。

如果您想处理连接清理，有几种方法可以做到这一点。一，既然你是线程的，你可以让线程自己清理。它与主进程共享内存，因此您可以这样做。但是在这个例子中，我没有看到任何你需要清理的东西。

最后，我认为您不了解 ExitThread 的作用。根据 MSDN：

> ExitThread 是在 C 代码中退出线程的首选方法。但是，在 C++ 代码中，线程在调用任何析构函数或执行任何其他自动清理之前退出。因此，在 C++ 代码中，您应该从您的线程函数返回。

因此，您似乎不需要调用 ExitThread - 您只需从函数返回，线程就会自动退出。您不需要从主线程调用它。

最后，你真的应该（如果可以的话）在 c++11 中使用新的标准 C++ 线程，然后如果你付出一点努力将代码移植到 boost::asio，你将拥有一个完全跨平台应用程序，无需 Windows API C 丑陋：D

免责声明：由于我的大部分经验都与 UNIX 相关，因此我对 Windows 的了解仅略知一二。我试图尽可能准确，但如果我对这些知识如何转换到 Windows 有任何误解，那么，我警告你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:25:38.010

为什么要在无限循环中创建线程？当然，这将创建大量线程。我指的是这段代码：

```
while(true)
    {
        thrd = CreateThread(NULL, 0, &Net::Threading, &obj_h->sock, 0, NULL);
} 
```

# coldfusion - 在 ColdFusion 和 Railo 中移动目录

> ID：10372696
> 
> 赞同：1
> 
> 时间：2012-04-29T14:01:40.713
> 
> 标签：coldfusion, railo, cfdirectory

在 Adob​​e ColdFusion (ACF) 中，我一直使用 cffile action="rename" 来移动文件和目录。并非没有道理，Railo 认为 cffile 不适用于目录，因此您需要使用 cfdirectory 重命名，并且效果很好。但是，这在 ACF 中似乎不起作用。

例如：

```
<cfdirectory action="RENAME" directory="C:/tmp/aaa1/aaa2/" newDirectory="C:/tmp/aaa2"> 
```

...在 Railo 中工作，但在 ACF 中会抛出这个：

```
The specified directory attribute C:/tmp/aaa1/aaa2/ cannot be renamed to newdirectory C:\tmp\aaa1\C:\tmp\aaa2. 
```

因此，您似乎必须使用 cffile 来移动 ACF 上的目录，以及 Railo 上的 cfdirectory。这真的是最先进的吗？有没有办法让 cfdirectory 移动 ACF 上的目录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T16:32:25.217

没关系，但是如果您使用反斜杠，它就可以工作。

对于我知道的所有其他文件操作，我将其归类为 CF 中的错误（我正在使用 CF9.0.1 进行测试），无论是斜线在 CF 上都可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-30T15:01:13.250

我们在 CF10 中开发了一个应用程序，它使用正斜杠作为 cfdirectory action="rename" 中的文件路径。

```
<cfdirectory action="rename" directory="//fileserver/folder10/test/TEST74036JJ_CW"  newdirectory="//fileserver/folder10/TEST74036JJ_CW"> 
```

此代码似乎在 CF10 中运行良好。

当我们将代码移动到 CF8 服务器时，我们收到了相同的错误，新目录路径被附加到原始目录的末尾。

> 指定目录属性 //fileserver/folder10/test/TEST74036JJ_CW 不能重命名为newdirectory \\fileserver\folder10\test\fileserver\folder10\TEST74036JJ_CW

因此，CF10 现在似乎可以处理 cfdirectory action="rename" 的正斜杠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-13T15:19:53.357

我只有通过改变才能得到解决方案。在属性 newDirectory 上不写路径，只写新文件夹名称并准备好。试试看。这是我的选择。我使用coldfucion 9.0.1

# box-api - 如何在 box api 2.0 中以编程文件上传方式发送表单数据

> ID：10372708
> 
> 赞同：0
> 
> 时间：2012-04-29T14:04:03.550
> 
> 标签：box-api

以下是框 api 2.0 中文件上传中表单 POST 数据的正确示例吗？文档说“文件名”表单字段是一个字符串，但是当在 python 中发送帖子数据时，您需要在帖子中实际发送文件内容。那么， content-disposition: form-data 下面的行是命名“文件名”字段并包含文件内容的正确方法吗？

```
Content-type: multipart/form-data, boundary=AaB03x
Content-length: 142
Authorization: BoxAuth api_key=MY_API_KEY&auth_token=MY_AUTH_TOKEN

--AaB03x
content-disposition: form-data; name="filename"; filename="test.txt"
Content-type: text/plain

testing box api 2.0

--AaB03x-- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T13:15:33.607

您提到了 Python，尽管您没有提到它是一项要求。如果您可以使用 Ruby（另一种脚本语言），那么您就有一个非常好的库来处理 2.0 版本的 Box API。

该库名为[ruby​​-box](https://github.com/attachmentsme/ruby-box)，在自述文件中您可以找到如何使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T17:36:39.040

是的，这是正确的做法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-15T14:51:23.263

```
-------boundary
Content-Disposition: form-data; name="filename"; filename="82b.gif"
Content-Type: image/gif
Content-Transfer-Encoding: BASE64

$base64_encoded_binary_file_content
-------boundary
Content-Disposition: form-data; name="parent_id"

123456789
-------boundary-- 
```

这是工作代码。

# jquery - IE9 中的灰度

> ID：10372709
> 
> 赞同：1
> 
> 时间：2012-04-29T14:04:13.817
> 
> 标签：jquery, internet-explorer-9, grayscale

我的画廊有问题，我不知道如何解决。我根据本网站推荐 (http://webdesignerwall.com/demo/html5-grayscale/) 为我的照片使用灰度效果，在 FF 和 Chrome 中一切正常，但在 IE 中，所有图像都无法正确显示（重叠）。

我的代码是：

```
 function grayscale(src){
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        var imgObj = new Image();
        imgObj.src = src;
        canvas.width = imgObj.width;
        canvas.height = imgObj.height; 
        ctx.drawImage(imgObj, 0, 0); 
        var imgPixels = ctx.getImageData(0, 0, canvas.width, canvas.height);
        for(var y = 0; y < imgPixels.height; y++){
            for(var x = 0; x < imgPixels.width; x++){
                var i = (y * 4) * imgPixels.width + x * 4;
                var avg = (imgPixels.data[i] + imgPixels.data[i + 1] + imgPixels.data[i + 2]) / 3;
                imgPixels.data[i] = avg; 
                imgPixels.data[i + 1] = avg; 
                imgPixels.data[i + 2] = avg;
            }
        }
        ctx.putImageData(imgPixels, 0, 0, 0, 0, imgPixels.width, imgPixels.height);
        return canvas.toDataURL();
    }
                // Fade in images so there isn't a color "pop" document load and then on window load

    $(".item img").animate({opacity:1},0);

    // clone image
    $('a.thumb img').each(function(){
        var el = $(this);
        el.css({"position":"absolute"}).wrap("<div class='img_wrapper' style='display: inline-block'>").clone().addClass('img_grayscale').css({"position":"absolute","z-index":"998","opacity":"0"}).insertBefore(el).queue(function(){
            var el = $(this);
            el.parent().css({"width":this.width,"height":this.height});
            el.dequeue();
        });
        this.src = grayscale(this.src);
    });

    // Fade image 
    $('a.thumb img').mouseover(function(){
        $(this).parent().find('img:first').stop().animate({opacity:1}, 0);
    })
    $('.img_grayscale').mouseout(function(){
        $(this).stop().animate({opacity:0}, 0);
    }); 
```

我还附上了一张在 IE9 中显示照片的图片（http://postimage.org/image/8w0hnqnbl/ 提前致谢！

# c++ - 弧形二维碰撞检测

> ID：10372711
> 
> 赞同：1
> 
> 时间：2012-04-29T14:04:39.853
> 
> 标签：c++, math

我需要通过弧实现二维碰撞检测。我有玩家（黑点）和敌人（红点）。玩家可以向任何方向攻击，他的命中范围是120度（绿线表示）和一定的半径（黑色曲线）。

![我的艺术品](../Images/762435a3b52b6ae4d0829a9a07214b9e.png)

如何实现这种检测？

我已经完成了计算玩家和敌人之间角度的代码，但我不明白如何使用玩家的方向向量来检查它是否在弧内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:08:00.210

计算与敌人的角度和距离。使用它来检查它们是否在范围内。

问题很简单，如果是正方形的区域，因为您使用的是笛卡尔坐标，因此通过转换为径向坐标，这个问题也变得简单。

**有了新信息**

*   矢量 A 是玩家的方向矢量。
*   计算从敌人到玩家的向量 B。

检查向量 B 的长度是不是太长。

然后向量之间的角度由下式给出： acos(|AB| / |A||B|)

如果角度小于 60 度（120 度的一半），则敌人在射程内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:15:40.530

首先玩家必须有一个方向，例如一个二维向量。简单地说，它与第一条绿线的角度=它与另一条绿线的角度。

您应该执行两项检查：

1.  检查敌人与玩家之间的距离是否小于半径，如果不是，则移动到下一个敌人，如果是则
2.  在玩家和敌人之间画一条虚拟线，并计算这条线与玩家方向之间的角度，如果它小于 hit-area-angle 的一半（在你的例子中，如果它小于 60）那么玩家可以击中敌人，如果没有移动到下一个。

这应该足够一个想法，希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:28:41.310

假设您有指向“向前”的单位长度向量。假设您有指向潜在目标的单位长度向量。如果目标在方舟内，则；

`dot(forwardVector, targetVector) >= cosf(arcAngle/2)`.

如果向量不是单位长度，那么它当然不起作用。检查目标是否在要求的角度内。

检查它是否在要求的距离内是微不足道的，并且几乎是`squaredLength(targetPosition - playerPosition) <= arkDistance*arkDistance`squaredLength 所在的位置`dot(vector, vector)`。

# c# - 如何使用 c# 在类中创建一个 sqlconnection 以用于所有形式？

> ID：10372713
> 
> 赞同：0
> 
> 时间：2012-04-29T14:04:45.843
> 
> 标签：c#

1.  在类中创建 sqlserver 连接
2.  调用连接类以使用所有形式。

我想用 C# 在类中创建 SQLServer 连接以使用所有表单。

关于类文件中的连接代码

```
public System.Data.SqlClient.SqlConnection Con = new System.Data.SqlClient.SqlConnection();
public System.Data.SqlClient.SqlCommand Com = new System.Data.SqlClient.SqlCommand();

public string conStr;

public SQL2(string conStr)
{
    try
    {
        Con.ConnectionString = conStr;
        Con.Open();
        Com.Connection = Con;
        Com.CommandTimeout = 3600;
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
}

public bool IsConnection()
{
    Boolean st;

    if (Con.State==ConnectionState.Open)
    {
        st=true;
    }
    else
    {
        st = false;
    }

    return st;
} 
```

可以给我完整的示例代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:51:39.903

您可能想要的是用于创建连接的工厂：

```
using(var connection = databaseConenctionFactory.Create())
{
    // then do want you want here
} 
```

正如 LarsTech 提到的，您不想保持打开的连接。打开/使用/关闭。语法在`using`这里非常有用，因为它处理了所有不必要的绒毛。所以一旦你习惯了使用`using`，你就不会在生产系统中遇到任何奇怪的行为。

实施这样的事情有很多事情要做，所以你可以做一些研究。您可以使用 ADO 提供程序工厂并使用`IDbConnection`而不是特定实现来抽象您的实现。

您还可以使用依赖注入来访问您的工厂/工厂。

所以选择你的毒药:)

# c++ - 2个项目的解决方案无法编译

> ID：10372714
> 
> 赞同：3
> 
> 时间：2012-04-29T14:04:59.353
> 
> 标签：c++, mfc

我有 2 个项目的解决方案。在第一个项目中，我有 Frame 和一些控件，在第二个项目中 - CForcesEditorDialog:CDialog。Ofcouse我想比较它们。但是这个错误没有给我编译项目：

> MainFrame.obj：错误 LNK2019：未解析的外部符号“public：__thiscall CForcesEditorDialog::CForcesEditorDialog(class CWnd *,class MainFrame *)”(??0CForcesEditorDialog@@QAE@PAVCWnd@@PAVMainFrame@@@Z) 在函数“protected”中引用: int __thiscall MainFrame::OnCreate(struct tagCREATESTRUCTA *)" (?OnCreate@MainFrame@@IAEHPAUtagCREATESTRUCTA@@@Z)

```
class CForcesEditorDialog;

class MainFrame : public CFrameWnd
{
    CForcesEditorDialog* forcesEditorDialog;    

public:
    MainFrame();    
    ~MainFrame();   
    //virtual void CreateChildControls( void );
    //afx_msg void OnMouseMove(UINT, CPoint);

protected:
    afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
    DECLARE_MESSAGE_MAP()
};

int MainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    forcesEditorDialog = new CForcesEditorDialog(this,this);//CForcesEditorDialog(this,this);   
}

class CForcesEditorDialog : public CDialog
{
    //For including ForcesBar
    ForcesBar* m_forcesBar;
    MainFrame* pMainFrame;
public:
    CForcesEditorDialog(CWnd* _pParentWnd = NULL, MainFrame* _pMainFrame = NULL);   // standard constructor
}

CForcesEditorDialog::CForcesEditorDialog(CWnd* _pParentWnd, MainFrame* _pMainFrame)
: CDialog(IDD_CUR_DIALOG, _pParentWnd),
      p_expander    (0),
      p_selectedItem(0),
      m_enabled     (false)
{
    m_forcesBar = new ForcesBar();
    pMainFrame = _pMainFrame;
} 
```

可能是我在包含这个项目时遇到了问题。我从来没有用过 2 个项目的解决方案。你有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T06:48:47.117

你有一个链接错误。Visual Studio 在编译时找到 CForcesEditorDialog 但在链接时没有找到。您必须在第一个项目的项目设置中添加第二个项目的 .lib 文件（[Property Pages -> Linker -> Input -> Additional Dependencies](http://msdn.microsoft.com/en-us/library/ba1z7822.aspx)）。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T16:21:11.893

CForcesEditorDialog 是您编译的项目的一部分吗？换句话说，项目中是否包含 CForcesEditorDialog 的实现文件 (cpp) 会为您提供此错误消息？它是另一个项目或 DLL 的一部分吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:10:11.783

尝试在 MainFrame 类之前剪切 - 粘贴类 CForcesEditorDialog

应该做的伎俩

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:38:41.323

CForcesEditorDialog 在什么类型的项目中？它是静态库还是动态dll？

如果它是动态的，则需要从 dll 中导出要在 exe 中使用的函数和类。本教程提到导出： http: [//www.codeguru.com/cpp/cpp/cpp_mfc/tutorials/article.php/c4017/MFC-DLL-TUTORIAL-PART-1.htm](http://www.codeguru.com/cpp/cpp/cpp_mfc/tutorials/article.php/c4017/MFC-DLL-TUTORIAL-PART-1.htm)

使用 AFX_EXT_CLASS。您将在您的类声明中使用它从您的 dll 中导出它，例如：

```
class AFX_EXT_CLASS CForcesEditorDialog : public CDialog
{ 
```

# sass - 如何在 SCSS (3.1.16) 中创建 @keyframes mixin

> ID：10372717
> 
> 赞同：5
> 
> 时间：2012-04-29T14:05:23.657
> 
> 标签：sass, mixins, keyframe

我已经试过了

```
$prefixes: ("-webkit-","-moz-", "-o-", "");
@mixin keyframes($name) {
    @each $prefix in $prefixes {
        @#{$prefix}keyframes #{$name} { @content; }
    }
} 
```

和

```
@mixin keyframes($name) {
    @-webkit-keyframes #{$name} { @content; }
    @-moz-keyframes #{$name} { @content; }
    @keyframes #{$name} { @content; }
} 
```

有什么办法吗？谷歌找不到任何解决方案:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T07:39:02.550

我通过更新到 SASS 3.2（通过 预发布`gem install sass --pre`）设法实现了这种效果，结果后者现在可以工作了！

# javascript - 单击时更改图像的 z-index

> ID：10372718
> 
> 赞同：1
> 
> 时间：2012-04-29T14:05:46.877
> 
> 标签：javascript, jquery, html, css

我已经尝试了很多东西，但没有任何效果。

当我点击一个法师时，我希望它的 z-index 为“9999”。当我点击显示另一张图片时，我希望前一张图片的 z-index 回到“0”。

所以基本上，我只希望一次显示一个图像 - 我希望为每个图像运行一个特定的功能。

[http://jsfiddle.net/WarrenBee/a78R7/](http://jsfiddle.net/WarrenBee/a78R7/)

请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:08:49.187

将您的 JavaScript 更改为：

```
$('.char').click(function () {
    $('.char img').css({'z-index' : '0'});
    $(this).children('img').css({'z-index' : '9999'});
}); 
```

这会将 char 类中的所有 imgs 的 z-index 设置回 0，然后将单击的那个设置为 9999。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:09:51.440

只需记住最后一个图像和值并将旧值放回原处：

```
var lastImage, lastZIndex;
$('.char').click(function () { 
    var thisImage = $(this).children('img');
    if (lastImage) {
        lastImage.css('z-index', lastZIndex);
    }
    lastImage = thisImage;
    lastZIndex = thisImage.css('z-index');
    thisImage.css({'z-index' : '9999'})
}); 
```

[更新的小提琴](http://jsfiddle.net/a78R7/1/)

理想情况下，通过将所有变量包装在一个函数中来避免创建全局变量：

```
(function() {
    var lastImage, lastZIndex;
    $('.char').click(function () { 
        var thisImage = $(this).children('img');
        if (lastImage) {
            lastImage.css('z-index', lastZIndex);
        }
        lastImage = thisImage;
        lastZIndex = thisImage.css('z-index');
        thisImage.css({'z-index' : '9999'})
    });
})(); 
```

[进一步更新的小提琴](http://jsfiddle.net/a78R7/3/)

# java - Log4J 配置不显示 JBoss AS7 中的 Spring Transaction 和其他日志

> ID：10372720
> 
> 赞同：2
> 
> 时间：2012-04-29T14:06:36.283
> 
> 标签：java, logging, log4j, jboss7.x, spring-transactions

以下是我的 log4j.properties：

```
log4j.rootLogger=ALL, stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d [%t] %p [%c] - %m%n

log4j.logger.org.springframework=ALL
log4j.logger.app.dev.ems=ALL
log4j.logger.org.springframework.transaction=ALL 
```

我`log4jConfigLocation`在 web.xml 中提到过：

```
<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>/WEB-INF/resources/log4j.properties</param-value>
</context-param> 
```

并且还定义了它的监听类：

```
<listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
</listener> 
```

但我无法在控制台中看到 Spring Transaction 日志。同样来自一个班级：`app.dev.ems.web.wicket.page.home.HomePage`当我在做的时候：

```
Logger logger = LoggerFactory.getLogger(getClass());

public HomePage() {     
    logger.debug("<<<<<<<<<<<<<<<<<<<JYM>>>>>>>>>>>>>>>>>>");//if logger.info is used then it is showing.       
} 
```

这也没有显示该日志。我在 Wicket Application 中，我已经设置：

```
<init-param>
    <param-name>configuration</param-name>
    <param-value>DEVELOPMENT</param-value>
</init-param> 
```

在定义 WicketServlet 时。

我无法找到问题所在。任何信息都会对我很有帮助。

注意：如果您希望我发布 applicationContext.xml，我可以这样做。事务是注释驱动的。

* * *

我添加了 log4j-1.2.14、slf4j-api-1.6.1、slf4j-log4j12-1.4.2。我正在使用 JBoss AS-7.1.0-Final。

在其他 SO 线程中，我看到这是 JBoss 的问题，并且根据那里给出的指令，我在 WEB-INF 中添加了 jboss-deployment-structure.xml（也尝试使用 META-INF）：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure>
    <deployment>
        <exclusions>
            <module name="org.apache.log4j" />
        </exclusions>
    </deployment>
</jboss-deployment-structure> 
```

并在 applicationContext.xml 中定义了一个 bean，它将加载 log4j.properties：

```
<bean id="log4jInitializer" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetClass" value="org.springframework.util.Log4jConfigurer" />
    <property name="targetMethod" value="initLogging" />
    <property name="arguments">
        <list>
            <value>classpath:/app/dev/ems/web/log4j.properties</value>
        </list>
    </property>
</bean> 
```

但不幸的是，它没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T18:06:29.580

使用`jboss-deployment-structure.xml`排除应该有效。如果不是，它可能是您的配置文件的位置。我对 Spring 不熟悉，所以添加 可能`<context-param/>`是指定日志配置位置的典型方法。

您可能想尝试将您`log4j.properties`的文件移至存档的`WEB-INF/classes`or`META-INF`目录。此外，您还要确保在部署中包含 log4j 库。

FWIW`jboss-deployment-structure.xml`将不再需要记录配置。它还没有发布，但它在上游源中。

由于您似乎正在寻找一种打开调试的方法，因此您需要做两件事。您需要设置一个处理程序以允许调试消息通过。您还需要设置一个记录器，如果不是所有消息都可以通过，至少允许调试。

例如，在您的情况下，您将像这样创建一个记录器。

```
<logger category="app.dev.ems.web.wicket" /> 
```

这将创建一个记录所有级别的记录器。现在创建一个处理程序，或更改先前定义的处理程序以接受调试消息。

另一个例子是为您的特定记录器创建一个文件处理程序，它将您的日志消息打印到一个文件中。

```
<file-handler name="myFileHandler>
    <level name="DEBUG"/>
    <file relative-to="jboss.server.log.dir" path="my-log.log"/>
</file-handler> 
```

现在创建您的记录器并将处理程序分配给它。

```
<logger category="app.dev.ems.web.wicket">
    <handlers>
        <handler name="myFileHandler/>
    </handlers>
<logger> 
```

`app.dev.ems.web.wicket.*`现在，除了附加到根记录器的处理程序之外，所有通过具有类别的记录器的日志消息都将打印到该文件。如果您不想在默认值`server.log`或控制台中看到这些，您可以将`use-parent-handler="false"`属性添加到记录器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T20:11:17.777

I have found a solution. My aim was to see the transaction logs. And now I can see that. What I did, I have modified the standalone.xml file resides in standalone/configuration. I changed some parts of the Logging subsystem:

The console-handler:

```
<console-handler name="CONSOLE">
   <level name="INFO"/>
   <formatter>
       <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
   </formatter>
 </console-handler> 
```

changed to

```
<console-handler name="CONSOLE">
   <level name="DEBUG"/>
   <formatter>
       <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
   </formatter>
 </console-handler> 
```

And the root-logger

```
<root-logger>
   <level name="INFO"/>
   <handlers>
      <handler name="CONSOLE"/>
      <handler name="FILE"/>
   </handlers>
</root-logger> 
```

changed to

```
<root-logger>
   <level name="DEBUG"/>
   <handlers>
      <handler name="CONSOLE"/>
      <handler name="FILE"/>
   </handlers>
</root-logger> 
```

And that works. Now I can see the DEBUG log in console. :)

# c++ - 控制鼠标或键盘的程序

> ID：10372724
> 
> 赞同：3
> 
> 时间：2012-04-29T14:07:37.963
> 
> 标签：c++, c, windows, keyboard, mouse

我正在尝试了解我编写的程序如何控制我正在运行的 GUI 程序。我不确定 GUI 程序是否一定会为开发人员公开 API。因此，我认为最好的方法是让我的程序能够暂时独占控制键盘和鼠标，或者可能与用户共享控件（只要用户不使用程序可以控制鼠标/键盘的资源）。

我不知道该怎么做。我知道 C/C++、Python 和 Java。我主要是想在 Windows 上实现这个（我知道 C#）。

我不确定我在寻找什么（就关键字而言），所以我不知道如何在谷歌上搜索信息。任何帮助，将不胜感激。

编辑：我想我会提到我只是在为我的代码寻找一种控制鼠标和键盘的方法。该代码的输入将来自另一段代码，该代码（希望）知道鼠标/键盘必须做什么。目前我只想学习如何使用预定义的控制命令（例如移动到位置（100,100）、单击、键入“abcd”等）使我的代码控制鼠标/键盘。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:10:47.313

如果您想伪造一些鼠标/键盘事件，请发送输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-12T21:06:40.200

您可以使用 system.windows.forms 在 C# 中移动鼠标和编写键盘输入。例如，以下代码使用 system.windows.forms 中的基本方法来移动鼠标和编写键盘输入

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

//Make sure to add these as references in your project ahead of time
using System.Drawing;
using System.Windows.Forms;

namespace ConsoleApplication14
{
class Program
{
    static void Main(string[] args)
    {
        //The following code sets the cursor position to the point Xpos,Ypos 
//on the screen
        int Xpos = 0;
        int Ypos = 0;
        Cursor.Position = new Point(Xpos,Ypos);

        //The following writes the string KeyData to keyboard input
        string KeyData = "Hello World";
        SendKeys.SendWait(KeyData);
    }
}
} 
```

您还需要 System.Drawing 来使用鼠标光标操作点，所以不要忘记它！

这是一个精彩的视频，包含有关鼠标和键盘移动的信息[https://www.youtube.com/watch?v=48k9eyVsC-M](https://www.youtube.com/watch?v=48k9eyVsC-M)

注意：据我所知，虽然这些方法非常适合移动鼠标，但它们不会导致鼠标点击，因此您需要在其他地方进行研究以获取该信息

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-28T11:46:56.457

如果您知道如何使用 python 编程，那么有一个名为 pyautogui 的模块。要安装此模块，请按照以下步骤操作： **如果您使用的是 Windows 并且安装了 python。** **确保您已连接到 Internet** 打开 CMD 并输入： pip install pyautogui

# sql - 如何跨由中间表连接的三个表进行查询？

> ID：10372728
> 
> 赞同：2
> 
> 时间：2012-04-29T14:07:54.333
> 
> 标签：sql, sql-server-2008

我只有一个可能非常愚蠢的问题，但我无法解决这个问题。

我目前有3张桌子：

```
PROJECT    
PROJECT_CATEGORY     
CATEGORY 
```

Now`PROJECT_CATEGORY`是一个中间表，因此它只包含来自`PROJECT`and`CATEGORY`的主键`pID`和`cID`.

`pID`如果我有一个in 表，我知道如何编写查询，`CATEGORY`但在这种情况下，我只有中间表。那么我如何创建一个查询来检查这 3 个表，然后它会显示所有类别以及它们分配给哪些项目？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T14:10:43.860

```
select c.*, p.* 
from categories c
inner join PROJECT_CATEGORY pc on pc.category_id = c.id
inner join projects p on pc.project_id = p.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:19:51.110

如果我理解正确，您想查找一个类别是否有项目。以下查询显示有多少项目与给定类别相关联。

如果您想要与所有类别关联的所有项目的列表，您可以使用第二个查询。*类别 4*将不会显示在第二个结果中`INNER JOIN`，因为没有与该类别关联的项目。如果要显示类别 4，则必须更改`INNER JOIN`为`LEFT OUTER JOIN`.

[**单击此处查看 SQL Fiddle 中的演示。**](http://sqlfiddle.com/#!2/52794/24)

*脚本*：

```
CREATE TABLE project 
(
  projectid INT NOT NULL 
  , projectname VARCHAR(20) NOT NULL
);

CREATE TABLE projectcategory
(
    projectid   INT NOT NULL 
  , categoryid  INT NOT NULL
);

CREATE TABLE category
(
    categoryid      INT NOT NULL
  , categoryname    VARCHAR(20) NOT NULL
);

INSERT INTO project (projectid, projectname) VALUES 
    (1, 'project 1'),
    (2, 'project 2'),
    (3, 'project 3');

INSERT INTO category (categoryid, categoryname) VALUES 
    (1, 'category 1'),
    (2, 'category 2'),
    (3, 'category 3'),
    (4, 'category 4');

INSERT INTO projectcategory (projectid, categoryid) VALUES 
    (1, 1),
    (3, 2),
    (2, 1),
    (2, 2),
    (2, 3),
    (2, 2);

SELECT          c.categoryid
            ,   c.categoryname
            ,   COUNT(pc.categoryid) Number_Of_Projects
FROM            category c 
left outer join projectcategory pc 
on              pc.categoryid = c.categoryid
GROUP BY        c.categoryid
ORDER BY        c.categoryname;

SELECT          c.categoryid
            ,   c.categoryname
            ,   p.projectid
            ,   p.projectname
FROM            category c 
inner join      projectcategory pc 
on              pc.categoryid = c.categoryid
inner join      project p
on              p.projectid = pc.projectid
ORDER BY        c.categoryname; 
```

*输出*：

```
CATEGORYID CATEGORYNAME NUMBER_OF_PROJECTS
---------- ------------ ------------------
1          category 1           2
2          category 2           3
3          category 3           1
4          category 4           0

CATEGORYID CATEGORYNAME PROJECTID PROJECTNAME
---------- ------------ --------- -----------
1          category 1       1      project 1
1          category 1       2      project 2
2          category 2       3      project 3
2          category 2       2      project 2
2          category 2       2      project 2
3          category 3       2      project 2 
```

# java - Java IO 类 - 文件 IO 的麻烦

> ID：10372733
> 
> 赞同：1
> 
> 时间：2012-04-29T14:08:22.150
> 
> 标签：java, input

我这样初始化 a `BufferedReader`：

```
Reader reader = new BufferedReader(new InputStreamReader(new FileInputStream(filename), "UTF-8")); 
```

`filename`任何给定的字符串在哪里。

当我通过这样的循环处理输出时：

```
int k;
while((k = reader.read()) != -1){
        String entry;
        if (dict.containsKey(k))
            entry = dict.get(k);
        else if (k == mapSize)
            entry = w + w.charAt(0);
        else
            throw new IllegalArgumentException("Bad compressed k: " + k);
        this.fos.write(entry);
        result += entry;

        // Add w+entry[0] to the dictionary.
        dict.put(mapSize++, w + entry.charAt(0));

        w = entry;
} 
```

它只`65536`在到达 EOF 之前读取字符数。有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:12:38.327

你不需要打电话`ready()`。只需读取数据或行

```
String line;
while((line = reader.readLine()) != null) {
    //process, LZW algorithm
} 
```

或者

```
// buffer is redundant if you are reading large blocks.
Reader reader = new InputStreamReader(new FileInputStream(filename), "UTF-8");
char[] buffer = new char[8*1024];
int len;
while((len = reader.read(buffer)) > 0) {
    // process text
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T15:04:31.073

您正在尝试将*二进制*数据作为*字符*数据读取。那会很糟糕。utf8 是一种多字节字符编码，这意味着您从文件中读取的字符数可能不等于文件中的字节数。如果您尝试实现解压缩算法，则应该使用 InputStream 并读取*bytes*，而不是*chars*。

# c# - 检测用户是否必须在 Active Directory 中重置密码

> ID：10372735
> 
> 赞同：0
> 
> 时间：2012-04-29T14:08:23.257
> 
> 标签：c#, active-directory, ldap

我正在尝试检测用户是否必须在 Active Directory 中重置其密码。我正在使用用 C# 编写的控制台应用程序。

我在尝试运行的 GoDaddy 上有虚拟专用服务器

```
string strUserName = userName;
user = new DirectoryEntry("LDAP://0.0.0.0", "GodadyLogiUserInfo", "GodadyLogiUserPass", AuthenticationTypes.Secure);
DirectorySearcher searcher = new DirectorySearcher(user);

searcher.Filter = "(SAMAccountName=" + <USERWHICHNEEDTOTEST>+ ")";
searcher.CacheResults = false;

// Find user
SearchResult result = searcher.FindOne();
user = result.GetDirectoryEntry(); 
```

它抛出错误

> 服务器无法运行。

我在 SOF 和许多网站上尝试了很多方法，但找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T01:47:29.243

`LDAP://0.0.0.0`是服务器监听的有效地址。它不是客户端尝试连接的有效地址。您必须提供正确的主机名或 IP 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T19:41:46.760

只需尝试像这样连接 AD：

```
/* Connexion to Active Directory
 */
string sFromWhere = "LDAP://ServerDnsName:389/dc=dom,dc=..";
DirectoryEntry deBase = new DirectoryEntry(sFromWhere, "ADUser", "ADPwd"); 
```

# c# - 如何从数据库中读取图形图像并将其作为文件粘贴到剪贴板？

> ID：10372736
> 
> 赞同：0
> 
> 时间：2012-04-29T14:08:24.250
> 
> 标签：c#, mysql, entity-framework, clipboard

我有一个包含以下列的数据库表：idCompany:INT、Data:LONGBLOB、Extension:VARCHAR(5)、Name:VARCHAR(45)。

我已成功使用实体框架将图像持久保存到 mysql 中：

```
public static void PersistCurrentImage(Company company, FileStream logoStream, MyEntities context)
    {
        if (logoStream != null)
        {
            //reading
            byte[] data = new byte[logoStream.Length];
            logoStream.Read(data, 0, Convert.ToInt32(logoStream.Length));
            logoStream.Close();

            //setting image
            company.CompanyLogo = new CompanyLogo();
            company.CompanyLogo.Image = data;
            company.CompanyLogo.Extension = Path.GetExtension(logoStream.Name);
            company.CompanyLogo.Name = Path.GetFileName(logoStream.Name);

            context.SaveChanges();

        }
    } 
```

我想做的是从数据库中获取图像，从中制作一个文件并将其放在剪贴板中，以便稍后我可以粘贴该文件。

我已经寻找了 1 个小时的解决方案，但我似乎可以找到它。先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:39:52.313

我用这样的代码取得了成功：

```
File.WriteAllBytes(@"logo.jpg", company.CompanyLogo.Image.ToArray());
StringCollection paths = new StringCollection();
paths.Add("logo.jpg");
Clipboard.SetFileDropList(paths); 
```

现在文件在剪贴板中，就像您在资源管理器中完成了 ctrl-C 一样。

这假设徽标是 jpg，在我的情况下，图像存储为 Sql Server 的`image`数据类型。我认为 MySql 的`LONGBLOB`行为方式相同。请注意，您应该使用完整的路径（为简洁起见，此处省略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T15:19:31.313

好的，我已经解决了。首先将图像写入硬盘驱动器，然后将其复制到剪贴板。

```
public static void CopyLogo(Company company)
    {
        if (company.CompanyLogo != null)
        {
            MemoryStream ms = new MemoryStream(company.CompanyLogo.Image, 0, company.CompanyLogo.Image.Length);

            using (ms)
            {
                //saving image on current project directory
                Image img = Image.FromStream(ms);
                img.Save(Environment.CurrentDirectory+"\\"+ company.CompanyLogo.Name);

                //copying to clipboard
                StringCollection paths = new StringCollection();
                paths.Add(Environment.CurrentDirectory + "\\" + company.CompanyLogo.Name);
                Clipboard.SetFileDropList(paths);
            }

        }
    } 
```

# css - 为什么 CSS 不能正确渲染这个表格？列标题被错误地“填充”到它的内容中

> ID：10372743
> 
> 赞同：0
> 
> 时间：2012-04-29T14:08:51.440
> 
> 标签：css, jsfiddle

我有一个我正在处理的 jsfiddle，在 AppleWebkit 和 Mozilla 中，“Employer”列标题在间距方面与列的内容不匹配。 [http://jsfiddle.net/4XyzJ/28/](http://jsfiddle.net/4XyzJ/28/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:11:54.560

`th`元素默认居中。给你的`th`sa风格`text-align:left`。

更新小提琴：http: [//jsfiddle.net/4XyzJ/29/](http://jsfiddle.net/4XyzJ/29/)

编辑：
您看不到对其他列的影响的原因是`th`s 都比相应`td`的 s 宽，然后填充列宽。只有最后一个`th`更窄。

# android - 用于某种情况的类？

> ID：10372744
> 
> 赞同：0
> 
> 时间：2012-04-29T14:08:51.977
> 
> 标签：android

嗨 Android 开发人员，

我需要为我的程序的一部分上课。让我为你描述一下这个问题。

我需要一个类，让我**向下滚动可以****单击**的“项目”列表。此外，此项目列表可以**根据需要增长（扩展）或缩小**，如 ArrayList。

我看到了 ScrollView 类，但这是否满足我需要的所有要求？

如果不是，在我的 main.xml 文件中使用什么类来完成此任务的最佳方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:11:13.983

您可以尝试`ListView`在您的 XML 文件中使用，然后从`Arraylist`. 像这样的东西会为你工作。

```
public class YourActivity extends Activity 
{
private ListView lv;
public void onCreate(Bundle saveInstanceState) {
     lv = (ListView) findViewById(R.id.your_list_view_id);
     // Instanciating an array list (you don't need to do this, you already have yours)
     ArrayList<String> your_array_list = new ArrayList<String>();
     your_array_list.add("a");
     your_array_list.add("b");
     // This is the array adapter, it takes the context of the activity as a first // parameter, the type of list view as a second parameter and your array as a third parameter
     ArrayAdapter<String> arrayAdapter =      
     new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, your_array_list);
     lv.setAdapter(arrayAdapter); 
     setContentView(R.layout.your_layout);

}
} 
```

# javascript - 使用 setTimeout() 和 .call()

> ID：10372746
> 
> 赞同：0
> 
> 时间：2012-04-29T14:09:12.883
> 
> 标签：javascript, settimeout

我有点坚持尝试将 setTimeout 设置为使用 .call() 方法进行的函数调用。

基本上，我有一组函数引用，然后逐个遍历它们并以特定的 setTimeout 间隔调用它们。第一个函数触发 aok，但第二个函数没有触发，我在 js 控制台中收到一个我不理解的错误 - 错误是 -

未捕获的类型错误：对象 73 没有方法“调用”

编码：

```
 function scene1(){             
            alert("boo");
        }

        function scene2(){          
            alert("boo2");
        }            

        var arrAnimation = [];
        arrAnimation[0] = scene1;                   
        arrAnimation[1] = scene2;                 

        //step through the array
        for (var i = 0; i < arrAnimation.length; i++){
                setTimeout(arrAnimation[i],3000).call();                  
        } 
```

任何帮助将非常感激。担

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:11:39.867

您不需要使用`call`- 您需要做的就是将函数传递给`setTimeout`它，它将自动运行：

```
setTimeout(arrAnimation[i],3000); 
```

关于错误本身的仅供参考 -`setTimeout`返回一个数字作为句柄，如果您需要，它可以让您稍后取消超时。数字没有`call`功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:13:55.490

你有`.call`错误的地方的方法。干得好：

[http://jsfiddle.net/JkLk2/](http://jsfiddle.net/JkLk2/)

# php - 更短的语言检测

> ID：10372747
> 
> 赞同：1
> 
> 时间：2012-04-29T14:09:23.470
> 
> 标签：php, url

我需要一种方法来包含基于 URL 中语言的 php 文件。现在这个脚本正在工作，但是当我有 10 或 20 种语言时，我想要一些更短的脚本，它仍然包含相同的信息。问题是，如果 URL 中的“lg”更改为不存在的语言，我想使用英语。

```
$langue=$_GET['lg'];
if ($langue == "da")
{ include"da.php";}
elseif ($langue == "de")
{ include"de.php";}
elseif ($langue == "en")
{ include"en.php";}
elseif ($langue == "es")
{ include"es.php";}
else { include"en.php";} 
```

谁能缩短这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T14:13:44.187

```
if (empty($_GET['lg'])) {
  $lang = "en";
} else {
  $lang = $_GET['lg'];
}
if ( !preg_match('~^[a-z]{2}$~',$lang) ) {
  header('HTTP/1.1 403 Forbidden'); 
  exit;
}
$langfile = "$lang.php";
if (!is_readable($langfile)) {
  $lang     = "en";
  $langfile = 'en.php';
}
include $langfile; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:12:20.580

只需使用：

```
$lang = (file_exists($_GET['lg'] . '.php')) ? $_GET['lg'] . '.php' : 'en.php';
include($lang); 
```

**编辑**：根据评论，我应该指出，这段代码虽然实用且简洁，但确实很容易受到恶意攻击，基本上任何人都可以将 URL 变量设置为配置或其他敏感文件，然后对您的站点发起攻击，或窃取您的数据。因此，请确保`$lang`在调用 include 之前验证变量 - 也许使用一个简单的方法：

```
$allowed = array('en.php', 'fr.php');
if(in_array($lang, $allowed)){
    include($lang);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:14:04.233

```
<?php
    $languages = array('da', 'de', 'en', 'es');

    $lang = 'en';
    if(!empty($_GET['lg']) && array_search($_GET['lg'], $languages) !== false) {
        $lang = $_GET['lg'];
    }
    include $lang.'.php';
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:17:03.420

这样的事情呢？

```
if(isset($_REQUEST['lg']) && $_REQUEST['lg'] != '') $lg = $_REQUEST['lg'];

if(strstr($lg, '.')) die('Don\'t allow any . in the languages');

if(file_exists('path_to_language_files/'.$lg.'.php') {
    include('path_to_language_files/'.$lg.'.php');
} else {
    include('path_to_language_files/en.php');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-29T15:46:59.540

I have a page which uses only two languages but i needed it to be open for adding more and so, i solved the same problem like this:

```
$allowed=array("da","de","en","es");
$default="de.php";
include(array_search($_GET["lg"],$allowed) === false ? $default : $allowed[array_search($_GET["lg"] , $allowed)].".php"); 
```

It should work similarly, except you can specify which files are allowed, and their names are taken from the array, so it should be safe from fake requests.

# java - 如何将更高的JPanel转换为pdf

> ID：10372751
> 
> 赞同：0
> 
> 时间：2012-04-29T14:09:40.260
> 
> 标签：java, swing, pdf, export

我的面板高度为 1600。A4 格式的高度为 842。如何将此面板导出为两页的 pdf？或者我如何将此面板分成两半到两个图形然后添加到第一页然后调用`document.newPage();`第二个图形添加到第二页

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T17:16:31.667

简而言之，假设您打算使用 iText，

您需要实现 java.awt.print.Pageable，就像普通的 Java 打印一样。在您的示例中，它将有 2 页，即 Printables。通常，在 Printable 方法中

```
print(Graphics graphics, PageFormat pageFormat, int pageIndex) 
```

您将根据页码翻译传入的图形。例如，在您的示例中按 pageIndex*842 进行翻译。那里可能有一个减号 - 根据我的经验，你有 50:50 的机会来确定方向。:-) 也可能需要担心利润空间。

然后，购买 iText in Action（第 2 版）一书并查看第 485 页，了解如何从 Swing 进行一般 PDF 创建。

循环遍历每一页。

```
for (int pageIndex=0; pageIndex< pageable.getNumberOfPages(); pageIndex++) {
   Graphics2D g2d = contentByte.createGraphics(width, height, fontMapper);
   Printable printable = pageable.getPrintable(pageIndex);
   PageFormat pageFormat = pageable.getPageFormat(pageIndex);
   int pageStatus = printable.print(g2d, pageFormat, pageIndex);
   if (pageStatus != Printable.PAGE_EXISTS)
      break;  // something screwey happenned
   g2d.dispose();
} 
```

正如您可能已经猜到的那样，我一直在这样做，并且可能会在几天内发布一个包含更完整代码的博客。所以请继续关注。

# zend-framework - Zend + 在 FormSelect 视图助手中使用带括号的名称（数组表示法）呈现为多选元素，而不是常规下拉列表

> ID：10372752
> 
> 赞同：0
> 
> 时间：2012-04-29T14:09:46.760
> 
> 标签：zend-framework, zend-form

在我的项目中，我需要有许多带有数组标记名称的下拉字段，如下所示：

```
<select name="language[]">...</select>
<select name="language[]">...</select>
<select name="language[]">...</select> 
```

由于我需要为`formSelect`它渲染 Zend 的视图助手，我认为这很简单：

```
for($i = 0; $i < 3; $++){
    echo $this->formSelect('language[]', $this->languages[$i],
                                         $this->attribs[$i],
                                         $this->languageOptions[$i]);
} 
```

但我错了：Zend 没有将它们呈现为常规的下拉字段，而是决定做一个聪明的人并将它们呈现为多选字段。

我理解这种行为背后的想法，但碰巧它`formSelect`提供的帮助对我的需求来说太多了。

现在，我可以使用 JavaScript 来修改它以删除`multiple="multiple"`属性以将它们转换为常规下拉列表...

但出于好奇，除了修改其底层代码之外，有没有办法`formSelect`将这些元素呈现为常规下拉字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T16:37:03.197

您是对的，`formSelect`助手决定根据元素名称是`array[]`.

但是，您可以覆盖该行为。

为此，请将元素添加`multiple => false`到您的列表中`$attribs`。

例如

```
$attribs = array('multiple' => false, 'class' => 'selection');
echo $this->formSelect('not_array[]', '', $attribs, $options); 
```

这应该防止它试图使元素支持多个选择。

# wordpress - 在现有网站中集成 wordpress - 永久链接问题

> ID：10372756
> 
> 赞同：0
> 
> 时间：2012-04-29T14:10:00.900
> 
> 标签：wordpress, integration, permalinks

您如何使用 wordpress 功能（使用 wp-blog-header.php）并保持永久链接的行为？

我有一个非常复杂的网站，因此无法在 wordpress 中重新创建它。但是，我想在站点内有一个博客。由于这些原因和更多限制，我必须使用 wordpress 功能或 curl 调用，因此 wordpress 内容将存在于我的网站页眉和页脚之间。

我使用了 wordpress 功能，在我的网站中包含了 wp-blog-header.php，并且查询确实需要付出一点努力，但正如您可能期望的那样，永久链接链接到博客本身（在我的网站之外）。

如何使单个帖子/类别等的永久链接保持在站点范围内？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T21:42:55.763

简短的回答是“不要”。

如果您选择在外部使用 wordpress，则必须自己创建永久链接。通常这应该没什么大不了的，但如果你想涵盖所有“漂亮 url”的场景，那就太痛苦了。

最后，我对 Wordpress 安装使用了 CURL 请求，并将呈现的 HTML 注入我的站点。通过一些 mod_rewrite，我使整个系统运行顺畅。

# asp.net - C# / ASP.Net / Json - Echo Nest

> ID：10372763
> 
> 赞同：0
> 
> 时间：2012-04-29T14:10:46.463
> 
> 标签：asp.net, json

我试图让用户在文本框中键入艺术家，然后按一个按钮来调用 Echo Nest API。

这是一个示例调用： http: [//developer.echonest.com/api/v4/playlist/basic ?api_key=N6E4NIOVYMTHNDM8J&artist=Weezer&format=json&results=20&type=artist-radio](http://developer.echonest.com/api/v4/playlist/basic?api_key=N6E4NIOVYMTHNDM8J&artist=Weezer&format=json&results=20&type=artist-radio)

我将如何构建 API 调用以将该信息包含在来自文本框的用户输入中。例如，在上面的调用中，用户输入将是“Weezer”。

这是链接：http: [//developer.echonest.com/docs/v4/playlist.html](http://developer.echonest.com/docs/v4/playlist.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:46:48.193

此解决方案使用 jQuery 并假定以下 html。请注意，它还使用 JSONP，因为您是从客户端发出请求以避免跨域安全限制。为了完成这项工作，我更改了格式类型并添加了回调。getJSON 调用使用回调变量的存在来注入匿名回调函数，该函数将调用您的实际回调。

```
 <label for="artist">Artist</label>
 <input type="text" id="artist" name="artist" />
 <button id="search-artist">Find</button>

 $('#search-artist').click( function() {
     var url = "http://developer.echonest.com/api/v4/playlist/basic?api_key=N6E4NIOVYMTHNDM8J&artist="
                   +  $('#artist').val()
                   + "&results=20&type=artist-radio"
                   + "&format=jsonp&callback=?";
     $.getJSON(url, function(data) {
         // do something with the returned JSON data
     }
 }); 
```

# github - 发布问题时通知 github 观察者

> ID：10372777
> 
> 赞同：-1
> 
> 时间：2012-04-29T14:13:01.127
> 
> 标签：github

有没有办法在发布问题时通知 github repo 的观察者？理想情况下，自动？

[（观看[give.github.com](http://giving.github.com/)的人大概是为了在发布问题时得到通知，而不是知道网页何时更新！）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:23:32.043

当前解决方案：

手动，从克隆仓库中的命令行：

```
git commit --allow-empty -m "issue #2 posted"
git push 
```

这有望通知每个人，他们会直接获得指向该问题的超链接，但这不是自动的。

# java - 长计数设置和未设置位上的 Java 位操作

> ID：10372781
> 
> 赞同：1
> 
> 时间：2012-04-29T14:13:42.220
> 
> 标签：java

我有一个很长的号码。现在我想要的是（以伪代码给出），

```
int cnt1 = 0 
int cnt2 = 0 

for each two bits of that long

       if the two bits == 11
            then cnt1++

       else
            cnt2++

    Print i and i+1 th bits are ... (example 00, 11 etc.) and cnt1 = ... and cnt2 = ...

(for example if number is three (representation "00 00 00 .... 11)" 
  it will give output cnt1 = 1 and cnt2 = 31) 
```

有人可以帮我怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:22:21.967

您需要做的是在每次迭代时继续向右移动 2 位，并对数字 3（二进制中的 11）进行按位与 (&) 运算：

```
long number;
int cnt1 = 0;
int cnt2 = 0;
long test = 3;
int counter = 0;    

while(counter < 64) { // we have 64 bits to inspect
    if((number & test) == 3) { // last 2 bits are 11
        cnt1++;
    } else { // last 2 bits are either 10, 01 or 00
        cnt2++;
    }          
    counter += 2;
    number = number >>> 2; // shift by 2 bits to the right
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:27:40.513

您需要做的是创建一个位掩码并在您的值上运行它，假设这是家庭作业，我只会给出一些指示：

*   您已经给出的位掩码：`long mask = 0x03L;`
*   要检查每隔 2 位，请将您的掩码向左移动 2 个药水
*   您可以使用 for 循环检查该值，直到您的掩码值为 0
*   使用按位与运算符`&`对照掩码检查值

如果您将上述提示放入代码中，您将得到答案:-)

**现在编辑**结果，我的解决方案是：

```
long cnt1 = 0;
long cnt2 = 0;

for (long mask = 0x03; mask != 0; mask <<=2) {

    (mask == (value & mask)) ? cnt1++ : cnt2++;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-29T14:28:28.973

一个简短的回答。

```
long num = ~0L;
int cnt1 = Long.bitCount(num & (num >>> 1) & 0x5555555555555555L);
System.out.println(cnt1);
int cnt2 = 32 - cnt1; 
```

印刷

```
32 
```

# javascript - 多态函数作为事件回调

> ID：10372785
> 
> 赞同：1
> 
> 时间：2012-04-29T14:14:00.537
> 
> 标签：javascript, jquery

我需要将此函数作为回调传递给 DOM 事件

```
var fooo = function() {
  $(this).append("foo");
  fooo = function() {
     $(this).append("bar");
  };
};

$("#hover").hover(fooo);​ 
```

此示例应附加“foo”，然后附加“bar”，但它不起作用。我究竟做错了什么？

[JSFiddle](http://jsfiddle.net/tNBx9/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:16:14.870

这也不起作用：

```
var fooo = function() {
    $(this).append("foo");
};

$("#hover").hover(fooo);

fooo = function() {
    $(this).append("bar");
}; 
```

因为您更改了变量，但没有更改传递给`hover`事件的回调。

您需要将新函数分配为回调：

```
var fooo = function() {
    $(this).append("foo");
};

$("#hover").hover(fooo);

fooo = function() {
    $(this).append("bar");
};
$("#hover").unbind('hover').hover(fooo);​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:17:02.037

您正在更改分配给的函数`fooo`，*而不是*分配为 的回调的函数`.hover`。

为清楚起见，当您将函数作为事件的处理程序传递时（例如在这种情况下），`$().hover(fooo)`您传递的不是变量，`fooo`而是它指向的函数。如果您重新分配`fooo`给其他东西，原始函数仍然是作为事件处理程序绑定的函数。

如果我想做你想做的事，那么我会使用稍微不同的范例。就像是

```
var fooo = (function() {
    var altBehavior = false;
    return function() {
        $(this).append(altBehavior ? "bar" : "foo");
        altBehavior = true;
    }
})();

$("#hover").hover(fooo);​ 
```

实际的绑定函数永远不会改变，但它*存在*的上下文会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:22:56.007

您将函数分配给`fooo`悬停事件，然后更改变量，而不更改处理程序本身。您应该取消绑定然后绑定另一个函数。 `hover`是两个事件的简写，因此解开每个事件：

```
var fooo1 = function() {
  $(this).append("foo").unbind("mouseenter", fooo1).unbind("mouseleave", fooo1).hover(fooo2);
};

var fooo2 = function() {
  $(this).append("bar");
}

$("#hover").hover(fooo1);​ 
```

# android - 只拦截双击

> ID：10372789
> 
> 赞同：2
> 
> 时间：2012-04-29T14:15:35.073
> 
> 标签：android, android-webview, android-2.3-gingerbread, gesturedetector

我目前在要响应双击的 webView 上有一个 GestureDetector。但是，webView 然后忽略所有单击 - 大概我也覆盖了这种行为。

我在寻找：

*   由我的代码检测并由我的活动处理的双击
*   WebView 正常处理的常规点击

这是我到目前为止所拥有的：

```
final WebView web = (WebView) findViewById(R.id.webView1);
WebViewClient webrules = new WebViewClient(){
        public boolean shouldOverrideUrlLoading(WebView web,String url){
            return false;
        }
    };
    web.setWebViewClient(webrules);
    WebSettings webSettings = web.getSettings();
    webSettings.setJavaScriptEnabled(true); 
```

```
final GestureDetector gestureDetector = new GestureDetector(new GestureDetector.SimpleOnGestureListener() {

        @Override
        public boolean onDoubleTap(MotionEvent e) {
            Log.d("**APP**", "Double Tap event");
            return true;
        }

        @Override
        public boolean onDown(MotionEvent e) {
            return true;
        }
    });
    gestureDetector.setIsLongpressEnabled(true);

    web.setOnTouchListener(new OnTouchListener(){

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            return gestureDetector.onTouchEvent(event);
        }

    }); 
```

如何将正常的单击留给 webView 处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T14:21:33.977

尝试在您的`onDown`方法中返回 false 。返回真正的“意味着”该事件已被消费，因此不会被传递。

# c# - ImageList：32 位图像质量下降

> ID：10372797
> 
> 赞同：8
> 
> 时间：2012-04-29T14:17:04.433
> 
> 标签：c#, winforms, graphics, imagelist

我正在使用`ImageList`for`TreeView`和`ListView`。我首先将图像质量设置为 32 位，然后添加半透明图像。质量看起来不错，但经过​​几分钟的编码、编译和执行应用程序，质量看起来很糟糕。

看截图： ![在此处输入图像描述](../Images/d355728989d04789d61f0165c45ec34e.png)

使用的属性

```
ColorDepth: Depth32Bit
ImageSize: 16; 16
TransparentColor: Transparent 
```

在半透明但不完全透明的像素后面有黑色像素。

重新添加所有图像可恢复原始质量，但几分钟后，它看起来像在屏幕截图的右侧。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-07T14:06:50.517

`ImageStream`当图像存储为（VS Designer 的默认行为）时，看起来 alpha 通道数据会丢失。因此，如果您可以停止使用 Designer 设置图像`ImageList`，则可以使用半透明图像至`ColorDepth.Depth32Bit`. 这是非常不方便的，但它的工作原理。

因此，您可以将图像放入`Resources.resx`文件中，并将它们添加到代码中的适当位置。例如在 you `UserControl`/的构造函数中，通过如下代码`Form`调用后：`InitializeComponent()`

```
 _imageList.Images.Add(Resources.Image32);
  _imageList.Images.SetKeyName(0, "Image32");
  _myButton.Image = 0; 
```

*（此信息可在回复标记答案的评论中找到，我已将此添加为答案，因此很难错过另一个可用选项）*

# ruby-on-rails - Rails update_attributes 不更新嵌套属性

> ID：10372800
> 
> 赞同：1
> 
> 时间：2012-04-29T14:17:51.050
> 
> 标签：ruby-on-rails, nested-attributes

在我的 Rails 应用程序中，我的每个组都有_many :expenses。每笔费用有_many :shares。我已经成功设置了一个嵌套表单，它允许我同时创建费用和份额。但是，当我使用相同的表单尝试编辑费用时，我为确保所有份额的总和等于费用总额而设置的验证失败。

这是我的控制器的更新方法：

```
def update
  @expense = Expense.find(params[:id])
  @group = Group.find(params[:group_id])
  if @expense.update_attributes(params[:expense])
    redirect_to @group
  else
    render 'edit'
  end
end 
```

在我的模型文件中，我已经在费用.rb 中声明了accepts_nested_attributes_for :shares，并将 :shares_attributes 添加到其 attr_accessible 列表中。

我在费用中设置的验证失败是：

```
def shares_must_equal_total_amount
    if self.shares.sum(:amount) != self.amount
        errors.add(:shares, " must equal expense amount")
    end
end 
```

我最困惑的是，如果我

```
puts @expense.amount and 
@expense.shares.sum(:amount) 
```

在我的更新方法的 else 子句中（在渲染“编辑”之前），这两个值是不同的。但是，在 params[:shares_attributes] 中，各个份额的数量显然正在更新并通过验证。因此，由于某种原因，当我调用 if @expense.update_attributes(params[:expense]) 时，@expense.shares 没有被更新。

我在这里想念什么？谢谢您的帮助。

# java - Netty - 如何获取所有客户端频道？

> ID：10372801
> 
> 赞同：10
> 
> 时间：2012-04-29T14:17:55.667
> 
> 标签：java, networking, netty

我在使用netty示例代码-telnet数据包，现在代码可以建立服务器和客户端使用telnet聊天，但客户端只能与服务器交谈。我正在重写它以使客户端可以与所有客户端通信，因此我需要保留一个频道列表，以便当客户端与服务器联系时，服务器可以将消息发送给所有客户端。谁能告诉我如何获得所有客户渠道？（示例代码[在此处输入链接描述](https://github.com/netty/netty/tree/master/example/src/main/java/io/netty/example/telnet)）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-01-21T16:06:57.470

**对于 Netty 4.0.X**

在主类中，您需要声明 ChannelGroup 对象：

```
 final ChannelGroup channels = 
                new DefaultChannelGroup(GlobalEventExecutor.INSTANCE); 
```

连接新客户端时（您应该将构造函数中的通道对象传递给处理程序类）：

```
@Override
public void channelActive(ChannelHandlerContext ctx) throws Exception {
    channels.add(ctx.channel());
} 
```

要获取所有客户端，只需迭代通道对象：

```
for (Channel ch : channels) {
    //do something with ch object
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-29T22:53:35.473

毛里西奥的提议很好。此外，Netty API 已经在[ChannelGroup](http://docs.jboss.org/netty/3.2/api/org/jboss/netty/channel/group/ChannelGroup.html)中提供了一个通道容器。它是线程安全的，并且还提供了一些附加功能，例如对所有包含的通道进行分组操作，以及在关闭时自动删除包含的通道。从javadoc：

> 一个线程安全的 Set，包含开放的 Channels 并在它们上提供各种批量操作。使用 ChannelGroup，您可以将 Channel 分类为有意义的组（例如，基于每个服务或每个状态）。关闭的 Channel 会自动从集合中删除，因此您无需担心添加频道。一个 Channel 可以属于多个 ChannelGroup。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T10:30:06.007

这是一个小例子（覆盖 SimpleChannelUpstreamHandler 的 channelConnected）：

```
ChannelGroup allConnected = new DefaultChannelGroup("all-connected");

@Override
public void channelConnected(ChannelHandlerContext ctx, ChannelStateEvent e) throws Exception {
    super.channelConnected(ctx, e);
    allConnected.add(e.getChannel());
} 
```

您现在可以向所有连接的通道发送消息，如下所示：

```
 ChannelBuffer cb = ChannelBuffers.wrappedBuffer("hello".getBytes(Charset.forName("UTF-8")));
    allConnected.write(cb); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-29T14:48:04.807

在**[channelConnected](https://github.com/netty/netty/blob/master/example/src/main/java/io/netty/example/telnet/TelnetServerHandler.java#L50)**事件中，从**ChannelHandlerContext**中获取客户端并将其存储在某个地方（并发集合会很好，例如**[ConcurrentHashMap](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)**）。您还必须实现**[channelClosed](http://docs.jboss.org/netty/3.2/api/org/jboss/netty/channel/SimpleChannelUpstreamHandler.html#channelClosed%28org.jboss.netty.channel.ChannelHandlerContext,%20org.jboss.netty.channel.ChannelStateEvent%29)**方法以从您的集合中删除断开连接的通道。

# html - 链接在 Internet Explorer 中不起作用

> ID：10372802
> 
> 赞同：2
> 
> 时间：2012-04-29T14:18:03.120
> 
> 标签：html, internet-explorer, hyperlink

无论出于何种原因，某些访问者在 Internet Explorer 中无法点击[http://www.ockelborum.se](http://www.ockelborum.se)上的主菜单链接。它们在所有平台上的所有其他浏览器中都能正常工作。链接的代码如下所示：

```
<div class="nav">
    <ul>
        <li><a href="http://www.ockelborum.se/index.html">Hem</a></li>
        <li><a href="http://www.ockelborum.se/lagenheter-lingbo.html">Lägenheter i Lingbo</a></li>
        <li><a href="http://www.ockelborum.se/lagenheter-ockelbo.html">Lägenheter i Ockelbo</a></li>
        <li><a href="http://www.ockelborum.se/overnattningsrum.html">Övernattningsrum</a></li>
        <li><a href="http://www.ockelborum.se/hotellkontakt.html" class="active">Kontakt</a></li>
        <li><a href="http://www.ockelborum.se/erbjudanden.html">Erbjudanden</a></li>
        <div style="clear: both;"></div>
    </ul>
</div> 
```

你会在这里找到样式表：[http ://www.ockelborum.se/style.css](http://www.ockelborum.se/style.css)

我真的希望有人能帮我解决这个问题，因为我很难过。哦，至少有一位访问者使用了 IE8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:43:19.303

您可以访问 Internet Explorer 6 吗？如果没有，并且您确实安装了 Windows 7，请尝试下载虚拟机​​ Windows XP Mode。它预装了 IE6……我敢打赌那些声称无法点击链接的人正在使用的 IE。

我的猜测是你正在浮动你的无序列表项目，并且你把清除放在错误的位置（它应该在结束无序列表标签之后）。不知何故，这*可能*会导致问题，因为您不应该在无序列/有序列表中包含列表项之外的任何内容。

我认为你需要做的是将清除移到无序列表之外，如下所示：

```
<div class="nav">
  <ul>
    <li><a href="http://www.ockelborum.se/index.html">Hem</a></li>
    <li><a href="http://www.ockelborum.se/lagenheter-lingbo.html">Lägenheter i Lingbo</a></li>
    <li><a href="http://www.ockelborum.se/lagenheter-ockelbo.html">Lägenheter i Ockelbo</a></li>
    <li><a href="http://www.ockelborum.se/overnattningsrum.html">Övernattningsrum</a></li>
    <li><a href="http://www.ockelborum.se/hotellkontakt.html" class="active">Kontakt</a></li>
    <li><a href="http://www.ockelborum.se/erbjudanden.html">Erbjudanden</a></li>        
  </ul>
  <div style="clear: both;"></div>
</div> 
```

# c++ - 如何强制函数参数为相同类型并且不允许使用类型构造函数匹配给定类型？

> ID：10372803
> 
> 赞同：3
> 
> 时间：2012-04-29T14:18:11.423
> 
> 标签：c++, visual-studio-2008, visual-c++

在 C++ 中发现这个特性让我有点惊讶，我没想到它会发生。

这是代码：

```
struct XY {
    int x,y;
    XY(int v) : x(v), y(v) {}
};

bool test1(const XY &pos){
    return pos.x < pos.y;
}
bool test1(int x, int y){
    return x < y;
}
void functest(){
    int val = 5;
    test1(val);
} 
```

所以我可以调用一个带有整数参数的函数，无论是否存在这种重载，它都会使用 XY 类型的函数，因为它有一个相同类型的构造函数！我不希望这种情况发生，我能做些什么来防止这种情况发生？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T14:19:08.473

使`XY`构造函数显式：

```
explicit XY(int v) : x(v), y(v) {} 
```

这将禁止从`int`to 的隐式转换`XY`，这是在您调用单参数`test1`函数时发生的情况。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-29T14:28:45.557

我不明白为什么这对你不利。您的代码中实际上没有其他匹配项。你用一个参数调用了一个函数，你得到了最好的匹配。

如果你有这个，那么它会有所不同：

```
bool test1(const XY &pos){
    return pos.x < pos.y;
}

bool test1(int x){
    return !x;
}

void functest(){
    int val = 5;
    test1(val);
} 
```

如果这是第一次运行，那就不好了，因为 C++ 不“喜欢”使用隐式构造函数。它倾向于“首先输入类型，然后是构造函数中具有该类型的任何对象”。

但是你所拥有的是1个论点与2个论点。我不知道为什么这是一个问题。

# c# - 如何使用套接字将数据从 .NET Server 应用程序发送到 Windows 8 Metro Client 应用程序？

> ID：10372806
> 
> 赞同：0
> 
> 时间：2012-04-29T14:18:47.640
> 
> 标签：c#, sockets, stream, client-server, windows-runtime

我正在尝试使用套接字从我的桌面应用程序发送简单的字符串消息，这是将数据发送到客户端的**服务器端代码**：

```
 swSenderSender = new StreamWriter(tcpClients[i].GetStream());
    swSenderSender.WriteLine(From + " says: " + Message);
    swSenderSender.Flush();
    swSenderSender = null; 
```

我有 Metro 应用程序 -使用 DataReader**的客户端代码：**

```
 var dr = new DataReader(socket.InputStream);
    var stringHeader = await dr.LoadAsync(4);
    int strLength = dr.ReadInt32();
    uint numStrBytes = await dr.LoadAsync((uint)strLength);
    string msg = dr.ReadString(numStrBytes); 
```

这是问题所在。DataReader 需要知道发送的字符串有多长。另一方面，StreamWriter 不能与简单的字符串/或带有新通道的字符串不同。如何连接这两个代码？或者也许还有另一种方法可以做到这一点。请帮忙。我不知道如何格式化数据以便能够在客户端和服务器之间发送它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:38:31.480

在协议中解决这个问题的一般方法是把消息的长度放在第一位，在一个固定长度的字段中，比如长度 N。如果你永远不会在消息中接收超过 999 个字符，那么 N=3，对于例子。所以你的接收代码会转移到

```
receive N characters (or bytes, whatever).
decode N to get number of characters following, say M.
receive M characters.
repeat ad nauseam. 
```

# php - 如何使用php删除字符串中的最后一个逗号

> ID：10372810
> 
> 赞同：1
> 
> 时间：2012-04-29T14:19:10.393
> 
> 标签：php, string, explode

我是 PHP 新手

我想删除字符串的最后一个逗号，我该怎么做。这是我的代码：

```
<?php
$sub ="economic,maths,science";
$cap = explode(",",$sub);
foreach($cap as $new){
    echo ucfirst($new).",";
    }
?> 
```

任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T00:26:58.963

简单的修剪就足够了：

`$string = trim($string, " ,");`

请注意， trim() 函数的第二个参数允许您从字符串中修剪定义的字符，而不仅仅是空格。因此，在我的用法中定义了两个字符：空格字符“”和逗号“，”。

如果您想在没有循环的情况下将单词大写：

`$string = ucwords(trim($string, " ,"));`

注意：由于 ucwords() 函数会查找空格来定义单词边界，因此“apple,apple”不起作用但“apple,apple”会起作用，所以：

`$string = ucwords(str_replace(array(","," "),array(", "," "),trim($string, " ,")));`

is the best solution. (There are two spaces in the second element of first replacement array.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:22:51.587

```
<?php
$sub ="economic,maths,science";
$cap = explode(",",$sub);
$cap2 = array();
foreach($cap as $new){
    $cap2[] = ucfirst($new);
}
echo implode(",",$cap2)
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:24:40.677

```
$sub ="economic,maths,science";
var_dump(implode(',', array_map('ucfirst', explode(",", $sub)))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T14:25:41.607

这个适用于单词边界，而不仅仅是逗号：

```
preg_replace('~\b(\w+)\b~e', 'ucfirst("\\1")', "economic,maths,science"); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-29T14:22:59.407

您可以在没有这样的循环的情况下执行此操作：

```
$string = 'test, test, test';
$pos = strrpos($string, ',');

$string[$pos] = '';

echo $string; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-29T14:23:18.003

一个简单的正则表达式可以：

```
preg_replace('/,([^,])$/','\1',$str); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-04-29T14:20:46.773

```
<?php 
$sub = "economic,maths,science";
$cap = explode(",",$sub);
$count = count($cap);
$i = 1;     
foreach($cap as $newSub){
    if($count>$i){
        echo ucfirst($newSub).",";
    }else{
        echo ucfirst($newSub);
    }
    $i++;
}   
?> 
```

# lotus-notes - 使用动态视图面板

> ID：10372811
> 
> 赞同：3
> 
> 时间：2012-04-29T14:19:15.473
> 
> 标签：lotus-notes, xpages

我正在使用**动态视图面板**在单个**XPage**中显示各种视图。这导致了一些问题。首先，视图内的列样式设置不会显示在 XPage 上（例如：使列标题变粗）。更重要的是，虽然视图包含指向视图内文档的链接，但链接都附加了`action=editDocument`，我想将其更改为`action=openDocument`。但是，我找不到任何方法来更改此属性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-29T14:52:46.637

您需要为此使用定制器 bean，并将该 bean 的名称添加到`customizerBean`动态视图面板控件的属性中。

在定制器 bean 中，您可以控制样式，例如您要查找的内容，但您需要自己编写 Java bean 代码。Jesse Gallagher 创建了一个很好的扩展定制器 bean 示例，甚至将其放在 Github 上：[https](https://github.com/jesse-gallagher/Domino-One-Offs) ://github.com/jesse-gallagher/Domino-One-Offs 。

看看他关于这个主题的博客文章：

*   [这个动态视图定制器正在成形](http://frostillic.us/f.nsf/posts/this-dynamic-view-customizer-is-getting-into-shape)
*   [为我自己的目的增强 xe:dynamicViewPanel](http://frostillic.us/f.nsf/posts/enhancing-xedynamicviewpanel-for-my-own-purposes)

--

对于将 editDocument 更改为 openDocument 的特定问题，您可以使用以下自定义程序 bean 的小示例：

```
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import com.ibm.xsp.extlib.builder.ControlBuilder.IControl;
import com.ibm.xsp.extlib.component.dynamicview.DominoDynamicColumnBuilder.DominoViewCustomizer;
import com.ibm.xsp.extlib.component.dynamicview.UIDynamicViewPanel.DynamicColumn;
import com.ibm.xsp.extlib.component.dynamicview.ViewDesign.ColumnDef;

public class customizer extends DominoViewCustomizer{
  @Override
  public void afterCreateColumn(FacesContext context, int index, ColumnDef colDef, IControl column) {
    //Create a variable for the current component
    UIComponent columnComponent = column.getComponent();
    //Create a reference to the column and set the links to open in read mode
    DynamicColumn dynamicColumn = (DynamicColumn) columnComponent;
    dynamicColumn.setOpenDocAsReadonly(true);
    super.afterCreateColumn(context, index, colDef, column);
  }
} 
```

请记住将类添加到 faces-config.xml 以便能够将其用作 bean。

您可以使用 onColumnClick 事件而不是定制器 bean 来执行您自己的重定向。这是一个例子：

```
<xe:dynamicViewPanel value="#{viewdatasource}" id="dynamicViewPanel1" var="viewEntry" pageName="/page.xsp">     
    <xp:eventHandler event="onColumnClick" submit="true" refreshMode="complete">
        <xp:this.action><![CDATA[#{javascript:var url="/page.xsp?action=openDocument&documentId="+viewEntry.getNoteID();
context.redirectToPage(url);
}]]></xp:this.action>
    </xp:eventHandler>
</xe:dynamicViewPanel> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T09:21:20.530

如果您想使用其表单而不是使用 XPage 打开文档，那么您可以这样做，其中`rowData`var 是 ViewPanel

```
<xp:eventHandler event="onColumnClick" submit="true" refreshMode="complete" id="eventHandler1">
    <xp:this.action><![CDATA[#{javascript:if (!rowData.isCategory())
        var url = "0/"+rowData.getUniversalID()+"?OpenDocument"
        facesContext.getExternalContext().redirect(url);}]]>
    </xp:this.action>
</xp:eventHandler 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T10:53:21.327

在 SSJS 中，您可以通过添加以下内容来尝试文档中的链接：

context.redirectToPage(@ReplaceSubstring(context.getUrl().toString(),"editDocument","openDocument"));

# iphone - 字体颜色疑问

> ID：10372817
> 
> 赞同：1
> 
> 时间：2012-04-29T14:19:57.603
> 
> 标签：iphone, ios, nsstring, uicolor, core-text

我有这段代码可以在我的视图中设置一个 DB（sqlite）文本。我只是使用核心文本在视图中绘制文本..

NSMutableString *combined = [NSMutableString 字符串];

```
for(NSUInteger idx = 0; idx < [delegatee.allSelectedVerseEnglish count]; idx++) {
    [combined appendFormat:@"  %d %@", 
     idx + 1, 
     [delegatee.allSelectedVerseEnglish objectAtIndex:idx]];
}

self.multiPageView.text =combined; 
```

delegatee.allSelectedVerseEnglish 这是数组...在文本的每个句子之间我输入这样的数字 1 haii 这是 nipin 2 haii 这是堆栈溢出 3 等等等等 ..就像那样..我能够更改文本颜色所有文本中都包含数字..但我需要将“红色”颜色添加到数字中。如何更改上述代码中数字的颜色。这可能吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:29:14.090

您需要使用 an`NSMutableAttributedString`并使用[方法](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableAttributedString_Class/Reference/Reference.html)`NSForegroundColorAttributeName`设置值。[`setAttributes:range:`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableAttributedString_Class/Reference/Reference.html)

# php - PHP: mysql_query 及其连接说明

> ID：10372820
> 
> 赞同：3
> 
> 时间：2012-04-29T14:20:20.063
> 
> 标签：php, mysql, database-connection

我最近开始学习PHP，发现连接数据库的常用方法是：

```
// create connection to database
$connection = mysql_connect("localhost", "root", "password")
// Select database
$db_select = mysql_select_db("myDB", $connection);
// and finally the query..
$result = mysql_query("SELECT * FROM table", $connection); 
```

现在我的问题是，为什么我们必须在第三步使用 $connection ？！当我们使用“myDB”数据库时，我希望以这种方式编写第三步：

```
// and finally the query..
$result = mysql_query("SELECT * FROM table", $db_select); 
```

但似乎，这不是它在 php 中的做法。有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T15:59:52.187

该连接代表一个*数据库服务器会话*，它为您维护数据库状态。当前选定的数据库只是会话状态的一部分，因此通过传递*连接*，您也隐含地传递了当前选定的数据库（以及各种其他必要信息）。换句话说，*连接*比*选择的数据库*更通用。

（正如其他人已经指出的那样，当您的程序只需要访问单个服务器上的单个数据库时，没有必要显式传递连接。默认情况下，MySQL 将使用最近连接的会话。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T15:06:02.713

这不是必需的。但是，它非常有用。如果您连接到同一页面上的多个数据库，您可能希望同时使用它们。但是，如果您不指定哪个连接，它只会使用您成功连接的最后一个连接。

```
<?php
$forum = mysql_connect(...);
$users = mysql_connect(...);

$me = mysql_query("", $users);
$last_forum_post = mysql_query("", $forum);
?> 
```

但是，如果您只有一个连接，则无需将其放入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:38:51.350

功能说明

```
mysql_query ( string $query [, resource $link_identifier ] ) 
```

mysql_query()-> 向数据库发送查询（针对与指定链接标识符关联的服务器上当前活动的数据库）。

参数

*   查询 -> SQL 查询。

*   link_identifier -> 如果未指定连接标识符，则假定最后一个由 mysql_connect() 打开的链接。如果没有找到这样的链接，它将尝试创建一个，就好像 mysql_connect () 被调用时没有参数一样。如果未找到或建立连接，则会生成错误级别 E_WARNING 的确认。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-29T15:17:14.017

你拿`mysql_select_db()`错了。
这不是必需品。
没有这个功能你可以使用mysql。
这实际上只是`USE dbname`查询的别名。

此外，您可以在一个连接中同时使用 2 个或多个数据库。

因此，使用 DB 资源代替连接资源是没有意义的。

# java - 有没有办法让 Java 线程只在初始化时才做某事？

> ID：10372827
> 
> 赞同：0
> 
> 时间：2012-04-29T14:21:50.063
> 
> 标签：java, multithreading

抱歉，如果这是基本的，我只是看不到答案。基本上我正在使用 ThreadPoolExecutor 运行几个线程来启动 10 个线程。我希望每个线程在其生命周期内都与服务器建立自己的连接。有可能吗？如果可以，我应该把这段代码放在哪里？

示例代码：

```
class DoWork implements Runnable{

    protected String[] data = null; 

    public DoWork(String[] data) {
        // get the data each thread needs to work
        this.data = data;
    }

    public void run() {
        // Do the work here

    }

} 
```

我的理解是，如果工作队列中有项目，那么`ThreadPoolExecutor`保持 10 个线程处于活动状态，当工作完成时，它们就会死亡。在这个结构中的某个地方我可以添加连接信息吗？我不想在该`DoWork`方法中执行此操作，因为这将为每个工作单元完成（因此为工作队列中的尽可能多的项目打开连接，可能是数千个，并且在我尝试时会导致超时）。介于类声明和方法之间似乎没有做任何事情（尽管我可能做错了）。

关于如何做到这一点的任何想法？

更新：不是 100% 需要，但我很好奇是否还有办法让它在终止时执行某些操作（也许这样我可以关闭与服务器的连接而不是等待它超时）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T14:34:45.273

您可以使用 ThreadLocal 来存储每个线程的连接：

```
public class ConnectionProvider {
    private static final ThreadLocal<Connection> threadLocalConnection = 
         new ThreadLocal<Connection>() {
             @Override 
             protected Connection initialValue() {
                 // TODO create and return the connection
             }
         };

    public static Connection getConnection() {
        return threadLocalConnection.get();
    }
} 
```

或者，如果多个线程（在不同时间）可以使用连接，则可以创建一个连接池。run 方法将从池中获取一个连接（它将动态创建它并将其添加到已创建的连接集合中，如果没有可用的连接），并在它完成使用它时将其释放到池中（在 finally 块中）。这将使连接可用于任何其他任务。这将具有使所需连接的数量可能低于线程池中的线程数量的优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:39:32.330

创建自己的线程工厂，并将其作为参数传递给线程池构造函数。线程工厂创建的线程应覆盖方法 run()，如下所示：

```
public void run() {
  connectToServer();
  super.run();
} 
```

问题是，谁以及如何使用这些连接？如果您的意思是提供给线程池的每个作业都应该使用由它运行的线程创建的连接，那么将该连接保存为 ThreadLocal。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:42:57.650

改编自我在[CLI Processes 的 ThreadPool 的其他回答](https://stackoverflow.com/questions/10037379/threadpool-of-cli-processes/10082128#10082128)

这将创建一个连接池，您可以从中提取。这将防止每个线程的连接数上升和下降。但是，这仅在哪个线程使用哪个连接无关紧要时才有效。如果它确实重要，您必须调整此代码或使用其他人建议的 ThreadLocal 并在 Thread 死亡时挂钩。

当一个新的工作项排队时，线程会向连接池请求一个连接。如果一个不可用，它将创建一个新的。如果有一个可用，它将验证连接是否仍然有效，然后返回该对象。当工作项完成后，它可以将其返回到连接池。

```
public class StackOverflow_10037379_jdk6 {

    private static Logger sLogger = Logger.getLogger(StackOverflow_10372827_jdk6.class.getName());           

    public static class ConnectionPoolableObjectFactory extends BasePoolableObjectFactory<Connection> {

        public ConnectionPoolableObjectFactory() {

        }

        @Override
        public Connection makeObject() throws Exception {                
            Connection connection = // createConnection
            return connection;
        }

        @Override
        public boolean validateObject(Connection connection) {
            return connection.isValid();
        }

        @Override
        public void destroyObject(Connection connection) throws Exception {
            connection.close();
        }

        @Override
        public void passivateObject(Connection connection) throws Exception {

        }
    }

    public static class WorkItem implements Runnable {

        private ObjectPool<Connection> mPool;
        private String mWork;

        public CLIWorkItem(ObjectPool<Connection> pool, String work) {
            mPool = pool;
            mWork = work;
        }

        @Override
        public void run() {
            Connection connection = null;
            try {
                connection = mPool.borrowObject();
                // do stuff with connection
            } catch (Exception ex) {
                sLogger.log(Level.SEVERE, null, ex);
            } finally {
                if (connection != null) {
                    try {
                        // Seriously.. so many exceptions.
                        mPool.returnObject(connection );
                    } catch (Exception ex) {
                        sLogger.log(Level.SEVERE, null, ex);
                    }
                }
            }
        }
    }

    public static void main(String[] args) throws Exception {

        // Change the 5 to 20 in your case. 
        ObjectPool<Connection> pool =
                new GenericObjectPool<Connection>(
                new ConnectionPoolableObjectFactory(), 5);

        BlockingQueue<Runnable> queue = new ArrayBlockingQueue<Runnable>(100, true);

        ThreadPoolExecutor executor = new ThreadPoolExecutor(20, 20, 1, TimeUnit.HOURS, queue);

        // print some stuff out.
        executor.execute(new WorkItem(pool, "Message 1\r\n"));
        executor.execute(new WorkItem(pool, "Message 2\r\n"));
        executor.execute(new WorkItem(pool, "Message 3\r\n"));
        executor.execute(new WorkItem(pool, "Message 4\r\n"));
        executor.execute(new WorkItem(pool, "Message 5\r\n"));
        executor.execute(new WorkItem(pool, "Message 6\r\n"));
        executor.execute(new WorkItem(pool, "Message 7\r\n"));
        executor.execute(new WorkItem(pool, "Message 8\r\n"));
        executor.execute(new WorkItem(pool, "Message 9\r\n"));
        executor.execute(new WorkItem(pool, "Message 10\r\n"));
        executor.execute(new WorkItem(pool, "Message 11\r\n"));

        executor.shutdown();
        executor.awaitTermination(4000, TimeUnit.HOURS);

        pool.close();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-29T14:43:43.803

使用连接池不是更容易吗？然后，每个任务将在启动时简单地从池中检索一个连接，并在完成时返回它。这样，您就不必创建比线程更多的连接，并且您可以在所有任务完成后轻松销毁连接池（及其所有连接）。

# android - Android 上下文菜单不再出现在模拟器中

> ID：10372831
> 
> 赞同：1
> 
> 时间：2012-04-29T14:22:11.280
> 
> 标签：android, eclipse, contextmenu

我正在构建一个使用数据库列表中的上下文菜单的 Android 应用程序。我一切正常，继续构建使用地图的应用程序部分，现在（当我切换到 10 级 android 谷歌模拟器时）我遇到了两个问题。第一个修复得足够快，但我的上下文菜单不再出现。我不知道这是否与模拟器中的更改有关，但这是我的代码：

在 onCreate 我们有：

```
super.onCreate(savedInstanceState);

datasource = new DiaryDataSource(this);
datasource.open();

List<DiaryEntry> values = datasource.getAllDiaryEntries();

DiaryScheduleAdapter adapter = new DiaryScheduleAdapter(this,values);
setListAdapter(adapter);

registerForContextMenu(getListView()); 
```

然后在我扩展 ArrayAdapter 的类中，我们有：

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) 
    {
        DiaryEntry diaryEntry = getItem(position);

        View v = convertView;
        if ( v == null ) 
        {
            v = li.inflate(R.layout.diary_schedule, null);
        }

**** TextViews etc ****

        v.setOnClickListener(new OnItemClickListener(position));

        return v; 
```

然后是 onCreateContextMenu：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) 
{
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.diary_context_menu, menu);
} 
```

另外，对于普通的点击监听器，我使用这个：

```
private class OnItemClickListener implements OnClickListener
{           
    private int mPosition;

    OnItemClickListener(int position)
    {
        mPosition = position;
    }

    @Override
    public void onClick(View v) 
    {
        **** various bits of code to set up intent ****

        startActivity(descIntent);
    }               
} 
```

然后是下面的 onContextItemSelected 方法，但我没有那么远。同样，我确定我没有对代码进行任何更改，但是长按现在什么也没做。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T16:10:21.853

**重写**（有时我不应该尝试在 IDE 之外编写代码）

这是我想说的一个简单的例子：

```
public class ExampleActivity extends ListActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        List<String> list = new ArrayList<String>();
        list.add("Shoes");
        list.add("Socks");
        list.add("Sandals");

        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, list);
        setListAdapter(adapter);

        ListView listView = (ListView) findViewById(android.R.id.list);
        registerForContextMenu(listView);
    }   

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {
        Log.v("Main", "Create Menu");
    }

    protected void onListItemClick (ListView l, View v, int position, long id) {
        Log.v("Main", "Item Click");
    }
} 
```

听起来您希望上下文菜单特定于每一行，在这种情况下，我会使用`menuInfo`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T10:30:40.533

解决方案是将下面的代码行添加到我的 getView 方法中：

```
convertView.setLongClickable(true); 
```

再次感谢 Sam 提供了很多有用的输入

# javascript - 使用 javascript 或 jquery 从 php 页面加载数据？

> ID：10372833
> 
> 赞同：0
> 
> 时间：2012-04-29T14:22:12.793
> 
> 标签：javascript, jquery, xmlhttprequest

大师和其他人的，如果有人可以帮助我的话。

**场景：** 每次调用时，以下页面都会返回唯一的文本字符串。 [http://projects.tk-fn.com/controls/advance_file_uploader/unique_id.php](http://projects.tk-fn.com/controls/advance_file_uploader/unique_id.php)

我想从 HTML 页面调用此页面，然后将此字符串加载到容器 div 中。

我把整个周末都浪费在这上面，但无法正常工作。请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:25:45.950

如果它在不同的域中，则不能使用 Ajax 请求 :) 但是...您可能可以起诉 iframe！

```
<iframe src="http://projects.tk-fn.com/controls/advance_file_uploader/unique_id.php"></iframe> 
```

你甚至可以在这里尝试一下！只需打开控制台并输入

```
$("body").html("<iframe src=\"http://projects.tk-fn.com/controls/advance_file_uploader/unique_id.php\"></iframe>"); 
```

干杯!

# html - HTML/CSS 问题 - 宽度：100% 未扩展

> ID：10372834
> 
> 赞同：1
> 
> 时间：2012-04-29T14:22:18.697
> 
> 标签：html, css

这是[jsFiddle](http://jsfiddle.net/qkp9w/1/)的链接。请注意，锚 (#nav>li>a) 并没有像它所说的那样扩展：

```
#nav li a {
    width: 100%;
    height: 100%;
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T14:28:10.870

您必须制作`<a>`一个块元素并为其父元素提供一些宽度

```
#nav {
  width: 100%;
  overflow: hidden;
}
#nav li {
  float: left;
  height: 40px;
  padding-left: 7px;
  padding-right: 7px;
  padding-top: 5px;
  width: 100%;
}
#nav li a {
  width: 100%;
  height: 100%;
  display: block
}
#nav li a:hover {
  background: #0ff;
}
```

```
<ul id="nav" class="top">
  <li><a href="">Home</a></li>
  <li><a href=""><img src="" alt=""></a></li>
  <li><a href=""><img src="" alt=""></a></li>
  <li><a href=""><img src="" alt=""></a></li>
</ul>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:29:41.017

[http://jsfiddle.net/qkp9w/21/](http://jsfiddle.net/qkp9w/21/)这是你想要的吗？

# json - 从 URL（地理编码 API）初始化 JSON 对象的最简单（或至少一种功能）方法

> ID：10372846
> 
> 赞同：0
> 
> 时间：2012-04-29T14:23:29.533
> 
> 标签：json, google-maps, google-geocoding-api

我试图在我的 javascript 代码中针对 Geocoding API 进行地理编码。我得到定义的 url `var url = "http://http://maps.googleapis.com/maps/api/geocode/json?address=New York, Manhattan&sensor=false"` ，我需要从中检索 JSON 对象。我使用的第一种方法是根据维基百科使用这样的 XmlHttpRequest

```
var my_JSON_object = {};
var http_request = new XMLHttpRequest();
http_request.open("GET", url, true);
http_request.onreadystatechange = function () {
  var done = 4, ok = 200;
  if (http_request.readyState == done && http_request.status == ok) {
       my_JSON_object = JSON.parse(http_request.responseText);
  }
}; 
```

在触发 open() 函数后，我运行代码并在调试器中获得这样的输出：

```
http_request: XMLHttpRequest
onabort: null
onerror: null
onload: null
onloadend: null
onloadstart: null
onprogress: null
onreadystatechange: function () {
readyState: 1
response: ""
responseText: ""
responseType: ""
responseXML: null
status: [Exception: DOMException]
statusText: [Exception: DOMException]
upload: XMLHttpRequestUpload
withCredentials: false
__proto__: XMLHttpRequest 
```

这意味着显然没有发生任何真正有用的事情。我的第二种方法是由于 json.org，我尝试使用 JSONRequest 进行调用

```
var requestNumber = JSONRequest.get(
url, 
function (requestNumber, value, exception) {
    if (value) {
        document.write(value);
    } else {
        document.write(exception);
    }
} 
```

调试器告诉我 JSONRequest 没有定义！由于 json.org 它的原生 JS 对象，所以有什么问题？请注意，我在附近的脚本中使用了从谷歌正确获得的 API 密钥。

解释我的解决方案失败的原因以及如何遵守此任务的任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T00:50:29.443

我读到了诸如[跨域 XHR](https://stackoverflow.com/a/10375929/1325290)和[Apache/HTTP 代理](https://stackoverflow.com/a/2921970/1325290)之类的黑客攻击，但结论是[Javascript API V3 地理编码](https://developers.google.com/maps/documentation/javascript/geocoding)是您唯一现实的选择。此评论[（来自此处）](https://stackoverflow.com/questions/5281039/jquery-wont-get-json)虽然不具有权威性，但表明此类 JSON 请求不再起作用：

> 人们会合理地期望 google maps api 允许跨域访问，直到最近它才这样做。现在它不再允许了；我猜他们声称出于安全原因，但我也猜想真正的原因是迫使您仅使用他们的代码来获得他们的服务。因此，通过 javascript 从客户端获取数据的唯一方法是使用 Google 的 javascript api，无论如何，它为您提供与直接调用 api url 几乎相同的灵活性。

[这个问题](https://stackoverflow.com/questions/2921745/how-to-make-cross-domain-ajax-calls-to-google-maps-api)有最有用的信息。

# android - 在 Android 中创建滑入/滑出部分隐藏的工具栏

> ID：10372851
> 
> 赞同：1
> 
> 时间：2012-04-29T14:24:26.160
> 
> 标签：android, android-layout

我需要一些帮助来查找有关如何创建在“主要活动视图”上滑入/滑出的视图的示例或描述。

到目前为止，我还没有在任何应用程序中看到这一点，所以我尝试使用图像来描述它：http: [//imgur.com/wVvO7](http://imgur.com/wVvO7)

主要思想是它应该只在关闭时部分隐藏，因此通过触摸可见的“旋钮”，工具栏滑出再次完全可见。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:38:26.170

最近你会得到一个滑动抽屉（非常接近）。

[看这里](http://developer.android.com/reference/android/widget/SlidingDrawer.html)

做一些关于它的阅读，似乎你可以让它从底部向上滑动或从左边缘滑出。还没有遇到任何可以让你让它从顶部掉下来或从右边缘出来的信息......

# git - ToolTwist 控制器不会从 github 下载分支

> ID：10372852
> 
> 赞同：2
> 
> 时间：2012-04-29T14:24:30.363
> 
> 标签：git, tooltwist

在为控制器定义一个新的扩展项目后，我有两个问题：

1.  在构建阶段，它会要求输入密码，这会导致它失败，因为它不是交互式的（从 Jenkins 运行）。

2.  如果我从命令行运行construct.xml 并手动输入用户名和密码，它似乎工作正常，但只从github 获取主分支。

无论哪种方式，构造阶段都会结束，并且控制器无法部署到 Web 服务器。在控制器配置中我还需要做些什么来使其工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T15:12:47.767

首先是密码问题：

检查您是否设置了 ssh 密钥（请参阅[http://help.github.com/mac-set-up-git/](http://help.github.com/mac-set-up-git/)和[http://help.github.com/linux-set-up-git/](http://help.github.com/linux-set-up-git/)）？您可以使用以下命令检查 SSH 是否正确设置：

> $ ssh -T git@github.com
> 你好，善变！您已成功通过身份验证，但 GitHub 不提供 shell 访问权限。

接下来，如果 ssh 没问题并且您仍然遇到您描述的问题，请检查您用于远程的 url：

> $ git remote -v
> origin git@github.com:acountname/repo.git (fetch)
> origin git@github.com:acountname/repo.git (push)

请注意，您应该使用 git 协议，而不是 https。如果错误，您可以在 Controller 配置中输入正确的 URL 并运行构建，或者从命令行可以使用以下命令更改它：

```
$ git config remote.origin.url git@github.com:accountname/repo.git 
```

在内部，控制器使用“git fetch --all”。出于某种原因，这在使用 https 协议时不会获取所有分支，但 ssh 协议会。

# magento - Magento W3C 和 ADDTHIS 和 OGP 标签（生成错误）

> ID：10372853
> 
> 赞同：1
> 
> 时间：2012-04-29T14:24:34.057
> 
> 标签：magento, w3c-validation

关于如何修复所有 ADDTHIS 和 OGP 标签错误的任何建议：

[http://validator.w3.org/check?uri=http://shirtsofholland.com](http://validator.w3.org/check?uri=http://shirtsofholland.com)

我们可以做什么/改变以使页面消除这些错误？文档类型？

我将标题更改为（基于以下信息和其他链接）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
xml:lang="<?php echo $this->getLang() ?>" 
xmlns:addthis="http://www.addthis.com/help/api-spec"
xmlns:og="http://opengraphprotocol.org/schema/"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:36:55.287

这应该可以通过将 DTD 模式添加到 xhtml 中的 html 标记来解决。

```
<html 
xmlns="http://www.w3.org/1999/xhtml"
xmlns:addthis="http://www.addthis.com/help/api-spec"
xmlns:og="http://opengraphprotocol.org/schema/"> 
```

在 Magento 中更改这一点的模板在`[magento]/app/design/frontend/default/[your theme]/templates/page[s]/`我的脑海中。它们通常在基本 html 中定义为 1 列、2 列和 3 列布局。

我想指出，Magento 在这里的标准有点落后，出于 SEO 的原因，验证内容并不是最重要的事情，并且试图将 Magento 模板打造成单调乏味并且需要做很多工作。尝试修复可修复的问题，但绝对不是所有问题。

**此特定布局的其他问题：**

您正在使用`data-*`仅在 html 5 中有效的属性，因此`<!doctype html>`如果您想使用它们，您应该使用 html5 文档类型。

您正在使用 xhtml 中不允许的属性，例如 iframe 上的 frameborder 和表格上的 height/width 属性。

url 中哈希 (#) 后面的值需要进行 urlencoded/escaped，因此将使用 & 符号`%26`。否则他们会在验证器中抛出一个错误。

**TinyMCE 问题：**

您遇到的其他错误与我上面概述的要点或 tinyMCE 的工作原理（Magento 后端的文本编辑器）有关。

TinyMCE 尝试将段落元素包裹在几乎所有内容中，这主要是因为如果浏览器没有任何上下文，则 contenteditable 属性在某些浏览器中不起作用。

tinymce 的问题是根深蒂固的问题，只能通过覆盖 Magento 中的默认 tinymce 配置并使用以下教程中的步骤进行自己的实现来解决：

[http://www.gethifi.com/blog/how-to-produce-xhtml-10-strict-markup-with-tinymce](http://www.gethifi.com/blog/how-to-produce-xhtml-10-strict-markup-with-tinymce)

**有关 Addthis 验证的更多信息：**

[http://support.addthis.com/customer/portal/articles/381263-addthis-client-api-#valid-xhtml](http://support.addthis.com/customer/portal/articles/381263-addthis-client-api-#valid-xhtml)

**有关 opengraph 验证的更多信息：**

[Facebook 开放图元标签和有效 html](https://stackoverflow.com/questions/3959997/facebook-open-graph-meta-tags-valid-html)

# java - 将文档添加到多个文件夹（集合）

> ID：10372855
> 
> 赞同：0
> 
> 时间：2012-04-29T14:24:42.207
> 
> 标签：java, google-docs-api

我可以使用 Java API 在文件夹/集合中插入 Google 文档。但我想将此文档放在多个文件夹中。方法

```
public void addFolder(Person owner, java.lang.String folderName) 
```

已弃用。在 javadoc 中，它指的是：`BaseEntry.addLink(Link)`. 我尝试使用该方法如下：

```
docEntry.addLink(DocumentListLink.Rel.PARENT, Link.Type.ATOM,
        folderEntry.getSelfLink().getHref()); 
```

这个方法不行，可能是我用错了参数。那么如何将文档链接到多个文件夹/集合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T14:51:35.043

在这里找到它：http: [//gdata-java-client.googlecode.com/svn/trunk/java/sample/docs/DocumentList.java](http://gdata-java-client.googlecode.com/svn/trunk/java/sample/docs/DocumentList.java)

使用以下方法中的代码将文档两次插入到不同的集合中。我仍然很好奇为什么 addlink 方法对我来说失败了。

```
 public DocumentListEntry moveObjectToFolder(String resourceId, String folderId)
      throws IOException, MalformedURLException, ServiceException, DocumentListException {
    if (resourceId == null || folderId == null) {
      throw new DocumentListException("null passed in for required parameters");
    }

    DocumentListEntry doc = new DocumentListEntry();
    doc.setId(buildUrl(URL_DEFAULT + URL_DOCLIST_FEED + "/" + resourceId).toString());

    URL url = buildUrl(URL_DEFAULT + URL_DOCLIST_FEED + "/" + folderId + URL_FOLDERS);
    return service.insert(url, doc);
  } 
```

# ruby-on-rails-3 - JRuby 和 Neo4j 脚手架生成错误 (OS X)

> ID：10372856
> 
> 赞同：0
> 
> 时间：2012-04-29T14:24:48.573
> 
> 标签：ruby-on-rails-3, jruby, neo4j, jrubyonrails

我正在关注 Rails 和 Neo4j 教程[http://blog.jayway.com/2011/03/02/neo4j-rb-1-0-0-and-rails-3/](http://blog.jayway.com/2011/03/02/neo4j-rb-1-0-0-and-rails-3/)并收到以下错误：

```
me$ rails generate scaffold post title:string body:string
LoadError: no such file to load -- active_support/core_ext/class/inheritable_attributes
  require at org/jruby/RubyKernel.java:1038
   (root) at /Users/me/.rvm/gems/jruby-1.6.5/gems/neo4j-1.3.1-java/lib/neo4j.rb:9
  require at org/jruby/RubyKernel.java:1038
   (root) at /Users/me/.rvm/gems/jruby-1.6.5/gems/neo4j-1.3.1-java/lib/neo4j.rb:8
  require at org/jruby/RubyKernel.java:1038
   (root) at /Users/me/Projects/myblog/config/application.rb:24
  require at org/jruby/RubyKernel.java:1038
   (root) at script/rails:6 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:20:12.760

您可能正在使用 Neo4j.rb 的 1.x 版本，它不适用于 rails 3.2+。使用 rails 3.1 或使用 neo4j.rb 版本 2.0.0.alpha.9+ 另外，使用 2.0.0.alpha.9 和脚手架检查演示应用程序 - [https://github.com/andreasronge/kvitter](https://github.com/andreasronge/kvitter)

# java - 创建具有名称的 bean 时出错

> ID：10372859
> 
> 赞同：38
> 
> 时间：2012-04-29T14:25:04.350
> 
> 标签：java, spring

我将 SpringMVC 用于 Web 应用程序以及为 Hibernate 注入我的 sessionFactory。

当我运行我的应用程序时，我收到以下错误...

```
Apr 29, 2012 3:18:05 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /usr/bin/jdk1.7.0_03/jre/lib/amd64/server:/usr/bin/jdk1.7.0_03/jre/lib/amd64:/usr/bin/jdk1.7.0_03/jre/../lib/amd64:/usr/lib/jvm/java-6-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-6-openjdk/jre/lib/amd64:/usr/lib/jvm/java-6-openjdk/jre/../lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
Apr 29, 2012 3:18:05 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.j2ee.server:spring-security-integration' did not find a matching property.
Apr 29, 2012 3:18:05 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:Spring3Hibernate' did not find a matching property.
Apr 29, 2012 3:18:05 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:assessment' did not find a matching property.
Apr 29, 2012 3:18:05 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Apr 29, 2012 3:18:05 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Apr 29, 2012 3:18:05 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 1234 ms
Apr 29, 2012 3:18:05 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Apr 29, 2012 3:18:05 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.26
Apr 29, 2012 3:18:06 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization started
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Sun Apr 29 15:18:06 BST 2012]; root of context hierarchy
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/root-context.xml]
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@64f995bd: defining beans []; root of factory hierarchy
INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization completed in 282 ms
Apr 29, 2012 3:18:07 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring FrameworkServlet 'appServlet'
INFO : org.springframework.web.servlet.DispatcherServlet - FrameworkServlet 'appServlet': initialization started
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing WebApplicationContext for namespace 'appServlet-servlet': startup date [Sun Apr 29 15:18:07 BST 2012]; parent: Root WebApplicationContext
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/appServlet/servlet-context.xml]
INFO : org.springframework.context.annotation.ClassPathBeanDefinitionScanner - JSR-330 'javax.inject.Named' annotation found and supported for component scanning
INFO : org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@5b969921: defining beans [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.resource.ResourceHttpRequestHandler#0,org.springframework.web.servlet.handler.SimpleUrlHandlerMapping#0,org.springframework.web.servlet.view.InternalResourceViewResolver#0,dataSource,sessionFactory,homeController,userManagementController,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,org.springframework.web.servlet.view.ContentNegotiatingViewResolver#0,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@64f995bd
INFO : org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped "{[/],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.String org.assessme.com.controller.HomeController.home(java.util.Locale,org.springframework.ui.Model)
INFO : org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped "{[/userManagement/getUser],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.assessme.com.entity.User org.assessme.com.controller.UserManagementController.data(java.util.Locale,org.springframework.ui.Model)
INFO : org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped "{[/userManagement/],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.Object org.assessme.com.controller.UserManagementController.home(java.util.Locale,org.springframework.ui.Model)
INFO : org.springframework.web.servlet.handler.SimpleUrlHandlerMapping - Mapped URL path [/resources/**] onto handler 'org.springframework.web.servlet.resource.ResourceHttpRequestHandler#0'
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@5b969921: defining beans [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.resource.ResourceHttpRequestHandler#0,org.springframework.web.servlet.handler.SimpleUrlHandlerMapping#0,org.springframework.web.servlet.view.InternalResourceViewResolver#0,dataSource,sessionFactory,homeController,userManagementController,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,org.springframework.web.servlet.view.ContentNegotiatingViewResolver#0,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@64f995bd
ERROR: org.springframework.web.servlet.DispatcherServlet - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userManagementController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.assessme.com.service.UserService org.assessme.com.controller.UserManagementController.userService; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.assessme.com.service.UserService] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5015)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.assessme.com.service.UserService org.assessme.com.controller.UserManagementController.userService; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.assessme.com.service.UserService] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 30 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.assessme.com.service.UserService] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:924)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:793)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 32 more 
```

我不确定为什么 autoInject 不起作用。我已将所有 XML 配置放入 servlet-context...

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing 
        infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving 
        up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources 
        in the /WEB-INF/views directory -->
    <beans:bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

    <beans:bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close">
        <beans:property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <beans:property name="url" value="jdbc:mysql://localhost/assessme" />
        <beans:property name="username" value="assessme" />
        <beans:property name="password" value="assessme" />
    </beans:bean>

     <beans:bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <beans:property name="annotatedClasses">
        <beans:list>
            <beans:value>org.assessme.com.entity.User</beans:value>
        </beans:list>
    </beans:property>
        <beans:property name="dataSource" ref="dataSource" />
        <beans:property name="packagesToScan" value="org.assessme.com.controller.entity" />
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</beans:prop>
                <beans:prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory</beans:prop>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
                <beans:prop key="hibernate.hbm2ddl.auto">update</beans:prop>
            </beans:props>
        </beans:property>
    </beans:bean>

    <context:component-scan base-package="org.assessme.com.controller." />

    <beans:bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <beans:property name="mediaTypes">
            <beans:map>
                <beans:entry key="html" value="text/html" />
                <beans:entry key="json" value="application/json" />
            </beans:map>
        </beans:property>
        <beans:property name="defaultViews">
            <beans:list>
                <beans:bean
                    class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                    <beans:property name="prefixJson" value="true" />
                </beans:bean>
            </beans:list>
        </beans:property>
    </beans:bean>

</beans:beans> 
```

userManagementController 的代码是...

```
import java.text.DateFormat;
import java.util.Date;
import java.util.Locale;

import org.assessme.com.dao.UserDaoImpl;
import org.assessme.com.entity.User;
import org.assessme.com.service.UserService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
@RequestMapping(value = "/userManagement")
public class UserManagementController {

    private static final Logger logger = LoggerFactory
            .getLogger(HomeController.class);

    @Autowired
    private UserService userService;

    /**
     * Simply selects the home view to render by returning its name.
     */
    @RequestMapping(value = "/", method = RequestMethod.GET)
    public Object home(Locale locale, Model model) {

        logger.info("User management view controller loaded...");

        return "userManagement";
    }

    @RequestMapping(value = "/getUser", method = RequestMethod.GET)
    @ResponseBody
    public User data(Locale locale, Model model) {
        logger.info("getUser controller loaded...");
        User user = userService.getById(1L);
        System.out.println("firstName is " + user.getFirstName());
        return user;

    }

} 
```

userService 是 userService.java ...

```
import org.assessme.com.entity.User;

public interface UserService {
    public User getById(Long id);
} 
```

由...使用

```
@Service("userService")
@Transactional(propagation = Propagation.SUPPORTS, readOnly = true)
public class UserServiceImpl implements UserService {

    @Autowired
    private UserDao userDao;

    public UserServiceImpl() {
    }

    @Transactional(propagation = Propagation.REQUIRED, readOnly = true)
    public User getById(Long id) {
        return userDao.getById(id);
    }

} 
```

任何人都可以给我任何指示吗？有什么我需要添加到我的 XML 中的吗？我正在处理关于...的教程

[http://www.roseindia.net/tutorial/spring/spring3/web/spring-3-mvc-and-hibernate3-example-part3.html](http://www.roseindia.net/tutorial/spring/spring3/web/spring-3-mvc-and-hibernate3-example-part3.html)

而且我不明白他们是如何自动接线的

```
@Autowired
    private ArticleService articleService; 
```

在 ArticleController.java 中

谢谢，

大卫

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-29T14:33:51.353

我认为它来自您的 XML 文件中的这一行：

```
<context:component-scan base-package="org.assessme.com.controller." /> 
```

将其替换为：

```
<context:component-scan base-package="org.assessme.com." /> 
```

这是因为您的 Autowired 服务没有被 Spring 扫描，因为它不在正确的包中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-29T14:34:00.090

看起来您的 Spring 组件扫描 Base 缺少 UserServiceImpl

```
<context:component-scan base-package="org.assessme.com.controller." /> 
```

# android - Android l10n / i18n 数据库。表 android_metadata 是为此而设计的吗？

> ID：10372860
> 
> 赞同：1
> 
> 时间：2012-04-29T14:25:05.523
> 
> 标签：android

我正在尝试按照教程使用以前创建的数据库：

[http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

我计划使用数据库来存储类似琐事的游戏的问题。以一张桌子的基本设计：

```
CREATE TABLE QUESTIONS (
 answer TEXT,             --text for answer
 create_by_user NUMERIC,  --boolean flag, true if question created by user
 _id INTEGER PRIMARY KEY, --required by Android
 l10n TEXT,               --ISO 3-letter code for localization
 question TEXT            --text for question
); 
```

并将字段 l10n 用于 l10n/i18n 目的，但我不确定 Android 如何使用`android_metadata`表。在教程中插入了一行带有“en_US”值的行，

1.  这个表是 Android 使用的一种内置 l10n 吗？
2.  建议将表 android_metadata 用于 l10n 而不是我自己的 l10n 字段？
3.  如果我希望数据库存储不同语言的数据并为用户提供从不同语言检索问题的选项怎么办？
4.  每种语言都需要一个数据库还是更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:36:46.283

每次您将数据库打开到当前默认语言环境时，Android 都会更新该字段。除非您更改应用程序中的默认设置，否则这应该是系统语言。

[SQLiteDatabase#openDatabase](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/database/sqlite/SQLiteDatabase.java#1012)

```
db.setLocale(Locale.getDefault()); 
```

使用该字段应该可以保存，但我从未测试过它。

该表的目的是 AFAIK，以允许您在语句中使用[COLLATE LOCALIZED](https://stackoverflow.com/questions/3480999/using-collate-in-android-sqlite-locales-is-ignored-in-like-statement) - 如果您指定[NO_LOCALIZED_COLLATORS 则不使用](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#NO_LOCALIZED_COLLATORS)

如果您想拥有不同语言的文本数据库，请考虑使用您自己的语言表作为文本表的外键。

# java - Java String 删除所有非数字字符但保留小数分隔符

> ID：10372862
> 
> 赞同：281
> 
> 时间：2012-04-29T14:25:26.420
> 
> 标签：java, string, character, decimal

尝试删除所有不是 0-9 和句点的字母和字符。我正在使用`Character.isDigit()`，但它也删除了小数，我怎样才能保留小数？

* * *

## 回答 #1

> 赞同：586
> 
> 时间：2012-04-29T14:30:25.180

试试这个代码：

```
String str = "a12.334tyz.78x";
str = str.replaceAll("[^\\d.]", ""); 
```

现在`str`将包含`"12.334.78"`.

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2012-04-29T14:31:29.147

我会使用正则表达式。

```
String text = "-jaskdh2367sd.27askjdfh23";
String digits = text.replaceAll("[^0-9.]", "");
System.out.println(digits); 
```

印刷

```
2367.2723 
```

您可能也希望保留`-`负数。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2015-02-24T12:53:46.330

# 解决方案

## 带破折号

```
String phoneNumberstr = "Tel: 00971-557890-999";
String numberRefined = phoneNumberstr.replaceAll("[^\\d-]", ""); 
```

结果：`0097-557890-999`。

## 没有破折号

如果您也不需要字符串中的“-”，您可以这样做：

```
String phoneNumberstr = "Tel: 00971-55 7890 999";      
String numberRefined = phoneNumberstr.replaceAll("[^0-9]", ""); 
```

结果：`0097557890999`。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-04-29T14:33:42.030

用番石榴：

```
String input = "abx123.5";
String result = CharMatcher.inRange('0', '9').or(CharMatcher.is('.')).retainFrom(input); 
```

见[http://code.google.com/p/guava-libraries/wiki/StringsExplained](http://code.google.com/p/guava-libraries/wiki/StringsExplained)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2017-03-27T13:59:55.620

```
str = str.replaceAll("\\D+",""); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-05-25T12:40:02.823

**不使用正则表达式的简单方法：**

为点添加额外的字符检查`'.'`将解决要求：

```
public static String getOnlyNumerics(String str) {
    if (str == null) {
        return null;
    }
    StringBuffer strBuff = new StringBuffer();
    char c;
    for (int i = 0; i < str.length() ; i++) {
        c = str.charAt(i);
        if (Character.isDigit(c) || c == '.') {
            strBuff.append(c);
        }
    }
    return strBuff.toString();
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-15T17:41:43.100

对于来这里使用 Kotlin 的 Android 人

```
val dirtyString = " Account Balance: $-12,345.67"
val cleanString = dirtyString.replace("[^\\d.]".toRegex(), "") 
```

**输出：**

```
cleanString = "12345.67" 
```

* * *

*然后可以安全地转换它`toDouble()`，`toFloat()`或者`toInt()`如果需要*

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-11-09T20:31:31.640

货币小数点分隔符可以与区域设置不同。`.`始终将其视为分隔符可能很危险。IE

```
╔════════════════╦═══════════════════╗
║    Locale      ║      Sample       ║
╠════════════════╬═══════════════════╣
║ USA            ║ $1,222,333.44 USD ║
║ United Kingdom ║ £1.222.333,44 GBP ║
║ European       ║ €1.333.333,44 EUR ║
╚════════════════╩═══════════════════╝ 
```

我认为正确的方法是：

*   `DecimalFormatSymbols`通过默认的 Locale 或指定的一个获取十进制字符。
*   用十进制字符烹制正则表达式模式，以便仅获取数字

在这里我是如何解决它的：

代码：

```
import java.text.DecimalFormatSymbols;
import java.util.Locale;

    public static String getDigit(String quote, Locale locale) {
    char decimalSeparator;
    if (locale == null) {
        decimalSeparator = new DecimalFormatSymbols().getDecimalSeparator();
    } else {
        decimalSeparator = new DecimalFormatSymbols(locale).getDecimalSeparator();
    }

    String regex = "[^0-9" + decimalSeparator + "]";
    String valueOnlyDigit = quote.replaceAll(regex, "");
    try {
        return valueOnlyDigit;
    } catch (ArithmeticException | NumberFormatException e) {
        Log.e(TAG, "Error in getMoneyAsDecimal", e);
        return null;
    }
    return null;
} 
```

我希望这可能会有所帮助，'。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-11-15T20:14:12.383

一种用 java 8 流替换它的方法：

```
public static void main(String[] args) throws IOException
{
    String test = "ab19198zxncvl1308j10923.";
    StringBuilder result = new StringBuilder();

    test.chars().mapToObj( i-> (char)i ).filter( c -> Character.isDigit(c) || c == '.' ).forEach( c -> result.append(c) );

    System.out.println( result ); //returns 19198.130810923.
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-04-01T21:25:23.680

这处理空输入、负数和小数（您需要在项目中包含 Apache Commons Lang 库，版本 3.8 或更高版本）：

```
import org.apache.commons.lang3.RegExUtils;
result = RegExUtils.removeAll(input, "-?[^\\d.]"); 
```

库参考：[https ://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/RegExUtils.html](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/RegExUtils.html)

# javascript - Javascript - 查找对象的容器

> ID：10372868
> 
> 赞同：1
> 
> 时间：2012-04-29T14:26:08.287
> 
> 标签：javascript

如果我创建一个对象

```
var O = { A : {}, B : {}} 
```

然后我设置

```
O.A.foo = function() { }
O.B.foo = function() { } 
```

如何`foo()`找出它的父母是`A`or `B`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T14:29:40.637

[`this`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)是关键：

```
O.A.foo = O.B.foo = function() {
    if (this === O.A) {
        // it's A
    }
    else if (this === O.B) {
        // it's B
    }
} 
```

[http://jsfiddle.net/mattball/2nhnH/](http://jsfiddle.net/mattball/2nhnH/)

* * *

然而，这似乎有点代码味道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T15:19:12.393

也许您的问题还有更多，因为答案是函数已经知道，因为它们是单独的函数。

```
O.A.foo = function() { /* this is called on A */ }
O.B.foo = function() { /* this is called on B */ } 
```

# c - 如果 % 在 printf 的格式字符串中没有后跟合适的字符怎么办？

> ID：10372870
> 
> 赞同：1
> 
> 时间：2012-04-29T14:26:28.187
> 
> 标签：c, printf

我正在尝试编写一个名为 error 的函数，它的行为类似于 printf，但仅支持 %s、%c 和 %d 说明符。但是如果 % 后面没有合法字符，我无法理解 printf 的行为。我还尝试循环 c99 标准手册，但找不到任何东西。有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-29T14:35:56.567

C99 在 §7.19.6.1/9 中有这个（对于`fprintf`）：

> 如果转换规范无效，则行为未定义。

因此，格式错误的格式字符串会导致未定义的行为。

如果格式字符串格式正确但参数实际上与类型不匹配，则相同：

> 如果任何参数不是相应转换规范的正确类型，则行为未定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:38:56.157

It will depend on how the `printf` is coded. When the `%` is detected in the string the function will find for one of the characters it expects to see. If it matches then it will process the matched block. For example if you pass the `float` to `%d` then it will process the variable you passed an integer in case the arguments are purely passed through stack. Similarly if you pass an `int` to `%f` it will interpret the integer bits as the specific floating point representation of the system.

Also as R.. pointed out in the comment, in the case when the arguments are passed through registers the output will be different. The type of register on which the passed value is stored (FPU registers or general purpose registers or others). A certain format specifier will pick up the first argument in the register it encounters first.

If the character is something which is not matched say `k` then it may simply print `%k` as the string, or do whatever the function implements.

**EDIT**

Have a look at Mat's answer for the C99 standard specification about the matter.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:30:17.663

由于您似乎对*实际*发生的事情感兴趣，而不是作为最佳实践*应该做什么，我将解决这个问题，让其他人引用章节和经文。*:-)

* * *

格式字符串是一个“提示”，`printf`它告诉它要处理多少字节，以及如何格式化它们。如果你给它错误的格式，它会很高兴地按照你告诉它的方式处理参数，不管它们的实际类型如何。

根据这些字节的值，它们可能是有意义的，也可能是乱码。

这是一个简单的（依赖于实现的）示例：

```
#include <stdio.h>

void main(int argc, char *argv[]) {
        int x = 10; // LF
        x <<= 8;
        x += 13;    // CR
        x <<= 8;
        x += 73;    // I
        x <<= 8;
        x += 72;    // H
        printf("x = %d (%08x)\n", x, x);
        printf("%.4s", &x);
} 
```

这定义`x`为（在我的系统上为 4 字节）整数，其字节包含`10` `13` `73`72`。这些字节恰好是换行、回车、I 和 H 的 ASCII 码。

第一个`printf`显示 的十进制和十六进制值`x`，如果您自己计算它们，您会发现它们完全符合您的预期。

但第二个`printf`将`x`其视为 4 个字符的字符串。由于我的机器是 little-endian 它颠倒了字节顺序，所以它打印对应于 ASCII 72、73、13、10 的字符，它们是

`H` `I` `CR` `LF`

当然，正如 Mat 所指出的，这有助于理解 背后的机制`printf`，但您不应该编写依赖于这种行为的代码。至少，它不是可移植的（例如，大端机器不会更改字节顺序）。

# c++ - 进程的读取进程内存不会返回所有内容

> ID：10372872
> 
> 赞同：5
> 
> 时间：2012-04-29T14:27:00.887
> 
> 标签：c++, windows, winapi, memory, readprocessmemory

我正在尝试扫描第 3 方应用程序的内存。我已经找到地址了；现在是在`0x0643FB78`。问题是，我永远无法到达那里，因为`LPMODULEENTRY32->modBaseAddr`is`0x00400000`并且`LPMODULEENTRY32->modBaseSize`仅仅是`0x006FF000`，因此我可以扫描此模块的最大地址是`0x00AFF000`。

这是否意味着我寻找的地址确实存在于另一个进程/模块/线程/某个东西中？我非常有信心我所拥有的过程确实包含地址。那我应该如何访问内存呢？谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-29T15:05:48.420

至少在我看来，如果你`LPMODULEENTRY`牵涉其中，你可能是从错误的方向开始的。相反，我会遍历目标进程中的内存块`VirtualQueryEx`。这将为您提供`MEMORY_BASIC_INFORMATION`有关该过程中每个块的信息。然后，您可以使用`ReadProcessMemory`并扫描这些块以找到您要查找的内容。

这是我编写的一些旧代码，用于执行大致相同的操作，但查找的是字符串而不是指针：

```
#include <iostream>
#include <vector>
#include <string>
#include <windows.h>
#include <algorithm>
#include <iterator>

template <class InIter1, class InIter2, class OutIter>
void find_all(unsigned char *base, InIter1 buf_start, InIter1 buf_end, InIter2 pat_start, InIter2 pat_end, OutIter res) {
    for (InIter1 pos = buf_start;
        buf_end!=(pos=std::search(pos, buf_end, pat_start, pat_end));
        ++pos)
    {
        *res++ = base+(pos-buf_start);
    }
}

template <class outIter>
void find_locs(HANDLE process, std::string const &pattern, outIter output) {

    unsigned char *p = NULL;
    MEMORY_BASIC_INFORMATION info;

    for ( p = NULL;
        VirtualQueryEx(process, p, &info, sizeof(info)) == sizeof(info);
        p += info.RegionSize ) 
    {
        std::vector<char> buffer;

        if (info.State == MEM_COMMIT && 
            (info.Type == MEM_MAPPED || info.Type == MEM_PRIVATE)) 
        {
            SIZE_T bytes_read;
            buffer.resize(info.RegionSize);
            ReadProcessMemory(process, p, &buffer[0], info.RegionSize, &bytes_read);
            buffer.resize(bytes_read);
            find_all(p, buffer.begin(), buffer.end(), pattern.begin(), pattern.end(), output);
        }
    }
}

int main(int argc, char **argv) {
    if (argc != 3) {
        fprintf(stderr, "Usage: %s <process ID> <pattern>", argv[0]);
        return 1;
    }

    int pid;
    sscanf(argv[1], "%i", &pid);

    std::string pattern(argv[2]);

    HANDLE process = OpenProcess( 
        PROCESS_VM_READ | PROCESS_QUERY_INFORMATION, 
        false,
        pid);

    find_locs(process, pattern, 
        std::ostream_iterator<void *>(std::cout, "\n"));

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-29T14:32:21.483

一个进程由映射了某些保护的内存页组成。这些页面被封装在模块中。每个模块都有一个底座和一个尺寸。但是，ReadProcessMemory 完全从您那里抽象出来。无论它位于哪个模块中，您都应该能够读取内存。

在这种情况下，内存不在您正在查看的模块中。如果您确实需要找到它所属的位置，您可以使用 CreateToolHelp32Snapshot、Module32First 和 Module32Next 遍历模块检查基数和大小。

发布一些代码，我们可以帮助您找出哪里出错了。为什么你这么确定你要找的地址就是你说的地址？由于 ASLR，地址通常使用基本模块 + 偏移量来指定。您如何获得目标进程句柄？您需要具有一定的访问权限才能使用 ReadProcessMemory。

# javascript - 尝试根据单击复选框列表来显示/隐藏输入

> ID：10372875
> 
> 赞同：0
> 
> 时间：2012-04-29T14:27:08.140
> 
> 标签：javascript, jquery, asp.net-mvc-3

我有这个 javascript：

```
$(function () {
    $.fn.enable = function () {
        return this.show().removeAttr("disabled");
    }

    $.fn.disable = function () {
        return this.hide().attr("disabled", "disabled");
    }

    var incomeType = $("#MyModel_IncomeTypeCheckBox");
    var incomeTypeStatusSection = $("#incomeTypeStatusDiv, #incomeTypeStatusDiv input, #incomeTypeStatusDiv textarea, #incomeTypeStatusDiv select");
    setControls();

    incomeType.change(function () {
        setControls();
    });

    function setControls() {
        switch (incomeType.val()) {
            case "FullTime":
                incomeTypeStatusSection.disable();
                break;
            case "PartTime":
                incomeTypeStatusSection.disable();
                break;
            case "SelfEmployed":
                incomeTypeStatusSection.enable();
                break;
            case "SocialSecurity":
                incomeTypeStatusSection.disable();
                break;
            case "Retirement":
                incomeTypeStatusSection.disable();
                break;
            case "ChildSupport":
                incomeTypeStatusSection.disable();
                break;
            case "Maintenance":
                incomeTypeStatusSection.disable();
                break;
            case "Other":
                incomeTypeStatusSection.disable();
                break;
        }
    }
}); 
```

我认为的代码很简单：

```
<div id="incomeTypeStatusDiv">
   <!--Show some hidden inputs here-->
</div> 
```

`MyModel.IncomeTypeCheckBox`是基于与上述值`enum`相对应的。`case`

例如，我可以将上述 javascript 与下拉列表一起使用。选择将显示/隐藏适当的`<div>`.

我现在尝试使用相同的代码根据复选框列表选择来显示/隐藏，但没有成功。`<div>`我想隐藏的是出现而不是被隐藏。**我错过了什么，它不适用于复选框列表？如何使用复选框列表进行这项工作（即，如果我单击“SelfEmployed”复选框，它将显示适当`<div>`，当我取消选中“SelfEmployed”复选框时，它将隐藏`<div>`？**

我可以：

```
$(document).ready(function () {
    $("input[name$='stepincomeinformation.incometypecheckbox']").click(function () {
        var check_value = $(this).val();
        if (check_value == 'selfemployed') {
            $("#incometypecheckbox_selfemployed").toggle(this.checked);
        }
    });
    $("#incometypecheckbox_selfemployed").hide();
    }); 
```

但是如果它`<div>`是隐藏的，它将不允许我继续前进，因为它正在尝试验证。其他 javascript 不验证`<div>`它是否被隐藏。

javascript 基于[Validating a dynamic UI with Mvc2](http://geekswithblogs.net/michelotti/archive/2010/07/07/validating-a-dynamic-ui-with-mvc-2.aspx)，对我来说效果很好。它用于在`<div>`隐藏时禁用验证（并使用 mod 和`MicrosoftMvcValidation.js`活页夹。

任何帮助表示赞赏。

**请参阅下面的最终结果（基于答案）**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:58:55.690

我让它工作了。@jimmyym715 的回答让我朝着正确的方向前进。给他信誉。

```
$(document).ready(function () {
    $("input[name$='MyModel.IncomeTypeCheckBox']").
            click(function () {
        var check_value = $(this).val();
        if (check_value == 'SelfEmployed') {
            $("#IncomeTypeCheckBox_SelfEmployed, #IncomeTypeCheckBox_
                SelfEmployed input").toggle(this.checked);
            $("#IncomeTypeCheckBox_SelfEmployed, #IncomeTypeCheckBox
                _SelfEmployed input").removeAttr("disabled");
        }
        else if (check_value != 'SelfEmployed') {
            $("#IncomeTypeCheckBox_SelfEmployed, 
                #IncomeTypeCheckBox_SelfEmployed input").
                    hide().attr("disabled", "disabled");
        }
 });
    $("#IncomeTypeCheckBox_SelfEmployed, 
        #IncomeTypeCheckBox_SelfEmployed input").hide().
            attr("disabled", "disabled");
}); 
```

需要一些调整，但几乎就在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T14:35:41.590

在您发布的代码中，设置了一个incomeType 变量：

```
var incomeType = $("#MyModel_IncomeTypeCheckBox"); 
```

在这一点上，我猜这`MyModel_IncomeTypeCheckBox`是分配给所有incomeType 复选框的名称。

如果是这样，那么这很可能解释了为什么会出现问题。

首先，因为`MyModel_IncomeTypeCheckBox`是名称，而不是 ID，所以 jQuery 无法通过`$('#MyModel_IncomeTypeCheckBox')`

其次，即使 jQuery 可以访问`MyModel_IncomeTypeCheckBox`普通表单提交中包含的内容，其余代码也只能在选中单个框时起作用，因为选中多个框将导致`MyModel_IncomeTypeCheckBox`包含逗号分隔的复选框值字符串选中的复选框。

所以，这里有两个选择。

第一个选项是通过 ID 单独检查每个复选框的丑陋任务，但这不是您想要的，因为它很痛苦且效率低下。

第二个选项是将检查的incomeTypes 的解释更改为如下所示：

```
function setControls() {
    $('input:checked[name="MyModel_IncomeTypeCheckBox"]:checked').each(function () {
        var checkedIncomeType = $(this).val();
        handleShowHide(checkedIncomeType);
    });
}

function handleShowHide(incomeType)
{
    // move the switch statement here
} 
```

现在我还没有对此进行测试，但至少它应该能让你大部分时间到达那里。如果您有任何问题，请告诉我。

# python - 如何在 Django 中创建用户？

> ID：10372877
> 
> 赞同：112
> 
> 时间：2012-04-29T14:27:13.797
> 
> 标签：python, django

我正在尝试通过以下代码在 Django 项目中创建一个新用户，但突出显示的行会引发异常。

```
def createUser(request):
    userName = request.REQUEST.get('username', None)
    userPass = request.REQUEST.get('password', None)
    userMail = request.REQUEST.get('email', None)

    # TODO: check if already existed

    **user = User.objects.create_user(userName, userMail, userPass)**
    user.save()

    return render_to_response('home.html', context_instance=RequestContext(request)) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2014-05-05T21:32:53.820

在 Django 中创建用户的正确方法是使用 create_user 函数。这将处理密码的散列等。

```
from django.contrib.auth.models import User
user = User.objects.create_user(username='john',
                                 email='jlennon@beatles.com',
                                 password='glass onion') 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-29T17:18:54.307

您是否确认您正在传递实际值而不是`None`？

```
from django.shortcuts import render

def createUser(request):
    userName = request.REQUEST.get('username', None)
    userPass = request.REQUEST.get('password', None)
    userMail = request.REQUEST.get('email', None)

    # TODO: check if already existed
    if userName and userPass and userMail:
       u,created = User.objects.get_or_create(userName, userMail)
       if created:
          # user was created
          # set the password here
       else:
          # user was retrieved
    else:
       # request was empty

    return render(request,'home.html') 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-05-14T09:23:53.273

**批量用户创建`set_password`**

我你正在创建几个测试用户，`bulk_create`速度要快得多，但我们不能使用`create_user`它。

`set_password`是另一种生成散列密码的方法：

```
def users_iterator():
    for i in range(nusers):
        is_superuser = (i == 0)
        user = User(
            first_name='First' + str(i),
            is_staff=is_superuser,
            is_superuser=is_superuser,
            last_name='Last' + str(i),
            username='user' + str(i),
        )
        user.set_password('asdfqwer')
        yield user

class Command(BaseCommand):
    def handle(self, **options):
        User.objects.bulk_create(iter(users_iterator())) 
```

关于密码哈希的特定问题：[如何在 Django 中使用 Bcrypt 加密密码](https://stackoverflow.com/questions/33907663/how-to-use-bcrypt-to-encrypt-passwords-in-django)

在 Django 1.9 中测试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-01-30T11:34:29.113

如果您正常创建用户，您将无法登录，因为密码创建方法可能不同您可以使用默认注册表单

```
from django.contrib.auth.forms import UserCreationForm 
```

你也可以扩展它

```
from django.contrib.auth.forms import UserCreationForm

class UserForm(UserCreationForm):
    mobile = forms.CharField(max_length=15, min_length=10)
    email = forms.EmailField(required=True)
    class Meta:
        model = User
        fields = ['username', 'password', 'first_name', 'last_name', 'email', 'mobile' ] 
```

然后在视图中使用这个类

```
class UserCreate(CreateView):
    form_class = UserForm
    template_name = 'registration/signup.html'
    success_url = reverse_lazy('list')

    def form_valid(self, form):
        user = form.save() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-25T08:15:39.370

如果您只是使用`object.save()`创建用户，原始密码将在数据库中直接可见。首先，不安全。其次，密码的加密没有完成，导致解密器会使用你数据库中的原始密码来解密一个错误的密码，导致无法登录。我猜每次你使用来自的验证功能时`django.contrib.auth`，你实际上是在使用它的解密器。是的，我想每次您登录时，您的密码都需要再次解密。

# objective-c - 实施 sqlite3 时出错

> ID：10372878
> 
> 赞同：0
> 
> 时间：2012-04-29T14:27:14.867
> 
> 标签：objective-c, ios, xcode

我正在尝试链接 sqlite3，创建表并插入数据，但出现此错误：

```
'NSInternalInconsistencyException', reason: 'Error creating table: near "4": syntax error' *** First throw call stack:(0x15ad022 0x173ecd6 0x1555a48 0xa852cb 0x2bea 0x273a 0x1b5a1e 0x114401 0x114670 0x114836 0x11b72a 0x2415 0xec386 0xed274 0xfc183 0xfcc38 0xf0634 0x1497ef5 0x1581195 0x14e5ff2 0x14e48da 0x14e3d84 0x14e3c9b 0xecc65 0xee626 0x20d2 0x2045 0x1) 
```

编码：

```
- (void) openDBcreateTable {
if (sqlite3_open([[self filePath]UTF8String], &db) != SQLITE_OK) {
    sqlite3_close(db);
    NSAssert(0, @"Failed to open database");
}
//create table named QUESTIONBANK
NSString *createSQL = @"CREATE TABLE IF NOT EXISTS QUESTIONBANK(ROW INTEGER PRIMARY KEY, QUESTION TEXT, ANSWER TEXT, CHOICE1 TEXT, CHOICE2 TEXT, CHOICE3 TEXT, CHOICE 4 TEXT, USERANSWER TEXT);";

char *errorMsg1;

if (sqlite3_exec(db, [createSQL UTF8String], NULL, NULL, &errorMsg1) != SQLITE_OK) {
    sqlite3_close(db);
    NSAssert(0,@"Error creating table: %s", errorMsg1);
}

for (int k = 1; k < 11; k++) {
    NSMutableArray *questionBlocks = [self pullDataFromSomeWhere];
    NSString *question = [NSString stringWithFormat:[questionBlocks objectAtIndex:0]];
    NSString *answer = [NSString stringWithFormat:[questionBlocks objectAtIndex:1]];
    NSString *choice1 = [NSString stringWithFormat:[questionBlocks objectAtIndex:2]];
    NSString *choice2 = [NSString stringWithFormat:[questionBlocks objectAtIndex:3]];
    NSString *choice3 = [NSString stringWithFormat:[questionBlocks objectAtIndex:4]];
    NSString *choice4 = [NSString stringWithFormat:[questionBlocks objectAtIndex:5]];

    char *update = "INSERT OR REPLACE INTO QUESTIONBANK(ROW,QUESTION,ANSWER,CHOICE1,CHOICE2,CHOICE3,CHOICE4)VALUES(?,?,?,?,?,?,?);";

    sqlite3_stmt *stmt;

    if (sqlite3_prepare_v2(db, update, -1, &stmt, nil) == SQLITE_OK) {
        sqlite3_bind_int(stmt, 1, k);
        sqlite3_bind_text(stmt, 2, [question UTF8String], -1, NULL);
        sqlite3_bind_text(stmt, 3, [answer UTF8String], -1, NULL);
        sqlite3_bind_text(stmt, 4, [choice1 UTF8String], -1, NULL);
        sqlite3_bind_text(stmt, 5, [choice2 UTF8String], -1, NULL);
        sqlite3_bind_text(stmt, 6, [choice3 UTF8String], -1, NULL);
        sqlite3_bind_text(stmt, 7, [choice4 UTF8String], -1, NULL);

    }
    if (sqlite3_step(stmt) != SQLITE_DONE) {
        NSAssert(0,@"Error updating table");
    }
    sqlite3_finalize(stmt);
}
sqlite3_close(db);} 
```

我也非常有信心还有其他错误，因为我还是 sqlite 3 的新手。当我们在这里时，我可以在 sqlite3 中使用任何“VARCHAR”、“BLOB”等（如 MySQL）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:31:31.827

删除 create table 语句中的虚假“4”：

`... CHOICE 4 TEXT ...`

应该：

`... CHOICE TEXT ...`

错误消息是不言自明的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T15:28:13.417

关于您的数据类型问题，我认为[SQLite 文档](http://sqlite.org/datatype3.html)清楚地解决了这个问题。最重要的是，SQLite 的数据类型有限，并且它不强制数据列的类型（因此您可以将任何数据类型存储在任何列中）。没有明确的 VARCHAR 数据类型。

# c++ - 大数字库的通用包装类

> ID：10372879
> 
> 赞同：0
> 
> 时间：2012-04-29T14:27:21.760
> 
> 标签：c++, design-patterns, wrapper, libraries

我正在从事的项目可能受益于能够在不同的大型库之间轻松交换：GMP、OpenSSL 等。我当前的实现定义了一个模板抽象基类，我在其中实现了所有必需的运算符（只是为了拥有一些语法糖），我定义了所需的纯虚函数。

对于每个库，我都有一个这样的派生类：`class BigNumberGmp : public BigNumberBase<BigNumberGmp>`. 我知道它有点破坏 OOP，但是 C++ 协方差功能太严格了，它不允许我从方法返回 BigNumberBase 对象，只有引用，这是非常不可取的......

问题是我希望使用我的自定义包装器的代码能够与任何此类包装器一起使用：BigNumberGmp、BigNumberOpenSsl 等。为了实现这一点，我定义了 typedef BigNumberGmp BigNumber 并将其放在一些条件宏中，就像这样：

```
#if defined(_LIB_GMP)
    typedef BigNumberGmp BigNumber;
#endif 
```

此外，我以类似的方式包含适当的标题。此实现要求我在编译器选项中定义 _LIB_GMP 符号。

如您所见，这是一种相当骇人听闻的技术，我并不为此感到自豪。此外，它不会以任何方式隐藏专用类（BigNumberGmp、BigNumberOpenSsl 等）。我还可以多次定义 BigNumber 类，包装在 _LIB_XXX 条件宏中，或者我可以在 BigNumber 类中多次实现所需的方法，对于每个库，也包装在 _LIB_XXX 条件宏中。后两种想法似乎比 typedef 实现更糟糕，它们肯定会弄乱 doxygen 输出，因为它无法弄清楚为什么我有多个具有相同名称的项目。我想避免使用 doxygen 预处理器，因为我仍然依赖 _LIB_XXX 定义...

有没有我可以使用的优雅设计模式？你会如何处理这样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:34:14.603

我会在 pimpl 成语的帮助下做到这一点。我会首先定义一个包装类：

```
class BigNumber {
private:
    class BigNumber_impl {
        virtual void do_something() = 0;
    }
    BigNumber_impl * impl;
public:
    void do_something() {
        impl->do_something();
    }
}; 
```

然后我会让 BigNumberGMP 等从 BigNumber::BigNumber_impl 继承。然后，您可以返回 BigNumbers 的对象，但在底层仍然具有多态性。

这并不能解决创建 BigNumber 的问题，而且您还必须担心如何添加具有不同 BigNumber_impl 类型的 BigNumber。因此，您的原始解决方案可能适合您的目的。在某些时候，您将不得不依赖一些预处理器魔法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T15:18:22.300

看起来您每次切换库时都要重新编译，在这种情况下，您可以使用模板特化而不是继承。

选择使用哪个几乎是你所拥有的（`#if`基于某些东西），但你会保存虚拟成员，这意味着编译器仍然可以内联，这意味着在某些情况下它可能会更快。

首先，采用描述每个实现的结构。在这里，您可以将在所有库中以相同方式工作的基本 API 名称。例如，如果它们都支持加法操作，该操作采用指向两个大数字的指针并返回一个指向包含结果的新大数字的指针，您可以执行以下操作：

（请注意，我没有通过编译器运行它，我不知道实际的 API 是什么样的，但它应该足以给出该方法的一般概念）

```
struct GMP {
    GMP_ptr* add(GMP_ptr *l, GMP_ptr*r) {
        return GMPadd(l, r);
    }
};
struct OpenSSL {
    OpenSSL_ptr* add(OpenSSL_ptr*, OpenSSL_ptr*) {
        OpenSSL_ptr ret = NULL;
        OpenSSLadd(l, r, &ret);
        return ret;
    }
}; 
```

现在我们可以定义一个通用的超类，其中包含这些易于映射的 API 的使用：

```
template< typename B, typename R >
class common {
public:
    // Assume that all types have the same API
    R operator + (const common &r) {
        return R(B::add(l.ptr, r.ptr));
    }
}; 
```

B 类是定义大数 API 的结构体，R 类是真正的实现子类。通过像这样传入 R，我们解决了协变返回问题。

对于真正的实现，我们定义了一个模板来为我们完成工作：

```
template< typename B >
class big_num; 
```

现在我们可以将其专门用于实现：

```
template<>
class big_num<OpenSSL> : common< OpenSSL, big_num<OpenSSL> > {
    OpenSSL_ptr *ptr;
public:
    big_num(OpenSSL_ptr*p)
    : ptr(p) {
    }
    big_num(const char *s)
    : ptr(OpenSSLBigNumFromString(s)) {
    }
    ~big_num() {
        OpenSSLBigNumFree(ptr)
    }
}; 
```

将`operator +`来自超类，您现在可以像这样使用它们：

```
void foo() {
    big_num< GMP > gmp1("123233423"), gmp2("234");
    big_num< GMP > gmp3 = gmp1 + gmp2;
    big_num< OpenSSL > ossl1("1233434123"), ossl2("234");
    big_num< OpenSSL > ossl3 = ossl1 + ossl2;
} 
```

此处的优势在于，由于使用结构来适应相似的 API 功能和一个模板中的通用实现，因此专业化之间的代码重复最少。给定 API 的细节现在在模板特化中，但没有虚拟，也没有通用的超类。这意味着编译器可以内联包装器中的几乎所有内容，这将使它们基本上尽可能快。

由于专业化，您还可能可以访问所有实现，这可能会使您的单元测试更容易编写/管理（您也应该能够编写这些的模板版本）。

如果您只希望其中一个可见，则如下所示：

```
#if BIGNUM=="GMP"
    typedef big_num<GMP> used_big_num;
#elif BIGNUM=="OpenSSL"
     typedef big_num<OpenSSL> used_big_num;
#endif 
```

如果标题并不总是可用，您可能还需要围绕专业设置防护，在这种情况下，您也需要一组`HAVE_GMP_BIGNUM`和`HAVE_OPENSSL_BIGNUM`宏。

# ruby - $:.push 在红宝石中有什么作用？

> ID：10372880
> 
> 赞同：16
> 
> 时间：2012-04-29T14:27:34.967
> 
> 标签：ruby, rubygems, gemspecs

[我在测量员 gem](https://github.com/NUBIC/surveyor/blob/master/surveyor.gemspec)的 Gemspec 文件中找到了这个。以下行有什么作用？

```
$:.push File.expand_path("../lib", __FILE__)
require "surveyor/version" 
```

为什么`$:.push`事情会这样？在我看来，它只是`requires`文件`../lib/surveyor/version`。如果是这样，我不能用以下一行替换它吗？

```
require File.expand_path('../lib/surveyor/version', __FILE__) 
```

这两者是一回事吗？如果不是，那有什么区别？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-29T14:35:02.397

`$:`是 Ruby 的加载路径，因此它实际上是将所在文件夹的 a 子文件`/lib`夹添加`__FILE__`到该数组中，以便可以`require`d.

# python - 从 .html 文件中读取其内容的简单烧瓶应用程序。外部样式表被阻止？

> ID：10372883
> 
> 赞同：10
> 
> 时间：2012-04-29T14:27:56.900
> 
> 标签：python, css, flask

我制作了一个非常简单的烧瓶应用程序，它从 .html 文件中读取其内容。该应用程序的工作方式除外。奇怪的是，我的内联 css 代码有效，但外部样式表无效。我检查了语法，它应该可以工作。烧瓶是否以某种方式阻止读取 .css 文件？

文件夹中的文件可以在[这里](https://gist.github.com/2550655)查看。这三个文件都在同一个文件夹中。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-29T17:13:09.037

您的代码没有使用 Flask 提供文件，它只是读取文件并将其发送到浏览器 - 这就是 URL 不起作用的原因。

您需要从方法中呈现文件。

首先`templates`在与您的文件相同的目录中创建一个文件夹，`.py`然后将您的 html 文件移动到该文件夹​​中。创建另一个名为的文件夹`static`并将您的样式表放在该文件夹中。

你应该有

```
/flaskwp1.py
/templates
  webcode.html
/static
  webcodestyle.css 
```

然后，调整您的代码：

```
from flask import Flask, render_template

app = Flask('flaskwp1')
# webcode = open('webcode.html').read() - not needed

@app.route('/')
def webprint():
    return render_template('webcode.html') 

if __name__ == '__main__':
    app.run(host = '0.0.0.0', port = 3000) 
```

编辑`webcode.html`：

```
<link rel="stylesheet"
      type="text/css"
      href="/static/webcodestyle.css"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-29T15:20:07.147

您需要创建一个特定的静态 url 和目录。

```
url_for('static', filename='style.css') 
```

将使您的应用程序能够在 Web 应用程序模块的根目录下名为“static”的文件夹中查找名为“style.css”的文件。它将通过 url '/static/style.css' 提供给您的 Web 应用程序

您可能想要发布 html 文件的内容和 python 代码本身，以便我们可以看到可能出了什么问题。听起来 URL 不正确，或者您没有设置 Web 服务器以从该位置提供静态文件。

# php - 如何检查具有相同设计的多个表的值？

> ID：10372885
> 
> 赞同：-4
> 
> 时间：2012-04-29T14:28:19.437
> 
> 标签：php, sql

我有需要更新的网页，例如，如果某些表格中的文章已经过了 7 天，那么该页面将查看通知窗口，提示有一些旧文章需要更新

如何跨多个表检查日期？

```
$sql = "select topic.*
            ,   id.* 
        from    $table_1
            ,   $table2 
        where (date of the article) < (<date  of the article+ 7 days...>)" ;
        // the arctile has passed 7 days 
$rs     = mysql_query($sql);
$nos    = mysql_num_rows($rs);
$obj    = mysql_fetch_object($rs);
if($row = mysql_fetch_array($sql)) 
{ 
    // I want to display window that display note 
    // there is artiles need to be updated and list of those topics"
    <script language="javascript" type="text/javascript">
        function print_msg(opt,id) 
        {
            if(confirm("show old topics")) 
            {
                window.location="home.php";
            } 
            else 
            {
                return false;
            }
        }
    </script>
    //here are the topics need to be updated           
    echo obj->topic;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:36:24.453

我认为您必须使用*UNION ALL*来连接两个表中的行。加入行后，您可以对派生表输出执行 SELECT 以检查您的日期条件。这是 SQL 查询。我不知道 PHP 语法。

如果您只想获取两个表中不同的行，请将*UNION ALL*更改为*UNION*。

*查询*：在 MySQL 中沿着这条线的东西。

```
SELECT id, topic, date
FROM
(
    SELECT id, topic, date FROM table1
    UNION ALL 
    SELECT id, topic, date  FROM table1
) T1
WHERE DATEDIFF(date, DATE(NOW())) <= 7 
```

**上述查询中的T1**表示派生表输出的别名。

# python - 使用 PIL 在 python 中打开并显示 .png 文件

> ID：10372887
> 
> 赞同：3
> 
> 时间：2012-04-29T14:28:34.287
> 
> 标签：python, python-imaging-library

我需要打开一个 png 图像文件并显示它。我可以使用 PIL 打开文件

```
from PIL import Image
f = Image.open("file.png").show() 
```

我收到一条错误消息：“错误阻止显示视频或图像错误代码 0x800706ba

有谁知道这里出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:47:34.450

在 Windows 上，PIL 使用任何注册的程序来打开一个临时的 .BMP 文件。当程序返回时，临时文件被删除。

到目前为止，最常见的问题是程序甚至在打开文件之前就发回了返回码，并且文件在打开之前就被删除了。不幸的是，Windows Vista 和 7 中的默认查看器存在这个问题；XP 使用了 Microsoft 图像和传真查看器，这还不错。

您可以使用文件资源管理器更改与 .BMP 文件关联的程序。

# ruby - Bundler：找到哪个 gem 依赖于此？

> ID：10372894
> 
> 赞同：3
> 
> 时间：2012-04-29T14:29:09.083
> 
> 标签：ruby, dependencies, gem, bundler, dependency-management

我运行时安装了 backports 库，`bundle install`但我不知道哪个 gem 需要这个 - 有没有办法让 bundler 告诉我这个，或者有其他方法可以找到这个吗？

我需要它以其他方式运行，而不是`bundle viz`在运行时出错。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T14:36:25.147

您可以尝试查看您的 Gemfile.lock 文件。依赖项嵌套在它们所需的内容之下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:36:55.567

You should check `Gemfile.lock`. As a shortcut, just do `CTRL` + `F` & search for *backports* in that file.

# tooltip - 如何在 TeeChart asp.net 图表中创建工具提示

> ID：10372895
> 
> 赞同：1
> 
> 时间：2012-04-29T14:29:09.483
> 
> 标签：tooltip, teechart

我在 asp.net Web 应用程序中使用 TeeChart 折线图。

当鼠标悬停在图表中的某个点上时，我想显示一个工具提示。

这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T07:58:59.403

TeeChart .NET WebCharts 基本上是在服务器端创建的，导出为发送到客户端浏览器的图像。当然，这种技术限制了交互性，但 WebCharts 仍然支持一些这种交互性，如这里的现场演示所示：http: [//www.steema.net/TeeChartForNET/index.aspx](http://www.steema.net/TeeChartForNET/index.aspx)

具体来说，可以在“与图表交互\鼠标悬停提示”下的示例中探索鼠标悬停功能

Steema 支持团队。

# maven - 如何在 Maven 中处理两个几乎相同的发布分支

> ID：10372903
> 
> 赞同：2
> 
> 时间：2012-04-29T14:30:10.330
> 
> 标签：maven, release-management

在工作中，有人对特定于 JDK 1.5 的项目进行了大量更改。不幸的是，一些生产环境仍处于 Java 1.4，因此他们求助于创建由 jdk1.4 版本的 /trunk 组成的双分支。

这个 1.4 分支可能至少有一年的生命周期，在此期间主干中的更改会合并到 jdk1.4 分支中。

我被问到的问题是在这种情况下是否有处理 Maven 工件 ID 的最佳实践？显然，最佳实践可能会避免让我们一开始就陷入这种情况，但现在我们……该怎么办？

我们考虑为另一个分支提供一个唯一的工件 ID，例如“myapp-jdk14”，同时保持所有其他标识符字段（groupId、version）同步。这样做有什么明显的缺点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T21:14:51.200

事实上，有两种常用的解决方案：

1.  为工件的名称添加一些特殊的自定义后缀，例如`jdk14`. 例如，[Bouncy Castle](http://mvnrepository.com/artifact/org.bouncycastle)或[SLF4j](http://mvnrepository.com/artifact/org.slf4j/slf4j-jdk14)使用此策略。
2.  使用分类器，实际上是为诸如区分同一工件的变体（正是您的情况）之类的任务而设计的。

根据我的经验，有趣的是，第一个解决方案确实更常用，尽管第二个解决方案是官方建议的。

就个人而言，我使用第一个解决方案，但是 - 老实说 - 我没有看到一个解决方案相对于另一个解决方案有任何强大的优势（或劣势）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-29T20:36:27.487

You could use a classifier for this:

> **classifier:** The classifier allows to distinguish artifacts that were built from the same POM but differ in their content. It is some optional and arbitrary string that - if present - is appended to the artifact name just after the version number.
> 
> As a motivation for this element, consider for example a project that offers an artifact targeting JRE 1.5 but at the same time also an artifact that still supports JRE 1.4\. The first artifact could be equipped with the classifier jdk15 and the second one with jdk14 such that clients can choose which one to use.

Source: [http://maven.apache.org/pom.html](http://maven.apache.org/pom.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-29T14:39:14.003

You can use your solution but I would suggest to have different version numbers.

For example:

```
1.0.X for JDK 1.4
1.1.X for JDK 1.5 
```

That doesn't mean my suggestion is better than yours. Your solution has the advantage to see based on the artifactId which jdk it is for very obviously.

# css - chrome 扩展、jstree、iframe：拖放

> ID：10372906
> 
> 赞同：1
> 
> 时间：2012-04-29T14:30:36.313
> 
> 标签：css, google-chrome, iframe, google-chrome-extension, jstree

我是 chrome 扩展开发的新手，我正在构建一个需要侧面板（不是弹出窗口）的面板，比如 firebug，但在右侧。我在侧面板中使用 jsTree（带有 json_data），我想将元素从网页拖到侧面板。

到目前为止，为了创建侧面板，我使用了一个附加到带有 z-index 的主体的 div，以便它显示在网页上方，但是由于网站的 css，我的侧面板中的元素样式发生了变化。

所以我想我可以使用 iframe 来避免侧面板中的任何 css 不兼容。我使用 src="chrome-extension:///page.html" 动态创建 iframe。

通过直接在 iframe 的源页面中加载 jquery+jstree 脚本，我设法使我的 jstree 在 iframe 中正常工作......这很糟糕，但我无法获得用于 iframe 源页面的内容脚本（尽管“all_frames”：true）。

我想将网站页面中的元素拖到 iframe 中的 jstree 中……我找到了 iframeFix: true 和 refreshPositions: true，但这似乎并没有改变任何东西……任何人都知道该怎么做?

如果我不使用 iframe，根据网络上的多个示例，我可以使用 dnd 插件轻松地将元素拖放到 jstree。我没试过；即使它有效，我侧面板中的 css 也会被更改，我不能让这种情况发生。

我见过“iframe 上方的 div 层”技术。我可以成功地从 iframe 上方那个 div 的网页上删除一个元素。但是，当我尝试通过端口向 iframe 发布消息（包含已删除元素的数据）时，iframe 不会收到消息。在这种情况下，我的想法是以某种方式将消息添加到 jstree 的 json 数据中。

我已经阅读了我发现的所有关于 content_scripts 和 iframe 的帖子，我知道这些错误......我不知道它是否已修复，如果是，我不知道如何制作ifra 和内容脚本之间的端口通信工作。有人知道更多吗？

我还应该补充一点，当我尝试使用端口在内容脚本和 iframe 之间进行通信，并从后台页面中的 iframe 复制侦听器时，后台页面接收到消息就好了......这只是意味着端口我想通信工作正常，但内容脚本和 iframe 之间没有......

有什么想法吗？我真的被困住了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T11:31:10.400

回答我自己的问题；我还没有找到关于如何在带有 jstree 的 chrome 扩展中使用 iframe 的解决方案。

我只是选择硬核的方式；将 a 添加`<div>`到`<body>`, 并通过大量测试确保我的 css`<div>`将与网页的 css 保持隔离。

干杯

# jquery - 使用 Jquery UI datepicker 下拉日期范围

> ID：10372907
> 
> 赞同：0
> 
> 时间：2012-04-29T14:30:44.760
> 
> 标签：jquery

我想要一个下拉菜单来快速选择日期范围。例如，“上周”、“上个月”、“最近三个月”。那种东西。在选择其中之一时，它将填充 2 个文本框，其中包含选择的起始日期和结束日期。已经用 JUI datepicker 尝试了一些东西，但是在谷歌之后，它似乎不是这样做的方法。

任何帮助将非常感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T16:23:57.773

我做了类似的事情，但有单选按钮。希望能帮助到你：

```
 function reset_last_checkboxes() {
        $("#export_last_month").attr("checked", false);
        $("#export_3_last_months").attr("checked", false);
        $("#export_last_year").attr("checked", false);
    }
    var date_format = "DD, d MM, yy";
    $("#id_from_date").attr("readonly", "readonly");
    $("#id_till_date").attr("readonly", "readonly");
    $("#id_from_date").datepicker();
    $("#id_till_date").datepicker();
    $( "#id_from_date" ).change(function() {
        $( "#id_from_date" ).datepicker( "option", "dateFormat", date_format );
    });
    $( "#id_till_date" ).change(function() {
        $( "#id_till_date" ).datepicker( "option", "dateFormat", date_format );
    });
    $( "#id_from_date" ).click(function() {
        reset_last_checkboxes();
    });
    $( "#id_till_date" ).click(function() {
        reset_last_checkboxes();
    });
    $("#id_till_date").val(format_date(new Date(now)));
    $("#export_last_month").click(function(){
        var dt = new Date(now);
        $("#id_till_date").val(format_date(dt));
        $("#id_from_date").val(format_date(prevMonth(dt)));
    });
    $("#export_3_last_months").click(function(){
        var dt = new Date(now);
        $("#id_till_date").val(format_date(dt));
        $("#id_from_date").val(format_date(prevMonth(prevMonth(prevMonth(dt)))));
    });
    $("#export_last_year").click(function(){
        var dt = new Date(now);
        $("#id_till_date").val(format_date(dt));
        for (var i=0;i<12;i++) {
            dt = prevMonth(dt);
        }
        $("#id_from_date").val(format_date(dt));
    }); 
```

你总是可以用下拉菜单替换我的单选按钮，并比我写得更好:)

顺便说一句，prevMonth 我是这样计算的：

```
function prevMonth(dt){
    var thisMonth = dt.getMonth();
    dt.setMonth(thisMonth-1);
    if(dt.getMonth() != thisMonth-1 && (dt.getMonth() != 11 || (thisMonth == 11 && dt.getDate() == 1)))
        dt.setDate(0);
    return dt;
} 
```

# jquery - 页面上只有一个功能简码

> ID：10372912
> 
> 赞同：0
> 
> 时间：2012-04-29T14:31:18.903
> 
> 标签：jquery, accordion

我为 wordpress 创建了一个手风琴简码，并且工作正常，直到页面只有一个手风琴......

这是问题[http://panel.daweb.cz/?page_id=119](http://panel.daweb.cz/?page_id=119)

手风琴在第一页的底部可以正常工作，但第二页不能。我正在使用 jQuery jquery-ui.js 来获得手风琴效果（[http://jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)）。

有人知道如何解决它，或者哪里有真正好的教程如何为 wp 做手风琴短代码？

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:41:59.233

在您的 JavaScript 文件 otherjs.js 中，您在底部有此代码

```
// Load accordion   
$(function() {
    $( "#accordion" ).accordion();
    $('.flexslider').flexslider();  
}); 
```

你的两个手风琴都有'手风琴'的ID。同一页面上的两个项目不应具有相同的 ID，因为它们必须是唯一的，这意味着 jQuery 只会设置它找到的第一个手风琴。

您需要做的是为您的第一个手风琴提供 ID，`accordion1`然后`accordion2`将您在 otherjs.js 中的 JavaScript 更改为：

```
// Load accordion   
$(function() {
    $( "#accordion1" ).accordion();
    $( "#accordion2" ).accordion();
    $('.flexslider').flexslider();  
}); 
```

或者，您可以摆脱两个手风琴的 ID 并为它们提供*类* `accordion`，然后您将使用此代码加载手风琴：

```
// Load accordion   
$(function() {
    $( ".accordion" ).accordion();
    $('.flexslider').flexslider();  
}); 
```

# c# - Rally SOAP API - 如何将附件添加到 TestCaseResult

> ID：10372917
> 
> 赞同：0
> 
> 时间：2012-04-29T14:31:51.797
> 
> 标签：c#, soap, rally

我已经想出了如何将附件添加到 TestCase、Defect 对象，但我不能使用相同的机制似乎将测试结果文件附加到 TestCaseResult 对象。我收到“验证错误：Attachment.attachments[0] 不应为空”的错误消息。我尝试在创建测试结果期间附加，以及更新现有的、先前创建的测试结果。如果不支持将测试结果文件附加到 TestCaseResult，我会感到惊讶，因为这是常见的主流行为。谢谢。

我的代码：

私人附件 createAttachment(string resultsFile) { byte[] bytes = readFileAsByteArray(resultsFile);

```
 // Create attachment content;
        AttachmentContent attachmentContent = new AttachmentContent();
        attachmentContent.Content = bytes;
        attachmentContent.Workspace = this.m_targetWorkspace;
        CreateResult result = m_rallyService.create(attachmentContent);
        attachmentContent = (AttachmentContent)result.Object;
        //attachmentContent = (AttachmentContent)this.m_rallyService.read(attachmentContent, this.m_targetWorkspace);

        Attachment attachment = new Attachment();
        attachment.ContentType = "application / vnd.openxmlformats - officedocument.wordprocessingml.document";
        attachment.Content = attachmentContent;
        attachment.Name = "Bubba.docx";
        attachment.Size = bytes.Length;
        attachment.SizeSpecified = true;
        attachment.User = this.m_rallyUser;
        //attachment.Artifact = testResult;
        attachment.Workspace = this.m_targetWorkspace;

        result = m_rallyService.create(attachment);
        attachment = (Attachment)result.Object;
        //attachment = (Attachment)this.m_rallyService.read(attachment, this.m_targetWorkspace);

        return attachment;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:31:19.420

事实上，它现在有效。Attachment 对象现在有一个属性 TestCaseResult，当设置该属性时，会将附件附加到创建的结果中。我修改后的代码：

```
 private Attachment createAttachment(TestCaseResult testCaseResult, string resultsFile)
    {
        byte[] bytes = readFileAsByteArray(resultsFile);

        // Create attachment content;
        AttachmentContent attachmentContent = new AttachmentContent();
        attachmentContent.Content = bytes;
        attachmentContent.Workspace = this.m_targetWorkspace;
        CreateResult result = m_rallyService.create(attachmentContent);
        attachmentContent = (AttachmentContent)result.Object;

        // Create attachment.
        Attachment attachment = new Attachment();

        // Microsoft Word document.
        attachment.ContentType = "application / vnd.openxmlformats - officedocument.wordprocessingml.document";
        attachment.Content = attachmentContent;

        // Parse out file name.
        string[] parts = resultsFile.Split(new char[] { '\\' });
        attachment.Name = parts[parts.Length - 1];

        attachment.Size = bytes.Length;
        attachment.SizeSpecified = true;
        attachment.User = this.m_rallyUser;
        attachment.TestCaseResult = testCaseResult;
        attachment.Workspace = this.m_targetWorkspace;

        result = m_rallyService.create(attachment);
        attachment = (Attachment)result.Object;

        return attachment;
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:57:47.523

自 2012 年 5 月 26 日 Rally 代码发布以来，此缺陷已得到修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T20:08:21.210

不幸的是，您遇到了 Rally Webservices API 的一个已知缺陷。Rally 产品开发部门正在努力修复 - 尽管如此，我还是建议向 Rally 支持 (rallysupport@rallydev.com) 提交一个案例，因为这会将您的查询与缺陷相关联，并且在修复后您会收到通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T19:53:23.863

如果附件属于 test_case_result 它应该使用 attachment.artifact：

```
Artifact
Required    false
Note    The artifact this attachment belongs to.
One-To-One Relationship Artifact 
```

为什么我们需要 Attachment.TestCaseResult 而不是简单的 Attachment.Artifact ？

```
TestCaseResult    
Required    false
Note    Associated Test Case Result
One-To-One Relationship TestCaseResult 
```

# forms - jQuery if readonly = true 只清除表单的一部分

> ID：10372919
> 
> 赞同：0
> 
> 时间：2012-04-29T14:32:03.460
> 
> 标签：forms, readonly, jquery

我有 2 个 jQuery 片段，第一个是只读的，第二个是提交表单。

**切换只读：**

```
$('#lock').toggle( function () {
    $('#handle').attr('readonly', true).addClass('disabled');
return false;
 } , function() {
  $('#handle').attr('readonly', false).removeClass('disabled');
return false;
}); 
```

**提交表格：**

```
$('button').click(function() {
var handle     = $('#handle').val();
var msg        = $('#msg').val();
var dataString = 'handle='+ handle + '&msg=' + msg;

if(handle=='' || msg=='') {
$('.error').fadeOut(200).show();
} else {

$.ajax({
  type    : 'POST',
  url     : 'form.php',
  data    : dataString,
  success : function(){
$('#foo').load('page.php');
}}
 });
}
 return false;
}); 
```

我想要实现的是

*如果 readonly = true 不重置“handle”值*

否则重置两者，所以我需要获取第一个片段的状态（切换只读）并允许第二个片段（表单）区分它的真假。

我成功地尝试了这个：但它没有用。

```
if($('#handle').attr('readonly', true)){
    $('#msg').val('');
    }else{
    $('#handle, #msg').val(''); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:41:53.703

试试这个代码：

```
if ($('#handle').is('[readonly]')) {
    $('#msg').val('');
}
else {
    $('#handle, #msg').val('');
} 
```

也可以使用

```
​$('#handle').prop('readonly', true) 
```

代替

```
$('#handle').attr('readonly', true) 
```

# iphone - 如何终止 UIViewController

> ID：10372920
> 
> 赞同：0
> 
> 时间：2012-04-29T14:32:07.390
> 
> 标签：iphone, sdk, uiviewcontroller

我有两个 UIViewController，主要的和次要的，主要的 ViewController 中有一个按钮可以查看次要的视图：

```
myView = [[secondView alloc] init];
[self.view addSubView:myView.view]; 
```

如何终止辅助 ViewController？如果我使用: `[secondView.view removeFromSuperview]`，这个只会隐藏 UIView 并保持 ViewController 分配。

由于我的项目设计和代码，我无法使用`[self presentModalViewController:myView animated:NO];`

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T16:31:45.700

您不需要终止主视图控制器。当您移除辅助视图控制器时，主视图控制器将变为活动状态，辅助视图控制器将立即终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T16:02:23.743

在你的情况下，

```
[myView.view removeFromSuperview];
[myView release]; 
```

# android - 延迟更新照片

> ID：10372921
> 
> 赞同：0
> 
> 时间：2012-04-29T14:32:15.580
> 
> 标签：android

我是编程新手，我已经为此苦苦挣扎了好几天，无法让它发挥作用。

我有一个循环来执行一些任务。它将`ImageView`为该特定任务显示一张图片。所以它是这样的：

*   设置图像资源
*   做一些任务
*   等待 1 秒
*   然后重新开始一切，直到命令结束
*   当所有命令结束时，通过调用 finish() 关闭该活动

我尝试使用带有 runnable 和 asynctask 的处理程序，但我无法让它工作。UI 总是在 1 秒延迟之后更新。当我在命令结束后调用 finish() 时，照片似乎根本没有出现。

```
for(int i=0; i<actions.size(); i++) {
            switch((int)actions.get(i)[0]) {
            case 0:
                ivActionIcon.setImageResource(R.drawable.image);
                sleeping=true;
                DelayAsyncTask delay=new DelayAsyncTask();
                delay.execute();
                while(sleeping){};
                break;
            }
        }
        finish();
class DelayAsyncTask extends AsyncTask<String, Void, Bitmap> {
    @Override
    protected Bitmap doInBackground(String... params) {
        try {
            Thread.sleep(5000);
        } catch(Exception e){
            e.printStackTrace();
        }
        return null;
    }
    @Override 
    protected void onPostExecute(Bitmap bitmap) {
        sleeping=false;
    }

} 
```

我正在使用一个变量“睡眠”来让主线程等待延迟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T13:51:04.830

只是猜测这个循环是在 UI 线程中的某个地方。这意味着您将阻塞 UI 线程，直到异步完成。这是一个不，不！为什么不只更新 onPostExecute 中的图像？就像是

```
class DelayAsyncTask extends AsyncTask<String, Void, Bitmap> {
    @Override
    protected Bitmap doInBackground(String... params) {
        try {
            Thread.sleep(5000);
        } catch(Exception e){
            e.printStackTrace();
        }
        return null;
    }
    @Override 
    protected void onPostExecute(Bitmap bitmap) {
        ivActionIcon.setImageResource(R.drawable.new_image);
    } 
```

显然也删除了这行代码（我想我从来不知道这样做的原因）。

```
while(sleeping){}; 
```

# spring - 没有可用连接时必须设置“hibernate.dialect”

> ID：10372924
> 
> 赞同：5
> 
> 时间：2012-04-29T14:32:54.680
> 
> 标签：spring, hibernate, hsqldb, c3p0

我正在尝试运行一个hello world：带有HSQLDB和C3PO连接池的Spring/Hibernate。相同的代码适用于 mySQL（仅适用于不同的方言和驱动程序）

我已经运行了数据库，并且可以使用 swing GUI 连接到它。但是当我尝试运行我的应用程序时，我遇到了启动错误。以下是详细信息：

1：错误 -

> 信息：初始化 Spring 根 WebApplicationContext [错误] [pool-2-thread-1 05:20:08] (JDBCExceptionReporter.java:logExceptions:101) 无法从底层数据库获取连接！[错误] [pool-2-thread-1 05:20:08] (ContextLoader.java:initWebApplicationContext:220) 上下文初始化失败 org.springframework.beans.factory.BeanCreationException：创建 ServletContext 中定义的名称为“sessionFactory”的 bean 时出错资源[/WEB-INF/hibernate-context.xml]：调用init方法失败；嵌套异常是 org.hibernate.HibernateException：当 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1420) 在 org.springframework.beans.factory 没有可用连接时，必须设置“hibernate.dialect” 。支持。

2：休眠上下文.xml -

```
<tx:annotation-driven transaction-manager="transactionManager" />

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="com.gleeb.sample.model" />
    <property name="hibernateProperties">
        <props>
            <!-- <prop key="dialect">org.hibernate.dialect.MySQL5InnoDBDialect</prop> -->
            <prop key="dialect">org.hibernate.dialect.HSQLDialect</prop>
            <prop key="show_sql">false</prop>
            <prop key="hbm2ddl.auto">create</prop>
        </props>
    </property>
</bean>

        <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
    destroy-method="close" p:driverClass="org.hsqldb.jdbc.JDBCDriver"
    p:jdbcUrl="jdbc:hsqldb:hsql://localhost/testdb" p:user="sa"
    p:password="" p:acquireIncrement="5" p:idleConnectionTestPeriod="60"
    p:maxPoolSize="100" p:maxStatements="50" p:minPoolSize="10" />

<!-- Declare a transaction manager -->
<bean id="transactionManager"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager"
    p:sessionFactory-ref="sessionFactory" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T00:22:39.337

据我所知，不可能将方言作为在 Spring Session Factory 的 hibernateProperties 字段上设置的值传递，至少如果您还使用`configLocation`它的属性。

我的hibernate.cfg.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
<session-factory>

    <property name="hibernate.dialect">org.hibernate.dialect.DB2Dialect</property>
    <property name="hibernate.search.autoregister_listeners">false</property>
    [etc...] 
```

我的相关会话工厂上下文配置：

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="configLocation">
        <value>classpath:hibernate.cfg.xml</value>
    </property>
    <property name="dataSource" ref="dataSource"/>
       <property name="hibernateProperties">
        <props>
            <!--<prop key="hibernate.dialect">org.hibernate.dialect.DB2Dialect</prop>-->
            <prop key="hibernate.show_sql">true</prop>
            <prop key="hibernate.format_sql">true</prop>
            <prop key="hibernate.generate_statistics">false</prop>
            <prop key="hibernate.default_schema">xxx</prop>
        </props>
    </property>
</bean> 
```

如果我在上下文文件中取消注释 dialect 属性，并在 hibernate.cfg.xml 文件中将其注释掉，我会遇到与 OP 相同的异常：

```
Caused by: org.hibernate.HibernateException: Connection cannot be null when 'hibernate.dialect' not set 
```

但是，如果我使用上述配置运行（在上下文文件中注释掉，在 hibernate.cfg.xml 中未注释），它可以工作，并且我看到格式化的休眠 SQL，表明上下文文件正在设置其他休眠属性.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:57:59.053

我有带`hibernate.`前缀的会话工厂属性。

```
<property name="hibernateProperties">
    <value>
        hibernate.dialect=org.hibernate.dialect.HSQLDialect
        hibernate.hbm2ddl.auto=update
        hibernate.show_sql=false
        hibernate.format_sql=false
    </value>
</property> 
```

# windows - 为什么我的窗口不会形成数据转发器调整大小？

> ID：10372931
> 
> 赞同：2
> 
> 时间：2012-04-29T14:33:25.347
> 
> 标签：windows, forms, dynamic, resize, datarepeater

搜索了几天后，我想也许有人可以帮助我。我正在制作一个 Windows 窗体应用程序。根据我的观点，我有一个带有标签的中继器。这个标签是动态大小的。但我的 DataRepeater 项目不会调整到我标签的大小。

有谁知道如何解决这个问题？

我使用的数据中继器来自visual basic powerpacks。如果需要更多信息来帮助我，请告诉我。

问候斯蒂芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T16:23:38.233

看起来 DataRepeater 在调整大小方面非常有限。我发现这个网站看起来好像可以正常工作，但所有项目的大小都调整为相同的大小。

[http://social.msdn.microsoft.com/forums/en-US/vbpowerpacks/thread/c93579f2-8b4c-4002-9ce2-152e2dddd10e/](http://social.msdn.microsoft.com/forums/en-US/vbpowerpacks/thread/c93579f2-8b4c-4002-9ce2-152e2dddd10e/)

编辑：这个解决方案有点复杂，但非常灵活：您可以使用 FlowLayoutPanel：

您为列表中的项目创建一个用户控件，并将选择属性添加到用户控件。您将用户控件列表添加到 FlowLayoutPanel。当用户控件改变大小时，它会自动调整 FlowLayoutPanel 中的所有内容。（禁用 WrapContents 以防止水平滚动）

[http://msdn.microsoft.com/en-us/library/ms171633.aspx](http://msdn.microsoft.com/en-us/library/ms171633.aspx)

您可以在 UserControl 中使用以下内容来启用单击用户控件以将其选中： [.Net (Windows Forms) 用户控件的单击事件](https://stackoverflow.com/questions/5820490/click-event-for-net-windows-forms-user-control)

在使用 FlowLayoutPanel 的表单中，添加 Click 事件，然后将 Select 应用于仅该一个用户控件。

您可以使用用户控件内的 SetBoundsControl 来设置项目的大小。

# mysql - COUNT() 返回不正确的行数

> ID：10372934
> 
> 赞同：4
> 
> 时间：2012-04-29T14:33:43.713
> 
> 标签：mysql, count

我正在使用 MySQL`COUNT()`方法来找出两个表中有多少行具有`uid`u.id。

为此，我使用以下方法：

```
SELECT u.id, u.first_name, u.last_name, u.email, u.username, COUNT( q.uid ) AS  `q_count`, COUNT( a.uid ) AS `a_count` 
FROM  `users` AS u
INNER JOIN `questions` AS q ON u.id = q.uid
INNER JOIN `answers` AS a ON u.id = a.uid
WHERE u.username =  'admin' 
```

但是，当我运行上述查询时，第二个计数返回的行数与第一个计数的行数相同。我知道这一点，因为第一个计数返回两个，第二个也做同样的事情，当表中有两行和`questions`表中有一行时`answers`。

请你能告诉我哪里出错了吗？

谢谢

* * *

我收到的样本：http: [//d.pr/i/vcnJ](http://d.pr/i/vcnJ)

样本数据来自`answers`：[http ://d.pr/i/TMkU](http://d.pr/i/TMkU)

样本数据来自`questions`：[http ://d.pr/i/tuwU](http://d.pr/i/tuwU)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T14:38:42.190

我相信原因是您正在执行 JOIN，它将将结果合并为一个。请使用相同的查询，但`SELECT *`改为使用，您会明白为什么会发生这种情况。

试试这个：

```
SELECT u.id, u.first_name, u.last_name, u.email, u.username, COUNT( DISTINCT q.id ) AS  `q_count`, COUNT( DISTINCT a.id ) AS `a_count` 
FROM  `users` AS u
INNER JOIN `questions` AS q ON u.id = q.uid
INNER JOIN `answers` AS a ON u.id = a.uid
WHERE u.username =  'admin' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:38:14.800

您不能在一个查询中计算两个表。`COUNT()`计算行数，而不是特定值。

但是，您可以做的是

```
SELECT u.id, u.first_name, u.last_name, u.email, u.username, 
SUM( CASE WHEN q.uid IS NULL THEN 0 ELSE 1 END ) AS  `q_count`, 
SUM( CASE WHEN a.uid IS NULL THEN 0 ELSE 1 END ) AS `a_count` 
FROM  `users` AS u
LEFT JOIN `questions` AS q ON u.id = q.uid
LEFT JOIN `answers` AS a ON u.id = a.uid
WHERE u.username =  'admin' 
```

# .net - 如何声明公共类

> ID：10372937
> 
> 赞同：0
> 
> 时间：2012-04-29T14:34:13.110
> 
> 标签：.net, c++-cli

我很抱歉这个听起来很愚蠢的问题:)

我有这样的代码行：

```
namespace Messages{
/// @brief Interface to support building a message during decoding.
class ValueMessageBuilder : public Common::Logger
.... 
```

`ValueMessageBuilder`由于此错误，我无法从我的 c# 项目中使用：

`Cannot access internal struct 'ValueMessageBuilder' here.`

所以我试图将其公开并重新编译dll：

`public class ValueMessageBuilder : public Common::Logger`

但是编译失败并出现此类错误`Error C3381: 'QuickFAST::Messages::ValueMessageBuilder' : assembly access specifiers are only available in code compiled with a /clr option F:\Oleg\quickfast_1_4_0_my\src\Messages\ValueMessageBuilder.h 17 1 QuickF‌​AST`

那么问题是如何将内部`ValueMessageBuilder`结构转换为公共结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:51:56.707

由于错误表明您的代码必须使用 /clr 选项（项目属性 | 常规 | 公共语言运行时支持）进行编译。之后，您的项目将变为 c++/clr（托管 c++）。另外我认为该类应该以*ref*关键字开头，以便在 c# 中可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T14:59:39.457

对于可从 C# 使用的类，它必须是具有 .NET 元数据的托管类型。

使用`ref class`或`value class`。

请注意，对象不能同时包含托管类和本机类类型。但是，本地类可以持有托管实例的句柄（使用`gcroot`），托管类型可以持有指向本地对象的指针（[我的智能指针，发布在 codereview 上，可能有助于生命周期管理](https://codereview.stackexchange.com/questions/1695/scoped-ptr-for-c-cli-ensure-managed-object-properly-frees-owned-native-object)）。

# android - ICS 上的 Android HTTPRequest 失败:(

> ID：10372940
> 
> 赞同：1
> 
> 时间：2012-04-29T14:34:30.063
> 
> 标签：android, android-4.0-ice-cream-sandwich

这是我发出http请求的示例代码，但它没有这样做。这是我在 LogCat 中看到的错误日志。[http://pastebin.com/56AL8Dxu](http://pastebin.com/56AL8Dxu) 我也在`<uses-permission android:name="android.permission.INTERNET"></uses-permission>`清单中添加了。请帮帮我..在Android中发出一个简单的http请求真的那么难吗？我来自.Net背景学习Android开发。

```
void testHTTP()
 {
  HttpClient httpClient = new DefaultHttpClient();

  HttpUriRequest request = new HttpPost("http://www.google.com");

  try {
   HttpResponse response = httpClient.execute(request);

   //System.out.println("response protocol version: " + response.getProtocolVersion());
  } catch (ClientProtocolException e) {
   // TODO Auto-generated catch block
   e.printStackTrace();
  } catch (IOException e) {
   // TODO Auto-generated catch block
   e.printStackTrace();
  }

 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-29T14:37:39.267

As stated in the Logcat log:

> 04-29 19:59:53.072: E/AndroidRuntime(546): android.os.NetworkOnMainThreadException

You perform `testHTTP()`, which involves networking on main thread, which is not allowed. Move it to a background thread, or use [`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T14:52:14.160

好的 Binyamin Sharet 是正确的，我引用了 Android 文档

> 当应用程序尝试在其主线程上执行网络操作时引发的异常。
> 
> 这仅针对面向 Honeycomb SDK (3.0) 或更高版本的应用程序抛出。允许以早期 SDK 版本为目标的应用程序在其主事件循环线程上进行网络连接，但非常不鼓励这样做。请参阅文档设计响应性。

# javascript - Javascript - 对 2 参数对象数组进行排序

> ID：10372941
> 
> 赞同：0
> 
> 时间：2012-04-29T14:34:32.583
> 
> 标签：javascript, arrays, sorting, sql-order-by

考虑以下数组：

```
var thingsThatMatter = [
    {"Colour of hair", "High"}, 
    {"Colour of eyes", "Low"}, 
    {"Colour of shoes", "Medium"}
]; 
```

为这个例子道歉，但这里的关键部分是高、中、低参数。
这就是我正在使用的数据（1,2,3 会更容易......！）

无论如何我可以轻松地对数组进行排序，以便项目按顺序运行 - 高、中、低？

或者，有没有一种方法可以“获取”具有“低”值作为优先级参数的项目？

*注意 - 这个结构稍后将更改为数字，但是现在，这是我必须使用的。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:35:57.390

[`Array.sort()`与自定义比较功能一起](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)使用。

* * *

在这里，有一个cookie：

```
var thingsThatMatter = [
    ["Colour of hair", "High"],
    ["Colour of eyes", "Low"],
    ["Colour of shoes", "Medium"]
];

function comparator(a, b) {
    a = comparator.priorities[a[1]];
    b = comparator.priorities[b[1]];

    if (a > b) return 1;
    if (a < b) return -1;
    return 0;
}

comparator.priorities = {
    High: 0,
    Medium: 1,
    Low: 2
}

thingsThatMatter.sort(comparator); 
```

[http://jsfiddle.net/mattball/T3hNm/](http://jsfiddle.net/mattball/T3hNm/)

# java - 如何用 HSQLDB 清空表？

> ID：10372942
> 
> 赞同：1
> 
> 时间：2012-04-29T14:34:36.350
> 
> 标签：java, hsqldb

我编写了这些 java 代码行来清空我的应用程序表，但在执行之后没有任何反应。

```
Class.forName("org.hsqldb.jdbc.JDBCDriver"); 
Connection con = DriverManager.getConnection("jdbc:hsqldb:file:ordini", "root", "root");
Statement stmt = con.createStatement();
if(ORDINI) stmt.executeUpdate("DELETE FROM ordini");
if(ORDINI_HISTORY) stmt.executeUpdate("DELETE FROM ordini_history");
if(PRODOTTI) stmt.executeUpdate("DELETE FROM prodotti"); 
```

我已经尝试过使用 TRUNCATE TABLE 语句，但是是一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:52:57.890

执行语句后，您的程序似乎立即退出。如果将此行添加到末尾，它应该可以工作：

```
stmt.executeUpdate("SHUTDOWN"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-25T16:53:38.210

`executeUpdate("TRUNCATE SCHEMA public AND COMMIT")`在这里回答 使用：[如何在每次测试后从我的 HSQLDB 中擦除数据？](https://stackoverflow.com/questions/4990410/how-can-i-wipe-data-from-my-hsqldb-after-every-test/4991969#4991969)

# wordpress - get_home_url() 只返回当前 URL

> ID：10372944
> 
> 赞同：13
> 
> 时间：2012-04-29T14:34:43.677
> 
> 标签：wordpress, url, wordpress-theming

我的问题很简单，我的 WP 模板需要一个“主页”链接，而函数`get_home_url()`只是返回当前 url。因此，如果我打开`"example.com/?cat=2"`，那就是我为我的主页按钮获得的 url。

任何想法我做错了什么？我正在拔头发。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-29T15:21:25.343

这只是 home_url()。所以：

```
echo home_url(); 
```

将输出您的 Wordpress 安装的主页。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-29T14:37:06.310

Have you tried:

```
echo get_bloginfo('url') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-28T05:30:05.323

您需要回显该功能，因此它应该是：

```
<?php echo get_home_url(); ?> 
```

# r - 在 RQDA 中调用 summaryCoding() 会引发错误

> ID：10372954
> 
> 赞同：0
> 
> 时间：2012-04-29T14:35:13.940
> 
> 标签：r, rqda

我正在尝试使用 RQDA 包。我尝试使用`summaryCoding()`(or `SummaryCoding()`or `summarycoding()`) 命令没有成功。`getCodingTable()`工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T15:58:00.880

您忘记了单词编码末尾的“s”，它应该是：

```
summaryCodings() 
```

（也尊重大写字母，R 区分大小写）。为避免此类问题，您可以使用 Rstudio，它提供代码完成功能。我在 YouTube 上制作了法语教程，你可以[在这里找到它们](http://www.youtube.com/playlist?list=PL52377017A7137925&feature=plcp)。要安装 R Studio 观看视频 2 3 或 4（windows linux 或 mac）。要了解如何使用命令提示符，请观看视频 20。全部是法语，但通过观看视频，即使您不会说法语，您也可以理解它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T18:34:14.097

编码后，您可以将代码放入类别代码中。有时，相同的代码会出现在许多类别代码中。然后您可以创建一个图表（参见视频 18）。您也有 crossCodes()... 但通常很难在定性研究中放入大量数字。就我个人而言，我检索每个“代码类别”的代码，并且我毫不犹豫地在我的书面分析文档中引用了很多代码。如果我的文件是采访，我通常会将演讲者的意见与科学文章中的其他研究联系起来，例如......

# mysql - MySQL“KEY”关键字

> ID：10372956
> 
> 赞同：9
> 
> 时间：2012-04-29T14:35:21.267
> 
> 标签：mysql

```
CREATE TABLE IF NOT EXISTS `scores` (
  `userID` int(11) NOT NULL,
  `sessionID` int(11) NOT NULL,
  `points` double NOT NULL DEFAULT '0',
  PRIMARY KEY (`userID`,`sessionID`),
  KEY `par_ind1` (`userID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

该行做什么：

```
KEY `par_ind1` (`userID`) 
```

做？（`userID`是另一个表中的主键吗？）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-29T14:36:49.297

`KEY`是 的同义词`INDEX`。除了它已经共享的复合键之外，这还会创建一个名为`par_ind1`ont 的索引。`userID``sessionID`

有关完整的详细信息，请参阅[MySQL`CREATE TABLE`](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)文档，但这里的相关部分是：

```
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name
    { LIKE old_tbl_name | (LIKE old_tbl_name) }
create_definition:
    col_name column_definition
  | [CONSTRAINT [symbol]] PRIMARY KEY [index_type] (index_col_name,...)
      [index_option] ...

  /* Key/Index creation */
  | {INDEX|KEY} [index_name] [index_type] (index_col_name,...)
      [index_option] ... 
```

由于没有`index_type`指定，所以使用默认值。请参阅[`CREATE INDEX`参考](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)以了解默认索引类型，这些类型因表存储引擎而异。对于这样的 InnoDB 表，这是一个`BTREE`索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-29T14:36:39.543

它在该列上创建一个辅助的、非唯一的索引。在这种情况下，您可以使用`INDEX`和`KEY`互换。

# c# - C# 钩子：System.Random

> ID：10372957
> 
> 赞同：0
> 
> 时间：2012-04-29T14:35:22.507
> 
> 标签：c#, random, hook, random-seed

我想监控一个使用`System.Random`该类的软件。
我希望能够：

1/ 监控所有随机实例的创建
2/ 强制此实例使用的种子
或 2bis/ 将随机结果强制为我自己的随机

我需要软件始终保持相同的行为，即使在不同的计算机上也是如此，这样我就可以更好地测试与它通信的自己的软件。

我读过 EasyHook 的教程，但我认为他们只提到函数挂钩，而不是类创建或类方法挂钩。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T15:04:26.273

.NET 框架没有提供挂钩方法调用的良好机制。即时编译器以及 ngen.exe 预抖动使这无法实现。没有很好的方法来获取方法的地址，也没有任何体面的方法来修补代码，因为这是在没有任何间接跳转的情况下完成的。例如，像 EasyHook 这样的钩子所依赖的 DLL 导入表中存在的那种跳转。

这需要在抖动看到代码*之前弄乱。*PostSharp等面向方面的编程工具也是这样做的。它们是 IL 重写器，它们会在您运行代码之前修改程序集。因此，该方案是用调用您的方法替换 IL 中对 System.Random 的调用。并添加对您的程序集的依赖项。

“IL 重写”是一个很好的谷歌搜索词来查找实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T15:34:04.960

“IL 重写”似乎是您最好的选择，但如果它在 kernel32 中调用[GetTickCount() ，则可以检测和更改默认实例创建：](http://msdn.microsoft.com/en-us/library/ms724408%28VS.85%29.aspx)

```
public Random() : this(Environment.TickCount)
{
} 
```

我真的不知道 Environment.TickCount 是否真的调用[GetTickCount()](http://msdn.microsoft.com/en-us/library/ms724408%28VS.85%29.aspx)。但这是[有道理](https://stackoverflow.com/questions/1858989/is-environment-tickcount-affected-by-system-time-adjustments)的。

# git - Shell 脚本不评估由 '--' 进行的参数

> ID：10372958
> 
> 赞同：2
> 
> 时间：2012-04-29T14:35:26.287
> 
> 标签：git, bash, arguments

我正在编写一个 shell 脚本，或者我应该更具体地说，是一个 ZSH 函数，并且我正在使用各种简短的命令来检查 git 存储库等内容的状态。

但是，我在使用一个特定命令时遇到了很多麻烦。在另一个 stackoverflow 帖子中，我找到了打印 git 存储库的根文件夹的命令：

```
git rev-parse --show-top-level 
```

在我实际的 zsh 实例中，如果我执行

```
$(git rev-parse --show-top-level) 
```

返回适当的值，一切都很好。但是，我脚本中的这种方法效果不佳。我将提供一些背景信息：

```
[ $(git status &>/dev/null) $? -eq "0" ] && {
    git_name=$("git rev-parse --show-top-level")
    echo $(eval $git_name)
} 
```

现在我不了解你，但在我看来，这似乎是*错误*的做法（不是第一行；我可以接受）。其输出大致为：

```
command not found: git rev-parse --show-top-level 
```

看来我应该写这个的方式是：

```
[ $(git status &>/dev/null) $? -eq "0" ] && {
    git_name=$(git rev-parse --show-top-level)
    echo $git_name
} 
```

这个的输出是：

```
--show-top-level 
```

退出状态为0。

我的问题是，为什么这些都不起作用，实现它的正确方法是什么？我的猜测是它与空格后有一个双虚线参数有关，最后一个长参数被视为命令本身（至少在第二个示例中），但这是我直觉的范围。

帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:40:48.687

试试这个：

```
[ $(git status &>/dev/null) $? -eq "0" ] && {
    git_name=$(git rev-parse --show-toplevel)
    echo $(eval $git_name)
} 
```

周围的双引号`git rev-parse`是不必要的，参数应该是`--show-toplevel`，而不是`--show-top-level`。

# video - 在 adobe air 中精确查找本地视频

> ID：10372959
> 
> 赞同：0
> 
> 时间：2012-04-29T14:35:53.617
> 
> 标签：video, air

我想用 adobe air 制作一个应用程序来观看视频。优先级是使用 seek(framneNumber) 进行粒度非常细的搜索。我正在使用来自 FLVPlayebackAS3.swc 的 FLVPlayback 对象：

```
import fl.video.FLVPlayback; 
```

首先，我不了解我的搜索精度：它真的是在任何帧中还是仅在 GOF 的 I 帧中（视频压缩中使用的帧组 - 编码）。

然后我正在寻找一种干净的方式来寻找框架。我使用了这段代码：

```
 private function getFrameRate():int {
        if(playerFLV.metadataLoaded) return playerFLV.metadata.videoframerate;
        else return -1;
    }

    private function seek(frame:int):void {
        if(getFrameRate()>0)
            playerFLV.seek( frame / getFrameRate() );
    } 
```

但有时似乎不够精确

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:30:05.007

seek(time:Number) 函数需要一个时间 int，其精度限制为毫秒的 3 位小数。根据您上面的计算，一个框架可能会超出这个范围。

作为快速检查，您确定 getFrameRate() 是否返回任何内容？不应该是：

```
if(playerFLV.metadataLoaded) return playerFLV.metadata.framerate; 
```

metadata.framerate 将为您提供 flv 帧速率，如果您不关心音频，可以尝试使用：

```
playerFLV.metadata.videodatarate 
```

至于两部分的问题：

**RE-首先我不了解我的搜索精度：它真的在任何帧中还是仅在 GOF 的 I 帧中（视频压缩中使用的帧组 - 编码）。**

***如果视频是渐进式下载：***

Seek 将搜索到某个时间，然后播放组件将显示之后的第一个关键帧。

***如果视频正在流式传输：***

FMS 将在该确切时间生成所需的关键帧。

如果您不关心文件大小，也许另一种解决方案是使用更多关键帧对 flv 进行编码，或者如果您确实控制了视频的编码并且它们是渐进式的，那么我建议在您想要寻找视频的每一帧上添加 Que 点到。

# java - J2ME 和 LWUIT 中的多线程

> ID：10372960
> 
> 赞同：-3
> 
> 时间：2012-04-29T14:35:55.643
> 
> 标签：java, multithreading, java-me, lwuit

我想在我使用 LWUIT 从 Web 服务加载一些数据时显示对话框，

以下是代码

```
public class LoaderAnimation extends Container implements Runnable {

private Thread t;
private boolean running = false;

public LoaderAnimation() {
}

public void start() {
    running = true;
    t = new Thread(this);
    t.start();
}

public void run() {
    while (running) {

            // do something
            t.sleep(150);
    }
}

public void stop() {
    running = false;
}
} 
```

现在它运行但调用 Web 服务的代码停止工作会发生什么

这就是它的召唤

```
public static void showLoaderScreen ()
    {
        dialog = new Dialog();
        dialog.setLayout(new BorderLayout());
        canvas = new LoaderAnimation();
        dialog.addComponent(BorderLayout.CENTER , canvas);
        canvas.start();
        dialog.show();
    }

public static void dismissLoaderScreen ()
{
    canvas.stop();
    dialog.dispose();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T06:05:45.830

试试这段代码。

```
private void startLoader() {
    Dialog d = new Dialog();
    d.getStyle().setBgColor(0xffffff);
    d.getStyle().setBgTransparency(255);
    d.show(100, 250, 90, 150, true, false);
    d.setAutoDispose(true);
    try {
        Thread.sleep(30);
    } catch (InterruptedException ex) {
        ex.printStackTrace();
    }
    d.dispose();
    new Timer().schedule(new TimerTask() {

        public void run() {

            new Loader().start();
        }
    }, 30);
} 
```

Loader 类，我们可以编写解析内容或 Web 服务处理等。

```
 class Loader extends Thread 

{        public void run() {

            try {

                ServiceTypesScreen st = new ServiceTypesScreen();
                st.init();
            } catch (Exception e) {                    
                e.printStackTrace();
            }

        }
} 
```

# r - 在集群上运行聚类分析会导致其中一个节点崩溃

> ID：10372965
> 
> 赞同：1
> 
> 时间：2012-04-29T14:36:02.107
> 
> 标签：r, parallel-processing, cluster-analysis, cluster-computing

我是具有 22 个节点的 Rocks 4.3 集群的用户。我正在使用它在 200 万行和 100 列的数据集上运行聚类函数 - parPvclust（它将列中的样本名称聚类）。为了运行 parPvclust，我使用了一个嵌入了一些 R 代码的 C-shell 脚本。使用下面的 R 代码和 200 万行和 100 列的数据集，我总是使其中一个节点崩溃。

```
library("Rmpi")
library("pvclust")
library("snow")

cl <- makeCluster()
load("dataset.RData") # dataset.m: 2 million rows x 100 columns
# subset.m <- dataset.m[1:200000,] # 200 000 rows x 100 columns
output <- parPvclust(cl, dataset.m, method.dist="correlation", method.hclust="ward",nboot=500)
save(output,"clust.RData") 
```

我知道 C-shell 脚本代码有效，并且我知道 R 代码实际上适用于较小的数据集，因为如果我使用数据集的子集（上面注释掉），代码运行良好并且我得到输出。同样，如果我使用非并行版本（即 pvclust），也可以正常工作，尽管运行非并行版本会破坏并行运行速度的增益。

parPvclust 函数需要 Rmpi​​ 和 snow R 包（用于并行化）和[pvclust](http://www.is.titech.ac.jp/~shimo/prog/pvclust/)包。

以下可以产生我正在使用的数据集的合理近似值：

```
 dataset <- matrix(unlist(lapply(rnorm(n=2000,0,1),rep,sample.int(1000,1))),ncol=100,nrow=2000000) 
```

关于为什么我总是用较大的数据集而不是较小的数据集使节点崩溃，有什么想法吗？

# php - 不能在 UPDATE 查询中使用子查询？

> ID：10372967
> 
> 赞同：1
> 
> 时间：2012-04-29T14:36:16.487
> 
> 标签：php, mysql, sql

当我使用此查询时，MySQL 向我显示“HY000”错误：“您无法在 FROM 子句中指定目标表 'msg_pv' 进行更新”。

问题似乎是查询和子查询针对同一个表......但这是我需要做的！

```
 <?php  $requete = $pdo->prepare('UPDATE msg_pv SET 
        lu=:lu
        WHERE id_ref_msg = :id_ref_msg AND date_message > ( SELECT MIN(date_message) FROM msg_pv WHERE id_ref_msg = :id_ref_msg AND lu="0" )'); 
```

注意：我已经使用 INNER JOIN 在其他帖子中阅读了一些解决方案，但它适用于不同的表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:41:58.790

像这样试试

```
UPDATE
  msg_pv AS t1
CROSS JOIN (
  SELECT MIN(date_message) AS date_message FROM msg_pv
  WHERE id_ref_msg = :id_ref_msg AND lu="0"
) AS t2
SET
  t1.lu = :lu
WHERE
  t1.date_message > t2.date_message 
```

# java - 将方法转换为 JAVA 中的 Web 服务

> ID：10372980
> 
> 赞同：0
> 
> 时间：2012-04-29T14:37:08.260
> 
> 标签：java, service, web

我目前正在将遗留的 JAVA 数据驱动的 Web 应用程序改造成 MVC 模型。在返工时，我意识到几乎所有的 servlet 都调用一个 getID() 方法和近 10 个其他方法。我正在考虑将这些方法调用转换为服务。这将是我的第一个 Web 服务开发。我使用 Eclipse 和 weblogic。当我在网上阅读时，有人可以简要介绍一下如何实现这一目标以抢占先机吗？另一个问题是，这些服务是从业务类、servlet 或 jsp 中调用的，还是从所有这些中调用的？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:55:54.460

Web 服务可以指 XML-RCP、SOAP 或 REST。对我来说，Web 服务意味着“通过 HTTP 调用网络组件”。如果您同意，您可以简单地将这些方法重构为另一个 servlet 并将其称为服务。

除非需要，否则不要使用 XML 请求/响应。

我不会从业务类调用服务。Servlet 和 JSP 都在 Web 层，所以我都可以调用 Web 服务（例如，来自页面的 AJAX 调用）。

但我更喜欢有一个真正的服务层，服务调用服务。与将这些内容嵌入 Web 层相比，服务层更具可重用性。如果您使用移动 UI，所有这些代码会发生什么？Web 层应该验证和绑定输入参数，调用服务来实现用例，并打包响应以供显示。让服务完成繁重的工作。

# sql - sql/coldfusion 选择具有重复字段的行

> ID：10372982
> 
> 赞同：0
> 
> 时间：2012-04-29T14:37:15.437
> 
> 标签：sql, coldfusion

这是我的桌子

```
产品 ID 显示 UPC
10 0 0553
14 0 0753
11 1 0753
17 1 0453

```

如果您注意到，第 2 行和第 3 行具有相同的 UPC。我想选择 display = 0 和 upc 的所有行与 display = 1 的行相同。所以在我的表中我只想选择第 2 行。到目前为止，这是我的coldfusion代码不起作用。请指教。

```
<cfquery name="GetData" datasource="#Application.ds#" dbtype="ODBC" username="#Application.UserName#" password="#Application.Password#">
Select ProductID, Display, UPC
From Products
Where Display = 0
...
</cfquery> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T15:10:25.220

您在寻找正确的查询吗？我想说实现这一目标的方法不止一种。对我来说，这个可以在你的例子和 mysql 上完成：

```
SELECT 
  p1.ProductID, p1.Display, p1.UPC
FROM
  Products as p1, Products as p2
WHERE
  p1.UPC=p2.UPC and p1.Display=0 and p2.Display=1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T06:19:36.250

当您只使用过滤器时，使用 exists(select 1...) 比子选择或连接更有效。

```
<cfquery name="GetData" datasource="#Application.ds#" dbtype="ODBC" username="#Application.UserName#" password="#Application.Password#">
select ProductID, Display, UPC
from Products p
where Display = 0
and exists (
    select 1 from Products p2
    where p.UPC = p2.UPC
    and p2.Display = 1
)
</cfquery> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T17:32:50.507

以前的答案应该有效或选择子选择选项

```
<cfquery name="GetData" datasource="#Application.ds#" dbtype="ODBC" username="#Application.UserName#" password="#Application.Password#">
Select t1.ProductID, t1.Display, t1.UPC
From Products t1
Where t1.Display = 0 and
      t1.UPC = (Select t2.UPC 
                  From Products t2
                 Where t2.Display = 1)             
</cfquery> 
```

# python - appending value in python and writing to a file

> ID：10372984
> 
> 赞同：0
> 
> 时间：2012-04-29T14:37:31.237
> 
> 标签：python, list, file-io, append, classification

I have made a classifier in Python and it works fine. Now I need to output the results into a text file, which I can also do without a problem. The problem is, I need to include the id of the result as well as the result itself. I am new to python and still getting used to the syntax so any help would be greatly appreciated.

```
 printedRow = '{id1},{result1}'.format(id1=id , result1 = result)
    print("~~~~~RESULT~~~~~")

    for k in range(0,len(pans)):
         pans.append(row[0] + ','+ p.classify(row))

    print (pans)
    print(pans, file=outfile) 
```

The id that I need to include with the results of the classifier is being held in the index row[0]. When I run this code, the same id is printed with every result. The results are printing out fine, I just need to be able to match the id with the result.

They are both held in lists and there are about 2000 values in each list.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T15:14:25.987

我不确定您要做什么，因为您没有定义什么`row`或是什么`pans`。考虑使用更多 Pythonic 源代码。如果对象是任何类型的集合，则使用某种迭代器。枚举对于给每个循环一个索引号很有用。

```
for n, p in enumerate(pans):
    print "pan %d is %s" % (n, p) 
```

您似乎还附加到`pans`一个大小取决于`pans`. 那可以永远持续下去！

如果要添加到列表中，只需添加它，例如：

```
newpans = pans + [x.classify(row) for x in oldpans] 
```

与其在内存中建立结构，然后将其打印到文件中，不如直接写入文件。这将占用更少的内存。如果你想要速度，让计算机为你缓冲文件，例如

```
f = open("output.txt", "w")
for n, p in enumerate(pans):
    f.write("%s,%s\n" % (n, classify(p)))
f.close() 
```

# php - 如果存在于 PHP 中的另一个数组中，则从数组中过滤出重复项

> ID：10372986
> 
> 赞同：0
> 
> 时间：2012-04-29T14:37:42.063
> 
> 标签：php, arrays

如果我有 2 个包含名称的 PHP 数组。第一个数组包含超过 100,000 个键

第二个数组只有 10,000 个或更少的键

如果密钥存在于主 100k 数组中，我需要从我的 10,000 个密钥数组中过滤掉任何名称

所以我最终会得到一个包含 10,000 个键数组减去主数组中存在的任何项目的第三个数组。

这对我来说有点令人困惑，所以我希望我在这里有意义。如果您能提供帮助，我将不胜感激。

示例数组可能如下所示（两个数组的格式相同）

```
array(
    'Coders4africa',
    'uiri00',
    'phileverson',
    'nileshgr',
    'MSVenom',
    'dshafik',
    'rafavilar'
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T14:40:50.383

```
array_diff($array1, $array2) 
```

从[文档](http://php.net/array_diff)中：返回一个数组，其中包含 array1 中不存在于任何其他数组中的所有条目。

# ruby-on-rails - How does Rails group arrays of hashes during form submission?

> ID：10372989
> 
> 赞同：6
> 
> 时间：2012-04-29T14:38:17.143
> 
> 标签：ruby-on-rails

According to the [Rails Guides](http://guides.rubyonrails.org/form_helpers.html#combining-them) and [this](http://railscasts.com/episodes/73-complex-forms-part-1) Railscasts episode, when there's a *one-to-many* association between two objects (e.g. `Project` and `Task`), we can submit multiple instances of `Task` together with the `Project` during form submission similar to this:

```
<% form_for :project, :url => projects_path do |f| %>
  <p>
    Name: <%= f.text_field :name %>
  </p>
  <% for task in @project.tasks %>
    <% fields_for "project[task_attributes][]", task do |task_form| %>
      <p>
        Task Name: <%= task_form.text_field :name %>
    Task Duration: <%= task_form.text_field :duration %>
      </p>
    <% end %>
  <% end %>
  <p><%= submit_tag "Create Project" %></p>
<% end %> 
```

This will result multiple copies of an HTML block like this in the form, one for each task:

```
<p>
    Task Name: <input name="project[task_attributes][name]">
    Task Duration: <input name="project[task_attributes][duration]">
</p> 
```

My question is, how does Rails understand which

```
 (project[task_attributes][name], project[task_attributes][duration]) 
```

belong together, and packing them into a hash element of the resulting array in `params`? Is it guaranteed that the browsers must send the form parameters in the same order in which they appear in the source?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-03-31T12:52:55.133

是的，订单按原样保留，因为@k-everest 自我回答作为对原始问题的评论。

那些要求 HTML 的人，请参阅有关如何解析属性的[指南。](http://guides.rubyonrails.org/form_helpers.html#combining-them)`name`

典型的错误排序示例：

```
cart[items][][id]=5
cart[items][][id]=6
cart[items][][name]=i1
cart[items][][name]=i2 
```

Rails 将其解析为：

```
{ "cart"=> {"items"=> [
                        {"id"=>"5"},
                        {"id"=>"6", "name"=>"i1"},
                        {"name"=>"i2"}
                       ]}} 
```

示例来源：[https ://spin.atomicobject.com/2012/07/11/get-and-post-parameter-parsing-in-rails-2/](https://spin.atomicobject.com/2012/07/11/get-and-post-parameter-parsing-in-rails-2/)

该功能是在 Rails 的初始提交中添加的，方法名称为`build_deep_hash`。要了解更多历史，请跳过火焰/语义大战，然后从最后开始阅读最后一篇文章：[https ://www.ruby-forum.com/topic/215584](https://www.ruby-forum.com/topic/215584)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-19T00:36:36.377

如果您正在处理直接数据并希望在不使用任何这些@objects 的情况下发回数组

```
<%= form_for :team do |t| %>
  <%= t.fields_for 'people[]', [] do |p| %>
    First Name: <%= p.text_field :first_name %>
    Last Name: <%= p.text_field :last_name %>
  <% end %>
<% end %> 
```

你的参数数据应该像这样返回

```
"team" => {
  "people" => [
    {"first_name" => "Michael", "last_name" => "Jordan"},
    {"first_name" => "Steve", "last_name" => "Jobs"},
    {"first_name" => "Barack", "last_name" => "Obama"}
  ]
} 
```

# facebook-apps - Facebook Page Tab app not appearing to non-page admin users

> ID：10372990
> 
> 赞同：0
> 
> 时间：2012-04-29T14:38:22.630
> 
> 标签：facebook-apps

I am experiencing a problem similar to 2 others who have recently written about this issue.

A newly created Page Tab Facebook app displays for admin users but not for regular users. I only have 8 page tabs currently so it cannot be that there are too many. Also, sandbox mode is disabled ( have tried both enabled and disabled).

Can anyone think of a reason that this might be occurring?

I added the tab with the code:

[http://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&next=YOUR_URL](http://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&next=YOUR_URL)

Could it have something to do with https in the url as opposed to http?

I am at a loss and do not know how to go about solving this issue.

Any ideas, however far-out they may be,would be aprreciated.

Thank you to anyone who might think they can help...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T05:05:58.773

您是否忘记将应用程序退出沙盒模式？（尝试切换它以防万一，即使它不在沙盒模式下，因为这是迄今为止最有可能的解释）

此外，请检查是否通过 API 在应用程序或页面上设置人口统计限制，因为在这种情况下，只有满足限制的用户才能看到该选项卡。（尽管管理员总是会看到它）

还要检查您是否正确配置了应用程序的页面选项卡 URL 和安全页面选项卡 URL 设置，就像用户使用 HTTPS 并且应用程序不支持它一样，他们将看不到选项卡

如果选项卡根本没有出现，它几乎肯定是这两个问题之一，如果它正在显示但内容没有呈现，还要检查你的代码并确保它在检查`signed_request`非管理员或类似的东西时不会致命

# c++ - a class inherited from two class, with the same function prototype, conflict with each other

> ID：10372992
> 
> 赞同：4
> 
> 时间：2012-04-29T14:38:29.117
> 
> 标签：c++, inheritance

I am working on a Ray Tracing task, here is the problematic source:

```
class Geometry
{
    public:
        virtual RayTask *intersectionTest(const Ray &ray) = 0;
};

class Sphere : public Geometry
{
    public:
        RayTask *intersectionTest(const Ray &ray);
};

class BoundingVolume
{
    public:
        virtual bool intersectionTest(const Ray &ray) = 0;
};

class BoundingSphere : public Sphere, BoundingVolume
{
    public:
        bool intersectionTest(const Ray &ray) // I want this to be inherited from BoundingVolume
        {
            return Sphere::intersectionTest(ray) != NULL; // use method in Sphere
        }
}; 
```

source above can not compile, error information:

```
error: conflicting return type specified for ‘virtual bool BoundingSphere::intersectionTest(const Ray&)’
error:   overriding ‘virtual RayTask Sphere::intersectionTest(const Ray&) 
```

I want to implement BoundingSphere::intersectionTest using method in Sphere, so I need to inherit from both BoundingVolume and Sphere. but due to inherit functions that has the same parameter list with different return type, things messed up...

I do not want to duplicate codes with the same functionality... could any one give me a solution?...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T18:42:18.657

编译器试图覆盖两个具有不同返回类型的虚方法，这是不允许的：如果编译器不知道返回类型是什么，它如何知道为函数调用分配多少内存？这两个方法不能有相同的名称；尝试将一个更改为更合适的含义。

如果您认为这些名称最能代表它们都提供的操作的含义（我不确定），我还建议您仔细考虑您的层次结构。球体`BoundingVolume`真的是一个`Sphere`吗？也许不是：它是根据`Sphere`（私有继承，不能解决你的问题）实现的，或者它有一个`Sphere`（组合，在这个简单的情况下会解决你的问题）。但是，后一种情况可能会给移动复杂类带来问题，因为您希望 a`BoundingSphere`拥有`Sphere`. 或者，也许，您需要区分s`BoundingVolumes`和 normal `Geometry`s 吗？

该问题的另一种解决方案是对这些层次结构中的一个使用非成员函数，并使用 Koenig 查找（参数的类型）调用正确的版本。我不能说不知道你的层次结构是什么样的。但是请考虑您的设计：如果您有同名操作给您返回完全不同的语义结果，那么该操作是否正确命名/设计？

# c++ - 将类的属性泄漏给它的组件

> ID：10372994
> 
> 赞同：3
> 
> 时间：2012-04-29T14:38:39.390
> 
> 标签：c++, oop, composition

我有以下课程：

```
class A {
    // Whatever
};

class B {
    T attribute;
    A a;
}; 
```

现在假设我有以下情况：

```
A aX, aY;  
B bX, bY; 
```

现在我可以“插入”`aX`或`aY`进入`bX`或`bY`。

我想让 A 类型的对象知道它们在什么 B 中，或者换句话说，`attribute`它们的“超类”B 的“”是 什么。

**问题：**

我希望能够在它们的“超类”B 之间自由移动 A 类型的对象，我需要一种在运行时动态地**将 B 的属性泄漏给它们的方法，****所以 A 类型的对象总是知道它们属于什么 B to**（或者他们当前所在的 B 的属性是什么）。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:42:54.157

你可以做的一件事是给它的“父母”`A`一个指针：`B`

```
class A {
public:
  A() : b_(0) {}
  explicit A(B* parent) : b_(parent) {}
private:
  B* b_;
};

class B {
  B() : a(this) {}
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T14:54:12.850

也许这很有用（从所有者指向属性的指针，反之亦然）：

```
class A;

class B {
    T attribute;
    A* a;
public:
   void setA(A* newA);
   T getAttribute() {return attribute;}
   void setAttribute() {/*some code*/}
};

class A {
   B* Owner;
   friend void B::setA(A* newA);
public:
    void setOwner(B* newOwner) {
        newOwner->setA(this);
    }
};

void B::setA(A* newA)
{
    A* tempA = this->a;
    B* tempB = newA->Owner;

    tempA->Owner = NULL;
    tempB->a = NULL;

    this->a = newA;
    newA->Owner = this;
} 
```

**更新：**修复了循环指向和循环调用的错误，只能通过友元函数解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T14:46:15.730

将“B”类定义为接口。制作“getAttribute”方法并将“B”的指针设置为“A”类的实例。现在您可以制作“B”类的孩子并向他们添加“A”类，“A”类总是可以知道“B”的属性。

```
class A 
{
    // Whatever
    B* pointerToB;
    void setB(B* b){ pointerToB = b; }
};

class B 
{
    virtual void someMethod() = 0;
    void addA(A* a)
    {
       a->setB(this);
       this->a = *a;
    }  
    T getAttribute(){ return attribute; }
    T attribute;
    A a;
};

class BB : public B {} // define BB's someMethod version or more method's 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-29T15:00:22.827

您可以设置指向`B`in的指针并使用对in`A`的引用来直接从对象中获取所需的内容：`A``B``A`

```
#include <iostream>

class B;

class A {
    B *_b;
public:
    void setB(B *b) {
        _b = b;
    }

    B *getB() {
        return _b;
    }
};

class B {
    int _attribute;
    A &_a;
public:
    B(A& a, int attribute) : _attribute(attribute), _a(a) {
        _a.setB(this);
    }

    int getAttribute() {
        return _attribute;
    }
};

int main(int argc, const char *argv[])
{
    A a1;
    B b1(a1, 5);

    A a2;
    B b2(a2, 10);

    std::cout << a1.getB()->getAttribute() << std::endl;
    std::cout << a2.getB()->getAttribute() << std::endl;

    return 0;
} 
```

输出：

```
5
10 
```

# sql - INSERT statement conflicted with COLUMN FOREIGN KEY

> ID：10372999
> 
> 赞同：6
> 
> 时间：2012-04-29T14:39:00.550
> 
> 标签：sql, sql-server, sql-server-2008

I have a FK in my table that looks like this:

![FK](../Images/afb3a92d1274b41dd1ac9911c78998df.png)

Clearly, I should be able to insert `NULL` into this column as well as any value that exists in the parent table.

But when I try to insert `NULL`, I get the following error:

> The INSERT statement conflicted with the FOREIGN KEY constraint "users_fk". The conflict occurred in database "mydatabase", table "dbo.country", column 'country_id'.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-29T20:12:16.400

You are absolutely right - you should be able to insert `NULL` into this column.

Are you **500% sure** that you are? The error message says something else - it appears as if you're inserting an invalid value.

Could it be that you have

(a) another line in your script that inserts additional (invalid) values?

Or

(b) do you happen to have a trigger on this table that does something invalid?

**Update:** (based on your comment)
If you're **not** specifying the column in the `INSERT` statement - then maybe an invalid **default value** is defined on that column? Something like a default of `0` or something.

If you do have a default value - that default value will be inserted (and not `NULL`, as you seem to be expecting)