# StackOverflow 问答 10761000-10761999

# django - save方法中模型类的使用方法

> ID：10761001
> 
> 赞同：0
> 
> 时间：2012-05-25T20:31:18.320
> 
> 标签：django, django-models

我正在尝试覆盖我的一个模型的保存方法。在该保存方法中，我想使用模型的另一种方法，如下所示：

```
class MyModel(models.Model):
    name = models.CharField(max_length=255)

    def do_something(self):
        pass

    def save(self,*args, **kwargs):
        self.do_something()
        super(MyModel, self).save(*args, **kwargs) 
```

这不起作用，因为当 django 执行保存时，该对象是通用 ModelBase 类，而不是我的 ModeBase 子类。所以我得到：

```
unbound method do_something() must be called with MyModel instance as first argument (got ModelBase instance instead) 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:33:32.017

您也应该放置`args`和`kwargs`覆盖`save()`方法：

```
class MyModel(models.Model):
    name = models.CharField(max_length=255)

    def do_something(self):
        pass

    def save(self, *args, **kwargs):
        self.do_something()
        super(MyModel, self).save(*args, **kwargs) 
```

您还忘记了`self`参数`do_something()`！

**更新**

我不太明白你的问题。如果您想调用未绑定的方法`do_something`，请在类外部定义它，然后像 `do_something(self) 一样`MyModel`调用它：`save()`

```
class MyModel(class.Model):
  def save(self, *args, **kwargs):
    do_something(self)
    super(MyModel, self).save(*args, **kwargs)

def do_someting(my_model_instance):
  assert isinstance(my_model_instance, MyModel)
  ... 
```

# ruby-on-rails-3 - 如何让 Capistrano 在 deploy:create_symlink 时停止失败？

> ID：10761003
> 
> 赞同：1
> 
> 时间：2012-05-25T20:31:24.137
> 
> 标签：ruby-on-rails-3, capistrano

至少这就是 capistrano 失败的地方。它在部署过程中一直到最后。这是输出。

```
* executing `deploy:create_symlink'
* executing "rm -f ~/xxx.xx.xx/test/current && ln -s ~/xxx.xx.xx/test/releases/20120525193307 ~/xxx.xx.xx/test/current"
servers: ["test.xxx.xx.xx"]
["test.xxx.xx.xx"] executing command
 ** [out :: test.xxx.xx.xx] rm: cannot remove `/var/www/vhosts/xxx.xx.xx/test/current': I command finished in 460ms
*** [deploy:create_symlink] rolling back
*** no previous release to rollback to, rollback of symlink skipped
* executing "rm -rf /var/www/vhosts/xxx.xx.xx/test/releases/20120525195909; true"
servers: ["test.xxx.xx.xx"]
[test.xxx.xx.xx] executing command
command finished in 524ms
failed: "rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell 'default' -c 'rm -f /var/www/vhosts/xxx.xx.xx/test/current && ln -s /var/www/vhosts/xxx.xx.xx/test/releases/20120525195909 /var/www/vhosts/xxx.xx.xx/test/current'" on xxx.xx.xx 
```

该应用程序正在使用 capistrano (2.12.0) capistrano-ext (1.2.1) 显然有更多的宝石只是试图放置看起来相关的东西，如果更多信息会有所帮助，请告诉我。

这是deploy.rb

```
require "rvm/capistrano"
require 'bundler/capistrano'
require 'capistrano/ext/multistage'

set :stages, %w(staging production)
set :default_stage, 'staging'

set :application, 'xxx'

# trying to not use sudo on the deployment
#set :use_sudo, false

#set :copy_exclude, [".git", "spec"]

set :repository,  '~/git/xxx.git'
set :local_repository, "~/rorwork/xxx/.git"
set :scm, :git
set :user, 'xxx'
set :group, 'xxxx'
ssh_options[:forward_agent] = true
set :branch, 'master'
set :deploy_via, :remote_cache
set :scm_command, "/usr/local/bin/git"
set :local_scm_command, :default
default_run_options[:pty] = true
set :normalize_asset_timestamps, false #for asset piple

set :dbuser, 'xxx'
set :dbpass, 'xxx'

# if you want to clean up old releases on each deploy uncomment this:
# after "deploy:restart", "deploy:cleanup"

# if you're still using the script/reaper helper you will need
# these http://github.com/rails/irs_process_scripts

# If you are using Passenger mod_rails uncomment this:
 namespace :deploy do
   task :start do ; end
   task :stop do ; end
   task :restart, :roles => :app, :except => { :no_release => true } do
     run "#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}"
   end
 end 
```

和 staging.rb

```
set :domain, 'test.xxx.xx.xx'

role :web, domain                          # Your HTTP server, Apache/etc
role :app, domain                          # This may be the same as your `Web` server
role :db,  domain, :primary => true        # This is where Rails migrations will run

set :deploy_to, "/var/www/vhosts/xxx.xx.xx/test"
set :rails_env, 'staging'
set :rack_env, rails_env

set :dbname, "xxx_staging"

#set :bundle_without, [:test, :development, :production] 
```

我在部署目录中手动创建“当前”、“共享”和“发布”文件夹并分配适当的用户：组。最初是在 dirs 上获得权限问题，但已经解决了。在这里有点不知所措，许多寻找解决方案的方法目前还没有得到任何结果。非常感谢这里的任何建议或经验！

在测试中，`cap staging deploy`我想我会同时尝试生产以及`cap production deploy`保释……关于一致性的一些聪明的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T20:56:05.963

更新：找到了

删除“当前”目录并让 capistrano 创建指向最新版本的“当前”符号链接修复了它。

我会试着把它弄清楚一点。我实际上是在创建文件夹'current' 之类的，'mkdir current' 之类的。这只会妨碍 capistrano 创建符号链接。试试看，创建一个名为“bob”的文件夹，然后在同一目录中创建一个名为“bob”的符号链接并将其指向某个位置，它可能会将符号链接“bob”放入目录“bob”中。

当我删除“当前”“共享”等目录时，capistrano 可以创建“当前”和其他必要的符号链接。因此，具体删除“当前”目录允许 capistrano 创建仅指向“发布”目录下的最新部署的“当前”符号链接。

请注意以下错误，这也是问题所在。

```
** [out :: test.xxx.xx.xx] rm: cannot remove `/var/www/vhosts/xxx.xx.xx/test/current': I command finished in 460ms 
```

它失败的原因。我创建了名为“当前”的文件夹。这就是问题。它不应该是一个目录，它应该是 capistrano 创建的符号链接。

通过创建这些文件夹，它破坏了部署。删除这些文件夹允许 capistrano 创建同名的符号链接。从此一帆风顺。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-18T04:27:18.827

我刚刚找到了一个类似的问题。

这是我遇到的第一个错误：

`cap aborted! Errno::ECONNREFUSED: Connection refused - connect(2) for "{my-ip-address}" port {my-ssh-port}`

我也会收到类似的错误：

`Tasks: TOP => git:create_release (See full trace by running task with --trace) The deploy has failed with an error: #<Errno::ECONNREFUSED: Connection refused - connect(2) for "my-ip-address" port {my-port}>`

事实证明这是并发 SSH 会话的问题，因为我的服务器运行 Fail2Ban。为了解决这个问题，我只是做了以下事情：

编辑包含 SSH 配置的监狱

```
$ sudo nano /etc/fail2ban/jail.local 
```

查找 [SSH] 并设置启用 = false 查找 [ssh-ddos] 并设置启用 = false

请记住在更改和打开 ssh 后重新启动 Fail2Ban（如果那是您使用的）

```
$ sudo service fail2ban reload
$ sudo /etc/init.d/ssh reload 
```

值得注意的是，在部署中的不同步骤（任务）会拒绝连接。例如，在重新启动和快速一切之后，`bundle exec cap production deploy:check`一切看起来都很好。然后我尝试部署并收到相同的错误，但在执行不同任务期间。我还使用了 UFW，我禁用并重新启用它没有问题。UFW 不是上述问题的原因。

在我解决了这个问题后，Capistrano 将无法创建从当前目录到最新版本的符号链接。错误如下：

`Tasks: TOP => deploy:symlink:release The deploy has failed with an error: #<SSHKit::Command::Failed: rm exit status: 1 rm stdout: Nothing written rm stderr: Nothing written > ** Invoke deploy:failed (first_time) ** Execute deploy:failed`

在大量阅读、更改 sshkit 版本、降级 capistrano、消除 gems 等之后，我导航到我的文档根目录并列出了目录内容`ls -la`我注意到该`current`目录不在部署用户组中，我删除了当前文件夹（`sudo rm -rf current`）和所有内容工作正常。祝你好运。

# asp.net - 任何人都可以给我一个 JQuery 中 JSONP 的工作示例吗？

> ID：10761007
> 
> 赞同：0
> 
> 时间：2012-05-25T20:32:06.290
> 
> 标签：asp.net, web-services, jquery, jsonp

我想从托管在另一台服务器上的 Web 服务获取 JSON 数据。我尝试了几个发布在 stackoverflow 中的示例，但没有任何效果。谁能帮帮我。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:47:08.363

要了解有关 jsonp 以及如何正确使用它的更多信息，我建议您查看此视频教程和提供的示例文件：

[http://tutsplus.com/lesson/the-twitter-api/](http://tutsplus.com/lesson/the-twitter-api/)

本教程使用 twitter API 来说明如何使用 jsonp 请求数据。此外，如果您想了解更多关于 jQuery 的一般知识，您应该查看整个视频教程系列：

**tutsplus - 30 天学习 jquery**
[http://tutsplus.com/course/30-days-to-learn-jquery/](http://tutsplus.com/course/30-days-to-learn-jquery/)

这些教程制作精良，并且是 tutsplus 的免费补充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:38:53.360

您无法从不同域的服务器获取 JSON 数据，它必须是 JSONP 数据。

不同之处在于 JSONP 在函数调用中返回 JSON 数据，例如：

```
callback({"status":"ok"}) 
```

# ruby - 查找除小节之外的所有后代 text() 节点

> ID：10761014
> 
> 赞同：2
> 
> 时间：2012-05-25T20:32:42.143
> 
> 标签：ruby, xml, xpath, nokogiri

我的 XML 文档有任意嵌套的部分。鉴于对特定部分的引用，我需要找到`TextNode`该部分中的所有 s*不包括 subsections*。

例如，给定对`#a1`下面节点的引用，我只需要找到“A1”和“A1”文本节点：

```
<root>
  <section id="a1">
    <b>A1 <c>A1</c></b>
    <b>A1 <c>A1</c></b>
    <section id="a1.1">
      <b>A1.1 <c>A1.1</c></b>
    </section>
    <section id="a1.2">
      <b>A1.2 <c>A1.2</c></b>
      <section id="a1.2.1">
        <b>A1.2.1</b>
      </section>
      <b>A1.2 <c>A1.2</c></b>
    </section>
  </section>
  <section id="a2">
    <b>A2 <c>A2</c></b>
  </section>
</root> 
```

**如果不是很明显，以上是虚构的数据。特别`id`是属性可能不存在于真实世界的文档中。**

我现在想出的最好方法是找到该部分中的所有文本节点，然后使用 Ruby 减去我不想要的那些：

```
def own_text(node)
  node.xpath('.//text()') - node.xpath('.//section//text()')
end

doc = Nokogiri.XML(mydoc,&:noblanks)
p own_text(doc.at("#a1")).length #=> 4 
```

我可以制作一个 XPath 1.0 表达式来直接查找这些节点吗？就像是：

```
.//text()[ancestor::section = self] # self being the original context node 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T02:20:37.403

**使用**（对于`id`具有字符串值为“a1”的属性的部分）：

```
 //section[@id='a1']
       //*[normalize-space(text()) and ancestor::section[1]/@id = 'a1']/text() 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
     <xsl:copy-of select=
      "//section[@id='a1']
           //*[normalize-space(text()) and ancestor::section[1]/@id = 'a1']
     "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<root>
    <section id="a1">
        <b>A1 
            <c>A1</c>
        </b>
        <b>A1 
            <c>A1</c>
        </b>
        <section id="a1.1">
            <b>A1.1 
                <c>A1.1</c>
            </b>
        </section>
        <section id="a1.2">
            <b>A1.2 
                <c>A1.2</c>
            </b>
            <section id="a1.2.1">
                <b>A1.2.1</b>
            </section>
            <b>A1.2 
                <c>A1.2</c>
            </b>
        </section>
    </section>
    <section id="a2">
        <b>A2 
            <c>A2</c>
        </b>
    </section>
</root> 
```

**它评估 XPath 表达式（仅选择所需文本节点的父节点 - 为了获得清晰可见的结果）并将所选节点复制到输出**：

```
<b>A1 
            <c>A1</c>
</b>
<c>A1</c>
<b>A1 
            <c>A1</c>
</b>
<c>A1</c> 
```

**更新**：如果`section`元素可以具有相同的`id`属性（或根本没有`id`属性），请使用：

```
 (//section)[1]
           //*[normalize-space(text())
           and
              count(ancestor::section)
             =
               count((//section)[1]/ancestor::section) +1]/text() 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>
     <xsl:strip-space elements="*"/>

     <xsl:template match="/">
         <xsl:copy-of select=
          "(//section)[1]
               //*[normalize-space(text())
               and
                  count(ancestor::section)
                 =
                   count((//section)[1]/ancestor::section) +1]
         "/>
     </xsl:template>
</xsl:stylesheet> 
```

**转换结果（相同）**：

```
<b>A1 
            <c>A1</c>
</b>
<c>A1</c>
<b>A1 
            <c>A1</c>
</b>
<c>A1</c> 
```

这将选择完全相同的所需文本节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:41:57.603

利用：

```
//text()[ancestor::section[1]/@id = 'a1'] 
```

# c# - C# GUI 类如何从工作类接收定期更新？

> ID：10761037
> 
> 赞同：3
> 
> 时间：2012-05-25T20:34:37.427
> 
> 标签：c#, multithreading, user-interface

我试图将我的工作代码与我的 GUI 代码分离到一个完全不同的类中，但我希望能够向我的 GUI 报告进度更新和文件输出。例如，我想让我的 GUI 对工人类说，“从串行端口读取十行，但在收到时向我报告你读到的每件事”。目前我最好的方法是让 GUI 循环十次，并在每个循环中向工人类发送一个命令来读取一件事并返回它。

我真的更希望将所有循环都保留在我的工人阶级一侧，因为它将有更多关于可用信息的信息（实际数据量将是可变的，并且工人阶级已经可以访问数据量可用，我不希望将其发送回 GUI 类来运行循环本身。

我已经调查了后台工作人员，但这似乎只报告了在长时间操作期间完成的百分比，没有别的，所以这对我没有多大帮助。有人知道我如何做到这一点吗？

下面是一个程序的外壳，试图（希望）更好地说明我想要做什么。您将如何编辑代码以执行我的要求？

GUI的主要类：

```
class Main_Class
{
    ...
    /*  Assume in the area we have instantiated these items and placed them on the form:
    *   Button  DoSomething:  A button to do something
    *   TextBox ShowInfo:  A text box to report something from the worker class     
    */

    Worker_Class timewaster = new Worker_Class();

    private void buttonDoSomething_Click(object sender, EventArgs e)
    {
        timewaster.a_lengthy_task();
    }
} 
```

单独的工人阶级：

```
class Worker_Class
{
    ...//Various Setup stuff up here

    void a_lengthy task()
    {
        int iteration = 0;

        while(iteration < 10)
        {
            Datetime saveNOW = Datetime.Now;        //lets say I report this back to the the GUI to write in that ShowInfo box
            Thread.sleep(10000);                    //To waste time and make this lengthy

            //Your code here to facilitate sending saveNOW back to the the Main_Class and display it on the ShowInfo textbox.

            iteration++
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T20:39:32.120

你需要的是事件。如果您无法解决类中内置的`BackgroundWorker`内容以使其为您工作，那么您至少可以按照它的功能为您的解决方案建模。

工人阶级应该有一个公共事件`IterationComplete`或任何你想称之为的事件。您可以为其提供一个`EventArgs`对象（或扩展 EventArgs 的对象），其中包含 UI 所需的与该迭代相关的信息。该事件可以在每次迭代完成后触发（或者当 UI 修改发生时）。

然后，UI 可以订阅与该迭代相关的所有 UI 任务的事件。

代码示例：

主类：

```
public class MainClass
{
    Worker_Class timewaster = new Worker_Class();

    private void buttonDoSomething_Click(object sender, EventArgs e)
    {
        timewaster.IterationComplete += new EventHandler<Worker_Class.IterationEventArgs>(timewaster_IterationComplete);
        timewaster.LengthyTask();
    }

    void timewaster_IterationComplete(object sender, Worker_Class.IterationEventArgs e)
    {
        string infoFromWorker = e.iterationNumber;
    }
} 
```

工人阶级：

```
public class Worker_Class
{
    //Various Setup stuff up here

    public class IterationEventArgs : EventArgs
    {
        public string iterationNumber { get; set; }
    }

    public event EventHandler<IterationEventArgs> IterationComplete;

    public void LengthyTask()
    {
        int iteration = 0;

        while (iteration < 10)
        {
            DateTime saveNOW = DateTime.Now;        //lets say I report this back to the the GUI to write in that ShowInfo box
            Thread.Sleep(10000);                    //To waste time and make this lengthy

            //Your code here to facilitate sending saveNOW back to the the Main_Class and display it on the ShowInfo textbox.

            if (IterationComplete != null)
            {
                IterationEventArgs args = new IterationEventArgs();
                args.iterationNumber = iteration.ToString();
                IterationComplete(this, args);
            }

            iteration++;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T20:58:26.537

这是`BackgroundWorker`班级的理想任务。假设您不使用紧凑框架，它应该可供您使用。

在`BackgroundWorker`您可以收听`onCompleted`和`onProgressUpdated`事件。这些已为您编组到 UI 线程中，您可以使用它们安全地更新您的 winform/wpf 控件。要显示进度，请`ReportProgress()`在`DoWork()``BackgroundWorker`

将代码放入单独的线程时，更新 GUI 控件时需要小心。作为更新控件的线程，必须是UI Thread。BackgroundWorker 为您处理这个问题。

MSDN - [http://msdn.microsoft.com/en-us/library/cc221403(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc221403(v=vs.95).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T21:09:22.477

您将需要`Worker_Class`通过事件让您的广播进度。将`Main_Class`订阅此事件并使用该信息相应地更新 UI。您可以从这里分支到两个方向。您可以使用`Control.Invoke`将此事件处理程序编组到 UI 线程上，您可以在其中安全地更新 GUI。或者您可以让事件处理程序将进度信息保存到共享变量中。然后让您的 UI 在方便的时间间隔通过 a`System.Windows.Forms.Timer`或轮询此变量`DispatcherTimer`。在这种情况下，我更喜欢后一种方法。

```
class YourForm : Form
{
  private volatile MyEventArgs progress = null;

  private void buttonDoSomething_Click(object sender, EventArgs args)
  {
    var timewaster = new Worker_Class();
    timewaster.ProgressChanged += (sender, args) { progress = args; };
    Task.Factory.StartNew(
      () =>
      {
        timewaster.a_lengthy_task();
      }
    UpdateTimer.Enabled = true;
  }

  private void UpdateTimer_Tick(object sender, EventArgs args)
  {
    if (progress != null)
    {
      if (progress.IsFinished)
      {
        ShowInfo.Text = "Finished";
        UpdateTimer.Enabled = false;
      }
      else
      {
        ShowInfo.Text = progress.SaveNow.Value.ToString();
      }
    }
    else
    {
      ShowInfo.Text = "No progress yet";
    }
  }
}

class Worker_Class
{
  public event EventHandler<MyEventArgs> ProgressChanged;

  public Worker_Class()
  {
    ProgressChanged += (sender, args) => { };
  }

  public void a_lengthy task()
  {
    int iteration = 0;
    while(iteration < 10)
    {
        Datetime saveNOW = Datetime.Now;
        Thread.sleep(10000);
        ProgressChanged(this, new MyEventArgs { SaveNow = saveNOW, IsFinished = false });
        iteration++
    }
    ProgressChanged(this, new MyEventArgs { SaveNow = null, IsFinished = true });
  }
}

class MyEventArgs : EventArgs
{
  public DateTime? SaveNow { get; set; }
  public bool IsFinished { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T20:40:22.143

在我的后台工作人员中，我使用：

```
this.Invoke((MethodInvoker)delegate
{
    //do something in GUI
}); 
```

例如，如果您想更改 GUI 中的标签，请使用

```
label.Text = "whatever"; 
```

方法里面。

# javascript - Rails 上的 BackboneJS 语法错误，无法识别的表达式：/1

> ID：10761042
> 
> 赞同：1
> 
> 时间：2012-05-25T20:35:29.410
> 
> 标签：javascript, ruby-on-rails, syntax, backbone.js

我正在尝试为通过链接访问的帖子设置显示页面：

```
<a class="post-link button" href="#">details</a> 
```

当 post item 被渲染时，它会被赋予一个 href，如下所示：

```
this.$('a').attr('href', this.postUrl());

...

postUrl: function() {
  return "#posts/" + this.model.get('id');
} 
```

呈现字段时，链接显示为：

```
http://[path_to_app]/#posts/[whatever_id] 
```

当我点击链接时，它*应该*会点击这个路由器：

```
routes: {
  ''          : 'index',
  'new'       : 'newPost',
  "posts/:id" : 'show'
} 
```

但是我收到了这个错误，它根本不会进入 show 函数：

```
Uncaught Error: Syntax error, unrecognized expression: /1 jquery.js:4268
  Sizzle.errorjquery.js:4268
  Sizzle.filterjquery.js:4254
  Sizzlejquery.js:4044
  Sizzlejquery.js:5176
  jQuery.fn.extend.findjquery.js:5432
  jQuery.fn.jQuery.initjquery.js:188
  jQueryjquery.js:28
  hashchangetabs.js:9
  jQuery.event.dispatchjquery.js:3333
  jQuery.event.add.elemData.handle.eventHandle 
```

当我将链接更改为“#post/”+ id 并将路由更改为“post/:id”时，不会发生此错误。

我正在学习Backbone，在这里真的可以用一只手。另外值得注意的是：我的路由根到 posts#index 操作。

编辑（更相关的代码）：

```
# Model
[APP].Models.Post = Backbone.Model.extend({
  urlRoot: '/posts'
});

#Router
[APP].Routers.Posts = Support.SwappingRouter.extend({
  initialize: function(options) {
    this.el = $('#posts');
    this.collection = options.collection;
  },

  routes: {
    ''          : 'index',
    'new'       : 'newPost',
    "posts/:id" : 'show'
  },

  index: function() {
    var view = new [APP].Views.PostsIndex({ collection: this.collection });
    this.swap(view);
  },

  newPost: function() {
    var view = new [APP].Views.PostsNew({ collection: this.collection });
    this.swap(view);
  },

  show: function(postId) {
    var post = this.collection.get(postId);
    var postsRouter = this;
    post.fetch({
      success: function() {
        var view = new [APP].Views.PostShow({ model: post });
        postsRouter.swap(view);
      }
    });
  }
});

#Post Item View
[APP].Views.PostItem = Backbone.View.extend({
  tagName: 'tr',

  initialize: function() {
    _.bindAll(this, 'render');
  },

  render: function () {
    this.$el.attr('id', 'post_' + this.model.id);
    this.$el.html(JST['posts/item']({ post: this.model }));
    this.renderFormContents();
    return this;
  },

  renderFormContents: function() {
    ...
    this.$('a').attr('href', this.postUrl());
  },

  postUrl: function() {
    return "#posts/" + this.model.get('id');
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:47:53.550

不知何故，不知何故，这个问题是由未按特定顺序加载的文件引起的。我希望我能更具体一些，但我没有在正确的位置加载backbone.min.js。

不过，我能够拥有一些功能，因为我包含了一个旧的骨干部分文件，我试图自定义、损坏并认为已被删除。

真的，非常愚蠢的错误，我一时想不通。感谢您所有的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:05:52.483

Backbone 文档上的结帐 url 和 urlRoot：您可能不需要手动设置标准 restful 资源的 url：[http ://documentcloud.github.com/backbone/#Model-url](http://documentcloud.github.com/backbone/#Model-url)

# c# - ASP MVC 表单调用特定操作而不是重定向但更新原始页面

> ID：10761043
> 
> 赞同：5
> 
> 时间：2012-05-25T20:35:33.017
> 
> 标签：c#, jquery, asp.net, asp.net-mvc-3, forms

我正在将 ASP.net MVC 3 用于一个项目，现在我对它有了更多的了解，但也试图了解它与我使用了这么久的 WebForms 世界之间的差异。以前在 WebForms 中，您只需将字段放在那里，添加一个按钮并创建一个事件，然后使用回发处理您需要的任何内容。

例如，我有一个显示错误详细信息的简单视图。我想将有关此错误的一些信息推送到我们的问题跟踪器的 API。让我们只说错误的主题和内容。我会在 HTML 中做类似的事情：

```
<form action="@Url.Action("Send")" method="post">
    <input id="subject" name="subject" type="text" value="@Model.subject" />
    <br />
    <input id="content" name="content" type="text" value="@Model.content" />
    <br />
    <input type="submit" value="Send" />
</form> 
```

我发现命名我的输入 ID 以匹配我的控制器中的参数名称然后让我传递这些参数。这类似于您在[Scott Guthrie](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)的这篇较早的帖子中看到的内容。

首先，我想在我的错误控制器中调用“发送”操作，而不是我的详细信息。这实际上确实调用了我的“发送”操作，**但随后重定向到 localhost/Errors/Send，这是我不希望的。**

我希望能够提交此表单，该表单调用和操作并使用远程 API 完成工作，然后在当前页面上更新一条消息，说明错误已被转移。

将问题提交给错误跟踪器后，我该如何在原始页面上显示一个 DIV，将内容传回给它（例如，指向问题跟踪器中问题的链接）？

**更新：**这是我在控制器中所做的：

```
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create("http://localhost/redmine/issues.json");
request.Credentials = new NetworkCredential("username", "password");
request.Method = "POST";
request.ContentType = "application/json";
request.Accept = "application/json";

using (StreamWriter writer = new StreamWriter(request.GetRequestStream()))
{
    writer.Write("'issue': { " +
                      "'project_id': 'project', " +
                      "'subject': 'Test issue'" +
                      "}");
}

WebResponse response = request.GetResponse();
Stream stream = response.GetResponseStream();
string json = "";

using (StreamReader reader = new StreamReader(stream))
{
    json = reader.ReadToEnd();
} 
```

另外，这是我在我看来正在做的事情（简化，在菲利普的帮助下）

```
@model webapp.Models.app_errors

<script type="text/javascript">
 function SendErrors() {    

           alert(@Model); // here I get a 'webapp undefined error'
           alert(Model); // Model is undefined. If I reference @Model.App_name or another value anywhere, works fine in rest of view

        $.ajax({
            type: 'POST', //(probably)
            url: '../SendToRedmine',
            cache: false, //(probably)
            dataType: 'json', //(probably)
            data: @Model,
            success: function(result)
            {
                alert("The error has been transferred");
                //you can also update your divs here with the `result` object, which contains whatever your method returns
            }
            });
    }
</script>

<input type="button" onclick='SendErrors()'/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T20:50:24.320

在回答你的第一个问题时，试试这个 Url.Action 的重载：

```
Url.Action("ActionName","ControllerName") 
```

你的第二个问题：你会想通过 AJAX 来做。

基本上，第一次加载页面时，将您想要显示的任何内容返回到屏幕上。然后，有一个这种形式的ajax函数：

```
<script type="text/javascript">
    function SendErrorsOrWhatever()
    {
        dummy = 'error: myError, someOtherProperty = property';  //this of course assumes that 'myError' and 'property' exist
        $.ajax({
        type: 'GET', //i changed this because it actually probably better suits the nature of your request
        url: '../Details/Send',
        cache: false, //(probably)
        dataType: 'json', //(probably)
        data: dummy,  //json object with any data you might want to use
        success: function(result)
        {
            alert("The error has been transferred");
            //you can also update your divs here with the `result` object, which contains whatever your method returns
        }
        });
    }
</script> 
```

需要注意的几点： 1) 自动附加 url 以包含来自`data`. 2）您的操作方法现在需要接受一个参数。有很多方法可以解决这个问题。我在下面的代码中添加了一个示例，说明您的操作方法可能是什么样子。

然后您的按钮`onclick`事件将调用该函数，如下所示：

```
<input type="button" onclick='SendErrorsOrWhatever()'/> 
```

这里发生的是，当你的按钮被点击时，Ajax 将异步（默认）点击你的动作方法，你的动作方法将做任何它需要做的错误，然后当它完成时，`success`回调将被击中.

编辑：现在，您的操作可能如下所示：

```
[AcceptVerbs(HTTP.Get)]
public static Error GetErrors(Error error)
{
    //do all your processing stuff
} 
```

现在，这假设 JSON 对象`dummy`具有与类相同的字段`Error`。如果是这样，MVC 将对其进行自动数据绑定。您也可以使用更通用`FormCollection`的参数。真的，你可以使用任何你想要的东西，但是你会想要将任何你想要的东西包装在一个 JSon 对象中。

编辑——对于你的最后一个问题，这应该有效：

将以下扩展方法添加到您的应用程序：

```
public static class JsonExtensions
{
    public static string ToJson(this Object obj)
    {
        return new JavaScriptSerializer().Serialize(obj);
    }
} 
```

或者，如果您愿意，您可以在模型类中添加一个 ToJson() 方法，然后：

```
var model = @Model.ToJson(); 
```

在 ajax 调用之前的 js 中。然后使用`model`变量作为`data`参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:39:12.800

在 MVC 中，“动作”本质上是一个“页面”。（不完全是，但通过路由，这最终大部分都是真的）

也就是说，您的操作被分组并导航到使用 MVC 框架内的路由。

我认为您在这里要做的是进行 AJAX 调用，将您的错误消息发送到 Web 服务。

除此之外，您可以使用 jQuery 插入一个隐藏`div`的，其中包含一个`IFrame`带有另一个操作的页面。不过，我不会推荐它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T20:47:30.880

有两种可能。

1.  在您的 Errors/Send 操作中，将用户重定向回 l​​ocalhost/Errors/Details 页面。这可以通过`Redirect()`控制器上的方法来完成。这种方法的问题是它是一个阻塞调用。并且用户将不得不等到远程 api 被调用并响应。

2.  使用评论中提到的 AJAX 方法。缺点是它有点复杂，您可能必须轮询服务以检索状态，除非它是一个火而忘记的呼叫，那么它就是金钱。

使用 AJAX 是更优雅的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T20:58:07.283

使用 AJAX 将是解决此问题的方法之一。但是您可能需要重新考虑页面的行为。如果这是您的提交问题页面，您是否希望在提交问题后留在此页面上。如果我继续提交问题怎么办，您是否只想查看最新问题的链接？您可能必须轮询服务器以获取已提交问题的链接，这使得它变得更加困难。

在不知道需求的情况下，想出任何解决方案并不容易，但一般来说，一旦从提交页面（类似于 ~/issue/id）提交，我会转到另一个问题页面。

此外，您可以使用`Html.TextboxFor(m=>m.subject)`类似的语法，这样您就不必为每个属性手动匹配输入 id。

# javascript - iPhone/iPad 触摸事件 Javascript LineChart

> ID：10761046
> 
> 赞同：1
> 
> 时间：2012-05-25T20:35:47.173
> 
> 标签：javascript, iphone, touch, mobile-safari, highcharts

我正在尝试使用[Highcharts](http://highcharts.com)在 Javascript 中实现带有可移动点的折线图。使用最新的 Chrome 一切都按预期工作。但是，当我在 iPhone 或 iPad 上查看时，可移动点根本不会移动。

这是因为在移动 Safari 中鼠标事件的处理方式不同。

`mousedown`变成`touchstart`，`mousemove`变成`touchmove`，等等。

我试图将所有触摸事件映射到相应的移动设备，但没有取得多大成功。点可以拖动，但是视图没有更新……

Chrome 工作版本：http: [//jsfiddle.net/MTyzv/3/](http://jsfiddle.net/MTyzv/3/)

移动版 Safari 版：http: [//jsfiddle.net/MTyzv/7/](http://jsfiddle.net/MTyzv/7/)

**更新**

好的，我将问题缩小了一点......似乎所有触摸事件都得到了正确处理，但是点一旦移动就会跳转到 0.0。除此之外，在初次触摸后，图形不会“重绘”。请参阅此 Fiddle [http://jsfiddle.net/MTyzv/11/的更新版本](http://jsfiddle.net/MTyzv/11/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T10:36:41.743

对于开始使用触摸事件的每个人来说，这是一个常见的问题。

TouchEvent 支持多点触控，所以没有`event.pageX`. TouchEvent 包含三个“TouchLists”，它的：

*   事件.touches
*   事件.targetToches
*   event.changedTouches

最后在这些列表中，您可以获得 Touch pageX、pageY 等。如果您不关心多点触控，有一个常见的简化，您可以调用 event.targetTouches[0].pageX

我在这里更新了您的演示：http: [//jsfiddle.net/7UsbM/7/](http://jsfiddle.net/7UsbM/7/)现在它可以在支持触摸的设备和桌面浏览器中使用。

不要忘记查看 MDN 参考：[https ://developer.mozilla.org/en/DOM/Touch_events](https://developer.mozilla.org/en/DOM/Touch_events)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T10:38:45.610

没有像移动设备拖动这样的东西，但你需要使用触摸事件来完成这项工作。通常您需要 x,y 坐标来制作逻辑，因此请制作适用于鼠标/触摸的 x,y 位置的函数/类，而不是简单地添加事件并获取触摸 x,y 或单击 x,y 并调用这些函数。

```
$('div').bind('mousedown' , function(e)
{
   // get x,y code
   var y = e.pageY;
   var x = e.pageX;

   // pass to function down(x,y);
   down(x,y);
});

$('div').bind('touchstart' , function(e)
{
   // get x,y code
   var touch = e.touches[0];
   var y = touch.pageY;
   var x = touch.pageX;

   // pass to function down(x,y);
   down(x,y);
});

function down(x,y)
{
   // do something with x,y
} 
```

# java - 在java中使用selenium获取悬停文本

> ID：10761050
> 
> 赞同：0
> 
> 时间：2012-05-25T20:36:03.340
> 
> 标签：java, javascript, selenium, webdriver

我试图弄清楚如何从[http://www.walmart.com/browse/TV-Video/TVs/_/N-96v3 之类的页面获取产品可用性文本？](http://www.walmart.com/browse/TV-Video/TVs/_/N-96v3?) （一旦选择了商店）我选择 76574 作为我的邮政编码，然后转到“在我的商店”选项卡

我现在的代码是

```
WebElement hoverElement = driver.findElement(By.xpath(".//*[@id='Body_15992428']/span"));
WebElement hidden = driver.findElement(By.xpath(".//*[@id='slapInfo_NoVariant_15992428']/div"));
Actions builder = new Actions(driver);    
builder.clickAndHold(hoverElement).build().perform();
System.out.println(hidden.getText()); 
```

**编辑：我试过`profile.setEnableNativeEvents(false);`了，文本现在显示在自动浏览器窗口中。我仍然无法得到我想要的文字。它不会抛出异常，只显示什么，因为驱动程序认为它仍然隐藏。有人知道怎么修这个东西吗？

~~我不断得到~~

 ~~```
Exception in thread "main" org.openqa.selenium.InvalidElementStateException: Cannot perform native interaction: Could not load native events component. 
```~~ 

即使在我这样做之后

```
 profile.setEnableNativeEvents(true); 
```

 ~~有没有其他方法可以获得隐藏的文本，或者我在这里做错了什么？

另外，当我用萤火虫检查代码时，我看到有这段代码

```
<script type="text/javascript"> WALMART.$(document).ready(function(){ WALMART.$('#Body_15992428').hover(function(){ WALMART.$('#SeeStoreAvailBubble').wmBubble('update',WALMART.$('#bubbleMsgUpdate_15992428').html()); }); }); </script> 
```

我真的不知道如何直接使用 javascript 做事，但有没有办法直接从 javascript 执行程序中获取消息文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T21:12:01.727

获取页面内对象的悬停文本的唯一方法是使用：

```
webdriver.getattribute("Htmltag","alt text" ); 
```

如果您需要任何帮助，请大声告诉我。~~

# command-line - Windows 命令行 - 在循环中为 FINDSTR 分配高优先级

> ID：10761057
> 
> 赞同：0
> 
> 时间：2012-05-25T20:37:07.687
> 
> 标签：command-line, cmd, findstr

有人知道如何操作此代码，以便始终为 FINDSTR 进程分配高优先级吗？

```
FORFILES /P C:\path /M * /C "cmd /c FINDSTR /c:"@FILE"   C:\path\*">C:\path\repgenresults.txt 
```

我尝试在任务管理器中手动分配优先级，但我需要这样做几千次，因为每个具有新循环迭代的新进程都被分配了正常优先级。我还尝试结合 cmd 和 start 功能，但运气不佳。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:34:05.323

您可以将所有内容放在批处理文件中，然后使用命令 START 以选择的优先级执行批处理文件

[请参阅 START 参考资料](http://ss64.com/nt/start.html)

例子

```
START "RunAsHighPriority" /HIGH /WAIT YourCommand.cmd 
```

# c# - 如何格式化以便方法参数垂直堆叠，每行一个？

> ID：10761058
> 
> 赞同：20
> 
> 时间：2012-05-25T20:37:18.523
> 
> 标签：c#, resharper, resharper-6.0

我有一个我想要这样格式化的方法：

```
public static IQueryable<ThingRequest> GetThings( this EntityContext one
                                                , int? two = null
                                                , int? three = null
                                                , int? four = null
                                                , int? five = null
                                                , String six = null 
                                                , IEnumerable<String> seven = null) { 
```

基本上，如果方法定义要超过行的长度，我希望每行有一个参数。我不太关心逗号（如果它们出现在每行的末尾，那很好）。

但是 R# 像这样格式化它，而不是：

```
public static IQueryable<ThingRequest> GetThings( this EntityContext one, int? two = null, int? three = null, int? four = null, int? five = null,
                                                  String six = null, IEnumerable<String> seven = null ) { 
```

...所以，它把它们排成一行，但是每行有几个参数，很难挑选出任何一个参数。

顺便说一句，在*调用*方法时，如果超过最大行长度，它会逐行堆叠一个参数（即使在这种情况下，我几乎不希望它这样做）。

我已经进入 R# 选项并探索了可用的大量复选框，但我不知道如何改善我的情况。想法？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-02T10:08:01.220

尝试从此路径更改选项：

```
ReSharper | Options -> 
Code Editing | C# | Formatting style | Line breaks and Wrapping -> 
Line wrapping | Wrap formal parameters 
```

总是砍。我不知道是否可以按照您想要的方式放置逗号，但至少每行会有一个参数。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T20:48:02.317

为什么不将这些包装在一个对象中并传递该对象。创建一个班级！然后你只传递一个参数。

```
public class MyParam
{
   public EntityContext one { get; set; }
   public Nullable<int> two { get; set; }
   .....
}

public static IQueryable<ThingRequest> GetThings(MyParam TheParameters) {...} 
```

这样，稍后，您还可以添加一个验证参数的方法。

如果你真的想变得聪明一点，你可以将`GetThings`方法添加到这个类中，现在你在谈论 OOP！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T20:45:39.557

如果您无法选择“任何一个参数”，那么您应该认真考虑调整您应该如何设计此方法。

鲍勃·马丁叔叔（“清洁代码”）建议您最多设置 2-3 个参数。如果你使用的不止这些，那么你可能没有最干净的设计，这应该是一个心理暗示，重新审视你为什么要这样设计它。

另外，我意识到这不是对您的问题的直接答案，但它可能是使您的原始问题没有意义的答案（如果您决定要减少参数的数量）。但是，这是您的代码，因此最终取决于您的喜好。

# ruby-on-rails - 重新打开 gem 提供的 ActiveRecord 模型

> ID：10761059
> 
> 赞同：6
> 
> 时间：2012-05-25T20:37:19.900
> 
> 标签：ruby-on-rails, model, gem, metaprogramming

我正在尝试扩展`Vote`gem ( [https://github.com/peteonrails/vote_fu](https://github.com/peteonrails/vote_fu) ) 为我的应用程序提供的 ActiveRecord 模型 ( )。（即，没有`vote.rb`in `app/models`）

我的第一种方法是创建一个`lib/extend_vote.rb`包含代码的文件：

```
Vote.class_eval do
  after_create :create_activity_stream_event
  has_one :activity_stream_event

  def create_activity_stream_event
    # something..
  end
end 
```

这在创建第一个投票时有效，但是当我尝试创建每个后续投票时，我得到错误`TypeError (can't dup NilClass)`。

我认为这个错误是由于`Vote`每次请求后类都会自动重新加载，但是在`lib/extend_vote.rb`服务器启动时只加载一次代码，这会导致`has_one :activity_stream_event`关联行为异常。`config.cache_classes = true`（此外，如果我设置，问题就会消失`development.rb`）

为了解决这个问题，我尝试通过`to_prepare`在 my 中添加一个块来重新加载每个请求的投票扩展`development.rb`：

```
config.to_prepare do
  load 'extend_vote.rb'
end 
```

这解决了`(can't dup NilClass)`问题，但现在每当我创建一个新投票时，`create_activity_stream_event`回调都会被调用一次。即，第一次投票调用它一次，第二次调用它两次，依此类推。所以看起来该`to_prepare`块正在积极地重新加载扩展并添加重复的回调。

向此`Vote`模型添加方法和回调的最佳方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T22:50:10.463

[更新：应该是防止模块在同一类中多次包含的正确解决方案]

我相信您可以使用[ActiveSupport::Concern](http://api.rubyonrails.org/classes/ActiveSupport/Concern.html)来防止模块被多次包含，这会导致回调被多次调用。请参见下面的示例：

```
module VotePatch
  extend ActiveSupport::Concern

  included do
    after_create :create_activity_stream_event
    has_one :activity_stream_event
  end

  module InstanceMethods
    def create_activity_stream_event
      #your code here
    end  
  end

end

Vote.send(:include, VotePatch) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T14:50:50.560

提醒一句：这是一个非常古老的 gem（最后一次提交是 3 岁），从外观上看，它不能与 rails 3.x 一起使用。在 Rails 3.x 引擎中，这种事情变得更容易了。

据我了解，第一种情况的问题不是重新加载投票模型（它不应该），而是`activity_stream_event`重新加载模型。因为没有重新加载投票模型，所以关联保留`activity_stream_event`在重新加载之前的类版本上。由于 rails 在重新加载类之前会删除类，这会导致问题。

有了这个，试试这个技巧：

```
#in config/initializers/abstract_vote.rb
AbstractVote = Vote
AbstractVote.abstract_class = true
Object.send :remove_const, :Vote

#in app/models/vote.rb

class Vote < AbstractVote
  after_create :create_activity_stream_event
  has_one :activity_stream_event

  def create_activity_stream_event
  end
end 
```

这样做是允许您拥有自己的 Vote 类，该类继承自 gem 中的类。

但是，我再次敦促您找到更新的东西或自己动手制作（宝石只有约 250 行红宝石）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-26T02:58:14.737

我会尝试 agmcleod 在评论中建议的内容，但不是将其放入 lib，而是将其放入**config/initializers/vote.rb**：

```
 class Vote
   after_create :create_activity_stream_event
   has_one :activity_stream_event

   def create_activity_stream_event
   # something..
   end
 end 
```

当然，您可以分叉 gem，进行修改并链接到 Gemfile 中的分叉版本（这是我的偏好）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-13T11:08:40.387

Adrien Coquio 有正确的想法`ActiveSupport::Concerns`，它是[Rails](http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns)扩展模型的方式。他的代码可以工作，你应该使用它。

然而，这在开发中不会一直有效，因为当 Rails 在文件更改时重新加载您的类时，它不会重新评估该`#send`行。我能找到的唯一解决方案是附加到`ActionDispatch`生产中的回调，以确保在每次页面加载后重新需要该文件：

```
if Rails.env.development?
  ActionDispatch::Callbacks.to_prepare do
    require_dependency "../../lib/vote_fu_extensions"
  end
end 
```

在生产中，或者如果您`cache_classes`在配置中设置为 true，则无需执行此操作。

*   [来源](https://stackoverflow.com/questions/9772468/how-to-extend-a-mountable-engines-model-inside-another-mountable-engine-with-de)
*   [关于配置的 RoR 指南](http://guides.rubyonrails.org/configuring.html)
*   [这表明它已被弃用](http://apidock.com/rails/ActionDispatch/Callbacks/to_prepare/class)，您应该改用`ActionDispatch::Reloader`回调？还没试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T14:01:01.753

你能试试这样的吗：

```
class Vote
    after_create :create_activity_stream_event
    has_one :activity_stream_event

    def create_activity_stream_event
        # something..
    end
end 
```

我认为它会添加你的函数并调用函数“after_create”和“has_hone”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-07T23:59:52.223

Your issue might be due to the fact that you are monkey patching the class. When rails tries to reload the constants it is not considering your file.

Try to use module technique as given below.

Add a file called `lib/vote_fu_extension.rb`

```
module VoteFuExtension
  def self.included(base)
    base.has_one :activity_stream_event
    base.after_create :create_activity_stream_event
  end
  def create_activity_stream_event
    # something..
  end  
end
Vote.send(:include, VoteFuExtension) 
```

Add an initializer called `config/initializers/vote_fu.rb`

```
require "vote_fu_extension" 
```

**Note**

If you want to add class methods to the `Vote` model refer to this [answer](https://stackoverflow.com/questions/2328984/rails-extending-activerecordbase/2329394#2329394).

Shameless plug: My [fork](https://github.com/kandadaboggu/vote_fu) of the `vote_fu` gem has some new features and enhancements.

# database - 货币之间的父子关系

> ID：10761060
> 
> 赞同：-1
> 
> 时间：2012-05-25T20:37:41.637
> 
> 标签：database, hierarchy, currency

我需要创建一个数据库表结构来表示所有货币，如果任何国家的货币有超过 2 个层次结构，我将不得不创建一个自引用表。但是如果所有货币只有两个级别（例如美元>美分，卢比>派萨等），那么我只能在同一张表的两列中表示它，用 ParentCurrency 和 ChildCurrency。

有谁知道世界上所有的货币是否总是只有两个级别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:51:03.217

这不是关于编程的问题......但是根据维基百科[http://en.wikipedia.org/wiki/List_of_circulating_currencies是的](http://en.wikipedia.org/wiki/List_of_circulating_currencies)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:50:57.377

假设世界上所有的货币都有两个层次。有一天，一个国家引入了第三个级别，而您所有假设所有货币都有两个级别的设计都将不正确。

在我看来，你应该有一个国家表：

国家（ID，名称）

你应该有一个货币表：

货币（ID、CountryID、ParentID、unity、sign）

其中 cent 的 ParentID 将是美元，符号将是 $ 美元。您需要将国家与货币分开，因为有些国家有不止一种货币，特别是引入欧元并使用其旧货币的国家。

# java - 无法使用来自 tomcat 的 css 运行 jsp

> ID：10761061
> 
> 赞同：0
> 
> 时间：2012-05-25T20:38:07.880
> 
> 标签：java, css, jsp, tomcat

我从 Tomcat 运行我的项目时遇到问题。我以前使用过 IDE，直到现在从未遇到过这个问题。我的 jsp 带有指向 css 的链接，如下所示：

```
<%@page import="data.PageData"%>
<%@page import="dao.pageDao"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<jsp:useBean id="pagedata" class="data.PageData" scope="request"></jsp:useBean>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title><jsp:getProperty name="pagedata" property="title" /></title>
    <link rel="stylesheet" href="main.css"> 
</head>
<body>
<div id="big_wrapper">
    <header id=top_header>
      <h1>Site Header</h1>
    </header>
 <div id="new_div">
  <section id="main_section">
  <jsp:getProperty property="maintext" name="pagedata"/> 

  </section>
  <aside id="side_menu">
    <%= request.getAttribute("pagemenu") %>
  </aside>
  </div>
  <footer id="the_footer">
    Copyright  2012 &copy;
  </footer>
  </div>
</body>
</html>; 
```

我把它放在我的tomcat的项目根目录中，就在我有我的jsp的地方。但是每当我尝试运行它时，它都会显示我的 jsp 页面，但没有样式（它看不到 main.css）。我应该怎么做才能用样式显示它？ps我应该把smth放在web.xml中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:46:41.483

什么是 URL 映射？您的 main.css 没有指定路径，因此它与您的 URL 映射中的路径相关，这就是您应该放置 main.css 文件的位置。

要测试您是否能够访问 main.css，请在 Firefox 中查看 html 源代码并单击 main.css。Firefox 将引导您找到 main.css 的来源。如果您看不到您期望的 css 代码，那么您的路径是错误的。你可能想做类似的事情

```
<link rel="stylesheet" href="/my/url/mapping/path/main.css"> 
```

或者

```
<link rel="stylesheet" href="../../my/relative/path/main.css"> 
```

如果在您使用 IDE 运行它之前它可以工作，则可能是您的 IDE 在没有上下文路径的情况下启动了您的 web 应用程序，而当您在 tomcat 下运行它时，它具有上下文路径。您需要确保 css 或其他资源的路径正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:02:14.613

Sorry guy for disturbing you, i found the mistake, it was in xml mapping, i shouldn't have put "/" in the very end of url-pattern

# c++ - QProcess::terminate() 不适用于简单的 Qt 应用程序作为 Windows XP 下的子进程

> ID：10761064
> 
> 赞同：1
> 
> 时间：2012-05-25T20:38:15.947
> 
> 标签：c++, windows, qt, windows-xp, qprocess

首先，我将从 QProcess 对象开始的简单 Qt 应用程序：

```
#include <QtGui>

class LOLProcess : public QMainWindow {
    Q_OBJECT
public:
    LOLProcess(QWidget *parent = 0);
    ~LOLProcess();
protected:
    void closeEvent(QCloseEvent *);
};

LOLProcess::LOLProcess(QWidget *parent) : QMainWindow(parent) {
}
LOLProcess::~LOLProcess() {
    qDebug() << "~LOLProcess()";
}
void LOLProcess::closeEvent(QCloseEvent *) {
    qDebug() << "closeEvent()";
}

int main(int argc, char *argv[]) {
    QApplication a(argc, argv);
    LOLProcess w;
    w.show();
    return a.exec();
} 
```

现在，带有 QProcess 对象的 Qt 应用程序：

```
#include <QtGui>

class MainWindow : public QMainWindow {
    Q_OBJECT
public:
    MainWindow(QWidget *parent = 0);
    QProcess process;
public slots:
    void close_down();
};

MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent) {
    process.start("../../lolprocess-build-desktop-Qt_4_8_1_for_Desktop_-_MinGW__Qt_SDK__Release/release/lolprocess.exe");
    QTimer::singleShot(3000, this, SLOT(close_down()));
}

void MainWindow::close_down() {
    process.terminate();
    while (!process.waitForFinished(500)) {
    qDebug() << process.readAllStandardError();
    qDebug() << process.readAllStandardOutput();
    }
    qDebug() << process.waitForFinished(5000);
    qDebug() << (process.state() == QProcess::Running);
}

int main(int argc, char *argv[]) {
    QApplication a(argc, argv);
    QDir::setCurrent(QCoreApplication::applicationDirPath());
    MainWindow w;
    w.show();
    return a.exec();
} 
```

行为：terminate() 导致子进程的窗口消失（并从 XP 任务栏中），但根据 taskman，该进程仍在运行。由于`while (!process.waitForFinished(500))`QProcess 对象从不发出finished()，所以循环永远存在。令人惊讶的是，我从子进程（它只打印`QProcess::readAllStandard...()`调用的空字符串）中没有得到任何关于 stdin 或 stderr 的信息，这看起来很奇怪，因为子进程的顶部窗口关闭让我认为 closeEvent() 在子进程中被调用。

使用 QProcess::kill() 终止子进程是可行的，但我不想使用它，因为它不会让子进程有机会在退出之前进行清理。

有趣的是，同样的代码在 Qt 4.7.4 和 OS X 10.6.x 下可以正常工作 - terminate() 导致子进程干净地退出，所以我不确定在 XP 下我做错了什么。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T04:05:30.490

现在试试：

```
#include <QtGui>

class LOLProcess : public QMainWindow {
    Q_OBJECT
public:
    LOLProcess(QWidget *parent = 0);
    ~LOLProcess();
protected:
    void closeEvent(QCloseEvent *);

public slots:
    void lastWindowClosed();
};

LOLProcess::LOLProcess(QWidget *parent) : QMainWindow(parent) {
}
LOLProcess::~LOLProcess() {
    qDebug() << "~LOLProcess()";
}
void LOLProcess::closeEvent(QCloseEvent *) {
    qDebug() << "closeEvent()";
}

void LOLProcess::lastWindowClosed (){
    QApplication::quit();
}

int main(int argc, char *argv[]) {
    QApplication a(argc, argv);
    LOLProcess w;
    QObject::connect(&a, SIGNAL(lastWindowClosed()), &w, SLOT(lastWindowClosed()));
    w.show();
    return a.exec();
} 
```

这不应该是必要的。qt 中似乎有一些非常奇怪的怪癖/错误 - 当我有更多时间时，我会进一步调查它。

# objective-c - 符号化 iPad 崩溃日志后，回溯仍然不可读

> ID：10761070
> 
> 赞同：2
> 
> 时间：2012-05-25T20:38:38.020
> 
> 标签：objective-c, ios, symbolicate, symbolicatecrash

我有这些崩溃日志，在我将它们放入管理器后，会自动进行符号化，但结果总是相同的。iOS 调用得到符号化，而我的应用调用没有。

我尝试将dysm和app文件复制到同一个文件夹中，删除并再次复制回来。没有任何帮助。

知道发生了什么吗？所以我得到这样的东西：

```
 Last Exception Backtrace:
0   CoreFoundation                  0x36d4088f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x31071259 objc_exception_throw + 33
2   CoreData                        0x350337ab -[NSPersistentStoreCoordinator removePersistentStore:error:] + 227
3   MyApp                           0x00139fbb 0x2e000 + 1097659
4   MyApp                           0x0013998d 0x2e000 + 1096077
5   MyApp                           0x00139a5d 0x2e000 + 1096285
6   libdispatch.dylib               0x3171d61f dispatch_once_f$VARIANT$mp + 47
7   MyApp                           0x001399ff 0x2e000 + 1096191
8   MyApp                           0x00139b47 0x2e000 + 1096519
9   MyApp                           0x0008915d 0x2e000 + 373085
10  MyApp                           0x0008a11b 0x2e000 + 377115
11  UIKit                           0x36ffbd3d -[UIViewController _setViewAppearState:isAnimating:] + 145
12  UIKit                           0x36ffeaa3 -[UINavigationController _startTransition:fromViewController:toViewController:] + 815
13  UIKit                           0x36ffe6ab -[UINavigationController _startDeferredTransitionIfNeeded] + 251
14  UIKit                           0x36ffe56b -[UILayoutContainerView layoutSubviews] + 179
15  UIKit                           0x36fbd0bd -[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 149 
```

你可以看到 UIKit 函数被符号化但不是 MyApp

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T22:51:26.820

您需要生成崩溃报告的确切版本的 dSYM 文件和应用程序二进制文件。如果通过 Spotlight 使用符号化脚本未找到 dSYM，通常您会在 Xcode 中获得此结果。如果这是来自调试版本，而您同时创建了一个新版本，那么您就不走运了。否则，请确保存储调试版本的目录已被 Spotlight 索引。如果这是来自存档的构建，请确保存档目录已被 Spotlight 索引。

崩溃报告包含一个标题为“二进制图像”的部分，最重要的是，您的应用程序二进制文件使用二进制文件 UUID 引用。它看起来像`c42a118d722d2625f2357463535854fd`，需要将其更改为大写和格式 8-4-4-4-12 ，然后看起来像这样：`C42A118D-722D-2625-F235-7463535854FD`。

您可以使用它通过以下方式在终端中通过聚光灯搜索 dSYM：

`mdfind "com_apple_xcode_dsym_uuids == C42A118D-722D-2625-F235-7463535854FD"`

# sql - 如何将 PostgreSQL 转储文件恢复到 Postgres 数据库中？

> ID：10761073
> 
> 赞同：55
> 
> 时间：2012-05-25T20:39:02.110
> 
> 标签：sql, postgresql, dump, database-restore, database-dump

我有一个带有`.SQL`扩展名的转储文件（实际上它是一个纯文本 SQL 文件）。我想将它恢复到我创建的数据库中。我正在使用[pgAdmin III](http://www.pgadmin.org/)，当我使用它的“恢复向导”时，它不会突出显示“恢复”按钮。相反，它需要一个`.backup`文件扩展名。

我尝试使用 shell 命令来恢复转储，但它仍然不起作用。

我是这方面的新手。如果有人可以帮助我，我将不胜感激。

## 编辑

当我坐在 newTestDB 时，我对 PostGres 的 Shell SQL 窗格使用了以下命令。

```
newTestDB-# \i E:\db-rbl-restore-20120511_Dump-20120514.sql 
```

它仍然给出了同样的错误（“权限被拒绝”）。

提升权限后，它只显示 PostgreSQL 的默认表：

```
 List of tablespaces
Name       |  Owner   | Location
-----------+----------+----------
pg_default | postgres |
pg_global  | postgres |

(2 rows) 
```

我不知道如何从 SQL 文件导入/恢复数据库。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-25T20:46:33.580

你没有提到你的备份是如何制作的，所以一般的答案是：*通常使用该`psql`工具。*

根据`pg_dump`指示转储的内容，SQL 文件可以有不同的 SQL 命令集。例如，如果您指示`pg_dump`使用`--clean`and转储数据库`--schema-only`，则不能指望能够从该转储中恢复数据库，因为不会有用于 COPYing（或 INSERTing，如果`--inserts`使用）表中的实际数据的SQL 命令. 像这样的转储将只包含 DDL SQL 命令，并且能够重新创建模式但不能重新创建实际数据。

使用以下命令恢复典型的 SQL 转储`psql`：

```
psql (connection options here) database  < yourbackup.sql 
```

或者从`psql`会话中，

```
psql (connection options here) database
database=# \i /path/to/yourbackup.sql 
```

对于使用`pg_dump -Fc`（“自定义格式”）进行的备份，它不是普通的 SQL 文件而是压缩文件，您需要使用该`pg_restore`工具。

如果您正在使用类 unix，请尝试以下操作：

```
man psql
man pg_dump
man pg_restore 
```

否则，请查看[html 文档](http://www.postgresql.org/docs/devel/static/backup.html)。祝你好运！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-05-10T18:23:59.703

您在命令行尝试的问题`psql`是斜线的方向：

```
newTestDB-# /i E:\db-rbl-restore-20120511_Dump-20120514.sql   # incorrect
newTestDB-# \i E:/db-rbl-restore-20120511_Dump-20120514.sql   # correct 
```

需要明确的是，`psql`命令以反斜杠开头，因此您应该使用 put`\i`代替。由于您的错字而发生的事情是`psql`忽略了所有内容，直到找到第一个`\`，恰好是紧随其后的`db`，并且`\db`恰好是列出*表空间*`psql`的命令，因此输出是*表空间列表*。正如您所说，它不是“PostgreSQL 的默认表”列表。

 **此外，无论操作系统如何，似乎都`psql`希望`filepath`参数使用正斜杠分隔目录（因此在 Windows 上这将是违反直觉的）。

值得注意的是，您“提升权限”的尝试与您尝试执行的命令的结果无关。此外，您没有说明是什么导致了所谓的“权限被拒绝”错误。

最后，转储文件的扩展名无关紧要，实际上您甚至不需要扩展名。确实，在选择备份文件名时`pgAdmin`会建议`.backup`扩展名，但实际上您可以将其设置为您想要的任何内容，包括根本没有扩展名。问题是`pgAdmin`似乎只允许“恢复”“自定义或 tar”或“目录”转储（至少在应用程序的 MAC OS X 版本中是这种情况），所以只需使用`psql` `\i`如上所示的命令。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-11-18T12:35:54.040

通过使用**pg_restore**命令，您可以恢复 postgres 数据库

首开终端类型

```
sudo su postgres 
```

创建新数据库

**createdb [数据库名称] -O [所有者]**

```
createdb test_db [-O openerp] 
```

**pg_restore -d [数据库名称] [转储文件的路径]**

```
pg_restore -d test_db /home/sagar/Download/sample_dbump 
```

等待数据库恢复完成。

**请记住，转储文件应该具有读取、写入、执行权限，因此您可以应用 chmod 命令**

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-10-11T06:19:33.810

**1.打开终端。**

**2.使用以下命令备份您的数据库**

你的 postgres bin - /opt/PostgreSQL/9.1/bin/

您的源数据库服务器 - 192.168.1.111

您的备份文件位置和名称 - /home/dinesh/db/mydb.backup

您的源数据库名称 - mydatabase

/opt/PostgreSQL/9.1/bin/pg_dump --host '192.168.1.111' --port 5432 --username "postgres" --no-password --format custom --blobs --file "/home/dinesh/db /mydb.backup" "我的数据库"

**3.restore mydb.backup 文件到目的地。**

您的目标服务器 - 本地主机

您的目标数据库名称 - mydatabase

**创建用于恢复备份的数据库。**

/opt/PostgreSQL/9.1/bin/psql -h 'localhost' -p 5432 -U postgres -c "CREATE DATABASE mydatabase"

**恢复备份。**

/opt/PostgreSQL/9.1/bin/pg_restore --host 'localhost' --port 5432 --username "postgres" --dbname "mydatabase" --no-password --clean "/home/dinesh/db/mydb.备份”

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-03-10T15:53:12.273

结合 MartinP 和 user664833 的建议，我也能够让它工作。需要注意的是，通过选择插件从 pgAdmin GUI 工具输入 psql...PSQL 控制台设置 psql 会话的凭据和权限级别，因此您必须对表具有管理员或 CRUD 权限，并且可能还对数据库具有管理员权限（不要肯定知道）。然后在 psql 控制台中的命令将采用以下形式：

```
postgres=# \i driveletter:/folder_path/backupfilename.backup 
```

其中*postgres=#*是 psql 提示符，不是命令的一部分。

.backup 文件将包含用于创建表的命令，因此您可能还会在文件中获得“ALTER TABLE ...”命令，这些命令会被执行但报告为错误。我想您总是可以在运行还原之前删除这些命令，但是将它们保留在那里可能比抱歉更安全，因为这些不太可能导致数据还原失败。但请始终检查以确保您想要恢复的数据确实到达那里。（对不起，如果这看起来像是对任何人的傲慢的建议，但无论他们从事这些事情多久，任何人都可能会发生疏忽——同事、电话等的片刻分心，而且很容易忘记这一步。我在职业生涯的早期使用其他数据库自己完成过，并且想知道“哎呀，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-29T22:21:18.743

You might need to set permissions at the database level that allows your schema owner to restore the dump.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-14T18:10:14.060

我发现 psql.exe 对斜线方向非常挑剔，至少在 Windows 上（如上图所示）。

这是一个例子。在 cmd 窗口中：

```
C:\Program Files\PostgreSQL\9.2\bin>psql.exe -U postgres
psql (9.2.4)
Type "help" for help.

postgres=# \i c:\temp\try1.sql    
c:: Permission denied
postgres=# \i c:/temp/try1.sql
CREATE TABLE
postgres=# 
```

当我在通话中使用“普通”窗口斜杠时，您会看到它失败了`\i`。但是，如果您将它们作为输入参数传递给 ，则*两种*`psql.exe`斜线样式都可以工作，例如：

```
C:\Program Files\PostgreSQL\9.2\bin>psql.exe -U postgres -f c:\TEMP\try1.sql
CREATE TABLE

C:\Program Files\PostgreSQL\9.2\bin>psql.exe -U postgres -f c:/TEMP/try1.sql
CREATE TABLE

C:\Program Files\PostgreSQL\9.2\bin> 
```**

# sql-server-2008 - 如何在 SQL Server 2008 存储过程中读取配置文件密钥

> ID：10761075
> 
> 赞同：0
> 
> 时间：2012-05-25T20:39:07.107
> 
> 标签：sql-server-2008, tsql

我有一个 settings.config 文件`c://config`

`settings.config`有这个内容：

```
<filelocation>d://mydata</filelocation> 
```

现在我想`d://mydata`在我的 SQL Server 2008 存储过程中获取文件路径，它将将此位置作为文件创建路径的输入。

请推荐！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:06:48.113

简化示例，但您可以执行以下操作（假设您可以从 SQL Server 读取文件）：

```
declare @table table (Value XML)

insert @table
select a.* from openrowset (bulk 'C:\config', single_clob) a

select * from @table

select Value.value('filelocation[1]', 'varchar(100)')
from @table 
```

根据文件的结构进行扩展。

# jquery - 向用户显示元素时会触发哪个事件？

> ID：10761081
> 
> 赞同：1
> 
> 时间：2012-05-25T20:39:38.980
> 
> 标签：jquery, javascript-events, deferred-rendering

我有一个包含很多图像的页面。如果用户还没有向下滚动到图像所在的位置，那么让浏览器将它们全部加载是没有意义的。我想将元素绑定`img`到一个事件处理程序，该处理程序在包含`div`可见时触发（从某种意义上说，用户已经滚动到足以使元素在视口中）。然后，此处理程序将重写`src`属性并加载图像。

我要找什么活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:43:07.480

没有本机 jQuery 事件可以做你想做的事。您需要使用该`scroll`事件来获取滚动位置、获取可见图像并加载它们。

已经有插件为您执行此操作。也许出现的 jQuery 插件就是你要找的：[http ://code.google.com/p/jquery-appear/](http://code.google.com/p/jquery-appear/)

这可能是这个问题的重复：[让图像在进入浏览器的可见部分时加载？](https://stackoverflow.com/questions/1736215/make-images-load-when-they-enter-visible-section-of-browser)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:47:02.973

```
$(window).scroll(function(){

 // if user has scrolled to 250px 
 if ($(this).scrollTop() > 250){ 
    // load your images,
 } 
}) 
```

更好的方法是将 a`div`放在底部并使用`mouseenter`事件来检测用户是否想要更多图片。

```
$('#the_bottom_div').mouseenter(function(){
   // If user has placed mouse on bottom,load images (like facebook does)
}) 
```

# android - Android 意图附加值转换错误：双重转换为整数

> ID：10761085
> 
> 赞同：1
> 
> 时间：2012-05-25T20:39:57.770
> 
> 标签：android, android-intent, casting, extra

我在发送带有附加功能的意图时遇到这样的问题：作为双精度的值被转换为整数，并且在接收意图时不能被读取为双精度。代码如下。

在 WidgetProvider 的 onUpdate 方法中创建 Intent：

```
Intent send = new Intent("ACTION_SEND_DATA");
send.putExtra("url", "http://some-url.com");
send.putExtra(LONGITUDE, new Double(13.65));
send.putExtra(LATITUDE, new Double(43.12));
PendingIntent sendPendingIntent = PendingIntent.getBroadcast(context, 0, send, 0);
views.setOnClickPendingIntent(R.id.Change, sendPendingIntent); 
```

在 WidgetProvider 的 onReceive 方法中接收 Intent：

```
else if (intent.getAction().equals("ACTION_SEND_DATA"))
  {
      Log.d("WIDGET", "received ACTION_SEND_DATA intent");
      String msg = intent.getStringExtra("url");
      Bundle extras = intent.getExtras();
      if (extras != null) 
      {
        // Get data via the key
          String url = extras.getString("url");
          Double longitude = new Double(intent.getDoubleExtra(LONGITUDE, -100));
          Double latitude = new Double(extras.getDouble(LATITUDE, -100));
          msg = "received: " + url + " " + longitude + " " + latitude;
          sendData(extras);
      }
      else
          msg += " no extras!";

      Toast.makeText(context, msg, Toast.LENGTH_LONG).show();
  } 
```

这行：

```
Double longitude = new Double(intent.getDoubleExtra(LONGITUDE, -100));
Double latitude = new Double(extras.getDouble(LATITUDE, -100)); 
```

在 DDMS LogCat 中抛出警告：

[![警告](../Images/fc40ff9a2f89d7de327be00ec25e66b6.png)](https://i.stack.imgur.com/ypcIM.png)

什么会导致此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:38:07.563

要不收到此警告，您可以使用 -100.0 代替，因为这是它抱怨的整数。但这不会解决你的问题。

您的 Intent 似乎没有关键 LONGITUDE 的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:39:35.180

这里有一些提示：

1.  不要使用 "new Double" 。你可以简单地把值单独放在一起。编译器知道如何处理它。如果您希望在变量而不是值之间有所不同，则使用“new Double”。例如：

    ```
    Double x=10.0,y=x,z=new Double(x); 
    ```

    所以在这里， x==y ，但是 x!=z 。

    尝试在所有代码中更改它，看看它是否有帮助。

2.  对于 "getDoubleExtra" ，使用 100.0 而不是 100 。

3.  要获取值，您不需要使用 Double 。双倍没问题。如果您愿意，也可以使用 null 作为默认值（如果您使用 Double）。

# iphone - 在自定义表格单元格中正确抓取 UIButton 的 IndexPath.row？

> ID：10761086
> 
> 赞同：0
> 
> 时间：2012-05-25T20:40:21.733
> 
> 标签：iphone, ios, ios5, uitableview

我有一个表格视图，可以从网络加载信息，并将其显示在自定义单元格中。在这些自定义单元格中，我有一个通过情节提要分配的按钮。

如果这个按钮被按下，它会触发一个方法（在 cellForRowAtIndexPath 方法中定义）

```
cell.viewArticleButton.action = @selector(viewArticle:); 
```

正是在这种方法中，我遇到了麻烦。该操作有效，只是它不使用为每个相应单元格提供的链接（每个索引路径处的链接），而是仅使用第一行的链接，无论我点击哪一行。

```
-(IBAction)viewArticle:(id)sender {

NSLog(@"View Article Button Tapped");

NewsCell *cell = (NewsCell *)[self.tableView dequeueReusableCellWithIdentifier:@"NewsCell"];

NSIndexPath *indexPath = [self.tableView indexPathForCell:cell]; 

MWFeedItem *item = [itemsToDisplay objectAtIndex:indexPath.row];

   // Open link from item.link

} 
```

任何帮助，将不胜感激。我有一种感觉，就是这条线没有做我想要的：

```
NewsCell *cell = (NewsCell *)[self.tableView dequeueReusableCellWithIdentifier:@"NewsCell"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:49:23.453

有了这条线：

```
NewsCell *cell = (NewsCell *)[self.tableView dequeueReusableCellWithIdentifier:@"NewsCell"]; 
```

您正在获取对原型（或模板）单元格的引用。这不会让您唯一地标识表格视图中的单元格。那只能识别从这个原型单元创建的一组单元。这就是为什么您总是获得第一行的原因；它返回使用此原型创建的第一个单元格。如果您只有一个具有标识符的单元格`@"NewsCell"`（其他单元格具有不同的标识符），那么您的实现将起作用。

要唯一标识您单击的单元格，请遵循以下线程：[检测 UITableView 中按下了哪个 UIButton](https://stackoverflow.com/questions/1802707/detecting-which-uibutton-was-pressed-in-a-uitableview)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:48:47.240

为什么不将 NSIndexPath 中的 add 添加到方法中：

```
cell.viewArticleButton.action = @selector(viewArticle:indexPath);

-(IBAction)viewArticle:(id)sender {
NSIndexPath *indexPath = (NSIndexPath *)sender;

NSLog(@"View Article Button Tapped for section %d, row $d", indexPath.section, indexPath.row);

// I have no idea why you are doing this...
NewsCell *cell = (NewsCell *)[self.tableView dequeueReusableCellWithIdentifier:@"NewsCell"];

MWFeedItem *item = [itemsToDisplay objectAtIndex:indexPath.row];

   // Open link from item.link

} 
```

# javascript - 广告未显示在表格内容中

> ID：10761090
> 
> 赞同：0
> 
> 时间：2012-05-25T20:40:45.147
> 
> 标签：javascript, jquery, adsense

我正在显示一个气泡弹出，其内容是一个表格，我想在其中显示 google adsense 广告，

我正在通过调用 setBubblePopup 方法设置弹出窗口的内容，如下所示，

```
#(some element).setBubblePopup('<table> ...  </table>'); 
```

请注意，上面的内容是内联的，所以我要删除空格但是';' 在那里，
当我将 td 元素的内容设置为 adsense 脚本内容时，它无法显示广告（再次，我必须将其设为内联）

我做的第二个测试是，复制粘贴表格内容并直接尝试在普通html页面中运行，然后我可以看到广告，

我是否需要编码新行以在表格中设置 adsense 内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:46:26.970

您不能动态插入移动或创建 Google Adsense 广告，而不会导致无效展示，这可能导致正在使用的 Google 帐户被 Google Adsense 禁止。必须在使用 Google 提供的脚本加载页面时在它们所属的位置创建 Adsense 广告（仅在`DOMContentLoaded`触发事件之前有效）

如果我错了，请纠正我。

# mysql - MySQL插入条件日期时间

> ID：10761092
> 
> 赞同：0
> 
> 时间：2012-05-25T20:41:17.620
> 
> 标签：mysql, datetime, date, time, insert

我想知道是否可以在一个查询中插入基于特定日期/时间的记录，而无需先选择它。

例如：

我只想在 2 分钟前没有记录时插入。

这将如何实现？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:43:41.670

使用以下语句代替`INSERT INTO table_name VALUES (1,'foobar')`：

```
INSERT INTO foobar (foobar_id,display_name,ctime)
SELECT 42,'foobar',CURRENT_TIMESTAMP()
FROM DUAL
WHERE NOT EXISTS (
    SELECT 1
    FROM foobar
    WHERE mtime > CURRENT_TIMESTAMP() - INTERVAL 2 MINUTE
); 
```

诀窍是：找到一个 select 语句，当且仅当该行应该被插入时，它返回一个包含要插入的列的行 - 最后放在`INSERT INTO table_name`它的前面。请注意，该表`DUAL`是 MySQL 和其他 DBMS 中的特殊表。

# php - 使用 ajax 和 php 更改多个下拉列表

> ID：10761096
> 
> 赞同：0
> 
> 时间：2012-05-25T20:41:52.540
> 
> 标签：php, ajax, drop-down-menu

我有一个关于 AJAX 和 PHP 的问题，我有一个主下拉列表，当用户更改它时，应该根据主下拉值更改其他下拉列表，更清楚地说，我有一个快速查找器部分我正在开发的网站，有一个拾取端口（主下拉菜单），还有 4 个其他下拉菜单，当用户更改此拾取端口时，应该使用 AJAX 和 PHP 进行更改，是否有人有知道如何创建它，我已经研究了 3 天，但没有成功。

提前致谢。

我试过这个

```
function filter(id) {
    if(window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange = function() {
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById('type_filter').innerHTML = xmlhttp.responseText;
            document.getElementById('find-trip-dest-region').innerHTML = xmlhttp.responseText;
        }
    }
    xmlhttp.open('GET', 'forms/type_filter.php?id=' + id, true);
    xmlhttp.send();
    xmlhttp.open('GET', 'forms/activity_filter.php?id=' + id, true);
    xmlhttp.send();
} 
```

还有这个

```
function filter(id) {
    if(window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange = function() {
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById('type_filter').innerHTML = type_filter.responseText;
            document.getElementById('find-trip-dest-region').innerHTML = activity_filter.responseText;
        }
    }
    var type_filter = xmlhttp.open('GET', 'forms/type_filter.php?id=' + id, true);
    xmlhttp.send();
    var activity_filter = xmlhttp.open('GET', 'forms/activity_filter.php?id=' + id, true);
    xmlhttp.send();
} 
```

也试过这个

```
function filter(id) {
    if(window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange = function() {
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById('type_filter').innerHTML = type_filter.xmlhttp.responseText;
            document.getElementById('find-trip-dest-region').innerHTML = activit_filter.xmlhttp.responseText;
        }
    }
    var type_filter = xmlhttp.open('GET', 'forms/type_filter.php?id=' + id, true);
    xmlhttp.send();
    var activit_filter = xmlhttp.open('GET', 'forms/activity_filter.php?id=' + id, true);
    xmlhttp.send();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:00:36.340

我已经设法像这样使用jquery解决它

```
$(document).ready(function() {
    $('#pickup_port').change(function() {
        var id = $('#pickup_port').val();
        if(id != "") {
            $.get('forms/type_filter.php?id='+ id, function(data) {
                $('#type_filter').html(data);
            });
            $.get('forms/activity_filter.php?id='+ id, function(data) {
                $('#activity_filter').html(data);
            });

        }
    });
}); 
```

但是有没有人有更好的解决方案或者这是唯一的解决方案

# php - 如果页面上尚不存在默认的 favicon.ico，则加载默认的 favicon.ico

> ID：10761097
> 
> 赞同：0
> 
> 时间：2012-05-25T20:41:53.253
> 
> 标签：php, html

**只有当**特定页面上当前没有加载其他 favicon时，是否有一种优雅的方式来加载默认 favicon ？

本质上，

```
if (favicon.ico exists) { 
    //do nothing
} 
else { 
    load default favicon.ico 
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:46:20.013

如果页面上没有指定 favicon，浏览器应该查找`/favicon.ico`（换句话说，`favicon.ico`位于网站根文件夹中的文件）。这是默认的网站图标应该去的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:46:37.727

您必须嗅探服务器的 webroot 以查看 favicon 是否存在，如果没有，您可以加载自己的。

太向页面添加一个，您需要将其添加到`<HEAD>`.

```
<link rel="shortcut icon" type="image/x-icon" href="http://.../favicon.ico"/> 
```

# sql-server - SQL Server 2005 中显示为方框的汉字

> ID：10761101
> 
> 赞同：1
> 
> 时间：2012-05-25T20:42:50.327
> 
> 标签：sql-server, sql-server-2005, character-encoding

我刚从本地化人员那里收到了一堆 Excel 电子表格格式的汉字。当我将数据导入我的 SQL Server 2005 表（`nvarchar`列）时，它显示为一堆框而不是实际字符。我想这是不对的。有谁知道为什么它会这样？

编辑：数据仍然以某种方式显示在框中。当我将数据加载到我的应用程序中并将其绑定到 UI 元素时，它会正确显示为中文。我遇到的问题是，如果我使用汉字启动 messagebox.show，我仍然会得到这些框，我不禁认为这与我在数据库中看到的框有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T16:33:10.880

不确定您使用的是什么前端。看起来像 Windows 应用程序。该对话框使用机器的系统属性。最好用中文windows。就 SQL Server 向您显示的框而言，这里的帖子将为您提供 [SQL Server 表中的日语/中文语言数据的线索](https://stackoverflow.com/questions/569845/japanese-chinese-language-data-in-sql-server-table)

# c++ - Visual Studio MFC CListCtrl 复选框 - 空格键

> ID：10761103
> 
> 赞同：0
> 
> 时间：2012-05-25T20:43:10.487
> 
> 标签：c++, visual-studio-2008, visual-c++, mfc

我正在 Visual Studio 2008 中开发 MFC 应用程序。我有一个带有复选框的 CListCtrl 对象。我想知道是否有一种简单的方法可以让空格键切换所有突出显示的项目。现在，在空格键按下事件中，我正在这样做：

```
void toggleSelect()
{
    POSITION pos = m_cListCtrl.GetFirstSelectedItemPosition();
    while(pos)
    {
        int index = m_cListCtrl.GetNextSelectedItem(pos);
        BOOL check = m_cListCtrl.GetCheck(index);
        m_cListCtrl.SetCheck(index, !check);
    }
} 
```

如果在突出显示单个项目时不适用于空格键的默认行为，这将是有效的（在选择单个项目时自动切换复选框）。这段代码的问题是总有一个复选框未切换。这是因为空格键的默认行为是切换选定的单个项目。反正有没有禁用默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T10:12:24.127

你说的对。处理多选检查状态后，您可以在代码中设置列表控件句柄检查状态切换后进行切换。你必须修改你的代码。我只是假设您正在处理 LVN_KEYDOWN 消息。（**toggleSelect 是全局的吗？为什么？**）

```
void CYourDlgClass::OnLvnKeydownList1(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMLVKEYDOWN pLVKeyDown = reinterpret_cast<LPNMLVKEYDOWN>(pNMHDR);

    if(VK_SPACE == pLVKeyDown->wVKey && m_cListCtrl.GetSelectedCount() > 1)
    {
            toggleSelect();
            *pResult = 1;
            return;
    }

    // TODO: Add your control notification handler code here
    *pResult = 0;
}

void CYourDlgClass::toggleSelect() 
{ 
    POSITION pos = m_cListCtrl.GetFirstSelectedItemPosition(); 
    while(pos) 
    { 
            int index = m_cListCtrl.GetNextSelectedItem(pos); 
            BOOL check = m_cListCtrl.GetCheck(index); 
            m_cListCtrl.SetCheck(index, !check); 
    } 
} 
```

将 *pResult 设置为 0 表示消息已被处理，不需要进一步处理。我建议从 CListCtrl 派生类并以类似方式处理 WM_KEYDOWN：

```
void CMultiCheckListCtrl::OnKeyDown(UINT nChar, UINT nRepCnt, UINT nFlags)
{
    if(VK_SPACE == nChar && GetSelectedCount() > 1)
    {
            POSITION pos = GetFirstSelectedItemPosition(); 
            while(pos) 
            { 
                    int index = GetNextSelectedItem(pos); 
                    BOOL check = GetCheck(index); 
                    SetCheck(index, !check); 
            } 
            return;
    }

    CListCtrl::OnKeyDown(nChar, nRepCnt, nFlags);
} 
```

# jquery - css中动态改变饱和度

> ID：10761104
> 
> 赞同：2
> 
> 时间：2012-05-25T20:43:23.287
> 
> 标签：jquery, css, hsl

我正在使用 jQuery 一堆 DIV 创建一个堆叠条形图。每个堆栈的段都用不同的灰色阴影着色。我想通过更改 div 的饱和度来将额外的全局值编码到条形图上，以使其颜色从灰色变为某种阴影颜色，同时保持相对亮度。显而易见的选择是单独修改每个元素的 HSL 值。

我是否忽略了一些更聪明的调整条形颜色的方法？我不认为我可以使用容器的背景颜色，因为条不能是透明的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:51:02.700

我认为[这个项目](https://github.com/jquery/jquery-color)会完全满足您的要求！

它添加了对使用 jQuery 动画颜色的支持。

看看[这个演示](http://www.bitstorm.org/jquery/color-animation/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T22:07:57.510

我想更清楚地记录答案。按照@Pheonixblade9 的建议，我使用了 jQuery 颜色插件，但在让它正常工作时遇到了一些麻烦。

1.  我从 github 获得的[最新版本的 jQuery 颜色插件在 jQuery 1.4.2 中不能正常工作；](https://github.com/jquery/jquery-color)当我将它升级到 1.4.4 时，与未定义 jQuery.type 相关的错误消失了。
2.  我必须更改我试图着色的 div 结构，以便为每个元素引入部分透明度。我有多达四个需要着色的重叠 div，最后起作用的是将每个 div 的不透明度设置为 0.3，以便为我需要的四个级别生成清晰的灰度范围。最初，我刚刚为每个不透明度为 1 的 div 分配了灰度值。
3.  正如我在对@Pheonixblade9 的回答的评论中指出的那样，改变饱和度的天真解决方案不起作用，因为如果饱和度值达到 0，插件将失去色调值，并改用 0。为了让它可靠地工作，我引入了饱和度值的最小值，它小到在显示器上不可见（我期望），但足以防止插件代码失去色调。

    ```
    function setSaturation($elem, score, animationDuration) {
         var targetColor = $.Color({saturation: Math.max(score, 0.01)});
         $elem.animate({backgroundColor: targetColor}, animationDuration);
     } 
    ```

# xml - Powershell 编辑 Xml 导致 Visual Studio 报告行尾不一致

> ID：10761105
> 
> 赞同：8
> 
> 时间：2012-05-25T20:43:26.907
> 
> 标签：xml, visual-studio-2010, powershell, nuget

Powershell初学者在这里..

所以我创建了一个带有 powershell 脚本的 Nuget 包。powershell 脚本在安装时会修改我的 Visual Studio 项目中的 xml 架构。问题是......

如果 xml 文件中有一个多行块注释，例如

```
<!--<foo>
   <bar>
   </bar>
</foo>--> 
```

脚本运行后，Visual Studio 会弹出一条消息，说我的文件有“行尾不一致......”

如果没有注释，或者有单行注释，例如

```
<!--foo--> 
```

没有问题。不知何故，以块注释结尾的行通过 powershell 函数从 CRLF 更改为其他内容。

这是我用于加载和保存 xml 文件的 powershell 脚本

```
 [xml]$xml = gc $xmlFileLocation -encoding utf8

 $xml.Save($xmlFileLocation) 
```

我也尝试过类似的东西

```
 set-content -encoding utf8 $xmlFileLocation $xml.outerXml 
```

但我不断收到这条消息......

任何建议/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T19:49:25.747

管道`Get-Content`通过`Out-String`：

```
[xml] $xml = Get-Content 'foo.xml' | Out-String
$xml.foo.bar = 'baz'
$xml.Save('foo.xml') 
```

我刚刚对此进行了测试：没有`Out-String`，我在 Visual Studio 中看到了消息。使用`Out-String`，我没有，并且评论被单独留下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-07T16:48:37.557

使用`Select-Xml`cmdlet 而不是`Get-Content`

使用： $xml = ( Select-Xml -Path foo.xml -XPath / ).Node

参考：[https ://blog.stangroome.com/2014/02/10/powershell-select-xml-versus-get-content/](https://blog.stangroome.com/2014/02/10/powershell-select-xml-versus-get-content/)

# ios - 下拉刷新 UIWebView（缩放问题）

> ID：10761108
> 
> 赞同：0
> 
> 时间：2012-05-25T20:43:53.637
> 
> 标签：ios, webview, scroll, zooming

[我正在使用此处](https://stackoverflow.com/questions/3223627/how-to-refresh-a-uiwebview-by-a-pull-down-and-release-gesture)描述的 EGO 拉取和刷新代码来实现“下拉​​刷新”功能到`UIWebView`. 一切正常，直到我缩放 webView。

如果我向它添加子`webView.scrollView`元素，它滚动正常，但在 webView 缩放时不会调整大小。它保持完全一样的大小。如果我设置`autoresizeMask`为 FlexibleWidth 或设置`autoresizeSubviews`为 YES。

编辑：

换句话说，我的问题是：**为什么 WebView 内容可以缩放，而我自己的视图添加到同一个地方（in `UIWebView`）却不行？**另外，为什么它可以滚动，但不能缩放？

![在此处输入图像描述](../Images/a07d457b51e20f4ab6e83cfeb8d24c8a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:22:10.490

这更多的是对正在发生的事情的解释，而不是实现预期行为的方法：

滚动视图有一个框架，它本质上是滚动视图包含的内容的查看窗口。当您将子视图添加到滚动视图时，视图被“添加”（实现不清楚）到滚动视图的内容视图，该内容视图通常大于滚动视图的框架。滚动视图的内容偏移量，结合滚动视图框架的大小决定了内容视图的哪一部分是可见的。当您缩放 Web 视图时，内容视图的大小会发生变化，但您的 EGO 视图不会收到调整大小的消息，因为内容视图不是真正的 UIView，或者滚动视图以某种方式阻止了其子视图的大小调整（只是猜测实现）。

可能有比以下建议更简单的方法：

如果您不处理 Web 视图，而只处理滚动视图，则可以继承 UIScrollView 并覆盖 setContentSize 以使用它手动调整 EGO 视图的大小。但是，由于您不能只换出 web 视图中的滚动视图，您可能会考虑使用方法调配来换出 web 视图滚动视图的 setContentSize 方法的实现。

但是，如果我是你，我会考虑你为什么希望 EGO 视图首先调整大小。它不是 Web 视图内容的一部分，而是用户可以用来修改该内容的操作……所以看起来您希望它保持可读/可用的大小。您还可以考虑 Web 视图的内容，以及是否需要首先允许用户调整其大小。使用标准新闻提要，最好将其锁定为理想的观看尺寸。

编辑：

查看图表后，看起来您想要的不是调整 EGO 视图的大小，而是更改它的位置，使其始终居中于 Web 视图的顶部。最安全的方法是成为 Web 视图的滚动视图的委托，跟踪原始委托的任何内容（在一定程度上独立于实现）并将所有协议方法转发给原始委托。然后，在scrollViewDidScroll方法（和或scrollViewDidZoom等。任何需要的）中，您可以将EGO框架的origin.x设置为contentOffset.x。

# c# - 如何使用 dapper 获得可为空的 int[]？

> ID：10761110
> 
> 赞同：3
> 
> 时间：2012-05-25T20:43:56.757
> 
> 标签：c#, sql-server-2008, dapper

如果我想获得一堆包含单列的行`int`，使用 Dapper，并且此结果集可能为空。使用 Dapper 查询这些数据的最佳方式是什么？

例如，如果我有以下方法返回我想要的：

```
public void int[] GetInts()
{

    conn.Query<int?>("select 123 where 1=1")
        .Where(x=> x.HasValue)
        .Select(x => x.Value)
        .ToArray();
} 
```

如果我将这一行更改为：

```
conn.Query<int>("select 123 where 1=0").ToArray(); 
```

没有结果时出现转换错误。

堆栈跟踪如下，异常只是在强制转换时未设置为对象实例的对象引用`(T)next`：

```
at Dapper.SqlMapper.<QueryInternal>d__13`1.MoveNext() in .\SqlMapper.cs:line 611
 at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)   
  at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)    
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in .\SqlMapper.cs:line 539 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:53:51.803

好吧，如果它是一个 int，则`Where`and`Select`没有任何意义。很确定你想删除它们。

```
conn.Query<int>("select 123 where 1=0")
    .ToArray(); 
```

当你这样做时，你有什么问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:21:27.970

我的问题原来是我在做一个`LEFT JOIN`in 代码，但是当我试图重现我使用的错误时`INNER JOIN`，我无法重现相同的行为。使用`LEFT JOIN`，返回值为 的单行，`NULL`这就是为什么我在`NULL`和之间出现转换错误的原因`int`。

# android - 在 android XML 中使用变量或以其他方式设置 XML 属性

> ID：10761113
> 
> 赞同：0
> 
> 时间：2012-05-25T20:44:04.207
> 
> 标签：android, xml, android-xml

假设我有一种想要改变的风格：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<style parent="Widget.TitlePageIndicator" name="Widget.MyTitlepageIndicator">
    <item name="footerColor">#14A804</item>
</style>
</resources> 
```

我想改变“footerColor”的值，更具体地说是在光谱中循环。这可能吗？我将如何获得对该内存地址的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:48:35.927

据我所知，您无法更改此资源文件中的值。这就是资源文件的全部意义所在，具有不变的静态资源。

您可以做的是在此资源文件中定义不同样式的多个定义，并更改应用于布局元素的样式。

这可以使用[这个答案](https://stackoverflow.com/questions/2016249/how-to-programmatically-setting-style-attribute-in-a-view)来完成。

希望有帮助！

# c# - 微软合作伙伴门户项目执行期间的异常

> ID：10761115
> 
> 赞同：1
> 
> 时间：2012-05-25T20:44:31.637
> 
> 标签：c#, ms-project

我有微软项目合作伙伴门户的代码。当我执行代码（按 f5）和项目加载时，我得到了异常

> 在 MetadataCache 中找不到名称为“adx_website”的实体。

我将动态 crm 的 webservice url 更改为本地的。也许我必须在 crm 的同一台服务器上执行项目。

# powershell - 可以使用 Powershell 从 gui 中选择选项吗？

> ID：10761116
> 
> 赞同：0
> 
> 时间：2012-05-25T20:44:32.760
> 
> 标签：powershell, vb6, powershell-2.0

我必须将手动构建过程转换为自动构建过程。我正在经历这个过程，并确定了几个我确定如何处理的领域。

我是powershell的新手，所以我不能直接说是否可以做某事。

我有这个弹出的 vb6 表单。它有几个选项卡和一些下拉列表、文本字段和按钮。

用户将手动从下拉列表中选择一个选项并填写某些文本字段，然后点击按钮进行保存。

是否仍然可以在出现对话框的情况下运行此应用程序，然后以某种方式让 powershell 填写必填字段然后进行保存？

我有点想也许就像在 jquery 中你可以通过 ids 选择字段然后将值填充到它们中。

如果这是不可能的，是否需要修改应用程序以接受参数，然后它会使用它填充值？

或者我是否必须提取执行它的代码并以某种方式将其转换（我真的不想做的事情，因为我真的不完全了解应用程序是如何工作的）到 powershell？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:28:00.697

你有2个选择——

1.  像这样使用 Powershell 自动化您的 VB6 UI - [http://msdn.microsoft.com/en-us/magazine/cc163301.aspx](http://msdn.microsoft.com/en-us/magazine/cc163301.aspx)

2.  使用 Powershell 重写所有内容，包括 GUI - [http://blogs.technet.com/b/csps/archive/2011/12/07/guiapp.aspx](http://blogs.technet.com/b/csps/archive/2011/12/07/guiapp.aspx)

**[更新链接1]：**

我下载了 MSDN 中提供的代码并运行它。它只是工作！这里我解释一下——

1.  我将代码解压缩到一个位置 - F:\Angshuman\Code\PowershellUIAutomation\TestRun
2.  有 2 个文件夹 - CustomUICmdletsLIb 和 TheAppToTest
3.  首先从所有 .sln 和 .cs 文件中删除只读
4.  打开 。各自的解决方案和构建
5.  启动 Windows Powershell (x86) [如果您使用 64 位]
6.  打开两个 ps1 脚本 - Microsoft.PowerShell_profile.ps1 和 testScenario.ps1
7.  在 Microsoft*.ps1 脚本中进行此更改 - 即 DLL 的正确路径

    sl 'F:\Angshuman\Code\PowershellUIAutomation\TestRun\CustomUICmdletsLib\bin\Debug'

    设置位置 F:\Angshuman\Code\PowershellUIAutomation\TestRun

并执行它

1.  在 testScenario 脚本中进行此更改 - 即路径

> 调用项
> 
> 'F:\Angshuman\Code\PowershellUIAutomation\TestRun\TheAppToTest\bin\Debug\TheAppToTest.exe'

现在执行脚本。系统将提示您显示完全自动化的 UI。

希望这会有所帮助，您现在应该能够使用您的 VB6 UI 实现相同的效果

# iphone - 隐藏状态栏后无法重新定位 UIView

> ID：10761119
> 
> 赞同：0
> 
> 时间：2012-05-25T20:44:39.453
> 
> 标签：iphone, ios

隐藏状态栏时，我遇到了 UIViewController 主视图的定位问题。我调用隐藏状态栏的调用，但视图不会向上转换以占用状态栏留下的空间，即使尝试以编程方式重新定位框架也是如此。

下面是视图的屏幕截图，以蓝色边框为边界。尽管我尽了最大的努力，但我似乎无法将其翻译成占据状态栏的空间。但是，我确实注意到，当旋转手机时，它确实完全占据了空间，尽管我不知道在最初进入视图时要调用什么来实现这一点。任何想法如何重新定位视图？

![在此处输入图像描述](../Images/82b021326b01cf5c51164b88c5907ee0.png)

我隐藏状态栏并尝试使用以下代码重新定位视图：

```
[self setWantsFullScreenLayout:YES];
[[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone];

CGRect translatedFrame = self.view.frame;
translatedFrame.origin.y -=20;
self.view.frame = translatedFrame;

[self.view.layer setBorderColor:[UIColor blueColor].CGColor];
[self.view.layer setBorderWidth:1.0f]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:35:07.253

您何时何地隐藏状态栏？根据我的经验，只有将代码放置在`viewWillAppear:`

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [[UIApplication sharedApplication] setStatusBarHidden:YES];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:18:52.040

您需要添加此行以调整视图大小。

```
[self setWantsFullScreenLayout:YES];
[[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone];

CGRect translatedFrame = self.view.frame;
translatedFrame.origin.y -=20;
translatedFrame.size.height += 20; // Add 20px
self.view.frame = translatedFrame;

[self.view.layer setBorderColor:[UIColor blueColor].CGColor];
[self.view.layer setBorderWidth:1.0f]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:25:37.113

我将问题缩小到我正在使用的库（View Deck）。我认为每个人的建议都适用于正常情况，但鉴于 View Deck 创建了一个带有视图控制器的容器，我认为它因此无法正确渲染。

# android - PreferenceScreen 没有子标签

> ID：10761120
> 
> 赞同：0
> 
> 时间：2012-05-25T20:44:39.483
> 
> 标签：android, preferencescreen

出于某种奇怪的原因，当我在 preferenceScreen.xml 上执行 ctrl+space 时，我遇到了这个奇怪的错误

> 错误是：PreferenceScreen has no child tags & PreferenceScreen has no known child tags

我正在使用日食。

你如何解决这个问题？或者我应该只对其进行编码并希望我不会出现拼写错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T13:25:44.030

它不需要图书馆的帮助就可以工作。尽管我仍然觉得奇怪的是，其他一些项目确实具有针对不同类型的自动帮助，例如 EditTextPreference 或 CheckBoxPreference。

# boost - 由于 OS X Snow Leopard 上的 boost 链接错误，构建 gpuocelot 失败

> ID：10761122
> 
> 赞同：0
> 
> 时间：2012-05-25T20:45:06.870
> 
> 标签：boost, cuda, x86, osx-snow-leopard, amd-processor

我在带有 gcc 4.5.3 和 boost @1.49.0_0+universal (active) (boost 通过 macports 安装) 的 mac snow 10.6.8 上使用了[gpuocelot](http://code.google.com/p/gpuocelot/)的最新主干版本。

我运行 scons 我得到

```
.release_build/ocelot/ptx.os .release_build/ocelot/ptxgrammar.os -L/usr/lib -lboost_system-mt -lboost_filesystem-mt -lboost_thread-mt -ldl ld: library not found for -lboost_system-mt collect2: ld returned 1 exit status 
```

[这](https://stackoverflow.com/questions/9423096/when-trying-to-build-gpuocelot-running-into-boost-link-errors-on-os-x-lion)会在 OS X Lion 上报告失败。有类似问题的人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T13:21:18.677

你应该试试这个命令行：

```
.release_build/ocelot/ptx.os .release_build/ocelot/ptxgrammar.os -L/opt/local/lib -lboost_system-mt -lboost_filesystem-mt -lboost_thread-mt -ldl 
```

事实上，在我的系统上，Mac 端口在**/opt/local/lib**而不是 /usr/lib 中安装了 boost 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T16:13:29.143

进入 gpuocelot/ocelot/scripts 目录并相应地修改 build_environment.py

> def getBoost（环境）：

# jquery - 让 jQuery jPages 插件与 EmberJS 和 Ajax 调用一起工作

> ID：10761124
> 
> 赞同：1
> 
> 时间：2012-05-25T20:45:20.570
> 
> 标签：jquery, ember.js

我正在尝试让 jPages 与 EmberJS 一起使用。jPages 似乎试图绑定到由于 Ajax 调用而无法及时加载的元素。有没有人让这个工作？这是 jsfiddle：http: [//jsfiddle.net/stevenng/8hDRJ/33/](http://jsfiddle.net/stevenng/8hDRJ/33/)

**车把**：

```
<div class="songs">
    <script type="text/x-handlebars">
    {{#view Songs.songsView}}
        <div id="song-items">
        {{#each Songs.songsController}}
            <div class="song">
                <p>{{artist}}</p>                  
            </div>
        {{/each}}
        </div>
        <div class="pagination"></div>
    {{/view}}
    </script>
</div>​ 
```

**JavaScript**

```
Songs.songsController = Em.ArrayController.create({
    content: [],
    addSong: function(song) {
        this.pushObject(song);
    },
    getSongs: function() {
        var self = this;
        $.ajax({
            url: 'http://test.com/getSongs?callback=?',
            dataType: "jsonp",
            success: function(data){
              var obj = $.parseJSON(data);
              for (var i=0; i<obj.songs.length; i++) {
                self.addSong( Songs.song.create( obj.songs[i]) );    
              }
            }
        });
    }
});

Songs.songsView= Em.View.extend({
    didInsertElement: function() {
      $('.pagination').jPages({
        containerID: "song-items",
        perPage: 2
      });  
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T10:04:26.627

`jPages`正如您所说，当您实例化插件时，歌曲元素尚未在 DOM 中。这就是为什么它不起作用。

`loaded`我的解决方案是在控制器上创建一个属性。当它设置为 true 时，视图知道内容已加载并且可以实例化`jPages`，请参见[http://jsfiddle.net/pangratz666/dpqCn/](http://jsfiddle.net/pangratz666/dpqCn/)：

**车把**：

```
<script type="text/x-handlebars" data-template-name="song" >
    {{content.artist}}
</script>​ 
```

**JavaScript**：

```
Songs.songsController = Em.ArrayController.create({
    content: [],
    getSongs: function() {
        var self = this;
        $.ajax({
            success: function(data) {
                var songs = data.songs.forEach(function(song){
                    return Songs.Song.create(song);
                });

                // add all songs at once
                self.pushObjects(songs);

                // set the loaded property to true to indicate that the content is filled
                self.set('loaded', true);
            }
        });
    }
});

Songs.SongsView = Ember.ContainerView.extend({
    childViews: 'songsView paginationView'.w(),
    loadedBinding: 'controller.loaded',

    // invoked when the loaded property of the controller is changed
    _loadedChanged: function() {
        if (this.get('loaded')) {
            // get the songsView instance
            var songsView = this.get('songsView');

            // call jPages plugin on next run loop
            // when content has been filled and elements have been inserted to DOM
            Ember.run.next(this, function() {
                this.$('.holder').jPages({
                    containerID: songsView.get('elementId')
                });
            });
        }
    }.observes('loaded'),

    paginationView: Ember.View.create({
        classNames: 'holder'.w()
    }),

    songsView: Ember.CollectionView.create({
        contentBinding: 'parentView.controller.content',
        tagName: 'ul',
        itemViewClass: Ember.View.extend({
            templateName: 'song'
        })
    })
}); 
```

* * *

*另一个注意事项*：您的命名约定不符合 Ember。请参阅 Emberist 的[博客文章](http://www.emberist.com/2012/04/09/naming-conventions.html)。所以类是`UpperCase`，属性和实例是`lowerCase`。

# doxygen - Doxygen 相关页面

> ID：10761125
> 
> 赞同：2
> 
> 时间：2012-05-25T20:45:24.493
> 
> 标签：doxygen

我正在寻找一种方法来自定义相关页面的标题；我的语言环境是法语，所以我得到

> 页面关联

但我想把其他文字放在适当的位置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-26T07:04:01.750

首先使用创建一个布局文件

```
doxygen -l 
```

`DoxygenLayout.xml`然后用文本编辑器打开生成的并查找该行

```
<tab type="pages" visible="yes" title="" intro=""/> 
```

并将其替换为

```
<tab type="pages" visible="yes" title="Your Title" intro=""/> 
```

最后在你的 doxygen 配置文件中提到布局文件，如下所示

```
LAYOUT_FILE = DoxygenLayout.xml 
```

有关更多详细信息，请参阅[https://www.doxygen.org/manual/customize.html#layout](https://www.doxygen.org/manual/customize.html#layout)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-05T00:19:45.500

口音：INPUT_ENCODING = "编辑器中使用的编码" 北美的默认 Visual Studio 是 CP1252。Doxygen 在 UTF-8 内部工作，因此它必须在两者之间进行转换。

# javascript - 指南针/咖啡可以做到这一点吗？另一种方法？

> ID：10761126
> 
> 赞同：0
> 
> 时间：2012-05-25T20:45:28.917
> 
> 标签：javascript, css, compass-sass

*如果*浏览器支持渐变和圆角，我想要做的是使用 css3 作为按钮，如果不支持，则使用设置图形。

我可以使用指南针和咖啡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T20:48:46.803

我很确定纯 css 是不可能的，并且 compass 只是将代码转换为纯 css。如果您想这样做，则必须使用某种类型的 Javascript 来根据浏览器加载不同的样式表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:52:46.897

单靠 CSS 不能做你想做的事。

[Moderizr](http://modernizr.com/)是一个 JavaScript 实用程序，可以帮助您检测浏览器支持哪些功能，并允许您相应地运行脚本。

# ruby-on-rails - 有没有办法修改 Rails 模板的缩进样式？

> ID：10761133
> 
> 赞同：3
> 
> 时间：2012-05-25T20:46:00.127
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如果用户真的想利用选项卡。有没有办法永久设置 Rails 的代码缩进样式？如果我可以编辑一些配置文件来实现它，那就太好了。

例如，当我使用脚手架“rails generate scaffold Articals name:string”时，自动生成的代码是 4 空格缩进样式。这样我就不需要每次都使用编辑器手动转换它们。

我不是在问编程或语法问题。Rails 不是一种语言。这都是关于设置和配置的。或者我可以编写一个程序在后台自动转换它们（不是最佳实践）。

如果 Rails 真的做不到，团队会在未来添加吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:53:10.203

由于 OP 已更新问题以解决修改脚手架模板的问题，而不仅仅是缩进样式，因此以下链接可能是一个有用的起点。

*   [http://asciicasts.com/episodes/216-generators-in-rails-3](http://asciicasts.com/episodes/216-generators-in-rails-3)（参见底部的“自定义模板”部分）

*   [http://zigzag.github.com/2010/01/18/customizing-your-scaffold-template-become-easier-in-rails3.html](http://zigzag.github.com/2010/01/18/customizing-your-scaffold-template-become-easier-in-rails3.html)

您还可以参考[创建和自定义 Rails 生成器和模板](http://guides.rubyonrails.org/generators.html)以获取有关如何修改核心模板的更多指导。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:35:42.517

不，没有设置。大多数生成器都使用模板，这些模板本身是由开发人员编写的，标签间距大多为 2。

你问：“或者我可以编写一个程序在后台自动转换它们。”

是的！事实上，你可以在 Ruby 中这样做......它会查看 git 中的所有新文件并用制表符替换四个和两个空格。可能仅当该行以四个和/或 2 个空格开头时，但仍然如此。

# jquery - jQuery - 使用 Div 导航 Dom

> ID：10761134
> 
> 赞同：0
> 
> 时间：2012-05-25T20:46:12.447
> 
> 标签：jquery, html, dom

我不确定如何做到这一点。我正在从一种非常静态的做事方法转变为一种更动态的方法，我的 HTML 看起来像这样：

```
<div id="q2">
    <div class="small">What is your Email Address?<br>
        <span class="smallnotice">Please enter a valid email address.</span></div>
    <div class="notice">That is an invalid email address.<br><br></div><input type="text" name="email" id="email" data-format="email|32" value="email@domain.com" tabindex="2" autocomplete="off" class="formidle" style="width: 280px; ">
</div> 
```

q2 div ID 是动态的，因此电子邮件地址可以在 q3、q4 等中。

我试图在 jQuery 中完成的是在用户开始输入时删除 class="notice" 元素。

当我静态地这样做时，我的元素是 q5，我可以通过执行以下操作来删除该元素：（这有效）

```
$($('#q5 > div')[1]).remove(); 
```

但现在我似乎无法弄清楚如何删除那个元素，因为我不知道我们在什么“q”中。

只是为了让你知道它是如何被调用的：

```
$("input[type='text']").keydown(function(e){
   $("input[type='text']").each( function() {
        if( $(this).hasClass("formerror") )
        {
            $(this)
                .removeClass("formerror formidle")
                .addClass("formfocused");
            $( $('#q5 > div')[1]).remove();
        } 
```

所以我只需要一种方法来删除该 div 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T20:53:35.950

我想你只想要[兄弟姐妹（）](http://api.jquery.com/siblings/)：

```
$("input[type='text']").keydown(function(e){
    $(this).siblings("div.notice").remove();
}); 
```

测试在这里：http: [//jsfiddle.net/fRTn2/](http://jsfiddle.net/fRTn2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:51:11.917

尝试：

```
$(this).closest('div').find('.notice').remove(); 
```

# tsql - 插入表变量失败并选择

> ID：10761138
> 
> 赞同：-1
> 
> 时间：2012-05-25T20:46:28.357
> 
> 标签：tsql

我收到一个语法错误，说这个选择格式不正确......不知道为什么。

```
Insert into @MyTableVariable (select @new_identity, Name from Company where soemField = 'some text value') 
```

@new_identity 只是在前一个插入语句之后设置为 scope_identity() 的 int var

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:49:42.643

```
Insert into @MyTableVariable (newIdentityColName, nameName)
   select @new_identity, Name from Company where someField = 'some text value' 
```

# jquery - 用jquery获取UL列表内容

> ID：10761139
> 
> 赞同：1
> 
> 时间：2012-05-25T20:46:28.773
> 
> 标签：jquery, html, html-lists

我需要从 UL 列表中获取内容，然后才能使用它来发送电子邮件。但我坚持在 jquery 中获取 ul 列表。我搜索并发现以下内容：

```
$(document).ready(function(){
    $("#send").click(function() { //When trigger is clicked...
            var optionTexts = [];
            $("#thelist").each(function() { optionTexts.push($(this).text()) });
            var text = '"' + optionTexts.join('"<br/> "') + '"';

            $("#result").append(text);

        });
    }); 
```

但这会返回页面内的所有内容：S 这是我的 ul 列表：

```
<ul id="thelist">
  <li style="height: 65px; display: list-item; ">
    <ul>
      <li class="botHeader">
        "Evelin dice"
                <span>14:37:52</span>
      </li>
      <li class="botMsg">
        "Hola, bienvenido"
      </li>
    <ul>
  </li>
  <li style="height: 26px; display: list-item; ">
    <ul>
      <li class="userHeader">
        "Usted dice"
                <span>14:37:59</span>
      </li>
      <li class="userMsg">
        "Hola como estas"
      </li>
    <ul>
  </li>
  <li style="height: 39px; display: list-item; ">
    <ul>
      <li class="botHeader">
        "Evelin dice"
                <span>14:37:59</span>
      </li>
      <li class="botMsg">
        "Gracias por preguntar, todo bien"
      </li>
    <ul>
  </li>
</ul>

<a href="#" id="send">enviar</a>
<div id="result">

</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T20:50:49.857

这应该一次性完成所有工作，并且没有任何临时变量：

```
$('#result').append(
    $('#thelist').find('li').filter(function() {
        return $(this).find('ul').length === 0;
    }).map(function(i, e) {
        return $(this).text();
    }).get().join('<br/>')
); 
```

您必须只考虑`<li>`没有任何`<ul>`后代的元素。

[在http://jsfiddle.net/alnitak/JVS7d/](http://jsfiddle.net/alnitak/JVS7d/)工作演示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:04:36.553

首先，您的标记无效。你错过了`</ul>`你内心清单的结束。其次，您只需要`li`为您的`$.each(...)`功能添加选择器。

```
$(document).ready(function(){
    $("#send").click(function() { //When trigger is clicked...
        var optionTexts = [];
        $("#thelist li").each(function() { optionTexts.push($(this).text()) });
        var text = '"' + optionTexts.join('"<br/> "') + '"';

        $("#result").append(text);
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T20:50:32.230

在我看来你应该`$("#thelist").each(function...`改变`$("#thelist ul li").each(function...`

# ruby-on-rails - 使用 Rails 进行敏捷 Web 开发：找不到 id=1 的产品

> ID：10761151
> 
> 赞同：0
> 
> 时间：2012-05-25T20:47:18.960
> 
> 标签：ruby-on-rails, ruby, testunit

我对 line_item 模型的破坏单元测试失败，出现错误“找不到 id=1 的产品”。Rails 似乎无法销毁我的 line_item，因为它在从数据库中获取它时会引发异常。这是我的 LineItem 模型：

```
class LineItem < ActiveRecord::Base
  belongs_to :product
  belongs_to :cart

  def total_price
    product.price * quantity
  end
end 
```

这是测试套件：

```
require 'test_helper'

class LineItemsControllerTest < ActionController::TestCase
  setup do
    @line_item = line_items(:one)
    Rails.logger.debug(@line_item.to_yaml)
    Rails.logger.debug(Product.all.to_yaml)
  end

  test "should get index" do
    get :index
    assert_response :success
    assert_not_nil assigns(:line_items)
  end

  test "should get new" do
    get :new
    assert_response :success
  end

  test "should create line_item" do
    assert_difference('LineItem.count') do
      post :create, product_id: products(:ruby).id
    end

    assert_redirected_to cart_path(assigns(:line_item).cart)
  end

  test "should show line_item" do
    get :show, id: @line_item
    assert_response :success
  end

  test "should get edit" do
    get :edit, id: @line_item
    assert_response :success
  end

  test "should update line_item" do
    put :update, id: @line_item, line_item: @line_item.attributes
    assert_redirected_to line_item_path(assigns(:line_item))
  end

  test "should destroy line_item" do
    Rails.logger.debug "Breaking!"
    assert_difference('LineItem.count', -1) do
      delete :destroy, id: @line_item
    end

    assert_redirected_to cart_path(path)
  end
end 
```

这是我记录的部分：

```
 Breaking!
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "line_items" 
Processing by LineItemsController#destroy as HTML
  Parameters: {"id"=>"980190962"}
  [1m[36mLineItem Load (0.1ms)[0m  [1mSELECT "line_items".* FROM "line_items" WHERE "line_items"."id" = ? LIMIT 1[0m  [["id", "980190962"]]
  [1m[35mProduct Load (0.1ms)[0m  SELECT "products".* FROM "products" WHERE "products"."id" = ? LIMIT 1  [["id", 1]]
Completed 500 Internal Server Error in 3ms
  [1m[36m (0.1ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mLineItem Load (0.1ms)[0m  [1mSELECT "line_items".* FROM "line_items" WHERE "line_items"."id" = ? LIMIT 1[0m  [["id", 980190962]]
--- !ruby/object:LineItem
attributes:
  id: 980190962
  product_id: 1
  cart_id: 1
  created_at: 2012-05-25 20:37:17.000000000 Z
  updated_at: 2012-05-25 20:37:17.000000000 Z
  quantity: 1
  product_price: 

  [1m[35mProduct Load (0.2ms)[0m  SELECT "products".* FROM "products" 
---
- !ruby/object:Product
  attributes:
    id: 207281424
    title: Programming Ruby 1.9
    description: Ruby is the fastest growing and most exciting dynamic language out
      there.  If you need to get working programs delivered fast, you should add Ruby
      to your toolbox.
    image_url: ruby.png
    price: 49.5
    created_at: 2012-05-25 20:37:17.000000000 Z
    updated_at: 2012-05-25 20:37:17.000000000 Z 
```

**编辑：**这是产品型号：

```
class Product < ActiveRecord::Base
  has_many :line_items

  before_destroy :ensure_not_referenced_by_any_line_item

  # Validation
  validates :title, :description, :image_url, presence: true
  validates :title, length: {
    minimum: 10,
    message: "must be at least %{count} characters long"
  }
  validates :price, numericality: { greater_than_or_equal_to: 0.01 }
  validates :title, uniqueness: true
  validates :image_url, allow_blank: true, format: {
    with: %r{\.(gif|jpg|png)$}i,
    message: 'must be a URL for GIF, JPG or PNG image.'
  }

  private

  def ensure_not_referenced_by_any_line_item
    if line_items.empty?
      return true
    else
      errors.add :base, 'Line items present'
      return false
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:10:32.727

这是工厂通常比铁路社区中的固定装置更受青睐的原因之一。Fixtures 不会自动加载它们的关联，因此往往很脆弱。您的夹具的 product_id 为 1，但该产品不存在。

我不确定如何解决您的特定问题，但我建议您：

1.  在您的测试中创建一个 id=1 的产品。
2.  创建一个 id=1 的 Product 固定装置并将其加载到您的设置中
3.  切换到工厂（最好是这个）

**编辑**

[如此处](http://ar.rubyonrails.org/classes/Fixtures.html)所述，您还可以使用标签引用进行关联。因此，如果您有一个名为“tv”的产品夹具，您可以删除 line_item 夹具的 product_id 字段并将其替换为`product: tv`

# c#-4.0 - Form.Show 导致松散的行选择

> ID：10761154
> 
> 赞同：0
> 
> 时间：2012-05-25T20:47:27.187
> 
> 标签：c#-4.0, datagridview

我正在使用以下代码设置当前行

```
private void dataGridView1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
{
    gSelectedPlant = StaticClass.GlobalValue;

    dataGridView1.CurrentCell = dataGridView1.Rows[gSelectedPlant].Cells[0];
    dataGridView1.Rows[gSelectedPlant].Selected = true;
    gSelectedPlant = dataGridView1.CurrentCell.RowIndex;
} 
```

在我的第二种形式中，它有一个后退按钮。

```
private void btnCancel_Click(object sender, EventArgs e)
{
    int plantid = StaticClass.GlobalValue;
    //Properties.Settings.Default.PlantId = plantid;

    Program.fPlant = new frmPlant(plantid);
    Program.fPlant.Show();
    this.Hide();

 } 
```

现在第一种形式的数据绑定运行良好。但是在 Program.fPlant.Show() 中，rowselection 恢复为默认值（第一行），但我需要它保持选定的行

# iphone - 如何检查字符串是否等于多个字符串中的任何一个目标c

> ID：10761162
> 
> 赞同：1
> 
> 时间：2012-05-25T20:48:19.890
> 
> 标签：iphone, objective-c

如果我有 5 个 NSString，并且我想查看是否有任何字符串相同，有没有比使用`[string isEqualToString:string2]`一堆时间测试每个字符串更快的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:15:07.360

如果您只有 5 个字符串，可能没有什么比一一比较更快的了。

但是如果你有很多字符串，创建一个包含所有字符串的 NSSet，然后只需检查字符串是否是该集合的成员，使用`-[containsObject:]`.

# scala - 将本机系统库与 SBT 集成

> ID：10761166
> 
> 赞同：31
> 
> 时间：2012-05-25T20:48:42.000
> 
> 标签：scala, sbt

将各种 SBT 任务与本机库（例如，来自[JOGL](http://jogamp.org/jogl/www/)、[LWGL](http://lwjgl.org/)或[JCuda](http://www.jcuda.de/)的库）集成的好方法是什么？具体来说，

1.  是否有推荐的方法在`run`任务中包含本机库？SBT 邮件列表上的讨论表明了以下可能性：

    *   [修改`JavaOptions`](https://groups.google.com/d/msg/simple-build-tool/o1iGaMi4UeU/uKDWYBP7TPAJ)为 include `-Djava.library.path=<path to native libraries>`，然后修改`run`任务 fork JVM。（有关示例，请参[见此插件。）](https://github.com/philcali/sbt-lwjgl-plugin/blob/master/src/main/scala/LWJGLPlugin.scala)
    *   [使用 SBT`initialize`设置](https://groups.google.com/d/msg/simple-build-tool/o1iGaMi4UeU/lqp1YFtI-AUJ)运行调用`System.setProperty(...)`configure的代码`java.library.path`。再次，`run`必须分叉。
    *   在启动 SBT 之前[将本机库放在类路径中。](https://groups.google.com/d/msg/simple-build-tool/o1iGaMi4UeU/lhMsctSyt5QJ)

    最后一种的优点是`run`不需要fork，缺点是必须在SBT之外进行配置。

2.  我可以在[sbteclipse](https://github.com/typesafehub/sbteclipse)插件生成的 Eclipse 项目中自动包含本机库吗？可以[在后处理步骤中](https://groups.google.com/d/msg/simple-build-tool/lLOOyAzp3fY/ar0xEU1lilAJ)[重写文件。`.project`](https://groups.google.com/d/msg/simple-build-tool/lLOOyAzp3fY/ar0xEU1lilAJ)有示例代码吗？有没有更好的办法？

3.  本机库是否可以包含在由[sbt-assembly](https://github.com/sbt/sbt-assembly)、[sbt-onejar](https://github.com/sbt/sbt-onejar)或[sbt-proguard](https://github.com/siasia/xsbt-proguard-plugin)等插件生成的可运行 Jar 中？

我假设本机库没有直接的 SBT 设置。如果存在类似的东西，上述任务能否透明地处理本机库？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-27T19:32:10.507

从我过去所做的研究来看，只有两种方法可以加载原生库：修改`java.library.path`和使用`System.loadLibrary`（我觉得大多数人都这样做），或者使用`System.load`绝对路径。

正如您所提到的，`java.library.path`在配置 SBT 和 Eclipse 方面弄乱可能很烦人，而且我认为不可能自动为可执行 jar 做。

就这样离开了`System.load`。在编写自己的本机库方面，您可以做的是：

*   创建一个 SBT 任务来编译您的原生源代码（使用`javah`和`gcc`），获取生成的 .so 文件和它所依赖的任何 .so 文件，将它们放入目标目录中的 jar（作为资源）中，并将路径添加到 jar到`unmanagedJars in Compile`.
*   创建一个 Scala 方法来加载库。代替调用`System.loadLibrary`，它将`Class.getResourceAsStream`用于读取库，`File.createTempFile`将其写入文件系统的某个位置，并将`System.load`其加载到 JVM 中。
*   现在不再`System.loadLibrary`像以前那样调用，而是调用`MyClasspathJniLoader.loadLibrary`.

这将适用于 SBT 运行、Eclipse 和可执行 jar，无需任何额外配置（尽管我不知道 proguard 如何知道要包含哪些资源）。

现在对于已经编写好的第三方原生库，其中一些像[jblas](http://www.jblas.org)已经使用了这种“fat jar”方法。如果他们希望您进行设置`java.library.path`，然后`System.loadLibrary`在他们喜欢的时候打电话给他们，那么您需要做一些魔术来完成这项工作。

我没有尝试过，但这个解决方案可能有效：

*   使用类似的 SBT 任务将其本机路径上的所有库作为资源放入 jar 中，并将该 jar 放在 clsaspath 中。
*   创建一个 Scala 方法，该方法接受一个函数和一个库名称列表，创建一个临时目录，将这些库从 jar 的资源中读取到临时目录中的文件中，将临时目录添加到`java.library.path`，调用传入的函数，最后恢复`java.library.path`回到以前的样子。
*   当您第一次调用本机库时（当它可能会静态初始化并进行`System.loadLibrary`调用时），将该特定调用与它将加载的库列表一起包装在您的方法中。这样，当它调用时，它`System.loadLibrary`的所有库都将打开`java.library.path`并成功加载。

显然这很烦人，因为您必须在使用第三方库之前手动初始化它，但是包装所有初始化点（您的主要功能和测试初始化​​）似乎比让所有工具`java.library.path`正确设置更可行. 如果您已经在第三方库之上拥有自己的抽象层，这可能会比这更容易，因此您实际上只需要包装一个初始化点。

如果这看起来是一个现实的解决方案，如果您感到困惑，我可以添加有关 SBT 任务或 Scala 包装器方法的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-29T08:12:34.143

有一个简单的方法。

假设原生库存储在**lib_extra**目录中

1.  将 jna 添加到 libraryDependencies：

    > libraryDependencies ++= Seq("net.java.dev.jna" % "jna-platform" % "4.1.0")

2.  将这些代码添加到 build.sbt：

    > 编译中的 unmanagedResourceDirectories += baseDirectory.value / "lib_extra"
    > 
    > includeFilter in (Compile, unmanagedResourceDirectories):= " *.dll,* .so"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-29T09:13:24.233

在 Osx 下，如果`/lib/*.jnilib`在`sbt test`.

`[error] java.lang.UnsatisfiedLinkError: Fatal execution error, caused by no jniortools in java.library.path`

您可以使用以下代码代替`System.loadLibrary("jniortools")`.

```
new File("lib").listFiles().map(_.getAbsolutePath).filter(_.endsWith("jniortools.jnilib")).foreach(System.load) 
```

# sql - 如果不存在，则 DB2 插入并选择

> ID：10761169
> 
> 赞同：1
> 
> 时间：2012-05-25T20:49:02.430
> 
> 标签：sql, select, insert, db2

我有一个 DB2 数据库表

```
Users
------
userId: BIGINT 
```

我需要从表中为用户返回一行。如果该行不存在，则应将其插入并返回。是否有一个语句可以做到这一点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T22:15:43.387

[`MERGE`](http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.sql.ref.doc/doc/r0010873.html)当 ID 不存在于表中时，您可以使用插入，如下所示：

```
MERGE INTO Users u (userId) 
USING (VALUES (123)) AS m (userId)
ON u.userId = m.userId
WHEN NOT MATCHED THEN
        INSERT (userID)
        VALUES (m.userId)
ELSE IGNORE 
```

还有一个语句允许您获取插入到表中的内容（`data-change-table-reference`在[`INSERT`](http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.sql.ref.doc/doc/r0000970.html)页面上搜索）：

```
SELECT *
FROM NEW TABLE (
    INSERT INTO Users(userId)
    VALUES (123), (234)
) 
```

不幸的是，您不能将这两个语句组合在一起以在一个语句中完成所有操作。我认为，如果您需要唯一值，您可以做的最好的事情就是将`INSERT`方法与[复合 SQL](http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.sql.ref.doc/doc/r0004239.html)一起执行并处理[`-803`SQLCODE](http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.messages.sql.doc/doc/msql00803n.html)。

# php - MySQL：如何在两个主键必须匹配的情况下进行重复键更新？

> ID：10761180
> 
> 赞同：3
> 
> 时间：2012-05-25T20:49:40.653
> 
> 标签：php, mysql, mysqli

我需要能够使用 mysqli->multi_query 在一个查询调用中运行以下所有内容，这就是为什么这很棘手。我有一个包含以下列的表：

*   ID
*   电子邮件
*   event_promo_code
*   event_id

`id`运行脚本时，如果AND都`event_id`匹配现有记录（不仅仅是一个键或另一个键），我需要能够插入新行或更新一行。

我现在拥有的是：

```
INSERT INTO `rsvps` 
SET id='$rsvpID', email='$rsvpEmail', 
      event_promo_code='$rsvpEventCode', event_id='$eventID' 
ON DUPLICATE KEY UPDATE id='$rsvpID', 
      email='$rsvpEmail', event_promo_code='$rsvpEventCode', event_id='$eventID'; 
```

`id`是我的主键。如果我也设置`event_id`为键，它会在 id 匹配记录或事件匹配记录时进行更新，但不会在更新之前检查两者是否同时匹配。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:04:49.613

（*升级到答案*）

表上的唯一`UNIQUE`约束应该在组合列上定义`(id, event_id)`。听起来这可能也应该是您的主键：

```
ALTER TABLE rsvps DROP PRIMARY KEY, ADD PRIMARY KEY (id, eventid); 
```

（显然，您还需要已定义的`DROP`任何其他键）。`UNIQUE`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T20:54:40.260

考虑使用[REPLACE](http://dev.mysql.com/doc/refman/5.0/en/replace.html)命令。`id`对于您的情况，从and创建唯一索引`event_id`：

> REPLACE 的工作方式与 INSERT 完全相同，只是如果表中的旧行与 PRIMARY KEY 或 UNIQUE 索引的新行具有相同的值，则在插入新行之前删除旧行。请参见第 13.2.5 节，“INSERT 语法”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T20:54:23.490

```
INSERT INTO rsvps (id, email, event_promo_code, event_id)
 values('$rsvpID', '$rsvpEmail', '$rsvpEventCode', '$eventID')
 ON DUPLICATE KEY 
 UPDATE id='$rsvpID', email='$rsvpEmail', event_promo_code='$rsvpEventCode', event_id='$eventID'; 
```

# c# - 使用 Visual Studio 发布网站

> ID：10761185
> 
> 赞同：-1
> 
> 时间：2012-05-25T20:50:00.510
> 
> 标签：c#, asp.net, vb.net

我有一个网站hh-alrawi.com，问题是我每次发布网站的主页（Index.aspx）都没有出现，正确的网站网址是：[http ://www.hh-alrawi.com/index .aspx](http://www.hh-alrawi.com/index.aspx)，所以我想知道如何将主页名称放在域名（Index.aspx）之后总是在 URL 之后，我试图编辑我的网络配置，但它不起作用，我的网络配置：

```
<configuration>
  <system.web>

    <compilation debug="true" strict="false" explicit="true" targetFramework="4.0"/>

    <globalization requestEncoding="utf-8" responseEncoding="utf-8"/>

    <customErrors mode="On" defaultRedirect="Index.aspx">
      <error statusCode="404" redirect="Index.aspx" />
    </customErrors>

  </system.web>

  <system.webServer>

    <defaultDocument enabled="true">
      <files>
        <add value="Index.aspx" />
      </files>
    </defaultDocument>

  </system.webServer>    

</configuration> 
```

请检查该网站以了解我所说的:)，谢谢您的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T12:14:07.753

索引文件出现在您放置的任何位置。如果您将其放在 www 目录下，它将在您访问您的网站时自动显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T11:20:58.313

使用 VS 发布您的网站并将其保存到文件系统中。我的托管 hostgator 可以选择上传 zip 文件，如果您也这样做，则压缩生成的文件并上传您网站根文件夹中生成的 zip/rar 或单独上传所有文件。告诉我它是否能解决你的问题。

# javascript - 是否需要将 javascript 回调函数作为参数传递？

> ID：10761188
> 
> 赞同：3
> 
> 时间：2012-05-25T20:50:31.120
> 
> 标签：javascript, callback

到目前为止，在我读过的所有内容中，回调函数都作为参数传递给其他函数：

```
function mycallback(){
    //dosomething
}

function mainfunc(mycallback){
    //do something else
    mycallback();
}

mainfunc(mycallback); 
```

正如您所期望的那样工作，太好了。我的问题是是否需要将回调函数作为参数传递给 mainfunc ？似乎如果你省略这个：

```
function mycallback(){
    //dosomething
}

function mainfunc(){
    //do something else
    mycallback();
}

mainfunc(); 
```

它工作正常，与第一个示例相同。但我没有看到人们以这种方式使用回调。有原因吗？我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:53:56.387

从技术上讲，是的，您可以像这样使用您的功能。将函数作为参数传递的原因与将任何内容作为参数传递的原因相同。

```
mainfunc(eatSevenBurritos);
mainfunc(eatTwoChimichangas); 
```

在某些条件下，也许你宁愿在通过 mainfunc 时吃 7 个墨西哥卷饼。也许在其他情况下，您宁愿在通过 mainfunc 时吃 2 个 chimichangas。

如果您总是要运行相同的功能，那么如果可以的话，请继续在那里编写代码。增加毫无意义的复杂性是没有意义的。但是，如果您需要更改该行为，则需要将其视为参数。

当人们谈论“一流的功能”时，这种行为就是他们的意思。能够将函数视为参数。因为行为是一种数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T20:54:07.413

当您有异步任务时，最好使用回调。

假设`mainfunc`是一个异步操作。

*   在您的第一个示例中，您将特定的回调传递给`mainfunc`. 这使调用者可以灵活地分配操作后要执行的函数。

*   第二个示例，*您*对回调进行了硬编码。除非您有理由这样做，例如预定的后处理功能，否则这是不灵活的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T20:58:09.817

如果您想要一个函数来处理所有回调，则第二种方法可以正常工作。

通常，当您调用使用回调的方法时，您希望它在回调中使用不同的东西，具体取决于您调用它的时间和位置。无需在单个回调函数中处理所有不同的情况（然后必须知道它是哪种情况），您可以简单地为每种特定情况使用一个回调函数。

# php - 强制在 utf-8 中对 php 页面进行编码

> ID：10761192
> 
> 赞同：2
> 
> 时间：2012-05-25T20:50:36.550
> 
> 标签：php, apache, encoding, utf-8, debian

我有一个 VPS（Debian、Apache、MySQL、PHP）

我想强制使用 UTF-8 编码。我已经把这条线：

```
header('Content-type: application/json; charset: UTF-8'); 
```

但字符集仍然是 ISO8859

我还编辑了 php.ini ：/etc/php5/apache2/php.ini

```
mbstring.language=UTF-8
mbstring.internal_encoding= UTF-8
mbstring.http_input=UTF-8
mbstring.http_output=UTF-8
mbstring.detect_order= auto 
```

和 apache conf：

```
nano /etc/apache2/conf.d/charset
AddDefaultCharset UTF-8 
```

一个 iOS 应用程序正在调用我的 php 页面。我给它一个 JSON 输出。但它接收 ISO 字符集...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T21:04:22.233

您的响应标头不正确：

```
header('Content-type: application/json; charset: UTF-8'); 
```

它应该是：

```
header('Content-type: application/json; charset=UTF-8'); 
```

注意`=`代替`:`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T20:54:38.343

您是否看过`utf8-encode`函数： http: [//php.net/manual/en/function.utf8-encode.php](http://php.net/manual/en/function.utf8-encode.php)？

您可能正在向客户端回显未正确编码的文本。Apache 不会为您执行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-20T12:25:41.257

在 .htaccess 文件中，您可以输入：

```
php_value default_charset UTF-8 
```

# c# - System.Configuration.ConfigurationManager.ConnectionStrings 没有配置连接字符串

> ID：10761193
> 
> 赞同：3
> 
> 时间：2012-05-25T20:50:45.540
> 
> 标签：c#, visual-studio, configuration, connection-string, default

每当我尝试在 C# 代码中运行任何内容时，都会收到以下错误：

```
System.InvalidOperationException was unhandled by user code
Message=No connection string configured 
```

它发生在以下代码中。

```
if (System.Configuration.ConfigurationManager.ConnectionStrings["DBContext"] == null)
{
     throw new System.InvalidOperationException("No connection string configured");
}

connectionString = string.Format("{0};Application Name={1}", System.Configuration.ConfigurationManager.ConnectionStrings["DBContext"].ConnectionString, this.applicationName); 
```

`System.Configuration.ConfigurationManager.ConnectionStrings["DBContext"]`空也是如此。我真的找不到任何关于它的东西，一个可能相关的问题：[How to fix "The ConnectionString property has not been initialized"](https://stackoverflow.com/questions/1007786/how-to-fix-the-connectionstring-property-has-not-been-initialized)表明配置文件可能有问题。此刻恐怕我不小心删除了一个配置文件。

另外，只需在[文档](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.connectionstrings.aspx)中阅读：

```
Returns a ConnectionStringSettingsCollection object that contains the contents of the ConnectionStringsSection object for the current application's default configuration. 
```

它包含默认值，所以我倾向于它位于我一定不小心删除的配置文件中。

如果我是对的，我不知道它应该在哪一个或在哪里，以及它应该包含什么。如果我错了，我不知道它来自哪里。那么 System.Configuration.ConfigurationManager.ConnectionStrings["DBContext"] 设置在哪里呢？和/或我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T20:57:12.933

.NET 中的连接字符串来自配置文件 - app.config 用于控制台/Windows 应用程序或 web.config 用于 Web 应用程序。

您可以通过右键单击项目并添加正确的文件来将新的配置文件添加到您的项目中，并确保该配置文件中有以下部分：

```
<configuration>
  <connectionStrings>
    <add name="DBContext" connectionString="data source=.\SQLEXPRESS;Initial Catalog=databasename;Integrated Security=SSPI" providerName="System.Data.SqlClient" />
  </connectionStrings>
  ...
</configuration> 
```

当然，您需要将连接字符串替换为适合您环境的内容（例如，将 databasename 替换为您的数据库名称）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-30T14:16:57.943

可能是您的项目没有引用正确的配置文件。您应该只有一个 app.config 文件。

您需要确保将 app.config 添加到生成 .exe 文件的项目中。

转到您的输出目录并打开 .exe.config 文件。内容是否符合您的预期？

# c++ - prctl(PR_SET_PDEATHSIG, SIGNAL) 在父线程退出时调用，而不是父进程退出

> ID：10761197
> 
> 赞同：6
> 
> 时间：2012-05-25T20:50:51.023
> 
> 标签：c++, multithreading, fork, execv

我有一个分叉给子进程的进程。如果父进程存在，则子进程不应该存在。

所以，如果父进程死了，我会调用`::prctl(PR_SET_PDEATHSIG, SIGKILL)`子进程来杀死它。

最终发生的是父线程调用`pthread_exit`，并且该线程最终成为杀死子进程的催化剂。

这是我的代码：

父级.cpp：

```
#include <sys/prctl.h>
#include <signal.h>
#include <unistd.h>
#include <pthread.h>
#include <iostream>

void* run(void* ptr) {

    std::cout << "thread:" << getpid() << ":" << std::hex << pthread_self() << ":" << std::dec << getppid() << std::endl;
    auto pid = fork();
    if ( pid != 0 ) {
        sleep(1);
    }
    else {
        char* arg = NULL;
        execv("./child", &arg);
    }
    return NULL;
}

int main() {

    std::cout << "main:" << getpid() << ":" << std::hex << pthread_self() << ":" << std::dec << getppid() << std::endl;

    pthread_t threadid;
    pthread_attr_t attr;

    ::pthread_attr_init( &attr );
    ::pthread_attr_setdetachstate( &attr, PTHREAD_CREATE_DETACHED );
    ::pthread_create(&threadid,&attr,run,NULL);

    sleep(6);

    return 0;
} 
```

孩子.cpp：

```
#include <sys/prctl.h>
#include <signal.h>
#include <unistd.h>
#include <iostream>

int main() {
    std::cout << "child:" << getpid() << ":" << std::hex << pthread_self() << ":" << std::dec << getppid() << std::endl;
    ::prctl( PR_SET_PDEATHSIG, SIGKILL );
    sleep(6);

    return 0;
} 
```

在命令行上运行以下命令：

```
$ ./parent 
```

同时，运行以下命令查找 child 的状态：

```
$ for i in {1..10000}; do ps aux | grep child ; sleep .5; done 
```

孩子没了。如果您在 child 中取出 prctl 调用，它不会失效。

[prctl 手册页](http://www.kernel.org/doc/man-pages/online/pages/man2/prctl.2.html)似乎描述了这个调用应该`SIGKILL`在父进程死亡时调用，而不是父线程。

当父进程而不是父线程死亡时，有什么方法可以让 prctl 杀死子进程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-11-07T00:27:23.633

`PR_SET_PDEATHSIG`子进程死亡是因为它在父线程死亡时收到信号。这意味着当创建它的线程死亡时它会收到一个信号。因此，如果您希望子进程依赖于父进程（我假设您的意思是“主”函数死亡时），则从执行父进程的主线程分叉。[如果您在Linux prctl(2) 手册页](http://man7.org/linux/man-pages/man2/prctl.2.html)中查找手册页，他们会明确指出是创建此进程的线程，将信号传递给调用（在您的情况下为子进程）进程：

> *警告*：在这种情况下，“父”被认为是 创建此进程的*线程。*换句话说，信号将在该线程终止时发送（例如，通过 [`pthread_exit(3)`](http://man7.org/linux/man-pages/man3/pthread_exit.3.html)），而不是在父进程中的所有线程终止后发送。

底线：如果您希望它依赖于父进程的执行，则从执行的主线程分叉。简而言之，不要创建线程来分叉子进程，只需从主线程分叉即可。

# c++ - 提取具有可变参数的函数

> ID：10761198
> 
> 赞同：1
> 
> 时间：2012-05-25T20:50:53.310
> 
> 标签：c++, visual-c++

鉴于我有这个功能：

```
void A::IAmCool(int x, ...)
{
        va_list args; 
        va_start (args, x);   
        va_end (args);
} 
```

如何将 var-args 从一个函数传递到另一个函数？我正在寻找这样的东西：

```
void A::extractedFunction() /* this doesn't work */
{
        va_list args; 
        va_start (args, ?????);   
        va_end (args);
}

void A::IAmCool(int x, ...)
{
        extractedFunction();
} 
```

这甚至可能吗？我尝试过使函数内联，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:12:41.090

通常的模式是使用 valist 实现您的主要主力函数，而可变参数函数仅作为“装饰”。然后您可以直接从第三方调用站点使用主要功能。例子：

```
#include <cstdarg>

int vgizmo(int a, std::va_list ap)
{
    // main implementation here!
}

int gizmo(int a, ...)  // interface function
{
    std::va_list ap;
    va_start(ap, a);
    int r = vgizmo(a, ap);
    va_end(ap);
    return r;
}

void some_other_stuff(bool q, char const * fmt, ...)
{
    std::va_list ap;
    va_start(ap, fmt);

    // ...

    int b = vgizmo(x, ap);   // third parties use vgizmo directly

    // ...

    va_end(ap);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:09:04.320

在类 C 语言（C、C++、Objective-C 等）中，您不能直接传递可变参数。但是，您可以（如果您正在开发一个外部库，或者您只是想促进逆向工程师的工作，您应该）提供您的函数的非可变参数版本，并使可变参数版本只是包装它，这样您可以根据需要将尽可能多的参数传递给您的函数——使用`va_list`. 例子：

```
// variadic function
void variadic_func(int nargs, ...)
{
    // just wrap the non-variadic one
    va_list args;
    va_start(args, nargs);
    non_variadic_func(nargs, args);
    va_end(args);
}

// non-variadic function
void non_variadic_func(int nargs, va_list args)
{
    // do what you want with `args'
}

// you can pass down varargs like this:
void outmost_caller_func(int nargs, ...)
{
    // since you can't pass down the `...', you create a va_list argument list
    va_list args;
    va_start(args, nargs);
    // and call the non-variadic version of your function, just like the wrapper
    // would do (anyway, the wrapper is only for convenience...)
    non_variadic_func(nargs, args);
    va_end(args);
} 
```

# azure - Azure 如何维护 APPLICATION 状态？

> ID：10761209
> 
> 赞同：4
> 
> 时间：2012-05-25T20:51:47.690
> 
> 标签：azure, state

我知道 Azure 如何保留 SESSION 状态——我已经使用基于 Neil MacKenzie 的*Microsoft Windows Azure Development Cookbook*的 AppFabric 在我的应用程序中实现了它。但是，这种基于 AppFabric 的方法显然不会保留我的应用程序需要的 APPLICATION 状态（例如*Application["name"] = MyObject*）。

我怀疑我需要使用 Azure Tables，但这需要重新编码。所以在走这条路之前，我想知道是否有一种更简单的方法来保存应用程序状态，最好是不需要重新编码我的应用程序的方法。

谢谢，

账单

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T19:53:46.017

抱歉，没有什么比直接替代 Application[key] 方法更好的了。

最好的办法是使用[Azure 缓存](http://msdn.microsoft.com/en-us/library/windowsazure/gg278356)。我相信你已经在间接使用 Azure 缓存，使用上面书中的方法来处理会话状态。

缺点可能是缓存的项目不会永远存在，它们的最长寿命约为 72 小时。因此，无论何时访问缓存项，都必须进行类似于以下伪代码的测试：

```
object o = cache.Get("MyItem"); 
if (o != null){ 
   MyType myType = (MyType) o; 
   //use the item
} 
else 
{  
//recreate the item 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-07T12:55:17.893

值得注意的是，微软推荐 SQL 数据库作为服务器端状态管理的首选存储方式。

尽管我会坚持使用 Chris 提到的 Azure 缓存。

# regex - 在 AS3 中匹配字符串中的整个单词

> ID：10761210
> 
> 赞同：-2
> 
> 时间：2012-05-25T20:52:04.670
> 
> 标签：regex, string, actionscript-3, flash, search

我需要一些帮助来匹配字符串中的整个单词。谁能推荐一种方法来做到这一点？

例子：

```
var keywords:String = "att, attractive, attaboy, attack, attach"; 
```

我希望能够仅搜索“att”而不获得任何其他结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:00:39.110

这是“att”这个词的正则表达式：

`\batt\b`

`\b`匹配单词边界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T20:59:44.943

如果你想要一个真/假，是否在字符串中找到了这个词：

```
 public static function contains(p_string:String, p_char:String):Boolean
    {
        if (p_string == null)
            return false;

        return p_string.indexOf(p_char) != -1;
    } 
```

用作：

```
contains(keywords, "att"); // would return true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T20:12:21.230

这可能有效，但您需要去掉逗号后的空格：

```
var keywords:String = "att,attractive,attaboy,attack,attach";

var arr:Array = keywords.split(",");
if (arr.indexOf("att") == -1) {
    trace("false");
} else {
    trace("true");
} 
```

# css - 水平菜单样式

> ID：10761211
> 
> 赞同：0
> 
> 时间：2012-05-25T20:52:05.570
> 
> 标签：css, padding

我在几个网站上工作，并且在水平菜单间距方面遇到了重大问题。一个网站是 daniellesshoes.com（这是一个 BigCommerce 网站）另一个是 blog.daniellesshoes.com（这是 WordPress）

我的问题是这个。我们为客户制作这些网站。我们希望菜单是紫色的，当鼠标悬停在 li 上时会突出显示粉色。其中有两个问题。1\. 如果客户端从 BigCommerce CSS 添加一个菜单项，它会弄乱间距。

第二个问题是 IE6、7、8 和 9 都显示间距的像素差异和一些禁用溢出隐藏等等等

所以要么 1\. 我想驾驭所有风格（BigCommerce 出于某种原因带有 7 个以上的样式表，所有样式表都相互覆盖等）并重新设计我自己的 - 正确的方法！或 2\. 弄清楚我必须添加什么以使其在每个浏览器上看起来都一样。最后，一旦我完成了，我希望它们自动空间..

请查看上述网站并检查元素，然后让我知道我该怎么做。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:59:09.833

基于列表的菜单规则：

1.  使用 CSS 重置
2.  不要设置`LI`标签的样式（除了位置：、显示：和浮动：）
3.  使用-tags`display:block`并为其设置样式`A`
4.  如果您正在使用它们，请清除您的浮动

看我的教程：[`I Love Lists`](http://developer.yahoo.com/yui/reset/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:00:53.380

The only way to space items automatically in CSS is by using `display: table;` and `table-cell` and `table-layout: fixed;`. It works in every modern browser and IE8, as it's CSS2.1 recently supported everywhere.

Check first example of this jsFiddle: [http://jsfiddle.net/aznxD/](http://jsfiddle.net/aznxD/)
Resetting CSS for lists is done by indicating:

```
ul {
    margin: 0;
    padding: 0;
} 
```

No need for changing `list-style` if you already change the value of `display` for `li`. The 40 other lines of various reset CSS are for other things than lists, that's OT here.

The second example in previous fiddle is for IE6/7, by using sort of `display: inline-block` (see comment in CSS and in the JS left-bottom part of screen) and calculated padding that will depend of the number of items in menu and length of text. That's why items won't space automatically... You can add these specific rules via [conditional comments in a specific stylesheet or around html element with class(es)](http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/).

This is not pixel perfect... but it isn't *that* important: nobody except you will see your site in numerous browsers and their different versions.
Maybe some people will see your site on two browsers, one at work and another one at home. Will they notice that my example is 957px wide and not 960px anymore? Will they care or will they be glad that it's less horrible than most sites designed for "modern browsers" with no care and tests at all for old browsers? (designing for modern browsers isn't a problem, not caring at all for older ones with no fallback *is* a problem)
IMHO your time will be better used at providing media queries in support of Responsive Web Design and maybe Mobile First in a second or third time and removing every unused CSS rule in your CMS if it's bloated: better maintenance in the future and better performance now and in the future.

# asp.net - 通过 Word 文件链接时 IIS 无法识别 cookie

> ID：10761223
> 
> 赞同：1
> 
> 时间：2012-05-25T20:53:33.953
> 
> 标签：asp.net, cookies, iis-7, ms-word

我们正在运行 IIS 7 和会话 cookie，但是因为我们在外部 Word 文档中有我们想要“安全”的链接 - （即人们需要登录才能查看它们），我们设置了一些代码来创建持久性 cookie一旦用户登录并在提供链接内容之前进行检查。这适用于：

1）复制链接网址并将其直接粘贴到浏览器中时。2) 在 Visual Studio 8（不是 IIS Express）附带的本地 Web 服务器上执行此操作时

但是，当单击 Word 文档中指向服务器本身文件的链接时，站点找不到 cookie 并因此重定向到登录页面（即使用户刚刚登录（因此只需设置该 cookie - 我可以在 cookie 管理工具中看到该 cookie，其有效期为 20 分钟）。

我们是否缺少某种服务器设置，或者从阻止读取 cookie 的外部文件打开 url 时是否有一些奇怪？这似乎是错误的，因为当服务器在本地并访问 localhost 域时我们可以做得很好，但谁知道呢！

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T13:07:40.990

好吧，我没有找到任何设置，我们正在与我们的托管公司交谈，看看他们是否知道任何可能阻止 cookie 被读取的事情。

但是，我想到了一种似乎可行的解决方法。基本上，解决方法是不要链接到执行 cookie 检查然后重定向的 aspx 页面，而是让链接转到中间 html 页面。该页面具有解析链接文件参数的 url 并将用户重定向到 aspx 重定向页面的 JS，并传递该参数。以这种方式执行此操作时，无论出于何种原因，都会正确读取 cookie 并提供文件。

我仍然不清楚这是 IE 中的一些安全问题，还是服务器设置，但至少这种解决方法似乎可以完成工作！

# asp.net-mvc-3 - Orchard ：维护自定义内容类型的列表

> ID：10761225
> 
> 赞同：1
> 
> 时间：2012-05-25T20:53:47.310
> 
> 标签：asp.net-mvc-3, orchardcms

我正在维护一个“事件”列表（自定义内容类型），该列表只能包含 1 个即将发生的事件，但有几个“事件”的日期已过...

我想检查是否 DATE 是未来，然后在“事件页面”上显示该事件的详细信息，并在小部件中显示已传递事件的列表。

我在哪里以及如何根据日期应用此过滤器？

提前致谢。极端主义者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:49:23.890

使用投影仪。然后，您可以使用过滤器对未来和过去的事件进行两次查询，然后为未来的事件显示一个结果，并为过去的事件显示任意数量的结果。

# c# - 生成数取决于 2 个列表

> ID：10761227
> 
> 赞同：-1
> 
> 时间：2012-05-25T20:53:52.063
> 
> 标签：c#

这是一些简单的代码来显示我的问题：

```
 void method()
 {
   for(int i = 0;i<=99)
   {
     method1();
     method2();
   }
  }

void method1()
{
    if(Randombool())
    {
        bool exists = true;
        int n;
        while(exists)
        {
            n=RandNum(100);
            exists = list1.Exists(num => num == n);
        }
        list1.add(n);
    }
}

void method2()
{
    int n;
    bool exists = true;
    bool exists2 = true;
    while(!(exists && !exists2))
    {
        n = RandNum(100);
        exists = list1.Exists(elem => elem == n);
        exists2 = list2.Exists(elem => elem == n);
    }
    list2.add(n)
} 
```

很明显它会在方法2的`while`循环中停留很长时间。

有没有更温和的方法来生成数字，这样我就可以避免等待？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:00:22.530

似乎您正在尝试生成 N 个数字的随机序列。您在这里使用的方法是获取一个随机数，如果它是您已经拥有的，则将其丢弃。

你想要做的是随机播放一个可以合理有效地完成[的数组。](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)只需按顺序用 0, 1, 2, ... 填充列表，然后随机播放。

从上面的链接复制的伪代码：

```
To shuffle an array a of n elements (indices 0..n-1):
  for i from n − 1 downto 1 do
       j ← random integer with 0 ≤ j ≤ i
       exchange a[j] and a[i] 
```

# android - Android ListView的divider属性隐藏了内部ImageView

> ID：10761229
> 
> 赞同：0
> 
> 时间：2012-05-25T20:54:04.073
> 
> 标签：android, listview, imageview, hide, divider

我试图找出一种方法来隐藏 ListView 的分隔线。通常，我会设置 'android:divider="@color/transparent' 但无论出于何种原因，这都会在 listitem 布局文件中隐藏一个 ImageView （箭头）。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" style="@style/ListItem.Container" >
  <LinearLayout style="@style/ListContainer" android:orientation="vertical" >

    <TextView style="@style/ListItem.Title" />
    <TextView style="@style/ListItem.Date" />
  </LinearLayout>

  <FrameLayout style="@style/ListContainer">
    <TextView style="@style/ListItem.Details" />
  </FrameLayout>

  <FrameLayout style="@style/ListContainer">
    <ImageView android:id="@+id/arrow" style="@style/ListItem.Arrow" />
  </FrameLayout>
</RelativeLayout> 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:08:46.053

//你可以在xml中做`android:divider="@null"`

或者

// 你也可以通过代码来做`listView.setDivider(null);`

# browser - Raphael.js——脚本看起来很轻，但执行很重——为什么？

> ID：10761239
> 
> 赞同：0
> 
> 时间：2012-05-25T20:54:42.613
> 
> 标签：browser, raphael, repaint, motion, reflow

我在 Windows XP 上使用 Raphael 2.01、Firefox 12.0。

我尝试过连续的对象运动（不是补间动画）。我认为我的脚本负载很轻，但是 PC 冷却风扇的声音会很大！

我想知道原因和解决方法。

（脚步）

*   我在文档上设置了几个圆形对象（5 到 10）。

*   他们继续前进。当它们接触到文档的边缘时，它们会返回（向相反方向移动），但它们的运动会减慢。

*   当我在 Google Chrome 的任务管理器中检查 PC 的负载时，内存使用量变得越来越大（40MB ===> 150MB ===> ... ）

（脚本）

[http://jsfiddle.net/JsL46/3/](http://jsfiddle.net/JsL46/3/)

***对不起。当我将代码粘贴到“jsfiddle”时，会出现圆形对象但它们不会运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T13:26:51.870

RaphaelJS 使用传统的样式更改和偏移来制作动画，这会导致很多、[重绘和回流](http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html)。使用[SVG SMIL 动画](http://www.svgopen.org/2008/presentations/70-Tricks_of_Javascript_and_declarative_animation/index.html)来减少浏览器的负载，例如[左/右移动](http://srufaculty.sru.edu/david.dailey/svg/ovaling.svg)等简单情况。

# loops - Matlab中的矩阵维度+循环错误

> ID：10761240
> 
> 赞同：0
> 
> 时间：2012-05-25T20:55:01.760
> 
> 标签：loops, matrix, dimension

我有一个向量“Xt”，其中 Xt 维度是 12588 X 1。从这个向量我应用这个代码：

`S=sum((abs(Xt(2:end)-Xt(1:end-1))).^2);`

这导致一个数字，其中 S 是 1by1。

现在我的目标是构建一个向量 S (Nx1)，其中 S 中的每个值都取决于 J 和 K——例如：

`S=sum((abs(Xt(**J**:end)-Xt(**K**:end-1))).^2);`

起初我想到了以下（我不希望 J 超过 126）：

`for j=2:126 k=1:125, S=sum((abs(Xt(j:end)-Xt(1:end-k))).^2); end; end;`

我收到错误消息：“使用错误 - 矩阵尺寸必须一致。”

是维度问题加上循环问题吗？

* * *

我刚刚意识到这段代码有效

```
for j=2:2 k=1:1; 
```

S=sum((abs(Xt(j:end)-Xt(1:end-k))).^2); 结尾;

所以这真的是一个矩阵维度问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:23:06.513

要结束这个问题：

这就是我两周前解决这个小问题的方法：

```
for j=2:2 k=1:1;
S=sum((abs(Xt(j:end)-Xt(1:end-k))).^2); end; 
```

非常简单

（我是 Matlab 新手）

# c++ - C ++将类成员项传递给成员函数

> ID：10761243
> 
> 赞同：-1
> 
> 时间：2012-05-25T20:55:07.197
> 
> 标签：c++, class, struct, private-members, param

将成员项不必要地传递给成员函数的后果是什么（除了糟糕的代码）：

```
struct foobar
{
  char * arr; //properly initialized to SIZE at some point
}

class foo
{
  public:
    void bar(foobar&);
    foobar barfoo;
};

void foo::bar(foobar& barf)
{
    cin.get(barf.arr, SIZE, '\n');
    cin.ignore(100, '\n');
} 
```

有什么理由不完全消除参数`bar`而直接调用`barfoo`吗？如果有的话，不这样做的后果是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T20:58:31.887

这取决于。

如果唯一`foo::bar`被调用的上下文是当`this->barfoo`作为参数传递的时候，那么它是非常愚蠢的（虽然不是很有害）。

但是在`this->barfoo`不是唯一可以传递给成员函数的参数的情况下，显然没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T21:00:01.067

一个后果是 foobar 的其他实例无法传递给同一方法。

问题不在于有时是否将成员发送到方法，而在于调用者是否希望能够指定参数。

由于这是一个公共方法，因此可能存在该类以外的调用者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T20:59:58.163

没有理由不消除它。至少当你在函数中传递它时，你会做一个额外的取消引用。

但是，如果 somethign 在您的班级之外使用 bar(foobar&)，您可以重载它并执行以下操作：

```
class foo {
public:
    void bar(); /* Uses default barfoo */
    void bar(foobar&);
    foobar barfoo; 
private:
};

viod foo:bar() {
     bar(barfoo);
}

void foo::bar(foobar& barf) {
    cin.get(barf.arr, SIZE, '\n');
    cin.ignore(100, '\n'); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T21:00:01.550

传递参数有一点开销，所以如果你永远不会用另一个成员调用该方法，那么你可以摆脱参数。如果您将来可能需要做这样的事情：

```
class foo 
{ 
  public: 
    void bar(foobar&); 

  private/*(or still public)*/: 
    foobar barfoo;
    foobar barfoo2;

    void some_other_method() {
      //do stuff
      bar(barfoo);
      bar(barfoo2);
}; 
```

那我就别管它了。

# java - 在 Android 设备上将视频转换为音频 (Java)

> ID：10761245
> 
> 赞同：1
> 
> 时间：2012-05-25T20:55:12.987
> 
> 标签：java, android, video, ffmpeg

我的问题非常基本，但我发现很难找到解决方案。

我制作了一个 android 应用程序，它从服务器下载视频，然后应该将它们转换为 mp3，因为它是用于音乐下载的。现在的问题是我真的找不到转换视频的**轻量级**方法。

我已经研究了一个合适的 ffmpeg 库/包装器，但找不到在 android 上使用的简单解决方案。我已经在我的 Windows 机器上使用 ffmpeg，但它是基于控制台的。

我需要做的就是将 mp4 转换为 mp3 但不知何故似乎没有任何简单的解决方案可以找到，我也宁愿不使用外部 Web 服务，因为我不能依赖网站来始终运行，而我的应用程序应该。

我希望我已经说清楚了，感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:16:28.533

您可以在应用程序代码中使用 ffmpeg 来实现此目的。检查这个问题的一些方向：[在 Android 上使用 FFMPEG](https://stackoverflow.com/questions/5164211/use-ffmpeg-on-android)

# c# - 如何使用命令行 ftp 将文件放在服务器上并删除本地副本

> ID：10761247
> 
> 赞同：0
> 
> 时间：2012-05-25T20:55:24.670
> 
> 标签：c#, batch-file, ftp, cmd

我正在学习 cmd line ftp 并且想知道如何在删除本地副本的同时将文件传输到远程目录。

这可能吗 ？

我不想转移然后运行删除命令，但到目前为止我所拥有的是：

```
mput *xml 
```

哪个不会删除本地副本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:21:06.770

您可以在大多数带有 bang ( `!`) 的命令行 ftp 程序中执行任意 shell 命令。所以我想你可以这样做：

```
ftp> !pwd
/home/foo_user
ftp> mput *xml
ftp> ! rm *xml 
```

但我认为这可能有点危险，因为你可能会无意中删除一些重要的东西

# c# - 将 SQL CASE WHEN 语句转换为 C#

> ID：10761249
> 
> 赞同：5
> 
> 时间：2012-05-25T20:55:59.743
> 
> 标签：c#, sql, sql-server, linq-to-sql

我正在暑期编程实习的第一周，我的任务是使用[LINQPad](http://www.linqpad.net)将 SQL Server 2008 语句转换为 C# 。一旦我这样做并让它正常工作，我可以将它输入到 VS 并根据需要进行调整。

问题是我正在运行 SQL 语句，我不知道如何转换。在我的 C# 类中，我们没有将 SQL 语句转换为 C#，我们只是创建了一个字符串变量，将 SQL 语句分配给变量，然后将变量分配给 OleDbCommand 对象。我的导师在长周末放了一天假，我几乎独自一人，不知道该做什么，需要一些帮助。像这样的有几十个，如果我能看到如何做一个，我就能弄清楚其余的。下面是 SQL 语句：

```
,[hrs].{Hours] - SUM(
  CASE 
    WHEN [UnitState].[UnitStateTye] <> 'ACTIVE' 
      THEN [Allocation].[AllocatedEnergyMwh] 
    ELSE 0 
  END 
/ CAST([Unit].[NetDependableCapacity] AS FLOAT)) AS SH 
```

我很确定这是一个 if 语句：

```
if [UnitState].[UnitStateType] does not equal active 
then SH equals [hrs].[Hours] minus the the sum of
  [Allocation].[AllocatedEnergyMwh] / (float)[Unit].[NetDependableCapacity].  
else 
  SH = [hrs].[Hours] 
```

我尝试了以下代码，我认为它不会工作，但需要从某个地方开始：

```
var results = 

    (from v in VDimUnit     
        join vf in VFactEnergyAllocation on v.UnitKey equals vf.UnitKey
        join vd in VDimGadsEvent on vf.GadsEventKey equals vd.GadsEventKey
        join vt in VDimTime on vf.TimeKey equals vt.TimeKey 
        join vus in VDimUnitState on vf.UnitKey equals vus.UnitKey
    where vd.GadsEventEndTime.Year == 2011 && v.UnitId == "THL3"
    group vf by new {vus.UnitStateType, vf.AllocatedEnergyMwh v.NetDependableCapacity,
        vt.QuarterNum} into groupItem       
    select new {groupItem.Key.QuarterNum, SUM1 = groupItem.Sum(x=> (float)x.AllocatedEnergyMwh /
        groupItem.Key.NetDependableCapacity)}).ToArray();

var resultHours = 
    (from v in VDimTime
    group v by v.QuarterNum into groupItem
    select new {Hours = groupItem.Count(), groupItem.Key}).ToDictionary(x=> x.Key, x=> x.Hours);

var finalResults = 
    (from r in results
    select new {SH_IF_NOT_ACTIVE = resultHours[r.QuarterNum] - r.SUM1,
        Hours = 
        SH_IF_ACTIVE = resultHours[r.QuarterNum]});

    if (SH != "ACTIVE")
    { 
        SH_IF_NOT_ACTIVE;
    }
    else
    {
        SH_IF_ACTIVE;
    } 
```

我很感激有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:00:36.303

像这样的东西：

```
Hours = condition ? code when true : code when false; 
```

# c# - 自定义属性不显示在自定义控件的属性窗口中

> ID：10761251
> 
> 赞同：1
> 
> 时间：2012-05-25T20:56:14.023
> 
> 标签：c#, winforms

我说的是文件->新建->控制库

在其表单上删除了一个 ListView，向它添加了一个新的静态类，如下所示：

```
namespace WindowsFormsControlLibrary1
{
    public  static class TestClass
    {
        [Category("Appearance")]
        public static Color InsertionMarkColor { get; set; }
    }
} 
```

但是当我在测试应用程序中使用它时，我希望看到一个名为 InsertionMarkColor 的属性，但它没有在那里显示。为什么？
注意：如果我直接将 InsertionMarkColor 复制粘贴到库的源代码中，它会显示并工作，但如果我想像上面的代码一样将它移动到单独的类，它不起作用......你觉得怎么样不见了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:27:36.403

这对我有用：

```
public class MyListView : ListView {

  [Category("Appearance")]
  public Color InsertionMarkColor { get; set; }

} 
```

# mapreduce - 在 HBase MR 作业中找不到 zookeeper jar

> ID：10761252
> 
> 赞同：1
> 
> 时间：2012-05-25T20:56:15.350
> 
> 标签：mapreduce, hbase, apache-zookeeper

我有一个尝试在 HBase 表上生成 MR 作业的 Web UI。我不断收到此错误：

```
java.io.FileNotFoundException: File /opt/hadoop/mapreduce/system/job_201205251929_0007/libjars/zookeeper-3.3.2.jar does not exist.
        at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:361)
        at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:245)
        at org.apache.hadoop.filecache.DistributedCache.getTimestamp(DistributedCache.java:509)
        at org.apache.hadoop.mapred.JobClient.configureCommandLineOptions(JobClient.java:629)
        at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:761)
        at org.apache.hadoop.mapreduce.Job.submit(Job.java:432)
        at org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:448) 
```

我正在使用 hbase 0.90.4 运行。HBase 管理自己的 zookeeper。而且，我确认`/opt/hadoop/mapreduce/system/job_201205251929_0007/libjars/zookeeper-3.3.2.jar`我的 HDFS 中有。它在本地 FS 中查找吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T05:13:01.587

我发现我的类路径上没有 core-site.xml 并且它为 fs.default.name 使用本地 FS 而不是 HDFS。该 jar 存在于 HDFS 中，但它正在查找本地 FS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T16:05:37.777

在 mapper 或 reducer 中访问的任何 jar 文件都需要位于集群中所有节点的本地文件系统中。检查您当地的FS。

# jquery - JQuery SmartWizard：动态 ajax 内容

> ID：10761263
> 
> 赞同：0
> 
> 时间：2012-05-25T20:56:47.893
> 
> 标签：jquery, ajax, smart-wizard

我正在使用[JQuery SmartWizard](http://techlaboratory.net/products.php?product=smartwizard&action=2)，它能够使用 Ajax 加载内容，但我看不到如何将任何参数传递给服务器。我错过了什么吗？

似乎拥有 Ajax 的目的是向服务器发送参数，并根据输入参数返回不同的内容，对吧？我只看到一个 step_number 参数，但我不知道如何或是否可以更改它，因为步骤数是静态的。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:30:18.853

您使用 url 将变量传递给服务器。file.php?do=nothing&name=john&relaxmode=on

```
function getdata(url,id,lastseen)
    {
    $.ajax(url+’?userid=’+id+’&amp;lastvisit=’+lastseen).done(function(data)
        {
        if(data.indexOf(’alive’)!=-1)alert(’he is alive’)
        })
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T07:03:10.707

您可以在函数 leaveAStepCallback 中更改 ajaxurl。您可以放置​​一个隐藏字段，并可以在此隐藏字段中分配修改后的 ajaxurl。在向导 js 文件中，我们应该修改该 url 调用以从 ajaxurl 的隐藏字段值中获取值。

即在ajax调用之前

```
if ($("#ajaxUrl").val() != "") {
                               ajaxurl = $("#ajaxUrl").val()
                           } 
```

# javascript - Eval() 与开发者工具

> ID：10761264
> 
> 赞同：0
> 
> 时间：2012-05-25T20:57:04.257
> 
> 标签：javascript, eval, developer-tools

所以古老的标准是使用 Eval 是不好的，因为它会导致重大的安全问题；特别是在您正在评估可能来自用户输入的某些情况下。这是 100% 有意义的，而且我在避免使用 Eval 时从来没有遇到过任何问题。不过，我最近遇到了一个奇怪的情况，这让我对这类事情的看法有点不同。

我写了一个类似的 JS 函数：

```
function someFun(param, callback) {
    bool = someOtherFun(param);
    if(bool)
        callback();
    else
        return false;
} 
```

这被精简了很多，但原理是一样的：它调用另一个函数，并根据它的返回值执行作为参数提供的函数，或者返回 false。不过，这让我想到，在 F12 中使用 JS 控制台可以像 Eval(txtbox.value) 一样容易地利用这种东西。这有关系吗？

在这个 F12 的世界里，在我看来，Eval 是我们最不担心的事情。任何知道什么是注入攻击的人都可能知道 F12 是什么。我错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:07:06.070

虽然您认为 F12 和 firebug 之类的工具将您的 JavaScript 暴露在新的审查级别并使其易于攻击是正确的，但您却忽略了使用 eval 的危险。

与其担心当前用户（在浏览器中加载页面可能会做什么），不如让我们自己关注他们在下一台计算机上的合作。假设同事在 Stack Overflow 上键入评论，然后将其存储在数据库中，然后发送到我们用户的计算机进行显示。假设作为渲染过程的一部分，注释被编码为 JSON，然后调用 eval。

这是一个危险的漏洞利用等待的地方，它与我们的用户在页面上检查或执行他们自己的 JavaScript 无关。如果他们的同事在他们的评论中嵌入了恶意 JavaScript，并且我们对其调用 eval，则该 JavaScript 可能会被执行，从而导致该恶意代码在查看该页面的每台计算机上运行。

这就是为什么我们应该避免使用 eval。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T21:04:21.313

我没有看到漏洞利用场景。是的，他们可以通过恶意回调调用您的函数。或者......他们可以从控制台调用恶意回调。

# javascript - Javascript 表单验证不起作用 - 脚本没有被调用？

> ID：10761269
> 
> 赞同：0
> 
> 时间：2012-05-25T20:57:17.383
> 
> 标签：javascript, html

我编写了一个非常简单的 javascript 表单验证脚本：

```
 function validateForm(){
        var x=document.forms["contactForm"]["firstname"].value;
        if (x==null || x==""){
            return false;
        }

        var y=document.forms["contactForm"]["lastname"].value;
        if (y==null || y==""){
            return false;
        }

        var z=document.forms["contactForm"]["emailaddress"].value;
        var atpos=z.indexOf("@");
        var dotpos=z.lastIndexOf(".");
        if (atpos<1 || dotpos<atpos+2 || dotpos+2>=z.length){
            return false;
        }
        var msg_area = document.getElementById("message");
        msg_area.innerHTML = "";
        if (document.getElementById("message").value.length < 20) {
            return false;
        }
        else document.getElementById("contactForm").submit();
    } 
```

它应该验证此表单：

```
 <form name="contactForm" onsubmit="return validateForm()" action="./thankyou.html" method="post">
        <label for="firstName">First Name <sup>*</sup></label>
        <input name ="firstname" id="firstName" type="text" placeholder="First Name" required />
        <label for="lastName">Last Name <sup>*</sup></label>
        <input name ="lastname" id="lastName" type="text" name="lastName" placeholder="Last Name" required />
        <label for="emailaddress">Email address <sup>*</sup></label>
        <input name="emailaddress" id="emailAddress" type="email" placeholder="something@example.com" required />
        <label for="message">Message<sup>*</sup></label>
        <textarea id="message" placeholder="Remember, be nice!" required></textarea>
        <input type="submit" name="submit" value="Email Me!" class="emailsub" />
        <p class="small"><sup>*</sup> denotes a required field.</p>
    </form> 
```

提交后，它似乎根本没有真正调用 javascript。它唯一寻找的是它满足 html 的“必需”部分。我对javascript很陌生，所以问题出在哪里可能很明显，但我自己找不到它。

任何帮助深表感谢！

ps这是目前的本地网站，因此action =“”转到另一个html而不是页面来处理消息。这可能是这里的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:37:29.130

html5“必需”属性告诉浏览器在继续之前进行验证，[请在此处阅读更多内容](http://diveintohtml5.info/forms.html#validation)。这意味着它会在调用 javascript 函数之前停止事件（在支持的浏览器上），除非它通过了基本验证（必填字段和电子邮件）。

如果您希望 javascript 执行并执行您自己的验证，则需要删除“必需”属性。您也可以尝试更复杂的 html 表单验证。[这是一篇关于这个主题的好文章。](http://www.alistapart.com/articles/forward-thinking-form-validation/)

# php - 使用 PHP 和 Javascript 从 MySQL 加载数据的最佳方法

> ID：10761270
> 
> 赞同：0
> 
> 时间：2012-05-25T20:57:20.730
> 
> 标签：php, javascript, database

看看其他问题，对于我的情况似乎没有一个足够具体。我正在创建一个类似博客的网站，并创建了一个用户验证页面，该页面允许我使用发送到将数据存储在 mySQL 数据库中的 php 文件的表单添加标题、主要内容和图像。然后，php 将我重定向到索引页面，我想在其中加载最新的博客文章以及所有以前的文章，并将它们放在带有样式的 div 中。我认为我不需要 AJAX。我只需要每次访问加载数据，因此，对我来说最好的办法是在 $(document).ready() 上调用一个 javascript 函数来访问数据库中的数据？如果是这样，我如何在我的 javascript 中实现 PHP 以使用数据库，然后将信息存储在 javascript 变量中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:02:48.130

您当然不需要 AJAX。只需使用您的 index.php 页面在数据库中查找博客文章，然后循环并回显它们。

您可以稍后合并 AJAX 来调用一个 php 页面，该页面将为您提供博客文章。这样，您可以在创建新博客文章时在加载页面后更新页面。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:19:41.057

显然，您似乎并没有牢牢把握每种语言的作用。如果您要自己构建某些东西，请遵循已经构建了所有内容的人的建议，并可以将其展示出来（请参阅我的个人资料，我的网站包含博客、论坛、私人消息、聊天室、CMS 等完全由我自己使用没有其他人的代码构建）。

(X)HTML - 它是名词语言、图像、段落、CSS 用来设置页面样式的分割元素等。

CSS - 形容词语言，描述 (X)HTML 名词语言的显示方式。

JavaScript - 动词语言，事件驱动；当用户执行（onmouseover、onclick、onload 等）操作时，执行此代码（通常是一个函数）。AJAX 只是在页面完成加载后加载内容。一旦你的基础工作正常，你就可以担心花哨的东西。

PHP - 服务器端语言，准备要发送到客户端计算机的代码（主要是 XHTML）。

数据库 - 存储您的内容的位置。

“$(document).ready()” 不是 JavaScript，而是 jQuery。如果您想学习远离 JavaScript 库并学习真正的 JavaScript，否则您将陷入与之相关的噩梦（与原生 JavaScript 相比，性能不佳，更新库会改变您必须对它们进行编码的方式等）。请随意查看我网站的源代码，因为它都是为 XHTML 编写的 application/xhtml+xml 这意味着它将在常规 HTML 中工作，尽管如果您将绝大多数网站切换到 XHTML，它们将无法工作。换句话说，当您第一次正确编码时，您将更有信心相信它会在故事结束时工作。人们不在乎你是怎么做到的，但它是有效的，如果它总是有效，那么他们就不会对他们所拥有的东西感到更快乐。

* * *

如果您正在构建主博客页面，您只需要一个 SQL 查询来提取所有内容。我的博客我编程显示最后八个最新的博客条目，尽管我的分页就像一本书，第一页（左侧）从前八页开始，所以如果计数不能被八整除，你可能会看到最新页面上有六个条目。

使用 SQL 时，您要构建查询，切勿将其粘贴在循环中！你执行的查询越少，你的代码就越好，你的性能就越好。我建议下载 MySQL Workbench 并设置 MySQL 查询日志，然后使用 Tail for Win32 实时查看查询以查看您的代码在做什么。

Apache 也有日志。您首先在 http://localhost/ 本地构建这个，对吗？在您先在本地测试完之前，您永远不应该实时测试某些东西。请参阅我的基本元素博客条目，了解如何最好地做到这一点......

[http://www.jabcreations.com/blog/streamlining-local-and-live-development-with-the-base-element](http://www.jabcreations.com/blog/streamlining-local-and-live-development-with-the-base-element)

* * *

如果您正在谈论重定向，请对用户隐藏技术内容并利用 PHP 中的 $_SESSIONS。记录当前页面 URL 是什么（相对于本地/本地网络/实时环境不同的基础），有第二个 URL 可以回退，如果它也与重定向页面匹配，则有一个安全 URL，即静态定义。如果您经常回退到静态 URL，请检查以确保您没有弄错每个页面加载时如何更新其他两个变量（例如，如果您显然在重定向页面上，则不更新它）。

* * *

当你巩固你的基本理解时，你会想问一些非常具体的问题，因为你的问题是非常主观的，并且对于大多数程序员来说并不值得回答。确保您使用正确的术语，坚持使用核心语言而不是库，因为这样做将有助于确保您的工作代码能够持续更长时间。您的编码实践越严格，您的生活就会越好。最大限度地提高 HTTP、JavaScript、PHP 和 SQL 错误报告的敏感性。获取PHP未设置错误？如果黑客试图从您的代码中窥探错误消息怎么办？确保在开始使用它们之前设置这些变量。记录您的错误并狂热地修复它们。不要试图添加世界上的每一个功能，首先专注于关键功能并确保它' 在你扩展它之前，它是无可争辩的。做这些事情，虽然这可能需要更多的时间，但你会比绝大多数淹没在基于不可靠代码的实时环境中的人更难摇摆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:01:33.433

gizmovation 是对的，您不需要 AJAX，但要回答“如何在我的 javascript 中实现 PHP 以...”的问题

您正在寻找使用 AJAX。使用 jQuery 的 .ajax 调用 PHP 页面，返回结果后放入 javascript 变量中，或者直接放入 DOM 中。 [AJAX 示例](http://www.w3schools.com/php/php_ajax_database.asp)或[jQuery 示例](http://api.jquery.com/jQuery.get/)

# iphone - UIScrollView 与 UITableVIew 和比内容大小更小的增量

> ID：10761273
> 
> 赞同：1
> 
> 时间：2012-05-25T20:58:03.257
> 
> 标签：iphone, objective-c, uitableview, uiscrollview

我有一个 UIScrollView 作为 CustomView 的子视图，它重新定义了方法 hitTest，因此滚动视图可以以较小的增量滚动（滚动视图的宽度小于窗口大小），并且我也可以在 UITableView 内滚动。

但问题是我只能滚动在窗口居中的 UISCrollView 内单击大约 1/3 高度的表格。

UIScrollView 没有包装它的内容，所以它显示正确。问题只是子视图 UITableView 的“点击区域”

谢谢！

# php - 从服务器获取文件时 unicode 错误

> ID：10761280
> 
> 赞同：1
> 
> 时间：2012-05-25T20:58:53.823
> 
> 标签：php, unicode, utf-8

我想从 google 下载[这个链接](http://translate.google.com/translate_a/t?client=t&hl=en&sl=auto&tl=fa&multires=1&prev=btn&ssel=0&tsel=3&uptl=fa&alttl=en&sc=1&text=hello)，它是 php 的 mage txt 文件。

当我通过浏览器执行此操作时，unicode 是正确的并且一切都正确，但是当我执行此操作时，`curl`它`file_get_content`包含错误的字母。有什么区别，我应该如何解决？

由浏览器下载

```
[[["سلام","你好","",""]],[["感叹词",["سلام","هالو","الو"],[["سلام",["你好", "嗨","阿罗哈","万岁"]],["هالو",["你好","你好","你好"]],["الو",["你好"]]]]], "en",,[["سلام",[5],0,0,1000,0,1,0]],[["hello",4,,,""],["hello",5, [["سلام",1000,0,0],["خوش",0,0,0],["میهمان گرامی",0,0,0],["خوش آمدید",0,0,0] ,["درود کاربر",0,0,0]],[[0,5]],"你好"]],,,[["en"]],65]
```

通过以下php脚本下载：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<?php
$t = file_get_contents("http://translate.google.com/translate_a/t?client=t&hl=en&sl=auto&tl=fa&multires=1&prev=btn&ssel=0&tsel=3&uptl=fa&alttl=en&sc=1&text=hello");
$f = fopen("t.txt", "w+");
fwrite($f, $t);
fclose($f);
?>
</body></html> 
```

```
[[["ÓáÇã","你好","",""]],[["感叹词",["ÓáÇã","åÇáæ","Çáæ"],[["ÓáÇã",["你好", "hi","aloha","all hail"]],["åÇáæ",["hallo","hello","halloo"]],["Çáæ",["hello"]]]]], "en",,[["ÓáÇã",[5],0,0,1000,0,1,0]],[["你好",4,,,""],["你好",5, [["ÓáÇã",1000,0,0],["ÎæÔ",0,0,0],["ã\u06CCåãÇä ÑÇã\u06CC",0,0,0],["ÎæÔ ÂãÏ\u06CCÏ", 0,0,0],["ÏÑæÏ ÇÑÈÑ",0,0,0]],[[0,5]],"hello"]],,,[["en"]],4]
```

* * *

标题：

```
标题是：
HTTP/1.1 200 正常
Pragma：无缓存
日期：格林威治标准时间 2012 年 5 月 25 日星期五 22:29:12
到期：格林威治标准时间 2012 年 5 月 25 日星期五 22:29:12
缓存控制：私有，max-age=600
内容类型：文本/javascript；字符集=UTF-8
内容语言：fa
设置 Cookie：PREF=ID=b6c08a0545f50594:TM=1337984952:LM=1337984952:S=Sf1xcow2qPZrFeu0；expires=星期日，2014 年 5 月 25 日 22:29:12 GMT；路径=/; 域=.google.com
X-Content-Type-Options: nosniff
内容处置：附件
服务器：HTTP 服务器（未知）
X-XSS-防护：1；模式=块
传输编码：分块
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T20:54:26.713

Add parameters `ie=UTF-8` and `oe=UTF-8` to query string of the url:

```
$t = file_get_contents("http://translate.google.com/translate_a/t?ie=UTF-8&oe=UTF-8&client=t&hl=en&sl=auto&tl=fa&multires=1&prev=btn&ssel=0&tsel=3&uptl=fa&alttl=en&sc=1&text=hello"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:37:35.790

这对我有用一次，因为我正要将大量代码扔进垃圾箱！也许它也会帮助你

```
iconv( 'CP1252', 'UTF-8', $string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T07:41:57.493

# powershell - 使用 Power Shell 将 AUTOTEXT 添加到 MS Word 文档

> ID：10761282
> 
> 赞同：0
> 
> 时间：2012-05-25T20:58:57.707
> 
> 标签：powershell, scripting, ms-word

我正在做一个项目，我需要将 AUTOTEXT 条目（如 X 列表的第 1 页）添加到 Power Shell 生成的 MS Word 文档的页眉和页脚。我尝试从[以下 C# 示例](http://msdn.microsoft.com/en-us/library/ms178795%28v=vs.80%29.aspx#Y570)中提取想法，但我似乎无法弄清楚如何使其工作。我很好奇是否有人可以分享一些代码来帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:38:37.180

一个起点。此函数将页码添加到作为参数传递的文档的页脚（用于 word 2010）：

```
function Add-PageFooter ([string]$Document) {

add-type -AssemblyName "Microsoft.Office.Interop.Word" 

set-variable -name wdAlignPageNumberCenter -value 1 -option constant

$fc1 =  "Page"

$word = New-Object -comobject Word.Application
$Word.Visible = $True
#$Word.Visible = $False

$fc2 = [ref] "" -as [Type]

$OpenDoc = $Word.Documents.Open($Document)
$c = $OpenDoc.Sections.Item(1).Footers.Item(1).PageNumbers.Add($wdAlignPageNumberCenter)
$range1 = $openDoc.Sections.Item(1).Footers.Item(1).range
$field1 = $OpenDoc.Fields.Add($range1, -1, $fc2)
$field1.Code.Text = $fc1
$field1.Update

#$OpenDoc.Close() 
} 
```

另一种方法是创建一个 Word`Macro`并从 powershell 执行：

```
$wd = new-object -comobject word.application # create a com object interface (word application)

$wd.documents.open("C:\word\test.doc") # open doc

$wd.run("Macro01") # exec macro named macro01 that add custom footer and/or header

$wd.quit() # exit application 
```

`macro`必须保存在`normal.dot`（对于 2010 及更高版本）才能将`normal.dotm`其保存在所有打开的文档中。

通过这种方式，您可以在 Word 文档中自定义您想要的内容，而不仅仅是在宏中记录您在文档中的操作的页眉/页脚。

# html - 将PowerPoint流程图转换为html

> ID：10761287
> 
> 赞同：0
> 
> 时间：2012-05-25T20:59:25.403
> 
> 标签：html, powerpoint, flowchart

我有以下 [图像](http://www.imagebam.com/image/3b5bf6192161966)作为 PowerPoint 流程图（未显示超链接的文本）。

我想把这个图表变成一个 html 网站。任何想法如何为这项任务获得良好的结果？

我认为用 html 编码重新创建它很麻烦。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:17:51.807

灰色背景上的文本（右侧 5 个，左侧 2 个）可能是同一级别的标题，因此它们将 hN 浮动在右侧并位于每组箭头之前。

每组单独的箭头都可以很容易地编码为列表并设置为这些面包屑：

*   [基于 CSS 的简单可扩展面包屑](http://veerle-v2.duoh.com/blog/comments/simple_scalable_css_based_breadcrumbs/)（由 Veerle Pieters 提供）
*   [带有 CSS 三角形的面包屑导航](http://css-tricks.com/triangle-breadcrumbs/)（作者：Chris Coyer）

如果它很少占用 2 行，它们可以随内容扩展（Firefox/Ubuntu 和 Safari/Mac 有 laaarge 字体，不要假设您的文本将始终保持在 1 行。不说应该[考虑](http://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-scale.html)的缩放文本）

至于各个系列之间的橙色箭头......没有HTML就足够复杂了，所以我相信它取决于上下文。这是一个工业过程，网络营销还是其他？为了使其易于访问，我会使用带有替代文本的 HTML 图像来尝试描述关系。

红色箭头可能是锚链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:12:14.867

我认为这张图片可以优化得很好，因为它没有非常复杂的图形。因此，一个简单的解决方案可以将其作为背景图像包含在内，然后您可以使用 css 将文本和链接设置到位。

更好的解决方案是将图片分解成更小的组件，这样你就可以定义“div”，其中背景颜色、边框和边框单选为灰色部分，并将白色元素设置为背景图像“a”标签...但是对于箭头，我认为您应该将它们包含为背景图像...

希望这有帮助...

# tsql - TSQL：以文字而不是数字显示月份的功能

> ID：10761300
> 
> 赞同：4
> 
> 时间：2012-05-25T21:00:10.640
> 
> 标签：tsql

```
MONTH(CMS.App_Received_Date) as 'App Month' 
```

`4`日期为 4 月时将返回`2012-04-01`

`5`将在日期`2012-05-02`等时返回5 月

是否有一个 TSQL 函数可以返回 April、May、June？

IE`MONTHNAME(CMS.App_Received_Date) as 'App Month'`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:02:36.553

```
DATENAME(month, CMS.App_Received_Date) as 'App Month' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T21:02:54.713

```
SELECT  DATENAME(month, '2012-04-01') AS 'App Month' 
```

返回表示指定日期的指定日期部分的字符串。

请注意，返回值取决于语言环境，在我的情况下它返回`Januar`（德语）。

[http://msdn.microsoft.com/en-us/library/ms174395.aspx](http://msdn.microsoft.com/en-us/library/ms174395.aspx)

# python - 在 django 中不使用表格 clean_data 进行自动完成

> ID：10761302
> 
> 赞同：0
> 
> 时间：2012-05-25T21:00:15.913
> 
> 标签：python, django, django-forms, jquery-autocomplete, cleaned-data

我在表单中使用自动完成功能。表单保存似乎不想正确地进入我的隐藏字段。

自动完成会显示一个名称：例如“Steve Butabi”。它应该发送用户名。用户名是“stevebutabi”。在检查输入值时。用户名“stevebutabi”正确显示。但在 POST 中，`manager : 'Steve Butabi'`显示。我得到一个`Exception Type: DoesNotExist`. 我需要隐藏的用户名，而不是它呈现的字符串。我知道发生了什么，我只是不知道如何解决它。

所以我猜我在问什么：有没有办法忽略 Django 表单中的 clean 函数？

**表格.py**

```
manager = forms.CharField(max_length=200, required=True, widget=forms.TextInput(attrs={'class':'input-text','id':'id_managerbox'}))

def clean(self):
     if not 'manager' in self.cleaned_data:
          raise forms.ValidationError('You must supply a manager for this fund.')
     return self.cleaned_data

def save(self, request):
     if self.is_valid():
          if self.cleaned_data['manager']:
               manager = ManagerProfile.objects.get(user__username=self.cleaned_data['manager'])
               # I've also tried :
               manager = ManagerProfile.objects.get(user__username=request.POST['manager'])
    ...
               ManagesFund.objects.get(manager=manager).save() 
```

**Javascript**

```
 $(document).ready(function() {  
         $.get('/autocomplete/managers/', function(data) {
              var completions = new Array();
              var dict = JSON.parse(data, function(key, value) {
                   completions.push(key);
                   return value;
              });
              $('#id_managerbox').autocomplete({
                   source: completions,
                   minLength: 2,
                   select: function(event, ui) {
                        $('#id_manager').val(dict[ui.item.value]);
                   }
              });
         });
    }); 
```

**模板**

```
<input type="hidden" name="manager" id="id_manager" />
{{ form.manager }} 
```

提前致谢。

# vim - Vim：如何更改/选择函数名

> ID：10761311
> 
> 赞同：3
> 
> 时间：2012-05-25T21:01:11.610
> 
> 标签：vim

鉴于：

```
function(param); 
```

将光标放在函数上的任意位置，我可以使用 ciw on function 来替换它，或者使用 viw 来选择函数名称。

在以下情况下，我该如何做同样的事情：

```
object.function(param);
object.function<blah>(param); 
```

请注意，ciW 或 viW 不起作用。这是否需要重新定义 vim 如何尊重它的“词”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:06:08.833

你在正确的轨道上，你需要调整 vim 分隔单词的方式。

为此添加`.`为单词分隔符：

```
:set iskeyword+=\. 
```

# iphone - Facebook 连接重新启动我的 iPhone 应用程序

> ID：10761313
> 
> 赞同：-1
> 
> 时间：2012-05-25T21:01:22.550
> 
> 标签：iphone, facebook

我正在构建一个 iPhone 应用程序，我想在其中添加 Facebook 登录。在 viewDidLoad 我添加了：

```
 facebook = [[Facebook alloc] initWithAppId:@"MYAPPID" andDelegate:self];
    facebook.sessionDelegate=self;
    if ([defaults objectForKey:@"FBAccessTokenKey"] 
        && [defaults objectForKey:@"FBExpirationDateKey"]) {
        facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
        facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];
    } 
```

当用户点击一个按钮时，我调用一个函数：

```
 NSArray *permissions = [[NSArray arrayWithObjects:@"read_stream", @"publish_stream", @"offline_access",nil] retain];
    [facebook authorize:permissions ]; 
```

它启动 safari 并进行 facebook 登录；问题是当它返回到应用程序时，它会重新启动应用程序，而我需要直接返回到我的 ViewController，而不是 FirstViewController。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:19:09.157

在旧的 SO 线程中找到了答案

在 facebook.m 中：

```
- (void)authorize:(NSArray *)permissions {
    self.permissions = permissions;

    [self authorizeWithFBAppAuth:NO safariAuth:NO];
} 
```

# android - 简单布局问题

> ID：10761314
> 
> 赞同：0
> 
> 时间：2012-05-25T21:01:24.870
> 
> 标签：android

我在对话框中呈现 TextView 和 Seekbar 时遇到了一个问题。

我正在从[android 网站练习本教程](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/media/AudioFxDemo.html)

问题出在 for 循环中，TextView 和 SeekBar 应该被添加 5 次，并且应该显示在 Dialog 中。但只显示一个 TextView。

这是代码：

```
public void onCheckedChanged(RadioGroup rgroup, int rbutton) {
    String eqSettingName = ((RadioButton) findViewById(rbutton)).getText()
            .toString();
    if (eqSettingName.equals("Custom")) {
        Dialog dialog = new Dialog(this);
        dialog.setTitle("Custom Equalizer");
        LinearLayout LL = new LinearLayout(this);

        short noOfBands = mEqualizer.getNumberOfBands();
        final short minEQLevel = mEqualizer.getBandLevelRange()[0]; 
        final short maxEQLevel = mEqualizer.getBandLevelRange()[1]; 

        for (short i = 0; i < noOfBands; i++) {
            short band = i;

            TextView freqTV = new TextView(this);
            freqTV.setLayoutParams(new ViewGroup.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT));
            freqTV.setGravity(Gravity.CENTER_HORIZONTAL);
            freqTV.setText((mEqualizer.getCenterFreq(band)) / 1000 + " Hz");
            LL.addView(freqTV);

            SeekBar bar = new SeekBar(this);
            bar.setLayoutParams(layoutParams);
            bar.setMax(maxEQLevel - minEQLevel);
            bar.setProgress(mEqualizer.getBandLevel(band));
            LL.addView(bar);

        }

        /*
        LayoutInflater inflater = (LayoutInflater) this.getSystemService(LAYOUT_INFLATER_SERVICE);
        View layout = inflater.inflate(R.layout.customseekbar,
                (ViewGroup) findViewById(R.id.rlCustomEqualizerSeekBar));
        */
        dialog.addContentView(LL, layoutParams);
        dialog.show();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:03:43.527

您的`LinearLayout`默认值为`orientation="horizontal"`. 将其方向更改为垂直，您将看到您想要的。

```
LL.setOrientation(LinearLayout.VERTICAL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:03:38.113

您的 LinearLayout 方向是否正确？

```
LL.setOrientation(LinearLayout.VERTICAL); 
```

# java - getdate() 通过结果集查询不抛出当前行异常

> ID：10761315
> 
> 赞同：0
> 
> 时间：2012-05-25T21:01:31.953
> 
> 标签：java, sql-server, resultset, jtds

我在这里有一个问题，我想做的是从表中获取当前日期和列。到目前为止，这是我的代码：

```
s = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
rset = s.executeQuery("select getdate() as date, tglpengiriman from orders");
java.sql.Date date = rset.getDate("date");
java.sql.Date tglkirim = rset.getDate("tglpengiriman"); 
```

并在上面我的代码的第 3 行中抛出异常“ResultSet 中没有当前行”。我的代码有什么问题？可能误解了 ResultSet 的用法？

感谢您的任何回答...

编辑：回答。请参阅下面@Christopher 的帖子。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:05:46.100

在调用任何 ResultSet.get* 方法之前，您需要调用 ResultSet.next。查看 Statement、ResultSet 等的文档。另外，请务必在“finally”块中关闭所有资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:06:47.083

您需要 `rset.next()`在从结果集中获取数据之前调用。`rset.next()`检查返回的 true也是明智的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T07:02:11.170

迭代你的结果集数据像这样

```
while (resultSet.next()) {
java.sql.Date date = rset.getDate("date");
java.sql.Date tglkirim = rset.getDate("tglpengiriman"); 
} 
```

因为结果集的初始位置总是在第一条记录之前，即在第一条记录的开头，这个 resultSet.next() 使您的结果集指向第一条记录。

# android - 在 ListFragment 中启用 onListItemClick

> ID：10761320
> 
> 赞同：1
> 
> 时间：2012-05-25T21:02:11.000
> 
> 标签：android, listview, actionbarsherlock, android-listfragment

我有一个 ListFragment 正在从 ActionBar 中的选项卡导航中调用。我有一个自定义适配器来为每个列表项显示两个不同的文本视图。我在实现我的 onItemClickListener 时遇到了麻烦。这是我的 ListFragment 代码：

```
public class MaterialsListFragment extends SherlockListFragment {

    public ERGAdapter db;   

    @Override
    public View onCreateView(LayoutInflater inflater, 
    ViewGroup container, Bundle savedInstanceState) {   
        return inflater.inflate(R.layout.portrait_material_view, container, false);
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // create new DBAdapter
        db = new ERGAdapter(getActivity());

        // ---- get all records
        db.open();      // Open database

        // Get all of the notes from the database and create the item list
        Cursor c = db.getAllRecords();

        String[] from = new String[] { ERGAdapter.KEY_IDNO, ERGAdapter.KEY_MATERIAL };
        int[] to = new int[] { R.id.idno, R.id.materials };        

        // Now create an array adapter and set it to display using our row
        MyListAdapter materials = new MyListAdapter(getActivity(), R.layout.list_cell, c, from, to);
        setListAdapter(materials);

        // get the list view and the set the listener
        ListView lv = getListView();
        lv.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                Log.i("MATERIAL"," - position: "+Integer.toString(position));
            }
        });
    }   

    public class MyListAdapter extends SimpleCursorAdapter {

        public MyListAdapter(Context context, int layout, Cursor cursor, String[] from, int[] to) {
            super(context, layout , cursor, from, to);
        }

        @Override
        public void bindView(View view, Context context, Cursor cursor) {

            // Create the idno textview with background image
            TextView idno = (TextView) view.findViewById(R.id.idno);
            String unidno = String.format("%1$.0f", cursor.getDouble(3));
            idno.setText(unidno);

            // create the material textview
            TextView materials = (TextView) view.findViewById(R.id.materials);
            materials.setText(cursor.getString(1));
        }
    } 
} 
```

这条线我遇到了一个致命的例外：`ListView lv = getListView();`

这是相关的logcat：

```
05-25 16:32:45.802: E/AndroidRuntime(660): Caused by: java.lang.IllegalStateException: Content view not yet created
05-25 16:32:45.802: E/AndroidRuntime(660):  at android.support.v4.app.ListFragment.ensureList(ListFragment.java:328)
05-25 16:32:45.802: E/AndroidRuntime(660):  at android.support.v4.app.ListFragment.getListView(ListFragment.java:222)
05-25 16:32:45.802: E/AndroidRuntime(660):  at com.cca.ergpro.MaterialsListFragment.onCreate(MaterialsListFragment.java:80) 
```

我认为我需要将其作为我的自定义 CursorAdapter 的一部分，但我不确定如何继续。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:54:05.403

我能够使用这个问题的解决方案让它工作：

[创建自定义简单光标适配器](https://stackoverflow.com/questions/9690439/creating-custom-simple-cursor-adapter)

# c# - linq to datatable 列计算不正确

> ID：10761321
> 
> 赞同：0
> 
> 时间：2012-05-25T21:02:17.507
> 
> 标签：c#, asp.net, linq

尝试使用 linq 计算列值。它正确求和，但在除法或乘法时产生不正确的值。示例如下。

```
public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        DataTable dtWidgets = Get_widgets();   
        DataTable dtHits = Get_hits();

        var hit_rate =
        from w in dtWidgets.AsEnumerable()
        join h in dtHits.AsEnumerable()
            on w[0] equals h[0]
        select new
        {
            Date = w.Field<DateTime>("calendar_date"),
            Widgets = w.Field<int>("widgets"),
            Hits = h.Field<int>("hits"),
            TestSum = w.Field<int>("widgets")+h.Field<int>("hits"),
            TestMult = w.Field<int>("widgets") * h.Field<int>("hits")
        };

        gvWidgets.DataSource = dtWidgets;
        gvWidgets.DataBind();

        gvHits.DataSource = dtHits;
        gvHits.DataBind();

        gvLinq.DataSource = hit_rate.ToArray();
        gvLinq.DataBind();

    }

    static DataTable Get_widgets()
    {
        DataTable widgets = new DataTable();
        widgets.Columns.Add("calendar_date", typeof(DateTime));
        widgets.Columns.Add("widgets", typeof(int));

        widgets.Rows.Add("05/15/2012", 200000);
        widgets.Rows.Add("05/16/2012", 210000);
        return widgets;
    }

    static DataTable Get_hits()
    {
        DataTable hits = new DataTable();
        hits.Columns.Add("calendar_date", typeof(DateTime));
        hits.Columns.Add("hits", typeof(int));

        hits.Rows.Add("05/15/2012", 100000000);
        hits.Rows.Add("05/16/2012", 120000000);
        return hits;
    }
} 
```

回报：

日期小部件命中 TestSum TestMult

5/15/2012 12:00:00 AM 200000 100000000 100200000 -1662697472

2012 年 5 月 16 日上午 12:00:00 210000 120000000 120210000 1426874368

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:43:26.867

鉴于您在代码下方列出的示例数字，看起来您正在获得整数溢出。尝试将字段类型设为 Int64。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:43:47.760

如果我在哪里，我会查看 c# 中 int 的限制... (2147483647)

尝试使用 long (= Int64)

```
20000000000000 
>
2147483647 
```

# c# - 如何在 axWindowsMediaPlayer 中播放来自 WinForms 资源的视频？

> ID：10761331
> 
> 赞同：1
> 
> 时间：2012-05-25T21:03:14.623
> 
> 标签：c#, winforms, axwindowsmediaplayer

有人知道或知道如何将应用程序资源中的视频播放到 axWindowsMediaPlayer 组件中吗？

我的意思是：

```
axWindowsMediaPlayer1.TheProperty = Resources.MyVideoResource; 
```

会很好，但我不认为这样的财产存在..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T06:01:51.167

将 Interop.axWMPLib 和/或 Interop.WMPLib 引用添加到您的项目

（如果我不记得错误的 axWmpLib 与 windows mp 一起使用，并且如果在 pc 上没有找到 wmp，那么 wmplib 会自动连接到任何已安装的 - 或默认的 - 支持 wmplib 的媒体播放器 - 即 winamp 或 splayer- .. 我只使用过一次去年 -2011 年 8 月 - 让我的 gf 为她的生日感到惊讶.. 所以它在媒体列表包含 2 个 mp3 之前也能正常工作，我直接给出这些代码（路径除外）

```
 private void axWindowsMediaPlayer1_ClickEvent(object sender, AxWMPLib._WMPOCXEvents_ClickEvent e)
        {
            axWindowsMediaPlayer1.URL = fullPathOfYourFirstMedia;
            axWindowsMediaPlayer1.Ctlcontrols.play(); // activates the play button
            axWindowsMediaPlayer1.Ctlcontrols.next(); // activates the next button
            WMPLib.IWMPMedia media = axWindowsMediaPlayer1.newMedia(fullPathOfYourSecondMedia);
            axWindowsMediaPlayer1.currentPlaylist.appendItem(media);
        } 
```

如果您从资源中获取媒体，则只需将媒体添加到项目的资源中，并将完整路径字符串的开头设为“ `Application.Startup`”

# msbuild - 如何在 Atlassian OnDemand 上构建 C# 项目？

> ID：10761333
> 
> 赞同：9
> 
> 时间：2012-05-25T21:03:27.507
> 
> 标签：msbuild, continuous-integration, bamboo

我一直在从 MS Visual Studio IDE 构建我的 C# 项目，并从 Windows 上的 Jenkins 调用 msbuild。现在我想在 Atlassian OnDemand 上构建 C# 项目。

但是，msbuild 没有在 OnDemand 中作为构建器选项列出，我找不到任何关于如何在 OnDemand 上构建 C# 项目的文档。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T08:21:01.723

## 更新

Atlassian OnDemand Bamboo 具有截至 2012 年 7 月中旬的 Windows 库存图像，请参阅 Azwandi Mohd Aris 的[评论](https://answers.atlassian.com/questions/558/how-do-i-run-net-builds-on-jira-studio/78033)：

> 只是 Bamboo OnDemand 现在附带基于 Windows 的 AMI 的更新 - 请参阅[https://confluence.atlassian.com/display/AOD/July+2012#July2012-Bambooupgrade上的发布说明](https://confluence.atlassian.com/display/AOD/July+2012#July2012-Bambooupgrade)

根据 James Dumay 在2012 年 11 月上旬的[回答，此图像同时还支持 MSBuild。](https://answers.atlassian.com/questions/30624/how-can-i-run-bamboo-ondemand-with-msbuild/103775)

* * *

## 初步答案

构建器的配置是[Atlassian OnDemand for Bamboo 中的受限功能之一](https://confluence.atlassian.com/display/AOD/Restricted+Functions+in+Atlassian+OnDemand#RestrictedFunctionsinAtlassianOnDemand-Bamboo)：

> Bamboo OnDemand 仅使用弹性代理运行构建。因此，只能[使用自定义图像](https://confluence.atlassian.com/pages/viewpage.action?pageId=253231639)来配置功能。

因此，原则上您需要使用Atlassian 提供的默认[Stock 图像之一或](https://confluence.atlassian.com/display/BAMBOO40/Stock+images)[创建](https://confluence.atlassian.com/display/BAMBOO40/Creating+a+custom+elastic+image)我们自己的自定义弹性图像。虽然 Atlassian 提供了Bamboo 3.4 的[Windows 库存图像](https://confluence.atlassian.com/display/BAMBOO40/Stock+images#Stockimages-Windowsstockimage)，但最烦人的 Bamboo for OnDemand 版本仍然停留在 3.0（请参阅[Atlassian OnDemand 应用程序版本](https://confluence.atlassian.com/display/AOD/Atlassian+OnDemand+Application+Versions)），包括 DVCS 支持在内的早该更新的更新最近再次推迟（请参阅[Lingbo Lu 的评论](https://confluence.atlassian.com/display/AOD/Atlassian+OnDemand+Application+Versions?focusedCommentId=283640209#comment-283640209)：*我们希望我们可以在 7 月/8 月的时间范围内交付它*）

因此，目前恐怕您需要应用[创建自定义弹性映像](https://confluence.atlassian.com/display/BAMBOO030/Creating+a+Custom+Elastic+Image)的 Bamboo 3.0 版本，并为自己手头的任务创建适当的自定义映像。

### 更新

[Atlassian Answers](https://answers.atlassian.com/)上也有几个相关的主题：

James Dumay 对[How do I run .NET builds on JIRA Studio](https://answers.atlassian.com/questions/558/how-do-i-run-net-builds-on-jira-studio/604)的回答总结了事态，并推荐了 Grace Mollison 的关于[设置 Windows AMI 以](http://devopscloud.net/2011/03/25/setting-up-a-windows-ami-for-use-with-elastic-bamboo/)依次与 Elastic Bamboo 一起使用的说明。但是，RodH 关于[如何使用 MSBuild 运行 Bamboo OnDemand 的评论？](https://answers.atlassian.com/questions/30624/how-can-i-run-bamboo-ondemand-with-msbuild/30756)表示此方法/解决方案的未指定问题。

因此，最终要为艰难的旅程做好准备。

# java - 无法从主类中看到我创建的数组对象的属性

> ID：10761336
> 
> 赞同：-5
> 
> 时间：2012-05-25T21:03:38.753
> 
> 标签：java, arrays

**类块**

```
public class block {    
public enum size {SMALL,MEDIUM,LARGE,XLARGE}
    public String color;public size sz;

public block(String color, size sz) {
    super();
    this.color = color;
    this.sz = sz;
}
     public block() {
    this.color="White";
    this.sz=sz.SMALL;

}

public String toString() {
    String result="My color is " + color + " and size=" + sz;
    return result;} 
```

**类 rowOfBlock**

```
public class rowofBlocks extends block{

        private block[] blocks;
private int numofBlocks;

public rowofBlocks(int numofBlocks){
    //super();
    this.numofBlocks=numofBlocks;
    generateBlocks() ;
}

private void generateBlocks() {

    this.blocks=new block[numofBlocks];

}

public String toString() {
    for(int a=0;a<blocks.length;a++)
    {

    System.out.print( blocks[a]);
    }
    String a="d";
    return a;
}
} 
```

**类游戏主**

```
public class gameMain {

    public static void main(String[] args) {

block b=new block();
b.setSz(block.size.LARGE);
b.setColor("WHITE");

    rowofBlocks myrows=new rowofBlocks(3);
    System.out.println(b);
    System.out.println(myrows);
    }} 
```

我的意思是当我尝试创建块数组时，我只看到 nullnullnulld 而不是 My color is White。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T12:01:25.717

你得到`null`值是因为你没有`Block`在你的数组中创建任何类对象`RowOfBlocks`。

使用以下命令创建数组后：

```
this.blocks = new block[numofBlocks]; 
```

在方法体中`generateBlocks()`

您必须对其进行迭代并插入实际块：

```
for(int i=0 ; i < this.blocks.length ; i++) {
     this.blocks[i] = new Block();
} 
```

# .net - SQL Compact 3.1 客户端能否使用 SQL Compact 3.0 服务器组件进行复制

> ID：10761339
> 
> 赞同：1
> 
> 时间：2012-05-25T21:04:06.087
> 
> 标签：.net, sql-server-2005, compact-framework, sql-server-ce

有一个使用 SQL Mobile 2005（当时 MS 称之为）的 Windows CE 设备安装基础，它被认为是 3.0。后端是 SQL Server 2005，在 IIS 上安装了复制代理 (sscerp30.dll)。

快进几年，SQL Mobile 现在称为 SQL Compact（感谢 MS，非常有帮助），可与 SQL Server 2005 一起使用的最新版本的 SQL Compact 是 SQL Compact 3.1。

我的问题是，3.1 客户端能否复制到服务器？设置资源以实施和（重要的是）测试需要很多天，所以如果知道这不起作用，我可以节省大量时间。

* * *

需要明确的是，这更多的是关于处理 SQLCE 复制的 IIS 复制代理。我想象 SQL Server 2005 是幸福地不知道 3.0 和 3.1 之间的区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:13:08.703

简短的回答是肯定的。

长答案是据说 3.0、3.1 和 3.5 都可以与 SQL Server 2005/2008 一起复制（限制基于发布兼容性级别）。 [在复制拓扑中使用多个版本的 SQL Server - Web 同步所需的组件和兼容性级别](http://msdn.microsoft.com/en-us/library/ms143241%28v=sql.105%29.aspx)

# emulation - 在 C++03 auto_ptr 为什么不调用编译器生成的 copy-ctor？

> ID：10761342
> 
> 赞同：0
> 
> 时间：2012-05-25T21:04:09.707
> 
> 标签：emulation, auto-ptr, c++03, move-constructor

我了解`auto_ptr`C++03 中的工作原理。它基于[这个](https://stackoverflow.com/questions/4514124/how-could-one-implement-stdauto-ptrs-copy-constructor/4514204#4514204)技巧。当编写这样的代码时，该技巧使用用户定义的转换将指针从一个对象窃取到另一个对象`auto_int p(auto_int(new int()));`。但是，我在这方面有几个问题。

1.  为什么不调用编译器生成的 copy-ctor？
2.  为什么用户定义的转换优先于编译器生成的复制ctor？
3.  是否有编译器生成的 copy-ctor 开头？
4.  如果不是，什么语言规则禁止它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:07:22.870

> 为什么不调用编译器生成的 copy-ctor？

因为该类已经提供了一个复制构造函数，一个仍然有效的可变构造函数，所以编译器不会生成一个默认构造函数。

> 为什么用户定义的转换优先于编译器生成的复制ctor？

没有编译器生成的复制构造函数。

> 是否有编译器生成的 copy-ctor 开头？

最后！不，没有。

> 如果不是，什么语言规则禁止它？

这是 12.8.2：

> 类 X 的非模板构造函数是复制构造函数，如果它的第一个参数是 X&、const X&、volatile X& 或 const volatile X& 类型，并且没有其他参数，或者所有其他参数都有默认参数。

和 12.8.4：

> 如果类定义没有显式声明复制构造函数，则隐式声明。

# git - Git将修补程序合并到多个分支

> ID：10761348
> 
> 赞同：26
> 
> 时间：2012-05-25T21:04:51.203
> 
> 标签：git, branching-and-merging, merge-conflict-resolution

我一直试图围绕 git 分支模型。我一直在查看[http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)以获得一些想法，并且来自 Subversion 我真正期待的一件事是在一个地方进行更改并且将它合并到所有需要它的分支。在 Subversion 中，我们最终做了很多代码副本。

但是我仍然没有完全理解这一点。这是我拥有的标准工作流程类型，它总是会出现冲突。

```
# create new version branch
git checkout master
git checkout -b v3
vim pom.xml  # change branch version to "3.1-SNAPSHOT"
git commit -a
git checkout master
vim pom.xml  # change master version to "4.0-SNAPSHOT"
git commit -a 
```

所以master在4.0-SNAPSHOT，分支在3.1-SNAPSHOT。

不是我想在分支上创建一个修补程序并将其移动到主干。

```
git checkout v3
git checkout -b hotfix
vim file.txt  # make a bugfix change
git commit -a
git checkout v3
git merge hotfix  # this works fine
git checkout master
git merge hotfix  # this has a conflict since both branches have changed the version 
```

我理解它为什么会发生，这是有道理的。有没有更好的方法来做到这一点？

我读到了cherry-pick，我对其进行了测试并且确实有效：

```
git checkout v3
git cherry-pick a518b0b75eaf28868
git checkout master
git cherry-pick a518b0b75eaf28868 
```

但是，这似乎不是处理此问题的“正确”方法。有什么建议么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-25T21:58:05.137

如果你想获得关于它的超级技术，你可以从一个共同的祖先创建修补程序：

```
git merge-base v3 master
git checkout -b hotfix <whatever you got from merge-base>
# make your fix
git checkout v3 && git merge --no-ff hotfix
git checkout master && git merge --no-ff hotfix

        v3--------v3 (hotfixed)
       /         /
ancestor----hotfix
       \         \
        master----master (hotfixed) 
```

该`--no-ff`标志用于突出显示 Git 将创建合并提交，将`hotfix`分支标签保留在修补程序提示处，而不是将标签拉到`v3`or `master`。（您可以省略该标志并获得相同的行为，因为该`hotfix`分支有一个不在`master`or中的提交`v3`。更多信息[在文档中](https://git-scm.com/docs/git-merge#_fast_forward_merge)。）

就个人而言，我认为这是矫枉过正。我会选择 gahooa：在分支上制作有意义的修补程序，然后根据您希望分支如何相互关联来合并或挑选。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-25T21:16:44.513

真的，您的答案取决于您是否希望您的树基于相同的历史...例如，4.0 基于最新的 3.X + 4.0 中的所有更改...

就个人而言，一旦您决定为新版本启动新分支，我不建议您这样做。在给定的时间点，软件正在朝着不同的方向发展，因此您的分支机构也应该如此。

这将`git cherry-pick`成为您理想的解决方案。在最有意义的任何分支中进行更改，然后将其挑选到旧版本。这就像您签出旧分支并**手动**应用相同的更改并进行新的提交一样。它保持清洁和重点。

Git merge 或 rebase 将尝试以各自的方式将分支历史集成在一起，我怀疑您在向后移植错误修复等时不希望这样做......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T21:12:02.200

在这种情况下，您正在处理分支“4.0”并且必须修复“3.1”，您可以在提交“3.1”后重新设置“4.0”：

确保您在功能分支 4.0 上：

```
git checkout 4.0 
```

保存当前工作，以便查看其他分支：

```
git stash  
git checkout 3.1 
```

进行编辑和提交：

```
git commit -a -m "bug fix"  
git checkout 4.0 
```

取回您的更改：

```
git stash apply 
```

更改 4.0，使其分支“3.1”的当前头：

```
git rebase "3.1" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-31T19:46:27.663

我也一直在为这个问题苦苦挣扎，我认为如果你愿意稍微改变你的版本控制策略（即，偏离 Maven 鼓励的 -SNAPSHOT 版本），这可以通过使用固定版本来解决（像 SNAPSHOT 或 0.0.0-SNAPSHOT）在 master 上（或任何你的开发分支）。（如果您使用 Maven，SNAPSHOT 后缀很重要，因为 Maven 对待 SNAPSHOT 版本的工件与其他工件不同。）

实际上，我认为您希望制定一项政策，即只在生产分支（您从中构建发布的分支）或仅用于发布目的的分支（例如，更改版本号）上更改版本号，并且您从不打算将其合并回开发分支。

我还没有真正使用过这个策略，只是在考虑它，我想我会开始尝试它。

# android - 将布局中的文本居中，以另一个视图限制左侧大小

> ID：10761349
> 
> 赞同：1
> 
> 时间：2012-05-25T21:04:52.140
> 
> 标签：android, layout, center, gravity

让我解释一下，需要根据父级将 tex 居中，但要考虑到布局左侧的视图：

```
|------------Screen--------------|
[View]    [Short Text]

|------------Screen--------------|
[View][Loooooooooooooooooong Text] 
```

使用相对布局重力属性我只得到这个：

```
|------------Screen--------------|
[View]       [Short Text]          <------THIS IS WRONG.

|------------Screen--------------|
[View][Loooooooooooooooooong Text] 
```

提前致谢

问题是关于如何进行布局。没有任何代码可以从它开始（当然不使用视图宽度的固定值），我实际上是用相对的，但没有运气。

现在，如果您真的想要从头开始，现在我正在使用@Padma Kumar 的建议

```
<LinearLayout
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:gravity="center">
    <ImageView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:layout_weight="0"
    android:src="@drawable/something" />
    <TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="1" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:12:17.533

将您的 2 个视图置于线性布局中

//利用`android:layout_Weight`

对于您的视图，将权重设为“0”，对于您的短文本视图，将权重设为“1”，将重力设为左侧。

这会很好用

# asp.net - 超时过期错误——不是 sql server 超时

> ID：10761353
> 
> 赞同：0
> 
> 时间：2012-05-25T21:05:13.840
> 
> 标签：asp.net, exception-handling, timeout

我已经建立了一个方案，我的客户网站（一个 ASP.NET 2.0 应用程序）上的任何异常都会通过电子邮件发送给我。几乎每天晚上（通常发生在晚上）我都会收到如下错误：

```
Error: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.

Stack Trace:
   at carart.products.Page_Error(Object sender, EventArgs e)
   at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)
   at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)
   at System.Web.UI.TemplateControl.OnError(EventArgs e)
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.products_aspx.ProcessRequest(HttpContext context)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

最后一个位置是 Page_Error，因为我有一个 Page_Error 处理程序，它重定向到 Error.aspx 页面并向用户显示一条消息。在它进行重定向之前，它会发送详细说明错误的电子邮件。

我真的不知道我的代码在哪一点失败了，但我假设它甚至没有到达 Page_Load ，因为它没有出现在堆栈跟踪中。

我每晚至少得到 3 或 4 个这样的东西——但有时在白天也是如此，有时它会干扰客户结账和其他对我客户的业务至关重要的事情。

我该如何调试呢？我必须设置什么属性来告诉它等待更长时间才能连接到服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:15:05.890

嗯，您可能想进一步调查为什么会发生超时，但为了增加超时（您可能最好将其设置为特定于页面），您可以在 web.config 中执行此操作：

```
<location path="somefile.aspx">
    <system.web>
            <httpRuntime executionTimeout="180"/>
    </system.web>
</location> 
```

# java - Android USB主机与定制板的串行通信

> ID：10761354
> 
> 赞同：1
> 
> 时间：2012-05-25T21:05:17.273
> 
> 标签：java, android, xml, usb

我正在使用 android 4.0.3 平板电脑。我需要它通过 USB 串行以 9600 波特率与定制板通信。定制板的 USB 端口允许串行连接。我想知道是否有人可以为我指明如何让我的平板电脑上的应用程序在两者之间发送和接收一些信息。感谢所有帮助。

狗z1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:21:45.910

您应该使用 USB Host API 来执行此操作。API 文档解释了如何使用 USB Host API，在官方文档页面中逐步说明：http: [//developer.android.com/guide/topics/usb/host.html](http://developer.android.com/guide/topics/usb/host.html)

此外，如果您正在使用 Arduino 板之类的东西，并且您的板具有 USB 主机功能，我建议您使用[ADK](http://developer.android.com/guide/topics/usb/adk.html)进行通信。

# cocoa - 在 OS X 中绘制 pdf 的命令行应用程序

> ID：10761358
> 
> 赞同：0
> 
> 时间：2012-05-25T21:05:32.920
> 
> 标签：cocoa, core-graphics

我正在尝试找出一种制作命令行应用程序（桌面上的 OS X）的好方法，该应用程序可以绘制和保存 pdf。如果我有一个带视图的 GUI，那么我将使用 NSBezierPath 对象，最后执行 [myView dataWithPDFInsideRect:r]。

我一直在使用通过 CGPDFContextCreateWithURL 获得的 CGContextRef ，但它很笨重。像具有两个控制点的 CGContextAddCurveToPoint 这样简单的东西并没有像我预期的那样呈现（中间看起来很奇怪）。而像斯科特史蒂文森[（第二部分）](http://cocoadevcentral.com/d/intro_to_quartz_two/)这样复杂的东西似乎是不可能的。

我错过了一些简单的东西吗？有没有办法在没有窗口的情况下构建视图并绘制到它？一种制作更高级核心图形的方法？

更新：为了清楚起见， main 中的代码是：

```
int main(int argc, char * argv[]) {
    MyView *myView;
    NSRect f = NSMakeRect(0,0,300,300);
    myView = [[MyView alloc] initWithFrame:f];
    NSData *data = [myView dataWithPDFInsideRect:f];
    [data writeToFile:@"x.pdf" atomically:YES];
    return 0;
} 
```

从终端：

```
clang prog.m -o prog -framework Cocoa -fobjc-gc-only
./prog 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:27:47.050

如果您创建一个命令行工具来链接 AppKit 并在没有窗口的独立视图上使用 dataWithPDFInsideRect，并从 terminal.app 手动运行它，这将像您期望的那样工作。如果您通过 ssh 或其他类似已启动作业的方式登录，这可能不起作用。

# c# - 我需要在 XAML 中的弹出窗口的右上角放置一个标签

> ID：10761359
> 
> 赞同：1
> 
> 时间：2012-05-25T21:05:34.420
> 
> 标签：c#, wpf, xaml, popup, label

这是我的代码。我已经尝试了几种方法来获取弹出窗口右上角的标签并使其保持在那里，但没有任何效果。谢谢你的帮助！

XAML：

```
<Window x:Class="ValidationWPF.MainWindow"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
                xmlns:local="clr-namespace:ValidationWPF"
                Title="MainWindow" mc:Ignorable="d" 
                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" d:DesignHeight="259" d:DesignWidth="420" SizeToContent="WidthAndHeight">
    <Grid Height="129" Width="345">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="514*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="0" />
            <RowDefinition Height="251*" />
        </Grid.RowDefinitions>
        <Button Content="Errors" Height="23" HorizontalAlignment="Left" Name="button1" VerticalAlignment="Top" Width="75" Grid.Column="1" Grid.Row="1" Margin="132,12,0,0" MouseEnter="button1_MouseHover">

        </Button>

            <Popup AllowsTransparency="True" PlacementTarget="{Binding ElementName=button1}" StaysOpen="True" AllowDrop="True" Name="PopUp1" PopupAnimation="Scroll">

            <Popup.Child>
          <Border BorderBrush="White" BorderThickness="3, 3, 0, 0">
            <Border BorderBrush="Black" BorderThickness="3, 3, 3, 3">

                <TextBlock Background="Salmon">

                  <Label Background="AliceBlue" Foreground="Black" HorizontalAlignment="Stretch" HorizontalContentAlignment="Right" MouseDown="mouse_DownHandeled" AllowDrop="False" Margin="100,100,0,0">
                    x
                    </Label>

                    <local:ValidationUserControl/>
                </TextBlock>      
            </Border>

        </Border>
         </Popup.Child>
            </Popup>

     </Grid>
</Window> 
```

如您所见，我有一个带有 X 的标签的弹出窗口。标签功能齐全。现在我只需要它看起来像一个正常的弹出窗口，右上角的标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T11:46:04.787

试试这个：

```
<TextBlock Background="Salmon" MinWidth="150" MinHeight="150" VerticalAlignment="Top">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120" />
            <ColumnDefinition Width="30" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="120" />
        </Grid.RowDefinitions>
        <Label Grid.Row="0" Grid.Column="1" Background="AliceBlue" Foreground="Black" VerticalAlignment="Top" AllowDrop="False">
            X
        </Label>
    </Grid>                                
</TextBlock> 
```

# c# - 对象的 C# Hastable

> ID：10761365
> 
> 赞同：0
> 
> 时间：2012-05-25T21:06:08.317
> 
> 标签：c#, list, class, hashtable

我在哈希表中有对象，在那个对象中我有一个列表，如何访问它？

```
ls.cs

         class lh 
                {
                    public string name;
                    public  List<ulong> nList = new List<ulong>(); 

                    public lh(string name)
                    {
                        this.name = name; ;
                    }
                }

    Program.cs

    static void Main(string[] args)
    {

    while((line=ps.ReadLine()) != null) 
    { 
        gen.h_lh.Add(line, new lh(line));
    }
    }    
    public class gen
        {
          public static Hashtable h_lh = new Hashtable();
        } 
```

这行得通。当我调试时，我可以看到在哈希表中创建的对象；我只是不能/不知道如何访问/存储列表的价值，它必须是类似于 gen.h_lh[lh].something 的东西吗？但这没有用。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:20:41.783

首先`Hashtable`是过时的，请`Dictionary<TKey, TValue>`改用（`Dictionary<string, lh>`在您的情况下）。

给定一个键，您可以使用以下命令访问该键的值：`h_lh[key]`。

或者您可以使用以下命令枚举所有键/值对：

```
foreach (KeyValuePair<string, lh> pair in h_lh)
    pair.Value // this is an lh object 
```

您还可以仅枚举键`h_lh.Keys`或仅枚举值`h_lh.Values`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:23:30.477

哈希表是一种表示集合的数据结构。这意味着根据定义，您不想访问哈希表来获取元素，您只想添加、删除或询问是否存在元素。这些是集合的基本操作。

这就是说，`HashSet<T>`在 .NET 中没有索引器。为什么？考虑一下你自己写的那行：

```
var item = gen.h_lh[lh] 
```

如果你真的可以提供`lh`to索引，你期望哈希表能给你什么？同一个例子？当然不是，如果您在索引器中使用它，您已经拥有它。所以也许你的问题不是很好确定。

首先，您需要确定为什么（以及如何）要访问这些元素。您想要的只是遍历所有这些，或者您想快速索引其中任何一个？如果您只想在某个时候获取所有元素，那么您拥有所需的一切：`HashSet<T>`implements `IEnumerable<T>`。如果您需要获取特定元素，那么您必须有一些*密钥*来识别该元素（例如`name`这里的属性），在这种情况下，您想要的不是 a`HashSet<lh>`而是 a `Dictionary<string,lh>`，就像@Tergiver 说的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:15:53.973

```
foreach(System.System.Collections.DictionaryEntry entry in h_lh) 
{
    Console.WriteLine("Key: " + entry.Key.ToString() + " | " + "Value: " + entry.Value.ToString());  
} 
```

或者您可以使用密钥访问它

```
lh myLh = h_lh[line]; 
```

更新评论的答案

```
foreach(System.System.Collections.DictionaryEntry entry in h_lh) 
{
    List<ulong> nList = (ulong)entry.Value; 
    nList.Add(1); 
} 
```

# actionscript-3 - 如何向我的类添加默认构造函数

> ID：10761370
> 
> 赞同：0
> 
> 时间：2012-05-25T21:06:14.763
> 
> 标签：actionscript-3

以下是我的构造函数类，但是当我在实例化对象时尝试添加参数时，我收到一条错误消息，指出我没有默认构造函数。我基本上想将一个字符串传递给对象，但并非所有对象都会得到一个字符串。

```
 public function Shortcuts(opencontent:String){
        highlight = new shortcuthighlight();

        highlight.x = highlight.x - highlight.width/2;
        highlight.y = highlight.y - highlight.height/2;
        highlight.visible = false;
        addChild(highlight);
        setChildIndex(highlight,0);

        this.addEventListener(MouseEvent.ROLL_OVER, addHighlight);
        this.addEventListener(MouseEvent.ROLL_OUT, removeHighlight);

        this.addEventListener(MouseEvent.MOUSE_DOWN, dragOn);
        this.addEventListener(MouseEvent.MOUSE_UP, dragOff);

    } 
```

这是我创建对象的方式。

```
for(var i=0; i<shortcutsArray.length;i++){
        var className:Class = getDefinitionByName(shortcutsArray[i][0]) as Class;
        var object:Object = new className('hey');
        var mc:MovieClip = MovieClip(object);
        mc.x = shortcutsArray[i][1];
        mc.y= shortcutsArray[i][2];
        addChild(mc);

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:08:29.427

如果你的意思是你想`opencontent`成为可选的，你可以设置一个默认参数：

```
public function Shortcuts(opencontent:String=null)
{
    /* ... */
} 
```

# android - TabActivity -> Fragments.. 真的这么复杂吗？

> ID：10761371
> 
> 赞同：5
> 
> 时间：2012-05-25T21:06:17.583
> 
> 标签：android, android-fragments, android-activity, android-tabactivity

我知道 tabactivity 的事情已经被一千万人在这里报道过一百万次了。我有开发人员的参考资料，并且一直在阅读我可以在 SO 上找到的所有线程。我的问题是，片段真的那么复杂吗？据我所知，似乎是这样，而 TabActivty 是如此简单。请参见下面的示例：

我当前的代码，需要四个选项卡，如下所示：

```
Resources res = getResources(); // Resource object to get Drawables
        TabHost tabHost = getTabHost(); // The activity TabHost
        TabHost.TabSpec spec; // Resusable TabSpec for each tab
        Intent intent; // Reusable Intent for each tab

        // Create an Intent to launch an Activity for the tab (to be reused)
        intent = new Intent().setClass(this, ServerActivity.class);

        // Initialize a TabSpec for each tab and add it to the TabHost
        spec = tabHost
                .newTabSpec("server")
                .setIndicator("Server",
                        res.getDrawable(R.drawable.ic_tab_server))
                .setContent(intent);
        tabHost.addTab(spec);

        // Do the same for the other tabs
        intent = new Intent().setClass(this, StatusActivity.class);
        spec = tabHost
                .newTabSpec("status")
                .setIndicator("Status",
                        res.getDrawable(R.drawable.ic_tab_status))
                .setContent(intent);
        tabHost.addTab(spec);

        intent = new Intent().setClass(this, LoggingActivity.class);
        spec = tabHost
                .newTabSpec("logging")
                .setIndicator("Logs",
                        res.getDrawable(R.drawable.ic_tab_logging))
                .setContent(intent);
        tabHost.addTab(spec);

        intent = new Intent().setClass(this, DeliveryActivity.class);
        spec = tabHost
                .newTabSpec("deliveryqueue")
                .setIndicator("Queue", res.getDrawable(R.drawable.ic_tab_queue))
                // .setIndicator("Delivery Queue",
                // res.getDrawable(R.drawable.ic_tab_artists))
                .setContent(intent);
        tabHost.addTab(spec);

        tabHost.setCurrentTab(2);
    } 
```

根据开发人员的参考，对于 4 个选项卡的等效项，您需要所有这些：

```
 import java.util.HashMap;

import com.example.android.supportv4.R;

import android.content.Context;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentTransaction;
import android.view.View;
import android.widget.TabHost;

/**
 * This demonstrates how you can implement switching between the tabs of a
 * TabHost through fragments.  It uses a trick (see the code below) to allow
 * the tabs to switch between fragments instead of simple views.
 */
public class FragmentTabs extends FragmentActivity {
    TabHost mTabHost;
    TabManager mTabManager;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.fragment_tabs);
        mTabHost = (TabHost)findViewById(android.R.id.tabhost);
        mTabHost.setup();

        mTabManager = new TabManager(this, mTabHost, R.id.realtabcontent);

        mTabManager.addTab(mTabHost.newTabSpec("simple").setIndicator("Simple"),
                FragmentStackSupport.CountingFragment.class, null);
        mTabManager.addTab(mTabHost.newTabSpec("contacts").setIndicator("Contacts"),
                LoaderCursorSupport.CursorLoaderListFragment.class, null);
        mTabManager.addTab(mTabHost.newTabSpec("custom").setIndicator("Custom"),
                LoaderCustomSupport.AppListFragment.class, null);
        mTabManager.addTab(mTabHost.newTabSpec("throttle").setIndicator("Throttle"),
                LoaderThrottleSupport.ThrottledLoaderListFragment.class, null);

        if (savedInstanceState != null) {
            mTabHost.setCurrentTabByTag(savedInstanceState.getString("tab"));
        }
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putString("tab", mTabHost.getCurrentTabTag());
    }

    /**
     * This is a helper class that implements a generic mechanism for
     * associating fragments with the tabs in a tab host.  It relies on a
     * trick.  Normally a tab host has a simple API for supplying a View or
     * Intent that each tab will show.  This is not sufficient for switching
     * between fragments.  So instead we make the content part of the tab host
     * 0dp high (it is not shown) and the TabManager supplies its own dummy
     * view to show as the tab content.  It listens to changes in tabs, and takes
     * care of switch to the correct fragment shown in a separate content area
     * whenever the selected tab changes.
     */
    public static class TabManager implements TabHost.OnTabChangeListener {
        private final FragmentActivity mActivity;
        private final TabHost mTabHost;
        private final int mContainerId;
        private final HashMap<String, TabInfo> mTabs = new HashMap<String, TabInfo>();
        TabInfo mLastTab;

        static final class TabInfo {
            private final String tag;
            private final Class<?> clss;
            private final Bundle args;
            private Fragment fragment;

            TabInfo(String _tag, Class<?> _class, Bundle _args) {
                tag = _tag;
                clss = _class;
                args = _args;
            }
        }

        static class DummyTabFactory implements TabHost.TabContentFactory {
            private final Context mContext;

            public DummyTabFactory(Context context) {
                mContext = context;
            }

            @Override
            public View createTabContent(String tag) {
                View v = new View(mContext);
                v.setMinimumWidth(0);
                v.setMinimumHeight(0);
                return v;
            }
        }

        public TabManager(FragmentActivity activity, TabHost tabHost, int containerId) {
            mActivity = activity;
            mTabHost = tabHost;
            mContainerId = containerId;
            mTabHost.setOnTabChangedListener(this);
        }

        public void addTab(TabHost.TabSpec tabSpec, Class<?> clss, Bundle args) {
            tabSpec.setContent(new DummyTabFactory(mActivity));
            String tag = tabSpec.getTag();

            TabInfo info = new TabInfo(tag, clss, args);

            // Check to see if we already have a fragment for this tab, probably
            // from a previously saved state.  If so, deactivate it, because our
            // initial state is that a tab isn't shown.
            info.fragment = mActivity.getSupportFragmentManager().findFragmentByTag(tag);
            if (info.fragment != null && !info.fragment.isDetached()) {
                FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();
                ft.detach(info.fragment);
                ft.commit();
            }

            mTabs.put(tag, info);
            mTabHost.addTab(tabSpec);
        }

        @Override
        public void onTabChanged(String tabId) {
            TabInfo newTab = mTabs.get(tabId);
            if (mLastTab != newTab) {
                FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();
                if (mLastTab != null) {
                    if (mLastTab.fragment != null) {
                        ft.detach(mLastTab.fragment);
                    }
                }
                if (newTab != null) {
                    if (newTab.fragment == null) {
                        newTab.fragment = Fragment.instantiate(mActivity,
                                newTab.clss.getName(), newTab.args);
                        ft.add(mContainerId, newTab.fragment, newTab.tag);
                    } else {
                        ft.attach(newTab.fragment);
                    }
                }

                mLastTab = newTab;
                ft.commit();
                mActivity.getSupportFragmentManager().executePendingTransactions();
            }
        }
    }
} 
```

真的那么复杂吗？这就像完成同一件事的代码量的两到三倍。我真的很想远离使用过时的方法，但是哇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:18:49.227

开发人员文档的解决方案是大约 100 行附加代码（加上一个视图替换）。如果您想在选项卡更改时触发操作，则提供的解决方案并不是特别复杂，并且可以在明显的位置 ( **onTabChanged ) 进行扩展。**我不会回避使用它，因为它会获得你想要的结果。我正在从 ActionBar 转移到 TabHost，发现它可以替代我现有的片段管理。

# c# - 如何将两个相似的功能变成一个功能？

> ID：10761372
> 
> 赞同：0
> 
> 时间：2012-05-25T21:06:21.733
> 
> 标签：c#, .net

我有两个函数在两个不同的类上做基本相同的事情......每个类都有不同的属性。

例如：

```
public class ClassA
{
    public int ColorID {get;set;}
    public string ColorDescription {get;set;}
}

public class ClassB
{
    public int TypeID {get;set;}
    public string TypeDescription {get;set;}
}

public void ExFunctionSaveA(ClassA aClass)    
{
  aClass.ColorID=1;
  aClass.ColorDescription="My Color";
  Save();
}

public void ExFunctionSaveB(ClassB bClass)    
{
  bClass.TypeID=2;
  bClass.TypeDescription="My Type";
  Save();
} 
```

正如您所看到的，类和函数具有相同的类型结构，只是属性名称不同......但我觉得我在重复这样做的代码

有没有办法让 ExFunctionA 和 ExFunctionB 成为一个函数，这样我就可以将它用于所有具有相似结构的类

我知道我可以做一些通用的事情，比如

```
public void ExFunctionSave<T>()   // T is either ClassA or ClassB
{
   .
   .
   .
   .
   Save();
} 
```

但是我将如何处理每个属性

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:12:50.040

与其使用泛型，不如使用继承来解决这个问题？

```
public class theBase
{
    string ID;
    string Description;
}
public class theColor : theBase
{
}

public class theType : theBase
{
}

public void ExFunctionSaveA(theBase base)    
{
    base.ID=1;
    base.Description="My Color";
    Save();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T21:12:45.537

如果您可以更改类的定义，那么最好的方法是让它们实现一个包含您要访问的属性的通用接口：

```
public interface IDescribable
{
    int ID { get; set; }
    string Description { get; set; }
}

public class ClassA
{
    public int ID { get; set; }
    public string Description { get; set; }

    public int ColorID 
    { 
        get { return ID; } 
        set { ID = value; } 
    }

    public string ColorDescription 
    { 
        get { return Description; } 
        set { Description = value; } 
    }
}

public class ClassB
{
    public int ID { get; set; }
    public string Description { get; set; }

    public int TypeID 
    { 
        get { return ID; } 
        set { ID = value; } 
    }

    public string TypeDescription 
    { 
        get { return Description; } 
        set { Description = value; } 
    }
}

public void ExFunctionSave(IDescribable d, int id, string desc)    
{
    d.ID = id;
    d.Description = desc;
    Save();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:10:32.763

除非这两个类实现具有该功能的相同接口，否则您无能为力。在您的情况下，即使函数签名也不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T21:12:18.173

您可以定义具有属性 id 和描述的接口。具有这种结构的类可以实现该接口。并且您的方法接收接口作为参数并执行方法...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T21:20:49.680

看看[反射](http://msdn.microsoft.com/en-us/library/f7ykdhsy%28v=vs.110%29.aspx)。

反射会让你的代码接收到 a `ClassA`，并发现它有 a`ColourID`和 a `ColorDescription`。同样，当您收到 a 时`ClassB`，您可以发现它的`TypeID`and `TypeDescription`。这个很酷。

我可能会推荐一个通用接口，至少对于您的示例，但如果您尝试更复杂和更通用的东西，反射是要走的路。

# c# - 调用 C# 类的重载方法的 Javascript 错误

> ID：10761374
> 
> 赞同：0
> 
> 时间：2012-05-25T21:06:38.067
> 
> 标签：c#, overloading, jscript.net

我正在编写一个 C# 类库，并从一些 Javascript 代码（技术上是 Jscript.NET）中调用它。我最近添加了一些重载方法，而 Javascript 无法决定调用哪个方法，因为它并不总是知道其变量的类型。我理解为什么在大多数情况下会发生这种情况，但我有一个我不理解的例子。

以下是 C# 类中的重载方法声明。

```
public virtual DeviceMessage RequestInUnits(
    Command command,
    int value,
    UnitOfMeasure unit)
public virtual DeviceMessage RequestInUnits(
    Command command, 
    Measurement measurement) 
```

我的应用程序具有使用 Jscript.NET 的脚本功能。这是一些尝试在 C# 类上调用其中一种方法的 Javascript 代码。

```
c.RequestInUnits(Command.MoveAbsolute, 0); 
```

这不是合法调用，因为唯一具有两个参数的方法需要一个`Measurement`对象作为第二个参数。但是，我预计会出现类型不匹配错误。相反，这是我得到的编译错误。

```
More than one method or property matches this argument list at line 3 column 1 
```

如果我将 替换为`0`，`""`则会收到类型不匹配错误。为什么Javascript认为它可以将数字转换为对象？为什么它认为它可以将类型强制为不止一种方法？只有一种方法需要两个参数。

这不是一个严重的问题，但是当我的库在调用代码时导致令人困惑的错误消息时，我不喜欢它。如果可以的话，我宁愿避免这种情况。

# jquery - HTML + JS 与 HTML5 性能

> ID：10761385
> 
> 赞同：1
> 
> 时间：2012-05-25T21:08:42.747
> 
> 标签：jquery, performance, html, animation, html5-canvas

我最近在用 HTML5 做一些实验，发现 HTML5 在移动设备、平板电脑甚至台式机上的运行似乎很糟糕。我进行了以下测试：

[使用 jQuery http://erality.com/public/html5/001/](http://erality.com/public/html5/001/)在页面上移动 150 个元素

25 个元素通过 HTML5 在页面上移动 [http://erality.com/public/html5/002/](http://erality.com/public/html5/002/)

jQuery 版本在台式机上运行良好，在较新的平板电脑上运行良好。HTML5 版本（只有 1/6 的元素）在台式机上运行不佳，在平板电脑上也很糟糕。这是正常的表现吗？我做错了什么吗？

任何见解都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:33:13.673

“HTML5”版本性能不佳的原因是它使用了`setTimeout`代替`requestAnimationFrame`(RAF)，这是使用 HTML5 画布为任何内容设置动画的建议方法。 [在这里](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)查看有关英国皇家空军的更多信息。

**编辑**：我应该写“*部分*解释为”

除了 RAF，您应该尝试使用 setInterval 而不是 setTimeout。另外，为什么每个 setTimeout 的持续时间都有随机因素？如果您不想使用 RAF，我建议在每个间隔更新所有花瓣的同时使用固定间隔的 setInterval（尝试 16 毫秒作为初学者）。目前，您为每个花瓣使用单独的 setTimeout，持续时间随机，这可能会导致很多延迟。

[这](http://msdn.microsoft.com/library/hh673556.aspx)是一篇关于 RAF 性能优势的优秀 MSDN 文章。它将 RAF 与 setTimeout/setInterval 进行比较。文章中的一些相关引述：

> 因此，应用程序与浏览器绘制间隔完美对齐，并且仅使用适当数量的资源。

还：

> 无法绘制每第三次绘制，因为在显示刷新间隔之前发生了另一个绘制请求。这种过度绘制会导致动画不连贯，因为每三帧都会丢失一次。这种定时器分辨率的降低也会对电池寿命产生高达 25% 的负面影响。

使用 setTimeout 可能无法*完全*解释示例中的性能差异。其他人指出，这种比较不是苹果对苹果。您应该能够使用 setTimeout 获得更快的动画（我已经使用 setTimeout 编写了一个相当流畅的物理模拟）。无论如何，RAF 比 setTimeout 优越得多，并且是获得最流畅动画的唯一方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:24:43.957

jQuery 和 HTML5 动画性能非常好，因为每种方式都使用不同的方式来移动/绘制对象。

当您使用 jQuery 制作动画时，它会直接访问对象并在屏幕上转换它们，而当 Canvas 元素每次使用新位置的元素时，它都必须重新绘制画布。

PS我有这个说法的来源，但这实际上是我的观点。

# firefox - 如何在地址栏附近创建一个按钮？

> ID：10761388
> 
> 赞同：1
> 
> 时间：2012-05-25T21:08:59.813
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我正在设计一个 Firefox 扩展，我想在地址栏附近添加一个按钮。然后我需要在那个按钮上附加一个小书签。

有人可以告诉我必须使用哪些 API 来创建该按钮并添加书签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T02:05:36.863

这是一个使用 Erik Vold 的工具栏按钮库在地址栏附近添加按钮的示例：

```
const data = require("self").data;
const tabs = require("tabs");

exports.main = function(options) {
    var btn = require("toolbarbutton").ToolbarButton({
        id: 'my-toolbar-button',
        label: 'Add skull!',
        image: data.url('skull-16.png'),
        onCommand: function() {
            if (typeof(tabs.activeTab._worker) == 'undefined') {
                let worker = tabs.activeTab.attach({
                    contentScript: 'self.port.on("sayhello", function() { alert("Hello world!"); })'
                });
                tabs.activeTab._worker = worker;
            }
            tabs.activeTab._worker.port.emit("sayhello");
        }
    });

    if (options.loadReason === "install") {
    btn.moveTo({
      toolbarID: "nav-bar",
      forceMove: false // only move from palette
    });
  }
}; 
```

您还可以在 Add-on Builder 站点上将此视为可运行的示例：

[https://builder.addons.mozilla.org/addon/1044724/latest/](https://builder.addons.mozilla.org/addon/1044724/latest/)

# mysql - mysql join不使用'between'运算符的索引

> ID：10761389
> 
> 赞同：0
> 
> 时间：2012-05-25T21:09:02.767
> 
> 标签：mysql, join, indexing, between

所以基本上我有三个表：

```
CREATE TABLE `cdIPAddressToLocation` (
  `IPADDR_FROM` int(10) unsigned NOT NULL COMMENT 'Low end of the IP Address block',
  `IPADDR_TO` int(10) unsigned NOT NULL COMMENT 'High end of the IP Address block',
  `IPLOCID` int(10) unsigned NOT NULL COMMENT 'The Location ID for the IP Address range',
  PRIMARY KEY  (`IPADDR_TO`),
  KEY `Index_2` USING BTREE (`IPLOCID`),
  KEY `Index_3` USING BTREE (`IPADDR_FROM`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

CREATE TABLE `cdIPLocation` (
  `IPLOCID` int(10) unsigned NOT NULL default '0',
  `Country` varchar(4) default NULL,
  `Region` int(10) unsigned default NULL,
  `City` varchar(90) default NULL,
  `PostalCode` varchar(10) default NULL,
  `Latitude` float NOT NULL,
  `Longitude` float NOT NULL,
  `MetroCode` varchar(4) default NULL,
  `AreaCode` varchar(4) default NULL,
  `State` varchar(45) default NULL,
  `Continent` varchar(10) default NULL,
  PRIMARY KEY  (`IPLOCID`)
) ENGINE=MyISAM AUTO_INCREMENT=218611 DEFAULT CHARSET=latin1; 
```

和

```
CREATE TABLE 'data'{
 'IP' varchar(50)
 'SCORE' int
} 
```

我的任务是连接这三个表并找到给定 IP 地址的位置数据。我的查询如下：

```
select 
    t.ip,
    l.Country,
    l.State,
    l.City,
    l.PostalCode,
    l.Latitude,
    l.Longitude,
    t.score
from
    (select 
        ip, inet_aton(ip) ipv, score
    from
        data
    order by score desc
    limit 5) t
        join
    cdIPAddressToLocation a ON t.ipv between a.IPADDR_FROM and a.IPADDR_TO
        join
    cdIPLocation l ON l.IPLOCID = a.IPLOCID 
```

虽然此查询有效，但速度非常慢，在我的开发盒上返回结果大约需要 100 秒。

我使用的是 mysql 5.1，cdIPAddressToLocation 有 590 万行，cdIPLocation 表有大约 30 万行。

当我检查执行计划时，我发现它没有使用表“cdIPAddressToLocation”中的任何索引，因此对于“数据”表中的每一行，它都会对表“cdIPAddressToLocation”进行全表扫描。这对我来说很奇怪。我的意思是，由于表“cdIPAddressToLocation”中的“IPADDR_FROM”和“IPADDR_TO”列上已经有两个索引，因此执行计划应该利用索引来提高性能，但为什么不使用它们。

还是我的查询有问题？

请帮忙，非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:32:56.263

您是否尝试过在 cdIPAddressToLocation.IPADDR_FROM 和 cdIPAddressToLocation.IPADDR_TO 列上使用复合索引？

[多列索引](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)

# objective-c - 设置后无用户交互

> ID：10761393
> 
> 赞同：0
> 
> 时间：2012-05-25T21:09:35.650
> 
> 标签：objective-c, ipad

我有一个非常古老的 iPhone/iPad 应用程序，实际上它是我的第一个 Objective-C 应用程序，我开始在上面学习 iOS 编程。现在我想更新一下，但有以下问题：

该应用程序从未有任何 viewController。当我开始写它时，我并不熟悉 MCV 和 Interface Builder。第一个版本仅适用于 iPhone，它通过将 UIApplicationDelegate 的**didFinishLaunchingWithOptions**中的 UILabel 和 UIButtons通过 addSubview 直接定位到 self.window 来手动制作 UI（有 MainWindow.xib，但它是空的）。几个月后，我创建了 iPad 版本。它在单个 MainWindow_iPad.xib 中包含在 Interface Builder 中创建的所有 UI。没有其他 xib，只有 UILables 和 UIButtons 直接放在 MainWindow_iPad.xib 中，并且没有再次使用视图控制器。

现在，几年后，我想稍微更新一下这个老牌应用程序。我想添加一个根视图控制器，所以我在 UIApplicationDelegate 的**didFinishLaunchingWithOptions**中设置了 window.rootViewController 。我对 iPhone 版本没有任何问题，它很有效。但我在使用 iPad 时遇到了麻烦。设置 window.rootViewController 后，**应用程序根本不会与任何触摸交互**。它加载，创建了 UI，但它只是被冻结了。

知道有什么问题吗？非常感谢！

不要告诉我我应该把它扔掉并以正常的“经验方式”从头开始重新编写，我知道这将是最好的方式，但我不需要更新它来浪费这么多时间。

# android - 显示 EditText 的正确方法

> ID：10761396
> 
> 赞同：0
> 
> 时间：2012-05-25T21:09:44.213
> 
> 标签：android, layout, android-edittext

我很困惑和沮丧，因为我无法让我的 EditText 字段在布局中占用合理数量的空间，而无需明确告诉它有多少像素。

我*确定我遗漏了一些明显的东西，但我的经验是 EditText 完全忽略 layout_weight 并且如果我给它一个 layout_weight 为“wrap_content”或占用大部分如果我给它一个 fill_parent 的权重，它的父布局中的空间。

那么......拥有占据其父布局的某些部分的 EditText 字段的正确路径是什么（在我的情况下是线性的，但我很灵活），以便它旁边可以有一个标签，看起来像：

```
Name: [ EDIT TEXT HERE   ]
Phone:[ EDIT TEXT HERE   ] 
```

等等

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:38:16.523

你可以做几件不同的事情。如前所述，您应该使用 dp 而不是像素进行布局。使用 dp 可以让您的视图按屏幕的物理尺寸而不是分辨率进行缩放。

这是一个指定编辑框出现在每个标签右侧并占据屏幕其余部分的示例：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/name_label"
        android:layout_width="100dp"
        android:layout_height="50dp"
        android:text="Name:" />
    <TextView
        android:id="@+id/phone_label"
        android:layout_width="100dp"
        android:layout_height="50dp"
        android:layout_below="@id/name_label"
        android:text="Phone:" />
    <EditText
        android:id="@+id/name_text"
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:layout_toRightOf="@id/name_label" />
    <EditText
        android:id="@+id/phone_text"
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:layout_toRightOf="@id/phone_label"
        android:layout_below="@id/name_text" />

</RelativeLayout> 
```

下面是一个使用权重的 LinearLayout 示例：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:orientation="vertical">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="50dp" 
        android:orientation="horizontal"> 
        <TextView
            android:layout_width="0dp"
            android:layout_height="match_parent" 
            android:text="Name:" 
            android:layout_weight="1"/>
        <EditText
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="5"/>
    </LinearLayout>
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="50dp" 
        android:orientation="horizontal"> 
        <TextView
            android:layout_width="0dp"
            android:layout_height="match_parent" 
            android:text="Phone:" 
            android:layout_weight="1"/>
        <EditText
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="5"/>
    </LinearLayout>

</LinearLayout> 
```

请注意，LinearLayout 有 7 个视图，而 RelativeLayout 用 5 个视图完成类似的操作。LinearLayouts 很方便，但它们更复杂。随着您的布局变得越来越复杂，它们的性能将比相对布局更差，尤其是当您嵌套它们时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:31:51.257

对于每一行，使用一个水平`LinearLayout`.

在其中，添加一个水平线`LinearLayout`来“包裹” `TextView`. 给出20`LinearLayout`的 a `layout_weight`（例如）。

使用另一个水平线`LinearLayout`“包裹”`EditText`并将其设置`EditText`为`fill_parent`但将其外部`LinearLayout`a设为`layout_weight`80（或任何基于 20+80 = 100% 的值，如果你明白我的意思的话）。

**编辑：**此外，如果您需要多行，那么为了简化整体布局文件，您可以定义一个“单行”布局文件并将其用作自定义布局条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:19:50.103

//为您的edittext设置最小宽度和最大长度

```
android:minWidth="40"
android:maxLength="30"
android:layout_width="wrap_content" 
```

这样它将始终显示最小宽度，并且您的字符不会超过 30。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T21:28:07.200

您需要使用`Layout`. `LinearLayout`不是适合您的目的的布局。看看`TableLayout`，我认为这可能会满足您的要求。看看[TableLayout 教程](http://developer.android.com/resources/tutorials/views/hello-tablelayout.html)。

# typo3 - 为什么我的扩展不会呈现变音符号？

> ID：10761400
> 
> 赞同：2
> 
> 时间：2012-05-25T21:10:10.043
> 
> 标签：typo3, fluid, extbase

我正在开发一个在网站上显示下载的扩展。[您可以在 GitHub 上](https://github.com/oliversalzburg/downloads)查看完整的当前源代码。

[鉴于我的控制器](https://github.com/oliversalzburg/downloads/blob/master/Classes/Controller/DownloadController.php)中的这段代码：

```
 $linkName = Tx_Downloads_Utility_Filename::construct( $download );
  $download->setLinkText( $linkName ); 
```

这是我要设置下载标签的地方。可悲的是，稍后渲染时，如果`$linkName`包含变音符号，结果将为空白（变音符号只是我的测试对象，实际范围未知）。

出于调试目的，我将该部分扩展为如下所示：

```
 $linkName = Tx_Downloads_Utility_Filename::construct( $download );
  $download->setLinkText( $linkName );
  $this->flashMessages->add( "'" . strlen( $linkName ) . "'" );
  $this->flashMessages->add( urlencode( $linkName ) );
  $this->flashMessages->add( $linkName ); 
```

结果输出是： ![在此处输入图像描述](../Images/2b263aea893e487629c6e632fe609ec9.png) 请注意，没有呈现第三条 flash 消息。

* * *

但这并不是说不会呈现变音符号。例如，这是我正在调试的记录：

![在此处输入图像描述](../Images/609d756f5105b11b4d21d3b7575d5c9f.png)

链接字段（在图像图标和 31.06KB 之间）是空白的，但应该显示`Text_File_Sömething.jpg`. 该字符串`Sömething`在模板的另一个位置完美呈现。

我的[流体模板](https://github.com/oliversalzburg/downloads/blob/master/Resources/Private/Partials/List/Download.html)有问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T16:11:16.257

抱歉，这不是很清楚。下一次尝试：您调用`Tx_Downloads_Utility_Filename::construct($linkName)`which （默认情况下）调用which 通过用下划线`Tx_Downloads_Utility_Filename::clean($linkName)`替换任何与正则表达式模式不匹配的内容来再次删除所有特殊字符。`/([[:alnum:]_\.-]*)/`编码似乎存在问题（可能您的数据库未设置为 UTF-8 编码），因此**Text_File_Sömething**实际上变成了**Text_File_Sömething**并且 clean() 方法将其变成了无效字符串。尝试使用`utf8_encode()`第`$filename`一个。

# php - PHP - 需要删除字符串中的重复字符，但希望包含异常

> ID：10761403
> 
> 赞同：2
> 
> 时间：2012-05-25T21:10:31.593
> 
> 标签：php, string, preg-replace, duplicates

我一直在互联网上搜索解决方案，但找不到。

我需要删除字符串中的重复字符，但还想包含一个异常以允许整数数量的字符重复/保留在字符串中。

**例如，我尝试了以下操作：**

```
$str = 'This ----------is******** a bbbb 999-999-9999 ******** 8888888888 test 4444444444 ********##########Sammy!!!!!! ###### hello !!!!!!';

$t1 = preg_replace('/(.)\1{3,}/','',$str);
$t2 = preg_replace('/(\S)\1{3,}/','',$str);
$t3 = preg_replace('{(.)\1+}','$1',$str);
$t4 = preg_replace("/[;,:\s]+/",',',$str);
$t5 = preg_replace('/\W/', '', $str);
$t6 = preg_replace( "/[^a-z]/i", "", $str);

echo '$t1 = '.$t1.'<br>';
echo '$t2 = '.$t2.'<br>';
echo '$t3 = '.$t3.'<br>';
echo '$t4 = '.$t4.'<br>';
echo '$t5 = '.$t5.'<br>';
echo '$t6 = '.$t6.'<br>'; 
```

**结果：**

```
$t1 = This is a 999-999- test Sammy hello 
$t2 = This is a 999-999- test Sammy hello 
$t3 = This -is* a b 9-9-9 * 8 test 4 *#Samy! # helo !
$t4 = This,----------is********,a,bbbb,999-999-9999,********,8888888888,test,4444444444,********##########Sammy!!!!!!,######,hello,!!!!!!
$t5 = Thisisabbbb99999999998888888888test4444444444Sammyhello
$t6 = ThisisabbbbtestSammyhello 
```

**所需的输出将是：**

```
This ---is*** a bbbb 999-999-9999 *** 8888888888 test 4444444444 ***###Sammy!!! ### hello !!! 
```

如您所见，**所需**的输出只留下数字，只留下 3 个重复字符，即 --- ### *** !!!

如果可能，我希望能够将异常从 3 更改为任何其他整数。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:48:52.340

这将做到：

```
preg_replace('/(([^\d])\2\2)\2+/', '$1', $str); 
```

`[^\d]`匹配不是数字的单个字符。
`\2`指捕获的数字
`$1`指的是第一个捕获的组，它将是前三个重复字符，因此多余`\2+`的被剥离。

[**键盘**](http://codepad.viper-7.com/d3Qyd4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:56:52.413

您正在寻找的正则表达式：`/((.)\2{2})\2*/` 如果您需要异常`n`，请放入`n-1`花括号`{n-1}`：`/((.)\2{n-1})\2*/`

编辑：对于非数字或你什么，`.`用其他东西代替，例如`[^\d]`等。`/(([^\d])\2{2})\2*/`

# ajax - Ajax WCF Restful 服务调用返回空白页

> ID：10761408
> 
> 赞同：1
> 
> 时间：2012-05-25T21:11:17.893
> 
> 标签：ajax, wcf, rest, service

我正在尝试使用 jquery 通过 ajax 构造调用 wcf 休息服务，但是从 jquery 执行此操作时出现错误的请求错误。此外，我尝试直接浏览到该服务并收到一个空白页面。我过去曾进行过 WCF 服务调用，但无法弄清楚这里出了什么问题。提前感谢所有回复。直接浏览服务时，我看不到任何结果。这是进行调用的 jquery ajax 代码：

$.ajax({ type: "GET", dataType: "json", contentType: "application/json; charset=utf-8", url: "http://localhost:57452/mobile/WCFService/ContactService.svc/你好”，成功：函数（结果）{警报（'成功'）；}，错误：函数（结果）{警报（result.status +''+ result.statusText）;}

```
 }); 
```

这是服务接口：

```
[ServiceContract]
    public interface IContactService
    {
        [OperationContract]
        [WebGet(
            ResponseFormat = WebMessageFormat.Xml,
            BodyStyle = WebMessageBodyStyle.Wrapped,
            UriTemplate = "hello")]
        string SaySomething();

    } 
```

这是服务类：

```
 [AspNetCompatibilityRequirements(RequirementsMode =      AspNetCompatibilityRequirementsMode.Allowed)]
    public class ContactService : IContactService
    {
        public string SaySomething()
        {
            // Add your operation implementation here
            return "Hello!";
        }
    } 
```

以下是 web.config 文件中服务的配置：

```
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <behaviors>
      <serviceBehaviors>
        <behavior name="SomeNameSpace.mobile.WCFService.ContactServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <services>
      <service behaviorConfiguration="LeeCounty_ASP.mobile.WCFService.ContactServiceBehavior"
        name="SomeNameSpace.mobile.WCFService.ContactService">
        <endpoint address="" binding="wsHttpBinding" contract="SomeNameSpace.mobile.WCFService.IContactService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T00:31:24.913

我发现了这个问题。看来添加wcf服务时，配置文件中添加的默认绑定并没有添加webHttpBinding。从这个链接找到解决方案，[http://www.codeproject.com/Articles/132809/Calling-WCF-Services-using-jQuery](http://www.codeproject.com/Articles/132809/Calling-WCF-Services-using-jQuery)

# c++ - 如何使用 boost::gregorian 在 C++ 中解析 2 位数年份？

> ID：10761409
> 
> 赞同：0
> 
> 时间：2012-05-25T21:11:25.957
> 
> 标签：c++, parsing, date, boost, boost-date-time

Boost 中的 boost::gregorian::from_*string() 解析函数似乎只处理 4 位数年份（导致 2 位数年份的运行时错误）。

使用 boost::gregorian::from_*string() 函数处理 2 位数年份的最简洁方法是什么？

一种可能性是结合编程规则对日期字符串进行一些预处理，以添加 2000 或 1900 以清理日期格式，但如果有更好的方法，我不想重新发明轮子并添加太多代码做这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:14:33.943

Boost.DateTime 不能做到这一点——[文档](http://www.boost.org/doc/html/date_time/date_time_io.html#date_time.format_flags)说有一个`%C`格式标志可以匹配你想要的行为，但它只能用于输出，不能用于输入，即使这样也只能在有限的平台上使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T19:00:40.037

boost 中似乎不支持这种格式。幸运的是，解析日期格式是单行的。下面是一个用 AXE 编写的解析器，我相信你可以在 Spirit 中编写类似的代码。

```
using namespace boost::gregorian;
using namespace axe::shortcuts;
unsigned year, month, day;
auto date_rule = _uint >> year > '/' > _uint >> month > '/' > _uint >> day > _z;
std::string date_string("99/01/22");
if(date_rule(date_string.begin(), date_string.end()).matched)
{
   date d(year < 100 ? year + 1900 : year, month, day);
   // etc.
} 
```

# php - PHP Curl UTF-8 字符集

> ID：10761411
> 
> 赞同：30
> 
> 时间：2012-05-25T21:11:43.180
> 
> 标签：php, utf-8, character-encoding

我有一个 php 脚本，它调用另一个网页并写入页面的所有 html，一切正常，但是存在字符集问题。我的 php 文件编码是 utf-8 并且所有其他 php 文件都可以正常工作（这意味着服务器没有问题）。该代码中缺少什么，所有西班牙字母看起来都很奇怪。PS。当我把这些奇怪的字符原始版本写进php时，它们看起来都很准确。

```
header("Content-Type: text/html; charset=utf-8");
function file_get_contents_curl($url)
{
    $ch=curl_init();
    curl_setopt($ch,CURLOPT_HEADER,0);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch,CURLOPT_URL,$url);
    curl_setopt($ch,CURLOPT_FOLLOWLOCATION,1);
    $data=curl_exec($ch);
    curl_close($ch);
    return $data;
}
$html=file_get_contents_curl($_GET["u"]);
$doc=new DOMDocument();
@$doc->loadHTML($html); 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-22T15:44:25.793

简单：当您使用 curl 时，它会将字符串编码为`utf-8`您只需要解码它们..

```
Description

string utf8_decode ( string $data ) 
```

此函数将假定已`UTF-8`编码的数据解码为`ISO-8859-1`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-09-04T06:48:45.247

您可以使用此标题

```
 header('Content-type: text/html; charset=UTF-8'); 
```

并在解码字符串后

```
 $page = utf8_decode(curl_exec($ch)); 
```

它对我有用

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-07-30T12:41:50.690

```
$output = curl_exec($ch);
$result = iconv("Windows-1251", "UTF-8", $output); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-21T11:56:06.970

```
function page_title($val){
    include(dirname(__FILE__).'/simple_html_dom.php');
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$val);
    curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:25.0) Gecko/20100101 Firefox/25.0');
    curl_setopt($ch, CURLOPT_ENCODING , "gzip");
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    $return = curl_exec($ch); 
    $encot = false;
    $charset = curl_getinfo($ch, CURLINFO_CONTENT_TYPE);

    curl_close($ch); 
    $html = str_get_html('"'.$return.'"');

    if(strpos($charset,'charset=') !== false) {
        $c = str_replace("text/html; charset=","",$charset);
        $encot = true;
    }
    else {
        $lookat=$html->find('meta[http-equiv=Content-Type]',0);
        $chrst = $lookat->content;
        preg_match('/charset=(.+)/', $chrst, $found);
        $p = trim($found[1]);
        if(!empty($p) && $p != "")
        {
            $c = $p;
            $encot = true;
        }
    }
    $title = $html->find('title')[0]->innertext;
    if($encot == true && $c != 'utf-8' && $c != 'UTF-8') $title = mb_convert_encoding($title,'UTF-8',$c);

    return $title;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-05-20T16:26:07.073

我正在通过 cURL 和`mb_detect_encoding(curl_exec($ch));`返回的 UTF-8 获取 windows-1252 编码文件。试过`utf8_encode(curl_exec($ch));`了，字符是正确的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-06-30T21:24:23.030

### 第一种方法（内部函数）

我之前尝试过的最好方法是使用[`urlencode()`](http://php.net/urlencode). 请记住，不要将它用于整个 url；相反，仅将其用于所需的部分。例如，一个请求有两个“text-fa”和“text-en”字段，它们分别包含一个波斯语和一个英语文本，您可能只需要对波斯语文本进行编码，而不是对英语文本进行编码。

### 第二种方法（使用 cURL 函数）

但是，如果必须编码的字符范围更有限，还有更好的方法。其中一种方法是使用`CURLOPT_ENCODING`, 将其传递给[`curl_setopt()`](http://php.net/curl-setopt)：

```
curl_setopt($ch, CURLOPT_ENCODING, ""); 
```

# extjs - Extjs4 Accordion - 面板之间的内联链接

> ID：10761412
> 
> 赞同：0
> 
> 时间：2012-05-25T21:11:43.810
> 
> 标签：extjs, accordion

我有一个基本的 ExtJS 4.0 手风琴。我想在一个面板的文本中有一个内联链接，它将关闭该面板并打开另一个面板。

在下面的示例中，面板 1 中的链接应该会打开面板 2。什么样的点击功能会在这里起作用？

```
Ext.create('Ext.panel.Panel', {
title: 'Accordion Layout',
layout:'accordion',
layoutConfig: {
    // layout-specific configs go here
    titleCollapse: false,
    animate: true,
    activeOnTop: true
},
height: 300,
width: 400,
items: [{
    title: 'Panel 1',
    id: 'p1',
    html: 'Text goes here. <p><a id="linkP2" href="#">Go to panel 2</a></p>'
},{
    title: 'Panel 2',
    id: 'p2',
    html: 'Panel content!'
},{
    title: 'Panel 3',
    id: 'p3',
    html: 'Panel content!'
}],
renderTo: Ext.getBody()
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T15:46:11.007

这是我最近为更改选项卡键导航处理程序的扩展面板所做的。我的手风琴面板包含在一个选项卡面板中，因此第一个变量获取活动选项卡，您可以更改它，但是您希望根据您的需要获取手风琴面板本身，例如：

```
var tab = Ext.ComponentQuery.select(panel[layout=accordion]); 
```

如果这是您的应用程序中唯一的手风琴面板，您可以获得对手风琴的参考。

```
// direction arg is either 1 or -1 depending on whether we want to go
// forward or backward
shiftPanels: function(direction) {
    var tab = this.getMainPanel().getActiveTab(), // gets the active tab panel
        panels = tab.items, // gets all of the accordion panels
        active = tab.child('[collapsed=false]'), // gets the expanded panel
        shifted;

    // get the panel at direction + index (the panel we want to expand)
    panels.each(function(panel, idx) {
        if (active == panel) {
            shifted = panels.getAt(direction + idx);
            return false;
        }
    });

    // expand the shifted panel or wrap around to the beginning or end
    if (shifted) {
        shifted.expand();
    } else if (direction > 0) {
        shifted = panels.getAt(0);
        shifted.expand();
    } else {
        shifted = panels.getAt(panels.length - 1);
        shifted.expand();
    }
}, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T20:16:47.203

我最终找到了一个相当简单的解决方案：

```
<a id="linkP2" href="javascript:onClick=Ext.getCmp(\'p2\').expand();">Go to panel 2</a> 
```

Ext.getCmp.expand 允许在手风琴内选择某个 ID。

# python - `cat` 如何在 ipython 交互式 shell 中工作？

> ID：10761413
> 
> 赞同：5
> 
> 时间：2012-05-25T21:11:51.593
> 
> 标签：python, shell, ipython, interactive

我注意到`cat`在 ipython 中使用文件可以工作。它似乎没有被列为魔术命令......所以我很困惑它是如何/为什么工作的。什么可以`cat`在 ipython 交互式 shell 中工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:22:14.863

IPython 自动定义了一些 shell 别名`cat`，[包括`IPython.core.alias.default_aliases()`](https://github.com/ipython/ipython/blob/master/IPython/core/alias.py#L43).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T21:24:56.187

`cat`是预定义的系统命令别名之一。键入`%alias`以查看当前 ipython 会话中的别名列表。

# php - mysql数据库中服务器时间和时间戳之间的秒差

> ID：10761423
> 
> 赞同：0
> 
> 时间：2012-05-25T21:12:43.480
> 
> 标签：php, mysql

我试图在我的数据库中的 php 页面上显示当前服务器时间和 DATETIME（定义为 2012-01-01 00:00:01）条目之间的差异（以秒为单位）。我只想显示最新条目的差异。

我已经能够得到一些结果，但我知道结果不正确。如果有人能够提供帮助，那就太好了。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:15:10.527

```
select TIMESTAMPDIFF(second, '2012-01-01 00:00:01', current_timestamp) as date_diff 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:25:42.847

它很简单：-

```
echo time() - strtotime('2012-01-01 00:00:01'); 
```

[时间（）](http://www.php.net/time) [strtotime（）](http://www.php.net/strtotime)

# php - 在循环中定义新数组的索引？

> ID：10761424
> 
> 赞同：0
> 
> 时间：2012-05-25T21:12:43.530
> 
> 标签：php, arrays

我有以下代码：

```
$chart_data = array();
foreach ($range as $range_day) {
  foreach ($numbers as $number) {
    if($range_day == $number['date']){
      @$chart_data[$range_day] += $number['events'];
    } else {
      if(isset($chart_data[$range_day])){
        $chart_data[$range_day] += 0;
      }
    }
  }
} 
```

这一行：`$chart_data[$range_day] += 0;`给了我一个未定义的索引错误，所以我添加了`isset`检查，但它没有设置，所以它破坏了我的数组。我知道它没有设置，我不在乎，但我通篇读到`@`解决方案的味道很差。如何以正确的方式消除错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:15:35.130

您是否看过`array_key_exists`函数： http: [//php.net/manual/en/function.array-key-exists.php](http://php.net/manual/en/function.array-key-exists.php)？

就像是：

```
$chart_data = array();
foreach ($range as $range_day) {
  foreach ($numbers as $number) {
    if(!array_key_exists($range_day, $array)) {
      $chart_data[$range_day] = 0;
    }
    if($range_day == $number['date']){
      $chart_data[$range_day] += $number['events'];
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:15:53.907

您可以在开始时将其设置为零：

```
$chart_data = array();
foreach ($range as $range_day) {
  $chart_data[$range_day] = 0;
  foreach ($numbers as $number) {
    if($range_day == $number['date']){
      $chart_data[$range_day] += $number['events'];
    } else {
      if(isset($chart_data[$range_day])){
        $chart_data[$range_day] += 0;
      }
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T21:17:19.917

您可以检查它是否**未**设置，然后设置它：

```
foreach ($numbers as $number) {
    if (!isset($chart_data[$range_day])) {
        $chart_data[$range_day] = 0;
    }
    if ($range_day == $number['date']) {
        $chart_data[$range_day] += $number['events'];
    } else {
        $chart_data[$range_day] += 0; // you're just adding 0 so why have this line at all?
    }
} 
```

此答案假定有`$range`可能包含重复项`$range_day`，因此它不会覆盖`$chart_data`.

# c - 如何初始化一个数组？

> ID：10761428
> 
> 赞同：4
> 
> 时间：2012-05-25T21:12:53.293
> 
> 标签：c

我有一个 3 维数组，如何在没有 3 个循环的情况下将其初始化为默认值。

```
dummy[4][4][1024] 
```

，如何将所有元素初始化为 12？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T21:13:52.120

由于 3-d 数组是一个连续的内存块，因此您可以将其视为 1-d 数组

```
int i, *dummy2 = &dummy[0][0][0];
for(i = 0; i < 4*4*1024; ++i)
    dummy2[i] = 12; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T21:29:15.653

来吧伙计们-让我们以始终有效的简单方式来做：

```
 for(int i = 0; i < 4; i++)
{
  for(int j = 0; j < 4; j++)
  {
    for(int k = 0; k < 1024; k++)
    {
      dummy[i][j][k] = 12;
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-25T21:36:48.960

默认初始化为全零就是：

```
unsigned dummy[4][4][1024] = { 0 }; 
```

如果要初始化特定元素（以及所有其他元素为零），请执行此操作

```
unsigned dummy[4][4][1024] = { { { 5 }, { 0, 4 } } }; 
```

如果您的编译器知道 C99，请使用指定的初始化程序

```
unsigned dummy[4][4][1024] = { [3] = { [2] = { [0] = 7 }, [1] = { [2] = 3, [1] = 4 } } }; 
```

如果你真的坚持使用 all `12`，只需重复`12`16384 次 :)

# python - 如何修改 2d 散点图以显示基于 csv 文件中第三个数组的颜色？

> ID：10761429
> 
> 赞同：9
> 
> 时间：2012-05-25T21:13:06.590
> 
> 标签：python, csv, numpy, matplotlib, scatter-plot

我正在使用 Python 和 CSV 文件。我目前正在尝试修改下面的散点图（2d），以根据我的 csv 文件中的第三列更改颜色。在搜索了多个帖子后，我基本上想使用通用颜色图（彩虹）并将我的第三个数组乘以颜色图，以便为每个 xy 点显示不同的颜色。我想我可以从`ax.scatter`函数中做所有事情，但我不确定如何将每个不同的 x,y 坐标乘以颜色图和第三个数组编号。它应该看起来类似于等高线图，但我更喜欢不同颜色的散点图。

这是我正在使用的代码：

```
import matplotlib   
from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas    
from matplotlib.figure import Figure
import matplotlib.mlab as mlab
import numpy as np

r = mlab.csv2rec('test.csv')
fig = Figure(figsize=(6,6))
canvas = FigureCanvas(fig)

ax = fig.add_subplot(111)
ax.set_title("X vs Y AVG",fontsize=14)
ax.set_xlabel("XAVG",fontsize=12)
ax.set_ylabel("YAVG",fontsize=12)
ax.grid(True,linestyle='-',color='0.75')

x = r.xavg #first column
y = r.yavg #second column
z = r.wtr #third column

ax.scatter(x,y,s=.2,c='b', marker = ',', cmap = ?); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-25T21:25:21.333

检查散点线

```
import matplotlib.pyplot as plt
from matplotlib  import cm
import numpy as np

fig = plt.figure(figsize=(6,6))
ax = fig.add_subplot(111)
ax.set_title("X vs Y AVG",fontsize=14)
ax.set_xlabel("XAVG",fontsize=12)
ax.set_ylabel("YAVG",fontsize=12)
ax.grid(True,linestyle='-',color='0.75')
x = np.random.random(30)
y = np.random.random(30)
z = np.random.random(30)

# scatter with colormap mapping to z value
ax.scatter(x,y,s=20,c=z, marker = 'o', cmap = cm.jet );

plt.show() 
```

它产生

![在此处输入图像描述](../Images/8350d6240fe0e0f8fffb75fec3812b4d.png)

# tsql - 使用游标在 T-sql 中检查一年中每个月的值

> ID：10761431
> 
> 赞同：0
> 
> 时间：2012-05-25T21:13:20.967
> 
> 标签：tsql

我需要一个用于仪表系统的光标示例，系统每个月都会读取仪表。

光标需要检查，每个仪表在当年都有一个读数。对于读数缺失的电表，增加一个估计值，使得每日消耗量为上一期的每日消耗量加 15%。在没有前一期间，使用上述 Kwh 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:25:03.410

这样的事情怎么样。（MonthSeed 表可以成为数据库中的真实表）

```
declare @MonthSeed table (MonthNumber int) 
insert into @MonthSeed values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12)

-- assumes declared table "Reading" with fields ( Id int, [Date] datetime, MeterNo varchar(50), Consumption int )

select
    m.MeterNo,
    r.Date,
    calculatedConsumption = isnull(r.Consumption, -- read consumption
                                isnull((select max(r2.Consumption) Consumption from Reading r2 where datepart(month, r2.Date) = (m.MonthNumber - 1) and r2.MeterNo = m.MeterNo) * 1.15, -- previous consumption + 15%
                                    9999)) -- default consumption
from
    (select distinct
        MeterNo,
        MonthNumber
    from
        Reading, @MonthSeed) m
left join
    Reading r on r.MeterNo = m.MeterNo and datepart(month, r.Date) = m.monthNumber 
```

编辑以下评论 - 添加缺失读数的示例

正如所评论的，需要在选择之前包含一个插入，`insert into Reading (MeterNo, Date, Consumption)`并使用`reading`表的左连接包括检查读取 id 是否为 null 即缺失`where r.Id is null`。

我注意到这会在插入表时导致空日期条目`reading`。所以我在主子选择中包含了一个日期聚合`Date = dateadd(month, monthnumber, @seeddate)`；修改了主选择以显示丢失条目的日期`isnull(r.Date, m.Date),`

一年前我已经计算出`@SeedDate`当月的 1 日，但您可能希望更早地传递。

```
declare @MonthSeed table (MonthNumber int) 
insert into @MonthSeed values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12)

-- assumes declared table "Reading" with fields ( Id int, [Date] datetime, MeterNo varchar(50), Consumption int )

declare @SeedDate datetime = (select dateadd(month, datediff(month, 0, getdate())-12, 0)) -- this month, last year

insert into Reading (MeterNo, Date, Consumption)
select
    m.MeterNo,
    isnull(r.Date, m.Date),
    calculatedConsumption =
        isnull(r.Consumption, -- read consumption
        isnull(1.15 * (select max(r2.Consumption) Consumption 
                from Reading r2 
                where datepart(month, r2.Date) = (m.MonthNumber - 1) 
                and r2.MeterNo = m.MeterNo), -- previous consumption + 15%
        9999)) -- default consumption
from
    (select distinct
        MeterNo,
        MonthNumber,
        Date = dateadd(month, monthnumber, @seeddate)
    from
        Reading
    cross join
        @MonthSeed) m
left join
    Reading r on r.MeterNo = m.MeterNo and datepart(month, r.Date) = m.monthNumber
where
    r.Id is null

select * from Reading 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T04:23:08.763

*（以下假设 SQL Server 2005 或更高版本。）*

在这里四处搜寻，看看是否有任何有价值的东西：

```
declare @StartDate as Date = '2012-01-01'
declare @Now as Date = GetDate()
declare @DefaultConsumption as Int = 2000 -- KWh.

declare @MeterReadings as Table
  ( MeterReadingId Int Identity, ReadingDate Date, MeterNumber VarChar(10), Consumption Int )
insert into @MeterReadings ( ReadingDate, MeterNumber, Consumption ) values
  ( '2012-01-13', 'E154', 2710 ),
  ( '2012-01-19', 'BR549', 650 ),
  ( '2012-02-15', 'E154', 2970 ),
  ( '2012-02-19', 'BR549', 618 ),
  ( '2012-03-16', 'BR549', 758 ),
  ( '2012-04-11', 'E154', 2633 ),
  ( '2012-04-20', 'BR549', 691 )

; with Months ( Month ) as (
  select @StartDate as [Month]
  union all
  select DateAdd( mm, 1, Month )
    from Months
    where Month < @Now
  ),
MeterNumbers ( MeterNumber ) as (
  select distinct MeterNumber
    from @MeterReadings )
select M.Month, MN.MeterNumber,
  MR.MeterReadingId, MR.ReadingDate, MR.Consumption,
  Coalesce( MR.Consumption, @DefaultConsumption ) as [BillableConsumption],
  ( select Max( ReadingDate ) from @MeterReadings where MeterNumber = MN.MeterNumber and ReadingDate < M.Month ) as [PriorReadingDate],
  ( select Consumption from @MeterReadings where MeterNumber = MN.MeterNumber and ReadingDate =
  ( select Max( ReadingDate ) from @MeterReadings where MeterNumber = MN.MeterNumber and ReadingDate < M.Month ) ) as [PriorConsumption],
  ( select Consumption from @MeterReadings where MeterNumber = MN.MeterNumber and ReadingDate =
  ( select Max( ReadingDate ) from @MeterReadings where MeterNumber = MN.MeterNumber and ReadingDate < M.Month ) ) * 1.15 as [PriorConsumptionPlus15Percent]  
  from Months as M cross join
    MeterNumbers as MN left outer join
    @MeterReadings as MR on MR.MeterNumber = MN.MeterNumber and DateAdd( dd, 1 - DatePart( dd, MR.ReadingDate ), MR.ReadingDate ) = M.Month
  order by M.Month, MN.MeterNumber 
```

# ios - 如何使用 cocoapods 链接我的 svn 库？

> ID：10761433
> 
> 赞同：2
> 
> 时间：2012-05-25T21:13:39.530
> 
> 标签：ios, objective-c, dependencies, cocoapods

我是管理 Objective-C 项目中的库依赖项的新手。

我需要知道*如何*在我的 svn 中链接一个库。

链接：svn：`//ibrahim@svn.xxxx.info/development/iOS/myFoundation/here_Are_the_.{h/m}'`

我只知道如何在 Github 上指定项目的依赖关系。

来自终端的前：

1-open -e Podfile

2-依赖 'ASIHTTPRequest'

3-pod 安装 myproj.xcodeproj/

svn 的任何想法都会很棒。

# php - WordPress 推荐人跟踪

> ID：10761436
> 
> 赞同：0
> 
> 时间：2012-05-25T21:14:12.460
> 
> 标签：php, asp.net, wordpress

我有一个托管在我的网站 (http://www.mysite.com/blog) 中的 WordPress 博客，我的网站本身基于 ASP.NET。

我在会话开始时跟踪 ASP.NET 中的引用者并将它们存储在会话变量中，以便在会话过期或访问者转换为成员之后保存到我的数据库中。

如何跟踪首先访问博客并单击网站内页面链接的访问者的推荐人？在 WordPress 中有没有一种方法可以使用查询字符串传递引荐来源网址？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:41:01.327

当他们登陆博客时，在原始推荐人处放置一个 cookie。

然后从应用程序中阅读此内容。

掀起一个插件来做这样的事情：

```
if( !isset($_COOKIE['ref']) ) {
    setcookie(...);
} 
```

如果你觉得自己像个黑客，你可以把它添加到 WP 的 index.php 中，但插件会是更便携、更干净的选择。

# core-data - 创建核心数据谓词以在一对多关系中获取数据

> ID：10761437
> 
> 赞同：0
> 
> 时间：2012-05-25T21:14:14.390
> 
> 标签：core-data, nspredicate, one-to-many

我有一个`Loans`实体，其`returnedDate`属性可以包含日期或为 NIL。与另一个实体存在一对多关系，`Items`因此项目可以与 many 相关联`Loans`。我想创建一个谓词，我可以在其中找到所有当前没有`loans.returnedDate==NIL`.

假设我目前有以下内容：

```
Loan1-item1,returnedDate=NIL
Loan2-item1,returnedDate=5/4/2012
Loan3-item2,returnedDate=NIL. 
```

我想要一个不返回任何项目的谓词。

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"!(ANY loaned.returnDate==nil)"]; 
```

返回项目 1。

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"(NONE loaned.returnDate==nil)"]; 
```

返回项目 1。

```
NSPredicate *pred = [NSPredicate predicateWithFormat:@"(ANY loaned.returnDate!=nil)"]; 
```

返回项目 1。

有人能告诉我什么逻辑会返回适当的结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T23:19:48.290

所以我使用了以下谓词：

```
(SUBQUERY(loaned, $sub, $sub.returnDate==nil).@count == 0) 
```

它正在返回所需的结果。如果你能说服我不要使用 SUBQUERY，请告诉我怎么做。

# c# - Dictionary.ContainsKey StringComparer.Ordinal

> ID：10761438
> 
> 赞同：0
> 
> 时间：2012-05-25T21:14:20.990
> 
> 标签：c#, dictionary, containskey

我正在使用带有 .NET 3.5 的 C# 中的字典。我创建了一个对象并传入了相等比较器。但是，当我执行以下代码时，我没有得到预期的结果：`Dictionary`<string, int`>``StringComparer.Ordinal`

```
Dictionary<string, int> theDictionary = new Dictionary<string, int>(StringComparer.Ordinal);
theDictionary.Add("First", 1);
bool exists = theDictionary.ContainsKey("FIRST");    // equals true, when it should not 
```

我在这里没有看到什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T21:16:47.750

你确定你没有使用[StringComparer.OrdinalIgnoreCase](http://msdn.microsoft.com/en-us/library/system.stringcomparer.ordinalignorecase.aspx)吗？

此代码使用 C# v3.5 编译器为我打印错误：

```
using System;
using System.Collections.Generic;

    static class Program
    {
      static void Main()
      {
        Dictionary<string, int> theDictionary = new Dictionary<string, int>(StringComparer.Ordinal);
        theDictionary.Add("First", 1);
        bool exists = theDictionary.ContainsKey("FIRST");

        Console.WriteLine(exists);
      }
    } 
```

# service - 4 层（用于 N 层）架构的示例？

> ID：10761440
> 
> 赞同：17
> 
> 时间：2012-05-25T21:14:30.350
> 
> 标签：service, architecture, n-tier-architecture

最近我的一个朋友问我有关 N 层架构的问题，我能够通过示例向他解释 1、2 和 3 层架构。但是当我想给出超过 3 层的示例时，我被卡住了。我用谷歌搜索并寻求帮助，但找不到任何像样的例子。

它被命名为 N 层的事实让我认为“N”可以是从 1 开始的任何数字。但我找不到 4 层或 5 层的任何示例。

有人可以分享一些涉及超过 3 层的 N 层架构的例子吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-31T12:09:26.393

1.  基础服务：例如数据库、目录服务、文件和打印服务、硬件抽象。这一层越来越多地被称为平台。
2.  业务域层：一个应用服务器，如 JavaEE，包括 EJB、DCOM 或 CORBA 服务对象。提供业务功能，增加使用 SOA 和微服务。
3.  表示层：例如 Java Servlets/JSP、ASP、PHP。该层将越来越多地将 WebServices 包括为业务层服务的代理和适配器。
4.  客户端层：瘦客户端（如浏览器上的 HTML 页面）和富客户端（如 Java WebStart 和 Flash）。

*   在 Java EE 中，通常将业务域层分为数据访问（实体 Bean）和业务服务（会话 Bean）。
*   在企业 SOA（[面向服务的架构](https://en.wikipedia.org/wiki/Service-oriented_architecture)）中，ESB（[企业服务总线](https://en.wikipedia.org/wiki/Enterprise_service_bus)）通常作为第 1 层和第 2 层之间的附加层存在。它可能是平台供应的一部分。
*   在 Mashups 中，您可以在第 3 层和第 4 层之间有一个聚合层。

被称为 N 层的转变反映了向越来越多的组件化架构的转变，从旧的客户端-服务器到第一个 3 层，然后是 4 层。层的定义特征是具有分离关注点的明确定义的接口。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-04-01T20:39:16.977

[![我对四层的理解](../Images/a42d73f54e02d86fa168be8d631f5afa.png)](https://i.stack.imgur.com/2g9ix.png)

五分钟前我读过这篇文章 [https://www.nginx.com/blog/time-to-move-to-a-four-tier-application-architecture](https://www.nginx.com/blog/time-to-move-to-a-four-tier-application-architecture/)

客户端是您阅读它的地方 Api 或您的应用程序后端是您组装它的地方.. 数据聚合.. 要么通过来自外包事物的 jsons/xmls 要么对您的数据库进行查询，最后服务层是您实际执行查询的地方在数据库上或在大数据上运行功能或从谷歌读取 GPS 位置和地图......这就是我在这种情况下的看法。它只是将数据层从三层中划分出来。

但是这个 N 层模型是完全抽象的，所以你可以撕裂你的基础设施，直到你只有一些逻辑上的原子部分。仍然划分之前的结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-05T15:08:20.843

我倾向于用不那么抽象和更实际的解释来回答这个问题：“我要如何以及为什么要将我的系统分成多个层，我应该将它们放在服务器上的什么位置？”

本质上，当您创建一个使用数据库的简单网站时，您已经拥有“开箱即用”的 3 层：

*   数据层 - 数据库。但是，如果您使用的是短期内存缓存或文件系统，那么我们可能会争论是否可以将其视为“层”。

*   应用层 - 在您的服务器上执行的代码。

*   表示（或客户端）层 - 在客户端机器上执行并将结果呈现给客户端的代码

现在，我们如何获得第四层？

最有可能的是，不需要拆分客户端层。它在客户的设备上，我们希望它尽可能简单和高效。

我们可以拆分数据层吗？我已经看到一些系统使用围绕数据库、Azure Blob、文件系统等的 API 来创建一些可以被视为层的子系统。但这仍然是相同的数据层（也称为基础服务层）还是我们可以将其视为一个单独的实体？如果我们把它分开，它会和我们的数据库在同一个物理（或虚拟）服务器上，这样我们就可以保护数据不被直接访问吗？

但是，在大多数情况下，应用层会被拆分。

一部分仍然命名为应用层。它成为一个内部 API Web 应用程序，并位于可以访问数据库的安全区域中。没有人可以直接访问数据库，只能通过这个应用层。

另一部分通过某种连接（HTTP 客户端等）成为应用层 API 的消费者。消费者可能被称为表示层（令人困惑 - 它与客户端层不一样吗？），即使它本身只有 JSON API 并且没有任何用户友好的格式。

但随之而来的问题是：在哪些情况下，作为开发人员，我们可能希望将我们的生活复杂化并将我们的 Web 应用程序拆分为表示层和应用程序层，而不是将它们作为层保持在同一个 Web 应用程序中？

在严重的工作负载中，单独的应用程序层可能有利于可扩展性，或者可能需要安全性来拒绝数据库连接到暴露给用户的 Web 服务器（甚至是 Intranet 的服务器）。

我看到一些雄心勃勃的项目从一开始就追求 4 层，然后诅咒自己过度设计的东西。您必须跟踪这些内部连接、安全性、身份验证令牌，控制套接字（不是在每个请求上打开新的 HTTP 连接），避免通过不小心创建的全局 HTTP 客户端实例意外共享多个并行请求的数据等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-11T09:41:52.830

[![云应用架构](../Images/c9c465ead099922d5c0fe01719300425.png)](https://i.stack.imgur.com/o8SO1.png) 这将取决于您要称为等级的内容。表示层的每个垂直都可以称为一个层。

*   移动应用或网页前端（一页 Javascript 等）

*   缓存或 CDN（内容交付网络）作为另一层。

*   前端或 API 层

如果服务需要多个微服务，也可以拆分业务层。例如

*   业务流程层
*   一个管理层。

然后数据层拆分为：

*   数据库

*   数据湖

*   报告

*   企业服务总线

*   第三方访问数据（您的应用连接到其他 API 的地方）

有关更多信息，请参阅[云应用程序架构](https://neilmillard.com/2021/04/11/cloud-application-architecture.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-25T07:14:15.000

四层架构包括以下内容

一种。客户端层——node.js angularJs 等基本上独立于服务器端，UI 团队独立处理客户端工件

湾。聚合层 --- 内容交付网络 (akamai)

C。api tier——所有服务器端调用的网关，可以有自己的缓存

d。服务层——包括内部或外部服务……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-22T08:07:05.047

4 层架构的一个简单示例是 RMI JDBC Servlet。这涉及到客户端层 servlet 的应用服务器 Rmi 服务器程序的服务器 Jdbc 数据库的服务器

# javascript - 关闭 for 循环的编译器警告

> ID：10761441
> 
> 赞同：0
> 
> 时间：2012-05-25T21:14:32.010
> 
> 标签：javascript, google-closure-compiler

我正在使用一个有点非传统的 for 循环，它适用于我正在做的事情，如下所述（不费心显示变量声明）：

```
if (arr && arr.length > 0) {
    for (i = arr.length; i--; i) {
        element = arr.pop();
        //rest of code
    }
} 
```

闭包编译器给我一个警告：“警告 - 可疑代码。这段代码没有副作用，有错误吗？” 专门指向 for 循环括号中的最后一个“i”。

如果我删除 i，jslint 会引发警告，如果我离开它，则关闭会引发警告。总共有三个这样的循环，是否有“关闭友好”的方式来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:16:31.667

正常方式怎么样？

```
if (arr && arr.length > 0) {
    for (i = arr.length; i > 0; --i) {
        element = arr.pop();
        //rest of code
    }
} 
```

将减量放入测试中并不是编写`for`循环的正常方法。

或者更正常：

```
if (arr && arr.length > 0) {
    for (i = arr.length - 1; i >= 0; --i) {
        element = arr.pop();
        //rest of code
    }
} 
```

...但是由于您不使用`i`，所以这并不重要。

或者你可以使用`while`：

```
if (arr && arr.length > 0) {
    i = arr.length;
    while (i--) {
        element = arr.pop();
        //rest of code
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-29T01:39:51.363

对于未来的读者，如果您要减少数组的长度，请不要使用`for`循环，请使用`while`：

```
if (arr) {
    while (arr.length) {
        element = arr.pop();
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:17:29.123

是的——这样的事情应该可以解决问题：

```
for (i = arr.length; i > 0; i--) { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T21:11:58.377

使用 jshint 而不是 jslint 并关闭警告。

# html - Doctype 与 CSS 字体样式混淆？

> ID：10761453
> 
> 赞同：1
> 
> 时间：2012-05-25T21:15:17.150
> 
> 标签：html, css, browser, cross-browser, compatibility

我猜我需要一个 doctype，因为以下字体样式仅在 Safari 和 Chrome 中显示我想要的样式。所以每次我添加 HTML5 文档类型时，我的自定义字体都会消失。我是一名业余编码员，所以请裸露代码，我自学。

```
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8"/>
    <style type="text/css">
    #yolk {
        background-image: url(Yolk.png);
        background-repeat: no-repeat;
        background-position: center top;
        padding-top:250px;
    }
    body {
        background-color:#000000;
    }
    #lol {
        background-image: url(lol.png);
        background-repeat: no-repeat;
        background-position: center top;
        padding-top: 100px;
        padding-bottom: 100px;
    }

    @font-face {
        font-family: my_font;
        src: url('http://myurl.com/lolfont.eot');
        src: url('lolfont.eot'), url('lolfont.ttf') format('opentype');
    }
    p {
        font-family: my_font; 
        color: de0000;
        text-align: left;
        font-size: 50px;
        line-height: 10%;
        text-indent: 350px;

    }
    </style>
    <title>yolk</title>
</head>
<body>
    <div id="yolk"></div>
    <center>
    <embed allowScriptAccess="never" src="http://swing.awardspace.com/newcoun… width=320  height=110 wmode=transparent menu=false></embed>
    </center>
    <p>test</p>
    <a href="http://www.google.com" title="lol"><div id="lol"></div></a>
    </font>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-10T21:38:33.217

始终首先[验证您的 HTML](http://validator.w3.org/)。尝试使用无效标记做任何事情时，您只会浪费您和其他人的时间。然后，您可以[验证您的 CSS](http://jigsaw.w3.org/css-validator/)。

我发现的错误：

*   `<!DOCTYPE HTML>`应该[`<!DOCTYPE html>`](http://en.wikipedia.org/wiki/Document_type_declaration#HTML5_DTD-less_DOCTYPE)像您使用[XML 序列化](http://www.w3.org/TR/html5/the-xhtml-syntax.html)一样，这是区分大小写的。紧随其后`<!DOCTYPE`的是文档根元素的名称。另请参阅[大写或小写文档类型？](https://stackoverflow.com/q/7020961/2157640)就这样。
*   `color: de0000;`应该是`color: #de0000;`。
*   该`body`元素必须关闭。放在`</body>`前面`</html>`。
*   删除`</font>`标签 - 不存在开始标签。该[`font`元素也已过时](http://www.w3.org/wiki/HTML/Elements/font)。
*   用有替换[`center`元素](http://www.w3.org/wiki/HTML/Elements/center)。它已经过时了。`div``style="text-align: center"`
*   修复`<embed allowScriptAccess="never" src="http://swing.awardspace.com/newcoun… width=320 height=110 wmode=transparent menu=false></embed>`. HTML5 的 XML 序列化中的所有属性都必须在其值周围加上引号。属性的内容`src`明显被截断，缺少最后的引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T20:12:59.587

你的 CSS 代码有问题，它可能是你没有开始的颜色`#`。我遇到了类似的问题，因为我写`font-size: 12;`的是`font-size: 12px;`.

顺便说一句，我认为这

```
url('lolfont.ttf') format('opentype'); 
```

应该是

```
url('lolfont.ttf') format('truetype'); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-25T22:13:21.030

首先检查您的字体是否有正确的 url，例如，您包含的这个 URL 不正确，它没有引用任何字体。

```
src: url('http://myurl.com/lolfont.eot'); //??? 
```

如 w3School 所示：

> Firefox、Chrome、Safari 和 Opera 支持 .ttf（True Type 字体）和 .otf（OpenType 字体）类型的字体。Internet Explorer 9+ 支持新的@font-face 规则，但它只支持 .eot 类型的字体（ Embedded OpenType)。注意：Internet Explorer 8 及更早版本，不支持新的@font-face 规则。

所以 safari 或 chrome 应该没有任何问题......

根据[w3School](http://www.w3schools.com/css3/css3_fonts.asp) ，@font-face 的正确格式是：

```
<style type="text/css"> 
@font-face
{
  font-family: myFirstFont;
  src: url('Sansation_Light.ttf'),
  url('Sansation_Light.eot'); /* IE9+ */
}

div
{
   font-family:myFirstFont;
}
</style> 
```

为了查看您的问题在哪里，一个更好的主意是从一个简单的代码开始，（类似于[w3School 示例](http://www.w3schools.com/css3/tryit.asp?filename=trycss3_font-face_rule)）然后将其与您的代码集成......

顺便说一句，如果您检查示例中的 DOCTYPE 如下：`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">` 但是，当您将其更改为它时，`<!DOCTYPE HTML>`它仍然有效...

# c# - C# 文件可以包含文件级摘要注释吗？

> ID：10761455
> 
> 赞同：4
> 
> 时间：2012-05-25T21:15:35.520
> 
> 标签：c#

例如

Foo.cs：

```
using System;

/// <summary>
/// This file contains Foo and Bar-related things.
/// </summary>

namespace Xyz {

class FooThing {
}

} 
```

C# 是否支持这样的 XMLDoc 注释？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T21:21:47.750

不可以，XML 文档注释只能出现在特定类型的元素上，如[本文所述](http://msdn.microsoft.com/en-us/library/3260k4x7)：

> 在源代码文件中，可以处理以下前面的文档注释并将其添加到 XML 文件中：
> 
> 诸如类、委托或接口之类的用户定义类型
> 
> 字段、事件、属性或方法等成员

如果您在文件中放置文件级 XMLDoc 样式的注释，它将被附加到下一个类或碰巧出现的其他元素。某些文档工具（如 Sandcastle）提供了一种添加名称空间级别 XMLDoc 注释的方法，但它们通常出现在单独的文件中。

当然，您可以在每个文件中使用*非*XMLDoc 样式的注释，例如版权标题或类似内容，只需使用标准的 /* */ 样式注释块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T21:20:20.533

根据[/doc 文档](http://msdn.microsoft.com/en-us/library/3260k4x7.aspx)，不，不支持。

> 在源代码文件中，可以处理以下前面的文档注释并将其添加到 XML 文件中：
> 
> *   诸如类、委托或接口之类的用户定义类型
>     
>     
> *   字段、事件、属性或方法等成员

# javascript - 这个伪 jquery function(r) 脚本有什么作用？

> ID：10761464
> 
> 赞同：2
> 
> 时间：2012-05-25T21:16:30.183
> 
> 标签：javascript, jquery

我们在网站的 HEAD 中有这个，我们不确定它的作用。这可能是咨询公司遗留下来的调试问题？感谢您提供任何线索。

```
<script>
    (function (r) {
        _ready = {
            q: function () {
                return r;
            }
        };
        $ = function (f) {
            if (typeof f === "function") {
                r.push(arguments);
            }
            return $;
        };
        jQuery = $.ready = $;
    }([]));
</script> 
```

仅供参考，我们批判性地看待这个的原因是它似乎与其他一些 jquery 库发生冲突，例如 NRelate 的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T21:26:45.500

[这](http://blog.vervestudios.co/blog/2011/07/default.aspx/)**肯定**会有所帮助

 **从上面给出的链接，

> 它在加载 jQuery 之前设置 jQuery.ready 回调

**例如**

假设你有 jQuery 这样的 body，

```
 <div id="main">
        <script>
            $(function(){
                $("#main").prepend( "<p>Heyo!</p>" );
            });
        </script>
    </div>
    <div>...more HTML...</div>
    <script src="/js/jquery.js"></script> 
```

它不会工作，因为 jQuery 是在底部加载的，而您正试图在此之前使用它。

所以，我们做这个解决方法，

```
<head>
    <script>
        (function(a){
             _ready = {
                q: function () {
                  return r;
                }
               };

             $ = function (f) {
               if (typeof f === "function") {
                r.push(arguments);
               }
             return $;
            };

            jQuery=$.ready=$;
        }([]));
    </script>
</head>
<body>
    <div id="main">
        <script>
            $(function() {
                $( "#main" ).prepend( "<p>Heyo!</p>" );
            });
        </script>
        <div>...more HTML...</div>
    </div>
    <script src="/js/jquery.js"></script>
    <script>
        (function( i, s, q, l ) {
            for( q = window._ready.q(), l = q.length; i < l; ) {
                $.apply( this, s.call( q[ i++ ] ) );
            }
            window._ready.q = undefined;
        }( 0, Array.prototype.slice ));
    </script>
    <script src="/js/scripts.js"></script>
</body> 
```

第一个脚本的作用是通过将任何对 $.ready 的调用的参数存储到数组中来模拟 jQuery 的 ready 函数，其中第一个参数是函数。这个数组对于我们的全局作用域的`_ready.q`方法是私有的，当被调用时，它会返回这个数组。

第二个脚本通过调用循环遍历数组`_ready.q()`，然后将最初传递给冒名顶替者 $.ready 的参数应用于真正的 $.ready。

**PS**它是一个自调用函数，其中一个空数组与变量 name 一起传递`r`。参考[这个](http://sarfraznawaz.wordpress.com/2012/01/26/javascript-self-invoking-functions/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T21:23:32.833

`r`将是最后传递给函数的空数组。

完全注释的副本：

```
//         v--- receives the [] passed in below
(function (r) {
    // Creates an implicit global variable called `_ready`
    // (or overwrites one that's already there)
    _ready = {
        // Makes `r` available via `_ready.q()` or
        // `window._ready.q()`
        q: function () {
            return r;
        }
    };
    // Creates an implicit global variable called `$`
    // (or overwrites one that's already there)
    $ = function (f) {
        if (typeof f === "function") {
            r.push(arguments);
        }
        return $;
    };

    // Creates/overwrites the global variable `jQuery` and `$.ready`
    // with the function defined above
    jQuery = $.ready = $;
}([]));
//^^-- the value passed to r 
```

它*似乎*允许您创建一个函数数组，以便在实际加载 jQuery 时根据您接管`jQuery`、`$`和`$.ready`符号来调用。实际**执行**此操作的代码未显示。`_ready.q()`通过（或）实际使用该数组的任何代码都可以访问该数组`window._ready.q()`。

并且说它令人费解并且需要*认真*评论（更不用说宣布隐含的全局 -*不寒而栗* - ）将是轻描淡写。

也可以看看：

*   [*隐式全局变量的恐怖*](http://blog.niftysnippets.org/2008/03/horror-of-implicit-globals.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T21:29:19.400

它可能在实际加载 jQuery 之前创建所有调用的 jQuery 函数（和提供的参数）的列表。

我希望您会找到其他一些代码，这些代码会在`_ready.q()`实际加载后读取 jQuery 的内容并将其传递给 jQuery。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T21:26:41.363

`r`是位于底部的空数组`[]`，基本上`r`是数组的别名，将在匿名函数内部使用，因此`r.push`会将项目推入空数组

`(function(){ ... })()`被定义为匿名函数。**

# html - 在 CSS 中将图像设置为页脚背景

> ID：10761467
> 
> 赞同：8
> 
> 时间：2012-05-25T21:16:42.620
> 
> 标签：html, css, footer, styling

所以我想在我的页面上添加一个页脚，但我希望它是一个背景图像，它会根据显示器分辨率自动调整大小，并使其具有 100% 的宽度和高度，但永远不会溢出到两侧，所以我不希望出现滚动条。图片为.jpg。

希望能提供一些关于解决此问题的最佳方法的意见

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-25T21:19:52.117

使用以下 CSS

```
​div {
    width: 100%;
    height: 400px;
    background-image: url(your-path-here.jpg);
    background-size: 100% 100%;
}​ 
```

看看这个活生生的[例子](http://jsfiddle.net/jackdent/nwcy2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:29:14.253

请注意，如果您不调整页脚的高度，则会拉伸图像。

`background-size`可以解决问题，但请注意，IE8 和更早版本不支持它。为了这些浏览器的安全起见，图像可以位于中心（这意味着水平 50% 和垂直 50% - 当然， center 关键字也可以）

现场演示：[http ://dabblet.com/gist/2790711](http://dabblet.com/gist/2790711)

# php - 使用 Jquery 进行后期操作

> ID：10761471
> 
> 赞同：0
> 
> 时间：2012-05-25T21:17:10.427
> 
> 标签：php, jquery, post

我想用 Jquery 在我的数据表中编辑照片。为此，

```
<a href="ajax/edit_photo.php?id=<?=$row['ID']?>" class="edit ajax" id="">-->'Edit Photo Link' 
```

**编辑照片.php：**

```
<div class="photoEdit">
    <form id="editphoto" action="1.php?id=<?=$_GET['id']?>" method="post" class="stdform quickform" enctype="multipart/form-data">
    //My Forms...
    </form>

</div> 
```

**我的jQuery：**

```
jQuery('#editphoto').submit(function(){
            var formdata = jQuery(this).serialize();
            var url = jQuery(this).attr('action');
            jQuery.post(url, formdata, function(data){                          
            jQuery('.notifyMessage').addClass('notifySuccess');
                //otherwise
                //jQuery('.notifyMessage').addClass('notifyError');
                jQuery.fn.colorbox.resize();    
            });
            return false;
        }); 
```

**还有我的 1.php**

```
<? 
include("../../connection.php");
include("../../functions/upload.php");
?>
<?
$limit="1048576";
if(isset($_GET['kaydet'])){
    $id=$_GET['id'];
    $icerik=$_POST['icerik'];
    $picture=DoUpload("picture",$limit,$FileUploadPath);
    $result=mysql_query("SELECT * FROM tbl_photo WHERE ID=$id");
    $picture2=mysql_result($result,0,"picture");
    if($picture=='')
    $picture=$picture2;
    if($picture!="")
{
    mysql_query("UPDATE  `tbl_photo` SET  `picture` =  '$picture',`icerik` =  '$icerik' WHERE `ID` =$id");
    }
}
?> 
```

我编码了一些东西。但是在我的操作中，Jquery 不起作用。所以，什么都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:30:21.223

您不能通过 jquery 上传二进制文件。您将不得不使用 iframe 方法，或使用一些 jquery 库。（这个很容易尝试[。http://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)）

另外，您在 PHP 代码中混合了 GET 和 POST。由于您在 jquery 中执行 POST 请求，因此您将无法使用 $_GET 在 PHP 中获取任何变量。它们都应该替换为 $_POST。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:31:16.557

对于图像上传或其他二进制数据，使用隐藏的 iframe。

```
<div style="position:absolute;top-500px;">
    <iframe src="blank.htm" id=ifr name="ifr">   
</iframe>
</div> 
```

然后让您的图像表单提交到 iframe。

```
<form target="ifr" onsubmit="pollstatus(<?php=$id ?>)"> 
```

使用唯一标识符将隐藏的表单字段添加到表单中。

然后使用 ajax 每 100 毫秒使用 setinterval 调用带有 id 的处理状态，如果处理完成，则使用 ajax 检索图像以获取 html 代码，该代码使用 css 转换显示您喜欢的图像，但您喜欢它，并且把它放在你的结果 div

# hash - Sage 中默认的 __hash__ 方法是什么？

> ID：10761475
> 
> 赞同：0
> 
> 时间：2012-05-25T21:17:34.863
> 
> 标签：hash, sage

我有一个从 SageObject 继承的 Sage 类。根据 Python 文档，

> 用户定义的类默认有`__cmp__()`和`__hash__()`方法；与它们一起，所有对象都比较不相等（除了它们自己）并`x.__hash__()`返回`id(x)`。

然而，我的类并没有这样做，尽管它没有实现`__hash__`自己的方法。相反，它使用其字符串表示的哈希值（由其`__str__`方法返回的那个）。这部分 Sage 类的设计与普通的 Python 类有什么不同吗？为了找到可接受的哈希值，Sage 是否有可能查看位置的层次结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T02:17:24.737

幸运的是，您实际上自己回答了这个问题。尝试`??`找到源代码的技巧。

```
sage: SageObject.__hash__??
Type:       wrapper_descriptor
Base Class: <type 'wrapper_descriptor'>
String Form:    <slot wrapper '__hash__' of 'sage.structure.sage_object.SageObject' objects>
Namespace:  Interactive
Definition: SageObject.__hash__(self)
Source:
    def __hash__(self):
        return hash(self.__repr__()) 
```

所以，是的，大多数这些事情都是故意的。如果你想为哈希实现一些不同的东西，我想你可以。如果这是您有兴趣贡献并认为它可能与某些东西冲突的代码，那么值得在 Sage 列表之一上询问。

# debugging - CSS3PIE 背景渐变背景颜色

> ID：10761481
> 
> 赞同：0
> 
> 时间：2012-05-25T21:18:30.667
> 
> 标签：debugging, transparency, background-color, css3pie

我已经在我的drupal 网站[http://tinyurl.com/cyfxly4](http://tinyurl.com/cyfxly4)上配置了css3pie的角半径，即8 和7，它工作正常，但背景颜色变淡了。我没有在任何地方定义任何透明度命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T17:35:27.263

> actually side bar and banner divs were overlap by the container div which had a 50% transparent image on it

# asp.net-mvc - System.Web.mvc.HtmlHelper 不包含 EnumDropDownListFor 的定义

> ID：10761484
> 
> 赞同：12
> 
> 时间：2012-05-25T21:18:44.070
> 
> 标签：asp.net-mvc

我一直在关注本教程[http://blogs.msdn.com/b/stuartleeks/archive/2010/05/21/asp-net-mvc-creating-a-dropdownlist-helper-for-enums.aspx](http://blogs.msdn.com/b/stuartleeks/archive/2010/05/21/asp-net-mvc-creating-a-dropdownlist-helper-for-enums.aspx)但我运行进入错误“System.Web.Mvc.HtmlHelper 不包含 EnumDropDownListFor 的定义”。

模型：

```
public enum Codes
{
    IBC2012,
    IBC2009,
    IBC2006,
    FL2010,
    CBC2007
}

public class Code
{
    public int ID { get; set; }
    public int Active { get; set; }
    public string Description { get; set; }
    public string Edition { get; set; }
    public Codes Code { get; set; }
} 
```

控制器：

```
public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression)
    {
        ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
        IEnumerable<TEnum> values = Enum.GetValues(typeof(TEnum)).Cast<TEnum>();

        IEnumerable<SelectListItem> items =
            values.Select(value => new SelectListItem
            {
                Text = value.ToString(),
                Value = value.ToString(),
                Selected = value.Equals(metadata.Model)
            });

        return htmlHelper.DropDownListFor(
            expression,
            items
            );
    } 
```

HTML 助手：

```
@Html.EnumDropDownListFor(model => model.Code.Codes) 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-26T07:31:42.097

您忘记将扩展方法纳入视图范围内。这个`EnumDropDownListFor`方法是在命名空间内的某个静态类中定义的，对吧？

```
namespace AppName.SomeNamespace
{
    public static class HtmlExtensions
    {
        public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression)
        {
            ...
        }
    }
} 
```

您需要在要使用此帮助器的视图中添加此命名空间：

```
@using AppName.SomeNamespace
@model MyViewModel
...
@Html.EnumDropDownListFor(model => model.Code.Codes) 
```

为了避免将此 using 子句添加到所有 Razor 视图中，您还可以将其添加到文件的`<namespaces>`部分`~/Views/web.config`：

```
<system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="AppName.SomeNamespace" />
      </namespaces>
    </pages>
</system.web.webPages.razor> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-19T17:20:01.350

正如@ArhiChief 在他们的回答中暗示的那样，我的问题是：

```
using System.Web.WebPages.Html; 
```

代替：

```
using System.Web.Mvc; 
```

两者都有定义，`HtmlHelper`所以如果你添加错误的，你会得到这个错误。用正确的命名空间替换它会修复它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-28T13:40:11.240

将您的命名空间更改为

```
namespace System.Web.Mvc
{
    public static class HtmlExtensions
    {
... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-01T13:14:59.023

也许问题在于您`HtmlHelper`不包含定义 for`DropDownList`因为`HtmlHelper`在多个命名空间中定义：`System.Web.Mvc`和`System.Web.WebPages.Html`. 命名`System.Web.WebPages.Html`空间包含.`HtmlHelper.DropDownList`

另外，不要忘记将您的 html 帮助器命名空间发布到 Views Web.config 中，这样，Razor 视图引擎会找到它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-05T14:18:27.593

在我的情况下，我引用了我的扩展命名空间，但缺少 System.Web.Mvc.Html 的 using 语句。

（DropDownList 方法在 System.Web.Mvc.Html.SelectExtensions 中定义）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-25T15:11:22.987

在 Darin 的回答中要特别注意，您将把命名空间添加到**Views**文件夹中的 web.config 中。**不是**您的`web.config`根 Web 文件夹中的文件。`web.config`一开始我并没有注意到它，有一段时间我很困惑为什么在将我的命名空间添加到根文件后它不起作用。

我认为这也解释了为什么它适用于那些将命名空间更改为`System.Web.Mvc`HtmlExtensions 类的人。`System.Web.Mvc`已包含在`~/Views/web.config`文件的命名空间中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-03T00:25:48.967

如前所述，正确的命名空间需要位于 views 文件夹下的 web.config 文件中。默认命名空间自动包含在 views 文件夹下的 web.config 文件中。

如果您的默认命名空间是

```
 namespace AppName.SomeNamespace 
```

web.config 文件已包含以下条目：

```
 <add namespace="AppName.SomeNamespace" /> 
```

之前没有提到的是，当您在 MVC 项目中创建一个新文件夹时，命名空间会得到扩展。如果您像我一样创建了一个名为 Helpers 的文件夹，那么这些方法的命名空间将是：

```
 namespace AppName.SomeNamespace.Helpers 
```

扩展的命名空间不在views文件夹下的web.config文件中的web中。

你有两个选择：

1.  通过删除“.Helpers”，使用 html 帮助方法将文件中的命名空间更改为默认命名空间。

2.  将扩展命名空间添加到 Web 配置文件

    ```
    <add namespace="AppName.SomeNamespace.Helpers"> 
    ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-18T19:30:59.023

我们使用VB并且遇到了同样的问题。唯一对我们有用的是，在 _PartialView.vbhtml 页面中：

```
@* Import the project's root namespace *@
@Imports MyRootNamespace

@* Import the Module that contains the HTML Extension Functions *@
@Imports MyHtmlHelperExtensions

@* To use the extension, We have to call the extension function directly 
   Passing the Html (HTML Helper Object) as the first parameter. *@
MyExtensionFunctionName(Html, "Hello World") 
```

作为参考，我们的 HTML 扩展文件如下所示：

```
Imports System.Web.WebPages.Html    

Public Module MyHtmlHelperExtensions

    '== Example
    <Extension()>
    Public Function MyExtensionFunctionName(ByVal html As HtmlHelper, ByVal textToDisplay As String) As IHtmlString
         html.Raw(textToDisplay)
    End Function

End Module 
```

# android - Android应用生命周期和单例

> ID：10761488
> 
> 赞同：4
> 
> 时间：2012-05-25T21:19:04.023
> 
> 标签：android, singleton, static-members, application-lifecycle

我们大多数人都熟悉这种模式：

```
 public class MySingeltone {

    public String mSomeReferenceTypeData;
    public int mSomeValueTypeData;

    private static MySingeltone mInstance;

    private MySingeltone() {

    }

    public static MySingeltone getInstance() {
        if (mInstance == null) {
            mInstance = new MySingeltone();
        }

        return mInstance;
    }
 } 
```

我的问题是我最近发现 mInstance 在使用他的活动被破坏后不等于 null ，或者当整个应用程序假设为子句时，例如：

```
public class SomeActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        MySingeltone mySingeltone = MySingeltone.getInstance();
        mySingeltone.mSomeReferenceTypeData = "some value";
    }
} 
```

在关闭运行活动的整个应用程序后（例如 10 秒后）下一次启动“SomeActivity”时，mInstance 仍然保持相同的引用，其字段具有相同的值。

为什么会这样？

我错过了什么？

当android垃圾收集静态成员属于应用程序时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:37:44.900

由于“mInstance”是一个静态变量，当您关闭应用程序时它不会为空。关闭应用程序并不意味着您的应用程序被破坏。

也没有关闭您的 Android 应用程序的概念。如果您退出您的应用程序，它不会同时被破坏。当不再使用应用程序时，Android OS 会在内部处理它何时关闭应用程序。如果 android 决定销毁应用程序时内存不足，那么这个静态变量也将变为 null。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T21:29:10.990

您无法控制 Java 对象何时被垃圾回收。当一个对象不再有（非循环）引用时，它就有资格进行垃圾回收。此外，使用 Android，您无法控制 Activity 何时从内存中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-28T17:18:53.353

> 为什么会这样？
> 
> 我错过了什么？
> 
> 当android垃圾收集静态成员属于应用程序时？

首先，正如其他人所说，Android 上没有封闭的应用程序概念，因为 android 操作系统自己管理应用程序进程的生命周期。

其次，你做了错误的测试——如果你不关闭所有应用程序而是做相反的事情——即通过启动越来越多的应用程序来填满内存，那么最终你的应用程序的内存将被清理以供其他应用程序使用，而这包括所有静态成员以及实例成员！然后，您将看到静态变量将如您预期的那样为 NULL。

他们只是“懒惰地”清理内存，如果有足够的内存，那么您的应用程序可能永远不会被清理。

实际上，没有办法解决它，据我所知，没有办法保证在任何时候都不会从设备内存中清除对象。在某些情况下，它会导致不良行为。比如如果单例对它的创建做了繁重的处理，调用 getInstance 可能会让你的 UI 卡住，甚至因为不负责任而导致你的应用程序崩溃。

# sql - 在 SQL 中查找表

> ID：10761490
> 
> 赞同：0
> 
> 时间：2012-05-25T21:19:31.753
> 
> 标签：sql

我基本上有一个包含 3000 万条记录的表 A，我想在表中添加一个名为“TYPE”的列。我有一个将代码映射到颜色的查找表 B。我想遍历表 A 并将表 A 中的代码与表 B 中的代码进行比较，然后将颜色添加到表 A 中的 TYPE 列。这可能吗？解决这个问题的最佳方法是什么？表 B 中的代码与表 A 中的实际代码不完全匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:31:20.177

给出或接受事务大小的问题，添加列和更新来修复它不是一个简单的 ALTER TABLE 吗？

```
ALTER TABLE TableA ADD (Type VARCHAR(10));

UPDATE TableA
   SET Type = ((SELECT Colour FROM TableB WHERE TableA.Type = TableB.Type)); 
```

唯一棘手的可能是双括号；它们在某些 DBMS 中是必需的，而在其他 DBMS 中可能不需要（单括号可能就足够了）。您还可以使用 UPDATE 和 JOIN；那里的语法也不完全标准。

请注意，此映射依赖于将 NULL 更改为 NULL 是无操作的。如果您在某些行中有值，但并非所有这些行都与 TableB 中的条目匹配，那么您需要小心使用这样的全表 UPDATE。它将 TableA 中任何与 TableB 中不匹配的行的 Type 设置为 NULL。如果这不是您所需要的，您可以使用 UPDATE 和 JOIN 或编写：

```
UPDATE TableA
   SET Type = ((SELECT Colour FROM TableB WHERE TableA.Type = TableB.Type));
 WHERE Type IN (SELECT Colour FROM TableB WHERE TableA.Type = TableB.Type); 
```

在当前情况下，列是新添加的，因此无论如何都包含 NULL，省略 UPDATE 本身的 WHERE 子句并没有什么坏处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:33:50.993

很难说没有看到架构或不知道 DBMS，但是，如果它总是用于查找颜色的代码的前 2 位，为什么不

```
UPDATE table_a SET type = SUBSTR(code, 2) 
```

并正常进行 JOIN

你可以加入

```
JOIN table_b ON table_b.id = SUBSTR(table_a.code,2) 
```

但这几乎不会有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T02:03:47.740

您可以通过查看表 B 中代码的第一个字符来进行更新，如以下语句所示：

```
update table_a
    set table_a.type = table_b.type
    from table_b
    where table_b.code = substr(table_a.code, 1, length(table_b.code)) 
```

这可能有点慢，因为您不能使用任何索引来加速它。但是，如果 table_b 很小，那么性能可能是可以接受的。

# c# - 从复杂 xsd 生成的类，尝试序列化给出 nullreferenceexception

> ID：10761493
> 
> 赞同：0
> 
> 时间：2012-05-25T21:19:50.447
> 
> 标签：c#, xml, xsd

几个小时以来一直在挠头。谷歌搜索。但无法弄清楚如何正确生成 xml。非常感谢可以帮助我解决这个问题的输入。我之前使用过 xsd.exe 和不太复杂的方案，没有任何问题。

所以我得到错误：对象引用未设置为对象的实例。

我已经从这个 xsd 文件创建了 C# 类：[http ://www8.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd](http://www8.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd)

我使用 Microsoft xsd.exe 工具创建了这些类，如下所示：xsd.exe xsd-file /classes

然后我删除了像 [][] 这样的双括号并用单个 [] 替换，否则我根本无法序列化/反序列化。

我实际上不知道使用从 xsd 文档生成的类创建 xml 文件的正确方法。以下是此类 xml 文件的示例：[https ://github.com/mlt/schwinn810/wiki/Sample-.TCX-Files](https://github.com/mlt/schwinn810/wiki/Sample-.TCX-Files)

这是我试图序列化的对象（只是一个例子）：

```
XmlObjects.Tcx20.TrainingCenterDatabase_t tcx = new XmlObjects.Tcx20.TrainingCenterDatabase_t();
XmlObjects.Tcx20.AbstractSource_t abstractSource = new XmlObjects.Tcx20.Application_t();

abstractSource.Name = "TcxCreator";

tcx.Author = abstractSource;
abstractSource = new XmlObjects.Tcx20.Application_t();

XmlObjects.Tcx20.ActivityList_t activityList = new XmlObjects.Tcx20.ActivityList_t();

XmlObjects.Tcx20.Activity_t[] activity = new XmlObjects.Tcx20.Activity_t[1];
XmlObjects.Tcx20.ActivityLap_t[] lap = new ActivityLap_t[1];
XmlObjects.Tcx20.Course_t[] course = new Course_t[1];
XmlObjects.Tcx20.Trackpoint_t[] trackPoint = new Trackpoint_t[1];
XmlObjects.Tcx20.Position_t position = new Position_t();

double lat = 10;
double lon = 11;

position.LatitudeDegrees = lat;
position.LongitudeDegrees = lon;

trackPoint[0].Time = DateTime.Now;
trackPoint[0].Position = position;
lap[0].Track = trackPoint;
activity[0].Lap = lap;

activityList.Activity = activity;

tcx.Activities = activityList; 
```

线 trackPoint[0].Time = DateTime.Now; 给出了提到的错误。但我认为与 xsd/xml 的外观相比，它与我创建错误的类/xml 更相关。

有人能指出我关于如何从 xsd.exe 生成的类构建 xml 的正确方向吗？

编辑：谢谢YavgenyP！就是这样，这段代码正在工作：

```
 XmlObjects.Tcx20.TrainingCenterDatabase_t tcx = new XmlObjects.Tcx20.TrainingCenterDatabase_t();
        XmlObjects.Tcx20.AbstractSource_t abstractSource = new XmlObjects.Tcx20.Application_t();

        abstractSource.Name = "TcxCreator";

        tcx.Author = abstractSource;
        abstractSource = new XmlObjects.Tcx20.Application_t();

        XmlObjects.Tcx20.ActivityList_t activityList = new XmlObjects.Tcx20.ActivityList_t();

        XmlObjects.Tcx20.Activity_t[] activity = new XmlObjects.Tcx20.Activity_t[1];
        XmlObjects.Tcx20.ActivityLap_t[] lap = new ActivityLap_t[1];
        XmlObjects.Tcx20.Course_t[] course = new Course_t[1];
        XmlObjects.Tcx20.Trackpoint_t[] trackPoint = new Trackpoint_t[1];
        XmlObjects.Tcx20.Position_t position = new Position_t();

        double lat = 10;
        double lon = 11;

        position.LatitudeDegrees = lat;
        position.LongitudeDegrees = lon;

        trackPoint[0] = new Trackpoint_t {Time = DateTime.Now, Position = position};
        lap[0] = new ActivityLap_t {Track = trackPoint};
        activity[0] = new Activity_t {Lap = lap};

        activityList.Activity = activity;

        tcx.Activities = activityList; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T09:30:17.703

> 线 trackPoint[0].Time = DateTime.Now; 给出提到的错误

查看您的代码，您在此处初始化上述数组：

```
XmlObjects.Tcx20.Trackpoint_t[] trackPoint = new Trackpoint_t[1]; 
```

但是您从未在数组中初始化 Trackpoint_t ITSELF，这会导致

```
trackPoint[0].Time = DateTime.Now; 
```

失败（trackPoint[0] 仍然为空）

# ubuntu - 错误：创建状态文件时出错 /var/lib/logrotate/status：权限被拒绝

> ID：10761495
> 
> 赞同：17
> 
> 时间：2012-05-25T21:19:57.237
> 
> 标签：ubuntu, logrotate

尝试使用 logrotate 并在为 logrotate.d 中的特定定义运行日志轮换脚本时收到以下错误

`error: error creating state file /var/lib/logrotate/status: Permission denied`

```
/var/lib/logrotate$ ls -lah
total 12K
drwxr-xr-x  2 root root 4.0K 2012-05-11 06:25 .
drwxr-xr-x 43 root root 4.0K 2012-05-18 08:07 ..
-rw-r--r--  1 root root  911 2012-05-25 06:25 status 
```

我还没有触及那条路径，所以我想知道为什么它会默认创建一个错误......

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-20T18:36:30.033

**不要** `chmod`将默认状态文件设置为**666**。如果你`chmod`这样做，系统上的每个用户都可以`logrotate`用作攻击媒介。

只需使用 option 为您的用户（假设您尝试以普通用户身份运行它）定义一个（私有）状态文件`[-s|--state file]`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T21:40:18.643

您确定以 root 身份运行此命令吗...？;) 如果是，请检查系统上是否有 AppArmour - 如果是，请检查它的配置或卸载它（Ubuntu 案例）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-12T14:33:09.923

crontab 中有这一行：

```
*  *  *  *  *   root    logrotate -s /var/run/logrotate.status /etc/logrotate.conf 
```

即使它以root身份运行，我也无法摆脱“错误：错误创建状态文件/var/run/logrotate/status：权限被拒绝”错误。

所以我只是使用了一个不同的目录：

```
*  *  *  *  *    root    /usr/sbin/logrotate -s /var/log/logrotate.status -v /etc/logrotate.conf >/tmp/logrotate.out 2>&1 
```

[使用了来自https://serverfault.com/questions/762587/daily-logrotate-error-creating-unique-temp-file-permission-denied](https://serverfault.com/questions/762587/daily-logrotate-error-creating-unique-temp-file-permission-denied)的调试思想，但对其进行了更改，因此输出文件不会无限增长，这将是具有讽刺意味。

在这种情况下，详细模式没有提供任何额外的信息，顺便说一下，它正在读取的配置文件和相同的错误消息。但最好将输出放在该文件上，而不是放在 /var/mailspool 中。

# java - 在Java中的正则表达式匹配后删除部分字符串

> ID：10761501
> 
> 赞同：4
> 
> 时间：2012-05-25T21:20:44.627
> 
> 标签：java, regex, string, match

我想删除与我的正则表达式匹配的字符串的一部分。

我正在尝试制作一个电视节目组织程序，并且我想以 SXEXXX 的形式在季节和剧集标记之后切断名称中的任何内容，其中 X 是一个数字。

我相当容易地掌握了正则表达式模型来创建应该正确匹配的“[Ss]\d\d[Ee]\d\d”。

我想使用 Matcher 方法 end() 来获取匹配字符串中的最后一个索引，但它似乎没有像我认为的那样工作。

```
Pattern p = Pattern.compile("[Ss]\\d\\d[Ee]\\d\\d");
Matcher m = p.matcher(name);

if(m.matches())
    return name.substring(0, m.end()); 
```

如果有人能告诉我为什么这不起作用并提出正确的方法，那就太好了。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:26:30.373

`matches()`尝试再次匹配整个字符串的模式。如果您想在字符串中找到您的模式，请使用`find()`,`find()`将在字符串中搜索下一个匹配项。

您的代码可能完全相同：

```
if(m.find())
    return name.substring(0, m.end()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T21:28:44.670

`matches`匹配整个字符串，试试`find()`

您也可以捕获名称：

```
String name = "a movie S01E02 with some stuff";
Pattern p = Pattern.compile("(.*[Ss]\\d\\d[Ee]\\d\\d)");
Matcher m = p.matcher(name);

if (m.find())
    System.out.println(m.group());
else
    System.out.println("No match"); 
```

将捕获并打印：

> 电影 S01E02

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T21:25:47.067

这应该工作

```
.*[Ss]\d\d[Ee]\d\d 
```

在java中（我生锈了）这将是

```
String ResultString = null;

Pattern regex = Pattern.compile(".*[Ss]\\d\\d[Ee]\\d\\d");
Matcher regexMatcher = regex.matcher("Title S11E11Blah");
if (regexMatcher.find()) {
    ResultString = regexMatcher.group();
} 
```

希望这可以帮助

# php - 变量中的时间，减少延迟

> ID：10761504
> 
> 赞同：0
> 
> 时间：2012-05-25T21:20:49.890
> 
> 标签：php

我有一个 time() 值保存在这样的变量中：

```
$latest_attempt = 1337980678; 
```

我正在尝试计算一些延迟。

```
$remaining_delay = time() - $latest_attempt - $delay; 
```

但是，`$remaining_delay`当我更新浏览器时，结果会增加，而不是反过来。

“您必须等待 95 秒才能进行下次登录尝试”

如果我在几秒钟后更新“您必须等待 102 秒才能尝试下次登录”

它正在做与它应该做的相反的事情，而是宁愿减少而不是增加。我做错了什么？我相信我需要对 latest_attempt 变量做一些事情，但我在 php 手册中找不到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:22:54.797

我会说，是这样的：

```
$remaining_delay = $latest_attempt + $delay - time(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:25:19.227

```
$time_since_last = time() - $last_attempt;

if ($time_since_last <= $delay) {
    $remaining = $delay - $time_since_last;
} else {
   ... good to go ... delay's expired
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:35:58.007

剩余延迟是阻塞到期的那一刻（`$last_attempt + $delay`因为从 $last_attempt 开始，用户被阻塞了一段时间 $delay）与当前时间（`time()`）之间的差 - 因此正确的公式是：

```
$remaining_delay = ($latest_attempt + $delay) - time();

if ($remaining_delay > 0) {
    die('Access denied, you need to wait another '. $remaining_delay .' seconds');
} 
```

# javascript - 更改 HTML 文本框：覆盖而不是作为用户类型插入

> ID：10761508
> 
> 赞同：5
> 
> 时间：2012-05-25T21:21:13.677
> 
> 标签：javascript, jquery, html

我正在开发一项允许编辑文本的服务。为了在此过程中帮助用户，我想允许用户将文本字段设置为覆盖模式，就像在 Word 等中一样。如何将 HTML 文本框的行为更改为覆盖而不是插入文本作为用户类型？

例如，如果文本框有文本：

```
This is a trst. 
```

用户可以在 r 和 t 之间单击，键入一个`e`，然后文本将是

```
This is a test. 
```

`e`和之间的光标`s`。我目前正在使用 jQuery，因此首选使用该方法或纯 javascript 的方法。但是，我会接受任何合理的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-25T22:14:35.367

这有点疯狂，但它似乎以某种方式工作:)

基于[this answer](https://stackoverflow.com/a/263796/1249581)和[this answer](https://stackoverflow.com/a/512542/1249581)创建了这段代码。

```
$("textarea").on("keypress", function(e) {
    var key = String.fromCharCode(e.which || e.charCode || e.keyCode);
    if (/[A-Za-z0-9 ]/.test(key)) {
        var text = this.innerHTML;
        var caret = getCaret(this);
        var output = text.substring(0, caret);
        this.innerHTML = output + key + text.substring(caret + 1);
        setCaretPosition(this, caret + 1);
        return false;
    }
    return true;
});​ 
```

**演示：http:** [//jsfiddle.net/aHSzC/](http://jsfiddle.net/aHSzC/)

它有效，但现在我没有时间修复我发现的一个小错误。

*   如果您按下`Backspace`它，它的行为似乎就像一个向前的橡皮擦。

无论如何，这是可以改进的代码。随意编辑我的答案并做任何你喜欢的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:57:15.563

输入元素有一个 onkeypress 属性。你可以让它调用一个函数来删除光标后的字符。jQuery 有一个插入符号扩展，您可以使用它来找出插入符号的位置。

# android - Phonegap (1.7.0) + node.js + socket.io

> ID：10761512
> 
> 赞同：3
> 
> 时间：2012-05-25T21:21:32.927
> 
> 标签：android, node.js, cordova, websocket, socket.io

我正在尝试在另一侧使用**Phonegap (Cordova 1.7.0)**、**Node.js (v0.6.18)**和**Socket.io (v0.9)构建一个****Android (v.4.0.3)**应用程序。我需要为我的学校项目做这个，但由于我的知识有限，我碰壁了。我什至认为 socket.io 不能在 Phonegap (Android) 中使用。是否有可能获得一些方向、链接或其他类型的帮助，以便我能够建立连接。连接是主要问题。文档对我的帮助不够。

 ******我非常感谢有关如何建立连接的一些提示。我安装了节点检查器，但没有。*Server.js在**端口 8080*上的*Amazon EC2*微型实例上运行。我在某处读到 Android 不支持 websockets。

 *但是，Phonegap 实际上抓取了整个 HTML 页面并将其打包以在 UIWebView 或 WebView 中作为本机应用程序运行，这不是真的吗？

所以在这种情况下，它就是 webkit。如果我没记错的话，这个支持 websockets。

问候，

托马兹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T07:12:29.063

有一个用于 websockets的[Phonegap 插件。](https://github.com/anismiles/websocket-android-phonegap)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-27T06:17:27.373

这个问题是在大约 3 年前被问到的。如果您需要在 Android 或 iOS 上同时使用 node.js 和 cordova/phonegap，请参阅[jxcore-cordova](http://github.com/jxcore/jxcore-cordova)*******

# c++ - 如何使用 static_cast 安全地识别和释放这个 c++ 对象？

> ID：10761517
> 
> 赞同：4
> 
> 时间：2012-05-25T21:22:15.047
> 
> 标签：c++, objective-c, xcode

在其他 Objective-C 类中，我在下面的 c++ 类中调用代码。有时 fSound 对象不是 FMOD::Sound 并且在释放时会崩溃。在释放 fSound 对象之前，如何确认它是正确的类型？

```
-(void) unloadSound:(FMOD::Sound *)fSound {

    FMOD_RESULT   result        = FMOD_OK;
    FMOD::Sound* soundEffect = static_cast<FMOD::Sound*>(fSound);

      if (soundEffect) {
          soundEffect->release();
      }

    soundEffect = NULL;
    fSound = NULL;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:31:38.833

您可以使用 dynamic_cast 而不是 static_cast（如果强制转换不成功，dynamic_cast 返回 NULL）。

但是，您应该检查您的设计。在运行时检查类型揭示了应该通过继承解决的设计问题。

# jquery - 搜索功能不可选择的文本

> ID：10761520
> 
> 赞同：0
> 
> 时间：2012-05-25T21:22:26.847
> 
> 标签：jquery, html, css

我希望创建一个输入文本字段，该文本字段显示文本字段的用途，然后在输入字符时删除该文本

例如，在 Facebook 中，当您单击搜索输入文本区域时，在输入任何字符之前，您会看到仍然显示“搜索”一词。

我不知道在 JQuery 中从哪里开始，因为我不知道这个功能叫什么，但下面是我的输入字段的标记

**HTML 标记**

```
<div class="searchForm">
   <input id="searchInput" value="Search"  autocomplete="off" name="searchInput"   
      onkeyup="showResult(this.value)"/>
   <input type="hidden" name="searchSite" value="1" style="background-color:#000;">
   <input id="searchButton" type="submit" value=""/>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:26:29.430

您可以像这样使用 html 5 属性`placeholder`：

```
<input id="searchInput" type="text" placeholder="Search" name="searchInput" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T21:30:37.680

有几种方法可以做到这一点。使用 HTML5，这可以通过使用占位符属性轻松实现。这允许您在 HTML 元素中定义文本，并且在焦点上它会消失。

```
<input id="searchInput" value="Search"  autocomplete="off" name="searchInput" placeholder="Search"   
      onkeyup="showResult(this.value)"/> 
```

执行此操作的其他 JavaScript 方法是使用清除焦点或单击等文本的方法。

```
$('input#searchInput').focus(function() {
    $(this).value('');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T21:29:51.393

这是我的另一个[答案](https://stackoverflow.com/questions/10602262/make-prompt-in-text-field-disappear-reappear-when-user-types-erases/10602836#10602836)。这是[这段](http://jsfiddle.net/SU5ZA/2/)代码的工作示例。

HTML

```
<div>
    <label for="search">Search this site</label>
    <input type="text" id="search" value="" />
</div> 
```

CSS

```
body { padding: 20px; }

div { position: relative; }
div label { position: absolute; left: 8px; top: 4px; color: #666; z-index: 2; font: 11px arial; }
div input { position: absolute; padding: 3px 6px; border: 1px solid #ddd; border-radius: 2px; z-index: 1; font: 11px arial; }
.populated label { display: none; }
.focused label { color: #aaa; } 
```

Javascript

```
$('input').on('keydown keypress keyup', function(e) {
    if($('input').val() == '') {
        $('div').removeClass('populated');
    }
    else {
        $('div').addClass('populated');
    }
}).on('focus', function(e) {
    $('div').addClass('focused');
}).on('blur', function(e) {
    $('div').removeClass('focused');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T21:30:55.527

如果您使用的是 HTML5，那么您应该使用[`placeholder`属性](http://www.w3.org/wiki/HTML5_form_additions#placeholder).

如果您使用的是 HTML4.01 或 XHTML1.0，请查看此问题的最终编辑：[不显眼的“默认”文本在输入中没有 jQuery](https://stackoverflow.com/questions/2856573/unobtrusive-default-text-in-input-without-jquery)（最后使用 jQuery）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-25T21:45:05.070

正如其他答案所建议的那样，我建议使用 HTML 5`placeholder`属性。对于不支持的浏览器，可以添加支持如下：

```
// This adds 'placeholder' to the items listed in the jQuery .support object. 
jQuery(function() {
    jQuery.support.placeholder = false;
    test = document.createElement('input');
    if ('placeholder' in test) jQuery.support.placeholder = true;
});

$(function() {
    // add placeholder support to browsers that wouldn't otherwise support it. 
    if (!$.support.placeholder) {
        var active = document.activeElement;
        $(':text,:password').focus(function() {
            if ($(this).attr('placeholder') != '' && $(this).val() == $(this).attr('placeholder')) {
                $(this).val('').removeClass('hasPlaceholder');
            }
        }).blur(function() {
            if ($(this).attr('placeholder') != '' && ($(this).val() == '' || $(this).val() == $(this).attr('placeholder'))) {
                $(this).val($(this).attr('placeholder')).addClass('hasPlaceholder');
            }
        });

        $(':text,:password').blur();
        $(active).focus();
        $('form:eq(0)').submit(function() {
            $(':text.hasPlaceholder,:password.hasPlaceholder').val('');
        });
    }
});​ 
```

此代码源自这里：[http ://www.cssnewbie.com/example/placeholder-support/](http://www.cssnewbie.com/example/placeholder-support/)

我对其进行了修改以支持密码字段（尽管它们只是显示为 *）并且一直在成功使用它。我喜欢它，因为我只使用 HTML`placeholder`属性，而且一切都很好。

希望这可以帮助！

# python - 我应该安装我的 Python 模块吗？

> ID：10761521
> 
> 赞同：2
> 
> 时间：2012-05-25T21:22:27.763
> 
> 标签：python, web2py, python-module

我通常不会费心安装 Python 模块。我使用 web2py，然后将它们转储到模块文件夹中并让它处理本地导入。它似乎总是最直接的做事方式——在系统范围级别处理依赖关系从来没有感觉正确，也从来没有觉得弄乱了虚拟环境。

在[我的其他一个问题](https://stackoverflow.com/a/10761118/165673)上，回答者说

> 一般来说，第 3 方模块的最佳实践是通过 pip 或 easy_install（最好在 virtualenv 中）安装它们，如果它们在 PyPI 上可用，而不是将它们复制到 PYTHONPATH 的某个位置。... [因为] 运行安装可执行脚本、构建 C 扩展等所需的安装脚本钩子，这不是通过仅复制模块来完成的。

我不完全明白这一点。我一直认为这更像是一种偏好，但安装 3rd 方模块确实是更好的做法吗？我不这样做是否可能会导致问题？使用像 web2py 这样的框架有什么不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:28:45.560

这取决于模块以及您要使用它的目的。一些软件包附带有用的命令行工具，只有在您正确安装它们时才能使用。

相反，如果您正在编写要分发到您没有太多控制权的环境的代码，您通常*必须*在项目中本地保留代码副本，因为目标环境可能没有包。 . web 项目通常属于这一类，当然，这取决于您的服务环境。

# html - XSL 处理顺序

> ID：10761524
> 
> 赞同：3
> 
> 时间：2012-05-25T21:23:03.143
> 
> 标签：html, xml, xslt

我很难在 SO 或其他地方找到一个准确而简单的答案：

在 XSL 文件中，您如何知道哪个模板将首先被处理，第二个，等等？我读到它是按 XPath 的具体程度排序的。此外，XSL 1.0 与 2.0 有区别吗？

最后，这是一个我正在玩弄的有缺陷的 XSL 文件。目前输出只是标题“目录”。我也会在此处附上 XML。

```
<xsl:template match="/">
    <h1>
        <xsl:text>Table of Contents</xsl:text>
    </h1>
</xsl:template>

<xsl:template match="heading1">
    <h2>
        <xsl:value-of select="."/>
    </h2>
</xsl:template>

<p>
    <xsl:text>This document contains </xsl:text>
    <xsl:value-of select="count(/article/body/heading1)"/>
    <xsl:text> chapters. </xsl:text>
</p> 
```

和 XML：

```
<article>
<title>
    Creating output
</title>
<body>
    <heading1>Generating text</heading1>
    <heading1>Numbering things</heading1>
    <heading1>Formatting numbers</heading1>
    <heading1>Copying nodes from the input document to the output</heading1>
    <heading1>Handling whitespace</heading1>
</body> 
```

关于为什么没有显示所有内容的任何解释？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:29:17.920

这是正在发生的事情：

1.  XSLT 处理器读取 XML 的根元素
2.  然后它在样式表中查看匹配的内容。它会找到您的第一个模板
3.  它执行第一个模板。
4.  第一个模板说要输出文本，然后什么也不做，所以 XSLT 处理器继续处理下一个输入元素....但是您已经处理了整个根节点，因此没有更多的输入节点在同一等级。完成。

您需要做的是`<xsl:apply-templates/>`在第一个模板中放置一个。当处理器遇到这种情况时，它会重新开始，但这次上下文是根*内的二级节点列表。*它将依次查看每个 XML 节点，在您的样式表中找到最匹配的模板，然后执行它。

这是一个关键概念——模板不受控制，也不是程序化的。

# iphone - 扩展多行 UILabel

> ID：10761526
> 
> 赞同：6
> 
> 时间：2012-05-25T21:23:13.663
> 
> 标签：iphone, objective-c, ios, xcode

在我的 iPhone 应用程序中，我有一个多行标签，我想使用“更多”按钮来扩展/收缩。像这样：

```
Lorem ipsum dolor sit amet, consectetur 
adipiscing elit. Donec fringilla, turpis 
in porttitor imperdiet, eros turpis...

                                "<More>" 
```

应该动画成这样：

```
Lorem ipsum dolor sit amet, consectetur 
adipiscing elit. Donec fringilla, turpis 
in porttitor imperdiet, eros turpis laoreet 
magna, id tempor ante lorem pulvinar lacus.
Duis vitae nisl quis sapien dictum pellentesque.

                                "<Less>" 
```

我试图获得一种效果，即随着标签的增长，每条线都单独显示，然后随着标签的缩小单独隐藏。生长效果很好，但在收缩动画期间它会跳到 3 行。有任何想法吗？下面的代码和属性：

* * *

成长动画：

```
[UIView animateWithDuration:0.5 animations:^{
        view.frame = CGRectMake(startFrame.origin.x, startFrame.origin.y, startFrame.size.width, startFrame.size.height + 40.0);
    }]; 
```

收缩动画：

```
[UIView animateWithDuration:0.5 animations:^{
        view.frame = CGRectMake(startFrame.origin.x, startFrame.origin.y, startFrame.size.width, startFrame.size.height - 40.0);
    }]; 
```

UILabel 属性：

*   行数：0
*   换行符：截断尾部
*   内容模式：顶部

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-15T12:20:21.887

您可以通过使用自动布局约束并将 numberOfLines 从 3 修改为 0 来设置动画。（0 是一个特殊值，表示显示任意数量的行）。

标签具有固有大小，当您修改 numberOfLines 时会发生变化，这些大小会影响约束。代码如下所示：

```
@IBAction func buttonTapped(sender: UIButton) {
  let numberOfLines = label.numberOfLines == 0 ? 3 : 0
  label.numberOfLines = numberOfLines
  let newTitle = numberOfLines == 0 ? "Less" : "More"    
  sender.setTitle(newTitle, forState: .Normal)
  UIView.animateWithDuration(0.5) { self.view.layoutIfNeeded() }
} 
```

您需要告诉包含标签和按钮的视图，它需要在动画块中进行布局。

[![在此处输入图像描述](../Images/c4892ba268b5ad9f4d16efdda771ce9d.png)](https://i.stack.imgur.com/tk5aF.gif)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T14:55:18.117

动画 UILabel 的结果与您描述的相似，只有缩小的动画有效，而增长的动画则跳到了完整尺寸。

我也尝试了 UITextView，但这也不起作用。

我的解决方案是取另一个 UIView，命名为 coverView，并将其放在 UILabel 下。当 UILabel 展开时，它会在没有动画的情况下调整大小，coverView 隐藏展开的部分，然后在动画中修改 coverView 的 origin.y 和 size.height 以显示展开的 UILabel。当UILabel收缩时，会在动画中修改coverView的origin.y和size.height，逐渐隐藏UILabel。在动画的完成块中，UILabel 的框架被调整为收缩尺寸。

我为此创建了一个自定义 UIView：AnimatedLabel。您可以在下面找到完整的代码。我写的很快，没有评论，但应该不难理解。

如何使用它（也适用于 IB）：

```
// Init
AnimatedLabel *animLabel = [[AnimatedLabel alloc] initWithFrame:/*desired CGRect*/];

// Set the surroundingBackgroundColor, this color will be used for the coverView
// you should set it to the container view's backgroundColor
// IMPORTANT: transparency is not supported! (if its transparent you'll see the UILabel)
animLabel.surroundingBackgroundColor = self.view.backgroundColor;

// Set the text
animLabel.label.text = /*text text text ...*/;

// Call sizeToFit to modify the label's size to fit the text perfectly
// so that the text is not moved after the label is expanded (UILabel always
// centers the text vertically and if the label
// is not resized you will see that the text is repositioned after the animation)
[animLabel sizeToFit];

// Open the label
[animLabel open];

// Close the label
[animLabel close];

// You can resize the animLabel and the subviews will be correctly resized
animLabel.frame = /*CGRect*/; 
```

动画标签.h

```
//
//  AnimatedLabel.h
//  labeltest
//
//  Created by Alpar Szotyori on 20/06/2012.
//  Use it, modify it, improve it, share it!
//

#import <UIKit/UIKit.h>

@interface AnimatedLabel : UIView

@property (nonatomic, strong) UILabel *label;
@property (nonatomic, strong) UIColor *surroundingBackgroundColor;
@property (nonatomic) BOOL isOpen;

// Public methods

- (void)open;
- (void)close;

@end 
```

动画标签.m：

```
//
//  AnimatedLabel.m
//  labeltest
//
//  Created by Alpar Szotyori on 20/06/2012.
//  Use it, modify it, improve it, share it!
//

#import "AnimatedLabel.h"

@interface NSString (visibleText)

- (NSString*)stringVisibleInRect:(CGRect)rect withFont:(UIFont*)font constrainedToSize:(CGSize)size;

@end

@implementation NSString (visibleText)

- (NSString*)stringVisibleInRect:(CGRect)rect withFont:(UIFont*)font constrainedToSize:(CGSize)size
{
    BOOL addEllipse = NO;
    NSString *visibleString = @"";
    for (int i = 2; i <= self.length; i++)
    {
        NSString *testString = [self substringToIndex:i];
        CGSize stringSize = [testString sizeWithFont:font constrainedToSize:size];
        if (stringSize.height > rect.size.height || stringSize.width > rect.size.width) {
            addEllipse = YES;
            break;
        }

        visibleString = testString;
    }

    if (addEllipse) {
        if (visibleString.length >= 3) {
            visibleString = [[visibleString substringToIndex:visibleString.length - 3] stringByAppendingString:@"…"];
        }
    }

    return visibleString;
}

@end

@interface AnimatedLabel()

@property (nonatomic, strong) UIView *coverView;
@property (nonatomic, strong) UIColor *backgrndColor;
@property (nonatomic) CGFloat origLabelHeight;
@property (nonatomic, strong) NSString *origLabelText;
@property (nonatomic) BOOL animating;
@property (nonatomic) BOOL labelKVOSet;

- (void)changeHeight:(CGFloat)height animated:(BOOL)animated;
- (void)addKVOToLabel;
- (void)removeKVOFromLabel;

@end

@implementation AnimatedLabel

#pragma mark - Properties

@synthesize label;
@synthesize surroundingBackgroundColor = i_surroundingBackgroundColor;
@synthesize isOpen;

- (void)setSurroundingBackgroundColor:(UIColor *)surroundingBackgroundColor {
    i_surroundingBackgroundColor = surroundingBackgroundColor;
    self.coverView.backgroundColor = i_surroundingBackgroundColor;
}

#pragma mark - Initialization

- (id)initWithCoder:(NSCoder *)aDecoder {
    self = [super initWithCoder:aDecoder];
    if (self) {
        self.label = [[UILabel alloc] initWithFrame:CGRectMake(0.0, 0.0, self.frame.size.width, self.frame.size.height)];
        self.label.numberOfLines = 0;
        self.label.backgroundColor = self.backgrndColor;
        self.origLabelHeight = self.label.frame.size.height;
        [self addKVOToLabel];

        self.coverView = [[UIView alloc] initWithFrame:CGRectZero];
        self.coverView.backgroundColor = [UIColor whiteColor];

        [self addSubview:self.label];
        [self addSubview:self.coverView];

        self.animating = NO;
        self.isOpen = NO;
    }
    return self;
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        self.label = [[UILabel alloc] initWithFrame:CGRectMake(0.0, 0.0, frame.size.width, frame.size.height)];
        self.label.numberOfLines = 0;
        self.label.backgroundColor = self.backgrndColor;
        self.origLabelHeight = self.label.frame.size.height;
        [self addKVOToLabel];

        self.coverView = [[UIView alloc] initWithFrame:CGRectZero];
        self.coverView.backgroundColor = [UIColor whiteColor];

        [self addSubview:self.label];
        [self addSubview:self.coverView];

        self.animating = NO;
        self.isOpen = NO;
    }
    return self;
}

#pragma mark - Overriden methods

- (void)setFrame:(CGRect)frame {
    if (!self.animating && self.isOpen) {
        self.isOpen = NO;
        [self changeHeight:self.origLabelHeight animated:NO];
        frame.size.height = self.origLabelHeight;
    }

    [super setFrame:frame];

    if (!self.animating) {        
        self.label.frame= CGRectMake(0.0, 0.0, frame.size.width, frame.size.height);
        self.origLabelHeight = self.label.frame.size.height;

        [self removeKVOFromLabel];

        NSString *visibleText = [self.origLabelText stringVisibleInRect:self.label.frame withFont:self.label.font constrainedToSize:CGSizeMake(frame.size.width, LONG_MAX)];
        self.label.text = visibleText;
        [self.label sizeToFit];

        [self addKVOToLabel];
    }
}

- (void)setBackgroundColor:(UIColor *)backgroundColor {
    [super setBackgroundColor:[UIColor clearColor]];

    self.backgrndColor = backgroundColor;

    self.label.backgroundColor = self.backgrndColor;
}

- (UIColor *)backgroundColor {
    return self.backgrndColor;
}

- (void)sizeToFit {
    [self removeKVOFromLabel];

    NSString *visibleText = [self.origLabelText stringVisibleInRect:self.label.frame withFont:self.label.font constrainedToSize:CGSizeMake(self.frame.size.width, LONG_MAX)];
    self.label.text = visibleText;
    [self.label sizeToFit];
    self.origLabelHeight = self.label.frame.size.height;

    [self addKVOToLabel];

    self.frame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.label.frame.size.width, self.label.frame.size.height);
}

#pragma mark - KVO methods

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
     if ([keyPath isEqualToString:@"text"]) {
         self.origLabelText = [change objectForKey:NSKeyValueChangeNewKey];
     }
}

#pragma mark - Public methods

- (void)open {
    self.origLabelHeight = self.label.frame.size.height;
    [self removeKVOFromLabel];
    self.label.text = self.origLabelText;
    [self addKVOToLabel];
    [self.label sizeToFit];

    if (self.origLabelHeight == self.label.frame.size.height) {
        return;
    }

    [self changeHeight:self.label.frame.size.height animated:YES];
    self.isOpen = YES;
}

- (void)close {
    if (self.frame.size.height == self.origLabelHeight) {
        return;
    }

    [self changeHeight:self.origLabelHeight animated:YES];
    self.isOpen = NO;
}

#pragma mark - Private methods

#pragma mark - Properties

@synthesize coverView, backgrndColor, origLabelHeight, origLabelText, animating, labelKVOSet;

#pragma mark - Methods

- (void)changeHeight:(CGFloat)height animated:(BOOL)animated {
    if (self.frame.size.height == height) {
        return;
    }

    if (height > self.frame.size.height) {
        self.animating = YES;

        [self.label sizeToFit];
        height = self.label.frame.size.height;

        self.coverView.frame = CGRectMake(0.0, self.frame.size.height, self.frame.size.width, height - self.frame.size.height);
        self.frame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.frame.size.width, height);
        self.label.frame = CGRectMake(0.0, 0.0, self.frame.size.width, self.frame.size.height);

        if (animated) {
            [UIView animateWithDuration:0.5 animations:^(){
                self.coverView.frame = CGRectMake(0.0, self.frame.size.height, self.frame.size.width, 0.0); 
            } completion:^(BOOL completed){
                self.animating = NO;
            }];
        } else {
            self.coverView.frame = CGRectMake(0.0, self.frame.size.height, self.frame.size.width, 0.0); 
            self.animating = NO;
        }
    } else {
        self.animating = YES;

        if (animated) {
            [UIView animateWithDuration:0.5 animations:^(){
                self.coverView.frame = CGRectMake(0.0, height, self.frame.size.width, self.frame.size.height - height);
            } completion:^(BOOL completed){
                self.frame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.frame.size.width, height);
                self.coverView.frame = CGRectMake(0.0, height, self.frame.size.width, 0.0);
                self.label.frame = CGRectMake(0.0, 0.0, self.frame.size.width, height);
                self.animating = NO;
            }];
        } else {
            self.frame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.frame.size.width, height);
            self.coverView.frame = CGRectMake(0.0, height, self.frame.size.width, 0.0);
            self.label.frame = CGRectMake(0.0, 0.0, self.frame.size.width, height);
            self.animating = NO;            
        }
    }
}

- (void)addKVOToLabel {
    if (self.label == nil) {
        return;
    }

    if (!self.labelKVOSet) {
        self.labelKVOSet = YES;
        [self.label addObserver:self forKeyPath:@"text" options:NSKeyValueObservingOptionNew context:nil];
    }
}

- (void)removeKVOFromLabel {
    if (self.label == nil) {
        return;
    }

    if (self.labelKVOSet) {
        self.labelKVOSet = NO;
        [self.label removeObserver:self forKeyPath:@"text"];
    }
}

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T15:11:38.643

我在尝试使视图增大/缩小时遇到了类似的问题。这是我的[SO](https://stackoverflow.com/questions/10776100/animate-uiview-grow-shrink)帖子。基本上我必须动画框架来增长，然后边界/中心缩小。我知道有点尴尬，但我得到了我想要的效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T03:55:48.707

问题不在您发布的代码中。需要更多信息来解决此问题。我建议您检查以下内容：

1.  您正在调整大小的视图对象是正确的。
2.  为您正在调整大小的视图对象添加彩色背景，以便能够实时查看其大小如何变化。

如果这没有帮助，请发布执行您发布的这些动画片段的完整方法。

# asp.net-mvc-3 - 创建模型时将执行计算的属性

> ID：10761528
> 
> 赞同：1
> 
> 时间：2012-05-25T21:23:24.907
> 
> 标签：asp.net-mvc-3, entity-framework-4

我在我的模型类中定义了以下计算属性，并将其定义为只有获取（没有设置）：-

```
public partial class Visit : IValidatableObject
{
    public int AgeInYears
    {
        get
        {
            int years = Date.Year - Patient.DateOfBirth.Year;

            if (Date.Month < Patient.DateOfBirth.Month || (Date.Month == Patient.DateOfBirth.Month && Date.Day < Patient.DateOfBirth.Day))
            { 
                years--; 
            }
            return years;
        }
    }
} 
```

但是，如果我尝试添加新访问，则会在

```
int years = Date.Year - Patient.DateOfBirth.Year; 
```

但是我的问题是为什么 AgeInYears 属性在我创建一个新的访问对象时被执行，尽管我将它定义为`get;`out `set;`，所以它应该只在我显式调用它时执行？

**::::Updated::::** 导致错误的发布操作方法如下所示：-

```
[HttpPost]
public ActionResult Create(Visit visit)
{
    if (ModelState.IsValid)
    {
        if (Roles.IsUserInRole(visit.DoctorID, "Doctor"))
        {
            visit.StatusID = repository.GetVisitStatusByDescription("Assinged");
            visit.CreatedBy = User.Identity.Name;
            visit.Date = DateTime.Now;

            repository.AddVisit(visit);
            repository.Save();
            return RedirectToAction("Index");  
        }
        else
        {
            return View("NotFound");
        }
    }
} 
```

**::::第二次更新::::** 我的 Get 操作方法如下所示：-

```
public ActionResult Create(int patientid)
{
    Visit visit = new Visit();
    visit.PatientID = patientid;
    visit.CreatedBy = User.Identity.Name;
    visit.Date = DateTime.Now;

    return View(visit);
} 
```

# c# - 将上下文中的通用列表传递给通用处理程序 ashx

> ID：10761533
> 
> 赞同：0
> 
> 时间：2012-05-25T21:23:47.153
> 
> 标签：c#, asp.net

我可以通过 HttpContext 将我的通用列表传递给我的通用处理程序吗？

```
protected void BtnExportCSV_Click(object sender, EventArgs e)
{
    List<Product> products = BLL.GetProducts();
    HttpContext.Current.Items["products"] = products;

    Response.Redirect("ToCsvHelper.ashx", false);

} 
```

当它到达处理程序时它为空。那么以某种方式在通用处理程序中重新生成产品列表的更好方法是什么？如果我希望它不仅可用于产品列表怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:30:58.103

当您调用 Redirect() 时，当前请求与 HttpContext 一起终止。要在请求之间保留数据，请使用会话或直接在 url 中传递参数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:31:35.280

HttpContext 生命周期是单个请求， Redirect 执行客户端重定向，因此您有 2 个请求。

您可以使用会话状态来传递此类数据，或查看状态，或每次查询。

静态数据（不是每个用户）可以通过应用程序级缓存（或静态成员，这也不是一个好主意）共享。

# ruby-on-rails-3 - Capistrano 使用 sudo 甚至使用“set :use_sudo, false”

> ID：10761534
> 
> 赞同：7
> 
> 时间：2012-05-25T21:23:50.430
> 
> 标签：ruby-on-rails-3, capistrano, sudo, rvm-capistrano

我不希望将 sudo 用于通过 Capistrano 远程执行的任何命令。具体来说，当我运行时`cap deploy:setup`，我在第一个`mkdir`命令期间被要求输入我的 sudo 密码。我添加`set :use_sudo, false`到了 deploy.rb 文件中，但这并没有什么不同。

我从一个相当完整的 deploy.rb 文件开始，但是一旦我开始遇到问题就将其缩减。这是我的最小版本，仍然`use_sudo`没有得到尊重：

```
# App Definitions

set :domain, '[server-ip]'
role :app, domain
role :web, domain
role :db, domain, :primary => true

set :user, "my_app"
set :use_sudo, false

task :sudo_test do
  run "#{try_sudo} whoami"
end 
```

运行`cap sudo_test`导致我被提示输入我的 sudo 密码。我在这里缺少什么（除了我已经拔掉的头发）？

**谷歌调查结果**

[https://groups.google.com/forum/?fromgroups#!topic/capistrano/QNYnvW8obrg](https://groups.google.com/forum/?fromgroups#!topic/capistrano/QNYnvW8obrg)

与有类似问题的人的线程。线程中没有任何结论/解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T23:32:14.100

对于遇到这个问题并且像我这样的傻瓜的其他人。确保你没有引用错误。我有：

```
set :use_sudo, "false" 
```

当我把它切换到

```
set :use_sudo, false 
```

大多数事情开始按我预期的方式工作。正如 YWCA Hello 指出的那样，仍有一些命令忽略了 use_sudo 设置。但是，不要忘记正确设置它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T16:53:30.693

显然，无法通过某些 capistrano 任务禁用 sudo 功能。假设是服务器上的非特权用户不应该能够执行某些任务。

有问题的命令是`mkdir`. 我认为，如果父文件夹是他们有权执行此操作的文件夹，那么非特权用户应该能够运行此命令。我还认为该用户实际上可能是特权用户，例如 root。最佳实践？不必要。在某些部署的合理范围内，是的。

这是对我原始问题的回复的链接：

[https://github.com/capistrano/capistrano/issues/211#issuecomment-7667467](https://github.com/capistrano/capistrano/issues/211#issuecomment-7667467)

# linux - Bash脚本从一行复制并用副本替换另一行

> ID：10761535
> 
> 赞同：0
> 
> 时间：2012-05-25T21:23:59.133
> 
> 标签：linux, perl, bash, maven, sed

我希望为比通常通过 sed 查找/替换稍微复杂的东西编写一个 bash 脚本。我有一本名为 bash Cookbook 的书，我一直试图从中获得一些灵感，但我并没有走得太远。

基本上我正在尝试编写一个脚本来自动更新一堆 maven pom.xml 文件中的版本号。这是我正在查看的一般设置：

```
<!-- TEMPLATE:BEGIN
    <version>@@VERSION@@</version>
-->
    <version>1.0.0</version>
<!-- TEMPLATE:END --> 
```

运行脚本（使用新版本号 1.0.1）后，我希望文件改为读取：

```
<!-- TEMPLATE:BEGIN
    <version>@@VERSION@@</version>
-->
    <version>1.0.1</version>
<!-- TEMPLATE:END --> 
```

所以这将在实际发布的 pom 文件中，1.0.0 是当前版本（我试图用 1.0.1 或其他东西替换它）。显然版本号会发生变化，所以没有一个很好的方法来查找/替换（因为你想要找到的东西是可变的）。我希望能够编写一个 bash 脚本

1.  将@@VERSION@@ 替换为实际的版本号
2.  删除当前版本行
3.  在 TEMPLATE:END 之前的行上写入更新的版本行（同时在文件中保留 @@VERSION@@ - 可能通过将模板写入临时文件，进行替换，然后返回来做到这一点？）

我可以使用 ant 脚本 a la 做一些*这样*的事情（写出一个新文件，做替换）
`<replace file="pom.xml">
<replacefilter token="@@VERSION@@" value="${version}"/>
</replace>`

但我不确定a.）删除旧版本的行或b.）告诉它在正确的位置复制新行的最佳方法是什么。任何人都知道如何做到这一点或有任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:44:25.007

假设新版本号在 shell 变量`$VERSION`中，那么您应该能够使用：

```
sed -e '/<!-- TEMPLATE:BEGIN/,/<!-- TEMPLATE:END -->/{
        s/<version>[0-9][0-9]*\.[0-9][0-9]*\.[0-9][0-9]*<\/version>/<version>'$VERSION'<\/version>/
        }' 
```

请注意，这将忽略带有 的模板版本行`@@VERSION@@`，但仅匹配出现在包含 TEMPLATE:BEGIN 和 TEMPLATE:END 的行之间的由三部分组成的版本号，而将其他所有内容（包括包含`<version>...</version>`元素的其他行）单独保留。

您可以决定如何进行文件覆盖（也许您的版本`sed`来自 GNU，它会根据请求自动执行该`-i`选项）等。您还可以使用更强大的正则表达式符号来实现更紧凑的匹配。但是，这应该适用于大多数版本而`sed`无需更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:44:48.110

您概述的步骤（1-3）看起来好像您实际上并不关心根据注释中定义的模板化规则执行替换。

因此，这里有一些代码，其行为与您概述的一样：

```
#!/bin/bash

file=$1
newversion=$2

sed -i $file -e "s|<version>\([^@]*\)</version>|<version>$newversion</version>|" 
```

运行：

```
chmod +x yourscript.sh
./yourscript.sh filetoupdate.xml 1.0.1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:53:23.853

```
use 5.010;
use strictures;
use Perl::Version qw();
use XML::LibXML qw();

my $dom = XML::LibXML->load_xml(location => 'pox.xml');

for my $node ($dom->findnodes('//version')) {
    my $version = Perl::Version->new($node->textContent);
    $version->inc_subversion;
    $version->stringify;
    $node->removeChildNodes;
    $node->appendText($version);
};

say $dom->toString; 
```

# python - 如何登录电子邮件帐户，并使用 Ruby（或 Python）检查最近发送的电子邮件的主题？

> ID：10761542
> 
> 赞同：0
> 
> 时间：2012-05-25T21:25:10.667
> 
> 标签：python, ruby, email, screen-scraping, web-scraping

基本上，我正在尝试编写一个程序，我需要登录到我的电子邮件帐户并检查最近发送的电子邮件的标题。

就这类东西而言，我是一个完全的新手，并且更喜欢用 Ruby 进行编程。如果这会使任务更容易，我也有一些 Python 技能。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:31:42.953

Python`imaplib`库的文档包括[一个示例](http://docs.python.org/library/imaplib.html#imap4-example)，该示例几乎可以做到：

```
import getpass, imaplib

M = imaplib.IMAP4()
M.login(getpass.getuser(), getpass.getpass())
M.select()
typ, data = M.search(None, 'ALL')
for num in data[0].split():
    typ, data = M.fetch(num, '(RFC822)')
    print 'Message %s\n%s\n' % (num, data[0][1])
M.close()
M.logout() 
```

您可以将搜索字符串从修改`'ALL'`为例如`(since "24-May-2012")`。我认为 IMAP 不支持按时间搜索；您可能必须自己进行过滤。

# xcode - 推送 Uiview 并填充数据

> ID：10761547
> 
> 赞同：0
> 
> 时间：2012-05-25T21:25:29.243
> 
> 标签：xcode, uitableview, uistoryboardsegue

我正在创建一个简单的应用程序，它将数据存储到 sqlite 数据库并从中检索数据。我能够存储数据，还能够用所有数据填充 UITableView，在原型单元格中显示一个字段（名称）。我现在要做的是打开一个点击视图以显示所有细节。所以我确实设置了一个需要填写 3 个字段的 viewController，但我不知道如何在该单元格之间将数据传输到新视图。

这是我的代码：

```
#import "RootViewController.h"
#import "AppDelegate.h"
#import "Inserimento_Esame.h"
#import "Dettagli_Esame.h"

@interface RootViewController ()

@end

@implementation RootViewController

@synthesize nome,crediti,voto;

- (id)initWithStyle:(UITableViewStyle)style
{
self = [super initWithStyle:style];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
NSString *docsDir;
NSArray *dirPaths;
dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, 
YES);
docsDir = [dirPaths objectAtIndex:0];

databasePath = [[NSString alloc] initWithString: [docsDir stringByAppendingPathComponent: 
@"Esami.sqlite"]];
dataList = [[Data alloc] init:databasePath];

}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:   
(UIInterfaceOrientation)interfaceOrientation
{return YES;}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
return [dataList getSize];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath 
*)indexPath
{
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle   
reuseIdentifier:CellIdentifier];
}

NSDictionary *itemAtIndex = (NSDictionary *)[dataList objectAtIndex:indexPath.row];
cell.textLabel.textColor = [UIColor whiteColor];
cell.textLabel.text = [itemAtIndex objectForKey:@"nome"];
cell.detailTextLabel.textColor = [UIColor whiteColor];
cell.detailTextLabel.text = [itemAtIndex objectForKey:@"voto"];
return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath 
*)indexPath {

[self performSegueWithIdentifier:@"DETTAGLI" sender:indexPath]; 

}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
if ([[segue identifier] isEqualToString:@"DETTAGLI"])  {
    NSLog(@"Dettagli");
    Dettagli_Esame *destination = [segue destinationViewController];
    NSIndexPath * myIndexPath = [self.tableView indexPathForSelectedRow];
    NSDictionary *itemAtIndex = (NSDictionary *)[dataList objectAtIndex:myIndexPath.row];
    destination.Dett = itemAtIndex;

 // I THINK I MUST PUT HERE MY MISSING CODE

}
}
@end

EDIT3

#import "Dettagli_Esame.h"

@interface Dettagli_Esame ()

@end

@implementation Dettagli_Esame
@synthesize nome;
@synthesize crediti;
@synthesize voto;
@synthesize Dett;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{[super viewDidLoad];}

EDIT5-6:

-(void)viewDidAppear:(BOOL)animated{
NSString *docsDir;
NSArray *dirPaths;
NSLog(@"Dettagli Esame");

dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask,   
YES);
docsDir = [dirPaths objectAtIndex:0];

databasePath = [[NSString alloc] initWithString: [docsDir stringByAppendingPathComponent: 
@"Esami.sqlite"]];
dataList = [[Data alloc] init:databasePath];
nome.text = [Dett objectForKey:@"nome"];
crediti.text = [Dett objectForKey:@"crediti"];
voto.text = [Dett objectForKey:@"voto"];
NSLog(@"Dettagli Esame: %@", self.Dett);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:36:37.100

你似乎走在正确的轨道上。所需的信息`destination`与您用来填充单元格的信息相同（实际上，您说的是 3 个字段，但我假设它们都在同一个字典中），所以：

```
NSDictionary *itemAtIndex = (NSDictionary *)[dataList objectAtIndex:myIndexPath.row]; 
```

然后你需要`NSDictionary`在类中创建一个属性`Dettagli_Esame`并分配它，比如：

```
destination.displayDictionary = itemAtIndex; 
```

这些行将转到您指示“缺少代码”的位置。

# delphi - 更改密码 Delphi v7

> ID：10761549
> 
> 赞同：1
> 
> 时间：2012-05-25T21:25:33.440
> 
> 标签：delphi, passwords, delphi-7

德尔福 v7

此代码旨在允许用户更改其密码。它似乎正确执行，但新密码未保存在密码数据字段中。我一定做错了什么，但我看不到。

```
procedure TForm4.btnPswordClick(Sender: TObject);
var
  I: integer;
begin
tblLogin.First;;
for I := 0 to tblLogin.RecordCount  do
Begin
If tblLogin.FieldByName('Username').Value = Edit1.Text then
if tblLogin.FieldByName('Password').Value = Edit2.Text  then
sign2.Visible := True; //Test in this case tells the application to make Label1  
visible if the //username and password are correct
tblLogin.Next;
end;
I:= I+1;  //ends search loop of records so program can move on
If sign2.Visible = False then
begin
MessageDlg('Error Username, or Password not correct',
mtConfirmation, [mbCancel], 0);
end
else
if edit3.Text <> edit4.Text  then
begin
MessageDlg('Error New Password does not match',
mtConfirmation, [mbCancel], 0);
end
else
begin
tblLogin.Edit;
tblLogin.FieldByName('Password').Value := Edit3.Text;
tblLogin.Post;
//form1.Show;
//form4.Close;
end; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T21:42:31.403

我对格式化代码的评论只是我在开玩笑，但实际上我认为它确实*会*帮助你自己找到错误。正确缩进，你的第一个循环是这样的：

```
tblLogin.First;;
for I := 0 to tblLogin.RecordCount  do
Begin
  If tblLogin.FieldByName('Username').Value = Edit1.Text then
    if tblLogin.FieldByName('Password').Value = Edit2.Text  then
      sign2.Visible := True; //Test in this case tells the application to make Label1 visible if the
                             //username and password are correct
  tblLogin.Next;
end; 
```

下一行代码是这样的：

```
I:= I+1;  //ends search loop of records so program can move on 
```

该注释表明您希望该行导致循环终止。但那条线*不在循环中*。如果它在循环中，您的代码将永远不会编译，因为您不允许在循环内修改循环控制变量。即使在循环之外，编译器也应该警告您当前的值`I`是未定义的。这是因为一旦循环终止，编译器就不能保证循环控制变量的最终值。将 1 添加到未定义的值仍然是未定义的值。

此外，您的循环迭代的记录多于数据库表包含的记录。如果循环的上限`for`没有减去 1 并且不是`High`or的结果`Pred`，那么您*可能*做错了什么。

由于您的`I+1`行实际上并未终止循环，因此您最终会一直遍历到表的末尾，因此当您调用 时`tblLogin.Edit`，您将*最终*记录置于编辑模式，而不是具有匹配帐户详细信息的记录。

修复缩进也会表明您甚至没有包含该函数的所有代码。有一个`begin`没有匹配的`end`地方。

您可以通过在数据库上使用单个`UPDATE`语句来避免所有这些代码：

```
UPDATE tblLogin SET Password = ? WHERE Username = ? AND Password = ? 
```

# asp.net-mvc - 如何从 FilterAttribute 中获取当前 Url？

> ID：10761551
> 
> 赞同：50
> 
> 时间：2012-05-25T21:25:42.287
> 
> 标签：asp.net-mvc, url, authorization, action-filter, actionfilterattribute

我正在编写一个授权过滤器属性和我无法弄清楚如何将当前 url 作为字符串获取，因此我可以将其作为参数传递给 LogOn 操作。目标是如果用户成功登录，他们将被重定向到他们最初尝试访问的页面。

```
public override void OnAuthorization(AuthorizeContext filterContext)
{
    base.OnAuthorization(filterContext);

    ... my auth code ...
    bool isAuth ;
    ... my auth code ...

    if(!isAuth)
    {
        filterContext.Result = new RedirectToRouteResult(
            new RouteValueDictionary { 
                { "Area", "" }, 
                { "Controller", "Account" }, 
                { "Action", "LogOn" },
                { "RedirectUrl", "/Url/String/For/Currnt/Request" } // how do I get this?
            }
        );
    }
} 
```

如何从当前请求中获取完整的字符串 Url？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-05-25T21:30:40.930

尝试：

```
var url = filterContext.HttpContext.Request.Url; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-26T13:00:36.610

要获得完整`URL`，您可以按照建议的方式尝试，`@rboarman`但通常`RedirectUrl`将是**相对 url**，为此您必须尝试对象的`RawUrl`属性`Request`。

```
filterContext.HttpContext.Request.Url  ===> http://somesite.com/admin/manage

filterContext.HttpContext.Request.RawUrl ====> /admin/manage 
```

**编辑：修复了第二个示例**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-04T08:53:37.250

在我的具体情况下，我在`UrlReferrer`URL 之后。

```
filterContext.HttpContext.Request.UrlReferrer 
```

这让我在尝试访问他无权访问的操作之前将用户重定向回他所在的页面。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-05-04T14:38:48.693

这是 Google 上排名最高的结果，所以在 Asp.net Core 2.0 中我就是这样做的：

```
context.HttpContext.Request.Url(); 
```

使用此扩展方法：

```
/// <summary>
/// Returns the absolute url.
/// </summary>
public static string Url(this HttpRequest request)
{
    return $"{request.Scheme}://{request.Host}{request.Path}{request.QueryString}";
} 
```

# ruby-on-rails - Ruby on Rails - 时间

> ID：10761555
> 
> 赞同：0
> 
> 时间：2012-05-25T21:25:52.400
> 
> 标签：ruby-on-rails, time

目前，我在 Rails 中发布内容后，时间格式为

```
<time><%= post.created_at.to_formatted_s(:day_month_year) %></time> 
```

我怎样才能让它说**“大约 6 分钟前”**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:29:14.147

```
<time><%= time_ago_in_words(post.created_at) %> ago</time> 
```

# java - 剪耳三角仪崩溃

> ID：10761556
> 
> 赞同：1
> 
> 时间：2012-05-25T21:26:08.230
> 
> 标签：java, geometry, libgdx

我正在努力解决 libgdx 的耳夹三角测量器的问题。它在某个时候进入无限循环并使整个程序崩溃。[我记录了视频](http://www.youtube.com/watch?v=3Y43KStb6cI)中发生崩溃的确切位置。

三角仪源代码：

```
/*
 * Copyright 2010 Mario Zechner (contact@badlogicgames.com), Nathan Sweet (admin@esotericsoftware.com), Nicolas Gramlich
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the
 * License. You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

package com.badlogic.gdx.math;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

/**
 * A simple implementation of the ear cutting algorithm to triangulate simple
 * polygons without holes. For more information:
 * http://cgm.cs.mcgill.ca/~godfried/teaching/cg-projects/97/Ian/algorithm2.html
 * http://www.geometrictools.com/Documentation/TriangulationByEarClipping.pdf
 * 
 * @author badlogicgames@gmail.com
 * @author Nicolas Gramlich (Improved performance. Collinear edges are now supported.)
 */
public final class EarClippingTriangulator {

  private static final int CONCAVE = 1;
  private static final int CONVEX = -1;

  private int concaveVertexCount;

  /**
   * Triangulates the given (concave) polygon to a list of triangles. The
   * resulting triangles have clockwise order. 
   * @param polygon the polygon
   * @return the triangles
   */
  public List<Vector2> computeTriangles(final List<Vector2> polygon) {
    // TODO Check if LinkedList performs better
    final ArrayList<Vector2> triangles = new ArrayList<Vector2>();
    final ArrayList<Vector2> vertices = new ArrayList<Vector2>(polygon.size());
    vertices.addAll(polygon);

    if(vertices.size() == 3) {
      triangles.addAll(vertices);
      return triangles;
    }

    while(vertices.size() >= 3) {
      // TODO Usually(Always?) only the Types of the vertices next to the ear change! --> Improve
      final int vertexTypes[] = this.classifyVertices(vertices);

      final int vertexCount = vertices.size();
      for(int index = 0; index < vertexCount; index++) {
        if(this.isEarTip(vertices, index, vertexTypes)) {
          this.cutEarTip(vertices, index, triangles);
          break;
        }
      }
    }

    return triangles;
  }

  private static boolean areVerticesClockwise(final ArrayList<Vector2> pVertices) {
    final int vertexCount = pVertices.size();

    float area = 0;
    for(int i = 0; i < vertexCount; i++) {
      final Vector2 p1 = pVertices.get(i);
      final Vector2 p2 = pVertices.get(EarClippingTriangulator.computeNextIndex(pVertices, i));
      area += p1.x * p2.y - p2.x * p1.y;
    }

    if(area < 0) {
      return true;
    } else {
      return false;
    }
  }

  /**
   * @param pVertices
   * @return An array of length <code>pVertices.size()</code> filled with either {@link EarClippingTriangulator#CONCAVE} or
   * {@link EarClippingTriangulator#CONVEX}.
   */
  private int[] classifyVertices(final ArrayList<Vector2> pVertices) {
    final int vertexCount = pVertices.size();

    final int[] vertexTypes = new int[vertexCount];
    this.concaveVertexCount = 0;

    /* Ensure vertices are in clockwise order. */
    if(!EarClippingTriangulator.areVerticesClockwise(pVertices)) {
      Collections.reverse(pVertices);
    }

    for(int index = 0; index < vertexCount; index++) {
      final int previousIndex = EarClippingTriangulator.computePreviousIndex(pVertices, index);
      final int nextIndex = EarClippingTriangulator.computeNextIndex(pVertices, index);

      final Vector2 previousVertex = pVertices.get(previousIndex);
      final Vector2 currentVertex = pVertices.get(index);
      final Vector2 nextVertex = pVertices.get(nextIndex);

      if(EarClippingTriangulator.isTriangleConvex(previousVertex.x, previousVertex.y, currentVertex.x, currentVertex.y, nextVertex.x, nextVertex.y)) {
        vertexTypes[index] = CONVEX;
      } else {
        vertexTypes[index] = CONCAVE;
        this.concaveVertexCount++;
      }
    }

    return vertexTypes;
  }

  private static boolean isTriangleConvex(final float pX1, final float pY1, final float pX2, final float pY2, final float pX3, final float pY3) {
    if(EarClippingTriangulator.computeSpannedAreaSign(pX1, pY1, pX2, pY2, pX3, pY3) < 0) {
      return false;
    } else {
      return true;
    }
  }

  private static int computeSpannedAreaSign(final float pX1, final float pY1, final float pX2, final float pY2, final float pX3, final float pY3) {
    float area = 0;

    area += pX1 * (pY3 - pY2);
    area += pX2 * (pY1 - pY3);
    area += pX3 * (pY2 - pY1);

    return (int)Math.signum(area);
  }

  /**
   * @return <code>true</code> when the Triangles contains one or more vertices, <code>false</code> otherwise.
   */
  private static boolean isAnyVertexInTriangle(final ArrayList<Vector2> pVertices, final int[] pVertexTypes, final float pX1, final float pY1, final float pX2, final float pY2, final float pX3, final float pY3) {
    int i = 0;

    final int vertexCount = pVertices.size();
    while(i < vertexCount - 1) {
      if((pVertexTypes[i] == CONCAVE)) {
        final Vector2 currentVertex = pVertices.get(i);

        final float currentVertexX = currentVertex.x;
        final float currentVertexY = currentVertex.y;

        /* TODO The following condition fails for perpendicular, axis aligned triangles! 
         * Removing it doesn't seem to cause problems. 
         * Maybe it was an optimization?
         * Maybe it tried to handle collinear pieces ? */
//        if(((currentVertexX != pX1) && (currentVertexY != pY1)) || ((currentVertexX != pX2) && (currentVertexY != pY2)) || ((currentVertexX != pX3) && (currentVertexY != pY3))) {
          final int areaSign1 = EarClippingTriangulator.computeSpannedAreaSign(pX1, pY1, pX2, pY2, currentVertexX, currentVertexY);
          final int areaSign2 = EarClippingTriangulator.computeSpannedAreaSign(pX2, pY2, pX3, pY3, currentVertexX, currentVertexY);
          final int areaSign3 = EarClippingTriangulator.computeSpannedAreaSign(pX3, pY3, pX1, pY1, currentVertexX, currentVertexY);

          if(areaSign1 > 0 && areaSign2 > 0 && areaSign3 > 0) {
            return true;
          } else if(areaSign1 <= 0 && areaSign2 <= 0 && areaSign3 <= 0) {
            return true;
          }
//        }
      }
      i++;
    }
    return false;
  }

  private boolean isEarTip(final ArrayList<Vector2> pVertices, final int pEarTipIndex, final int[] pVertexTypes) {
    if(this.concaveVertexCount != 0) {
      final Vector2 previousVertex = pVertices.get(EarClippingTriangulator.computePreviousIndex(pVertices, pEarTipIndex));
      final Vector2 currentVertex = pVertices.get(pEarTipIndex);
      final Vector2 nextVertex = pVertices.get(EarClippingTriangulator.computeNextIndex(pVertices, pEarTipIndex));

      if(EarClippingTriangulator.isAnyVertexInTriangle(pVertices, pVertexTypes, previousVertex.x, previousVertex.y, currentVertex.x, currentVertex.y, nextVertex.x, nextVertex.y)) {
        return false;
      } else {
        return true;
      }
    } else {
      return true;
    }
  }

  private void cutEarTip(final ArrayList<Vector2> pVertices, final int pEarTipIndex, final ArrayList<Vector2> pTriangles) {
    final int previousIndex = EarClippingTriangulator.computePreviousIndex(pVertices, pEarTipIndex);
    final int nextIndex = EarClippingTriangulator.computeNextIndex(pVertices, pEarTipIndex);

    if(!EarClippingTriangulator.isCollinear(pVertices, previousIndex, pEarTipIndex, nextIndex)) {
      pTriangles.add(new Vector2(pVertices.get(previousIndex)));
      pTriangles.add(new Vector2(pVertices.get(pEarTipIndex)));
      pTriangles.add(new Vector2(pVertices.get(nextIndex)));
    }

    pVertices.remove(pEarTipIndex);
    if(pVertices.size() >= 3) {
      EarClippingTriangulator.removeCollinearNeighborEarsAfterRemovingEarTip(pVertices, pEarTipIndex);
    }
  }

  private static void removeCollinearNeighborEarsAfterRemovingEarTip(final ArrayList<Vector2> pVertices, final int pEarTipCutIndex) {
    final int collinearityCheckNextIndex = pEarTipCutIndex % pVertices.size();
    int collinearCheckPreviousIndex = EarClippingTriangulator.computePreviousIndex(pVertices, collinearityCheckNextIndex);

    if(EarClippingTriangulator.isCollinear(pVertices, collinearityCheckNextIndex)) {
      pVertices.remove(collinearityCheckNextIndex);

      if(pVertices.size() > 3) {
        /* Update */
        collinearCheckPreviousIndex = EarClippingTriangulator.computePreviousIndex(pVertices, collinearityCheckNextIndex);
        if(EarClippingTriangulator.isCollinear(pVertices, collinearCheckPreviousIndex)){
          pVertices.remove(collinearCheckPreviousIndex);
        }
      }
    } else if(EarClippingTriangulator.isCollinear(pVertices, collinearCheckPreviousIndex)){
      pVertices.remove(collinearCheckPreviousIndex);
    }
  }

  private static boolean isCollinear(final ArrayList<Vector2> pVertices, final int pIndex) {
    final int previousIndex = EarClippingTriangulator.computePreviousIndex(pVertices, pIndex);
    final int nextIndex = EarClippingTriangulator.computeNextIndex(pVertices, pIndex);

    return EarClippingTriangulator.isCollinear(pVertices, previousIndex, pIndex, nextIndex);
  }

  private static boolean isCollinear(final ArrayList<Vector2> pVertices, final int pPreviousIndex, final int pIndex, final int pNextIndex) {
    final Vector2 previousVertex = pVertices.get(pPreviousIndex);
    final Vector2 vertex = pVertices.get(pIndex);
    final Vector2 nextVertex = pVertices.get(pNextIndex);

    return EarClippingTriangulator.computeSpannedAreaSign(previousVertex.x, previousVertex.y, vertex.x, vertex.y, nextVertex.x, nextVertex.y) == 0;
  }

  private static int computePreviousIndex(final List<Vector2> pVertices, final int pIndex) {
    return pIndex == 0 ? pVertices.size() - 1 : pIndex - 1;
  }

  private static int computeNextIndex(final List<Vector2> pVertices, final int pIndex) {
    return pIndex == pVertices.size() - 1 ? 0 : pIndex + 1;
  }
} 
```

上面链接的源代码中的@ 53# 行发生崩溃...
在computeTriangles 函数中的while 循环具有以下条件：while(vertices.size() >= 3) { ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-30T04:46:15.693

问题是您的多边形需要*简单*，即它不能与自身相交。javadoc 说明了这一`EarClippingTriangulator`事实。但是，在无效输入上进入无限循环是非常糟糕的行为。

也就是说，还有一些错误会导致三角测量器将一个有效的简单多边形剪辑成一个确实有自相交的多边形，从而使自己陷入无限循环。当点（几乎或完全）共线时，可能会发生这种情况。至少有两个关于此的错误报告： 我自己的[#1407](http://code.google.com/p/libgdx/issues/detail?id=1407)和 [#207](http://code.google.com/p/libgdx/issues/detail?id=207)，它被标记为已修复但可能仅在某些情况下修复。

我已经发送[了一个刚刚合并的拉取请求](https://github.com/libgdx/libgdx/pull/490)，因此 2013 年 6 月 30 日之后的任何 libgdx 版本都应该减少这些问题。

# bash - 关于 bash 脚本的快速帮助以删除大文件的行

> ID：10761557
> 
> 赞同：2
> 
> 时间：2012-05-25T21:26:12.757
> 
> 标签：bash, sed, awk

我需要从文件中删除行，而行上的内容是制表符分隔的。- 我需要先使用制表符分割线，然后计算第三段的长度。- 如果长度大于 1000，我将从文件中删除该行。

我想使用 sed 和 awk，但很难快速入门。任何人都可以帮忙吗？:)

提前非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:36:06.290

```
awk -F"\t" 'length($3) < 1001{print}' file > outFile 
```

`-F"\t"`表示拆分行 o 制表符，然后打印第三个字段的大小（长度）小于 1001 的行。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:49:08.423

我想到了...

```
awk '{p = split($0,a,"\t"); if (length(a[3]) < 1000) print $0}' test.txt > out.txt 
```

或 awk -F '\t' '{if (length($3) < 1000) print $0}' test.txt > out.txt

# php - PHP 中的引号回显破坏 HTML 值

> ID：10761565
> 
> 赞同：2
> 
> 时间：2012-05-25T21:26:46.987
> 
> 标签：php, mysql, html

我有一个 HTML 表单值作为 PHP 函数：（`value='".$item->get_title()."'`这是在一个`echo`语句中，因此是单引号。）问题是，如果返回的标题包含任何引号，它会破坏值函数。

例子：`value="Kim Dotcom lawyer blasts US government" s &quot;pattern of delay &quote;'>`

如您所见，它在`government`. 后面应该有一个撇号。

有谁知道解决这个问题？

**修复：** `value='".htmlspecialchars($item->get_title(), ENT_QUOTES)."'`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:32:53.483

使用[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)转义不打算呈现为 HTML 的输出：

```
value="'.htmlspecialchars($item->get_title(), ENT_QUOTES).'" 
```

默认情况下，htmlspecialchars 只转义双引号，而不是单引号。如果您想同时转义（并因此保持将 HTML 值放在单引号中的做法），请将`ENT_QUOTES`其作为第二个参数添加到`htmlspecialchars`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T21:30:49.037

尝试使用[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)

```
htmlspecialchars($item->get_title()); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-25T21:29:39.090

尝试：

```
value='".str_replace('"', '', $item->get_title())."' 
```

# c++ - 在 Qt 中调用 WINAPI ListView_SetImageList 以更快地获取图标

> ID：10761568
> 
> 赞同：1
> 
> 时间：2012-05-25T21:27:24.707
> 
> 标签：c++, qt, winapi

我有`QListView`很多文件及其图标。`QIconProvider`通过 Win API 获取图标，将它们转换为`QIcon`via `QPixmap::fromWinHICON()`，然后将它们转换回 HICON。这会导致每个图标有 200 毫秒的延迟。但最糟糕的是QPixmap不能在后台线程中使用，所以UI卡住了。

这就是为什么我决定使用纯 Win API 来更快地获取图标。

这是我的代码：

```
SHFILEINFO sfi;

HWND hwnd = listView->winId();
HIMAGELIST imageList = (HIMAGELIST) SHGetFileInfo (TEXT ("c:\\"),
    NULL, &sfi, sizeof (sfi), SHGFI_SYSICONINDEX | SHGFI_SMALLICON);
if (!ListView_SetImageList(hwnd, imageList, LVSIL_SMALL))
{
    qDebug() << "FAIL";
} 
```

不幸的是，这不起作用，我得到

> 失败

在应用程序输出中。

我该如何使用 Win API？也许`QListView`没有翻译成 Win API，`ListView`而是翻译成其他类......我在 Qt 源代码中找不到。

# codeigniter - 在 CodeIgniter 中从关系数据库中构建基于 Session 中的角色的页面

> ID：10761574
> 
> 赞同：0
> 
> 时间：2012-05-25T21:28:17.093
> 
> 标签：codeigniter, session, login, relational-database, roles

我是 codeigniter 的新手，目前几乎所有内容，但我在 php、mysql、ci 和 web 应用程序开发方面取得了一些成功。不过，我现在有点卡住了。所以，我想把它扔出去，以征求你对我正在尝试做的事情的看法，希望 - 你可以有耐心去理解我的问题并找到解决方案，因为我会尽力给你所有的细节。

首先，我正在开发一个 Web 应用程序，以帮助简化某个组织的出勤记录。我创建了一个成员表来保存组织的所有成员，一个登录表来保存在组织中担任角色的成员的用户名和密码，一个角色表来包含在组织中担任的角色，最后是一个 member_role表来说明在组织中可能具有多个角色的任何成员。（当然还有一张考勤表，外键是会员，但这不在我目前的问题范围内）。

MySQL 代码只包括相关的表：memeber、login、role 和 member_role。

```
<!-- language: lang-mysql -->
CREATE TABLE `member` (
    `id`                int(10) NOT NULL auto_increment,
    `fname`             varchar(32) NOT NULL,
    `lname`             varchar(32) NOT NULL,
     ...
    PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE `login` (
    `memberid`          int(10) NOT NULL,
    `username`          varchar(32) NOT NULL,
    `password`          varchar(32) NOT NULL,
FOREIGN KEY (`memberid`) REFERENCES member(`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE `role` (
    `id`            integer(10) NOT NULL auto_increment,
    `role`          varchar(32) NOT NULL,
PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE `member_role` (
    `memberid`      integer(10),
    `roleid`        integer(10),
    `active`        char(1) NOT NULL,
FOREIGN KEY (`memberid`) REFERENCES member(`id`),
FOREIGN KEY (`roleid`) REFERENCES role(`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

到目前为止，我认为我在为此目的定义数据库方面做得很好。你在这里的意见会很好，因为我是新手，我只知道新手会知道什么。

这是我目前遇到的真正问题。我创建了一个具有 2 个角色的用户。我让它正确地存储到一个会话中，一个特定成员角色的数组。会话数组返回，roleid 1 和 roleid 3。

假设我为每个角色分配了某些按钮或功能。对于memeberid = 1，我已分配给他roleid = 1 和roleid = 3，因此我只想构建一个页面，其中仅包含roleid = 1 和roleid = 3 可用的功能。有意义吗？

这就是我卡住的地方，我有数组，但不确定如何为用户构建页面。我应该将代码放入控制器还是视图中？无论哪种方式，我都不确定如何填充仅包含关于 roleid = 1 和 roleid = 3 的按钮页面。嗯，我希望你能理解，因为这是我认为我能说清楚的最好的。

如果您确实理解，请举例说明我可以实现什么/如何实现这一目标。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:26:24.673

在您尝试重新发明轮子之前的建议......如果您正在尝试构建一个人力资源管理应用程序，请使用 orangehrm 并在此基础上满足您自己的需求。

否则使用这个

```
foreach($rolesarray as $currentrole)
    {
    //if currentrole is x then do that, if y then do different.
    } 
```

您可以在需要显示多个按钮、显示器等的任何地方使用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:49:50.863

这些表对我来说似乎很好，除了我想知道你为什么要分开成员表和登录表。Login 中的列似乎只是每个成员记录的附加属性，在这种情况下，表可以合并为一个。

关于您为属于第 1 组和第 3 组的人显示正确按钮的问题——我认为您遇到了困难，因为您正在考虑为具有这种组合的人创建一个静态页面（也许我错了.. ？）。相反，您创建一个每个人都可以访问的页面，并在页面的各个区域，其中权限是一个因素，您放置 if 语句以确定是否逐个显示任何给定元素。例如，只要成员属于至少一个组，您就会来到“开始时间”按钮并显示逻辑。然后您将进入“管理仪表板”，并且仅在成员具有组 3 时才显示（如果没有，您将跳过控制器和视图中的元素）。我希望我能正确理解你的问题。

至于是在Controller还是View中检查权限，MVC的精神就是在Controller中执行这种逻辑。然后，在视图中，您将检查控制器是否为页面的某些区域准备了信息。如果视图不需要控制器准备的任何特定内容来显示元素（即，您不需要任何准备来显示管理仪表板的链接/按钮 - 您只需要知道该人是否在第 3 组中)，您可以让控制器设置一个变量，如 $display_management_db_button。

最后，用户身份验证在任何 Web 应用程序中都是非常常见的事情，并且 CodeIgniter 包确实存在用于用户身份验证。我最近遇到了 Ion Auth，它似​​乎是我正在寻找的轻量级和强大的正确组合，但您可以搜索并找到许多其他的。

-格斯

* * *

（编辑）示例：

在控制器中：

```
if($this->member->has_group(3)) { $display_management_db_button=true; }
else { $display_management_db_button=false; }

$data = array('display_management_db_button' => $display_management_db_button;);

$this->load->view('time_screen', $data); 
```

在视图中：

```
if($display_management_db_button) { echo '<input type="button" ... />'; } 
```

所以逻辑保留在控制器中。随着程序变得越来越复杂，分离逻辑对于维护干净的代码变得更加重要。

# android - Android 从他们的 ID 号获取 Facebook 用户名

> ID：10761576
> 
> 赞同：2
> 
> 时间：2012-05-25T21:28:45.357
> 
> 标签：android, facebook

是否可以通过图形调用从他们的 Facebook ID 号码中获取 Facebook 用户的姓名？如果是这样，有人知道电话吗？

例如，您可以通过以下调用获取用户的图片

```
 "http://graph.facebook.com/" + someUserId + "/picture" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T21:40:30.967

就像是：

```
String response = facebook.request(userId);

JSONObject json = Util.parseJson(response);
String name = json.getString("name");
String username = json.getString("username"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-25T21:35:22.020

只需使用 查询 Graph API`user_id`就足以获取用户名 -

```
http://graph.facebook.com/4     
>>

{
  "id": "4", 
  "name": "Mark Zuckerberg", 
  "first_name": "Mark", 
  "last_name": "Zuckerberg", 
  "link": "https://www.facebook.com/zuck", 
  "username": "zuck", 
  "gender": "male", 
  "locale": "en_US", 
  "updated_time": "2012-05-20T01:29:18+0000", 
  "type": "user"
} 
```

您可以通过为名称字段添加过滤器来进一步深入了解 -

```
https://graph.facebook.com/4?fields=name
>>

{
  "name": "Mark Zuckerberg", 
  "id": "4", 
  "type": "user"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:38:14.823

[https://graph.facebook.com/UserID](https://graph.facebook.com/UserID)。例如： [https ://graph.facebook.com/19292868552](https://graph.facebook.com/19292868552)

# android - Android 使用异步任务更新地图位置

> ID：10761579
> 
> 赞同：3
> 
> 时间：2012-05-25T21:28:50.573
> 
> 标签：android, android-asynctask, android-maps

我有一个地图视图，它确定 ASyncTask 中的用户位置，然后在地图上的某些位置添加一些标记。找到位置后，我似乎无法更新地图。在运行 onPostExecute 之前是否有任何可能的方法来等待找到该位置。我尝试在 MainMapView 类中包含位置侦听器而不使用 ASyncTask。这会更新地图，但会使地图变得非常缓慢和滞后。我认为这是因为每次找到新位置时地图都会更新。任何帮助深表感谢。

```
import android.os.Bundle;
import android.os.AsyncTask;
import android.os.Looper;
import android.util.Log;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

import java.io.IOException;
import java.util.List;
import java.util.Locale;

import android.content.Context;
import android.graphics.drawable.Drawable;
import android.location.Address;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapController;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

public class MainMapView extends MapActivity{

    private Location currentLocation;
    private String serviceName;
    private MapController mapController;
    private List<Overlay> mapOverlays;
    private ItemizedOverlay itemizedoverlay;
    private LocationManager locationManager;
    private HealthCarePractice[] practices;

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_map_view);

        Bundle retItem = getIntent().getExtras();
        serviceName = retItem.getString("serviceName");
        //Log.e("This One", serviceName);

        MapView mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
        //mapView.setSatellite(true);
        mapController = mapView.getController(); 

        mapOverlays = mapView.getOverlays();
        Drawable drawable = this.getResources().getDrawable(R.drawable.androidmarker);
        itemizedoverlay = new ItemizedOverlay(drawable, this);

        Context context = this;

        MainMapViewTask task = new MainMapViewTask();
        task.execute(context);

    }

    public class MainMapViewTask extends AsyncTask<Context, Integer, Void>
    {
        Context localContext;

        @Override
        protected Void doInBackground(Context... params) {
            localContext = params[0];
            // Aquire a reference to the system Location Manager
            locationManager = (LocationManager) localContext.getSystemService(Context.LOCATION_SERVICE);

            // Define a listener that responds to location updates
            LocationListener locationListener = new LocationListener() {
                public void onLocationChanged(Location location) {
                    // Called when a new location is found by the network location provider.
                    if (location != null)
                    {
                        currentLocation = location;
                        locationManager.removeUpdates(this);
                        locationManager = null;
                        Geocoder geocoder = new Geocoder(MainMapView.this, Locale.getDefault());  

                        List<Address> list;

                        if(currentLocation == null)
                        {
                            Log.e("Message", "Location not found");
                        }else{
                            try {
                                list = geocoder.getFromLocation(
                                currentLocation.getLatitude(), currentLocation.getLongitude(), 1);
                                if (list != null && list.size() > 0) {
                                    android.location.Address address = list.get(0);
                                    //Log.e("Post Code", address.getPostalCode());
                                    String poCode = address.getPostalCode();
                                    if (poCode != null)
                                    {
                                        //Log.e("Post Code", address.getPostalCode());
                                        String searchString = buildSearchString(serviceName, poCode.replaceAll(" ", ""));
                                        //Log.e("posplit", poCode.split(" ")[0]);
                                        Log.e("Search String", searchString);
                                        RemoteData remoteData = new RemoteData("Location", searchString);
                                        practices = remoteData.getPractices();
                                    }
                                }
                            } catch (IOException e) {
                                e.printStackTrace();
                            }
                        }
                    }

                }

                public void onStatusChanged(String provider, int status, Bundle extras) {}

                public void onProviderEnabled(String provider) {}

                public void onProviderDisabled(String provider) {}
              };

            Looper.myLooper();
            Looper.prepare();
            locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListener);

            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            if(currentLocation != null)
            {
                GeoPoint currentPoint = new GeoPoint((int)(currentLocation.getLatitude()*1000000), (int)(currentLocation.getLongitude()*1000000));
                mapController.setCenter(currentPoint);
                mapController.setZoom(15);
                for(int i=0; i< practices.length; i++)
                {
                    int latitude = (int)(practices[i].getLatitude()*1000000);
                    int longitude = (int)(practices[i].getLongitude()*1000000);
                    currentPoint = new GeoPoint(latitude, longitude);
                    mapController.setCenter(currentPoint);
                    mapController.setZoom(15);
                    String[] addressLines = practices[i].getAddress().getAddressLines();
                    StringBuilder sb = new StringBuilder();
                    for(int y=0; y<addressLines.length; y++)
                    {
                        sb.append(addressLines[y]);
                        sb.append('\n');
                    }
                    sb.append(practices[i].getAddress().getPostcode());
                    sb.append('\n');
                    sb.append("Telephone: ");
                    sb.append(practices[i].getTelephone());
                    OverlayItem currentOverlayItem = new OverlayItem(currentPoint,practices[i].getTitle(),sb.toString());
                    itemizedoverlay.addOverlay(currentOverlayItem);
                    mapOverlays.add(itemizedoverlay);
                }
            }
        }

    }
} 
```

作为更新，以下代码可以工作，但地图非常滞后，当用户尝试通过拖动到新位置来与地图交互时会出现延迟

```
import android.os.Bundle;
import android.os.AsyncTask;
import android.os.Looper;
import android.util.Log;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

import java.io.IOException;
import java.util.List;
import java.util.Locale;

import android.content.Context;
import android.graphics.drawable.Drawable;
import android.location.Address;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapController;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

public class MainMapView extends MapActivity{

    private Location currentLocation;
    private String serviceName;
    private MapController mapController;
    private List<Overlay> mapOverlays;
    private ItemizedOverlay itemizedoverlay;
    private LocationManager locationManager;
    private HealthCarePractice[] practices;
    private boolean mapDrawn = false;

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_map_view);

        Bundle retItem = getIntent().getExtras();
        serviceName = retItem.getString("serviceName");
        //Log.e("This One", serviceName);

        MapView mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
        //mapView.setSatellite(true);
        mapController = mapView.getController(); 

        mapOverlays = mapView.getOverlays();
        Drawable drawable = this.getResources().getDrawable(R.drawable.androidmarker);
        itemizedoverlay = new ItemizedOverlay(drawable, this);

        Context context = this;

        /*
        MainMapViewTask task = new MainMapViewTask();
        task.execute(context);
        */

        locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

        // Define a listener that responds to location updates
        LocationListener locationListener = new LocationListener() {
            public void onLocationChanged(Location location) {
                // Called when a new location is found by the network location provider.
                if (location != null)
                {
                    currentLocation = location;
                    locationManager.removeUpdates(this);
                    locationManager = null;
                    Geocoder geocoder = new Geocoder(MainMapView.this, Locale.getDefault());  

                    List<Address> list;

                    if(currentLocation == null)
                    {
                        Log.e("Message", "Location not found");
                    }else{
                        try {
                            list = geocoder.getFromLocation(
                            currentLocation.getLatitude(), currentLocation.getLongitude(), 1);
                            if (list != null && list.size() > 0) {
                                android.location.Address address = list.get(0);
                                //Log.e("Post Code", address.getPostalCode());
                                String poCode = address.getPostalCode();
                                if (poCode != null)
                                {
                                    //Log.e("Post Code", address.getPostalCode());
                                    String searchString = buildSearchString(serviceName, poCode.replaceAll(" ", ""));
                                    //Log.e("posplit", poCode.split(" ")[0]);
                                    Log.e("Search String", searchString);
                                    RemoteData remoteData = new RemoteData("Location", searchString);
                                    practices = remoteData.getPractices();
                                    if(!mapDrawn)
                                    {
                                        mapDrawn = true;
                                        if(currentLocation != null)
                                        {
                                            GeoPoint currentPoint = new GeoPoint((int)(currentLocation.getLatitude()*1000000), (int)(currentLocation.getLongitude()*1000000));
                                            mapController.setCenter(currentPoint);
                                            mapController.setZoom(15);
                                            for(int i=0; i< practices.length; i++)
                                            {
                                                int latitude = (int)(practices[i].getLatitude()*1000000);
                                                int longitude = (int)(practices[i].getLongitude()*1000000);
                                                currentPoint = new GeoPoint(latitude, longitude);
                                                mapController.setCenter(currentPoint);
                                                mapController.setZoom(15);
                                                String[] addressLines = practices[i].getAddress().getAddressLines();
                                                StringBuilder sb = new StringBuilder();
                                                for(int y=0; y<addressLines.length; y++)
                                                {
                                                    sb.append(addressLines[y]);
                                                    sb.append('\n');
                                                }
                                                sb.append(practices[i].getAddress().getPostcode());
                                                sb.append('\n');
                                                sb.append("Telephone: ");
                                                sb.append(practices[i].getTelephone());
                                                OverlayItem currentOverlayItem = new OverlayItem(currentPoint,practices[i].getTitle(),sb.toString());
                                                itemizedoverlay.addOverlay(currentOverlayItem);
                                                mapOverlays.add(itemizedoverlay);
                                            }
                                        }
                                    }
                                }
                            }
                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                    }
                }

            }

            public void onStatusChanged(String provider, int status, Bundle extras) {}

            public void onProviderEnabled(String provider) {}

            public void onProviderDisabled(String provider) {}
          };

        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListener);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:45:24.420

我只是注意到地图由于为每个标记创建了阴影而滞后，我不知道为什么会这样，但是使用 OverlayItem 类中的以下代码删除标记的阴影已经解决了我的问题。

```
@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow)
{
    if(!shadow)
    {
        super.draw(canvas, mapView, false);
    }
} 
```

必须注意的是，标记的阴影非常不合适。如果有人有解决方案来合并位于正确位置的阴影，请告诉我。问候库什

# python - Pygame.mixer 模块丢失？

> ID：10761581
> 
> 赞同：2
> 
> 时间：2012-05-25T21:29:03.250
> 
> 标签：python, python-2.7, pygame, py2exe

我正在尝试为朋友制作一个小程序，它需要运行一个 .wav 文件，当我在 python 中运行它时它工作正常，但是当我在 py2exe 中编译它时，它给了我这个 -->

```
phone.exe:23: RuntimeWarning: use mixer: DLL load failed: The specified module could not be found.
(ImportError: DLL load failed: The specified module could not be found.)
Traceback (most recent call last):
  File "phone.py", line 23, in <module>
  File "pygame\__init__.pyc", line 70, in __getattr__
NotImplementedError: mixer module not available 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T23:13:37.980

`pygame.mixer`依赖于 libSDL_mixer。确保它可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:05:25.313

这可能会有所帮助：一个示例 py2exe 项目：[http ://www.pygame.org/wiki/Pygame2exe](http://www.pygame.org/wiki/Pygame2exe)

# haskell - 不断发展的数据结构

> ID：10761583
> 
> 赞同：18
> 
> 时间：2012-05-25T21:29:13.613
> 
> 标签：haskell

我正在尝试在 Haskell 中为类 C 语言编写编译器。编译器通过转换 AST 来进行。第一遍解析输入以创建 AST，将符号表与符号表打结，以允许在定义符号之前定位符号，而无需前向引用。

AST 包含关于类型和表达式的信息，它们之间可以存在联系；eg`sizeof(T)`是依赖于类型的表达式`T`，并且`T[e]`是依赖于常量表达式的数组类型`e`。

类型和表达式由 Haskell 数据类型表示，如下所示：

```
data Type = TypeInt Id
          | TypePointer Id Type -- target type
          | TypeArray Id Type Expr -- elt type, elt count
          | TypeStruct Id [(String, Type)] -- [(field name, field type)]
          | TypeOf Id Expr
          | TypeDef Id Type

data Expr = ExprInt Int -- literal int
          | ExprVar Var -- variable
          | ExprSizeof Type
          | ExprUnop Unop Expr
          | ExprBinop Binop Expr Expr
          | ExprField Bool Expr String -- Bool gives true=>s.field, false=>p->field 
```

其中`Unop`包括地址-of（）`&`和解引用（`*`）等运算符，并`Binop`包括加号（`+`）和时间（`*`）等运算符...

请注意，每种类型都分配了一个唯一的`Id`. 这用于构造类型依赖图，以检测导致无限类型的循环。一旦我们确定类型图中没有循环，就可以安全地对它们应用递归函数，而不会陷入无限循环。

下一步是确定每种类型的大小，为结构字段分配偏移量，并`ExprField`用指针算法替换 s。这样做，我们可以确定表达式的类型，并从类型图中消除`ExprSizeof`s、`ExprField`s、`TypeDef`s 和`TypeOf`s，所以我们的类型和表达式已经进化，现在看起来更像这样：

```
data Type' = TypeInt Id
           | TypePointer Id Type'
           | TypeArray Id Type' Int -- constant expression has been eval'd
           | TypeStruct Id [(String, Int, Type')] -- field offset has been determined

data Expr' = ExprInt Type' Int
           | ExprVar Type' Var
           | ExprUnop Type' Unop Expr'
           | ExprBinop Type' Binop Expr' Expr' 
```

请注意，我们已经消除了一些数据构造函数，并稍微更改了其他一些构造函数。特别是，`Type'`不再包含任何`Expr'`，并且每个`Expr'`都确定了它的`Type'`。

所以，最后，问题是：创建两组几乎相同的数据类型，还是尝试将它们统一为一个数据类型更好？

保持两种不同的数据类型明确表明某些构造函数不能再出现。但是，执行常量折叠以评估常量表达式的函数将具有以下类型：

```
foldConstants :: Expr -> Either String Expr' 
```

但这意味着我们不能在以后使用`Expr'`s 执行常量折叠（想象一下操作 an 的某个传递`Expr'`，并希望折叠任何出现的常量表达式）。我们需要另一个实现：

```
foldConstants' :: Expr' -> Either String Expr' 
```

另一方面，保持单一类型将解决常量折叠问题，但会阻止类型检查器强制执行静态不变量。

此外，在第一遍中，我们在未知字段（如字段偏移量、数组大小和表达式类型）中放入了什么？`undefined`我们可以用, 或堵住漏洞`error "*hole*"`，但这感觉就像一场等待发生的灾难（就像`NULL`你甚至无法检查的指针）。我们可以将未知字段更改为s，并用（就像我们*可以*`Maybe`检查的指针一样）塞住漏洞，但是在随后的传递中必须不断地从s 中提取始终是s 的值会很烦人。`Nothing``NULL`*`Maybe``Just`*

 ** * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-25T23:53:04.493

希望有更多经验的人会有一个更完善、经过实战考验和准备好的答案，但这是我的看法。

使用 GADT，您可以以相对较低的成本吃掉馅饼的一部分：

```
{-# LANGUAGE GADTs #-}

data P0 -- phase zero
data P1 -- phase one

data Type p where
     TypeInt     :: Id -> Type p
     TypePointer :: Id -> Type p -> Type p             -- target type
     TypeArray   :: Id -> Type p -> Expr p -> Type p   -- elt type, elt count
     TypeStruct  :: Id -> [(String, Type p)] -> Type p -- [(field name, field type)]
     TypeOf      :: Id -> Expr P0 -> Type P0
     TypeDef     :: Id -> Type P0 -> Type P0

data Expr p where
     ExprInt     :: Int -> Expr p                        -- literal int
     ExprVar     :: Var -> Expr p                        -- variable
     ExprSizeof  :: Type P0 -> Expr P0
     ExprUnop    :: Unop -> Expr p -> Expr p
     ExprBinop   :: Binop -> Expr p -> Expr p -> Expr p
     ExprField   :: Bool -> Expr P0 -> String -> Expr P0 -- Bool gives true=>s.field, false=>p->field 
```

这里我们改变的是：

*   数据类型现在使用 GADT 语法。这意味着构造函数是使用它们的类型签名声明的。`data Foo = Bar Int Char`变成`data Foo where Bar :: Int -> Char -> Foo`（除了语法，两者完全等价）。

*   我们为`Type`和都添加了一个类型变量`Expr`。这是一个所谓的幻像类型变量：没有存储类型的实际数据`p`，它仅用于强制类型系统中的不变量。

*   我们已经声明了虚拟类型来表示转换之前和之后的阶段：阶段零和阶段一。（在具有多个阶段的更复杂的系统中，我们可能会使用类型级别的数字来表示它们。）

*   GADT 让我们可以在数据结构中存储类型级别的不变量。这里我们有两个。首先是递归位置必须与包含它们的结构处于同一阶段。例如，查看`TypePointer :: Id -> Type p -> Type p`，您将 a 传递`Type p`给`TypePointer`构造函数并得到 a`Type p`作为结果，并且这些`p`s 必须是相同的类型。（如果我们想允许不同的类型，我们可以使用`p`and `q`。）

*   第二个是我们强制执行某些构造函数只能在第一阶段使用的事实。大多数构造函数在幻像类型变量中是多态的`p`，但其中一些要求它是多态的`P0`。这意味着这些构造函数只能用于构造`Type P0`or类型的值`Expr P0`，而不能用于构造任何其他阶段。

GADT 有两个方向。第一个是如果你有一个返回 a 的函数`Type P1`，并尝试使用一个返回 a 的构造函数`Type P0`来构造它，你会得到一个类型错误。这就是所谓的“通过构造正确”：构造无效结构在静态上是不可能的（前提是您可以对类型系统中的所有相关不变量进行编码）。它的另一面是，如果你有一个值`Type P1`，你可以确定它是正确构造的：`TypeOf`和`TypeDef`构造函数不能被使用（事实上，如果你尝试对它们进行模式匹配，编译器会抱怨） ，并且任何递归位置也必须是相位的`P1`. 本质上，当您构建 GADT 时，您存储了满足类型约束的证据，并且当您对其进行模式匹配时，您检索该证据并可以利用它。

那是容易的部分。不幸的是，除了允许的构造函数之外，我们在这两种类型之间还有一些差异：一些构造函数参数在不同阶段之间是不同的，而一些只存在于转换后阶段。我们可以再次使用 GADT 对其进行编码，但它不是低成本和优雅的。一种解决方案是复制所有不同的构造函数，并且每个构造函数都有一个 for`P0`和`P1`。但重复并不好。我们可以尝试做的更细粒度：

```
-- a couple of helper types
-- here I take advantage of the fact that of the things only present in one phase,
-- they're always present in P1 and not P0, and not vice versa
data MaybeP p a where
     NothingP :: MaybeP P0 a
     JustP    :: a -> MaybeP P1 a

data EitherP p a b where
     LeftP  :: a -> EitherP P0 a b
     RightP :: b -> EitherP P1 a b

data Type p where
     TypeInt     :: Id -> Type p
     TypePointer :: Id -> Type p -> Type p
     TypeArray   :: Id -> Type p -> EitherP p (Expr p) Int -> Type p
     TypeStruct  :: Id -> [(String, MaybeP p Int, Type p)] -> Type p
     TypeOf      :: Id -> Expr P0 -> Type P0
     TypeDef     :: Id -> Type P0 -> Type P0

-- for brevity
type MaybeType p = MaybeP p (Type p)

data Expr p where
     ExprInt     :: MaybeType p -> Int -> Expr p
     ExprVar     :: MaybeType p -> Var -> Expr p
     ExprSizeof  :: Type P0 -> Expr P0
     ExprUnop    :: MaybeType p -> Unop -> Expr p -> Expr p
     ExprBinop   :: MaybeType p -> Binop -> Expr p -> Expr p -> Expr p
     ExprField   :: Bool -> Expr P0 -> String -> Expr P0 
```

在这里，我们通过一些辅助类型强制执行了这样一个事实，即一些构造函数参数只能出现在阶段一 ( `MaybeP`) 中，而一些在两个阶段 ( `EitherP`) 之间是不同的。虽然这使我们完全类型安全，但感觉有点特别，我们仍然必须一直在`MaybeP`s 和`EitherP`s 中包装东西。我不知道在这方面是否有更好的解决方案。不过，完全的类型安全是一件事情：我们可以编写`fromJustP :: MaybeP P1 a -> a`并确保它是完全安全的。

更新：另一种方法是使用`TypeFamilies`：

```
data Proxy a = Proxy

class Phase p where
    type MaybeP  p a
    type EitherP p a b
    maybeP  :: Proxy p -> MaybeP p a -> Maybe a
    eitherP :: Proxy p -> EitherP p a b -> Either a b
    phase   :: Proxy p
    phase = Proxy

instance Phase P0 where
    type MaybeP  P0 a   = ()
    type EitherP P0 a b = a
    maybeP  _ _ = Nothing
    eitherP _ a = Left a

instance Phase P1 where
    type MaybeP  P1 a   = a
    type EitherP P1 a b = b
    maybeP  _ a = Just  a
    eitherP _ a = Right a 
```

`Expr`与之前版本的唯一变化`Type`是构造函数需要添加一个`Phase p`约束，例如`ExprInt :: Phase p => MaybeType p -> Int -> Expr p`.

在这里，如果`p`a`Type`中的类型`Expr`已知，您可以静态地知道`MaybeP`s 将是`()`还是给定类型以及`EitherP`s 是哪种类型，并且可以直接将它们用作该类型而无需显式展开。什么时候`p`是未知的，你可以使用`maybeP`并`eitherP`从`Phase`类中找出它们是什么。（`Proxy`参数是必要的，因为否则编译器将无法判断您指的是哪个阶段。）这类似于 GADT 版本，如果`p`已知，您可以确定内容`MaybeP`和`EitherP`包含，否则您有模式匹配两种可能性。就“缺失”的论点而言，该解决方案也不完美`()`而不是完全消失。

构造`Expr`s 和`Type`s 在两个版本之间似乎也大致相似：如果您正在构造的值具有任何特定于它的阶段，那么它必须在其类型中指定该阶段。当您想编写一个多态的函数`p`但仍要处理特定于阶段的部分时，问题似乎就来了。使用 GADT，这很简单：

```
asdf :: MaybeP p a -> MaybeP p a
asdf NothingP  = NothingP
asdf (JustP a) = JustP a 
```

请注意，如果我只是编写`asdf _ = NothingP`了编译器，编译器会抱怨，因为不能保证输出的类型与输入的类型相同。通过模式匹配，我们可以确定输入的类型并返回相同类型的结果。

但是，对于该`TypeFamilies`版本，这要困难得多。仅仅使用`maybeP`和结果`Maybe`你不能向编译器证明任何关于类型的东西。您可以通过以下方式获得其中的一部分，而不是拥有`maybeP`和`eitherP`return `Maybe`and ，使它们成为像and这样的`Either`解构函数，这也使类型相等可用：`maybe``either`

```
maybeP  :: Proxy p -> (p ~ P0 => r) -> (p ~ P1 => a -> r) -> MaybeP p a -> r
eitherP :: Proxy p -> (p ~ P0 => a -> r) -> (p ~ P1 => b -> r) -> EitherP p a b -> r 
```

（请注意，我们需`Rank2Types`要这样做，还要注意这些本质上是 和 的 GADT 版本的 CPS 转换版本`MaybeP`。`EitherP`）

然后我们可以写：

```
asdf :: Phase p => MaybeP p a -> MaybeP p a
asdf a = maybeP phase () id a 
```

但这还不够，因为 GHC 说：

```
data.hs:116:29:
 Could not deduce (MaybeP p a ~ MaybeP p0 a0)
 from the context (Phase p)
   bound by the type signature for
              asdf :: Phase p => MaybeP p a -> MaybeP p a
   at data.hs:116:1-29
 NB: `MaybeP' is a type function, and may not be injective
 In the fourth argument of `maybeP', namely `a'
 In the expression: maybeP phase () id a
 In an equation for `asdf': asdf a = maybeP phase () id a 
```

也许你可以在某处使用类型签名来解决这个问题，但在这一点上，它似乎比它的价值更麻烦。因此，在等待其他人提供更多信息之前，我将推荐使用 GADT 版本，它更简单、更强大，但会产生一些语法噪音。

再次更新：这里的问题是因为`MaybeP p a`是一个类型函数并且没有其他信息可以通过，GHC 无法知道`p`应该`a`是什么。如果我传入 a`Proxy p`并使用它而不是`phase`那个解决方案`p`，但`a`仍然未知。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T23:04:10.760

这个问题没有理想的解决方案，因为每个都有不同的优点和缺点。

我个人会使用单一数据类型“树”并为需要区分的事物添加单独的数据构造函数。IE：

```
data Type
  = ...
  | TypeArray Id Type Expr
  | TypeResolvedArray Id Type Int
  | ... 
```

正如您所说，这样做的好处是您可以在同一棵树上多次运行相同的阶段，但推理比这更深入：假设您正在实现一个生成更多 AST 的语法元素（类似于`include`C++ 模板一种交易，它可能取决于像你这样的常量表达式，`TypeArray`所以你不能在第一次迭代中评估它）。使用统一数据类型方法，您只需在现有树中插入新的 AST，不仅可以直接在该树上运行与以前相同的阶段，而且您将免费获得缓存，即如果新的 AST 引用通过使用数组`sizeof(typeof(myarr))`或其他方法，您不必`myarr`再次确定常量大小，因为它的类型已经是`TypeResolvedArray`您之前解析阶段的 a 。

当您完成所有编译阶段时，您可以使用不同的表示，是时候解释代码（或其他东西）了；那么您可以确定不需要更多的 AST 更改，并且更简化的表示可能是一个好主意。

顺便说一句，您应该使用[`Data.Word.Word`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Word.html#t%3aWord)而不是[`Data.Int.Int`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t%3aInt)数组大小。在 C 中使用`int`s 索引数组是一个常见的错误，而 C 指针实际上是无符号的。请不要在你的语言中犯这个错误，除非你真的想支持负大小的数组。*

# php - 当我更新源时，Apache 非常慢

> ID：10761590
> 
> 赞同：1
> 
> 时间：2012-05-25T21:29:21.550
> 
> 标签：php, apache, debian

我目前正在使用 PHP 开发 CMS，当我执行一些 var_dump 和 echos 以查看我的代码是否正常工作时，浏览器中的输出没有改变，所以我删除了 index.php 中的所有内容并编写了 echo time(); 但是浏览器的输出和以前一样，所以我通过 SSH 检查了服务器上的 index.php 是否真的改变了，它确实改变了。浏览器显示 unix 时间戳大约需要 2 分钟，但是当我每秒刷新一次页面时，时间戳确实会改变......

我厌倦了在另一个浏览器上打开该页面，然后在另一个不可能缓存该站点的笔记本上打开....仍然一样。

看起来 Apache 需要一些时间来意识到文件已更改，但我不知道为什么......它在几天前工作......

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:34:33.530

它是在浏览器端。只需添加到您的 HTML 标头：

```
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE"> 
```

应该有帮助:)

# jquery - 从 AJAX 响应添加数据时，Jquery 删除页面中已有的 div

> ID：10761593
> 
> 赞同：2
> 
> 时间：2012-05-25T21:29:39.327
> 
> 标签：jquery

```
jQuery.get("ajax.php", function(data)
    {
        prev = $("#newsfeed").html(); //Remember what was in the newsfeed
        $(data).find("div[id^='feed']").each(function() //Find every div starting with feed in AJAX response
            {
                alert('#' + $(this).attr("id")); //Works fine
                $('#' + $(this).attr("id")).remove(); //Remove any existing div with same id - Not working
             });
        $("#newsfeed").html(data + prev); //Append the AJAX response to the top of the page
    }); 
```

请帮忙，我对 Jquery 比较陌生，不知道出了什么问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:34:53.717

我会做一个更好的。看起来您正在删除数据，然后再将其添加回来。

如果您只是添加到 html，则新数据将位于顶部。

```
$("#newsfeed").prepend(data); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:39:59.813

# 一种选择

```
var $newsfeed = $("#newsfeed");
var prev = $newsfeed.html();
$newsfeed.load("ajax.php").append(prev); 
```

# 另外的选择

```
//register a clean event that will look for all ids that start with 'feed'
//do not use '#feed***' selector, as it will the ID that it finds first, and then stop.
       $("#newsfeed").on({"cleanIds":function(event){
//grab the divs
          $(event.data.selector,"#newsfeed").each(function(index,elem){
//remove the id attribute altogether, or come up with a better way to renumber them
//rip out the ID and throw it into the class for storage / usage
          $(this).addClass($(this).attr("id")).removeAttr("id");
       });
        },null,{selector:"div[id^='feed']"}});

    $.get("ajax.php", function(data){
//prepend your stuff, then trigger the clean event.
       $("#newsfeed").prepend(data).trigger("cleanIds");
  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:40:08.740

似乎您可能会遇到多个具有相同 ID 的元素的问题（这是不允许的）。

尝试像这样为删除调用设置上下文

`$('#' + $(this).attr('id'), 'body').remove( );`

这应该将它与您从 AJAX 调用返回的元素区分开来。

这是完全未经测试的，是在黑暗中拍摄的……

# hudson - Jenkins 构建的基于提交的视图

> ID：10761599
> 
> 赞同：14
> 
> 时间：2012-05-25T21:30:11.650
> 
> 标签：hudson, jenkins, hudson-api

我希望能够呈现类似于[buildbot 控制台](http://buildbot.buildbot.net/console)视图的 Jenkins 构建视图。使用 Jenkins 开箱即用，似乎真的没有很好的方法将提交与构建相关联。您必须访问特定的构建来确定它正在构建什么提交。

我希望能够显示在特定分支中测试了哪些提交的状态，以便我们知道是否跳过了提交或最新的提交是否尚未测试。

我尝试为此使用 Jenkins API，但我发现我只能通过构建本身查看 git 提交的 SHA1 哈希，即通过`http://server/job/job-name/388/api/json`. 因此，我能看到提交并为其查找构建的唯一方法是遍历作业中的每个构建并检索其相关的构建信息。这肯定不会是高效和快速的。还有另一种方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:42:49.350

不完善的答案：把你关心的“修订号”放在所有相关工件**的包名**中，并使用“指纹”功能。

例如：我的“产品包”工件有一个修订号，如果我将它带到“测试包”工件（包括解包的产品工件），您将能够通过“工件/指纹”跟踪该修订号" 功能，并显示哪些测试作业使用了它。在下面，您无法通过单击来判断哪个测试使用了哪个“提交”。

![prod_fingerprint](../Images/08ff4f27c59d1906787bfafc2a0dbdea.png) ![在此处输入图像描述](../Images/bab09ae91b344f5f371ff5d44c8d52a0.png)

# c# - C Sharp 表单不断更新？

> ID：10761603
> 
> 赞同：3
> 
> 时间：2012-05-25T21:30:38.760
> 
> 标签：c#, forms, methods, action

通过 Visual Studio，您可以轻松地为事件（按钮单击等）创建方法。有没有一种方法可以为多个事件创建方法，例如在单击三个按钮之一或输入多个文本框之一时运行的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:33:53.847

一旦您创建了该方法，您应该能够将它用于具有类似签名的任何其他事件。

在设计器中，不要双击该方法，而是下拉列表，找到*可以*分配给您选择的事件的任何现有事件处理程序。

像@lcfseth 注释一样，您可以通过参数确定哪个特定控件发送了消息`object sender`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:35:14.527

是的，您可以将许多事件绑定到同一个方法（相同签名的事件）

```
firstEvent += MyMethod;
secondEvent += MyMethod 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:35:14.953

当您将函数绑定到对象的事件时，您实际上是在将委托（即指向函数的指针）传递给其事件处理程序。您可以根据需要将相同的函数绑定到任意数量的对象的事件处理程序，只要所需委托的签名对应。

```
Button1.Click += new EventHandler(this.AnyButton_Click);
Button2.Click += new EventHandler(this.AnyButton_Click);
Button3.Click += new EventHandler(this.AnyButton_Click); 
```

如果您需要根据单击的按钮对“sender”对象运行特定操作，请注意函数的参数“sender”是您单击的按钮，因此如果您需要处理按钮对象，请记住将其拆箱特定的类（即，将其转换为 Button 或任何类型）。

```
void AnyButton_Click(Object sender, EventArgs e)
{
    Button clickedButton = (Button)sender; // unbox the sender
    MessageBox.Show("You just clicked button " clickedButton.Text);
} 
```

( [MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.click.aspx) )

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T21:35:22.217

您可以将相同的处理程序分配给多个控件的 Click 事件。sender 指向导致事件的控件。

# ios - 以灰度绘制 UIView？

> ID：10761610
> 
> 赞同：2
> 
> 时间：2012-05-25T21:31:00.990
> 
> 标签：ios, uiview, filter, grayscale

有没有办法以灰度绘制给定的 UIView（及其子视图）？

我正在尝试获取视图层次结构并使其看起来被禁用而不覆盖图像或切换用于在层次结构中绘制每个 UIView 的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:14:11.070

当我想禁用视图时，我通常只设置`userInteractionEnabled = NO`和`alpha = .5`（或其他一些 < 1\. alpha）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:09:19.317

您不能以灰度绘制 UIView，但您可以在整个事物的顶部放置一个半透明的 UIView 层以显示灰色的行为。

检查[这个](https://stackoverflow.com/questions/1431021/gray-out-view-in-iphone-how)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-07T13:57:00.463

Add a CALayer to your UIView, with the compositingFilter set to colorBlendMode:

```
let grayLayer = CALayer()
grayLayer.frame = bounds
grayLayer.compositingFilter = "colorBlendMode"
grayLayer.backgroundColor = UIColor(red: 0.2, green: 0.2, blue: 0.2, alpha: 1.0).cgColor
layer.addSublayer(grayLayer) 
```

# mysql - 如何将数据库行合并在一起？

> ID：10761611
> 
> 赞同：0
> 
> 时间：2012-05-25T21:31:01.707
> 
> 标签：mysql, sql, database

我在下面有一个查询，它显示了这些结果：

```
SELECT q.QuestionId, q.QuestionContent, an.Answer
FROM Answer an
INNER JOIN Question q ON q.AnswerId = an.AnswerId; 
```

查询结果：

```
QuestionId     QuestionContent           Answer
1              Who are me and you         B
1              Who are me and you         D
2              Name these Cars            A
2              Name these Cars            B
2              Name these Cars            E
3              What is 2+2                B 
```

我想要做的是将相同 QuestionId 的答案合并在一起，因此结果如下所示：

```
QuestionId     QuestionContent           Answer
1              Who are me and you         B D
2              Name these Cars            A B E
3              What is 2+2                B 
```

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:33:54.340

试试这个 -

```
SELECT q.QuestionId,
       q.QuestionContent,
       GROUP_CONCAT(an.Answer, SEPARATOR ' ')
FROM Answer an
INNER JOIN Question q ON q.AnswerId = an.AnswerId
GROUP BY q.QuestionId,
       q.QuestionContent 
```

# asp.net-mvc - 如何让最终用户自己控制 AppSettings？

> ID：10761612
> 
> 赞同：2
> 
> 时间：2012-05-25T21:31:06.010
> 
> 标签：asp.net-mvc, asp.net-mvc-3, web-config, global-asax

我有一个我在 MVC 3 中构建的系统，该系统目前提供一个年度提交周期，其中系统通过与存储在 web.config 作为 AppSettings 的日期相关的七个步骤进行。然而，每年，为了适应最终用户，我总是不得不在之前的步骤之间来回滚动系统。我想让管理员无需联系开发人员即可控制系统状态。做这个的最好方式是什么？

我计划构建一个具有适当验证的页面，让管理员设置日期。我已经考虑了如何存储这些日期的几个选项，但它们似乎都不正确。我们的整个权限系统都使用这些日期，并且页面上的各种文本位根据我们当前所处的时期打开和关闭。

到目前为止，我提出了两个选择：

**选项 1：创建数据库表**——这是我的第一个想法。我已经在 global.asax 中的 MvcApplication 类上设置了属性，并将它们从数据库中提取出来。使用惰性加载器，我可以在第一次需要时设置属性。但是，当它们在数据库中更改时，我没有办法强制系统“重置”并读取日期更改。如果我在 Begin_Request() 上执行此操作，我会不断打开连接并重置 Web 浏览器在服务器上打开的每个文件的属性，无论它是否是静态内容。

每次我需要其中一个日期时，我都可以直接从数据库中获取日期，但随后我不得不重做很多功能以减少重复的数据库调用。我想缓存每个请求的日期，只在需要时才拉取它们，

**选项 2：允许通过应用程序编辑配置文件**– 我已经查看了如何[拆分 web.config 文件](http://www.codeproject.com/Articles/160133/Split-web-config-for-Different-Environments)，以便我可以拥有一个仅包含 appSettings 的单独文件。然后我可以[从控制器操作更新新的配置文件](http://blogs.syrinx.com/blogs/dotnet/archive/2008/03/21/modify-app-config-on-the-fly.aspx)。我认为这会很好地工作，并且不需要我重写任何现有功能，但感觉就像我会在代码中引入一个糟糕的设计模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:38:41.517

我会投票给数据库。为了性能起见，您可以将这些参数值缓存在应用程序内的静态类中，并提供一种方法从同一类中的 DB 重新读取它们。所以：

1.  当用户发出请求时，检查这些属性是否已被缓存。如果它们是 - 使用缓存值，如果不是 - 从数据库中读取它们
2.  当管理员对这些参数进行更改时 - 将它们存储到数据库并强制您的静态缓存类从数据库中重新读取它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:16:59.900

我会将值存储在数据库中，并使用分布式缓存将数据保存在整个网络场中。MS [AppFabric](http://msdn.microsoft.com/en-us/library/hh334364.aspx)缓存对我来说效果很好。您将需要实现一个标准的缓存模式（检查缓存，如果从 db 加载空并插入缓存）。我可能只是创建一个静态 Load() 方法来抽象这个逻辑。当管理员更新数据库时，您可以更新缓存或删除缓存键。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T07:29:44.647

我会建议一种方法，它不关心设置是存储在*数据库*中还是存储*在配置文件中的键/值对中*。

由于您希望*所有用户都可以全局*访问设置，因此您可以缓存设置，并且缓存实现应该是通用的和分布式的。有很多在线资源可以用来创建这样的界面。

由于您希望缓存与基础数据同步，因此您必须设置缓存依赖项（AppFabric 不支持 sql 缓存依赖项，请参阅此[线程](https://stackoverflow.com/questions/9298233/sqlcachedependency-and-appfabric-server)，而[NCache](http://www.alachisoft.com/ncache/)支持 sql 和文件）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T17:37:20.287

还有其他要添加到性能的考虑因素。即如果您修改配置文件thr应用程序池是re iniyializrd，而数据库解决方案不会导致应用程序重新初始化...那么您是否需要在更改后重新初始化应用程序？...如果我没有办法避免初始化不会对应用程序进行剧烈的更改，可能是配置文件解决方案更好

# javascript - 如何优化对静态和动态字符串的调用？(JavaScript/Node.JS)

> ID：10761621
> 
> 赞同：0
> 
> 时间：2012-05-25T21:32:08.227
> 
> 标签：javascript, string, node.js, dynamic

我有这段代码，为了这个问题我简化了：

```
//var a is generated once at runtime
//from an array of strings
//and an array of functions
var a = [ 
            "Start ",
            function(){return "middle ";}, //returns dynamic data
            "end"
        ],
    c = "";

//this for-loop represents a call
for(var i = 0; i < a.length; i++){
    var d = typeof a[i] === 'function' ? a[i]() : a[i];
    c = c.concat(d);
}
console.log(c); 
```

现在第一个问题：我的调用（for 循环）是否比说...

```
var call = a[0]+a[1]()+a[2]; 
```

...在运行时以某种方式创建了调用？

条件问题：如果后一种调用是更优的方法，那么我将如何生成这个最优的调用变量/对象/函数？

最后一个条件问题：如果您无法弄清楚我在最后一个问题中要问的内容，请忽略它。相反，请告诉我我的代码是否能够进一步优化以及如何优化？！

编辑：我继续通过运行 24M 调用对我的代码进行基准测试，调用变量比我的估计快了大约 10%。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:41:08.597

这里的主要答案是：`for`循环不会引入任何你会注意到的性能损失。

但：

如果`a`是在运行时生成的，你必须有一些东西，在某处生成它。如果是这样，而不是一个数组，为什么不直接生成一个函数呢？

```
var acall = function() {
  return "Start, " + dynamic() + "end";
}; 
```

或者

```
var acall = function() {
  return "Start, " + (function() {
    return "middle ";
  })() + "end";
}; 
```

真正的症结在于***如何*** `a`在运行时生成。您通常可以在运行时生成函数，而无需求助于`eval`或其表亲`new Function`...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:43:29.967

虽然正确，并且在性能方面很好，但这段代码对我来说并不合适。我会做的是：

```
var a = [ 
  "Start ",
  function(){return "middle ";}, //returns dynamic data
   "end"
];

var c = a.map(function(item) {
  return typeof item === 'function' ? item() : item;
}).join('');

console.log(c); 
```

这对我来说似乎比在每次`for`迭代中附加到你的字符串更好。

# c++ - 像访问一维数组一样访问二维数组是否合法？

> ID：10761624
> 
> 赞同：14
> 
> 时间：2012-05-25T21:32:42.720
> 
> 标签：c++, language-lawyer

> **可能重复：**
> [我可以将二维数组视为连续的一维数组吗？](https://stackoverflow.com/questions/7269099/may-i-treat-a-2d-array-as-a-contiguous-1d-array)

考虑以下代码：

```
int array2d[10][10];
int *array1d = array2d[0]; 
```

我从未听说过它不起作用的实现，但是`array2d`通过访问和操作是否合法`array1d`？标准的哪个部分允许这样做？标准中是否有任何内容阻止实现在每个二级数组之间插入额外的空间或填充（不是它需要的，但仍然如此）？

额外的问题：有没有一种`array2d`不需要`int[100]`a`reinterpret_cast`或 C 风格的访问方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T21:37:12.827

如果没有记错的话，该标准会将此作为官方未定义行为的示例，但基本上总是有效的。[编辑：这就是我的想法：C99，§J.2（未定义的行为）：

> *   数组下标超出范围，即使一个对象显然可以使用给定的下标访问（如在给定声明 int a[4][5] 的左值表达式 a[1][7] 中）

不过，我并不*完全*确定这是否适用，因为您正在获取数组开头的地址并将其转换为指向底层类型的简单指针。]

数组必须是连续的，因此它不能在数组元素之间插入任何填充。无论您有一个数组`int`还是数组数组，这都是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:37:19.920

这确实是合法的。该标准明确规定多维数组只是更大的一维数组。我没有确切的报价，但我知道这是真的。

# css - CSS自动换行导致div后空格溢出

> ID：10761625
> 
> 赞同：0
> 
> 时间：2012-05-25T21:32:46.453
> 
> 标签：css, internet-explorer, html, word-wrap

我正在使用 CSS word-wrap 属性（设置为 break-word）在固定宽度和可变高度的 div 元素中完整显示单个无空格字符串。div 元素本身位于表格单元格中`<td>`。分词按预期工作，以定义的固定宽度分词。但是，在 IE9（使用 IE7 文档标准）中，在 div 之后似乎有一些额外的空间，导致表格单元格在宽度上扩展（不需要）。div 宽度本身似乎是正确的，由其 CSS 指定。我使用 div 和表格单元格周围的边框来验证。我已经尝试明确设置表格单元格宽度（和最大宽度），但两种方法都不起作用。在 Firefox 或 Chrome 中未观察到此行为。

[编辑：在此处](http://jsfiddle.net/gmDpe/5/)添加示例代码。该问题仅在 IE 中出现（Browser_Mode=IE9；Document_Mode=IE7）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:14:16.147

显然，`td`它正在为单词的全长腾出空间，就好像它没有中断一样。`overflow: hidden`您可以通过设置div来防止这种情况。

jsFiddle：http: [//jsfiddle.net/gmDpe/6/](http://jsfiddle.net/gmDpe/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:59:31.100

我曾经遇到过类似的问题。你试过`table-layout : fixed`在你的表格元素上使用吗？

[table-layout](http://www.w3.org/TR/CSS2/tables.html#propdef-table-layout)是一个鲜为人知但[得到广泛支持](http://www.quirksmode.org/css/tables.html#t03)的属性，在这种情况下非常有用。

# c# - dataGrid 与 datagridcomboboxcolumn 通过 autogeneratecolumn

> ID：10761638
> 
> 赞同：1
> 
> 时间：2012-05-25T21:34:20.987
> 
> 标签：c#, wpf

我想帮我解决一个问题

我需要通过自动方式填充数据网格。我有一个具有一个属性的对象作为集合我正在尝试将我的对象绑定到数据网格中，并且该属性看起来像一个 datagridComboBoxColumn。我的问题与此类似[https://stackoverflow.com/a/1634688/1411394](https://stackoverflow.com/a/1634688/1411394)不同之处在于我需要通过自动方式生成我的 Datagrid 列。当我在数据网格中实现这个绑定时，我只是在我的列中得到了“{Collection}”这个词。有什么办法可以做到这一点吗？抱歉，我正在使用 wpf 并使用模式 mvvm

# google-chrome-extension - Chrome 通知的大小

> ID：10761641
> 
> 赞同：1
> 
> 时间：2012-05-25T21:34:38.380
> 
> 标签：google-chrome-extension, notifications

我正在构建一个扩展，它使用 createHTMLNotification 调用向用户提供通知，但是我在弄清楚相关的大小限制以避免出现丑陋的黑色水平和垂直滚动条时遇到了一些麻烦（至少在 Ubuntu 12.04 Linux 上）。

有没有人有任何关于文档的指针，提供一些关于我应该瞄准的最大尺寸的提示，希望是跨平台的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T16:21:06.207

Windows 版本 20.0.1132.47（稳定版 144678）上的最大尺寸为 300 x 160 像素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:53:21.227

在我自己的笔记本电脑上运行 Chrome on Linux Version 21.0.1145.0 dev 的实验给我最大尺寸为 284 x 144 像素，然后滚动条出现。我不知道这是否是特定于系统的，但假设 Chrome 至少支持某些拥有它们的平台的原生通知，我想在像素完美通知上投入太多精力可能无法保证好的结果。

至于确保滚动条不会出现在通知中，还有另一个小挑战（可能根本与通知 API 无关）；设置`height`and `max-height`（同样设置宽度）不会自行切割它。

就我而言，我需要在通知中设置项目列表的样式，而我最终做的是使用以下 html 代码：

```
<html>
  <head>
    <style>
      body {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: .73em;
      }
      div#note {
        overflow: hidden;
        height: 144px;
        max-height: 144px;
        width: 284px;
      }
      div.noteline {
        position: relative;
        overflow: hidden;
        overflow-x: hidden;
        overflow-y: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        line-height: 1.2em;
      }
    </style>
  </head>
  <body>
    <div id=\"note\">#{params.html}</div>
  </body>
</html> 
```

我的模板引用 ( `#{params.html}`) 基本上填充了包含以下内容的行：

```
<div class="noteline">Some possibly large line that would overflow item 123</div> 
```

# algorithm - 是否有用于动词时间特征的算法（Zeno Vendler 的论文）？

> ID：10761646
> 
> 赞同：4
> 
> 时间：2012-05-25T21:34:55.810
> 
> 标签：algorithm, nlp, computer-science

有没有找到动词时间特征的算法？意味着它是“事件”、“成就”、“成就”还是“状态”？正如 Zeno Vendler 的论文“动词和时间”中所描述的那样？

[http://semantics.uchicago.edu/kennedy/classes/s07/events/vendler57.pdf](http://semantics.uchicago.edu/kennedy/classes/s07/events/vendler57.pdf)

或者，也许有人知道实现这种事情的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T00:07:52.690

据我所知，如果不使用数据库，就无法做到这一点。然后，“算法”本身将是**数据库结构**和对其进行的**查询**的联合。

例如，一个关系数据库有一个英语单词表，每列两列：单词和一个或多个词性，是可以想象的最基本的语言处理数据库。更复杂的还有一个动词表，其中包含两列、单词和“时间特征”。

例如，单词“be”总是描述一种状态。因此，看到单词 be（或其变体：is、are、was 等）的程序可以立即识别该子句描述一种存在状态。显然，完成一词将立即表示成就，而“成就”将始终表示成就。但不要忘记，在您列出的四个类别中，只有“状态”和“事件”是互斥的（除了现在分词，例如句子“事件正在发生”中）。除此之外，状态也可以是成就或成就（“我是奥运金牌得主”），事件也可以是（“我明天毕业。”）。

成就和成就也是**主观**术语，取决于说话者和读者的感受。诸如“达到”、“完成”和“成功”之类的词是对成就感的刻意表达，因此总是可以归为此类。但是，这是先验信息，因此需要实现关系数据库。

最后，一些词的“时间特征”会**随着句子中的其他词而**改变。例如，在“我闻起来不错。”这句话中，“气味”是一个状态动词。在“我闻到培根”这句话中，它是一个动作动词。这些类型的动词是名词后跟的动作动词（及物动词），形容词后跟的状态动词（谓语主格），以及都不跟的动作动词（不及物动词）。因此，解析器必须检查句子中紧随其后的单词，一个名词或形容词，并从中识别动词在句子中的作用。这是数据库知道每个单词的词性之间的共同努力，

这只是对词法计算的简要概述，以及我对该主题的了解。它还有很多，显然，用单词及其词性、定义、角色等填充数据库是乏味的。可能存在预先填充了词典计算机科学家实施此类系统所需的信息的数据库（但我不声称知道在哪里可以找到它们）。

希望我有所帮助，祝你好运！

# emacs - 粘液中的提示阅读和自动完成冲突

> ID：10761647
> 
> 赞同：4
> 
> 时间：2012-05-25T21:35:08.513
> 
> 标签：emacs, autocomplete, slime

我在 slime repl 中打开了自动完成模式（这很棒），但是如果我输入`(prompt-read "What? ")`我会收到此错误：

```
; pipelined request... (swank:simple-completions "ye" (quote "COMMON-LISP-USER")) 
```

关闭自动完成模式可以解决这个问题，但我宁愿让它保持开启状态。有没有办法解决这个问题？

# php - 如果将 SSL 与移动应用程序一起使用，我是否必须清理和/或验证发布数据服务器端？

> ID：10761651
> 
> 赞同：2
> 
> 时间：2012-05-25T21:35:19.197
> 
> 标签：php, javascript, mysql, ajax, ssl

我正在构建一个移动应用程序，它通过 ajax post 将数据发布到服务器，由 PHP 处理服务器端，最终执行 mySQL 数据库操作。我知道对于网络应用程序，清理和验证数据以避免安全问题很重要，但我想知道在通过 SSL 进行交易的闭源移动 iPhone 或 android 应用程序中是否有必要？发布数据是否可以访问并且会它会受到恶意操纵吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:37:32.367

绝对可以，除非您使用 SSL 来验证客户端证书——老实说，即便如此。您仍在通过*互联网*与客户交谈；您不应假设数据来源没有恶意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T21:41:05.183

来自客户端的任何东西都容易受到“恶意操纵”的影响，SSL 并不能保护您免受这种影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T21:44:56.003

您应该始终清理您的数据！但是，我不同意额外的安全性不会造成任何伤害，尤其是在移动设备上。

您应该直接了解要插入的数据类型，并采取适当的措施来保护它。如果您对它感到偏执，并采取并非绝对需要的预防措施，您将过度杀伤并损害处理速度，这在移动设备上还没有那么多......

# php - 我的 php.ini 中对 max_input_vars 的更改没有反映

> ID：10761654
> 
> 赞同：0
> 
> 时间：2012-05-25T21:35:38.583
> 
> 标签：php

我在我的 Windows 服务器上找到了我的 php.ini 文件的位置，并将 max_input_vars 行从 1000 更改为 3000 并将 post_max_size 更改为 16m 并重新启动了我的服务器。现在，post_max_size 改变了，但是当我检查 phpinfo 时 max_input_vars 没有。

我什至在我的服务器上搜索了我的 php.ini 文件的其他变体，并更改了其中的 max_input_users，包括 php.ini.development 和另一个。当我查看我的 phpinfo 时仍然没有变化。

我还认为可能安装了 sehosin，所以我添加了以下行：

```
suhosin.request.max_vars = 3000
suhosin.post.max_vars = 3000 
```

尽管如此，我的 max_input_vars = 1000。

如何改变这个值？

# objective-c - 添加单个选项卡手势识别器后，MKMapView 缩放损坏

> ID：10761664
> 
> 赞同：2
> 
> 时间：2012-05-25T21:37:08.803
> 
> 标签：objective-c, cocoa-touch, ios5, uigesturerecognizer

我正在使用用户必须在其上添加注释的地图开发应用程序。很简单。问题是，在我在地图上添加点击识别器之后，双击后应该触发的缩放不再起作用。这似乎是一个很常见的问题，因为我发现（并尝试过，我发誓）很多潜在的解决方案都没有成功。

我尝试的最新解决方案（我自己找到后感觉非常聪明）是尝试检索 MkMapView 的“内置双击”识别器，这样我就可以在我的“单击”手势识别器中重用它。这就是我所做的：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    NSArray *gestures = [map gestureRecognizers];

    for (UIGestureRecognizer *r in gestures) {
        if ([r class] == [UITapGestureRecognizer class]) {
            if (2 == [(UITapGestureRecognizer *)r numberOfTapsRequired]) {
                builtInDoubleTap = (UITapGestureRecognizer *)r;
                NSLog(@"BOOM! Found it!");
                return;
            }
        }
    }

    NSLog(@"Guess view did load");
    [self enableTapRecognizer];
} 
```

在我的“enableTapRecognizer”方法中：

```
- (void)enableTapRecognizer {
    UITapGestureRecognizer *mapGestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handlePosition:)];

    if(builtInDoubleTap) {
        NSLog(@"require to fail builtInDoubleTap");
        [mapGestureRecognizer requireGestureRecognizerToFail: builtInDoubleTap];
    }

    [map addGestureRecognizer: mapGestureRecognizer];    
} 
```

问题是，它*从来没有*显示我的“Boom！找到它！” 调试消息。为什么没有任何手势识别器双击后可以缩放？这真的没有意义，不是吗？

（我也尝试使用 UIGestureRecognizerDelegate 所以我的gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer 方法返回YES...）

我现在有点绝望，所以如果有人有想法......也许我的地图配置有问题？

我的目标是 iOS5 并运行最新的 xCode。

谢谢 ！

# sql - Oracle 选择多条记录的最大日期

> ID：10761665
> 
> 赞同：0
> 
> 时间：2012-05-25T21:37:09.193
> 
> 标签：sql, oracle, select, subquery, max

我有以下 SELECT 语句，并且基于我在这里看到的内容：[SQL Select Max Date with Multiple records](https://stackoverflow.com/questions/4816844/sql-select-max-date-with-multiple-records)我的示例以相同的方式设置。我在 Oracle 11g 上。它不是为每个asset_tag 返回一条记录，而是返回多个记录。没有源表中的记录那么多，但（我认为）应该多。如果我运行内部 SELECT 语句，它还会返回正确的记录集（每个asset_tag 1 个），这真的让我很难过。

```
SELECT 
outside.asset_tag,
outside.description, 
outside.asset_type, 
outside.asset_group, 
outside.status_code, 
outside.license_no, 
outside.rentable_yn, 
outside.manufacture_code, 
outside.model, 
outside.manufacture_vin, 
outside.vehicle_yr, 
outside.meter_id, 
outside.mtr_uom, 
outside.mtr_reading, 
outside.last_read_date
FROM mp_vehicle_asset_profile outside
RIGHT OUTER JOIN
  (
  SELECT asset_tag, max(last_read_date) as last_read_date
  FROM mp_vehicle_asset_profile
  group by asset_tag
  ) inside
ON outside.last_read_date=inside.last_read_date 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:41:03.853

尝试分析函数：

```
SELECT  outside.asset_tag,
        outside.description, 
        outside.asset_type, 
        outside.asset_group, 
        outside.status_code, 
        outside.license_no, 
        outside.rentable_yn, 
        outside.manufacture_code, 
        outside.model, 
        outside.manufacture_vin, 
        outside.vehicle_yr, 
        outside.meter_id, 
        outside.mtr_uom, 
        outside.mtr_reading, 
        outside.last_read_date
FROM (  SELECT *, ROW_NUMBER() OVER(PARTITION BY asset_tag ORDER BY last_read_date DESC) Corr
        FROM mp_vehicle_asset_profile) outside
WHERE Corr = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T12:46:57.313

我认为您需要添加...

```
AND outside.asset_tag=inside.asset_tag 
```

...符合您`ON`列表中的标准。

`RIGHT OUTER JOIN`也不需要a 。An将给出相同的结果（并且`INNER JOIN`可能更有效），因为在.`asset_tag``last_read_date``mp_vehicle_asset_profile`

即使这样，如果存在“关系”，查询可能会为每个资产标签返回多行 - 即多行具有相同的`last_read_date`. 相比之下，@Lamak 的基于分析的答案将在这种情况下任意选择一行。

您的评论表明您想通过选择最高的行来打破`mtr_reading`平局`last_read_date`。

您可以通过将子句中的更改修改`ORDER BY`为`OVER`：

```
ORDER BY last_read_date DESC, mtr_reading DESC 
```

如果仍然存在关联（即多行具有相同`asset_tag`的`last_read_date`、 和`mtr_reading`），则查询将再次随意选择恰好一行。

您可以修改我的基于聚合的答案以使用以下最高打破平局`mtr_reading`：

```
SELECT  
    outside.asset_tag, 
    outside.description,
    outside.asset_type,
    outside.asset_group,
    outside.status_code,
    outside.license_no,
    outside.rentable_yn,
    outside.manufacture_code,
    outside.model,
    outside.manufacture_vin,
    outside.vehicle_yr,
    outside.meter_id,
    outside.mtr_uom,
    outside.mtr_reading,
    outside.last_read_date 
FROM 
    mp_vehicle_asset_profile outside 
    INNER JOIN 
    ( 
        SELECT
            asset_tag, 
            MAX(last_read_date) AS last_read_date,
            MAX(mtr_reading) KEEP (DENSE_RANK FIRST ORDER BY last_read_date DESC) AS mtr_reading
        FROM
            mp_vehicle_asset_profile 
        GROUP BY
            asset_tag 
    ) inside 
    ON 
        outside.asset_tag = inside.asset_tag
        AND
        outside.last_read_date = inside.last_read_date
        AND
        outside.mtr_reading = inside.mtr_reading 
```

如果仍然存在关联（即多行具有相同`asset_tag`的`last_read_date`、 和`mtr_reading`），则查询可能再次返回多行。

基于分析和聚合的答案不同的另一种方式是它们对空值的处理。如果 、 或 中的任何一个`asset_tag`为`last_read_date`空`mtr_reading`，则基于分析的答案将返回相关行，但基于聚合的答案不会（因为`TRUE`当涉及空时，连接中的相等条件不会计算。

# perl - 远程/定期运行 perl 脚本的 Web 服务

> ID：10761670
> 
> 赞同：0
> 
> 时间：2012-05-25T21:37:26.570
> 
> 标签：perl, cron, hosting, web-hosting, vps

我正在寻找一种付费/免费服务，它使我能够通过 Web 界面远程运行我的 Perl 脚本（它有相当长的运行时间），或者像 cron 作业一样定期运行它。有这样的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:04:50.757

只需购买一些 VPS（虚拟专用服务器）托管计划。

VPS Web 托管计划意味着您与其他网站共享物理服务器硬件，但您会获得系统资源的专用部分。

使用 VPS，您可以配置自己的 cron 作业、安装 Perl 库、执行 Perl 脚本……所有这些都使用您自己的 root。

有许多 VPS 托管服务提供商。谷歌为他们。例如，每月 6.00 美元将为您提供带有[Interserver.Net](http://www.interserver.net/vps/)的基本 Linux VPS 。

# netbeans - 如何在 Netbeans 7.1 中生成 JUnit HTML 报告？

> ID：10761674
> 
> 赞同：0
> 
> 时间：2012-05-25T21:37:36.833
> 
> 标签：netbeans, junit, junit4, netbeans-7

如何在 Netbeans 7.1 中生成 JUnit HTML 报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:51:17.483

虽然您可以在 NetBeans 中以图形方式运行 JUnit，但我认为没有办法导出报告。但是，NetBeans 与 Ant 有很好的集成。您可以使用[junitreport](http://ant.apache.org/manual/Tasks/junitreport.html) Ant 任务来生成 HTML 报告。

# java - java jfilechooser 仅列出“hello*.txt 文件”并且不更改目录

> ID：10761677
> 
> 赞同：2
> 
> 时间：2012-05-25T21:37:45.820
> 
> 标签：java, swing, jfilechooser, filechooser

我正在尝试使用 JFileChooser 选择具有以下名称格式的文件：**LS48*.drv**。同时我想限制用户只查看一个特定的目录，比如**c:\data**。所以我不希望用户能够更改目录或其他驱动器名称。下面是我的代码段的基础，您能否给我一些提示：

```
 m_fileChooser = new JFileChooser("c:\\data"); // looking for LS48*.drv files
  m_fileChooser.setFileFilter(new FileNameExtensionFilter("drivers(*.drv, *.DRV)", "drv", "DRV")); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T22:05:55.703

您将需要实现`FileFilter`自己的子类，并将其设置为文件选择器而不是`FileNameExtensionFilter`实例。

您`accept`在这个子类中的方法将类似于以下内容：

```
private static final Pattern LSDRV_PATTERN = Pattern.compile("LS48.*\\.drv");
public boolean accept(File f) {
    if (f.isDirectory()) {
        return false;
    }

    return LSDRV_PATTERN.matcher().matches(f.getName());

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T22:13:13.280

要防止目录更改，请使用以下命令：

```
File root = new File("c:\\data");
FileSystemView fsv = new SingleRootFileSystemView( root );
JFileChooser chooser = new JFileChooser(fsv); 
```

检查这个：[http ://tips4java.wordpress.com/2009/01/28/single-root-file-chooser/](http://tips4java.wordpress.com/2009/01/28/single-root-file-chooser/)

至于文件名模式，您可以使用 java 正则表达式。

# ios - 在 UIWebView 中调用自定义 js 函数

> ID：10761678
> 
> 赞同：1
> 
> 时间：2012-05-25T21:38:02.110
> 
> 标签：ios, uiwebview

我正在尝试预先填写字段以登录论坛。但是，我不拥有该论坛。那么如何链接我自己的 .js 文件，以便我可以触发一个预先填写登录字段的函数呢？

（请记住，我不拥有托管 html 文件的服务器，因此我无法通过 HTML 连接它。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T02:07:38.047

您可以通过以下方式将自己的 javascript 注入到 UIWebView 显示的页面中

1）将您的javascript放入您的应用程序包中的文件中，例如这样的东西将注入myFunction（）。

```
var script = document.createElement('script'); 
script.type = 'text/javascript'; 
script.text = function myFunction()
{  
    alert("my function");
}; 
document.getElementsByTagName('head')[0].appendChild(script); 
```

2) 加载 .js 文件并使用 stringByEvaluationJavaScriptFromString 运行它：

3) 如果在加载 dom 之前没有添加 myFunction() 很重要，那么在同一个 .js 文件中添加一些其他 JavaScript，以确保第 1 部分中的代码在获得 a 之前不会运行dom 加载事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:04:07.353

跨域 javascript 每次都失败。

使用 ajax 检索您想要的页面。

```
$(document).ready(function(){
   jQuery.ajax(’forumlogin’).done(function(data)
     {
     $(’body’).html(data)
      })
 }) 
```

然后使用表单元素填写表单。

# mysql - 如果某些列为空，自动删除行？

> ID：10761679
> 
> 赞同：1
> 
> 时间：2012-05-25T21:38:07.773
> 
> 标签：mysql, triggers

我有一个包含研究参与者联系信息的数据库：homePhone、altPhone 和电子邮件。

我们通过保存一个日志表来检查参与者进出数据库。每次批量签回参与者时，我都会通过我编写的 Java 应用程序运行它，如果需要，它还可以更新/删除联系信息。

当参与者的 3 条联系信息中有 0 条时，将它们保存在数据库中是没有用的。除了在我的 Java 程序中实现检查之外，有没有办法让数据库（在 MySQL 上运行）自动执行此操作？我试图创建一个触发器来检查 UPDATE 上的 3 列，但我在网上看到你不能改变触发器关联的表？

我知道我可以运行：

```
DELETE FROM participants WHERE homePhone=0 AND altPhone=0 AND email='' 
```

但我希望数据库自动执行此操作。我不是数据库专家，所以如果有人有任何见解，那就太好了。最坏的情况是在我的 Java 程序结束时实现上面的 SQL 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:40:43.107

您可以将该查询放在在每个 INSERT INTO 或 UPDATE 语句中调用的[触发器上。](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T21:53:13.993

如果您使用的是 MySQL 5.1.6+，则可以使用 MySql Event Scheduler。

[使用事件调度器](http://dev.mysql.com/doc/refman/5.1/en/events.html)

# javascript - 多个 javascript 方法调用未在表达式中调用

> ID：10761682
> 
> 赞同：3
> 
> 时间：2012-05-25T21:38:38.350
> 
> 标签：javascript

JavaScript 函数

```
function tile(u,v, a,b,c,d) {
  var c0 = tileCorners[a].eval(u,v);
  var c1 = tileCorners[b].eval(u-1,v);
  var c2 = tileCorners[c].eval(u,v-1);
  var c3 = tileCorners[d].eval(u-1,v-1);
  return c0 + c1 + c2 + c3;
} 
```

应该相当于

```
function tile(u,v, a,b,c,d) {
  return
    tileCorners[a].eval(u,v) +
    tileCorners[b].eval(u-1,v) +
    tileCorners[c].eval(u,v-1) +
    tileCorners[d].eval(u-1,v-1);
} 
```

然而第二个函数总是返回`undefined`（调试器不会“进入”对 的调用`eval`），而第一个函数行为正确。`eval`在一个错误的表达式中有多个方法调用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:41:35.460

你是**分号插入规则的受害者。**

尝试：

```
return tileCorners[a].eval(u,v) +
tileCorners[b].eval(u-1,v) +
tileCorners[c].eval(u,v-1) +
tileCorners[d].eval(u-1,v-1); 
```

您的版本相当于：

```
return;

tileCorners[a].eval(u,v) +
tileCorners[b].eval(u-1,v) +
tileCorners[c].eval(u,v-1) +
tileCorners[d].eval(u-1,v-1); 
```

# design-patterns - 有没有一个名字可以让不应该做的事情很难做，而应该做的事情在架构中很容易做？

> ID：10761683
> 
> 赞同：0
> 
> 时间：2012-05-25T21:38:38.437
> 
> 标签：design-patterns

我曾经认为这被称为按合同设计，但我意识到按合同设计实际上是指使用框架进行验证（或类似的东西）。但我假设有一个术语是指使用使做正确的事情变得容易而很难做错误的事情的技术来创建架构的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:07:43.547

防御性编程是我一直在寻找的。

[http://en.wikipedia.org/wiki/Defensive_programming](http://en.wikipedia.org/wiki/Defensive_programming)

# r - R 的 ifelse 如何处理字符数据？

> ID：10761686
> 
> 赞同：12
> 
> 时间：2012-05-25T21:39:04.917
> 
> 标签：r

代码片段：

```
blarg = data.frame(a=c("aa", "bb", "dd"))
blarg$b = blarg$a
# blarg$b is now c("aa", "bb", "dd")
blarg$b = ifelse(blarg$a!="bb",blarg$a,"ZZZ")
# blarg$b is now c(1, "ZZZ", 3)
# I expected c("aa", "ZZZ", "dd")
# typeof(blarg$b) is "character" 
```

为什么是 blarg$bc(1, "ZZZ", 3)？数字从何而来？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-25T21:55:06.253

+1 用于使用名为 blarg 的 data.frame。

为了扩展 Ben 所说的，因子在内部存储为整数，所以当你做这样的事情时，R 不会按照你期望的方式处理它。

看看`str(blarg)`上面代码的步骤。

您可以`stringsAsFactors=FALSE`按照 Ben 的建议使用，也可以使用以下因素：

```
ifelse(blarg$a!='bb', levels(blarg$a), 'ZZZ') 
```

或者更好的是，如果您想替换`blarg$a`that are的级别`'bb'`，您可以完全消除该`ifelse`语句：

```
levels(blarg$a)[levels(blarg$a)=='bb'] <- 'ZZZ' 
```

# python - 配置 nginx 以针对使用率非常低的少数脚本运行 CGI Perl 和 Python 的最简单方法？

> ID：10761687
> 
> 赞同：1
> 
> 时间：2012-05-25T21:39:08.717
> 
> 标签：python, perl, nginx, amazon-web-services

我正在寻找一个简单的 nginx 设置，它运行负载非常低的 Perl 和 Python 脚本（99% 的时间单个用户浏览它们，并且没有超过 100 个请求/天的模式）。

因为服务器在微型实例下的 AWS 上运行，所以我正在寻找内存占用非常低的东西。

更新：我在其上运行 Ubuntu 12.04，安装后`nginx`不包含嵌入式 perl 模块，我安装`nginx-extras`了应该包含它的模块。我仍然不知道如何启用它，而且它也没有抱怨 nginx 包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T12:46:44.210

nginx 不支持（按设计）CGI。您需要一个应用程序服务器来管理它们：

[http://projects.unbit.it/uwsgi/wiki/CGI](http://projects.unbit.it/uwsgi/wiki/CGI)

（它是相当先进的，所以准备一些学习，但你应该能够达到你的目标）

# d3.js - 这会被认为是惯用的 ClojureScript 吗？

> ID：10761690
> 
> 赞同：10
> 
> 时间：2012-05-25T21:39:38.333
> 
> 标签：d3.js, clojurescript

我正在试验/学习 ClojureScript。以下代码片段与优秀的 d3.js 库接口以显示一些圆圈。发现它有点冗长，不求助于宏，有没有办法优化/最小化它？

```
(def rdata (atom (array 3 10 12 16 19)))

(defn update []
(let [em (.selectAll (.select js/d3 "svg") "circle")
     data (.data em @rdata d3/String)
     enter (.append (.enter data) "circle")
     yscale (.linear (. js/d3 -scale))
     xscale (.linear (. js/d3 -scale))
     rscale (.linear (. js/d3 -scale))
     ]
(-> yscale 
  (.domain (array 0 20))
  (.range (array 100 200)))
(-> xscale
  (.domain (array 0 20))
  (.range (array 100 800)))
(-> rscale
  (.domain (array 0 20))
  (.range (array 50 100)))
(-> enter
  (.attr "cx" xscale)
  (.attr "cy" yscale)
  (.attr "r" rscale)
  (.style "fill" "steelblue")
  (.style "stroke" "black")
  (.style "stroke-width" "2")
  )
)
(.info js/console "rdata: " @rdata)
) 
```

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-26T04:04:56.497

要初始化刻度，您可以编写`(.linear (.-scale js/d3))`，这更简洁一些。此外，在此代码片段中，没有理由对数据使用 Atom。如果要更新可视化，可以将新数据作为参数传递给`update`而不是改变原子并调用无参数更新 fn。

用于链接的线程宏惯用语，所以你很好。

再说一次，没有比直接使用 Clojure 库更惯用的方法了。查看[C2](http://keminglabs.com/c2/)，D3 的 Clojure(Script) 实现。（当然，作为主要作者，我对那个有点偏见。）

如果您需要使用 D3 本身，您可能还想浏览现已弃用的[cljs-d3](https://github.com/lynaghk/cljs-d3)包装器的源代码。

宏是获得更简洁接口的一种方式（例如，将映射文字扩展为多个`(.attr "key" value)`调用），但链接宏的语义允许您将任何 fn 注入到链中，这与 JavaScript 的情况非常不同。例如，您可以编写一个普通的 fn，它接受 d3 选择和一个属性映射，并用于`doseq`调用`(.attr d3 k v)`每个映射键/值。

实际上，去年 Clojure Conj 就这个主题（以 D3 为例）进行了[40 分钟的演讲。](http://blip.tv/clojure/kevin-lynagh-extending-javascript-libraries-from-clojurescript-5919758)

# c# - 可能吗？c# 中的 GUI，C++ 中的应用程序

> ID：10761691
> 
> 赞同：8
> 
> 时间：2012-05-25T21:39:57.613
> 
> 标签：c#, c++

甚至可以在 C# 中创建 GUI 层并在 C++ 中创建应用程序的其余部分吗？如果我没记错的话，其中一款杀毒软件是用 Delphi 制作的 GUI。怎么可能做到？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:58:39.400

您有多种选择，包括：

1.  使用[P/Invoke](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)从 C# 调用 C++ DLL。
2.  从本机代码公开一个 COM 接口，并使用[COM interop](http://msdn.microsoft.com/en-us/library/kew41ycz%28v=vs.71%29.aspx)从 C# 调用它。
3.  编写本机 Windows 服务并从托管代码调用它。
4.  使用 C++/CLI 在 C++ 中编写托管库，您可以轻松地从 C# 链接到该库。

如果您从头开始，选项 4 可能是您的最佳选择。（也就是说，除了用 C# 编写整个东西之外。）前三个选项都涉及一些额外的争论和开销，如果你没有令人信服的理由，比如需要与现有的本地库或需要面向服务的架构。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T21:42:42.703

如果您在 C++/CLI 中编写业务逻辑，并在 C# 中编写 UI，那么这应该不是问题。如果你想用纯 ANSI C++ 编写，你可能必须围绕你想暴露给 C# 的对象编写 C++/CLI 包装器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T21:42:21.793

在 c++ dll 中编写应用程序逻辑，然后使用 c# 中的 pinvoke 与 dll 对话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T21:44:01.997

看到[这个答案](https://stackoverflow.com/a/1987307/286801)。它似乎回答了你的问题

# android - 运行适用于 Android 的新英特尔仿真器

> ID：10761696
> 
> 赞同：309
> 
> 时间：2012-05-25T21:40:19.997
> 
> 标签：android, sdk, android-emulator, intel, avd

最近谷歌和英特尔发布了一种运行模拟器的新方法，它应该比以前的版本（模拟 ARM CPU）工作得更好。这里有一些关于它的链接：[this](http://www.androidcentral.com/intel-releases-x86-system-image-android-emulator)和[this](http://www.engadget.com/2012/05/24/intel-posts-x86-friendly-android-4-0-image/)。

但是，按照说明安装新组件并创建新的模拟器配置后，我收到错误消息，也看不到任何改进。我已经尝试过 API 10 和 API 15，并且启用和禁用了 GPU。这些配置都没有帮助。我也在两台不同的计算机上尝试过，但没有得到任何提升（并且得到了相同的错误）。

似乎在我读过的帖子中，没有人对此有任何问题，并且都报告了一个更快的模拟器。

它显示的错误是：

```
emulator: Failed to open the HAX device!
HAX is not working and emulator runs in emulation mode
emulator: Open HAX device failed 
```

为什么会发生这种情况，有没有办法解决它？有没有其他人得到这些错误，反之亦然？

顺便说一句，我有一个英特尔 CPU，如果这可能是个问题。

* * *

编辑：

这是我在 BIOS 中看到的，所以它应该可用...：

![在此处输入图像描述](../Images/c93b75cd4faef04095f4e6dff85027b9.png)

* * *

## 回答 #1

> 赞同：414
> 
> 时间：2012-05-27T06:44:46.510

我有同样的问题，通过安装英特尔硬件加速执行管理器解决了这个问题。使用 SDK 管理器下载它，它在 Extras 中。之后，进入文件夹

*`[Android SDK Root]`*`\extras\intel\Hardware_Accelerated_Execution_Manager`

然后运行`IntelHaxm.exe`并安装。

这里是适用于 Microsoft Windows、Mac OS* X 和 Linux Ubuntu的英特尔硬件加速 [IntelHaxm.exe的链接](https://software.intel.com/en-us/android/articles/intel-hardware-accelerated-execution-manager)

![在此处输入图像描述](../Images/20986a8b456af07ca7ff5bf38392632b.png)

如果您的 BIOS 中未启用虚拟化，您将收到以下消息：

![在此处输入图像描述](../Images/77ee56aa25ada86de368ff27778772fa.png)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-11-26T10:04:51.413

Windows 8 用户的小提示，如果启用 Hyper-V 功能，英特尔 HAX 将无法工作。Hyper-V（像大多数虚拟化技术一样）将专门锁定 VT 扩展，这将阻止 HAX 正常工作。如果您也“需要”Hyper-V，一种解决方法可能是在需要 HAX 时手动停止 Hyper-V 服务（尚未通过测试）。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-06-12T13:06:24.907

如果一切都失败了。只需尝试手动下载英特尔 HAXM zip，解压缩并安装。[在这里](http://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager/)检查

请记住，这只适用于支持英特尔虚拟化技术的英特尔 CPU。你必须在你的BIOS中启用虚拟化。

如果您问我，这是对 android 模拟器的一个相当不错且非常显着的改进。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-10-22T11:53:55.113

并非每个处理器都支持虚拟化！

要了解您的芯片组功能，请访问[http://ark.intel.com/](http://ark.intel.com/)，在搜索行中插入您的处理器名称并查看解决方案。

> 先进技术：...
> 
> 英特尔® 虚拟化技术 (VT-x) = ???

如果您看到“否”，您可以忘记 HAXM！

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-02-01T15:34:12.070

以下是获得硬件加速执行 (HAX) 的步骤，这确实相当多：

1-检查您的处理器英特尔网站，看看它是否支持英特尔 VT-x： http: [//ark.intel.com/Products/VirtualizationTechnology](http://ark.intel.com/Products/VirtualizationTechnology) 所有英特尔酷睿 i 处理器和一些其他选定的处理器都支持英特尔 VT-x

2-检查您的BIOS以启用Intel VT-x，通常在BIOS中称为硬件虚拟化或Intel虚拟化

3-检查您是否正在使用与HAXM冲突的软件，与haxm冲突的流行软件包括但不限于：

```
Hyper-V
Windows phone SDK 8
Avast antivirus 8 
```

4-安装英特尔管理引擎接口 (MEI)，此驱动程序通常不安装，也不是零售商 Windows DVD 的一部分，甚至是 Windows 8。查看这篇关于如何安装的帖子：http: [//communities.intel.com/community/ vproexpert/blog/2011/12/19/mei-driver-now-available-via-microsoft-windows-update](http://communities.intel.com/community/vproexpert/blog/2011/12/19/mei-driver-now-available-via-microsoft-windows-update) 此驱动程序是必需的，对于激活硬件加速不是可选的，您也可以从 Windows 更新安装它

5-使用android SDK manager下载Extras -> Intel x86 Hardware Accelerated Execution Manager。

6-从以下位置运行 HAXM 安装程序：[Android SDK Root]\extras\intel\Hardware_Accelerated_Execution_Manager\IntelHaxm.exe

如果您通过了前面的步骤，安装程序将正常工作，否则它将失败

7 启动 AVD 并查看性能差异，动画更快 系统 UI 和启动器在 4.0.3 中崩溃，但对于 4.2.2 来说还不错

请参阅英特尔的安装指南：

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-09-08T17:44:35.543

使用 SDK Manager 下载 Intel HAX*不起作用*。

从英特尔网站下载并安装它*确实有效*。 [http://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager/](http://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager/)

重要提示：在我的 BIOS 中进行更改以启用虚拟化，然后使用“重新启动”并没有启用虚拟化。突然**冷启动**（即关机和重启）让它出现。

第一步（在 Windows 上）是确保 Micrsoft 硬件辅助虚拟化工具报告“此计算机配置了硬件辅助虚拟化”。 [http://www.microsoft.com/en-us/download/details.aspx?id=592](http://www.microsoft.com/en-us/download/details.aspx?id=592)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-06-08T18:32:01.307

您可能需要在 BIOS 中打开虚拟化，大多数制造商默认禁用它。Intel HAX 需要启用 CPU 虚拟化。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-08T19:21:51.600

大约一周前，同样的事情开始发生在我身上，没有明显的原因（99% 确定我没有升级任何东西）；在能够运行模拟器一段时间后，它只是没有明显原因停止工作。

我尝试安装 Intel thingie，但安装程序报告说我的机器不支持 Intel VM，尽管它具有 Intel i3 处理器并且启用了虚拟化（也许 XP 操作系统太旧了，尽管 MS VM、Oracle 的 Virtual Box 和 VMWare 已安装在具有相同操作系统的这台机器上工作）。

我刚刚编辑了 VD 以模拟 Arm 处理器，一切都恢复正常了。

也许不是最佳解决方案，但它有效！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-05-01T00:52:14.267

对于 Windows，有一些答案解释了它是如何工作的。但我是 Mac 用户，我不知道如何为 Mac 安装 HAX 驱动程序，就像他们为 Windows 安装的那样。最后我找到了下面的链接，它确实解决了我的问题。你应该下载[Mac 的 HAXM](https://software.intel.com/en-us/android/articles/installation-instructions-for-intel-hardware-accelerated-execution-manager-mac-os-x) 然后安装它。

[https://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager-end-user-license-agreement-macosx/](https://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager-end-user-license-agreement-macosx/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-09-19T19:30:22.087

可以在官方[Android 开发者网站](http://developer.android.com/tools/devices/emulator.html#accel-vm)上找到运行加速模拟器的完整分步说明：

> **注意**：从 SDK Tools Revision 17 开始，模拟器的虚拟机加速功能是实验性的；使用此功能时请注意不兼容和错误。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-09-05T21:20:43.397

您必须下载[英特尔® 硬件加速执行管理](http://software.intel.com/en-us/articles/intel-hardware-accelerated-execution-manager-end-user-license-agreement-windows/)器。然后你会得到这个消息：

为 AVD 'test' 模拟器启动模拟器：设备 fd:740 HAX 正在工作并且模拟器在快速 virt 模式下运行

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-08-20T12:49:57.633

对于想要检查您的处理器是否支持虚拟化的 Mac 用户，请使用该`maccpuid`软件并寻找 VMX。如果它被选中，那么你很高兴。

[在这里下载](https://software.intel.com/en-us/articles/download-maccpuid)

![选中 VMX 表示您的处理器支持虚拟化要求](../Images/2122d25bd2c733458a54f774b7850dc2.png)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-06-20T13:55:50.490

这里有两个问题我们需要关注：

1.  HAX 设备无法打开，

    对于这个问题，您必须从 HAX 插件文件夹运行 HAX 设备设置文件。关注*[Speed Up Android Emulator](http://developergoodies.blogspot.in/2012/12/speed-up-android-emulator.html)*以清楚了解如何操作。

2.  如果您通过 AVD 管理器创建了 AVD，那么您可以在 AVD 管理器和设备编辑选项中更改 RAM 大小。

如果您通过命令行创建了 AVD，那么您应该从命令行启动 AVD 将起作用，

```
emulator -memory 512 -avd gtv_avd 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-01-13T18:35:58.007

如果一切都失败了，最好尝试我的选择并下载[HAXM 安装程序](http://software.intel.com/en-us/blogs/2013/04/25/workaround-patch-for-haxm-installation-error-failed-to-configure-driver-unknown)。

需要将其复制到 HAXM 安装文件夹，然后从命令行启动（以管理员身份启动 CMD）。重新启动计算机后，将安装 HAXM。它非常适合我，因为我在笔记本电脑上安装它时遇到问题。

毕竟，只需`sc query`在 cmd 中键入 intelhaxm 即可检查 HAXM 是否安装正确。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-04-29T07:40:57.877

如果您运行的是英特尔处理器，请确保通过 SDK 管理器安装 HAXM（英特尔® 硬件加速执行管理器）安装程序，方法是在 SDK 管理器中选中此选项。然后通过下面的路径运行 HAXM 安装程序 ext。

```
your_sdk_folder\extras\intel\Hardware_Accelerated_Execution_Manager\intelhaxm.exe 
```

还要检查在进行 HAX 安装时分配的 RAM 大小，使其适合您的模拟器的 RAM 大小。

[该视频](https://www.youtube.com/watch?v=ZLcozYGkxl0)显示了可能帮助您解决问题的所有必需步骤。

如果您在安装 HAXM 后遇到问题，[该视频也将为您提供帮助。](https://www.youtube.com/watch?v=Z7xoPCv3sYs)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-09-08T10:44:45.623

1.  从英特尔网站[下载 HAXM 。](https://software.intel.com/en-us/android/articles/intel-hardware-accelerated-execution-manager)

2.  安装它。

3.  然后从 AndroidStudio 运行 AVD，菜单 ->*工具*-> *AVD*。选择 x86。

有用！

# spotify - Spotify 应用发布

> ID：10761710
> 
> 赞同：0
> 
> 时间：2012-05-25T21:41:48.333
> 
> 标签：spotify

我在谷歌上找不到任何关于 Spotify 应用程序的信息，这些信息可以说明这次扩展的未来计划，特别是是否可以在未来的 Spotify 应用程序商店或类似的地方发布你自己的应用程序。有人知道这个功能是否在公司未来的发展计划中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T12:09:36.830

在 App Finder 上发布您的应用程序的过程如下：

[https://developer.spotify.com/technologies/apps/process/](https://developer.spotify.com/technologies/apps/process/)

具体来说，我们要求您先向我们提交一个概念，这样我们就不会出现重复的应用程序，然后一旦获得批准，该过程就相当标准 - 您制作应用程序，我们确保它对 App Finder 来说足够好，然后它发布。

如果你已经开始制作一个应用程序，不管怎样——只要把它作为一个概念提交，我们就可以从那里开始工作。

# c# - 匹配委托“System.Action”没有过载

> ID：10761712
> 
> 赞同：0
> 
> 时间：2012-05-25T21:41:55.180
> 
> 标签：c#, action

```
public void UpdateDataGrid(bool newInsert = false)
    {

        //ThreadSafe (updating datagridview from AddEventForm is not allowed otherwise 
        if (InvokeRequired)
        {
            Invoke(new Action(UpdateDataGrid));
        }
        else
        {
            Util.PopulateDataGridView(ref this.EventsDataGridView,newInsert);
        }
    } 
```

我不知道如何为 new Action() 提供可选参数。

我尝试了 new Action(UpdateDataGrid) 但仍然引发运行时错误。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T21:43:41.123

您需要创建一个方法委托来封装您的方法的调用，传递最初指定的参数，如下所示：

```
() => UpdateDataGrid(newInsert) 
```

在上下文中：

```
public void UpdateDataGrid(bool newInsert = false)
{

    //ThreadSafe (updating datagridview from AddEventForm is not allowed otherwise 
    if (InvokeRequired)
    {
        Invoke(new Action(() => UpdateDataGrid(newInsert)));
    }
    else
    {
        Util.PopulateDataGridView(ref this.EventsDataGridView,newInsert);
    }
} 
```

# c - printf中的f是什么意思？

> ID：10761713
> 
> 赞同：14
> 
> 时间：2012-05-25T21:42:04.447
> 
> 标签：c

C的printf中的“f”是什么意思？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-25T21:43:27.253

`f`in`printf`代表**formatted**，它用于带格式化输出的打印。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T23:59:08.033

正如其他人所指出的，*尾随* `f`表示格式化输出（或系列中函数的格式化输入`scanf`）。

但是，我要补充一点，区别很重要，因为调用者知道字符串应该具有格式说明符语义很重要。例如，不要这样做：

```
char* s = get_some_user_input();
printf(s); // WRONG.  Instead use: printf("%s", s) or fputs(stdout, s) 
```

如果`s`碰巧包含`%`字符，直接打印它`printf`会导致它访问不存在的参数，从而导致未定义的行为（这是一些安全漏洞的原因）。`printf`如果您曾经定义自己的 -like 可变参数函数，请记住此命名约定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:43:35.287

printf 允许格式化，而 print 不允许。此外，C 中不存在 print。我什至不知道 printg 是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T21:44:28.690

如果我没记错的话，printf 代表“将格式化数据打印到标准输出”。

# wordpress - WordPress 画廊崩溃

> ID：10761714
> 
> 赞同：-1
> 
> 时间：2012-05-25T21:42:06.770
> 
> 标签：wordpress

我在我的 wordpress 上使用 TN3Gallery。一旦我启用 Nivo Slider TN3Gallery 就会停止工作。我找不到这个问题的任何解决方案。我不认为 wordpress 允许您在页面基础上禁用特定插件。我该如何解决这个问题？

TN3画廊页面；[http://goo.gl/UZpza](http://goo.gl/UZpza)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T08:45:34.327

`wordpress` `Conditional Tags`如果您想在某些页面/帖子中禁用插件，您需要在您的主题中使用。以下链接可能对您有所帮助 -

1.  [链接条件标签](http://codex.wordpress.org/Conditional_Tags)
2.  [讨论区链接](http://wordpress.org/support/topic/plugin-front-end-editor-disable-on-specific-pages)
3.  [简单示例](http://scribu.net/wordpress/front-end-editor/loading-only-on-certain-pages.html)

# salesforce - 根据线索 url 添加新部分以引导调用 api

> ID：10761717
> 
> 赞同：0
> 
> 时间：2012-05-25T21:42:25.787
> 
> 标签：salesforce, salesforce-service-cloud

我想根据潜在客户网站 url 向潜在客户添加新部分以调用 api 请求

这类似于创建基于 Web 的选项卡，但我想在潜在客户中投放广告，以根据潜在客户网站 url 从网站获取数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:13:15.483

您可以在页面布局中内联 VisualForce 页面，但高度是固定的，我通常认为它不是一个优雅的解决方案，但它可能适用于您的情况，具体取决于您带回的信息以及是否长度需要是动态的。

我将其实现为 Visualforce 页面，然后使用链接上的公式字段来创建基于潜在客户 URL 的页面链接。然后，用户可以单击此链接以弹出一个包含您的页面和信息的新窗口。

# php - 强制网址重写/重定向？

> ID：10761721
> 
> 赞同：0
> 
> 时间：2012-05-25T21:43:16.603
> 
> 标签：php, .htaccess

这种重写方法有效，但它不能强制 url 重写/重定向到新的 url。

我用这个：

```
RewriteEngine on
RewriteRule ^page/([^/\.]+)$ search.php?q=$1 
```

我可以访问重写的 url (project/page/etc..)，但旧的 urls/links (search.php?q=etc) 仍然可以访问而无需重定向。

注意：我使用`$_SERVER`变体来创建 url，并在 localhost 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:52:03.340

您必须将项目/页面**重写**为 search.php？为了隐藏丑陋的网址。

并**重定向**search.php？到项目/页面，以使规范 url 成为访问该资源的唯一方法。

在您的代码中没有提及重定向，您只是在重写。

这样想

*   rewrite 将丑陋的 url 隐藏在规范 url 后面（它隐藏了它们，它不会消除它们）；
*   重定向以类似“search.php？已移至项目/页面，尝试该链接”之类的消息响应浏览器，并且浏览器跟随新链接；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:20:35.983

要将所谓的重定向`ugly URLs`到 SEO 友好 URL，您需要另一个重写规则。有这样的 .htaccess 代码：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^page/([^/\.]+) search.php?q=$1 [L,QSA,NC]

RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+search\.php\?q=([^\s]+) [NC]
RewriteRule ^ page/%1? [R=302,L] 
```

一旦您确认它工作正常，请更改`R=302`为`R=301`.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-25T21:59:46.170

您需要一个`[R=301]`重写规则才能将其转换为客户端重定向。否则，它纯粹是内部重写，客户端永远不会看到 url 被更改。

例如

```
RewriteRule ^page/([^/\.]+)$ search.php?q=$1 [R=301,L] 
```

# mysql - Mysql：创建一个仅显示一对多关系子集的视图

> ID：10761729
> 
> 赞同：0
> 
> 时间：2012-05-25T21:43:42.497
> 
> 标签：mysql, sql, views, one-to-many

假设我有一个一对多的关系，比如一个歌手表，每个人都唱过几首歌：DROP TABLE 歌手；CREATE TABLE 歌手（id bigint not null auto_increment，name varchar(255) not null，PRIMARY KEY (id)）；

```
INSERT INTO singers (name) VALUES ('Joe'), ('Bob');

DROP TABLE songs;
CREATE TABLE songs (
    id bigint not null auto_increment,
    singer_id bigint not null,
    name varchar(255) not null,
    PRIMARY KEY (id)
);

INSERT INTO songs (singer_id, name) VALUES (1, "foo"), (2, "bar"), (1, "baz"), (2, "quux"); 
```

假设歌曲行按时间顺序正确写出，例如，我可以通过查询找到 Joe 唱的最新歌曲

```
SELECT * FROM songs WHERE singer_id = 1 ORDER BY id DESC LIMIT 1; 
```

现在，假设我想创建一个 MySQL 视图，其中包含每个歌手的一行以及该歌手最近演唱的歌曲。换句话说，一个看起来像这样的表：

```
singer_id   singer_name    song_id   song_name
   1          Joe             3         baz
   2          Bob             4         quux 
```

似乎这需要以某种方式将上面的 ORDER BY / LIMIT 子句集成到视图构造/连接逻辑中——但我不知道如何。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:48:27.787

```
select si.id, si.name, so.name, so.id 
from singers si
inner join songs so on so.singer_id = si.id
where so.id = (select max(songs.id) from songs where songs.singer_id=si.id) 
```

[http://sqlfiddle.com/#!2/d52c4/21](http://sqlfiddle.com/#!2/d52c4/21)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:13:01.770

我宁愿将 GROUP BY 用于此类事情，所以这是我的解决方案：

（我提出意见是为了方便，但你不必）

```
CREATE VIEW lastsongs AS
选择singers.id、singers.name、MAX(songs.id) AS lastsong
来自歌手
在歌曲中加入歌曲singer.singer_id =singers.id
GROUP BYsingers.id，singers.name；

创建视图 lastsongnames AS
选择 lastsongs.name，songs.name 作为歌曲名
来自最后的歌曲
加入歌曲songs.id = lastsongs.lastsong;

从 lastsongnames 中选择名称、歌曲名；

```

# facebook - 订阅 facebook 评论的通知

> ID：10761730
> 
> 赞同：1
> 
> 时间：2012-05-25T21:43:52.730
> 
> 标签：facebook, facebook-graph-api

我正在创建一个站点，您可以在其中创建项目。每个项目都有它自己的 facebook 评论框。

我需要用户（在 facebook 上注册的用户）在收到新评论时收到通知，就像他对特定评论框（即在 facebook.com 内）发表评论一样，用户应该看到“红色世界”图标。

我能做到这一点吗？

# oracle - oracle中有多少种索引以及oracle中哈希索引的使用

> ID：10761735
> 
> 赞同：0
> 
> 时间：2012-05-25T21:44:30.940
> 
> 标签：oracle, hash, indexing

Oracle 中有多少种索引类型，什么是 HASH INDEX，它与其他索引相比如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:49:01.187

有许多不同的索引，请参阅此处进行讨论：[http ://www.dba-oracle.com/art_9i_indexing.htm](http://www.dba-oracle.com/art_9i_indexing.htm)

虽然在 Oracle DB 中不支持，但通常哈希索引最适合相等条件（如 WHERE X = 23 ），而 B-TREE 索引（这些在 Oracle DB 中直接支持）最适合不等条件（如 WHERE X < 16 ） .

# c++ - SFML 未加载图像（可能是由于放置位置错误？）

> ID：10761737
> 
> 赞同：0
> 
> 时间：2012-05-25T21:44:44.117
> 
> 标签：c++, visual-studio, visual-studio-2012, sfml

我不确定我是在做一些愚蠢的事情还是视觉工作室做错了什么。

我以前从未真正将 C++ 与 VS 一起使用，但我设法让 SFML 工作，现在我无法加载图像。

这就是我将图像放入项目中的方式：

![图片](../Images/600a2c509a8c318c6f62511187baf912.png)

但是，当我写：

```
if (!tileTexture.loadFromFile("ConceptTile.png"))
    return EXIT_FAILURE; 
```

它返回 EXIT_FAILURE。

谁能回答为什么这不起作用？

如果它有帮助，那么 png 文件不会出现在调试目录中的任何位置，只是 dll、exe 和 pdbs。

我在网上查看了我应该在哪里放置图像，但无论我输入什么关键字，我都找不到任何文章或帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:07:35.370

确保更改项目中的文件属性以将其复制到输出目录。默认情况下（并且在字符串中没有给出进一步的路径）SFML 应该在您的工作目录中查找该文件。如果您确保它们位于正确的位置，则不必将图像文件添加到您的项目中。还要确保不要将它们作为资源包含（因为如果没有一些额外的代码，SFML 将无法加载它们）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-05T12:35:29.747

打开 Windows 资源管理器并移动到包含 C++ 文件的文件夹并将图像粘贴到那里，它应该可以工作或创建一个文件夹并在代码中更改目录，例如，如果您将文件夹命名为 images ：

```
(!tileTexture.loadFromFile("images/ConceptTile.png"))
return EXIT_FAILURE; 
```

它会起作用。

# php - SELECT DISTINCT 还是单独的规范化表？

> ID：10761738
> 
> 赞同：0
> 
> 时间：2012-05-25T21:44:44.417
> 
> 标签：php, mysql, sql, normalization

我们现在正在制定计划，所以在我开始进步之前，我想确保我以最好的方式处理事情。

我们有一个产品表，我们正在向其中添加一个名为“格式”的新字段，它将是产品的结构（袋子、盒子等）。这没有设置值，用户可以在该字段中输入他们喜欢的任何内容，但是我们希望显示用户已经输入的所有格式的下拉列表。

我可以想到两种方法：在 products 表上使用基本的 SELECT DISTINCT 来获取用户已经填写的所有格式；或存储格式并由产品链接到的单独表。

本能地我想使用 SELECT DISTINCT，因为它会让我的生活更轻松。但是，假设一张表有十亿个产品，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:50:11.257

我想我会选择第二个选项（如果你想添加约束，附加表 + 外键），只是因为数量，并且因为你可以拥有合并类似产品形式的管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:55:29.960

如果您决定将所有内容保存在一个表中，请在该列上建立索引。这应该加快在用户应用程序中创建列表的处理。

我有点不知道哪种方法是最好的。通常，在设计用户界面时，您想尝试不同的东西。必须进行数据库更改会阻碍构建应用程序的创造性过程。

另一方面，通常当用户从应用程序的下拉框中选择事物时，这些“事物”是“实体”的极好示例——这就是表打算存储的内容。

最后，我会说在开发应用程序时做最方便的事情。当您接近完成时，请考虑将这些内容存储在单独的表中是否更好。最大的问题之一是您是否想知道所有已经使用过的格式，即使当前没有用户定义它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:49:52.693

由于您让用户输入他们想要的任何内容，因此我会选择第二个选项。

创建一个新表并在其中插入所有新的“格式”并链接到产品表。

确保在创建代码以添加用户输入的格式时，检查数据库中是否存在相等的值，这样您就不需要区分它们。

此外，保持一致，或者只将每个单词的第一个字母大写。

# kinect - 在 Kinect 中获取头部坐标

> ID：10761743
> 
> 赞同：1
> 
> 时间：2012-05-25T21:45:00.653
> 
> 标签：kinect

我正在使用 Kinect 在 Open GL (C++) 中制作应用程序。

我想得到头部（骨架）的坐标。

我看到了这个功能：

`void CSkeletalViewerApp::Nui_DrawSkeletonSegment( NUI_SKELETON_DATA * pSkel, int numJoints, ... )`,

但我不知道如何使用它并提取头部的坐标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T08:29:29.597

从您发布的代码片段来看，我们可以假设您使用的是 Microsoft 的 Kinect for Windows SDK。

关节的坐标存储在[`NUI_SKELETON_DATA`](http://msdn.microsoft.com/en-us/library/nuiskeleton.nui_skeleton_data.aspx)结构的 SkeletonPositions 成员中。该结构的实例可以在结构的 SkeletonData 成员中找到，[`NUI_SKELETON_FRAME`](http://msdn.microsoft.com/en-us/library/nuiskeleton.nui_skeleton_frame.aspx)只要骨架跟踪引擎完成跟踪，就会提供该成员。

当然，这只有在传感器正确初始化的情况下才有效。请查看 SDK 附带的示例项目，并阅读 Microsoft 的在线文档。

此外，请注意 Kinect 的坐标系以传感器为原点，提供的坐标值范围大致为 x 轴 -2.2 到 2.2，y 轴 -1.6 到 1.6，以及 0.0 到 4.0 z 轴（深度）。因此，您可能需要应用一些转换。

# iphone - 使用自定义 UITableViewCell 在 UITableView 上的单元格之间的间距

> ID：10761744
> 
> 赞同：8
> 
> 时间：2012-05-25T21:45:01.417
> 
> 标签：iphone, objective-c, cocoa-touch, uitableview

我有一个 UITableView 从 XIB 文件加载自定义 UITableViewCell 。一切正常，但我的布局要求单元格（都在一个部分内）之间有间距。有没有机会在不必提高 ROW 高度的情况下做到这一点？

现在怎么样了
![现在怎么样了](../Images/cf3e85c97bfd363b2656d83b07fa09c8.png)

它应该是怎样的
![它应该是怎样的](../Images/520c55850cc5ad2cd8f12c0abbb9fd2a.png)

**编辑：**
这就是今天的代码

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [[self.cards valueForKeyPath:@"cards"] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    [ccTableView setBackgroundColor:[UIColor clearColor]];
    cardsCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cardsCell"];

    if(cell == nil){
      NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"cardsCell" owner:self options:nil];
      cell = [topLevelObjects objectAtIndex:0];
    }

    NSString *nmCard = [[self.cards valueForKeyPath:@"cards.name"] objectAtIndex:indexPath.row];
    cell.descCardLabel.text = nmCard;

  return cell;
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-03-31T02:10:17.460

如果您使用自定义的 uitableviewcell 类，我发现实际上有一个非常简单的解决方案。

在单元格类中，添加以下代码：

```
- (void)setFrame:(CGRect)frame {
    frame.origin.y += 4;
    frame.size.height -= 2 * 4;
    [super setFrame:frame];
} 
```

这将在您放入调用此单元格的 uitablview 类中的单元格高度内为您提供 4pt 缓冲区。显然，您现在必须在放入标签和图像时补​​偿单元格中较少的空间，但它可以工作。您也可以在 x 轴上执行相同的操作，以使单元格的宽度更小。我已在我的应用程序中完成此操作，以显示单元格后面的背景图像。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T22:29:24.033

如果无法更改单元格的高度，解决方案是使用所需高度的不可见中间单元格。在这种情况下，您需要重新计算表视图委托和数据源的索引。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

    static NSString *CELL_ID2 = @"SOME_STUPID_ID2";
    // even rows will be invisible
    if (indexPath.row % 2 == 1)
    {
        UITableViewCell * cell2 = [tableView dequeueReusableCellWithIdentifier:CELL_ID2];

        if (cell2 == nil)
        {
            cell2 = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                          reuseIdentifier:CELL_ID2];
            [cell2.contentView setAlpha:0];
            [cell2 setUserInteractionEnabled:NO]; // prevent selection and other stuff
        }
        return cell2;
    }

    [ccTableView setBackgroundColor:[UIColor clearColor]];
    cardsCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cardsCell"];

    if(cell == nil){
      NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"cardsCell" owner:self options:nil];
      cell = [topLevelObjects objectAtIndex:0];
    }

     // Use indexPath.row/2 instead of indexPath.row for the visible section to get the correct datasource index (number of rows is increased to add the invisible rows)
        NSString *nmCard = [[self.cards valueForKeyPath:@"cards.name"] objectAtIndex:(indexPath.row/2)];
        cell.descCardLabel.text = nmCard;

      return cell;
    }

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{

    // two times minus one (invisible at even rows => visibleCount == invisibleCount+1)
    return [[self.cards valueForKeyPath:@"cards"] count] * 2 - 1;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (indexPath.row % 2 == 1)
        return 40;
    return 162;
} 
```

您还需要重新计算 indexPath.row`:didSelectRowAtIndexPath:`和其他使用它的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-28T03:33:41.520

尽管@A-Live 在技术上是正确的，但为了防止出现其他问题，例如：您忘记将 indexPath.row/2 放在某处，您可以执行以下操作（不涉及编程）：

例如，您的 UITableViewCell 高度通常为 90 点，并且您希望每个单元格之间有 10 点间距。使您的 UITableViewCell 高 100 点，并将 UITableViewCell 的底部 10 点设置为空白（没有任何类型的对象）。然后单击界面生成器中的 UITableViewCell 并将 backgroundColor 设置为您想要的间距区域颜色。

瞧！您只需做一点工作就可以在每个单元格之间留出间距，这比在任何地方都编程 /2 容易得多！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-12T10:15:55.860

如果您正在寻找快速的解决方案，[reddit](https://www.reddit.com/r/swift/comments/2fr849/uitableviewcell_with_custom_width_in_swift/)的这个答案对我来说非常有效。

```
class CustomTableViewCell: UITableViewCell {
override var frame: CGRect {
    get {
        return super.frame
    }
    set (newFrame) {
        var frame =  newFrame
        frame.origin.y += 4
        frame.size.height -= 2 * 4
        super.frame = frame
    }
}
} 
```

# javascript - 在 ipad 网络应用程序中禁用垂直反弹效果

> ID：10761746
> 
> 赞同：4
> 
> 时间：2012-05-25T21:45:07.220
> 
> 标签：javascript, objective-c, ios, cordova, mobile-safari

有没有办法在滚动 div 中禁用反弹效果？

到目前为止，我已经尝试过这些东西，但都没有奏效。请帮忙！

[如何在移动 Web 应用程序中禁用 iPhone 上的垂直弹跳/滚动](https://stackoverflow.com/questions/9669670/how-to-disable-vertical-bounce-scroll-on-iphone-in-a-mobile-web-application)

[无法使用 UIScrollView 和 pagingEnabled=YES 禁用反弹](https://stackoverflow.com/questions/7003261/cant-disable-bounce-with-uiscrollview-and-pagingenabled-yes)

[ipad safari：禁用滚动和反弹效果？](https://stackoverflow.com/questions/7768269/ipad-safari-disable-scrolling-and-bounce-effect)

[滚动时禁用 UITableView 垂直反弹](https://stackoverflow.com/questions/2768673/disable-uitableview-vertical-bounces-when-scrolling)

和

[http://www.iphonedevsdk.com/forum/iphone-sdk-development/996-turn-off-scrolling-bounces-uiwebview.html](http://www.iphonedevsdk.com/forum/iphone-sdk-development/996-turn-off-scrolling-bounces-uiwebview.html)

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T01:50:41.410

如果您使用的是 Cordova 1.7，只需打开**Cordova.plist**文件并将键**UIWebViewBounce**设置为**NO**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T08:11:05.833

打开你的 phoneGap 项目的`config.xml`文件并将 UIWebViewBounce 从默认的 true 更改为 false：

```
 <preference name="UIWebViewBounce" value="false" /> 
```

无法想象为什么默认为真......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T14:56:33.223

根据您的评论，您使用的代码完全是禁用滚动。如果您想要滚动，但没有反弹效果，请尝试以下操作：

```
var xStart, yStart = 0;

document.getElementById("scrollableDiv").addEventListener('touchstart',function(e) {
    xStart = e.touches[0].screenX;
    yStart = e.touches[0].screenY;
});

document.getElementById("scrollableDiv").addEventListener('touchmove',function(e) {
    var xMovement = Math.abs(e.touches[0].screenX - xStart);
    var yMovement = Math.abs(e.touches[0].screenY - yStart);
    if((yMovement * 3) > xMovement) {
        e.preventDefault();
    }
}); 
```

我在[这里](http://gregsramblings.com/2012/05/23/preventing-vertical-scrolling-bounce-using-javascript-on-ios-devices/)找到了这个解决方案。请让我知道这对你有没有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T11:34:35.670

这将帮助您将 .scroll 类放置在您希望仍然滚动的元素上。

发生的事情是默认情况下禁用所有触摸动作。如果您希望滚动的元素上有 .scroll 类，那么它将门设置为 true 以允许它通过。

在触摸结束时，您将门重置为假。

这适用于 IOS5 和 6，并且可以在 Chrome 和 Safari 中运行

查看@这篇文章以扩展它
[如何在滚动 DIV 元素时防止页面滚动？](https://stackoverflow.com/questions/7600454/how-to-prevent-page-scrolling-when-scrolling-a-div-element)

唯一需要注意的是，如果您过度滚动可滚动元素，则弹性效果允许滚动向上传递，而滚动设置为 true。手动设置滚动位置会被可怕的反弹效果覆盖。
我敢打赌，那些 Apple friggers 有一个原生的滚动实现，在设定的时间内运行，每一步都硬连接。

所以如果你滚动到 -20，我认为它把每一步都硬连接到一个循环中，而不是检查它在哪里。依次滚动到 -20 -19 -18 等。

我们必须想办法解决这个问题！（事实上​​，我有一个想法！）

```
$(function(){
  var scroll = false
  var scroll_element;
  $('body').on('touchmove',function(e){
      if(!scroll){
      e.preventDefault()
      }
  })
  $('body').on('touchend',function(e){
      scroll = false
  })  
  $('.scroll').on('touchstart',function(e){
      scroll_element = this
      scroll = true
  })  
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-04T19:12:43.110

我知道这可能不是最好的方法，但它确实有效。

这是我所做的 -

```
#scrollableDiv {
    position:fixed;
    top:50px;
    width:300px;
    height:500px;
    word-wrap: break-word;
    overflow-y: scroll; 
}

document.getElementById("scrollableDiv").innerHTML = longText;
document.getElementById("scrollableDiv").scrollTop = 0; 
```

# sql-server - T-SQL，OPENROWSET 在同一服务器上的数据库之间复制表

> ID：10761747
> 
> 赞同：1
> 
> 时间：2012-05-25T21:45:30.093
> 
> 标签：sql-server, tsql, openrowset

我正在开发一些在 SQL 服务器之间传输数据的代码。在这个阶段，我所有的工作都在同一台服务器上（本地，我是所有者），但我已经在尝试实现将在生产时使用的 OPENROWSET 功能（数据将在不同的服务器上，我将不得不为转移建立查询）。以下 3 个代码应该做同样的事情，但是使用 OPENROWSET 的代码给了我一个错误...... Bref，我被卡住了！如果有人可以帮助...

3部分命名：作品

```
USE db1
SELECT * INTO dbo.myTable FROM db2.dbo.myTable 
```

开放数据源：有效

```
USE db1
SELECT * INTO dbo.myTable FROM OPENDATASOURCE
    ('SQLOLEDB', 
    'Data Source=127.0.0.1\SQLEXPRESS;Integrated Security=SSPI'
    ).db2.dbo.myTable 
```

开放式设置：不起作用

```
USE db1
SELECT * INTO dbo.myTable FROM OPENROWSET
    ('SQLOLEDB', 
     'Trusted_Connection=yes;Server=(Local)', 
     'db2.dbo.myTable') 
```

我在哪里收到以下消息：

```
OLE DB provider "SQLNCLI" for linked server "(null)" returned message "Login timeout expired".
OLE DB provider "SQLNCLI" for linked server "(null)" returned message "An error has occurred while establishing a connection to the server. When connecting to SQL Server 2005, this failure may be caused by the fact that under the default settings SQL Server does not allow remote connections.". 
```

当然，我尝试使用连接字符串的标准属性（与 OPENDATASOURCE 一样），但我也收到以下错误：

```
OLE DB provider "SQLNCLI" for linked server "(null)" returned message "Invalid authorization specification".
OLE DB provider "SQLNCLI" for linked server "(null)" returned message "Invalid connection string attribute". 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T15:53:03.357

一方面：您的`OPENROWSET`声明没有指定服务器实例。

尝试

```
USE db1
SELECT * INTO dbo.myTable FROM OPENROWSET
    ('SQLOLEDB', 
     'Trusted_Connection=yes;Server=127.0.0.1\SQLEXPRESS', 
     'db2.dbo.myTable') 
```

# mysql - 在 mySQL 中按表达式排序

> ID：10761748
> 
> 赞同：0
> 
> 时间：2012-05-25T21:45:42.197
> 
> 标签：mysql, sql

我有区域，并且在这些区域内售出门票......我使用以下查询来获取每个区域售出的门票数量，并且我需要进行排序，以便可用区域（其中 count <容量）位于顶部排序：

```
SELECT z.name, z.capacity,count(t.ticketid) as thecount  
FROM tickets t JOIN zones z ON z.zoneid=t.zoneid 
GROUP BY z.name ORDER BY z.sortorder 
```

返回：

+--------+----------+----------+
name cap thecount
+--------+----- -----+---------+
区域1 | 100 | 100
区2 | 300 | 300
区3 | 250 | 101
区4 | 600 | 522
区5 | 160 | 160
+--------+---------+----------+

我需要按以下顺序排序：
Zone3
Zone4
Zone1
Zone2
Zone5

我不确定如何使用表达式或其他东西来实现这一点——任何有用的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:49:15.643

```
SELECT z.name, z.capacity,count(t.ticketid) as thecount   
FROM tickets t JOIN zones z ON z.zoneid=t.zoneid  
GROUP BY z.name  
order by case when thecount < c.capacity
              then thecount
              else c.capacity
         end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:10:03.673

```
SELECT *, capacity - thecount AS availableSeats
FROM (
    SELECT z.name, z.capacity,count(t.ticketid) as thecount  
    FROM tickets t JOIN zones z ON z.zoneid=t.zoneid 
    GROUP BY z.name
) t
ORDER BY availableSeats, name 
```

我想你可能还需要分组`z.name, z.capacity`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:12:11.393

因此，根据 GWilliams00 的回答，我最终得到：

```
SELECT *, capacity < thecount AS availableSeats
FROM (
   SELECT z.name, z.capacity,count(t.ticketid) as thecount  
   FROM gt_tickets t JOIN gt_zones z ON z.zoneid=t.zoneid  
   GROUP BY z.name

) t
ORDER BY availableSeats,sortorder 
```

'capacity < thecount' 评估为布尔值，因此可用于对可用区域进行排序，然后 sortorder 将它们保持在正确的名称顺序之后。

# visual-studio-2010 - 使用 TFS 签入不确定性 dll

> ID：10761750
> 
> 赞同：0
> 
> 时间：2012-05-25T21:46:17.460
> 
> 标签：visual-studio-2010, dll, tfs

我在解决方案中使用的所有外部库都位于解决方案中各个项目的 Lib 文件夹中，并且它们的`Build Action`属性都设置为“内容”，`Copy to Output Directory`属性设置为“如果较新则复制”。

当我将我的解决方案签入 TFS 时，一些 dll 文件被复制到 TFS 并签入，并在它们旁边出现一个蓝色锁，而有些则没有，提示我的团队成员向我索要这些 dll 文件的副本以便成为能够构建解决方案...

如果所有这些 dll 文件的文件属性都相同并且这些都是 .NET 程序集，那么决定是否签入 dll 的因素是什么，以及最适合`Build Action`dll 库的是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T15:08:56.503

当您将项目或文件夹添加到源代码管理时，默认情况下会忽略玩偶和可执行文件。您需要转到排除选项卡并选择要明确签入的 dll。这就是为什么你有看似随机的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T15:53:02.717

我发现这取决于您如何将 dll 文件添加到您的解决方案中。

如果首先将 dll 文件复制到您的 Lib 文件夹并从那里添加到您的项目中（复制/粘贴到解决方案资源管理器中的 Lib 文件夹中），则不会将其签入并复制到 TFS。

如果 dll 文件从其原始位置添加到您的项目（复制/粘贴到解决方案资源管理器中的 Lib 文件夹），VS 会将文件复制到您的 Lib 文件夹并将其签入 TFS。

# c++ - 从 QGraphicsGridLayout 中的 QWidgets 中删除边框

> ID：10761751
> 
> 赞同：1
> 
> 时间：2012-05-25T21:46:18.420
> 
> 标签：c++, qt, qwidget, qgraphicsscene

我目前有一个与 QGraphicsGridLayout 一起使用的 QGraphicsScene。我正在尝试在此网格布局上对齐 QWidget（QLabels 和自定义图形 QWidget），然后将其导出到 QPrinter 以进行 pdf 导出。

我遇到的问题是，我似乎无法摆脱 QLabels 之间的这些灰色分隔线。我尝试将布局中的间距设置为 0，边距设置为 0，QLabel 调色板的所有不同属性等都无济于事。以下是相关代码：

主类：

```
QLabel lbl("some text");
lbl.setAutoFillBackground(true);
QPalette pal = lbl.palette();
pal.setColor(QPalette::Window, Qt::white);
lbl.setPalette(pal);
lbl.setFrameStyle(QFrame::NoFrame);
reportlayout->addWidget(&lbl);
reportlayout->generatePDF(reportfilename); 
```

报告布局类：

```
gridlayout->setContentsMargins(0,0,0,0);
gridlayout->setSpacing(0);

QGraphicsWidget* page = new QGraphicsWidget();
page->setLayout(gridlayout);
scene->addItem(page);
printer->setOutputFileName(filename);
painter->begin(printer);
scene->render(painter);
painter->end(); 
```

我有一种感觉，是布局在这样做，因为线条位于网格中的单元格之间 - 但布局没有任何颜色属性，我找不到与分隔线有关的任何内容。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:59:48.387

你试过样式表吗？

例如，

```
setStylesheet("QLabel { border:0px solid black; }"); 
```

您必须调查所有可能的选择器，直到找到哪个选择器引入了边界。

# jmeter - 用于 http-response 标头的 Jmeter 正则表达式

> ID：10761752
> 
> 赞同：0
> 
> 时间：2012-05-25T21:46:21.030
> 
> 标签：jmeter

如何使用正则表达式提取器从 http-header 响应中提取 Etag？

我的 get 有以下输出，我想`Etag`在下一个案例中提取并使用它，我必须将它传递给我的`http-header`to do `If-None-Match`。我尝试了以下方法：`\Etag:\s?`并在“要检查的响应字段”中选择了“标题”。但我没有看到这个值被发送到我的标题。

```
Thread Name: Fetch_Links 1-1
Sample Start: 2012-05-24 10:15:10 PDT
Load time: 135
Latency: 131
Size in bytes: 4950
Headers size in bytes: 641
Body size in bytes: 4309
Sample Count: 1
Error Count: 0
Response code: 200
Response message: OK 
```

我正在使用 2.6 版本的 jmeter。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:03:46.620

我可以使用以下参数在 JMeter（正则表达式提取器 - 标头）中提取 ETag：

正则表达式：ETag：“（。*？）”

模板：$1$

然后添加一个 HTTP 标头管理器以使用“If-None-Match”传递 Etag 的值。

# android - ListView 下方有额外空间的 DialogFragment

> ID：10761754
> 
> 赞同：4
> 
> 时间：2012-05-25T21:46:40.263
> 
> 标签：android, dialog, android-fragments

如您所见，在我的 ListView 的底部列表元素下方，我似乎无法摆脱多余的空间。我尝试过Relative 和Linearlayout，两者看起来都像这样。这是代码： ![在此处输入图像描述](../Images/ad020019aa39697b50ee0a1d505a7deb.png)

```
public class ChooseDialog extends DialogFragment implements
        DialogInterface.OnClickListener {

    String URLhome;
    String Title;
    String type;

/*  public static ChooseDialog newInstance() {
        ChooseDialog dialog = new ChooseDialog();
        Log.v("a", "shit runs");
        Bundle bundle = new Bundle();
        dialog.setArguments(bundle);
        return dialog;
    }*/

    public ChooseDialog(String type) {
        this.type = type;
    }

    @Override
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setCancelable(true);
        int style = DialogFragment.STYLE_NORMAL, theme = 0;
        setStyle(style, theme);
    }

     @Override
        public Dialog onCreateDialog(Bundle savedInstanceState) {
            AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
            builder.setTitle(type);
            builder.setNegativeButton("Cancel", this);
            LayoutInflater inflater = (LayoutInflater) getActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            View dialogLayout = inflater.inflate(R.layout.dialog, null);
            builder.setView(dialogLayout);

            final String[] items = {"Red", "Green", "Blue" };

            builder.setAdapter(new ArrayAdapter<String>(getActivity(), android.R.layout.simple_list_item_1, items), 
                    new DialogInterface.OnClickListener() {

                public void onClick(DialogInterface dialog, int which) {
                    Log.v("touched: ", items[which].toString());

                }} 
                );

            return builder.create();

        }

    @Override
    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub

    }

} 
```

以及启动对话框的代码：

```
public OnClickListener listener = new OnClickListener() {
    public void onClick(View v) {
        showNationalityDialog();
    }
};

private void showNationalityDialog() {
    FragmentManager fm = getSupportFragmentManager();
    ChooseDialog nationalityDialog = new ChooseDialog("Nationality");

    nationalityDialog.show(fm, "fragment_edit_name");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T20:49:05.453

我知道这个问题从来没有引起太多关注，但我终于解决了这个问题。

通过使用我在 XML 中创建的列表视图而不是设置构建器的适配器，我设法摆脱了所有多余的空间。

新代码如下所示：

```
 switch (editText.getId()) {
    case (0) :
    ListView list = (ListView) dialogLayout.findViewById(R.id.listView1);
    list.setAdapter(new ArrayAdapter<String>(activity, R.layout.dialoglist, 
            activity.getResources().getStringArray(R.array.ageArray)));
    list.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            editText.setText(activity.getResources().getStringArray(R.array.ageArray)[arg2]);
            dismiss();
        }   
    });
    builder = (Integer.parseInt(android.os.Build.VERSION.SDK) < 11)? new AlertDialog.Builder(activity) : 
        new AlertDialog.Builder(activity, android.R.style.Theme_Translucent);
    builder.setNegativeButton("Cancel", this);
    builder.setView(dialogLayout);

    return builder.create(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T12:04:46.013

如果您在只有 ListView 的警报对话框（通过 setView()）上设置自定义视图，那么您不需要使用自定义视图。如果调用设置适配器，构建器将自动将 ListView 添加到视图中。列表视图末尾的额外空间可能是您没有内容的自定义视图。

例如：

```
 @Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    final AccountChooserListAdapter adapter = new AccountChooserListAdapter(getActivity(), R.layout.choose_account_list_item,
            accountMetadataFactory.getAccountsAsList());

    return new AlertDialog.Builder(getActivity())
            .setCancelable(true)
            .setTitle(getActivity().getString(R.string.title_add_account))
            .setAdapter(adapter, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    listener.onAddAccount(which);
                }
            })
            .setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    dialog.dismiss();
                }
            })
            .create();
} 
```

# php - 如何更好地设计了解选中哪个复选框以便将其值赋予 mysql？

> ID：10761759
> 
> 赞同：0
> 
> 时间：2012-05-25T21:47:37.550
> 
> 标签：php, mysql, html, checkbox

我有 2 个复选框。它们的值转到另一个 php 文件，如果它们中的任何一个被选中，它的值就是插入的 mysql 代码。我做到了，但是当复选框的数量增加并且出现更高级的东西时，我的代码将无法付诸实践。

这是 checkbox.php :(它在一个表单中)

```
<div>
  <label>Choose:</label>
  <label>Camera </label><input type="checkbox" name="kind[]" value="1" />
  <label>Video  </label><input type="checkbox" name="kind[]" value="2"/>
</div> 
```

单击表单时，它会通过 AJAX 和 jquery($.post) 转到 fetch_kind.php。
这是代码：

```
<?php

$kind = array();
$kind = $_POST['kind'];
$count = count($kind);

if ($count== 0) {
  echo "You did not checked any of checkboxes!!!";
}

if ($count == 2) {
  $sql = "SELECT id,kind FROM products";
} else {

   foreach ($kind as $value) {
     if ($value =="1") {
       $sql = "SELECT id,kind FROM products WHERE kind = " . $value;    
     }
     if ($value =="2") {
       $sql = "SELECT id,kind FROM products WHERE kind = " . $value;
     }
   }
} 

?> 
```

你能举一个更好的例子吗？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:52:18.823

您可以遍历所有复选框并向数组添加简单条件。你在最后内爆了数组。

就像是：

```
$conds = array();
foreach ($kind as $value) {
  $conds[] = '`kind` = ' . intval($value);
}

$sql = "SELECT id,kind FROM products WHERE " . implode(" OR ", $conds); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:06:27.663

一种简单的方法是将所有值和我们分组`IN`

```
if ($count > 0){
    $sql = "SELECT id,kind FROM products WHERE kind IN (" . implode (',', $kind) . ")"; 
} 
```

此外，您可能想研究对您的输入进行消毒。

# python - 函数列表和函数参数

> ID：10761760
> 
> 赞同：1
> 
> 时间：2012-05-25T21:47:37.847
> 
> 标签：python

我想知道这篇文章中描述的一些 zipmap 选项的[性能](https://stackoverflow.com/questions/4231345/zip-and-apply-a-list-of-functions-over-a-list-of-values-in-python)。

（我还是新来的，所以我不能评论那个帖子）。

特别是，我对比较列表理解感兴趣：

```
[f(x) for f,x in zip(functions, values)] 
```

到地图电话：

```
map(lambda f,x: f(x), functions, values) 
```

我听说 lambda 很贵，但 map 不会涉及更少的函数调用吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T21:49:44.080

首先，可读性高于性能——除非你能证明这是你的程序的瓶颈，否则使用可读性更强的列表理解。

如果它*是*一个瓶颈，那么做一些性能测试（参见[模块）——但除非所有的功能都是微不足道](http://docs.python.org/library/timeit.html)[的`timeit`](http://docs.python.org/library/timeit.html)，否则这两种方法都可能无关紧要。

做一个快速测试：

```
python -m timeit -s "functions = [lambda x: x+y for y in range(1000)]" -s "values = list(range(1000))" "[f(x) for f,x in zip(functions, values)]"
1000 loops, best of 3: 207 usec per loop

python -m timeit -s "functions = [lambda x: x+y for y in range(1000)]" -s "values = list(range(1000))" "list(map(lambda f,x: f(x), functions, values))"
1000 loops, best of 3: 315 usec per loop 
```

如果你想要一个生成器表达式：

```
python -m timeit -s "functions = [lambda x: x+y for y in range(1000)]" -s "values = list(range(1000))" "list(f(x) for f,x in zip(functions, values))"
1000 loops, best of 3: 250 usec per loop 
```

并使用 Python 2.x 的旧式映射，它会立即生成一个列表以确保完整性（相当于列表理解示例）：

```
python2 -m timeit -s "functions = [lambda x: x+y for y in range(1000)]" -s "values = list(range(1000))" "map(lambda f,x: f(x), functions, values)"  
1000 loops, best of 3: 234 usec per loop 
```

我们可以看到列表理解无论如何都会在性能上获胜。

# json - 一个领域模型，多个 json 视图

> ID：10761762
> 
> 赞同：7
> 
> 时间：2012-05-25T21:48:32.883
> 
> 标签：json, jaxb, jersey, jackson

我们有一组域类，它们使用 jersey 服务通过 jackson 序列化为 json。我们目前正在使用 JAXB 对类进行注释（尽管我们不依赖于此）。这工作正常。但是我们想为不同的用例提供不同的类序列化。

*   网站
*   移动应用
*   管理工具
*   公共 API

在每种情况下，都有不同的字段，我们可能希望或不希望包含在 json 视图中。例如，管理工具可能需要一些参数来设置数据权限。移动客户端需要与网站不同的媒体流 URL。该网站具有字段所需的特定命名约定。

为泽西岛的不同服务端点管理不同的 json 映射的最佳实践是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T11:17:15.100

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

MOXy 提供基于 JAXB 注释的 JSON 绑定以及允许您将备用映射应用到域模型的外部绑定文档。我将在下面用一个例子来演示。

**作为 JAXB 注释的元数据**

下面是一个带有标准 JAXB 注释的简单 Java 模型映射。

```
package forum10761762;

import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class Customer {

    int id;

    @XmlElement(name="first-name")
    String firstName;

    @XmlElement(name="last-name")
    String lastName;

} 
```

**备用元数据 #1 (alternate1.xml)**

在这里，我们将使用 XML 映射文档来取消映射几个字段`@XmlTransient`。

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10761762">
    <java-types>
        <java-type name="Customer">
            <java-attributes>
                <xml-transient java-attribute="id"/>
                <xml-transient java-attribute="firstName"/>
             </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**备用元数据 #2 (alternate2.xml)**

在这里，我们将使用 MOXy 的基于路径的映射扩展将 Java 模型映射到不同的 JSON 结构。

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10761762">
    <java-types>
        <java-type name="Customer">
            <java-attributes>
                <xml-element java-attribute="firstName" xml-path="personalInfo/firstName/text()"/>
                <xml-element java-attribute="lastName" xml-path="personalInfo/lastName/text()"/>
             </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**演示代码**

```
package forum10761762;

import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        Customer customer = new Customer();
        customer.id = 123;
        customer.firstName = "Jane";
        customer.lastName = "Doe";

        Map<String, Object> properties = new HashMap<String, Object>();
        properties.put(JAXBContextProperties.MEDIA_TYPE, "application/json");
        properties.put(JAXBContextProperties.JSON_INCLUDE_ROOT, false);

        // Output #1
        JAXBContext jc1 = JAXBContext.newInstance(new Class[] {Customer.class}, properties);
        marshal(jc1, customer);

        // Output #2
        properties.put(JAXBContextProperties.OXM_METADATA_SOURCE, "forum10761762/alternate1.xml");
        JAXBContext jc2 = JAXBContext.newInstance(new Class[] {Customer.class}, properties);
        marshal (jc2, customer);

        // Output #2
        properties.put(JAXBContextProperties.OXM_METADATA_SOURCE, "forum10761762/alternate2.xml");
        JAXBContext jc3 = JAXBContext.newInstance(new Class[] {Customer.class}, properties);
        marshal(jc3, customer);
    }

    private static void marshal(JAXBContext jc, Object object) throws Exception {
        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(object, System.out);
        System.out.println();
    }

} 
```

**输出**

下面是运行演示代码的输出。请注意，从同一对象模型生成了 3 个不同的 JSON 文档。

```
{
   "id" : 123,
   "first-name" : "Jane",
   "last-name" : "Doe"
}
{
   "last-name" : "Doe"
}
{
   "id" : 123,
   "personalInfo" : {
      "firstName" : "Jane",
      "lastName" : "Doe"
   }
} 
```

**欲了解更多信息（来自我的博客）**

*   [JSON 绑定与 EclipseLink MOXy - Twitter 示例](http://blog.bdoughan.com/2011/08/json-binding-with-eclipselink-moxy.html)
*   [MOXy 作为您的 JAX-RS JSON 提供程序 - MOXyJsonProvider](http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html)
*   [JAX-RS 服务中 MOXy 的 XML 元数据](http://blog.bdoughan.com/2011/04/moxys-xml-metadata-in-jax-rs-service.html)
*   [将 EclipseLink MOXy 指定为您的 JAXB 提供程序](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)

# string - 使用 Ant 操作字符串属性的每一行

> ID：10761763
> 
> 赞同：1
> 
> 时间：2012-05-25T21:48:34.067
> 
> 标签：string, ant, ant-loadfile

我有一个以行分隔的 Javascript 文件列表，我使用`loadfile`.

```
<loadfile property="src-files" srcfile="${manifest.file}"/> 
```

我想将每个文件名包装在 HTML 脚本标记中，因此输入：

```
a.js
foo/b.js
foo/z.js 
```

变成：

```
<script src="a.js"></script>
<script src="foo/b.js"></script>
<script src="foo/z.js"></script> 
```

不使用 Ant-Contrib 或任何其他外部库的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:58:15.760

```
<replaceregexp file="${manifest.file}"
               match="(.+)"
               replace="&lt;script src=&quot;\1&quot;&gt;&lt;/script&gt;"
               byline="true" /> 
```

应该做的伎俩。

如果不想在manifest文件中替换，先制作一个副本，在副本中替换。详见[http://ant.apache.org/manual/Tasks/replaceregexp.html](http://ant.apache.org/manual/Tasks/replaceregexp.html) _

# python - 将 Matlab 代码翻译成 Python

> ID：10761769
> 
> 赞同：2
> 
> 时间：2012-05-25T21:49:23.893
> 
> 标签：python, algorithm, matlab, numpy, crc16

我对这个算法有疑问：

```
function crc16 = crc16eval(D)
% CRC16EVAL CRC-CCITT check with the polynomial: x^16+x^12+x^5+1
D = uint16(D);
crchi = 255;
crclo = 255;
t = '00102030405060708191a1b1c1d1e1f112023222524272629383b3a3d3c3f3e32434041464744454a5b58595e5f5c5d53626160676665646b7a79787f7e7d7c74858687808182838c9d9e9f98999a9b95a4a7a6a1a0a3a2adbcbfbeb9b8bbbab6c7c4c5c2c3c0c1cedfdcdddadbd8d9d7e6e5e4e3e2e1e0effefdfcfbfaf9f8f9181b1a1d1c1f1e110003020504070608393a3b3c3d3e3f30212223242526272b5a59585f5e5d5c53424140474645444a7b78797e7f7c7d72636061666764656d9c9f9e99989b9a95848786818083828cbdbebfb8b9babbb4a5a6a7a0a1a2a3afdedddcdbdad9d8d7c6c5c4c3c2c1c0cefffcfdfafbf8f9f6e7e4e5e2e3e0e1e';
crc16htab = hex2dec(reshape(t,2,length(t)/2)');
t = '0021426384a5c6e708294a6b8cadceef31107352b594f7d639187b5abd9cffde62432001e6c7a4856a4b2809eecfac8d53721130d7f695b45b7a1938dffe9dbcc4e586a740610223cced8eaf48690a2bf5d4b79671503312fddcbf9e79583b1aa687e4c522036041ae8feccd2a0b684997b6d5f4133251709fbeddfc1b3a597888a9caeb0c2d4e6f80a1c2e304254667b998fbda3d1c7f5eb190f3d235147756eacba8896e4f2c0de2c3a08166472405dbfa99b85f7e1d3cd3f291b0577615344c6d0e2fc8e98aab44650627c0e182a37d5c3f1ef9d8bb9a75543716f1d0b3922e0f6c4daa8be8c926076445a283e0c11f3e5d7c9bbad9f81736557493b2d1f0';
crc16ltab = hex2dec(reshape(t,2,length(t)/2)');
for k = 1:length(D)
    ix = double(bitxor(crchi,D(k)))+1;
    crchi = bitxor(crclo,crc16htab(ix));
    crclo = crc16ltab(ix);
end
crc16 = crchi*256+crclo;
end 
```

我需要将该代码翻译成 Python，并且我已经完成了以下操作：

```
def crc16eval(D):
    crchi = 255
    crclo = 255
    t = '00102030405060708191a1b1c1d1e1f112023222524272629383b3a3d3c3f3e32434041464744454a5b58595e5f5c5d53626160676665646b7a79787f7e7d7c74858687808182838c9d9e9f98999a9b95a4a7a6a1a0a3a2adbcbfbeb9b8bbbab6c7c4c5c2c3c0c1cedfdcdddadbd8d9d7e6e5e4e3e2e1e0effefdfcfbfaf9f8f9181b1a1d1c1f1e110003020504070608393a3b3c3d3e3f30212223242526272b5a59585f5e5d5c53424140474645444a7b78797e7f7c7d72636061666764656d9c9f9e99989b9a95848786818083828cbdbebfb8b9babbb4a5a6a7a0a1a2a3afdedddcdbdad9d8d7c6c5c4c3c2c1c0cefffcfdfafbf8f9f6e7e4e5e2e3e0e1e'
    # crc16htab = hex2dec(reshape(t,2,length(t)/2)');

    tarray = [int(n, 16) for n in t] # Recorro el string t, y por cada caracter creo un nuevo entero en el array

    crc16htab = reshape(tarray, (2, (len(t)/2) )).transpose()
    #print crc16htab

    t = '0021426384a5c6e708294a6b8cadceef31107352b594f7d639187b5abd9cffde62432001e6c7a4856a4b2809eecfac8d53721130d7f695b45b7a1938dffe9dbcc4e586a740610223cced8eaf48690a2bf5d4b79671503312fddcbf9e79583b1aa687e4c522036041ae8feccd2a0b684997b6d5f4133251709fbeddfc1b3a597888a9caeb0c2d4e6f80a1c2e304254667b998fbda3d1c7f5eb190f3d235147756eacba8896e4f2c0de2c3a08166472405dbfa99b85f7e1d3cd3f291b0577615344c6d0e2fc8e98aab44650627c0e182a37d5c3f1ef9d8bb9a75543716f1d0b3922e0f6c4daa8be8c926076445a283e0c11f3e5d7c9bbad9f81736557493b2d1f0'
    # crc16ltab = hex2dec(reshape(t,2,length(t)/2)');

    tarray = [int(n, 16) for n in t] # Recorro el string t, y por cada caracter creo un nuevo entero en el array

    crc16ltab = reshape(tarray, (2, (len(t)/2))).transpose()
    #print crc16ltab

    for k in range(len(D)):
        ix = crchi ^ D[k]
        crchi = crclo ^ crc16htab[ix]
        crclo = crc16ltab[ix]

    return crchi*256+crclo 
```

我的问题是下一个：

当我执行 de Python 代码时，计算 de xor 需要很长时间，我认为问题在于

```
crclo = crc16ltab[ix] 
```

是一个矩阵，计算时间很长。哪个是问题？

该算法的伪代码如下：

```
The algorithm for the CRC-CCITT is below described. Note that all operations are on bytes.
A = new byte
B = temp byte
CRCHI = High byte (most significant) of the 16-bit CRC
CRCLO = Low byte (least significant) of the 16-bit CRC
START:
    FOR A = FIRST_BYTE TO LAST_BYTE IN BLOCK DO:
        A = A XOR CRCHI
        CRCHI = A
        SHIFT A RIGHT FOUR TIMES (ZERO FILL)
        A = A XOR CRCHI                  {IJKLMNOP}
        CRCHI = CRCLO                    { swap CRCHI, CRCLO }
        CRCLO = A
        ROTATE A LEFT 4 TIMES            {MNOPIJKL}
        B=A                              { temp save }
        ROTATE A LEFT ONCE               {NOPIJKLM}
        A = A AND $1F                    {000IJLLM}
        CRCHI = A XOR CRCHI
        A = B AND $F0                    {MNOP0000}
        CRCHI = A XOR CRCHI              { CRCHI complete }
        ROTATE B LEFT ONCE               {NOP0000M}
        B = B AND $ E0                   {NOP00000}
        CRCLO = B XOR CRCLO              { CRCLO complete }
    DOEND;
FINISH. 
```

我的问题是：为什么我的 python 代码需要很长时间才能执行？怎么了？我认为的问题在于

```
for k in range(len(D)):
    ix = crchi ^ D[k]
    crchi = crclo ^ crc16htab[ix]
    crclo = crc16ltab[ix] 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T08:56:01.840

我推荐阅读 Ross Williams，[A painless guide to CRC 算法](http://www.riccibitti.com/crcguide.htm)，它将教你所有你想知道的关于 CRC 的知识以及如何快速计算它们。

这是linux内核中使用的CCITT CRC算法的转换。它可能与您正在计算的内容相同也可能不同（如果您阅读以上内容），您会意识到在计算 CRC 时有很多旋钮需要调整。

```
# This mysterious table is just the CRC of each possible byte. It can be
# computed using the standard bit-at-a-time methods. The polynomial can
# be seen in entry 128, 0x8408\. This corresponds to x^0 + x^5 + x^12.
# Add the implicit x^16, and you have the standard CRC-CCITT.
# From linux kernel lib/crc-ccitt.c

_crc_table = (
        0x0000, 0x1189, 0x2312, 0x329b, 0x4624, 0x57ad, 0x6536, 0x74bf,
        0x8c48, 0x9dc1, 0xaf5a, 0xbed3, 0xca6c, 0xdbe5, 0xe97e, 0xf8f7,
        0x1081, 0x0108, 0x3393, 0x221a, 0x56a5, 0x472c, 0x75b7, 0x643e,
        0x9cc9, 0x8d40, 0xbfdb, 0xae52, 0xdaed, 0xcb64, 0xf9ff, 0xe876,
        0x2102, 0x308b, 0x0210, 0x1399, 0x6726, 0x76af, 0x4434, 0x55bd,
        0xad4a, 0xbcc3, 0x8e58, 0x9fd1, 0xeb6e, 0xfae7, 0xc87c, 0xd9f5,
        0x3183, 0x200a, 0x1291, 0x0318, 0x77a7, 0x662e, 0x54b5, 0x453c,
        0xbdcb, 0xac42, 0x9ed9, 0x8f50, 0xfbef, 0xea66, 0xd8fd, 0xc974,
        0x4204, 0x538d, 0x6116, 0x709f, 0x0420, 0x15a9, 0x2732, 0x36bb,
        0xce4c, 0xdfc5, 0xed5e, 0xfcd7, 0x8868, 0x99e1, 0xab7a, 0xbaf3,
        0x5285, 0x430c, 0x7197, 0x601e, 0x14a1, 0x0528, 0x37b3, 0x263a,
        0xdecd, 0xcf44, 0xfddf, 0xec56, 0x98e9, 0x8960, 0xbbfb, 0xaa72,
        0x6306, 0x728f, 0x4014, 0x519d, 0x2522, 0x34ab, 0x0630, 0x17b9,
        0xef4e, 0xfec7, 0xcc5c, 0xddd5, 0xa96a, 0xb8e3, 0x8a78, 0x9bf1,
        0x7387, 0x620e, 0x5095, 0x411c, 0x35a3, 0x242a, 0x16b1, 0x0738,
        0xffcf, 0xee46, 0xdcdd, 0xcd54, 0xb9eb, 0xa862, 0x9af9, 0x8b70,
        0x8408, 0x9581, 0xa71a, 0xb693, 0xc22c, 0xd3a5, 0xe13e, 0xf0b7,
        0x0840, 0x19c9, 0x2b52, 0x3adb, 0x4e64, 0x5fed, 0x6d76, 0x7cff,
        0x9489, 0x8500, 0xb79b, 0xa612, 0xd2ad, 0xc324, 0xf1bf, 0xe036,
        0x18c1, 0x0948, 0x3bd3, 0x2a5a, 0x5ee5, 0x4f6c, 0x7df7, 0x6c7e,
        0xa50a, 0xb483, 0x8618, 0x9791, 0xe32e, 0xf2a7, 0xc03c, 0xd1b5,
        0x2942, 0x38cb, 0x0a50, 0x1bd9, 0x6f66, 0x7eef, 0x4c74, 0x5dfd,
        0xb58b, 0xa402, 0x9699, 0x8710, 0xf3af, 0xe226, 0xd0bd, 0xc134,
        0x39c3, 0x284a, 0x1ad1, 0x0b58, 0x7fe7, 0x6e6e, 0x5cf5, 0x4d7c,
        0xc60c, 0xd785, 0xe51e, 0xf497, 0x8028, 0x91a1, 0xa33a, 0xb2b3,
        0x4a44, 0x5bcd, 0x6956, 0x78df, 0x0c60, 0x1de9, 0x2f72, 0x3efb,
        0xd68d, 0xc704, 0xf59f, 0xe416, 0x90a9, 0x8120, 0xb3bb, 0xa232,
        0x5ac5, 0x4b4c, 0x79d7, 0x685e, 0x1ce1, 0x0d68, 0x3ff3, 0x2e7a,
        0xe70e, 0xf687, 0xc41c, 0xd595, 0xa12a, 0xb0a3, 0x8238, 0x93b1,
        0x6b46, 0x7acf, 0x4854, 0x59dd, 0x2d62, 0x3ceb, 0x0e70, 0x1ff9,
        0xf78f, 0xe606, 0xd49d, 0xc514, 0xb1ab, 0xa022, 0x92b9, 0x8330,
        0x7bc7, 0x6a4e, 0x58d5, 0x495c, 0x3de3, 0x2c6a, 0x1ef1, 0x0f78
)

def update_crc(data, crc, table=_crc_table):
    """
    Add a byte to the crc calculation
    """
    return (crc >> 8) ^ table[(crc ^ data) & 0xff]

def calculate_crc(data, crc=0xFFFF, table=_crc_table):
    """
    Calculates the CRC for the data string passed in
    """
    for c in data:
        crc = update_crc(ord(c), crc, table)
    return crc

print "%04X" % calculate_crc("Hello") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:23:43.897

如果您只需要计算 CRC16（只是结果，而不是代码），您可以使用 [PyCRC](http://www.tty1.net/pycrc/crc-models_en.html)或[CRC-16](http://pypi.python.org/pypi/crc16)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T13:48:01.607

这是最终的解决方案，可能为时已晚……但我认为这可能对某人有用。

```
# CRC16EVAL CRC-CCITT check with the polynomial: x^16+x^12+x^5+1
def crc16eval(D):
    crchi = 255
    crclo = 255

    crc16htab = [0, 16, 32, 48, 64, 80, 96, 112, 129, 145, 161, 177, 193, 209, 225, 241, 18, 2, 50, 34, 82, 66, 114, 98, 147, 131, 179, 163, 211, 195, 243, 227, 36, 52, 4, 20, 100, 116, 68, 84, 165, 181, 133, 149, 229, 245, 197, 213, 54, 38, 22, 6, 118, 102, 86, 70, 183, 167, 151, 135, 247, 231, 215, 199, 72, 88, 104, 120, 8, 24, 40, 56, 201, 217, 233, 249, 137, 153, 169, 185, 90, 74, 122, 106, 26, 10, 58, 42, 219, 203, 251, 235, 155, 139, 187, 171, 108, 124, 76, 92, 44, 60, 12, 28, 237, 253, 205, 221, 173, 189, 141, 157, 126, 110, 94, 78, 62, 46, 30, 14, 255, 239, 223, 207, 191, 175, 159, 143, 145, 129, 177, 161, 209, 193, 241, 225, 16, 0, 48, 32, 80, 64, 112, 96, 131, 147, 163, 179, 195, 211, 227, 243, 2, 18, 34, 50, 66, 82, 98, 114, 181, 165, 149, 133, 245, 229, 213, 197, 52, 36, 20, 4, 116, 100, 84, 68, 167, 183, 135, 151, 231, 247, 199, 215, 38, 54, 6, 22, 102, 118, 70, 86, 217, 201, 249, 233, 153, 137, 185, 169, 88, 72, 120, 104, 24, 8, 56, 40, 203, 219, 235, 251, 139, 155, 171, 187, 74, 90, 106, 122, 10, 26, 42, 58, 253, 237, 221, 205, 189, 173, 157, 141, 124, 108, 92, 76, 60, 44, 28, 12, 239, 255, 207, 223, 175, 191, 143, 159, 110, 126, 78, 94, 46, 62, 14, 30]

    crc16ltab = [0, 33, 66, 99, 132, 165, 198, 231, 8, 41, 74, 107, 140, 173, 206, 239, 49, 16, 115, 82, 181, 148, 247, 214, 57, 24, 123, 90, 189, 156, 255, 222, 98, 67, 32, 1, 230, 199, 164, 133, 106, 75, 40, 9, 238, 207, 172, 141, 83, 114, 17, 48, 215, 246, 149, 180, 91, 122, 25, 56, 223, 254, 157, 188, 196, 229, 134, 167, 64, 97, 2, 35, 204, 237, 142, 175, 72, 105, 10, 43, 245, 212, 183, 150, 113, 80, 51, 18, 253, 220, 191, 158, 121, 88, 59, 26, 166, 135, 228, 197, 34, 3, 96, 65, 174, 143, 236, 205, 42, 11, 104, 73, 151, 182, 213, 244, 19, 50, 81, 112, 159, 190, 221, 252, 27, 58, 89, 120, 136, 169, 202, 235, 12, 45, 78, 111, 128, 161, 194, 227, 4, 37, 70, 103, 185, 152, 251, 218, 61, 28, 127, 94, 177, 144, 243, 210, 53, 20, 119, 86, 234, 203, 168, 137, 110, 79, 44, 13, 226, 195, 160, 129, 102, 71, 36, 5, 219, 250, 153, 184, 95, 126, 29, 60, 211, 242, 145, 176, 87, 118, 21, 52, 76, 109, 14, 47, 200, 233, 138, 171, 68, 101, 6, 39, 192, 225, 130, 163, 125, 92, 63, 30, 249, 216, 187, 154, 117, 84, 55, 22, 241, 208, 179, 146, 46, 15, 108, 77, 170, 139, 232, 201, 38, 7, 100, 69, 162, 131, 224, 193, 31, 62, 93, 124, 155, 186, 217, 248, 23, 54, 85, 116, 147, 178, 209, 240]

    for k in range(len(D)):
        ix = crchi ^ D[k]
        crchi = crclo ^ crc16htab[ix]
        crclo = crc16ltab[ix]

    return crchi*256+crclo 
```

安东尼奥。

# maven - 如何在与 Maven 中的依赖 jar 相同的路径上复制文件？

> ID：10761771
> 
> 赞同：0
> 
> 时间：2012-05-25T21:49:47.937
> 
> 标签：maven

我有`XYZ.jar`和`XYZ.properties`来自第 3 方。
`XYZ.jar`有一些代码在路径中查找 XYZ.properties 为`XYZ.jar`.

我的问题是打包使用 XYZ.jar 和 XYZ.properties 的项目。

我已经使用 mvn deploy:deploy-file 将 jar 添加到我们的 repo 中。

```
mvn deploy:deploy-file -Dfile=xyz.jar -Durl=<someurl> -DgroupId=thirdparty.xyz 
-DartifactId=xyz -Dversion=1.0 -Dpackaging=jar -DrepositoryId=thirdparty 
```

我还在我的项目 pom.xml 中添加了 XYZ 的依赖项，例如：

```
<dependency>
    <groupId>thirdparty.xyz</groupId>
    <artifiactId>xyz</artifactId>
    <version>1.0</version>
</dependency> 
```

我的问题是如何添加属性文件？对它的两个限制是

1.必须与 2\. 属性文件的名称`XYZ.properties`必须在同一路径上。不应将版本号/工件 ID 附加到名称。`XYC.jar`
`XYZ.properties`

我如何在 Maven 中做到这一点？

我已经尝试打包属性文件并添加依赖项，但路径不同 - 即它进入自己的 group-artifact-version 文件夹。

一些说明：

1.  我项目的其余部分具有标准的 Maven 结构
2.  不幸的是，我无法改变第三方的`XYZ.jar`工作方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:59:08.057

你没有。如果愿意，您可以使用不同的包装以相同的方式部署属性文件，然后在依赖项中使用该包装，但您将无法在 repo 中指定名称。

但是，您可以使用依赖插件来检索工件并再次为其指定您想要的名称..

总的来说，最好将属性文件放在 jar 中。

# php - 使用 php 的方法包括绝对路径？

> ID：10761777
> 
> 赞同：1
> 
> 时间：2012-05-25T21:50:15.477
> 
> 标签：php

我正在尝试对 php 包含使用绝对路径。

现在我正在尝试这样做：

```
include($_SERVER['DOCUMENT_ROOT'].'/sitefolder/apis/db.php'); 
```

但它不起作用，因为我的站点没有指向根文件夹，所以我需要添加一个 /sitefolder。

有没有办法绕过这个产生一个绝对 URL？或者有没有办法允许绝对 URL 包括？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T21:54:42.727

制作一个initialize.php。

并定义您的站点根目录。

包括您的包含文件，例如 config.php、db.php。

并且只将 initialize.php 包含到您的文件中。

```
defined('DS') ? null : define('DS', '/');

defined('SITE_ROOT') ? null : define('SITE_ROOT',$_SERVER['DOCUMENT_ROOT']);
defined('LIB_PATH') ? null  : define('LIB_PATH', SITE_ROOT.DS.'includes');

require_once(LIB_PATH.DS.'functions.php');
require_once(LIB_PATH.DS.'session.php');
require_once(LIB_PATH.DS.'database.php'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:16:50.593

我倾向于使用以下技术来包含文件。

```
 include rtrim(dirname(__FILE__), '/\\') . DIRECTORY_SEPARATOR . 'my_file.php' ; 
```

如果它在同一个目录中，或者相对于同一个目录，你可以使用类似的东西（**为了简单起见，我排除了 rtrim 函数**）

```
include dirname(__FILE__) . '/file.php';
include realpath(dirname(__FILE__) . '/../dir') . '/file.php';
include realpath(dirname(__FILE__) . '/../dir/file.php'); 
```

定义常数也做得很好。

```
define('BASEDIR', dirname(__FILE__));
define('LIBDIR', BASEDIR . '/lib'); 
```

# python - Python处理多次

> ID：10761778
> 
> 赞同：0
> 
> 时间：2012-05-25T21:50:38.983
> 
> 标签：python

我正在创建一个小脚本来自动将文件从 .jpg 转换为 .png：

```
import glob, os
import Image

basedir = "C:\Users\User\Desktop\\fimg\images\\"
prefix  = "picture"

def convert_png():
    for jpg in glob.glob(os.path.join(basedir, '*.jpg')):
        filename = f.rsplit('.')[-2]
        njpg = Image.open(basedir + '%s.jpg' % (filename))
        njpg.save(basedir + '%s.png' % (filename))

        print "CONVERTED: " + filename + '.png'

for i, f in enumerate(os.listdir(basedir), 1):
    convert_png() 
```

但是有了这个，它似乎会多次转换文件（大约 10 次），因为它会打印这个数量的转换后的消息，然后再移动到下一个文件。这里有什么问题导致它这样做吗？

```
C:\Users\User\Desktop\fimg>python test.py
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 16094.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png
CONVERTED: 185500.png 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:31:33.847

```
import glob, os
import Image

basedir = "C:\Users\User\Desktop\\fimg\images\\"
prefix  = "picture"

def convert_png(base):
    njpg = Image.open(basedir + '%s.jpg' % base)
    njpg.save(basedir + '%s.png' % base)
    print "CONVERTED: " + base + '.png'

for i, f in enumerate(os.listdir(basedir), 1):
    base, ext = os.path.splitext(f)
    if ext == '.jpg': # found jpg file
        convert_png(base) 
```

问题在于嵌套循环：底部`for`，然后调用`convert_png`，它本身有另一个循环。我消除了循环，`convert_png`并通过仅在找到具有`.jpg`扩展名的文件时调用该函数来稍微简化代码。请注意使用`splitext`将文件名拆分为其基础和扩展名。

# python - 何时使用 __getattr__

> ID：10761779
> 
> 赞同：3
> 
> 时间：2012-05-25T21:50:39.497
> 
> 标签：python

我遇到了`__getattr__`内置的，想知道什么时候会使用它。我很难从文档
[http://docs.python.org/reference/datamodel.html#](http://docs.python.org/reference/datamodel.html#)中考虑实际用途。什么是它如何在代码中使用和有用的实际示例？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T22:09:08.147

一个例子是将对象表示法与字典一起使用。例如，考虑一个字典

```
myDict = {'value': 1} 
```

通常在 Python 中访问“值”变量为

```
myDict['value'] 
```

它将`1`在 Python 解释器上打印。然而，人们可能希望使用该`myDict.value`符号。这可以通过使用以下类来实现：

```
class DictAsMember(dict):
    def __getattr__(self, name):
        value = self[name]
        if isinstance(value, dict):
            value = DictAsMember(value)
        return value

my_dict = DictAsMember()
my_dict['property'] = {'sub_property': 1}

print(my_dict.property.sub_property) # 1 will be printed 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T21:53:25.860

一个示例用法是围绕某个对象创建一个简单的包装器。例如，为了记录调用或修改其行为而不继承它，也不必实现对象的整个接口。

那里有几个很好的记录示例，例如[http://western-skies.blogspot.fr/2008/02/complete-example-of-getattr-in-python.html](http://western-skies.blogspot.fr/2008/02/complete-example-of-getattr-in-python.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T22:10:53.230

由于`__getattr__`仅[在未找到属性时调用](https://stackoverflow.com/questions/3278077/difference-between-getattr-vs-getattribute-in-python)，因此它可能是一种有用的方法来定义查找属性的备用位置，或提供默认值，类似于`defaultdict`.

您还可以通过将此处的所有查找委托给另一个对象来模拟比对象的 MRO 中的所有其他基类更高的基类（尽管这样做，如果另一个对象将属性委托回，您可能会出现无限循环）。

还有`__getattribute__`, 相关的任何时候在对象上查找任何属性时都会调用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-25T22:09:07.213

编辑：这是关于内置函数`getattr`，而不是`__getattr__`方法。

我需要为使用不记名令牌的 REST 客户端执行此操作。[我将Requests](http://docs.python-requests.org/en/latest/index.html)的 Session 对象包装到我自己的界面中，这样我就可以始终发送 auth 标头，并且（更相关地）仅使用 URL 的路径向同一个站点发出 HTTP 请求。

```
class RequestsWrapper():
    def __init__(self, base_url):
        self.client = requests.Session(
            headers={'Authorization':'myauthtoken'}
        )
        self.base_url = base_url

    def _make_path_request(self, http_method, path, **kwargs):
        """
        Use the http_method string to find the requests.Session instance's
        method.
        """
        method_to_call = getattr(self.client, http_method.lower())
        return method_to_call(self.base_url + path, **kwargs)

    def path_get(self, path, **kwargs):
        """ 
        Sends a GET request to base_url + path.
        """
        return self._make_path_request('get', path, **kwargs)

    def path_post(self, path, **kwargs):
        """ 
        Sends a POST request to base_url + path.
        """
        return self._make_path_request('post', path, **kwargs)

    def path_put(self, path, **kwargs):
        """ 
        Sends a PUT request to base_url + path.
        """
        return self._make_path_request('put', path, **kwargs)

    def path_delete(self, path, **kwargs):
        """ 
        Sends a DELETE request to base_url + path.
        """
        return self._make_path_request('delete', path, **kwargs) 
```

然后，我可以根据路径发出请求：

```
# Initialize
myclient = RequestsWrapper("http://www.example.com")
# Make a get request to http://www.example.com/api/spam/eggs
response = myclient.path_get("/api/spam/eggs")
# Print the response JSON data
if response.ok:
    print response.json 
```

# php - 为什么我会得到相同的结果？

> ID：10761780
> 
> 赞同：0
> 
> 时间：2012-05-25T21:50:55.140
> 
> 标签：php, mysql, codeigniter

```
 $all = $this->input->get('all');

    if($all)
    {
        $keywords = $this->input->get('search');
        $data['search'] = $keywords;
        $this->session->set_flashdata('search', $keywords);
        $query = "SELECT *  FROM `investOffers`, `news`";
        $counts = "SELECT count(*) as count FROM  `investOffers`, `news`";
        $first = false;
        if($keywords)
        {
            $data['keywords'] = $keywords;
            $this->session->set_flashdata('keywords', $keywords);
            $keywords = explode(" ", $keywords);
            foreach($keywords as $k)
            {
                if(!$first)
                {
                    $query .= " WHERE investOffers.desc LIKE '% ".$k." %' OR investOffers.title LIKE '% ".$k." %'";
                    $query .= " OR news.desc LIKE '% ".$k." %' OR news.title LIKE '% ".$k." %'";
                    $counts .= " WHERE investOffers.desc LIKE '% ".$k." %' OR investOffers.title LIKE '% ".$k." %'";
                    $counts .= " OR news.desc LIKE '% ".$k." %' OR news.title LIKE '% ".$k." %'";
                    $first = true;

                }
                else
                {
                    $query .= " OR investOffers.desc LIKE '% ".$k." %' OR investOffers.title LIKE '% ".$k." %'";
                    $query .= " OR news.desc LIKE '% ".$k." %' OR news.title LIKE '% ".$k." %'";
                    $counts .= " OR investOffers.desc LIKE '% ".$k." %' OR investOffers.title LIKE '% ".$k." %'";
                    $counts .= " OR news.desc LIKE '% ".$k." %' OR news.title LIKE '% ".$k." %'";
                }
            }

        }
            $page = $this->uri->segment(2);
            if($page)
            {
                $query .= " ORDER BY investOffers.date DESC LIMIT ".$page.", 10";
                $counts .= " ORDER BY investOffers.date DESC LIMIT 10";
            }
            else
            {
                $query .= " ORDER BY investOffers.date DESC LIMIT 10";
                $counts .= " ORDER BY investOffers.date DESC LIMIT 10";
            }
        $data['query'] = $this->db->query($query);
        $counts = $this->db->query($counts);
        foreach($counts->result() as $q)
        {

        $count = $q->count;
        break;

        }
        $config['base_url'] = base_url().'/search';
        $config['prev_link'] = false;
        $config['next_link'] = false;
        $config['last_link'] = false;
        $config['first_link'] = false;
        $config['suffix'] = '?'.http_build_query($_GET, '', "&");
        $config['cur_tag_open'] = '<strong><img src="'.IMAGE.'pagerArrow.png" class="pagerArrow" />';
        $config['cur_tag_close'] = '</strong>';
        $from = intval($this->uri->segment(2));
        $config['per_page'] =  10;   
        $config['num_links'] = 5;    
        $config['uri_segment'] = 2;  
        $config['total_rows'] = $count; 
        $this->pagination->initialize($config);
        $data['pager'] = $this->pagination->create_links();
        $data['content'] = $this->load->view(SITE.'search', $data, true);
        $this->load->view(SITE.'layout', $data);
        return true;

    } 
```

所以这是一个搜索查询，首先我们检查一个搜索是否是“全部”，这意味着搜索所有站点，所以我制作了一个由空格分隔的关键字数组，输入到表单中，然后我把它放在一个视图中 preg_match 的 flash 会话，这是用于 preg_match 在生成的结果视图中突出显示文本，所以我将查询连接起来添加更多 LIKE ，所以问题是当我输入 1 个关键字时，它给了我不同的结果还可以，但是当我输入 2 个或多个关键字时，它给了我相同的结果，我的意思是一个完全相同的结果列表，我不明白为什么会这样，在视图中一切正常，问题在这个代码位置，我试图在查询中设置 th DISTINCT 关键字，但它没有帮助......

ps：这是codeigniter，MVC，这是一个控制器，我不使用模型，因为我不想打开很多文件:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:33:52.733

检查您的

```
$keywords = explode(" ", $keywords); 
```

返回的长度大于 1。由于您从 GET 获取 $keywords，因此您可能需要先对变量进行 urldecode，然后再将其传递给 explode 函数。

```
$keywords = urldecode($keywords); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:43:55.587

首先，我认为你应该使用[CI Active Record](http://codeigniter.com/user_guide/database/active_record.html)。它做了很多转义来防止像[SQL Injection](http://en.wikipedia.org/wiki/SQL_injection)这样的事情。我不是安全专家，但我认为您的代码很容易受到攻击。此外，CI Active Record 还具有[Active Record 缓存](http://codeigniter.com/user_guide/database/active_record.html#caching)，这在这种情况下很有用，因为您使用相同的 WHERE 事物进行选择和计数。

要调试，您可以查看最后一个查询`echo $this->db->last_query();`

在您的代码中，我注意到您在关键字之前和之后留下了空格`"LIKE '% {$keyword} %'"`。那是你的意图吗？我认为您的代码会错过关键字位于主题开头或结尾的情况。我认为这可能是您正在寻找的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:20:12.273

您的查询完全错误。如果你使用

```
SELECT * FROM table1, table2 
```

您在这两个表之间进行交叉连接，结果不正确。如果您想从多个具有相似结构的表中获取结果，则应改用 UNION 状态：

```
SELECT field1, field2, field3 FROM table1
UNION
SELECT field1, field2, field3 FROM table2 
```

如果您想使用 WHERE 子句，您可以通过 2 种方式进行：1：

```
SELECT field1, field2, field3 FROM (
SELECT field1, field2, field3 FROM table1
UNION
SELECT field1, field2, field3 FROM table2) as tt
WHERE your where conditions 
```

在这种情况下，您可以独立于表名对结果进行排序和限制

2：

```
SELECT field1, field2, field3 FROM table1
WHERE your where conditions
UNION
SELECT field1, field2, field3 FROM table2
WHERE your where conditions 
```

这样你就会得到正确的结果。有关 UNION 状态的更多信息，请访问[http://dev.mysql.com/doc/refman/5.0/en/union.html](http://dev.mysql.com/doc/refman/5.0/en/union.html)

# wordpress-theming - 最近的帖子，在侧边栏有摘录

> ID：10761783
> 
> 赞同：0
> 
> 时间：2012-05-25T21:51:16.270
> 
> 标签：wordpress-theming

我正在尝试在我的 wordpress 主题中截断或添加我最近的帖子的摘录。问题是我不知道文件所在的位置进行此修改。任何人都可以帮忙吗？

我用的是二十一主题，这里是网址：http://www.callmewhatyouwantevencheap.com/

正如您将在侧边栏中的网站上看到的那样，我有最近的帖子和最受欢迎的帖子。我不在乎最受欢迎。我只关心截断最近的帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T21:58:46.077

sidebar.php 是调用 wordpress 侧边栏钩子的地方。你可能只想设置一个自定义的 WP_Query，或者安装一个插件来更好地处理最近的帖子，我知道其中很多都内置了截断。

# nservicebus - NserviceBus（3.2版）自定义配置

> ID：10761784
> 
> 赞同：1
> 
> 时间：2012-05-25T21:51:20.803
> 
> 标签：nservicebus, nservicebus3

新手在这里需要帮助。

我一直在查看自定义配置文档。但是，我无法弄清楚缺少什么，或者我是否走在正确的道路上。我正在尝试使用 IWantCustomInitialization 进行自定义配置以动态创建消息队列（而不是 App.Config）并将消息发送到消息队列。

消息类如下：-

```
using System;
using NServiceBus;

namespace MyMessage
{
    [Serializable]
    public class EventMessage : ITaskInfo
    {
        public string CustomerName { get; set; }
        public string PrimeKey { get; set; }
        public string JobName { get; set; }
        public Guid JobRunId { get; set; }
    }

    public interface ITaskInfo : IMessage
    {
        string CustomerName { get; set; }
        string PrimeKey { get; set; }
        string JobName { get; set; }
        Guid JobRunId { get; set; }
    }
} 
```

测试应用程序如下：-

```
using System;
using NServiceBus;
using MyMessage;

namespace TestClient
{
    class DontSubscribe : IConfigureThisEndpoint, AsA_Client,
    IWantCustomInitialization
    {
        public void Init()
        {
            Configure.With()
            .DefineEndpointName("customendpoint")
            .Log4Net()
            .XmlSerializer()
            .DefaultBuilder()
            .MsmqTransport()
            .IsTransactional(true)
            .UnicastBus()
            .LoadMessageHandlers()
            .ImpersonateSender(false)
            .DoNotAutoSubscribe()
            .CreateBus().Start();
        }
    }

    public class Program : IWantToRunAtStartup
    {
        public IBus bus { get; set; }

        public void Run()
        {
            Console.WriteLine("Press enter to send a message.");

            while (Console.ReadLine() != null)
            {
                var msg = bus.CreateInstance<EventMessage>();
                msg.JobName = "JobName";
                msg.JobRunId = Guid.NewGuid();
                msg.PrimeKey = "PrimeKey";

                bus.Send("customendpoint", msg);
            }
        }

        public void Stop()
        {

        }

    }
} 
```

而且，App.config 如下：-

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<configSections>
<section name="MsmqTransportConfig"
type="NServiceBus.Config.MsmqTransportConfig, NServiceBus.Core"/>
</configSections>

<MsmqTransportConfig ErrorQueue="error" NumberOfWorkerThreads="1"
MaxRetries="0"/>

</configuration> 
```

我遇到以下错误：-

```
2012-05-24 15:33:10,386 [Worker.10] WARN NServiceBus.Unicast.Transport.Transact ional.TransactionalTransport [(null)] <(null)> - Failed raising 'transport messa ge received' event for message with ID=a7a885c5-2487-4049-9c41-2faa604c5767\214 System.InvalidOperationException: No handlers could be found for message type: M yMessage.ITaskInfo__impl at NServiceBus.Unicast.UnicastBus.HandleTransportMessage(IBuilder childBuilde r, TransportMessage msg) in d:\BuildAgent-01\work\nsb.master20\src\unicast\NServ iceBus.Unicast\UnicastBus.cs:line 1254 at NServiceBus.Unicast.UnicastBus.TransportMessageReceived(Object sender, Tra nsportMessageReceivedEventArgs e) in d:\BuildAgent-01\work\nsb.master20\src\unic ast\NServiceBus.Unicast\UnicastBus.cs:line 1171 at System.EventHandler`1.Invoke(Object sender, TEventArgs e) at NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.OnTrans portMessageReceived(TransportMessage msg) in d:\BuildAgent-01\work\nsb.master20\ src\impl\unicast\transport\NServiceBus.Unicast.Transport.Transactional\Transacti onalTransport.cs:line 480 
2012-05-24 15:33:10,386 [Worker.10] WARN NServiceBus.Unicast.Transport.Transact ional.TransactionalTransport [(null)] <(null)> - Failed raising 'transport messa ge received' event for message with ID=a7a885c5-2487-4049-9c41-2faa604c5767\214 System.InvalidOperationException: No handlers could be found for message type: MyMessage.ITaskInfo__impl at NServiceBus.Unicast.UnicastBus.HandleTransportMessage(IBuilder childBuilde r, TransportMessage msg) in d:\BuildAgent-01\work\nsb.master20\src\unicast\NServ iceBus.Unicast\UnicastBus.cs:line 1254 at NServiceBus.Unicast.UnicastBus.TransportMessageReceived(Object sender, Tra nsportMessageReceivedEventArgs e) in d:\BuildAgent-01\work\nsb.master20\src\unic ast\NServiceBus.Unicast\UnicastBus.cs:line 1171 at System.EventHandler`1.Invoke(Object sender, TEventArgs e) at NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.OnTrans portMessageReceived(TransportMessage msg) in d:\BuildAgent-01\work\nsb.master20\ src\impl\unicast\transport\NServiceBus.Unicast.Transport.Transactional\Transacti onalTransport.cs:line 480 
2012-05-24 15:33:11,290 [Worker.10] ERROR NServiceBus.Unicast.Transport.Transact ional.TransactionalTransport [(null)] <(null)> - Message has failed the maximum number of times allowed, ID=a7a885c5-2487-4049-9c41-2faa604c5767\214. 
```

对于像我这样的新手来说，任何指针、建议和评论都非常受欢迎。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:16:49.010

我已经有这几天的问题了......原来我错过了以下内容：

*   右键单击发布者的类库上的属性
*   单击调试选项卡
*   添加`NServiceBus.Integration`到命令行参数框。

它为我解决了这个问题，虽然我不知道为什么。

# html - R XML 包在解析 xml 和 html 文件时出现奇怪的错误

> ID：10761786
> 
> 赞同：1
> 
> 时间：2012-05-25T21:51:33.910
> 
> 标签：html, xml, r, xml-parsing, html-parsing

我正在使用 R 的 XML 包从各种 html 和 xml 文件中提取所有可能的数据。这些文件基本上是文档或构建属性或自述文件。

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE chapter PUBLIC '-//OASIS//DTD DocBook XML V4.1.2//EN'
                      'http://www.oasis-open.org/docbook/xml/4.0 docbookx.dtd'>

<chapter lang="en">
<chapterinfo>
<author>
<firstname>Jirka</firstname>
<surname>Kosek</surname>
</author>
<copyright>
<year>2001</year>
<holder>Ji&rcaron;&iacute; Kosek</holder>
</copyright>
<releaseinfo>$Id: htmlhelp.xml,v 1.1 2002/05/15 17:22:31 isberg Exp $</releaseinfo>
</chapterinfo>
<title>Using XSL stylesheets to generate HTML Help</title>
<?dbhtml filename="htmlhelp.html"?>

<para>HTML Help (HH) is help-format used in newer versions of MS
Windows and applications written for this platform. This format allows
to pack several HTML files together with images, table of contents and
index into single file. Windows contains browser for this file-format
and full-text search is also supported on HH files. If you want know
more about HH and its capabilities look at <ulink
url="http://msdn.microsoft.com/library/tools/htmlhelp/chm/HH1Start.htm">HTML
Help pages</ulink>.</para>

<section>
<title>How to generate first HTML Help file from DocBook sources</title>

<para>Working with HH stylesheets is same as with other XSL DocBook
stylesheets. Simply run your favorite XSLT processor on your document
with stylesheet suited for HH:</para>

</section>

</chapter> 
```

我的目标是在使用 htmlTreeParse 或 xmlTreeParse 解析树后使用类似这样的东西（对于 xml 文件..）

```
Text = xmlValue(xmlRoot(xmlTreeParse(XMLFileName))) 
```

但是，当我对 xml 和 html 文件执行此操作时，会出现一个错误。如果有 2 级或更高级别的子节点，则文本字段将被粘贴，它们之间没有任何空格。

例如，在上面的例子中

xmlValue(chapterInfo) 是

```
JirkaKosek2001JiKosek$Id: htmlhelp.xml,v 1.1 2002/05/15 17:22:31 isberg Exp 
```

每个子节点（递归）的 xmlValues 粘贴在一起，它们之间没有添加空格。如何让 xmlValue 在提取此数据时添加空格

非常感谢您提前提供的帮助，

希瓦尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T23:46:45.540

根据文档，`xmlValue`仅适用于单个文本节点，或“包含单个文本节点的 XML 节点”。非文本节点中的空格显然没有保留。

但是，即使在单个文本节点的情况下，您的代码也会去除空格。

```
library(XML)
doc <- xmlTreeParse("<a> </a>")
xmlValue(xmlRoot(doc))
# [1] "" 
```

您可以将`ignoreBlanks=FALSE`和`useInternalNodes=TRUE` 参数添加到`xmlTreeParse`, 以保留所有空格。

```
doc <- xmlTreeParse(
  "<a> </a>", 
  ignoreBlanks = FALSE, 
  useInternalNodes = TRUE
)
xmlValue(xmlRoot(doc))
# [1] " "

# Spaces inside text nodes are preserved
doc <- xmlTreeParse(
  "<a>foo <b>bar</b></a>", 
  ignoreBlanks = FALSE, 
  useInternalNodes = TRUE
)
xmlValue(xmlRoot(doc))
# [1] "foo bar"

# Spaces between text nodes (inside non-text nodes) are not preserved
doc <- xmlTreeParse(
  "<a><b>foo</b> <b>bar</b></a>", 
  ignoreBlanks = FALSE, 
  useInternalNodes = TRUE
)
xmlValue(xmlRoot(doc))
# [1] "foobar" 
```

# android - 组标题附近的Android ListView分隔线

> ID：10761787
> 
> 赞同：0
> 
> 时间：2012-05-25T21:51:37.997
> 
> 标签：android, listview, header, preferenceactivity, divider

我有几个 PreferenceGroup 的 PreferenceActivity。ListView 没有在 PreferenceGroup 的标题上方和下方显示分隔线。它如何知道是否显示该标题？

假设我有一个带有自定义适配器的 ListView。我怎样才能告诉它哪些条目是标题并且不应该在它周围有分隔线？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:03:36.260

这些不是标题，它们是分隔符。适配器通过返回at告诉`ListView`哪个项目是分隔符。`false``isEnabled`

[http://developer.android.com/reference/android/widget/BaseAdapter.html](http://developer.android.com/reference/android/widget/BaseAdapter.html)

> public boolean isEnabled (int position)
> 
> 如果指定位置的项目不是分隔符，则返回 true。（分隔符是不可选择、不可点击的项目）。

# c# - 时间：2019-05-10 标签：c#withasp.netgooglemap

> ID：10761788
> 
> 赞同：1
> 
> 时间：2012-05-25T21:51:45.883
> 
> 标签：c#, asp.net, google-maps

好的，我已经为此工作了几个小时。我无法获取地图以提取数据。我确实让它显示了地图，但现在不起作用。我正在使用 linq 并从数据库中提取。我希望我可以压缩我的文件并发送，但我会尝试解释。提前致谢。

这是apxdesign页面的代码

```
 <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">      </script>
        <script type="text/javascript">

            var geocoder;
            var map;

            function ginit() {

                var geocoder;
                var map;
                function initialize() {

                    //var mapdouble = <%=MapID()%>;
                    var matt = -34.397;
                    var latlng = new google.maps.LatLng(matt, 150.644);
                    var myOptions = {
                        //zoom: 8, 
                        //center: latlng,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
                }

                function codeAddress() {
                    var addresslookup = <%=gAddress()%>;
                    //var address = "9531 poplar hill drive crestwood kentucky 40014";
                    geocoder.geocode({ address: address }, function (results, status) {

                        if (status == google.maps.GeocoderStatus.OK) {

                            map.setCenter(results[0].geometry.location);

                            var marker = new google.maps.Marker({

                                map: map,
                                position: results[0].geometry.location

                            });
                        } else {

                            alert("Geocode was not successful for the following reason: " + status);

                        }
                    });
                }
            }
          </script>
    </head>
    <body onload="ginit()">
        <form id="form1" runat="server">
        <div id="map_canvas" style="height: 400px; width: 400px">
        </div>
        </form>
    </body>
    </html> 
```

这是页面背后的代码。在我尝试地理编码之前它一直有效。只需映射它，但只要我添加其他代码，它就会中断。我确实有正确的变量过来，我也尝试手动添加它们。

这是编码页面

```
 namespace WebApplication7
 {
public partial class WebForm1 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

        //string id = Request.QueryString["ID"];
       // MapID();
        //gAddress();
    }

    public double MapID()
    {
        //string id = Page.Request.QueryString["ID"];
        double id = -34.397;

        double mapdouble = Convert.ToDouble(id);

        //Page.Response.Write(" here is the id " + id);

        return mapdouble;
    }

    public  string gAddress()
    {

        string newid = Page.Request.QueryString["ID"];

        double gid = Convert.ToDouble(newid);

        DataClasses1DataContext db = new DataClasses1DataContext();
        var address =(from p1 in db.Customers
                      where p1.ID == gid                          
                      select  p1.Address ).FirstOrDefault();

        var city = (from p1 in db.Customers
                       where p1.ID == gid
                       select p1.City).FirstOrDefault();

        var state = (from p1 in db.Customers
                    where p1.ID == gid
                    select p1.State).FirstOrDefault();

        var zip = (from p1 in db.Customers
                       where p1.ID == gid
                       select p1.Zip).FirstOrDefault(); 

        string addresslookup = address +", " + city +", " + state +", "+ zip;

         //Response.Write(address);
        return addresslookup;   
    } 
```

# c# - 在应用程序域之间快速传递大量数据

> ID：10761791
> 
> 赞同：3
> 
> 时间：2012-05-25T21:52:04.617
> 
> 标签：c#, appdomain

我有一个应用程序，用于将大型数据集（数百万条记录）从一个数据库导入另一个数据库，在此过程中进行比较（IE 删除已删除的内容、更新内容等）。由于许多外键约束等，为了加快应用程序的处理速度，它将整个目标数据库加载到内存中，然后尝试加载源数据库的部分内容并进行内存比较，更新记忆中的目的地。最后，它将这些更改写回目的地。数据库不是一对一匹配的，所以一个表中的一个表可能是另一个表中的多个表，等等。

所以我的问题是：目前运行这个过程需要几个小时（有时接近一天，具体取决于添加/更改的数据量），这使得调试变得非常困难。从历史上看，当我们遇到错误时，我们会进行更改，然后重新运行应用程序，该应用程序必须再次将所有数据加载到内存中（需要相当长的时间），然后运行导入过程，直到我们到达我们所在的部分然后我们交叉手指，希望我们的改变奏效。这不好玩:(

为了加快调试过程，我通过将导入代码移动到单独的 dll 中来进行架构更改，该 dll 加载到单独的 appdomain 中，以便我们可以卸载它、进行更改并重新加载它并尝试运行导入的一部分再次，从我们离开的地方开始，看看我们是否能得到更好的结果。当我想出这个计划时，我以为我是个天才 :) 但它有一个问题。我要么必须将目标数据库中的所有数据加载到第二个 appdomain 中，然后在卸载之前，使用 [Serializable] 交易将其全部复制到第一个（卸载和重新加载 dll 时这真的很慢）或加载主机 appdomain 中的数据，并在第二次使用 MarshalByRefObject 引用它（这似乎使整个过程变慢）

**所以我的问题是：我怎样才能快速做到这一点？就像，最多一分钟！我很想只复制数据，就好像它只是通过引用传递一样，而不必实际进行完整复制。**

我想知道是否有更好的方法来实现这一点，以便数据可以更好地在两者之间共享，或者至少在它们之间快速传递。我已经搜索并发现推荐使用数据库的东西（我们正在将数据加载到内存中以避免数据库）或者只是说使用 MarshalByRefObject 的东西。我想做一些那么简单的事情，但它还没有真正奏效。

我在某处读到加载 C++ dll 或非托管 dll 会导致它忽略应用程序域并可能引入一些问题。无论如何我可以利用它来发挥我的优势，IE，加载一个为我或其他东西保存我的列表的非托管 dll，并用它来欺骗我的应用程序为两个 appdomains 使用相同的内存，以便列表在我通过卸载应用程序域来卸载其他 dll？

我希望这是有道理的。这是我在这里的第一个问题，所以如果我做得很糟糕，请帮助我。这让我沮丧了几天。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T22:20:11.430

应用程序域方法是一种很好的分离方式，以便仅加载/卸载应用程序的一部分。不幸的是，正如您所发现的，在两个应用程序域之间交换数据并不容易/快速。这就像两个不同的系统进程试图进行通信，它总是比同一个进程通信慢。所以要走的路是使用最快的进程间通信机制。跳过 WCF，因为它会在此处显示您不需要的开销。使用[命名管道](http://msdn.microsoft.com/en-us/library/system.io.pipes.aspx)，您可以通过它非常快速地传输数据。我以前用过，效果很好。为了更快，您可以尝试`MemoryMappedFile`（[链接](http://msdn.microsoft.com/en-us/library/system.io.memorymappedfiles.memorymappedfile.aspx)），但这更难实现。从命名管道开始，如果太慢，请使用内存映射文件。

即使使用快速发送方式，您也可能遇到另一个瓶颈——数据序列化。对于大量数据，标准序列化（甚至是二进制）非常慢。您可能想查看 Google 的[协议缓冲区](http://code.google.com/p/protobuf-net/)。

关于 AppDomain 的一个警告 - 应用程序域之一中的任何未捕获的异常都会导致整个过程停止。不幸的是，他们并没有那么分开。

在旁注上。我不知道您的应用程序做了什么，但数百万条记录似乎并不过分。也许还有优化的空间？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-25T22:34:57.837

您没有说它是否是 SQL Server，但是您是否考虑过使用[SSIS](http://msdn.microsoft.com/en-us/library/ms141026.aspx)来执行此操作？显然[有一些技术](http://www.jamesserra.com/archive/2011/08/using-ssis-lookup-transformation-editor-with-millions-of-rows/)可以快速处理大数据。

# database - 为缓存系统选择数据库

> ID：10761796
> 
> 赞同：0
> 
> 时间：2012-05-25T21:52:44.880
> 
> 标签：database, caching, selection

我正在开发一个需要为其开发缓存的金融数据库。我有一个包含大量原始实时数据的 MySQL 数据库。然后使用 Flask (Python) 通过 HTTP API 提供这些数据。

在返回原始数据之前，它由我的 python 代码操作。这种操作可能涉及大量数据，因此需要一个缓存系统。

1.  缓存的数据永远不会改变。例如，如果有人查询从 2000 年 1 月 1 日到现在的时间范围内的数据，则该数据将作为从 2000 年 1 月 1 日到现在的专门操作的数据被操作、返回并存储在缓存中。如果稍后再次查询相同的操作数据，缓存将检索从 2000-01-01 到最后一次查询的值，从而消除整个期间的操作需要。然后，它将处理从那时到现在的新数据，并将其添加到缓存中。

2.  数据大小不应该很大（我会说最大低于 5GB）。

3.  我需要能够使用日期范围从缓存中检索。

我应该看哪个数据库？MongoDB？雷迪斯？沙发数据库？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T19:30:09.693

对如此小的数据集使用 BigData 解决方案似乎是一种浪费，并且可能仍然无法要求所需的延迟。似乎您需要的不是 MongoDB 或 CouchDB 等 BigData 解决方案之一，而是分布式缓存（或内存数据网格）。

XAP Elastic Caching 是一种领先的解决方案（我是它的贡献者之一），它似乎与您的需求完美匹配。有关详细信息，请参阅：[http ://www.gigaspaces.com/datagrid](http://www.gigaspaces.com/datagrid)

您可以找到一篇关于如何使用 DataGrid 扩展 MySQL 的文章准确描述这种情况：“Scaling MySQL” - [http://www.gigaspaces.com/mysql](http://www.gigaspaces.com/mysql)

# mkmapview - 旋转 MKMapKit

> ID：10761798
> 
> 赞同：1
> 
> 时间：2012-05-25T21:52:53.400
> 
> 标签：mkmapview, rotation, mapkit, mkoverlay

我正在尝试使用 MapKit 旋转 MKMapView。

我可以显示地图并旋转它，但效率不高。我创建了一个比视图大的 MKMapView 并使用 CGAffineTransformMakeRotation 旋转它，因此视图后面的灰色区域不可见。虽然我在 Interface Builder 中检查了剪辑子视图，但我仍然觉得这不是正确的实现。

此方法确实允许我旋转显示为 MKPinAnnotationView 符合 CGAffineTransformMakeRotation 函数的任何注释，但是在尝试向地图添加覆盖时遇到问题。

我可以在类声明中使用 boundingMapRect 属性进行叠加，但图像在显示器上保持不旋转。有没有办法做到这一点？或者我应该以不同的方法旋转 MKMapView 和注释？

提前感谢您提供任何建议或信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T02:11:45.830

您是否正在旋转地图以使其面向用户的方式相同？（即不仅仅是北=上）。如果是这样，您根本不需要做任何转换，只需将 MKUserTrackingMode 设置为 MKUserTrackingModeFollowWithHeading

# android - android：片段中的tabhost，带有片段作为选项卡

> ID：10761804
> 
> 赞同：4
> 
> 时间：2012-05-25T21:53:25.450
> 
> 标签：android, android-fragments, android-tabhost

我试图拥有一个包含在片段中的标签主机，其中标签内容由片段定义。好吧，

我从谷歌的[FragmentsTab](http://developer.android.com/resources/samples/Support4Demos/src/com/example/android/supportv4/app/FragmentTabs.html)示例开始。这显示了如何将片段用作选项卡内容，但其`TabHost`本身仍托管在活动中。同样，我需要将标签主机托管在片段中。

我举了个`FragmentsTab`例子，把代码`onCreate()`移到`onCreateView()`我的`Fragment`，

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View fragmentView = inflater.inflate(R.layout.detail_fragment, container);

    mTabHost = (TabHost) fragmentView.findViewById(android.R.id.tabhost);
    mTabHost.setup();

    mTabManager = new TabManager(getActivity(), mTabHost, R.id.realtabcontent);

    // TODO: localize
    mTabManager.addTab(mTabHost.newTabSpec("info").setIndicator("File Info"), InfoFragment.class, null);

    return fragmentView;
} 
```

当我跑步时，我得到了这个异常，

```
05-25 14:42:27.272: E/AndroidRuntime(4701): Caused by: java.lang.IllegalStateException: Recursive entry to executePendingTransactions
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1343)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:429)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at com.zimbra.octopus.android.TabManager.onTabChanged(TabManager.java:116)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.widget.TabHost.invokeOnTabChangeListener(TabHost.java:359)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.widget.TabHost.setCurrentTab(TabHost.java:344)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.widget.TabHost.addTab(TabHost.java:216)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at com.zimbra.octopus.android.TabManager.addTab(TabManager.java:92)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at com.zimbra.octopus.android.DetailFragment.onCreateView(DetailFragment.java:46)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:819)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1053)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:622)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1371)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:429)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at com.zimbra.octopus.android.TabManager.onTabChanged(TabManager.java:116)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.widget.TabHost.invokeOnTabChangeListener(TabHost.java:359)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.widget.TabHost.setCurrentTab(TabHost.java:344)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.widget.TabHost.addTab(TabHost.java:216)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at com.zimbra.octopus.android.TabManager.addTab(TabManager.java:92)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at com.zimbra.octopus.android.DetailFragment.onCreateView(DetailFragment.java:46)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:819)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1032)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentManagerImpl.addFragment(FragmentManager.java:1111)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:264)
05-25 14:42:27.272: E/AndroidRuntime(4701):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:563) 
```

查看跟踪，我看到`onCreateView()`了`DetailFragment`（承载`TabHost`）调用的片段递归。不知何故，对`TabManager.addTab()`（再次参见 FragmentsTab 示例）的调用导致对`DetailFragment.onCreateView()`.

我究竟做错了什么？这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:02:03.003

Android 不允许您将一个片段嵌入到其他片段中。您的 logcat 表明您正在另一个片段事务中执行一个片段事务（即递归条目到 executePendingTransactions）。只是不允许，对不起！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:14:55.240

在设置 TabHost 之前添加：

```
LocalActivityManager mLocalActivityManager = new LocalActivityManager(getActivity(), false);
mLocalActivityManager.dispatchCreate(savedInstanceState);
mTabHost.setup(mLocalActivityManager); 
```

# c# - 工作线程负载过重导致多个图标

> ID：10761806
> 
> 赞同：0
> 
> 时间：2012-05-25T21:53:40.680
> 
> 标签：c#

我有一个小问题，我会尽我所能解释。

我有一个应用程序有几个线程运行几件事。这是一个基于系统托盘的应用程序，因此在加载程序时不会加载任何表单。有趣的部分来了。我决定在工作线程上增加一些负载，因为我无法为我必须完成的工作创建一个新线程。我也有一个加载屏幕，所以当我打开表单并开始繁重的工作时，我的应用程序图标会增加 5 倍，看起来它创建了一个新的应用程序实例，而不是一个新进程。即使我构建项目并从那里运行它，它也会做同样的事情。

我以前对工人有更多的负担`thread`，但这并没有导致这种情况，但是现在当我`threads`为其他工作添加并在工作线程上放置新的工作线时，它突然表现得像这样。

可能是什么问题？

已解决：好吧，我有点愚蠢，因为我启动了几个实例而不是使用当前实例。我的错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T00:25:21.850

已解决：好吧，我有点愚蠢，因为我启动了几个实例而不是使用当前实例。我的错。

# objective-c - 是否将 textField 输入显示为不同视图上的标签？

> ID：10761808
> 
> 赞同：1
> 
> 时间：2012-05-25T21:53:53.143
> 
> 标签：objective-c, ios5, uitextfield, labels

就像我的问题所述。我想要一个 textField 并让用户输入一些内容并按下一个按钮，它会在不同视图上显示为标签？我会用来做什么。你能以代码形式举一个例子吗？另外，它会像 28 个不同的 TextField 一样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T11:00:53.140

为您的文本字段设置一个委托。[然后， UITextFieldDelegate 协议](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)的`textFieldDidEndEditing:`方法允许您拦截文本字段完成编辑后发生的事件。

然后，您的实现`textFieldDidEndEditing:`可以实例化一个`UILabel`（或某种其他类型的视图），其中包含用户输入到文本字段中的文本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-26T11:42:54.037

```
-(IBAction)clickButton:(id)sender{

if (!createViewController) {
                createViewController = [[CreateViewController alloc] initWithNibName:@"CreateViewController" bundle:nil];

            }

            UIBarButtonItem *backBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStylePlain target:nil action:nil];
            self.navigationItem.backBarButtonItem = backBarButtonItem;
            [backBarButtonItem release];
            [self.navigationController pushViewController:createViewController animated:YES];
} 
```

并传递`yourTextfield.text`给`CreateViewController`并分配给`yourLabel.text` 我认为这会对您有所帮助。

# actionscript-3 - 阅读并显示 Open Office 电子表格

> ID：10761809
> 
> 赞同：0
> 
> 时间：2012-05-25T21:54:01.253
> 
> 标签：actionscript-3, apache-flex, openoffice.org, openoffice-calc

我需要在我的 AIR 应用程序中找到一种解决方案来读取和显示 Open Office 电子表格。

我找到了一些关于 excel 的信息，但没有找到关于 Open Office 的信息。

我的愿望是在我的air应用程序中打开openoffice calc文档，我有一个梦想......

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T09:29:17.327

我最近根据您的功能要求为 xlsx 编写了一个 as3 导出器（数据应该非常简单，例如 office x 格式，开放式 office 格式是基于 xml 的）我将从这里开始[http://en.m.wikipedia.org/ wiki/OpenDocument](http://en.m.wikipedia.org/wiki/OpenDocument)并查找完整的规范。如果文档被压缩，请使用 no chump as3 zip 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T06:49:59.030

我没有尝试过自己，但是您可以按照 Flextras 的建议使用 move 来执行此操作，您可以使用[Read Text](http://extensions.services.openoffice.org/en/project/Read_Text)扩展来打开办公室，使用 Flex [iframe](http://livedocs.adobe.com/flex/3/html/help.html?content=AboutHTMLEnvironment_5.html)或您喜欢

或者，您可以使用 Ulteo 一个开放式办公室网络查看器，使用 Flex [Iframe查看](http://livedocs.adobe.com/flex/3/html/help.html?content=AboutHTMLEnvironment_5.html)[此](http://downloadsquad.switched.com/2007/12/12/run-openoffice-org-in-a-web-browser-no-installation-necessary/)内容，

[示例 IFrame 应用程序](http://www.deitte.com/IFrameDemo3/IFrameDemo.html)

希望有帮助

# iphone - 物理与图形互相争斗（box2d）

> ID：10761810
> 
> 赞同：1
> 
> 时间：2012-05-25T21:54:07.587
> 
> 标签：iphone, ios, cocos2d-iphone, box2d

所以我有一个球（精灵子类），可以在屏幕上拖动并更新它的身体以告诉世界它的位置。

问题是，当我在球被触摸（因此由手指控制）时对球施加力时，我有两段代码相互竞争以更新精灵的视觉位置。

世界步进器正在尝试跟踪物理并更新球的位置。然而，触摸方法也试图更新球的身体和图形位置。理想情况下，当被触摸时，我想杀死任何影响球的物理。

那么我究竟应该做些什么来巩固这一点呢？这也为冲突和过滤带来了问题。任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T11:11:10.257

你想让球有一个准确的物理模拟吗？如果没有，您总是可以像这样使用 b2body 类的 SetTransform 方法。

```
 CGPoint ballLocation = ;//use the touched location for this
    b2Vec2 vecBallLocation = b2Vec2(ballLocation.x / 32, ballLocation.y / 32);//calculate this on your own
    b2Body * ballBody = ;//replace this variable with your ball's b2Body;
    ballBody->SetTransform(vecBallLocation, ballBody->GetAngle()); 
```

不要手动设置球精灵的位置。把它留给物理模拟。如果您必须跟踪手动设置了哪些精灵以及哪些精灵使用物理模拟来更新它们的位置，那么随着时间的推移，您的代码会变得非常混乱。这种方式也容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T10:35:41.560

拖动物理对象时，在运行物理步骤模拟之前将其速度和角速度设置为 0,0。您可能还想暂时获取物理对象的位置，然后步进，然后将身体的位置设置回来，然后应用您从将手指移动到身体时获得的任何触摸拖动偏移量。

# asp.net - 如何在 ASP.NET 中动态更改 Facebook 元标记？

> ID：10761811
> 
> 赞同：0
> 
> 时间：2012-05-25T21:54:10.650
> 
> 标签：asp.net, facebook-like

我有一个在运行时呈现的 resources.aspx 页面，显示所有文章（标题、描述、图像和阅读更多链接），并显示每篇文章。我已经成功地在每个渲染的 div 上渲染社交媒体按钮（Facebook 的 Like、Twitter 的 Tweet、LinkedIn 的 Inshare 和 Google 的 G+）。现在，问题是当我点击 Facebook 的点赞按钮时，它只会将我页面的 URL 发布到我的时间轴上。我希望它发布文章的标题、图片和我设置的一些描述。如何使用 Open Graph 元标记完成它？我无法在运行时更改它们的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:40:01.777

我认为这是一个重言式，但是因为 Facebook 使用元标签来决定标题、描述等，如果您无法在运行时更改元标签值，您将无法更改标题, 运行时的描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:51:58.600

也许我误解了这个问题。如果是这样，请编辑您的问题以澄清。

为什么不能在运行时更改它们的值？您正在使用哪些 ASP.NET 的特定功能会阻止在运行时设置元标记值？Facebook 是否只是将您的 resources.aspx 文件视为 URL，还是您的每篇文章都有自己的 URL？

剃刀： `<meta property="og:description" content="@Model.YourCustomDescription"/>`

# php - 将js变量传递给php字符串

> ID：10761815
> 
> 赞同：4
> 
> 时间：2012-05-25T21:54:29.893
> 
> 标签：php, javascript

我需要一点帮助，我试图将 js 变量分页到使用 file_get_contents 在 php 中解析的 url。我不知道从哪里开始这样做。

```
<script type="text/javascript">
var js_variable = appl+goog+fb+mfst+nflx;
</script>

<?php
$ticker = js_varable_here;
$file = file_get_contents('http://finance.yahoo.com/d/quotes.csv?s=$ticker&f=soac1p2ghjkj1re');

?> 
```

任何建议都会受到赞赏，就像我说的那样，我对此一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:11:05.827

这是一个使用 jquery 的示例。

Javascript：

```
<script type="text/javascript">
  var js_variable = appl+goog+fb+mfst+nflx;
  $.post("/somephp.php", {ticker: js_variable}, function(data) {
    // returned from php
  });
</script> 
```

PHP：

```
 <?php
   $ticker = $_POST['ticker'];
   $file = file_get_contents("http://finance.yahoo.com/d/quotes.csv?s=$ticker&f=soac1p2ghjkj1re");
 ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:08:33.203

扩展Jashwant所说的......

PHP 是一种服务器端语言，它确实在幕后工作。Javascript 是客户端，它在本地客户端机器上运行和执行代码（即通过浏览器）。

但是，您可以使用 AJAX（异步 JavaScript 和 XML），以便本地客户端向服务器发送 HTTP 请求，而无需重新加载当前页面。例如，您可以使用 AJAX 将变量的内容发送到服务器。

为了更容易使用，您应该查看 jQuery 的有关 ajax 调用的方法。见：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

希望它运作良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T22:41:21.767

下面是如何使用 jquery post() 然后返回 json，您可以构建结果，因为您希望在 php 部分中输出，或者您可以使用 jquery 在结果中循环使用 each()。

```
<?php
if($_SERVER['REQUEST_METHOD']=='POST'
   && isset($_SERVER['HTTP_X_REQUESTED_WITH'])
   && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) === 'xmlhttprequest'){

    if(!empty($_POST['s'])){

        $ticker = $_POST['s'];
        $file = file_get_contents('http://finance.yahoo.com/d/quotes.csv?s='.$ticker.'&f=soac1p2ghjkj1re');

        header('Content-Type: application/json');
        echo json_encode(array('result'=>$file));
    }else{
        echo 'Request not allowed!';
    }
    die;
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" charset="utf-8"></script>
<script>
var js_variable = "appl+goog+fb+mfst+nflx";

$.post('this_script.php',{s: js_variable}, function(data) {
  $('#divResult').replaceWith('<div id="divResult">'+ data.result +'<div>');
});
</script>
</head>
<body>

<div id="divResult"><div>
</body>
</html> 
```

# c# - 跨 AppDomain 的损坏状态异常 (CSE)

> ID：10761822
> 
> 赞同：4
> 
> 时间：2012-05-25T21:55:09.760
> 
> 标签：c#, .net, exception-handling, corrupted-state-exception

对于一些背景信息，.NET 4.0 默认不再捕获 CSE：http: [//msdn.microsoft.com/en-us/magazine/dd419661.aspx](http://msdn.microsoft.com/en-us/magazine/dd419661.aspx)

我正在开发一个在新 AppDomain 中执行代码的应用程序。如果该代码抛出 CSE，如果未处理，异常会冒泡到主代码。我的问题是，我是否可以安全地假设第二个 AppDomain 上的 CSE 不会破坏主 AppDomain 中的状态，从而退出第二个 AppDomain 并继续运行主 AppDomain？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T23:28:50.743

在损坏状态异常的上下文中，通常，您不能再假设*任何事情*都是真实的。这些异常的关键是发生了一些事情，通常是由于有错误的非托管代码，这违反了 Windows 或 CLR 对内存结构所做的一些核心假设。这意味着，理论上，CLR 用来跟踪内存中存在哪些应用程序域的结构*可能*已损坏。导致 CSE 的各种事情通常表明事情已经发生了灾难性的错误。

说了这么多，在某些情况下，在某些情况下，您也许可以确定可以安全地从特定例外情况继续。`EXCEPTION_STACK_OVERFLOW`例如，一个 可能是可恢复的，而一个通常`EXCEPTION_ACCESS_VIOLATION`表示 Windows在有机会搞砸任何事情*之前就发现了一个潜在的错误。*如果您愿意冒险，这取决于您自己，这取决于您对首先抛出 CSE 的代码了解多少。

# compiler-errors - 无法在 Mac OSX Lion 上构建最新的 Freeswitch

> ID：10761824
> 
> 赞同：1
> 
> 时间：2012-05-25T21:55:38.463
> 
> 标签：compiler-errors, osx-lion, freeswitch

尝试在 Mac OSX Lion 上的 git 上构建 Freeswitch 的最新代码时出现此错误，在全新结帐并运行 ./boostraph.sh 和 ./configure 后：

```
making all mod_amr 
Creating mod_amr.so... 
i686-apple-darwin11-llvm-gcc-4.2: -bundle not allowed with -dynamiclib 
gcc -I/usr/local/src/freeswitch/libs/curl/include -I/usr/local/src/freeswitch/src/include -I/usr/local/src/freeswitch/src/include -I/usr/local/src/freeswitch/libs/libteletone/src -Werror -fvisibility=hidden -DSWITCH_API_VISIBILITY=1 -DHAVE_VISIBILITY=1 -g -ggdb -DMACOSX -DHAVE_OPENSSL -g -O2 -Wall -std=c99 -pedantic -Wdeclaration-after-statement -D_GNU_SOURCE -DAMR_PASSTHROUGH -shared -o .libs/mod_amr.so -dynamic -bundle -force-flat-namespace .libs/mod_amr.o /usr/local/src/freeswitch/.libs/libfreeswitch.dylib -lodbc -lresolv -L/usr/local/src/freeswitch/libs/apr-util/xml/expat/lib -lpq /usr/local/src/freeswitch/libs/apr-util/xml/expat/lib/.libs/libexpat.a /usr/local/src/freeswitch/libs/apr/.libs/libapr-1.a -lpthread -lm -L/usr/local/src/freeswitch/libs/srtp -ldl -lssl -lcrypto -lz -lncurses /usr/local/lib/libjpeg.dylib /usr/local/lib/libodbc.dylib -liconv 
make[5]: *** [mod_amr.so] Error 1 
make[4]: *** [all] Error 1 
make[3]: *** [mod_amr-all] Error 1 
make[2]: *** [all-recursive] Error 1 
make[1]: *** [all-recursive] Error 1 
make: *** [all] Error 2 
```

如果我要注释掉有问题的模块，那么对于任何数量的其他模块都会出现相同的“-dynamiclib 不允许捆绑”。我已经安装了 Mac OSX 的所有先决条件（据我所知），包括 Apple 和 Unix 开发工具。我是 100% macports/fink/brew free，AFAIK。

我的感觉这是我的设置缺少工具或配置问题（几乎全新的 Lion 安装）。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:02:53.280

我认为这是 Freeswitch 构建系统的问题。它为编译器提供了两个互斥标志`-bundle`和。`-dynamiclib`

您可能想查看他们的错误跟踪器并可能提交错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-29T06:39:38.537

我得到了同样的错误，虽然来自不同的来源。我正在编译 Cython，并`CFLAGS`为我链接到的外部库添加了一些额外的内容。这些标志包含`shared`，而自动`Cython`包含（使用从内部`-bundle`编译）。`distutils``setup.py`

该`-shared`标志没有明确出现在选项中，这令人困惑。按照[此建议](https://bugs.launchpad.net/pyvlfeat/+bug/1150009/comments/3)删除该`-shared`选项解决了该问题。

通过谷歌搜索此错误以供使用`Cython`.

# javascript - 未捕获的 TypeError：使用 onload 时出现类型错误

> ID：10761825
> 
> 赞同：1
> 
> 时间：2012-05-25T21:55:42.117
> 
> 标签：javascript, canvas, onload

好的，我被卡住了。我正在尝试将图像插入画布，Chrome 不断给我 Uncaught TypeError: onload 方法的类型错误。这是我的javascript：

```
letterBase = new Image();
letterBase.onload = function() {
    context.drawImage(letterBase, 0, 0);
    console.log("drawing image");
  };
  letterBase.src = "/assets/letter/" + Character.letter + ".png";
  console.log(letterBase); 
```

这很奇怪，因为我可以看到图像正在从 console.log(letterBase) 加载到控制台中，但我真的看不出这里出了什么问题。有任何想法吗？

![在此处输入图像描述](../Images/a99fa23b14c3d2c979f43f7356a1b71e.png)

编辑：我不认为这是问题所在，但我有代码设置上下文如下：

```
$(document).ready(function() {
    // some other init functions...
    canvas = document.getElementById("characterCanvas");
    context = canvas.getContext("2d");
    // ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T00:16:32.937

我弄清楚了问题所在。设置源并加载图像后，我正在清除变量

```
letterBase.src = "" 
```

这导致 onload 再次触发，但这次没有来源。菜鸟错误。

# python - Python - 确定 3 个范围的重叠

> ID：10761833
> 
> 赞同：4
> 
> 时间：2012-05-25T21:57:36.780
> 
> 标签：python, range, overlap

我有一个关于如何在不使用任何现有库的情况下确定 Python 中三个范围的重叠的问题：

例如，如果我有三个范围（10,20）（15,25）（18,30），我应该如何寻找它们之间的重叠？

我的答案应该是 (18,19,20)

任何帮助将非常感激。谢谢 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T22:03:28.930

重叠从最高起点到最低终点：

```
ranges = [(10,20), (15,25), (18,30)]
starts, ends = zip(*ranges)
result = range(max(starts), min(ends) + 1) 
```

测试：

```
>>> print(*result)
18 19 20 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T22:13:07.837

虽然[WolframH 的答案](https://stackoverflow.com/a/10761869/722121)是这种情况下的最佳答案，但可以使用更通用的解决方案来查找重叠，因为您无需担心重复元素，即使用集合及其`intersection`操作。

```
>>> set(range(10, 21)) & set(range(15, 26)) & set(range(18, 31))
{18, 19, 20} 
```

或者，作为更通用的解决方案：

```
ranges = [(10, 20), (15, 25), (18, 30)]
set.intersection(*(set(range(start, finish+1)) for start, finish in ranges)) 
```

# android - 如何将 JSON 对象放入我的 ListView 片段？

> ID：10761835
> 
> 赞同：0
> 
> 时间：2012-05-25T21:57:45.233
> 
> 标签：android, json, android-listview

我正在逐步通过从 mySQL 服务器收集数据，通过 PHP 将其转换为 JSON，使用 AQuery 异步获取 JSON，将结果转换为字符串/对象，但现在如何将字符串获取到我的 lisview 项目和在我的列表片段活动中显示它？

（ PS：我知道 JSON 数据通过 Log.i() 存在，并且没有捕获 JSONException 错误）

谢谢你的输入

在我的主要活动中：

```
public void onCreate(Bundle savedInstanceState)
    {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    FragmentManager fm = getFragmentManager();
    Fragment vC = fm.findFragmentById(R.id.viewContainer);
    Fragment lC = fm.findFragmentById(R.id.listContainer);
    if (vC == null)
    {
    FragmentTransaction ft = fm.beginTransaction();
    ft.add(R.id.viewContainer, new WebViewFragment());
    ft.commit();
    }
    if (lC == null)
    {
    FragmentTransaction ft = fm.beginTransaction();
    ft.add(R.id.listContainer, new NavigationListFragment());
    ft.commit();
    }
... 
```

列出 Frag 活动：

```
public class NavigationListFragment extends ListFragment
{
    Context context;

    @Override
    public void onActivityCreated(Bundle savedInstanceState)
    {
    super.onActivityCreated(savedInstanceState);
    AsyncTasks.getJSONArray(context);// asynchronous task for getting JSON array
    }

    @Override
    public void onSaveInstanceState(Bundle outState)
    {
    // TODO
    }

    @Override
    public void onAttach(Activity activity)
    {
    super.onAttach(activity);
    // TODO
    }

    static int q_id;
    static String label;
    static String title;
    static String description;
    static String gotoURL;

    public static void jsonListCallback(JSONArray json)
    {
    try
    {
    Log.i("NavigationListFragment", json.toString());

    // Parse the string to a JSON object
    for (int i = 0; i < json.length(); i++)
    {
    JSONObject json_data = json.getJSONObject(i);
    q_id = json_data.getInt("_id");
    label = json_data.getString("label");
    title = json_data.getString("title");
    description = json_data.getString("description");
    gotoURL = json_data.getString("gotoURL");
    }
    } catch (JSONException e)
    {
    Log.e("log_tag", "Error parsing data " + e.toString());
    }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
    {
    final View view = inflater.inflate(R.layout.listview, container, false);

    return view;
    }
} 
```

异步任务类：

```
public class AsyncTasks
{
    public static void getJSONArrays(final Context c)
    {
    // initialize
    final AQuery aq = new AQuery(c);

    String url = "http://192.168.1.11/Andaero/php/regulatory_list.php";
    // long expire = -1; TODO
    aq.ajax(url, JSONArray.class, new AjaxCallback<JSONArray>()
    {
        public void callback(String url, JSONArray json, AjaxStatus status)
        {
        if (json != null)
        {
        NavigationListFragment.jsonListCallback(json);// Send the JSON
                                  // Array back to
                                  // the list
                                  // fragment
                                  // activity
        }
        switch (status.getCode())
        {
            case AjaxStatus.TRANSFORM_ERROR:
            Log.i("GetJSONArray", "TRANSFORM_ERROR");
            break;
            case AjaxStatus.NETWORK_ERROR:
            Log.i("GetJSONArray", "NETWORK_ERROR");
            // TODO Create Alert Dialog
            case AjaxStatus.AUTH_ERROR:
            Log.i("GetJSONArray", "AUTH_ERROR");
            break;
        }
        }
    });
    }
} 
```

我的列表视图 XML：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/listLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@id/android:list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:divider="#003399"
        android:dividerHeight="1dp"
        android:layoutAnimation="@anim/layout_animation_row_left_slide" />

</LinearLayout> 
```

列表项 XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/acItem"
    style="@style/listItem" >

    <TextView
        android:id="@+id/listLabel"
        style="@style/listAcronym" />

    <TextView
        android:id="@+id/listTitle"
        style="@style/listTitle" />

    <TextView
        android:id="@+id/listDiscription"
        style="@style/listDiscription" />

    <TextView
        android:id="@+id/dummy"
        style="@style/listDiscription" />

    <TextView
        android:id="@+id/dateAdded"
        style="@style/listDates" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:00:56.543

使用`FragmentManager`查找您的片段（通过 id 或标签），将其转换为`NavigationListFragment`并在其上调用（非静态）方法以设置 JSON 对象。

假设`Fragment lC = fm.findFragmentById(R.id.listContainer);`是您所指的片段，您可以简单地执行以下操作：

```
NavigationListFragment navListFragment = (NavigationListFragment)lC;
navListFragment.someNonStaticMethod(); 
```

# linux - 获得无与伦比的“。在一个简单的 csh ssh 脚本上

> ID：10761838
> 
> 赞同：0
> 
> 时间：2012-05-25T21:58:11.813
> 
> 标签：linux, ssh, foreach, csh

我正在尝试使用 foreach 连接到一组机器以检查文件是否存在，但是我不断收到 unmatched " 错误，我尝试了很多方法和大量转义字符来尝试使其工作。 ..但是我仍然收到错误，这是代码：

```
foreach i ( machineA machineB machineC machineD machineE )
foreach? echo $i":"
foreach? ssh -q $i "\[ -f /etc/init.d/myprog \] \&\& echo \"File exists\" \|\| echo \"File does not exist\""
foreach? end
machineA:
Unmatched ". 
```

可能有些愚蠢，但在过去的几个小时里我一直试图让它工作但没有成功......

我试图通过 ssh 远程执行的行是这样的：

```
[ -f /etc/init.d/myprog ] && echo "File exists" || echo "File does not exist" 
```

并且还尝试了这种方式（在其他几种方式中）：

```
foreach? ssh -q -o "BatchMode=yes" $i "[ -f /etc/init.d/netbatch ]" && echo \"File exists\" \|\| echo \"File does not exists\"" 
```

非常感谢您的帮助！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T22:23:00.200

以我的经验，引用 csh 总是有点狡猾。

试试这个：

```
foreach i ( machineA machineB machineC machineD machineE )
echo $i":"
ssh -q $i '[ -f /etc/init.d/myprog ] && echo "File exists" || echo "File does not exist"'
end 
```

没有任何东西在单引号中展开，这消除了转义所有内容的需要。

# php - ExpressionEngine 无法通过模板拉入条目

> ID：10761841
> 
> 赞同：0
> 
> 时间：2012-05-25T21:58:39.353
> 
> 标签：php, content-management-system, dynamic-data, expressionengine

嘿伙计们，我正忙着通过模板引入新条目（或任何条目），并希望我错过了一些愚蠢的东西。我现在以这种方式设置了我的内容。

![频道](../Images/bb6f1b1acaeae7035b0ad504f1698636.png)

然后这是博客索引的布局，据我了解这应该显示所有条目？

```
{exp:channel:entries}
  Show everything?
{/exp:channel:entries} 
```

![博客索引](../Images/3a1d8119b68b9a31eadf8bb8ea949473.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:55:40.940

要使用条目标签，您还需要为其提供一个从中提取数据的通道，请参阅[http://expressionengine.com/user_guide/modules/channel/channel_entries.html](http://expressionengine.com/user_guide/modules/channel/channel_entries.html)以获取文档。为了从多个通道中提取或获取所有数据，您需要像这样在标签上将它们分开

```
{exp:channel:entries channel="blog|news"}
    Stuff here such as {title}, and {body} depending on how your custom fields are set up
{/exp:channel:entries} 
```

# c# - PrincipalContext如何登录域服务器

> ID：10761844
> 
> 赞同：2
> 
> 时间：2012-05-25T21:58:43.473
> 
> 标签：c#, active-directory

我有以下 C# 代码连接到我的域服务器并对其执行一些操作。在我的电脑上一切正常，我可以很好地运行我的所有命令。

我的问题是：什么凭据用于连接到服务器？我假设它使用当前用户的凭据。所以我真正的问题是这是否适用于普通用户。我是管理员，它在我的机器上运行良好。

但是我想知道对于非管理员是否同样适用？

```
PrincipalContext AD = new PrincipalContext(ContextType.Domain, "172.18.4.4");

UserPrincipal u = new UserPrincipal(AD);
u.SamAccountName = Environment.UserName;

PrincipalSearcher search = new PrincipalSearcher(u);

UserPrincipal result = (UserPrincipal)search.FindOne(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T22:52:46.120

如果该代码在 Windows 应用程序中运行，则使用的凭据是当前 Windows 用户的凭据，它应该可以在域中正常工作。如果代码在 ASP.NET 站点中运行，则凭据是运行该站点的应用程序池的凭据。在最后一种情况下，您可能需要使用应用程序池的标识：LocalSystem、NetworkService...

在前面的任何一种情况下，您都可以冒充用户在以下情况下运行此代码：（查看答案）

[如何正确使用 LogonUser 从工作组客户端模拟域用户](https://stackoverflow.com/questions/5023607/how-to-use-logonuser-properly-to-impersonate-domain-user-from-workgroup-client)

# c - 使用 C 发送 smtp 电子邮件，不接受用户名和密码

> ID：10761846
> 
> 赞同：0
> 
> 时间：2012-05-25T21:58:47.030
> 
> 标签：c, email, smtp

我正在尝试向我的电子邮件帐户发送一封简单的短信，但由于某种原因，我的代码无法正常工作。这就是我到目前为止所拥有的...

```
int SendStartUpMail(char* mailserver, int port, char* user, char* pass)
{
     SOCKET sslSock;
     SOCKADDR_IN sslInfo;
     SSL_CTX *ctx;
     SSL *ssl;

     char bufferRecv[BUFFER_LEN];
     char bufferSend[BUFFER_LEN];
     int byte;

     sslSock = openConnection(mailserver, port);
     memset( bufferRecv, '\0', BUFFER_LEN );
     byte = recv(sslSock,bufferRecv,BUFFER_LEN,0);
     if(byte == SOCKET_ERROR)
         return -1;
     printf("%s\n",bufferRecv);

     strcpy(bufferSend,"HELO\r\n");
     send(sslSock,bufferSend,strlen(bufferSend),0);
     memset( bufferRecv, '\0', BUFFER_LEN );
     byte = recv(sslSock,bufferRecv,BUFFER_LEN,0);
     if(byte == SOCKET_ERROR)
         return -1;
     printf("%s",bufferRecv);

     strcpy(bufferSend,"STARTTLS\r\n");
     send(sslSock,bufferSend,strlen(bufferSend),0);
     memset( bufferRecv, '\0', BUFFER_LEN );
     byte = recv(sslSock,bufferRecv,BUFFER_LEN,0);
     if(byte == SOCKET_ERROR)
          return -1;
     printf("%s",bufferRecv);

     SSL_library_init();
     ctx = SSL_CTX_new(SSLv3_client_method());
     if ( ctx == NULL )
         return -1;
     ssl = SSL_new(ctx);
     if ( ssl == NULL )
         return -1;
     SSL_set_fd(ssl, sslSock);  

     if ( SSL_connect(ssl) == 1 )
     {
         strcpy(bufferSend,"HELO\r\n");
         SSL_write(ssl,bufferSend,strlen(bufferSend));
         memset( bufferRecv, '\0', BUFFER_LEN );
         SSL_read(ssl,bufferRecv,BUFFER_LEN);
         printf(">%s\n",bufferRecv);

         strcpy(bufferSend,"AUTH LOGIN\r\n");
         SSL_write(ssl,bufferSend,strlen(bufferSend));
         memset( bufferRecv, '\0', BUFFER_LEN );
         SSL_read(ssl,bufferRecv,BUFFER_LEN);
         printf(">%s\n",bufferRecv);

         strcpy(bufferSend,"USER c29tZXVzZXJuYW1lQGdtYWlsLmNvbQ==\r\n");         
         SSL_write(ssl,bufferSend,strlen(bufferSend));
         memset( bufferRecv, '\0', BUFFER_LEN );
         SSL_read(ssl,bufferRecv,BUFFER_LEN);
         printf(">%s\n",bufferRecv);

         strcpy(bufferSend,"PASS c29tZXBhc3N3b3Jk\r\n");         
         SSL_write(ssl, bufferSend,strlen(bufferSend));
         memset( bufferRecv, '\0', BUFFER_LEN );
         SSL_read(ssl,bufferRecv,BUFFER_LEN);
         printf(">%s\n",bufferRecv);
     }
     else
     {
         printf("Error on SSL_connect\n");  
         SSL_free(ssl);
         SSL_CTX_free(ctx);
         close(sslSock); 
         return -1; 
     }
     SSL_free(ssl); 
     SSL_CTX_free(ctx);
     close(sslSock);

} 
```

当我运行此代码时，我从 smtp 服务器收到一些消息：

```
> 220 mx.google.com ESMTP 
> 250 mx.google.com at your service
> 220 2.0.0 Ready to Start TLS
> Conected with RC4-SHA encryption
> 250 mx.google.com at your service
> 334
> 334
> 535-5.7.1 Useername and Password not accepted 
```

如您所见，他们说我的密码和用户名错误，但我知道，这并没有错。我在发送之前使用 base64 编码对我的用户名和密码进行编码，我使用此站点对其进行编码[http://base64-encoder-online.waraxe.us/](http://base64-encoder-online.waraxe.us/) 我使用端口 587。

我的问题是我还有其他事情要做吗？？？谢谢。

我还尝试使用谷歌两步验证应用程序特定密码，但它仍然无法登录。

我尝试连接到 hotmail 并得到一个不同的错误，而不是我得到的错误 535

> 451 请求操作中止：处理中的本地错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:53:54.937

使用我自己的帐户进行测试，`AUTH LOGIN`不起作用，但`AUTH PLAIN`工作得很好：

```
250 ENHANCEDSTATUSCODES
auth plain
334 
c29tZXVzZXJAZ21haWwuY29tAHNvbWV1c2VyQGdtYWlsLmNvbQBzb21lcGFzc3dvcmQ=
235 2.7.0 Accepted 
```

那是 base64 编码版本的`someuser@gmail.com\x00someuser@gmail.com\x00somepassword`.

# python - 使用 Python 在 CSV 输入中处理多种数据类型的问题

> ID：10761851
> 
> 赞同：0
> 
> 时间：2012-05-25T21:59:31.343
> 
> 标签：python

我有一个 csv 转储，我正在尝试导入以对其中的指标进行分析，挑选某些指标进行查看。有些单元格是字符串，有些是数字。但是，我无法让 csv.reader 正确处理这些数字。一个片段：

```
with open('t0.csv', 'rU') as file:
    reader = csv.reader(file, delimiter=",", quotechar='|')
    reader.next() # Burn header row
    for row in reader:
        if row[0] != "": # Burn footer row
            t0_company.extend([unicode(row[3], 'utf-8')])
            t0_revenue.extend([row[9]])
            t0_clicks.extend([row[10]])
            t0_pageviews.extend([row[11]])
            t0_avg_cpc.extend([row[13]])
            t0_monthly_budget.extend([row[16]]) 
```

我在 t1 为度量输入了另一个相同格式的文件。然后我为每个指标创建两个字典（一个在 t0，另一个在 t1），格式为 metric_dict = {'company': 'metric'}，如下所示：

```
metric = dict(zip(company, metric)) 
```

然而，在这些指标上运行简单的数学是有问题的：

```
percent_change = float(t1_metric_dict[company]) / float(t0_metric_dict[company]) - 1 
```

返回如下错误：

```
Traceback (most recent call last):
File "report.py", line 104, in <module>
start_revenue_dict[company], end_revenue_dict[company], float(end_revenue_dict[company]) / float(start_revenue_dict[company]) - 1,
ValueError: could not convert string to float: "6.18" 
```

似乎每次都选择同一个号码来抱怨。

我相当肯定错误发生在除法中，因为如果我将占位符字符串作为第三个元素交换，一切正常。

我还尝试使用 quoting=csv.QUOTE_NONNUMERIC，将第一个片段中的第二行更改为

```
reader = csv.reader(file, delimiter=",", quotechar='|', quoting=csv.QUOTE_NONNUMERIC) 
```

这让我遇到了这个错误：

```
Traceback (most recent call last):
File "report.py", line 30, in <module>
reader.next()
ValueError: could not convert string to float: "Type" 
```

我已经尝试确保 csv 没有任何奇怪的单元格类型（一切都是文本），即使我怀疑它是否重要。我将不胜感激任何帮助。

- - - 更新 - - -

我的输入文件中的一列包含电子邮件地址。作为一个实验，我从输入文档中删除了所有@s，这改变了我得到的错误消息：

```
Traceback (most recent call last):
File "report.py", line 129, in <module>
unicode_row = [str(item).encode('utf8') for item in utf8_row]
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe9' in position 2: ordinal not in range(128) 
```

它引用的代码是 csv out 部分：

```
writer = csv.writer(open('output.csv', 'wb'), delimiter=",", quotechar='|')
for utf8_row in report:
    unicode_row = [str(item).encode('utf8') for item in utf8_row]
    writer.writerow(unicode_row) 
```

----- 更新 #2 -----

根据要求，这是导致问题的完整片段：

```
for company in companies_in_both:
report.append([company,
      start_revenue_dict[company], end_revenue_dict[company], float(end_revenue_dict[company]) / float(start_revenue_dict[company]) - 1,
      start_clicks_dict[company], end_clicks_dict[company], float(end_clicks_dict[company]) / float(start_clicks_dict[company]) - 1,
      start_pageviews_dict[company], end_pageviews_dict[company], float(end_pageviews_dict[company]) / float(start_pageviews_dict[company]) - 1,
      start_avg_cpc_dict[company], end_avg_cpc_dict[company], float(end_avg_cpc_dict[company]) / float(start_avg_cpc_dict[company]) - 1,
      start_monthly_budget_dict[company], end_monthly_budget_dict[company], float(end_monthly_budget_dict[company]) / float(start_monthly_budget_dict[company]) - 1]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:41:54.120

您确定`'|'`使用它是正确的`quotechar`吗？我看到您有许多 CSV 问题，并且您的所有示例都使用它，所以也许这确实是您想要的。但这是惊人的不寻常。

您的消息告诉*您 data 中*`ValueError`有双引号。也就是说，Python 没有做相当于 的 ，而是试图做，而且令人窒息。*`float("6.18")``float('"6.18"')`*

 *提供几行*完整*的实际 CSV 数据可能会有所帮助，包括错误发生的位置，如使用记事本或同等工具查看的那样（前提是它不是机密的、法律敏感的等）。*

# makefile - makefile 未检测到新的保存文件

> ID：10761861
> 
> 赞同：0
> 
> 时间：2012-05-25T22:02:17.327
> 
> 标签：makefile

奇怪的事情发生：

makefile 的想法是能够同时编译多个文件。如果您编辑其中一个文件，当您键入 时`make`，唯一应该编译的文件就是已编辑的文件。

现在，由于某种原因，我的 makefile 决定停止识别文件何时更改。所以我必须：`make clean`并且`make`再次能够编译，这很荒谬，因为每次我必须编译大约需要 1 分钟。

任何想法为什么会发生这种情况？

我没有在我的makefile中添加任何东西；它只是突然开始这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:26:41.167

发生了一些变化；除非有所改变，否则程序不会停止工作。困难在于弄清楚发生了什么变化。您可以随时输入：

```
 rm file-that-changed.o
 make 
```

仅重建一个已更改的文件，但这是一件麻烦事。

是否有一个多步骤编译，并且您有一个令人困惑的中间文件`make`？

> 我只是在多步骤编译中搞混了。

* * *

如果你有一个非标准的文件后缀，你编译成 C 代码，然后从 C 到目标代码（或任何其他类似的多步编译），那么获得可靠重新编译的关键[`make`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/make.html)是组织后缀列表，以便您的扩展从一开始就出现。不幸的是，没有一个标准的简单方法可以知道内置后缀列表是什么，所以你最终不得不做这样的事情：

```
SUFFIXES     = .y .l .c .o       # Yacc, Lex, C, Object files
EXTRA_SUFFIX = .xc               # Extreme C, or Extended C, or ...

.SUFFIXES:                       # Eliminate all built-in suffixes
.SUFFIXES: ${EXTRA_SUFFIX} ${SUFFIXES} 
```

第二`.SUFFIXES`行将您的分机放在列表的前面。现在您可以编写规则以将`.xc`文件编译为`.c`or`.o`文件，然后在修改`.xc`文件时，即使`.c`留下中间文件，该文件`.xc`比`.c`or`.o`文件更新的事实将确保重新编译完成。

很久以前，Sun 版本`make`提供了一个名为 SUFFIXES 的宏，其中包含按正确顺序排列的默认后缀。遗憾的是，这并没有被采用和标准化，因此您必须自己构建后缀列表。但宏名的选择并非完全出于偶然。

# android - 保存android活动状态

> ID：10761867
> 
> 赞同：1
> 
> 时间：2012-05-25T22:02:54.483
> 
> 标签：android, state, android-activity, activity-lifecycle

我尝试创建 LUDO 游戏，当用户停止游戏时，我想保存游戏状态（活动状态）。

我知道我需要在方法 OnPause() 中保存状态，但是我需要保存很多变量，并且所有变量都会及时变化，所以我不确定我是否可以以这种方式保存状态。

那么我可以保存整个 Activity 和 OnResume() 方法来恢复它并继续游戏吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:13:41.263

我认为您正在寻找[**如何保存 Android 应用程序的状态**](https://stackoverflow.com/q/151777/844882)。

该文档还提供了有关[**使用**](http://developer.android.com/reference/android/app/Activity.html#SavingPersistentState)`onPause`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:14:19.490

不知道你说的时间变化是什么意思。你是说你的游戏在玩家不玩的时候也在进行吗？通常，您只会保存重建当前状态所需的最少信息量。对于棋盘游戏，这可能是每个玩家棋子的位置，以及轮到谁。

如果你真的有太多的游戏状态以至于保存和恢复会很笨拙，或者游戏必须在 Activity 关闭时进行，或者从静态数据重新创建状态太困难（我可能会质疑所有命题，但我们为了讨论，可以把它当作给定的），那么我建议你把它写成一个客户端-服务器应用程序，一个 Android 服务运行游戏引擎，你的 Activity 完成所有的视觉效果和用户交互。

# sharepoint - 无法在 sharepoint 2010 应用程序页面中导入 C# 库

> ID：10761868
> 
> 赞同：0
> 
> 时间：2012-05-25T22:03:11.777
> 
> 标签：sharepoint, deployment, sharepoint-2010, gac

我想在应用程序 aspx 页面中引用一个类库方法，但我不断收到可怕的黄屏死机错误消息

> CS0103：当前上下文中不存在名称“Common”。

[我按照此处](https://stackoverflow.com/questions/5092544/deploying-custom-dlls-in-sharepoint-2010)提到的步骤将项目添加到 GAC，并且还通过 IIS 管理器重新启动了 IIS。

这是我的申请页面：

```
<%@ Assembly Name="$SharePoint.Project.AssemblyFullName$" %>
<%@ Import Namespace="Microsoft.SharePoint.ApplicationPages" %>
<%@ Register Tagprefix="SharePoint" Namespace="Microsoft.SharePoint.WebControls" Assembly="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="Utilities" Namespace="Microsoft.SharePoint.Utilities" Assembly="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="asp" Namespace="System.Web.UI" Assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" %>
<%@ Import Namespace="Microsoft.SharePoint" %>
<%@ Assembly Name="Microsoft.Web.CommandUI, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="ApplicationPage1.aspx.cs" Inherits="SharePointProject1.Layouts.SharePointProject1.ApplicationPage1" DynamicMasterPageFile="~masterurl/default.master" %>

<asp:Content ID="PageHead" ContentPlaceHolderID="PlaceHolderAdditionalPageHead" runat="server">

</asp:Content>

<asp:Content ID="Main" ContentPlaceHolderID="PlaceHolderMain" runat="server">
<asp:Label ID="lblTest" runat="server" />
<%= Common.Lib.Utility.GetStatusImage("approved") %>
</asp:Content>

<asp:Content ID="PageTitle" ContentPlaceHolderID="PlaceHolderPageTitle" runat="server">
Application Page
</asp:Content>

<asp:Content ID="PageTitleInTitleArea" ContentPlaceHolderID="PlaceHolderPageTitleInTitleArea" runat="server" >
My Application Page
</asp:Content> 
```

# netbeans - 使用卡片布局时具有最大尺寸

> ID：10761870
> 
> 赞同：1
> 
> 时间：2012-05-25T22:03:29.850
> 
> 标签：netbeans, jframe, jpanel, cardlayout

当我使用 cardLayout 将几个 JPanel 添加到父 JPanel 或 JFrame 时，大小将设置为所有 JPanel 之间的最大 JFrame，我希望 JFrame 具有每个 JPanel 的完美大小，每次我在卡片之间翻转时，我想要每个 JPanel 的原始大小，而不是最大的大小

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T02:10:53.530

是的，CardLayout 使用最宽的宽度和最高的高度。它确实旨在解决典型的“向导”界面。

没有一个标准布局可以满足您的要求。

这是我如何解决类似问题的[链接。](http://experimentaljar.com/2012/05/25/misbehaving-cardlayout/)就我而言，它是将带有 CardLayout 的 JPanel 添加到 JScrollPane 中。它的行为方式与增加的痛苦大致相同，即可以将较小的面板完全滚动到视野之外，留下空白屏幕和困惑的用户。

我没有直接在 JFrame 中尝试过这段代码，所以我不知道这是否能满足您的需求，但它是免费的，欢迎您使用。

# javascript - 奇怪的javascript错误

> ID：10761876
> 
> 赞同：0
> 
> 时间：2012-05-25T22:04:30.427
> 
> 标签：javascript, jquery, plugins, conflict, uncaught-exception

我有一个由 jquery 插件驱动的缩略图滚动器，一切正常。我尝试集成的插件单独工作完美，但是当我尝试添加我的实际标记时，我使用 Firebug 检查它，我收到这个奇怪的错误：`Uncaught TypeError: Cannot call method 'extend' of undefined`

我无法在 jsfiddle 或此处发布整个标记，因此我更愿意为您提供指向该错误的链接，也许您可​​以帮助我了解正在发生的事情。压力很大。

[这](http://whiteandgold.ro/jquery_thumbnail_scroller/jquery_thumbnail_scroller_horizontal_full.html)是我的尝试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:15:15.073

您在所谓的“无冲突”模式下运行 jQuery。这基本上归结为不使用该`$`函数作为入口点。如果您的模块没有考虑到这一点，您将看到类似这样的故障。

**要么：1）不要在无冲突模式下使用jQuery**

如果您不打算使用其他 javascript 库（真的，我向您保证，一个就足够了）那么您完全可以走这条路，

只需删除此代码

```
* jQuery.noConflict() for using the plugin along with other libraries. 
   You can remove it if you won't use other libraries (e.g. prototype, scriptaculous etc.) or 
   if you include jQuery before other libraries in yourdocument's head tag. 
   [more info: http://docs.jquery.com/Using_jQuery_with_Other_Libraries] */
jQuery.noConflict(); 
```

...并查看注释引用的文档以更深入地了解：[http ://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

阅读文档永远不会受到伤害！

**或者：2）fork并修复模块的源代码** *（如果它在github或其他开源存储库上）*

您需要重新编写模块以使用更安全的入口点`jQuery`，而不是假设它`$`是可用的（正如它目前所做的那样）。你也可以只修正你的副本，但如果你正在做这项工作，你不妨把它放在其他人也可以受益的地方——毕竟，你正在从其他人的工作中受益（jQuery，模块等）：D

# node.js - 将 process.stdout 设置为每个 node.js 核心集群工作者的文件

> ID：10761879
> 
> 赞同：1
> 
> 时间：2012-05-25T22:06:05.513
> 
> 标签：node.js, multiprocessing, stdout, cluster-computing

我正在尝试使用节点核心的集群功能。

我希望`stdout`and`stderr`流输出到一个文件，每个工作人员 id 一个。

类似于以下内容：

```
var fs          = require('fs'), 
    env         = process.env,
    workerId    = env.NODE_WORKER_ID || env.NODE_UNIQUE_ID;

process.stdout =  fs.createWriteStream(__dirname + '/app#' + workerId + '.log', {
    encoding: 'utf8'
}); 
```

不幸的是，它似乎没有像这样重写 process.stdout。

有没有办法实现这一点，还是应该以不同的方式完成？目前，当我运行集群时，我在一个控制台中获取所有进程的所有输出，这非常混乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T20:08:09.030

我最终做了以下事情：

```
 //create a new stdout file stream
    var stdoutFS = fs.createWriteStream(stdoutFile, {
        encoding: 'utf8',
        flags   : 'a+'
    });

    //create a new stderr file stream
    var stderrFS = fs.createWriteStream(stderrFile, {
        encoding: 'utf8',
        flags   : 'a+'
    });

    //pipe stdout to a worker file
    var unhookStdout = hookWriteStream(stdout, function(string, encoding, fd) {
        stdoutFS.write(string, encoding || 'utf8');
    });
    console.log('\n\nPrepared new stdout hook to worker file.');

    //pipe stderr to a worker file
    var unhookStderr = hookWriteStream(stderr, function(string, encoding, fd) {
        stderrFS.write(string, encoding || 'utf8');
    });
    console.log('Prepared new stderr hook to worker file.');

    //unhook when things go wrong
    stdoutFS.once('close', function() {
        unhookStdout();
        console.log('Unhooked stdout.');
    });
    stdoutFS.once('error', function(err) {
        unhookStdout();
        console.error('Error: Unhooked stdout due to error %j.', err);
    });
    stderrFS.once('close', function() {
        unhookStderr();
        console.log('Unhooked stderr.');
    });
    stderrFS.once('error', function(err) {
        unhookStderr();
        console.error('Error: Unhooked stderr due to error %j.', err);
    });

});

function hookWriteStream(stream, callback) {
    var oldWrite = stream.write;

    stream.write = (function(write) {
        return function(string, encoding, fd) {
            write.apply(stream, arguments);
            callback(string, encoding, fd);
        };
    })(stream.write);

    return function() {
        stream.write = oldWrite;
    };
} 
```

它可能不是很优雅，但到目前为止，这是我找到的最佳解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:13:50.127

看起来我的想法在某种程度上有效。只要大部分日志记录是使用 console.log 完成的，而不是直接写入标准输出，你就会很好。

就像我在下面的评论中所说，使用这样的脚本：

```
fs = require 'fs'
{exec} = require 'child_process'

execAndPipe = (execString) ->
    piper = exec execString

    piper.stdout.on 'data', (data) ->
        if data[0...'PROCESS'.length] == 'PROCESS'
            # extract the worker ID and output 
            # to a corresponding file
    piper.stderr.on 'data', (data) ->
        if data[0...'PROCESS'.length] == 'PROCESS'
            # extract the worker ID and output 
            # to a corresponding file

task 'run', 'Run the server', ->
    execAndPipe 'node blah.js' 
```

运行您的服务器。然后只需重新定义console.log，如：

```
console.log = function (d) {
    process.stdout.write('PROCESS' + WORKERID + d + '\n');
}; 
```

我有点怀疑你能否直接重新绑定标准输出，所以这可能是你最好的选择之一。

如果您根本不想将任何内容输出到控制台，则可以重新绑定 console.log，例如：

```
console.log = function (d) {
    var str = fs.createWriteStream(__dirname + '/app#' + workerId + '.log', {
        encoding: 'utf8'
    });
    process.stdout.pipe(str);
}; 
```

忘记外部脚本。

# android - 为按钮定义 xml 文件以根据状态更改背景和 textColor

> ID：10761880
> 
> 赞同：4
> 
> 时间：2012-05-25T22:06:18.687
> 
> 标签：android, xml

我将它用于我自己的按钮来设置按下和未按下状态的背景：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<item android:drawable="@drawable/btn1_pressed" android:state_pressed="true"/>
<item android:drawable="@drawable/btn1_unpressed"/> <!-- default --> 
```

但我也喜欢 textColor 在按下状态下变为白色。我试图只添加`textColor="#ffffff"`到项目中，但我想这不是正确的方法，因为它不起作用。

最好的方法是什么，而不必在使用此按钮的每个 java 文件中对其进行编码？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T00:38:30.877

最好将 Textcolor 和 Background 资源分开设置。

```
android:background="@drawable/background"
android:textColor="@drawable/button_text_color" 
```

**所以你的背景：**你自己写的

**和文本颜色：**

```
<?xml version="1.0" encoding="UTF-8"?>
<selector
  xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" android:color="#ffffffff" />
    <item android:color="#ff000000" />
</selector> 
```

# global-variables - 如何提取objdump输出文件中全局变量的数据类型？

> ID：10761882
> 
> 赞同：1
> 
> 时间：2012-05-25T22:06:39.823
> 
> 标签：global-variables, gnu, disassembly, objdump

我有一个使用 objdump 反汇编工具反汇编的二进制文件。我想知道如何提取 objdump 输出文件中存在的全局变量的数据类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:46:08.430

编译的对象/可执行文件不包含有关变量类型或名称，或者它们的范围或存储类的任何信息。但是，如果文件中保留有调试符号，则其中一些信息可能可用。

# c - 结构编译时错误

> ID：10761884
> 
> 赞同：-2
> 
> 时间：2012-05-25T22:06:45.200
> 
> 标签：c, compiler-errors

我编写了一个程序来捕获`<ctrl> + <c>`信号然后输出一个列表，但是我有一个编译时错误，我似乎无法克服。我不断收到此错误：

> 无法在赋值中将 `void ()()' 转换为 `void (*)(int)'

根据编译器，错误发生在这行代码：

```
 handler.sa_handler = handle_SIGINT; 
```

这里也是周围的代码：

```
cmdcounter = 1;

/*set up the signal handler*/
struct sigaction handler;
handler.sa_handler = handle_SIGINT;
sigaction(SIGINT, &handler, NULL);

strcpy(buffer, "Caught <ctrl><c>\n"); 
```

`handle_SIGINT`在程序前面定义：

```
void handle_SIGINT()
{
    write(STDOUT_FILENO, buffer, strlen(buffer));

    // Print out last 10 commands that were used.
    printf("Most recent commands entered:\n");
    if(cmdcounter <= 10) {
        for (i=0; i < cmdcounter; i++) {
            printf("%d. %s\n", i+1, cmd[i]);
        }
    }
    else {
        for (i = cmdcounter-10; i < cmdcounter; i++) {
            printf("%d. %f\n", i, cmd[i]);
        }
    }
} 
```

在我看来一切都很好，但显然有些事情不是。有谁知道是什么引发了这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T22:09:44.260

你的功能`handle_SIGINT`是错误的。

~~向我们展示该功能，我们将能够准确地告诉您它是如何出错的。~~

`handle_SIGINT`*应该*是：

```
void handle_SIGINT(int){....} 
```

您省略了该`int`部分作为参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T22:10:24.697

该错误告诉您签名不匹配。`handle_SIGINT`应该：

```
void handle_SIGINT(int ){ ... } 
```

# java - 如何使 EditText 具有一定的最大宽度，但不会离开屏幕？

> ID：10761886
> 
> 赞同：2
> 
> 时间：2012-05-25T22:07:10.977
> 
> 标签：java, android, xml, layout, android-edittext

我正在尝试设置具有设定宽度的 EditText，但如果屏幕小于此宽度，则不会延伸到屏幕之外。我尝试了许多 layout_width 和 maxWidth 等变体，但无济于事。有任何想法吗？

# iphone - 检测异步连接何时完成

> ID：10761888
> 
> 赞同：0
> 
> 时间：2012-05-25T22:07:41.197
> 
> 标签：iphone, objective-c, xcode, asynchronous, nsurlconnection

我有一个带有方法（getAndPlaySong）的类，它从服务器获取文本文件，从文本中获取特定字符串，并使用字符串（URL）从服务器获取音乐文件。获取文本文件的第一个服务器调用很快，所以我同步实现了它。第二个需要更长的时间，我想在它发生时更新显示。

我希望该方法在继续之前等待异步请求完成。我尝试在 connectionDidFinishLoading 方法中放置一个 BOOL：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"Succeeded! Received %d bytes of data",[_receivedData length]);
    [AppDelegate playAudioWithData: _receivedData];
    _dataIsReceived = YES; //BOOL

    // release the connection, and the data object
    [connection release];
    [_receivedData release];
} 
```

然后在 getAndPlaySong 方法中放置一个 while 循环：

```
[self startRequest: correctSongURL]; starts the request asynchronously

while (!_dataIsReceived) {
    //do stuff
} 
```

结果是应用程序在到达循环时挂起。循环永远不会终止，我永远不会得到“Succeeded ...”输出。我有点困惑，将不胜感激一些意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T04:56:45.267

我不想听起来粗鲁，但你所做的是最糟糕的事情。当然，该应用程序挂起，因为它有一个无限循环。即使循环最终终止，当它在循环中时你的应用程序被卡住了——如果用户试图在循环中间对你的应用程序做某事怎么办？您需要改变思维方式并学习如何将事件驱动编程与状态机一起使用。这就是 iOS 的范式，你必须埋头苦干，做一些阅读和学习，改变你思考和构建程序的方式。

在您提出请求后，您什么也不做，即您的代码片段中没有接下来的代码。相反，您的应用程序坐在那里什么都不做（但仍然响应）等待连接完成（当您的应用程序什么都不做时，操作系统已经代表您创建了一个线程并且连接代码正在其中执行，当它完成您的连接代码时需要通知其余代码已完成，例如，您可以通过委托或通过通知来执行此操作）。

这并不是它唯一需要坐下来等待的事情——如果用户点击屏幕会怎样？如果用户退出您的应用程序怎么办？如果……您的应用程序需要能够响应所有可能的事件并快速响应，连接只是它必须侦听和响应的又一个事件。如果它在一个循环中，它就不能这样做。

永远不要在这样的地方使用循环。

“我希望该方法在继续之前等待异步请求完成。” 不，你不会——你永远不能在带有 GUI 的应用程序中做这样的事情。该函数必须完成执行。您需要实现一个状态机，每个 iOS 都是一个状态机，应用程序委托是驱动状态机的主要内容，然后随着更多事件添加到程序中，您添加更多状态和状态之间的转换。

查看应用程序委托及其告诉您的代码应用程序进入前台或后台或内存不足情况等的方法。这是事件驱动编程，您需要扩展和构建该原则以考虑您的连接事件和任何其他事件。

对不起，如果我听起来有点苛刻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:57:31.523

您的应用程序挂在循环上，因为它是无限的。

在 iOS 上，NSURLConnectionDelegate 是在连接上接收到数据时获取回调并在完成时收到通知的方式。一切都应该通过委托异步完成。这就是在 iOS 上完成的方式。

流入的结果应存储在 didRecieveData 方法中的 NSData 对象中。

查看 NSURLConnectionDelegate 上的文档，但这里有一个大纲示例：

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
     int statusCode = [(NSHTTPURLResponse *)response statusCode];    
     if(statusCode == 404) {
         // Post notification and let concerned parties know something went wrong.
         [self cleanupConnection];
     }
     else if( statusCode == 200) {
         // Success do something with the data.
         requestData = [[NSMutableData alloc] init];
     }
     else {
         [self cleanupConnection];
     }
}
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [requestData appendData:data];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    [self finishedLoadingAppData];
}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"Connection Attempt Failed with Error:%@", [error localizedDescription]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T22:12:01.267

想到两个快速选项： 创建一个方法来调用以处理完成的连接 使用 NSNotification API 在加载完成时发送通知

此外，您可以使用 NSURLConnection didReceiveData 的方法来处理来自服务器的增量数据。

# php - 动态相关表：从 MySQL 中提取数据

> ID：10761891
> 
> 赞同：0
> 
> 时间：2012-05-25T22:07:50.197
> 
> 标签：php, javascript, jquery, mysql

我在访问父表、子表和子表的子表时需要指导。我需要帮助通过 php/jquery 函数显示表格。目标是通过动态依赖表显示信息。

我想在下拉菜单中显示信息。有6个主要类别。当用户单击主类别中的项目时，它会显示子表。我正在尝试通过 jquery 显示它们。这是一个示例网站：[示例网站][1]

要进行测试，只需将其保存为 example.dbs 并将其导入 MySQL，它就会显示出来。这是我的数据：

```
CREATE TABLE `category` (
   `c_id` tinyint(4) not null auto_increment,
   `category` varchar(30) not null,
   PRIMARY KEY (`c_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=5;

INSERT INTO `category` (`c_id`, `category`) VALUES ('1', 'Books >');
INSERT INTO `category` (`c_id`, `category`) VALUES ('2', 'Electronics >');
INSERT INTO `category` (`c_id`, `category`) VALUES ('3', 'Furniture >');
INSERT INTO `category` (`c_id`, `category`) VALUES ('4', 'Clothing >');
INSERT INTO `category` (`c_id`, `category`) VALUES ('5', 'Jobs/Services >');
INSERT INTO `category` (`c_id`, `category`) VALUES ('6', 'Housing >'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:23:05.253

您的问题不清楚，但我假设您正在寻找查询具有关系的表。所以mysql JOIN。

例子：

```
SELECT s3.subcategory3,s2.subcategory2,s1.subcategory,c.category FROM subcategory3 as s3 
LEFT JOIN subcategory2 as s2 ON s3.j_id=s2.j_id 
LEFT JOIN subcategory as s1 ON s2.s_id=s1.s_id 
LEFT JOIN category as c ON c. c_id=s1.c_id 
```

以上将仅返回子类别 3 中具有父项的行，因此只有 4 行（只有 4 个条目）。如果你想要全套，试试这个：

```
SELECT s3.subcategory3,s2.subcategory2,s1.subcategory,c.category FROM subcategory3 as s3 
RIGHT JOIN subcategory2 as s2 ON s3.j_id=s2.j_id 
RIGHT JOIN subcategory as s1 ON s2.s_id=s1.s_id 
RIGHT JOIN category as c ON c. c_id=s1.c_id
ORDER BY subcategory3,subcategory2,subcategory,category ASC 
```

# perl - 如何在 Strawberry Perl 上安装 perl 的 Text::Markdown::Discount？

> ID：10761892
> 
> 赞同：1
> 
> 时间：2012-05-25T22:07:58.007
> 
> 标签：perl, strawberry-perl

当我尝试`cpanp install Text::Markdown::Discount`使用 Strawberry Perl 时，我得到

```
cp lib/Text/Markdown/Discount.pm blib\lib\Text\Markdown\Discount.pm
    ( cd discount-2.1.2; CC='cc -fPIC' sh configure.sh; make )
The system cannot find the path specified. 
```

[我看到很多其他人也有同样的问题。](http://matrix.cpantesters.org/?dist=Text-Markdown-Discount-0.02;reports=1;os=mswin32)可以`T:M:D`安装在Strawberry Perl 上吗？

您也不能使用 ppm 安装 T:M:D：

```
PPM> install Text::Markdown::Discount
Install package 'Text-Markdown-Discount?' (y/N): y
Installing package 'Text-Markdown-Discount'...
Error installing package 'Text-Markdown-Discount': Could not locate a PPD file f
or package Text-Markdown-Discount 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2018-05-13T20:25:57.413

我通过以下步骤安装了 Text::Markdown::Discount：

```
git clone https://github.com/sekimura/text-markdown-discount.git

cd text-markdown-discount/

perl Makefile.PL

make

make test

sudo make install 
```

# javascript - Chrome 是否有内置的调用堆栈？

> ID：10761894
> 
> 赞同：42
> 
> 时间：2012-05-25T22:08:47.493
> 
> 标签：javascript, google-chrome, browser, google-chrome-devtools, callstack

在 Visual Studio 中，我习惯于在任何断点处显示调用堆栈。Chrome 是否具有调用堆栈功能，我可以在其中查看断点之前的哪些函数？

如果没有，是否有替代品（适用于 Chrome 的第 3 方解决方案？）开发人员使用它来查看导致断点的功能？

编辑：需要明确的是，我希望调用堆栈出现在 Chrome 的 javascript 控制台中。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-05-25T23:04:34.080

我不知道您使用的是哪个版本的 Chrome。我正在使用 Chromium 17，并且 Javascript 调试器在遇到断点时看起来像这样（强调我的）： ![Chromium 调用栈](../Images/2e9e5e1d2f9a7c76e2fe34d2decd189d.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-25T23:03:03.237

Open the Developer Tools ("SPANNER" -> Tools -> Developer Tools), select the Scripts tab, on the right there is a section called "Call Stack"

Enjoy :-D

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-04-30T07:18:17.643

[版本 66.0.3359.139 ]转到开发人员工具 -> 源 -> 看右侧（调用堆栈）。

`console.trace()` // 打印调用堆栈。

[https://developers.google.com/web/updates/2015/07/print-out-a-quick-stack-trace-from-the-console](https://developers.google.com/web/updates/2015/07/print-out-a-quick-stack-trace-from-the-console)

[![在此处输入图像描述](../Images/095c504a8db9cd0fe293ce321eb5ee75.png)](https://i.stack.imgur.com/TAC6M.png)

# spring - Spring 有类似 Play #{extends} 的东西吗？

> ID：10761901
> 
> 赞同：0
> 
> 时间：2012-05-25T22:09:26.790
> 
> 标签：spring, spring-mvc, playframework

#{extends} 在 Play 框架中非常有用且易于使用，可以扩展布局和管理视图中的布局，但我想知道 Spring 是否也有类似的东西？

如果有人对 Spring 有相同的代码，我将不胜感激。

在下面的 Play 示例中，我通过 index.html 扩展 main.html，这意味着 index.html 将使用 main.html 作为其布局：

```
/* views/main.html : */
<!DOCTYPE html>
<html>
    <head>
        ...
    </head>
    <body>
        ...
        <div id="content">
        #{doLayout/}
        </div>
        ...
    </body>
</html>

/* views/Application/index.html : */
#{extends "main.html"/}
<h1>Home</h1>
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T23:45:42.873

如果您使用的是 Velocity，请阅读[http://sebastienayotte.wordpress.com/2009/03/20/using-velocity-layout-in-spring/](http://sebastienayotte.wordpress.com/2009/03/20/using-velocity-layout-in-spring/)

如果您使用 freemarker，请参阅[http://richardbarabe.wordpress.com/2009/03/19/freemarker-a-brief-example/](http://richardbarabe.wordpress.com/2009/03/19/freemarker-a-brief-example/)

如果你想要完全像 play 的 groovy 模板的行为，你可以试试[Rythm 模板引擎](https://github.com/greenlaw110/rythm)，阅读[这个](http://software-lgl.blogspot.com.au/2012/03/rythm-easy-to-use-high-performance-java.html)和[这个](http://software-lgl.blogspot.com.au/2012/05/step-by-step-migrate-your-groovy_24.html)。

# ios - iOS GLKit 并返回默认帧缓冲区

> ID：10761902
> 
> 赞同：3
> 
> 时间：2012-05-25T22:09:38.087
> 
> 标签：ios, xcode, opengl-es, framebuffer

我正在运行 XCode 为 iOS 的 OpenGL 项目创建的样板 OpenGL 示例代码。这设置了一个简单的 ViewController 并使用 GLKit 来处理其余的工作。

应用程序的所有更新/绘制功能都在 C++ 中。它是跨平台的。

有很多帧缓冲区的创建正在进行。绘制阶段渲染到几个帧缓冲区，然后尝试将其设置回默认帧缓冲区。

```
glBindFramebuffer(GL_FRAMEBUFFER, 0); 
```

这会生成一个 GL_INVALID_ENUM。仅在 iOS 上。

我完全不知道为什么。该代码在除 iOS 之外的所有主要平台上运行良好。我想责怪 GLKit。任何不使用 GLKit 的 iOS OpenGL 设置示例？

更新

下面的代码片段让我看到了 GLKit 正在使用的默认帧缓冲区。由于某种原因，它显示为“2”。如果我在我所有的 glBindFrameBuffer 调用中使用“2”就可以了。这非常令人沮丧。

```
[view bindDrawable ];

GLint defaultFBO;
glGetIntegerv(GL_FRAMEBUFFER_BINDING_OES, &defaultFBO);
LOGI("DEFAULT FBO: %d", defaultFBO); 
```

到底什么原因会导致 GLKit 不会在 0 处生成其内部帧缓冲区？这是所有其他 OpenGL 实现使用的语义，0 是默认的 FBO。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T02:08:32.807

在 iOS 上，没有默认的帧缓冲区。请参阅[Framebuffer Objects are the Only Rendering Target on iOS](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESontheiPhone/OpenGLESontheiPhone.html#//apple_ref/doc/uid/TP40008793-CH101-SW8)。我对 GLKit 不太了解，但是在 iOS 上要在屏幕上渲染某些内容，您需要创建帧缓冲区，并将其附加到渲染缓冲区，并通知核心动画层该渲染缓冲区将是“屏幕”或“默认帧缓冲区”来绘制到。含义 - 您将绘制到此帧缓冲区的所有内容都将出现在屏幕上。请参阅[渲染到核心动画层](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/WorkingwithEAGLContexts/WorkingwithEAGLContexts.html#//apple_ref/doc/uid/TP40008793-CH103-SW5)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-20T05:02:39.693

我觉得有必要在这里指出调用 glBindFramebuffer(GL_FRAMEBUFFER, 0); 不会将渲染返回到主帧缓冲区，尽管它似乎适用于运行 Windows、Unix(Mac) 或 Linux 的机器。台式机和笔记本电脑没有主默认系统缓冲区的概念。这个想法始于手持设备。当您使用零作为参数进行 openGL 绑定调用时，您所做的是将此函数设置为 NULL。这就是您禁用此功能的方式。与 glBindTexture(GL_TEXTURE_2D, 0); 相同。在某些手持设备上，当您将帧缓冲区设置为 NULL 而不激活另一个时，驱动程序可能会自动激活主系统帧缓冲区。这将是制造商做出的选择，而不是您应该指望的东西，这不是 openGL ES 规范的一部分。对于台式机和笔记本电脑，这是绝对必要的，因为需要禁用帧缓冲区才能恢复正常的 openGL 渲染。

在 iOS 设备上，您应该进行以下调用，glBindFramebuffer(GL_FRAMEBUFFER, viewFramebuffer);，前提是您将系统帧缓冲区命名为“viewFramebuffer”。通过初始化代码查找以下调用 glGenFramebuffers(1, &viewFramebuffer); 不管你最后写了什么，当你返回到你的主系统缓冲区时，你绑定的就是什么。

如果您使用的是 GLKit，那么您可以使用以下调用，[((GLKView *) self.view) bindDrawable]; 根据您的特定启动代码，“self.view”可能会略有不同。
此外，对于 iOS，您可以使用 glBindFramebuffer(GL_FRAMEBUFFER, 2); 但这可能不会在 Apple 发布的未来设备中保持一致。他们将来可能会将“2”的默认值更改为“3”或其他内容，因此您希望使用实际名称而不是整数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-07T06:03:53.073

*   (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {

//您使用辅助/屏幕外帧缓冲区来存储渲染结果

```
 [self.shader drawOffscreenOnFBO]; 
```

//回到GLKView的默认帧缓冲区

```
 [((GLKView *) self.view) bindDrawable]; 
```

//在主屏幕上绘制 [self.shader drawinmainscreen];

}

参考 ..... [http://districtf13.blogspot.com/](http://districtf13.blogspot.com/)

# .net - U2 Toolkit for .NET - 实体框架示例“EntityFramework_CodeFirst2”未连接

> ID：10761906
> 
> 赞同：1
> 
> 时间：2012-05-25T22:10:14.747
> 
> 标签：.net, entity-framework-4.1, u2, universe, u2netdk

尝试修改 EntityFramework_CodeFirst 和 EntityFramework_CodeFirst2 项目时出现此错误：

> 打开连接 [U2][UCINET-UO] [U2][UCINET-UO]WIN32 API 错误：10053 已建立的连接被主机中的软件中止[Rocket U2][UCINET - UNIRPC][ErrorCode=81009]套接字发送和数据长度中的 RPC 失败错误：36
> 
> 内部异常：无法将数据写入传输连接：已建立的连接被主机中的软件中止。内部异常：WIN32 API 错误：10053 已建立的连接被主机中的软件中止[Rocket U2][UCINET - UNIRPC][ErrorCode=81009] 套接字发送中的 RPC 失败错误和数据长度：36

我已将连接字符串设置为：

```
<add name="CustomerContext" connectionString="Database=dbPath;UserID=userId;Password=password;Server=serverIp;Pooling=false;ServerType=universe;ConnectTimeout=500;PersistSecurityInfo=true" providerName="U2.Data.Client" /> 
```

使用相同的凭据，我可以在 ADO.NET 和 UniObjects 连接上使用 U2 DB Provider for .NET 测试连接程序成功连接。我只是无法让它为 EntityFramework_CodeFirst 项目工作。

UNIRPC 正在主机上运行。端口 31438 正在侦听。防火墙已关闭。

**编辑：** 我已经设置了环境变量 UCINETTRACE 和 UCINETTRACESWITCH 并且有 DataAdapter 示例的跟踪日志。这是有趣部分的片段。[完整的跟踪在这里](http://pastebin.com/1kAXg3s4)

> 2012 年 5 月 30 日上午 10:56:53：线程 ID：线程 ID：11 线程名称：光标 #1--UciStatement::OpenServerCursor() 和 SQL String::call *HS.OLEDBINFO('ACCTS', '', ' ', '', '', '1', '', 0, 1) 2012 年 5 月 30 日上午 10:56:53：线程 ID：退出：线程 ID：11 线程名称：UciStatement::OpenServerCursor() 5/30 /2012 上午 10:56:53：线程 ID：输入：线程 ID：11 线程名称：UciStatement::AssociateServerCursor() 2012 年 5 月 30 日上午 10:56:53：线程 ID：退出：线程 ID：11 线程名称：UciStatement:: AssociateServerCursor() 2012 年 5 月 30 日上午 10:56:53：线程 ID：输入：线程 ID：11 线程名称：UciStatement::()ServerExecute 2012 年 5 月 30 日上午 10:56:53：线程 ID：输入：线程 ID：11线程名称：UciStatement::ServerExecuteSql() 2012 年 5 月 30 日上午 10:56:53：线程 ID：线程 ID：11 线程名称：[U2][UCINET][UNIVERSE]：错误：CAN'T 从@TMP 中直接选择

**编辑 2：** 我有 HS.SALES 示例工作，我在 UniVerse 11.4（当前）上。我与 Rocket Support 进行了交谈，但我不知道我需要使用 HS.ADMIN 授权个人 UV 帐户，这可能是问题所在。我认为与数据库的牢固连接会切断它，特别是因为 HS.SALES 正在工作。我仍然需要“SQLize”我的 DICT 文件以允许它们在 ADO.NET (& EF) 上工作，但我现在几乎拥有它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:47:21.450

您是否尝试过使用相同连接字符串的 DataAdapter Sample？这管用吗？你能提供TRACE LOG吗？您需要设置以下内容：

跟踪和调试 要为 .NET 应用程序调试 U2 数据库提供程序，您可以使用 U2 跟踪工具。要激活跟踪工具，请设置以下环境变量：

设置 UCINETTRACE=c:\temp

设置 UCINETTRACESWITCH=4

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T18:45:37.333

可以试试 U2NETDK v1.2.0 吗？我希望它能解决上面提到的问题。

U2NETDK v1.2.0 BETA 包含用于 Visual Studio 2010 的 U2 数据库插件。现在您可以使用 VS2010 服务器资源管理器来填充 U2 表、视图和子例程。

它将允许您创建数据集和实体数据模型。

# java - JBoss 7.1：找不到合适的驱动程序 java:mysql - 无法打开连接

> ID：10761910
> 
> 赞同：6
> 
> 时间：2012-05-25T22:10:43.063
> 
> 标签：java, mysql, hibernate, jboss7.x

我一直在寻找答案，但没有找到解决方案。我正在使用 JSF2 和 Hibernate 开发简单的网络应用程序。这是我第一次使用 Hibernate，我在配置方面遇到了很多问题。我当前的问题是：我将 mysql 连接器配置为 JBoss7.1 模块中的模块。然后我创建了数据源并将 mysql-connector-java-5.1.20-bin.jar 添加到类路径中（它位于 .war 的 WEB-INF/lib 目录中）。启动 JBoss 后，我收到以下日志：

```
23:44:07,497 INFO  [org.jboss.as.connector.subsystems.datasources] (ServerService Thread Pool -- 27) JBAS010403: Deploying JDBC-compliant driver class org.h2.Driver (version 1.3)
23:44:07,603 INFO  [org.jboss.as.connector.subsystems.datasources] (ServerService Thread Pool -- 27) JBAS010404: Deploying non-JDBC-compliant driver class com.mysql.jdbc.Driver (version 5.1)
...
23:44:20,348 INFO  [org.jboss.as.connector.deployers.jdbc] (MSC service thread 1-3) JBAS010404: Deploying non-JDBC-compliant driver class com.mysql.jdbc.Driver (version 5.1)
23:44:21,532 INFO  
...
[org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl] (MSC service thread 1-3) HHH000401: using driver [com.mysql.jdbc.Driver] at URL [jdbc:mysql://localhost/testdb]
23:44:21,535 INFO  [org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl] (MSC service thread 1-3) HHH000046: Connection properties: {user=root}
23:44:21,556 WARN  [org.hibernate.engine.jdbc.internal.JdbcServicesImpl] (MSC service thread 1-3) HHH000342: Could not obtain connection to query metadata : No suitable driver found for jdbc:mysql://localhost/testdb 
```

然后部署应用程序并成功启动服务器。当我尝试调用方法试图持久化我获得的一些数据时

```
org.hibernate.exception.JDBCConnectionException: Could not open connection
and
java.sql.SQLException: No suitable driver found for jdbc:mysql://localhost/testdb 
```

我确定mysql-connector-java-5.1.20-bin.jar 位于war 文件的WEB-INF/lib 目录中。任何想法我在这里想念什么？MySQL 服务器版本是 5.1.63，但我认为这里不相关。非常感谢！

编辑：端口没问题，我检查了两次；-) 但是，现在我真的很困惑，因为代码在容器外运行良好。我创建了使用相同代码的类（HIbernateUtil 获取会话工厂）并且没有异常，并且数据被插入到数据库中。您能否解释一下为什么它以这种方式工作，以及为什么它不能在容器下工作？以及如何解决这个问题，因为我不知道......非常感谢！

我的standalone.xml 文件：

```
<server xmlns="urn:jboss:domain:1.2">

    <extensions>
        <extension module="org.jboss.as.clustering.infinispan"/>
        <extension module="org.jboss.as.configadmin"/>
        <extension module="org.jboss.as.connector"/>
        <extension module="org.jboss.as.deployment-scanner"/>
        <extension module="org.jboss.as.ee"/>
        <extension module="org.jboss.as.ejb3"/>
        <extension module="org.jboss.as.jaxrs"/>
        <extension module="org.jboss.as.jdr"/>
        <extension module="org.jboss.as.jmx"/>
        <extension module="org.jboss.as.jpa"/>
        <extension module="org.jboss.as.logging"/>
        <extension module="org.jboss.as.mail"/>
        <extension module="org.jboss.as.naming"/>
        <extension module="org.jboss.as.osgi"/>
        <extension module="org.jboss.as.pojo"/>
        <extension module="org.jboss.as.remoting"/>
        <extension module="org.jboss.as.sar"/>
        <extension module="org.jboss.as.security"/>
        <extension module="org.jboss.as.threads"/>
        <extension module="org.jboss.as.transactions"/>
        <extension module="org.jboss.as.web"/>
        <extension module="org.jboss.as.webservices"/>
        <extension module="org.jboss.as.weld"/>
    </extensions>

    <management>
        <security-realms>
            <security-realm name="ManagementRealm">
                <authentication>
                    <properties path="mgmt-users.properties" relative-to="jboss.server.config.dir"/>
                </authentication>
            </security-realm>
            <security-realm name="ApplicationRealm">
                <authentication>
                    <properties path="application-users.properties" relative-to="jboss.server.config.dir"/>
                </authentication>
            </security-realm>
        </security-realms>
        <management-interfaces>
            <native-interface security-realm="ManagementRealm">
                <socket-binding native="management-native"/>
            </native-interface>
            <http-interface security-realm="ManagementRealm">
                <socket-binding http="management-http"/>
            </http-interface>
        </management-interfaces>
    </management>

    <profile>
        <subsystem xmlns="urn:jboss:domain:logging:1.1">
            <console-handler name="CONSOLE">
                <level name="INFO"/>
                <formatter>
                    <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
                </formatter>
            </console-handler>
            <periodic-rotating-file-handler name="FILE">
                <formatter>
                    <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
                </formatter>
                <file relative-to="jboss.server.log.dir" path="server.log"/>
                <suffix value=".yyyy-MM-dd"/>
                <append value="true"/>
            </periodic-rotating-file-handler>
            <logger category="com.arjuna">
                <level name="WARN"/>
            </logger>
            <logger category="org.apache.tomcat.util.modeler">
                <level name="WARN"/>
            </logger>
            <logger category="sun.rmi">
                <level name="WARN"/>
            </logger>
            <logger category="jacorb">
                <level name="WARN"/>
            </logger>
            <logger category="jacorb.config">
                <level name="ERROR"/>
            </logger>
            <root-logger>
                <level name="INFO"/>
                <handlers>
                    <handler name="CONSOLE"/>
                    <handler name="FILE"/>
                </handlers>
            </root-logger>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:configadmin:1.0"/>
        <subsystem xmlns="urn:jboss:domain:datasources:1.0">
            <datasources>
                <datasource jndi-name="java:jboss/datasources/testDS" pool-name="testDS">
                    <connection-url>jdbc:mysql://localhost:3306/testdb</connection-url>
                    <driver>mysql</driver>
                    <pool>
                        <min-pool-size>10</min-pool-size>
                        <max-pool-size>20</max-pool-size>
                        <prefill>true</prefill>
                    </pool>
                    <security>
                        <user-name>root</user-name>
                    </security>
                </datasource>
                <datasource jndi-name="java:jboss/datasources/ExampleDS" pool-name="ExampleDS" enabled="true" use-java-context="true">
                    <connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1</connection-url>
                    <driver>h2</driver>
                    <security>
                        <user-name>sa</user-name>
                        <password>sa</password>
                    </security>
                </datasource>
                <drivers>
                    <driver name="h2" module="com.h2database.h2">
                        <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>
                    </driver>
                    <driver name="mysql" module="com.mysql"/>
                </drivers>
            </datasources>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:deployment-scanner:1.1">
            <deployment-scanner path="deployments" relative-to="jboss.server.base.dir" scan-interval="5000"/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:ee:1.0"/>
        <subsystem xmlns="urn:jboss:domain:ejb3:1.2">
            <session-bean>
                <stateless>
                    <bean-instance-pool-ref pool-name="slsb-strict-max-pool"/>
                </stateless>
                <stateful default-access-timeout="5000" cache-ref="simple"/>
                <singleton default-access-timeout="5000"/>
            </session-bean>
            <pools>
                <bean-instance-pools>
                    <strict-max-pool name="slsb-strict-max-pool" max-pool-size="20" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/>
                    <strict-max-pool name="mdb-strict-max-pool" max-pool-size="20" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/>
                </bean-instance-pools>
            </pools>
            <caches>
                <cache name="simple" aliases="NoPassivationCache"/>
                <cache name="passivating" passivation-store-ref="file" aliases="SimpleStatefulCache"/>
            </caches>
            <passivation-stores>
                <file-passivation-store name="file"/>
            </passivation-stores>
            <async thread-pool-name="default"/>
            <timer-service thread-pool-name="default">
                <data-store path="timer-service-data" relative-to="jboss.server.data.dir"/>
            </timer-service>
            <remote connector-ref="remoting-connector" thread-pool-name="default"/>
            <thread-pools>
                <thread-pool name="default">
                    <max-threads count="10"/>
                    <keepalive-time time="100" unit="milliseconds"/>
                </thread-pool>
            </thread-pools>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:infinispan:1.2" default-cache-container="hibernate">
            <cache-container name="hibernate" default-cache="local-query">
                <local-cache name="entity">
                    <transaction mode="NON_XA"/>
                    <eviction strategy="LRU" max-entries="10000"/>
                    <expiration max-idle="100000"/>
                </local-cache>
                <local-cache name="local-query">
                    <transaction mode="NONE"/>
                    <eviction strategy="LRU" max-entries="10000"/>
                    <expiration max-idle="100000"/>
                </local-cache>
                <local-cache name="timestamps">
                    <transaction mode="NONE"/>
                    <eviction strategy="NONE"/>
                </local-cache>
            </cache-container>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:jaxrs:1.0"/>
        <subsystem xmlns="urn:jboss:domain:jca:1.1">
            <archive-validation enabled="true" fail-on-error="true" fail-on-warn="false"/>
            <bean-validation enabled="true"/>
            <default-workmanager>
                <short-running-threads>
                    <core-threads count="50"/>
                    <queue-length count="50"/>
                    <max-threads count="50"/>
                    <keepalive-time time="10" unit="seconds"/>
                </short-running-threads>
                <long-running-threads>
                    <core-threads count="50"/>
                    <queue-length count="50"/>
                    <max-threads count="50"/>
                    <keepalive-time time="10" unit="seconds"/>
                </long-running-threads>
            </default-workmanager>
            <cached-connection-manager/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:jdr:1.0"/>
        <subsystem xmlns="urn:jboss:domain:jmx:1.1">
            <show-model value="true"/>
            <remoting-connector/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:jpa:1.0">
            <jpa default-datasource=""/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:mail:1.0">
            <mail-session jndi-name="java:jboss/mail/Default">
                <smtp-server outbound-socket-binding-ref="mail-smtp"/>
            </mail-session>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:naming:1.1"/>
        <subsystem xmlns="urn:jboss:domain:osgi:1.2" activation="lazy">
            <properties>
                <property name="org.osgi.framework.startlevel.beginning">
                    1
                </property>
            </properties>
            <capabilities>
                <capability name="javax.servlet.api:v25"/>
                <capability name="javax.transaction.api"/>
                <capability name="org.apache.felix.log" startlevel="1"/>
                <capability name="org.jboss.osgi.logging" startlevel="1"/>
                <capability name="org.apache.felix.configadmin" startlevel="1"/>
                <capability name="org.jboss.as.osgi.configadmin" startlevel="1"/>
            </capabilities>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:pojo:1.0"/>
        <subsystem xmlns="urn:jboss:domain:remoting:1.1">
            <connector name="remoting-connector" socket-binding="remoting" security-realm="ApplicationRealm"/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:resource-adapters:1.0"/>
        <subsystem xmlns="urn:jboss:domain:sar:1.0"/>
        <subsystem xmlns="urn:jboss:domain:security:1.1">
            <security-domains>
                <security-domain name="other" cache-type="default">
                    <authentication>
                        <login-module code="Remoting" flag="optional">
                            <module-option name="password-stacking" value="useFirstPass"/>
                        </login-module>
                        <login-module code="RealmUsersRoles" flag="required">
                            <module-option name="usersProperties" value="${jboss.server.config.dir}/application-users.properties"/>
                            <module-option name="rolesProperties" value="${jboss.server.config.dir}/application-roles.properties"/>
                            <module-option name="realm" value="ApplicationRealm"/>
                            <module-option name="password-stacking" value="useFirstPass"/>
                        </login-module>
                    </authentication>
                </security-domain>
                <security-domain name="jboss-web-policy" cache-type="default">
                    <authorization>
                        <policy-module code="Delegating" flag="required"/>
                    </authorization>
                </security-domain>
                <security-domain name="jboss-ejb-policy" cache-type="default">
                    <authorization>
                        <policy-module code="Delegating" flag="required"/>
                    </authorization>
                </security-domain>
            </security-domains>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:threads:1.1"/>
        <subsystem xmlns="urn:jboss:domain:transactions:1.1">
            <core-environment>
                <process-id>
                    <uuid/>
                </process-id>
            </core-environment>
            <recovery-environment socket-binding="txn-recovery-environment" status-socket-binding="txn-status-manager"/>
            <coordinator-environment default-timeout="300"/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:web:1.1" default-virtual-server="default-host" native="false">
            <connector name="http" protocol="HTTP/1.1" scheme="http" socket-binding="http"/>
            <virtual-server name="default-host" enable-welcome-root="true">
                <alias name="localhost"/>
                <alias name="example.com"/>
            </virtual-server>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:webservices:1.1">
            <modify-wsdl-address>true</modify-wsdl-address>
            <wsdl-host>${jboss.bind.address:127.0.0.1}</wsdl-host>
            <endpoint-config name="Standard-Endpoint-Config"/>
            <endpoint-config name="Recording-Endpoint-Config">
                <pre-handler-chain name="recording-handlers" protocol-bindings="##SOAP11_HTTP ##SOAP11_HTTP_MTOM ##SOAP12_HTTP ##SOAP12_HTTP_MTOM">
                    <handler name="RecordingHandler" class="org.jboss.ws.common.invocation.RecordingServerHandler"/>
                </pre-handler-chain>
            </endpoint-config>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:weld:1.0"/>
    </profile>

    <interfaces>
        <interface name="management">
            <inet-address value="${jboss.bind.address.management:127.0.0.1}"/>
        </interface>
        <interface name="public">
            <inet-address value="${jboss.bind.address:127.0.0.1}"/>
        </interface>
        <interface name="unsecure">
            <inet-address value="${jboss.bind.address.unsecure:127.0.0.1}"/>
        </interface>
    </interfaces>

    <socket-binding-group name="standard-sockets" default-interface="public" port-offset="${jboss.socket.binding.port-offset:0}">
        <socket-binding name="management-native" interface="management" port="${jboss.management.native.port:9999}"/>
        <socket-binding name="management-http" interface="management" port="${jboss.management.http.port:9990}"/>
        <socket-binding name="management-https" interface="management" port="${jboss.management.https.port:9443}"/>
        <socket-binding name="ajp" port="8009"/>
        <socket-binding name="http" port="8080"/>
        <socket-binding name="https" port="8443"/>
        <socket-binding name="osgi-http" interface="management" port="8090"/>
        <socket-binding name="remoting" port="4447"/>
        <socket-binding name="txn-recovery-environment" port="4712"/>
        <socket-binding name="txn-status-manager" port="4713"/>
        <outbound-socket-binding name="mail-smtp">
            <remote-destination host="localhost" port="25"/>
        </outbound-socket-binding>
    </socket-binding-group>

    <deployments>
        <deployment name="jboss-as-helloworld-jsf.war" runtime-name="jboss-as-helloworld-jsf.war">
            <content sha1="87e5656e4c0b15f7864df9e68328d290999a1144"/>
        </deployment>
    </deployments>
</server> 
```

我使用的是 Hibernate 4.1.3，我必须添加 Hibernate jar 作为外部 jar 来构建路径，即使在 modules/org/hibernate/main 更改之后（我更改了 module.xml 并替换了旧 jar）。更改之后，我在部署期间遇到了不同的异常： .org.hibernate.service.classloading.spi.ClassLoadingException: Specified JDBC Driver com.mysql.jdbc.Driver class not found 在 Jboss 的日志中提到 com.mysql.jdbc.Driver已部署。帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T23:36:28.963

如果有人遇到类似的问题，这里有一个解决方案：

*   检查人们在我的问题下提到的内容；
*   如果这不起作用，请检查休眠库是否来自同一个包（最新的是 4.1.3，JBoss 7.1.1 有 4.0.1）；
*   确保不要在类路径和 Manifest.mf 依赖项中复制连接器和休眠库（这是我的问题的原因）

感谢所有在这里回复的人，您非常有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-01T23:06:38.617

```
Step 1:

You create one folder in jboss-as-7.1.1.Final\modules\com

 create mysql folder>>

 create main folder>>

 create module.xml file>>

 put mysql connector jar file (mysql-connector-java-5.1.10-bin)

Step 2:

 add line on this location jboss-as-7.1.1.Final\modules\org\hibernate\main\module

  <module name="com.mysql"/> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-25T22:47:59.267

将 jdbc sql 放在库文件夹中：jboss/server/default/lib

[Jboss mysql - 找不到适合 jdbc 的驱动程序](https://stackoverflow.com/questions/8418625/jboss-mysql-no-suitable-driver-found-for-jdbc)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-26T00:54:12.997

通常你的 jboss 配置应该有一个 lib 文件夹，你可以在其中放置你的 jdbc 驱动程序：

> 8.2.2\. 安装 JDBC 驱动并部署数据源
> 
> 要使 JBoss 可以使用 JDBC 驱动程序类，请将文件 mysql-connector-java-3.0.15-ga-bin.jar 从 Connector/J 分发版复制到默认服务器配置中的 lib 目录（假设这是您的配置） ' 正在运行，当然）。然后使用以下数据源配置在部署目录中创建一个名为 mysql-ds.xml 的文件。数据库用户名和密码对应的是我们在上一节中创建的MySql用户。

[http://docs.jboss.org/jbossas/getting_started/v4/html/db.html](http://docs.jboss.org/jbossas/getting_started/v4/html/db.html)

如果还是不行，你还是可以把驱动放到你jdk的lib/ext/文件夹下，但不是很合适的用法。

# android - 针对 ISA 服务器的身份验证，使用 HttpClient (Android)

> ID：10761911
> 
> 赞同：0
> 
> 时间：2012-05-25T22:10:52.347
> 
> 标签：android, authentication, httpclient, isaserver

我正在开发一个 Android 应用程序，它与我的服务器中的 RESTful WCF Web 服务进行通信。
通过使用 HttpClient，应用程序可以从 url 链接读取 json 代码。
例如：

[http://www.example.com/WebService/Service.svc/subscriptions/tiganeus](http://www.example.com/WebService/Service.svc/subscriptions/tiganeus)
返回 {"JSONUserDataResult":["Application A","Application B"]}

但是，此 Web 服务本身可以匿名访问，但受 ISA Server 保护。
当外部访问此链接时，浏览器会自动显示“需要身份验证”对话框。只需填写用户名和密码即可。

我想出了如何在 webview 中进行身份验证。以下代码有效

```
private class MyWebViewClient extends WebViewClient {
    @Override
    public void onReceivedHttpAuthRequest(WebView view,
            HttpAuthHandler handler, String host, String realm) {
        handler.proceed("username", "password");
        System.out.println("httpa");
    }
} 
```

但我真正需要的是从 url 读取 JSON 代码。我选择使用 HttpClient 来完成这项工作，但我不知道如何在 HttpClient 中进行身份验证。这听起来很简单，任何浏览器都可以做到。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:39:39.357

显然它比我想象的要简单得多。

```
DefaultHttpClient() httpClient = new DefaultHttpClient();       

httpClient.getCredentialsProvider().setCredentials(
    AuthScope.ANY,
    new NTCredentials(user, pass, "tamtam", "tamtam"));         

URI uri = new URI("http://www.example.com/WebService/Service.svc/subscriptions/tiganeus");
HttpGet httpget = new HttpGet(uri);
httpget.setHeader("Content-type", "application/json; charset=utf-8");*/

HttpResponse response = httpClient.execute(httpget);

HttpEntity responseEntity = response.getEntity();
String result = EntityUtils.toString(responseEntity); 
```

httpClient.getCredentialsProvider().setCredentials 适用于通过 isa 服务器进行的身份验证（至少对于我的 isa 服务器的配置方式而言。

它也处理基本身份验证。

# ios - 没有弧的初始化和分配？

> ID：10761912
> 
> 赞同：0
> 
> 时间：2012-05-25T22:10:52.520
> 
> 标签：ios, mkmapview, mapkit

抱歉，这是一个基本问题，我想知道为什么我的代码不需要用于 mapView 的 alloc/init。它会在保留时自动发生吗？我没有使用 ARC，并且在我的 MKMapView* mapView 的 alloc/init 上它不会导致错误，但地图视图不会显示位置信息，也不会显示为混合类型....但是在删除 alloc来自 viewDidLoad 的 /init 语句一切正常！为什么？

```
#import <UIKit/UIKit.h>
#import <CoreLocation/CoreLocation.h>
#import <MapKit/MapKit.h>

@interface MDViewController : UIViewController<CLLocationManagerDelegate, MKMapViewDelegate>

@property (retain, nonatomic) IBOutlet MKMapView* mapView;

@end

-----

#import "MDViewController.h"

@interface MDViewController ()
{
    CLLocationManager* lmanager;
}

@end

@implementation MDViewController

@synthesize mapView;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    lmanager= [[CLLocationManager alloc]init];
    lmanager.delegate=self;
    lmanager.desiredAccuracy=kCLLocationAccuracyBest;
    lmanager.distanceFilter=kCLDistanceFilterNone;
    [lmanager startUpdatingLocation];
    //mapView = [[MKMapView alloc]init];//without allocating here it works
    mapView.delegate=self;
    mapView.mapType=MKMapTypeHybrid;
}

-(void) locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
      //update map
    MKCoordinateSpan span;
    span.latitudeDelta= .001;
    span.longitudeDelta=.001;

    MKCoordinateRegion region;
    region.center= newLocation.coordinate;
    region.span=span;
    [mapView setRegion:region animated:YES];
    [mapView setShowsUserLocation:YES];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T06:37:10.880

您不需要分配初始化您的地图视图，因为它是由 Xib 为您完成的。加载界面 xib 时，框架会看到您有一个冻结的 mapview 并自动分配初始化它，然后将该 mapview 分配给您的 viewcontroller 代码中的那个。如果在您的代码中分配 init，则会断开两者之间的联系。

使其工作的一种方法是在您的 IB xib 中没有 mapview 并分配它，setDelegate，设置框架，最后将其视图添加为主视图的子视图。

我尽量保持简洁。我希望我们清楚你。ARC与这一切没有任何关系。

# android - Android ListView 分隔线

> ID：10761914
> 
> 赞同：1
> 
> 时间：2012-05-25T22:10:55.937
> 
> 标签：android, listview, separator, divider

如果 ListView 中的条目被禁用，则不会在其周围绘制分隔线。但是，如果我们将 dividerHeight 设置为较大的值，我们会注意到它们仍然存在……但只是不可见。

所以，两个问题：

*   如何完全摆脱它们？
*   有什么方法可以为主题中隐藏的分隔线设置样式并利用此功能？我们可以调整`<item name="android:listDivider">`，也许有某种`<item name="android:invisibleListDivider">`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:14:35.257

> 如何完全摆脱它们？

我不是 100% 肯定，但我会说它不能完成。

> 有什么方法可以为主题中隐藏的分隔线设置样式并利用此功能？我们可以调整，也许有某种？

有`@android:drawable/empty`。`@null`应该也可以。

# c# - 在 dbml 文件中创建关联？

> ID：10761915
> 
> 赞同：2
> 
> 时间：2012-05-25T22:10:58.550
> 
> 标签：c#, .net, sql-server, linq

我倾向于在数据库中创建表，然后将它们拖到 dbml 设计器上以创建我的 DataContext。我通常在 dbml 中手动创建关联，我应该这样做，还是应该已经在数据库中拥有这些关联？我问，因为在 MySQL 世界中，这些关联将由外键表示，我觉得我在数据库级别绕过了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:13:46.730

我建议像在 MySQL 中一样创建外键。设计师会把它们捡起来。

我在做 linq2sql 时的做法是让设计者提供尽可能多的信息，让它在有变化时再次生成*整个dbml。*

我将自定义存储在一个单独的部分 C# 类中。为什么？我更加确信 db 模式和 dbml 是同步的，所以我可以从同一个模型中推理，而不考虑对 dbml 进行的任何手工定制。最好直接编辑 dbml，因为它可以帮助您更好地诊断问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:15:50.847

在 MySQL 中创建外键会更安全。如果它们仅在 DBML 中，您的 .NET 代码将尊重这些关联，但如果您不创建它们，则在数据库级别不会有任何东西来强制执行相同的约束，这意味着直接 DB SQL 访问可能很危险。

# c# - FormClosing() 事件加载了两次

> ID：10761916
> 
> 赞同：4
> 
> 时间：2012-05-25T22:10:58.990
> 
> 标签：c#, formclosing

我想在关闭表单之前显示一个 MessageBox 以确认退出。因此，创建了一个 FormClosing 事件。

```
 private void Form_Main_FormClosing(object sender, FormClosingEventArgs e)
  {
     //nothing here for now
  } 
```

我的 MessageBox 显示了两次。调试工具显示代码以某种方式通过 FormClosing() 两次。即使我在上面的 FormClosing() 中没有任何内容，也会发生这种情况。我确实在我的整个代码中搜索了 FormClosing() ，并且只有一个地方可以订阅它。我在另外两个项目中有相同的 FormClosing() ，但这并没有发生。谁能给我指点？这对我来说没有任何意义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:04:13.647

您不能在 FormClosing 事件处理程序中调用 Close 和 Dispose 方法

表单关闭代码应为：

```
private void Form_Main_FormClosing(object sender, FormClosingEventArgs e)
  {
     DialogResult result = MessageBox.Show("EXIT?", "Exit Program", MessageBoxButtons.YesNo);

     if (result != DialogResult.Yes)
     {
          e.Cancel = true;
     }
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T15:51:18.667

好的，我想通了。我有：

初始化组件（）；

在两个地方。删除其中一个后，事情会按应有的方式工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T23:04:59.477

最有可能的“猜测”是您订阅了该事件两次。如果您使用设计器，请记住检查自动生成的设计器代码。

如果你在事件上设置了一个断点 - 你也可以拉起调用堆栈（http://msdn.microsoft.com/en-us/library/a3694ts5.aspx - 调试/窗口/调用堆栈），你可以看到什么执行代码以到达您所在的位置。

完全可以直接调用事件处理程序（但您不太可能会误操作）；但是查看调用堆栈可以帮助追踪它。

最后 - 确保您`Application.Exit`在处理 Closing 事件时没有调用或类似事件 - 我相信这会触发第二次触发。

# java - 关于使用 wav 文件进行编程以便在其上应用 dpcm

> ID：10761920
> 
> 赞同：0
> 
> 时间：2012-05-25T22:11:13.997
> 
> 标签：java, file, audio, wav, prediction

我想知道如何制作与 dpcm 相关的预测算法，以便将所有这些压缩/调制应用于 wav 文件。我需要使 wav 文件更小（）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T22:43:02.313

已经有很多这样的预测算法。它们被称为“音频压缩格式”。选择一个并使用它。

# javascript - Javascript 调用表单提交 -> 调用 -> Javascript（ajax 调用）未从 ajax 调用获得返回

> ID：10761922
> 
> 赞同：1
> 
> 时间：2012-05-25T22:11:30.770
> 
> 标签：javascript, jquery, form-submit

我有`<span>`一个`<a>`

```
 <a class="small-yellow-button float-right" id="signin" href="javascript:void(0);">
   <span>Sign In</span>
 </a> 
```

调用者：

```
$(document).ready(function(){
    $("#signin").click(function() {
    $('#form-signin').submit(); 
    });
}); 
```

调用：

```
<form method="post" action="" id="form-signin" onSubmit="login(); return false;" accept-charset="UTF-8" autocomplete="on">

function login()
{
   $.post(....), function(data)
{
  // code does NOT reach here.
  alert(data);
}
} 
```

这个函数发出一个 ajax 调用，我在服务器上得到请求并返回正确的响应，但不知何故我没有在这个函数中得到响应。我知道这个函数`login()`有效，因为我可以直接调用它，但不知何故，我必须为我的项目经历 javascript->form submit->javascript 的循环。

请帮忙...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T22:15:33.790

我只是`onsubmit`从表单中删除整个并使用它来代替：

```
$(document).ready(function(){
    $("#signin").click(login);
}); 
```

要防止表单正常提交，请在文档就绪块中添加以下内容：

```
$('#form-signin').submit(function(){
    return false;
}); 
```

现在，您说该`login`功能有效，但您为它发布的代码肯定不...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:14:13.060

它应该是：

```
$.post( url , data , function(data) { 
   //code
 }); 
```

# r - 具有 xtable 的 p 值的相关矩阵

> ID：10761923
> 
> 赞同：4
> 
> 时间：2012-05-25T22:11:57.620
> 
> 标签：r, sweave, correlation

我想拥有带有 p 值的相关矩阵，`xtable`以便在`Sweave`. 我试过这个

```
library(ltm)
library(xtable)
mat <- matrix(rnorm(1000), 100, 10, dimnames = list(NULL, LETTERS[1:10]))
rcor.test(mat)
xtable(rcor.test(mat)) 
```

它抛出这个错误：

```
Error in UseMethod("xtable") : 
  no applicable method for 'xtable' applied to an object of class "rcor.test" 
```

我想知道如何获得具有 p 值的相关矩阵以`xtable`用于`Sweave`. 在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T22:24:51.557

要查看发生了什么，我总是建议保存感兴趣的对象，然后使用`str`.

```
library(ltm)
library(xtable)
mat <- matrix(rnorm(1000), 100, 10, dimnames = list(NULL, LETTERS[1:10]))
out <- rcor.test(mat)
str(out) 
```

看起来正在打印的表格实际上并未存储在此处。那么我们来看看 rcor.test 的 print 方法

```
getAnywhere(print.rcor.test) 
```

我们看到该方法实际上构造了打印出来但不返回它的矩阵。因此，要获取矩阵以便我们可以从中使用 xtable，我们只需...窃取代码来构造该矩阵。我们将返回构造的矩阵，而不是打印出矩阵然后返回原始对象。

```
get.rcor.test.matrix <- function (x, digits = max(3, getOption("digits") - 4), ...) 
{
    ### Modified from print.rcor.test
    mat <- x$cor.mat
    mat[lower.tri(mat)] <- x$p.values[, 3]
    mat[upper.tri(mat)] <- sprintf("%6.3f", as.numeric(mat[upper.tri(mat)]))
    mat[lower.tri(mat)] <- sprintf("%6.3f", as.numeric(mat[lower.tri(mat)]))
    ind <- mat[lower.tri(mat)] == paste(" 0.", paste(rep(0, digits), 
        collapse = ""), sep = "")
    mat[lower.tri(mat)][ind] <- "<0.001"
    ind <- mat[lower.tri(mat)] == paste(" 1.", paste(rep(0, digits), 
        collapse = ""), sep = "")
    mat[lower.tri(mat)][ind] <- ">0.999"
    diag(mat) <- " *****"
    cat("\n")

    ## Now for the modifications
    return(mat)

    ## and ignore the rest
    #print(noquote(mat))
    #cat("\nupper diagonal part contains correlation coefficient estimates", 
    #    "\nlower diagonal part contains corresponding p-values\n\n")
    #invisible(x)
} 
```

现在让我们获取矩阵并在其上使用 xtable。

```
ourmatrix <- get.rcor.test.matrix(out)
xtable(ourmatrix) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T10:50:50.557

您也可以像这样使用自己的功能：

```
mat <- matrix(rnorm(1000), nrow = 100, ncol = 10,
              dimnames = list(NULL, LETTERS[1:10]))
cor_mat <- function(x, method = c("pearson", "kendall", "spearman"),
                    alternative = c("two.sided", "less", "greater")) {
    stopifnot(is.matrix(x) || is.data.frame(x))
    stopifnot(ncol(x) > 1L)
    if (is.data.frame(x)) x <- data.matrix(x)
    alternative <- match.arg(alternative)
    method <- match.arg(method)
    n <- ncol(x)
    idx <- combn(n, 2L)
    p.vals <- numeric(ncol(idx))
    for (i in seq_along(p.vals)) {
        p.vals[i] <- cor.test(x = x[, idx[1L, i]], y = x[, idx[2L, i]],
                              method = method, alternative = alternative)$p.value
    }
    res <- matrix(NA, ncol = n, nrow = n)
    res[lower.tri(res)] <- p.vals
    return(res)
}
library(xtable)
xtable(cor_mat(mat)) 
```

# java - 如何访问在 if 块中声明的变量？

> ID：10761928
> 
> 赞同：0
> 
> 时间：2012-05-25T22:12:39.927
> 
> 标签：java, variables

我有这个代码：

```
public void onPlayerInteract(PlayerInteractEvent event) {
    final Action action = event.getAction();
    if (action == Action.LEFT_CLICK_BLOCK){
        Location l1 = event.getClickedBlock().getLocation();
    } else if (action == Action.RIGHT_CLICK_BLOCK) {
        Location l2 = event.getClickedBlock().getLocation();
    }

    Thread t = new Thread() {
        @Override
        public void run() {
            while(true) {
                try {
                    Thread.sleep(1000*60*60);
                    //Insert code here
                } catch (InterruptedException ie) {
                }
            }
        }
    };
    t.start(); 
```

我如何`l1`访问`//insert code here`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T22:15:08.690

只需在块`l1`之外声明`if`，否则它是该块的本地。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T22:15:26.603

你不能，除非你在你的 if 块之外声明它。

使用您当前的代码，命名的变量`l1`可以从一行中访问。

如果您想在 if 块之外使用它，则不应在 if 块中定义它。

**此外**，如果您想在线程中使用它，您必须将变量声明为 final。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T22:17:54.963

您实际上正在处理两个问题：

1.  该变量`l1`应移到 if 块之外（因此`l1`在您要使用它的时候不会超出范围）。
2.  `l1`必须是最终的。内部类不会使用非最终变量，因为必须将变量*复制*到内部类实例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-25T22:16:39.087

我通常坚持最佳实践（特别是如果您要在 IF 块之外使用变量），就是在方法的顶部声明变量。

或者做这样的事情......

```
Location loc; 
if (action == Action.LEFT_CLICK_BLOCK){
    loc = event.getClickedBlock().getLocation();
} else if (action == Action.RIGHT_CLICK_BLOCK) {
    loc = event.getClickedBlock().getLocation();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-25T22:22:29.360

也许我遗漏了一些东西，但是如果在两种情况下都使用相同的方法调用链，为什么还要使用条件块？

我将您的代码更改如下：

```
public void onPlayerInteract(PlayerInteractEvent event) {
    final Location l = event.getClickedBlock().getLocation();

    Thread t = new Thread() {
        @Override
        public void run() {
            while(true) {
                try {
                    Thread.sleep(1000*60*60);
                    //Insert code here
                } catch (InterruptedException ie) {
                }
            }
        }
    };
    t.start(); 
```

或者，如果有更多 else-if 条件，您应该像这样使用 Location：

```
public void onPlayerInteract(PlayerInteractEvent event) {
    final Action action = event.getAction();
    final Location l = null;

    if (action == Action.LEFT_CLICK_BLOCK){
        l = event.getClickedBlock().getLocation();
    } else if (action == Action.RIGHT_CLICK_BLOCK) {
        l = event.getClickedBlock().getLocation();
    }

    Thread t = new Thread() {
        @Override
        public void run() {
            while(true) {
                try {
                    Thread.sleep(1000*60*60);
                    //Insert code here
                } catch (InterruptedException ie) {
                }
            }
        }
    };
    t.start(); 
```

但话又说回来......也许我错过了一些东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T22:19:24.273

您需要了解变量通常在创建的 cope 中可用。但它们通常可以设置在具有该范围的任何范围内。

所以试试这个

```
public void onPlayerInteract(PlayerInteractEvent event) { 

    final Action action = event.getAction(); 
    Location l1; // Created at function scope
    Location l2;  
    if (action == Action.LEFT_CLICK_BLOCK){ 
         l1 = event.getClickedBlock().getLocation();  // l1 available here
    } else if (action == Action.RIGHT_CLICK_BLOCK) { 
         l2 = event.getClickedBlock().getLocation();  // l1 available here
    } 

    and l1 & l2 available here and below
    .
    .
    .

} // l1 & l2 go out of scrope here. 
```

此外，您应该考虑现在不需要 l1 和 l2，因为在左键或右击时只有一个被设置。

# php - 是否可以在 php 脚本中包含汇编代码？

> ID：10761931
> 
> 赞同：3
> 
> 时间：2012-05-25T22:13:02.907
> 
> 标签：php, assembly

我的意思是这样的：

```
asm(

 //assembly code here
 mov dx, 4 // etc...

) 
```

asm() - php 函数

有可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T22:14:07.520

不，这是不可能的。最接近的方法是使用`exec()`或类似的功能来调用外部程序或脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:59:10.540

简而言之，没有。

PHP 脚本被编译成特定于其特定虚拟机的字节码（假设这里是 Zend Engine）。因此，您无法将本机代码和 PHP 代码与标准发行版混合使用。

但是，可以为 PHP 编写 C 扩展，您可以在其中使用内联汇编。

# c - 如何在 x86-64 下保留参数/参数寄存器？

> ID：10761934
> 
> 赞同：1
> 
> 时间：2012-05-25T22:13:15.293
> 
> 标签：c, gcc, assembly, 64-bit

[System V AMD64 ABI 调用约定](http://x86-64.org/documentation/abi.pdf)是这样规定的：

> 寄存器`%rbp`，`%rbx`并`%r12`通过`%r15`“属于”调用函数，并且被调用函数需要保存它们的值。换句话说，被调用函数必须为其调用者保留这些寄存器的值。剩余的寄存器“属于”被调用的函数。如果调用函数想要在函数调用中保留这样的寄存器值，它必须将值保存在其本地堆栈帧中。

例如，给定以下代码：

```
void f1(const int i, const double j, const char * k)
{
    printf("i = %d\n", i);
    printf("j = %g\n", j);
    printf("k = %s\n", k);
} 
```

装配表示为：

```
f1():
  4004f4:   55                      push   %rbp
  4004f5:   48 89 e5                mov    %rsp,%rbp
  4004f8:   48 83 ec 20             sub    $0x20,%rsp
  4004fc:   89 7d fc                mov    %edi,-0x4(%rbp)
  4004ff:   f2 0f 11 45 f0          movsd  %xmm0,-0x10(%rbp)
  400504:   48 89 75 e8             mov    %rsi,-0x18(%rbp)
  400508:   b8 70 06 40 00          mov    $0x400670,%eax
  40050d:   8b 55 fc                mov    -0x4(%rbp),%edx
  400510:   89 d6                   mov    %edx,%esi
  400512:   48 89 c7                mov    %rax,%rdi
  400515:   b8 00 00 00 00          mov    $0x0,%eax
  40051a:   e8 d1 fe ff ff          callq  4003f0 <printf@plt>
  40051f:   b8 78 06 40 00          mov    $0x400678,%eax
  400524:   f2 0f 10 45 f0          movsd  -0x10(%rbp),%xmm0
  400529:   48 89 c7                mov    %rax,%rdi
  40052c:   b8 01 00 00 00          mov    $0x1,%eax
  400531:   e8 ba fe ff ff          callq  4003f0 <printf@plt>
  400536:   b8 80 06 40 00          mov    $0x400680,%eax
  40053b:   48 8b 55 e8             mov    -0x18(%rbp),%rdx
  40053f:   48 89 d6                mov    %rdx,%rsi
  400542:   48 89 c7                mov    %rax,%rdi
  400545:   b8 00 00 00 00          mov    $0x0,%eax
  40054a:   e8 a1 fe ff ff          callq  4003f0 <printf@plt>
  40054f:   c9                      leaveq 
  400550:   c3                      retq 
```

在本例中，参数已传入`%edi`,`%xmm0`和`%rsi`。调用约定规定这些寄存器“属于”被调用函数，这意味着`f1`没有义务保留它们的值。事实上，`%edi`和`%xmm0`都`%rsi`在以下几行中被丢弃：

```
400510: 89 d6                   mov    %edx,%esi
400512: 48 89 c7                mov    %rax,%rdi
..
400524: f2 0f 10 45 f0          movsd  -0x10(%rbp),%xmm0 
```

我想保留所有参数寄存器。文档说明该值可以保存在我尝试过的本地堆栈中，如下所示：

```
void f1(const int i, const double j, const char * k)
{
    uint32_t edi;
    __asm ("movl %%edi, %0;" : "=r" ( edi ));

    printf("i = %d\n", i);
    printf("j = %g\n", j);
    printf("k = %s\n", k);

    __asm ("movl %0, %%edi;" : "=d"( edi ));
} 
```

这会生成以下内容：

```
f1():
  4004f4:   55                      push   %rbp
  4004f5:   48 89 e5                mov    %rsp,%rbp
  4004f8:   53                      push   %rbx
  4004f9:   48 83 ec 38             sub    $0x38,%rsp
  4004fd:   89 7d dc                mov    %edi,-0x24(%rbp)
  400500:   f2 0f 11 45 d0          movsd  %xmm0,-0x30(%rbp)
  400505:   48 89 75 c8             mov    %rsi,-0x38(%rbp)
  400509:   89 fb                   mov    %edi,%ebx
  40050b:   89 5d ec                mov    %ebx,-0x14(%rbp)
  40050e:   b8 80 06 40 00          mov    $0x400680,%eax
  400513:   8b 55 dc                mov    -0x24(%rbp),%edx
  400516:   89 d6                   mov    %edx,%esi
  400518:   48 89 c7                mov    %rax,%rdi
  40051b:   b8 00 00 00 00          mov    $0x0,%eax
  400520:   e8 cb fe ff ff          callq  4003f0 <printf@plt>
  400525:   b8 88 06 40 00          mov    $0x400688,%eax
  40052a:   f2 0f 10 45 d0          movsd  -0x30(%rbp),%xmm0
  40052f:   48 89 c7                mov    %rax,%rdi
  400532:   b8 01 00 00 00          mov    $0x1,%eax
  400537:   e8 b4 fe ff ff          callq  4003f0 <printf@plt>
  40053c:   b8 90 06 40 00          mov    $0x400690,%eax
  400541:   48 8b 55 c8             mov    -0x38(%rbp),%rdx
  400545:   48 89 d6                mov    %rdx,%rsi
  400548:   48 89 c7                mov    %rax,%rdi
  40054b:   b8 00 00 00 00          mov    $0x0,%eax
  400550:   e8 9b fe ff ff          callq  4003f0 <printf@plt>
  400555:   89 d7                   mov    %edx,%edi
  400557:   89 d3                   mov    %edx,%ebx
  400559:   89 5d ec                mov    %ebx,-0x14(%rbp)
  40055c:   48 83 c4 38             add    $0x38,%rsp
  400560:   5b                      pop    %rbx
  400561:   5d                      pop    %rbp
  400562:   c3                      retq 
```

这似乎不会恢复 的值`%edi`。保存所有参数/参数寄存器的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T00:07:14.330

You can't mix C and asm like this. In particular, executing an isolated push or pop instruction in inline assembly will horribly break things; any given inline assembly block must have a net offset of 0 on the stack pointer.

Really, the ABI document is rather irrelevant to the use of inline asm. For that, you need to follow the GCC inline asm contract of documenting which registers you use for input and output and what's in the clobber list. The ABI is relevant if you're writing entire functions in assembler (in a `.s` file not a `.c` file).

# node.js - Node.js Mongoosejs 填充填充字段

> ID：10761939
> 
> 赞同：3
> 
> 时间：2012-05-25T22:13:42.423
> 
> 标签：node.js, mongoose

我的文档有一个文档，它有一个文档。我也想知道如何填充内部文档。我已经尝试过了，但它没有填充我的内部文档。

```
 Document.find({})
        .populate('owner')
        .populate('owner.company')
        .run(function(err,docs){
        if(err){
            req.flash('error', 'An error has occured. Please contact administrators.')
        }
        console.log(docs);
        res.render('dashboard/index', { title: 'Dashboard', menu: 'Dashboard', docs: docs});
    });

var mongoose = require("mongoose"),
    Schema   = mongoose.Schema,
    ObjectId = Schema.ObjectId,
    DocumentObjectId = mongoose.Types.ObjectId;

var Document = new Schema({
    filepath: {type: String, required: true},
    createdBy: {type: String, required: true},
    created: {type: Date, default: Date.now},
    owner: {type: ObjectId, ref: 'owner'}
});

var Owner = new Schema({
    fullname: {type: String, required: true},
    company: {type: ObjectId, ref: 'company'}
});

var Company = new Schema({
    name: {type: String, required: true},
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-17T17:25:52.970

Mongoose 不支持嵌套种群。因此这部分是无效的：`.populate('owner.company')`

有一个插件：[https ://github.com/buunguyen/mongoose-deep-populate](https://github.com/buunguyen/mongoose-deep-populate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:23:04.737

似乎这是在 github 上打开的错误 #601。如果他们得到它，将不得不等待下一个版本的修复。

# android - 如何在android中声明一个复选框数组

> ID：10761942
> 
> 赞同：3
> 
> 时间：2012-05-25T22:13:54.290
> 
> 标签：android, arrays, checkbox

我已经用谷歌搜索了这个问题，但找不到一个简单或足够具体的答案：任何有经验的程序员可以帮助我......？

我在一个名为 dialog1 的自定义对话框中有一组 10 个复选框。

```
public class DigitsActivity extends Activity {
...
CheckBox[] ckbDigits = new CheckBox[10];
...

public void SelectDigit1(){  // method which opens the custom dialog

Context context=DigitsActivity.this;
final Dialog dialog1 = new Dialog(context);
...
for (int k = 0; k <= 9; k++){
  ckbDigits[k] = (CheckBox) dialog1.findViewById(R.id.ckbDigits[k]);
}
...
} 
```

我在生产线上遇到多个错误

```
ckbDigits[k] = ... 
```

我也试过：

```
ckbDigits[] = (CheckBox) dialog1.findViewById(R.id.ckbDigits[]); 
```

但它也不起作用......

谁能告诉我如何声明一组复选框？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-18T17:51:26.057

宣布 `CheckBox chk[];`

然后这样做

```
 chk=new CheckBox[size];
  for (int i = 0; i < size; i++) {
            chk[i] = (CheckBox) dialog.findViewById(R.id.checkBox);
            chk[i].setChecked(true);
           // whatever operations
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:35:44.320

1.  have you called "setContentView" before trying to find the views?
2.  have you initialized the array of ids ?
3.  what's this : "R.id.ckbDigits[]" ?
4.  in any case , i would suggest naming the ids as something like "checkbox0" , "checkbox1" ,... , and then find them by using getIdentifier (like [this](http://steven.bitsetters.com/2007/11/27/accessing-android-resources-by-name-at-runtime/)) , in order to make the initialization of the ids easier . you could make it stop when it didn't find the id that it has searched for.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-25T12:48:33.320

您必须像这样声明 CheckBox 的新向量

例如 ：

```
public class Test{
   static int ckbDigits[]={id.ckbDigits0,id.ckbDigits1,id.ckbDigits2,id.ckbDigits3,
    id.ckbDigits4
    id.ckbDigits5,id.ckbDigits6,id.ckbDigits7,id.ckbDigits8,id.ckbDigits9};

} 
```

在你的代码中做了这样的事情之后

```
for (int k = 0; k <= 9; k++){
  ckbDigits[k] = (CheckBox) dialog1.findViewById(Test.ckbDigits[k]);
} 
```

# php - 使用 HTTPS 让 cURL 在 PHP 中工作

> ID：10761943
> 
> 赞同：3
> 
> 时间：2012-05-25T22:13:56.473
> 
> 标签：php, curl

我有以下代码适用于不使用 SSL 的测试区域，但不适用于生产系统。该调用本身可以在浏览器中运行，但是通过 cURL 运行它时，出现 500 错误。

```
$region = "https://api.mysite.com/";
$ch = curl_init();
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_CAINFO, dirname(__FILE__) . "/cacert.pem");
curl_setopt($ch, CURLOPT_FAILONERROR, true);
curl_setopt($ch, CURLOPT_URL, $region . $api);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));
$resp = curl_exec($ch);
$error = curl_error($ch);
curl_close($ch); 

return $resp; 
```

如果我不输入 CURL_OPT_FAILONERROR，那么我不会收到任何错误，只是一个空白响应。我很确定这与通过 https 的事实有关（因为这是我的测试区域和当前区域之间的唯一区别），但我不知道如何让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T10:25:49.447

要确认第一个问题是否由于 ssl，请检查以下内容

```
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 
```

它适用于那个吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T09:51:15.073

尝试设置 CURLOPT_REFERER 和 CURLOPT_USERAGENT。我有同样的问题，这解决了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T23:06:36.137

尝试类似的东西

```
<?php

error_reporting(E_ALL);

ini_set("display_errors", 1);

$data = array(
    CURLOPT_CAINFO => "/Users/davidmann/Documents/facebook.pem", 
    CURLOPT_SSL_VERIFYHOST => 1,
    CURLOPT_SSL_VERIFYPEER => true
);

echo var_dump(curl_get('https://www.facebook.com/', array('Refferer' => 'https://www.facebook.com/'), $data));

/** 
 * Send a GET requst using cURL 
 * @param string $url to request 
 * @param array $get values to send 
 * @param array $options for cURL 
 * @return string 
 * @author David from Code2Design.com
 * @link http://au.php.net/manual/en/function.curl-exec.php#98628
 */ 
function curl_get($url, array $get = NULL, array $options = array()) 
{    
    $defaults = array( 
        CURLOPT_URL => $url. (strpos($url, '?') === FALSE ? '?' : ''). http_build_query($get), 
        CURLOPT_HEADER => 1, 
        CURLOPT_RETURNTRANSFER => TRUE, 
        CURLOPT_TIMEOUT => 4 
    ); 

    $ch = curl_init(); 
    curl_setopt_array($ch, ($options + $defaults)); 
    if( ! $result = curl_exec($ch)) 
    { 
        trigger_error(curl_error($ch)); 
    } 
    curl_close($ch); 
    return $result; 
} 
```

然后从您正在访问的网站下载证书（打开firefox，转到[https://site.com](https://site.com)，右键单击，查看页面信息，安全选项卡，证书，选择最上面的证书，导出为x.509，然后使用更新这`CURLOPT_CAINFO`

希望这会有所帮助，戴夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T22:28:13.707

根据您的描述，问题很可能与匹配证书有关。尝试：

```
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); 
```

显然，这不是您问题的“解决方案”，但它会帮助您进行故障排除。

祝你好运！

# gcc - 强制 GCC 在 memset() 调用中使用重复前缀

> ID：10761950
> 
> 赞同：8
> 
> 时间：2012-05-25T22:14:52.347
> 
> 标签：gcc, assembly

我正在开发一个性能至关重要的应用程序。我希望 GCC 将对 memset() 的一些特定调用转换为带有重复前缀的指令，例如“rep stos QWORD PTR es:[rdi],rax”。当大小已知且很小时，GCC 会自动执行此操作。

但是，GCC 通过 PLT 调用 memset() 将调用映射到具有随机长度的 memset()，这会导致分支预测错误，因为分支预测器缓存是冷的。

有没有办法强制 GCC 做我想做的事情（在内联汇编之外）？请注意，我不希望整个程序出现这种行为，只对某些特定的 memset() 调用。

在一个相关主题上，我也对任何阻止 GCC 在 cmovcc 指令完成工作时分支的 hack 感兴趣（我知道使用 &、+ 等而不是 &&）。

非常感谢您的帮助。

@弗兰克：

这基本上就是我最终所做的。这是我的代码：

```
static finline void app_zero(void *dst, uint32_t size, uint32_t count)
{
    // Warning: we tell gcc to use 'dst' both as source and destination here.  
    // This does not cause problems because we don't reuse 'dst'.  
    #ifdef APP_ARCH_X86 
    #define STOS(X,Y) do { \  
        int c = (size/Y)*count; \  
        __asm__ __volatile__("cld; xor %%eax, %%eax; rep stos"X"\n\n" \
                             : "+D"(dst), "+c"(c) :: "rax", "flags"); \  
        } while (0)  
    if (size % 8 == 0)      STOS("q", 8);  
    else if (size % 4 == 0) STOS("l", 4);  
    else if (size % 2 == 0) STOS("w", 2);  
    else                    STOS("b", 1);  
    #undef STOS  
    #else  
    memset(dst, 0, size*count);  
    #endif  
} 
```

请注意，您的示例在您的测试设置中有效，但通常不会有效。GCC可以改变方向标志，所以`cld`需要一条指令。此外，您必须告诉 gcc`%rdi`并且`%rcx`将被`stos`指令更改，并且由于 gcc 不允许您指定寄存器既是输入又是被破坏的，因此您必须使用笨拙的`"+"`语法（这也会破坏您的输入值） .

由于“cld”指令在 Nehalem 上具有 4 个周期的延迟，因此这不是最佳的。GCC 在内部跟踪标志寄存器状态 (AFAICT)，因此它不需要每次都发出该指令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T16:50:15.447

如果要强制执行此操作，为什么要*排除*内联汇编作为选项？

```
#define my_forced_inline_memset(dst, c, N) \
   __asm__ __volatile__(                   \
       "rep stosq %%rax, (%%rdi)\n\t"
       : : "D"((dst)), "a"((c)), "c"((N)) : "memory"); 
```

在演示程序中使用它，例如：

```
int main(int argc, char **argv)
{
    my_forced_inline_memset(argv[0], 0, argc);
    return 0;
} 
```

为我创建了这个程序集：

```
00000000004004b0 <main>:
  4004b0:       89 f9                   mov    %edi,%ecx
  4004b2:       31 c0                   xor    %eax,%eax
  4004b4:       48 8b 3e                mov    (%rsi),%rdi
  4004b7:       f3 ab                   repz stos %rax,%es:(%rdi)
  4004b9:       c3                      retq 
```

这不是为什么 GCC 选择做不同的解释，但正如所说，如果你想强制你的行为，并且如果你明确知道你需要这个的地方，那么调用某种特别定义的你自己的memset？

**注意：（** `repz stos %rax,(%rdi)`或等效的 Intel 语法`QWORD PTR`）*与*for 的粒度不同，`memset()`因为它的粒度`memset()`是单个字节。上述情况与此相同`memset(..., c, N * 8)`。请记住这一点。

*编辑：*如果您将代码编写为：

```
#include <stdint.h>                        // for uintptr_t
#define my_forced_inline_memset(dst, c, N)                            \
   __asm__ __volatile__(                                              \
       "rep stos %1, (%0)\n\t"                                        \
       :: "D"((dst)), "a"((uintptr_t)(c)), "c"((N)/sizeof(uintptr_t)) \
       : "memory"); 
```

它编译为 32 位和 64 位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T05:56:06.637

我不了解 GCC，但在较新的 MSVC 版本下，使用循环进行设置/复制强制使用`REP STOS`（并且它仍然允许优化已知大小和自动矢量化），它可能在 GCC 下尝试.

检查 GCC 是否具有类似于 的内置函数的替代方法`__stosq`，否则您可能需要进行内联汇编，但这在 GCC 下一点也不差（这可能是最简单和最快的方法）。

你的第二个问题是通用的方法才能真正得到一个好的答案，因为它取决于手头的情况，但是，GCC 在优化分支方面应该做得足够好，除了特定的极端情况（使用`SETCC`/ `MOVCC`/ `FMOVCC`）。

# database - JavaFX 2.1 替换 tableview 数据

> ID：10761952
> 
> 赞同：0
> 
> 时间：2012-05-25T22:14:54.903
> 
> 标签：database, tableview, javafx-2, fxml

我这里有个小问题。我正在开发一个小应用程序，它应该解释并显示一个 sql 询问的表视图。我的大问题是我不知道如何使用 fxml 创建一个新的 tableview 实例进行新的询问，并用新数据替换表中的数据！我的意思是，如果我选择 2 列，它将显示 2 列，然后我选择 3 列，我将有一个 3 列的表格视图。有任何想法吗？

很简单：我需要用tableview中的新查询数据替换现有的查询数据！

我正在使用 fxml！

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T08:11:15.420

我自己找到了答案。在执行每个 sql 命令之前，我必须清除 tableview 数据，包括列！

# gwt - 如何防止 ClickHandler 在 GWT 中的按钮上被调用两次？

> ID：10761967
> 
> 赞同：0
> 
> 时间：2012-05-25T22:16:45.023
> 
> 标签：gwt, button, dialog, click

设置如下：我有一个页面，我们将其称为 A，其中包含一个按钮，我们将其称为 B。当用户单击 B 时，将打开一个对话框 (C)。C一旦创建就对A或B一无所知。

现在，如果用户双击 B，则会创建 2 个或更多 C，这是不可取的。由于 C 对 B 一无所知，我无法禁用该按钮，因为如果用户在 C 中按下取消，他们将返回 A 但 B 仍将被禁用。我也无法保存页面 ID 并限制 C 以这种方式创建，因为如果用户确实打开 C，单击取消但随后决定再次打开 C，他们必须能够这样做。

无论连续点击多少次，如何阻止按钮打开多个对话框？

**编辑**
我在上面的描述中简化了太多，所以这里有一个更深入的了解。我的`Toolbar`班级有一个名为 的按钮`reference`。单击时`reference`，会在一个完全独立的类上调用一个函数，该类`ItemPicker`会创建并显示`CreateConversation`对话框。所以，回到我原来的场景，B 对 C 一无所知。我意识到这很复杂，但目前我无法改变。

不知何故，我需要停止`reference`第二次调用，`ItemPicker.createAndShow()`如果它被点击了不止一次并且`CreateConversation`已经打开了一个对话框。`ItemPicker`此外，类中没有特定的实例`Toolbar`；`createAndShow()`是一种静态方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:07:50.087

C 不知道 B，但 B 知道 C：处理它并调用`show()`. 如果 C 已经显示，则为空操作，如果已关闭（或尚未打开），则显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T22:54:53.320

大概 A 引用了 C。

在C 中单击*Cancel*时，调用`C.hide()`. 现在在您的`ClickHandler`for B 中，您可以检查`C.isShowing()`并启用/禁用创建对话框，或使用`C.show()`.

当在 C 中单击*Cancel*时，除了调用之外，`hide()`您还可以重新初始化 C 并保留它以供下一次 B 单击。

# c# - 为 WPF 本地化设置文本流向

> ID：10761968
> 
> 赞同：0
> 
> 时间：2012-05-25T22:16:49.627
> 
> 标签：c#, wpf, xaml, localization, wpflocalizationextension

我正在使用[WPF LocalizationExtension](http://wpflocalizeextension.codeplex.com/)并且可以让它工作。但是，即使它说它内置了对 FlowDirection（从右到左）的支持，我也无法让它工作，并且文档还不够。

`FrameworkElement.FlowDirection="{lex:LocText Key=FlowDirection, Dict=Strings, Assembly=LocalizationManager}`我在我的`<Window ...>`定义中添加了这一行。但它会引发类似的错误`You cannot use "" for Flow Direction`。但是，如果我对文本块使用相同的标记，我可以成功地使文本正常工作`LeftToRight`或`RightToLeft`.

我认为这是一个类型转换问题，但不知道如何解决。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:29:50.680

我改变了代码如下，它工作。

```
FrameworkElement.FlowDirection="{lex:LocFlowDirection Key=FlowDirection, Dict=Strings, Assembly=LocalizationManager}" 
```

# excel - 使用自定义类访问 OLEObject 事件

> ID：10761973
> 
> 赞同：3
> 
> 时间：2012-05-25T22:17:08.230
> 
> 标签：excel, vba

我正在尝试在 Excel VBA 中创建一个自定义类来处理 OLEObject（工作表上的 ActiveX 控件）的事件 GotFocus 和 LostFocus。

自定义类**clsSheetControl**

```
Dim WithEvents objOLEControl as OLEObject

Public Sub Init(oleControl as OLEObject)
    Set objOLEControl = oleControl
End Sub 
```

结束自定义类

调用**工作表**

```
Public Sub SetControlHandler()
     set clsControl = new ClsSheetControl
     clsControl.Init(Me.OLEObjects("cmdControl1")
End Sub 
```

结束**工作表**

当我在下拉列表中选择 objOLEControl 时，我可以在自定义类模块中创建“GotFocus”和“LostFocus”，但是当该行

```
 Set objOLEControl = oleControl 
```

在自定义类中遇到，我得到错误

> “459：对象或类不支持这组事件”。

我尝试寻找答案，但大多数结果都涉及访问 OLEObject 中的控制对象，而不是我在这里尝试做的事情。

**编辑**

这也不适用于工作表

**工作表**

```
Dim WithEvents objCtrl As OLEObject
Dim WithEvents chkCtrl As MSForms.CheckBox

Private Sub Worksheet_Activate()
     Set chkCtrl = Me.OLEObjects("chkControl").Object
     Set objCtrl = Me.OLEObjects("chkControl")
End Sub

Private Sub chkControl_GotFocus()
    MsgBox ("chkControl has focus")
End Sub 
```

线

```
Set objCtrl = Me.OLEObjects("chkControl") 
```

引发同样的错误。但是直接访问 GotFocus 事件（chkControl_GotFocus 事件）很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T23:19:49.533

这对我有用，但它特定于文本框控件并且没有“GotFocus/LostFocus”事件......

**clsSheetControl**

```
Dim WithEvents objOLEControl As MSForms.TextBox

Public Sub Init(oleControl As MSForms.TextBox)
    Set objOLEControl = oleControl
End Sub

Private Sub objOLEControl_Change()
    MsgBox "Changed"
End Sub

Private Sub objOLEControl_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, _
                                  ByVal Shift As Integer)
    MsgBox "Key down: " & KeyCode
End Sub 
```

**工作表**

```
Dim objControl As clsSheetControl

Public Sub SetControlHandler()
    Set objControl = New clsSheetControl
    objControl.Init Me.OLEObjects("TextBox1").Object
End Sub 
```

# database - 如何修复 pgbackups 错误：备份 url 无效？

> ID：10761977
> 
> 赞同：3
> 
> 时间：2012-05-25T22:18:08.377
> 
> 标签：database, heroku, cedar

我正在尝试按照有关迁移到 Cedar 的说明进行操作（除非我进行了重大重写，因此这不是上一个应用程序的分支，而是一个单独的应用程序）并停留在 db 迁移步骤。我安装了 pgbackup 和 heroku postgresql 插件，但得到了这个结果：

j3(master) : heroku pgbackups:restore DATABASE `heroku pgbackups:url --app dada-foe-110`--app something-something-4311 32mQkEpWyJdfplOnXhlCnCRsoxYE12-05-25 --app something-something-4311 EXTERNAL_BACKUP <---restore--- b002.dump

！警告：破坏性行动！此命令将影响应用程序：something-something-4311 ！要继续，请键入“something-something-4311”或使用 --confirm something-something-4311 重新运行此命令

[输入应用名称]

正在检索...完成

！发生错误，您的还原未完成。！备份网址无效。用于`pgbackups:url`生成新的临时 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:25:16.177

Heroku gem 版本 2.26.（0 到 2）存在一个错误。我们已经发布了一个修复程序。升级到 2.26.3 或更高版本

确保输出`heroku pgbackups:url --app dada-foe-110`类似于`https://s3.amazonaws.com/hkpgbackups/app455048@heroku.com/a273.dump?AWSAccessKeyId=AKIAJYEDAEBRU6KYW6QA&Expires=1337985248&Signature=secretsblah`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-12T15:17:47.303

我在尝试从 S3 服务器恢复时遇到了类似的问题。我只是在 S3 上为该文件上的每个人添加了打开/下载权限，否则您需要包含 AWSAccessKeyId，如上述 Will 的回答中所述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-02T19:52:56.737

备份 URL 为“无效”的其他原因可能是权限或键入或复制 URL 时出错。例如，我尝试了 heroku 的说明，[将数据库从一个位置备份和还原](https://devcenter.heroku.com/articles/heroku-postgres-import-export)到另一个位置，但忽略了让 Heroku 可读的 S3 文件，因此还原失败并出现同样的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T17:33:00.720

从提供的 S3 URL 下载转储，并将其放在其他可自由访问的位置（我有一个 S3 帐户，所以我将其粘贴在那里 - 如果您的数据库非常大，并且您想直接在 S3 之间传输（如果有）此处的说明之一[https://s3.amazonaws.com/tearthedge_backup/db_backup/b011.dump](https://s3.amazonaws.com/thearthedge_backup/db_backup/b011.dump)似乎可以解决问题），然后在您的

```
heroku pgbackups:restore 'ADD_YOUR_NEW_BACKUP_URL_HERE_WITH_SINGLE_QUOTES' --app your-app-to-restore-to 
```

在过去的几天里，我一直遇到同样的问题，尽管将备份从 Heroku 移开似乎可以解决问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T16:15:26.760

原来我需要更新 Heroku gem。但是，来自他们的错误消息很差，我不得不去支持票证才能理解这一点，因为我只有一个或两个次要版本过时，你不会期望在那个级别发生重大变化。那好吧。

# excel - Excel - 根据多个条件获取列号

> ID：10761978
> 
> 赞同：0
> 
> 时间：2012-05-25T22:18:10.267
> 
> 标签：excel, vba

我将标题分隔到不同的行。我没有一个有意义且独特的标题，例如“周二倾倒的水公升”，而是：

> 周二倾倒的
> 水量

分隔 4 行。

我想知道星期二倾倒了多少水，并且有多个列分别表示“升”、“水”、“倾倒”和“星期二”。是否有一个excel函数可以帮助我做到这一点？我需要去使用宏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T17:30:22.150

如果我理解正确，您需要将整个标题放在一个单元格中，而不是将四行分成四个单独没有有用意义的部分。

您可以使用 Excel 的`CONCATENATE`函数或等效的更简洁的运算符来执行此`&`操作。例子：

![在此处输入图像描述](../Images/6cddd2541e79838256eeaf9c259ad7fd.png)

现在你有了你独特的标题，你可以用它做任何你想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T00:45:49.957

这是你正在尝试的吗？我假设数据的排列方式如快照所示。

`=OFFSET(INDIRECT(CELL("Address",INDEX(A1:D4,MATCH(TRUE,COUNTIF(OFFSET(A1:D4,ROW(A1:D4)-CELL("Row",A1:D4),0,1),F1)>0,0),MATCH(F1,INDEX(A1:D4,MATCH(TRUE,COUNTIF(OFFSET(A1:D4,ROW(A1:D4)-CELL("Row",A1:D4),0,1),F1)>0,0),0),0)))),1,0)`

这是一个数组公式，即输入公式后必须按 CTL+SHIFT+ENTER

**快照**

![在此处输入图像描述](../Images/7e64f0fe993e448f461b646ef809ccef.png)

# django - django 检索用户对象

> ID：10761979
> 
> 赞同：0
> 
> 时间：2012-05-25T22:18:36.030
> 
> 标签：django

我有一个像这样的简单模型：

```
class Auction(models.Model):
    name = models.CharField()

class Item(models.Model):
    auction = models.ForeignKey(Auction)
    name = models.CharField()
    price = models.FloatField()

class Bid(models.Model):
    item = models.ForeignKey(Item)
    user = models.ForeignKey(User)
    price = models.FloatField() 
```

用户对一个项目进行投标。知道用户只允许为每件商品出价一次。如果我有拍卖 ID，我能否获得在该拍卖中出价的所有**用户对象**（不是简单的用户名，例如 a `values_list()`）？

编辑：我也想避免使用'in'

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T22:53:50.673

```
users = User.objects.filter(bid__item__auction_id=auction_id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:02:57.747

It's probably possible to do it much easier, but this is the way I would try.

Add related names:

```
from django.db import models
from django.contrib.auth.models import User

class Auction(models.Model):
    name = models.CharField(max_length=20)

class Item(models.Model):
    auction = models.ForeignKey(Auction,related_name="items")
    name = models.CharField(max_length=20)
    price = models.FloatField()

class Bid(models.Model):
    item = models.ForeignKey(Item,related_name="bids")
    user = models.ForeignKey(User,related_name="bids")
    price = models.FloatField() 
```

Now, if you have these:

```
a = Auction.objects.get(pk=auction_id)
users = set([]) #because there's no reason to have dupe users
for item in a.items.all():
    for bid in item.bids.all():
        users.add(bid.user) 
```

Now, all the users with one or more bids in that auction is in the list

# c# - USB大容量存储的写权限

> ID：10761980
> 
> 赞同：1
> 
> 时间：2012-05-25T22:18:48.923
> 
> 标签：c#, windows, visual-studio-2010, winapi, usb

我想让 USB 磁盘写保护，我发现这样做是一种解决方案：

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\StorageDevicePolicies]
"WriteProtect"=dword:00000001 
```

但这对我来说有两个缺点：

1.  它不适用于已安装的 USB 磁盘，如果安装是在修改注册表之前，但如果我再次删除并添加磁盘或任何其他磁盘，它仍然有效。

2.  这适用于所有 USB 端口。

所以，我要做什么：

1.  在我的 Windows 服务中获得 device_arrival 事件后，立即根据序列号（我在 Windows 服务中获得）对 USB 磁盘进行写保护。我不想重新插入 USB 记忆棒才能正常工作。

2.  是否可以限制特定 USB 磁盘的这种行为？我的意思是，如果我有我想要写保护的 USB 磁盘 nr1 和我不想写保护的 USB 磁盘 nr2，我可以将它们同时安装在我的电脑上，同时进行所需的写/读前提？

顺便说一句，我想在 C# 中执行此操作，并且我正在使用 Windows 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T22:32:08.603

不知道这有多有效，但您可以强制弹出并重新安装软件吗？

[如何以编程方式拔出和重新插入任意 USB 设备？](https://stackoverflow.com/questions/138394/how-to-programatically-unplug-replug-an-arbitrary-usb-device)

# database - 如何告诉 cucumber & databasecleaner 将我的种子数据留在我的 Rails 测试数据库中？

> ID：10761983
> 
> 赞同：5
> 
> 时间：2012-05-25T22:19:07.783
> 
> 标签：database, ruby-on-rails-3, rspec, cucumber

我有几个包含参数和其他东西的表，它永远不会改变！

但是我不能告诉 database_cleaner 保留这些数据，每次测试后它都会截断我的所有数据库。

**宝石**

```
gem "cucumber-rails", "~> 1.3.0", require: false
gem 'factory_girl_rails'
gem 'database_cleaner' 
```

**配置/黄瓜.yml**

```
enter code here
<%
rerun = File.file?('rerun.txt') ? IO.read('rerun.txt') : ""
rerun_opts = rerun.to_s.strip.empty? ? "--format #{ENV['CUCUMBER_FORMAT'] || 'progress'}     features" : "--format #{ENV['CUCUMBER_FORMAT'] || 'pretty'} #{rerun}"
std_opts = "--format #{ENV['CUCUMBER_FORMAT'] || 'pretty'} --strict --tags ~@wip"
%>
default: <%= std_opts %> features
wip: --tags @wip:3 --wip features
rerun: <%= rerun_opts %> --format rerun --out rerun.txt --strict --tags ~@wip 
```

**功能/支持/环境**

```
require 'cucumber/rails'
require 'database_cleaner'
require 'database_cleaner/cucumber'
require 'factory_girl_rails'

Capybara.default_selector = :css
ActionController::Base.allow_rescue = false

begin
  DatabaseCleaner.logger = Rails.logger
  DatabaseCleaner.clean_with(:truncation, :except => %w[regions departements villes positions levels footballtypes genders publicies types])
  DatabaseCleaner.strategy = :truncation, {:except => %w[regions departements villes positions levels footballtypes genders publicies types]}
rescue NameError
  raise "You need to add database_cleaner to your Gemfile (in the :test group) if you wish to use it."
end

Cucumber::Rails::World.use_transactional_fixtures = false
Before('~@no-txn', '~@selenium', '~@culerity', '~@celerity', '~@javascript') do
  DatabaseCleaner.clean_with(:truncation, :except => %w[regions departements villes positions levels footballtypes genders publicies types])
  DatabaseCleaner.strategy = :truncation, {:except => %w[regions departements villes positions levels footballtypes genders publicies types]}
end

Before do
  DatabaseCleaner.strategy = :truncation, {:except => %w[regions departements villes positions levels footballtypes genders publicies types]}
  DatabaseCleaner.clean_with(:truncation, :except => %w[regions departements villes positions levels footballtypes genders publicies types])
  DatabaseCleaner.start
end

After do |scenario|
  DatabaseCleaner.clean_with(:truncation, :except => %w[regions departements villes positions levels footballtypes genders publicies types])
  DatabaseCleaner.strategy = :truncation, {:except => %w[regions departements villes positions levels footballtypes genders publicies types]}
  DatabaseCleaner.clean
end 
```

你有一些线索吗？谢谢，尼尔森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-08T21:39:43.193

这个问题在搜索“数据库清洁黄瓜设置截断种子”时不断出现，所以即使这是一个老问题，我也会添加这个答案。

对我来说，有效的方法是将 ruby​​ 文件添加到 features/support 目录，其中包含以下内容：

`Cucumber::Rails::Database.javascript_strategy = :truncation, {:except => %w[regions departements villes]}`

（我已经用你的表名代替了我的。）你可以将此行添加到 env.rb，但该文件有一个警告，不要编辑。显然，功能/支持目录中的任何 .rb 文件都会在您运行 cucumber 时运行。我的是'setup.rb'。

这会覆盖 Cucumber 的默认设置，该设置在 @javascript 标记场景之后截断整个数据库。

正在使用的版本：黄瓜（1.3.9），黄瓜轨（1.4.0）。

另请参阅[如何让 cucumber 和 databasecleaner 将种子数据留在我的 rails 测试数据库中？](https://stackoverflow.com/questions/4506134/how-do-i-get-cucumber-and-databasecleaner-to-leave-my-seed-data-in-my-rails-test)并尝试

`DatabaseCleaner.strategy = :truncation, {:except => %w[regions departements villes]}`

请参阅文档中的[http://github.com/DatabaseCleaner/database_cleaner#how-to-use](http://github.com/DatabaseCleaner/database_cleaner#how-to-use)。除了重复之外，您似乎已经在这样做了，就像我一样。设置`Cucumber::Rails::Database.javascript_strategy`是修复我在 Selenium 驱动程序上的 javascript 测试的额外调味料。

现在洗，并使其干燥；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T14:05:53.533

您在上面粘贴的代码（env.rb）的第一件麻烦事就是所有的重复。使用 database_cleaner 时，我从来没有这样做过。如果您将文件简化为以下内容会发生什么：

```
require 'cucumber/rails'
require 'database_cleaner'
require 'database_cleaner/cucumber'
require 'factory_girl_rails'

Capybara.default_selector = :css
ActionController::Base.allow_rescue = false
Cucumber::Rails::World.use_transactional_fixtures = false

DatabaseCleaner.logger = Rails.logger
DatabaseCleaner.strategy = :truncation, {:except => %w[regions departements villes positions levels footballtypes genders publicies types]}

Before do
  DatabaseCleaner.start
end

After do |scenario|
  DatabaseCleaner.clean
end 
```

这更接近于我过去所做的以及我所看到的工作。

# javascript - javascript：打开 url 并显示隐藏的 div

> ID：10761985
> 
> 赞同：1
> 
> 时间：2012-05-25T22:19:27.317
> 
> 标签：javascript

我想实现以下目标，并衷心感谢您的帮助。

单击按钮：

1.  在同一窗口上打开目标网址
2.  `.show()`特定于该网址

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:21:58.700

如果您可以控制目标 url，则可以将要显示的 div 的 id 作为查询传递，然后在 onLoad 上获取该 id 并显示它。

```
self.location = "nextPage.html?div=foo";

//nextPage.html

document.onload = function(){
  if(self.location.search.indexOf("div=") == 0){
       document.getElementById(
         self.location.search.substring(4)).style.visibility = "visible";
   }
}

//nextPage.html body...
<div id="foo" style="visibility:hidden"> 
```

如果您无法控制目标网址，那么您无能为力。

哦，欢迎来到堆栈！:) 如果您发现答案有用，请确保对它们进行投票并将其标记为正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T22:30:15.467

如果您只想显示一个 div，您可以尝试使用 href="" onClick="document.getElementById('div').visibility='visible'

# windows - Windows 应用证书工具包调试应用检查错误

> ID：10761986
> 
> 赞同：1
> 
> 时间：2012-05-25T22:19:28.993
> 
> 标签：windows, windows-8, windows-runtime, wack

当我在我的 Metro 应用程序上运行 Windows 应用程序认证工具包时，它通过了除调试应用程序检查之外的所有内容。它给出了以下错误：

```
Failed to extract imported API information for this application 
```

还有其他人收到此错误吗？我试过重建、卸载和重新部署发行版，这样做没有点击运行，所有这些都不会让错误消失。

注意：我在应用程序中使用 Rx Extensions beta 库，它使用可移植库项目。就导致此问题的原因而言，这是我的最佳猜测。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:51:30.437

App Cert Kit 接受最新的 RX（非便携式）预构建 2.0.20612-rc 就好了！

然而，BCL 团队注意到便携式库上的证书错误：“这是工具的 RC 版本中的一个错误，将被修复以启用对 Windows 8 RTM 的便携式类库的全面支持。” [http://blogs.msdn.com/b/bclteam/archive/2012/06/18/portable-libraries-and-the-windows-app-certification-kit-rc.aspx](http://blogs.msdn.com/b/bclteam/archive/2012/06/18/portable-libraries-and-the-windows-app-certification-kit-rc.aspx)

有趣的是，我们解决方案中的一些可移植库确实通过了认证。看起来它取决于库中使用的一组类。

我们不得不将代码从失败的可移植类库移动到 Metro 类库以通过 Cert Kit 检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T02:21:28.423

是的，我收到了 Rx 的这个错误。 ~~据我了解，当前的 Rx 版本不会通过 WACK。~~（编辑：[Rx 的 RC 版本](http://blogs.msdn.com/b/rxteam/archive/2012/06/20/reactive-extensions-v2-0-release-candidate-available-now.aspx)似乎支持 Metro 风格的应用程序）

一般来说，一旦 WACK 完成运行，您可以在……中找到有关故障的详细调试信息。</p>

%USERPROFILE%\AppData\Local\Microsoft\AppCertKit

我相信每次运行都会覆盖它们，所以要小心。在您的情况下，文件 post_process_trace_DebugAppCheck_*.txt 将为您提供有关 WACK 认为您的程序集处于调试版本的原因的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T22:17:33.217

Basically, the issue is with portable class libraries. WACK cannot load System.Core version 2.0.5.0 which is referenced in most portable libraries.

Solution is to use Metro class library, until WACK is fixed.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T18:57:09.410

一旦我引用了便携式库，我也会得到一个 FAIL

# python - 如何检测 Python 类中重复的方法名称？

> ID：10761988
> 
> 赞同：23
> 
> 时间：2012-05-25T22:20:05.317
> 
> 标签：python

在编写单元测试时，我有时会剪切和粘贴测试并且不记得更改方法名称。这会导致覆盖之前的测试，有效地隐藏它并阻止它运行。例如;

```
class WidgetTestCase(unittest.TestCase):

  def test_foo_should_do_some_behavior(self):
    self.assertEquals(42, self.widget.foo())

  def test_foo_should_do_some_behavior(self):
    self.widget.bar()
    self.assertEquals(314, self.widget.foo()) 
```

在这种情况下，只有后一个测试会被调用。有没有办法以编程方式捕获这种错误，而不是直接解析原始源代码？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-25T22:25:11.213

如果您在代码上运行[pylint](http://www.logilab.org/857)，它会在您覆盖另一个方法时通知您：

例如，我运行了这个：

```
class A(object):
    def blah(self):
        print("Hello, World!")

    def blah(self):
        print("I give up!") 
```

在[这个在线 pylint 检查器](http://antares.sip.ucm.es/cesar/pylint/)中。除了所有缺少的文档字符串等，我得到了这个：

```
E: 5:A.blah: method already defined line 2 
```

或者，通过命令行：

```
$ python -m pyflakes .
.\blah.py:5:5 redefinition of unused 'blah' from line 2 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-26T01:23:53.343

接下来是一个可怕的 hack，它使用了未记录的、特定于实现的 Python 特性。你永远不应该*做*这样的事情。

它已经在 Python 2.6.1 和 2.7.2 上进行了测试；似乎不适用于编写的 Python 3.2，但是无论如何，您都可以在 Python 3.x 中[正确执行此操作。](https://stackoverflow.com/questions/10762088/python-metaclasses-why-isnt-setattr-called-for-attributes-set-during-class/10763270#10763270)

```
import sys

class NoDupNames(object):

    def __init__(self):
        self.namespaces = []

    def __call__(self, frame, event, arg):
        if event == "call":
            if frame.f_code.co_flags == 66:
                self.namespaces.append({})
        elif event in ("line", "return") and self.namespaces:
            for key in frame.f_locals.iterkeys():
                if key in self.namespaces[-1]:
                    raise NameError("attribute '%s' already declared" % key) 
            self.namespaces[-1].update(frame.f_locals)
            frame.f_locals.clear()
            if event == "return":
                frame.f_locals.update(self.namespaces.pop())
        return self

    def __enter__(self):
        self.oldtrace = sys.gettrace()
        sys.settrace(self)

    def __exit__(self, type, value, traceback):
        sys.settrace(self.oldtrace) 
```

用法：

```
with NoDupNames():
    class Foo(object):
        num = None
        num = 42 
```

结果：

```
NameError: attribute 'num' already declared 
```

它是如何工作的：我们连接到系统跟踪钩子。每次 Python 即将执行一行时，我们都会被调用。这使我们可以看到*最后*执行的语句定义了哪些名称。为了确保我们可以捕获重复项，我们实际上维护了自己的局部变量字典并在每行之后*清除*Python 的。在类定义的最后，我们将本地变量复制回 Python 中。其他一些愚蠢的东西在那里处理嵌套类定义并在单个语句中处理多个分配。

不利的一面是，我们的“清除所有当地人！” 方法意味着你不能这样做：

```
with NoDupNames():
    class Foo(object):
        a = 6
        b = 7
        c = a * b 
```

因为据 Python 所知，没有名称`a`和`b`执行时间`c = a * b`；我们一看到它们就清除了它们。此外，如果您*在一行中*两次分配相同的变量（例如，`a = 0; a = 1`），它不会捕捉到这一点。但是，它适用于更典型的类定义。

此外，除了类定义之外，您不应将任何内容放在`NoDupNames`上下文中。我不知道会发生什么；也许没什么不好。但我还没有尝试过，所以理论上宇宙可以被吸入它自己的塞孔。

这很可能是我写过的最邪恶的代码，但它确实很有趣！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-25T22:36:50.240

以下是如何在运行时使用装饰器检测这一点而无需任何分析工具的一种选择：

```
def one_def_only():
  names = set()
  def assert_first_def(func):
    assert func.__name__ not in names, func.__name__ + ' defined twice'
    names.add(func.__name__)
    return func
  return assert_first_def

class WidgetTestCase(unittest.TestCase):
  assert_first_def = one_def_only()

  @assert_first_def
  def test_foo_should_do_some_behavior(self):
    self.assertEquals(42, self.widget.foo())

  @assert_first_def
  def test_foo_should_do_some_behavior(self):
    self.widget.bar()
    self.assertEquals(314, self.widget.foo()) 
```

尝试导入或运行的示例：

```
>>> import testcases
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "testcases.py", line 13, in <module>
    class WidgetTestCase(unittest.TestCase):
  File "testcases.py", line 20, in WidgetTestCase
    @assert_first_def
  File "testcases.py", line 7, in assert_first_def
    assert func.__name__ not in names, func.__name__ + ' defined twice'
AssertionError: test_foo_should_do_some_behavior defined twice 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-25T22:24:57.753

您不能在运行时轻松/干净地检测到它，因为旧方法被简单地替换并且必须在每个函数定义上使用装饰器。静态分析（Pylint 等）是最好的方法。

我刚刚对其进行了测试，并且`__setattr__`没有为类块中定义的内容调用元类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-03T18:47:01.880

##### 通过 CI/CD 解决方案

如果您有一个构建（例如 Jenkins CI/CD），一旦提出拉取请求就会运行测试，您可以添加类似 `pylint --fail-under=7 --fail-on=`[`E0102`](http://pylint.pycqa.org/en/latest/technical_reference/features.html?highlight=E0102#basic-checker-messages) `paths_of_files_changed`

这意味着如果`Function defined already`[`E0102`](http://pylint.pycqa.org/en/latest/technical_reference/features.html?highlight=E0102#basic-checker-messages) OR 代码的质量小于`7`返回非零退出代码。

然后可以使用它来使构建失败。

##### [通过预提交的](https://pre-commit.com/#creating-new-hooks)客户端解决方案

或者，您可能有兴趣将其与 git pre commit 挂钩集成，通过该挂钩将允许您在提交时执行特定命令，如果它们失败，则不允许您提交。

在结帐的根目录中创建一个名为`.pre-commit-config.yaml` With 以下的文件

```
# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks
repos:
-   repo: https://github.com/PyCQA/pylint
    rev: v2.9.6
    hooks:
    -   id: pylint
        args: [--fail-under=7, --fail-on=E0102] 
```

###### 安装预提交

（首选方法是）使用[pipx](https://pypa.github.io/pipx/)或在虚拟环境之外执行此操作，因为它是 CLI 应用程序

```
python3 -m pip install pre-commit 
```

###### 安装挂钩

```
pre-commit install # you only do this once per "git clone" 
```

在所有函数只定义一次之前，您无法提交。这两种解决方案都将阻止任何被多次定义的方法提交到代码库中。

# javascript - 使用 OpenLayers 加载 GeoServer WMS 保护层

> ID：10761991
> 
> 赞同：0
> 
> 时间：2012-05-25T22:20:20.107
> 
> 标签：javascript, openlayers, geoserver

我正在尝试从 GeoServer 加载安全的 WMS 图层，但在地图中加载图层时似乎无法发送凭据。

这是我的代码：

```
var ciudades = new OpenLayers.Layer.WMS("WMS.Secured",
"https://admin:geoserver@localhost:1979/geoserver/wms?LAYERS=world:PYCIUDADES&SERVICE=WMS", {
    layers: "PYCIUDADES"
}, {
    buffer: 0,
    visibility: true
}
); 
```

但我得到一个 javascript 异常说“安全问题”我正在使用 asp.net

提前致谢

# scala - 为什么部分应用函数会延迟 Scala 中的类实例化？

> ID：10761994
> 
> 赞同：6
> 
> 时间：2012-05-25T22:20:59.407
> 
> 标签：scala

想象一下这段代码：

```
class Foo {
  println("in Foo")

  def foo(a: Int) = a + 1
} 
```

现在，如果我们调用：

```
new Foo().foo _ 
```

Foo 类的实例将按预期创建：

```
in Foo
res0: (Int) => Int = <function1> 
```

但是，如果我们调用它：

```
new Foo().foo(_) 
```

Foo 的构造函数不会被调用：

```
res1: (Int) => Int = <function1> 
```

如果我们接着说：

```
res1(7) 
```

那是 Foo 被实例化的时候：

```
in Foo
res2: Int = 8 
```

为什么 Eta 扩展与部分函数应用程序在类实例化方面有所不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:14:08.283

男孩，这是一个微妙的，但据我所知，它完全遵循[Scala 规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)。我将引用规范的 2.9 版。

对于您的第一个示例：正如您正确地说的那样，您通过方法值的特殊情况（第 6.7 节）看到 eta 扩展：

`The expression e _ is well-formed if e is of method type or if e is a call-by-name parameter. If e is a method with parameters, e _ represents e converted to a function type by eta expansion.`

eta 扩展的算法在 §6.26.5 中给出，您可以按照它对表达式进行以下替换`new Foo().x1 _`：

```
{
  val x1 = new Foo();
  (y1: Int) => x1.(y1);
} 
```

这意味着当使用 eta 扩展时，所有子表达式都在转换发生的点进行评估（如果我正确理解了短语“最大子表达式”的含义）并且最终表达式是创建一个匿名函数。

在您的第二个示例中，那些额外的括号意味着编译器将查看 §6.23（特别是“匿名函数的占位符语法”）并直接创建一个匿名函数。

`An expression (of syntactic category Expr) may contain embedded underscore symbols _ at places where identifiers are legal. Such an expression represents an anonymous function where subsequent occurrences of underscores denote successive parameters.`

在这种情况下，按照该部分中的算法，您的表达式最终会变成这样：

```
(x1: Int) => new Foo().foo(x1) 
```

差异是微妙的，正如@Antoras 很好解释的那样，实际上只有在存在副作用代码的情况下才会显示出来。

[请注意，对于涉及按名称调用代码块的案例（例如，请参阅此问题](https://stackoverflow.com/q/4918362/991432)、[此错误](https://issues.scala-lang.org/browse/SI-302)和[此错误](https://issues.scala-lang.org/browse/SI-5610)），正在进行错误修复。

**后记**：在这两种情况下，匿名函数`(x1:Int) => toto`都被扩展为

```
new scala.Function1[Int, Int] {
  def apply(x1: Int): Int = toto
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T22:51:21.980

我不完全确定，但我认为存在差异的原因是 Scala 不是一种纯粹的函数式编程语言 - 它允许副作用：

```
scala> class Adder { var i = 0; def foo(a:Int)={i+=1;println(i);a+1} }
defined class Adder

scala> val curriedFunction = new Adder().foo _
curriedFunction: (Int) => Int = <function1>

scala> val anonymousFunction = new Adder().foo(_)
anonymousFunction: (Int) => Int = <function1>    

scala> curriedFunction(5)
1
res11: Int = 6

scala> curriedFunction(5)
2
res12: Int = 6

scala> anonymousFunction(5)
1
res13: Int = 6

scala> anonymousFunction(5)
1
res14: Int = 6 
```

匿名函数被视为：

```
val anonymousFunction = x => new Adder().foo(x) 
```

而咖喱函数被视为：

```
val curriedFunction = {
  val context = new Adder()
  (a:Int) => context foo a
} 
```

柯里化函数符合用函数式语言处理柯里化函数的传统方式：柯里化函数是应用于某些数据并评估该部分应用函数的函数。换句话说：根据一些数据创建一个上下文，该上下文被存储并可以在以后使用。这正是`curriedFunction`正在做的事情。因为 Scala 允许可变状态，所以可以更改上下文 - 如问题中所见，这一事实可能导致意外行为。

像 Haskell 这样的纯函数式语言没有这个问题，因为它们不允许这样的副作用。在 Scala 中，必须自己确保由 curried 函数创建的上下文是真正纯的。如果不是这种情况，并且需要纯 curried 函数的行为，则必须使用匿名函数，因为它们不存储上下文（如果上下文的创建代价高昂并且必须经常进行，这可能会出现问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T22:50:27.707

因为它扩展到

```
(x: Int) => new Foo().foo(x) 
```

因此，您只是`Foo`在调用该函数时创建该实例。

第一个立即实例化 Foo 的原因是因为它扩展为

```
private[this] val c: (Int) => Int = {
  <synthetic> val eta$0$1: Foo = new Foo();
  ((a: Int) => eta$0$1.foo(a))
};
<stable> <accessor> def c: (Int) => Int = Foo.this.c; 
```

并且`Foo`一旦定义 c 就会在此处实例化。