# StackOverflow 问答 000559000-000559999

# php - 使用 PHP 管理本地 SVN 文件结构

> ID：559004
> 
> 赞同：1
> 
> 时间：2009-02-17T22:27:12.337
> 
> 标签：php, svn, filesystems

我有一个使用 php 修改本地文件系统的开发人员工具。这些项目通常从 SVN 中签出。我想避免的问题是版本控制目录的移动/删除/重命名 - 以及在本地进行这些更改时检出的 SVN 发生的损坏。

当我还执行匹配的文件系统操作时，是否有一种简单的方法来应用 SVN 命令（移动添加、删除、重命名等）？

或者如果在移动/重命名目标中找到 .svn 目录更容易删除？

为了澄清这一点：

已签出的 svn，其结构为：

somedir/
--foo/
--cheese/

用户 1 更改此文件系统结构（使用开发工具），将 'foo' 目录（受版本控制）重命名为 'modified'，当他们提交更改时，svn 将由于名称更改而不是错误通过 SVN 命令完成。

这可以在各种开发服务器上运行（通常是在 win 或 mac 上运行 apache 的台式机）

不想忽略或断开与 svn 的连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T22:39:38.923

以编程方式，您最好只删除 .svn 文件夹。它可能只是一两行代码。

另一件事要尝试，为什么不导出模块？这样你就不会得到 .svn 文件夹。

另请注意，您可以编写所有 svn 命令并运行它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T00:16:29.563

在您的 PHP 文件中，您可以`svn`通过以下方式使用命令`exec()`

```
<?php
$Output = '';
$ExitCode = 0;
exec('svn mv "'.$Current.'" "'.$New.'"', $Output, $ExitCode); 
```

`$Output`是命令的输出，如果命令成功`$ExitCode`将是。`0`

但是请记住，出于安全原因，该`exec()`命令可能在某些系统上被禁用。如果您可以控制您的`php.ini`文件，您可以选择启用/禁用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T00:09:49.347

如果我理解正确，您在另一个（主）中有一个版本控制目录（从）。为什么不将从目录添加到主 svn 忽略列表？

```
svn propset svn:ignore slave .
svn ci . -m 'Added ignore dir' 
```

从现在开始，在主目录中运行 svn up/add/delete 不会弄乱从属 svn，而后者仍保持完整功能。

# applescript - Applescript、多显示器和最大窗口大小

> ID：559009
> 
> 赞同：3
> 
> 时间：2009-02-17T22:28:15.300
> 
> 标签：applescript, multiple-monitors

我正在研究 OS X 上的 Windows 管理（试图实现 WinSplit Revolution 之类的东西），我需要使用 applescript 来拉出给定监视器上窗口的最大尺寸。目前我发现：

```
tell application "Safari"
    set screen_width to (do JavaScript "screen.availWidth" in document 1)
    set screen_height to (do JavaScript "screen.availHeight" in document 1)
end tell 
```

这适用于多显示器设置上的主显示器，但根本不提供辅助显示器。我还阅读了[此处](http://daringfireball.net/2006/12/display_size_applescript_the_lazy_way)详述的方法，这显然不适用于有效的多显示器。有没有一种有效的方法可以使用 applescript 获得多个显示器的最大窗口大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T19:09:41.047

已经有很多尝试通过读取系统 plist 文件来获取显示器尺寸。见[http://macscripter.net/viewtopic.php?id=15425](http://macscripter.net/viewtopic.php?id=15425)

如果您有权访问 AppleScript Studio (ASS) 条款，则可以对 NSScreen 进行方法调用以获取所有监视器，然后询问它们的大小。在纯 AppleScript 中使用 ASS 术语的最简单方法是在 Xcode 中编译一个空的 ASS 应用程序。在这个例子中，我创建了一个简单的 ASS 应用程序名称 ASSAccess，它可以让我访问 ASS 术语：

```
tell application "ASSAccess"
    -- The first item in this list will be your main monitor
    set screensArray to call method "screens" of class "NSScreen"

    set Displays to {}
    if {} is not screensArray then
        repeat with displayNo from 1 to (count screensArray)
                    -- call visibleFrame instead to take into account the Dock and menubar
            set dims to call method "frame" of (item displayNo of screensArray)
            copy dims to end of Displays
        end repeat
    end if
end tell 
```

现在，我在这些维度上遇到的问题是坐标系。NSScreen 的 frame 方法为您提供了一个矩形，其原点位于主监视器的左下角。然后，相对于该原点给出任何辅助屏幕。如果您试图确定窗口是否在这些范围内，则窗口位置在坐标系内给出，原点位于左上角。这是我还没有弄清楚的一大堆转换。

# .net - 如何通过一台受信任的服务器路由 AMF 请求

> ID：559013
> 
> 赞同：0
> 
> 时间：2009-02-17T22:28:57.683
> 
> 标签：.net, apache-flex, remoting, amf

我们计划开发一个 Flex 应用程序，该应用程序必须进行 AMF 调用才能从安全服务器检索数据。但是，我们不允许使用 AMF 直接连接到该安全服务器。我们只能对安全服务器进行 WSDL/SOAP 或 .net 远程调用。因此，**在客户端机器上运行的 flex 应用程序的所有实例都必须连接到单个受信任的服务器，然后该服务器将连接到安全服务器。**

这些要求是基于公司内部的政治原因，并不灵活（不是总是这样吗？）

如果要求不清楚，这里是一个例子。当您通过银行网站访问您的支票账户时，该网站会下载一个 flex/flash 应用程序到您的网络浏览器。此应用程序向您显示您的帐户、交易、余额等。但是，您的实际支票帐户详细信息存储在银行的安全数据库服务器上，该服务器不接受来自客户的入站连接。因此，浏览器中的 flex 应用程序对银行网站进行 AMF 调用，然后转而对数据库服务器进行 WSDL/SOAP 或 .net 远程调用。它获取数据并通过 AMF 将其发送回您的浏览器。

**是否有我们可以在 Web 服务器上运行的“代理”应用程序，它将接受 AMF 调用并转身对安全服务器进行 WSDL/SOAP 或 .net 远程调用？还是我们必须手写？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T04:22:38.363

我将使用自定义 java 类（使用 JavaAdapter）使 BlazeDS 服务器成为代理。然后，您的 java 类将作为您的主服务器的外观。

这种设置的优势在于，blazeDS 代理服务器将负责 AMF 请求和响应的所有序列化/反序列化。然后你就拥有了 java 的全部功能来调用你的主服务器来使用 RMI、SOAP、HTTP 等。这样主服务器就不需要知道任何关于 AMF 的信息。

其他选择；1\. AMF 在基本的 http 请求中仍然作为二进制数据传递。所以一个简单的 HTTP 代理应该正确地转发请求。但是，如果您这样做，最终服务器将需要知道如何处理 AMF 协议。

2.  代替 AMF，使用 mx:HTTPService 标记并标记 useProxy="true"。这将通过 blazeDS 服务器代理所有 http (json, rest) 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-26T04:34:35.043

如果您碰巧在您的 Web 服务器中使用 asp.net，您可以使用[FlourineFx](http://www.fluorinefx.com/)（开源）或[WebOrb](http://www.themidnightcoders.com/)（商业）作为您的服务器。

这两个选项都可以托管在 IIS 中或充当 Windows 服务。

然后，您可以只删除 dotnet 类库以连接到服务器的 bin 目录中的安全服务器。

# actionscript-3 - 最好的 Actionscript3 3D 引擎是什么？

> ID：559014
> 
> 赞同：6
> 
> 时间：2009-02-17T22:29:27.777
> 
> 标签：actionscript-3, papervision3d, away3d

我正在寻找关于 Actionscript3 的 3D 引擎是最高效、实用、可扩展、文档化、社区支持等的详细解释。当我第一次对 flash 和 actionscript3 的 3D 世界感兴趣时，我只知道 papervision3D . 以我好奇的方式，我去阅读 papervision3D 并且对缺乏教程感到震惊。后来我开始研究Away3D，发现他们的站点很容易遍历，教程很多，文档也很容易找到。

有什么我想念的吗？papervision3D 是否好到不需要教程和其他媒介来帮助用户采用它并开始更频繁地使用它？它是否具有允许这样做的性能提升？您建议使用哪种 3D 引擎？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T09:43:59.463

几个月前我遇到了同样的问题。最后，我选择了 Sandy3d。对我而言，**高质量**文档的数量和真正支持我的社区确实帮助我启动并运行了我的项目。

[http://www.flashsandy.org/blog/](http://www.flashsandy.org/blog/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-24T22:52:46.240

我会选择 Away3D，如果只是因为我们知道他们与 Adob​​e 密切合作，以确保人们对其产品的现有知识尽可能容易地转化为即将推出的 Molehill 版本。如果您还不知道，Flash Player 11 将有一个 API 用于在 Flash 中使用 OpenGL 和/或 DirectX 3D。对于那些希望在 Flash 中制作 3D 游戏和 UI 的人来说，这将是巨大的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T21:52:45.347

Papervision3D 正在经历完全重写的过程，以利用 CS4 的新 3D 功能。听起来他们也在考虑将炼金术混合到引擎中以获得真正的巨大提升。[您可以在此处](http://blog.papervision3d.org/2009/03/16/papervisionx-what-it-is-and-what-it-isnt/)更详细地查看它。

我发现 PV3D 的 irc 频道相当活跃，他们已经能够回答我由于过时的教程或笨拙记录的代码部分而提出的任何问题。

我还没有声誉评论，所以为了回应 David Hanak 上面关于视口层的评论，它们的最佳用途（我发现）是帮助进行深度排序。您可以将对象分配给视口层并为该层指定索引。然后告诉渲染器按索引对视口层进行排序。它*确实*有助于减少视觉显示错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T09:37:40.137

AFAIK，Away3D 是 Papervision3D 的一个分支。您可能会对它们的功能[比较](http://drawlogic.com/2007/07/17/comparison-of-papervision3d-and-away3d-by-mr-doob/)感兴趣。在我看来 PV3D 速度更快，尽管这个博客条目可能已经过时了。

我想知道的是哪个库将是第一个支持 Flash 10 的 3D 相关功能的库。这在性能上意味着很多......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T09:55:04.320

问题是，papervision 有一个很好的社区。在长期使用中，您应该考虑到这一点。

我一开始也是这样。在哪里可以找到什么并不明显。但你应该坚持下去。我刚刚制作了一个原型：Papervision3d + Jiglib（Flash 的 3d 物理，从 c++ 移植）和 SmartFox Server = 有趣的多人游戏：D

无论如何：这可能会有所帮助： http: [//papervision2.com/tutorial-list/](http://papervision2.com/tutorial-list/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-01T23:21:40.780

最好的确实是[Alternativa3D](http://alternativaplatform.com/en/alternativa3d/)，但您必须为此付费。它是目前唯一支持 FP10 功能的，因为我们仍在等待 PapervisionX

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T10:30:11.130

就个人而言，我更喜欢 Away；尽管它最初是作为 Papervision 的分支开始的，但从那时起它们已经分道扬镳了。大多数时候我开始一个新的 3D 项目，我首先评估两者（项目之间经过的时间通常让两个引擎都有时间经历一些相当大的变化），我总是最终回到 Away - 在我看来，渲染质量要好一些，而且“Just Get Stuff Done with Away”似乎更容易。我从来没有用过桑迪，所以我不能说。

我从来没有遇到过从 Away 社区获得支持的问题——虽然 PV 可能更大，但 Away 肯定不缺少乐于助人的人。

以我的经验，PV 往往会更快地积累高超的功能——它可能是更前沿且技术上令人印象深刻的引擎——但 Away 往往更稳定，有更好的 API 并且更容易破解；）

这都是我自己的意见，YMMV。两者都有自己的长处和短处。我能做出的最好建议是评估两者，看看哪个最适合你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-14T23:06:32.637

我使用过 Papervision、Away3D、Alternativa 和 Sandy 3D（您可以[在此处](http://www.brighthub.com/hubfolio/matthew-casperson/blog/archive/2009/08/23/tutorial-index.aspx)找到每个教程）。我个人更喜欢 Away3D - 它是免费的并且具有更多功能，如果您只想要基础知识，还可以使用 Lite 版本。我特别期待 Haxe 版本，它可能只是让您使用 hxcpp 在 C++ 中编译独立的可执行文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-21T08:23:25.857

Flash 中的 3D 选项归结为[Papervision3d](http://papervision3d.org/)、[Away3D](http://away3d.com/)或[Sandy 3d Engine](http://code.google.com/p/sandy/)。我发现前两个在成熟度、文档和性能方面是最好的。

如果您有兴趣，在[我公司的博客上](http://blog.cycle-it.com/)有[一系列比较 Flash 的 3D 引擎的帖子](http://blog.cycle-it.com/category/3d/)（西班牙语，尽管您可以按照示例阅读英文源代码）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-12-18T20:06:28.030

Away3D 是当前的免费冠军。

它正在积极开发中，并支持 Flash Player 11、Stage3D 等。

在不久的将来，我还将开始研究 Blender3D 的游戏引擎。它不是 Flash，但它是免费的，而且相当容易编程。它背后的语言是Python。

# c++ - 编译器编程：最基本的成分是什么？

> ID：559025
> 
> 赞同：6
> 
> 时间：2009-02-17T22:31:24.980
> 
> 标签：c++, c, compiler-construction, low-level

我有兴趣编写一个非常简约的编译器。

我想编写一个满足以下条件的小软件（在 C/C++ 中）：

*   以 ELF 格式输出 (*nix)
*   输入是单个文本文件
*   类 C 语法和句法
*   没有链接器
*   没有预处理器
*   非常小（最多 1-2 KLOC）

语言特点：

*   本机数据类型：char、int 和 floats
*   数组（适用于所有本机数据类型）
*   变量
*   控制结构（if-else）
*   职能
*   循环（会很好）
*   简单代数（div、add、sub、mul、布尔表达式、位移等）
*   内联汇编（用于系统调用）

谁能告诉我如何开始？我不知道编译器由哪些部分组成（至少在我可以立即开始的意义上）以及如何对它们进行编程。谢谢你的想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T00:28:28.957

对于您希望完成的所有工作，最具挑战性的要求可能是“非常小（最多 1-2 KLOC）”。我认为仅您的第一个要求（生成 ELF 输出）本身就可能需要超过一千行代码。

至少在开始时，简化问题的一种方法是生成汇编语言文本中的代码，然后将其输入现有的汇编程序（[nasm](http://www.nasm.us/)将是一个不错的选择）。汇编器将负责生成实际的机器代码，以及构建实际可运行的可执行文件所需的所有 ELF 特定代码。然后你的工作就变成了语言解析和汇编代码生成。当您的项目成熟到要删除对汇编程序的依赖时，您可以自己重写这部分并随时插入。

如果我是你，我可能会从一个汇编器开始，然后在它之上构建部件。最简单的“编译器”可能会采用一种只有一些非常简单的可能语句的语言：

```
print "hello"
a = 5
print a 
```

并将其翻译成汇编语言。一旦你开始工作，你就可以构建一个词法分析器和解析器以及抽象语法树和代码生成器，这是现代块结构语言所需的大部分部分。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T23:00:28.497

首先，您需要决定是要制作编译器还是解释器。编译器将您的代码翻译成可以直接在硬件上、在解释器中运行的东西，或者被编译成另一种语言，然后以某种方式被解释。两种类型的语言都是图灵完备的，因此它们具有相同的表达能力。我建议您创建一个编译器，将您的代码编译为 .net 或 Java 字节码，因为它为您提供了一个非常优化的解释器来运行以及许多标准库。

一旦你做出决定，有一些常见的步骤可以遵循

1.  **语言定义**首先，您必须定义您的语言在语法上的外观。

2.  **Lexer**第二步是创建代码的关键字，称为标记。在这里，我们谈论的是非常基本的元素，例如数字、加法符号和字符串。

3.  **解析**下一步是创建一个与您的标记列表匹配的语法。您可以使用例如上下文无关语法来定义您的语法。许多工具可以使用其中一种语法并为您创建解析器。通常，已解析的标记被组织成一棵解析树。解析树是将语法表示为可以在其中移动的数据结构。

4.  **编译或解释**最后一步是在分析树上运行一些逻辑。制作自己的解释器的一种简单方法是创建一些与树中的每个节点类型相关联的逻辑，然后自下而上或自上而下地遍历树。如果你想编译成另一种语言，你可以在节点中插入如何翻译代码的逻辑。

维基百科非常适合了解更多信息，您可能想从[这里](http://en.wikipedia.org/wiki/Lexing)开始。

关于现实世界的阅读材料，我建议 David A Watt 和 Deryck F Brown 撰写的“Java 编程语言处理器”。我在我的编译器课程中使用了那本书，并且通过示例学习在这个领域非常棒。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T22:43:03.797

这些是绝对必要的部分：

*   扫描仪：这会将输入文件分解为标记
*   解析器：这会根据扫描仪识别的标记构造抽象语法树 (AST)。
*   代码生成：这会产生来自 AST 的输出。

您可能还想要：

*   错误处理：这告诉解析器如果遇到意外令牌该怎么办
*   优化：这将使编译器能够生成更高效的机器代码

编辑：你已经设计了语言吗？如果没有，您也需要研究语言设计。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T22:56:50.627

最重要的是一本关于编译器编写的书。很多人会告诉你阅读 Aho 等人的“Dragon Book”，但我读过的关于编译器的最好的书是“Brinch Hansen on Pascal Compilers”。我怀疑它已经绝版了（亚马逊是你的朋友），但它会带你完成使用递归下降设计和编写编译器的所有步骤，这是编译器新手最容易理解的方法。

尽管本书使用 Pascal 作为实现和目标语言，但所介绍的课程和技术同样适用于所有其他语言。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T23:00:19.777

我不知道你希望从中得到什么，但如果它正在学习，并且查看现有代码对你有用，那么总会有[tcc](http://bellard.org/tcc/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T23:02:54.747

这些示例都在 Perl 中，但是[Exploring Programming Language Architecture in Perl](http://www.billhails.net/Book/)是一本好书（而且免费）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T01:50:58.633

恕我直言，一组非常好的免费参考资料是：

总体编译器教程：Jack Crenshaw 的 Let's Build a Compiler ( [http://compilers.iecc.com/crenshaw/](http://compilers.iecc.com/crenshaw/) ) 有点啰嗦，但我喜欢。

汇编程序：NASM ( [nasm.us](http://www.nasm.us/) ) 适用于 Linux 和 Windows/DOS，最重要的是大量文档和示例/教程。（[FASM](http://www.flatassembler.net)也不错，但文档/教程较少）

其他来源 PC 组装书 ( [http://www.drpaulcarter.com/pcasm/index.php](http://www.drpaulcarter.com/pcasm/index.php) )

我正在尝试编写 LISP，所以我使用的是[Lisp 1.5 Manual](http://www.softwarepreservation.org/projects/LISP/book/LISP%201.5%20Programmers%20Manual.pdf)。您可能想要获取您正在编写的任何语言的语言规范。

至于 1-2KLOC，假设您使用高级语言（如 Py 或 Rb），如果您不太雄心勃勃，您应该接近。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-20T01:18:19.943

作为初学者，我总是推荐[flex](https://github.com/westes/flex/)和[bison](http://www.gnu.org/software/bison/)来完成这种工作。您以后可以随时了解编写自己的扫描仪和解析器的细节，尽管它们可能会增加代码大小，至少它们将由工具为您生成。:)

# .net - 找不到 Microsoft.VisualStudio.TextTemplating 程序集

> ID：559027
> 
> 赞同：33
> 
> 时间：2009-02-17T22:31:49.190
> 
> 标签：.net, visual-studio, t4

我正在使用 T4（文本模板转换工具包）做一些工作，并试图达到可以创建自己的自定义文本模板主机的地步。但是，所有这些都依赖于**Microsoft.VisualStudio.TextTemplating**程序集，我在我的系统上找不到它！

我首先尝试在 Visual Studio 中添加对程序集的引用，但**Microsoft.VisualStudio.TextTemplating**的程序集未在 .NET 选项卡下列出。

然后，我查看了*%WINDIR%/Assembly*目录，找到了**Microsoft.VisualStudio.TextTemplating**的条目。但是，当我尝试浏览到此位置并在 Visual Studio 中添加程序集时，没有任何反应。

其他人有这个问题吗？根据 MSDN tuts，听起来这个程序集应该包含在 Visual Studio 中（我安装了 VS 2003、2005 和 2008）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-18T11:25:39.470

我安装了 Visual Studio SDK。这是该程序集物理安装在我的系统上的位置：

> C:\Program Files\Microsoft Visual Studio 2008 SDK\VisualStudioIntegration\Common\Assemblies\Microsoft.VisualStudio.TextTemplating.dll。

它确实会正常显示在“添加引用”对话框中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-14T13:54:06.753

**Visual Studio 2012** SDK 文件夹是：

`C:\Program Files (x86)\Microsoft Visual Studio 11.0\VSSDK\VisualStudioIntegration\Common\Assemblies\v4.0`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-13T15:06:34.637

在（新）GAC 中：

VS 2012 (v11.0)

```
C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Microsoft.VisualStudio.TextTemplating.11.0\v4.0_11.0.0.0__b03f5f7f11d50a3a 
```

VS 2013 (v12.0)

```
C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Microsoft.VisualStudio.TextTemplating.12.0\v4.0_12.0.0.0__b03f5f7f11d50a3a 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-02T08:52:24.160

[这些](https://www.nuget.org/packages/Microsoft.VisualStudio.TextTemplating.14.0)程序集作为 NuGet 包已经有一段时间了。

这允许通过 NuGet 进行更好的依赖管理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-14T10:47:41.103

**Visual Studio 2015**文件夹

C:\Program Files (x86)\Microsoft Visual Studio 14.0\VSSDK\VisualStudioIntegration\Common\Assemblies\v4.0

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T14:45:09.173

我已经安装了 Visual Studio 2008（没有 SDK）并且`Microsoft.VisualStudio.TextTemplating.dll`在我的机器上的以下位置：

`C:\Program Files\Common Files\Microsoft Shared\TextTemplating\1.1`

# visual-studio - Visual Studio 2003 的重构插件

> ID：559042
> 
> 赞同：2
> 
> 时间：2009-02-17T22:36:59.927
> 
> 标签：visual-studio, plugins, refactoring, visual-studio-2003

是否有适用于 Visual Studio 2003 的免费重构工具？ [ReSharper](http://www.jetbrains.com/resharper20/download/index.html)似乎需要许可证密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T20:08:11.410

我在一条类似的船上。继承了与旧的第三方组件相关联的 .NET 1.1 项目。我正在迁移它的标准 WinForm 组件，以便将其移至 2005 或 2008。

可悲的是没有。VS 2005+ 有免费的重构工具，但 2003 没有。

*   DevExpress 提供重构！专业版 99 美元，支持 2003 年。
*   ModelMaker Tools 提供 CodeExplorer，价格也为 99 美元。支持 2003 年。
*   您已经发现了最受欢迎的 ReSharper。

曾经还有一些其他的，但这些是唯一剩下的。

如果你想试验，你可以试试 SharpDevelop。它是一个开源的 .net IDE，内置了很多重构支持。版本 3 已放弃对 .NET 1.1 的支持，但它们仍然提供版本 1 和 2 以供下载。我自己用过。如果你小心，你可以设置双 IDE。SharpDevelop 用于重构和一般开发，VS2003 用于 SharpDevelop 无法处理的任何事情。

**更新：** SharpDevelop 在旧版本中的重构支持非常不成熟，它只支持函数重命名。最新版本放弃了对 .NET 1.1 的支持，它进行了许多有用的重构。

# tcl - BWidget 和 Tile (ttk)

> ID：559043
> 
> 赞同：0
> 
> 时间：2009-02-17T22:37:03.047
> 
> 标签：tcl, tk, tile, bwidget

是否有任何 tcl'ers 知道 BWidget 的（可能）转换以使用较新的 Tile (ttk) 主题小部件时发生了什么。我知道在 BWidget 1.8 中已经完成了**一些**工作（毕竟它确实有 Widget::theme 命令），但是如果我尝试“强制”BWidget 使用主题小部件，即使是最简单的脚本也会失败......

```
> tclsh85
% package require Tk
8.5.2
% package require tile
0.8.2
% namespace import -force ttk::*
% package require BWidget
1.8
% Widget::theme 1
1
%
% ButtonBox .buttons
unknown option "-padx"
% Dialog .dialog
can't access "ButtonBox::opt": parent namespace doesn't exist 
```

等等等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T13:32:31.897

您永远不应该进行命名空间导入，因为 ttk 与 tk 不直接兼容，因此它不太可能在任何现有代码中工作。

现有的有限支持是您获得的支持：

小部件::主题 1

似乎 MainFrame 和 StatusBar 已更新，但 BWidget 中没有太多其他内容。

# actionscript-3 - 什么是 actionscript3 开发的最佳 IDE

> ID：559044
> 
> 赞同：12
> 
> 时间：2009-02-17T22:37:49.567
> 
> 标签：actionscript-3, ide

我目前正在使用 FlashDevelop 进行 Actionscript3 开发。我还尝试过使用 Flex3 进行 Actionscript3 开发。我很好奇 FDT 是否优于前者，如果它的成本超过了它的实用性。是否还有其他应用程序可以帮助简化流程？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T09:18:08.247

是的，到目前为止，最好的 IDE 是安装了 fdt 或 flex builder 的 eclipse（flex builder 只是 eclipse 的打包版本）。FlashDevelop 最大的问题是缺乏调试工具。如果您进入 Eclipse，并自学如何正确调试应用程序，它可以为您节省大量时间。

至于 flex builder 或 fdt，这完全取决于您。fdt 的一大好处是它仍然支持 AS2 开发。FDT 还有很多其他不错的功能，例如代码模板。

我两者都有，但我主要坚持使用 flex builder 进行 flash 工作，因为我喜欢将它用于 flash 和 flex 工作的方式，并且可以轻松地在两者之间轻松切换。如果我不得不再次在 as2 中工作（上帝保佑），我绝对不会犹豫切换回 fdt 环境。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-24T10:26:17.493

FlashDevelop 是一个非常好的用于 AS3 开发的 IDE。没试过FDT，但试过Flexbuilder。我可以说它对于纯 AS3 开发（没有 mxml 的东西）要好得多。它是免费的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T12:05:16.130

我必须扩展 euge1979 的答案。

[Flex SDK](http://www.adobe.com/products/flex/flexdownloads/index.html) （包括框架、编译器等）被分叉为 Adob​​e 拥有的免费版本和开源版本。无论哪种方式，您都可以免费编译 SWF。

[Flex Builder](http://www.adobe.com/cfusion/entitlement/index.cfm?e=flex3email)不是免费的。您有 30 天的试用期。

需要注意的一点是，FDT 在下一个版本（从 3.1 到 3.2）将能够处理 mxml，从而使其在功能方面与 Flex Builder 相等。我真的很喜欢 FDT 的一些功能，这些功能使常见任务变得简单——比如格式化或创建函数、对象等。

现在 - 坚持使用 Flex Builder。

PS：Flex Builder 是基于 Eclipse 构建的，但它把一切都搞砸了。我在使用 FB 作为插件以及将插件安装到 FB 时遇到了很多问题。如果我不能将它用作插件或将其他人安装到 Eclipse 中，那么所有的功能都会消失。

我现在最喜欢的环境是：[Aptana Studio](http://www.aptana.com/) + FDT + PyDev + PHPDev

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T20:53:17.157

flex builder 因为

1.  你可以调试
2.  你可以使用分析器你可以真正挖掘玩家内存修复内存泄漏
3.  eclipse 可以通过插件的语气为你做很多事情

- mylyn 将您的数据库错误连接到您的 IDE 以及更多链接 svn 提交到任务
- SVN 的 subeclipse 插件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T14:19:54.137

刚开始研究纯 AS3 编程，一直在寻找开源工具，所以 flashdevelop 是首选。

在开发应用程序时，没有任何断点功能是不可行的。尽管它是一个即将推出的功能，但我坚持使用 flexbuilder，直到它在 flasdevelop 中实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T16:43:09.020

我曾经使用 FDT 进行很多 FLASH 编码（不是 Flex），但我发现 Flex builder 是相当的。我觉得 FlexBuilder 需要的主要是良好的重构。从 java 项目转移到 flex，然后想要重构东西是一件痛苦的事情。有一些，但它只需要与eclipse中的Java处于同一水平。

从内存来看，FDT 可能有更好的重构支持。

Flex builder 还具有更好的样式表支持等。我不知道是否更好，它们有点不同。事实上，我发现 flex builder 已经足够好（如果下一个版本只是做了一些改进），我不会错过 FDT。

如果你做任何 AS2，FDT 就很棒。它甚至会给出正确的编译时错误（相对于 flash ide）。我现在是 FDT 的一些旧版本（我有 3.1，但不是最新的）。实际上 FDT 的错误检查和通用的 AS2/3 解析器更好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-21T18:09:40.193

出于与上述相同的原因，我主要使用 FDT + 我不在 Windows 上。

我只想补充一点，FlashDevelop 是对 Flash 开源社区的一个非常慷慨的贡献（非常感谢 Philippe 和 Mika），其中包含一长串不错的工具。

其实我还是少了一个比FDT/FB好很多的“智能自动补全”工具，支持Haxe，可以从项目资源管理器中浏览swf内容，轻松创建项目模板等等……

要考虑的另一点是，FlashDevelop 比 FDT 轻 100 倍（3.7M 对 297M）。

您应该让 FDT 或 FB 试用 30 天。但是，如果您对 FlashDevelop 感到满意，则值得省钱（IMO，FDT 价格过高）并支持开源。

FD 团队目前正在开发调试器和分析工具，因此在一些帮助下它会到达那里；）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-21T20:33:08.617

这一切都归结为个人喜好，但实际上我更喜欢 FlashDevelop 而不是 FDT 和 FB。自由并没有伤害！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-10T06:05:45.277

[Jetbrains IntelliJ](http://www.jetbrains.com/idea/)与其他东西（FlexBuilder 或 FlashDevelop）相结合

它的重构工具是不可或缺的。FlexBuilder 的语法改进。

缺点：它是一个较慢的 IDE (9.02)，但我很乐意为所有添加的功能忍受它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T23:40:41.377

我没有使用过 Flash Develop 或 FDT，尽管我听说 FDT 的运行速度比 Flex Builder 慢得多。我曾经是一名 Flash 程序员，我使用 Flash IDE..我切换到 Flex Builder，我喜欢它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-20T05:29:52.883

供不知情的人参考：如果您是学生或教师，可以免费获得 Flex Builder。而且我很确定不再有“不能用于商业应用”的限制。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-09-11T06:35:15.307

还有**AXDT 开源替代**FDT/Flash Builder。它不是那么好，但它提供得很好，尤其是。对于那些刚开始使用 Flash Platform 并且不愿意在开发人员工具上花费大量资金的人。

有关更多信息，请参阅[AXDT：Flash 开发的开源跨平台替代方案](http://tekkie.flashbit.net/flash/axdt-open-source-cross-platform-alternative-for-flash-development)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-03-03T23:40:05.637

我还是更喜欢普通的 Flash IDE（目前是 CS5）。不过，我与为我的项目提供的艺术作品密切合作。

我使用 SVN 来支持我的工作。根据我使用 Flex Builder（现在的 Flash Builder）或整个 Eclipse 的经验。制作了许多临时文件，有时甚至会混淆查看哪个文件夹......而SVN经常被这些自动文件堆阻碍。

同样适用于团队的 Flex Builder 项目，似乎并没有为所有用户保留跨 SVN 的设置。

无论哪种方式，我都喜欢 Flash，因为它更简单一些，但我通常在不需要花哨的东西的较小项目上工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-07-02T18:17:16.163

与 Flash Develop 相比，现在称为 Flash Builder 的 Flex builder 是最好的 IDE，因为它具有更强大的功能：

1）调试很容易。
2) 支持iOS、android、黑莓应用创建。
3) 我们的应用程序与 xml、dataset 和 api 连接。
4) 语法生成改进。
4) 在舞台上拖放组件，同时在 mxml 文件中为该组件生成代码。
5) 它还支持 PHP 编码，并且还为 PHP 单独推出了一个新框架。
6) Remoting 可以在 Flash 中作为 AS3 remoting 完成。

# visual-studio-2008 - 所有这些 *.FileListAbsolute.txt 文件的用途是什么？

> ID：559045
> 
> 赞同：88
> 
> 时间：2009-02-17T22:37:52.123
> 
> 标签：visual-studio-2008

Visual Studio 生成的 *.FileListAbsolute.txt 文件是什么？他们一直在弄乱我的搜索。例如，当我搜索 *.csproj 以将项目添加到 .sln 时。

Visual Studio 是否使用它们？有没有办法让它不生成它们？

我是 STFW 的，但它充满了人们列出恰好有这些文件的目录的结果。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2010-02-25T13:25:27.980

FileListAbsolute.txt 文件包含在当前构建和先前构建中构建的文件列表，并在清理和重建期间用于确定要删除的文件。

该文件是必需的，因为在某些情况下，例如已重命名的项目，您希望构建系统能够删除旧名称。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-03-10T22:08:57.813

我知道这是一篇较旧的帖子......但我遇到了同样的问题，结果我不小心将这些检查到源代码控制中，并没有将它们检查出来，让它们只读。解决方案是将它们从源代码管理中删除。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-26T11:54:17.920

它跟踪要在清理后删除的文件。从[了解清洁目标](https://github.com/Microsoft/msbuild/issues/2408)：

> [T] 常见目标实现了跟踪“最后一次构建”输出的荣誉系统方法。行为良好的目标将其输出发送到名为 的项目`@(FileWrites)`中，该项目被序列化到名为 的目标`$(CleanFile)`的 obj 目录（以 结尾`.FileListAbsolute.txt`）中`_CleanRecordFileWrites`。然后，Clean 可以在后续的 MSBuild 调用期间读取该列表并删除其中的文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-23T18:43:54.427

我不确定它为什么会生成，现在正在研究它。每次编译时，VS 都会写入这些文件。您可以删除所有这些，它会在您编译时重新生成。（如果您使用 svn 并且不要删除 svnbase 文件，请谨慎使用）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T22:53:44.863

[FileListAbsolute.txt 文件列出了 DLL](https://stackoverflow.com/questions/160179/visual-studio-2005-how-to-get-where-project-are-used-in-a-solution/160249#160249)

# visual-studio-2008 - 视觉工作室 2008 智能感知在 1 秒后消失

> ID：559047
> 
> 赞同：8
> 
> 时间：2009-02-17T22:38:19.563
> 
> 标签：visual-studio-2008, intellisense

我在 Visual Studio 中遇到了一个奇怪的问题，我将在其中键入名称空间/类/任何内容，并且智能感知会按预期弹出，但在我可以突出显示或阅读任何内容之前，它会消失。如果我按 ctrl-space 或 ctrl-j，那么它会再次弹出，但它会在不到一秒钟后再次消失。如果我移动得非常快并开始按下向上和向下箭头，那么只要我继续按下键，它就会保持不变。我一停下来，它又消失了。

我尝试关闭/重新打开项目，关闭并重新打开智能感知，注销并重新打开，以及我能想到的所有其他组合，但似乎没有任何帮助。我可以通过创建一个新项目使其暂时工作，然后关闭解决方案并在该 devenv 实例中打开我现有的项目，但我真的不想永远这样做。:)

这是在我通过 mstsc 连接到的开发盒上，该盒上的其他开发人员似乎都没有这个问题。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T21:56:11.643

有一个选项 VCExpress /ResetSetting

不同版本可能会有所不同（我记得 msdev.exe、devenv.exe）

通过发布找出您的选择

msdev.exe /?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-23T01:00:42.600

另一个应用程序，Visual Studio 插件或其他东西，正在窃取焦点。这就是 IntelliSense 正在消失的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T22:39:50.670

我有同样的问题。我尝试了所有通常的东西，包括删除 ncb 文件，但仍然无法正常工作。有时它只会骗我，让我认为这个函数没有有效的重载，或者函数调用一开始就是不正确的，即使它编译和运行也是如此。我尝试了[Visual Assist X](http://www.wholetomato.com/)，问题**几乎**都消失了。Itellisense 可能非常困难，但视觉辅助 x 做得非常好，并且可能是您可以获得的最接近正确的。另见：

[Visual Studio：智能感知问题和 Linux 兼容性](https://stackoverflow.com/questions/498319/visual-studio-intellisense-problems-and-linux-compatibility)

[如何让 IntelliSense 在 Visual Studio 2008 中可靠地工作](https://stackoverflow.com/questions/39474/how-to-get-intellisense-to-reliably-work-in-visual-studio-2008)

[安装 ReSharper 后 Visual Studio 2005 Intellisense 停止工作](https://stackoverflow.com/questions/178846/visual-studio-intellisense-stopped-working)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T12:47:28.700

我也有这个问题。可悲的是，我们能找到修复它的唯一方法是重新安装 VS2008。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T22:42:01.367

噢，这种情况经常发生在我身上。该死的我忘记了我在做什么。我想一旦它弹出，我就会向下滚动到一个随机属性/方法并选择它。然后我删除它并按“。” 再次并恢复正常。

# c - 我应该从 C 函数返回 TRUE / FALSE 值吗？

> ID：559061
> 
> 赞同：14
> 
> 时间：2009-02-17T22:42:08.433
> 
> 标签：c, return-value

在用 C 语言编程了几年之后，我意识到我一直在忽略 C 中从函数返回零来表示成功的约定。这个约定在我看来在语义上是错误的，因为零当然是错误的。问题是我喜欢将函数命名为`is_valid_foobar()`，并且为了适应“假意味着成功”的约定，我必须更加模糊......而不是：

```
if ( ! is_valid_foobar() ) {
    return (error);
} 
```

其他程序员写道：

```
if ( validate_foobar() ) {
     return (error);
} 
```

我的实现看起来像：

```
int is_valid_foobar (int foobar ) {
     if ( foobar < MAX_ALLOWED ) {
          return TRUE;
      }
      return FALSE;
} 
```

在代码审查中，我实际上并没有因此受到任何抨击。所以我认为这不是一个可怕的习惯，但它是“非常规的”。我很好奇人们是怎么想的。

我对函数和变量名称的选择非常小心，典型的评论评论是“代码非常清晰”，而且我根本不用`!`在前面输入额外的内容函数调用。但是你说什么，哦，强大的SO？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-17T22:48:18.120

我会说两者都是正确的，用于不同的目的：

如果您正在执行简单的通过/不通过验证，例如 is_numeric()，那么 true 和 false 可以很好地工作。

对于更详细的情况，0==success 范式很有帮助，因为它允许返回多个错误条件。

在这种情况下，调用者可以简单地针对 0 进行测试，或者检查非 0 返回以获取更具体的失败解释。例如，由于不存在、权限不足等原因，文件打开调用可能会失败。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-17T22:50:18.770

约定并不完全是您的想法。进程应该以 0 状态退出以表示成功，*返回错误代码*的函数通常使用 0 表示“没有错误”。但作为一个布尔值，0 应该表示假，非零应该表示真。使用 0 表示布尔真值，总有一天你会登上 The Daily WTF。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-17T23:24:53.760

自从我编写 C 语言以来已经有一段时间了，但我认为您在这里谈论的是两种不同的函数：

*   `is_foo`是一个检查某些属性 foo 并返回`0`( `false`) 或非`0`( `true`) 以指示该属性的布尔值的函数。调用这些函数时，不会出现错误状态（如果发生，它会映射到这些值之一）。
*   `foo`是一个执行动作 foo 的函数。它`0`在成功时返回，在错误时返回非`0`值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T22:48:00.510

我不确定我是否同意“从函数返回零表示成功”的约定。

AFAIK，约定是零是假的，在谓词的情况下所有非零都是真的。

然而，这个约定应该只适用于返回布尔值的明显谓词（例如，真/假）。如果函数的主要目标不是返回布尔值（例如 printf、fopen 等），则返回值用于指示失败原因，然后可以采用 UNIX 约定“静默或 0 除非有问题”。

至于返回值，使用固定的返回值并没有错，它让一切变得更方便。

恕我直言，最大的风险是许多人声明了自己的常量，当其他人使用相同的文件时，您开始与他们自己的常量发生冲突。因此，您的 TRUE/FALSE 并与其他人的 TRUE/FALSE 发生冲突。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T22:50:47.880

特别是当您将函数命名为 is_foo() 时，标准 C 字符函数（isdigit()、isupper() 等）是按照您的方式进行操作的一个很好的先例。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-17T22:52:02.137

C 没有布尔概念，除了 0 为假，其他任何东西都为真。

返回 0 的想法来自于有一个返回代码来指示失败是什么。如果您不做返回码，那么将 1 和 0 视为真假并没有错。毕竟，TRUE 和 FALSE 只是 C 中 1 和 0 的类型定义。

不过，这应该有据可查，并且您的函数注释应该明确地说“返回 TRUE 或 FALSE”。

您还可以编写 if (is_invalid_foobar())，这可以使语句易于理解并且在语义上仍然正确。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-17T22:48:11.663

这与其说是 C 约定，不如说是 UN*X shell 约定。考虑标准 C iasalpha()、isdigit() 等函数。它们都返回非零表示成功。底线：在 C 中，'true' 是非零的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T23:11:27.473

如果它烧伤你，那只会很糟糕。如果你从不追踪任何错误，我会说你没问题。更重要的是，函数上方的注释以“为...返回零”开头

“非零是错误”约定用于说明*原因*和错误标志。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-20T15:01:38.627

对我来说，实际上检查 0 似乎更自然，编译器无论如何都会优化它，所以我喜欢写例如

if ( check_foo == 0 ) //做某事

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-20T07:28:57.170

函数返回值——True 和 False 或 Success 和 Error 的约定：

1.  API 等显示返回值为 0 的成功和返回值 = 非零错误值的失败。
2.  如果某事是真的；函数返回 1。例如，如果堆栈为空，isStackEmpty() 将返回 1。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-17T17:45:00.780

返回 1 或 0 仍然是完全任意的。只要保持一致，如果有错误代码，至少在某处注释它们的含义。

# vb.net - 了解 CLS 合规性和正确的代码

> ID：559063
> 
> 赞同：3
> 
> 时间：2009-02-17T22:42:32.923
> 
> 标签：vb.net, standards-compliance, cls-compliant

我试图创建一个抽象控件来管理我们应用程序中的一些状态。但是，我遇到了一些 CLS 问题，并希望有人能提供一些见解。

我有一个这样的枚举：

```
<Flags()> _
Public Enum FormState
    Read = 1
    Edit = 2
    Insert = 4
End Enum 
```

还有一个这样的类：

```
Public MustInherit Class Fields
    Inherits System.Web.UI.UserControl

    Public Property State() As Enumerators.FormState
        Get
            Return _State
        End Get

        Set(ByVal value As Enumerators.FormState)
            _State = value
            ToggleState(value)
        End Set
    End Property

    Protected MustOverride Sub ToggleState(ByVal state As FormState)
End Class 
```

当我尝试编译此代码时，我得到一个警告，即*State*属性不符合 CLS 且*state*参数也不符合。怎么会？我该如何纠正这个问题以消除警告？

*   我试图将 <CLSCompliant(True)> 属性添加到这两个项目，但没有成功
*   我试图将 MSDN 文章*[Non-CLS-compliant 'MustOverride' member is not allowed in a CLS-compliant](http://msdn.microsoft.com/en-us/library/0haa76bc.aspx)*传播到没有结果的代码中
*   我尝试将访问器更改`Friend`为`Public`
*   我尝试为 Enum ( `Integer`and `UInteger`)指定类型

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T09:32:24.860

查看您的代码，枚举似乎是称为枚举器的类的一部分。该类未在您的代码中列出，但我假设您可以完全控制它。

该类也需要使用符合 CLS 的属性进行标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T23:07:17.060

要删除警告，请添加以下属性，以便类、方法和属性如下所示：

```
<CLSCompliant(False)> _
Public MustInherit Class Fields
    Inherits System.Web.UI.UserControl

    <CLSCompliant(False)> _
    Public Property State() As Enumerators.FormState
        Get
            Return _State
        End Get

        Set(ByVal value As Enumerators.FormState)
            _State = value
            ToggleState(value)
        End Set
    End Property

    <CLSCompliant(False)> _
    Protected MustOverride Sub ToggleState(ByVal state As FormState)
End Class 
```

这向编译器表明您希望删除警告并且您知道您的代码不是 CLSCompliant。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-03T17:18:33.460

It could be that you do not have an item with value 0.

# jquery-ui - jQuery ui 对话框问题

> ID：559071
> 
> 赞同：1
> 
> 时间：2009-02-17T22:45:44.960
> 
> 标签：jquery-ui

我开始使用 jquery ui 库向 asp.net 应用程序添加一些增强的 UI 元素。并遇到了一个小错误/问题：

我有一个 jquery UI 对话框，当单击按钮时会调用它。对话框的文本都在 a 中，并且通常对用户隐藏，然后 jquery UI 发挥它的魔力并使用该文本来显示对话框 -一切正常。

这是代码：

```
<input type="button" value="Cancel This Event" onclick="$('#myCancelEventDialog').dialog('open');" /> 
```

这是div：

```
<div id="myCancelEventDialog" title="Cancel an Event or Meeting">
    <p>Are you sure you would like to cancel this event/meeting?</p>
</div> 
```

问题是，每次我的表单重新绘制时，“隐藏”文本实际上会在页面上闪烁一秒钟，然后再次隐藏。（即“您是否想取消此活动/会议文本实际上在一瞬间可见）

有可能防止这种情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T22:54:19.387

我将 div 上的样式设置为“显示：无”。对话框在显示时会改变这一点。

```
 <div id="myCancelEventDialog"
      title="Cancel an Event or Meeting"
      style="display: none;">
     <p>Are you sure you would like to cancel this event/meeting?</p>
 </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T22:49:02.473

将控件上的高度设置为零。这样它以0高度呈现到屏幕上？顺便说一句，这有点猜测......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T22:54:27.920

哪个浏览器？此外，您可以通过设置 display:none 并在弹出对话框之前撤消它来试验 CSS 可见性。

# asp.net - sql会话超时建议

> ID：559075
> 
> 赞同：1
> 
> 时间：2009-02-17T22:46:57.203
> 
> 标签：asp.net, database, session-state, session-timeout

我的一个应用程序使用 sql 会话状态，超时当前设置为 20 分钟。我的问题是，由于它存储在数据库中而不是服务器内存中，我应该能够增加超时而不会出现任何重大的性能问题，对吗？

我不太了解超时对于数据库会话状态场景的重要性，因为数据库应该能够轻松处理大量会话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T01:22:17.050

我认为超时的相关性更适用于面向公众的网站，您可能会获得大量点击并很快填满您的数据库。话虽这么说，无限也不是你想要的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T01:36:00.740

我也在寻找您的意见的确认——如果硬盘空间便宜，我应该能够在 SqlSessionState 中进行 8 小时的会话而不会出现明显的性能问题（超出 20 分钟的 sql server 会话原因），给定一个中等规模的办公室级内网应用。

请记住，关于会话的建议涉及您一次可以处理多少用户，用户开始某些工作、长时间中断以及需要继续的可能性有多大。

最后，如果您在会话中存储身份验证令牌或角色，那么您可能希望更频繁地使它们过期以检查用户仍然是用户并且仍然具有这些角色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-10T22:32:43.903

会话的长度应由功能确定（例如，在线银行往往会缩短超时时间，而类似的站点`SO`则允许更长的时间输入条目），而不是由实现机制确定。

使用[进程外模式](http://msdn.microsoft.com/en-us/library/ms972429.aspx)允许在 IIS 重新循环的情况下保留会话上下文，并且需要较少的直接（由 IIS 本身使用）内存资源。但这与会话应该持续 8 小时还是 5 分钟无关。

# asp-classic - global.asa 它属于哪里？

> ID：559076
> 
> 赞同：1
> 
> 时间：2009-02-17T22:46:58.000
> 
> 标签：asp-classic

我正在将一些 ASP 代码从一台服务器移动到另一台服务器。位置名称略有不同，我怀疑现在“global.asa”没有被正确调用。该位置在 c:\Inetpub\wwwroot\myApp 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T22:54:25.937

它属于您的应用程序的根文件夹。还要确保该文件夹是 IIS 管理器中的应用程序。有一个应用程序名称的文本框，如果文件夹还不是应用程序，则在它旁边有一个“创建”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T22:51:30.000

确保 IIS 中的“myApp”被定义为应用程序。我还会检查 .Net 应用程序映射以确保 .Net 正在处理您的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T22:56:32.750

global.asa 应该位于虚拟目录的根目录中。请注意 global.asa 由 asp 而不是 asp.net 使用。

您通常可以通过查看 IIS 管理器来判断您的目录是否是虚拟目录，因为它看起来不像黄色文件夹。如果它看起来像典型的黄色文件夹，请右键单击父级“默认网站”或其他任何内容，然后选择新的虚拟目录。或者，global.asa 可以放在 Web 的根目录中。如果您使用的是“默认网站”，通常是 C:\inetpub\wwwroot

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T23:02:25.013

为方便起见，我想保留在一个子目录中。显然，您必须将该目录指定为应用程序。这是一个描述如何的链接：

[http://www.calcaria.net/ASP/2006/04/globalasa-file-doesnt-work.html](http://www.calcaria.net/ASP/2006/04/globalasa-file-doesnt-work.html)

一般来说，我反对自动调用文件而不在代码中引用的想法。如果您像我一样是菜鸟，则可以在追踪它之前先脱轨一段时间。我只是因为这种愚蠢而浪费了几个小时。

# php - cURL - 不允许操作错误

> ID：559079
> 
> 赞同：0
> 
> 时间：2009-02-17T22:48:02.443
> 
> 标签：php, curl

我正在尝试将 cURL 与 PHP 一起使用，它给了我这个错误：

*“无法连接到 208.77.188.166：不允许操作”*

我很确定这是服务器问题 - 但以防万一，这是我的代码：

```
<?php

$ch = curl_init();
$url  ="http://www.example.com";
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$output = curl_exec($ch) or die(curl_error($ch));
echo $output;

?> 
```

在 Apache 上启用了 cURL，我尝试将文件的权限更改为 777。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T03:42:55.793

**许多共享主机提供商禁止出站连接。** 例如，Bluehost 要求您在允许出站连接之前购买静态 IP。然后您需要确保 CURL 知道要使用的出站接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:39:51.130

确保设置了所有必需的 CURL 选项：

```
 CURLOPT_RETURNTRANSFER => true,
  CURLOPT_HEADER         => false,
  CURLOPT_FOLLOWLOCATION => true,
  CURLOPT_ENCODING       => "",
  CURLOPT_USERAGENT      => "spider",
  CURLOPT_AUTOREFERER    => true, 
  CURLOPT_CONNECTTIMEOUT => 120,
  CURLOPT_TIMEOUT        => 120,
  CURLOPT_MAXREDIRS      => 10, 
```

我还建议您也使用类似这样的方法来回显错误：

```
$hostconnect = curl_init($url);
$errmsgcurl  = curl_error($hostconnect);
echo $errmsgcurl; 
```

以上代码未经测试，仅作为示例。

还建议您在本地 apache 服务器上试用您的代码，这样您就可以轻松判断问题出在哪里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T06:11:16.963

您可能需要启用`allow_url_fopen`（[参考](http://us2.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)）——如果它在 apache 上，您可以在 .htaccess 文件中执行此操作。

您可以通过将其放入 .htaccess 文件中来启用此功能：

```
php allow_url_fopen on 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T03:55:49.397

您收到的错误很可能与阻止所有出站连接的防火墙有关。许多共享主机提供商正在阻止传出端口 80 连接，以试图阻止 PHP 脚本中猖獗的错误，这些错误允许远程包含然后被用作针对服务器的攻击媒介。

请联系您的主机，如果是这种情况，您将需要找到连接到远程主机的替代方式，或移动托管公司。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T23:01:55.763

您应该尝试使用安装在服务器或工作站上的 curl 版本（命令行版本）并尝试复制错误，您可能需要在 curl 请求中设置引用标头，但这一切都取决于您所在的服务器试图联系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T23:40:34.937

可能是代理问题或服务器上的某种身份验证问题 - 您可以使用常规 Web 浏览器访问此 URL 吗？

# c# - WCF 中流服务合同的大小和超时

> ID：559084
> 
> 赞同：5
> 
> 时间：2009-02-17T22:48:51.020
> 
> 标签：c#, wcf, streaming, wcf-binding

我目前正在做一个小项目，我需要通过互联网发送一个可能很大的文件。

经过一番辩论，我决定使用流选项而不是分块方法。这些文件可能非常大，我真的不想指定一个确切的上限，2GB 可能是 4GB，谁知道呢。

当然，这可能需要很长时间。同样，我真的不想超时。只要需要，就可以了，没关系。

在尝试尝试不同大小的不同文件时，我慢慢地、一步一步地调整了我的 BasicHttpBinding 的属性。我只是想知道我提出的价值观是否基本可以，或者它们是否完全邪恶？

```
transferMode="Streamed"
sendTimeout="10675199.02:48:05.4775807"
receiveTimeout="10675199.02:48:05.4775807"
openTimeout="10675199.02:48:05.4775807"
closeTimeout="10675199.02:48:05.4775807"
maxReceivedMessageSize="9223372036854775807" 
```

这在某种程度上感觉不对，这些只是每个底层数据结构的最大可能值。但我不知道还能做什么。

再说一遍：

这基本上是正确的方法吗？还是我完全误解和误用了这里的框架？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T23:33:04.427

好吧，一种更自然的方法可能是按顺序以中等大小的块发送文件，最后提交一条消息；这也使得从错误中恢复成为可能。完全开放的数字可能存在轻微的 DOS 问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-21T20:10:56.077

当 WCF 客户端和服务器之间的连接通过 VPN 时，我已经遇到了流式传输问题。如果有兴趣，请在[此线程](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/a8c6811f-f80e-4484-b33b-b22dd48c1c3c)中阅读更多内容。

如果流足够大，可以流式传输超过一分钟 - 就会发生异常。

# visual-studio-2008 - 我应该使用 VS 2008 重构支持还是购买 ReSharper？

> ID：559089
> 
> 赞同：4
> 
> 时间：2009-02-17T22:50:31.627
> 
> 标签：visual-studio-2008, refactoring, resharper

我应该使用 VS 2008 重构支持还是购买 ReSharper？

使用 ReSharper 可以做哪些使用 VS 2008 重构支持无法完成的非常好的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T22:54:47.637

为什么不[下载 30 天免费试用版](http://www.jetbrains.com/resharper/download/)，看看您是否喜欢它？我敢肯定，一旦你习惯了安装 R#，你就不想回去了。

仅文档右侧的绿色/橙色/红色错误栏就足够了，但是重构要快得多，并且还有一些其他非常有用的功能，例如代码清理 (CTRL+E+F)，它可以根据重新格式化文档根据您的风格偏好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T01:40:02.483

我喜欢 Resharper 的一件事是您可以创建自定义类型成员布局并使用它来格式化所有文件。

这意味着您可以按照您喜欢的任何方式（包括按名称、访问修饰符等进行子排序）对所有字段/属性/方法/构造函数/覆盖/接口实现/委托/枚举等进行排序，然后甚至将它们封装在区域中如果你选择。

例如，这是我目前编写的指南：

```
CONSIDER grouping members into the following sections in the specified order: 
•   All fields
•   All constructors
•   Public and protected properties
•   Public and protected methods
•   Events
•   All explicit interface implementations
•   Internal members
•   Private members
•   All nested types
When more than one access modifier is in a section, the most visible access modifier should come first (e.g. public before protected).
 DO use #region blocks around not publicly callable and explicit interface implementation groups. 
#region internal members
...
#endregion
#region private members
...
#endregion 
```

这是我用来匹配它们的模板：

```
<?xml version="1.0" encoding="utf-8" ?>

<!--
I. Overall

I.1 Each pattern can have <Match>....</Match> element. For the given type declaration, the pattern with the match, evaluated to 'true' with the largest weight, will be used 
I.2 Each pattern consists of the sequence of <Entry>...</Entry> elements. Type member declarations are distributed between entries
I.3 If pattern has RemoveAllRegions="true" attribute, then all regions will be cleared prior to reordering. Otherwise, only auto-generated regions will be cleared
I.4 The contents of each entry is sorted by given keys (First key is primary,  next key is secondary, etc). Then the declarations are grouped and en-regioned by given property

II. Available match operands

Each operand may have Weight="..." attribute. This weight will be added to the match weight if the operand is evaluated to 'true'.
The default weight is 1

II.1 Boolean functions:
II.1.1 <And>....</And>
II.1.2 <Or>....</Or>
II.1.3 <Not>....</Not>

II.2 Operands
II.2.1 <Kind Is="..."/>. Kinds are: class, struct, interface, enum, delegate, type, constructor, destructor, property, indexer, method, operator, field, constant, event, member
II.2.2 <Name Is="..." [IgnoreCase="true/false"] />. The 'Is' attribute contains regular expression
II.2.3 <HasAttribute CLRName="..." [Inherit="true/false"] />. The 'CLRName' attribute contains regular expression
II.2.4 <Access Is="..."/>. The 'Is' values are: public, protected, internal, protected internal, private
II.2.5 <Static/>
II.2.6 <Abstract/>
II.2.7 <Virtual/>
II.2.8 <Override/>
II.2.9 <Sealed/>
II.2.10 <Readonly/>
II.2.11 <ImplementsInterface CLRName="..."/>. The 'CLRName' attribute contains regular expression
II.2.12 <HandlesEvent />
-->

<Patterns xmlns="urn:shemas-jetbrains-com:member-reordering-patterns">

  <!--Do not reorder COM interfaces-->
  <Pattern>
    <Match>
      <And Weight="100">
        <Kind Is="interface"/>
        <HasAttribute CLRName="System.Runtime.InteropServices.InterfaceTypeAttribute"/>
      </And>
    </Match>
  </Pattern>

  <!--Special formatting of NUnit test fixture-->
  <Pattern RemoveAllRegions="true">
    <Match>
      <And Weight="100">
        <Kind Is="class"/>
        <HasAttribute CLRName="NUnit.Framework.TestFixtureAttribute" Inherit="true"/>
      </And>
    </Match>

    <!--Setup/Teardow-->
    <Entry>
      <Match>
        <And>
          <Kind Is="method"/>
          <Or>
            <HasAttribute CLRName="NUnit.Framework.SetUpAttribute" Inherit="true"/>
            <HasAttribute CLRName="NUnit.Framework.TearDownAttribute" Inherit="true"/>
            <HasAttribute CLRName="NUnit.Framework.FixtureSetUpAttribute" Inherit="true"/>
            <HasAttribute CLRName="NUnit.Framework.FixtureTearDownAttribute" Inherit="true"/>
          </Or>
        </And>
      </Match>
      <Group Region="Setup/Teardown"/>

    </Entry>

    <!--All other members-->
    <Entry/>

    <!--Test methods-->
    <Entry>
      <Match>
        <And Weight="100">
          <Kind Is="method"/>
          <HasAttribute CLRName="NUnit.Framework.TestAttribute" Inherit="false"/>
        </And>
      </Match>
      <Sort>
        <Name/>
      </Sort>
    </Entry>
  </Pattern>

  <!--Default pattern-->
  <Pattern RemoveAllRegions="true">
    <!--public delegate-->
    <Entry>
      <Match>
        <And Weight="100">
          <Access Is="public"/>
          <Kind Is="delegate"/>
        </And>
      </Match>
      <Sort>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

    <!--public enum-->
    <Entry>
      <Match>
        <And Weight="100">
          <Access Is="public"/>
          <Kind Is="enum"/>
        </And>
      </Match>
      <Sort>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

    <!--fields and constants-->
    <Entry>
      <Match>
        <Or>
          <Kind Is="constant"/>
          <Kind Is="field"/>
        </Or>
      </Match>
      <Sort>
        <Kind Order="constant field"/>
        <Static/>
        <Readonly/>
        <Access Order="public"/>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

    <!--Constructors. Place static one first-->
    <Entry>
      <Match>
        <Kind Is="constructor"/>
      </Match>
      <Sort>
        <Static/>
      </Sort>
      <Group/>
    </Entry>

    <!--public and protected properties, indexers-->
    <Entry>
      <Match>
        <And>
            <Or>
              <Kind Is="property"/>
              <Kind Is="indexer"/>
            </Or>
            <Or>
            <Access Is="public"/>
            <Access Is="protected"/>
            </Or>
        </And>
      </Match>
      <Sort>
        <Access Order="public"/>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

    <!-- Methods -->
    <Entry>
      <Match>
        <And>
            <Kind Is="method"/>
            <Or>
                <Access Is="public"/>
                <Access Is="protected"/>
            </Or>
        </And>
      </Match>
      <Sort>
        <Access Order="public"/>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

    <!-- Events-->
    <Entry>
      <Match>
        <Kind Is="event"/>
      </Match>
      <Sort>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

     <!--interface implementations-->
    <Entry>
      <Match>
        <And Weight="100">
          <Kind Is="member"/>
          <ImplementsInterface/>
        </And>
      </Match>
      <Sort>
        <ImplementsInterface Immediate="true"/>
        <Kind Order="property"/>
        <Name/>
      </Sort>
      <Group/>
    </Entry>

    <!--internal properties, indexers, methods-->
    <Entry>
      <Match>
        <And>
            <Or>
              <Kind Is="property"/>
              <Kind Is="indexer"/>
              <Kind Is="method"/>
            </Or>
            <Access Is="internal"/>
        </And>
      </Match>
      <Sort>
        <Access Order="public"/>
        <Kind Order="property"/>
        <Name/>
      </Sort>
      <Group Region="Internal Members"/>
    </Entry>

    <!--private properties, indexers, methods-->
    <Entry>
      <Match>
        <And>
            <Or>
              <Kind Is="property"/>
              <Kind Is="indexer"/>
              <Kind Is="method"/>
            </Or>
            <Access Is="private"/>
        </And>
      </Match>
      <Sort>
        <Access Order="public"/>
        <Kind Order="property"/>
        <Name/>
      </Sort>
      <Group Region="Private Members"/>
    </Entry>

    <!--all other members-->
    <Entry/>

    <!--nested types-->
    <Entry>
      <Match>
        <Kind Is="type"/>
      </Match>
      <Sort>
        <Name/>
      </Sort>
      <Group/>
    </Entry>
  </Pattern>
</Patterns> 
```

这使得格式化您的代码以满足您公司的编码风格就像一个键盘快捷键一样简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T23:37:13.730

使用锐器。我用了很多年。一旦你学会了捷径，就好像你雇了另一个人为你工作:)

请注意，它可以设置为使用与 IntelliJ Idea 相同的键，因此如果您需要做一些 Java，您将已经知道如何使用（非常好的）Java IDE。

另外，请阅读此内容 - [31 天的 reshaper](http://blog.excastle.com/2007/01/31/blog-event-the-31-days-of-resharper/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T22:57:15.807

绝对至少尝试 ReSharper。它比默认的 VS2008 重构做得更多，并且在跟踪单元测试方面也做得很好。

由于有免费试用版，因此尝试一下应该不会有什么坏处。

我已经使用了一段时间了，我不得不承认我永远无法回到普通的 Visual Studio ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T23:03:43.217

顺便说一句：还有[重构！临](http://www.devexpress.com/Products/Visual_Studio_Add-in/Refactoring/)。我用了很短的时间试用版并喜欢它（还没买）。

与 ReSharper 一样，它提供了更多的重构，并且比 Visual Studio 重构工具更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T01:44:58.850

我喜欢 Resharper 的一件事是，您可以使用 Ctrl-Shift-Alt-Up 或 Down 在文件中向上或向下移动方法/字段/属性等（直接在与其相邻的方法/字段/属性的上方或下方） ，或者您可以使用文件结构浏览器通过拖放来查看和重新排列文件的结构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T09:39:19.833

我尝试了 30 天试用，现在我迷上了 R#

# testing - 模拟外部服务如何改进单元测试？

> ID：559092
> 
> 赞同：7
> 
> 时间：2009-02-17T22:51:32.043
> 
> 标签：testing, mocking

我正在连接到一个简单的、特殊的外部服务。

我相信我的单元测试不应该依赖于该外部服务的可用性或实现，所以我打算模拟它。

我需要模拟来接受和返回真实的消息和响应——否则我的测试将不能代表真实的事态。例如，它必须抛出正确类型的错误——它至少有 7 种不同的方式可能会失败（在你我之间，它不是一个设计良好的外部服务）。因此，至少我必须有一个消息/响应对的哈希值。

因此，嘲笑并没有减少偶然性，而是在其他地方重新引入了它。事实上，正如俗话所说，现在我有两个问题：我必须确保我的哈希中的内容是外部服务行为方式的公平表示。但可以肯定的是，响应对象 X 给消息*m*的规范来源是 X 本身。其他任何事情都是有风险和混乱的。

我走错了吗？我怎样才能消除这种明显的循环？

**编辑**根据Justice的有用评论，我已经澄清了我认为问题所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T23:20:03.677

首先，为了避免重复自己，让我[在另一个关于单元测试的问题上向您推荐我的两个答案。](https://stackoverflow.com/questions/513778/what-do-you-think-of-junit-style-unit-testing-do-you-favor-behaviour-driven-test/513807#513807)

我认为在这种环境中模拟给你的东西是它严格指定*你*认为该外部接口的行为将是什么。这意味着你有一个受控的测试（有些东西告诉我这个外部服务经常改变。）所以，你不仅可以使用已知的“好”响应序列来测试和调试你的代码，而且你有一个文档集您所期望的示例。

如果我处于这种情况，并且取决于实际服务，我会很想*为外部服务*编写单元测试或模拟。这样，如果您在实际操作中观察到错误，您可以 (1) 使用外部接口的 mock 对您的代码运行测试，以及 (2) 根据您的期望测试外部服务。

不过，关键是要有一些你真正有信心并且完全可以控制的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T22:56:32.830

用于单元测试的模拟不应*准确*代表外部服务。您应该为模拟的外部服务选择预定义的输入和输出值集。它们可能是也可能不是外部服务实际返回的内容（但它们应该是“某种”真实的）。单元测试的目标是在给定这组输入和输出的情况下，仔细检查对象的行为是否正确，以获得“正确”的某种含义。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-17T22:57:24.340

确保你的类所依赖的任何东西都有一个接口（而不仅仅是一个具体的实现），然后你就可以使用[JMock](http://www.jmock.org/)。这将极大地简化您的测试。你可以做一些事情，比如告诉它期待一个方法调用 X，返回一个特定的值，或者抛出一个异常。这真的是一个节省时间。

# python - 使用 Python 检查 PDF 文件是否有效

> ID：559096
> 
> 赞同：21
> 
> 时间：2009-02-17T22:53:27.843
> 
> 标签：python, file, pdf

**我通过 HTTP-Upload 获得了一个文件，并且需要确保它是一个 pdf 文件。**编程语言是 Python，但这无关紧要。

我想到了以下解决方案：

1.  检查字符串的第一个字节是否为“%PDF”。*这不是一个好的检查，但可以防止用户意外上传其他文件。*

2.  尝试 libmagic（bash 上的“文件”命令使用它）。*这与 (1) 中的检查完全相同*

3.  取一个库并尝试从文件中读取页数。*如果该库能够读取页数，则它应该是有效的 pdf。问题：我不知道可以执行此操作的 python 库*

所以有人对lib或其他技巧有任何解决方案吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-09-18T14:36:41.200

### 2020 年更新

看起来[pdfminer.six](https://pdfminersix.readthedocs.io/en/latest/)是一个维护项目（其他项目，包括下面的项目，似乎已经死了）。

[ReportLab](https://pypi.org/project/reportlab/)是另一个（被我错误地标记为已死）

### 原始答案

因为显然两者都没有`PyPdf` ~~也不`ReportLab`~~不再可用，我发现的当前解决方案（截至 2015 年）是使用[`PyPDF2`](https://github.com/mstamy2/PyPDF2)和捕获异常（并可能分析[`getDocumentInfo()`](https://pythonhosted.org/PyPDF2/PdfFileReader.html#PyPDF2.PdfFileReader.getDocumentInfo)）

```
import PyPDF2

with open("testfile.txt", "w") as f:
    f.write("hello world!")

try:
    PyPDF2.PdfFileReader(open("testfile.txt", "rb"))
except PyPDF2.utils.PdfReadError:
    print("invalid PDF file")
else:
    pass 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-17T23:19:52.710

在我的项目中，我需要检查某些上传文件的 mime 类型。我只是像这样使用文件命令：

```
from subprocess import Popen, PIPE
filetype = Popen("/usr/bin/file -b --mime -", shell=True, stdout=PIPE, stdin=PIPE).communicate(file.read(1024))[0].strip() 
```

您当然可能希望将实际命令移动到某个配置文件中，因为命令行选项也因操作系统（例如 mac）而异。

如果您只需要知道它是否是 PDF 并且无论如何都不需要处理它，我认为 file 命令是比 lib 更快的解决方案。当然也可以手动进行，但如果您想检查不同的类型，文件命令可能会为您提供更大的灵活性。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-18T01:10:35.050

Python 最常用的两个 PDF 库是：

*   [pyPDF](http://pybrary.net/pyPdf/)
*   [报告实验室](http://www.reportlab.org/downloads.html)

两者都是纯python，所以应该很容易安装并且是跨平台的。

使用 pyPdf 可能就像这样做一样简单：

```
from pyPdf import PdfFileReader
doc = PdfFileReader(file("upload.pdf", "rb")) 
```

这应该足够了，但是如果您想进一步检查，`doc`现在将拥有`documentInfo()` 和方法。`numPages()`

正如卡尔回答的那样，pdftotext 也是一个很好的解决方案，并且在非常大的文档（尤其是具有许多交叉引用的文档）上可能会更快。但是，由于分叉新进程等的系统开销，在小型 PDF 上可能会慢一些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T23:00:05.487

如果您使用的是 Linux 或 OS X 机器，则可以使用[Pdftotext](http://en.wikipedia.org/wiki/Pdftotext)（Xpdf 的一部分，可在[此处](http://www.foolabs.com/xpdf/download.html)找到）。如果您将非 PDF 传递给 pdftotext，它肯定会向您吠叫，您可以使用 commands.getstatusoutput 获取输出并解析这些警告。

如果您正在寻找独立于平台的解决方案，您也许可以使用[pyPdf](http://pybrary.net/pyPdf/)。

**编辑：**它并不优雅，但如果您尝试加载非 PDF，pyPdf 的 PdfFileReader 会抛出 IOError(22) 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-08T22:25:07.483

这是使用[pdfminersix](https://pdfminersix.readthedocs.io/en/latest/reference/highlevel.html)的解决方案，可以安装`pip install pdfminer.six`：

```
from pdfminer.high_level import extract_text

def is_pdf(path_to_file):
    try:
        extract_text(path_to_file)
        return True
    except:
        return False 
```

您还可以使用[文件类型](https://pypi.org/project/filetype/)( `pip install filetype`)：

```
import filetype

def is_pdf(path_to_file):
    return filetype.guess(path_to_file).mime == 'application/pdf' 
```

这些解决方案都不是理想的。

1.  该`filetype`解决方案的问题在于它不会告诉您 PDF 本身是否*可读*。它会告诉您文件是否为 PDF，但也可能是损坏的 PDF。
2.  仅当 PDF 实际可读时，该`pdfminer`解决方案才应返回。`True`但它是一个很大的库，对于这样一个简单的功能来说似乎有点过分了。

我在[这里开始了另一个线程，](https://stackoverflow.com/questions/64271052/how-would-you-write-an-is-pdfpath-to-file-function-in-python)询问如何在不使用库（或使用较小的库）的情况下检查文件是否为有效 PDF。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T00:10:24.733

有效是指它可以由 PDF 查看器显示，还是可以提取文本？它们是两个非常不同的东西。

如果您只是想检查它是否真的是已上传的 PDF 文件，那么 pyPDF 解决方案或类似的解决方案将起作用。

但是，如果您想检查是否可以提取文本，那么您会发现整个世界都很痛苦！使用 pdftotext 将是一个简单的解决方案，在大多数情况下都可以使用，但绝不是 100% 成功。我们发现了许多 pdftotext 无法从中提取的 PDF 示例，但 iText 和 PDFBox 等 Java 库可以。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-16T07:47:48.930

我遇到了同样的问题，但没有被迫使用编程语言来管理这个任务。我使用了 pyPDF，但对我来说效率不高，因为它无限挂在一些损坏的文件上。

但是，直到现在我发现这个软件很有用。

祝你好运。

[https://sourceforge.net/projects/corruptedpdfinder/](https://sourceforge.net/projects/corruptedpdfinder/)

# iis-7 - IIS6 或 IIS7 中 ColdFusion 8 的 Web 文件安全最佳实践

> ID：559099
> 
> 赞同：2
> 
> 时间：2009-02-17T22:54:20.650
> 
> 标签：iis-7, coldfusion, iis-6

假设我们有一个网站，其中包含内部编写的 CF 应用程序。

假使，假设：

*   将使用 Server 2003 IIS6 或 2008 IIS7
*   将使用 ColdFusion 8
*   目录浏览被拒绝
*   需要 SSL 才能连接
*   帐户登录过程是安全的（是的，我知道这完全是另外一回事，但这个概念在网络上被讨论得令人作呕）。

假设我在[https://domain.com/folder1/folder2/](https://domain.com/folder1/folder2/)有一个文件，其名称类似于 picture92352.ext，可以将其想象为 jpg 或 pdf 或其他格式。域名和文件之间的整个路径在命名结构、深度等方面差异很大。文件并非全部集中在一个文件夹中。

该应用程序限制用户的链接，因此用户必须首先访问该文件才能找到它，但现在如果一个人知道该文件的完整 URL，他们可以在不登录应用程序的情况下检索它. 这是经典的默默无闻的安全情况。一个随机的人不太可能找到他们不应该访问的文件，但是一旦有人获得访问权限，他们就知道如何从另一台 PC 访问该文件，而他们的行为可能不会追溯到他们。

如何在有人登录之前限制对这些文件的访问，并在外部用户登录后仍然可以访问它们？有没有办法只使用权限，或者是在请求时让代码动态移动文件的唯一答案，或者是否有一些我什至没有想到的明显步骤？

让我稍微澄清一下。无论文件在页面上如何呈现，用户都可以使用浏览器 IE、Firefox 等来检查文件来自的 URL。如果图像是链接，则在 IE 的右键菜单中始终存在复制快捷方式，而 FF 中的相同功能称为复制链接位置。如果图像作为页面的一部分内联显示，IE 用户可以右键单击并选择属性以查看 URL，在 FF 中存在相同的功能来查看属性，但有一个更快更方便的选项标记为复制图像位置。一旦用户知道文件的 URL（如果位置或文件名没有更改），他们就可以使用该 URL，而无需在 CF 应用程序中进行身份验证。

如果我更改 NTFS/共享权限以使 IUSR 看不到内容，那么我的 CF 应用程序和 IIS 就无法推送它。我使用什么策略在 CF 应用程序中提供不会留下这个漏洞的文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T02:16:39.337

您可以编写一个提供图像的 CFM 页面。然后，您只需确保它们在 CFM 中经过身份验证。

```
<!-- something like this -->
http://localhost/GetFile.cfm?file=foobar.jpg 
```

在 GetFile.cfm 中，您可以执行以下操作：

```
<!-- the filename part is what the browser will pre-popualate the file name in the download dialog as -->
<CFHEADER name="Content-disposition" value="attachment;filename=picture92352.ext"> 
<CFCONTENT type="text/plain" file="\\fileserver\folder1\folder2\picture92352.ext"> 
```

看看各种[MIME 类型](http://en.wikipedia.org/wiki/MIME#Content-Type)。

如果您想做类似的事情但保持更自然的 URL，我认为您需要利用 ColdFusion 的 Java servlet 基础来为任何匹配特定模式的 URL 创建处理程序。

# linq - Entity Linq - 检索记录并且仅检索一对多关系中的第一个子记录

> ID：559110
> 
> 赞同：0
> 
> 时间：2009-02-17T22:57:37.770
> 
> 标签：linq, entity-framework, linq-to-entities

我有一个名为“Requests”的实体，它有一个名为“StatusHistories”的导航

我需要检索最后一个 StatusHistory 为“Open”的所有请求

StatusHistory 具有字段 StartDate（其中最高的一个将是最后一个 StatusHistory） Status（对于此假定状态包含字符串“Open”或“Closed”） RecordID（这是 SQL Server 中的 Identity 字段，因此它也可以是曾经找到最后一个，但我宁愿不）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T23:16:36.477

```
var result = from r in Requests
             where <condition> 
             select r.field1, r.field2, (from s in StatusHistory
                                         where <join codition>
                                         order by s.StartDate descending
                                         select s.field).FirstOrDefault() 
```

# javascript - 如何使用 Javascript 将货币字符串转换为双精度？

> ID：559112
> 
> 赞同：268
> 
> 时间：2009-02-17T22:57:55.587
> 
> 标签：javascript, jquery

我有一个文本框，其中包含一个*货币*字符串，然后我需要将该字符串转换为双精度以对其执行一些操作。

`"$1,100.00"`→`1100.00`

这需要发生在所有客户端。我别无选择，只能将*货币*字符串作为*货币*字符串作为输入，但需要将其转换/转换为双精度以允许进行一些数学运算。

* * *

## 回答 #1

> 赞同：549
> 
> 时间：2009-02-17T23:20:50.057

删除所有非点/数字：

```
var currency = "-$4,400.50";
var number = Number(currency.replace(/[^0-9.-]+/g,"")); 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-17T23:13:45.970

使用正则表达式删除格式（美元和逗号），并使用 parseFloat 将字符串转换为浮点数。`

```
var currency = "$1,100.00";
currency.replace(/[$,]+/g,"");
var result = parseFloat(currency) + .05; 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-03-27T15:28:39.623

[会计.js](https://openexchangerates.github.io/accounting.js/)是要走的路。我在一个项目中使用它并且使用它有很好的经验。

```
accounting.formatMoney(4999.99, "€", 2, ".", ","); // €4.999,99
accounting.unformat("€ 1.000.000,00", ","); // 1000000 
```

你可以在[GitHub 上找到它](https://github.com/openexchangerates/accounting.js)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-09-21T06:15:11.290

我知道这是一个老问题，但想提供一个额外的选择。

jQuery Globalize 提供了将文化特定格式解析为浮点数的能力。

[https://github.com/jquery/globalize](https://github.com/jquery/globalize)

给定一个字符串“$13,042.00”，并将 Globalize 设置为 en-US：

```
Globalize.culture("en-US"); 
```

您可以像这样解析浮点值：

```
var result = Globalize.parseFloat(Globalize.format("$13,042.00", "c")); 
```

这会给你：

```
13042.00 
```

并允许您与其他文化一起工作。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-03-23T06:36:46.780

我知道这是一个老问题，但 CMS 的答案似乎有一个小小的缺陷：它只有在货币格式使用“。”时才有效。作为小数分隔符。例如，如果您需要使用俄罗斯卢布，字符串将如下所示：“1 000,00 rub”。

我的解决方案远不如 CMS 优雅，但它应该可以解决问题。

```
var currency = "1 000,00 rub."; //it works for US-style currency strings as well
var cur_re = /\D*(\d+|\d.*?\d)(?:\D+(\d{2}))?\D*$/;
var parts = cur_re.exec(currency);
var number = parseFloat(parts[1].replace(/\D/,'')+'.'+(parts[2]?parts[2]:'00'));
console.log(number.toFixed(2));
```

假设：

*   货币值使用十进制表示法
*   字符串中没有不属于货币值的数字
*   货币值的小数部分包含 0 或 2 位数字 *

正则表达式甚至可以处理“1,999 美元和 99 美分”之类的东西，尽管它不是预期的功能，也不应该依赖它。

希望这会对某人有所帮助。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-12-31T03:28:10.660

这个例子运行正常

```
var currency = "$1,123,456.00";
var number = Number(currency.replace(/[^0-9\.]+/g,""));
console.log(number);
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-07-26T15:39:13.887

// "10.000.500,61 TL" price_to_number => 10000500.61

// "10000500.62" number_to_price => 10.000.500,62

JS 小提琴：[https ://jsfiddle.net/Limitlessisa/oxhgd32c/](https://jsfiddle.net/Limitlessisa/oxhgd32c/)

```
var price="10.000.500,61 TL";
document.getElementById("demo1").innerHTML = price_to_number(price);

var numberPrice="10000500.62";
document.getElementById("demo2").innerHTML = number_to_price(numberPrice);

function price_to_number(v){
    if(!v){return 0;}
    v=v.split('.').join('');
    v=v.split(',').join('.');
    return Number(v.replace(/[^0-9.]/g, ""));
}

function number_to_price(v){
    if(v==0){return '0,00';}
    v=parseFloat(v);
    v=v.toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    v=v.split('.').join('*').split(',').join('.').split('*').join(',');
    return v;
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-17T23:11:22.823

你可以试试这个

```
var str = "$1,112.12";
str = str.replace(",", "");
str = str.replace("$", "");
console.log(parseFloat(str));
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-03-03T01:46:38.530

这是我的功能。适用于所有货币..

```
function toFloat(num) {
    dotPos = num.indexOf('.');
    commaPos = num.indexOf(',');

    if (dotPos < 0)
        dotPos = 0;

    if (commaPos < 0)
        commaPos = 0;

    if ((dotPos > commaPos) && dotPos)
        sep = dotPos;
    else {
        if ((commaPos > dotPos) && commaPos)
            sep = commaPos;
        else
            sep = false;
    }

    if (sep == false)
        return parseFloat(num.replace(/[^\d]/g, ""));

    return parseFloat(
        num.substr(0, sep).replace(/[^\d]/g, "") + '.' + 
        num.substr(sep+1, num.length).replace(/[^0-9]/, "")
    );

} 
```

用法：`toFloat("$1,100.00")`或`toFloat("1,100.00$")`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-17T23:10:31.390

我知道您已经找到了问题的解决方案，我只是想建议您查看以下更广泛的国际数字格式 jQuery 插件：

[国际号码格式化程序](http://code.google.com/p/jquery-numberformatter/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-10-29T11:05:25.647

**对于在2021 年**寻找解决方案的任何人，您都可以使用[Currency.js](https://github.com/scurker/currency.js)。

经过大量研究，这是我发现的最可靠的生产方法，到目前为止我没有任何问题。此外，它在 Github 上非常活跃。

```
currency(123);      // 123.00
currency(1.23);     // 1.23
currency("1.23")    // 1.23
currency("$12.30")  // 12.30

var value = currency("123.45");
currency(value);    // 123.45 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-21T15:26:59.080

```
jQuery.preferCulture("en-IN");
var price = jQuery.format(39.00, "c"); 
```

输出为：卢比。39.00

```
use jquery.glob.js,
    jQuery.glob.all.js 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-04-13T19:11:07.570

```
let thousands_seps = '.';
let decimal_sep = ',';

let sanitizeValue = "R$ 2.530,55".replace(thousands_seps,'')
                         .replace(decimal_sep,'.')
                         .replace(/[^0-9.-]+/, '');

// Converting to float
// Result 2530.55
let stringToFloat = parseFloat(sanitizeValue);

// Formatting for currency: "R$ 2.530,55"
// BRL in this case
let floatTocurrency = Number(stringToFloat).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});

// Output
console.log(stringToFloat, floatTocurrency); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-08-23T09:49:20.520

简单点怎么样

```
Number(currency.replace(/[^0-9-]+/g,""))/100; 
```

适用于所有货币和地区。替换所有非数字字符（您可以有 €50.000,00 或 $50,000.00）输入必须有 2 位小数

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-04-06T16:05:18.420

这对我有用，涵盖了大多数边缘情况:)

```
function toFloat(num) {
  const cleanStr = String(num).replace(/[^0-9.,]/g, '');
  let dotPos = cleanStr.indexOf('.');
  let commaPos = cleanStr.indexOf(',');

  if (dotPos < 0) dotPos = 0;

  if (commaPos < 0) commaPos = 0;

  const dotSplit = cleanStr.split('.');
  const commaSplit = cleanStr.split(',');

  const isDecimalDot = dotPos
    && (
      (commaPos && dotPos > commaPos)
      || (!commaPos && dotSplit[dotSplit.length - 1].length === 2)
    );

  const isDecimalComma = commaPos
    && (
      (dotPos && dotPos < commaPos)
      || (!dotPos && commaSplit[commaSplit.length - 1].length === 2)
    );

  let integerPart = cleanStr;
  let decimalPart = '0';
  if (isDecimalComma) {
    integerPart = commaSplit[0];
    decimalPart = commaSplit[1];
  }
  if (isDecimalDot) {
    integerPart = dotSplit[0];
    decimalPart = dotSplit[1];
  }

  return parseFloat(
    `${integerPart.replace(/[^0-9]/g, '')}.${decimalPart.replace(/[^0-9]/g, '')}`,
  );
} 
```

```
toFloat('USD 1,500.00'); // 1500
toFloat('USD 1,500'); // 1500
toFloat('USD 500.00'); // 500
toFloat('USD 500'); // 500

toFloat('EUR 1.500,00'); // 1500
toFloat('EUR 1.500'); // 1500
toFloat('EUR 500,00'); // 500
toFloat('EUR 500'); // 500 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-12-30T06:58:49.883

```
 $ 150.00
    Fr. 150.00
    € 689.00 
```

我已经测试了以上三种货币符号。你也可以为其他人做。

```
 var price = Fr. 150.00;
    var priceFloat = price.replace(/[^\d\.]/g, ''); 
```

上面的正则表达式将删除不是数字或句点的所有内容。因此，您可以获得没有货币符号的字符串，但如果您控制台输出为“Fr. 150.00”，那么您将获得价格为

```
 console.log('priceFloat : '+priceFloat);

    output will be like  priceFloat : .150.00 
```

这是错误的，所以你检查“。”的索引。然后拆分并获得正确的结果。

```
 if (priceFloat.indexOf('.') == 0) {
            priceFloat = parseFloat(priceFloat.split('.')[1]);
    }else{
            priceFloat = parseFloat(priceFloat);
    } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-08-25T11:29:07.377

```
function NumberConvertToDecimal (number) {
    if (number == 0) {
       return '0.00'; 
    }
    number = parseFloat(number);
    number = number.toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1");
    number = number.split('.').join('*').split('*').join('.');
    return number;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-08-16T21:47:52.350

```
var parseCurrency = function (e) {
    if (typeof (e) === 'number') return e;
    if (typeof (e) === 'string') {
        var str = e.trim();
        var value = Number(e.replace(/[^0-9.-]+/g, ""));
        return str.startsWith('(') && str.endsWith(')') ? -value: value;
    }

    return e;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-01-21T19:50:33.737

无论语言环境和货币设置如何，此功能都应该起作用：

```
function getNumPrice(price, decimalpoint) {
    var p = price.split(decimalpoint);
    for (var i=0;i<p.length;i++) p[i] = p[i].replace(/\D/g,'');
    return p.join('.');
} 
```

这假设您知道小数点字符（在我的情况下，语言环境是从 PHP 设置的，所以我用`<?php echo cms_function_to_get_decimal_point(); ?>`.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-08-28T19:50:32.767

这是一个简单的功能 -

```
function getNumberFromCurrency(currency) {
  return Number(currency.replace(/[$,]/g,''))
}

console.log(getNumberFromCurrency('$1,000,000.99')) // 1000000.99
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-11-20T17:31:37.630

如此令人头疼，而对其他文化的考虑如此之少……

这是伙计们：

```
let floatPrice = parseFloat(price.replace(/(,|\.)([0-9]{3})/g,'$2').replace(/(,|\.)/,'.')); 
```

就如此容易。

# mysql - （如何/应该如何）我实现一个可扩展到每秒数万个请求的数据库？

> ID：559134
> 
> 赞同：7
> 
> 时间：2009-02-17T23:07:12.723
> 
> 标签：mysql, database, scaling, cluster-computing, tokyo-cabinet

通过上万个请求/秒，我希望看到 60,000 -> +90,000 个请求/秒。

我的设置包括以下内容：

用户 ---> Web 应用程序 --> 消息队列 --> 解析器 --> 数据库？

我应该提到，解析器目前可以使用 COPY 解析/填充大约 18750 条记录/秒，因此在我们开始添加更多解析器之前，我们在这方面受到限制——这对我来说现在不是一个大问题。

我有一个系统，需要能够尽可能快地批量上传尽可能多的记录。这个相同的系统（或者它可以根据您的处理方式而有所不同）应该能够响应分析类型的查询，例如：

```
wonq = "从玩家 = '@player' 和 " +
       "(type = 'award' or type = 'return') and hand = hand_num"
lostq = "从 player = 'player' 和 " + 的操作中选择 sum(amount)
        “输入！='award'并输入！='return'和hand = hand_num”

```

.....10-15 千次（每个用户），因为它们被锁定到另一个表。不用说，我们现在将这些结果分页为 10/页。

我查看了以下内容：（假设这些都在同一台服务器上）

*   mysql (reg. run of the mill rdbms)——能够进入 15-20,000 个请求/秒的范围；在当前条件下，如果我们尝试扩展它，我们每次需要扩展时都需要一个单独的主机/数据库——这是不可行的

*   couchdb（面向文档的数据库）——没有打破 700 个请求/秒；我真的希望这能拯救我们的屁股——不是机会！

*   vertica（面向列的数据库）——达到 60000 个请求/秒，封闭源代码，非常昂贵；这仍然是一个选择，但我个人根本不喜欢它

*   tokyocabinet（基于哈希的数据库）——目前的重量为 45,000 次插入/秒和 66,000 次选择/秒；昨天当我写这篇文章时，我使用了一个基于 FFI 的适配器，它的性能大约为 5555 个请求/秒；这是迄今为止我见过的最快最棒的数据库！

*   兵马俑——（vm集群）目前正在与jmaglev一起评估它（不能等到maglev本身出来）——这是最慢的！

也许我只是错误地解决了这个问题，但我总是听说 RDBMS 非常慢 - 那么我听说过的这些超快速系统在哪里？

**测试条件**::

只是让人们知道我在我的开发盒上的规格是：

```
双 3.2ghz 英特尔，1 gig ram

```

Mysql mysql.cnf 编辑为：

```
key_buffer = 400M # 是 16M
innodb_log_file_size = 100M # 之前不存在
innodb_buffer_pool_size = 200M # 之前不存在

```

**更新**::

事实证明，terracotta 可能在我们的应用程序结构中占有一席之地，但它不会很快替换我们的数据库，因为它的速度很糟糕，而且它的堆利用率很糟糕。

另一方面，我很高兴看到 tokyocabinet 的 NON-FFI ruby​​ 库（意思是 tyrant/cabinet）超级快，现在它是第一名。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T23:12:35.833

对于疯狂的大可扩展性，您需要关注两件事：

*   分片：将您的数据集分成不重叠的组。有一种从请求映射到服务器的简单、快速的方法。（以 af 开头的播放器，服务器 1；gq，服务器 2……等等……）
*   缓存：使用 Memcache 来记住一些非常常见的选择查询的输出，因此您不必经常访问磁盘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T23:17:27.990

好吧，游戏中的大玩家是甲骨文，但那是一大笔钱。

如果您想便宜，那么您将不得不以不同的方式支付价格：

*   通过跨多个实例对数据库进行分区并分配负载。
*   可能缓存结果，因此减少了实际的数据库访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T22:12:59.913

你试过postgresql吗？它应该比mysql快。但无论如何，您需要平衡多个服务器（拆分数据库）的负载。您可以拥有多个数据库（例如，每个客户端），然后一个集中式数据库将与那些小型数据库同步...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-08T13:33:57.240

在写入繁重的应用程序中快速持久地存储数据的典型方法是使用仅附加日志。如果正确部署日志文件在其自己的旋转磁盘上，则每次写入/追加操作的磁盘寻道时间最小化。

可以在每次写入后更新元数据以了解某些主键的偏移量。

有一个mysql存储引擎可以做到这一点是你要使用mysql。另一种选择是新的 nosql 数据库之一，例如fleetdb。

您是否也尝试过使用SSD？

有很多选择可以解决这个问题，但它们可能需要一些体力劳动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T23:25:16.503

用户 ---> Web 应用程序 --> 消息队列 --> 解析器 --> 数据库？

你需要消息队列做什么？这些通常是一个很大的性能问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-22T22:23:56.517

你试过[redis](http://code.google.com/p/redis/)吗？他们承诺 110000 SETs/秒、81000 GETs/秒的速度。这是一个支持列表和集合的高级键值数据库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T00:21:10.630

正如 ojrac 所说，分片和缓存。

另一种选择是退后一步，想办法用更少的查询来完成工作！从您提供的少量信息中，我不禁想到“一定有更好的方法”。从您提供的一些汇总表（带有可选缓存）的示例中可能会很容易获胜。

Hypertable 等为某些数据访问模式提供了更好的性能，但您的听起来非常适合典型的数据库。

是的，CouchDB 的速度慢得令人失望。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-22T22:41:59.110

我怀疑任何系统都会为您提供所需的开箱即用性能。您可能会开始在您所在的机器上达到硬限制（几乎任何写入密集型数据库都会很快达到 I/O 限制）。可能需要进行一些分析，但磁盘几乎总是瓶颈。更多的 RAM 会有所帮助，使用固态磁盘也是如此。

但是，无论您使用哪个实际数据库，您都可能需要某种类型的集群。您可以对数据本身进行分片，或者使用 MySQL，设置 read-slaves 将负载分散到节点上，并为您提供所需的吞吐量。

另外：MongoDB 很棒。也许值得一瞧。

# mootools - Mootools addEvent 未定义

> ID：559138
> 
> 赞同：1
> 
> 时间：2009-02-17T23:08:29.650
> 
> 标签：mootools

我正在尝试使用此代码添加锚元素并将其 onclick 事件设置为某些 Javascript。但是没有加载任何事件。通过 Firebug 查看 DOM 告诉我确实添加了 Mootools。该元素具有几乎所有的 Mootools 元素功能。但它缺少 addEvent。

```
var delete_ctl = new Element('a', 
{
    'href' : '#',
    'events' : 
    {
        'click' : function() { alert('foo'); }
    }   
});

delete_ctl.appendText('Remove');
delete_ctl.inject(root);
delete_ctl.addEvent('click', function() { alert('foo'); }); 
```

Firebug 中呈现的代码没有任何关于 onclick 事件已设置的指示。运行代码时，Firebug 报告 Javascript 错误：“addEvent is not a function”。我觉得我在这里缺少一些基本的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T17:12:32.990

你的代码在我的机器上运行良好。我收到两次关于“foo”的警报。
确保使用正确版本的 mootools。
确保 root 确实引用了 DOM 中的 HTML 元素。
确保在 DOM 完成加载（onload 或 domready 事件）后运行此代码。
祝你好运。

# java - JSP EL 评估的问题

> ID：559141
> 
> 赞同：1
> 
> 时间：2009-02-17T23:10:36.523
> 
> 标签：java, jsp, el

为什么以下不起作用：

```
<c:set var="formId" value="#${otherFormId}"/> 
```

在哪里

```
<c:set var="formId" value="# ${otherFormId}"/>
           notice the space ^ 
```

工作正常（尽管对我的目的无效）。我试图在 ${otherFormId} 前面加上 # 符号（即创建 jquery id 选择器）。

第一种形式以

```
#${otherFormId} 
```

从字面上看，在输出中。我怎样才能得到我想要的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T23:38:33.057

得到了答案。

```
#{expr} 
```

是一个表达式，其评估被延迟（与 JSF 生命周期要求有关）并作为统一 EL 的一部分引入。为了解决我的问题，您现在需要转义任何文字 #'seg

```
<c:set var="formId" value="\#${otherFormId}"/> 
```

# javascript - 当您 remove() 一个元素并在其他地方 append() 它时，jQuery 中的事件会丢失吗？

> ID：559147
> 
> 赞同：22
> 
> 时间：2009-02-17T23:11:56.113
> 
> 标签：javascript, jquery, dom, javascript-events, event-handling

当你 remove() 一个元素并 append() 它在别处时，jQuery 会发生什么？

似乎这些事件没有挂钩 - 好像您只是插入新的 html（我猜这就是发生的事情）。但我的代码也可能有错误 - 所以我只是想在继续之前验证这种行为。

如果是这种情况 - 是否有任何简单的方法可以将事件重新连接到 HTML 的那部分，或者有一种不同的方法来移动元素而不会首先丢失事件。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-03-15T12:04:04.980

jQuery *detach()函数与**remove()*相同，但在它返回的对象中保留了事件处理程序。如果您必须删除该项目并将其与所有可以使用的东西一起放置在其他地方。

```
var objectWithEvents = $('#old').detach();
$('#new').append(objectWithEvents); 
```

在此处查看 API 文档：http: [//api.jquery.com/detach/](http://api.jquery.com/detach/)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-17T23:22:47.430

是的，jQuery 的方法`remove()`是取消绑定与 jQuery 自己绑定的所有内容`bind`（以防止内存泄漏）。

但是，如果您只想在 DOM 中移动某些内容，则不必先移动`remove()`它。随心所欲`append`，事件绑定*将*继续存在:)

例如，将其粘贴到此页面上的 firebug 中：

```
$('li.wmd-button:eq(2)').click(function(){ alert('still here!') }).appendTo(document.body) 
```

现在向下滚动到此页面的底部，然后单击现在埋在 SO 页脚下的小地球图标。你会得到`alert`. 这一切都是因为我注意不要`remove`先这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T23:15:35.530

使用 jQuery1.3.1 live() 绑定事件，你不必担心这个..

更新：现在不推荐使用实时事件，但您可以从 $(document).on() 获得相同的效果。

# c# - 如何将 Trace() 添加到 C# 中的每个方法调用？

> ID：559148
> 
> 赞同：29
> 
> 时间：2009-02-17T23:12:22.090
> 
> 标签：c#, logging, trace

我很难追踪锁定问题，所以我想记录每个方法调用的进入和退出。我以前用 C++ 做过这个，而不必为每个方法添加代码。这可以用 C# 实现吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-17T23:19:39.747

最好的选择可能是使用 AOP（面向方面​​编程）框架在方法执行之前和之后自动调用跟踪代码。AOP 和 .NET 的一个流行选择是[PostSharp](http://www.postsharp.net/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-31T23:05:34.810

如果您的主要目标是记录函数入口/出口点和介于两者之间的偶尔信息，那么我使用**Disposable**记录对象取得了不错的结果，其中***构造函数跟踪函数 entry***，而***Dispose() 跟踪 exit***。这允许调用代码简单地将每个方法的代码包装在单个**using**语句中。还为中间的任意日志提供了方法。这是一个完整的 C# ETW 事件跟踪类以及一个函数进入/退出包装器：

```
using System;
using System.Diagnostics;
using System.Diagnostics.Tracing;
using System.Reflection;
using System.Runtime.CompilerServices;

namespace MyExample
{
    // This class traces function entry/exit
    // Constructor is used to automatically log function entry.
    // Dispose is used to automatically log function exit.
    // use "using(FnTraceWrap x = new FnTraceWrap()){ function code }" pattern for function entry/exit tracing
    public class FnTraceWrap : IDisposable
    {
        string methodName;
        string className;

        private bool _disposed = false;

        public FnTraceWrap()
        {
            StackFrame frame;
            MethodBase method;

            frame = new StackFrame(1);
            method = frame.GetMethod();
            this.methodName = method.Name;
            this.className = method.DeclaringType.Name;

            MyEventSourceClass.Log.TraceEnter(this.className, this.methodName);
        }

        public void TraceMessage(string format, params object[] args)
        {
            string message = String.Format(format, args);
            MyEventSourceClass.Log.TraceMessage(message);
        }

        public void Dispose()
        {
            if (!this._disposed)
            {
                this._disposed = true;
                MyEventSourceClass.Log.TraceExit(this.className, this.methodName);
            }
        }
    }

    [EventSource(Name = "MyEventSource")]
    sealed class MyEventSourceClass : EventSource
    {
        // Global singleton instance
        public static MyEventSourceClass Log = new MyEventSourceClass();

        private MyEventSourceClass()
        {
        }

        [Event(1, Opcode = EventOpcode.Info, Level = EventLevel.Informational)]
        public void TraceMessage(string message)
        {
            WriteEvent(1, message);
        }

        [Event(2, Message = "{0}({1}) - {2}: {3}", Opcode = EventOpcode.Info, Level = EventLevel.Informational)]
        public void TraceCodeLine([CallerFilePath] string filePath = "",
                                  [CallerLineNumber] int line = 0,
                                  [CallerMemberName] string memberName = "", string message = "")
        {
            WriteEvent(2, filePath, line, memberName, message);
        }

        // Function-level entry and exit tracing
        [Event(3, Message = "Entering {0}.{1}", Opcode = EventOpcode.Start, Level = EventLevel.Informational)]
        public void TraceEnter(string className, string methodName)
        {
            WriteEvent(3, className, methodName);
        }

        [Event(4, Message = "Exiting {0}.{1}", Opcode = EventOpcode.Stop, Level = EventLevel.Informational)]
        public void TraceExit(string className, string methodName)
        {
            WriteEvent(4, className, methodName);
        }
    }
} 
```

使用它的代码将如下所示：

```
public void DoWork(string foo)
{
    using (FnTraceWrap fnTrace = new FnTraceWrap())
    {
        fnTrace.TraceMessage("Doing work on {0}.", foo);
        /*
        code ...
        */
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T01:39:05.807

探查器非常适合在开发期间查看您正在运行的代码，但如果您正在寻找在生产中进行自定义跟踪的能力，那么正如 Denis G. 所提到的，[PostSharp](http://www.postsharp.org/)是一个完美的工具：您不必更改所有您的代码，您可以轻松地打开/关闭它。

它也很容易在几分钟内完成设置，PostSharp 的创建者 Gaël Fraiteur 甚至有视频向您展示了向现有应用程序添加跟踪是多么容易。
您将在[文档部分](http://www.postsharp.org/documentation)找到示例和教程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T23:15:34.483

使用Red Gate 的[ANTS Profiler](http://www.red-gate.com/Products/ants_profiler/index.htm)将是您的最佳选择。如果做不到这一点，请查看[Castle Windsor中的](http://www.castleproject.org/container/index.html)[拦截](http://www.castleproject.org/container/documentation/trunk/usersguide/interceptors.html)器。不过，这确实假设您正在通过 IoC 加载您的类型。

反射是另一种方式，您可以使用[System.Reflection.Emit](http://msdn.microsoft.com/en-us/library/system.reflection.emit.aspx)方法将代码“写入”到内存中。该代码可以替换您的方法的代码，并执行它但使用适当的日志记录。不过，祝你好运……更容易的是使用像[Aspect#](http://www.castleproject.org/aspectsharp/index.html)这样的面向方面的编程框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T14:19:25.177

它可能正在等待锁定问题发生，执行内存转储并分析各种线程上的调用堆栈。您可以使用[DebugDiag或](http://www.microsoft.com/downloads/details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en)[Windows 调试工具](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)附带的 adplus 脚本（在本例中为挂起模式）。

[Tess Ferrandez](http://blogs.msdn.com/tess/)还有一个关于学习使用 .NET 内存转储调试各种问题的[优秀实验系列。](http://blogs.msdn.com/tess/pages/net-debugging-demos-information-and-setup-instructions.aspx)我强烈推荐它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T01:27:47.113

你怎么知道它正在发生？如果这是一个多线程应用程序，我建议测试条件并在运行时检测到它时调用 System.Diagnostics.Debugger.Break()。然后，只需打开线程窗口并单步执行每个相关线程上的调用堆栈。

# javascript - 使用 window.onload 的最佳实践

> ID：559150
> 
> 赞同：40
> 
> 时间：2009-02-17T23:12:34.723
> 
> 标签：javascript, joomla, joomla1.5, onload

我开发 Joomla 网站/组件/模块和插件，并且我经常需要能够使用在页面加载时触发事件的 JavaScript。大多数情况下，这是使用该`window.onload`功能完成的。

**我的问题是：**

1.  这是在页面加载时触发 JavaScript 事件的最佳方式还是有更好/更新的方式？
2.  如果这是在页面加载时触发事件的唯一方法，那么确保多个事件可以由不同的脚本运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-17T23:15:43.593

`window.onload = function(){};`有效，但您可能已经注意到，**它只允许您指定 1 个侦听器**。

我想说更好/更新的方法是使用框架，或者只是使用本机`addEventListener`和`attachEvent`（对于 IE）方法的简单实现，这也允许您*删除*事件的侦听器。

这是一个跨浏览器的实现：

```
// Cross-browser implementation of element.addEventListener()
function listen(evnt, elem, func) {
    if (elem.addEventListener)  // W3C DOM
        elem.addEventListener(evnt,func,false);
    else if (elem.attachEvent) { // IE DOM
         var r = elem.attachEvent("on"+evnt, func);
         return r;
    }
    else window.alert('I\'m sorry Dave, I\'m afraid I can\'t do that.');
}

// Use: listen("event name", elem, func); 
```

对于 window.onload 案例使用：`listen("load", window, function() { });`

* * *

**编辑**我想通过添加其他人指出的宝贵信息来扩展我的答案。

这是关于**`DOMContentLoaded`**（Mozilla、Opera 和 webkit nightlies 目前支持此功能）和**`onreadystatechange`**（对于 IE）*事件*，它们可以应用于**文档**对象以了解何时可以操作文档（无需等待所有图像/样式表等..要加载）。

有很多跨浏览器支持的“hacky”实现，所以我强烈建议使用这个功能的框架。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-21T14:24:05.510

window.onload 事件在多次创建时被覆盖。要附加函数，请使用 window.addEventListener（W3C 标准）或 window.attachEvent（对于 IE）。使用以下有效的代码。

```
if (window.addEventListener) // W3C standard
{
  window.addEventListener('load', myFunction, false); // NB **not** 'onload'
} 
else if (window.attachEvent) // Microsoft
{
  window.attachEvent('onload', myFunction);
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-17T23:44:25.037

现代 javascript 框架引入了“文档就绪”事件的概念。这是一个在文档准备好对其执行 DOM 操作时触发的事件。“onload”事件仅在页面上的所有内容都加载后才会触发。

除了“文档就绪”事件之外，框架还提供了一种方法，可以将多个 Javascript 代码和函数排队，以便在事件触发时运行。

所以，如果你反对框架，最好的办法就是实现你自己的 document.onload 队列。

如果您不反对框架，那么您将需要研究[jQuery 和 document.ready](http://www.learningjquery.com/2006/09/introducing-document-ready)、[Prototype 和 dom:loaded](http://www.prototypejs.org/api/document/observe)、[Dojo 和 addOnLoad](http://www.oreillynet.com/onlamp/blog/2008/02/dojo_goodness_part_1_1.html)或 Google 的 [your framework] 和“document ready”。

如果您尚未选择框架但有兴趣，那么 jQuery 是一个不错的起点。它不会改变 Javascript 的任何核心功能，并且通常不会妨碍您，让您随心所欲地做事。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-24T19:17:08.090

Joomla 附带 MooTools，因此您会发现使用 MooTools 库来编写附加代码是最容易的。MooTools 附带了一个名为 domready 的自定义事件，该事件在页面加载和文档树被解析时触发。

```
window.addEvent( domready, function() { code to execute on load here } ); 
```

更多关于 MooTools 的信息可以在[这里](http://mootools.net/docs/core "MooTools 文档")找到。Joomla 1.5 目前附带 MT1.1，而 Joomla 1.6 alpha 将包括 MT1.2

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T03:26:57.687

就个人而言，我更喜欢[这种方法](http://onwebdevelopment.blogspot.com/2008/07/chaining-functions-in-javascript.html)。它不仅允许您拥有多个`onload`功能，而且如果某个脚本在您使用它**之前**已经定义了它，那么这个方法就可以很好地处理它......剩下的唯一问题是如果一个页面加载了几个不使用的脚本`window.addLoad()`函数；但这是他们的问题:)。

PS 如果您以后想“链接”更多功能，它也很棒。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-14T09:34:11.657

这是肮脏但较短的方式：P

```
function load(){
   *code*
}

window[ addEventListener ? 'addEventListener' : 'attachEvent' ]
( addEventListener ? 'load' : 'onload', function(){} ) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-23T09:16:28.630

由于我总是在文档底部包含 jQuery/bootstrap JS 文件并且无法访问`$`文档，因此我开发了一个小型“init”插件，这是我在页面顶部包含的一个也是唯一一个 JS 脚本：

```
window.init = new function() {
    var list = [];

    this.push = function(callback) {
        if (typeof window.jQuery !== "undefined") {
            callback();
        } else {
            list.push(callback);
        }
    };

    this.run = function() {

        if (typeof window.jQuery !== "undefined") {
            for(var i in list) {
                try {
                    list[i]();
                } catch (ex) {
                    console.error(ex);
                }
            }
            list = [];
        }
    };

    if (window.addEventListener) {
        window.addEventListener("load", this.run, false);
    } else if (window.attachEvent) {
        window.attachEvent("onload", this.run);
    } else {
        if (window.onload && window.onload !== this.run) {
            this.push(window.onload);
        }
        window.onload = this.run;
    }
}; 
```

使用它，我可以在页面上定义任何匿名加载器，在 jQuery 和引导程序包含之前，并确保一旦 jQuery 存在它就会触发：

```
init.push(function() {

    $('[name="date"]').datepicker({
        endDate: '0d',
        format: 'yyyy-mm-dd',
        autoclose: true
    }).on('hide', function() {
        // $.ajax
    });

    $('[name="keyword_id"]').select2();
}); 
```

# java - 如何在我的 spring bean 中获取 HttpServletRequest？

> ID：559155
> 
> 赞同：60
> 
> 时间：2009-02-17T23:13:34.113
> 
> 标签：java, apache-flex, spring, facebook

我正在开发一个带有基于 Flex 的前端和 Spring/Hibernate 后端的应用程序。

为了让 Facebook 集成以我目前的方式工作，我需要在后端读取在 javascript 中设置的 cookie，并在登录期间进行一些验证，以查看用户是否试图欺骗他的 Facebook登录。

这很容易，但我不知道如何获取 HttpServletRequest。我正在使用一个非常基本的 Spring 配置（这是我的第一个真正的 Spring 应用程序，我现在对它非常熟悉，但有很多我从未看过的东西。）

我没有使用 Spring MVC 或 Spring WebFlow 或类似的东西。我可以获得 ServletContext，但我还没有弄清楚如何获取请求。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-11-25T10:13:25.220

如果 FlexContext 不可用：

解决方案 1：内部方法（>= 需要 Spring 2.0）

```
HttpServletRequest request = 
        ((ServletRequestAttributes)RequestContextHolder.getRequestAttributes())
                .getRequest(); 
```

解决方案2：内部bean（由> = 2.5支持，需要singelton bean的Spring 3.0！）

```
@Autowired
private HttpServletRequest request; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-17T23:40:20.260

这是一种特定于 Flex/BlazeDS 的，但这是我想出的解决方案。抱歉，如果回答我自己的问题是失礼的话。

```
 HttpServletRequest request = flex.messaging.FlexContext.getHttpRequest();

    Cookie[] cookies = request.getCookies();

    for (Cookie c:cookies)
    {
        log.debug(String.format("Cookie: %s, %s, domain: %s",c.getName(), c.getValue(),c.getDomain()));
    } 
```

它有效，我得到了饼干。我的问题是寻找 Spring - BlazeDS 有它。春天可能也有，但我仍然不知道如何去做。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-11-07T16:01:32.923

@eeezyy 的回答对我不起作用，虽然我使用的是 Spring Boot (2.0.4)，它可能会有所不同，但 2018 年的一个变化是这样工作的：

```
@Autowired
private HttpServletRequest request; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-06-17T19:21:24.997

这应该这样做

```
((ServletRequestAttributes)RequestContextHolder.getRequestAttributes()).getRequest().getRequestURI(); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-02-07T12:36:42.237

`@Context`注释（参见这个问题的答案：What [does context annotation do in Spring?](https://stackoverflow.com/questions/10962696/what-does-context-annotation-do-in-spring)）将导致它为您注入。

我不得不使用

```
@Context
private HttpServletRequest request; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-10-18T23:42:20.933

更好的方法是使用构造函数自动装配：

```
private final HttpServletRequest httpServletRequest;

public ClassConstructor(HttpServletRequest httpServletRequest){
      this.httpServletRequest = httpServletRequest;
} 
```

# svn - 有没有办法让 TortoiseSVN 更像 TortoiseCVS？

> ID：559157
> 
> 赞同：2
> 
> 时间：2009-02-17T23:14:19.307
> 
> 标签：svn, version-control, tortoisesvn, cvs, tortoisecvs

我在混合源代码控制环境中工作。我们仍然主要使用 CVS，但较新的项目使用 SVN。但是，我发现很难获得 SVN 的支持，因为 TortoiseSVN 不像 TortoiseCVS 那样工作。

3 路合并有很多认知失调，虽然 TortoiseCVS 似乎总是能正确地合并，但 TortoiseSVN 几乎总是需要手动帮助。同样在修复任何冲突后，您必须手动将文件标记为正常。

有没有人有任何关于如何让 TortoiseSVN 更像 TortoiseCVS 的提示？

**编辑**

更清楚地说，我不想进行三路合并，如果可能的话，我想像 TortoiseCVS 那样进行双向合并。我知道生成的文件在 CVS 和 SVN 中是相同的，例如 Visual Studio 项目文件有两个不同的版本。这将始终以 TortoiseSVN 中的冲突结束，而不会以 TortoiseCVS 中的冲突结束。

SVN 看起来像：

```
<<<<<<< .mine
     <ApplicationRevision>22</ApplicationRevision>
=======
     <ApplicationRevision>28</ApplicationRevision>
>>>>>>> .r195290 
```

CVS 看起来像

```
<<<<<<< SomeFile.cproj
     <ApplicationRevision>22</ApplicationRevision>
=======
     <ApplicationRevision>28</ApplicationRevision>
>>>>>>> 1.121 
```

所以我应该能够得到同样的合并。此外，如果两个人在同一个文件上工作，TortoiseSVN 在更新时几乎总是会发生冲突，即使他们在不同的位置工作，TortoiseCVS 也不存在这个问题。我认为 TortoiseSVN 更加保守，并迫使您检查合并 TortoiseCVS 是假设 CVS 做对了。我想知道是否在 TortoiseSVN 的某个地方隐藏了一些选项以使其更加自由，并且还可以进行双向合并而不是三向合并。

哦，是的，我们正在使用具有合并点的 Subversion 1.5（没有这个分支基本上是无用的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T23:23:26.023

看看[BeyondCompare](http://www.scootersoftware.com/)和[Araxis Merge](http://www.araxis.com/merge/)。他们提供了将它们作为自定义合并/差异工具集成到 TortoiseSVN 的说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T21:19:35.030

冲突标记不应该与 Tortoise 本身有关，而是与 SVN 与 CVS 有关。确定文件是否冲突的是 SVN，而不是 Tortoise。我不能说为什么会这样，或者你能做些什么。应该很少吧。在接受合并方面，SVN 可能更加保守。同样，对所使用的算法并不积极，但当更改的行彼此足够接近（并且更改不同）时，它似乎将文件标记为冲突。

我认为 TortoiseMerge 实际上相当不错，所以希望我能尽我所能解释它，你可能会看到一些你以前不知道的东西。您通常有 2 个并排的窗格，然后是一个较低的窗格。下部窗格是合并的结果，冲突标记为红色，以及其他已成功合并的部分。在冲突线上，您可以右键单击并选择是否保留您的更改（如“我的”窗格中所示）、其他更改（如“他们的”窗格中所示），或者您可以接受这些的组合.

最后，我可以解释为什么*保存*合并并将*其标记为已解决*是两个独立的步骤。在 SVN 中，将某些内容标记为已解决允许再次提交。它基本上是一种故障保护，有助于防止您提交已在工具中合并并保存但仍未完成编辑/测试的文件。基本上，SVN 区分在合并工具中保存某些内容和实际解析。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T23:38:34.757

这里只是一个疯狂的猜测，但如果你在服务器上使用 CVSNT，这个观察结果可能是基于这样一个事实，即 CVSNT 在合并方面比 SVN 好得多，因为它具有“合并点”的概念。当多次从/合并到同一个分支时，这通常会导致更少的冲突。
我认为对此没有什么可以做的，至少不是以一种不引人注目的方式。

**编辑：**我的立场得到纠正。从 v1.5 开始，SVN 也有合并点。我会删除这个答案，但我想它可能对使用旧版本 SVN 的人仍然有用。

如果这不是您要说的，也许您应该再澄清一下您的问题。你确定这是关于 TortoiseSVN 和 TortoiseCVS 之间的区别，而不是 CVS(NT?) 和 SVN 之间的区别吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-01T04:58:13.277

呃，也许我错过了这个问题。如果 TortoiseCVS 做得“正确”（因为您的团队需要它完成 - 或期望它完成）......那么您为什么要选择 TortoiseSVN？

不要混淆这项技术的“目的”……在开发过程中“服务”开发团队。

（我目前正在使用两者来尝试 TortoiseSVN .. 但到目前为止我不太喜欢 SVN 中的标签/分支方法）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T05:19:57.637

我认为您的问题集中在如何更好地支持与 Windows 上的 Subversion 合并。

它可能不是您要寻找的具体内容，但我经常在 windows 下使用 Emacs 以方便在 Subversion 下进行合并。

## Windows 下的 Emacs + SVN

**EmacsW32** + **cygwin** (with *svn* ) + *psvn* emacs package + **"built-in" emacs** merge tool的组合在 windows 下运行良好。您会发现*psvn*现在是 Emacs 的标准配置，如果您没有，您可以轻松快速地下载和安装。

由于基于 Emacs 的工具集中的集成支持，我解决合并的速度比典型的同事快 5 到 10 倍。他们似乎满足于使用 TortoiseSVN + 他们最喜欢的其他编辑器并以这种方式进行处理......我已经多次提供指导他们 Emacs 功能的使用和强大功能（一旦设置好，它就会自行处理），但他们似乎更愿意坚持使用基本工具，而不是投资于提高生产力。

SVN 是一个强大的工具，如果你需要使用它，你不妨考虑花一些时间让它为你工作。

大卫

# language-agnostic - 开发简单的序列号生成器/验证器的好方法是什么？

> ID：559163
> 
> 赞同：8
> 
> 时间：2009-02-17T23:15:55.857
> 
> 标签：language-agnostic, license-key

我正在开发一款我想在某天销售的应用程序——早晚好！我想开发一个相当简单的序列号方案来保护它。

*   长度不超过 25-30 个字母数字字符的简单数字/字母组合（想想 Microsoft 产品密钥）
*   不需要用户输入任何个人信息（如电子邮件地址）作为验证的一部分

我一直在考虑这个（很少），我认为公钥密码学是一个很好的起点。我可以生成一个标识许可证的字符串（如 SKU + 普通 ole' 整数序列号），对其进行散列、加密，并将序列号 + 标识符编码为 25 位（左右）字母数字密钥。然后，应用程序会将密钥解码为序列号和“签名”，生成标识符散列，使用相应的公钥解密“签名”，并将其与生成的标识符散列进行比较。

本质上，产品密钥包含两个数据：用户声称拥有的序列号以及程序可以用来验证该声明的各种签名。我不知道 25 个字母数字字符（每个编码 5 位，实际总共 120 位）是否足以满足所有这些要求。但是，它不必是加密安全的，只要代码不易被猜到就足够了。我可以接受短密钥长度和短哈希。

就实现而言，该应用程序是用用于 Mac OS X 的 Objective-C 编写的，但考虑到将代码注入 Cocoa 应用程序是多么容易，我可能会直接用 C 编写验证代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-17T23:29:42.593

我不会使用任何强密码学，因为无论如何您都必须在程序中对其进行解密，从而使密钥生成器或至少破解变得容易。

我会做以下事情 - 取一个 25 位数字。现在添加一些规则，例如： - 数字必须能被 31 整除 - 它必须以最后一个字母开头和结尾...

始终使用这些规则生成密钥。使用 20 条或更多规则（越多越好）。部署应用程序时，使用较少的规则，例如 10 来检查密钥是否有效。然后这些规则将被反汇编并用于创建 keygen。

在每次更新时启用您以前未使用的规则之一。如果规则选择正确，您将禁用大部分由 keygens 生成的密钥。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T00:03:58.203

我喜欢@bh213 的方法，但是它不会阻止在您更新序列号规则时修复密钥生成器。

在更个人的偏好上，我更喜欢基于规则集方法的密钥生成器，因为如果黑客必须修补二进制文件，那么由于黑客修补程序不好以及随之而来的你和黑客。

我的偏好是基于一个普遍的软件真理：*如果软件足够流行，它可以而且将会被黑客入侵，没有任何计划，没有巧妙的方法可以防止这种情况发生。这场战斗是在资源有限、时间有限的开发者与手头无限时间的黑客群体之间展开的。*

您的密钥生成方案实际上只是为了让诚实的客户保持诚实 - 从应付帐款中获得支票比让安全人员在密钥生成器上签字更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T00:36:12.637

由于 Redbeard 0x0A 是正确的，CD-Keys 是为了让诚实的客户保持诚实。购买您的产品只需要比找到注册机稍微简单一些。

如果您在网上销售您的产品，那么最好的方法是给他们一个包含序列号的文件。这样，连续剧可以长到您想要的长度，并且您的*付费*客户不必浪费时间输入连续剧。

串行方案可以非常简单：

1.  有一个大的序列空间（25 个字母数字大约是 10 ^(44)，但只需使用序列文件并为 10 ^(2311)的键空间执行 80 char x 16 行）
2.  选择一些规则，将有效序列号空间减少到您认为您在最疯狂的梦想中将销售的 100 倍

如果您的产品具有在线组件（例如游戏如何拥有多人在线），您可以使用加密强随机数生成器进一步减少有效序列号（选择基于规则的密钥的子集，产品使用规则检查序列，服务器使用最终的真实序列列表）。当您的产品向您的服务器请求服务时，服务器可以检查序列号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-12T09:56:45.280

[sigpipe.macromates.com](http://sigpipe.macromates.com/2004/09/05/using-openssl-for-license-keys/)上有一篇博客文章，解释了如何使用私钥/公钥加密来检查序列号。它可以验证用户和序列号是否匹配。（签名/验证）。我可能会加一些盐，只是为了确定。

由于这篇文章来自 2004 年，您应该考虑在 keylength.com 上推荐的密钥[长度](http://www.keylength.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-26T12:27:00.240

所有规则，无论是定制开发的还是基于加密的，都可以被发现和破解。考虑一下您正在为谁构建应用程序。我的许多产品都是为企业服务的，所以他们要么会购买，要么不会。他们通常不会在他们的网络上运行被黑的版本。无论如何，寻找注册机的人都不太可能购买您的产品。您只是想确保您不会惹恼您的客户，以至于他们不再想购买您的应用程序。

话虽如此，我已经为这种东西编写了一个库，以便在基于 AES 加密的应用程序中使用。我以 25 美元的价格出售它，它使用密码和盐来使您的序列号独一无二。如果您有兴趣，可以在这里找到： http: [//simpleserials.com](http://simpleserials.com)

# vb.net - 以编程方式发送带有附件的邮件无法投递

> ID：559166
> 
> 赞同：2
> 
> 时间：2009-02-17T23:16:36.790
> 
> 标签：vb.net, iis, email, smtp

我正在尝试通过智能主机（mailenable）从 iis 使用 vb.net 发送邮件，然后通过 Internet 发送邮件。当我发送没有附件的邮件时，它就很好了。当我发送以相同方式创建的带有附件的邮件时，智能主机发送电子邮件时出错。

“mailenable 远程服务器似乎失败或拒绝了邮件的内容”

正确设置了智能主机，并正确设置了反向 dns 和 MX 记录。我错过了什么？

*   .txt 和 .jpg 文件都发生 - 使用 system.net.mail.attachment(inputstream, attachmentname, mimetype) 附加
*   远程服务器拒绝它
*   智能主机正在尝试
*   使用 Outlook 将附件发送到远程服务器工作正常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T23:18:55.397

我将专注于这部分错误：

> “...拒绝了邮件的内容”

..因为您已经确认没有附件发送邮件可以正常工作。

*   现在是什么时候附身？
*   你是怎么贴上去的？
*   您是否与服务器管理员（可能是您自己）核对以查看可以通过该系统发送哪些类型的文件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T00:31:27.610

您可以使用标准 SMTP 邮件客户端发送相同的消息吗？或者，您能否使用您的代码通过不同的邮件服务器（即 Google 的 Gmail IMAP 服务器）发送相同的邮件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T23:51:04.710

请注意，许多邮件服务器会拒绝带有 .exe、.bat、.cmd 等文件（可执行文件）和包含任何此类文件的 zip 文件的附件的电子邮件。

# objective-c - 创建 Quartz Composer Style 界面

> ID：559168
> 
> 赞同：2
> 
> 时间：2009-02-17T23:17:31.700
> 
> 标签：objective-c, cocoa

我想在我的 Cocoa/Objective C(++) 应用程序中添加一个 Quartz Composer“补丁编辑器”样式的界面元素。对于不熟悉 QC 的人，补丁编辑器是补丁图的可视化表示：有效地显示每个节点及其属性，并提供鼠标驱动的选择/单击/拖动界面。看起来像... [Quartz Composer Example http://files.me.com/archgrove/ya1xhh](http://files.me.com/archgrove/ya1xhh)

我将使用它来渲染特定类型的多根树，其中每个节点都有一些关联的文本和将其连接到其子节点的弧线。用户将单击树节点以选择它们，以及拖动它们。

目前，我在滚动视图中使用自定义 NSView，Quartz 在每次渲染时绘制每个节点、弧线等，并手动处理鼠标和键盘输入（包括命中测试、移动等）。这似乎残酷地轮回了再造，并且与 Core Animation 的交互并不那么好。我希望有人有一些一般性的替代建议。我正在考虑...

*   我忽略的现有控件/第 3 方库
*   使树中的每个节点成为一个 NSView，并使用普通视图结构来处理输入，同时以相同的方式绘制图形。但是，节点间的弧形渲染似乎并不自然地融入设计
*   仍然使用单个 NSView 的东西，但是使每个树节点和弧成为一个单独的层
*   别的东西

谢邀，

亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T06:38:43.060

您可能想看看 EFLaceView：CocoaDev[上的 FlowChartView](http://www.cocoadev.com/index.pl?FlowChartView)

编辑：上面页面上的下载链接已失效。[github 上](https://github.com/danielkleinert/EFLaceView/)有一个 EFLaceView 版本。

# asp.net - 在 ASP.Net 动态数据中使用计算属性作为 DisplayColumn？

> ID：559174
> 
> 赞同：3
> 
> 时间：2009-02-17T23:19:22.460
> 
> 标签：asp.net, dynamic-data

我正在尝试在 asp.net 动态数据站点中显示“软件版本”表。Release 表的内部版本号存储为三个 int 字段（Major、Minor、Build）。我正在使用 EntityFramework，所以我有一个绑定到我的数据库模式的 EF 模型。在我的动态数据站点中，我希望版本号在显示 Release 对象的任何位置（特别是当它在相关对象的页面上显示为外键时）都显示为单个字段 (Major.Minor.Build)。由于这个“计算列”不是我数据库中的一个字段，因此似乎没有办法让动态数据识别或显示它。我可以向 Release 对象添加一个属性（因为它是由 EF 生成的部分类），但 Dynamic-Data 无法识别它，因为它不是“列”。我想将 Release 编辑为三个单独的字段（主要、次要、构建），但是当它显示时，我希望它显示为单个字段。DynamicData 框架似乎不支持复合字段，如果它们不在 EF 模型中，它将不会显示/绑定到对象上的属性。如何使格式化的版本号属性成为默认显示值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-05T08:11:19.000

您可以像在进行任何动态数据 ui 自定义时一样添加元数据类。然后在元数据中创建一个 UIHint 来告诉动态数据为您的自定义对象使用什么控件。例如

```
[MetadataType(typeof(EMetadata))]
public partial class E{

    public string RefNR {
        get {
            return "E" + this.EntryID.ToString().PadLeft(5, '0');
        }
    }

}

public partial class EMetadata {
    [UIHint("Text")]
    public object RefNR;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T03:44:25.787

我不确定您是绑定到从数据库返回的 DataTable/DataSet，还是绑定到 Release 对象本身。也不是哪种控制。

如果要绑定到 DataSet/DataTable，只需更改 SQL 以将版本作为一个字段返回：

```
SELECT table1.Major + '.' + table1.Minor + '.' + table1.Build AS Version .... 
```

但是，如果您要绑定到一个对象，例如 DropDownList，我**认为**如果您覆盖 ToString 方法，它将成为 DropDownList 中的 Display 值：

```
Public Overrides Function ToString() As String
    Return _major.ToString & '.' & _minor.ToString & '.' & _build.ToString
End Sub 
```

# c++ - 链接到 gcc 中的增强正则表达式

> ID：559179
> 
> 赞同：7
> 
> 时间：2009-02-17T23:21:08.697
> 
> 标签：c++, regex, boost, linker, boost-regex

我正在尝试编译我在 linux 上使用正则表达式的程序。我通过键入 make -fgcc.mak 在 libs/regex/build 中构建了 boost 库，它创建了一个包含以下四个文件的目录 gcc

```
boost_regex-gcc-1_35
boost_regex-gcc-d-1_35
libboost_regex-gcc-1_35.a
libboost_regex-gcc-d-1_35.a 
```

现在我想使用我的程序中的正则表达式，它位于某个任意目录中。我#included boost/regex.hpp

我收到错误消息，指出找不到 regex.hpp。然后我在 g++ 编译器中给出了 -I 选项。我没有得到那个错误。但我收到以下错误

```
undefined reference to `boost::re_detail::perl_matcher<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<boost::sub_match<__gnu_cxx::__normal_iterator<char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, boost::regex_traits<char, boost::cpp_regex_traits<char> > >::construct_init(boost::basic_regex<char, boost::regex_traits<char, boost::cpp_regex_traits<char> > > const&, boost::regex_constants::_match_flags)' 
```

我用谷歌搜索，发现我需要以某种方式将上述 4 个库之一链接到我的程序。我该怎么做。我应该链接哪一个，为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T23:27:41.117

`libboost_regex-gcc-1_35.a`在链接步骤中添加到目标文件列表或添加到相同的列表中`-static -lboost_regex-gcc-1_35`。还要确保`-I`在编译步骤中有一个指向 boost 包含目录的开关。如果库位于典型搜索路径之外（`/usr/lib`在 *nix 上），请将该目录添加到您的链接命令中，使用`-Wl,-L/path/to/boost/libs`for`g++`或简单地`-L/path/to/boost/libs`on `ld`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-27T14:10:42.777

在使用 boost 文件系统时，我也遇到了类似的问题。这是我需要做的让它静态链接。

摘自我的原始（有问题的）Makefile：LIBS = -static -lboost_filesystem

解决方案：LIBS = -Wl,-Bstatic -lboost_filesystem -lboost_system -Wl,-Bdynamic

[您可以从http://code.google.com/p/neptuner/source/browse/codebase/trunk/stratego/uboat/Makefile](http://code.google.com/p/neptuner/source/browse/codebase/trunk/stratego/uboat/Makefile)查看完整的 Makefile

需要添加 boost_system 以使其正确链接。直接添加/指定 libboost*.a 会产生更多问题。注意 -Bdynamic 的存在是为了防止标准库的静态链接。

# .htaccess - PHP 重写规则

> ID：559186
> 
> 赞同：8
> 
> 时间：2009-02-17T23:25:00.933
> 
> 标签：.htaccess, mod-rewrite

我的应用程序使用的实际 URL 是：

```
http://site.com/search.php?search=iPhone 
```

但我希望有可能达到同样的效果

```
http://site.com/iPhone 
```

我没有重写规则的经验，我该如何设置？

该解决方案已经奏效，但新的 URL 显示在地址栏中。我认为可以进行设置，使其看起来好像页面位置是

`http://site.com/iPhone`

无需更改为显示

```
http://site.com/search.php?search=iPhone 
```

这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-17T23:28:05.343

在您网站的根目录中创建一个名为 .htaccess 的文件并将其放入其中。

```
RewriteEngine on 
Options +FollowSymlinks
RewriteBase / 

RewriteRule ^(.*) search.php?search=$1 [R] 
```

应该做的伎俩。

但是，我建议您将其做得更具体一些，因此可能需要在您的 url 中使用搜索目录的用户。例如，而不是 mysite.com/IPhone 使用 mysite.com/search/IPhone 可以像

```
RewriteEngine on 
Options +FollowSymlinks
RewriteBase / 

RewriteRule ^search/(.*) search.php?search=$1 [R] 
```

这使得重定向的普通页面更容易，例如关于我们或基本主页。

正如 Chris 所说，这不是 PHP 而是 Apache 执行此操作，它是否有效取决于您的托管设置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T23:27:55.123

您需要在 .htaccess 文件中指定类似的内容：

```
RewriteEngine on
RewriteRule /(.*) /search.php?search=$1 
```

还要检查：

*   [mod_rewrite：URL 重写初学者指南](http://www.sitepoint.com/article/guide-url-rewriting/)
*   [模块 mod_rewrite，URL 重写引擎](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T23:30:48.597

据我所知，重写规则不是 PHP 的一部分，而是 Apache（特别是`mod_rewrite`）或您正在使用的任何服务器。对于 Apache，您需要在服务器上有一个名为 的文件`.htaccess`，并在其中放入如下内容：

```
RewriteEngine on
RewriteRule ^(\w+)/?$ /index.php?search=$1 
```

`^(\w+)/?$`是一个正则表达式 - 它匹配任何 1 个或多个字符的单词，后跟一个`/`可能。所以它`site.com/iPhone`变成`site.com/index.php?search=iPhone`. 听起来对吗？

# c# - MVC RC 验证：对吗？

> ID：559189
> 
> 赞同：4
> 
> 时间：2009-02-17T23:26:10.637
> 
> 标签：c#, asp.net-mvc, validation, binding, html-helper

我只是想在 MVC RC 中做一些简单的验证，但遇到了错误。出于这个问题的目的，我**没有使用 UpdateModel**。

这是表单中的代码：

```
<%= Html.TextBox("UserId")%>
<%= Html.ValidationMessage("UserId") %> 
```

如果我在控制器中添加以下行，我将在 TextBox 上获得 NullReferenceException：

```
ModelState.AddModelError("UserId", "*"); 
```

所以为了解决这个问题，我还添加了以下行：

```
ModelState.SetModelValue("UserId", ValueProvider["UserId"]); 
```

为什么我必须重新绑定值？ **如果我添加错误，我只需要这样做**，但似乎我不应该这样做。我觉得我做错了什么，或者只是对绑定不够熟悉。

看起来我不是唯一一个看到这个的人。根据请求，这是控制器代码：

```
[AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(FormCollection collection)
    {
        AppUser newUser = new AppUser();

        try
        {
            newUser.UserId = collection["UserId"];

            AppUserDAL.AddUser(newUser);

            return RedirectToAction("Index");
        }
        catch (Exception ex)
        {
            ViewData["ReturnMessage"] = ex.Message;

            ModelState.AddModelError("UserId", "*");
            ModelState.SetModelValue("UserId", ValueProvider["UserId"]);

            return View(newUser);
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T22:04:30.277

调用此扩展方法：

```
 public static void AddModelError (this ModelStateDictionary modelState, string key, string errorMessage, string attemptedValue) {
        modelState.AddModelError (key, errorMessage);
        modelState.SetModelValue (key, new ValueProviderResult (attemptedValue, attemptedValue, null));
    } 
```

来自：[AddModelError() / SetModelValue 与 MVC RC1 的问题](http://www.crankingoutcode.com/2009/02/01/IssuesWithAddModelErrorSetModelValueWithMVCRC1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T06:11:19.600

您绝对不需要调用 SetModelValue。

也许您只需要您的视图从您传入的模型中提取文本框？

```
<%= Html.TextBox("UserId", Model.UserId)%> 
```

我就是这样做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T16:21:02.410

您可以尝试使用此扩展来使用 lambda 表达式设置模型值：

```
 /// <summary>
    /// Sets model value.
    /// </summary>
    /// <typeparam name="TViewModel">The type of the view model.</typeparam>
    /// <typeparam name="TProperty">The type of the property</typeparam>
    /// <param name="me">Me.</param>
    /// <param name="lambdaExpression">The lambda expression.</param>
    ///<param name="value">New Value</param>
    public static void SetModelValue<TViewModel, TProperty>(
        this ModelStateDictionary me,
        Expression<Func<TViewModel, TProperty>> lambdaExpression,
        object value)
    {

        string key = WebControlsExtensions.GetIdFor<TViewModel, TProperty>(lambdaExpression, ".");

        if (!string.IsNullOrWhiteSpace(key))
        {
            me.SetModelValue(key, new ValueProviderResult(value, String.Empty, System.Globalization.CultureInfo.InvariantCulture));
        }
    } 
```

要获取 id：

```
public static class WebControlsExtensions
{

    /// <summary>
    /// Devuelve el Id correspondiente a la expresión lambda pasada por parámetro reemplazando los caracteres inválidos por la cadena pasada por parámetro
    /// </summary>
    /// <typeparam name="TViewModel">El tipo del modelo</typeparam>
    /// <typeparam name="TProperty">El tipo de la propiedad</typeparam>
    /// <param name="expression">Expresión lambda</param>
    /// <param name="invalidCharReplacement">Cadena de texto que reemplaza a los carácteres inválido</param>
    /// <remarks>
    /// Valid characters consist of letters, numbers, and the hyphen ("-"), underscore ("_"), and colon (":") characters. 
    /// All other characters are considered invalid. Each invalid character in originalId is replaced with the character specified in the HtmlHelper.IdAttributeDotReplacement property.
    /// </remarks>
    /// <returns> Devuelve el Id correspondiente a la expresión lambda</returns>
    public static string GetIdFor<TModel, TProperty>(Expression<Func<TModel, TProperty>> expression, string invalidCharReplacement)
    {
        return TagBuilder.CreateSanitizedId(ExpressionHelper.GetExpressionText(expression), invalidCharReplacement);
    }

} 
```

# .net - 我可以让 .NET 框架类实现我定义的接口吗？

> ID：559204
> 
> 赞同：3
> 
> 时间：2009-02-17T23:32:51.057
> 
> 标签：.net, interface

我想要一个 .NET 类（为了讨论，我们说 FileInfo）并让它实现我的接口。例如：

```
public interface IDeletable
{
    void Delete();
} 
```

请注意，FileInfo 确实具有 Delete() 方法，因此该接口可能有意义。

这样我就可以有这样的代码：

```
FileInfo fileinfo = ...;
DeletObject(fileInfo);

public void DeleteObject(IDeletable deletable)
{
    deletable.Delete();
} 
```

是否可以使现有类与这样的接口匹配？

*   肖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T23:34:18.603

没有。您需要[适配器模式](http://en.wikipedia.org/wiki/Wrapper_pattern)。这为您提供了一个实现所需接口的类，并为您“调整”框架类接口。这意味着您的界面设计甚至不必与框架类的界面完全匹配。

正如 Marc Gravell 在另一个答案中指出的那样，您也许可以作弊并使用[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T23:35:11.567

你不能，基本上。不是为了`Delete`（因为它已经存在），但一般来说：C# 3.0 的一个选项是扩展方法：

```
public static void SomeMethod(this FileInfo file)
{ ... your code ... } 
```

现在您可以使用：

```
FileInfo file = ...
file.SomeMethod(); 
```

但是这里没有接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T23:48:40.830

正如@Neil Barnwell 所说，适配器是要走的路。但是请注意，接口不应该以这种方式使用，尽管它可能会派上用场，但您至少应该仔细考虑一下。

看，接口不是双射函数，它们旨在提供一组“规则”来定义对象能够做什么，但是它们应该使用它们的顺序是首先定义它们来描述您的应用程序设计（或您需要的任何东西）然后使用它，而不是相反。或者换句话说，接口在您的应用程序的上下文中定义了一种行为，该行为可能会或可能不会与 .NET 框架的预期用途发生冲突。

这意味着，对于您“适应”的每个类，您不仅要确保它遵循接口的语法（相同的方法名称、相同的参数）**，而且还要确保它遵循接口的精神。**

例如，我可以有一个带有 Dispose 方法的类...这并不一定意味着它实现了 IDisposable ...也许不是因为我的 Dispose 方法可以引发异常，或者在给定时间内阻塞，所以虽然履行合同不履行精神。

现在，这也可能发生在您的应用程序中，但发生的可能性要小得多，因为您知道接口，所以您很自然地坚持它的精神……但是.NET 框架开发人员怎么能做到这一点呢？

# javascript - IE 中的 Javascript 语法错误

> ID：559207
> 
> 赞同：5
> 
> 时间：2009-02-17T23:33:28.607
> 
> 标签：javascript, debugging, internet-explorer

我已经创建了一个相当大的 Javascript 应用程序，它可以在 Firefox 和直到昨天的 IE 中运行。我做了很多更改，现在在 IE 中出现语法错误，但在 Firefox 中一切正常。显然我在某处有一个尾随逗号，但我看不到它。IE 的错误信息没有什么帮助，甚至没有告诉我哪个 JS 文件有错误。

是否有 Javascript 的语法检查器可以更详细地通知我此类错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T23:40:27.857

[http://www.jslint.com/](http://www.jslint.com/)将捕获那些逗号和分号问题。

例子：

```
Error:
    Problem at line 1 character 17: Extra comma.

var foo = ['bar',]

    Problem at line 1 character 19: Missing semicolon.

var foo = ['bar',] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T23:39:52.583

JS lint -> [http://jslint.com/](http://jslint.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T02:42:56.747

我会在 IE8rc1 中尝试一下。新的调试工具与 Firebug 相去甚远，但它们应该能准确地告诉您在这种情况下问题出在哪里。

# .net - .NET 中的轻量级线程池库

> ID：559209
> 
> 赞同：6
> 
> 时间：2009-02-17T23:34:26.700
> 
> 标签：.net, multithreading, http

我正在寻找 .NET 中的线程池库

*   我应该能够推送大约 100.000 个任务，因此应该为 "blocking" 提供支持。（*显然我不能一次推送这么多任务，所以在添加新任务时应该支持一些阻塞，并且应该阻塞线程直到有新插槽可用*）
*   不会太复杂
*   没那么贵（内存 - CPU 方面）
*   免费/开源（商业友好许可证）

我已经有了自己的解决方案来支持所有这些，但我不太确定它是否是最好的实现。所以我想看看其他图书馆。

这将主要用于 HTTP 请求，因此更少的 CPU 更多的响应等待。这意味着 100 个并发线程是可以接受的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T00:05:27.703

我最近看到的最好的是 Jeffery Richter 的[PowerThreading 库](http://www.wintellect.com/PowerThreading.aspx)。您可能还想查看[此第 9 频道视频](http://channel9.msdn.com/posts/Charles/Jeffrey-Richter-and-his-AsyncEnumerator/)

PowerThreading 库的好处在于它通过允许在多个请求之间共享单个线程来有效地使用 ThreadPool。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T23:39:54.423

为什么不直接使用 .NET ThreadPool？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T01:55:49.420

[Retlang](http://code.google.com/p/retlang/)摇滚！或者来自 Ayende 的[Rhino Queues 。](http://ayende.com/Blog/archive/2008/08/01/Rhino-Queues.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T10:13:24.823

查看 Microsoft 的[CCR](http://msdn.microsoft.com/en-us/library/bb648752.aspx)。它有一个非常高效的线程池和原语，可以直接处理许多悬而未决的异步 I/O 请求。

在它的模型下，如果你的 I/O 是真正异步的，那么你需要的线程数就是你机器上的内核数。再多一点都是浪费。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T23:40:55.327

如果您有这么多任务，请考虑实施[服务总线](http://en.wikipedia.org/wiki/Enterprise_service_bus)或第三方中间件平台，例如 BizTalk。如果这太多了，那么简单的[Message Queuing](http://www.microsoft.com/windowsserver2003/technologies/msmq/default.mspx)。

此外，如果您拥有 SQL Server 并希望更轻松地备份和管理队列，请考虑使用[SQL Server Service Broker](http://msdn.microsoft.com/en-us/library/ms166043(SQL.90).aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T12:22:59.113

我和你有同样的必要性，但我的问题以不同的方式表达，以获得非常相似的答案： [有没有办法多次执行一个方法，但管理连接/线程？（。网）](https://stackoverflow.com/questions/484511/is-there-any-way-for-executing-a-method-multiple-times-but-managing-connections)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T15:35:21.990

.Net 4.0 正在添加将对此有直接支持的任务并行库。如果您不知道，它既可以作为基于 .Net 3.5 的独立 CTP 使用，也可以作为去年秋天推出的 Visual Studio 2010 CTP 的一部分使用。这是 [团队博客](http://blogs.msdn.com/pfxteam)的链接，其中包含更多信息和下载指针。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T01:28:19.937

我在 CodeProject 上发现了这个人对 ThreadPool的[有趣看法。](http://www.codeproject.com/KB/threads/smartthreadpool.aspx)它是一个实例化的 ThreadPool（因此，不是静态的和跨线程的），它有几个特性来定制性能。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T12:00:04.963

感谢所有回复，在浏览了其他库之后，我注意到它们对于我正在寻找的东西来说都过于复杂了。

I stick with my own implementation which is basically a blocking queue implementation around `Threading.Thread()` and it works just fine.

# ruby-on-rails - Rails 中的每个域页面缓存

> ID：559212
> 
> 赞同：2
> 
> 时间：2009-02-17T23:35:28.257
> 
> 标签：ruby-on-rails, caching

我有一个托管多个帐户的应用程序，每个帐户都映射到自己的域。

我想为每个帐户定义不同的页面缓存目录。

我在我的应用程序控制器中有这个（过滤器之前）：

```
self.page_cache_directory = RAILS_ROOT+"/public/cache/" + @account.name 
```

但这似乎不对，因为它有效地覆盖了 ActionController::Base 的 page_cache_directory 变量（它是一个 cattr_accessor），这是并发请求的问题。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T02:28:39.933

在您的应用控制器中尝试：

```
def the_before_filter
  @account = Account.find(...)
  (class << self; self; end).instance_eval { define_method :cache_page do |content, path|
     super content, @account.name + path
  end
  }
end 
```

资源：

[http://whytheluckystiff.net/articles/seeingMetaclassesClearly.html](http://whytheluckystiff.net/articles/seeingMetaclassesClearly.html)

[http://blog.jayfields.com/2007/10/ruby-defining-class-methods.html](http://blog.jayfields.com/2007/10/ruby-defining-class-methods.html)

# sql-server - 获取性能统计信息的 SQL 命令

> ID：559215
> 
> 赞同：4
> 
> 时间：2009-02-17T23:36:29.457
> 
> 标签：sql-server, performance, statistics, monitoring

是否有可用于从 MS SQL 2005 中提取性能监控数据的 SQL 命令，例如：

*   每秒事务数
*   页面读/写
*   连接数（@@CONNECTIONS 给出总数，但电流呢）
*   物理读取
*   锁和块
*   其他可能有趣的计数器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T23:49:28.067

您想查看随 SQL 2005 引入的动态管理视图 (DMV)。

这是来自 MS 的一个非常棒的文档，它为您提供了有关如何使用 DMV 解决性能问题的概述：

[http://download.microsoft.com/download/1/3/4/134644fd-05ad-4ee8-8b5a-0aed1c18a31e/TShootPerfProbs.doc](http://download.microsoft.com/download/1/3/4/134644fd-05ad-4ee8-8b5a-0aed1c18a31e/TShootPerfProbs.doc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T00:16:41.060

查看 SqlServer 内部情况的最佳方法是使用Windows 内置的[性能监视器，单击管理工具 -> 性能。](http://www.databasejournal.com/features/mssql/article.php/3506526/SQL-Server-Performance-Monitor.htm)如果您在启动它之前没有使用过它，然后单击窗口中心顶部的 + 图标，将打开一个对话框，其中包含 100 种不同的度量，您可以随后绘制、观察或记录这些度量。

SQL Server 有[大量的计数器可供](http://www.windowsitlibrary.com/Content/77/15/1.html)您查看，所有数据的含义当然是另一个问题。此解决方案不与 TSQL 或 Management Studio 集成，但它是找出正在发生的事情的最佳方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T09:06:34.657

Brent Ozar 的网站是学习如何调整 SQL Server 性能的好地方。

它包括如何使用性能监视器、DMV 以及如何进行数据挖掘和解释结果的详细信息。

[http://www.brentozar.com/sql-server-performance-tuning/](http://www.brentozar.com/sql-server-performance-tuning/)

# build-process - 你对非递归make有什么经验？

> ID：559216
> 
> 赞同：63
> 
> 时间：2009-02-17T23:36:42.450
> 
> 标签：build-process, makefile

几年前，我阅读了[Recursive Make Considered Harmful](http://aegis.sourceforge.net/auug97.pdf)论文，并在我自己的构建过程中实现了这个想法。最近，我阅读了另一篇关于如何[实现非递归`make`](http://sites.e-advies.nl/nonrecursive-make.html)的想法的文章。所以我有一些数据点，非递归`make`至少适用于几个项目。

但我很好奇别人的经历。你试过非递归`make`吗？它让事情变得更好还是更糟？值得花时间吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-18T18:55:15.397

我们在我工作的公司中使用非递归 GNU Make 系统。它基于米勒的论文，尤其是您提供的“实现非递归生成”链接。我们已经设法将卑尔根的代码细化为一个系统，其中子目录 makefile 中根本没有样板。总的来说，它运行良好，并且比我们以前的系统（使用 GNU Automake 完成的递归操作）要好得多。

我们支持所有“主要”操作系统（商业上）：AIX、HP-UX、Linux、OS X、Solaris、Windows，甚至是 AS/400 大型机。我们为所有这些系统编译相同的代码，将平台相关部分隔离到库中。

我们的树中有超过 200 万行 C 代码，大约有 2000 个子目录和 20000 个文件。我们认真考虑过使用 SCons，但无法让它运行得足够快。在较慢的系统上，Python 将使用几十秒来解析 SCons 文件，而 GNU Make 在大约一秒钟内完成了同样的事情。这是大约三年前的事了，所以从那时起情况可能已经发生了变化。请注意，我们通常将源代码保存在 NFS/CIFS 共享上，并在多个平台上构建*相同的代码。*这意味着构建工具扫描源代码树的更改甚至更慢。

我们的非递归 GNU Make 系统并非没有问题。以下是您可能会遇到的一些最大障碍：

*   使其可移植，尤其是 Windows，需要大量的工作。
*   虽然 GNU Make 几乎是一种可用的函数式编程语言，但它不适合大型编程。特别是，没有名称空间、模块或类似的东西可以帮助您将各个部分相互隔离。这可能会导致问题，尽管没有您想象的那么多。

对我们旧的递归 makefile 系统的主要胜利是：

*   它**很快**。检查整个树（2k 个目录，20k 个文件）并确定它是最新的还是开始编译大约需要两秒钟。旧的递归事情需要一分钟多的时间才能什么都不做。
*   它正确处理依赖关系。我们的旧系统依赖于构建子目录的顺序等。就像您阅读 Miller 的论文所期望的那样，将整个树视为一个实体确实是解决这个问题的正确方法。
*   在我们倾注了所有辛勤工作之后，它可以移植到我们所有支持的系统中。它太酷了。
*   抽象系统允许我们编写非常简洁的 makefile。只定义一个库的典型子目录只有两行。一行给出了库的名称，另一行列出了该库所依赖的库。

关于上面列表中的最后一项。我们最终在构建系统中实现了一种宏扩展工具。子目录 makefiles 列出程序、子目录、库和变量中的其他常见事物，如 PROGRAMS、SUBDIRS、LIBS。然后这些中的每一个都被扩展为“真正的”GNU Make 规则。这使我们能够避免很多命名空间问题。例如，在我们的系统中，可以有多个同名的源文件，这没有问题。

无论如何，这最终是很多工作。如果你可以让 SCons 或类似的代码为你的代码工作，我建议你先看看。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-08-29T21:24:42.033

在阅读了 RMCH 论文之后，我开始着手为我当时正在从事的一个小项目编写一个适当的非递归 Makefile。完成后，我意识到应该可以创建一个通用的 Makefile “框架”，它可以用来非常简单和简洁地告诉 make 你想构建什么最终目标，它们是什么类型的目标（例如库或可执行文件) 以及应该编译哪些源文件来制作它们。

经过几次迭代后，我最终创建了一个样板 Makefile，它包含大约 150 行 GNU Make 语法，不需要任何修改——它只适用于我想使用的任何类型的项目，并且足够灵活，可以构建具有足够粒度的不同类型的多个目标，可以为每个源文件（如果我想要的话）指定精确的编译标志，并为每个可执行文件指定精确的链接器标志。对于每个项目，我需要做的就是为它提供小的、单独的 Makefile，其中包含与此类似的位：

```
TARGET := foo

TGT_LDLIBS := -lbar

SOURCES := foo.c baz.cpp

SRC_CFLAGS   := -std=c99
SRC_CXXFLAGS := -fstrict-aliasing
SRC_INCDIRS  := inc /usr/local/include/bar 
```

像上面这样的项目 Makefile 将完全符合您的期望：构建一个名为“foo”的可执行文件，编译 foo.c（使用 CFLAGS=-std=c99）和 baz.cpp（使用 CXXFLAGS=-fstrict-aliasing）并将“./inc”和“/usr/local/include/bar”添加到`#include`搜索路径，最终链接包括“libbar”库。它还会注意到有一个 C++ 源文件并且知道使用 C++ 链接器而不是 C 链接器。该框架允许我指定比这个简单示例中显示的更多的内容。

样板 Makefile 执行构建指定目标所需的所有规则构建和自动依赖生成。所有构建生成的文件都放置在单独的输出目录层次结构中，因此它们不会与源文件混合（并且这是在不使用 VPATH 的情况下完成的，因此拥有多个具有相同名称的源文件没有问题）。

我现在（重新）在我从事过的至少两打不同的项目中使用了相同的 Makefile。我最喜欢这个系统的一些东西（除了为任何新项目创建*适当的*Makefile 是多么容易）是：

*   它*很快*。它几乎可以立即判断是否有任何内容过时。
*   100% 可靠的依赖关系。并行构建神秘中断的可能性为零，并且它始终构建使所有内容恢复最新所需的最低要求*。*
*   我*再也*不需要重写一个完整的makefile了：D

最后我只想提一下，由于递归生成中固有的问题，我认为我不可能完成这个任务。我可能注定要一遍又一遍地重写有缺陷的makefile，徒劳地尝试创建一个实际上可以正常工作的makefile。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-18T16:07:55.673

让我强调一下 Miller 论文的一个论点：当您开始手动解决不同模块之间的依赖关系并且难以确保构建顺序时，您实际上是在重新实现构建系统首先要解决的逻辑。**构建可靠的递归 make 构建系统非常困难。**现实生活中的项目有许多相互依赖的部分，它们的构建顺序很难弄清楚，因此，这个任务应该留给构建系统。但是，只有拥有系统的全局知识，它才能解决该问题。

此外，当在多个处理器/内核上同时构建时，递归 make 构建系统很容易崩溃。虽然这些构建系统似乎可以在单个处理器上可靠地工作，但在您开始并行构建项目之前，许多缺失的依赖项都不会被发现。我使用了一个递归的 make 构建系统，该系统最多可以在四个处理器上运行，但突然在具有两个四核的机器上崩溃了。然后我面临另一个问题：这些**并发问题**几乎无法调试，我最终绘制了整个系统的流程图以找出问题所在。

回到您的问题，我发现很难想出为什么要使用递归 make 的充分理由。非递归 GNU Make 构建系统的运行时性能难以超越，相反，许多递归 make 系统存在严重的性能问题（弱并行构建支持又是问题的一部分）。在一篇[论文](http://www.genode-labs.com/publications/scons-vs-make-2008.pdf)中，我评估了一个特定的（递归的）Make 构建系统，并将其与 SCons 端口进行了比较。性能结果不具有代表性，因为构建系统非常不标准，但在这种特殊情况下，SCons 端口实际上更快。

底线：如果您真的想使用 Make 来控制您的软件构建，请选择非递归 Make，因为从长远来看，它会让您的生活更轻松。就个人而言，出于可用性原因，我宁愿使用 SCons（或 Rake - 基本上任何使用现代脚本语言并具有隐式依赖支持的构建系统）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-18T07:53:23.803

我在之前的工作中半心半意地尝试使构建系统（基于 GNU make）完全非递归，但我遇到了一些问题：

*   工件（即构建的库和可执行文件）的源代码分布在多个目录中，依靠 vpath 找到它们
*   不同目录下存在多个同名源文件
*   多个源文件在工件之间共享，通常使用不同的编译器标志编译
*   不同的工件通常有不同的编译器标志、优化设置等。

GNU make 的一项简化非递归使用的特性是**特定于目标的变量值**：

```
foo: FOO=banana
bar: FOO=orange 
```

这意味着在构建目标 "foo" 时，$(FOO) 将扩展为 "banana"，但在构建目标 "bar" 时，$(FOO) 将扩展为 "orange"。

这样做的一个限制是不可能有特定于目标的 VPATH 定义，即无法为每个目标单独定义唯一的 VPATH。这在我们的案例中是必要的，以便找到正确的源文件。

为了支持非递归性，GNU make 缺少的主要特性是它缺少**名称空间**。特定于目标的变量可以以有限的方式用于“模拟”命名空间，但您真正需要的是能够使用本地范围在子目录中包含 Makefile。

编辑：在这种情况下，GNU make 的另一个非常有用（并且经常未充分使用）的特性是宏扩展工具（例如，参见[eval](http://www.gnu.org/software/make/manual/html_node/Eval-Function.html#Eval-Function)函数）。当您有多个目标具有相似的规则/目标，但在使用常规 GNU make 语法无法表达的方式上有所不同时，这非常有用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-07-30T13:35:40.267

我同意参考文章中的陈述，但是我花了很长时间才找到一个可以完成所有这些并且仍然易于使用的好模板。

目前我正在做一个小型研究项目，我正在尝试持续集成；自动在 pc 上进行单元测试，然后在（嵌入式）目标上运行系统测试。这在制作中并不简单，我已经寻找了一个好的解决方案。[发现 make 对于可移植的多平台构建仍然是一个不错的选择 我终于在http://code.google.com/p/nonrec-make](http://code.google.com/p/nonrec-make)找到了一个很好的起点

这是一种真正的解脱。现在我的makefile是

*   修改非常简单（即使制作知识有限）
*   快速编译
*   毫不费力地完全检查（.h）依赖关系

我当然也会将它用于下一个（大）项目（假设 C/C++）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-18T01:55:45.767

我知道至少有一个大型项目 ( [ROOT](http://root.cern.ch/) )，它[使用 [powerpoint link] 进行广告宣传](http://www-root.fnal.gov/root2001/presentations/session1/WhatElse.ppt)，其中描述了 Recursive Make Considered Harmful 中描述的机制。该框架超过一百万行代码并且编译非常智能。

* * *

当然，我使用的所有使用递归 make 的大型项目*的*编译速度都非常缓慢。：：叹：：

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-12-10T05:28:55.107

我为一个中型 C++ 项目开发了一个非递归 make 系统，该系统旨在用于类 unix 系统（包括 mac）。该项目中的代码全部位于以 src/ 目录为根的目录树中。我想编写一个非递归系统，在该系统中，可以从顶级 src/ 目录的任何子目录中键入“make all”，以便编译以工作目录为根的目录树中的所有源文件，如在递归make系统中。因为我的解决方案似乎与我看到的其他解决方案略有不同，所以我想在这里描述一下，看看我是否有任何反应。

我的解决方案的主要内容如下：

1) src/ 树中的每个目录都有一个名为 sources.mk 的文件。每个这样的文件都定义了一个 makefile 变量，该变量列出了以该目录为根的树中的所有源文件。该变量的名称格式为 [directory]_SRCS，其中 [directory] ​​表示从顶级 src/ 目录到该目录的路径的规范化形式，反斜杠替换为下划线。例如，文件 src/util/param/sources.mk 定义了一个名为 util_param_SRCS 的变量，该变量包含 src/util/param 及其子目录中所有源文件的列表（如果有）。每个 sources.mk 文件还定义了一个名为 [directory]_OBJS 的变量，其中包含对应的目标文件 *.o 目标的列表。在包含子目录的每个目录中，sources.mk 包含来自每个子目录的 sources.mk 文件，

2) 所有路径在sources.mk 文件中表示为绝对路径，其中src/ 目录由变量$(SRC_DIR) 表示。例如，在文件 src/util/param/sources.mk 中，文件 src/util/param/Componenent.cpp 将列为 $(SRC_DIR)/util/param/Component.cpp。$(SRC_DIR) 的值未在任何 sources.mk 文件中设置。

3）每个目录还包含一个Makefile。每个 Makefile 都包含一个全局配置文件，该文件将变量 $(SRC_DIR) 的值设置为根 src/ 目录的绝对路径。我选择使用绝对路径的符号形式，因为这似乎是在多个目录中创建多个 makefile 的最简单方法，这些 makefile 将以相同的方式解释依赖项和目标的路径，同时仍允许在需要时移动整个源树, 通过更改一个文件中 $(SRC_DIR) 的值。该值由一个简单的脚本自动设置，当从 git 存储库下载或克隆包或移动整个源代码树时，指示用户运行该脚本。

4) 每个目录中的makefile 都包含该目录的sources.mk 文件。每个此类 Makefile 的“all”目标将该目录的 [directory]_OBJS 文件列为依赖项，因此需要编译该目录及其子目录中的所有源文件。

5）编译*.cpp文件的规则为每个源文件创建一个依赖文件，后缀为*.d，作为编译的副作用，如下所述：http: [//mad-scientist.net/make/ autodep.html](http://mad-scientist.net/make/autodep.html)。我选择使用 gcc 编译器生成依赖项，使用 -M 选项。即使在使用另一个编译器编译源文件时，我也使用 gcc 来生成依赖项，因为 gcc 在类 unix 系统上几乎总是可用的，并且因为这有助于标准化这部分构建系统。可以使用不同的编译器来实际编译源文件。

6) _OBJS 和 _SRCS 变量中所有文件的绝对路径的使用要求我编写一个脚本来编辑由 gcc 生成的依赖文件，它会创建具有相对路径的文件。我为此编写了一个 python 脚本，但其他人可能使用过 sed。生成的依赖文件中的依赖路径是文字绝对路径。在这种情况下这很好，因为依赖文件（与 sources.mk 文件不同）是在本地生成的，而不是作为包的一部分分发的。

7) 每个director 中的Makefile 包含来自同一目录的sources.mk 文件，并包含一行“-include $([directory]_OBJS:.o=.d)”，它试图为每个源文件包含一个依赖文件在目录及其子目录中，如上面给出的 URL 中所述。

我见过的允许从任何目录调用“make all”的其他方案之间的主要区别是使用绝对路径以允许在从不同目录调用 Make 时一致地解释相同的路径。只要这些路径使用一个变量来表示顶级源目录，这不会阻止移动源树，并且比实现相同目标的一些替代方法更简单。

目前，我的这个项目的系统总是进行“就地”构建：编译每个源文件生成的目标文件与源文件放在同一目录中。通过更改编辑 gcc 依赖文件的脚本以将 src/ 目录的绝对路径替换为代表表达式中构建目录的变量 $(BUILD_DIR) 来启用异地构建将很简单规则中的目标文件目标为每个目标文件。

到目前为止，我发现这个系统易于使用和维护。所需的 makefile 片段很短，并且对于合作者来说比较容易理解。

我开发这个系统的项目是用完全独立的 ANSI C++ 编写的，没有外部依赖。我认为这种自制的非递归 makefile 系统对于自包含、高度可移植的代码来说是一个合理的选择。但是，对于任何对外部程序或库或非标准操作系统功能具有重要依赖性的项目，我会考虑使用更强大的构建系统，例如 CMake 或 gnu autotools。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-23T17:44:52.843

[我为一个名为Pd-extended](http://puredata.info/docs/developer/GettingPdSource)的项目编写了一个不太好的非递归 make 构建系统，从那时起，我编写了一个非常干净的模块化递归 make 构建系统。它基本上有点像包含一堆库的脚本语言。现在我也在使用 Android 的非递归系统，所以这就是我对这个主题的想法的背景。

关于两者之间的性能差异，我不能说太多，我并没有真正注意，因为完整构建实际上只在构建服务器上完成。我通常在核心语言或特定库上工作，所以我只对构建整个包的那个子集感兴趣。递归 make 技术具有使构建系统既独立又集成到更大整体的巨大优势。这对我们很重要，因为我们希望为所有库使用一个构建系统，无论它们是集成在外部作者中还是由外部作者编写。

我现在正在构建自定义版本的 Android 内部结构，例如基于 SQLCipher 加密 sqlite 的 Android 的 SQLite 类版本。所以我必须编写非递归的 Android.mk 文件来包装各种奇怪的构建系统，比如 sqlite 的。我无法弄清楚如何让 Android.mk 执行任意脚本，而根据我的经验，这在传统的递归 make 系统中会很容易。

# .net - 集合、数组和列表的 VB.NET 对象问题

> ID：559217
> 
> 赞同：2
> 
> 时间：2009-02-17T23:36:50.923
> 
> 标签：.net, vb.net, arrays, collections, object

我有一个小程序，我一直在尝试创建我创建的特定对象的集合（作业）。

无论我使用的是数组、集合还是列表，每次我将对象的新实例添加到数组/集合/列表时，它都会用相同的对象覆盖所有以前的项目。

例如，假设 Job 只有一个属性，name。如果我要在集合中包含名称为 1、2、3、4 的作业，则每次添加单个作业时，所有以前的作业都会获得当前作业的名称。因此，当我添加作业 4 时，所有作业的名称都为 4。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T23:39:33.910

我怀疑您多次添加相同的实例 - 即（我将在此处使用 C#...）

```
Job job = new Job();
job.Name = "a";
list.Add(job);
job.Name = "b";
list.Add(job); 
```

您所做的是将 2 个对同一对象的引用添加到列表中。你应该做的是：

```
Job job = new Job();
job.Name = "a";
list.Add(job);
job = new Job(); /// <<===== here
job.Name = "b";
list.Add(job); 
```

这是因为类是引用类型；您添加的只是参考。结构是值类型，并且会像您期望的那样工作，**除非**您**真的**知道自己在做什么，否则结构应该是不可变的（即一旦创建就没有可编辑的属性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T23:40:31.053

听起来好像您在将 Job 对象变量添加到列表后重用它，而不重新创建 Job 对象。列表中的所有项目都将指向该对象。

# javascript - 将变量从服务器后端传递给 javascript 的正确方法？

> ID：559222
> 
> 赞同：2
> 
> 时间：2009-02-17T23:38:15.537
> 
> 标签：javascript, standards, unobtrusive-javascript

我需要将 php 知道的变量传递给我的 javascript 代码，我想知道*正确*的方法是什么。

我已经知道我可以将其添加到页面生成中：

```
<script type="text/javascript">
var someJSVariable = <?php echo $somePHPVariable ?>
</script> 
```

但我发现这种方法比我想要的更突兀。我想知道是否有*更好*的方法来做到这一点，还是我不得不将内联 javascript 代码注入到视图脚本中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T23:47:37.090

如果它只是 1 个变量，我认为这是最好的解决方案。如果您不想将 JS 混合到您的普通视图中，请创建一个单独的视图，该视图将呈现为 .js 文件，然后在您的“真实”视图中包含指向该 .js 的链接。如果您需要性能，则需要一些智能捕捉。

如果有超过 1 个变量，例如 html 文档和服务器之间的数据交换，您可以使用 [AJAX]( [http://en.wikipedia.org/wiki/Ajax_(programming))](http://en.wikipedia.org/wiki/Ajax_(programming)))。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T23:46:12.927

我喜欢[`json_encode()`](http://www.php.net/json_encode)这种东西。

但是，是的，你被这种内联方法“卡住”了。老实说，你更喜欢这个吗？

```
$js = '<script type="text/javascript">';
$js .= "var someJSVariable = " . $somePHPVariable;
$js .= '</script>';

// some time later
echo $js; 
```

没想到。内联方法是 php 的生计。随它去吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T02:40:09.560

您始终可以向单独的 URL 发出异步请求以获取动态值。但是，当页面加载时，您将在那里受到轻微的性能损失。考虑到这一点，我会推荐您概述的内联方法。

您还可以包含另一个“js”文件，它实际上是一个 PHP 页面，它生成一堆 javascript 常量，然后您可以在您的主页中访问这些常量。

# security - 传递散列密码时有哪些安全问题？

> ID：559223
> 
> 赞同：1
> 
> 时间：2009-02-17T23:38:17.643
> 
> 标签：security, silverlight-2.0, hash

我在网页上有一个 Silverlight 控件，并希望将用户名和散列密码作为 InitParams 的一部分传递给该控件。

这样做有什么安全问题？

用户必须登录才能访问此页面。但是，我猜测浏览器可能会使用 Silverlight 控件缓存页面，这会缓存用户名和散列密码。

这让我想到了一个更具体的问题：是否有一个 HTML 元标记告诉浏览器不要缓存页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T00:14:03.173

安全性：首先考虑恶意用户可能对哈希密码的潜在用途（包括与其他存储的哈希值的比较）。

缓存：是的，有一个元标记，但除非必须，否则不要使用它；最好设置 HTTP 标头

> HTML 作者可以在文档的部分中放置描述其属性的标签。这些元标记通常用于将文档标记为不可缓存或在特定时间过期。
> 
> 元标记易于使用，但不是很有效。这是因为它们只被少数浏览器缓存（实际上读取 HTML）而不是代理缓存（几乎从不读取文档中的 HTML）。虽然将 Pragma: no-cache 元标记放入 Web 页面可能很诱人，但它不一定会使其保持新鲜。
> 
> *   来自[Web 作者和网站管理员的缓存教程（HTML 元标记和 HTTP 标头）](http://www.mnot.net/cache_docs/#META)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T00:20:34.687

如果攻击者可以获取散列密码，他可能会通过使用**[彩虹表](http://www.codinghorror.com/blog/archives/000949.html)**来反转它。彩虹表基本上是一个巨大的数据库，其中包含不超过一定大小的所有可能密码，并由它们的哈希索引。我认为这是最终的速度与空间权衡。对于最多 7 个字符的密码，仅包含小写字母和数字，彩虹表可以容纳几 GB。对于较长的密码（或具有较少字符限制的密码），所需的大小确实呈指数增长。

要击败这种攻击，您需要对**哈希值加盐**。加盐意味着您在对密码进行散列之前将随机加盐值添加到密码中。这种盐可以不加密地存储在散列旁边。由于每个密码都使用另一种随机盐进行哈希处理，因此彩虹查找表变得无用。Rainbow 表无法考虑所有可能的 salt 值，因为所需的数据库大小会随着 salt 大小呈指数增长。

即使这样，仍然可以通过蛮力找到与盐+哈希匹配的弱密码。这可以通过对密码使用一些质量控制启发式方法来解决（最小长度，混合某些字符类型，如小写/大写/数字/其他，而不仅仅是末尾的 1...）。

总而言之，我会说暴露哈希的安全风险足够大，你最好避免它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T23:45:52.990

我的问题是，控件可以用散列密码做什么？它似乎没有任何有用的目的，那么为什么将它传递给控件？

对密码进行哈希处理以使其在计算上无法恢复原始密码。因此，假设哈希正确完成，暴露它没有风险。但是，控件认为它需要散列密码这一事实让我感到怀疑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T00:08:56.697

请记住，MD5 散列已被蛮力攻击破解，因此公开散列密码并不是 100% 安全的，但在大多数情况下，这可能不是问题，特别是如果您使用一些更强大的散列算法。

# shell - Zsh：将 CGI 查询提取到关联数组

> ID：559229
> 
> 赞同：1
> 
> 时间：2009-02-17T23:39:41.523
> 
> 标签：shell, zsh

我有一个这样的 CGI 查询：'a=1&b=2&c=3'。

我想将它提取到关联数组 A 中，例如 $A[a]=1、$A[b]=2 和 $[c]=3。

我找到了这种方式，但我想找到一种更简单（更短）的方式：

```
QUERY='a=1&b=2&c=3'
typeset -a T
T=( ${(s:&:)QUERY} )
typeset -A A
A=()
for v in $T; do
    A+=( ${(s:=:)v} )
done 
```

（奖励：找到一种处理 URL 编码值的方法）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T16:27:12.973

对于感兴趣的人，此代码解析 GET 和 POST 参数并将它们存储在全局关联数组 QUERY_PARAMETERS 中。

```
function parse_query_string()
{
    local query="$1"
    local -a pairs
    pairs=( ${(s:&:)query} )
    for v in $pairs; do
        QUERY_PARAMETERS+=( ${(s:=:)v} ) # todo: handle parameters without =
    done
    for name in ${(k)QUERY_PARAMETERS}; do
        local value="$QUERY_PARAMETERS[$name]"
        QUERY_PARAMETERS[$name]="$(url_decode "$value")"
    done
}

function url_decode()
{
    setopt extendedglob
    local d=${1//\%(#b)([0-F][0-F])/\\\x$match[1]}
    d=${d//+/ }
    echo "$d"
}

parse_query_string "$QUERY_STRING"
parse_query_string "$(cat)" 
```

# sharepoint-2007 - 动态 SharePoint 导航链接

> ID：559239
> 
> 赞同：0
> 
> 时间：2009-02-17T23:42:03.810
> 
> 标签：sharepoint-2007, moss, navigation, hyperlink

在 SharePoint 内部，在网站设置 >> 外观 >> 导航下，您可以放下一些用于导航的链接条目。我的问题是，除了编写功能之外，还有什么简单的方法可以使链接动态化，以便它们附加正在查看的当前页面的查询字符串？

编辑：当您导航到网页时，URL 可以有参数，这称为查询字符串。SharePoint 没有什么不同，您可以拥有将浏览器指向的 URL 以及查询字符串。SharePoint 中的页面通常具有快速启动的左侧导航区域，在该区域中呈现出预定义 URL 的静态列表。我想要做的是让这些静态链接是动态的，因为它们复制查询字符串并将其附加到我从当前正在查看的页面中定义的静态 url，该页面可能有也可能没有查询字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-22T22:27:03.157

我认为你要求的东西是不可能的。您可以做某事的唯一方法是创建一个新的提供程序并在菜单上对其进行配置。这个新的提供者可以检查导航选项中的某些项目并返回您想要的 url。

# c# - 关于yield return语句的问题

> ID：559240
> 
> 赞同：3
> 
> 时间：2009-02-17T23:42:38.677
> 
> 标签：c#, .net

以这里为例：

```
 public static IEnumerable<BigInt> EvenNumbers(IEnumerable<BigInt> numbers)  
 {  
     foreach (BigInt number in numbers)  
     {  
         if (number % 2 == 0)  
         {  
             yield return number;  
         }  
     }  
 } 
```

这将仅返回符合条件的值 (n % 2 == 0)。但是收益率返回数有什么区别？并返回号码；？

如果我说yield return number，它会将每个数字返回给调用函数等等吗？我在哪里可以找到幕后发生的一些细节？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T23:44:43.697

“return”在这里根本行不通（因为它会尝试返回 a `BigInt`，并且该方法声明了 an `IEnumerable<BigInt>`。Jon Skeet 在[C# in Depth的](http://www.manning.com/skeet/)**免费**第 6 章（然后买整本书——这真的很值得；-p）。

* * *

编辑 - 这是一个**非常粗略**的版本，说明您自己编写此内容需要做的事情；请注意，它并不完全一样，但实现了目标。我想你会同意这个`yield return`版本更简单！

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
static class Program
{
    static void Main()
    {
        IEnumerable<int> source = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
        foreach (int value in EvenNumbers(source))
        {
            Console.WriteLine(value);
        }
    }

    public static IEnumerable<int> EvenNumbers(IEnumerable<int> numbers)
    {
        return new EvenEnumerable(numbers);
    }
    class EvenEnumerable : IEnumerable<int>
    {
        private readonly IEnumerable<int> numbers;
        public EvenEnumerable(IEnumerable<int> numbers) {
            this.numbers = numbers;
        }
        public IEnumerator<int> GetEnumerator()
        {
            return new EvenEnumerator(numbers);
        }
        IEnumerator IEnumerable.GetEnumerator() { return GetEnumerator(); }
    }
    class EvenEnumerator : IEnumerator<int>
    {
        private readonly IEnumerable<int> numbers;
        public EvenEnumerator(IEnumerable<int> numbers)
        {
            this.numbers = numbers;
        }
        private int current;
        void IEnumerator.Reset() { throw new NotSupportedException(); }
        public int Current { get { return current; } }
        object IEnumerator.Current { get { return Current; } }
        IEnumerator<int> iter;
        public bool MoveNext()
        {
            if (iter == null) iter = numbers.GetEnumerator();
            while (iter.MoveNext())
            {
                int tmp = iter.Current;
                if (tmp % 2 == 0)
                {
                    current = tmp;
                    return true;
                }
            }
            return false;
        }
        public void Dispose()
        {
            if (iter != null)
            {
                iter.Dispose();
                iter = null;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T23:53:57.917

使用 yield return 实际上会导致编译器创建一个简单的 IEnumerator 类来完成循环的工作。for 循环的结构实际上决定了编译器创建的 MoveNext 方法内部的操作。

查看[此博客文章](http://startbigthinksmall.wordpress.com/2008/06/09/behind-the-scenes-of-the-c-yield-keyword/)以了解示例 IL 解构

# c# - 需要帮助破译 C# 堆栈跟踪

> ID：559241
> 
> 赞同：6
> 
> 时间：2009-02-17T23:43:32.247
> 
> 标签：c#, stack-trace

我有一个锁定在 GUI 线程上的应用程序，并且我使用了 WinDbg 以及“！clrstack”命令来获取此堆栈跟踪，但我不知道问题出在哪里。所有这些方法看起来都像框架方法，没有一个是我的。任何帮助将非常感激。我为排长队道歉

```
OS Thread Id: 0x724 (0)
ESP       EIP     
0012ec88 7c90e4f4 [HelperMethodFrame_1OBJ: 0012ec88] System.Threading.WaitHandle.WaitOneNative(Microsoft.Win32.SafeHandles.SafeWaitHandle, UInt32, Boolean, Boolean)
0012ed34 792b687f System.Threading.WaitHandle.WaitOne(Int64, Boolean)
0012ed50 792b6835 System.Threading.WaitHandle.WaitOne(Int32, Boolean)
0012ed64 7b6f192f System.Windows.Forms.Control.WaitForWaitHandle(System.Threading.WaitHandle)
0012ed78 7ba2d0bb System.Windows.Forms.Control.MarshaledInvoke(System.Windows.Forms.Control, System.Delegate, System.Object[], Boolean)
0012ee18 7b6f328c System.Windows.Forms.Control.Invoke(System.Delegate, System.Object[])
0012ee4c 7b920717 System.Windows.Forms.WindowsFormsSynchronizationContext.Send(System.Threading.SendOrPostCallback, System.Object)
0012ee64 7a924102 Microsoft.Win32.SystemEvents+SystemEventInvokeInfo.Invoke(Boolean, System.Object[])
0012ee98 7a922833 Microsoft.Win32.SystemEvents.RaiseEvent(Boolean, System.Object, System.Object[])
0012eee4 7a923d2f Microsoft.Win32.SystemEvents.OnUserPreferenceChanged(Int32, IntPtr, IntPtr)
0012ef04 7aa8f184 Microsoft.Win32.SystemEvents.WindowProc(IntPtr, Int32, IntPtr, IntPtr)
0012ef08 003620a4 [InlinedCallFrame: 0012ef08] 
0012f0cc 7b1d8cce System.Windows.Forms.Application+ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32, Int32, Int32)
0012f168 7b1d8937 System.Windows.Forms.Application+ThreadContext.RunMessageLoopInner(Int32, System.Windows.Forms.ApplicationContext)
0012f1bc 7b1d8781 System.Windows.Forms.Application+ThreadContext.RunMessageLoop(Int32, System.Windows.Forms.ApplicationContext)
0012f1ec 7b195911 System.Windows.Forms.Application.Run(System.Windows.Forms.Form)
0012f200 00eb0ebb WinForms1.Program.Main()
0012f69c 79e71b4c [GCFrame: 0012f69c] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T23:53:33.690

看起来这段代码不是问题的真正原因。看看这些页面之一是否有帮助：

*   [神秘的挂起或 InvokeRequired 的大骗局](http://ikriv.com/en/prog/info/dotnet/MysteriousHang.html)
*   [OnUserPreferenceChanged 挂起](http://krgreenlee.blogspot.com/2007/09/onuserpreferencechanged-hang.html)

**更新：**固定网址到第一页。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T15:02:00.617

另一个答案来自这个 Aaron Lerch。我真的很喜欢“在别人的代码上过滤断点”部分。我想它会为我节省几天的时间。

[http://www.aaronlerch.com/blog/2008/12/15/debugging-ui/](http://www.aaronlerch.com/blog/2008/12/15/debugging-ui/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T16:27:47.940

我有类似的问题，并在我们的代码中找到了罪魁祸首。

使用的技术： 0\. 确保在 Spy++ 中只有两个非托管线程带有控件（WinForms 和 GDI+）：

```
public static class ThreadingHelper_NativeMethods
{
   [DllImport("user32.dll")]
   public static extern bool IsGUIThread(bool bConvert);
} 
```

在初始化时从 UI 线程调用它：

```
// This code forces initialization of .NET BroadcastEventWindow to the UI thread.
// http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/fb267827-1765-4bd9-ae2f-0abbd5a2ae22
if (ThreadingHelper_NativeMethods.IsGUIThread(false))
{
    Microsoft.Win32.SystemEvents.InvokeOnEventsThread(new MethodInvoker(delegate()
    {
    int x = 0;
    }));
} 
```

1.  记住单例类中 Ui 线程的托管 id。

2.  搜索我们代码中定义的所有用户控件。在每个控件的构造函数中，在调用 InitializeComponent() 之前，我放置了检查当前线程 id 与主线程 id 的代码。如果它们不相等，则断言（假）。

3.  订阅 SystemEvents.UserPreferencesChanging。处理程序中的 Debug.Assert(false)：这发生在 SystemEvents.UserPreferencesChanged 之前，因此调试器有望在此处暂停。

4.  在调试器中检查 SystemEvents 的订阅者列表。在 _handles 列表字典中查找订阅者。打开每个回调的 SynchronizationContext 应该会发现问题：与在非 UI 线程上创建的控件相同的线程 id。SystemEvents 将在该线程上执行事件处理程序，对 UI 线程进行死锁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-11T08:58:31.600

[此](https://stackoverflow.com/a/52721562/901333)答案中的函数 CheckSystemEventsHandlersForFreeze()可以帮助您找到 GUI 线程被锁定的根本原因。

# search - 如何防止 robots.txt 从暂存环境传递到生产环境？

> ID：559242
> 
> 赞同：-1
> 
> 时间：2009-02-17T23:43:42.793
> 
> 标签：search, tomcat, web-crawler, robots.txt

我过去曾发生过，我们的一位 IT 专家会意外地将 robots.txt 从生产环境中移出。阻止谷歌和其他人在生产中索引我们客户的网站。有没有很好的方法来处理这种情况？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T00:22:48.627

请您的 IT 人员将 robots.txt 上的文件权限更改为所有用户的“只读”，以便执行以下额外步骤：

1.  成为管理员/root
2.  更改权限以允许写入
3.  用新文件覆盖 robots.txt

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T23:57:42.493

作为 SEO，我感受到了你的痛苦。

如果我错了，请原谅我，但我假设问题是由于您的登台服务器上有一个 robots.txt 引起的，因为您需要阻止搜索引擎查找和抓取整个登台环境。

如果是这种情况，我建议您将暂存环境放置在内部不存在问题的地方。（用于分段的 Intranet 类型或网络配置）。这可以避免很多搜索引擎因内容被抓取而出现的问题，例如，他们意外地从您的 Staging 中删除了 robots.txt 文件，并让重复的网站被抓取并编入索引。

如果这不是一个选项，建议将 staging 放置在服务器上的文件夹中，例如 domain.com/staging/ 并仅使用根文件夹中的一个 robots.txt 文件来完全阻止该 /staging/ 文件夹。这样，您不需要使用两个文件，并且知道另一个 robots.txt 不会替换您的文件，您可以在晚上睡觉。

如果那不是一个选项，也许要求他们将其添加到他们的清单中以不移动该文件？你只需要检查一下 - 少一点睡眠，但多一点预防措施。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T23:45:29.623

创建一个部署脚本来移动各种工件（网页、图像、支持文件等），并让 IT 人员通过运行您的脚本来完成移动。确保不要在该脚本中包含 robots.txt。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T23:46:31.710

我会在生产服务器上设置代码，该服务器将生产 robots.txt 保存在另一个位置，并让它监视正在使用的那个。

如果它们不同，那么我会立即用生产版本覆盖正在使用的版本。那么它是否被覆盖也没关系，因为坏版本不会存在很长时间。在 UNIX 环境中，我会定期使用 cron 执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T23:59:09.823

为什么您的登台环境不在防火墙后面，也不公开？

问题不在于 Robots.txt...问题在于您的网络基础设施。

# php - jQuery JSON 问题

> ID：559250
> 
> 赞同：3
> 
> 时间：2009-02-17T23:46:35.343
> 
> 标签：php, javascript, jquery, ajax, json

我想在用户在#sid 字段中输入值后立即用数据库中的值填充表单字段。这是我的 jQuery/HTML 示例：

```
<script src="jquery-1.3.1.min.js"></script>
<script type="text/JavaScript">
$(document).ready(function()
{
  $('#sid').bind("change", function(){
    $.getJSON("test.php?sid=" + $("#sid").val(), 
    function(data)
    {
      $.each(data.items, 
      function(i, item)
      {
        if (item.field == "saffil")
        {
              $("#saffil").val(item.value);
        }
        else if (item.field == "sfirst")
        {
              $("#sfirst").val(item.value);
        }
      });
      });
   });
});
</script> 
```

这是我的处理脚本（由 .getJSON 方法调用的 test.php）

```
<?
require_once("db_pers.inc");

$ssql = "SELECT * FROM contacts_mview WHERE sempid = '".$_GET['sid']."'";

$rres = pg_query($hdb, $ssql);
pg_close($hdb);

$ares = pg_fetch_assoc($rres);

$json = array(array('field' =>  'saffil',
            'value' =>  $ares['saffil']),
          array('field' =>  'sfirst',
            'value' =>  $ares['sfirst']));

echo json_encode($json);
?> 
```

根据萤火虫 GET 参数很好地传递给 test.php 并且 JSON 对象返回就好了：

```
[{"field":"saffil","value":"Admin"},{"field":"sfirst","value":"Nicholas"}] 
```

但是页面上没有任何反应，我收到以下错误消息：

```
G is undefined
init()()jquery-1....1.min.js (line 12)
(?)()()test.html (line 15)
I()jquery-1....1.min.js (line 19)
F()()jquery-1....1.min.js (line 19)
[Break on this error] (function(){var l=this,g,y=l.jQuery,p=l.....each(function(){o.dequeue(this,E)})}}); 
```

这是我第一次使用 jQuery 进行 ajax 测试，因此我们将不胜感激任何输入！

谢谢，

*   尼古拉斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T23:51:42.697

漂亮的小注入攻击等待在那里发生;）

尝试改变

```
$.each(data.items, 
```

到：

```
$.each(data, 
```

*编辑*：为了回答您的评论，我喜欢将我的字段命名为与数据键相同的名称：

```
<input type="text" name="saffil" value="" />
<input type="text" name="sfirst" value="" />

var data = {saffil:'foo', sfirst:'bar'};
$.each(data, function(key, value) {
   $('[name='+key+']').val(value)
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T23:56:36.207

我同意前面的回复。该脚本是等待发生的 SQL 注入。您可能应该使用带有准备好的语句的 PDO 之类的东西，或者至少应该使用[pg_escape_string 之](http://il.php.net/manual/en/function.pg-escape-string.php)类的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T23:53:16.890

不确定，但我确实看到了一个巨大的 Sql 注入孔。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-17T21:21:40.957

我不相信这里的答案是正确的。

这里的问题是 PHP（和 Perl）库对您提供的 JSON 进行编码，仅此而已。

因此，如果给编码函数一个数组，它将输出：

```
[ element1, element2, element3] 
```

这是数组的正确编码，但*不是*正确的 JSON 响应。正确的 JSON 响应**必须是**[http://json.org/](http://json.org/)中概述的对象。

因此，您需要在数组周围创建一个包装器对象，然后对其进行编码和响应。

```
<?php
$json = array('items' =>
              array(
                    array('field' =>  'saffil',
                          'value' =>      $ares['saffil']),
                    array('field' =>      'sfirst',
                          'value' =>      $ares['sfirst'])
              )
        );

echo json_encode($json);
?> 
```

# visual-studio - Visual Studio 的“右键单击”键盘快捷键？

> ID：559251
> 
> 赞同：29
> 
> 时间：2009-02-17T23:47:07.573
> 
> 标签：visual-studio, keyboard-shortcuts

我试图强迫自己使用尽可能少的鼠标，但我在任何地方都找不到这个简单快捷方式的答案！这里的步骤：

1.  打开 Visual Studio。打开任何 C# 文件（或我相信的任何代码文件）
2.  将鼠标指向窗口/文件上的任意位置。
3.  右键点击

有没有为此的快捷键，所以我不必将手移到鼠标上？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-02-17T23:52:30.150

取自[lytebyte](http://www.lytebyte.com/2008/05/29/keyboard-shortcut-to-open-right-click-context-menu/)，您有两个选择：

*   `Shift`+`F10`
*   现代 Windows 键盘右下角的那个坚果键，[菜单键](http://en.wikipedia.org/wiki/Menu_key)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T23:54:02.817

取决于您右键单击的位置/原因。

如今，上下文菜单键位于键盘右侧，通常位于空格键右侧的 Windows 键和 Control 键之间。这将在当前焦点所在的任何位置（通常在文本编辑器中）打开上下文菜单。

如果您只是使用鼠标右键打开重构工具，您可以使用`Ctrl`+ `.`（控制周期）弹出打开任何标识符上的“智能标签”。这将为您提供“生成方法存根”菜单项等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T23:55:16.103

您的键盘是否有额外的“Windows”键，即。Windows 徽标（开始键）和空格键右侧看起来像菜单的徽标？因为右侧的那个按钮是“上下文菜单键”。

看到右侧“Windows”键和键之间的键了`Ctrl`吗？ [Windows 键盘布局](http://www.nursingstudies.co.uk/keyboard1.JPG)

如果您的键盘使用时间不到 10 年，您应该拥有这些键，除非您有 IBM 笔记本电脑或 Mac。！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-17T23:59:50.573

要在没有键盘的情况下打开新文件，您可以使用 `CTRL`+ `SHIFT`+ `N` （使用 Resharper）来显示代码任何部分的右键菜单。指向您想要的部分并使用 `SHIFT`+`F10`

通常，我喜欢使用 `CTRL`++ （再次使用 Resharper `SHIFT`）`G`来获取导航菜单（使用、基础、实现等）

如果你想去任何方法/类/内部/或一个领域，使用`CTRL`+ `SHIFT`+ `ALT`+ `N`（再次使用 Resharper），这将给你一个列表，列出所有符合你的标准的列表供你选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T23:52:49.900

假设您只想要一个可以按右键单击的键，大多数\许多键盘在 alt 和 ctrl 之间都有一个可以右键单击的键。

# c# - MessageBox.Show() 是否自动编组到 UI 线程？

> ID：559252
> 
> 赞同：14
> 
> 时间：2009-02-17T23:47:17.950
> 
> 标签：c#, multithreading, user-interface, marshalling

我通过 ThreadPool.QueueUserWorkItem 启动一个线程，其中有一个消息框对话框：

> System.Windows.Forms.DialogResult dr = System.Windows.Forms.MessageBox.Show("您想在后台下载升级吗？..", "升级可用", MessageBoxButtons.YesNo);

它似乎工作正常，但是在一些客户建议他们没有收到消息弹出后，我有点怀疑。我在 .NET 框架 2.0+ 中感觉您不需要编组这个特定的调用，它会为您完成。正确的？

这是一个感兴趣的半相关主题： [为什么在 MessageBox.Show 中使用所有者窗口？](https://stackoverflow.com/questions/195593/why-use-a-owner-window-in-messagebox-show)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-18T06:19:27.820

不，它不会编组到 UI 线程。如果你想一想，它就不可能这样做。

一个应用程序中可能有多个 UI 线程。某些程序，例如 Internet Explorer，有许多 UI 线程。.Show 调用会选择哪个 UI 线程？

也可以在没有 UI 线程的应用程序中使用 MessageBox.Show。您可以在控制台应用程序中很好地调用它，它会起作用。

MessageBox.Show 将在调用它的线程上显示 UI。如果线程上还没有运行消息泵，它将设置一个临时的以便运行。Show 调用完成后，它将将其拆除。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-18T04:33:36.327

作为一般规则，您不应该在主/应用程序线程之外进行 GUI 工作。我会在可以执行调用的父窗体上创建一个 ShowMessageBox 方法：

```
public DialogResult ShowMessageBox (String message, String caption)
{
    if (this.InvokeRequired) {
        return (DialogResult) this.Invoke (new PassStringStringReturnDialogResultDelegate (ShowMessageBox), message, caption);
    }
    return MessageBox.Show (this, message, caption);
}

public delegate DialogResult PassStringStringReturnDialogResultDelegate (String s1, String s2); 
```

但也要记住：调试多线程 GUI 应用程序时，并且您在主/应用程序线程以外的线程中进行调试，您需要关闭“启用属性评估和其他隐式函数调用”选项，或者否则 VS 将自动从当前线程中获取本地/全局 GUI 对象的值，这将导致您的应用程序以奇怪的方式崩溃/失败。转到工具->选项->调试以关闭该设置。

对上限感到抱歉，但这花了我几天的时间来弄清楚为什么我每次尝试调试我的应用程序都会挂起然后崩溃。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T23:48:51.813

好吧，我会编组并指定一个窗口，只要这样`MessageBox`才能获得正确的焦点。可能他们根本看不到它，因为它位于您的一种表单后面，并且不知道它应该在前台。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T23:51:13.603

这是应用程序还是服务。如果它是一项服务，则可能没有设置“允许与桌面交互”权限。

在服务控制面板小程序中查看服务的属性。

# java - 如何使用正则表达式匹配特定类型单词之前的所有内容

> ID：559254
> 
> 赞同：20
> 
> 时间：2009-02-17T23:48:38.803
> 
> 标签：java, regex

我是正则表达式的新手。

是否可以匹配满足特定条件的单词之前的所有内容：

例如

这是一个测试 - - +++ 这是一个测试

我希望它遇到一个以大写字母开头并且下一个字符是小写字母的单词。这构成了一个适当的词。然后，我想删除该词之前的所有内容。

上面的例子应该产生：这是一个测试

我只想进行此处理，直到找到正确的单词然后停止。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-17T23:55:34.090

代替

```
^.*?(?=[A-Z][a-z]) 
```

与空字符串。这适用于 ASCII 输入。对于非 ASCII 输入（Unicode、其他语言），应用不同的策略。

解释

```
.*?    Everything, until
(?=    followed by
[A-Z]  one of A .. Z and
[a-z]  one of a .. z
) 
```

启用 Java Unicode 的变体是这样的：

```
^.*?(?=\p{Lu}\p{Ll}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T23:56:58.033

稍微清醒一点后，您无需删除任何内容，甚至无需创建子组 - 只需在答案中找到其他地方表达的模式即可。这是一个完整的例子：

```
import java.util.regex.*;

public class Test
{
    public static void main(String args[])
    {
        Pattern pattern = Pattern.compile("[A-Z][a-z].*");

        String original = "THIS IS A TEST - - +++ This is a test";
        Matcher match = pattern.matcher(original);
        if (match.find())
        {
            System.out.println(match.group());
        }
        else
        {
            System.out.println("No match");
        }        
    }
} 
```

编辑：原始答案

这看起来像是在做正确的事情：

```
import java.util.regex.*;

public class Test
{
    public static void main(String args[])
    {
        Pattern pattern = Pattern.compile("^.*?([A-Z][a-z].*)$");

        String original = "THIS IS A TEST - - +++ This is a test";
        String replaced = pattern.matcher(original).replaceAll("$1");

        System.out.println(replaced);
    }
} 
```

基本上，诀窍不是忽略正确单词之前的所有内容 - 而是将从正确单词开始的所有内容分组，并用该组替换整个文本。

以上将失败，`"*** FOO *** I am fond of peanuts"`因为“我”不会被认为是一个合适的词。如果要解决此问题，请将 [az] 更改为 [az\s] ，这将允许空格而不是字母。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T00:41:39.860

我知道我对此的看法真的不那么受欢迎，所以如果你们愿意，你们可以否决我，但我不得不咆哮一下（这包含一个解决方案，只是不像海报所要求的那样） .

我真的不明白为什么人们这么快就使用正则表达式。

我已经做了很多字符串解析（用于屏幕抓取 vt100 菜单屏幕），但我从来没有发现正则表达式比编写代码更容易的情况。（也许一对夫妇会更容易一些，但并不多）。

我有点理解，一旦你了解它们，它们应该会更容易——但你看到有人问这样的问题，并意识到每个程序员都不容易通过看一眼就能理解它们。如果它花费了 1 个程序员 10 分钟的思考时间，那么即使你花了 5 分钟写 5 行代码，它也会比仅仅编写代码造成巨大的净损失。

所以它需要文档——如果同一级别的人遇到它，他将无法在没有他领域之外的知识的情况下修改它，即使有文档也是如此。

我的意思是，如果发帖人不得不问一个小事——那么根本就没有小事。

```
public String getRealText(String scanMe) {
    for(int i=0 ; i < scanMe.length ; i++)
        if( isUpper(scanMe[i]) && isLower(scanMe[i+1]) )
            return scanMe.subString(i);
return null; } 
```

我的意思是它只有 5 行，但它比大多数（全部？）RE 解析器简单、易读且速度更快。一旦您将正则表达式包装在方法中并对其进行注释，则大小上的差异是不可测量的。时间上的差异——对于海报来说，显然时间会少很多——因为对于下一个遇到他的代码的人来说可能是这样。

这个字符串操作是在 C 中使用指针更容易的操作之一——而且它会更快，因为测试函数是 C 中的宏。

顺便说一句，确保你在第二个槽中寻找一个空格，而不仅仅是一个小写变量，否则你会错过任何以单词 A 或 I 开头的行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T23:56:48.130

那么你可以做这样的事情

```
'.*([A-Z][a-z].*)\s*'

.* matches anything
( [A-Z] #followed by an uper case char 
  [a-z] #followed by a lower case 
  .*)   #followed by anything
  \s*   #followed by zeror or more white space 
```

我想这就是你要找的东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T23:58:15.270

> ([AZ][az].+)

将匹配：

这是一个文本

# c++ - 找到变量定义的任何程序或技巧？

> ID：559274
> 
> 赞同：9
> 
> 时间：2009-02-17T23:54:27.883
> 
> 标签：c++, variables, find, definition

很多时候，当我在看其他人的代码时，我只想找到变量的定义位置和方式。通常我现在所做的是查找变量的类型，直到找到定义，这非常耗时。而且我想有一些工具可以帮助我解决这种日常情况。一些工具或命令中有什么建议可以帮助我完成这项任务吗？

我知道使用 GUI 并创建一个项目是自动完成的，我说的是一种无需 GUI 的方法。我只使用文本模式。我在 Linux 下运行并且使用 C/C++，但欢迎提出其他语言的建议。

非常感谢。

**一个可能的解决方案**

Michel 在他的一个评论中提出了一个简单有效的解决方案，再次定义变量，在这种情况下，在编译时，编译器将通知先前的定义在哪里。当然，要应用这个解决方案，我们需要事先考虑变量的局部性。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T00:00:19.603

您已经给出了最合适的工具：IDE。这*正是*IDE 擅长的事情。如果您发现没有 IDE 开发会很痛苦，为什么*不想*使用 IDE？

请注意，Emacs、Vim 等可以作为 IDE 工作——如果你想留在纯文本的情况下，我并不是在谈论强迫你使用 GUI 的世界，例如因为你正在使用 SSH。

（我真的*不想*在这里变得粗鲁。我只是认为您在没有解释原因的情况下忽略了明显的解决方案。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-18T00:00:13.033

*编辑*：好的，你说你正在使用 C++。我正在编辑我的回复。我会使用 C 预处理器，然后使用 grep 获取变量。它会首先出现。

```
cpp -I...(preprocessor options here) file.cpp | grep variable 
```

C 预处理器将加入程序使用的所有包含，并且定义必须在文件中对该变量的任何使用之前。不是一个完美的东西，但没有 IDE 或完整的语言描述/管理工具，你只有文本。

另一种选择是使用[ctags](http://ctags.sourceforge.net/)。它了解 C 和 C++ 语法（以及其他），并且可以使用命令行工具、emacs 和 vi 等搜索变量和函数。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-18T01:24:54.750

我虔诚地使用 cscope 和 ctags-exuberant。在我的代码库上运行一次，然后在 Vim 中，我可以使用各种命令，如 ^] 或 [D 或 [I 或类似命令来查找给定单词的任何定义或声明。

这类似于 Visual Studio 和 Eclipse 等大型 IDE 提供的设施。

Cscope 还可以作为执行这些搜索的独立工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T01:37:48.353

我使用以下三种方法之一：

1.  我将使用[CTags](http://ctags.sourceforge.net/index.html)处理我的源代码树（每晚），然后可以轻松地使用 Vim（或其他编辑器）中的命令直接跳转到定义。
2.  我将只使用 grep (linux) 或 findstr (windows) 来查找所有出现的变量名称或类型。定义通常很明显。
3.  在 Vim 中，您可以在范围内向后搜索，并且经常找到您要查找的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T00:21:26.650

Grep 用于变量声明的常见模式。示例：*、&、> 或一个字母数字后跟一个或多个空格字符，然后是变量的名称。或变量名称后跟零个或多个空格字符，然后是左括号或分号。除非它是在非常奇怪的情况下定义的（例如使用某种宏），否则它每次都有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T09:35:11.297

在 VIM 中，您可以使用`gd`查看局部变量声明或`gD`查看全局变量声明（如果它们已在当前文件中定义）。参考[Go_to_definition_using_g](http://vim.wikia.com/wiki/Go_to_definition_using_g)

您还可以使用`[i`查看定义而不跳转到它，或者`[I`查看所有包含文件中所有出现的变量，这自然也会显示定义。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-18T00:01:58.537

如果您在 Microsoft Visual Studio 中工作（我认为您也可以将其用于 C++，但需要在 Windows 工作站上工作），则“转到定义...”有一个易于访问的右键单击菜单选项，这将需要您可以定义任何当前标记的变量、类型或方法。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-18T00:08:53.700

如果您坚持保持文本模式，您可以使用 emacs 或 vi 以及适当的插件来执行此操作。

但实际上，进入 21 世纪。

编辑：您评论说您正在通过 SSH 执行此操作，因为您需要远程服务器集群的构建速度。

在这种情况下，将驱动器安装在本地计算机上并使用 IDE，然后通过 SSH 启动构建。

# sharepoint - SharePoint 发布网站电子邮件编码/解码

> ID：559281
> 
> 赞同：2
> 
> 时间：2009-02-17T23:58:16.033
> 
> 标签：sharepoint, email, publishing, encode

我正在为我公司网站上的员工信息构建一个 SharePoint (MOSS) 发布网站。我有一个员工内容类型，并且正在使用“联系电子邮件地址”站点列来存储员工的电子邮件地址。

我想要的是能够在运行时对电子邮件地址进行编码，以防止垃圾邮件发送者获取真实的电子邮件地址。当用户单击电子邮件超链接时，这将被解码，例如以下 HTML 将被发送到浏览器：

```
<a href="javascript:sendEmail('5237952A6F67618E407373772E6063212E6175')">Email Jonny</a> 
```

我已经有了用于从上面无意义的字符串中编码/解码文本值的 javascript 方法，但我不太确定如何在考虑 SharePoint 的情况下处理这个问题。我在考虑自定义控件和/或自定义 J-Query？

任何帮助将非常感激！

强尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T00:42:35.257

如果您让这些员工成为网站的成员，SharePoint 会处理此问题。

您可以向他们发送电子邮件，但电子邮件地址只会在发送时使用，当您添加按钮向某人发送电子邮件时，它不会显示电子邮件地址，它在后端处理。

```
SPUtility.SendEmail(SPContext.Current.Web, false, false,
[SPUser.Email][1], "E-mail title",
"E-mail body"); 
```

[![替代文字](https://i.stack.imgur.com/MaxEp.png)](https://i.stack.imgur.com/MaxEp.png)
[（来源：[msdn.com](http://blogs.msdn.com/blogfiles/sharepoint/WindowsLiveWriter/AnnouncingCommunityKitforSharePointWindo_4443/image_2.png)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T02:57:57.943

在您无法将用户放入 AD 的情况下，[自定义字段控件](http://msdn.microsoft.com/en-us/library/bb417414.aspx)将使您能够包含所需的自定义呈现 (jquery) 以及将数据作为“普通”文本输入的能力。

自定义字段一旦定义“就可以工作”，无论您需要在哪里显示该字段。

鉴于您正在考虑使用 JQuery，那么问题就变成了确保当您需要我们使用这种类型的字段时正确链接 jquery 库的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T07:04:21.930

您可以尝试另外两种选择/方法：

（1）实现自定义TextField控件，继承自Microsoft.SharePoint.WebControls.TextField并覆盖RenderFieldForDisplay

然后在代码中 - 对显示的字段进行编码。

将此控件添加到 safecontrols 并使用它来代替页面布局中的普通 TextField。

(2) 使用现有的TextField控件，但是在editmode的TextField旁边使用jQuery注入一个按钮[Encode]。

使用 JavaScript 编码方法将用户键入的内容编码为编码值，替换现有的 TextField 值。然后他们可以将其保存到 SharePoint。

* * *

我会根据您的部署场景对这些方法进行评分 - Nat 的方法是最干净的，但可能更多地涉及部署，而仅 jQuery 的方法似乎非常hackish，但部署起来很容易。覆盖 TextField 方法可能位于中间的某个位置。

# php - 使用 Smarty 进行更智能的自动换行？

> ID：559282
> 
> 赞同：1
> 
> 时间：2009-02-17T23:58:50.963
> 
> 标签：php, smarty, word-wrap

我正在尝试根据标题的总字符数找到一种在特定数量的单词之后包装长标题的方法。我的目的是使换行文本的底线比顶线长，以增加可读性。

我想使用 Smarty 查找标题的字符数，然后根据默认字体大小和包含元素的宽度决定第一行的长度。但我不是编码员，也不知道制作数组、foreach 循环、迭代计数和其他可能需要的东西的最佳方法。

我基本上是在尝试：

1.  使用查找标题的总字符数`{$item.name|count_characters:true}`

2.  如果总字符数介于 60 到 100 个字符之间，请在第一个超过 30 个字符的单词末尾添加一个 br 标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T00:35:43.527

我相信你可以用[register_modifier()](http://www.smarty.net/manual/en/api.register.modifier.php)做到这一点。基本上，您编写一个 php 函数来插入标签，然后将其注册为修饰符。完成后，像使用其他修饰符一样在 smarty 中使用它，即：

```
{$variable|break_title} 
```

一般来说，最好不要在 smarty 模板中进行复杂的格式化。模板越接近原版 html，事情就越干净。

可能的实现：

```
function break_title($title) {
   return wordwrap($title, 59, '<br />\n');
}

/* later */
$smarty->register_modifier('break_title', 'break_title'); 
```

如果要考虑字体大小，可以设置一个全局配置变量，指示要中断的字符数。

编辑：正如评论者所提到的，如果有一个现有的 php 函数可以满足您的需求，您可以在不注册该函数的情况下访问它：

```
{$variable|wordwrap:59:"<br />\n"} 
```

# c++ - 直接 3D 影响数据类型 double

> ID：559294
> 
> 赞同：3
> 
> 时间：2009-02-18T00:02:22.843
> 
> 标签：c++, direct3d

我最近在我的程序中添加了一些 DirectX 代码，现在我的双精度数据类型变量只有浮点数的范围/分辨率（.. 或至少比以前更小的范围/分辨率）。如果我删除 direct3D 初始化 - “Direct3DCreate9(D3D_SDK_VERSION)” - 问题就消失了。有什么见解吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T00:07:29.507

Direct3D 将修改 FPU 状态以强制单精度模式。

如果要保留双精度模式，`D3DCREATE_FPU_PRESERVE`请在创建 D3D 设备时使用。这将对 D3D 的性能产生影响：

[http://msdn.microsoft.com/en-us/library/bb172527(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb172527(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T00:11:26.003

正如这篇博文所述：[Direct3D and the FPU](http://blogs.msdn.com/tmiller/archive/2004/06/01/145596.aspx)，您可以告诉 Direct3D 不要将 FPU 模式更改为单精度：

> 幸运的是，您可以通过简单地告诉 Direct3D 根本不要弄乱 FPU 来避免所有这些。创建设备时，您应该使用 CreateFlags.FpuPreserve 标志来保持 CLR 的双精度，并使您的代码按预期运行。

# objective-c - Objective-c中release和dealloc的区别

> ID：559295
> 
> 赞同：40
> 
> 时间：2009-02-18T00:03:21.327
> 
> 标签：objective-c, memory

例如，在取消分配我见过`release`并被`dealloc`使用的引用时

```
-(void)dealloc
{
  [foo release];
  [nar dealloc];

  [super dealloc];
} 
```

我的问题是什么时候`release`使用，什么时候`dealloc`使用？

谢谢

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-18T00:11:01.590

`dealloc`除非`[super dealloc]`在类方法结束时调用，否则不要调用`dealloc`。该`release`方法放弃了对象的所有权。当一个 Cocoa 对象不再有任何所有者时，它可能会被释放——在这种情况下，它会自动被发送一条`dealloc`消息。

如果您要对 Cocoa 进行编程，则需要阅读[内存管理指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)。一旦您克服了最初的困难，这将非常简单，如果您不了解该文档中的内容，您将遇到许多细微的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T10:22:42.617

`dealloc`当对象的保留计数变为零时（通过对象向其发送释放消息），将调用示例中的语句。

由于不再需要它，它通过向`release`它所持有的对象发送消息来清理自己。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-25T11:02:19.187

您永远不应该显式调用 dealloc（除非它是 dealloc 方法中的 [super dealloc]，但这是唯一的例外）。Objective-C 通过引用计数处理内存管理，因此您只需将分配/保留与释放/自动释放相匹配，并让对象自行解构。

# java - JSON到XML转换的Java实现

> ID：559296
> 
> 赞同：21
> 
> 时间：2009-02-18T00:03:49.267
> 
> 标签：java, xml, json, translation

是否有现有的 JAR 可用于从 JSON 转换为 XML？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2011-05-03T13:00:28.673

您可以创建一个[JSONObject](https://github.com/stleary/JSON-java/blob/master/JSONObject.java)，然后使用org.json 命名空间中的[XML 类将其转换为 XML](https://github.com/stleary/JSON-java/blob/master/XML.java)

在对象中包装 json 字符串就像在其构造函数中传递它一样简单

```
JSONObject o = new JSONObject(jsonString); 
```

然后您可以使用 XML 类以 XML 格式获取它，如下所示：

```
String xml = org.json.XML.toString(o); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-18T14:46:54.230

不是 Java，而是**纯 XSLT 2.0 实现**：

查看[**`f:json-document()`**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/func-json-document.xsl?view=markup&sortby=date)来自[**FXSL 2.x 库**](http://fxsl.sf.net)的内容。

使用这个函数可以非常容易地合并 JSON 并将其用作... XML。

例如，可以只编写以下 XPath 表达式：

```
f:json-document($vstrParam)/Students/*[sex = 'Female'] 
```

并**得到所有的`Students`孩子`sex = 'Female'`**

**这是完整的示例：**

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:f="http://fxsl.sf.net/"
 exclude-result-prefixes="f xs"
 >
 <xsl:import href="../f/func-json-document.xsl"/>

 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vstrParam" as="xs:string">
{

  "teacher":{
    "name":
      "Mr Borat",
    "age":
      "35",
    "Nationality":
      "Kazakhstan"
             },

  "Class":{
    "Semester":
      "Summer",
    "Room":
      null,
    "Subject":
      "Politics",
    "Notes":
      "We're happy, you happy?"
           },

  "Students":
    {
      "Smith":
        {"First Name":"Mary","sex":"Female"},
      "Brown":
        {"First Name":"John","sex":"Male"},
      "Jackson":
        {"First Name":"Jackie","sex":"Female"}
    }
    ,

  "Grades":

    {
      "Test":
      [
        {"grade":"A","points":68,"grade":"B","points":25,"grade":"C","points":15},

        {"grade":"C","points":2, "grade":"B","points":29, "grade":"A","points":55},

        {"grade":"C","points":2, "grade":"A","points":72, "grade":"A","points":65}
       ]
    }

}
 </xsl:variable>

 <xsl:template match="/">
    <xsl:sequence select=
     "f:json-document($vstrParam)/Students/*[sex = 'Female']"/>

 </xsl:template>
</xsl:stylesheet> 
```

**当上述转换应用于任何 XML 文档（忽略）时，会产生正确的结果**：

```
<Smith>
   <First_Name>Mary</First_Name>
   <sex>Female</sex>
</Smith>
<Jackson>
   <First_Name>Jackie</First_Name>
   <sex>Female</sex>
</Jackson> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T20:45:37.050

另一种可能性：Jettison， http: [//jettison.codehaus.org](http://jettison.codehaus.org)可以通过 XML 解析接口 (stax XMLStreamReader) 公开 Json，它允许与只理解 XML 的系统集成。它需要使用约定（badgerfish 或其他任何名称）。

例如，XStream 使用 Jettison（或至少是 Badgerfish 约定）来允许使用 JSON。

但问题本身有点模糊：虽然您总是可以从一个转换为另一个（这确实是一件非常微不足道的事情），但 XML 和 JSON 并不等价：不存在一对一的无损通用映射。因此，问题是：您打算如何处理结果，如何使用生成的 xml？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T00:29:00.657

您可能想尝试 XStream。看看[http://x-stream.github.io/faq.html#JSON](http://x-stream.github.io/faq.html#JSON)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-06T20:45:14.977

[http://json-lib.sourceforge.net/](http://json-lib.sourceforge.net/)

*   以上关于没有完全万无一失的一对一映射的观点是有效的，但我在使用上述库将 xml 转换为 json 方面有很好的经验。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-09T07:15:15.600

您可以尝试[https://github.com/lukas-krecan/json2xml](https://github.com/lukas-krecan/json2xml)，它提供了简单的 JSON 到 XML 的转换。它采用 Jackson JSON 解析器并使用它来发出 SAX 事件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-08T16:59:58.087

[转换盒！！！](http://capsulesforthejavamind.blogspot.in/2015/01/conversion-box.html)

我正在使用 Dimitre 在他的回复中粘贴并已转换为 XML 的 JSON。让我们看看它是否适合你......

```
import org.json.me.JSONObject;

import cjm.component.cb.xml.ToXML;

public class Test
{
public static void main(String[] args)
{
    try
    {
        JSONObject objectJSON = new JSONObject();

        objectJSON.put("ROOT", (new JSONObject("{\"teacher\":{\"name\":\"Mr Borat\",\"age\":\"35\",\"Nationality\":\"Kazakhstan\"},\"Class\":{\"Semester\":\"Summer\",\"Room\":null,\"Subject\":\"Politics\",\"Notes\":\"We're happy, you happy?\"},\"Students\":{\"Smith\":{\"FirstName\":\"Mary\",\"sex\":\"Female\"},\"Brown\":{\"FirstName\":\"John\",\"sex\":\"Male\"},\"Jackson\":{\"FirstName\":\"Jackie\",\"sex\":\"Female\"}},\"Grades\":{\"Test\":[{\"grade\":\"A\",\"points\":68,\"grade\":\"B\",\"points\":25,\"grade\":\"C\",\"points\":15},{\"grade\":\"C\",\"points\":2,\"grade\":\"B\",\"points\":29,\"grade\":\"A\",\"points\":55},{\"grade\":\"C\",\"points\":2,\"grade\":\"A\",\"points\":72,\"grade\":\"A\",\"points\":65}]}}")));

        System.out.println("JSON: " + objectJSON);

        StringBuilder xml = new ToXML().convertToXML(objectJSON, true); // Conversion Box!!!!

        System.out.println("XML: " + xml);
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
}
} 
```

输出：

```
JSON: {"ROOT":{"Students":{"Brown":{"FirstName":"John","sex":"Male"},"Jackson":{"FirstName":"Jackie","sex":"Female"},"Smith":{"FirstName":"Mary","sex":"Female"}},"Class":{"Subject":"Politics","Room":null,"Semester":"Summer","Notes":"We're happy, you happy?"},"Grades":{"Test":[{"points":15,"grade":"C"},{"points":55,"grade":"A"},{"points":65,"grade":"A"}]},"teacher":{"age":"35","name":"Mr Borat","Nationality":"Kazakhstan"}}}
 -------- JSON Detected -------- 
 -------- XML created Successfully -------- 
XML: <ROOT><Students><Brown><FirstName>John</FirstName><sex>Male</sex></Brown><Jackson><FirstName>Jackie</FirstName><sex>Female</sex></Jackson><Smith><FirstName>Mary</FirstName><sex>Female</sex></Smith></Students><Class><Subject>Politics</Subject><Room>null</Room><Semester>Summer</Semester><Notes>We're happy, you happy?</Notes></Class><Grades><Test><LIST_ELEMENT_Test><points>15</points><grade>C</grade></LIST_ELEMENT_Test><LIST_ELEMENT_Test><points>55</points><grade>A</grade></LIST_ELEMENT_Test><LIST_ELEMENT_Test><points>65</points><grade>A</grade></LIST_ELEMENT_Test></Test></Grades><teacher><age>35</age><name>Mr Borat</name><Nationality>Kazakhstan</Nationality></teacher></ROOT> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T03:16:07.743

您可以使用[json-lib](http://json-lib.sourceforge.net/)，它提供双向转换。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-31T16:06:29.347

StAXON 可以使用带有默认模板的 XSLT 或 StAX 事件 API [https://github.com/beckchr/staxon/wiki/Converting-JSON-to-XML将 JSON 转换为 XML](https://github.com/beckchr/staxon/wiki/Converting-JSON-to-XML)

这是一个简单的例子：

输入文件：

```
{
    "container":[
        {
            "someString":"xxxxx",
            "someInteger":123,
            "someArrayElem":[
                {
                    "key":1111,
                    "value":"One"
                },
                {
                    "key":2222,
                    "value":"Two"
                }
            ]
        }
    ]
} 
```

进口+代码：

```
import de.odysseus.staxon.json.JsonXMLConfig;
import de.odysseus.staxon.json.JsonXMLConfigBuilder;
import de.odysseus.staxon.json.JsonXMLInputFactory;
import de.odysseus.staxon.xml.util.PrettyXMLEventWriter;
import javax.xml.stream.XMLEventReader;
import javax.xml.stream.XMLEventWriter;
import javax.xml.stream.XMLOutputFactory;
import java.io.StringWriter;

StringWriter stringWriter = new StringWriter();
JsonXMLConfig config = new JsonXMLConfigBuilder().multiplePI(false).prettyPrint(false).build();
XMLEventReader reader = new JsonXMLInputFactory(config).createXMLEventReader(getClass().getClassLoader().getResourceAsStream("input.json"));
XMLEventWriter writer = XMLOutputFactory.newInstance().createXMLEventWriter(stringWriter);
writer = new PrettyXMLEventWriter(writer);
writer.add(reader);
String xml = stringWriter.getBuffer().toString(); 
```

输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<container>
    <someString>xxxxx</someString>
    <someInteger>123</someInteger>
    <someArrayElem>
        <key>1111</key>
        <value>One</value>
    </someArrayElem>
    <someArrayElem>
        <key>2222</key>
        <value>Two</value>
    </someArrayElem>
</container> 
```

# java - 如何在 Eclipse 中查看最近的 CVS 项目更改？

> ID：559326
> 
> 赞同：23
> 
> 时间：2009-02-18T00:21:59.457
> 
> 标签：java, eclipse, svn, version-control, cvs

Eclipse 中有没有办法查看项目的所有最近更改？就像在 SVN 中一样，您只需在文件夹的右键菜单上“查看日志”即可。在 CVS/Eclipse 中，我只能查看某个文件的历史记录。我无法看到上次提交中更改了哪些文件。>.<''

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-19T17:18:10.050

你可以根据时间做差异。例如，查看最近几天提交了哪些更改。

这在 Eclipse 中相当笨拙，但是您可以进入 CVS 存储库视图，单击“日期”，输入“开始”日期，然后导航到要查找更改的项目，选择“比较”并选择“到”日期。然后你会看到在那段时间发生的变化。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-18T00:24:45.720

我认为标准 Eclipse 插件不支持它。

有一个[sourceforge 项目](http://cvschangelog.sourceforge.net/)试图增强此功能，但不确定它是否仍在积极维护中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T10:07:37.480

我在 Eclipse 中找不到任何工具。我更喜欢使用[CommitMonitor](http://tools.tortoisesvn.net/CommitMonitor.html)来监控项目的 SVN 历史记录（整个项目、分支/s、标签/s）。它在系统托盘中运行并每秒钟向您展示广告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T05:10:26.487

如[该线程](http://dev.eclipse.org/mhonarc/lists/platform-cvs-dev/msg00348.html)或 CVS FAQ 中所述：

“查看上次提交中更改了哪些文件”：

这不等于`Compare With>Another Branch or Version`从项目的上下文菜单中选择“”操作吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-03T16:32:34.290

在没有可以从 Eclipse 完成工作的插件之前，我使用存储库根目录中的文件历史记录。

如果您在 ROOT 中看不到文件历史记录，请使用

```
REPOSITORY_HOME\CVSROOT>echo>history 
```

之后，存储库上的所有操作都将以以下形式保存：

```
u4f2c09af|dejanr|MyPC|src|1.5|Main.java| 
```

注意：所有用户都需要对“历史”文件有读写权限

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-02-09T17:43:40.230

右键单击项目团队->同步存储库

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-03-07T14:26:33.007

这样做对我来说非常简单：

*   在*SVN Repositories*视图中，右键单击任何目录，包括存储库根目录
*   从上下文菜单中选择*显示历史*
*   修订将显示在*历史*视图中，例如在 Tortois 中*显示日志*

# inheritance - 如何继承 MFC 对话框？

> ID：559331
> 
> 赞同：3
> 
> 时间：2009-02-18T00:23:42.930
> 
> 标签：inheritance, mfc, dialog

我创建了一个对话框（cMyDialog）。我打算复制 cMyDialog 并将其命名为 cMyDialog2。如何在 MFC 中进行继承？我希望 cMyDialog2 从 cMyDialog1 继承所有 IDD，这样我就不必将代码从 cMyDialog1 复制并粘贴到 cMyDialog2。cMyDialog2 的目的是继承 cMyDialog1 的所有功能，并在其中添加一些额外的功能。

* * *

非常感谢您的回复。我不太确定 IMPLEMENT_DYNAMIC。下面是我的代码的一小段。如果我误解了宏，请您复习一下并帮助我吗？

```
// cMyDialog1.cpp : implementation file

cMyDialog1::cMyDialog1(void * pMsgData, CWnd* pParent /*=NULL*/): CDialog(cMyDialog1::IDD, pParent)

{ //codes....
}

BOOL cMyDialog1::OnInitDialog() 

{
    CDialog::OnInitDialog();
...
}

//cMyDialog2.cpp

cMyDialog2::cMyDialog2(void * pMsgData, CWnd* pParent /*=NULL*/)
    : CMyDialog1(cMyDialog2::IDD, pParent)

{ //codes....
   IMPLEMENT_DYNAMIC(cMyDialog2, cMyDialog1)
} 
```

* * *

我可以通过`DECLARE_DYNAMIC`and`IMPLEMENT_DYNAMIC`方法从 CMyDialog 继承。非常感谢你的帮助，亚当。

但是我无法解决问题的第二部分。我想在子对话框CMyDialog1中添加一些额外的功能，例如添加“另存为”按钮，但我无法做到。是因为 CMyDialog1 是从 CMyDialog 继承的对话框，因此我无法添加新功能吗？如何在继承对话框中添加新功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T00:34:01.907

是的，您可以从 CDialog 派生类继承。您只需要添加一些宏，如 DECLARE_DYNAMIC 和其他一些宏来满足 MFC。这是一个例子。您可以以此为起点：

在 .h 文件中：

```
class cMyDialog2
  : public cMyDialog
{
  DECLARE_DYNAMIC(cMyDialog2)

pulic:
  cMyDialog2();
  virtual ~cMyDialog2();

protected:
  DECLARE_MESSAGE_MAP()
}; 
```

在 .cpp 文件中：

```
#include "cMyDialog2.h"

IMPLEMENT_DYNAMIC(cMyDialog2, cMyDialog)

BEGIN_MESSAGE_MAP(cMyDialog2, cMyDialog)
END_MESSAGE_MAP()

cMyDialog2::cMyDialog2()
{
}

...etc. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T05:10:20.867

这可能被视为 Adam Piece 答案的附录。`DoDataExchange()`了解从另一个对话派生时的角色也很重要。派生类 (cMyDialog2) 不应实现此函数，或者如果已实现（推荐）它应该调用它的基本版本，如下所示：

```
void cMyDialog2::DoDataExchange(CDataExchange* pDX)
{
    CDialog::DoDataExchange(pDX);
    cMyDialog::DoDataExchange(pDX);
} 
```

如果这没有正确完成，对话框上的控件将不会被创建，并且对话框可能会在调用/执行时崩溃。

# version-control - 为什么我的团队应该采用源代码控制？

> ID：559332
> 
> 赞同：38
> 
> 时间：2009-02-18T00:23:44.087
> 
> 标签：version-control, project-management, visual-sourcesafe

我有机会向我的老板正式介绍任何有利于公司的事情。我的想法是在我的工作场所采用源代码控制。我一直在使用 Mercurial 来管理我自己的工作项目，但是团队的其他成员没有正式的源代码控制系统。不幸的是，我不太擅长提出想法。

那么，你们能告诉我为什么开发人员必须使用源代码控制吗？此外，您为什么要选择*除*Visual SourceSafe 之外的任何工具？我没有使用 VSS 的经验，但他可能会问我们为什么不只使用 Microsoft 的工具。

我想在这里听听许多聪明的程序员的意见！我的首选选项是 SVN 或 mercurial。两者似乎都对它们的 Windows 版本有很好的支持，而且都没有 CVS 过时。另外，作为一个自称开源的弟子，我更愿意推荐一个开源工具。:)

谢谢！

**编辑**：简而言之，一般来说，其他开发人员的当前做法是复制文件夹，用日期标记，也许自己记录。你得到图片。如果我的老板说“如果它有效，为什么要修复它？”

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-02-18T00:43:52.790

让我们比较两个示例，一个使用源代码控制的开发环境，一个不使用。

*   A: 使用
*   B：*不*使用

**场景 1：请求、完成并推出一个项目**

A + B) 程序员在内部开发项目，完成后，将其推出测试，然后交付给客户（无论是谁）

*大体上没太大区别*

**场景 2：项目发布后，客户决定不想要功能 X**

A + B）开发人员删除客户不想要的代码，测试和交付。

*再次，没有太大区别。*

**场景 3：两周后，客户决定他们确实想要功能 X**

A) 开发人员将他们在 2 中取出的代码重新集成到正常的开发树中，进行测试和交付。

B) 开发人员在他们的个人机器、文件服务器和备份上搜索旧代码。如果他们找到代码，他们必须手动重新插入每个文件。如果他们不这样做，他们可能不得不重新编码整个功能。

*很容易得到你出于某种原因取出的旧代码*

**场景4：系统中有一个奇怪的错误，一个函数应该返回一个布尔结果，但总是返回false。两周前不是这样的。**

A) 开发人员检查所有旧版本的软件，并发现 return false 指令不在正确的范围内——它在循环内部而不是外部执行。

B) 开发人员花费数周时间试图找出问题所在。最终，他们注意到返回错误的线路，并修复它。没有源代码控制意味着他们必须检查每个执行的文件，而不是找出它工作时和现在的差异。

**场景 5：有人破坏了构建。它通过了测试，几周后才被发现。**

A）团队检查提交历史，找出谁破坏了构建，让那个人修复它并购买团队晚餐。

B) 团队要回溯整个项目才能找到错误，但无法弄清楚是谁把那个代码放进去的。开发人员互相指责，团队动态失败。

*很容易看出谁犯了什么、什么时候犯了、为什么犯了。*

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-18T00:28:36.680

使用源代码控制，因为您和您的团队都不是完美的。源代码控制的主要功能是确保您拥有完整的开发过程历史记录。有了这个记录，您就可以自信地使用“实验”版本进行分支，知道如果实验失败，您可以备份到较早的版本。

此外，像 svn 这样好的源代码控制系统将允许多个开发人员在同一个文件上工作，并提供强大的工具来协调每个人引入的差异。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-18T00:28:17.523

简单地说——这样你就有了代码的真实历史——调查更改（错误的原因）、恢复到版本、审计等。备份是不够的——你只需要一份**当前**图片的副本。曾经更改过文件并希望您能记住您所做的事情吗？

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-18T00:29:53.370

由于这些原因，您必须使用源代码控制

1）您可以回滚到任何版本

2) 不同的开发人员可以处理相同的文件

3) 所有开发人员都可以访问相同的代码库

4）您可以跟踪更改

5）您可以回滚不起作用的更改

6) 源代码控制是持续集成的基础，极大地帮助了 TDD

7）如果你不使用源代码控制，你会慢慢发疯，因为文件丢失/覆盖，没有任何效果

VSS 并不是最糟糕的 SCC 应用程序，我使用了多年并且越来越讨厌它，但它确实有效，很简单，而且很多人都知道它。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-18T02:05:30.457

这是一个简单的现实生活示例。

几年前，我的老板说，“功能 XYZ 以前可以工作，现在不行。没有人知道发生了什么。你能解决它吗？”

现在我以前从未使用过功能 XYZ。因此，修复它需要花很多时间试图弄清楚它的作用。

但是我们有源代码控制！所以我这样做：

*   创建一个测试脚本来测试功能 XYZ：“单击此处，键入此内容，单击此处等。”
*   获取当前版本。建造。测试。功能 XYZ 已损坏。
*   从一周前获取版本。建造。测试。功能 XYZ 有效。
*   获取介于这两者之间的版本。建造。测试。功能 XYZ 有效。
*   获取前一个版本和当前版本之间的中间版本。建造。测试。功能 XYZ 已损坏。

我一直在做这个二分搜索，直到最终我遇到了改变：版本 145（我们会说）有这个功能工作，但版本 146 已经坏了。然后我只是对这两个版本进行了比较，看看有什么变化。原来我们的技术负责人 ( *sigh* ) 签入了更改功能的代码，但也引入了破坏功能 XYZ 的副作用。

所以我消除了副作用，测试了……你瞧，功能 XYZ 再次起作用了。

**如果没有**源代码控制，您将永远无法做到这一点。您将不得不四处奔波，改变一件事或另一件事，希望能神奇地找到使功能 XYZ 再次起作用的东西。

**使用**源代码控制，您只需通过版本进行测试，查明导致问题的确切代码并修复它。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-18T01:17:14.363

在我看来，大多数人已经涵盖了源代码控制的主要功能，但忽略了其中一个最大的优点。这些是：

**分支机构**

如果没有源代码存储库，就不可能为特定目的创建代码的分支（或副本/流/等）。无法创建和合并分支是使 VSS 无法成为真正的源代码控制系统的最大原因之一。分支机构的一些目的包括：

***错误修复***

有时您需要解决错误并在远离代码的主线或主干版本的地方进行。这可能是为了解决测试环境中的问题或任何数量的原因。如果你有一个版本控制工具，你应该能够轻松地创建一个新分支（VSS 很讨厌的东西）来修复错误，并能够在必要时将其合并回主线代码

***维护版本***

这可能与错误修复大致相同，但在代码发布到生产环境后完成。示例是修订包、服务版本等。同样，您希望能够在必要时将更改合并回主干

***新功能***

有时您需要在维护当前代码的同时开始开发新版本。例如，您发布并维护 v1.0，但需要在维护 v1.0 的同时开始 v2.0 的工作。分支有助于解决这种情况

**标记/标签**

源代码控制系统所做的另一件事是在特定时间点对源代码进行快照。这些在 VSS 中称为标签，在 subversion 中称为标签等。通过定期创建这些并将它们链接到项目中的某个重要里程碑，就可以确定代码在不同版本之间的确切更改。这对审计员来说很重要，但对于追踪问题的来源/范围也很重要。VSS 在这里也失败了，因为 VSS 只对文件进行版本控制，而不是目录。这意味着如果您重命名/移动/删除存储库中的文件或目录，就不可能重新创建系统的先前版本（重构时会发生很多事情）。像 Subversion 这样好的源代码控制系统就是这样做的。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-02-18T00:28:59.393

Microsoft (MSDN) 有一篇关于源代码控制的好处的好文章。
[http://msdn.microsoft.com/en-us/library/ms173539.aspx](http://msdn.microsoft.com/en-us/library/ms173539.aspx)

关于优缺点，这里也有很多很好的问题。
[用过之后你对 git 的优缺点是什么？](https://stackoverflow.com/questions/343675/what-are-your-pros-and-cons-of-git-after-having-used-it)

Subversion 非常流行，但 Git 将成为源代码控制领域的“下一件大事”。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-18T00:29:40.030

我建议使用 SVN，因为：

1.  源代码控制为您提供出色的历史记录。您可以查看发生了哪些更改，从而提供了一种查看随时间变化的好方法（如果您每次都填写提交摘要，那就更好了）
2.  对于开发人员来说，如果出现可怕的错误，它提供了一个很好的回退。您可以将对文件的更改恢复到其历史记录中的任何时间点，因此您可以尝试制作您想要制作的模组，如果它不起作用，请轻松将其回滚。
3.  它提供了一个中央存储库，比在不同开发人员的计算机上运行更容易备份。
4.  它允许您将项目分支到不同的方向 - 对于专业化和自定义很有用。
5.  通过让您合并或以其他方式操作对一个中央副本的更改，它使多个开发人员能够在同一个项目和同一个源上一起工作。

我建议**不要**使用 VSS -出于更多原因，请参阅此页面： [http ://www.highprogrammer.com/alan/windev/sourcesafe.html。](http://www.highprogrammer.com/alan/windev/sourcesafe.html)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-18T09:14:47.460

如果当前的过程是复制一个文件夹并给它一个日期，那不是为了让您获得某种开发历史，那基本上不是一种简单的源代码控制形式吗？

因此，要回答有关源代码控制的任何批评，您已经在这样做了。现在您只需要指出当前系统中的弱点并提出更好的建议。当人们真正考虑了在开发过程中可能发生的许多复杂场景并开发了让他们处理它们的工具时，为什么还要重新发明轮子。

您当前所做的事情非常脆弱，如果出现任何复杂的情况都会失败，此时您将不得不花费大量精力来研究如何做工具已​​经做的事情。VSS 比您正在做的更好，但没有 SVN、git 或 mercurial 所具有的非常有用的约定，这些约定允许多个项目以井井有条的方式生活在一起——我说的是分支、标签和合并，两者都是其中很脆弱，基本上是vss下的噩梦。

SVN 确实有 Visual Studio 的插件。有些是免费的。但我发现 tortoise-svn 让其他任何东西都黯然失色。我发现插件的唯一好处是新文件会自动添加到 svn。

因此，您当前系统的弱点：

*   如果您必须对文件进行更改，您很可能会覆盖或被其他开发人员的更改覆盖。你甚至可能没有注意到这一点。
*   如果您必须记住您更改了哪些文件以将它们复制到某个“主”副本上，那么您可能会在某个时候错过一个。
*   祝您好运找到任何有关您何时进行更改以及更改原因的文档。
*   您如何在当前系统上构建稳定的自动化构建系统？巡航控制和哈德森工作得很好，你自己一瘸一拐
*   VSS 不能很好地将多个文件的更改组合在一起。现代的一切都非常好，并且具有原子一致性。
*   VSS 分支和合并支持很糟糕。当我们使用它时，我们最终用源代码中的注释将每个更改括起来，并手动复制代码而不是依赖 VSS 合并。
*   在您当前的系统中，要在实时维护中拥有某个版本的代码，而在大量开发中拥有其他一些更高版本的代码，这将是非常困难的，几乎是不可能的。想想像这样保持两个项目同步需要什么，你需要一个好的工具。SVN 可以，git 可以做得很好。

这可能足以继续下去，可以做得更多。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-20T17:28:36.510

在任何情况下，拥有一些版本控制系统都会有所帮助：

## 单个开发人员，单个分支

*   如果每个版本控制系统想要称自己为版本控制，它必须完美执行的最基本任务是能够**返回到**项目的指定版本。如果你把事情搞砸了，你可以回到以前的版本。您可以检查一些以前的版本以检查它是如何完成的（例如在重构之前，或者在删除某些代码/文件之前它是如何完成的）。

    与简单地保存具有指定日期的备份副本相比，版本控制系统占用*的磁盘空间要少得多，因为它们使用增量化（仅存储与先前版本的差异）和压缩。*通常*备份系统*是存储项目的最后 N 个版本的方法，有时 N=1（仅以前的版本），而版本控制系统 (VCS) 存储项目的所有历史记录。在删除最后一个版本后了解 Murphy 一段时间，您会意识到那是您想要检查的版本。

    此外，回到上一个版本是简单和自动化的。您还可以检查单个文件在某个过去版本中的外观，并且您可以获得当前状态和某个过去版本之间的差异（以差异格式）。您还可以**标记**（或“标签”）版本，因此您不仅可以按日期或当前版本的第*n*个版本来引用过去的版本，还可以通过符号名称来引用过去的版本，例如`v1.2`or `v1.2-rc0`。

*   使用版本控制系统，您可以**检查历史记录**以提醒您为什么（以及如何）某些代码（给定文件的某些部分）到达当前状态。大多数 VCS 允许检查文件的逐行历史记录，即注释文件的每一行何时更改、在什么提交中以及由谁更改（命令名为`annotate`，`blame`或`praise`取决于 VCS）。在某些 VCS 中，您可以搜索历史以查找引入给定代码片段的版本（修订版）（例如，在 Git 中称为“pickaxe search”，VCS 之一）。

    要使此功能真正有用，您必须保持一定的纪律：您应该*描述*每个新版本（每个新修订/每个新提交）并写下进行更改的原因。这样的描述（提交消息）非常有用，但它在备份系统中并没有自然的位置。

    如果您不是唯一的开发人员，此功能当然会更加有用...

*   使用版本控制系统允许在代码中查找错误的替代方法，即通过搜索历史来查找引入错误的版本：**bisectiong history**。当您找到引入错误的修订版时，您将有有限的（在最好的情况下：非常有限）区域来搜索错误，因为错误必须在最后一个工作版本和第一个有错误的版本之间的差异。此外，您还会有更改的描述（提交消息）以提醒您想要做什么。此功能有时也称为**差异调试**。现代版本控制系统 (VCS) 支持*自动化*（或半自动）通过将历史一分为二（将历史分成两半，查找包含错误的部分，重复直到找到单个负责版本）以`bisect`（或类似）命令的形式搜索历史。

    要使此功能真正有用，您必须遵守一些纪律：您应该提交（保存更改/将给定状态放入版本控制系统以记住）单个更改，只处理一个功能，与以前的版本只有很小的区别；即经常提交。

*   大多数版本控制系统都提供了各种**钩子**，例如允许自动测试或自动构建产品......或者只是提醒您不遵循编码标准（编码指南）。

## 单个开发人员，多个分支

*   版本控制系统允许创建多个替代的并行开发线，称为分支（或流或视图）。常见的情况是有**开发分支**，即有单独的分支用于不稳定的开发（测试新功能），单独的分支用于稳定（主要，主干）版本，这是（或应该是）当前工作版本，以及一个单独的维护（修复） ) 分支。

    拥有维护分支允许您进行错误修复并生成服务包/次要版本，并对某些已发布版本进行更正，而无需担心新开发的干扰。稍后您可以将维护分支合并到稳定分支中，或者从维护分支中选择 bigfix 到稳定分支和开发分支中（如果进一步/其他开发没有独立修复错误）。

*   现代 VCS（这里现代意味着分支和合并分支都很容易）允许更进一步，即生成单独的分支来处理单独的功能（所谓的**主题分支**）。这允许您在使用一项功能和处理另一项功能之间进行切换（而不仅仅是从开发新功能切换到处理紧急请求的错误修复）。

*   如果您正在基于其他（通常是第三方）产品的来源开发产品，那么您确实应该使用**供应商分支**，以便能够轻松地将供应商的产品的新版本与您所做的更改集成。诚然，这不再是纯粹的“单一开发者”案例。

## 多个开发者

*   如果有多个开发人员在同一项目上工作，则使用版本控制系统会带来更多优势。VCS 允许**并发（并行）开发**，而不必担心有人会覆盖您的更改，或者不会考虑您的更改。当然，使用版本控制系统并不能代替通信。

*   在多开发人员的情况下，上述所有功能甚至更为重要：检查谁生成了给定的更改，谁最后更改了代码（也就是谁破坏了构建），发现代码中的错误不是仅由您编写的。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-18T01:13:54.510

在你说任何话之前，找出你的公司为什么不使用源代码控制。

一旦您知道原因，就很容易想出源代码控制可以提供帮助的方案。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-18T01:27:03.997

关于为什么你绝对应该拥有源代码控制的长时间讨论：

[小型开发团队（1-2 名程序员）是否需要版本控制？](https://stackoverflow.com/questions/52608/is-subversion-version-control-necessary-for-a-small-development-group-1-2-prog/52624#52624)

我对该线程的评论：

> 即使您自己在一个项目上工作，您也总是希望拥有某种源代码控制。
> 
> 拥有更改历史对于能够在任何给定时间查看代码库的状态至关重要。回顾项目历史的原因有很多，从能够回滚错误的更改到为旧版本提供支持（当客户只想要补丁来修复错误而不是升级到新版本）软件。
> 
> 没有某种源代码控制是纯粹的精神错乱。

就 VSS 而言 - 总比没有好。它绝对不是最好的源代码控制，而且它已经过时了，但事实上它继续为很多公司做这项工作。

如果您的老板决定坚持使用 Microsoft 工具，请选择 Team Foundation Server 而不是 VSS。这是一个比 VSS 更好的系统，并且它具有集成错误跟踪等不错的功能。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-02-18T00:29:36.677

简单：如果代码不是源代码安全的，则它不存在

Subversion 是免费的，而且比 VSS 更好，但 VSS 绝对比没有更好。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-18T00:54:25.743

从我这里拿走，**VSS吹**。这是带有历史记录的基本文件存储。什么都比VSS好，VSS总比没有好:)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-20T17:58:17.203

> 那么，你们能告诉我为什么开发人员必须使用源代码控制吗？

*   它为整个团队提供了一种方法；每个人都在相同的“基本规则”下运作。
*   变化有序与混乱，节省开发时间。
*   跟踪变化的能力促进了问责制，并且更容易找到合适的人来解决维护的材料中的问题。
*   可以快速轻松地生成所做的确切更改列表，从而更轻松地向用户提供有关其在版本之间如何更改的信息。
*   如果在更改过程中出现严重错误，很容易“回滚”到信息的早期版本。

**源代码控制就像保险！你希望你永远不需要它，但很高兴你拥有它！**

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-20T18:17:55.893

因为：

1.  它将降低成本 - 与他们当前的临时方法相比，开发人员将不得不花费更少的时间检查一个真正的 VCS 中的项目。

2.  它将保护组织的知识产权——这应该是任何软件公司最重要的考虑因素（除了数据......）。您为创建软件而付费 - 它不应该完全可以访问吗？

3.  它将提供更快、更可靠和更直接的备份机制——所有 VCS 都内置了转储功能。这些往往比简单的文件副本更成熟。

4.  它将充当开发人员之间的通信机制 - 根据版本控制系统，您可以使用评论/标签/签出状态来确定其他人是否在处理文件，是否已升级到生产，是否有相应的支持票号等

5.  它简化了开发 - 比较文件版本以及其他机制的能力将对您的公司时期有益。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-18T01:39:05.667

我真的很抱歉，但如果你真的不得不在开发环境中争论源代码控制的[形式化]，那么你就处于绝望的境地。如果你的老板确实需要说服源代码控制是一项值得的努力，那么你的老板根本不适合担任一群软件开发人员的经理。为了让某人有效地管理，他们至少需要对景观有基本的了解。我什至无法想象当你真的需要为一些值得争论和做演示的事情争论时会发生什么。

没有源代码控制的开发就像开车不停歇。你失去了进行无缝并发开发的能力，你失去了在工作副本中备份代码的能力，你失去了通过代码注释进行历史研究的能力，你失去了查看伴随离散更改的上下文和注释的好处，你只是输，期间。使用源代码控制是如此明显并且有如此多的好处，令人震惊的是你不得不证明它是合理的。

在工作中，我们使用颠覆，但一些开发人员（包括我自己）通过 git-svn 桥在本地使用 Git。对于个人工作，我使用 Git。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-18T01:39:37.757

# 为什么你的团队不应该采用源代码控制？

即使作为一个单独的开发人员，我也使用源代码控制。在现代软件开发环境中，我几乎想不出为什么不使用源代码控制的原因。更令人惊讶的是，您还没有它。这个问题让我印象深刻，就像房屋油漆工在问“我们为什么要使用梯子。你知道，梯子不能粉刷房子——刷子可以。”

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-02-18T00:32:39.493

为什么要做正式演讲？

假设团队规模至少为两个，做一个真实的例子：让两个（或更多，越多越好）人获取代码，进行更改，并展示如何使用任何*非源代码控制*来集成所有这些更改表示你使用。

然后使用源代码管理执行相同的场景。

使用源代码管理节省的时间和痛苦将不言而喻。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-18T00:36:47.283

坚持底线，解释它与金钱的关系，你的老板可能会听。

如果你只是一个程序员，我想说的主要论点是减少你浪费时间（以及金钱）修复简单错误、试图回滚变成错误想法的代码等的机会。

如果您是不止一个程序员，那么上述内容会重复两次，而且这是能够在同一个代码库上一起工作而不会浪费更多时间等待彼此的唯一明智的方式，

Visual Source safe 总比没有好，但有几乎在各个方面都更好的免费选项。如果你的老板需要一个演示来理解为什么源代码控制是必不可少的，他可能不会关心你使用什么工具，一旦他得到启发。你有使用其他工具的经验而不是再次使用 vss 与底线有关，所以这可能就足够了。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-20T18:28:10.207

说服管理层在 SCCS 上投入时间的最简单方法是专注于备份和归档。通过使用 Subversion (SVN) 之类的东西，您可以立即将任何项目恢复到任何时间点。无需有人查看备份磁带或担心在钝目录结构中跟踪多个版本。

显然还有许多其他优势（即 2 个人同时处理同一个文件），但备份是多年前我的公司迅速卖掉的东西。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-18T01:41:50.840

我们使用版本控制的主要原因是一致性。

如果项目不一致，就会出现问题，代码就会丢失。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-18T02:04:48.070

确保你已经为团队的其他成员买单。也许您可以在它们上测试您的演示文稿？希望他们也看到了需求。

很高兴看到自下而上的良好实践。如果它来自他们自己的一个人而不是某些管理任务，也许每个人都更有可能采用这种做法。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-20T18:02:41.500

为了避免类似的事情

```
 "Hey! What happens ? It worked yesterday." 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-02-20T18:33:08.010

其他人在其他地方提到了源代码控制的具体好处，但我想明确解决问题的“VSS”部分。

如果您的老板想使用 Microsoft 工具，Team Foundation Server 与 Team Suite 是一个非常好的组合。它还包括其他工具，例如错误跟踪、文档和报告功能，这是一个很好的平台，可以在以后改进您的流程。我们对我工作的地方非常满意，我的同事告诉我关于 VSS 的恐怖故事。

记住 TFS 作为对“Microsoft 工具”问题的回应。

# javascript - 为什么这个 javascript 在 IE7 或 Safari 中不起作用？

> ID：559335
> 
> 赞同：-1
> 
> 时间：2009-02-18T00:25:38.463
> 
> 标签：javascript

Firefox 处理得很好，但 Safari 和 IE7 静默失败并且不插入元素。

```
<script type="text/javascript">
  var ul = document.getElementById('xg_navigation').getElementsByTagName('ul')[0];
  ul.innerHTML = '<li id="xg_tab_home" class="xg_subtab"><a href="http://somedomain.com/">Some Text</a></li>' + ul.innerHTML;
</script> 
```

这是一个现有的 html 结构，如：

```
<div id="xg_navigation">
  <ul>
    <li><a href="...">Foo</a></li>
    ...
  </ul>
</div> 
```

我无法控制 HTML，但我可以在页面正文中插入一段 javascript。

可悲的是，我似乎对跨浏览器 javascript 支持的教育很差。我是否需要以某种方式通过 onPageLoad 之类的事件将其连接起来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T00:28:26.430

似乎您在加载 DOM 之前正在对其进行操作，请尝试在`window.onload`侦听器中添加该代码片段：

```
<script type="text/javascript">
window.onload = function() {
    var ul = document.getElementById('xg_navigation').getElementsByTagName('ul')[0];
    ul.innerHTML = '<li id="xg_tab_home" class="xg_subtab"><a   href="http://somedomain.com/">Some Text</a></li>' + ul.innerHTML;
}
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T00:27:43.967

是的，在文档加载完成之前，IE 无法访问 DOM 元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T00:30:06.270

通常您必须等待 DOM 准备好执行修改 DOM 的脚本。

一个简单的方法是使用[jQuery](http://jquery.com/)：

```
$(function() { 
    $('#xg_navigation ul').prepend('<li id="xg_tab_home" class="xg_subtab"><a href="http://somedomain.com/">Some Text</a></li>');
}); 
```

# javascript - self.close() 不适用于 Mozilla

> ID：559355
> 
> 赞同：3
> 
> 时间：2009-02-18T00:30:26.877
> 
> 标签：javascript

self.close() 在 IE 中运行良好，但在 Mozilla 中运行良好。有谁知道问题是什么，我该如何解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T00:32:32.300

你打开窗户了`window.open`吗？[根据 window.close 上的文档](https://developer.mozilla.org/En/DOM/Window.close)：

> 仅允许为使用 window.open 方法的脚本打开的窗口调用此方法。如果窗口不是由脚本打开的，JavaScript 控制台中会出现以下错误：脚本可能不会关闭不是由脚本打开的窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T00:37:07.220

尝试`window.close()`改用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T00:55:15.633

请参阅我对[其他问题](https://stackoverflow.com/questions/375406/375640#375640)的回答。您应该能够轻松地将其从 ASP.NET 调整为纯 HTML。

基本上，由于mozilla只会让你关闭一个由js打开的窗口，你可以打开一个新窗口并定位_self：

```
window.open('close.html', '_self', null); 
```

现在你的窗口是用js打开的，你可以用js关闭它！:) 关闭.html：

```
<html><head>
 <title></title>
 <script language="javascript" type="text/javascript">
     var redirectTimerId = 0;
     function closeWindow()
     {
         window.opener = top;
         redirectTimerId = window.setTimeout('redirect()', 2000);
         window.close(); 
     }

     function stopRedirect()
     {
         window.clearTimeout(redirectTimerId);
     }

     function redirect()
     {
         window.location = 'default.aspx';
     }
 </script>
 </head>
 <body onload="closeWindow()" onunload="stopRedirect()" style="">
     <center><h1>Please Wait...</h1></center>
 </body></html> 
```

# winapi - 如何获取任意进程的 SID/会话？

> ID：559356
> 
> 赞同：2
> 
> 时间：2009-02-18T00:30:42.993
> 
> 标签：winapi

我正在编写一个程序来枚举进程，我想找出指定进程在其下运行的 SID/用户 ID 和会话（即我*有*一个要处理的 PID/句柄，我*想要*它的 SID 和会话下运行）。有什么线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T00:47:36.010

对于 SID，调用 OpenProcess 以获取句柄，然后将句柄传递给 GetSecurityInfo()。

对于会话 ID，请使用 ProcessIdToSessionId()。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T05:43:19.153

WTSEnumerateProcesses 在这里的工作方式就像大炮一样：

[http://msdn.microsoft.com/en-us/library/aa383831%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa383831%28VS.85%29.aspx)

# django - Django中的内联表单集 - 删除某些字段

> ID：559361
> 
> 赞同：10
> 
> 时间：2009-02-18T00:32:44.657
> 
> 标签：django, django-admin, inline-formset

我需要创建一个内联表单集

`MyModel`a)完全不显示某些字段

b) 显示一些字段`MyModel`，但阻止它们可编辑。

我尝试使用下面的代码，`values()`以便将查询集过滤为我想要返回的那些值。然而，这失败了。

有任何想法的人吗？

```
class PointTransactionFormset(BaseInlineFormSet):
    def get_queryset(self):
        qs = super(PointTransactionFormset, self).get_queryset()
        qs = qs.filter(description="promotion feedback")
        qs = qs.values('description','points_type') # this does not work
        return qs

class PointTransactionInline(admin.TabularInline):
    model = PointTransaction
    #formset = points_formset()
    #formset = inlineformset_factory(UserProfile,PointTransaction)
    formset = PointTransactionFormset 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-01-26T03:55:05.787

文档中似乎没有提到的一件事是，您可以在模型表单集的参数中包含一个表单。因此，例如，假设您有一个人模型表单，您可以通过这样做在模型表单集中使用它

```
PersonFormSet = inlineformset_factory(User, Person, form=PersonForm, extra=6) 
```

这允许您在模型表单级别上执行所有表单验证、排除等，并让工厂复制它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-07T20:30:21.097

这是在管理员中使用的表单集吗？如果是这样，只需在 InlineModelAdmin 上设置“ [exclude = ['field1', 'field2']”即可排除字段。](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#exclude)要显示一些不可编辑的字段值，您必须创建一个简单的自定义小部件，其 render() 方法只返回值，然后覆盖 formfield_for_dbfield() 方法以将您的小部件分配给正确的字段。

如果这不是用于管理员，而是用于其他地方的表单集，那么您应该在传递给表单集构造函数的 ModelForm 子类中进行上述自定义（排除 Meta 内部类中的属性， __init__ 方法中的小部件覆盖）。（如果您使用的是 Django 1.2 或更高版本，则可以只使用[readonly_fields](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.readonly_fields)代替）。

如果您澄清您所处的情况（管理员或非管理员），我可以使用代码示例进行更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-09T10:43:34.363

我刚刚遇到了类似的问题（不适用于管理员 - 面向用户的站点），发现您可以`inlineformset_factory`像这样传递要显示的表单集和字段：

```
factory = inlineformset_factory(UserProfile, PointTransaction, 
                formset=PointTransactionFormset,
                fields=('description','points_type'))
formset = factory(instance=user_profile, data=request.POST) 
```

哪里`user_profile`是`UserProfile`。

请注意，如果基础模型具有未包含在传递到的字段列表中的所需字段，这可能会导致验证问题`inlineformset_factory`，但任何类型的表单都是如此。

# php - 匹配正则表达式中的空格

> ID：559363
> 
> 赞同：294
> 
> 时间：2009-02-18T00:34:03.703
> 
> 标签：php, regex

如何匹配 PHP 正则表达式中的空格字符？

我的意思是像“gavin schulz”，两个词之间的空格。我使用正则表达式来确保我只允许字母、数字和空格。但我不知道如何找到空间。这就是我现在所拥有的：

```
$newtag = preg_replace("/[^a-zA-Z0-9s|]/", "", $tag); 
```

* * *

## 回答 #1

> 赞同：441
> 
> 时间：2009-02-18T00:51:49.697

如果您正在寻找一个空间，那就是`" "`（一个空间）。

如果您正在寻找一个或多个，它是`" *"`（即*两个*空格和一个星号）或`" +"`（一个空格和一个加号）。

如果您正在寻找公共间距，请使用`"[ X]"`or `"[ X][ X]*"`or `"[ X]+"`where `X`is the physical tab character （在所有这些示例中，每个前面都有一个空格）。

这些将在我见过的*每个*`"+"`* 正则表达式引擎中工作（其中一些甚至没有一个或多个字符，呃）。

如果您知道您将使用更现代的正则表达式引擎之一，那么`"\s"`它的变体就是要走的路。此外，我相信单词边界也匹配行的开头和结尾，这在您查找可能出现的单词之前或之后没有空格时很重要。

特别是对于 PHP，[此页面](http://www.wellho.net/regex/php.html)可能会有所帮助。

从您的编辑中，您似乎想要删除所有无效字符这开始是（注意正则表达式内的空格）：

```
$newtag = preg_replace ("/[^a-zA-Z0-9 ]/", "", $tag);
#                                    ^ space here 
```

如果您还想要诡计以确保每个单词之间只有一个空格，并且在开头或结尾处没有空格，那会稍微复杂一些（可能是另一个问题），但基本思想是：

```
$newtag = preg_replace ("/ +/", " ", $tag); # convert all multispaces to space
$newtag = preg_replace ("/^ /", "", $tag);  # remove space from start
$newtag = preg_replace ("/ $/", "", $tag);  # and end 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2018-01-13T01:22:23.797

# 备忘单

这是您需要了解的有关正则表达式中空格的所有内容的小备忘单：

### `[[:blank:]]`

仅限空格或制表符，而不是换行符。这和写作一样`[ \t]`。

### `[[:space:]]`&`\s`

`[[:space:]]`并且`\s`是相同的。它们都将匹配任何空白字符空间、换行符、制表符等......

### `\v`

匹配垂直 Unicode 空白。

### `\h`

匹配*水平*空白，包括 Unicode 字符。它还将匹配空格、制表符、不间断/数学/表意空格。

### `x`（e **X**倾向于标志）

忽略所有空格。请记住，这是一个标志，因此您将其添加到正则表达式的末尾，例如`/hello/gmx`. 此标志将忽略正则表达式中的空格。

例如，如果您编写一个表达式，如`/hello world/x`，它将匹配`helloworld`，但不匹配`hello world`。扩展标志还允许在您的正则表达式中添加注释。

### 例子

```
/helloworld #hello this is a comment/ 
```

如果需要使用空格，可以使用`\` 来匹配空格。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-02-18T00:48:59.563

要完全匹配空格字符，您可以使用八进制值`\040`（[Unicode 字符显示为八进制](https://www.utf8-chartable.de/unicode-utf8-table.pl?utf8=oct)）或十六进制值`\x20`（[Unicode 字符显示为十六进制](https://www.utf8-chartable.de)）。

这是正则表达式语法参考：[https](https://www.regular-expressions.info/nonprint.html) ://www.regular-expressions.info/nonprint.html 。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-18T00:37:53.910

在 Perl 中，开关是`\s`（空白）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-18T00:58:01.490

> 我正在使用正则表达式来确保我只允许字母、数字和空格

然后它就像在你已经拥有的东西上添加一个空间一样简单：

```
$newtag = preg_replace("/[^a-zA-Z0-9 ]/", "", $tag); 
```

（注意，我删除了`s|`似乎无意的？当然是多余的；如果需要，`s`您可以恢复）`|`

如果您特别想要 *a* 空间，例如*只有*一个空间，您将需要比这更复杂的表达式，并且可能需要考虑单独的非正则表达式逻辑。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-18T00:43:12.137

在我看来，在这种情况下使用 REGEX 会有点矫枉过正。为什么不只是[strpos](http://ca.php.net/manual/en/function.strpos.php)来查找空格字符。此外，正则表达式中的空格字符并没有什么特别之处，您应该能够像搜索任何其他字符一样搜索它。也就是说，除非您禁用了模式空白，在这种情况下几乎没有必要这样做。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-18T00:41:06.710

您也可以使用 \b 作为单词边界。对于名称，我会使用这样的名称：

```
[^\b]+\b[^\b]+(\b|$) 
```

**编辑**将其修改为 Perl 示例中的正则表达式

```
if( $fullname =~ /([^\b]+)\b[^\b]+([^\b]+)(\b|$)/ ) {
 $first_name = $1;
 $last_name = $2;
} 
```

**再次编辑**根据你想要的：

```
$new_tag = preg_replace("/[\s\t]/","",$tag); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-01-10T12:41:33.693

像这样使用它以允许一个空间。

```
$newtag = preg_replace("/[^a-zA-Z0-9\s]/", "", $tag) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-13T20:16:06.043

我正在尝试 [[:space:]] 在一个实例中，看起来 WordPress 中的博主正在使用非标准空格字符。看起来它会起作用。

# ruby-on-rails - Rails：Phusion Passenger 和 I18n.locale 应该如何表现？

> ID：559382
> 
> 赞同：3
> 
> 时间：2009-02-18T00:41:52.077
> 
> 标签：ruby-on-rails, internationalization, passenger, phusion

我有一个 Rails 2.2 web 应用程序在乘客 / REE 上运行

我将默认语言环境设置为`config/environment.rb`

```
config.i18n.default_locale = 'en-GB' 
```

第一个请求似乎没有设置语言环境`I18n.locale`

如果我访问一个带有 before_filter 的页面，该页面在每次后续访问任何控制器时都会设置 I18n.locale，即使它没有相同`before_filter`的设置，I18n.locale 也会得到一个 I18n.locale 设置的任何内容，例如`en-US`。

在具有相同代码的 Mongrel 上，每个请求都会获得一个`en-GB`默认的语言环境，直到由 before_filter 显式设置。

如果这是正常的乘客行为，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T01:27:15.537

> Mongrel 会“自动”重置语言环境，因为它使用不同的线程处理几乎每个请求，而 Phusion Passenger 使用相同的线程处理所有请求。

作为对此的破解，在您的前过滤器中，您始终可以在根据其他参数设置语言环境之前将语言环境设置为 nil。这样，它将始终将语言环境设置为的最后一个值重置为零。

只需确保您为用户的首选区域设置了每个请求的区域设置。

我遇到了同样的问题，因为我只是在传入参数告诉站点更改语言环境时才设置语言环境。我想这是你总是必须设置的东西，无论你是否使用 Phusion Passenger。

# ruby-on-rails - Ruby on Rails：测试 ActiveRecord 结果是否包含值

> ID：559385
> 
> 赞同：8
> 
> 时间：2009-02-18T00:43:07.673
> 
> 标签：ruby-on-rails, activerecord

下午，

假设我收集了随机选择的用户：

User.find(:all, :limit => 10, :order => "rand()")

现在从这些结果中，我想看看 ID 为 3 的用户是否包含在结果中，找出这一点的最佳方法是什么？

我想过 Array.include？但这对我来说似乎是一个死胡同。

谢谢

J.P

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T00:47:48.770

```
users = User.find(:all, :limit => 10, :order => "rand()")
users.any? {|u| u.id == 3} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T00:46:18.040

```
assert random_users.include?(User.find 3), "Not found!" 
```

如果活动记录对象具有相同的 id，则认为它们是相等的。数组#include? 尊重通过该`==`方法定义的对象相等性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T00:48:10.033

User.find(:all, :limit => 10, :order => "rand()").any? { |你| u.id == 3 }

这将使您免于进行另一个查找。

# sql-server - MS Access 应用程序 - 将数据存储从 Access 转换为 SQL Server

> ID：559394
> 
> 赞同：6
> 
> 时间：2009-02-18T00:47:59.177
> 
> 标签：sql-server, sql-server-2005, ms-access, vba, ms-access-2007

请记住，我不是 Access 大师。我精通 SQL Server 和 .Net 框架。这是我的情况：

一个承包商为我的公司构建了一个非常大的 MS Access 2007 应用程序。

该应用程序已按访问分为两层；有一个前端部分保存所有的 Ms Access 表单，然后是后端部分，它们是存储在网络上的计算机上的访问表、查询等。

当然，需要将数据存储部分转换为 SQL Server 2005，同时保留所有这些在 Ms Access 中构建的 GUI 表单。这就是我进来的地方。

我读了一点，发现您可以将表单甚至访问表链接到 SQL Server 表，但我仍然不确定到底可以做什么以及如何做。

有人做过吗？请评论有关此类工作的任何能力、限制和注意事项。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-18T04:55:23.263

**不要**使用 Access 中的升迁向导：

*   首先，它不适用于 SQL Server 2008。

*   其次，有一个更好的工具来完成这项工作：
    SSMA，Microsoft 免费提供的[SQL Server Migration Assistant for Access 。](http://www.microsoft.com/sqlserver/2008/en/us/migration.aspx)

它会为你做很多事情：

*   将数据从 Access 移动到 SQL Server
*   自动将表链接回 Access
*   由于两个数据库的差异，为您提供大量有关潜在问题的信息
*   跟踪更改，以便您可以随着时间的推移使两者保持同步，直到迁移完成。

我最近写了一篇关于它的[博客文章。](http://blog.nkadesign.com/2009/ms-access-upsizing-to-sql-server-2008/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T01:12:38.977

您有几个选择，[升迁向导](http://support.microsoft.com/kb/237980)在将结构和数据从访问 Sql 中移动方面做得不错。然后，您可以设置链接表，以便您的应用程序“应该”像现在一样工作。不幸的是，Access 使用的 Sql 方言与 Sql Server 不同，因此如果代码中有任何“原始 sql”语句，它们可能需要更改。

尽管 Access 的所有其他功能、QBE、表单等都应按预期工作，但您已链接到表。这是最简单也可能是最好的方法。

解决该问题的另一种方法是如上所述迁移数据，然后在访问范围内使用 ADO，而不是使用链接表。如果您习惯于其他语言/开发环境，这种方法有点熟悉，但这是错误的方法。Access 带有大量内置的东西，使处理数据变得非常容易，如果你重新使用 ADO/Sql，那么你就会失去许多这些好处。

我建议从应用程序的一小部分开始 - 非必要数据，然后迁移一些表，看看它是如何进行的。当然，您首先要备份所有内容。

祝你好运

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T03:16:13.367

其他人建议将 Jet 后端升级到 SQL Server 并通过 ODBC 进行链接。在理想的世界中，该应用程序无需更改任何内容即可完美运行。

在现实世界中，您会发现一些被设计为与 Jet 后端一起高效和快速的前端对象实际上不能很好地与服务器数据库一起使用。有时 Jet 猜错了，会向服务器发送一些非常低效的东西。对于记录的大规模更新尤其如此——为了不占用服务器资源（一件好事），Jet 将为每条记录发送一个 UPDATE 语句（这对您的应用程序来说是一件坏事，因为它太多太多了比单个 UPDATE 语句慢）。

您需要做的是在升级应用程序后评估应用程序中的所有内容以及存在性能问题的地方，将一些逻辑移至服务器。这意味着您可以创建一些服务器端视图，或者您可以使用直通查询（将整个 SQL 语句交给 SQL Server，而不让 Jet 担心），或者您可能需要在服务器上创建存储过程（特别是对于更新操作）。

但总的来说，假设其中*大部分*内容无需更改即可正常工作，这实际上是相当安全的。它可能不会像旧的 Access/Jet 应用程序那么快，但您可以使用 SQL Profiler 来找出阻塞是什么，并重新构建事物以提高 SQL Server 后端的效率。

如果 Access 应用程序已经被高效设计（例如，表单永远不会绑定到完整的表，而是绑定到具有限制性 WHERE 子句仅返回 1 或几条记录的记录源），那么它可能会运行得很好。另一方面，如果它使用了 Access 示例数据库和模板中的大量不良做法，您可能会遇到巨大的问题。

我认为，每个 Access/Jet 应用程序都应该从一开始就设计为总有一天它会被放大以使用服务器后端的想法。这意味着 Access/Jet 应用程序实际上将非常高效和快速，而且当您*升级*时，它会造成最小的痛苦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T01:11:52.940

这是您成本最低的选择。您将要为指向 SQL Server 的 Access 客户端设置 ODBC 连接。然后，您可以使用（我认为）“导入”选项通过 ODBC 源将表“链接”到 SQL Server。将您的数据从 Access 表迁移到 SQL Server，您可以在 SQL Server 上以您可以管理和备份的形式保存您的数据。重要的是，查询可以在 SQL Server 上作为视图编写，也可以作为链接表呈现给 Access db。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T01:12:08.510

链接访问表工作正常，但我只将它们与 ODBC 和其他数据库（Firebird、MySQL、Sqlite3）一起使用。有关主键或外键的信息没有通过。数据类型解释也存在问题：MySQL 中的日期与 Access VBA 中的日期不同。我猜这些问题在使用 SQL Server 时并没有那么严重。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T04:53:59.833

要点：如果您将 Access 中的表链接到 SQL Server，那么每个表都必须定义一个主键（承包商？访问？经验表明，可能有些表没有 PK）。如果未定义 PK，则 Access 表单将无法更新和插入行，从而有效地将表呈现为只读。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-17T05:24:18.663

看看这个 Access to SQL Server 迁移工具。它可能是少数（如果不是唯一的话）真正的点对点或服务器到服务器迁移工具作为纯 Web 应用程序运行的工具之一。它主要使用 ASP 3.0、XML、文件系统对象、数据字典对象、ADO、ADO 扩展 (ADOX)、字典脚本对象和其他一些简洁的 Microsoft 技术和技术。如果您在一台服务器上拥有源访问表，而在另一台服务器甚至同一台服务器上拥有目标 SQL Server，并且您希望将其作为 Web Internet 解决方案运行，那么这就是适合您的产品。此示例讨论了 VPASP 购物车，但它适用于任何版本的 Access 以及从 SQL 2000 到 SQL 2008 的任何版本的 SQL Server。

我正在完成通用数据库升级转换过程的开发，该过程涉及将 VPASP 购物或任何其他访问系统中的访问表、视图和索引结构自动转换为其 SQL Server 2005/2008 等效项。它直接从您的服务器运行，无需外部员工或顾问的任何外部帮助。

在 SQL Server 中创建 Access 表、索引和视图的克隆后，此数据迁移例程将选择性地将 Access 表中的所有数据迁移到新的 SQL Server 2005/2008 表中，而无需提供实际的 Access 数据库或表格内容或您的密码给任何人。

这是针对具有近 200 个表和近 300 个索引和视图的系统运行的过程的逆向工程部分，这是作为系统验收测试完成的。仍在进行中的工作，但核心部分已经到位。

[http://www.21stcenturyecommerce.com/SQLDDL/ViewDBTables.asp](http://www.21stcenturyecommerce.com/SQLDDL/ViewDBTables.asp)

我对 Access Table DDL（数据定义语言）进行自动逆向工程，并将它们转换为 SQL 等效的 DDL 语句，因为对于每个 VPASP 客户和每个版本的 VP-ASP，表结构甚至额外的表都可能略有不同.

我正在完成实际的数据转换例程，该例程将在创建这些新 SQL 表（包括任何视图或索引）后将数据从 Access 迁移到 SQL Server。它完全用 ASP 编写，包含 VB 脚本、文件系统对象 (FSO)、字典对象、XML、DHTML、JavaScript，并且运行速度非常快，正如您在 SQL Server 2008 数据库中看到的那样例子。

对近 500 个不同的数据库对象进行逆向工程可能需要 15-20 秒。对于涉及的 170 个表和 270 个索引，此示例中可能总共涉及 2,000 多个列。

我什至想出了一种方法，让您在同一台服务器上使用 2 个不同的数据库连接文件并行运行两个 VPASP 系统，以确保在 Access System 和 SQL Server 系统上输入的订单在实际切换之前产生相同的结果到生产。

John (a/k/a The SQL Dude) sales@designersyles.biz （这是一个 VP-ASP 演示站点）

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-02-18T01:55:59.450

这是我听过一位开发人员谈到的一种技术。这是如果你真的想要一个客户端-服务器应用程序之类的东西。

1.  创建分发给每个用户的 .mdb/.mde 前端文件（你会明白为什么）。
2.  对于他们需要执行 CRUD 的每个表，在 #1 的文件中都有一个本地副本。
3.  表单保持链接到本地​​表。
4.  编写 VBA 代码来处理从本地表到 SQL Server 数据库的 CRUD。
5.  报告可以基于从 SQL Server 创建的临时表（我认为不能在 mde 文件中创建临时表）。

一旦您决定如何使用单个表单来执行此操作，将相同的技术应用于其他表单并不难。在本地表上使用表单的好处是您可以将许多现有功能保留为现有应用程序（这就是他们使用并继续使用 Access 我希望的原因）。您只需要解决在 SQL Server 中来回获取数据的问题。

您可以继续拥有链接表，然后随着时间和性能需求的要求，使用这种技术逐步淘汰它们。

由于每个用户都有自己的本地文件，因此他们可以处理数据的本地副本。仅应在本地复制完成任务所需的最低要求。示例：如果他们正在更新单个记录，则表将只有该记录。当用户添加新记录时，您会注意到记录的 ID 字段为 Null，因此需要插入语句。

我猜本地表就像 .NET 中的数据集？我敢肯定，在某种程度上，这是一个不完美的类比。

# reporting-services - 在 Reporting Services 2008 中是否有 Me.Value 的替代品？

> ID：559399
> 
> 赞同：3
> 
> 时间：2009-02-18T00:49:58.797
> 
> 标签：reporting-services

在我们为 SQL 2005 编写的一些 SQL Server Reporting Services 报告中，我们使用隐藏表达式中的 Me.Value 来确定是否应显示单元格。这适用于 SSRS 2005（即使它可能不应该有）。

但是，它不再适用于 SSRS 2008。是否有我们可以使用的替代方法（除了使用实际字段）？

**编辑：**我需要一些适用于 SSRS 2005 和 2008 的东西，因为这些报告将分发到多个地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T00:54:28.940

您是否尝试过使用控件？

就像是：

```
ReportItems!TextBox1.Value 
```

[MSDN 上的报告项目](http://msdn.microsoft.com/en-us/library/bb934329.aspx)

# c# - 从 Oracle Reports 创建黑白 PDF

> ID：559401
> 
> 赞同：0
> 
> 时间：2009-02-18T00:50:39.763
> 
> 标签：c#, oracle, pdf, image, itextsharp

我有一个必须是纯黑白的 Oracle 报告。它包含两个图像，这些图像在插入报告之前已转换为单色位图。

执行报告时，生成的 PDF 显示为黑白。当我在 Adob​​e Acrobat Professional 中查看分色时，图像有青色、品红色和黄色分色。

我尝试将图像转换为 Oracle 支持的多种格式，包括 JPG、TIF 和 GIF，但没有区别。

我们用来运行报告的应用程序是 C# 中的 ASP.NET Web 应用程序。我们有用于 PDF 操作的 iTextSharp 库。

是否有任何 Oracle Report 设置或 C# 代码可以确保 Oracle Reports 创建的 PDF 是纯黑白的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T10:32:00.060

.NET 的 ABCpdf 库可用于重新着色 PDF 文档（即将 CMYK 图像转换为黑白）。更多信息可以在[http://www.websupergoo.com/abcpdf-1.htm](http://www.websupergoo.com/abcpdf-1.htm)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T09:50:45.347

我认为如果您选择了 CMYK 模拟配置文件，即使您只有黑色，acrobat pro 也会始终显示 CMYK。您应该能够通过在输出预览中关闭黑色分离来验证没有 CMY。

如果您真的想要一个程序化解决方案，您可以使用带有预检配置文件的 enfocus 库，如果出现以下情况，则会出现错误： - 分色数 > 0 - （不计算黑色） - （如果色调为 0%，则不计算）

如果要自动修复文档，应该有一个将 CMYK 转换为灰色的操作列表。

然而 Pitstop 库是 C 而不是 C#，但应该可以构建一个包装器。

# java - Android将项目添加到全局上下文菜单

> ID：559405
> 
> 赞同：7
> 
> 时间：2009-02-18T00:52:28.977
> 
> 标签：java, android, menu, contextmenu

当您在 Android 中长按某些内容时，会出现一个上下文菜单。我想为`TextViews`系统中的所有人在此上下文菜单中添加一些内容。

例如，系统使用复制和粘贴来执行此操作。我想添加我自己的，并让它出现在每个应用程序中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T22:18:49.637

目前 Android 不支持这一点，如果没有特定活动实现您公开的意图或活动，则无法在系统级别全局覆盖或挂钩功能。即使在发布意图的情况下，除非运行的应用程序是消费者，否则所有基本系统应用程序以及显然在您之前的所有应用程序都不会在不更新应用程序的情况下使用。

基本上就目前而言，这是不可能的。

你到底想用这个全局上下文菜单来完成什么，某种在你的应用程序中运行的全局“搜索”或“发送到”功能？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-01-03T08:58:51.773

在您的文件 android-manifest.xml 中添加意图过滤器：

```
<activity
   android:name=".ProcessTextActivity"
   android:label="@string/process_text_action_name">
  <intent-filter>
     <action android:name="android.intent.action.PROCESS_TEXT" />
     <category android:name="android.intent.category.DEFAULT" />
     <data android:mimeType="text/plain" />
 </intent-filter>
</activity> 
```

在方法 onCreate() 中通过活动中的用户文本突出显示您的应用程序：

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.process_text_main);
    CharSequence text = getIntent()
      .getCharSequenceExtra(Intent.EXTRA_PROCESS_TEXT);
    // process the text
} 
```

更多信息请参阅有关[medium](https://medium.com/androiddevelopers/custom-text-selection-actions-with-action-process-text-191f792d2999)的文章。

感谢用户：[YungBlade](https://ru.stackoverflow.com/users/195759/yungblade)

他在[ru.stackoverflow.com上回答](https://ru.stackoverflow.com/a/927864/238266)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T09:19:52.673

唔; 我不知道您是否可以像示例中那样扩展内置类型。Ruby（我的 Java 知识还不够深）。

但是，您可以从 TextView 派生出您自己的 MyTextView。然后将所有 TextView 替换为如下布局：

```
<TextView android:id="@+id/TextView01" /> 
```

到

```
<com.mydomain.mypackage.MyTextView android:id="@+id/TextView01" /> 
```

自动更改所有这些字段的类型。

然后你需要覆盖所有的构造函数（尤其是`TextView(Context context, AttributeSet attrs)`）。

之后，所有布局充气机（自动或手动）都会毫不费力地创建这种类型。

然后，您可以根据需要创建/注册上下文菜单回调。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T22:12:28.560

这可能有点麻烦，但是您可以在应用程序/活动级别捕获菜单键，检查您当前的活动视图是否是文本输入视图，然后构建并显示您自己的自定义弹出菜单。

这是可能的，只是有点棘手。

如果您创建/膨胀一个 TextView，对其调用 setFocusable(false)，然后将其设置为活动视图，您的**Activity**仍将接收关键事件。您必须手动将所有这些事件（轨迹球、触摸、按键）转发到您的视图树。（在您的“onKeyDown”函数中，您必须为顶级视图调用适当的“onKeyDown”方法）您必须有效地捕捉“焦点”的概念并自己将其分配给正确的视图。

虽然有点难看，但它可能会给你想要的结果。

但是，这仅适用于您自己的应用程序。以前的答案是正确的，因为在整个手机上是不可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-18T01:55:42.090

按下选择菜单中的共享按钮（三点树）。然后你应该选择你自己的应用程序。不幸的是，不适用于输入字段内容。

# c# - 连接列表中的所有字符串 使用 LINQ

> ID：559415
> 
> 赞同：617
> 
> 时间：2009-02-18T00:56:57.530
> 
> 标签：c#, linq, .net-3.5

是否有任何简单的 LINQ 表达式可以将我的整个`List<string>`集合项连接到一个`string`带有分隔符的单个项？

如果集合是自定义对象而不是`string`怎么办？想象一下我需要连接`object.Name`.

* * *

## 回答 #1

> 赞同：1135
> 
> 时间：2009-02-18T00:58:37.420

```
String.Join(delimiter, list); 
```

足够了。

* * *

## 回答 #2

> 赞同：555
> 
> 时间：2009-02-18T01:17:01.883

## 警告 - 严重的性能问题

尽管此答案确实产生了预期的结果，但与此处的其他答案相比，它的性能较差。决定使用它时要非常小心

* * *

通过使用 LINQ，这应该可以工作；

```
string delimiter = ",";
List<string> items = new List<string>() { "foo", "boo", "john", "doe" };
Console.WriteLine(items.Aggregate((i, j) => i + delimiter + j)); 
```

班级说明：

```
public class Foo
{
    public string Boo { get; set; }
} 
```

用法：

```
class Program
{
    static void Main(string[] args)
    {
        string delimiter = ",";
        List<Foo> items = new List<Foo>() { new Foo { Boo = "ABC" }, new Foo { Boo = "DEF" },
            new Foo { Boo = "GHI" }, new Foo { Boo = "JKL" } };

        Console.WriteLine(items.Aggregate((i, j) => new Foo{Boo = (i.Boo + delimiter + j.Boo)}).Boo);
        Console.ReadKey();

    }
} 
```

这是我最好的:)

```
items.Select(i => i.Boo).Aggregate((i, j) => i + delimiter + j) 
```

* * *

## 回答 #3

> 赞同：139
> 
> 时间：2009-02-18T05:53:24.027

^(注意：此答案*不使用 LINQ*生成连接字符串。使用 LINQ 将枚举转换为分隔字符串可能会导致严重的性能问题)

## 现代 .NET（自 .NET 4 起）

这适用于实现 IEnumerable 的数组、列表或任何类型：

```
string.Join(delimiter, enumerable); 
```

这是用于可枚举的自定义对象：

```
string.Join(delimiter, enumerable.Select(i => i.Boo)); 
```

## 旧 .NET（.NET 4 之前）

这是一个字符串数组：

```
string.Join(delimiter, array); 
```

这是一个列表<字符串>：

```
string.Join(delimiter, list.ToArray()); 
```

这是一个自定义对象列表：

```
string.Join(delimiter, list.Select(i => i.Boo).ToArray()); 
```

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2010-06-21T20:55:34.500

```
using System.Linq;

public class Person
{
  string FirstName { get; set; }
  string LastName { get; set; }
}

List<Person> persons = new List<Person>();

string listOfPersons = string.Join(",", persons.Select(p => p.FirstName)); 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-02-18T01:00:57.630

好问题。我一直在使用

```
List<string> myStrings = new List<string>{ "ours", "mine", "yours"};
string joinedString = string.Join(", ", myStrings.ToArray()); 
```

它不是 LINQ，但它可以工作。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-09-13T12:44:55.517

您可以简单地使用：

```
List<string> items = new List<string>() { "foo", "boo", "john", "doe" };

Console.WriteLine(string.Join(",", items)); 
```

快乐编码！

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2010-10-19T17:37:59.663

我认为如果您在扩展方法中定义逻辑，代码将更具可读性：

```
public static class EnumerableExtensions { 
  public static string Join<T>(this IEnumerable<T> self, string separator) {  
    return String.Join(separator, self.Select(e => e.ToString()).ToArray()); 
  } 
} 

public class Person {  
  public string FirstName { get; set; }  
  public string LastName { get; set; }  
  public override string ToString() {
    return string.Format("{0} {1}", FirstName, LastName);
  }
}  

// ...

List<Person> people = new List<Person>();
// ...
string fullNames = people.Join(", ");
string lastNames = people.Select(p => p.LastName).Join(", "); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-02-18T01:03:35.970

```
List<string> strings = new List<string>() { "ABC", "DEF", "GHI" };
string s = strings.Aggregate((a, b) => a + ',' + b); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-08-13T07:41:08.217

我已经使用 LINQ 做到了这一点：

```
var oCSP = (from P in db.Products select new { P.ProductName });

string joinedString = string.Join(",", oCSP.Select(p => p.ProductName)); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-07-04T11:05:40.137

放入`String.Join`扩展方法。这是我使用的版本，它比 Jordaos 版本更简洁。

*   `""`当列表为空时返回空字符串。`Aggregate`会抛出异常。
*   可能比性能更好`Aggregate`
*   与其他 LINQ 方法结合使用时比纯方法更易于阅读`String.Join()`

**用法**

```
var myStrings = new List<string>() { "a", "b", "c" };
var joinedStrings = myStrings.Join(",");  // "a,b,c" 
```

**扩展方法类**

```
public static class ExtensionMethods
{
    public static string Join(this IEnumerable<string> texts, string separator)
    {
        return String.Join(separator, texts);
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-07-07T11:45:24.273

*这个答案旨在扩展和改进一些基于 LINQ 的解决方案的提及。这本身并不是解决此问题的“好”方法的示例。只需在适合您的需要时`string.Join` [按照建议使用。](https://stackoverflow.com/a/559419/9679987)*

##### 语境

这个答案是由问题的第二部分（一种通用方法）和一些表达对 LINQ 的深厚亲和力的评论引起的。

*   当前[接受的答案](https://stackoverflow.com/a/559461/9679987)似乎不适用于空序列或单例序列。它还存在性能问题。
*   当前[最受好评的答案](https://stackoverflow.com/a/559419/9679987)没有明确解决通用字符串转换要求，`ToString`但不会产生所需的结果。（这可以通过[添加对 的调用来`Select`](https://stackoverflow.com/a/559997/9679987)解决。）
*   [另一个答案](https://stackoverflow.com/a/559997/9679987)包括可能导致一些人相信性能问题是 LINQ 固有的注释。（“使用 LINQ 将枚举转换为分隔字符串可能会导致严重的性能问题。”）
*   我注意到这条关于[将查询发送到数据库的](https://stackoverflow.com/questions/559415/concat-all-strings-inside-a-liststring-using-linq/68285400#comment94994295_559419)评论。

鉴于没有满足所有这些要求的答案，我提出了一个基于 LINQ 的实现，以线性时间运行，使用任意长度的枚举，并支持将元素的通用转换为字符串。

##### 那么，LINQ 还是破产？好的。

```
static string Serialize<T>(IEnumerable<T> enumerable, char delim, Func<T, string> toString)
{
    return enumerable.Aggregate(
        new StringBuilder(),
        (sb, t) => sb.Append(toString(t)).Append(delim),
        sb =>
        {
            if (sb.Length > 0)
            {
                sb.Length--;
            }

            return sb.ToString();
        });
} 
```

这种实现比许多替代方案更复杂，主要是因为我们需要在我们自己的代码中管理定界符（分隔符）的边界条件。

它应该以线性时间运行，最多遍历元素两次。

`ToString`一次用于首先生成要附加的所有字符串，然后在最终调用期间生成最终结果时从零到一次。这是因为后者可能只返回恰好足够大以包含从一开始就包含所有附加字符串的缓冲区，或者它必须重新生成完整的东西（不太可能），或者介于两者之间。有关更多信息，请参见SO 上[的 StringBuilder.ToString() 的复杂性是什么。](https://stackoverflow.com/questions/24250487/what-is-the-complexity-of-stringbuilder-tostring)

##### 最后的话

如果它符合您的需要，只需`string.Join` [按照建议](https://stackoverflow.com/a/559419/9679987)`Select`使用，当您需要先按摩序列时添加一个。

该答案的主要目的是说明可以使用 LINQ 来检查性能。结果（可能）过于冗长而无法推荐，但它确实存在。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-06-19T20:48:15.503

您可以使用`Aggregate`, 将字符串连接成单个字符分隔的字符串，但如果集合为空，则会引发**Invalid Operation Exception 。**

您可以将`Aggregate`函数与**种子**字符串一起使用。

```
var seed = string.Empty;
var seperator = ",";

var cars = new List<string>() { "Ford", "McLaren Senna", "Aston Martin Vanquish"};

var carAggregate = cars.Aggregate(seed,
                (partialPhrase, word) => $"{partialPhrase}{seperator}{word}").TrimStart(','); 
```

如果你传递一个空集合，你可以使用`string.Join`不关心。

```
var seperator = ",";

var cars = new List<string>() { "Ford", "McLaren Senna", "Aston Martin Vanquish"};

var carJoin = string.Join(seperator, cars); 
```

# c# - Visual Studio 中的 // 和 /// 有什么区别？

> ID：559418
> 
> 赞同：5
> 
> 时间：2009-02-18T00:58:23.067
> 
> 标签：c#, visual-studio, documentation

Stylecop 告诉我在评论时使用 /// 而不是 //。这两者的语义区别是什么？我什么时候应该使用哪一个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-18T01:00:50.750

// 表示您自己的个人评论，其中 /// 表示可以包含特殊数据的评论，例如用于 Visual Studio 解释的标记 - 例如：

```
/// <summary>
/// This class does something.
/// </summary>
class Bob {
    ...
} 
```

这将告诉 Visual Studio Bob 类的摘要，然后将显示在您的代码完成框中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T01:00:23.013

在通过进一步的 Stylecop 规则时自己找到了它：

注释时使用 //

在为 XML 文档标题记录文档时使用 ///

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T01:03:04.863

三斜线为您提供自动生成的模板，其中自动为您提供参数和其他功能

```
/// <summary>
///  Here is your comment
/// </summary>
/// <param name="sender">parameter generated automatically</param>
/// <param name="e">as above</param>
void BindableCollection_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e) 
```

这种方法意味着诸如 NDoc 之类的工具可以搜索您的源代码以自动创建文档文件。双斜线只是没有削减它....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T01:10:39.230

没有语义上的区别，它只是一种编码或评论的风格。.NET 恰好选择了它作为评论。[对于像sandcastle](http://blogs.msdn.com/sandcastle/)这样的自动代码文档工具，遵循这些规则通常会有所帮助。

例如，[doxygen](http://www.doxygen.nl/manual/docblocks.html)对 C++ 代码有完全不同的注释风格。所以主要是为了一致性和标准

# ruby - 如何在 ruby 中快速下载大量网页？并行下载？

> ID：559420
> 
> 赞同：3
> 
> 时间：2009-02-18T00:58:58.430
> 
> 标签：ruby, download, parallel-processing, wget

我需要抓取（使用 scrAPI）400 多个网页 ruby​​，我的实际代码是非常连续的：

```
data = urls.map {|url| scraper.scrape url } 
```

实际上代码有点不同（异常处理和东西）。

我怎样才能让它更快？如何并行下载？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T01:02:58.140

```
th = []
data = []
dlock = Mutex.new

urls.each do |url|
  th << Thread.new(url) do |url|
    d = scraper.scrape url
    dlock.synchronize { data << d }
  end
end

th.each { |t| t.join } 
```

多田！（注意；凭记忆写，未经测试，可能会吃掉你的小猫等）

**编辑：**我想一定有人写了这个的通用版本，所以他们有：[http](http://peach.rubyforge.org/) ://peach.rubyforge.org/——享受吧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T01:04:30.913

这几乎是 Pickaxe 线程解释中使用的一个示例：

[http://www.rubycentral.com/pickaxe/tut_threads.html](http://www.rubycentral.com/pickaxe/tut_threads.html)

您应该能够轻松地调整 Pickaxe 代码以使用您的刮板。

# python - 如何在geodjango中使用带有OpenStreetMap的openlayers显示数据？

> ID：559431
> 
> 赞同：12
> 
> 时间：2009-02-18T01:03:40.637
> 
> 标签：python, mapping, openlayers, geodjango

我已经通过管理应用程序使用[openlayers](http://openlayers.org/)和[OpenStreetMaps](http://www.openstreetmap.org/)运行 geodjango 。

现在我想写一些视图来显示数据。基本上，我只想将点列表（在管理员中看到）添加到地图中。

Geodjango 似乎使用了一个*特殊的* [openlayers.js](http://code.djangoproject.com/browser/django/tags/releases/1.0.2/django/contrib/gis/templates/gis/admin/openlayers.js)文件来在管理中发挥它的魔力。有没有一个很好的方法来与这个接口？

如何编写视图/模板以在打开的街道地图窗口上显示 geodjango 数据，如在管理员中所见？

目前，我正在深入研究[openlayers.js](http://openlayers.org/)文件和 api 寻找“简单”的解决方案。（我没有 js 经验，所以这需要一些时间。）

我可以看到的当前方法是将以下内容添加为模板，并使用 django 添加显示点所需的代码。（基于[此处](http://openlayers.org/dev/examples/vector-features.html)的示例）

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Draw Feature Example</title>

        <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
      <script type="text/javascript">
            var map;

            function init(){
                map = new OpenLayers.Map('map');
                var layer = new OpenLayers.Layer.WMS( "OpenLayers WMS",
                        "http://labs.metacarta.com/wms/vmap0", {layers: 'basic'} );
                map.addLayer(layer);

                /*
                 * Layer style
                 */
                // we want opaque external graphics and non-opaque internal graphics
                var layer_style = OpenLayers.Util.extend({}, OpenLayers.Feature.Vector.style['default']);
                layer_style.fillOpacity = 0.2;
                layer_style.graphicOpacity = 1;

                /*
                 * Blue style
                 */
                var style_blue = OpenLayers.Util.extend({}, layer_style);
                style_blue.strokeColor = "blue";
                style_blue.fillColor = "blue";
                style_blue.graphicName = "star";
                style_blue.pointRadius = 10;
                style_blue.strokeWidth = 3;
                style_blue.rotation = 45;
                style_blue.strokeLinecap = "butt";

                var vectorLayer = new OpenLayers.Layer.Vector("Simple Geometry", {style: layer_style});

                // create a point feature
                var point = new OpenLayers.Geometry.Point(-111.04, 45.68);
                var pointFeature = new OpenLayers.Feature.Vector(point,null,style_blue);
                // Add additional points/features here via django

                map.addLayer(vectorLayer);
                map.setCenter(new OpenLayers.LonLat(point.x, point.y), 5);
                vectorLayer.addFeatures([pointFeature]);
            }
        </script>
    </head>
    <body onload="init()">
        <div id="map" class="smallmap"></div>
    </body>
</html> 
```

这是如何完成的，还是有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-29T18:51:11.807

另一种解决方案是创建一个利用 GeoDjango Admin 小部件的表单。

为此，我：

设置 GeneratePolygonAdminClass：

```
class GeneratePolygonAdmin(admin.GeoModelAdmin):
    list_filter=('polygon',)
    list_display=('object', 'polygon') 
```

表单的构建位置：

```
geoAdmin=GeneratePolygonAdmin(ModelWithPolygonField, admin.site)
PolygonFormField=GeneratePolygon._meta.get_field('Polygon')
PolygonWidget=geoAdmin.get_map_widget(PolygonFormField)
Dict['Polygon']=forms.CharField(widget=PolygonWidget())  #In this case, I am creating a Dict to use for a dynamic form 
```

填充表单的小部件：

```
def SetupPolygonWidget(form, LayerName, MapFileName, DefaultPolygon=''):
    form.setData({'Polygon':DefaultPolygon})
    form.fields['Polygon'].widget.params['wms_layer']=LayerName
    form.fields['Polygon'].widget.params['wms_url']='/cgi-bin/mapserv?MAP=' + MapFileName
    form.fields['Polygon'].widget.params['default_lon']=-80.9
    form.fields['Polygon'].widget.params['default_lat']=33.7
    form.fields['Polygon'].widget.params['default_zoom']=11
    form.fields['Polygon'].widget.params['wms_name']=YOURWMSLayerName
    form.fields['Polygon'].widget.params['map_width']=800
    form.fields['Polygon'].widget.params['map_height']=600
    form.fields['Polygon'].widget.params['map_srid']=YOUR_SRID
    form.fields['Polygon'].widget.params['modifiable']=True
    form.fields['Polygon'].widget.params['map_options']={}
    form.fields['Polygon'].widget.params['map_options']['buffer'] = 0   
    return form 
```

基于以下代码： [http ://code.djangoproject.com/browser/django/branches/gis/django/contrib/gis/admin/options.py?rev=7980](http://code.djangoproject.com/browser/django/branches/gis/django/contrib/gis/admin/options.py?rev=7980)

看起来您可以使用 extra_js 选项来包含 OpenStreetMap（我还没有测试过）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T03:11:07.013

这已经很老了，我不会像我最初想的那样四处创建模板黑客。现在我将使用[leaflet.js](http://leafletjs.com/examples/geojson.html)向django 视图发出ajax 请求，该视图将geojson 返回到leaflet geojson 层。

这使得 django 方面非常容易。

示例 Django 视图：

```
# -*- coding: utf-8 -*-
'''
'''
import json
from django.http import HttpResponse, HttpResponseBadRequest
from django.contrib.gis.geos import Polygon

from models import ResultLayer, MyModel

def get_layer_polygons(request, layer_id):
    """
    Return the polygons for the given bbox (bounding box)
    """
    layer = ResultLayer.objects.get(id=layer_id)    
    bbox_raw = request.GET.get("bbox", None)

    # Make sure the incoming bounding box is correctly formed!
    bbox = None
    if bbox_raw and bbox_raw.count(",") == 3:        
        bbox = [float(v) for v in bbox_raw.split(",")]     
    if not bbox:
        msg = "Improperly formed or not given 'bbox' querystring option, should be in the format '?bbox=minlon,minlat,maxlon,maxlat'"
        return HttpResponseBadRequest(msg)

    bbox_poly = Polygon.from_bbox(bbox)
    bbox_poly.srid = 900913 # google
    bbox_poly.transform(layer.srid) # transform to the layer's srid for querying  

    bin_size = int(bin_size)
    # build vector polygons from bin
    results = MyModel.objects.filter(layer=layer, poly__intersects=bbox_poly).transform(900913, field_name="poly")
    geojson_data = []
    for r in results:
        # loading json in order to dump json list later
        gjson = r.poly.geojson
        py_gjson = json.loads(gjson)
        geojson_data.append(py_gjson)
    return HttpResponse(json.dumps(geojson_data), mimetype='application/json') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T15:09:57.140

我认为您的解决方案是可行的，并且可能是最简单的方法。只需模板化 javascript 并使用 Django 在模板呈现时注入您的数据点。

如果您想变得更高级，您可以使用 Django 视图将数据点作为 JSON（应用程序/json）提供，然后使用 AJAX 回调并根据浏览器中发生的事件检索数据。如果您希望您的应用程序在 OpenLayers 提供的功能之外具有高度交互性，那么增加复杂性可能值得，但当然这一切都取决于您的应用程序的需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-03T22:26:06.733

您可以考虑使用[FloppyForms](http://django-floppyforms.readthedocs.org/en/latest/geodjango.html)。最后，我通常会根据自己的需要定制解决方案，但这是一种很好的入门方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-12T17:25:58.000

从 geodjango-basic-apps 项目中查看本教程：
[http ://code.google.com/p/geodjango-basic-apps/wiki/FOSS4GWorkshop](http://code.google.com/p/geodjango-basic-apps/wiki/FOSS4GWorkshop)

也许你还不需要破解你自己的 javascript

# java - 在 64 位 Linux 服务器上运行 64 位 JVM 的优点/缺点？

> ID：559433
> 
> 赞同：12
> 
> 时间：2009-02-18T01:04:16.890
> 
> 标签：java, linux, tomcat, 64-bit

我们在 64 位 Linux 2.6 服务器上运行 32 位 Sun Java 5 JVM，但显然这将我们每个进程的最大内存限制为 2GB。所以有人建议我们升级到 64 位 JVM 以消除限制。我们目前在一个服务器上运行多个 JVM（Tomcat 实例）以保持在 2GB 的限制之下，但为了简化部署，我们希望合并它们。

如果你做到了，你能分享你的经验吗？您是否在生产中运行 64 位 JVM？您会建议继续使用 Java 5，还是可以同时迁移到 Java 6*和*64 位？我们应该期待性能问题，更好还是更糟？有没有我们应该关注回归测试的特定领域？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T01:24:18.200

在[开普勒](http://kepler.nasa.gov)科学运营中心，我们有大约 50 台机器，每台机器 32-64G。JVM 堆通常为 7-20G。我们使用的是 Java 6。操作系统有 Linux 2.6 内核。

当我们迁移到 64 位时，我预计运行 64 位 JVM 会出现一些问题，但实际上并没有。内存不足的情况更难调试，因为堆转储要大得多。[Java Service Wrapper](http://wrapper.tanukisoftware.org/)需要一些修改来支持更大的堆大小。

网上有一些网站声称 GC 不能很好地扩展到超过 2G，但我没有看到任何问题。最后，我们正在进行吞吐量密集型而非交互密集型计算。我从来没有看过延迟差异。我的猜测是，随着堆大小的增加，最坏情况下的 GC 延迟会更长。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T01:31:10.150

我们使用 64 位 JVM，堆大小约为 40 Gb。在我们的应用程序中，大量数据被缓存，从而产生了大量的“老”代。默认垃圾收集设置效果不佳，需要在生产中进行一些痛苦的调整。教训：在像这样扩展之前确保你有足够的负载测试基础设施。也就是说，一旦我们解决了问题，GC 性能就非常好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-18T01:32:22.050

我可以确认肖恩的经历。我们正在运行纯 Java、计算密集型 Web 服务（自制 Jetty 集成，现在有超过 1k 的 servlet 线程，内存中加载的数据超过 6Gb），当我们使用 64 位 JVM 时，我们所有的应用程序都可以很好地扩展到 64 位 JVM。 2年前移民。我建议使用最新的 Sun JVM，因为在最近的几个版本中已经对 GC 开销进行了大幅改进。Tanukisoftware 的 Wrapper 也没有任何问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T01:37:12.507

您编写的任何假设它以 32 位运行的 JNI 代码都需要重新测试。对于将 c 代码从 32 位移植到 64 位时可能遇到的问题，请参阅此链接。它不是 JNI 特定的，但仍然适用。[http://www.ibm.com/developerworks/library/l-port64.html](http://www.ibm.com/developerworks/library/l-port64.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T17:59:54.390

从 JDK5 32 位（Windows 服务器）迁移到 JDK6 64 位后，我们在“perm gen space”内存块中出现泄漏。使用JDK参数后，它得到了解决。希望你会比我们更幸运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T07:22:16.060

如果您使用 numactl --show 您可以查看服务器中内存库的大小。我发现 GC 在使用多个内存库时无法很好地扩展。恕我直言，这更像是硬件而不是软件问题，但它同样会影响您的 GC 时间。

# python - 如何在 python 中验证域的 MX 记录？

> ID：559436
> 
> 赞同：15
> 
> 时间：2009-02-18T01:06:20.940
> 
> 标签：python, email, dns

我有大量的电子邮件地址要验证。最初我用一个正则表达式解析它们以抛出完全疯狂的那些。我留下了那些看起来很合理但仍然可能包含错误的东西。

我想查找哪些地址具有有效域，所以给 me@abcxyz.com 我想知道是否可以向 abcxyz.com 发送电子邮件。

我想测试它是否对应于有效的 A 或 MX 记录 - 有没有一种简单的方法可以只使用 Python 标准库来做到这一点？我宁愿不为我的项目添加额外的依赖项来支持此功能。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-18T01:25:06.357

标准库中没有 DNS 接口，因此您必须自行开发或使用第三方库。

不过，这不是一个快速变化的概念，因此外部库是稳定且经过良好测试的。

我成功用于与您的问题相同的任务是[PyDNS](http://pydns.sourceforge.net/)。

我的代码的一个非常粗略的草图是这样的：

```
import DNS, smtplib

DNS.DiscoverNameServers()
mx_hosts = DNS.mxlookup(hostname)

# Just doing the mxlookup might be enough for you,
# but do something like this to test for SMTP server
for mx in mx_hosts:
    smtp = smtplib.SMTP()
    #.. if this doesn't raise an exception it is a valid MX host...
    try:
        smtp.connect(mx[1])
    except smtplib.SMTPConnectError:
        continue # try the next MX server in list 
```

另一个可能比 PyDNS 更好/更快的库是[dnsmodule](http://c0re.23.nu/c0de/dnsmodule/)虽然它看起来自 2002 年以来没有任何活动，与 2008 年 8 月的 PyDNS 上次更新相比。

**编辑**：我还想指出，电子邮件地址不能用正则表达式轻松解析。您最好使用标准库 email.utils 模块中的 parseaddr() 函数（例如，请参阅我[对这个问题的回答](https://stackoverflow.com/questions/550009/parsing-from-addresses-from-email-text/550036#550036)）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-04T21:59:14.993

不在标准库中执行此操作的简单方法是使用[validate_email 包](https://pypi.python.org/pypi/validate_email "validate_email 包")：

```
from validate_email import validate_email
is_valid = validate_email('example@example.com', check_mx=True) 
```

为了更快地处理大量电子邮件地址（例如 list `emails`，您可以隐藏域并且仅在域不存在时才执行 check_mx 。例如：

```
emails = ["email@example.com", "email@bad_domain", "email2@example.com", ...]
verified_domains = set()
for email in emails:
    domain = email.split("@")[-1]
    domain_verified = domain in verified_domains
    is_valid = validate_email(email, check_mx=not domain_verified)
    if is_valid:
        verified_domains.add(domain) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-04T19:00:29.203

一种简单有效的方法是使用名为 validate_email 的 python 包。该软件包提供了这两种功能。查看这篇文章，这将帮助您[检查您的电子邮件是否真的存在](https://www.alixaprodev.com/2021/08/how-to-check-if-email-address-is-valid.html)。

# wpf - WPF：沿路径查找元素

> ID：559437
> 
> 赞同：6
> 
> 时间：2009-02-18T01:07:37.130
> 
> 标签：wpf, math, 2d

**我尚未将此问题标记为已回答。
由于赏金时间限制，当前接受的答案被自动接受**

* * *

*参考我目前正在构建的[这个编程游戏。](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)*

正如您从上面的链接中看到的那样，我目前正在构建一个用户可编程机器人在竞技场中自主战斗的游戏。

* * *

现在，我需要一种方法来检测机器人是否在特定角度检测到另一个机器人（取决于炮塔可能面向的位置）：

[替代文字 http://img21.imageshack.us/img21/7839/robotdetectionrg5.jpg](http://img21.imageshack.us/img21/7839/robotdetectionrg5.jpg)

从上图中可以看出，我已经绘制了一种坦克的视角，现在我需要在游戏中模拟它，以检查其中的每个点以查看是否有另一个机器人在视野中。

机器人只是在战斗竞技场（另一幅画布）上不断翻译的画布。

我知道炮塔的朝向（它当前面对的方向），因此，我需要找到它的路径中是否有任何机器人（并且路径应该以“视点”方式定义，如上面的图片以红色“三角形”的形式出现。我希望这张图片能更清楚地表达我想要表达的意思。

我希望有人可以指导我解决这个问题所涉及的数学。

* * *

**[更新]**

我已经尝试了您告诉我的计算，但它无法正常工作，因为从图像中可以看出， bot1 不应该能够看到 Bot2 。这是一个例子：

[替代文字 http://img12.imageshack.us/img12/7416/examplebattle2.png](http://img12.imageshack.us/img12/7416/examplebattle2.png)

在上述场景中，Bot 1 正在检查他是否可以看到 Bot 2。以下是详细信息（根据[Waylon Flinn 的回答](https://stackoverflow.com/questions/559437/wpf-finding-an-element-along-a-path/632903#632903)）：

```
angleOfSight = 0.69813170079773179 //in radians (40 degrees)
orientation = 3.3 //Bot1's current heading (191 degrees)

x1 = 518 //Bot1's Center X
y1 = 277 //Bot1's Center Y

x2 = 276 //Bot2's Center X
y2 = 308 //Bot2's Center Y

cx = x2 - x1 = 276 - 518 = -242
cy = y2 - y1 = 308 - 277 =  31

azimuth = Math.Atan2(cy, cx) = 3.0141873380511295

canHit = (azimuth < orientation + angleOfSight/2) && (azimuth > orientation - angleOfSight/2)
       = (3.0141873380511295 < 3.3 + 0.349065850398865895) && (3.0141873380511295 > 3.3 - 0.349065850398865895)
       = true 
```

根据上面的计算，Bot1 可以看到 Bot2，但是从图片中可以看出，这是不可能的，因为它们面向不同的方向。

我在上述计算中做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T01:12:06.247

机器人之间的角度是 arctan(x-distance, y-distance) （大多数平台都提供了这个 2-argument arctan 来为你进行角度调整。然后你只需要检查这个角度是否小于距离当前标题。

* * *

**编辑 2020**：这是基于问题中更新的示例代码和现已删除的 imageshack 图像的更完整分析。

1.  **Atan2：**求两点间夹角的关键函数是`atan2`。这需要向量的 Y 坐标和 X 坐标，并返回该向量与正 X 轴之间的角度。该值将始终包裹在 -Pi 和 Pi 之间。

2.  **Heading vs Orientation:** `atan2`和一般你所有的数学函数，在“数学标准坐标系”中工作，这意味着“0”的角度对应于正东，角度逆时针增加。因此，给出的“数学角度”是`Pi / 2`指`atan2(1, 0)`“从正东逆时针90度”的方向，它与点（x=0，y=1）相匹配。“航向”是一种导航概念，表示方向是从正北顺时针方向的角度。

    *   分析：在现已删除的imageshack图像中，您的191度“航向”对应于南-南-西方向。这实际上是-101 度或-1.76 度的三角“方向”。因此，更新代码中的第一个问题是将“标题”和“方向”混为一谈。`orientation_degrees = 90 - heading_degrees`您可以通过或从前者获得后者`orientation_radians = Math.PI / 2 - heading_radians`，或者您可以在数学坐标系而不是航海航向坐标系中指定输入方向。
3.  **检查一个角度是否位于其他两个向量之间：**检查一个向量是否位于其他两个向量之间并不像检查数字角度值是否介于两者之间那么简单，因为角度在 Pi/-Pi 处缠绕的方式。

    *   分析：在你的例子中，方向是3.3，视图的右边缘是方向2.95，视图的左边缘是3.65。计算出的方位角是 3.0141873380511295，恰好是正确的（它确实介于两者之间）。但是，对于像 -3 这样的方位角值，这将失败，这应该计算为“命中”。有关解决方案，请参阅[计算一个角度是否介于两个角度之间](https://stackoverflow.com/questions/12234574/calculating-if-an-angle-is-between-two-angles)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T01:12:13.347

计算每个机器人相对于当前机器人的相对角度和距离。如果角度在当前航向的某个阈值内并且在最大视野范围内，那么它可以看到它。

唯一棘手的事情是处理角度从 2pi 弧度变为 0 的边界情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T20:50:42.493

在你的机器人类中这样的东西（C# 代码）：

```
/// <summary>
/// Check to see if another bot is visible from this bot's point of view.
/// </summary>
/// <param name="other">The other bot to look for.</param>
/// <returns>True iff <paramref name="other"/> is visible for this bot with the current turret angle.</returns>
private bool Sees(Bot other)
{
    // Get the actual angle of the tangent between the bots.
    var actualAngle = Math.Atan2(this.X - other.X, this.Y - other.Y) * 180/Math.PI + 360;

    // Compare that angle to a the turret angle +/- the field of vision.
    var minVisibleAngle = (actualAngle - (FOV_ANGLE / 2) + 360);
    var maxVisibleAngle = (actualAngle + (FOV_ANGLE / 2) + 360); 
    if (this.TurretAngle >= minVisibleAngle && this.TurretAngle <= maxVisibleAngle)
    {
        return true;
    }
    return false;
} 
```

笔记：

*   +360 用于将任何负角度强制为其相应的正值，并将角度 0 的边界情况转移到更容易进行范围测试的地方。
*   这可能仅使用弧度角是可行的，但我认为它们很脏且难以阅读：/
*   有关详细信息，请参阅[Math.Atan2](http://msdn.microsoft.com/en-us/library/system.math.atan2.aspx)文档。
*   我强烈建议研究[XNA 框架](http://msdn.microsoft.com/en-us/library/bb200104.aspx)，因为它是在考虑游戏设计的情况下创建的。但是，它不使用 WPF。

这假设：

*   没有阻碍视线的障碍物
*   Bot 类具有 X 和 Y 属性
*   X 和 Y 属性位于机器人的中心。
*   Bot 类 TurretAngle 属性，表示炮塔相对于 x 轴的正角度，逆时针方向。
*   Bot 类有一个名为 FOV_ANGLE 的静态常量角度，表示炮塔的视野。

**免责声明：**这没有经过测试，甚至没有检查编译，根据需要进行调整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T10:32:51.790

实施类似的东西后的一些建议（很久以前！）：

以下假设您正在遍历战场上的所有机器人（这不是一个特别好的做法，但可以快速轻松地让某些东西工作！）

1）它更容易检查机器人是否在范围内，然后如果它当前可以在 FOV 中看到，例如

```
int range = Math.sqrt( Math.abs(my.Location.X - bots.Location.X)^2 + 
            Math.abs(my.Location.Y - bots.Location.Y)^2 );

if (range < maxRange)
{
    // check for FOV
} 
```

这确保了它可以潜在地缩短大量 FOV 检查并加快运行模拟的过程。需要注意的是，您可以在这里设置一些随机性以使其更有趣，这样在一定距离后，看到的机会与机器人的范围成线性比例。

2）[这篇文章](http://www.garagegames.com/community/forums/viewthread/12632)似乎有FOV计算的东西。

3) 作为一名 AI 毕业生......你尝试过神经网络，你可以训练他们识别机器人是否在范围内和有效目标。这将否定任何极其复杂和令人费解的数学！你可以有一个多层感知器[[1]](http://en.wikipedia.org/wiki/Artificial_neural_network)，[[2]](http://intsys.mgt.qub.ac.uk/notes/backprop.html)输入机器人坐标和目标坐标，最后得到一个不错的开火/不开火决定。警告：我觉得有义务告诉你，这种方法并不是最容易实现的，而且当它出错时可能会非常令人沮丧。由于这种算法的（简单）不确定性，调试可能会很痛苦。另外，您将需要某种形式的学习反向传播（带有训练案例）或遗传算法（另一个需要完善的复杂过程）！如果可以选择，我会使用 3 号，但它不适合所有人！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T00:43:27.923

这将告诉您 canvas2 的中心是否可以被 canvas1 击中。如果你想考虑 canvas2 的宽度，它会变得更复杂一些。简而言之，您必须进行两次检查，一次检查 canvas2 的每个相关角，而不是检查中心。

```
/// assumming canvas1 is firing on canvas2

// positions of canvas1 and canvas2, respectively
// (you're probably tracking these in your Tank objects)
int x1, y1, x2, y2;

// orientation of canvas1 (angle)
// (you're probably tracking this in your Tank objects, too)
double orientation;
// angle available for firing
// (ditto, Tank object)
double angleOfSight;

// vector from canvas1 to canvas2
int cx, cy;
// angle of vector between canvas1 and canvas2
double azimuth;
// can canvas1 hit the center of canvas2?
bool canHit;

// find the vector from canvas1 to canvas2
cx = x2 - x1;
cy = y2 - y1;

// calculate the angle of the vector
azimuth = Math.Atan2(cy, cx);
// correct for Atan range (-pi, pi)
if(azimuth < 0) azimuth += 2*Math.PI;

// determine if canvas1 can hit canvas2
// can eliminate the and (&&) with Math.Abs but this seems more instructive
canHit = (azimuth < orientation + angleOfSight) &&
    (azimuth > orientation - angleOfSight); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T05:04:21.400

使用向量数学中称为点积的概念可以很容易地实现它。

[http://en.wikipedia.org/wiki/Dot_product](http://en.wikipedia.org/wiki/Dot_product)

它可能看起来令人生畏，但并没有那么糟糕。这是处理您的 FOV 问题的最正确方法，其美妙之处在于无论您处理 2D 还是 3D（此时您知道解决方案是正确的），相同的数学运算都有效。

（注意：如果有什么不清楚的地方，可以在评论区提问，我会补上缺失的链接。）

脚步：

1）你需要两个向量，一个是主坦克的航向向量。您需要的另一个向量来自相关油箱和主油箱的位置。

对于我们的讨论，让我们假设主坦克的航向矢量是（ax，ay），主坦克位置和目标坦克之间的矢量是（bx，by）。例如，如果主油箱在位置 (20, 30)，目标油箱在 (45, 62)，则向量 b = (45 - 20, 62 - 30) = (25, 32)。

同样，为了讨论的目的，让我们假设主坦克的航向矢量是 (3,4)。

这里的主要目标是找到这两个向量之间的角度，点积可以帮助你得到它。

2）点积定义为

a * b = |a||b| cos（角度）

读作 a （点积） b 因为 a 和 b 不是数字，它们是向量。

3）或以另一种方式表达（经过一些代数操作）：

角度 = acos((a * b) / |a||b|)

角度是两个向量 a 和 b 之间的角度，因此仅此信息就可以告诉您一个坦克是否可以看到另一个坦克。

|一个| 是向量 a 的大小，根据毕达哥拉斯定理，它只是 sqrt(ax * ax + ay * ay)，|b| 也是如此。

现在问题来了，如何找出a * b（点积b）以求角度。

4) 救援来了。事实证明，点积也可以表示如下：

a * b = ax * bx + ay * 通过

所以角度 = acos((ax * bx + ay * by) / |a||b|)

如果角度小于 FOV 的一半，则说明有问题的坦克在视野中。否则不是。

所以使用上面的示例数字：

根据我们的示例数字：

a = (3, 4) b = (25, 32)

|一个| = sqrt(3 * 3 + 4 * 4)

|b| = sqrt(25 * 25 + 32 * 32)

角度 = acos((20 * 25 + 30 * 32) /|a||b|

（在将其与您的 FOV 进行比较之前，请务必根据需要将结果角度转换为度数或弧度）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T01:17:59.040

查看您的两个问题，我认为您可以使用提供的数学来解决此问题，然后您必须解决有关碰撞检测，发射子弹等的许多其他问题。这些解决起来并不容易，尤其是如果您的机器人不是正方形。我建议查看物理引擎 - codeplex 上的[farseer](http://www.codeplex.com/FarseerPhysics)是一个很好的 WPF 示例，但这使它成为一个比高中开发任务更大的项目。

我得到的最好的建议是高分，把简单的事情做得非常好，不要部分提供出色的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-05T05:00:58.540

你的炮塔真的有那么宽的射击模式吗？子弹所走的路径将是一条直线，并且它不会随着行进而变大。你应该有一个指向炮塔方向的简单矢量，代表炮塔杀伤区。每个坦克都有一个代表其脆弱区域的边界圆圈。然后，您可以按照他们对光线追踪的方式进行操作。一个简单的射线/圆相交。查看文档[Intersection of Linear and Circular Components in 2D](http://www.geometrictools.com/Documentation/IntersectionLine2Circle2.pdf)的第 3 节。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T02:31:56.967

您更新的问题似乎来自 and 的不同“零”方向`orientation`：`azimuth`0 的一个`orientation`似乎意味着“笔直向上”，但`azimuth`0 的一个“笔直向右”。

# c++ - C++ 中的 getline() - _GNU_SOURCE 不需要？

> ID：559440
> 
> 赞同：3
> 
> 时间：2009-02-18T01:09:17.207
> 
> 标签：c++, getline

首先，我对 C++ 很陌生。我相信这`getline()`不是标准的 C 函数，因此`#define _GNU_SOURCE`需要使用它。我现在正在使用 C++，而 g++ 告诉我`_GNU_SOURCE`已经定义了：

```
$ g++ -Wall -Werror parser.cpp
parser.cpp:1:1: error: "_GNU_SOURCE" redefined
<command-line>: error: this is the location of the previous definition 
```

谁能确认这是否是标准的，或者它的定义是否隐藏在我的设置中？我不确定引用的最后一行的含义。

该文件的包含如下，所以大概它是在其中一个或多个中定义的？

```
#include <iostream>
#include <string>
#include <cctype>
#include <cstdlib>
#include <list>
#include <sstream> 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T01:16:35.673

我认为从版本 3 开始的 g++ 会自动定义`_GNU_SOURCE`. 错误中的第三行支持这一点，指出第一个定义是在命令行上完成的（`-D_GNU_SOURCE`看不到 a ）：

```
<command-line>: error: this is the location of the previous definition 
```

如果您不想要它，`#undef`请将其作为编译单元的第一行。但是，您可能需要它，在这种情况下使用：

```
#ifndef _GNU_SOURCE
    #define _GNU_SOURCE
#endif 
```

您收到错误的原因是因为您正在重新定义它。如果你将它定义为它已经是什么，它不应该是一个错误。至少 C 是这样，C++ 可能会有所不同。基于 GNU 标头，我会说他们正在做一个隐含的`-D_GNU_SOURCE=1`，这就是为什么它认为你正在将它*重新定义*为其他东西。

如果您没有更改它，以下代码段应该会告诉您它的值。

```
#define DBG(x) printf ("_GNU_SOURCE = [" #x "]\n")
DBG(_GNU_SOURCE); // first line in main. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T01:12:23.547

我一直不得不在 C++ 中使用以下之一。以前从来不需要声明 _GNU_ 任何东西。我通常在 *nix 中运行，所以我通常也使用 gcc 和 g++。

```
string s = cin.getline()

char c;
cin.getchar(&c); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T03:01:59.853

Getline 是标准的，它以两种方式定义。
您可以将其作为流之一的成员函数调用，如下所示：这是在

```
//the first parameter is the cstring to accept the data
//the second parameter is the maximum number of characters to read
//(including the terminating null character)
//the final parameter is an optional delimeter character that is by default '\n'
char buffer[100];
std::cin.getline(buffer, 100, '\n'); 
```

或者您可以使用中定义的版本

```
//the first parameter is the stream to retrieve the data from
//the second parameter is the string to accept the data
//the third parameter is the delimeter character that is by default set to '\n'
std::string buffer;
std::getline(std::cin, buffer,'\n'); 
```

进一步参考 [http://www.cplusplus.com/reference/iostream/istream/getline.html](http://www.cplusplus.com/reference/iostream/istream/getline.html) [http://www.cplusplus.com/reference/string/getline.html](http://www.cplusplus.com/reference/string/getline.html)

# c# - 我应该使用一个还是多个 LINQ DataContext？

> ID：559441
> 
> 赞同：6
> 
> 时间：2009-02-18T01:10:05.427
> 
> 标签：c#, .net, sql, linq, performance

对于一个大型项目，有一个数据上下文来映射你的数据库是否有意义，你可以从你的类中与之交互？

或者将其拆分为小的数据上下文是否更有意义，这些数据上下文专注于数据库中所需的特定任务。

我对表演很好奇。据我了解，数据上下文本身是一个非常轻量级的对象，它仅在需要时初始化其内部集合等。因此，处理具有许多定义但只有两个数据表的数据上下文应该与处理特殊数据上下文一样快里面只有那两张表。

我还认为你会在 JIT 时间受益，因为第一个进行数据访问的类将编译你的 dc，它现在可供所有类使用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T02:51:40.097

我假设您在询问设计与运行时模式。我一般*说不*：

虽然可以将您的数据库划分为多个数据上下文，但当且仅当两个上下文之间的重叠为零时，这将是可取的。

*重叠不好*

例如你有一个`WebsiteContext`和一个`AdminContext`。`WebsiteContext`用于显示和`Product`实现`Order`s。A`WebsiteUser`附加到`Order`. `AdminContext`是 为 您 的`Staff`会员 处理 取消 的 退款,`Orders`这 也 可以 参考`WebsiteUser`. 还需要重置`AdminContext`密码并更新.`WebsiteUser`

您正在考虑这样做是因为您不希望网站处理甚至知道`Returns`

```
WebsiteContext
Product -- Order -- WebsiteUser

AdminContext
Staff -- Returns -- Order -- WebsiteUser 
```

在上面，我们可以看到我们在不同的数据上下文中复制了许多对象。这闻起来很糟糕，它确实表明人为地将数据库划分为不同的数据上下文是一个错误的决定。你到底有> 2个数据库，还是只有一个？重复违反了 DRY 原则（不要重复自己），因为 WebsiteContext.WebsiteUser 与 AdminContext.WebsiteUser 不同，并且当某些事情需要关心他们引用的是哪一个时，代码很可能会变得混乱。

* * *

Linq 数据上下文只是一个 OR 映射器，需要将其视为一个花哨的黑匣子，以便更轻松地编写一些数据访问代码。一些 linq 演示使您看起来不再需要其他层，但是任何复杂的程序仍然可以从分层设计中受益。

您最好将 Linq 对象仅视为对象，以便轻松传输数据并创建一个域层，将它们隐藏为实现细节。阅读 DDD - 领域驱动设计。

就其本身而言，仅使用 UI 中的 Linq 对象最类似于该`Transaction Script`模式。在这种情况下，您仍然可以从处理细节的逻辑层中受益。

* * *

虽然您可能不希望上下文的责任如此广泛，但数据上下文只是数据库的一种表示。它不是一种安全机制，它不能阻止您破坏数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T05:07:22.720

从“存储库模式”的角度来看，对于具有单独的聚合和最小化聚合之间的导航属性有一些话要说。我不是 100% 确定那是什么……**目前**我正在*考虑*使用一个中等大小的 dbml，并使用多个存储库（UI 不直接使用数据上下文 - 只有存储库类） ，将导航属性标记为内部，以便 DAL 可以使用它们......也许......

# apache-flex - 以编程方式触发 Flex 树控件中的更改事件

> ID：559453
> 
> 赞同：1
> 
> 时间：2009-02-18T01:13:46.790
> 
> 标签：apache-flex, actionscript-3, tree

我有一种方法可以将 XML 节点结构添加到当前选定的树节点。

这会附加 xml，并打开父节点以显示新添加的节点。

然后我通过设置树的 selectedItem 来选择节点。

我有一个编辑表单，可以在树更改事件上更新其值。当我在此方法中设置 selectedItem 时，节点被正确选择但更改事件永远不会触发（因此编辑器不会更新）。我试图在稍后的调用块中调用它无济于事。

有没有办法可以强制树在此时分派更改事件？

```
public function addSelected(node:XML):void{

            tree_expandItem(false);             

            var selectedItem:XML = tree.selectedItem as XML;

            selectedItem.appendChild(node);

            tree_expandItem(true);

            callLater(function():void { tree.selectedItem = node; } );  

        } 
```

以一般的方式扩展这个问题 - 我会认为更改树的 selectedItem 会导致更改事件？还是仅在用户做出更改时才被视为更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T14:24:56.233

您可以将当前在您的更改事件处理程序中的逻辑移动到一个单独的函数，然后直接调用该函数：

```
private function changeHandler(event:ListEvent):void
{
    doChangeLogic();
}

private function doChangeLogic():void
{
    //statements
}

public function addSelected(node:XML):void
{
    tree_expandItem(false);                         

    var selectedItem:XML = tree.selectedItem as XML;

    selectedItem.appendChild(node);

    tree_expandItem(true);

    callLater(function():void { tree.selectedItem = node; } );

    doChangeLogic();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T06:31:29.613

> 有没有办法可以强制树在此时分派更改事件？

使用 dispatchEvent() 方法。谢谢詹姆斯！

# c# - NHibernate 映射：Entity1 -> ValueType1-> Entity2

> ID：559457
> 
> 赞同：1
> 
> 时间：2009-02-18T01:15:01.357
> 
> 标签：c#, nhibernate, orm, mapping

我有以下域模型：

实体 1-> 值类型 1-> 实体 2

如何编写映射文件来表示上述情况（在检索 Entity1 时）？

PS：我知道当值类型不引用另一个实体（在本例中为 Entity2）时，我可以使用组件标记。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T06:49:01.197

您可以`many-to-one`在您的内部使用`component`来引用 Entity2：

```
<class name="Entity1" table="entities_table">
    <id name="Id" column="id" unsaved-value="0">
      <generator class="native" />
    </id>

    <component name="NameOfValueType1Property" class="ValueType1">
        <many-to-one name="NameOfEntity2Property" class="Entity2" />
    </component>
</class> 
```

在这种情况下，Entity2 需要是一个具有自己映射文件的持久类。

# iphone - 使用 AudioQueueServices 提取 mp3 文件持续时间

> ID：559458
> 
> 赞同：0
> 
> 时间：2009-02-18T01:16:12.650
> 
> 标签：iphone, mp3, core-audio, audioqueueservices

我已经使用 AudioQueueServices 实现了一个流式 mp3 播放器，它通过 NSURLConnection 下载 mp3。播放、暂停和搜索效果很好，但是我不知道如何在 mp3 文件仍在下载时提取音频的持续时间。我希望能够从 id3 标签中提取信息，但对如何做到这一点一无所知。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-22T09:50:46.193

您不能直接查看 Mp3 文件的时长，但您可以通过文件大小来计算，一首 3 分钟长的歌曲在 1 兆字节之间。

# asp.net - 带有列表的 ASP.NET v2.0 自定义控件的设计时问题 对于子项目

> ID：559465
> 
> 赞同：0
> 
> 时间：2009-02-18T01:18:26.793
> 
> 标签：asp.net, custom-server-controls

伙计们，

我正在用自定义控件度过一段美好的时光。该控件非常简单——它只显示一个“StepItems”列表（呈现为表格行），每个都有一个图标。当我第一次将它拖到页面上并将 StepItems 添加到它的集合时，它会完美呈现。如果我为其 Header 属性提供一些文本，那也可以完美呈现。

如果我然后查看 HTML 源视图，然后*返回*设计视图，我会收到一个错误，我的控件应该在哪里。有两种错误：

*   如果我设置 .Header 属性，错误显示为“StepProgressControl1：'someheadertext' 无法在属性'Header' 上设置。

*   如果我不设置 .Header，但将 StepItems 添加到集合中，我会得到：“ErrorStepProgressControl1：'StepItems' 无法初始化。详细信息：找不到方法：'System.Collections.Generic.List`1 StepProgressControl。 TKC.Experiment.StepProgressControl.get_StepItems()'。”

我的自定义控件的完整代码如下。如果您能提供任何帮助，非常感谢您！

*   汤姆

'=================================

导入 System 导入 System.Collections 导入 System.Web 导入 System.Web.UI 导入 System.Web.UI.WebControls 导入 System.Security.Permissions 导入 System.ComponentModel

命名空间 TKC.Experiment

```
' THIS IS THE INTERNAL "CHILD" ELEMENT
< _
    PersistenceMode(PersistenceMode.InnerProperty), _
    TypeConverter(GetType(StepItemConverter)) _
   > _
Public Class StepItem

    Private _name As String

    Public Sub New()
        Me.New("")
    End Sub

    Public Sub New(ByVal name As String)
        Me._name = name
    End Sub

    Public Property Name() As String
        Get
            Return _name
        End Get
        Set(ByVal value As String)
            _name = value
        End Set
    End Property
End Class

'=====================================================================

' THIS IS THE ACTUAL "PARENT" WEB CONTROL
< _
   ParseChildren(True, "StepItems"), _
   PersistChildren(False) _
> _
Public NotInheritable Class StepProgressControl
    Inherits WebControl

    Private _header As String = String.Empty
    Private _stepItems As New List(Of StepItem)

    Public Sub New()
        Me.Header = "StepProgressControl"
    End Sub

    < _
        PersistenceMode(PersistenceMode.Attribute) _
    > _
    Public Property Header() As String
        Get
            Return _header
        End Get
        Set(ByVal value As String)
            _header = value
        End Set
    End Property

    < _
        DesignerSerializationVisibility(DesignerSerializationVisibility.Content), _
        PersistenceMode(PersistenceMode.InnerProperty) _
    > _
    Public ReadOnly Property StepItems() As List(Of StepItem)
        Get
            If _stepItems Is Nothing Then
                _stepItems = New List(Of StepItem)
            End If
            Return _stepItems
        End Get
        'Set(ByVal value As List(of stepitem))
        '    _stepItems = value
        'End Set
    End Property

    Public Overrides Sub RenderControl(ByVal writer As System.Web.UI.HtmlTextWriter)
        MyBase.RenderControl(writer)

        Dim label As New Label()
        label.Text = Header

        label.RenderControl(writer)

        Dim table As New Table()
        Dim htr As New TableRow()

        Dim hcell1 As New TableHeaderCell()
        hcell1.Text = "Name"
        htr.Cells.Add(hcell1)

        Dim hcell2 As New TableHeaderCell()
        hcell2.Text = "Title"
        htr.Cells.Add(hcell2)

        table.BorderWidth = Unit.Pixel(0)

        Dim stepItem As StepItem

        For Each stepItem In StepItems
            Dim tr As New TableRow()

            Dim cell1 As New TableCell()
            Dim img As New HtmlImage
            img.Src = ""
            img.Alt = ""
            cell1.Controls.Add(img)
            tr.Cells.Add(cell1)

            Dim cell2 As New TableCell()
            cell2.Text = stepItem.Name
            tr.Cells.Add(cell2)

            table.Rows.Add(tr)
        Next stepItem

        table.RenderControl(writer)

    End Sub

End Class

'========================================

'THIS IS A "TYPE CONVERTER" - JUST A COSMETIC THING, NOT CAUSING TROUBLE...
Public Class StepItemConverter
    Inherits TypeConverter
    Public Overloads Overrides Function ConvertTo(ByVal context As ITypeDescriptorContext, ByVal culture As System.Globalization.CultureInfo, ByVal value As Object, ByVal destinationType As Type) As Object
        Dim obj As StepItem = DirectCast(value, StepItem)
        Return obj.Name
    End Function
End Class 
```

结束命名空间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T01:47:17.567

您将需要实现自己的 Collection 对象来表示列表 - 否则设计器将无法正确显示它。

请参阅 ICollection、IEnumerable 等接口。

# css - CSS and float problem I think ... form elements mis aligned

> ID：559466
> 
> 赞同：0
> 
> 时间：2009-02-18T01:19:12.050
> 
> 标签：css, forms

I have setup my form using CSS.. Labels float to the left and input/textareas float to the right. They align fine.

However I recently added a block with checkbox elements. For some reason, there is a margin appearing above it which I have not been able to find the solution to fix. I suspect it is a float problem but I can not figure it out. I'm generally pretty good with CSS.

*(no longer viewable)*

Notice the extra space above the checkbox block... Borders are on to help you understand where the divs lie.

So where is the offending CSS code?

Thank you!

## Update

It appears to be fine in Safari.

I am testing on firefox 3 on mac osx .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T01:43:13.660

This is because you are using a fieldset with a legend. The legend is pushing the top margin out. Legends are very difficult to style cross browser, in fact most browsers cant style them at all other than font color.

Check this link to see some research that has been done on styling legend elements (with cross browser screenshots): [legend styling](http://www.456bereastreet.com/lab/styling-form-controls-revisited/legend/)

I suggest you hide the legend, and include an extra label inside the fieldset for cross browser goodness.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T01:30:35.563

I think its this:

```
.option-row input {style.css (line 562)
display:block;
float:left;
width:10%;
} 
```

Firebug is telling me that your borders overlap. Reducing the width of that box to 8% would work, but not sure that achieves what you want?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T01:37:41.693

if i'm not mistaken, your checkbox and label within the option-row class are both defined as block-level elements. try removing the display property or setting it to inline.

# pdf - 转义字符以替换为 PDF

> ID：559467
> 
> 赞同：1
> 
> 时间：2009-02-18T01:20:21.140
> 
> 标签：pdf, escaping

谁能告诉我 PDF 文件的控制字符集，以及如何转义它们？我有一个（非放气（膨胀？））PDF 文档，我想在其中编辑文本，但我害怕不小心使用括号和其他东西制作了一些控制序列。

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-18T01:53:51.030

好吧，我想我找到了。在[PDF 1.7 规范](http://adobe.com/devnet/acrobat/pdfs/PDF32000_2008.pdf)（PDF 链接）的第 15 页上，看来我需要担心的唯一字符是括号和反斜杠。

```
序列 | 意义
---------------------------------------------
\n | 换行 (0Ah) (LF)
\r | 回车 (0Dh) (CR)
\t | 水平标签 (09h) (HT)
\b | 退格（08h）（BS）
\f | 换页 (FF)
\( | 左括号 (28h)
\) | 右括号（29 小时）
\\ | REVERSE SOLIDUS (5Ch)（反斜杠）
\ *ddd*      | 字符代码*ddd*（八进制）

```

希望这对某人有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T06:22:55.830

您可能已经知道这一点，但 PDF 文件末尾有一个索引，其中包含文档中所有内容的字节偏移量。如果您手动编辑文档，则必须确保您编写的新文本与原始文本具有完全相同的字符数。

如果您想提取 PDF 页面内容并对其进行编辑，这非常简单。我的[CAM::PDF](http://search.cpan.org/dist/CAM-PDF/)库可让您以编程方式或通过命令行执行此操作：

```
 use CAM::PDF;
 my $pdf = CAM::PDF->new($filename);
 my $page_content = $pdf->getPageContent($pagenum);
 # ...
 $pdf->setPageContent($pagenum, $page_content)l
 $pdf->cleanoutput($out_filename); 
```

或者

```
 getpdfpage.pl in.pdf 1 > page1.txt
 setpdfpage.pl in.pdf page1.txt 1 out.pdf 
```

# sqlite - 为什么 SQLite 提供其代码的合并？

> ID：559468
> 
> 赞同：5
> 
> 时间：2009-02-18T01:20:36.163
> 
> 标签：sqlite, embedded, amalgamation

每次我下载 SQLite 时，我都会发现他们提供了几个不同版本的源代码，这是我实际上从未见过的任何其他项目所做的事情。更重要的是，他们提供了源代码合并，将所有文件合并为 3 个文件。这是什么原因？仅仅是编译速度吗？还是有一些非常好的理由？其他项目是否使用源代码合并？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T01:26:22.173

正如他们[关于合并的页面上直接所述](http://www.sqlite.org/amalgamation.html)

> 除了使 SQLite 更容易融入其他项目之外，合并还使其运行速度更快。当代码包含在单个翻译单元中（例如合并中）时，许多编译器能够对代码进行额外的优化。当我们使用合并来编译 SQLite 而不是单独的源文件时，我们测量到了 5% 到 10% 的性能改进。这样做的缺点是额外的优化通常采用函数内联的形式，这往往会使生成的二进制图像的大小更大。

我自己认为最大的好处是融入其他项目。它只是使编译变得容易得多。没有构建脚本混乱以及拥有大量源文件的任何其他内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T01:22:35.630

这样做是为了更简单地整合到现有项目中。将一个 .h 和一个 .c 添加到您的项目中，您就拥有了完整的 SQLite 引擎。

我很感激。这是我需要担心的一件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T12:51:46.513

当我尝试使用 dev c++ 编译器将合并文件分配给 windows 下的单个文件时，我遇到了很多问题。因为我想让 sqlite 在名为 DJYOS 的 RTOS 中工作，所以从单个文件更改代码比从合并文件更改代码更容易。

# ajax - 如何使用 apache 为 html 文件设置不缓存标头？

> ID：559476
> 
> 赞同：1
> 
> 时间：2009-02-18T01:24:12.567
> 
> 标签：ajax, apache

我正在做一些 ajax，我得到一个静态 html 文件，该文件实际上不时在磁盘上更改。当然，IE 有一个问题，它想通过缓存我不想要的文件来提供帮助。我知道在抓取动态文件时如何解决这个问题：您只需更改动态文件中的标题。但是如何为静态 html 文件执行此操作？请注意，我使用的是 apache。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T01:58:02.783

在 Apache 级别，您可以使用 mod_expires 模块设置文档的到期日期。

从文档中：

> 此模块控制服务器响应中的 Expires HTTP 标头和 Cache-Control HTTP 标头的 max-age 指令的设置。到期日期可以设置为相对于源文件最后一次修改的时间，或者相对于客户端访问的时间。
> 
> 这些 HTTP 标头是对客户端的关于文档有效性和持久性的指令。如果已缓存，则在此时间过去之前，可能会从缓存中而不是从源中获取文档。之后，缓存副本被认为“过期”且无效，必须从源获取新副本。

更多细节在[http://httpd.apache.org/docs/2.0/mod/mod_expires.html](http://httpd.apache.org/docs/2.0/mod/mod_expires.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T13:28:29.970

如果您可以`mod_expires`按照 Marcel 的建议使用，则始终可以附加一个随机请求参数。

例如，`static_file.html`您可以`static_file.html?_=1231231231`每次都请求并更改该请求参数，而不是请求。

[jQuery](http://jquery.com/)有一个非常简单的方法来做到这一点：

```
$.ajax({cache: false, url: static_file.html}); 
```

# hibernate - 如何在 Hibernate 中限制数据库级别的用户访问

> ID：559480
> 
> 赞同：6
> 
> 时间：2009-02-18T01:25:30.613
> 
> 标签：hibernate, jboss, db2, data-access

### 应用程序

我需要实现一个可供不同用户使用的网络应用程序。每个用户对不同的表有不同的权限，例如

*   用户 A 可以从表中看到字段“名称”和“地址”`Student`*   用户 B 可以从表中看到字段“姓名”和“电话号码”，但看不到“地址”`Student`*   用户 C 可以查看和修改上述所有字段

我将在 UI 级别有一些东西来限制某些访问，例如为无权修改条目的用户隐藏“编辑”按钮。但是，我认为我应该在较低级别（也许在数据库级别？）只是为了确保数据安全。

* * *

### 问题

我正在为我的应用程序使用 Hibernate、JBoss、DB2 和 Struts。我想我应该使用某种 JBoss LoginModule，它使用用户/密码/角色对数据库进行用户身份验证（但我可能错了（？））。我做了一些研究并提出了以下选项，但似乎没有一个适合我的情况。我认为这是多用户 Web 应用程序中非常常见的数据访问问题。有人可以指出我正确的方向吗？*先感谢您！*

1.  `hibernate.cfg.xml`在JACC 事件监听器中使用“grant”标签。这可以对所有休眠实体设置“插入”“更新”“读取”权限。但是，如果我需要更精细的控制怎么办？我需要对某些字段而不是整个对象设置权限。[http://www.hibernate.org/hib_docs/v3/reference/en-US/html/objectstate-decl-security.html](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/objectstate-decl-security.html)

2.  限制每个 ejb 的 getter/setter 方法的权限。如果我理解正确，这需要为每个用户配置文件手动配置每个 bean，这对我来说似乎不现实。 [EJB 方法权限](http://www.jboss.org/file-access/default/members/jbossas/freezone/docs/Server_Configuration_Guide/4/html/J2EE_Declarative_Security_Overview-EJB_method_permissions.html)

3.  对 DAO 进行编码以检查用户权限。滚动我自己的实用函数，每次调用特定的 DAO 方法时检查一个巨大的权限表，以确定登录用户是否可以执行该操作。

4.  在 Hibernate 中使用“拦截器”和“事件”。为每个类定义特定的“onLoad”、“onSaveorUpdate”等事件和拦截器。在这种情况下，我可以为各个字段指定权限级别吗？[http://www.hibernate.org/hib_docs/v3/reference/en-US/html/objectstate-events.html](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/objectstate-events.html)

我可能是对着错误的树吠叫。以上所有似乎都是劳动密集型的，不是很聪明。以上选项都没有为我提供在运行时更改用户权限的编程方式，当管理员级别的用户想要在此应用程序中给予其他用户更多控制权时，这将很有用。

在这里进行数据访问控制的好方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T04:38:26.593

1.  为您的实体添加一个安全密钥，为权限创建一个表，并将具有权限的用户与 entitytype 以及具有角色的安全密钥相关联。这样你就可以这样说：Admin_role 可以访问 Student（实体类型）并进行读取（Permission 中的操作）和 Write（操作），而 Student_role 可以为他/她自己访问 Student_key 和 Read_permission。您可以通过将地址重构为实体并向其添加安全密钥来修复地址。

    2.  您的第四个可能有一个封闭世界假设，并说除非您可以为用户的当前角色，否则将属性名称与字典中的标志（实体+属性）-哈希链接到标志，封闭世界假设因为默认情况下不允许读取。然后当然你没有得到任何写权限等。

    3.  您可以在数据库中定义视图并使用数据库身份验证系统为其分配权限。如果您能够自己编码，这可能是最干净的方式，根据我们的角色选择调用哪个视图的方式。（我以前的 RDBMS 老师会喜欢我这样说的 ;)）这也与 Hibernate 有所不同，并将你的东西更多地耦合到数据库中。我猜这取决于您的代码需要多么可移动/可移植。

    4.  在您的通用 dao (IRepository) 周围使用一个方面，它根据您的权限重写查询；这意味着您当然在代码中具有基于权限的安全性。

隐藏在 gui 中的编辑按钮实际上只有在您首先将权限移植到代码时才能完成，就像我的第 1 点一样。我建议您查看[Ayendes 博客](http://ayende.com/Blog/category/548.aspx)以了解其开源实现，他是一个非常熟练的人编码器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T10:15:09.420

另一种选择可能是使用自定义类型。例如，不是将 char 映射到 String，而是将其映射到 SecureString 等自定义类型。在映射中给它一个带有某种唯一标识符的参数，例如 table.column。然后在自定义类型的 nullSafeGet 方法中，您可以调用安全服务来查看是填充值还是将其设置为 null。您可能还必须使用 ThreadLocal 来存储一些东西来识别用户或角色。您只需要创建一些自定义类型来包装字符串、双精度、日期、整数等。我已经做了类似的事情来允许将日期转换为用户的时区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T04:53:52.563

我喜欢[Henrik](https://stackoverflow.com/questions/559480/how-to-limit-user-access-at-database-level-in-hibernate/559870#559870)关于使用视图的建议。

休眠[过滤器](http://www.hibernate.org/hib_docs/reference/en/html/filters.html)可能会起作用，但我认为这些过滤器更多地用于过滤行而不是列。

~~您还可以使用 [基于地图的动态模型](http://www.hibernate.org/hib_docs/reference/en/html/persistent-classes-dynamicmodels.html) 以及单独的 [命名查询](http:// www.hibernate.org/hib_docs/reference/en/html/querysql-namedqueries.html），而不是使用部分填充的 bean。然后您的视图代码将简单地检查地图是否包含“地址”条目，如果找到则显示该字段？~~

# objective-c - 为什么 iPhone 应用程序的 main() 函数没有机会完成？

> ID：559482
> 
> 赞同：9
> 
> 时间：2009-02-18T01:25:54.717
> 
> 标签：objective-c, iphone

考虑以下`main()`您会发现大多数 iPhone 应用程序的方法：

```
int main(int argc, char *argv[])
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    [pool release];
    return retVal;
}
```

在我用这些在模拟器中运行的每个 iPhone 应用程序中（包括 Apple 提供的几个示例项目），线程永远不会退出`UIApplicationMain()`，并且任何剩余的代码`main()`都永远不会执行。这是预期的行为吗？

`UIApplicationMain()`我已经通过使用调试器单步执行代码来验证这些语句从未运行过。当用户停止应用程序时（例如，通过点击“主页”按钮），生成的堆栈跟踪显示 `[UIApplication _terminateWithStatus:]`最终被调用。此函数调用您的应用程序委托的`applicationWillTerminate:`方法。一旦完成，`[UIApplication _terminateWithStatus:]`似乎会杀死/退出线程。

有人可以确认这是`main()`应该如何工作的，或者至少确认他们机器上的相同行为吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-18T22:10:50.887

最初的问题是：“*为什么 iPhone 应用程序的 main() 函数没有机会完成？* ”

**简短的回答：因为 UIApplicationMain() 的编码使得它永远不会返回。**

在模拟器和设备上进行了几次测试，并要求另一个开发人员进行相同的测试后，我确认 UIApplicationMain 永远不会返回。当用户通过点击 Home 按钮正常终止应用程序时，程序最终会在名为 _terminateWithStatus 的未发布的 UIApplication 方法中终止。此方法调用 exit(0)。

此行为与 NSApplicationMain 函数（它是 UIApplicationMain 函数的 AppKit/Cocoa 版本）的行为相匹配。NSApplicationMain() 的文档清楚地表明它永远不会返回。

我已向 Apple 提交了一个错误 (6600198)，要求更正官方文档（和 main.m 的 Xcode 模板）以声明 UIApplicationMain() 永远不会返回。虽然这不是功能问题，但当前的模板和文档具有误导性。

***感谢大家的所有投入和头脑风暴！***

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T01:34:55.583

尝试：

```
int main(int argc, char *argv[])
{
    NSLog(@"Step 0");
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSLog(@"Step 1");
    int retVal = UIApplicationMain(argc, argv, nil, nil);
    NSLog(@"Step 2");
    [pool release];
    NSLog(@"Step 3");
    return retVal;
} 
```

可能是池的释放阻止了进一步的日志记录，在这种情况下，您将获得第 2 步而不是第 3 步。

如果没有打印第 2 步，则几乎可以肯定 UIApplicationMain 有问题 - 它有可能不会返回，因此将 NSLog 语句（步骤 1.1、步骤 1.2、...）放在其中的各个点并运行到找到记录的最后一条消息。

继续向下钻取（步骤 1.7.1、1.7.2、.... 1.7.6.3.2、...） - 最终，当日志消息出现时，您将追踪准确的行（无论在调用层次结构中有多深）停止被记录，那条线将是你的罪魁祸首（“关闭”记录或退出而不正常返回）。

我在网上找到的另一个片段：

=====

当您使用此行时：

```
int retVal = UIApplicationMain(argc, argv, @"MyApp", @"MyApp"); 
```

第一个 MyApp 是您的主要应用程序委托类。第二个是 SpringBoard 发送触摸通知的类。

此外，如果您使用的是 SDK，并且在 Info.plist 中定义了一个主 nib，那么您可以将调用保留为：

```
int retVal = UIApplicationMain(argc, argv, nil, nil); 
```

当你创建你的 xib 时，所有这些都会被覆盖。

=====

现在我对 iPhone 开发（特别是 xibs）的了解还不够，甚至不知道最后一点是什么意思（或者如果你设置正确的话），但这听起来像是编译的另一个阶段。

然而，我读到的第一个想法是，当按下按钮要求你做某事（比如优雅地关闭）时，Springboard 会调用你的委托类。如果它不能问你（即没有代表），它可能有权在它认为合适的时候关闭你，例如使用`[UIApplication _terminateWithStatus:]`.

在 Windows 世界中，您可能会向主窗口发送退出消息，但正如我所说，iPhone 开发可能会有所不同。

不过，这是一个调查的途径。如果您提供了一个，我会很想看看对代表进行了哪些调用。上面代码片段中包含的代码是这样的：

```
@implementation MyApp
- (void) applicationDidFinishLaunching:(id)unused {
    rect = [ UIHardware fullScreenApplicationContentRect ];
    rect.origin.x = 0.0f;
    rect.origin.y = 0.0f;
    window = [ [ UIWindow alloc ] initWithContentRect: rect ];
    [ window makeKeyAndVisible ];
    view = [ [ MyAppView alloc ] initWithFrame: rect ];
    [ window setContentView: view ];
}
- (void) dealloc {
    [ window release ];
    [ view release ];
    [ super dealloc ];
} 
```

所以也许一个代表`dealloc()`是让它退出回来的秘诀`main()`。你为什么不试一试？即使它不能解决核心问题，它也可能会让你更接近你的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T01:29:35.317

[pool release] 之​​后没有什么可登录的吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T01:34:14.463

尝试使用 fprintf 看看会发生什么

```
int main(int argc, char *argv[])
{
    /*
       ... 
     same as above
       ... 
    */
    [pool release];
    char file_name = "/tmp/log"

    FILE *file = fopen(file_name, "w");

    fprintf(file_name, "END\n");
} 
```

告诉我们会发生什么

我还认为最简单的检查方法是在返回时设置一个断点

在 gdb 中做

```
b main.c:x 
```

其中 x 是 return 语句的行号

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T05:31:11.367

调用该`UIApplicationMain`函数后，您的应用程序将启动（建立一个运行循环等），然后所有工作都应在 main 的上下文之外完成（如果您需要它在 main 中运行，请在此之前完成）。退出应用程序时，允许操作系统进行内存清理通常更有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-22T02:07:17.523

我也有过不退的经历。并设置了断点来验证，就像克林特说的那样。

wisequark 有一个很好的观点。

很棒的话题。让我感到更自在，我不是唯一一个有这个问题的人。

# c++ - CString 到 char*

> ID：559483
> 
> 赞同：17
> 
> 时间：2009-02-18T01:25:58.197
> 
> 标签：c++, mfc, memory-leaks, cstring

我们在大部分代码中都使用 CString 类。但是有时我们需要转换为 char *。目前我们一直在使用 variable.GetBuffer(0) 执行此操作，这似乎有效（这主要发生在将 Csting 传递给函数需要 char * 的函数时）。该函数接受这一点，我们继续。

然而，我们最近开始担心这是如何工作的，以及是否有更好的方法来做到这一点。

我理解它的工作方式是将一个 char 指针传递给指向 CString 中第一个字符的函数，并且一切正常。

我想我们只是担心内存泄漏或任何不可预见的情况，这可能不是一个好主意。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-18T01:37:06.437

如果您的函数只需要读取字符串而不需要修改它，请将它们更改为 accept`const char *`而不是`char *`. 将`CString`自动为您转换，这是大多数 MFC 功能的工作方式，非常方便。（实际上 MFC 使用`LPCTSTR`，这是`const TCHAR *`- 适用于 MBC 和 Unicode 构建的同义词）。

如果您需要修改字符串，`GetBuffer(0)`这是非常危险的——它不一定会为生成的字符串分配足够的内存，并且您可能会遇到一些缓冲区溢出错误。

正如其他人提到的，您需要使用`ReleaseBuffer`after `GetBuffer`。您不需要为转换为`const char *`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-10-06T15:46:46.033

@ OP： *>>> 我想我们只是担心内存泄漏或任何...*

您好，调用 GetBuffer 方法不会导致任何内存泄漏。因为析构函数无论如何都会释放缓冲区。但是，其他人已经警告过您调用此方法的潜在问题。

@Can >>>*当您调用 getbuffer 函数时，它会为您分配内存。*

这种说法并不完全正确。GetBuffer(0) 不分配任何内存。它仅返回一个指向内部字符串缓冲区的指针，该缓冲区可用于直接从 CString 类的“外部”操作字符串。

但是，如果你传递一个数字，比如 GetBuffer(N)，比如 N，并且如果 N 大于缓冲区的当前长度，则该函数通过分配更多内存来确保返回的缓冲区至少与 N 一样大.

干杯，拉杰什。MVP，视觉++。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T01:29:13.227

当您调用 getbuffer 函数时，它会为您分配内存。完成后，您需要调用 releasebuffer 来释放它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T01:29:07.923

尝试[http://msdn.microsoft.com/en-us/library/awkwbzyc.aspx](http://msdn.microsoft.com/en-us/library/awkwbzyc.aspx)上的文档以获得帮助。

# design-patterns - 伟大的软件设计和实施的例子

> ID：559484
> 
> 赞同：20
> 
> 时间：2009-02-18T01:26:07.913
> 
> 标签：design-patterns, oop, open-source, tdd, solid-principles

我希望这不是重复...

您遇到的设计和实施最扎实的软件系统/框架/应用程序是什么？

似乎 TDD、SOLID 原则、OO 设计模式以及类似的东西可以很容易地在播客和博客上使用非常简单的示例进行理论化，但是很难想象开发出完全符合这些标准的大型系统，而不需要大量代码. 在我的公司，由于时间限制，做完整的 TDD 似乎几乎不可能。

如果有人可以向我指出任何好的开源项目，我真的很想深入了解一下有什么好的 TDD/SOLID/等。好像。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T02:43:48.243

**航天飞机**软件？

[他们写了正确的东西](http://www.fastcompany.com/magazine/06/writestuff.html)

> 但该软件做了多少工作并不是让它引人注目的原因。它的显着之处在于该软件的运行效果。这个软件永远不会崩溃。它永远不需要重新启动。该软件没有错误。它是完美的，就像人类已经达到的那样完美。考虑一下这些统计数据：该程序的最后三个版本——每个 420,000 行长——每个都只有一个错误。该软件的最后 11 个版本共有 17 个错误。同等复杂度的商业程序会有 5,000 个错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T01:37:54.237

特克斯？

Knuth 仍在[为确认的错误提供奖励](http://en.wikipedia.org/wiki/Knuth_reward_check)。

* * *

顺便说一句：我不确定 Knuth 是否赞同任何流行语机制来进行真正强大的开发。不知道他是怎么做到的。也许只是注意细节。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-18T01:38:12.813

.NET 框架。

*   当我“点入”一个命名空间并且它的成员正是我所期望的时，这很棒。
*   它“正常工作”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T01:27:28.910

升压库

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-06T16:38:02.380

许多其他帖子都提到了尚未使用 TDD 实现的程序，因此没有回答“我真的很想深入研究，看看好的 TDD/SOLID/等是什么样的。” 例如，我非常肯定 Apache HTTPD Server 和 Firefox 的源代码甚至从未见过 TDD。我只是浏览了一点他们的资源，测试文件夹中只有几个小文件，生产代码看起来不像是用 TDD 或遵循 SOLID 编写的。

例如，SOLID 的发明者使用 TDD 编写了[Fitnesse 。](http://fitnesse.org/)这应该是此类代码外观的一个很好的参考，尤其是代码的较新部分（在他的书[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)中，Bob 大叔有一些来自 Fitnesse 的坏代码示例，然后他将其清理掉，因此不一定所有代码都在Fitnesse很干净）。

我还将加入我自己的项目[Dimdwarf Application Server](http://dimdwarf.sourceforge.net/)，该项目 100% 使用 TDD/BDD 编写，并尝试编写尽可能干净的代码（遵循 SOLID 等）。那里也有一些丑陋的部分（主要是在任务调度和垃圾收集中），但这些部分仍在工作中，在这些功能完成时它们将被清理干净。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T01:32:28.040

谷歌浏览器

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T02:00:45.443

**火狐2.0**

*   简单的用户界面
*   强大的功能
*   非常稳定

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T02:13:17.583

阿帕奇 httpd。

*   干净的
*   简单的
*   功能性

**另外**：Graphviz - 强大、一致性和简单性的绝佳示例。

我见过的最好的代码是礼节；它已被加工成真正优雅和美丽的东西。但遗憾的是，它必须保持匿名。

**顺便说一句**：任何可以简化的巨大接口/api，**都不**是根据定义设计的。而对于许多公司来说，大而**丑陋**的界面只会变得**越来越大**。

 **保罗。

# .net - .NET 中的 FTP 和 SNMP 支持

> ID：559489
> 
> 赞同：2
> 
> 时间：2009-02-18T01:27:41.640
> 
> 标签：.net, ftp, snmp

在过去的几个月里，我一直对 .NET 的困境感到困惑。我似乎在框架中找不到对标准协议的任何支持。我想支持 FTP 和 SNMP 将很容易移植到主框架中。但是，我发现我要么必须跳过障碍并阅读各种 RFC 文章来编写我自己的符合协议的套接字，要么我花大价钱从第三方提供商那里获得一个组件。这两种解决方案对我来说似乎都不可行。

我知道这听起来更像是一个抱怨而不是一个问题（对不起，我只是很沮丧），但我保证我会直截了当：

首先，我很好奇是否有其他人找到了解决此问题的方法。要么是创建一些支持这些协议的类的简单方法，要么是了解开源解决方案。

其次，有人知道微软是否有朝一日计划将此功能构建到框架中吗？

**解决方案：** 根据[casperOne 的回答](https://stackoverflow.com/questions/559489/ftp-and-snmp-support-in-net/559531#559531)，基础框架中支持 FTP。我最终硬着头皮选择了[nsoftware 的第三方工具](http://nsoftware.com/download/net.aspx)。将相当高的许可费放在公司 P-Card 上，并向 Bobs 解释说，该组件的成本将比他们支付给我继续构建另一个 SNMP 解决方案的费用要便宜。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T01:39:29.643

FTP 协议可以通过 System.Net 命名空间中的 FtpWebRequest 和 FtpWebResponse 类访问，并在 .NET 2.0 中引入。

我还相信您可以通过 System.Management 命名空间中的类访问 SNMP，这些类从 .NET 1.0 开始就已经存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T06:18:00.433

通过 System.Management 使用 SNMP 是一种方法。但是尝试一些开源项目不会有什么坏处。

[http://sharpsnmplib.codeplex.com](http://sharpsnmplib.codeplex.com)

# html - 如何切片 PSD？

> ID：559502
> 
> 赞同：0
> 
> 时间：2009-02-18T01:31:43.500
> 
> 标签：html, css, photoshop

有没有人有任何关于如何切片 PSD 的链接/信息可以分享？它似乎总是超出我的范围。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T01:40:59.283

这是我通过简单的搜索找到的两个教程。

它们都涵盖了将 psd 切片为 html。它可能不完全是您想要使用 psd 的目的，但它应该涵盖切片基础知识。

[http://www.partdigital.com/tutorials/convert-web/](http://www.partdigital.com/tutorials/convert-web/)

[http://net.tutsplus.com/videos/screencasts/converting-a-design-from-psd-to-html/](http://net.tutsplus.com/videos/screencasts/converting-a-design-from-psd-to-html/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T01:54:23.277

不久前我看到了这个帖子。不确定这是否正是您想要的。

**更新...哎呀抱歉不小心忘记粘贴链接了。**

[从 Photoshop 模型到语义 HTML 和 CSS 的最佳方式是什么？](https://stackoverflow.com/questions/19487/whats-the-best-way-to-go-from-a-photoshop-mockup-to-semantic-html-and-css)

[https://stackoverflow.com/questions/45903/best-way-to-convert-psd-to-css-html-file](https://stackoverflow.com/questions/45903/best-way-to-convert-psd-to-css-html-file)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-28T14:28:33.280

试试这个，如果您的 PSD 文件分层正确，它可以让您的工作更轻松：

[http://slicephotoshop.com](http://slicephotoshop.com)

# mysql - 使用 LIKE vs. = 进行精确的字符串匹配

> ID：559506
> 
> 赞同：32
> 
> 时间：2009-02-18T01:32:32.330
> 
> 标签：mysql, string, performance

首先，我认识到两者之间的区别：
- Like 使通配符 % 和 _ 可用
- 重要的尾随空格
- 排序问题

在所有其他条件相同的情况下，对于更有效的精确字符串匹配：

```
SELECT field WHERE 'a' = 'a'; 
```

或者：

```
SELECT field WHERE 'a' LIKE 'a'; 
```

或者：差异是如此微不足道以至于无关紧要吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-18T01:35:49.077

我会说 = 比较器会更快。词法不会将比较发送到另一个词法系统来进行一般匹配。相反，引擎能够匹配或继续前进。我们工作中的数据库有数百万行，并且 = 总是更快。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-18T01:42:00.637

在一个体面的 DBMS 中，数据库引擎会识别出字符串中没有通配符，并隐含地将其转换为纯相等（不一定与 相同`=`）。因此，您在开始时只会受到很小的性能影响，对于任何体面大小的查询通常可以忽略不计。

但是，MySQL`=`运算符不一定按照您期望的方式运行（作为纯粹的相等检查）。具体来说，默认情况下它不考虑`CHAR`和`VARCHAR`数据的尾随空格，这意味着：

```
SELECT age WHERE name = 'pax' 
```

将为您提供`'pax'`,`'pax<one space>'` *和* `'pax<a hundred spaces>'`.

如果要进行*正确的*相等检查，请使用`binary`关键字：

```
SELECT field WHERE name = binary 'pax' 
```

* * *

您可以使用以下方法进行测试：

```
mysql> create table people (name varchar(10));

mysql> insert into people value ('pax');
mysql> insert into people value ('pax ');
mysql> insert into people value ('pax  ');
mysql> insert into people value ('pax   ');
mysql> insert into people value ('notpax');

mysql> select count(*) from people where name like 'pax';
1

mysql> select count(*) from people where name = 'pax';
4

mysql> select count(*) from people where name = binary 'pax';
1 
```

# linux - 最后输出中的时间戳应该如何在 linux 上解释？

> ID：559508
> 
> 赞同：-2
> 
> 时间：2009-02-18T01:33:39.177
> 
> 标签：linux, sysadmin

> ```
> $ last -aid
> foouser  pts/12       Sun Feb 15 07:30 - 15:23 (2+07:52)     XXX.YYY.ZZZ.QQQ 
> ```

Sun Feb 15 07:30 - 15:23 部分非常明显。该用户于周日 7:30 登录。但是 (2+07:52) 不清楚。7:52 是两次之差，但 2+ 部分是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T02:00:44.897

使用来源，卢克：

```
sprintf(length, "(%d+%02d:%02d)", days, hours, mins); 
```

这是来自`sysvinit`Debian 上的源代码包。

提示那些没有 C 知识的人：这是天数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:37:54.997

括号之间的字符串是会话的持续时间。正如您所注意到的，时间是结束时间和开始时间之间的差异。2+ 是[hop 注明](https://stackoverflow.com/questions/559508/how-should-timestamps-in-last-output-be-interpreted-on-linux/559574#559574)的天数。

在某些时候，这个问题可能应该转移到服务器故障，因为它最有可能引起系统管理员的兴趣。

一旦你知道你在看什么，这是一种相当易读的格式。如果我正在设计输出，我想我会将星期几设为可选，并将整个结束日期放在字符串中。更好的是让日期戳是可配置的。这样，输出可以更容易地被另一个程序使用。

实际持续时间，如果用户已经退出会话，使用正则表达式很容易找出：

```
$ last | perl -lne 'print "$2 days, $3 hours, $4 minutes" if /\(((\d+)\+)(\d{2}):(\d{2})\)$/'
17 days, 05 hours, 23 minutes
3 days, 23 hours, 16 minutes
14 days, 06 hours, 09 minutes
23 days, 04 hours, 54 minutes
16 days, 06 hours, 57 minutes
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T01:38:37.353

那可能是几天，但我不确定；这也不是编程问题。

# java - 寻找 Java 拼写检查器库

> ID：559510
> 
> 赞同：53
> 
> 时间：2009-02-18T01:34:32.527
> 
> 标签：java, nlp, spell-checking, languagetool

我正在寻找一个开源 Java 拼写检查库，其中包含至少以下语言的词典：法语、德语、西班牙语和捷克语。有什么建议吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-03T01:04:30.920

另一个不错的库是 JLanguageTool [http://www.languagetool.org/usage/](http://www.languagetool.org/usage/) 它有一个非常简单的 api 并且可以进行拼写和语法检查/建议。

```
JLanguageTool langTool = new JLanguageTool(Language.AMERICAN_ENGLISH);
langTool.activateDefaultPatternRules();

List<RuleMatch> matches = langTool.check("Hitchhiker's Guide tot he Galaxy");
for (RuleMatch match : matches) {
    System.out.println("Potential error at line " +
        match.getEndLine() + ", column " +
        match.getColumn() + ": " + match.getMessage());
    System.out.println("Suggested correction: " +
        match.getSuggestedReplacements());
} 
```

您还可以使用它来托管您自己的拼写和语法 Web 服务。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-18T01:38:48.930

您应该查看[Jazzy](http://jazzy.sourceforge.net/)在一些高级 Java 应用程序中的使用。它有两个问题：

1.  它自 2005 年以来一直没有更新。
2.  他们的 SourceForge 页面上只有英文词典。

周围有一些第三方词典。我有一个法语，上次我用爵士乐。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-09T15:27:38.983

查看 Page Scholar 的 JSpell，[http://www.jspell.com](http://www.jspell.com)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-08T00:40:53.740

另一种可能的选择是 JOrtho [http://jortho.sourceforge.net](http://jortho.sourceforge.net)

我还没有使用它，但我正在评估当前的 Java 开源拼写检查器以确定使用哪一个。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T03:29:45.153

[Hunspell](http://hunspell.sourceforge.net/)看起来很有用。它是用 C++ 编写的，但根据主页是一个 java 接口。在 GPL、LGPL 和 MPL 下获得三重许可，因此您应该没有问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-13T20:42:50.520

看看[JaSpell](http://jaspell.sourceforge.net/)。它带有一个内部拼写检查引擎，或者您可以使用[aspell](http://aspell.net/)。由于源可用，您还可以轻松附加类似 aspell 的引擎（如[Hunspell](http://hunspell.sourceforge.net/)）。

它带有用于 TeX 和 XML 的过滤器，并支持建议引擎，如键盘距离、常见拼写错误（您可以在其中定义单词及其替换常见拼写错误）、Levenshtein 距离和语音距离。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-23T07:52:20.407

看看这个：[http ://code.google.com/p/google-api-spelling-java/](http://code.google.com/p/google-api-spelling-java/)

这是一个简单的 Java API，可以很容易地从 Java 应用程序调用 Google 的拼写检查服务。

我试过了，效果很好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-04T21:24:51.843

你可以试试[Suggester](http://www.softcorporation.com/products/spellcheck/index.html)。它是开源的、免费的，并且支持上面列出的所有语言。

# c++ - 具体类的单独头文件 - C++

> ID：559522
> 
> 赞同：5
> 
> 时间：2009-02-18T01:38:36.730
> 
> 标签：c++, abstract-class, header-files

**背景**

我有一个抽象类，比如

```
class IConverter{
    public:
    virtual void DoConvertion() = 0;
}; 
```

会有很多具体的类只实现*DoConvertion*方法。

```
class TextConverter : public IConverter{
    public:
    virtual void DoConvertion(){
         // my code goes here
     }
};

class ImageConverter : public IConverter{
    public:
    virtual void DoConvertion(){
         // my code goes here
     }
}; 
```

会有很多这样的具体实现。我创建了一个头文件，比如*CharacterConverter.h*，它具有抽象类*IConverter*。

**问题**

由于我的具体类只实现了*DoConvertion*方法，是否需要为每个具体类创建单独的头文件？我的意思是是否需要为所有具体类创建*ImageConverter.h*、*TextConverter.h等？*所有这些头文件都将包含与*IConverter*抽象类相同的代码。

有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T01:44:24.203

这不是必需的。这基本上是一个判断电话。

如果每个类的实现都很简单，您可以将它们全部放在一个 .h 和一个 .cpp 中

如果实现有点长，那么为每个使用单独的 .h 和 .cpp 文件可能更干净。

为每个类使用不同的 .h/.cpp 的一些优点：

*   它将保持代码的组织和清洁
*   减少编译工作：其中一个实现的更改不需要重新编译所有其他实现
*   更快的编译时间：多个编译器可以一次编译多个文件，例如 Visual Studio 的 /MP 开关。使用多个文件，您将拥有更快的编译时间。
*   其他文件只能包含他们需要的内容，而不是所有内容
*   更快的链接时间：由于增量链接，链接时间将减少
*   使用版本控制，您可以只回顾对特定派生类的更改，而不必通过对庞大的 1 .h/.cpp 文件所做的所有更改来查找特定派生类中的一个更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T04:04:09.437

创建接口类的要点之一是使客户端可以依赖于抽象接口而不是具体实现，然后您可以在不影响客户端的情况下自由更改实现。

将具体声明与接口声明放在相同的头文件中会破坏这一点，因此现在如果您更改具体类的实现细节，您的客户端将需要重新编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T01:42:26.610

你可能会得到两种方式的答案。

我想说，对于任何微不足道的转换器，将它们全部放在一个 .h/.cpp 对中就足够了，将每个转换器分成一对就过分了。我认为在这种情况下，维护大量文件与维护单个文件中的一堆方法的权衡是值得的。

复杂的转换可能值得拥有自己的文件对。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T02:04:58.023

您将需要具体类的定义来创建对象，因此您需要将这些定义放入某个 .h 文件中。您将它们放入哪个文件取决于您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T02:13:29.297

最好的答案是更容易阅读。对于您和其他程序员来说，一个长的源文件将难以理解。另一方面，许多微小的（半屏全屏）源文件同样糟糕。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T02:16:00.570

根据您的设计的其余部分，您可能会考虑一个工厂，其中您的抽象类有一个静态方法（或多个静态方法，取决于您如何实现它）构造适当的子类并将其作为 IConverter* 返回. 有了这个，您可以只在头文件中公开抽象定义，并将所有具体的类定义和实现与超类实现一起放在一个 .cpp 文件中。如果您的子类很大，这会变得有点笨拙，但是对于较小的类，它会减少您必须管理的文件数量。

但是，正如其他人所指出的，这最终是一个判断电话。唯一的性能问题与编译有关；更多的 cpp 文件可能需要（稍微）更长的时间来编译，更多的头文件可能会增加依赖性分析。但是并不要求每个头文件都有一个匹配的 cpp，反之亦然。

根据评论，我推荐这样的结构：

IConverter.h ==> IConverter
Converters.h 的定义 ==> 所有子类
IConverter.cpp 的定义 ==> 包括 IConverter.h 和 Converters.h，包含 IConverter 抽象功能的实现（静态工厂方法和任何可继承的功能）
TextConvter .cpp、ImagerConverter.cpp 等 ==> 每个子类的单独 cpp 文件，每个包含 IConverter.h 和 Converters.h

这允许您仅在使用工厂和通用功能的任何客户端中包含 IConverter.h。将所有其他定义放在一个标题中可以让您在它们都基本相同的情况下进行合并。单独的 cpp 文件允许您利用 Brian 提到的编译器优势。如前所述，您可以在头文件中内联子类定义，但这并不能真正为您带来任何好处。在进行内联等优化时，您的编译器通常比您更聪明。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T10:46:38.283

使用工厂或函数指针可能会更好。

但是，一种特别令人讨厌的方式是使用宏来声明您的具体类。例如：

在 IConverter.h 的底部包含以下宏

```
#define DECLARE_CONVERTER_CLASS(CLASS_NAME) \
class CLASS_NAME : public IConverter\
{ \
    public: \
    CLASS_NAME() {} \
    virtual void DoConversion(); \
}; \ 
```

然后在 MyConverter1.cpp

```
DECLARE_CONVERTER_CLASS(MyConverter1)

virtual void MyConverter1::DoConversion()
{
    ...
} 
```

呸:-)

# open-source - StreamBase 是否有开源替代方案？

> ID：559526
> 
> 赞同：5
> 
> 时间：2009-02-18T01:38:57.570
> 
> 标签：open-source

我在前世使用过[StreamBase](http://www.streambase.com/)，发现它对于处理流非常有用。但是，对于我现在正在做的项目，我买不起 StreamBase，但如果有开源替代方案，我想试一试。我的另一个解决方案是使用 SQLite 将类似 StreamBase 的应用程序组合在一起，但这需要一些时间，而且我现在没有那种时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T02:03:12.833

你可以看看[EsperTech：事件系列情报](http://www.espertech.com/esper)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T07:15:41.973

与 StreamBase 完全不同，但有一个名为[Storm](https://github.com/nathanmarz/storm)的开源流处理引擎：

> Storm 是一个分布式实时计算系统。与 Hadoop 提供一组用于批处理的通用原语类似，Storm 提供一组用于实时计算的通用原语。

我自己没有用过，但看起来很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-26T09:50:55.520

Oracle CQL 与 StreamBase 做的事情或多或少相同，只是减去了 GUI 的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-11T05:59:33.767

与此同时，流处理有几个开源选项，例如 Apache Storm、Apache Spark 或 Apache Samza。

但是，它们可能没有 StreamBase 的“您发现非常有用的东西”。StreamBase 具有强大而简单的开发、测试、部署和监控工具。

请分别查看我的博客文章，了解有关不同流处理和流分析解决方案（开源和专有）的更多详细信息：

[流处理和流分析替代方案的比较（Apache Storm、Spark、IBM InfoSphere Streams、TIBCO StreamBase、Software AG Apama）](http://www.kai-waehner.de/blog/2014/09/10/comparison-stream-processing-streaming-analytics-alternatives-apache-storm-spark-ibm-infosphere-streams-tibco-streambase-sag-apama/)

# powershell - 如果您只是要编写程序代码，那么 MSBUILD/NANT 的意义何在？Powershell不是更好吗？

> ID：559549
> 
> 赞同：10
> 
> 时间：2009-02-18T01:46:29.003
> 
> 标签：powershell, msbuild

我目前正在 MSBUILD 中编写部署脚本，下载了几个扩展后，我发现自己在查看构建文件并思考：

***在 MSBUILD 中这样做有什么意义？***

这个部署脚本是完全程序化的：停止网站、删除文件夹、复制文件、更改权限、启动网站等。我认为没有花哨的依赖项，我认为这是 MSBUILD、NANT 和 MAKE 等工具的自然领域。

我可以看到使用 MSBUILD 的唯一原因是它是标准的，并且很容易将扩展放入您的 SVN 中，因此构建“正常工作”。

它的问题是我必须花所有时间研究如何在 MSBUILD 中做“基本的东西”（定位扩展，制定语法），这在 Powershell 甚至命令行中是微不足道的（虽然更冗长）。

总结一下： **程序性任务适合 MSBUILD 还是您更适合使用 Powershell 之类的东西？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-21T16:34:32.730

看看 PSAKE 看看你的想法。

[http://www.jameskovacs.com/blog/IntroducingPsake.aspx](http://www.jameskovacs.com/blog/IntroducingPsake.aspx) [http://powerscripting.wordpress.com/2009/01/25/episode-56-james-kovacs-talks-about-psake/](http://powerscripting.wordpress.com/2009/01/25/episode-56-james-kovacs-talks-about-psake/) [http://code .google.com/p/psake/](http://code.google.com/p/psake/)

实验！享受！从事！

Jeffrey Snover [MSFT] Windows 管理合作伙伴架构师

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T17:48:47.380

MSBuild 不是一种脚本语言，不应该这样使用。不幸的是，MSBuild 具有如此丰富的可扩展性并且足够灵活，几乎可以用于任何事情。使用最适合任务的工具，如果您发现自己花费太多时间来创建功能太有限且质量太低，与您可以使用其他技术创建的功能相比，您应该切换。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T01:51:21.927

这真的取决于你的情况。但是，如果由我决定，并且您使用的是 Visual Studio - 我会说是的，为了集成而继续使用 MSBuild。

另一方面，我会选择 MSBUILD，因为虽然任务非常程序化，但它让您可以灵活地在以后扩展此构建过程以处理更复杂的任务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T21:13:39.487

msbuild 随 .NET 一起提供。您必须将 powershell 添加到服务器/用户必须添加它 - 至少通过 Windows XP、server 2003。这在您的环境中可能是也可能不是问题。

我认为程序性任务不适合用 MSBUILD 编写，因为我认为 msbuild 越短越好。我可能会使用 msbuild 来调用它们，但可能会编写一个扩展库来实现它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-20T19:19:14.007

我认为这取决于您的发布和部署过程的流程，因为使用 MSBuild 扩展或执行 power-shell 是有意义的。MSBuild 允许在一个独立的执行流程中灵活地处理您的所有流程步骤。

如果您需要它同时发生，那么 MSBuild 可以让您控制“事件”或可以覆盖以满足您的要求的目标。

如果需要在编译代码后部署工件，那么 MSBuild 非常适合执行此操作，因为您可以使用在 MSBuild 标准执行期间触发的“AfterBuild”目标。它可以使您的过程自成一体。

Powershell 无法构建您的代码。它必须从您的脚本中调用 MSBuild。对我来说，这是一个让你的构建和部署独立的问题，因此会更好地组织。

MSBuild 是 Microsoft 的核心构建平台和引擎。

# sql-server - 使用 SQL Server 2008 视图创建 GeoServer 功能

> ID：559552
> 
> 赞同：0
> 
> 时间：2009-02-18T01:50:27.090
> 
> 标签：sql-server, sql-server-2008, geoserver

我们正在尝试在 SQL Server 2008 中的视图而不是表的顶部创建 GeoServer 中的要素（层）。我们能够创建该功能，但它不会显示任何数据，因为 GeoServer (JDBC) 无法检测到用作 FID 的主键。据我所知，不可能使视图列看起来是主键，而且我们无法弄清楚如何强制 GeoServer 将特定列识别为 FID。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T22:34:50.000

这显然是 SQL 08 GeoServer 驱动程序中的一个已知错误。他们已经解决了这个问题，并且可以通过下载他们的夜间版本来获得修复版本。您需要获取 GeoServer 和 SQL Server 驱动程序的最新副本。

# java - 好看的 Java Swing Look&Feel？

> ID：559559
> 
> 赞同：9
> 
> 时间：2009-02-18T01:54:34.617
> 
> 标签：java, swing, look-and-feel

我正在开发一个开源 Java Web Start 应用程序，我想给它一个跨平台的一致主题。金属非常丑陋，我对 Substance 不是特别满意（尤其是性能）。目前最好的 Swing Look&Feel 选项是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-19T19:07:26.120

我非常喜欢 Java 6 Update 10 中引入的[“Nimbus Look&Feel”](http://java.sun.com/developer/technicalArticles/javase/java6u10/#nimbus)（第二张图片），它默认包含在 SUN 的 J6u10 和更高版本的 vanilla J2SE 中！

另一个优点是，它完全使用 Java 2d 绘制，这使得它在所有分辨率下都可以快速且可重绘。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T01:56:39.760

看看[JGoodies](http://www.jgoodies.com/)，这是开始一个体面的 L&F 的事实上的标准场所。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-18T02:29:38.743

我发现使用“本机”L&F 始终会导致应用程序在特定平台上看起来“正确”。但 JGoodies 是一个出色的全面替代方案。

就我自己而言，我不在乎一个应用程序看起来是否“原生”，只要它看起来一样专业并且至少一样好。FWIW，我不认为Java“金属”或“海洋”看起来可以实现任何一个。

也就是说，要小心......对于许多用户来说，唯一看起来“好”的是与他们平台上的所有其他应用程序相同的东西。我认为唯一在外观方面始终胜过一切的 UI 是当前的 Apple OSX 外观 - 但即使它是我的 Windows 桌面中唯一这样的应用程序，它也显得格格不入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T13:55:38.260

[javootoo](http://www.javootoo.com/)有一个很好的摇摆外观和感觉包汇编，带有屏幕截图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T05:07:55.650

合金的外观和感觉在国际海事组织中相当不错，但它要花费 $$$ [http://lookandfeel.incors.com/](http://lookandfeel.incors.com/)

# java - 处理 JPEG 元数据的最佳库是什么？

> ID：559562
> 
> 赞同：3
> 
> 时间：2009-02-18T01:55:43.863
> 
> 标签：java, cross-platform, metadata, jpeg, freepascal

我正在寻找一个可以读取和写入 JPEG 图像元数据的库。例如，如果我想在图像文件本身中嵌入并读回与 jpeg 图像相关的简短描述或故事，您会推荐什么开发库？

我对什么语言不太在意（这是一个新项目），尽管我已经为我熟悉的语言标记了这个问题（不过我也会考虑其他语言）。最好是相对跨平台（mac/linux/win）的东西，比如 Java、FreePascal/Lazarus、C++、Objective-C 等（老实说我对跨平台不太熟悉，所以不知道 C#是一种可能性） - 除了更流行的框架，如 Java 或 .NET，最好不需要安装任何特定的框架。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T01:58:41.393

试试这里 [http://www.drewnoakes.com/code/exif/](http://www.drewnoakes.com/code/exif/)

看起来很容易使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T02:00:10.780

[Exif](http://www.sno.phy.queensu.ca/~phil/exiftool/)完成了这一切，但它是用 Perl 编写的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:29:31.693

Perl 是跨平台的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T02:39:34.697

[libjpeg](http://en.wikipedia.org/wiki/Libjpeg)是一个用 C 编写的优秀库。它可以用来做任何类型的 jpeg 操作。我已经在 windows、unix 和 linux 中成功编译了它。

# stream - 如何使用 Streams 在 Scheme 中制作更好的映射器

> ID：559567
> 
> 赞同：1
> 
> 时间：2009-02-18T01:56:46.483
> 
> 标签：stream, scheme

map 的 Scheme 实现采用 N+1 个参数：一个包含 N 个参数的过程和 N 个列表。此外，当到达最短列表的末尾时，它会终止映射。

另一种方法是为每个列表提供一个默认值，如果结果比其他列表短，它将被视为每个列表的下一个元素。

那就是定义一个过程 streem-map 作为它的参数： N 个
参数的过程
N 个元素的列表，这是第 N 个流
N个流的默认值

流映射生成一个流，其中第一个元素是应用于流的 (N) 个第一个元素的过程，第二个元素是应用于流的第二个元素的相同过程，依此类推。如果第 N 个流变空，则 streem-map 使用第 N 个默认元素。因此，由 streem-map 产生的流永远是无限长的；如果所有 N 个输入流的长度都是有限的，最终它将生成由应用于 N 个默认值的过程组成的列表。

例如：

```
(streem-map (lambda (x y z) (* x y z))
‘(0 1 2)
(list->streem ‘(1 2 3))
(list->streem ‘(9 9))
(list->streem ‘(4)) 
```

将生成包含以下内容的无限流：'(36 36 6 0 0 0 ...)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T06:24:48.727

让我们首先定义一组基本流原语，以便其余代码有意义：

```
(define-syntax stream-cons
  (syntax-rules ()
    ((stream-cons obj expr)
     (cons obj (delay expr)))))

(define stream-car car)
(define (stream-cdr p) (force (cdr p)))
(define stream-null? null?) 
```

有了这些，我们可以定义“流”的操作，我们的“更好的流”。

```
(define (streem-car stream default)
  (if (stream-null? stream) default (stream-car stream)))

(define (streem-cdr stream)
  (if (stream-null? stream) stream (stream-cdr stream)))

(define (streem-map proc defaults . streams)
  (stream-cons (apply proc (map streem-car streams defaults))
               (apply streem-map proc defaults (map streem-cdr streams)))) 
```

您应该能够轻松地将其调整为您已经在使用的任何流库。您不需要单独的 list->streem 转换，您可以传递 streem-map 常规流（大概是使用 list->stream 创建的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:55:13.890

如果你使用[SRFI-41](http://srfi.schemers.org/srfi-41)的流，这只是`stream-unfold`. 注意：我是 SRFI-41 的作者。

# asp.net - 默认单选按钮不触发 UpdateControl 回发

> ID：559568
> 
> 赞同：2
> 
> 时间：2009-02-18T01:57:40.023
> 
> 标签：asp.net, ajax

我在表单上有三个单选按钮 - A、B、C。这些选择中的每一个都使用特定于该选项的数据填充一个下拉列表。当表单加载时，我将选项 A 设置为选中（作为默认值）。

当我选择按钮 B 或 C 时，AsyncPostBack 触发良好并且下拉列表被填充。但是，随后从 B 或 C 中选择 A 不会触发事件。

我怀疑因为在加载表单时检查了 A，所以浏览器没有看到任何“更改”来引发事件。

那么可以做些什么来启用默认的 A 按钮来识别它正在从 B 或 C 更改以提高回发？

我已经尝试在代码中仅在页面初始加载时设置按钮 A​​ 的选中状态（即 IsPostBack 为 False），或者在 html 中设置单选按钮的选中属性，结果相同。如果我不默认单选按钮，则功能按预期工作，除非我没有在页面首次加载时默认单选按钮和下拉列表。

* * *

html...

```
<asp:RadioButton ID="radBook" runat="server" AutoPostBack="true" GroupName="grpArticleType" Text="Book" />
<asp:RadioButton ID="radCD" runat="server" AutoPostBack="true" GroupName="grpArticleType" Text="CD" />
<asp:RadioButton ID="radDVD" runat="server" AutoPostBack="true" GroupName="grpArticleType" Text="DVD" />

<asp:UpdatePanel ID="pnlTasks" runat="server" UpdateMode="Conditional" RenderMode="Inline">
<ContentTemplate>
   <asp:DropDownList ID="dropShippingSize" runat="server" CssClass="dropdownMandatory"></asp:DropDownList>
</ContentTemplate>
<Triggers>
   <asp:AsyncPostBackTrigger ControlID="radBook" />
   <asp:AsyncPostBackTrigger ControlID="radCD" />
   <asp:AsyncPostBackTrigger ControlID="radDVD" />
</Triggers>
</asp:UpdatePanel> 
```

* * *

后面的代码...

```
Sub Page_Load
    If Not Me.IsPostBack Then
       radBook.Checked = True
    End If
End Sub

Private Sub rad_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) _
   Handles radBook.CheckedChanged, radCD.CheckedChanged, radDVD.CheckedChanged

      zLoadShippingSizeDropdown()

End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-07T16:58:23.593

我有同样的问题，并寻找了几个小时的答案。这似乎与 ViewState 或任何类似的东西无关，但与使用预先检查的 RadioButton 作为异步 PostBack 的触发器的某种不兼容。我发现周围的工作非常简单并且可以立即工作；`checked=true`我没有在标记或`myRadioButton.Checked`服务器端使用，而是执行了以下操作：

不在标记上设置属性并将其添加到`Page_Load`事件中：

```
if (!IsPostBack)
{
    MyRadioButton.InputAttributes["checked"] = "true";
    ...
} 
```

我希望这有助于并节省一些人拉头发的时间：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T02:22:35.547

我猜你需要在你的加载事件中检查页面是否是回发：

```
protected void Form_Load(object sender, EventArgs e) 
{
    if (!Page.IsPostback) 
    {
        // Set radiobutton A...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-16T14:31:06.910

我们遇到了同样的问题，看来您必须将单选按钮的其他“已检查”属性设置为“假”。所以请添加行

```
radCD.Checked = False
radDVD.Checked = False 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T06:19:43.533

您是否也偶然在您的代码中处理视图状态？如果是这样，那么您需要处理它的 AJAX 版本，因为视图状态通常会在 AJAX 样式页面上丢失。尝试将您的按钮放在更新面板中，如果面板将其更新模式设置为条件，您是否会获得相同的行为。如果您这样做，请不要担心回发触发器。

异步触发器仅适用于更新面板内的项目。面板之外的任何项目都将按照设计进行完整的回发。

```
<asp:UpdatePanel ID="pnlTasks" runat="server" UpdateMode="Conditional" RenderMode="Inline">
<ContentTemplate> 
<asp:RadioButton ID="radBook" runat="server" AutoPostBack="true" GroupName="grpArticleType" Text="Book" />
<asp:RadioButton ID="radCD" runat="server" AutoPostBack="true" GroupName="grpArticleType" Text="CD" /><asp:RadioButton ID="radDVD" runat="server" AutoPostBack="true" GroupName="grpArticleType" Text="DVD" />
  <asp:DropDownList ID="dropShippingSize" runat="server" CssClass="dropdownMandatory">
</asp:DropDownList>
</ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-17T22:28:18.747

哇，我从没想过这可能是错误。节省了许多小时的挫败感。

感谢 Juan 经历了 carppy Microsoft 问题，并为其余问题找到了解决方案。

# php - 表格中按优先顺序选择（按优先顺序排列5个选项）

> ID：559573
> 
> 赞同：2
> 
> 时间：2009-02-18T02:00:15.820
> 
> 标签：php, html, forms

我正在尝试为我的 php/mysql 应用程序创建一个表单。我希望我的用户列出他们选择的优先级，他们有 5 个选项，他们必须按偏好顺序选择每个选项

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T02:17:57.103

为什么不简单地为每个选项提供五个插槽（一个在另一个下），并在每个选项的右侧提供一个更高/更低的控件来更改顺序？这总是比分配一个乱序的序列号更有吸引力。

例如，从以下开始：

```
Favorite Friends:
    1 Pax             ^   v
    2 Litb            ^   v
    3 Jon Skeet       ^   v
    4 VonC            ^   v
    5 Jeff Atwood     ^   v 
```

然后，如果您想将 Jon 提升到第 2 位，只需单击`^`他名字旁边的“”一次。

```
Favorite Friends:
    1 Pax             ^   v
    2 Jon Skeet       ^   v
    3 Litb            ^   v
    4 VonC            ^   v
    5 Jeff Atwood     ^   v 
```

如果，出于某种原因，你认为我冤枉了你（我真的很抱歉 :-)，点击我的 " `v`" 字符四次，你会得到：

```
Favorite Friends:
    1 Jon Skeet       ^   v
    2 Litb            ^   v
    3 VonC            ^   v
    4 Jeff Atwood     ^   v
    5 Pax             ^   v 
```

这个可变位置/固定数字（IMNSHO）比固定位置/可变数字解决方案好得多，因此：

```
Favorite Friends:
    5 Pax
    2 Litb
    1 Jon Skeet
    3 VonC
    4 Jeff Atwood 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T02:42:23.427

我会在每个字段旁边放置一个文本输入，并附有说明控件如何工作的简短说明。对于禁用 JavaScript 的客户端，您可以简单地验证每个输入是否包含从 1 到 5 的唯一整数。

对于支持 JavaScript 的客户端，[jQuery UI 库](http://jqueryui.com/demos/sortable/)为您提供了帮助。

# actionscript-3 - 为什么 actionscript3.0 类继承失败（有时）？

> ID：559576
> 
> 赞同：6
> 
> 时间：2009-02-18T02:01:16.723
> 
> 标签：actionscript-3, oop

actionscript3.0 中的所有对象都继承自 Object 类，但 actionscript3.0 编译器似乎不够聪明，无法理解这一点。

看看下面的代码：

```
package{
   public class TestOne{
      public function TestOne(){
        var t2: TestTwo = new TestTwo();
        trace(t2.toString()); // COMPILE TIME ERROR
        trace((t2 as Object).toString(); // [object TestTwo]

        var t22 : * = new TestTwo();
        trace(t22.toString()); // [object TestTwo]
        trace((t22 as Object).toString(); // [object TestTwo]
      }
   }
}
class TestTwo{} 
```

*t2.toString()*给出编译时错误，因为数据类型 t2 不包括*toString()*。但是， t2 确实包含*toString()*因为它是一个对象，如*(t2 as Object).toString()*所示。如果我们不给变量一个数据类型，比如 t22，那么这个问题就永远不会遇到。为什么 actionscript3.0 编译器不能确定 t2 既是 TestTwo 又是 Object？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T09:05:21.680

这是因为

> Object 类的方法是在 Object 的原型上动态创建的。要在 Object 的子类中重新定义此方法，请不要使用 override 关键字。例如，Object 的子类实现函数 toString():String 而不是使用基类的覆盖。

因此，如果您将 TestTwo 转换为 Object，编译器就会知道这些方法将被实现。如果不强制转换，TestTwo 不会继承这些方法，因此它们尚未实现并且会出错。

这有点奇怪！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T23:23:39.883

**类继承**和**原型继承**在 AS3 中是两个不同的东西。据我了解，原型继承是为了与 AS2/AS1 向后兼容而包含在内，**它是原型继承，它提供了`toString()`**在您的示例中转换为 Object 类的变量的**方法。**Object*原型*有`toString()`方法，而不是 Object*类*。由于原型不存在于您的 TestTwo 类中，因此它没有`toString()`方法。如果该`toString()`方法是通过类继承提供的，则您的示例将编译。

所以从技术上讲，由于原型继承和类继承之间的区别，您的“actionscript3.0 中的所有对象都继承自 Object 类”的说法并不完全正确。原型继承是脚本语言中的一个有点深奥的 OO 概念。

有谁知道AS3是这样设计的原因吗？

# python - 需要一种更好的方法来从 python 执行控制台命令并记录结果

> ID：559578
> 
> 赞同：4
> 
> 时间：2009-02-18T02:02:08.140
> 
> 标签：python, logging, command-line

我有一个 python 脚本，它需要执行几个命令行实用程序。stdout 输出有时用于进一步处理。在所有情况下，我都想记录结果并在检测到错误时引发异常。我使用以下函数来实现这一点：

```
def execute(cmd, logsink):
    logsink.log("executing: %s\n" % cmd)
    popen_obj = subprocess.Popen(\
          cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    (stdout, stderr) = popen_obj.communicate()
    returncode = popen_obj.returncode
    if (returncode <> 0):
       logsink.log("   RETURN CODE: %s\n" % str(returncode))
    if (len(stdout.strip()) > 0):
       logsink.log("   STDOUT:\n%s\n" % stdout)
    if (len(stderr.strip()) > 0):
       logsink.log("   STDERR:\n%s\n" % stderr)
    if (returncode <> 0):
       raise Exception, "execute failed with error output:\n%s" % stderr
    return stdout 
```

“logsink”可以是任何带有 log 方法的 python 对象。我通常使用它将日志记录数据转发到特定文件，或将其回显到控制台，或两者兼而有之，或其他...

这工作得很好，除了三个问题，我需要比通信（）方法提供的更细粒度的控制：

1.  stdout 和 stderr 输出可以在控制台上交错，但上述函数分别记录它们。这会使日志的解释复杂化。如何以与输出相同的顺序记录交错的 stdout 和 stderr 行？
2.  上述函数只会在命令完成后记录命令输出。当命令陷入无限循环或由于某些其他原因需要很长时间时，这会使问题的诊断变得复杂。如何在命令仍在执行时实时获取日志？
3.  如果日志很大，则很难解释哪个命令生成了哪个输出。有没有办法给每一行加上前缀（例如 cmd 字符串的第一个单词后跟 :)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T02:58:26.820

如果您只希望文件中的输出以供以后评估，则可以重定向到文件。

您已经通过 stdout=/stderr= 方法定义了您正在执行的进程的 stdout/stderr。

在您的示例代码中，您只是重定向到当前输出/错误分配的脚本。

```
subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE) 
```

sys.stdout 和 sys.stderr 只是类似文件的对象。[正如sys.stdout](http://docs.python.org/library/sys.html?highlight=stdout#sys.stdout)上的文档所提到的，“任何对象都是可以接受的，只要它有一个带有字符串参数的 write() 方法。”

```
f = open('cmd_fileoutput.txt', 'w')
subprocess.Popen(cmd, shell=True, stdout=f, stderr=f) 
```

所以你只需要给它一个带有 write 方法的类来重定向输出。

如果您想要控制台输出和文件输出，可能会创建一个类来管理输出。

一般重定向：

```
# Redirecting stdout and stderr to a file
f = open('log.txt', 'w')
sys.stdout = f
sys.stderr = f 
```

制作重定向类：

```
# redirecting to both
class OutputManager:
    def __init__(self, filename, console):
        self.f = open(filename, 'w')
        self.con = console

    def write(self, data):
        self.con.write(data)
        self.f.write(data)

new_stdout = OutputManager("log.txt", sys.stdout) 
```

交错取决于缓冲，因此您可能会或可能不会获得您期望的输出。（您可能可以关闭或减少使用的缓冲，但我现在不记得如何）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T11:06:56.020

您可以查看 pexpect ( [http://www.noah.org/wiki/Pexpect](http://www.noah.org/wiki/Pexpect) )

它开箱即用地解决了 1) 和 2)，为输出添加前缀可能有点棘手。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-15T16:55:12.427

另一种选择：

```
def run_test(test_cmd):
    with tempfile.TemporaryFile() as cmd_out:
        proc = subprocess.Popen(test_cmd, stdout=cmd_out, stderr=cmd_out)
        proc.wait()
        cmd_out.seek(0)
        output = "".join(cmd_out.readlines())
    return (proc.returncode, output) 
```

这将根据需要在一个方便您打开的真实文件中`stdout`交错。`stderr`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-22T22:00:37.080

这绝不是一个完整或详尽的答案，但也许您应该研究一下 Fabric 模块。

[http://docs.fabfile.org/0.9.1/](http://docs.fabfile.org/0.9.1/)

使 shell 命令的并行执行和错误处理变得相当容易。

# c - 将函数指针转换为另一种类型

> ID：559581
> 
> 赞同：105
> 
> 时间：2009-02-18T02:03:43.220
> 
> 标签：c, function-pointers

假设我有一个接受`void (*)(void*)`函数指针用作回调的函数：

```
void do_stuff(void (*callback_fp)(void*), void* callback_arg); 
```

现在，如果我有这样的功能：

```
void my_callback_function(struct my_struct* arg); 
```

我可以安全地做到这一点吗？

```
do_stuff((void (*)(void*)) &my_callback_function, NULL); 
```

我已经查看了[这个问题](https://stackoverflow.com/questions/188839/function-pointer-cast-to-different-signature)，并且查看了一些 C 标准，这些标准说您可以强制转换为“兼容函数指针”，但我找不到“兼容函数指针”含义的定义。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-02-18T02:54:36.093

就 C 标准而言，如果您将函数指针强制转换为不同类型的函数指针，然后调用它，则它是*未定义的行为*。见附件 J.2（资料性）：

> 在以下情况下，行为未定义：
> 
> *   指针用于调用其类型与指向的类型（6.3.2.3）不兼容的函数。

第 6.3.2.3 节第 8 段内容如下：

> 指向一种类型的函数的指针可以转换为指向另一种类型的函数的指针，然后再返回；结果应与原始指针比较。如果转换后的指针用于调用类型与指向的类型不兼容的函数，则行为未定义。

因此，换句话说，您可以将函数指针转换为不同的函数指针类型，再次将其转换回来，然后调用它，一切都会奏效。

*兼容*的定义有些复杂。可在第 6.7.5.3 节第 15 段中找到：

> 对于要兼容的两种函数类型，两者都应指定兼容的返回类型^(127)。
> 
> 此外，参数类型列表（如果两者都存在）应在参数数量和省略号终止符的使用方面达成一致；相应的参数应具有兼容的类型。如果一种类型具有参数类型列表，而另一种类型由不属于函数定义的函数声明符指定且包含空标识符列表，则参数列表不应有省略号终止符，并且每个参数的类型应与应用默认参数提升所产生的类型兼容。如果一种类型具有参数类型列表，而另一种类型由包含（可能为空）标识符列表的函数定义指定，则两者应在参数数量上一致，并且每个原型参数的类型应与将默认参数提升应用到相应标识符的类型所产生的类型兼容。（在类型兼容性和复合类型的确定中，每个声明为函数或数组类型的参数被视为具有调整后的类型，每个声明为合格类型的参数被视为具有其声明类型的非限定版本。）
> 
> 127) 如果两个函数类型都是“旧式”，则不比较参数类型。

确定两种类型是否兼容的规则在 6.2.7 节中进行了描述，由于它们比较冗长，因此我不会在此处引用它们，但是您可以[在 C99 标准草案 (PDF)](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)中阅读它们。

这里的相关规则在第 6.7.5.1 节第 2 段中：

> 对于要兼容的两种指针类型，两者都应具有相同的限定，并且都应是指向兼容类型的指针。

因此，由于 a与 a`void*` [不](https://stackoverflow.com/questions/11647220/are-void-pointer-and-pointer-to-some-structure-layout-compatible)`struct my_struct*`兼容，因此类型的函数指针与类型`void (*)(void*)`的函数指针不兼容`void (*)(struct my_struct*)`，因此函数指针的这种转换在技术上是未定义的行为。

但是，在实践中，在某些情况下，您可以安全地摆脱强制转换函数指针。在 x86 调用约定中，参数被压入堆栈，所有指针大小相同（x86 中为 4 字节，x86_64 中为 8 字节）。调用函数指针归结为将参数压入堆栈并间接跳转到函数指针目标，并且在机器代码级别显然没有类型的概念。

绝对**不能**做的事：

*   在不同调用约定的函数指针之间转换。你会弄乱堆栈，充其量会崩溃，最坏的情况是，通过一个巨大的安全漏洞默默地成功。在 Windows 编程中，您经常传递函数指针。Win32 期望所有回调函数都使用`stdcall`调用约定（宏`CALLBACK`、`PASCAL`和`WINAPI`所有都扩展为）。如果传递使用标准 C 调用约定 ( `cdecl`) 的函数指针，将导致错误。
*   在 C++ 中，在类成员函数指针和常规函数指针之间进行强制转换。这经常会绊倒 C++ 新手。类成员函数有一个隐藏`this`参数，如果将成员函数转换为常规函数，就没有`this`对象可以使用，同样会导致很多错误。

另一个有时可能有效但也是未定义行为的坏主意：

*   在函数指针和常规指针之间进行强制转换（例如将 a 强制转换`void (*)(void)`为 a `void*`）。函数指针不一定与常规指针大小相同，因为在某些架构上它们可能包含额外的上下文信息。这可能在 x86 上可以正常工作，但请记住这是未定义的行为。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-12-26T17:56:42.157

我最近询问了有关 GLib 中某些代码的完全相同的问题。（GLib 是 GNOME 项目的核心库，用 C 语言编写。）有人告诉我，整个 slot'n'signals 框架都依赖于它。

在整个代码中，有许多从类型 (1) 到 (2) 的强制转换实例：

1.  `typedef int (*CompareFunc) (const void *a, const void *b)`
2.  `typedef int (*CompareDataFunc) (const void *b, const void *b, void *user_data)`

像这样的调用链通是很常见的：

```
int stuff_equal (GStuff      *a,
                 GStuff      *b,
                 CompareFunc  compare_func)
{
    return stuff_equal_with_data(a, b, (CompareDataFunc) compare_func, NULL);
}

int stuff_equal_with_data (GStuff          *a,
                           GStuff          *b,
                           CompareDataFunc  compare_func,
                           void            *user_data)
{
    int result;
    /* do some work here */
    result = compare_func (data1, data2, user_data);
    return result;
} 
```

在此处亲自查看`g_array_sort()`：[http ://git.gnome.org/browse/glib/tree/glib/garray.c](http://git.gnome.org/browse/glib/tree/glib/garray.c)

上面的答案很详细，而且很可能是正确的——**如果**你是标准委员会的成员的话。Adam 和 Johannes 值得称赞他们经过充分研究的回应。但是，在野外，您会发现此代码运行良好。有争议的？是的。考虑一下：GLib 在大量平台（Linux/Solaris/Windows/OS X）上使用各种编译器/链接器/内核加载器（GCC/CLang/MSVC）编译/工作/测试。标准该死，我猜。

我花了一些时间思考这些答案。这是我的结论：

1.  如果您正在编写回调库，这可能没问题。警告购买者 - 使用风险自负。
2.  否则，不要这样做。

在写下这个回复之后深入思考，如果 C 编译器的代码使用相同的技巧，我不会感到惊讶。而且由于（大多数/全部？）现代 C 编译器是自举的，这意味着这个技巧是安全的。

一个更重要的研究问题：有人能找到这个技巧不起作用的平台/编译器/链接器/加载器**吗**？那个主要的布朗尼点。我敢打赌，有些嵌入式处理器/系统不喜欢它。然而，对于桌面计算（可能还有移动/平板电脑），这个技巧可能仍然有效。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-18T13:27:30.427

关键不在于你能不能。简单的解决方案是

```
void my_callback_function(struct my_struct* arg);
void my_callback_helper(void* pv)
{
    my_callback_function((struct my_struct*)pv);
}
do_stuff(&my_callback_helper); 
```

一个好的编译器只会在真正需要时为 my_callback_helper 生成代码，在这种情况下你会很高兴它这样做了。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-18T03:02:31.210

如果返回类型和参数类型兼容，则您有一个兼容的函数类型 - 基本上（实际上它更复杂:)）。兼容性与“相同类型”相同，只是更宽松以允许拥有不同类型，但仍然有某种形式说“这些类型几乎相同”。例如，在 C89 中，如果两个结构在其他方面相同但只是名称不同，则它们是兼容的。C99 似乎改变了这一点。引用[c 基本原理文档](http://www.lysator.liu.se/c/rat/title.html)（强烈推荐阅读，顺便说一句！）：

> 两个不同翻译单元中的结构、联合或枚举类型声明不会正式声明相同的类型，即使这些声明的文本来自同一个包含文件，因为翻译单元本身是不相交的。因此，该标准为这些类型指定了额外的兼容性规则，因此如果两个这样的声明足够相似，它们是兼容的。

也就是说 - 是的，严格来说这是未定义的行为，因为您的 do_stuff 函数或其他人将使用具有`void*`作为参数的函数指针调用您的函数，但您的函数具有不兼容的参数。但是，尽管如此，我希望所有编译器都能编译和运行它而不会抱怨。但是你可以通过让另一个函数接受一个`void*`（并将其注册为回调函数）来做更清洁，然后它只会调用你的实际函数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-18T02:19:10.127

由于 C 代码编译为完全不关心指针类型的指令，因此使用您提到的代码非常好。当您使用回调函数运行 do_stuff 并指向其他东西然后将 my_struct 结构作为参数时，您会遇到问题。

我希望我可以通过展示什么不起作用来更清楚地说明：

```
int my_number = 14;
do_stuff((void (*)(void*)) &my_callback_function, &my_number);
// my_callback_function will try to access int as struct my_struct
// and go nuts 
```

或者...

```
void another_callback_function(struct my_struct* arg, int arg2) { something }
do_stuff((void (*)(void*)) &another_callback_function, NULL);
// another_callback_function will look for non-existing second argument
// on the stack and go nuts 
```

基本上，只要数据在运行时继续有意义，您就可以将指针投射到您喜欢的任何地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-19T14:36:16.093

void 指针与其他类型的指针兼容。它是 malloc 和 mem 函数 ( `memcpy`, `memcmp`) 工作方式的支柱。通常，在 C（而不是 C++）`NULL`中，宏定义为`((void *)0)`.

查看 C99 中的 6.3.2.3（第 1 项）：

> 指向 void 的指针可以转换为指向任何不完整或对象类型的指针或从指针转换为指向任何不完整或对象类型的指针

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-18T02:21:16.970

如果您考虑函数调用在 C/C++ 中的工作方式，它们会将某些项目压入堆栈，跳转到新的代码位置，执行，然后在返回时弹出堆栈。如果你的函数指针描述了具有相同返回类型和相同数量/大小的参数的函数，你应该没问题。

因此，我认为您应该能够安全地这样做。

# css - 在包含背景的 div 上设置 CSS

> ID：559582
> 
> 赞同：0
> 
> 时间：2009-02-18T02:03:52.567
> 
> 标签：css

我有[这个网站](http://www.redlineautoleasing.com/beta/)。

div 容器包含一个看起来很邋遢的背景，而 body 包含另一个在 x 坐标上重复的背景。

如果您查看该站点，您会在左侧和右侧看到空白。我想知道如何设置背景图像以根据屏幕分辨率进行扩展。根据每个div的百分比设置宽度是否有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T02:20:14.117

据我所知，CSS 不支持缩放背景图像，这至少可以说是令人失望的。长话短说，您可能不得不使用[固定位置、z 索引的 img 标签](http://www.markschenk.com/cssexp/background/index.html)来伪造它。那个，或者你做了什么：一个带有背景重复的大图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T03:44:03.183

thanks for all your answers, when i said white space i didnt mean actual white space what i was refering to was that the entire container div wasnt sizing (width wise) towards what the users computer resolution was. and since allot of the divs are set with a background image there is no css code for setting the width on the image but i guess it would work on the divs. but thankfully after talking with the customer he changed his mind and doesnt want it anymore :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T02:16:03.893

我看不出你在 FF3/IE6/IE7 和 chrome 中的任何问题。我看到的唯一问题是 ie6 中的透明 png，后面是丑陋的灰色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T02:20:35.083

ie6 我必须修复，但客户想要的是根据用户计算机分辨率调整页面大小

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T02:29:29.620

不幸的是，您无法缩放图像本身。

您可以做的是重新制作 div 结构，以便内部 div 包含蹩脚背景的中心，并且两侧通过两个单独的 div 平铺。然后，您可以重新切割中心部分以垂直和水平平铺，并为其指定宽度，该宽度是窗口大小的百分比。您可以通过 javascript 防止它变得太小。

这不是最佳解决方案，但如果客户端设置为随浏览器窗口缩放，这可能会为他们完成。

# audio - 如何使用 sox 将 mp3wav 转换为未压缩的 wav？

> ID：559583
> 
> 赞同：0
> 
> 时间：2009-02-18T02:04:02.673
> 
> 标签：audio, wav, file-conversion

如何使用 sox 将 mp3wav（mp3 形式的压缩 wav）转换为未压缩 wav (PCM)？

mp3wav 示例文件可以在这里下载：http: [//www.clayloomis.com/simsong.html](http://www.clayloomis.com/simsong.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T02:39:51.373

我原以为以下内容会简单地工作：

```
sox file.mp3 file.wav 
```

可能是您的 sox 版本根本不处理 MP3 文件。我认为这发生在我最近使用 openSUSE 的默认 RPM 时...

# ruby-on-rails - datetime_select 上的零值？

> ID：559584
> 
> 赞同：11
> 
> 时间：2009-02-18T02:04:37.603
> 
> 标签：ruby-on-rails

将 <%= f.datetime_select :start %> 用于“新”对象表单时，如何将选项设置为默认不选择日期，而是选择 nil/null 值？相关模型中的字段可以选择为 null，但默认情况下 datetime_select 控件没有 null 选项。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-18T17:06:55.657

我想你想要：

`f.datetime_select :start, :include_blank => true`

当`start`为 nil 时，字段将选择空白选项。这也允许用户*不*输入日期。

有关详细信息，请参阅[date_select 的文档](http://api.rubyonrails.com/classes/ActionView/Helpers/DateHelper.html#M001666)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T03:08:05.097

您需要使用 :prompt 选项。

来自 Rails 文档：

```
 # Generates a datetime select with a custom prompt. Use :prompt=>true for generic prompts.
  datetime_select("post", "written_on", :prompt => {:day => 'Choose day', :month => 'Choose month', :year => 'Choose year'})
  datetime_select("post", "written_on", :prompt => {:hour => true}) # generic prompt for hours
  datetime_select("post", "written_on", :prompt => true) # generic prompts for all 
```

# php - 选择空的 mysql 日期时间字段

> ID：559590
> 
> 赞同：29
> 
> 时间：2009-02-18T02:10:01.130
> 
> 标签：php, mysql, datetime

有没有比这更好的选择空日期时间字段的方法？

```
SELECT * FROM `table` WHERE `datetime_field` = '0000-00-00 00:00:00' 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-18T02:25:08.023

以什么方式更好？该查询会执行您对它的所有要求，并且只要在 上有一个索引`datetime_field`，它就会尽可能快。

如果您担心查询看起来“丑陋”，请不要担心。它的意图非常明确。

您可以考虑的唯一可能的改进是对这些零日期/时间行使用 NULL，在这种情况下，您的查询变为：

```
SELECT * FROM `table` WHERE `datetime_field` IS NULL 
```

这就是我对符合标准的 DBMS 所做的事情。我的理解是 MySQL**可能**以这种可怕的方式表示真正的 NULL 日期时间字段，在这种情况下，我猜这`IS NULL`可能不起作用。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-07-22T18:16:28.580

`SELECT * FROM db.table WHERE UNIX_TIMESTAMP(datetime_field) = 0`

我喜欢这段代码，因为它不仅可以捕获“零日期”（例如“0000-00-00 00:00:00”），还可以捕获“日期中的零”（例如“2010-01-00 00:00:00”） )

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-03-21T04:41:04.210

如果您的日期/日期时间列不为空，您可以使用：

```
SELECT * FROM `table` WHERE `datetime_field` IS NULL 
```

MySQL 将为您选择等于 '0000-00-00 00:00:00' 的列。

*注意*：如果你这样做：

```
SELECT `datetime_field` IS NULL 
```

MySQL 将返回 0（假），但当用作 WHERE 子句的一部分时，此语句将为真。

## 从[手册](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_is-null)

> 对于声明为 NOT NULL 的 DATE 和 DATETIME 列，您可以使用如下语句找到特殊日期“0000-00-00”：
> 
> ```
> SELECT * FROM tbl_name WHERE date_column IS NULL 
> ```
> 
> 这是使某些 ODBC 应用程序工作所必需的，因为 ODBC 不支持“0000-00-00”日期值。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-06-13T14:55:11.813

或者你可以简单地做：

```
SELECT * FROM `table` WHERE `datetime_field` = 0 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-27T15:02:07.227

我用这个：

```
SELECT * FROM `table` WHERE UNIX_TIMESTAMP(`datetime_field`) = 0 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-06-13T15:07:34.827

作为另一种选择，我已经看到：

```
SELECT * FROM `table` WHERE YEAR(`datetime_field`)=0 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-10T02:23:48.133

```
SELECT * FROM `table` WHERE UNIX_TIMESTAMP(`datetime_field`) IS NULL 
```

使用 UNIX_TIMESTAMP，它处理空、空和任何无效的日期时间字符串。

正如本页前面提到的@Lizardx，UNIX_TIMESTAMP 不支持非常旧的或未来的日期。在这种情况下，可以省略该功能及其好处！

UNIX_TIMESTAMP 的参数值的有效范围是从 1970-01-01 00:00:01.000000 UTC 到 2038-01-19 03:14:07.999999 UTC。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-02-18T02:18:01.393

让我提出一个免责声明，我不确定这会做什么。但如果它有效，那将是非常酷的。

```
SELECT * FROM table WHERE datetime = DATESUB(NOW(),NOW()); 
```

# asp.net-mvc - ASP.NET MVC 相当于 Login_Error 事件？

> ID：559591
> 
> 赞同：0
> 
> 时间：2009-02-18T02:10:46.107
> 
> 标签：asp.net-mvc, authentication

我想自定义访问者在登录尝试失败时收到的登录错误消息。在 ASP.NET 中，您将覆盖 Login_LoginError 事件，如[4GuysFromRolla 文章](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)中所述。

任何人都知道如何在 ASP.NET MVC 中做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T06:12:13.810

您是否使用标准的 ASP.NET 登录控件？如果这样，您可以轻松删除它并使用[MVC Membership Starter Kit](http://www.codeplex.com/MvcMembership)中的登录控件（它适用于 Preview 5，但可以轻松转换为 RC）或编写您自己的。使用它们，您可以通过 CSS 自定义错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:22:18.650

当我写这个问题时，我并没有直接思考。要完成我的要求，您只需将逻辑写入登录操作。真的很简单... ;)

# svn - VCS 和单一开发人员“团队”

> ID：559592
> 
> 赞同：2
> 
> 时间：2009-02-18T02:13:04.417
> 
> 标签：svn, git, version-control, development-environment, bug-tracking

我是一名开发人员，正在为我的公司开发一个项目。我使用 subversion 和 Trac（用于错误跟踪和与管理类型的通信）。我有一个登台服务器和一个生产服务器。今天我检查了一些代码，发现我的基于 FSFS 的 svn (v1.4) 存储库已不可挽回地损坏。虽然这很糟糕，但它让我有机会将我的 VCS/staging 系统迁移到更现代的发行版（目前在一个 2 年前的系统上）。（就回购而言，我确实有一个未损坏的当前代码版本，所以当我丢失所有开发历史和评论时，我不会丢失任何代码。唷。）

目前我在 Ubuntu 上开发，生产运行 RHEL5-64。我的硬件将保持不变，一个 32 位 x86 单核系统。

我熟悉 SVN 及其结构，但我对 FSFS 损坏问题感到有些恼火。我对 git 了解不多，只是它很受欢迎。我目前使用 Trac 来管理问题，我真的很喜欢它与 svn 的集成。似乎有插件可以支持 Git，但我不确定该开发的成熟度。

我目前正在考虑构建以下内容：

1.  Ubuntu 8.10 桌面（然后添加 apache2 和其他软件包……上次我尝试将 GUI 添加到服务器版本时，我差点把头发拉出来）
2.  SVN（因为我很熟悉它，而且 Git 对于一个人的团队来说似乎有点矫枉过正）
3.  Trac（因为我熟悉它并且它适用于 SVN）。

我想对我的“新”vcs 系统提出一些建议和想法。我有理由转向 Git 吗？有什么比 Trac“更好”的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T02:16:39.570

我将 git 用于我所有的个人项目。我无法想象有什么更好的了。一旦项目超过您，它就特别有用。您的开发过程几乎不需要改变，除了偶尔向公共回购添加推送。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T02:21:03.727

> SVN（因为我很熟悉它，而且 Git 对于一个人的团队来说似乎有点矫枉过正）

git 非常轻巧且易于使用。语法与颠覆略有不同，但仅此而已。我不会说这是矫枉过正。确实没有什么比颠覆更复杂的了。

对于错误跟踪，我使用了一个名为 Pivotal 的基于 Web 的系统。它是免费的（目前），并且内置了一些项目管理功能。它非常适合小型团队，因为它非常简单，几乎不需要设置即可使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:29:09.230

我们在这里使用 svn/trac/ubuntu。

为了减少损坏的影响，我建议您实施一项自动化作业（cron？）以每天一次热复制 svn 和 trac 存储库并将它们发送到异地（rsync）以进行备份。我们在这里使用 NAS，但 S3 或 Dreamhost 之类的东西也可以正常工作。

这样，如果出现问题，您只会损失一天的工作量。

SVN 热拷贝：

```
svnadmin hotcopy $REPOSITORY $DESTINATION 
```

跟踪热拷贝：

```
trac-admin $REPOSITORY hotcopy $DESTINATION 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T08:36:35.803

Git 是一个很好的源代码控制系统，特别是如果您对命令行感到满意的话。SVN 显然是一个不错的老主力，现在有了 1.5 合并支持，它的性能要好得多。

Trac 很好，但是当我们查看它时，它仅限于单个项目，并且在源代码控制支持部门并不好。

我们现在使用 redmine，它允许多个项目，并允许我们为每个项目使用不同类型的源代码控制，包括 git。

哦，是的，我们使用 hudson 来建造 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T08:56:34.727

我支持[Redmine](http://redmine.org)的建议。虽然我主要是 Mercurial 用户，但也支持 git（如 Darcs、svn 和 cvs）。分布式版本控制系统的好处之一是您基本上可以免费获得备份（您知道您应该对旧的 svn 存储库进行备份，对吗？）...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T03:09:14.547

[Perforce](http://www.perforce.com/)最多可供两个用户免费使用，并且享有[良好的声誉](http://www.perforce.com/perforce/corp/awards.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T18:05:56.030

我要退后一步，看看更大的视野。如果您熟悉并熟悉 SVN 和 Trac，并且他们为您完成了工作（暂时忽略腐败问题），我会质疑是否需要移动。这是源代码控制和错误跟踪，一般来说，只要他们为您的团队工作，我看不出花费大量精力来管理他们的环境、安装和评估新工具等。

我的 10,000 英尺建议是利用这个机会完全外包这个功能。有一些主机（免责声明：我的公司就是其中之一）可以免费/低价为您托管您的 Subversion、Git、Trac、Lighthouse 等。然后，当磁盘阵列或 FSFS 或其他什么出现问题时，花费 100% 时间担心这些问题的人可以处理它，而您甚至可能没有意识到这个问题。如果您公司的政策允许您使用主机来实现此功能，您现在可以节省一个周末、一个周末（为下一次灾难）以及无数美元的生产时间。

# regex - 返回正则表达式匹配的一部分

> ID：559599
> 
> 赞同：1
> 
> 时间：2009-02-18T02:17:11.503
> 
> 标签：regex

这个问题表明我对正则表达式的无知。我从来没有完全理解它。

例如，如果我想匹配 HTML 中标签的 URL 部分，我需要做什么？

我获取整个标签的正则表达式是：

```
<A[^>]*?HREF\s*=\s*[""']?([^'"" >]+?)[ '""]?> 
```

我不知道我需要做什么才能从中获取 URL，而且我不知道在哪里查看正则表达式文档来解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T02:23:03.470

如果在 Perl 中编程，您可以在 if() 语句中使用 $1 运算符。例如。

```
if( $HREF =~ /<A[^>]*?HREF\s*=\s*[""']?([^'"" >]+?)[ '""]?>/ ) {
 print $1;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T02:24:08.087

确切的如何部分取决于您使用的正则表达式库，但方法是使用分组表达式。实际上，您的示例中已经有一个，因为分组表达式带有括号。href 属性值是您的第一组（您的第零组是整个表达式。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:25:38.240

您可以使用圆括号对正则表达式匹配的部分进行分组。在这种情况下，您可以在 URL 部分周围使用圆括号，然后使用数字来引用该组。请参阅[此处](http://www.regular-expressions.info/brackets.html)以了解您如何做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T02:26:49.843

我改变了一点 - 尝试这样的事情：

```
<a[^>]*href="([^"]*).*> 
```

# javascript - 使用 jQuery 获取 JSON 数据安全吗？

> ID：559600
> 
> 赞同：7
> 
> 时间：2009-02-18T02:17:13.657
> 
> 标签：javascript, jquery, security

JSON 允许您从 AJAX 调用中[检索多种格式的数据。](http://docs.jquery.com/Ajax/jQuery.get)例如：

```
$.get(sourceUrl, data, callBack, 'json'); 
```

可用于从`sourceUrl`.

JSON 是用于描述数据的简单 JavaScript 代码。这可以由 JavaScript 解释器评估以获取数据结构。

评估来自远程源的代码通常是个坏主意。我知道 JSON 规范并没有明确允许函数声明，但是没有理由不能在代码中包含一个函数声明，并且让一个不安全和天真的消费者编译/执行代码。

jQuery 如何处理解析？它是否评估此代码？有哪些保护措施可以阻止某人入侵`sourceUrl`和分发恶意代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T02:39:48.253

上次我查看（2008 年末）JQuery 函数 get() getJSON() 等在内部评估 JSon 字符串，因此面临与 eval 相同的安全问题。

因此，在以任何形式使用 eval() 之前，使用一个解析函数来验证 JSON 字符串以确保它不包含狡猾的非 JSON javascript 代码是一个非常好的主意。

[您可以在https://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)找到这样的功能。

请参阅[JSON 和 Broswer Security](http://yuiblog.com/blog/2007/04/10/json-and-browser-security/)以获得有关该领域的良好讨论。

总之，使用 JQuery 的 JSON 函数而不解析输入 JSON（使用上述链接函数或类似函数）并不是 100% 安全的。

注意：如果 getJSON 中仍然缺少这种解析（可能是最近添加的），那么从 JQuery 参考文档中了解由于跨域功能而导致的这种风险更为重要：

> 从 jQuery 1.2 开始，如果指定 JSONP 回调，则可以加载位于另一个域中的 JSON 数据，可以这样完成：“myurl?callback=?”。jQuery 自动替换 ? 使用正确的方法名称调用，调用您指定的回调。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T02:39:17.287

`$.getJSON()`用于执行（而不是使用`eval`）来自远程源的 javascript 代码（如果指定了回调，则使用 JSONP 习惯用法）。使用此方法时，完全取决于您是否信任来源，因为他们将控制您的整个页面（他们甚至可以发送 cookie）。

来自[Douglas Crockford](http://javascript.crockford.com/script.html)网站关于*Script Tag Hack* (jsonp)：

> 所以脚本可以访问和使用它的cookies。它可以使用用户的授权访问原始服务器。它可以检查 DOM 和 JavaScript 全局对象，并发送它在世界任何地方找到的任何信息。Script Tag Hack 并不安全，应该避免。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T14:44:40.240

[IE 8](http://blogs.msdn.com/ie/archive/2008/09/10/native-json-in-ie8.aspx)和[Firefox 3.1](http://blog.mozilla.com/webdev/2009/02/12/native-json-in-firefox-31/)都将支持原生 JSON，这将为 eval() 提供一个安全的替代方案。我希望其他浏览器也能效仿。我还希望 jQuery 更改其实现以使用这些本机方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T02:20:58.640

我知道的所有浏览器都通过 Ajax 禁用跨站点请求。也就是说，如果您的页面位于 my.example.com 上，则您无法使用 Ajax 加载任何内容，除非其 URL 也在 my.example.com 上。

这实际上可能是一件令人讨厌的事情，并且攻击者可以通过其他方式注入源代码，但表面上这个限制是为了解决您提到的问题。

# wpf - WPF ListView 数据绑定拖放自动滚动

> ID：559606
> 
> 赞同：7
> 
> 时间：2009-02-18T02:20:29.733
> 
> 标签：wpf, data-binding, listview, collections, drag-and-drop

我在[这里](http://bea.stollnitz.com/blog/?p=53)使用 Bea 的解决方案已经有一段时间了，发现它很有帮助。现在我遇到的问题是，当我在另一个 ListView 控件内或向另一个 ListView 控件拖放项目并且我想在拖动“期间”向上/向下滚动（将项目从索引 30 移动到索引 1）时，它没有发生。我将不得不拖动到 ListView 中可视项目的顶部，手动向上滚动，然后再次拖动，最终在我想要的位置结束。这不是很用户友好。

现在我找到了我想要测试哪个项目被拖过的函数（DragDropHelper.DropTarget_PreviewDragOver），我明白了。

```
Dim pt As Point = e.GetPosition(DirectCast(Me.targetItemsControl, UIElement))

' Perform the hit test against a given portion of the visual object tree.
Dim result As HitTestResult = VisualTreeHelper.HitTest(Me.targetItemsControl, pt) 
```

现在从那里我可以得到这个视觉命中的 DependencyProperty

```
Dim lvi As ListViewItem = TryCast(GetDependencyObjectFromVisualTree(TryCast(result.VisualHit, DependencyObject), GetType(ListViewItem)), ListViewItem) 
```

这是一个ListViewItem。现在，在函数 DropTarget_PreviewDragOver 中，我有一个“DraggedItem”，它在 Bea 的示例中属于 Picture 类型，但这可能会根据您绑定到 ListView 的 ObservableCollection 而改变。现在，我想根据鼠标在控件上的位置向上或向下拖动 ListView。我尝试使用以下未完成的非工作代码

```
If lvi IsNot Nothing Then
    If pt.Y <= 25 Then
        Dim lv As ListView = TryCast(targetItemsControl, ListView)
        If lv IsNot Nothing Then
            Dim index As Integer = lv.Items.IndexOf(lvi)
            If index > 1 Then
                lv.ScrollIntoView(lv.Items(index - 1))
            End If
        End If
    Else
        If pt.Y >= Me.targetItemsControl.ActualHeight - 25 Then
            Debug.Print("Scroll Down")
        End If
    End If
End If 
```

有人可以指出我在拖动项目时让这个 ItemsControl 或 ListView 滚动的正确方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T16:32:41.080

我所做的是利用了这种`ListBox.ScrollIntoView`方法。基本上，当你更新你的放置目标时，你可以在它上面调用这个方法，wpf 会做所有的工作。您只需要知道放置目标项目的索引。这处理垂直和水平滚动。

`this.listView.ScrollIntoView(this.listView.Items[index]);`

当您使用此方法时，您的装饰器可能会随着滚动的 ListBox 一起移动。为了解决这个问题，我只是将我的装饰器父级和装饰器层父级设置为可视树顶部的窗口内容（即`topWindow.Content`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-02T22:25:45.483

我还在纠结这个完全相同的问题。我使用的是 Bea's Drag and Drop 的略微修改版本[，](http://hinshlabs.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=31504)它使用的是 VB 而不是 C#。当我如上所述使用 ScrollIntoView 时，我可以向下滚动但不能向上滚动。所以我搞砸了，想出了这个作为我的 DropTarget_PreviewDragOver：

```
 Private Sub DropTarget_PreviewDragOver(ByVal sender As Object, ByVal e As DragEventArgs)
        Dim draggedItem As Object = e.Data.GetData(Me.m_format.Name)
        Me.DecideDropTarget(e)
        If (Not draggedItem Is Nothing) Then
            If (TypeOf m_targetItemsControl Is ListBox) Then
                Dim lb As ListBox = CType(m_targetItemsControl, ListBox)
                Dim temp As Integer = m_insertionIndex
                Dim scroll As ScrollViewer = Utilities.GetScrollViewer(lb)
                If scroll.VerticalOffset = temp Then
                    temp -= 1
                End If
                If temp >= 0 And temp <= (lb.Items.Count - 1) Then
                    lb.ScrollIntoView(lb.Items(temp))
                End If
            End If
            Me.ShowDraggedAdorner(e.GetPosition(Me.m_topWindow))
            Me.UpdateInsertionAdornerPosition()
        End If
        e.Handled = True
    End Sub 
```

我必须包括这个效用函数，取自[这里](http://www.developingfor.net/wpf/fun-with-the-wpf-scrollviewer.html)

```
 Public Shared Function GetScrollViewer(ByVal listBox As ListBox)
    Dim scroll_border As Decorator = CType(VisualTreeHelper.GetChild(listBox, 0), Decorator)
    If (TypeOf scroll_border Is Decorator) Then
        Dim scroll As ScrollViewer = CType(scroll_border.Child, ScrollViewer)
        If (TypeOf scroll Is ScrollViewer) Then
            Return scroll
        Else
            Return Nothing
        End If
    Else
        Return Nothing
    End If

End Function 
```

这是伟大的。然后在装饰器移动的情况下运行上面提到的 theuberk，并且本着以后让其他人更容易做到这一点的精神，我在 DragDropAdorner 类中添加了一个变量：

```
 Private m_mouseDelta As Point 
```

将此添加到 DragSource_PreviewMouseLeftButtonDown 的最后一行：

```
 Me.m_mouseDelta = e.GetPosition(m_sourceItemContainer) 
```

并将 ShowDraggedAdorner 变成：

```
 Private Sub ShowDraggedAdorner(ByVal currentPosition As Point)
    If (Me.m_draggedAdorner Is Nothing) Then
        Dim adornerLayer As AdornerLayer = adornerLayer.GetAdornerLayer(Me.m_topWindow.Content)
        Me.m_draggedAdorner = New DraggedAdorner(Me.m_draggedData, DragDropBehavior.GetDragTemplate(Me.m_sourceItemsControl), m_topWindow.Content, adornerLayer)
    End If
    Me.m_draggedAdorner.SetPosition((currentPosition.X - m_mouseDelta.X), (currentPosition.Y - m_mouseDelta.Y))
    End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-02T16:32:36.983

滚动的另一种可能性是使用 ScrollBar-Commands。您可以在不爬下 VisualTree 的情况下执行此操作。如果您有一个没有边框的样式 ListBox，则 GetScrollViewer() 方法将不再起作用。

我使用 ItemContainerGenerator 的第一个元素作为 ScrollBar.LineXXXCommand 的 CommandTarget：

```
Point p = e.GetPosition(itemsControl);
  IInputElement commandTarget = itemsControl.ItemContainerGenerator.ContainerFromIndex(0) as IInputElement;

  if (commandTarget != null)
  {
    if (p.Y < OFFSET_TO_SCROLL)
      ScrollBar.LineUpCommand.Execute(null, commandTarget);
    else if (p.Y > itemsControl.ActualHeight - OFFSET_TO_SCROLL)
      ScrollBar.LineDownCommand.Execute(null, commandTarget);

    if (p.X < OFFSET_TO_SCROLL)
      ScrollBar.LineLeftCommand.Execute(null, commandTarget);
    else if (p.X > itemsControl.ActualWidth - OFFSET_TO_SCROLL)
      ScrollBar.LineRightCommand.Execute(null, commandTarget);
  } 
```

调用 LineXXXCommands 类似于单击 ScrollBar 的箭头按钮：ScrollViewer 滚动一定量，您可以通过设置 ScrollBar 的“SmallAmount”属性来配置该量。

# password-protection - 源代码管理中的密码存储

> ID：559611
> 
> 赞同：19
> 
> 时间：2009-02-18T02:21:52.553
> 
> 标签：password-protection, password-storage

我们将所有应用程序和数据库密码以纯文本形式存储在源代码控制中。我们这样做是因为我们的构建/部署过程会生成所需的配置文件，并且还会进行需要这些密码的实际部署（即：对数据库运行 sql 需要您使用有效的凭据登录到数据库）。有没有人有类似的需求，您可以在不以纯文本形式存储密码的情况下实现此类功能？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-18T03:37:39.750

如果您的计划是存储所有代码和配置信息以直接从版本控制运行生产系统，并且无需人工干预，那么您就完蛋了。为什么？这完全违反了旧的安全公理“永远不要写下你的密码”。让我们做一个否定证明。

首先，您在配置文件中有纯文本密码。这不好，任何可以看到文件的人都可以阅读它们。

第二切，我们将加密密码！但现在代码需要知道如何解密密码，所以需要将解密密钥放在代码中的某个位置。这个问题刚刚被推低了一个层次。

使用公钥/私钥怎么样？与密码相同的问题，密钥必须在代码中。

使用未存储在版本控制中的本地配置文件仍然会将密码以及读取密码的方法（如果它们已加密）放在磁盘上并可供攻击者使用。您可以通过确保配置文件的权限非常有限来稍微强化一下，但是如果该框被植根，您就完蛋了。

这让我们明白为什么将密码放在磁盘上是一个坏主意。它违反了安全防火墙的概念。一台包含登录信息的被入侵机器意味着其他机器将被入侵。一台维护不善的机器可能会摧毁您的整个组织。

在某些时候，人类将不得不注入关键秘密来启动信任链。您可以做的是加密代码中的所有秘密，然后在系统启动时让人工手动输入密钥以解密所有密码。这就像 Firefox 使用的主密码系统。它很容易被滥用，因为一旦一个密码被泄露，许多系统可能会被泄露，但它更方便并且可能更安全，因为用户只需要记住一个密码并且不太可能写下来。

最后一点是确保如果登录信息被泄露（并且您应该始终假设它会），A）攻击者无法对其进行太多操作，并且 B）您可以快速关闭被泄露的帐户。前者意味着只为帐户提供所需的访问权限。例如，如果您的程序只需要从数据库中读取数据，则让它登录一个限制为 SELECT 的帐户。通常，删除所有访问权限，然后仅在必要时添加。对删除的权利要小气，以免你得到[小鲍比桌](http://xkcd.com/327/)的访问。

后者意味着您为每个用户/组织/项目提供自己的登录名，即使他们可以拥有完全相同的权限和特权并访问相同的数据。这有点麻烦，但这意味着如果一个系统受到威胁，您可以快速关闭该帐户，而不会关闭您的整个业务。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T02:42:00.493

我假设目标是您不希望任何人可以访问、加密、解密或以其他方式获得公司的私人密码，否则任何人都应该被允许访问源的其余部分。

这是我的做法。我从 TikiWiki 复制了这种模式，它也这样做。

在某些通常包含密码的文件中，将它们设置为虚拟值，没关系。将其设置为您的客户应该看到的任何内容。在附近发表评论，让开发人员不要管这个文件并更改第二个文件。

在第二个文件中，如果它不存在则创建，输入实际密码。安排这个文件被第一个文件包含，导入，无论如何。

安排您的源代码管理忽略该文件。可能看起来像这样：

```
# in .gitignore
localsettings.py

# in settings.py
## Alter this value to log into the snack machine:
## developers: DON'T alter this, instead alter 'localsettings.py'
SECRET_VALUE = ""
try:
  from localsettings import *
except:
  pass

# in localsettings.py
SECRET_VALUE = "vi>emacs" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:51:55.663

我已经构建了数据库用户名/密码对不属于代码删除的系统。关键是建立一个特定于站点的配置机制。然后你可以把这些信息放在有问题的盒子上，而不是代码库的一部分。

有一个好处：您不仅可以为不同的代码删除设置不同的密码，还可以为不同的开发人员设置不同的密码。:-)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-18T02:34:47.407

你没有提到语言，所以这是我们使用的 vb.net 解决方案：

```
Imports System.Web.Security
Imports System.Security.Cryptography
Imports System.Text
Imports Microsoft.Win32

Public Class myCrypt

Private myKey As String = "somekeyhere"
Private cryptDES3 As New TripleDESCryptoServiceProvider()
Private cryptMD5Hash As New MD5CryptoServiceProvider()

Private Function Decrypt(ByVal myString As String) As String
    cryptDES3.Key = cryptMD5Hash.ComputeHash(ASCIIEncoding.ASCII.GetBytes(myKey))
    cryptDES3.Mode = CipherMode.ECB
    Dim desdencrypt As ICryptoTransform = cryptDES3.CreateDecryptor()
    Dim buff() As Byte = Convert.FromBase64String(myString)
    Decrypt = ASCIIEncoding.ASCII.GetString(desdencrypt.TransformFinalBlock(buff, 0, buff.Length))
End Function

Private Function Encrypt(ByVal myString As String) As String
    cryptDES3.Key = cryptMD5Hash.ComputeHash(ASCIIEncoding.ASCII.GetBytes(myKey))
    cryptDES3.Mode = CipherMode.ECB
    Dim desdencrypt As ICryptoTransform = cryptDES3.CreateEncryptor()
    Dim MyASCIIEncoding = New ASCIIEncoding()
    Dim buff() As Byte = ASCIIEncoding.ASCII.GetBytes(myString)
    Encrypt = Convert.ToBase64String(desdencrypt.TransformFinalBlock(buff, 0, buff.Length))
End Function

End Class 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-02-18T02:29:31.163

以加密形式存储密码。编写一个自定义例程，在构建时解密密码并更新配置文件。这可以很容易地与 Ant 等构建工具集成。

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2009-02-18T02:25:54.993

如果在 C 中做，您可以存储为字符数组并将字符作为十进制引用。不确定这是否会破坏字符串，但可能有助于缓解一些问题。

```
char pass[]={72, 101, 108, 108, 111}; 
```

# sql-server - 如何创建触发器

> ID：559621
> 
> 赞同：0
> 
> 时间：2009-02-18T02:28:10.730
> 
> 标签：sql-server, tsql, triggers

我正在使用 sql server 2000。我的树结构表在这里

```
tItem
   ItemID int keyfield,
   ParentItemID int,
   Title nvarchar 200,
   ChildCount int,
   Status int 
```

我需要计算 ChildCount 和 Status 触发器。当我插入一项时，父项必须计算子项计数和状态。0 < 状态 < 100

计算父母状态，如果父母有 2 个孩子，则将孩子状态相加，然后除以孩子数。示例：80+100/2 此操作对根父级递归。例如：

前 ：

```
Project Child=1, Status=80 
|-Module  Child=1, Status=80
| |-Control Child=0, Status=80 
```

插入表单项后

```
Project Child=1, Status=90      // 3 Calculate child and status
|-Module  Child=2, Status=90    // 2 Calculate child and status
| |-Control Child=0, Status=80 
| |-Form  Child=0, Status=100   // 1 First. inserted row 
```

这个例子有 3 级，也许我的表树结构级别大于 32

如何创建此触发器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T03:09:44.187

I think you should be able to use this:

```
create trigger on tItem after insert or update as
if (inserted.ParentItemID is not null)
    update tItem set ChildCount = (select count(1) from tItem where ParentItemID=ItemID)
    where ItemID = inserted.ParentItemID
    -- calculate status here
go 
```

That should, if I've still got all my marbles, fire and update the parent's ChildCount, which in turn will fire off the same trigger again and update the parent's parent's ChildCount until it runs out of parents to update.

However, I would *strongly* suggest you rather use a view, or a stored procedure, to calculate these dynamically - it's not a good idea to store data of this nature statically unless your table is going to be read heavily by other queries.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T03:12:27.347

You should be able to call a UDF in your trigger for each row in inserted.

Alternatively, if the tree is manageable and not changing frequently, you can call an SP to recalc the entire tree after any insertion.

Also, in your example, why doesn't the root status change to 90 when its sole child's status has changed to 90?

# decompiling - 程序员应该使用反编译器吗？

> ID：559629
> 
> 赞同：2
> 
> 时间：2009-02-18T02:31:45.463
> 
> 标签：decompiling

听说最近我一直在听 Jeff Atwood 和 Joel Spolsky 的广播节目，他们一直在谈论 dogfooding（重用您自己的代码的过程，请参阅 Jeff Atwood 的博客[文章](http://www.codinghorror.com/blog/archives/001217.html)）。所以我的问题是程序员是否应该使用反编译器来查看程序员的代码是如何实现和工作的，以确保它不会破坏你的代码。或者你应该相信程序员的代码并适应它，因为使用反编译器违背了我们作为程序员所了解的关于隐藏数据的一切（至少是 OO 程序员）？

**注意：**我不确定这会属于哪些标签，所以请随时重新标记它。

**编辑：**只是为了澄清我在最后的手段上询问反编译器，说由于某种原因你无法获得源代码。对不起，我应该在原始问题中提供这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T02:51:57.397

是的，使用反编译器的输出可能很有用，但不适用于您的建议。编译器的输出看起来永远不像人类写的那样（除非它确实写了）。它不能告诉你为什么代码会这样做，或者特定变量应该意味着什么。除非您已经拥有源代码，否则这样做不太可能值得。

如果您确实有源代码，那么在您的开发过程中使用反编译器有很多充分的理由。

大多数情况下，使用反编译器输出的原因是为了更好地优化代码。有时，使用高优化设置，编译器会出错。在某些情况下，如果不比较不同优化级别的编译器输出，这几乎是不可能解决的。

其他时候，当试图从非常热的代码路径中榨取最大性能时，开发人员可以尝试以几种不同的方式排列他们的代码并比较编译结果。作为最后的手段，这可能是用汇编语言实现代码块时最简单的方法，即复制编译器的输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T02:35:12.973

Dogfooding 是使用您编写的代码的过程，不一定是重复使用代码。

但是，代码重用通常意味着您拥有源代码，因此“代码重用”否则它只是使用其他人提供的库。

反编译很难正确，输出通常很难理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:36:44.547

如果它是完成工作所需的工具，则应该使用反编译器。但是，我不认为正确使用反编译器来了解被反编译的代码的编写情况。根据您使用的语言，反编译的代码可能与实际编写的代码有很大不同。如果您想查看一些真实代码，请查看开源代码。如果您想查看某个特定产品的代码，最好尝试通过某种合法方式访问实际代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T02:37:45.417

我不确定您到底在问什么，您期望“反编译器”向您展示什么，或者这与 Atwood 和 Spolsky 有什么关系，或者问题到底是什么。如果您正在对公共接口进行编程，那么您为什么需要查看第三方代码的原始来源以查看它是否会“破坏”您的代码？您可以更有效地构建测试以确定这一点。同样，“反编译器”会告诉你什么很大程度上取决于编写软件的语言/平台，无论是 Java、.NET、C 等等。即使在 .NET 程序集的情况下，它也与读取原始源代码不同。反正，如果您担心第三方代码不适合您，那么您真的应该对代码进行典型的单元测试，而不是尝试“反编译”它。至于你是否“应该”，如果你的意思是你是否“应该”以其他方式而不是最好地利用你的时间，那么我不确定你的意思。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T02:42:06.967

> 程序员应该使用反编译器吗？

为正确的工作使用正确的工具。反编译器通常不会产生易于理解的结果，但有时它们是需要的。

> 程序员是否应该使用反编译器来查看程序员的代码是如何实现和工作的，以确保它不会破坏您的代码。

不，除非您发现问题并需要支持。一般来说，如果你不信任它，你就不会使用它，如果你必须使用它，即使你不信任它，你也要开发测试来证明功能并验证以后的升级是否仍然按预期工作。

不要使用你没有测试的功能，除非你有很好的支持或信任关系。

-亚当

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T02:57:59.673

> 或者你应该相信程序员的代码并适应它，因为使用反编译器违背了我们作为程序员所了解的关于隐藏数据的一切（至少是 OO 程序员）？

这根本不是真的。您将使用反编译器不是因为您想绕过任何类型的抽象、封装或破坏 OO 原则，而是因为您想*了解*为什么代码表现得更好。

有时您需要使用反编译器（或者在 Java 世界中，字节码查看器），当您使用 3rd 方库解决一个恼人的错误时，其中抛出异常而没有有用的错误消息、没有日志记录等。

使用反编译器与 OO 原则无关。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T03:30:15.493

对此的简短回答......对公共和文档化规范进行编程，而不是实现。依赖实现细节和副作用会烧死你。

反编译不是帮助您正确编程的工具，尽管它可能会在紧要关头帮助您理解您没有源代码的其他人代码的问题。

另外，要注意反编译可能存在的法律风险；许多软件公司都有禁止反编译的条款，这可能会使您和您的雇主面临法律后果。

# iphone - iPhone：从 UINavigationController 堆栈中弹出 modalViewController

> ID：559630
> 
> 赞同：0
> 
> 时间：2009-02-18T02:32:53.090
> 
> 标签：iphone, cocoa-touch, cocoa

自从我使用了我的 UIViewController 子类之一并将其以模式视图的形式呈现给用户以来，使用 presentModalViewController:animated.. 我无法使用以下方法将其关闭：

```
[self dismissModalViewControllerAnimated:YES]; 
```

我确实相信这与我在 modalViewController 上实例化 UINavigationController 的方式有些奇怪，代码如下所示（App Delegate 中也有类似的代码）：

```
UIWindow *window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
navigationController =
    [[UINavigationController alloc] initWithRootViewController:self];
navigationController.navigationBar.barStyle = UIBarStyleBlackOpaque;
[window addSubview:navigationController.view];
[window makeKeyAndVisible]; 
```

导航堆栈按预期工作，但除非我将其删除，否则我无法再关闭模式视图控制器。我的印象是我不应该多次向 UIWindow 添加 subView，这只是问题之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T03:16:06.370

Make sure you call dismissModalViewControllerAnimated on the parent of the modal view controller, not on the modal view controller itself.

# asp.net - ExecuteScalar 抛出 NullReferenceException

> ID：559632
> 
> 赞同：5
> 
> 时间：2009-02-18T02:34:41.230
> 
> 标签：asp.net, sql-server

`NullReferenceException`此代码在调用时抛出`ExecuteScalar`：

```
selectedPassengerID = 0;

//SqlCommand command = GenericDataAccess.CreateCommand();

// 2nd test
string connectionString = "";
SqlConnection conn;

connectionString = ConfigurationManager.
    ConnectionStrings["ConnST-MHM"].ConnectionString;
conn = new SqlConnection(connectionString);
SqlCommand command = new SqlCommand();
command.CommandType = CommandType.StoredProcedure ;
command.Connection = conn;
command.CommandText = "SearchForPassenger";

SqlParameter param;

param = command.CreateParameter();
param.ParameterName = "@name";
param.Value = pName; // Session[""];
param.DbType = DbType.String;
command.Parameters.Add(param);

param = command.CreateParameter();
param.ParameterName = "@flightDate";
param.Value = date; 
param.DbType = DbType.String;
command.Parameters.Add(param);

param = command.CreateParameter();
param.ParameterName = "@ticketNo";
param.Value = ticketNumber; 
param.DbType = DbType.Int32;
command.Parameters.Add(param);

int item;

command.Connection.Open();
item = (int)command.ExecuteScalar(); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-18T02:47:38.623

我已将大部分 SQL 逻辑封装在 DAL 中。这些 DAL 方法之一使用以下逻辑提取标量 Int。它可能对您有用：

```
 object temp = cmnd.ExecuteScalar();
  if ((temp == null) || (temp == DBNull.Value)) return -1;
  return (int)temp; 
```

我知道您在上面输入了很多代码，但我认为这确实是您问题的本质。祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-18T02:50:49.020

[`ExecuteScalar`](http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executescalar.aspx)如果查询没有返回任何记录（例如，当您的`SearchForPassenger`存储过程没有返回行时），则返回 null。

所以这一行：

```
item = (int) command.ExecuteScalar(); 
```

在这种情况下正试图转换`null`为`int`。这会引发一个`NullReferenceException`.

根据刚刚弹出[的马克的回答](https://stackoverflow.com/questions/559632/executescalar-gives-nullreferenceexception/559660#559660)，您需要检查`null`：

```
object o = command.ExecuteScalar();
item = o == null ? 0 : (int)o; 
```

# emacs - Emacs Lisp 功能指南？

> ID：559634
> 
> 赞同：17
> 
> 时间：2009-02-18T02:35:10.680
> 
> 标签：emacs, elisp

我已经使用 Emacs 三年多了，但我仍然需要几天的时间才能在 Lisp 中编写小函数。我浏览了[GNU Emacs Lisp 参考手册](http://www.gnu.org/software/emacs/manual/elisp.html)，但它很大，结构与 JavaDoc 完全相反，不是从函数到描述，而是相反。

让我的生活更轻松的是某种小型 JavaDoc 文档，其中包含最常用的 Emacs 内部函数和快速描述。

```
    (point) - 返回缓冲区中的当前位置
    (save-excursion (p)) - 将当前位置保存在缓冲区之前
                           执行 (p) 并在之后恢复它。

```

有谁知道我在哪里可以找到类似的东西？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-18T05:15:28.207

您是否尝试过 emacs 中的内置手册？打开任何 lisp 缓冲区（或 lisp 模式下的任何缓冲区），将您的点移动到任何函数或变量，然后点击 Ch f（对于函数）或 Ch v（对于变量）。Emacs 会给你一个相当简洁的函数/变量描述。

例如，(save-excursion) 的手册内容是

```
save-excursion is a special form in `C source code'.
(save-excursion &rest BODY)

Save point, mark, and current buffer; execute BODY; restore those things.
Executes BODY just like `progn'.
The values of point, mark and the current buffer are restored
even in case of abnormal exit (throw or error).
The state of activation of the mark is also restored.

This construct does not save `deactivate-mark', and therefore
functions that change the buffer will still cause deactivation
of the mark at the end of the command.  To prevent that, bind
`deactivate-mark' with `let'. 
```

好消息是内置手册给你“链接”到函数的源代码和可能相关的其他函数，这使得浏览起来很方便。

当然，你不能以这种方式学习 lisp，但对于查找函数文档来说，这是一个不错的入门。当您发现内置手册无法理解时（有时确实会发生），那么您就该用谷歌搜索该功能了；）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-18T03:21:46.153

这个站点有一些可能有用的 emacs lisp 摘要信息：http: [//xahlee.org/emacs/elisp.html](http://xahlee.org/emacs/elisp.html)。

特别是，请查看该页面上的这些链接：[Basic Text-editing Functions](http://xahlee.org/emacs/elisp_common_functions.html)、[Emacs Lisp Idioms](http://xahlee.org/emacs/elisp_idioms.html)和[Batch Text Processing](http://xahlee.org/emacs/elisp_idioms_batch.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-18T03:34:28.650

emacs lisp的 GNU[简介](http://www.gnu.org/software/emacs/emacs-lisp-intro/)肯定比参考手册更容易理解。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-18T13:32:44.080

我要补充几点：

*   `M-x apropos`- 在函数和变量中搜索您指定的任何字符串（例如目录）。`C-h a`请注意，这与仅查找交互功能的 略有不同

*   找到一段类似的代码并复制它——通过查看已经完成的内容，您可以学到很多关于如何做事的知识。如果您想查看某个特定功能的示例，一种好方法是访问 dired 中的主要 lisp 源目录（例如 d:/product/emacs/lisp 或 /usr/share/lib/emacs/lisp）并执行`% g`这将遍历所有文件以查找您键入的任何字符串。打开那个文件，看看其他人用它做了什么。

*   `C-h f`并且`C-h v`-正如其他人提到的，您可以打开源代码，将点定位在函数或变量上，然后获取有关它的文档。

*   查看[Emacs wiki](http://www.emacswiki.org/emacs/)，其中包含大量 Emacs lisp 模块供您仔细阅读。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-18T13:39:16.403

我认为你采取了错误的方法。在学习一门编程语言和一组库（统称为“Emacs Lisp”）时，您需要在微观和宏观尺度上处理它。在您开始编写软件之前，您需要知道您可以使用哪些工具。这就是 Emacs Lisp 手册旨在教育您的内容。你真的需要坐下来阅读整本书。这样你就知道 Emacs 提供了哪些功能。

在你这样做之后，你需要“微观层面”的信息。有许多来源提供了这一点。如果您大致了解需要做什么（“使用缓冲区”），那么 Lisp 参考资料是了解您需要了解的内容的好地方。如果您知道有一个功能可以满足您的需求，但不太记得名称，那么`M-x apropos`( `C-u C-h a`) 将帮助您搜索文档。如果您知道要使用什么功能，但不太记得它是如何工作的，那么`M-x describe-function`( `C-h f`) 会为您解决。

所以不管怎样，关键是学习 Emacs Lisp，然后让 Emacs 帮你搞定细节。函数列表不会教你太多。

（哦，还有一件事——你应该熟悉 Common Lisp。大多数 Emacs 库都使用`cl`，这是在 Emacs Lisp 中实现的有用的 CL 函数。、、、 `loop`等等`destructuring-bind`都 `defun*`在那里，它们非常有用。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-09-05T05:54:56.163

其他人的好建议——Emacs 帮助系统是你的朋友。此外：

*   [http://www.emacswiki.org/emacs/EmacsNewbieWithIcicles](http://www.emacswiki.org/emacs/EmacsNewbieWithIcicles)

*   [http://www.emacswiki.org/emacs/Icicles_-_Progressive_Completion](http://www.emacswiki.org/emacs/Icicles_-_Progressive_Completion)

*   [http://www.emacswiki.org/emacs/Icicles_-_Nutshell_View#ChippingAway](http://www.emacswiki.org/emacs/Icicles_-_Nutshell_View#ChippingAway)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-16T15:35:01.443

为了了解发生了什么，查看源代码通常很有用。

[http://repo.or.cz/w/elbb.git/blob/HEAD:/code/Go-to-Emacs-Lisp-Definition.el](http://repo.or.cz/w/elbb.git/blob/HEAD:/code/Go-to-Emacs-Lisp-Definition.el)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-18T03:48:19.197

如果你愿意花钱买一棵死树，我建议

[![学习 GNU Emacs](https://i.stack.imgur.com/8B2Sm.gif)](http://oreilly.com/catalog/9780596006488/index.html)
[（来源：[oreilly.com](http://oreilly.com/catalog/covers/0596006489_cat.gif)）]

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-18T14:14:38.987

你试过`<f1> f`吗？它是必然的`describe-function`。示例`point`：

```
point is a built-in function in C source code.
(point)

Return value of point, as an integer.
Beginning of buffer is position (point-min).

[back] 
```

像大多数 Lisp 系统一样，Emacs 有一个集成的文档工具！

*   任何 Lisp 函数或变量都可以声明一个可选的文档字符串。
*   几乎所有标准命令或函数都声明了一个有用的文档字符串。
*   Emacs（像大多数 Lisp 系统一样）允许您随时显示任何函数或变量（`<f1> f`和`<f1> v`）的文档字符串。
*   显示时，文档字符串是可浏览的，这意味着您可以单击符号查看其文档字符串，或转到相应函数或变量的源。
*   只要您评估任何`defun`or `defvar`，它的文档字符串就可以通过`describe-function`or获得`describe-variable`：这个文档是有效的！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-16T15:16:56.647

Mx find-library RET <library name> 是你真正需要的

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-31T12:24:48.263

在 XEmacs 中，我也相信 Emacs，按 Ch f，然后按 Tab 键完成制表符，此时是*所有*功能，将为您提供编辑器知道的功能列表。

您只需使用光标键并滚动到您想了解的内容，然后按 Enter 即可查看详细信息。

如果您想要一个功能列表以及更多可用信息，那将提供给您。

这个列表是所有当前可用的功能，所以如果你安装了 lisp 包，它会显示这些包提供的功能以及本机功能。今天，在我的 XEmacs 副本中，列表中有 6,586 个函数。Emacs 将是类似的。

问题在于，并非所有函数都具有使它们具有上下文意义的名称（即，并非所有菜单变量/函数中都有菜单一词，因此如果仅按名称进行操作，则会错过一些内容。

您可以使用 INFO 页面（在菜单上）查看它们的主题排列，并获得相同的使用信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-05-17T19:06:09.973

下载 Emacs 的源代码。转到 src/ 文件夹并输入：

> grep -r DEFUN *

您将获得 Emacs 的所有原始 Lisp 函数的列表。

# authentication - 什么是双重身份验证？

> ID：559639
> 
> 赞同：2
> 
> 时间：2009-02-18T02:38:31.593
> 
> 标签：authentication

我的任务是查找和评估一些用于我们的产品之一的身份验证库，并且某些解决方案推动的销售功能之一是“双因素身份验证”。

这是什么方法，它是如何工作的？有没有更好的方法（比如三因素身份验证，我猜）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-18T02:44:54.713

两因素身份验证是使用两个因素来验证一个人（或有时是一个过程）。

这可能是 PIN 码（您知道的）和借记卡（您拥有的）。

有许多可能使用的身份验证因素：

> 身份验证因素适用于将个人身份验证为具有明确授予访问权限的个人的特殊程序。身份验证有不同的因素类型：
> 
> *   **人为因素**本质上与个人相关，例如生物特征（“你是什么”）。
> *   **个人因素**以其他方式在精神上或身体上分配给个人，例如学习的代码。（“你知道的事情”）
> *   **技术因素**与物理手段有关，例如通行证、身份证或令牌。（“你有的东西”）

[来自维基百科。](http://en.wikipedia.org/wiki/Two-factor_authentication)

您选择哪些因素取决于所需的访问类型、所需的安全性、成本，尤其是人们愿意忍受的程度。

人们对每 4 个月更改一次的强密码感到恼火，因此您可能会发现员工对配备指纹扫描仪的笔记本电脑更满意，他们可以使用弱密码和指纹——两因素身份验证对用户来说可能更容易。

但其他人可能不喜欢生物识别安全的隐私影响，宁愿随身携带一个钥匙串设备，该设备会产生与密码一起输入的数字。

高安全性情况可能需要所有三个因素 - 您拥有的东西（例如卡）、您所拥有的东西（例如视网膜成像）以及您知道的东西（例如密码）。

但是随着您添加更多级别，成本和刺激也会增加。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T02:40:01.387

当两个（或更多）不同的因素结合使用来对某人进行身份验证时。

例如，银行可能会要求您提供帐号和密码。有时，例如当您致电呼叫中心时，他们可能会要求您提供其他因素，例如姓名、出生日期、电话号码、地址等。

该理论是，您可以验证的因素越多，您与正确的人打交道的可能性就越高。在我看来，它的工作效果如何以及它有多安全是值得商榷的......

因素包括：

*   **人为因素**本质上与个人相关，例如生物特征（“你是什么”）。
*   **个人因素**以其他方式在精神上或身体上分配给个人，例如学习的代码。（“你知道的事情”）
*   **技术因素**与物理手段有关，例如通行证、身份证或令牌。（“你有的东西”）

见：[http ://en.wikipedia.org/wiki/Two-factor_authentication](http://en.wikipedia.org/wiki/Two-factor_authentication)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:46:38.017

“有没有更好的方法（比如三因素身份验证，我猜）？”

问题不仅仅是**更多**的因素。这是一个更好的因素组合。

密码很容易丢失和泄露。人们将它们写在便签上，然后放在键盘底部。

其他非密码因素也是其中的一部分。对于基于浏览器的应用程序，您可以使用 IP 地址和其他作为 HTTP 标头一部分浮动的 PC 特定材料。对于桌面应用程序（如 VPN 连接），独立的密钥生成器或插入式 USB 阅读器可能会提供额外的因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-22T15:51:23.000

我会以完全不同的方式来理解这一点。当然，所有这些答案都是正确的，但我想稍微拓宽一下这个话题——考虑在何时何地应用双因素身份验证。可以使用强认证的三个领域：会话认证、相互认证和事务认证。会话身份验证是大多数人在考虑 2FA 时所想到的。但是想象一下，如果人们在进行银行交易时只需要使用 OTP。攻击面从“登录时”变为“进行交易时”，后者要小得多。如果交易认证使用公钥系统对 tx 进行签名，那就更好了。

相互身份验证是一些试图阻止 MiTM 攻击的系统。您可以想到一些银行网站使用的小图片，但它们完全无效，因为不涉及加密。这是我们通过为用户验证站点的 ssl 证书来进行相互身份验证的方法：http: [//www.wikidsystems.com/learn-more/technology/mutual_authentication/](http://www.wikidsystems.com/learn-more/technology/mutual_authentication/)。当然，还有其他方法可以做同样的事情。

# .net - 有关面向方面编程的帮助和信息

> ID：559656
> 
> 赞同：17
> 
> 时间：2009-02-18T02:45:38.580
> 
> 标签：.net, aop

我是面向方面编程思想的新手，但我想探索在我的项目中使用它来处理日志记录、报告等的想法。为此，我有一些问题：

*   为了这些有限的目的，我是否应该费心探索这条 AOP 路径？
*   有哪些支持 AOP 的 .NET Framework 可用？
*   这些框架中的哪一个支持流畅的界面（我讨厌 XML 配置）:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-18T03:24:45.647

**Aspect Oriented Programming**不仅仅是记录、报告等，如果您查看 PostSharp 的网站，您就会看到。就我个人而言，我没有做太多静态 IL 编织，主要是动态 IL 生成来创建 AOP 拦截器，这样做时我主要使用它来包装和拦截来自控制容器反转的解析。

AOP可以改进异常处理，改进跟踪，改进事务拦截。

**例如， NHibernate**有一种 AOP，尽管它在编译时是静态的，就简单的事件处理程序而言；但是对于引擎中的某些事件，您可以附加拦截器（又名方面，事件是切入点等）——我使用它来注入，使用 IoC 业务实体到我的域对象中。

强大的 AOP 框架允许您进行泛化，甚至更强大的允许您在运行时进行无开销的泛化；原则上，您有**几种不同的方法**：

(0)。（不是真的）“预处理器”AOP 又名 C++ 中的模板，ifdefs 等

1.  反射“AOP”
2.  在运行时通过 Reflection.Emit 生成 IL，需要高度信任。这是 Castle 项目中 DynamicProxy2 采用的路径。DynamicProxy2 相当不错，而且做了很多工作！此外，afaik PatternsAndPractices Policy Framework 也使用这种方法，虽然有自己的生成器，但有很多 XML。NHibernate 依赖于 DynProx2。
3.  通过使用 System.CodeDom.Compiler 在运行时进行 IL 编译 + Assembly.Load(...)，然后加载您创建的组件，需要高度信任。也可以使用任何其他编译器（如 Boo.Compiler）进行编译，因为它会创建“全局函数程序集”，您可以以“脚本化”方式调用它，但现在我们稍微脱离了 AOP。
4.  Profiler API（不要问我）
5.  依赖运行时框架：扩展 MarshalByRef/ContextBoundObject[见链接](http://blog.csdn.net/samuex/archive/2004/10/17/139741.aspx)并使用 .Net 中的远程处理基础结构来做 AOP，这非常复杂，并且引入了您可能不想要的依赖项。
6.  编译后静态 IL-weaving、PostSharp 和 Mono.Cecil 具有 Reflection.Emit 的等价物，但是这个对于像 Reflection.Emit 这样的具体子类（如果我没记错的话）中的虚拟方法调用没有错误，并且很乐意检查您的代码类似于 Assembly.ReflectionOnlyLoad 并且还允许您将 IL 操作输出到该代码中。如果您正在寻找一种相当低级的方法，这是一个很好的选择；不需要那么高的信任。
7.  通过 p/invoke 在托管代码中为 C/C++ 的非托管回调添加扩展点，但这需要一些思考，因为异常不会愉快地跨越 m/um 内存边界（相反，它会弄乱您的应用程序），除非您在带有托管异常框架的 Windows 中使用 VC++/C#，这可能会出现非常严重的段错误。您可以将回调传递给 C 并将 p/invoke 从 C# 传递到 C，并且可能将回调从 C 传递到 C#，只要您在 C# 中定义委托即可。扩展点可能必须通过静态或动态 IL-weaver + 切入点来完成。

**事务中的用法** 查看[Castle.Facilities.AutomaticTransactionManagement.TransactionFacility](http://www.castleproject.org/container/facilities/trunk/atm/index.html)，了解使用 AOP 和 DynamicProxy2 的拦截能力处理事务的好方法。与 System.Transcations 和 System.EnterpriseServices 集成的事务工具是您使用分布式事务协调器（COM 组件）来管理事务。此外，还有多个 p/invoke 进入内核的示例来处理[Vista 内核（又名 Server 2008）的 TxF 和 TxR 组件，](http://channel9.msdn.com/shows/Going+Deep/Transactional-Vista-Kernel-Transaction-Manager-and-friends-TxF-TxR/)它们允许您在 NTFS 和注册表上使用事务，从而确保您的 CRUD做的是 ACID，它也很好地与 System.Transactions 集成以创建嵌套事务。

**不变验证中的用法** 您还可以通过将一些属性附加到参数来将它们用于合同设计。

```
public void PerformOperation([NotNull, NotEmpty] string value) {
// use string
[NotNull] return new string(' ', 5); // can return with attributes as well
} 
```

目前的问题是附加此元数据并在运行时检查它的开销。但是，您可以指定仅在使用 DEBUG 编译时应用约束检查方面，然后此元数据不会导致性能大幅下降。

如果您正在寻找公理证明，请查看 Sing#/Spec#，因为它更正式，并且工作由编译器完成。

**要注意的事情要注意的** 最重要的一点是，如果一个问题，即在您的方法之前或之后运行的某些代码正在改变控制流，可能会返回意外类型，返回过早或一般情况下不符合您调用的方法的意图，您可能会遇到难以调试的错误。

此外，请注意从属性中抛出异常，因为您永远不知道何时或从哪个程序集发生反射；对您的属性的反映可能不会在您期望的时候发生。当我在属性中附加类型并仔细检查它们时，这发生在我自己身上。

还要注意这样一个事实，即您在添加全局“切入点”时打开了一个可能的攻击向量，如果有人可以访问该切入点，可以用来重定向系统的大部分。

**其他框架** 如果您有兴趣了解更多关于 AOP 的一般知识，我建议您查看 Rickard Öberg 在[Qi4J](http://qi4j.org)上的演示文稿，它是 Java 中用于 AOP 的一个非常好的框架（尽管 java 具有稍微不同的对象继承语义，但这使得我们有点难以理解在 C#/F#/Nermle/Boo 中使用。

**AOP + 插件** 将面向方面编程与运行时生成的程序集（例如 dynamicproxy2 创建的程序集）一起使用的另一个有趣的可能性是，您还可以使用它们来包装跨应用程序边界的对象，从而简化插件管道的创建。我曾暗自希望微软在为 3.5 创建 AddIn 框架时使用它，但不幸的是，他们选择采用静态代码生成方式，为开发人员创建加载项带来了相当大的开销。问题是，除非卸载完整的 AppDomain，否则无法再次卸载为“不仅仅是反射”加载到 AppDomain 中的类型，

**使用 AOP 进行全局垃圾回收**......在公共语言基础架构上运行在 linux/windows 上的分布式系统中。这篇论文有点难下载，所以[我把它上传到我的服务器上](http://haf.se/content/dl/complete_dist_garbage_collection_with_aop_dotnet.pdf)，这样我就知道它在哪里了。

**Post Scriptum** （如果您在 CLR 上使用非标准语言而不是 DLR IL-weaving 可能会创建不符合标准的代码。我认为对于 F# 尤其有趣，因为使用*大量*非标准代码非常棒语言的好处（元组说）——如果你想获得编译时警告，你可以用 [assembly: CLSCompliant] 标记你的程序集。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T03:09:12.440

我不能说 .NET 的细节，但是 AOP 和能够将钩子附加到任意方法的更一般的想法是一种方便的技术，可以解决一些其他棘手的问题。

一个例子是[按合同设计](http://en.wikipedia.org/wiki/Design_by_contract)。假设您有一堆方法，您想在这些方法上应用一些常见的合同。您可以在调用每个方法之前和之后添加一些“建议”（AOP 术语），而无需将其剪切并粘贴到每个方法中。

在测试时，了解某些内部方法中发生了什么通常很有用。它被调用了多少次，也许它返回了什么。您可以添加一个方面来执行该监视，而无需将分散注意力的测试代码添加到方法本身。甚至可能无法编辑该方法的代码。

只需注意方面是如何实现的。一些实现是精心制作的预处理器，可能会使调试代码更加复杂。其他人则顺利地融入了语言。动态语言很好地处理 AOP。Perl 有用于 AOP 的[Aspect.pm](http://search.cpan.org/perldoc?Aspect)和更通用的[Hook::LexWrap](http://search.cpan.org/perldoc?Hook::LexWrap)来完成方法挂钩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T02:55:28.963

AOP 对我来说也很有趣。在我看来，日志记录和性能监控、报告是 AOP 旨在处理的内容。对于 .NET，[Post Sharp](http://www.postsharp.org/)是一个非常好的 AOP 框架。

我只对它进行了一点试验，但它似乎实现得很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T03:07:00.433

如果您要查看 Post Sharp，您可以从 CodePlex 下载 Google Book Downloader。我认为这个项目使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T03:04:05.637

不要认为它完全不同。AOP 通过减少耦合、增加内聚力、通过赋予特定类型 1 单一职责的对象来分离关注点来改进（IMO）您的设计。如果您来自 .net 世界 PostSharp 使用自定义属性来编织建议。如果您来自 Java 世界，您可以使用名为[AspectJ](http://www.eclipse.org/aspectj/)的 Java 扩展。AOP 的应用程序比您通常看到的要多。

# winapi - 如何知道文件已完成复制

> ID：559659
> 
> 赞同：2
> 
> 时间：2009-02-18T02:46:45.333
> 
> 标签：winapi, readdirectorychangesw, file-copying

我正在使用 ReadDirectoryChangesW 来监视一个文件夹，如果我将一个大文件复制到该文件夹​​，我可以收到多个 FILE_ACTION_MODIFIED 消息，似乎每次 Windows 写入一大块文件时，你都会收到每个文件的修改通知时间。我尝试使用 CreateFile API 来检查文件是否可以被 AP 打开，但有时，某些文件总是被其他 AP 锁定，例如，如果您正在打开 Outlook，PST 会更新，但我的 AP 可以'不要访问它，我们必须启动 Shadow Copy 才能打开它。所以我的问题是，如何知道文件已完成复制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T03:02:20.367

这是一个非常hacky性质的解决方案，但在非常棘手的情况下，您可以运行轮询循环来检查文件的大小（或修改日期）。如果它有一段时间没有改变，您可以*放心*地假设该文件已完成复制。

**编辑：**这不是一般情况下的最佳解决方案，但考虑到在 OP 的情况下，问题约束排除了更好的解决方案。在考虑否决之前考虑一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-07T06:20:45.433

当您轮询文件的大小时，不要使用`_stat/_stat64`. 相反，每次需要时打开文件并调用`_filelengthi64`以获取文件的大小。`_stat64`Windows 操作系统不会实时更新返回的文件大小。此外，通过能够打开文件，您正在测试是否已完成任何长复制操作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-14T08:06:08.130

Windows 提供了一个 API 来监视目录内容更新。您可以使用 Created 事件来检测新文件，但请注意，此事件触发并不一定意味着文件已发布。

本机 C++ 规范和代码示例：

[http://msdn.microsoft.com/en-us/library/aa365261(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365261%28VS.85%29.aspx)

。网 ：

[http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

# python - Python 中的共享文件夹会话

> ID：559662
> 
> 赞同：1
> 
> 时间：2009-02-18T02:48:10.290
> 
> 标签：python, winapi, wmi, shared-directory

我正在尝试通过 WMI 获取 Python 中当前打开的会话列表。

**当您转到系统工具**->**共享文件夹**->**会话**（即用户名、计算机名称、连接时间等）时，我所追求的是计算机管理中显示的确切信息。

我知道（或至少相信）它与*Win32_ConnectionShare*有关......

如果它有所作为，我正在使用[Tim Golden 的 wmi 模块](http://timgolden.me.uk/python/wmi.html)。

当然，如果有另一种（非 WMI）方式来获取这些信息，那么这也是受欢迎的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T04:59:36.153

没关系——我找到了：

```
>>> import wmi
>>> c = wmi.WMI()
>>> for x in c.Win32_ConnectionShare():
        print "%s: %s" % (x.Dependent.Username, x.Dependent.ComputerName) 
```

# windows-vista - 关于Vista下UAC开启时ProgramData文件夹的权限

> ID：559670
> 
> 赞同：0
> 
> 时间：2009-02-18T02:53:35.253
> 
> 标签：windows-vista, uac, programdata

我在打开 UAC 的 Vista 上使用管理员登录，我可以在 ProgramData 文件夹中创建、修改或删除文件吗？我的测试结果是YES，但是我发现我的AP可以访问名为“MicroSoft”的文件夹，是否有任何标准文件可以知道ProgramData文件夹在Vista下的权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T02:59:32.073

应该没问题的，是的。Program Data 文件夹用于存放用于此目的的程序。

在权限方面，您应该能够使用 .NET 检查或修改文件权限。将`System.IO.DirectoryInfo`类视为参考，并查看`System.Management`和`System.Management.Instrumentation`命名空间以获取用户信息。

# java - 什么是 Swing 可用的数据绑定库？

> ID：559696
> 
> 赞同：9
> 
> 时间：2009-02-18T03:09:16.263
> 
> 标签：java, swing, data-binding

可以与组件进行双向 bean 同步的东西，以及更花哨（高级）的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T18:23:02.197

还有[JGoodies Binding](https://binding.dev.java.net/)项目。作者对此进行了相当详细的[介绍](http://www.jgoodies.com/articles/binding.pdf)。

如果我没记错的话，它可以使用 PropertyChangeListeners。我自己没有使用过它，但我工作场所的其他开发人员已经对它进行了试验，并获得了相当积极的印象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T16:55:25.620

嗯，对于初学者来说，有[Beans Binding](https://beansbinding.dev.java.net/)项目。[java.net](http://weblogs.java.net/pub/a/2008/03/20/synchronizing-properties-with-beans-binding.html)上有一个例子。如果您使用 NetBeans，则[内置](http://www.netbeans.org/kb/60/java/gui-binding.html)支持.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T14:10:49.300

你需要搭顺风车.....

[http://hitch.silvermindsoftware.com/](http://hitch.silvermindsoftware.com/)

# visual-c++ - RunDll32 Problem on Win2k with Visual C++ 2008 Express Compiled DLL

> ID：559698
> 
> 赞同：1
> 
> 时间：2009-02-18T03:11:53.743
> 
> 标签：visual-c++, dll, manifest, windows-server-2000

First off, I'm not a C++ programmer (but I am learning). I have finally managed to modify and compile some C++ source code using Visual C++ 2008 Express Edition. I've tried to get the same code compiled in the full version of Visual C++ 2003 without success (I get a wide variety of errors, but no luck).

The problem is that everything is working fine using RunDll32 to call the DLL on Windows Vista, but when I try the same rundll32 call on Windows 2000, I get the following error:

> "Error loading mysampledll.dll" "The specified module could not be found."

Of course, I've tried setting the full path, moving the file around, etc...but no luck. I guarantee that the file exists and has the correct permissions.

I thought perhaps that there is something wrong with the manifest that is getting compiled along with the DLL in Vista. So I removed it using a resource editor, but then I get the same error in Vista and Win2k. Here's the manifest:

```
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
        <requestedPrivileges>
            <requestedExecutionLevel level="requireAdministrator" uiAccess="false"></requestedExecutionLevel>
        </requestedPrivileges>
    </security>
    </trustInfo>
    <dependency>
        <dependentAssembly>
            <assemblyIdentity type="win32" name="Microsoft.VC90.DebugCRT" version="9.0.21022.8" processorArchitecture="x86" publicKeyToken="1fc8b3b9a1e18e3b"></assemblyIdentity>
        </dependentAssembly>
    </dependency>
    <dependency>
        <dependentAssembly>
            <assemblyIdentity type="win32" name="Microsoft.VC90.CRT" version="9.0.21022.8" processorArchitecture="x86" publicKeyToken="1fc8b3b9a1e18e3b"></assemblyIdentity>
    </dependentAssembly>
    </dependency>
</assembly> 
```

Now, I assume that the problem is with Win2k not having the Microsoft.VC90.CRT installed, but why does my DLL have this dependency? I've set the "Common Language Runtime Support" to "No Common Language Runtime Support" in the project properties, so why does it still require the CLR? Is there a way to change the manifest to use an older Visual C++ runtime that is available by default in Win2k? Sorry for my ignorance in these matters, and thanks in advance for any help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-08T12:20:11.017

请注意，如果您不想要求用户运行 CRT 安装程序，您也可以随应用程序重新分发 CRT DLL。您可以在 redist\x86 下的 VC 安装目录中找到它们（C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\x86\Microsoft.VC90.CRT 是我机器上的完整路径）。请注意，您必须复制该目录中的所有四个文件（三个 DLL 和一个清单）并将它们放在您的 EXE 旁边才能正常工作。

如果您正在做更复杂的事情，比如构建一个其他应用程序将加载的 DLL，这是不够的，但这对于大多数情况来说已经足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T03:35:04.720

Try installing the [Visual Studio 2008 Redistributable package](http://www.microsoft.com/downloads/details.aspx?FamilyID=9b2da534-3e03-4391-8a4d-074b9f2bc1bf&displaylang=en#Requirements).

It contains the C++ runtime DLL that your program needs.

Don't get confused. That is not the CLR. The CLR is for managed code, not native Intel executables. Even native executables need the Microsoft runtime library dll if you dynamically link them to the runtime. This is the default in project properties, C++, Code Generation, Runtime Library = Multi-Threaded DLL. You can avoid this by choosing Multi-threaded, which would statically link in the library code.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T03:38:33.227

I would say that on the Windows 2000 box your DLL won't load because it is missing a dependency.

You find out what is missing by downloading the **Depends** utility found here: [http://www.dependencywalker.com/](http://www.dependencywalker.com/)

If it is a MSCRT DLL that is mising then you will need to reditribute these DLL's with your DLL.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T03:42:21.020

The problem is that you are trying to run a DLL compiled with the debug C-Runtime (CRT) library linked in.

To fix the problem, link in the non debug CRT with your DLL:

Option 1: Build and distribute the release version. (This is what you should be doing anyway when it's time to release.) To do this:

*   List item
*   Build.Configuration Manager... and change your target flavor from Debug to Release; or
*   Build.Batch Build... and check of both Debug and Release; and
*   Use the binaries that come out of the Release directory.

Option 2: Build your debug binaries with the non-debug CRT. To do this:

*   List item
*   Project.Properties...
*   Navigate to C/C++, Code Generation
*   For Runtime Library, select Multithreaded DLL or Multithreaded.

I tend to go with option 2 for quick and dirty projects, where I want the speed of the retail CLR, but want all the debug info for my code.

(By the way, CLR != CRT, but that's a different discussion.)

# python - Django - 查询重复/低效

> ID：559701
> 
> 赞同：4
> 
> 时间：2009-02-18T03:12:29.483
> 
> 标签：python, django

好吧，我有一个 Django 视图，如下所示：

```
@render_to('home/main.html')
def login(request):
    # also tried Client.objects.select_related().all()
    clients = Client.objects.all()
    return {'clients':clients} 
```

我有一个模板`main.html`，像这样：

```
<ul>
{% for client in clients %}
<li>{{ client.full_name }}</li>
    <ul>
    {% for pet in client.pets.all %}
        <li>{{ pet.full_name }}</li>
    {% endfor %}
    </ul>
{% endfor %}
</ul> 
```

我还在[`sql_queries`](http://docs.djangoproject.com/en/dev/ref/templates/api/#django-core-context-processors-debug)我的基本模板底部打印出所有查询。当我运行此视图时，会进行以下查询：

```
SELECT `home_client`.`id`, ... FROM `home_client`;
SELECT `home_pet`.`id`, ... FROM `home_pet` WHERE `home_pet`.`client_id` = 1;
SELECT `home_client`.`id`, ... FROM `home_client` WHERE `home_client`.`id` = 1;
SELECT `home_client`.`id`, ... FROM `home_client` WHERE `home_client`.`id` = 1;
SELECT `home_pet`.`id`, ... FROM `home_pet` WHERE `home_pet`.`client_id` = 2;
SELECT `home_client`.`id`, ... FROM `home_client` WHERE `home_client`.`id` = 2; 
```

我的问题是，为什么要进行所有这些查询？不应该只是 1 个查询来检索所有客户端，每个客户端一个查询来检索每个客户端的所有宠物吗？我在`home_client`表中有 2 个客户，所以总共应该是 3 个查询。最令人不安的是查询 3 和 4 是 100% 相同的。我不想“过早优化”或其他任何事情，但我确实想确保 Django 不会非常低效。对此的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T03:18:27.270

Django 使用缓存。RDBMS 使用缓存。不要过早地优化查询。

您可以在视图函数中使用批量查询，而不是模板中的一次一次查询。

```
@render_to('home/main.html')
def login(request):
    # Query all clients 
    clients = Client.objects.all()
    # Assemble an in-memory table of pets
    pets = collections.defaultdict(list)
    for p in Pet.objects.all():
        pets[pet.client].append(p)
    # Create clients and pets tuples
    clientsPetTuples = [ (c,pets[c]) for c in clients ]
    return {'clientPets': clientsPetTuples} 
```

但是，您似乎没有任何证据表明您的模板是应用程序中最慢的部分。

此外，这权衡了巨大的内存使用与 SQL 的使用。在您有测量结果证明您的模板查询实际上很慢之前，您不应该过度考虑 SQL。

在你有证据之前不要担心 SQL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T03:20:39.167

尝试使用 Client.objects.all().select_related()

这也将自动在单个数据库查询中缓存相关模型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T10:40:17.770

客户 1 有 2 只宠物，客户 2 有 1 只宠物吗？

如果是这样，那将向我表明`Pet.full_name`您在宠物显示循环中所做的其他事情正在尝试访问其相关客户的详细信息。Django 的 ORM 不使用[身份映射](http://martinfowler.com/eaaCatalog/identityMap.html)，因此从任何 Pet 对象访问客户端外键都需要再次访问数据库以检索该客户端。

PS[`select_related`](http://docs.djangoproject.com/en/dev/ref/models/querysets/#id4)不会对您在这种情况下使用的数据产生任何影响，因为它只遵循外键关系，但宠物与客户的关系是多对一的。

**更新：**如果您想避免在`Pet.full_name`这种情况下更改逻辑或必须在模板中执行所述逻辑，您可以更改获取每个客户端宠物的句柄的方式，以便为每个客户端预填充 ForeignKey 缓存宠物及其客户：

```
class Client(models.Model):
    # ...
    def get_pets(self):
        for pet in self.pets.all():
            setattr(pet, '_client_cache', self)
            yield pet 
```

...其中`'client'`部分`'_client_cache'`是 Pet 类中用于 Pet 客户端的 ForeignKey 的任何属性名称。这利用了 Django 使用其`SingleRelatedObjectDescriptor`类实现对 ForeignKey 相关对象的访问的方式，该类在查询数据库之前查找此缓存属性。

产生的模板用法：

```
{% for pet in client.get_pets %}
...
{% endfor %} 
```

# java - 通用方法失败

> ID：559704
> 
> 赞同：1
> 
> 时间：2009-02-18T03:15:59.383
> 
> 标签：java, generics

我通过改编书中的一段来编写这个简单的测试代码，以帮助我理解 Java 中泛型方法的工作原理。我标记的行*应该*可以工作，为什么不呢？

```
import java.util.*;

class Test {
public static void main(String args[]){
    List<Number> input = null;
    List<Number> output=null;

    output = Test.process(input); // fail, why??

    } 
public static <E extends Number> List <? super E> process (List <E> nums){

    List <E>eList = new ArrayList<E>();
    return eList;
    }

} 
```

编辑：嗯，代码在更改`List<? super E>`为时有效`List<E>`，这很好，但我仍然不确定我是否遗漏了某些内容，或者我从中获取的书是否有错误。请阅读那里出现的问题：

16.  给定一个声明为的方法：

> 公共静态<E扩展数>列表<？超级 E > 进程（列出 nums）

程序员想像这样使用这种方法：

```
// INSERT DECLARATIONS HERE
    output = process(input); 
```

哪些声明对可以放置在 // INSERT DECLARATIONS HERE 以允许代码编译？（选择所有适用的。）

```
A. ArrayList<Integer> input = null;
   ArrayList<Integer> output = null;

B. ArrayList<Integer> input = null;
   List<Integer> output = null;

C. ArrayList<Integer> input = null;
   List<Number> output = null;

D. List<Number> input = null;
   ArrayList<Integer> output = null;

E. List<Number> input = null;
   List<Number> output = null;

F. List<Integer> input = null;
   List<Integer> output = null;

G. None of the above. 
```

答案：B、E、F 正确。process 的返回类型肯定声明为 a `List`，而不是 an `ArrayList`，所以 A 和 D 是错误的。C 是错误的，因为返回类型的计算结果为`List<Integer>`，并且不能分配给类型为 的变量`List<Number>`。当然，所有这些都可能会导致 a `NullPointerException`，因为变量仍然为空——但问题只要求我们让代码编译。

书中提到的所有选项都不适用于我的代码。我可以安全地将其标记为 Kathy Sierra 的错误还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T03:23:37.943

问题是您将方法的返回类型声明为

```
List<? super E>, i.e. List<? super Number> 
```

但将其分配给

```
List<Number> 
```

因此，您应该将其分配给

```
List<? super Number> 
```

或将返回类型声明为

```
List<E> i.e. List<Number> 
```

（冗长的格式，因为内联代码没有正确显示泛型。）

如果书中声称可以按照您描述的方式分配方法的返回值，那么这确实似乎是书中的错误。如果该方法返回一个 E 列表（如上），那将是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T03:20:16.767

尝试：

```
import java.util.*;

class Test {
public static void main(String args[]){
    List<Number> input = null;
    List<Number> output=null;

    output = Test.process(input); // fail, why??

    } 
public static <E extends Number> List <E> process (List <E> nums){

    List <E>eList = new ArrayList<E>();
    return eList;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T11:59:33.913

你的方法返回一个`List`. 我们不知道它是什么的列表*，*但它肯定是某个超类的列表`Number`。例如：也许它正在返回一个列表`Object`- 调用者不知道。但是，我们知道无论`List`返回哪种类型，都可以将 a`Number`放入其中。

您将其分配给`List of Number`. 这意味着无论何时打电话`output.get(n)`，你总会得到`Number`回报。

看到问题了吗？返回值`process()`不履行`output`必须遵守的合同。

# c# - 首次使用后，Windows 窗体工具提示不会重新出现

> ID：559707
> 
> 赞同：24
> 
> 时间：2009-02-18T03:16:20.847
> 
> 标签：c#, .net, winforms, tooltip

我有一个 Windows 窗体 C# 应用程序，我想在其中一个文本框上使用工具提示。我在 Form 类的构造函数中初始化了工具提示，它第一次工作。因此，当我用鼠标将鼠标悬停在文本框上时它可以工作，但是一旦工具提示超时并且它消失了，当我将鼠标移开并回到控件上时它不会重新出现。我希望它会回来。我究竟做错了什么？

这是我初始化工具提示的方式：

```
myTip = new ToolTip();
myTip.ToolTipIcon = ToolTipIcon.Info;
myTip.IsBalloon = true;
myTip.ShowAlways = true;

myTip.SetToolTip(txtMyTextBox,"My Tooltip Text"); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-07T17:48:23.687

我今天遇到了类似的问题。有时，工具提示不会显示。我的表单中的所有控件都有一个 ToolTip 控件。

我在所有自动添加的控件上也有一个 MouseEnter 事件，所以我修改了 MouseEnter 事件：

```
_tooltip.Active = false;
_tooltip.Active = true; 
```

它修复了错误，但我不知道为什么。

此外，该错误总是发生在 Windows XP 机器上，但不会发生在 Windows Vista 上。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-07-06T10:10:09.393

我想你会很高兴知道微软知道这件事……大约 5 年了……

*   2/21/2005 错误确认为可重现
*   3/29/2005 嗯，我们可能会修复它，但稍后......
*   2005 年 11 月 15 日其实这不是一个大错误，也不会发生太多，所以我们不会修复它。

该死的，当我偶然发现微软不想解决的错误时，我喜欢它！这一次叫*绝境*，上一次实在是*太难解决了*……

[http://connect.microsoft.com/VisualStudio/feedback/details/115385/tooltip-stop-showing-after-autopopdelay](http://connect.microsoft.com/VisualStudio/feedback/details/115385/tooltip-stop-showing-after-autopopdelay)

我要告诉我的客户，我的程序中的错误只是极端情况，很难解决......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-03-15T07:49:34.500

我今天遇到了类似的问题。VS 2010 SP1 .Net 3.5
在 AutoPopDelay-Time 之后 ToolTip 不显示 Controls `ToolTipText`。
凯文斯解决方案是解决问题的唯一方法。

我将它封装在我自己的 ToolTip 类中：

```
public class ToolTip : System.Windows.Forms.ToolTip 
{
    public ToolTip() : base() { }

    public ToolTip(System.ComponentModel.IContainer components) : base(components) { }

    public new void SetToolTip(System.Windows.Forms.Control ctl, string caption) 
    {
        ctl.MouseEnter -= new System.EventHandler(toolTip_MouseEnter);
        base.SetToolTip(ctl, caption);
        if(caption != string.Empty)
        ctl.MouseEnter += new System.EventHandler(toolTip_MouseEnter);
    }

    private void toolTip_MouseEnter(object sender, EventArgs e) 
    {
        this.Active = false;
        this.Active = true;
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-18T03:21:19.183

我在 VB.NET 中遇到了这个问题。我所做的是在窗体上放置一个 TooTip 控件，然后在目标控件的 MouseHover 事件上，设置 ToolTip 的属性。我这样做是因为我将一个 ToolTip 控件用于五个不同的 Label 控件。效果很好。（真的，我希望 ToolTip 立即显示，所以我使用了 MouseEnter 事件。）我可以在明天上班时发布我的确切代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-09T22:38:31.853

对于它的价值，我在我的 Windows XP 系统上遇到了这个问题，直到我注意到如果我手动（从工具箱）在我的表单上放置了至少一个工具提示控件，我可以在我的代码中根据需要创建尽可能多的工具提示，并且他们都会工作的。

但是，如果我尝试在代码中创建所有工具提示（例如在 formload 事件中），则提示只会显示一次，并且再也不会出现。我不能给你确切的“为什么会这样”的故事，但我已经多次重复这个问题，效果都是一样的。它可能与对象范围有关，但我不确定。

所以现在作为一种习惯，我总是至少包含一个 Visual Studio 工具提示控件，然后在我的代码中包含其余部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-31T09:46:05.417

我通过这个解决了这个问题

```
if (t == null)
{
    t = new ToolTip();
}
t.IsBalloon = true;
t.ToolTipTitle = "Stop";
t.ToolTipIcon = ToolTipIcon.Error;
t.Show("", yourControlonWhichToApplyToolTip, 0);

t.Show("PDescription", yourControlonWhichToApplyToolTip, 1000); 
```

注意我添加了一个空的工具提示。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-08-01T07:02:58.520

我刚刚在 Windows 7 上遇到了问题，所以我找到了这个线程。

就我而言，这在 tooltip_MouseEnter 中不起作用：

```
tooltip.Active = false;
tooltip.Active = true; 
```

所以我尝试了以下方法：

```
this.toolTip.SetToolTip(this.txtbx1, "tooltip-text"); 
```

这对我来说很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-14T12:16:50.273

就我而言，在使用该方法设置工具提示文本后`SetToolTip`，我使用了`Show`带参数的重载`duration`，即

```
toolTip.Show(text, textEdit, 1000); 
```

在鼠标悬停后该工具提示没有重新出现，并且重置`tooltip.Active`不起作用..

对我有用的一种解决方法是在`Show`没有持续时间的情况下使用重载，然后手动隐藏它：

```
toolTip.Show(text, textEdit);
new Task(() =>
{
    Thread.Sleep(750);
    textEdit.Invoke(new Action(() => toolTip.Hide(textEdit)));
}).Start(); 
```

使用此代码，我有所需的行为，即

1.  工具提示会立即显示 750 毫秒。工具提示文本更改后
2.  当鼠标悬停在控件上时，工具提示确实会出现指定时间

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-30T09:13:40.303

```
System.Windows.Forms.ToolTip ToolTip1 = new System.Windows.Forms.ToolTip();

private void textBox_MouseHover(object sender, EventArgs e)
{
    ToolTip1.Show("YOUR TEXT", textBox);
}

private void textBox_MouseLeave(object sender, EventArgs e)
{
    ToolTip1.Active = false;
    ToolTip1.Active = true;
} 
```

# c# - 来自 C# 的 Windows 模拟

> ID：559719
> 
> 赞同：33
> 
> 时间：2009-02-18T03:24:11.500
> 
> 标签：c#, windows, impersonation

作为 LocalSystem 运行的 C# 程序如何临时冒充另一个用户的登录身份？粗略地说，我有一个 Windows 服务，我想作为 LocalSystem 运行，但有时会模拟用户 XYZ（使用 Windows 集成安全性连接到数据库时）。

最重要的是：有没有办法在不知道其他用户密码的情况下做到这一点？

注意：如果密码是强制性的，是否有安全存储密码的推荐策略（c# 和/或 vbscript）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-22T09:36:20.403

这是可能的，虽然它需要你做很多代码。请参阅[NtCreateToken](http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Token/NtCreateToken.html)和[CreateToken](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374780(v=vs.85).aspx)。您需要 SeCreateTokenPrivilege，尽管这不会成为问题，因为您是在 NT AUTHORITY\SYSTEM 下运行的。然后，您可以使用创建的令牌在线程内进行模拟。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-18T03:38:57.860

简短的回答：你不能没有用户密码或用户通过 COM 调用你的服务。

要在您的流程中冒充另一个用户，您必须调用[`ImpersonateLoggedOnUser`](http://msdn.microsoft.com/en-us/library/aa378612.aspx). `ImpersonateLoggedOnUser`需要令牌句柄。有几种方法可以获得令牌句柄：

*   通过使用 以用户身份登录[`LogonUser`](http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx)。但是，这需要您知道用户密码。
*   [`CreateRestrictedToken`](http://msdn.microsoft.com/en-us/library/aa446583(VS.85).aspx)通过使用、[`DuplicateToken`](http://msdn.microsoft.com/en-us/library/aa446616(VS.85).aspx)或复制现有标记[`DuplicateTokenEx`](http://msdn.microsoft.com/en-us/library/aa446617(VS.85).aspx)。
*   通过从另一个已经以用户身份登录的进程或线程打开令牌，使用[`OpenProcessToken`](http://msdn.microsoft.com/en-us/library/aa379295(VS.85).aspx)或[`OpenThreadToken`](http://msdn.microsoft.com/en-us/library/aa379296(VS.85).aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-18T03:33:02.790

对于密码存储部分，您可能想看看最近提出的[这个问题。](https://stackoverflow.com/questions/555222/how-to-not-hardcode-passwords)

这是我的回答：

您可以/应该使用[DPAPI](http://msdn.microsoft.com/en-us/library/ms995355.aspx)，即提供存储加密的[数据保护 API 。](http://en.wikipedia.org/wiki/Data_protection_API)
它只是针对这种类型的问题。

存储的加密基于：

*   用户帐户，因此只有登录用户才能访问数据。这使得数据可以使用完全相同的用户凭据传输到另一台 PC。
*   机器，使数据只能在该特定机器设置上访问，而不能传输到另一台 PC。

有一个[与 Karl Franklin 合作的 dnrTV 节目，](http://www.dnrtv.com/default.aspx?showNum=79)准确地展示了实现此功能和其他加密功能所需的内容。
该节目的源代码也可在页面上找到。

当然，还有很多关于这个主题的[其他文章。](http://www.codeproject.com/info/search.aspx?artkw=DPAPI&sbo=kw)

# openid - 有限使用 OpenID

> ID：559726
> 
> 赞同：2
> 
> 时间：2009-02-18T03:29:18.507
> 
> 标签：openid, dotnetopenauth

我希望将 OpenID 实现为一组合作伙伴网站的提供者。问题是这个网站是为孩子（13 岁以下）准备的，所以我有需要处理的业务限制 - 主要是该帐户**不能**在任何非合作伙伴网站上使用（我们与每个批准的合作伙伴合作，以确保他们满足行业隐私/安全法规）。

过去我们推出了自己的会员和合作伙伴系统，但我想转向行业认可的引擎，让我们自己和我们的合作伙伴的生活更轻松。

那么，是否有一种内置方法可以限制 OpenID 仅访问某些站点，或者我是否需要对代码和权限进行一些深入的代码更改才能完成此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T04:39:54.407

是的，一点没错。根据您的 dotnetopenid 标签，我认为这就是您正在使用的库，这很棒。进来的 IAuthenticationRequest 上有一个 Realm 属性。使用它来检查领域值是否出现在合作伙伴网站领域 URL 的白名单中。如果是，请继续执行正常的身份验证步骤并将 IAuthenticationRequest.IsAuthenticated 设置为 true 并返回。如果 Realm 未被识别，那么这个小于 13 岁的孩子正在尝试使用他们的 OpenID 登录到非合作伙伴站点，您可以设置 IsAuthenticated = false 并返回，这将中止他们的登录。

如果您对您的特定场景还有其他问题，请随时发送电子邮件至 dotnetopenid@googlegroups.com

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T04:04:07.270

这一切都取决于。
这在 OpenID 协议中是可能的 - 如果您的库支持它只是一个问题。在文档和配置文件中查找对站点登录权限的限制。
如果您只是自己编程，这相当容易 - 当您登录 OpenID 时，它会重定向到您的网站，看看您是否让用户登录。通常您会询问用户，但在您的情况下，您可以查看白名单以查看它是否被批准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T03:36:20.783

我自己还没有实现 OpenId，所以对此持保留态度。

当我为我的 OpenId 登录 yahoo 时，它会询问我是否真的希望他们向 stackoverflow.com 提供我的身份。此时，提供商（例如 yahoo，您）应该很容易查找目标站点并查看它是否是经过批准的合作伙伴，如果不是，则停止该过程。

# progress-4gl - ROWID and RECID

> ID：559730
> 
> 赞同：4
> 
> 时间：2009-02-18T03:32:45.800
> 
> 标签：progress-4gl

what is ROWID and RECID actually in progress.Can we use the RECID instead of ROWID.what is the diffrrence between them??

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T23:47:40.780

[RECID](http://documentation.progress.com/output/OpenEdge102a/oe102ahtml/wwhelp/wwhimpl/common/html/wwhelp.htm?context=dvref&file=dvref-15-48.html)和[ROWID](http://documentation.progress.com/output/OpenEdge102a/oe102ahtml/wwhelp/wwhimpl/common/html/wwhelp.htm?context=dvref&file=dvref-15-66.html)都是指向数据库中特定记录的唯一指针。

两者或多或少都是指向数据库本身的物理指针，除了在底层平台上没有等效项的非 OpenEdge 表。在这些情况下，它可能由构成主键的值组成。

RECID 是一直到 10.1A 的 32 位整数，当数据库是 OpenEdge 数据库并且只有一个区域时很好。从 10.1B 开始，它们被升级为 64 位整数。

在 v6 中添加了容量以连接到非 OpenEdge 数据库，并在 v8 中添加了创建多个存储区域的 OpenEdge 数据库。那时，RECID 不足以在所有情况下唯一地处理表中的所有记录。

于是ROWID结构就诞生了。它的实际架构取决于底层数据库的类型，但它不受整数的限制。

文档非常清楚地指出[，RECIDs 不应该被使用](http://documentation.progress.com/output/OpenEdge102a/oe102ahtml/wwhelp/wwhimpl/common/html/wwhelp.htm?context=dvref&file=dvref-15-48.html)，除了操作 OpenEdge 数据库元模式的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T16:10:33.707

RECID 已被弃用，现在有几个版本。ROWID 是它的替代品。我知道它实际返回的是包含您的记录的 DB 块的物理地址。从记忆中，当他们想要支持来自 4GL 的不同数据库引擎（Oracle / SQL server 等）时，他们引入了 ROWID，这意味着 ROWID 中的内容比 RECID 更多。

我会远离 RECID，你可能会在短期内侥幸逃脱，但你给自己带来了一个你可以完全避免的潜在问题。

# c# - LINQ to Entities 搜索多个关键字的文本属性

> ID：559735
> 
> 赞同：7
> 
> 时间：2009-02-18T03:35:22.033
> 
> 标签：c#, search, linq-to-entities

对于我正在做的网站，我们正在使用 LINQ to Entities。我负责向网站添加搜索功能。我试图找出在数据库中的单个字段上搜索多个关键字（用户输入）的最优雅的方法。请允许我举个例子。

表列：

```
Name, Description 
```

示例行：

```
"Cookie monster", "Fluffy, likes cookies and blue" 
```

用户搜索（分隔符无关紧要）：

```
"blue fluffy" 
```

目前我正在使用以下内容：

```
 public List<SesameCharacters> SearchByKeywords(string keywords)
    {
        List<SesameCharacters> output = new List<SesameCharacters>();
        string[] k = keywords.ToLower().Split(' ');
        using (SesameStreet_Entities entities = new SesameStreet_Entities())
        {
            IQueryable<SesameCharacters> filter = entities.SesameCharacters;

            foreach (string keyword in k)
                filter = ForceFilter(filter, keyword);

            output = filter.ToList();
        }
        return output;
    }

    private IQueryable<SesameCharacters> ForceFilter(IQueryable<SesameCharacters> filter, string keyword)
    {
        return filter.Where(p => p.Description.ToLower().Contains(keyword));
    } 
```

这目前按预期工作，但我认为这不是解决问题的最佳方法。我错过了一些明显的东西吗？

*注意：*这是`AND`匹配的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-07-08T09:14:14.643

我发现这对我有用 - 这是使用 VB.Net 和 Entity Framework 4.0，但我确信原理可以转化。

这个执行“OR”样式查询：

```
 Function Search(ByVal query As String) As IQueryable(Of Product)
    Dim queryWords As String() = query.Split()
    Dim entities As New Entities()

    Return entities.Products.Where(Function(p) queryWords.Any(Function(w) p.Description.Contains(w)))
End Function 
```

而这个做“AND”风格的查询：

```
Function Search(ByVal query As String) As IQueryable(Of product)
    Dim queryWords As String() = query.Split()
    Dim entities As New Entities()

    Return entities.Products.Where(Function(p) queryWords.All(Function(w) p.Description.Contains(w)))
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T05:09:35.553

看起来 Linq to Entities 不支持包含：

[http://msdn.microsoft.com/en-us/library/bb738638.aspx](http://msdn.microsoft.com/en-us/library/bb738638.aspx)

我会为此提出自己的查询。如果您发现这些类型的搜索成为性能问题，您可能希望完全控制文本搜索查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T22:19:20.947

如何代替：

```
IQueryable<SesameCharacters> filter = entities.SesameCharacters;

        foreach (string keyword in k)
            filter = ForceFilter(filter, keyword);

        output = filter.ToList(); 
```

做：

```
return (from c in entities.SesameCharacters
         where k.Contains(c..Description.ToLower())
         select c
         ).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T05:19:10.710

与 LINQ 无关，但您可以考虑使用 SQL Server[全文搜索](http://msdn.microsoft.com/en-us/library/ms142547.aspx)，而[CONTAINS](http://msdn.microsoft.com/en-us/library/ms187787.aspx)谓词理解布尔运算符 — AND、OR 和 AND NOT。

这篇文章也很有用：[动态组合表达式谓词](http://www.albahari.com/nutshell/predicatebuilder.aspx)

# performance - What are the complicated data structures you should have heard of?

> ID：559748
> 
> 赞同：16
> 
> 时间：2009-02-18T03:38:58.360
> 
> 标签：performance, algorithm, data-structures

This is a derivative question, but I'm inquiring as to the data structures that you should at least be familiar with for their usefulness. These structures are too hard to implement without some expertise however.

I would say a good boundary between the two is a heap -- you should be able to code a heap, but it would take you a day. Not appropriate for this would be a BST, etc. Edit: I see the point that it depends on what you are doing. I think it would be awesome to have a list with a phrase summarizing why you use it!

Here's a list to start:

1.  B+ trees: good general indexing structure on a single key
2.  K-d tree: spatial data
3.  Red-black tree: self-balancing BST; also AVL or splay tree
4.  Skip list: good hybrid structure for either random or (pseudo)sequential access
5.  Trie: linear time string search

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T04:30:14.227

[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filters)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T03:58:55.533

关于什么：

*   [二项式堆](http://en.wikipedia.org/wiki/Binomial_heap)
*   [斐波那契堆](http://en.wikipedia.org/wiki/Fibonacci_heap)
*   [不相交集数据结构](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)
*   [张开树](http://en.wikipedia.org/wiki/Splay_tree)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-03T12:57:03.677

[手指树](http://en.wikipedia.org/wiki/Finger_tree)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T11:45:58.440

[范埃德博亚斯树](http://en.wikipedia.org/wiki/Van_Emde_Boas_tree)。我并不认为你“应该”听说过它们，但我相信它们是一个有趣的例子，说明你可以通过“位技巧”实现什么样的复杂性——即 O(log log n)，比二叉树好很多倍！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T03:49:33.357

That is a good start; there is a comprehensive list of data structures on [wikipedia](http://en.wikipedia.org/wiki/List_of_data_structures), some of them should be examined. But as to which *ones* you need, that depends on the area you intend to... do whatever it is that you are doing.

Embedded systems guys will have very different ideas from web guys who will strongly disagree with the business logic guys. Figure out what you want to do; languages and platform will also effect the list you need.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-18T04:19:29.603

引用[马丁凯的](http://www.stanford.edu/~mjkay/)话：

> [后缀树](http://en.wikipedia.org/wiki/Suffix_tree)构成了一个很好理解、非常优雅但令人遗憾的是，它的数据结构很少被欣赏，具有潜在的许多应用程序（...）

另请参阅：[什么是鲜为人知但很酷的数据结构？](https://stackoverflow.com/questions/500607/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T11:05:03.933

[R-树](http://en.wikipedia.org/wiki/R-tree)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-18T11:11:15.603

与您提到的 B+ 树密切相关：[B*-tree](http://en.wikipedia.org/wiki/B*-tree)。连同称为“跳舞树”方法的平衡方法一起，这些方法构成了 Reiser4 的基础。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-18T11:14:28.967

[二元决策图](http://en.wikipedia.org/wiki/Binary_decision_diagram)，特别是降阶二元决策图 (ROBDD)。当有人决定创建自己的过滤系统时，这些会被重新发明（很差）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-18T11:51:37.147

[Cuckoo hashing](http://en.wikipedia.org/wiki/Cuckoo_hashing)，一种在预期的恒定时间内解决哈希表冲突的简单而优雅的方法。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-18T11:57:02.907

[确定性有限自动机](http://en.wikipedia.org/wiki/Deterministic_finite-state_machine)(DFA) 或[有限状态机](http://en.wikipedia.org/wiki/Finite_state_machine)，可用于表达许多事物，例如基本词法分析器、正则表达式、状态转换*等*。另请参阅相关的有[向无环词图](http://en.wikipedia.org/wiki/Directed_acyclic_graph)，这对于紧凑地存储字典很有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-18T04:14:14.860

我会将[哈希表](http://en.wikipedia.org/wiki/Hash_table)添加到列表中。它们在概念上非常简单，但是一旦您了解如何实现良好的散列函数和有效的探测方法，它们就会变得复杂。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-01-16T08:18:58.803

[R-Tree](http://en.wikipedia.org/wiki/R-tree)及其变体，例如[R*-Tree](http://en.wikipedia.org/wiki/R%2a_tree)、[X-Tree](http://en.wikipedia.org/wiki/X-tree)、 Pyramid-Tree。各种 M-Tree 变体，例如 Slim-Tree。

通常，查询树很容易。也可能有一个简单的批量加载（对于 R-Trees，STR 通常做得很好）。棘手的部分通常是跨更新维护一棵好树。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-07-12T09:13:11.453

你可以试试：

*   y-fast 树
*   近似有序集
*   选择堆
*   紧凑阵列
*   单片列表
*   简洁列表

# internet-explorer - IE 查找因隐藏文本区域而失败

> ID：559749
> 
> 赞同：2
> 
> 时间：2009-02-18T03:39:30.747
> 
> 标签：internet-explorer, find

在 IE（6 或 7）中将以下 HTML 片段作为 HTML 文档打开。Ctrl+F 并寻找“测试”。IE 永远不会找到恰好位于隐藏文本区域中的搜索词“test”。

```
<html> 
<body> 
    <table> 
        <tr> 
            <td style="display:none;"> 
                <textarea >test</textarea>  -- first hidden 'test' is here
            </td> 
        </tr> 
    </table> 
    test  -- Second 'test' is here
</body> 
</html> 
```

我在这里错过了一些微不足道的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T04:14:00.943

必须同意 apphacker 质疑需求。IE 的行为听起来是对的——即使浏览器“可找到”，它也无法显示结果，为什么你会期望浏览器返回结果？

我会重新评估你正在做的 UI - 看看你需要的结果而不是这个特定的实现。一些 JavaScript 可能会派上用场。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T04:36:40.547

钱德拉 - 好虫子！你是对的，IE 应该可以毫无问题地找到其他可见的“测试”值，但不能。

我注意到在 IE7 中，如果您向后搜索（例如，Previous），它确实会找到它们。

附录：IE8 的内联搜索显示他们现在已经修复了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T03:41:53.703

尝试隐藏可见性或使用绝对定位和/或将 textarea 从身体的一部分移除并替换到另一个元素以隐藏 textarea。但是我不得不问，如果设置为 display:none，为什么你会想要找到一些东西。

# javascript - single quotes versus double quotes in js

> ID：559752
> 
> 赞同：3
> 
> 时间：2009-02-18T03:40:42.427
> 
> 标签：javascript

> **Possible Duplicate:**
> [When to Use Double or Single Quotes in JavaScript](https://stackoverflow.com/questions/242813/when-to-use-double-or-single-quotes-in-javascript)

Are there any differences between single and double quotes in javascript?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T03:43:37.770

No, is the right answer most of the time. However if you want to write valid JSON, then you should use double quotes for object literals.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T03:46:48.933

No, **except** in double quotes you can put single quotes.

e.g. "Don't not do this"

And in single quotes you can put double quotes.

e.g. 'John said "Do this"'

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T03:44:39.017

One is slightly wider, so you may have a few extra characters disappear to the right (as opposed to the slimmer version) in your favourite IDE.

Seriously though, I always use ', because if I need to quote a HTML element attribute, I always use " and I can't be bothered escaping like so

```
var html = "<a href=\"http://www.example.com\">hello</a>" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-18T03:49:03.360

No difference. Just make sure you close the string with whatever you open it with.

Much more sensible to me than other languages (looking at you, C# and PHP...) where single quoted strings are either character literals, or don't expand escaped characters.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-12T09:29:06.427

您通常会使用 " 除非在您无法逃脱的位置。（它对大多数开发人员来说更整洁，不要问为什么）
在`"$myVar"`php 中也将允许字符串具有变量值。（我知道它不是javascript，但另一个例子..在bash中，

```
 echo "What is your name?\nMy name is $(whoami)." 
```

将运行函数/命令 whoami。

```
<button onclick="dosomething(\"test\")">Test</button> Won't work 
<button onclick="dosomething("test")">Test</button> Won't work 
<section id='"Where-As">
    <button onclick="dosomething('test')">Test</button>
    <!-- will work -->
</section> 
```

PS：有效的 JSON 对象应该使用双引号。

### 不同报价的其他乐趣：

```
console.log('\n\n\n\n');  // Will give you \n\n\n\n as a string.
console.log("\n\n\n\n"); // Will give lines. 
```

# iphone - Interface Builder 与 iPhone 上显示的内容

> ID：559756
> 
> 赞同：0
> 
> 时间：2009-02-18T03:43:32.827
> 
> 标签：iphone, cocoa, cocoa-touch, interface-builder

您好，感谢您提出这个问题。

似乎我拖放到 IB 中的 PNG 文件的显示方式与它们在 iPhone 模拟器中的显示方式不同。是什么赋予了？例如，如果我想放入带圆角的 PNG，IB 会显示硬矩形角，但是当我构建到模拟器时，我会看到圆角。

如果我不能准确反映该视图将显示的内容，我不理解 IB 用于 UI 的目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T05:24:07.733

您能否验证 PNG 文件以 72dpi 的像素密度保存？另外，您使用的是什么类型的 UI 元素？（UIButton、UIImageView 等）。如果您可以发布示例图像会有所帮助。

# sql - Oracle 数据库 10g 查看性能

> ID：559759
> 
> 赞同：0
> 
> 时间：2009-02-18T03:44:16.490
> 
> 标签：sql, oracle, plsql, oracle10g, views

我在我的一个 Oracle 数据库中有一个视图，该视图执行时间太长。当语句运行时，它似乎并没有停止。

无论如何我们可以验证这个视图的性能，或者我们如何检查语句会话是否“挂起”？

谢谢， N2EE

# 更新

我意识到问题出在视图中的基础查询上。感谢 Edwin 的自动跟踪修复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T05:48:04.587

您的查询的执行很可能很慢。

您可以使用解释计划查看查询如何在数据库中执行。

如果您有 SQL*Plus，您可以使用以下语句轻松完成此操作：

```
set autotrace traceonly 
```

然后输入查询，您将获得查询的统计信息，如下所示：

```
SQL> set autotrace traceonly
SQL>  select * from o_drops;

4461 rows selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 3820245448

-----------------------------------------------------------------------------
| Id  | Operation         | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
-----------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |         |  4287 |   280K|    11  (10)| 00:00:01 |
|   1 |  TABLE ACCESS FULL| O_DROPS |  4287 |   280K|    11  (10)| 00:00:01 |
-----------------------------------------------------------------------------

Statistics
----------------------------------------------------------
          1  recursive calls
          0  db block gets
        333  consistent gets
         48  physical reads
          0  redo size
     337057  bytes sent via SQL*Net to client
       2316  bytes received via SQL*Net from client
        299  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
       4461  rows processed 
```

如果其中一项资源非常高，则可以重写查询和/或向您正在使用的表添加索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T04:26:35.547

您需要查看构成视图的查询的性能。最好的方法是对视图使用的 sql 语句做一个解释计划。这将表明它是否进行全表扫描或其他一些不太理想的行为。调整查询，您的视图应该运行得更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T05:14:16.493

您是在谈论创建或替换现有视图（即执行 CREATE OR REPLACE VIEW... 语句）还是从视图中进行选择。

在前一种情况下，可能是某个会话将其锁定。例如，如果有人通过视图进行更新或删除，您将无法替换它。根据您的版本，您可以通过检查 v$session 的“BLOCKING_SESSION”列来查看拦截器。

在后一种情况下，慢的不是视图，而是查询。观点几乎无关紧要。检查解释计划（最好使用带有来自 v$sql 的 sql_id 的 DBMS_XPLAN.DISPLAY_CURSOR），看看它在做什么。v$session_longops 可能会给出一个指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T08:59:19.447

假设问题是底层查询，性能问题可能是因为使用的表尚未分析。
您可以使用[DBMS_STATS](http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#PFGRF30102)包来更新 Oracle 的有关表的信息，然后查看查询速度是否有所提高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-28T09:39:47.777

根据快照 ID 生成 AWR 报告

有两个 sql 脚本来创建 AWR 报告。1\. awrrpt.sql 如果我们只有一个 Oracle 数据库，则运行 awrrpt.sql sql 脚本。

2.  awrrpti.sql If we have more than One Oracle Instance (Like RAC) then run awrrpti.sql script so that we can particular instance for awr report creation.

Location of AWR report sql script $ORACLE_HOME/rdbms/admin

# c++ - 如何在 C++ 中解析字符串

> ID：559762
> 
> 赞同：2
> 
> 时间：2009-02-18T03:46:24.003
> 
> 标签：c++, lexical-analysis, parser-generator

我想解析字符串，以便检查它们是否具有指定的语法。

例子：

```
Str = Z344-R565l t 
```

这里我的要求是在后面`Z`应该有一个数字，然后是 a`-`和之后`R`应该有一个数字，然后是`l`，然后是一个空格，然后是 finally `t`。

如果除此之外有任何其他内容，它应该是一个错误。

我必须像这样解析许多不同类型的语法。如果为每种所需的语法类型编写一个函数，我会很尴尬。听说yacc或者lex可以解决这个问题。

任何人都可以对我的问题有所了解吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T04:02:52.467

您使用正则表达式执行此操作。

Z344-R565l t

你的正则表达式应该是这样的。不确定用于 c++ 的正则表达式库，但这是确保字符串匹配的通用正则表达式。

```
Z[0-9]+-R[0-9]+l t 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-18T05:08:08.207

使用 boost::regex

```
#include <string>
#include <boost/regex.hpp>

bool isMatch(std::string input){
    boost::regex r("Z[0-9]*-R[0-9]*l t");
    return boost::regex_search(input, r);
} 
```

您可以做的另一件事是在文件中提供一个正则表达式列表，每行一个表达式。使用文件输入创建 boost::regex 对象的向量，并遍历需要验证的每个字符串的模式向量。它不是很有效，但它会起作用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-18T06:00:54.073

如果您只想检查语法，则 Boost::Regex 很好。如果您想在阅读这样的表达式时实际做某事，我建议您将 Boost::Spirit 与以下内容一起使用：

```
rule<> testFormula = 
    (ch_p('Z') >> int_p) 
    >> (ch_p('-')>>ch_p('R')>>int_p>>ch_p('l')) 
    >> space_p >> ch_p('t'); 
```

我已经隔离了您可能想要连接到某些操作的表达式部分（使用 [] 运算符）。

有关更多信息，请参阅[文档](http://www.boost.org/doc/libs/1_38_0/libs/spirit/classic/doc/quick_start.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T03:51:01.047

你可能会谷歌“ `runtime parser generation`”或类似的东西......

`lex`and `yacc`（或它们的 GNU 等价物`flex`and `bison`）在编译时完成它们的工作，并且可能不够灵活以满足您的需求。（或者他们可能，你不是很具体）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-22T13:10:27.690

如果您有最新的编译器（VC 2008 SP1 等），则无需使用 boost，正则表达式是 TR1 的一部分，您可以将它们与以下标头一起使用：`#include <regex>`

日期示例（[您应该使用 double`\`作为转义字符](http://www.johndcook.com/cpp_regex.html)）：

```
string dateorder = "12/07/2009";

tr1::regex expr("^([1-2][0-9]|0?[1-9]|30|31)/([1-9]|10|11|12)/(2\\\d{3})$");

if (!regex_match(dateorder.begin(),dateorder.end(),expr))
{
    ...
    break;  
} 
```

# context-free-grammar - 正则文法与上下文无关文法

> ID：559763
> 
> 赞同：111
> 
> 时间：2009-02-18T03:46:40.603
> 
> 标签：context-free-grammar, regular-language, automata

我正在为我的*计算语言*测试而学习，并且有一个想法是我遇到了问题。

我明白*常规语法*更简单，不能包含歧义，但不能完成编程语言所需的大量任务。我还理解*上下文无关语法*允许歧义，但允许一些编程语言所必需的东西（如回文）。

我遇到的问题是通过知道*常规语法非终结符*可以映射到终结符或非终结符后跟终结符或上下文无关的非终结符映射到终结符和非终结符的任何组合来了解我如何推导出上述所有内容.

有人可以帮我把所有这些放在一起吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-02-18T05:35:47.783

常规语法是右线性或左线性，而上下文无关语法基本上是终结符和非终结符的任意组合。因此，您可以看到常规语法是上下文无关语法的子集。

因此，例如，回文的形式是，

```
S->ABA
A->something
B->something 
```

您可以清楚地看到回文不能用常规语法表示，因为它需要是右线性或左线性，因此两边都不能有非终结符。

由于正则文法是无歧义的，因此对于给定的非终结符只有一个产生式规则，而在上下文无关文法的情况下可以有多个。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-02-18T05:36:43.147

我认为您要考虑的是各种抽水引理。正则语言可以被有限自动机识别。上下文无关语言需要一个栈，上下文相关语言需要两个栈（相当于说它需要一个完整的图灵机。）

因此，如果我们考虑[常规语言的抽引引理](http://en.wikipedia.org/wiki/Pumping_lemma_for_regular_languages)，它本质上是说，任何常规语言都可以分解为三部分，*x*、*y*和*z*，其中语言的所有实例都在*xy*z*（其中 * 是 Kleene 重复，即*y*的 0 个或多个副本。）您基本上有一个可以扩展的“非终结符”。

现在，上下文无关语言呢？[对于上下文无关语言](http://en.wikipedia.org/wiki/Pumping_lemma_for_context-free_languages)，有一个类似的抽水引理，它将语言中的字符串分成五个部分，*uvxyz*，并且语言的所有实例都在*uv ^i xy ^i z*中，因为 i ≥ 0。现在，你有*两个*“非终结符” “*只要你有相同的号码*，就可以复制或抽水。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-05-13T19:29:42.230

**正则文法和上下文无关文法的区别：** (N, Σ, P, S)：终结符、非终结符、产生式、起始状态终结符

● 由形式文法定义的语言的基本符号

● 美国广播公司

非终结符号（或句法变量）

● 根据生产规则替换成组的端子符号

● ABC

**正则文法：右或左正则文法 右正则文法，所有规则服从形式**

1.  B → a 其中 B 是 N 中的非终结符，a 是 Σ 中的终结符
2.  B → aC 其中 B 和 C 在 N 中，a 在 Σ 中
3.  B → ε 其中B在N中，ε表示空字符串，即长度为0的字符串

**左正则文法，所有规则服从形式**

1.  A → a 其中 A 是 N 中的非终结符，a 是 Σ 中的终结符
2.  A → Ba 其中 A 和 B 在 N 中，a 在 Σ 中
3.  A → ε 其中 A 在 N 中，ε 是空字符串

**上下文无关语法 (CFG)**

○ 形式文法，其中每个产生式规则的形式为 V → w

○ V 是单个非终结符

○ w 是一串终结符和/或非终结符（w 可以为空）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-07-26T20:07:38.823

*正则语法：-*包含如下产生式的语法是 RG：

```
V->TV or VT
V->T 
```

其中 V = 变量和 T = 终端

RG 可能是左线性语法或右线性语法，但不是中间线性语法。

众所周知，所有 RG 都是线性语法，但只有左线性或右线性语法是 RG。

常规语法可能是模棱两可的。

```
S->aA|aB
A->a
B->a 
```

*歧义语法：-*对于字符串 x，它们存在多个 LMD 或多个 RMD 或多个 Parse 树或一个 LMD 和一个 RMD，但两者都产生不同的 Parse 树。

```
 S                   S

              /   \               /   \
             a     A             a     B
                    \                   \
                     a                   a 
```

这个语法是模棱两可的语法，因为有两个解析树。

*CFG:-* 如果它的生产形式为 CFG，则称其为 CFG 的语法：

```
 V->@   where @ belongs to (V+T)* 
```

*DCFL：* -众所周知，所有 DCFL 都是 LL(1) 语法，所有 LL(1) 都是 LR(1)，所以它永远不会模棱两可。所以 DCFG 永远不会模棱两可。

我们也知道所有 RL 都是 DCFL，所以 RL 永远不会模棱两可。请注意，RG 可能是模棱两可的，但 RL 不是。

*CFL:* CFl 可能有歧义，也可能没有歧义。

*注意：* RL 永远不会是固有的模棱两可。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-16T05:07:36.233

常用表达

*   词法分析的基础
*   代表常规语言

上下文无关语法

*   解析基础
*   表示语言结构

![在此处输入图像描述](https://i.stack.imgur.com/6JyAj.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-06-30T15:28:41.527

如果所有产生式规则都具有以下形式，则文法是上下文无关的：A（即，规则的左侧只能是单个变量；右侧不受限制，可以是终端和变量的任何序列）。我们可以将语法定义为 4 元组，其中 V 是有限集（变量），_ 是有限集（终端），S 是起始变量，R 是有限规则集，每个规则都是一个映射V
正则文法是右线性或左线性，而上下文无关文法基本上是终结符和非终结符的任意组合。因此我们可以说正则文法是上下文无关文法的一个子集。在这些属性之后，我们可以说上下文无关语言集还包含常规语言集

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-03T14:51:22.367

基本上正则语法是上下文无关语法的一个子集，但我们不能说每个上下文无关语法都是正则语法。主要是上下文无关语法是模棱两可的，而常规语法可能是模棱两可的。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2011-04-21T09:46:46.583

正则语法永远不会模棱两可，因为它要么是左线性的，要么是右线性的，所以我们不能为正则语法制作两个决策树，所以它总是明确的。但除了正则语法之外，所有这些都可能是正则的，也可能不是正则的

# iphone - what language are the apps for the iphone created with?

> ID：559770
> 
> 赞同：1
> 
> 时间：2009-02-18T03:49:43.967
> 
> 标签：iphone

what language is it similar to? cause i was looking at the dev page on apple for the iphone and it doesnt look like anything that i'm used to or know.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T03:56:03.047

iPhone 应用程序是使用 Objective-C 作为主要语言创建的。您也可以在应用程序中使用 C/C++，但 Cocoa Touch API 使用的是 Objective-C。

此外，如果您之前从未在 Mac 上编程过，则需要一些时间来适应。Apple 在其编程模型中广泛使用 MVC（模型视图控制器）设计模式。

这是一个很好的网站，其中包含几个带有源代码的 iPhone 应用程序：http: [//appsamuck.com/](http://appsamuck.com/)

如果您需要 Objective-C 速成课程，请查看此链接： [http ://cocoadevcentral.com/d/learn_objectivec/](http://cocoadevcentral.com/d/learn_objectivec/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-18T03:50:44.277

It's [Objective-C](http://en.wikipedia.org/wiki/Objective-C).

Here's [Apple's Programming Guide Introduction](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/chapter_1_section_1.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T04:41:38.850

正如其他人指出的那样，答案是[Objective-C](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/chapter_1_section_1.html)。对于当前的生产就绪语言，就是这样。在尚未准备好生产的类别中，[Mono](http://www.mono-project.com/Mono:Iphone)人似乎能够使用 Apple 工具链将 C# 交叉编译为本机代码，以便在 iPhone 上部署。大部分 CocoaTouch API 还没有暴露给 Mono，但这只是一个开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T03:50:59.720

Objective-C

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T03:51:33.633

[Objective-C](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/chapter_1_section_1.html)

# java - Java 应该将数组视为对象吗？

> ID：559779
> 
> 赞同：7
> 
> 时间：2009-02-18T03:53:35.017
> 
> 标签：java, arrays

我经常认为允许使用数组作为具有自己的方法的适当对象而不是依赖于像 Arrays、Arrays 和 ArrayUtils 这样的辅助类是一个好主意。

例如：

```
ints.sort();                 // Arrays.sort(ints);
int[] onemore = ints.add(8); // int[] onemore = ArrayUtils.add(ints, 8); 
```

我确信我不是第一个有这个想法的人，但我很难找到以前写过这个想法的其他人。任何人都可以帮助我提供有关此主题的一些参考资料吗？

这是一个好主意还是坏主意，为什么？

实施起来有多容易？

其他一些示例可能包括（但不要挂断它们，它们与问题本身无关）：

```
int[] ints = {5,4,3,2,1};

// Arrays.sort (ints);
ints.sort();

// int pos = Arrays.asList(ints).indexOf (5);
// int pos = ArraysUtils.indexOf (ints, 5);
int pos = ints.indexOf (5);

// Arrays.reverse (ints);
ints.reverse();

Array<Integer> array = ints; // cast to super class.

// int length = Array.getLength (array);
int length = array.getLength();

// Object n = Array.get (array, 3);
Object n = array.get (3);

// Array.set (array, 3, 7);
array.set (3, 7);

Object obj = array;
// if (obj instanceof int[])
//     System.out.println(Array.toString((int[]) obj));
// else if (....)
System.out.println (obj); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T03:58:32.073

数组不是 Java 中的类是有充分理由的——它们很好地映射到人们根据 C 风格语言的经验对数组应该如何工作的理解。使数组成为低级容器而不是对象也有性能原因。因此，有时使用原始数组而不是集合会带来性能优势。

如果你想使用对象，你应该只使用一个集合（一个 ArrayList 是一个集合的例子）。它可能很笨重，但集合提供了您似乎想要的良好方法访问类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T04:18:45.283

这些方法开始看起来很像 ruby​​ 或 python 习语。不幸的是，你不能在 java 中做到这一点（希望你能）。

一方面，正如其他人所指出的，集合类为您完成了它。另一方面， myarray.sort() 不太好，因为您可以创建尚未定义排序的对象数组。假设我有

```
 Foo[] foos; 
```

和 Foo 是不可比的。foos.sort() 上会发生什么？我们绝对不希望它只适用于原语

```
int[] ints; 
ints.sort(); //legal
Object[] objects;
objects.sort(); //illegal 
```

你当然不能让编译器只允许可比较对象的语法。一旦你得到类似的东西

```
 myarray.add(new Foo()); 
```

这有点毫无意义，因为 java 中的数组是不可增长的。

如果打印出一个数组不会给你带来那么无用*那就太好了*

```
([I'm an array(*&(* 
```

垃圾，虽然。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T04:17:42.760

是的。但我认为**Java 根本不应该有任何原语**。我认为 Java 中的原语是从语言的简洁性中分离出来的。Java 中的一切都应该是对象。 **对象是分配在*堆栈*还是*堆上*应该是 JVM 的*实现*细节，而**不是语言结构。但我认为我的观点可能比大多数人更激进。

在自动装箱之前，处理基元和对象非常麻烦。

如果数组是对象并且可以自动装箱（和通用化！），我们可以有类似的东西

```
Array<Integer> myArray = new Integer[];
myArray.add(8);
int x = myArray[0];
.... 
```

或者

```
Array<Class<? extends MyBaseObject>> myArray = {ExtendedObject.class}
ExtendedObject object = myArray[0].newInstance();
.... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T07:24:31.593

在我回答应该之前，我会告诉你这个问题的状态。

在 Java 中，数组被视为对象——例如，您可以将它们存储在 List 中。然而，它们是特殊对象，因为它们从 Object 继承，但没有实例化或使用相同的语法访问（感谢 Peter 的更正）。它们被 JVM 积极优化以解决明显的性能问题，因此存储数组的方式取决于实现。

因此，Sun 的论点是，如果他们为阵列提供对象 API，则可能需要具备某些硬件、软件或其他规范特性。

数组的唯一真正接口是 System.arrayCopy 静态方法或 Array.* 静态方法，它们将最有效地复制到数组/从数组复制。

回应应该；它已经解决了，虽然标准会比答案更好：使用 ArrayList。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T07:43:08.647

是的，我相信数组应该有一个超出语言本身指定的 API 定义的 API。特别是，令人讨厌的是 a`Foo[]`没有实现`Iterable<Foo>`. 是的，我知道包装它很容易 - 但你必须这样做很烦人。

.NET 基本上是正确的，其`Array`类型主要用于非泛型访问，以及被视为由实际数组实现的各种泛型接口。例如：

```
IList<int> intList = new int[10]; 
```

（它有助于 .NET 泛型比 Java 更好地处理原始类型。）

我看到的这种方法的唯一缺点是数组在 .NET 中可以是协变的，但普通泛型不是，而且与非从零开始的数组和矩形数组有些混淆。

顺便说一句，很多人在这个线程中将数组称为原语。虽然它们当然有特殊处理，但它们并没有被定义为原语。从[语言规范，第 4.2 节](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#4.2)：

> 原始类型由 Java 编程语言预定义并由其保留关键字命名（第 3.9 节）：
> 
> ```
> 原始类型：
>         数字类型
>         布尔值
> 
> 数字类型：
>         积分型
>         浮点型
> 
> IntegralType：其中之一
>         字节短整数长字符
> 
> FloatingPointType：其中之一
>         浮动双
> 
> ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T04:01:33.687

这不是一个*坏*主意。事情是它已经在 Collections 上完成了。如果您想发疯，请尝试扩展 ArrayList。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T08:02:00.053

我相信这很难在不破坏许多级别的兼容性的情况下实现。

*   JVM 对数组的处理与其他对象几乎没有区别。创建/初始化是不同的：没有为一件事调用构造函数。您想如何添加新方法？如果通过添加超类，你会调用它的构造函数吗？
*   数组知道运行时元素的类型，泛型不知道。如果您想为所有数组添加新的超类（就像您在原始问题中建议的那样），您会使其通用吗？还要记住，数组在 Java 中是协变的，泛型不是。
*   数组具有 Java 语言规范中指定的固定方法/字段集（来自 Objects 的所有方法，在 JLS 中明确命名，长度字段）。根据这一点，添加新成员可能会破坏现有客户。（即数组不是你的随机类）
*   数组序列化可能也会受到影响
*   我相信还有更多的实现细节会让这变得非常困难:-(
*   为使用新方法而编译的程序无法在较旧的 JVM 上运行。更糟糕的是，根据实现，为旧 JVM 编译的程序可能无法在新 JVM 上使用修改后的数组。

我想直接在“数组类”中有方法，我认为现在不可能实现它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-18T09:14:06.977

我个人喜欢一切都是对象的想法，例如，这已经在 smalltalk 中完成了。然而，把所有东西，甚至方法/函数都变成一个对象的后果是非常深远的（看看 smalltalk 看看我的意思）。在“一切都是对象”规则的应用中保持一致会导致语言看起来不再像 C（或 Java）。

Java 非常有意识地设计为易于 C 程序员使用，并且在这方面取得了成功，但与 smalltalk 相比，它实际上并不是非常面向对象的。它作为 C 变体的遗产随处可见，例如在数组中以及存在原语的事实中。

所以要回答应该的问题，我会说不，因为随着这种变化，Java 将不再是 Java。正如其他人所指出的那样，还有其他类可以让您处理可能已经使用 Java 中的对象在 C 中使用数组完成的任务，但是要完全摆脱原始数据类型和数组，最好留给另一种语言来完成。 ， 恕我直言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-18T07:11:34.887

对于那些错过了之前已关闭的帖子的人。其他一些例子包括

```
int[] ints = {5,4,3,2,1};
ints.sort(); // instead of Arrays.sort(ints);
int pos = ints.indexOf(5); // instead of Arrays.asList(ints).indexOf(5); or ArraysUtils.indexOf(ints, 5);
ints.reverse(); // instead of Arrays.reverse(ints);
Array<Integer> array = ints; // cast to super class.
int length = array.getLength(); // instead of Array.getLength(array);
Object n = array.get(3); // instead of Array.get(array, 3);
array.set(3, 7); // instead of Array.set(array, 3, 7);
Object obj = array;
System.out.println(obj); // prints [5,4,7,2,1] instead of having to
// if (obj instanceof int[]) System.out.println(Array.toString((int[]) obj)); else if (....)

int[] ints2 = ints.copyOf(2);
int[] ints3 = ints.subArray(2,4);
ints.sort(myComparator);
List<Integer> list = ints.asList();
Set<Integer> set = ints.asSet();
long total = ints.sum();
double avg = int.average();
int max = ints.max();
int max2 = ints.max(myComparator);
http://commons.apache.org/lang/api/org/apache/commons/lang/ArrayUtils.html
int[] onemore = ints.add(8); // instead of ArrayUtils.add(ints, 8);
int[] moreInts = ints.addAll(ints2); // instead of ArraysUtils.addAll(ints, ints2);
int[] oneless = int.remove(3); // instead of ArrayUtils.remove(ints, 3);
Integer[] integers = int.toObject();
int[] intsAgain = integers.toPrimitive(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-18T21:00:09.293

我相信它不会那么难的一个原因是您可以通过修改 Object 间接添加方法（我同意一个真正的 hack，但它表明它有效）通过向 Object 添加方法，以下代码

```
int[] ints = {5, 4, 3, 2, 1};
System.out.println("ints= "+ints);
ints.sort();
System.out.println("after sort() ints= "+ints);
ints = ints.add(6);
System.out.println("after add(6) ints= "+ints); 
```

印刷

```
ints= [5, 4, 3, 2, 1]
after sort() ints= [1, 2, 3, 4, 5]
after add(6) ints= [1, 2, 3, 4, 5, 6] 
```

这适用于 Java 5 和 6，编译器和 IDE 都按我的预期处理了这个问题。

# oop - 如何打破我的程序编码习惯？

> ID：559786
> 
> 赞同：18
> 
> 时间：2009-02-18T03:59:30.557
> 
> 标签：oop, class-design

我最近阅读了一篇关于 OOP 相关[问题](https://stackoverflow.com/questions/558439/oo-design-separating-instance-specific-functions-from-class-specific-functions/558455#558455)的有趣评论，其中一位用户反对创建“Manager”类：

> 在谈论班级名称时，请从您的词汇表中删除单词管理器。类的名称应该描述其目的。经理只是*垃圾场*的另一个词。任何功能都适合那里。这个词一直是许多极其糟糕的设计的原因

这条评论体现了我成为一名优秀的面向对象开发人员的努力。我在一个只有程序编码员的组织里做程序代码已经很长时间了。似乎我们生成的相对较少的 OO 代码背后的主要策略是将问题分解为*易于*识别为离散单元的类，然后将剩余/通用位放入“管理器”类中。

我怎样才能打破我的程序习惯（比如 Manager 类）？大多数 OO 文章/书籍等使用的问题示例本质上很容易转换为对象组（例如，Vehicle -> Car），因此没有为分解更复杂的系统提供太多指导。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-18T04:39:46.450

首先，我不会再表现得像程序代码是错误的一样。它是某些工作的正确工具。OO 也是某些工作的正确工具。功能性也是如此。每个范式只是计算的不同观点，存在是因为它便于解决某些问题，而不是因为它是唯一正确的编程方式。原则上，这三种范式在数学上是等价的，因此请使用最能映射到问题域的一种。恕我直言，如果使用多范式语言，如果不同的子问题最好由不同的世界观建模，甚至可以在模块中混合范式。

其次，我会阅读设计模式。如果没有一些实际问题的例子，很难理解 OO，它有利于解决。Head First Design Patterns 是一本很好的读物，因为它回答了很多 OO 的“为什么”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-18T05:41:09.207

擅长 OO 需要多年的实践和学习良好的 OO 代码，最好有导师。请记住，OO 只是达到目的的一种手段。话虽如此，这里有一些对我有用的一般准则：

*   优先组合而不是继承。阅读并重新阅读[GoF 书](https://rads.stackoverflow.com/amzn/click/com/0201633612)的第一章。
*   遵守得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_Of_Demeter)（“告诉，不要问”）
*   尝试仅使用继承来实现多态性。当您从另一个类扩展一个类时，这样做的想法是您将*通过对基类的引用来*调用该类的行为。**基类的所有**公共方法都应该对子类有意义。
*   不要沉迷于建模。构建一个工作原型来为您的设计提供信息。
*   拥抱重构。[阅读福勒著作](https://rads.stackoverflow.com/amzn/click/com/0201485672)的前几章。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-18T04:04:02.090

[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)帮助我将对象分解为有意义的可管理类 。

每个对象都应该做一件事，并且做得很好，而不会将其内部工作方式暴露给需要使用它的其他对象。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-18T04:23:53.947

“经理”类通常会：

1.  询问某物的状态
2.  根据该状态做出决定

作为一种解毒剂或与之形成对比，面向对象的设计将鼓励您设计类 API，在其中您“告诉不要要求”类本身自己做事（并封装自己的状态）：有关“告诉不要”的更多信息“不要问”参见例如[此处](http://www.pragprog.com/articles/tell-dont-ask)和[此处](http://c2.com/cgi/wiki?TellDontAsk)（也许其他人对“告诉不要问”有更好的解释，但这是谷歌为我找到的前两篇文章）。

> 看起来我们生成的小 OO 代码的主要策略是将问题分解为易于识别为离散单元的类，然后将剩余/通用位放入“管理器”类中。

即使在最好的时候，这也可能是真的。*Coplien 在他的Advanced C++: Programming Styles and Idioms*一书的结尾谈到了这一点：他说在一个系统中，你往往会：

*   自包含对象
*   以及作用于其他对象的“事务”

举个例子，一架飞机（我很抱歉给你另一个车辆例子；我在解释他）：

*   “对象”可能包括副翼、方向舵和推力
*   “经理”或自动驾驶仪将执行各种命令或事务

例如，“右转”交易包括：

*   襟翼.right.up()
*   襟翼.left.down()
*   rudder.right()
*   推力.增加（）

所以我认为你确实有交易，它跨越或使用各种相对被动的“对象”；例如，在应用程序中，“随便”的用户命令最终将由每一层（例如 UI、中间层和 DB 层）的各种对象实现（因此调用）。

所以我认为在一定程度上你*会有*“剩余部分”。不过，这是一个程度的问题：也许您应该希望*尽可能多的代码是自包含的、封装的，以及一切……以及**使用*（或依赖于）其他一切的剩余部分，应该给予/使用尽可能多地隐藏并尽可能多地执行的API，因此尽可能多地从所谓的经理那里承担责任（实施细节）。

不幸的是，我只在一本书（*Advanced C++*）中读过这个概念，并且无法将您链接到在线内容以获得比我的这个释义更清晰的解释。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-18T04:21:15.700

阅读然后练习 OO 原则对我有用。[Head First Object-Oriented Analysis & Design](https://rads.stackoverflow.com/amzn/click/com/0596008678 "Head First 面向对象分析与设计")通过示例帮助您制定面向对象的解决方案，然后通过方法使解决方案变得更好。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-18T04:11:45.160

[您可以通过学习设计模式](http://en.wikipedia.org/wiki/Design_pattern_(computer_science))来学习良好的面向对象设计原则。 [Code Complete 2](http://cc2e.com/)是一本关于该主题的好书。自然，将良好的编程原则牢牢记住的最佳方法是通过将它们应用到自己的编码项目中来不断地练习它们。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-18T21:52:01.523

> 我怎样才能打破我的程序习惯（比如 Manager 类）？

为经理管理的内容创建一个类（例如，如果您有一个 ConnectionManager 类，则为一个 Connection 创建一个类）。将所有内容移入该类。

“管理器”在 OOP 中这个名字不好的原因是 OOP 的核心思想之一是*对象应该管理自己*。

*不要害怕做小班。*来自程序背景，您可能认为创建一个类是不值得的，除非它是一千行代码并且是您领域中的一些核心概念。想想更小。十行课程是完全有效的。在你认为有意义的地方创建小类（一个日期、一个邮件地址），然后通过编写这些类来逐步提升。

当您开始将代码库的一小部分划分为类时，剩余的过程代码汤将缩小。在那个不断缩小的池中，您将开始看到其他可以是类的东西。继续直到池为空。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-18T05:01:29.050

换一个灯泡需要多少个 OOP 程序员？

没有，灯泡会自行改变。

;)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-18T05:35:27.347

您可以使用像 Smalltalk 这样的过程支持非常差的 OO 语言。消息发送范式将迫使您进入 OO 思维。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-18T05:19:34.903

我认为你应该从一个好的计划开始。使用类图进行规划将是一个好的开始。

您应该确定应用程序中需要的实体，然后定义每个实体的属性和方法。如果有重复的，您现在可以以可以完成继承的方式重新定义您的实体，以避免冗余。:D。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-18T06:24:34.077

当我阅读 Eric Evans 的书[“领域驱动设计：解决软件核心中的复杂性”](https://rads.stackoverflow.com/amzn/click/com/0321125215)时，我对理解面向对象设计的灵感产生了灵感。或者，如果您便宜或不耐烦，请阅读[“快速领域驱动设计”](http://www.infoq.com/minibooks/domain-driven-design-quickly)迷你书（以免费 PDF 格式在线提供）。:)

任何时候你有一个“Manager”类或任何静态单例实例，你可能正在构建一个程序设计。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-27T10:05:27.163

我有一个三步过程，这是我自己成功完成的过程。后来我遇到了一位前教师转为程序员（现在非常有经验），他向我解释了为什么这种方法如此有效，这涉及到一些心理学，但它基本上都是关于在你学习时保持控制和信心。这里是：

1.  了解什么是测试驱动开发 (TDD)。您可以使用过程代码轻松地做到这一点，因此如果您不想这样做，则不需要开始使用对象。第二步取决于此。

2.  拿起 Martin Fowler 的《重构：改进现有代码的设计》的副本。它本质上是您可以对现有代码进行的微小更改的目录。但是，如果没有测试，您将无法正确重构。这使您可以做的是弄乱代码，而不必担心一切都会中断。测试和重构消除了你不知道会发生什么的偏执和感觉，这是令人难以置信的解放。你离开基本上是在玩。随着您对此越来越有信心，开始探索用于测试对象之间交互的模拟。

3.  现在到了大多数人错误地开始的大事件，它是好东西，但它真的应该排在第三位。在这一点上，您应该阅读有关设计模式、代码异味（这对 Google 来说很好）和面向对象设计原则的内容。还要了解用户故事或用例，因为它们在编写新应用程序时为您提供了良好的初始候选类，这是“我从哪里开始？”的一个很好的解决方案。编写应用程序时出现问题。

就是这样！证明善良！让我知道事情的后续。

# datagridview - 更新数据网格视图中的列

> ID：559788
> 
> 赞同：0
> 
> 时间：2009-02-18T04:00:27.607
> 
> 标签：datagridview

编辑一列后，我想更新 datagridview 中的另一列。

例如，我有一个带有列的 datagridview：

DeliveryReceiptNumber Balance Discount Payment BalanceAfterPayment

2008-02-1211 1000.00 0.00 0.00 1000.00

编辑 Discount 和 Payment 列中的值后的预期结果是从 Balance 列中减去 Payment 列的值，并用差值更新 BalanceAfterPayment 列。

我应该在什么 datagriview 事件中放置更新代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T04:13:31.023

您可能只是在数据网格上内联。否则我会使用 ondatabound 事件处理程序。

# javascript - javascript中NaN的保留关键字是什么？

> ID：559792
> 
> 赞同：8
> 
> 时间：2009-02-18T04:02:59.190
> 
> 标签：javascript, nan

如果我想测试表达式的结果并且函数将返回 NaN 我将如何检查？
示例：
`$('amount').value.toInt()!='NaN'`
^ 不起作用，我假设返回的值不是字符串，
`$('amount').value.toInt()!=NaN`
^ 似乎也不起作用，这似乎很明显

，所以我如何检查返回的值是否不是数字？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-18T04:04:13.417

NaN 值被定义为不等于一切，包括它自己。用函数测试一个值是否为 NaN [`isNaN()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/isNaN)，足够恰当。（ECMAScript 6[`Number.isNan()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isNaN)为非数字参数添加了一个具有不同语义的函数，但截至 2015 年尚未在所有浏览器中支持）。

NaN 值有两个可用的内置属性：全局[`NaN`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN)属性（即`window.NaN`在浏览器中）和[`Number.NaN`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/NaN). 它*不是*语言关键字。在较旧的浏览器中，该`NaN`属性可能会被覆盖，可能会产生令人困惑的结果，但在[ECMAScript 5 标准中，它被设置为不可写](http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.1.1)。

*   正如@some 在评论中指出的那样，还有一个全局函数[isFinite()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/isFinite)可能有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-23T15:58:05.940

检查 NaN 数值运算结果的最佳方法是采用这种方式，例如：

```
var x  = 0;
var y  = 0;
var result = x/y;  // we know that result will be NaN value
// to test if result holds a NaN value we should use the following code :

if(result !=result){
console.log('this is an NaN value');
} 
```

它完成了。

诀窍是 NaN 不能与任何其他值进行比较，即使它本身也是如此（NaN ！=NaN 始终为真，因此我们可以利用这一点并将结果与​​自身进行比较）

**这是 JavaScript（一种优秀而奇怪的语言）**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-13T15:51:25.923

等式运算符（== 和 ===）不能用于针对 NaN 测试值。请改用 Number.isNaN() 或 isNaN() 。

```
NaN === NaN;        // false
Number.NaN === NaN; // false
isNaN(NaN);         // true
isNaN(Number.NaN);  // true 
```

# c# - 使用 C# 合并 Office 2007 或 2003 中的字段

> ID：559795
> 
> 赞同：1
> 
> 时间：2009-02-18T04:03:22.247
> 
> 标签：c#, ms-word, ms-office, mailmerge

我想按照以下方式设置模板文档：

> ```
> ================
> Doc content
> 
> ----------------
> Merge Field1
> Merge Field2
> Merge Field3
> ----------------
> 
> More doc content
> ================ 
> ```

然后我希望能够打开文档，在 C# 中从数据库中加载一个 DataTable 并合并中间模板部分中的字段。DataTable 会有多条记录，所以需要合并输出多个模板来创建一个大文档。我找不到任何这样做的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T05:06:59.817

如果您正在寻找有关使用 C# 代码以编程方式替换邮件合并字段的信息，那么[本文](http://www.c-sharpcorner.com/UploadFile/amrish_deep/WordAutomation05102007223934PM/WordAutomation.aspx)可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-21T14:25:11.200

不久前我有一份工作在做这些事情。我们使用的是 Word Automation，但它很痛苦（因为 Word 会做一些疯狂的事情，比如弹出一个模式对话框，这会破坏你的代码）。

我们开始使用 Aspose 库。我发现它在这个领域相当合理且功能齐全（对合并字段有很好的支持）。然而，它是商业的。

（我与公司没有任何关系——我只是使用他们的软件）

编辑：如果您只需要 Word 2007 支持，请不要打扰这些人；有很多免费的图书馆。虽然很难找到对旧版本的支持

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T04:51:20.293

我已经使用[这个库](http://invoke.co.nz/products/help/docx.aspx)来生成 MS Word 2007 文档。希望它会帮助你。PS 以前这个库是完全免费的，但现在他们也添加了商业版本。但免费版本包含您所需的所有功能。

# c - 从用户空间，我如何判断 Linux 的软看门狗是否配置为没有出路？

> ID：559808
> 
> 赞同：14
> 
> 时间：2009-02-18T04:13:19.993
> 
> 标签：c, linux, watchdog

我正在为 Linux 编写系统监视器，并希望包含一些看门狗功能。在内核中，即使 /dev/watchdog 关闭，您也可以配置看门狗继续运行。换句话说，如果我的守护进程正常退出并关闭 /dev/watchdog，系统仍会在 59 秒后重新启动。这可能是也可能不是用户想要的行为。

我需要让我的守护进程知道这个设置，因为它会影响我处理 SIGINT 的方式。如果设置为开启，我的守护程序将需要（最好）在退出时启动有序关闭，或者（至少）警告用户系统将很快重新启动。

有谁知道从用户空间获取此设置的方法？我在 sysconf() 中看不到任何获取值的内容。同样，我需要能够判断是否启用了软件看门狗。

**编辑：**

Linux 提供了一个非常简单的看门狗接口。进程可以打开 /dev/watchdog ，一旦设备打开，内核将开始倒计时 60 秒以重新启动，除非将一些数据写入该文件，在这种情况下时钟会重置。

根据内核的配置方式，关闭该文件可能会也可能不会停止倒计时。从文档中：

> 如果设备 /dev/watchdog 正确关闭，则可以停止看门狗而不会导致重新启动，除非您的内核是在启用 CONFIG_WATCHDOG_NOWAYOUT 选项的情况下编译的。

我需要能够判断 CONFIG_WATCHDOG_NOWAYOUT 是否是从用户空间守护进程中设置的，以便我可以以不同的方式处理所述守护进程的关闭。换句话说，如果该设置很高，那么简单：

```
# /etc/init.d/mydaemon stop 
```

... 将在 59 秒内重新启动系统，因为不再向 /dev/watchdog 写入任何内容。因此，如果它设置为高，我的 SIGINT 处理程序需要做额外的事情（即至少警告用户）。

我找不到从用户空间获取此设置的方法:(感谢任何帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-18T05:44:14.423

啊哈！在挖掘内核的`linux/watchdog.h`and之后`drivers/watchdog/softdog.c`，我能够确定 softdog`ioctl()`接口的功能。查看它在中宣布的功能`struct watchdog_info`：

```
static struct watchdog_info ident = {
                .options =              WDIOF_SETTIMEOUT |
                                        WDIOF_KEEPALIVEPING |
                                        WDIOF_MAGICCLOSE,
                .firmware_version =     0,
                .identity =             "Software Watchdog",
        }; 
```

它**确实**支持（似乎）覆盖的魔术关闭`CONFIG_WATCHDOG_NOWAYOUT`。所以，当正常终止时，我必须写一个字符'V'`/dev/watchdog` **然后**关闭它，计时器将停止计数。

`ioctl()`对文件描述符的简单`/dev/watchdog`询问`WDIOC_GETSUPPORT`允许您确定是否设置了此标志。伪代码：

```
int fd;
struct watchdog_info info;

fd = open("/dev/watchdog", O_WRONLY);
if (fd == -1) {
   perror("open");
   // abort, timer did not start - no additional concerns
}

if (ioctl(fd, WDIOC_GETSUPPORT, &info)) {
    perror("ioctl");
    // abort, but you probably started the timer! See below.
}

if (WDIOF_MAGICCLOSE & info.options) {
   printf("Watchdog supports magic close char\n");
   // You have started the timer here! Handle that appropriately.
} 
```

使用硬件看门狗时，您可能希望使用`O_NONBLOCK`so `ioctl()`not`open()`块打开（因此检测到繁忙的卡）。

如果`WDIOF_MAGICCLOSE`不支持，则应假设软看门狗配置为 NOWAYOUT。请记住，只需成功*打开*设备即可开始倒计时。如果您所做的只是探测它是否支持魔法关闭并且确实支持，那么请*魔法关闭它*。否则，请务必处理您现在有一个正在运行的看门狗的事实。

不幸的是，如果不实际启动它，就没有真正的方法可以确定，至少我找不到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T04:19:57.560

看门狗可防止由于软件崩溃或硬件故障而对系统进行硬锁定。

你需要的是一个守护进程监控守护进程（dmd）。检查“监控”

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-02-20T08:30:10.360

我认为看门狗设备驱动程序确实适用于嵌入式平台（或至少是控制良好的平台），开发人员将可以控制正在使用的内核。

这可以被认为是疏忽，但我认为不是。

您可以尝试的另一件事是，如果看门狗是作为可加载模块构建的，那么卸载它可能会中止关机？

# grid - 有没有人有一个工作 DojoX Grid 控件的简单示例？

> ID：559809
> 
> 赞同：0
> 
> 时间：2009-02-18T04:13:20.477
> 
> 标签：grid, dojo

我正在尝试将 DojoX Grid 控件添加到我的网站，但我无法让它工作。我想从一个简单的例子开始，但似乎在*任何*地方都没有。这些是我的要求：

1.  我需要一个 1.2 Grid 的例子
2.  `googleapis.com`它应该从（或 AOL 的服务器；而不是主干代码或托管某个私人服务器的 Dojo 代码）加载 Dojo 库
3.  除了从公共服务器加载 Dojo 代码之外，所有其余代码都应该包含在 HTML 页面中。不从另一个 URL 加载数据；我正在尝试让 Grid 正常工作；*然后*我会担心动态加载数据。

令人惊讶的是，我找不到任何满足所有三个要求的东西。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:01:31.470

干得好：

1.  从标准的[Dojox Grid 测试页面开始](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/grid/tests/test_data_grid_large.html)
2.  固定 CSS 导入 la：

    @import " [http://ajax.googleapis.com/ajax/libs/dojo/1.2.3/dojox/grid/resources/Grid.css](http://ajax.googleapis.com/ajax/libs/dojo/1.2.3/dojox/grid/resources/Grid.css) ";

3.  加载的跨域Dojo：

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/dojo/1.2.3/dojo/dojo.xd.js" djConfig="isDebug:false, parseOnLoad: false ">

4.  ...将 parseOnLoad 设置为 false。

5.  声明`test_store`并命名的导入函数：

    loadStore = function(){ // 一些示例数据

6.  `dojo.require`加载所有 d 类后开始一切：

    dojo.addOnLoad(function(){ loadStore(); dojo.parser.parse() } );

就是这样：一个[使用跨域库演示的工作 Dojo Grid](http://1013.fi/ajax/demo/test_data_grid_large.html)。

# ms-access - 在 Access 2007 CSV 导出中：禁用科学记数法

> ID：559815
> 
> 赞同：4
> 
> 时间：2009-02-18T04:14:33.407
> 
> 标签：ms-access, csv, export, scientific-notation

从 Access 2007 导出 CSV 时，它会自动将小数转换为科学记数法。

不幸的是，接收它们的工具将这些字段视为文本，并按原样显示它们。

导出的值来自针对某些 Excel 链接表运行的查询，它们完美地显示在查询视图中。

有什么办法可以禁用自动转换为科学计数法。

即，如果它在查询中显示为 0.007，它将在输出 csv 中显示为 0.007 而不是 7E3？

注意：我只能为此使用 Excel 和 Access。尽管我很想切换到 SQL Server，但如果我把它放在她的工作笔记本电脑上，我妻子会不高兴的！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T04:36:24.820

你有几个选择：

*   您可以直接在查询中使用该[`Format()`函数](http://www.webcheatsheet.com/SQL/access_functions/format.php)来强制将违规列中的数据格式化为某种方式，例如：

    ```
    SELECT ID, Format([Price],"standard") as Pricing FROM ORDERS; 
    ```

*   您可以在 VBA 中编写自己的 CSV 导出例程。
    我最近发布了一个作为[这个问题](https://stackoverflow.com/questions/543387/separating-data-from-a-constantly-appended-file-into-a-new-file/550538#550538)的答案。

您可以轻松地修改代码以某种方式格式化数字类型。
如果您不知道如何，请告诉我，我将修改代码并将其发布在这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T04:18:51.213

您可以在访问中编写少量 VBA 代码以从链接表或访问查询中查询数据并将其写入文本文件，从而创建您自己的 .CSV 并在“向导”之前。我从不太喜欢 Access 的导出“向导”，只是自己创建了文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-04T12:10:29.713

在 Query 中处理此问题的一种简单方法是将值双重转换为长整数，然后再转换为字符串。对于 CSV 导出，无论如何它都是字符。

```
myValue:ZString(ZLong(123456789)) 
```

# windows - 如何在windows中导出和导入环境变量？

> ID：559816
> 
> 赞同：119
> 
> 时间：2009-02-18T04:14:58.257
> 
> 标签：windows, environment-variables, windows-xp

我发现很难让我的环境变量在不同的机器上保持同步。我只想从一台计算机导出设置并导入到其他计算机。

我认为这应该是可能的，但不知道该怎么做。谁能帮我？谢谢。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-02-18T04:26:41.630

您可以使用 RegEdit 导出以下两个密钥：

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment

HKEY_CURRENT_USER\Environment 
```

第一组是系统/全局环境变量；第二组是用户级变量。根据需要进行编辑，然后在新机器上导入 .reg 文件。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2011-02-28T20:27:45.777

我会使用命令提示符中的 SET 命令来导出所有变量，而不仅仅是上面推荐的 PATH。

```
C:\> SET >> allvariables.txt 
```

要导入变量，可以使用一个简单的循环：

```
C:\> for /F %A in (allvariables.txt) do SET %A 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-05-15T09:20:38.157

要导出用户变量，请打开命令提示符并使用带有 /e 的 regedit

例子 ：

```
regedit /e "%userprofile%\Desktop\my_user_env_variables.reg" "HKEY_CURRENT_USER\Environment" 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-02-14T13:07:51.447

[将@vincsilver](https://stackoverflow.com/a/10597721/5411817)和@jdigital[的](https://stackoverflow.com/a/559841/5411817)答案与一些修改相结合，

1.  导出`.reg`到当前目录
2.  添加日期标记

代码：

```
set TODAY=%DATE:~0,4%-%DATE:~5,2%-%DATE:~8,2%

regedit /e "%CD%\user_env_variables[%TODAY%].reg" "HKEY_CURRENT_USER\Environment"
regedit /e "%CD%\global_env_variables[%TODAY%].reg" "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" 
```

输出如下：

```
global_env_variables[2017-02-14].reg
user_env_variables[2017-02-14].reg 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-18T04:27:26.713

您可以在命令行或注册表中访问环境变量。

**命令行**

如果您想要一个特定的环境变量，那么只需键入它的名称（例如`PATH`），然后是 a`>`和要写入的文件名。以下将 PATH 环境变量转储到名为 path.txt 的文件中。

```
C:\> PATH > path.txt 
```

**注册方法**

Windows 注册表将所有环境变量保存在不同的位置，具体取决于您所使用的设置。您可以使用注册表导入/导出命令将它们转移到另一台 PC。

*对于系统变量：*

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment 
```

*对于用户变量：*

```
HKEY_CURRENT_USER\Environment 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-04-11T22:19:45.577

我最喜欢的方法是把它写成一个批处理脚本，将用户变量和系统变量组合到一个备份文件中，就像这样，创建一个`environment-backup.bat`文件并放入它：

```
@echo off
:: RegEdit can only export into a single file at a time, so create two temporary files.
regedit /e "%CD%\environment-backup1.reg" "HKEY_CURRENT_USER\Environment"
regedit /e "%CD%\environment-backup2.reg" "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment"

:: Concatenate into a single file and remove temporary files.
type "%CD%\environment-backup1.reg" "%CD%\environment-backup2.reg" > environment-backup.reg
del "%CD%\environment-backup1.reg"
del "%CD%\environment-backup2.reg" 
```

这将创建`environment-backup.reg`可用于重新导入现有环境变量的变量。这将*添加和覆盖*新变量，但*不会*删除现有变量:)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-01-16T06:15:10.237

这是我的 PowerShell 方法

```
gci env:* | sort-object name | Where-Object {$_.Name -like "MyApp*"} | Foreach {"[System.Environment]::SetEnvironmentVariable('$($_.Name)', '$($_.Value)', 'Machine')"} 
```

它能做什么

1.  收集所有环境变量
2.  过滤它们
3.  发出在另一台机器上重新创建它们所需的格式化 PowerShell（假设所有都设置在机器级别）

因此，在源机器上运行后，只需将输出传输到目标机器并执行（如果在机器级别设置则提升提示）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-12T17:48:42.070

基于@Mithrl 的[回答的 PowerShell 脚本](https://stackoverflow.com/a/42227022/8608146)

```
# export_env.ps1
$Date = Get-Date
$DateStr = '{0:dd-MM-yyyy}' -f $Date

mkdir -Force $PWD\env_exports | Out-Null

regedit /e "$PWD\env_exports\user_env_variables[$DateStr].reg" "HKEY_CURRENT_USER\Environment"
regedit /e "$PWD\env_exports\global_env_variables[$DateStr].reg" "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-28T21:59:13.100

对 12 年前的答案不满意，我的处理方式有所不同。这种方法可以与早于 Win 8 的 Win OS 风格一起使用`SET`，而不是`SETX`在`SETX`开始使用时使用。

> 注意：
> 确保为您喜欢的编辑器调整 RegEx 以获得所需的结果。对于 RegEx 特定问题，请从各种来源寻求帮助，包括[此处提供的教程](https://www.regular-expressions.info/tutorial.html)。我正在使用 Sublime Text 4 搜索和替换 RegEx 示例。

> 警告：
> 我想指出，盲目地复制和粘贴此过程很可能会破坏现有设置并提取源数据。它不会合并两组数据。这是您的责任，我对可能造成的任何损害不承担任何责任。此外，您应该花时间从提取的 env 变量中删除会造成问题或没有价值的设置，例如更改的路径和不同的硬件指标（例如 CPU 核心数）。

这种方法避免了将 System env 变量与 User env 变量混合在一起，而这些变量之前的一些答案都受到了困扰。

```
reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment">>SystemEnvVariablesSourceMachine.txt
reg query "HKEY_CURRENT_USER\Environment">>UserEnvVariablesSourceMachine.txt 
```

清理刚刚创建的文件！导入成功取决于此！使用支持 RegEx 的编辑器并使用以下搜索和替换：

> 注意：一些 RegEx 引擎/工具需要使用 $ 字符来表示替换模式中的反向引用。如果您在搜索和替换中没有得到预期的结果，请尝试一下。

搜索模式：

```
(?:\A\r?\n|^HKEY_CURRENT_USER\\Environment\r?\n?|^HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\r?\n?|^\r?\n$|\r?\n\Z) 
```

替换模式（字面上为空）：

```
Literally Empty 
```

进而

搜索模式：

```
^\s+(.*?)\s{4}\w+\s{4}(.*?)$ 
```

替换模式：

```
\1=\2 
```

强烈建议您花点时间在目标机器上使用这些文件名执行上述相同步骤：

```
SystemEnvVariablesDestinationMachine.txt
UserEnvVariablesDestinationMachine.txt 
```

这也将作为即将到来的导入的备份。

清理完文件的 DestinationMachine 版本后，就可以进行复制了。每个 DestinationMachine 文件的副本并将它们命名为：

```
SystemEnvVariablesFinalMerge.txt
UserEnvVariablesFinalMerge.txt 
```

我们还没有完成，这只是您可以放心编辑的文件版本。保留文件的 DestinationMachine 版本。将它们视为备份。

接下来我们将 SourceMachine 文件合并到 FinalMerge 文件中。这提供了一种手动检查以清除重复数据和不良数据以及最终输出的方法。有很多方法可以做到这一点，但我使用的最简单的方法是准备数据以进行比较，然后比较和合并，然后重新组合数据以使其可导入。

将此搜索和替换 RegEx 模式应用于每个 Source 和 FinalMerge 文件：

搜索模式：

```
(^\w+=|.*?(?:;|$)) 
```

替换模式：

```
\1\n 
```

然后使用 Beyond Compare 4、Meld 或 Winmerge 等差异工具将每个 Source 与 FinalMerge 进行比较。我个人最喜欢的是 Beyond Compare 4。请记住，此时的数据可能未排序，因此您此时可以注意对数据进行排序，注意不要混淆从键到值结构的变量。如何使用这些工具不在此范围内。从文件的 FinalMerge 版本中删除您此时不希望导入的环境变量。

对应用清理的合并感到满意后，将更改保存在 FinalMerge 文件中，然后使用以下 RegEx 模式恢复键值映射：

搜索模式：

```
(.)$\r?\n 
```

替换模式：

```
\1 
```

然后在目标机器上使用 powershell 导入变量：

```
Get-Content .\UserEnvVariablesFinalMerge.txt | ForEach-Object {
    $envVarDataSplit = $($_).split("=")
    if($($envVarDataSplit).count -gt 0)
    {
        Write-Output "Key: $($envVarDataSplit[0]) ~ Value: $($envVarDataSplit[1])"
        SETX $envVarDataSplit[0] "$($envVarDataSplit[1])"
    }
} 
```

> 注意：
> 以管理员身份运行 powershell 以使其成功，否则您将收到错误消息。

```
Get-Content .\SystemEnvVariablesFinalMerge.txt | ForEach-Object {
    $envVarDataSplit = $($_).split("=")
    if($($envVarDataSplit).count -gt 0)
    {
        Write-Output "Key: $($envVarDataSplit[0]) ~ Value: $($envVarDataSplit[1])"
        SETX $envVarDataSplit[0] "$($envVarDataSplit[1])" /M
    }
} 
```

> 注意：
> 如果您在此处遇到错误，可能是由于需要转义字符。您需要手动输入该环境变量或找出正确的转义字符序列来绕过它。

如果事情发生了可怕的错误，您应该能够使用前面的命令和备份恢复到您的 DestinationMachine 版本的环境变量。

# java - Java Collections Framework 实现的 Big-O 总结？

> ID：559839
> 
> 赞同：177
> 
> 时间：2009-02-18T04:26:23.673
> 
> 标签：java, collections, big-o

我可能很快就会教授“Java 速成课程”。虽然假设观众成员会知道 Big-O 表示法可能是安全的，但假设他们会知道各种集合实现上的各种操作的顺序可能是不安全的。

我可以花时间自己生成一个汇总矩阵，但如果它已经存在于公共领域的某个地方，我肯定想重用它（当然，有适当的信用。）

有人有任何指示吗？

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2009-02-18T04:35:20.220

[Java 泛型和集合](http://oreilly.com/catalog/9780596527754/)一书有此信息（第 188、211、222、240 页）。

列出实现：

```
 get  add  contains next remove(0) iterator.remove
ArrayList             O(1) O(1) O(n)     O(1) O(n)      O(n)
LinkedList            O(n) O(1) O(n)     O(1) O(1)      O(1)
CopyOnWrite-ArrayList O(1) O(n) O(n)     O(1) O(n)      O(n) 
```

设置实现：

```
 add      contains next     notes
HashSet               O(1)     O(1)     O(h/n)   h is the table capacity
LinkedHashSet         O(1)     O(1)     O(1) 
CopyOnWriteArraySet   O(n)     O(n)     O(1) 
EnumSet               O(1)     O(1)     O(1) 
TreeSet               O(log n) O(log n) O(log n)
ConcurrentSkipListSet O(log n) O(log n) O(1) 
```

地图实现：

```
 get      containsKey next     Notes
HashMap               O(1)     O(1)        O(h/n)   h is the table capacity
LinkedHashMap         O(1)     O(1)        O(1) 
IdentityHashMap       O(1)     O(1)        O(h/n)   h is the table capacity 
EnumMap               O(1)     O(1)        O(1) 
TreeMap               O(log n) O(log n)    O(log n) 
ConcurrentHashMap     O(1)     O(1)        O(h/n)   h is the table capacity 
ConcurrentSkipListMap O(log n) O(log n)    O(1) 
```

队列实现：

```
 offer    peek poll     size
PriorityQueue         O(log n) O(1) O(log n) O(1)
ConcurrentLinkedQueue O(1)     O(1) O(1)     O(n)
ArrayBlockingQueue    O(1)     O(1) O(1)     O(1)
LinkedBlockingQueue   O(1)     O(1) O(1)     O(1)
PriorityBlockingQueue O(log n) O(1) O(log n) O(1)
DelayQueue            O(log n) O(1) O(log n) O(1)
LinkedList            O(1)     O(1) O(1)     O(1)
ArrayDeque            O(1)     O(1) O(1)     O(1)
LinkedBlockingDeque   O(1)     O(1) O(1)     O(1) 
```

[java.util](https://docs.oracle.com/javase/8/docs/api/java/util/package-summary.html)包的 javadoc 底部包含一些很好的链接：

*   [Collections Overview](https://docs.oracle.com/javase/8/docs/technotes/guides/collections/overview.html)有一个很好的汇总表。
*   [Annotated Outline](https://docs.oracle.com/javase/8/docs/technotes/guides/collections/reference.html)在一页上列出了所有的实现。

* * *

## 回答 #2

> 赞同：164
> 
> 时间：2010-10-29T07:41:28.640

这个网站非常好，但不是特定于 Java：[http ://bigocheatsheet.com/](http://bigocheatsheet.com/) [![这是一张图片，以防此链接不起作用](https://i.stack.imgur.com/rtf34.jpg)](https://i.stack.imgur.com/rtf34.jpg)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-18T04:31:55.080

Sun 为每个集合类提供的 Javadocs 通常会准确地告诉您您想要什么。[哈希映射](http://java.sun.com/javase/6/docs/api/java/util/HashMap.html)，例如：

> 此实现为基本操作（get 和 put）提供**恒定时间性能**，假设哈希函数将元素正确地分散在桶中。集合视图的迭代需要**的时间与 HashMap 实例的“容量”**（桶的数量）加上它的大小（键值映射的数量）成正比。

[树图](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html)：

> 此实现为containsKey、get、put 和 remove 操作提供有**保证的 log(n) 时间成本。**

[树集](http://java.sun.com/javase/6/docs/api/java/util/TreeSet.html)：

> 此实现为基本操作（添加、删除和包含）提供**有保证的 log(n) 时间成本。**

（强调我的）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-02T00:52:30.650

上面的人对 HashMap / HashSet 与 TreeMap / TreeSet 进行了比较。

我将讨论 ArrayList 与 LinkedList：

数组列表：

*   O(1)`get()`
*   摊销 O(1)`add()`
*   如果使用`ListIterator.add()`or在中间插入或删除一个元素`Iterator.remove()`，将 O(n) 移动以下所有元素

链表：

*   在）`get()`
*   O(1)`add()`
*   如果你在中间使用`ListIterator.add()`or插入或删除一个元素`Iterator.remove()`，它将是 O(1)

# php - PHP 中哪个更快，$array[] = $value 还是 array_push($array, $value)？

> ID：559844
> 
> 赞同：127
> 
> 时间：2009-02-18T04:28:38.210
> 
> 标签：php, arrays, performance

在 PHP 中附加数组成员更好用，

```
$array[] = $value; 
```

或者

```
array_push($array, $value); 
```

?

虽然手册说你最好避免调用函数，但我也读过`$array[]`它比`array_push()`. 有哪些说明或基准？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-02-18T04:33:00.273

我个人觉得看起来`$array[]`更干净，老实说，在几毫秒内拆分头发是无关紧要的，除非您计划将数十万个字符串附加到您的数组中。

我运行了这段代码：

```
$t = microtime(true);
$array = array();
for($i = 0; $i < 10000; $i++) {
    $array[] = $i;
}
print microtime(true) - $t;
print '<br>';
$t = microtime(true);
$array = array();
for($i = 0; $i < 10000; $i++) {
    array_push($array, $i);
}
print microtime(true) - $t; 
```

使用的第一种方法`$array[]`比第二种方法快近 50%。

### 一些基准测试结果：

```
Run 1
0.0054171085357666 // array_push
0.0028800964355469 // array[]

Run 2
0.0054559707641602 // array_push
0.002892017364502 // array[]

Run 3
0.0055501461029053 // array_push
0.0028610229492188 // array[] 
```

这应该不足为奇，因为 PHP 手册指出：

> 如果您使用 array_push() 向数组添加一个元素，最好使用 $array[] = 因为这样就没有调用函数的开销。

`array_push`如果在添加多个值时效率更高，我不会感到惊讶。出于好奇，我做了一些进一步的测试，即使是大量的添加，单个`$array[]`调用也比一个 big 快`array_push`。有趣的。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2010-03-12T09:33:38.943

array_push() 的主要用途是您可以将多个值推送到数组的末尾。

它在[文档](http://docs.php.net/array_push)中说：

> 如果您使用 array_push() 向数组添加一个元素，最好使用 $array[] = 因为这样就没有调用函数的开销。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2010-03-12T09:32:17.130

来自[PHP 文档`array_push`](http://php.net/manual/en/function.array-push.php)：

> 注意：如果您使用 array_push() 向数组添加一个元素，最好使用 $array[] = 因为这样就没有调用函数的开销。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-02-18T04:37:04.413

街上的消息是 [] 更快，因为函数调用没有开销。另外，没有人真正喜欢 PHP 的数组函数……

“是……草垛，针……还是针草……啊，他妈的……[] =”

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-03-12T09:33:19.973

一个区别是您可以使用两个以上的参数调用array_push()，即您可以一次将多个元素推送到一个数组中。

```
$myArray = array();
array_push($myArray, 1,2,3,4);
echo join(',', $myArray); 
```

印刷`1,2,3,4`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-12T09:32:34.763

一个简单的 $myarray[] 声明会更快，因为您只是将一个项目推入项目堆栈，因为函数不会带来开销。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-06-30T11:42:40.773

由于“ **array_push** ”是一个函数，并且在循环内被多次调用，它会将内存分配到堆栈中。

但是当我们使用 $array[] = $value 时，我们只是为数组赋值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-12T09:33:09.703

第二个是函数调用，因此通常它应该比使用核心数组访问功能慢。但我认为即使是脚本中的一个数据库查询也会超过 1000000 次对`array_push()`.

有关使用 1000000 个插入的快速基准测试，请参见此处：[https ://3v4l.org/sekeV](https://3v4l.org/sekeV)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-14T19:37:13.540

我只是不想添加：`int array_push(...)`返回数组中元素的新数量（[PHP 文档](http://php.net/manual/fr/function.array-push.php)）。这可能比`$myArray[] = ...; $total = count($myArray);`.

`array_push(...)`当变量用作堆栈时也是有意义的。

# asp.net-mvc - ASP.NET MVC UpdateModel 空属性

> ID：559846
> 
> 赞同：4
> 
> 时间：2009-02-18T04:29:38.487
> 
> 标签：asp.net-mvc, modelbinders

给定以下模型，

```
public class A
{
    public string Name { get; set; }
}

public class B
{
    public string Address { get; set; }
    public A InstanceOfA { get; set; }
} 
```

看法，

```
<%= Html.TextBox("A.Name") %> 
```

和控制器

```
UpdateModel<B>(b, collection.ToValueProvider()); 
```

我的 b 实例将包含 A 的属性，其中 Name 为空字符串。

如果没有为 name 输入值，是否有 UpdateModel 将 A 属性设置为 null ？

澄清一下，这是一个简单的案例，我的真实世界场景包含具有数百个此类属性的数据模型。这些数据模型的定义不在我的掌控之中。因此，我需要一个针对一般情况的解决方案，即如果没有输入任何值，则不要创建属性。

进一步说明：我也需要它在编辑场景中工作，即编辑 A.Name 设置为“foo”的 b 实例以将 A.Name 设置为“”，我希望 A 为空。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T20:41:46.820

我刚刚发现了这种行为（由于检查约束而偶然发现），我认为这是一个错误。我想知道现在有多少开发人员无意中将空字符串保存到他们的数据库中而不是 null？:-)

无论如何，我将对此进行更多探索，看看是否有更好的解决方案。

更新：

这是一个解决方案：

```
using System.ComponentModel;
using System.Web.Mvc;

namespace CustomerWebsite.Mvc
{
  public sealed class EmptyStringToNullModelBinder : DefaultModelBinder
  {
    protected override void SetProperty(ControllerContext controllerContext,
      ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor, object value)
    {
      if ((value != null)
          && (value.GetType() == typeof(string)
              && ((string)value).Length == 0))
      {
        value = null;
      }

      base.SetProperty(controllerContext, bindingContext, propertyDescriptor, value);
    }
  }
} 
```

在 Application_Start 中输入：

```
ModelBinders.Binders.DefaultBinder = new EmptyStringToNullModelBinder(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-25T02:25:54.230

这有点相关，我认为它可以帮助那些以某种方式到达此页面的人。我正在使用 ASP.NET MVC 3，在这个版本中，当一个空文本框发布到服务器时，它被绑定为 null 到模型。

我不得不编写相反的模型绑定器——将空字符串更改为空字符串。

我采用了 Andrew Peters 的上述代码（谢谢！）并将其更改为以下代码。

注意事项：

1.  正如已经提到的 - 这个模型粘合剂做相反的事情。
2.  我不是检查值的类型，而是通过 propertyDescriptor 检查它，我认为这更好，因为这是它的目的 - 描述值。就我而言，这是必不可少的，因为我无法检查为空的值。通过描述符我可以找到我需要的一切。

这是代码：

```
public sealed class CustomModelBinder : DefaultModelBinder
{
    protected override void SetProperty(ControllerContext controllerContext,
        ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor, object value)
    {
        if (value == null && propertyDescriptor.PropertyType == typeof(string))
            value = string.Empty;

        base.SetProperty(controllerContext, bindingContext, propertyDescriptor, value);
    }
} 
```

我希望这可以帮助别人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T05:08:47.740

当该属性在 FormCollection 中时，UpdateModel 会初始化该属性。为了防止 UpdateModel 将某些属性设置为空值，您可以从 FormCollection 中删除值为空的所有项目。为此，您可以向 NameValueCollection 类型添加扩展方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-11T23:37:44.113

在进行模型绑定时，ASP.NET MVC 2 Preview 1 似乎会为您执行此操作。

IE。自动转换 ?Foo=&Bar=cat 为

```
model.Foo = null;
model.Bar = "cat": 
```

实际上，我更喜欢在 null 上获得一个空字符串，所以我不确定它是否是最终设计，但似乎确实有变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-29T15:05:31.147

感谢您的回答，我对其进行了一些更改，以便并非所有字符串属性都被更改，并且不是字符串的属性也可以更改。感谢`DefaultValueAttribute`.

```
public class DefaultValueModelBinder: DefaultModelBinder
{
  protected override void SetProperty( ControllerContext controllerContext,
                                       ModelBindingContext bindingContext,
                                       PropertyDescriptor propertyDescriptor, 
                                       object value )
  {
    if( value == null )
    {
      var defaultValue = (DefaultValueAttribute)propertyDescriptor.Attributes[ typeof(DefaultValueAttribute) ];
      if( defaultValue != null )
        value = defaultValue.Value;
    }

    base.SetProperty( controllerContext, bindingContext, propertyDescriptor, value );
  }
} 
```

# c# - 托盘图标动画

> ID：559853
> 
> 赞同：17
> 
> 时间：2009-02-18T04:31:19.530
> 
> 标签：c#, wpf, system-tray, notifyicon, trayicon

我知道如何在 Windows 通知区域（系统托盘）中放置一个图标。

使图标动画化的最佳方法是什么？您可以使用动画 gif，还是必须依靠计时器？

我正在使用 C# 和 WPF，但也接受了 WinForms。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-25T22:20:22.430

[Abhinaba Basu 的博*文 Animation and Text in System tray using C#*](https://docs.microsoft.com/en-us/archive/blogs/abhinaba/animation-and-text-in-system-tray-using-c)解释了这一点。

它归结为：

*   制作一组图标，每个图标代表一个动画帧。
*   在定时器事件上切换托盘中的图标
*   创建位图条。每帧为 16x16 像素
*   使用[SysTray.cs](https://gist.github.com/philoushka/105e5994588e2d054e31#file-gistfile1-cs)

例如

![在此处输入图像描述](https://i.stack.imgur.com/jY9vc.jpg)

```
private void button1_Click(object sender, System.EventArgs e)
{
    m_sysTray.StopAnimation();
    Bitmap bmp = new Bitmap("tick.bmp");
    // the color from the left bottom pixel will be made transparent
    bmp.MakeTransparent();
    m_sysTray.SetAnimationClip(bmp);
    m_sysTray.StartAnimation(150, 5);
} 
```

`SetAnimationClip`使用以下代码创建动画帧

```
public void SetAnimationClip (Bitmap bitmapStrip)
{
    m_animationIcons = new Icon[bitmapStrip.Width / 16];
    for (int i = 0; i < m_animationIcons.Length; i++)
    {
        Rectangle rect = new Rectangle(i*16, 0, 16, 16);
        Bitmap bmp = bitmapStrip.Clone(rect, bitmapStrip.PixelFormat);
        m_animationIcons[i] = Icon.FromHandle(bmp.GetHicon());
    }
} 
```

要为帧设置动画，请`StartAnimation`启动一个计时器，并在计时器中更改图标以动画整个序列。

```
public void StartAnimation(int interval, int loopCount)
{
    if(m_animationIcons == null)
        throw new ApplicationException("Animation clip not set with    
                                        SetAnimationClip");

    m_loopCount = loopCount;
    m_timer.Interval = interval;
    m_timer.Start();
}

private void m_timer_Tick(object sender, EventArgs e)
{
    if(m_currIndex < m_animationIcons.Length)
    {
        m_notifyIcon.Icon = m_animationIcons[m_currIndex];
        m_currIndex++;
    }
    ....
} 
```

**使用系统托盘**

创建并连接您的菜单

```
ContextMenu m_menu = new ContextMenu();                                   
m_menu.MenuItems.Add(0, new MenuItem("Show",new
                     System.EventHandler(Show_Click))); 
```

获取要在托盘中静态显示的图标。

创建一个包含所有必需信息的 SysTray 对象

```
m_sysTray = new SysTray("Right click for context menu",
            new Icon(GetType(),"TrayIcon.ico"), m_menu); 
```

使用动画帧创建图像条。对于 6 帧条，图像的宽度为 6*16，高度为 16 像素

```
Bitmap bmp = new Bitmap("tick.bmp");
// the color from the left bottom pixel will be made transparent
bmp.MakeTransparent();
m_sysTray.SetAnimationClip(bmp); 
```

开始动画，指示您需要循环动画多少次和帧延迟

```
m_sysTray.StartAnimation(150, 5); 
```

停止动画调用

```
m_sysTray.StopAnimation(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T04:35:23.280

我认为最好的方法是拥有多个小图标，您可以根据速度和时间继续将系统托盘对象更改为新图片。

# c# - 初始化一个集合，这样用户就不必

> ID：559858
> 
> 赞同：4
> 
> 时间：2009-02-18T04:32:30.493
> 
> 标签：c#, collections

这可能是一个愚蠢的问题，但是有没有为用户初始化集合属性的常见做法，所以他们不必在类中使用它之前新建一个新的具体集合？

这些中的任何一个比另一个更受欢迎吗？

选项1：

```
public class StringHolderNotInitialized
{
    // Force user to assign an object to MyStrings before using
    public IList<string> MyStrings { get; set; }
} 
```

选项 2：

```
public class StringHolderInitializedRightAway
{
    // Initialize a default concrete object at construction

    private IList<string> myStrings = new List<string>();

    public IList<string> MyStrings
    {
        get { return myStrings; }
        set { myStrings = value; }
    }
} 
```

选项 3：

```
public class StringHolderLazyInitialized
{
    private IList<string> myStrings = null;

    public IList<string> MyStrings
    {
        // If user hasn't set a collection, create one now
        // (forces a null check each time, but doesn't create object if it's never used)
        get
        {
            if (myStrings == null)
            {
                myStrings = new List<string>();
            }
            return myStrings;
        }
        set
        {
            myStrings = value;
        }
    }
} 
```

选项 4：

还有其他好的选择吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T04:35:40.860

在这种情况下，我看不出延迟加载的原因，所以我会选择选项 2。如果您要创建大量这些对象，那么导致的分配和 GC 的数量将是一个问题，但那是除非后来证明它是一个问题，否则这不是真正需要考虑的事情。

此外，对于这样的事情，我通常不允许将 IList 分配给类。我会将其设为只读。在不控制 IList 的实现时，您会面临意想不到的实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T05:06:19.850

对于选项 1：如果您想强制用户在使用您的类之前初始化某些东西，那么强制它的最佳位置是在构造函数中。

对于选项 2：如果您不强制用户，那么您确实必须在构造函数/初始化程序中自己初始化一个空集合。

对于选项 3：延迟初始化仅在涉及太多工作或其缓慢/庞大的操作时才有意义。

我投票支持选项 2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T06:10:27.980

使用延迟加载解决方案的唯一真正原因是为了优化。优化的第一条规则是“除非你测量过，否则不要优化”:)

基于此，我将采用最不可能导致错误的解决方案。在这种情况下，这将是解决方案＃2。将其设置在初始化程序中实际上消除了此处出现空 ref 的机会。它发生的唯一方法是用户将其显式设置为空。

# selenium - 使用 selenium 脚本控制下载确认弹出窗口

> ID：559879
> 
> 赞同：3
> 
> 时间：2009-02-18T04:43:16.223
> 
> 标签：selenium

我编写了测试用例以单击下载按钮。如何去下载确认弹出窗口并选择保存或打开选项，然后单击确定并返回主窗口。我正在使用 selenium-python 脚本进行网络测试自动化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T05:25:58.430

Selenium 无法控制下载确认。但是，如果您使用 IE 或 Firefox 的“特权”浏览器模式，它可以直接在文件上传字段中键入文件路径。如果您在 Selenium RC 1.0 beta 2 中使用默认的 *iexplore 和 *firefox 模式，请尝试直接在表单字段中输入文件路径。我自己做这个，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-12T07:12:56.253

我认为这个问题之前已经在这里得到了回答，答案是使用另一个工具来自动化浏览器的对话框，例如 autoit [我们如何使用 Selenium 下载文件？](https://stackoverflow.com/questions/3704151/how-do-we-download-a-file-by-using-selenium)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T12:59:08.410

您可以打开弹出窗口并确认它，但我不知道如何管理...。试试这个：

```
alert = browser.switch_to_alert()#switch to popup
alert.accept()#accept popup 
```

# java - 你如何打印包数据类型？

> ID：559880
> 
> 赞同：1
> 
> 时间：2009-02-18T04:43:17.253
> 
> 标签：java

```
Bag<String> wordFrequencies = getWordFrequencies(text); 
```

我如何查看这个 wordfrequencies 包中包含的内容.. 我使用过 org.apache.commons.collections15.Bag org.apache.commons.collections15.bag.HashBag 包

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T04:56:54.553

```
public static String bagToString(Bag<?> bag) {
    StringBuilder sb = new StringBuilder();
    for (Object o : bag.uniqueSet() {

        sb.append(o);
        sb.append(":");
        int nItems = bag.getCount(o);
        sb.append(nItems);
        sb.append(" ");
    }
    return sb.toString();
} 
```

# vb.net - 在 Visual Studio 中使用自动构建进行条件编译

> ID：559881
> 
> 赞同：2
> 
> 时间：2009-02-18T04:46:41.067
> 
> 标签：vb.net, visual-studio-2005, msbuild, build-automation

这是我正在尝试做的事情：

*   单个构建脚本
*   该脚本从同一个 Visual Studio 项目构建两个可执行文件。
*   **第一个编译的 .exe禁用**了少量代码。
*   另一个编译的 .exe 已**启用**所有内容。

我一直在阅读[条件编译](http://msdn.microsoft.com/en-us/library/aa711851.aspx)，它满足了我在启用/禁用代码块方面的需求。

我只是不知道如何**使用 msbuild**从构建脚本控制条件编译。

有没有办法从构建脚本或其他方式操作条件编译变量来完成我想要做的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T05:11:51.053

在项目文件中使用构建配置。在基于配置可选包含的 PropertyGroup 中设置参数。然后，配置还可以定义两个不同版本的程序集的输出路径。

对于需要删除一些代码的版本，请使用包含 PropertyGroup 的配置。

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'CompiledOutDebug|AnyCPU' ">
   <DefineConstants>$(DefineConstants);MY_CONDITIONAL_COMPILATION_CONSTANT</DefineConstants>
</PropertyGroup> 
```

然后使用 MSBuild 脚本两次调用项目 MSBuild 脚本并使用 MSBuild 任务的 Properties 属性来指定要构建的配置：

```
<Target Name="Build">
    <MSBuild Projects="MyProject.csproj;" 
             Targets="Build" 
             Properties="Configuration=Release" />
    <MSBuild Projects="MyProject.csproj"
             Targets="Build"
             Properties="Configuration=CompiledOutDebug" />
  </Target> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T05:26:39.460

哈米什打败了我。

这是使用相同概念的替代解决方案：

在命令行：

```
msbuild -t:Clean
msbuild
CopyOutputDirForWithoutDefine.cmd
msbuild -t:Clean
msbuild -property:DefineConstants=MY_CONDITIONAL_COMPILE_CONSTANT
CopyOutputDirForWithDefine.cmd 
```

第一个和第三个 'msbuild -t:Clean' 确保您没有从以前的构建中遗留下来的粪便。第二个“msbuild”构建没有条件定义，而第四个构建有条件定义。

如果以上只是一些拍摄项目，那么一个批处理文件可能就足够了。我建议学习一点 MSBuild 并像 Hamish 所做的那样实际编写 MSBuild 文件中的所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T07:05:45.930

如果您不想为两个编译创建单独的目标，可以通过在第二次调用构建时在 DefineConstants 属性中指定条件定义来实现：

```
<Target Name="Build">
    <MSBuild Projects="MyProject.csproj;"
             Targets="Build"
             Properties="Configuration=Debug" />
    <MSBuild Projects="MyProject.csproj"
             Targets="Build"
             Properties="Configuration=Debug;
                         AssemblyName=$(AssemblyName)_Conditional;
                         DefineConstants=$(DefineConstants);CONDITIONAL_DEFINE" />
</Target> 
```

请注意，如果您这样做，您还需要覆盖 AssemblyName，否则您的第二个构建可能会从第一个构建中选择中间文件。

您还应该查看 MSDN 上的[MSBuild 任务](http://msdn.microsoft.com/en-us/library/z7f65y0d.aspx)文档，那里有一些有趣的花絮。

# javascript - 为什么我不能在这里使用多个 id？

> ID：559890
> 
> 赞同：2
> 
> 时间：2009-02-18T04:55:48.503
> 
> 标签：javascript, image, fade

我试图让一些代码工作。我正在使用最新版本的 xfade。Homebrew Javascript 图像渐变器，在 div 中的所有 img 标签之间渐变，由 Javascript 分配。我发现有一个图像淡入淡出脚本，它使用 Javascript 在 div 中的图像之间淡入淡出。但是，它只能淡化 1 个 div...我有 3 个点想要淡化图像，并且我无法让 Javascript 代码接受在另一个 div 上运行的效果。

~~这是我正在使用的代码：~~

[http://www.enlinegraphics.com/assets/js/xfade2.js](http://www.enlinegraphics.com/assets/js/xfade2.js)

~~我试图让具有自己的一组褪色图像的多个 div 工作的页面是主页，又名[http://www.enlinegraphics.com](http://www.enlinegraphics.com)~~

如果我完全错了，并且代码不能轻易地在不同的 DIV 上运行效果，那么我可以寻找另一个，但我真的需要找出一个好的 Javascript 图像推子。

**编辑**：我将根据答案的建议尝试使用 JQuery - 如果您有任何可以帮助我的帮助，那将是现在的重点，而不是试图让 xfade 工作。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T05:12:18.917

你可以考虑实现和学习 jQuery，它有一些插件可以淡化事物以及内置函数，如fadeIn()、fadeOut() 等。

您可以使用这样的选择器使用多个 div 淡入淡出

```
$('#div1, #div2').fadeOut(1000); 
```

祝你好运！

## 额外帮助

更具体地说，如果在这个阶段您想开始淡化 Div，请查看[http://docs.jquery.com](http://docs.jquery.com)上的 jQuery 文档，更具体地说，选择器（用于选择 div）和效果（用于学习如何以及使用哪些功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T17:10:31.623

我在[http://www.cwu.edu/~campuslife](http://www.cwu.edu/~campuslife)上做横幅骑行时遇到了类似的问题。虽然 Jquery 的淡出功能很好，但它不足以满足您正在做的事情。如果您只是在图像之间褪色， 我推荐使用 Jquery [cycle lite 插件。](http://malsup.com/jquery/cycle/lite/)

要进行设置，您需要在文档中添加 jquery 脚本、循环插件和第三个 .js 文件，如下所示：

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="cycle.js"></script>
<script type="text/javascript" src="imgrotation.js"></script> 
```

然后，在 imgrotation 文件中，添加以下行：

```
$(document).ready(function(){
    $('#div1, #div2').cycle()
}) 
```

这应该是您在多个 div 中循环浏览图像所需的全部内容。

# php - 从结果中计算日期的最佳方法？

> ID：559891
> 
> 赞同：2
> 
> 时间：2009-02-18T04:56:16.910
> 
> 标签：php, mysql, sorting, timestamp, date

我有一个数据库表。它有数百个条目，每个条目都带有时间戳。我希望每天只输出而不让它在任何日子重复。

数据：
2009-02-04 06:20:27
2009-02-04 06:20:27
2009-02-05 06:20:27
2009-02-07 06:20:27
2009-02-07 06:20 :27
2009-02-07 06:20:27

输出应该只是（时间无关紧要）：
2009-02-04 06:20:27
2009-02-05 06:20:27
2009-02-07 06:20:27

实现这一目标的最佳方法是什么？我真的应该在每一行中循环并进行比较吗？只是看起来效率不高。有什么想法/提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T04:59:04.440

您不能只在查询中选择“DISTINCT”时间戳吗？

或者，如果每天的时间不同（从您的示例中不确定），您可以使用 mysql DATE 函数将时间戳列转换为飞行日期。请记住，如果在该列上使用索引，这可能会阻止使用索引。

例如。

```
SELECT DISTINCT DATE(timestamp_column) FROM table 
```

这将删除时间戳的时间部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T04:59:05.000

您可能希望使用 mysql DISTINCT 关键字在数据库级别执行此操作：

```
SELECT DISTINCT date
FROM table 
```

这将使得如果有重复的日期，只返回一个。[在此处](http://www.webdevelopersnotes.com/tutorials/sql/online_mysql_guide_the_distinct_keyword.php3)阅读更多相关信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T05:06:21.223

这将打印出双时间戳，但应该仅与日期不同。

```
SELECT DISTINCT CAST(timestamp AS DATE), timestamp, FROM table. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T05:09:22.510

```
SELECT DISTINCT CAST(data AS DATE)
    FROM DataTable; 
```

这会删除时间部分，然后给出唯一的 DATE 值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T05:07:08.430

DATE() 函数将从日期时间字段中提取日期。您可以使用该结果进行分组。像这样使用：

```
SELECT fields FROM table WHERE condition GROUP BY DATE(datefield) 
```

# flash - Multi-pages Flash application

> ID：559897
> 
> 赞同：1
> 
> 时间：2009-02-18T05:01:28.567
> 
> 标签：flash, actionscript-3

I am very new to Flash and I need help to get started with building multi-pages Flash application.

I managed to open another swf file (called Page1) from within the main swf by calling this function

```
 private function LoadExternalSwf(): void
    {
        var loader:Loader = new Loader();
        var urlReq:URLRequest = new URLRequest("page1.swf");
        loader.load(urlReq);
        addChild(loader);
    } 
```

1.  How do you add a sort of "Back" button to Page1 so that it will close itself (so that we are back to the main screen)?

2.  If Page1 were a movie, is it possible to automatically close it after it finishes playing?

(I am using Flash CS3, Flex Builder 3, AS3)

Thank you

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T08:38:04.880

> How do you add a sort of "Back" button to Page1 so that it will close itself (so that we are back to the main screen)?

There are many ways of doing this. You could just hide the page by setting it's visibility to false, you could just move it off stage so that it can't be seen or you could remove the movieclip altogether (along with probably other options). Basically it's completely up to you and you must choose the best option to suit your purposes.

In your example you want page1.swf to have a button that, when clicked on, tells it's parent to do something. I would personally recommend that this happens by dispatching an event when the button is clicked. The parent can then listen to page1 for that event. When it catches that event, you can then choose what to do with page1.

I suggest you have a read of some articles regarding events in actionscript 3 to find out how this is achieved. Try [this one](http://www.adobe.com/devnet/actionscript/articles/event_handling_as3.html) for starters

> If Page1 were a movie, is it possible to automatically close it after it finishes playing?

Yes this is also possible and again i would use the same method as stated above. Dispatch an event on the final frame (or when at least you know the final frame has been hit) that tells it's parent to do something.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T00:32:32.173

Solution:

From page1:

```
// Dispatch a "pageFinish" event to the loader/parent/container if any
if (loaderInfo.loader)
    loaderInfo.loader.dispatchEvent(new Event("pageFinish", true)); 
```

From the main swf:

```
// Listen for the "pageFinish" event
loader.addEventListener(EVENT_PAGEFINISH, OnPageFinish);

...

private function OnPageFinish(event: Event): void
{
    ...
} 
```

# android - Android-如何将 android.net.Uri 对象转换为 java.net.URI 对象？

> ID：559902
> 
> 赞同：65
> 
> 时间：2009-02-18T05:05:18.573
> 
> 标签：android, uri, android-bitmap, fileinputstream

我正在尝试获取`FileInputStream`用户从图片库中选择的图像上的对象。`URI`这是返回的 android`android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI`

```
content://media/external/images/media/3 
```

当我尝试从这个对象构造一个 java URI 对象时，我得到一个`IllegalArgumentException`异常描述**Expected file scheme in URI: content://media/external/images/media/3**而android URI将该方案显示为**内容**

**更新**：从未找到原始问题的解决方案。但是如果你想要图片库中图像的字节流，这段代码就可以做到。

```
Bitmap bitmap = Media.getBitmap(getContentResolver(), imageUri);
ByteArrayOutputStream bytes = new ByteArrayOutputStream();
bitmap.compress(Bitmap.CompressFormat.JPEG, 40, bytes);
ByteArrayInputStream fileInputStream = new ByteArrayInputStream(bytes.toByteArray()); 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-02-18T06:03:37.653

您可以结合Java 的基于构造函数使用`toString`android 的方法。`Uri``String``URI`

```
android.net.Uri auri = new android.net.Uri(what ever);
java.net.URI juri = new java.net.URI(auri.toString()); 
```

[Android URI](http://developer.android.com/reference/android/net/Uri.html) | [Java URI](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URI.html)

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-04-24T06:03:03.420

找到从内容 URI 打开 InputStream 的正确方法：

```
InputStream fileInputStream=yourContext.getContentResolver().openInputStream(uri); 
```

就这样！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-30T11:45:15.517

您的原始问题有一个解决方案（将 Uri 转换为 URI）：

1.  获取真实的文件路径（看这段代码：[Get filename and path from URI from mediastore](https://stackoverflow.com/questions/3401579/android-get-filename-and-path-from-uri-from-mediastore)）

2.  使用真实路径和构造函数获取 URI：URI(String uri)

如果您需要更多详细信息，请查看此处：

[如何删除使用带有 ACTION_VIDEO_CAPTURE 的 Intent 录制的视频？](https://stackoverflow.com/questions/6513483/how-deleting-a-video-recorded-using-an-intent-with-action-video-capture)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-19T18:43:31.623

我投票支持 jgilrincon 的回答。由于声誉低，我无法发表评论，这里有一些额外的信息 - 您可以使用Apache Cordova 项目中的[FileHelper.java](https://github.com/apache/cordova-android/blob/master/framework/src/org/apache/cordova/FileHelper.java)，它具有从 Uri 字符串处理文件所需的功能，同时考虑到 mediastore（和应用程序资产文件夹)

特别是此方法提供来自 Uri 的 InputStream：

```
public static InputStream getInputStreamFromUriString(String uriString, Activity cordova) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T14:15:09.990

由于 String 构造不起作用，您是否尝试过自己构造它？

```
android.net.URI auri = new android.net.URI(what ever);
java.net.URI juri = new java.net.URI(auri.getSchema(),
                                     auri.getSchemaSpecificPart(),
                                     auri.getFragment()); 
```

您可能还想仔细检查您是否从 Android URI 类中获取了有效数据。我的其他答案中列出的文档讨论了它如何几乎不进行错误检查。如果实际上存在错误，则该类无论如何都会吐出垃圾并且不会抛出任何异常。这很可能是执行验证的 java 类抛出异常的原因。

# c# - 从外部数据库表 ADO.NET 维护表的本地副本

> ID：559904
> 
> 赞同：1
> 
> 时间：2009-02-18T05:05:38.697
> 
> 标签：c#, ado.net

我们已经构建了一个应用程序，该应用程序需要来自另一个数据库的表的本地副本。我想编写一个 ado.net 例程，使本地表与主表保持同步。使用 .net 2.0、C# 和 ADO.NET。
请注意，我真的无法控制我不想弄乱的第三方关键任务应用程序中的主表。

例如这里是主数据表：

```
ProjectCodeId   Varchar(20)   [PK]
ProjectCode     Varchar(20)
ProjectDescrip  Varchar(50)
OtherUneededField    int
OtherUneededField2   int 
```

我们需要保持同步的本地表...

```
ProjectCodeId   Varchar(20)   [PK]
ProjectCode     Varchar(20)
ProjectDescrip  Varchar(50) 
```

也许解决这个问题的更好方法是你过去对这类问题做了什么？什么对您最有效或应该不惜一切代价避免？

我对这个问题的目标是确定一个处理这个问题的好方法。所以我经常将来自两个或多个不相交的数据源的数据组合起来。由于这个原因，我没有包括数据库平台，这真的不重要。在这种当前情况下，两个数据库都是 MSSQL，但我更喜欢不使用链接数据库或 DTS 等的解决方案。

当然，截断本地表并每次从主表重新填充是一种选择，但是对于成千上万的行，我认为这不是很有效。你？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T03:44:46.193

**编辑**：首先，认识到你正在做的是手动复制，复制从来都不是简单的。您需要跟踪并应用所有 CRUD 状态更改。也就是说，ADO.NET 可以做到这一点。

要跟踪对源的更改，您可以对源数据库使用查询通知。这需要针对数据库的特殊权限，因此源数据库的所有者将需要采取措施来启用此解决方案。我自己没有使用过这种技术，但这里有一个描述。

请参阅“ [SQL Server (ADO.NET) 中的查询通知”](http://msdn.microsoft.com/en-us/library/t9x04ed2.aspx)

> Microsoft SQL Server 2005 和 ADO.NET 2.0 中的 System.Data.SqlClient 命名空间中引入了查询通知。建立在 Service Broker 基础架构之上，查询通知允许在数据发生更改时通知应用程序。**此功能对于从数据库提供信息缓存的应用程序（例如 Web 应用程序）特别有用，并且需要在源数据更改时得到通知。**

要应用源数据库表中的更改，您需要从目标数据库表中检索数据，将更改应用到目标行并将更改发布回目标数据库。

要应用更改，您可以 1) 删除并重新插入所有行（简单），或 2) 逐行合并更改（硬）。

删除和重新插入是不言自明的，所以我不会详细说明。

对于逐行更改跟踪，这是一种方法。（我在这里假设查询通知不会为您提供逐行更改信息，因此您必须计算它。）

*   您需要确定哪些行被修改并识别插入和删除的行。为每个表创建一个带有排序的 DataView，以获得一个 Find 方法，您可以使用它来按 ID 查找匹配的行。
*   通过使用日期时间/时间戳列或通过比较所有字段值来识别修改的行。将修改后的值复制到目标行。
*   通过循环遍历各个表 DataViews 并使用另一个 DataView 的 Find 方法来识别未出现在第一个表中的行来识别添加和删除的行。根据需要在目标表中插入或删除行。（Delete 方法不会删除该行，而是将其标记为由 TableAdapter Update 删除。）

    祝你好运！

+汤姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T05:21:36.833

我将推动插入数据的应用程序将插入一个数据库/表，然后将另一个插入到同一函数中。让应用程序完成工作，数据库将被推送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T06:17:21.957

一些问题 - 什么数据库平台？你是如何使用数据的？

我将假设您只是将这些数据用作查找...并且由于您没有时间戳并且无法修改现有表，我只会定期删除本地副本并将其从主副本中拉下来再次表。

除非你有大量的数据，否则开销应该很小。

如果您需要同步回主表，则需要做一些更奇特的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T17:20:29.677

可以使用 SQL 复制吗？这比编写代码更可取吗？

# wcf - ASMX 或 WCF 代理客户端是否使用 IO 完成端口？

> ID：559905
> 
> 赞同：1
> 
> 时间：2009-02-18T05:06:00.273
> 
> 标签：wcf, multithreading, io, asmx

我正在对项目的关键部分进行性能测试，这时我注意到有很多额外的线程被用来执行 WaitOrTimerCallback 操作。

[替代文字 http://lh4.ggpht.com/_p7-jVU64mGg/SZuWgUvTD7I/AAAAAAAAAEk/PUFrXrYvZh0/threads_thumb%5B1%5D.jpg?imgmax=800](http://lh4.ggpht.com/_p7-jVU64mGg/SZuWgUvTD7I/AAAAAAAAAEk/PUFrXrYvZh0/threads_thumb%5B1%5D.jpg?imgmax=800)

经过仔细检查，我可以看到这些是由我的 ASMX 客户端代理类生成的，用于在远程服务器上进行操作。

我的印象是这些都在使用 IO 完成端口，就像我所有的其他异步 IO 调用一样。

是否可以让 ASMX 或 WCF 代理客户端使用 IO 完成端口？如果不是 - 真的有什么意义？

[更新] 该项目正在使用 ASMX 代理客户端。看来他们正在使用普通线程池来注册 WaitOrTimerCallback。我现在正在使用 WCF 代理客户端。这些不会产生额外的线程，所以我只能假设它们正在使用所需的 IO 完成端口。

ASMX 代理类是使用 Visual Studio 2008 创建的。我在项目文件中添加了以下行：“WebReference_EnableLegacyEventingModel>true” 因为当前的 ASMX 客户端默认没有启用异步。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T05:31:58.243

我不能代表 ASMX，但 WCF 肯定会（如果 ASMX 没有，我会像你一样感到惊讶）。您能否获取调用堆栈以确保它们确实被网络调用（而不是其他一些用户代码）阻塞？

# unit-testing - 哪种类型的单元测试在商业价值方面的回报最大？

> ID：559906
> 
> 赞同：2
> 
> 时间：2009-02-18T05:06:00.443
> 
> 标签：unit-testing, tdd, integration-testing, functional-testing

我的问题假设人们已经相信某种单元测试是值得的，并且实际上将它们写在他们当前的项目中。让我们还假设代码的某些部分的单元测试不值得编写，因为它们正在测试微不足道的功能。示例是 getter/setter，和/或编译器/解释器将立即捕获的东西。相反的假设是“有趣”的代码值得测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-18T05:10:27.190

代码区域的覆盖级别应该与更改的可能性和依赖它的功能量的组合成正比。

例如，我们在基本控制类的核心有一些相当复杂的解析逻辑。*我们对它*进行了单元测试，因为它必须处理来自我们影响之外的系统的输入（改变的可能性很大）+我们所有的 UI 控件都依赖于它来保持稳定。基础中最轻微的调整会通过继承和依赖层产生涟漪并放大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T05:10:59.823

验证在层之间传递的数据的单元测试*通常会*增加最大的价值

UI <----> 业务 <---> 数据

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T05:35:00.390

我发现回报最多的测试是那些测试以前发现的错误的测试。在我看来，如果一个团队在修复错误时只添加回归测试，那么他们将比几乎任何其他测试策略获得更多的收益。

通过测试已损坏的内容（并彻底测试），您知道您正在测试容易损坏的区域。

这当然假设您正在测试在开发过程中中断的东西，而不仅仅是在部署或类似的东西之后等待 QA 报告滴入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T07:30:13.827

当问题被问到时，我毫不怀疑像 selenium 测试这样的功能测试提供了最大的商业价值。selenium (web) 测试点击应用程序并断言预期的行为，如用户故事/用例所定义。这些测试断言您的软件试图与客户沟通的主要“事物”是好的。

如果这些事情不起作用，您的客户将对您生产可信软件的能力失去信心，从而带走相当多的商业价值。

现在，这些测试可能没有涵盖相当多的细节，但我真的相信它们对于建立*信任*至关重要，尤其是在与大众市场交谈时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T05:11:25.017

为了解决我自己的问题，以下是我发现值得测试的模块：

a) 任何业务规则。在我当前的应用程序中，业务规则是从业务对象外部化的。

b) 业务对象上的任何虚拟属性。这些虚拟属性通常涉及算法。

c) 主要组件，我们可以在其中说明给定消耗的输入的预期生产输出。这通常会渗透到集成测试中。

d) 我们的开发过程要求我们检查单元测试中的新功能和错误修复。对于错误修复，我们尝试准确复制导致错误的原因，并显示一旦代码修复被签入，单元测试就可以通过。

e) 我们从一种数据表示类型转换为另一种数据表示类型的任何转换层，例如 POJO-XML

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T06:46:39.360

在[SO Podcast 41](https://blog.stackoverflow.com/2009/02/podcast-41/)中讨论- 这部分目前不在[成绩单](https://stackoverflow.fogbugz.com/default.asp?W29030)中。博客中的回复包含对单元测试覆盖率值的进一步讨论。

> *   Joel 担心过度的 TDD（例如，从 90% 到 100% 的测试覆盖率）会缩短其他可能使软件产品受益的活动的时间，例如更好的可用性或用户要求的附加功能。
> *   单元测试作为“吃你自己的狗粮”的一种形式，并记录系统的行为是绝对有用的。即使您完全无视测试的实际结果，它们作为文档仍然很有价值，并为您提供了对代码库的全新外部视角。
> *   Joel 指出了测试 UI（Web 或可执行文件）与测试 UI 背后的代码相比的难度。执行此操作的经典方法可能记录在 The Art of UNIX Programming 中，您从一个命令行应用程序开始，该应用程序接收和输出文本。GUI 只是您粘贴在命令行应用程序之上的一个层，它可以带来完美的可测试性——但从长远来看，可能不是那么出色的应用程序。哪个更重要？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T08:08:03.580

所有合理的单元测试都是有价值的，但根据我的经验，那些倾向于节省最多时间，从而产生最佳投资回报率的单元测试是错误修复的单元测试。主要是因为错误修正适用于代码中最困难/最脆弱的部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-05T16:31:32.263

可以在许多地方重用的测试。我当前项目的示例：

*   配置文件的语法检查
*   检查 RTF 模板中引用的模型属性是否确实存在于模型类中（人们更改类并且通常忘记调整模板）
*   检查一些经常被忽视的样式指南规则（每个 UI 掩码必须有标题栏文本，每个按钮必须有唯一的助记符等）

即使是对单元测试持怀疑态度的程序员也喜欢这些，因为他们可以用最少的工作量使用它们——在某些情况下，它会引导他们编写自己的单元测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-18T17:56:55.257

TDD 可以帮助您更快地编写代码，因此只有更快的 TDD 才能提供更多的业务价值。;)

# git - git rebase 和 git push：非快进，为什么要使用？

> ID：559917
> 
> 赞同：70
> 
> 时间：2009-02-18T05:09:23.057
> 
> 标签：git, merge, rebase

我有一个分支，它应该可供其他贡献者使用，并且应该不断与主人保持同步。

不幸的是，每次我执行“git rebase”然后尝试推送时，都会导致“非快进”消息和推送中止。在这里推送的唯一方法是使用--force。这是否意味着如果我的分支公开并且其他人正在处理它，我应该使用“git merge”而不是变基？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-02-18T05:37:26.640

**关于 git 如何工作的一些说明（非技术性）：**

当你变基时，git 接受有问题的提交，并在干净的历史记录之上“重新提交”它们。这是为了防止历史显示：

```
Description: tree -> mywork -> merge -> mywork -> merge -> mywork -> merge
Commit SHA1: aaaa -> bbbb   -> cccc  -> dddd   -> eeee  -> ffff   -> gggg 
```

在 rebase 之后，它可能看起来像这样（或类似）：

```
Description: tree -> rebase
Commit SHA1: aaaa -> hhhh 
```

问题是您尝试推出的新提交不是您要推送到的分支尖端的提交**的后代。**

现在，您知道提交中包含相同的信息，但 git 不仅负责覆盖那些提交（上面示例中的 bbbb-gggg）。

* * *

**共享回购模型**

如果您使用的是共享存储库，那么这样的事情可能会变得非常混乱。让我解释一下为什么。假设另一个开发人员关闭了分支，他们在他们的分支中提交了**aaaa -> gggg**。然后他们做出提交**iiii**

同时，你重新设置并强制推送，导致树看起来像这样：

```
Description: tree -> rebase
Commit SHA1: aaaa -> hhhh 
```

当其他开发人员尝试推送时，他会收到“非快进”消息。当他进行合并时，两个历史都重新链接在一起，你最终会**一团糟**

像这样的东西（混乱）：

```
Description: tree -> rebase -> mywork -> merge -> mywork -> merge -> mywork -> merge -> devwork -> merge 
Commit SHA1: aaaa -> hhhh   -> bbbb   -> cccc  -> dddd   -> eeee  -> ffff   -> gggg -> iiii    -> jjjj 
```

换句话说，如果其他人在拉和推，最好坚持使用 git merge，或者**避免**在 rebase 之后推送（并且只对你的工作进行 rebase）。

* * *

**公开可见的存储库模型**

也许您正在使用不同的（更混乱的）模型，您只是希望人们能够从您的存储库中提取。在这种情况下， git push --force 并不算太糟糕，因为这样他们就可以跟上它。在将补丁提供给您之前，他们可以重新**调整他们的更改以在您的更改之上。**它可以防止您的回购变得一团糟。

但是，您可能有更好的方法。 **git push --镜像**

[来自 http://www.kernel.org/pub/software/scm/git/docs/git-push.html](http://www.kernel.org/pub/software/scm/git/docs/git-push.html)

> 不是命名要推送的每个 ref，而是指定将 $GIT_DIR/refs/ 下的所有 refs（包括但不限于 refs/heads/、refs/remotes/ 和 refs/tags/）镜像到远程存储库。新创建的本地 refs 会被推送到远端，本地更新的 refs 会在远端强制更新，删除的 refs 会从远端移除。如果设置了配置选项 remote..mirror，这是默认设置。

* * *

**git**的一大优点是它非常灵活并且允许许多不同类型的工作流。但它真正的优势在于它是一个分布式模型，所以我相信通过这种方式使用它可以获得最大的投资回报率。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T10:30:24.500

不，rebase 对于公共存储库是完全合法的，甚至可能需要保持历史流畅。请记住，您不得使用 rebase 重写远程发布提交的历史记录。也就是说，rebase 只能应用于您自己的、本地的、您从未发布过的提交。您在获取时使用 rebase 将您的提交放在它们之上，然后也许在那里调整它们。您可能会收到此类消息的另一个原因是您推送的分支已更新并且您需要同步——在您获取的内容之上获取并重新设置您的提交。

# c++ - C++0x：标准算法的范围重载？

> ID：559918
> 
> 赞同：5
> 
> 时间：2009-02-18T05:09:27.237
> 
> 标签：c++, c++11

```
std::sort(range(c)); 
```

与

```
std::sort(c.begin(), c.end(); 
```

您是否期望下一个标准为标准算法提供范围重载？

Boost 的[范围迭代器](http://www.boost.org/doc/libs/1_38_0/libs/range/index.html)是类似的，`iseq()`TC++PL3e 中提到的 Bjarne Stroustrup 的也是同样的想法。我查看[了我能找到的最新草案，](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2798.pdf)但没有看到提到的范围重载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T06:24:21.707

历史[页面](http://www.boost.org/doc/libs/1_38_0/libs/range/doc/history_ack.html)提供了部分答案。

必须迫切需要向`std`命名空间添加重载。请注意，这是一个库问题。您可以搜索档案以查找之前是否有人提出将这些添加到图书馆的请求。如果没有，您可以提交缺陷报告。当前的语言无论如何都不会阻止您编写自己的包装器。因此，问题归结为很多其他人是否也希望它作为**标准库支持的功能**。但这还不是全部。任何扩展，甚至是图书馆的扩展，不仅是一种技术选择，而且还受到许多其他地缘政治问题的指导。你必须有一定数量的选票才能进入。

坦率地说，我很乐意看到它进入。但是，请记住，这绝不是图书馆不能没有的小说/核心功能。所以，保持你的手指交叉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T15:15:03.973

基于范围的 for 循环是我能找到的唯一使用范围概念的标准草案。在我看来，大多数标准算法都可以支持 Ranges 似乎很自然，但在您链接的标准草案中没有提到它。

# html - 边框没有包含所有 div 的元素

> ID：559921
> 
> 赞同：1
> 
> 时间：2009-02-18T05:10:21.150
> 
> 标签：html, css

我现在开始使用适当的标记和组织进行设计。现在，我的 div 边框有问题。它没有包含 div 的所有内容。

这是我的 html 片段：

```
 <div id="paneMiddle"> 
  <div id="subPaneLatestItems">
        <p id="latestItemsTitle">Latest Shop Items:</p>
        <div>
        <img src="img/flower1.jpg" />
        <span id="itemName">Ballpen</span>
        <br/><span id="itemPrice">Php 90.00</span>
        </div>
     </div></div> 
```

这是我的CSS：

```
div#paneMiddle>div{
/*All divs that are children of div#paneMiddle*/
width:590px;
margin:5px 5px 5px 5px;
position:relative;
border-color:#FFCC33;
border-style:solid;
border-width:thin;
position:relative;
} 
```

为什么这不起作用？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-18T05:14:13.047

查看将 clearfix 类添加到您的 div 是否可以修复任何问题

[http://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T05:15:42.573

没有更多信息，我只能假设flower1.jpg 和其他内容的组合宽度超过 590 像素。当您在 CSS 中为元素指定具体宽度时，即使其内容较大，它*也会遵循该宽度。*

另外，需要指出的是，IE 不支持 > 直接后代选择器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T05:26:09.507

每当我遇到这样的麻烦时，我都会做一个最小的独立示例进行测试。尽管我使用了本地图像，但这个效果很好。当我将宽度减小到 50 像素时，图像会超出边框的右侧，因此这可能是您遇到的问题。在您的情况下，边界之外究竟是什么？

根据您对浮动的进一步评论：离开图像 div，以下显示了您可能遇到的问题。如果您运行此代码，您将看到第一个带边框的 div 不再包含图像。这是你看到的问题吗？

```
<html>
    <head>
        <style type="text/css">
            div#x{
                float:left;
            }
            div#paneMiddle>div{
                /*All divs that are children of div#paneMiddle*/
                width:590px;
                margin:5px 5px 5px 5px;
                position:relative;
                border-color:#FFCC33;
                border-style:solid;
                border-width:thin;
                position:relative;
            }
        </style>
    </head>
    <body>
        <div id="paneMiddle"> 
            <div id="subPaneLatestItems">
                <p id="latestItemsTitle">Latest Shop Items:</p>
                <div id="x">
                    <img src="img/flower1.bmp" />
                    <span id="itemName">Ballpen</span>
                    <br/>
                    <span id="itemPrice">Php 90.00</span>
                </div>
            </div>
            <div id="subPaneLatestItems2">
                Hello
            </div>
        </div>
    </body>
</html> 
```

包括 cleardiv 修复（此处显示）似乎可以解决问题：

```
<html>
    <head>
        <style type="text/css">
            .clearfix:after {
                content: ".";
                display: block;
                clear: both;
                visibility: hidden;
                line-height: 0;
                height: 0;
            }
            .clearfix {
                display: inline-block;
            }
            html[xmlns] .clearfix {
                display: block;
            }
            * html .clearfix {
                height: 1%;
            }
            div#x{
                float:left;
            }
            div#paneMiddle>div{
                /*All divs that are children of div#paneMiddle*/
                width:590px;
                margin:5px 5px 5px 5px;
                position:relative;
                border-color:#FFCC33;
                border-style:solid;
                border-width:thin;
                position:relative;
            }
        </style>
    </head>
    <body>
        <div id="paneMiddle"> 
            <div class="clearfix" id="subPaneLatestItems">
                <p id="latestItemsTitle">Latest Shop Items:</p>
                <div id="x">
                    <img src="img/flower1.bmp" />
                    <span id="itemName">Ballpen</span>
                    <br/>
                    <span id="itemPrice">Php 90.00</span>
                </div>
            </div>
            <div id="subPaneLatestItems2">
                Hello
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-19T00:44:58.753

只是要注意您的图像没有标题或更重要的是替代文本，也许您还没有解决这个问题，但需要研究它的要点。替代文本允许用户了解如果图像未加载或图像关闭时可能存在的内容。如果用户使用屏幕阅读器，图像的描述对他们有用，这也是一个可访问性问题。

```
<img src="img/flower1.jpg" alt="Photo of a Daisy" title="This is a Daisy" /> 
```

# blackberry - BlackBerry 应用程序退出时关闭资源

> ID：559928
> 
> 赞同：0
> 
> 时间：2009-02-18T05:12:22.817
> 
> 标签：blackberry, resources

在 BlackBerry 应用程序中关闭资源的最佳方式是什么？我在应用程序的整个生命周期中都使用这些资源，并且只想注册一些侦听器，以便在应用程序即将退出时调用。在应用程序关闭之前是否有一个简单的钩子被调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T03:17:05.703

您可以做的一件事是捕获 ESC 键。当只有您的主屏幕位于屏幕堆栈（ UiApplication.getScreenCount() ）并且按下 ESC 键时，您可以清理您的资源。

1.  此外，您可以注册一个 SystemListener 来侦听 powerOff() 回调以终止线程或清理资源。
2.  此外，UIApplication.deactivate() 也是在您的应用程序处于后台时清理/暂停内容的好地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T16:00:20.030

覆盖`MainScreen.close()`最后一个从 UI 堆栈中弹出的屏幕的功能。此`close()`方法很可能是您的应用程序被销毁之前调用的最后一个方法。

让我补充一下，强烈建议始终关闭流，尤其是文件访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T05:25:33.470

当您的应用程序退出时，操作系统会回收所有资源。

你肯定有正确的心态，释放资源是一件好事，但如果你必须在你的应用程序退出时跳过箍来这样做，那么它可能不值得。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T18:30:50.680

应该考虑安德鲁提到的一点。如果一定要跳槽释放资源，尝试改变设计，保证资源通过一个控制点释放。这将使您更容易。并且更易于维护。

# eclipse - 从许多 Eclipse 项目创建单个 jar

> ID：559929
> 
> 赞同：0
> 
> 时间：2009-02-18T05:13:54.217
> 
> 标签：eclipse, ant, build-automation

我正在使用 ant 为 java 应用程序进行构建自动化。这是一个客户端-服务器应用程序，在 Eclipse 中有许多项目。我想为客户端创建一个 jar 文件，为服务器创建一个 jar 文件，但是由于类依赖项遍布整个项目（在 eclipse 中）......我想到了使用一种工具来自动搜索依赖项。我一直在看[GenJar](http://genjar.sourceforge.net/)女巫几乎是我所需要的，但它有一段时间没有更新了。所以我想知道是否还有其他类似的工具，也许是 Maven？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T05:36:31.090

你也可以试试[FatJar](http://fjep.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T05:17:55.347

听起来您真正想要的是[WAR 文件](http://en.wikipedia.org/wiki/Sun_WAR_(file_format))。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T21:44:47.290

我个人会选择 Ant + [Apache Ivy](http://ant.apache.org/ivy/)。每个项目都有自己的 build.xml 文件并发布到中央 Ivy 存储库。其他项目将根据需要简单地下载这些依赖项。

拥有基于 Ant 的构建过程的优势在于，您可以非常轻松地将其自动化，并在每次签入后使用连续服务器来构建整个产品。

# latex - 在 LaTeX 中，如何在文档类 Letter 中添加页眉/页脚？

> ID：559938
> 
> 赞同：22
> 
> 时间：2009-02-18T05:19:06.200
> 
> 标签：latex, header, footer

在 LaTeX 中，如何使用 Letter 文档类创建文档，但要使用自定义的页眉和页脚？

通常我会使用：

```
\usepackage{fancyhdr}

\pagestyle{fancy}
\lhead{\footnotesize \parbox{11cm}{Custom left-head-note} }
\lfoot{\footnotesize \parbox{11cm}{\textit{#2}}}
\rfoot{\footnotesize Page \thepage\ of \pageref{LastPage}}
\renewcommand\headheight{24pt}
\renewcommand\footrulewidth{0.4pt} 
```

但是，对于 \documentclass{letter}，这根本不起作用。建议受到应有的重视。

**编辑：**这是不起作用的示例代码（出于任何明显的原因）：

```
\documentclass[12pt]{letter}

\usepackage{fontspec}% font selecting commands 
\usepackage{xunicode}% unicode character macros 
\usepackage{xltxtra} % some fixes/extras 

% page counting, header/footer
\usepackage{fancyhdr}
\usepackage{lastpage}

\pagestyle{fancy}
\lhead{\footnotesize \parbox{11cm}{Draft 1} }
\lfoot{\footnotesize \parbox{11cm}{\textit{2}}}
\cfoot{}
\rhead{\footnotesize 3}
\rfoot{\footnotesize Page \thepage\ of \pageref{LastPage}}
\renewcommand{\headheight}{24pt}
\renewcommand{\footrulewidth}{0.4pt}

\begin{document}
\name{ Joe Laroo }
\signature{ Joe Laroo }
\begin{letter}{ To-Address }
\renewcommand{\today}{ February 16, 2009 }
\opening{ Opening }
Content of the letter.
\closing{ Yours truly, }
\end{letter}
\end{document} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-18T16:06:41.183

就在您的“信件内容”行之前，添加`\thispagestyle{fancy}`它应该显示您定义的标题。（它对我有用。）

这是我用来测试的完整文档：

```
\documentclass[12pt]{letter}

\usepackage{fontspec}% font selecting commands 
\usepackage{xunicode}% unicode character macros 
\usepackage{xltxtra} % some fixes/extras 

% page counting, header/footer
\usepackage{fancyhdr}
\usepackage{lastpage}

\pagestyle{fancy}
\lhead{\footnotesize \parbox{11cm}{Draft 1} }
\lfoot{\footnotesize \parbox{11cm}{\textit{2}}}
\cfoot{}
\rhead{\footnotesize 3}
\rfoot{\footnotesize Page \thepage\ of \pageref{LastPage}}
\renewcommand{\headheight}{24pt}
\renewcommand{\footrulewidth}{0.4pt}

\usepackage{lipsum}% provides filler text

\begin{document}
\name{ Joe Laroo }
\signature{ Joe Laroo }
\begin{letter}{ To-Address }
\renewcommand{\today}{ February 16, 2009 }
\opening{ Opening }

\thispagestyle{fancy}% sets the current page style to 'fancy' -- must occur *after* \opening
\lipsum[1-10]% just dumps ten paragraphs of filler text

\closing{ Yours truly, }
\end{letter}
\end{document} 
```

该`\opening`命令将页面样式设置为`firstpage`or `empty`，因此您必须`\thispagestyle`在该命令之后使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T14:16:46.907

在我删除之后

```
\usepackage{fontspec}% font selecting commands 
\usepackage{xunicode}% unicode character macros 
\usepackage{xltxtra} % some fixes/extras 
```

它似乎“正确”地工作。

值得注意的是，页眉和页脚仅从第 2 页开始出现。尽管我已经尝试了 fancyhdr 文档中给出的修复，但我也无法让它工作。

仅供参考：Vista 下的 MikTeX 2.7

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T15:05:43.903

关于 Brent.Longborough 的回答（仅在第 2 页出现），也许您需要在**\begin{document}**之后设置**\thispagestyle{** } 。我想知道字母类是否将第一页样式设置为空。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-19T13:01:54.380

此代码用于在第一页上插入页眉和页脚，页眉居中对齐，页脚左对齐

```
\makeatletter
\let\old@ps@headings\ps@headings
\let\old@ps@IEEEtitlepagestyle\ps@IEEEtitlepagestyle
\def\confheader#1{%
  % for the first page
  \def\ps@IEEEtitlepagestyle{%
    \old@ps@IEEEtitlepagestyle%
    \def\@oddhead{\strut\hfill#1\hfill\strut}%
    \def\@evenhead{\strut\hfill#1\hfill\strut}%
 \def\@oddfoot{\mycopyrightnotice}
  \def\@evenfoot{}
  }%
  \ps@headings%
}
\makeatother

\confheader{%
  5$^{th}$  IEEE International Conference on Recent Advances and Innovations in Engineering - ICRAIE 2020 (IEEE Record\#51050) %EDIT HERE
}

\def\mycopyrightnotice{
  {\footnotesize XXX-1-7281-8867-6/20/\$31.00~\copyright~2020 IEEE\hfill} % EDIT HERE
  \gdef\mycopyrightnotice{}

}

\newcommand*{\affmark}[1][*]{\textsuperscript{#1}}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\newcommand{\ma}[1]{\mbox{\boldmath$#1$}} ``` 
```

# vb.net - 我的 WinForms 应用程序如何获取用户 MachineID 或 ProcessorID？

> ID：559946
> 
> 赞同：1
> 
> 时间：2009-02-18T05:24:33.457
> 
> 标签：vb.net, winforms

我正在寻找一种使用 VB.net WinForms 应用程序检索用户的 MachineID 或 ProcessorID 的方法？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T05:53:09.817

另一种选择是获取系统中一个网卡的 MAC 地址。这是一个唯一编号以下例程获取第一个网卡的 mac 地址，然后将地址中的字节附加到唯一的 ulong 中（对不起 C# 而不是 VB.NET）：

```
使用 System.Net.NetworkInformation；
NetworkInterface[] nics = NetworkInterface.GetAllNetworkInterfaces();
如果（nics.Length！= 0）
{
    byte[] addressBytes = nics[0].GetPhysicalAddress().GetAddressBytes();
    if (addressBytes.Length > 6)
        throw new ApplicationException("MAC 地址长度异常");

    ulong地址=0；
    foreach（addressBytes 中的字节 b）
    {
        地址

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T05:31:45.733

您可以使用 WMI 访问该信息。

```
string s = "SELECT SerialNumber FROM WIN32_BaseBoard";
System.Management.ManagementObjectSearcher oWMI = new
System.Management.ManagementObjectSearcher(s);
System.Management.ManagementObjectCollection oSerialNumbers = oWMI.Get();

foreach (System.Management.ManagementObject mo in oSerialNumbers)
{
Console.WriteLine("Serial Number: " +
mo.Properties["SerialNumber"].Value.ToString());
} 
```

从这里引用：http: [//bytes.com/groups/net/411975-how-can-i-get-processor-id-my-computer](http://bytes.com/groups/net/411975-how-can-i-get-processor-id-my-computer)

另一个获取处理器 id 的例子在这里： http: [//www.devasp.net/net/articles/display/149.html](http://www.devasp.net/net/articles/display/149.html)

# java - 分词规则文件

> ID：559949
> 
> 赞同：0
> 
> 时间：2009-02-18T05:26:02.143
> 
> 标签：java, icu

IBM 显然已经开源了他们的 ICU 源代码以支持 Unicode 和全球化，其中一部分是一个文本边界定位器，用于检测文本中的中断位置。

但是，中断检测依赖于规则，我无法在任何地方找到规则文件。

我在哪里可以获得 和 的分词规则文本`com.ibm.icu.text.BreakIterator`文件`com.ibm.icu.text.RuleBasedBreakIterator`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T06:52:31.653

[http://www.icu-project.org/](http://www.icu-project.org/)包含 IBM 在开源许可下发布的 icu4j 的所有源代码。这包括边界分析的东西，比如基于字典和规则的中断迭代器。

但是，似乎没有适合阅读的文本文件。我不确定 IBM 是否会将他们的规则集作为开源发布（因为这对他们来说是一个相当大的技术优势）。相反，我们的想法是创建自己的规则集，[这里](http://sujitpal.blogspot.com/2008/05/tokenizing-text-with-icu4js.html)有一个教程。

同一教程指出，您可以通过运行转储默认规则：

```
RuleBasedBreakIterator rbbi = (RuleBasedBreakIterator)
    BreakIterator.getWordInstance(Locale.getDefault());
String defaultRules = rbbi.toString(); 
```

# frameworks - 框架时代的封装

> ID：559953
> 
> 赞同：7
> 
> 时间：2009-02-18T05:26:57.633
> 
> 标签：frameworks, dependency-injection, constructor, encapsulation

在我以前的 C++ 工作中，我们总是非常小心地封装成员变量，并且仅在绝对必要时才将它们公开为属性。我们会有非常具体的构造函数来确保您在使用对象之前完全构造它。

这些天来，使用 ORM 框架、依赖注入、序列化等，看起来你最好只依赖默认构造函数并在属性中公开你的类的所有内容，这样你就可以注入东西，或者构建和填充对象更动态。

在 C# 中，对象初始化器更进一步，它使您能够基本上定义自己的构造函数。（我知道对象初始化器并不是真正的自定义构造器，但我希望你明白我的意思。）

这个方向有什么普遍的担忧吗？为了方便起见，封装似乎开始变得不那么重要了。

编辑：我知道您仍然可以仔细封装成员，但我只是觉得当您尝试创建一些类时，您要么必须坐下来仔细考虑如何封装每个成员，要么将其公开为属性，并担心它以后如何初始化。现在似乎最简单的方法是将事物公开为属性，而不是那么小心。也许我完全错了，但这只是我的经验，尤其是新的 C# 语言功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T05:39:40.677

我不同意你的结论。有很多很好的方法可以将上述所有技术封装在 c# 中，以保持良好的软件编码实践。我还要说这取决于您正在查看谁的技术演示，但最终归结为减少对象的状态空间，以便您可以确保它们始终保持其不变量。

以**对象关系框架**为例；它们中的大多数允许您指定它们将如何水合实体；例如 NHibernate 允许你这么说`access="property"`或`access="field.camelcase"`类似的。这允许您封装您的属性。

**依赖注入**适用于您拥有的其他类型，主要是那些不是实体的类型，即使您可以以一些非常好的方式结合 AOP+ORM+IOC 来改善这些事物的状态。如果你正在构建一个数据驱动的应用程序，我猜你就是这样，因为你在谈论 ORM，所以 IoC 通常用于域实体之上的层。

它们（“它们”是应用程序和域服务以及程序的其他内在类）暴露了它们的依赖关系，但实际上可以在比以前更好的隔离中封装和测试，因为按合同设计/按接口设计的范例您在基于模拟的测试（与 IoC 结合）中模拟依赖项时经常使用它，这将使您转向类即组件“语义”。我的意思是：每个类，当使用上述构建时，将被更好地封装。

*为 urig 更新：*这对于公开具体**依赖项都适用**并暴露接口。首先关于接口：我上面暗示的是，服务和其他具有依赖关系的应用程序类可以使用 OOP 依赖于契约/接口而不是特定的实现。在 C/C++ 和更早的语言中，没有接口，抽象类只能走这么远。接口允许您将不同的运行时实例绑定到同一个接口，而不必担心泄漏内部状态，这是您在抽象和封装时试图摆脱的。使用抽象类你仍然可以提供一个类实现，只是你不能实例化它，但是继承者仍然需要知道你的实现中的不变量，这可能会弄乱状态。

其次，关于作为属性的具体类：您必须警惕哪些类型的类型；）您作为属性公开。假设您的实例中有一个列表；然后不要将 IList 公开为属性；这可能会泄漏，您不能保证界面的使用者不会添加或删除您所依赖的东西；而是公开 IEnumerable 之类的内容并返回 List 的副本，或者更好的是，将其作为方法执行： public IEnumerable MyCollection { get { return _List.Enum(); } } 并且您可以 100% 确定获得性能和封装。没有人可以添加或删除该 IEnumerable，您仍然不必执行昂贵的数组复制。对应的辅助方法：

```
static class Ext {
    public static IEnumerable<T> Enum<T>(this IEnumerable<T> inner) {
        foreach (var item in inner) yield return item;
    }
} 
```

因此，虽然在创建重载的等于运算符/方法时无法获得 100% 的封装，但您可以接近您的公共接口。

您还可以使用基于 Spec# 构建的 .Net 4.0 的新功能来验证我上面谈到的合约。

**序列化**将永远存在并且已经存在了很长时间。以前，在 Internet 区域之前，它用于将对象图保存到磁盘以供以后检索，现在它用于 Web 服务、复制语义以及将数据传递到例如浏览器时。如果您将一些 [NonSerialized] 属性或等效项放在正确的字段上，这不一定会破坏封装。

对象初始化器与构造器不同，它们只是折叠几行代码的一种方式。{} 中的值/实例在所有构造函数都运行之前不会被分配，因此原则上它与不使用对象初始化器相同。

我想，你需要注意的是偏离了你从以前的工作中学到的好的原则，并确保你的领域对象充满了封装在良好接口后面的业务逻辑，并且同样适用于你的服务层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T05:42:22.213

私人成员仍然非常重要。控制对内部对象数据的访问总是好的，不应被忽视。

很多时候，我发现私有方法太过分了。大多数情况下，如果您正在做的工作足够重要而需要突破，您可以通过以下方式重构它：a) 私有方法是微不足道的，或者 b) 是其他函数的一个组成部分。

此外，在单元测试中，拥有许多私有方法使得单元测试变得非常困难。有一些方法可以解决这个问题（让测试对象成为朋友等），但会增加困难。

不过，我不会完全打折私有方法。任何时候，只要有重要的内部算法在类之外真的没有意义，就没有理由公开这些方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T05:36:02.260

我认为封装仍然很重要，它在库中的帮助比恕我直言。您可以创建一个执行 X 的库，但您不需要每个人都知道 X 是如何创建的。如果你想更具体地创建它来混淆你创建 X 的方式。我学习封装的方式，我还记得你应该总是将你的变量定义为私有的，以保护它们免受数据攻击。防止黑客破坏您的代码并访问他们不应该使用的变量。

# asp.net - 修改通知

> ID：559982
> 
> 赞同：0
> 
> 时间：2009-02-18T05:42:41.963
> 
> 标签：asp.net

我正在开发一个使用所有 asp:textbox 和 asp:label 的表单。目前，我正在使用 RequiredFieldValidator 来验证文本框并内联显示错误。我想要做的是更改其中一个 asp:labels 的颜色，因为其中一个文本框字段的验证失败。我会用javascript来完成这个，还是有任何命令可以在asp中修改标签。我非常感谢任何帮助和代码示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T08:12:01.603

如果您不想回发到服务器，我会说 javascript 是前进的方向。如果您使用 ASP.NET，通常只需要回发页面，以便服务器可以更改标签的属性 - 对用户不是很友好。[我的一位同事使用JQuery](http://jquery.com/) （一个 javascript 库）很好地完成了这项工作，但不幸的是我手头没有代码副本。他也是一个 SO 用户，所以我会为你传递这篇文章的链接。

# google-chrome - 在 Chrome 中测试时标头过期

> ID：559984
> 
> 赞同：5
> 
> 时间：2009-02-18T05:43:08.717
> 
> 标签：google-chrome, fiddler

在这里对“过期”标题感到非常困惑！有时它会按预期工作 - 有时不会。

我正在使用以下代码来设置过期标头。请注意，这是在 MVC 自定义属性中使用 ASP.NET 完成的——这在这里并不真正相关——但解释了`'filterContext'`来自哪里。

```
HttpCachePolicyBase cache = filterContext.HttpContext.Response.Cache;
TimeSpan cacheDuration = TimeSpan.FromSeconds(Duration);

// my own custom header so we know what time it was
filterContext.HttpContext.Response.AddHeader("CurrentTime", DateTime.Now.ToString());

cache.SetCacheability(HttpCacheability.Public);
cache.SetExpires(DateTime.Now.Add(cacheDuration));
cache.SetMaxAge(cacheDuration);
cache.AppendCacheExtension("must-revalidate, proxy-revalidate"); 
```

这有时会给我这样的标题：

```
Cache-Control: public, must-revalidate, proxy-revalidate, max-age=413
Date: Wed, 18 Feb 2009 05:24:19 GMT
Expires: Wed, 18 Feb 2009 05:21:12 GMT
CurrentTime: 2/17/2009 9:21:12 PM 
```

有时像这样：

```
Cache-Control: public, must-revalidate, proxy-revalidate, max-age=600
Date: Wed, 18 Feb 2009 05:27:55 GMT
Expires: Wed, 18 Feb 2009 05:27:55 GMT
CurrentTime: 2/17/2009 9:27:55 PM 
```

我正在通过 Fiddler 运行所有内容，并查看何时重新请求内容以及何时来自浏览器缓存。

现在奇怪的是在 IE 中缓存总是按预期工作。我的 ASP.NET MVC 操作方法的链接出现在 Fiddler 中，然后当我再次单击同一链接时，它来自缓存。

但是在 Chrome 中，它有时会，有时不会来自缓存！通过来自缓存，我的意思是没有额外的 HTTP 请求。

例如这样的链接：

```
 http://ipv4.fiddler:62669/gallery/mainimage/2 
```

将来自 IE 中的缓存，但在 chrome 中返回 200。然后有时在 Chrome 中它确实来自缓存。我已经尝试清空浏览器缓存并再次尝试 - 每次都得到相同的结果。

Chrome 是否正在尝试做一些“聪明”的事情并且只是惨遭失败 - 还是我需要一个额外的标题？

我想知道的是，这是否与我的`Expires`标题日期实际上永远不会在未来这一事实有关。如果我查看谷歌[托管的 jQuery 文件](http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js)的标题，我会看到标题如下（2010 年到期 - 未来一年）。

```
Cache-Control: public, max-age=31536000
Date: Wed, 18 Feb 2009 05:44:53 GMT
Expires: Thu, 18 Feb 2010 05:44:53 GMT 
```

Expires 实际上不应该在未来吗？

根据[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)：

> 如果响应包含 Expires 标头和 max-age 指令，则 max-age 指令将覆盖 Expires 标头，即使 Expires 标头更具限制性。对于给定的响应，此规则允许源服务器向 HTTP/1.1（或更高版本）缓存提供比 HTTP/1.0 缓存更长的到期时间。如果某些 HTTP/1.0 缓存不正确地计算年龄或过期时间，这可能很有用，可能是由于时钟不同步。

因此，即使“过期”与当前时间相同，Chrome 似乎也应该尊重 max-age 指令，但它似乎并没有这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T06:32:15.150

我在 ASP.NET MVC 源代码中发现了以下内容：

```
 public virtual void RenderView(ViewContext viewContext) {
        // TODO: Remove this hack. Without it, the browser appears to always load cached output
        viewContext.HttpContext.Response.Cache.SetExpires(DateTime.Now);
        ViewUserControlContainerPage containerPage = new ViewUserControlContainerPage(this);
        // Tracing requires Page IDs to be unique.
        ID = Guid.NewGuid().ToString();

        RenderViewAndRestoreContentType(containerPage, viewContext);
    } 
```

所以这解释了为什么我的`Expires`标题总是是当前时间。但是我真的不认为这是让 Chrome 绊倒的原因，因为我创建了如下最简单的页面，Chrome 仍然很高兴回到服务器并给了我 200

```
public partial class test : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        TimeSpan cacheDuration = TimeSpan.FromSeconds(33);
       var cache = Response.Cache;

        cache.SetCacheability(HttpCacheability.Public);
        cache.SetExpires(DateTime.Now.Add(cacheDuration));
        cache.SetMaxAge(cacheDuration);
        cache.AppendCacheExtension("must-revalidate, proxy-revalidate");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T07:14:46.343

我几乎得出的结论是，Chrome 在缓存方面做了一些非常糟糕的事情。

我将它简化到尽可能低的级别——从 Google 的服务器获取 jQuery。

我输入：

```
http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js 
```

到 Chrome，Fiddler 提出了以下**200**请求：

```
Requests started at:    22:58:00:7756
Responses completed at: 22:58:03:5020
Total Sequence time:    00:00:02.7263880
DNS Lookup time:    531ms
TCP/IP Connect time:    63ms

RESPONSE CODES
--------------
HTTP/200:   1 
```

标题如下（注意过期是今天之后的 1 年）：

```
Cache-Control: public, max-age=31536000
Date: Wed, 18 Feb 2009 06:58:01 GMT
Expires: Thu, 18 Feb 2010 06:58:01 GMT
Vary: Accept-Encoding 
```

然后我等了几秒钟，然后在同一个选项卡中按回车键。Fiddler 提出了另一个 **200* 请求：

```
Requests started at:    22:58:09:2516
Responses completed at: 22:58:12:3999
Total Sequence time:    00:00:03.1482360

RESPONSE CODES
--------------
HTTP/200:   1 
```

标题是：

```
Cache-Control: public, max-age=31536000
Date: Wed, 18 Feb 2009 06:58:09 GMT
Expires: Thu, 18 Feb 2010 06:58:09 GMT
Vary: Accept-Encoding 
```

显然这不是我所期待的。

**是**- 两个请求的接受编码相同。

**是**的 - 第三个请求给了我一个 304

这是在我从未做过任何开发的新安装的 Chrome 上 - 而且我只是第一次安装了 Fiddler。

我等不及有人向我解释这一点。现在我放弃了——我认为我的缓存和过期代码很好。此外，ASP.NET MVC 似乎强制将 Expires 设置为当前时间。这显然不是我的谷歌示例中的一个因素。

我认为 Chrome 太聪明了，这一定是一个错误——我使用的是 1.0.154.48 版本。

# java - 如何获取 Eclipse RCP 应用程序的 OSGi BundleContext？

> ID：559989
> 
> 赞同：12
> 
> 时间：2009-02-18T05:47:16.803
> 
> 标签：java, osgi, eclipse-rcp

我刚刚开始使用 Eclipse RCP 应用程序，它基本上只是提供的“hello world”示例之一。

当应用程序启动时，我想查看我的命令行参数并根据它们启动一些服务。*我可以在IApplication.start*中获取命令行参数：

```
public Object start(IApplicationContext context) {
   String[] argv = (String[]) 
       context.getArguments().get(IApplicationContext.APPLICATION_ARGS)));
} 
```

但是如何获取 BundleContext，以便注册服务？它似乎不在 IApplicationContext 中。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-08-16T05:06:47.290

刚刚在进行网络搜索时遇到了这个问题，并认为我会推广新的标准 OSGi R4.2 方式（由 Eclipse 3.5 附带的 Equinox 提供）。如果您没有激活器，并且不想创建一个只是为了缓存包上下文，则可以使用 FrameworkUtil.getBundle。修改前面的例子：

```
import org.osgi.framework.FrameworkUtil;

public class ExportClassDigestApplication implements IApplication {
    public Object start(IApplicationContext context) throws Exception {
        context.applicationRunning();
        BundleContext bundleContext = FrameworkUtil.getBundle(this.getClass())
                                                   .getBundleContext();
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-18T07:49:47.320

棘手的内部方式：

```
InternalPlatform.getDefault().getBundleContext() 
```

能做到这。

你会在[这个类中找到一个例子](http://www.koders.com/java/fid303B02634E3F752520A89254E5DC13BE4BD68639.aspx?s=eclipse+IApplicationContext++BundleContext#L11)

```
public class ExportClassDigestApplication implements IApplication {

    public Object start(IApplicationContext context) throws Exception {
        context.applicationRunning();

        List<ExtensionBean> extensionBeans = ImpCoreUtil.loadExtensionBeans(&quot;com.xab.core.containerlaunchers&quot;);
        for (ExtensionBean bean : extensionBeans) {
            ILauncher launcher = (ILauncher) bean.getInstance();
            launcher.start();
        }
        ClassFilter classFilter = new ClassFilter() {
            public boolean isClassAccepted(Class clz) {
                return true;
            }
        };

        PrintWriter writer = new PrintWriter( new File( "C:/classes.csv"));

        Bundle[] bundles = InternalPlatform.getDefault().getBundleContext().getBundles(); 
```

* * *

[正确的方法](http://dev.eclipse.org/newslists/news.eclipse.platform/msg41088.html)：

> 每个[插件](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/runtime_model_bundles.htm)都可以访问自己的包上下文。
> 
> 只需确保您的插件类覆盖[start(BundleContext)](http://www.osgi.org/javadoc/r4v41/org/osgi/framework/BundleActivator.html#start%28org.osgi.framework.BundleContext%29)方法。然后您可以将其保存到您的插件中可以轻松访问的地方类
> 
> 请注意，提供给插件的包上下文是特定于它的，并且永远不应与其他插件共享。

# flash - 使用 sothink flash 反编译器将 SWF 反编译为 FLA 时出现问题

> ID：559994
> 
> 赞同：0
> 
> 时间：2009-02-18T05:51:12.240
> 
> 标签：flash, decompiling

我的 SWF 在使用 Flash 反编译器进行反编译时，会生成一个空的 FLA。Flash 对象还使用了一个未与 SWF 对象一起导出的 XML 文件。可以做些什么来正确反编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T13:51:40.497

您是否尝试过其他 Flash 反编译器并得到相同的结果？

你可以试试 OpenWorld 的 Flash Explorer 或 WinFlasm。

我相信有一种方法可以混淆你的 swf 文件，这样它们就不能被正确地反编译，我知道我过去遇到过这样的困难。

当然还有免责声明：
如果您试图非法破解打开他人的 SWF 文件……请不要这样做。:)

# configuration - 为部署 .NET 加密配置文件

> ID：559995
> 
> 赞同：0
> 
> 时间：2009-02-18T05:51:30.133
> 
> 标签：configuration, encryption, app-config

我有一个从 app.config 读取的 Windows 服务

我希望对某些设置进行加密，但是，我不想使用 .NET 中提供的 ProtectedConfigurationProvider 类，因为它们基于使用 DPAPI 运行的机器来加密文件。

我想要的是一种让我们的管理员将已经加密的配置文件部署到多台机器并让每台机器在需要时解密它们的方法。

我也不想将密码硬编码到程序集中，所以我不确定我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T05:59:04.340

也许您的中央服务器可以为所有端点维护一个私钥数据库，然后它可以为此使用特定的机器密钥。

所有机器的共享私钥不会那么安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-27T15:16:41.633

您可以使用用户级 RSA 密钥并将它们导出到每台机器。那么配置文件可以提前加密，目标机器已经有了密钥。****